         TITLE 'IEFAB464- VOLUME/UNIT TABLE COMPLETION                 *00001000
                        '                                               00002000
IEFAB464 CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(24)                                          01S0001 00007000
         DC    C'IEFAB464 78054  UZ16857 '                      01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  DS    0H                                               01S0001 00012000
         USING @PSTART,@12                                      01S0001 00013000
         L     @00,@SIZDATD                                     01S0001 00014000
         GSPACE   R,LV=(0)                                              00015000
         LR    @11,@01                                          01S0001 00016000
         USING @DATD,@11                                        01S0001 00017000
         ST    @13,@SA00001+4                                   01S0001 00018000
         LM    @00,@01,20(@13)                                  01S0001 00019000
         ST    @11,8(,@13)                                      01S0001 00020000
         LR    @13,@11                                          01S0001 00021000
         MVC   @PC00001(28),0(@01)                              01S0001 00022000
*                                      # OF BYTES AND IS GIVEN IN HDR   00023000
*                                      OF THIS SECTION               */ 00024000
*   CSIOTP=CSIOTPTR;                /* GET POINTER TO CURRENT SIOT.  */ 00025000
         L     @10,@PC00001+12                                  01S0107 00026000
         L     CSIOTP,CSIOTPTR(,@10)                            01S0107 00027000
*   CJFCBP=CJFCBPTR;                /* GET POINTER TO CURRENT JFCB.  */ 00028000
         L     @10,@PC00001+16                                  01S0108 00029000
         L     CJFCBP,CJFCBPTR(,@10)                            01S0108 00030000
*   RSIOTP=RSIOTPTR;                /* GET POINTER TO REFERENCED SIOT*/ 00031000
         L     @10,@PC00001+24                                  01S0109 00032000
         L     RSIOTP,RSIOTPTR(,@10)                            01S0109 00033000
*   ZEROUCB=0;                      /* SETUP FOR RETRIEVED DEVICE       00034000
*                                      TYPE.                         */ 00035000
         SLR   @10,@10                                          01S0110 00036000
         ST    @10,ZEROUCB                                      01S0110 00037000
*   IF HWGEPACP=0 THEN              /* IF NO SPECIAL                 */ 00038000
         L     @09,@PC00001+4                                   01S0111 00039000
         L     @09,HWDATAP(,@09)                                01S0111 00040000
         C     @10,HWGEPACP(,@09)                               01S0111 00041000
         BNE   @RF00111                                         01S0111 00042000
*     EPAPTR=HWLEPAP;               /* EPA CHAIN USE NORMAL CHAIN,   */ 00043000
         L     @10,HWLEPAP(,@09)                                01S0112 00044000
         ST    @10,EPAPTR                                       01S0112 00045000
*   ELSE                            /* OTHERWISE USE SPECIAL CHAIN   */ 00046000
*     EPAPTR=HWGEPACP;              /* FOR ASSIGNED JFCBX(S).        */ 00047000
         B     @RC00111                                         01S0113 00048000
@RF00111 L     @10,@PC00001+4                                   01S0113 00049000
         L     @10,HWDATAP(,@10)                                01S0113 00050000
         L     @10,HWGEPACP(,@10)                               01S0113 00051000
         ST    @10,EPAPTR                                       01S0113 00052000
*   IF HWDSNCAT=YES|HWRESIOT=YES|   /* IF THERE IS AN        @YM06136*/ 00053000
*       HWVUREC=YES THEN            /* EXTERNAL (NON-JCL)    @YM06136*/ 00054000
@RC00111 L     @10,@PC00001                                     01S0114 00055000
         L     @10,HWCNTRLP(,@10)                               01S0114 00056000
         TM    HWDSNCAT(@10),B'01001100'                        01S0114 00057000
         BZ    @RF00114                                         01S0114 00058000
*     DO;                           /* SOURCE FOR VOLUME     @YM06136*/ 00059000
*       SCTVOLCT=0;                 /* AND UNIT INFORMATION  @YM06136*/ 00060000
         MVI   SCTVOLCT(CSIOTP),X'00'                           01S0116 00061000
*       JFCBNVOL=0;                 /* CLEAR # VOLUMES       @YM06136*/ 00062000
         MVI   JFCBNVOL(CJFCBP),X'00'                           01S0117 00063000
*     END;                          /* FIELDS                @YM06136*/ 00064000
*   IF HWDSNCAT=YES|HWVUREC=YES THEN/* VOLUME/UNIT INFORMATION       */ 00065000
@RF00114 L     @10,@PC00001                                     01S0119 00066000
         L     @10,HWCNTRLP(,@10)                               01S0119 00067000
         TM    HWDSNCAT(@10),B'01000100'                        01S0119 00068000
         BZ    @RF00119                                         01S0119 00069000
*     DO;                           /* FOUND IN CRI ?                */ 00070000
*                                                               02S0121 00071000
*/********************************************************************/ 00072000
*/*                                                                  */ 00073000
*/* SEGMENT NAME - CRIRFCMP                                          */ 00074000
*/*                                                                  */ 00075000
*/* DESCRIPTIVE NAME - CRI REFERENCE VOLUME/UNIT  COMPLETION         */ 00076000
*/*                                                                  */ 00077000
*/* FUNCTION - SETUP ROUTINES HAVE ESTABLISHED THE SOURCE OF         */ 00078000
*/*            IMPLICIT(DD HAS VOL=REF OR DOES NOT HAVE VOLUME       */ 00079000
*/*            SERIALS) VOLUME/UNIT INFORMATION. IF THAT INFORMATION */ 00080000
*/*            IS IN THE CATALOG THEN THIS ROUTINE COPIES IT FROM    */ 00081000
*/*            THE CRI(CATALOG RETURN INFORMATION) TO THE CURRENT    */ 00082000
*/*            REQUEST (SIOT,JFCB AND JFCBX(S)).                     */ 00083000
*/* ENTRY -                                                          */ 00084000
*/*   PURPOSE - SEE FUNCTION.                                        */ 00085000
*/*                                                                  */ 00086000
*/*   INPUT DATA - HSKPWA (CONTROLS,DATA AND RETURN INFO), CURRENT   */ 00087000
*/*                SIOT,JFCB,JFCBX AND CRI.                          */ 00088000
*/* EXITS -                                                          */ 00089000
*/*   CONDITION- WHEN INFORMATION IS COPIED.                         */ 00090000
*/*                                                                  */ 00091000
*/*   OUTPUT DATA- UPDATED SIOT AND JFCB. UPDATED/CREATED JFCBX.     */ 00092000
*/*                                                                  */ 00093000
*/*   RETURN CODE-NONE.                                              */ 00094000
*/*                                                                  */ 00095000
*/********************************************************************/ 00096000
*                                                               02S0121 00097000
*       IF SCTVOLAF=NO THEN         /* INDICATE A CATALOGED.         */ 00098000
         TM    SCTVOLAF(CSIOTP),B'00100000'                     02S0121 00099000
         BNZ   @RF00121                                         02S0121 00100000
*         JFCCAT=YES;               /* DATA SET IF NOT VOL=REF.      */ 00101000
         OI    JFCCAT(CJFCBP),B'10000000'                       02S0122 00102000
*       IF HWVUREC=YES THEN         /* GET NTH UNIQUE DEVICE TYPE FOR*/ 00103000
@RF00121 L     @10,@PC00001                                     02S0123 00104000
         L     @10,HWCNTRLP(,@10)                               02S0123 00105000
         TM    HWVUREC(@10),B'01000000'                         02S0123 00106000
         BNO   @RF00123                                         02S0123 00107000
*         DO;                       /* VOL/UNIT RECURSION(N=DD  02S0124 00108000
*                                      COUNTER)                      */ 00109000
*           CALL IEFAB463           /* SCAN CRI FOR NTH DEVICE TYPE     00110000
*                                      AS IN DD CTR                  */ 00111000
*               (FUNC2,CRIP,HWDDCTR,DEVTYPE,DEVSFND,VLPTR);     02S0125 00112000
         LA    @09,@CH00081                                     02S0125 00113000
         ST    @09,@AL00001                                     02S0125 00114000
         L     @09,@PC00001+20                                  02S0125 00115000
         ST    @09,@AL00001+4                                   02S0125 00116000
         LA    @10,HWDDCTR(,@10)                                02S0125 00117000
         ST    @10,@AL00001+8                                   02S0125 00118000
         LA    @10,DEVTYPE                                      02S0125 00119000
         ST    @10,@AL00001+12                                  02S0125 00120000
         LA    @10,DEVSFND                                      02S0125 00121000
         ST    @10,@AL00001+16                                  02S0125 00122000
         LA    @10,VLPTR                                        02S0125 00123000
         ST    @10,@AL00001+20                                  02S0125 00124000
         L     @15,@CV00158                                     02S0125 00125000
         LA    @01,@AL00001                                     02S0125 00126000
         BALR  @14,@15                                          02S0125 00127000
*           SCTNMBUT=0;             /* CTLG. MGMNT HAS PASSED UNIT      00128000
*                                      CNT.                          */ 00129000
         MVI   SCTNMBUT(CSIOTP),X'00'                           02S0126 00130000
*           JFCORGAM=YES;           /* SET TO VSAM           @YA00068*/ 00131000
         OI    JFCORGAM(CJFCBP),B'00001000'                     02S0127 00132000
*         END;                                                  02S0128 00133000
*       ELSE                        /* IF NOT VOL/UNIT RECURSION THEN*/ 00134000
*         DO;                       /* GET THE DEVICE TYPE IN 1ST    */ 00135000
         B     @RC00123                                         02S0129 00136000
@RF00123 DS    0H                                               02S0130 00137000
*           DEVTYPE=CTGVLDEV(1);    /* VOLUME LIST ENTRY AND SET PTR */ 00138000
         L     @10,@PC00001+20                                  02S0130 00139000
         L     @10,CRIP(,@10)                                   02S0130 00140000
         L     @10,CTGWKA(,@10)                                 02S0130 00141000
         L     @10,CTGWAVL(,@10)                                02S0130 00142000
         MVC   DEVTYPE(4),CTGVLDEV(@10)                         02S0130 00143000
*           DEVTPTR=ADDR(DEVTYPE);  /* SET DEVICE TYPE PTR TO DEVTYPE   00144000
*                                      FOR DEVTPROC          @ZA12414*/ 00145000
         LA    DEVTPTR,DEVTYPE                                  02S0131 00146000
*           IF DEVTBYT4^=0 THEN     /* DEVICE TYPE IS NOT THE RESULT    00147000
*                                      OF GROUP NAME SPECIFIED  02S0132 00148000
*                                                            @ZA16380*/ 00149000
         CLI   DEVTBYT4(DEVTPTR),0                              02S0132 00150000
         BE    @RF00132                                         02S0132 00151000
*             CALL DEVTPROC;        /* TURN OFF DEVTYPE BITS @ZA12414*/ 00152000
         BAL   @14,DEVTPROC                                     02S0133 00153000
*           VLPTR=CTGWAVL;          /* TO 1ST VOLIST ENTRY.          */ 00154000
@RF00132 L     @10,@PC00001+20                                  02S0134 00155000
         L     @10,CRIP(,@10)                                   02S0134 00156000
         L     @10,CTGWKA(,@10)                                 02S0134 00157000
         L     @09,CTGWAVL(,@10)                                02S0134 00158000
         ST    @09,VLPTR                                        02S0134 00159000
*           RFY                                                 02S0135 00160000
*             CTGVL BASED(VLPTR);   /* VOLIST ADDRESSIBILTY.         */ 00161000
*           RFY                                                 02S0136 00162000
*             HWDEV BASED(ADDR(DEVTYPE));/* SET BASE FOR DEVTYPE        00163000
*                                      COMPARE.                      */ 00164000
*           IF CTGWAVCT=1&SCTVOLAF=NO&HWDA=YES/* DSCB TTR FOR SINGLE */ 00165000
*               &JFCORGAM=NO THEN   /* VOLUME, NON-VOLREF, DA,  02S0137 00166000
*                                      NON-VSAM                      */ 00167000
         CLC   CTGWAVCT(2,@10),@CH00070                         02S0137 00168000
         BNE   @RF00137                                         02S0137 00169000
         TM    SCTVOLAF(CSIOTP),B'00100000'                     02S0137 00170000
         BNZ   @RF00137                                         02S0137 00171000
         LA    @10,DEVTYPE                                      02S0137 00172000
         TM    HWDA(@10),B'00100000'                            02S0137 00173000
         BNO   @RF00137                                         02S0137 00174000
         TM    JFCORGAM(CJFCBP),B'00001000'                     02S0137 00175000
         BNZ   @RF00137                                         02S0137 00176000
*             JFCBDSCB=CTGVLTTR;    /* DATA SETS.                    */ 00177000
         MVC   JFCBDSCB(3,CJFCBP),CTGVLTTR(@09)                 02S0138 00178000
*           IF SIOTGALL=YES|JFCBFLSQ=0 THEN/* USE FILE SEQUENCE NO.     00179000
*                                      IN                            */ 00180000
@RF00137 TM    SIOTGALL(CSIOTP),B'00100000'                     02S0139 00181000
         BO    @RT00139                                         02S0139 00182000
         LH    @10,JFCBFLSQ(,CJFCBP)                            02S0139 00183000
         LTR   @10,@10                                          02S0139 00184000
         BNZ   @RF00139                                         02S0139 00185000
@RT00139 DS    0H                                               02S0140 00186000
*             JFCBFLSQ=CTGVLSEQ(1); /* CRI IF GDG ALL OR IF NOT 02S0140 00187000
*                                      CODED.                        */ 00188000
         L     @10,VLPTR                                        02S0140 00189000
         LH    @10,CTGVLSEQ(,@10)                               02S0140 00190000
         STH   @10,JFCBFLSQ(,CJFCBP)                            02S0140 00191000
*           IF JFCORGAM=YES&SCTPARLM=NO THEN/* VSAM DATA SET, NO        00192000
*                                                            @YM06579*/ 00193000
@RF00139 TM    JFCORGAM(CJFCBP),B'00001000'                     02S0141 00194000
         BNO   @RF00141                                         02S0141 00195000
         TM    SCTPARLM(CSIOTP),B'00000100'                     02S0141 00196000
         BNZ   @RF00141                                         02S0141 00197000
*             SCTNMBUT=CTGWAUCT;    /* PARALLEL MNT, GET UNIT COUNT     00198000
*                                      FROM CATALOG          @YM06579*/ 00199000
         L     @10,@PC00001+20                                  02S0142 00200000
         L     @10,CRIP(,@10)                                   02S0142 00201000
         L     @10,CTGWKA(,@10)                                 02S0142 00202000
         LH    @10,CTGWAUCT(,@10)                               02S0142 00203000
         STC   @10,SCTNMBUT(,CSIOTP)                            02S0142 00204000
*         END;                      /* END NON RECURSIVE ONLY.       */ 00205000
@RF00141 DS    0H                                               02S0144 00206000
*       JFCMSVGP=BLANKS;            /* CLEAR MSVG NAME FIELD @ZA08174*/ 00207000
@RC00123 MVC   JFCMSVGP(8,CJFCBP),BLANKS                        02S0144 00208000
*       JFCBMSGP=NO;                /* TURN MSVGP BIT OFF    @ZA08174*/ 00209000
         NI    JFCBMSGP(CJFCBP),B'11011111'                     02S0145 00210000
*       JVOLPTR=ADDR(JFCBVOLS)-VOLSERLN;/* ADJUSTED 1ST VOLSER  02S0146 00211000
*                                      POSITION                      */ 00212000
         LA    JVOLPTR,JFCBVOLS(,CJFCBP)                        02S0146 00213000
         SL    JVOLPTR,@CF00105                                 02S0146 00214000
*       DO VLPTR=VLPTR TO CTGWAVL+(CTGWAVCT-1)*VLEN BY VLEN;/* GET      00215000
*                                      ALL VOLSERS FOR THIS DEVTYPE. */ 00216000
         L     @10,VLPTR                                        02S0147 00217000
         B     @DE00147                                         02S0147 00218000
@DL00147 DS    0H                                               02S0148 00219000
*         CDEVPTR=ADDR(CTGVLDEV);   /* PTR TO DEVTYPE IN CRI.        */ 00220000
         LA    CDEVPTR,CTGVLDEV(,@10)                           02S0148 00221000
*         DEVTPTR=CDEVPTR;          /* SET DEVICE TYPE PTR TO   02S0149 00222000
*                                      CTGVLDEV FOR DEVTPROC @ZA12414*/ 00223000
         LR    DEVTPTR,CDEVPTR                                  02S0149 00224000
*         IF DEVTBYT4^=0 THEN       /* DEVICE TYPE IS NOT THE RESULT    00225000
*                                      OF GROUP NAME SPECIFIED  02S0150 00226000
*                                                            @ZA16380*/ 00227000
         CLI   DEVTBYT4(DEVTPTR),0                              02S0150 00228000
         BE    @RF00150                                         02S0150 00229000
*           CALL DEVTPROC;          /* TURN OFF CTGVLDEV BITS   02S0151 00230000
*                                                            @ZA12414*/ 00231000
         BAL   @14,DEVTPROC                                     02S0151 00232000
*         IF HWDEV^=CDEVPTR->HWDEV THEN/* IF DEVICE TYPES NOT THE       00233000
*                                      SAME THEN UPDATE UNIT COUNT      00234000
*                                                            @Y30LPPE*/ 00235000
@RF00150 LA    @10,DEVTYPE                                      02S0152 00236000
         CLC   HWDEV(4,@10),HWDEV(CDEVPTR)                      02S0152 00237000
         BE    @RF00152                                         02S0152 00238000
*           IF SCTNMBUT=0&HWVUREC=YES&SCTPARLM=NO THEN/* COUNT,IF NOT   00239000
*                                      DONE.                         */ 00240000
         CLI   SCTNMBUT(CSIOTP),0                               02S0153 00241000
         BNE   @RF00153                                         02S0153 00242000
         L     @10,@PC00001                                     02S0153 00243000
         L     @10,HWCNTRLP(,@10)                               02S0153 00244000
         TM    HWVUREC(@10),B'01000000'                         02S0153 00245000
         BNO   @RF00153                                         02S0153 00246000
         TM    SCTPARLM(CSIOTP),B'00000100'                     02S0153 00247000
         BNZ   @RF00153                                         02S0153 00248000
*             DO;                   /* USE VOLCOUNT OR CRI UNIT COUNT*/ 00249000
*               SCTNMBUT=MIN(CTGWAUCT,SCTVOLCT);/* USE SMALLER UNIT     00250000
*                                      COUNT                         */ 00251000
         L     @10,@PC00001+20                                  02S0155 00252000
         L     @10,CRIP(,@10)                                   02S0155 00253000
         L     @10,CTGWKA(,@10)                                 02S0155 00254000
         LH    @09,CTGWAUCT(,@10)                               02S0155 00255000
         SLR   @05,@05                                          02S0155 00256000
         IC    @05,SCTVOLCT(,CSIOTP)                            02S0155 00257000
         CR    @05,@09                                          02S0155 00258000
         BNH   *+6                                                      00259000
         LR    @05,@09                                          02S0155 00260000
         STC   @05,SCTNMBUT(,CSIOTP)                            02S0155 00261000
*               CTGWAUCT=CTGWAUCT-SCTNMBUT;/* UPDATE MIN UNIT COUNT     00262000
*                                      IN                            */ 00263000
         SLR   @09,@05                                          02S0156 00264000
         STH   @09,CTGWAUCT(,@10)                               02S0156 00265000
*             END;                  /* CRI BY THIS DEVTYP'S UNIT        00266000
*                                      COUNT.                        */ 00267000
*           ELSE                                                02S0158 00268000
*             ;                     /* NULL...                       */ 00269000
@RF00153 DS    0H                                               02S0159 00270000
*         ELSE                      /* DEVTYPES ARE THE SAME,ITS NOT */ 00271000
*           IF HWTAPE=NO|SCTVOLAF=NO THEN/* VOLREF TO A TAPE DATA       00272000
*                                      SET,COPY                      */ 00273000
         B     @RC00152                                         02S0159 00274000
@RF00152 LA    @10,DEVTYPE                                      02S0159 00275000
         TM    HWTAPE(@10),B'10000000'                          02S0159 00276000
         BZ    @RT00159                                         02S0159 00277000
         TM    SCTVOLAF(CSIOTP),B'00100000'                     02S0159 00278000
         BNZ   @RF00159                                         02S0159 00279000
@RT00159 DS    0H                                               02S0160 00280000
*             DO;                   /* VOLSER FROM VOLIST TO JFCB(X).*/ 00281000
*               CALL JFCBXGEN;      /* GET NEXT VOLSER LOCATION      */ 00282000
         BAL   @14,JFCBXGEN                                     02S0161 00283000
*               NEXTSER=CTGVLVOL(1);/* PUT VOLSER IN JFCB(X)         */ 00284000
         L     @10,VLPTR                                        02S0162 00285000
         MVC   NEXTSER(6,JVOLPTR),CTGVLVOL(@10)                 02S0162 00286000
*               SCTVOLCT=SCTVOLCT+1;/* INCREMENT NUMBER VOLSERS 02S0163 00287000
*                                      COPIED.                       */ 00288000
         LA    @10,1                                            02S0163 00289000
         SLR   @09,@09                                          02S0163 00290000
         IC    @09,SCTVOLCT(,CSIOTP)                            02S0163 00291000
         ALR   @10,@09                                          02S0163 00292000
         STC   @10,SCTVOLCT(,CSIOTP)                            02S0163 00293000
*             END;                                              02S0164 00294000
*           ELSE                    /* VOLREF TO TAPE,GET LAST VOLSER*/ 00295000
*             JFCBVOLS(1:VOLSERLN)=CTGVLVOL(1);/* BY ALWAYS COPYING     00296000
*                                      TO 1ST SLOT                   */ 00297000
         B     @RC00159                                         02S0165 00298000
@RF00159 L     @10,VLPTR                                        02S0165 00299000
         MVC   JFCBVOLS(6,CJFCBP),CTGVLVOL(@10)                 02S0165 00300000
*       END;                        /* END FOR CRI. VOLUME LIST SCAN.*/ 00301000
@RC00159 DS    0H                                               02S0166 00302000
@RC00152 LH    @10,VLEN                                         02S0166 00303000
         AL    @10,VLPTR                                        02S0166 00304000
         ST    @10,VLPTR                                        02S0166 00305000
@DE00147 L     @09,@PC00001+20                                  02S0166 00306000
         L     @09,CRIP(,@09)                                   02S0166 00307000
         L     @09,CTGWKA(,@09)                                 02S0166 00308000
         L     @05,@PC00001+20                                  02S0166 00309000
         L     @05,CRIP(,@05)                                   02S0166 00310000
         L     @05,CTGWKA(,@05)                                 02S0166 00311000
         LH    @01,CTGWAVCT(,@05)                               02S0166 00312000
         BCTR  @01,0                                            02S0166 00313000
         MH    @01,VLEN                                         02S0166 00314000
         AL    @01,CTGWAVL(,@09)                                02S0166 00315000
         CR    @10,@01                                          02S0166 00316000
         BNH   @DL00147                                         02S0166 00317000
*       IF HWTAPE=YES&SCTVOLAF=YES THEN/* IF VOLREF TO A TAPE DATA      00318000
*                                      SET                           */ 00319000
         LA    @10,DEVTYPE                                      02S0167 00320000
         TM    HWTAPE(@10),B'10000000'                          02S0167 00321000
         BNO   @RF00167                                         02S0167 00322000
         TM    SCTVOLAF(CSIOTP),B'00100000'                     02S0167 00323000
         BNO   @RF00167                                         02S0167 00324000
*         SCTVOLCT=1;               /* INDICATE 1 SPECIFIC VOLSER    */ 00325000
         MVI   SCTVOLCT(CSIOTP),X'01'                           02S0168 00326000
*       JFCBNVOL=SCTVOLCT;          /* TELL DATA MGMNT. NUMBER OF       00327000
*                                      VOLS.                         */ 00328000
@RF00167 IC    @10,SCTVOLCT(,CSIOTP)                            02S0169 00329000
         STC   @10,JFCBNVOL(,CJFCBP)                            02S0169 00330000
*       IF HWVUREC=YES THEN         /* IF VOL/UNIT RECURSION THEN    */ 00331000
         L     @10,@PC00001                                     02S0170 00332000
         L     @10,HWCNTRLP(,@10)                               02S0170 00333000
         TM    HWVUREC(@10),B'01000000'                         02S0170 00334000
         BNO   @RF00170                                         02S0170 00335000
*         DO;                       /* UPDATE FOR NEXT CRI SCAN      */ 00336000
*           IF HWDDCTR=HWDDSTEP THEN/* LAST DD FOR VOL/UNIT     02S0172 00337000
*                                      RECURSION,                    */ 00338000
         CLC   HWDDCTR(2,@10),HWDDSTEP(@10)                     02S0172 00339000
         BNE   @RF00172                                         02S0172 00340000
*             IF SCTPARLM=NO THEN   /* IF NOT PARALLEL MOUNT THEN ADD*/ 00341000
         TM    SCTPARLM(CSIOTP),B'00000100'                     02S0173 00342000
         BNZ   @RF00173                                         02S0173 00343000
*               SCTNMBUT=SCTNMBUT+CTGWAUCT;/* RESIDUAL UNIT COUNT IN    00344000
*                                      CRI.                          */ 00345000
         L     @10,@PC00001+20                                  02S0174 00346000
         L     @10,CRIP(,@10)                                   02S0174 00347000
         L     @10,CTGWKA(,@10)                                 02S0174 00348000
         SLR   @09,@09                                          02S0174 00349000
         IC    @09,SCTNMBUT(,CSIOTP)                            02S0174 00350000
         AH    @09,CTGWAUCT(,@10)                               02S0174 00351000
         STC   @09,SCTNMBUT(,CSIOTP)                            02S0174 00352000
*           HWDDCTR=HWDDCTR+1;      /* UPDATE COUNTER FOR NEXT  02S0175 00353000
*                                      DEVTYPE                       */ 00354000
@RF00173 DS    0H                                               02S0175 00355000
@RF00172 L     @10,@PC00001                                     02S0175 00356000
         L     @10,HWCNTRLP(,@10)                               02S0175 00357000
         LA    @09,1                                            02S0175 00358000
         AH    @09,HWDDCTR(,@10)                                02S0175 00359000
         STH   @09,HWDDCTR(,@10)                                02S0175 00360000
*           IF SCTNMBUT=0 THEN      /* IF THERE WAS NO UNIT COUNT       00361000
*                                      FROM                          */ 00362000
         CLI   SCTNMBUT(CSIOTP),0                               02S0176 00363000
         BNE   @RF00176                                         02S0176 00364000
*             SCTNMBUT=1;           /* CRI, INSURE AT LEAST 1.       */ 00365000
         MVI   SCTNMBUT(CSIOTP),X'01'                           02S0177 00366000
*         END;                                                  02S0178 00367000
*     END;                          /* END VOL/UNIT REC./DSN IN CTLG */ 00368000
*   ELSE                            /* IF NO CRI AND REF. SIOT IS    */ 00369000
*     IF HWRESIOT=YES THEN          /* PRESENT THEN VOL/UNIT INFO IS */ 00370000
         B     @RC00119                                         01S0180 00371000
@RF00119 L     @10,@PC00001                                     01S0180 00372000
         L     @10,HWCNTRLP(,@10)                               01S0180 00373000
         TM    HWRESIOT(@10),B'00001000'                        01S0180 00374000
         BNO   @RF00180                                         01S0180 00375000
*       DO;                         /* COMPLETED FROM PREVIOUS DD .  */ 00376000
*                                                               02S0182 00377000
*/********************************************************************/ 00378000
*/*                                                                  */ 00379000
*/* SEGMENT NAME - DDREFCMP                                          */ 00380000
*/*                                                                  */ 00381000
*/* DESCRIPTIVE NAME - DD REFERENCE VOLUME/UNIT COMPLETION           */ 00382000
*/*                                                                  */ 00383000
*/* FUNCTION - SETUP ROUTINES HAVE ESTABLISHED THE SOURCE OF IMPLICIT*/ 00384000
*/*            VOLUME/UNIT INFORMATION. IF THE SOURCE IS A PREVIOUS  */ 00385000
*/*            REQUEST (VIA PDI OR VOL=REF) THEN THIS ROUTINE COPIES */ 00386000
*/*            VOLUME/UNIT INFORMATION FROM THE REFERENCED DD TO THE */ 00387000
*/*            CURRENT DD(SIOT,JFCB AND/OR JFCBX).                   */ 00388000
*/* ENTRY -                                                          */ 00389000
*/*   PURPOSE - OBTAIN VOLUME/UNIT(NO DEVICE TYPE IS COPIED IF UNIT  */ 00390000
*/*             OVERRIDDEN) INFORMATION.                             */ 00391000
*/*                                                                  */ 00392000
*/*   INPUT DATA - HSKPWA(CONTROLS,DATA AND RETURN),CURRENT SIOT,    */ 00393000
*/*                JFCB,JFCBX AND REFERENCED SIOT, JFCB AND JFCBX.   */ 00394000
*/* EXITS -                                                          */ 00395000
*/*   CONDITION- WHEN VOLUME/UNIT INFORMATION IS COPIED.             */ 00396000
*/*                                                                  */ 00397000
*/*   OUTPUT DATA- UPDATED SIOT,JFCB AND JFCBX.                      */ 00398000
*/*                                                                  */ 00399000
*/*   RETURN CODE-NONE.                                              */ 00400000
*/*                                                                  */ 00401000
*/********************************************************************/ 00402000
*                                                               02S0182 00403000
*         RJFCBP=RSIOTP->SJFCBPTR;  /* GET PTR TO REFERENCED JFCB.   */ 00404000
         L     RJFCBP,SJFCBPTR(,RSIOTP)                         02S0182 00405000
*         IF SCTVOLAF=NO THEN       /* RETRIEVED SOURCE NOT VOLREF      00406000
*                                      GET                           */ 00407000
         TM    SCTVOLAF(CSIOTP),B'00100000'                     02S0183 00408000
         BNZ   @RF00183                                         02S0183 00409000
*           JFCBTSDM=JFCBTSDM|RJFCBP->JFCBTSDM;/* JOB/DATA MGMNT.       00410000
*                                      INTERFACE.                    */ 00411000
         OC    JFCBTSDM(1,CJFCBP),JFCBTSDM(RJFCBP)              02S0184 00412000
*         RTVDUNIT=RSIOTP->SCTUTYPE;/* DEVICE TYPE AND UCB POINTER.  */ 00413000
@RF00183 MVC   RTVDUNIT(8),SCTUTYPE(RSIOTP)                     02S0185 00414000
*         RFY                                                   02S0186 00415000
*           HWDEV BASED(ADDR(DEVTYPE));/* BASE DEVICE TYPE MAP       */ 00416000
*         IF SCTVREF=YES&RSIOTP->SCTUNAFF=YES THEN/* IF THIS IS INTRA   00417000
*                                      STEP                          */ 00418000
         TM    SCTVREF(CSIOTP),B'00010000'                      02S0187 00419000
         BNO   @RF00187                                         02S0187 00420000
         TM    SCTUNAFF(RSIOTP),B'00000010'                     02S0187 00421000
         BNO   @RF00187                                         02S0187 00422000
*           DO;                     /* VOLREF TO A DD WITH UNIT=AFF  */ 00423000
*             SCTUNAFF=YES;         /* THEN MAKE THIS DD HAVE THE       00424000
*                                      SAME                          */ 00425000
         OI    SCTUNAFF(CSIOTP),B'00000010'                     02S0189 00426000
*             SIOTUNAF=RSIOTP->SIOTUNAF;/* UNIT=AFF.                 */ 00427000
         LH    @10,SIOTUNAF(,RSIOTP)                            02S0190 00428000
         STH   @10,SIOTUNAF(,CSIOTP)                            02S0190 00429000
*           END;                                                02S0191 00430000
*         IF HWTAPE=YES THEN        /* IF RETRIEVED DEVICE TYPE IS      00431000
*                                      TAPE                          */ 00432000
@RF00187 LA    @10,DEVTYPE                                      02S0192 00433000
         TM    HWTAPE(@10),B'10000000'                          02S0192 00434000
         BNO   @RF00192                                         02S0192 00435000
*           DO;                     /* PROCESS UNIQUE TAPE      02S0193 00436000
*                                      INFORMATION.                  */ 00437000
*                                                               03S0194 00438000
*/********************************************************************/ 00439000
*/*                                                                  */ 00440000
*/* SEGMENT NAME - TAPEONLY                                          */ 00441000
*/*                                                                  */ 00442000
*/* DESCRIPTIVE NAME - TAPE ONLY PROCESSING FOR REFERENCED DD.       */ 00443000
*/*                                                                  */ 00444000
*/* FUNCTION -TO PROVIDE THE MAXIMUM POSSIBLE RANGE OF ELIGIBILITY IF*/ 00445000
*/*           REFERENCE (VIA INTER STEP VOL=REF OR DSN FOUND         */ 00446000
*/*           IN PDI) SOURCE IS NOT A 7 TRACK TAPE DATA SET.         */ 00447000
*/*           GET TAPE ONLY INFORMATION FROM A RETRIEVED DD.         */ 00448000
*/*                                                                  */ 00449000
*/*                                                                  */ 00450000
*/* ENTRY - FROM DD REFERENCE COMPLETION.                            */ 00451000
*/*                                                                  */ 00452000
*/*   PURPOSE - SEE FUNCTION.                                        */ 00453000
*/*   INPUT DATA - DENSITY,LABEL INFORMATION AND UNIT INFORMATION    */ 00454000
*/*                IN A REFERENCED DD.                               */ 00455000
*/*                                                                  */ 00456000
*/* EXIT -                                                           */ 00457000
*/*   CONDITION - ALL                                                */ 00458000
*/*                                                                  */ 00459000
*/*   OUTPUT DATA - A UNIT TYPE THAT WILL ENCOMPASS THE GREATEST     */ 00460000
*/*                 RANGE OF ELIGIBILTY.                             */ 00461000
*/*                 DENSITY (IF NOT CODED) AND FILE SEQUENCE         */ 00462000
*/*                 INFORMATION IS COPIED FROM SOURCE TO CURRENT DD. */ 00463000
*/*                                                                  */ 00464000
*/*   RETURN CODE - NONE                                             */ 00465000
*/*                                                                  */ 00466000
*/********************************************************************/ 00467000
*                                                               03S0194 00468000
*             RFY                                               03S0194 00469000
*               INFMJFCB BASED(RJFCBP);                         03S0194 00470000
*             IF HW7TRK=NO&SCTVREF=NO&JFCDEN^=0 THEN/* GET MAX. 03S0195 00471000
*                                      ELIGIBILITY IF NOT 7 TRACK AND   00472000
*                                      NOT                   @YM07531*/ 00473000
         TM    HW7TRK(@10),B'10000000'                          03S0195 00474000
         BNZ   @RF00195                                         03S0195 00475000
         TM    SCTVREF(CSIOTP),B'00010000'                      03S0195 00476000
         BNZ   @RF00195                                         03S0195 00477000
         CLI   JFCDEN(RJFCBP),0                                 03S0195 00478000
         BE    @RF00195                                         03S0195 00479000
*               DO;                 /* INTRA-STEP VOL=REF. REF. 03S0196 00480000
*                                      SOURCE MUST HAVE A DENSITY.   */ 00481000
*                 HWOBYTE=0;        /* CLEAR OPTION BYTE.            */ 00482000
         MVI   HWOBYTE(@10),X'00'                               03S0197 00483000
*                 IF RSIOTP->S3400DSP=NO THEN/* IF REFERENCED ISN'T     00484000
*                                      3400 ONLY                     */ 00485000
         TM    S3400DSP(RSIOTP),B'01000000'                     03S0198 00486000
         BNZ   @RF00198                                         03S0198 00487000
*                   HWTYPE=T2400;   /* MAKE THIS 2400 SERIES TAPE.   */ 00488000
         MVI   HWTYPE(@10),X'01'                                03S0199 00489000
*                 IF JFCDEN=DEN6250 THEN/* IF IT IS 6250 BPI GIVE    */ 00490000
@RF00198 CLI   JFCDEN(RJFCBP),X'D3'                             03S0200 00491000
         BNE   @RF00200                                         03S0200 00492000
*                   DO;                                         03S0201 00493000
*                     HWMBYTE=TBPI6250;/* 3400 SERIES 6250 BPI TAPE. */ 00494000
         LA    @10,DEVTYPE                                      03S0202 00495000
         MVI   HWMBYTE(@10),X'32'                               03S0202 00496000
*                     HWTYPE=T3400;                             03S0203 00497000
         MVI   HWTYPE(@10),X'03'                                03S0203 00498000
*                   END;                                        03S0204 00499000
*                 ELSE              /* NOT 6250                      */ 00500000
*                   IF JFCDEN=DEN1600 THEN/* IF 1600 BPI THEN GIVE   */ 00501000
         B     @RC00200                                         03S0205 00502000
@RF00200 CLI   JFCDEN(RJFCBP),X'C3'                             03S0205 00503000
         BNE   @RF00205                                         03S0205 00504000
*                     HWMBYTE=TBPI1600;/* 1600 BPI MAX. ELIGIBILITY. */ 00505000
         LA    @10,DEVTYPE                                      03S0206 00506000
         MVI   HWMBYTE(@10),X'34'                               03S0206 00507000
*                   ELSE            /* NOT 1600                      */ 00508000
*                     IF JFCDEN=DEN800 THEN/* IF 800 BPI AND         */ 00509000
         B     @RC00205                                         03S0207 00510000
@RF00205 CLI   JFCDEN(RJFCBP),X'83'                             03S0207 00511000
         BNE   @RF00207                                         03S0207 00512000
*                       IF RSIOTP->S3400DSP=NO THEN/* ELIGIBLE FOR      00513000
*                                      2400 THEN                     */ 00514000
         TM    S3400DSP(RSIOTP),B'01000000'                     03S0208 00515000
         BNZ   @RF00208                                         03S0208 00516000
*                         HWMBYTE=TBPI800;/* GIVE MAX. 800 BPI  03S0209 00517000
*                                      ELIGIBILITY.                  */ 00518000
         LA    @10,DEVTYPE                                      03S0209 00519000
         MVI   HWMBYTE(@10),X'30'                               03S0209 00520000
*                       ELSE        /* 3400 ONLY AND 800 BPI         */ 00521000
*                         DO;       /* NEEDS 3400 SERIES DUAL   03S0210 00522000
*                                      DENSITY.                      */ 00523000
         B     @RC00208                                         03S0210 00524000
@RF00208 DS    0H                                               03S0211 00525000
*                           HWMBYTE=TBPI1600;/* MAKE IT 3400 SERIES     00526000
*                                      800/1600                      */ 00527000
         LA    @10,DEVTYPE                                      03S0211 00528000
         MVI   HWMBYTE(@10),X'34'                               03S0211 00529000
*                           HWOBYTE=DUALDEN;/* BPI DUAL DENSITY.     */ 00530000
         MVI   HWOBYTE(@10),X'20'                               03S0212 00531000
*                         END;                                  03S0213 00532000
*               END;                                            03S0214 00533000
@RC00208 DS    0H                                               03S0214 00534000
@RF00207 DS    0H                                               03S0214 00535000
@RC00205 DS    0H                                               03S0214 00536000
@RC00200 DS    0H                                               03S0215 00537000
*             RFY                                               03S0215 00538000
*               INFMJFCB BASED(CJFCBP);                         03S0215 00539000
@RF00195 DS    0H                                               03S0216 00540000
*             IF JFCDEN=0 THEN      /* IF NO DENSITY WAS CODED THEN  */ 00541000
         CLI   JFCDEN(CJFCBP),0                                 03S0216 00542000
         BNE   @RF00216                                         03S0216 00543000
*               JFCDEN=RJFCBP->JFCDEN;/* GET IT FROM SOURCE DD.      */ 00544000
         MVC   JFCDEN(1,CJFCBP),JFCDEN(RJFCBP)                  03S0217 00545000
*             IF SCTVOLAF=NO THEN   /* IF NOT VOLUME REFERENCE       */ 00546000
@RF00216 TM    SCTVOLAF(CSIOTP),B'00100000'                     03S0218 00547000
         BNZ   @RF00218                                         03S0218 00548000
*               JFCBFLSQ=RJFCBP->JFCBFLSQ;/* COPY FILE SEQUENCE.     */ 00549000
         LH    @10,JFCBFLSQ(,RJFCBP)                            03S0219 00550000
         STH   @10,JFCBFLSQ(,CJFCBP)                            03S0219 00551000
*           END;                    /* END DD REFERENCE TAPE ONLY.   */ 00552000
@RF00218 DS    0H                                               02S0221 00553000
*         IF RSIOTP->SCTUNLBD=YES THEN/* IF SOURCE DD IS UNLABELLED     00554000
*                                      THEN                          */ 00555000
@RF00192 TM    SCTUNLBD(RSIOTP),B'00001000'                     02S0221 00556000
         BNO   @RF00221                                         02S0221 00557000
*           SCTUNLBD=YES;           /* MAKE CURRENT UNLABELLED       */ 00558000
         OI    SCTUNLBD(CSIOTP),B'00001000'                     02S0222 00559000
*         IF HWDA=NO|JFCSUL=NO&JFCSL=NO THEN/* IF THIS ISN'T A SUL DA   00560000
*                                      DEVICE,                       */ 00561000
@RF00221 LA    @10,DEVTYPE                                      02S0223 00562000
         TM    HWDA(@10),B'00100000'                            02S0223 00563000
         BZ    @RT00223                                         02S0223 00564000
         TM    JFCSUL(CJFCBP),B'00001010'                       02S0223 00565000
         BNZ   @RF00223                                         02S0223 00566000
@RT00223 DS    0H                                               02S0224 00567000
*           JFCBLTYP=RJFCBP->JFCBLTYP;/* COPY LABEL INFORMATION.     */ 00568000
         MVC   JFCBLTYP(1,CJFCBP),JFCBLTYP(RJFCBP)              02S0224 00569000
*         IF RSIOTP->SIOTPRIV=YES THEN/* IF SOURCE DD IS PRIVATE THEN*/ 00570000
@RF00223 TM    SIOTPRIV(RSIOTP),B'00100000'                     02S0225 00571000
         BNO   @RF00225                                         02S0225 00572000
*           SIOTPRIV=YES;           /* MAKE CURRENT PRIVATE.         */ 00573000
         OI    SIOTPRIV(CSIOTP),B'00100000'                     02S0226 00574000
*         IF HWDA=YES&SCTRECVD=YES THEN/* COPY DSN'S DSCB TTR FOR DA */ 00575000
@RF00225 LA    @10,DEVTYPE                                      02S0227 00576000
         TM    HWDA(@10),B'00100000'                            02S0227 00577000
         BNO   @RF00227                                         02S0227 00578000
         TM    SCTRECVD(CSIOTP),B'00000001'                     02S0227 00579000
         BNO   @RF00227                                         02S0227 00580000
*           JFCBDSCB=RJFCBP->JFCBDSCB;/* IF RECEIVED DATA SET.       */ 00581000
         MVC   JFCBDSCB(3,CJFCBP),JFCBDSCB(RJFCBP)              02S0228 00582000
*         IF JFCBNVOL^=0 THEN       /* IF A SPECIFIC REQUEST @ZA15749*/ 00583000
@RF00227 CLI   JFCBNVOL(CJFCBP),0                               02S0229 00584000
         BE    @RF00229                                         02S0229 00585000
*           DO;                     /* CLEAR MSVGP INFO      @ZA15749*/ 00586000
*             JFCMSVGP=BLANKS;      /* CLEAR MSVG NAME FIELD @ZA15749*/ 00587000
         MVC   JFCMSVGP(8,CJFCBP),BLANKS                        02S0231 00588000
*           END;                                                02S0232 00589000
*         JVOLPTR=ADDR(JFCBVOLS);   /* WHERE TO COPY VOLSERS.        */ 00590000
@RF00229 LA    JVOLPTR,JFCBVOLS(,CJFCBP)                        02S0233 00591000
*         RFY                                                   02S0234 00592000
*           INFMJFCB BASED(RJFCBP);                             02S0234 00593000
*         RVOLPTR=ADDR(JFCBVOLS);   /* 1ST SOURCE VOLSER PTR.        */ 00594000
         LA    RVOLPTR,JFCBVOLS(,RJFCBP)                        02S0235 00595000
*         RFY                                                   02S0236 00596000
*           INFMJFCB BASED(CJFCBP);                             02S0236 00597000
*         VOLSDONE=NO;              /* INDICATE VOLSERS NOT YET 02S0237 00598000
*                                      COPIED.                       */ 00599000
         NI    VOLSDONE,B'01111111'                             02S0237 00600000
*                                                               03S0238 00601000
*/********************************************************************/ 00602000
*/*                                                                  */ 00603000
*/* SEGMENT NAME - DDVLCOPY                                          */ 00604000
*/*                                                                  */ 00605000
*/* DESCRIPTIVE NAME - DD REFERENCE VOLUME SERIAL COPY.              */ 00606000
*/*                                                                  */ 00607000
*/* FUNCTION - COPY VOLUME SERIAL NUMBERS FROM THE REFERENCED        */ 00608000
*/*            JFCB(X) TO THE CURRENT JFCB(X).                       */ 00609000
*/*            IF COPY IS FOR VOL=REF TO TAPE ONLY THE LAST VOLUME   */ 00610000
*/*            SERIAL IS COPIED.                                     */ 00611000
*/*            JFCBXGEN IS USED TO DETERMINE IF JFCBX(S) ARE         */ 00612000
*/*            REQUIRED FOR NON VOL=REF TO TAPE SITUATIONS.          */ 00613000
*/*                                                                  */ 00614000
*/* ENTRY -                                                          */ 00615000
*/*   PURPOSE - SEE FUNCTION.                                        */ 00616000
*/*                                                                  */ 00617000
*/*   INPUT DATA - CURRENT SIOT,JFCB ,JFCBX(S) AND REFERENCED SIOT,  */ 00618000
*/*                JFCB,JFCBX(S).                                    */ 00619000
*/*                                                                  */ 00620000
*/* EXITS -                                                          */ 00621000
*/*   CONDITIONS - N/A                                               */ 00622000
*/*                                                                  */ 00623000
*/*   OUTPUT DATA - UPDATED SIOT,UPDATED JFCB, UPDATED/CREATED JFCBX.*/ 00624000
*/*                                                                  */ 00625000
*/*   RETURN CODE - NONE.                                            */ 00626000
*/*                                                                  */ 00627000
*/********************************************************************/ 00628000
*                                                               03S0238 00629000
*         DO WHILE(RVOLPTR->VSER^=BLANK/* COPY ALL VOLUME SERIALS.   */ 00630000
*               &VOLSDONE=NO);                                  03S0238 00631000
         B     @DE00238                                         03S0238 00632000
@DL00238 DS    0H                                               03S0239 00633000
*           VSER=RVOLPTR->VSER;     /* COPY VOLSER TO CURRENT DD     */ 00634000
         MVC   VSER(6,JVOLPTR),VSER(RVOLPTR)                    03S0239 00635000
*           SCTVOLCT=SCTVOLCT+1;    /* UPDATE THE NUMBER OF VOLSERS. */ 00636000
         LA    @10,1                                            03S0240 00637000
         SLR   @09,@09                                          03S0240 00638000
         IC    @09,SCTVOLCT(,CSIOTP)                            03S0240 00639000
         ALR   @10,@09                                          03S0240 00640000
         STC   @10,SCTVOLCT(,CSIOTP)                            03S0240 00641000
*           IF SCTVOLCT//JFXVLNO-JFBVLNO=0 THEN/* SEE IF A JFCBX IS     00642000
*                                      THE                           */ 00643000
         SLR   @09,@09                                          03S0241 00644000
         LR    @00,@10                                          03S0241 00645000
         SRDA  @00,32                                           03S0241 00646000
         D     @00,@CF00058                                     03S0241 00647000
         SL    @00,@CF00133                                     03S0241 00648000
         CR    @00,@09                                          03S0241 00649000
         BNE   @RF00241                                         03S0241 00650000
*             DO;                   /* SOURCE FOR NEXT VOLSER.       */ 00651000
*               IF SCTVOLCT=JFBVLNO THEN/* NO. OF VOLUMES IN A  03S0243 00652000
*                                      JFCB,SO                       */ 00653000
         CLI   SCTVOLCT(CSIOTP),5                               03S0243 00654000
         BNE   @RF00243                                         03S0243 00655000
*                 IF RSIOTP->SIOTJFX^=0 THEN/* IF JFCBX(S) EXIST THEN*/ 00656000
         L     @10,SIOTJFX(,RSIOTP)                             03S0244 00657000
         CR    @10,@09                                          03S0244 00658000
         BE    @RF00244                                         03S0244 00659000
*                   RJFCBXP=RSIOTP->SIOTJFX;/* GET FIRST JFCBX.      */ 00660000
         LR    RJFCBXP,@10                                      03S0245 00661000
*                 ELSE              /* NO JFCBX SO                   */ 00662000
*                   VOLSDONE=YES;   /* INDICATE ALL VOLSERS COPIED.  */ 00663000
         B     @RC00244                                         03S0246 00664000
@RF00244 OI    VOLSDONE,B'10000000'                             03S0246 00665000
*               ELSE                /* NOT FIRST JFCBX,GET A PTR NEXT*/ 00666000
*                 IF RJFCBXP->JFCBXNXT^=0 THEN/* JFCBX ON CHAIN,IF      00667000
*                                      ANY.                          */ 00668000
         B     @RC00243                                         03S0247 00669000
@RF00243 L     @10,JFCBXNXT(,RJFCBXP)                           03S0247 00670000
         LTR   @10,@10                                          03S0247 00671000
         BZ    @RF00247                                         03S0247 00672000
*                   RJFCBXP=RJFCBXP->JFCBXNXT;/* NEXT JFCBX ON THE      00673000
*                                      CHAIN.                        */ 00674000
         LR    RJFCBXP,@10                                      03S0248 00675000
*                 ELSE              /* NO JFCBX SO                   */ 00676000
*                   VOLSDONE=YES;   /* INDICATE ALL VOLSERS COPIED.  */ 00677000
         B     @RC00247                                         03S0249 00678000
@RF00247 OI    VOLSDONE,B'10000000'                             03S0249 00679000
*               RVOLPTR=ADDR(RJFCBXP->JFCBXVOL);/* PTR TO SOURCE        00680000
*                                      VOLSER.                       */ 00681000
@RC00247 DS    0H                                               03S0250 00682000
@RC00243 LA    RVOLPTR,JFCBXVOL(,RJFCBXP)                       03S0250 00683000
*               IF RVOLPTR->VSER=BLANK THEN/* IF 1ST VOLSER IS BLANK,*/ 00684000
         CLC   VSER(6,RVOLPTR),BLANK                            03S0251 00685000
         BNE   @RF00251                                         03S0251 00686000
*                 VOLSDONE=YES;     /* DON'T CREATE A NEW JFCBX.     */ 00687000
         OI    VOLSDONE,B'10000000'                             03S0252 00688000
*             END;                                              03S0253 00689000
*           ELSE                    /* IF NO NEW JFCBX THEN          */ 00690000
*             RVOLPTR=RVOLPTR+VOLSERLN;/* UPDATE PTR IN THIS JFCBX.  */ 00691000
         B     @RC00241                                         03S0254 00692000
@RF00241 AL    RVOLPTR,@CF00105                                 03S0254 00693000
*           IF(HWTAPE=NO|SCTVOLAF=NO)/* IF NOT VOLREF TO TAPE DATA      00694000
*                                      SET                           */ 00695000
*               &VOLSDONE=NO THEN   /* AND ALL VOLSERS ARE NOT COPIED*/ 00696000
@RC00241 LA    @10,DEVTYPE                                      03S0255 00697000
         TM    HWTAPE(@10),B'10000000'                          03S0255 00698000
         BZ    @GL00015                                         03S0255 00699000
         TM    SCTVOLAF(CSIOTP),B'00100000'                     03S0255 00700000
         BNZ   @RF00255                                         03S0255 00701000
@GL00015 TM    VOLSDONE,B'10000000'                             03S0255 00702000
         BNZ   @RF00255                                         03S0255 00703000
*             CALL JFCBXGEN;        /* GET NEXT VOLSER SLOT          */ 00704000
         BAL   @14,JFCBXGEN                                     03S0256 00705000
*         END;                      /* END DD REFERENCE VOLSER COPY. */ 00706000
@RF00255 DS    0H                                               03S0257 00707000
@DE00238 CLC   VSER(6,RVOLPTR),BLANK                            03S0257 00708000
         BE    @DC00238                                         03S0257 00709000
         TM    VOLSDONE,B'10000000'                             03S0257 00710000
         BZ    @DL00238                                         03S0257 00711000
@DC00238 DS    0H                                               03S0258 00712000
*         IF HWTAPE=YES&SCTVOLAF=YES&SCTVOLCT^=0 THEN/* IF COPY WAS     00713000
*                                      FOR A VOLREF TO TAPE THEN ONLY   00714000
*                                      LAST                          */ 00715000
         LA    @10,DEVTYPE                                      02S0258 00716000
         TM    HWTAPE(@10),B'10000000'                          02S0258 00717000
         BNO   @RF00258                                         02S0258 00718000
         TM    SCTVOLAF(CSIOTP),B'00100000'                     02S0258 00719000
         BNO   @RF00258                                         02S0258 00720000
         CLI   SCTVOLCT(CSIOTP),0                               02S0258 00721000
         BE    @RF00258                                         02S0258 00722000
*           DO;                     /* SPECIFIC VOLSER IS USED.      */ 00723000
*                                                               03S0260 00724000
*/********************************************************************/ 00725000
*/*                                                                  */ 00726000
*/* SEGMENT NAME - TAPEVREF.                                         */ 00727000
*/*                                                                  */ 00728000
*/* DESCRIPTIVE NAME - DD REFERENCE/VOLUME REFERENCE FOR TAPE.       */ 00729000
*/*                                                                  */ 00730000
*/* FUNCTION - TO OBTAIN THE PROPER VOLUME SERIAL WHEN VOLUME        */ 00731000
*/*            REFERENCE IS TO A TAPE VOLUME IN A PREVIOUS DD.       */ 00732000
*/*            IF THE VOLUME REFERENCE IS TO A DD WITH A GENERATED   */ 00733000
*/*            VOLUME SERIAL NUMBER AND THAT DD DID NOT GENERATE THAT*/ 00734000
*/*            VOLUME SERIAL NUMBER THEN THE GENERATING DD IS READ.  */ 00735000
*/*            THE LAST VOLUME SERIAL IS THEN OBTAINED FROM THE      */ 00736000
*/*            ORIGINAL DD.                                          */ 00737000
*/*                                                                  */ 00738000
*/* ENTRY -                                                          */ 00739000
*/*   PURPOSE - SEE FUNCTION.                                        */ 00740000
*/*                                                                  */ 00741000
*/*   INPUT DATA - VOLUME SERIAL(ORIGINAL JFCB SVA IN VIRTUAL VOLSER)*/ 00742000
*/*                                                                  */ 00743000
*/* EXITS -                                                          */ 00744000
*/*  CONDITION - N/A                                                 */ 00745000
*/*                                                                  */ 00746000
*/*  OUTPUT DATA - JFCB CONTAINS LAST VOLUME SERIAL IN REFERENCED DD.*/ 00747000
*/*                                                                  */ 00748000
*/*  RETURN CODE - NONE.                                             */ 00749000
*/*                                                                  */ 00750000
*/********************************************************************/ 00751000
*                                                               03S0260 00752000
*             SCTVOLCT=1;           /* 1 VOLSER WAS ACTUALLY COPIED. */ 00753000
         MVI   SCTVOLCT(CSIOTP),X'01'                           03S0260 00754000
*             IF JFCBVOLS(1)=VIRTUAL/* IF THIS IS A GENERATED VOLSER */ 00755000
*                 &JFCBVOLS(2:4)^=RSIOTP->SCTPJFCB THEN/* BUT NOT BY    00756000
*                                      THE                           */ 00757000
         CLI   JFCBVOLS(CJFCBP),X'FF'                           03S0261 00758000
         BNE   @RF00261                                         03S0261 00759000
         CLC   JFCBVOLS+1(3,CJFCBP),SCTPJFCB(RSIOTP)            03S0261 00760000
         BE    @RF00261                                         03S0261 00761000
*               DO;                 /* SOURCE,THEN GET ORIGINAL DD   */ 00762000
*                 SWACTLS=0;        /* CLEAR SWA FUNCTION MAP.       */ 00763000
         SLR   @10,@10                                          03S0263 00764000
         STH   @10,SWACTLS                                      03S0263 00765000
*                 SWREAD=YES;       /* INDICATE READ.                */ 00766000
         OI    SWREAD,B'00100000'                               03S0264 00767000
*                 IF HWLEPARP=0 THEN/* IF NO EPA EXISTS THEN         */ 00768000
         L     @09,@PC00001+4                                   03S0265 00769000
         L     @09,HWDATAP(,@09)                                03S0265 00770000
         C     @10,HWLEPARP(,@09)                               03S0265 00771000
         BNE   @RF00265                                         03S0265 00772000
*                   SWNEW=YES;      /* TELL SWA INTERFACE TO CREATE     00773000
*                                      ONE                           */ 00774000
         OI    SWNEW,B'00001000'                                03S0266 00775000
*                 ELSE              /* OTHERWISE TELL SWA INTERFACE  */ 00776000
*                   SWMOD=YES;      /* TO USE EXISTING EPA.          */ 00777000
         B     @RC00265                                         03S0267 00778000
@RF00265 OI    SWMOD,B'00000010'                                03S0267 00779000
*                 CALL IEFAB4F7(SWACTLS,HWLEPARP,0,/* READ           */ 00780000
*                     ADDR(JFCBVOLS(2)),ADDR(ORGJFBP),0,1);/* ORIGIN    00781000
*                                      JFCB                          */ 00782000
@RC00265 LA    @10,SWACTLS                                      03S0268 00783000
         ST    @10,@AL00001                                     03S0268 00784000
         L     @10,@PC00001+4                                   03S0268 00785000
         L     @10,HWDATAP(,@10)                                03S0268 00786000
         LA    @10,HWLEPARP(,@10)                               03S0268 00787000
         ST    @10,@AL00001+4                                   03S0268 00788000
         LA    @10,@CF00638                                     03S0268 00789000
         ST    @10,@AL00001+8                                   03S0268 00790000
         LA    @10,JFCBVOLS+1(,CJFCBP)                          03S0268 00791000
         ST    @10,@TF00001                                     03S0268 00792000
         LA    @10,@TF00001                                     03S0268 00793000
         ST    @10,@AL00001+12                                  03S0268 00794000
         LA    @10,ORGJFBP                                      03S0268 00795000
         ST    @10,@TF00002                                     03S0268 00796000
         LA    @10,@TF00002                                     03S0268 00797000
         ST    @10,@AL00001+16                                  03S0268 00798000
         LA    @10,@CF00638                                     03S0268 00799000
         ST    @10,@AL00001+20                                  03S0268 00800000
         LA    @10,@CF00070                                     03S0268 00801000
         ST    @10,@AL00001+24                                  03S0268 00802000
         L     @15,@CV00161                                     03S0268 00803000
         LA    @01,@AL00001                                     03S0268 00804000
         BALR  @14,@15                                          03S0268 00805000
*                 VOLSDONE=NO;      /* INDICATE VOLSERS NOT COPIED      00806000
*                                      YET.                          */ 00807000
         NI    VOLSDONE,B'01111111'                             03S0269 00808000
*                 JVOLPTR=ADDR(ORGJFBP->JFCBVOLS);/* PTR TO 1ST 03S0270 00809000
*                                      VOLSER.                       */ 00810000
         L     JVOLPTR,ORGJFBP                                  03S0270 00811000
         LA    JVOLPTR,JFCBVOLS(,JVOLPTR)                       03S0270 00812000
*                 DO VOLCOPY=1 TO JFBVLNO/* SCAN THE JFCB FOR        */ 00813000
*                       WHILE(VOLSDONE=NO);/* FOR THE LAST VOLUME       00814000
*                                      SERIAL.                       */ 00815000
         LA    VOLCOPY,1                                        03S0271 00816000
@DL00271 TM    VOLSDONE,B'10000000'                             03S0271 00817000
         BNZ   @DC00271                                         03S0271 00818000
*                   IF VSER^=BLANK THEN/* IF THIS VOLSER IS NOT BLANK*/ 00819000
         CLC   VSER(6,JVOLPTR),BLANK                            03S0272 00820000
         BE    @RF00272                                         03S0272 00821000
*                     DO;           /* COPY IT TO CURRENT JFCB.      */ 00822000
*                       JFCBVOLS(1:VOLSERLN)=VSER;/* COPY VOLUME        00823000
*                                      SERIAL.                       */ 00824000
         MVC   JFCBVOLS(6,CJFCBP),VSER(JVOLPTR)                 03S0274 00825000
*                       JVOLPTR=JVOLPTR+VOLSERLN;/* POINT TO NEXT       00826000
*                                      VOLSER                        */ 00827000
         AL    JVOLPTR,@CF00105                                 03S0275 00828000
*                     END;                                      03S0276 00829000
*                   ELSE            /* IF THIS VOLSER IS BLANK THEN     00830000
*                                      THE                           */ 00831000
*                     VOLSDONE=YES; /* LAST VOLSER HAS BEEN COPIED.  */ 00832000
         B     @RC00272                                         03S0277 00833000
@RF00272 OI    VOLSDONE,B'10000000'                             03S0277 00834000
*                 END;              /* END ORIGINAL JFCB SCAN.       */ 00835000
@RC00272 AL    VOLCOPY,@CF00070                                 03S0278 00836000
         C     VOLCOPY,@CF00133                                 03S0278 00837000
         BNH   @DL00271                                         03S0278 00838000
@DC00271 DS    0H                                               03S0279 00839000
*                 JSVAP=ADDR(ORGJFBP->JFCBEXAD);/* SET SVA TO READ      00840000
*                                      FOR 1ST JFCBX.                */ 00841000
         L     @10,ORGJFBP                                      03S0279 00842000
         LA    @10,JFCBEXAD(,@10)                               03S0279 00843000
         ST    @10,JSVAP                                        03S0279 00844000
*                 SWNEW=NO;         /* TURN OFF NEW EPA INDICATOR.   */ 00845000
*                 SWMOD=YES;        /* USE EPA IN HWLEPARP.          */ 00846000
         OI    SWMOD,B'00000010'                                03S0281 00847000
         NI    SWNEW,B'11110111'                                03S0281 00848000
*                 DO WHILE(VOLSDONE=NO/* SCAN IT FOR LAST VOLSER,    */ 00849000
*                       &JSVA^=0);  /* IF A JFCBX SVA EXISTS.        */ 00850000
         B     @DE00282                                         03S0282 00851000
@DL00282 DS    0H                                               03S0283 00852000
*                   CALL IEFAB4F7   /* READ A JFCBX.                 */ 00853000
*                       (SWACTLS,HWLEPARP,0,JSVAP,ADDR(JFCBXPTR),0,1);  00854000
         LA    @10,SWACTLS                                      03S0283 00855000
         ST    @10,@AL00001                                     03S0283 00856000
         L     @10,@PC00001+4                                   03S0283 00857000
         L     @10,HWDATAP(,@10)                                03S0283 00858000
         LA    @10,HWLEPARP(,@10)                               03S0283 00859000
         ST    @10,@AL00001+4                                   03S0283 00860000
         LA    @10,@CF00638                                     03S0283 00861000
         ST    @10,@AL00001+8                                   03S0283 00862000
         LA    @10,JSVAP                                        03S0283 00863000
         ST    @10,@AL00001+12                                  03S0283 00864000
         LA    @10,JFCBXPTR                                     03S0283 00865000
         ST    @10,@TF00001                                     03S0283 00866000
         LA    @10,@TF00001                                     03S0283 00867000
         ST    @10,@AL00001+16                                  03S0283 00868000
         LA    @10,@CF00638                                     03S0283 00869000
         ST    @10,@AL00001+20                                  03S0283 00870000
         LA    @10,@CF00070                                     03S0283 00871000
         ST    @10,@AL00001+24                                  03S0283 00872000
         L     @15,@CV00161                                     03S0283 00873000
         LA    @01,@AL00001                                     03S0283 00874000
         BALR  @14,@15                                          03S0283 00875000
*                   DO VOLCOPY=1 TO JFXVLNO/* SCAN THE JFCBX         */ 00876000
*                         WHILE(VOLSDONE=NO);/* FOR LAST VOLUME 03S0284 00877000
*                                      SERIAL.                       */ 00878000
         LA    VOLCOPY,1                                        03S0284 00879000
@DL00284 TM    VOLSDONE,B'10000000'                             03S0284 00880000
         BNZ   @DC00284                                         03S0284 00881000
*                     IF JFCBXVOL(VOLCOPY)^=BLANK THEN/* VOLSER NOT     00882000
*                                      BLANK                         */ 00883000
         L     @10,JFCBXPTR                                     03S0285 00884000
         LR    @09,VOLCOPY                                      03S0285 00885000
         MH    @09,@CH00105                                     03S0285 00886000
         ST    @09,@TF00001                                     03S0285 00887000
         ALR   @09,@10                                          03S0285 00888000
         BCTR  @09,0                                            03S0285 00889000
         BCTR  @09,0                                            03S0285 00890000
         CLC   JFCBXVOL-4(6,@09),BLANK                          03S0285 00891000
         BE    @RF00285                                         03S0285 00892000
*                       JFCBVOLS(1:VOLSERLN)=JFCBXVOL(VOLCOPY);/*       00893000
*                                      COPY IT                       */ 00894000
         AL    @10,@TF00001                                     03S0286 00895000
         BCTR  @10,0                                            03S0286 00896000
         BCTR  @10,0                                            03S0286 00897000
         MVC   JFCBVOLS(6,CJFCBP),JFCBXVOL-4(@10)               03S0286 00898000
*                     ELSE          /* IF THIS VOLSER IS BLANK THEN     00899000
*                                      THE                           */ 00900000
*                       VOLSDONE=YES;/* LAST VOLSER HAS BEEN COPIED. */ 00901000
         B     @RC00285                                         03S0287 00902000
@RF00285 OI    VOLSDONE,B'10000000'                             03S0287 00903000
*                   END;            /* END JFCBX SCAN.               */ 00904000
@RC00285 AL    VOLCOPY,@CF00070                                 03S0288 00905000
         C     VOLCOPY,@CF00058                                 03S0288 00906000
         BNH   @DL00284                                         03S0288 00907000
@DC00284 DS    0H                                               03S0289 00908000
*                   JSVAP=ADDR(JFCBXTTR);/* SET SVA TO READ NEXT        00909000
*                                      JFCBX.                        */ 00910000
         L     @10,JFCBXPTR                                     03S0289 00911000
         ST    @10,JSVAP                                        03S0289 00912000
*                 END;              /* END LAST ORIGINAL VOLSER SCAN.*/ 00913000
@DE00282 TM    VOLSDONE,B'10000000'                             03S0290 00914000
         BNZ   @DC00282                                         03S0290 00915000
         L     @10,JSVAP                                        03S0290 00916000
         BCTR  @10,0                                            03S0290 00917000
         L     @10,JSVA(,@10)                                   03S0290 00918000
         LA    @10,0(,@10)                                      03S0290 00919000
         LTR   @10,@10                                          03S0290 00920000
         BNZ   @DL00282                                         03S0290 00921000
@DC00282 DS    0H                                               03S0291 00922000
*               END;                                            03S0291 00923000
*           END;                    /* END FOR VOL=REF TO TAPE DATA     00924000
*                                      SET                           */ 00925000
@RF00261 DS    0H                                               02S0293 00926000
*         JFCBNVOL=SCTVOLCT;        /* TELL DATA MGMNT NUMBER OF        00927000
*                                      VOLS.                         */ 00928000
@RF00258 IC    @10,SCTVOLCT(,CSIOTP)                            02S0293 00929000
         STC   @10,JFCBNVOL(,CJFCBP)                            02S0293 00930000
*         IF SCTVREF=YES THEN       /* IF REF. SIOT WAS FOR          */ 00931000
         TM    SCTVREF(CSIOTP),B'00010000'                      02S0294 00932000
         BNO   @RF00294                                         02S0294 00933000
*           DO;                     /* INTRA-STEP VOL=REF THEN       */ 00934000
*             SCTVREF=NO;           /* TURN OFF VOLUME REFERENCE.    */ 00935000
         NI    SCTVREF(CSIOTP),B'11101111'                      02S0296 00936000
*             SIOTVAFF=YES;         /* TURN ON VOLUME AFFINITY.      */ 00937000
         OI    SIOTVAFF(CSIOTP),B'00000100'                     02S0297 00938000
*             IF RSIOTP->SIOTDMND=YES THEN/* IF REFERENCED REQUEST      00939000
*                                      IS,                           */ 00940000
         TM    SIOTDMND(RSIOTP),B'10000000'                     02S0298 00941000
         BNO   @RF00298                                         02S0298 00942000
*               SIOTDMND=YES;       /* MAKE THIS A, DEMAND REQUEST.  */ 00943000
         OI    SIOTDMND(CSIOTP),B'10000000'                     02S0299 00944000
*             IF RSIOTP->SIOTSSDS=YES/* REFERENCE IS SUBSYSTEM OR       00945000
*                                      DUMMY                         */ 00946000
*                 |RSIOTP->SCTDUMMY=YES THEN/* DATA SET INDICATE     */ 00947000
@RF00298 TM    SIOTSSDS(RSIOTP),B'10000000'                     02S0300 00948000
         BO    @RT00300                                         02S0300 00949000
         TM    SCTDUMMY(RSIOTP),B'10000000'                     02S0300 00950000
         BNO   @RF00300                                         02S0300 00951000
@RT00300 DS    0H                                               02S0301 00952000
*               SIOTREFN=0;         /* NO VOLUME AFFINITY.           */ 00953000
         SLR   @10,@10                                          02S0301 00954000
         STH   @10,SIOTREFN(,CSIOTP)                            02S0301 00955000
*             ELSE                  /* NOT SUB OR DUMMY              */ 00956000
*               SIOTREFN=RSIOTP->SCTDDINO;/* PASS AFFINITY DD NO.    */ 00957000
         B     @RC00300                                         02S0302 00958000
@RF00300 LH    @10,SCTDDINO(,RSIOTP)                            02S0302 00959000
         STH   @10,SIOTREFN(,CSIOTP)                            02S0302 00960000
*             IF RJFCBP->JFCBVOLS(1:6)=BLANK&/* REFD REQUEST IS 02S0303 00961000
*                                      NON-SPECIFIC          @ZA08546*/ 00962000
*                 SCTSMOD=YES&      /* MOD SPECIFIED         @ZA08546*/ 00963000
*                 (JFCBDSNM^=RJFCBP->JFCBDSNM|/* NOT THE SAME DATA      00964000
*                                      SET                   @ZA08546*/ 00965000
*                 (JFCORGIS=YES&    /* ISAM REQUEST          @ZA08546*/ 00966000
*                 JFCBELNM^=RJFCBP->JFCBELNM)) THEN/* DIFFERENT 02S0303 00967000
*                                      ELEMENTS OF ISAM DS   @ZA08546*/ 00968000
@RC00300 CLC   JFCBVOLS(6,RJFCBP),BLANK                         02S0303 00969000
         BNE   @RF00303                                         02S0303 00970000
         TM    SCTSMOD(CSIOTP),B'00000010'                      02S0303 00971000
         BNO   @RF00303                                         02S0303 00972000
         CLC   JFCBDSNM(44,CJFCBP),JFCBDSNM(RJFCBP)             02S0303 00973000
         BNE   @RT00303                                         02S0303 00974000
         TM    JFCORGIS(CJFCBP),B'10000000'                     02S0303 00975000
         BNO   @RF00303                                         02S0303 00976000
         CLC   JFCBELNM(8,CJFCBP),JFCBELNM(RJFCBP)              02S0303 00977000
         BE    @RF00303                                         02S0303 00978000
@RT00303 DS    0H                                               02S0304 00979000
*               DO;                                             02S0304 00980000
*                 SCTSMOD=NO;       /* RESET DISP OF MOD     @ZA08546*/ 00981000
*                 SCTSNEW=YES;      /* DISP IS NOW NEW       @ZA08546*/ 00982000
         OI    SCTSNEW(CSIOTP),B'00000100'                      02S0306 00983000
         NI    SCTSMOD(CSIOTP),B'11111101'                      02S0306 00984000
*                 JFCMODNW=YES;     /* MOD CHANGED TO NEW    @ZA08546*/ 00985000
         OI    JFCMODNW(CJFCBP),B'00010000'                     02S0307 00986000
*                 JFCDISP='11'B;    /* DISP OF NEW IN JFCB   @ZA08546*/ 00987000
         OI    JFCDISP(CJFCBP),B'11000000'                      02S0308 00988000
*               END;                /* END CHANGE MOD        @ZA08546*/ 00989000
*           END;                    /* END INTRA STEP VOL=REF.       */ 00990000
@RF00303 DS    0H                                               02S0311 00991000
*         IF SCTVOLAF=YES&RSIOTP->SIOTSSDS=YES THEN/* IF THIS IS A   */ 00992000
@RF00294 TM    SCTVOLAF(CSIOTP),B'00100000'                     02S0311 00993000
         BNO   @RF00311                                         02S0311 00994000
         TM    SIOTSSDS(RSIOTP),B'10000000'                     02S0311 00995000
         BNO   @RF00311                                         02S0311 00996000
*           DO;                     /* VOL=REF TO A SUBSYSTEM DATA      00997000
*                                      SET                           */ 00998000
*             HWOVRDN=YES;          /* OVERRIDE RETRIEVED DEVICE TYPE*/ 00999000
         L     @10,@PC00001                                     02S0313 01000000
         L     @09,HWCNTRLP(,@10)                               02S0313 01001000
         OI    HWOVRDN(@09),B'00100000'                         02S0313 01002000
*             CALL IEFAB470         /* CALL IEFAB470                 */ 01003000
*                 (HWCNTRLP,HWDATAP,HWRTNP,HWIOSLTP,ALLDA);     02S0314 01004000
         ST    @10,@AL00001                                     02S0314 01005000
         L     @10,@PC00001+4                                   02S0314 01006000
         ST    @10,@AL00001+4                                   02S0314 01007000
         L     @09,@PC00001+8                                   02S0314 01008000
         ST    @09,@AL00001+8                                   02S0314 01009000
         L     @10,HWDATAP(,@10)                                02S0314 01010000
         LA    @10,HWIOSLTP(,@10)                               02S0314 01011000
         ST    @10,@AL00001+12                                  02S0314 01012000
         LA    @10,ALLDA                                        02S0314 01013000
         ST    @10,@AL00001+16                                  02S0314 01014000
         L     @15,@CV00159                                     02S0314 01015000
         LA    @01,@AL00001                                     02S0314 01016000
         BALR  @14,@15                                          02S0314 01017000
*           END;                    /* WITH ESOTERIC FOR ALL DA 02S0315 01018000
*                                      DEVICES.                      */ 01019000
*       END;                        /* END DD REFERENCE.             */ 01020000
@RF00311 DS    0H                                               01S0317 01021000
*   IF HWRTCD=0 THEN                /* IF RETURN CODE = 0            */ 01022000
@RF00180 DS    0H                                               01S0317 01023000
@RC00119 L     @10,@PC00001+8                                   01S0317 01024000
         L     @10,HWRTNP(,@10)                                 01S0317 01025000
         LH    @10,HWRTCD(,@10)                                 01S0317 01026000
         LTR   @10,@10                                          01S0317 01027000
         BNZ   @RF00317                                         01S0317 01028000
*     DO;                                                       01S0318 01029000
*                                                               02S0319 01030000
*/********************************************************************/ 01031000
*/*                                                                  */ 01032000
*/* SEGMENT NAME - VIOCOMP                                           */ 01033000
*/*                                                                  */ 01034000
*/* DESCRIPTIVE NAME - VIRTUAL I/O SIOT COMPLETION.                  */ 01035000
*/*                                                                  */ 01036000
*/* FUNCTION - MARK THE REQUEST, IF IT IS NOT A DD DUMMY,            */ 01037000
*/*            VIO(VAM) FOR SUBSEQUENT DADSM.                        */ 01038000
*/*            A REQUEST IS MARKED VIO IF THE UNIT CODED IS VIO      */ 01039000
*/*            (VAM) ELIGIBLE, DISP=NEW, NON-SPECIFIC (NO            */ 01040000
*/*            VOLUME SERIALS CODED), NON-ISAM AND HAS A SYSTEM      */ 01041000
*/*            GENERATED NAME (&DSN OR NO DSNAME).                   */ 01042000
*/*            A REQUEST MAY ALSO BE VIO IF IT HAS A GENERATED       */ 01043000
*/*            DSNAME AND UNIT=AFF TO A VIO REQUEST                  */ 01044000
*/*            OR                                                    */ 01045000
*/*            HAS A STATUS OF NEW AND VOL=REF TO A VIO REQUEST      */ 01046000
*/*            OR                                                    */ 01047000
*/*            HAS A STATUS OF OLD AND VOL=REF TO A VIO REQUEST WITH */ 01048000
*/*            THE SAME DATA SET NAME                                */ 01049000
*/*            OR                                                    */ 01050000
*/*            IS A RECEIVED VIO DATA SET.                           */ 01051000
*/*            IF THIS REQUEST IS NOT VIO ELIGIBLE           @ZA05349*/ 01052000
*/*            AND HAS VOL=REF TO A VIO ELIGIBLE DD,         @ZA05349*/ 01053000
*/*            VOL=REF IS IGNORED (SIOTREFN=0).              @ZA05349*/ 01054000
*/*            IF THIS REQUEST IS NOT VIO ELIGIBLE AND       @ZA05349*/ 01055000
*/*            HAS UNIT AFFINITY TO A VIO ELIGIBLE DD,       @ZA05349*/ 01056000
*/*            UNIT AFFINITY IS IGNORED (SCTUNAFF IS         @ZA05349*/ 01057000
*/*            SET OFF AND SIOTUNAF=0).                      @ZA05349*/ 01058000
*/*                                                                  */ 01059000
*/* ENTRY - INCLUDED SEGMENT.                                        */ 01060000
*/*   PURPOSE - SEE FUNCTION.                                        */ 01061000
*/*                                                                  */ 01062000
*/*   INPUT DATA -                                                   */ 01063000
*/*           REFERENCED SIOT INDICATOR.                             */ 01064000
*/*           VIO BIT IN REFERENCED SIOT.                            */ 01065000
*/*           CURRENT AND REFERENCED DATA SET NAMES.                 */ 01066000
*/*           DATA SET STATUS.                                       */ 01067000
*/*                                                                  */ 01068000
*/* EXIT -                                                           */ 01069000
*/*   CONDITION - ALL.                                               */ 01070000
*/*                                                                  */ 01071000
*/*   OUPUT DATA -                                                   */ 01072000
*/*              VIO BIT IN CURRENT SIOT.                            */ 01073000
*/*              VOLUME AFFINITY BIT AND NUMBER IN CURRENT SIOT.     */ 01074000
*/*                                                                  */ 01075000
*/*   RETURN CODE - NONE                                             */ 01076000
*/********************************************************************/ 01077000
*                                                               02S0319 01078000
*       IF SIOTGDSN=YES             /* SYSTEM GENERATED DSNAME,      */ 01079000
*           &SCTDUMMY=NO            /* NOT DD DUMMY AND,     @YM08288*/ 01080000
*           &JFCORGIS=NO THEN       /* NOT ISAM. INITIAL VIO         */ 01081000
         TM    SIOTGDSN(CSIOTP),B'00010000'                     02S0319 01082000
         BNO   @RF00319                                         02S0319 01083000
         TM    SCTDUMMY(CSIOTP),B'10000000'                     02S0319 01084000
         BNZ   @RF00319                                         02S0319 01085000
         TM    JFCORGIS(CJFCBP),B'10000000'                     02S0319 01086000
         BNZ   @RF00319                                         02S0319 01087000
*         DO;                       /* REQUIREMENTS MET.             */ 01088000
*           IF HWRESIOT=YES THEN    /* IF THERE IS A REF. SIOT       */ 01089000
         L     @10,@PC00001                                     02S0321 01090000
         L     @10,HWCNTRLP(,@10)                               02S0321 01091000
         TM    HWRESIOT(@10),B'00001000'                        02S0321 01092000
         BNO   @RF00321                                         02S0321 01093000
*             DO;                   /* AND THE REF. REQUEST IS VIO,  */ 01094000
*               IF RSIOTP->SIOVAMDS=YES THEN/* MAKE THIS A VIO DATA     01095000
*                                      SET IF                        */ 01096000
         TM    SIOVAMDS(RSIOTP),B'00100000'                     02S0323 01097000
         BNO   @RF00323                                         02S0323 01098000
*                 IF SCTSNEW=NO THEN/* IT IS OLD/MOD AND EITHER      */ 01099000
         TM    SCTSNEW(CSIOTP),B'00000100'                      02S0324 01100000
         BNZ   @RF00324                                         02S0324 01101000
*                   DO;             /* VOL=REF TO A DD WITH THE      */ 01102000
*                     IF JFCBDSNM=RJFCBP->JFCBDSNM THEN/* SAME DATA     01103000
*                                      SET NAME OR                   */ 01104000
         CLC   JFCBDSNM(44,CJFCBP),JFCBDSNM(RJFCBP)             02S0326 01105000
         BNE   @RF00326                                         02S0326 01106000
*                       SIOVAMDS=YES;/* A RECEIVED VIO DATA SET.     */ 01107000
         OI    SIOVAMDS(CSIOTP),B'00100000'                     02S0327 01108000
*                     ELSE          /* OLD DSN WITH VOL=REF TO DIFF. */ 01109000
*                       SIOTREFN=0; /* DATA SET, TURN OFF VOL-AFF    */ 01110000
         B     @RC00326                                         02S0328 01111000
@RF00326 SLR   @10,@10                                          02S0328 01112000
         STH   @10,SIOTREFN(,CSIOTP)                            02S0328 01113000
*                   END;                                        02S0329 01114000
*                 ELSE              /* ITS A NEW DATA SET WITH       */ 01115000
*                   DO;             /* VOL=REF TO VIO, MAKE THIS VIO */ 01116000
         B     @RC00324                                         02S0330 01117000
@RF00324 DS    0H                                               02S0331 01118000
*                     SIOVAMDS=YES; /* MARK REQUEST VIO.             */ 01119000
         OI    SIOVAMDS(CSIOTP),B'00100000'                     02S0331 01120000
*                     SIOTREFN=0;   /* DATA SETS ARE DIFF. SO VIO    */ 01121000
         SLR   @10,@10                                          02S0332 01122000
         STH   @10,SIOTREFN(,CSIOTP)                            02S0332 01123000
*                   END;            /* VOL-AFF NOT POSSIBLE.         */ 01124000
*             END;                                              02S0334 01125000
*           ELSE                    /* NO REFERENCED DD AND THE      */ 01126000
*             IF HWVAME=YES&        /* UNIT CONVERTED IS VIO    02S0335 01127000
*                                      ELIBIBLE,                     */ 01128000
*                 HWDSNCAT=NO       /* NO RETRIEVED SOURCE           */ 01129000
*                 &SCTVOLCT=0       /* NO VOLUMES SPECIFIED,         */ 01130000
*                 &SCTSNEW=YES THEN /* NEW DATA SET,                 */ 01131000
         B     @RC00321                                         02S0335 01132000
@RF00321 L     @10,@PC00001                                     02S0335 01133000
         L     @10,HWCNTRLP(,@10)                               02S0335 01134000
         TM    HWVAME(@10),B'01000000'                          02S0335 01135000
         BNO   @RF00335                                         02S0335 01136000
         TM    HWDSNCAT(@10),B'00000100'                        02S0335 01137000
         BNZ   @RF00335                                         02S0335 01138000
         CLI   SCTVOLCT(CSIOTP),0                               02S0335 01139000
         BNE   @RF00335                                         02S0335 01140000
         TM    SCTSNEW(CSIOTP),B'00000100'                      02S0335 01141000
         BNO   @RF00335                                         02S0335 01142000
*               SIOVAMDS=YES;       /* SO MARK REQUEST VIO.          */ 01143000
         OI    SIOVAMDS(CSIOTP),B'00100000'                     02S0336 01144000
*           IF SIOVAMDS=YES THEN    /* DATA SET IS VIO.              */ 01145000
@RF00335 DS    0H                                               02S0337 01146000
@RC00321 TM    SIOVAMDS(CSIOTP),B'00100000'                     02S0337 01147000
         BNO   @RF00337                                         02S0337 01148000
*             DO;                                               02S0338 01149000
*               JFCVRDS=YES;        /* TELL DATA MANAGEMENT ITS VIO. */ 01150000
         OI    JFCVRDS(CJFCBP),B'00000100'                      02S0339 01151000
*               SCTVOLCT=1;         /* UNALLOCATION REQUIRES 1 VOLUME*/ 01152000
         MVI   SCTVOLCT(CSIOTP),X'01'                           02S0340 01153000
*               JFCBNVOL=1;         /* FOR SCRATCH AND MESSAGES.     */ 01154000
         MVI   JFCBNVOL(CJFCBP),X'01'                           02S0341 01155000
*             END;                                              02S0342 01156000
*         END;                                                  02S0343 01157000
@RF00337 DS    0H                                               02S0344 01158000
*       IF(SIOTGDSN=NO              /* NOT GEN'D DSN OR      @ZA05349*/ 01159000
*           |JFCORGIS=YES)          /* ISAM AND              @ZA05349*/ 01160000
*           &HWRESIOT=YES           /* THERE IS REF. SIOT    @ZA05349*/ 01161000
*           &RSIOTP->SIOVAMDS=YES THEN/* AND IT IS VIO, THEN @ZA05349*/ 01162000
@RF00319 TM    SIOTGDSN(CSIOTP),B'00010000'                     02S0344 01163000
         BZ    @GL00033                                         02S0344 01164000
         TM    JFCORGIS(CJFCBP),B'10000000'                     02S0344 01165000
         BNO   @RF00344                                         02S0344 01166000
@GL00033 L     @10,@PC00001                                     02S0344 01167000
         L     @10,HWCNTRLP(,@10)                               02S0344 01168000
         TM    HWRESIOT(@10),B'00001000'                        02S0344 01169000
         BNO   @RF00344                                         02S0344 01170000
         TM    SIOVAMDS(RSIOTP),B'00100000'                     02S0344 01171000
         BNO   @RF00344                                         02S0344 01172000
*         SIOTREFN=0;               /* IGNORE VOL REF        @ZA05349*/ 01173000
         SLR   @10,@10                                          02S0345 01174000
         STH   @10,SIOTREFN(,CSIOTP)                            02S0345 01175000
*       IF SCTUNAFF=YES&HWVAME=YES  /* THIS IS UNIT=AFF TO A VIO        01176000
*                                      REQUEST                       */ 01177000
*           &SIOVAMDS=NO THEN       /* BUT THIS IS NOT A VIO DATASET */ 01178000
@RF00344 TM    SCTUNAFF(CSIOTP),B'00000010'                     02S0346 01179000
         BNO   @RF00346                                         02S0346 01180000
         L     @10,@PC00001                                     02S0346 01181000
         L     @10,HWCNTRLP(,@10)                               02S0346 01182000
         TM    HWVAME(@10),B'01000000'                          02S0346 01183000
         BNO   @RF00346                                         02S0346 01184000
         TM    SIOVAMDS(CSIOTP),B'00100000'                     02S0346 01185000
         BNZ   @RF00346                                         02S0346 01186000
*         DO;                       /* SO TURN OFF UNIT=AFF.         */ 01187000
*           SCTUNAFF=NO;            /* TURN OFF AFF INDICATOR.       */ 01188000
         NI    SCTUNAFF(CSIOTP),B'11111101'                     02S0348 01189000
*           SIOTUNAF=0;             /* ZERO DD NUMBER THAT THIS DD      01190000
*                                      HAD                           */ 01191000
         SLR   @10,@10                                          02S0349 01192000
         STH   @10,SIOTUNAF(,CSIOTP)                            02S0349 01193000
*         END;                      /* AFFINITY TO.                  */ 01194000
*       HWVAME=NO;                  /* NEXT DD DOESN'T LOOK VIO 02S0351 01195000
*                                      ELIGIBLE.                     */ 01196000
@RF00346 L     @10,@PC00001                                     02S0351 01197000
         L     @10,HWCNTRLP(,@10)                               02S0351 01198000
         NI    HWVAME(@10),B'10111111'                          02S0351 01199000
*                                                               02S0352 01200000
*/********************************************************************/ 01201000
*/*                                                                  */ 01202000
*/* SEGMENT NAME - UNOVERID                                          */ 01203000
*/*                                                                  */ 01204000
*/* DESCRIPTIVE NAME - UNIT OVERRIDE DETERMINATION.                  */ 01205000
*/*                                                                  */ 01206000
*/*            UPDATE HSKPWA CONTROL INDICATOR IF UNIT IS OVERRIDDEN.*/ 01207000
*/*              UNIT OVERRIDE IS THAT SITUATION WHERE NO EXPLICIT   */ 01208000
*/*              VOLUME INFORMATION IS CODED AND THE UNIT CODED IS A */ 01209000
*/*              SUBSET OF THE UNIT INFORMATION RETRIEVED FROM THE   */ 01210000
*/*              PDI,INTER-STEP VOL=REF OR CATALOG.                  */ 01211000
*/*                                                                  */ 01212000
*/* ENTRY - UNOVERID                                                 */ 01213000
*/*   PURPOSE - SEE FUNCTION.                                        */ 01214000
*/*                                                                  */ 01215000
*/*   INPUT DATA - POINTERS TO THE FOLLOWING                         */ 01216000
*/*                  HSKPWA CONTROLS                                 */ 01217000
*/*                  CRI                                             */ 01218000
*/*                  REFERENCED SIOT                                 */ 01219000
*/*                                                                  */ 01220000
*/* EXITS -  TO CALLER                                               */ 01221000
*/*   CONDITIONS - UNDER ALL CONDITIONS                              */ 01222000
*/*                                                                  */ 01223000
*/*   OUTPUT DATA - HSKPWA CONTROLS UPDATED                          */ 01224000
*/*                                                                  */ 01225000
*/*   RETURN CODES - NONE                                            */ 01226000
*/*                                                                  */ 01227000
*/********************************************************************/ 01228000
*                                                               02S0352 01229000
*       IF HWOVCAND=YES&HWRTCD=0 THEN/* UNIT CODED IS OVERRIDE SEE   */ 01230000
         TM    HWOVCAND(@10),B'00000010'                        02S0352 01231000
         BNO   @RF00352                                         02S0352 01232000
         L     @09,@PC00001+8                                   02S0352 01233000
         L     @09,HWRTNP(,@09)                                 02S0352 01234000
         LH    @09,HWRTCD(,@09)                                 02S0352 01235000
         LTR   @09,@09                                          02S0352 01236000
         BNZ   @RF00352                                         02S0352 01237000
*         DO;                       /* IF ANYTHING TO OVERRIDE.      */ 01238000
*           HWOVCAND=NO;            /* TURN OFF OVERRIDE INDICATOR   */ 01239000
         NI    HWOVCAND(@10),B'11111101'                        02S0354 01240000
*           IF SIOTVAFF=NO          /* CAN'T BE INTRA-STEP VOLREF    */ 01241000
*               &(HWDSNCAT=YES|HWRESIOT=YES|HWVUREC=YES) THEN/* BUT     01242000
*                                      NEED A RETRIEVED              */ 01243000
         TM    SIOTVAFF(CSIOTP),B'00000100'                     02S0355 01244000
         BNZ   @RF00355                                         02S0355 01245000
         TM    HWDSNCAT(@10),B'01001100'                        02S0355 01246000
         BZ    @RF00355                                         02S0355 01247000
*             DO;                   /* SOURCE FOR UNIT OVERRIDE.     */ 01248000
*               RFY                                             02S0357 01249000
*                 INDMSIOT BASED(RSIOTP);/* BASE REFERENCED SIOT.    */ 01250000
*               DEVPTR=ADDR(HWDEVTYP);/* POINTER TO CODED DEVICE        01251000
*                                      TYPE.                         */ 01252000
         L     @09,@PC00001+4                                   02S0358 01253000
         L     @09,HWDATAP(,@09)                                02S0358 01254000
         L     DEVPTR,HWUCLPTR(,@09)                            02S0358 01255000
         LA    DEVPTR,HWDEVTYP(,DEVPTR)                         02S0358 01256000
*               IF HWRESIOT=YES     /* IF SOURCE IS REF. SIOT,IT     */ 01257000
*                   &SIOVAMDS=NO&SCTDUMMY=NO/* CAN'T BE A VIO,DUMMY     01258000
*                                      OR                            */ 01259000
*                   &SIOTSSDS=NO    /* SUBSYSTEM DATA SET-OR-        */ 01260000
*                   |(HWDSNCAT=YES|HWVUREC=YES) THEN/* SOURCE CAN BE    01261000
*                                      CRI,                          */ 01262000
         TM    HWRESIOT(@10),B'00001000'                        02S0359 01263000
         BNO   @GL00039                                         02S0359 01264000
         TM    SIOVAMDS(RSIOTP),B'00100000'                     02S0359 01265000
         BNZ   @GL00039                                         02S0359 01266000
         TM    SCTDUMMY(RSIOTP),B'10000000'                     02S0359 01267000
         BNZ   @GL00039                                         02S0359 01268000
         TM    SIOTSSDS(RSIOTP),B'10000000'                     02S0359 01269000
         BZ    @RT00359                                         02S0359 01270000
@GL00039 L     @10,@PC00001                                     02S0359 01271000
         L     @10,HWCNTRLP(,@10)                               02S0359 01272000
         TM    HWDSNCAT(@10),B'01000100'                        02S0359 01273000
         BZ    @RF00359                                         02S0359 01274000
@RT00359 DS    0H                                               02S0360 01275000
*                 IF HWTAPE=YES THEN/* FOR OVERRIDE REQUIREMENTS.    */ 01276000
         LA    @10,DEVTYPE                                      02S0360 01277000
         TM    HWTAPE(@10),B'10000000'                          02S0360 01278000
         BNO   @RF00360                                         02S0360 01279000
*                   DO;             /* IF TAPE CHECK ENTIRE DEVTYPE. */ 01280000
*                     IF HWDEVTYP=DEVTYPE THEN/* DEVICE TYPES ARE    */ 01281000
         L     @10,@PC00001+4                                   02S0362 01282000
         L     @10,HWDATAP(,@10)                                02S0362 01283000
         L     @10,HWUCLPTR(,@10)                               02S0362 01284000
         CLC   HWDEVTYP(4,@10),DEVTYPE                          02S0362 01285000
         BNE   @RF00362                                         02S0362 01286000
*                       HWOVRDN=YES;/* THE SAME SO OVERRIDE.         */ 01287000
         L     @10,@PC00001                                     02S0363 01288000
         L     @10,HWCNTRLP(,@10)                               02S0363 01289000
         OI    HWOVRDN(@10),B'00100000'                         02S0363 01290000
*                     ELSE          /* NOT THE SAME,IS THE DEVICE    */ 01291000
*                       DO;         /* A GENERIC SUBSET OF RETRIEVED.*/ 01292000
         B     @RC00362                                         02S0364 01293000
@RF00362 DS    0H                                               02S0365 01294000
*                         EDTPTR=ADDR(EDTTAB);/* GET EDT POINTER.    */ 01295000
         L     EDTPTR,@CA00157                                  02S0365 01296000
*                         SCANEND=NO;/* SCAN EDT FOR RETRIEVED  02S0366 01297000
*                                      LUVALUE                       */ 01298000
         NI    SCANEND,B'01111111'                              02S0366 01299000
*                         LUVPTR=EDTLUVSP+LENGTH(LUVHDR);/* BEGINNING   01300000
*                                      OF LOOK-UP-ENTRIES.           */ 01301000
         LA    LUVPTR,8                                         02S0367 01302000
         AL    LUVPTR,EDTLUVSP(,EDTPTR)                         02S0367 01303000
*                         DO LUVCTR=1 TO LUVENTNO WHILE(SCANEND=NO);    01304000
         LA    LUVCTR,1                                         02S0368 01305000
         B     @DE00368                                         02S0368 01306000
@DL00368 TM    SCANEND,B'10000000'                              02S0368 01307000
         BNZ   @DC00368                                         02S0368 01308000
*                                   /* SCAN EDT FOR RETRIEVED        */ 01309000
*                           IF DEVTYPE=LUVALUE THEN/* LOOK-UP-VALUE.    01310000
*                                      FOUND,SEARCH                  */ 01311000
         CLC   DEVTYPE(4),LUVALUE(LUVPTR)                       02S0369 01312000
         BNE   @RF00369                                         02S0369 01313000
*                             DO;   /* LUV'S GENERIC'S FOR ONE THAT     01314000
*                                      MATCHES DEVTYPE CODED.        */ 01315000
*                               SCANEND=YES;/* LUV FOUND, EDT SCAN      01316000
*                                      ENDED.                        */ 01317000
         OI    SCANEND,B'10000000'                              02S0371 01318000
*                               GENPTR=LUVGENP;/* PTR TO 1ST GENERIC.*/ 01319000
         L     GENPTR,LUVGENP(,LUVPTR)                          02S0372 01320000
*                               DO GENCTR=1 TO LUVGENNO WHILE(HWOVRDN=  01321000
*                                     NO);                      02S0373 01322000
         LA    GENCTR,1                                         02S0373 01323000
         B     @DE00373                                         02S0373 01324000
@DL00373 L     @10,@PC00001                                     02S0373 01325000
         L     @10,HWCNTRLP(,@10)                               02S0373 01326000
         TM    HWOVRDN(@10),B'00100000'                         02S0373 01327000
         BNZ   @DC00373                                         02S0373 01328000
*                                 IF GENDEVT=HWDEVTYP THEN/* IF THE     01329000
*                                      GENERIC IS THE SAME AS        */ 01330000
         L     @15,@PC00001+4                                   02S0374 01331000
         L     @01,HWDATAP(,@15)                                02S0374 01332000
         L     @01,HWUCLPTR(,@01)                               02S0374 01333000
         CLC   GENDEVT(4,GENPTR),HWDEVTYP(@01)                  02S0374 01334000
         BNE   @RF00374                                         02S0374 01335000
*                                   HWOVRDN=YES;/* THE ONE CODED THEN   01336000
*                                      OVERRIDE.                     */ 01337000
         OI    HWOVRDN(@10),B'00100000'                         02S0375 01338000
*                                 ELSE/* GENERICS DON'T MATCH.       */ 01339000
*                                   GENPTR=GENPTR+GENENTLN;/* GET       01340000
*                                      PTR. TO NEXT GENERIC ENTRY    */ 01341000
         B     @RC00374                                         02S0376 01342000
@RF00374 L     @10,EDTGENSP(,EDTPTR)                            02S0376 01343000
         AL    GENPTR,GENENTLN(,@10)                            02S0376 01344000
*                               END;                            02S0377 01345000
@RC00374 AL    GENCTR,@CF00070                                  02S0377 01346000
@DE00373 C     GENCTR,LUVGENNO(,LUVPTR)                         02S0377 01347000
         BNH   @DL00373                                         02S0377 01348000
@DC00373 DS    0H                                               02S0378 01349000
*                             END;                              02S0378 01350000
*                           LUVPTR=LUVPTR+LUVENTLN;/* GET NEXT  02S0379 01351000
*                                      LOOK-UP-SECTION.              */ 01352000
@RF00369 L     @10,EDTLUVSP(,EDTPTR)                            02S0379 01353000
         AL    LUVPTR,LUVENTLN(,@10)                            02S0379 01354000
*                         END;                                  02S0380 01355000
         AL    LUVCTR,@CF00070                                  02S0380 01356000
@DE00368 L     @10,EDTLUVSP(,EDTPTR)                            02S0380 01357000
         C     LUVCTR,LUVENTNO(,@10)                            02S0380 01358000
         BNH   @DL00368                                         02S0380 01359000
@DC00368 DS    0H                                               02S0381 01360000
*                       END;                                    02S0381 01361000
*                   END;                                        02S0382 01362000
*                 ELSE              /* NON TAPE.                     */ 01363000
*                   IF HWCTBYT=DEVPTR->HWCTBYT THEN/* NON-TAPE,CLASS */ 01364000
         B     @RC00360                                         02S0383 01365000
@RF00360 LA    @10,DEVTYPE                                      02S0383 01366000
         CLC   HWCTBYT(2,@10),HWCTBYT(DEVPTR)                   02S0383 01367000
         BNE   @RF00383                                         02S0383 01368000
*                     HWOVRDN=YES;  /* AND TYPE DETERMINE OVERRIDE.  */ 01369000
         L     @10,@PC00001                                     02S0384 01370000
         L     @10,HWCNTRLP(,@10)                               02S0384 01371000
         OI    HWOVRDN(@10),B'00100000'                         02S0384 01372000
*             END;                                              02S0385 01373000
@RF00383 DS    0H                                               02S0385 01374000
@RC00360 DS    0H                                               02S0385 01375000
@RF00359 DS    0H                                               02S0386 01376000
*         END;                                                  02S0386 01377000
@RF00355 DS    0H                                               02S0387 01378000
*       RFY                                                     02S0387 01379000
*         INDMSIOT BASED(CSIOTP);   /* BASE CURRENT SIOT.            */ 01380000
@RF00352 DS    0H                                               02S0388 01381000
*                                                               02S0388 01382000
*/********************************************************************/ 01383000
*/*                                                                  */ 01384000
*/* SEGMENT NAME - NOREFCMP                                          */ 01385000
*/*                                                                  */ 01386000
*/* DESCRIPTIVE NAME - NON-REFERENCE VOLUME/UNIT  COMPLETION         */ 01387000
*/*                                                                  */ 01388000
*/* FUNCTION - COMPLETE THE DD'S UNIT PARAMETER BY COPYING THE       */ 01389000
*/*            DEVICE TYPE INTO THE CURRENT SIOT USING EITHER THE    */ 01390000
*/*            DEVICE TYPE RETRIEVED FROM THE CRI OR REFERENCED DD   */ 01391000
*/*            OR                                                    */ 01392000
*/*            THE UNIT CONVERSION LIST IF THERE IS NO               */ 01393000
*/*            REFERENCED SOURCE OR THE REFERENCED SOURCE HAS        */ 01394000
*/*            BEEN OVERRIDDEN.                                      */ 01395000
*/*                                                                  */ 01396000
*/*            IF MSS SELECTED VOLUME SERIALS FOR THIS       @G24LPSJ*/ 01397000
*/*            REQUEST, THEY ARE INSERTED IN THE JFCB        @G24LPSJ*/ 01398000
*/*            AND/OR JFCBX.                                 @G24LPSJ*/ 01399000
*/*                                                                  */ 01400000
*/* ENTRY -                                                          */ 01401000
*/*   PURPOSE - MOVE UNIT INFO TO DD LIST,                           */ 01402000
*/*             COPY MSS VOLUME SERIALS IF SPECIFIED AND     @G24LPSJ*/ 01403000
*/*             INSURE UNIT HAS BEEN PROPERLY INITIALIZED.           */ 01404000
*/*                                                                  */ 01405000
*/*   INPUT DATA - CURRENT SIOT,RETRIEVED DEVICE TYPE AND UNIT       */ 01406000
*/*                CONVERSION LIST.                                  */ 01407000
*/*                                                                  */ 01408000
*/* EXITS -                                                          */ 01409000
*/*   CONDITION-AFTER COPYING UNIT INFO                              */ 01410000
*/*                                                                  */ 01411000
*/*   OUTPUT DATA- UPDATED SIOT                                      */ 01412000
*/*                                                                  */ 01413000
*/*   RETURN CODE -0-NORMAL, 4-UNIT INCORRECTLY SPECIFIED.           */ 01414000
*/*                8-REASON CODE FOR INVALID UNIT SPECIFACATION.     */ 01415000
*/*                                                                  */ 01416000
*/********************************************************************/ 01417000
*                                                               02S0388 01418000
*       IF(HWRESIOT=YES|HWDSNCAT=YES/* IF VOLUME SERIALS WERE        */ 01419000
*           |HWVUREC=YES)           /* OBTAINED FROM CATALOG OR 02S0388 01420000
*                                      PREVIOUS                      */ 01421000
*           &HWOVRDN=NO THEN        /* SIOT THEN GET DEVTYPE FROM       01422000
*                                      SAME.                         */ 01423000
         L     @10,@PC00001                                     02S0388 01424000
         L     @10,HWCNTRLP(,@10)                               02S0388 01425000
         TM    HWRESIOT(@10),B'01001100'                        02S0388 01426000
         BZ    @RF00388                                         02S0388 01427000
         TM    HWOVRDN(@10),B'00100000'                         02S0388 01428000
         BNZ   @RF00388                                         02S0388 01429000
*         DO;                                                   02S0389 01430000
*           IF HWRESIOT=YES&SIOTVAFF=NO/* REFERENCED SIOT FROM       */ 01431000
*               &SIOVAMDS=NO THEN   /* PREVIOUS STEP AND NOT VIO,    */ 01432000
         TM    HWRESIOT(@10),B'00001000'                        02S0390 01433000
         BNO   @RF00390                                         02S0390 01434000
         TM    SIOTVAFF(CSIOTP),B'00000100'                     02S0390 01435000
         BNZ   @RF00390                                         02S0390 01436000
         TM    SIOVAMDS(CSIOTP),B'00100000'                     02S0390 01437000
         BNZ   @RF00390                                         02S0390 01438000
*             ZEROUCB=0;            /* RESET THE UCB PTR (RTVDUNIT)  */ 01439000
         SLR   @10,@10                                          02S0391 01440000
         ST    @10,ZEROUCB                                      02S0391 01441000
*           SCTUTYPE=RTVDUNIT;      /* DEVTYP FROM CRI OR RETRIEVED     01442000
*                                      DD.                           */ 01443000
@RF00390 MVC   SCTUTYPE(8,CSIOTP),RTVDUNIT                      02S0392 01444000
*           HWAVSRCH=NO;            /* TURN OFF SEARCH DONE  @G24LPSJ*/ 01445000
         L     @10,@PC00001                                     02S0393 01446000
         L     @10,HWCNTRLP(,@10)                               02S0393 01447000
         NI    HWAVSRCH(@10),B'10111111'                        02S0393 01448000
*           HWAVUNIT=NO;            /* INDICATE NO VIRT UNIT @G24LPSJ*/ 01449000
         NI    HWAVUNIT(@10),B'11111110'                        02S0394 01450000
*         END;                                                  02S0395 01451000
*       ELSE                        /* UNIT NOT COMPLETED VIA   02S0396 01452000
*                                      REFERENCE                     */ 01453000
*         IF HWOVRDN=YES|           /* IF DEVTYPE WAS OVERRIDDEN OR     01454000
*                                      NO                            */ 01455000
*             (HWDSNCAT=NO&HWRESIOT=NO&HWVUREC=NO)/* REFERENCE SOURCE*/ 01456000
*             &(HWEDT=YES|HWUCB=YES) THEN/* AND UNIT PARM. CONVERTED */ 01457000
         B     @RC00388                                         02S0396 01458000
@RF00388 L     @10,@PC00001                                     02S0396 01459000
         L     @10,HWCNTRLP(,@10)                               02S0396 01460000
         TM    HWOVRDN(@10),B'00100000'                         02S0396 01461000
         BO    @RT00396                                         02S0396 01462000
         TM    HWDSNCAT(@10),B'01001100'                        02S0396 01463000
         BNZ   @RF00396                                         02S0396 01464000
         TM    HWEDT(@10),B'10000000'                           02S0396 01465000
         BO    @RT00396                                         02S0396 01466000
         TM    HWUCB(@10),B'00000001'                           02S0396 01467000
         BNO   @RF00396                                         02S0396 01468000
@RT00396 DS    0H                                               02S0397 01469000
*           DO;                     /* THEN USE EDT OR UCB DEVTYPE.  */ 01470000
*             SCTUTYPE=SCTUTYPE&&SCTUTYPE;/* 0 PARTS NOT FILLED IN.  */ 01471000
         XC    SCTUTYPE(8,CSIOTP),SCTUTYPE(CSIOTP)              02S0398 01472000
*             IF HWEDT=YES THEN     /* USE THE LOOK-UP-VALUE FOR        01473000
*                                      UNITS                         */ 01474000
         L     @10,@PC00001                                     02S0399 01475000
         L     @10,HWCNTRLP(,@10)                               02S0399 01476000
         TM    HWEDT(@10),B'10000000'                           02S0399 01477000
         BNO   @RF00399                                         02S0399 01478000
*               SIOTDEVT=HWEDTLUV;  /* CONVERTED FROM THE EDT.       */ 01479000
         L     @10,@PC00001+4                                   02S0400 01480000
         L     @10,HWDATAP(,@10)                                02S0400 01481000
         L     @10,HWUCLPTR(,@10)                               02S0400 01482000
         L     @10,HWEDTLUV(,@10)                               02S0400 01483000
         ST    @10,SIOTDEVT(,CSIOTP)                            02S0400 01484000
*             ELSE                  /* OTHERWISE USE THE DEVICE TYPE */ 01485000
*               DO;                 /* FROM A UCB AND PTR TO THAT       01486000
*                                      UCB.                          */ 01487000
         B     @RC00399                                         02S0401 01488000
@RF00399 DS    0H                                               02S0402 01489000
*                 SIOTDEVT=HWDEVTYP;/* DEVICE TYPE FROM UCB.         */ 01490000
         L     @10,@PC00001+4                                   02S0402 01491000
         L     @10,HWDATAP(,@10)                                02S0402 01492000
         L     @10,HWUCLPTR(,@10)                               02S0402 01493000
         MVC   SIOTDEVT(4,CSIOTP),HWDEVTYP(@10)                 02S0402 01494000
*                 SIOUCBAD=HWUCBP;  /* PTR TO UCB USED FOR CONVERSION*/ 01495000
         MVC   SIOUCBAD(3,CSIOTP),HWUCBP(@10)                   02S0403 01496000
*                 SIOTDMND=YES;     /* DEMAND REQUEST. UNIT=SPECIFIC    01497000
*                                      DEVICE ADDRESS OR UNIT=AFF TO    01498000
*                                      A DEMAND REQUEST.             */ 01499000
         OI    SIOTDMND(CSIOTP),B'10000000'                     02S0404 01500000
*               END;                                            02S0405 01501000
*             IF HWVLSELF=YES THEN  /* IF MSS SELECTED       @G24LPSJ*/ 01502000
@RC00399 L     @10,@PC00001                                     02S0406 01503000
         L     @10,HWCNTRLP(,@10)                               02S0406 01504000
         TM    HWVLSELF(@10),B'10000000'                        02S0406 01505000
         BNO   @RF00406                                         02S0406 01506000
*               DO;                 /* VOLUMES THEN DO       @G24LPSJ*/ 01507000
*                 JFCMSVGP=BLANKS;  /* CLEAR MSVG NAME FIELD @G24LPSJ*/ 01508000
         MVC   JFCMSVGP(8,CJFCBP),BLANKS                        02S0408 01509000
*                 JVOLPTR=ADDR(JFCBVOLS)-VOLSERLN;/* SET POINTER TO     01510000
*                                      VOL SER SLOT          @G24LPSJ*/ 01511000
         LA    JVOLPTR,JFCBVOLS(,CJFCBP)                        02S0409 01512000
         SL    JVOLPTR,@CF00105                                 02S0409 01513000
*                 JFCBNVOL=HWVLSLCT;/* INSERT VOL SER CNT    @G24LPSJ*/ 01514000
         L     @10,@PC00001+4                                   02S0410 01515000
         L     @10,HWDATAP(,@10)                                02S0410 01516000
         L     @10,HWVLSELP(,@10)                               02S0410 01517000
         LH    @10,HWVLSLCT(,@10)                               02S0410 01518000
         STC   @10,JFCBNVOL(,CJFCBP)                            02S0410 01519000
*                 DO VOLCOPY=1 TO HWVLSLCT;/* COPY VOLUMES SELECTED     01520000
*                                      BY MSS                @G24LPSJ*/ 01521000
         LA    VOLCOPY,1                                        02S0411 01522000
         B     @DE00411                                         02S0411 01523000
@DL00411 DS    0H                                               02S0412 01524000
*                   CALL JFCBXGEN;  /* GET NEXT VOL SER SLOT @G24LPSJ*/ 01525000
         BAL   @14,JFCBXGEN                                     02S0412 01526000
*                   SCTVOLCT=SCTVOLCT+1;/* INCREMENT COUNT   @G24LPSJ*/ 01527000
         LA    @10,1                                            02S0413 01528000
         SLR   @09,@09                                          02S0413 01529000
         IC    @09,SCTVOLCT(,CSIOTP)                            02S0413 01530000
         ALR   @10,@09                                          02S0413 01531000
         STC   @10,SCTVOLCT(,CSIOTP)                            02S0413 01532000
*                   VSER=HWVLSERS(VOLCOPY);/* COPY VOL SER   @G24LPSJ*/ 01533000
         LR    @10,VOLCOPY                                      02S0414 01534000
         MH    @10,@CH00105                                     02S0414 01535000
         L     @09,@PC00001+4                                   02S0414 01536000
         L     @09,HWDATAP(,@09)                                02S0414 01537000
         L     @09,HWVLSELP(,@09)                               02S0414 01538000
         ALR   @09,@10                                          02S0414 01539000
         BCTR  @09,0                                            02S0414 01540000
         BCTR  @09,0                                            02S0414 01541000
         MVC   VSER(6,JVOLPTR),HWVLSERS-4(@09)                  02S0414 01542000
*                 END;              /*                       @G24LPSJ*/ 01543000
         AL    VOLCOPY,@CF00070                                 02S0415 01544000
@DE00411 L     @10,@PC00001+4                                   02S0415 01545000
         L     @10,HWDATAP(,@10)                                02S0415 01546000
         L     @10,HWVLSELP(,@10)                               02S0415 01547000
         CH    VOLCOPY,HWVLSLCT(,@10)                           02S0415 01548000
         BNH   @DL00411                                         02S0415 01549000
*               END;                /*                       @G24LPSJ*/ 01550000
*           END;                                                02S0417 01551000
@RF00406 DS    0H                                               02S0418 01552000
*       IF SIOTDMND=YES THEN        /* IF UCB TYPE IN SIOT   @ZA12414*/ 01553000
@RF00396 DS    0H                                               02S0418 01554000
@RC00388 TM    SIOTDMND(CSIOTP),B'10000000'                     02S0418 01555000
         BNO   @RF00418                                         02S0418 01556000
*         DO;                       /* THEN                  @ZA12414*/ 01557000
*           DEVTPTR=ADDR(SIOTDEVT); /* SET PTR TO SIOT DEVTYPE  02S0420 01558000
*                                                            @ZA12414*/ 01559000
         LA    DEVTPTR,SIOTDEVT(,CSIOTP)                        02S0420 01560000
*           CALL DEVTPROC;          /* TURN OFF DEVTYPE BITS @ZA12414*/ 01561000
         BAL   @14,DEVTPROC                                     02S0421 01562000
*         END;                      /*                       @ZA12414*/ 01563000
*       IF HWRESIOT=YES&SIOTREFN=0 THEN/* INTRA-STEP VOL=REF TURNED     01564000
*                                      OFF,                          */ 01565000
@RF00418 L     @10,@PC00001                                     02S0423 01566000
         L     @10,HWCNTRLP(,@10)                               02S0423 01567000
         TM    HWRESIOT(@10),B'00001000'                        02S0423 01568000
         BNO   @RF00423                                         02S0423 01569000
         LH    @10,SIOTREFN(,CSIOTP)                            02S0423 01570000
         LTR   @10,@10                                          02S0423 01571000
         BNZ   @RF00423                                         02S0423 01572000
*         SIOTVAFF=NO;              /* SO TURN OFF VOL-AFF IND.      */ 01573000
         NI    SIOTVAFF(CSIOTP),B'11111011'                     02S0424 01574000
*                                                               03S0425 01575000
*/********************************************************************/ 01576000
*/*                                                                  */ 01577000
*/* SEGMENT NAME - CATDEVT                                           */ 01578000
*/*                                                                  */ 01579000
*/* DESCRIPTIVE NAME - CATALOG DEVICE TYPE FOR RE-CATALOG.           */ 01580000
*/*                                                                  */ 01581000
*/* FUNCTION - GENERATE/UPDATE THE JFCBX WITH THE DEVICE TYPE        */ 01582000
*/*            RETRIEVED FROM THE CATALOG. THIS WILL ENABLE          */ 01583000
*/*            RE-CATALOG (IN UNALLOCATION) WITH THE ORIGINAL DEVICE */ 01584000
*/*            TYPE, THEREFORE ALLOWING ESOTERICS TO REMAIN IN THE   */ 01585000
*/*            CATALOG.                                              */ 01586000
*/*   OPERATION- 1.CHECK DD TO SEE IF DEVICE TYPE IN SIOT IS FROM    */ 01587000
*/*                THE CATALOG.                                      */ 01588000
*/*                    NOTE:THE DEVICE TYPE MAY HAVE BEEN COPIED     */ 01589000
*/*                         FROM A DD THAT HAD A DISP OF PASS AND    */ 01590000
*/*                         ITSELF OBTAINED THE DEVICE TYPE FROM THE */ 01591000
*/*                         CATALOG. IN THIS CASE THE DEVICE TYPE    */ 01592000
*/*                         MUST BE OBTAINED FROM THE JFCB EXTENSION.*/ 01593000
*/*                    NOTE:IF JFCCAT IS ON BUT NEITHER      @ZA00897*/ 01594000
*/*                         HWRESIOT NOR HWDSNCAT NOR HWVUREC@ZA00897*/ 01595000
*/*                         IS ON, THE DATA SET WAS NOT FOUND@ZA00897*/ 01596000
*/*                         IN THE CATALOG BY HOUSEKEEPING,  @ZA00897*/ 01597000
*/*                         SO DOESN'T NEED A JFCBX.         @ZA00897*/ 01598000
*/*                                                                  */ 01599000
*/*              2.CREATE A JFCB EXTENSION IF NONE EXIST.            */ 01600000
*/*                                                                  */ 01601000
*/*              3.PUT DEVICE TYPE IN JFCBX IF THIS IS NOT A RESTART.*/ 01602000
*/*                    NOTE-IF NO HSKWA FUNCTION BITS ARE ON         */ 01603000
*/*                         INDICATING FOUND IN CATALOG, PDI OR      */ 01604000
*/*                         VOL/UNIT RECURSION THEN THIS IS A        */ 01605000
*/*                         RESTART AND THE JFCBX ALREADY CONTAINS   */ 01606000
*/*                         THE DEVICE TYPE.                         */ 01607000
*/*                                                                  */ 01608000
*/* ENTRY - FROM NON REFERNECE COMPETION.                            */ 01609000
*/*                                                                  */ 01610000
*/*   PURPOSE - PROVIDE DEVICE TYPE FOR RE-CATALOGING OF A DATA      */ 01611000
*/*             SET WITH THE ORIGINAL DEVICE TYPE RETRIEVED FROM     */ 01612000
*/*             THE CATALOG.                                         */ 01613000
*/*   INPUT DATA - CATALOGED DATA SET INDICATOR                      */ 01614000
*/*                JFCBX PTR IN SIOT                                 */ 01615000
*/*                DEVTYPE IN SIOT                                   */ 01616000
*/*                DEVTYPE IN REFERENCED JFCBX                       */ 01617000
*/*                                                                  */ 01618000
*/* EXIT -                                                           */ 01619000
*/*   OUTPUT DATA - JFCBX GENERATED/UPDATED WITH DEVICE TYPE FROM    */ 01620000
*/*                 CATALOG.                                         */ 01621000
*/*                 INDICATOR FOR PRESENTS OF THAT DEVICE TYPE.      */ 01622000
*/*                                                                  */ 01623000
*/********************************************************************/ 01624000
*                                                               03S0425 01625000
*       IF JFCCAT=YES&              /* DSN FOUND IN CATLG    @ZA00897*/ 01626000
*           (HWRESIOT=YES|          /* DATA SET RECEIVED - THIS STEP    01627000
*                                                            @ZA00897*/ 01628000
*           HWDSNCAT=YES|           /* FOUND IN CATLG THIS STEP 03S0425 01629000
*                                                            @ZA00897*/ 01630000
*           HWVUREC=YES) THEN       /* VOL/UNIT RECURSION    @ZA00897*/ 01631000
@RF00423 TM    JFCCAT(CJFCBP),B'10000000'                       03S0425 01632000
         BNO   @RF00425                                         03S0425 01633000
         L     @10,@PC00001                                     03S0425 01634000
         L     @10,HWCNTRLP(,@10)                               03S0425 01635000
         TM    HWRESIOT(@10),B'01001100'                        03S0425 01636000
         BZ    @RF00425                                         03S0425 01637000
*         DO;                       /* CREATE, FILL IN JFCBX         */ 01638000
*           IF SIOTJFX=0 THEN       /* CREATE A JFCB                 */ 01639000
         SLR   @10,@10                                          03S0427 01640000
         C     @10,SIOTJFX(,CSIOTP)                             03S0427 01641000
         BNE   @RF00427                                         03S0427 01642000
*             DO;                   /* EXTENSION IF NONE EXISTS.     */ 01643000
*               SWACTLS=0;          /* CLEAR SWA INTERFACE CONTROLS. */ 01644000
         STH   @10,SWACTLS                                      03S0429 01645000
*               SWNEW=YES;          /* NEW EPA.                      */ 01646000
         OI    SWNEW,B'00001000'                                03S0430 01647000
*               SWCHN=YES;          /* CHAIN EPA TO EPA IN EPAPTR.   */ 01648000
         OI    SWCHN,B'10000000'                                03S0431 01649000
*               SWASN=YES;          /* ASSIGN THIS NEW JFCBX         */ 01650000
         OI    SWASN,B'10000000'                                03S0432 01651000
*               BLKID=JFXID;        /* SAY JFCBX FOR LATER WRITE.    */ 01652000
         MVI   BLKID,X'1D'                                      03S0433 01653000
*               CALL IEFAB4F7(SWACTLS,0,EPAPTR,ADDR(SVAPRM),/* ASSIGN   01654000
*                                      THE                           */ 01655000
*                   ADDR(SIOTJFX),JFXLEN,1);/* JFCB EXTENSION.       */ 01656000
         LA    @10,SWACTLS                                      03S0434 01657000
         ST    @10,@AL00001                                     03S0434 01658000
         LA    @10,@CF00638                                     03S0434 01659000
         ST    @10,@AL00001+4                                   03S0434 01660000
         LA    @10,EPAPTR                                       03S0434 01661000
         ST    @10,@AL00001+8                                   03S0434 01662000
         LA    @10,SVAPRM                                       03S0434 01663000
         ST    @10,@TF00001                                     03S0434 01664000
         LA    @10,@TF00001                                     03S0434 01665000
         ST    @10,@AL00001+12                                  03S0434 01666000
         LA    @10,SIOTJFX(,CSIOTP)                             03S0434 01667000
         ST    @10,@TF00002                                     03S0434 01668000
         LA    @10,@TF00002                                     03S0434 01669000
         ST    @10,@AL00001+16                                  03S0434 01670000
         LA    @10,@CF00145                                     03S0434 01671000
         ST    @10,@AL00001+20                                  03S0434 01672000
         LA    @10,@CF00070                                     03S0434 01673000
         ST    @10,@AL00001+24                                  03S0434 01674000
         L     @15,@CV00161                                     03S0434 01675000
         LA    @01,@AL00001                                     03S0434 01676000
         BALR  @14,@15                                          03S0434 01677000
*               JFCBEXAD=SVA;       /* GET SVA FROM SVAPRM.          */ 01678000
         MVC   JFCBEXAD(3,CJFCBP),SVA                           03S0435 01679000
*               JFCBXPTR=SIOTJFX;   /* GET PTR TO JFCBX GEN'D.       */ 01680000
         L     @10,SIOTJFX(,CSIOTP)                             03S0436 01681000
         ST    @10,JFCBXPTR                                     03S0436 01682000
*               NEWSERS=BLANKOUT;   /* MAKE VOLSERS BLANK IN JFCBX.  */ 01683000
         MVC   NEWSERS(90,@10),BLANKOUT                         03S0437 01684000
*             END;                  /* END JFCBX ASSIGN.             */ 01685000
*           IF HWRESIOT=YES THEN    /* RECEIVED DATA SET FOUND IN    */ 01686000
@RF00427 L     @10,@PC00001                                     03S0439 01687000
         L     @10,HWCNTRLP(,@10)                               03S0439 01688000
         TM    HWRESIOT(@10),B'00001000'                        03S0439 01689000
         BNO   @RF00439                                         03S0439 01690000
*             SIOTJFX->JFCBXDEV     /* CATALOG ORIGINALY. GET DEVICE */ 01691000
*                 =HWRSIOTP->SIOTJFX->JFCBXDEV;/* TYPE FROM PASSING     01692000
*                                      DD.                           */ 01693000
         L     @10,SIOTJFX(,CSIOTP)                             03S0440 01694000
         L     @09,@PC00001+4                                   03S0440 01695000
         L     @09,HWDATAP(,@09)                                03S0440 01696000
         L     @09,HWRSIOTP(,@09)                               03S0440 01697000
         L     @09,SIOTJFX(,@09)                                03S0440 01698000
         MVC   JFCBXDEV(4,@10),JFCBXDEV(@09)                    03S0440 01699000
*           ELSE                    /* NOT RECEIVED AND NOT A RESTART*/ 01700000
*             IF HWDSNCAT=YES|HWVUREC=YES THEN/* SO GET DEVICE TYPE     01701000
*                                      AS FOUND                      */ 01702000
         B     @RC00439                                         03S0441 01703000
@RF00439 L     @10,@PC00001                                     03S0441 01704000
         L     @10,HWCNTRLP(,@10)                               03S0441 01705000
         TM    HWDSNCAT(@10),B'01000100'                        03S0441 01706000
         BZ    @RF00441                                         03S0441 01707000
*               SIOTJFX->JFCBXDEV=DEVTYPE;/* IN THE CATALOG. @YM08304*/ 01708000
         L     @10,SIOTJFX(,CSIOTP)                             03S0442 01709000
         MVC   JFCBXDEV(4,@10),DEVTYPE                          03S0442 01710000
*           SIOCDEVT=YES;           /* INDICATE CATALOG DEVTYPE      */ 01711000
@RF00441 DS    0H                                               03S0443 01712000
@RC00439 OI    SIOCDEVT(CSIOTP),B'01000000'                     03S0443 01713000
*         END;                      /* END DEVTYPE FOR RE-CATALOG.   */ 01714000
*       HWDSNCAT=NO;                /* CLEAN UP HSKPWA CONTROLS FOR     01715000
*                                      THE                           */ 01716000
@RF00425 DS    0H                                               02S0446 01717000
*       HWRESIOT=NO;                /* PROCESSING OF THE NEXT DD BY  */ 01718000
         L     @10,@PC00001                                     02S0446 01719000
         L     @10,HWCNTRLP(,@10)                               02S0446 01720000
         NI    HWDSNCAT(@10),B'11110011'                        02S0446 01721000
*       HWOVRDN=NO;                 /* HOUSEKEEPING.                 */ 01722000
         NI    HWOVRDN(@10),B'11011111'                         02S0447 01723000
*       IF HWVUREC=YES&HWDDCTR=HWDDSTEP+1 THEN/* IF LAST DD WAS      */ 01724000
         TM    HWVUREC(@10),B'01000000'                         02S0448 01725000
         BNO   @RF00448                                         02S0448 01726000
         LH    @09,HWDDCTR(,@10)                                02S0448 01727000
         LA    @15,1                                            02S0448 01728000
         AH    @15,HWDDSTEP(,@10)                               02S0448 01729000
         CR    @09,@15                                          02S0448 01730000
         BNE   @RF00448                                         02S0448 01731000
*         IF HWDDCTR=HWDDSTEP+1 THEN/* IF LAST DD WAS                */ 01732000
         CR    @09,@15                                          02S0449 01733000
         BNE   @RF00449                                         02S0449 01734000
*           DO;                     /* PROCESSED FOR VOL/UNIT   02S0450 01735000
*                                      RECURSION                     */ 01736000
*             HWVUREC=NO;           /* TURN OFF VOL/UNIT RECURSION      01737000
*                                      FLAG                          */ 01738000
         NI    HWVUREC(@10),B'10111111'                         02S0451 01739000
*             HWDDCTR=0;            /* CLEAR DD COUNTER.             */ 01740000
         SLR   @09,@09                                          02S0452 01741000
         STH   @09,HWDDCTR(,@10)                                02S0452 01742000
*             HWDDSTEP=0;           /* RESET NO. OF DDS GENERATED.   */ 01743000
         STH   @09,HWDDSTEP(,@10)                               02S0453 01744000
*           END;                                                02S0454 01745000
*       IF SIOVAMDS=NO&SCTDUMMY=NO  /* IF ITS NOT A VIO,DUMMY OR     */ 01746000
*           &SIOTSSDS=NO THEN       /* SUBSYSTEM DATA SET AND THE    */ 01747000
@RF00449 DS    0H                                               02S0455 01748000
@RF00448 TM    SIOVAMDS(CSIOTP),B'00100000'                     02S0455 01749000
         BNZ   @RF00455                                         02S0455 01750000
         TM    SCTDUMMY(CSIOTP),B'10000000'                     02S0455 01751000
         BNZ   @RF00455                                         02S0455 01752000
         TM    SIOTSSDS(CSIOTP),B'10000000'                     02S0455 01753000
         BNZ   @RF00455                                         02S0455 01754000
*         IF SIOUCNVT^=0 THEN       /* UNIT WAS NOT PROPERLY    02S0456 01755000
*                                      CONVERTED.                    */ 01756000
         CLI   SIOUCNVT(CSIOTP),0                               02S0456 01757000
         BE    @RF00456                                         02S0456 01758000
*           DO;                     /* PROCESSING                    */ 01759000
*             HWRSNCD=UNITBAD;      /* CAN'T CONTINUE. FAIL THE JOB  */ 01760000
         L     @10,@PC00001+8                                   02S0458 01761000
         L     @10,HWRTNP(,@10)                                 02S0458 01762000
         MVC   HWRSNCD(2,@10),@CH00060                          02S0458 01763000
*             HWRTCD=DDERROR;       /* DUE TO INVALID UNIT PARAMETER.*/ 01764000
         MVC   HWRTCD(2,@10),@CH00062                           02S0459 01765000
*           END;                                                02S0460 01766000
*     END;                                                      01S0461 01767000
@RF00456 DS    0H                                               01S0461 01768000
@RF00455 DS    0H                                               01S0462 01769000
*   IF HWGEPACP=0 THEN              /* REPLACE THE OLD               */ 01770000
@RF00317 L     @10,@PC00001+4                                   01S0462 01771000
         L     @10,HWDATAP(,@10)                                01S0462 01772000
         L     @09,HWGEPACP(,@10)                               01S0462 01773000
         LTR   @09,@09                                          01S0462 01774000
         BNZ   @RF00462                                         01S0462 01775000
*     HWLEPAP=EPAPTR;               /* LAST EPA POINTER              */ 01776000
         L     @09,EPAPTR                                       01S0463 01777000
         ST    @09,HWLEPAP(,@10)                                01S0463 01778000
*   ELSE                            /* BY THE EPA POINTER            */ 01779000
*     HWGEPACP=EPAPTR;              /* UPDATED BY ASSIGN.            */ 01780000
         B     @RC00462                                         01S0464 01781000
@RF00462 L     @10,@PC00001+4                                   01S0464 01782000
         L     @10,HWDATAP(,@10)                                01S0464 01783000
         L     @09,EPAPTR                                       01S0464 01784000
         ST    @09,HWGEPACP(,@10)                               01S0464 01785000
*   RETURN;                         /* RETURN TO CALLER              */ 01786000
@EL00001 L     @13,4(,@13)                                      01S0465 01787000
@EF00001 L     @00,@SIZDATD                                     01S0465 01788000
         LR    @01,@11                                          01S0465 01789000
         FSPACE   R,LV=(0),A=(1)                                        01790000
@ER00001 LM    @14,@12,12(@13)                                  01S0465 01791000
         BR    @14                                              01S0465 01792000
*JFCBXGEN:                                                      01S0466 01793000
*   PROC;                           /* GENERATE JFCBX PROC           */ 01794000
         B     @EL00001                                         01S0466 01795000
JFCBXGEN STM   @14,@03,@SA00002                                 01S0466 01796000
         STM   @05,@12,@SA00002+24                              01S0466 01797000
*/********************************************************************/ 01798000
*/*                                                                  */ 01799000
*/* SEGMENT NAME - JFCBXGEN                                          */ 01800000
*/*                                                                  */ 01801000
*/* DESCRIPTIVE NAME - JFCBX GENERATE                                */ 01802000
*/*                                                                  */ 01803000
*/* FUNCTION - GENERATE,VIA SWA ASSIGN A JFCBX WHEN THE VOLUME       */ 01804000
*/*            SERIAL NUMBERS,TO BE COPIED,WILL NOT FIT IN THE       */ 01805000
*/*            EXISTING JFCB OR JFCBX.                               */ 01806000
*/*   OPERATION - 1. THE RESULTS OF -(N//JX-J) WHERE N= NUMBER OF    */ 01807000
*/*                  VOLSERS ALREADY COPIED, JX= NUMBER OF VOLSERS IN*/ 01808000
*/*                  A JFCBX,AND J= NUMBER OF VOLSERS IN A JFCB - IS */ 01809000
*/*                  EXAMINED AS FOLLOWS:                            */ 01810000
*/*                                  A- IF NON-ZERO THE NEXT VOLSER  */ 01811000
*/*                                     WILL FIT IN THIS BLOCK AND   */ 01812000
*/*                                     NO JFCBX IS GENERATED        */ 01813000
*/*                                  B- IF ZERO A JFCBX IS REQUIRED  */ 01814000
*/*               2. IF A JFCBX IS REQUIRED AND NONE ALREADY EXIST   */ 01815000
*/*                  THEN A JFCBX IS ASSIGNED AND CHAINED TO EITHER A*/ 01816000
*/*                  JFCB OR JFCBX.                                  */ 01817000
*/*               3. PTR INITIALIZED TO NEXT SLOT TO CONTAIN A       */ 01818000
*/*                  VOLSER                                          */ 01819000
*/* ENTRY - FROM CRI OR DD REFERNECE COMPETION.                      */ 01820000
*/*                                                                  */ 01821000
*/*   PURPOSE - TO OBTAIN A PTR TO THE NEXT VOLSER SLOT,GENERATING   */ 01822000
*/*             A JFCBX IF NONE EXIST(S), WHEN VOLSERS ARE COPIED.   */ 01823000
*/*   INPUT DATA - SCTVOLCT- NUMBER OF VOLSERS COPIED THUS FAR       */ 01824000
*/*                PTR TO LAST VOLSER COPIED.                        */ 01825000
*/*                                                                  */ 01826000
*/* EXIT -                                                           */ 01827000
*/*   CONDITION - ALL                                                */ 01828000
*/*                                                                  */ 01829000
*/*   OUTPUT DATA - AN ASSIGNED JFCBX IF NONE EXISTED WITH,          */ 01830000
*/*                   1. SVA OF JFCBX IN JFCB AND SVAB OF JFCBX IN   */ 01831000
*/*                      SIOT FOR FIRST JFCBX                        */ 01832000
*/*                   2. JFCBXS CHAINED VIA SVAS AND SVABS IN THE    */ 01833000
*/*                      PREVIOUS JFCBX.                             */ 01834000
*/*                   OR                                             */ 01835000
*/*                 THE ADDRESS(IN JVOLPTR) OF WHERE TO MOVE NEXT    */ 01836000
*/*                 VOLSER.                                          */ 01837000
*/*                                                                  */ 01838000
*/*   RETURN CODE - NONE.                                            */ 01839000
*/*                                                                  */ 01840000
*/********************************************************************/ 01841000
*                                                               01S0467 01842000
*   IF SCTVOLCT//JFXVLNO-JFBVLNO=0 THEN/* IF A JFCBX TO RECEIVE THE  */ 01843000
         SLR   @10,@10                                          01S0467 01844000
         SLR   @00,@00                                          01S0467 01845000
         IC    @00,SCTVOLCT(,CSIOTP)                            01S0467 01846000
         SRDA  @00,32                                           01S0467 01847000
         D     @00,@CF00058                                     01S0467 01848000
         SL    @00,@CF00133                                     01S0467 01849000
         CR    @00,@10                                          01S0467 01850000
         BNE   @RF00467                                         01S0467 01851000
*     DO;                           /* VOLUME SERIAL NUMBER,         */ 01852000
*       SWACTLS=0;                  /* CLEAR SWA INTERFACE CONTROLS, */ 01853000
         STH   @10,SWACTLS                                      01S0469 01854000
*       SWNEW=YES;                  /* INDICATE NEW EPA              */ 01855000
         OI    SWNEW,B'00001000'                                01S0470 01856000
*       SWCHN=YES;                  /* CHAIN EPA FOR WRITE           */ 01857000
         OI    SWCHN,B'10000000'                                01S0471 01858000
*       SWASN=YES;                  /* INDICATE ASSIGN OPERATION,    */ 01859000
         OI    SWASN,B'10000000'                                01S0472 01860000
*       BLKID=JFXID;                /* INDICATE JFCBX FOR LATER 01S0473 01861000
*                                      WRITE.                        */ 01862000
         MVI   BLKID,X'1D'                                      01S0473 01863000
*       IF SCTVOLCT=JFBVLNO THEN    /* IF NUMBER OF VOLSERS COPIED IS*/ 01864000
         CLI   SCTVOLCT(CSIOTP),5                               01S0474 01865000
         BNE   @RF00474                                         01S0474 01866000
*         DO;                       /* JFCB NO. THEN THIS IS 1ST        01867000
*                                      JFCBX                         */ 01868000
*           IF SIOTJFX=0 THEN       /* IF NO POINTER TO 1ST JFCBX       01869000
*                                      THEN                          */ 01870000
         C     @10,SIOTJFX(,CSIOTP)                             01S0476 01871000
         BNE   @RF00476                                         01S0476 01872000
*             DO;                   /* IT MUST BE ASSIGNED           */ 01873000
*               CALL IEFAB4F7       /* CALL IEFAB4F7 TO ASSIGN       */ 01874000
*                   (SWACTLS,0,EPAPTR,ADDR(SVAPRM),ADDR(SIOTJFX),JFXLEN 01875000
*                   ,1);                                        01S0478 01876000
         LA    @10,SWACTLS                                      01S0478 01877000
         ST    @10,@AL00001                                     01S0478 01878000
         LA    @10,@CF00638                                     01S0478 01879000
         ST    @10,@AL00001+4                                   01S0478 01880000
         LA    @10,EPAPTR                                       01S0478 01881000
         ST    @10,@AL00001+8                                   01S0478 01882000
         LA    @10,SVAPRM                                       01S0478 01883000
         ST    @10,@TF00001                                     01S0478 01884000
         LA    @10,@TF00001                                     01S0478 01885000
         ST    @10,@AL00001+12                                  01S0478 01886000
         LA    @10,SIOTJFX(,CSIOTP)                             01S0478 01887000
         ST    @10,@TF00002                                     01S0478 01888000
         LA    @10,@TF00002                                     01S0478 01889000
         ST    @10,@AL00001+16                                  01S0478 01890000
         LA    @10,@CF00145                                     01S0478 01891000
         ST    @10,@AL00001+20                                  01S0478 01892000
         LA    @10,@CF00070                                     01S0478 01893000
         ST    @10,@AL00001+24                                  01S0478 01894000
         L     @15,@CV00161                                     01S0478 01895000
         LA    @01,@AL00001                                     01S0478 01896000
         BALR  @14,@15                                          01S0478 01897000
*               JFCBEXAD=SVA;       /* PUT 1ST JFCBX SVA INTO JFCB   */ 01898000
         MVC   JFCBEXAD(3,CJFCBP),SVA                           01S0479 01899000
*             END;                                              01S0480 01900000
*           JFCBXPTR=SIOTJFX;       /* 1ST JFCBX POINTER FROM SIOT   */ 01901000
@RF00476 L     @10,SIOTJFX(,CSIOTP)                             01S0481 01902000
         ST    @10,JFCBXPTR                                     01S0481 01903000
*           NEWSERS=BLANKOUT;       /* BLANK OUT VOLSERS IN NEW 01S0482 01904000
*                                      JFCBX.                        */ 01905000
         MVC   NEWSERS(90,@10),BLANKOUT                         01S0482 01906000
*         END;                                                  01S0483 01907000
*       ELSE                        /* NOT 1ST JFCBX SO ASSIGN NEW   */ 01908000
*         DO;                       /* JFCBX,IF NONE EXIST           */ 01909000
         B     @RC00474                                         01S0484 01910000
@RF00474 DS    0H                                               01S0485 01911000
*           IF JFCBXNXT=0 THEN      /* IF NO POINTER TO NEXT JFCBX   */ 01912000
         L     @10,JFCBXPTR                                     01S0485 01913000
         L     @09,JFCBXNXT(,@10)                               01S0485 01914000
         LTR   @09,@09                                          01S0485 01915000
         BNZ   @RF00485                                         01S0485 01916000
*             DO;                   /* THEN ONE MUST BE ASSIGNED     */ 01917000
*               CALL IEFAB4F7       /* CALL IEFAB4F7 TO ASSIGN       */ 01918000
*                   (SWACTLS,0,EPAPTR,ADDR(SVAPRM),ADDR(JFCBXNXT),      01919000
*                   JFXLEN,1);                                  01S0487 01920000
         LA    @09,SWACTLS                                      01S0487 01921000
         ST    @09,@AL00001                                     01S0487 01922000
         LA    @09,@CF00638                                     01S0487 01923000
         ST    @09,@AL00001+4                                   01S0487 01924000
         LA    @09,EPAPTR                                       01S0487 01925000
         ST    @09,@AL00001+8                                   01S0487 01926000
         LA    @09,SVAPRM                                       01S0487 01927000
         ST    @09,@TF00001                                     01S0487 01928000
         LA    @09,@TF00001                                     01S0487 01929000
         ST    @09,@AL00001+12                                  01S0487 01930000
         LA    @10,JFCBXNXT(,@10)                               01S0487 01931000
         ST    @10,@TF00002                                     01S0487 01932000
         LA    @10,@TF00002                                     01S0487 01933000
         ST    @10,@AL00001+16                                  01S0487 01934000
         LA    @10,@CF00145                                     01S0487 01935000
         ST    @10,@AL00001+20                                  01S0487 01936000
         LA    @10,@CF00070                                     01S0487 01937000
         ST    @10,@AL00001+24                                  01S0487 01938000
         L     @15,@CV00161                                     01S0487 01939000
         LA    @01,@AL00001                                     01S0487 01940000
         BALR  @14,@15                                          01S0487 01941000
*               JFCBXTTR=SVA;       /* CHAIN JFCBX'S VIA SVA'S       */ 01942000
         L     @10,JFCBXPTR                                     01S0488 01943000
         MVC   JFCBXTTR(3,@10),SVA                              01S0488 01944000
*             END;                                              01S0489 01945000
*           JFCBXPTR=JFCBXNXT;      /* BASE NEW JFCBX                */ 01946000
@RF00485 L     @10,JFCBXPTR                                     01S0490 01947000
         L     @10,JFCBXNXT(,@10)                               01S0490 01948000
         ST    @10,JFCBXPTR                                     01S0490 01949000
*           NEWSERS=BLANKOUT;       /* BLANK OUT VOLSERS IN NEW 01S0491 01950000
*                                      JFCBX.                        */ 01951000
         MVC   NEWSERS(90,@10),BLANKOUT                         01S0491 01952000
*         END;                                                  01S0492 01953000
*       JVOLPTR=ADDR(JFCBXVOL);     /* VOLUME SERIAL LOCATION IN        01954000
*                                      JFCBX                         */ 01955000
@RC00474 L     JVOLPTR,JFCBXPTR                                 01S0493 01956000
         LA    JVOLPTR,JFCBXVOL(,JVOLPTR)                       01S0493 01957000
*     END;                                                      01S0494 01958000
*   ELSE                            /* THERE IS NO NEW JFCBX    01S0495 01959000
*                                      GENERATED,                    */ 01960000
*     JVOLPTR=JVOLPTR+VOLSERLN;     /* SO JUST UPDATE TO NEXT VOLSER.*/ 01961000
         B     @RC00467                                         01S0495 01962000
@RF00467 AL    JVOLPTR,@CF00105                                 01S0495 01963000
*   END JFCBXGEN;                                               01S0496 01964000
@EL00002 DS    0H                                               01S0496 01965000
@EF00002 DS    0H                                               01S0496 01966000
@ER00002 LM    @14,@03,@SA00002                                 01S0496 01967000
         LM    @05,@12,@SA00002+24                              01S0496 01968000
         BR    @14                                              01S0496 01969000
*DEVTPROC:                                                      02S0497 01970000
*   PROC;                           /* PROCESS DEVICE TYPES  @ZA12414*/ 01971000
DEVTPROC STM   @14,@12,12(@13)                                  02S0497 01972000
*/********************************************************************/ 01973000
*/*                                                          @ZA12414*/ 01974000
*/* SEGMENT NAME - DEVTPROC                                  @ZA12414*/ 01975000
*/*                                                          @ZA12414*/ 01976000
*/* DESCRIPTIVE NAME - DEVICE TYPE PROCESSING                @ZA12414*/ 01977000
*/*                                                          @ZA12414*/ 01978000
*/* FUNCTION - TURN OFF BITS IN THE DEVICE TYPE WORD AFTER   @ZA12414*/ 01979000
*/*            RETRIEVAL FROM THE CATALOG RETURN INFORMATION.@ZA12414*/ 01980000
*/*            THIS IS REQUIRED BECAUSE SOME SYSTEMS, AT     @ZA12414*/ 01981000
*/*            LEAST VS1, LEAVES SOME OF THE BITS ON WHEN    @ZA12414*/ 01982000
*/*            CATALOGING DATA SETS. THE BITS BEING TURNED   @ZA12414*/ 01983000
*/*            OFF DO NOT EFFECT DEVICE ELLIGIBILITY.        @ZA12414*/ 01984000
*/*                                                          @ZA12414*/ 01985000
*/* ENTRY                                                    @ZA12414*/ 01986000
*/*   PURPOSE - SEE FUNCTION                                 @ZA12414*/ 01987000
*/*                                                          @ZA12414*/ 01988000
*/*   INPUT DATA - DEVTYPE WORD AS IT CAME FROM THE CRI.     @ZA12414*/ 01989000
*/*                                                          @ZA12414*/ 01990000
*/* EXITS -                                                  @ZA12414*/ 01991000
*/*   CONDITION - WHEN DEVTYPE HAS BEEN EXAMINED AND THE     @ZA12414*/ 01992000
*/*               APPROPRIATE OPTION BITS TURNED OFF.        @ZA12414*/ 01993000
*/*                                                          @ZA12414*/ 01994000
*/*   OUTPUT DATA - DEVTYPE WORD UPDATED AS INDICATED IN THE @ZA12414*/ 01995000
*/*                 CODE.                                    @ZA12414*/ 01996000
*/*                                                          @ZA12414*/ 01997000
*/*   RETURN CODE - NONE                                     @ZA12414*/ 01998000
*/*                                                          @ZA12414*/ 01999000
*/********************************************************************/ 02000000
*                                                               02S0498 02001000
*   IF DEVDACC=YES THEN             /* CHECK FOR DA DEVICE   @ZA12414*/ 02002000
         TM    DEVDACC(DEVTPTR),B'00100000'                     02S0498 02003000
         BNO   @RF00498                                         02S0498 02004000
*     DO;                           /* IT IS DIRECT ACCESS   @ZA12414*/ 02005000
*       DEVTBYT2=DEVTBYT2&SHPOWOFF; /* TURN OFF SHR & PWR    @ZA12414*/ 02006000
         NI    DEVTBYT2(DEVTPTR),X'DC'                          02S0500 02007000
*       IF DEVTBYT4=DA3340 THEN     /* CHECK FOR 3340 DEV    @ZA12414*/ 02008000
         CLI   DEVTBYT4(DEVTPTR),X'0A'                          02S0501 02009000
         BNE   @RF00501                                         02S0501 02010000
*         DEVTBYT2=DEVTBYT2&RPSMASK;/* 3340 DEV-RPS OFF      @ZA12414*/ 02011000
         NI    DEVTBYT2(DEVTPTR),X'EF'                          02S0502 02012000
*     END;                          /* END DIRECT ACCESS     @ZA12414*/ 02013000
@RF00501 DS    0H                                               02S0504 02014000
*   IF DEVTAPE=YES THEN             /* CHECK FOR TAPE DEV    @ZA12414*/ 02015000
@RF00498 TM    DEVTAPE(DEVTPTR),B'10000000'                     02S0504 02016000
         BNO   @RF00504                                         02S0504 02017000
*     DEVTBYT2=DEVTBYT2&POWEROFF;   /* TURN POWER BITS OFF   @ZA12414*/ 02018000
         NI    DEVTBYT2(DEVTPTR),X'F4'                          02S0505 02019000
*   IF DEVUREC=YES THEN             /* CHECK FOR UNIT REC    @ZA12414*/ 02020000
@RF00504 TM    DEVUREC(DEVTPTR),B'00001000'                     02S0506 02021000
         BNO   @RF00506                                         02S0506 02022000
*     IF DEVTBYT4^=UR3211 THEN      /* CHECK FOR 3211 DEV    @ZA12414*/ 02023000
         CLI   DEVTBYT4(DEVTPTR),X'09'                          02S0507 02024000
         BE    @RF00507                                         02S0507 02025000
*       DEVTBYT2=OPTSOFF;           /* NO TURN OPTIONS OFF   @ZA12414*/ 02026000
         MVI   DEVTBYT2(DEVTPTR),X'00'                          02S0508 02027000
*     ELSE                          /* IT IS A 3211 DEVICE   @ZA12414*/ 02028000
*       DEVTBYT2=DEVTBYT2&UCSOPMSK; /* LEAVE UCS BIT ON      @ZA12414*/ 02029000
         B     @RC00507                                         02S0509 02030000
@RF00507 NI    DEVTBYT2(DEVTPTR),X'80'                          02S0509 02031000
*   IF DEVDISP=YES THEN             /* CHECK FOR DISPLAY     @ZA12414*/ 02032000
@RC00507 DS    0H                                               02S0510 02033000
@RF00506 TM    DEVDISP(DEVTPTR),B'00010000'                     02S0510 02034000
         BNO   @RF00510                                         02S0510 02035000
*     DEVTBYT2=OPTSOFF;             /* YES TURN OPTS OFF     @ZA12414*/ 02036000
         MVI   DEVTBYT2(DEVTPTR),X'00'                          02S0511 02037000
*   END DEVTPROC;                   /*                       @ZA12414*/ 02038000
@EL00003 DS    0H                                               02S0512 02039000
@EF00003 DS    0H                                               02S0512 02040000
@ER00003 LM    @14,@12,12(@13)                                  02S0512 02041000
         BR    @14                                              02S0512 02042000
*   END IEFAB464                                                01S0513 02043000
*                                                               01S0513 02044000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02045000
*/*%INCLUDE SYSUT5  (PRLG464 )                                       */ 02046000
*/*%INCLUDE SYSUT5  (DCL464  )                                       */ 02047000
*/*%INCLUDE SYSUT5  (CRIRFDCL)                                       */ 02048000
*/*%INCLUDE SYSUT5  (DDRFDCL )                                       */ 02049000
*/*%INCLUDE SYSUT5  (TPRFDCLS)                                       */ 02050000
*/*%INCLUDE SYSUT5  (TPONDCL )                                       */ 02051000
*/*%INCLUDE SYSUT5  (JFXGNDCL)                                       */ 02052000
*/*%INCLUDE SYSUT5  (DCLOVD  )                                       */ 02053000
*/*%INCLUDE SYSLIB  (IEFZB436)                                       */ 02054000
*/*%INCLUDE SYSLIB  (IEFASIOT)                                       */ 02055000
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */ 02056000
*/*%INCLUDE SYSLIB  (IEFJFCBX)                                       */ 02057000
*/*%INCLUDE SYSLIB  (IEFZB437)                                       */ 02058000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                       */ 02059000
*/*%INCLUDE SYSLIB  (IEZCTGWA)                                       */ 02060000
*/*%INCLUDE SYSLIB  (IEZCTGVL)                                       */ 02061000
*/*%INCLUDE SYSLIB  (IEFZB421)                                       */ 02062000
*/*%INCLUDE SYSUT5  (CRIRFCMP)                                       */ 02063000
*/*%INCLUDE SYSUT5  (CRIPLG  )                                       */ 02064000
*/*%INCLUDE SYSUT5  (DDREFCMP)                                       */ 02065000
*/*%INCLUDE SYSUT5  (DDPRLG  )                                       */ 02066000
*/*%INCLUDE SYSUT5  (TAPEONLY)                                       */ 02067000
*/*%INCLUDE SYSUT5  (TPONSPEC)                                       */ 02068000
*/*%INCLUDE SYSUT5  (DDVLCOPY)                                       */ 02069000
*/*%INCLUDE SYSUT5  (DDVLSPEC)                                       */ 02070000
*/*%INCLUDE SYSUT5  (TAPEVREF)                                       */ 02071000
*/*%INCLUDE SYSUT5  (TVRFSPEC)                                       */ 02072000
*/*%INCLUDE SYSUT5  (VIOCOMP )                                       */ 02073000
*/*%INCLUDE SYSUT5  (VIOCMPSP)                                       */ 02074000
*/*%INCLUDE SYSUT5  (UNOVERID)                                       */ 02075000
*/*%INCLUDE SYSUT5  (OVRIDSPC)                                       */ 02076000
*/*%INCLUDE SYSUT5  (NOREFCMP)                                       */ 02077000
*/*%INCLUDE SYSUT5  (NRPRLG  )                                       */ 02078000
*/*%INCLUDE SYSUT5  (CATDEVT )                                       */ 02079000
*/*%INCLUDE SYSUT5  (JFXGSPEC)                                       */ 02080000
*/*%INCLUDE SYSUT5  (DEVTPROC)                                       */ 02081000
*/*%INCLUDE SYSUT5  (DEVTPRLG)                                       */ 02082000
*                                                               01S0513 02083000
*       ;                                                       01S0513 02084000
@DATA    DS    0H                                                       02085000
@CH00081 DC    H'2'                                                     02086000
@CH00062 DC    H'4'                                                     02087000
@CH00060 DC    H'8'                                                     02088000
@DATD    DSECT                                                          02089000
         DS    0F                                                       02090000
@SA00001 DS    18F                                                      02091000
@PC00001 DS    7F                                                       02092000
@SA00002 DS    0F                                                       02093000
         DS    14F                                                      02094000
@AL00001 DS    7A                                                       02095000
@TF00001 DS    F                                                        02096000
@TF00002 DS    F                                                        02097000
IEFAB464 CSECT                                                          02098000
         DS    0F                                                       02099000
@CF00638 DC    F'0'                                                     02100000
@CF00070 DC    F'1'                                                     02101000
@CH00070 EQU   @CF00070+2                                               02102000
@CF00133 DC    F'5'                                                     02103000
@CF00105 DC    F'6'                                                     02104000
@CH00105 EQU   @CF00105+2                                               02105000
@CF00058 DC    F'15'                                                    02106000
@CF00145 DC    F'176'                                                   02107000
@DATD    DSECT                                                          02108000
         DS    0D                                                       02109000
VLPTR    DS    A                                                        02110000
GRPPTR   DS    A                                                        02111000
GRPTABP  DS    A                                                        02112000
EPAPTR   DS    A                                                        02113000
ORGJFBP  DS    A                                                        02114000
JSVAP    DS    A                                                        02115000
JFCBXPTR DS    A                                                        02116000
RDEVPTR  DS    A                                                        02117000
DEVSFND  DS    H                                                        02118000
SWACTLS  DS    FL2                                                      02119000
         ORG   SWACTLS                                                  02120000
SWASN    DS    BL1                                                      02121000
SWDEL    EQU   SWACTLS+0                                                02122000
SWREAD   EQU   SWACTLS+0                                                02123000
SWWRT    EQU   SWACTLS+0                                                02124000
SWNEW    EQU   SWACTLS+0                                                02125000
SWFREE   EQU   SWACTLS+0                                                02126000
SWMOD    EQU   SWACTLS+0                                                02127000
SWOLD    EQU   SWACTLS+0                                                02128000
SWCHN    DS    BL1                                                      02129000
@NM00004 EQU   SWACTLS+1                                                02130000
         ORG   SWACTLS+2                                                02131000
RTVDUNIT DS    CL8                                                      02132000
         ORG   RTVDUNIT                                                 02133000
DEVTYPE  DS    CL4                                                      02134000
ZEROUCB  DS    FL4                                                      02135000
         ORG   RTVDUNIT+8                                               02136000
VOLSDONE DS    BL1                                                      02137000
SVAPRM   DS    CL4                                                      02138000
         ORG   SVAPRM                                                   02139000
SVA      DS    CL3                                                      02140000
BLKID    DS    CL1                                                      02141000
         ORG   SVAPRM+4                                                 02142000
SCANEND  DS    BL1                                                      02143000
IEFAB464 CSECT                                                          02144000
         DS    0F                                                       02145000
@SIZDATD DC    AL1(230)                                                 02146000
         DC    AL3(@ENDDATD-@DATD)                                      02147000
@CA00157 DC    A(EDTTAB)                                                02148000
@CV00158 DC    V(IEFAB463)                                              02149000
@CV00159 DC    V(IEFAB470)                                              02150000
@CV00161 DC    V(IEFAB4F7)                                              02151000
         DS    0D                                                       02152000
VLEN     DC    AL2(12)                                                  02153000
BLANK    DC    CL6' '                                                   02154000
BLANKS   DC    CL8' '                                                   02155000
ALLDA    DC    CL8'SYSALLDA'                                            02156000
BLANKOUT DC    CL90' '                                                  02157000
IEFAB464 CSECT                                                          02158000
         DS   0H                                                        02159000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   02160000
@DATD    DSECT                                                          02161000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02162000
@ENDDATD EQU   *                                                        02163000
IEFAB464 CSECT                                                          02164000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02165000
@01      EQU   01                                                       02166000
@02      EQU   02                                                       02167000
@03      EQU   03                                                       02168000
@04      EQU   04                                                       02169000
@05      EQU   05                                                       02170000
@06      EQU   06                                                       02171000
@07      EQU   07                                                       02172000
@08      EQU   08                                                       02173000
@09      EQU   09                                                       02174000
@10      EQU   10                                                       02175000
@11      EQU   11                                                       02176000
@12      EQU   12                                                       02177000
@13      EQU   13                                                       02178000
@14      EQU   14                                                       02179000
@15      EQU   15                                                       02180000
LUVPTR   EQU   @02                                                      02181000
GENPTR   EQU   @04                                                      02182000
EDTPTR   EQU   @03                                                      02183000
LUVCTR   EQU   @09                                                      02184000
GENCTR   EQU   @05                                                      02185000
VOLCOPY  EQU   @02                                                      02186000
JVOLPTR  EQU   @04                                                      02187000
RVOLPTR  EQU   @02                                                      02188000
RJFCBXP  EQU   @05                                                      02189000
RJFCBP   EQU   @03                                                      02190000
DEVPTR   EQU   @02                                                      02191000
CDEVPTR  EQU   @05                                                      02192000
DEVTPTR  EQU   @02                                                      02193000
CSIOTP   EQU   @06                                                      02194000
CJFCBP   EQU   @07                                                      02195000
RSIOTP   EQU   @08                                                      02196000
         EXTRN EDTTAB                                                   02197000
DEVWORD  EQU   0                                                        02198000
DEVTBYT2 EQU   DEVWORD+1                                                02199000
@NM00002 EQU   DEVWORD+2                                                02200000
DEVTAPE  EQU   @NM00002                                                 02201000
DEVDACC  EQU   @NM00002                                                 02202000
DEVDISP  EQU   @NM00002                                                 02203000
DEVUREC  EQU   @NM00002                                                 02204000
DEVTBYT4 EQU   DEVWORD+3                                                02205000
VSER     EQU   0                                                        02206000
JSVA     EQU   0                                                        02207000
CTGVL    EQU   0                                                        02208000
CTGVLVOL EQU   CTGVL                                                    02209000
CTGVLDEV EQU   CTGVL+6                                                  02210000
CTGVLSEQ EQU   CTGVL+10                                                 02211000
NEXTSER  EQU   0                                                        02212000
HWUCLST  EQU   0                                                        02213000
HWEDTLUV EQU   HWUCLST                                                  02214000
HWDEVTYP EQU   HWUCLST+4                                                02215000
HWUCBP   EQU   HWUCLST+8                                                02216000
INDMSIOT EQU   0                                                        02217000
SCTUSADD EQU   INDMSIOT+20                                              02218000
SIOTUNAF EQU   SCTUSADD                                                 02219000
SCTPJFCB EQU   INDMSIOT+32                                              02220000
SIOTREFN EQU   INDMSIOT+40                                              02221000
SIOTBYT1 EQU   INDMSIOT+43                                              02222000
SIOVAMDS EQU   SIOTBYT1                                                 02223000
SCTDDINO EQU   INDMSIOT+44                                              02224000
SIOTBYT3 EQU   INDMSIOT+46                                              02225000
SIOCDEVT EQU   SIOTBYT3                                                 02226000
SIOTTSTC EQU   INDMSIOT+47                                              02227000
SCTVOLCT EQU   INDMSIOT+49                                              02228000
SIOTBYT0 EQU   INDMSIOT+52                                              02229000
SIOTSSDS EQU   SIOTBYT0                                                 02230000
SCTNMBUT EQU   INDMSIOT+53                                              02231000
SCTSDISP EQU   INDMSIOT+55                                              02232000
S3400DSP EQU   SCTSDISP                                                 02233000
SIOTPRIV EQU   SCTSDISP                                                 02234000
SCTSBYT1 EQU   INDMSIOT+56                                              02235000
SCTDUMMY EQU   SCTSBYT1                                                 02236000
SIOTGDSN EQU   SCTSBYT1                                                 02237000
SCTPARLM EQU   SCTSBYT1                                                 02238000
SCTUNAFF EQU   SCTSBYT1                                                 02239000
SCTSBYT2 EQU   INDMSIOT+57                                              02240000
SCTVOLAF EQU   SCTSBYT2                                                 02241000
SCTUNLBD EQU   SCTSBYT2                                                 02242000
SCTRECVD EQU   SCTSBYT2                                                 02243000
SCTSBYT3 EQU   INDMSIOT+58                                              02244000
SCTVREF  EQU   SCTSBYT3                                                 02245000
SCTSNEW  EQU   SCTSBYT3                                                 02246000
SCTSMOD  EQU   SCTSBYT3                                                 02247000
SCTSBYT4 EQU   INDMSIOT+59                                              02248000
SIOTVAFF EQU   SCTSBYT4                                                 02249000
SCTUTYPE EQU   INDMSIOT+60                                              02250000
SIOTDEVT EQU   SCTUTYPE                                                 02251000
SIOUBYT3 EQU   SIOTDEVT+2                                               02252000
SIOUCNVT EQU   SCTUTYPE+4                                               02253000
SIOUCBAD EQU   SCTUTYPE+5                                               02254000
SIOTBYT4 EQU   INDMSIOT+81                                              02255000
SIOTALTD EQU   INDMSIOT+92                                              02256000
SIOTBYT2 EQU   INDMSIOT+103                                             02257000
SIOTDMND EQU   SIOTBYT2                                                 02258000
SIOTGALL EQU   SIOTBYT2                                                 02259000
SJFCBPTR EQU   INDMSIOT+156                                             02260000
SIOTJFX  EQU   INDMSIOT+160                                             02261000
INFMJFCB EQU   0                                                        02262000
JFCBDSNM EQU   INFMJFCB                                                 02263000
JFCBELNM EQU   INFMJFCB+44                                              02264000
JFCBTSDM EQU   INFMJFCB+52                                              02265000
JFCCAT   EQU   JFCBTSDM                                                 02266000
JFCBDSCB EQU   INFMJFCB+53                                              02267000
JFCFCBID EQU   INFMJFCB+56                                              02268000
JFCBFRID EQU   JFCFCBID                                                 02269000
JFCBLTYP EQU   INFMJFCB+66                                              02270000
JFCSUL   EQU   JFCBLTYP                                                 02271000
JFCSL    EQU   JFCBLTYP                                                 02272000
JFCBOTTR EQU   INFMJFCB+67                                              02273000
JFCBUFOF EQU   JFCBOTTR                                                 02274000
JFCBFLSQ EQU   JFCBOTTR+1                                               02275000
JFCFUNC  EQU   JFCBFLSQ                                                 02276000
JFCBMASK EQU   INFMJFCB+72                                              02277000
JFCBFLG1 EQU   JFCBMASK+5                                               02278000
JFCOPEN  EQU   JFCBFLG1                                                 02279000
JFCBFLG2 EQU   JFCBMASK+6                                               02280000
JFCDEFER EQU   JFCBFLG2                                                 02281000
JFCMODNW EQU   JFCBFLG2                                                 02282000
JFCBIND1 EQU   INFMJFCB+86                                              02283000
JFCBIND2 EQU   INFMJFCB+87                                              02284000
JFCDISP  EQU   JFCBIND2                                                 02285000
JFCAMPTR EQU   INFMJFCB+88                                              02286000
JFCBUFRQ EQU   JFCAMPTR                                                 02287000
JFCBUFNO EQU   JFCBUFRQ                                                 02288000
JFCBGNCP EQU   JFCAMPTR+1                                               02289000
JFCBHIAR EQU   JFCBGNCP                                                 02290000
JFCBFALN EQU   JFCBHIAR                                                 02291000
JFCBFTEK EQU   JFCBFALN                                                 02292000
JFCBBFTA EQU   JFCBFTEK                                                 02293000
JFCEROPT EQU   INFMJFCB+92                                              02294000
JFCTRTCH EQU   INFMJFCB+93                                              02295000
JFCBX    EQU   0                                                        02296000
JFCBXTTR EQU   JFCBX                                                    02297000
JFCBXVOL EQU   JFCBX+4                                                  02298000
JFCBXDEV EQU   JFCBX+140                                                02299000
JFCBXNXT EQU   JFCBX+172                                                02300000
HWCNTRL  EQU   0                                                        02301000
HWVUREC  EQU   HWCNTRL+2                                                02302000
HWRESIOT EQU   HWCNTRL+2                                                02303000
HWDSNCAT EQU   HWCNTRL+2                                                02304000
HWOVCAND EQU   HWCNTRL+2                                                02305000
HWUCB    EQU   HWCNTRL+2                                                02306000
HWEDT    EQU   HWCNTRL+3                                                02307000
HWVAME   EQU   HWCNTRL+3                                                02308000
HWOVRDN  EQU   HWCNTRL+3                                                02309000
HWMSSCTL EQU   HWCNTRL+3                                                02310000
HWAVUNIT EQU   HWMSSCTL                                                 02311000
HWVLSELF EQU   HWMSSCTL+1                                               02312000
HWAVSRCH EQU   HWMSSCTL+1                                               02313000
HWTBLCTL EQU   HWCNTRL+6                                                02314000
HWJLCTLS EQU   HWCNTRL+7                                                02315000
HWDDSTEP EQU   HWCNTRL+10                                               02316000
HWDDCTR  EQU   HWCNTRL+12                                               02317000
HWDATA   EQU   0                                                        02318000
HWLEPAP  EQU   HWDATA+12                                                02319000
HWGEPACP EQU   HWDATA+16                                                02320000
HWIOSLTP EQU   HWDATA+32                                                02321000
HWRSIOTP EQU   HWDATA+40                                                02322000
HWUCLPTR EQU   HWDATA+56                                                02323000
HWLEPARP EQU   HWDATA+60                                                02324000
HWVLSELP EQU   HWDATA+80                                                02325000
HWSTPNBR EQU   HWDATA+172                                               02326000
HWDEV    EQU   0                                                        02327000
HWMBYTE  EQU   HWDEV                                                    02328000
HWOBYTE  EQU   HWDEV+1                                                  02329000
HW7TRK   EQU   HWOBYTE                                                  02330000
HWCTBYT  EQU   HWDEV+2                                                  02331000
HWTAPE   EQU   HWCTBYT                                                  02332000
HWDA     EQU   HWCTBYT                                                  02333000
HWTYPE   EQU   HWCTBYT+1                                                02334000
HWRETURN EQU   0                                                        02335000
HWRTCD   EQU   HWRETURN                                                 02336000
HWRSNCD  EQU   HWRETURN+2                                               02337000
HWVLSELB EQU   0                                                        02338000
HWSELHDR EQU   HWVLSELB                                                 02339000
HWVLSLCT EQU   HWSELHDR+2                                               02340000
HWVLSERS EQU   HWVLSELB+4                                               02341000
CTGPL    EQU   0                                                        02342000
CTGOPTN1 EQU   CTGPL                                                    02343000
CTGOPTN2 EQU   CTGPL+1                                                  02344000
CTGEXT   EQU   CTGOPTN2                                                 02345000
CTGERASE EQU   CTGOPTN2                                                 02346000
CTGSMF   EQU   CTGERASE                                                 02347000
CTGREL   EQU   CTGSMF                                                   02348000
CTGPURG  EQU   CTGOPTN2                                                 02349000
CTGVMNT  EQU   CTGPURG                                                  02350000
CTGOPTN3 EQU   CTGPL+2                                                  02351000
CTGOPTN4 EQU   CTGPL+3                                                  02352000
CTGENT   EQU   CTGPL+4                                                  02353000
CTGCAT   EQU   CTGPL+8                                                  02354000
CTGWKA   EQU   CTGPL+12                                                 02355000
CTGDSORG EQU   CTGPL+16                                                 02356000
CTGDDNM  EQU   CTGPL+20                                                 02357000
CTGNEWNM EQU   CTGDDNM                                                  02358000
CTGFBFLG EQU   CTGNEWNM+2                                               02359000
CTGJSCB  EQU   CTGPL+24                                                 02360000
CTGWA    EQU   0                                                        02361000
CTGWAVL  EQU   CTGWA                                                    02362000
CTGWAVCT EQU   CTGWA+6                                                  02363000
CTGWAUCT EQU   CTGWA+8                                                  02364000
CTGVLX   EQU   0                                                        02365000
CTGVLTTR EQU   CTGVLX+12                                                02366000
EDTHDR   EQU   0                                                        02367000
EDTLUVSP EQU   EDTHDR                                                   02368000
EDTGENSP EQU   EDTHDR+4                                                 02369000
EDTGRPSP EQU   EDTHDR+8                                                 02370000
EDTUCBSP EQU   EDTHDR+12                                                02371000
EDTMSKTP EQU   EDTHDR+16                                                02372000
LUVSECT  EQU   0                                                        02373000
LUVHDR   EQU   LUVSECT                                                  02374000
LUVENTNO EQU   LUVHDR                                                   02375000
LUVENTLN EQU   LUVHDR+4                                                 02376000
LUVENTRY EQU   0                                                        02377000
LUVALUE  EQU   LUVENTRY+8                                               02378000
LUVGMTP  EQU   LUVENTRY+12                                              02379000
LUVGENNO EQU   LUVENTRY+16                                              02380000
LUVGENP  EQU   LUVENTRY+20                                              02381000
LUVFLAGS EQU   LUVENTRY+24                                              02382000
GENSECT  EQU   0                                                        02383000
GENHDR   EQU   GENSECT                                                  02384000
GENENTLN EQU   GENHDR+4                                                 02385000
GENENTRY EQU   0                                                        02386000
GENDEVT  EQU   GENENTRY                                                 02387000
GRPTRTAB EQU   0                                                        02388000
GRPSECT  EQU   0                                                        02389000
GRPHDR   EQU   GRPSECT                                                  02390000
GRPENTRY EQU   0                                                        02391000
GRPUCBP  EQU   GRPENTRY+8                                               02392000
EUCBSECT EQU   0                                                        02393000
EUCBHDR  EQU   EUCBSECT                                                 02394000
EUCBENTY EQU   0                                                        02395000
GRMSKTAB EQU   0                                                        02396000
GMTHDR   EQU   GRMSKTAB                                                 02397000
GMTENTRY EQU   0                                                        02398000
HWCNTRLP EQU   0                                                        02399000
HWDATAP  EQU   0                                                        02400000
HWRTNP   EQU   0                                                        02401000
CSIOTPTR EQU   0                                                        02402000
CJFCBPTR EQU   0                                                        02403000
CRIP     EQU   0                                                        02404000
RSIOTPTR EQU   0                                                        02405000
JFCKEYLE EQU   JFCTRTCH                                                 02406000
JFCCODE  EQU   JFCKEYLE                                                 02407000
JFCSTACK EQU   JFCTRTCH                                                 02408000
JFCMODE  EQU   JFCSTACK                                                 02409000
JFCSPPRT EQU   JFCTRTCH                                                 02410000
JFCDEN   EQU   JFCSPPRT+1                                               02411000
JFCBABFS EQU   JFCSPPRT+2                                               02412000
JFCLIMCT EQU   JFCBABFS                                                 02413000
JFCDSORG EQU   JFCSPPRT+5                                               02414000
JFCDSRG1 EQU   JFCDSORG                                                 02415000
JFCORGIS EQU   JFCDSRG1                                                 02416000
JFCDSRG2 EQU   JFCDSORG+1                                               02417000
JFCORGAM EQU   JFCDSRG2                                                 02418000
JFCRECFM EQU   JFCSPPRT+7                                               02419000
JFCRCFM  EQU   JFCRECFM                                                 02420000
JFCOPTCD EQU   JFCSPPRT+8                                               02421000
JFCWVCSP EQU   JFCOPTCD                                                 02422000
JFCWVCIS EQU   JFCWVCSP                                                 02423000
JFCWVCBD EQU   JFCWVCIS                                                 02424000
JFCALLOW EQU   JFCOPTCD                                                 02425000
JFCRSV17 EQU   JFCALLOW                                                 02426000
JFCOVER  EQU   JFCRSV17                                                 02427000
JFCPCIBT EQU   JFCOPTCD                                                 02428000
JFCMAST  EQU   JFCPCIBT                                                 02429000
JFCEXT   EQU   JFCMAST                                                  02430000
JFCBCKPT EQU   JFCOPTCD                                                 02431000
JFCIND   EQU   JFCBCKPT                                                 02432000
JFCRSV18 EQU   JFCOPTCD                                                 02433000
JFCCYL   EQU   JFCRSV18                                                 02434000
JFCACT   EQU   JFCCYL                                                   02435000
JFCREDUC EQU   JFCOPTCD                                                 02436000
JFCRSV19 EQU   JFCREDUC                                                 02437000
JFCRSV20 EQU   JFCRSV19                                                 02438000
JFCRSV21 EQU   JFCOPTCD                                                 02439000
JFCDEL   EQU   JFCRSV21                                                 02440000
JFCOPTJ  EQU   JFCOPTCD                                                 02441000
JFCREORG EQU   JFCOPTJ                                                  02442000
JFCBLKSI EQU   JFCSPPRT+9                                               02443000
JFCBUFSI EQU   JFCBLKSI                                                 02444000
JFCAMSYN EQU   JFCSPPRT+11                                              02445000
JFCNCP   EQU   JFCAMSYN+2                                               02446000
JFCNTM   EQU   JFCAMSYN+3                                               02447000
JFCBFSEQ EQU   JFCNTM                                                   02448000
JFCPCI   EQU   JFCBFSEQ                                                 02449000
JFCRESRV EQU   JFCAMSYN+4                                               02450000
JFCUCSEG EQU   JFCRESRV                                                 02451000
JFCUCSOP EQU   JFCUCSEG+4                                               02452000
JFCOUTLI EQU   JFCUCSEG+5                                               02453000
JFCTHRSH EQU   JFCOUTLI                                                 02454000
JFCCPRI  EQU   JFCTHRSH                                                 02455000
JFCBNVOL EQU   JFCUCSEG+9                                               02456000
JFCBVOLS EQU   JFCUCSEG+10                                              02457000
JFCBS001 EQU   JFCBVOLS                                                 02458000
JFCMSVGP EQU   JFCBS001+22                                              02459000
JFCBEXAD EQU   JFCBS001+31                                              02460000
JFCBPQTY EQU   JFCBS001+34                                              02461000
JFCBCTRI EQU   JFCBS001+37                                              02462000
JFCBMSGP EQU   JFCBCTRI                                                 02463000
JFCBSQTY EQU   JFCBS001+38                                              02464000
JFCFLGS1 EQU   JFCBS001+41                                              02465000
JFCVRDS  EQU   JFCFLGS1                                                 02466000
JFCBSPNM EQU   JFCBS001+45                                              02467000
JFCBFLG3 EQU   JFCBSPNM                                                 02468000
NEWSERS  EQU   JFCBXVOL                                                 02469000
@NM00044 EQU   CTGDDNM                                                  02470000
CTGPROB  EQU   @NM00044                                                 02471000
CTGREASN EQU   CTGPROB+2                                                02472000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02473000
CTGREAS2 EQU   CTGREASN+1                                               02474000
CTGREAS1 EQU   CTGREASN                                                 02475000
CTGMODID EQU   CTGPROB                                                  02476000
JFCBEND  EQU   JFCBS001+58                                              02477000
JFCBSPTN EQU   JFCBS001+57                                              02478000
JFCBVLCT EQU   JFCBS001+56                                              02479000
JFCBDRLH EQU   JFCBS001+53                                              02480000
JFCBSBNM EQU   JFCBS001+50                                              02481000
JFCBABST EQU   JFCBS001+48                                              02482000
JFCBRV08 EQU   JFCBSPNM+1                                               02483000
JFCBRV07 EQU   JFCBFLG3                                                 02484000
JFCBRV06 EQU   JFCBFLG3                                                 02485000
JFCBRV05 EQU   JFCBFLG3                                                 02486000
JFCBRV04 EQU   JFCBFLG3                                                 02487000
JFCBRV03 EQU   JFCBFLG3                                                 02488000
JFCBRV02 EQU   JFCBFLG3                                                 02489000
JFCBEXP  EQU   JFCBFLG3                                                 02490000
JFCDQDSP EQU   JFCBFLG3                                                 02491000
JFCBDQTY EQU   JFCBS001+42                                              02492000
JFCBUAFF EQU   JFCFLGS1                                                 02493000
JFCRSV45 EQU   JFCFLGS1                                                 02494000
JFCBCEOV EQU   JFCFLGS1                                                 02495000
JFCRSV42 EQU   JFCFLGS1                                                 02496000
JFCBADSP EQU   JFCFLGS1                                                 02497000
JFCTOPEN EQU   JFCFLGS1                                                 02498000
JFCBDLET EQU   JFCFLGS1                                                 02499000
JFCRQID  EQU   JFCBSQTY                                                 02500000
JFCROUND EQU   JFCBCTRI                                                 02501000
JFCALX   EQU   JFCBCTRI                                                 02502000
JFCMIXG  EQU   JFCBCTRI                                                 02503000
JFCONTIG EQU   JFCBCTRI                                                 02504000
JFCRSV29 EQU   JFCBCTRI                                                 02505000
JFCBSPAC EQU   JFCBCTRI                                                 02506000
JFCRUNIT EQU   JFCBPQTY                                                 02507000
JFCBEXTL EQU   JFCBS001+30                                              02508000
@NM00021 EQU   JFCBS001                                                 02509000
JFCAVOLS EQU   JFCBVOLS                                                 02510000
JFCBNTCS EQU   JFCUCSEG+8                                               02511000
JFCSOWA  EQU   JFCOUTLI+1                                               02512000
JFCSEND  EQU   JFCCPRI                                                  02513000
JFCEQUAL EQU   JFCCPRI                                                  02514000
JFCRECV  EQU   JFCCPRI                                                  02515000
JFCRSV34 EQU   JFCCPRI                                                  02516000
JFCRSV33 EQU   JFCCPRI                                                  02517000
JFCRSV55 EQU   JFCCPRI                                                  02518000
JFCRSV54 EQU   JFCCPRI                                                  02519000
JFCRSV53 EQU   JFCCPRI                                                  02520000
JFCRSV27 EQU   JFCUCSOP                                                 02521000
JFCRSV26 EQU   JFCUCSOP                                                 02522000
JFCFCBVR EQU   JFCUCSOP                                                 02523000
JFCFCBAL EQU   JFCUCSOP                                                 02524000
JFCVER   EQU   JFCUCSOP                                                 02525000
JFCRSV25 EQU   JFCUCSOP                                                 02526000
JFCFOLD  EQU   JFCUCSOP                                                 02527000
JFCBEXTP EQU   JFCUCSOP                                                 02528000
JFCUCSID EQU   JFCUCSEG                                                 02529000
JFCINTVL EQU   JFCSPPRT+19                                              02530000
JFCDBUFN EQU   JFCRESRV+3                                               02531000
JFCCYLOF EQU   JFCRESRV+2                                               02532000
JFCRKP   EQU   JFCRESRV                                                 02533000
JFCPCIR2 EQU   JFCPCI                                                   02534000
JFCPCIR1 EQU   JFCPCI                                                   02535000
JFCPCIN2 EQU   JFCPCI                                                   02536000
JFCPCIN1 EQU   JFCPCI                                                   02537000
JFCPCIA2 EQU   JFCPCI                                                   02538000
JFCPCIA1 EQU   JFCPCI                                                   02539000
JFCPCIX2 EQU   JFCPCI                                                   02540000
JFCPCIX1 EQU   JFCPCI                                                   02541000
JFCBUFMX EQU   JFCNCP                                                   02542000
JFCLRECL EQU   JFCAMSYN                                                 02543000
JFCBAXBF EQU   JFCBUFSI                                                 02544000
JFCREL   EQU   JFCREORG                                                 02545000
JFCRSV22 EQU   JFCDEL                                                   02546000
JFCSRCHD EQU   JFCRSV20                                                 02547000
JFCOPTQ  EQU   JFCACT                                                   02548000
JFCFEED  EQU   JFCIND                                                   02549000
JFCCBWU  EQU   JFCEXT                                                   02550000
JFCWUMSG EQU   JFCOVER                                                  02551000
JFCSDNAM EQU   JFCWVCBD                                                 02552000
@NM00020 EQU   JFCRECFM                                                 02553000
JFCCHAR  EQU   JFCRECFM                                                 02554000
JFCRFS   EQU   JFCRECFM                                                 02555000
JFCRFB   EQU   JFCRECFM                                                 02556000
JFCRFO   EQU   JFCRCFM                                                  02557000
JFCFMREC EQU   JFCRCFM                                                  02558000
JFCRSV16 EQU   JFCDSRG2                                                 02559000
JFCRSV15 EQU   JFCDSRG2                                                 02560000
JFCORGTR EQU   JFCDSRG2                                                 02561000
JFCRSV13 EQU   JFCDSRG2                                                 02562000
JFCORGTQ EQU   JFCDSRG2                                                 02563000
JFCORGTX EQU   JFCDSRG2                                                 02564000
JFCORGGS EQU   JFCDSRG2                                                 02565000
JFCORGU  EQU   JFCDSRG1                                                 02566000
JFCORGPO EQU   JFCDSRG1                                                 02567000
JFCORGMQ EQU   JFCDSRG1                                                 02568000
JFCORGCQ EQU   JFCDSRG1                                                 02569000
JFCORGCX EQU   JFCDSRG1                                                 02570000
JFCORGDA EQU   JFCDSRG1                                                 02571000
JFCORGPS EQU   JFCDSRG1                                                 02572000
JFCTRKBL EQU   JFCLIMCT+1                                               02573000
@NM00019 EQU   JFCLIMCT                                                 02574000
JFCPRTSP EQU   JFCSPPRT                                                 02575000
JFCONE   EQU   JFCMODE                                                  02576000
JFCTWO   EQU   JFCMODE                                                  02577000
JFCRSV07 EQU   JFCMODE                                                  02578000
JFCRSV06 EQU   JFCMODE                                                  02579000
JFCMODER EQU   JFCMODE                                                  02580000
JFCMODEO EQU   JFCMODE                                                  02581000
JFCEBCD  EQU   JFCMODE                                                  02582000
JFCBIN   EQU   JFCMODE                                                  02583000
JFCRSV32 EQU   JFCCODE                                                  02584000
JFCTTY   EQU   JFCCODE                                                  02585000
JFCASCII EQU   JFCCODE                                                  02586000
JFCNCR   EQU   JFCCODE                                                  02587000
JFCBUR   EQU   JFCCODE                                                  02588000
JFCFRI   EQU   JFCCODE                                                  02589000
JFCBCD   EQU   JFCCODE                                                  02590000
JFCNOCON EQU   JFCCODE                                                  02591000
GRPMASK  EQU   GMTENTRY                                                 02592000
GMTENTLN EQU   GMTHDR+4                                                 02593000
GMTENTNO EQU   GMTHDR                                                   02594000
EUCBTPOS EQU   EUCBENTY                                                 02595000
EUCBENLN EQU   EUCBHDR+4                                                02596000
EUCBENNO EQU   EUCBHDR                                                  02597000
GRPUCBNO EQU   GRPENTRY+4                                               02598000
GRPID    EQU   GRPENTRY                                                 02599000
GRPENTLN EQU   GRPHDR+4                                                 02600000
GRPENTNO EQU   GRPHDR                                                   02601000
GRPTR    EQU   GRPTRTAB                                                 02602000
GENGRPTR EQU   GENENTRY+8                                               02603000
GENGRPNO EQU   GENENTRY+4                                               02604000
GENENTNO EQU   GENHDR                                                   02605000
LUVAGMTP EQU   LUVENTRY+28                                              02606000
@NM00046 EQU   LUVFLAGS                                                 02607000
LUVMGENS EQU   LUVFLAGS                                                 02608000
LUVAGMSK EQU   LUVFLAGS                                                 02609000
LUVVAM   EQU   LUVFLAGS                                                 02610000
UNITNAME EQU   LUVENTRY                                                 02611000
@NM00045 EQU   CTGVLX                                                   02612000
CTGWAGB  EQU   CTGWA+12                                                 02613000
CTGWAGCT EQU   CTGWA+10                                                 02614000
CTGWALV  EQU   CTGWA+4                                                  02615000
CTGFIELD EQU   CTGPL+28                                                 02616000
CTGPSWD  EQU   CTGJSCB                                                  02617000
@NM00043 EQU   CTGFBFLG                                                 02618000
CTGNGDSN EQU   CTGFBFLG                                                 02619000
CTGGDGB  EQU   CTGFBFLG                                                 02620000
CTGKEEP  EQU   CTGFBFLG                                                 02621000
CTGPAR   EQU   CTGFBFLG                                                 02622000
CTGFDBK  EQU   CTGNEWNM                                                 02623000
CTGNOFLD EQU   CTGPL+19                                                 02624000
CTGTYPE  EQU   CTGPL+18                                                 02625000
@NM00042 EQU   CTGDSORG                                                 02626000
CTGOPTNS EQU   CTGDSORG                                                 02627000
CTGCVOL  EQU   CTGCAT                                                   02628000
CTGFVT   EQU   CTGENT                                                   02629000
@NM00041 EQU   CTGOPTN4                                                 02630000
CTGTIOT  EQU   CTGOPTN4                                                 02631000
CTGBYPMT EQU   CTGOPTN4                                                 02632000
CTGCOIN  EQU   CTGOPTN4                                                 02633000
@NM00040 EQU   CTGOPTN4                                                 02634000
CTGDOCAT EQU   CTGOPTN4                                                 02635000
CTGLBASE EQU   CTGOPTN4                                                 02636000
CTGAM0   EQU   CTGOPTN3                                                 02637000
CTGNUM   EQU   CTGOPTN3                                                 02638000
CTGSRH   EQU   CTGOPTN3                                                 02639000
CTGGDGL  EQU   CTGOPTN3                                                 02640000
CTGSUPLT EQU   CTGOPTN3                                                 02641000
CTGFUNC  EQU   CTGOPTN3                                                 02642000
@NM00039 EQU   CTGOPTN2                                                 02643000
CTGSCR   EQU   CTGOPTN2                                                 02644000
CTGOVRID EQU   CTGOPTN2                                                 02645000
CTGDISC  EQU   CTGOPTN2                                                 02646000
CTGGTNXT EQU   CTGOPTN2                                                 02647000
CTGRCATN EQU   CTGVMNT                                                  02648000
CTGGTALL EQU   CTGREL                                                   02649000
CTGNSVS  EQU   CTGEXT                                                   02650000
CTGGENLD EQU   CTGOPTN1                                                 02651000
CTGCNAME EQU   CTGOPTN1                                                 02652000
CTGNAME  EQU   CTGOPTN1                                                 02653000
CTGREAD  EQU   CTGOPTN1                                                 02654000
CTGUPD   EQU   CTGOPTN1                                                 02655000
CTGCI    EQU   CTGOPTN1                                                 02656000
CTGMAST  EQU   CTGOPTN1                                                 02657000
CTGBYPSS EQU   CTGOPTN1                                                 02658000
HWVLSBLN EQU   HWSELHDR                                                 02659000
@NM00038 EQU   HWCTBYT                                                  02660000
@NM00037 EQU   HWCTBYT                                                  02661000
@NM00036 EQU   HWOBYTE                                                  02662000
HWRVDEV  EQU   HWOBYTE                                                  02663000
@NM00035 EQU   HWOBYTE                                                  02664000
HWRSVCHR EQU   HWDATA+986                                               02665000
HWCONCAT EQU   HWDATA+984                                               02666000
HWCATSER EQU   HWDATA+978                                               02667000
@NM00034 EQU   HWDATA+958                                               02668000
HWCRI    EQU   HWDATA+220                                               02669000
HWDSNAME EQU   HWDATA+176                                               02670000
HWDSNLN  EQU   HWDATA+174                                               02671000
HWSTEPNO EQU   HWSTPNBR+1                                               02672000
@NM00033 EQU   HWSTPNBR                                                 02673000
HWGETLN  EQU   HWDATA+168                                               02674000
HWGETSPN EQU   HWDATA+164                                               02675000
HWRSVPTR EQU   HWDATA+84                                                02676000
HWDSENQP EQU   HWDATA+76                                                02677000
HWRPDIEP EQU   HWDATA+72                                                02678000
HWLPDIBP EQU   HWDATA+68                                                02679000
HWGDGBSP EQU   HWDATA+64                                                02680000
HWGETADD EQU   HWDATA+52                                                02681000
HWCJFCBP EQU   HWDATA+48                                                02682000
HWCSIOTP EQU   HWDATA+44                                                02683000
HWCRIP   EQU   HWDATA+36                                                02684000
HWGDGNTP EQU   HWDATA+28                                                02685000
HWPDIP   EQU   HWDATA+24                                                02686000
HWJSCBP  EQU   HWDATA+20                                                02687000
HWFSIOTP EQU   HWDATA+8                                                 02688000
HWSCTP   EQU   HWDATA+4                                                 02689000
HWJCTP   EQU   HWDATA                                                   02690000
@NM00032 EQU   HWCNTRL+14                                               02691000
@NM00031 EQU   HWCNTRL+9                                                02692000
@NM00030 EQU   HWJLCTLS+1                                               02693000
HWNOVOLU EQU   HWJLCTLS+1                                               02694000
HWDOMOD  EQU   HWJLCTLS+1                                               02695000
HWVSAME  EQU   HWJLCTLS                                                 02696000
HWLOCCAT EQU   HWJLCTLS                                                 02697000
HWGDGSLC EQU   HWJLCTLS                                                 02698000
HWLBASEL EQU   HWJLCTLS                                                 02699000
@NM00029 EQU   HWJLCTLS                                                 02700000
HWSYSLOC EQU   HWJLCTLS                                                 02701000
HWPDIEDL EQU   HWJLCTLS                                                 02702000
HWPDISCN EQU   HWJLCTLS                                                 02703000
@NM00028 EQU   HWTBLCTL                                                 02704000
HWCOPYAF EQU   HWTBLCTL                                                 02705000
HWTBCOPY EQU   HWTBLCTL                                                 02706000
@NM00027 EQU   HWCNTRL+4                                                02707000
@NM00026 EQU   HWMSSCTL+1                                               02708000
HWSELDON EQU   HWMSSCTL                                                 02709000
HWCATINT EQU   HWCNTRL+3                                                02710000
HWNEWVL  EQU   HWCNTRL+3                                                02711000
HWDDDONE EQU   HWCNTRL+3                                                02712000
HWGDGALL EQU   HWCNTRL+2                                                02713000
HWDSNRQD EQU   HWCNTRL+2                                                02714000
HWDSNREC EQU   HWCNTRL+2                                                02715000
@NM00025 EQU   HWCNTRL+1                                                02716000
HWNOVRID EQU   HWCNTRL+1                                                02717000
HWDSAUTH EQU   HWCNTRL+1                                                02718000
HWNODSI  EQU   HWCNTRL+1                                                02719000
HWEPAJCT EQU   HWCNTRL+1                                                02720000
HWCAJSCB EQU   HWCNTRL+1                                                02721000
HWDENQT  EQU   HWCNTRL+1                                                02722000
HWOFFDEV EQU   HWCNTRL+1                                                02723000
HWNOSCAT EQU   HWCNTRL                                                  02724000
HWWVOLS  EQU   HWCNTRL                                                  02725000
HWDNCCDD EQU   HWCNTRL                                                  02726000
HWUNLCCT EQU   HWCNTRL                                                  02727000
HWWAITOK EQU   HWCNTRL                                                  02728000
HWMNTCAT EQU   HWCNTRL                                                  02729000
HWNOULSP EQU   HWCNTRL                                                  02730000
HWDOPDI  EQU   HWCNTRL                                                  02731000
@NM00024 EQU   JFCBX+144                                                02732000
JFCBXNAM EQU   JFCBX+96                                                 02733000
@NM00023 EQU   JFCBX+94                                                 02734000
@NM00022 EQU   JFCBX+3                                                  02735000
JFCRSV05 EQU   JFCEROPT                                                 02736000
JFCRSV04 EQU   JFCEROPT                                                 02737000
JFCRSV03 EQU   JFCEROPT                                                 02738000
JFCRSV02 EQU   JFCEROPT                                                 02739000
JFCTOPT  EQU   JFCEROPT                                                 02740000
JFCABN   EQU   JFCEROPT                                                 02741000
JFCSKP   EQU   JFCEROPT                                                 02742000
JFCACC   EQU   JFCEROPT                                                 02743000
JFCBUFL  EQU   JFCAMPTR+2                                               02744000
JFCFWORD EQU   JFCBFTEK                                                 02745000
JFCDWORD EQU   JFCBFTEK                                                 02746000
JFCHIER1 EQU   JFCBFTEK                                                 02747000
JFCDYN   EQU   JFCBFTEK                                                 02748000
JFCEXC   EQU   JFCBFTEK                                                 02749000
JFCBBFTR EQU   JFCBBFTA                                                 02750000
JFCSIM   EQU   JFCBBFTA                                                 02751000
JFCHIER  EQU   JFCBFTEK                                                 02752000
JFCBFOUT EQU   JFCBUFNO                                                 02753000
JFCBUFIN EQU   JFCBUFNO                                                 02754000
JFCTEMP  EQU   JFCBIND2                                                 02755000
JFCREQ   EQU   JFCBIND2                                                 02756000
JFCENT   EQU   JFCBIND2                                                 02757000
JFCSHARE EQU   JFCBIND2                                                 02758000
JFCSECUR EQU   JFCBIND2                                                 02759000
JFCPDS   EQU   JFCBIND1                                                 02760000
JFCGDG   EQU   JFCBIND1                                                 02761000
JFCADDED EQU   JFCBIND1                                                 02762000
JFCLOC   EQU   JFCBIND1                                                 02763000
JFCRLSE  EQU   JFCBIND1                                                 02764000
JFCBXPDT EQU   INFMJFCB+83                                              02765000
JFCBCRDT EQU   INFMJFCB+80                                              02766000
JFCBOPS2 EQU   JFCBMASK+7                                               02767000
JFCRCTLG EQU   JFCBFLG2                                                 02768000
JFCBBUFF EQU   JFCBFLG2                                                 02769000
JFCTRACE EQU   JFCBFLG2                                                 02770000
JFCSDRPS EQU   JFCBFLG2                                                 02771000
JFCNRPS  EQU   JFCDEFER                                                 02772000
JFCOUTOP EQU   JFCBFLG2                                                 02773000
JFCINOP  EQU   JFCBFLG2                                                 02774000
JFCBPWBP EQU   JFCOPEN                                                  02775000
@NM00018 EQU   JFCOPEN                                                  02776000
JFCDUAL  EQU   JFCBFLG1                                                 02777000
JFCSLDES EQU   JFCBFLG1                                                 02778000
JFCSLCRE EQU   JFCBFLG1                                                 02779000
JFCSTAND EQU   JFCBFLG1                                                 02780000
JFCBOPS1 EQU   JFCBMASK                                                 02781000
JFCBVLSQ EQU   INFMJFCB+70                                              02782000
JFCRSV31 EQU   JFCFUNC                                                  02783000
JFCFNCBT EQU   JFCFUNC                                                  02784000
JFCFNCBX EQU   JFCFUNC                                                  02785000
JFCFNCBD EQU   JFCFUNC                                                  02786000
JFCFNCBW EQU   JFCFUNC                                                  02787000
JFCFNCBP EQU   JFCFUNC                                                  02788000
JFCFNCBR EQU   JFCFUNC                                                  02789000
JFCFNCBI EQU   JFCFUNC                                                  02790000
JFCBFOFL EQU   JFCBUFOF                                                 02791000
JFCNL    EQU   JFCBLTYP                                                 02792000
JFCNSL   EQU   JFCBLTYP                                                 02793000
JFCBLP   EQU   JFCBLTYP                                                 02794000
JFCBLTM  EQU   JFCBLTYP                                                 02795000
JFCBAL   EQU   JFCBLTYP                                                 02796000
JFCRSV38 EQU   JFCBLTYP                                                 02797000
JFCVINDX EQU   INFMJFCB+64                                              02798000
JFCNLREC EQU   INFMJFCB+62                                              02799000
JFCBADBF EQU   INFMJFCB+60                                              02800000
JFCAMSTR EQU   JFCBFRID+2                                               02801000
JFCAMCRO EQU   JFCBFRID                                                 02802000
JFCPAT   EQU   JFCBTSDM                                                 02803000
JFCNDCB  EQU   JFCBTSDM                                                 02804000
JFCNDSCB EQU   JFCBTSDM                                                 02805000
JFCNWRIT EQU   JFCBTSDM                                                 02806000
JFCTTR   EQU   JFCBTSDM                                                 02807000
JFCSDS   EQU   JFCBTSDM                                                 02808000
JFCVSL   EQU   JFCBTSDM                                                 02809000
JFCIPLTX EQU   JFCBELNM                                                 02810000
JFCBQNAM EQU   JFCBDSNM                                                 02811000
SIODDSNL EQU   INDMSIOT+173                                             02812000
SIOVDSNL EQU   INDMSIOT+172                                             02813000
SIOVDSNT EQU   INDMSIOT+170                                             02814000
SVOLUNNO EQU   INDMSIOT+168                                             02815000
SIOTVMVP EQU   INDMSIOT+164                                             02816000
SIOTNPTR EQU   INDMSIOT+152                                             02817000
SIOTETIO EQU   INDMSIOT+148                                             02818000
SIOTATE  EQU   INDMSIOT+144                                             02819000
SVOLUNAD EQU   INDMSIOT+140                                             02820000
SIOTEDLP EQU   INDMSIOT+136                                             02821000
SIOTEDLS EQU   INDMSIOT+132                                             02822000
SIOTRSNC EQU   INDMSIOT+130                                             02823000
SCTANAME EQU   INDMSIOT+122                                             02824000
SIOTSSIC EQU   INDMSIOT+120                                             02825000
@NM00017 EQU   INDMSIOT+108                                             02826000
SIOTSSNM EQU   INDMSIOT+104                                             02827000
@NM00016 EQU   SIOTBYT2                                                 02828000
SIOTCVOL EQU   SIOTBYT2                                                 02829000
SIOTCNEW EQU   SIOTBYT2                                                 02830000
SIOTCALC EQU   SIOTBYT2                                                 02831000
SIOTDSPD EQU   SIOTBYT2                                                 02832000
SIOTOPUC EQU   INDMSIOT+99                                              02833000
SIOTOUTR EQU   INDMSIOT+97                                              02834000
SIOTOUTC EQU   INDMSIOT+96                                              02835000
SIOTSSWA EQU   INDMSIOT+93                                              02836000
SIOTAUNC EQU   SIOTALTD                                                 02837000
SIOTACAT EQU   SIOTALTD                                                 02838000
SIOTADEL EQU   SIOTALTD                                                 02839000
SIOTAKEP EQU   SIOTALTD                                                 02840000
SIOTNPRV EQU   SIOTALTD                                                 02841000
SIOJCATS EQU   SIOTALTD                                                 02842000
@NM00015 EQU   SIOTALTD                                                 02843000
@NM00014 EQU   SIOTALTD                                                 02844000
@NM00013 EQU   INDMSIOT+91                                              02845000
SIOTNDSB EQU   INDMSIOT+88                                              02846000
@NM00012 EQU   INDMSIOT+84                                              02847000
SIOTDPCD EQU   INDMSIOT+82                                              02848000
@NM00011 EQU   SIOTBYT4                                                 02849000
SIOTRACT EQU   SIOTBYT4                                                 02850000
SIOTRACD EQU   SIOTBYT4                                                 02851000
SIOTPROT EQU   SIOTBYT4                                                 02852000
SCTOUTPN EQU   INDMSIOT+80                                              02853000
SCTOUTNO EQU   INDMSIOT+76                                              02854000
SCTOUTNM EQU   INDMSIOT+68                                              02855000
SIOUBYT4 EQU   SIOTDEVT+3                                               02856000
@NM00010 EQU   SIOUBYT3                                                 02857000
SIO3UREC EQU   SIOUBYT3                                                 02858000
SIO3DISP EQU   SIOUBYT3                                                 02859000
SIO3DACC EQU   SIOUBYT3                                                 02860000
SIO3COMM EQU   SIOUBYT3                                                 02861000
SIO3TAPE EQU   SIOUBYT3                                                 02862000
SIOUBYT2 EQU   SIOTDEVT+1                                               02863000
SIOUBYT1 EQU   SIOTDEVT                                                 02864000
SIOTOMN  EQU   SCTSBYT4                                                 02865000
SIOTIPDI EQU   SCTSBYT4                                                 02866000
SIOTSTEP EQU   SCTSBYT4                                                 02867000
SIOTASCI EQU   SCTSBYT4                                                 02868000
@NM00009 EQU   SCTSBYT4                                                 02869000
SIOTGDGA EQU   SCTSBYT4                                                 02870000
SCTSGDGS EQU   SCTSBYT4                                                 02871000
SCTSOLD  EQU   SCTSBYT3                                                 02872000
SCTSYSOU EQU   SCTSBYT3                                                 02873000
SCTALCHK EQU   SCTSBYT3                                                 02874000
SCTSYSNE EQU   SCTSBYT3                                                 02875000
SCTDSNRF EQU   SCTSBYT3                                                 02876000
SCTDEFER EQU   SCTSBYT2                                                 02877000
SCTLABEL EQU   SCTSBYT2                                                 02878000
SCTJOBLB EQU   SCTSBYT2                                                 02879000
SIOTCATL EQU   SCTSBYT2                                                 02880000
SIOCLUNL EQU   SCTSBYT2                                                 02881000
SIOTJSCT EQU   SCTSBYT1                                                 02882000
SIOTQDSN EQU   SCTSBYT1                                                 02883000
SIOTCCAT EQU   SCTSBYT1                                                 02884000
SCTSYSIN EQU   SCTSBYT1                                                 02885000
SIOTUNCT EQU   SCTSDISP                                                 02886000
SIOTCTLG EQU   SCTSDISP                                                 02887000
SIOTDLET EQU   SCTSDISP                                                 02888000
SIOTKEEP EQU   SCTSDISP                                                 02889000
SIOTPASS EQU   SCTSDISP                                                 02890000
SIOTRETN EQU   SCTSDISP                                                 02891000
SIOTVLCT EQU   INDMSIOT+54                                              02892000
SIOTRTRY EQU   SIOTBYT0                                                 02893000
SIOTPUPV EQU   SIOTBYT0                                                 02894000
SIOTNOPV EQU   SIOTBYT0                                                 02895000
SIOTGIGN EQU   SIOTBYT0                                                 02896000
SPVTAMSG EQU   SIOTBYT0                                                 02897000
SIOTFUDA EQU   SIOTBYT0                                                 02898000
SIOTDYAL EQU   SIOTBYT0                                                 02899000
SIOTGIID EQU   INDMSIOT+50                                              02900000
SCTSPOOL EQU   INDMSIOT+48                                              02901000
SIOTQNAM EQU   SIOTTSTC                                                 02902000
SIOTDSNM EQU   SIOTTSTC                                                 02903000
SIOTTRKM EQU   SIOTTSTC                                                 02904000
SIOTSSMG EQU   SIOTTSTC                                                 02905000
SIOTSSGP EQU   SIOTTSTC                                                 02906000
@NM00008 EQU   SIOTTSTC                                                 02907000
SIOTTERM EQU   SIOTTSTC                                                 02908000
SIOTINFC EQU   SIOTTSTC                                                 02909000
@NM00007 EQU   SIOTBYT3                                                 02910000
SIOTDSID EQU   SIOTBYT3                                                 02911000
S3400OFF EQU   SIOTBYT3                                                 02912000
SIOTJES3 EQU   SIOTBYT3                                                 02913000
SIOALIAS EQU   SIOTBYT3                                                 02914000
SIOTDDNT EQU   SIOTBYT1                                                 02915000
SIOTALCD EQU   SIOTBYT1                                                 02916000
SIODADSM EQU   SIOTBYT1                                                 02917000
SIOTDADR EQU   SIOTBYT1                                                 02918000
SIODUNAL EQU   SIOTBYT1                                                 02919000
SIOTHOLD EQU   SIOTBYT1                                                 02920000
SIOTOCKP EQU   SIOTBYT1                                                 02921000
SIOPSCNT EQU   INDMSIOT+42                                              02922000
SIOTOTUN EQU   INDMSIOT+39                                              02923000
SIOTVRSB EQU   INDMSIOT+36                                              02924000
@NM00006 EQU   INDMSIOT+35                                              02925000
@NM00005 EQU   INDMSIOT+31                                              02926000
SCTPSIOT EQU   INDMSIOT+28                                              02927000
SIOTAFID EQU   INDMSIOT+26                                              02928000
SIOTVLSP EQU   INDMSIOT+24                                              02929000
SIODSNTE EQU   INDMSIOT+22                                              02930000
SIOTDEST EQU   INDMSIOT+12                                              02931000
SCTDDNAM EQU   INDMSIOT+4                                               02932000
SIOTTYPE EQU   INDMSIOT+3                                               02933000
SIOTDSKA EQU   INDMSIOT                                                 02934000
@NM00003 EQU   @NM00002                                                 02935000
@NM00001 EQU   DEVWORD                                                  02936000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02937000
@RF00170 EQU   @RC00119                                                 02938000
@RF00176 EQU   @RC00119                                                 02939000
@RC00244 EQU   @RC00243                                                 02940000
@RF00251 EQU   @RC00241                                                 02941000
@RC00324 EQU   @RC00321                                                 02942000
@RF00323 EQU   @RC00321                                                 02943000
@RC00362 EQU   @RC00360                                                 02944000
@RC00462 EQU   @EL00001                                                 02945000
@RC00467 EQU   @EL00002                                                 02946000
@RF00510 EQU   @EL00003                                                 02947000
@RC00326 EQU   @RC00324                                                 02948000
@ENDDATA EQU   *                                                        02949000
         END   IEFAB464,(C'PLS1920',0701,78054)                         02950000
