         TITLE 'IEFAB485 - RECOVERY ALLOCATION                         *00001000
                        '                                               00002000
IEFAB485 CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(24)                                          01S0001 00007000
         DC    C'IEFAB485 78089  UZ17548 '                      01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  LA    @11,4095(,@12)                                   01S0001 00012000
         USING @PSTART,@12                                      01S0001 00013000
         USING @PSTART+4095,@11                                 01S0001 00014000
         L     @00,@SIZDATD                                     01S0001 00015000
         GSPACE   R,LV=(0)                                              00016000
         LR    @10,@01                                          01S0001 00017000
         USING @DATD,@10                                        01S0001 00018000
         ST    @13,@SA00001+4                                   01S0001 00019000
         LM    @00,@01,20(@13)                                  01S0001 00020000
         ST    @10,8(,@13)                                      01S0001 00021000
         LR    @13,@10                                          01S0001 00022000
         MVC   @PC00001(4),0(@01)                               01S0001 00023000
*WAITMASK(1:GMTENTLN)=WAITMASK(1:GMTENTLN)&&WAITMASK(1:GMTENTLN);       00024000
         L     @02,@PC00001                                     01S0069 00025000
         L     @02,ALCWAPTR(,@02)                               01S0069 00026000
         L     @01,WMASK2P(,@02)                                01S0069 00027000
         L     @15,EDTABPTR(,@02)                               01S0069 00028000
         L     @15,EDTMSKTP(,@15)                               01S0069 00029000
         L     @15,GMTENTLN(,@15)                               01S0069 00030000
         BCTR  @15,0                                            01S0069 00031000
         EX    @15,@SX01149                                     01S0069 00032000
*RTNCODE = SUCCESS;                    /*ZERO RETURN CODE            */ 00033000
         SLR   RTNCODE,RTNCODE                                  01S0070 00034000
*ALCWAREC = ON;                        /*INDICATE RECOVERY CODE      */ 00035000
         OI    ALCWAREC(@02),B'00100000'                        01S0071 00036000
*/***********************************************************@ZA03616*/ 00037000
*/*                                                          @ZA03616*/ 00038000
*/* SEGMENT NAME - TAPEVALI                                  @ZA03616*/ 00039000
*/*                                                          @ZA03616*/ 00040000
*/* DESCRIPTIVE NAME - ALLOCATE VALIDITY-ERROR TAPE REQUESTS @ZA03616*/ 00041000
*/*                                                          @ZA03616*/ 00042000
*/* FUNCTION -                                               @ZA03616*/ 00043000
*/*     THIS ROUTINE ALLOCATES TAPE REQUESTS WHICH COULD NOT @ZA03616*/ 00044000
*/*     BE ALLOCATED BY GENERIC ALLOCATION BECAUSE THE       @ZA03616*/ 00045000
*/*     VOLUMES WANTED WERE MOUNTED ON DIFFERENT GENERIC     @ZA03616*/ 00046000
*/*     DEVICE TYPES THAN THOSE PICKED FOR ALLOCATION.       @ZA03616*/ 00047000
*/*     THESE REQUESTS CAN BE ALLOCATED IN RECOVERY          @ZA03616*/ 00048000
*/*     ALLOCATION SINCE ALL NEEDED TAPE GENERICS ARE        @ZA03616*/ 00049000
*/*     LOCKED BY THIS TIME.                                 @ZA03616*/ 00050000
*/*                                                          @ZA03616*/ 00051000
*/* OPERATION -                                              @ZA03616*/ 00052000
*/*     ALL REQUESTS THAT ARE MARKED AS VALIDITY-ERROR AND   @ZA03616*/ 00053000
*/*     ARE ALLOCATED ARE NOW UNALLOCATED BY INVOKING        @ZA03616*/ 00054000
*/*     IEFAB477. NEXT, DEMAND REQUESTS, SPECIFIC REQUESTS,  @ZA03616*/ 00055000
*/*     AND PUBLIC REQUESTS ARE ALLOCATED USING IEFAB479,    @ZA03616*/ 00056000
*/*     IEFAB433 AND IEFAB436. IF ANY TAPE VALIDITY ERROR    @ZA03616*/ 00057000
*/*     REQUESTS REMAIN TO BE ALLOCATED AFTER THIS AND       @ZA03616*/ 00058000
*/*     VOLUME MOUNTING IS ALLOWED, THE ALGORITHM IS         @ZA03616*/ 00059000
*/*     INVOKED. IF REQUESTS REMAIN AND VOLUME MOUNTING      @ZA03616*/ 00060000
*/*     IS NOT ALLOWED, THE REQUEST IS FAILED.               @ZA03616*/ 00061000
*/*                                                          @ZA03616*/ 00062000
*/* ENTRY - (IN-LINE SUBROUTINE)                             @ZA03616*/ 00063000
*/*                                                          @ZA03616*/ 00064000
*/*  PURPOSE - SEE FUNCTION                                  @ZA03616*/ 00065000
*/*                                                          @ZA03616*/ 00066000
*/*  INPUT -                                                 @ZA03616*/ 00067000
*/*    ALCWA - ALLOCATION WORK AREA                          @ZA03616*/ 00068000
*/*      DSSTAPE - IF ON, INDICATES THERE ARE TAPE REQUESTS  @ZA03616*/ 00069000
*/*      VOLUNPTR - PTR TO THE VOLUNIT TABLE                 @ZA03616*/ 00070000
*/*      TOTREQS - NUMBER OF SIOTS STILL UNALLOCATED         @ZA03616*/ 00071000
*/*      VOLUNSZE - SIZE OF THE VOLUNIT TABLE                @ZA03616*/ 00072000
*/*      VOLMNTSW - VOLUME MOUNTING ALLOWED                  @ZA03616*/ 00073000
*/*    SIOT                                                  @ZA03616*/ 00074000
*/*      SIOTDMND - DEMAND REQUEST                           @ZA03616*/ 00075000
*/*    VOLUNIT TABLE -                                       @ZA03616*/ 00076000
*/*      VUDNALOC - VU ENTRY NEEDS RECOVERY                  @ZA03616*/ 00077000
*/*      VUVINELG - TAPE VALIDITY ERROR                      @ZA03616*/ 00078000
*/*      VOLALOC - THIS VU IS ALLOCATED                      @ZA03616*/ 00079000
*/*                                                          @ZA03616*/ 00080000
*/* EXIT - NORMAL - (IN-LINE SUBROUTINE)                     @ZA03616*/ 00081000
*/*                                                          @ZA03616*/ 00082000
*/*   CONDITION - ALL VALIDITY-ERROR TAPE REQS ALLOCATED     @ZA03616*/ 00083000
*/*                                                          @ZA03616*/ 00084000
*/*   OUTPUT -                                               @ZA03616*/ 00085000
*/*     VUDNALOC AND VUVINELG BITS TURNED OFF.               @ZA03616*/ 00086000
*/*     TOTREQS DECREMENTED                                  @ZA03616*/ 00087000
*/*     REQUESTS ALLOCATED                                   @ZA03616*/ 00088000
*/*                                                          @ZA03616*/ 00089000
*/*   RETURN CODES - RTNCODE SET TO 0                        @ZA03616*/ 00090000
*/*                                                          @ZA03616*/ 00091000
*/* EXIT - ERROR - (IN-LINE SUBROUTINE)                      @ZA03616*/ 00092000
*/*                                                          @ZA03616*/ 00093000
*/*   CONDITION - ERROR DETECTED BY ONE OF THE CALLED RTNS   @ZA03616*/ 00094000
*/*                                                          @ZA03616*/ 00095000
*/*   OUTPUT -                                               @ZA03616*/ 00096000
*/*     A STEP OR DD RELATED REASON CODE SET BY THE          @ZA03616*/ 00097000
*/*     ROUTINE DETECTING THE ERROR.                         @ZA03616*/ 00098000
*/*                                                          @ZA03616*/ 00099000
*/*   RETURN CODE - RTNCODE SET TO NON-ZERO                  @ZA03616*/ 00100000
*/*                                                          @ZA03616*/ 00101000
*/* EXIT - ERROR - (INLINE SUBROUTINE)                       @ZA03616*/ 00102000
*/*                                                          @ZA03616*/ 00103000
*/*   CONDITION - MOUNT NEEDED BUT VOLUME MOUNTING NOT       @ZA03616*/ 00104000
*/*               ALLOWED.                                   @ZA03616*/ 00105000
*/*                                                          @ZA03616*/ 00106000
*/*   OUTPUT -                                               @ZA03616*/ 00107000
*/*     SIOTRSNC - SET TO 56 (NOMOUNT)                       @ZA03616*/ 00108000
*/*   RETURN CODE - RTNCODE SET TO NON-ZERO                  @ZA03616*/ 00109000
*/*                                                          @ZA03616*/ 00110000
*/***********************************************************@ZA03616*/ 00111000
*IF DSSTAPE = ON THEN                  /*ANY TAPE REQUESTS   @ZA03616*/ 00112000
         TM    DSSTAPE(@02),B'00001000'                         02S0072 00113000
         BNO   @RF00072                                         02S0072 00114000
*  DO;                                 /*LOOK FOR VAL ERRORS @ZA03616*/ 00115000
*    NEEDTALC = OFF;                   /*INIT ALLOC NEEDED SW@ZA03616*/ 00116000
         NI    NEEDTALC,B'11011111'                             02S0074 00117000
*    CALLREAR = OFF;                   /*INIT REARRANGE NEED @ZA03616*/ 00118000
         NI    CALLREAR,B'01111111'                             02S0075 00119000
*    VUPTR = VOLUNPTR;                 /*SEARCH VOLUNITS     @ZA03616*/ 00120000
         L     @15,@PC00001                                     02S0076 00121000
         L     @15,ALCWAPTR(,@15)                               02S0076 00122000
         L     VUPTR,VOLUNPTR(,@15)                             02S0076 00123000
*    RFY INDMSIOT BASED(VOLSIOTP);     /*SIOT FROM VU        @ZA03616*/ 00124000
*    DO VUCTR = ONE TO VOLUNSZE/LENGTH(VOLUNTAB); /*SCAN VUS @ZA03616*/ 00125000
         LA    VUCTR,1                                          02S0078 00126000
         B     @DE00078                                         02S0078 00127000
@DL00078 DS    0H                                               02S0079 00128000
*      IF VUDNALOC = ON & VUVINELG = ON THEN /*VAL FAILURE   @ZA03616*/ 00129000
         TM    VUDNALOC(VUPTR),B'00001010'                      02S0079 00130000
         BNO   @RF00079                                         02S0079 00131000
*        DO;                           /*SET UP TO RE-ALLOC  @ZA03616*/ 00132000
*          NEEDTALC = ON;              /*ALLOC NEEDED        @ZA03616*/ 00133000
         OI    NEEDTALC,B'00100000'                             02S0081 00134000
*          IF VOLALOC = ON THEN        /*VU WAS ALLOCD       @ZA03616*/ 00135000
         TM    VOLALOC(VUPTR),B'10000000'                       02S0082 00136000
         BNO   @RF00082                                         02S0082 00137000
*            DO;                       /*SET UP TO UNALLOC   @ZA03616*/ 00138000
*              CALLREAR = ON;          /*REARRANGE NEEDED    @ZA03616*/ 00139000
         OI    CALLREAR,B'10000000'                             02S0084 00140000
*              VUREALOC = ON;          /*UNALLOC THIS VU     @ZA03616*/ 00141000
         OI    VUREALOC(VUPTR),B'01000000'                      02S0085 00142000
*            END;                      /*END SET UP UNALLOC  @ZA03616*/ 00143000
*        END;                          /*END SET UP REALLOC  @ZA03616*/ 00144000
@RF00082 DS    0H                                               02S0088 00145000
*      VUPTR = VUPTR + LENGTH(VOLUNTAB); /*NEXT VU ENTRY     @ZA03616*/ 00146000
@RF00079 AH    VUPTR,@CH01135                                   02S0088 00147000
*    END;                              /*END SCAN VUS        @ZA03616*/ 00148000
         AH    VUCTR,@CH00055                                   02S0089 00149000
@DE00078 L     @07,@PC00001                                     02S0089 00150000
         L     @07,ALCWAPTR(,@07)                               02S0089 00151000
         L     @00,VOLUNSZE(,@07)                               02S0089 00152000
         SRDA  @00,32                                           02S0089 00153000
         D     @00,@CF01135                                     02S0089 00154000
         CR    VUCTR,@01                                        02S0089 00155000
         BNH   @DL00078                                         02S0089 00156000
*    IF CALLREAR = ON THEN             /*NEED TO UNALLOC     @ZA03616*/ 00157000
         TM    CALLREAR,B'10000000'                             02S0090 00158000
         BNO   @RF00090                                         02S0090 00159000
*      DO;                             /*UNALLOCATE REQS     @ZA03616*/ 00160000
*        FUNC477 = FUNC477 && FUNC477; /*CLEAR FUNC MAP      @ZA03616*/ 00161000
         XC    FUNC477(1),FUNC477                               02S0092 00162000
*        DONTUNLD = ON;                /*DONT UNLOAD VOLS    @ZA03616*/ 00163000
         OI    DONTUNLD,B'01000000'                             02S0093 00164000
*        CALL IEFAB477(ALCWAPTR,FUNC477); /*UNALLOCATE       @ZA03616*/ 00165000
         L     @02,@PC00001                                     02S0094 00166000
         ST    @02,@AL00001                                     02S0094 00167000
         LA    @02,FUNC477                                      02S0094 00168000
         ST    @02,@AL00001+4                                   02S0094 00169000
         L     @15,@CV00171                                     02S0094 00170000
         LA    @01,@AL00001                                     02S0094 00171000
         BALR  @14,@15                                          02S0094 00172000
*        RTNCODE = REG15;              /*SAVE RETURN CODE    @ZA03616*/ 00173000
         LR    RTNCODE,REG15                                    02S0095 00174000
*      END;                            /*END UNALLOCATE      @ZA03616*/ 00175000
*    IF NEEDTALC = ON & RTNCODE = ZERO THEN /*ALLOC NEEDED   @ZA03616*/ 00176000
@RF00090 TM    NEEDTALC,B'00100000'                             02S0097 00177000
         BNO   @RF00097                                         02S0097 00178000
         LTR   RTNCODE,RTNCODE                                  02S0097 00179000
         BNZ   @RF00097                                         02S0097 00180000
*      DO;                             /*ALLOCATE REQUESTS   @ZA03616*/ 00181000
*        DO;                           /*ALLOC TO MNTD VOLS  @ZA03616*/ 00182000
*/***********************************************************@ZA03616*/ 00183000
*/*                                                          @ZA03616*/ 00184000
*/* SEGMENT NAME - ALOCMTDS                                  @ZA03616*/ 00185000
*/*                                                          @ZA03616*/ 00186000
*/* DESCRIPTIVE NAME - ALLOCATE TAPE VALIDITY-ERROR REQUESTS @ZA03616*/ 00187000
*/*                    TO MOUNTED VOLUMES                    @ZA03616*/ 00188000
*/*                                                          @ZA03616*/ 00189000
*/* FUNCTION -                                               @ZA03616*/ 00190000
*/*   THIS ROUTINE ATTEMPTS TO ALLOCATE TAPE VALIDITY        @ZA03616*/ 00191000
*/*   ERROR REQUESTS TO MOUNTED VOLUMES USING IEFAB479       @ZA03616*/ 00192000
*/*   (DEMAND ALLOCATION), IEFAB433 (SPECIFIC VOLUME         @ZA03616*/ 00193000
*/*   ALLOCATION), AND IEFAB436 (PUBLIC/STORAGE ALLOCATION). @ZA03616*/ 00194000
*/*                                                          @ZA03616*/ 00195000
*/* OPERATION - DOCUMENTED BY THE CODE                       @ZA03616*/ 00196000
*/*                                                          @ZA03616*/ 00197000
*/* ENTRY - (INLINE SUBROUTINE)                              @ZA03616*/ 00198000
*/*                                                          @ZA03616*/ 00199000
*/*   PURPOSE - SEE FUNCTION                                 @ZA03616*/ 00200000
*/*                                                          @ZA03616*/ 00201000
*/*   INPUT -                                                @ZA03616*/ 00202000
*/*     ALCWA - ALLOCATION WORK AREA                         @ZA03616*/ 00203000
*/*       VOLUNPTR - POINTER TO THE VOLUNIT TABLE            @ZA03616*/ 00204000
*/*     VOLUNIT TABLE -                                      @ZA03616*/ 00205000
*/*       VUDNALOC - RECOVERY NEEDED FOR THIS ENTRY          @ZA03616*/ 00206000
*/*       VUVINELG - TAPE VALIDITY ERROR                     @ZA03616*/ 00207000
*/*       VOLPUB - PUBLIC REQUEST                            @ZA03616*/ 00208000
*/*       VOLPRV - PRIVATE REQUEST                           @ZA03616*/ 00209000
*/*     SIOT -                                               @ZA03616*/ 00210000
*/*       SIOTDMND - DEMAND REQUEST                          @ZA03616*/ 00211000
*/*                                                          @ZA03616*/ 00212000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                      @ZA03616*/ 00213000
*/*                                                          @ZA03616*/ 00214000
*/*   CONDITION - DEMAND REQUESTS AND REQUESTS ELIGIBLE      @ZA03616*/ 00215000
*/*               TO MOUNTED VOLUMES ALLOCATED               @ZA03616*/ 00216000
*/*                                                          @ZA03616*/ 00217000
*/*   OUTPUT -                                               @ZA03616*/ 00218000
*/*     VUDNALOC AND VUVINELG BITS TURNED OFF                @ZA03616*/ 00219000
*/*     TOTREQS DECREMENTED                                  @ZA03616*/ 00220000
*/*     REQUESTS ALLOCATED                                   @ZA03616*/ 00221000
*/*                                                          @ZA03616*/ 00222000
*/*   RETURN CODE - RTNCODE SET TO 0                         @ZA03616*/ 00223000
*/*                                                          @ZA03616*/ 00224000
*/* EXIT - ERROR - (INLINE SUBROUTINE)                       @ZA03616*/ 00225000
*/*                                                          @ZA03616*/ 00226000
*/*   CONDITION - ERROR DETECTED BY ONE OF THE CALLED RTNS   @ZA03616*/ 00227000
*/*                                                          @ZA03616*/ 00228000
*/*   OUTPUT -                                               @ZA03616*/ 00229000
*/*     A STEP OR DD RELATED REASON CODE SET BY THE          @ZA03616*/ 00230000
*/*     ROUTINE DETECTING THE ERROR                          @ZA03616*/ 00231000
*/*                                                          @ZA03616*/ 00232000
*/*   RETURN CODE - RTNCODE SET TO NON-ZERO                  @ZA03616*/ 00233000
*/*                                                          @ZA03616*/ 00234000
*/***********************************************************@ZA03616*/ 00235000
*NEEDMND = OFF;                        /*DEMAND NEEDED SW    @ZA03616*/ 00236000
         NI    NEEDMND,B'11101111'                              03S0100 00237000
*VUPTR = VOLUNPTR;                     /*FIRST VU ENTRY      @ZA03616*/ 00238000
         L     @15,@PC00001                                     03S0101 00239000
         L     @01,ALCWAPTR(,@15)                               03S0101 00240000
         L     VUPTR,VOLUNPTR(,@01)                             03S0101 00241000
*DO VUCTR = ONE TO VOLUNSZE/LENGTH(VOLUNTAB); /*SCAN VUS     @ZA03616*/ 00242000
         LA    VUCTR,1                                          03S0102 00243000
         B     @DE00102                                         03S0102 00244000
@DL00102 DS    0H                                               03S0103 00245000
*  IF VUPTR = SVOLUNAD THEN            /*FIRST VU FOR SIOT   @ZA03616*/ 00246000
         L     @07,VOLSIOTP(,VUPTR)                             03S0103 00247000
         C     VUPTR,SVOLUNAD(,@07)                             03S0103 00248000
         BNE   @RF00103                                         03S0103 00249000
*    SIOTGIGN = ON;                    /*MAKE SIOT IGNORE    @ZA03616*/ 00250000
         OI    SIOTGIGN(@07),B'00001000'                        03S0104 00251000
*  IF VUDNALOC = ON & VUVINELG = ON &  /*VAL CHECK FAILURE   @ZA03616*/ 00252000
*     SIOTDMND = ON THEN               /*DEMAND REQUEST      @ZA03616*/ 00253000
@RF00103 TM    VUDNALOC(VUPTR),B'00001010'                      03S0105 00254000
         BNO   @RF00105                                         03S0105 00255000
         L     @07,VOLSIOTP(,VUPTR)                             03S0105 00256000
         TM    SIOTDMND(@07),B'10000000'                        03S0105 00257000
         BNO   @RF00105                                         03S0105 00258000
*    DO;                               /*MARK SIOT & VU ENTRY@ZA03616*/ 00259000
*      SIOTGIGN = OFF;                 /*PROCESS THIS SIOT   @ZA03616*/ 00260000
         NI    SIOTGIGN(@07),B'11110111'                        03S0107 00261000
*      NEEDMND = ON;                   /*479 NEEDED          @ZA03616*/ 00262000
         OI    NEEDMND,B'00010000'                              03S0108 00263000
*      VUDNALOC = OFF;                 /*PROCESS THIS VU     @ZA03616*/ 00264000
*      VUVINELG = OFF;                 /*RESET VAL CHK SW    @ZA03616*/ 00265000
         NI    VUDNALOC(VUPTR),B'11110101'                      03S0110 00266000
*    END;                              /*END MARK SIOT       @ZA03616*/ 00267000
*  VUPTR = VUPTR + LENGTH(VOLUNTAB);   /*NEXT VU ENTRY       @ZA03616*/ 00268000
@RF00105 AL    VUPTR,@CF01135                                   03S0112 00269000
*END;                                  /*END SCAN VUS        @ZA03616*/ 00270000
         AH    VUCTR,@CH00055                                   03S0113 00271000
@DE00102 L     @07,@PC00001                                     03S0113 00272000
         L     @07,ALCWAPTR(,@07)                               03S0113 00273000
         L     @00,VOLUNSZE(,@07)                               03S0113 00274000
         SRDA  @00,32                                           03S0113 00275000
         D     @00,@CF01135                                     03S0113 00276000
         CR    VUCTR,@01                                        03S0113 00277000
         BNH   @DL00102                                         03S0113 00278000
*IF NEEDMND = ON THEN                  /*479 SHOULD BE CALLED@ZA03616*/ 00279000
         TM    NEEDMND,B'00010000'                              03S0114 00280000
         BNO   @RF00114                                         03S0114 00281000
*  DO;                                 /*ALLOC DEMANDS       @ZA03616*/ 00282000
*    FUNC479 = FUNC479 && FUNC479;     /*CLEAR FUNC MAP      @ZA03616*/ 00283000
         XC    FUNC479(1),FUNC479                               03S0116 00284000
*    DOSPEC = ON;                      /*ALLOC SPECIFICS     @ZA03616*/ 00285000
*    VOLSWOK = ON;                     /*VOL SWITCHING OK    @ZA03616*/ 00286000
         OI    DOSPEC,B'01100000'                               03S0118 00287000
*    CALL IEFAB479(ALCWAPTR,FUNC479);  /*ALLOCATE DEMANDS    @ZA03616*/ 00288000
         L     @02,@PC00001                                     03S0119 00289000
         ST    @02,@AL00001                                     03S0119 00290000
         LA    @02,FUNC479                                      03S0119 00291000
         ST    @02,@AL00001+4                                   03S0119 00292000
         L     @15,@CV00169                                     03S0119 00293000
         LA    @01,@AL00001                                     03S0119 00294000
         BALR  @14,@15                                          03S0119 00295000
*    RTNCODE = REG15;                  /*RETURN CODE FROM 479@ZA03616*/ 00296000
         LR    RTNCODE,REG15                                    03S0120 00297000
*  END;                                /*END ALLOC DEMANDS   @ZA03616*/ 00298000
*IF RTNCODE = ZERO & TOTREQS > ZERO THEN /*CHECK FOR MORE    @ZA03616*/ 00299000
@RF00114 SLR   @02,@02                                          03S0122 00300000
         CR    RTNCODE,@02                                      03S0122 00301000
         BNE   @RF00122                                         03S0122 00302000
         L     @15,@PC00001                                     03S0122 00303000
         L     @15,ALCWAPTR(,@15)                               03S0122 00304000
         C     @02,TOTREQS(,@15)                                03S0122 00305000
         BNL   @RF00122                                         03S0122 00306000
*  DO;                                 /*SEARCH VU TABLE     @ZA03616*/ 00307000
*    NEED433 = OFF;                    /*INIT 433 NEEDED     @ZA03616*/ 00308000
*    NEED436 = OFF;                    /*INIT 436 NEEDED     @ZA03616*/ 00309000
         NI    NEED433,B'11001111'                              03S0125 00310000
*    VUPTR = VOLUNPTR;                 /*FIRST VU ENTRY      @ZA03616*/ 00311000
         L     VUPTR,VOLUNPTR(,@15)                             03S0126 00312000
*    DO VUCTR = ONE TO VOLUNSZE/LENGTH(VOLUNTAB);/*SCAN VUS  @ZA03616*/ 00313000
         LA    VUCTR,1                                          03S0127 00314000
         B     @DE00127                                         03S0127 00315000
@DL00127 DS    0H                                               03S0128 00316000
*      IF VUDNALOC = ON & VUVINELG = ON THEN /*VAL FAIL VU   @ZA03616*/ 00317000
         TM    VUDNALOC(VUPTR),B'00001010'                      03S0128 00318000
         BNO   @RF00128                                         03S0128 00319000
*        DO;                           /*SET UP TO ALLOCATE  @ZA03616*/ 00320000
*          NEED433 = ON;               /*CALL 433 FOR SPECS  @ZA03616*/ 00321000
         OI    NEED433,B'00100000'                              03S0130 00322000
*          IF VOLPUB = ON & VOLPRV = OFF THEN /*PUBLIC REQ   @ZA03616*/ 00323000
         TM    VOLPUB(VUPTR),B'10000000'                        03S0131 00324000
         BNO   @RF00131                                         03S0131 00325000
         TM    VOLPRV(VUPTR),B'01000000'                        03S0131 00326000
         BNZ   @RF00131                                         03S0131 00327000
*            NEED436 = ON;             /*TRY ALLOC TO MNTD   @ZA03616*/ 00328000
         OI    NEED436,B'00010000'                              03S0132 00329000
*          VUDNALOC = OFF;             /*THIS VU OK TO ALLOC @ZA03616*/ 00330000
@RF00131 DS    0H                                               03S0134 00331000
*          VUVINELG = OFF;             /*RESET VAL CHK SW    @ZA03616*/ 00332000
         NI    VUDNALOC(VUPTR),B'11110101'                      03S0134 00333000
*          SIOTGIGN = OFF;             /*PROCESS THIS SIOT   @ZA03616*/ 00334000
         L     @07,VOLSIOTP(,VUPTR)                             03S0135 00335000
         NI    SIOTGIGN(@07),B'11110111'                        03S0135 00336000
*        END;                          /*END SET UP TO ALLOC @ZA03616*/ 00337000
*      VUPTR = VUPTR + LENGTH(VOLUNTAB);/*NEXT VU ENTRY      @ZA03616*/ 00338000
@RF00128 AL    VUPTR,@CF01135                                   03S0137 00339000
*    END;                              /*END SCAN VUS        @ZA03616*/ 00340000
         AH    VUCTR,@CH00055                                   03S0138 00341000
@DE00127 L     @07,@PC00001                                     03S0138 00342000
         L     @07,ALCWAPTR(,@07)                               03S0138 00343000
         L     @00,VOLUNSZE(,@07)                               03S0138 00344000
         SRDA  @00,32                                           03S0138 00345000
         D     @00,@CF01135                                     03S0138 00346000
         CR    VUCTR,@01                                        03S0138 00347000
         BNH   @DL00127                                         03S0138 00348000
*    IF NEED433 = ON THEN              /*433 NEEDED          @ZA03616*/ 00349000
         TM    NEED433,B'00100000'                              03S0139 00350000
         BNO   @RF00139                                         03S0139 00351000
*      DO;                             /*SET UP FOR 433      @ZA03616*/ 00352000
*        FUNCMAP1 = FUNC433;           /*FUNC MAP FOR 433    @ZA03616*/ 00353000
         MVC   FUNCMAP1(1),FUNC433                              03S0141 00354000
*        CALL IEFAB433(ALCWAPTR,ADDR(FUNCLIST));/*ALLOC SPECIFICS TO    00355000
*                                        MOUNTED VOLS        @ZA03616*/ 00356000
         L     @02,@PC00001                                     03S0142 00357000
         ST    @02,@AL00001                                     03S0142 00358000
         LA    @02,FUNCLIST                                     03S0142 00359000
         ST    @02,@TF00001                                     03S0142 00360000
         LA    @02,@TF00001                                     03S0142 00361000
         ST    @02,@AL00001+4                                   03S0142 00362000
         L     @15,@CV00166                                     03S0142 00363000
         LA    @01,@AL00001                                     03S0142 00364000
         BALR  @14,@15                                          03S0142 00365000
*        RTNCODE = REG15;              /*RETURN CODE FROM 433@ZA03616*/ 00366000
         LR    RTNCODE,REG15                                    03S0143 00367000
*      END;                            /*END SET UP FOR 433  @ZA03616*/ 00368000
*    IF NEED436 = ON & TOTREQS > ZERO &/*PUBLIC REQS TO DO   @ZA03616*/ 00369000
*       RTNCODE = ZERO THEN            /*433 DID NOT FAIL    @ZA03616*/ 00370000
@RF00139 TM    NEED436,B'00010000'                              03S0145 00371000
         BNO   @RF00145                                         03S0145 00372000
         SLR   @02,@02                                          03S0145 00373000
         L     @15,@PC00001                                     03S0145 00374000
         L     @01,ALCWAPTR(,@15)                               03S0145 00375000
         C     @02,TOTREQS(,@01)                                03S0145 00376000
         BNL   @RF00145                                         03S0145 00377000
         CR    RTNCODE,@02                                      03S0145 00378000
         BNE   @RF00145                                         03S0145 00379000
*      DO;                             /*ALLOC PUB TO MTDS   @ZA03616*/ 00380000
*        DOPRTAL = OFF;                /*ALLOC ALL PUBS      @ZA03616*/ 00381000
         NI    DOPRTAL,B'11110111'                              03S0147 00382000
*        CALL SCRATMNT;                /*ALLOCATE            @ZA03616*/ 00383000
         BAL   @14,SCRATMNT                                     03S0148 00384000
*      END;                            /*END ALLOC PUB       @ZA03616*/ 00385000
*  END;                                /*END SEARCH VU TABLE @ZA03616*/ 00386000
@RF00145 DS    0H                                               03S0151 00387000
*        END;                          /*END ALLOC TO MTDS   @ZA03616*/ 00388000
@RF00122 DS    0H                                               02S0152 00389000
*        IF RTNCODE = SUCCESS &        /*OK SO FAR           @ZA03616*/ 00390000
*           TOTREQS > ZERO THEN        /*MORE REQS TO DO     @ZA03616*/ 00391000
         SLR   @02,@02                                          02S0152 00392000
         CR    RTNCODE,@02                                      02S0152 00393000
         BNE   @RF00152                                         02S0152 00394000
         L     @15,@PC00001                                     02S0152 00395000
         L     @15,ALCWAPTR(,@15)                               02S0152 00396000
         C     @02,TOTREQS(,@15)                                02S0152 00397000
         BNL   @RF00152                                         02S0152 00398000
*          DO;                         /*CHECK FOR MORE TAPES@ZA03616*/ 00399000
*            VUPTR = VOLUNPTR;         /*FIRST VU ENTRY      @ZA03616*/ 00400000
         L     VUPTR,VOLUNPTR(,@15)                             02S0154 00401000
*            DONESW = OFF;             /*LOOP CTL SWITCH     @ZA03616*/ 00402000
         NI    DONESW,B'10111111'                               02S0155 00403000
*            DO VUCTR = ONE TO VOLUNSZE/LENGTH(VOLUNTAB)   /*@ZA03616*/ 00404000
*               WHILE DONESW = OFF;    /*LOOP THRU VUS       @ZA03616*/ 00405000
         LA    VUCTR,1                                          02S0156 00406000
         B     @DE00156                                         02S0156 00407000
@DL00156 TM    DONESW,B'01000000'                               02S0156 00408000
         BNZ   @DC00156                                         02S0156 00409000
*              IF SIOTGIGN = OFF &     /*SIOT WAS LOOKED AT  @ZA03616*/ 00410000
*                 VOLALOC = OFF THEN   /*VU NOT ALLOCATED    @ZA03616*/ 00411000
         L     @07,VOLSIOTP(,VUPTR)                             02S0157 00412000
         TM    SIOTGIGN(@07),B'00001000'                        02S0157 00413000
         BNZ   @RF00157                                         02S0157 00414000
         TM    VOLALOC(VUPTR),B'10000000'                       02S0157 00415000
         BNZ   @RF00157                                         02S0157 00416000
*                IF VOLMNTSW = ON THEN /*MNTING OK           @ZA03616*/ 00417000
         L     @07,@PC00001                                     02S0158 00418000
         L     @03,ALCWAPTR(,@07)                               02S0158 00419000
         L     @03,FMAPPTR(,@03)                                02S0158 00420000
         TM    VOLMNTSW(@03),B'10000000'                        02S0158 00421000
         BNO   @RF00158                                         02S0158 00422000
*                  DO;                 /*ALLOC VIA ALG       @ZA03616*/ 00423000
*                    DONESW = ON;      /*GET OUT OF LOOP     @ZA03616*/ 00424000
         OI    DONESW,B'01000000'                               02S0160 00425000
*                    FUNC476 = TAPE476; /*FUNC MAP FOR 476   @ZA03616*/ 00426000
         MVC   FUNC476(1),TAPE476                               02S0161 00427000
*                    CALL IEFAB476(ALCWAPTR,FUNC476); /*ALG  @ZA03616*/ 00428000
         ST    @07,@AL00001                                     02S0162 00429000
         LA    @07,FUNC476                                      02S0162 00430000
         ST    @07,@AL00001+4                                   02S0162 00431000
         L     @15,@CV00168                                     02S0162 00432000
         LA    @01,@AL00001                                     02S0162 00433000
         BALR  @14,@15                                          02S0162 00434000
*                    RTNCODE = REG15;  /*RETURN CODE FROM 476@ZA03616*/ 00435000
         LR    RTNCODE,REG15                                    02S0163 00436000
*                  END;                /*END ALLOC VIA ALG   @ZA03616*/ 00437000
*                ELSE                  /*MOUNTING NOT ALLOWED@ZA03616*/ 00438000
*                  DO;                 /*FAIL THE REQUEST    @ZA03616*/ 00439000
         B     @RC00158                                         02S0165 00440000
@RF00158 DS    0H                                               02S0166 00441000
*                    DONESW = ON;      /*GET OUT OF LOOP     @ZA03616*/ 00442000
         OI    DONESW,B'01000000'                               02S0166 00443000
*                    SIOTRSNC = NOMOUNT;/*MOUNTING NOT ALLOWD@ZA03616*/ 00444000
         L     @07,VOLSIOTP(,VUPTR)                             02S0167 00445000
         MVC   SIOTRSNC(2,@07),@CH00138                         02S0167 00446000
*                    RTNCODE = FAILURE;/*BAD RETURN CODE     @ZA03616*/ 00447000
         LA    RTNCODE,4                                        02S0168 00448000
*                  END;                /*END FAIL THE REQUEST@ZA03616*/ 00449000
*              VUPTR = VUPTR + LENGTH(VOLUNTAB);/*NEXT VU    @ZA03616*/ 00450000
@RC00158 DS    0H                                               02S0170 00451000
@RF00157 AL    VUPTR,@CF01135                                   02S0170 00452000
*            END;                      /*END LOOP THRU VUS   @ZA03616*/ 00453000
         AH    VUCTR,@CH00055                                   02S0171 00454000
@DE00156 L     @07,@PC00001                                     02S0171 00455000
         L     @07,ALCWAPTR(,@07)                               02S0171 00456000
         L     @00,VOLUNSZE(,@07)                               02S0171 00457000
         SRDA  @00,32                                           02S0171 00458000
         D     @00,@CF01135                                     02S0171 00459000
         CR    VUCTR,@01                                        02S0171 00460000
         BNH   @DL00156                                         02S0171 00461000
@DC00156 DS    0H                                               02S0172 00462000
*          END;                        /*END CHECK FOR MORE  @ZA03616*/ 00463000
*      END;                            /*END ALLOC REQUESTS  @ZA03616*/ 00464000
@RF00152 DS    0H                                               02S0174 00465000
*  END;                                /*END LOOK FOR ERRORS @ZA03616*/ 00466000
@RF00097 DS    0H                                               02S0175 00467000
*RFY INDMSIOT BASED(SIOTPTR);          /*                    @ZA03616*/ 00468000
@RF00072 DS    0H                                               02S0176 00469000
*IF TOTREQS>ZERO & RTNCODE=SUCCESS THEN /*STILL REQS TO ALLOCATE ?   */ 00470000
         SLR   @02,@02                                          01S0176 00471000
         L     @15,@PC00001                                     01S0176 00472000
         L     @01,ALCWAPTR(,@15)                               01S0176 00473000
         C     @02,TOTREQS(,@01)                                01S0176 00474000
         BNL   @RF00176                                         01S0176 00475000
         CR    RTNCODE,@02                                      01S0176 00476000
         BNE   @RF00176                                         01S0176 00477000
*  DO;                                 /*YES, ..                     */ 00478000
*/********************************************************************/ 00479000
*/*                                                                  */ 00480000
*/* SEGMENT NAME - DADAFFER                                          */ 00481000
*/*                                                                  */ 00482000
*/* DESCRIPTIVE NAME - ALLOCATE VOLAFF DADSM-ERROR REQUESTS          */ 00483000
*/*                                                                  */ 00484000
*/* FUNCTION -                                                       */ 00485000
*/*     THIS ROUTINE UNALLOCATES (VIA IEFAB477) ANY ALLOCATED        */ 00486000
*/*     NONSPECIFIC DA VOLUME REQUESTS WHICH HAVE VOLUME AFFINITY    */ 00487000
*/*     TO ANOTHER REQUEST WHICH HAD A DADSM ERROR.                  */ 00488000
*/*     NEXT, IEFAB436 IS CALLED TO TRY TO REALLOCATE ANY REQUESTS,  */ 00489000
*/*     JUST UNALLOCATED,TO DIFFERENT MOUNTED VOLUMES (SEE SEGMENT   */ 00490000
*/*     'DAFERALC').                                                 */ 00491000
*/*                                                                  */ 00492000
*/*   OPERATION -                                                    */ 00493000
*/*       SINCE THE SAME TYPE OF VOLAFF DADSM-ERROR SITUATION COULD  */ 00494000
*/*       ARISE IN TRYING TO REALLOCATE REQUESTS VIA IEFAB436, THIS  */ 00495000
*/*       ROUTINE LOOPS UNTIL ON ONE SCAN OF ALL REQUESTS NO VOLAFF  */ 00496000
*/*       ROUTINE WILL ONLY MAKE ONE ATTEMPT TO REALLOCATE   @ZA04836*/ 00497000
*/*       VIA IEFAB436.                                      @ZA04836*/ 00498000
*/*                                                                  */ 00499000
*/* ENTRY - (INLINE SUBROUTINE)                                      */ 00500000
*/*                                                                  */ 00501000
*/*   PURPOSE - (SEE FUNCTION)                                       */ 00502000
*/*                                                                  */ 00503000
*/*   INPUT -                                                        */ 00504000
*/*      ALCWAPTR - PTR TO ALLOCATION WORK AREA, WHICH CONTAINS      */ 00505000
*/*        VOLUNPTR - PTR TO VOLUNIT TABLE                           */ 00506000
*/*      RTNCODE = 0                                                 */ 00507000
*/*      VOLUNIT ENTRY BIT 'VUDADSME' INDICATES VOLAFF DADSM-ERROR   */ 00508000
*/*                                                                  */ 00509000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 00510000
*/*                                                                  */ 00511000
*/*   CONDITIONS - ALL VOLAFF DADSM-ERROR REQS UNALLOCATED           */ 00512000
*/*                SUCCESSFULLY AND POSSIBLY REALLOCATED TO OTHER    */ 00513000
*/*                MOUNTED VOLUMES                                   */ 00514000
*/*                                                                  */ 00515000
*/*   OUTPUT - VUDADSME=0 AND VUDNALOC=0 FOR ALL FORMER VOLAFF       */ 00516000
*/*            DADSM-ERROR REQUESTS.                                 */ 00517000
*/*                                                                  */ 00518000
*/*   RETURN CODES - RTNCODE 0                                       */ 00519000
*/*                                                                  */ 00520000
*/* EXIT - ERROR - (INLINE SUBROUTINE)                               */ 00521000
*/*                                                                  */ 00522000
*/*   CONDITIONS - FAILING ERROR DETECTED DURING UNALLOC/REALLOC     */ 00523000
*/*                PROCESSING                                        */ 00524000
*/*                                                                  */ 00525000
*/*   OUTPUT - STEP- OR DD-RELATED ERROR SET BY INVOKED ROUTINE      */ 00526000
*/*            DETECTING THE ERROR.                                  */ 00527000
*/*                                                                  */ 00528000
*/*   RETURN CODES - RTNCODE SET NON-ZERO                            */ 00529000
*/*                                                                  */ 00530000
*/********************************************************************/ 00531000
*DADERRSW =  ON;                       /*SCAN VU'S AT LEAST ONCE     */ 00532000
         OI    DADERRSW,B'10000000'                             02S0178 00533000
*DO WHILE (DADERRSW=ON & RTNCODE=SUCCESS); /*SCAN VU'S UNTIL NO ERRS */ 00534000
         B     @DE00179                                         02S0179 00535000
@DL00179 DS    0H                                               02S0180 00536000
*  ALCBITS = ZERO;                     /*INITIALIZE SWITCHES         */ 00537000
         MVI   ALCBITS,X'00'                                    02S0180 00538000
*  VUPTR = VOLUNPTR;                   /*POINT TO FIRST VOLUNIT ENTRY*/ 00539000
         L     @15,@PC00001                                     02S0181 00540000
         L     @01,ALCWAPTR(,@15)                               02S0181 00541000
         L     VUPTR,VOLUNPTR(,@01)                             02S0181 00542000
*  DO VUCTR = ONE TO VOLUNSZE/LENGTH(VOLUNTAB); /*SCAN ALL VU ENTRIES*/ 00543000
         LA    VUCTR,1                                          02S0182 00544000
         B     @DE00182                                         02S0182 00545000
@DL00182 DS    0H                                               02S0183 00546000
*    VUREALOC = OFF;                   /*ASSUME UNALLOC NOT NEEDED   */ 00547000
         NI    VUREALOC(VUPTR),B'10111111'                      02S0183 00548000
*    IF VUDADSME=ON THEN               /*DADSM-ERR VOLAFF REQ ?      */ 00549000
         TM    VUDADSME(VUPTR),B'00000100'                      02S0184 00550000
         BNO   @RF00184                                         02S0184 00551000
*      DO;                             /*YES, PROCESS                */ 00552000
*        VOLSIOTP->SIOTRSNC = ZERO;    /*ZERO REASON CODE            */ 00553000
         L     @07,VOLSIOTP(,VUPTR)                             02S0186 00554000
         SLR   @15,@15                                          02S0186 00555000
         STH   @15,SIOTRSNC(,@07)                               02S0186 00556000
*        VUDNALOC = OFF;               /*INDICATE REQ IS OK TO ALLOC */ 00557000
*        VUDADSME = OFF;               /*TURN OFF DADSM ERROR SWITCH */ 00558000
         NI    VUDNALOC(VUPTR),B'11110011'                      02S0188 00559000
*        IF VURECVRY = OFF THEN        /*RECOVERY TRIED?     @ZA04836*/ 00560000
         TM    VURECVRY(VUPTR),B'00000100'                      02S0189 00561000
         BNZ   @RF00189                                         02S0189 00562000
*          DO;                         /*                    @ZA04836*/ 00563000
*            VURECVRY = ON;            /*NO, SET INDICATOR   @ZA04836*/ 00564000
         OI    VURECVRY(VUPTR),B'00000100'                      02S0191 00565000
*            CALLALOC = ON;            /*TO TRY REALLOCATION @ZA04836*/ 00566000
         OI    CALLALOC,B'00000001'                             02S0192 00567000
*          END;                        /*                    @ZA04836*/ 00568000
*        IF VOLALOC = ON THEN          /*WAS REQ ALREADY ALLOCATED ? */ 00569000
@RF00189 TM    VOLALOC(VUPTR),B'10000000'                       02S0194 00570000
         BNO   @RF00194                                         02S0194 00571000
*          DO;                         /*YES, INDICATE UNALOC/REALOC */ 00572000
*            VUREALOC = ON;                                     02S0196 00573000
         OI    VUREALOC(VUPTR),B'01000000'                      02S0196 00574000
*            CALLREAR = ON;                                     02S0197 00575000
         OI    CALLREAR,B'10000000'                             02S0197 00576000
*          END;                        /*                    @ZA04836*/ 00577000
*        IF VOLSTG = ON THEN           /*STORAGE REQUEST ?           */ 00578000
@RF00194 TM    VOLSTG(VUPTR),B'00010000'                        02S0199 00579000
         BNO   @RF00199                                         02S0199 00580000
*            ALCSTOR = ON;             /*YES, INDICATE FOR IEFAB436  */ 00581000
         OI    ALCSTOR,B'00000100'                              02S0200 00582000
*        ELSE                          /*PUBLIC REQ,INDICATE FOR 436 */ 00583000
*            ALCPUB = ON;                                       02S0201 00584000
         B     @RC00199                                         02S0201 00585000
@RF00199 OI    ALCPUB,B'00000010'                               02S0201 00586000
*      END;                                                     02S0202 00587000
*    ELSE;                             /*NOT VOLAFF DADSM-ERR REQ    */ 00588000
@RF00184 DS    0H                                               02S0204 00589000
*    VUPTR = VUPTR + LENGTH(VOLUNTAB); /*POINT TO NEXT VOLUNIT ENTRY */ 00590000
@RC00184 AL    VUPTR,@CF01135                                   02S0204 00591000
*  END;                                                         02S0205 00592000
         AH    VUCTR,@CH00055                                   02S0205 00593000
@DE00182 L     @07,@PC00001                                     02S0205 00594000
         L     @07,ALCWAPTR(,@07)                               02S0205 00595000
         L     @00,VOLUNSZE(,@07)                               02S0205 00596000
         SRDA  @00,32                                           02S0205 00597000
         D     @00,@CF01135                                     02S0205 00598000
         CR    VUCTR,@01                                        02S0205 00599000
         BNH   @DL00182                                         02S0205 00600000
*  IF CALLREAR = ON THEN               /*ANY UNALLOCS TO DO ?        */ 00601000
         TM    CALLREAR,B'10000000'                             02S0206 00602000
         BNO   @RF00206                                         02S0206 00603000
*    DO;                               /*YES, UNALLOC VU'S MARKED    */ 00604000
*      FUNC477 = FUNC477 && FUNC477;   /*CLEAR FUNC MAP      @ZA03616*/ 00605000
         XC    FUNC477(1),FUNC477                               02S0208 00606000
*      UNLDPMNT = ON;                  /*UNLD MNT PEND DA    @ZA03616*/ 00607000
         OI    UNLDPMNT,B'10000000'                             02S0209 00608000
*      CALL IEFAB477 (ALCWAPTR,FUNC477);                        02S0210 00609000
         L     @02,@PC00001                                     02S0210 00610000
         ST    @02,@AL00001                                     02S0210 00611000
         LA    @02,FUNC477                                      02S0210 00612000
         ST    @02,@AL00001+4                                   02S0210 00613000
         L     @15,@CV00171                                     02S0210 00614000
         LA    @01,@AL00001                                     02S0210 00615000
         BALR  @14,@15                                          02S0210 00616000
*      RTNCODE = REG15;                /*SAVE THE RETURN CODE        */ 00617000
         LR    RTNCODE,REG15                                    02S0211 00618000
*    END;                                                       02S0212 00619000
*  IF RTNCODE = SUCCESS &              /*ANY ERRORS ?        @ZA04836*/ 00620000
*     CALLALOC = ON THEN               /*                    @ZA04836*/ 00621000
@RF00206 LTR   RTNCODE,RTNCODE                                  02S0213 00622000
         BNZ   @RF00213                                         02S0213 00623000
         TM    CALLALOC,B'00000001'                             02S0213 00624000
         BNO   @RF00213                                         02S0213 00625000
*    DO;                               /*NO,REALLOCATE REQS UNALLOC'D*/ 00626000
*/********************************************************************/ 00627000
*/*                                                                  */ 00628000
*/* SEGMENT NAME - DAFERALC                                          */ 00629000
*/*                                                                  */ 00630000
*/* DESCRIPTIVE NAME - REALLOCATE VOLAFF DADSM-ERROR REQS UNALLOCATED*/ 00631000
*/*                                                                  */ 00632000
*/* FUNCTION -                                                       */ 00633000
*/*     THIS ROUTINE BUILDS A LIST OF ALL DA UCBS WITH NON-PRIVATE   */ 00634000
*/*     VOLUMES MOUNTED AND CALLS IEFAB436 (ONCE FOR STORAGE REQS    */ 00635000
*/*     AND AGAIN FOR PUBLIC REQS TO ALLOCATE REQUESTS TO THESE      */ 00636000
*/*     MOUNTED VOLUMES.                                             */ 00637000
*/*                                                                  */ 00638000
*/*   OPERATION - (THE OPERATION IS DOCUMENTED BY THE CODE ITSELF).  */ 00639000
*/*                                                                  */ 00640000
*/* ENTRY - (INLINE SUBROUTINE)                                      */ 00641000
*/*                                                                  */ 00642000
*/*   PURPOSE - (SEE FUNCTION)                                       */ 00643000
*/*                                                                  */ 00644000
*/*   INPUT -                                                        */ 00645000
*/*       ALCWAPTR - PTR TO ALLOCATION WORK AREA, WHICH CONTAINS     */ 00646000
*/*         EDTABPTR - PTR TO EDT (FOR SEGMENT 'DAFERLST')           */ 00647000
*/*         FAILRSCP - PTR TO STEP REASON CODE AREA                  */ 00648000
*/*       ALCSTOR - 1 INDICATES STORAGE REQ ALLOCATION NEEDED        */ 00649000
*/*       ALCPUB - 1 INDICATES PUBLIC REQS ALLOCATION NEEDED         */ 00650000
*/*       ALCNUCBS - NUMBER OF UCB'S IN SYSTEM               @Z40FPPJ*/ 00651000
*/*                                                                  */ 00652000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 00653000
*/*                                                                  */ 00654000
*/*   CONDITIONS - FUNCTION COMPLETED SUCCESSFULLY                   */ 00655000
*/*                                                                  */ 00656000
*/*   OUTPUT -                                                       */ 00657000
*/*       GENERAL: SOME REQS MAY BE ALLOCATED BY IEFAB436            */ 00658000
*/*                                                                  */ 00659000
*/*   RETURN CODES - RTNCODE 0                                       */ 00660000
*/*                                                                  */ 00661000
*/* EXIT - ERROR - (INLINE SUBROUTINE)                               */ 00662000
*/*                                                                  */ 00663000
*/*   CONDITIONS - GETMAIN ERROR                                     */ 00664000
*/*                                                                  */ 00665000
*/*   OUTPUT - STEP REASON CODE 'REASONCD' SET TO 2                  */ 00666000
*/*                                                                  */ 00667000
*/*   RETURN CODES - RTNCODE SET TO 4                                */ 00668000
*/*                                                                  */ 00669000
*/* EXIT - ERROR - (INLINE SUBROUTINE)                               */ 00670000
*/*                                                                  */ 00671000
*/*   CONDITIONS - ERROR DETECTED BY MODULE IEFAB436                 */ 00672000
*/*                                                                  */ 00673000
*/*   OUTPUT - STEP- OR DD-RELATED ERROR CODE SET BY IEFAB436        */ 00674000
*/*                                                                  */ 00675000
*/*   RETURN CODES - RTNCODE SET NON-ZERO                            */ 00676000
*/*                                                                  */ 00677000
*/********************************************************************/ 00678000
*UCBSLGN = (ALCNUCBS * TWO) + TWO;      /*CALCULATE SIZE OF UCB LIST  * 00679000
         L     @08,@PC00001                                     03S0215 00680000
         L     @08,ALCWAPTR(,@08)                               03S0215 00681000
         L     @08,ALCNUCBS(,@08)                               03S0215 00682000
         ALR   @08,@08                                          03S0215 00683000
         AH    @08,@CH00134                                     03S0215 00684000
         ST    @08,UCBSLGN                                      03S0215 00685000
* /* ?GETSTORG (SUBP,UCBSLGN,UCBLISTP);*/                       03S0216 00686000
*   /* DEFINITIONS OF GETMAIN PARMS */                          03S0216 00687000
*   DCL                                                         03S0216 00688000
*     GTSTR0   FIXED(31) REG(0),/*GTMN PARM REG*/               03S0216 00689000
*     GTSTR1   FIXED(31) REG(1),/*GTMN PARM REG*/               03S0216 00690000
*     GTSTR2   PTR(31)   REG(2),/*GTMN PARM REG*/               03S0216 00691000
*     GTSTR15  FIXED(31) REG(15),/*GTMN RET COD*/               03S0216 00692000
*     GTSTRTCD FIXED(31); /* GETMAIN RTN CODE  */               03S0216 00693000
*   DCL                                                         03S0217 00694000
*     GTSTR3   FIXED(31) REG(3),/* CLEARING REG*/               03S0217 00695000
*     GTSTR4   FIXED(31) REG(4),/* CLEARING REG*/               03S0217 00696000
*     GTSTR5   FIXED(31) REG(5),/* CLEARING REG*/               03S0217 00697000
*     GTSTR6   FIXED(31) REG(6),/* CLEARING REG*/               03S0217 00698000
*     GTSTR7   FIXED(31) REG(7),/* CLEARING REG*/               03S0217 00699000
*     GTSTR8   FIXED(31) REG(8),/* CLEARING REG*/               03S0217 00700000
*     GTSTZERO FIXED(31) INIT(0),                               03S0217 00701000
*     GTST253  FIXED(31) CONSTANT(253);                         03S0217 00702000
*   RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/               03S0218 00703000
*   GTSTR0 = UCBSLGN; /* SET AMOUNT*/                           03S0219 00704000
         LR    GTSTR0,@08                                       03S0219 00705000
*   GTSTR2 = SUBP; /* SET SUBPOOL*/                             03S0220 00706000
         LA    GTSTR2,230                                       03S0220 00707000
*   GENERATE CODE;                                              03S0221 00708000
     GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN                               00709000
*   GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/               03S0222 00710000
         LR    GTSTRTCD,GTSTR15                                 03S0222 00711000
*   UCBLISTP = GTSTR1; /* ADDR OF GOTN STORG*/                  03S0223 00712000
         ST    GTSTR1,UCBLISTP                                  03S0223 00713000
*   RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */                03S0224 00714000
*   IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */               03S0225 00715000
         LTR   GTSTRTCD,GTSTRTCD                                03S0225 00716000
         BNZ   @RF00225                                         03S0225 00717000
*     DO;               /* YES, CLEAR STORAGE.*/                03S0226 00718000
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       03S0227 00719000
*                          GTSTR7,GTSTR8) RSTD;                 03S0227 00720000
*       GTSTR4 = UCBLISTP; /*STORG PTR*/                        03S0228 00721000
         L     @03,UCBLISTP                                     03S0228 00722000
         LR    GTSTR4,@03                                       03S0228 00723000
*       GTSTR5 = UCBSLGN; /*STORG AMNT*/                        03S0229 00724000
         L     GTSTR5,UCBSLGN                                   03S0229 00725000
*       GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/               03S0230 00726000
         SLR   GTSTR7,GTSTR7                                    03S0230 00727000
*       IF SUBP = GTST253 THEN                                  03S0231 00728000
         B     @RF00231                                         03S0231 00729000
*      GEN                                                      03S0232 00730000
*   (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);           03S0232 00731000
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8                 00732000
*       GEN REFS(GTSTR4,GTSTR6);                                03S0233 00733000
@RF00231 DS    0H                                               03S0233 00734000
          MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG                        00735000
*       IF SUBP = GTST253 THEN                                  03S0234 00736000
         B     @RF00234                                         03S0234 00737000
*         GEN (MODESET KEYADDR=(2));                            03S0235 00738000
         MODESET KEYADDR=(2)                                            00739000
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       03S0236 00740000
*                          GTSTR7,GTSTR8) UNRSTD;               03S0236 00741000
@RF00234 DS    0H                                               03S0237 00742000
*     END;       /* STORAGE CLEARING COMPLETED */               03S0237 00743000
*   ELSE                                                        03S0238 00744000
*   UCBLISTP= 0;   /* CLEAR RETURN ADDR. */                     03S0238 00745000
         B     @RC00225                                         03S0238 00746000
@RF00225 SLR   @08,@08                                          03S0238 00747000
         ST    @08,UCBLISTP                                     03S0238 00748000
*   GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */               03S0239 00749000
@RC00225 LR    GTSTR15,GTSTRTCD                                 03S0239 00750000
*                                      /* RESTORE LIST PRINT STATUS  */ 00751000
*    /*GET CORE FOR LIST           */                           03S0240 00752000
*RTNCODE = REG15;                      /*SAVE THE RETURN CODE        */ 00753000
         LR    RTNCODE,REG15                                    03S0240 00754000
*IF RTNCODE = SUCCESS THEN             /*ANY ERRORS ?                */ 00755000
         LTR   RTNCODE,RTNCODE                                  03S0241 00756000
         BNZ   @RF00241                                         03S0241 00757000
*  DO;                                 /*NO, PROCESS                 */ 00758000
*    CALL DAFERLST;                    /*FILL IN CANDIDATE LIST      */ 00759000
         BAL   @14,DAFERLST                                     03S0243 00760000
*    PSUCBP (MAXMNTS + ONE) = ZERO;     /*INDICATE THE LAST LIST ENT */ 00761000
         LR    @05,MAXMNTS                                      03S0244 00762000
         ALR   @05,@05                                          03S0244 00763000
         L     @02,UCBLISTP                                     03S0244 00764000
         ALR   @02,@05                                          03S0244 00765000
         SLR   @05,@05                                          03S0244 00766000
         STH   @05,PSUCBP(,@02)                                 03S0244 00767000
*    IF ALCSTOR = ON THEN              /*ANY STORAGE REQS TO ALLOC ? */ 00768000
         TM    ALCSTOR,B'00000100'                              03S0245 00769000
         BNO   @RF00245                                         03S0245 00770000
*      DO;                             /*YES,ALLOCATE TO MNTED VOLS  */ 00771000
*        FUNCMAP1 = STORFUNC;          /*SET IEFAB436 FUNCTION MAP   */ 00772000
         MVC   FUNCMAP1(1),STORFUNC                             03S0247 00773000
*        CALL IEFAB436 (ALCWAPTR,UCBLISTP,ADDR(FUNCLIST));      03S0248 00774000
         L     @02,@PC00001                                     03S0248 00775000
         ST    @02,@AL00001                                     03S0248 00776000
         LA    @02,UCBLISTP                                     03S0248 00777000
         ST    @02,@AL00001+4                                   03S0248 00778000
         LA    @02,FUNCLIST                                     03S0248 00779000
         ST    @02,@TF00001                                     03S0248 00780000
         LA    @02,@TF00001                                     03S0248 00781000
         ST    @02,@AL00001+8                                   03S0248 00782000
         L     @15,@CV00167                                     03S0248 00783000
         LA    @01,@AL00001                                     03S0248 00784000
         BALR  @14,@15                                          03S0248 00785000
*        RTNCODE = REG15;              /*SAVE THE RETURN CODE        */ 00786000
         LR    RTNCODE,REG15                                    03S0249 00787000
*      END;                                                     03S0250 00788000
*    ELSE;                             /*NO STORAGE REQS             */ 00789000
@RF00245 DS    0H                                               03S0252 00790000
*    IF ALCPUB=ON & RTNCODE=SUCCESS THEN /*ANY PUBLIC REQS TO ALLOC  */ 00791000
         TM    ALCPUB,B'00000010'                               03S0252 00792000
         BNO   @RF00252                                         03S0252 00793000
         LTR   RTNCODE,RTNCODE                                  03S0252 00794000
         BNZ   @RF00252                                         03S0252 00795000
*      DO;                             /*YES,ALLOCATE TO MNTED VOLS  */ 00796000
*        FUNCMAP1 = PUBFUNC;           /*SET IEFAB436 FUNCTION MAP   */ 00797000
         MVC   FUNCMAP1(1),PUBFUNC                              03S0254 00798000
*        CALL IEFAB436 (ALCWAPTR,UCBLISTP,ADDR(FUNCLIST));      03S0255 00799000
         L     @02,@PC00001                                     03S0255 00800000
         ST    @02,@AL00001                                     03S0255 00801000
         LA    @02,UCBLISTP                                     03S0255 00802000
         ST    @02,@AL00001+4                                   03S0255 00803000
         LA    @02,FUNCLIST                                     03S0255 00804000
         ST    @02,@TF00001                                     03S0255 00805000
         LA    @02,@TF00001                                     03S0255 00806000
         ST    @02,@AL00001+8                                   03S0255 00807000
         L     @15,@CV00167                                     03S0255 00808000
         LA    @01,@AL00001                                     03S0255 00809000
         BALR  @14,@15                                          03S0255 00810000
*        RTNCODE = REG15;                                       03S0256 00811000
         LR    RTNCODE,REG15                                    03S0256 00812000
*      END;                                                     03S0257 00813000
*    ELSE;                             /*NO PUBLIC REQUESTS TO ALLOC */ 00814000
@RF00252 DS    0H                                               03S0259 00815000
*    RFY (REG0,REG1) RSTD;                                      03S0259 00816000
*    REG0 = UCBSLGN;                   /*LENGTH OF UCB LIST          */ 00817000
         L     REG0,UCBSLGN                                     03S0260 00818000
*    REG0 = REG0 | SUBP230;                                     03S0261 00819000
         O     REG0,@CF00158                                    03S0261 00820000
*    REG1 = UCBLISTP;                  /*PTR TO UCB LIST             */ 00821000
         L     REG1,UCBLISTP                                    03S0262 00822000
*    GEN ( FREEMAIN R,LV=(0),A=(1));   /*FREE THE UCB LIST           */ 00823000
          FREEMAIN R,LV=(0),A=(1)                                       00824000
*    RFY (REG0,REG1) UNRSTD;                                    03S0264 00825000
*  END;                                                         03S0265 00826000
*ELSE                                  /*GETMAIN ERROR               */ 00827000
*  DO;                                                          03S0266 00828000
         B     @RC00241                                         03S0266 00829000
@RF00241 DS    0H                                               03S0267 00830000
*    REASONCD = GETMNERR;              /*SET GETMAIN ERROR REASON CD */ 00831000
         L     @02,@PC00001                                     03S0267 00832000
         L     @02,ALCWAPTR(,@02)                               03S0267 00833000
         L     @02,FAILRSCP(,@02)                               03S0267 00834000
         MVC   REASONCD(2,@02),@CH00134                         03S0267 00835000
*  END;                                                         03S0268 00836000
*    END;                                                       02S0269 00837000
*  ELSE                                /*NO REQS TO UNALLOC          */ 00838000
*    DO;                                                        02S0270 00839000
         B     @RC00213                                         02S0270 00840000
@RF00213 DS    0H                                               02S0271 00841000
*      DADERRSW = OFF;                 /*END SCAN OF VU'S            */ 00842000
         NI    DADERRSW,B'01111111'                             02S0271 00843000
*    END;                                                       02S0272 00844000
*END;                                                           02S0273 00845000
@RC00213 DS    0H                                               02S0273 00846000
@DE00179 TM    DADERRSW,B'10000000'                             02S0273 00847000
         BNO   @DC00179                                         02S0273 00848000
         LTR   RTNCODE,RTNCODE                                  02S0273 00849000
         BZ    @DL00179                                         02S0273 00850000
@DC00179 DS    0H                                               02S0274 00851000
*  END;                                                         01S0274 00852000
*ELSE;                                 /*ERROR OR NO REQS TO ALLOCATE*/ 00853000
@RF00176 DS    0H                                               01S0276 00854000
*IF TOTREQS>ZERO & RTNCODE=SUCCESS THEN /*STILL REQS TO ALLOCATE        00855000
*                                                            @YM04246*/ 00856000
         SLR   @02,@02                                          01S0276 00857000
         L     @15,@PC00001                                     01S0276 00858000
         L     @15,ALCWAPTR(,@15)                               01S0276 00859000
         C     @02,TOTREQS(,@15)                                01S0276 00860000
         BNL   @RF00276                                         01S0276 00861000
         CR    RTNCODE,@02                                      01S0276 00862000
         BNE   @RF00276                                         01S0276 00863000
*  DO;                                 /*YES, ..                     */ 00864000
*/********************************************************************/ 00865000
*/*                                                                  */ 00866000
*/* SEGMENT NAME - SCRATALG                                          */ 00867000
*/*                                                                  */ 00868000
*/* DESCRIPTIVE NAME - ALLOCATE SCRATCH REQS VIA ALGORITHM           */ 00869000
*/*                                                                  */ 00870000
*/* FUNCTION -                                                       */ 00871000
*/*     THIS ROUTINE DETERMINES IF THERE ARE ANY SCRATCH REQS NOT    */ 00872000
*/*     YET ALLOCATED. IF SO, THE FOLLOWING PROCESSING IS DONE:      */ 00873000
*/*       .IF THERE ARE MULTI-UNIT SCRATCH REQUESTS, IEFAB436 IS     */ 00874000
*/*        CALLED TO TRY TO ALLOCATE SECONDARY UNIT REQUESTS TO      */ 00875000
*/*        MOUNTED VOLUMES IN THE GENERIC WITH THE MOST ELIGIBLE     */ 00876000
*/*        VOLUMES.                                                  */ 00877000
*/*       .IEFAB476 IS CALLED TO ALLOCATE THE PRIMARY SCRATCH        */ 00878000
*/*        REQS AND ANY REMAINING SECONDARY REQS VIA THE ALGORITHM   */ 00879000
*/*        TO AVAILABLE (ONLINE,UNALLOCATED) UNITS.                  */ 00880000
*/*                                                                  */ 00881000
*/*   OPERATION - (THE OPERATION IS DOCUMENTED BY THE CODE ITSELF)   */ 00882000
*/*                                                                  */ 00883000
*/* ENTRY - (INLINE SUBROUTINE)                                      */ 00884000
*/*                                                                  */ 00885000
*/*   PURPOSE - (SEE FUNCTION)                                       */ 00886000
*/*                                                                  */ 00887000
*/*   INPUT -                                                        */ 00888000
*/*     ALCWAPTR - PTR TO ALLOCATION WORK AREA, WHICH CONTAINS       */ 00889000
*/*       VOLUNPTR - PTR TO VOLUNIT TABLE                            */ 00890000
*/*       VOLMNTSW - INDICATE IF VOL MOUNTING IS ALLOWED     @YM04246*/ 00891000
*/*     RTNCODE = 0                                                  */ 00892000
*/*     VOLUNIT ENTRY FIELD 'VOLALGTP' POINT TO ALG TABLE ENTRY,     */ 00893000
*/*       CVRSCRTH - SCRATCH REQ INDICATOR IN ALG TABLE ENTRIES      */ 00894000
*/*       VOLUNIT ENTRY FIELD 'VOLSIOTP' POINTS TO THE SIOT,         */ 00895000
*/*       SIOT FIELDS: SIOTAFID, SIOPSCNT, SIOTEDLP, SVOLUNAD,       */ 00896000
*/*       AND SIOTGIGN                                               */ 00897000
*/*                                                                  */ 00898000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 00899000
*/*                                                                  */ 00900000
*/*   CONDITIONS - FUNCTION COMPLETED SUCCESSFULLY                   */ 00901000
*/*                                                                  */ 00902000
*/*   OUTPUT -                                                       */ 00903000
*/*       GENERAL: SOME REQS MAY BE ALLOCATED BY IEFAB436 OR         */ 00904000
*/*                IEFAB476                                          */ 00905000
*/*                                                                  */ 00906000
*/*       RETURN CODES - RTNCODE 0                                   */ 00907000
*/*                                                                  */ 00908000
*/* EXIT - ERROR - (INLINE SUBROUTINE)                               */ 00909000
*/*                                                                  */ 00910000
*/*   CONDITIONS - GETMAIN ERROR                                     */ 00911000
*/*                                                                  */ 00912000
*/*   OUTPUT - STEP REASON CODE 'REASONCD' SET TO 2                  */ 00913000
*/*                                                                  */ 00914000
*/*   RETURN CODES - RTNCODE SET TO 4                                */ 00915000
*/*                                                          @YM04246*/ 00916000
*/* EXIT - ERROR - (INLINE SUBROUTINE)                       @YM04246*/ 00917000
*/*                                                          @YM04246*/ 00918000
*/*   CONDITIONS - VOL MOUNTING NEEDED BUT NOT ALLOWED       @YM04246*/ 00919000
*/*                                                          @YM04246*/ 00920000
*/*   OUTPUT - DD - ERROR CODE(SIOTRSNC) SET TO 56           @YM04246*/ 00921000
*/*                                                          @YM04246*/ 00922000
*/*   RETURN CODES - RTNCODE SET TO 4                        @YM04246*/ 00923000
*/*                                                                  */ 00924000
*/* EXIT - ERROR - (INLINE SUBROUTINE)                               */ 00925000
*/*                                                                  */ 00926000
*/*   CONDITIONS - ERROR DETECTED BY MODULE IEFAB436 OR IEFAB476     */ 00927000
*/*                                                                  */ 00928000
*/*   OUTPUT - STEP- OR DD-RELATED ERROR CODE SET BY IEFAB436 OR     */ 00929000
*/*            IEFAB476                                              */ 00930000
*/*                                                                  */ 00931000
*/*   RETURN CODES - RTNCODE SET NON-ZERO                            */ 00932000
*/*                                                                  */ 00933000
*/********************************************************************/ 00934000
*SNEEDMNT = OFF;                       /*ASSUME IEFAB436 NOT NEEDED  */ 00935000
*SNEEDALG = OFF;                       /*ASSUME IEFAB476 NOT NEEDED  */ 00936000
         NI    SNEEDMNT,B'11110011'                             02S0279 00937000
*RFY INDMSIOT BASED(VOLSIOTP);         /*BASE SIOT ON VU ENTRY PTR   */ 00938000
*VUPTR = VOLUNPTR;                     /*POINT TO THE FIRST VU ENTRY */ 00939000
         L     VUPTR,VOLUNPTR(,@15)                             02S0281 00940000
*DO VUCTR = ONE TO VOLUNSZE/LENGTH(VOLUNTAB); /*SCAN ALL VU ENTRIES  */ 00941000
         LA    VUCTR,1                                          02S0282 00942000
         B     @DE00282                                         02S0282 00943000
@DL00282 DS    0H                                               02S0283 00944000
*  IF VUPTR = SVOLUNAD THEN            /*FIRST VU ENTRY FOR SIOT ?   */ 00945000
         L     @07,VOLSIOTP(,VUPTR)                             02S0283 00946000
         C     VUPTR,SVOLUNAD(,@07)                             02S0283 00947000
         BNE   @RF00283                                         02S0283 00948000
*    SIOTGIGN = ON;                    /*YES, MAKE SIOT 'IGNORE'     */ 00949000
         OI    SIOTGIGN(@07),B'00001000'                        02S0284 00950000
*  ELSE;                               /*NOT THE FIRST VU FOR SIOT   */ 00951000
@RF00283 DS    0H                                               02S0286 00952000
*  IF VOLALOC = OFF                    /*UNALLOC,DEVICE-REQ'D,SCRATCH*/ 00953000
*      & VDEVREQD = ON                 /*..REQ THE ALG CAN CONSIDER? */ 00954000
*      & VOLALGTP->CVRSCRTH = ON                                02S0286 00955000
*      & VOLALGTP->CVRIGNOR = OFF                               02S0286 00956000
*      & VOLALGTP->CVRDUPLI = OFF THEN                          02S0286 00957000
         TM    VDEVREQD(VUPTR),B'00100000'                      02S0286 00958000
         BNO   @RF00286                                         02S0286 00959000
         TM    VOLALOC(VUPTR),B'10000000'                       02S0286 00960000
         BNZ   @RF00286                                         02S0286 00961000
         L     @07,VOLALGTP(,VUPTR)                             02S0286 00962000
         TM    CVRSCRTH(@07),B'00001000'                        02S0286 00963000
         BNO   @RF00286                                         02S0286 00964000
         TM    CVRIGNOR(@07),B'00000010'                        02S0286 00965000
         BNZ   @RF00286                                         02S0286 00966000
         TM    CVRDUPLI(@07),B'10000000'                        02S0286 00967000
         BNZ   @RF00286                                         02S0286 00968000
*    DO;                               /*YES, PROCESS                */ 00969000
*      IF VOLMNTSW = ON THEN           /*VOL MNT'ING ALLOWED @YM04246*/ 00970000
         L     @15,@PC00001                                     02S0288 00971000
         L     @01,ALCWAPTR(,@15)                               02S0288 00972000
         L     @01,FMAPPTR(,@01)                                02S0288 00973000
         TM    VOLMNTSW(@01),B'10000000'                        02S0288 00974000
         BNO   @RF00288                                         02S0288 00975000
*        DO;                           /*YES, CONTINUE       @YM04246*/ 00976000
*          VOLALGTP->CVRSKFLG = OFF;   /*ALLOW THE ALG TO CONSIDER   */ 00977000
         NI    CVRSKFLG(@07),B'01111111'                        02S0290 00978000
*          SNEEDALG = ON;              /*INDICATE THE ALG IS NEEDED  */ 00979000
         OI    SNEEDALG,B'00001000'                             02S0291 00980000
*          IF EDLMGENS=OFF             /*MULTI-GENERICS TABOO        */ 00981000
*          & SIOPSCNT > ONE THEN       /*AND MORE THAN 1 SCR REQ?    */ 00982000
         L     @07,VOLSIOTP(,VUPTR)                             02S0292 00983000
         L     @15,SIOTEDLP(,@07)                               02S0292 00984000
         TM    EDLMGENS(@15),B'01000000'                        02S0292 00985000
         BNZ   @RF00292                                         02S0292 00986000
         CLI   SIOPSCNT(@07),1                                  02S0292 00987000
         BNH   @RF00292                                         02S0292 00988000
*            DO;                       /*YES, PROCESS                */ 00989000
*              SIOTGIGN = OFF;         /*ALLOW IEFAB436 TO CONSIDER  */ 00990000
         NI    SIOTGIGN(@07),B'11110111'                        02S0294 00991000
*              IF SIOTAFID ^= ZERO THEN /*MULTI-UNIT/GEN REQ ?       */ 00992000
         SLR   @14,@14                                          02S0295 00993000
         CH    @14,SIOTAFID(,@07)                               02S0295 00994000
         BE    @RF00295                                         02S0295 00995000
*                DO;                   /*YES, PICK GEN WITH MOST MNTS*/ 00996000
*/********************************************************************/ 00997000
*/*                                                                  */ 00998000
*/* SEGMENT NAME - PICSCRAG                                          */ 00999000
*/*                                                                  */ 01000000
*/* DESCRIPTIVE NAME - PICK A GENERIC FOR SCRATCH REQS               */ 01001000
*/*                                                                  */ 01002000
*/* FUNCTION -                                                       */ 01003000
*/*     THIS ROUTINE PICKS A GENERIC FOR A MULTI-UNIT, MULTI-GENERIC */ 01004000
*/*     SCRATCH REQUEST AND MARKS ALL OTHER GENERICS INELIGIBLE IN   */ 01005000
*/*     THE EDL AND ALGORITHM INTERFACE TABLES.                      */ 01006000
*/*                                                                  */ 01007000
*/*     THE GENERIC PICKED WILL BE THE ONE WITH THE MOST ELIGIBLE    */ 01008000
*/*     MOUNTED VOLUMES (EDLNSCNT). IF NONE OF THE ELIGIBLE          */ 01009000
*/*     GENERICS HAD ANY MOUNTED VOLUMES, NO GENERIC IS PICKED AND   */ 01010000
*/*     'SIOTGIGN' IS TURNED ON SO THAT IEFAB436 WILL NOT PROCESS    */ 01011000
*/*     THIS REQUEST.                                                */ 01012000
*/*                                                                  */ 01013000
*/*   OPERATION - (THE OPERATION IS DOCUMENTED BY THE CODE ITSELF)   */ 01014000
*/*                                                                  */ 01015000
*/* ENTRY - (INLINE SUBROUTINE)                                      */ 01016000
*/*                                                                  */ 01017000
*/*   PURPOSE - (SEE FUNCTION)                                       */ 01018000
*/*                                                                  */ 01019000
*/*   INPUT -                                                        */ 01020000
*/*      VUPTR - PTR TO THE VOLUNIT ENTRY BEING PROCESSED            */ 01021000
*/*      SIOTGIGN = 0                                                */ 01022000
*/*                                                                  */ 01023000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 01024000
*/*                                                                  */ 01025000
*/*   CONDITIONS - GENERIC PICKED FOR REQ                            */ 01026000
*/*                                                                  */ 01027000
*/*   OUTPUT - OTHER GENERICS MARKED INELIGIBLE (SEE IEFAB481)       */ 01028000
*/*                                                                  */ 01029000
*/*   RETURN CODES - RTNCODE SET TO 0                                */ 01030000
*/*                                                                  */ 01031000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 01032000
*/*                                                                  */ 01033000
*/*   CONDITIONS - NO GENERIC WITH ELIGIBLE MOUNTED VOLUMES FOUND    */ 01034000
*/*                                                                  */ 01035000
*/*   OUTPUT - SIOTGIGN=1                                            */ 01036000
*/*                                                                  */ 01037000
*/*   RETURN CODES - (NONE)                                          */ 01038000
*/*                                                                  */ 01039000
*/********************************************************************/ 01040000
*MOSTNUM = ZERO;                       /*ZERO NUMBER MOUNTED VOLUMES */ 01041000
         SLR   MOSTNUM,MOSTNUM                                  03S0297 01042000
*GENPICK = ZERO;                       /*ZERO GENERIC CHOICE FIELD   */ 01043000
         ST    @14,GENPICK                                      03S0298 01044000
*EDLPTR = EDLFGENP;                    /*POINT TO THE FIRST EDL GEN  */ 01045000
         L     EDLPTR,EDLFGENP(,@15)                            03S0299 01046000
*DO EGENCTR = ONE TO EDLGENNO;         /*SCAN ALL GENERIC           */  01047000
         LA    EGENCTR,1                                        03S0300 01048000
         B     @DE00300                                         03S0300 01049000
@DL00300 DS    0H                                               03S0301 01050000
*  IF EINDEVTP = OFF                   /*DOES GEN HAVE MORE MNTED VOL*/ 01051000
*      & EDLNSCNT > MOSTNUM THEN                                03S0301 01052000
         TM    EINDEVTP(EDLPTR),B'10000000'                     03S0301 01053000
         BNZ   @RF00301                                         03S0301 01054000
         LH    @15,EDLNSCNT(,EDLPTR)                            03S0301 01055000
         CR    @15,MOSTNUM                                      03S0301 01056000
         BNH   @RF00301                                         03S0301 01057000
*    DO;                               /*YES,TENTATIVELY PICK GENERIC*/ 01058000
*      MOSTNUM = EDLNSCNT;             /*STORE NUMBER OF MNTEDS      */ 01059000
         LR    MOSTNUM,@15                                      03S0303 01060000
*      GENPICK = EDLDEVT;              /*COPY GENERIC DEVICE TYPE    */ 01061000
         MVC   GENPICK(4),EDLDEVT(EDLPTR)                       03S0304 01062000
*    END;                                                       03S0305 01063000
*  ELSE;                               /*GEN DOESN'T HAVE MORE MNTEDS*/ 01064000
@RF00301 DS    0H                                               03S0307 01065000
*  EDLPTR = EDLNXTNT;                  /*POINT TO THE NEXT GENERIC   */ 01066000
         L     EDLPTR,EDLNXTNT(,EDLPTR)                         03S0307 01067000
*END;                                                           03S0308 01068000
         AH    EGENCTR,@CH00055                                 03S0308 01069000
@DE00300 L     @01,VOLSIOTP(,VUPTR)                             03S0308 01070000
         L     @01,SIOTEDLP(,@01)                               03S0308 01071000
         C     EGENCTR,EDLGENNO(,@01)                           03S0308 01072000
         BNH   @DL00300                                         03S0308 01073000
*IF GENPICK ^= ZERO THEN               /*WAS A GEN WITH MNTEDS FOUND?*/ 01074000
         ICM   @07,15,GENPICK                                   03S0309 01075000
         BZ    @RF00309                                         03S0309 01076000
*  DO;                                 /*YES, ELIMINATE ALL OTHER GEN*/ 01077000
*    SAVAFID = SIOTAFID;               /*COPY SIOT'S AFID            */ 01078000
         L     @05,VOLSIOTP(,VUPTR)                             03S0311 01079000
         LH    SAVAFID,SIOTAFID(,@05)                           03S0311 01080000
*    SIOTPTR = SIOT1P;                 /*POINT TO FIRST SIOT         */ 01081000
         L     @15,@PC00001                                     03S0312 01082000
         L     @01,ALCWAPTR(,@15)                               03S0312 01083000
         L     SIOTPTR,SIOT1P(,@01)                             03S0312 01084000
*    DO WHILE SIOTPTR ^= ZERO;         /*SCAN SIOTS                  */ 01085000
         B     @DE00313                                         03S0313 01086000
@DL00313 DS    0H                                               03S0314 01087000
*      IF SIOTPTR->SIOTAFID = SAVAFID THEN  /*AFID GROUP REQ         */ 01088000
         CH    SAVAFID,SIOTAFID(,SIOTPTR)                       03S0314 01089000
         BNE   @RF00314                                         03S0314 01090000
*        DO;                                                    03S0315 01091000
*          CALL IEFAB481(VOLSIOTP,GENPICK);/*UPDATE EDL+ALGORITHM TAB*/ 01092000
         LA    @05,VOLSIOTP(,VUPTR)                             03S0316 01093000
         ST    @05,@AL00001                                     03S0316 01094000
         LA    @05,GENPICK                                      03S0316 01095000
         ST    @05,@AL00001+4                                   03S0316 01096000
         L     @15,@CV00172                                     03S0316 01097000
         LA    @01,@AL00001                                     03S0316 01098000
         BALR  @14,@15                                          03S0316 01099000
*          RTNCODE = REG15;            /*SAVE THE RETURN CODE        */ 01100000
         LR    RTNCODE,REG15                                    03S0317 01101000
*        END;                                                   03S0318 01102000
*      ELSE;                           /*NOT IN AFID GROUP           */ 01103000
@RF00314 DS    0H                                               03S0320 01104000
*      SIOTPTR = SIOTPTR->SIOTNPTR;    /*POINT TO NEXT SIOT          */ 01105000
         L     SIOTPTR,SIOTNPTR(,SIOTPTR)                       03S0320 01106000
*    END;                                                       03S0321 01107000
@DE00313 LTR   SIOTPTR,SIOTPTR                                  03S0321 01108000
         BNZ   @DL00313                                         03S0321 01109000
*  END;                                                         03S0322 01110000
*ELSE                                  /*NO GEN FOUND WITH MNTED VOLS*/ 01111000
*  DO;                                                          03S0323 01112000
         B     @RC00309                                         03S0323 01113000
@RF00309 DS    0H                                               03S0324 01114000
*    SIOTGIGN = ON;                    /*DON'T HAVE IEFAB436 CONSIDER*/ 01115000
         L     @07,VOLSIOTP(,VUPTR)                             03S0324 01116000
         OI    SIOTGIGN(@07),B'00001000'                        03S0324 01117000
*  END;                                                         03S0325 01118000
*                END;                                           02S0326 01119000
*              ELSE;                   /*NOT A MULTI-UNIT/GEN REQ    */ 01120000
@RF00295 DS    0H                                               02S0328 01121000
*              IF SIOTGIGN = OFF THEN  /*IS IEFAB436 TO PROCESS REQ  */ 01122000
@RC00295 L     @07,VOLSIOTP(,VUPTR)                             02S0328 01123000
         TM    SIOTGIGN(@07),B'00001000'                        02S0328 01124000
         BNZ   @RF00328                                         02S0328 01125000
*                SNEEDMNT = ON;        /*YES,INDICATE IEFAB436 NEEDED*/ 01126000
         OI    SNEEDMNT,B'00000100'                             02S0329 01127000
*              ELSE;                   /*IEFAB436 NOT TO CONSIDER REQ*/ 01128000
@RF00328 DS    0H                                               02S0331 01129000
*            END;                                               02S0331 01130000
*          ELSE;                       /*ONLY 1 SCR REQ OR MGENS OK  */ 01131000
@RF00292 DS    0H                                               02S0333 01132000
*        END;                          /*                    @YM04246*/ 01133000
*    ELSE                              /*VOL MNTING NOT ALOWD@YM04246*/ 01134000
*      DO;                             /*                    @YM04246*/ 01135000
         B     @RC00288                                         02S0334 01136000
@RF00288 DS    0H                                               02S0335 01137000
*        RTNCODE = FAILURE;            /*SET ERROR RETURN    @YM04246*/ 01138000
         LA    RTNCODE,4                                        02S0335 01139000
*        SIOTRSNC = NOMOUNT;           /*SET REASON CODE     @YM04246*/ 01140000
         L     @07,VOLSIOTP(,VUPTR)                             02S0336 01141000
         MVC   SIOTRSNC(2,@07),@CH00138                         02S0336 01142000
*      END;                            /*                    @YM04246*/ 01143000
*    END;                                                       02S0338 01144000
*  ELSE;                               /*NOT UNALLOC SCR FOR ALG     */ 01145000
@RF00286 DS    0H                                               02S0340 01146000
*    IF VOLALGTP ^= ZERO THEN          /*ALG TABLE ENTRY ?           */ 01147000
@RC00286 L     @07,VOLALGTP(,VUPTR)                             02S0340 01148000
         LTR   @07,@07                                          02S0340 01149000
         BZ    @RF00340                                         02S0340 01150000
*      VOLALGTP->CVRSCRTH=OFF;         /*TURN OFF SCRATCH INDICATOR  */ 01151000
         NI    CVRSCRTH(@07),B'11110111'                        02S0341 01152000
*    ELSE;                             /*NO ALG TABLE ENTRY          */ 01153000
@RF00340 DS    0H                                               02S0343 01154000
*  VUPTR = VUPTR + LENGTH(VOLUNTAB);   /*POINT TO THE NEXT VU ENTRY  */ 01155000
         AL    VUPTR,@CF01135                                   02S0343 01156000
*END;                                                           02S0344 01157000
         AH    VUCTR,@CH00055                                   02S0344 01158000
@DE00282 L     @07,@PC00001                                     02S0344 01159000
         L     @07,ALCWAPTR(,@07)                               02S0344 01160000
         L     @00,VOLUNSZE(,@07)                               02S0344 01161000
         SRDA  @00,32                                           02S0344 01162000
         D     @00,@CF01135                                     02S0344 01163000
         CR    VUCTR,@01                                        02S0344 01164000
         BNH   @DL00282                                         02S0344 01165000
*RFY INDMSIOT BASED(SIOTPTR);                                   02S0345 01166000
*IF SNEEDMNT = ON                      /*ALLOC SCR TO MOUNTEDS NEEDED*/ 01167000
*  & RTNCODE = SUCCESS THEN            /*IF NO ERRORS        @YM04246*/ 01168000
         TM    SNEEDMNT,B'00000100'                             02S0346 01169000
         BNO   @RF00346                                         02S0346 01170000
         LTR   RTNCODE,RTNCODE                                  02S0346 01171000
         BNZ   @RF00346                                         02S0346 01172000
*  DO;                                 /*YES,INVOKE IEFAB436 TO ALLOC*/ 01173000
*    DOPRTAL = ON;                     /*ALLOC SECONDARY ONLY@ZA03616*/ 01174000
         OI    DOPRTAL,B'00001000'                              02S0348 01175000
*    CALL SCRATMNT;                    /*SECONDARY SCTCH REQS@ZA03616*/ 01176000
         BAL   @14,SCRATMNT                                     02S0349 01177000
*  END;                                                         02S0350 01178000
*ELSE;                                 /*IEFAB436 NOT NEEDED         */ 01179000
@RF00346 DS    0H                                               02S0352 01180000
*IF SNEEDALG=ON & RTNCODE=SUCCESS THEN /*IS THE ALG NEEDED ?         */ 01181000
         TM    SNEEDALG,B'00001000'                             02S0352 01182000
         BNO   @RF00352                                         02S0352 01183000
         LTR   RTNCODE,RTNCODE                                  02S0352 01184000
         BNZ   @RF00352                                         02S0352 01185000
*  DO;                                 /*YES, ALLOC VIA ALGORITHM    */ 01186000
*    FUNC476 = SCRAT476;               /*COPY THE FUNCTION MAP       */ 01187000
         MVC   FUNC476(1),SCRAT476                              02S0354 01188000
*    CALL IEFAB476 (ALCWAPTR,FUNC476);                          02S0355 01189000
         L     @02,@PC00001                                     02S0355 01190000
         ST    @02,@AL00001                                     02S0355 01191000
         LA    @02,FUNC476                                      02S0355 01192000
         ST    @02,@AL00001+4                                   02S0355 01193000
         L     @15,@CV00168                                     02S0355 01194000
         LA    @01,@AL00001                                     02S0355 01195000
         BALR  @14,@15                                          02S0355 01196000
*    RTNCODE = REG15;                  /*SAVE THE RETURN CODE        */ 01197000
         LR    RTNCODE,REG15                                    02S0356 01198000
*  END;                                                         02S0357 01199000
*ELSE;                                 /*NO SCRATCH REQS FOR ALG     */ 01200000
@RF00352 DS    0H                                               02S0359 01201000
*  END;                                                         01S0359 01202000
*ELSE;                                 /*ERROR OR NO REQS TO ALLOCATE*/ 01203000
@RF00276 DS    0H                                               01S0361 01204000
*IF TOTREQS>ZERO & RTNCODE=SUCCESS THEN /*STILL REQS TO ALLOCATE  ?  */ 01205000
         SLR   @02,@02                                          01S0361 01206000
         L     @15,@PC00001                                     01S0361 01207000
         L     @15,ALCWAPTR(,@15)                               01S0361 01208000
         C     @02,TOTREQS(,@15)                                01S0361 01209000
         BNL   @RF00361                                         01S0361 01210000
         CR    RTNCODE,@02                                      01S0361 01211000
         BNE   @RF00361                                         01S0361 01212000
*  DO;                                 /*YES, PROCESS                */ 01213000
*    IF UWAITSW=OFF & OFFDEVSW=OFF THEN /*CAN OFFLINE OR ALCD BE USED*/ 01214000
         L     @01,FMAPPTR(,@15)                                01S0363 01215000
         TM    UWAITSW(@01),B'00100100'                         01S0363 01216000
         BNZ   @RF00363                                         01S0363 01217000
*      DO;                             /*NO, INDICATE ERROR          */ 01218000
*        RFY VOLUNTAB BASED(CVRVUPTR); /*ASSOCIATE VU TABLE ENTRY AND   01219000
*                                        COVER REQ LIST ENTRY@ZA01569*/ 01220000
*        RFY INDMSIOT BASED(VOLSIOTP); /*ASSOCIATE VU ENTRY WITH ITS    01221000
*                                        SIOT                @ZA01569*/ 01222000
*        AREQPTR = ALGRQLTP;           /*FIRST REQ LIST ENTRY@ZA01569*/ 01223000
         L     @01,ALGTABP(,@15)                                01S0367 01224000
         L     AREQPTR,ALGRQLTP(,@01)                           01S0367 01225000
*        RTNCODE = FAILURE;            /*INDICATE ERROR      @ZA01569*/ 01226000
         LA    RTNCODE,4                                        01S0368 01227000
*        DO AREQCTR = ONE TO CVRNREQ;  /*SCAN ALL ENTRIES    @ZA01569*/ 01228000
         LA    AREQCTR,1                                        01S0369 01229000
         B     @DE00369                                         01S0369 01230000
@DL00369 DS    0H                                               01S0370 01231000
*          IF VDEVREQD = ON &          /*REQ REQUIRES UNITS? @ZA01569*/ 01232000
*             VOLALOC = OFF &          /*NOT ALLOCATED YET?  @ZA01569*/ 01233000
*             CVRSKFLG = OFF &         /*ALG DID NOT SKIP?   @ZA01569*/ 01234000
*             CVRNEED > ZERO THEN      /*ARE UNITS STILL REQUIRED       01235000
*                                        FOR THIS REQUEST?   @ZA01569*/ 01236000
         L     @05,CVRVUPTR(,AREQPTR)                           01S0370 01237000
         TM    VDEVREQD(@05),B'00100000'                        01S0370 01238000
         BNO   @RF00370                                         01S0370 01239000
         TM    VOLALOC(@05),B'10000000'                         01S0370 01240000
         BNZ   @RF00370                                         01S0370 01241000
         TM    CVRSKFLG(AREQPTR),B'10000000'                    01S0370 01242000
         BNZ   @RF00370                                         01S0370 01243000
         ICM   @15,3,CVRNEED(AREQPTR)                           01S0370 01244000
         BNP   @RF00370                                         01S0370 01245000
*            DO;                       /*YES-                @ZA01569*/ 01246000
*              SIOTRSNC = NORECODE;    /*SET DD-RELATED CODE FOR        01247000
*                                        UNABLE TO ALLOCATE  @ZA01569*/ 01248000
         L     @05,VOLSIOTP(,@05)                               01S0372 01249000
         MVC   SIOTRSNC(2,@05),@CH00140                         01S0372 01250000
*            END;                      /*                    @ZA01569*/ 01251000
*          ELSE;                       /*                    @ZA01569*/ 01252000
@RF00370 DS    0H                                               01S0375 01253000
*          AREQPTR = AREQPTR + LENGTH(CVRRQLST); /*PICK UP NEXT 01S0375 01254000
*                                        REQUEST LIST ENTRY  @ZA01569*/ 01255000
         AL    AREQPTR,@CF01135                                 01S0375 01256000
*        END;                          /*END SCAN            @ZA01569*/ 01257000
         AH    AREQCTR,@CH00055                                 01S0376 01258000
@DE00369 L     @05,@PC00001                                     01S0376 01259000
         L     @05,ALCWAPTR(,@05)                               01S0376 01260000
         L     @05,ALGTABP(,@05)                                01S0376 01261000
         L     @05,ALGPARMP(,@05)                               01S0376 01262000
         CH    AREQCTR,CVRNREQ(,@05)                            01S0376 01263000
         BNH   @DL00369                                         01S0376 01264000
*        RFY VOLUNTAB BASED(VUPTR);    /*RESET VU TABLE BASE @ZA01569*/ 01265000
*        RFY INDMSIOT BASED(SIOTPTR);  /*RESET SIOT BASE     @ZA01569*/ 01266000
*      END;                                                     01S0379 01267000
*    ELSE                              /*CONSIDER OFFLINES/ALLOCATEDS*/ 01268000
*      DO;                                                      01S0380 01269000
         B     @RC00363                                         01S0380 01270000
@RF00363 DS    0H                                               01S0381 01271000
*        CALL IEFAB486 (ALCWAPTR);                              01S0381 01272000
         L     @02,@PC00001                                     01S0381 01273000
         ST    @02,@AL00001                                     01S0381 01274000
         L     @15,@CV00173                                     01S0381 01275000
         LA    @01,@AL00001                                     01S0381 01276000
         BALR  @14,@15                                          01S0381 01277000
*        RTNCODE = REG15;              /*SAVE THE RETURN CODE        */ 01278000
         LR    RTNCODE,REG15                                    01S0382 01279000
*      END;                                                     01S0383 01280000
*  END;                                                         01S0384 01281000
*ELSE;                                 /*ERROR OR NO REQS TO ALLOCATE*/ 01282000
@RF00361 DS    0H                                               01S0386 01283000
*IF RTNCODE = SUCCESS THEN             /*ANY ERRORS ?                */ 01284000
@RC00361 LTR   RTNCODE,RTNCODE                                  01S0386 01285000
         BNZ   @RF00386                                         01S0386 01286000
*  DO;                                 /*NO, FREE GROUPS NOT NEEDED  */ 01287000
*    DO MASKBYTE = ONE TO GMTENTLN;    /*SET MASK OF GROUPS NOT NEED */ 01288000
         LA    MASKBYTE,1                                       01S0388 01289000
         B     @DE00388                                         01S0388 01290000
@DL00388 DS    0H                                               01S0389 01291000
*      IF INDWAIT = OFF THEN           /*WAIT HOLDING RESOURCES?     */ 01292000
         L     @03,@PC00001                                     01S0389 01293000
         L     @03,ALCWAPTR(,@03)                               01S0389 01294000
         TM    INDWAIT(@03),B'10000000'                         01S0389 01295000
         BNZ   @RF00389                                         01S0389 01296000
*        KEEPMASK(MASKBYTE) = ZERO;    /*NO, NO GROUPS TO KEEP       */ 01297000
         L     @03,WMASKPTR(,@03)                               01S0390 01298000
         SLR   @15,@15                                          01S0390 01299000
         BCTR  @03,0                                            01S0390 01300000
         STC   @15,KEEPMASK(MASKBYTE,@03)                       01S0390 01301000
*        UNLKMASK(MASKBYTE)=VERIFYMK(MASKBYTE) | WAITMASK(MASKBYTE) |   01302000
*        KEEPMASK(MASKBYTE);                                    01S0391 01303000
@RF00389 LA    @03,UNLKMASK-1(MASKBYTE)                         01S0391 01304000
         L     @15,@PC00001                                     01S0391 01305000
         L     @15,ALCWAPTR(,@15)                               01S0391 01306000
         L     @01,WORK3MP(,@15)                                01S0391 01307000
         L     @14,WMASK2P(,@15)                                01S0391 01308000
         ALR   @01,MASKBYTE                                     01S0391 01309000
         BCTR  @01,0                                            01S0391 01310000
         MVC   0(1,@03),VERIFYMK(@01)                           01S0391 01311000
         ALR   @14,MASKBYTE                                     01S0391 01312000
         BCTR  @14,0                                            01S0391 01313000
         OC    0(1,@03),WAITMASK(@14)                           01S0391 01314000
         L     @01,WMASKPTR(,@15)                               01S0391 01315000
         ALR   @01,MASKBYTE                                     01S0391 01316000
         BCTR  @01,0                                            01S0391 01317000
         OC    0(1,@03),KEEPMASK(@01)                           01S0391 01318000
*        UNLKMASK(MASKBYTE)=UNLKMASK(MASKBYTE) && ALLONES;      01S0392 01319000
         LA    @03,UNLKMASK-1(MASKBYTE)                         01S0392 01320000
         XI    0(@03),X'FF'                                     01S0392 01321000
*    END;                                                       01S0393 01322000
         AH    MASKBYTE,@CH00055                                01S0393 01323000
@DE00388 L     @03,@PC00001                                     01S0393 01324000
         L     @03,ALCWAPTR(,@03)                               01S0393 01325000
         L     @03,EDTABPTR(,@03)                               01S0393 01326000
         L     @03,EDTMSKTP(,@03)                               01S0393 01327000
         C     MASKBYTE,GMTENTLN(,@03)                          01S0393 01328000
         BNH   @DL00388                                         01S0393 01329000
*    QMGRRBP->AQMECODE = RLSEFUNC;     /*INDICATE 'RELEASE' FUNC CODE*/ 01330000
         L     @02,@PC00001                                     01S0394 01331000
         L     @02,ALCWAPTR(,@02)                               01S0394 01332000
         L     @15,QMGRRBP(,@02)                                01S0394 01333000
         MVC   AQMECODE(2,@15),@CH00064                         01S0394 01334000
*    QMGRRBP->AQMMASKP=ADDR(UNLKMASK); /*POINT TO GROUPS TO FREE     */ 01335000
         LA    @14,UNLKMASK                                     01S0395 01336000
         ST    @14,AQMMASKP(,@15)                               01S0395 01337000
*    CALL IEFAB4FA (QMGRRBP,EXITPRMP); /*RELEASE GROUPS NOT NEEDED   */ 01338000
         LA    @15,QMGRRBP(,@02)                                01S0396 01339000
         ST    @15,@AL00001                                     01S0396 01340000
         LA    @02,EXITPRMP(,@02)                               01S0396 01341000
         ST    @02,@AL00001+4                                   01S0396 01342000
         L     @15,@CV00174                                     01S0396 01343000
         LA    @01,@AL00001                                     01S0396 01344000
         BALR  @14,@15                                          01S0396 01345000
*    RTNCODE = REG15;                  /*SAVE THE RETURN CODE        */ 01346000
         LR    RTNCODE,REG15                                    01S0397 01347000
*  END;                                                         01S0398 01348000
*ELSE;                                 /*ERROR                       */ 01349000
@RF00386 DS    0H                                               01S0400 01350000
*RETURN CODE(RTNCODE);                 /*RETURN TO CALLER            */ 01351000
         L     @13,4(,@13)                                      01S0400 01352000
         L     @00,@SIZDATD                                     01S0400 01353000
         LR    @01,@10                                          01S0400 01354000
         FSPACE   R,LV=(0),A=(1)                                        01355000
         LR    @15,@03                                          01S0400 01356000
         L     @14,12(,@13)                                     01S0400 01357000
         LM    @00,@12,20(@13)                                  01S0400 01358000
         BR    @14                                              01S0400 01359000
*SCRAMLST: PROC;                                                02S0401 01360000
@EL00001 L     @13,4(,@13)                                      02S0401 01361000
@EF00001 L     @00,@SIZDATD                                     02S0401 01362000
         LR    @01,@10                                          02S0401 01363000
         FSPACE   R,LV=(0),A=(1)                                        01364000
@ER00001 LM    @14,@12,12(@13)                                  02S0401 01365000
         BR    @14                                              02S0401 01366000
SCRAMLST STM   @14,@03,12(@13)                                  02S0401 01367000
         STM   @05,@12,40(@13)                                  02S0401 01368000
*/********************************************************************/ 01369000
*/*                                                                  */ 01370000
*/* SEGMENT NAME - SCRAMLST                                          */ 01371000
*/*                                                                  */ 01372000
*/* DESCRIPTIVE NAME - BUILD LIST OF UCBS WITH MOUNTED VOLUMES       */ 01373000
*/*                                                                  */ 01374000
*/* FUNCTION -                                                       */ 01375000
*/*     THIS ROUTINE DETERMINES ALL THE DIRECT-ACCESS UCBS WHICH     */ 01376000
*/*     HAVE NON-PRIVATE VOLUMES MOUNTED (WHICH COULD BE             */ 01377000
*/*     ELIGIBLE TO ALLOCATE NON-SPECIFIC VOLUME REQS).              */ 01378000
*/*     FOR EACH SUCH UCB FOUND, THIS ROUTINE INCREMENTS A COUNT     */ 01379000
*/*     'MAXMNTS' AND, IF REQUESTED, PUTS A POINTER TO THE UCB IN    */ 01380000
*/*     A CANDIDATE LIST ENTRY.                                      */ 01381000
*/*                                                                  */ 01382000
*/*    OPERATION - ALL DA AND TAPE UCBS ARE LOCATED VIA THE IOS UCB  */ 01383000
*/*                LOOKUP TABLE.                                     */ 01384000
*/*                                                                  */ 01385000
*/* ENTRY - SCRAMLST                                                 */ 01386000
*/*                                                                  */ 01387000
*/*   PURPOSE - (SEE FUNCTION)                                       */ 01388000
*/*                                                                  */ 01389000
*/*   INPUT -                                                        */ 01390000
*/*     ALCWAPTR - PTR TO ALLOCATION WORK AREA , WHICH CONTAINS      */ 01391000
*/*       IOSLUTP  - PTR TO IOS UCB LOOKUP TABLE                     */ 01392000
*/*       VOLUNPTR - PTR TO VOLUNIT TABLE                            */ 01393000
*/*       WAITIGEN - 1 INDICATES REQS MUST WAIT FOR UNALLOCATIONS    */ 01394000
*/*     FILLIST - 1 INDICATES UCB PTRS SHOULD BE PUT IN A CANDIDATE  */ 01395000
*/*               LIST.                                              */ 01396000
*/*     UCBLISTP - PTR TO UCB CANDIDATE LIST                         */ 01397000
*/*                                                                  */ 01398000
*/* EXIT - NORMAL - RETURN TO CALLER                                 */ 01399000
*/*                                                                  */ 01400000
*/*   CONDITIONS - FUNCTION COMPLETED                                */ 01401000
*/*                                                                  */ 01402000
*/*   OUTPUT -                                                       */ 01403000
*/*     .MAXMNTS - NUMBER OF UCB CANDIDATES                          */ 01404000
*/*     .UCB CANDIDATE LIST ENTRIES (PSUCBP) CONTAIN PTRS TO UCBS    */ 01405000
*/*      (IF FILLIST=1)                                              */ 01406000
*/*                                                                  */ 01407000
*/*   RETURN CODES - (NONE)                                          */ 01408000
*/*                                                                  */ 01409000
*/********************************************************************/ 01410000
*ANYCANDS=OFF;                         /*INIT CANDIDATE FOUND   02S0402 01411000
*                                        INDICATORS. USED ONLY IN FIRST 01412000
*                                        CALL TO THIS ROUTINE   02S0402 01413000
*                                                            @Z40FPPJ*/ 01414000
         NI    ANYCANDS,B'01111111'                             02S0402 01415000
*MAXMNTS = ZERO;                       /*ZERO COUNT OF UCB CANDIDATES*/ 01416000
         SLR   MAXMNTS,MAXMNTS                                  02S0403 01417000
*DO LUTNO=ONE BY ONE WHILE((IOSLUT(LUTNO)^=LUTEND)&ANYCANDS=OFF);       01418000
         LA    LUTNO,1                                          02S0404 01419000
         B     @DE00404                                         02S0404 01420000
@DL00404 DS    0H                                               02S0405 01421000
*                                      /*SCAN ALL UCBS       @Z40FPPJ*/ 01422000
*  IF IOSLUT(LUTNO) ^= ZERO THEN       /*IS THERE A UCB ADDRESS ?    */ 01423000
         LR    @15,LUTNO                                        02S0405 01424000
         ALR   @15,@15                                          02S0405 01425000
         L     @14,@PC00001                                     02S0405 01426000
         L     @01,ALCWAPTR(,@14)                               02S0405 01427000
         L     @01,IOSLUTP(,@01)                                02S0405 01428000
         ALR   @01,@15                                          02S0405 01429000
         BCTR  @01,0                                            02S0405 01430000
         BCTR  @01,0                                            02S0405 01431000
         SLR   @15,@15                                          02S0405 01432000
         ICM   @15,3,IOSLUT(@01)                                02S0405 01433000
         LTR   @15,@15                                          02S0405 01434000
         BZ    @RF00405                                         02S0405 01435000
*    DO;                               /*YES, PROCESS ..             */ 01436000
*      UCBPTR = IOSLUT(LUTNO);                                  02S0407 01437000
         LR    UCBPTR,@15                                       02S0407 01438000
*      IF ((UCB3DACC=ON & UCBBSVL=OFF) /*IS UCB SHAREABLE DA ..      */ 01439000
*          | (UCB3TAPE=ON & UCBALOC=OFF)) /*..OR UNALLOCATED TAPE,   */ 01440000
*          & UCBONLI = ON              /*IS THE UCB ONLINE,          */ 01441000
*          & UCBCHGS = OFF             /*NOT PENDING OFFLINE         */ 01442000
*          & UCBNALOC = OFF            /*USEABLE BY ALLOCATION,      */ 01443000
*          & UCBUNLD = OFF             /*NOT PENDING UNLOAD,         */ 01444000
*          & UCBNOTRD = OFF            /*READY                       */ 01445000
*          & UCBMOUNT = OFF            /*WITHOUT A MOUNT PENDING,    */ 01446000
*          & UCBBPRV = OFF             /*NOT PRIVATE,                */ 01447000
*          & (UCBBPUB=ON | UCBBSTR=ON) THEN /*AND HAS USE-ATTRIBUTE? */ 01448000
         TM    UCB3DACC(UCBPTR),B'00100000'                     02S0408 01449000
         BNO   @GL00029                                         02S0408 01450000
         TM    UCBBSVL(UCBPTR),B'10000000'                      02S0408 01451000
         BZ    @GL00028                                         02S0408 01452000
@GL00029 TM    UCB3TAPE(UCBPTR),B'10000000'                     02S0408 01453000
         BNO   @RF00408                                         02S0408 01454000
         TM    UCBALOC(UCBPTR),B'00001000'                      02S0408 01455000
         BNZ   @RF00408                                         02S0408 01456000
@GL00028 TM    UCBONLI(UCBPTR),B'10000000'                      02S0408 01457000
         BNO   @RF00408                                         02S0408 01458000
         TM    UCBCHGS(UCBPTR),B'01000000'                      02S0408 01459000
         BNZ   @RF00408                                         02S0408 01460000
         TM    UCBNALOC(UCBPTR),B'00000100'                     02S0408 01461000
         BNZ   @RF00408                                         02S0408 01462000
         TM    UCBUNLD(UCBPTR),B'00010000'                      02S0408 01463000
         BNZ   @RF00408                                         02S0408 01464000
         TM    UCBNOTRD(UCBPTR),B'01000000'                     02S0408 01465000
         BNZ   @RF00408                                         02S0408 01466000
         TM    UCBMOUNT(UCBPTR),B'10000000'                     02S0408 01467000
         BNZ   @RF00408                                         02S0408 01468000
         TM    UCBBPRV(UCBPTR),B'00010000'                      02S0408 01469000
         BNZ   @RF00408                                         02S0408 01470000
         TM    UCBBPUB(UCBPTR),B'00001100'                      02S0408 01471000
         BZ    @RF00408                                         02S0408 01472000
*        DO;                           /*YES,CONSIDER A POSSIBLE CAND*/ 01473000
*          USEUCBSW = ON;              /*INDICATE AS POSSIBLE CAND   */ 01474000
         OI    USEUCBSW,B'00000010'                             02S0410 01475000
*          IF WAITIGEN = ON THEN       /*ANY REQS WAITING FOR UNALOC?*/ 01476000
         L     @02,@PC00001                                     02S0411 01477000
         L     @02,ALCWAPTR(,@02)                               02S0411 01478000
         TM    WAITIGEN(@02),B'01000000'                        02S0411 01479000
         BNO   @RF00411                                         02S0411 01480000
*            DO;                       /*YES,SEE IF WAIT FOR THIS UCB*/ 01481000
*              VUPTR = VOLUNPTR;       /*POINT TO FIRST VOLUNIT ENTRY*/ 01482000
         L     @15,@PC00001                                     02S0413 01483000
         L     @15,ALCWAPTR(,@15)                               02S0413 01484000
         L     VUPTR,VOLUNPTR(,@15)                             02S0413 01485000
*              DO VUCTR=ONE TO VOLUNSZE/LENGTH(VOLUNTAB); /*SCAN VUS */ 01486000
         LA    VUCTR,1                                          02S0414 01487000
         B     @DE00414                                         02S0414 01488000
@DL00414 DS    0H                                               02S0415 01489000
*                IF VOLALGTP ^= ZERO &                          02S0415 01490000
*                   VOLALGTP->CVRWUCBP=UCBPTR THEN /*WAIT FOR THE UCB*/ 01491000
         L     @07,VOLALGTP(,VUPTR)                             02S0415 01492000
         LTR   @07,@07                                          02S0415 01493000
         BZ    @RF00415                                         02S0415 01494000
         SLR   @15,@15                                          02S0415 01495000
         ICM   @15,3,CVRWUCBP(@07)                              02S0415 01496000
         CR    UCBPTR,@15                                       02S0415 01497000
         BNE   @RF00415                                         02S0415 01498000
*                    USEUCBSW = OFF;   /*YES,DONT USE AS CANDIDATE   */ 01499000
         NI    USEUCBSW,B'11111101'                             02S0416 01500000
*                ELSE;                 /*NOT WAITING FOR THIS UCB    */ 01501000
@RF00415 DS    0H                                               02S0418 01502000
*                VUPTR=VUPTR+LENGTH(VOLUNTAB); /*POINT TO NEXT VU    */ 01503000
         AL    VUPTR,@CF01135                                   02S0418 01504000
*              END;                                             02S0419 01505000
         AH    VUCTR,@CH00055                                   02S0419 01506000
@DE00414 L     @07,@PC00001                                     02S0419 01507000
         L     @07,ALCWAPTR(,@07)                               02S0419 01508000
         L     @00,VOLUNSZE(,@07)                               02S0419 01509000
         SRDA  @00,32                                           02S0419 01510000
         D     @00,@CF01135                                     02S0419 01511000
         CR    VUCTR,@01                                        02S0419 01512000
         BNH   @DL00414                                         02S0419 01513000
*            END;                                               02S0420 01514000
*          ELSE;                       /*NO REQS WAITING FOR UNALLOCS*/ 01515000
@RF00411 DS    0H                                               02S0422 01516000
*          IF USEUCBSW = ON THEN       /*CAN UCB BE A CANDIDATE ?    */ 01517000
         TM    USEUCBSW,B'00000010'                             02S0422 01518000
         BNO   @RF00422                                         02S0422 01519000
*            DO;                       /*YES, PROCESS                */ 01520000
*              MAXMNTS = MAXMNTS + ONE; /*INCREMENT COUNT OF CAND    */ 01521000
         AH    MAXMNTS,@CH00055                                 02S0424 01522000
*              IF FILLIST = ON         /*SHOULD LIST ENTRY BE FILLED?*/ 01523000
*                  & MAXMNTS * TWO < UCBSLGN THEN               02S0425 01524000
         TM    FILLIST,B'01000000'                              02S0425 01525000
         BNO   @RF00425                                         02S0425 01526000
         LR    @02,MAXMNTS                                      02S0425 01527000
         ALR   @02,@02                                          02S0425 01528000
         C     @02,UCBSLGN                                      02S0425 01529000
         BNL   @RF00425                                         02S0425 01530000
*                DO;                   /*YES, PUT UCBPTR IN LIST     */ 01531000
*                  PSUCBP(MAXMNTS) = UCBPTR;                    02S0427 01532000
         L     @01,UCBLISTP                                     02S0427 01533000
         BCTR  @01,0                                            02S0427 01534000
         BCTR  @01,0                                            02S0427 01535000
         STH   UCBPTR,PSUCBP(@02,@01)                           02S0427 01536000
*                END;                                           02S0428 01537000
*              ELSE                    /*DONT PUT UCBPTR TO THE LIST */ 01538000
*                ANYCANDS=ON;          /*INDICATE AT LEAST ON   02S0429 01539000
*                                        CANDIDATE EXISTS    @Z40FPPJ*/ 01540000
         B     @RC00425                                         02S0429 01541000
@RF00425 OI    ANYCANDS,B'10000000'                             02S0429 01542000
*            END;                                               02S0430 01543000
*          ELSE;                       /*UCB IS NOT A CANDIDATE      */ 01544000
@RF00422 DS    0H                                               02S0432 01545000
*        END;                                                   02S0432 01546000
*      ELSE;                           /*UCB CANNOT BE A CANDIDATE   */ 01547000
@RF00408 DS    0H                                               02S0434 01548000
*    END;                                                       02S0434 01549000
*  ELSE;                               /*ZERO UCB POINTER            */ 01550000
@RF00405 DS    0H                                               02S0436 01551000
*END;                                                           02S0436 01552000
@RC00405 AH    LUTNO,@CH00055                                   02S0436 01553000
@DE00404 LR    @15,LUTNO                                        02S0436 01554000
         ALR   @15,@15                                          02S0436 01555000
         L     @14,@PC00001                                     02S0436 01556000
         L     @01,ALCWAPTR(,@14)                               02S0436 01557000
         L     @01,IOSLUTP(,@01)                                02S0436 01558000
         ALR   @01,@15                                          02S0436 01559000
         BCTR  @01,0                                            02S0436 01560000
         BCTR  @01,0                                            02S0436 01561000
         CLC   IOSLUT(2,@01),LUTEND                             02S0436 01562000
         BE    @DC00404                                         02S0436 01563000
         TM    ANYCANDS,B'10000000'                             02S0436 01564000
         BZ    @DL00404                                         02S0436 01565000
@DC00404 DS    0H                                               02S0437 01566000
*RETURN;                               /*RETURN TO CALLER            */ 01567000
@EL00002 DS    0H                                               02S0437 01568000
@EF00002 DS    0H                                               02S0437 01569000
@ER00002 LM    @14,@03,12(@13)                                  02S0437 01570000
         LM    @05,@12,40(@13)                                  02S0437 01571000
         BR    @14                                              02S0437 01572000
*END SCRAMLST;                                                  02S0438 01573000
*DAFERLST : PROC;                                               02S0439 01574000
DAFERLST STM   @14,@03,12(@13)                                  02S0439 01575000
         STM   @05,@12,40(@13)                                  02S0439 01576000
*/********************************************************************/ 01577000
*/*                                                                  */ 01578000
*/* SEGMENT NAME - DAFERLST                                          */ 01579000
*/*                                                                  */ 01580000
*/* DESCRIPTIVE NAME - BUILD LIST OF DA UCBS WITH MOUNTED VOLS       */ 01581000
*/*                                                          @Z40FPPJ*/ 01582000
*/*                                                                  */ 01583000
*/* FUNCTION -                                                       */ 01584000
*/*     THIS ROUTINE DETERMINES ALL THE DIRECT-ACCESS UCBS WHICH     */ 01585000
*/*     HAVE NON-PRIVATE, SHAREABLE VOLUMES MOUNTED (WHICH WOULD BE  */ 01586000
*/*     ELIGIBLE TO ALLOCATE NON-SPECIFIC VOLUME REQS).              */ 01587000
*/*     FOR EACH SUCH UCB FOUND, THIS ROUTINE INCREMENTS A COUNT     */ 01588000
*/*     'MAXMNTS' AND , PUTS A POINTER TO THE UCB IN         @Z40FPPJ*/ 01589000
*/*     A CANDIDATE LIST ENTRY.                                      */ 01590000
*/*                                                                  */ 01591000
*/*   OPERATION - ALL DA UCBS ARE LOCATED VIA THE 'SYSALLDA' LOOKUP  */ 01592000
*/*               VALUE ENTRY IN THE EDT.                            */ 01593000
*/*                                                                  */ 01594000
*/* ENTRY - DAFERLST                                                 */ 01595000
*/*                                                                  */ 01596000
*/*   PURPOSE - (SEE FUNCTION)                                       */ 01597000
*/*                                                                  */ 01598000
*/*   INPUT -                                                        */ 01599000
*/*     ALCWAPTR - PTR TO ALLOCATION WORK AREA , WHICH CONTAINS      */ 01600000
*/*       EDTABPTR - PTR TO ELIGIBLE DEVICES TABLE (EDT)             */ 01601000
*/*       IOSLUTP  - PTR TO IOS UCB LOOKUP TABLE                     */ 01602000
*/*       VOLUNPTR - PTR TO VOLUNIT TABLE                            */ 01603000
*/*       WAITIGEN - 1 INDICATES REQS MUST WAIT FOR UNALLOCATIONS    */ 01604000
*/*       ALCNUCBS - NUMBER OF UCBS IN SYSTEM                @Z40FPPJ*/ 01605000
*/*     FILLIST - 1 INDICATES UCB PTRS SHOULD BE PUT IN A CANDIDATE  */ 01606000
*/*               LIST.                                              */ 01607000
*/*     UCBLISTP - PTR TO UCB CANDIDATE LIST                         */ 01608000
*/*                                                                  */ 01609000
*/* EXIT - NORMAL - RETURN TO CALLER                                 */ 01610000
*/*                                                                  */ 01611000
*/*   CONDITIONS - FUNCTION COMPLETED                                */ 01612000
*/*                                                                  */ 01613000
*/*   OUTPUT -                                                       */ 01614000
*/*     .MAXMNTS - NUMBER OF UCB CANDIDATES                          */ 01615000
*/*     .UCB CANDIDATE LIST ENTRIES (PSUCBP) CONTAIN PTRS TO UCBS    */ 01616000
*/*      (IF FILLIST=1)                                              */ 01617000
*/*                                                                  */ 01618000
*/*   RETURN CODES - (NONE)                                          */ 01619000
*/*                                                                  */ 01620000
*/********************************************************************/ 01621000
*LUVPTR = EDTLUVSP + LENGTH(LUVHDR)    /*POINT TO 'SYSALLDA' ENTRY   */ 01622000
*                  + ((LUVENTNO-1)*LUVENTLN);                   02S0440 01623000
         L     @15,@PC00001                                     02S0440 01624000
         L     @01,ALCWAPTR(,@15)                               02S0440 01625000
         L     @01,EDTABPTR(,@01)                               02S0440 01626000
         L     @15,EDTLUVSP(,@01)                               02S0440 01627000
         LA    LUVPTR,8                                         02S0440 01628000
         ALR   LUVPTR,@15                                       02S0440 01629000
         L     @01,LUVENTNO(,@15)                               02S0440 01630000
         BCTR  @01,0                                            02S0440 01631000
         M     @00,LUVENTLN(,@15)                               02S0440 01632000
         ALR   LUVPTR,@01                                       02S0440 01633000
*MAXMNTS = ZERO;                       /*ZERO COUNT OF UCB CANDIDATES*/ 01634000
         SLR   MAXMNTS,MAXMNTS                                  02S0441 01635000
*GENPTR = LUVGENP;                     /*POINT TO FIRST GEN ENTRY    */ 01636000
         L     GENPTR,LUVGENP(,LUVPTR)                          02S0442 01637000
*DO GENCTR  = ONE TO LUVGENNO;         /*SCAN ALL GENS FOR SYSALLDA  */ 01638000
         LA    @09,1                                            02S0443 01639000
         B     @DE00443                                         02S0443 01640000
@DL00443 DS    0H                                               02S0444 01641000
*  GRPTABP = GENGRPTR;                 /*POINT TO FIRST GROUP ENTRY  */ 01642000
         L     GRPTABP,GENGRPTR(,GENPTR)                        02S0444 01643000
*  DO GRPCTR = ONE TO GENGRPNO;        /*SCAN ALL GROUP ENTRIES      */ 01644000
         LA    @09,1                                            02S0445 01645000
         B     @DE00445                                         02S0445 01646000
@DL00445 DS    0H                                               02S0446 01647000
*    DO UCBCTR = ONE TO GRPUCBNO;      /*SCAN ALL UCBS IN THE GROUP  */ 01648000
         LA    UCBCTR,1                                         02S0446 01649000
         B     @DE00446                                         02S0446 01650000
@DL00446 DS    0H                                               02S0447 01651000
*      UCBPTR = IOSLUT(EUCBTPOS(UCBCTR)+1); /*GET ADDRESSABLE TO UCB */ 01652000
         LR    @06,UCBCTR                                       02S0447 01653000
         ALR   @06,@06                                          02S0447 01654000
         L     @01,GRPTR(,GRPTABP)                              02S0447 01655000
         L     @01,GRPUCBP(,@01)                                02S0447 01656000
         BCTR  @01,0                                            02S0447 01657000
         BCTR  @01,0                                            02S0447 01658000
         LH    @06,EUCBTPOS(@06,@01)                            02S0447 01659000
         ALR   @06,@06                                          02S0447 01660000
         L     @15,@PC00001                                     02S0447 01661000
         L     @15,ALCWAPTR(,@15)                               02S0447 01662000
         L     @01,IOSLUTP(,@15)                                02S0447 01663000
         ALR   @01,@06                                          02S0447 01664000
         SLR   UCBPTR,UCBPTR                                    02S0447 01665000
         ICM   UCBPTR,3,IOSLUT(@01)                             02S0447 01666000
*      IF UCBONLI = ON                 /*IS THE UCB ONLINE,          */ 01667000
*          & UCBCHGS = OFF             /*NOT PENDING OFFLINE,        */ 01668000
*          & UCBNALOC = OFF            /*USEABLE BY ALLOCATION,      */ 01669000
*          & UCBUNLD = OFF             /*NOT PENDING UNLOAD,         */ 01670000
*          & UCBNOTRD = OFF            /*READY                       */ 01671000
*          & UCBMOUNT = OFF            /*WITHOUT A MOUNT PENDING,    */ 01672000
*          & UCBBPRV = OFF             /*NOT PRIVATE,                */ 01673000
*          & (UCBBPUB = ON | UCBBSTR = ON) /*HAS A USE ATTRIBUTE,    */ 01674000
*          & UCBBSVL = OFF THEN        /*AND SHAREABLE ?             */ 01675000
         TM    UCBONLI(UCBPTR),B'10000000'                      02S0448 01676000
         BNO   @RF00448                                         02S0448 01677000
         TM    UCBCHGS(UCBPTR),B'01000000'                      02S0448 01678000
         BNZ   @RF00448                                         02S0448 01679000
         TM    UCBNALOC(UCBPTR),B'00000100'                     02S0448 01680000
         BNZ   @RF00448                                         02S0448 01681000
         TM    UCBUNLD(UCBPTR),B'00010000'                      02S0448 01682000
         BNZ   @RF00448                                         02S0448 01683000
         TM    UCBNOTRD(UCBPTR),B'01000000'                     02S0448 01684000
         BNZ   @RF00448                                         02S0448 01685000
         TM    UCBMOUNT(UCBPTR),B'10000000'                     02S0448 01686000
         BNZ   @RF00448                                         02S0448 01687000
         TM    UCBBPRV(UCBPTR),B'00010000'                      02S0448 01688000
         BNZ   @RF00448                                         02S0448 01689000
         TM    UCBBPUB(UCBPTR),B'00001100'                      02S0448 01690000
         BZ    @RF00448                                         02S0448 01691000
         TM    UCBBSVL(UCBPTR),B'10000000'                      02S0448 01692000
         BNZ   @RF00448                                         02S0448 01693000
*        DO;                           /*YES,CONSIDER A POSSIBLE CAND*/ 01694000
*          USEUCBSW = ON;              /*INDICATE AS POSSIBLE CAND   */ 01695000
         OI    USEUCBSW,B'00000010'                             02S0450 01696000
*          IF WAITIGEN = ON THEN       /*ANY REQS WAITING FOR UNALOC?*/ 01697000
         TM    WAITIGEN(@15),B'01000000'                        02S0451 01698000
         BNO   @RF00451                                         02S0451 01699000
*            DO;                       /*YES,SEE IF WAIT FOR THIS UCB*/ 01700000
*              VUPTR = VOLUNPTR;       /*POINT TO FIRST VOLUNIT ENTRY*/ 01701000
         L     VUPTR,VOLUNPTR(,@15)                             02S0453 01702000
*              DO VUCTR=ONE TO VOLUNSZE/LENGTH(VOLUNTAB); /*SCAN VUS */ 01703000
         LA    VUCTR,1                                          02S0454 01704000
         B     @DE00454                                         02S0454 01705000
@DL00454 DS    0H                                               02S0455 01706000
*                IF VOLALGTP ^= ZERO &                          02S0455 01707000
*                   VOLALGTP->CVRWUCBP=UCBPTR THEN /*WAIT FOR THE UCB*/ 01708000
         L     @15,VOLALGTP(,VUPTR)                             02S0455 01709000
         LTR   @15,@15                                          02S0455 01710000
         BZ    @RF00455                                         02S0455 01711000
         SLR   @14,@14                                          02S0455 01712000
         ICM   @14,3,CVRWUCBP(@15)                              02S0455 01713000
         CR    UCBPTR,@14                                       02S0455 01714000
         BNE   @RF00455                                         02S0455 01715000
*                    USEUCBSW = OFF;   /*YES,DONT USE AS CANDIDATE   */ 01716000
         NI    USEUCBSW,B'11111101'                             02S0456 01717000
*                ELSE;                 /*NOT WAITING FOR THIS UCB    */ 01718000
@RF00455 DS    0H                                               02S0458 01719000
*                VUPTR=VUPTR+LENGTH(VOLUNTAB); /*POINT TO NEXT VU    */ 01720000
         AL    VUPTR,@CF01135                                   02S0458 01721000
*              END;                                             02S0459 01722000
         AH    VUCTR,@CH00055                                   02S0459 01723000
@DE00454 L     @15,@PC00001                                     02S0459 01724000
         L     @01,ALCWAPTR(,@15)                               02S0459 01725000
         L     @00,VOLUNSZE(,@01)                               02S0459 01726000
         SRDA  @00,32                                           02S0459 01727000
         D     @00,@CF01135                                     02S0459 01728000
         CR    VUCTR,@01                                        02S0459 01729000
         BNH   @DL00454                                         02S0459 01730000
*            END;                                               02S0460 01731000
*          ELSE;                       /*NO REQS WAITING FOR UNALLOCS*/ 01732000
@RF00451 DS    0H                                               02S0462 01733000
*          IF USEUCBSW = ON THEN       /*CAN UCB BE A CANDIDATE ?    */ 01734000
         TM    USEUCBSW,B'00000010'                             02S0462 01735000
         BNO   @RF00462                                         02S0462 01736000
*            DO;                       /*YES, PROCESS                */ 01737000
*              MAXMNTS = MAXMNTS + ONE; /*INCREMENT COUNT OF CAND    */ 01738000
         AH    MAXMNTS,@CH00055                                 02S0464 01739000
*              PSUCBP(MAXMNTS) = UCBPTR;                        02S0465 01740000
         LR    @06,MAXMNTS                                      02S0465 01741000
         ALR   @06,@06                                          02S0465 01742000
         L     @02,UCBLISTP                                     02S0465 01743000
         BCTR  @02,0                                            02S0465 01744000
         BCTR  @02,0                                            02S0465 01745000
         STH   UCBPTR,PSUCBP(@06,@02)                           02S0465 01746000
*            END;                                               02S0466 01747000
*          ELSE;                       /*UCB IS NOT A CANDIDATE      */ 01748000
@RF00462 DS    0H                                               02S0468 01749000
*        END;                                                   02S0468 01750000
*      ELSE;                           /*UCB CANNOT BE A CANDIDATE   */ 01751000
@RF00448 DS    0H                                               02S0470 01752000
*    END;                                                       02S0470 01753000
         AH    UCBCTR,@CH00055                                  02S0470 01754000
@DE00446 L     @06,GRPTR(,GRPTABP)                              02S0470 01755000
         C     UCBCTR,GRPUCBNO(,@06)                            02S0470 01756000
         BNH   @DL00446                                         02S0470 01757000
*    GRPTABP = GRPTABP + LENGTH(GRPTRTAB); /*POINT TO NEXT GROUP ENT */ 01758000
         AH    GRPTABP,@CH00064                                 02S0471 01759000
*  END;                                                         02S0472 01760000
         LA    @09,1                                            02S0472 01761000
         AL    @09,GRPCTR                                       02S0472 01762000
@DE00445 ST    @09,GRPCTR                                       02S0472 01763000
         C     @09,GENGRPNO(,GENPTR)                            02S0472 01764000
         BNH   @DL00445                                         02S0472 01765000
*  GENPTR = GENPTR + LENGTH(GENENTRY); /*POINT TO NEXT GENERIC ENTRY */ 01766000
         AH    GENPTR,@CH00033                                  02S0473 01767000
*END;                                                           02S0474 01768000
         LA    @09,1                                            02S0474 01769000
         AL    @09,GENCTR                                       02S0474 01770000
@DE00443 ST    @09,GENCTR                                       02S0474 01771000
         C     @09,LUVGENNO(,LUVPTR)                            02S0474 01772000
         BNH   @DL00443                                         02S0474 01773000
*RETURN;                               /*RETURN TO CALLER            */ 01774000
@EL00003 DS    0H                                               02S0475 01775000
@EF00003 DS    0H                                               02S0475 01776000
@ER00003 LM    @14,@03,12(@13)                                  02S0475 01777000
         LM    @05,@12,40(@13)                                  02S0475 01778000
         BR    @14                                              02S0475 01779000
*END DAFERLST;                                                  02S0476 01780000
*SCRATMNT: PROC;                       /*                    @ZA03616*/ 01781000
SCRATMNT STM   @14,@02,@SA00004                                 02S0477 01782000
         STM   @04,@12,@SA00004+20                              02S0477 01783000
*/********************************************************************/ 01784000
*/*                                                                  */ 01785000
*/* SEGMENT NAME - SCRATMNT                                          */ 01786000
*/*                                                                  */ 01787000
*/* DESCRIPTIVE NAME - ALLOCATE SECONDARY SCRATCH REQUESTS           */ 01788000
*/*                                                                  */ 01789000
*/* FUNCTION -                                                       */ 01790000
*/*     THIS ROUTINE BUILDS A LIST OF ALL DIRECT-ACCESS AND TAPE     */ 01791000
*/*     UCBS WITH NON-PRIVATE VOLUMES MOUNTED AND CALLS IEFAB436     */ 01792000
*/*     TO ALLOCATE SECONDARY SCRATCH REQUESTS TO THESE MOUNTED      */ 01793000
*/*     VOLUMES.                                                     */ 01794000
*/*                                                                  */ 01795000
*/*   OPERATION - (THE OPERATION IS DOCUMENTED BY THE CODE ITSELF).  */ 01796000
*/*                                                                  */ 01797000
*/* ENTRY - SCRATMNT                                                 */ 01798000
*/*                                                                  */ 01799000
*/*   PURPOSE - (SEE FUNCTION)                                       */ 01800000
*/*                                                                  */ 01801000
*/*   INPUT -                                                        */ 01802000
*/*       ALCWAPTR - PTR TO ALLOCATION WORK AREA, WHICH CONTAINS     */ 01803000
*/*         IOSLUTP - PTR TO IOS UCB LOOKUP TABLE                    */ 01804000
*/*         FAILRSCP - PTR TO STEP REASON CODE AREA                  */ 01805000
*/*         ALCNUCBS - NUMBER OF UCBS IN SYSTEM              @Z40FPPJ*/ 01806000
*/*                                                                  */ 01807000
*/* EXIT - NORMAL - RETURN TO CALLER                                 */ 01808000
*/*                                                                  */ 01809000
*/*   CONDITIONS - FUNCTION COMPLETED SUCCESSFULLY                   */ 01810000
*/*                                                                  */ 01811000
*/*   OUTPUT -                                                       */ 01812000
*/*       GENERAL: SOME REQS MAY BE ALLOCATED BY IEFAB436            */ 01813000
*/*                                                                  */ 01814000
*/*   RETURN CODES - RTNCODE 0                                       */ 01815000
*/*                                                                  */ 01816000
*/* EXIT - ERROR - SCRATMNT                                          */ 01817000
*/*                                                                  */ 01818000
*/*   CONDITIONS - GETMAIN ERROR                                     */ 01819000
*/*                                                                  */ 01820000
*/*   OUTPUT - STEP REASON CODE 'REASONCD' SET TO 2                  */ 01821000
*/*                                                                  */ 01822000
*/*   RETURN CODES - RTNCODE SET TO 4                                */ 01823000
*/*                                                                  */ 01824000
*/* EXIT - ERROR - SCRATMNT                                          */ 01825000
*/*                                                                  */ 01826000
*/*   CONDITIONS - ERROR DETECTED BY MODULE IEFAB436                 */ 01827000
*/*                                                                  */ 01828000
*/*   OUTPUT - STEP- OR DD-RELATED ERROR CODE SET BY IEFAB436        */ 01829000
*/*                                                                  */ 01830000
*/*   RETURN CODES - RTNCODE SET NON-ZERO                            */ 01831000
*/*                                                                  */ 01832000
*/********************************************************************/ 01833000
*FILLIST = OFF;                        /*INDICATE 'COUNT CANDIDATES' */ 01834000
         NI    FILLIST,B'10111111'                              02S0478 01835000
*CALL SCRAMLST;                        /*DETERMINE NUMBER OF CAND    */ 01836000
         BAL   @14,SCRAMLST                                     02S0479 01837000
*IF ANYCANDS = ON THEN                 /*ANY CANDIDATES FOR IEFAB436 */ 01838000
         TM    ANYCANDS,B'10000000'                             02S0480 01839000
         BNO   @RF00480                                         02S0480 01840000
*  DO;                                 /*YES, PROCESS                */ 01841000
*    UCBSLGN = (ALCNUCBS * TWO) + TWO; /*CALCULATE SIZE OF UCB LIST  */ 01842000
         L     @08,@PC00001                                     02S0482 01843000
         L     @08,ALCWAPTR(,@08)                               02S0482 01844000
         L     @08,ALCNUCBS(,@08)                               02S0482 01845000
         ALR   @08,@08                                          02S0482 01846000
         AH    @08,@CH00134                                     02S0482 01847000
         ST    @08,UCBSLGN                                      02S0482 01848000
*     /* ?GETSTORG (SUBP,UCBSLGN,UCBLISTP);*/                   02S0483 01849000
*       RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/           02S0483 01850000
*       GTSTR0 = UCBSLGN; /* SET AMOUNT*/                       02S0484 01851000
         LR    GTSTR0,@08                                       02S0484 01852000
*       GTSTR2 = SUBP; /* SET SUBPOOL*/                         02S0485 01853000
         LA    GTSTR2,230                                       02S0485 01854000
*       GENERATE CODE;                                          02S0486 01855000
         GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN                           01856000
*       GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/           02S0487 01857000
         LR    GTSTRTCD,GTSTR15                                 02S0487 01858000
*       UCBLISTP = GTSTR1; /* ADDR OF GOTN STORG*/              02S0488 01859000
         ST    GTSTR1,UCBLISTP                                  02S0488 01860000
*       RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */            02S0489 01861000
*       IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */           02S0490 01862000
         LTR   GTSTRTCD,GTSTRTCD                                02S0490 01863000
         BNZ   @RF00490                                         02S0490 01864000
*         DO;               /* YES, CLEAR STORAGE.*/            02S0491 01865000
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   02S0492 01866000
*                              GTSTR7,GTSTR8) RSTD;             02S0492 01867000
*           GTSTR4 = UCBLISTP; /*STORG PTR*/                    02S0493 01868000
         L     @03,UCBLISTP                                     02S0493 01869000
         LR    GTSTR4,@03                                       02S0493 01870000
*           GTSTR5 = UCBSLGN; /*STORG AMNT*/                    02S0494 01871000
         L     GTSTR5,UCBSLGN                                   02S0494 01872000
*           GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/           02S0495 01873000
         SLR   GTSTR7,GTSTR7                                    02S0495 01874000
*           IF SUBP = GTST253 THEN                              02S0496 01875000
         B     @RF00496                                         02S0496 01876000
*          GEN                                                  02S0497 01877000
*       (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);       02S0497 01878000
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8                 01879000
*           GEN REFS(GTSTR4,GTSTR6);                            02S0498 01880000
@RF00496 DS    0H                                               02S0498 01881000
              MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG                    01882000
*           IF SUBP = GTST253 THEN                              02S0499 01883000
         B     @RF00499                                         02S0499 01884000
*             GEN (MODESET KEYADDR=(2));                        02S0500 01885000
         MODESET KEYADDR=(2)                                            01886000
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   02S0501 01887000
*                              GTSTR7,GTSTR8) UNRSTD;           02S0501 01888000
@RF00499 DS    0H                                               02S0502 01889000
*         END;       /* STORAGE CLEARING COMPLETED */           02S0502 01890000
*       ELSE                                                    02S0503 01891000
*       UCBLISTP= 0;   /* CLEAR RETURN ADDR. */                 02S0503 01892000
         B     @RC00490                                         02S0503 01893000
@RF00490 SLR   @08,@08                                          02S0503 01894000
         ST    @08,UCBLISTP                                     02S0503 01895000
*       GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */           02S0504 01896000
@RC00490 LR    GTSTR15,GTSTRTCD                                 02S0504 01897000
*                                      /* RESTORE LIST PRINT STATUS  */ 01898000
*/*GET CORE FOR LIST           */                               02S0505 01899000
*    RTNCODE = REG15;                  /*SAVE THE RETURN CODE        */ 01900000
         LR    RTNCODE,REG15                                    02S0505 01901000
*    IF RTNCODE = SUCCESS THEN         /*ANY ERRORS ?                */ 01902000
         LTR   RTNCODE,RTNCODE                                  02S0506 01903000
         BNZ   @RF00506                                         02S0506 01904000
*      DO;                             /*NO, PROCESS                 */ 01905000
*        FILLIST = ON;                 /*INDICATE 'FILL IN LIST' FUNC*/ 01906000
         OI    FILLIST,B'01000000'                              02S0508 01907000
*        CALL SCRAMLST;                /*FILL IN CANDIDATE LIST      */ 01908000
         BAL   @14,SCRAMLST                                     02S0509 01909000
*        PSUCBP(MAXMNTS + ONE) = ZERO; /*INDICATE LAST LIST ENTRY    */ 01910000
         LR    @05,MAXMNTS                                      02S0510 01911000
         ALR   @05,@05                                          02S0510 01912000
         L     @01,UCBLISTP                                     02S0510 01913000
         ALR   @01,@05                                          02S0510 01914000
         SLR   @05,@05                                          02S0510 01915000
         STH   @05,PSUCBP(,@01)                                 02S0510 01916000
*        FUNCMAP1 = FUNCMAP1 && FUNCMAP1; /*CLR FUNC MAP     @ZA03616*/ 01917000
         XC    FUNCMAP1(1),FUNCMAP1                             02S0511 01918000
*        PUBSTOR = ON;                 /*PUB TO PUB & STRG   @ZA03616*/ 01919000
*        MOUNTED = ON;                 /*ALLOC TO MTDS       @ZA03616*/ 01920000
         OI    PUBSTOR,B'00101000'                              02S0513 01921000
*        IF DOPRTAL = ON THEN          /*DO SECONDARY ONLY   @ZA03616*/ 01922000
         TM    DOPRTAL,B'00001000'                              02S0514 01923000
         BNO   @RF00514                                         02S0514 01924000
*          PARTALOC = ON;              /*TELL 436            @ZA03616*/ 01925000
         OI    PARTALOC,B'00000001'                             02S0515 01926000
*        CALL IEFAB436 (ALCWAPTR,UCBLISTP,ADDR(FUNCLIST));      02S0516 01927000
@RF00514 L     @02,@PC00001                                     02S0516 01928000
         ST    @02,@AL00001                                     02S0516 01929000
         LA    @02,UCBLISTP                                     02S0516 01930000
         ST    @02,@AL00001+4                                   02S0516 01931000
         LA    @02,FUNCLIST                                     02S0516 01932000
         ST    @02,@TF00001                                     02S0516 01933000
         LA    @02,@TF00001                                     02S0516 01934000
         ST    @02,@AL00001+8                                   02S0516 01935000
         L     @15,@CV00167                                     02S0516 01936000
         LA    @01,@AL00001                                     02S0516 01937000
         BALR  @14,@15                                          02S0516 01938000
*        RTNCODE = REG15;              /*SAVE THE RETURN CODE        */ 01939000
         LR    RTNCODE,REG15                                    02S0517 01940000
*        RFY (REG0,REG1) RSTD;                                  02S0518 01941000
*        REG0 = UCBSLGN;               /*LENGTH OF UCB LIST          */ 01942000
         L     REG0,UCBSLGN                                     02S0519 01943000
*        REG0 = REG0 | SUBP230;                                 02S0520 01944000
         O     REG0,@CF00158                                    02S0520 01945000
*        REG1 = UCBLISTP;              /*PTR TO UCB LIST             */ 01946000
         L     REG1,UCBLISTP                                    02S0521 01947000
*        GEN ( FREEMAIN R,LV=(0),A=(1)); /*FREE THE UCB LIST         */ 01948000
          FREEMAIN R,LV=(0),A=(1)                                       01949000
*        RFY (REG0,REG1) UNRSTD;                                02S0523 01950000
*      END;                                                     02S0524 01951000
*    ELSE                              /*GETMAIN ERROR               */ 01952000
*      DO;                                                      02S0525 01953000
         B     @RC00506                                         02S0525 01954000
@RF00506 DS    0H                                               02S0526 01955000
*        REASONCD = GETMNERR;          /*SET GETMAIN ERROR REASON CD */ 01956000
         L     @02,@PC00001                                     02S0526 01957000
         L     @02,ALCWAPTR(,@02)                               02S0526 01958000
         L     @02,FAILRSCP(,@02)                               02S0526 01959000
         MVC   REASONCD(2,@02),@CH00134                         02S0526 01960000
*      END;                                                     02S0527 01961000
*  END;                                                         02S0528 01962000
*ELSE;                                 /*NO CANDIDATES FOR IEFAB436  */ 01963000
@RF00480 DS    0H                                               02S0530 01964000
*END SCRATMNT;                         /*                    @ZA03616*/ 01965000
@EL00004 DS    0H                                               02S0530 01966000
@EF00004 DS    0H                                               02S0530 01967000
@ER00004 LM    @14,@02,@SA00004                                 02S0530 01968000
         LM    @04,@12,@SA00004+20                              02S0530 01969000
         BR    @14                                              02S0530 01970000
*END IEFAB485                          /*END OF RECOVERY ALLOCATION  */ 01971000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01972000
*/*%INCLUDE SYSLIB  (A485SPEC)                                        * 01973000
*/*%INCLUDE SYSLIB  (A485DATA)                                        * 01974000
*/*%INCLUDE SYSLIB  (IEFZB421)                                        * 01975000
*/*%INCLUDE SYSLIB  (IEFZB422)                                        * 01976000
*/*%INCLUDE SYSLIB  (IEFZB423)                                        * 01977000
*/*%INCLUDE SYSLIB  (IEFZB425)                                        * 01978000
*/*%INCLUDE SYSLIB  (IEFZB426)                                        * 01979000
*/*%INCLUDE SYSLIB  (IEFZB427)                                        * 01980000
*/*%INCLUDE SYSLIB  (IEFZB428)                                        * 01981000
*/*%INCLUDE SYSLIB  (IEFZB431)                                        * 01982000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                        * 01983000
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        * 01984000
*/*%INCLUDE SYSLIB  (TAPEVALI)                                        * 01985000
*/*%INCLUDE SYSLIB  (TVALSPEC)                                        * 01986000
*/*%INCLUDE SYSLIB  (ALOCMTDS)                                        * 01987000
*/*%INCLUDE SYSLIB  (ALOCSPEC)                                        * 01988000
*/*%INCLUDE SYSLIB  (DADAFFER)                                        * 01989000
*/*%INCLUDE SYSLIB  (DADASPEC)                                        * 01990000
*/*%INCLUDE SYSLIB  (DAFERALC)                                        * 01991000
*/*%INCLUDE SYSLIB  (DALCSPEC)                                        * 01992000
*/*%INCLUDE SYSLIB  (SCRATALG)                                        * 01993000
*/*%INCLUDE SYSLIB  (SALGSPEC)                                        * 01994000
*/*%INCLUDE SYSLIB  (PICSCRAG)                                        * 01995000
*/*%INCLUDE SYSLIB  (PICKSPEC)                                        * 01996000
*/*%INCLUDE SYSLIB  (SCRAMLST)                                        * 01997000
*/*%INCLUDE SYSLIB  (SLSTSPEC)                                        * 01998000
*/*%INCLUDE SYSLIB  (DAFERLST)                                        * 01999000
*/*%INCLUDE SYSLIB  (DLSTSPEC)                                        * 02000000
*/*%INCLUDE SYSLIB  (SCRATMNT)                                        * 02001000
*/*%INCLUDE SYSLIB  (SMNTSPEC)                                        * 02002000
*;                                                              01S0531 02003000
@DATA    DS    0H                                                       02004000
@CH00055 DC    H'1'                                                     02005000
@CH00134 DC    H'2'                                                     02006000
@CH00064 DC    H'4'                                                     02007000
@CH00140 DC    H'6'                                                     02008000
@CH00033 DC    H'12'                                                    02009000
@CH00138 DC    H'56'                                                    02010000
@SX01149 XC    WAITMASK(0,@01),WAITMASK(@01)                            02011000
@DATD    DSECT                                                          02012000
         DS    0F                                                       02013000
@SA00001 DS    18F                                                      02014000
@PC00001 DS    1F                                                       02015000
@SA00004 DS    14F                                                      02016000
@AL00001 DS    3A                                                       02017000
@TF00001 DS    F                                                        02018000
IEFAB485 CSECT                                                          02019000
         DS    0F                                                       02020000
@CF01135 DC    F'28'                                                    02021000
@CH01135 EQU   @CF01135+2                                               02022000
@CF00158 DC    XL4'E6000000'                                            02023000
@DATD    DSECT                                                          02024000
         DS    0D                                                       02025000
UCBLISTP DS    A                                                        02026000
VMVREQBP DS    A                                                        02027000
GENCTR   DS    F                                                        02028000
GRPCTR   DS    F                                                        02029000
EDTPTR   DS    A                                                        02030000
GRPPTR   DS    A                                                        02031000
EDLGNTP  DS    A                                                        02032000
EDLUCBLP DS    A                                                        02033000
ALCBITS  DS    BL1                                                      02034000
         ORG   ALCBITS                                                  02035000
CALLREAR DS    BL1                                                      02036000
DONESW   EQU   ALCBITS+0                                                02037000
NEED433  EQU   ALCBITS+0                                                02038000
NEED436  EQU   ALCBITS+0                                                02039000
DOPRTAL  EQU   ALCBITS+0                                                02040000
ALCSTOR  EQU   ALCBITS+0                                                02041000
ALCPUB   EQU   ALCBITS+0                                                02042000
CALLALOC EQU   ALCBITS+0                                                02043000
         ORG   ALCBITS+1                                                02044000
         DS    CL3                                                      02045000
FUNCLIST DS    CL8                                                      02046000
         ORG   FUNCLIST                                                 02047000
FUNCMAP1 DS    BL1                                                      02048000
         ORG   FUNCMAP1                                                 02049000
PSPUB    DS    BL1                                                      02050000
PSSTRG   EQU   FUNCMAP1+0                                               02051000
PUBSTOR  EQU   FUNCMAP1+0                                               02052000
PERMRES  EQU   FUNCMAP1+0                                               02053000
MOUNTED  EQU   FUNCMAP1+0                                               02054000
ONEGNRIC EQU   FUNCMAP1+0                                               02055000
PSVLSWOK EQU   FUNCMAP1+0                                               02056000
PARTALOC EQU   FUNCMAP1+0                                               02057000
         ORG   FUNCLIST+1                                               02058000
@NM00001 DS    AL3                                                      02059000
UCBSLGN  DS    FL4                                                      02060000
         ORG   FUNCLIST+8                                               02061000
FUNC476  DS    BL1                                                      02062000
FUNC477  DS    BL1                                                      02063000
         ORG   FUNC477                                                  02064000
UNLDPMNT DS    BL1                                                      02065000
DONTUNLD EQU   FUNC477+0                                                02066000
         ORG   FUNC477+1                                                02067000
FUNC479  DS    BL1                                                      02068000
         ORG   FUNC479                                                  02069000
@NM00002 DS    BL1                                                      02070000
VOLSWOK  EQU   FUNC479+0                                                02071000
DOSPEC   EQU   FUNC479+0                                                02072000
         ORG   FUNC479+1                                                02073000
GENPICK  DS    CL4                                                      02074000
SWITCHES DS    BL2                                                      02075000
         ORG   SWITCHES                                                 02076000
DADERRSW DS    BL1                                                      02077000
FILLIST  EQU   SWITCHES+0                                               02078000
NEEDTALC EQU   SWITCHES+0                                               02079000
NEEDMND  EQU   SWITCHES+0                                               02080000
SNEEDALG EQU   SWITCHES+0                                               02081000
SNEEDMNT EQU   SWITCHES+0                                               02082000
USEUCBSW EQU   SWITCHES+0                                               02083000
VOLFND   EQU   SWITCHES+0                                               02084000
ANYCANDS DS    BL1                                                      02085000
@NM00003 EQU   SWITCHES+1                                               02086000
         ORG   SWITCHES+2                                               02087000
UNLKMASK DS    CL240                                                    02088000
VMVRB    DS    CL52                                                     02089000
IEFAB485 CSECT                                                          02090000
         DS    0F                                                       02091000
@SIZDATD DC    AL1(230)                                                 02092000
         DC    AL3(@ENDDATD-@DATD)                                      02093000
@CV00166 DC    V(IEFAB433)                                              02094000
@CV00167 DC    V(IEFAB436)                                              02095000
@CV00168 DC    V(IEFAB476)                                              02096000
@CV00169 DC    V(IEFAB479)                                              02097000
@CV00171 DC    V(IEFAB477)                                              02098000
@CV00172 DC    V(IEFAB481)                                              02099000
@CV00173 DC    V(IEFAB486)                                              02100000
@CV00174 DC    V(IEFAB4FA)                                              02101000
@CA00170 DC    A(IEFAB49C)                                              02102000
         DS    0D                                                       02103000
GTSTZERO DC    F'0'                                                     02104000
LUTEND   DC    XL2'FFFF'                                                02105000
FUNC433  DC    B'00001010'                                              02106000
PUBFUNC  DC    B'00101000'                                              02107000
SCRAT476 DC    B'00001000'                                              02108000
STORFUNC DC    B'01010000'                                              02109000
TAPE476  DC    B'00001000'                                              02110000
IEFAB485 CSECT                                                          02111000
         DS   0H                                                        02112000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   02113000
@DATD    DSECT                                                          02114000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02115000
@ENDDATD EQU   *                                                        02116000
IEFAB485 CSECT                                                          02117000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02118000
@01      EQU   01                                                       02119000
@02      EQU   02                                                       02120000
@03      EQU   03                                                       02121000
@04      EQU   04                                                       02122000
@05      EQU   05                                                       02123000
@06      EQU   06                                                       02124000
@07      EQU   07                                                       02125000
@08      EQU   08                                                       02126000
@09      EQU   09                                                       02127000
@10      EQU   10                                                       02128000
@11      EQU   11                                                       02129000
@12      EQU   12                                                       02130000
@13      EQU   13                                                       02131000
@14      EQU   14                                                       02132000
@15      EQU   15                                                       02133000
GTSTRTCD EQU   @09                                                      02134000
VUCTR    EQU   @06                                                      02135000
UCBCTR   EQU   @09                                                      02136000
SAVAFID  EQU   @07                                                      02137000
RTNCODE  EQU   @03                                                      02138000
MOSTNUM  EQU   @05                                                      02139000
MAXMNTS  EQU   @04                                                      02140000
MASKBYTE EQU   @02                                                      02141000
LUTNO    EQU   @05                                                      02142000
AREQCTR  EQU   @04                                                      02143000
EGENCTR  EQU   @07                                                      02144000
VUPTR    EQU   @02                                                      02145000
UCBPTR   EQU   @03                                                      02146000
SIOTPTR  EQU   @04                                                      02147000
LUVPTR   EQU   @08                                                      02148000
GRPTABP  EQU   @07                                                      02149000
GENPTR   EQU   @05                                                      02150000
EDLPTR   EQU   @04                                                      02151000
AREQPTR  EQU   @02                                                      02152000
REG0     EQU   @00                                                      02153000
REG1     EQU   @01                                                      02154000
REG15    EQU   @15                                                      02155000
GTSTR0   EQU   @00                                                      02156000
GTSTR1   EQU   @01                                                      02157000
GTSTR2   EQU   @02                                                      02158000
GTSTR15  EQU   @15                                                      02159000
GTSTR4   EQU   @04                                                      02160000
GTSTR5   EQU   @05                                                      02161000
GTSTR6   EQU   @06                                                      02162000
GTSTR7   EQU   @07                                                      02163000
GTSTR8   EQU   @08                                                      02164000
GTSTR3   EQU   @03                                                      02165000
         EXTRN IEFAB49C                                                 02166000
PSUCBP   EQU   0                                                        02167000
IOSLUT   EQU   0                                                        02168000
KEEPMASK EQU   0                                                        02169000
REASONCD EQU   0                                                        02170000
VERIFYMK EQU   0                                                        02171000
WAITMASK EQU   0                                                        02172000
EDTHDR   EQU   0                                                        02173000
EDTLUVSP EQU   EDTHDR                                                   02174000
EDTGENSP EQU   EDTHDR+4                                                 02175000
EDTGRPSP EQU   EDTHDR+8                                                 02176000
EDTUCBSP EQU   EDTHDR+12                                                02177000
EDTMSKTP EQU   EDTHDR+16                                                02178000
LUVSECT  EQU   0                                                        02179000
LUVHDR   EQU   LUVSECT                                                  02180000
LUVENTNO EQU   LUVHDR                                                   02181000
LUVENTLN EQU   LUVHDR+4                                                 02182000
LUVENTRY EQU   0                                                        02183000
LUVGMTP  EQU   LUVENTRY+12                                              02184000
LUVGENNO EQU   LUVENTRY+16                                              02185000
LUVGENP  EQU   LUVENTRY+20                                              02186000
LUVFLAGS EQU   LUVENTRY+24                                              02187000
GENSECT  EQU   0                                                        02188000
GENHDR   EQU   GENSECT                                                  02189000
GENENTRY EQU   0                                                        02190000
GENGRPNO EQU   GENENTRY+4                                               02191000
GENGRPTR EQU   GENENTRY+8                                               02192000
GRPTRTAB EQU   0                                                        02193000
GRPTR    EQU   GRPTRTAB                                                 02194000
GRPSECT  EQU   0                                                        02195000
GRPHDR   EQU   GRPSECT                                                  02196000
GRPENTRY EQU   0                                                        02197000
GRPUCBNO EQU   GRPENTRY+4                                               02198000
GRPUCBP  EQU   GRPENTRY+8                                               02199000
EUCBSECT EQU   0                                                        02200000
EUCBHDR  EQU   EUCBSECT                                                 02201000
EUCBENTY EQU   0                                                        02202000
EUCBTPOS EQU   EUCBENTY                                                 02203000
GRMSKTAB EQU   0                                                        02204000
GMTHDR   EQU   GRMSKTAB                                                 02205000
GMTENTLN EQU   GMTHDR+4                                                 02206000
GMTENTRY EQU   0                                                        02207000
IEFEDL   EQU   0                                                        02208000
EDLHDR   EQU   IEFEDL                                                   02209000
EDLGENNO EQU   EDLHDR+4                                                 02210000
EDLFGENP EQU   EDLHDR+8                                                 02211000
EDLUVFLG EQU   EDLHDR+16                                                02212000
EDLMGENS EQU   EDLUVFLG                                                 02213000
EDLENTRY EQU   0                                                        02214000
EDLNXTNT EQU   EDLENTRY                                                 02215000
EDLDEVT  EQU   EDLENTRY+4                                               02216000
EDLNSCNT EQU   EDLENTRY+16                                              02217000
EDLDTFLG EQU   EDLENTRY+20                                              02218000
EINDEVTP EQU   EDLDTFLG                                                 02219000
EDLGNTRY EQU   0                                                        02220000
EDLGRFLG EQU   EDLGNTRY+16                                              02221000
EDLUCBL  EQU   0                                                        02222000
EDLINDIC EQU   EDLUCBL+2                                                02223000
VOLUNTAB EQU   0                                                        02224000
VOLSTAT  EQU   VOLUNTAB+6                                               02225000
VOLSTATA EQU   VOLSTAT                                                  02226000
VOLPUB   EQU   VOLSTATA                                                 02227000
VOLPRV   EQU   VOLSTATA                                                 02228000
VOLSTG   EQU   VOLSTATA                                                 02229000
VOLSTATB EQU   VOLSTAT+1                                                02230000
VOLALOC  EQU   VOLSTATB                                                 02231000
VDEVREQD EQU   VOLSTATB                                                 02232000
VUDNALOC EQU   VOLSTATB                                                 02233000
VUDADSME EQU   VOLSTATB                                                 02234000
VUVINELG EQU   VOLSTATB                                                 02235000
VOLSTATC EQU   VOLSTAT+2                                                02236000
VURECVRY EQU   VOLSTATC                                                 02237000
VOLSTATD EQU   VOLSTAT+3                                                02238000
VUREALOC EQU   VOLSTATD                                                 02239000
VOLALGTP EQU   VOLUNTAB+12                                              02240000
VOLSIOTP EQU   VOLUNTAB+16                                              02241000
VUUCBP   EQU   VOLUNTAB+20                                              02242000
VUGRID   EQU   VOLUNTAB+24                                              02243000
VUPOOL   EQU   0                                                        02244000
VUGRLST  EQU   0                                                        02245000
VUGRLENT EQU   VUGRLST                                                  02246000
VUGRLFLG EQU   VUGRLENT+4                                               02247000
ALCWA    EQU   0                                                        02248000
FMAPPTR  EQU   ALCWA+4                                                  02249000
SIOT1P   EQU   ALCWA+8                                                  02250000
IOSLUTP  EQU   ALCWA+16                                                 02251000
FAILRSCP EQU   ALCWA+20                                                 02252000
EDTABPTR EQU   ALCWA+24                                                 02253000
CNTABLE  EQU   ALCWA+28                                                 02254000
TOTREQS  EQU   CNTABLE+36                                               02255000
VOLUNPTR EQU   ALCWA+80                                                 02256000
VOLUNSZE EQU   ALCWA+84                                                 02257000
ALGTABP  EQU   ALCWA+88                                                 02258000
QMGRRBP  EQU   ALCWA+108                                                02259000
INDICATE EQU   ALCWA+112                                                02260000
INDWAIT  EQU   INDICATE                                                 02261000
DSSTAPE  EQU   INDICATE                                                 02262000
@NM00011 EQU   ALCWA+113                                                02263000
WAITIGEN EQU   @NM00011                                                 02264000
ALCWAREC EQU   @NM00011                                                 02265000
TIOTHDRP EQU   ALCWA+120                                                02266000
WMASKPTR EQU   ALCWA+128                                                02267000
WMASK2P  EQU   ALCWA+132                                                02268000
WORK3MP  EQU   ALCWA+136                                                02269000
CANCELP  EQU   ALCWA+140                                                02270000
EXITPRMP EQU   ALCWA+144                                                02271000
ALCNUCBS EQU   ALCWA+148                                                02272000
NAMES    EQU   0                                                        02273000
ALGPTRS  EQU   0                                                        02274000
ALGPARMP EQU   ALGPTRS                                                  02275000
ALGRQLTP EQU   ALGPTRS+4                                                02276000
CVRPARM  EQU   0                                                        02277000
CVRNREQ  EQU   CVRPARM+4                                                02278000
CVRFLG1  EQU   CVRPARM+8                                                02279000
CVRRQLST EQU   0                                                        02280000
CVRVUPTR EQU   CVRRQLST                                                 02281000
CVRNEED  EQU   CVRRQLST+8                                               02282000
CVRMIN   EQU   CVRRQLST+10                                              02283000
CVRFLG2  EQU   CVRRQLST+16                                              02284000
CVRSKFLG EQU   CVRFLG2                                                  02285000
CVRSCRTH EQU   CVRFLG2                                                  02286000
CVRIGNOR EQU   CVRFLG2                                                  02287000
CVRDUPLI EQU   CVRFLG2+1                                                02288000
CVRWUCBP EQU   CVRRQLST+24                                              02289000
CVRGPLST EQU   0                                                        02290000
CVRFLG3  EQU   CVRGPLST+12                                              02291000
GRPCOUNT EQU   0                                                        02292000
AQMPARAM EQU   0                                                        02293000
AQMECODE EQU   AQMPARAM                                                 02294000
AQMMASKP EQU   AQMPARAM+4                                               02295000
AQMNORMP EQU   AQMPARAM+20                                              02296000
FUNCMAP  EQU   0                                                        02297000
VOLMNTSW EQU   FUNCMAP                                                  02298000
WRTMSGSW EQU   FUNCMAP                                                  02299000
UWAITSW  EQU   FUNCMAP                                                  02300000
VWAITSW  EQU   FUNCMAP                                                  02301000
MSSTRMSW EQU   FUNCMAP                                                  02302000
OFFDEVSW EQU   FUNCMAP                                                  02303000
CCLMNTSW EQU   FUNCMAP                                                  02304000
GENLOKSW EQU   FUNCMAP                                                  02305000
SSEMSGSW EQU   FUNCMAP+1                                                02306000
HDRMSGSW EQU   FUNCMAP+1                                                02307000
MTRJOBSW EQU   FUNCMAP+1                                                02308000
NOTIOTNQ EQU   FUNCMAP+1                                                02309000
TRKMSW   EQU   FUNCMAP+1                                                02310000
WAITOKSW EQU   FUNCMAP+1                                                02311000
ASNMSW   EQU   FUNCMAP+1                                                02312000
VMVRQBLK EQU   0                                                        02313000
VMVFNMAP EQU   VMVRQBLK                                                 02314000
VMVOPTB1 EQU   VMVFNMAP                                                 02315000
VMVOPTB2 EQU   VMVFNMAP+1                                               02316000
VMVOPTB3 EQU   VMVFNMAP+2                                               02317000
VMVMINFO EQU   VMVRQBLK+40                                              02318000
VMVACTON EQU   VMVMINFO                                                 02319000
VMVUSER  EQU   VMVRQBLK+48                                              02320000
UCB      EQU   0                                                        02321000
UCBOB    EQU   0                                                        02322000
UCBJBNR  EQU   UCBOB                                                    02323000
UCBFL5   EQU   UCBOB+1                                                  02324000
UCBAF    EQU   UCBFL5                                                   02325000
UCBNALOC EQU   UCBFL5                                                   02326000
UCBSTAT  EQU   UCBOB+3                                                  02327000
UCBONLI  EQU   UCBSTAT                                                  02328000
UCBCHGS  EQU   UCBSTAT                                                  02329000
UCBUNLD  EQU   UCBSTAT                                                  02330000
UCBALOC  EQU   UCBSTAT                                                  02331000
UCBCHAN  EQU   UCBOB+4                                                  02332000
UCBSFLS  EQU   UCBOB+6                                                  02333000
UCBFLA   EQU   UCBSFLS                                                  02334000
UCBFL1   EQU   UCBFLA                                                   02335000
UCBBSY   EQU   UCBFL1                                                   02336000
UCBNRY   EQU   UCBFL1                                                   02337000
UCBNOTRD EQU   UCBNRY                                                   02338000
UCBPST   EQU   UCBFL1                                                   02339000
UCBCUB   EQU   UCBFL1                                                   02340000
UCBFLB   EQU   UCBSFLS+1                                                02341000
UCBCHM   EQU   UCBOB+8                                                  02342000
UCBCHM1  EQU   UCBCHM                                                   02343000
UCBPTH0  EQU   UCBCHM1                                                  02344000
UCBPTH1  EQU   UCBCHM1                                                  02345000
UCBWGT   EQU   UCBOB+12                                                 02346000
UCBTYP   EQU   UCBOB+16                                                 02347000
UCBTBYT1 EQU   UCBTYP                                                   02348000
UCB1FEA5 EQU   UCBTBYT1                                                 02349000
UCB1FEA6 EQU   UCBTBYT1                                                 02350000
UCBTBYT2 EQU   UCBTYP+1                                                 02351000
UCB2OPT2 EQU   UCBTBYT2                                                 02352000
UCBDUDN1 EQU   UCB2OPT2                                                 02353000
UCB2OPT3 EQU   UCBTBYT2                                                 02354000
UCBDUDN2 EQU   UCB2OPT3                                                 02355000
UCB2OPT4 EQU   UCBTBYT2                                                 02356000
UCBRWTAU EQU   UCB2OPT4                                                 02357000
UCB2OPT6 EQU   UCBTBYT2                                                 02358000
UCB2OPT7 EQU   UCBTBYT2                                                 02359000
UCBTBYT3 EQU   UCBTYP+2                                                 02360000
UCBDVCLS EQU   UCBTBYT3                                                 02361000
UCB3TAPE EQU   UCBDVCLS                                                 02362000
UCB3DACC EQU   UCBDVCLS                                                 02363000
UCBTBYT4 EQU   UCBTYP+3                                                 02364000
UCBEXTPT EQU   UCBOB+20                                                 02365000
UCBFLC   EQU   UCBEXTPT                                                 02366000
UCBDEV   EQU   UCBOB+24                                                 02367000
UCBCMEXT EQU   0                                                        02368000
UCBATI   EQU   UCBCMEXT+3                                               02369000
@NM00027 EQU   UCBATI                                                   02370000
UCBFLP1  EQU   UCBCMEXT+5                                               02371000
UCBMT    EQU   0                                                        02372000
UCBOCR   EQU   0                                                        02373000
UCB3540X EQU   0                                                        02374000
UCBDKBYT EQU   UCB3540X+6                                               02375000
UCB3800X EQU   0                                                        02376000
UCBOPTNS EQU   UCB3800X                                                 02377000
UCBACTIV EQU   UCB3800X+3                                               02378000
UCBMDRBF EQU   UCB3800X+36                                              02379000
UCBUCS   EQU   0                                                        02380000
UCBUCSOP EQU   UCBUCS+4                                                 02381000
UCBFCBOP EQU   UCBUCS+5                                                 02382000
INDMSIOT EQU   0                                                        02383000
SCTUSADD EQU   INDMSIOT+20                                              02384000
SIOTAFID EQU   INDMSIOT+26                                              02385000
SIOPSCNT EQU   INDMSIOT+42                                              02386000
SIOTBYT1 EQU   INDMSIOT+43                                              02387000
SIOTBYT3 EQU   INDMSIOT+46                                              02388000
SIOTTSTC EQU   INDMSIOT+47                                              02389000
SIOTBYT0 EQU   INDMSIOT+52                                              02390000
SIOTGIGN EQU   SIOTBYT0                                                 02391000
SCTSDISP EQU   INDMSIOT+55                                              02392000
SCTSBYT1 EQU   INDMSIOT+56                                              02393000
SCTSBYT2 EQU   INDMSIOT+57                                              02394000
SCTSBYT3 EQU   INDMSIOT+58                                              02395000
SCTSBYT4 EQU   INDMSIOT+59                                              02396000
SCTUTYPE EQU   INDMSIOT+60                                              02397000
SIOTDEVT EQU   SCTUTYPE                                                 02398000
SIOUBYT3 EQU   SIOTDEVT+2                                               02399000
SIOTBYT4 EQU   INDMSIOT+81                                              02400000
SIOTALTD EQU   INDMSIOT+92                                              02401000
SIOTBYT2 EQU   INDMSIOT+103                                             02402000
SIOTDMND EQU   SIOTBYT2                                                 02403000
SIOTRSNC EQU   INDMSIOT+130                                             02404000
SIOTEDLP EQU   INDMSIOT+136                                             02405000
SVOLUNAD EQU   INDMSIOT+140                                             02406000
SIOTNPTR EQU   INDMSIOT+152                                             02407000
CANCLECB EQU   0                                                        02408000
UCBBGN   EQU   0                                                        02409000
ALCWAPTR EQU   0                                                        02410000
UCBOBS01 EQU   UCBDEV                                                   02411000
UCBSTAB  EQU   UCBOBS01+10                                              02412000
UCBBSVL  EQU   UCBSTAB                                                  02413000
UCBPRSRS EQU   UCBSTAB                                                  02414000
UCBBPRV  EQU   UCBSTAB                                                  02415000
UCBBPUB  EQU   UCBSTAB                                                  02416000
UCBBSTR  EQU   UCBSTAB                                                  02417000
UCBDMCT  EQU   UCBOBS01+11                                              02418000
UCBMOUNT EQU   UCBDMCT                                                  02419000
UCBFL4   EQU   UCBOBS01+13                                              02420000
UCBOBS02 EQU   UCBDEV                                                   02421000
UCBTFL1  EQU   UCBOBS02+19                                              02422000
UCBXTN   EQU   UCBOBS02+20                                              02423000
UCBVOPT  EQU   UCBXTN                                                   02424000
UCBOBS03 EQU   UCBDEV                                                   02425000
UCBXTADR EQU   UCBOBS03                                                 02426000
UCBOBS04 EQU   UCBDEV                                                   02427000
UCBBTA   EQU   UCBOBS04+12                                              02428000
UCBOBS06 EQU   UCBDEV                                                   02429000
UCBAOF   EQU   UCBOBS06                                                 02430000
UCBAOF1  EQU   UCBAOF                                                   02431000
UCBAOF2  EQU   UCBAOF+1                                                 02432000
@NM00026 EQU   UCBOBS06+3                                               02433000
UCBIRB   EQU   UCBOBS06+4                                               02434000
UCBGRAF  EQU   UCBIRB                                                   02435000
UCBLDNCA EQU   UCBOBS06+8                                               02436000
UCBRDYQ  EQU   UCBLDNCA                                                 02437000
UCBIRLN  EQU   UCBRDYQ                                                  02438000
UCBLDNCB EQU   UCBRDYQ+1                                                02439000
UCBCTLNK EQU   UCBOBS06+12                                              02440000
UCBOBS07 EQU   UCBDEV                                                   02441000
UCBOBS08 EQU   UCBDEV                                                   02442000
UCBCTCAD EQU   UCBOBS08                                                 02443000
UCBCTCF1 EQU   UCBOBS08+4                                               02444000
UCBOBS09 EQU   UCBDEV                                                   02445000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02446000
UCBRV066 EQU   UCBOBS09+4                                               02447000
UCBIOSBA EQU   UCBOBS09                                                 02448000
UCBRV042 EQU   UCBOBS08+5                                               02449000
UCBRV082 EQU   UCBCTCF1                                                 02450000
UCBRV081 EQU   UCBCTCF1                                                 02451000
UCBRV080 EQU   UCBCTCF1                                                 02452000
UCBRV079 EQU   UCBCTCF1                                                 02453000
UCBRV078 EQU   UCBCTCF1                                                 02454000
UCBRV077 EQU   UCBCTCF1                                                 02455000
UCBRV076 EQU   UCBCTCF1                                                 02456000
UCBCTC80 EQU   UCBCTCF1                                                 02457000
UCBCTCAL EQU   UCBCTCAD                                                 02458000
UCBICNCB EQU   UCBOBS07+4                                               02459000
UCBRV040 EQU   UCBOBS07                                                 02460000
UCBCTLNA EQU   UCBCTLNK+1                                               02461000
UCBRLN   EQU   UCBCTLNK                                                 02462000
UCBRDYQA EQU   UCBLDNCB                                                 02463000
UCBINRLN EQU   UCBIRLN                                                  02464000
UCBIRBA  EQU   UCBIRB+1                                                 02465000
UCBRV039 EQU   UCBGRAF                                                  02466000
UCBDWNR  EQU   UCBGRAF                                                  02467000
UCBRPND  EQU   UCBGRAF                                                  02468000
UCBUPM   EQU   UCBGRAF                                                  02469000
UCBBTAM  EQU   UCBGRAF                                                  02470000
UCBDRNO  EQU   UCBGRAF                                                  02471000
UCBDRO   EQU   UCBGRAF                                                  02472000
UCBOIP   EQU   UCBGRAF                                                  02473000
UCBATRCD EQU   @NM00026                                                 02474000
UCBSKPFG EQU   @NM00026                                                 02475000
UCBRIPND EQU   @NM00026                                                 02476000
UCBRTIAC EQU   @NM00026                                                 02477000
UCBRSV79 EQU   @NM00026                                                 02478000
UCBRSV78 EQU   @NM00026                                                 02479000
UCBRSV77 EQU   @NM00026                                                 02480000
UCBOLTEP EQU   @NM00026                                                 02481000
UCBATNCT EQU   UCBOBS06+2                                               02482000
UCBRSV76 EQU   UCBAOF2                                                  02483000
UCBRSV75 EQU   UCBAOF2                                                  02484000
UCBRSV74 EQU   UCBAOF2                                                  02485000
UCBRSV73 EQU   UCBAOF2                                                  02486000
UCBRSV72 EQU   UCBAOF2                                                  02487000
UCBRSV71 EQU   UCBAOF2                                                  02488000
UCBRSV70 EQU   UCBAOF2                                                  02489000
UCBRSV69 EQU   UCBAOF2                                                  02490000
UCBRSV68 EQU   UCBAOF1                                                  02491000
UCBRSV67 EQU   UCBAOF1                                                  02492000
UCBRSV66 EQU   UCBAOF1                                                  02493000
UCBRSV65 EQU   UCBAOF1                                                  02494000
UCBRSV64 EQU   UCBAOF1                                                  02495000
UCBOFNL  EQU   UCBAOF1                                                  02496000
UCBOFSP  EQU   UCBAOF1                                                  02497000
UCBOFMCR EQU   UCBAOF1                                                  02498000
UCBBTB   EQU   UCBBTA+1                                                 02499000
UCBDI    EQU   UCBBTA                                                   02500000
UCBSNS   EQU   UCBOBS04+8                                               02501000
UCBTEB   EQU   UCBOBS04+4                                               02502000
UCBGCB   EQU   UCBOBS04+3                                               02503000
UCBOPEN  EQU   UCBOBS04+2                                               02504000
UCBSTART EQU   UCBOBS04                                                 02505000
UCBXTNB  EQU   UCBXTN+1                                                 02506000
UCBRSV22 EQU   UCBVOPT                                                  02507000
UCBRSV21 EQU   UCBVOPT                                                  02508000
UCBRSV20 EQU   UCBVOPT                                                  02509000
UCBESVE  EQU   UCBVOPT                                                  02510000
UCBERPC  EQU   UCBVOPT                                                  02511000
UCBESVC  EQU   UCBVOPT                                                  02512000
UCBEVA   EQU   UCBVOPT                                                  02513000
UCBESV   EQU   UCBVOPT                                                  02514000
UCBRV009 EQU   UCBTFL1                                                  02515000
UCBRV008 EQU   UCBTFL1                                                  02516000
UCBRV007 EQU   UCBTFL1                                                  02517000
UCBRV006 EQU   UCBTFL1                                                  02518000
UCBRV005 EQU   UCBTFL1                                                  02519000
UCBDQDSP EQU   UCBTFL1                                                  02520000
UCBNSLTP EQU   UCBTFL1                                                  02521000
UCBNLTP  EQU   UCBTFL1                                                  02522000
UCBRES1B EQU   UCBOBS02+18                                              02523000
UCBFSER  EQU   UCBOBS02+12                                              02524000
@NM00025 EQU   UCBOBS02+4                                               02525000
UCBFSEQ  EQU   UCBOBS02+2                                               02526000
UCBFSCT  EQU   UCBOBS02                                                 02527000
UCBNEXP  EQU   UCBOBS01+20                                              02528000
UCBBASE  EQU   UCBOBS01+16                                              02529000
UCBRES1A EQU   UCBOBS01+15                                              02530000
UCBUSER  EQU   UCBOBS01+14                                              02531000
UCBFL47  EQU   UCBFL4                                                   02532000
UCBFL46  EQU   UCBFL4                                                   02533000
UCBFL45  EQU   UCBFL4                                                   02534000
UCBRV065 EQU   UCBFL4                                                   02535000
UCBDSS   EQU   UCBFL4                                                   02536000
UCBRESVP EQU   UCBFL4                                                   02537000
UCBWDAV  EQU   UCBFL4                                                   02538000
UCBDAVV  EQU   UCBFL4                                                   02539000
UCBSQC   EQU   UCBOBS01+12                                              02540000
UCBDATP  EQU   UCBOBS01+12                                              02541000
UCBDMC   EQU   UCBDMCT                                                  02542000
UCBBNUL  EQU   UCBSTAB                                                  02543000
UCBSHAR  EQU   UCBSTAB                                                  02544000
UCBBALB  EQU   UCBPRSRS                                                 02545000
UCBPGFL  EQU   UCBSTAB                                                  02546000
UCBDVSHR EQU   UCBBSVL                                                  02547000
UCBVOLI  EQU   UCBOBS01+4                                               02548000
UCBVTOC  EQU   UCBOBS01                                                 02549000
SIODDSNL EQU   INDMSIOT+173                                             02550000
SIOVDSNL EQU   INDMSIOT+172                                             02551000
SIOVDSNT EQU   INDMSIOT+170                                             02552000
SVOLUNNO EQU   INDMSIOT+168                                             02553000
SIOTVMVP EQU   INDMSIOT+164                                             02554000
SIOTJFX  EQU   INDMSIOT+160                                             02555000
SJFCBPTR EQU   INDMSIOT+156                                             02556000
SIOTETIO EQU   INDMSIOT+148                                             02557000
SIOTATE  EQU   INDMSIOT+144                                             02558000
SIOTEDLS EQU   INDMSIOT+132                                             02559000
SCTANAME EQU   INDMSIOT+122                                             02560000
SIOTSSIC EQU   INDMSIOT+120                                             02561000
@NM00040 EQU   INDMSIOT+108                                             02562000
SIOTSSNM EQU   INDMSIOT+104                                             02563000
@NM00039 EQU   SIOTBYT2                                                 02564000
SIOTCVOL EQU   SIOTBYT2                                                 02565000
SIOTCNEW EQU   SIOTBYT2                                                 02566000
SIOTCALC EQU   SIOTBYT2                                                 02567000
SIOTGALL EQU   SIOTBYT2                                                 02568000
SIOTDSPD EQU   SIOTBYT2                                                 02569000
SIOTOPUC EQU   INDMSIOT+99                                              02570000
SIOTOUTR EQU   INDMSIOT+97                                              02571000
SIOTOUTC EQU   INDMSIOT+96                                              02572000
SIOTSSWA EQU   INDMSIOT+93                                              02573000
SIOTAUNC EQU   SIOTALTD                                                 02574000
SIOTACAT EQU   SIOTALTD                                                 02575000
SIOTADEL EQU   SIOTALTD                                                 02576000
SIOTAKEP EQU   SIOTALTD                                                 02577000
SIOTNPRV EQU   SIOTALTD                                                 02578000
SIOJCATS EQU   SIOTALTD                                                 02579000
@NM00038 EQU   SIOTALTD                                                 02580000
@NM00037 EQU   SIOTALTD                                                 02581000
@NM00036 EQU   INDMSIOT+91                                              02582000
SIOTNDSB EQU   INDMSIOT+88                                              02583000
@NM00035 EQU   INDMSIOT+84                                              02584000
SIOTDPCD EQU   INDMSIOT+82                                              02585000
@NM00034 EQU   SIOTBYT4                                                 02586000
SIOTRACT EQU   SIOTBYT4                                                 02587000
SIOTRACD EQU   SIOTBYT4                                                 02588000
SIOTPROT EQU   SIOTBYT4                                                 02589000
SCTOUTPN EQU   INDMSIOT+80                                              02590000
SCTOUTNO EQU   INDMSIOT+76                                              02591000
SCTOUTNM EQU   INDMSIOT+68                                              02592000
SIOUCBAD EQU   SCTUTYPE+5                                               02593000
SIOUCNVT EQU   SCTUTYPE+4                                               02594000
SIOUBYT4 EQU   SIOTDEVT+3                                               02595000
@NM00033 EQU   SIOUBYT3                                                 02596000
SIO3UREC EQU   SIOUBYT3                                                 02597000
SIO3DISP EQU   SIOUBYT3                                                 02598000
SIO3DACC EQU   SIOUBYT3                                                 02599000
SIO3COMM EQU   SIOUBYT3                                                 02600000
SIO3TAPE EQU   SIOUBYT3                                                 02601000
SIOUBYT2 EQU   SIOTDEVT+1                                               02602000
SIOUBYT1 EQU   SIOTDEVT                                                 02603000
SIOTOMN  EQU   SCTSBYT4                                                 02604000
SIOTIPDI EQU   SCTSBYT4                                                 02605000
SIOTVAFF EQU   SCTSBYT4                                                 02606000
SIOTSTEP EQU   SCTSBYT4                                                 02607000
SIOTASCI EQU   SCTSBYT4                                                 02608000
@NM00032 EQU   SCTSBYT4                                                 02609000
SIOTGDGA EQU   SCTSBYT4                                                 02610000
SCTSGDGS EQU   SCTSBYT4                                                 02611000
SCTSOLD  EQU   SCTSBYT3                                                 02612000
SCTSMOD  EQU   SCTSBYT3                                                 02613000
SCTSNEW  EQU   SCTSBYT3                                                 02614000
SCTSYSOU EQU   SCTSBYT3                                                 02615000
SCTVREF  EQU   SCTSBYT3                                                 02616000
SCTALCHK EQU   SCTSBYT3                                                 02617000
SCTSYSNE EQU   SCTSBYT3                                                 02618000
SCTDSNRF EQU   SCTSBYT3                                                 02619000
SCTRECVD EQU   SCTSBYT2                                                 02620000
SCTDEFER EQU   SCTSBYT2                                                 02621000
SCTLABEL EQU   SCTSBYT2                                                 02622000
SCTUNLBD EQU   SCTSBYT2                                                 02623000
SCTJOBLB EQU   SCTSBYT2                                                 02624000
SCTVOLAF EQU   SCTSBYT2                                                 02625000
SIOTCATL EQU   SCTSBYT2                                                 02626000
SIOCLUNL EQU   SCTSBYT2                                                 02627000
SIOTJSCT EQU   SCTSBYT1                                                 02628000
SCTUNAFF EQU   SCTSBYT1                                                 02629000
SCTPARLM EQU   SCTSBYT1                                                 02630000
SIOTQDSN EQU   SCTSBYT1                                                 02631000
SIOTGDSN EQU   SCTSBYT1                                                 02632000
SIOTCCAT EQU   SCTSBYT1                                                 02633000
SCTSYSIN EQU   SCTSBYT1                                                 02634000
SCTDUMMY EQU   SCTSBYT1                                                 02635000
SIOTUNCT EQU   SCTSDISP                                                 02636000
SIOTCTLG EQU   SCTSDISP                                                 02637000
SIOTDLET EQU   SCTSDISP                                                 02638000
SIOTKEEP EQU   SCTSDISP                                                 02639000
SIOTPASS EQU   SCTSDISP                                                 02640000
SIOTPRIV EQU   SCTSDISP                                                 02641000
S3400DSP EQU   SCTSDISP                                                 02642000
SIOTRETN EQU   SCTSDISP                                                 02643000
SIOTVLCT EQU   INDMSIOT+54                                              02644000
SCTNMBUT EQU   INDMSIOT+53                                              02645000
SIOTRTRY EQU   SIOTBYT0                                                 02646000
SIOTPUPV EQU   SIOTBYT0                                                 02647000
SIOTNOPV EQU   SIOTBYT0                                                 02648000
SPVTAMSG EQU   SIOTBYT0                                                 02649000
SIOTFUDA EQU   SIOTBYT0                                                 02650000
SIOTDYAL EQU   SIOTBYT0                                                 02651000
SIOTSSDS EQU   SIOTBYT0                                                 02652000
SIOTGIID EQU   INDMSIOT+50                                              02653000
SCTVOLCT EQU   INDMSIOT+49                                              02654000
SCTSPOOL EQU   INDMSIOT+48                                              02655000
SIOTQNAM EQU   SIOTTSTC                                                 02656000
SIOTDSNM EQU   SIOTTSTC                                                 02657000
SIOTTRKM EQU   SIOTTSTC                                                 02658000
SIOTSSMG EQU   SIOTTSTC                                                 02659000
SIOTSSGP EQU   SIOTTSTC                                                 02660000
@NM00031 EQU   SIOTTSTC                                                 02661000
SIOTTERM EQU   SIOTTSTC                                                 02662000
SIOTINFC EQU   SIOTTSTC                                                 02663000
@NM00030 EQU   SIOTBYT3                                                 02664000
SIOTDSID EQU   SIOTBYT3                                                 02665000
S3400OFF EQU   SIOTBYT3                                                 02666000
SIOTJES3 EQU   SIOTBYT3                                                 02667000
SIOCDEVT EQU   SIOTBYT3                                                 02668000
SIOALIAS EQU   SIOTBYT3                                                 02669000
SCTDDINO EQU   INDMSIOT+44                                              02670000
SIOTDDNT EQU   SIOTBYT1                                                 02671000
SIOTALCD EQU   SIOTBYT1                                                 02672000
SIODADSM EQU   SIOTBYT1                                                 02673000
SIOTDADR EQU   SIOTBYT1                                                 02674000
SIODUNAL EQU   SIOTBYT1                                                 02675000
SIOVAMDS EQU   SIOTBYT1                                                 02676000
SIOTHOLD EQU   SIOTBYT1                                                 02677000
SIOTOCKP EQU   SIOTBYT1                                                 02678000
SIOTREFN EQU   INDMSIOT+40                                              02679000
SIOTOTUN EQU   INDMSIOT+39                                              02680000
SIOTVRSB EQU   INDMSIOT+36                                              02681000
@NM00029 EQU   INDMSIOT+35                                              02682000
SCTPJFCB EQU   INDMSIOT+32                                              02683000
@NM00028 EQU   INDMSIOT+31                                              02684000
SCTPSIOT EQU   INDMSIOT+28                                              02685000
SIOTVLSP EQU   INDMSIOT+24                                              02686000
SIODSNTE EQU   INDMSIOT+22                                              02687000
SIOTUNAF EQU   SCTUSADD                                                 02688000
SIOTDEST EQU   INDMSIOT+12                                              02689000
SCTDDNAM EQU   INDMSIOT+4                                               02690000
SIOTTYPE EQU   INDMSIOT+3                                               02691000
SIOTDSKA EQU   INDMSIOT                                                 02692000
UCBERADR EQU   UCBUCS+12                                                02693000
UCBFCBID EQU   UCBUCS+8                                                 02694000
UCBERCNT EQU   UCBUCS+7                                                 02695000
UCBRSV51 EQU   UCBUCS+6                                                 02696000
UCBFCBPE EQU   UCBFCBOP                                                 02697000
UCBRSV49 EQU   UCBFCBOP                                                 02698000
UCBRSV48 EQU   UCBFCBOP                                                 02699000
UCBRSV47 EQU   UCBFCBOP                                                 02700000
UCBRSV46 EQU   UCBFCBOP                                                 02701000
UCBRSV45 EQU   UCBFCBOP                                                 02702000
UCBRSV44 EQU   UCBFCBOP                                                 02703000
UCBFCBO1 EQU   UCBFCBOP                                                 02704000
UCBUCSPE EQU   UCBUCSOP                                                 02705000
UCBRSV43 EQU   UCBUCSOP                                                 02706000
UCBRSV42 EQU   UCBUCSOP                                                 02707000
UCBRSV41 EQU   UCBUCSOP                                                 02708000
UCBRSV40 EQU   UCBUCSOP                                                 02709000
UCBRSV39 EQU   UCBUCSOP                                                 02710000
UCBUCSO2 EQU   UCBUCSOP                                                 02711000
UCBUCSO1 EQU   UCBUCSOP                                                 02712000
UCBUCSID EQU   UCBUCS                                                   02713000
UCBMDRBA EQU   UCBMDRBF+1                                               02714000
UCBRV075 EQU   UCBMDRBF                                                 02715000
UCBRV074 EQU   UCB3800X+32                                              02716000
UCBIMAGE EQU   UCB3800X+28                                              02717000
UCBFCBNM EQU   UCB3800X+24                                              02718000
UCBCHAR4 EQU   UCB3800X+20                                              02719000
UCBCHAR3 EQU   UCB3800X+16                                              02720000
UCBCHAR2 EQU   UCB3800X+12                                              02721000
UCBCHAR1 EQU   UCB3800X+8                                               02722000
UCBCGMID EQU   UCB3800X+4                                               02723000
UCBBRSTA EQU   UCBACTIV                                                 02724000
UCBRV063 EQU   UCBACTIV                                                 02725000
UCBRV062 EQU   UCBACTIV                                                 02726000
UCBRV061 EQU   UCBACTIV                                                 02727000
UCBRV060 EQU   UCBACTIV                                                 02728000
UCBRV059 EQU   UCBACTIV                                                 02729000
UCBRV058 EQU   UCBACTIV                                                 02730000
UCBRV057 EQU   UCBACTIV                                                 02731000
UCBRV050 EQU   UCB3800X+2                                               02732000
UCBCGMNO EQU   UCB3800X+1                                               02733000
UCBRV083 EQU   UCBOPTNS                                                 02734000
UCBBRSTR EQU   UCBOPTNS                                                 02735000
UCBRV056 EQU   UCBOPTNS                                                 02736000
UCBRV055 EQU   UCBOPTNS                                                 02737000
UCBRV054 EQU   UCBOPTNS                                                 02738000
UCBRV053 EQU   UCBOPTNS                                                 02739000
UCBRV052 EQU   UCBOPTNS                                                 02740000
UCBRV051 EQU   UCBOPTNS                                                 02741000
UCBRV073 EQU   UCB3540X+7                                               02742000
UCBRV072 EQU   UCBDKBYT                                                 02743000
UCBRV071 EQU   UCBDKBYT                                                 02744000
UCBRV070 EQU   UCBDKBYT                                                 02745000
UCBRV069 EQU   UCBDKBYT                                                 02746000
UCBRV068 EQU   UCBDKBYT                                                 02747000
UCBRV067 EQU   UCBDKBYT                                                 02748000
UCBVLVER EQU   UCBDKBYT                                                 02749000
UCBDKAMX EQU   UCBDKBYT                                                 02750000
UCBVLSER EQU   UCB3540X                                                 02751000
UCBRDATA EQU   UCBOCR+4                                                 02752000
UCBFRID  EQU   UCBOCR                                                   02753000
UCBCLN   EQU   UCBMT+14                                                 02754000
UCBERG   EQU   UCBMT+12                                                 02755000
UCBMS    EQU   UCBMT+11                                                 02756000
UCBNB    EQU   UCBMT+10                                                 02757000
UCBPW    EQU   UCBMT+9                                                  02758000
UCBPR    EQU   UCBMT+8                                                  02759000
UCBSIO   EQU   UCBMT+6                                                  02760000
UCBTW    EQU   UCBMT+5                                                  02761000
UCBTR    EQU   UCBMT+4                                                  02762000
UCBTWT   EQU   UCBMT+3                                                  02763000
UCBTRT   EQU   UCBMT+2                                                  02764000
UCBCTD   EQU   UCBMT                                                    02765000
UCBWTOID EQU   UCBCMEXT+17                                              02766000
UCBRV043 EQU   UCBCMEXT+16                                              02767000
UCBASID  EQU   UCBCMEXT+14                                              02768000
UCBMFCNT EQU   UCBCMEXT+12                                              02769000
UCBPMSK  EQU   UCBCMEXT+10                                              02770000
UCBCCWOF EQU   UCBCMEXT+8                                               02771000
UCBRV041 EQU   UCBCMEXT+6                                               02772000
UCBRV036 EQU   UCBFLP1                                                  02773000
UCBRV035 EQU   UCBFLP1                                                  02774000
UCBERLOG EQU   UCBFLP1                                                  02775000
UCBRV033 EQU   UCBFLP1                                                  02776000
UCBINHIO EQU   UCBFLP1                                                  02777000
UCBNSWAP EQU   UCBFLP1                                                  02778000
UCBSHRUP EQU   UCBFLP1                                                  02779000
UCBNSRCH EQU   UCBFLP1                                                  02780000
UCBSNSCT EQU   UCBCMEXT+4                                               02781000
UCBHPDV  EQU   @NM00027                                                 02782000
UCBHALI  EQU   @NM00027                                                 02783000
UCBRSV09 EQU   @NM00027                                                 02784000
UCBRSV08 EQU   @NM00027                                                 02785000
UCBRSV07 EQU   @NM00027                                                 02786000
UCBRSV06 EQU   @NM00027                                                 02787000
UCBRSV05 EQU   @NM00027                                                 02788000
UCBRSV04 EQU   @NM00027                                                 02789000
UCBDTI   EQU   UCBCMEXT+2                                               02790000
UCBSTI   EQU   UCBCMEXT+1                                               02791000
UCBETI   EQU   UCBCMEXT                                                 02792000
UCBEXTP  EQU   UCBEXTPT+1                                               02793000
UCBDDRSW EQU   UCBFLC                                                   02794000
UCBTICBT EQU   UCBFLC                                                   02795000
UCBIVRR  EQU   UCBFLC                                                   02796000
UCBIVRS  EQU   UCBFLC                                                   02797000
UCBITF   EQU   UCBFLC                                                   02798000
UCBUDE   EQU   UCBFLC                                                   02799000
UCBWAA   EQU   UCBFLC                                                   02800000
UCBATTP  EQU   UCBFLC                                                   02801000
UCBUNTYP EQU   UCBTBYT4                                                 02802000
UCBRSV11 EQU   UCBDVCLS                                                 02803000
UCBRSV10 EQU   UCBDVCLS                                                 02804000
UCB3CHAR EQU   UCBDVCLS                                                 02805000
UCB3UREC EQU   UCBDVCLS                                                 02806000
UCB3DISP EQU   UCBDVCLS                                                 02807000
UCB3COMM EQU   UCBDVCLS                                                 02808000
UCBDVPWR EQU   UCB2OPT7                                                 02809000
UCBVLPWR EQU   UCB2OPT6                                                 02810000
UCB2OPT5 EQU   UCBTBYT2                                                 02811000
UCBRVDEV EQU   UCBRWTAU                                                 02812000
UCBRPS   EQU   UCBDUDN2                                                 02813000
UCBRR    EQU   UCBDUDN1                                                 02814000
UCB2OPT1 EQU   UCBTBYT2                                                 02815000
UCB2OPT0 EQU   UCBTBYT2                                                 02816000
UCB1FEA7 EQU   UCBTBYT1                                                 02817000
UCBD6250 EQU   UCB1FEA6                                                 02818000
UCBD1600 EQU   UCB1FEA5                                                 02819000
UCB1FEA4 EQU   UCBTBYT1                                                 02820000
UCB1FEA3 EQU   UCBTBYT1                                                 02821000
UCB1FEA2 EQU   UCBTBYT1                                                 02822000
UCB1FEA1 EQU   UCBTBYT1                                                 02823000
UCB1FEA0 EQU   UCBTBYT1                                                 02824000
UCBNAME  EQU   UCBOB+13                                                 02825000
UCBRV029 EQU   UCBWGT                                                   02826000
UCBVHRSN EQU   UCBWGT                                                   02827000
UCBVORSN EQU   UCBWGT                                                   02828000
UCBMTPXP EQU   UCBWGT                                                   02829000
UCBREW   EQU   UCBWGT                                                   02830000
UCBPUB   EQU   UCBWGT                                                   02831000
UCBOUT   EQU   UCBWGT                                                   02832000
UCBIN    EQU   UCBWGT                                                   02833000
UCBCPU   EQU   UCBOB+11                                                 02834000
UCBLCI   EQU   UCBOB+10                                                 02835000
UCBCNT   EQU   UCBOB+9                                                  02836000
UCBRV017 EQU   UCBCHM1                                                  02837000
UCBRV016 EQU   UCBCHM1                                                  02838000
UCBRV015 EQU   UCBCHM1                                                  02839000
UCBRV014 EQU   UCBCHM1                                                  02840000
UCBSPB   EQU   UCBPTH1                                                  02841000
UCBPPB   EQU   UCBPTH1                                                  02842000
UCBSPA   EQU   UCBPTH0                                                  02843000
UCBPPA   EQU   UCBPTH0                                                  02844000
UCBSIGP  EQU   UCBFLB                                                   02845000
UCBVALPH EQU   UCBFLB                                                   02846000
UCBCRHSN EQU   UCBFLB                                                   02847000
UCBCRHRV EQU   UCBFLB                                                   02848000
UCBRESVH EQU   UCBFLB                                                   02849000
UCBSPST  EQU   UCBFLB                                                   02850000
UCBASNS  EQU   UCBFLB                                                   02851000
UCBIORST EQU   UCBFLB                                                   02852000
UCBQISCE EQU   UCBFL1                                                   02853000
UCBACTV  EQU   UCBFL1                                                   02854000
UCBSAP   EQU   UCBFL1                                                   02855000
UCBNOTRC EQU   UCBCUB                                                   02856000
UCBPSNS  EQU   UCBFL1                                                   02857000
UCBUSING EQU   UCBPST                                                   02858000
UCBBUSYD EQU   UCBBSY                                                   02859000
UCBUA    EQU   UCBCHAN+1                                                02860000
UCBCHA   EQU   UCBCHAN                                                  02861000
UCBDADI  EQU   UCBSTAT                                                  02862000
UCBSYSR  EQU   UCBSTAT                                                  02863000
UCBPRES  EQU   UCBSTAT                                                  02864000
UCBRESV  EQU   UCBSTAT                                                  02865000
UCBID    EQU   UCBOB+2                                                  02866000
UCBALTPH EQU   UCBFL5                                                   02867000
UCBALTCU EQU   UCBFL5                                                   02868000
UCBENVRD EQU   UCBFL5                                                   02869000
UCBVSDR  EQU   UCBFL5                                                   02870000
UCBSASK  EQU   UCBFL5                                                   02871000
UCBAMV   EQU   UCBAF                                                    02872000
UCBDCC   EQU   UCBFL5                                                   02873000
UCBMONT  EQU   UCBJBNR                                                  02874000
UCBRV011 EQU   UCBJBNR                                                  02875000
UCBMMSGP EQU   UCBJBNR                                                  02876000
UCBOLDSM EQU   UCBJBNR                                                  02877000
UCBRV003 EQU   UCBJBNR                                                  02878000
UCBDUC   EQU   UCBJBNR                                                  02879000
UCBJES3  EQU   UCBJBNR                                                  02880000
UCBVRDEV EQU   UCBJBNR                                                  02881000
UCBCMSEG EQU   UCBOB                                                    02882000
UCBPFXND EQU   UCB+512                                                  02883000
UCBIOQ   EQU   UCB+508                                                  02884000
UCBLOCK  EQU   UCB+504                                                  02885000
UCBPXST  EQU   UCB+504                                                  02886000
@NM00024 EQU   UCB                                                      02887000
@NM00023 EQU   VMVUSER                                                  02888000
VMVPROCD EQU   VMVUSER                                                  02889000
VMVVUNTP EQU   VMVRQBLK+44                                              02890000
@NM00022 EQU   VMVMINFO+1                                               02891000
@NM00021 EQU   VMVACTON                                                 02892000
VMVRTAIN EQU   VMVACTON                                                 02893000
VMVDSMT  EQU   VMVACTON                                                 02894000
VMVKEEP  EQU   VMVACTON                                                 02895000
VMVRETCD EQU   VMVRQBLK+36                                              02896000
VMVJSNMP EQU   VMVRQBLK+32                                              02897000
VMVDSNMP EQU   VMVRQBLK+28                                              02898000
VMVJBNMP EQU   VMVRQBLK+24                                              02899000
VMVMVLSR EQU   VMVRQBLK+18                                              02900000
VMVUVLSR EQU   VMVRQBLK+12                                              02901000
VMVUCBP  EQU   VMVRQBLK+9                                               02902000
@NM00020 EQU   VMVRQBLK+8                                               02903000
VMVNREQP EQU   VMVRQBLK+4                                               02904000
VMVOPTB4 EQU   VMVFNMAP+3                                               02905000
@NM00019 EQU   VMVOPTB3                                                 02906000
VMVNUMSG EQU   VMVOPTB3                                                 02907000
VMVCUVOL EQU   VMVOPTB3                                                 02908000
VMVDUPVL EQU   VMVOPTB3                                                 02909000
VMVNSPVT EQU   VMVOPTB2                                                 02910000
VMVNSLTP EQU   VMVOPTB2                                                 02911000
VMVSLTAP EQU   VMVOPTB2                                                 02912000
VMVNLTAP EQU   VMVOPTB2                                                 02913000
VMVALTAP EQU   VMVOPTB2                                                 02914000
VMVSTRG  EQU   VMVOPTB2                                                 02915000
VMVPUBLC EQU   VMVOPTB2                                                 02916000
VMVPRIVT EQU   VMVOPTB2                                                 02917000
VMVVDEND EQU   VMVOPTB1                                                 02918000
VMVVRLBL EQU   VMVOPTB1                                                 02919000
VMVDWTOR EQU   VMVOPTB1                                                 02920000
VMVMTMSG EQU   VMVOPTB1                                                 02921000
VMVMOUNT EQU   VMVOPTB1                                                 02922000
VMVREWND EQU   VMVOPTB1                                                 02923000
VMVUCB   EQU   VMVOPTB1                                                 02924000
VMVUNLOD EQU   VMVOPTB1                                                 02925000
EXTRACAL EQU   FUNCMAP+1                                                02926000
ALCASDSN EQU   ASNMSW                                                   02927000
ALCSUBWT EQU   WAITOKSW                                                 02928000
ALCATRKM EQU   TRKMSW                                                   02929000
ALCNOENQ EQU   NOTIOTNQ                                                 02930000
ALCJOBNM EQU   MTRJOBSW                                                 02931000
ALCHDMSG EQU   HDRMSGSW                                                 02932000
ALCSSMSG EQU   SSEMSGSW                                                 02933000
ALCGENER EQU   GENLOKSW                                                 02934000
ALCCANCL EQU   CCLMNTSW                                                 02935000
ALCOFFDV EQU   OFFDEVSW                                                 02936000
ALCMSSTM EQU   MSSTRMSW                                                 02937000
ALCWTVOL EQU   VWAITSW                                                  02938000
ALCWTUNT EQU   UWAITSW                                                  02939000
ALCMSGLV EQU   WRTMSGSW                                                 02940000
ALCMOUNT EQU   VOLMNTSW                                                 02941000
AQMQBPTR EQU   AQMPARAM+24                                              02942000
AQMPFLG  EQU   AQMNORMP                                                 02943000
AQMCANCP EQU   AQMPARAM+16                                              02944000
AQMLENGT EQU   AQMPARAM+12                                              02945000
AQMASID  EQU   AQMPARAM+8                                               02946000
AQMQCODE EQU   AQMPARAM+2                                               02947000
GRPWPTR  EQU   GRPCOUNT+12                                              02948000
GRPIDENT EQU   GRPCOUNT+10                                              02949000
GRPEXCS  EQU   GRPCOUNT+8                                               02950000
GRPTOTAL EQU   GRPCOUNT+6                                               02951000
GRPOFFLN EQU   GRPCOUNT+4                                               02952000
GRPALLCT EQU   GRPCOUNT+2                                               02953000
GRPAVAIL EQU   GRPCOUNT                                                 02954000
@NM00018 EQU   CVRGPLST+13                                              02955000
@NM00017 EQU   CVRFLG3                                                  02956000
CVRFORCI EQU   CVRFLG3                                                  02957000
CVRGSKP  EQU   CVRFLG3                                                  02958000
CVRBOUND EQU   CVRGPLST+10                                              02959000
CVRGALL  EQU   CVRGPLST+8                                               02960000
CVRGRPAL EQU   CVRGPLST+6                                               02961000
CVRGRPID EQU   CVRGPLST+4                                               02962000
CVRGCPTR EQU   CVRGPLST                                                 02963000
@NM00016 EQU   CVRRQLST+26                                              02964000
CVRGRPPT EQU   CVRRQLST+20                                              02965000
CVRNGRP  EQU   CVRRQLST+18                                              02966000
@NM00015 EQU   CVRFLG2+1                                                02967000
CVRWMOVE EQU   CVRFLG2                                                  02968000
CVRMULTI EQU   CVRFLG2                                                  02969000
CVRFULL  EQU   CVRFLG2                                                  02970000
CVRREACH EQU   CVRFLG2                                                  02971000
CVRRUSED EQU   CVRFLG2                                                  02972000
CVRGNEXT EQU   CVRRQLST+12                                              02973000
CVRPTS   EQU   CVRMIN                                                   02974000
CVRALLCT EQU   CVRRQLST+6                                               02975000
CVRREQ1  EQU   CVRRQLST+4                                               02976000
@NM00014 EQU   CVRPARM+9                                                02977000
@NM00013 EQU   CVRFLG1                                                  02978000
CVRFCALL EQU   CVRFLG1                                                  02979000
CVROFFLG EQU   CVRFLG1                                                  02980000
CVRALFLG EQU   CVRFLG1                                                  02981000
CVRAVFLG EQU   CVRFLG1                                                  02982000
CVRGRPLK EQU   CVRPARM+6                                                02983000
CVRRQPTR EQU   CVRPARM                                                  02984000
ALGGCNTP EQU   ALGPTRS+12                                               02985000
ALGGLSTP EQU   ALGPTRS+8                                                02986000
ALCPROCN EQU   NAMES+16                                                 02987000
ALCSTEPN EQU   NAMES+8                                                  02988000
ALCJOBN  EQU   NAMES                                                    02989000
LOJSSNMP EQU   ALCWA+164                                                02990000
SSERBLKP EQU   ALCWA+160                                                02991000
GROUPSZ  EQU   ALCWA+156                                                02992000
GRIDPTR  EQU   ALCWA+152                                                02993000
LGENLOCK EQU   ALCWA+124                                                02994000
TCBP     EQU   ALCWA+116                                                02995000
ALCWASID EQU   ALCWA+114                                                02996000
@NM00012 EQU   @NM00011                                                 02997000
NODEVERR EQU   @NM00011                                                 02998000
NEEDRCVY EQU   @NM00011                                                 02999000
UNITRECS EQU   @NM00011                                                 03000000
ALCWADUL EQU   INDICATE                                                 03001000
ALCWISAM EQU   INDICATE                                                 03002000
DSSUNIT  EQU   INDICATE                                                 03003000
PRIVASUM EQU   INDICATE                                                 03004000
INDREQU  EQU   INDICATE                                                 03005000
INDRETRY EQU   INDICATE                                                 03006000
RIMTABCT EQU   ALCWA+104                                                03007000
RIMTABLN EQU   ALCWA+100                                                03008000
RIMTABP  EQU   ALCWA+96                                                 03009000
ALGTABSZ EQU   ALCWA+92                                                 03010000
@NM00010 EQU   ALCWA+78                                                 03011000
LTUNITID EQU   ALCWA+76                                                 03012000
TOTVOLUN EQU   CNTABLE+44                                               03013000
NUMREQS  EQU   CNTABLE+40                                               03014000
OTHEREQS EQU   CNTABLE+32                                               03015000
SUBSREQS EQU   CNTABLE+28                                               03016000
STRGREQS EQU   CNTABLE+24                                               03017000
PUBLREQS EQU   CNTABLE+20                                               03018000
PVTNREQS EQU   CNTABLE+16                                               03019000
SPECREQS EQU   CNTABLE+12                                               03020000
TPREQS   EQU   CNTABLE+8                                                03021000
VAMREQS  EQU   CNTABLE+4                                                03022000
DMYREQS  EQU   CNTABLE                                                  03023000
JSCBPTR  EQU   ALCWA+12                                                 03024000
WASIZE   EQU   ALCWA                                                    03025000
@NM00009 EQU   VUGRLENT+5                                               03026000
@NM00008 EQU   VUGRLFLG                                                 03027000
VUGRALCD EQU   VUGRLFLG                                                 03028000
VUGRLIDS EQU   VUGRLENT                                                 03029000
VUCBS    EQU   VUPOOL+4                                                 03030000
VUPOOL#  EQU   VUPOOL                                                   03031000
VOLUNTID EQU   VOLUNTAB+10                                              03032000
VURCVYPR EQU   VOLSTATD                                                 03033000
VUVLUNIQ EQU   VOLSTATD                                                 03034000
VUDMUNIQ EQU   VOLSTATD                                                 03035000
VUUNALSW EQU   VOLSTATD                                                 03036000
VUDMNDAL EQU   VOLSTATD                                                 03037000
VUDMNDOF EQU   VOLSTATD                                                 03038000
VUMUGDON EQU   VOLSTATD                                                 03039000
@NM00007 EQU   VOLSTATC                                                 03040000
@NM00006 EQU   VOLSTATC                                                 03041000
VOLURREQ EQU   VOLSTATC                                                 03042000
VOLGRREQ EQU   VOLSTATC                                                 03043000
VOLDAREQ EQU   VOLSTATC                                                 03044000
VOLCOREQ EQU   VOLSTATC                                                 03045000
VOLTAREQ EQU   VOLSTATC                                                 03046000
VUAFFWRK EQU   VOLSTATB                                                 03047000
VUPROCED EQU   VOLSTATB                                                 03048000
VOLMNTD  EQU   VOLSTATB                                                 03049000
VOLDEFER EQU   VOLSTATA                                                 03050000
VUDADSM  EQU   VOLSTATA                                                 03051000
VOLRESVE EQU   VOLSTATA                                                 03052000
VOLNSHR  EQU   VOLSTATA                                                 03053000
VOLSPEC  EQU   VOLSTATA                                                 03054000
VOLID    EQU   VOLUNTAB                                                 03055000
EDLNOJES EQU   EDLINDIC                                                 03056000
EDLVOLAF EQU   EDLINDIC                                                 03057000
EDLENQ   EQU   EDLINDIC                                                 03058000
EDLDADSM EQU   EDLINDIC                                                 03059000
EDLALCD  EQU   EDLINDIC                                                 03060000
EDLUCBAD EQU   EDLUCBL                                                  03061000
EDLJINEL EQU   EDLGRFLG                                                 03062000
EDLGRID  EQU   EDLGNTRY+12                                              03063000
EDLLISTP EQU   EDLGNTRY+8                                               03064000
EDLUCBNO EQU   EDLGNTRY+4                                               03065000
EDLNXGRP EQU   EDLGNTRY                                                 03066000
@NM00005 EQU   EDLENTRY+18                                              03067000
EDLGRPTR EQU   EDLENTRY+12                                              03068000
EDLGRPNO EQU   EDLENTRY+8                                               03069000
EDLVAM   EQU   EDLUVFLG                                                 03070000
EDLGMTP  EQU   EDLHDR+12                                                03071000
EDLLUV   EQU   EDLHDR                                                   03072000
GRPMASK  EQU   GMTENTRY                                                 03073000
GMTENTNO EQU   GMTHDR                                                   03074000
EUCBENLN EQU   EUCBHDR+4                                                03075000
EUCBENNO EQU   EUCBHDR                                                  03076000
GRPID    EQU   GRPENTRY                                                 03077000
GRPENTLN EQU   GRPHDR+4                                                 03078000
GRPENTNO EQU   GRPHDR                                                   03079000
GENDEVT  EQU   GENENTRY                                                 03080000
GENENTLN EQU   GENHDR+4                                                 03081000
GENENTNO EQU   GENHDR                                                   03082000
LUVAGMTP EQU   LUVENTRY+28                                              03083000
@NM00004 EQU   LUVFLAGS                                                 03084000
LUVMGENS EQU   LUVFLAGS                                                 03085000
LUVAGMSK EQU   LUVFLAGS                                                 03086000
LUVVAM   EQU   LUVFLAGS                                                 03087000
LUVALUE  EQU   LUVENTRY+8                                               03088000
UNITNAME EQU   LUVENTRY                                                 03089000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03090000
@RC00199 EQU   @RC00184                                                 03091000
@RC00241 EQU   @RC00213                                                 03092000
@RC00309 EQU   @RC00295                                                 03093000
@RC00288 EQU   @RC00286                                                 03094000
@RC00363 EQU   @RC00361                                                 03095000
@RC00408 EQU   @RC00405                                                 03096000
@RC00480 EQU   @EL00004                                                 03097000
@RC00422 EQU   @RC00408                                                 03098000
@RC00506 EQU   @RC00480                                                 03099000
@RC00425 EQU   @RC00422                                                 03100000
@ENDDATA EQU   *                                                        03101000
         END   IEFAB485,(C'PLS1229',0701,78089)                         03102000
