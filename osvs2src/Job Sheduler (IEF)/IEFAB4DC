         TITLE 'IEFAB4DC - DATASET RESERVATION/RELEASE                 *00001000
                        '                                               00002000
IEFAB4DC CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'IEFAB4DC  76.274'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  DS    0H                                               01S0001 00012000
         USING @PSTART,@12                                      01S0001 00013000
         L     @00,@SIZDATD                                     01S0001 00014000
         MODESET EXTKEY=SCHED,SAVEKEY=(2)                               00015000
         GSPACE   R,LV=(0)                                              00016000
         LR    @11,@01                                          01S0001 00017000
         USING @DATD,@11                                        01S0001 00018000
         ST    @13,@SA00001+4                                   01S0001 00019000
         STC   @02,@OLDKEY                                      01S0001 00020000
         MODESET KEYADDR=(2)                                            00021000
         LM    @00,@02,20(@13)                                  01S0001 00022000
         ST    @11,8(,@13)                                      01S0001 00023000
         LR    @13,@11                                          01S0001 00024000
         MODESET EXTKEY=ZERO                                            00025000
         MVC   @PC00001(44),0(@01)                              01S0001 00026000
         MODESET EXTKEY=SCHED                                           00027000
*RETCODE=ZERO;                         /*INITIALIZE RETURN CODE TO 0 */ 00028000
         L     @09,@PC00001+32                                  01S0062 00029000
         SLR   @15,@15                                          01S0062 00030000
         ST    @15,RETCODE(,@09)                                01S0062 00031000
*SAVEREC=ZERO;                         /*ADDRESS OF RECORD WITH SPACE*/ 00032000
         SLR   SAVEREC,SAVEREC                                  01S0063 00033000
*DSNFOUND=OFF;                         /*ASSUME DSN ENTRY NOT FOUND  */ 00034000
*ENQFAIL=OFF;                          /*ASSUME ENQ NOT NECESSARY OR    00035000
*                                        SUCCESSFUL                  */ 00036000
*ASSIGN=OFF;                           /*ASSUME NO ASSIGNS   @YM06161*/ 00037000
         NI    DSNFOUND,B'10101110'                             01S0066 00038000
*IF ADDRPASS=OFF | SRCHDSNM=ON THEN    /*DSENQ ENTRY NOT PASSED OR      00039000
*                                        DSNAME SEARCH       @YM07288*/ 00040000
         L     @09,@PC00001                                     01S0067 00041000
         TM    ADDRPASS(@09),B'10000000'                        01S0067 00042000
         BZ    @RT00067                                         01S0067 00043000
         TM    SRCHDSNM(@09),B'00000010'                        01S0067 00044000
         BNO   @RF00067                                         01S0067 00045000
@RT00067 DS    0H                                               01S0068 00046000
*  DO;                                 /*NECESSARY TO SEARCH FOR DSN */ 00047000
*/********************************************************************/ 00048000
*/*                                                                  */ 00049000
*/* SEGMENT - SRCHDSN                                                */ 00050000
*/*                                                                  */ 00051000
*/* DESCRIPTIVE NAME - SEARCH DSENQ FOR DSNAME ENTRY                 */ 00052000
*/*                                                                  */ 00053000
*/* FUNCTION - READ THE RECORDS OF THE DSENQ TABLE AND SEARCH FOR A  */ 00054000
*/*            MATCH ON THE INPUT DSNAME.  (FUNCTION 1 - IF READALL  */ 00055000
*/*            AND INCORREC ARE BOTH OFF.)                           */ 00056000
*/*                                                                  */ 00057000
*/*            READ ALL RECORDS OF THE DSENQ TABLE, SEARCH FOR A     */ 00058000
*/*            MATCH ON THE INPUT DSNAME, AND CHAIN THE RECORDS      */ 00059000
*/*            TOGETHER VIA THE IN CORE POINTERS.  (FUNCTION 2 - IF  */ 00060000
*/*            READALL IS ON.)                                       */ 00061000
*/*                                                                  */ 00062000
*/*            SEARCH THE RECORDS THAT ARE CHAINED TOGETHER IN CORE  */ 00063000
*/*            FOR A MATCH ON THE INPUT DSNAME.  (FUNCTION 3 - IF    */ 00064000
*/*            INCORREC IS ON.)                                      */ 00065000
*/*                                                                  */ 00066000
*/*            DETERMINE WHETHER THE ENTRY FOR THIS DSNAME WILL      */ 00067000
*/*            FIT IN THE RECORD BEING SEARCHED, SO THAT IF THE ENTRY*/ 00068000
*/*            MUST BE ADDED, A RECORD WON'T HAVE TO BE ASSIGNED.    */ 00069000
*/*            (FUNCTION 4 - IN ALL CASES.)                          */ 00070000
*/*                                                                  */ 00071000
*/*            RETURN POINTERS TO DSENQ ENTRY AND BLOCK IF   @YM07288*/ 00072000
*/*            THE SEARCH ONLY FUNCTION IS REQUESTED AND     @YM07288*/ 00073000
*/*            THE DSNAME IS FOUND. (FUNCTION 5)             @YM07288*/ 00074000
*/*                                                                  */ 00075000
*/* OPERATION - CALCULATE THE ACTUAL LENGTH OF THE INPUT DSNAME.     */ 00076000
*/*                                                                  */ 00077000
*/*             CALCULATE THE NUMBER OF BYTES REQUIRED FOR A NEW     */ 00078000
*/*             DSENQ ENTRY FOR THIS DSNAME.                         */ 00079000
*/*                                                                  */ 00080000
*/*             IF THE IN CORE POINTERS ARE NOT PASSED, READ THE     */ 00081000
*/*             DSENQ TABLE A RECORD AT A TIME. WHEN READING RECORDS,*/ 00082000
*/*             CHAIN THEM VIA IN CORE POINTERS IF THIS FUNCTION IS  */ 00083000
*/*             REQUESTED IN THE INPUT FUNCTION MAP.                 */ 00084000
*/*                                                                  */ 00085000
*/*             SEARCH FOR A MATCH ON DSNAME.  THE SEARCH IS ENDED   */ 00086000
*/*             AT EITHER OF THE FOLLOWING CONDITIONS -              */ 00087000
*/*               WHEN AN ENTRY FOR THE DSNAME IS FOUND (FUNCTIONS 1 */ 00088000
*/*               3 AND 5),                                  @YM07288*/ 00089000
*/*               AT THE END OF THE DSENQ TABLE (FUNCTIONS 1 AND 3   */ 00090000
*/*               WHEN AN ENTRY FOR THE DSNAME IS NOT FOUND, AND     */ 00091000
*/*               ALWAYS FOR FUNCTION 2).                            */ 00092000
*/*                                                                  */ 00093000
*/*             WHEN THE SEARCH OF EACH RECORD IS ENDED, A CHECK IS  */ 00094000
*/*             MADE TO SEE IF THE ENTRY FOR THIS DSNAME WILL FIT IN */ 00095000
*/*             THE RECORD AND IF SO, THE ADDRESS OF THIS ENTRY IS   */ 00096000
*/*             SAVED FOR LATER USE (IF THE ENTRY HAS TO BE ADDED    */ 00097000
*/*             TO THE DSENQ TABLE).                                 */ 00098000
*/*                                                                  */ 00099000
*/*             IF THE SEARCH DSNAME FUNCTION HAS REQUESTED, @YM07288*/ 00100000
*/*             AND THE DSNAME WAS FOUND, AND RETURN         @YM07288*/ 00101000
*/*             INFO WAS REQUESTED, RETURN THE ADDRESS       @YM07288*/ 00102000
*/*             OF THE DATA SET ENQ TABLE ENTRY AND THE      @YM07288*/ 00103000
*/*             ADDRESS OF THE BLOCK CONTAINING THE ENTRY.   @YM07288*/ 00104000
*/*                                                                  */ 00105000
*/* ENTRY - SRCHDSN (INCLUDED SEGMENT)                               */ 00106000
*/*                                                                  */ 00107000
*/*  INPUT DATA - JCTDETDA - SVA OF FIRST DSENQ RECORD               */ 00108000
*/*               READALL  - ON, INDICATING READ AND CHAIN ALL DSENQ */ 00109000
*/*                          RECORDS WHILE SEARCHING FOR DSNAME MATCH*/ 00110000
*/*                          OFF, INDICATING READ AS MANY DSENQ      */ 00111000
*/*                          RECORDS AS NECEASARY WHILE SEARCHING    */ 00112000
*/*                          FOR DSNAME MATCH                        */ 00113000
*/*               INCORREC - ON, INDICATING RECORDS ARE ALREADY IN   */ 00114000
*/*                          CORE AND FIRSTREC CONTAINS ADDRESS OF   */ 00115000
*/*                          FIRST DSENQ RECORD                      */ 00116000
*/*                          OFF, INDICATING DSENQ TABLE HAS TO BE   */ 00117000
*/*                          READ                                    */ 00118000
*/*               DSNFOUND - OFF, ASSUMING DSNAME ENTRY NOT FOUND    */ 00119000
*/*               SAVEREC  - ZERO, INDICATING NO RECORD HAS BEEN     */ 00120000
*/*                          FOUND WHICH COULD CONTAIN THE DSNAME    */ 00121000
*/*                          ENTRY                                   */ 00122000
*/*               DSNLNGH  - LENGTH OF INPUT DSNAME                  */ 00123000
*/*               DSNAME   - INPUT DSNAME                            */ 00124000
*/*               FIRSTREC - ADDRESS OF FIRST IN CORE RECORD IF      */ 00125000
*/*                          INCORREC IS ON                          */ 00126000
*/*               SRCHDSNM - INDICATOR IN FUNCTION MAP       @YM07288*/ 00127000
*/*                          REQUESTING ADDRESS OF DSENQ ENT @YM07288*/ 00128000
*/*                          AND BLOCK CONTAINING DSNAME.    @YM07288*/ 00129000
*/*               RETADDR  - INDICATOR IN FUNCTION MAP USED  @YM07288*/ 00130000
*/*                          (IF SRCHDSNM = ON) TO DETERMINE @YM07288*/ 00131000
*/*                          IF INFORMATION SHOULD BE        @YM07288*/ 00132000
*/*                          RETURNED WHEN THE DSNAME IS     @YM07288*/ 00133000
*/*                          FOUND.                          @YM07288*/ 00134000
*/*                                                                  */ 00135000
*/* EXIT - TO NEXT SEQUENTIAL INSTRUCTION                            */ 00136000
*/*                                                                  */ 00137000
*/*  OUTPUT DATA - IF DSNFOUND=OFF, THE DSNAME WAS NOT FOUND IN THE  */ 00138000
*/*                DSENQ TABLE AND                                   */ 00139000
*/*                  SAVEREC=ZERO INDICATING AN ASSIGN IS NECESSARY  */ 00140000
*/*                               FOR A NEW DSENQ RECORD TO CONTAIN  */ 00141000
*/*                               THE DSNAME ENTRY OR                */ 00142000
*/*                          ADDR OF FIRST RECORD WHICH HAS ROOM FOR */ 00143000
*/*                               DSNAME ENTRY.                      */ 00144000
*/*                  DSNQPTR=ADDR OF LAST DSENQ RECORD.              */ 00145000
*/*                  DSNQENTP=ADDR OF LAST DSENQ ENTRY.              */ 00146000
*/*                                                                  */ 00147000
*/*                IF DSNFOUND=ON, THE ENTRY WAS FOUND IN DSENQ      */ 00148000
*/*                TABLE AND                                         */ 00149000
*/*                  DSNQPTR=ADDR OF RECORD CONTAINING DSNAME ENTRY. */ 00150000
*/*                  DSNQENTP=ADDR OF DSNAME ENTRY.                  */ 00151000
*/*                                                                  */ 00152000
*/*                IF SRCHDSNM = ON AND RETADDR = ON, THE    @YM07288*/ 00153000
*/*                SEARCH FUNCTION WAS REQUESTED AND         @YM07288*/ 00154000
*/*                  ENTADDR, IN CALLERS PARM LIST, CONTAINS @YM07288*/ 00155000
*/*                  POINTER TO DSENQ ENTRY CONTAINING SEARCH@YM07288*/ 00156000
*/*                  DSNAME.                                 @YM07288*/ 00157000
*/*                  RECADDR, IN CALLERS PARM LIST, CONTAINS @YM07288*/ 00158000
*/*                  POINTER TO DSENQ BLOCK CONTAINING       @YM07288*/ 00159000
*/*                  DSENQ ENTRY ABOVE.                      @YM07288*/ 00160000
*/*                                                                  */ 00161000
*/*                IF READALL IS ON AND THE DSENQ TABLE EXISTS,      */ 00162000
*/*                  FIRSTREC=ADDR OF THE FIRST DSENQ RECORD.        */ 00163000
*/*                                                                  */ 00164000
*/*                REALNGTH CONTAINS THE ACTUAL LENGTH OF THE INPUT  */ 00165000
*/*                  DSNAME.                                         */ 00166000
*/*                                                                  */ 00167000
*/*                ENTRYLNG CONTAINS THE LENGTH OF THE ENTRY TO BE   */ 00168000
*/*                  ADDED.                                          */ 00169000
*/*                                                                  */ 00170000
*/********************************************************************/ 00171000
*DO REALNGTH=DSNLNGH TO 1 BY -1 WHILE(DSNAME(REALNGTH)=BLANK);  02S0069 00172000
         L     @09,@PC00001+8                                   02S0069 00173000
         LH    REALNGTH,DSNLNGH(,@09)                           02S0069 00174000
         B     @DE00069                                         02S0069 00175000
@DL00069 L     @09,@PC00001+8                                   02S0069 00176000
         ALR   @09,REALNGTH                                     02S0069 00177000
         CLI   DSNAME-1(@09),C' '                               02S0069 00178000
         BNE   @DC00069                                         02S0069 00179000
*END;                                  /*CALCULATE ACTUAL DSN LENGTH */ 00180000
         BCTR  REALNGTH,0                                       02S0070 00181000
@DE00069 LTR   REALNGTH,REALNGTH                                02S0070 00182000
         BP    @DL00069                                         02S0070 00183000
@DC00069 DS    0H                                               02S0071 00184000
*ENTRYLNG=ENTRYHDR+REALNGTH;           /*CALCULATE ENTRY LENGTH      */ 00185000
         LR    ENTRYLNG,REALNGTH                                02S0071 00186000
         AL    ENTRYLNG,ENTRYHDR                                02S0071 00187000
*IF INCORREC=OFF THEN                  /*ARE RECORDS IN CORE         */ 00188000
         L     @05,@PC00001                                     02S0072 00189000
         TM    INCORREC(@05),B'00001000'                        02S0072 00190000
         BNZ   @RF00072                                         02S0072 00191000
*  DO;                                 /*NO, SET UP TO READ          */ 00192000
*    READEPA=READEPA && READEPA;       /*CLEAR EPA                   */ 00193000
         XC    READEPA(16),READEPA                              02S0074 00194000
*    SWACTLS=SWACTLS && SWACTLS;       /*CLEAR SWA MNGR INTERFACE MAP*/ 00195000
         LH    @05,SWACTLS                                      02S0075 00196000
         N     @05,@CF01316                                     02S0075 00197000
         LR    @15,@05                                          02S0075 00198000
         XR    @15,@05                                          02S0075 00199000
         STH   @15,SWACTLS                                      02S0075 00200000
*    SWREAD=ON;                        /*READ FUNCTION REQUIRED      */ 00201000
*    SWMOD=ON;                         /*MODIFY EXISTING EPA         */ 00202000
         OI    SWREAD,B'00100010'                               02S0077 00203000
*  END;                                /*END SET UP TO READ          */ 00204000
*ELSE;                                 /*RECORDS ARE IN CORE         */ 00205000
@RF00072 DS    0H                                               02S0080 00206000
*IF READALL=ON THEN                    /*READ AND CHAIN ALL RECORDS  */ 00207000
         L     @05,@PC00001                                     02S0080 00208000
         TM    READALL(@05),B'00010000'                         02S0080 00209000
         BNO   @RF00080                                         02S0080 00210000
*  DO;                                 /*YES, READ THEM ALL IN       */ 00211000
*    SVA=JCTDETDA;                     /*GET SVA OF FIRST RECORD     */ 00212000
         L     @05,@PC00001+4                                   02S0082 00213000
         L     @05,JCTPTR(,@05)                                 02S0082 00214000
         MVC   SVA(3),JCTDETDA(@05)                             02S0082 00215000
*    FRSTREAD=ON;                      /*ASSUME PROCESSING FIRST REC */ 00216000
         OI    FRSTREAD,B'00001000'                             02S0083 00217000
*    DO WHILE(SVA^=ZERO);              /*READ AND CHAIN ALL RECORDS  */ 00218000
         B     @DE00084                                         02S0084 00219000
@DL00084 DS    0H                                               02S0085 00220000
*      CALL IEFAB4F7(SWACTLS,ADDR(READEPA),0,ADDR(SVAID),       02S0085 00221000
*                    ADDR(BLOCK),0,1); /*SWA MNGR INTFC RTN TO READ  */ 00222000
         LA    @05,SWACTLS                                      02S0085 00223000
         ST    @05,@AL00001                                     02S0085 00224000
         LA    @05,READEPA                                      02S0085 00225000
         ST    @05,@TF00001                                     02S0085 00226000
         LA    @05,@TF00001                                     02S0085 00227000
         ST    @05,@AL00001+4                                   02S0085 00228000
         LA    @05,@CF00182                                     02S0085 00229000
         ST    @05,@AL00001+8                                   02S0085 00230000
         LA    @05,SVAID                                        02S0085 00231000
         ST    @05,@TF00002                                     02S0085 00232000
         LA    @05,@TF00002                                     02S0085 00233000
         ST    @05,@AL00001+12                                  02S0085 00234000
         LA    @05,BLOCK                                        02S0085 00235000
         ST    @05,@TF00003                                     02S0085 00236000
         LA    @05,@TF00003                                     02S0085 00237000
         ST    @05,@AL00001+16                                  02S0085 00238000
         LA    @05,@CF00182                                     02S0085 00239000
         ST    @05,@AL00001+20                                  02S0085 00240000
         LA    @05,@CF00099                                     02S0085 00241000
         ST    @05,@AL00001+24                                  02S0085 00242000
         L     @15,@CV00211                                     02S0085 00243000
         LA    @01,@AL00001                                     02S0085 00244000
         BALR  @14,@15                                          02S0085 00245000
*      IF FRSTREAD=ON THEN             /*FIRST RECORD JUST READ      */ 00246000
         TM    FRSTREAD,B'00001000'                             02S0086 00247000
         BNO   @RF00086                                         02S0086 00248000
*        DO;                           /*YES, PERFORM SPECIAL PROCESS*/ 00249000
*          FIRSTREC=BLOCK;             /*SAVE ADDR OF FIRST RECORD   */ 00250000
         L     @07,@PC00001+36                                  02S0088 00251000
         L     @05,BLOCK                                        02S0088 00252000
         ST    @05,FIRSTREC(,@07)                               02S0088 00253000
*          FRSTREAD=OFF;               /*INDICATE NOT FIRST READ     */ 00254000
         NI    FRSTREAD,B'11110111'                             02S0089 00255000
*        END;                          /*END FIRST RECORD PROCESSING */ 00256000
*      ELSE                            /*RECORD OTHER THAN THE FIRST */ 00257000
*        DSNQNEXT=BLOCK;               /*CHAIN THIS RECORD TO LAST   */ 00258000
         B     @RC00086                                         02S0091 00259000
@RF00086 L     @05,BLOCK                                        02S0091 00260000
         ST    @05,DSNQNEXT(,DSNQPTR)                           02S0091 00261000
*      DSNQPTR=BLOCK;                  /*ADDRESS OF DSENQ RECORD     */ 00262000
@RC00086 L     DSNQPTR,BLOCK                                    02S0092 00263000
*      SVA=DSNQNSVA;                   /*SVA OF NEXT RECORD          */ 00264000
         MVC   SVA(3),DSNQNSVA(DSNQPTR)                         02S0093 00265000
*    END;                              /*END READ AND CHAIN ALL RECS */ 00266000
@DE00084 ICM   @05,7,SVA                                        02S0094 00267000
         BNZ   @DL00084                                         02S0094 00268000
*  END;                                /*END READ THEM ALL IN        */ 00269000
*IF READALL=ON | INCORREC=ON THEN      /*RECORDS CHAINED IN CORE     */ 00270000
@RF00080 L     @05,@PC00001                                     02S0096 00271000
         TM    READALL(@05),B'00011000'                         02S0096 00272000
         BZ    @RF00096                                         02S0096 00273000
*  DO;                                 /*YES, READ NOT NECESSARY     */ 00274000
*    NOREAD=ON;                        /*INDICATE READ NOT NECESSARY */ 00275000
         OI    NOREAD,B'00000100'                               02S0098 00276000
*    RECPTR=FIRSTREC;                  /*GET ADDR OF FIRST RECORD    */ 00277000
         L     @05,@PC00001+36                                  02S0099 00278000
         L     RECPTR,FIRSTREC(,@05)                            02S0099 00279000
*  END;                                /*END READ NOT NECESSARY      */ 00280000
*ELSE                                  /*RECORDS NOT IN CORE         */ 00281000
*  DO;                                 /*PREPARE TO READ DSENQ RECS  */ 00282000
         B     @RC00096                                         02S0101 00283000
@RF00096 DS    0H                                               02S0102 00284000
*    NOREAD=OFF;                       /*READ NECESSARY FOR RECORDS  */ 00285000
         NI    NOREAD,B'11111011'                               02S0102 00286000
*    SVA=JCTDETDA;                     /*SVA OF FIRST DSENQ RECORD   */ 00287000
         L     @05,@PC00001+4                                   02S0103 00288000
         L     @05,JCTPTR(,@05)                                 02S0103 00289000
         MVC   SVA(3),JCTDETDA(@05)                             02S0103 00290000
*  END;                                /*END PREPARE TO READ DSENQ   */ 00291000
*DO WHILE( DSNFOUND=OFF &                                       02S0105 00292000
*          ( (NOREAD=ON & RECPTR^=ZERO) | /*SEARCH IN CORE RECORDS      00293000
*                                        TILL NAME FOUND OR TABLE END*/ 00294000
*            (NOREAD=OFF &  SVA^=ZERO) ) ); /*READ & SEARCH DSENQ RECS  00295000
*                                        UNTIL NAME FOUND OR TBL END */ 00296000
@RC00096 B     @DE00105                                         02S0105 00297000
@DL00105 DS    0H                                               02S0106 00298000
*  IF NOREAD=OFF THEN                  /*ARE RECORDS CHAINED IN CORE */ 00299000
         TM    NOREAD,B'00000100'                               02S0106 00300000
         BNZ   @RF00106                                         02S0106 00301000
*    DO;                               /*NO, READ A DSENQ RECORD     */ 00302000
*      CALL IEFAB4F7(SWACTLS,ADDR(READEPA),0,ADDR(SVAID),       02S0108 00303000
*                ADDR(BLOCK),0,1);     /*SWA MNGR INTFC RTN TO READ  */ 00304000
         LA    @06,SWACTLS                                      02S0108 00305000
         ST    @06,@AL00001                                     02S0108 00306000
         LA    @06,READEPA                                      02S0108 00307000
         ST    @06,@TF00001                                     02S0108 00308000
         LA    @06,@TF00001                                     02S0108 00309000
         ST    @06,@AL00001+4                                   02S0108 00310000
         LA    @06,@CF00182                                     02S0108 00311000
         ST    @06,@AL00001+8                                   02S0108 00312000
         LA    @06,SVAID                                        02S0108 00313000
         ST    @06,@TF00002                                     02S0108 00314000
         LA    @06,@TF00002                                     02S0108 00315000
         ST    @06,@AL00001+12                                  02S0108 00316000
         LA    @06,BLOCK                                        02S0108 00317000
         ST    @06,@TF00003                                     02S0108 00318000
         LA    @06,@TF00003                                     02S0108 00319000
         ST    @06,@AL00001+16                                  02S0108 00320000
         LA    @06,@CF00182                                     02S0108 00321000
         ST    @06,@AL00001+20                                  02S0108 00322000
         LA    @06,@CF00099                                     02S0108 00323000
         ST    @06,@AL00001+24                                  02S0108 00324000
         L     @15,@CV00211                                     02S0108 00325000
         LA    @01,@AL00001                                     02S0108 00326000
         BALR  @14,@15                                          02S0108 00327000
*      DSNQPTR=BLOCK;                  /*ADDRESS OF DSENQ RECORD     */ 00328000
         L     DSNQPTR,BLOCK                                    02S0109 00329000
*    END;                              /*END READ A DSENQ RECORD     */ 00330000
*  ELSE                                /*RECORDS ARE CHAINED IN CORE */ 00331000
*    DSNQPTR=RECPTR;                   /*ADDR OF CURRENT RECORD      */ 00332000
         B     @RC00106                                         02S0111 00333000
@RF00106 LR    DSNQPTR,RECPTR                                   02S0111 00334000
*  DSNQENTP=ADDR(DSNQENTS);            /*ADDRESS OF FIRST DSENQ ENTRY*/ 00335000
@RC00106 LA    DSNQENTP,DSNQENTS(,DSNQPTR)                      02S0112 00336000
*  ENDRCRD=DSNQPTR+BLOCKLEN-DSNQFREE;  /*END OF BYTES USED THIS REC  */ 00337000
         LR    ENDRCRD,DSNQPTR                                  02S0113 00338000
         AL    ENDRCRD,BLOCKLEN                                 02S0113 00339000
         SH    ENDRCRD,DSNQFREE(,DSNQPTR)                       02S0113 00340000
*  DO WHILE(DSNFOUND=OFF & DSNQENTP<ENDRCRD); /*SEARCH DSENQ REC DSN */ 00341000
         B     @DE00114                                         02S0114 00342000
@DL00114 DS    0H                                               02S0115 00343000
*    IF DSNQDSNL=REALNGTH &            /*LENGTHS ARE EQUAL           */ 00344000
*       DSNQDSN(1:DSNQDSNL)=DSNAME(1:DSNQDSNL) THEN /*DSNAMES EQUAL  */ 00345000
         SLR   @15,@15                                          02S0115 00346000
         IC    @15,DSNQDSNL(,DSNQENTP)                          02S0115 00347000
         CR    @15,REALNGTH                                     02S0115 00348000
         BNE   @RF00115                                         02S0115 00349000
         L     @14,@PC00001+8                                   02S0115 00350000
         BCTR  @15,0                                            02S0115 00351000
         EX    @15,@SC01321                                     02S0115 00352000
         BNE   @RF00115                                         02S0115 00353000
*      DSNFOUND=ON;                    /*INDICATE ENTRY FOUND        */ 00354000
         OI    DSNFOUND,B'01000000'                             02S0116 00355000
*    ELSE                              /*ENTRY DOESN'T MATCH DSNAME  */ 00356000
*      DSNQENTP=DSNQENTP+ENTRYHDR+DSNQDSNL; /*ADDR NEXT DSENQ ENTRY  */ 00357000
         B     @RC00115                                         02S0117 00358000
@RF00115 LR    @15,DSNQENTP                                     02S0117 00359000
         AL    @15,ENTRYHDR                                     02S0117 00360000
         SLR   @14,@14                                          02S0117 00361000
         IC    @14,DSNQDSNL(,DSNQENTP)                          02S0117 00362000
         ALR   @15,@14                                          02S0117 00363000
         LR    DSNQENTP,@15                                     02S0117 00364000
*  END;                                                         02S0118 00365000
@RC00115 DS    0H                                               02S0118 00366000
@DE00114 TM    DSNFOUND,B'01000000'                             02S0118 00367000
         BNZ   @DC00114                                         02S0118 00368000
         CR    DSNQENTP,ENDRCRD                                 02S0118 00369000
         BL    @DL00114                                         02S0118 00370000
@DC00114 DS    0H                                               02S0119 00371000
*  IF DSNFOUND=OFF THEN                /*ENTRY NOT FOUND YET         */ 00372000
         TM    DSNFOUND,B'01000000'                             02S0119 00373000
         BNZ   @RF00119                                         02S0119 00374000
*    DO;                               /*YES, READ NEXT RECORD       */ 00375000
*      IF SAVEREC=ZERO & ENTRYLNG<=DSNQFREE THEN /*NEW ENTRY WILL FIT*/ 00376000
         LTR   SAVEREC,SAVEREC                                  02S0121 00377000
         BNZ   @RF00121                                         02S0121 00378000
         CH    ENTRYLNG,DSNQFREE(,DSNQPTR)                      02S0121 00379000
         BH    @RF00121                                         02S0121 00380000
*        SAVEREC=DSNQPTR;              /*SAVE ADDRESS OF RECORD      */ 00381000
         LR    SAVEREC,DSNQPTR                                  02S0122 00382000
*      IF NOREAD=ON THEN               /*RECORDS CHAINED IN CORE?    */ 00383000
@RF00121 TM    NOREAD,B'00000100'                               02S0123 00384000
         BNO   @RF00123                                         02S0123 00385000
*        RECPTR=DSNQNEXT;              /*YES, GET ADDR OF NEXT RECORD*/ 00386000
         L     RECPTR,DSNQNEXT(,DSNQPTR)                        02S0124 00387000
*      ELSE                            /*RECORDS NEED TO BE READ     */ 00388000
*        SVA=DSNQNSVA;                 /*PREPARE FOR NEXT READ       */ 00389000
         B     @RC00123                                         02S0125 00390000
@RF00123 MVC   SVA(3),DSNQNSVA(DSNQPTR)                         02S0125 00391000
*    END;                              /*END READ NEXT RECORD        */ 00392000
@RC00123 DS    0H                                               02S0127 00393000
*END;                                  /*END SEARCH DSENQ TABLE      */ 00394000
@RF00119 DS    0H                                               02S0127 00395000
@DE00105 TM    DSNFOUND,B'01000000'                             02S0127 00396000
         BNZ   @DC00105                                         02S0127 00397000
         TM    NOREAD,B'00000100'                               02S0127 00398000
         BNO   @GL00006                                         02S0127 00399000
         LTR   RECPTR,RECPTR                                    02S0127 00400000
         BNZ   @DL00105                                         02S0127 00401000
@GL00006 TM    NOREAD,B'00000100'                               02S0127 00402000
         BNZ   @DC00105                                         02S0127 00403000
         ICM   @05,7,SVA                                        02S0127 00404000
         BNZ   @DL00105                                         02S0127 00405000
@DC00105 DS    0H                                               02S0128 00406000
*IF SRCHDSNM = ON & RETADDR = ON                                02S0128 00407000
*   & DSNFOUND = ON THEN               /*SEARCH              @YM07288*/ 00408000
         L     @05,@PC00001                                     02S0128 00409000
         TM    SRCHDSNM(@05),B'01000010'                        02S0128 00410000
         BNO   @RF00128                                         02S0128 00411000
         TM    DSNFOUND,B'01000000'                             02S0128 00412000
         BNO   @RF00128                                         02S0128 00413000
*  DO;                                 /*FOR DSNAME RTN PTRS @YM07288*/ 00414000
*    ENTADDR = DSNQENTP;               /*REQ & DSN FOUND,RTN @YM07288*/ 00415000
         L     @05,@PC00001+24                                  02S0130 00416000
         ST    DSNQENTP,ENTADDR(,@05)                           02S0130 00417000
*    RECADDR = DSNQPTR;                /*DSNQENTRY AND BLOCK @YM07288*/ 00418000
         ST    DSNQPTR,RECADDR(,@05)                            02S0131 00419000
*  END;                                /*POINTERS            @YM07288*/ 00420000
*  END;                                /*END DSENQ SEARCH            */ 00421000
*ELSE                                  /*ENTRY ADDRESS PASSED        */ 00422000
*  DO;                                 /*SET UP DSENQ POINTERS       */ 00423000
         B     @RC00067                                         01S0134 00424000
@RF00067 DS    0H                                               01S0135 00425000
*    DSNQENTP=ENTADDR;                 /*ADDRESS OF DSENQ ENTRY      */ 00426000
         L     @05,@PC00001+24                                  01S0135 00427000
         L     DSNQENTP,ENTADDR(,@05)                           01S0135 00428000
*    DSNQPTR=RECADDR;                  /*ADDRESS OF DSENQ RECORD     */ 00429000
         L     DSNQPTR,RECADDR(,@05)                            01S0136 00430000
*    REALNGTH=DSNQDSNL;                /*LENGTH OF DSN FROM DSENQ ENT*/ 00431000
         SLR   REALNGTH,REALNGTH                                01S0137 00432000
         IC    REALNGTH,DSNQDSNL(,DSNQENTP)                     01S0137 00433000
*    ENTRYLNG=ENTRYHDR + REALNGTH;     /*ACTUAL LENGTH OF DSENQ ENTRY*/ 00434000
         LR    ENTRYLNG,REALNGTH                                01S0138 00435000
         AL    ENTRYLNG,ENTRYHDR                                01S0138 00436000
*    DSNFOUND=ON;                      /*DSN ENTRY FOUND IN DSENQ    */ 00437000
         OI    DSNFOUND,B'01000000'                             01S0139 00438000
*  END;                                /*END ENTRY ADDRESS PASSWORD  */ 00439000
*IF ADCHONLY=ON | ADCHENQ=ON THEN      /*ADD/CHANGE FUNCTION REQUEST */ 00440000
@RC00067 L     @05,@PC00001                                     01S0141 00441000
         TM    ADCHONLY(@05),B'01100000'                        01S0141 00442000
         BZ    @RF00141                                         01S0141 00443000
*  DO;                                 /*PROCESS REQUEST             */ 00444000
*    CHSHRXCL=OFF;                     /*ASSUME USE CHANGE NOT NEEDED*/ 00445000
         NI    CHSHRXCL,B'01111111'                             01S0143 00446000
*    CHNGSTEP=OFF;                     /*ASSUME STEP NUMB OK @YM08191*/ 00447000
         NI    CHNGSTEP,B'10111111'                             01S0144 00448000
*    IF DSNFOUND=ON THEN               /*DSNAME ALREADY IN TABLE     */ 00449000
         TM    DSNFOUND,B'01000000'                             01S0145 00450000
         BNO   @RF00145                                         01S0145 00451000
*      DO;                             /*YES, CHECK REQUESTED VS.       00452000
*                                        FOUND USE ATTRIBUTES        */ 00453000
*        IF DSNQSHR=ON & ENQEXCL=ON THEN /*FOUND SHR, REQUESTED EXCL */ 00454000
         TM    DSNQSHR(DSNQENTP),B'10000000'                    01S0147 00455000
         BNO   @RF00147                                         01S0147 00456000
         TM    ENQEXCL(@05),B'00000001'                         01S0147 00457000
         BNO   @RF00147                                         01S0147 00458000
*          DO;                         /*YES, CHANGE DSENQ TABLE     */ 00459000
*            CHSHRXCL=ON;              /*INDCIATE USE CHANGE REQUIRED*/ 00460000
         OI    CHSHRXCL,B'10000000'                             01S0149 00461000
*          END;                        /*END CHANGE USE REQUIRED     */ 00462000
*        ELSE;                         /*ENTRY IS GOOD AS IS         */ 00463000
@RF00147 DS    0H                                               01S0152 00464000
*        IF STEPNUMB > DSNQSTEP THEN   /*INPUT STP > STP IN ENTRY       00465000
*                                                            @YM08191*/ 00466000
         L     @05,@PC00001+20                                  01S0152 00467000
         CLC   STEPNUMB(1,@05),DSNQSTEP(DSNQENTP)               01S0152 00468000
         BNH   @RF00152                                         01S0152 00469000
*          CHNGSTEP=ON;                /*YES,CHANGE STEP NUMB@YM08191*/ 00470000
         OI    CHNGSTEP,B'01000000'                             01S0153 00471000
*      END;                            /*END ENTRY FOUND PROCESSING  */ 00472000
@RF00152 DS    0H                                               01S0155 00473000
*    IF DSNFOUND=OFF |                 /*DSENQ ENTRY TO BE CREATED OR*/ 00474000
*       (CHSHRXCL=ON & NOSHRXCL=OFF) | /*USE ATTRIBUTE CHANGED OR    */ 00475000
*       CHNGSTEP=ON THEN               /*STEP NUMBER CHANGED?@YM08191*/ 00476000
@RF00145 TM    DSNFOUND,B'01000000'                             01S0155 00477000
         BZ    @RT00155                                         01S0155 00478000
         TM    CHSHRXCL,B'10000000'                             01S0155 00479000
         BNO   @GL00011                                         01S0155 00480000
         L     @05,@PC00001                                     01S0155 00481000
         TM    NOSHRXCL(@05),B'00000100'                        01S0155 00482000
         BZ    @RT00155                                         01S0155 00483000
@GL00011 TM    CHNGSTEP,B'01000000'                             01S0155 00484000
         BNO   @RF00155                                         01S0155 00485000
@RT00155 DS    0H                                               01S0156 00486000
*      DO;                             /*YES, UPDATE DSENQ TABLE     */ 00487000
*/********************************************************************/ 00488000
*/*                                                                  */ 00489000
*/* SEGMENT - UPDENT                                                 */ 00490000
*/*                                                                  */ 00491000
*/* DESCRIPTIVE NAME - UPDATE THE DSENQ TABLE                        */ 00492000
*/*                                                                  */ 00493000
*/* FUNCTION - TO CHANGE AN EXISTING DSENQ ENTRY FROM SHARE TO       */ 00494000
*/*            EXCLUSIVE.                                            */ 00495000
*/*            TO CHANGE THE STEP NUMBER OF AN EXISTING      @YM08191*/ 00496000
*/*            DSENQ ENTRY.                                  @YM08191*/ 00497000
*/*            TO CREATE A NEW ENTRY FOR THE INPUT DSNAME IN THE     */ 00498000
*/*            DSENQ TABLE.  IF THERE IS NO RECORD WHICH CAN CONTAIN */ 00499000
*/*            THE NEW ENTRY OR THE DSENQ TABLE DOES NOT EXIST, A    */ 00500000
*/*            RECORD IS ASSIGNED.  APPROPRIATE CHAINING     @YM08602*/ 00501000
*/*            IS DONE BY LATER PROCESSING, AFTER THE        @YM08602*/ 00502000
*/*            ASSIGNED RECORD IS WRITTEN.                   @YM08602*/ 00503000
*/*                                                                  */ 00504000
*/*            THE INPUT EPA IS UPDATED TO CHAIN EPA'S FOR ANY       */ 00505000
*/*            UPDATED RECORDS AND THE ADDRESS OF THE LAST   @YM06161*/ 00506000
*/*            EPA REPLACES THE ADDRESS OF THE INPUT LAST    @ZA04136*/ 00507000
*/*            EPA UNLESS THE CALLER REQUESTED NO EPA PROC-  @ZA04136*/ 00508000
*/*            ESSING BY SPECIFYING NEPAPROC=ON.             @ZA04136*/ 00509000
*/*            (ANY ASSIGNED RECORD WILL BE WRITTEN TO SWA   @YM06161*/ 00510000
*/*            BY LATER PROCESSING IN IEFAB4DC.)             @YM06161*/ 00511000
*/*                                                                  */ 00512000
*/* OPERATION - IF DSNFOUND IS OFF -                                 */ 00513000
*/*             IF THERE IS NO RECORD AVAILABLE WITH ROOM FOR THE    */ 00514000
*/*             NEW DSNAME ENTRY OR THE DSENQ TABLE DOES             */ 00515000
*/*             NOT YET EXIST (SAVEREC=ZERO), THE SWA MANAGER        */ 00516000
*/*             INTERFACE ROUTINE, IEFAB4F7, IS INVOKED TO ASSIGN    */ 00517000
*/*             ONE RECORD.  THE SVA OF THE ASSIGNED RECORD  @YM08602*/ 00518000
*/*             IS SAVED.  (IT WILL BE PLACED IN THE JCT OR  @YM08602*/ 00519000
*/*             THE PREVIOUS RECORD WHEN THE ASSIGNED RECORD @YM08602*/ 00520000
*/*             IS WRITTEN.)  IF THE READ AND CHAIN          @YM08602*/ 00521000
*/*             ALL DSENQ RECORDS OPTION WAS REQUESTED, THE          */ 00522000
*/*             ADDRESS OF THE ASSIGNED RECORD IS RETURNED AS THE    */ 00523000
*/*             ADDRESS OF THE FIRST DSENQ RECORD.  THE              */ 00524000
*/*             ASSIGNED RECORD IS THEN INITIALIZED.                 */ 00525000
*/*                                                                  */ 00526000
*/*             WHEN ASSIGN PROCESSING IS COMPLETE OR IF IT WAS NOT  */ 00527000
*/*             NECESSARY, A DSENQ ENTRY IS MADE FOR THIS DSNAME.    */ 00528000
*/*                                                                  */ 00529000
*/*             IF CHSHRXCL IS ON-                                   */ 00530000
*/*             CHANGE THE USE ATTRIBUTE IN THE DSENQ ENTRY,I.E.     */ 00531000
*/*             DSNQSHR IS SET OFF TO INDICATE EXCLUSIVE USE.        */ 00532000
*/*                                                          @YM08191*/ 00533000
*/*             IF CHNGSTEP IS ON -                          @YM08191*/ 00534000
*/*             CHANGE THE STEP NUMBER IN THE DSENQ ENTRY    @YM08191*/ 00535000
*/*             TO THE INPUT STEP NUMBER.                    @YM08191*/ 00536000
*/*                                                                  */ 00537000
*/*             IF THE CALLER REQUESTED EPA PROCESSING.      @ZA04136*/ 00538000
*/*             A WRITE EPA IS CREATED AND CHAINED FOR THE UPDATED   */ 00539000
*/*             RECORD (EXCEPT FOR THE JCT IF AN EPA FOR THE JCT     */ 00540000
*/*             IS ALREADY ON THE EPA CHAIN).                        */ 00541000
*/*             AS THE RECORDS ARE BEING UPDATED, THE UPDATED RECORD */ 00542000
*/*             EPA IS COMPLETED, IF REQUESTED.              @ZA04136*/ 00543000
*/*             (THE SWA MANAGER INTERFACE ROUTINE HAS BUILT @YM06161*/ 00544000
*/*             THE EPA FOR THE NEW RECORD.)                 @YM06161*/ 00545000
*/*             WHEN THE ABOVE PROCESSING IS COMPLETE, THE UPDATED   */ 00546000
*/*             RECORD EPA IS CHAINED TO THE INPUT LAST EPA AND THE  */ 00547000
*/*             INPUT LAST EPA ADDRESS IS UPDATED TO THE LAST EPA    */ 00548000
*/*             ON THE CHAIN, IF REQUESTED.                  @ZA04136*/ 00549000
*/*                                                                  */ 00550000
*/* ENTRY - UPDENT (INCLUDED SEGMENT)                                */ 00551000
*/*                                                                  */ 00552000
*/*  INPUT DATA - JCTDETDA - SVA OF FIRST DSENQ RECORD OR            */ 00553000
*/*                          ZERO (IF NO DSENQ RECORD EXISTS)        */ 00554000
*/*               SAVEREC  - ADDRESS OF RECORD WITH ROOM FOR DSNAME  */ 00555000
*/*                           ENTRY OR                               */ 00556000
*/*                          ZERO (IF AN ASSIGN IS NECESSARY)        */ 00557000
*/*               DSNLNGH  - LENGTH OF INPUT DSNAME                  */ 00558000
*/*               DSNAME   - INPUT DSNAME                            */ 00559000
*/*               STEPNUMB - INPUT STEP NUMBER                       */ 00560000
*/*               ENQSHR   - INDICATES SHARED USE OF DATA SET IF ON  */ 00561000
*/*                           EXCLUSIVE USE OTHERWISE                */ 00562000
*/*               ENTRYLNG - LENGTH OF DSN ENTRY IN DSENQ RECORD     */ 00563000
*/*               REALNGTH - ACTUAL LENGTH OF DSNAME                 */ 00564000
*/*               CHSHRXCL - ON, INDICATING CHANGE USE ATTRIBUTE     */ 00565000
*/*                          FROM SHARE TO EXCLUSIVE                 */ 00566000
*/*               EPAJCTEX - ON, INDICATING AN EPA FOR THE JCT IS    */ 00567000
*/*                          ALREADY ON THE CHAIN                    */ 00568000
*/*               DSNFOUND - OFF, INDICATING AN ENTRY SHOULD BE ADDED*/ 00569000
*/*                          TO THE DSENQ TABLE                      */ 00570000
*/*               JCTPTR   - ADDRES OF THE JCT                       */ 00571000
*/*               EPADDR   - ADDRESS OF INPUT EPA                    */ 00572000
*/*               DSNQPTR  - ADDRESS OF RECORD CONTAINING ENTRY TO   */ 00573000
*/*                          BE CHANGED                              */ 00574000
*/*               DSNQENTP - ADDRESS OF ENTRY TO BE CHANGED          */ 00575000
*/*               FIRSTREC - MAY BE USED TO CONTAIN ADDR OF FIRST REC*/ 00576000
*/*               READALL  - ON, INDICATING READ AND CHAIN ALL RECS  */ 00577000
*/*               ASSIGN   - OFF, INDICATING ASSIGN HAS NOT  @YM06161*/ 00578000
*/*                          YET BEEN DONE.                  @YM06161*/ 00579000
*/*               CHNGSTEP - ON, INDICATING CHANGE THE       @YM08191*/ 00580000
*/*                          STEP NUMBER IN THE DSENQ        @YM08191*/ 00581000
*/*                          ENTRY.                          @YM08191*/ 00582000
*/*                                                                  */ 00583000
*/* EXIT - TO NEXT SEQUENTIAL INSTRUCTION                            */ 00584000
*/*                                                                  */ 00585000
*/*  OUTPUT DATA - IF AN ASSIGN WAS NECESSARY AND NO DSENQ TABLE     */ 00586000
*/*                EXISTS                                            */ 00587000
*/*                   ASGNDSVA IS SET TO THE ASSIGNED SVA.   @YM08602*/ 00588000
*/*                   AN EPA FOR THE JCT IS PLACED ON THE    @ZA04136*/ 00589000
*/*                   CHAIN ONLY IF THE EPA FOR THE JCT IS   @ZA04136*/ 00590000
*/*                   NOT ALREADY ON THE EPA CHAIN, AND      @ZA04136*/ 00591000
*/*                   NEPAPROC = OFF.                        @ZA04136*/ 00592000
*/*                   EPAJCTEX SET ON IF AN EPA ADDED FOR THE JCT.   */ 00593000
*/*                   FIRSTREC SET TO THE ADDRESS OF FIRST DSENQ     */ 00594000
*/*                            RECORD IF READALL IS ON.              */ 00595000
*/*                   ASSIGN SET ON TO CAUSE LATER           @YM06161*/ 00596000
*/*                   PROCESSING TO WRITE THE ASSIGNED       @YM06161*/ 00597000
*/*                   RECORD TO SWA.                         @YM06161*/ 00598000
*/*                                                                  */ 00599000
*/*                IF AN ASSIGN WAS NECESSARY AND THE DSENQ TABLE    */ 00600000
*/*                EXISTS                                            */ 00601000
*/*                   ASGNDSVA IS SET TO THE ASSIGNED SVA.   @YM08602*/ 00602000
*/*                   DSNQNEXT IS SET TO THE ASSIGNED ADDRESS AND    */ 00603000
*/*                            THE ASSIGNED RECORD BECOMES THE LAST  */ 00604000
*/*                            DSENQ RECORD.                         */ 00605000
*/*                   SAVDSNQP IS SET TO THE ADDRESS OF THE  @YM08602*/ 00606000
*/*                            BLOCK IN WHICH TO PLACE THE   @YM08602*/ 00607000
*/*                            SVA OF THE ASSIGNED BLOCK.    @YM08602*/ 00608000
*/*                   AN EPA FOR THE UPDATED RECORD IS               */ 00609000
*/*                   PLACED ON THE CHAIN.                           */ 00610000
*/*                   ASSIGN SET ON TO CAUSE LATER           @YM06161*/ 00611000
*/*                   PROCESSING TO WRITE THE ASSIGNED       @YM06161*/ 00612000
*/*                   RECORD TO SWA.                         @YM06161*/ 00613000
*/*                                                                  */ 00614000
*/*                IF NO ASSIGN WAS NECESSARY OR THE USE ATTRIBUTES  */ 00615000
*/*                WERE CHANGED, AN EPA FOR THE UPDATED RECORD IS    */ 00616000
*/*                PLACED ON THE CHAIN, IF NEPAPROC = OFF.   @ZA04136*/ 00617000
*/*                                                                  */ 00618000
*/*                IF AN ASSIGN WAS NECESSARY, THE RECORD IS         */ 00619000
*/*                INITIALIZED (SEE OPERATION TEXT).                 */ 00620000
*/*                                                                  */ 00621000
*/*                IN ALL CASES THE DSNAME ENTRY IS CREATED IN THE   */ 00622000
*/*                RECORD (SEE OPERATION TEXT).                      */ 00623000
*/*                                                                  */ 00624000
*/*                DSNQENTP CONTAINS THE ADDRESS OF THE NEW DSENQ    */ 00625000
*/*                ENTRY.                                            */ 00626000
*/*                                                                  */ 00627000
*/*                DSNQPTR CONTAINS THE ADDRESS OF THE DSENQ RECORD  */ 00628000
*/*                CONTAINING THE ENTRY.                             */ 00629000
*/*                                                                  */ 00630000
*/*                EPADDR CONTAINS THE ADDRESS OF THE LAST EPA       */ 00631000
*/*                PLACED ON THE CHAIN, IF NEPAPROC = OFF.   @ZA04136*/ 00632000
*/*                                                                  */ 00633000
*/********************************************************************/ 00634000
*UPDATE=OFF;                           /*ASSUME NO REC UPDATE@YM06161*/ 00635000
         NI    UPDATE,B'01111111'                               02S0157 00636000
*IF (CHNGSTEP=ON |                     /*CHNG STEP NUMBER    @ZA04136*/ 00637000
*   CHSHRXCL=ON |                      /*CHANGE USE OF EXISTING ENTRY*/ 00638000
*   SAVEREC^=ZERO |                    /*ASSIGN IS NOT NECESSARY     */ 00639000
*   JCTDETDA^=ZERO |                   /*DSENQ TABLE EXISTS          */ 00640000
*   EPAJCTEX=OFF) &                    /*JCT EPA NOT ON CHAIN@ZA04136*/ 00641000
*   NEPAPROC=OFF THEN                  /*CALLER WANTS EPA    @ZA04136*/ 00642000
         TM    CHNGSTEP,B'01000000'                             02S0158 00643000
         BO    @GL00014                                         02S0158 00644000
         TM    CHSHRXCL,B'10000000'                             02S0158 00645000
         BO    @GL00014                                         02S0158 00646000
         LTR   SAVEREC,SAVEREC                                  02S0158 00647000
         BNZ   @GL00014                                         02S0158 00648000
         L     @05,@PC00001+4                                   02S0158 00649000
         L     @05,JCTPTR(,@05)                                 02S0158 00650000
         ICM   @02,7,JCTDETDA(@05)                              02S0158 00651000
         BNZ   @GL00014                                         02S0158 00652000
         L     @05,@PC00001                                     02S0158 00653000
         TM    EPAJCTEX(@05),B'00000100'                        02S0158 00654000
         BNZ   @RF00158                                         02S0158 00655000
@GL00014 L     @05,@PC00001                                     02S0158 00656000
         TM    NEPAPROC(@05),B'00000001'                        02S0158 00657000
         BNZ   @RF00158                                         02S0158 00658000
*  DO;                                 /*YES, GETMAIN FOR EPA FOR       00659000
*                                        UPDATED RECORD, OR RECORD TO   00660000
*                                        WHICH NEW RECORD WILL BE       00661000
*                                        CHAINED, OR FOR JCT IF TABLE   00662000
*                                        DOES NOT EXIST.             */ 00663000
*    RFY (R0,R1) RESTRICTED;           /*RESTRICT REGISTERS 0 AND 1  */ 00664000
*    R0=LENGTH(SWAEPA);                /*LENGTH OF EPA               */ 00665000
         LA    R0,16                                            02S0161 00666000
*    R0=R0 | SUBPOLNO;                 /*GET FROM CORRECT SUBPOOL    */ 00667000
         O     R0,SUBPOLNO                                      02S0162 00668000
*    GENERATE;                         /*GET CORE FOR EPA            */ 00669000
     GETMAIN R,LV=(0)                                                   00670000
*    SWEPAPTR=R1;                      /*ADDR OF FIRST EPA TO CHAIN  */ 00671000
         LR    SWEPAPTR,R1                                      02S0164 00672000
*    SWAEPA=SWAEPA && SWAEPA;          /*CLEAR THE EPA               */ 00673000
         XC    SWAEPA(16,SWEPAPTR),SWAEPA(SWEPAPTR)             02S0165 00674000
*    UPDATE=ON;                        /*RECORD UPDATED      @YM06161*/ 00675000
         OI    UPDATE,B'10000000'                               02S0166 00676000
*    RFY (R0,R1) UNRESTRICTED;         /*RELEASE REGISTERS 0 AND 1   */ 00677000
*  END;                                /*END GETMAIN FOR EPA         */ 00678000
*UPJCTEPA=OFF;                         /*ASSUME JCT EPA NOT TO BE       00679000
*                                        PUT ON CHAIN                */ 00680000
@RF00158 NI    UPJCTEPA,B'11011111'                             02S0169 00681000
*IF DSNFOUND=OFF THEN                  /*ADD FUNCTION TO BE PERFORMED*/ 00682000
         TM    DSNFOUND,B'01000000'                             02S0170 00683000
         BNZ   @RF00170                                         02S0170 00684000
*  DO;                                 /*ADD ENTRY TO DSENQ TABLE    */ 00685000
*    IF SAVEREC=ZERO THEN              /*IS AN ASSIGN NECESSARY      */ 00686000
         LTR   SAVEREC,SAVEREC                                  02S0172 00687000
         BNZ   @RF00172                                         02S0172 00688000
*      DO;                             /*YES, INVOKE SWA MNGR        */ 00689000
*        SWACTLS=SWACTLS && SWACTLS;   /*ZERO CONTROL SWITCHES       */ 00690000
         LH    @08,SWACTLS                                      02S0174 00691000
         N     @08,@CF01316                                     02S0174 00692000
         LR    @06,@08                                          02S0174 00693000
         XR    @06,@08                                          02S0174 00694000
         STH   @06,SWACTLS                                      02S0174 00695000
*        ASSGNEPA=ASSGNEPA && ASSGNEPA; /*CLEAR ASSIGN EPA   @YM06161*/ 00696000
         XC    ASSGNEPA(16),ASSGNEPA                            02S0175 00697000
*        SWASN=ON;                     /*ASSIGN FUNCTION             */ 00698000
*        SWMOD=ON;                     /*USE EPA PASSED      @YM06161*/ 00699000
         OI    SWASN,B'10000010'                                02S0177 00700000
*        TID=DSNQTID;                  /*ID OF DSENQ TABLE           */ 00701000
         MVI   TID,X'0F'                                        02S0178 00702000
*        ASSIGN=ON;                    /*RECORD ASSIGNED     @YM06161*/ 00703000
         OI    ASSIGN,B'00000001'                               02S0179 00704000
*        CALL IEFAB4F7                                          02S0180 00705000
*        (SWACTLS,ADDR(ASSGNEPA),0,ADDR(SVAID),                 02S0180 00706000
*               ADDR(BLOCK),BLOCKLEN,1); /*ASSIGN NEW DSENQ RECORD   */ 00707000
         LA    @08,SWACTLS                                      02S0180 00708000
         ST    @08,@AL00001                                     02S0180 00709000
         LA    @08,ASSGNEPA                                     02S0180 00710000
         ST    @08,@TF00001                                     02S0180 00711000
         LA    @08,@TF00001                                     02S0180 00712000
         ST    @08,@AL00001+4                                   02S0180 00713000
         LA    @08,@CF00182                                     02S0180 00714000
         ST    @08,@AL00001+8                                   02S0180 00715000
         LA    @08,SVAID                                        02S0180 00716000
         ST    @08,@TF00002                                     02S0180 00717000
         LA    @08,@TF00002                                     02S0180 00718000
         ST    @08,@AL00001+12                                  02S0180 00719000
         LA    @08,BLOCK                                        02S0180 00720000
         ST    @08,@TF00003                                     02S0180 00721000
         LA    @08,@TF00003                                     02S0180 00722000
         ST    @08,@AL00001+16                                  02S0180 00723000
         LA    @08,BLOCKLEN                                     02S0180 00724000
         ST    @08,@AL00001+20                                  02S0180 00725000
         LA    @08,@CF00099                                     02S0180 00726000
         ST    @08,@AL00001+24                                  02S0180 00727000
         L     @15,@CV00211                                     02S0180 00728000
         LA    @01,@AL00001                                     02S0180 00729000
         BALR  @14,@15                                          02S0180 00730000
*        ASGNDSVA = SVA;               /*SAVE ASSIGNED SVA.  @YM08602*/ 00731000
         MVC   ASGNDSVA(3),SVA                                  02S0181 00732000
*        IF JCTDETDA=ZERO THEN         /*DOES DSENQ TABLE EXIST      */ 00733000
         L     @08,@PC00001+4                                   02S0182 00734000
         L     @08,JCTPTR(,@08)                                 02S0182 00735000
         ICM   @06,7,JCTDETDA(@08)                              02S0182 00736000
         BNZ   @RF00182                                         02S0182 00737000
*          DO;                         /*NO, START DSENQ CHAIN AT JCT*/ 00738000
*            IF READALL=ON THEN        /*READ AND CHAIN ALL RECORDS  */ 00739000
         L     @08,@PC00001                                     02S0184 00740000
         TM    READALL(@08),B'00010000'                         02S0184 00741000
         BNO   @RF00184                                         02S0184 00742000
*              FIRSTREC=BLOCK;         /*YES, SAVE ADDR OF FIRST REC */ 00743000
         L     @08,@PC00001+36                                  02S0185 00744000
         L     @05,BLOCK                                        02S0185 00745000
         ST    @05,FIRSTREC(,@08)                               02S0185 00746000
*            IF EPAJCTEX=OFF &         /*JCT EPA ON CHAIN    @ZA04136*/ 00747000
*               NEPAPROC = OFF THEN    /*CALLER WANTS EPA    @ZA04136*/ 00748000
@RF00184 L     @08,@PC00001                                     02S0186 00749000
         TM    EPAJCTEX(@08),B'00000101'                        02S0186 00750000
         BNZ   @RF00186                                         02S0186 00751000
*              DO;                     /*NO, FILL IN EPA FOR JCT     */ 00752000
*                SWBLKPTR=JCTPTR;      /*ADDRESS OF THE JCT          */ 00753000
         L     @08,@PC00001+4                                   02S0188 00754000
         L     @08,JCTPTR(,@08)                                 02S0188 00755000
         ST    @08,SWBLKPTR(,SWEPAPTR)                          02S0188 00756000
*                SWVA=JCTDSKAD;        /*SVA OF JCT                  */ 00757000
         MVC   SWVA(3,SWEPAPTR),JCTDSKAD(@08)                   02S0189 00758000
*                SWBLKID=JCTIDENT;     /*ID OF JCT                   */ 00759000
         MVC   SWBLKID(1,SWEPAPTR),JCTIDENT(@08)                02S0190 00760000
*                SWLNGTH=BLOCKLEN;     /*LENGTH OF JCT               */ 00761000
         L     @08,BLOCKLEN                                     02S0191 00762000
         ST    @08,SWLNGTH(,SWEPAPTR)                           02S0191 00763000
*                UPJCTEPA=ON;          /*EPA FOR JCT PUT ON CHAIN    */ 00764000
         OI    UPJCTEPA,B'00100000'                             02S0192 00765000
*              END;                    /*END FILL IN EPA FOR JCT     */ 00766000
*          END;                        /*END START CHAIN AT JCT      */ 00767000
*        ELSE                          /*DSENQ TABLE ALREADY EXISTS  */ 00768000
*          DO;                         /*CHAIN NEW RECORD            */ 00769000
         B     @RC00182                                         02S0195 00770000
@RF00182 DS    0H                                               02S0196 00771000
*            DSNQNEXT=BLOCK;           /*ADDR OF NEW DSENQ RECORD    */ 00772000
         L     @08,BLOCK                                        02S0196 00773000
         ST    @08,DSNQNEXT(,DSNQPTR)                           02S0196 00774000
*            SAVDSNQP = DSNQPTR;       /*SAVE CURNT BLK PTR. @ZA04136*/ 00775000
         LR    SAVDSNQP,DSNQPTR                                 02S0197 00776000
*            IF NEPAPROC = OFF THEN    /*CALLER WANTS EPA?   @ZA04136*/ 00777000
         L     @08,@PC00001                                     02S0198 00778000
         TM    NEPAPROC(@08),B'00000001'                        02S0198 00779000
         BNZ   @RF00198                                         02S0198 00780000
*              DO;                     /*YES-                @ZA04136*/ 00781000
*                SWBLKPTR=DSNQPTR;     /*ADDR OLD DSENQ REC  @ZA04136*/ 00782000
         ST    DSNQPTR,SWBLKPTR(,SWEPAPTR)                      02S0200 00783000
*                SWVA=DSNQSVA;         /*SVA OLD DSENQ REC   @ZA04136*/ 00784000
         MVC   SWVA(3,SWEPAPTR),DSNQSVA(DSNQPTR)                02S0201 00785000
*                SWBLKID=DSNQID;       /*ID OF OLD DSENQ REC @ZA04136*/ 00786000
         MVC   SWBLKID(1,SWEPAPTR),DSNQID(DSNQPTR)              02S0202 00787000
*                SWLNGTH=BLOCKLEN;     /*LENG OLD DSENQ REC  @ZA04136*/ 00788000
         L     @08,BLOCKLEN                                     02S0203 00789000
         ST    @08,SWLNGTH(,SWEPAPTR)                           02S0203 00790000
*              END;                    /*                    @ZA04136*/ 00791000
*          END;                        /*END CHAIN NEW RECORD        */ 00792000
@RF00198 DS    0H                                               02S0206 00793000
*        DSNQPTR=BLOCK;                /*ADDRESS OF NEW RECORD       */ 00794000
@RC00182 L     DSNQPTR,BLOCK                                    02S0206 00795000
*        DSNQENTP=ADDR(DSNQENTS);      /*ADDRESS OF FIRST ENTRY      */ 00796000
         LA    DSNQENTP,DSNQENTS(,DSNQPTR)                      02S0207 00797000
*        DSNQSVA=SVA;                  /*SVA OF THIS RECORD          */ 00798000
         MVC   DSNQSVA(3,DSNQPTR),SVA                           02S0208 00799000
*        DSNQID=DSNQTID;               /*DSENQ ID IS '0F'X           */ 00800000
         MVI   DSNQID(DSNQPTR),X'0F'                            02S0209 00801000
*        DSNQFREE=LENGTH(DSNQENTS);    /*NUMBER OF AVAILABLE BYTES   */ 00802000
         MVC   DSNQFREE(2,DSNQPTR),@CH00283                     02S0210 00803000
*      END;                            /*END ASSIGN DSENQ RECORD     */ 00804000
*    ELSE                              /*ASSIGN IS NOT NECESSARY     */ 00805000
*      DO;                             /*SAVE PTRS TO CHAIN EPA      */ 00806000
         B     @RC00172                                         02S0212 00807000
@RF00172 DS    0H                                               02S0213 00808000
*        DSNQPTR=SAVEREC;              /*ADDRESS OF DSENQ RECORD WITH   00809000
*                                        ROOM FOR THE NEW ENTRY      */ 00810000
         LR    DSNQPTR,SAVEREC                                  02S0213 00811000
*        IF NEPAPROC = OFF THEN        /*CALLER WANTS EPA?   @ZA04136*/ 00812000
         L     @08,@PC00001                                     02S0214 00813000
         TM    NEPAPROC(@08),B'00000001'                        02S0214 00814000
         BNZ   @RF00214                                         02S0214 00815000
*          DO;                         /*YES -               @ZA04136*/ 00816000
*             SWBLKPTR=DSNQPTR;        /*ADDR OF DSENQ REC   @ZA04136*/ 00817000
         ST    DSNQPTR,SWBLKPTR(,SWEPAPTR)                      02S0216 00818000
*            SWVA=DSNQSVA;             /*SVA OF DSENQ RECORD @ZA04136*/ 00819000
         MVC   SWVA(3,SWEPAPTR),DSNQSVA(DSNQPTR)                02S0217 00820000
*            SWBLKID=DSNQID;           /*ID OF DSENQ RECORD  @ZA04136*/ 00821000
         MVC   SWBLKID(1,SWEPAPTR),DSNQID(DSNQPTR)              02S0218 00822000
*            SWLNGTH=BLOCKLEN;         /*LENGTH OF DSENQ REC @ZA04136*/ 00823000
         L     @08,BLOCKLEN                                     02S0219 00824000
         ST    @08,SWLNGTH(,SWEPAPTR)                           02S0219 00825000
*          END;                        /*                    @ZA04136*/ 00826000
*      END;                            /*END SAVE PTRS TO CHAIN EPA  */ 00827000
@RF00214 DS    0H                                               02S0222 00828000
*    DSNQENTP=DSNQPTR+176-DSNQFREE;    /*ADDR OF AVAILABLE ENTRY     */ 00829000
@RC00172 LA    DSNQENTP,176                                     02S0222 00830000
         ALR   DSNQENTP,DSNQPTR                                 02S0222 00831000
         SH    DSNQENTP,DSNQFREE(,DSNQPTR)                      02S0222 00832000
*    DSNQSTEP=STEPNUMB;                /*SET STEP NUMBER             */ 00833000
         L     @08,@PC00001+20                                  02S0223 00834000
         IC    @05,STEPNUMB(,@08)                               02S0223 00835000
         STC   @05,DSNQSTEP(,DSNQENTP)                          02S0223 00836000
*    DSNQFLG1=CLEAR;                   /*CLEAR FLAG FIELD    @ZA10134*/ 00837000
         MVC   DSNQFLG1(1,DSNQENTP),CLEAR                       02S0224 00838000
*    IF ENQSHR=ON THEN                 /*REQUEST FOR SHARED USAGE    */ 00839000
         L     @08,@PC00001                                     02S0225 00840000
         TM    ENQSHR(@08),B'00000010'                          02S0225 00841000
         BNO   @RF00225                                         02S0225 00842000
*      DSNQSHR=ON;                     /*YES, SET SHARE IN DSENQ     */ 00843000
         OI    DSNQSHR(DSNQENTP),B'10000000'                    02S0226 00844000
*    DSNQDSNL=REALNGTH;                /*LENGTH OF DSNAME            */ 00845000
@RF00225 STC   REALNGTH,DSNQDSNL(,DSNQENTP)                     02S0227 00846000
*    DSNQDSN(1:REALNGTH)=DSNAME(1:REALNGTH); /*DSNAME                */ 00847000
         LR    @08,REALNGTH                                     02S0228 00848000
         BCTR  @08,0                                            02S0228 00849000
         L     @05,@PC00001+8                                   02S0228 00850000
         EX    @08,@SM01330                                     02S0228 00851000
*    DSNQFREE=DSNQFREE-ENTRYLNG;       /*UPDATE AVAILABLE BYTES IN      00852000
*                                        RECORD                      */ 00853000
         LH    @08,DSNQFREE(,DSNQPTR)                           02S0229 00854000
         SLR   @08,ENTRYLNG                                     02S0229 00855000
         STH   @08,DSNQFREE(,DSNQPTR)                           02S0229 00856000
*    IF NEPAPROC = OFF &               /*CALLER WANTS EPA?   @ZA04136*/ 00857000
*      UPDATE = ON THEN                /*EPA CREATED?        @ZA04136*/ 00858000
         L     @02,@PC00001                                     02S0230 00859000
         TM    NEPAPROC(@02),B'00000001'                        02S0230 00860000
         BNZ   @RF00230                                         02S0230 00861000
         TM    UPDATE,B'10000000'                               02S0230 00862000
         BNO   @RF00230                                         02S0230 00863000
*      DO;                             /*YES                 @ZA04136*/ 00864000
*        EPADDR->SWCHNPTR=SWEPAPTR;    /*NEW EPA ON INPUT CH @ZA04136*/ 00865000
         L     @15,@PC00001+12                                  02S0232 00866000
         L     @01,EPADDR(,@15)                                 02S0232 00867000
         ST    SWEPAPTR,SWCHNPTR(,@01)                          02S0232 00868000
*        EPADDR=SWEPAPTR;              /*UPDATE TO LAST EPA  @ZA04136*/ 00869000
         ST    SWEPAPTR,EPADDR(,@15)                            02S0233 00870000
*        UPDATE=OFF;                   /*EPA UPDATED         @ZA04136*/ 00871000
         NI    UPDATE,B'01111111'                               02S0234 00872000
*        IF UPJCTEPA=ON THEN           /*JCT EPA ADDED TO CH @ZA04136*/ 00873000
         TM    UPJCTEPA,B'00100000'                             02S0235 00874000
         BNO   @RF00235                                         02S0235 00875000
*          EPAJCTEX=ON;                /*SET FUNCTION MAP    @ZA04136*/ 00876000
         OI    EPAJCTEX(@02),B'00000100'                        02S0236 00877000
*      END;                            /*                    @ZA04136*/ 00878000
@RF00235 DS    0H                                               02S0238 00879000
*  END;                                /*END ADD PROCESSING          */ 00880000
@RF00230 DS    0H                                               02S0239 00881000
*IF CHSHRXCL=ON THEN                   /*CHANGE USE ATTRIBUTE NEEDED */ 00882000
@RF00170 TM    CHSHRXCL,B'10000000'                             02S0239 00883000
         BNO   @RF00239                                         02S0239 00884000
*  DSNQSHR=OFF;                        /*TURN OFF SHARE INDICATOR    */ 00885000
         NI    DSNQSHR(DSNQENTP),B'01111111'                    02S0240 00886000
*IF CHNGSTEP=ON THEN                   /*CHNG STEP NUMBER    @YM08191*/ 00887000
@RF00239 TM    CHNGSTEP,B'01000000'                             02S0241 00888000
         BNO   @RF00241                                         02S0241 00889000
*  DSNQSTEP=STEPNUMB;                  /*STEP NUMB IN ENTRY  @YM08191*/ 00890000
         L     @02,@PC00001+20                                  02S0242 00891000
         IC    @15,STEPNUMB(,@02)                               02S0242 00892000
         STC   @15,DSNQSTEP(,DSNQENTP)                          02S0242 00893000
*IF UPDATE=ON THEN                     /*RECORD UPDATED      @YM06161*/ 00894000
@RF00241 TM    UPDATE,B'10000000'                               02S0243 00895000
         BNO   @RF00243                                         02S0243 00896000
*  DO;                                 /*YES, CHAIN EPA      @YM06161*/ 00897000
*    SWBLKPTR=DSNQPTR;                 /*ADDRESS OF DSENQ RECORD     */ 00898000
         ST    DSNQPTR,SWBLKPTR(,SWEPAPTR)                      02S0245 00899000
*    SWVA=DSNQSVA;                     /*SVA OF DSENQ RECORD         */ 00900000
         MVC   SWVA(3,SWEPAPTR),DSNQSVA(DSNQPTR)                02S0246 00901000
*    SWBLKID=DSNQID;                   /*ID OF DSENQ RECORD  @ZA04136*/ 00902000
         MVC   SWBLKID(1,SWEPAPTR),DSNQID(DSNQPTR)              02S0247 00903000
*    SWLNGTH=BLOCKLEN;                 /*LENGTH OF DSENQ RECORD      */ 00904000
         L     @02,BLOCKLEN                                     02S0248 00905000
         ST    @02,SWLNGTH(,SWEPAPTR)                           02S0248 00906000
*    EPADDR->SWCHNPTR=SWEPAPTR;        /*PUT NEW EPA ON INPUT CHAIN  */ 00907000
         L     @02,@PC00001+12                                  02S0249 00908000
         L     @01,EPADDR(,@02)                                 02S0249 00909000
         ST    SWEPAPTR,SWCHNPTR(,@01)                          02S0249 00910000
*    EPADDR=SWEPAPTR;                  /*UPDATE ADDRESS TO LAST EPA  */ 00911000
         ST    SWEPAPTR,EPADDR(,@02)                            02S0250 00912000
*  END;                                /*END CHAIN EPA       @YM06161*/ 00913000
*      END;                            /*END CREATE DSENQ ENTRY      */ 00914000
@RF00243 DS    0H                                               01S0253 00915000
*    IF RETADDR=ON THEN                /*RETURN ENTRY ADDR REQUESTED */ 00916000
@RF00155 L     @15,@PC00001                                     01S0253 00917000
         TM    RETADDR(@15),B'01000000'                         01S0253 00918000
         BNO   @RF00253                                         01S0253 00919000
*      DO;                             /*YES, RETURN  ADDRRESSES     */ 00920000
*        ENTADDR=DSNQENTP;             /*SAVE ADDRESS OF DSENQ ENT   */ 00921000
         L     @15,@PC00001+24                                  01S0255 00922000
         ST    DSNQENTP,ENTADDR(,@15)                           01S0255 00923000
*        RECADDR=DSNQPTR;              /*ADDRESS OF DSENQ RECORD     */ 00924000
         ST    DSNQPTR,RECADDR(,@15)                            01S0256 00925000
*      END;                            /*END RETURN ADDRESSES        */ 00926000
*    IF RETINDIC=ON THEN               /*RETURN INFO REQUESTED       */ 00927000
@RF00253 L     @15,@PC00001                                     01S0258 00928000
         TM    RETINDIC(@15),B'00100000'                        01S0258 00929000
         BNO   @RF00258                                         01S0258 00930000
*      DO;                             /*YES, INDICATE PROCESS DONE  */ 00931000
*        IF ADCHENQ=ON & DSNFOUND=OFF THEN /*DSNAME ENQ'D AND   01S0260 00932000
*                                        ADDED TO DSENQ TABLE        */ 00933000
         TM    ADCHENQ(@15),B'00100000'                         01S0260 00934000
         BNO   @RF00260                                         01S0260 00935000
         TM    DSNFOUND,B'01000000'                             01S0260 00936000
         BNZ   @RF00260                                         01S0260 00937000
*          DEQDSNSW=ON;                /*DEQ NECESSARY ON ERROR      */ 00938000
         L     @15,@PC00001+28                                  01S0261 00939000
         OI    DEQDSNSW(@15),B'00100000'                        01S0261 00940000
*        IF CHSHRXCL=ON & NOSHRXCL=ON THEN /*CHANGE ATTRIBUTE REQ'D  */ 00941000
@RF00260 TM    CHSHRXCL,B'10000000'                             01S0262 00942000
         BNO   @RF00262                                         01S0262 00943000
         L     @15,@PC00001                                     01S0262 00944000
         TM    NOSHRXCL(@15),B'00000100'                        01S0262 00945000
         BNO   @RF00262                                         01S0262 00946000
*          NQEXCLSW=ON;                /*ENQ RET=CHANGE REQUIRED     */ 00947000
         L     @15,@PC00001+28                                  01S0263 00948000
         OI    NQEXCLSW(@15),B'00001000'                        01S0263 00949000
*      END;                            /*END RETURN INDICATORS       */ 00950000
@RF00262 DS    0H                                               01S0265 00951000
*    IF ADCHENQ=ON & (DSNFOUND=OFF |   /*ENQ REQSTD AND NEED @YM08661*/ 00952000
*       (NOSHRXCL=OFF & CHSHRXCL=ON)) THEN /*CHNG REQSTD,NEED@YM08661*/ 00953000
@RF00258 L     @15,@PC00001                                     01S0265 00954000
         TM    ADCHENQ(@15),B'00100000'                         01S0265 00955000
         BNO   @RF00265                                         01S0265 00956000
         TM    DSNFOUND,B'01000000'                             01S0265 00957000
         BZ    @RT00265                                         01S0265 00958000
         TM    NOSHRXCL(@15),B'00000100'                        01S0265 00959000
         BNZ   @RF00265                                         01S0265 00960000
         TM    CHSHRXCL,B'10000000'                             01S0265 00961000
         BNO   @RF00265                                         01S0265 00962000
@RT00265 DS    0H                                               01S0266 00963000
*      DO;                             /*YES, BUILD PARMS AND ENQ    */ 00964000
*/********************************************************************/ 00965000
*/*                                                                  */ 00966000
*/* SEGMENT - ENQDSN                                                 */ 00967000
*/*                                                                  */ 00968000
*/* DESCRIPTIVE NAME - ENQUEUE DATA SET NAME                         */ 00969000
*/*                                                                  */ 00970000
*/* FUNCTION - TO ENQUEUE THE DATA SET NAME                          */ 00971000
*/*                                                                  */ 00972000
*/* OPERATION - MOVE ENQ LIST FORM TO THE PARM LIST, GET ADDRESS     */ 00973000
*/*             OF THE MINOR NAME (DSNAME), THE LENGTH OF THE MINOR  */ 00974000
*/*             NAME, AND THE ADDRESS OF THE TCB FOR THE DIRECTED    */ 00975000
*/*             ENQ.  DETERMINE THE ENQ OPTIONS FROM THE INPUT       */ 00976000
*/*             AND ISSUE THE PROPER EXECUTE FORM OF THE MACRO.      */ 00977000
*/*             IF THE REQUEST WAS TO CHANGE THE USE         @Y30QPPB*/ 00978000
*/*             ATTRIBUTE, SEGMENT CHANGENQ PROCESSES THE    @Y30QPPB*/ 00979000
*/*             REQUEST.                                     @Y30QPPB*/ 00980000
*/*             IF THE ENQ WAS NOT SUCCESSFUL, THE TYPE OF REQUEST   */ 00981000
*/*             IS DETERMINED AND ERRCODE SET APPROPRIATELY.         */ 00982000
*/*                IF THE WAIT OPTION WAS REQUESTED, THE SEGMENT,    */ 00983000
*/*                 WAITDSN, IS USED TO INFORM THE OPERATOR OF THE   */ 00984000
*/*                 IMPENDING WAIT.                                  */ 00985000
*/*                IF THE ENQ WAS TO CHANGE THE USE ATTRIBUTE,       */ 00986000
*/*                 ERRCODE IS SET TO RCXCLUSV.                      */ 00987000
*/*                ERRCODE IS SET TO RCDSUNAV IN ALL OTHER CASES.    */ 00988000
*/*                                                                  */ 00989000
*/* ENTRY - ENQDSN (INCLUDED SEGMENT)                                */ 00990000
*/*                                                                  */ 00991000
*/*  INPUT DATA - TCBPTR - TCB ADDRESS FOR DIRECTED ENQ              */ 00992000
*/*               DSNQDSNL - LENGTH OF DSNAME                        */ 00993000
*/*               DSNQDSN  - DSNAME                                  */ 00994000
*/*               ENQEXCL SET ON FOR EXCLUSIVE USE                   */ 00995000
*/*               CHSHRXCL SET ON TO CHANGE USE ATTRIBUTES           */ 00996000
*/*               ENQWAIT SET ON TO WAIT FOR DSNAME AVAILABILITY     */ 00997000
*/*               ENQFAIL SET OFF ASSUMING ENQ SUCCESSFUL            */ 00998000
*/*                                                                  */ 00999000
*/* EXIT - TO NEXT SEQUENTIAL INSTRUCTION                            */ 01000000
*/*                                                                  */ 01001000
*/*  OUTPUT DATA - ENQ SUCCESSFUL                                    */ 01002000
*/*                  DSNAME ENQUED                                   */ 01003000
*/*                ENQ UNSUCCESSFUL                                  */ 01004000
*/*                  ERRCODE=RCXCLUSV IF CHANGE USE ATTRIBUTES       */ 01005000
*/*                          REQUESTED                               */ 01006000
*/*                  ERRCODE=RCDSUNAV IN ALL OTHER CASES             */ 01007000
*/*                  ENQFAIL SET ON                                  */ 01008000
*/*                                                                  */ 01009000
*/********************************************************************/ 01010000
*PARMS=ENQLIST;                        /*MOVE IN LIST FORM OF ENQ    */ 01011000
         MVC   PARMS(12),ENQLIST                                02S0267 01012000
*RFY (R2,R3,R4) RESTRICTED;            /*RESTRICT REGS R2,R3,R4      */ 01013000
*R2=TCBPTR;                            /*TCB ADDRESS FOR ENQ         */ 01014000
         L     @05,@PC00001+16                                  02S0269 01015000
         L     R2,TCBPTR(,@05)                                  02S0269 01016000
*R3=ADDR(DSNQDSN);                     /*ADDRESS OF DSN- MINOR NAME  */ 01017000
         LA    R3,DSNQDSN(,DSNQENTP)                            02S0270 01018000
*R4=DSNQDSNL;                          /*LENGTH OF DSN- MINOR NAME   */ 01019000
         SLR   @15,@15                                          02S0271 01020000
         IC    @15,DSNQDSNL(,DSNQENTP)                          02S0271 01021000
         LR    R4,@15                                           02S0271 01022000
*ENQECB=ENQECB && ENQECB;              /*CLEAR ENQ ECB               */ 01023000
         L     @05,ENQECB                                       02S0272 01024000
         LR    @14,@05                                          02S0272 01025000
         XR    @14,@05                                          02S0272 01026000
         ST    @14,ENQECB                                       02S0272 01027000
*IF CHSHRXCL=ON THEN                   /*CHANGE USE REQUIRED         */ 01028000
         TM    CHSHRXCL,B'10000000'                             02S0273 01029000
         BNO   @RF00273                                         02S0273 01030000
*  DO;                                 /*YES, ENQ TO CHANGE USE      */ 01031000
*/********************************************************************/ 01032000
*/*                                                          @Y30QPPB*/ 01033000
*/* SEGMENT - CHANGENQ                                       @Y30QPPB*/ 01034000
*/*                                                          @Y30QPPB*/ 01035000
*/* DESCRIPTIVE NAME - CHANGE ENQ USE ATTRIBUTE              @Y30QPPB*/ 01036000
*/*                                                          @Y30QPPB*/ 01037000
*/* FUNCTION - TO DETERMINE IF THE ENQ USE ATTRIBUTE CAN     @Y30QPPB*/ 01038000
*/*            BE CHANGED FROM SHARE TO EXCLUSIVE            @Y30QPPB*/ 01039000
*/*                                                          @Y30QPPB*/ 01040000
*/* OPERATION - BUILD THE SSOB AND FUNCTION DEPENDENT AREA   @Y30QPPB*/ 01041000
*/*             AND EXIT TO JES3 SUBSYSTEM TO DETERMINE IF   @Y30QPPB*/ 01042000
*/*             IT IS POSSIBLE TO CHANGE THE USE ATTRIBUTE   @Y30QPPB*/ 01043000
*/*             ACROSS PROCESSORS. IF IT IS POSSIBLE ACROSS  @Y30QPPB*/ 01044000
*/*             PROCESSORS, ENQ WITH THE RET=CHNG OPTION IS  @Y30QPPB*/ 01045000
*/*             ISSUED.                                      @Y30QPPB*/ 01046000
*/*             IF IT IS NOT POSSIBLE ACROSS PROCESSORS, THE @Y30QPPB*/ 01047000
*/*             RETURN CODE FIELD IN THE ENQ PARAMETER LIST  @Y30QPPB*/ 01048000
*/*             IS MADE NON-ZERO SO THAT THE ENQDSN SEGMENT  @Y30QPPB*/ 01049000
*/*             WILL SET THE PROPER RETURN CODE.             @Y30QPPB*/ 01050000
*/*                                                          @Y30QPPB*/ 01051000
*/* ENTRY - CHANGENQ (INCLUDED SEGMENT)                      @Y30QPPB*/ 01052000
*/*                                                          @Y30QPPB*/ 01053000
*/*  INPUT DATA - R2 - TCB ADDRESS                           @Y30QPPB*/ 01054000
*/*               R3 - PTR TO DATASET NAME                   @Y30QPPB*/ 01055000
*/*               R4 - LENGTH OF DATASET NAME                @Y30QPPB*/ 01056000
*/*               PARMS - LIST FORM OF ENQ PARAMETER LIST    @Y30QPPB*/ 01057000
*/*               DSNQDSNL - LENGTH OF DATA SET NAME         @Y30QPPB*/ 01058000
*/*               DSNQDSN - DATA SET NAME                    @Y30QPPB*/ 01059000
*/*                                                          @Y30QPPB*/ 01060000
*/* EXIT - TO NEXT SEQUENTIAL INSTRUCTION                    @Y30QPPB*/ 01061000
*/*                                                          @Y30QPPB*/ 01062000
*/*  OUTPUT DATA - ENQDEQCD - SET TO ZERO IF ENQ SUCCESSFUL. @Y30QPPB*/ 01063000
*/*                           IF ENQ FAILED OR THE JES3 EXIT @Y30QPPB*/ 01064000
*/*                           INDICATED IT IS NOT CURRENTLY  @Y30QPPB*/ 01065000
*/*                           POSSIBLE TO CHANGE THE USE     @Y30QPPB*/ 01066000
*/*                           ATTRIBUTE, THIS FIELD CONTAINS @Y30QPPB*/ 01067000
*/*                           A NON-ZERO VALUE.              @Y30QPPB*/ 01068000
*/*                                                          @Y30QPPB*/ 01069000
*/********************************************************************/ 01070000
*SSOB=SSOB && SSOB;                    /*CLEAR SSOB          @Y30QPPB*/ 01071000
         XC    SSOB(20),SSOB                                    03S0275 01072000
*FLAGS=FLAGS && FLAGS;                 /*CLEAR FLAGS         @Y30QPPB*/ 01073000
         XC    FLAGS(2),FLAGS                                   03S0276 01074000
*SSOBID=SSOBCHAR;                      /*SSOB ID - 'SSOB'    @Y30QPPB*/ 01075000
         MVC   SSOBID(4),SSOBCHAR                               03S0277 01076000
*SSOBLEN=LENGTH(SSOB);                 /*LENGTH OF SSOB      @Y30QPPB*/ 01077000
         MVC   SSOBLEN(2),@CH00403                              03S0278 01078000
*SSOBFUNC=SSOBNQCD;                    /*FUNC TO CHANGE ENQ  @Y30QPPB*/ 01079000
         MVC   SSOBFUNC(2),@CH01281                             03S0279 01080000
*SSOBINDV=ADDR(SSNQ);                  /*ADDR FUNCTION AREA  @Y30QPPB*/ 01081000
         LA    @05,SSNQ                                         03S0280 01082000
         ST    @05,SSOBINDV                                     03S0280 01083000
*SSNQ=SSNQ && SSNQ;                    /*CLEAR FUNCTION AREA @Y30QPPB*/ 01084000
         XC    SSNQ(16),SSNQ                                    03S0281 01085000
*SSNQLEN=LENGTH(SSNQ);                 /*LENGTH FUNCTN AREA  @Y30QPPB*/ 01086000
         MVC   SSNQLEN(2),@CH00066                              03S0282 01087000
*SSNQDSNP=ADDR(JESDSNAM);              /*ADDR DSNAME BUFFER  @Y30QPPB*/ 01088000
         LA    @05,JESDSNAM                                     03S0283 01089000
         ST    @05,SSNQDSNP                                     03S0283 01090000
*SSNQFLGP=ADDR(FLAGS);                 /*SDDR FLAG FIELD     @Y30QPPB*/ 01091000
         LA    @05,FLAGS                                        03S0284 01092000
         ST    @05,SSNQFLGP                                     03S0284 01093000
*JESDSNAM='';                          /*BLANK DSNAME BUFFER @Y30QPPB*/ 01094000
         MVI   JESDSNAM,C' '                                    03S0285 01095000
         MVC   JESDSNAM+1(43),JESDSNAM                          03S0285 01096000
*JESDSNAM(1:DSNQDSNL)=DSNQDSN(1:DSNQDSNL); /*DSNAME TO BUFFER@Y30QPPB*/ 01097000
         BCTR  @15,0                                            03S0286 01098000
         EX    @15,@SM01332                                     03S0286 01099000
*SHRTOXCL=ON;                          /*CHANGE SHR TO EXCL  @Y30QPPB*/ 01100000
*                                                               03S0287 01101000
         OI    SHRTOXCL,B'10000000'                             03S0287 01102000
* /* ? IEFSSREQ  (SSOB);*/                                      03S0288 01103000
*/*                                           */                03S0288 01104000
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO   */                03S0288 01105000
*/*  PROCESS REQUEST -                        */                03S0288 01106000
*/*                                           */                03S0288 01107000
*/*    INPUT - REGISTER 1 POINTS TO A ONE-    */                03S0288 01108000
*/*            WORD PARAMETER LIST WHICH      */                03S0288 01109000
*/*            POINTS TO THE SSOB             */                03S0288 01110000
*/*                                           */                03S0288 01111000
*CALL SSREQ(SSOB);                     /*INVOKE JES3         @Y30QPPB*/ 01112000
         LA    @05,SSOB                                         03S0288 01113000
         ST    @05,@AL00001                                     03S0288 01114000
         MVI   @AL00001,X'80'                                   03S0288 01115000
         L     @05,CVTPTR                                       03S0288 01116000
         L     @05,CVTJESCT(,@05)                               03S0288 01117000
         L     @15,JESSSREQ(,@05)                               03S0288 01118000
         LA    @01,@AL00001                                     03S0288 01119000
         BALR  @14,@15                                          03S0288 01120000
*IF SSOBRETN^=SSOBNQOK THEN            /*OK TO TRY ENQ CHNG? @Y30QPPB*/ 01121000
         L     @05,SSOBRETN                                     03S0289 01122000
         LTR   @05,@05                                          03S0289 01123000
         BZ    @RF00289                                         03S0289 01124000
*  ENQDEQCD=ERROR;                     /*NO, SET ERROR INDIC @Y30QPPB*/ 01125000
         IC    @05,ERROR                                        03S0290 01126000
         STC   @05,ENQDEQCD                                     03S0290 01127000
*ELSE                                  /*TRY CHANGE ENQ USE  @Y30QPPB*/ 01128000
*  DO;                                 /*ENQ TO CHANGE USE   @Y30QPPB*/ 01129000
         B     @RC00289                                         03S0291 01130000
@RF00289 DS    0H                                               03S0292 01131000
*    GENERATE;                         /*ISSUE ENQ           @Y30QPPB*/ 01132000
     ENQ (MAJOR,(3),E,(4),SYSTEM),RET=CHNG,TCB=(2),MF=(E,PARMS)         01133000
*  END;                                /*END ENQ TO CHANGE   @Y30QPPB*/ 01134000
*  END;                                /*END ENQ CHANGE USE ATTRIBUTE*/ 01135000
*ELSE                                  /*CHANGE USE NOT REQUIRED     */ 01136000
*  DO;                                 /*ENQ THE DSNAME              */ 01137000
         B     @RC00273                                         02S0295 01138000
@RF00273 DS    0H                                               02S0296 01139000
*    IF ENQWAIT=OFF THEN               /*WAIT FUNCTION NOT REQUESTED */ 01140000
         L     @05,@PC00001                                     02S0296 01141000
         TM    ENQWAIT(@05),B'10000000'                         02S0296 01142000
         BNZ   @RF00296                                         02S0296 01143000
*      IF ENQEXCL=ON THEN              /*EXCLUSIVE USE REQUEST       */ 01144000
         TM    ENQEXCL(@05),B'00000001'                         02S0297 01145000
         BNO   @RF00297                                         02S0297 01146000
*        DO;                           /*YES, PERFORM ENQ            */ 01147000
*          GENERATE;                   /*EXCLUSIVE 'NO WAIT' ENQ     */ 01148000
           ENQ (MAJOR,(3),E,(4),SYSTEM),RET=USE,TCB=(2),MF=(E,PARMS)    01149000
*        END;                          /*END EXCLUSIVE 'NO WAIT' ENQ */ 01150000
*      ELSE                            /*NOT EXCLUSIVE USE REQUEST   */ 01151000
*        DO;                           /*ENQ FOR SHARED USE          */ 01152000
         B     @RC00297                                         02S0301 01153000
@RF00297 DS    0H                                               02S0302 01154000
*          GENERATE;                   /*SHARED 'NO WAIT' ENQ        */ 01155000
           ENQ (MAJOR,(3),S,(4),SYSTEM),RET=USE,TCB=(2),MF=(E,PARMS)    01156000
*        END;                          /*END SHARED 'NO WAIT' ENQ    */ 01157000
*    ELSE                              /*WAIT FUNCTION REQUESTED     */ 01158000
*      DO;                             /*YES, DO 'WAIT' ENQ          */ 01159000
         B     @RC00296                                         02S0304 01160000
@RF00296 DS    0H                                               02S0305 01161000
*        PARMS=ENQWAITL;               /*MOVE IN 'WAIT' LIST FORM    */ 01162000
         MVC   PARMS(12),ENQWAITL                               02S0305 01163000
*        IF ENQEXCL=ON THEN            /*EXCLUSIVE USE REQUEST       */ 01164000
         L     @05,@PC00001                                     02S0306 01165000
         TM    ENQEXCL(@05),B'00000001'                         02S0306 01166000
         BNO   @RF00306                                         02S0306 01167000
*          DO;                         /*YES, PERFORM ENQ            */ 01168000
*            GENERATE;                 /*EXCLUSIVE 'WAIT' ENQ        */ 01169000
             ENQ (MAJOR,(3),E,(4),SYSTEM),ECB=ENQECB,MF=(E,PARMS)       01170000
*          END;                        /*END EXCLUSIVE 'WAIT' ENQ    */ 01171000
*        ELSE                          /*NOT EXCLUSIVE USE REQUEST   */ 01172000
*          DO;                         /*ENQ FOR SHARED USE          */ 01173000
         B     @RC00306                                         02S0310 01174000
@RF00306 DS    0H                                               02S0311 01175000
*            GENERATE;                 /*SHARED 'WAIT' ENQ           */ 01176000
             ENQ (MAJOR,(3),S,(4),SYSTEM),ECB=ENQECB,MF=(E,PARMS)       01177000
*          END;                        /*END SHARED 'WAIT' ENQ       */ 01178000
*      END;                            /*END 'WAIT' ENQ              */ 01179000
@RC00306 DS    0H                                               02S0314 01180000
*  END;                                /*END ENQ ON DSNAME           */ 01181000
@RC00296 DS    0H                                               02S0315 01182000
*IF ENQDEQCD^=ZERO THEN                /*ERROR ON ENQ                */ 01183000
@RC00273 CLI   ENQDEQCD,0                                       02S0315 01184000
         BE    @RF00315                                         02S0315 01185000
*  DO;                                 /*YES, SET PROPER RETURN CODE */ 01186000
*    IF ENQWAIT=ON & CHSHRXCL=OFF THEN /*REQUEST TO WAIT, NOT CHANGE */ 01187000
         L     @05,@PC00001                                     02S0317 01188000
         TM    ENQWAIT(@05),B'10000000'                         02S0317 01189000
         BNO   @RF00317                                         02S0317 01190000
         TM    CHSHRXCL,B'10000000'                             02S0317 01191000
         BNZ   @RF00317                                         02S0317 01192000
*      DO;                             /*YES, TELL OPERATOR AND WAIT */ 01193000
*/********************************************************************/ 01194000
*/*                                                                  */ 01195000
*/* SEGMENT - WAITDSN                                                */ 01196000
*/*                                                                  */ 01197000
*/* DESCRIPTIVE NAME - WAIT FOR DSNAME ENQUEUE                       */ 01198000
*/*                                                                  */ 01199000
*/* FUNCTION - TO WAIT UNTIL THE UNAVAILABLE RESOURCE IS AVAILABLE   */ 01200000
*/*            OR THE OPERATOR INDICATES THAT THE RESOURCE SHOULD    */ 01201000
*/*            NOT BE WAITED FOR                                     */ 01202000
*/*                                                                  */ 01203000
*/* OPERATION - MOVE THE LIST FORMS OF THE WTO AND WTOR      @ZA13227*/ 01204000
*/*             MESSAGES TO AUTOMATIC STORAGE. MOVE THE      @ZA13227*/ 01205000
*/*             JOBNAME, STEPNAME, AND DATA SET NAME TO THE  @ZA13227*/ 01206000
*/*             APPROPRIATE MESSAGE. ISSUE THE WTO'S AND,    @ZA13227*/ 01207000
*/*             ISSUE THE WTOR TO INFORM THE OPERATOR THAT A WAIT    */ 01208000
*/*             IS TAKING PLACE AND ALLOW THE OPERATOR TO            */ 01209000
*/*             DISCONTINUE THE WAIT BY REPLYING 'NO' TO THE MESSAGE.*/ 01210000
*/*             AT THIS POINT, THE MODULE WAITS FOR ONE OF THE       */ 01211000
*/*             FOLLOWING TO OCCUR -                                 */ 01212000
*/*               .CASE 1 - THE RESOURCE BECOMES AVAILABLE (THE ENQ  */ 01213000
*/*                         ECB IS POSTED).   OR                     */ 01214000
*/*               .CASE 2 - THE OPERATOR REPLIES TO THE MESSAGE (THE */ 01215000
*/*                         WTOR ECB IS POSTED).                     */ 01216000
*/*             IN CASE 1 THE OUTSTANDING WTOR IS DELETED VIA THE    */ 01217000
*/*             DOM FACILITY.                                        */ 01218000
*/*             IN CASE 2 THE REPLY MAY BE ENTERED BY THE OPERATOR IN*/ 01219000
*/*             LOWER OR UPPER CASE.  IN ORDER TO COMPARE WITH UPPER */ 01220000
*/*             CASE THE REPLY IN THE BUFFER IS CHANGED TO UPPER CASE*/ 01221000
*/*             BY OR'ING EACH CHARACTER IN THE REPLY WITH X'40'.    */ 01222000
*/*             (THIS CHANGES LOWER TO UPPER CASE OR LEAVES UPPER    */ 01223000
*/*             CASE UNCHANGED.)  THE BUFFER IS COMPARED FOR 'NO'. IF*/ 01224000
*/*             IT IS NOT FOUND, THE REPLY BUFFER IS BLANKED, THE    */ 01225000
*/*             WTOR ECB IS CLEARED, AND THE WTO'S AND       @ZA13227*/ 01226000
*/*             THE WTOR MESSAGES ARE ISSUED AGAIN.          @ZA13227*/ 01227000
*/*             IF IT IS FOUND, THE OUTSTANDING ENQ IS DELETED VIA   */ 01228000
*/*             DEQ.  THE DEQ IS NOT DONE IN THIS SEGMENT BUT THE    */ 01229000
*/*             ERROR CODE IS SET TO RCDSUNAV AND THE ENQFAIL SWITCH */ 01230000
*/*             IS SET ON.  THIS SWITCH WILL CAUSE ANOTHER SEGMENT,  */ 01231000
*/*             DEQDSN, TO DEQ THE DATASET NAME AND REMOVE THE ENTRY */ 01232000
*/*             FROM THE DSENQ TABLE.                                */ 01233000
*/*             NOTE - IF BOTH ECBS ARE SIMULTANEOUSLY POSTED, THE   */ 01234000
*/*                    ENQ ECB WILL BE HONORED.  THE RATIONALE FOR   */ 01235000
*/*                    THIS DECISION IS THAT THE OBJECTIVE OF THE    */ 01236000
*/*                    WTOR IS TO PROVIDE A MECHANISM WHEREBY THE    */ 01237000
*/*                    OPERATOR MAY GET ALLOCATION OUT OF THE WAIT   */ 01238000
*/*                    STATE, WHICH, WHEN BOTH ECBS ARE POSTED, HAS  */ 01239000
*/*                    BEEN ACCOMPLISHED.  IT IS NOT INTENDED AS A   */ 01240000
*/*                    MECHANISM WHEREBY THE OPERATOR IS BEING       */ 01241000
*/*                    ASKED TO AUTHORIZE THE USER'S USAGE OF THE    */ 01242000
*/*                    REQUESTED RESOURCE.                           */ 01243000
*/*                                                                  */ 01244000
*/* ENTRY - WAITDSN (INCLUDED SEGMENT)                               */ 01245000
*/*                                                                  */ 01246000
*/*  INPUT DATA - JOBNAME - THE INPUT JOBNAME TO BE USED IN THE MSG  */ 01247000
*/*               STEPNAME - THE INPUT STEPNAME TO BE USED IN THE MSG*/ 01248000
*/*               DSNQDSNL - LENGTH OF INPUT DSNAME          @ZA13227*/ 01249000
*/*               DSNQDSN - INPUT DSNAME FOR MESSAGE         @ZA13227*/ 01250000
*/*                                                                  */ 01251000
*/* EXIT - TO NEXT SEQUENTIAL INSTRUCTION                            */ 01252000
*/*                                                                  */ 01253000
*/*  OUTPUT DATA - DSNAME ENQUEUED IF THE RESOURCE BECAME AVAILABLE  */ 01254000
*/*                MESSAGE TO THE OPERATOR INDICATING WAIT FOR       */ 01255000
*/*                  DATASET IS NECESSARY                            */ 01256000
*/*                IF OPERATOR REPLIED 'NO' TO THE MESSAGE -         */ 01257000
*/*                  ENQFAIL IS ON INDICATING DEQ IS NECESSARY       */ 01258000
*/*                  ERRCODE SET TO RCCANCEL INDICATING THE  @YM05564*/ 01259000
*/*                          OPERATOR DID NOT ALLOW WAIT     @YM05564*/ 01260000
*/*                                                                  */ 01261000
*/* NOTE - BEFORE ISSUING THE WTOR THE LENGTH OF THE WTOR MUST BE    */ 01262000
*/*        CALCULATED.  WTORLNGH IS THE LENGTH OF THE MESSAGE AS     */ 01263000
*/*        INITIALIZED IN THE LIST FORM OF THE WTOR AND INCLUDES THE */ 01264000
*/*        MAXIMUM LENGTH FOR BOTH JOBNAME AND STEPNAME.  IN ORDER TO*/ 01265000
*/*        CORRECTLY ADJUST THE LENGTH FOR VARIABLE LENGTH JOBNAME   */ 01266000
*/*        AND STEPNAME, THE MAXIMUM LENGTH OF BOTH JOBNAME AND      */ 01267000
*/*        STEPNAME IS SUBTRACTED FROM THE LENGTH IN THE LIST FORM.  */ 01268000
*/*        THE ACTUAL LENGTHS OF THE JOBNAME AND STEPNAME ARE THEN   */ 01269000
*/*        ADDED TO THAT RESULT.                                     */ 01270000
*/********************************************************************/ 01271000
*WTORPARM(1:20)=WTORLIST(1:20);        /*MOVE IN HEADER OF WTOR LIST */ 01272000
         L     @05,@CV00212                                     03S0319 01273000
         MVC   WTORPARM(20),WTORLIST(@05)                       03S0319 01274000
*DO JOBNLNG=LENGTH(JOBNAME) TO 1 BY -1 WHILE(JOBNAME(JOBNLNG)=BLANK);   01275000
         LA    JOBNLNG,8                                        03S0320 01276000
@DL00320 L     @08,@PC00001+40                                  03S0320 01277000
         L     @08,MSGPARMP(,@08)                               03S0320 01278000
         ALR   @08,JOBNLNG                                      03S0320 01279000
         BCTR  @08,0                                            03S0320 01280000
         CLI   JOBNAME(@08),C' '                                03S0320 01281000
         BNE   @DC00320                                         03S0320 01282000
*END;                                  /*CALCULATE LENGTH OF JOBNAME */ 01283000
         BCTR  JOBNLNG,0                                        03S0321 01284000
         LTR   JOBNLNG,JOBNLNG                                  03S0321 01285000
         BP    @DL00320                                         03S0321 01286000
@DC00320 DS    0H                                               03S0322 01287000
*DO STEPNLNG=LENGTH(STEPNAME) TO 1 BY -1                        03S0322 01288000
*                          WHILE(STEPNAME(STEPNLNG)=BLANK);     03S0322 01289000
         LA    STEPNLNG,8                                       03S0322 01290000
@DL00322 L     @05,@PC00001+40                                  03S0322 01291000
         L     @05,MSGPARMP(,@05)                               03S0322 01292000
         ALR   @05,STEPNLNG                                     03S0322 01293000
         CLI   STEPNAME-1(@05),C' '                             03S0322 01294000
         BNE   @DC00322                                         03S0322 01295000
*END;                                  /*CALCULATE LENGTH OF STEPNAME*/ 01296000
         BCTR  STEPNLNG,0                                       03S0323 01297000
         LTR   STEPNLNG,STEPNLNG                                03S0323 01298000
         BP    @DL00322                                         03S0323 01299000
@DC00322 DS    0H                                               03S0324 01300000
*WTORPTR=ADDR(WTORJOB);                /*ADDRESS OF JOBNAME IN MSG   */ 01301000
         LA    WTORPTR,WTORJOB                                  03S0324 01302000
*WTORBUF(1:JOBNLNG)=JOBNAME(1:JOBNLNG); /*MOVE JOBNAME TO BUFFER     */ 01303000
         LR    @15,JOBNLNG                                      03S0325 01304000
         BCTR  @15,0                                            03S0325 01305000
         L     @14,@PC00001+40                                  03S0325 01306000
         L     @14,MSGPARMP(,@14)                               03S0325 01307000
         EX    @15,@SM01334                                     03S0325 01308000
*WTORPTR=WTORPTR+JOBNLNG;              /*POINT BEYOND JOBNAME        */ 01309000
         ALR   WTORPTR,JOBNLNG                                  03S0326 01310000
*WTORBUF(1)=BLANK;                     /*PLACE BLANK AFTER JOBNAME   */ 01311000
         MVI   WTORBUF(WTORPTR),C' '                            03S0327 01312000
*WTORPTR=WTORPTR+1;                    /*POINT BEYOND BLANK          */ 01313000
         LA    @15,1                                            03S0328 01314000
         ALR   WTORPTR,@15                                      03S0328 01315000
*IF STEPNAME(1)^=BLANK THEN            /*WAS STEPNAME SPECIFIED?     */ 01316000
         CLI   STEPNAME(@14),C' '                               03S0329 01317000
         BE    @RF00329                                         03S0329 01318000
*  DO;                                 /*YES, MOVE IT TO MSG BUFFER  */ 01319000
*    WTORBUF(1:STEPNLNG)=STEPNAME(1:STEPNLNG); /*STEPNAME TO BUFFER  */ 01320000
         LR    @01,STEPNLNG                                     03S0331 01321000
         BCTR  @01,0                                            03S0331 01322000
         EX    @01,@SM01336                                     03S0331 01323000
*    WTORPTR=WTORPTR+STEPNLNG;         /*POINT BEYOND STEPNAME       */ 01324000
         ALR   WTORPTR,STEPNLNG                                 03S0332 01325000
*    WTORBUF(1)=BLANK;                 /*PLACE BLANK AFTER JOBNAME   */ 01326000
         MVI   WTORBUF(WTORPTR),C' '                            03S0333 01327000
*    WTORPTR=WTORPTR+1;                /*POINT BEYOND BLANK          */ 01328000
         ALR   WTORPTR,@15                                      03S0334 01329000
*  END;                                /*END MOVE IT TO MSG BUFFER   */ 01330000
*ELSE                                  /*STEPNAME IS BLANK           */ 01331000
*  STEPNLNG=ZERO;                      /*SET STEPNAME LNGTH TO ZERO  */ 01332000
         B     @RC00329                                         03S0336 01333000
@RF00329 SLR   STEPNLNG,STEPNLNG                                03S0336 01334000
*WTORBUF(1:50)=WTORLIST(39:88);        /*MOVE REMAINDER OF MESSAGE   */ 01335000
@RC00329 L     @15,@CV00212                                     03S0337 01336000
         MVC   WTORBUF(50,WTORPTR),WTORLIST+38(@15)             03S0337 01337000
*WTORLNGH=WTORLNGH-(LENGTH(JOBNAME)+LENGTH(STEPNAME))+JOBNLNG+STEPNLNG; 01338000
         LH    @05,WTORLNGH                                     03S0338 01339000
         SL    @05,@CF00066                                     03S0338 01340000
         ALR   @05,JOBNLNG                                      03S0338 01341000
         ALR   @05,STEPNLNG                                     03S0338 01342000
         STH   @05,WTORLNGH                                     03S0338 01343000
*                                      /*CALCULATE THE LENGTH OF        01344000
*                                        THE MESSAGE.  SEE NOTE IN      01345000
*                                        SPEC FOR DETAILS.           */ 01346000
*IF STEPNLNG=ZERO THEN                 /*WAS STEPNAME ALL BLANK      */ 01347000
         LTR   STEPNLNG,STEPNLNG                                03S0339 01348000
         BNZ   @RF00339                                         03S0339 01349000
*  WTORLNGH=WTORLNGH-1;                /*YES, NO BLANK AFTER STEPNAME*/ 01350000
         BCTR  @05,0                                            03S0340 01351000
         STH   @05,WTORLNGH                                     03S0340 01352000
*RFY WTOLIST BASED(ADDR(IEF861I));      /*BASE WTOLIST       @ZA13227*/ 01353000
@RF00339 DS    0H                                               03S0342 01354000
*MSG861I=WTOLIST(1:LENGTH(MSG861I));    /*MOVE IN LIST FORM  @ZA13227*/ 01355000
         L     @08,@CV00213                                     03S0342 01356000
         MVC   MSG861I(73),WTOLIST(@08)                         03S0342 01357000
*RFY WTOLIST BASED(ADDR(IEF863I));      /*BASE WTOLIST       @ZA13227*/ 01358000
*MSG863I=WTOLIST(1:LENGTH(MSG863I));    /*MOVE IN LIST FORM  @ZA13227*/ 01359000
         L     @08,@CV00214                                     03S0344 01360000
         MVC   MSG863I(66),WTOLIST(@08)                         03S0344 01361000
*M861JOBN=JOBNAME(1:JOBNLNG);           /*MOVE IN JOBNAME    @ZA13227*/ 01362000
         MVI   M861JOBN+1,C' '                                  03S0345 01363000
         MVC   M861JOBN+2(6),M861JOBN+1                         03S0345 01364000
         LR    @08,JOBNLNG                                      03S0345 01365000
         BCTR  @08,0                                            03S0345 01366000
         L     @05,@PC00001+40                                  03S0345 01367000
         L     @05,MSGPARMP(,@05)                               03S0345 01368000
         EX    @08,@SM01338                                     03S0345 01369000
*M863DSN=DSNQDSN(1:DSNQDSNL);           /*MOVE IN DSNAME     @ZA13227*/ 01370000
         MVI   M863DSN+1,C' '                                   03S0346 01371000
         MVC   M863DSN+2(42),M863DSN+1                          03S0346 01372000
         SLR   @08,@08                                          03S0346 01373000
         IC    @08,DSNQDSNL(,DSNQENTP)                          03S0346 01374000
         LR    @05,@08                                          03S0346 01375000
         BCTR  @05,0                                            03S0346 01376000
         EX    @05,@SM01340                                     03S0346 01377000
*M861LEN=M861LEN-LENGTH(M861JOBN)+JOBNLNG; /*NEW LENGTH OF MESSAGE      01378000
*                                                            @ZA13227*/ 01379000
         LH    @05,M861LEN                                      03S0347 01380000
         SL    @05,@CF00057                                     03S0347 01381000
         ALR   @05,JOBNLNG                                      03S0347 01382000
         STH   @05,M861LEN                                      03S0347 01383000
*M863LEN=M863LEN-LENGTH(M863DSN)+DSNQDSNL; /*NEW LENGTH OF MESSAGE      01384000
*                                                            @ZA13227*/ 01385000
         LH    @09,M863LEN                                      03S0348 01386000
         SL    @09,@CF00142                                     03S0348 01387000
         ALR   @09,@08                                          03S0348 01388000
         STH   @09,M863LEN                                      03S0348 01389000
*MSG861I(M861LEN+1:M861LEN+5)=M861RTCD;/*MOVE ROUTE CODE     @ZA13227*/ 01390000
         LA    @01,MSG861I(@05)                                 03S0349 01391000
         MVC   @TS00001(4),M861RTCD                             03S0349 01392000
         MVI   4(@01),C' '                                      03S0349 01393000
         MVC   0(4,@01),@TS00001                                03S0349 01394000
*MSG863I(M863LEN+1:M863LEN+5)=M863RTCD;/*MOVE ROUTE CODE     @ZA13227*/ 01395000
         LA    @05,MSG863I(@09)                                 03S0350 01396000
         MVC   @TS00001(4),M863RTCD                             03S0350 01397000
         MVI   4(@05),C' '                                      03S0350 01398000
         MVC   0(4,@05),@TS00001                                03S0350 01399000
*ENDWAIT=OFF;                          /*INITIALIZE END SWITCH       */ 01400000
         NI    ENDWAIT,B'11111101'                              03S0351 01401000
*DO WHILE(ENDWAIT=OFF);                /*ISSUE WTOR AND WAIT         */ 01402000
         B     @DE00352                                         03S0352 01403000
@DL00352 DS    0H                                               03S0353 01404000
*  WTORECB=WTORECB && WTORECB;         /*CLEAR WTOR ECB              */ 01405000
         L     @09,WTORECB                                      03S0353 01406000
         LR    @05,@09                                          03S0353 01407000
         XR    @05,@09                                          03S0353 01408000
         ST    @05,WTORECB                                      03S0353 01409000
*  REPLYBUF=BLANKS;                    /*BLANK THE REPLY BUFFER      */ 01410000
         MVC   REPLYBUF(2),BLANKS                               03S0354 01411000
*  RFY R1 RESTRICTED;                  /*RESTRICT REGISTER 1         */ 01412000
*  GENERATE                            /*INFORM OPERATOR OF     03S0356 01413000
*                                        WAIT                @ZA13227*/ 01414000
*    REFS(MSG861I,MSG863I,REPLYBUF,WTORECB,WTORPARM);   /*   @ZA13227*/ 01415000
   WTO MF=(E,MSG861I)                                         @ZA13227  01416000
   WTO MF=(E,MSG863I)                                         @ZA13227  01417000
   WTOR ,REPLYBUF,2,WTORECB,MF=(E,WTORPARM)                             01418000
*  MSGID=R1;                           /*SAVE MESSAGE ID FOR DOM     */ 01419000
         LR    MSGID,R1                                         03S0357 01420000
*  RFY R1 UNRESTRICTED;                /*RELEASE REGISTER 1          */ 01421000
*  WAITWTOR=ADDR(WTORECB);             /*ADDRESS OF WTOR ECB         */ 01422000
         LA    @09,WTORECB                                      03S0359 01423000
         ST    @09,WAITWTOR                                     03S0359 01424000
*  WAITENQ=ADDR(ENQECB);               /*ADDRESS OF ENQECB           */ 01425000
         LA    @09,ENQECB                                       03S0360 01426000
         ST    @09,WAITENQ                                      03S0360 01427000
*  WAITEND=ON;                         /*INDICATE END OF ECB LIST    */ 01428000
         OI    WAITEND,B'10000000'                              03S0361 01429000
*  GENERATE;                                                    03S0362 01430000
   WAIT 1,ECBLIST=WAITECBS,LONG=YES    WAIT FOR EITHER EVENT @YM05089   01431000
*  IF ECBPOST=ON THEN                  /*RESOURCE AVAILABLE NOW      */ 01432000
         TM    ECBPOST,B'01000000'                              03S0363 01433000
         BNO   @RF00363                                         03S0363 01434000
*    DO;                               /*YES, DELETE OPERATOR MSG,DOM*/ 01435000
*      RFY R1 RESTRICTED;              /*RESTRICT REGISTER 1         */ 01436000
*      R1=MSGID;                       /*ID OF WTOR MESSAGE          */ 01437000
         LR    R1,MSGID                                         03S0366 01438000
*      GENERATE;                       /*DELETE THE OUTSTANDING MSG  */ 01439000
       DOM MSG=(1),REPLY=YES                                            01440000
*      RFY R1 UNRESTRICTED;            /*RELEASE REGISTER 1          */ 01441000
*      ENDWAIT=ON;                     /*TERMINATE WAIT LOOP         */ 01442000
         OI    ENDWAIT,B'00000010'                              03S0369 01443000
*    END;                              /*END DELETE OPERATOR MESSAGE */ 01444000
*  ELSE                                /*OPERATOR REPLIED TO MSG     */ 01445000
*    DO;                               /*CHECK REPLY-IT SHOULD BE NO */ 01446000
         B     @RC00363                                         03S0371 01447000
@RF00363 DS    0H                                               03S0372 01448000
*      REPLYBUF=REPLYBUF|FOLDMASK;     /*BE SURE REPLY IS UPPER CASE    01449000
*                                        SINCE COMPARE IS WITH UPPER    01450000
*                                        CASE                        */ 01451000
         OC    REPLYBUF(2),FOLDMASK                             03S0372 01452000
*      IF REPLYBUF=NO THEN             /*IS REPLY CORRECT            */ 01453000
         CLC   REPLYBUF(2),NO                                   03S0373 01454000
         BNE   @RF00373                                         03S0373 01455000
*        DO;                           /*YES,DELETE OUTSTANDING ENQ  */ 01456000
*          ENQFAIL=ON;                 /*INDICATE ENQ FAIL, NEED DEQ */ 01457000
         OI    ENQFAIL,B'00010000'                              03S0375 01458000
*          ERRCODE=RCCANCEL;           /*OP DENIED WAIT RET CODE        01459000
*                                                            @YM05564*/ 01460000
         L     @05,@PC00001+32                                  03S0376 01461000
         MVC   ERRCODE(2,@05),@CH00538                          03S0376 01462000
*          ENDWAIT=ON;                 /*TERMINATE WAIT LOOP         */ 01463000
         OI    ENDWAIT,B'00000010'                              03S0377 01464000
*        END;                          /*END DELETE OUTSTANDING END  */ 01465000
*      ELSE;                           /*REPLY INCORRECT- WTOR AGAIN */ 01466000
@RF00373 DS    0H                                               03S0380 01467000
*    END;                              /*END CHECK OPERATOR REPLY    */ 01468000
*END;                                  /*END ISSUE WTOR AND WAIT     */ 01469000
@RC00363 DS    0H                                               03S0381 01470000
@DE00352 TM    ENDWAIT,B'00000010'                              03S0381 01471000
         BZ    @DL00352                                         03S0381 01472000
*      END;                            /*END TELL OPERATOR AND WAIT  */ 01473000
*    ELSE                              /*ENQ FAILED, NO WAIT         */ 01474000
*      DO;                             /*END SET ENQ FAIL INDICATORS */ 01475000
         B     @RC00317                                         02S0383 01476000
@RF00317 DS    0H                                               02S0384 01477000
*        ENQFAIL=ON;                   /*INDICATE ENQ FAILED         */ 01478000
         OI    ENQFAIL,B'00010000'                              02S0384 01479000
*        IF CHSHRXCL=ON THEN           /*CHANGE USE REQUIRED         */ 01480000
         TM    CHSHRXCL,B'10000000'                             02S0385 01481000
         BNO   @RF00385                                         02S0385 01482000
*          ERRCODE=RCXCLUSV;           /*YES, CHANGE NOT POSSIBLE NOW*/ 01483000
         L     @05,@PC00001+32                                  02S0386 01484000
         MVC   ERRCODE(2,@05),@CH00426                          02S0386 01485000
*        ELSE                          /*REGULAR ENQ ON DSNAME       */ 01486000
*          ERRCODE=RCDSUNAV;           /*DSNAME NOT AVAILABLE        */ 01487000
         B     @RC00385                                         02S0387 01488000
@RF00385 L     @05,@PC00001+32                                  02S0387 01489000
         MVC   ERRCODE(2,@05),@CH00428                          02S0387 01490000
*      END;                            /*END SET ENQ FAIL INDICATORS */ 01491000
@RC00385 DS    0H                                               02S0389 01492000
*  END;                                /*END ENQ ERROR               */ 01493000
@RC00317 DS    0H                                               02S0390 01494000
*      END;                            /*END ENQ DSN PROCESS         */ 01495000
@RF00315 DS    0H                                               01S0391 01496000
*  END;                                /*END ADD OR CHANGE PROCESS   */ 01497000
@RF00265 DS    0H                                               01S0392 01498000
*IF ENQFAIL=ON |                       /*ENQUEUE FUNCTION FAILED OR  */ 01499000
*   DELEONLY=ON | DELEDEQ=ON THEN      /*DELETE FUNCTION REQUESTED   */ 01500000
@RF00141 TM    ENQFAIL,B'00010000'                              01S0392 01501000
         BO    @RT00392                                         01S0392 01502000
         L     @05,@PC00001                                     01S0392 01503000
         TM    DELEONLY(@05),B'00011000'                        01S0392 01504000
         BZ    @RF00392                                         01S0392 01505000
@RT00392 DS    0H                                               01S0393 01506000
*  DO;                                 /*YES, UPDATE DSENQ ENTRY     */ 01507000
*/********************************************************************/ 01508000
*/*                                                                  */ 01509000
*/* SEGMENT - DEQDSN                                                 */ 01510000
*/*                                                                  */ 01511000
*/* DESCRIPTIVE NAME - DEQUEUE DATA SET NAME                         */ 01512000
*/*                                                                  */ 01513000
*/* FUNCTION - TO DEQUEUE THE DATA SET NAME IF NECESSARY AND         */ 01514000
*/*            DELETE THE ENTRY FROM THE DSENQ TABLE.                */ 01515000
*/*                                                                  */ 01516000
*/* OPERATION - DETERMINE IF THE DATASET NAME IS NEEDED IN A         */ 01517000
*/*             SUBSEQUENT STEP.  IF SO, DEQ IS NOT POSSIBLE, AND NO */ 01518000
*/*             FURTHER PROCESSING IS DONE.  IF NOT, DEQ IS POSSIBLE.*/ 01519000
*/*             IF THE DELETE AND DEQ FUNCTION IS REQUESTED, DEQ THE */ 01520000
*/*             DATASET NAME.                                        */ 01521000
*/*             NOTE - IF DEQ FUNCTION IS REQUESTED, BUT THE DSNAME  */ 01522000
*/*                    LENGTH IN THE DSENQ TABLE ENTRY IS ZERO, DEQ  */ 01523000
*/*                    IS AVOIDED TO PREVENT A POSSIBLE ABEND. THIS  */ 01524000
*/*                    CASE CAN ONLY HAPPEN IF THE ESTAE ROUTINE GETS*/ 01525000
*/*                    CONTROL AFTER THE ENTRY IS REMOVED FROM THE   */ 01526000
*/*                    DSENQ TABLE AND BEFORE DEQDSNSW IS SET OFF IN */ 01527000
*/*                    THE CASE OF AN ENQ FAILURE.                   */ 01528000
*/*             INITIALIZE THE DEQ PARAMETER LIST WITH LIST FORM OF  */ 01529000
*/*             MACRO. INITIALIZE THE POINTER TO THE MINOR NAME      */ 01530000
*/*             (DSNAME), THE LENGTH OF THE MINOR NAME, THE TCB      */ 01531000
*/*             ADDRESS, AND DEQUEUE.                                */ 01532000
*/*             IF THE DELETE FUNCTION WAS REQUESTED OR THE ENQ      */ 01533000
*/*             FAILED AFTER AN ENTRY HAD BEEN ADDED TO THE DSENQ    */ 01534000
*/*             TABLE, REMOVE THE DATASET NAME ENTRY FROM THE PROPER */ 01535000
*/*             RECORD OF THE DSENQ TABLE BY MOVING ALL ENTRIES      */ 01536000
*/*             FOLLOWING THIS ONE OVER THIS ONE AND ZEROING THE     */ 01537000
*/*             BYTES BEYOND THE LAST ENTRY.                         */ 01538000
*/*             IF ENQ FAILED AFTER THE USE ATTRIBUTE HAD BEEN       */ 01539000
*/*             CHANGED FROM SHARE TO EXCLUSIVE IN THE ENTRY, SET THE*/ 01540000
*/*             USE ATTRIBUTE TO SHARE IN THE DSNAME ENTRY.          */ 01541000
*/*             IF THE DELETE FUNCTION WAS REQUESTED, GET, BUILD     */ 01542000
*/*             AND CHAIN AN EPA FOR THE DSENQ RECORD.               */ 01543000
*/*                                                                  */ 01544000
*/* ENTRY - DEQDSN (INCLUDED SEGMENT)                                */ 01545000
*/*                                                                  */ 01546000
*/*  INPUT DATA - DSNQDSNL - LENGTH OF DSNAME IN DSENQ ENTRY         */ 01547000
*/*               DSNQDSN  - DSNAME IN DSENQ ENTRY                   */ 01548000
*/*               TCBPTR   - INPUT ADDRESS OF TCB                    */ 01549000
*/*               DSNQPTR  - ADDRESS OF DSENQ RECORD CONTAINING      */ 01550000
*/*                          THE DATASET NAME ENTRY                  */ 01551000
*/*               DSNQENTP - ADDRESS OF THE DATASET NAME ENTRY       */ 01552000
*/*               EPADDR   - ADDRESS OF THE LAST EPA                 */ 01553000
*/*               ENQFAIL  - ON IF ENQ WAS NOT SUCCESSFUL AND ENTRY  */ 01554000
*/*                          MUST BE REMOVED FROM DSENQ RECORD       */ 01555000
*/*               STEPNUMB - INPUT STEP NUMBER                       */ 01556000
*/*                                                                  */ 01557000
*/* EXIT - TO NEXT SEQUENTIAL INSTRUCTION                            */ 01558000
*/*                                                                  */ 01559000
*/*  OUTPUT DATA - DATA SET NAME NO LONGER ENQUEUED                  */ 01560000
*/*                DEQDSNSW - OFF, IF IT HAD BEEN SET ON WHEN ENQ    */ 01561000
*/*                FAILED                                            */ 01562000
*/*                                                                  */ 01563000
*/********************************************************************/ 01564000
*IF DSNFOUND=ON | ENQFAIL=ON THEN      /*DSENQ ENTRY FOUND,ENQ FAILED*/ 01565000
         TM    DSNFOUND,B'01010000'                             02S0394 01566000
         BZ    @RF00394                                         02S0394 01567000
*  DO;                                 /*YES, CAN NAME BE REMOVED    */ 01568000
*    IF STEPNUMB>=DSNQSTEP THEN        /*DSN NEEDED IN LATER STEP    */ 01569000
         L     @05,@PC00001+20                                  02S0396 01570000
         CLC   STEPNUMB(1,@05),DSNQSTEP(DSNQENTP)               02S0396 01571000
         BL    @RF00396                                         02S0396 01572000
*      DO;                             /*NO, SEE IF DEQ NECESSARY    */ 01573000
*        IF DELEDEQ=ON & DSNQDSNL^=ZERO THEN /*DEQ FUNCTION REQUESTED*/ 01574000
         L     @05,@PC00001                                     02S0398 01575000
         TM    DELEDEQ(@05),B'00001000'                         02S0398 01576000
         BNO   @RF00398                                         02S0398 01577000
         CLI   DSNQDSNL(DSNQENTP),0                             02S0398 01578000
         BE    @RF00398                                         02S0398 01579000
*          DO;                         /*YES, BUILD PARMS AND DEQ    */ 01580000
*            PARMS=DEQLIST;            /*MOVE IN LIST FORM OF DEQ    */ 01581000
         MVC   PARMS(12),DEQLIST                                02S0400 01582000
*            RFY (R2,R3,R4) RESTRICTED; /*RESTRICT REGISTERS 2,3,4   */ 01583000
*            R2=TCBPTR;                /*STORE TCB ADDRESS           */ 01584000
         L     @05,@PC00001+16                                  02S0402 01585000
         L     R2,TCBPTR(,@05)                                  02S0402 01586000
*            R3=ADDR(DSNQDSN);         /*DSNAME IS MINOR NAME        */ 01587000
         LA    R3,DSNQDSN(,DSNQENTP)                            02S0403 01588000
*            R4=DSNQDSNL;              /*LENGTH OF MINOR NAME (DSN)  */ 01589000
         SLR   R4,R4                                            02S0404 01590000
         IC    R4,DSNQDSNL(,DSNQENTP)                           02S0404 01591000
*            GENERATE;                 /*DEQ DSN IF ENQUEUED         */ 01592000
             DEQ (MAJOR,(3),(4),SYSTEM),RET=HAVE,TCB=(2),MF=(E,PARMS)   01593000
*            RFY (R2,R3,R4) UNRESTRICTED; /*RELEASE REGISTERS 2,3,4  */ 01594000
*          END;                        /*END DEQ DSN PROCESS         */ 01595000
*        IF DELEONLY=ON | (DELEDEQ=ON & ENQDEQCD=ZERO) | /*DELETE OR */ 01596000
*           ENQFAIL=ON THEN            /*ENQUEUE FAILED              */ 01597000
@RF00398 L     @15,@PC00001                                     02S0408 01598000
         TM    DELEONLY(@15),B'00010000'                        02S0408 01599000
         BO    @RT00408                                         02S0408 01600000
         TM    DELEDEQ(@15),B'00001000'                         02S0408 01601000
         BNO   @GL00028                                         02S0408 01602000
         CLI   ENQDEQCD,0                                       02S0408 01603000
         BE    @RT00408                                         02S0408 01604000
@GL00028 TM    ENQFAIL,B'00010000'                              02S0408 01605000
         BNO   @RF00408                                         02S0408 01606000
@RT00408 DS    0H                                               02S0409 01607000
*          DO;                         /*REMOVE ENTRY FROM DSENQ     */ 01608000
*            IF ENQFAIL=ON & CHSHRXCL=ON THEN /*CHANGE USE ENQ FAILD */ 01609000
         TM    ENQFAIL,B'10010000'                              02S0410 01610000
         BNO   @RF00410                                         02S0410 01611000
*              DSNQSHR=ON;             /*PUT SHR BIT BACK ON         */ 01612000
         OI    DSNQSHR(DSNQENTP),B'10000000'                    02S0411 01613000
*            ELSE                      /*NOT ENQ CHANGE FAILURE      */ 01614000
*              DO;                     /*REMOVE ENTRY                */ 01615000
         B     @RC00410                                         02S0412 01616000
@RF00410 DS    0H                                               02S0413 01617000
*                OLDDSNL=DSNQDSNL+ENTRYHDR; /*LENGTH OF DSNAME ENTRY */ 01618000
         SLR   OLDDSNL,OLDDSNL                                  02S0413 01619000
         IC    OLDDSNL,DSNQDSNL(,DSNQENTP)                      02S0413 01620000
         AL    OLDDSNL,ENTRYHDR                                 02S0413 01621000
*                MOVELNG=BLOCKLEN-     /*LENGTH TO MOVE IS LENGTH OF    01622000
*                                        BLOCK MINUS SUM OF -        */ 01623000
*                     ((DSNQENTP-DSNQPTR) + /*BYTES PRIOR TO ENTRY,  */ 01624000
*                      OLDDSNL + DSNQFREE); /*OLD ENTRY, FREE BYTES  */ 01625000
         LR    MOVELNG,DSNQENTP                                 02S0414 01626000
         SLR   MOVELNG,DSNQPTR                                  02S0414 01627000
         ALR   MOVELNG,OLDDSNL                                  02S0414 01628000
         AH    MOVELNG,DSNQFREE(,DSNQPTR)                       02S0414 01629000
         LCR   MOVELNG,MOVELNG                                  02S0414 01630000
         AL    MOVELNG,BLOCKLEN                                 02S0414 01631000
*                IF MOVELNG^=ZERO THEN /*BYTES TO MOVE               */ 01632000
         LTR   MOVELNG,MOVELNG                                  02S0415 01633000
         BZ    @RF00415                                         02S0415 01634000
*                  DO;                 /*YES, MOVE THEM              */ 01635000
*                    TEMPAREA(1:MOVELNG)=                       02S0417 01636000
*                              DSENQ(OLDDSNL+1:OLDDSNL+MOVELNG);        01637000
         LR    @15,MOVELNG                                      02S0417 01638000
         BCTR  @15,0                                            02S0417 01639000
         LR    @01,DSNQENTP                                     02S0417 01640000
         ALR   @01,OLDDSNL                                      02S0417 01641000
         EX    @15,@SM01345                                     02S0417 01642000
*                    DSENQ(1:MOVELNG)=TEMPAREA(1:MOVELNG);      02S0418 01643000
         EX    @15,@SM01347                                     02S0418 01644000
*                    DSNQENTP=DSNQENTP+MOVELNG;/*END OF OTHER ENTRIES*/ 01645000
         ALR   DSNQENTP,MOVELNG                                 02S0419 01646000
*                  END;                /*END OF MOVE BYTES           */ 01647000
*                DSENQ(1:OLDDSNL)=DSENQ(1:OLDDSNL) && DSENQ(1:OLDDSNL); 01648000
@RF00415 LR    @03,OLDDSNL                                      02S0421 01649000
         BCTR  @03,0                                            02S0421 01650000
         EX    @03,@SX01349                                     02S0421 01651000
*                                      /*ZERO BYTES AT THE END OF THE   01652000
*                                        RECORD.  THE LENGTH TO BE      01653000
*                                        ZEROED IS THE LENGTH OF THE    01654000
*                                        ENTRY BEING REMOVED.        */ 01655000
*                DSNQFREE=DSNQFREE+OLDDSNL; /*UPDATE FREE BYTES      */ 01656000
         LR    @06,OLDDSNL                                      02S0422 01657000
         AH    @06,DSNQFREE(,DSNQPTR)                           02S0422 01658000
         STH   @06,DSNQFREE(,DSNQPTR)                           02S0422 01659000
*                IF ENQFAIL=ON THEN    /*ENQ FAILED                  */ 01660000
         TM    ENQFAIL,B'00010000'                              02S0423 01661000
         BNO   @RF00423                                         02S0423 01662000
*                  DO;                 /*YES, RESET INDICATOR        */ 01663000
*                    IF RETINDIC=ON &  /*INDICATOR SET       @ZA04136*/ 01664000
*                       DSNFOUND=OFF THEN /*                 @ZA04136*/ 01665000
         L     @15,@PC00001                                     02S0425 01666000
         TM    RETINDIC(@15),B'00100000'                        02S0425 01667000
         BNO   @RF00425                                         02S0425 01668000
         TM    DSNFOUND,B'01000000'                             02S0425 01669000
         BNZ   @RF00425                                         02S0425 01670000
*                      DEQDSNSW=OFF;   /*YES, RESET IT TO ZERO       */ 01671000
         L     @15,@PC00001+28                                  02S0426 01672000
         NI    DEQDSNSW(@15),B'11011111'                        02S0426 01673000
*                  END;                /*END RESET INDICATORS        */ 01674000
*                ELSE                  /*DELETE FUNCTION PROCESSING  */ 01675000
*                  IF NEPAPROC=OFF THEN /*CALLER WANT EPA?   @ZA04136*/ 01676000
         B     @RC00423                                         02S0428 01677000
@RF00423 L     @06,@PC00001                                     02S0428 01678000
         TM    NEPAPROC(@06),B'00000001'                        02S0428 01679000
         BNZ   @RF00428                                         02S0428 01680000
*                  DO;                 /*YES                 @ZA04136*/ 01681000
*                    RFY (R0,R1) RESTRICTED; /*RESTRICT REGS 0 AND 1 */ 01682000
*                    R0=LENGTH(SWAEPA); /*LENGTH OF EPA              */ 01683000
         LA    R0,16                                            02S0431 01684000
*                    R0=R0 | SUBPOLNO; /*GET FROM CORRECT SUBPOOL    */ 01685000
         O     R0,SUBPOLNO                                      02S0432 01686000
*                    GENERATE;         /*GET CORE FOR EPA            */ 01687000
                     GETMAIN R,LV=(0)                                   01688000
*                    RFY SWAEPA BASED(R1); /*BASE EPA R1     @ZA04136*/ 01689000
*                    SWAEPA=SWAEPA && SWAEPA; /*EPA EQ 0     @ZA04136*/ 01690000
         XC    SWAEPA(16,R1),SWAEPA(R1)                         02S0435 01691000
*                    SWBLKPTR=DSNQPTR; /*DSENQ PTR IN EPA    @ZA04136*/ 01692000
         ST    DSNQPTR,SWBLKPTR(,R1)                            02S0436 01693000
*                      SWVA=DSNQSVA;     /*SVA DSENQ IN EPA  @ZA04136*/ 01694000
         MVC   SWVA(3,R1),DSNQSVA(DSNQPTR)                      02S0437 01695000
*                      SWBLKID=DSNQID;   /*ID DSENQ IN EPA   @ZA04136*/ 01696000
         MVC   SWBLKID(1,R1),DSNQID(DSNQPTR)                    02S0438 01697000
*                      SWLNGTH=BLOCKLEN; /*LENG DSENQ - EPA  @ZA04136*/ 01698000
         L     @15,BLOCKLEN                                     02S0439 01699000
         ST    @15,SWLNGTH(,R1)                                 02S0439 01700000
*                      EPADDR->SWCHNPTR=R1; /*CHAIN NEW EPA  @ZA04136*/ 01701000
         L     @15,@PC00001+12                                  02S0440 01702000
         L     @15,EPADDR(,@15)                                 02S0440 01703000
         ST    R1,SWCHNPTR(,@15)                                02S0440 01704000
*                      RFY SWAEPA BASED(SWEPAPTR); /*REBASE  @ZA04136*/ 01705000
*                      RFY (R0,R1) UNRESTRICTED;   /*RELEASE @ZA04136*/ 01706000
*                    END;              /*                    @ZA04136*/ 01707000
*              END;                    /*END NOT ENQ CHANGE FAILURE  */ 01708000
@RF00428 DS    0H                                               02S0444 01709000
@RC00423 DS    0H                                               02S0445 01710000
*          END;                        /*END REMOVE DSENQ ENTRY      */ 01711000
@RC00410 DS    0H                                               02S0446 01712000
*      END;                            /*END DSNAME NOT NEEDED LATER */ 01713000
@RF00408 DS    0H                                               02S0447 01714000
*  END;                                /*END DSENQ ENTRY FOUND       */ 01715000
@RF00396 DS    0H                                               02S0448 01716000
*  END;                                /*END DELETE PROCESS          */ 01717000
@RF00394 DS    0H                                               01S0449 01718000
*IF ASSIGN = ON THEN                   /*DSENQ RECORD ASSGND @YM06161*/ 01719000
@RF00392 TM    ASSIGN,B'00000001'                               01S0449 01720000
         BNO   @RF00449                                         01S0449 01721000
*  DO;                                 /*YES,WRITE NEW RECORD@YM06161*/ 01722000
*    SWACTLS=SWACTLS && SWACTLS;       /*ZERO CONTROL SWITCHS@YM06161*/ 01723000
         LH    @15,SWACTLS                                      01S0451 01724000
         N     @15,@CF01316                                     01S0451 01725000
         LR    @14,@15                                          01S0451 01726000
         XR    @14,@15                                          01S0451 01727000
         STH   @14,SWACTLS                                      01S0451 01728000
*    SWWRT=ON;                         /*WRITE FUNCTION      @YM06161*/ 01729000
*    SWOLD=ON;                         /*USE EXISTING EPA    @YM06161*/ 01730000
         OI    SWWRT,B'00010001'                                01S0453 01731000
*    CALL IEFAB4F7                     /*WRITE RECORD        @YM06161*/ 01732000
*          (SWACTLS,ADDR(ASSGNEPA),0,0,0,0,0); /*            @YM06161*/ 01733000
         MVC   @AL00001+8(20),@AL00454                          01S0454 01734000
         LA    @15,SWACTLS                                      01S0454 01735000
         ST    @15,@AL00001                                     01S0454 01736000
         LA    @15,ASSGNEPA                                     01S0454 01737000
         ST    @15,@TF00001                                     01S0454 01738000
         LA    @15,@TF00001                                     01S0454 01739000
         ST    @15,@AL00001+4                                   01S0454 01740000
         L     @15,@CV00211                                     01S0454 01741000
         LA    @01,@AL00001                                     01S0454 01742000
         BALR  @14,@15                                          01S0454 01743000
*    IF JCTDETDA = ZERO THEN           /*DSENQ SVA IN JCT?   @YM08602*/ 01744000
         L     @15,@PC00001+4                                   01S0455 01745000
         L     @15,JCTPTR(,@15)                                 01S0455 01746000
         ICM   @14,7,JCTDETDA(@15)                              01S0455 01747000
         BNZ   @RF00455                                         01S0455 01748000
*      JCTDETDA = ASGNDSVA;            /*NO,PUT ASGND SVA IN.@YM08602*/ 01749000
         MVC   JCTDETDA(3,@15),ASGNDSVA                         01S0456 01750000
*    ELSE                              /*DSENQ TBL EXISTS.   @YM08602*/ 01751000
*      SAVDSNQP -> DSNQNSVA = ASGNDSVA; /*ADD ASSIGNED BLK TO CHAIN     01752000
*                                         OF BLOCKS.         @YM08602*/ 01753000
         B     @RC00455                                         01S0457 01754000
@RF00455 MVC   DSNQNSVA(3,SAVDSNQP),ASGNDSVA                    01S0457 01755000
*  END;                                /*END WRITE NEW RECORD@YM06161*/ 01756000
@RC00455 DS    0H                                               01S0459 01757000
*RETURN CODE(0);                       /*RETURN TO CALLER            */ 01758000
@RF00449 IC    @02,@OLDKEY                                      01S0459 01759000
         L     @13,4(,@13)                                      01S0459 01760000
         L     @00,@SIZDATD                                     01S0459 01761000
         LR    @01,@11                                          01S0459 01762000
         FSPACE   R,LV=(0),A=(1)                                        01763000
         MODESET KEYADDR=(2)                                            01764000
         SLR   @15,@15                                          01S0459 01765000
         L     @14,12(,@13)                                     01S0459 01766000
         LM    @00,@12,20(@13)                                  01S0459 01767000
         BR    @14                                              01S0459 01768000
*END IEFAB4DC                                                   01S0460 01769000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01770000
*/*%INCLUDE SYSLIB  (DSNRDATA)                                        * 01771000
*/*%INCLUDE SYSLIB  (IEFZB505)                                        * 01772000
*/*%INCLUDE SYSLIB  (IEFZB4D6)                                        * 01773000
*/*%INCLUDE SYSLIB  (IEFZB4D7)                                        * 01774000
*/*%INCLUDE SYSLIB  (IEFZB902)                                        * 01775000
*/*%INCLUDE SYSLIB  (IEFAJCTB)                                        * 01776000
*/*%INCLUDE SYSLIB  (IEFZB436)                                        * 01777000
*/*%INCLUDE SYSLIB  (IEFZB4DA)                                        * 01778000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 01779000
*/*%INCLUDE SYSLIB  (IEFJESCT)                                        * 01780000
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                        * 01781000
*/*%INCLUDE SYSLIB  (SRCHDSN )                                        * 01782000
*/*%INCLUDE SYSLIB  (UPDENT  )                                        * 01783000
*/*%INCLUDE SYSLIB  (ENQDSN  )                                        * 01784000
*/*%INCLUDE SYSLIB  (CHANGENQ)                                        * 01785000
*/*%INCLUDE SYSLIB  (WAITDSN )                                        * 01786000
*/*%INCLUDE SYSLIB  (DEQDSN  )                                        * 01787000
*;                                                              01S0460 01788000
@DATA    DS    0H                                                       01789000
@CH00403 DC    H'20'                                                    01790000
@CH01281 DC    H'27'                                                    01791000
@CH00283 DC    H'162'                                                   01792000
@CH00426 DC    XL2'020C'                                                01793000
@CH00428 DC    XL2'0210'                                                01794000
@CH00538 DC    XL2'0484'                                                01795000
@SC01321 CLC   DSNQDSN(0,DSNQENTP),DSNAME(@14)                          01796000
@SM01330 MVC   DSNQDSN(0,DSNQENTP),DSNAME(@05)                          01797000
@SM01332 MVC   JESDSNAM(0),DSNQDSN(DSNQENTP)                            01798000
@SM01334 MVC   WTORBUF(0,WTORPTR),JOBNAME(@14)                          01799000
@SM01336 MVC   WTORBUF(0,WTORPTR),STEPNAME(@14)                         01800000
@SM01338 MVC   M861JOBN(0),JOBNAME(@05)                                 01801000
@SM01340 MVC   M863DSN(0),DSNQDSN(DSNQENTP)                             01802000
@SM01345 MVC   TEMPAREA(0),DSENQ(@01)                                   01803000
@SM01347 MVC   DSENQ(0,DSNQENTP),TEMPAREA                               01804000
@SX01349 XC    DSENQ(0,DSNQENTP),DSENQ(DSNQENTP)                        01805000
         DS    0F                                                       01806000
@AL00454 DC    A(@CF00182)             LIST WITH   5 ARGUMENT(S)        01807000
         DC    A(@CF00182)                                              01808000
         DC    A(@CF00182)                                              01809000
         DC    A(@CF00182)                                              01810000
         DC    A(@CF00182)                                              01811000
@DATD    DSECT                                                          01812000
         DS    0F                                                       01813000
@SA00001 DS    18F                                                      01814000
@PC00001 DS    11F                                                      01815000
@AL00001 DS    7A                                                       01816000
@TF00001 DS    F                                                        01817000
@TF00002 DS    F                                                        01818000
@TF00003 DS    F                                                        01819000
IEFAB4DC CSECT                                                          01820000
         DS    0F                                                       01821000
@CF00182 DC    F'0'                                                     01822000
@CF00099 DC    F'1'                                                     01823000
@CF00057 DC    F'8'                                                     01824000
@CF00066 DC    F'16'                                                    01825000
@CH00066 EQU   @CF00066+2                                               01826000
@CF00142 DC    F'44'                                                    01827000
@CF01316 DC    XL4'0000FFFF'                                            01828000
@DATD    DSECT                                                          01829000
         DS    0D                                                       01830000
ENQECB   DS    FL4                                                      01831000
         ORG   ENQECB                                                   01832000
ECBWAIT  DS    BL1                                                      01833000
ECBPOST  EQU   ENQECB+0                                                 01834000
ECBCOMP  EQU   ENQECB+0                                                 01835000
         ORG   ENQECB+4                                                 01836000
WTORECB  DS    FL4                                                      01837000
         ORG   WTORECB                                                  01838000
WECBWAIT DS    BL1                                                      01839000
WECBPOST EQU   WTORECB+0                                                01840000
WECBCOMP EQU   WTORECB+0                                                01841000
         ORG   WTORECB+4                                                01842000
LASTDSNQ DS    F                                                        01843000
SWACTLS  DS    FL2                                                      01844000
         ORG   SWACTLS                                                  01845000
SWASN    DS    BL1                                                      01846000
SWDEL    EQU   SWACTLS+0                                                01847000
SWREAD   EQU   SWACTLS+0                                                01848000
SWWRT    EQU   SWACTLS+0                                                01849000
SWNEW    EQU   SWACTLS+0                                                01850000
SWFREE   EQU   SWACTLS+0                                                01851000
SWMOD    EQU   SWACTLS+0                                                01852000
SWOLD    EQU   SWACTLS+0                                                01853000
SWCHN    DS    BL1                                                      01854000
@NM00032 EQU   SWACTLS+1                                                01855000
         ORG   SWACTLS+2                                                01856000
@TS00001 DS    CL4                                                      01857000
ASGNDSVA DS    CL3                                                      01858000
REPLYBUF DS    CL2                                                      01859000
DSNRRSWS DS    CL2                                                      01860000
         ORG   DSNRRSWS                                                 01861000
CHSHRXCL DS    BL1                                                      01862000
DSNFOUND EQU   DSNRRSWS+0                                               01863000
UPJCTEPA EQU   DSNRRSWS+0                                               01864000
ENQFAIL  EQU   DSNRRSWS+0                                               01865000
FRSTREAD EQU   DSNRRSWS+0                                               01866000
NOREAD   EQU   DSNRRSWS+0                                               01867000
ENDWAIT  EQU   DSNRRSWS+0                                               01868000
ASSIGN   EQU   DSNRRSWS+0                                               01869000
UPDATE   DS    BL1                                                      01870000
CHNGSTEP EQU   DSNRRSWS+1                                               01871000
@NM00001 EQU   DSNRRSWS+1                                               01872000
         ORG   DSNRRSWS+2                                               01873000
         DS    CL3                                                      01874000
@NM00002 DS    CL8                                                      01875000
         ORG   @NM00002                                                 01876000
BLOCK    DS    FL4                                                      01877000
SVAID    DS    CL4                                                      01878000
         ORG   SVAID                                                    01879000
SVA      DS    CL3                                                      01880000
TID      DS    CL1                                                      01881000
         ORG   @NM00002+8                                               01882000
ENQDEQP  DS    CL16                                                     01883000
         ORG   ENQDEQP                                                  01884000
TCBADDR  DS    FL4                                                      01885000
PARMS    DS    CL12                                                     01886000
         ORG   PARMS                                                    01887000
EOT      DS    CL1                                                      01888000
MINORLN  DS    AL1                                                      01889000
EOPTIONS DS    BL1                                                      01890000
ENQDEQCD DS    AL1                                                      01891000
MAJORNM  DS    AL4                                                      01892000
MINORNM  DS    AL4                                                      01893000
         ORG   ENQDEQP+16                                               01894000
MSG861I  DS    CL73                                                     01895000
         ORG   MSG861I                                                  01896000
M861LEN  DS    FL2                                                      01897000
@NM00003 DS    CL2                                                      01898000
M861TXT  DS    CL57                                                     01899000
M861JOBN DS    CL8                                                      01900000
M861RTCD DS    CL4                                                      01901000
         ORG   MSG861I+73                                               01902000
         DS    CL1                                                      01903000
MSG863I  DS    CL66                                                     01904000
         ORG   MSG863I                                                  01905000
M863LEN  DS    FL2                                                      01906000
@NM00004 DS    CL2                                                      01907000
M863TXT  DS    CL14                                                     01908000
M863DSN  DS    CL44                                                     01909000
M863RTCD DS    CL4                                                      01910000
         ORG   MSG863I+66                                               01911000
WAITECBS DS    CL8                                                      01912000
         ORG   WAITECBS                                                 01913000
WAITWTOR DS    FL4                                                      01914000
WAITENQ  DS    FL4                                                      01915000
         ORG   WAITENQ                                                  01916000
@NM00005 DS    BL4                                                      01917000
         ORG   @NM00005                                                 01918000
WAITEND  DS    BL1                                                      01919000
@NM00006 EQU   @NM00005+0                                               01920000
         ORG   WAITECBS+8                                               01921000
WTORPARM DS    CL88                                                     01922000
         ORG   WTORPARM                                                 01923000
@NM00007 DS    CL8                                                      01924000
WTORLNGH DS    FL2                                                      01925000
@NM00008 DS    CL10                                                     01926000
WTORJOB  DS    CL8                                                      01927000
@NM00009 DS    CL60                                                     01928000
         ORG   WTORPARM+88                                              01929000
JESDSNAM DS    CL44                                                     01930000
READEPA  DS    CL16                                                     01931000
ASSGNEPA DS    CL16                                                     01932000
TEMPAREA DS    CL162                                                    01933000
         DS    CL2                                                      01934000
SSOB     DS    CL20                                                     01935000
         ORG   SSOB                                                     01936000
SSOBID   DS    CL4                                                      01937000
SSOBLEN  DS    FL2                                                      01938000
SSOBFUNC DS    FL2                                                      01939000
SSOBSSIB DS    AL4                                                      01940000
SSOBRETN DS    AL4                                                      01941000
SSOBINDV DS    AL4                                                      01942000
         ORG   SSOB+20                                                  01943000
SSNQ     DS    CL16                                                     01944000
         ORG   SSNQ                                                     01945000
SSNQLEN  DS    FL2                                                      01946000
SSNQRSV0 DS    FL2                                                      01947000
SSNQDSNP DS    AL4                                                      01948000
SSNQFLGP DS    AL4                                                      01949000
SSNQRSV1 DS    FL4                                                      01950000
         ORG   SSNQ+16                                                  01951000
FLAGS    DS    CL2                                                      01952000
         ORG   FLAGS                                                    01953000
SHRTOXCL DS    BL1                                                      01954000
@NM00036 EQU   FLAGS+0                                                  01955000
         ORG   FLAGS+2                                                  01956000
@OLDKEY  DS    AL1                                                      01957000
IEFAB4DC CSECT                                                          01958000
         DS    0F                                                       01959000
@SIZDATD DC    AL1(230)                                                 01960000
         DC    AL3(@ENDDATD-@DATD)                                      01961000
@CV00211 DC    V(IEFAB4F7)                                              01962000
@CV00212 DC    V(IEF458D)                                               01963000
@CV00213 DC    V(IEF861I)                                               01964000
@CV00214 DC    V(IEF863I)                                               01965000
         DS    0D                                                       01966000
ENTRYHDR DC    AL4(1+1+1)                                               01967000
BLOCKLEN DC    AL4(176)                                                 01968000
CLEAR    DC    X'00'                                                    01969000
ERROR    DC    X'FF'                                                    01970000
         DS    CL2                                                      01971000
SUBPOLNO DC    X'E6000000'                                              01972000
MAJOR    DC    CL8'SYSDSN'                                              01973000
BLANKS   DC    CL2'  '                                                  01974000
SSOBCHAR DC    CL4'SSOB'                                                01975000
FOLDMASK DC    X'4040'                                                  01976000
NO       DC    CL2'NO'                                                  01977000
IEFAB4DC CSECT                                                          01978000
         DS   0H                                                        01979000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   01980000
IEFAB4DC CSECT                                                          01981000
ENQLIST  ENQ (MAJOR,,,,SYSTEM),RET=USE,TCB=0,MF=L                       01982000
ENQWAITL ENQ (MAJOR,,,,SYSTEM),ECB=0,MF=L                               01983000
DEQLIST  DEQ (MAJOR,,,SYSTEM),RET=HAVE,TCB=0,MF=L                       01984000
@DATD    DSECT                                                          01985000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01986000
@ENDDATD EQU   *                                                        01987000
IEFAB4DC CSECT                                                          01988000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01989000
@01      EQU   01                                                       01990000
@02      EQU   02                                                       01991000
@03      EQU   03                                                       01992000
@04      EQU   04                                                       01993000
@05      EQU   05                                                       01994000
@06      EQU   06                                                       01995000
@07      EQU   07                                                       01996000
@08      EQU   08                                                       01997000
@09      EQU   09                                                       01998000
@10      EQU   10                                                       01999000
@11      EQU   11                                                       02000000
@12      EQU   12                                                       02001000
@13      EQU   13                                                       02002000
@14      EQU   14                                                       02003000
@15      EQU   15                                                       02004000
MSGID    EQU   @08                                                      02005000
STEPNLNG EQU   @08                                                      02006000
JOBNLNG  EQU   @09                                                      02007000
REALNGTH EQU   @04                                                      02008000
ENTRYLNG EQU   @09                                                      02009000
ENDRCRD  EQU   @05                                                      02010000
OLDDSNL  EQU   @02                                                      02011000
MOVELNG  EQU   @03                                                      02012000
DSNQPTR  EQU   @07                                                      02013000
RECPTR   EQU   @02                                                      02014000
WTORPTR  EQU   @05                                                      02015000
SWEPAPTR EQU   @03                                                      02016000
SAVEREC  EQU   @08                                                      02017000
SAVDSNQP EQU   @10                                                      02018000
DSNQENTP EQU   @06                                                      02019000
R0       EQU   @00                                                      02020000
R1       EQU   @01                                                      02021000
R2       EQU   @02                                                      02022000
R3       EQU   @03                                                      02023000
R4       EQU   @04                                                      02024000
CVTPTR   EQU   16                                                       02025000
MSGPARMS EQU   0                                                        02026000
JOBNAME  EQU   MSGPARMS                                                 02027000
STEPNAME EQU   MSGPARMS+8                                               02028000
WTORBUF  EQU   0                                                        02029000
WTOLIST  EQU   0                                                        02030000
SWAEPA   EQU   0                                                        02031000
SWBLKPTR EQU   SWAEPA                                                   02032000
SWVAFW   EQU   SWAEPA+4                                                 02033000
SWVA     EQU   SWVAFW                                                   02034000
SWBLKID  EQU   SWVAFW+3                                                 02035000
SWLNGTH  EQU   SWAEPA+8                                                 02036000
SWCHNPTR EQU   SWAEPA+12                                                02037000
DSNQTABL EQU   0                                                        02038000
DSNQSVA  EQU   DSNQTABL                                                 02039000
DSNQID   EQU   DSNQTABL+3                                               02040000
DSNQNSVA EQU   DSNQTABL+4                                               02041000
DSNQNEXT EQU   DSNQTABL+8                                               02042000
DSNQFREE EQU   DSNQTABL+12                                              02043000
DSNQENTS EQU   DSNQTABL+14                                              02044000
WTORLIST EQU   0                                                        02045000
DSNQNTRY EQU   0                                                        02046000
DSNQSTEP EQU   DSNQNTRY                                                 02047000
DSNQFLG1 EQU   DSNQNTRY+1                                               02048000
DSNQSHR  EQU   DSNQFLG1                                                 02049000
DSNQDSNL EQU   DSNQNTRY+2                                               02050000
DSNQDSN  EQU   DSNQNTRY+3                                               02051000
DSENQ    EQU   0                                                        02052000
INJMJCT  EQU   0                                                        02053000
JCTDSKAD EQU   INJMJCT                                                  02054000
JCTIDENT EQU   INJMJCT+3                                                02055000
JCTJSTAT EQU   INJMJCT+5                                                02056000
INDMCTLG EQU   JCTJSTAT                                                 02057000
JCTJBYTE EQU   INJMJCT+7                                                02058000
JCTJMGLV EQU   JCTJBYTE                                                 02059000
JCTCCODE EQU   INJMJCT+54                                               02060000
JCTRSW1  EQU   INJMJCT+86                                               02061000
JCTRSW2  EQU   INJMJCT+87                                               02062000
JCTDETDA EQU   INJMJCT+88                                               02063000
JCTJSB   EQU   INJMJCT+111                                              02064000
JCTSTAT2 EQU   INJMJCT+116                                              02065000
IEFAACTB EQU   0                                                        02066000
CVTMAP   EQU   0                                                        02067000
CVTDAR   EQU   CVTMAP+72                                                02068000
CVTFLGS1 EQU   CVTDAR                                                   02069000
CVTDCB   EQU   CVTMAP+116                                               02070000
CVTIERLC EQU   CVTMAP+144                                               02071000
CVTOPTA  EQU   CVTMAP+182                                               02072000
CVTOPTB  EQU   CVTMAP+183                                               02073000
CVTGTF   EQU   CVTMAP+236                                               02074000
CVTGTFST EQU   CVTGTF                                                   02075000
CVTGTFS  EQU   CVTGTFST                                                 02076000
CVTSTATE EQU   CVTGTFST                                                 02077000
CVTTMODE EQU   CVTGTFST                                                 02078000
CVTFORM  EQU   CVTGTFST                                                 02079000
CVTAQAVT EQU   CVTMAP+240                                               02080000
CVTTCMFG EQU   CVTAQAVT                                                 02081000
CVTVOLM2 EQU   CVTMAP+244                                               02082000
CVTTATA  EQU   CVTVOLM2                                                 02083000
CVTTSKS  EQU   CVTTATA                                                  02084000
CVTVOLF2 EQU   CVTTSKS                                                  02085000
CVTTAT   EQU   CVTTATA+1                                                02086000
CVTATER  EQU   CVTMAP+248                                               02087000
CVTEXT1  EQU   CVTMAP+252                                               02088000
CVTPURG  EQU   CVTMAP+260                                               02089000
CVTQMSG  EQU   CVTMAP+268                                               02090000
CVTDMSR  EQU   CVTMAP+272                                               02091000
CVTRSV37 EQU   CVTDMSR                                                  02092000
CVTDMSRF EQU   CVTRSV37                                                 02093000
CVTJESCT EQU   CVTMAP+296                                               02094000
CVTERPV  EQU   CVTMAP+316                                               02095000
CVTINTLA EQU   CVTMAP+320                                               02096000
CVTAPF   EQU   CVTMAP+324                                               02097000
CVTEXT2  EQU   CVTMAP+328                                               02098000
CVTHJES  EQU   CVTMAP+332                                               02099000
CVTPGSIA EQU   CVTMAP+348                                               02100000
CVTA1F1  EQU   CVTMAP+356                                               02101000
CVTSYSK  EQU   CVTMAP+357                                               02102000
CVTVOLM1 EQU   CVTMAP+380                                               02103000
CVTVOLF1 EQU   CVTVOLM1                                                 02104000
CVTATMCT EQU   CVTMAP+388                                               02105000
CVTXTNT1 EQU   0                                                        02106000
CVTXTNT2 EQU   0                                                        02107000
CVTDSSV  EQU   CVTXTNT2                                                 02108000
CVTFLGBT EQU   CVTXTNT2+5                                               02109000
CVTQID   EQU   CVTXTNT2+24                                              02110000
CVTRV400 EQU   CVTXTNT2+52                                              02111000
CVTRV409 EQU   CVTXTNT2+53                                              02112000
CVTATCVT EQU   CVTXTNT2+64                                              02113000
CVTRV429 EQU   CVTXTNT2+84                                              02114000
CVTRV438 EQU   CVTXTNT2+85                                              02115000
CVTRV457 EQU   CVTXTNT2+112                                             02116000
CVTRV466 EQU   CVTXTNT2+113                                             02117000
CVTFIX   EQU   0                                                        02118000
CVTRELNO EQU   CVTFIX+252                                               02119000
JESCT    EQU   0                                                        02120000
JESWAA   EQU   JESCT+8                                                  02121000
JESSSREQ EQU   JESCT+20                                                 02122000
JESALLOC EQU   JESCT+32                                                 02123000
JESUNALC EQU   JESCT+36                                                 02124000
JESCATL  EQU   JESCT+40                                                 02125000
SSREQ    EQU   0                                                        02126000
IEFAB4F5 EQU   0                                                        02127000
IEFBB410 EQU   0                                                        02128000
IEFW21SD EQU   0                                                        02129000
SWAMGR   EQU   0                                                        02130000
DSRRFMAP EQU   0                                                        02131000
ADDRPASS EQU   DSRRFMAP                                                 02132000
ADCHONLY EQU   DSRRFMAP                                                 02133000
ADCHENQ  EQU   DSRRFMAP                                                 02134000
DELEONLY EQU   DSRRFMAP                                                 02135000
DELEDEQ  EQU   DSRRFMAP                                                 02136000
NOSHRXCL EQU   DSRRFMAP                                                 02137000
ENQSHR   EQU   DSRRFMAP                                                 02138000
ENQEXCL  EQU   DSRRFMAP                                                 02139000
ENQWAIT  EQU   DSRRFMAP+1                                               02140000
RETADDR  EQU   DSRRFMAP+1                                               02141000
RETINDIC EQU   DSRRFMAP+1                                               02142000
READALL  EQU   DSRRFMAP+1                                               02143000
INCORREC EQU   DSRRFMAP+1                                               02144000
EPAJCTEX EQU   DSRRFMAP+1                                               02145000
SRCHDSNM EQU   DSRRFMAP+1                                               02146000
NEPAPROC EQU   DSRRFMAP+1                                               02147000
JCTPTR   EQU   0                                                        02148000
DSNPARM  EQU   0                                                        02149000
DSNLNGH  EQU   DSNPARM                                                  02150000
DSNAME   EQU   DSNPARM+2                                                02151000
EPADDR   EQU   0                                                        02152000
TCBPTR   EQU   0                                                        02153000
STEPNUMB EQU   0                                                        02154000
INPTADDR EQU   0                                                        02155000
ENTADDR  EQU   INPTADDR                                                 02156000
RECADDR  EQU   INPTADDR+4                                               02157000
ALFNCMAP EQU   0                                                        02158000
INPUTSW  EQU   ALFNCMAP                                                 02159000
PROCESSW EQU   ALFNCMAP+6                                               02160000
ERRPROSW EQU   PROCESSW                                                 02161000
DEQDSNSW EQU   ERRPROSW                                                 02162000
NQEXCLSW EQU   PROCESSW                                                 02163000
RETCODE  EQU   0                                                        02164000
ERRCODE  EQU   RETCODE                                                  02165000
FIRSTREC EQU   0                                                        02166000
MSGPARMP EQU   0                                                        02167000
CVTS01   EQU   CVTPGSIA                                                 02168000
CVTLPDIA EQU   CVTS01+12                                                02169000
CVTDIRST EQU   CVTLPDIA                                                 02170000
CVTSLIDA EQU   CVTS01+24                                                02171000
CVTCTLFG EQU   CVTS01+50                                                02172000
CVTRV210 EQU   CVTS01+424                                               02173000
CVTRV219 EQU   CVTS01+425                                               02174000
CVTRV228 EQU   CVTS01+426                                               02175000
CVTRV237 EQU   CVTS01+427                                               02176000
CVTMFRTR EQU   CVTS01+452                                               02177000
CVTRV262 EQU   CVTS01+468                                               02178000
CVTRV271 EQU   CVTS01+469                                               02179000
CVTRV280 EQU   CVTS01+470                                               02180000
CVTRV289 EQU   CVTS01+471                                               02181000
CVTGSDA  EQU   CVTS01+600                                               02182000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02183000
CVTRV628 EQU   CVTS01+728                                               02184000
CVTRV627 EQU   CVTS01+724                                               02185000
CVTRV626 EQU   CVTS01+720                                               02186000
CVTRV625 EQU   CVTS01+716                                               02187000
CVTRV624 EQU   CVTS01+712                                               02188000
CVTRV623 EQU   CVTS01+708                                               02189000
CVTRV622 EQU   CVTS01+704                                               02190000
CVTRV621 EQU   CVTS01+700                                               02191000
CVTIHASU EQU   CVTS01+696                                               02192000
CVTRV619 EQU   CVTS01+692                                               02193000
CVTRV618 EQU   CVTS01+688                                               02194000
CVTRV617 EQU   CVTS01+684                                               02195000
CVTRV616 EQU   CVTS01+680                                               02196000
CVTRV615 EQU   CVTS01+676                                               02197000
CVTRV614 EQU   CVTS01+672                                               02198000
CVTRV613 EQU   CVTS01+668                                               02199000
CVTTCASP EQU   CVTS01+664                                               02200000
CVT0PT03 EQU   CVTS01+660                                               02201000
CVT0PT0E EQU   CVTS01+656                                               02202000
CVTRV609 EQU   CVTS01+652                                               02203000
CVTCGK   EQU   CVTS01+648                                               02204000
CVTRAC   EQU   CVTS01+644                                               02205000
CVTRV606 EQU   CVTS01+640                                               02206000
CVTRV605 EQU   CVTS01+636                                               02207000
CVTRV604 EQU   CVTS01+632                                               02208000
CVTEFF02 EQU   CVTS01+628                                               02209000
CVTCBBR  EQU   CVTS01+624                                               02210000
CVTSSCR  EQU   CVTS01+620                                               02211000
CVTEVENT EQU   CVTS01+616                                               02212000
CVTCRCA  EQU   CVTS01+612                                               02213000
CVTTPIO  EQU   CVTS01+608                                               02214000
CVTADV   EQU   CVTS01+604                                               02215000
CVTGSDAB EQU   CVTGSDA                                                  02216000
CVTQV3   EQU   CVTS01+596                                               02217000
CVTQV2   EQU   CVTS01+592                                               02218000
CVTQV1   EQU   CVTS01+588                                               02219000
CVTRPT   EQU   CVTS01+584                                               02220000
CVTSSRB  EQU   CVTS01+580                                               02221000
CVTCSDRL EQU   CVTS01+576                                               02222000
CVTEXP1  EQU   CVTS01+572                                               02223000
CVTRMPMT EQU   CVTS01+568                                               02224000
CVTRMPTT EQU   CVTS01+564                                               02225000
CVTVPSA  EQU   CVTS01+560                                               02226000
CVTVSTOP EQU   CVTS01+556                                               02227000
CVTGTFR8 EQU   CVTS01+552                                               02228000
CVTQUIT  EQU   CVTS01+548                                               02229000
CVTVACR  EQU   CVTS01+544                                               02230000
CVTWTCB  EQU   CVTS01+540                                               02231000
CVTSTPRS EQU   CVTS01+536                                               02232000
CVT0PT02 EQU   CVTS01+532                                               02233000
CVTDARCM EQU   CVTS01+528                                               02234000
CVTIRECM EQU   CVTS01+524                                               02235000
CVTJRECM EQU   CVTS01+520                                               02236000
CVTVEMS0 EQU   CVTS01+516                                               02237000
CVTSPFRR EQU   CVTS01+512                                               02238000
CVTRLSTG EQU   CVTS01+508                                               02239000
CVT0TC0A EQU   CVTS01+504                                               02240000
CVTGMBR  EQU   CVTS01+500                                               02241000
CVTLFRM  EQU   CVTS01+496                                               02242000
CVTRMBR  EQU   CVTS01+492                                               02243000
CVTVIOP  EQU   CVTS01+488                                               02244000
CVTRV307 EQU   CVTS01+486                                               02245000
CVTRV306 EQU   CVTS01+484                                               02246000
CVTRV305 EQU   CVTS01+482                                               02247000
CVTRV304 EQU   CVTS01+480                                               02248000
CVTRV303 EQU   CVTS01+478                                               02249000
CVTRV302 EQU   CVTS01+476                                               02250000
CVTTRCA  EQU   CVTS01+472                                               02251000
CVTRV297 EQU   CVTRV289                                                 02252000
CVTRV296 EQU   CVTRV289                                                 02253000
CVTRV295 EQU   CVTRV289                                                 02254000
CVTRV294 EQU   CVTRV289                                                 02255000
CVTRV293 EQU   CVTRV289                                                 02256000
CVTRV292 EQU   CVTRV289                                                 02257000
CVTRV291 EQU   CVTRV289                                                 02258000
CVTRV290 EQU   CVTRV289                                                 02259000
CVTRV288 EQU   CVTRV280                                                 02260000
CVTRV287 EQU   CVTRV280                                                 02261000
CVTRV286 EQU   CVTRV280                                                 02262000
CVTRV285 EQU   CVTRV280                                                 02263000
CVTRV284 EQU   CVTRV280                                                 02264000
CVTRV283 EQU   CVTRV280                                                 02265000
CVTRV282 EQU   CVTRV280                                                 02266000
CVTRV281 EQU   CVTRV280                                                 02267000
CVTRV279 EQU   CVTRV271                                                 02268000
CVTRV278 EQU   CVTRV271                                                 02269000
CVTRV277 EQU   CVTRV271                                                 02270000
CVTRV276 EQU   CVTRV271                                                 02271000
CVTRV275 EQU   CVTRV271                                                 02272000
CVTRV274 EQU   CVTRV271                                                 02273000
CVTRV273 EQU   CVTRV271                                                 02274000
CVTRV272 EQU   CVTRV271                                                 02275000
CVTRV270 EQU   CVTRV262                                                 02276000
CVTRV269 EQU   CVTRV262                                                 02277000
CVTRV268 EQU   CVTRV262                                                 02278000
CVTRV267 EQU   CVTRV262                                                 02279000
CVTRV266 EQU   CVTRV262                                                 02280000
CVTRV265 EQU   CVTRV262                                                 02281000
CVTRV264 EQU   CVTRV262                                                 02282000
CVTRV263 EQU   CVTRV262                                                 02283000
CVTVFP   EQU   CVTS01+464                                               02284000
CVTVSI   EQU   CVTS01+460                                               02285000
CVTVPSIB EQU   CVTS01+456                                               02286000
CVTMFACT EQU   CVTMFRTR                                                 02287000
CVTMFCTL EQU   CVTS01+448                                               02288000
CVTPVBP  EQU   CVTS01+444                                               02289000
CVTPWI   EQU   CVTS01+440                                               02290000
CVTRV254 EQU   CVTS01+438                                               02291000
CVTRV253 EQU   CVTS01+436                                               02292000
CVTRV252 EQU   CVTS01+434                                               02293000
CVTRV251 EQU   CVTS01+433                                               02294000
CVTRV250 EQU   CVTS01+432                                               02295000
CVTRV249 EQU   CVTS01+431                                               02296000
CVTRV248 EQU   CVTS01+430                                               02297000
CVTRV247 EQU   CVTS01+429                                               02298000
CVTRV246 EQU   CVTS01+428                                               02299000
CVTRV245 EQU   CVTRV237                                                 02300000
CVTRV244 EQU   CVTRV237                                                 02301000
CVTRV243 EQU   CVTRV237                                                 02302000
CVTRV242 EQU   CVTRV237                                                 02303000
CVTRV241 EQU   CVTRV237                                                 02304000
CVTRV240 EQU   CVTRV237                                                 02305000
CVTRV239 EQU   CVTRV237                                                 02306000
CVTRV238 EQU   CVTRV237                                                 02307000
CVTRV236 EQU   CVTRV228                                                 02308000
CVTRV235 EQU   CVTRV228                                                 02309000
CVTRV234 EQU   CVTRV228                                                 02310000
CVTRV233 EQU   CVTRV228                                                 02311000
CVTRV232 EQU   CVTRV228                                                 02312000
CVTRV231 EQU   CVTRV228                                                 02313000
CVTRV230 EQU   CVTRV228                                                 02314000
CVTRV229 EQU   CVTRV228                                                 02315000
CVTRV227 EQU   CVTRV219                                                 02316000
CVTRV226 EQU   CVTRV219                                                 02317000
CVTRV225 EQU   CVTRV219                                                 02318000
CVTRV224 EQU   CVTRV219                                                 02319000
CVTRV223 EQU   CVTRV219                                                 02320000
CVTRV222 EQU   CVTRV219                                                 02321000
CVTRV221 EQU   CVTRV219                                                 02322000
CVTRV220 EQU   CVTRV219                                                 02323000
CVTRV218 EQU   CVTRV210                                                 02324000
CVTRV217 EQU   CVTRV210                                                 02325000
CVTRV216 EQU   CVTRV210                                                 02326000
CVTRV215 EQU   CVTRV210                                                 02327000
CVTRV214 EQU   CVTRV210                                                 02328000
CVTRV213 EQU   CVTRV210                                                 02329000
CVTRV212 EQU   CVTRV210                                                 02330000
CVTRV211 EQU   CVTRV210                                                 02331000
CVTLCCAT EQU   CVTS01+420                                               02332000
CVTPCCAT EQU   CVTS01+416                                               02333000
CVTIPCRP EQU   CVTS01+412                                               02334000
CVTIPCRI EQU   CVTS01+408                                               02335000
CVTIPCDS EQU   CVTS01+404                                               02336000
CVTAIDVT EQU   CVTS01+400                                               02337000
CVTSSAP  EQU   CVTS01+396                                               02338000
CVTEHCIR EQU   CVTS01+392                                               02339000
CVTEHDEF EQU   CVTS01+388                                               02340000
CVTDAIR  EQU   CVTS01+384                                               02341000
CVTPERFM EQU   CVTS01+380                                               02342000
CVT044R2 EQU   CVTS01+376                                               02343000
CVTFETCH EQU   CVTS01+372                                               02344000
CVTRSTWD EQU   CVTS01+368                                               02345000
CVTSPOST EQU   CVTS01+364                                               02346000
CVTIOBP  EQU   CVTS01+360                                               02347000
CVTASMVT EQU   CVTS01+356                                               02348000
CVTRECRQ EQU   CVTS01+352                                               02349000
CVTWSAC  EQU   CVTS01+348                                               02350000
CVTRV149 EQU   CVTS01+344                                               02351000
CVTWSAL  EQU   CVTS01+340                                               02352000
CVTSPSA  EQU   CVTS01+336                                               02353000
CVTGLMN  EQU   CVTS01+332                                               02354000
CVTVEAC0 EQU   CVTS01+328                                               02355000
CVT062R1 EQU   CVTS01+324                                               02356000
CVTRPOST EQU   CVTS01+320                                               02357000
CVTDQIQE EQU   CVTS01+316                                               02358000
CVTCSD   EQU   CVTS01+312                                               02359000
CVTLKRMA EQU   CVTS01+308                                               02360000
CVTRSPIE EQU   CVTS01+304                                               02361000
CVTRENQ  EQU   CVTS01+300                                               02362000
CVTLQCB  EQU   CVTS01+296                                               02363000
CVTFQCB  EQU   CVTS01+292                                               02364000
CVTQCS01 EQU   CVTS01+288                                               02365000
CVTAPFT  EQU   CVTS01+284                                               02366000
CVTPARRL EQU   CVTS01+280                                               02367000
CVTVWAIT EQU   CVTS01+276                                               02368000
CVTGSPL  EQU   CVTS01+272                                               02369000
CVTLSMQ  EQU   CVTS01+268                                               02370000
CVTGSMQ  EQU   CVTS01+264                                               02371000
CVTEXPRO EQU   CVTS01+260                                               02372000
CVTOPCTP EQU   CVTS01+256                                               02373000
CVTSIC   EQU   CVTS01+252                                               02374000
CVTTPIOS EQU   CVTS01+248                                               02375000
CVTRTMS  EQU   CVTS01+244                                               02376000
CVTSDBF  EQU   CVTS01+240                                               02377000
CVTSCBP  EQU   CVTS01+236                                               02378000
CVTSDMP  EQU   CVTS01+232                                               02379000
CVTSV60  EQU   CVTS01+228                                               02380000
CVTRTMCT EQU   CVTS01+224                                               02381000
CVTASCBL EQU   CVTS01+220                                               02382000
CVTASCBH EQU   CVTS01+216                                               02383000
CVTGDA   EQU   CVTS01+212                                               02384000
CVTASVT  EQU   CVTS01+208                                               02385000
CVTVVMDI EQU   CVTS01+204                                               02386000
CVTAQTOP EQU   CVTS01+200                                               02387000
CVTIOSCS EQU   CVTS01+196                                               02388000
CVTSDRM  EQU   CVTS01+192                                               02389000
CVTOPTE  EQU   CVTS01+188                                               02390000
CVTSTXU  EQU   CVTS01+184                                               02391000
CVTQUIS  EQU   CVTS01+180                                               02392000
CVTPARS  EQU   CVTS01+176                                               02393000
CVTS1EE  EQU   CVTS01+172                                               02394000
CVTFRAS  EQU   CVTS01+168                                               02395000
CVTQSAS  EQU   CVTS01+164                                               02396000
CVTCRAS  EQU   CVTS01+160                                               02397000
CVTCRMN  EQU   CVTS01+156                                               02398000
CVTDELCP EQU   CVTS01+152                                               02399000
CVTFRECL EQU   CVTS01+148                                               02400000
CVTGETCL EQU   CVTS01+144                                               02401000
CVTBLDCP EQU   CVTS01+140                                               02402000
CVTAUTHL EQU   CVTS01+136                                               02403000
CVTSCAN  EQU   CVTS01+132                                               02404000
CVTRV144 EQU   CVTS01+130                                               02405000
CVTMAXMP EQU   CVTS01+128                                               02406000
CVTSTCK  EQU   CVTS01+124                                               02407000
CVTRV139 EQU   CVTS01+123                                               02408000
CVTDSSAC EQU   CVTS01+122                                               02409000
CVTRV513 EQU   CVTS01+121                                               02410000
CVTIOSPL EQU   CVTS01+120                                               02411000
CVTPTGT  EQU   CVTS01+116                                               02412000
CVTCSPIE EQU   CVTS01+112                                               02413000
CVTSMFEX EQU   CVTS01+108                                               02414000
CVTOLT0A EQU   CVTS01+104                                               02415000
CVTSRBRT EQU   CVTS01+100                                               02416000
CVTPUTL  EQU   CVTS01+96                                                02417000
CVTASCRL EQU   CVTS01+92                                                02418000
CVTASCRF EQU   CVTS01+88                                                02419000
CVTRV326 EQU   CVTS01+84                                                02420000
CVTRV325 EQU   CVTS01+80                                                02421000
CVTRV324 EQU   CVTS01+76                                                02422000
CVT0VL01 EQU   CVTS01+72                                                02423000
CVTSHRVM EQU   CVTS01+68                                                02424000
CVTRV332 EQU   CVTS01+64                                                02425000
CVTTAS   EQU   CVTS01+60                                                02426000
CVTRSCN  EQU   CVTS01+56                                                02427000
CVTTRAC2 EQU   CVTS01+54                                                02428000
CVTTRACE EQU   CVTS01+52                                                02429000
CVTAPG   EQU   CVTS01+51                                                02430000
CVTSDTRC EQU   CVTCTLFG                                                 02431000
CVTGTRCE EQU   CVTCTLFG                                                 02432000
CVTNOMP  EQU   CVTCTLFG                                                 02433000
CVTRSV79 EQU   CVTCTLFG                                                 02434000
CVTDSTAT EQU   CVTCTLFG                                                 02435000
CVTRSV78 EQU   CVTCTLFG                                                 02436000
CVTRV333 EQU   CVTCTLFG                                                 02437000
CVTRV323 EQU   CVTCTLFG                                                 02438000
CVTSPVLK EQU   CVTS01+49                                                02439000
CVTRSV77 EQU   CVTS01+48                                                02440000
CVTRV331 EQU   CVTS01+44                                                02441000
CVTRV330 EQU   CVTS01+40                                                02442000
CVTRV329 EQU   CVTS01+36                                                02443000
CVTRV328 EQU   CVTS01+32                                                02444000
CVTRV322 EQU   CVTS01+28                                                02445000
CVTSLID  EQU   CVTSLIDA+1                                               02446000
CVTSYLK  EQU   CVTSLIDA                                                 02447000
CVTRV321 EQU   CVTS01+20                                                02448000
CVTRV320 EQU   CVTS01+16                                                02449000
CVTLPDIR EQU   CVTLPDIA+1                                               02450000
CVTRSV69 EQU   CVTDIRST                                                 02451000
CVTRSV68 EQU   CVTDIRST                                                 02452000
CVTRSV67 EQU   CVTDIRST                                                 02453000
CVTRSV66 EQU   CVTDIRST                                                 02454000
CVTRSV65 EQU   CVTDIRST                                                 02455000
CVTRSV64 EQU   CVTDIRST                                                 02456000
CVTRSV63 EQU   CVTDIRST                                                 02457000
CVTDICOM EQU   CVTDIRST                                                 02458000
CVTPVTP  EQU   CVTS01+8                                                 02459000
CVTLPDSR EQU   CVTS01+4                                                 02460000
CVTGETL  EQU   CVTS01                                                   02461000
INFOCODE EQU   RETCODE+2                                                02462000
@NM00013 EQU   PROCESSW+1                                               02463000
HSKPDQSW EQU   PROCESSW+1                                               02464000
DISMSGSW EQU   PROCESSW+1                                               02465000
USERERSW EQU   PROCESSW+1                                               02466000
EPALSISW EQU   PROCESSW+1                                               02467000
EPASCTSW EQU   PROCESSW+1                                               02468000
EPAJCTSW EQU   PROCESSW                                                 02469000
FRRPERSW EQU   PROCESSW                                                 02470000
DCBSPCSW EQU   PROCESSW                                                 02471000
UNALOCSW EQU   ERRPROSW                                                 02472000
COPYSW   EQU   PROCESSW                                                 02473000
@NM00012 EQU   PROCESSW                                                 02474000
@NM00011 EQU   INPUTSW+3                                                02475000
PCATINIT EQU   INPUTSW+3                                                02476000
UNITDEVT EQU   INPUTSW+3                                                02477000
MOUNTSW  EQU   INPUTSW+2                                                02478000
CATLOGSW EQU   INPUTSW+2                                                02479000
TIOTNQSW EQU   INPUTSW+2                                                02480000
OFFLINSW EQU   INPUTSW+2                                                02481000
WTUNTSW  EQU   INPUTSW+2                                                02482000
NORESSW  EQU   INPUTSW+2                                                02483000
WTDSNSW  EQU   INPUTSW+2                                                02484000
WTVOLSW  EQU   INPUTSW+2                                                02485000
@NM00010 EQU   INPUTSW                                                  02486000
JOBRLSYS EQU   INPUTSW                                                  02487000
NOMONTSW EQU   INPUTSW                                                  02488000
NOCNVTSW EQU   INPUTSW                                                  02489000
ONCNVTSW EQU   INPUTSW                                                  02490000
JESPJESN EQU   JESCT+28                                                 02491000
JESSSCT  EQU   JESCT+24                                                 02492000
JESRESQM EQU   JESCT+16                                                 02493000
JESQMGR  EQU   JESCT+12                                                 02494000
JESUNITS EQU   JESCT+4                                                  02495000
@NM00035 EQU   JESCT                                                    02496000
CVTLEVL  EQU   CVTRELNO+2                                               02497000
CVTNUMB  EQU   CVTRELNO                                                 02498000
CVTMDL   EQU   CVTFIX+250                                               02499000
@NM00034 EQU   CVTFIX+248                                               02500000
@NM00033 EQU   CVTFIX                                                   02501000
CVTRV482 EQU   CVTXTNT2+128                                             02502000
CVTRV481 EQU   CVTXTNT2+124                                             02503000
CVTRV480 EQU   CVTXTNT2+120                                             02504000
CVTRV479 EQU   CVTXTNT2+118                                             02505000
CVTRV478 EQU   CVTXTNT2+117                                             02506000
CVTRV477 EQU   CVTXTNT2+116                                             02507000
CVTRV476 EQU   CVTXTNT2+115                                             02508000
CVTRV475 EQU   CVTXTNT2+114                                             02509000
CVTRV474 EQU   CVTRV466                                                 02510000
CVTRV473 EQU   CVTRV466                                                 02511000
CVTRV472 EQU   CVTRV466                                                 02512000
CVTRV471 EQU   CVTRV466                                                 02513000
CVTRV470 EQU   CVTRV466                                                 02514000
CVTRV469 EQU   CVTRV466                                                 02515000
CVTRV468 EQU   CVTRV466                                                 02516000
CVTRV467 EQU   CVTRV466                                                 02517000
CVTRV465 EQU   CVTRV457                                                 02518000
CVTRV464 EQU   CVTRV457                                                 02519000
CVTRV463 EQU   CVTRV457                                                 02520000
CVTRV462 EQU   CVTRV457                                                 02521000
CVTRV461 EQU   CVTRV457                                                 02522000
CVTRV460 EQU   CVTRV457                                                 02523000
CVTRV459 EQU   CVTRV457                                                 02524000
CVTRV458 EQU   CVTRV457                                                 02525000
CVTRV456 EQU   CVTXTNT2+108                                             02526000
CVTRV455 EQU   CVTXTNT2+104                                             02527000
CVTRV454 EQU   CVTXTNT2+100                                             02528000
CVTRV453 EQU   CVTXTNT2+96                                              02529000
CVTRV452 EQU   CVTXTNT2+94                                              02530000
CVTRV451 EQU   CVTXTNT2+92                                              02531000
CVTRV450 EQU   CVTXTNT2+90                                              02532000
CVTRV449 EQU   CVTXTNT2+88                                              02533000
CVTRV448 EQU   CVTXTNT2+87                                              02534000
CVTRV447 EQU   CVTXTNT2+86                                              02535000
CVTRV446 EQU   CVTRV438                                                 02536000
CVTRV445 EQU   CVTRV438                                                 02537000
CVTRV444 EQU   CVTRV438                                                 02538000
CVTRV443 EQU   CVTRV438                                                 02539000
CVTRV442 EQU   CVTRV438                                                 02540000
CVTRV441 EQU   CVTRV438                                                 02541000
CVTRV440 EQU   CVTRV438                                                 02542000
CVTRV439 EQU   CVTRV438                                                 02543000
CVTRV437 EQU   CVTRV429                                                 02544000
CVTRV436 EQU   CVTRV429                                                 02545000
CVTRV435 EQU   CVTRV429                                                 02546000
CVTRV434 EQU   CVTRV429                                                 02547000
CVTRV433 EQU   CVTRV429                                                 02548000
CVTRV432 EQU   CVTRV429                                                 02549000
CVTRV431 EQU   CVTRV429                                                 02550000
CVTRV430 EQU   CVTRV429                                                 02551000
CVTRV428 EQU   CVTXTNT2+80                                              02552000
CVTRV427 EQU   CVTXTNT2+76                                              02553000
CVTRV426 EQU   CVTXTNT2+72                                              02554000
CVTRV425 EQU   CVTXTNT2+68                                              02555000
CVTATACT EQU   CVTATCVT                                                 02556000
CVTRV423 EQU   CVTXTNT2+62                                              02557000
CVTRV422 EQU   CVTXTNT2+60                                              02558000
CVTRV421 EQU   CVTXTNT2+58                                              02559000
CVTRV420 EQU   CVTXTNT2+56                                              02560000
CVTRV419 EQU   CVTXTNT2+55                                              02561000
CVTRV418 EQU   CVTXTNT2+54                                              02562000
CVTRV417 EQU   CVTRV409                                                 02563000
CVTRV416 EQU   CVTRV409                                                 02564000
CVTRV415 EQU   CVTRV409                                                 02565000
CVTRV414 EQU   CVTRV409                                                 02566000
CVTRV413 EQU   CVTRV409                                                 02567000
CVTRV412 EQU   CVTRV409                                                 02568000
CVTRV411 EQU   CVTRV409                                                 02569000
CVTRV410 EQU   CVTRV409                                                 02570000
CVTRV408 EQU   CVTRV400                                                 02571000
CVTRV407 EQU   CVTRV400                                                 02572000
CVTRV406 EQU   CVTRV400                                                 02573000
CVTRV405 EQU   CVTRV400                                                 02574000
CVTRV404 EQU   CVTRV400                                                 02575000
CVTRV403 EQU   CVTRV400                                                 02576000
CVTRV402 EQU   CVTRV400                                                 02577000
CVTRV401 EQU   CVTRV400                                                 02578000
CVTICB   EQU   CVTXTNT2+48                                              02579000
CVTSKTA  EQU   CVTXTNT2+44                                              02580000
CVTRSV99 EQU   CVTXTNT2+40                                              02581000
CVTRSV98 EQU   CVTXTNT2+36                                              02582000
CVTRSV97 EQU   CVTXTNT2+34                                              02583000
CVTRSV96 EQU   CVTXTNT2+32                                              02584000
CVTOLTEP EQU   CVTXTNT2+28                                              02585000
CVTQIDA  EQU   CVTQID+1                                                 02586000
CVTRSV95 EQU   CVTQID                                                   02587000
CVTRSV94 EQU   CVTXTNT2+20                                              02588000
CVTRSV93 EQU   CVTXTNT2+16                                              02589000
CVTRSV92 EQU   CVTXTNT2+12                                              02590000
CVTDEBVR EQU   CVTXTNT2+8                                               02591000
CVTRSV91 EQU   CVTXTNT2+6                                               02592000
CVTRSV9H EQU   CVTFLGBT                                                 02593000
CVTRSV9G EQU   CVTFLGBT                                                 02594000
CVTRSV9F EQU   CVTFLGBT                                                 02595000
CVTRSV9E EQU   CVTFLGBT                                                 02596000
CVTRSV9D EQU   CVTFLGBT                                                 02597000
CVTRSV9C EQU   CVTFLGBT                                                 02598000
CVTVME   EQU   CVTFLGBT                                                 02599000
CVTNPE   EQU   CVTFLGBT                                                 02600000
CVTNUCLS EQU   CVTXTNT2+4                                               02601000
CVTDSSVA EQU   CVTDSSV+1                                                02602000
CVTRSV89 EQU   CVTDSSV                                                  02603000
CVTRSV88 EQU   CVTXTNT1+8                                               02604000
CVTRSV87 EQU   CVTXTNT1+4                                               02605000
CVTFACHN EQU   CVTXTNT1                                                 02606000
CVTRV488 EQU   CVTMAP+412                                               02607000
CVTRV487 EQU   CVTMAP+408                                               02608000
CVTRV486 EQU   CVTMAP+404                                               02609000
CVTRV485 EQU   CVTMAP+400                                               02610000
CVTACTAP EQU   CVTMAP+396                                               02611000
CVTAUTH  EQU   CVTMAP+392                                               02612000
CVTATMCA EQU   CVTATMCT+1                                               02613000
CVTATMST EQU   CVTATMCT                                                 02614000
CVTRSV61 EQU   CVTMAP+384                                               02615000
CVTVOLT1 EQU   CVTVOLM1+1                                               02616000
CVTVOLI1 EQU   CVTVOLF1                                                 02617000
CVTSTOA  EQU   CVTMAP+376                                               02618000
CVTRSV58 EQU   CVTMAP+374                                               02619000
CVTRSV57 EQU   CVTMAP+372                                               02620000
CVTDDCE  EQU   CVTMAP+368                                               02621000
CVTPNWFR EQU   CVTMAP+364                                               02622000
CVTSMF   EQU   CVTMAP+360                                               02623000
CVTSULK  EQU   CVTMAP+358                                               02624000
CVTSLKO  EQU   CVTSYSK                                                  02625000
CVTSLKP  EQU   CVTSYSK                                                  02626000
CVTSLKQ  EQU   CVTSYSK                                                  02627000
CVTSLKR  EQU   CVTSYSK                                                  02628000
CVTRSV56 EQU   CVTSYSK                                                  02629000
CVTRSV55 EQU   CVTSYSK                                                  02630000
CVTRSV54 EQU   CVTSYSK                                                  02631000
CVTRSV53 EQU   CVTSYSK                                                  02632000
CVTRSV52 EQU   CVTA1F1                                                  02633000
CVTRSV51 EQU   CVTA1F1                                                  02634000
CVTRSV50 EQU   CVTA1F1                                                  02635000
CVTRSV49 EQU   CVTA1F1                                                  02636000
CVTRSV48 EQU   CVTA1F1                                                  02637000
CVTRSV47 EQU   CVTA1F1                                                  02638000
CVTSRSW  EQU   CVTA1F1                                                  02639000
CVTPFSW  EQU   CVTA1F1                                                  02640000
CVTPCVT  EQU   CVTMAP+352                                               02641000
CVTRSV46 EQU   CVTMAP+344                                               02642000
CVTRSV45 EQU   CVTMAP+340                                               02643000
CVTRSV44 EQU   CVTMAP+338                                               02644000
CVTRSV43 EQU   CVTMAP+336                                               02645000
CVTHJESA EQU   CVTHJES+1                                                02646000
CVTRSV42 EQU   CVTHJES                                                  02647000
CVTEXT2A EQU   CVTEXT2+1                                                02648000
CVTRSV41 EQU   CVTEXT2                                                  02649000
CVTAPFA  EQU   CVTAPF+1                                                 02650000
CVTRSV40 EQU   CVTAPF                                                   02651000
CVTRV518 EQU   CVTINTLA                                                 02652000
CVTRV517 EQU   CVTERPV                                                  02653000
CVTEORM  EQU   CVTMAP+312                                               02654000
CVTMCHPR EQU   CVTMAP+308                                               02655000
CVTTZ    EQU   CVTMAP+304                                               02656000
CVTJEPS  EQU   CVTMAP+300                                               02657000
CVTMODE  EQU   CVTMAP+292                                               02658000
CVTPTRV  EQU   CVTMAP+288                                               02659000
CVTREAL  EQU   CVTMAP+284                                               02660000
CVTRSV39 EQU   CVTMAP+280                                               02661000
CVTRSV38 EQU   CVTMAP+276                                               02662000
CVTDMSRA EQU   CVTDMSR+1                                                02663000
CVTRV634 EQU   CVTDMSRF                                                 02664000
CVTRV633 EQU   CVTDMSRF                                                 02665000
CVTRV632 EQU   CVTDMSRF                                                 02666000
CVTRV631 EQU   CVTDMSRF                                                 02667000
CVTRV630 EQU   CVTDMSRF                                                 02668000
CVTRV629 EQU   CVTDMSRF                                                 02669000
CVTUDUMP EQU   CVTDMSRF                                                 02670000
CVTSDUMP EQU   CVTDMSRF                                                 02671000
CVTQMSGA EQU   CVTQMSG+1                                                02672000
CVTRSV36 EQU   CVTQMSG                                                  02673000
CVTAMFF  EQU   CVTMAP+264                                               02674000
CVTPURGA EQU   CVTPURG+1                                                02675000
CVTRSV35 EQU   CVTPURG                                                  02676000
CVTCBSP  EQU   CVTMAP+256                                               02677000
CVTATERA EQU   CVTATER+1                                                02678000
CVTSYST  EQU   CVTATER                                                  02679000
CVTVOLT2 EQU   CVTTAT                                                   02680000
CVTVOLI2 EQU   CVTVOLF2                                                 02681000
CVTAQAVB EQU   CVTAQAVT+1                                               02682000
CVTRSV34 EQU   CVTTCMFG                                                 02683000
CVTRSV33 EQU   CVTTCMFG                                                 02684000
CVTRSV32 EQU   CVTTCMFG                                                 02685000
CVTRSV31 EQU   CVTTCMFG                                                 02686000
CVTRSV30 EQU   CVTTCMFG                                                 02687000
CVTRSV29 EQU   CVTTCMFG                                                 02688000
CVTRSV28 EQU   CVTTCMFG                                                 02689000
CVTTCRDY EQU   CVTTCMFG                                                 02690000
CVTGTFA  EQU   CVTGTF+1                                                 02691000
CVTRSV27 EQU   CVTGTFST                                                 02692000
CVTRNIO  EQU   CVTGTFST                                                 02693000
CVTUSR   EQU   CVTGTFST                                                 02694000
CVTRV318 EQU   CVTFORM                                                  02695000
CVTRV317 EQU   CVTTMODE                                                 02696000
CVTRV316 EQU   CVTSTATE                                                 02697000
CVTRV315 EQU   CVTGTFS                                                  02698000
CVTGTFAV EQU   CVTGTFS                                                  02699000
CVT0SCR1 EQU   CVTMAP+232                                               02700000
CVTRV515 EQU   CVTMAP+228                                               02701000
CVTRMS   EQU   CVTMAP+224                                               02702000
CVTPATCH EQU   CVTMAP+220                                               02703000
CVTTSCE  EQU   CVTMAP+216                                               02704000
CVTLNKSC EQU   CVTMAP+214                                               02705000
CVTQABST EQU   CVTMAP+212                                               02706000
CVTMDLDS EQU   CVTMAP+208                                               02707000
CVTUSER  EQU   CVTMAP+204                                               02708000
CVTABEND EQU   CVTMAP+200                                               02709000
CVTSMCA  EQU   CVTMAP+196                                               02710000
CVTRSV18 EQU   CVTMAP+192                                               02711000
CVTQLPAQ EQU   CVTMAP+188                                               02712000
CVTQCDSR EQU   CVTMAP+184                                               02713000
CVTRSV17 EQU   CVTOPTB                                                  02714000
CVTRSV16 EQU   CVTOPTB                                                  02715000
CVTFP    EQU   CVTOPTB                                                  02716000
CVTAPTHR EQU   CVTOPTB                                                  02717000
CVTNLOG  EQU   CVTOPTB                                                  02718000
CVTTOD   EQU   CVTOPTB                                                  02719000
CVTCTIMS EQU   CVTOPTB                                                  02720000
CVTPROT  EQU   CVTOPTB                                                  02721000
CVTXPFP  EQU   CVTOPTA                                                  02722000
CVTASCII EQU   CVTOPTA                                                  02723000
CVTRSV13 EQU   CVTOPTA                                                  02724000
CVTRSV12 EQU   CVTOPTA                                                  02725000
CVTNIP   EQU   CVTOPTA                                                  02726000
CVTDDR   EQU   CVTOPTA                                                  02727000
CVTAPR   EQU   CVTOPTA                                                  02728000
CVTCCH   EQU   CVTOPTA                                                  02729000
CVTSNCTR EQU   CVTMAP+180                                               02730000
CVTQMWR  EQU   CVTMAP+176                                               02731000
CVTQOCR  EQU   CVTMAP+172                                               02732000
CVT1EF00 EQU   CVTMAP+168                                               02733000
CVTMZ00  EQU   CVTMAP+164                                               02734000
CVTHEAD  EQU   CVTMAP+160                                               02735000
CVTRSV11 EQU   CVTMAP+156                                               02736000
CVT0PT01 EQU   CVTMAP+152                                               02737000
CVTMSER  EQU   CVTMAP+148                                               02738000
CVTRV516 EQU   CVTIERLC                                                 02739000
CVTILCH  EQU   CVTMAP+140                                               02740000
CVT0DS   EQU   CVTMAP+136                                               02741000
CVTFBOSV EQU   CVTMAP+132                                               02742000
CVTNUCB  EQU   CVTMAP+128                                               02743000
CVTIXAVL EQU   CVTMAP+124                                               02744000
CVTIOQET EQU   CVTMAP+120                                               02745000
CVTDCBA  EQU   CVTMAP+117                                               02746000
CVTMVS2  EQU   CVTDCB                                                   02747000
CVT6DAT  EQU   CVTDCB                                                   02748000
CVT4MPS  EQU   CVTDCB                                                   02749000
CVTRSV09 EQU   CVTDCB                                                   02750000
CVT4MS1  EQU   CVTDCB                                                   02751000
CVT2SPS  EQU   CVTDCB                                                   02752000
CVT1SSS  EQU   CVTDCB                                                   02753000
CVTRSV08 EQU   CVTDCB                                                   02754000
CVTSTB   EQU   CVTMAP+112                                               02755000
CVTQTD00 EQU   CVTMAP+108                                               02756000
CVTQTE00 EQU   CVTMAP+104                                               02757000
CVTCUCB  EQU   CVTMAP+100                                               02758000
CVTSJQ   EQU   CVTMAP+96                                                02759000
CVTPBLDL EQU   CVTMAP+92                                                02760000
CVTTPC   EQU   CVTMAP+88                                                02761000
CVTSVDCB EQU   CVTMAP+84                                                02762000
CVTBRET  EQU   CVTMAP+82                                                02763000
CVTEXIT  EQU   CVTMAP+80                                                02764000
CVT0FN00 EQU   CVTMAP+76                                                02765000
CVTDARA  EQU   CVTDAR+1                                                 02766000
CVTRSV07 EQU   CVTFLGS1                                                 02767000
CVTRSV06 EQU   CVTFLGS1                                                 02768000
CVTRSV05 EQU   CVTFLGS1                                                 02769000
CVTRSV04 EQU   CVTFLGS1                                                 02770000
CVTRSV03 EQU   CVTFLGS1                                                 02771000
CVTRSV02 EQU   CVTFLGS1                                                 02772000
CVTRSV01 EQU   CVTFLGS1                                                 02773000
CVTDMPLK EQU   CVTFLGS1                                                 02774000
CVTXITP  EQU   CVTMAP+68                                                02775000
CVTZDTAB EQU   CVTMAP+64                                                02776000
CVTMSLT  EQU   CVTMAP+60                                                02777000
CVTDATE  EQU   CVTMAP+56                                                02778000
CVTBTERM EQU   CVTMAP+52                                                02779000
CVTSYSAD EQU   CVTMAP+48                                                02780000
CVTXTLER EQU   CVTMAP+44                                                02781000
CVTILK2  EQU   CVTMAP+40                                                02782000
CVTILK1  EQU   CVTMAP+36                                                02783000
CVTPRLTV EQU   CVTMAP+32                                                02784000
CVTPCNVT EQU   CVTMAP+28                                                02785000
CVT0VL00 EQU   CVTMAP+24                                                02786000
CVTXAPG  EQU   CVTMAP+20                                                02787000
CVTBUF   EQU   CVTMAP+16                                                02788000
CVTJOB   EQU   CVTMAP+12                                                02789000
CVTLINK  EQU   CVTMAP+8                                                 02790000
CVT0EF00 EQU   CVTMAP+4                                                 02791000
CVTTCBP  EQU   CVTMAP                                                   02792000
CVT      EQU   CVTMAP                                                   02793000
ACTACCNT EQU   IEFAACTB+32                                              02794000
ACTJNFLD EQU   IEFAACTB+31                                              02795000
ACTJTIME EQU   IEFAACTB+28                                              02796000
ACTPRGNM EQU   IEFAACTB+8                                               02797000
@NM00031 EQU   IEFAACTB+7                                               02798000
ACTNEXT  EQU   IEFAACTB+4                                               02799000
ACTIDENT EQU   IEFAACTB+3                                               02800000
ACTDSKAD EQU   IEFAACTB                                                 02801000
@NM00030 EQU   INJMJCT+175                                              02802000
JCTVULDP EQU   INJMJCT+172                                              02803000
JCTACODE EQU   INJMJCT+168                                              02804000
JCTPRFMF EQU   INJMJCT+167                                              02805000
JCTUSER  EQU   INJMJCT+160                                              02806000
JCTSSD   EQU   INJMJCT+157                                              02807000
@NM00029 EQU   INJMJCT+156                                              02808000
JCTSRBT  EQU   INJMJCT+152                                              02809000
JCTJMRJD EQU   INJMJCT+149                                              02810000
JCTJMRJT EQU   INJMJCT+146                                              02811000
JCTJMRSS EQU   INJMJCT+143                                              02812000
JCTJMRTL EQU   INJMJCT+140                                              02813000
JCTJMRCL EQU   INJMJCT+139                                              02814000
JCTJMROP EQU   INJMJCT+138                                              02815000
JCTJMRD  EQU   INJMJCT+137                                              02816000
JCTJMR   EQU   INJMJCT+134                                              02817000
JCTCKIDT EQU   INJMJCT+118                                              02818000
JCTCKIDL EQU   INJMJCT+117                                              02819000
@NM00028 EQU   JCTSTAT2                                                 02820000
JCTBLP   EQU   JCTSTAT2                                                 02821000
JCTPERFM EQU   JCTSTAT2                                                 02822000
JCTSWSM  EQU   JCTSTAT2                                                 02823000
JCTENDIT EQU   JCTSTAT2                                                 02824000
JCTADSPC EQU   JCTSTAT2                                                 02825000
JCTSPSYS EQU   JCTSTAT2                                                 02826000
@NM00027 EQU   INJMJCT+115                                              02827000
JCTSSTR  EQU   INJMJCT+112                                              02828000
JCTJSBTM EQU   JCTJSB                                                   02829000
JCTJSBEX EQU   JCTJSB                                                   02830000
JCTJSBAL EQU   JCTJSB                                                   02831000
JCTJSBIN EQU   JCTJSB                                                   02832000
@NM00026 EQU   JCTJSB                                                   02833000
JCTVOLSQ EQU   INJMJCT+110                                              02834000
JCTNRCKP EQU   INJMJCT+108                                              02835000
JCTNTRK  EQU   INJMJCT+107                                              02836000
JCTCKTTR EQU   INJMJCT+104                                              02837000
JCTDEVT  EQU   INJMJCT+100                                              02838000
@NM00025 EQU   INJMJCT+99                                               02839000
JCTSTIOT EQU   INJMJCT+96                                               02840000
JCTSNUMB EQU   INJMJCT+95                                               02841000
JCTQIDNT EQU   INJMJCT+94                                               02842000
JCTEQREG EQU   INJMJCT+92                                               02843000
@NM00024 EQU   INJMJCT+91                                               02844000
JCTDSDRA EQU   JCTRSW2                                                  02845000
JCTDSOJB EQU   JCTRSW2                                                  02846000
JCTDSOCR EQU   JCTRSW2                                                  02847000
JCTRESTT EQU   JCTRSW2                                                  02848000
JCTNOCKP EQU   JCTRSW2                                                  02849000
JCTNORST EQU   JCTRSW2                                                  02850000
JCTNARST EQU   JCTRSW2                                                  02851000
JCTSYSCK EQU   JCTRSW2                                                  02852000
@NM00023 EQU   JCTRSW1                                                  02853000
JCTSTEPR EQU   JCTRSW1                                                  02854000
JCTCKPTR EQU   JCTRSW1                                                  02855000
JCTCKFT  EQU   JCTRSW1                                                  02856000
JCTCONTR EQU   JCTRSW1                                                  02857000
JCTSTERM EQU   JCTRSW1                                                  02858000
JCTWARMS EQU   JCTRSW1                                                  02859000
@NM00022 EQU   JCTCCODE+3                                               02860000
JCTJDPOP EQU   JCTCCODE+2                                               02861000
JCTJDPCD EQU   JCTCCODE                                                 02862000
@NM00021 EQU   INJMJCT+53                                               02863000
JCTSCT   EQU   INJMJCT+52                                               02864000
JCTSMRBA EQU   INJMJCT+44                                               02865000
@NM00020 EQU   INJMJCT+43                                               02866000
JCTACTAD EQU   INJMJCT+40                                               02867000
@NM00019 EQU   INJMJCT+39                                               02868000
JCTJCTX  EQU   INJMJCT+36                                               02869000
@NM00018 EQU   INJMJCT+35                                               02870000
JCTSDKAD EQU   INJMJCT+32                                               02871000
JCTJCSMF EQU   INJMJCT+31                                               02872000
JCTGDGNT EQU   INJMJCT+28                                               02873000
@NM00017 EQU   INJMJCT+27                                               02874000
JCTPDIP  EQU   INJMJCT+24                                               02875000
JCTJTPTN EQU   INJMJCT+16                                               02876000
JCTJNAME EQU   INJMJCT+8                                                02877000
JCTJPRTY EQU   JCTJBYTE                                                 02878000
INCMMGL1 EQU   JCTJMGLV                                                 02879000
INCMMGL2 EQU   JCTJMGLV                                                 02880000
@NM00016 EQU   JCTJMGLV                                                 02881000
INCMALL  EQU   JCTJMGLV                                                 02882000
JCTJMGPO EQU   INJMJCT+6                                                02883000
INCMNSET EQU   JCTJSTAT                                                 02884000
INCMCAT  EQU   INDMCTLG                                                 02885000
INCMSTS  EQU   JCTJSTAT                                                 02886000
JCTABEND EQU   JCTJSTAT                                                 02887000
@NM00015 EQU   JCTJSTAT                                                 02888000
JCTJSTPC EQU   JCTJSTAT                                                 02889000
@NM00014 EQU   JCTJSTAT                                                 02890000
JCTJBLBS EQU   JCTJSTAT                                                 02891000
JCTJSRNO EQU   INJMJCT+4                                                02892000
DSNQRS02 EQU   DSNQFLG1                                                 02893000
DSNQRS01 EQU   DSNQTABL+7                                               02894000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02895000
@RF00128 EQU   @RC00067                                                 02896000
@RF00186 EQU   @RC00182                                                 02897000
@RC00289 EQU   @RC00273                                                 02898000
@RC00297 EQU   @RC00296                                                 02899000
@RF00425 EQU   @RC00423                                                 02900000
@ENDDATA EQU   *                                                        02901000
         END   IEFAB4DC,(C'PLS1919',0701,76274)                         02902000
