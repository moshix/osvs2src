         TITLE 'IEFAB4EF - PCCB ROUTINE                                *00001000
                        '                                               00002000
IEFAB4EF CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'IEFAB4EF  74.361'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  DS    0H                                               01S0001 00012000
         USING @PSTART,@12                                      01S0001 00013000
         L     @00,@SIZDATD                                     01S0001 00014000
         MODESET EXTKEY=SCHED,SAVEKEY=(2)                               00015000
         GSPACE   R,LV=(0)                                              00016000
         LR    @11,@01                                          01S0001 00017000
         USING @DATD,@11                                        01S0001 00018000
         ST    @13,@SA00001+4                                   01S0001 00019000
         STC   @02,@OLDKEY                                      01S0001 00020000
         MODESET KEYADDR=(2)                                            00021000
         LM    @00,@02,20(@13)                                  01S0001 00022000
         ST    @11,8(,@13)                                      01S0001 00023000
         LR    @13,@11                                          01S0001 00024000
         MODESET EXTKEY=ZERO                                            00025000
         MVC   @PC00001(36),0(@01)                              01S0001 00026000
         MODESET EXTKEY=SCHED                                           00027000
JSCBDISP EQU 188                                                        00028000
JSCBAOS1 EQU  72                                                        00029000
*                                                               01S0021 00030000
JSCBAOS2 EQU 192                                                        00031000
*   /*****************************************************************/ 00032000
*   /*                                                               */ 00033000
*   /* END OF JSCB                                                   */ 00034000
*   /*                                                               */ 00035000
*   /*****************************************************************/ 00036000
*                                                               01S0022 00037000
*   NQCORE(1:NQLENGTH)=PCNQLIST(1:NQLENGTH);/* ENQ LIST TO DSECT     */ 00038000
         L     @10,NQLENGTH                                     01S0022 00039000
         BCTR  @10,0                                            01S0022 00040000
         EX    @10,@SM00290                                     01S0022 00041000
*   GEN REFS(NQCORE);                                           01S0023 00042000
*                                                               01S0023 00043000
*                                  /* EXCLUSIVE ENQ ON PCCB CHAIN   */  00044000
         ENQ MF=(E,NQCORE)                                              00045000
*/* A 019200-019410,020200,038550,040100-040400,             @ZA00870*/ 00046000
*/*   086505-086510,099050-100360,100618-100718,105879-116405@ZA00870*/ 00047000
*/*   123100-123200,129200-129300                            @ZA00870*/ 00048000
*/* D 105879-116310,100373,100377,099100-100310,116720       @ZA00870*/ 00049000
*/* C 038500,040000                                          @ZA00870*/ 00050000
*                                                               01S0024 00051000
*   PCCBPTR=JSCBPCC;                /* ACTIVE JSCB'S PCCB CHAIN      */ 00052000
         L     @10,@PC00001+8                                   01S0024 00053000
         L     @10,JSCBPTR(,@10)                                01S0024 00054000
         L     PCCBPTR,JSCBPCC(,@10)                            01S0024 00055000
*   LCLRTN=0;                       /* INITIALIZE LOCAL RTN AREA     */ 00056000
         SLR   @08,@08                                          01S0025 00057000
         ST    @08,LCLRTN                                       01S0025 00058000
*   CREATNEW=OFF;                   /* LOOP CONTROL                  */ 00059000
         NI    CREATNEW,B'01111111'                             01S0026 00060000
*   LENTH=LENGTH(IEFPCCB);          /* LENGTH OF A PCCB              */ 00061000
         MVC   LENTH(3),@CF00289+1                              01S0027 00062000
*   SBPOOL=JSCBSWSP;                /* SWA SUBPOOL FOR PCCBS         */ 00063000
         MVC   SBPOOL(1),JSCBSWSP(@10)                          01S0028 00064000
*   IF PCCFREAL=ON THEN             /* FREE ALL PCCBS REQUEST        */ 00065000
         L     @10,@PC00001                                     01S0029 00066000
         TM    PCCFREAL(@10),B'00010000'                        01S0029 00067000
         BNO   @RF00029                                         01S0029 00068000
*     DO;                                                       01S0030 00069000
*       DO WHILE(PCCBPTR^=0);                                   01S0031 00070000
         B     @DE00031                                         01S0031 00071000
@DL00031 DS    0H                                               01S0032 00072000
*         LENREG=SPLEN;             /* SUBPOOL AND LENGTH OF PCCB    */ 00073000
         L     LENREG,SPLEN                                     01S0032 00074000
*         ADDREG=PCCBPTR;           /* ADDRESS OF PCCB TO FREE       */ 00075000
         LR    ADDREG,PCCBPTR                                   01S0033 00076000
*         PCCBPTR=PCCNEXTP;         /* LOCATE NEXT PCCB IF ANY       */ 00077000
         L     PCCBPTR,PCCNEXTP(,PCCBPTR)                       01S0034 00078000
*         GEN(FREEMAIN R,LV=(LENREG),A=(ADDREG));/* FREE A PCCB      */ 00079000
         FREEMAIN R,LV=(LENREG),A=(ADDREG)                              00080000
*       END;                                                    01S0036 00081000
@DE00031 SLR   @10,@10                                          01S0036 00082000
         CR    PCCBPTR,@10                                      01S0036 00083000
         BNE   @DL00031                                         01S0036 00084000
*       DO;                         /* MODESET KEYADDR(0)            */ 00085000
*         SPKA(0);                  /* SET PSW KEY                   */ 00086000
         SPKA  0(@10)                                           01S0038 00087000
*       END;                        /* MODESET KEYADDR(0) KEY 0 TO      00088000
*                                      ALTER JSCB                    */ 00089000
*       JSCBPCC=0;                  /* NO PCCBS CHAINED TO JSCB      */ 00090000
         L     @08,@PC00001+8                                   01S0040 00091000
         L     @08,JSCBPTR(,@08)                                01S0040 00092000
         ST    @10,JSCBPCC(,@08)                                01S0040 00093000
*       DO;                         /* MODESET EXTKEY(SCHED)         */ 00094000
*         SPKA(16);                 /* SET PSW KEY                   */ 00095000
         LA    @10,16                                           01S0042 00096000
         SPKA  0(@10)                                           01S0042 00097000
*       END;                        /* MODESET EXTKEY(SCHED) BACK TO    00098000
*                                      KEY 1                         */ 00099000
*     END;                                                      01S0044 00100000
*   IF PCCMAKE=ON THEN              /* ATTEMPT OLD PCCB LOCATE       */ 00101000
@RF00029 L     @10,@PC00001                                     01S0045 00102000
         TM    PCCMAKE(@10),B'10000000'                         01S0045 00103000
         BNO   @RF00045                                         01S0045 00104000
*     DO;                           /* LOCATE/CREATE PCCB            */ 00105000
*                                                               02S0047 00106000
*/********************************************************************/ 00107000
*/* SEGMENT NAME - FINDPCCB                                          */ 00108000
*/*                                                                  */ 00109000
*/* DESCRIPTIVE NAME - PCCB LOCATE/CREATE                            */ 00110000
*/*                                                                  */ 00111000
*/* FUNCTION - RETURN A POINTER TO PCCB FOUND/CREATED,CHAINED        */ 00112000
*/*                                                                  */ 00113000
*/*  OPERATION - THE FIRST PCCB POINTER BEING ZERO CAUSES CREATION OF*/ 00114000
*/*              A PCCB. OTHERWISE, THE PCCB CHAIN IS SEARCHED FOR A */ 00115000
*/*              MATCH OF THE DSNAME IN THE PCCB AND THE ONE PASSED  */ 00116000
*/*              INTO THE MODULE:                                    */ 00117000
*/*                 MATCH:INCLUDE 'CHEKPCCB' FOR FURTHER PROCESSING, */ 00118000
*/*                       IF NOT A STEPCAT REQUEST.          @ZA00870*/ 00119000
*/*                                                                  */ 00120000
*/*                 NO MATCH:  CREATE AND CHAIN NEW PCCB WITH REASON */ 00121000
*/*                            CODE OF 0 (NEW PCCB, UNIQUE DSNAME).  */ 00122000
*/*                                                                  */ 00123000
*/*              A GETMAIN ERROR CAUSES RETURN TO CALLER WITH RETURN */ 00124000
*/*              AND REASON CODES.                                   */ 00125000
*/*                                                                  */ 00126000
*/*              INITIALIZE FIELDS IN THE CREATED PCCB.              */ 00127000
*/*                                                                  */ 00128000
*/* ENTRY - IF 'MAKE PCCB' IS SPECIFIED BY THE CALLER.               */ 00129000
*/*                                                                  */ 00130000
*/*   PURPOSE - FIND/CREATE PCCB                                     */ 00131000
*/*                                                                  */ 00132000
*/*   INPUT DATA - FIRST PCCB POINTER ( FROM ACTIVE JSCB), AND       */ 00133000
*/*                OTHER DATA INPUT TO THE MODULE.                   */ 00134000
*/*                                                                  */ 00135000
*/* EXIT - IN LINE                                                   */ 00136000
*/*                                                                  */ 00137000
*/*   CONDITION - FOUND/CREATED PCCB                                 */ 00138000
*/*                                                                  */ 00139000
*/*   OUTPUT DATA - PCCB POINTER, REASON CODE 0 - SUCCESS            */ 00140000
*/*                 REASON CODE 2 - ?GETSTORG ROUTINE FAILURE.       */ 00141000
*/*                 REASON CODE 4 - 'MAKEPCCB' REQUEST FOR A @ZA00870*/ 00142000
*/*                                 STEPCAT AND A PCCB       @ZA00870*/ 00143000
*/*                                 ALREADY EXISTS FOR THE   @ZA00870*/ 00144000
*/*                                 CATALOG.                 @ZA00870*/ 00145000
*/*                                                                  */ 00146000
*/*   RETURN CODE - 0 SUCCESS                                        */ 00147000
*/*                 4 STEPCAT ERROR                          @ZA00870*/ 00148000
*/*                 8 ?GETSTORG FAILURE                              */ 00149000
*/********************************************************************/ 00150000
*                                                               02S0047 00151000
*       ACBPTR=ACBP;                /* LOCAL COPY OF PARAMETERS      */ 00152000
         L     @10,@PC00001+20                                  02S0047 00153000
         L     @10,ACBP(,@10)                                   02S0047 00154000
         ST    @10,ACBPTR                                       02S0047 00155000
*       NEEDPCCB=OFF;               /* ASSUME NO PCCB NEEDED@ZA00870 */ 00156000
         NI    NEEDPCCB,B'01111111'                             02S0048 00157000
*       ALIAS=OFF;                  /* ASSUME NOT ALIAS      @ZA00870*/ 00158000
         NI    ALIAS,B'01111111'                                02S0049 00159000
*       IF DDNAMEP^=0 THEN          /* IF A DDNAME WAS PASSED,       */ 00160000
         L     @10,@PC00001+24                                  02S0050 00161000
         L     @10,DDNAMEP(,@10)                                02S0050 00162000
         LTR   @10,@10                                          02S0050 00163000
         BZ    @RF00050                                         02S0050 00164000
*         DDNAME=DDNAM;             /* COPY THE DD NAME              */ 00165000
         MVC   DDNAME(8),DDNAM(@10)                             02S0051 00166000
*       ELSE                        /* DDNAME NOT PASSED             */ 00167000
*         DDNAME=DDNAME&&DDNAME;    /* CLEAR LOCAL COPY              */ 00168000
         B     @RC00050                                         02S0052 00169000
@RF00050 XC    DDNAME(8),DDNAME                                 02S0052 00170000
*       IF VSERPTR^=0 THEN          /* COPY VOLUME SERIAL IF PASSED  */ 00171000
@RC00050 L     @10,@PC00001+32                                  02S0053 00172000
         L     @10,VSERPTR(,@10)                                02S0053 00173000
         LTR   @10,@10                                          02S0053 00174000
         BZ    @RF00053                                         02S0053 00175000
*         VSERCOPY=VSERPARM;        /* FOR CVOL PROCESSING           */ 00176000
         MVC   VSERCOPY(6),VSERPARM(@10)                        02S0054 00177000
*       ELSE                        /* OR, IF NOT PASSED, CLEAR      */ 00178000
*         VSERCOPY=VSERCOPY&&VSERCOPY;/* LOCAL COPY AREA             */ 00179000
         B     @RC00053                                         02S0055 00180000
@RF00053 XC    VSERCOPY(6),VSERCOPY                             02S0055 00181000
*       IF PCCBPTR=0 THEN           /* CREATE FIRST PCCB USING THE   */ 00182000
@RC00053 LTR   PCCBPTR,PCCBPTR                                  02S0056 00183000
         BNZ   @RF00056                                         02S0056 00184000
*         DO;                       /* ?GETSTORG MACRO               */ 00185000
*                                                               02S0057 00186000
*           /*********************************************************/ 00187000
*           /*                                                       */ 00188000
*           /* ?GETSTORG (JSCBSWSP,LENGTH(IEFPCCB),NXPCTEMP);        */ 00189000
*           /*                                                       */ 00190000
*           /*********************************************************/ 00191000
*                                                               02S0058 00192000
*                                                               02S0058 00193000
*           /*********************************************************/ 00194000
*           /*                                                       */ 00195000
*           /* DEFINITIONS OF GETMAIN PARMS                          */ 00196000
*           /*                                                       */ 00197000
*           /*********************************************************/ 00198000
*                                                               02S0058 00199000
*           DCL                                                 02S0058 00200000
*             GTSTR0 FIXED(31) REG(0),/* GTMN PARM REG               */ 00201000
*             GTSTR1 FIXED(31) REG(1),/* GTMN PARM REG               */ 00202000
*             GTSTR2 PTR(31) REG(2),/* GTMN PARM REG                 */ 00203000
*             GTSTR15 FIXED(31) REG(15),/* GTMN RET COD              */ 00204000
*             GTSTRTCD FIXED(31);   /* GETMAIN RTN CODE              */ 00205000
*           DCL                                                 02S0059 00206000
*             GTSTR3 FIXED(31) REG(3),/* CLEARING REG                */ 00207000
*             GTSTR4 FIXED(31) REG(4),/* CLEARING REG                */ 00208000
*             GTSTR5 FIXED(31) REG(5),/* CLEARING REG                */ 00209000
*             GTSTR6 FIXED(31) REG(6),/* CLEARING REG                */ 00210000
*             GTSTR7 FIXED(31) REG(7),/* CLEARING REG                */ 00211000
*             GTSTR8 FIXED(31) REG(8),/* CLEARING REG                */ 00212000
*             GTSTZERO FIXED(31) INIT(0),                       02S0059 00213000
*             GTST253 FIXED(31) CONSTANT(253);                  02S0059 00214000
*           RFY                                                 02S0060 00215000
*            (GTSTR0,                                           02S0060 00216000
*             GTSTR1,                                           02S0060 00217000
*             GTSTR2) RSTD;         /* SAVE RGS                      */ 00218000
*           GTSTR0=LENGTH(IEFPCCB); /* SET AMOUNT                    */ 00219000
         LA    GTSTR0,176                                       02S0061 00220000
*           GTSTR2=JSCBSWSP;        /* SET SUBPOOL                   */ 00221000
         L     @08,@PC00001+8                                   02S0062 00222000
         L     @08,JSCBPTR(,@08)                                02S0062 00223000
         SLR   GTSTR2,GTSTR2                                    02S0062 00224000
         IC    GTSTR2,JSCBSWSP(,@08)                            02S0062 00225000
*           GENERATE CODE;                                      02S0063 00226000
             GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN                       00227000
*           GTSTRTCD=GTSTR15;       /* SAVE GETMAIN RET COD          */ 00228000
         LR    GTSTRTCD,GTSTR15                                 02S0064 00229000
*           NXPCTEMP=GTSTR1;        /* ADDR OF GOTN STORG            */ 00230000
         ST    GTSTR1,NXPCTEMP                                  02S0065 00231000
*           RFY                                                 02S0066 00232000
*            (GTSTR0,                                           02S0066 00233000
*             GTSTR1,                                           02S0066 00234000
*             GTSTR2) UNRSTD;       /* RLSE                          */ 00235000
*           IF GTSTRTCD=0 THEN      /* GETMAIN SUCCESSFUL?           */ 00236000
         LTR   GTSTRTCD,GTSTRTCD                                02S0067 00237000
         BNZ   @RF00067                                         02S0067 00238000
*             DO;                   /* YES, CLEAR STORAGE.           */ 00239000
*               RFY                                             02S0069 00240000
*                (GTSTR2,                                       02S0069 00241000
*                 GTSTR4,                                       02S0069 00242000
*                 GTSTR5,                                       02S0069 00243000
*                 GTSTR6,                                       02S0069 00244000
*                 GTSTR7,                                       02S0069 00245000
*                 GTSTR8) RSTD;                                 02S0069 00246000
*               GTSTR4=NXPCTEMP;    /* STORG PTR                     */ 00247000
         L     @03,NXPCTEMP                                     02S0070 00248000
         LR    GTSTR4,@03                                       02S0070 00249000
*               GTSTR5=LENGTH(IEFPCCB);/* STORG AMNT                 */ 00250000
         LA    GTSTR5,176                                       02S0071 00251000
*               GTSTR7='00000000'X; /* PAD CHAR & LNTH               */ 00252000
         SLR   GTSTR7,GTSTR7                                    02S0072 00253000
*               IF JSCBSWSP=GTST253 THEN                        02S0073 00254000
         L     @03,@PC00001+8                                   02S0073 00255000
         L     @03,JSCBPTR(,@03)                                02S0073 00256000
         CLI   JSCBSWSP(@03),253                                02S0073 00257000
         BNE   @RF00073                                         02S0073 00258000
*                 GEN(MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);  00259000
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8                 00260000
*               GEN REFS(GTSTR4,GTSTR6);                        02S0075 00261000
@RF00073 DS    0H                                               02S0075 00262000
                  MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG                00263000
*               IF JSCBSWSP=GTST253 THEN                        02S0076 00264000
         L     @03,@PC00001+8                                   02S0076 00265000
         L     @03,JSCBPTR(,@03)                                02S0076 00266000
         CLI   JSCBSWSP(@03),253                                02S0076 00267000
         BNE   @RF00076                                         02S0076 00268000
*                 GEN(MODESET KEYADDR=(2));                     02S0077 00269000
         MODESET KEYADDR=(2)                                            00270000
*               RFY                                             02S0078 00271000
*                (GTSTR2,                                       02S0078 00272000
*                 GTSTR4,                                       02S0078 00273000
*                 GTSTR5,                                       02S0078 00274000
*                 GTSTR6,                                       02S0078 00275000
*                 GTSTR7,                                       02S0078 00276000
*                 GTSTR8) UNRSTD;                               02S0078 00277000
@RF00076 DS    0H                                               02S0079 00278000
*             END;                  /* STORAGE CLEARING COMPLETED    */ 00279000
*           ELSE                                                02S0080 00280000
*             NXPCTEMP=0;           /* CLEAR RETURN ADDR.            */ 00281000
         B     @RC00067                                         02S0080 00282000
@RF00067 SLR   @08,@08                                          02S0080 00283000
         ST    @08,NXPCTEMP                                     02S0080 00284000
*           GTSTR15=GTSTRTCD;       /* GTMN RETURN CODE              */ 00285000
@RC00067 LR    GTSTR15,GTSTRTCD                                 02S0081 00286000
*                                   /* RESTORE LIST PRINT STATUS     */ 00287000
*           IF RTCDREG=0 THEN       /* MAP PCCB IF RETURN OK         */ 00288000
         SLR   @14,@14                                          02S0082 00289000
         CR    RTCDREG,@14                                      02S0082 00290000
         BNE   @RF00082                                         02S0082 00291000
*             DO;                                               02S0083 00292000
*               PCCBPTR=NXPCTEMP;                               02S0084 00293000
         L     PCCBPTR,NXPCTEMP                                 02S0084 00294000
*               DO;                 /* MODESET KEYADDR(0)            */ 00295000
*                 SPKA(0);          /* SET PSW KEY                   */ 00296000
         SPKA  0(@14)                                           02S0086 00297000
*               END;                /* MODESET KEYADDR(0) KEY 0 TO      00298000
*                                      ALTER JSCB                    */ 00299000
*               JSCBPCC=PCCBPTR;    /* FIRST PCCB POINTER IN JSCB    */ 00300000
         L     @10,@PC00001+8                                   02S0088 00301000
         L     @10,JSCBPTR(,@10)                                02S0088 00302000
         ST    PCCBPTR,JSCBPCC(,@10)                            02S0088 00303000
*               DO;                 /* MODESET EXTKEY(SCHED)         */ 00304000
*                 SPKA(16);         /* SET PSW KEY                   */ 00305000
         LA    @10,16                                           02S0090 00306000
         SPKA  0(@10)                                           02S0090 00307000
*               END;                /* MODESET EXTKEY(SCHED) BACK TO    00308000
*                                      KEY 1                         */ 00309000
*             END;                                              02S0092 00310000
*           ELSE                    /* ERROR FROM ?GETSTORG          */ 00311000
*             RTCD=GETERROR;        /* RETURN CODE - 8               */ 00312000
         B     @RC00082                                         02S0093 00313000
@RF00082 MVC   RTCD(2),@CH00058                                 02S0093 00314000
*           CREATNEW=ON;            /* PROCESSING CONTROL            */ 00315000
@RC00082 OI    CREATNEW,B'10000000'                             02S0094 00316000
*         END;                                                  02S0095 00317000
*       ELSE                        /* SEARCH THE PCCB CHAIN FOR     */ 00318000
*         DO WHILE(PCCDSNAM^=CTGDSN&/* DSNAME MATCH OR CHAIN-END     */ 00319000
*               CREATNEW=OFF);                                  02S0096 00320000
         B     @RC00056                                         02S0096 00321000
@RF00056 B     @DE00096                                         02S0096 00322000
@DL00096 DS    0H                                               02S0097 00323000
*           IF PCCNEXTP=0 THEN      /* LAST PCCB IN CHAIN. CREATE    */ 00324000
         L     @10,PCCNEXTP(,PCCBPTR)                           02S0097 00325000
         LTR   @10,@10                                          02S0097 00326000
         BNZ   @RF00097                                         02S0097 00327000
*             DO;                   /* AND CHAIN A NEW PCCB          */ 00328000
*                                                               02S0098 00329000
*               /*****************************************************/ 00330000
*               /*                                                   */ 00331000
*               /* ?GETSTORG (JSCBSWSP,LENGTH(IEFPCCB),PCCNEXTP);    */ 00332000
*               /*                                                   */ 00333000
*               /*****************************************************/ 00334000
*                                                               02S0099 00335000
*               RFY                                             02S0099 00336000
*                (GTSTR0,                                       02S0099 00337000
*                 GTSTR1,                                       02S0099 00338000
*                 GTSTR2) RSTD;     /* SAVE RGS                      */ 00339000
*               GTSTR0=LENGTH(IEFPCCB);/* SET AMOUNT                 */ 00340000
         LA    GTSTR0,176                                       02S0100 00341000
*               GTSTR2=JSCBSWSP;    /* SET SUBPOOL                   */ 00342000
         L     @08,@PC00001+8                                   02S0101 00343000
         L     @08,JSCBPTR(,@08)                                02S0101 00344000
         SLR   GTSTR2,GTSTR2                                    02S0101 00345000
         IC    GTSTR2,JSCBSWSP(,@08)                            02S0101 00346000
*               GENERATE CODE;                                  02S0102 00347000
                   GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN                 00348000
*               GTSTRTCD=GTSTR15;   /* SAVE GETMAIN RET COD          */ 00349000
         LR    GTSTRTCD,GTSTR15                                 02S0103 00350000
*               PCCNEXTP=GTSTR1;    /* ADDR OF GOTN STORG            */ 00351000
         ST    GTSTR1,PCCNEXTP(,PCCBPTR)                        02S0104 00352000
*               RFY                                             02S0105 00353000
*                (GTSTR0,                                       02S0105 00354000
*                 GTSTR1,                                       02S0105 00355000
*                 GTSTR2) UNRSTD;   /* RLSE                          */ 00356000
*               IF GTSTRTCD=0 THEN  /* GETMAIN SUCCESSFUL?           */ 00357000
         LTR   GTSTRTCD,GTSTRTCD                                02S0106 00358000
         BNZ   @RF00106                                         02S0106 00359000
*                 DO;               /* YES, CLEAR STORAGE.           */ 00360000
*                   RFY                                         02S0108 00361000
*                    (GTSTR2,                                   02S0108 00362000
*                     GTSTR4,                                   02S0108 00363000
*                     GTSTR5,                                   02S0108 00364000
*                     GTSTR6,                                   02S0108 00365000
*                     GTSTR7,                                   02S0108 00366000
*                     GTSTR8) RSTD;                             02S0108 00367000
*                   GTSTR4=PCCNEXTP;/* STORG PTR                     */ 00368000
         L     @03,PCCNEXTP(,PCCBPTR)                           02S0109 00369000
         LR    GTSTR4,@03                                       02S0109 00370000
*                   GTSTR5=LENGTH(IEFPCCB);/* STORG AMNT             */ 00371000
         LA    GTSTR5,176                                       02S0110 00372000
*                   GTSTR7='00000000'X;/* PAD CHAR & LNTH            */ 00373000
         SLR   GTSTR7,GTSTR7                                    02S0111 00374000
*                   IF JSCBSWSP=GTST253 THEN                    02S0112 00375000
         L     @03,@PC00001+8                                   02S0112 00376000
         L     @03,JSCBPTR(,@03)                                02S0112 00377000
         CLI   JSCBSWSP(@03),253                                02S0112 00378000
         BNE   @RF00112                                         02S0112 00379000
*                     GEN                                       02S0113 00380000
*(MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);              02S0113 00381000
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8                 00382000
*                   GEN REFS(GTSTR4,GTSTR6);                    02S0114 00383000
@RF00112 DS    0H                                               02S0114 00384000
                        MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG          00385000
*                   IF JSCBSWSP=GTST253 THEN                    02S0115 00386000
         L     @03,@PC00001+8                                   02S0115 00387000
         L     @03,JSCBPTR(,@03)                                02S0115 00388000
         CLI   JSCBSWSP(@03),253                                02S0115 00389000
         BNE   @RF00115                                         02S0115 00390000
*                     GEN(MODESET KEYADDR=(2));                 02S0116 00391000
         MODESET KEYADDR=(2)                                            00392000
*                   RFY                                         02S0117 00393000
*                    (GTSTR2,                                   02S0117 00394000
*                     GTSTR4,                                   02S0117 00395000
*                     GTSTR5,                                   02S0117 00396000
*                     GTSTR6,                                   02S0117 00397000
*                     GTSTR7,                                   02S0117 00398000
*                     GTSTR8) UNRSTD;                           02S0117 00399000
@RF00115 DS    0H                                               02S0118 00400000
*                 END;              /* STORAGE CLEARING COMPLETED    */ 00401000
*               ELSE                                            02S0119 00402000
*                 PCCNEXTP=0;       /* CLEAR RETURN ADDR.            */ 00403000
         B     @RC00106                                         02S0119 00404000
@RF00106 SLR   @08,@08                                          02S0119 00405000
         ST    @08,PCCNEXTP(,PCCBPTR)                           02S0119 00406000
*               GTSTR15=GTSTRTCD;   /* GTMN RETURN CODE              */ 00407000
@RC00106 LR    GTSTR15,GTSTRTCD                                 02S0120 00408000
*                                   /* RESTORE LIST PRINT STATUS     */ 00409000
*               IF RTCDREG=0 THEN   /* ?GETSTORG OK                  */ 00410000
         LTR   RTCDREG,RTCDREG                                  02S0121 00411000
         BNZ   @RF00121                                         02S0121 00412000
*                 PCCNEXTP->PCCPREVP=PCCBPTR;/* BACK CHAIN POINTER   */ 00413000
         L     @10,PCCNEXTP(,PCCBPTR)                           02S0122 00414000
         ST    PCCBPTR,PCCPREVP(,@10)                           02S0122 00415000
*               ELSE                /* ERROR                         */ 00416000
*                 RTCD=GETERROR;    /* RETURN CODE - 8               */ 00417000
         B     @RC00121                                         02S0123 00418000
@RF00121 MVC   RTCD(2),@CH00058                                 02S0123 00419000
*               CREATNEW=ON;        /* LOOP EXIT                     */ 00420000
@RC00121 OI    CREATNEW,B'10000000'                             02S0124 00421000
*             END;                                              02S0125 00422000
*           PCCBPTR=PCCNEXTP;       /* MAP NEXT OR FOUND PCCB        */ 00423000
@RF00097 L     PCCBPTR,PCCNEXTP(,PCCBPTR)                       02S0126 00424000
*         END;                                                  02S0127 00425000
@DE00096 L     @10,@PC00001+12                                  02S0127 00426000
         L     @10,CTGDSNP(,@10)                                02S0127 00427000
         CLC   PCCDSNAM(44,PCCBPTR),CTGDSN(@10)                 02S0127 00428000
         BE    @DC00096                                         02S0127 00429000
         TM    CREATNEW,B'10000000'                             02S0127 00430000
         BZ    @DL00096                                         02S0127 00431000
@DC00096 DS    0H                                               02S0128 00432000
*       IF CREATNEW=OFF THEN        /* NO PCCB CREATED AND   @ZA00870*/ 00433000
@RC00056 TM    CREATNEW,B'10000000'                             02S0128 00434000
         BNZ   @RF00128                                         02S0128 00435000
*         IF PCCSTPCT=OFF THEN      /* NOT A STEPCAT         @ZA00870*/ 00436000
         L     @10,@PC00001                                     02S0129 00437000
         TM    PCCSTPCT(@10),B'00100000'                        02S0129 00438000
         BNZ   @RF00129                                         02S0129 00439000
*           DO;                     /* CHECK FOR ALIAS       @ZA00870*/ 00440000
*                                                               03S0131 00441000
*/********************************************************************/ 00442000
*/*                                                                  */ 00443000
*/*  SEGMENT NAME - CHEKPCCB (ADDED FOR APAR OZ00870)        @ZA00870*/ 00444000
*/*                                                                  */ 00445000
*/*  DESCRIPTIVE NAME - PCCB CONTENTS VERIFICATION                   */ 00446000
*/*                                                                  */ 00447000
*/*  FUNCTION - INSURE A PCCB EXISTS FOR CATALOG ALIAS' AND THAT     */ 00448000
*/*             PCCBS THAT REPRESENT A CATALOG ARE USABLE BY         */ 00449000
*/*             CATALOG MANAGEMENT(IE. ALLOCATED OPEN AND ACTIVE).   */ 00450000
*/*                                                                  */ 00451000
*/*    OPERATION - 1. IF A DDNAME POINTER IS PASSED, THIS MEANS ALL  */ 00452000
*/*                   PCCBS FOR THIS CATALOG ARE NOT ALLOCATED AND   */ 00453000
*/*                   CLOSED.  THE PCCB CHAIN IS SCANNED AND ALL     */ 00454000
*/*                   PCCBS FOR THIS CATALOG ARE UPDATED WITH THE    */ 00455000
*/*                   ACB POINTER, DDNAME PASSED AND MADE ACTIVE.    */ 00456000
*/*                                                                  */ 00457000
*/*                2. IF A DDNAME POINTER IS NOT PASSED, THE CATALOG */ 00458000
*/*                   MAY OR MAY NOT BE OPEN, THE PCCB CHAIN IS      */ 00459000
*/*                   SCANNED TO GET THE ACB POINTER, DDNAME AND     */ 00460000
*/*                   VOLSER FOR CVOLS FROM AN EXISTING PCCB. THIS   */ 00461000
*/*                   ACB POINTER, DDNAME AND VOLSER FOR CVOLS       */ 00462000
*/*                   WILL BE USED AS INPUT IF A NEW PCCB IS NEEDED. */ 00463000
*/*                                                                  */ 00464000
*/*                3. IF ABOVE 1 OR 2 INDICATE A PCCB IS REQUIRED,   */ 00465000
*/*                   (PCCB IS NEEDED IF NO PCCB EXISTS WITH THE     */ 00466000
*/*                   ALIAS NAME PASSED) STORAGE IS OBTAINED AND     */ 00467000
*/*                   THE NEW PCCB IS ADDED TO THE END OF THE PCCB   */ 00468000
*/*                   CHAIN.                                         */ 00469000
*/*                NOTE:  ACB POINTERS FOR CVOLS ARE ZERO.           */ 00470000
*/*                                                                  */ 00471000
*/* ENTRY - IF PCCB(S) EXIST WITH THE SPECIFIED CATALOG DS NAME      */ 00472000
*/*                                                                  */ 00473000
*/*   INPUT - FIRST PCCB WITH THE SPECIFIED CATALOG DATASET NAME,    */ 00474000
*/*           AND OTHER PARAMETERS INPUT TO THE MODULE.              */ 00475000
*/*                                                                  */ 00476000
*/* EXIT - WHEN PROCESSING PCCB(S) IS COMPLETE.                      */ 00477000
*/*                                                                  */ 00478000
*/* OUTPUT DATA - NO ERROR DETECTED:                                 */ 00479000
*/*               NEW ALIAS PCCB CREATED   - REASON CODE 2           */ 00480000
*/*               NO PCCB CREATED - REASON CODE 1                    */ 00481000
*/*                                                                  */ 00482000
*/*             - ERROR CONDITION:                                   */ 00483000
*/*               ?GETSTORG ERROR          - REASON CODE 2           */ 00484000
*/*                                                                  */ 00485000
*/*   RETURN CODES - PROCESSING SUCCESSFUL - 0,                      */ 00486000
*/*                  PROCESSING ERROR      - 4,                      */ 00487000
*/*                  ?GETSTORG ERROR       - 8.                      */ 00488000
*/*                                                                  */ 00489000
*/********************************************************************/ 00490000
*                                                               03S0131 00491000
*             CHKDDNP=DDNAMEP;      /* COPY INPUT DDNAM PTR@ZA00870  */ 00492000
         L     @10,@PC00001+24                                  03S0131 00493000
         L     CHKDDNP,DDNAMEP(,@10)                            03S0131 00494000
*             NEEDPCCB=ON;          /* INDIC. PCCB NEEDED    @ZA00870*/ 00495000
         OI    NEEDPCCB,B'10000000'                             03S0132 00496000
*             ALIAS=ON;             /* IF A PCCB IS CREATED IT HAS TO   00497000
*                                      BE AN ALIAS           @ZA00870*/ 00498000
         OI    ALIAS,B'10000000'                                03S0133 00499000
*             DO WHILE PCCBPTR^=0;  /* SCAN ALL PCCBS        @ZA00870*/ 00500000
         B     @DE00134                                         03S0134 00501000
@DL00134 DS    0H                                               03S0135 00502000
*               IF CTGDSN=PCCDSNAM THEN/* REAL NAME PCCB ON CHAIN?      00503000
*                                                            @ZA00870*/ 00504000
         L     @10,@PC00001+12                                  03S0135 00505000
         L     @10,CTGDSNP(,@10)                                03S0135 00506000
         CLC   CTGDSN(44,@10),PCCDSNAM(PCCBPTR)                 03S0135 00507000
         BNE   @RF00135                                         03S0135 00508000
*                 DO;               /* YES, SEE IF PCCB NEEDED. 03S0136 00509000
*                                                            @ZA00870*/ 00510000
*                   IF CHKDDNP^=0 THEN/* INPUT DDNAME        @ZA00870*/ 00511000
         SLR   @10,@10                                          03S0137 00512000
         CR    CHKDDNP,@10                                      03S0137 00513000
         BE    @RF00137                                         03S0137 00514000
*                     DO;           /* YES, UPDATE ALL PCCBS WITH       00515000
*                                      SAME REAL CATLG NAME@ZA00870  */ 00516000
*                       PCCTCL=OFF; /* TURN OFF TEMP CLOSE   @ZA00870*/ 00517000
         NI    PCCTCL(PCCBPTR),B'11110111'                      03S0139 00518000
*                       PCCACBP=ACBPTR;/* PUT IN ACB PTR     @ZA00870*/ 00519000
         L     @08,ACBPTR                                       03S0140 00520000
         ST    @08,PCCACBP(,PCCBPTR)                            03S0140 00521000
*                       PCCDDNAM=DDNAME;/* GET INPUT DDNAME  @ZA00870*/ 00522000
         MVC   PCCDDNAM(8,PCCBPTR),DDNAME                       03S0141 00523000
*                       PCCACTIV=ON;/* MAKE IT ACTIVE        @ZA00870*/ 00524000
         OI    PCCACTIV(PCCBPTR),B'00100000'                    03S0142 00525000
*                       IF CTGCONP^=0 THEN/* ANY ALIAS?      @ZA00870*/ 00526000
         L     @08,@PC00001+16                                  03S0143 00527000
         L     @08,CTGCONP(,@08)                                03S0143 00528000
         CR    @08,@10                                          03S0143 00529000
         BE    @RF00143                                         03S0143 00530000
*                         IF CTGCON=PCCTGCON THEN/* YES, IS THIS PCCB   00531000
*                                      FOR INPUTED ALIAS?    @ZA00870*/ 00532000
         CLC   CTGCON(44,@08),PCCTGCON(PCCBPTR)                 03S0144 00533000
         BNE   @RF00144                                         03S0144 00534000
*                           NEEDPCCB=OFF;/* YES,DON'T NEED A PCCB       00535000
*                                                            @ZA00870*/ 00536000
         NI    NEEDPCCB,B'01111111'                             03S0145 00537000
*                         ELSE                                  03S0146 00538000
*                           ;       /* NOT SAME ALIAS, PCCB NEEDED      00539000
*                                                            @ZA00870*/ 00540000
@RF00144 DS    0H                                               03S0147 00541000
*                       ELSE        /* NO INPUT ALIAS, ALREADY A PCCB   00542000
*                                      FOR CATALOG           @ZA00870*/ 00543000
*                         NEEDPCCB=OFF;/* SO NO PCCB NEEDED  @ZA00870*/ 00544000
         B     @RC00143                                         03S0147 00545000
@RF00143 NI    NEEDPCCB,B'01111111'                             03S0147 00546000
*                     END;          /* NO CATALOG JUST OPENED BY        00547000
*                                      CALLER                @ZA00870*/ 00548000
*                   ELSE            /* ZERO DDNAME PTR       @ZA00870*/ 00549000
*                     DO;           /* NO ALLOC OR OPEN BY CALLER       00550000
*                                                            @ZA00870*/ 00551000
         B     @RC00137                                         03S0149 00552000
@RF00137 DS    0H                                               03S0150 00553000
*                       IF CTGCONP^=0 THEN/* INPUT ALIAS?    @ZA00870*/ 00554000
         L     @10,@PC00001+16                                  03S0150 00555000
         L     @10,CTGCONP(,@10)                                03S0150 00556000
         LTR   @10,@10                                          03S0150 00557000
         BZ    @RF00150                                         03S0150 00558000
*                         IF CTGCON^=PCCTGCON THEN/* YES, THIS PCCB     00559000
*                                      FOR INPUTED ALIAS?    @ZA00870*/ 00560000
         CLC   CTGCON(44,@10),PCCTGCON(PCCBPTR)                 03S0151 00561000
         BE    @RF00151                                         03S0151 00562000
*                           DO;     /* NO,GET ACB & DDNAME THEY MAY     00563000
*                                      BE ZERO               @ZA00870*/ 00564000
*                             IF PCOSCVOL=ON THEN/* CVOL?    @ZA00870*/ 00565000
         TM    PCOSCVOL(PCCBPTR),B'00010000'                    03S0153 00566000
         BNO   @RF00153                                         03S0153 00567000
*                               VSERCOPY=PCVOLSER;/* YES,SAVE VOLSER    00568000
*                                                            @ZA00870*/ 00569000
         MVC   VSERCOPY(6),PCVOLSER(PCCBPTR)                    03S0154 00570000
*                             ACBPTR=PCCACBP;/* ACBPTR FOR FINDPCCB     00571000
*                                                            @ZA00870*/ 00572000
@RF00153 L     @10,PCCACBP(,PCCBPTR)                            03S0155 00573000
         ST    @10,ACBPTR                                       03S0155 00574000
*                             DDNAME=PCCDDNAM;/* DDN FOR FINDPCCB       00575000
*                                                            @ZA00870*/ 00576000
         MVC   DDNAME(8),PCCDDNAM(PCCBPTR)                      03S0156 00577000
*                           END;    /* END UNEQUAL PCCB      @ZA00870*/ 00578000
*                         ELSE      /* ALIAS' SAME           @ZA00870*/ 00579000
*                           NEEDPCCB=OFF;/* DON'T NEED PCCB  @ZA00870*/ 00580000
         B     @RC00151                                         03S0158 00581000
@RF00151 NI    NEEDPCCB,B'01111111'                             03S0158 00582000
*                       ELSE        /* NO ALIAS SO ALREADY HAVE PCCB    00583000
*                                      FOR CATALOG           @ZA00870*/ 00584000
*                         NEEDPCCB=OFF;/* DON'T NEED ANOTHER PCCB       00585000
*                                                            @ZA00870*/ 00586000
         B     @RC00150                                         03S0159 00587000
@RF00150 NI    NEEDPCCB,B'01111111'                             03S0159 00588000
*                     END;          /* END ZERO DDNAMEPTR    @ZA00870*/ 00589000
@RC00150 DS    0H                                               03S0161 00590000
*                 END;              /* END EQUAL REAL NAMES  @ZA00870*/ 00591000
@RC00137 DS    0H                                               03S0162 00592000
*               LASTPCCB=PCCBPTR;   /* SAVE LAST PCCBPTR     @ZA00870*/ 00593000
@RF00135 ST    PCCBPTR,LASTPCCB                                 03S0162 00594000
*               PCCBPTR=PCCNEXTP;   /* GET NEXT PCCB         @ZA00870*/ 00595000
         L     PCCBPTR,PCCNEXTP(,PCCBPTR)                       03S0163 00596000
*             END;                  /* END PCCB SCAN         @ZA00870*/ 00597000
@DE00134 LTR   PCCBPTR,PCCBPTR                                  03S0164 00598000
         BNZ   @DL00134                                         03S0164 00599000
*             IF NEEDPCCB=ON THEN   /* ALIAS PCCB NEEDED?    @ZA00870*/ 00600000
         TM    NEEDPCCB,B'10000000'                             03S0165 00601000
         BNO   @RF00165                                         03S0165 00602000
*               DO;                 /* YES, GET AND CHAIN TO END        00603000
*                                                            @ZA00870*/ 00604000
*                 PCCBPTR=LASTPCCB; /* GET LAST PCCB         @ZA00870*/ 00605000
         L     PCCBPTR,LASTPCCB                                 03S0167 00606000
*                 RSNCD=ALIASCRT;   /* ALIAS PCCB CREATED    @ZA00870*/ 00607000
*                                                               03S0168 00608000
         MVC   RSNCD(2),@CH00089                                03S0168 00609000
*                 /***************************************************/ 00610000
*                 /*                                                 */ 00611000
*                 /* ?GETSTORG (JSCBSWSP,LENGTH(IEFPCCB),PCCNEXTP);  */ 00612000
*                 /*                                                 */ 00613000
*                 /***************************************************/ 00614000
*                                                               03S0169 00615000
*                 RFY                                           03S0169 00616000
*                  (GTSTR0,                                     03S0169 00617000
*                   GTSTR1,                                     03S0169 00618000
*                   GTSTR2) RSTD;   /* SAVE RGS                      */ 00619000
*                 GTSTR0=LENGTH(IEFPCCB);/* SET AMOUNT               */ 00620000
         LA    GTSTR0,176                                       03S0170 00621000
*                 GTSTR2=JSCBSWSP;  /* SET SUBPOOL                   */ 00622000
         L     @08,@PC00001+8                                   03S0171 00623000
         L     @08,JSCBPTR(,@08)                                03S0171 00624000
         SLR   GTSTR2,GTSTR2                                    03S0171 00625000
         IC    GTSTR2,JSCBSWSP(,@08)                            03S0171 00626000
*                 GENERATE CODE;                                03S0172 00627000
                       GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN             00628000
*                 GTSTRTCD=GTSTR15; /* SAVE GETMAIN RET COD          */ 00629000
         LR    GTSTRTCD,GTSTR15                                 03S0173 00630000
*                 PCCNEXTP=GTSTR1;  /* ADDR OF GOTN STORG            */ 00631000
         ST    GTSTR1,PCCNEXTP(,PCCBPTR)                        03S0174 00632000
*                 RFY                                           03S0175 00633000
*                  (GTSTR0,                                     03S0175 00634000
*                   GTSTR1,                                     03S0175 00635000
*                   GTSTR2) UNRSTD; /* RLSE                          */ 00636000
*                 IF GTSTRTCD=0 THEN/* GETMAIN SUCCESSFUL?           */ 00637000
         LTR   GTSTRTCD,GTSTRTCD                                03S0176 00638000
         BNZ   @RF00176                                         03S0176 00639000
*                   DO;             /* YES, CLEAR STORAGE.           */ 00640000
*                     RFY                                       03S0178 00641000
*                      (GTSTR2,                                 03S0178 00642000
*                       GTSTR4,                                 03S0178 00643000
*                       GTSTR5,                                 03S0178 00644000
*                       GTSTR6,                                 03S0178 00645000
*                       GTSTR7,                                 03S0178 00646000
*                       GTSTR8) RSTD;                           03S0178 00647000
*                     GTSTR4=PCCNEXTP;/* STORG PTR                   */ 00648000
         L     @03,PCCNEXTP(,PCCBPTR)                           03S0179 00649000
         LR    GTSTR4,@03                                       03S0179 00650000
*                     GTSTR5=LENGTH(IEFPCCB);/* STORG AMNT           */ 00651000
         LA    GTSTR5,176                                       03S0180 00652000
*                     GTSTR7='00000000'X;/* PAD CHAR & LNTH          */ 00653000
         SLR   GTSTR7,GTSTR7                                    03S0181 00654000
*                     IF JSCBSWSP=GTST253 THEN                  03S0182 00655000
         L     @03,@PC00001+8                                   03S0182 00656000
         L     @03,JSCBPTR(,@03)                                03S0182 00657000
         CLI   JSCBSWSP(@03),253                                03S0182 00658000
         BNE   @RF00182                                         03S0182 00659000
*                       GEN                                     03S0183 00660000
*(MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);              03S0183 00661000
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8                 00662000
*                     GEN REFS(GTSTR4,GTSTR6);                  03S0184 00663000
@RF00182 DS    0H                                               03S0184 00664000
                            MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG      00665000
*                     IF JSCBSWSP=GTST253 THEN                  03S0185 00666000
         L     @03,@PC00001+8                                   03S0185 00667000
         L     @03,JSCBPTR(,@03)                                03S0185 00668000
         CLI   JSCBSWSP(@03),253                                03S0185 00669000
         BNE   @RF00185                                         03S0185 00670000
*                       GEN(MODESET KEYADDR=(2));               03S0186 00671000
         MODESET KEYADDR=(2)                                            00672000
*                     RFY                                       03S0187 00673000
*                      (GTSTR2,                                 03S0187 00674000
*                       GTSTR4,                                 03S0187 00675000
*                       GTSTR5,                                 03S0187 00676000
*                       GTSTR6,                                 03S0187 00677000
*                       GTSTR7,                                 03S0187 00678000
*                       GTSTR8) UNRSTD;                         03S0187 00679000
@RF00185 DS    0H                                               03S0188 00680000
*                   END;            /* STORAGE CLEARING COMPLETED    */ 00681000
*                 ELSE                                          03S0189 00682000
*                   PCCNEXTP=0;     /* CLEAR RETURN ADDR.            */ 00683000
         B     @RC00176                                         03S0189 00684000
@RF00176 SLR   @08,@08                                          03S0189 00685000
         ST    @08,PCCNEXTP(,PCCBPTR)                           03S0189 00686000
*                 GTSTR15=GTSTRTCD; /* GTMN RETURN CODE              */ 00687000
@RC00176 LR    GTSTR15,GTSTRTCD                                 03S0190 00688000
*                                   /* RESTORE LIST PRINT STATUS     */ 00689000
*                 IF RTCDREG^=0 THEN/* NO STORAGE,           @ZA00870*/ 00690000
         LTR   RTCDREG,RTCDREG                                  03S0191 00691000
         BZ    @RF00191                                         03S0191 00692000
*                   RTCD=GETERROR;  /* RETURN CODE - 8       @ZA00870*/ 00693000
         MVC   RTCD(2),@CH00058                                 03S0192 00694000
*                 ELSE              /* GETSTORG OK?          @ZA00870*/ 00695000
*                   DO;             /* CHAIN NEW PCCB        @ZA00870*/ 00696000
         B     @RC00191                                         03S0193 00697000
@RF00191 DS    0H                                               03S0194 00698000
*                     PCCBPTR=PCCNEXTP;/* NEW PCCB PTR       @ZA00870*/ 00699000
         L     PCCBPTR,PCCNEXTP(,PCCBPTR)                       03S0194 00700000
*                     PCCPREVP=LASTPCCB;/* BACK CHAIN PCCB   @ZA00870*/ 00701000
         L     @10,LASTPCCB                                     03S0195 00702000
         ST    @10,PCCPREVP(,PCCBPTR)                           03S0195 00703000
*                   END;            /* END GETSOTRG OK       @ZA00870*/ 00704000
*               END;                /* END ALIAS PCCB CREATE @ZA00870*/ 00705000
*             ELSE                  /* NO PCCB CREATED.      @ZA00870*/ 00706000
*               RSNCD=OLDPCCB;      /* AN OLD ONE WILL DO    @ZA00870*/ 00707000
         B     @RC00165                                         03S0198 00708000
@RF00165 MVC   RSNCD(2),@CH00080                                03S0198 00709000
*           END;                    /* END PCCB CHECK        @ZA00870*/ 00710000
*         ELSE                      /* STEPCAT AND PCCB      @ZA00870*/ 00711000
*           DO;                     /* EXISTS,               @ZA00870*/ 00712000
         B     @RC00129                                         02S0200 00713000
@RF00129 DS    0H                                               02S0201 00714000
*             RTCD=DUPERROR;        /* ERROR                 @ZA00870*/ 00715000
         LA    @10,4                                            02S0201 00716000
         STH   @10,RTCD                                         02S0201 00717000
*             RSNCD=ACBERROR;       /* DUPLICATE STEPCAT     @ZA00870*/ 00718000
         STH   @10,RSNCD                                        02S0202 00719000
*           END;                                                02S0203 00720000
*       ELSE                                                    02S0204 00721000
*         ;                         /* NON-ALIAS PCCB        @ZA00870*/ 00722000
@RF00128 DS    0H                                               02S0205 00723000
*       IF RTCD=0&(CREATNEW=ON|NEEDPCCB=ON) THEN/* PCCB GOTTEN  02S0205 00724000
*                                                            @ZA00870*/ 00725000
@RC00128 LH    @10,RTCD                                         02S0205 00726000
         LTR   @10,@10                                          02S0205 00727000
         BNZ   @RF00205                                         02S0205 00728000
         TM    CREATNEW,B'10000000'                             02S0205 00729000
         BO    @RT00205                                         02S0205 00730000
         TM    NEEDPCCB,B'10000000'                             02S0205 00731000
         BNO   @RF00205                                         02S0205 00732000
@RT00205 DS    0H                                               02S0206 00733000
*         DO;                       /* FILL IN PCCB.         @ZA00870*/ 00734000
*           PCCACTIV=ON;            /* INDICATE PCCB ACTIVE          */ 00735000
         OI    PCCACTIV(PCCBPTR),B'00100000'                    02S0207 00736000
*           PCCDSNAM=CTGDSN;        /* CATALOG DATA SET NAME         */ 00737000
         L     @10,@PC00001+12                                  02S0208 00738000
         L     @10,CTGDSNP(,@10)                                02S0208 00739000
         MVC   PCCDSNAM(44,PCCBPTR),CTGDSN(@10)                 02S0208 00740000
*           IF CTGCONP^=0 THEN      /* CATALOG CONNECTOR NAME WAS    */ 00741000
         L     @10,@PC00001+16                                  02S0209 00742000
         L     @10,CTGCONP(,@10)                                02S0209 00743000
         LTR   @10,@10                                          02S0209 00744000
         BZ    @RF00209                                         02S0209 00745000
*             PCCTGCON=CTGCON;      /* PLACE IT IN THE PCCB AND      */ 00746000
         MVC   PCCTGCON(44,PCCBPTR),CTGCON(@10)                 02S0210 00747000
*           IF ALIAS=ON THEN        /* CHEKPCCB CREATED AN ALIAS        00748000
*                                                            @ZA00870*/ 00749000
@RF00209 TM    ALIAS,B'10000000'                                02S0211 00750000
         BNO   @RF00211                                         02S0211 00751000
*             PCCALIAS=ON;          /* MARK PCCB AS ALIAS    @ZA00870*/ 00752000
         OI    PCCALIAS(PCCBPTR),B'01000000'                    02S0212 00753000
*           IF PCCSTPCT=ON THEN     /* CATALOG IS A STEPCAT,         */ 00754000
@RF00211 L     @10,@PC00001                                     02S0213 00755000
         TM    PCCSTPCT(@10),B'00100000'                        02S0213 00756000
         BNO   @RF00213                                         02S0213 00757000
*             PCCSTEPC=ON;          /* INDICATE 'STEPCAT' IN PCCB    */ 00758000
         OI    PCCSTEPC(PCCBPTR),B'10000000'                    02S0214 00759000
*           PCCDDNAM=DDNAME;        /* PLACE DD NAME IN PCCB         */ 00760000
@RF00213 MVC   PCCDDNAM(8,PCCBPTR),DDNAME                       02S0215 00761000
*           IF PCCVOL=ON THEN       /* CATALOG IS A CVOL             */ 00762000
         L     @10,@PC00001                                     02S0216 00763000
         TM    PCCVOL(@10),B'00001000'                          02S0216 00764000
         BNO   @RF00216                                         02S0216 00765000
*             DO;                                               02S0217 00766000
*               PCOSCVOL=ON;        /* INDICATE SAME AND PLACE THE   */ 00767000
         OI    PCOSCVOL(PCCBPTR),B'00010000'                    02S0218 00768000
*               PCVOLSER=VSERCOPY;  /* VOLUME SERIAL IN THE PCCB     */ 00769000
         MVC   PCVOLSER(6,PCCBPTR),VSERCOPY                     02S0219 00770000
*             END;                                              02S0220 00771000
*           ELSE                    /* USER (VSAM) CATALOG           */ 00772000
*             PCCACBP=ACBPTR;       /* PLACE ACB POINTER IN PCCB     */ 00773000
         B     @RC00216                                         02S0221 00774000
@RF00216 L     @10,ACBPTR                                       02S0221 00775000
         ST    @10,PCCACBP(,PCCBPTR)                            02S0221 00776000
*           PCCACRO=BLOKNAME;       /* PUT 'PCCB' INTO NEW PCCB      */ 00777000
@RC00216 MVC   PCCACRO(4,PCCBPTR),@CC00098                      02S0222 00778000
*         END;                                                  02S0223 00779000
*       ELSE                                                    02S0224 00780000
*         IF RTCD=GETERROR THEN     /* ?GETSTORG ERROR               */ 00781000
         B     @RC00205                                         02S0224 00782000
@RF00205 CLC   RTCD(2),@CH00058                                 02S0224 00783000
         BNE   @RF00224                                         02S0224 00784000
*           RSNCD=GETBAD;           /* REASON CODE - 2               */ 00785000
         MVC   RSNCD(2),@CH00089                                02S0225 00786000
*     END;                          /* END FIND PCCB ROUTINE         */ 00787000
*   ELSE                                                        01S0227 00788000
*     IF PCCFREE=ON&PCC2FREE^=0&    /* FREE A PCCB AND THE PCCB-TO-  */ 00789000
*         PCC2FREE->PCCACRO=BLOKNAME THEN/* FREE IS A PCCB           */ 00790000
         B     @RC00045                                         01S0227 00791000
@RF00045 L     @10,@PC00001                                     01S0227 00792000
         TM    PCCFREE(@10),B'01000000'                         01S0227 00793000
         BNO   @RF00227                                         01S0227 00794000
         SLR   @10,@10                                          01S0227 00795000
         L     @15,@PC00001+28                                  01S0227 00796000
         L     @15,PCC2FREE(,@15)                               01S0227 00797000
         CR    @15,@10                                          01S0227 00798000
         BE    @RF00227                                         01S0227 00799000
         CLC   PCCACRO(4,@15),@CC00098                          01S0227 00800000
         BNE   @RF00227                                         01S0227 00801000
*       DO;                         /* 'UNCHAIN' THE PCCB            */ 00802000
*         PCCBPTR=PCC2FREE;         /* MAP THE 'PCCB TO FREE'        */ 00803000
         LR    PCCBPTR,@15                                      01S0229 00804000
*         IF PCCPREVP=0 THEN        /* FIRST PCCB IN CHAIN, UPDATE   */ 00805000
         C     @10,PCCPREVP(,PCCBPTR)                           01S0230 00806000
         BNE   @RF00230                                         01S0230 00807000
*           DO;                                                 01S0231 00808000
*             DO;                   /* MODESET KEYADDR(0)            */ 00809000
*               SPKA(0);            /* SET PSW KEY                   */ 00810000
         SPKA  0(@10)                                           01S0233 00811000
*             END;                  /* MODESET KEYADDR(0) KEY 0 TO      00812000
*                                      ALTER JSCB                    */ 00813000
*             JSCBPCC=PCCNEXTP;     /* FIRST PCCB PTR IN JSCB        */ 00814000
         L     @10,@PC00001+8                                   01S0235 00815000
         L     @10,JSCBPTR(,@10)                                01S0235 00816000
         L     @08,PCCNEXTP(,PCCBPTR)                           01S0235 00817000
         ST    @08,JSCBPCC(,@10)                                01S0235 00818000
*             DO;                   /* MODESET EXTKEY(SCHED)         */ 00819000
*               SPKA(16);           /* SET PSW KEY                   */ 00820000
         LA    @10,16                                           01S0237 00821000
         SPKA  0(@10)                                           01S0237 00822000
*             END;                  /* MODESET EXTKEY(SCHED) BACK TO    00823000
*                                      KEY 1                         */ 00824000
*           END;                                                01S0239 00825000
*         ELSE                      /* NOT FIRST PCCB, UPDATE        */ 00826000
*           PCCPREVP->PCCNEXTP=PCCNEXTP;/* PREVIOUS' 'NEXT PTR'      */ 00827000
         B     @RC00230                                         01S0240 00828000
@RF00230 L     @10,PCCPREVP(,PCCBPTR)                           01S0240 00829000
         L     @08,PCCNEXTP(,PCCBPTR)                           01S0240 00830000
         ST    @08,PCCNEXTP(,@10)                               01S0240 00831000
*         IF PCCNEXTP^=0 THEN       /* THERE IS A 'NEXT' PCCB        */ 00832000
@RC00230 L     @10,PCCNEXTP(,PCCBPTR)                           01S0241 00833000
         LTR   @10,@10                                          01S0241 00834000
         BZ    @RF00241                                         01S0241 00835000
*           PCCNEXTP->PCCPREVP=PCCPREVP;/* CHAIN NEXT TO PREVIOUS    */ 00836000
         L     @08,PCCPREVP(,PCCBPTR)                           01S0242 00837000
         ST    @08,PCCPREVP(,@10)                               01S0242 00838000
*         LENREG=SPLEN;             /* SUBPOOL, LENGTH AND ADDRESS   */ 00839000
@RF00241 L     LENREG,SPLEN                                     01S0243 00840000
*         ADDREG=PCC2FREE;          /* OF PCCB TO BE FREED           */ 00841000
         L     @10,@PC00001+28                                  01S0244 00842000
         L     ADDREG,PCC2FREE(,@10)                            01S0244 00843000
*         GEN(FREEMAIN R,LV=(0),A=(1));                         01S0245 00844000
         FREEMAIN R,LV=(0),A=(1)                                        00845000
*       END;                                                    01S0246 00846000
*   GEN REFS(NQCORE);                                           01S0247 00847000
@RF00227 DS    0H                                               01S0247 00848000
@RC00045 DS    0H                                               01S0247 00849000
*                                  /* DEQUEUE PCCB CHAIN            */  00850000
         DEQ MF=(E,NQCORE)                                              00851000
*   RTNINFO=LCLRTN;                 /* PASS RETURN INFO TO CALLER    */ 00852000
         L     @10,@PC00001+4                                   01S0248 00853000
         L     @10,RTNP(,@10)                                   01S0248 00854000
         L     @15,LCLRTN                                       01S0248 00855000
         ST    @15,RTNINFO(,@10)                                01S0248 00856000
*   END IEFAB4EF                                                01S0249 00857000
*                                                               01S0249 00858000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00859000
*/*%INCLUDE SYSUT5  (SPEC4EF )                                       */ 00860000
*/*%INCLUDE SYSUT5  (DCLS4EF )                                       */ 00861000
*/*%INCLUDE SYSLIB  (IEFZB450)                                       */ 00862000
*/*%INCLUDE SYSLIB  (IEFPCCB )                                       */ 00863000
*/*%INCLUDE SYSLIB  (IEZJSCB )                                       */ 00864000
*/*%INCLUDE SYSUT5  (FINDSPEC)                                       */ 00865000
*/*%INCLUDE SYSUT5  (FINDPCCB)                                       */ 00866000
*/*%INCLUDE SYSUT5  (CHEKSPEC)                                       */ 00867000
*/*%INCLUDE SYSUT5  (CHEKPCCB)                                       */ 00868000
*                                                               01S0249 00869000
*       ;                                                       01S0249 00870000
@EL00001 IC    @02,@OLDKEY                                      01S0249 00871000
         L     @13,4(,@13)                                      01S0249 00872000
@EF00001 L     @00,@SIZDATD                                     01S0249 00873000
         LR    @01,@11                                          01S0249 00874000
         FSPACE   R,LV=(0),A=(1)                                        00875000
         MODESET KEYADDR=(2)                                            00876000
@ER00001 LM    @14,@12,12(@13)                                  01S0249 00877000
         BR    @14                                              01S0249 00878000
@DATA    DS    0H                                                       00879000
@CH00080 DC    H'1'                                                     00880000
@CH00089 DC    H'2'                                                     00881000
@CH00058 DC    H'8'                                                     00882000
@SM00290 MVC   NQCORE(0),PCNQLIST                                       00883000
@DATD    DSECT                                                          00884000
         DS    0F                                                       00885000
@SA00001 DS    18F                                                      00886000
@PC00001 DS    9F                                                       00887000
IEFAB4EF CSECT                                                          00888000
         DS    0F                                                       00889000
@CF00289 DC    F'176'                                                   00890000
@DATD    DSECT                                                          00891000
         DS    0D                                                       00892000
NXPCTEMP DS    A                                                        00893000
ACBPTR   DS    A                                                        00894000
LASTPCCB DS    A                                                        00895000
LCLRTN   DS    FL4                                                      00896000
         ORG   LCLRTN                                                   00897000
RTCD     DS    FL2                                                      00898000
RSNCD    DS    FL2                                                      00899000
         ORG   LCLRTN+4                                                 00900000
SPLEN    DS    CL4                                                      00901000
         ORG   SPLEN                                                    00902000
SBPOOL   DS    FL1                                                      00903000
LENTH    DS    FL3                                                      00904000
         ORG   SPLEN+4                                                  00905000
DDNAME   DS    CL8                                                      00906000
VSERCOPY DS    CL6                                                      00907000
CREATNEW DS    BL1                                                      00908000
ALIAS    DS    BL1                                                      00909000
NEEDPCCB DS    BL1                                                      00910000
@OLDKEY  DS    AL1                                                      00911000
IEFAB4EF CSECT                                                          00912000
         DS    0F                                                       00913000
@SIZDATD DC    AL1(230)                                                 00914000
         DC    AL3(@ENDDATD-@DATD)                                      00915000
         DS    0D                                                       00916000
GTSTZERO DC    F'0'                                                     00917000
@CC00098 DC    C'PCCB'                                                  00918000
QNAME    DC    CL8'SYSZPCCB'                                            00919000
RNAME    DC    CL4'PCCB'                                                00920000
IEFAB4EF CSECT                                                          00921000
PCNQLIST ENQ (QNAME,RNAME,S,,SYSTEM),MF=L                               00922000
NQLENGTH DC A(*-PCNQLIST)                                               00923000
@DATD    DSECT                                                          00924000
NQCORE   ENQ (QNAME,RNAME,S,,SYSTEM),MF=L                               00925000
IEFAB4EF CSECT                                                          00926000
         DS   0H                                                        00927000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   00928000
@DATD    DSECT                                                          00929000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00930000
@ENDDATD EQU   *                                                        00931000
IEFAB4EF CSECT                                                          00932000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00933000
@01      EQU   01                                                       00934000
@02      EQU   02                                                       00935000
@03      EQU   03                                                       00936000
@04      EQU   04                                                       00937000
@05      EQU   05                                                       00938000
@06      EQU   06                                                       00939000
@07      EQU   07                                                       00940000
@08      EQU   08                                                       00941000
@09      EQU   09                                                       00942000
@10      EQU   10                                                       00943000
@11      EQU   11                                                       00944000
@12      EQU   12                                                       00945000
@13      EQU   13                                                       00946000
@14      EQU   14                                                       00947000
@15      EQU   15                                                       00948000
GTSTRTCD EQU   @10                                                      00949000
CHKDDNP  EQU   @02                                                      00950000
PCCBPTR  EQU   @09                                                      00951000
LENREG   EQU   @00                                                      00952000
ADDREG   EQU   @01                                                      00953000
RTCDREG  EQU   @15                                                      00954000
GTSTR0   EQU   @00                                                      00955000
GTSTR1   EQU   @01                                                      00956000
GTSTR2   EQU   @02                                                      00957000
GTSTR15  EQU   @15                                                      00958000
GTSTR4   EQU   @04                                                      00959000
GTSTR5   EQU   @05                                                      00960000
GTSTR6   EQU   @06                                                      00961000
GTSTR7   EQU   @07                                                      00962000
GTSTR8   EQU   @08                                                      00963000
GTSTR3   EQU   @03                                                      00964000
RTNINFO  EQU   0                                                        00965000
CTGDSN   EQU   0                                                        00966000
CTGCON   EQU   0                                                        00967000
DDNAM    EQU   0                                                        00968000
VSERPARM EQU   0                                                        00969000
IEFPCCB  EQU   0                                                        00970000
PCCACRO  EQU   IEFPCCB                                                  00971000
PCCNEXTP EQU   IEFPCCB+4                                                00972000
PCCPREVP EQU   IEFPCCB+8                                                00973000
PCCSTATS EQU   IEFPCCB+12                                               00974000
PCCSTAT1 EQU   PCCSTATS                                                 00975000
PCCSTEPC EQU   PCCSTAT1                                                 00976000
PCCALIAS EQU   PCCSTAT1                                                 00977000
PCCACTIV EQU   PCCSTAT1                                                 00978000
PCOSCVOL EQU   PCCSTAT1                                                 00979000
PCCTCL   EQU   PCCSTAT1                                                 00980000
PCCACBP  EQU   IEFPCCB+16                                               00981000
PCCDDNAM EQU   IEFPCCB+20                                               00982000
PCCDSNAM EQU   IEFPCCB+28                                               00983000
PCCTGCON EQU   IEFPCCB+72                                               00984000
PCVOLSER EQU   IEFPCCB+116                                              00985000
IEZJSCB  EQU   0                                                        00986000
JSCBSEC1 EQU   IEZJSCB+188                                              00987000
JSCHPCE  EQU   JSCBSEC1+4                                               00988000
JSCBPCC  EQU   JSCBSEC1+16                                              00989000
JSCBDCB  EQU   JSCBSEC1+36                                              00990000
JSCBOPTS EQU   JSCBSEC1+48                                              00991000
JSCBSWT1 EQU   JSCBSEC1+55                                              00992000
JSCBWTP  EQU   JSCBSEC1+64                                              00993000
JSCBWTFG EQU   JSCBWTP                                                  00994000
JSCBEND1 EQU   IEZJSCB+260                                              00995000
PCCNTRLS EQU   0                                                        00996000
PCCMAKE  EQU   PCCNTRLS                                                 00997000
PCCFREE  EQU   PCCNTRLS                                                 00998000
PCCSTPCT EQU   PCCNTRLS                                                 00999000
PCCFREAL EQU   PCCNTRLS                                                 01000000
PCCVOL   EQU   PCCNTRLS                                                 01001000
RTNP     EQU   0                                                        01002000
JSCBPTR  EQU   0                                                        01003000
CTGDSNP  EQU   0                                                        01004000
CTGCONP  EQU   0                                                        01005000
ACBP     EQU   0                                                        01006000
DDNAMEP  EQU   0                                                        01007000
PCC2FREE EQU   0                                                        01008000
VSERPTR  EQU   0                                                        01009000
JSCBSEC2 EQU   JSCBEND1                                                 01010000
JSCBSEC3 EQU   JSCBEND1                                                 01011000
JSCBJCT  EQU   JSCBSEC3                                                 01012000
JSCBJCTA EQU   JSCBJCT+1                                                01013000
JSCBASID EQU   JSCBSEC3+8                                               01014000
JSCBJNL  EQU   JSCBSEC3+28                                              01015000
JSCBJJSB EQU   JSCBJNL                                                  01016000
JSCBSUB  EQU   JSCBSEC3+40                                              01017000
JSCSCT   EQU   JSCBSEC3+68                                              01018000
JSCBSWSP EQU   JSCBSEC3+87                                              01019000
JSCRSV35 EQU   JSCBSEC3+96                                              01020000
JSCRSV36 EQU   JSCRSV35                                                 01021000
JSCRSV37 EQU   JSCRSV35+2                                               01022000
JSCRSV45 EQU   JSCBSEC3+112                                             01023000
JSCRSV46 EQU   JSCRSV45                                                 01024000
JSCRSV47 EQU   JSCRSV45+2                                               01025000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01026000
JSCBEND3 EQU   JSCBSEC3+120                                             01027000
JSCRSV52 EQU   JSCBSEC3+116                                             01028000
JSCRSV51 EQU   JSCRSV47+1                                               01029000
JSCRSV50 EQU   JSCRSV47                                                 01030000
JSCRSV49 EQU   JSCRSV46+1                                               01031000
JSCRSV48 EQU   JSCRSV46                                                 01032000
JSCRSV44 EQU   JSCBSEC3+108                                             01033000
JSCRSV43 EQU   JSCBSEC3+104                                             01034000
JSCRSV42 EQU   JSCBSEC3+100                                             01035000
JSCRSV41 EQU   JSCRSV37+1                                               01036000
JSCRSV40 EQU   JSCRSV37                                                 01037000
JSCRSV39 EQU   JSCRSV36+1                                               01038000
JSCRSV38 EQU   JSCRSV36                                                 01039000
JSCBUFPT EQU   JSCBSEC3+92                                              01040000
JSCBACT  EQU   JSCBSEC3+88                                              01041000
JSCRSV33 EQU   JSCBSEC3+86                                              01042000
JSCDDNUM EQU   JSCBSEC3+84                                              01043000
JSCRSV53 EQU   JSCBSEC3+82                                              01044000
JSCDDNNO EQU   JSCBSEC3+80                                              01045000
JSCBVATA EQU   JSCBSEC3+76                                              01046000
JSCTMCOR EQU   JSCBSEC3+72                                              01047000
JSCSCTP  EQU   JSCSCT+1                                                 01048000
JSCRSV55 EQU   JSCSCT                                                   01049000
JSCRSV54 EQU   JSCBSEC3+64                                              01050000
JSCDSABQ EQU   JSCBSEC3+60                                              01051000
JSCBSSIB EQU   JSCBSEC3+56                                              01052000
JSCBFRBA EQU   JSCBSEC3+48                                              01053000
JSCRSV28 EQU   JSCBSEC3+46                                              01054000
JSCBSONO EQU   JSCBSEC3+44                                              01055000
JSCBSUBA EQU   JSCBSUB+1                                                01056000
JSCRSV31 EQU   JSCBSUB                                                  01057000
JSCBSMLR EQU   JSCBSEC3+36                                              01058000
JSCBJNLR EQU   JSCBSEC3+32                                              01059000
JSCBJNLA EQU   JSCBJNL+1                                                01060000
JSCBJSBT EQU   JSCBJJSB                                                 01061000
JSCBJSBX EQU   JSCBJJSB                                                 01062000
JSCBJSBA EQU   JSCBJJSB                                                 01063000
JSCBJSBI EQU   JSCBJJSB                                                 01064000
@NM00006 EQU   JSCBJJSB                                                 01065000
JSCBJNLE EQU   JSCBJJSB                                                 01066000
JSCBJNLF EQU   JSCBJJSB                                                 01067000
JSCBJNLN EQU   JSCBJJSB                                                 01068000
@NM00005 EQU   JSCBSEC3+24                                              01069000
JSCBJRBA EQU   JSCBSEC3+16                                              01070000
JSCBIECB EQU   JSCBSEC3+12                                              01071000
JSCRSV25 EQU   JSCBSEC3+10                                              01072000
JSCBTJID EQU   JSCBASID                                                 01073000
JSCBPSCB EQU   JSCBSEC3+4                                               01074000
JSCJCTP  EQU   JSCBJCTA                                                 01075000
JSCRSV24 EQU   JSCBJCT                                                  01076000
JSCBEND2 EQU   JSCBSEC2                                                 01077000
@NM00001 EQU   PCCNTRLS                                                 01078000
JSCBCSCB EQU   JSCBSEC1+68                                              01079000
JSCBPMG  EQU   JSCBWTP+2                                                01080000
JSCBWTSP EQU   JSCBWTP+1                                                01081000
JSCRSV23 EQU   JSCBWTFG                                                 01082000
JSCRSV22 EQU   JSCBWTFG                                                 01083000
JSCRSV21 EQU   JSCBWTFG                                                 01084000
JSCRSV20 EQU   JSCBWTFG                                                 01085000
JSCRSV19 EQU   JSCBWTFG                                                 01086000
JSCRSV18 EQU   JSCBWTFG                                                 01087000
JSCBRET  EQU   JSCBWTFG                                                 01088000
JSCBIOFG EQU   JSCBWTFG                                                 01089000
@NM00004 EQU   JSCBSEC1+60                                              01090000
JSCBQMPI EQU   JSCBSEC1+56                                              01091000
JSCBPMSG EQU   JSCBSWT1                                                 01092000
JSCRSV16 EQU   JSCBSWT1                                                 01093000
JSCRSV15 EQU   JSCBSWT1                                                 01094000
JSCRSV14 EQU   JSCBSWT1                                                 01095000
JSCRSV13 EQU   JSCBSWT1                                                 01096000
JSCRSV12 EQU   JSCBSWT1                                                 01097000
JSCRSV11 EQU   JSCBSWT1                                                 01098000
JSCBPASS EQU   JSCBSWT1                                                 01099000
JSCBTTTR EQU   JSCBSEC1+52                                              01100000
JSCRSV10 EQU   JSCBSEC1+49                                              01101000
JSCBAUTH EQU   JSCBOPTS                                                 01102000
JSCSIOTS EQU   JSCBOPTS                                                 01103000
JSCRSV08 EQU   JSCBOPTS                                                 01104000
JSCRSV07 EQU   JSCBOPTS                                                 01105000
JSCRSV06 EQU   JSCBOPTS                                                 01106000
JSCBLONG EQU   JSCBOPTS                                                 01107000
JSCRSV05 EQU   JSCBOPTS                                                 01108000
JSCRSV04 EQU   JSCBOPTS                                                 01109000
JSCBSECB EQU   JSCBSEC1+44                                              01110000
JSCRSV03 EQU   JSCBSEC1+41                                              01111000
JSCBSTEP EQU   JSCBSEC1+40                                              01112000
JSCBDCBA EQU   JSCBDCB+1                                                01113000
JSCRSV02 EQU   JSCBDCB                                                  01114000
JSCBID   EQU   JSCBSEC1+32                                              01115000
JSCBDBTB EQU   JSCBSEC1+28                                              01116000
JSCBIJSC EQU   JSCBSEC1+24                                              01117000
JSCBTCBP EQU   JSCBSEC1+20                                              01118000
JSCBTCP  EQU   JSCBSEC1+12                                              01119000
JSCBSHR  EQU   JSCBSEC1+8                                               01120000
JSCHPCEA EQU   JSCHPCE+1                                                01121000
JSCRSV32 EQU   JSCHPCE                                                  01122000
JSCRSV01 EQU   JSCBSEC1                                                 01123000
@NM00003 EQU   IEZJSCB                                                  01124000
PCCRSVD2 EQU   IEFPCCB+128                                              01125000
PCCLACBP EQU   IEFPCCB+124                                              01126000
PCCRSVD1 EQU   IEFPCCB+122                                              01127000
PCCSTAT4 EQU   PCCSTATS+3                                               01128000
PCCSTAT3 EQU   PCCSTATS+2                                               01129000
PCCSTAT2 EQU   PCCSTATS+1                                               01130000
@NM00002 EQU   PCCSTAT1                                                 01131000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01132000
@RC00143 EQU   @RC00137                                                 01133000
@RC00151 EQU   @RC00150                                                 01134000
@RC00129 EQU   @RC00128                                                 01135000
@RF00224 EQU   @RC00045                                                 01136000
@RC00205 EQU   @RC00045                                                 01137000
@RC00165 EQU   @RC00129                                                 01138000
@RC00191 EQU   @RC00165                                                 01139000
@ENDDATA EQU   *                                                        01140000
         END   IEFAB4EF,(C'PLS1607',0603,74361)                         01141000
