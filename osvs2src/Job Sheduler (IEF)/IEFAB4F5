         TITLE 'IEFAB4F5 - ALLOCATE CATALOG CONTROL                    *00001000
                        '                                               00002000
IEFAB4F5 CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(24)                                          01S0001 00007000
         DC    C'IEFAB4F5 78089  UZ17788 '                      01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  DS    0H                                               01S0001 00012000
         USING @PSTART,@12                                      01S0001 00013000
         L     @00,@SIZDATD                                     01S0001 00014000
         MODESET EXTKEY=SCHED,SAVEKEY=(2)                               00015000
         GSPACE   R,LV=(0)                                              00016000
         LR    @11,@01                                          01S0001 00017000
         USING @DATD,@11                                        01S0001 00018000
         ST    @13,@SA00001+4                                   01S0001 00019000
         LR    KEYSAVE,@02                                      01S0001 00020000
         MODESET KEYADDR=(2)                                            00021000
         LM    @00,@02,20(@13)                                  01S0001 00022000
         ST    @11,8(,@13)                                      01S0001 00023000
         LR    @13,@11                                          01S0001 00024000
         MODESET EXTKEY=ZERO                                            00025000
         MVC   @PC00001(24),0(@01)                              01S0001 00026000
         MODESET EXTKEY=SCHED                                           00027000
JSCBDISP EQU 188                                                        00028000
JSCBAOS1 EQU  72                                                        00029000
JSCBAOS2 EQU 192                                                        00030000
*   RTCDPTR=ADDR(RETCOD);           /* ADDR OF LOCAL RTN INFO        */ 00031000
         LA    @10,RETCOD                                       01S0056 00032000
         ST    @10,RTCDPTR                                      01S0056 00033000
*   RETCOD=0;                       /* INIT LOCAL RETURN INFO        */ 00034000
         SLR   @10,@10                                          01S0057 00035000
         STCM  @10,15,RETCOD                                    01S0057 00036000
*                                                               02S0058 00037000
*/********************************************************************/ 00038000
*/*                                                                  */ 00039000
*/* SEGMENT NAME -  ACESTAE                                          */ 00040000
*/*                                                                  */ 00041000
*/* DESCRIPTIVE NAME - ALLOCATE CATALOG RTN ESTAE SETUP              */ 00042000
*/*                                                                  */ 00043000
*/* FUNCTION - OBTAIN AND INITIALIZE THE ESTAE EXIT PARMLIST.        */ 00044000
*/*            SET UP APPROPRIATE ESTAE ENVIRONMENT          @Z40FPPG*/ 00045000
*/*                                                                  */ 00046000
*/*    OPERATION - 1. ISSUE GETMAIN FOR PARMLIST                     */ 00047000
*/*                2. INITIALIZE FIELDS WITHIN PARMLIST              */ 00048000
*/*                3. SET UP ENVIRONMENT                     @Z40FPPG*/ 00049000
*/*                4. SET FAILING RETURN AND REASON CODES.           */ 00050000
*/*                                                                  */ 00051000
*/* ENTRY - INLINE SEGMENT                                           */ 00052000
*/*                                                                  */ 00053000
*/*    INPUT - SEGMENT USES INPUT TO IEFAB4F5 TO INITIALIZE PARMLIST */ 00054000
*/*                                                                  */ 00055000
*/* EXIT - N/A                                                       */ 00056000
*/*                                                                  */ 00057000
*/*    CONDITION - IF SUCCESSFUL ,RSCD = 0                           */ 00058000
*/*                IF UNSUCCESSFUL,  RSCD = 16                       */ 00059000
*/*                                                                  */ 00060000
*/*    OUTPUT DATA - INITIALIZED ESTAE PARMLIST                      */ 00061000
*/*                                                                  */ 00062000
*/*    RETURN CODE - 0 SUCCESS, 8 FAILURE                            */ 00063000
*/*                                                                  */ 00064000
*/********************************************************************/ 00065000
*                                                               02S0058 00066000
*                                                               02S0058 00067000
*/********************************************************************/ 00068000
*                                                               02S0058 00069000
*   SBPOOL=SUBPOOOL;                /* SET SUBPOOL NUMBER            */ 00070000
         MVI   SBPOOL,X'E6'                                     02S0058 00071000
*   LENTH=LENGTH(EPARMLST);         /* LENGTH OF ESTAE PARMLIST      */ 00072000
         MVC   LENTH(3),@CF01110+1                              02S0059 00073000
*   REG0=SPLEN;                     /* SET SUBPOOL+LENGTH IN REG 0   */ 00074000
         L     REG0,SPLEN                                       02S0060 00075000
*   GEN(GETMAIN R,LV=(0));                                      02S0061 00076000
         GETMAIN R,LV=(0)                                               00077000
*   EPRMLSTP=REG1;                                              02S0062 00078000
         LR    EPRMLSTP,REG1                                    02S0062 00079000
*   RFY                                                         02S0063 00080000
*    (RTCDREG) RSTD;                /*                       @Z40FPPG*/ 00081000
*   EECNTRLS=0;                     /* CLEAR CONTROLS                */ 00082000
         SLR   @14,@14                                          02S0064 00083000
         ST    @14,EECNTRLS(,EPRMLSTP)                          02S0064 00084000
*   IF ACNOENQ=ON THEN              /* ENQ ON TIOT                   */ 00085000
         L     @14,@PC00001                                     02S0065 00086000
         TM    ACNOENQ(@14),B'00000010'                         02S0065 00087000
         BNO   @RF00065                                         02S0065 00088000
*     EEDNENQT=ON;                  /* ONLY IF CALLER DIDN'T         */ 00089000
         OI    EEDNENQT(EPRMLSTP),B'00000001'                   02S0066 00090000
*   IF ACNUJSCB=ON THEN             /* REINSTATE JSCB PTR(S) IF      */ 00091000
@RF00065 L     @14,@PC00001                                     02S0067 00092000
         TM    ACNUJSCB(@14),B'00000001'                        02S0067 00093000
         BNO   @RF00067                                         02S0067 00094000
*     EERAJSCP=ON;                  /* SWITCHING WAS ALLOWED         */ 00095000
         OI    EERAJSCP(EPRMLSTP),B'00000100'                   02S0068 00096000
*   IF ACRECOVR=ON THEN             /* CATALOG UNALLOCATION          */ 00097000
@RF00067 L     @14,@PC00001                                     02S0069 00098000
         TM    ACRECOVR(@14),B'00100000'                        02S0069 00099000
         BNO   @RF00069                                         02S0069 00100000
*     DO;                           /* ALLOWED                       */ 00101000
*       EEUALCAT=ON;                /* UNALLOCATE ALL PVT.CATALOGS   */ 00102000
*       EECLACAT=ON;                /* CLOSE ALL PVT.CATALOGS        */ 00103000
*       EEFAPCCB=ON;                /* FREE ALL PVT.CATALOG PCCBS    */ 00104000
         OI    EEUALCAT(EPRMLSTP),B'11100000'                   02S0073 00105000
*     END;                                                      02S0074 00106000
*   ELSE                                                        02S0075 00107000
*     EEDYNAM=ON;                   /* DO NOT ALLOW CATALOG     02S0075 00108000
*                                      UNALLOCATION - DYN.ALLOC.     */ 00109000
         B     @RC00069                                         02S0075 00110000
@RF00069 OI    EEDYNAM(EPRMLSTP),B'00000010'                    02S0075 00111000
*   ECJSCBP=JSCBPTR;                /* CURRENT JSCBPTR               */ 00112000
@RC00069 L     @14,@PC00001+8                                   02S0076 00113000
         L     @14,JSCBPTR(,@14)                                02S0076 00114000
         ST    @14,ECJSCBP(,EPRMLSTP)                           02S0076 00115000
*   EAJSCBP=JSCBPTR->JSCBACT;       /* ACTIVE JSCB PTR               */ 00116000
         L     @14,JSCBACT(,@14)                                02S0077 00117000
         ST    @14,EAJSCBP(,EPRMLSTP)                           02S0077 00118000
*                                                               03S0078 00119000
*/********************************************************************/ 00120000
*/*                                                          @Z40FPPG*/ 00121000
*/* SEGMENT NAME - ESTAECOD                                  @Z40FPPG*/ 00122000
*/*                                                          @Z40FPPG*/ 00123000
*/* DESCRIPTIVE NAME - ESTAE CODE                            @Z40FPPG*/ 00124000
*/*                                                          @Z40FPPG*/ 00125000
*/* FUNCTION - SET UP THE APPROPRIATE ESTAE ENVIRONMENT      @Z40FPPG*/ 00126000
*/*                                                          @Z40FPPG*/ 00127000
*/* OPERATION -                                              @Z40FPPG*/ 00128000
*/*          . AN ALLOCATION STAE WORK AREA (ASWA) IS FILLED @Z40FPPG*/ 00129000
*/*            IN. THIS ALLOWS THE ALLOCATION COMMON ESTAE   @Z40FPPG*/ 00130000
*/*            EXIT (IEFAB4ED) TO ROUTE CONTROL TO THE       @ZA18154*/ 00131000
*/*            APPROPRIATE EXIT ROUTINES FOR SPECIFIC        @Z40FPPG*/ 00132000
*/*            RECOVERY PROCESSING.                          @Z40FPPG*/ 00133000
*/*          . AN ESTAE IS ALWAYS ISSUED AND AN ASWA ALWAYS  @ZA18154*/ 00134000
*/*            CREATED WHEN THIS ROUTINE IS INVOKED. THE ASWA@ZA18154*/ 00135000
*/*            HOWEVER IS NEVER CHAINED TO AN EXISTING ASWA  @ZA18154*/ 00136000
*/*            NOR TO JSCBASWA. THIS IS DONE BECAUSE THERE IS@ZA18154*/ 00137000
*/*            NO WAY TO SERIALIZE ON THIS CHAIN. THUS IF AN @ZA18154*/ 00138000
*/*            ERROR OCCURS, THE ESTAE ISSUED BY THIS ROUTINE@ZA18154*/ 00139000
*/*            WILL RECEIVE CONTROL THROUGH PERCOLATION OR AS@ZA18154*/ 00140000
*/*            A RESULT OF BEING THE LAST ESTAE ISSUED FOR   @ZA18154*/ 00141000
*/*            THIS TASK. THE ASWA IS BUILT SO THAT IEFAB4ED @ZA18154*/ 00142000
*/*            CAN ROUTE CONTROL TO THE ESTAE EXIT AND       @ZA18154*/ 00143000
*/*            PERFORM ITS OTHER NORMAL FUNCTIONS. SINCE NO  @ZA18154*/ 00144000
*/*            ASWA WILL BE CHAINED TO THE ASWA CREATED BY   @ZA18154*/ 00145000
*/*            THIS ROUTINE ONLY IEFAB4EA WILL RECEIVE       @ZA18154*/ 00146000
*/*            CONTROL.  OTHER ASWAS WILL BE PROCESSED WHEN  @ZA18154*/ 00147000
*/*            THE ESTAE UNDER WHICH THEY ARE PROTECTED IS   @ZA18154*/ 00148000
*/*            PERCOLATED TO.                                @ZA18154*/ 00149000
*/*                                                          @Z40FPPG*/ 00150000
*/* ENTRY - INLINE SUBROUTINE ENTERED AT THE TOP             @Z40FPPG*/ 00151000
*/*                                                          @Z40FPPG*/ 00152000
*/*   PURPOSE - SEE FUNCTION                                 @Z40FPPG*/ 00153000
*/*   INPUT -                                                @Z40FPPG*/ 00154000
*/*        .TCBSTABB - PTR TO CURRENT STAE CONTROL BLOCK     @Z40FPPG*/ 00155000
*/*        .EPRMLSTP - PTR TO PARMS FOR IEFAB4EA             @Z40FPPG*/ 00156000
*/*                                                          @Z40FPPG*/ 00157000
*/* EXIT - INLINE SUBROUTINE THAT EXISTS AT THE BOTTOM       @Z40FPPG*/ 00158000
*/*                                                          @Z40FPPG*/ 00159000
*/*   CONDITION - ESTAE SETUP COMPLETED                      @Z40FPPG*/ 00160000
*/*                                                          @Z40FPPG*/ 00161000
*/*   OUTPUT -                                               @Z40FPPG*/ 00162000
*/*           .ASWA - FILLED IN AND PLACED ON THE CHAIN      @Z40FPPG*/ 00163000
*/*                                                          @Z40FPPG*/ 00164000
*/*   RETURN CODES - RTCDREG HAS ESTAE RETURN CODE           @Z40FPPG*/ 00165000
*/*                  IF ONE WAS ISSUED. (ZERO OTHERWISE)     @Z40FPPG*/ 00166000
*/*                                                          @Z40FPPG*/ 00167000
*/********************************************************************/ 00168000
*                                                               03S0078 00169000
*   RTCDREG=ZERO;                   /* INIT RETURN CODE      @Z40FPPG*/ 00170000
         SLR   RTCDREG,RTCDREG                                  03S0078 00171000
*   ASWAPTR=ADDR(ASWACORE);         /* ADDRESS ASWA CORE     @Z40FPPG*/ 00172000
         LA    ASWAPTR,ASWACORE                                 03S0079 00173000
*   ASWA=ASWA&&ASWA;                /* ZERO OUT ASWA         @Z40FPPG*/ 00174000
         XC    ASWA(40,ASWAPTR),ASWA(ASWAPTR)                   03S0080 00175000
*   ASWAID=CHARASWA;                /* FILL IN BLOCK ID      @Z40FPPG*/ 00176000
         MVC   ASWAID(4,ASWAPTR),@CC00150                       03S0081 00177000
*   ASWACSCT=EXITCSCT;              /* CSECT NAME OF EXIT    @Z40FPPG*/ 00178000
         MVC   ASWACSCT(8,ASWAPTR),@CC00148                     03S0082 00179000
*   ASWARTNP=ADDR(IEFAB4EA);        /* ADDRESS OF EXIT RTN   @Z40FPPG*/ 00180000
         L     @14,@CV00168                                     03S0083 00181000
         STCM  @14,15,ASWARTNP(ASWAPTR)                         03S0083 00182000
*   ASWAPRMS=EPRMLSTP;              /* PARMS FOR THIS EXIT   @Z40FPPG*/ 00183000
         STCM  EPRMLSTP,15,ASWAPRMS(ASWAPTR)                    03S0084 00184000
*   TCBPTR=CURNTCBP;                /* ADDRESS CURRENT TCB   @Z40FPPG*/ 00185000
         L     @14,LOC16PTR                                     03S0085 00186000
         L     @14,TCBLISTP(,@14)                               03S0085 00187000
         L     TCBPTR,CURNTCBP(,@14)                            03S0085 00188000
*   ASWAAUTO=ADDR(AB4EDCOR);        /* 1ST ASWA GIVES W/A    @Z40FPPG*/ 00189000
         LA    @14,AB4EDCOR                                     03S0086 00190000
         STCM  @14,15,ASWAAUTO(ASWAPTR)                         03S0086 00191000
*   ASWANOCH=ON;                    /* INDICATE ASWA NOT CHAINED TO     00192000
*                                      JSCBASWA              @ZA18154*/ 00193000
         OI    ASWANOCH(ASWAPTR),B'00001000'                    03S0087 00194000
*   RFY                                                         03S0088 00195000
*    (REG2,                                                     03S0088 00196000
*     REG3) RSTD;                   /* RESTRICT WORK REGS    @Z40FPPG*/ 00197000
*   REG2=ADDR(IEFAB4ED);            /* COMMON ESTAE EXIT     @Z40FPPG*/ 00198000
         L     REG2,@CV00169                                    03S0089 00199000
*   REG3=ASWAPTR;                   /* ASWA IS EXIT PARMS    @Z40FPPG*/ 00200000
         LR    REG3,ASWAPTR                                     03S0090 00201000
*   ESTAECOR(1:ESTAELEN)=ESTAELST(1:ESTAELEN);/* MOVE TO AUTO CORE      00202000
*                                                            @Z40FPPG*/ 00203000
         L     @14,ESTAELEN                                     03S0091 00204000
         BCTR  @14,0                                            03S0091 00205000
         EX    @14,@SM01123                                     03S0091 00206000
*   GEN REFS(ESTAECOR) SETS(RTCDREG,TCBSTABB);                  03S0092 00207000
      ESTAE (2),PARAM=(3),RECORD=YES,TERM=YES,MF=(E,ESTAECOR)           00208000
*   RFY                                                         03S0093 00209000
*    (REG2,                                                     03S0093 00210000
*     REG3) UNRSTD;                                             03S0093 00211000
*   IF RTCDREG=ZERO THEN            /* IF ESTAE SUCCESSFUL   @Z40FPPG*/ 00212000
         LTR   RTCDREG,RTCDREG                                  03S0094 00213000
         BNZ   @RF00094                                         03S0094 00214000
*     ASWASCBP=TCBSTABB;            /* CURRENT SCB @         @Z40FPPG*/ 00215000
         L     @14,TCBSTABB-1(,TCBPTR)                          03S0095 00216000
         LA    @14,0(,@14)                                      03S0095 00217000
         STCM  @14,15,ASWASCBP(ASWAPTR)                         03S0095 00218000
*   IF RTCDREG^=0 THEN              /* ESTAE ENVIRONMENT NOT SET     */ 00219000
@RF00094 LTR   RTCDREG,RTCDREG                                  02S0096 00220000
         BZ    @RF00096                                         02S0096 00221000
*     DO;                           /* - FAILING SITUATION           */ 00222000
*       RFY                                                     02S0098 00223000
*        (REG0,                                                 02S0098 00224000
*         REG1) RSTD;                                           02S0098 00225000
*       REG0=SPLEN;                 /* SET SUBPOOL+LENGTH IN REG 0   */ 00226000
         L     REG0,SPLEN                                       02S0099 00227000
*       REG1=EPRMLSTP;              /* PTR TO PARMLIST               */ 00228000
         LR    REG1,EPRMLSTP                                    02S0100 00229000
*       GEN(FREEMAIN R,LV=(0),A=(1));                           02S0101 00230000
         FREEMAIN R,LV=(0),A=(1)                                        00231000
*       RFY                                                     02S0102 00232000
*        (REG0,                                                 02S0102 00233000
*         REG1) UNRSTD;                                         02S0102 00234000
*       RTCD=STPERROR;              /* 8 - ESTAE ENVIRONMENT-        */ 00235000
         MVC   RTCD(2),@CH00075                                 02S0103 00236000
*       RSCD=ESTAEERR;              /* 16 - ESTABLISHMENT ERROR      */ 00237000
         MVC   RSCD(2),@CH00059                                 02S0104 00238000
*     END;                                                      02S0105 00239000
*   RFY                                                         02S0106 00240000
*    (RTCDREG) UNRSTD;              /*                       @Z40FPPG*/ 00241000
@RF00096 DS    0H                                               02S0107 00242000
*   IF RTCD=0 THEN                  /* ESTAE ENVIRONMENT SET         */ 00243000
         SLR   @10,@10                                          01S0107 00244000
         CH    @10,RTCD                                         01S0107 00245000
         BNE   @RF00107                                         01S0107 00246000
*     DO;                                                       01S0108 00247000
*       SAVJSCBP=JSCBACT;           /* SAVE ACTIVE JSCB PTR          */ 00248000
         L     @07,@PC00001+8                                   01S0109 00249000
         L     @07,JSCBPTR(,@07)                                01S0109 00250000
         L     @05,JSCBACT(,@07)                                01S0109 00251000
         ST    @05,SAVJSCBP                                     01S0109 00252000
*       IF ACNUJSCB=ON THEN         /* ALLOCATE CTG TO ACTIVE TASK   */ 00253000
         L     @05,@PC00001                                     01S0110 00254000
         TM    ACNUJSCB(@05),B'00000001'                        01S0110 00255000
         BNO   @RF00110                                         01S0110 00256000
*         DO;                                                   01S0111 00257000
*           DO;                     /* MODESET KEYADDR(0)            */ 00258000
*             SPKA(0);              /* SET PSW KEY                   */ 00259000
         SPKA  0(@10)                                           01S0113 00260000
*           END;                    /* MODESET KEYADDR(0) KEY 0 TO      00261000
*                                      ALTER JSCB                    */ 00262000
*           JSCBACT=JSCBPTR;        /* NEW ACTIVE JSCB               */ 00263000
         ST    @07,JSCBACT(,@07)                                01S0115 00264000
*           DO;                     /* MODESET EXTKEY(SCHED)         */ 00265000
*             SPKA(16);             /* SET PSW KEY                   */ 00266000
         LA    @10,16                                           01S0117 00267000
         SPKA  0(@10)                                           01S0117 00268000
*           END;                    /* MODESET EXTKEY(SCHED) BACK TO    00269000
*                                      KEY 1                         */ 00270000
*         END;                                                  01S0119 00271000
*       DDNAMPTR=0;                 /* DDNAME NOT CREATED YET        */ 00272000
@RF00110 SLR   @10,@10                                          01S0120 00273000
         ST    @10,DDNAMPTR                                     01S0120 00274000
*       ACBPTR=0;                   /* NO ACB EXISTS YET             */ 00275000
         ST    @10,ACBPTR                                       01S0121 00276000
*       VSERPTR=0;                  /* NO VOLUME SERIAL OF CATALOG   */ 00277000
         ST    @10,VSERPTR                                      01S0122 00278000
*       PCCNTRLS=0;                 /* CONTROLS FOR PCCB ROUTINE     */ 00279000
         STH   @10,PCCNTRLS                                     01S0123 00280000
*       CJUSTALC=OFF;               /* RESET ERROR-CORRECT CONTROLS  */ 00281000
         NI    CJUSTALC,B'01111111'                             01S0124 00282000
*       CATSUNAL=OFF;               /* RESET 'CATALOGS UNALLOCATED'  */ 00283000
         NI    CATSUNAL,B'01111111'                             01S0125 00284000
*       CTGOPEND=OFF;                                           01S0126 00285000
         NI    CTGOPEND,B'01111111'                             01S0126 00286000
*       ALOCOPEN=ON;                /* ALOC,OPEN CATLG       @ZA00870*/ 00287000
         OI    ALOCOPEN,B'10000000'                             01S0127 00288000
*       CATALCTD=OFF;               /* RESET 'ANY-CATLG-ALLOCATED'   */ 00289000
         NI    CATALCTD,B'01111111'                             01S0128 00290000
*       NQCORE(1:NQLENGTH)=PCNQLIST(1:NQLENGTH);/* ENQ LST TO DSECT     00291000
*                                                            @ZA00870*/ 00292000
         L     @10,NQLENGTH                                     01S0129 00293000
         BCTR  @10,0                                            01S0129 00294000
         EX    @10,@SM01127                                     01S0129 00295000
*       GEN REFS(NQCORE);                                       01S0130 00296000
*                                     /*                    @ZA00870*/  00297000
      ENQ    MF=(E,NQCORE)            /*                    @ZA00870*/  00298000
*       PCCBPTR=SAVJSCBP->JSCBPCC;  /* FIRST PCCB ADDRESS ACCURATE      00299000
*                                      ONLY AFTER ENQUEUE    @ZA00870*/ 00300000
         L     @10,SAVJSCBP                                     01S0131 00301000
         L     PCCBPTR,JSCBPCC(,@10)                            01S0131 00302000
*       DO WHILE(PCCBPTR^=0&(CATALCTD=OFF|ALOCOPEN=ON));/*   @ZA00870*/ 00303000
         B     @DE00132                                         01S0132 00304000
@DL00132 DS    0H                                               01S0133 00305000
*         IF PCCDDNAM(1:4)^=0 THEN  /* A CATLG IS ALLOC'D    @ZA00870*/ 00306000
         ICM   @10,15,PCCDDNAM(PCCBPTR)                         01S0133 00307000
         BZ    @RF00133                                         01S0133 00308000
*           CATALCTD=ON;                                        01S0134 00309000
         OI    CATALCTD,B'10000000'                             01S0134 00310000
*         IF CTGDSN=PCCDSNAM THEN   /* PCCB FOR THIS CATLG?  @ZA00870*/ 00311000
@RF00133 L     @10,@PC00001+12                                  01S0135 00312000
         L     @10,CTGDSNP(,@10)                                01S0135 00313000
         CLC   CTGDSN(44,@10),PCCDSNAM(PCCBPTR)                 01S0135 00314000
         BNE   @RF00135                                         01S0135 00315000
*           DO;                     /* YES.                  @ZA00870*/ 00316000
*             IF PCCDDNAM(1:4)^=0 THEN/* IS THE CATALOG ALLOCATED?      00317000
*                                                            @ZA00870*/ 00318000
         SLR   @10,@10                                          01S0137 00319000
         ICM   @07,15,PCCDDNAM(PCCBPTR)                         01S0137 00320000
         CLR   @10,@07                                          01S0137 00321000
         BE    @RF00137                                         01S0137 00322000
*               DO;                 /* YES.                  @ZA00870*/ 00323000
*                 ALOCOPEN=OFF;     /* DON'T ALLOC OR OPEN@ZA00870   */ 00324000
         NI    ALOCOPEN,B'01111111'                             01S0139 00325000
*                 ACBPTR=0;         /* GIVE PCCB ROUTINE     @ZA00870*/ 00326000
         ST    @10,ACBPTR                                       01S0140 00327000
*                 DDNAMPTR=0;       /* 0 PTRS SO IT CAN      @ZA00870*/ 00328000
         ST    @10,DDNAMPTR                                     01S0141 00329000
*               END;                /* HANDLE ALIAS PCCB     @ZA00870*/ 00330000
*           END;                    /*                       @ZA00870*/ 00331000
@RF00137 DS    0H                                               01S0144 00332000
*         PCCBPTR=PCCNEXTP;         /* GET NEXT PCCB, IF ANY.   01S0144 00333000
*                                                            @ZA00870*/ 00334000
@RF00135 L     PCCBPTR,PCCNEXTP(,PCCBPTR)                       01S0144 00335000
*       END;                        /* PCCB SEARCH LOOP      @ZA00870*/ 00336000
@DE00132 LTR   PCCBPTR,PCCBPTR                                  01S0145 00337000
         BZ    @DC00132                                         01S0145 00338000
         TM    CATALCTD,B'10000000'                             01S0145 00339000
         BZ    @DL00132                                         01S0145 00340000
         TM    ALOCOPEN,B'10000000'                             01S0145 00341000
         BO    @DL00132                                         01S0145 00342000
@DC00132 DS    0H                                               01S0146 00343000
*       GEN REFS(NQCORE);                                       01S0146 00344000
*                                     /*                    @ZA00870*/  00345000
      DEQ    MF=(E,NQCORE)            /*                    @ZA00870*/  00346000
*       IF ALOCOPEN=ON THEN         /* CTLG ALREADY ALLOC & OPEN?       00347000
*                                                            @ZA00870*/ 00348000
         TM    ALOCOPEN,B'10000000'                             01S0147 00349000
         BNO   @RF00147                                         01S0147 00350000
*         DO;                       /* NO                    @ZA00870*/ 00351000
*           IF ACALCTLG=ON THEN     /* SET UP TO DYNAMICALLY         */ 00352000
         L     @10,@PC00001                                     01S0149 00353000
         TM    ACALCTLG(@10),B'00100000'                        01S0149 00354000
         BNO   @RF00149                                         01S0149 00355000
*             DO;                   /* ALLOCATE THE CATALOG          */ 00356000
*                                                               02S0151 00357000
*/********************************************************************/ 00358000
*/*                                                                  */ 00359000
*/* SEGMENT NAME - ALCATLG                                           */ 00360000
*/*                                                                  */ 00361000
*/* DESCRIPTIVE NAME - ALLOCATE CATALOG INTERFACE                    */ 00362000
*/*                                                                  */ 00363000
*/* FUNCTION - PREPARES THE PARAMETER AREA FOR DYNAMIC ALLOCATION    */ 00364000
*/*            OF A CATALOG AND REQUESTS ALLOCATION (SVC 99)         */ 00365000
*/*                                                                  */ 00366000
*/*   OPERATION -                                                    */ 00367000
*/*            THE WAIT-FOR-VOLUMES/DEVICES BITS IN THE INPUT        */ 00368000
*/*            PARAMETERS WILL BE MAPPED INTO THE DYNAMIC ALLOCATION */ 00369000
*/*            REQUEST BLOCK (PARAMETER AREA) ONLY IF NO OTHER       */ 00370000
*/*            CATALOGS ARE ALLOCATED TO THIS STEP ( PCCBS, IF ANY,  */ 00371000
*/*            HAVE NO CATALOG DD NAME).                             */ 00372000
*/*            THE POINTERS,COMMANDS,TEXT UNITS ETC. ARE INITIALIZED */ 00373000
*/*            IN THE AFOREMENTIONED REQUEST BLOCK.                  */ 00374000
*/*            THE REQUEST BLOCK IS ADDRESSED BY REGISTER 1 AND      */ 00375000
*/*            SVC 99 IS ISSUED.                                     */ 00376000
*/*            RECOVERABLE RETURN CODES (VOLUME REQUESTED OR DEVICES */ 00377000
*/*            ARE UNAVAILABLE), IF AUTHORIZED BY THE CALLER, WILL   */ 00378000
*/*            CAUSE SEGMENT 'RECOVERY' TO ATTEMPT UNALLOCATION OF   */ 00379000
*/*            ALL CATALOGS TO FREE SYSTEM RESOURCES AND, IF         */ 00380000
*/*            AUTHORIZED BY THE CALLER (STEP INITIATION), ALLOW     */ 00381000
*/*            WAITING FOR VOLUMES OR DEVICES AND REISSUE SVC99.     */ 00382000
*/*            OTHER ERRORS WILL TERMINATE PROCESSING WITH           */ 00383000
*/*            RETURN/REASON CODES PASSED BACK TO THE CALLER.        */ 00384000
*/*            A POINTER IS INITIALIZED TO THE DDNAME RETURNED BY    */ 00385000
*/*            DYNAMIC ALLOCATION AS RESULT OF SUCCESSFUL            */ 00386000
*/*            ALLOCATION OF THE PRIVATE CATALOG.                    */ 00387000
*/*                                                                  */ 00388000
*/* ENTRY - IF CATALOG IS TO BE ALLOCATED                            */ 00389000
*/*                                                                  */ 00390000
*/*   PURPOSE - SEE FUNCTION                                         */ 00391000
*/*                                                                  */ 00392000
*/*   INPUT DATA - SAME AS INPUT TO IEFAB4F5                         */ 00393000
*/*                                                                  */ 00394000
*/* EXIT - IN LINE                                                   */ 00395000
*/*                                                                  */ 00396000
*/*   CONDITION - ALL                                                */ 00397000
*/*                                                                  */ 00398000
*/*   OUTPUT DATA - DDNAME POINTER OR                                */ 00399000
*/*               - REASON CODES MAPPED FROM REG15 IN CASE OF ERROR  */ 00400000
*/*               - OR REASON CODE OF 1 IF CATALOG MOUNT REQUIRED    */ 00401000
*/*               - AND NOT AUTHORIZED                               */ 00402000
*/*   RETURN CODE - 0 SUCCESS                                        */ 00403000
*/*               - 4 FAILURE                                        */ 00404000
*/*               - 8 CATALOG MOUNT NEEDED AND NOT AUTHORIZED        */ 00405000
*/********************************************************************/ 00406000
*                                                               02S0151 00407000
*               S99RB=S99RB&&S99RB; /* CLEAR PARAMETER AREA          */ 00408000
         XC    S99RB(20),S99RB                                  02S0151 00409000
*               S99RBPTR=ADDR(S99RB);/* REQUEST BLOCK POINTER        */ 00410000
         LA    @07,S99RB                                        02S0152 00411000
         ST    @07,S99RBPTR                                     02S0152 00412000
*               S99RBPND=ON;        /* ONE REQUEST BLOCK             */ 00413000
         OI    S99RBPND,B'10000000'                             02S0153 00414000
*               S99RBLN=LENGTH(S99RB);/* REQUEST BLOCK LENGTH        */ 00415000
         MVI   S99RBLN,X'14'                                    02S0154 00416000
*               S99VERB=S99VRBAL;   /* VERB - ALLOCATE               */ 00417000
         MVI   S99VERB,X'01'                                    02S0155 00418000
*               S99NOCNV=ON;        /* NEW ALLOCATION ONLY           */ 00419000
         OI    S99NOCNV,B'01000000'                             02S0156 00420000
*               S99NORES=ON;        /* DO NO DSNAME ENQUEUE          */ 00421000
         OI    S99NORES,B'00100000'                             02S0157 00422000
*               S99TXTPP=ADDR(UNITPTR(1));/* PTR TO TEXT UNIT   02S0158 00423000
*                                      POINTERS                      */ 00424000
         LA    @07,UNITPTR                                      02S0158 00425000
         ST    @07,S99TXTPP                                     02S0158 00426000
*               UNITPTR(1)=ADDR(UNIT1);/* SET THE TEXT UNIT POINTERS */ 00427000
         LA    @07,UNIT1                                        02S0159 00428000
         ST    @07,UNITPTR                                      02S0159 00429000
*               UNITPTR(2)=ADDR(UNIT2);/* TO POINT TO MY DATA        */ 00430000
         LA    @07,UNIT2                                        02S0160 00431000
         ST    @07,UNITPTR+4                                    02S0160 00432000
*               UNITPTR(3)=ADDR(UNIT3);                         02S0161 00433000
         LA    @07,UNIT3                                        02S0161 00434000
         ST    @07,UNITPTR+8                                    02S0161 00435000
*               UNITPTR(4)=ADDR(UNIT4);                         02S0162 00436000
         LA    @07,UNIT4                                        02S0162 00437000
         ST    @07,UNITPTR+12                                   02S0162 00438000
*               LASTPTR(4)=ON;      /* LAST TEXT UNIT PTR IND.       */ 00439000
         OI    LASTPTR+12,B'10000000'                           02S0163 00440000
*               UNITPTR(1)->S99TUKEY=DALDSNAM;/* KEY OF DSNAME       */ 00441000
         L     @07,UNITPTR                                      02S0164 00442000
         MVC   S99TUKEY(2,@07),@CB00317                         02S0164 00443000
*               UNITPTR(1)->S99TUNUM=1;/* ONE PARAMETER IN TEXT UNIT */ 00444000
         LA    @05,1                                            02S0165 00445000
         STCM  @05,3,S99TUNUM(@07)                              02S0165 00446000
*               UNITPTR(1)->S99TULNG=LENGTH(CTGDSN);/* LENGTH OF PARM   00447000
*                                      - 44                          */ 00448000
         MVC   S99TULNG(2,@07),@CH00108                         02S0166 00449000
*               DSNPARM=CTGDSN;     /* DSNAME TO ALLOCATE            */ 00450000
         L     @07,@PC00001+12                                  02S0167 00451000
         L     @07,CTGDSNP(,@07)                                02S0167 00452000
         MVC   DSNPARM(44),CTGDSN(@07)                          02S0167 00453000
*               UNITPTR(2)->S99TUKEY=DALSTATS;/* KEY OF STATUS -        00454000
*                                      SHARE                         */ 00455000
         L     @07,UNITPTR+4                                    02S0168 00456000
         MVC   S99TUKEY(2,@07),@CB00321                         02S0168 00457000
*               UNITPTR(2)->S99TUNUM=1;/* ONE PARAMETER              */ 00458000
         STCM  @05,3,S99TUNUM(@07)                              02S0169 00459000
*               UNITPTR(2)->S99TULNG=1;/* STATUS IS ONE BYTE         */ 00460000
         STCM  @05,3,S99TULNG(@07)                              02S0170 00461000
*               UNIT2(7)=SHRDISP;   /* DISPOSITION - SHARE           */ 00462000
         LA    @07,8                                            02S0171 00463000
         STC   @07,UNIT2+6                                      02S0171 00464000
*               UNITPTR(3)->S99TUKEY=DALRTDDN;/* KEY OF DD NAME 02S0172 00465000
*                                      RETURN                        */ 00466000
         L     @03,UNITPTR+8                                    02S0172 00467000
         MVC   S99TUKEY(2,@03),@CB00483                         02S0172 00468000
*               UNITPTR(3)->S99TUNUM=1;/* ONE PARAMETER              */ 00469000
         STCM  @05,3,S99TUNUM(@03)                              02S0173 00470000
*               UNITPTR(3)->S99TULNG=LENGTH(DDNAME);/* DDNAME RETURN    00471000
*                                      AREA                          */ 00472000
         STCM  @07,3,S99TULNG(@03)                              02S0174 00473000
*               UNITPTR(4)->S99TUKEY=DALRTVOL;/* KEY TO REQUEST 02S0175 00474000
*                                      VOLUME SERIAL                 */ 00475000
         L     @07,UNITPTR+12                                   02S0175 00476000
         MVC   S99TUKEY(2,@07),@CB00499                         02S0175 00477000
*               UNITPTR(4)->S99TUNUM=1;/* ONE PARAMETER              */ 00478000
         STCM  @05,3,S99TUNUM(@07)                              02S0176 00479000
*               UNITPTR(4)->S99TULNG=LENGTH(CATVSER);/* VOL-SER 02S0177 00480000
*                                      RETURN AREA                   */ 00481000
         MVC   S99TULNG(2,@07),@CH00106                         02S0177 00482000
*               PCCBPTR=SAVJSCBP->JSCBPCC;/* FIRST PCCB IF ANY       */ 00483000
         L     @07,SAVJSCBP                                     02S0178 00484000
         L     PCCBPTR,JSCBPCC(,@07)                            02S0178 00485000
*               IF ACNODD=ON THEN   /* NO DD SHOULD BE CREATED BY    */ 00486000
         TM    ACNODD(@10),B'10000000'                          02S0179 00487000
         BNO   @RF00179                                         02S0179 00488000
*                 S99CATLG=ON;      /* DYNAMIC ALLOC FOR THIS CATLG  */ 00489000
         OI    S99CATLG,B'00000010'                             02S0180 00490000
*               ELSE                /* ALLOCATION FOR BATCH  @Y30QPPB*/ 00491000
*                 S99PCINT=ON;      /* TELL SVC 99           @Y30QPPB*/ 00492000
         B     @RC00179                                         02S0181 00493000
@RF00179 OI    S99PCINT,B'01000000'                             02S0181 00494000
*               IF ACNOENQ=ON THEN  /* CAUSE DYNAMIC ALLOCATION NOT  */ 00495000
@RC00179 L     @10,@PC00001                                     02S0182 00496000
         TM    ACNOENQ(@10),B'00000010'                         02S0182 00497000
         BNO   @RF00182                                         02S0182 00498000
*                 S99TIONQ=ON;      /* TO ENQUEUE ON THE TIOT        */ 00499000
         OI    S99TIONQ,B'00000100'                             02S0183 00500000
*               IF ACOFLINE=ON THEN /* DYNAMIC ALLOCATION MAY        */ 00501000
@RF00182 L     @10,@PC00001                                     02S0184 00502000
         TM    ACOFLINE(@10),B'00000100'                        02S0184 00503000
         BNO   @RF00184                                         02S0184 00504000
*                 S99OFFLN=ON;      /* CONSIDER OFFLINE DEVICES      */ 00505000
         OI    S99OFFLN,B'00001000'                             02S0185 00506000
*               IF ACOK2MNT=ON THEN /* CATALOG MOUNT AUTHORIZATION   */ 00507000
@RF00184 L     @10,@PC00001                                     02S0186 00508000
         TM    ACOK2MNT(@10),B'10000000'                        02S0186 00509000
         BNO   @RF00186                                         02S0186 00510000
*                 S99MOUNT=ON;                                  02S0187 00511000
         OI    S99MOUNT,B'00000001'                             02S0187 00512000
*               ELSE                /* MOUNTING NOT ALLOWED@ZA16793  */ 00513000
*                 S99NOMNT=ON;      /* SET NO-MOUNT BIT ON   @ZA16793*/ 00514000
         B     @RC00186                                         02S0188 00515000
@RF00186 OI    S99NOMNT,B'00100000'                             02S0188 00516000
*               IF ACVLWAIT=ON THEN /* WAIT OK FOR VOLUME            */ 00517000
@RC00186 L     @10,@PC00001                                     02S0189 00518000
         TM    ACVLWAIT(@10),B'00001000'                        02S0189 00519000
         BNO   @RF00189                                         02S0189 00520000
*                 S99WTVOL=ON;                                  02S0190 00521000
         OI    S99WTVOL,B'10000000'                             02S0190 00522000
*               IF ACDVWAIT=ON THEN /* WAIT OK FOR UNITS             */ 00523000
@RF00189 L     @10,@PC00001                                     02S0191 00524000
         TM    ACDVWAIT(@10),B'01000000'                        02S0191 00525000
         BNO   @RF00191                                         02S0191 00526000
*                 S99WTUNT=ON;                                  02S0192 00527000
         OI    S99WTUNT,B'00010000'                             02S0192 00528000
*               IF(ACVLWAIT=ON|     /* WAIT AUTHORIZED ONLY          */ 00529000
*                   ACDVWAIT=ON)&   /* IF NO CATALOGS ALLOCATED.     */ 00530000
*                   CATALCTD=ON THEN/* CATALOG IS ALLOCATED, @ZA00870*/ 00531000
@RF00191 L     @10,@PC00001                                     02S0193 00532000
         TM    ACVLWAIT(@10),B'01001000'                        02S0193 00533000
         BZ    @RF00193                                         02S0193 00534000
         TM    CATALCTD,B'10000000'                             02S0193 00535000
         BNO   @RF00193                                         02S0193 00536000
*                 DO;               /* INSURE THERE ARE NO           */ 00537000
*                   S99WTVOL=OFF;   /* WAIT AUTHORIZATIONS           */ 00538000
*                   S99WTUNT=OFF;                               02S0196 00539000
         NI    S99WTVOL,B'01101111'                             02S0196 00540000
*                 END;                                          02S0197 00541000
*               PARAMREG=ADDR(S99RBPTR);/* DYNAMIC ALLOCATION PARM      00542000
*                                      AREA                          */ 00543000
@RF00193 LA    PARAMREG,S99RBPTR                                02S0198 00544000
*/* MACDATE Y-2 73082                                                */ 00545000
*                                                               02S0199 00546000
*               SVC(99);            /* DYNAMIC ALLOCATION            */ 00547000
         SVC   99                                               02S0199 00548000
*               RTCD=RTCDREG;       /* SAVE REG15                    */ 00549000
         STH   RTCDREG,RTCD                                     02S0200 00550000
*               IF RTCD=RECOVER&    /* RECOVERABLE ERROR (UNITS      */ 00551000
*                   (S99ERROR=NOUNIT|S99ERROR=NOVOL)&/* OR VOLUMES)  */ 00552000
*                   ACRECOVR=ON THEN/* AND 'RECOVERY AUTHORIZED'     */ 00553000
         LH    @10,RTCD                                         02S0201 00554000
         C     @10,@CF00063                                     02S0201 00555000
         BNE   @RF00201                                         02S0201 00556000
         CLC   S99ERROR(2),@CB00134                             02S0201 00557000
         BE    @GL00004                                         02S0201 00558000
         CLC   S99ERROR(2),@CB00138                             02S0201 00559000
         BNE   @RF00201                                         02S0201 00560000
@GL00004 L     @10,@PC00001                                     02S0201 00561000
         TM    ACRECOVR(@10),B'00100000'                        02S0201 00562000
         BNO   @RF00201                                         02S0201 00563000
*                 DO;                                           02S0202 00564000
*                                                               03S0203 00565000
*/********************************************************************/ 00566000
*/*                                                                  */ 00567000
*/* SEGMENT NAME - RECOVERY                                          */ 00568000
*/*                                                                  */ 00569000
*/* DESCRIPTIVE NAME - RECOVERABLE RETURN CODE PROCESSING            */ 00570000
*/*                                                                  */ 00571000
*/* FUNCTION - UNALLOCATE ALLOCATED CATALOGS TO MAKE SYSTEM          */ 00572000
*/*            RESOURCES AVAILABLE TO DYNAMIC ALLOCATION TO MOUNT    */ 00573000
*/*            THE VOLUME REQUESTED AND/OR TO BE ABLE TO WAIT FOR    */ 00574000
*/*            ACCESS TO THE REQUIRED VOLUME.                        */ 00575000
*/*                                                                  */ 00576000
*/* OPERATION- THE PCCB CHAIN IS SCANNED AND IF ANY CATALOGS ARE     */ 00577000
*/*            ALLOCATED: - ALL CATALOGS WILL BE UNALLOCATED BY      */ 00578000
*/*                           IEFAB4F4 - CATALOG UNALLOCATION        */ 00579000
*/*                       IF NO ERROR DETECTED BY UNALLOCATION, THEN */ 00580000
*/*                       - WAIT AUTHORIZATION, IF REQUESTED, AND A  */ 00581000
*/*                           ZERO REASON CODE ARE PLACED INTO THE   */ 00582000
*/*                           DYNAMIC ALLOCATION PARAMETER AREA,     */ 00583000
*/*                           AND THE SVC 99 IS REISSUED.            */ 00584000
*/*                       - RETURN/REASON CODES ARE SET IF THE       */ 00585000
*/*                           CATALOG STILL CANNOT BE ALLOCATED.     */ 00586000
*/*                                                                  */ 00587000
*/* ENTRY - IF RECOVERABLE RETURN CODES FROM SVC 99                  */ 00588000
*/*                                                                  */ 00589000
*/*   PURPOSE - UNALLOCATE CATALOGS TO OBTAIN RESOURCES              */ 00590000
*/*                                                                  */ 00591000
*/*   INPUT DATA - RETURN CODE AND PCCBS                             */ 00592000
*/*                                                                  */ 00593000
*/* EXIT - IN LINE                                                   */ 00594000
*/*                                                                  */ 00595000
*/*   CONDITION - CATALOG ALLOCATED OR ERROR                         */ 00596000
*/*                                                                  */ 00597000
*/*   OUTPUT DATA - REASON CODES FROM REG 15 FROM CALLED ROUTINES    */ 00598000
*/*                                                                  */ 00599000
*/*   RETURN CODE - 0 SUCCESSFUL ALLOCATION                          */ 00600000
*/*                 4 ERROR                                          */ 00601000
*/********************************************************************/ 00602000
*                                                               03S0203 00603000
*                   GEN REFS(NQCORE);                           03S0203 00604000
      ENQ    MF=(E,NQCORE)                                              00605000
*                   CATALCTD=OFF;   /* SVC 99 REISSUE CONTROL        */ 00606000
         NI    CATALCTD,B'01111111'                             03S0204 00607000
*                   PCCBPTR=SAVJSCBP->JSCBPCC;/* ADDRESS OF FIRST       00608000
*                                      PCCB                          */ 00609000
         L     @10,SAVJSCBP                                     03S0205 00610000
         L     PCCBPTR,JSCBPCC(,@10)                            03S0205 00611000
*                   DO WHILE(CATALCTD=OFF&/* SCAN PCCB(S) FOR AN        00612000
*                                      ALLOCATED                     */ 00613000
*                         PCCBPTR^=0);/* CATALOG..(DDNAME PRESENT).  */ 00614000
         B     @DE00206                                         03S0206 00615000
@DL00206 DS    0H                                               03S0207 00616000
*                     IF PCCDDNAM(1:4)^=0 THEN/* THIS CATALOG IS        00617000
*                                      ALLOCATED                     */ 00618000
         ICM   @10,15,PCCDDNAM(PCCBPTR)                         03S0207 00619000
         BZ    @RF00207                                         03S0207 00620000
*                       CATALCTD=ON;/* SVC 99 WILL BE REISSUED       */ 00621000
         OI    CATALCTD,B'10000000'                             03S0208 00622000
*                     PCCBPTR=PCCNEXTP;/* NEXT PCCB                  */ 00623000
@RF00207 L     PCCBPTR,PCCNEXTP(,PCCBPTR)                       03S0209 00624000
*                   END;                                        03S0210 00625000
@DE00206 TM    CATALCTD,B'10000000'                             03S0210 00626000
         BNZ   @DC00206                                         03S0210 00627000
         LTR   PCCBPTR,PCCBPTR                                  03S0210 00628000
         BNZ   @DL00206                                         03S0210 00629000
@DC00206 DS    0H                                               03S0211 00630000
*                   GEN REFS(NQCORE);                           03S0211 00631000
      DEQ    MF=(E,NQCORE)                                              00632000
*                   IF CATALCTD=ON THEN/* CATALOG(S) ARE AVAILABLE      00633000
*                                      FOR                           */ 00634000
         TM    CATALCTD,B'10000000'                             03S0212 00635000
         BNO   @RF00212                                         03S0212 00636000
*                     DO;           /* UNALLOCATION                  */ 00637000
*                       RETCOD=0;   /* RECOVERY MAY BE SUCCESSFUL    */ 00638000
         SLR   @10,@10                                          03S0214 00639000
         STCM  @10,15,RETCOD                                    03S0214 00640000
*                       UCCNTRLS=0; /* SETUP CONTROLS FOR IEFAB4F4.  */ 00641000
         STH   @10,UCCNTRLS                                     03S0215 00642000
*                       UCALLCAT=ON;/* UNALLOCATE ALL CATALOGS, AND  */ 00643000
*                       UCALLACB=ON;/* CLOSE ALL ASSOCIATED ACB(S)   */ 00644000
         OI    UCALLCAT,B'00010100'                             03S0217 00645000
*                       IF ACNOENQ=ON THEN/* TIOT ENQ NOT ALLOWED    */ 00646000
         L     @10,@PC00001                                     03S0218 00647000
         TM    ACNOENQ(@10),B'00000010'                         03S0218 00648000
         BNO   @RF00218                                         03S0218 00649000
*                         UCNTIONQ=ON;                          03S0219 00650000
         OI    UCNTIONQ,B'01000000'                             03S0219 00651000
*                       RETCOD=0;   /* PREVIOUS ERRORS INVALID       */ 00652000
@RF00218 SLR   @10,@10                                          03S0220 00653000
         STCM  @10,15,RETCOD                                    03S0220 00654000
*                       IF ACNUJSCB=ON THEN/* ACTIVE JSCB SWITCHED?     00655000
*                                                            @ZA11903*/ 00656000
         L     @07,@PC00001                                     03S0221 00657000
         TM    ACNUJSCB(@07),B'00000001'                        03S0221 00658000
         BNO   @RF00221                                         03S0221 00659000
*                         DO;       /* POINT ACT TO PP JSCB  @ZA11903*/ 00660000
*                           UCCAJSCB=ON;/* UNALLOC FROM INIT JSCB       00661000
*                                                            @ZA11903*/ 00662000
         OI    UCCAJSCB,B'10000000'                             03S0223 00663000
*                           DO;     /* MODESET KEYADDR(0)            */ 00664000
*                             SPKA(0);/* SET PSW KEY                 */ 00665000
         SPKA  0(@10)                                           03S0225 00666000
*                           END;    /* MODESET KEYADDR(0) KEY ZERO      00667000
*                                                            @ZA11903*/ 00668000
*                           JSCBACT=SAVJSCBP;/* GET INIT JSCB ADDR      00669000
*                                                            @ZA11903*/ 00670000
         L     @10,@PC00001+8                                   03S0227 00671000
         L     @07,JSCBPTR(,@10)                                03S0227 00672000
         L     @05,SAVJSCBP                                     03S0227 00673000
         ST    @05,JSCBACT(,@07)                                03S0227 00674000
*                           DO;     /* MODESET EXTKEY(SCHED)         */ 00675000
*                             SPKA(16);/* SET PSW KEY                */ 00676000
         LA    @07,16                                           03S0229 00677000
         SPKA  0(@07)                                           03S0229 00678000
*                           END;    /* MODESET EXTKEY(SCHED) BACK TO    00679000
*                                      KEY 1                 @ZA11903*/ 00680000
*                           CALL IEFAB4F4(UCCNTRLS,RTCDPTR,0,0,0,       00681000
*                               JSCBPTR);/*                  @ZA11903*/ 00682000
         LA    @07,UCCNTRLS                                     03S0231 00683000
         ST    @07,@AL00001                                     03S0231 00684000
         LA    @07,RTCDPTR                                      03S0231 00685000
         ST    @07,@AL00001+4                                   03S0231 00686000
         LA    @07,@CF00146                                     03S0231 00687000
         ST    @07,@AL00001+8                                   03S0231 00688000
         LA    @07,@CF00146                                     03S0231 00689000
         ST    @07,@AL00001+12                                  03S0231 00690000
         LA    @07,@CF00146                                     03S0231 00691000
         ST    @07,@AL00001+16                                  03S0231 00692000
         ST    @10,@AL00001+20                                  03S0231 00693000
         L     @15,@CV00171                                     03S0231 00694000
         LA    @01,@AL00001                                     03S0231 00695000
         BALR  @14,@15                                          03S0231 00696000
*                           DO;     /* MODESET KEYADDR(0)            */ 00697000
*                             SPKA(0);/* SET PSW KEY                 */ 00698000
         SLR   @10,@10                                          03S0233 00699000
         SPKA  0(@10)                                           03S0233 00700000
*                           END;    /* MODESET KEYADDR(0)    @ZA11903*/ 00701000
*                           JSCBACT=JSCBPTR;/* POINT TO CURRENT JSCB    00702000
*                                                            @ZA11903*/ 00703000
         L     @10,@PC00001+8                                   03S0235 00704000
         L     @10,JSCBPTR(,@10)                                03S0235 00705000
         ST    @10,JSCBACT(,@10)                                03S0235 00706000
*                           DO;     /* MODESET EXTKEY(SCHED)         */ 00707000
*                             SPKA(16);/* SET PSW KEY                */ 00708000
         LA    @10,16                                           03S0237 00709000
         SPKA  0(@10)                                           03S0237 00710000
*                           END;    /* MODESET EXTKEY(SCHED) BACK TO    00711000
*                                      KEY 1                 @ZA11903*/ 00712000
*                         END;      /*                       @ZA11903*/ 00713000
*                       ELSE        /*                       @ZA11903*/ 00714000
*                         CALL IEFAB4F4(UCCNTRLS,RTCDPTR,0,0,0,JSCBPTR) 00715000
*                           ;       /*                       @ZA11903*/ 00716000
         B     @RC00221                                         03S0240 00717000
@RF00221 LA    @10,UCCNTRLS                                     03S0240 00718000
         ST    @10,@AL00001                                     03S0240 00719000
         LA    @10,RTCDPTR                                      03S0240 00720000
         ST    @10,@AL00001+4                                   03S0240 00721000
         LA    @10,@CF00146                                     03S0240 00722000
         ST    @10,@AL00001+8                                   03S0240 00723000
         LA    @10,@CF00146                                     03S0240 00724000
         ST    @10,@AL00001+12                                  03S0240 00725000
         LA    @10,@CF00146                                     03S0240 00726000
         ST    @10,@AL00001+16                                  03S0240 00727000
         L     @10,@PC00001+8                                   03S0240 00728000
         ST    @10,@AL00001+20                                  03S0240 00729000
         L     @15,@CV00171                                     03S0240 00730000
         LA    @01,@AL00001                                     03S0240 00731000
         BALR  @14,@15                                          03S0240 00732000
*                       IF RTCD=0 THEN/* ALL CATALOGS UNALLOCATED    */ 00733000
@RC00221 LH    @10,RTCD                                         03S0241 00734000
         LTR   @10,@10                                          03S0241 00735000
         BNZ   @RF00241                                         03S0241 00736000
*                         DO;       /* SET UP AND REISSUE SVC99      */ 00737000
*                           IF ACDVWAIT=ON THEN/* DEVICE WAIT OK     */ 00738000
         L     @10,@PC00001                                     03S0243 00739000
         TM    ACDVWAIT(@10),B'01000000'                        03S0243 00740000
         BNO   @RF00243                                         03S0243 00741000
*                             S99WTUNT=ON;                      03S0244 00742000
         OI    S99WTUNT,B'00010000'                             03S0244 00743000
*                           IF ACVLWAIT=ON THEN/* VOLUME WAIT OK     */ 00744000
@RF00243 L     @10,@PC00001                                     03S0245 00745000
         TM    ACVLWAIT(@10),B'00001000'                        03S0245 00746000
         BNO   @RF00245                                         03S0245 00747000
*                             S99WTVOL=ON;                      03S0246 00748000
         OI    S99WTVOL,B'10000000'                             03S0246 00749000
*                           S99RSC=0;/* RESET REASON/INFO AREA       */ 00750000
@RF00245 SLR   @10,@10                                          03S0247 00751000
         ST    @10,S99RSC                                       03S0247 00752000
*                           CATSUNAL=ON;/* ENABLE CALLER INDICATION     00753000
*                                      THAT CATALOGS WERE UNALLOCATED*/ 00754000
         OI    CATSUNAL,B'10000000'                             03S0248 00755000
*                           PARAMREG=ADDR(S99RBPTR);/* POINT REG 1 TO   00756000
*                                      PARMS                         */ 00757000
*                                                               03S0249 00758000
         LA    PARAMREG,S99RBPTR                                03S0249 00759000
*                           /*****************************************/ 00760000
*                           /*                                       */ 00761000
*                           /* MACDATE Y-2 73082                     */ 00762000
*                           /*                                       */ 00763000
*                           /*****************************************/ 00764000
*                                                               03S0250 00765000
*                           SVC(99);/* ATTEMPT ALLOCATION AGAIN      */ 00766000
         SVC   99                                               03S0250 00767000
*                           RTCD=RTCDREG;/* SAVE RETURN CODE         */ 00768000
         STH   RTCDREG,RTCD                                     03S0251 00769000
*                         END;                                  03S0252 00770000
*                     END;                                      03S0253 00771000
@RF00241 DS    0H                                               03S0254 00772000
*                 END;              /* END OF 'RECOVERY'             */ 00773000
@RF00212 DS    0H                                               02S0255 00774000
*               IF RTCD=0 THEN      /* IF NO ERRORS, THEN UPDATE     */ 00775000
@RF00201 LH    @10,RTCD                                         02S0255 00776000
         LTR   @10,@10                                          02S0255 00777000
         BNZ   @RF00255                                         02S0255 00778000
*                 DO;                                           02S0256 00779000
*                   EDDNAME=UNITPTR(3)->S99TUPAR(1:8);/* DDN TO ESTAE   00780000
*                                      PARMLIST                      */ 00781000
         L     @10,UNITPTR+8                                    02S0257 00782000
         MVC   EDDNAME(8,EPRMLSTP),S99TUPAR(@10)                02S0257 00783000
*                   EEUCUCAT=ON;    /* SET CURRENT CATALOG ALLOCATED */ 00784000
         OI    EEUCUCAT(EPRMLSTP),B'00010000'                   02S0258 00785000
*                   DDNAMPTR=ADDR(UNITPTR(3)->S99TUPAR);/* PTR TO NEW   00786000
*                                      DD NAME                       */ 00787000
         LA    @10,S99TUPAR(,@10)                               02S0259 00788000
         ST    @10,DDNAMPTR                                     02S0259 00789000
*                   VSERPTR=ADDR(CATVSER);/* CATALOG'S VOLUME SERIAL */ 00790000
         LA    @10,CATVSER                                      02S0260 00791000
         ST    @10,VSERPTR                                      02S0260 00792000
*                   CJUSTALC=ON;    /* ERROR CORRECT CONTROL         */ 00793000
         OI    CJUSTALC,B'10000000'                             02S0261 00794000
*                 END;                                          02S0262 00795000
*               ELSE                /* UNRECOVERABLE ERROR           */ 00796000
*                 IF S99ERROR=CANTMNT THEN/* CATALOG MOUNT NEEDED,      00797000
*                                      BUT                           */ 00798000
         B     @RC00255                                         02S0263 00799000
@RF00255 CLC   S99ERROR(2),@CB00136                             02S0263 00800000
         BNE   @RF00263                                         02S0263 00801000
*                   DO;             /* MOUNTING IS NOT AUTHORIZED    */ 00802000
*                     RTCD=STPERROR;/* RETURN CODE - 8               */ 00803000
         MVC   RTCD(2),@CH00075                                 02S0265 00804000
*                     RSCD=NOAUTH;  /* REASON CODE - 1               */ 00805000
         MVC   RSCD(2),@CH00065                                 02S0266 00806000
*                   END;                                        02S0267 00807000
*             END;                                              01S0268 00808000
@RF00263 DS    0H                                               01S0268 00809000
@RC00255 DS    0H                                               01S0269 00810000
*           IF RTCD=0&              /* NO ERROR FROM DYNALLOC AND    */ 00811000
*               ACOPNACB=ON THEN    /* OPEN OF CATALOG REQUESTED     */ 00812000
@RF00149 LH    @10,RTCD                                         01S0269 00813000
         LTR   @10,@10                                          01S0269 00814000
         BNZ   @RF00269                                         01S0269 00815000
         L     @10,@PC00001                                     01S0269 00816000
         TM    ACOPNACB(@10),B'00010000'                        01S0269 00817000
         BNO   @RF00269                                         01S0269 00818000
*             DO;                                               01S0270 00819000
*                                                               02S0271 00820000
*/********************************************************************/ 00821000
*/*                                                                  */ 00822000
*/* SEGMENT NAME - OPENCTLG                                          */ 00823000
*/*                                                                  */ 00824000
*/* DESCRIPTIVE NAME - INTERFACE TO OPEN CATALOG ROUTINE             */ 00825000
*/*                                                                  */ 00826000
*/* OPERATION - IF THE CATALOG HAS NOT JUST BEEN ALLOCATED (THE      */ 00827000
*/*             INPUT DDNAME PTR IS NON-ZERO), AND NOT IDENTIFIED    */ 00828000
*/*             AS A CVOL BY THE CALLER, THE PCCB CHAIN IS ENQUEUED  */ 00829000
*/*             AND SCANNED TO INSURE THAT THE CATALOG, IF IT IS     */ 00830000
*/*             REPRESENTED BY A PRIVATE CATALOG CONTROL BLOCK, IS   */ 00831000
*/*             NOT A CVOL, WHICH ARE OPENED ONLY BY CATALOG         */ 00832000
*/*             MANAGEMENT.                                          */ 00833000
*/*               (SOME CALLERS, SUCH AS THE INITIATOR, WISHING      */ 00834000
*/*                ONLY TO HAVE THE CATALOG OPENED MAY NOT BE        */ 00835000
*/*                AWARE OF CVOLS, AND AS SUCH WILL NOT INDICATE     */ 00836000
*/*                THIS IN THE INPUT CONTROLS.  HOWEVER, CALLERS     */ 00837000
*/*                WISHING TO HAVE THE CATALOG ALLOCATED AS WELL     */ 00838000
*/*                AS OPENED, SUCH AS JFCB HOUSEKEEPING, WILL        */ 00839000
*/*                ALWAYS INDICATE 'CVOL' IF NECESSARY.  HENCE THE   */ 00840000
*/*                NEED TO VERIFY CATALOGS AS CVOLS IF THE CALLER    */ 00841000
*/*                DID NOT REQUEST THE CATALOG ALLOCATED.)           */ 00842000
*/*             SATISFIED THAT THE CATALOG IS NOT A CVOL, THIS       */ 00843000
*/*             ROUTINE WILL INITIALIZE THE PARAMETER LIST AND       */ 00844000
*/*             CALL 'OPENCAT' (IDACAT11).                           */ 00845000
*/*             SUCCESSFUL OPENING OF THE CATALOG WILL ALLOW THE     */ 00846000
*/*             UPDATING OF THE ESTAE PARAMETER LIST.                */ 00847000
*/*                                                                  */ 00848000
*/* ENTRY - IF 'OPEN THE CATALOG' IS REQUESTED                       */ 00849000
*/*                                                                  */ 00850000
*/*   PURPOSE - SINGLE ENTRY POINT                                   */ 00851000
*/*                                                                  */ 00852000
*/*   INPUT DATA - MODULE INPUT AND THE ADDRESS OF THE PCCB CHAIN    */ 00853000
*/*                                                                  */ 00854000
*/* EXIT - INLINE                                                    */ 00855000
*/*                                                                  */ 00856000
*/*   CONDITION - SINGLE EXIT POINT                                  */ 00857000
*/*                                                                  */ 00858000
*/*   OUTPUT DATA - SUCCESS - ACB POINTER FROM OPEN                  */ 00859000
*/*               - FAILURE - REASON CODE - 4                        */ 00860000
*/*                                                                  */ 00861000
*/*   RETURN CODE - SUCCESS - 0                                      */ 00862000
*/*               - FAILURE - 4                                      */ 00863000
*/*                                                                  */ 00864000
*/********************************************************************/ 00865000
*                                                               02S0271 00866000
*               IF ACOSCVOL=OFF THEN/* CALLER DID NOT INDICATE 'CVOL'*/ 00867000
         TM    ACOSCVOL(@10),B'00010000'                        02S0271 00868000
         BNZ   @RF00271                                         02S0271 00869000
*                 DO;                                           02S0272 00870000
*                   OK2OPEN=ON;     /* INITIALIZE NON-CVOL SWITCH    */ 00871000
         OI    OK2OPEN,B'10000000'                              02S0273 00872000
*                   IF CJUSTALC=OFF THEN/* CATALOG NOT JUST ALLOCATED*/ 00873000
         TM    CJUSTALC,B'10000000'                             02S0274 00874000
         BNZ   @RF00274                                         02S0274 00875000
*                     DO;           /* ENQUEUE PCCB CHAIN AND INSURE */ 00876000
*                       DDNAMPTR=DDNAMP;/* CATALOG IS NOT A CVOL     */ 00877000
         L     @10,@PC00001+20                                  02S0276 00878000
         L     @10,DDNAMP(,@10)                                 02S0276 00879000
         ST    @10,DDNAMPTR                                     02S0276 00880000
*                       OK2OPEN=OFF;/* CATALOG MAY BE CVOL           */ 00881000
         NI    OK2OPEN,B'01111111'                              02S0277 00882000
*                       NQCORE(1:NQLENGTH)=PCNQLIST(1:NQLENGTH);        00883000
         L     @10,NQLENGTH                                     02S0278 00884000
         BCTR  @10,0                                            02S0278 00885000
         EX    @10,@SM01127                                     02S0278 00886000
*                       GEN REFS(NQCORE);                       02S0279 00887000
        ENQ    MF=(E,NQCORE)                                            00888000
*                       PCCBPTR=SAVJSCBP->JSCBPCC;/* SCAN ACTIVE PCCB*/ 00889000
         L     @10,SAVJSCBP                                     02S0280 00890000
         L     PCCBPTR,JSCBPCC(,@10)                            02S0280 00891000
*                       CVOLSW=OFF; /* INTERNAL CVOL SW.     @YM04956*/ 00892000
         NI    CVOLSW,B'01111111'                               02S0281 00893000
*                       DO WHILE(PCCBPTR^=0&/* CHAIN TO END OR UNTIL */ 00894000
*                             CVOLSW=OFF&/* CVOL PCCB OR DDNAME 02S0282 00895000
*                                                            @YM04956*/ 00896000
*                             PCCDDNAM^=DDNAMPTR->DDNAME);/* PCCB       00897000
*                                      FOUND                         */ 00898000
         B     @DE00282                                         02S0282 00899000
@DL00282 DS    0H                                               02S0283 00900000
*                         IF PCOSCVOL=ON/* CVOL WITH NAME    @YM04956*/ 00901000
*                             &(CTGDSN=PCCDSNAM|CTGDSN=PCCTGCON) THEN   00902000
         TM    PCOSCVOL(PCCBPTR),B'00010000'                    02S0283 00903000
         BNO   @RF00283                                         02S0283 00904000
         L     @10,@PC00001+12                                  02S0283 00905000
         L     @10,CTGDSNP(,@10)                                02S0283 00906000
         CLC   CTGDSN(44,@10),PCCDSNAM(PCCBPTR)                 02S0283 00907000
         BE    @RT00283                                         02S0283 00908000
         CLC   CTGDSN(44,@10),PCCTGCON(PCCBPTR)                 02S0283 00909000
         BNE   @RF00283                                         02S0283 00910000
@RT00283 DS    0H                                               02S0284 00911000
*                           CVOLSW=ON;/* PASSED, STOP LOOP.  @YM04956*/ 00912000
         OI    CVOLSW,B'10000000'                               02S0284 00913000
*                         ELSE      /* GET NEXT PCCB.        @YM04956*/ 00914000
*                           PCCBPTR=PCCNEXTP;/* WITH CORRECT DDNAME  */ 00915000
         B     @RC00283                                         02S0285 00916000
@RF00283 L     PCCBPTR,PCCNEXTP(,PCCBPTR)                       02S0285 00917000
*                       END;                                    02S0286 00918000
@RC00283 DS    0H                                               02S0286 00919000
@DE00282 LTR   PCCBPTR,PCCBPTR                                  02S0286 00920000
         BZ    @DC00282                                         02S0286 00921000
         TM    CVOLSW,B'10000000'                               02S0286 00922000
         BNZ   @DC00282                                         02S0286 00923000
         L     @10,DDNAMPTR                                     02S0286 00924000
         CLC   PCCDDNAM(8,PCCBPTR),DDNAME(@10)                  02S0286 00925000
         BNE   @DL00282                                         02S0286 00926000
@DC00282 DS    0H                                               02S0287 00927000
*                       IF PCCBPTR=0|/* CATALOG NEVER ALLOCATED OR   */ 00928000
*                           PCOSCVOL=OFF THEN/* IT IS NOT A CVOL,    */ 00929000
         LTR   PCCBPTR,PCCBPTR                                  02S0287 00930000
         BZ    @RT00287                                         02S0287 00931000
         TM    PCOSCVOL(PCCBPTR),B'00010000'                    02S0287 00932000
         BNZ   @RF00287                                         02S0287 00933000
@RT00287 DS    0H                                               02S0288 00934000
*                         OK2OPEN=ON;/* THEN CATALOG MAY BE OPENED   */ 00935000
         OI    OK2OPEN,B'10000000'                              02S0288 00936000
*                       GEN REFS(NQCORE);                       02S0289 00937000
@RF00287 DS    0H                                               02S0289 00938000
*                                  /* DEQUEUE PCCB CHAIN            */  00939000
        DEQ    MF=(E,NQCORE)                                            00940000
*                     END;          /* PCCB CHAIN ENQUEUE LOOP       */ 00941000
*                   IF OK2OPEN=ON THEN/* CATALOG IS NOT A CVOL       */ 00942000
@RF00274 TM    OK2OPEN,B'10000000'                              02S0291 00943000
         BNO   @RF00291                                         02S0291 00944000
*                     DO;                                       02S0292 00945000
*                       OPNFLAGS=OPNFLAGS&&OPNFLAGS;/* OPEN CONTROLS */ 00946000
         XC    OPNFLAGS(4),OPNFLAGS                             02S0293 00947000
*                       IF ACNOENQ=ON THEN/* DO NOT ENQUEUE ON THE      00948000
*                                      TIOT                          */ 00949000
         L     @10,@PC00001                                     02S0294 00950000
         TM    ACNOENQ(@10),B'00000010'                         02S0294 00951000
         BNO   @RF00294                                         02S0294 00952000
*                         OPNOTINQ=ON;                          02S0295 00953000
         OI    OPNOTINQ,B'00000100'                             02S0295 00954000
*                       PARAMREG=ADDR(CATPARMS);/* POINT REG 1 TO    */ 00955000
@RF00294 LA    PARAMREG,CATPARMS                                02S0296 00956000
*                       CALL IDACAT11;/* CATALOG PARMS               */ 00957000
         L     @15,@CV00167                                     02S0297 00958000
         BALR  @14,@15                                          02S0297 00959000
*                       RTCD=RTCDREG;/* SAVE RETURN CODE             */ 00960000
         STH   RTCDREG,RTCD                                     02S0298 00961000
*                       IF RTCD=0 THEN/* CTLG JUST OPENED            */ 00962000
         LH    @10,RTCD                                         02S0299 00963000
         LTR   @10,@10                                          02S0299 00964000
         BNZ   @RF00299                                         02S0299 00965000
*                         DO;                                   02S0300 00966000
*                           CTGOPEND=ON;/* REMEMBER FOR ERROR CHECK  */ 00967000
         OI    CTGOPEND,B'10000000'                             02S0301 00968000
*                           EACBPTR=ACBPTR;/* ACB PTR TO ESTAE  02S0302 00969000
*                                      PARMLIST                      */ 00970000
         L     @10,ACBPTR                                       02S0302 00971000
         ST    @10,EACBPTR(,EPRMLSTP)                           02S0302 00972000
*                           EECCUCAT=ON;/* SET CURRENT CATALOG OPENED*/ 00973000
         OI    EECCUCAT(EPRMLSTP),B'00001000'                   02S0303 00974000
*                         END;                                  02S0304 00975000
*                     END;          /* OPEN LOOP                     */ 00976000
*                   ELSE            /* CVOL (FROM PCCB CHECK)        */ 00977000
*                     PCCVOL=ON;    /* CONTROL TO PCCB ROUTINE       */ 00978000
         B     @RC00291                                         02S0306 00979000
@RF00291 OI    PCCVOL,B'00001000'                               02S0306 00980000
*                 END;              /* NOT A CVOL (PARM)             */ 00981000
@RC00291 DS    0H                                               02S0308 00982000
*             END;                                              01S0308 00983000
@RF00271 DS    0H                                               01S0309 00984000
*         END;                      /* END CTLG NOT ALLOC'D@ZA00870  */ 00985000
@RF00269 DS    0H                                               01S0310 00986000
*       IF ACNUJSCB=ON THEN         /* CTLG ALLOCATED TO ACTIVE TASK */ 00987000
@RF00147 L     @10,@PC00001                                     01S0310 00988000
         TM    ACNUJSCB(@10),B'00000001'                        01S0310 00989000
         BNO   @RF00310                                         01S0310 00990000
*         DO;                                                   01S0311 00991000
*           DO;                     /* MODESET KEYADDR(0)            */ 00992000
*             SPKA(0);              /* SET PSW KEY                   */ 00993000
         SLR   @10,@10                                          01S0313 00994000
         SPKA  0(@10)                                           01S0313 00995000
*           END;                    /* MODESET KEYADDR(0) KEY 0 TO      00996000
*                                      ALTER JSCB                    */ 00997000
*           JSCBACT=SAVJSCBP;       /* RESET ACTIVE JSCB PTR         */ 00998000
         L     @10,@PC00001+8                                   01S0315 00999000
         L     @10,JSCBPTR(,@10)                                01S0315 01000000
         L     @07,SAVJSCBP                                     01S0315 01001000
         ST    @07,JSCBACT(,@10)                                01S0315 01002000
*           DO;                     /* MODESET EXTKEY(SCHED)         */ 01003000
*             SPKA(16);             /* SET PSW KEY                   */ 01004000
         LA    @10,16                                           01S0317 01005000
         SPKA  0(@10)                                           01S0317 01006000
*           END;                    /* MODESET EXTKEY(SCHED) BACK TO    01007000
*                                      KEY 1                         */ 01008000
*         END;                                                  01S0319 01009000
*       IF RTCD=0&                  /* NO ERROR AND          @YM04235*/ 01010000
*           ACCCPCCB=ON THEN        /* PCCB ROUTINE REQUESTED        */ 01011000
@RF00310 LH    @10,RTCD                                         01S0320 01012000
         LTR   @10,@10                                          01S0320 01013000
         BNZ   @RF00320                                         01S0320 01014000
         L     @10,@PC00001                                     01S0320 01015000
         TM    ACCCPCCB(@10),B'00001000'                        01S0320 01016000
         BNO   @RF00320                                         01S0320 01017000
*         DO;                                                   01S0321 01018000
*           IF ACSTPCAT=ON THEN     /* STEPCAT                       */ 01019000
         TM    ACSTPCAT(@10),B'01000000'                        01S0322 01020000
         BNO   @RF00322                                         01S0322 01021000
*             PCCSTPCT=ON;                                      01S0323 01022000
         OI    PCCSTPCT,B'00100000'                             01S0323 01023000
*           IF ACOSCVOL=ON THEN     /* CALLER INDICATES 'CVOL',      */ 01024000
@RF00322 L     @10,@PC00001                                     01S0324 01025000
         TM    ACOSCVOL(@10),B'00010000'                        01S0324 01026000
         BNO   @RF00324                                         01S0324 01027000
*             PCCVOL=ON;            /* INDICATE TO PCCB ROUTINE      */ 01028000
         OI    PCCVOL,B'00001000'                               01S0325 01029000
*           PCCMAKE=ON;             /* CREATE/CHAIN OR MODIFY PCCB   */ 01030000
@RF00324 OI    PCCMAKE,B'10000000'                              01S0326 01031000
*           IF DDNAMP^=0 THEN       /* DDNAME PTR FROM PARAMETERS    */ 01032000
         L     @10,@PC00001+20                                  01S0327 01033000
         L     @10,DDNAMP(,@10)                                 01S0327 01034000
         LTR   @10,@10                                          01S0327 01035000
         BZ    @RF00327                                         01S0327 01036000
*             DDNAMPTR=DDNAMP;      /* OR DYNAM ALLOCATION           */ 01037000
         ST    @10,DDNAMPTR                                     01S0328 01038000
*           CALL IEFAB4EF(PCCNTRLS,RTCDPTR,SAVJSCBP,CTGDSNP,CTGCONP,    01039000
*               ACBPTR,DDNAMPTR,0,VSERPTR);/* PCCB ROUTINE           */ 01040000
@RF00327 LA    @10,PCCNTRLS                                     01S0329 01041000
         ST    @10,@AL00001                                     01S0329 01042000
         LA    @10,RTCDPTR                                      01S0329 01043000
         ST    @10,@AL00001+4                                   01S0329 01044000
         LA    @10,SAVJSCBP                                     01S0329 01045000
         ST    @10,@AL00001+8                                   01S0329 01046000
         L     @10,@PC00001+12                                  01S0329 01047000
         ST    @10,@AL00001+12                                  01S0329 01048000
         L     @10,@PC00001+16                                  01S0329 01049000
         ST    @10,@AL00001+16                                  01S0329 01050000
         LA    @10,ACBPTR                                       01S0329 01051000
         ST    @10,@AL00001+20                                  01S0329 01052000
         LA    @10,DDNAMPTR                                     01S0329 01053000
         ST    @10,@AL00001+24                                  01S0329 01054000
         LA    @10,@CF00146                                     01S0329 01055000
         ST    @10,@AL00001+28                                  01S0329 01056000
         LA    @10,VSERPTR                                      01S0329 01057000
         ST    @10,@AL00001+32                                  01S0329 01058000
         L     @15,@CV00170                                     01S0329 01059000
         LA    @01,@AL00001                                     01S0329 01060000
         BALR  @14,@15                                          01S0329 01061000
*           IF RTCD=0 THEN          /* SUCCESSFUL PCCB FUNCTION      */ 01062000
         LH    @10,RTCD                                         01S0330 01063000
         LTR   @10,@10                                          01S0330 01064000
         BNZ   @RF00330                                         01S0330 01065000
*             DO;                   /* RESET ESTAE INDICATORS        */ 01066000
*               EEUCUCAT=OFF;       /* CURRENT CAT. ALLOCATED        */ 01067000
*               EECCUCAT=OFF;       /* CURRENT CAT. OPEN             */ 01068000
         NI    EEUCUCAT(EPRMLSTP),B'11100111'                   01S0333 01069000
*             END;                                              01S0334 01070000
*           IF RTCD=DUPCATLG THEN   /* IF AB4EF FOUND A DUPL PVT        01071000
*                                      CATALOG THEN IGNORE THIS 01S0335 01072000
*                                      REQUEST               @ZA06641*/ 01073000
@RF00330 CLC   RTCD(2),@CH00063                                 01S0335 01074000
         BNE   @RF00335                                         01S0335 01075000
*             RETCOD=0;             /*                       @ZA06641*/ 01076000
         SLR   @10,@10                                          01S0336 01077000
         STCM  @10,15,RETCOD                                    01S0336 01078000
*         END;                      /* PCCB ROUTINE REQUEST          */ 01079000
@RF00335 DS    0H                                               01S0338 01080000
*       IF RTCD^=0 THEN             /* ERROR IN PROCESSING           */ 01081000
@RF00320 SLR   @10,@10                                          01S0338 01082000
         CH    @10,RTCD                                         01S0338 01083000
         BE    @RF00338                                         01S0338 01084000
*         DO;                       /* UNALLOCATE/CLOSE CATALOG      */ 01085000
*           UCCNTRLS=0;             /* PRESERVING THE ORIGINAL RTCD  */ 01086000
         STH   @10,UCCNTRLS                                     01S0340 01087000
*           IF CJUSTALC=ON THEN     /* CATALOG WAS JUST ALLOCATED    */ 01088000
         TM    CJUSTALC,B'10000000'                             01S0341 01089000
         BNO   @RF00341                                         01S0341 01090000
*             UCONECAT=ON;          /* UNALLOCATE IT                 */ 01091000
         OI    UCONECAT,B'00100000'                             01S0342 01092000
*           IF CTGOPEND=ON THEN     /* CATALOG WAS OPENED            */ 01093000
@RF00341 TM    CTGOPEND,B'10000000'                             01S0343 01094000
         BNO   @RF00343                                         01S0343 01095000
*             UCONEACB=ON;          /* CLOSE IT                      */ 01096000
         OI    UCONEACB,B'00001000'                             01S0344 01097000
*           IF UCCNTRLS^=0 THEN     /* CTLG WAS ALLOCATED OR OPENED  */ 01098000
@RF00343 LH    @10,UCCNTRLS                                     01S0345 01099000
         N     @10,@CF01132                                     01S0345 01100000
         LTR   @10,@10                                          01S0345 01101000
         BZ    @RF00345                                         01S0345 01102000
*             DO;                                               01S0346 01103000
*               IF ACNUJSCB=ON THEN /* USING THE INITIATOR'S JSCB    */ 01104000
         L     @10,@PC00001                                     01S0347 01105000
         TM    ACNUJSCB(@10),B'00000001'                        01S0347 01106000
         BNO   @RF00347                                         01S0347 01107000
*                 UCCAJSCB=ON;      /* INDICATE SAME TO UNALLOC CTLG */ 01108000
         OI    UCCAJSCB,B'10000000'                             01S0348 01109000
*               IF ACNOENQ=ON THEN  /* TIOT ENQ NOT ALLOWED          */ 01110000
@RF00347 L     @10,@PC00001                                     01S0349 01111000
         TM    ACNOENQ(@10),B'00000010'                         01S0349 01112000
         BNO   @RF00349                                         01S0349 01113000
*                 UCNTIONQ=ON;                                  01S0350 01114000
         OI    UCNTIONQ,B'01000000'                             01S0350 01115000
*               IF UCONECAT=ON THEN /* UNALLOC. ONE WAS REQUESTED    */ 01116000
@RF00349 TM    UCONECAT,B'00100000'                             01S0351 01117000
         BNO   @RF00351                                         01S0351 01118000
*                 EEUCUCAT=OFF;     /* UNALLOC. CURRENT CATALOG BIT  */ 01119000
         NI    EEUCUCAT(EPRMLSTP),B'11101111'                   01S0352 01120000
*               IF UCONEACB=ON THEN /* CLOSE ONE WAS REQUESTED       */ 01121000
@RF00351 TM    UCONEACB,B'00001000'                             01S0353 01122000
         BNO   @RF00353                                         01S0353 01123000
*                 EECCUCAT=OFF;     /* CLOSE CURRENT CATALOG BIT     */ 01124000
         NI    EECCUCAT(EPRMLSTP),B'11110111'                   01S0354 01125000
*               CALL IEFAB4F4(UCCNTRLS,ADDR(DUMMYRTN),0,DDNAMPTR,ACBPTR 01126000
*                   ,JSCBPTR);      /* MUST PRESERVE REAL RTN INFO   */ 01127000
@RF00353 LA    @10,UCCNTRLS                                     01S0355 01128000
         ST    @10,@AL00001                                     01S0355 01129000
         LA    @10,DUMMYRTN                                     01S0355 01130000
         ST    @10,@TF00001                                     01S0355 01131000
         LA    @10,@TF00001                                     01S0355 01132000
         ST    @10,@AL00001+4                                   01S0355 01133000
         LA    @10,@CF00146                                     01S0355 01134000
         ST    @10,@AL00001+8                                   01S0355 01135000
         LA    @10,DDNAMPTR                                     01S0355 01136000
         ST    @10,@AL00001+12                                  01S0355 01137000
         LA    @10,ACBPTR                                       01S0355 01138000
         ST    @10,@AL00001+16                                  01S0355 01139000
         L     @10,@PC00001+8                                   01S0355 01140000
         ST    @10,@AL00001+20                                  01S0355 01141000
         L     @15,@CV00171                                     01S0355 01142000
         LA    @01,@AL00001                                     01S0355 01143000
         BALR  @14,@15                                          01S0355 01144000
*             END;                                              01S0356 01145000
*           IF RSCD^=NOAUTH THEN    /* DO NOT OVERLAY STEP RETURN    */ 01146000
@RF00345 CLC   RSCD(2),@CH00065                                 01S0357 01147000
         BE    @RF00357                                         01S0357 01148000
*             DO;                   /* AND REASON CODES              */ 01149000
*               RTCD=STPERROR;      /* 8 - UNABLE TO ALLOCATE        */ 01150000
         MVC   RTCD(2),@CH00075                                 01S0359 01151000
*               RSCD=NOALC;         /* 19 - AND/OR OPEN CATALOG      */ 01152000
         MVC   RSCD(2),@CH00127                                 01S0360 01153000
*             END;                                              01S0361 01154000
*         END;                      /* ERROR PROCESSING              */ 01155000
@RF00357 DS    0H                                               01S0363 01156000
*       GEN REFS(ESTAECOR);                                     01S0363 01157000
@RF00338 DS    0H                                               01S0363 01158000
      ESTAE 0,MF=(E,ESTAECOR)                                           01159000
*       RFY                                                     01S0364 01160000
*        (REG0,                                                 01S0364 01161000
*         REG1) RSTD;               /* ESTAE PARMLIST TO BE FREED    */ 01162000
*       REG0=SPLEN;                 /* SET SUBPOOL NUMBER            */ 01163000
         L     REG0,SPLEN                                       01S0365 01164000
*       REG1=EPRMLSTP;              /* PTR TO PARMLIST TO FREE       */ 01165000
         LR    REG1,EPRMLSTP                                    01S0366 01166000
*       GEN(FREEMAIN R,LV=(0),A=(1));                           01S0367 01167000
         FREEMAIN R,LV=(0),A=(1)                                        01168000
*       RFY                                                     01S0368 01169000
*        (REG0,                                                 01S0368 01170000
*         REG1) UNRSTD;                                         01S0368 01171000
*     END;                          /* END - ESTAE SUCCESSFUL        */ 01172000
*/*** GET IN KEY OF CALLER TO RETURN THE RETURN INFORMATION        ***/ 01173000
*                                                               01S0370 01174000
*   DO;                             /* MODESET KEYADDR(KEYSAVE)      */ 01175000
@RF00107 DS    0H                                               01S0371 01176000
*     SPKA(KEYSAVE);                /* SET PSW KEY                   */ 01177000
         SPKA  0(KEYSAVE)                                       01S0371 01178000
*   END;                            /* MODESET KEYADDR(KEYSAVE) KEY     01179000
*                                      OF CALLER                     */ 01180000
*   RETURNS=RETCOD;                 /* RETURN INFO TO CALLER         */ 01181000
         L     @10,@PC00001+4                                   01S0373 01182000
         L     @10,RTNINFOP(,@10)                               01S0373 01183000
         MVC   RETURNS(4,@10),RETCOD                            01S0373 01184000
*   IF CATSUNAL=ON THEN             /* INDICATE CATALOGS UNALLOCATED */ 01185000
         TM    CATSUNAL,B'10000000'                             01S0374 01186000
         BNO   @RF00374                                         01S0374 01187000
*     ACRECOVD=ON;                  /* TO CALLER                     */ 01188000
         L     @10,@PC00001                                     01S0375 01189000
         OI    ACRECOVD(@10),B'00000100'                        01S0375 01190000
*   DO;                             /* MODESET EXTKEY(SCHED)         */ 01191000
@RF00374 DS    0H                                               01S0377 01192000
*     SPKA(16);                     /* SET PSW KEY                   */ 01193000
         LA    @10,16                                           01S0377 01194000
         SPKA  0(@10)                                           01S0377 01195000
*   END;                            /* MODESET EXTKEY(SCHED) BACK TO    01196000
*                                      OUR KEY                       */ 01197000
*   END IEFAB4F5                                                01S0379 01198000
*                                                               01S0379 01199000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01200000
*/*%INCLUDE SYSUT5  (SPEC4F5 )                                       */ 01201000
*/*%INCLUDE SYSUT5  (DCLS4F5 )                                       */ 01202000
*/*%INCLUDE SYSLIB  (IEFZB442)                                       */ 01203000
*/*%INCLUDE SYSLIB  (IEFZB443)                                       */ 01204000
*/*%INCLUDE SYSLIB  (IEFZB444)                                       */ 01205000
*/*%INCLUDE SYSLIB  (IEFZB450)                                       */ 01206000
*/*%INCLUDE SYSLIB  (IEFZB453)                                       */ 01207000
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                       */ 01208000
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                       */ 01209000
*/*%INCLUDE SYSLIB  (IEZJSCB )                                       */ 01210000
*/*%INCLUDE SYSLIB  (IEFPCCB )                                       */ 01211000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 01212000
*/*%INCLUDE SYSUT5  (ACESTAES)                                       */ 01213000
*/*%INCLUDE SYSUT5  (ACESTAE )                                       */ 01214000
*/*%INCLUDE SYSLIB  (ESTAECOD)                                       */ 01215000
*/*%INCLUDE SYSLIB  (ESTAESPC)                                       */ 01216000
*/*%INCLUDE SYSUT5  (ALCTSPEC)                                       */ 01217000
*/*%INCLUDE SYSUT5  (ALCATLG )                                       */ 01218000
*/*%INCLUDE SYSUT5  (RECVSPEC)                                       */ 01219000
*/*%INCLUDE SYSUT5  (RECOVERY)                                       */ 01220000
*/*%INCLUDE SYSUT5  (OPENSPEC)                                       */ 01221000
*/*%INCLUDE SYSUT5  (OPENCTLG)                                       */ 01222000
*                                                               01S0379 01223000
*       ;                                                       01S0379 01224000
@EL00001 LR    @02,KEYSAVE                                      01S0379 01225000
         L     @13,4(,@13)                                      01S0379 01226000
@EF00001 L     @00,@SIZDATD                                     01S0379 01227000
         LR    @01,@11                                          01S0379 01228000
         FSPACE   R,LV=(0),A=(1)                                        01229000
         MODESET KEYADDR=(2)                                            01230000
@ER00001 LM    @14,@12,12(@13)                                  01S0379 01231000
         BR    @14                                              01S0379 01232000
@DATA    DS    0H                                                       01233000
@CH00065 DC    H'1'                                                     01234000
@CH00106 DC    H'6'                                                     01235000
@CH00075 DC    H'8'                                                     01236000
@CH00059 DC    H'16'                                                    01237000
@CH00127 DC    H'19'                                                    01238000
@CH00108 DC    H'44'                                                    01239000
@SM01123 MVC   ESTAECOR(0),ESTAELST                                     01240000
@SM01127 MVC   NQCORE(0),PCNQLIST                                       01241000
@DATD    DSECT                                                          01242000
         DS    0F                                                       01243000
@SA00001 DS    18F                                                      01244000
@PC00001 DS    6F                                                       01245000
@AL00001 DS    9A                                                       01246000
@TF00001 DS    F                                                        01247000
IEFAB4F5 CSECT                                                          01248000
         DS    0F                                                       01249000
@CF00146 DC    F'0'                                                     01250000
@CF00063 DC    F'4'                                                     01251000
@CH00063 EQU   @CF00063+2                                               01252000
@CF01110 DC    F'436'                                                   01253000
@CF01132 DC    XL4'0000FFFF'                                            01254000
@DATD    DSECT                                                          01255000
         DS    0D                                                       01256000
S99TUFP  DS    A                                                        01257000
RTCDPTR  DS    A                                                        01258000
VSERPTR  DS    A                                                        01259000
SAVJSCBP DS    A                                                        01260000
DUMMYRTN DS    F                                                        01261000
S99RBPTR DS    AL4                                                      01262000
         ORG   S99RBPTR                                                 01263000
S99RBPND DS    BL1                                                      01264000
         ORG   S99RBPTR+4                                               01265000
JSCBWRKP DS    A                                                        01266000
UCCNTRLS DS    FL2                                                      01267000
         ORG   UCCNTRLS                                                 01268000
UCCAJSCB DS    BL1                                                      01269000
UCNTIONQ EQU   UCCNTRLS+0                                               01270000
UCONECAT EQU   UCCNTRLS+0                                               01271000
UCALLCAT EQU   UCCNTRLS+0                                               01272000
UCONEACB EQU   UCCNTRLS+0                                               01273000
UCALLACB EQU   UCCNTRLS+0                                               01274000
UCONPCCB EQU   UCCNTRLS+0                                               01275000
UCALPCCB EQU   UCCNTRLS+0                                               01276000
UCTEMP   DS    BL1                                                      01277000
UCSWTIOT EQU   UCCNTRLS+1                                               01278000
@NM00005 EQU   UCCNTRLS+1                                               01279000
         ORG   UCCNTRLS+2                                               01280000
PCCNTRLS DS    FL2                                                      01281000
         ORG   PCCNTRLS                                                 01282000
PCCMAKE  DS    BL1                                                      01283000
PCCFREE  EQU   PCCNTRLS+0                                               01284000
PCCSTPCT EQU   PCCNTRLS+0                                               01285000
PCCFREAL EQU   PCCNTRLS+0                                               01286000
PCCVOL   EQU   PCCNTRLS+0                                               01287000
@NM00009 EQU   PCCNTRLS+0                                               01288000
         ORG   PCCNTRLS+2                                               01289000
RETCOD   DS    CL4                                                      01290000
         ORG   RETCOD                                                   01291000
RTCD     DS    FL2                                                      01292000
RSCD     DS    FL2                                                      01293000
         ORG   RETCOD+4                                                 01294000
SPLEN    DS    CL4                                                      01295000
         ORG   SPLEN                                                    01296000
SBPOOL   DS    FL1                                                      01297000
LENTH    DS    FL3                                                      01298000
         ORG   SPLEN+4                                                  01299000
CATPARMS DS    CL12                                                     01300000
         ORG   CATPARMS                                                 01301000
DDNAMPTR DS    AL4                                                      01302000
ACBPTR   DS    AL4                                                      01303000
OPNFLAGS DS    BL4                                                      01304000
         ORG   OPNFLAGS                                                 01305000
@NM00001 DS    BL1                                                      01306000
OPNOTINQ EQU   OPNFLAGS+0                                               01307000
@NM00002 EQU   OPNFLAGS+0                                               01308000
         ORG   CATPARMS+12                                              01309000
AB4EDCOR DS    CL500                                                    01310000
ASWACORE DS    CL40                                                     01311000
UNIT1    DS    CL50                                                     01312000
         ORG   UNIT1                                                    01313000
UNITCODE DS    CL6                                                      01314000
DSNPARM  DS    CL44                                                     01315000
         ORG   UNIT1+50                                                 01316000
UNIT2    DS    CL7                                                      01317000
UNIT3    DS    CL14                                                     01318000
UNIT4    DS    CL12                                                     01319000
         ORG   UNIT4                                                    01320000
@NM00003 DS    CL6                                                      01321000
CATVSER  DS    CL6                                                      01322000
         ORG   UNIT4+12                                                 01323000
CJUSTALC DS    BL1                                                      01324000
CATSUNAL DS    BL1                                                      01325000
OK2OPEN  DS    BL1                                                      01326000
CTGOPEND DS    BL1                                                      01327000
ALOCOPEN DS    BL1                                                      01328000
CVOLSW   DS    BL1                                                      01329000
CATALCTD DS    BL1                                                      01330000
         DS    CL2                                                      01331000
S99RB    DS    CL20                                                     01332000
         ORG   S99RB                                                    01333000
S99RBLN  DS    CL1                                                      01334000
S99VERB  DS    CL1                                                      01335000
S99FLAG1 DS    CL2                                                      01336000
         ORG   S99FLAG1                                                 01337000
S99FLG11 DS    CL1                                                      01338000
         ORG   S99FLG11                                                 01339000
S99ONCNV DS    BL1                                                      01340000
S99NOCNV EQU   S99FLG11+0                                               01341000
S99NOMNT EQU   S99FLG11+0                                               01342000
S99JBSYS EQU   S99FLG11+0                                               01343000
         ORG   S99FLAG1+1                                               01344000
S99FLG12 DS    CL1                                                      01345000
         ORG   S99RB+4                                                  01346000
S99RSC   DS    CL4                                                      01347000
         ORG   S99RSC                                                   01348000
S99ERROR DS    CL2                                                      01349000
S99INFO  DS    CL2                                                      01350000
         ORG   S99RB+8                                                  01351000
S99TXTPP DS    AL4                                                      01352000
S99RSV01 DS    FL4                                                      01353000
S99FLAG2 DS    CL4                                                      01354000
         ORG   S99FLAG2                                                 01355000
S99FLG21 DS    CL1                                                      01356000
         ORG   S99FLG21                                                 01357000
S99WTVOL DS    BL1                                                      01358000
S99WTDSN EQU   S99FLG21+0                                               01359000
S99NORES EQU   S99FLG21+0                                               01360000
S99WTUNT EQU   S99FLG21+0                                               01361000
S99OFFLN EQU   S99FLG21+0                                               01362000
S99TIONQ EQU   S99FLG21+0                                               01363000
S99CATLG EQU   S99FLG21+0                                               01364000
S99MOUNT EQU   S99FLG21+0                                               01365000
         ORG   S99FLAG2+1                                               01366000
S99FLG22 DS    CL1                                                      01367000
         ORG   S99FLG22                                                 01368000
S99UDEVT DS    BL1                                                      01369000
S99PCINT EQU   S99FLG22+0                                               01370000
         ORG   S99FLAG2+2                                               01371000
S99FLG23 DS    CL1                                                      01372000
S99FLG24 DS    CL1                                                      01373000
         ORG   S99RB+20                                                 01374000
UNITPTR  DS    AL4                                                      01375000
         ORG   UNITPTR+0                                                01376000
LASTPTR  DS    BL1                                                      01377000
         ORG   UNITPTR+16                                               01378000
IEFAB4F5 CSECT                                                          01379000
         DS    0F                                                       01380000
@SIZDATD DC    AL1(230)                                                 01381000
         DC    AL3(@ENDDATD-@DATD)                                      01382000
@CV00167 DC    V(IDACAT11)                                              01383000
@CV00168 DC    V(IEFAB4EA)                                              01384000
@CV00169 DC    V(IEFAB4ED)                                              01385000
@CV00170 DC    V(IEFAB4EF)                                              01386000
@CV00171 DC    V(IEFAB4F4)                                              01387000
         DS    0D                                                       01388000
@CC00148 DC    C'IEFAB4EA'                                              01389000
@CC00150 DC    C'ASWA'                                                  01390000
@CB00134 DC    X'0214'                                                  01391000
@CB00136 DC    X'0218'                                                  01392000
@CB00138 DC    X'0220'                                                  01393000
@CB00317 DC    X'0002'                                                  01394000
@CB00321 DC    X'0004'                                                  01395000
@CB00483 DC    X'0055'                                                  01396000
@CB00499 DC    X'005D'                                                  01397000
QNAME    DC    CL8'SYSZPCCB'                                            01398000
RNAME    DC    CL4'PCCB'                                                01399000
IEFAB4F5 CSECT                                                          01400000
PCNQLIST ENQ (QNAME,RNAME,S,,SYSTEM),MF=L                               01401000
NQLENGTH DC A(*-PCNQLIST)                                               01402000
@DATD    DSECT                                                          01403000
NQCORE   ENQ (QNAME,RNAME,S,,SYSTEM),MF=L                               01404000
IEFAB4F5 CSECT                                                          01405000
ESTAELST ESTAE RECORD=YES,TERM=YES,MF=L                                 01406000
ESTAELEN DC A(*-ESTAELST)                                               01407000
@DATD    DSECT                                                          01408000
ESTAECOR ESTAE RECORD=YES,TERM=YES,MF=L                                 01409000
IEFAB4F5 CSECT                                                          01410000
         DS   0H                                                        01411000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   01412000
@DATD    DSECT                                                          01413000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01414000
@ENDDATD EQU   *                                                        01415000
IEFAB4F5 CSECT                                                          01416000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01417000
@01      EQU   01                                                       01418000
@02      EQU   02                                                       01419000
@03      EQU   03                                                       01420000
@04      EQU   04                                                       01421000
@05      EQU   05                                                       01422000
@06      EQU   06                                                       01423000
@07      EQU   07                                                       01424000
@08      EQU   08                                                       01425000
@09      EQU   09                                                       01426000
@10      EQU   10                                                       01427000
@11      EQU   11                                                       01428000
@12      EQU   12                                                       01429000
@13      EQU   13                                                       01430000
@14      EQU   14                                                       01431000
@15      EQU   15                                                       01432000
TCBPTR   EQU   @08                                                      01433000
ASWAPTR  EQU   @07                                                      01434000
PCCBPTR  EQU   @02                                                      01435000
EPRMLSTP EQU   @06                                                      01436000
KEYSAVE  EQU   @04                                                      01437000
REG0     EQU   @00                                                      01438000
REG1     EQU   @01                                                      01439000
REG2     EQU   @02                                                      01440000
REG3     EQU   @03                                                      01441000
PARAMREG EQU   @01                                                      01442000
RTCDREG  EQU   @15                                                      01443000
LOC16PTR EQU   16                                                       01444000
TCBLISTP EQU   0                                                        01445000
TWOTCBPS EQU   0                                                        01446000
CURNTCBP EQU   TWOTCBPS+4                                               01447000
RETURNS  EQU   0                                                        01448000
AB4EDPMS EQU   0                                                        01449000
ASWA     EQU   0                                                        01450000
ASWAID   EQU   ASWA                                                     01451000
ASWACSCT EQU   ASWA+4                                                   01452000
ASWARTNP EQU   ASWA+12                                                  01453000
ASWAPRMS EQU   ASWA+16                                                  01454000
ASWASCBP EQU   ASWA+20                                                  01455000
ASWAFLGS EQU   ASWA+28                                                  01456000
ASWADSWS EQU   ASWAFLGS                                                 01457000
ASWANOCH EQU   ASWADSWS                                                 01458000
ASWAAUTO EQU   ASWA+32                                                  01459000
CTGDSN   EQU   0                                                        01460000
DDNAME   EQU   0                                                        01461000
EPARMLST EQU   0                                                        01462000
EECNTRLS EQU   EPARMLST+400                                             01463000
EEUALCAT EQU   EECNTRLS                                                 01464000
EECLACAT EQU   EECNTRLS                                                 01465000
EEFAPCCB EQU   EECNTRLS                                                 01466000
EEUCUCAT EQU   EECNTRLS                                                 01467000
EECCUCAT EQU   EECNTRLS                                                 01468000
EERAJSCP EQU   EECNTRLS                                                 01469000
EEDYNAM  EQU   EECNTRLS                                                 01470000
EEDNENQT EQU   EECNTRLS                                                 01471000
ECJSCBP  EQU   EPARMLST+404                                             01472000
EAJSCBP  EQU   EPARMLST+408                                             01473000
EACBPTR  EQU   EPARMLST+412                                             01474000
EDDNAME  EQU   EPARMLST+416                                             01475000
ERETURNS EQU   EPARMLST+424                                             01476000
S99TUPL  EQU   0                                                        01477000
S99TUPTR EQU   S99TUPL                                                  01478000
S99TUP   EQU   0                                                        01479000
S99TUNIT EQU   0                                                        01480000
S99TUKEY EQU   S99TUNIT                                                 01481000
S99TUNUM EQU   S99TUNIT+2                                               01482000
S99TUENT EQU   S99TUNIT+4                                               01483000
S99TULNG EQU   S99TUENT                                                 01484000
S99TUPAR EQU   S99TUENT+2                                               01485000
S99TUFLD EQU   0                                                        01486000
IEZJSCB  EQU   0                                                        01487000
JSCBSEC1 EQU   IEZJSCB+188                                              01488000
JSCHPCE  EQU   JSCBSEC1+4                                               01489000
JSCBPCC  EQU   JSCBSEC1+16                                              01490000
JSCBDCB  EQU   JSCBSEC1+36                                              01491000
JSCBOPTS EQU   JSCBSEC1+48                                              01492000
JSCBSWT1 EQU   JSCBSEC1+55                                              01493000
JSCBWTP  EQU   JSCBSEC1+64                                              01494000
JSCBWTFG EQU   JSCBWTP                                                  01495000
JSCBEND1 EQU   IEZJSCB+260                                              01496000
IEFPCCB  EQU   0                                                        01497000
PCCNEXTP EQU   IEFPCCB+4                                                01498000
PCCSTATS EQU   IEFPCCB+12                                               01499000
PCCSTAT1 EQU   PCCSTATS                                                 01500000
PCOSCVOL EQU   PCCSTAT1                                                 01501000
PCCDDNAM EQU   IEFPCCB+20                                               01502000
PCCDSNAM EQU   IEFPCCB+28                                               01503000
PCCTGCON EQU   IEFPCCB+72                                               01504000
TCBFIX   EQU   0                                                        01505000
TCBFRS   EQU   TCBFIX                                                   01506000
TCB      EQU   0                                                        01507000
TCBPIE   EQU   TCB+4                                                    01508000
TCBPMASK EQU   TCBPIE                                                   01509000
TCBCMP   EQU   TCB+16                                                   01510000
TCBCMPF  EQU   TCBCMP                                                   01511000
TCBCPP   EQU   TCBCMPF                                                  01512000
TCBSTCC  EQU   TCBCMPF                                                  01513000
TCBCDBL  EQU   TCBCMPF                                                  01514000
TCBCWTO  EQU   TCBCMPF                                                  01515000
TCBCIND  EQU   TCBCMPF                                                  01516000
TCBCMSG  EQU   TCBCMPF                                                  01517000
TCBTRN   EQU   TCB+20                                                   01518000
TCBABF   EQU   TCBTRN                                                   01519000
TCBMSS   EQU   TCB+24                                                   01520000
TCBPKF   EQU   TCB+28                                                   01521000
TCBFLGS  EQU   TCB+29                                                   01522000
TCBFLGS1 EQU   TCBFLGS                                                  01523000
TCBFLGS2 EQU   TCBFLGS+1                                                01524000
TCBFLGS3 EQU   TCBFLGS+2                                                01525000
TCBFLGS4 EQU   TCBFLGS+3                                                01526000
TCBFLGS5 EQU   TCBFLGS+4                                                01527000
TCBABWF  EQU   TCBFLGS5                                                 01528000
TCBJPQ   EQU   TCB+44                                                   01529000
TCBPURGE EQU   TCBJPQ                                                   01530000
TCBGRS   EQU   TCB+48                                                   01531000
TCBFSA   EQU   TCB+112                                                  01532000
TCBTME   EQU   TCB+120                                                  01533000
TCBJSTCB EQU   TCB+124                                                  01534000
TCBTSFLG EQU   TCB+148                                                  01535000
TCBTSTSK EQU   TCBTSFLG                                                 01536000
TCBSTAB  EQU   TCB+160                                                  01537000
TCBNSTAE EQU   TCBSTAB                                                  01538000
TCBSTABB EQU   TCBSTAB+1                                                01539000
TCBTCT   EQU   TCB+164                                                  01540000
TCBTCTGF EQU   TCBTCT                                                   01541000
TCBSCNDY EQU   TCB+172                                                  01542000
TCBNDSP  EQU   TCBSCNDY                                                 01543000
TCBNDSP1 EQU   TCBNDSP+1                                                01544000
TCBNDSP2 EQU   TCBNDSP+2                                                01545000
TCBNDSP3 EQU   TCBNDSP+3                                                01546000
TCBJSCB  EQU   TCB+180                                                  01547000
TCBRECDE EQU   TCBJSCB                                                  01548000
TCBEXT1  EQU   TCB+196                                                  01549000
TCBBITS  EQU   TCB+200                                                  01550000
TCBNDSP4 EQU   TCBBITS                                                  01551000
TCBNDSP5 EQU   TCBBITS+1                                                01552000
TCBFLGS6 EQU   TCBBITS+2                                                01553000
TCBFLGS7 EQU   TCBBITS+3                                                01554000
TCBDAR   EQU   TCB+204                                                  01555000
TCBDARC  EQU   TCBDAR                                                   01556000
TCBEXT2  EQU   TCB+208                                                  01557000
TCBFOE   EQU   TCB+244                                                  01558000
TCBESTAE EQU   TCB+264                                                  01559000
TCBESTRM EQU   TCBESTAE+1                                               01560000
TCBFBYT1 EQU   TCB+276                                                  01561000
TCBFBYT2 EQU   TCB+277                                                  01562000
TCBRV124 EQU   TCB+278                                                  01563000
TCBRV133 EQU   TCB+279                                                  01564000
TCBXTNT2 EQU   0                                                        01565000
TCBGTF   EQU   TCBXTNT2                                                 01566000
TCBTFLG  EQU   TCBGTF                                                   01567000
TCBRV146 EQU   TCBXTNT2+28                                              01568000
TCBRV155 EQU   TCBXTNT2+29                                              01569000
TCBRV164 EQU   TCBXTNT2+30                                              01570000
TCBRV173 EQU   TCBXTNT2+31                                              01571000
CTGCON   EQU   0                                                        01572000
ACCNTRLS EQU   0                                                        01573000
ACNODD   EQU   ACCNTRLS                                                 01574000
ACDVWAIT EQU   ACCNTRLS                                                 01575000
ACRECOVR EQU   ACCNTRLS                                                 01576000
ACOSCVOL EQU   ACCNTRLS                                                 01577000
ACVLWAIT EQU   ACCNTRLS                                                 01578000
ACOFLINE EQU   ACCNTRLS                                                 01579000
ACNOENQ  EQU   ACCNTRLS                                                 01580000
ACNUJSCB EQU   ACCNTRLS                                                 01581000
ACOK2MNT EQU   ACCNTRLS+1                                               01582000
ACSTPCAT EQU   ACCNTRLS+1                                               01583000
ACALCTLG EQU   ACCNTRLS+1                                               01584000
ACOPNACB EQU   ACCNTRLS+1                                               01585000
ACCCPCCB EQU   ACCNTRLS+1                                               01586000
ACRECOVD EQU   ACCNTRLS+1                                               01587000
RTNINFOP EQU   0                                                        01588000
JSCBPTR  EQU   0                                                        01589000
CTGDSNP  EQU   0                                                        01590000
CTGCONP  EQU   0                                                        01591000
DDNAMP   EQU   0                                                        01592000
JSCBSEC2 EQU   JSCBEND1                                                 01593000
JSCBSEC3 EQU   JSCBEND1                                                 01594000
JSCBJCT  EQU   JSCBSEC3                                                 01595000
JSCBJCTA EQU   JSCBJCT+1                                                01596000
JSCBASID EQU   JSCBSEC3+8                                               01597000
JSCBFBYT EQU   JSCBSEC3+10                                              01598000
JSCBJNL  EQU   JSCBSEC3+28                                              01599000
JSCBJJSB EQU   JSCBJNL                                                  01600000
JSCBSUB  EQU   JSCBSEC3+40                                              01601000
JSCSCT   EQU   JSCBSEC3+68                                              01602000
JSCBACT  EQU   JSCBSEC3+88                                              01603000
JSCRSV45 EQU   JSCBSEC3+112                                             01604000
JSCRSV46 EQU   JSCRSV45                                                 01605000
JSCRSV47 EQU   JSCRSV45+2                                               01606000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01607000
JSCBEND3 EQU   JSCBSEC3+120                                             01608000
JSCRSV52 EQU   JSCBSEC3+116                                             01609000
JSCRSV51 EQU   JSCRSV47+1                                               01610000
JSCRSV50 EQU   JSCRSV47                                                 01611000
JSCRSV49 EQU   JSCRSV46+1                                               01612000
JSCRSV48 EQU   JSCRSV46                                                 01613000
JSCRSV44 EQU   JSCBSEC3+108                                             01614000
JSCRSV43 EQU   JSCBSEC3+104                                             01615000
JSCRSV42 EQU   JSCBSEC3+100                                             01616000
JSCBASWA EQU   JSCBSEC3+96                                              01617000
JSCBUFPT EQU   JSCBSEC3+92                                              01618000
JSCBSWSP EQU   JSCBSEC3+87                                              01619000
JSCRSV33 EQU   JSCBSEC3+86                                              01620000
JSCDDNUM EQU   JSCBSEC3+84                                              01621000
JSCRSV53 EQU   JSCBSEC3+82                                              01622000
JSCDDNNO EQU   JSCBSEC3+80                                              01623000
JSCBVATA EQU   JSCBSEC3+76                                              01624000
JSCTMCOR EQU   JSCBSEC3+72                                              01625000
JSCSCTP  EQU   JSCSCT+1                                                 01626000
JSCRSV55 EQU   JSCSCT                                                   01627000
JSCRSV54 EQU   JSCBSEC3+64                                              01628000
JSCDSABQ EQU   JSCBSEC3+60                                              01629000
JSCBSSIB EQU   JSCBSEC3+56                                              01630000
JSCBFRBA EQU   JSCBSEC3+48                                              01631000
JSCRSV28 EQU   JSCBSEC3+46                                              01632000
JSCBSONO EQU   JSCBSEC3+44                                              01633000
JSCBSUBA EQU   JSCBSUB+1                                                01634000
JSCRSV31 EQU   JSCBSUB                                                  01635000
JSCBSMLR EQU   JSCBSEC3+36                                              01636000
JSCBJNLR EQU   JSCBSEC3+32                                              01637000
JSCBJNLA EQU   JSCBJNL+1                                                01638000
JSCBJSBT EQU   JSCBJJSB                                                 01639000
JSCBJSBX EQU   JSCBJJSB                                                 01640000
JSCBJSBA EQU   JSCBJJSB                                                 01641000
JSCBJSBI EQU   JSCBJJSB                                                 01642000
@NM00013 EQU   JSCBJJSB                                                 01643000
JSCBJNLE EQU   JSCBJJSB                                                 01644000
JSCBJNLF EQU   JSCBJJSB                                                 01645000
JSCBJNLN EQU   JSCBJJSB                                                 01646000
@NM00012 EQU   JSCBSEC3+24                                              01647000
JSCBJRBA EQU   JSCBSEC3+16                                              01648000
JSCBIECB EQU   JSCBSEC3+12                                              01649000
JSCBRV08 EQU   JSCBSEC3+11                                              01650000
JSCBRV07 EQU   JSCBFBYT                                                 01651000
JSCBRV06 EQU   JSCBFBYT                                                 01652000
JSCBRV05 EQU   JSCBFBYT                                                 01653000
JSCBRV04 EQU   JSCBFBYT                                                 01654000
JSCBRV03 EQU   JSCBFBYT                                                 01655000
JSCBRV02 EQU   JSCBFBYT                                                 01656000
JSCBADSP EQU   JSCBFBYT                                                 01657000
JSCBRV01 EQU   JSCBFBYT                                                 01658000
JSCBTJID EQU   JSCBASID                                                 01659000
JSCBPSCB EQU   JSCBSEC3+4                                               01660000
JSCJCTP  EQU   JSCBJCTA                                                 01661000
JSCRSV24 EQU   JSCBJCT                                                  01662000
JSCBEND2 EQU   JSCBSEC2                                                 01663000
@NM00004 EQU   ACCNTRLS+1                                               01664000
@NM00018 EQU   TCBXTNT2+32                                              01665000
TCBRV181 EQU   TCBRV173                                                 01666000
TCBRV180 EQU   TCBRV173                                                 01667000
TCBRV179 EQU   TCBRV173                                                 01668000
TCBRV178 EQU   TCBRV173                                                 01669000
TCBRV177 EQU   TCBRV173                                                 01670000
TCBRV176 EQU   TCBRV173                                                 01671000
TCBRV175 EQU   TCBRV173                                                 01672000
TCBRV174 EQU   TCBRV173                                                 01673000
TCBRV172 EQU   TCBRV164                                                 01674000
TCBRV171 EQU   TCBRV164                                                 01675000
TCBRV170 EQU   TCBRV164                                                 01676000
TCBRV169 EQU   TCBRV164                                                 01677000
TCBRV168 EQU   TCBRV164                                                 01678000
TCBRV167 EQU   TCBRV164                                                 01679000
TCBRV166 EQU   TCBRV164                                                 01680000
TCBRV165 EQU   TCBRV164                                                 01681000
TCBRV163 EQU   TCBRV155                                                 01682000
TCBRV162 EQU   TCBRV155                                                 01683000
TCBRV161 EQU   TCBRV155                                                 01684000
TCBRV160 EQU   TCBRV155                                                 01685000
TCBRV159 EQU   TCBRV155                                                 01686000
TCBRV158 EQU   TCBRV155                                                 01687000
TCBRV157 EQU   TCBRV155                                                 01688000
TCBRV156 EQU   TCBRV155                                                 01689000
TCBRV154 EQU   TCBRV146                                                 01690000
TCBRV153 EQU   TCBRV146                                                 01691000
TCBRV152 EQU   TCBRV146                                                 01692000
TCBRV151 EQU   TCBRV146                                                 01693000
TCBRV150 EQU   TCBRV146                                                 01694000
TCBRV149 EQU   TCBRV146                                                 01695000
TCBRV148 EQU   TCBRV146                                                 01696000
TCBRV147 EQU   TCBRV146                                                 01697000
TCBRV145 EQU   TCBXTNT2+26                                              01698000
TCBRV144 EQU   TCBXTNT2+24                                              01699000
TCBCAUF  EQU   TCBXTNT2+20                                              01700000
TCBRV142 EQU   TCBXTNT2+16                                              01701000
TCBRSV49 EQU   TCBXTNT2+12                                              01702000
TCBEVENT EQU   TCBXTNT2+8                                               01703000
TCBRCMP  EQU   TCBXTNT2+5                                               01704000
TCBRSVAB EQU   TCBXTNT2+4                                               01705000
TCBGTFA  EQU   TCBGTF+1                                                 01706000
TCBRSV47 EQU   TCBTFLG                                                  01707000
TCBRSV46 EQU   TCBTFLG                                                  01708000
TCBRSV45 EQU   TCBTFLG                                                  01709000
TCBRSV44 EQU   TCBTFLG                                                  01710000
TCBRSV43 EQU   TCBTFLG                                                  01711000
TCBDSPIT EQU   TCBTFLG                                                  01712000
TCBERRTN EQU   TCBTFLG                                                  01713000
TCBASYNC EQU   TCBTFLG                                                  01714000
@NM00017 EQU   TCB+296                                                  01715000
TCBSVCA2 EQU   TCB+292                                                  01716000
TCBSWASA EQU   TCB+288                                                  01717000
TCBDBTB  EQU   TCB+284                                                  01718000
TCBRPT   EQU   TCB+280                                                  01719000
TCBRV141 EQU   TCBRV133                                                 01720000
TCBRV140 EQU   TCBRV133                                                 01721000
TCBRV139 EQU   TCBRV133                                                 01722000
TCBRV138 EQU   TCBRV133                                                 01723000
TCBRV137 EQU   TCBRV133                                                 01724000
TCBRV136 EQU   TCBRV133                                                 01725000
TCBRV135 EQU   TCBRV133                                                 01726000
TCBRV134 EQU   TCBRV133                                                 01727000
TCBRV132 EQU   TCBRV124                                                 01728000
TCBRV131 EQU   TCBRV124                                                 01729000
TCBRV130 EQU   TCBRV124                                                 01730000
TCBRV129 EQU   TCBRV124                                                 01731000
TCBRV128 EQU   TCBRV124                                                 01732000
TCBRV127 EQU   TCBRV124                                                 01733000
TCBRV126 EQU   TCBRV124                                                 01734000
TCBRV125 EQU   TCBRV124                                                 01735000
TCBRV123 EQU   TCBFBYT2                                                 01736000
TCBRV122 EQU   TCBFBYT2                                                 01737000
TCBECBNV EQU   TCBFBYT2                                                 01738000
TCBSSSYN EQU   TCBFBYT2                                                 01739000
TCBFPRAP EQU   TCBFBYT2                                                 01740000
TCBFDW   EQU   TCBFBYT2                                                 01741000
TCBFMW   EQU   TCBFBYT2                                                 01742000
TCBCNCB  EQU   TCBFBYT2                                                 01743000
TCBLLH   EQU   TCBFBYT1                                                 01744000
TCBRV113 EQU   TCBFBYT1                                                 01745000
TCBEOT   EQU   TCBFBYT1                                                 01746000
TCBRTM2  EQU   TCBFBYT1                                                 01747000
TCBPGNLY EQU   TCBFBYT1                                                 01748000
TCBNDIOS EQU   TCBFBYT1                                                 01749000
TCBACTIV EQU   TCBFBYT1                                                 01750000
TCBEOTFM EQU   TCBFBYT1                                                 01751000
TCBAFFN  EQU   TCB+274                                                  01752000
TCBCCPVI EQU   TCB+272                                                  01753000
TCBUKYSP EQU   TCB+268                                                  01754000
TCBMODE  EQU   TCBESTAE+3                                               01755000
TCBERTYP EQU   TCBESTAE+2                                               01756000
TCBRV314 EQU   TCBESTRM                                                 01757000
TCBRV313 EQU   TCBESTRM                                                 01758000
TCBRV312 EQU   TCBESTRM                                                 01759000
TCBRV311 EQU   TCBESTRM                                                 01760000
TCBRV310 EQU   TCBESTRM                                                 01761000
TCBRV309 EQU   TCBESTRM                                                 01762000
TCBRV308 EQU   TCBESTRM                                                 01763000
TCBETERM EQU   TCBESTRM                                                 01764000
TCBSCBKY EQU   TCBESTAE                                                 01765000
TCBRTM12 EQU   TCB+260                                                  01766000
TCBTCBID EQU   TCB+256                                                  01767000
TCBRSV96 EQU   TCB+252                                                  01768000
TCBSWA   EQU   TCB+248                                                  01769000
TCBFOEA  EQU   TCBFOE+1                                                 01770000
TCBRSV42 EQU   TCBFOE                                                   01771000
TCBRV306 EQU   TCB+240                                                  01772000
TCBRSV41 EQU   TCB+239                                                  01773000
TCBTID   EQU   TCB+238                                                  01774000
TCBRSVAA EQU   TCB+237                                                  01775000
TCBABCUR EQU   TCB+236                                                  01776000
TCBTMSAV EQU   TCB+232                                                  01777000
TCBIOTIM EQU   TCB+228                                                  01778000
TCBRTWA  EQU   TCB+224                                                  01779000
TCBBACK  EQU   TCB+220                                                  01780000
TCBTIRB  EQU   TCB+216                                                  01781000
TCBAECB  EQU   TCB+212                                                  01782000
TCBEXT2A EQU   TCBEXT2+1                                                01783000
TCBRSV39 EQU   TCBEXT2                                                  01784000
TCBSTMCT EQU   TCB+207                                                  01785000
TCBSYSCT EQU   TCB+206                                                  01786000
TCBRSV37 EQU   TCB+205                                                  01787000
TCBEXSVC EQU   TCBDAR                                                   01788000
TCBDARMS EQU   TCBDAR                                                   01789000
TCBDARWT EQU   TCBDAR                                                   01790000
TCBDARO  EQU   TCBDAR                                                   01791000
TCBDARMC EQU   TCBDARC                                                  01792000
TCBDARD  EQU   TCBDAR                                                   01793000
TCBDARS  EQU   TCBDAR                                                   01794000
TCBDARP  EQU   TCBDAR                                                   01795000
TCBGTOFM EQU   TCBFLGS7                                                 01796000
TCBADMP  EQU   TCBFLGS7                                                 01797000
TCBRSTSK EQU   TCBFLGS7                                                 01798000
TCBSVCS  EQU   TCBFLGS7                                                 01799000
TCBSTACK EQU   TCBFLGS7                                                 01800000
TCBRSV34 EQU   TCBFLGS7                                                 01801000
TCBRSV33 EQU   TCBFLGS7                                                 01802000
TCBGPECB EQU   TCBFLGS7                                                 01803000
TCBNTJS  EQU   TCBFLGS6                                                 01804000
TCBAPG   EQU   TCBFLGS6                                                 01805000
TCBMIGR  EQU   TCBFLGS6                                                 01806000
TCBRV303 EQU   TCBFLGS6                                                 01807000
TCBSPVLK EQU   TCBFLGS6                                                 01808000
TCBCPU   EQU   TCBFLGS6                                                 01809000
TCBPIE17 EQU   TCBFLGS6                                                 01810000
TCBRV    EQU   TCBFLGS6                                                 01811000
TCBRSV79 EQU   TCBNDSP5                                                 01812000
TCBRSV78 EQU   TCBNDSP5                                                 01813000
TCBRSV77 EQU   TCBNDSP5                                                 01814000
TCBRSV76 EQU   TCBNDSP5                                                 01815000
TCBRSV75 EQU   TCBNDSP5                                                 01816000
TCBRSV74 EQU   TCBNDSP5                                                 01817000
TCBRSV95 EQU   TCBNDSP5                                                 01818000
TCBRSV94 EQU   TCBNDSP5                                                 01819000
TCBRSV93 EQU   TCBNDSP4                                                 01820000
TCBRSV92 EQU   TCBNDSP4                                                 01821000
TCBRSV91 EQU   TCBNDSP4                                                 01822000
TCBRSV90 EQU   TCBNDSP4                                                 01823000
TCBRSV89 EQU   TCBNDSP4                                                 01824000
TCBRSV88 EQU   TCBNDSP4                                                 01825000
TCBRSV87 EQU   TCBNDSP4                                                 01826000
TCBRSV86 EQU   TCBNDSP4                                                 01827000
TCBEXT1A EQU   TCBEXT1+1                                                01828000
TCBRSV32 EQU   TCBEXT1                                                  01829000
TCBEXCPD EQU   TCB+192                                                  01830000
TCBIOBRC EQU   TCB+188                                                  01831000
TCBDDWTC EQU   TCB+186                                                  01832000
TCBDDEXC EQU   TCB+184                                                  01833000
TCBJSCBB EQU   TCBJSCB+1                                                01834000
@NM00016 EQU   TCBRECDE                                                 01835000
TCBREC   EQU   TCBRECDE                                                 01836000
TCBMDIDS EQU   TCB+176                                                  01837000
TCBNDINT EQU   TCBNDSP3                                                 01838000
TCBRSV27 EQU   TCBNDSP3                                                 01839000
TCBRSV26 EQU   TCBNDSP3                                                 01840000
TCBRSV25 EQU   TCBNDSP3                                                 01841000
TCBRSV24 EQU   TCBNDSP3                                                 01842000
TCBSRBND EQU   TCBNDSP3                                                 01843000
TCBRV302 EQU   TCBNDSP3                                                 01844000
TCBLJSND EQU   TCBNDSP3                                                 01845000
TCBABE   EQU   TCBNDSP2                                                 01846000
TCBDSS   EQU   TCBNDSP2                                                 01847000
TCBOWAIT EQU   TCBNDSP2                                                 01848000
TCBIWAIT EQU   TCBNDSP2                                                 01849000
TCBNDTS  EQU   TCBNDSP2                                                 01850000
TCBNDSVC EQU   TCBNDSP2                                                 01851000
TCBSTPP  EQU   TCBNDSP2                                                 01852000
TCBABD   EQU   TCBNDSP2                                                 01853000
TCBRSV22 EQU   TCBNDSP1                                                 01854000
TCBPIEND EQU   TCBNDSP1                                                 01855000
TCBTPSP  EQU   TCBNDSP1                                                 01856000
TCBDDRND EQU   TCBNDSP1                                                 01857000
TCBRSPND EQU   TCBNDSP1                                                 01858000
TCBRSTND EQU   TCBNDSP1                                                 01859000
TCBDARPN EQU   TCBNDSP1                                                 01860000
TCBDARTN EQU   TCBNDSP1                                                 01861000
TCBNDSP0 EQU   TCBNDSP                                                  01862000
TCBUSER  EQU   TCB+168                                                  01863000
TCBTCTB  EQU   TCBTCT+1                                                 01864000
TCBRSV9C EQU   TCBTCTGF                                                 01865000
TCBRSV9B EQU   TCBTCTGF                                                 01866000
TCBRSV9A EQU   TCBTCTGF                                                 01867000
TCBRSV99 EQU   TCBTCTGF                                                 01868000
TCBRSV98 EQU   TCBTCTGF                                                 01869000
TCBRSV97 EQU   TCBTCTGF                                                 01870000
TCBRSV20 EQU   TCBTCTGF                                                 01871000
TCBSMFGF EQU   TCBTCTGF                                                 01872000
TCBSTCUR EQU   TCBNSTAE                                                 01873000
TCBRV301 EQU   TCBNSTAE                                                 01874000
TCBSYNCH EQU   TCBNSTAE                                                 01875000
TCBHALT  EQU   TCBNSTAE                                                 01876000
TCBPPSUP EQU   TCBNSTAE                                                 01877000
TCB33E   EQU   TCBNSTAE                                                 01878000
TCBQUIES EQU   TCBNSTAE                                                 01879000
TCBSTABE EQU   TCBNSTAE                                                 01880000
TCBAQE   EQU   TCB+156                                                  01881000
TCBPQE   EQU   TCB+152                                                  01882000
TCBTSDP  EQU   TCB+151                                                  01883000
TCBTSLP  EQU   TCB+150                                                  01884000
TCBSTPCT EQU   TCB+149                                                  01885000
TCBCPUBN EQU   TCBTSFLG                                                 01886000
TCBDYDSP EQU   TCBTSFLG                                                 01887000
TCBRSV18 EQU   TCBTSFLG                                                 01888000
TCBRSV17 EQU   TCBTSFLG                                                 01889000
TCBTIOTG EQU   TCBTSFLG                                                 01890000
TCBATT   EQU   TCBTSFLG                                                 01891000
TCBSTPPR EQU   TCBTSFLG                                                 01892000
TCBRV300 EQU   TCBTSTSK                                                 01893000
TCBECB   EQU   TCB+144                                                  01894000
TCBIQE   EQU   TCB+140                                                  01895000
TCBLTC   EQU   TCB+136                                                  01896000
TCBOTC   EQU   TCB+132                                                  01897000
TCBNTC   EQU   TCB+128                                                  01898000
TCBJSTCA EQU   TCBJSTCB+1                                               01899000
TCBRSV16 EQU   TCBJSTCB                                                 01900000
TCBTQET  EQU   TCBTME                                                   01901000
TCBTCB   EQU   TCB+116                                                  01902000
TCBFSAB  EQU   TCBFSA+1                                                 01903000
TCBQEL   EQU   TCBFSA                                                   01904000
TCBGRS15 EQU   TCBGRS+60                                                01905000
TCBGRS14 EQU   TCBGRS+56                                                01906000
TCBGRS13 EQU   TCBGRS+52                                                01907000
TCBGRS12 EQU   TCBGRS+48                                                01908000
TCBGRS11 EQU   TCBGRS+44                                                01909000
TCBGRS10 EQU   TCBGRS+40                                                01910000
TCBGRS9  EQU   TCBGRS+36                                                01911000
TCBGRS8  EQU   TCBGRS+32                                                01912000
TCBGRS7  EQU   TCBGRS+28                                                01913000
TCBGRS6  EQU   TCBGRS+24                                                01914000
TCBGRS5  EQU   TCBGRS+20                                                01915000
TCBGRS4  EQU   TCBGRS+16                                                01916000
TCBGRS3  EQU   TCBGRS+12                                                01917000
TCBGRS2  EQU   TCBGRS+8                                                 01918000
TCBGRS1  EQU   TCBGRS+4                                                 01919000
TCBGRS0  EQU   TCBGRS                                                   01920000
TCBJPQB  EQU   TCBJPQ+1                                                 01921000
TCBRSV15 EQU   TCBPURGE                                                 01922000
TCBRSV14 EQU   TCBPURGE                                                 01923000
TCBRSV13 EQU   TCBPURGE                                                 01924000
TCBRSV12 EQU   TCBPURGE                                                 01925000
TCBRSV11 EQU   TCBPURGE                                                 01926000
TCBRSV10 EQU   TCBPURGE                                                 01927000
TCBRSV09 EQU   TCBPURGE                                                 01928000
TCBJPQF  EQU   TCBPURGE                                                 01929000
TCBJLB   EQU   TCB+40                                                   01930000
TCBLLS   EQU   TCB+36                                                   01931000
TCBDSP   EQU   TCB+35                                                   01932000
TCBLMP   EQU   TCB+34                                                   01933000
TCBPNDSP EQU   TCBFLGS5                                                 01934000
TCBFCD1  EQU   TCBFLGS5                                                 01935000
TCBSTP   EQU   TCBFLGS5                                                 01936000
TCBSYS   EQU   TCBFLGS5                                                 01937000
TCBANDSP EQU   TCBFLGS5                                                 01938000
TCBPAGE  EQU   TCBFLGS5                                                 01939000
TCBUXNDF EQU   TCBABWF                                                  01940000
TCBFC    EQU   TCBFLGS5                                                 01941000
TCBONDSP EQU   TCBFLGS4                                                 01942000
TCBMPCND EQU   TCBFLGS4                                                 01943000
TCBMPCVQ EQU   TCBFLGS4                                                 01944000
TCBUXNDV EQU   TCBFLGS4                                                 01945000
TCBHNDSP EQU   TCBFLGS4                                                 01946000
TCBRQENA EQU   TCBFLGS4                                                 01947000
TCBSER   EQU   TCBFLGS4                                                 01948000
TCBNDUMP EQU   TCBFLGS4                                                 01949000
TCBDWSTA EQU   TCBFLGS3                                                 01950000
TCBRSV08 EQU   TCBFLGS3                                                 01951000
TCBRSV07 EQU   TCBFLGS3                                                 01952000
TCBRSV06 EQU   TCBFLGS3                                                 01953000
TCBABGM  EQU   TCBFLGS3                                                 01954000
TCBABTRM EQU   TCBFLGS3                                                 01955000
TCBADINP EQU   TCBFLGS3                                                 01956000
TCBFSM   EQU   TCBFLGS3                                                 01957000
TCBFTS   EQU   TCBFLGS2                                                 01958000
TCBFETXR EQU   TCBFLGS2                                                 01959000
TCBFDSOP EQU   TCBFLGS2                                                 01960000
TCBFJMC  EQU   TCBFLGS2                                                 01961000
TCBFSMC  EQU   TCBFLGS2                                                 01962000
TCBFABOP EQU   TCBFLGS2                                                 01963000
TCBFSTI  EQU   TCBFLGS2                                                 01964000
TCBFOINP EQU   TCBFLGS2                                                 01965000
TCBFX    EQU   TCBFLGS1                                                 01966000
TCBFS    EQU   TCBFLGS1                                                 01967000
TCBFT    EQU   TCBFLGS1                                                 01968000
TCBPDUMP EQU   TCBFLGS1                                                 01969000
TCBNONPR EQU   TCBFLGS1                                                 01970000
TCBFERA  EQU   TCBFLGS1                                                 01971000
TCBFE    EQU   TCBFLGS1                                                 01972000
TCBFA    EQU   TCBFLGS1                                                 01973000
TCBZERO  EQU   TCBPKF                                                   01974000
TCBFLAG  EQU   TCBPKF                                                   01975000
TCBMSSB  EQU   TCBMSS+1                                                 01976000
TCBRSV03 EQU   TCBMSS                                                   01977000
TCBTRNB  EQU   TCBTRN+1                                                 01978000
TCBRSV02 EQU   TCBABF                                                   01979000
TCBOLTEP EQU   TCBABF                                                   01980000
TCBTCP   EQU   TCBABF                                                   01981000
TCBTCPP  EQU   TCBABF                                                   01982000
TCBRSV01 EQU   TCBABF                                                   01983000
TCBGRPH  EQU   TCBABF                                                   01984000
TCBNOCHK EQU   TCBABF                                                   01985000
TCBMOD91 EQU   TCBABF                                                   01986000
TCBCMPC  EQU   TCBCMP+1                                                 01987000
TCBRV318 EQU   TCBCMSG                                                  01988000
TCBRV317 EQU   TCBCIND                                                  01989000
TCBRV316 EQU   TCBCWTO                                                  01990000
TCBCASID EQU   TCBCDBL                                                  01991000
TCBNOCC  EQU   TCBSTCC                                                  01992000
TCBDMPO  EQU   TCBCPP                                                   01993000
TCBCSTEP EQU   TCBCMPF                                                  01994000
TCBCREQ  EQU   TCBCMPF                                                  01995000
TCBTIO   EQU   TCB+12                                                   01996000
TCBDEB   EQU   TCB+8                                                    01997000
TCBPIEA  EQU   TCBPIE+1                                                 01998000
TCBPM    EQU   TCBPMASK                                                 01999000
@NM00015 EQU   TCBPMASK                                                 02000000
TCBRBP   EQU   TCB                                                      02001000
TCBFRS6  EQU   TCBFRS+24                                                02002000
TCBFRS4  EQU   TCBFRS+16                                                02003000
TCBFRS2  EQU   TCBFRS+8                                                 02004000
TCBFRS0  EQU   TCBFRS                                                   02005000
PCCRSVD2 EQU   IEFPCCB+128                                              02006000
PCCLACBP EQU   IEFPCCB+124                                              02007000
PCCRSVD1 EQU   IEFPCCB+122                                              02008000
PCVOLSER EQU   IEFPCCB+116                                              02009000
PCCACBP  EQU   IEFPCCB+16                                               02010000
PCCSTAT4 EQU   PCCSTATS+3                                               02011000
PCCSTAT3 EQU   PCCSTATS+2                                               02012000
PCCSTAT2 EQU   PCCSTATS+1                                               02013000
@NM00014 EQU   PCCSTAT1                                                 02014000
PCCTCL   EQU   PCCSTAT1                                                 02015000
PCCACTIV EQU   PCCSTAT1                                                 02016000
PCCALIAS EQU   PCCSTAT1                                                 02017000
PCCSTEPC EQU   PCCSTAT1                                                 02018000
PCCPREVP EQU   IEFPCCB+8                                                02019000
PCCACRO  EQU   IEFPCCB                                                  02020000
JSCBCSCB EQU   JSCBSEC1+68                                              02021000
JSCBPMG  EQU   JSCBWTP+2                                                02022000
JSCBWTSP EQU   JSCBWTP+1                                                02023000
JSCRSV23 EQU   JSCBWTFG                                                 02024000
JSCRSV22 EQU   JSCBWTFG                                                 02025000
JSCRSV21 EQU   JSCBWTFG                                                 02026000
JSCRSV20 EQU   JSCBWTFG                                                 02027000
JSCRSV19 EQU   JSCBWTFG                                                 02028000
JSCRSV18 EQU   JSCBWTFG                                                 02029000
JSCBRET  EQU   JSCBWTFG                                                 02030000
JSCBIOFG EQU   JSCBWTFG                                                 02031000
@NM00011 EQU   JSCBSEC1+60                                              02032000
JSCBQMPI EQU   JSCBSEC1+56                                              02033000
JSCBPMSG EQU   JSCBSWT1                                                 02034000
JSCRSV16 EQU   JSCBSWT1                                                 02035000
JSCRSV15 EQU   JSCBSWT1                                                 02036000
JSCRSV14 EQU   JSCBSWT1                                                 02037000
JSCRSV13 EQU   JSCBSWT1                                                 02038000
JSCRSV12 EQU   JSCBSWT1                                                 02039000
JSCRSV11 EQU   JSCBSWT1                                                 02040000
JSCBPASS EQU   JSCBSWT1                                                 02041000
JSCBTTTR EQU   JSCBSEC1+52                                              02042000
JSCRSV10 EQU   JSCBSEC1+49                                              02043000
JSCBAUTH EQU   JSCBOPTS                                                 02044000
JSCSIOTS EQU   JSCBOPTS                                                 02045000
JSCRSV08 EQU   JSCBOPTS                                                 02046000
JSCRSV07 EQU   JSCBOPTS                                                 02047000
JSCRSV06 EQU   JSCBOPTS                                                 02048000
JSCBLONG EQU   JSCBOPTS                                                 02049000
JSCRSV05 EQU   JSCBOPTS                                                 02050000
JSCRSV04 EQU   JSCBOPTS                                                 02051000
JSCBSECB EQU   JSCBSEC1+44                                              02052000
JSCRSV03 EQU   JSCBSEC1+41                                              02053000
JSCBSTEP EQU   JSCBSEC1+40                                              02054000
JSCBDCBA EQU   JSCBDCB+1                                                02055000
JSCRSV02 EQU   JSCBDCB                                                  02056000
JSCBID   EQU   JSCBSEC1+32                                              02057000
JSCBDBTB EQU   JSCBSEC1+28                                              02058000
JSCBIJSC EQU   JSCBSEC1+24                                              02059000
JSCBTCBP EQU   JSCBSEC1+20                                              02060000
JSCBTCP  EQU   JSCBSEC1+12                                              02061000
JSCBSHR  EQU   JSCBSEC1+8                                               02062000
JSCHPCEA EQU   JSCHPCE+1                                                02063000
JSCRSV32 EQU   JSCHPCE                                                  02064000
JSCRSV01 EQU   JSCBSEC1                                                 02065000
@NM00010 EQU   IEZJSCB                                                  02066000
S99TUPRM EQU   S99TUFLD+2                                               02067000
S99TULEN EQU   S99TUFLD                                                 02068000
S99TUPND EQU   S99TUP                                                   02069000
S99TUPLN EQU   S99TUPTR                                                 02070000
ETCBP    EQU   EPARMLST+432                                             02071000
EEINTIOT EQU   EPARMLST+428                                             02072000
ERESCD   EQU   ERETURNS+2                                               02073000
ERETCD   EQU   ERETURNS                                                 02074000
@NM00008 EQU   EECNTRLS+1                                               02075000
@NM00007 EQU   EECNTRLS+1                                               02076000
EENOUNCT EQU   EECNTRLS+1                                               02077000
EESWTIOT EQU   EECNTRLS+1                                               02078000
@NM00006 EQU   EPARMLST                                                 02079000
ASWACHNP EQU   ASWA+36                                                  02080000
ASWRSV02 EQU   ASWAFLGS+1                                               02081000
ASWRSV01 EQU   ASWADSWS                                                 02082000
ASWADYUE EQU   ASWADSWS                                                 02083000
ASWAVMVF EQU   ASWADSWS                                                 02084000
ASWACOMF EQU   ASWADSWS                                                 02085000
ASWADYNF EQU   ASWADSWS                                                 02086000
ASWAOLDP EQU   ASWA+24                                                  02087000
RESCD    EQU   RETURNS+2                                                02088000
RETCD    EQU   RETURNS                                                  02089000
NEXTTCBP EQU   TWOTCBPS                                                 02090000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02091000
@RF00299 EQU   @RC00291                                                 02092000
@ENDDATA EQU   *                                                        02093000
         END   IEFAB4F5,(C'PLS2117',0701,78089)                         02094000
