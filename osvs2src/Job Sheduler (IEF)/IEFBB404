         TITLE 'IEFBB404 - STEP ALLOCATION CONTROL                     *00001000
                        '                                               00002000
IEFBB404 CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'IEFBB404  78.089'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  DS    0H                                               01S0001 00012000
         USING @PSTART,@12                                      01S0001 00013000
         L     @00,@SIZDATD                                     01S0001 00014000
         MODESET EXTKEY=SCHED,SAVEKEY=(2)                               00015000
         GSPACE   R,LV=(0)                                              00016000
         LR    @11,@01                                          01S0001 00017000
         USING @DATD,@11                                        01S0001 00018000
         ST    @13,@SA00001+4                                   01S0001 00019000
         STC   @02,@OLDKEY                                      01S0001 00020000
         MODESET KEYADDR=(2)                                            00021000
         LM    @00,@02,20(@13)                                  01S0001 00022000
         ST    @11,8(,@13)                                      01S0001 00023000
         LR    @13,@11                                          01S0001 00024000
         MODESET EXTKEY=ZERO                                            00025000
         MVC   @PC00001(64),0(@01)                              01S0001 00026000
         MODESET EXTKEY=SCHED                                           00027000
*RTNCODE = SUCCESS;                    /*INITIALIZE RETURN CODE TO 0 */ 00028000
         SLR   RTNCODE,RTNCODE                                  01S0045 00029000
*RESNAREA = RESNAREA && RESNAREA;      /*CLEAR REASON CODES  @G29AN2F*/ 00030000
         L     @10,@PC00001+28                                  01S0046 00031000
         XC    RESNAREA(6,@10),RESNAREA(@10)                    01S0046 00032000
*/********************************************************************/ 00033000
*/*                                                                  */ 00034000
*/* SEGMENT NAME - SETFUNMP                                          */ 00035000
*/*                                                                  */ 00036000
*/* DESCRIPTIVE NAME - SETUP FUNCTION MAPS                           */ 00037000
*/*                                                                  */ 00038000
*/* FUNCTION -                                                       */ 00039000
*/*   THE PURPOSE OF THIS CODE SEGMENT IS TO SET UP THE FUNCTION     */ 00040000
*/*   MAPS FOR JFCB HOUSEKEEPING AND COMMON ALLOCATION.              */ 00041000
*/*                                                                  */ 00042000
*/*   THE VARIABLE FIELDS IN THESE FUNCTION  MAPS ARE SET ON OR      */ 00043000
*/*   OFF DEPENDING ON THE FUNCTION MAP FOR THE STEP ALLOCATION      */ 00044000
*/*   CONTROL MODULE AND (IN ONE CASE) ON A FIELD IN THE JCT(INCMALL)*/ 00045000
*/*                                                                  */ 00046000
*/* ENTRY - THIS CODE IS AN IN-LINE SUBROUTINE WHICH IS ENTERED      */ 00047000
*/*         AT THE TOP.                                              */ 00048000
*/*                                                                  */ 00049000
*/*   PUPPOSE - SEE FUNCTION                                         */ 00050000
*/*                                                                  */ 00051000
*/*   INPUT -                                                        */ 00052000
*/*            JCT - JOB CONTROL TABLE                               */ 00053000
*/*            INFUNMAP - FUNCTION MAP FOR THE STEP ALLOCATION       */ 00054000
*/*                       CONTROL ROUTINE.                           */ 00055000
*/*                                                                  */ 00056000
*/* EXITS - THIS CODE IS AN IN-LINE SUBROUTINE WHICH EXITS           */ 00057000
*/*         FROM THE BOTTOM.                                         */ 00058000
*/*                                                                  */ 00059000
*/*   CONDITION - (NORMAL). FUNCTION MAPS ARE BUILT FOR JFCB         */ 00060000
*/*               HOUSEKEEPING AND COMMON ALLOCATION PROCESSING.     */ 00061000
*/*                                                                  */ 00062000
*/*   OUTPUT -                                                       */ 00063000
*/*            ALFUNMAP - FUNCTION MAP FOR COMMON ALLOCATION         */ 00064000
*/*            JHFUNMAP - FUNCTION MAP FOR JFCB HOUSEKEEPING         */ 00065000
*/*                                                                  */ 00066000
*/*   RETURN CODE - (NONE)                                           */ 00067000
*/*                                                                  */ 00068000
*/********************************************************************/ 00069000
*JHFUNMAP = JHINITFM;                  /*INITIALIZE JFCB HSKPING        00070000
*                                        FUNCTION MAP                */ 00071000
         MVC   JHFUNMAP(2),@CB00442                             02S0047 00072000
*JHRETMAP = JHRETMAP&&JHRETMAP;        /*CLEAR HSKP RETURN FUNC MAP     00073000
*                                                            @G24LPSJ*/ 00074000
         XC    JHRETMAP(1),JHRETMAP                             02S0048 00075000
*RFY FUNCMAP BASED(ADDR(ALFUNMAP));                             02S0049 00076000
*FUNCMAP = ALINITFM;                   /*INITIALIZE ALLOCATION  02S0050 00077000
*                                        FUNCTION MAP                */ 00078000
         LA    @10,ALFUNMAP                                     02S0050 00079000
         MVC   FUNCMAP(2,@10),@CB00438                          02S0050 00080000
*ALCSUBWT = ON;                        /*OK TO WAIT FOR SUB-SYSTEM      00081000
*                                        DATA SET                    */ 00082000
*SSEMSGSW = ON;                        /*SUB-SYSTEM TO RETURN ERROR     00083000
*                                        MESSAGES            @G29AN2F*/ 00084000
         OI    ALCSUBWT(@10),B'10000100'                        02S0052 00085000
*IF INUWAISW = CANWAIT THEN            /*ARE WAITS FOR UNITS OK      */ 00086000
         L     @07,@PC00001                                     02S0053 00087000
         TM    INUWAISW(@07),B'01000000'                        02S0053 00088000
         BNO   @RF00053                                         02S0053 00089000
*  DO;                                 /*YES,INDICATE TO JFCB HSKPING   00090000
*                                        AND ALLOCATION              */ 00091000
*    JUWAITSW = CANWAIT;               /*SET IN JFCB HSKP FUNC MAP   */ 00092000
         OI    JUWAITSW,B'00010000'                             02S0055 00093000
*    ALCWTUNT = CANWAIT;               /*SET IN ALLOCATION FUNC MAP  */ 00094000
         OI    ALCWTUNT(@10),B'00100000'                        02S0056 00095000
*  END;                                                         02S0057 00096000
*ELSE;                                 /*NO UNIT WAITS, USE     02S0058 00097000
*                                        INITIALIZED FUNCTION MAPS   */ 00098000
@RF00053 DS    0H                                               02S0059 00099000
*IF INVWAISW = CANWAIT THEN            /*ARE WAITS FOR VOLS + DSNS OK*/ 00100000
         L     @10,@PC00001                                     02S0059 00101000
         TM    INVWAISW(@10),B'10000000'                        02S0059 00102000
         BNO   @RF00059                                         02S0059 00103000
*   DO;                                /*YES,INDICATE TO JFCB HSKPING   00104000
*                                        AND ALLOCATION              */ 00105000
*     JVWAITSW = CANWAIT;              /*SET IN JFCB HSKP FUNC MAP   */ 00106000
         OI    JVWAITSW,B'00000010'                             02S0061 00107000
*     ALCWTVOL = CANWAIT;              /*SET IN ALLOCATION FUNC MAP  */ 00108000
         LA    @10,ALFUNMAP                                     02S0062 00109000
         OI    ALCWTVOL(@10),B'00010000'                        02S0062 00110000
*   END;                                                        02S0063 00111000
*ELSE;                                 /*NO VOL OR DSN WAITS, USE       00112000
*                                        INITIALIZED FUNCTION MAPS   */ 00113000
@RF00059 DS    0H                                               02S0065 00114000
*IF USEOFFSW = ON THEN                 /*ARE OFFLINES TO BE USED?    */ 00115000
         L     @10,@PC00001                                     02S0065 00116000
         TM    USEOFFSW(@10),B'00001000'                        02S0065 00117000
         BNO   @RF00065                                         02S0065 00118000
*  DO;                                 /*YES,INDICATE TO JFCB HSKPING   00119000
*                                        AND ALLOCATION              */ 00120000
*    JHOFFSW = ON;                     /*SET IN JFCB HSKP FUNC MAP   */ 00121000
         OI    JHOFFSW,B'10000000'                              02S0067 00122000
*    ALCOFFDV = ON;                    /*SET IN ALLOCATION FUNC MAP  */ 00123000
         LA    @10,ALFUNMAP                                     02S0068 00124000
         OI    ALCOFFDV(@10),B'00000100'                        02S0068 00125000
*  END;                                                         02S0069 00126000
*ELSE;                                 /*DONT USE OFFLINES, USE 02S0070 00127000
*                                        INITIALIZED FUNCTION MAPS   */ 00128000
@RF00065 DS    0H                                               02S0071 00129000
*IF INCMALL = ON THEN                  /*IS ALLOCATION MSGLEVEL=1    */ 00130000
         L     @10,@PC00001+12                                  02S0071 00131000
         L     @10,JCTPTR(,@10)                                 02S0071 00132000
         TM    INCMALL(@10),B'10000000'                         02S0071 00133000
         BNO   @RF00071                                         02S0071 00134000
*  DO;                                 /*YES,INDICATE TO ALLOCATION  */ 00135000
*    ALCMSGLV = ON;                    /*SET MSGLEVEL=1 IN FUNC MAP  */ 00136000
         LA    @10,ALFUNMAP                                     02S0073 00137000
         OI    ALCMSGLV(@10),B'01000000'                        02S0073 00138000
*    ALCHDMSG = ON;                    /*INDICATE WRITE HDR MSG      */ 00139000
         OI    ALCHDMSG(@10),B'01000000'                        02S0074 00140000
*  END;                                                         02S0075 00141000
*ELSE;                                 /*NO,KEEP MSGLEVEL=0 IN MAP   */ 00142000
@RF00071 DS    0H                                               02S0077 00143000
*IF MONJOBSW = ON THEN                 /*IS MONITOR JOBNAMES ON      */ 00144000
         L     @10,@PC00001                                     02S0077 00145000
         TM    MONJOBSW(@10),B'00000100'                        02S0077 00146000
         BNO   @RF00077                                         02S0077 00147000
*  DO;                                 /*YES, INDICATE TO ALLOCATION */ 00148000
*    ALCJOBNM = ON;                    /*SET MONITOR JOBNAMES ON     */ 00149000
         LA    @10,ALFUNMAP                                     02S0079 00150000
         OI    ALCJOBNM(@10),B'00100000'                        02S0079 00151000
*  END;                                                         02S0080 00152000
*ELSE;                                 /*NO, KEEP NO MTRJOBNAMES     */ 00153000
@RF00077 DS    0H                                               02S0082 00154000
*IF INNDSISW = ON THEN                 /*DATA SET INTEGRITY TO BE       00155000
*                                        DONE IF JOBLIB OR STEPLIB      00156000
*                                        EXISTS?                     */ 00157000
         L     @10,@PC00001                                     02S0082 00158000
         TM    INNDSISW(@10),B'00000010'                        02S0082 00159000
         BNO   @RF00082                                         02S0082 00160000
*  JHNDSISW = ON;                      /*NO, TELL HSKP'NG SO         */ 00161000
         OI    JHNDSISW,B'00000100'                             02S0083 00162000
*IF SIOT1PTR ^= ZERO THEN              /*ARE THERE ANY DD REQUESTS   */ 00163000
@RF00082 L     @10,@PC00001+32                                  01S0084 00164000
         ICM   @07,15,SIOT1PTR(@10)                             01S0084 00165000
         BZ    @RF00084                                         01S0084 00166000
*  DO;                                 /*YES DD REQUESTS, COMPLETE   */ 00167000
*    CALL IEFAB451                     /*CALL JFCB HOUSEKEEPSING     */ 00168000
*     (JHFUNMAP,SIOT1PTR,STEPNUM,JCTPTR,SCTPTR,LASTEPAP,0,      01S0086 00169000
*      INTJSCBP,IOSLUTP,FAILRSC,                                01S0086 00170000
*      JHRETMAP);                      /*AREA FOR HOUSEKEEPING TO SET   00171000
*                                        SWITCHES            @G24LPSJ*/ 00172000
         LA    @07,JHFUNMAP                                     01S0086 00173000
         ST    @07,@AL00001                                     01S0086 00174000
         ST    @10,@AL00001+4                                   01S0086 00175000
         L     @10,@PC00001+16                                  01S0086 00176000
         ST    @10,@AL00001+8                                   01S0086 00177000
         L     @10,@PC00001+12                                  01S0086 00178000
         ST    @10,@AL00001+12                                  01S0086 00179000
         L     @10,@PC00001+20                                  01S0086 00180000
         ST    @10,@AL00001+16                                  01S0086 00181000
         L     @10,@PC00001+36                                  01S0086 00182000
         ST    @10,@AL00001+20                                  01S0086 00183000
         LA    @10,@CF00131                                     01S0086 00184000
         ST    @10,@AL00001+24                                  01S0086 00185000
         L     @10,@PC00001+4                                   01S0086 00186000
         ST    @10,@AL00001+28                                  01S0086 00187000
         L     @10,@PC00001+40                                  01S0086 00188000
         ST    @10,@AL00001+32                                  01S0086 00189000
         L     @10,@PC00001+28                                  01S0086 00190000
         ST    @10,@AL00001+36                                  01S0086 00191000
         LA    @10,JHRETMAP                                     01S0086 00192000
         ST    @10,@AL00001+40                                  01S0086 00193000
         L     @15,@CV00480                                     01S0086 00194000
         LA    @01,@AL00001                                     01S0086 00195000
         BALR  @14,@15                                          01S0086 00196000
*    RTNCODE = REG15;                  /*SAVE RETURN CODE            */ 00197000
         LR    RTNCODE,REG15                                    01S0087 00198000
*    IF JHMSSTRM = ON THEN             /*IF MSS TERM NEEDED  @G24LPSJ*/ 00199000
         TM    JHMSSTRM,B'10000000'                             01S0088 00200000
         BNO   @RF00088                                         01S0088 00201000
*      ALCMSSTM = ON;                  /*TURN ON MSS TERM FLAG FOR      00202000
*                                        CMN ALLOCATION      @G24LPSJ*/ 00203000
         LA    @10,ALFUNMAP                                     01S0089 00204000
         OI    ALCMSSTM(@10),B'00001000'                        01S0089 00205000
*  END;                                                         01S0090 00206000
*ELSE;                                 /*NO DD REQUESTS              */ 00207000
@RF00084 DS    0H                                               01S0092 00208000
*IF RTNCODE = SUCCESS THEN             /*ANY ERRORS                  */ 00209000
@RC00084 LTR   RTNCODE,RTNCODE                                  01S0092 00210000
         BNZ   @RF00092                                         01S0092 00211000
*  DO;                                 /*NO,ALLOCATE THE JOB/STEP    */ 00212000
*    SOMEALC = ON;                     /*SOME DDS MAY BE ALLOCATED   */ 00213000
         L     @10,@PC00001+52                                  01S0094 00214000
         L     @10,JAEXITP(,@10)                                01S0094 00215000
         OI    SOMEALC(@10),B'10000000'                         01S0094 00216000
*    CALL IEFAB421(ALFUNMAP,SIOT1PTR,  /*COMMON ALLOCATION           */ 00217000
*      PPJSCBP,IOSLUTP,FAILRSC,TCBPTR,TIOTP,                    01S0095 00218000
*      CANCECBP,STEPNUM,ADDR(SSERRBLK)); /*                  @G29AN2F*/ 00219000
         LA    @10,ALFUNMAP                                     01S0095 00220000
         ST    @10,@AL00001                                     01S0095 00221000
         L     @10,@PC00001+32                                  01S0095 00222000
         ST    @10,@AL00001+4                                   01S0095 00223000
         L     @10,@PC00001+8                                   01S0095 00224000
         ST    @10,@AL00001+8                                   01S0095 00225000
         L     @10,@PC00001+40                                  01S0095 00226000
         ST    @10,@AL00001+12                                  01S0095 00227000
         L     @10,@PC00001+28                                  01S0095 00228000
         ST    @10,@AL00001+16                                  01S0095 00229000
         L     @10,@PC00001+24                                  01S0095 00230000
         ST    @10,@AL00001+20                                  01S0095 00231000
         L     @10,@PC00001+48                                  01S0095 00232000
         ST    @10,@AL00001+24                                  01S0095 00233000
         L     @10,@PC00001+44                                  01S0095 00234000
         ST    @10,@AL00001+28                                  01S0095 00235000
         L     @10,@PC00001+16                                  01S0095 00236000
         ST    @10,@AL00001+32                                  01S0095 00237000
         L     @10,@PC00001+56                                  01S0095 00238000
         ST    @10,@AL00001+36                                  01S0095 00239000
         L     @15,@CV00479                                     01S0095 00240000
         LA    @01,@AL00001                                     01S0095 00241000
         BALR  @14,@15                                          01S0095 00242000
*    RTNCODE = REG15;                  /*SAVE RETURN CODE            */ 00243000
         LR    RTNCODE,REG15                                    01S0096 00244000
*    IF JHMSSTRM = ON &                /*IF MSS TERMINATION NEEDED   */ 00245000
*       RTNCODE ^= SUCCESS THEN        /*AND CMN ALLOC NOT SUCCESSFUL   00246000
*                                                            @G24LPSJ*/ 00247000
         TM    JHMSSTRM,B'10000000'                             01S0097 00248000
         BNO   @RF00097                                         01S0097 00249000
         LTR   RTNCODE,RTNCODE                                  01S0097 00250000
         BZ    @RF00097                                         01S0097 00251000
*      INMSSTRM = ON;                  /*TURN ON MSS TERM FOR   01S0098 00252000
*                                       ALLOC/INIT INTERFACE @G24LPSJ*/ 00253000
         L     @10,@PC00001+60                                  01S0098 00254000
         OI    INMSSTRM(@10),B'10000000'                        01S0098 00255000
*    IF RTNCODE = SUCCESS & SIOT1PTR ^= ZERO THEN  /*IS THERE A TIOT */ 00256000
@RF00097 SLR   @10,@10                                          01S0099 00257000
         CR    RTNCODE,@10                                      01S0099 00258000
         BNE   @RF00099                                         01S0099 00259000
         L     @07,@PC00001+32                                  01S0099 00260000
         L     @07,SIOT1PTR(,@07)                               01S0099 00261000
         CR    @07,@10                                          01S0099 00262000
         BE    @RF00099                                         01S0099 00263000
*      DO;                             /*YES, CALL THE TIOT MGR      */ 00264000
*        TIORBPTR = ADDR(UPTIOTRB);    /*ADDRESS RB MAPPING MACRO    */ 00265000
         LA    @10,UPTIOTRB                                     01S0101 00266000
         ST    @10,TIORBPTR                                     01S0101 00267000
*        TIOMFMAP = UPDTFCN;           /*INDICATE UPDATE FUNCTION    */ 00268000
         MVC   TIOMFMAP(2,@10),@CB00133                         01S0102 00269000
*        TIOMJSCP = PPJSCBP;           /*PUT PTR TO JSCB IN RB       */ 00270000
         L     @05,@PC00001+8                                   01S0103 00271000
         MVC   TIOMJSCP(4,@10),PPJSCBP(@05)                     01S0103 00272000
*        TIOMSIOP = SIOT1PTR;          /*PUT PTR TO FIRST SIOT IN RB */ 00273000
         ST    @07,TIOMSIOP(,@10)                               01S0104 00274000
*        TIOMRETP = ADDR(FAILRSC);     /*POINT TO REASON CODE AREA   */ 00275000
         L     @07,@PC00001+28                                  01S0105 00276000
         ST    @07,TIOMRETP(,@10)                               01S0105 00277000
*        CALL IEFAB4FC(TIORBPTR);      /*REORDER AND COMPRESS TIOT   */ 00278000
         LA    @10,TIORBPTR                                     01S0106 00279000
         ST    @10,@AL00001                                     01S0106 00280000
         L     @15,@CV00476                                     01S0106 00281000
         LA    @01,@AL00001                                     01S0106 00282000
         BALR  @14,@15                                          01S0106 00283000
*        RTNCODE = REG15;              /*SAVE RETURN CODE            */ 00284000
         LR    RTNCODE,REG15                                    01S0107 00285000
*      END;                                                     01S0108 00286000
*    ELSE;                             /*NO TIOT                     */ 00287000
@RF00099 DS    0H                                               01S0110 00288000
*  END;                                                         01S0110 00289000
*ELSE;                                 /*ERROR FOUND IN JFCB HSKPING */ 00290000
@RF00092 DS    0H                                               01S0112 00291000
*IF RTNCODE ^= SUCCESS THEN            /*ANY ERRORS                  */ 00292000
         LTR   RTNCODE,RTNCODE                                  01S0112 00293000
         BZ    @RF00112                                         01S0112 00294000
*  DO;                                 /*YES, PROCESS THESE ERRORS   */ 00295000
*/********************************************************************/ 00296000
*/*                                                                  */ 00297000
*/* SEGMENT NAME - DDERRMSG                                          */ 00298000
*/*                                                                  */ 00299000
*/* DESCRIPTIVE NAME - BUILD DD-RELATED ERROR MESSAGES               */ 00300000
*/*                                                                  */ 00301000
*/* FUNCTION -                                                       */ 00302000
*/*   THE PURPOSE OF THIS CODE SEGMENT IS TO BUILD AN ERROR MESSAGE  */ 00303000
*/*   FOR EACH DD REQUEST WHOSE SIOT INDICATES AN ERROR HAS OCCURRED */ 00304000
*/*   WHILE PROCESSING THIS REQUEST. IF A SIOT IN ERROR HAS  @G29AN2F*/ 00305000
*/*   AN ADDITIONAL ERROR MESSAGE ASSOCIATED WITH IT, THIS   @G29AN2F*/ 00306000
*/*   MESSAGE WILL ALSO BE ISSUED.                           @G29AN2F*/ 00307000
*/*   ALL SIOTS FOR THE STEP ARE                             @G29AN2F*/ 00308000
*/*   SCANNED SINCE MORE THAN ONE DD REQUEST MAY HAVE AN ASSOCIATED  */ 00309000
*/*   ERROR. MODULE IEFAB4FD (SYSTEM MESSAGE INTERFACE RTN) IS       */ 00310000
*/*   CALLED TO WRITE EACH ERROR MESSAGE NEEDED. THE TEXT FOR        */ 00311000
*/*   THE SYSTEM MESSAGES ISSUED BY THIS ROUTINE IS          @G29AN2F*/ 00312000
*/*   CONTAINED IN MESSAGE MODULE IEFBB4M3. THE TEXT FOR THE @G29AN2F*/ 00313000
*/*   ADDITIONAL MESSAGES IS PASSED BACK FROM COMMON         @G29AN2F*/ 00314000
*/*   ALLOCATION.                                            @G29AN2F*/ 00315000
*/*                                                                  */ 00316000
*/*   OPERATION -                                                    */ 00317000
*/*     THE ROUTINE DOES THE FOLLOWING FOR EACH SIOT ON THE INPUT    */ 00318000
*/*     CHAIN:                                                       */ 00319000
*/*       .IF THE DDNAME IS NOT CONCATENATED THE DDNAME      @YM07646*/ 00320000
*/*        IS SAVED AND A RELATIVE CONCATENATION POSITION    @YM07646*/ 00321000
*/*        COUNTER IS SET TO ZERO. IF THE NAME HAS BEEN      @YM07646*/ 00322000
*/*        CONCATENATED THE COUNTER IS INCREMENTED BY ONE.   @YM07646*/ 00323000
*/*                                                                  */ 00324000
*/*       .FOR UNALLOCATED SIOTS THE REASON CODE, IF NON-ZERO, IS    */ 00325000
*/*        USED TO INDEX INTO THE MESSAGE OFFSET TABLE OF THE MESSAGE*/ 00326000
*/*        MODULE, IEFBB4M3. IF THE REASON CODE IS VALID THE OFFSET  */ 00327000
*/*        IS USED TO SET THE POINTER TO THE PROPER MESSAGE IN THE   */ 00328000
*/*        TEXT PORTION OF THE MESSAGE MODULE.                       */ 00329000
*/*                                                                  */ 00330000
*/*       .THE MESSAGE TEXT IS MOVED TO A BUFFER AND THE LAST SAVED  */ 00331000
*/*        DDNAME IS INSERTED. THE JOBNAME, STEPNAME, AND PROCSTEP   */ 00332000
*/*        ARE ALSO INSERTED. IF THE CONCATENATION POSITION COUNTER  */ 00333000
*/*        IS NOT ZERO IT IS CONVERTED TO EBCDIC AND INSERTED IN THE */ 00334000
*/*        MESSAGE.                                                  */ 00335000
*/*                                                                  */ 00336000
*/*       .SIOT INFORMATION CODES ARE CONVERTED AND INSERTED @G24LPSJ*/ 00337000
*/*        INTO THE MESSAGE TEXT.                            @G24LPSJ*/ 00338000
*/*                                                                  */ 00339000
*/*       .A MESSAGE COMPRESSION ROUTINE, IEFAB4F3, IS INVOKED TO    */ 00340000
*/*        REMOVE ANY CONSECUTIVE OR TRAILING BLANKS IN THE MESSAGE. */ 00341000
*/*        THE NEW MESSAGE LENGTH IS RETURNED.                       */ 00342000
*/*                                                                  */ 00343000
*/*       .THE SYSTEM MESSAGE INTERFACE ROUTINE, IEFAB4FD, IS CALLED */ 00344000
*/*        TO ISSUE THE MESSAGE.                                     */ 00345000
*/*                                                                  */ 00346000
*/*       .IF BIT SIOTSSMG IS ON THEN THE INTERNAL DD NUMBER @G29AN2F*/ 00347000
*/*        IN THE SIOT IS USED TO LOCATE THE ADDITIONAL      @G29AN2F*/ 00348000
*/*        MESSAGE IN THE MESSAGE AREA RETURNED BY           @G29AN2F*/ 00349000
*/*        COMMON ALLOCATION CONTROL.  THE MESSAGE IS MOVED  @G29AN2F*/ 00350000
*/*        TO THE MESSAGE BUFFER AND THE MESSAGE COMPRESSION @G29AN2F*/ 00351000
*/*        ROUTINE, IEFAB4F3, IS INVOKED TO REMOVE ANY       @G29AN2F*/ 00352000
*/*        CONSECUTIVE OR TRAILING BLANKS IN THE MESSAGE.    @G29AN2F*/ 00353000
*/*        THE NEW MESSAGE LENGTH IS RETURNED AND THE SYSTEM @G29AN2F*/ 00354000
*/*        MESSAGE INTERFACE ROUTINE, IEFAB4FD, IS CALLED TO @G29AN2F*/ 00355000
*/*        ISSUE THE MESSAGE.                                @G29AN2F*/ 00356000
*/*                                                                  */ 00357000
*/* ENTRY -                                                          */ 00358000
*/*                                                                  */ 00359000
*/*   PURPOSE - SEE FUNCTION                                         */ 00360000
*/*                                                                  */ 00361000
*/*   INPUT -                                                        */ 00362000
*/*     SIOT1PTR - POINTER TO FIRST SIOT                             */ 00363000
*/*       SIOTRSNC - FIELD IN SIOT CONTAING REASON CODE OR 0         */ 00364000
*/*       SIOTINFC - SIOT INFORMATION CODE INDICATOR         @G24LPSJ*/ 00365000
*/*       SIOTSSIC - SIOT INFORMATION CODE FIELD             @G24LPSJ*/ 00366000
*/*       SIOTCCAT - CONCATENATION INDICATOR                 @YM07646*/ 00367000
*/*       SIOTSSMG - SUBSYSTEM MESSAGE INDICATOR             @G29AN2F*/ 00368000
*/*       SCTDDINO - INTERNAL NUMBER OF THE DD STATEMENT     @G29AN2F*/ 00369000
*/*     SSMSGBPR - POINTER TO SUBSYSTEM MESSAGE BLOCK        @G29AN2F*/ 00370000
*/*     PPJSCBP - PTR TO PROBLEM PROGRAN JSCB                        */ 00371000
*/*     TIOTP   - PTR TO TIOT                                        */ 00372000
*/*                                                                  */ 00373000
*/* EXITS -                                                          */ 00374000
*/*                                                                  */ 00375000
*/*   CONDITION - ALL DD-RELATED ERROR MESSAGES ISSUED               */ 00376000
*/*                                                                  */ 00377000
*/*     OUTPUT - MESSAGE(S) WRITTEN                                  */ 00378000
*/*                                                                  */ 00379000
*/*     RETURN CODE - (NONE)                                         */ 00380000
*/*                                                                  */ 00381000
*/********************************************************************/ 00382000
*RETCODE = SUCCESS;                    /*INITIALIZE RETURN CODE      */ 00383000
         SLR   RETCODE,RETCODE                                  02S0114 00384000
*SIOTPTR = SIOT1PTR;                   /*PT TO FIRST SIOT OF STEP    */ 00385000
         L     @10,@PC00001+32                                  02S0115 00386000
         L     SIOTPTR,SIOT1PTR(,@10)                           02S0115 00387000
*DO WHILE(SIOTPTR ^= ZERO              /*SCAN ALL SIOTS ...          */ 00388000
*         & RETCODE = SUCCESS);        /*... UNLESS ERROR OCCURS     */ 00389000
         B     @DE00116                                         02S0116 00390000
@DL00116 DS    0H                                               02S0117 00391000
*  IF (SIOTJSCT = ON & SCTPCAT(1:3) = SIOTDSKA)/*FIRST JOBCAT/STEPCAT   00392000
*                                                IN STEP?    @YM08122*/ 00393000
*    | (SIOTCCAT = OFF                 /*OR NOT CONCATENATED DD?        00394000
*                                        NOTE: SIOTCCAT NOT ON FOR      00395000
*                                        CONCATENATE JOB/STEPCAT        00396000
*                                                            @YM08122*/ 00397000
*      & SIOTJSCT = OFF) THEN          /*AND NOT CONCATENATED   02S0117 00398000
*                                        JOB/STEPCAT         @YM08122*/ 00399000
         TM    SIOTJSCT(SIOTPTR),B'00000001'                    02S0117 00400000
         BNO   @GL00003                                         02S0117 00401000
         L     @10,@PC00001+20                                  02S0117 00402000
         L     @10,SCTPTR(,@10)                                 02S0117 00403000
         CLC   SCTPCAT(3,@10),SIOTDSKA(SIOTPTR)                 02S0117 00404000
         BE    @RT00117                                         02S0117 00405000
@GL00003 TM    SIOTCCAT(SIOTPTR),B'00100001'                    02S0117 00406000
         BNZ   @RF00117                                         02S0117 00407000
@RT00117 DS    0H                                               02S0118 00408000
*    DO;                               /*YES,PREPARE FOR CONCAT'N    */ 00409000
*      MSGDDNAM = SCTDDNAM;            /*SAVE DD NAME                */ 00410000
         MVC   MSGDDNAM(8),SCTDDNAM(SIOTPTR)                    02S0119 00411000
*      CCATCTR = ZERO;                 /*INIT RELATIVE POS CTR       */ 00412000
         SLR   CCATCTR,CCATCTR                                  02S0120 00413000
*    END;                                                       02S0121 00414000
*  ELSE                                /*CONCATENATED DD             */ 00415000
*    CCATCTR = CCATCTR + ONE;          /*UPDATE RELATIVE POS. CTR    */ 00416000
         B     @RC00117                                         02S0122 00417000
@RF00117 LA    CCATCTR,1(,CCATCTR)                              02S0122 00418000
*  IF SIOTALCD = NO THEN               /*WAS DD ALLOCATED?           */ 00419000
@RC00117 TM    SIOTALCD(SIOTPTR),B'00000010'                    02S0123 00420000
         BNZ   @RF00123                                         02S0123 00421000
*    DO;                               /*NO, PREPARE TO ISSUE MSG    */ 00422000
*      MSGBUFFR = '';                  /*BLANK OUT MSG BUFFER        */ 00423000
         MVI   MSGBUFFR,C' '                                    02S0125 00424000
         MVC   MSGBUFFR+1(119),MSGBUFFR                         02S0125 00425000
*      IF SIOTRSNC ^= ZERO THEN        /*REASON CODE GIVEN?          */ 00426000
         SLR   @10,@10                                          02S0126 00427000
         LH    @07,SIOTRSNC(,SIOTPTR)                           02S0126 00428000
         CR    @07,@10                                          02S0126 00429000
         BE    @RF00126                                         02S0126 00430000
*        IF MSGOFFS(SIOTRSNC) ^= INVLDCDE THEN /*VALID REASON CODE   */ 00431000
         SLA   @07,2                                            02S0127 00432000
         L     @02,@CA00468                                     02S0127 00433000
         LA    @01,0(@07,@02)                                   02S0127 00434000
         AL    @01,@CF00686                                     02S0127 00435000
         LH    @15,MSGOFFS-DDERRTAB(,@01)                       02S0127 00436000
         CH    @15,INVLDCDE                                     02S0127 00437000
         BE    @RF00127                                         02S0127 00438000
*          DO;                         /*YES,BUILD MSG IN BUFFER     */ 00439000
*            MSGTPTR = ADDR(MSGTTAB)   /*POINT TO MESSAGE TEXT       */ 00440000
*                + MSGOFFS(SIOTRSNC);                           02S0129 00441000
         L     MSGTPTR,@CV00481                                 02S0129 00442000
         ALR   MSGTPTR,@15                                      02S0129 00443000
*            MSGLNTH = MSGTXTLN(SIOTRSNC); /*SET LENGTH OF MSG     */   00444000
         L     @05,@CA00468                                     02S0130 00445000
         BCTR  @05,0                                            02S0130 00446000
         BCTR  @05,0                                            02S0130 00447000
         LH    @07,MSGTXTLN-DDERRTAB-2(@07,@05)                 02S0130 00448000
         ST    @07,MSGLNTH                                      02S0130 00449000
*            MSGBUFFR(1:MSGLNTH)       /*MOVE TEXT  TO BUFFER        */ 00450000
*                = MSGTXT(1:MSGLNTH);                           02S0131 00451000
         BCTR  @07,0                                            02S0131 00452000
         EX    @07,@SM00687                                     02S0131 00453000
*            MSGJNM = TIOJNAME;        /*INSERT JOB NAME             */ 00454000
         MVI   MSGJNM+8,C' '                                    02S0132 00455000
         L     @07,@PC00001+48                                  02S0132 00456000
         L     @07,TIOTP(,@07)                                  02S0132 00457000
         MVC   MSGJNM(8),TIOJNAME(@07)                          02S0132 00458000
*            MSGSNM = TIOSNAME;        /*INSERT STEP NAME            */ 00459000
         MVI   MSGSNM+8,C' '                                    02S0133 00460000
         MVC   MSGSNM(8),TIOSNAME(@07)                          02S0133 00461000
*            MSGPSNM = TIOPSNME;       /*INSERT PROCSTEP NAME        */ 00462000
         MVI   MSGPSNM+8,C' '                                   02S0134 00463000
         MVC   MSGPSNM(8),TIOPSNME(@07)                         02S0134 00464000
*            MSGDDN = MSGDDNAM;        /*FILL IN DD NAME             */ 00465000
         MVC   MSGDDN(8),MSGDDNAM                               02S0135 00466000
*            IF CCATCTR ^= ZERO THEN   /*IS DD CONCATENATED?         */ 00467000
         CR    CCATCTR,@10                                      02S0136 00468000
         BE    @RF00136                                         02S0136 00469000
*              DO;                     /*YES,CONVERT RELATIVE POS    */ 00470000
*                MSGPLSGN = PLUSSGN;   /*INSERT '+'                  */ 00471000
         MVI   MSGPLSGN,C'+'                                    02S0138 00472000
*                RFY (REG1) RSTD;      /*RESTRICT REG FOR CONVERT    */ 00473000
*                REG1 = CCATCTR;       /*MOVE REL POS TO REGISTER    */ 00474000
         LR    REG1,CCATCTR                                     02S0140 00475000
*                GEN REFS(REG1,DECRPOS) SETS(MSGCCATN);         02S0141 00476000
                CVD   REG1,DECRPOS      CONVERT REL POS TO DECIMAL      00477000
                UNPK  MSGCCATN(3),DECRPOS+6(2) UNPACK IT                00478000
                MVZ   MSGCCATN+2(1),ZONE                                00479000
*                RFY (REG1) UNRSTD;                             02S0142 00480000
*              END;                                             02S0143 00481000
*            FLAG = OFF;               /*TURN OFF FLAG       @G24LPSJ*/ 00482000
@RF00136 NI    FLAG,B'01111111'                                 02S0144 00483000
*            IF SIOTINFC = ON THEN     /*IF THERE IS A SIOT INF CODE    00484000
*                                                            @G24LPSJ*/ 00485000
         TM    SIOTINFC(SIOTPTR),B'10000000'                    02S0145 00486000
         BNO   @RF00145                                         02S0145 00487000
*              DO I = ONE TO NUMSGOFF WHILE FLAG=OFF; /*PROCESS 02S0146 00488000
*                                      SIOT INFORMATION CODE @G24LPSJ*/ 00489000
         LA    I,1                                              02S0146 00490000
         B     @DE00146                                         02S0146 00491000
@DL00146 TM    FLAG,B'10000000'                                 02S0146 00492000
         BNZ   @DC00146                                         02S0146 00493000
*                IF SIOTRSNC = MSGRSNCD(I) THEN /* IF REASON CODE       00494000
*                                      MATCHES               @G24LPSJ*/ 00495000
         LR    @10,I                                            02S0147 00496000
         SLA   @10,2                                            02S0147 00497000
         L     @07,@CA00471                                     02S0147 00498000
         LH    @05,SIOTRSNC(,SIOTPTR)                           02S0147 00499000
         LA    @01,0(@10,@07)                                   02S0147 00500000
         BCTR  @01,0                                            02S0147 00501000
         BCTR  @01,0                                            02S0147 00502000
         CH    @05,MSGRSNCD-DDMSGOFF-2(,@01)                    02S0147 00503000
         BNE   @RF00147                                         02S0147 00504000
*                  DO;                 /*THEN DO             @G24LPSJ*/ 00505000
*                    FLAG = ON;        /*TERMINATE SCAN      @G24LPSJ*/ 00506000
         OI    FLAG,B'10000000'                                 02S0149 00507000
*                    WKAREA = WKAREA&&WKAREA; /*CLEAR WORK AREA 02S0150 00508000
*                                                            @G24LPSJ*/ 00509000
         XC    WKAREA(3),WKAREA                                 02S0150 00510000
*                    WKAREA(1:2) = SIOTSSIC; /*LOAD INFORMATION CODE    00511000
*                                                            @G24LPSJ*/ 00512000
         MVC   WKAREA(2),SIOTSSIC(SIOTPTR)                      02S0151 00513000
*                    UNPK(UNPKAR,WKAREA); /*UNPACK INFORMATION CODE     00514000
*                                                            @G24LPSJ*/ 00515000
         UNPK  UNPKAR(5),WKAREA(3)                              02S0152 00516000
*                    TR(UNPKAR(1:4),TRANSTAB); /*CONVERT TO PRINTABLE   00517000
*                                                            @G24LPSJ*/ 00518000
         LA    @05,TRPATN                                       02S0153 00519000
         AL    @05,@CF00690                                     02S0153 00520000
         TR    UNPKAR(4),TRANSTAB(@05)                          02S0153 00521000
*                    MSGBUFFR(MSGOFFST(I):MSGOFFST(I) + 2) =    02S0154 00522000
*                      UNPKAR(2:4);    /* INSERT INFORMATION CODE       00523000
*                                                            @G24LPSJ*/ 00524000
         LH    @10,MSGOFFST-DDMSGOFF-4(@10,@07)                 02S0154 00525000
         LA    @07,MSGBUFFR-1(@10)                              02S0154 00526000
         MVC   0(3,@07),UNPKAR+1                                02S0154 00527000
*                  END;                /*                    @G24LPSJ*/ 00528000
*              END;                    /*                    @G24LPSJ*/ 00529000
@RF00147 AH    I,@CH00073                                       02S0156 00530000
@DE00146 L     @10,@CA00471                                     02S0156 00531000
         CH    I,NUMSGOFF-DDMSGOFF(,@10)                        02S0156 00532000
         BNH   @DL00146                                         02S0156 00533000
@DC00146 DS    0H                                               02S0157 00534000
*            BUFFLNTH = MSGLNTH;                                02S0157 00535000
@RF00145 MVC   BUFFLNTH(4),MSGLNTH                              02S0157 00536000
*            CALL IEFAB4F3             /*COMPRESS MESSAGE            */ 00537000
*              (ADDR(MSGBUFFR),BUFFLNTH,MSGLNTH);               02S0158 00538000
         LA    @10,MSGBUFFR                                     02S0158 00539000
         ST    @10,@TF00001                                     02S0158 00540000
         LA    @10,@TF00001                                     02S0158 00541000
         ST    @10,@AL00001                                     02S0158 00542000
         LA    @10,BUFFLNTH                                     02S0158 00543000
         ST    @10,@AL00001+4                                   02S0158 00544000
         LA    @10,MSGLNTH                                      02S0158 00545000
         ST    @10,@AL00001+8                                   02S0158 00546000
         L     @15,@CV00478                                     02S0158 00547000
         LA    @01,@AL00001                                     02S0158 00548000
         BALR  @14,@15                                          02S0158 00549000
*      FUNC4FD = FUNC4FD && FUNC4FD;   /*CLEAR IEFAB4FD FUNCTION MAP */ 00550000
         XC    FUNC4FD(1),FUNC4FD                               02S0159 00551000
*            WTPONLY = ON;             /*INDICATE WTP FUNCTION ONLY  */ 00552000
         OI    WTPONLY,B'00100000'                              02S0160 00553000
*            CALL IEFAB4FD             /*INVOKE SYST MSG INTERFACE   */ 00554000
*             (FUNC4FD,ADDR(MSGBUFFR),MSGLNTH,0,PPJSCBP);       02S0161 00555000
         LA    @10,FUNC4FD                                      02S0161 00556000
         ST    @10,@AL00001                                     02S0161 00557000
         LA    @10,MSGBUFFR                                     02S0161 00558000
         ST    @10,@TF00001                                     02S0161 00559000
         LA    @10,@TF00001                                     02S0161 00560000
         ST    @10,@AL00001+4                                   02S0161 00561000
         LA    @10,MSGLNTH                                      02S0161 00562000
         ST    @10,@AL00001+8                                   02S0161 00563000
         LA    @10,@CF00131                                     02S0161 00564000
         ST    @10,@AL00001+12                                  02S0161 00565000
         L     @10,@PC00001+8                                   02S0161 00566000
         ST    @10,@AL00001+16                                  02S0161 00567000
         L     @15,@CV00477                                     02S0161 00568000
         LA    @01,@AL00001                                     02S0161 00569000
         BALR  @14,@15                                          02S0161 00570000
*            RETCODE = REG15;          /*SAVE RETURN CODE            */ 00571000
         LR    RETCODE,REG15                                    02S0162 00572000
*            IF RETCODE ^= ZERO THEN   /*ANY ERROR ?                 */ 00573000
         LTR   RETCODE,RETCODE                                  02S0163 00574000
         BZ    @RF00163                                         02S0163 00575000
*              MSGERRSC = SMERROR;     /*YES,INDICATE ERROR REASON   */ 00576000
         L     @10,@PC00001+28                                  02S0164 00577000
         MVC   MSGERRSC(2,@10),@CH00124                         02S0164 00578000
*            ELSE                      /*NO ERROR            @G29AN2F*/ 00579000
*              IF SIOTSSMG = ON THEN   /*DOES AN ADDITIONAL     02S0165 00580000
*                                        MESSAGE EXIST?      @G29AN2F*/ 00581000
         B     @RC00163                                         02S0165 00582000
@RF00163 TM    SIOTSSMG(SIOTPTR),B'00001000'                    02S0165 00583000
         BNO   @RF00165                                         02S0165 00584000
*                DO;                   /*YES, PROCESS MSG    @G29AN2F*/ 00585000
*                  DO MSGIDX= 1 TO SSMBADIM /*SEARCH MESSAGE    02S0167 00586000
*                                             ARRAY          @G29AN2F*/ 00587000
*                     WHILE(SSMDDNUM(MSGIDX) ^= SCTDDINO); /*MATCHING   00588000
*                                             DD NUMBER?     @G29AN2F*/ 00589000
         LA    MSGIDX,1                                         02S0167 00590000
         B     @DE00167                                         02S0167 00591000
@DL00167 LR    @10,MSGIDX                                       02S0167 00592000
         MH    @10,@CH00676                                     02S0167 00593000
         L     @07,@PC00001+56                                  02S0167 00594000
         L     @07,SSEBLKP(,@07)                                02S0167 00595000
         L     @07,SSEMBPTR(,@07)                               02S0167 00596000
         AL    @07,@CF00691                                     02S0167 00597000
         LH    @10,SSMDDNUM-8(@10,@07)                          02S0167 00598000
         CH    @10,SCTDDINO(,SIOTPTR)                           02S0167 00599000
         BE    @DC00167                                         02S0167 00600000
*                  END;                /*END SEARCH          @G29AN2F*/ 00601000
         AH    MSGIDX,@CH00073                                  02S0168 00602000
@DE00167 L     @10,@PC00001+56                                  02S0168 00603000
         L     @10,SSEBLKP(,@10)                                02S0168 00604000
         L     @10,SSEMBPTR(,@10)                               02S0168 00605000
         CH    MSGIDX,SSMBADIM(,@10)                            02S0168 00606000
         BNH   @DL00167                                         02S0168 00607000
@DC00167 DS    0H                                               02S0169 00608000
*                  MSGLNTH = MIN(SSMSGLEN(MSGIDX),              02S0169 00609000
*                   LENGTH(MSGBUFFR) ); /*GET SHORTER LENGTH @G29AN2F*/ 00610000
         LR    @10,MSGIDX                                       02S0169 00611000
         MH    @10,@CH00676                                     02S0169 00612000
         L     @07,@PC00001+56                                  02S0169 00613000
         L     @07,SSEBLKP(,@07)                                02S0169 00614000
         L     @07,SSEMBPTR(,@07)                               02S0169 00615000
         LA    @01,0(@10,@07)                                   02S0169 00616000
         AL    @01,@CF00692                                     02S0169 00617000
         LH    @15,SSMSGLEN-10(,@01)                            02S0169 00618000
         LA    @14,120                                          02S0169 00619000
         CR    @15,@14                                          02S0169 00620000
         BNH   *+6                                                      00621000
         LR    @15,@14                                          02S0169 00622000
         ST    @15,MSGLNTH                                      02S0169 00623000
*                  MSGBUFFR(1:MSGLNTH) = SSMSGTXT(MSGIDX,1:MSGLNTH);    00624000
         LR    @14,@15                                          02S0170 00625000
         BCTR  @14,0                                            02S0170 00626000
         ALR   @07,@10                                          02S0170 00627000
         AL    @07,@CF00693                                     02S0170 00628000
         EX    @14,@SM00694                                     02S0170 00629000
*                                      /*MOVE MSG TO BUFFER  @G29AN2F*/ 00630000
*                  BUFFLNTH = MSGLNTH; /*SET BUFFER LENGTH   @G29AN2F*/ 00631000
         ST    @15,BUFFLNTH                                     02S0171 00632000
*                  CALL IEFAB4F3       /*COMPRESS MESSAGE    @G29AN2F*/ 00633000
*                   (ADDR(MSGBUFFR),BUFFLNTH,MSGLNTH);          02S0172 00634000
         LA    @10,MSGBUFFR                                     02S0172 00635000
         ST    @10,@TF00001                                     02S0172 00636000
         LA    @10,@TF00001                                     02S0172 00637000
         ST    @10,@AL00001                                     02S0172 00638000
         LA    @10,BUFFLNTH                                     02S0172 00639000
         ST    @10,@AL00001+4                                   02S0172 00640000
         LA    @10,MSGLNTH                                      02S0172 00641000
         ST    @10,@AL00001+8                                   02S0172 00642000
         L     @15,@CV00478                                     02S0172 00643000
         LA    @01,@AL00001                                     02S0172 00644000
         BALR  @14,@15                                          02S0172 00645000
*                  FUNC4FD = FUNC4FD && FUNC4FD; /*CLEAR MAP @G29AN2F*/ 00646000
         XC    FUNC4FD(1),FUNC4FD                               02S0173 00647000
*                  WTPONLY = ON;       /*WTP FUNCTION ONLY   @G29AN2F*/ 00648000
         OI    WTPONLY,B'00100000'                              02S0174 00649000
*                  CALL IEFAB4FD       /*ISSUE MSG           @G29AN2F*/ 00650000
*                   (FUNC4FD,ADDR(MSGBUFFR),MSGLNTH,0,PPJSCBP); 02S0175 00651000
         LA    @10,FUNC4FD                                      02S0175 00652000
         ST    @10,@AL00001                                     02S0175 00653000
         LA    @10,MSGBUFFR                                     02S0175 00654000
         ST    @10,@TF00001                                     02S0175 00655000
         LA    @10,@TF00001                                     02S0175 00656000
         ST    @10,@AL00001+4                                   02S0175 00657000
         LA    @10,MSGLNTH                                      02S0175 00658000
         ST    @10,@AL00001+8                                   02S0175 00659000
         LA    @10,@CF00131                                     02S0175 00660000
         ST    @10,@AL00001+12                                  02S0175 00661000
         L     @10,@PC00001+8                                   02S0175 00662000
         ST    @10,@AL00001+16                                  02S0175 00663000
         L     @15,@CV00477                                     02S0175 00664000
         LA    @01,@AL00001                                     02S0175 00665000
         BALR  @14,@15                                          02S0175 00666000
*                  IF SIOTRSNC = DDCANCEL /*WAS CANCEL REQUEST ON A     00667000
*                                           DD BASIS?        @G29AN2F*/ 00668000
*                    & FAILRSC ^= STEPCNCL THEN /*AND STEP CODE NOT     00669000
*                                           ALREADY CANCEL?  @G29AN2F*/ 00670000
         CLC   SIOTRSNC(2,SIOTPTR),@CH00486                     02S0176 00671000
         BNE   @RF00176                                         02S0176 00672000
         LA    @10,5                                            02S0176 00673000
         L     @07,@PC00001+28                                  02S0176 00674000
         CH    @10,FAILRSC(,@07)                                02S0176 00675000
         BE    @RF00176                                         02S0176 00676000
*                    CNCLERSC = STEPCNCL; /*YES,SET STEP CODE TO        00677000
*                                         CANCEL RETURN CODE @G29AN2F*/ 00678000
         STH   @10,CNCLERSC(,@07)                               02S0177 00679000
*                END;                   /*END ADDITIONAL MSG @G29AN2F*/ 00680000
*          END;                                                 02S0179 00681000
*        ELSE;                         /*INVALID REASON CODE         */ 00682000
@RF00127 DS    0H                                               02S0181 00683000
*      ELSE;                           /*NO REASON CODE              */ 00684000
@RF00126 DS    0H                                               02S0182 00685000
*    END;                                                       02S0182 00686000
*  ELSE;                               /*DD WAS ALLOCATED            */ 00687000
@RF00123 DS    0H                                               02S0184 00688000
*  SIOTPTR = SIOTNPTR;                 /*POINT TO NEXT SIOT          */ 00689000
@RC00123 L     SIOTPTR,SIOTNPTR(,SIOTPTR)                       02S0184 00690000
*END;                                                           02S0185 00691000
@DE00116 SLR   @10,@10                                          02S0185 00692000
         CR    SIOTPTR,@10                                      02S0185 00693000
         BE    @DC00116                                         02S0185 00694000
         CR    RETCODE,@10                                      02S0185 00695000
         BE    @DL00116                                         02S0185 00696000
@DC00116 DS    0H                                               02S0186 00697000
*    RTNCODE = MAX(RTNCODE,RETCODE);   /*SAVE WORST RETURN CODE      */ 00698000
         CR    RTNCODE,RETCODE                                  01S0186 00699000
         BNL   *+6                                                      00700000
         LR    RTNCODE,RETCODE                                  01S0186 00701000
*  END;                                                         01S0187 00702000
*ELSE;                                 /*NO DD-RELATED ERRORS        */ 00703000
@RF00112 DS    0H                                               01S0189 00704000
*RETURN CODE(RTNCODE);                 /*RETURN TO CALLER            */ 00705000
         IC    @02,@OLDKEY                                      01S0189 00706000
         L     @13,4(,@13)                                      01S0189 00707000
         L     @00,@SIZDATD                                     01S0189 00708000
         LR    @01,@11                                          01S0189 00709000
         FSPACE   R,LV=(0),A=(1)                                        00710000
         MODESET KEYADDR=(2)                                            00711000
         LR    @15,@04                                          01S0189 00712000
         L     @14,12(,@13)                                     01S0189 00713000
         LM    @00,@12,20(@13)                                  01S0189 00714000
         BR    @14                                              01S0189 00715000
*END IEFBB404                          /*END STEP-ALLOCATION-CONTROL */ 00716000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00717000
*/*%INCLUDE SYSLIB  (B404SPEC)                                        * 00718000
*/*%INCLUDE SYSLIB  (B404DATA)                                        * 00719000
*/*%INCLUDE SYSLIB  (IEFZB424)                                        * 00720000
*/*%INCLUDE SYSLIB  (IEFZB428)                                        * 00721000
*/*%INCLUDE SYSLIB  (IEFZB454)                                        * 00722000
*/*%INCLUDE SYSLIB  (IEFZB455)                                        * 00723000
*/*%INCLUDE SYSLIB  (IEFAJCTB)                                        * 00724000
*/*%INCLUDE SYSLIB  (IEFASCTB)                                        * 00725000
*/*%INCLUDE SYSLIB  (SETFDATA)                                        * 00726000
*/*%INCLUDE SYSLIB  (EMSGDATA)                                        * 00727000
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        * 00728000
*/*%INCLUDE SYSLIB  (SETFUNMP)                                        * 00729000
*/*%INCLUDE SYSLIB  (SETFSPEC)                                        * 00730000
*/*%INCLUDE SYSLIB  (DDERRMSG)                                        * 00731000
*/*%INCLUDE SYSLIB  (EMSGSPEC)                                        * 00732000
*;                                                              01S0190 00733000
@DATA    DS    0H                                                       00734000
@CH00073 DC    H'1'                                                     00735000
@CH00124 DC    H'3'                                                     00736000
@CH00486 DC    H'88'                                                    00737000
@CH00676 DC    H'124'                                                   00738000
@SM00687 MVC   MSGBUFFR(0),MSGTXT(MSGTPTR)                              00739000
@SM00694 MVC   MSGBUFFR(0),SSMSGTXT-12(@07)                             00740000
@DATD    DSECT                                                          00741000
         DS    0F                                                       00742000
@SA00001 DS    18F                                                      00743000
@PC00001 DS    16F                                                      00744000
@AL00001 DS    11A                                                      00745000
@TF00001 DS    F                                                        00746000
IEFBB404 CSECT                                                          00747000
         DS    0F                                                       00748000
@CF00131 DC    F'0'                                                     00749000
@CF00690 DC    F'-240'                                                  00750000
@CF00691 DC    F'-116'                                                  00751000
@CF00692 DC    F'-114'                                                  00752000
@CF00693 DC    F'-112'                                                  00753000
@CF00686 DC    F'-4'                                                    00754000
@DATD    DSECT                                                          00755000
         DS    0D                                                       00756000
TIORBPTR DS    A                                                        00757000
FMAPPTR  DS    A                                                        00758000
SSMSGBKP DS    A                                                        00759000
BUFFLNTH DS    F                                                        00760000
MSGLNTH  DS    F                                                        00761000
FUNC4FD  DS    BL1                                                      00762000
         ORG   FUNC4FD                                                  00763000
@NM00005 DS    BL1                                                      00764000
WTPONLY  EQU   FUNC4FD+0                                                00765000
         ORG   FUNC4FD+1                                                00766000
JHFUNMAP DS    BL2                                                      00767000
         ORG   JHFUNMAP                                                 00768000
@NM00007 DS    BL1                                                      00769000
@NM00008 EQU   JHFUNMAP+0                                               00770000
@NM00009 EQU   JHFUNMAP+0                                               00771000
JUWAITSW EQU   JHFUNMAP+0                                               00772000
@NM00010 EQU   JHFUNMAP+0                                               00773000
@NM00011 EQU   JHFUNMAP+0                                               00774000
JVWAITSW EQU   JHFUNMAP+0                                               00775000
@NM00012 EQU   JHFUNMAP+0                                               00776000
JHOFFSW  DS    BL1                                                      00777000
@NM00013 EQU   JHFUNMAP+1                                               00778000
@NM00014 EQU   JHFUNMAP+1                                               00779000
@NM00015 EQU   JHFUNMAP+1                                               00780000
@NM00016 EQU   JHFUNMAP+1                                               00781000
JHNDSISW EQU   JHFUNMAP+1                                               00782000
@NM00017 EQU   JHFUNMAP+1                                               00783000
         ORG   JHFUNMAP+2                                               00784000
JHRETMAP DS    BL1                                                      00785000
         ORG   JHRETMAP                                                 00786000
JHMSSTRM DS    BL1                                                      00787000
@NM00018 EQU   JHRETMAP+0                                               00788000
         ORG   JHRETMAP+1                                               00789000
UNPKAR   DS    CL5                                                      00790000
WKAREA   DS    CL3                                                      00791000
UPTIOTRB DS    CL38                                                     00792000
ALFUNMAP DS    BL2                                                      00793000
DECRPOS  DS    CL8                                                      00794000
MSGDDNAM DS    CL8                                                      00795000
MSGBUFFR DS    CL120                                                    00796000
         ORG   MSGBUFFR                                                 00797000
@NM00069 DS    CL8                                                      00798000
MSGJNM   DS    CL9                                                      00799000
MSGSNM   DS    CL9                                                      00800000
MSGPSNM  DS    CL9                                                      00801000
MSGDDN   DS    CL8                                                      00802000
MSGPLSGN DS    CL1                                                      00803000
MSGCCATN DS    CL3                                                      00804000
         ORG   MSGBUFFR+120                                             00805000
FLAG     DS    BL1                                                      00806000
@OLDKEY  DS    AL1                                                      00807000
IEFBB404 CSECT                                                          00808000
         DS    0F                                                       00809000
@SIZDATD DC    AL1(230)                                                 00810000
         DC    AL3(@ENDDATD-@DATD)                                      00811000
@CA00468 DC    A(DDERRTAB)                                              00812000
@CA00471 DC    A(DDMSGOFF)                                              00813000
@CV00476 DC    V(IEFAB4FC)                                              00814000
@CV00477 DC    V(IEFAB4FD)                                              00815000
@CV00478 DC    V(IEFAB4F3)                                              00816000
@CV00479 DC    V(IEFAB421)                                              00817000
@CV00480 DC    V(IEFAB451)                                              00818000
@CV00481 DC    V(MSGTTAB)                                               00819000
         DS    0D                                                       00820000
INVLDCDE DC    XL2'FFFF'                                                00821000
@CB00133 DC    B'0000100000000000'                                      00822000
@CB00438 DC    B'1000000000000000'                                      00823000
@CB00442 DC    B'1010100000100000'                                      00824000
TRPATN   DC    CL16'0123456789ABCDEF'                                   00825000
ZONE     DC    B'11110000'                                              00826000
IEFBB404 CSECT                                                          00827000
         DS   0H                                                        00828000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   00829000
@DATD    DSECT                                                          00830000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00831000
@ENDDATD EQU   *                                                        00832000
IEFBB404 CSECT                                                          00833000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00834000
@01      EQU   01                                                       00835000
@02      EQU   02                                                       00836000
@03      EQU   03                                                       00837000
@04      EQU   04                                                       00838000
@05      EQU   05                                                       00839000
@06      EQU   06                                                       00840000
@07      EQU   07                                                       00841000
@08      EQU   08                                                       00842000
@09      EQU   09                                                       00843000
@10      EQU   10                                                       00844000
@11      EQU   11                                                       00845000
@12      EQU   12                                                       00846000
@13      EQU   13                                                       00847000
@14      EQU   14                                                       00848000
@15      EQU   15                                                       00849000
I        EQU   @02                                                      00850000
MSGIDX   EQU   @02                                                      00851000
CCATCTR  EQU   @06                                                      00852000
SIOTPTR  EQU   @03                                                      00853000
MSGTPTR  EQU   @02                                                      00854000
RTNCODE  EQU   @04                                                      00855000
RETCODE  EQU   @05                                                      00856000
REG1     EQU   @01                                                      00857000
REG15    EQU   @15                                                      00858000
         EXTRN DDERRTAB                                                 00859000
         EXTRN DDMSGOFF                                                 00860000
JAEXPARM EQU   0                                                        00861000
JAEXFLAG EQU   JAEXPARM+268                                             00862000
SOMEALC  EQU   JAEXFLAG                                                 00863000
TRANSTAB EQU   0                                                        00864000
TIOMGRRB EQU   0                                                        00865000
TIOMFMAP EQU   TIOMGRRB                                                 00866000
TIOMTSZE EQU   TIOMGRRB+2                                               00867000
TIOMJSCP EQU   TIOMGRRB+4                                               00868000
TIOMSIOP EQU   TIOMGRRB+24                                              00869000
TIOMRETP EQU   TIOMGRRB+28                                              00870000
FUNCMAP  EQU   0                                                        00871000
VOLMNTSW EQU   FUNCMAP                                                  00872000
WRTMSGSW EQU   FUNCMAP                                                  00873000
ALCMSGLV EQU   WRTMSGSW                                                 00874000
UWAITSW  EQU   FUNCMAP                                                  00875000
ALCWTUNT EQU   UWAITSW                                                  00876000
VWAITSW  EQU   FUNCMAP                                                  00877000
ALCWTVOL EQU   VWAITSW                                                  00878000
MSSTRMSW EQU   FUNCMAP                                                  00879000
ALCMSSTM EQU   MSSTRMSW                                                 00880000
OFFDEVSW EQU   FUNCMAP                                                  00881000
ALCOFFDV EQU   OFFDEVSW                                                 00882000
CCLMNTSW EQU   FUNCMAP                                                  00883000
GENLOKSW EQU   FUNCMAP                                                  00884000
SSEMSGSW EQU   FUNCMAP+1                                                00885000
HDRMSGSW EQU   FUNCMAP+1                                                00886000
ALCHDMSG EQU   HDRMSGSW                                                 00887000
MTRJOBSW EQU   FUNCMAP+1                                                00888000
ALCJOBNM EQU   MTRJOBSW                                                 00889000
NOTIOTNQ EQU   FUNCMAP+1                                                00890000
TRKMSW   EQU   FUNCMAP+1                                                00891000
WAITOKSW EQU   FUNCMAP+1                                                00892000
ALCSUBWT EQU   WAITOKSW                                                 00893000
ASNMSW   EQU   FUNCMAP+1                                                00894000
SSERRBLK EQU   0                                                        00895000
SSEMBPTR EQU   SSERRBLK+4                                               00896000
SSMSGBLK EQU   0                                                        00897000
SSMBKHDR EQU   SSMSGBLK                                                 00898000
SSMBADIM EQU   SSMBKHDR+2                                               00899000
SSMBKARY EQU   SSMSGBLK+8                                               00900000
SSMBKELM EQU   SSMBKARY                                                 00901000
SSMDDNUM EQU   SSMBKELM                                                 00902000
SSMSGLEN EQU   SSMBKELM+2                                               00903000
SSMSGTXT EQU   SSMBKELM+4                                               00904000
INJMJCT  EQU   0                                                        00905000
JCTJSTAT EQU   INJMJCT+5                                                00906000
INDMCTLG EQU   JCTJSTAT                                                 00907000
JCTJBYTE EQU   INJMJCT+7                                                00908000
JCTJMGLV EQU   JCTJBYTE                                                 00909000
INCMALL  EQU   JCTJMGLV                                                 00910000
JCTCCODE EQU   INJMJCT+54                                               00911000
JCTRSW1  EQU   INJMJCT+86                                               00912000
JCTRSW2  EQU   INJMJCT+87                                               00913000
JCTJSB   EQU   INJMJCT+111                                              00914000
JCTSTAT2 EQU   INJMJCT+116                                              00915000
IEFAACTB EQU   0                                                        00916000
INSMSCT  EQU   0                                                        00917000
SCTSSTAT EQU   INSMSCT+4                                                00918000
SCTSTYPE EQU   INSMSCT+67                                               00919000
SCTPCAT  EQU   INSMSCT+84                                               00920000
SCTSDPTY EQU   INSMSCT+94                                               00921000
SCTSTAT2 EQU   INSMSCT+104                                              00922000
SCTBCT   EQU   SCTSTAT2                                                 00923000
SCTCDENT EQU   INSMSCT+118                                              00924000
SCTSTEND EQU   INSMSCT+172                                              00925000
@NM00066 EQU   0                                                        00926000
SCTABCND EQU   @NM00066                                                 00927000
TIOTHDR  EQU   0                                                        00928000
TIOJNAME EQU   TIOTHDR                                                  00929000
TIOSNAME EQU   TIOTHDR+8                                                00930000
TIOPSNME EQU   TIOTHDR+16                                               00931000
MSGTXT   EQU   0                                                        00932000
INDMSIOT EQU   0                                                        00933000
SIOTDSKA EQU   INDMSIOT                                                 00934000
SCTDDNAM EQU   INDMSIOT+4                                               00935000
SCTUSADD EQU   INDMSIOT+20                                              00936000
SIOTBYT1 EQU   INDMSIOT+43                                              00937000
SIOTALCD EQU   SIOTBYT1                                                 00938000
SCTDDINO EQU   INDMSIOT+44                                              00939000
SIOTBYT3 EQU   INDMSIOT+46                                              00940000
SIOTTSTC EQU   INDMSIOT+47                                              00941000
SIOTINFC EQU   SIOTTSTC                                                 00942000
SIOTSSMG EQU   SIOTTSTC                                                 00943000
SIOTBYT0 EQU   INDMSIOT+52                                              00944000
SCTSDISP EQU   INDMSIOT+55                                              00945000
SCTSBYT1 EQU   INDMSIOT+56                                              00946000
SIOTCCAT EQU   SCTSBYT1                                                 00947000
SIOTJSCT EQU   SCTSBYT1                                                 00948000
SCTSBYT2 EQU   INDMSIOT+57                                              00949000
SCTSBYT3 EQU   INDMSIOT+58                                              00950000
SCTSBYT4 EQU   INDMSIOT+59                                              00951000
SCTUTYPE EQU   INDMSIOT+60                                              00952000
SIOTDEVT EQU   SCTUTYPE                                                 00953000
SIOUBYT3 EQU   SIOTDEVT+2                                               00954000
SIOTBYT4 EQU   INDMSIOT+81                                              00955000
SIOTALTD EQU   INDMSIOT+92                                              00956000
SIOTBYT2 EQU   INDMSIOT+103                                             00957000
SIOTSSIC EQU   INDMSIOT+120                                             00958000
SIOTRSNC EQU   INDMSIOT+130                                             00959000
SIOTNPTR EQU   INDMSIOT+152                                             00960000
INDMDSNT EQU   0                                                        00961000
MSGOFFS  EQU   DDERRTAB                                                 00962000
MSGTXTLN EQU   DDERRTAB+2                                               00963000
NUMSGOFF EQU   DDMSGOFF                                                 00964000
ENTRIES  EQU   DDMSGOFF+2                                               00965000
MSGRSNCD EQU   ENTRIES                                                  00966000
MSGOFFST EQU   ENTRIES+2                                                00967000
INFUNMAP EQU   0                                                        00968000
INVWAISW EQU   INFUNMAP                                                 00969000
INUWAISW EQU   INFUNMAP                                                 00970000
USEOFFSW EQU   INFUNMAP                                                 00971000
MONJOBSW EQU   INFUNMAP                                                 00972000
INNDSISW EQU   INFUNMAP                                                 00973000
INTJSCBP EQU   0                                                        00974000
PPJSCBP  EQU   0                                                        00975000
JCTPTR   EQU   0                                                        00976000
STEPNUM  EQU   0                                                        00977000
SCTPTR   EQU   0                                                        00978000
TCBPTR   EQU   0                                                        00979000
RESNAREA EQU   0                                                        00980000
FAILRSC  EQU   RESNAREA                                                 00981000
MSGERRSC EQU   RESNAREA+2                                               00982000
CNCLERSC EQU   RESNAREA+4                                               00983000
SIOT1PTR EQU   0                                                        00984000
LASTEPAP EQU   0                                                        00985000
IOSLUTP  EQU   0                                                        00986000
CANCECBP EQU   0                                                        00987000
TIOTP    EQU   0                                                        00988000
JAEXITP  EQU   0                                                        00989000
SSEBLKP  EQU   0                                                        00990000
INRETMAP EQU   0                                                        00991000
INMSSTRM EQU   INRETMAP                                                 00992000
TIOMELEN EQU   TIOMTSZE                                                 00993000
TIOMNDSA EQU   TIOMTSZE                                                 00994000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00995000
@NM00004 EQU   INRETMAP                                                 00996000
@NM00003 EQU   INFUNMAP                                                 00997000
@NM00002 EQU   INFUNMAP                                                 00998000
@NM00001 EQU   INFUNMAP                                                 00999000
SIODDSNL EQU   INDMSIOT+173                                             01000000
SIOVDSNL EQU   INDMSIOT+172                                             01001000
SIOVDSNT EQU   INDMSIOT+170                                             01002000
SVOLUNNO EQU   INDMSIOT+168                                             01003000
SIOTVMVP EQU   INDMSIOT+164                                             01004000
SIOTJFX  EQU   INDMSIOT+160                                             01005000
SJFCBPTR EQU   INDMSIOT+156                                             01006000
SIOTETIO EQU   INDMSIOT+148                                             01007000
SIOTATE  EQU   INDMSIOT+144                                             01008000
SVOLUNAD EQU   INDMSIOT+140                                             01009000
SIOTEDLP EQU   INDMSIOT+136                                             01010000
SIOTEDLS EQU   INDMSIOT+132                                             01011000
SCTANAME EQU   INDMSIOT+122                                             01012000
@NM00082 EQU   INDMSIOT+108                                             01013000
SIOTSSNM EQU   INDMSIOT+104                                             01014000
@NM00081 EQU   SIOTBYT2                                                 01015000
SIOTCVOL EQU   SIOTBYT2                                                 01016000
SIOTCNEW EQU   SIOTBYT2                                                 01017000
SIOTCALC EQU   SIOTBYT2                                                 01018000
SIOTGALL EQU   SIOTBYT2                                                 01019000
SIOTDSPD EQU   SIOTBYT2                                                 01020000
SIOTDMND EQU   SIOTBYT2                                                 01021000
SIOTOPUC EQU   INDMSIOT+99                                              01022000
SIOTOUTR EQU   INDMSIOT+97                                              01023000
SIOTOUTC EQU   INDMSIOT+96                                              01024000
SIOTSSWA EQU   INDMSIOT+93                                              01025000
SIOTAUNC EQU   SIOTALTD                                                 01026000
SIOTACAT EQU   SIOTALTD                                                 01027000
SIOTADEL EQU   SIOTALTD                                                 01028000
SIOTAKEP EQU   SIOTALTD                                                 01029000
SIOTNPRV EQU   SIOTALTD                                                 01030000
SIOJCATS EQU   SIOTALTD                                                 01031000
@NM00080 EQU   SIOTALTD                                                 01032000
@NM00079 EQU   SIOTALTD                                                 01033000
@NM00078 EQU   INDMSIOT+91                                              01034000
SIOTNDSB EQU   INDMSIOT+88                                              01035000
@NM00077 EQU   INDMSIOT+84                                              01036000
SIOTDPCD EQU   INDMSIOT+82                                              01037000
@NM00076 EQU   SIOTBYT4                                                 01038000
SIOTRACT EQU   SIOTBYT4                                                 01039000
SIOTRACD EQU   SIOTBYT4                                                 01040000
SIOTPROT EQU   SIOTBYT4                                                 01041000
SCTOUTPN EQU   INDMSIOT+80                                              01042000
SCTOUTNO EQU   INDMSIOT+76                                              01043000
SCTOUTNM EQU   INDMSIOT+68                                              01044000
SIOUCBAD EQU   SCTUTYPE+5                                               01045000
SIOUCNVT EQU   SCTUTYPE+4                                               01046000
SIOUBYT4 EQU   SIOTDEVT+3                                               01047000
@NM00075 EQU   SIOUBYT3                                                 01048000
SIO3UREC EQU   SIOUBYT3                                                 01049000
SIO3DISP EQU   SIOUBYT3                                                 01050000
SIO3DACC EQU   SIOUBYT3                                                 01051000
SIO3COMM EQU   SIOUBYT3                                                 01052000
SIO3TAPE EQU   SIOUBYT3                                                 01053000
SIOUBYT2 EQU   SIOTDEVT+1                                               01054000
SIOUBYT1 EQU   SIOTDEVT                                                 01055000
SIOTOMN  EQU   SCTSBYT4                                                 01056000
SIOTIPDI EQU   SCTSBYT4                                                 01057000
SIOTVAFF EQU   SCTSBYT4                                                 01058000
SIOTSTEP EQU   SCTSBYT4                                                 01059000
SIOTASCI EQU   SCTSBYT4                                                 01060000
@NM00074 EQU   SCTSBYT4                                                 01061000
SIOTGDGA EQU   SCTSBYT4                                                 01062000
SCTSGDGS EQU   SCTSBYT4                                                 01063000
SCTSOLD  EQU   SCTSBYT3                                                 01064000
SCTSMOD  EQU   SCTSBYT3                                                 01065000
SCTSNEW  EQU   SCTSBYT3                                                 01066000
SCTSYSOU EQU   SCTSBYT3                                                 01067000
SCTVREF  EQU   SCTSBYT3                                                 01068000
SCTALCHK EQU   SCTSBYT3                                                 01069000
SCTSYSNE EQU   SCTSBYT3                                                 01070000
SCTDSNRF EQU   SCTSBYT3                                                 01071000
SCTRECVD EQU   SCTSBYT2                                                 01072000
SCTDEFER EQU   SCTSBYT2                                                 01073000
SCTLABEL EQU   SCTSBYT2                                                 01074000
SCTUNLBD EQU   SCTSBYT2                                                 01075000
SCTJOBLB EQU   SCTSBYT2                                                 01076000
SCTVOLAF EQU   SCTSBYT2                                                 01077000
SIOTCATL EQU   SCTSBYT2                                                 01078000
SIOCLUNL EQU   SCTSBYT2                                                 01079000
SCTUNAFF EQU   SCTSBYT1                                                 01080000
SCTPARLM EQU   SCTSBYT1                                                 01081000
SIOTQDSN EQU   SCTSBYT1                                                 01082000
SIOTGDSN EQU   SCTSBYT1                                                 01083000
SCTSYSIN EQU   SCTSBYT1                                                 01084000
SCTDUMMY EQU   SCTSBYT1                                                 01085000
SIOTUNCT EQU   SCTSDISP                                                 01086000
SIOTCTLG EQU   SCTSDISP                                                 01087000
SIOTDLET EQU   SCTSDISP                                                 01088000
SIOTKEEP EQU   SCTSDISP                                                 01089000
SIOTPASS EQU   SCTSDISP                                                 01090000
SIOTPRIV EQU   SCTSDISP                                                 01091000
S3400DSP EQU   SCTSDISP                                                 01092000
SIOTRETN EQU   SCTSDISP                                                 01093000
SIOTVLCT EQU   INDMSIOT+54                                              01094000
SCTNMBUT EQU   INDMSIOT+53                                              01095000
SIOTRTRY EQU   SIOTBYT0                                                 01096000
SIOTPUPV EQU   SIOTBYT0                                                 01097000
SIOTNOPV EQU   SIOTBYT0                                                 01098000
SIOTGIGN EQU   SIOTBYT0                                                 01099000
SPVTAMSG EQU   SIOTBYT0                                                 01100000
SIOTFUDA EQU   SIOTBYT0                                                 01101000
SIOTDYAL EQU   SIOTBYT0                                                 01102000
SIOTSSDS EQU   SIOTBYT0                                                 01103000
SIOTGIID EQU   INDMSIOT+50                                              01104000
SCTVOLCT EQU   INDMSIOT+49                                              01105000
SCTSPOOL EQU   INDMSIOT+48                                              01106000
SIOTQNAM EQU   SIOTTSTC                                                 01107000
SIOTDSNM EQU   SIOTTSTC                                                 01108000
SIOTTRKM EQU   SIOTTSTC                                                 01109000
SIOTSSGP EQU   SIOTTSTC                                                 01110000
@NM00073 EQU   SIOTTSTC                                                 01111000
SIOTTERM EQU   SIOTTSTC                                                 01112000
@NM00072 EQU   SIOTBYT3                                                 01113000
SIOTDSID EQU   SIOTBYT3                                                 01114000
S3400OFF EQU   SIOTBYT3                                                 01115000
SIOTJES3 EQU   SIOTBYT3                                                 01116000
SIOCDEVT EQU   SIOTBYT3                                                 01117000
SIOALIAS EQU   SIOTBYT3                                                 01118000
SIOTDDNT EQU   SIOTBYT1                                                 01119000
SIODADSM EQU   SIOTBYT1                                                 01120000
SIOTDADR EQU   SIOTBYT1                                                 01121000
SIODUNAL EQU   SIOTBYT1                                                 01122000
SIOVAMDS EQU   SIOTBYT1                                                 01123000
SIOTHOLD EQU   SIOTBYT1                                                 01124000
SIOTOCKP EQU   SIOTBYT1                                                 01125000
SIOPSCNT EQU   INDMSIOT+42                                              01126000
SIOTREFN EQU   INDMSIOT+40                                              01127000
SIOTOTUN EQU   INDMSIOT+39                                              01128000
SIOTVRSB EQU   INDMSIOT+36                                              01129000
@NM00071 EQU   INDMSIOT+35                                              01130000
SCTPJFCB EQU   INDMSIOT+32                                              01131000
@NM00070 EQU   INDMSIOT+31                                              01132000
SCTPSIOT EQU   INDMSIOT+28                                              01133000
SIOTAFID EQU   INDMSIOT+26                                              01134000
SIOTVLSP EQU   INDMSIOT+24                                              01135000
SIODSNTE EQU   INDMSIOT+22                                              01136000
SIOTUNAF EQU   SCTUSADD                                                 01137000
SIOTDEST EQU   INDMSIOT+12                                              01138000
SIOTTYPE EQU   INDMSIOT+3                                               01139000
@NM00068 EQU   @NM00066+1                                               01140000
SCTONLY  EQU   SCTABCND                                                 01141000
SCTEVEN  EQU   SCTABCND                                                 01142000
SCTABEND EQU   SCTABCND                                                 01143000
SCTONLYC EQU   SCTABCND                                                 01144000
SCTABCAN EQU   SCTABCND                                                 01145000
@NM00067 EQU   SCTABCND                                                 01146000
@NM00065 EQU   INSMSCT+173                                              01147000
@NM00064 EQU   SCTSTEND                                                 01148000
SCTSYSCK EQU   SCTSTEND                                                 01149000
SCTSTPND EQU   SCTSTEND                                                 01150000
SCTSTSRT EQU   SCTSTEND                                                 01151000
@NM00063 EQU   INSMSCT+168                                              01152000
SCTCATCT EQU   INSMSCT+166                                              01153000
SCTSDPSA EQU   SCTCDENT+3                                               01154000
SCTSDPOP EQU   SCTCDENT+2                                               01155000
SCTSDPCD EQU   SCTCDENT                                                 01156000
@NM00062 EQU   INSMSCT+117                                              01157000
SCTPRFMF EQU   INSMSCT+116                                              01158000
SCTPGMNM EQU   INSMSCT+108                                              01159000
SCTTIOT  EQU   INSMSCT+105                                              01160000
@NM00061 EQU   SCTBCT                                                   01161000
SCTJBEND EQU   SCTBCT                                                   01162000
SCTSPSYS EQU   SCTBCT                                                   01163000
SCTSTPLB EQU   SCTBCT                                                   01164000
@NM00060 EQU   SCTBCT                                                   01165000
SCTMCVOL EQU   SCTBCT                                                   01166000
@NM00059 EQU   SCTBCT                                                   01167000
SCTGOTTR EQU   INSMSCT+100                                              01168000
SCTSMF   EQU   INSMSCT+96                                               01169000
@NM00058 EQU   SCTSDPTY+1                                               01170000
SCTSDP   EQU   SCTSDPTY                                                 01171000
SCTFSTEP EQU   SCTSDPTY                                                 01172000
@NM00057 EQU   SCTSDPTY                                                 01173000
@NM00056 EQU   SCTSDPTY                                                 01174000
SCTNIUSL EQU   INSMSCT+92                                               01175000
@NM00055 EQU   INSMSCT+90                                               01176000
SCTMSSZE EQU   INSMSCT+88                                               01177000
SCTLDSTB EQU   INSMSCT+80                                               01178000
SCTSRBT  EQU   INSMSCT+76                                               01179000
SCTMSADR EQU   INSMSCT+72                                               01180000
@NM00054 EQU   INSMSCT+71                                               01181000
SCTXBTTR EQU   INSMSCT+68                                               01182000
SCTJSCAT EQU   SCTSTYPE                                                 01183000
SCTINITB EQU   SCTSTYPE                                                 01184000
SCTSJFHK EQU   SCTSTYPE                                                 01185000
SCTOUTMC EQU   SCTSTYPE                                                 01186000
SCTINPUT EQU   SCTSTYPE                                                 01187000
SCTGOSTP EQU   SCTSTYPE                                                 01188000
@NM00053 EQU   INSMSCT+66                                               01189000
SCTNSMSG EQU   INSMSCT+65                                               01190000
SCTSNUMB EQU   INSMSCT+64                                               01191000
@NM00052 EQU   INSMSCT+62                                               01192000
SCTRPACT EQU   INSMSCT+60                                               01193000
SCTSNAME EQU   INSMSCT+52                                               01194000
SCTSCLPC EQU   INSMSCT+44                                               01195000
@NM00051 EQU   INSMSCT+43                                               01196000
SCTADSTB EQU   INSMSCT+40                                               01197000
@NM00050 EQU   INSMSCT+36                                               01198000
@NM00049 EQU   INSMSCT+35                                               01199000
SCTAFACT EQU   INSMSCT+32                                               01200000
SCTDDNT  EQU   INSMSCT+28                                               01201000
@NM00048 EQU   INSMSCT+27                                               01202000
SCTLSIOT EQU   INSMSCT+24                                               01203000
@NM00047 EQU   INSMSCT+23                                               01204000
SCTANSCT EQU   INSMSCT+20                                               01205000
@NM00046 EQU   INSMSCT+19                                               01206000
SCTAALOC EQU   INSMSCT+16                                               01207000
@NM00045 EQU   INSMSCT+15                                               01208000
SCTFSIOT EQU   INSMSCT+12                                               01209000
SCTLALOC EQU   INSMSCT+10                                               01210000
SCTSEXEC EQU   INSMSCT+8                                                01211000
SCTSTIME EQU   INSMSCT+5                                                01212000
INCMSSTS EQU   SCTSSTAT                                                 01213000
SCTGRPH  EQU   SCTSSTAT                                                 01214000
SCTKEY0  EQU   SCTSSTAT                                                 01215000
SCTDORST EQU   SCTSSTAT                                                 01216000
SCTNOCKP EQU   SCTSSTAT                                                 01217000
SCTNORST EQU   SCTSSTAT                                                 01218000
EACAUSER EQU   SCTSSTAT                                                 01219000
EAADDRBT EQU   SCTSSTAT                                                 01220000
SCTTBLID EQU   INSMSCT+3                                                01221000
SCTDISKA EQU   INSMSCT                                                  01222000
ACTACCNT EQU   IEFAACTB+32                                              01223000
ACTJNFLD EQU   IEFAACTB+31                                              01224000
ACTJTIME EQU   IEFAACTB+28                                              01225000
ACTPRGNM EQU   IEFAACTB+8                                               01226000
@NM00044 EQU   IEFAACTB+7                                               01227000
ACTNEXT  EQU   IEFAACTB+4                                               01228000
ACTIDENT EQU   IEFAACTB+3                                               01229000
ACTDSKAD EQU   IEFAACTB                                                 01230000
@NM00043 EQU   INJMJCT+175                                              01231000
JCTVULDP EQU   INJMJCT+172                                              01232000
JCTACODE EQU   INJMJCT+168                                              01233000
JCTPRFMF EQU   INJMJCT+167                                              01234000
JCTUSER  EQU   INJMJCT+160                                              01235000
JCTSSD   EQU   INJMJCT+157                                              01236000
@NM00042 EQU   INJMJCT+156                                              01237000
JCTSRBT  EQU   INJMJCT+152                                              01238000
JCTJMRJD EQU   INJMJCT+149                                              01239000
JCTJMRJT EQU   INJMJCT+146                                              01240000
JCTJMRSS EQU   INJMJCT+143                                              01241000
JCTJMRTL EQU   INJMJCT+140                                              01242000
JCTJMRCL EQU   INJMJCT+139                                              01243000
JCTJMROP EQU   INJMJCT+138                                              01244000
JCTJMRD  EQU   INJMJCT+137                                              01245000
JCTJMR   EQU   INJMJCT+134                                              01246000
JCTCKIDT EQU   INJMJCT+118                                              01247000
JCTCKIDL EQU   INJMJCT+117                                              01248000
@NM00041 EQU   JCTSTAT2                                                 01249000
JCTBLP   EQU   JCTSTAT2                                                 01250000
JCTPERFM EQU   JCTSTAT2                                                 01251000
JCTSWSM  EQU   JCTSTAT2                                                 01252000
JCTENDIT EQU   JCTSTAT2                                                 01253000
JCTADSPC EQU   JCTSTAT2                                                 01254000
JCTSPSYS EQU   JCTSTAT2                                                 01255000
@NM00040 EQU   INJMJCT+115                                              01256000
JCTSSTR  EQU   INJMJCT+112                                              01257000
JCTJSBTM EQU   JCTJSB                                                   01258000
JCTJSBEX EQU   JCTJSB                                                   01259000
JCTJSBAL EQU   JCTJSB                                                   01260000
JCTJSBIN EQU   JCTJSB                                                   01261000
@NM00039 EQU   JCTJSB                                                   01262000
JCTVOLSQ EQU   INJMJCT+110                                              01263000
JCTNRCKP EQU   INJMJCT+108                                              01264000
JCTNTRK  EQU   INJMJCT+107                                              01265000
JCTCKTTR EQU   INJMJCT+104                                              01266000
JCTDEVT  EQU   INJMJCT+100                                              01267000
@NM00038 EQU   INJMJCT+99                                               01268000
JCTSTIOT EQU   INJMJCT+96                                               01269000
JCTSNUMB EQU   INJMJCT+95                                               01270000
JCTQIDNT EQU   INJMJCT+94                                               01271000
JCTEQREG EQU   INJMJCT+92                                               01272000
@NM00037 EQU   INJMJCT+91                                               01273000
JCTDETDA EQU   INJMJCT+88                                               01274000
JCTDSDRA EQU   JCTRSW2                                                  01275000
JCTDSOJB EQU   JCTRSW2                                                  01276000
JCTDSOCR EQU   JCTRSW2                                                  01277000
JCTRESTT EQU   JCTRSW2                                                  01278000
JCTNOCKP EQU   JCTRSW2                                                  01279000
JCTNORST EQU   JCTRSW2                                                  01280000
JCTNARST EQU   JCTRSW2                                                  01281000
JCTSYSCK EQU   JCTRSW2                                                  01282000
@NM00036 EQU   JCTRSW1                                                  01283000
JCTSTEPR EQU   JCTRSW1                                                  01284000
JCTCKPTR EQU   JCTRSW1                                                  01285000
JCTCKFT  EQU   JCTRSW1                                                  01286000
JCTCONTR EQU   JCTRSW1                                                  01287000
JCTSTERM EQU   JCTRSW1                                                  01288000
JCTWARMS EQU   JCTRSW1                                                  01289000
@NM00035 EQU   JCTCCODE+3                                               01290000
JCTJDPOP EQU   JCTCCODE+2                                               01291000
JCTJDPCD EQU   JCTCCODE                                                 01292000
@NM00034 EQU   INJMJCT+53                                               01293000
JCTSCT   EQU   INJMJCT+52                                               01294000
JCTSMRBA EQU   INJMJCT+44                                               01295000
@NM00033 EQU   INJMJCT+43                                               01296000
JCTACTAD EQU   INJMJCT+40                                               01297000
@NM00032 EQU   INJMJCT+39                                               01298000
JCTJCTX  EQU   INJMJCT+36                                               01299000
@NM00031 EQU   INJMJCT+35                                               01300000
JCTSDKAD EQU   INJMJCT+32                                               01301000
JCTJCSMF EQU   INJMJCT+31                                               01302000
JCTGDGNT EQU   INJMJCT+28                                               01303000
@NM00030 EQU   INJMJCT+27                                               01304000
JCTPDIP  EQU   INJMJCT+24                                               01305000
JCTJTPTN EQU   INJMJCT+16                                               01306000
JCTJNAME EQU   INJMJCT+8                                                01307000
JCTJPRTY EQU   JCTJBYTE                                                 01308000
INCMMGL1 EQU   JCTJMGLV                                                 01309000
INCMMGL2 EQU   JCTJMGLV                                                 01310000
@NM00029 EQU   JCTJMGLV                                                 01311000
JCTJMGPO EQU   INJMJCT+6                                                01312000
INCMNSET EQU   JCTJSTAT                                                 01313000
INCMCAT  EQU   INDMCTLG                                                 01314000
INCMSTS  EQU   JCTJSTAT                                                 01315000
JCTABEND EQU   JCTJSTAT                                                 01316000
@NM00028 EQU   JCTJSTAT                                                 01317000
JCTJSTPC EQU   JCTJSTAT                                                 01318000
@NM00027 EQU   JCTJSTAT                                                 01319000
JCTJBLBS EQU   JCTJSTAT                                                 01320000
JCTJSRNO EQU   INJMJCT+4                                                01321000
JCTIDENT EQU   INJMJCT+3                                                01322000
JCTDSKAD EQU   INJMJCT                                                  01323000
SSMBKSZE EQU   SSMBKHDR+4                                               01324000
SSMBSUBP EQU   SSMBKHDR                                                 01325000
SSESMSGI EQU   SSERRBLK+2                                               01326000
SSEINCDE EQU   SSERRBLK                                                 01327000
EXTRACAL EQU   FUNCMAP+1                                                01328000
ALCASDSN EQU   ASNMSW                                                   01329000
ALCATRKM EQU   TRKMSW                                                   01330000
ALCNOENQ EQU   NOTIOTNQ                                                 01331000
ALCSSMSG EQU   SSEMSGSW                                                 01332000
ALCGENER EQU   GENLOKSW                                                 01333000
ALCCANCL EQU   CCLMNTSW                                                 01334000
ALCMOUNT EQU   VOLMNTSW                                                 01335000
TIOMIUSL EQU   TIOMGRRB+36                                              01336000
TIOMPSNP EQU   TIOMGRRB+32                                              01337000
TIOMDSAP EQU   TIOMGRRB+20                                              01338000
TIOMENTP EQU   TIOMGRRB+16                                              01339000
TIOMSNMP EQU   TIOMGRRB+12                                              01340000
TIOMJNMP EQU   TIOMGRRB+8                                               01341000
@NM00026 EQU   TIOMFMAP+1                                               01342000
@NM00025 EQU   TIOMFMAP+1                                               01343000
@NM00024 EQU   TIOMFMAP+1                                               01344000
@NM00023 EQU   TIOMFMAP+1                                               01345000
@NM00022 EQU   TIOMFMAP+1                                               01346000
@NM00021 EQU   TIOMFMAP+1                                               01347000
@NM00020 EQU   TIOMFMAP+1                                               01348000
TIOMRENT EQU   TIOMFMAP+1                                               01349000
TIOMFREE EQU   TIOMFMAP                                                 01350000
TIOMUNAL EQU   TIOMFMAP                                                 01351000
TIOMCCAT EQU   TIOMFMAP                                                 01352000
TIOMUPD  EQU   TIOMFMAP                                                 01353000
TIOMRLSE EQU   TIOMFMAP                                                 01354000
TIOMALOC EQU   TIOMFMAP                                                 01355000
@NM00019 EQU   TIOMFMAP                                                 01356000
TIOMBLD  EQU   TIOMFMAP                                                 01357000
@NM00006 EQU   JAEXPARM                                                 01358000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01359000
@RF00088 EQU   @RC00084                                                 01360000
@RC00126 EQU   @RC00123                                                 01361000
@RC00127 EQU   @RC00126                                                 01362000
@RF00165 EQU   @RC00127                                                 01363000
@RC00163 EQU   @RC00127                                                 01364000
@RF00176 EQU   @RC00127                                                 01365000
@ENDDATA EQU   *                                                        01366000
         END   IEFBB404,(C'PLS1305',0701,78089)                         01367000
