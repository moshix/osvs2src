         TITLE 'IEFBB416 - JOB UNALLOCATION                            *00001000
                        '                                               00002000
IEFBB416 CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(24)                                          01S0001 00007000
         DC    C'IEFBB416 78124  UZ18622 '                      01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @11,0                                            01S0001 00011000
@PSTART  LA    @12,4095(,@11)                                   01S0001 00012000
         USING @PSTART,@11                                      01S0001 00013000
         USING @PSTART+4095,@12                                 01S0001 00014000
         L     @00,@SIZDATD                                     01S0001 00015000
         GSPACE   R,LV=(0)                                              00016000
         LR    @10,@01                                          01S0001 00017000
         USING @DATD,@10                                        01S0001 00018000
         ST    @13,@SA00001+4                                   01S0001 00019000
         LM    @00,@01,20(@13)                                  01S0001 00020000
         ST    @10,8(,@13)                                      01S0001 00021000
         LR    @13,@10                                          01S0001 00022000
         MVC   @PC00001(28),0(@01)                              01S0001 00023000
*ESTAJOB = OFF;                        /*JOB UNALLOC TRIED           */ 00024000
*ESTAJOBU = ON;                        /*PVT VOL UNLOAD NOT TRIED    */ 00025000
         L     @03,@PC00001+12                                  01S0082 00026000
         L     @03,ESTAPTR(,@03)                                01S0082 00027000
         OI    ESTAJOBU(@03),B'00100000'                        01S0082 00028000
         NI    ESTAJOB(@03),B'11101111'                         01S0082 00029000
*RETCODE = ZERO;                       /* INIT RETURN CODE           */ 00030000
         SLR   @03,@03                                          01S0083 00031000
         STH   @03,RETCODE                                      01S0083 00032000
*FRBPTR = ZERO;                        /* INIT FIRST RB PTR          */ 00033000
         ST    @03,FRBPTR                                       01S0084 00034000
*NUMREQS = ZERO;                       /* INIT NUMBER OF REQUESTS    */ 00035000
         SLR   NUMREQS,NUMREQS                                  01S0085 00036000
*IF JOBDSPRC = ON THEN                 /* DO DISPOSITION PROCESSING  */ 00037000
         L     @03,@PC00001                                     01S0086 00038000
         TM    JOBDSPRC(@03),B'00100000'                        01S0086 00039000
         BNO   @RF00086                                         01S0086 00040000
*  DO;                                                          01S0087 00041000
*/********************************************************************/ 00042000
*/*                                                                  */ 00043000
*/* SEGMENT NAME - READPDIS                                          */ 00044000
*/*                                                                  */ 00045000
*/* DESCRIPTIVE NAME - LOCATE THE PDIS, SIOTS, JFCBS, AND JFCBXS     */ 00046000
*/*                                                                  */ 00047000
*/* FUNCTION -                                                       */ 00048000
*/*   THE FUNCTION OF THIS SEGMENT IS TO LOCATE EACH PDI BLOCK       */ 00049000
*/*   AND ASSOCIATED SIOTS. FOR ALL NON-DUMMY DATA SETS,     @YM07452*/ 00050000
*/*   IF THE 'PASS' INDICATOR IS ON IN THE PDI ENTRY                 */ 00051000
*/*   OR THE DISPOSITION-HAS-BEEN-PROCESSED INDICATOR IS OFF         */ 00052000
*/*   IN THE SIOT, THE SIOT IS CHAINED TO THE PDI ENTRY AND THE      */ 00053000
*/*   JFCB AND JFCBXS ARE LOCATED AND CHAINED TO THE SIOT.           */ 00054000
*/*   THESE SIOTS THAT ARE CHAINED TO THE PDI ENTRIES WILL HAVE      */ 00055000
*/*   THEIR DISPOSITIONS PROCESSED BY JOB UNALLOCATION. ALL OTHER    */ 00056000
*/*   SIOTS ARE IGNORED.                                             */ 00057000
*/*                                                                  */ 00058000
*/* ENTRY - IN-LINE SEGMENT                                          */ 00059000
*/*                                                                  */ 00060000
*/*   PURPOSE - SEE FUNCTION                                         */ 00061000
*/*                                                                  */ 00062000
*/*   INPUT -                                                        */ 00063000
*/*     JCT -                                                        */ 00064000
*/*       JCTPDIP - SVA OF FIRST PDI BLOCK                           */ 00065000
*/*                                                                  */ 00066000
*/*     PDI -                                                        */ 00067000
*/*       PDICTR - NUMBER OF PDI ENTRIES IN THE PDI BLOCK            */ 00068000
*/*                                                                  */ 00069000
*/*       PDI ENTRY -                                                */ 00070000
*/*         PDISIOTA - SVA OF THE ASSOCIATED SIOT                    */ 00071000
*/*         PDIPASIN - PASS BIT (ON IF PASSED, OFF IF RECEIVED)      */ 00072000
*/*                                                                  */ 00073000
*/*       PDIBNXTP - ADDR OF THE NEXT PDI BLOCK                      */ 00074000
*/*                                                                  */ 00075000
*/*     SIOT -                                                       */ 00076000
*/*       SIOTDSPD - DISPOSITION-HAS-BEEN-PROCESSED BIT              */ 00077000
*/*                                                                  */ 00078000
*/*       SCTPJFCB - SVA OF THE JFCB                                 */ 00079000
*/*                                                                  */ 00080000
*/*     JFCB -                                                       */ 00081000
*/*       JFCBEXAD - SVA OF THE FIRST JFCB EXTENSION OF ZERO         */ 00082000
*/*                                                                  */ 00083000
*/*     JFCBX -                                                      */ 00084000
*/*       JFCBXTTR - SVA OF THE NEXT JFCBX                           */ 00085000
*/*                                                                  */ 00086000
*/* EXITS -                                                          */ 00087000
*/*   CONDITION - NORMAL COMPLETION                                  */ 00088000
*/*                                                                  */ 00089000
*/*   OUTPUT -                                                       */ 00090000
*/*                                                                  */ 00091000
*/*     PDI -                                                        */ 00092000
*/*                                                                  */ 00093000
*/*       PDI ENTRY -                                                */ 00094000
*/*         PDISIOTP - ADDRESS OF THE ASSOCIATED SIOT                */ 00095000
*/*                                                                  */ 00096000
*/*     SIOT -                                                       */ 00097000
*/*       SJFCBPTR - JFCB ADDRESS                                    */ 00098000
*/*       SIOTJFX - FIRST JFCBX ADDRESS                              */ 00099000
*/*                                                                  */ 00100000
*/*     JFCBX -                                                      */ 00101000
*/*       JFCBXNXT - ADDRESS OF THE NEXT JFCBX                       */ 00102000
*/*                                                                  */ 00103000
*/*     NUMREQS - NUMBER OF REQUESTS TO BE PROCESSED BY JOB          */ 00104000
*/*       UNALLOCATION                                               */ 00105000
*/*                                                                  */ 00106000
*/*   RETURN CODE - 0                                                */ 00107000
*/*                                                                  */ 00108000
*/********************************************************************/ 00109000
*IF JCTPDIP ^= ZERO THEN               /* PDI EXISTS                 */ 00110000
         L     @03,@PC00001+8                                   02S0088 00111000
         L     @03,JCTPTR(,@03)                                 02S0088 00112000
         ICM   @15,7,JCTPDIP(@03)                               02S0088 00113000
         BZ    @RF00088                                         02S0088 00114000
*  DO;                                 /* READ IN THE PDI            */ 00115000
*    CALL IEFAB4EB                     /* READ THE PDI               */ 00116000
*       (JCTPDIP,FPDIPTR,LPDIPTR,LEPAPTR);                      02S0090 00117000
         L     @15,@PC00001+8                                   02S0090 00118000
         L     @15,JCTPTR(,@15)                                 02S0090 00119000
         LA    @15,JCTPDIP(,@15)                                02S0090 00120000
         ST    @15,@AL00001                                     02S0090 00121000
         LA    @15,FPDIPTR                                      02S0090 00122000
         ST    @15,@AL00001+4                                   02S0090 00123000
         LA    @15,LPDIPTR                                      02S0090 00124000
         ST    @15,@AL00001+8                                   02S0090 00125000
         L     @15,@PC00001+16                                  02S0090 00126000
         ST    @15,@AL00001+12                                  02S0090 00127000
         L     @15,@CV00188                                     02S0090 00128000
         LA    @01,@AL00001                                     02S0090 00129000
         BALR  @14,@15                                          02S0090 00130000
*    PDIBLPTR = FPDIPTR;               /* BASE FOR FIRST PDI BLOCK   */ 00131000
         L     PDIBLPTR,FPDIPTR                                 02S0091 00132000
*    DO WHILE (PDIBLPTR ^= ZERO );     /* ALL BLOCKS PROCESSED       */ 00133000
         B     @DE00092                                         02S0092 00134000
@DL00092 DS    0H                                               02S0093 00135000
*      DO PDIECTR = ONE TO PDICTR;     /* ALL PDIES IN PDI BLOCK     */ 00136000
         LA    PDIECTR,1                                        02S0093 00137000
         B     @DE00093                                         02S0093 00138000
@DL00093 DS    0H                                               02S0094 00139000
*        SWACTLS = SWACTLS && SWACTLS; /* CLEAR 4F7 FUNCTION MAP     */ 00140000
         SLR   @05,@05                                          02S0094 00141000
         ICM   @05,3,SWACTLS                                    02S0094 00142000
         LR    @15,@05                                          02S0094 00143000
         XR    @15,@05                                          02S0094 00144000
         STH   @15,SWACTLS                                      02S0094 00145000
*        SWREAD = ON;                  /* READ A BLOCK               */ 00146000
*        SWNEW = ON;                   /* CREATE AN EPA              */ 00147000
*        SWFREE = ON;                  /* CHAIN THE EPA              */ 00148000
         OI    SWREAD,B'00101100'                               02S0097 00149000
*        CALL IEFAB4F7                 /* READ THE ASSOCIATED SIOT   */ 00150000
*           (SWACTLS,ZERO,ZERO,ADDR(PDISIOTA(PDIECTR)),         02S0098 00151000
*            ADDR(SIOTPTR),SWBLKLN,ONE);                        02S0098 00152000
         LA    @05,SWACTLS                                      02S0098 00153000
         ST    @05,@AL00001                                     02S0098 00154000
         LA    @05,@CF00184                                     02S0098 00155000
         ST    @05,@AL00001+4                                   02S0098 00156000
         LA    @05,@CF00184                                     02S0098 00157000
         ST    @05,@AL00001+8                                   02S0098 00158000
         LR    @05,PDIECTR                                      02S0098 00159000
         MH    @05,@CH01659                                     02S0098 00160000
         LA    @05,PDISIOTA-48(@05,PDIBLPTR)                    02S0098 00161000
         ST    @05,@TF00001                                     02S0098 00162000
         LA    @05,@TF00001                                     02S0098 00163000
         ST    @05,@AL00001+12                                  02S0098 00164000
         LA    @05,SIOTPTR                                      02S0098 00165000
         ST    @05,@TF00002                                     02S0098 00166000
         LA    @05,@TF00002                                     02S0098 00167000
         ST    @05,@AL00001+16                                  02S0098 00168000
         LA    @05,SWBLKLN                                      02S0098 00169000
         ST    @05,@AL00001+20                                  02S0098 00170000
         LA    @05,@CF00056                                     02S0098 00171000
         ST    @05,@AL00001+24                                  02S0098 00172000
         L     @15,@CV00191                                     02S0098 00173000
         LA    @01,@AL00001                                     02S0098 00174000
         BALR  @14,@15                                          02S0098 00175000
*        IF SCTDUMMY = OFF &           /* NOT DUMMY          @YM07452*/ 00176000
*           (PDIPASIN(PDIECTR) = ON |  /* PASSED, NOT RECEIVED       */ 00177000
*            SIOTDSPD = OFF) THEN      /* DISP NOT PROCESSED         */ 00178000
         L     @05,SIOTPTR                                      02S0099 00179000
         TM    SCTDUMMY(@05),B'10000000'                        02S0099 00180000
         BNZ   @RF00099                                         02S0099 00181000
         LR    @15,PDIECTR                                      02S0099 00182000
         MH    @15,@CH01659                                     02S0099 00183000
         ALR   @15,PDIBLPTR                                     02S0099 00184000
         AL    @15,@CF01946                                     02S0099 00185000
         TM    PDIPASIN-44(@15),B'00100000'                     02S0099 00186000
         BO    @RT00099                                         02S0099 00187000
         TM    SIOTDSPD(@05),B'01000000'                        02S0099 00188000
         BNZ   @RF00099                                         02S0099 00189000
@RT00099 DS    0H                                               02S0100 00190000
*          DO;                         /* READ THE JFCB              */ 00191000
*            PDISIOTP(PDIECTR) = SIOTPTR; /* SET PDI PTR TO SIOT     */ 00192000
         L     @15,SIOTPTR                                      02S0101 00193000
         LR    @14,PDIECTR                                      02S0101 00194000
         MH    @14,@CH01659                                     02S0101 00195000
         ST    @15,PDISIOTP-48(@14,PDIBLPTR)                    02S0101 00196000
*            CALL IEFAB4F7             /* READ THE JFCB              */ 00197000
*               (SWACTLS,ZERO,ZERO,ADDR(SCTPJFCB),              02S0102 00198000
*                ADDR(SJFCBPTR),SWBLKLN,ONE);                   02S0102 00199000
         LA    @14,SWACTLS                                      02S0102 00200000
         ST    @14,@AL00001                                     02S0102 00201000
         LA    @14,@CF00184                                     02S0102 00202000
         ST    @14,@AL00001+4                                   02S0102 00203000
         LA    @14,@CF00184                                     02S0102 00204000
         ST    @14,@AL00001+8                                   02S0102 00205000
         LA    @14,SCTPJFCB(,@15)                               02S0102 00206000
         ST    @14,@TF00001                                     02S0102 00207000
         LA    @14,@TF00001                                     02S0102 00208000
         ST    @14,@AL00001+12                                  02S0102 00209000
         LA    @15,SJFCBPTR(,@15)                               02S0102 00210000
         ST    @15,@TF00002                                     02S0102 00211000
         LA    @15,@TF00002                                     02S0102 00212000
         ST    @15,@AL00001+16                                  02S0102 00213000
         LA    @15,SWBLKLN                                      02S0102 00214000
         ST    @15,@AL00001+20                                  02S0102 00215000
         LA    @15,@CF00056                                     02S0102 00216000
         ST    @15,@AL00001+24                                  02S0102 00217000
         L     @15,@CV00191                                     02S0102 00218000
         LA    @01,@AL00001                                     02S0102 00219000
         BALR  @14,@15                                          02S0102 00220000
*            JFCBPTR = SJFCBPTR;                                02S0103 00221000
         L     @15,SIOTPTR                                      02S0103 00222000
         L     JFCBPTR,SJFCBPTR(,@15)                           02S0103 00223000
*            IF JFCBEXAD ^= ZERO THEN  /* JFCBXS EXIST               */ 00224000
         ICM   @14,7,JFCBEXAD(JFCBPTR)                          02S0104 00225000
         BZ    @RF00104                                         02S0104 00226000
*              DO;                     /* LOCATE THE JFCBXS          */ 00227000
*                CALL IEFAB4F7         /* READ THE FIRST JFCBX       */ 00228000
*                   (SWACTLS,ZERO,ZERO,ADDR(JFCBEXAD),          02S0106 00229000
*                    ADDR(SIOTJFX),SWBLKLN,ONE);                02S0106 00230000
         LA    @14,SWACTLS                                      02S0106 00231000
         ST    @14,@AL00001                                     02S0106 00232000
         LA    @14,@CF00184                                     02S0106 00233000
         ST    @14,@AL00001+4                                   02S0106 00234000
         LA    @14,@CF00184                                     02S0106 00235000
         ST    @14,@AL00001+8                                   02S0106 00236000
         LA    @14,JFCBEXAD(,JFCBPTR)                           02S0106 00237000
         ST    @14,@TF00001                                     02S0106 00238000
         LA    @14,@TF00001                                     02S0106 00239000
         ST    @14,@AL00001+12                                  02S0106 00240000
         LA    @15,SIOTJFX(,@15)                                02S0106 00241000
         ST    @15,@TF00002                                     02S0106 00242000
         LA    @15,@TF00002                                     02S0106 00243000
         ST    @15,@AL00001+16                                  02S0106 00244000
         LA    @15,SWBLKLN                                      02S0106 00245000
         ST    @15,@AL00001+20                                  02S0106 00246000
         LA    @15,@CF00056                                     02S0106 00247000
         ST    @15,@AL00001+24                                  02S0106 00248000
         L     @15,@CV00191                                     02S0106 00249000
         LA    @01,@AL00001                                     02S0106 00250000
         BALR  @14,@15                                          02S0106 00251000
*                JFCBXPTR = SIOTJFX;                            02S0107 00252000
         L     @05,SIOTPTR                                      02S0107 00253000
         MVC   JFCBXPTR(4),SIOTJFX(@05)                         02S0107 00254000
*                DO WHILE (JFCBXTTR ^= ZERO); /* LAST JFCBX READ     */ 00255000
         B     @DE00108                                         02S0108 00256000
@DL00108 DS    0H                                               02S0109 00257000
*                  CALL IEFAB4F7       /* READ IN A JFCBX            */ 00258000
*                     (SWACTLS,ZERO,ZERO,                       02S0109 00259000
*                      ADDR(JFCBXTTR),ADDR(JFCBXNXT),SWBLKLN,ONE);      00260000
         LA    @05,SWACTLS                                      02S0109 00261000
         ST    @05,@AL00001                                     02S0109 00262000
         LA    @05,@CF00184                                     02S0109 00263000
         ST    @05,@AL00001+4                                   02S0109 00264000
         LA    @05,@CF00184                                     02S0109 00265000
         ST    @05,@AL00001+8                                   02S0109 00266000
         LA    @05,JFCBXPTR                                     02S0109 00267000
         ST    @05,@AL00001+12                                  02S0109 00268000
         L     @05,JFCBXPTR                                     02S0109 00269000
         LA    @05,JFCBXNXT(,@05)                               02S0109 00270000
         ST    @05,@TF00001                                     02S0109 00271000
         LA    @05,@TF00001                                     02S0109 00272000
         ST    @05,@AL00001+16                                  02S0109 00273000
         LA    @05,SWBLKLN                                      02S0109 00274000
         ST    @05,@AL00001+20                                  02S0109 00275000
         LA    @05,@CF00056                                     02S0109 00276000
         ST    @05,@AL00001+24                                  02S0109 00277000
         L     @15,@CV00191                                     02S0109 00278000
         LA    @01,@AL00001                                     02S0109 00279000
         BALR  @14,@15                                          02S0109 00280000
*                  JFCBXPTR = JFCBXNXT;                         02S0110 00281000
         L     @05,JFCBXPTR                                     02S0110 00282000
         L     @05,JFCBXNXT(,@05)                               02S0110 00283000
         ST    @05,JFCBXPTR                                     02S0110 00284000
*                END;                                           02S0111 00285000
@DE00108 L     @05,JFCBXPTR                                     02S0111 00286000
         ICM   @15,7,JFCBXTTR(@05)                              02S0111 00287000
         BNZ   @DL00108                                         02S0111 00288000
*              END;                                             02S0112 00289000
*            NUMREQS = NUMREQS + ONE; /* BUMP COUNT OF REQUESTS      */ 00290000
@RF00104 AL    NUMREQS,@CF00056                                 02S0113 00291000
*          END;                                                 02S0114 00292000
*      END;                                                     02S0115 00293000
@RF00099 AL    PDIECTR,@CF00056                                 02S0115 00294000
@DE00093 SLR   @05,@05                                          02S0115 00295000
         IC    @05,PDICTR(,PDIBLPTR)                            02S0115 00296000
         CR    PDIECTR,@05                                      02S0115 00297000
         BNH   @DL00093                                         02S0115 00298000
*      PDIBLPTR = PDIBNXTP;            /* GET NEXT PDI BLOCK         */ 00299000
         L     PDIBLPTR,PDIBNXTP(,PDIBLPTR)                     02S0116 00300000
*    END;                                                       02S0117 00301000
@DE00092 LTR   PDIBLPTR,PDIBLPTR                                02S0117 00302000
         BNZ   @DL00092                                         02S0117 00303000
*  END;                                                         02S0118 00304000
*  END;                                                         01S0119 00305000
@RF00088 DS    0H                                               01S0120 00306000
*IF NUMREQS ^= ZERO THEN               /* REQUESTS EXIST             */ 00307000
@RF00086 LTR   NUMREQS,NUMREQS                                  01S0120 00308000
         BZ    @RF00120                                         01S0120 00309000
*  DO;                                                          01S0121 00310000
*/********************************************************************/ 00311000
*/*                                                                  */ 00312000
*/* SEGMENT NAME - BLDCOMRB                                          */ 00313000
*/*                                                                  */ 00314000
*/* DESCRIPTIVE NAME - BUILD COMMON UNALLOCATION REQUEST BLOCKS      */ 00315000
*/*                                                                  */ 00316000
*/* FUNCTION -                                                       */ 00317000
*/*   THE PURPOSE OF THIS SEGMENT IS TO BUILD THE REQUEST BLOCKS     */ 00318000
*/*   FOR COMMON UNALLOCATION. A REQUEST BLOCK IS BUILT FOR EACH     */ 00319000
*/*   PDI ENTRY THAT HAS A NON-ZERO SIOT ADDRESS. THE REQUEST BLOCKS */ 00320000
*/*   ARE CHAINED. THE OVERRIDE-DISPOSITION-PRESENT INDICATOR,       */ 00321000
*/*   THE INVALID-UCB INDICATOR, AND THE NO-DATA-SET-RELEASE         */ 00322000
*/*   INDICATOR ARE ALL SET ON. IF THE USE-CONDITIONAL-DISPOSITIONS  */ 00323000
*/*   INDICATOR IS ON AND A CONDITIONAL DISPOSITION WAS SPECIFIED,   */ 00324000
*/*   THE OVERRIDE DISPOSITION IS SET TO THE CONDITIONAL             */ 00325000
*/*   DISPOSITION. IF THE USE-CONDITIONAL-DISPOSITIONS INDICATOR IS  */ 00326000
*/*   NOT ON, OR A CONDITIONAL DISPOSITION WAS NOT PRESENT, THE      */ 00327000
*/*   OVERRIDE DISPOSITION IS SET TO KEEP FOR DATA SETS THAT WERE    */ 00328000
*/*   OLD WHEN ORIGINALLY PASSED, AND SET TO DELETE FOR DATA         */ 00329000
*/*   SETS THAT WERE NEW WHEN ORIGINALLY PASSED.                     */ 00330000
*/*                                                                  */ 00331000
*/* ENTRY - IN-LINE SEGMENT                                          */ 00332000
*/*                                                                  */ 00333000
*/*   PURPOSE - SEE FUNCTION                                         */ 00334000
*/*                                                                  */ 00335000
*/*   INPUT -                                                        */ 00336000
*/*                                                                  */ 00337000
*/*     NUMREQS - NUMBER OF REQUESTS TO BE PROCESSED BY JOB          */ 00338000
*/*       UNALLOCATION.                                              */ 00339000
*/*                                                                  */ 00340000
*/*     FPDIPTR - ADDRESS OF THE FIRST PDI BLOCK                     */ 00341000
*/*                                                                  */ 00342000
*/*     PDI -                                                        */ 00343000
*/*       PDICTR - NUMBER OF PDI ENTRIES IN THE PDI BLOCK            */ 00344000
*/*       PDIBNXTP - ADDRESS OF THE NEXT PDI BLOCK                   */ 00345000
*/*                                                                  */ 00346000
*/*       PDI ENTRY -                                                */ 00347000
*/*         PDISIOTP - ADDRESS OF THE ASSOCIATED SIOT OR ZERO        */ 00348000
*/*         PDIISTAT - ON IF DATA SET WAS OLD WHEN ORIGINALLY        */ 00349000
*/*           PASSED.                                                */ 00350000
*/*                                                                  */ 00351000
*/*     JOBCNDSP - PROCESS-CONDITIONAL-DISPOSITIONS BIT              */ 00352000
*/*                                                                  */ 00353000
*/*     SIOT -                                                       */ 00354000
*/*       SIOTALTD - CONDITIONAL DISPOSITION                         */ 00355000
*/*         SIOTAKEP - DISP = ,,KEEP                                 */ 00356000
*/*         SIOTADEL - DISP = ,,DELETE                               */ 00357000
*/*         SIOTACAT - DISP = ,,CATLG                                */ 00358000
*/*         SIOTAUNC - DISP = ,,UNCATLG                              */ 00359000
*/*                                                                  */ 00360000
*/* EXIT -                                                           */ 00361000
*/*                                                                  */ 00362000
*/* 1 CONDITION - NORMAL                                             */ 00363000
*/*                                                                  */ 00364000
*/*   OUTPUT -                                                       */ 00365000
*/*                                                                  */ 00366000
*/*     FRBPTR - ADDRESS OF FIRST COMMON UNALLOCATION RB             */ 00367000
*/*                                                                  */ 00368000
*/*     CMUNRB - COMMON UNALLOCATION REQUEST BLOCK                   */ 00369000
*/*       ALL FIELDS FILLED IN, SEE MAPPING MACRO                    */ 00370000
*/*                                                                  */ 00371000
*/*   RETURN CODE - 0                                                */ 00372000
*/*                                                                  */ 00373000
*/* 2 CONDITION - NO CORE AVAILABLE FOR RBS                          */ 00374000
*/*                                                                  */ 00375000
*/*   OUTPUT -                                                       */ 00376000
*/*                                                                  */ 00377000
*/*     RESNCODE - REASON CODE - SET TO 1                            */ 00378000
*/*                                                                  */ 00379000
*/*   RETURN CODE - 4                                                */ 00380000
*/*                                                                  */ 00381000
*/********************************************************************/ 00382000
*GETLENTH = NUMREQS * LENGTH(CMUNRB);  /* LENGTH OF CORE FOR RBS     */ 00383000
         LR    @03,NUMREQS                                      02S0122 00384000
         SLA   @03,4                                            02S0122 00385000
         ST    @03,GETLENTH                                     02S0122 00386000
* /* ?GETSTORG (SPID,GETLENTH,FRBPTR);*/                        02S0123 00387000
*   /* DEFINITIONS OF GETMAIN PARMS */                          02S0123 00388000
*   DCL                                                         02S0123 00389000
*     GTSTR0   FIXED(31) REG(0),/*GTMN PARM REG*/               02S0123 00390000
*     GTSTR1   FIXED(31) REG(1),/*GTMN PARM REG*/               02S0123 00391000
*     GTSTR2   PTR(31)   REG(2),/*GTMN PARM REG*/               02S0123 00392000
*     GTSTR15  FIXED(31) REG(15),/*GTMN RET COD*/               02S0123 00393000
*     GTSTRTCD FIXED(31); /* GETMAIN RTN CODE  */               02S0123 00394000
*   DCL                                                         02S0124 00395000
*     GTSTR3   FIXED(31) REG(3),/* CLEARING REG*/               02S0124 00396000
*     GTSTR4   FIXED(31) REG(4),/* CLEARING REG*/               02S0124 00397000
*     GTSTR5   FIXED(31) REG(5),/* CLEARING REG*/               02S0124 00398000
*     GTSTR6   FIXED(31) REG(6),/* CLEARING REG*/               02S0124 00399000
*     GTSTR7   FIXED(31) REG(7),/* CLEARING REG*/               02S0124 00400000
*     GTSTR8   FIXED(31) REG(8),/* CLEARING REG*/               02S0124 00401000
*     GTSTZERO FIXED(31) INIT(0),                               02S0124 00402000
*     GTST253  FIXED(31) CONSTANT(253);                         02S0124 00403000
*   RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/               02S0125 00404000
*   GTSTR0 = GETLENTH; /* SET AMOUNT*/                          02S0126 00405000
         LR    GTSTR0,@03                                       02S0126 00406000
*   GTSTR2 = SPID; /* SET SUBPOOL*/                             02S0127 00407000
         LA    GTSTR2,230                                       02S0127 00408000
*   GENERATE CODE;                                              02S0128 00409000
     GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN                               00410000
*   GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/               02S0129 00411000
         ST    GTSTR15,GTSTRTCD                                 02S0129 00412000
*   FRBPTR = GTSTR1; /* ADDR OF GOTN STORG*/                    02S0130 00413000
         ST    GTSTR1,FRBPTR                                    02S0130 00414000
*   RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */                02S0131 00415000
*   IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */               02S0132 00416000
         L     @15,GTSTRTCD                                     02S0132 00417000
         LTR   @15,@15                                          02S0132 00418000
         BNZ   @RF00132                                         02S0132 00419000
*     DO;               /* YES, CLEAR STORAGE.*/                02S0133 00420000
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       02S0134 00421000
*                          GTSTR7,GTSTR8) RSTD;                 02S0134 00422000
*       GTSTR4 = FRBPTR; /*STORG PTR*/                          02S0135 00423000
         L     @09,FRBPTR                                       02S0135 00424000
         LR    GTSTR4,@09                                       02S0135 00425000
*       GTSTR5 = GETLENTH; /*STORG AMNT*/                       02S0136 00426000
         L     GTSTR5,GETLENTH                                  02S0136 00427000
*       GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/               02S0137 00428000
         SLR   GTSTR7,GTSTR7                                    02S0137 00429000
*       IF SPID = GTST253 THEN                                  02S0138 00430000
         B     @RF00138                                         02S0138 00431000
*      GEN                                                      02S0139 00432000
*   (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);           02S0139 00433000
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8                 00434000
*       GEN REFS(GTSTR4,GTSTR6);                                02S0140 00435000
@RF00138 DS    0H                                               02S0140 00436000
          MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG                        00437000
*       IF SPID = GTST253 THEN                                  02S0141 00438000
         B     @RF00141                                         02S0141 00439000
*         GEN (MODESET KEYADDR=(2));                            02S0142 00440000
         MODESET KEYADDR=(2)                                            00441000
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       02S0143 00442000
*                          GTSTR7,GTSTR8) UNRSTD;               02S0143 00443000
@RF00141 DS    0H                                               02S0144 00444000
*     END;       /* STORAGE CLEARING COMPLETED */               02S0144 00445000
*   ELSE                                                        02S0145 00446000
*   FRBPTR= 0;   /* CLEAR RETURN ADDR. */                       02S0145 00447000
         B     @RC00132                                         02S0145 00448000
@RF00132 SLR   @15,@15                                          02S0145 00449000
         ST    @15,FRBPTR                                       02S0145 00450000
*   GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */               02S0146 00451000
@RC00132 L     GTSTR15,GTSTRTCD                                 02S0146 00452000
*                                      /* RESTORE LIST PRINT STATUS  */ 00453000
*     /* GET SPACE FOR RBS          */                          02S0147 00454000
*IF REG15 = ZERO THEN                  /* CORE WAS GOTTEN            */ 00455000
         LTR   REG15,REG15                                      02S0147 00456000
         BNZ   @RF00147                                         02S0147 00457000
*  DO;                                 /* CONTINUE                   */ 00458000
*    PDIBLPTR = FPDIPTR;               /* GET FIRST PDI BLOCK        */ 00459000
         L     PDIBLPTR,FPDIPTR                                 02S0149 00460000
*    CMRBPTR = FRBPTR;                 /* GET THE FIRST RB           */ 00461000
         L     CMRBPTR,FRBPTR                                   02S0150 00462000
*    DO WHILE (PDIBLPTR ^= ZERO);      /* LOOP THRU PDI BLOCKS       */ 00463000
         B     @DE00151                                         02S0151 00464000
@DL00151 DS    0H                                               02S0152 00465000
*      DO PDIECTR = ONE TO PDICTR;     /* LOOP THRU PDI ENTRIES      */ 00466000
         LA    PDIECTR,1                                        02S0152 00467000
         B     @DE00152                                         02S0152 00468000
@DL00152 DS    0H                                               02S0153 00469000
*        IF PDISIOTP(PDIECTR) ^= ZERO THEN/* SIOT EXISTS,MUST PROCESS*/ 00470000
         LR    @05,PDIECTR                                      02S0153 00471000
         MH    @05,@CH01659                                     02S0153 00472000
         L     @05,PDISIOTP-48(@05,PDIBLPTR)                    02S0153 00473000
         LTR   @05,@05                                          02S0153 00474000
         BZ    @RF00153                                         02S0153 00475000
*          DO;                                                  02S0154 00476000
*            SIOTPTR = PDISIOTP(PDIECTR); /* ADDRESS THE ASSOC. SIOT */ 00477000
         ST    @05,SIOTPTR                                      02S0155 00478000
*            CMNRBPTR = CMRBPTR + LENGTH(CMUNRB); /* PTR TO NEXT RB  */ 00479000
         LA    @15,16                                           02S0156 00480000
         ALR   @15,CMRBPTR                                      02S0156 00481000
         ST    @15,CMNRBPTR(,CMRBPTR)                           02S0156 00482000
*            CMSIOPTR = SIOTPTR;       /* SIOT ADDRESS IN RB         */ 00483000
         ST    @05,CMSIOPTR(,CMRBPTR)                           02S0157 00484000
*            CMORDISP = ON;            /* USE OVERRIDE DISP          */ 00485000
*            CMINVUCB = ON;            /* UCB ADDRESSES ARE INVALID  */ 00486000
         OI    CMORDISP(CMRBPTR),B'00010100'                    02S0159 00487000
*            CMNODSR = ON;             /* NO DATA SET RELEASE        */ 00488000
         OI    CMNODSR(CMRBPTR),B'10000000'                     02S0160 00489000
*            NOCNDISP = OFF;           /* INIT COND DISP WORK BIT    */ 00490000
         NI    NOCNDISP,B'11110111'                             02S0161 00491000
*            IF JOBCNDSP = ON THEN     /* USE COND DISPS IF PRESENT  */ 00492000
         L     @15,@PC00001                                     02S0162 00493000
         TM    JOBCNDSP(@15),B'10000000'                        02S0162 00494000
         BNO   @RF00162                                         02S0162 00495000
*              IF SIOTAKEP = ON THEN   /* DISP = ,, KEEP             */ 00496000
         TM    SIOTAKEP(@05),B'00001000'                        02S0163 00497000
         BNO   @RF00163                                         02S0163 00498000
*                CMOKEEP = ON;         /* KEEP THE DATA SET          */ 00499000
         OI    CMOKEEP(CMRBPTR),B'00001000'                     02S0164 00500000
*              ELSE                    /* NOT ,,KEEP                 */ 00501000
*                IF SIOTADEL = ON THEN /* DISP = ,,DELETE            */ 00502000
         B     @RC00163                                         02S0165 00503000
@RF00163 L     @05,SIOTPTR                                      02S0165 00504000
         TM    SIOTADEL(@05),B'00000100'                        02S0165 00505000
         BNO   @RF00165                                         02S0165 00506000
*                  CMODEL = ON;        /* DELETE THE DATA SET        */ 00507000
         OI    CMODEL(CMRBPTR),B'00000100'                      02S0166 00508000
*                ELSE                  /* NOT ,,DELETE               */ 00509000
*                  IF SIOTACAT = ON THEN /* DISP =,,CATLG            */ 00510000
         B     @RC00165                                         02S0167 00511000
@RF00165 L     @05,SIOTPTR                                      02S0167 00512000
         TM    SIOTACAT(@05),B'00000010'                        02S0167 00513000
         BNO   @RF00167                                         02S0167 00514000
*                    CMOCATLG = ON;    /* CATALOG THE DATA SET       */ 00515000
         OI    CMOCATLG(CMRBPTR),B'00000010'                    02S0168 00516000
*                  ELSE                /* NOT ,,CATLG                */ 00517000
*                    IF SIOTAUNC = ON THEN /* DISP = ,,UNCATLG       */ 00518000
         B     @RC00167                                         02S0169 00519000
@RF00167 L     @05,SIOTPTR                                      02S0169 00520000
         TM    SIOTAUNC(@05),B'00000001'                        02S0169 00521000
         BNO   @RF00169                                         02S0169 00522000
*                      CMOUNCAT = ON;  /* UNCATALOG THE DATA SET     */ 00523000
         OI    CMOUNCAT(CMRBPTR),B'00000001'                    02S0170 00524000
*                    ELSE              /* NO COND DISP               */ 00525000
*                      NOCNDISP = ON;  /* SET WORK BIT               */ 00526000
         B     @RC00169                                         02S0171 00527000
@RF00169 OI    NOCNDISP,B'00001000'                             02S0171 00528000
*            IF JOBCNDSP = OFF |       /* DONT USE COND DISP         */ 00529000
*                NOCNDISP = ON THEN    /* NO COND DISP PRESENT       */ 00530000
@RC00169 DS    0H                                               02S0172 00531000
@RC00167 DS    0H                                               02S0172 00532000
@RC00165 DS    0H                                               02S0172 00533000
@RC00163 DS    0H                                               02S0172 00534000
@RF00162 L     @05,@PC00001                                     02S0172 00535000
         TM    JOBCNDSP(@05),B'10000000'                        02S0172 00536000
         BZ    @RT00172                                         02S0172 00537000
         TM    NOCNDISP,B'00001000'                             02S0172 00538000
         BNO   @RF00172                                         02S0172 00539000
@RT00172 DS    0H                                               02S0173 00540000
*              IF PDIISTAT(PDIECTR) = ON THEN /* DISP = OLD          */ 00541000
         LR    @05,PDIECTR                                      02S0173 00542000
         MH    @05,@CH01659                                     02S0173 00543000
         ALR   @05,PDIBLPTR                                     02S0173 00544000
         AL    @05,@CF01946                                     02S0173 00545000
         TM    PDIISTAT-44(@05),B'10000000'                     02S0173 00546000
         BNO   @RF00173                                         02S0173 00547000
*                CMOKEEP = ON;         /* KEEP THE DATA SET          */ 00548000
         OI    CMOKEEP(CMRBPTR),B'00001000'                     02S0174 00549000
*              ELSE                    /* DISP = NEW                 */ 00550000
*                CMODEL = ON;          /* DELETE THE DATA SET        */ 00551000
         B     @RC00173                                         02S0175 00552000
@RF00173 OI    CMODEL(CMRBPTR),B'00000100'                      02S0175 00553000
*            CMRBPTR = CMNRBPTR;       /* NEXT RB                    */ 00554000
@RC00173 DS    0H                                               02S0176 00555000
@RF00172 L     CMRBPTR,CMNRBPTR(,CMRBPTR)                       02S0176 00556000
*          END;                                                 02S0177 00557000
*      END;                                                     02S0178 00558000
@RF00153 AL    PDIECTR,@CF00056                                 02S0178 00559000
@DE00152 SLR   @05,@05                                          02S0178 00560000
         IC    @05,PDICTR(,PDIBLPTR)                            02S0178 00561000
         CR    PDIECTR,@05                                      02S0178 00562000
         BNH   @DL00152                                         02S0178 00563000
*      PDIBLPTR = PDIBNXTP;            /* GET NEXT PDI BLOCK         */ 00564000
         L     PDIBLPTR,PDIBNXTP(,PDIBLPTR)                     02S0179 00565000
*    END;                                                       02S0180 00566000
@DE00151 SLR   @15,@15                                          02S0180 00567000
         CR    PDIBLPTR,@15                                     02S0180 00568000
         BNE   @DL00151                                         02S0180 00569000
*    EVAL(CMRBPTR-LENGTH(CMUNRB)) -> CMNRBPTR = ZERO; /* ZERO NEXT PTR  00570000
*                                         IN LAST RB                 */ 00571000
         LR    @03,CMRBPTR                                      02S0181 00572000
         SH    @03,@CH00052                                     02S0181 00573000
         ST    @15,CMNRBPTR(,@03)                               02S0181 00574000
*  END;                                                         02S0182 00575000
*ELSE                                  /* NO CORE FOR RBS            */ 00576000
*  DO;                                 /* SET RETURN INFO            */ 00577000
         B     @RC00147                                         02S0183 00578000
@RF00147 DS    0H                                               02S0184 00579000
*    RETCODE = ERROR;                  /* BAD RETURN CODE            */ 00580000
         MVC   RETCODE(2),@CH00098                              02S0184 00581000
*    RESNCODE = GETERROR;              /* GETMAIN ERROR              */ 00582000
         L     @15,@PC00001+20                                  02S0185 00583000
         MVC   RESNCODE(2,@15),@CH00056                         02S0185 00584000
*  END;                                                         02S0186 00585000
*    IF RETCODE = ZERO THEN            /* RBS WERE BUILT             */ 00586000
@RC00147 ICM   @15,3,RETCODE                                    01S0187 00587000
         BNZ   @RF00187                                         01S0187 00588000
*      DO;                             /* CONTINUE                   */ 00589000
*        CMUNFMAP = CMUNFMAP && CMUNFMAP;/* CLEAR FUNCTION MAP       */ 00590000
         LA    @15,CFMAPCOR                                     01S0189 00591000
         XC    CMUNFMAP(4,@15),CMUNFMAP(@15)                    01S0189 00592000
*        IF JOBMSGS = ON THEN          /* DISP MSGS REQUESTED        */ 00593000
         L     @15,@PC00001                                     01S0190 00594000
         TM    JOBMSGS(@15),B'01000000'                         01S0190 00595000
         BNO   @RF00190                                         01S0190 00596000
*          CMDMSGS = ON;               /* SET IN COMMON FUNC. MAP    */ 00597000
         LA    @15,CFMAPCOR                                     01S0191 00598000
         OI    CMDMSGS(@15),B'10000000'                         01S0191 00599000
*        IF JOBMSTAT = ON THEN         /* MN STATUS REQUESTED        */ 00600000
@RF00190 L     @15,@PC00001                                     01S0192 00601000
         TM    JOBMSTAT(@15),B'00010000'                        01S0192 00602000
         BNO   @RF00192                                         01S0192 00603000
*          CMMNSTAT = ON;              /* SET IN COMMON FUNC. MAP    */ 00604000
         LA    @15,CFMAPCOR                                     01S0193 00605000
         OI    CMMNSTAT(@15),B'01000000'                        01S0193 00606000
*        CMDISPRC = ON;                /* PROCESS DISPOSITIONS       */ 00607000
@RF00192 LA    @15,CFMAPCOR                                     01S0194 00608000
         OI    CMDISPRC(@15),B'00100000'                        01S0194 00609000
*        CMNOPOST = ON;                /* DO NOT POST Q-MNGR         */ 00610000
*        CMNOVUT = ON;                 /* DO NOT PROCESS VUT         */ 00611000
         OI    CMNOPOST(@15),B'11000000'                        01S0196 00612000
*        CMSPSCR = ON;                 /* SPECIAL SCRATCH PROCESSING */ 00613000
         OI    CMSPSCR(@15),B'00001000'                         01S0197 00614000
*        FSIOTP = ZERO;                /* NO STEP SIOT CHAIN         */ 00615000
         SLR   @14,@14                                          01S0198 00616000
         ST    @14,FSIOTP                                       01S0198 00617000
*        CALL IEFAB4A0                 /* INVOKE COMMON UNALLOCATION */ 00618000
*           (CMUNFMAP,FRBPTR,JSCBPTR,FSIOTP,JCTDETDA,ZERO,      01S0199 00619000
*            JCTVULDP,RESNCODE,0);                        /* @ZD03010*/ 00620000
         ST    @15,@AL00001                                     01S0199 00621000
         LA    @15,FRBPTR                                       01S0199 00622000
         ST    @15,@AL00001+4                                   01S0199 00623000
         L     @15,@PC00001+4                                   01S0199 00624000
         ST    @15,@AL00001+8                                   01S0199 00625000
         LA    @15,FSIOTP                                       01S0199 00626000
         ST    @15,@AL00001+12                                  01S0199 00627000
         L     @15,@PC00001+8                                   01S0199 00628000
         L     @15,JCTPTR(,@15)                                 01S0199 00629000
         LA    @14,JCTDETDA(,@15)                               01S0199 00630000
         ST    @14,@AL00001+16                                  01S0199 00631000
         LA    @14,@CF00184                                     01S0199 00632000
         ST    @14,@AL00001+20                                  01S0199 00633000
         LA    @15,JCTVULDP(,@15)                               01S0199 00634000
         ST    @15,@AL00001+24                                  01S0199 00635000
         L     @15,@PC00001+20                                  01S0199 00636000
         ST    @15,@AL00001+28                                  01S0199 00637000
         LA    @15,@CF00184                                     01S0199 00638000
         ST    @15,@AL00001+32                                  01S0199 00639000
         L     @15,@CV00187                                     01S0199 00640000
         LA    @01,@AL00001                                     01S0199 00641000
         BALR  @14,@15                                          01S0199 00642000
*      END;                                                     01S0200 00643000
*  END;                                                         01S0201 00644000
@RF00187 DS    0H                                               01S0202 00645000
*ESTAJOBU = OFF;                       /* PVT UNLOAD TRIED           */ 00646000
@RF00120 L     @08,@PC00001+12                                  01S0202 00647000
         L     @08,ESTAPTR(,@08)                                01S0202 00648000
         NI    ESTAJOBU(@08),B'11011111'                        01S0202 00649000
*/********************************************************************/ 00650000
*/*                                                                  */ 00651000
*/* SEGMENT NAME - VOLCLNP                                           */ 00652000
*/*                                                                  */ 00653000
*/* DESCRIPTIVE NAME - END OF JOB VOLUME CLEANUP                     */ 00654000
*/*                                                                  */ 00655000
*/* FUNCTION -                                                       */ 00656000
*/*   THIS SEGMENT PROVIDES THE FOLLOWING FUNCTIONS:                 */ 00657000
*/*                                                                  */ 00658000
*/*     1. UNLOADING OR REWINDING VOLUMES -                          */ 00659000
*/*        ANY VOLUME WHICH APPEARS IN THE VOLUME UNLOAD TABLE (VUT) */ 00660000
*/*        AND WASN'T UNLOADED BY UNIT UNALLOCATION          @ZD03010*/ 00661000
*/*        DURING THE JOB BEING UNALLOCATED                  @ZD03010*/ 00662000
*/*        AND HAS THE FOLLOWING CHARACTERISTICS IS UNLOADED:        */ 00663000
*/*                                                                  */ 00664000
*/*        . VOLUME IS REMOVABLE                                     */ 00665000
*/*        . VOLUME IS PRIVATE OR IS PUBLIC MSS VOLUME       @Z40LPPE*/ 00666000
*/*        . VOLUME IS NOT MARKED NON-USABLE BY ALLOCATION           */ 00667000
*/*        . VOLUME IS UNALLOCATED                                   */ 00668000
*/*        . VOLUME IS TAPE OR DIRECT ACCESS                         */ 00669000
*/*        . VOLUME IS NOT ON A JES3-MANAGED DIRECT ACCESS   @ZA06651*/ 00670000
*/*          UNIT (UNLESS THE UNIT IS 3330V). JES3 ISSUES    @ZA06651*/ 00671000
*/*          MOUNT/DEMOUNT MESSAGES FOR NON-3330V, D.A., JES3@ZA06651*/ 00672000
*/*          MANAGED UNITS. A DEMOUNT MESSAGE ISSUED VIA     @ZA06651*/ 00673000
*/*          IEFBB416 CALLING VM&V WOULD CONFUSE THE OPERATOR@ZA06651*/ 00674000
*/*          OR POSSIBLY EVEN DESTROY A JES3 SETUP.          @ZA06651*/ 00675000
*/*                                                                  */ 00676000
*/*        ANY VOLUME WHICH APPEARS IN THE VUT AND HAS THE           */ 00677000
*/*        FOLLOWING CHARACTERISTICS IS REWOUND:                     */ 00678000
*/*                                                                  */ 00679000
*/*        . VOLUME IS A TAPE                                        */ 00680000
*/*        . VOLUME IS PUBLIC                                        */ 00681000
*/*        . VOLUME IS REMOVABLE                                     */ 00682000
*/*        . VOLUME IS NOT MARKED NON-USABLE BY ALLOCATION           */ 00683000
*/*        . VOLUME IS UNALLOCATED                                   */ 00684000
*/*                                                                  */ 00685000
*/*        VOLUME MOUNT AND VERIFY (VM&V) IS USED TO UNLOAD          */ 00686000
*/*        OR REWIND THESE VOLUMES AND INFORM THE OPERATOR           */ 00687000
*/*        OF THE STATUS OF THOSE BEING UNLOADED. VOLUMES            */ 00688000
*/*        APPEAR IN THE VUT AS A RESULT OF BEING PRIVATE OR         */ 00689000
*/*        CONTAINING PASSED DATA SETS. THE PASS INDICATOR IN THE    */ 00690000
*/*        UCB IS RESET FOR EACH VOLUME THAT IS UNLOADED OR REWOUND. */ 00691000
*/*                                                                  */ 00692000
*/*     2. ISSUE THE 'RELEASE' MESSAGE -                             */ 00693000
*/*        A MESSAGE IS ISSUED TO THE SYSTEM OPERATOR INFORMING      */ 00694000
*/*        HIM OF VOLUMES THAT WERE PREVIOUSLY DISMOUNTED    @ZA09506*/ 00695000
*/*        WITH EITHER A RETAIN MESSAGE (AN 'R' TYPE UNLOAD  @ZA09506*/ 00696000
*/*        MESSAGE) OR A KEEP MESSAGE FROM DATA MANAGEMENT.  @ZA09506*/ 00697000
*/*        A VOLUME APPEARS IN THE RELEASE MESSAGE IF IT     @ZA09506*/ 00698000
*/*        APPEARS IN THE VUT BUT IS NOT MOUNTED ON ANY UNIT IN THE  */ 00699000
*/*        SYSTEM. ONE WAY FOR A VOLUME TO BECOME RETAINED IS IF IT  */ 00700000
*/*        WAS DISMOUNTED BY ANOTHER ALLOCATION AND HAD THE PRIVATE  */ 00701000
*/*        OR PASS INDICATORS ON IN THE UCB. NOTE THAT       @Y30LPPG*/ 00702000
*/*        MSS VOLUMES ARE NEVER INCLUDED IN THIS            @Y30LPPG*/ 00703000
*/*        MESSAGE, AS THERE IS NO INTERACTION BETWEEN MSS   @Y30LPPG*/ 00704000
*/*        AND THE OPERATOR.                                 @Y30LPPG*/ 00705000
*/*                                                                  */ 00706000
*/*     3. CLEANUP UNOPENED NON-SPECIFIC TAPE UCBS -                 */ 00707000
*/*        THE VOLUME SERIAL FIELD OF EACH UCB WHICH WAS ALLOCATED   */ 00708000
*/*        TO THIS JOB FOR A NON-SPECIFIC TAPE REQUEST AND NEVER     */ 00709000
*/*        OPENED IS SET TO ZERO. THESE VOLUMES ARE IDENTIFIED BY    */ 00710000
*/*        HAVING HEX 'FF' IN THE FIRST BYTE OF THE VOLUME SERIAL    */ 00711000
*/*        AND THE ASID OF THIS MEMORY IN THE FIFTH AND SIXTH BYTES. */ 00712000
*/*                                                                  */ 00713000
*/*     OPERATION -                                                  */ 00714000
*/*       1. THE VUT IS ACCESSED VIA THE SWA MANAGER AND CHAINED     */ 00715000
*/*          WITH IN-CORE ADDRESSES. AFTER THE VUT HAS BEEN READ     */ 00716000
*/*          CORE IS GOTTEN TO BUILD A VOLUME LIST, VM&V     @Z40LPPK*/ 00717000
*/*          REQUEST BLOCKS, AND A LIST OF UCBS. EACH        @Z40LPPK*/ 00718000
*/*          UNIQUE VOLUME SERIAL IN THE VUT IS PLACED IN    @Z40LPPK*/ 00719000
*/*          THE VOLUME LIST.                                @Z40LPPK*/ 00720000
*/*                                                                  */ 00721000
*/*       2. EACH UCB IN THE SYSTEM IS SCANNED TO DETERMINE IF IT    */ 00722000
*/*          CONTAINS A VOLUME SERIAL THAT SHOULD BE HANDLED BY THIS */ 00723000
*/*          ROUTINE. IF A VOL SER IN A GIVEN UCB IS IN THE VOL      */ 00724000
*/*          LIST, THE ADDRESS OF THE UCB IS PLACED IN A     @Z40LPPK*/ 00725000
*/*          LIST OF UCB'S.  THIS LIST WILL LATER BE PASSED  @Z40LPPK*/ 00726000
*/*          TO A SERVICE ROUTINE WHICH WILL SERIALIZE,      @Z40LPPK*/ 00727000
*/*          OR 'LOCK' ON THE GROUPS REPRESENTED BY THE UCB  @Z40LPPK*/ 00728000
*/*          LIST.  IF THE UCB HAS A 'FF'                    @Z40LPPK*/ 00729000
*/*          TAPE SERIAL NUMBER WITH THE ASID OF THIS MEMORY IT IS   */ 00730000
*/*          ADDED TO THE LIST OF FF TAPES. THIS LIST IS USED TO     */ 00731000
*/*          UPDATE THE TAPE UCBS.                           @Z40LPPK*/ 00732000
*/*                                                          @Z40LPPK*/ 00733000
*/*       3. THE VOLUME UNLOADING AND UCB CLEANUP IS         @Z40LPPK*/ 00734000
*/*          SERIALIZED WITH OTHER UCB-DEPENDENT PROCESSES   @Z40LPPK*/ 00735000
*/*          (FOR INSTANCE: ALLOCATION, VARY COMMAND         @Z40LPPK*/ 00736000
*/*          PROCESSING, AND JES3 UNLOADING-VIA VM&V).       @Z40LPPK*/ 00737000
*/*          THIS SERIALIZATION IS ACCOMPLISHED BY           @Z40LPPK*/ 00738000
*/*          PASSING A LIST OF ALL UCB'S TO BE CLEANED UP    @Z40LPPK*/ 00739000
*/*          OR TO HAVE THEIR VOLUMES UNLOADED TO A ROUTINE, @Z40LPPK*/ 00740000
*/*          IEFAB4EC, WHICH WILL LOCK THE NECESSARY DEVICE  @Z40LPPK*/ 00741000
*/*          GROUPS VIA THE ALLOCATION Q-MANAGER.            @Z40LPPK*/ 00742000
*/*                                                          @Z40LPPK*/ 00743000
*/*       4. VM&V REQUEST BLOCKS ARE BUILT AND CHAINED FOR   @Z40LPPK*/ 00744000
*/*          ALL REWINDABLE OR UNLOADABLE VOLUMES.           @Z40LPPK*/ 00745000
*/*                                                                  */ 00746000
*/*       5. IF ANY VM&V REQUEST BLOCKS WERE BUILT, VM&V IS INVOKED  */ 00747000
*/*          TO DO THE UNLOADING, REWINDING, AND ISSUING OF UNLOAD   */ 00748000
*/*          MESSAGES                                                */ 00749000
*/*                                                                  */ 00750000
*/*       6. THE CMS AND LOCAL LOCKS ARE OBTAINED. THESE LOCKS ARE   */ 00751000
*/*          NEEDED IN ORDER TO UPDATE THE UCBS.                     */ 00752000
*/*                                                                  */ 00753000
*/*       7. THE VOLUME SERIAL FIELD OF EACH UCB IN THE FF SERIAL    */ 00754000
*/*          LIST IS CLEARED.                                        */ 00755000
*/*                                                                  */ 00756000
*/*       8. THE CMS AND LOCAL LOCKS ARE RELEASED.                   */ 00757000
*/*                                                                  */ 00758000
*/*                                                                  */ 00759000
*/*       NOTE: IF NO VOLUME LIST IS BUILT AND THERE ARE     @YM04401*/ 00760000
*/*             NO FF SERIALS TO PROCESS, STEPS 3 THROUGH 8  @Z40LPPK*/ 00761000
*/*             ARE BYPASSED.                                @YM04401*/ 00762000
*/*                                                                  */ 00763000
*/*       9. IF ANY VOLUMES IN THE VOLUME LIST WERE NOT FOUND ON     */ 00764000
*/*          THE SYSTEM AND WERE NOT UNLOADED WITH A 'KEEP'  @ZD03010*/ 00765000
*/*          MSG, THE 'RELEASE' MESSAGE IS BUILT AND ISSUED. @ZD03010*/ 00766000
*/*          A MULTI-LINE WTO IS USED.                               */ 00767000
*/*                                                                  */ 00768000
*/*       10. CORE USED BY THE VOLUME LIST, THE VM&V REQUEST BLOCKS, */ 00769000
*/*           AND THE LIST OF UCB'S TO BE SERIALIZED ON      @Z40LPPK*/ 00770000
*/*           IS FREED.                                      @Z40LPPK*/ 00771000
*/*                                                                  */ 00772000
*/* ENTRY - IN-LINE SEGMENT                                          */ 00773000
*/*                                                                  */ 00774000
*/*   PURPOSE - SEE FUNCTION                                         */ 00775000
*/*                                                                  */ 00776000
*/*   INPUT -                                                        */ 00777000
*/*     JCT -                                                        */ 00778000
*/*       JCTVULDP - SVA  OF THE VUT                                 */ 00779000
*/*       JCTJNAME - JOB NAME                                        */ 00780000
*/*                                                                  */ 00781000
*/*     VUNLDTAB - VOLUME UNLOAD TABLE (IEFZB438)                    */ 00782000
*/*       VUTNSVA - SVA OF NEXT BLOCK                                */ 00783000
*/*       VUTENTNO - NUMBER OF ENTRIES IN THE BLOCK                  */ 00784000
*/*       VUTENVOL - VOLUME SERIAL                           @Y30LPPG*/ 00785000
*/*                                                                  */ 00786000
*/*     IOSLUT - IOS UCB LOOKUP TABLE                                */ 00787000
*/*                                                                  */ 00788000
*/*     ASCB -                                               @Z40FPPD*/ 00789000
*/*       ASCBASID - ASID                                    @Z40FPPD*/ 00790000
*/*                                                                  */ 00791000
*/* EXIT -                                                           */ 00792000
*/* 1 CONDITION - NORMAL COMPLETION                                  */ 00793000
*/*     OUTPUT -                                                     */ 00794000
*/*       VOLUMES UNLOADED                                           */ 00795000
*/*       'RELEASE' MESSAGE ISSUED                                   */ 00796000
*/*       TAPE UCBS RESET                                            */ 00797000
*/*     RETURN CODE -                                                */ 00798000
*/*       RETCODE = 0                                                */ 00799000
*/*                                                                  */ 00800000
*/* 2 CONDITION - GETMAIN ERROR OCCURRED                             */ 00801000
*/*     OUTPUT -                                                     */ 00802000
*/*       SOME OF THE ABOVE DEPENDING ON WHERE THE ERROR OCCURRED    */ 00803000
*/*       REASON CODE -                                              */ 00804000
*/*         RESNCODE = 1                                             */ 00805000
*/*     RETURN CODE -                                                */ 00806000
*/*       RETCODE = 4                                                */ 00807000
*/*                                                                  */ 00808000
*/* 3 CONDITION - ERROR IN GROUP LOCKING ROUTINE             @Z40LPPK*/ 00809000
*/*     OUTPUT -                                             @Z40LPPK*/ 00810000
*/*       REASON CODE - (IF ESTAE ERROR)                     @Z40LPPK*/ 00811000
*/*         RESNCODE = 4                                     @Z40LPPK*/ 00812000
*/*     RETURN CODE - IF ESTAE ERROR                         @Z40LPPK*/ 00813000
*/*       RETCODE = 4                                        @Z40LPPK*/ 00814000
*/*                                                                  */ 00815000
*/********************************************************************/ 00816000
*FUNLDRBP = ZERO;                      /* INIT FIRST VM&V RB PTR     */ 00817000
         SLR   @08,@08                                          02S0203 00818000
         ST    @08,FUNLDRBP                                     02S0203 00819000
*RLSECTR = ZERO;                       /* INIT RLSE VOLSERS CTR      */ 00820000
         ST    @08,RLSECTR                                      02S0204 00821000
*RETCODE = ZERO;                       /* INIT RETCODE TO OK         */ 00822000
         STH   @08,RETCODE                                      02S0205 00823000
*VOLCOREP = ZERO;                      /* INIT VOLLST ADDRESS TO ZERO*/ 00824000
         ST    @08,VOLCOREP                                     02S0206 00825000
*TOTVOLS = ZERO;                       /* NO VOLS IN VOLLIST         */ 00826000
         SLR   TOTVOLS,TOTVOLS                                  02S0207 00827000
*FFSERCTR = ZERO;                      /* INIT TOTAL NO. OF FFSERS      00828000
*                                         TO NIL.            @Z40LPPK*/ 00829000
         ST    @08,FFSERCTR                                     02S0208 00830000
*ASID = ASCBASID;                      /*OBTAIN ASID         @Z40FPPD*/ 00831000
         L     @01,PSAAOLD                                      02S0209 00832000
         MVC   ASID(2),ASCBASID(@01)                            02S0209 00833000
*IF JCTVULDP ^= ZERO THEN              /* A VUT EXISTS               */ 00834000
         L     @15,@PC00001+8                                   02S0210 00835000
         L     @01,JCTPTR(,@15)                                 02S0210 00836000
         SLR   @15,@15                                          02S0210 00837000
         ICM   @15,7,JCTVULDP(@01)                              02S0210 00838000
         LTR   @15,@15                                          02S0210 00839000
         BZ    @RF00210                                         02S0210 00840000
*  DO;                                 /* BUILD THE VOLUME LIST      */ 00841000
*/********************************************************************/ 00842000
*/*                                                                  */ 00843000
*/* SEGMENT NAME - BVOLLIST                                          */ 00844000
*/*                                                                  */ 00845000
*/* DESCRIPTIVE NAME - BUILD THE VOLUME LIST                         */ 00846000
*/*                                                                  */ 00847000
*/* FUNCTION -                                                       */ 00848000
*/*   THE FUNCTION OF THIS SEGMENT IS TO GET CORE FOR THE            */ 00849000
*/*   VOLUME LIST, ANY VM&V REQUEST BLOCKS THAT MAY BE       @Z40LPPK*/ 00850000
*/*   NEEDED, THE LIST OF UCB'S WHOSE GROUPS NEED TO BE      @Z40LPPK*/ 00851000
*/*   LOCKED VIA THE ALLOCATION Q-MANAGER,                   @Z40LPPK*/ 00852000
*/*   AND BUILD THE VOLUME LIST. THE VOLUME LIST CONTAINS ALL        */ 00853000
*/*   UNIQUE VOLUME SERIALS THAT WERE IN THE VOLUME UNLOAD           */ 00854000
*/*   TABLE (VUT).                                                   */ 00855000
*/*                                                                  */ 00856000
*/*   OPERATION -                                                    */ 00857000
*/*                                                                  */ 00858000
*/*     1. ACCESS, CHAIN, AND COUNT -                                */ 00859000
*/*        EACH VUT BLOCK IS ACCESSED VIA THE SWA MANAGER AND        */ 00860000
*/*        CHAINED WITH IN-CORE ADDRESSES. A RUNNING TOTAL OF        */ 00861000
*/*        VUT ENTRIES IS KEPT.                                      */ 00862000
*/*                                                                  */ 00863000
*/*     2. GET CORE FOR VOLLIST, VM&V REQUEST BLOCKS AND     @Z40LPPK*/ 00864000
*/*        THE LIST OF UCB'S TO LOCK ON.                     @Z40LPPK*/ 00865000
*/*        THE AMOUNT OF CORE OBTAINED IS AS FOLLOWS:        @Z40LPPK*/ 00866000
*/*          (TOTAL VUT ENTRIES * (LENGTH(VLISTENT) +        @Z40LPPK*/ 00867000
*/*                                LENGTH(VMVRB)    +        @Z40LPPK*/ 00868000
*/*                                LENGTH(UCB LIST ENTRY)))  @Z40LPPK*/ 00869000
*/*                     +                                    @Z40LPPK*/ 00870000
*/*          NO.  OF FFSER ENTRIES IN FFSER BLK*             @Z40LPPK*/ 00871000
*/*             LENGTH(UCB LIST ENTRY)                       @Z40LPPK*/ 00872000
*/*          WHERE:                                                  */ 00873000
*/*            TOTAL-VUT-ENTRIES IS THE NUMBER OF SERIALS IN         */ 00874000
*/*              THE VUT                                             */ 00875000
*/*            LENGTH(VLISTENT) IS THE LENGTH OF A VOLUME LIST       */ 00876000
*/*              ENTRY                                               */ 00877000
*/*            LENGTH(VM&VRB) IS THE LENGTH OF A VM&V REQUEST        */ 00878000
*/*              BLOCK                                               */ 00879000
*/*            LENGTH(UCB LIST ENTRY) IS THE LENGTH OF AN    @Z40LPPK*/ 00880000
*/*              ENTRY IN THE LIST OF UCB'S TO LOCK ON.      @Z40LPPK*/ 00881000
*/*                                                                  */ 00882000
*/*     3. FILL IN THE VOLUME LIST -                                 */ 00883000
*/*        EACH VOLUME SERIAL IS RETRIEVED FROM THE VUT AND THE      */ 00884000
*/*        ENTRIES ALREADY IN THE VOLUME LIST ARE CHECKED TO SEE     */ 00885000
*/*        IF THE VOLUME SERIAL IS IN THE VOLLIST. IF IT IS, THE     */ 00886000
*/*        'VOLUME UNLOADED BY UNIT UNALLOCATION' INDICATOR  @ZD03010*/ 00887000
*/*        IN THE VOLLIST IS SET ACCORDING TO THE SETTING    @ZD03010*/ 00888000
*/*        OF THE CORRESPONDING INDICATOR IN THE MATCHING    @ZD03010*/ 00889000
*/*        VUT ENTRY.  IF THE VOLUME SERIAL ISN'T IN THE     @ZD03010*/ 00890000
*/*        VOLUME LIST ALREADY, AND THE VUT ENTRY DOESN'T    @ZD03010*/ 00891000
*/*        INDICATE THAT THE VOLUME WAS UNLOADED,            @ZD03010*/ 00892000
*/*        A NEW ENTRY FOR IT IS PUT IN                      @ZD03010*/ 00893000
*/*        THE VOLUME LIST, ALONG WITH A VIRTUAL INDICATOR   @Y30LPPG*/ 00894000
*/*        IF APPROPRIATE. A RUNNING TOTAL OF ENTRIES IN THE         */ 00895000
*/*        VOLUME LIST IS MAINTAINED.                                */ 00896000
*/*                                                                  */ 00897000
*/*      4. INITIALIZE THE NUMBER OF VOLUMES TO BE PLACED IN THE     */ 00898000
*/*            RELEASE MESSAGE -                                     */ 00899000
*/*           THIS COUNTER IS INTIALIZED TO THE TOTAL NUMBER OF      */ 00900000
*/*           VOLUMES IN THE LIST. IT WILL BE DECREMENTED EVERY TIME */ 00901000
*/*           A VOLUME IS FOUND MOUNTED.                             */ 00902000
*/*                                                                  */ 00903000
*/* ENTRY - IN-LINE SEGMENT                                          */ 00904000
*/*   PURPOSE - SEE FUNCTION                                         */ 00905000
*/*                                                                  */ 00906000
*/*   INPUT -                                                        */ 00907000
*/*     JCTVULDP - SVA OF THE VUT                                    */ 00908000
*/*                                                                  */ 00909000
*/*     VUNLDTAB - VOLUME UNLOAD TABLE                               */ 00910000
*/*       VUTNSVA - SVA OF NEXT VUT ENTRY                            */ 00911000
*/*       VUTENTNO - NUMBER OF ENTRIES IN BLOCK                      */ 00912000
*/*       VUTENVOL - VOLUME SERIAL                           @Y30LPPG*/ 00913000
*/*                                                                  */ 00914000
*/* EXIT -                                                           */ 00915000
*/* 1 CONDITION - CORE OBTAINED AND VOLLIST BUILT                    */ 00916000
*/*     OUTPUT -                                                     */ 00917000
*/*       VOLCOREP - ADDRESS OF GOTTEN CORE                          */ 00918000
*/*       TOTVOLS - NUMBER OF ENTRIES IN VOLUME LIST                 */ 00919000
*/*       RLSECTR - NUMBER OF VOLSERS TO BE RELEASED. SET TO TOTVOLS */ 00920000
*/*       VOLCOREL - LENGTH OF GOTTEN CORE                           */ 00921000
*/*       VLISTENT - VOLUME LIST ENTRIES                             */ 00922000
*/*         VOLSER - VOLUME SERIAL                                   */ 00923000
*/*     RETURN CODE -                                                */ 00924000
*/*       RETCODE = 0                                                */ 00925000
*/*                                                                  */ 00926000
*/* 2 CONDITION - CORE NOT AVAILABLE                                 */ 00927000
*/*     OUTPUT -                                                     */ 00928000
*/*       REASON CODE -                                              */ 00929000
*/*         RESNCODE = 1                                             */ 00930000
*/*     RETURN CODE -                                                */ 00931000
*/*       RETCODE = 4                                                */ 00932000
*/*                                                                  */ 00933000
*/********************************************************************/ 00934000
*FVUTPTR = ZERO;                       /* NO VUT READ IN YET         */ 00935000
         ST    @08,FVUTPTR                                      03S0212 00936000
*LVUTPTR = ZERO;                       /* NO LAST VUT YET            */ 00937000
         SLR   LVUTPTR,LVUTPTR                                  03S0213 00938000
*FIRSTSW = ON;                         /* SET FIRST VUT SWITCH       */ 00939000
         OI    FIRSTSW,B'01000000'                              03S0214 00940000
*SWACTLS = SWACTLS && SWACTLS;         /* CLEAR FUNC MAP FOR IEFAB4F7*/ 00941000
         SLR   @08,@08                                          03S0215 00942000
         ICM   @08,3,SWACTLS                                    03S0215 00943000
         LR    @03,@08                                          03S0215 00944000
         XR    @03,@08                                          03S0215 00945000
         STH   @03,SWACTLS                                      03S0215 00946000
*SWREAD = ON;                          /* READ A BLOCK               */ 00947000
*SWNEW = ON;                           /* CREATE A NEW EPA           */ 00948000
*SWFREE = ON;                          /* FREE THE EPA               */ 00949000
         OI    SWREAD,B'00101100'                               03S0218 00950000
*VUTSVA = JCTVULDP;                    /* FIRST VUT TABLE SVA        */ 00951000
         STCM  @15,7,VUTSVA                                     03S0219 00952000
*DO WHILE (VUTSVA ^= ZERO);            /* READ ALL VUT BLOCKS IN     */ 00953000
         B     @DE00220                                         03S0220 00954000
@DL00220 DS    0H                                               03S0221 00955000
*  CALL IEFAB4F7                       /* READ A VUT BLOCK           */ 00956000
*      (SWACTLS,ZERO,ZERO,ADDR(VUTSVA),ADDR(VUTPTR),ZERO,ONE);  03S0221 00957000
         MVC   @AL00001+4(24),@AL00221                          03S0221 00958000
         LA    @08,SWACTLS                                      03S0221 00959000
         ST    @08,@AL00001                                     03S0221 00960000
         LA    @08,VUTSVA                                       03S0221 00961000
         ST    @08,@TF00001                                     03S0221 00962000
         LA    @08,@TF00001                                     03S0221 00963000
         ST    @08,@AL00001+12                                  03S0221 00964000
         LA    @08,VUTPTR                                       03S0221 00965000
         ST    @08,@TF00002                                     03S0221 00966000
         LA    @08,@TF00002                                     03S0221 00967000
         ST    @08,@AL00001+16                                  03S0221 00968000
         L     @15,@CV00191                                     03S0221 00969000
         LA    @01,@AL00001                                     03S0221 00970000
         BALR  @14,@15                                          03S0221 00971000
*  IF FIRSTSW = ON THEN                /* FIRST VUT BEING READ       */ 00972000
         TM    FIRSTSW,B'01000000'                              03S0222 00973000
         BNO   @RF00222                                         03S0222 00974000
*    DO;                               /* BEGIN CHAIN                */ 00975000
*      FIRSTSW = OFF;                  /* RESET FIRST TIME SWITCH    */ 00976000
         NI    FIRSTSW,B'10111111'                              03S0224 00977000
*      FVUTPTR = VUTPTR;               /* ANCHOR CHAIN               */ 00978000
         MVC   FVUTPTR(4),VUTPTR                                03S0225 00979000
*    END;                              /* END BEGIN CHAIN            */ 00980000
*  ELSE                                /* NOT FIRST TIME             */ 00981000
*    LVUTPTR -> VUTNPTR = VUTPTR;      /* CHAIN VUT TO LAST          */ 00982000
         B     @RC00222                                         03S0227 00983000
@RF00222 MVC   VUTNPTR(4,LVUTPTR),VUTPTR                        03S0227 00984000
*  LVUTPTR = VUTPTR;                   /* SAVE THIS VUT FOR CHAINING */ 00985000
@RC00222 L     @08,VUTPTR                                       03S0228 00986000
         LR    LVUTPTR,@08                                      03S0228 00987000
*  TOTVOLS = TOTVOLS + VUTENTNO;       /* ADD VOLS IN ENTRY TO TOTAL */ 00988000
         SLR   @03,@03                                          03S0229 00989000
         IC    @03,VUTENTNO(,@08)                               03S0229 00990000
         ALR   TOTVOLS,@03                                      03S0229 00991000
*  VUTSVA = VUTNSVA;                   /* NEXT SVA TO READ           */ 00992000
         MVC   VUTSVA(3),VUTNSVA(@08)                           03S0230 00993000
*END;                                  /* END READ ALL VUTS          */ 00994000
@DE00220 SLR   @08,@08                                          03S0231 00995000
         SLR   @03,@03                                          03S0231 00996000
         ICM   @03,7,VUTSVA                                     03S0231 00997000
         CR    @08,@03                                          03S0231 00998000
         BNE   @DL00220                                         03S0231 00999000
*VUTNPTR = ZERO;                       /* TERMINATE CHAIN            */ 01000000
         L     @01,VUTPTR                                       03S0232 01001000
         ST    @08,VUTNPTR(,@01)                                03S0232 01002000
*IF TOTVOLS ^= ZERO THEN               /* VALID VUT ENTRIES EXIST    */ 01003000
         CR    TOTVOLS,@08                                      03S0233 01004000
         BE    @RF00233                                         03S0233 01005000
*  DO;                                 /* BUILD THE VOLLIST          */ 01006000
*    VOLCOREL =                        /* AMNT OF CORE TO GET@Z40LPPK*/ 01007000
*      (TOTVOLS * (LENGTH(VLISTENT) +  /* MAX SIZE VOL LIST  @Z40LPPK*/ 01008000
*                  LENGTH(VMVRQBLK) +  /* MAX VM&V RB CORE   @Z40LPPK*/ 01009000
*                  LENGTH(LOCKLIST))) +/* UCB'S TO LOCK ON   @Z40LPPK*/ 01010000
*      LENGTH(LOCKNUM)              +  /* LOCKLIST HDR LEN   @Z40LPPK*/ 01011000
*      DIM(FFSERUCB) * LENGTH(LOCKLIST); /* FF VOLUME SERIAL UCB'S      01012000
*                                           TO LOCK ON       @Z40LPPK*/ 01013000
         LR    @08,TOTVOLS                                      03S0235 01014000
         MH    @08,@CH01926                                     03S0235 01015000
         AH    @08,@CH01928                                     03S0235 01016000
         ST    @08,VOLCOREL                                     03S0235 01017000
*     /* ?GETSTORG (SPID,VOLCOREL,VOLCOREP);*/                  03S0236 01018000
*       RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/           03S0236 01019000
*       GTSTR0 = VOLCOREL; /* SET AMOUNT*/                      03S0237 01020000
         LR    GTSTR0,@08                                       03S0237 01021000
*       GTSTR2 = SPID; /* SET SUBPOOL*/                         03S0238 01022000
         LA    GTSTR2,230                                       03S0238 01023000
*       GENERATE CODE;                                          03S0239 01024000
         GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN                           01025000
*       GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/           03S0240 01026000
         ST    GTSTR15,GTSTRTCD                                 03S0240 01027000
*       VOLCOREP = GTSTR1; /* ADDR OF GOTN STORG*/              03S0241 01028000
         ST    GTSTR1,VOLCOREP                                  03S0241 01029000
*       RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */            03S0242 01030000
*       IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */           03S0243 01031000
         L     @08,GTSTRTCD                                     03S0243 01032000
         LTR   @08,@08                                          03S0243 01033000
         BNZ   @RF00243                                         03S0243 01034000
*         DO;               /* YES, CLEAR STORAGE.*/            03S0244 01035000
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   03S0245 01036000
*                              GTSTR7,GTSTR8) RSTD;             03S0245 01037000
*           GTSTR4 = VOLCOREP; /*STORG PTR*/                    03S0246 01038000
         L     @03,VOLCOREP                                     03S0246 01039000
         LR    GTSTR4,@03                                       03S0246 01040000
*           GTSTR5 = VOLCOREL; /*STORG AMNT*/                   03S0247 01041000
         L     GTSTR5,VOLCOREL                                  03S0247 01042000
*           GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/           03S0248 01043000
         SLR   GTSTR7,GTSTR7                                    03S0248 01044000
*           IF SPID = GTST253 THEN                              03S0249 01045000
         B     @RF00249                                         03S0249 01046000
*          GEN                                                  03S0250 01047000
*       (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);       03S0250 01048000
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8                 01049000
*           GEN REFS(GTSTR4,GTSTR6);                            03S0251 01050000
@RF00249 DS    0H                                               03S0251 01051000
              MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG                    01052000
*           IF SPID = GTST253 THEN                              03S0252 01053000
         B     @RF00252                                         03S0252 01054000
*             GEN (MODESET KEYADDR=(2));                        03S0253 01055000
         MODESET KEYADDR=(2)                                            01056000
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   03S0254 01057000
*                              GTSTR7,GTSTR8) UNRSTD;           03S0254 01058000
@RF00252 DS    0H                                               03S0255 01059000
*         END;       /* STORAGE CLEARING COMPLETED */           03S0255 01060000
*       ELSE                                                    03S0256 01061000
*       VOLCOREP= 0;   /* CLEAR RETURN ADDR. */                 03S0256 01062000
         B     @RC00243                                         03S0256 01063000
@RF00243 SLR   @08,@08                                          03S0256 01064000
         ST    @08,VOLCOREP                                     03S0256 01065000
*       GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */           03S0257 01066000
@RC00243 L     GTSTR15,GTSTRTCD                                 03S0257 01067000
*                                      /* RESTORE LIST PRINT STATUS  */ 01068000
** CORE FOR VLST + VMV RBS    */                                03S0258 01069000
*    IF REG15 = ZERO THEN              /* GETMAIN WAS OK             */ 01070000
         LTR   REG15,REG15                                      03S0258 01071000
         BNZ   @RF00258                                         03S0258 01072000
*      DO;                             /* BUILD THE VOLLIST          */ 01073000
*        VUTPTR = FVUTPTR;             /* PICK UP FIRST VUT ENTRY    */ 01074000
         MVC   VUTPTR(4),FVUTPTR                                03S0260 01075000
*        VOLCTR = ONE;                 /* USE FIRST VOLLIST ENTRY    */ 01076000
         LA    VOLCTR,1                                         03S0261 01077000
*        DO WHILE (VUTPTR ^= ZERO);    /* SCAN ALL VUT BLOCKS        */ 01078000
         B     @DE00262                                         03S0262 01079000
@DL00262 DS    0H                                               03S0263 01080000
*          DO VUTCTR = ONE TO VUTENTNO;/* SCAN EACH ENTRY IN BLOCK   */ 01081000
         LA    VUTCTR,1                                         03S0263 01082000
         B     @DE00263                                         03S0263 01083000
@DL00263 DS    0H                                               03S0264 01084000
*            DUPSW = OFF;              /* INIT DUPLICATE SWITCH      */ 01085000
         NI    DUPSW,B'01111111'                                03S0264 01086000
*            DO TVOLCTR = ONE TO VOLCTR - ONE;/* SCAN VLIST FOR DUPES*/ 01087000
         LA    TVOLCTR,1                                        03S0265 01088000
         B     @DE00265                                         03S0265 01089000
@DL00265 DS    0H                                               03S0266 01090000
*              IF VUTENVOL(VUTCTR) =   /* VOLSER IN VUT ENTRY@Y30LPPG*/ 01091000
*                  VOLSER(TVOLCTR) THEN/* VOLSER IS A DUPLICATE      */ 01092000
         L     @05,VUTPTR                                       03S0266 01093000
         LR    @15,VUTCTR                                       03S0266 01094000
         MH    @15,@CH00119                                     03S0266 01095000
         L     @14,VOLCOREP                                     03S0266 01096000
         LR    @09,TVOLCTR                                      03S0266 01097000
         SLA   @09,4                                            03S0266 01098000
         ST    @15,@TF00001                                     03S0266 01099000
         ALR   @15,@05                                          03S0266 01100000
         ST    @09,@TF00002                                     03S0266 01101000
         ALR   @09,@14                                          03S0266 01102000
         AL    @09,@CF01958                                     03S0266 01103000
         CLC   VUTENVOL-7(6,@15),VOLSER-2(@09)                  03S0266 01104000
         BNE   @RF00266                                         03S0266 01105000
*                DO;                   /* PROCESS DUPLICATE. @ZD03010*/ 01106000
*                  DUPSW = ON;         /* INDICATE DUP.      @ZD03010*/ 01107000
         OI    DUPSW,B'10000000'                                03S0268 01108000
*                  IF VUTUNLOD(VUTCTR)=ON THEN /*VOL UNLOADED BY UNIT   01109000
*                                                UNALLOC.    @ZD03010*/ 01110000
         AL    @05,@TF00001                                     03S0269 01111000
         TM    VUTUNLOD-7(@05),B'01000000'                      03S0269 01112000
         BNO   @RF00269                                         03S0269 01113000
*                    VOLUNLD(TVOLCTR) = ON;  /* VOL UNLOADED @ZD03010*/ 01114000
         AL    @14,@TF00002                                     03S0270 01115000
         AL    @14,@CF01959                                     03S0270 01116000
         OI    VOLUNLD(@14),B'01000000'                         03S0270 01117000
*                  ELSE                /* VOL NOT UNLOADED   @ZD03010*/ 01118000
*                    VOLUNLD(TVOLCTR) = OFF;  /* NOT UNLDD   @ZD03010*/ 01119000
         B     @RC00269                                         03S0271 01120000
@RF00269 LR    @05,TVOLCTR                                      03S0271 01121000
         SLA   @05,4                                            03S0271 01122000
         L     @01,VOLCOREP                                     03S0271 01123000
         ALR   @01,@05                                          03S0271 01124000
         AL    @01,@CF01959                                     03S0271 01125000
         NI    VOLUNLD(@01),B'10111111'                         03S0271 01126000
*                END;                  /* END DUP. PROCESS.  @ZD03010*/ 01127000
*              ELSE;                   /* VOL NOT DUPLICATE  @ZD03010*/ 01128000
@RF00266 DS    0H                                               03S0274 01129000
*            END;                      /* END SCAN VOLLIST FOR DUPES*/  01130000
@RC00266 AL    TVOLCTR,@CF00056                                 03S0274 01131000
@DE00265 LR    @05,VOLCTR                                       03S0274 01132000
         BCTR  @05,0                                            03S0274 01133000
         CR    TVOLCTR,@05                                      03S0274 01134000
         BNH   @DL00265                                         03S0274 01135000
*            IF DUPSW = OFF &          /* VUT ENTRY IS NOT A DUPE    */ 01136000
*               VUTUNLOD(VUTCTR) = OFF THEN /* NOT UNLOADED  @ZD03010*/ 01137000
         TM    DUPSW,B'10000000'                                03S0275 01138000
         BNZ   @RF00275                                         03S0275 01139000
         L     @15,VUTPTR                                       03S0275 01140000
         LR    @14,VUTCTR                                       03S0275 01141000
         MH    @14,@CH00119                                     03S0275 01142000
         ST    @14,@TF00001                                     03S0275 01143000
         ALR   @14,@15                                          03S0275 01144000
         TM    VUTUNLOD-7(@14),B'01000000'                      03S0275 01145000
         BNZ   @RF00275                                         03S0275 01146000
*              DO;                     /* PUT VOLSER IN VOLLIST      */ 01147000
*                VOLSER(VOLCTR) = VUTENVOL(VUTCTR);/* PUT SER IN LIST   01148000
*                                                            @Y30LPPG*/ 01149000
         L     @14,VOLCOREP                                     03S0277 01150000
         LR    @09,VOLCTR                                       03S0277 01151000
         SLA   @09,4                                            03S0277 01152000
         ST    @09,@TF00002                                     03S0277 01153000
         ALR   @09,@14                                          03S0277 01154000
         AL    @09,@CF01958                                     03S0277 01155000
         LR    @08,@15                                          03S0277 01156000
         AL    @08,@TF00001                                     03S0277 01157000
         MVC   VOLSER-2(6,@09),VUTENVOL-7(@08)                  03S0277 01158000
*                IF VUTENVIR(VUTCTR) = ON THEN /*IF A VIRTUAL VOL       01159000
*                                                            @Y30LPPG*/ 01160000
         AL    @15,@TF00001                                     03S0278 01161000
         TM    VUTENVIR-7(@15),B'10000000'                      03S0278 01162000
         BNO   @RF00278                                         03S0278 01163000
*                  VOLVIRSW(VOLCTR) = ON; /*SAY SO IN LIST   @Y30LPPG*/ 01164000
         AL    @14,@TF00002                                     03S0279 01165000
         AL    @14,@CF01959                                     03S0279 01166000
         OI    VOLVIRSW(@14),B'00010000'                        03S0279 01167000
*                VOLCTR = VOLCTR + ONE;/* NEXT SLOT FOR VOLSER       */ 01168000
@RF00278 AL    VOLCTR,@CF00056                                  03S0280 01169000
*              END;                    /* END PUT VOLSER IN VOLLIST  */ 01170000
*         END;                         /* END SCAN EACH ENTRY IN BLK */ 01171000
@RF00275 AL    VUTCTR,@CF00056                                  03S0282 01172000
@DE00263 L     @01,VUTPTR                                       03S0282 01173000
         SLR   @00,@00                                          03S0282 01174000
         IC    @00,VUTENTNO(,@01)                               03S0282 01175000
         CR    VUTCTR,@00                                       03S0282 01176000
         BNH   @DL00263                                         03S0282 01177000
*         VUTPTR = VUTNPTR;            /* NEXT VUT BLOCK             */ 01178000
         L     @02,VUTPTR                                       03S0283 01179000
         L     @02,VUTNPTR(,@02)                                03S0283 01180000
         ST    @02,VUTPTR                                       03S0283 01181000
*        END;                          /* END SCAN ALL VUT BLOCKS    */ 01182000
@DE00262 ICM   @02,15,VUTPTR                                    03S0284 01183000
         BNZ   @DL00262                                         03S0284 01184000
*        TOTVOLS = VOLCTR - ONE;       /* NUMBER OF VOLS IN VOLLIST  */ 01185000
         LR    TOTVOLS,VOLCTR                                   03S0285 01186000
         BCTR  TOTVOLS,0                                        03S0285 01187000
*        RLSECTR = TOTVOLS;            /* INIT NUMBER TO BE RELEASED    01188000
*                                         TO ALL IN LIST             */ 01189000
         ST    TOTVOLS,RLSECTR                                  03S0286 01190000
*      END;                            /* END BUILD THE VOLLIST      */ 01191000
*    ELSE                              /* UNSUCCESSFUL GETMAIN       */ 01192000
*      DO;                             /* SET RETURN & REASON CODES  */ 01193000
         B     @RC00258                                         03S0288 01194000
@RF00258 DS    0H                                               03S0289 01195000
*        RETCODE = ERROR;              /* BAD RETURN CODE            */ 01196000
         MVC   RETCODE(2),@CH00098                              03S0289 01197000
*        RESNCODE = GETERROR;          /* GETMAIN ERROR              */ 01198000
         L     @08,@PC00001+20                                  03S0290 01199000
         MVC   RESNCODE(2,@08),@CH00056                         03S0290 01200000
*      END;                            /* END SET RETN & RESN CODES  */ 01201000
*END;                                  /* END BUILD THE VOLLIST      */ 01202000
@RC00258 DS    0H                                               03S0293 01203000
*  END;                                /* END BUILD THE VOLUME LIST  */ 01204000
@RF00233 DS    0H                                               02S0294 01205000
*LOKINDEX = ONE;                       /* INIT UCB LIST INDEX@Z40LPPK*/ 01206000
@RF00210 LA    @08,1                                            02S0294 01207000
         LR    LOKINDEX,@08                                     02S0294 01208000
*/********************************************************************/ 01209000
*/*                                                                  */ 01210000
*/* SEGMENT NAME - SCANUCBS                                          */ 01211000
*/*                                                                  */ 01212000
*/* DESCRIPTIVE NAME - SCAN UCBS AND BUILD LIST OF UCB'S TO  @Z40LPPK*/ 01213000
*/*                    LOCK, PLUS A LIST OF UCB'S CONTAINING @Z40LPPK*/ 01214000
*/*                    FF VOLUME SERIALS                     @Z40LPPK*/ 01215000
*/*                                                                  */ 01216000
*/* FUNCTION -                                                       */ 01217000
*/*   THE FUNCTION OF THIS SEGMENT IS TO CHECK EACH UCB IN THE       */ 01218000
*/*   SYSTEM AND DETERMINE IF THE VOLUME SERIAL IS IN THE VOLUME     */ 01219000
*/*   LIST. IF THE VOLUME SERIAL IS IN THE VOLUME LIST, THE  @Z40LPPK*/ 01220000
*/*   UCB ADDRESS MAY BE PUT INTO A LIST OF UCB POINTERS.    @Z40LPPK*/ 01221000
*/*   THIS LIST WILL LATER BE USED TO SERIALIZE VIA THE      @Z40LPPK*/ 01222000
*/*   ALLOCATION Q-MANAGER ON GROUPS REPRESENTING ALL        @Z40LPPK*/ 01223000
*/*   UNITS IN THE LIST.                                     @Z40LPPK*/ 01224000
*/*   WHEN BUILDING THE LIST OF UCB'S TO LOCK, THE DEVICE    @ZA32215*/ 01225000
*/*   TYPE IS CHECKED TO DETERMINE IT'S CLASS. IF THE UCB    @ZA32215*/ 01226000
*/*   IS DA, DAUCB IS SET ON. IF THE UCB IS TAPE OR UNIT     @ZA32215*/ 01227000
*/*   RECORD, TPURUCB IS SET ON. DAUCB AND TPURUCB ARE       @ZA32215*/ 01228000
*/*   THEN USED BY SEGMENT, LOCKUCBS, TO INDICATE TO IEFAB4EC@ZA32215*/ 01229000
*/*   WHICH DDR RESOURCES TO SERIALIZE                       @ZA32215*/ 01230000
*/*   EACH UCB IS ALSO CHECKED TO DETERMINE IF IT CONTAINS           */ 01231000
*/*   A VOLUME SERIAL WITH HEX 'FF' IN THE FIRST BYTE AND THE ASID   */ 01232000
*/*   OF THIS MEMORY IN THE FIFTH AND SIXTH BYTES. IF THIS IS THE    */ 01233000
*/*   CASE, THE ADDRESS OF THE UCB IS ADDED TO THE FF SER LIST.      */ 01234000
*/*                                                                  */ 01235000
*/*   OPERATION -                                                    */ 01236000
*/*                                                                  */ 01237000
*/*     1. EACH UCB IS PICKED UP BY GOING DOWN THE IOS UCB           */ 01238000
*/*        LOOKUP TABLE. ONLY NON-ZERO ENTRIES FROM THE LOOKUP       */ 01239000
*/*        TABLE ARE USED.                                           */ 01240000
*/*                                                                  */ 01241000
*/*     2. IF A VOLUME LIST EXISTS THE FOLLOWING PROCESSING IS       */ 01242000
*/*        PERFORMED:                                                */ 01243000
*/*                                                                  */ 01244000
*/*           THE VOLUME LIST IS SCANNED TO DETERMINE IF THE         */ 01245000
*/*           VOLUME SERIAL IN THE UCB IS IN THE VOLLIST. IF IT IS,  */ 01246000
*/*           AND THE VOLUME IS TO BE UNLOADED OR            @Z40LPPK*/ 01247000
*/*           REWOUND OR THE UCB IS TO HAVE THE 'PASSED      @Z40LPPK*/ 01248000
*/*           DATA SET' INDICATOR CLEARED,                   @Z40LPPK*/ 01249000
*/*           THE UCB ADDRESS IS PLACED IN THE LIST TO       @Z40LPPK*/ 01250000
*/*           BE SERIALIZED ON AND IN THE VOLLIST ENTRY      @Z40LPPK*/ 01251000
*/*           ITSELF.  THE 'PROCESSED' SWITCH IS SET         @Z40LPPK*/ 01252000
*/*           IN THE VOLLIST ENTRY, BECAUSE OF THE POSSIBI-  @Z40LPPK*/ 01253000
*/*           LITY OF FINDING THE SAME UCB ADDRESS TWICE     @Z40LPPK*/ 01254000
*/*           IN THE IOS UCB LOOKUP TABLE.                   @Z40LPPK*/ 01255000
*/*                                                                  */ 01256000
*/*     3. IF THE UCB CONTAINS A 'FF' SERIAL NUMBER WITH THE ASID    */ 01257000
*/*        OF THIS MEMORY IT IS ADDED TO THE FF SER LIST. THE        */ 01258000
*/*        FF SER LIST IS AN ARRAY CONTAINING                @Z40LPPK*/ 01259000
*/*        SPACE FOR THIRTY UCB POINTERS.                    @Z40LPPK*/ 01260000
*/*        SPACE FOR 100 UCB POINTERS.                       @Z40LPPK*/ 01261000
*/*                                                                  */ 01262000
*/* ENTRY - IN-LINE SEGMENT                                          */ 01263000
*/*   PURPOSE - SEE FUNCTION                                         */ 01264000
*/*   INPUT -                                                        */ 01265000
*/*     VLISTENT - VOLUME LIST ENTRY                                 */ 01266000
*/*       VOLSER - VOLUME SERIAL                                     */ 01267000
*/*                                                                  */ 01268000
*/*     IOSLUT - IOS UCB LOOKUP TABLE                                */ 01269000
*/*                                                                  */ 01270000
*/*     ASID -                                                       */ 01271000
*/*       ASID OF THE MEMORY                                         */ 01272000
*/*                                                                  */ 01273000
*/*     TOTVOLS - NUMBER OF ENTRIES IN THE VOLUME LIST               */ 01274000
*/*                                                                  */ 01275000
*/* EXITS -                                                          */ 01276000
*/* 1 CONDITION - NORMAL COMPLETION                                  */ 01277000
*/*     OUTPUT -                                                     */ 01278000
*/*       VLISTENT - VOLUME LIST ENTRY                               */ 01279000
*/*          VOLUCBP - UCB ADDRESS                                   */ 01280000
*/*                                                                  */ 01281000
*/*       FFSERBLK - FF SERIAL LIST ENTRY                    @Z40LPPK*/ 01282000
*/*         FFSERUCB - UCB ADDRESS                                   */ 01283000
*/*                                                                  */ 01284000
*/*       LOKLISTP - POINTS TO UCB LIST IN GOTTEN CORE       @Z40LPPK*/ 01285000
*/*                                                          @Z40LPPK*/ 01286000
*/*       LOCKLIST - FILLED IN WITH UCB ADDRESSES OF UCB'S   @Z40LPPK*/ 01287000
*/*                  CONTAINING VOLUME SERIALS MATCHING      @Z40LPPK*/ 01288000
*/*                  THOSE IN THE VOLUME LIST.               @Z40LPPK*/ 01289000
*/*                                                          @Z40LPPK*/ 01290000
*/*       LOKINDEX - INDEX TO NEXT AVAILABLE SLOT IN         @Z40LPPK*/ 01291000
*/*                  LOCKLIST                                @Z40LPPK*/ 01292000
*/*                                                          @ZA32215*/ 01293000
*/*       DAUCB - ON, INDICATING THERE IS AT LEAST ONE DA UCB@ZA32215*/ 01294000
*/*               IN THE UCB'S TO BE LOCKED                  @ZA32215*/ 01295000
*/*                                                                  */ 01296000
*/*       TPURUCB - ON, INDICATING THERE IS AT LEAST ONE TAPE@ZA32215*/ 01297000
*/*                 OR UNIT RECORD UCB IN THE UCB'S TO BE    @ZA32215*/ 01298000
*/*                 LOCKED                                   @ZA32215*/ 01299000
*/*     RETURN CODE -                                                */ 01300000
*/*       RETCODE = 0                                                */ 01301000
*/*                                                                  */ 01302000
*/* 2 CONDITION - CORE NOT AVAILABLE FOR FF SER LIST                 */ 01303000
*/*     OUTPUT -                                                     */ 01304000
*/*       SAME AS ABOVE EXCEPT SOME FF SERIALS NOT PROCESSED         */ 01305000
*/*       REASON CODE -                                              */ 01306000
*/*         RESNCODE = 1                                             */ 01307000
*/*     RETURN CODE -                                                */ 01308000
*/*       RETCODE = 4                                                */ 01309000
*/*                                                                  */ 01310000
*/********************************************************************/ 01311000
*LOKVOLS = ZERO;                       /* INIT COUNT         @Z40LPPK*/ 01312000
         SLR   LOKVOLS,LOKVOLS                                  03S0295 01313000
*DAUCB = OFF;                          /*INITIALIZE          @ZA32215*/ 01314000
*TPURUCB = OFF;                        /*INITIALIZE          @ZA32215*/ 01315000
*TPURUCB = OFF;                        /*INITIALIZE          @ZA32215*/ 01316000
         NI    DAUCB,B'11111001'                                03S0298 01317000
*VMVREQBP = VOLCOREP +                 /* PTR FOR 1ST VM&V RB@Z40LPPK*/ 01318000
*           TOTVOLS * LENGTH(VLISTENT); /* JUST PAST VOLLIST @Z40LPPK*/ 01319000
         LR    VMVREQBP,TOTVOLS                                 03S0299 01320000
         SLA   VMVREQBP,4                                       03S0299 01321000
         AL    VMVREQBP,VOLCOREP                                03S0299 01322000
*LOKLISTP = VMVREQBP +                 /* ADDR OF LIST OF UCB'S TO      01323000
*                                         LOCK ON.           @Z40LPPK*/ 01324000
*           TOTVOLS * LENGTH(VMVRQBLK); /* JUST PAST VM&VRB'S@Z40LPPK*/ 01325000
         LR    @05,TOTVOLS                                      03S0300 01326000
         MH    @05,@CH01924                                     03S0300 01327000
         ALR   @05,VMVREQBP                                     03S0300 01328000
         ST    @05,LOKLISTP                                     03S0300 01329000
*DO LUTCTR = ONE BY ONE                /* PROCESS EACH ENTRY IN LUT  */ 01330000
*    WHILE (IOSLUT(LUTCTR) ^= LUTEND); /* STOP AT END OF TABLE       */ 01331000
         LR    LUTCTR,@08                                       03S0301 01332000
         B     @DE00301                                         03S0301 01333000
@DL00301 DS    0H                                               03S0302 01334000
*  UCBPTR = IOSLUT(LUTCTR);            /* PICK UP UCB ADDRESS        */ 01335000
         LR    @08,LUTCTR                                       03S0302 01336000
         ALR   @08,@08                                          03S0302 01337000
         L     @15,@PC00001+24                                  03S0302 01338000
         L     @01,IOSLUTP(,@15)                                03S0302 01339000
         ALR   @01,@08                                          03S0302 01340000
         BCTR  @01,0                                            03S0302 01341000
         BCTR  @01,0                                            03S0302 01342000
         SLR   UCBPTR,UCBPTR                                    03S0302 01343000
         ICM   UCBPTR,3,IOSLUT(@01)                             03S0302 01344000
*  IF UCBPTR ^= ZERO &                 /* LUT ENTRY IS VALID         */ 01345000
*      (UCB3TAPE = ON | UCB3DACC = ON) THEN /* TAPE OR DA            */ 01346000
         SLR   @08,@08                                          03S0303 01347000
         CR    UCBPTR,@08                                       03S0303 01348000
         BE    @RF00303                                         03S0303 01349000
         TM    UCB3TAPE(UCBPTR),B'10100000'                     03S0303 01350000
         BZ    @RF00303                                         03S0303 01351000
*    DO;                               /* PROCESS THE UCB            */ 01352000
*      FOUNDSW = OFF;                  /* INIT FOUND SWITCH          */ 01353000
         NI    FOUNDSW,B'11011111'                              03S0305 01354000
*      IF VOLCOREP ^= ZERO THEN        /* VOLLIST WAS BUILT          */ 01355000
         C     @08,VOLCOREP                                     03S0306 01356000
         BE    @RF00306                                         03S0306 01357000
*        DO VOLCTR = ONE TO TOTVOLS    /* SCAN VOLLIST FOR UCBVOLI   */ 01358000
*            WHILE (FOUNDSW = OFF);    /* STOP SCAN IF FOUND         */ 01359000
         LA    VOLCTR,1                                         03S0307 01360000
         B     @DE00307                                         03S0307 01361000
@DL00307 TM    FOUNDSW,B'00100000'                              03S0307 01362000
         BNZ   @DC00307                                         03S0307 01363000
*          IF VOLSER(VOLCTR) = UCBVOLI & /* VOLSERS MATCH @Z40LPPK*/    01364000
*             VOLFNDSW(VOLCTR)=OFF THEN /*VOLUME NOT ALREADY    03S0308 01365000
*                                         PROCESSED          @Z40LPPK*/ 01366000
         L     @08,VOLCOREP                                     03S0308 01367000
         LR    @15,VOLCTR                                       03S0308 01368000
         SLA   @15,4                                            03S0308 01369000
         ST    @15,@TF00001                                     03S0308 01370000
         ALR   @15,@08                                          03S0308 01371000
         AL    @15,@CF01958                                     03S0308 01372000
         CLC   VOLSER-2(6,@15),UCBVOLI(UCBPTR)                  03S0308 01373000
         BNE   @RF00308                                         03S0308 01374000
         LR    @01,@08                                          03S0308 01375000
         AL    @01,@TF00001                                     03S0308 01376000
         AL    @01,@CF01959                                     03S0308 01377000
         TM    VOLFNDSW(@01),B'00100000'                        03S0308 01378000
         BNZ   @RF00308                                         03S0308 01379000
*            DO;                                                03S0309 01380000
*              VOLFNDSW(VOLCTR)=ON;    /*INDICATE VOL FOUND  @Z40LPPK*/ 01381000
         AL    @08,@TF00001                                     03S0310 01382000
         AL    @08,@CF01959                                     03S0310 01383000
         OI    VOLFNDSW(@08),B'00100000'                        03S0310 01384000
*              FOUNDSW = ON;           /* SET FOUND SWITCH           */ 01385000
         OI    FOUNDSW,B'00100000'                              03S0311 01386000
*              IF ((UCBPRES = OFF & UCBRESV = OFF & /* NOT PERM RES/RES 01387000
*D  */             (UCBBPRV = ON  |           /* PRIVATE OR        @Z40 01388000
*PPE*/              (UCBTYP(3:4)=DEV3330 &   /*3330                @Z40 01389000
*PPE*/               UCBRVDEV=ON &           /*VIRTUAL DEVICE WITH @Z40 01390000
*PPE*/               UCBBPUB=ON)) &          /*PUBLIC VOLUME       @Z40 01391000
*PPE*/             (UCBJES3 = OFF |          /*NOT JES3 MANAGED    @ZA0 01392000
*651*/              UCB3TAPE = ON |          /*OR TAPE             @ZA0 01393000
*651*/              (UCBTYP(3:4) =           /*OR 3330V            @ZA0 01394000
*651*/                DEV3330     &          /*                    @ZA0 01395000
*651*/               UCBRVDEV = ON)) &       /*                    @ZA0 01396000
*651*/             UCBALOC = OFF &           /* NOT ALLOCATED   03S0312 01397000
*   */             UCBNALOC = OFF) |/*                          03S0312 01398000
*                                         VOL IS UNLOADABLE  @Z40LPPK*/ 01399000
*                  (UCB3TAPE = ON &          /*VOL IS TAPE      03S0312 01400000
*   */              UCBRESV = OFF &          /*NOT RESERVED     03S0312 01401000
*   */              UCBNALOC = OFF &         /*NOT NON-USABLE   03S0312 01402000
*   */              UCBALOC = OFF &          /*UNALLOCATED      03S0312 01403000
*   */              UCBBPUB = ON) |/*                           03S0312 01404000
*                                         VOL IS REWINDABLE  @Z40LPPK*/ 01405000
*                  UCBMONT = ON)       /* PASS/RETAIN INDICATOR ON      01406000
*                                         IN UCB             @Z40FPPK*/ 01407000
*                & VOLUNLD(VOLCTR)=OFF THEN/*VOL NOT UNLOADED@ZD03010*/ 01408000
         TM    UCBPRES(UCBPTR),B'00100100'                      03S0312 01409000
         BNZ   @GL00009                                         03S0312 01410000
         TM    UCBBPRV(UCBPTR),B'00010000'                      03S0312 01411000
         BO    @GL00012                                         03S0312 01412000
         CLC   UCBTYP+2(2,UCBPTR),DEV3330                       03S0312 01413000
         BNE   @GL00009                                         03S0312 01414000
         TM    UCBRVDEV(UCBPTR),B'00001000'                     03S0312 01415000
         BNO   @GL00009                                         03S0312 01416000
         TM    UCBBPUB(UCBPTR),B'00001000'                      03S0312 01417000
         BNO   @GL00009                                         03S0312 01418000
@GL00012 TM    UCBJES3(UCBPTR),B'01000000'                      03S0312 01419000
         BZ    @GL00011                                         03S0312 01420000
         TM    UCB3TAPE(UCBPTR),B'10000000'                     03S0312 01421000
         BO    @GL00011                                         03S0312 01422000
         CLC   UCBTYP+2(2,UCBPTR),DEV3330                       03S0312 01423000
         BNE   @GL00009                                         03S0312 01424000
         TM    UCBRVDEV(UCBPTR),B'00001000'                     03S0312 01425000
         BNO   @GL00009                                         03S0312 01426000
@GL00011 TM    UCBALOC(UCBPTR),B'00001000'                      03S0312 01427000
         BNZ   @GL00009                                         03S0312 01428000
         TM    UCBNALOC(UCBPTR),B'00000100'                     03S0312 01429000
         BZ    @GL00007                                         03S0312 01430000
@GL00009 TM    UCB3TAPE(UCBPTR),B'10000000'                     03S0312 01431000
         BNO   @GL00008                                         03S0312 01432000
         TM    UCBRESV(UCBPTR),B'00100000'                      03S0312 01433000
         BNZ   @GL00008                                         03S0312 01434000
         TM    UCBNALOC(UCBPTR),B'00000100'                     03S0312 01435000
         BNZ   @GL00008                                         03S0312 01436000
         TM    UCBALOC(UCBPTR),B'00001000'                      03S0312 01437000
         BNZ   @GL00008                                         03S0312 01438000
         TM    UCBBPUB(UCBPTR),B'00001000'                      03S0312 01439000
         BO    @GL00007                                         03S0312 01440000
@GL00008 TM    UCBMONT(UCBPTR),B'00000001'                      03S0312 01441000
         BNO   @RF00312                                         03S0312 01442000
@GL00007 L     @08,VOLCOREP                                     03S0312 01443000
         LR    @15,VOLCTR                                       03S0312 01444000
         SLA   @15,4                                            03S0312 01445000
         ST    @15,@TF00001                                     03S0312 01446000
         ALR   @15,@08                                          03S0312 01447000
         AL    @15,@CF01959                                     03S0312 01448000
         TM    VOLUNLD(@15),B'01000000'                         03S0312 01449000
         BNZ   @RF00312                                         03S0312 01450000
*                DO;                   /* CHECK FOR UNLOADABLE VOL   */ 01451000
*                  VOLUCBP(VOLCTR) = UCBPTR; /* GET UCB ADDR IN VLLST   01452000
*                                               ENT                  */ 01453000
         L     @01,@TF00001                                     03S0314 01454000
         AL    @01,@CF01946                                     03S0314 01455000
         ST    UCBPTR,VOLUCBP-12(@01,@08)                       03S0314 01456000
*                  LOCKLIST(LOKINDEX) = UCBPTR; /* UCB TO LOCK ON       01457000
*                                                            @Z40LPPK*/ 01458000
         LR    @15,LOKINDEX                                     03S0315 01459000
         SLA   @15,2                                            03S0315 01460000
         L     @01,LOKLISTP                                     03S0315 01461000
         ST    UCBPTR,LOCKLIST-4(@15,@01)                       03S0315 01462000
*                  VOLINDX(VOLCTR) = LOKINDEX; /* SAVE LOCK LIST INDEX  01463000
*                                                            @Z40LPPK*/ 01464000
         L     @01,@TF00001                                     03S0316 01465000
         AL    @08,@CF01961                                     03S0316 01466000
         ST    LOKINDEX,VOLINDX-8(@01,@08)                      03S0316 01467000
*                  LOKVOLS = LOKVOLS + ONE; /* BUMP COUNT.   @Z40LPPK*/ 01468000
         LA    @08,1                                            03S0317 01469000
         ALR   LOKVOLS,@08                                      03S0317 01470000
*                  LOKINDEX = LOKINDEX + 1;/* BUMP LIST COUNT@Z40LPPK*/ 01471000
         ALR   LOKINDEX,@08                                     03S0318 01472000
*                  IF UCB3DACC = ON THEN /*DIRECT ACCESS?    @ZA32215*/ 01473000
         TM    UCB3DACC(UCBPTR),B'00100000'                     03S0319 01474000
         BNO   @RF00319                                         03S0319 01475000
*                    DAUCB = ON;       /*INDICATE DA UCB     @ZA32215*/ 01476000
         OI    DAUCB,B'00000100'                                03S0320 01477000
*                  IF UCB3UREC = ON THEN /* UNIT RECORD ?    @ZA32215*/ 01478000
@RF00319 TM    UCB3UREC(UCBPTR),B'00001000'                     03S0321 01479000
         BNO   @RF00321                                         03S0321 01480000
*                    TPURUCB = ON;     /*INDICATE TAPE|UR UCB@ZA32215*/ 01481000
         OI    TPURUCB,B'00000010'                              03S0322 01482000
*                  IF UCB3TAPE = ON THEN /* TAPE             @ZA32215*/ 01483000
@RF00321 TM    UCB3TAPE(UCBPTR),B'10000000'                     03S0323 01484000
         BNO   @RF00323                                         03S0323 01485000
*                    TPURUCB = ON;     /*INDICATE TAPE|UR UCB@ZA32215*/ 01486000
         OI    TPURUCB,B'00000010'                              03S0324 01487000
*                END;                  /* END CHECK UNLDABLE VOLUME  */ 01488000
*              ELSE                                             03S0326 01489000
*                DO;                   /*                    @Z40LPPK*/ 01490000
         B     @RC00312                                         03S0326 01491000
@RF00312 DS    0H                                               03S0327 01492000
*                  VOLIGNOR(VOLCTR)=ON;/*SET IGNORE INDICATOR@Z40LPPK*/ 01493000
         LR    @08,VOLCTR                                       03S0327 01494000
         SLA   @08,4                                            03S0327 01495000
         L     @01,VOLCOREP                                     03S0327 01496000
         ALR   @01,@08                                          03S0327 01497000
         AL    @01,@CF01959                                     03S0327 01498000
         OI    VOLIGNOR(@01),B'10000000'                        03S0327 01499000
*                  RLSECTR=RLSECTR-ONE; /*DECREMENT NO. VOLS IN 03S0328 01500000
*                                         RELEASE MESSAGE    @Z40LPPK*/ 01501000
         L     @08,RLSECTR                                      03S0328 01502000
         BCTR  @08,0                                            03S0328 01503000
         ST    @08,RLSECTR                                      03S0328 01504000
*                END;                  /*                    @Z40LPPK*/ 01505000
*            END;                                               03S0330 01506000
@RC00312 DS    0H                                               03S0331 01507000
*        END;                          /* END SCAN VOLLIST           */ 01508000
@RF00308 AL    VOLCTR,@CF00056                                  03S0331 01509000
@DE00307 CR    VOLCTR,TOTVOLS                                   03S0331 01510000
         BNH   @DL00307                                         03S0331 01511000
@DC00307 DS    0H                                               03S0332 01512000
*      IF UCBVOLI(1) = NSTAPE &        /* NON-SPEC UNOPENED TAPE     */ 01513000
*          UCBVOLI(5:6) = ASID THEN    /* ASID IN VOLSER MATCHES OURS*/ 01514000
@RF00306 CLI   UCBVOLI(UCBPTR),X'FF'                            03S0332 01515000
         BNE   @RF00332                                         03S0332 01516000
         CLC   UCBVOLI+4(2,UCBPTR),ASID                         03S0332 01517000
         BNE   @RF00332                                         03S0332 01518000
*        DO;                           /* ADD UCB TO FF SER LIST     */ 01519000
*          FFSERCTR = FFSERCTR + ONE;  /* INCREMENT FFSER COUNT      */ 01520000
         LA    @08,1                                            03S0334 01521000
         AL    @08,FFSERCTR                                     03S0334 01522000
         ST    @08,FFSERCTR                                     03S0334 01523000
*          IF FFSERCTR > DIM(FFSERUCB) THEN /* BLOCK FULL?  @Z40LPPK*/  01524000
         CH    @08,@CH00088                                     03S0335 01525000
         BNH   @RF00335                                         03S0335 01526000
*            FFSERCTR = FFSERCTR - ONE; /* SET INDEX TO REUSE LAST      01527000
*                                          ENTRY.            @Z40LPPK*/ 01528000
         BCTR  @08,0                                            03S0336 01529000
         ST    @08,FFSERCTR                                     03S0336 01530000
*          FFSERUCB(FFSERCTR) = UCBPTR; /* SAVE UCB ADDRESS          */ 01531000
@RF00335 L     @08,FFSERCTR                                     03S0337 01532000
         SLA   @08,2                                            03S0337 01533000
         ST    UCBPTR,FFSERUCB-4(@08)                           03S0337 01534000
*        END;                          /* END ADD UCB TO LIST        */ 01535000
*    END;                              /* END PROCESS UCB            */ 01536000
@RF00332 DS    0H                                               03S0340 01537000
*END;                                  /* END PROCESS EACH LUT ENTRY */ 01538000
@RF00303 AL    LUTCTR,@CF00056                                  03S0340 01539000
@DE00301 LR    @08,LUTCTR                                       03S0340 01540000
         ALR   @08,@08                                          03S0340 01541000
         L     @15,@PC00001+24                                  03S0340 01542000
         L     @01,IOSLUTP(,@15)                                03S0340 01543000
         ALR   @01,@08                                          03S0340 01544000
         BCTR  @01,0                                            03S0340 01545000
         BCTR  @01,0                                            03S0340 01546000
         CLC   IOSLUT(2,@01),@CH00166                           03S0340 01547000
         BNE   @DL00301                                         03S0340 01548000
*LOCKOKSW = OFF;                       /* ASSUME FAILURE.    @Z40LPPK*/ 01549000
         NI    LOCKOKSW,B'11101111'                             02S0341 01550000
*IF FFSERCTR ^= ZERO |                 /* FFSER UCB'S TO LOCK@Z40LPPK*/ 01551000
*   LOKINDEX > ONE THEN                /* REW/UNLD UCB'S TO LOCK        01552000
*                                                            @Z40LPPK*/ 01553000
         ICM   @08,15,FFSERCTR                                  02S0342 01554000
         BNZ   @RT00342                                         02S0342 01555000
         CH    LOKINDEX,@CH00056                                02S0342 01556000
         BNH   @RF00342                                         02S0342 01557000
@RT00342 DS    0H                                               02S0343 01558000
*  DO;                                 /* LOCK NEEDED GROUPS @Z40LPPK*/ 01559000
*/***********************************************************@Z40LPPK*/ 01560000
*/*                                                          @Z40LPPK*/ 01561000
*/* SEGMENT NAME - LOCKUCBS                                  @Z40LPPK*/ 01562000
*/*                                                          @Z40LPPK*/ 01563000
*/* DESCRIPTIVE NAME - LOCK UCB'S FOR VOLUME UNLOADING AND   @Z40LPPK*/ 01564000
*/*                    UCB CLEANUP                           @Z40LPPK*/ 01565000
*/*                                                          @Z40LPPK*/ 01566000
*/* FUNCTION -                                               @Z40LPPK*/ 01567000
*/*   THIS SEGMENT SERIALIZES ON THE DEVICE GROUPS NECESSARY @Z40LPPK*/ 01568000
*/*   TO PROTECT VOLUME UNLOADING AND UCB CLEANUP PROCESSING.@Z40LPPK*/ 01569000
*/*   OPERATION -                                            @Z40LPPK*/ 01570000
*/*     1. IF CORE WERE OBTAINED FOR A VOLUME LIST, ETC.,    @Z40LPPK*/ 01571000
*/*        THE LIST OF UCB'S TO BE SERIALIZED IS ASSEMBLED   @Z40LPPK*/ 01572000
*/*        IN THE SAME BLOCK OF CORE OBTAINED FOR THE        @Z40LPPK*/ 01573000
*/*        VOLUME LIST, ETC.  THIS UCB LIST FOLLOWS THE      @Z40LPPK*/ 01574000
*/*        VM&V RB'S IN THAT BLOCK OF CORE.  UCB POINTERS    @Z40LPPK*/ 01575000
*/*        REPRESENTING VOLUME LIST ENTRIES HAVE ALREADY     @Z40LPPK*/ 01576000
*/*        BEEN PLACED IN THE LIST.  UCB POINTERS REPRE-     @Z40LPPK*/ 01577000
*/*        SENTING FF VOLSER LIST ENTRIES ARE MOVED INTO     @Z40LPPK*/ 01578000
*/*        THE LIST.                                         @Z40LPPK*/ 01579000
*/*                                                          @Z40LPPK*/ 01580000
*/*        IF CORE WERE NOT OBTAINED FOR THE VOLUME LIST, OR @Z40LPPK*/ 01581000
*/*        NO UCB PTRS FOR VOLLIST ENTRIES WERE MADE IN THE  @Z40LPPK*/ 01582000
*/*        UCB LIST, THE FF VOLSER UCB BLOCK IS USED AS      @Z40LPPK*/ 01583000
*/*        INPUT TO THE LOCKING MODULE.                      @Z40LPPK*/ 01584000
*/*                                                          @Z40LPPK*/ 01585000
*/*     2. IF THE LIST OF UCB'S NEEDING SERIALIZATION IS     @Z40LPPK*/ 01586000
*/*        NOT EMPTY, THE GROUP LOCKING SERVICE ROUTINE      @Z40LPPK*/ 01587000
*/*        IS CALLED.                                        @Z40LPPK*/ 01588000
*/*                                                          @Z40LPPK*/ 01589000
*/*     3. IF THE GROUP LOCKING ROUTINE IS SUCCESSFUL,       @Z40LPPK*/ 01590000
*/*        AN INDICATOR IS SET, SAYING GROUPS WERE LOCKED.   @Z40LPPK*/ 01591000
*/*                                                          @Z40LPPK*/ 01592000
*/* ENTRY - IN-LINE SEGMENT                                  @Z40LPPK*/ 01593000
*/*                                                          @Z40LPPK*/ 01594000
*/*   PURPOSE - SEE FUNCTION                                 @Z40LPPK*/ 01595000
*/*                                                          @Z40LPPK*/ 01596000
*/*   INPUT -                                                @Z40LPPK*/ 01597000
*/*     LOCKLIST - LIST OF UCB PTRS FOR UNLOADING/REWINDING  @Z40LPPK*/ 01598000
*/*                                                          @Z40LPPK*/ 01599000
*/*     LOKLISTP - PTR TO LOCKLIST                           @Z40LPPK*/ 01600000
*/*                                                          @Z40LPPK*/ 01601000
*/*     FFSERBLK - BLK OF FFSER UCB PTRS                     @Z40LPPK*/ 01602000
*/*       FFSERCTR - NO. OF UCB PTRS IN BLOCK                @Z40LPPK*/ 01603000
*/*       FFSERUCB - UCB PTR                                 @Z40LPPK*/ 01604000
*/*                                                          @Z40LPPK*/ 01605000
*/*     LOKINDEX - INDEX TO NEXT AVAILABLE SLOT IN LOCKLIST  @Z40LPPK*/ 01606000
*/*                ALSO, COUNT - PLUS ONE, OF ENTRIES IN     @Z40LPPK*/ 01607000
*/*                LOCKLIST                                  @Z40LPPK*/ 01608000
*/*                                                          @Z40LPPK*/ 01609000
*/*     LOCKOKSW - OFF, INDICATING NO LOCKING DONE YET       @Z40LPPK*/ 01610000
*/*                                                          @Z40LPPK*/ 01611000
*/* EXIT -                                                   @Z40LPPK*/ 01612000
*/*                                                          @Z40LPPK*/ 01613000
*/*   1 CONDITION - NORMAL                                   @Z40LPPK*/ 01614000
*/*       OUTPUT -                                           @Z40LPPK*/ 01615000
*/*                                                          @ZA32215*/ 01616000
*/*     DAUCB - ON, INDICATING THERE IS AT LEAST ONE DA UCB  @ZA32215*/ 01617000
*/*             IN THE UCB'S TO BE LOCKED AND SO IEFAB4EC    @ZA32215*/ 01618000
*/*             MUST BE TOLD TO SERIALIZE THE DDR DA         @ZA32215*/ 01619000
*/*             RESOURCE.                                    @ZA32215*/ 01620000
*/*                                                             03S0344 01621000
*/*     TPURUCB - ON, INDICATING THERE IS AT LEAST ONE TAPE  @ZA32215*/ 01622000
*/*               OR UNIT RECORD UCB IN THE UCB'S TO BE      @ZA32215*/ 01623000
*/*               LOCKED AND SO IEFAB4EC MUST BE TOLD TO     @ZA32215*/ 01624000
*/*              SERIALIZE THE DDR TAPE|UNIT RECORD RESOURCE @ZA32215*/ 01625000
*/*         LOCKLIST -                                       @Z40LPPK*/ 01626000
*/*           0 SLOT INDICATES UCB GROUP NOT LOCKED.         @Z40LPPK*/ 01627000
*/*           NON-0 SLOT (IE.,CONTAINING UCB PTR)  INDICATES @Z40LPPK*/ 01628000
*/*             THAT THE UCB'S GROUP WAS LOCKED.             @Z40LPPK*/ 01629000
*/*                                                          @Z40LPPK*/ 01630000
*/*         LOCKOKSW - ON                                    @Z40LPPK*/ 01631000
*/*                                                          @Z40LPPK*/ 01632000
*/*   2 CONDITION - ESTAE ERROR IN GROUP LOCKING ROUTINE     @Z40LPPK*/ 01633000
*/*       OUTPUT                                             @Z40LPPK*/ 01634000
*/*         REASON CODE -                                    @Z40LPPK*/ 01635000
*/*           RESNCODE = 4                                   @Z40LPPK*/ 01636000
*/*       RETURN CODE -                                      @Z40LPPK*/ 01637000
*/*         RETCODE = 4                                      @Z40LPPK*/ 01638000
*/*                                                          @Z40LPPK*/ 01639000
*/*   3 CONDITION - NON-ESTAE ERROR IN GROUP LOCKING RTN     @Z40LPPK*/ 01640000
*/*       OUTPUT -                                           @Z40LPPK*/ 01641000
*/*         FUNCTION NOT PERFORMED                           @Z40LPPK*/ 01642000
*/*                                                          @Z40LPPK*/ 01643000
*/*       RETURN CODE - NONE                                 @Z40LPPK*/ 01644000
*/*                                                          @Z40LPPK*/ 01645000
*/***********************************************************@Z40LPPK*/ 01646000
*IF LOKINDEX > ONE THEN                /* ANY ENTRIES YET?   @Z40LPPK*/ 01647000
         LA    @08,1                                            03S0344 01648000
         CR    LOKINDEX,@08                                     03S0344 01649000
         BNH   @RF00344                                         03S0344 01650000
*  DO;                                 /* ADD FFSER UCB'S    @Z40LPPK*/ 01651000
*    IF FFSERCTR > ZERO THEN           /* ANY FFSER UCB'S    @Z40LPPK*/ 01652000
         ICM   @05,15,FFSERCTR                                  03S0346 01653000
         BNP   @RF00346                                         03S0346 01654000
*      DO SERCTR = ONE TO FFSERCTR;    /* PUT FFSER UCB'S INTO LIST     01655000
*                                         BEHIND VOLLIST UCBS@Z40LPPK*/ 01656000
         LR    SERCTR,@08                                       03S0347 01657000
         B     @DE00347                                         03S0347 01658000
@DL00347 DS    0H                                               03S0348 01659000
*        LOCKLIST(LOKINDEX) = FFSERUCB(SERCTR); /* IN IT GOES@Z40LPPK*/ 01660000
         LR    @08,LOKINDEX                                     03S0348 01661000
         SLA   @08,2                                            03S0348 01662000
         LR    @15,SERCTR                                       03S0348 01663000
         SLA   @15,2                                            03S0348 01664000
         L     @15,FFSERUCB-4(@15)                              03S0348 01665000
         L     @14,LOKLISTP                                     03S0348 01666000
         ST    @15,LOCKLIST-4(@08,@14)                          03S0348 01667000
*        LOKINDEX = LOKINDEX + ONE;    /* INDEX TO NEXT SLOT @Z40LPPK*/ 01668000
         AL    LOKINDEX,@CF00056                                03S0349 01669000
*      END;                            /* DONE FILLING LIST  @Z40LPPK*/ 01670000
         AL    SERCTR,@CF00056                                  03S0350 01671000
@DE00347 C     SERCTR,FFSERCTR                                  03S0350 01672000
         BNH   @DL00347                                         03S0350 01673000
*    LOCKNUM = LOKINDEX - ONE;         /* # ENTRIES IN LIST  @Z40LPPK*/ 01674000
@RF00346 LR    @08,LOKINDEX                                     03S0351 01675000
         BCTR  @08,0                                            03S0351 01676000
         L     @05,LOKLISTP                                     03S0351 01677000
         ST    @08,LOCKNUM(,@05)                                03S0351 01678000
*  END;                                /* END FFSER UCB'S    @Z40LPPK*/ 01679000
*ELSE                                  /* NO ENTRIES YET     @Z40LPPK*/ 01680000
*  LOKLISTP = ADDR(FFSERBLK);          /* USE FFSER BLOCK    @Z40LPPK*/ 01681000
         B     @RC00344                                         03S0353 01682000
@RF00344 LA    @08,FFSERBLK                                     03S0353 01683000
         ST    @08,LOKLISTP                                     03S0353 01684000
*IF LOCKNUM > ZERO THEN                /* ANYTHING TO LOCK   @Z40LPPK*/ 01685000
@RC00344 SLR   @08,@08                                          03S0354 01686000
         L     @01,LOKLISTP                                     03S0354 01687000
         C     @08,LOCKNUM(,@01)                                03S0354 01688000
         BNL   @RF00354                                         03S0354 01689000
*  DO;                                 /* LOCK GROUPS        @Z40LPPK*/ 01690000
*    LOCKFMAP = LOCKFMAP && LOCKFMAP;  /* CLEAR FUNC MAP     @Z40LPPK*/ 01691000
         XC    LOCKFMAP(1),LOCKFMAP                             03S0356 01692000
*    LOCKGET = ON;                     /* GET LOCKS          @Z40LPPK*/ 01693000
         OI    LOCKGET,B'10000000'                              03S0357 01694000
*    LOKWORKP = ZERO;                  /* CLEAR FOR LOCKER   @Z40LPPK*/ 01695000
         ST    @08,LOKWORKP                                     03S0358 01696000
*    GROUPMSK = GROUPMSK && GROUPMSK;  /* CLEAR MASK AREA    @Z40LPPK*/ 01697000
         XC    GROUPMSK(240),GROUPMSK                           03S0359 01698000
*    GRPMASKP = ADDR(GROUPMSK);        /* POINT TO MASK AREA @Z40LPPK*/ 01699000
         LA    @08,GROUPMSK                                     03S0360 01700000
         ST    @08,GRPMASKP                                     03S0360 01701000
*    IF DAUCB = ON THEN                /* DA UCB             @ZA32215*/ 01702000
         TM    DAUCB,B'00000100'                                03S0361 01703000
         BNO   @RF00361                                         03S0361 01704000
*      DDRDA = ON;                     /* YES  ENQ DDR DA    @ZA32215*/ 01705000
         OI    DDRDA,B'00010000'                                03S0362 01706000
*    IF TPURUCB = ON THEN              /* TAPE|UNIT REC UCB  @ZA32215*/ 01707000
@RF00361 TM    TPURUCB,B'00000010'                              03S0363 01708000
         BNO   @RF00363                                         03S0363 01709000
*      DDRTPUR = ON;                   /* YES, ENQ DDR TP|UR @ZA32215*/ 01710000
         OI    DDRTPUR,B'00100000'                              03S0364 01711000
*    CALL IEFAB4EC                     /* CALL GROUP LOCKING    03S0365 01712000
*                                         SERVICE ROUTINE    @Z40LPPK*/ 01713000
*       (LOCKFMAP,LOKLISTP,GRPMASKP,JSCBPTR,LOKWORKP); /*    @Z40LPPK*/ 01714000
@RF00363 LA    @08,LOCKFMAP                                     03S0365 01715000
         ST    @08,@AL00001                                     03S0365 01716000
         LA    @08,LOKLISTP                                     03S0365 01717000
         ST    @08,@AL00001+4                                   03S0365 01718000
         LA    @08,GRPMASKP                                     03S0365 01719000
         ST    @08,@AL00001+8                                   03S0365 01720000
         L     @08,@PC00001+4                                   03S0365 01721000
         ST    @08,@AL00001+12                                  03S0365 01722000
         LA    @08,LOKWORKP                                     03S0365 01723000
         ST    @08,@AL00001+16                                  03S0365 01724000
         L     @15,@CV00189                                     03S0365 01725000
         LA    @01,@AL00001                                     03S0365 01726000
         BALR  @14,@15                                          03S0365 01727000
*    LOCKRC = REG15;                   /* GET RETURN CODE    @Z40LPPK*/ 01728000
         LR    LOCKRC,REG15                                     03S0366 01729000
*    IF LOCKRC ^= ZERO THEN            /* FAILURE BY LOCKER? @Z40LPPK*/ 01730000
         LTR   LOCKRC,LOCKRC                                    03S0367 01731000
         BZ    @RF00367                                         03S0367 01732000
*      IF LOCKRC = ESTAERR THEN        /* ESTAE ERROR?       @Z40LPPK*/ 01733000
         LA    @08,4                                            03S0368 01734000
         CR    LOCKRC,@08                                       03S0368 01735000
         BNE   @RF00368                                         03S0368 01736000
*        DO;                           /* YES, SET CODES     @Z40LPPK*/ 01737000
*          RESNCODE = ESTAERR;         /* REASON CODE        @Z40LPPK*/ 01738000
         L     @15,@PC00001+20                                  03S0370 01739000
         STH   @08,RESNCODE(,@15)                               03S0370 01740000
*          RETCODE = ERROR;            /* RETURN CODE        @Z40LPPK*/ 01741000
         STH   @08,RETCODE                                      03S0371 01742000
*        END;                                                   03S0372 01743000
*      ELSE;                           /* NOT ESTAE ERROR    @Z40LPPK*/ 01744000
@RF00368 DS    0H                                               03S0374 01745000
*    ELSE                              /* NO ERROR           @Z40LPPK*/ 01746000
*      LOCKOKSW = ON;                  /* LOCKING DONE OK    @Z40LPPK*/ 01747000
         B     @RC00367                                         03S0374 01748000
@RF00367 OI    LOCKOKSW,B'00010000'                             03S0374 01749000
*  END;                                /* DONE GROUP LOCKING @Z40LPPK*/ 01750000
@RC00367 DS    0H                                               03S0376 01751000
*  END;                                /*                    @Z40LPPK*/ 01752000
@RF00354 DS    0H                                               02S0377 01753000
*IF LOCKOKSW = ON THEN                 /* LOCKING SUCCESSFUL @Z40LPPK*/ 01754000
@RF00342 TM    LOCKOKSW,B'00010000'                             02S0377 01755000
         BNO   @RF00377                                         02S0377 01756000
*  DO;                                 /* DO VOLUME UNLOADING AND       01757000
*                                         UCB CLEANUP.       @Z40LPPK*/ 01758000
*/********************************************************************/ 01759000
*/*                                                          @Z40LPPK*/ 01760000
*/* SEGMENT NAME - BUILDRBS                                  @Z40LPPK*/ 01761000
*/*                                                          @Z40LPPK*/ 01762000
*/* DESCRIPTIVE NAME - BUILD VM&V RB'S                       @Z40LPPK*/ 01763000
*/*                                                          @Z40LPPK*/ 01764000
*/* FUNCTION -                                               @Z40LPPK*/ 01765000
*/*   THE FUNCTION OF THIS SEGMENT IS TO BUILD VOLUME MOUNT  @Z40LPPK*/ 01766000
*/*   AND VERIFY REQUEST BLOCKS FOR THE JOB'S VOLUMES WHICH  @Z40LPPK*/ 01767000
*/*   ARE TO BE UNLOADED OR REWOUND.                         @Z40LPPK*/ 01768000
*/*                                                          @Z40LPPK*/ 01769000
*/*   OPERATION -                                            @Z40LPPK*/ 01770000
*/*   EACH ENTRY IN THE VOLUME LIST IS CHECKED TO SEE IF THE @Z40LPPK*/ 01771000
*/*   VOLUME SERIAL IN THE ENTRY IS THE SAME VOLUME SERIAL   @Z40LPPK*/ 01772000
*/*   IN THE UCB POINTED TO BY THE VOLUME LIST ENTRY.  IF    @Z40LPPK*/ 01773000
*/*   THE VOLSER IS THE SAME IN BOTH PLACES, WASN'T UNLOADED @ZD03010*/ 01774000
*/*   BY UNIT UNALLOC DURING THE JOB, AND HAS THE FOLLOWING  @ZD03010*/ 01775000
*/*   CHARACTERISTICS, AN UNLOAD VM&V REQUEST BLOCK IS BUILT         */ 01776000
*/*   AND CHAINED FOR IT:                                            */ 01777000
*/*      . VOLUME IS REMOVABLE                                       */ 01778000
*/*      . VOLUME IS PRIVATE OR IS PUBLIC MSS VOLUME         @Z40LPPE*/ 01779000
*/*      . VOLUME IS NOT MARKED NON-USABLE BY ALLOCATION             */ 01780000
*/*      . VOLUME IS UNALLOCATED                                     */ 01781000
*/*      . VOLUME IS TAPE OR DA                                      */ 01782000
*/*      . VOLUME IS NOT ON A JES3-MANAGED DIRECT ACCESS     @ZA06651*/ 01783000
*/*        UNIT (UNLESS THE UNIT IS 3330V). JES3 ISSUES      @ZA06651*/ 01784000
*/*        MOUNT/DEMOUNT MESSAGES FOR NON-3330V, D.A., JES3  @ZA06651*/ 01785000
*/*        MANAGED UNITS. A DEMOUNT MESSAGE ISSUED VIA       @ZA06651*/ 01786000
*/*        IEFBB416 CALLING VM&V WOULD CONFUSE THE OPERATOR  @ZA06651*/ 01787000
*/*        OR POSSIBLY EVEN DESTROY A JES3 SETUP.            @ZA06651*/ 01788000
*/*   IF IT IS IN THE VOLUME LIST AND HAS THE FOLLOWING              */ 01789000
*/*   CHARACTERISTICS A REWIND VM&V REQUEST BLOCK IS BUILT AND       */ 01790000
*/*   CHAINED FOR IT:                                                */ 01791000
*/*      . VOLUME IS REMOVABLE                                       */ 01792000
*/*      . VOLUME IS A TAPE                                          */ 01793000
*/*      . VOLUME IS PUBLIC                                          */ 01794000
*/*      . VOLUME IS NOT MARKED NON-USABLE BY ALLOCATION             */ 01795000
*/*      . VOLUME IS UNALLOCATED                                     */ 01796000
*/*   IF THE VOLUME IS FOUND IN THE VOLLIST BUT DOES NOT HAVE        */ 01797000
*/*   THE ABOVE CHARACTERISTICS, THE IGNORE-ENTRY INDICATOR IN       */ 01798000
*/*   THE VOLLIST ENTRY IS SET.                                      */ 01799000
*/*   EACH TIME A VOLUME SERIAL IN THE UCB MATCHES ONE IN THE        */ 01800000
*/*   VOLLIST, THE NUMBER OF VOLUMES TO GO INTO THE 'RELEASE'        */ 01801000
*/*   MESSAGE IS DECREMENTED.                                        */ 01802000
*/* ENTRY - IN-LINE SEGMENT                                  @Z40LPPK*/ 01803000
*/*                                                          @Z40LPPK*/ 01804000
*/*   PURPOSE - SEE FUNCTION                                 @Z40LPPK*/ 01805000
*/*                                                          @Z40LPPK*/ 01806000
*/*   INPUT -                                                @Z40LPPK*/ 01807000
*/*                                                          @Z40LPPK*/ 01808000
*/*     VOLUME LIST                                          @Z40LPPK*/ 01809000
*/*     UCB'S - POINTED TO BY VOLUME LIST ENTRIES            @Z40LPPK*/ 01810000
*/*     TOTVOLS - # OF ENTRIES IN THE VOLUME LIST            @Z40LPPK*/ 01811000
*/*     RLSECTR - # OF VOLSERS FOR RELEASED MSG              @Z40LPPK*/ 01812000
*/*                                                          @Z40LPPK*/ 01813000
*/* EXITS -                                                  @Z40LPPK*/ 01814000
*/*                                                          @Z40LPPK*/ 01815000
*/*   CONDITION - NORMAL COMPLETION                          @Z40LPPK*/ 01816000
*/*                                                          @Z40LPPK*/ 01817000
*/*     OUTPUT -                                             @Z40LPPK*/ 01818000
*/*                                                          @Z40LPPK*/ 01819000
*/*       VMVRQBLK - VM&V RB'S BUILT                         @Z40LPPK*/ 01820000
*/*                                                          @Z40LPPK*/ 01821000
*/*       RLSECTR - # OF VOLSERS TO BE RELEASED              @Z40LPPK*/ 01822000
*/*                                                          @Z40LPPK*/ 01823000
*/*       FUNLDRBP - ADDRESS OF FIRST VM&V RB                @Z40LPPK*/ 01824000
*/*                                                          @Z40LPPK*/ 01825000
*/*       VOLLIST - ENTRIES UPDATED                          @Z40LPPK*/ 01826000
*/*                                                          @Z40LPPK*/ 01827000
*/*    RETURN CODE - NONE                                    @Z40LPPK*/ 01828000
*/*                                                          @Z40LPPK*/ 01829000
*/***********************************************************@Z40LPPK*/ 01830000
*IF LOCKNUM > FFSERCTR THEN            /* DID ANY UCB'S IN UCB LIST     01831000
*                                         COME FROM VOLLIST? @Z40LPPK*/ 01832000
         L     @08,LOKLISTP                                     03S0379 01833000
         L     @08,LOCKNUM(,@08)                                03S0379 01834000
         C     @08,FFSERCTR                                     03S0379 01835000
         BNH   @RF00379                                         03S0379 01836000
*  DO VOLCTR = ONE TO TOTVOLS;         /* YES, SCAN VOLLIST  @Z40LPPK*/ 01837000
         LA    VOLCTR,1                                         03S0380 01838000
         B     @DE00380                                         03S0380 01839000
@DL00380 DS    0H                                               03S0381 01840000
*    IF VOLINDX(VOLCTR) ^= ZERO THEN   /* WAS A UCB LIST ENTRY MADE     01841000
*                                         FOR THIS VOLLIST ENTRY?       01842000
*                                                            @Z40LPPK*/ 01843000
         SLR   @08,@08                                          03S0381 01844000
         L     @02,VOLCOREP                                     03S0381 01845000
         LR    @15,VOLCTR                                       03S0381 01846000
         SLA   @15,4                                            03S0381 01847000
         LA    @01,0(@15,@02)                                   03S0381 01848000
         AL    @01,@CF01961                                     03S0381 01849000
         L     @14,VOLINDX-8(,@01)                              03S0381 01850000
         CR    @14,@08                                          03S0381 01851000
         BE    @RF00381                                         03S0381 01852000
*      DO;                             /* MAYBE BUILD VM&V RB@Z40LPPK*/ 01853000
*        LOKINDEX = VOLINDX(VOLCTR);   /* CUR UCB LIST ENTRY @Z40LPPK*/ 01854000
         LR    LOKINDEX,@14                                     03S0383 01855000
*        UCBPTR = VOLUCBP(VOLCTR);     /* UCB FROM VOLLIST   @Z40LPPK*/ 01856000
         L     @05,VOLCOREP                                     03S0384 01857000
         LA    @01,0(@15,@05)                                   03S0384 01858000
         AL    @01,@CF01946                                     03S0384 01859000
         L     UCBPTR,VOLUCBP-12(,@01)                          03S0384 01860000
*        IF LOCKLIST(LOKINDEX)^= ZERO & /* GROUP WAS LOCKED  @Z40LPPK*/ 01861000
*           VOLSER(VOLCTR) = UCBVOLI THEN /* VOL STILL MNTD  @Z40LPPK*/ 01862000
         LR    @14,LOKINDEX                                     03S0385 01863000
         SLA   @14,2                                            03S0385 01864000
         L     @01,LOKLISTP                                     03S0385 01865000
         C     @08,LOCKLIST-4(@14,@01)                          03S0385 01866000
         BE    @RF00385                                         03S0385 01867000
         ST    @15,@TF00001                                     03S0385 01868000
         ALR   @15,@05                                          03S0385 01869000
         AL    @15,@CF01958                                     03S0385 01870000
         CLC   VOLSER-2(6,@15),UCBVOLI(UCBPTR)                  03S0385 01871000
         BNE   @RF00385                                         03S0385 01872000
*          DO;                         /* MAYBE BUILD VMV RB @Z40LPPK*/ 01873000
*            RLSECTR = RLSECTR - ONE;  /* ONE LESS VOL FOR RETAINED     01874000
*                                         VOLS RELEASED MSG. @Z40LPPK*/ 01875000
         L     @08,RLSECTR                                      03S0387 01876000
         BCTR  @08,0                                            03S0387 01877000
         ST    @08,RLSECTR                                      03S0387 01878000
*            VOLIGNOR(VOLCTR) = ON;    /* VOL NOT IN RLSE MSG@Z40LPPK*/ 01879000
         AL    @05,@TF00001                                     03S0388 01880000
         AL    @05,@CF01959                                     03S0388 01881000
         OI    VOLIGNOR(@05),B'10000000'                        03S0388 01882000
*            IF (UCBPRES = OFF & UCBRESV = OFF & /* NOT PERM RES/RESVD  01883000
**/             (UCBBPRV = ON  |           /* PRIVATE OR        @Z40LPP 01884000
**/              (UCBTYP(3:4)=DEV3330 &   /*3330                @Z40LPP 01885000
**/               UCBRVDEV=ON &           /*VIRTUAL DEVICE WITH @Z40LPP 01886000
**/               UCBBPUB=ON)) &          /*PUBLIC VOLUME       @Z40LPP 01887000
**/             (UCBJES3 = OFF |          /*NOT JES3 MANAGED    @ZA0665 01888000
**/              UCB3TAPE = ON |          /*OR TAPE             @ZA0665 01889000
**/              (UCBTYP(3:4) =           /*OR 3330V            @ZA0665 01890000
**/                DEV3330     &          /*                    @ZA0665 01891000
**/               UCBRVDEV = ON)) &       /*                    @ZA0665 01892000
**/             UCBALOC = OFF &           /* NOT ALLOCATED      03S0389 01893000
**/             UCBNALOC = OFF) |/*                             03S0389 01894000
*                                         VOL STILL UNLDABLE @Z40LPPK*/ 01895000
*               (UCB3TAPE = ON &          /*VOL IS TAPE         03S0389 01896000
**/              UCBRESV = OFF &          /*NOT RESERVED        03S0389 01897000
**/              UCBNALOC = OFF &         /*NOT NON-USABLE      03S0389 01898000
**/              UCBALOC = OFF &          /*UNALLOCATED         03S0389 01899000
**/              UCBBPUB = ON) THEN/*                           03S0389 01900000
*                                         VOL STILL RWNDABLE @Z40LPPK*/ 01901000
         TM    UCBPRES(UCBPTR),B'00100100'                      03S0389 01902000
         BNZ   @GL00027                                         03S0389 01903000
         TM    UCBBPRV(UCBPTR),B'00010000'                      03S0389 01904000
         BO    @GL00030                                         03S0389 01905000
         CLC   UCBTYP+2(2,UCBPTR),DEV3330                       03S0389 01906000
         BNE   @GL00027                                         03S0389 01907000
         TM    UCBRVDEV(UCBPTR),B'00001000'                     03S0389 01908000
         BNO   @GL00027                                         03S0389 01909000
         TM    UCBBPUB(UCBPTR),B'00001000'                      03S0389 01910000
         BNO   @GL00027                                         03S0389 01911000
@GL00030 TM    UCBJES3(UCBPTR),B'01000000'                      03S0389 01912000
         BZ    @GL00029                                         03S0389 01913000
         TM    UCB3TAPE(UCBPTR),B'10000000'                     03S0389 01914000
         BO    @GL00029                                         03S0389 01915000
         CLC   UCBTYP+2(2,UCBPTR),DEV3330                       03S0389 01916000
         BNE   @GL00027                                         03S0389 01917000
         TM    UCBRVDEV(UCBPTR),B'00001000'                     03S0389 01918000
         BNO   @GL00027                                         03S0389 01919000
@GL00029 TM    UCBALOC(UCBPTR),B'00001000'                      03S0389 01920000
         BNZ   @GL00027                                         03S0389 01921000
         TM    UCBNALOC(UCBPTR),B'00000100'                     03S0389 01922000
         BZ    @RT00389                                         03S0389 01923000
@GL00027 TM    UCB3TAPE(UCBPTR),B'10000000'                     03S0389 01924000
         BNO   @RF00389                                         03S0389 01925000
         TM    UCBRESV(UCBPTR),B'00100000'                      03S0389 01926000
         BNZ   @RF00389                                         03S0389 01927000
         TM    UCBNALOC(UCBPTR),B'00000100'                     03S0389 01928000
         BNZ   @RF00389                                         03S0389 01929000
         TM    UCBALOC(UCBPTR),B'00001000'                      03S0389 01930000
         BNZ   @RF00389                                         03S0389 01931000
         TM    UCBBPUB(UCBPTR),B'00001000'                      03S0389 01932000
         BNO   @RF00389                                         03S0389 01933000
@RT00389 DS    0H                                               03S0390 01934000
*              DO;                     /* BUILD VM&V RB      @Z40LPPK*/ 01935000
*                IF FUNLDRBP = ZERO THEN /* FIRST RB IN CHAIN        */ 01936000
         ICM   @08,15,FUNLDRBP                                  03S0391 01937000
         BNZ   @RF00391                                         03S0391 01938000
*                  FUNLDRBP = VMVREQBP;  /* SET CHAIN HEADER         */ 01939000
         ST    VMVREQBP,FUNLDRBP                                03S0392 01940000
*                ELSE                    /* NOT FIRST RB IN THE CHAIN*/ 01941000
*                  DO;                 /*CHAIN THIS RB TO LAST       */ 01942000
         B     @RC00391                                         03S0393 01943000
@RF00391 DS    0H                                               03S0394 01944000
*                    VMVNREQP = VMVREQBP + LENGTH(VMVRQBLK);    03S0394 01945000
         LA    @08,52                                           03S0394 01946000
         ALR   @08,VMVREQBP                                     03S0394 01947000
         ST    @08,VMVNREQP(,VMVREQBP)                          03S0394 01948000
*                    VMVREQBP = VMVNREQP; /* GET NEW RB PTR          */ 01949000
         LR    VMVREQBP,@08                                     03S0395 01950000
*                  END;                /* END CHAIN THIS RB TO LAST  */ 01951000
*                IF (UCBPRES = OFF & UCBRESV = OFF & /* NOT PERM RES/RE 01952000
*VD  */             (UCBBPRV = ON  |           /* PRIVATE OR        @Z4 01953000
*LPPE*/              (UCBTYP(3:4)=DEV3330 &   /*3330                @Z4 01954000
*LPPE*/               UCBRVDEV=ON &           /*VIRTUAL DEVICE WITH @Z4 01955000
*LPPE*/               UCBBPUB=ON)) &          /*PUBLIC VOLUME       @Z4 01956000
*LPPE*/             (UCBJES3 = OFF |          /*NOT JES3 MANAGED    @ZA 01957000
*6651*/              UCB3TAPE = ON |          /*OR TAPE             @ZA 01958000
*6651*/              (UCBTYP(3:4) =           /*OR 3330V            @ZA 01959000
*6651*/                DEV3330     &          /*                    @ZA 01960000
*6651*/               UCBRVDEV = ON)) &       /*                    @ZA 01961000
*6651*/             UCBALOC = OFF &           /* NOT ALLOCATED  03S0397 01962000
*    */             UCBNALOC = OFF) THEN/*                      03S0397 01963000
*                                         IF UNLOADABLE      @Z40LPPE*/ 01964000
@RC00391 TM    UCBPRES(UCBPTR),B'00100100'                      03S0397 01965000
         BNZ   @RF00397                                         03S0397 01966000
         TM    UCBBPRV(UCBPTR),B'00010000'                      03S0397 01967000
         BO    @GL00044                                         03S0397 01968000
         CLC   UCBTYP+2(2,UCBPTR),DEV3330                       03S0397 01969000
         BNE   @RF00397                                         03S0397 01970000
         TM    UCBRVDEV(UCBPTR),B'00001000'                     03S0397 01971000
         BNO   @RF00397                                         03S0397 01972000
         TM    UCBBPUB(UCBPTR),B'00001000'                      03S0397 01973000
         BNO   @RF00397                                         03S0397 01974000
@GL00044 TM    UCBJES3(UCBPTR),B'01000000'                      03S0397 01975000
         BZ    @GL00043                                         03S0397 01976000
         TM    UCB3TAPE(UCBPTR),B'10000000'                     03S0397 01977000
         BO    @GL00043                                         03S0397 01978000
         CLC   UCBTYP+2(2,UCBPTR),DEV3330                       03S0397 01979000
         BNE   @RF00397                                         03S0397 01980000
         TM    UCBRVDEV(UCBPTR),B'00001000'                     03S0397 01981000
         BNO   @RF00397                                         03S0397 01982000
@GL00043 TM    UCBALOC(UCBPTR),B'00001000'                      03S0397 01983000
         BNZ   @RF00397                                         03S0397 01984000
         TM    UCBNALOC(UCBPTR),B'00000100'                     03S0397 01985000
         BNZ   @RF00397                                         03S0397 01986000
*                  DO;                                          03S0398 01987000
*                    VMVUNLOD = ON;    /*INDICATE VOLUME UNLOAD      */ 01988000
         OI    VMVUNLOD(VMVREQBP),B'10000000'                   03S0399 01989000
*                    VMVKEEP = ON;     /*ISSUE KEEP TYPE MESSAGE     */ 01990000
         OI    VMVKEEP(VMVREQBP),B'10000000'                    03S0400 01991000
*                  END;                                         03S0401 01992000
*                ELSE                  /*VOLUME NOT PRIVATE          */ 01993000
*                  DO;                 /*                    @ZA02721*/ 01994000
         B     @RC00397                                         03S0402 01995000
@RF00397 DS    0H                                               03S0403 01996000
*                    VOLREWND(VOLCTR) = ON;    /*VOL REWOUND @ZA02721*/ 01997000
         LR    @08,VOLCTR                                       03S0403 01998000
         SLA   @08,4                                            03S0403 01999000
         L     @01,VOLCOREP                                     03S0403 02000000
         ALR   @01,@08                                          03S0403 02001000
         AL    @01,@CF01959                                     03S0403 02002000
         OI    VOLREWND(@01),B'00001000'                        03S0403 02003000
*                    VMVREWND = ON;    /*REWIND VOLUME               */ 02004000
         OI    VMVREWND(VMVREQBP),B'00100000'                   03S0404 02005000
*                  END;                /*                    @ZA02721*/ 02006000
*                VMVUCBP = UCBPTR;     /*POINT TO UCB                */ 02007000
@RC00397 STCM  UCBPTR,7,VMVUCBP(VMVREQBP)                       03S0406 02008000
*                VMVUCB = ON;          /*VOLSER IN UCB               */ 02009000
         OI    VMVUCB(VMVREQBP),B'01000000'                     03S0407 02010000
*                VMVJBNMP = ADDR(JCTJNAME); /*POINT TO JOB NAME      */ 02011000
         L     @08,@PC00001+8                                   03S0408 02012000
         L     @08,JCTPTR(,@08)                                 03S0408 02013000
         LA    @08,JCTJNAME(,@08)                               03S0408 02014000
         ST    @08,VMVJBNMP(,VMVREQBP)                          03S0408 02015000
*                VOLUNLD(VOLCTR) = ON; /*SET VOL UNLOADED , REWOUND     02016000
*                                        IN VOLLIST                  */ 02017000
         LR    @08,VOLCTR                                       03S0409 02018000
         SLA   @08,4                                            03S0409 02019000
         L     @02,VOLCOREP                                     03S0409 02020000
         ALR   @02,@08                                          03S0409 02021000
         AL    @02,@CF01959                                     03S0409 02022000
         OI    VOLUNLD(@02),B'01000000'                         03S0409 02023000
*              END;                    /* END RB BUILD       @Z40LPPK*/ 02024000
*          END;                        /*                    @Z40LPPK*/ 02025000
*        ELSE                                             /* @ZA08095*/ 02026000
*          IF LOCKLIST(LOKINDEX)^=ZERO & /* GRP WAS LOCKED   @ZA08095*/ 02027000
*          VOLVIRSW(VOLCTR) = ON THEN  /* VIRTUAL VOLUME     @ZA08095*/ 02028000
         B     @RC00385                                         03S0412 02029000
@RF00385 LR    @08,LOKINDEX                                     03S0412 02030000
         SLA   @08,2                                            03S0412 02031000
         L     @05,LOKLISTP                                     03S0412 02032000
         L     @08,LOCKLIST-4(@08,@05)                          03S0412 02033000
         LTR   @08,@08                                          03S0412 02034000
         BZ    @RF00412                                         03S0412 02035000
         L     @08,VOLCOREP                                     03S0412 02036000
         LR    @05,VOLCTR                                       03S0412 02037000
         SLA   @05,4                                            03S0412 02038000
         ST    @05,@TF00001                                     03S0412 02039000
         ALR   @05,@08                                          03S0412 02040000
         AL    @05,@CF01959                                     03S0412 02041000
         TM    VOLVIRSW(@05),B'00010000'                        03S0412 02042000
         BNO   @RF00412                                         03S0412 02043000
*          DO;                         /*                    @ZA08095*/ 02044000
*            RLSECTR = RLSECTR - ONE;  /* ONE LESS VOL FOR   @ZA08095*/ 02045000
         L     @02,RLSECTR                                      03S0414 02046000
         BCTR  @02,0                                            03S0414 02047000
         ST    @02,RLSECTR                                      03S0414 02048000
*            VOLIGNOR(VOLCTR) = ON;    /* VOLS RELEASED MSG  @ZA08095*/ 02049000
         AL    @08,@TF00001                                     03S0415 02050000
         AL    @08,@CF01959                                     03S0415 02051000
         OI    VOLIGNOR(@08),B'10000000'                        03S0415 02052000
*          END;                        /*                    @ZA08095*/ 02053000
*      END;                            /*                    @Z40LPPK*/ 02054000
*    ELSE;                             /* VOL NOT UP ON SCAN BEFORE     02055000
*                                         UCB LOCKED         @Z40LPPK*/ 02056000
@RF00381 DS    0H                                               03S0419 02057000
*  END;                                /* END VOLLIST SCAN   @Z40LPPK*/ 02058000
@RC00381 AL    VOLCTR,@CF00056                                  03S0419 02059000
@DE00380 CR    VOLCTR,TOTVOLS                                   03S0419 02060000
         BNH   @DL00380                                         03S0419 02061000
*ELSE;                                 /* NO UCB LIST ENTRIES MADE      02062000
*                                         FOR VOLLIST ENTRIES@Z40LPPK*/ 02063000
@RF00379 DS    0H                                               03S0421 02064000
*    IF FUNLDRBP ^= ZERO THEN          /*VOLUMES MUST BE UNLOADED    */ 02065000
         ICM   @08,15,FUNLDRBP                                  02S0421 02066000
         BZ    @RF00421                                         02S0421 02067000
*      CALL IEFAB49C(FUNLDRBP,ZERO,ZERO); /* UNLOAD VOLUMES          */ 02068000
         MVC   @AL00001+4(8),@AL00422                           02S0422 02069000
         LA    @08,FUNLDRBP                                     02S0422 02070000
         ST    @08,@AL00001                                     02S0422 02071000
         L     @15,@CV00192                                     02S0422 02072000
         LA    @01,@AL00001                                     02S0422 02073000
         BALR  @14,@15                                          02S0422 02074000
*     DO; /*MODESET  KEYADDR(ZERO)*/                            02S0423 02075000
@RF00421 DS    0H                                               02S0424 02076000
*       SPKA (ZERO); /*SET PSW KEY*/                            02S0424 02077000
         SLR   @08,@08                                          02S0424 02078000
         SPKA  0(@08)                                           02S0424 02079000
*     END; /*MODESET  KEYADDR(ZERO)*/           /* GET KEY ZERO FOR UCB 02080000
*UPDATE*/                                                       02S0425 02081000
*     DO; /* SETLOCK (OBTAIN) MODE(UNCOND) TYPE(LOCAL) REGS(USE) RELATE 02082000
*(UCBS,IEFBB416(VOLCLNP)) */                                    02S0426 02083000
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) RSTD;                 02S0427 02084000
*       RFY (GPR15P,GPR00P,GPR01P) RSTD;                        02S0428 02085000
*       GPR15P = GPR11P; /* SAVE REG. 11 IN REG. 15. */         02S0429 02086000
         LR    GPR15P,GPR11P                                    02S0429 02087000
*       GPR00P = GPR12P; /* SAVE REG. 12 IN REG. 0. */          02S0430 02088000
         LR    GPR00P,GPR12P                                    02S0430 02089000
*       GPR01P = GPR13P; /* SAVE REG. 13 IN REG. 1. */          02S0431 02090000
         LR    GPR01P,GPR13P                                    02S0431 02091000
*       GPR13P = PSALITA; /* ADDRESS OF LOCK INTERFACE TABLE. */        02092000
         L     GPR13P,PSALITA                                   02S0432 02093000
*       GEN(LM GPR11P,GPR13P,576(GPR13P)); /* LOAD LOCKWORD, CLHT AND E 02094000
*TRY ADRS. */                                                   02S0433 02095000
         LM GPR11P,GPR13P,576(GPR13P)                                   02096000
*       GEN(BALR GPR14P,GPR13P); /* BALR TO SETLOCK RTN. */     02S0434 02097000
         BALR GPR14P,GPR13P                                             02098000
*       GPR11P = GPR15P; /* RESTORE REG. 11. */                 02S0435 02099000
         LR    GPR11P,GPR15P                                    02S0435 02100000
*       GPR15P = GPR13P; /* SAVE RETURN CODE. */                02S0436 02101000
         LR    GPR15P,GPR13P                                    02S0436 02102000
*       GPR12P = GPR00P; /* RESTORE REG. 12 */                  02S0437 02103000
         LR    GPR12P,GPR00P                                    02S0437 02104000
*       GPR13P = GPR01P; /* RESTORE REG. 13. */                 02S0438 02105000
         LR    GPR13P,GPR01P                                    02S0438 02106000
*       RFY(GPR15P,GPR00P,GPR01P) UNRSTD;                       02S0439 02107000
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) UNRSTD;               02S0440 02108000
*     END; /* SETLOCK (OBTAIN) MODE(UNCOND) TYPE(LOCAL) REGS(USE) RELAT 02109000
*D(UCBS,IEFBB416(VOLCLNP)) */                                   02S0441 02110000
*     DO; /* SETLOCK (OBTAIN) MODE(UNCOND) TYPE(CMS) REGS(USE) RELATED( 02111000
*CBS,IEFBB416(VOLCLNP)) */                                      02S0442 02112000
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) RSTD;                 02S0443 02113000
*       RFY (GPR15P,GPR00P,GPR01P) RSTD;                        02S0444 02114000
*       GPR15P = GPR11P; /* SAVE REG. 11 IN REG. 15. */         02S0445 02115000
         LR    GPR15P,GPR11P                                    02S0445 02116000
*       GPR00P = GPR12P; /* SAVE REG. 12 IN REG. 0. */          02S0446 02117000
         LR    GPR00P,GPR12P                                    02S0446 02118000
*       GPR01P = GPR13P; /* SAVE REG. 13 IN REG. 1. */          02S0447 02119000
         LR    GPR01P,GPR13P                                    02S0447 02120000
*       GPR13P = PSALITA; /* ADDRESS OF LOCK INTERFACE TABLE. */        02121000
         L     GPR13P,PSALITA                                   02S0448 02122000
*       GEN(LM GPR11P,GPR13P,540(GPR13P)); /* LOAD LOCKWORD, CLHT AND E 02123000
*TRY ADRS. */                                                   02S0449 02124000
         LM GPR11P,GPR13P,540(GPR13P)                                   02125000
*       GEN(BALR GPR14P,GPR13P); /* BALR TO SETLOCK RTN. */     02S0450 02126000
         BALR GPR14P,GPR13P                                             02127000
*       GPR11P = GPR15P; /* RESTORE REG. 11. */                 02S0451 02128000
         LR    GPR11P,GPR15P                                    02S0451 02129000
*       GPR15P = GPR13P; /* SAVE RETURN CODE. */                02S0452 02130000
         LR    GPR15P,GPR13P                                    02S0452 02131000
*       GPR12P = GPR00P; /* RESTORE REG. 12 */                  02S0453 02132000
         LR    GPR12P,GPR00P                                    02S0453 02133000
*       GPR13P = GPR01P; /* RESTORE REG. 13. */                 02S0454 02134000
         LR    GPR13P,GPR01P                                    02S0454 02135000
*       RFY(GPR15P,GPR00P,GPR01P) UNRSTD;                       02S0455 02136000
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) UNRSTD;               02S0456 02137000
*     END; /* SETLOCK (OBTAIN) MODE(UNCOND) TYPE(CMS) REGS(USE) RELATED 02138000
*UCBS,IEFBB416(VOLCLNP)) */                                     02S0457 02139000
*/********************************************************************/ 02140000
*/*                                                                  */ 02141000
*/* SEGMENT NAME - UPDUCBS                                           */ 02142000
*/*                                                                  */ 02143000
*/* DESCRIPTIVE NAME - UPDATE UCBS                                   */ 02144000
*/*                                                                  */ 02145000
*/* FUNCTION -                                                       */ 02146000
*/*   THE FUNCTION OF THIS SEGMENT IS TO CLEAR THE UCB               */ 02147000
*/*   VOLSER FIELD FOR EACH UCB THAT HAD A NON-SPECIFIC UNOPENED     */ 02148000
*/*   TAPE. UCBS WITH FF SERIALS ARE IN THE FF SER LIST.             */ 02149000
*/*   THIS SEGMENT ALSO CLEARS THE PASS-DATA-SET-ON-VOLUME           */ 02150000
*/*   INDICATOR FOR EACH VOLUME THAT WAS FOUND UP ON THE SYSTEM      */ 02151000
*/*   BUT WAS NOT UNLOADABLE. THESE VOLUMES ARE IN THE VOLLIST       */ 02152000
*/*   AND ARE MARKED AS BEING IGNORED OR REWOUND. VM&V WILL  @ZA02721*/ 02153000
*/*   RESET THIS INDICATOR FOR EACH VOLUME THAT IT UNLOADS.  @ZA02721*/ 02154000
*/*   NOTE:  FOR TAPE UNITS, THE ASID IN THE UCB MUST MATCH  @ZA02721*/ 02155000
*/*          THE CURRENT ASID, INDICATING THAT THE CURRENT   @ZA02721*/ 02156000
*/*          JOB WAS THE PASSING JOB.                        @ZA02721*/ 02157000
*/*   NOTE:  IN ORDER TO UPDATE THESE UCB'S, THEIR GROUPS    @Z40LPPK*/ 02158000
*/*          HAD TO BE LOCKED.  THE VOLLIST AND FF SER LIST  @Z40LPPK*/ 02159000
*/*          WERE FILLED IN BEFORE THE GROUPS WERE LOCKED.   @Z40LPPK*/ 02160000
*/*          IF THE GROUP WAS LOCKED, THE UCB POINTERS IN    @Z40LPPK*/ 02161000
*/*          THE VOLLIST ENTRY AND CORRESPONDING UCB LIST    @Z40LPPK*/ 02162000
*/*          ENTRY ARE EQUAL - A CHECK IS MADE FOR THIS.     @Z40LPPK*/ 02163000
*/*          ALSO, THE FF SER UCB'S ARE CHECKED TO MAKE      @Z40LPPK*/ 02164000
*/*          SURE THEY'RE STILL THERE.  SINCE VOLIGNOR AND   @Z40LPPK*/ 02165000
*/*          VOLREWND ARE SET ON WHILE UNDER THE GROUP       @Z40LPPK*/ 02166000
*/*          LOCKS, CHECKS OF THOSE INDICATORS INSURE THAT   @Z40LPPK*/ 02167000
*/*          UPDATING OF THE UCB IS STILL VALID.             @Z40LPPK*/ 02168000
*/* ENTRY - IN-LINE SEGMENT                                          */ 02169000
*/*   PURPOSE - SEE FUNCTION                                         */ 02170000
*/*                                                                  */ 02171000
*/*   INPUT -                                                        */ 02172000
*/*     FFSERBLK - FF SER LIST BLOCK                         @Z40LPPK*/ 02173000
*/*       FFSERCTR - NUMBER OF ENTRIES IN THE BLOCK                  */ 02174000
*/*       FFSERUCB - UCB ADDRESS (UP TO THIRTY)              @Z40LPPK*/ 02175000
*/*                                                                  */ 02176000
*/*     VOLLIST - VOLUME LIST                                        */ 02177000
*/*       VLSTENT - VOLUME LIST ENTRY                                */ 02178000
*/*         VOLUCBP - UCB ADDRESS                                    */ 02179000
*/*         VOLIGNOR - IGNORE ENTRY INDICATOR                        */ 02180000
*/*         VOLFNDSW - VOL FOUND MOUNTED                     @Z40LPPK*/ 02181000
*/*                                                                  */ 02182000
*/*     UCB - UNIT CONTROL BLOCK                                     */ 02183000
*/*       UCBVOLI - VOLUME SERIAL                                    */ 02184000
*/*       UCBMONT - PASS-DATA-SET-ON-VOLUME INDICATOR                */ 02185000
*/*                                                          @Z40LPPK*/ 02186000
*/*     LOCKLIST - ARRAY OF UCB'S/GROUPS LOCKED              @Z40LPPK*/ 02187000
*/*                                                                  */ 02188000
*/* EXIT -                                                           */ 02189000
*/*   CONDITION - NORMAL                                             */ 02190000
*/*     OUTPUT -                                                     */ 02191000
*/*       UCB -                                                      */ 02192000
*/*         UCBVOLI - VOLUME SERIAL                                  */ 02193000
*/*     RETURN CODE - NONE                                           */ 02194000
*/********************************************************************/ 02195000
*DO VOLCTR = ONE TO TOTVOLS;           /* SCAN VLLST TO RESET UCBMONT*/ 02196000
         LA    VOLCTR,1                                         03S0458 02197000
         B     @DE00458                                         03S0458 02198000
@DL00458 DS    0H                                               03S0459 02199000
*  IF VOLINDX(VOLCTR) ^= ZERO THEN     /* IF THERE IS A UCBLIST ENTRY   02200000
*                                         FOR THE VOLLIST ENTRY 03S0459 02201000
*                                                            @Z40LPPK*/ 02202000
         L     @08,VOLCOREP                                     03S0459 02203000
         LR    @06,VOLCTR                                       03S0459 02204000
         SLA   @06,4                                            03S0459 02205000
         LA    @02,0(@06,@08)                                   03S0459 02206000
         AL    @02,@CF01961                                     03S0459 02207000
         L     @02,VOLINDX-8(,@02)                              03S0459 02208000
         LTR   @02,@02                                          03S0459 02209000
         BZ    @RF00459                                         03S0459 02210000
*    DO;                               /* PROCESS VLST ENTRY @Z40LPPK*/ 02211000
*      LOKINDEX = VOLINDX(VOLCTR);     /* GET CORRECT INDEX  @Z40LPPK*/ 02212000
         LR    LOKINDEX,@02                                     03S0461 02213000
*      IF LOCKLIST(LOKINDEX) =         /* CRNT UCB LIST ENTRY@Z40LPPK*/ 02214000
*         VOLUCBP(VOLCTR) THEN         /* CRNT VOLLIST ENTRY @Z40LPPK*/ 02215000
         LR    @05,LOKINDEX                                     03S0462 02216000
         SLA   @05,2                                            03S0462 02217000
         LA    @02,0(@06,@08)                                   03S0462 02218000
         AL    @02,@CF01946                                     03S0462 02219000
         L     @02,VOLUCBP-12(,@02)                             03S0462 02220000
         L     @01,LOKLISTP                                     03S0462 02221000
         C     @02,LOCKLIST-4(@05,@01)                          03S0462 02222000
         BNE   @RF00462                                         03S0462 02223000
*        DO;                           /* PROCESS VLST ENTRY @Z40LPPK*/ 02224000
*          IF VOLIGNOR(VOLCTR) = ON |  /* VOL NOT UNLOADED   @ZA02721*/ 02225000
*             VOLREWND(VOLCTR) = ON THEN /* VOL REWOUND?     @ZA02721*/ 02226000
         ALR   @08,@06                                          03S0464 02227000
         AL    @08,@CF01959                                     03S0464 02228000
         TM    VOLIGNOR(@08),B'10001000'                        03S0464 02229000
         BZ    @RF00464                                         03S0464 02230000
*            DO;                       /* CLEAR PASS INDIC.  @ZA02721*/ 02231000
         ST    @02,@TF00001                                     03S0465 02232000
*              UCBPTR = VOLUCBP(VOLCTR); /* GET UCB PTR      @ZA02721*/ 02233000
         L     UCBPTR,@TF00001                                  03S0466 02234000
*              IF UCB3DACC = ON THEN   /* DIRECT ACCESS      @ZA02721*/ 02235000
         TM    UCB3DACC(UCBPTR),B'00100000'                     03S0467 02236000
         BNO   @RF00467                                         03S0467 02237000
*                 UCBMONT = OFF;       /* SET PASS INDIC OFF @ZA02721*/ 02238000
         NI    UCBMONT(UCBPTR),B'11111110'                      03S0468 02239000
*              ELSE                    /* TAPE               @ZA02721*/ 02240000
*                IF UCBASID = ASID  THEN/*CURRENT ASID IN UCB@ZA02721*/ 02241000
         B     @RC00467                                         03S0469 02242000
@RF00467 L     @08,UCBEXTPT(,UCBPTR)                            03S0469 02243000
         SLR   @06,@06                                          03S0469 02244000
         ICM   @06,3,ASID                                       03S0469 02245000
         CH    @06,UCBASID(,@08)                                03S0469 02246000
         BNE   @RF00469                                         03S0469 02247000
*                  UCBMONT = OFF;      /* SET PASS INDIC OFF @ZA02721*/ 02248000
         NI    UCBMONT(UCBPTR),B'11111110'                      03S0470 02249000
*                ELSE;                 /* NOT CURRENT ASID.  @ZA02721*/ 02250000
@RF00469 DS    0H                                               03S0472 02251000
*            END;                      /* END PASS CLEARING. @ZA02721*/ 02252000
*          ELSE;                       /* VOL WAS UNLOADED.  @ZA02721*/ 02253000
@RF00464 DS    0H                                               03S0474 02254000
*        END;                          /* DONE VOLLIST ENTRY @Z40LPPK*/ 02255000
*      ELSE;                           /* UCB NOT LOCKED     @Z40LPPK*/ 02256000
@RF00462 DS    0H                                               03S0476 02257000
*    END;                              /* DONE VOLLIST ENTRY @Z40LPPK*/ 02258000
*  ELSE;                               /* NON-CORRESPONDING VOL- UCB    02259000
*                                         LIST ENTRIES       @Z40LPPK*/ 02260000
@RF00459 DS    0H                                               03S0478 02261000
*END;                                  /* END SCAN TO RESET UCBMONT  */ 02262000
@RC00459 AL    VOLCTR,@CF00056                                  03S0478 02263000
@DE00458 CR    VOLCTR,TOTVOLS                                   03S0478 02264000
         BNH   @DL00458                                         03S0478 02265000
*LOKINDEX = LOKVOLS + ONE;             /* GET FIRST FFSER-CORRESPONDING 02266000
*                                         ENTRY IN LOCKLIST  @Z40LPPK*/ 02267000
         LA    @08,1                                            03S0479 02268000
         LR    LOKINDEX,LOKVOLS                                 03S0479 02269000
         ALR   LOKINDEX,@08                                     03S0479 02270000
*DO SERCTR = ONE TO FFSERCTR;          /* PROCESS ALL ENTRIES IN BLK */ 02271000
         LR    SERCTR,@08                                       03S0480 02272000
         B     @DE00480                                         03S0480 02273000
@DL00480 DS    0H                                               03S0481 02274000
*  IF FFSERUCB(SERCTR) =               /* CURRENT FFSER UCB  @Z40LPPK*/ 02275000
*     LOCKLIST(LOKINDEX) THEN          /* CUR UCB LIST ENTRY @Z40LPPK*/ 02276000
         LR    @08,SERCTR                                       03S0481 02277000
         SLA   @08,2                                            03S0481 02278000
         L     @08,FFSERUCB-4(@08)                              03S0481 02279000
         LR    @15,LOKINDEX                                     03S0481 02280000
         SLA   @15,2                                            03S0481 02281000
         L     @01,LOKLISTP                                     03S0481 02282000
         C     @08,LOCKLIST-4(@15,@01)                          03S0481 02283000
         BNE   @RF00481                                         03S0481 02284000
*    DO;                               /* PROCESS ENTRY      @Z40LPPK*/ 02285000
*      UCBPTR = FFSERUCB(SERCTR);      /* GET UCB BASE       @Z40LPPK*/ 02286000
         LR    UCBPTR,@08                                       03S0483 02287000
*      IF UCBVOLI(1) = NSTAPE &        /* NON-SPEC, UNOPENED TAPE       02288000
*                                                            @Z40LPPK*/ 02289000
*         UCBVOLI(5:6) = ASID THEN     /* THIS MEMORY'S ASID @Z40LPPK*/ 02290000
         CLI   UCBVOLI(UCBPTR),X'FF'                            03S0484 02291000
         BNE   @RF00484                                         03S0484 02292000
         CLC   UCBVOLI+4(2,UCBPTR),ASID                         03S0484 02293000
         BNE   @RF00484                                         03S0484 02294000
*        DO;                           /* PROCESS ENTRY      @Z40LPPK*/ 02295000
*          UCBVOLI = UCBVOLI && UCBVOLI; /* ZERO OUT THE VOLSER      */ 02296000
         XC    UCBVOLI(6,UCBPTR),UCBVOLI(UCBPTR)                03S0486 02297000
*          UCBBPUB = OFF;              /*RESET PUBLIC ATTRIBUTE      */ 02298000
*          UCBBPRV = OFF;              /*RESET PRIVATE ATTRIBUTE     */ 02299000
         NI    UCBBPUB(UCBPTR),B'11100111'                      03S0488 02300000
*          UCBMOUNT = OFF;             /*RESET MOUNT PENDING         */ 02301000
         NI    UCBMOUNT(UCBPTR),B'01111111'                     03S0489 02302000
*          UCBMMSGP = OFF;         /* RESET MOUNT MESSAGE       03S0490 02303000
*                                     PENDING INDICATOR      @ZA18110*/ 02304000
         NI    UCBMMSGP(UCBPTR),B'11111011'                     03S0490 02305000
*        END;                          /* DONE ENTRY         @Z40LPPK*/ 02306000
*      ELSE;                           /* UCB VOLSER CHANGED @Z40LPPK*/ 02307000
@RF00484 DS    0H                                               03S0493 02308000
*    END;                              /* DONE ENTRY         @Z40LPPK*/ 02309000
*  ELSE;                               /* UCB/GRP NOT LOCKED @Z40LPPK*/ 02310000
@RF00481 DS    0H                                               03S0495 02311000
*  LOKINDEX = LOKINDEX + ONE;          /* NXT UCB LIST ENTRY @Z40LPPK*/ 02312000
         AL    LOKINDEX,@CF00056                                03S0495 02313000
*END;                                  /* END PROCESS ALL ENTRIES    */ 02314000
         AL    SERCTR,@CF00056                                  03S0496 02315000
@DE00480 C     SERCTR,FFSERCTR                                  03S0496 02316000
         BNH   @DL00480                                         03S0496 02317000
*     DO; /* SETLOCK (RELEASE) TYPE(CMS) REGS(USE) RELATED(UCBS,IEFBB41 02318000
*(VOLCLNP)) */                                                  02S0497 02319000
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) RSTD;                 02S0498 02320000
*       RFY (GPR15P,GPR00P,GPR01P) RSTD;                        02S0499 02321000
*       GPR15P = GPR11P; /* SAVE REG. 11 IN REG. 15. */         02S0500 02322000
         LR    GPR15P,GPR11P                                    02S0500 02323000
*       GPR00P = GPR12P; /* SAVE REG. 12 IN REG. 0. */          02S0501 02324000
         LR    GPR00P,GPR12P                                    02S0501 02325000
*       GPR01P = GPR13P; /* SAVE REG. 13 IN REG. 1. */          02S0502 02326000
         LR    GPR01P,GPR13P                                    02S0502 02327000
*       GPR13P = PSALITA; /* ADDRESS OF LOCK INTERFACE TABLE. */        02328000
         L     GPR13P,PSALITA                                   02S0503 02329000
*       GEN(LM GPR11P,GPR13P,552(GPR13P)); /* LOAD LOCKWORD, CLHT AND E 02330000
*TRY ADRS. */                                                   02S0504 02331000
         LM GPR11P,GPR13P,552(GPR13P)                                   02332000
*       GEN(BALR GPR14P,GPR13P); /* BALR TO SETLOCK RTN. */     02S0505 02333000
         BALR GPR14P,GPR13P                                             02334000
*       GPR11P = GPR15P; /* RESTORE REG. 11. */                 02S0506 02335000
         LR    GPR11P,GPR15P                                    02S0506 02336000
*       GPR15P = GPR13P; /* SAVE RETURN CODE. */                02S0507 02337000
         LR    GPR15P,GPR13P                                    02S0507 02338000
*       GPR12P = GPR00P; /* RESTORE REG. 12 */                  02S0508 02339000
         LR    GPR12P,GPR00P                                    02S0508 02340000
*       GPR13P = GPR01P; /* RESTORE REG. 13. */                 02S0509 02341000
         LR    GPR13P,GPR01P                                    02S0509 02342000
*       RFY(GPR15P,GPR00P,GPR01P) UNRSTD;                       02S0510 02343000
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) UNRSTD;               02S0511 02344000
*     END; /* SETLOCK (RELEASE) TYPE(CMS) REGS(USE) RELATED(UCBS,IEFBB4 02345000
*6(VOLCLNP)) */                                                 02S0512 02346000
*     DO; /* SETLOCK (RELEASE) TYPE(LOCAL) REGS(USE) RELATED(UCBS,IEFBB 02347000
*16(VOLCLNP)) */                                                02S0513 02348000
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) RSTD;                 02S0514 02349000
*       RFY (GPR15P,GPR00P,GPR01P) RSTD;                        02S0515 02350000
*       GPR15P = GPR11P; /* SAVE REG. 11 IN REG. 15. */         02S0516 02351000
         LR    GPR15P,GPR11P                                    02S0516 02352000
*       GPR00P = GPR12P; /* SAVE REG. 12 IN REG. 0. */          02S0517 02353000
         LR    GPR00P,GPR12P                                    02S0517 02354000
*       GPR01P = GPR13P; /* SAVE REG. 13 IN REG. 1. */          02S0518 02355000
         LR    GPR01P,GPR13P                                    02S0518 02356000
*       GPR13P = PSALITA; /* ADDRESS OF LOCK INTERFACE TABLE. */        02357000
         L     GPR13P,PSALITA                                   02S0519 02358000
*       GEN(LM GPR11P,GPR13P,588(GPR13P)); /* LOAD LOCKWORD, CLHT AND E 02359000
*TRY ADRS. */                                                   02S0520 02360000
         LM GPR11P,GPR13P,588(GPR13P)                                   02361000
*       GEN(BALR GPR14P,GPR13P); /* BALR TO SETLOCK RTN. */     02S0521 02362000
         BALR GPR14P,GPR13P                                             02363000
*       GPR11P = GPR15P; /* RESTORE REG. 11. */                 02S0522 02364000
         LR    GPR11P,GPR15P                                    02S0522 02365000
*       GPR15P = GPR13P; /* SAVE RETURN CODE. */                02S0523 02366000
         LR    GPR15P,GPR13P                                    02S0523 02367000
*       GPR12P = GPR00P; /* RESTORE REG. 12 */                  02S0524 02368000
         LR    GPR12P,GPR00P                                    02S0524 02369000
*       GPR13P = GPR01P; /* RESTORE REG. 13. */                 02S0525 02370000
         LR    GPR13P,GPR01P                                    02S0525 02371000
*       RFY(GPR15P,GPR00P,GPR01P) UNRSTD;                       02S0526 02372000
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) UNRSTD;               02S0527 02373000
*     END; /* SETLOCK (RELEASE) TYPE(LOCAL) REGS(USE) RELATED(UCBS,IEFB 02374000
*416(VOLCLNP)) */                                               02S0528 02375000
*     DO; /*MODESET  EXTKEY(SCHED)*/                            02S0529 02376000
*       SPKA (16); /*SET PSW KEY*/                              02S0530 02377000
         LA    @08,16                                           02S0530 02378000
         SPKA  0(@08)                                           02S0530 02379000
*     END; /*MODESET  EXTKEY(SCHED)*/           /* GET SCHEDULER KEY BA 02380000
*K     */                                                       02S0531 02381000
*    LOCKFMAP = LOCKFMAP && LOCKFMAP;  /* CLEAR FUNCTION MAP @Z40LPPK*/ 02382000
         XC    LOCKFMAP(1),LOCKFMAP                             02S0532 02383000
*    LOCKFREE = ON;                    /* FREE LOCKED GROUPS @Z40LPPK*/ 02384000
         OI    LOCKFREE,B'01000000'                             02S0533 02385000
*    CALL IEFAB4EC                     /* TERMINATE GROUP LOCKING       02386000
*                                         SERVICE ROUTINE    @Z40LPPK*/ 02387000
*       (LOCKFMAP,LOKLISTP,GRPMASKP,JSCBPTR,LOKWORKP); /*    @Z40LPPK*/ 02388000
         LA    @08,LOCKFMAP                                     02S0534 02389000
         ST    @08,@AL00001                                     02S0534 02390000
         LA    @08,LOKLISTP                                     02S0534 02391000
         ST    @08,@AL00001+4                                   02S0534 02392000
         LA    @08,GRPMASKP                                     02S0534 02393000
         ST    @08,@AL00001+8                                   02S0534 02394000
         L     @08,@PC00001+4                                   02S0534 02395000
         ST    @08,@AL00001+12                                  02S0534 02396000
         LA    @08,LOKWORKP                                     02S0534 02397000
         ST    @08,@AL00001+16                                  02S0534 02398000
         L     @15,@CV00189                                     02S0534 02399000
         LA    @01,@AL00001                                     02S0534 02400000
         BALR  @14,@15                                          02S0534 02401000
*  END;                                                         02S0535 02402000
*DO VOLCTR = ONE TO TOTVOLS;           /* SCAN VOL LIST FOR     02S0536 02403000
*                                         NON-SPECIFIC TAPE SERIALS OR  02404000
*                                        VIRTUAL VOLUMES     @Y30LPPG*/ 02405000
@RF00377 LA    VOLCTR,1                                         02S0536 02406000
         B     @DE00536                                         02S0536 02407000
@DL00536 DS    0H                                               02S0537 02408000
*  IF VOLFNDSW(VOLCTR) = OFF THEN      /* VOL WAS NOT FOUND MOUNTED  */ 02409000
         L     @08,VOLCOREP                                     02S0537 02410000
         LR    @02,VOLCTR                                       02S0537 02411000
         SLA   @02,4                                            02S0537 02412000
         ST    @02,@TF00001                                     02S0537 02413000
         ALR   @02,@08                                          02S0537 02414000
         AL    @02,@CF01959                                     02S0537 02415000
         TM    VOLFNDSW(@02),B'00100000'                        02S0537 02416000
         BNZ   @RF00537                                         02S0537 02417000
*    IF VOLTYPE(VOLCTR) = NSTAPE |     /*NON-SPECIFIC TAPE   @Y30LPPG*/ 02418000
*       VOLUNLD(VOLCTR) = ON |         /*VOL UNLOADED WITH KEEP 02S0538 02419000
*                                        MSG                 @ZD03010*/ 02420000
*       VOLVIRSW(VOLCTR) = ON THEN     /*OR VIRTUAL VOLUME   @Y30LPPG*/ 02421000
         LR    @02,@08                                          02S0538 02422000
         AL    @02,@TF00001                                     02S0538 02423000
         AL    @02,@CF01958                                     02S0538 02424000
         CLI   VOLTYPE-2(@02),X'FF'                             02S0538 02425000
         BE    @RT00538                                         02S0538 02426000
         AL    @08,@TF00001                                     02S0538 02427000
         AL    @08,@CF01959                                     02S0538 02428000
         TM    VOLUNLD(@08),B'01010000'                         02S0538 02429000
         BZ    @RF00538                                         02S0538 02430000
@RT00538 DS    0H                                               02S0539 02431000
*      DO;                                                      02S0539 02432000
*        VOLIGNOR(VOLCTR) = ON;        /*DO NOT WRITE RELEASE MSG    */ 02433000
         LR    @08,VOLCTR                                       02S0540 02434000
         SLA   @08,4                                            02S0540 02435000
         L     @02,VOLCOREP                                     02S0540 02436000
         ALR   @02,@08                                          02S0540 02437000
         AL    @02,@CF01959                                     02S0540 02438000
         OI    VOLIGNOR(@02),B'10000000'                        02S0540 02439000
*        RLSECTR = RLSECTR - ONE;      /*DECREMENT NO. MSGS NEEDED   */ 02440000
         L     @08,RLSECTR                                      02S0541 02441000
         BCTR  @08,0                                            02S0541 02442000
         ST    @08,RLSECTR                                      02S0541 02443000
*      END;                                                     02S0542 02444000
*END;                                                           02S0543 02445000
@RF00538 DS    0H                                               02S0543 02446000
@RF00537 AL    VOLCTR,@CF00056                                  02S0543 02447000
@DE00536 CR    VOLCTR,TOTVOLS                                   02S0543 02448000
         BNH   @DL00536                                         02S0543 02449000
*IF RLSECTR ^= ZERO THEN               /* BUILD RELEASE VOLUMES MSG  */ 02450000
         L     @15,RLSECTR                                      02S0544 02451000
         LTR   @15,@15                                          02S0544 02452000
         BZ    @RF00544                                         02S0544 02453000
*  DO;                                 /* BUILD THE MESSAGE          */ 02454000
*/********************************************************************/ 02455000
*/*                                                                  */ 02456000
*/* SEGMENT NAME - RLSEMSG                                           */ 02457000
*/*                                                                  */ 02458000
*/* DESCRIPTIVE NAME - BUILD AND ISSUE THE 'RELEASE' MESSAGE         */ 02459000
*/*                                                                  */ 02460000
*/* FUNCTION -                                                       */ 02461000
*/*   THE FUNCTION OF THIS SEGMENT IS TO ISSUE THE 'FOLLOWING        */ 02462000
*/*   VOLUMES NO LONGER NEEDED BY JJJJJJJJ' (RELEASE)                */ 02463000
*/*   MESSAGE. EACH VOLUME SERIAL IN THE VOLUME LIST WHICH           */ 02464000
*/*   DOES NOT HAVE THE UNLOADED OR IGNORE ENTRY INDICATORS          */ 02465000
*/*   ON IS INCLUDED IN THIS MESSAGE. A MULTI-LINE WTO (MLWTO)       */ 02466000
*/*   IS USED TO ISSUE THE MESSAGE.                                  */ 02467000
*/*                                                                  */ 02468000
*/*   OPERATION -                                                    */ 02469000
*/*     THE TOTAL NUMBER OF LINES NEEDED FOR THIS MESSAGE            */ 02470000
*/*     (NOT INCLUDING THE HEADER LINE) IS GIVEN BY:                 */ 02471000
*/*        TOTLINES = (RLSECTR + VOLSPERL - ONE)/VOLSPERL            */ 02472000
*/*        WHERE:                                                    */ 02473000
*/*          RLSECTR IS THE TOTAL NUMBER OF VOLSERS TO APPEAR        */ 02474000
*/*            IN THE MESSAGE                                        */ 02475000
*/*          VOLSPERL IS THE NUMBER OF VOLSERS THAT WILL FIT         */ 02476000
*/*            IN ONE LINE                                           */ 02477000
*/*                                                                  */ 02478000
*/*     CORE IS GOTTEN FOR THE BASIC SECTION OF THE WTO PARAMETER    */ 02479000
*/*     LIST PLUS TOTLINE * LENGTH OF EACH LINE SECTION.             */ 02480000
*/*     THE WTO PARAMETER LIST IS THEN CONSTRUCTED. MCSFLAGS         */ 02481000
*/*     FOR ROUT/DESC CODES AND MLWTO ARE SET. ROUT CODES            */ 02482000
*/*     FOR MASTER CONSOLE, TAPE POOL, AND DA POOL ARE SET.          */ 02483000
*/*     DESC CODE FOR SYSTEM STATUS IS SET. THE HEADER LINE TYPE     */ 02484000
*/*     IS SET TO LABEL LINE AND ALL OTHER LINE TYPES ARE SET TO     */ 02485000
*/*     DATA LINES. THE LINE TYPE OF THE LAST LINE IS ALSO SET       */ 02486000
*/*     TO END LINE.                                                 */ 02487000
*/*                                                                  */ 02488000
*/*     AFTER THE MESSAGE HAS BEEN CONSTRUCTED, THE WTO IS ISSUED    */ 02489000
*/*     AND THE CORE USED TO BUILD THE MESSAGE IS FREED.             */ 02490000
*/*                                                                  */ 02491000
*/* ENTRY - IN-LINE SEGMENT                                          */ 02492000
*/*   PURPOSE - SEE FUNCTION                                         */ 02493000
*/*   INPUT -                                                        */ 02494000
*/*     VLISTENT - VOLUME LIST ENTRY                                 */ 02495000
*/*       VOLIGNOR - IGNORE ENTRY INDICATOR                          */ 02496000
*/*       VOLUNLD - VOLUME WAS UNLOADED                              */ 02497000
*/*     JCT -                                                        */ 02498000
*/*       JCTJNAME - JOB NAME                                        */ 02499000
*/*                                                                  */ 02500000
*/* EXIT -                                                           */ 02501000
*/* 1 CONDITION - NORMAL COMPLETION                                  */ 02502000
*/*     OUTPUT -                                                     */ 02503000
*/*       MESSAGE ISSUED                                             */ 02504000
*/*     RETURN CODE -                                                */ 02505000
*/*       RETCODE = 0                                                */ 02506000
*/*                                                                  */ 02507000
*/* 2 CONDITION - CORE NOT AVAILABLE FOR WTO PARM LIST               */ 02508000
*/*     OUTPUT -                                                     */ 02509000
*/*       REASON CODE -                                              */ 02510000
*/*         RESNCODE = 1                                             */ 02511000
*/*     RETURN CODE -                                                */ 02512000
*/*       RETCODE = 4                                                */ 02513000
*/*                                                                  */ 02514000
*/********************************************************************/ 02515000
*MSGGLNTH = LENGTH(WPL) + LENGTH(WPLFLGS) + LENGTH(WPLLS01) +   03S0546 02516000
*    ((RLSECTR + VOLSPERL - ONE)/VOLSPERL) * LENGTH(WPLML); /* CORE     02517000
*                                         FOR WTO PARM LIST          */ 02518000
         L     @08,VOLSPERL                                     03S0546 02519000
         LR    @00,@15                                          03S0546 02520000
         ALR   @00,@08                                          03S0546 02521000
         BCTR  @00,0                                            03S0546 02522000
         SRDA  @00,32                                           03S0546 02523000
         DR    @00,@08                                          03S0546 02524000
         MH    @01,@CH01929                                     03S0546 02525000
         AH    @01,@CH01931                                     03S0546 02526000
         ST    @01,MSGGLNTH                                     03S0546 02527000
* /* ?GETSTORG (SPID,MSGGLNTH,WPLPTR);*/                        03S0547 02528000
*   RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/               03S0547 02529000
*   GTSTR0 = MSGGLNTH; /* SET AMOUNT*/                          03S0548 02530000
         L     @08,MSGGLNTH                                     03S0548 02531000
         LR    GTSTR0,@08                                       03S0548 02532000
*   GTSTR2 = SPID; /* SET SUBPOOL*/                             03S0549 02533000
         LA    GTSTR2,230                                       03S0549 02534000
*   GENERATE CODE;                                              03S0550 02535000
     GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN                               02536000
*   GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/               03S0551 02537000
         ST    GTSTR15,GTSTRTCD                                 03S0551 02538000
*   WPLPTR = GTSTR1; /* ADDR OF GOTN STORG*/                    03S0552 02539000
         LR    WPLPTR,GTSTR1                                    03S0552 02540000
*   RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */                03S0553 02541000
*   IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */               03S0554 02542000
         L     @08,GTSTRTCD                                     03S0554 02543000
         LTR   @08,@08                                          03S0554 02544000
         BNZ   @RF00554                                         03S0554 02545000
*     DO;               /* YES, CLEAR STORAGE.*/                03S0555 02546000
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       03S0556 02547000
*                          GTSTR7,GTSTR8) RSTD;                 03S0556 02548000
*       GTSTR4 = WPLPTR; /*STORG PTR*/                          03S0557 02549000
         LR    GTSTR4,WPLPTR                                    03S0557 02550000
*       GTSTR5 = MSGGLNTH; /*STORG AMNT*/                       03S0558 02551000
         L     GTSTR5,MSGGLNTH                                  03S0558 02552000
*       GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/               03S0559 02553000
         SLR   GTSTR7,GTSTR7                                    03S0559 02554000
*       IF SPID = GTST253 THEN                                  03S0560 02555000
         B     @RF00560                                         03S0560 02556000
*      GEN                                                      03S0561 02557000
*   (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);           03S0561 02558000
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8                 02559000
*       GEN REFS(GTSTR4,GTSTR6);                                03S0562 02560000
@RF00560 DS    0H                                               03S0562 02561000
          MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG                        02562000
*       IF SPID = GTST253 THEN                                  03S0563 02563000
         B     @RF00563                                         03S0563 02564000
*         GEN (MODESET KEYADDR=(2));                            03S0564 02565000
         MODESET KEYADDR=(2)                                            02566000
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       03S0565 02567000
*                          GTSTR7,GTSTR8) UNRSTD;               03S0565 02568000
@RF00563 DS    0H                                               03S0566 02569000
*     END;       /* STORAGE CLEARING COMPLETED */               03S0566 02570000
*   ELSE                                                        03S0567 02571000
*   WPLPTR= 0;   /* CLEAR RETURN ADDR. */                       03S0567 02572000
         B     @RC00554                                         03S0567 02573000
@RF00554 SLR   WPLPTR,WPLPTR                                    03S0567 02574000
*   GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */               03S0568 02575000
@RC00554 L     GTSTR15,GTSTRTCD                                 03S0568 02576000
*                                      /* RESTORE LIST PRINT STATUS  */ 02577000
*     /* GET CORE FOR WTO LIST      */                          03S0569 02578000
*IF REG15 = ZERO THEN                  /* CORE WAS GOTTEN            */ 02579000
         LTR   REG15,REG15                                      03S0569 02580000
         BNZ   @RF00569                                         03S0569 02581000
*  DO;                                 /* BUILD THE MESSAGE          */ 02582000
*    WPLMCSFA = ON;                    /* ROUT/DESC CODES PRESENT    */ 02583000
         OI    WPLMCSFA(WPLPTR),B'10000000'                     03S0571 02584000
*    WPLMCSFJ = ON;                    /* MULTI-LINE WTO             */ 02585000
         OI    WPLMCSFJ(WPLPTR),B'01000000'                     03S0572 02586000
*    WPLTXT(1:RLSEHDRL) = RLSEHDRM(1:RLSEHDRL); /* MOVE MSG HEADER IN*/ 02587000
         L     @08,@CA00193                                     03S0573 02588000
         LH    @05,RLSEHDRL-RLSEHDR(,@08)                       03S0573 02589000
         LR    @15,@05                                          03S0573 02590000
         BCTR  @15,0                                            03S0573 02591000
         EX    @15,@SM01965                                     03S0573 02592000
*    MSGLNTH = RLSEHDRL;               /* MOVE LENGTH TO LOCAL AREA  */ 02593000
         ST    @05,MSGLNTH                                      03S0574 02594000
*    RLSEJNAM = JCTJNAME;              /* PUT JOB NAME IN MSG        */ 02595000
         LA    @05,WPLTXT(,WPLPTR)                              03S0575 02596000
         LH    @08,RLSEJBND-RLSEHDR(,@08)                       03S0575 02597000
         ALR   @08,@05                                          03S0575 02598000
         L     @15,@PC00001+8                                   03S0575 02599000
         L     @01,JCTPTR(,@15)                                 03S0575 02600000
         MVC   RLSEJNAM(8,@08),JCTJNAME(@01)                    03S0575 02601000
*    CALL IEFAB4F3(ADDR(WPLTXT),MSGLNTH,CMSGLNTH); /* COMPRESS BLANKS*/ 02602000
         ST    @05,@TF00001                                     03S0576 02603000
         LA    @08,@TF00001                                     03S0576 02604000
         ST    @08,@AL00001                                     03S0576 02605000
         LA    @08,MSGLNTH                                      03S0576 02606000
         ST    @08,@AL00001+4                                   03S0576 02607000
         LA    @08,CMSGLNTH                                     03S0576 02608000
         ST    @08,@AL00001+8                                   03S0576 02609000
         L     @15,@CV00190                                     03S0576 02610000
         LA    @01,@AL00001                                     03S0576 02611000
         BALR  @14,@15                                          03S0576 02612000
*    WPLLGH = CMSGLNTH + LWTOBYTS;     /* SET WPL LENGTH (FIRST LINE)*/ 02613000
         LA    @08,4                                            03S0577 02614000
         L     @05,CMSGLNTH                                     03S0577 02615000
         ALR   @05,@08                                          03S0577 02616000
         STH   @05,WPLLGH(,WPLPTR)                              03S0577 02617000
*    WPLFLGS = WPLFLGS && WPLFLGS;     /* CLEAR WPL FLAGS            */ 02618000
         ALR   @05,WPLPTR                                       03S0578 02619000
         XC    WPLFLGS(8,@05),WPLFLGS(@05)                      03S0578 02620000
*    WPLDESCD = ON;                    /* DESC = SYSTEM STATUS       */ 02621000
         OI    WPLDESCD(@05),B'00010000'                        03S0579 02622000
*    WPLROUTB = ON;                    /* ROUT = MSTR CONSL INFO     */ 02623000
*    WPLROUTC = ON;                    /* ROUT = TAPE POOL           */ 02624000
*    WPLROUTD = ON;                    /* ROUT = DA POOL             */ 02625000
         OI    WPLROUTB(@05),B'01110000'                        03S0582 02626000
*    WPLLS01 = WPLLS01 && WPLLS01;     /* CLEAR MLWTO EXTENSION      */ 02627000
         ALR   @08,@05                                          03S0583 02628000
         XC    WPLLS01(4,@08),WPLLS01(@08)                      03S0583 02629000
*    WPLLTFB = ON;                     /* LINE TYPE = LABEL          */ 02630000
         OI    WPLLTFB(@08),B'01000000'                         03S0584 02631000
*    WPLLINES = (RLSECTR+VOLSPERL-ONE)/VOLSPERL + ONE; /* NUMBER        02632000
*                                         OF LINES                   */ 02633000
         LA    @15,1                                            03S0585 02634000
         L     @14,VOLSPERL                                     03S0585 02635000
         L     @00,RLSECTR                                      03S0585 02636000
         ALR   @00,@14                                          03S0585 02637000
         BCTR  @00,0                                            03S0585 02638000
         SRDA  @00,32                                           03S0585 02639000
         DR    @00,@14                                          03S0585 02640000
         ALR   @01,@15                                          03S0585 02641000
         STC   @01,WPLLINES(,@08)                               03S0585 02642000
*    LINEPTR = ADDR(WPLLS01) + LENGTH(WPLLS01); /* ADDR OF FIRST LINE*/ 02643000
         AH    @05,@CH00054                                     03S0586 02644000
         LR    LINEPTR,@05                                      03S0586 02645000
*    VOLCTR = ONE;                     /* VOLLIST INDEX INITIALIZED  */ 02646000
         LR    VOLCTR,@15                                       03S0587 02647000
*    TOTSERCT = ZERO;                  /* TOTAL SERS IN MESSAGE      */ 02648000
         SLR   TOTSERCT,TOTSERCT                                03S0588 02649000
*    DO WHILE (TOTSERCT < RLSECTR);    /* LOOP THRU VOLLIST          */ 02650000
         B     @DE00589                                         03S0589 02651000
@DL00589 DS    0H                                               03S0590 02652000
*      SERCTR = ONE;                   /* INIT SERS IN LINE          */ 02653000
         LA    SERCTR,1                                         03S0590 02654000
*      WPLML0 = WPLML0 && WPLML0;      /* ZERO OUT WPL INFO          */ 02655000
         SLR   @08,@08                                          03S0591 02656000
         IC    @08,WPLML0(,LINEPTR)                             03S0591 02657000
         LR    @15,@08                                          03S0591 02658000
         XR    @15,@08                                          03S0591 02659000
         STC   @15,WPLML0(,LINEPTR)                             03S0591 02660000
*      WPLMLLTF = WPLMLLTF && WPLMLLTF; /* ZERO OUT WPL INFO         */ 02661000
         XC    WPLMLLTF(2,LINEPTR),WPLMLLTF(LINEPTR)            03S0592 02662000
*      WPLMLLTC = ON;                  /* LINE TYPE = DATA LINE      */ 02663000
         OI    WPLMLLTC(LINEPTR),B'00100000'                    03S0593 02664000
*      LINEHDR = BLANKS;               /* BLANK OUT BEGINNING OF LINE*/ 02665000
         MVC   LINEHDR+4(8,LINEPTR),BLANKS                      03S0594 02666000
*      WPLMLLEN = LENGTH(LINEHDR) + LMLBYTS; /* INIT WPL ML LENGTH   */ 02667000
         MVI   WPLMLLEN(LINEPTR),X'0C'                          03S0595 02668000
*      DO WHILE (SERCTR <= VOLSPERL &  /* DO UNTIL LINE IS FULL      */ 02669000
*          TOTSERCT < RLSECTR);        /* STOP WHEN VOLLIST EMPTY    */ 02670000
         B     @DE00596                                         03S0596 02671000
@DL00596 DS    0H                                               03S0597 02672000
*        IF VOLIGNOR(VOLCTR) = OFF &   /* VOL NOT MARKED IGNORE      */ 02673000
*            VOLUNLD(VOLCTR) = OFF THEN/* VOL NOT UNLOADED           */ 02674000
         L     @08,VOLCOREP                                     03S0597 02675000
         LR    @15,VOLCTR                                       03S0597 02676000
         SLA   @15,4                                            03S0597 02677000
         ST    @15,@TF00001                                     03S0597 02678000
         ALR   @15,@08                                          03S0597 02679000
         AL    @15,@CF01959                                     03S0597 02680000
         TM    VOLIGNOR(@15),B'11000000'                        03S0597 02681000
         BNZ   @RF00597                                         03S0597 02682000
*          DO;                         /* PUT VOLSER IN LINE         */ 02683000
*            TOTSERCT = TOTSERCT + ONE;/* BUMP TOTAL SERS IN MSG     */ 02684000
         AL    TOTSERCT,@CF00056                                03S0599 02685000
*            LINESER(SERCTR) = VOLSER(VOLCTR); /* MOVE VOLSER TO MSG */ 02686000
         LR    @15,SERCTR                                       03S0600 02687000
         MH    @15,@CH00119                                     03S0600 02688000
         LA    @14,4                                            03S0600 02689000
         ALR   @14,LINEPTR                                      03S0600 02690000
         ST    @15,@TF00002                                     03S0600 02691000
         ALR   @15,@14                                          03S0600 02692000
         AL    @08,@TF00001                                     03S0600 02693000
         AL    @08,@CF01958                                     03S0600 02694000
         MVC   LINESER-7(6,@15),VOLSER-2(@08)                   03S0600 02695000
*            IF TOTSERCT = RLSECTR THEN/* LAST VOLSER IN MSG         */ 02696000
         C     TOTSERCT,RLSECTR                                 03S0601 02697000
         BNE   @RF00601                                         03S0601 02698000
*              LINEDELM(SERCTR) = POINT; /* BLANK DELIMITER          */ 02699000
         AL    @14,@TF00002                                     03S0602 02700000
         MVI   LINEDELM-7(@14),C'.'                             03S0602 02701000
*            ELSE                      /* NOT LAST VOLSER IN MSG     */ 02702000
*              LINEDELM(SERCTR) = COMMA; /* COMMA DELIMITER          */ 02703000
         B     @RC00601                                         03S0603 02704000
@RF00601 LR    @08,SERCTR                                       03S0603 02705000
         MH    @08,@CH00119                                     03S0603 02706000
         ALR   @08,LINEPTR                                      03S0603 02707000
         MVI   LINEDELM-3(@08),C','                             03S0603 02708000
*            WPLMLLEN = WPLMLLEN +     /* BUMP LENGTH OF LINE        */ 02709000
*               LENGTH(LINESER) + LENGTH(LINEDELM);             03S0604 02710000
@RC00601 LA    @08,7                                            03S0604 02711000
         SLR   @15,@15                                          03S0604 02712000
         IC    @15,WPLMLLEN(,LINEPTR)                           03S0604 02713000
         ALR   @08,@15                                          03S0604 02714000
         STC   @08,WPLMLLEN(,LINEPTR)                           03S0604 02715000
*            SERCTR = SERCTR + ONE;    /* BUMP TO NEXT SER IN LINE   */ 02716000
         AL    SERCTR,@CF00056                                  03S0605 02717000
*          END;                        /* END PUT VOLSERS IN LINE    */ 02718000
*        VOLCTR = VOLCTR + ONE;        /* NEXT VOLSER IN VOLLIST     */ 02719000
@RF00597 AL    VOLCTR,@CF00056                                  03S0607 02720000
*      END;                            /* END DO UNTIL LINE IS FULL  */ 02721000
@DE00596 C     SERCTR,VOLSPERL                                  03S0608 02722000
         BH    @DC00596                                         03S0608 02723000
         C     TOTSERCT,RLSECTR                                 03S0608 02724000
         BL    @DL00596                                         03S0608 02725000
@DC00596 DS    0H                                               03S0609 02726000
*      IF TOTSERCT = RLSECTR THEN      /* LAST LINE IN MSG           */ 02727000
         C     TOTSERCT,RLSECTR                                 03S0609 02728000
         BNE   @RF00609                                         03S0609 02729000
*        WPLMLLTD = ON;                /* LINE TYPE = END LINE       */ 02730000
         OI    WPLMLLTD(LINEPTR),B'00010000'                    03S0610 02731000
*      ELSE                            /* NOT LAST LINE              */ 02732000
*        LINEPTR = LINEPTR + WPLMLLEN; /* GET NEXT LINE              */ 02733000
         B     @RC00609                                         03S0611 02734000
@RF00609 SLR   @08,@08                                          03S0611 02735000
         IC    @08,WPLMLLEN(,LINEPTR)                           03S0611 02736000
         ALR   LINEPTR,@08                                      03S0611 02737000
*    END;                              /* END LOOP THRU VOLLIST      */ 02738000
@RC00609 DS    0H                                               03S0612 02739000
@DE00589 C     TOTSERCT,RLSECTR                                 03S0612 02740000
         BL    @DL00589                                         03S0612 02741000
*    RFY (REG0,REG1) RSTD;             /* RESERVE REGISTERS          */ 02742000
*    REG0 = ZERO;                      /* INTERFACE TO WTO           */ 02743000
         SLR   REG0,REG0                                        03S0614 02744000
*    REG1 = ADDR(WPL);                 /* INTERFACE TO WTO           */ 02745000
         LR    REG1,WPLPTR                                      03S0615 02746000
*    GEN REFS(REG0,REG1)               /* ISSUE THE MESSAGE          */ 02747000
*        (WTO MF=(E,(1)));                                      03S0616 02748000
         WTO MF=(E,(1))                                                 02749000
*    REG0 = MSGGLNTH;                  /* LENGTH OF GOTTEN CORE      */ 02750000
         L     REG0,MSGGLNTH                                    03S0617 02751000
*    REG0 = REG0 | SUBPL230;           /*SUBPOOL NO.                 */ 02752000
         O     REG0,@CF00180                                    03S0618 02753000
*    REG1 = WPLPTR;                    /* ADDRESS OF GOTTEN CORE     */ 02754000
         LR    REG1,WPLPTR                                      03S0619 02755000
*    GEN REFS(REG0,REG1)               /* FREE UP CORE USED FOR WPL  */ 02756000
*       (FREEMAIN R,LV=(0),A=(1));                              03S0620 02757000
         FREEMAIN R,LV=(0),A=(1)                                        02758000
*    RFY (REG0,REG1) UNRSTD;           /* RELEASE REGISTERS          */ 02759000
*  END;                                /* END BUILD MESSAGE          */ 02760000
*ELSE                                  /* CORE NOT GOTTEN            */ 02761000
*  DO;                                 /* SET RETURN AND REASON CODES*/ 02762000
         B     @RC00569                                         03S0623 02763000
@RF00569 DS    0H                                               03S0624 02764000
*    RETCODE = ERROR;                  /* BAD RETURN CODE            */ 02765000
         MVC   RETCODE(2),@CH00098                              03S0624 02766000
*    RESNCODE = GETERROR;              /* GETMAIN ERROR              */ 02767000
         L     @15,@PC00001+20                                  03S0625 02768000
         MVC   RESNCODE(2,@15),@CH00056                         03S0625 02769000
*  END;                                /* END SET RETN & RESN CODES  */ 02770000
*  END;                                /* END BUILD THE MESSAGE      */ 02771000
@RC00569 DS    0H                                               02S0628 02772000
*RFY (REG0,REG1) RSTD;                 /* RESERVE REGISTERS          */ 02773000
@RF00544 DS    0H                                               02S0629 02774000
*IF VOLCOREP ^= ZERO THEN              /* CORE WAS GOTTEN            */ 02775000
         L     @15,VOLCOREP                                     02S0629 02776000
         LTR   @15,@15                                          02S0629 02777000
         BZ    @RF00629                                         02S0629 02778000
*  DO;                                 /* FREE THE GOTTEN CORE       */ 02779000
*    REG0 = VOLCOREL;                  /* ELNGTH TO FREE             */ 02780000
         L     REG0,VOLCOREL                                    02S0631 02781000
*    REG0 = REG0 | SUBPL230;           /*SUBPOOL NO.                 */ 02782000
         O     REG0,@CF00180                                    02S0632 02783000
*    REG1 = VOLCOREP;                  /* ADDRESS TO FREE            */ 02784000
         LR    REG1,@15                                         02S0633 02785000
*    GEN REFS(REG0,REG1)               /* FREE THE VOLUME LIST CORE  */ 02786000
*       (FREEMAIN R,LV=(0),A=(1));                              02S0634 02787000
         FREEMAIN R,LV=(0),A=(1)                                        02788000
*  END;                                /* END FREE GOTTEN CORE       */ 02789000
*RFY (REG0,REG1) UNRSTD;               /* RELEASE REGISTERS          */ 02790000
@RF00629 DS    0H                                               02S0637 02791000
*IF FRBPTR ^= ZERO THEN                /* COMMON RBS EXIST           */ 02792000
         L     @15,FRBPTR                                       01S0637 02793000
         LTR   @15,@15                                          01S0637 02794000
         BZ    @RF00637                                         01S0637 02795000
*  DO;                                 /* FREE CORE FOR RBS          */ 02796000
*    RFY (REG0,REG1) RSTD;             /* RESERVE REGISTERS          */ 02797000
*    REG0 = GETLENTH;                  /* LENGTH TO FREE             */ 02798000
         L     REG0,GETLENTH                                    01S0640 02799000
*    REG0 = REG0 | SUBPL230;           /*SUBPOOL NO.                 */ 02800000
         O     REG0,@CF00180                                    01S0641 02801000
*    REG1 = FRBPTR;                    /* ADDRESS OR RB CORE         */ 02802000
         LR    REG1,@15                                         01S0642 02803000
*    GEN (FREEMAIN R,LV=(0),A=(1));    /* FREE THE RBS               */ 02804000
         FREEMAIN R,LV=(0),A=(1)                                        02805000
*    RFY (REG0,REG1) UNRSTD;           /* RELEASE REGISTERS          */ 02806000
*  END;                                                         01S0645 02807000
*RETURN CODE(RETCODE);                 /* RETURN TO CALLER           */ 02808000
*                                                               01S0646 02809000
*                                                               01S0646 02810000
@RF00637 LH    @09,RETCODE                                      01S0646 02811000
         L     @13,4(,@13)                                      01S0646 02812000
         L     @00,@SIZDATD                                     01S0646 02813000
         LR    @01,@10                                          01S0646 02814000
         FSPACE   R,LV=(0),A=(1)                                        02815000
         LR    @15,@09                                          01S0646 02816000
         L     @14,12(,@13)                                     01S0646 02817000
         LM    @00,@12,20(@13)                                  01S0646 02818000
         BR    @14                                              01S0646 02819000
* DECLARE /*GENERAL PURPOSE REGISTERS */                        01S0647 02820000
*   GPR00P PTR(31) REG(0),                                      01S0647 02821000
*   GPR01P PTR(31) REG(1),                                      01S0647 02822000
*   GPR11P PTR(31) REG(11),                                     01S0647 02823000
*   GPR12P PTR(31) REG(12),                                     01S0647 02824000
*   GPR13P PTR(31) REG(13),                                     01S0647 02825000
*   GPR14P PTR(31) REG(14),                                     01S0647 02826000
*   GPR15P PTR(31) REG(15);                                     01S0647 02827000
*                                                               01S0647 02828000
* DECLARE /* COMMON VARIABLES */                                01S0648 02829000
*   I256C CHAR(256) BASED,                                      01S0648 02830000
*   I031F FIXED(31) BASED,                                      01S0648 02831000
*   I031P PTR(31)   BASED,                                      01S0648 02832000
*   I015F FIXED(15) BASED,                                      01S0648 02833000
*   I015P PTR(15)   BASED,                                      01S0648 02834000
*   I008P PTR(8)    BASED,                                      01S0648 02835000
*   I001C CHAR(1)   BASED;                                      01S0648 02836000
*END IEFBB416                                                   01S0649 02837000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02838000
*/*%INCLUDE SYSLIB  (B416SPEC)                                        * 02839000
*/*%INCLUDE SYSLIB  (B416DATA)                                        * 02840000
*/*%INCLUDE SYSLIB  (IEFAJCTB)                                        * 02841000
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        * 02842000
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                        * 02843000
*/*%INCLUDE SYSLIB  (IEFJFCBX)                                        * 02844000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                        * 02845000
*/*%INCLUDE SYSLIB  (IEFZB431)                                        * 02846000
*/*%INCLUDE SYSLIB  (IEFZB435)                                        * 02847000
*/*%INCLUDE SYSLIB  (IEFZB436)                                        * 02848000
*/*%INCLUDE SYSLIB  (IEFZB438)                                        * 02849000
*/*%INCLUDE SYSLIB  (IEFZB439)                                        * 02850000
*/*%INCLUDE SYSLIB  (IEFZB440)                                        * 02851000
*/*%INCLUDE SYSLIB  (IEZWPL  )                                        * 02852000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                        * 02853000
*/*%INCLUDE SYSLIB  (IHAASCB )                                        * 02854000
*/*%INCLUDE SYSLIB  (READPDIS)                                        * 02855000
*/*%INCLUDE SYSLIB  (READSPEC)                                        * 02856000
*/*%INCLUDE SYSLIB  (BLDCOMRB)                                        * 02857000
*/*%INCLUDE SYSLIB  (BLDCSPEC)                                        * 02858000
*/*%INCLUDE SYSLIB  (VOLCLNP )                                        * 02859000
*/*%INCLUDE SYSLIB  (VOLCSPEC)                                        * 02860000
*/*%INCLUDE SYSLIB  (BVOLLIST)                                        * 02861000
*/*%INCLUDE SYSLIB  (BVOLSPEC)                                        * 02862000
*/*%INCLUDE SYSLIB  (SCANUCBS)                                        * 02863000
*/*%INCLUDE SYSLIB  (SCANSPEC)                                        * 02864000
*/*%INCLUDE SYSLIB  (LOCKUCBS)                                        * 02865000
*/*%INCLUDE SYSLIB  (LOCKSPEC)                                        * 02866000
*/*%INCLUDE SYSLIB  (BUILDRBS)                                        * 02867000
*/*%INCLUDE SYSLIB  (BILDSPEC)                                        * 02868000
*/*%INCLUDE SYSLIB  (UPDUCBS )                                        * 02869000
*/*%INCLUDE SYSLIB  (UPDUSPEC)                                        * 02870000
*/*%INCLUDE SYSLIB  (RLSEMSG )                                        * 02871000
*/*%INCLUDE SYSLIB  (RLSESPEC)                                        * 02872000
*;                                                              01S0649 02873000
@DATA    DS    0H                                                       02874000
@CH00098 DC    H'4'                                                     02875000
@CH00119 DC    H'7'                                                     02876000
@CH00054 DC    H'8'                                                     02877000
@CH00052 DC    H'16'                                                    02878000
@CH01924 DC    H'52'                                                    02879000
@CH01659 DC    H'56'                                                    02880000
@CH01926 DC    H'72'                                                    02881000
@CH00088 DC    H'100'                                                   02882000
@CH01929 DC    H'130'                                                   02883000
@CH01931 DC    H'142'                                                   02884000
@CH01928 DC    H'404'                                                   02885000
@CH00166 DC    XL2'FFFF'                                                02886000
@SM01965 MVC   WPLTXT(0,WPLPTR),RLSEHDRM-RLSEHDR(@08)                   02887000
         DS    0F                                                       02888000
@AL00221 DC    A(@CF00184)             LIST WITH   6 ARGUMENT(S)        02889000
         DC    A(@CF00184)                                              02890000
         DC    A(@CF00184)                                              02891000
@AL00422 DC    A(@CF00184)             LIST WITH   2 ARGUMENT(S)        02892000
         DC    A(@CF00184)                                              02893000
         DC    A(@CF00056)                                              02894000
@DATD    DSECT                                                          02895000
         DS    0F                                                       02896000
@SA00001 DS    18F                                                      02897000
@PC00001 DS    7F                                                       02898000
@AL00001 DS    9A                                                       02899000
@TF00001 DS    F                                                        02900000
@TF00002 DS    F                                                        02901000
IEFBB416 CSECT                                                          02902000
         DS    0F                                                       02903000
@CF00184 DC    F'0'                                                     02904000
@CF00056 DC    F'1'                                                     02905000
@CH00056 EQU   @CF00056+2                                               02906000
@CF01959 DC    F'-16'                                                   02907000
@CF01958 DC    F'-14'                                                   02908000
@CF01961 DC    F'-8'                                                    02909000
@CF01946 DC    F'-4'                                                    02910000
@CF00180 DC    XL4'E6000000'                                            02911000
@DATD    DSECT                                                          02912000
         DS    0D                                                       02913000
FRBPTR   DS    A                                                        02914000
FPDIPTR  DS    A                                                        02915000
FSIOTP   DS    A                                                        02916000
FUNLDRBP DS    A                                                        02917000
FVUTPTR  DS    A                                                        02918000
GRPMASKP DS    A                                                        02919000
JFCBXPTR DS    A                                                        02920000
LOKLISTP DS    A                                                        02921000
LOKWORKP DS    A                                                        02922000
LPDIPTR  DS    A                                                        02923000
SIOTPTR  DS    A                                                        02924000
VOLCOREP DS    A                                                        02925000
VUTPTR   DS    A                                                        02926000
CMSGLNTH DS    F                                                        02927000
GETLENTH DS    F                                                        02928000
MSGLNTH  DS    F                                                        02929000
RLSECTR  DS    F                                                        02930000
SWBLKLN  DS    F                                                        02931000
VOLCOREL DS    F                                                        02932000
MSGGLNTH DS    F                                                        02933000
CFMAPTR  DS    A                                                        02934000
ASCBPTR  DS    A                                                        02935000
GTSTRTCD DS    F                                                        02936000
RETCODE  DS    H                                                        02937000
SWACTLS  DS    FL2                                                      02938000
         ORG   SWACTLS                                                  02939000
SWASN    DS    BL1                                                      02940000
SWDEL    EQU   SWACTLS+0                                                02941000
SWREAD   EQU   SWACTLS+0                                                02942000
SWWRT    EQU   SWACTLS+0                                                02943000
SWNEW    EQU   SWACTLS+0                                                02944000
SWFREE   EQU   SWACTLS+0                                                02945000
SWMOD    EQU   SWACTLS+0                                                02946000
SWOLD    EQU   SWACTLS+0                                                02947000
SWCHN    DS    BL1                                                      02948000
@NM00056 EQU   SWACTLS+1                                                02949000
         ORG   SWACTLS+2                                                02950000
ASID     DS    CL2                                                      02951000
         DS    CL2                                                      02952000
FFSERBLK DS    CL404                                                    02953000
         ORG   FFSERBLK                                                 02954000
FFSERCTR DS    FL4                                                      02955000
FFSERUCB DS    100F                                                     02956000
         ORG   FFSERBLK+404                                             02957000
GROUPMSK DS    CL240                                                    02958000
LOCKFMAP DS    BL1                                                      02959000
         ORG   LOCKFMAP                                                 02960000
LOCKGET  DS    BL1                                                      02961000
LOCKFREE EQU   LOCKFMAP+0                                               02962000
DDRTPUR  EQU   LOCKFMAP+0                                               02963000
DDRDA    EQU   LOCKFMAP+0                                               02964000
@NM00001 EQU   LOCKFMAP+0                                               02965000
         ORG   LOCKFMAP+1                                               02966000
SWITCHES DS    BL1                                                      02967000
         ORG   SWITCHES                                                 02968000
DUPSW    DS    BL1                                                      02969000
FIRSTSW  EQU   SWITCHES+0                                               02970000
FOUNDSW  EQU   SWITCHES+0                                               02971000
LOCKOKSW EQU   SWITCHES+0                                               02972000
NOCNDISP EQU   SWITCHES+0                                               02973000
DAUCB    EQU   SWITCHES+0                                               02974000
TPURUCB  EQU   SWITCHES+0                                               02975000
@NM00002 EQU   SWITCHES+0                                               02976000
         ORG   SWITCHES+1                                               02977000
VUTSVA   DS    CL3                                                      02978000
CFMAPCOR DS    CL4                                                      02979000
IEFBB416 CSECT                                                          02980000
         DS    0F                                                       02981000
@SIZDATD DC    AL1(230)                                                 02982000
         DC    AL3(@ENDDATD-@DATD)                                      02983000
@CV00187 DC    V(IEFAB4A0)                                              02984000
@CV00188 DC    V(IEFAB4EB)                                              02985000
@CV00189 DC    V(IEFAB4EC)                                              02986000
@CV00190 DC    V(IEFAB4F3)                                              02987000
@CV00191 DC    V(IEFAB4F7)                                              02988000
@CV00192 DC    V(IEFAB49C)                                              02989000
@CA00193 DC    A(RLSEHDR)                                               02990000
         DS    0D                                                       02991000
VOLSPERL DC    AL4(8)                                                   02992000
GTSTZERO DC    F'0'                                                     02993000
BLANKS   DC    CL8' '                                                   02994000
DEV3330  DC    X'2009'                                                  02995000
IEFBB416 CSECT                                                          02996000
         DS   0H                                                        02997000
B416PTCH DC ((@DATA-@PSTART)/20)X'00'                                   02998000
@DATD    DSECT                                                          02999000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03000000
@ENDDATD EQU   *                                                        03001000
IEFBB416 CSECT                                                          03002000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03003000
@01      EQU   01                                                       03004000
@02      EQU   02                                                       03005000
@03      EQU   03                                                       03006000
@04      EQU   04                                                       03007000
@05      EQU   05                                                       03008000
@06      EQU   06                                                       03009000
@07      EQU   07                                                       03010000
@08      EQU   08                                                       03011000
@09      EQU   09                                                       03012000
@10      EQU   10                                                       03013000
@11      EQU   11                                                       03014000
@12      EQU   12                                                       03015000
@13      EQU   13                                                       03016000
@14      EQU   14                                                       03017000
@15      EQU   15                                                       03018000
VUTCTR   EQU   @02                                                      03019000
VOLCTR   EQU   @03                                                      03020000
TVOLCTR  EQU   @04                                                      03021000
TOTVOLS  EQU   @09                                                      03022000
TOTSERCT EQU   @04                                                      03023000
SERCTR   EQU   @05                                                      03024000
PDIECTR  EQU   @04                                                      03025000
NUMREQS  EQU   @02                                                      03026000
LUTCTR   EQU   @05                                                      03027000
LOKINDEX EQU   @04                                                      03028000
LOKVOLS  EQU   @07                                                      03029000
LOCKRC   EQU   @02                                                      03030000
WPLPTR   EQU   @09                                                      03031000
VMVREQBP EQU   @06                                                      03032000
UCBPTR   EQU   @02                                                      03033000
PDIBLPTR EQU   @03                                                      03034000
LVUTPTR  EQU   @02                                                      03035000
LINEPTR  EQU   @02                                                      03036000
JFCBPTR  EQU   @05                                                      03037000
CMRBPTR  EQU   @02                                                      03038000
REG0     EQU   @00                                                      03039000
REG1     EQU   @01                                                      03040000
REG15    EQU   @15                                                      03041000
GTSTR0   EQU   @00                                                      03042000
GTSTR1   EQU   @01                                                      03043000
GTSTR2   EQU   @02                                                      03044000
GTSTR15  EQU   @15                                                      03045000
GTSTR4   EQU   @04                                                      03046000
GTSTR5   EQU   @05                                                      03047000
GTSTR6   EQU   @06                                                      03048000
GTSTR7   EQU   @07                                                      03049000
GTSTR8   EQU   @08                                                      03050000
GPR11P   EQU   @11                                                      03051000
GPR12P   EQU   @12                                                      03052000
GPR13P   EQU   @13                                                      03053000
GPR14P   EQU   @14                                                      03054000
GPR15P   EQU   @15                                                      03055000
GPR00P   EQU   @00                                                      03056000
GPR01P   EQU   @01                                                      03057000
GTSTR3   EQU   @03                                                      03058000
         EXTRN RLSEHDR                                                  03059000
PSA      EQU   0                                                        03060000
FLCRNPSW EQU   PSA                                                      03061000
FLCROPSW EQU   PSA+8                                                    03062000
FLCICCW2 EQU   PSA+16                                                   03063000
PSAEEPSW EQU   PSA+132                                                  03064000
PSAESPSW EQU   PSA+136                                                  03065000
FLCSVILC EQU   PSAESPSW+1                                               03066000
PSAEPPSW EQU   PSA+140                                                  03067000
FLCPIILC EQU   PSAEPPSW+1                                               03068000
FLCPICOD EQU   PSAEPPSW+2                                               03069000
PSAPICOD EQU   FLCPICOD+1                                               03070000
FLCTEA   EQU   PSAEPPSW+4                                               03071000
FLCPER   EQU   PSA+152                                                  03072000
FLCMCLA  EQU   PSA+168                                                  03073000
FLCIOEL  EQU   FLCMCLA+4                                                03074000
FLCIOA   EQU   FLCMCLA+16                                               03075000
FLCFSA   EQU   FLCMCLA+80                                               03076000
PSAAOLD  EQU   PSA+548                                                  03077000
PSASUPER EQU   PSA+552                                                  03078000
PSASUP1  EQU   PSASUPER                                                 03079000
PSASUP2  EQU   PSASUPER+1                                               03080000
PSASUP3  EQU   PSASUPER+2                                               03081000
PSASUP4  EQU   PSASUPER+3                                               03082000
PSACLHT  EQU   PSA+640                                                  03083000
PSALKSA  EQU   PSA+696                                                  03084000
PSAHLHI  EQU   PSA+760                                                  03085000
PSALITA  EQU   PSA+764                                                  03086000
PSADSSFL EQU   PSA+836                                                  03087000
PSADSSF1 EQU   PSADSSFL                                                 03088000
PSADSSF3 EQU   PSADSSFL+2                                               03089000
PSADSSF4 EQU   PSADSSFL+3                                               03090000
PSARSVT  EQU   PSA+896                                                  03091000
IOSLUT   EQU   0                                                        03092000
LOCKUCBS EQU   0                                                        03093000
LOCKNUM  EQU   LOCKUCBS                                                 03094000
LOCKLIST EQU   LOCKUCBS+4                                               03095000
RLSEMSGL EQU   0                                                        03096000
LINEHDR  EQU   RLSEMSGL                                                 03097000
LINEENT  EQU   RLSEMSGL+8                                               03098000
LINESER  EQU   LINEENT                                                  03099000
LINEDELM EQU   LINEENT+6                                                03100000
VOLLIST  EQU   0                                                        03101000
VLISTENT EQU   VOLLIST                                                  03102000
VLISTIND EQU   VLISTENT                                                 03103000
VOLIGNOR EQU   VLISTIND                                                 03104000
VOLUNLD  EQU   VLISTIND                                                 03105000
VOLFNDSW EQU   VLISTIND                                                 03106000
VOLVIRSW EQU   VLISTIND                                                 03107000
VOLREWND EQU   VLISTIND                                                 03108000
VOLSER   EQU   VLISTENT+2                                               03109000
VOLTYPE  EQU   VOLSER                                                   03110000
VOLINDX  EQU   VLISTENT+8                                               03111000
VOLUCBP  EQU   VLISTENT+12                                              03112000
RLSEJNAM EQU   0                                                        03113000
INJMJCT  EQU   0                                                        03114000
JCTJSTAT EQU   INJMJCT+5                                                03115000
INDMCTLG EQU   JCTJSTAT                                                 03116000
JCTJBYTE EQU   INJMJCT+7                                                03117000
JCTJMGLV EQU   JCTJBYTE                                                 03118000
JCTJNAME EQU   INJMJCT+8                                                03119000
JCTPDIP  EQU   INJMJCT+24                                               03120000
JCTCCODE EQU   INJMJCT+54                                               03121000
JCTRSW1  EQU   INJMJCT+86                                               03122000
JCTRSW2  EQU   INJMJCT+87                                               03123000
JCTDETDA EQU   INJMJCT+88                                               03124000
JCTJSB   EQU   INJMJCT+111                                              03125000
JCTSTAT2 EQU   INJMJCT+116                                              03126000
JCTVULDP EQU   INJMJCT+172                                              03127000
IEFAACTB EQU   0                                                        03128000
INDMSIOT EQU   0                                                        03129000
SCTUSADD EQU   INDMSIOT+20                                              03130000
SCTPJFCB EQU   INDMSIOT+32                                              03131000
SIOTBYT1 EQU   INDMSIOT+43                                              03132000
SIOTBYT3 EQU   INDMSIOT+46                                              03133000
SIOTTSTC EQU   INDMSIOT+47                                              03134000
SIOTBYT0 EQU   INDMSIOT+52                                              03135000
SCTSDISP EQU   INDMSIOT+55                                              03136000
SCTSBYT1 EQU   INDMSIOT+56                                              03137000
SCTDUMMY EQU   SCTSBYT1                                                 03138000
SCTSBYT2 EQU   INDMSIOT+57                                              03139000
SCTSBYT3 EQU   INDMSIOT+58                                              03140000
SCTSBYT4 EQU   INDMSIOT+59                                              03141000
SCTUTYPE EQU   INDMSIOT+60                                              03142000
SIOTDEVT EQU   SCTUTYPE                                                 03143000
SIOUBYT3 EQU   SIOTDEVT+2                                               03144000
SIOTBYT4 EQU   INDMSIOT+81                                              03145000
SIOTALTD EQU   INDMSIOT+92                                              03146000
SIOTAKEP EQU   SIOTALTD                                                 03147000
SIOTADEL EQU   SIOTALTD                                                 03148000
SIOTACAT EQU   SIOTALTD                                                 03149000
SIOTAUNC EQU   SIOTALTD                                                 03150000
SIOTBYT2 EQU   INDMSIOT+103                                             03151000
SIOTDSPD EQU   SIOTBYT2                                                 03152000
SJFCBPTR EQU   INDMSIOT+156                                             03153000
SIOTJFX  EQU   INDMSIOT+160                                             03154000
INFMJFCB EQU   0                                                        03155000
JFCBDSNM EQU   INFMJFCB                                                 03156000
JFCBELNM EQU   INFMJFCB+44                                              03157000
JFCBTSDM EQU   INFMJFCB+52                                              03158000
JFCFCBID EQU   INFMJFCB+56                                              03159000
JFCBFRID EQU   JFCFCBID                                                 03160000
JFCBLTYP EQU   INFMJFCB+66                                              03161000
JFCBOTTR EQU   INFMJFCB+67                                              03162000
JFCBUFOF EQU   JFCBOTTR                                                 03163000
JFCBFLSQ EQU   JFCBOTTR+1                                               03164000
JFCFUNC  EQU   JFCBFLSQ                                                 03165000
JFCBMASK EQU   INFMJFCB+72                                              03166000
JFCBFLG1 EQU   JFCBMASK+5                                               03167000
JFCOPEN  EQU   JFCBFLG1                                                 03168000
JFCBFLG2 EQU   JFCBMASK+6                                               03169000
JFCDEFER EQU   JFCBFLG2                                                 03170000
JFCBIND1 EQU   INFMJFCB+86                                              03171000
JFCBIND2 EQU   INFMJFCB+87                                              03172000
JFCAMPTR EQU   INFMJFCB+88                                              03173000
JFCBUFRQ EQU   JFCAMPTR                                                 03174000
JFCBUFNO EQU   JFCBUFRQ                                                 03175000
JFCBGNCP EQU   JFCAMPTR+1                                               03176000
JFCBHIAR EQU   JFCBGNCP                                                 03177000
JFCBFALN EQU   JFCBHIAR                                                 03178000
JFCBFTEK EQU   JFCBFALN                                                 03179000
JFCBBFTA EQU   JFCBFTEK                                                 03180000
JFCEROPT EQU   INFMJFCB+92                                              03181000
JFCTRTCH EQU   INFMJFCB+93                                              03182000
JFCBX    EQU   0                                                        03183000
JFCBXTTR EQU   JFCBX                                                    03184000
JFCBXNXT EQU   JFCBX+172                                                03185000
UCB      EQU   0                                                        03186000
UCBOB    EQU   0                                                        03187000
UCBJBNR  EQU   UCBOB                                                    03188000
UCBJES3  EQU   UCBJBNR                                                  03189000
UCBMMSGP EQU   UCBJBNR                                                  03190000
UCBMONT  EQU   UCBJBNR                                                  03191000
UCBFL5   EQU   UCBOB+1                                                  03192000
UCBAF    EQU   UCBFL5                                                   03193000
UCBNALOC EQU   UCBFL5                                                   03194000
UCBSTAT  EQU   UCBOB+3                                                  03195000
UCBRESV  EQU   UCBSTAT                                                  03196000
UCBALOC  EQU   UCBSTAT                                                  03197000
UCBPRES  EQU   UCBSTAT                                                  03198000
UCBCHAN  EQU   UCBOB+4                                                  03199000
UCBSFLS  EQU   UCBOB+6                                                  03200000
UCBFLA   EQU   UCBSFLS                                                  03201000
UCBFL1   EQU   UCBFLA                                                   03202000
UCBBSY   EQU   UCBFL1                                                   03203000
UCBNRY   EQU   UCBFL1                                                   03204000
UCBPST   EQU   UCBFL1                                                   03205000
UCBCUB   EQU   UCBFL1                                                   03206000
UCBFLB   EQU   UCBSFLS+1                                                03207000
UCBCHM   EQU   UCBOB+8                                                  03208000
UCBCHM1  EQU   UCBCHM                                                   03209000
UCBPTH0  EQU   UCBCHM1                                                  03210000
UCBPTH1  EQU   UCBCHM1                                                  03211000
UCBWGT   EQU   UCBOB+12                                                 03212000
UCBTYP   EQU   UCBOB+16                                                 03213000
UCBTBYT1 EQU   UCBTYP                                                   03214000
UCB1FEA5 EQU   UCBTBYT1                                                 03215000
UCB1FEA6 EQU   UCBTBYT1                                                 03216000
UCBTBYT2 EQU   UCBTYP+1                                                 03217000
UCB2OPT2 EQU   UCBTBYT2                                                 03218000
UCBDUDN1 EQU   UCB2OPT2                                                 03219000
UCB2OPT3 EQU   UCBTBYT2                                                 03220000
UCBDUDN2 EQU   UCB2OPT3                                                 03221000
UCB2OPT4 EQU   UCBTBYT2                                                 03222000
UCBRWTAU EQU   UCB2OPT4                                                 03223000
UCBRVDEV EQU   UCBRWTAU                                                 03224000
UCB2OPT6 EQU   UCBTBYT2                                                 03225000
UCB2OPT7 EQU   UCBTBYT2                                                 03226000
UCBTBYT3 EQU   UCBTYP+2                                                 03227000
UCBDVCLS EQU   UCBTBYT3                                                 03228000
UCB3TAPE EQU   UCBDVCLS                                                 03229000
UCB3DACC EQU   UCBDVCLS                                                 03230000
UCB3UREC EQU   UCBDVCLS                                                 03231000
UCBTBYT4 EQU   UCBTYP+3                                                 03232000
UCBEXTPT EQU   UCBOB+20                                                 03233000
UCBFLC   EQU   UCBEXTPT                                                 03234000
UCBDEV   EQU   UCBOB+24                                                 03235000
UCBCMEXT EQU   0                                                        03236000
UCBATI   EQU   UCBCMEXT+3                                               03237000
@NM00044 EQU   UCBATI                                                   03238000
UCBFLP1  EQU   UCBCMEXT+5                                               03239000
UCBASID  EQU   UCBCMEXT+14                                              03240000
UCBMIHTI EQU   UCBCMEXT+16                                              03241000
@NM00045 EQU   UCBMIHTI                                                 03242000
UCBMT    EQU   0                                                        03243000
UCBOCR   EQU   0                                                        03244000
UCB3540X EQU   0                                                        03245000
UCBDKBYT EQU   UCB3540X+6                                               03246000
UCB3800X EQU   0                                                        03247000
UCBOPTNS EQU   UCB3800X                                                 03248000
UCBACTIV EQU   UCB3800X+3                                               03249000
UCBMDRBF EQU   UCB3800X+36                                              03250000
UCBUCS   EQU   0                                                        03251000
UCBUCSOP EQU   UCBUCS+4                                                 03252000
UCBFCBOP EQU   UCBUCS+5                                                 03253000
VMVRQBLK EQU   0                                                        03254000
VMVFNMAP EQU   VMVRQBLK                                                 03255000
VMVOPTB1 EQU   VMVFNMAP                                                 03256000
VMVUNLOD EQU   VMVOPTB1                                                 03257000
VMVUCB   EQU   VMVOPTB1                                                 03258000
VMVREWND EQU   VMVOPTB1                                                 03259000
VMVOPTB2 EQU   VMVFNMAP+1                                               03260000
VMVOPTB3 EQU   VMVFNMAP+2                                               03261000
VMVNREQP EQU   VMVRQBLK+4                                               03262000
VMVUCBP  EQU   VMVRQBLK+9                                               03263000
VMVJBNMP EQU   VMVRQBLK+24                                              03264000
VMVMINFO EQU   VMVRQBLK+40                                              03265000
VMVACTON EQU   VMVMINFO                                                 03266000
VMVKEEP  EQU   VMVACTON                                                 03267000
VMVUSER  EQU   VMVRQBLK+48                                              03268000
PDIBLOCK EQU   0                                                        03269000
PDICTR   EQU   PDIBLOCK+3                                               03270000
PDIBNXTP EQU   PDIBLOCK+4                                               03271000
PDIENTRY EQU   PDIBLOCK+8                                               03272000
PDIE     EQU   0                                                        03273000
PDIUNWA  EQU   PDIE+44                                                  03274000
PDIISTAT EQU   PDIUNWA                                                  03275000
PDIPASIN EQU   PDIUNWA                                                  03276000
PDISIOTA EQU   PDIE+48                                                  03277000
PDISIOTP EQU   PDIE+52                                                  03278000
VUNLDTAB EQU   0                                                        03279000
VUTNSVA  EQU   VUNLDTAB                                                 03280000
VUTENTNO EQU   VUNLDTAB+3                                               03281000
VUTNPTR  EQU   VUNLDTAB+4                                               03282000
VUTENTRY EQU   VUNLDTAB+8                                               03283000
VUTENFLG EQU   VUTENTRY                                                 03284000
VUTENVIR EQU   VUTENFLG                                                 03285000
VUTUNLOD EQU   VUTENFLG                                                 03286000
VUTENVOL EQU   VUTENTRY+1                                               03287000
CMUNFMAP EQU   0                                                        03288000
CMFMBYT1 EQU   CMUNFMAP                                                 03289000
CMDMSGS  EQU   CMFMBYT1                                                 03290000
CMMNSTAT EQU   CMFMBYT1                                                 03291000
CMDISPRC EQU   CMFMBYT1                                                 03292000
CMFMBYT2 EQU   CMUNFMAP+1                                               03293000
CMNOPOST EQU   CMFMBYT2                                                 03294000
CMNOVUT  EQU   CMFMBYT2                                                 03295000
CMFMBYT3 EQU   CMUNFMAP+2                                               03296000
CMSPSCR  EQU   CMFMBYT3                                                 03297000
CMFMBYT4 EQU   CMUNFMAP+3                                               03298000
CMUNRB   EQU   0                                                        03299000
CMNRBPTR EQU   CMUNRB                                                   03300000
CMSIOPTR EQU   CMUNRB+4                                                 03301000
CMINDIC  EQU   CMUNRB+8                                                 03302000
CMRBBYT1 EQU   CMINDIC                                                  03303000
CMORDISP EQU   CMRBBYT1                                                 03304000
CMINVUCB EQU   CMRBBYT1                                                 03305000
CMRBBYT2 EQU   CMINDIC+1                                                03306000
CMNODSR  EQU   CMRBBYT2                                                 03307000
CMRBBYT3 EQU   CMINDIC+2                                                03308000
CMRBBYT4 EQU   CMINDIC+3                                                03309000
CMODISP  EQU   CMUNRB+12                                                03310000
CMOKEEP  EQU   CMODISP                                                  03311000
CMODEL   EQU   CMODISP                                                  03312000
CMOCATLG EQU   CMODISP                                                  03313000
CMOUNCAT EQU   CMODISP                                                  03314000
CMOPTFLD EQU   CMUNRB+16                                                03315000
ESTAPARM EQU   0                                                        03316000
ESTUSERP EQU   ESTAPARM+248                                             03317000
ESTAFLGS EQU   ESTUSERP                                                 03318000
ESTAJOBU EQU   ESTAFLGS                                                 03319000
ESTAJOB  EQU   ESTAFLGS                                                 03320000
WPLFLGS  EQU   0                                                        03321000
WPLDESC  EQU   WPLFLGS                                                  03322000
WPLDESC1 EQU   WPLDESC                                                  03323000
WPLDESCD EQU   WPLDESC1                                                 03324000
WPLDESC2 EQU   WPLDESC+1                                                03325000
WPLROUT  EQU   WPLFLGS+2                                                03326000
WPLROUT1 EQU   WPLROUT                                                  03327000
WPLROUTB EQU   WPLROUT1                                                 03328000
WPLROUTC EQU   WPLROUT1                                                 03329000
WPLROUTD EQU   WPLROUT1                                                 03330000
WPLROUT2 EQU   WPLROUT+1                                                03331000
WPLMSGTY EQU   WPLFLGS+4                                                03332000
WPLMSGT1 EQU   WPLMSGTY                                                 03333000
WPLMSGT2 EQU   WPLMSGTY+1                                               03334000
WPLLS01  EQU   0                                                        03335000
WPLLTF   EQU   WPLLS01                                                  03336000
WPLLTF1  EQU   WPLLTF                                                   03337000
WPLLTFB  EQU   WPLLTF1                                                  03338000
WPLLINES EQU   WPLLS01+3                                                03339000
WPLML    EQU   0                                                        03340000
WPLML0   EQU   WPLML                                                    03341000
WPLMLLEN EQU   WPLML+1                                                  03342000
WPLMLLTF EQU   WPLML+2                                                  03343000
WPLMLLT1 EQU   WPLMLLTF                                                 03344000
WPLMLLTC EQU   WPLMLLT1                                                 03345000
WPLMLLTD EQU   WPLMLLT1                                                 03346000
WPLMLTXT EQU   WPLML+4                                                  03347000
WPLRF    EQU   0                                                        03348000
WPLRPTR  EQU   WPLRF                                                    03349000
WPL      EQU   0                                                        03350000
WPLLGH   EQU   WPL                                                      03351000
WPLMCSF  EQU   WPL+2                                                    03352000
WPLMCSF1 EQU   WPLMCSF                                                  03353000
WPLMCSFA EQU   WPLMCSF1                                                 03354000
WPLMCSF2 EQU   WPLMCSF+1                                                03355000
WPLMCSFJ EQU   WPLMCSF2                                                 03356000
WPLTXT   EQU   WPL+4                                                    03357000
ASCB     EQU   0                                                        03358000
ASCBASID EQU   ASCB+36                                                  03359000
ASCBFW1  EQU   ASCB+100                                                 03360000
ASCBRCTF EQU   ASCBFW1+2                                                03361000
ASCBFLG1 EQU   ASCBFW1+3                                                03362000
ASCBDSP1 EQU   ASCB+114                                                 03363000
ASCBFLG2 EQU   ASCB+115                                                 03364000
I001C    EQU   0                                                        03365000
I008P    EQU   0                                                        03366000
I015F    EQU   0                                                        03367000
I015P    EQU   0                                                        03368000
I031F    EQU   0                                                        03369000
I031P    EQU   0                                                        03370000
I256C    EQU   0                                                        03371000
UCBBGN   EQU   0                                                        03372000
RLSEHDRL EQU   RLSEHDR                                                  03373000
RLSEJBND EQU   RLSEHDR+2                                                03374000
RLSEHDRM EQU   RLSEHDR+4                                                03375000
JOBFNMAP EQU   0                                                        03376000
JOBCNDSP EQU   JOBFNMAP                                                 03377000
JOBMSGS  EQU   JOBFNMAP                                                 03378000
JOBDSPRC EQU   JOBFNMAP                                                 03379000
JOBMSTAT EQU   JOBFNMAP                                                 03380000
JSCBPTR  EQU   0                                                        03381000
JCTPTR   EQU   0                                                        03382000
ESTAPTR  EQU   0                                                        03383000
LEPAPTR  EQU   0                                                        03384000
RESNCODE EQU   0                                                        03385000
IOSLUTP  EQU   0                                                        03386000
JFCKEYLE EQU   JFCTRTCH                                                 03387000
JFCCODE  EQU   JFCKEYLE                                                 03388000
JFCSTACK EQU   JFCTRTCH                                                 03389000
JFCMODE  EQU   JFCSTACK                                                 03390000
JFCSPPRT EQU   JFCTRTCH                                                 03391000
JFCBABFS EQU   JFCSPPRT+2                                               03392000
JFCLIMCT EQU   JFCBABFS                                                 03393000
JFCDSORG EQU   JFCSPPRT+5                                               03394000
JFCDSRG1 EQU   JFCDSORG                                                 03395000
JFCDSRG2 EQU   JFCDSORG+1                                               03396000
JFCRECFM EQU   JFCSPPRT+7                                               03397000
JFCRCFM  EQU   JFCRECFM                                                 03398000
JFCOPTCD EQU   JFCSPPRT+8                                               03399000
JFCWVCSP EQU   JFCOPTCD                                                 03400000
JFCWVCIS EQU   JFCWVCSP                                                 03401000
JFCWVCBD EQU   JFCWVCIS                                                 03402000
JFCALLOW EQU   JFCOPTCD                                                 03403000
JFCRSV17 EQU   JFCALLOW                                                 03404000
JFCOVER  EQU   JFCRSV17                                                 03405000
JFCPCIBT EQU   JFCOPTCD                                                 03406000
JFCMAST  EQU   JFCPCIBT                                                 03407000
JFCEXT   EQU   JFCMAST                                                  03408000
JFCBCKPT EQU   JFCOPTCD                                                 03409000
JFCIND   EQU   JFCBCKPT                                                 03410000
JFCRSV18 EQU   JFCOPTCD                                                 03411000
JFCCYL   EQU   JFCRSV18                                                 03412000
JFCACT   EQU   JFCCYL                                                   03413000
JFCREDUC EQU   JFCOPTCD                                                 03414000
JFCRSV19 EQU   JFCREDUC                                                 03415000
JFCRSV20 EQU   JFCRSV19                                                 03416000
JFCRSV21 EQU   JFCOPTCD                                                 03417000
JFCDEL   EQU   JFCRSV21                                                 03418000
JFCOPTJ  EQU   JFCOPTCD                                                 03419000
JFCREORG EQU   JFCOPTJ                                                  03420000
JFCBLKSI EQU   JFCSPPRT+9                                               03421000
JFCBUFSI EQU   JFCBLKSI                                                 03422000
JFCAMSYN EQU   JFCSPPRT+11                                              03423000
JFCNCP   EQU   JFCAMSYN+2                                               03424000
JFCNTM   EQU   JFCAMSYN+3                                               03425000
JFCBFSEQ EQU   JFCNTM                                                   03426000
JFCPCI   EQU   JFCBFSEQ                                                 03427000
JFCRESRV EQU   JFCAMSYN+4                                               03428000
JFCUCSEG EQU   JFCRESRV                                                 03429000
JFCUCSOP EQU   JFCUCSEG+4                                               03430000
JFCOUTLI EQU   JFCUCSEG+5                                               03431000
JFCTHRSH EQU   JFCOUTLI                                                 03432000
JFCCPRI  EQU   JFCTHRSH                                                 03433000
JFCBVOLS EQU   JFCUCSEG+10                                              03434000
JFCBS001 EQU   JFCBVOLS                                                 03435000
JFCBEXAD EQU   JFCBS001+31                                              03436000
JFCBPQTY EQU   JFCBS001+34                                              03437000
JFCBCTRI EQU   JFCBS001+37                                              03438000
JFCBSQTY EQU   JFCBS001+38                                              03439000
JFCFLGS1 EQU   JFCBS001+41                                              03440000
JFCBSPNM EQU   JFCBS001+45                                              03441000
JFCBFLG3 EQU   JFCBSPNM                                                 03442000
UCBOBS01 EQU   UCBDEV                                                   03443000
UCBVOLI  EQU   UCBOBS01+4                                               03444000
UCBSTAB  EQU   UCBOBS01+10                                              03445000
UCBBSVL  EQU   UCBSTAB                                                  03446000
UCBPRSRS EQU   UCBSTAB                                                  03447000
UCBBPRV  EQU   UCBSTAB                                                  03448000
UCBBPUB  EQU   UCBSTAB                                                  03449000
UCBDMCT  EQU   UCBOBS01+11                                              03450000
UCBMOUNT EQU   UCBDMCT                                                  03451000
UCBFL4   EQU   UCBOBS01+13                                              03452000
UCBOBS02 EQU   UCBDEV                                                   03453000
UCBTFL1  EQU   UCBOBS02+19                                              03454000
UCBXTN   EQU   UCBOBS02+20                                              03455000
UCBVOPT  EQU   UCBXTN                                                   03456000
UCBOBS03 EQU   UCBDEV                                                   03457000
UCBXTADR EQU   UCBOBS03                                                 03458000
UCBOBS04 EQU   UCBDEV                                                   03459000
UCBBTA   EQU   UCBOBS04+12                                              03460000
UCBOBS06 EQU   UCBDEV                                                   03461000
UCBAOF   EQU   UCBOBS06                                                 03462000
UCBAOF1  EQU   UCBAOF                                                   03463000
UCBAOF2  EQU   UCBAOF+1                                                 03464000
@NM00043 EQU   UCBOBS06+3                                               03465000
UCBIRB   EQU   UCBOBS06+4                                               03466000
UCBGRAF  EQU   UCBIRB                                                   03467000
UCBLDNCA EQU   UCBOBS06+8                                               03468000
UCBRDYQ  EQU   UCBLDNCA                                                 03469000
UCBIRLN  EQU   UCBRDYQ                                                  03470000
UCBLDNCB EQU   UCBRDYQ+1                                                03471000
UCBCTLNK EQU   UCBOBS06+12                                              03472000
UCBOBS07 EQU   UCBDEV                                                   03473000
UCBOBS08 EQU   UCBDEV                                                   03474000
UCBCTCAD EQU   UCBOBS08                                                 03475000
UCBCTCF1 EQU   UCBOBS08+4                                               03476000
UCBOBS09 EQU   UCBDEV                                                   03477000
PSARSVTE EQU   PSARSVT                                                  03478000
CMUIDPTR EQU   CMOPTFLD                                                 03479000
FLC      EQU   PSA                                                      03480000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03481000
PSARSAV  EQU   PSARSVTE+60                                              03482000
PSARSTK  EQU   PSARSVTE+56                                              03483000
PSAESAV3 EQU   PSARSVTE+52                                              03484000
PSAESTK3 EQU   PSARSVTE+48                                              03485000
PSAESAV2 EQU   PSARSVTE+44                                              03486000
PSAESTK2 EQU   PSARSVTE+40                                              03487000
PSAESAV1 EQU   PSARSVTE+36                                              03488000
PSAESTK1 EQU   PSARSVTE+32                                              03489000
PSAPSAV  EQU   PSARSVTE+28                                              03490000
PSAPSTK  EQU   PSARSVTE+24                                              03491000
PSAMSAV  EQU   PSARSVTE+20                                              03492000
PSAMSTK  EQU   PSARSVTE+16                                              03493000
PSASSAV  EQU   PSARSVTE+12                                              03494000
PSASSTK  EQU   PSARSVTE+8                                               03495000
PSANSTK  EQU   PSARSVTE+4                                               03496000
PSACSTK  EQU   PSARSVTE                                                 03497000
UCBRV066 EQU   UCBOBS09+4                                               03498000
UCBIOSBA EQU   UCBOBS09                                                 03499000
UCBRV042 EQU   UCBOBS08+5                                               03500000
UCBRV082 EQU   UCBCTCF1                                                 03501000
UCBRV081 EQU   UCBCTCF1                                                 03502000
UCBRV080 EQU   UCBCTCF1                                                 03503000
UCBRV079 EQU   UCBCTCF1                                                 03504000
UCBRV078 EQU   UCBCTCF1                                                 03505000
UCBRV077 EQU   UCBCTCF1                                                 03506000
UCBRV076 EQU   UCBCTCF1                                                 03507000
UCBCTC80 EQU   UCBCTCF1                                                 03508000
UCBCTCAL EQU   UCBCTCAD                                                 03509000
UCBICNCB EQU   UCBOBS07+4                                               03510000
UCBRV040 EQU   UCBOBS07                                                 03511000
UCBCTLNA EQU   UCBCTLNK+1                                               03512000
UCBRLN   EQU   UCBCTLNK                                                 03513000
UCBRDYQA EQU   UCBLDNCB                                                 03514000
UCBINRLN EQU   UCBIRLN                                                  03515000
UCBIRBA  EQU   UCBIRB+1                                                 03516000
UCBRV039 EQU   UCBGRAF                                                  03517000
UCBDWNR  EQU   UCBGRAF                                                  03518000
UCBRPND  EQU   UCBGRAF                                                  03519000
UCBUPM   EQU   UCBGRAF                                                  03520000
UCBBTAM  EQU   UCBGRAF                                                  03521000
UCBDRNO  EQU   UCBGRAF                                                  03522000
UCBDRO   EQU   UCBGRAF                                                  03523000
UCBOIP   EQU   UCBGRAF                                                  03524000
UCBATRCD EQU   @NM00043                                                 03525000
UCBSKPFG EQU   @NM00043                                                 03526000
UCBRIPND EQU   @NM00043                                                 03527000
UCBRTIAC EQU   @NM00043                                                 03528000
UCBRSV79 EQU   @NM00043                                                 03529000
UCBRSV78 EQU   @NM00043                                                 03530000
UCBRSV77 EQU   @NM00043                                                 03531000
UCBOLTEP EQU   @NM00043                                                 03532000
UCBATNCT EQU   UCBOBS06+2                                               03533000
UCBRSV76 EQU   UCBAOF2                                                  03534000
UCBRSV75 EQU   UCBAOF2                                                  03535000
UCBRSV74 EQU   UCBAOF2                                                  03536000
UCBRSV73 EQU   UCBAOF2                                                  03537000
UCBRSV72 EQU   UCBAOF2                                                  03538000
UCBRSV71 EQU   UCBAOF2                                                  03539000
UCBRSV70 EQU   UCBAOF2                                                  03540000
UCBRSV69 EQU   UCBAOF2                                                  03541000
UCBRSV68 EQU   UCBAOF1                                                  03542000
UCBRSV67 EQU   UCBAOF1                                                  03543000
UCBRSV66 EQU   UCBAOF1                                                  03544000
UCBRSV65 EQU   UCBAOF1                                                  03545000
UCBRSV64 EQU   UCBAOF1                                                  03546000
UCBOFNL  EQU   UCBAOF1                                                  03547000
UCBOFSP  EQU   UCBAOF1                                                  03548000
UCBOFMCR EQU   UCBAOF1                                                  03549000
UCBBTB   EQU   UCBBTA+1                                                 03550000
UCBDI    EQU   UCBBTA                                                   03551000
UCBSNS   EQU   UCBOBS04+8                                               03552000
UCBTEB   EQU   UCBOBS04+4                                               03553000
UCBGCB   EQU   UCBOBS04+3                                               03554000
UCBOPEN  EQU   UCBOBS04+2                                               03555000
UCBSTART EQU   UCBOBS04                                                 03556000
UCBXTNB  EQU   UCBXTN+1                                                 03557000
UCBRSV22 EQU   UCBVOPT                                                  03558000
UCBRSV21 EQU   UCBVOPT                                                  03559000
UCBRSV20 EQU   UCBVOPT                                                  03560000
UCBESVE  EQU   UCBVOPT                                                  03561000
UCBERPC  EQU   UCBVOPT                                                  03562000
UCBESVC  EQU   UCBVOPT                                                  03563000
UCBEVA   EQU   UCBVOPT                                                  03564000
UCBESV   EQU   UCBVOPT                                                  03565000
UCBRV009 EQU   UCBTFL1                                                  03566000
UCBRV008 EQU   UCBTFL1                                                  03567000
UCBRV007 EQU   UCBTFL1                                                  03568000
UCBRV006 EQU   UCBTFL1                                                  03569000
UCBRV005 EQU   UCBTFL1                                                  03570000
UCBDQDSP EQU   UCBTFL1                                                  03571000
UCBNSLTP EQU   UCBTFL1                                                  03572000
UCBNLTP  EQU   UCBTFL1                                                  03573000
UCBRES1B EQU   UCBOBS02+18                                              03574000
UCBFSER  EQU   UCBOBS02+12                                              03575000
@NM00042 EQU   UCBOBS02+4                                               03576000
UCBFSEQ  EQU   UCBOBS02+2                                               03577000
UCBFSCT  EQU   UCBOBS02                                                 03578000
UCBNEXP  EQU   UCBOBS01+20                                              03579000
UCBBASE  EQU   UCBOBS01+16                                              03580000
UCBRES1A EQU   UCBOBS01+15                                              03581000
UCBUSER  EQU   UCBOBS01+14                                              03582000
UCBFL47  EQU   UCBFL4                                                   03583000
UCBFL46  EQU   UCBFL4                                                   03584000
UCBFL45  EQU   UCBFL4                                                   03585000
UCBRV065 EQU   UCBFL4                                                   03586000
UCBDSS   EQU   UCBFL4                                                   03587000
UCBRESVP EQU   UCBFL4                                                   03588000
UCBWDAV  EQU   UCBFL4                                                   03589000
UCBDAVV  EQU   UCBFL4                                                   03590000
UCBSQC   EQU   UCBOBS01+12                                              03591000
UCBDATP  EQU   UCBOBS01+12                                              03592000
UCBDMC   EQU   UCBDMCT                                                  03593000
UCBBNUL  EQU   UCBSTAB                                                  03594000
UCBSHAR  EQU   UCBSTAB                                                  03595000
UCBBSTR  EQU   UCBSTAB                                                  03596000
UCBBALB  EQU   UCBPRSRS                                                 03597000
UCBPGFL  EQU   UCBSTAB                                                  03598000
UCBDVSHR EQU   UCBBSVL                                                  03599000
UCBVTOC  EQU   UCBOBS01                                                 03600000
JFCBEND  EQU   JFCBS001+58                                              03601000
JFCBSPTN EQU   JFCBS001+57                                              03602000
JFCBVLCT EQU   JFCBS001+56                                              03603000
JFCBDRLH EQU   JFCBS001+53                                              03604000
JFCBSBNM EQU   JFCBS001+50                                              03605000
JFCBABST EQU   JFCBS001+48                                              03606000
JFCBRV08 EQU   JFCBSPNM+1                                               03607000
JFCBRV07 EQU   JFCBFLG3                                                 03608000
JFCBRV06 EQU   JFCBFLG3                                                 03609000
JFCBRV05 EQU   JFCBFLG3                                                 03610000
JFCBRV04 EQU   JFCBFLG3                                                 03611000
JFCBRV03 EQU   JFCBFLG3                                                 03612000
JFCBRV02 EQU   JFCBFLG3                                                 03613000
JFCBEXP  EQU   JFCBFLG3                                                 03614000
JFCDQDSP EQU   JFCBFLG3                                                 03615000
JFCBDQTY EQU   JFCBS001+42                                              03616000
JFCBUAFF EQU   JFCFLGS1                                                 03617000
JFCRSV45 EQU   JFCFLGS1                                                 03618000
JFCVRDS  EQU   JFCFLGS1                                                 03619000
JFCBCEOV EQU   JFCFLGS1                                                 03620000
JFCRSV42 EQU   JFCFLGS1                                                 03621000
JFCBADSP EQU   JFCFLGS1                                                 03622000
JFCTOPEN EQU   JFCFLGS1                                                 03623000
JFCBDLET EQU   JFCFLGS1                                                 03624000
JFCRQID  EQU   JFCBSQTY                                                 03625000
JFCROUND EQU   JFCBCTRI                                                 03626000
JFCALX   EQU   JFCBCTRI                                                 03627000
JFCMIXG  EQU   JFCBCTRI                                                 03628000
JFCONTIG EQU   JFCBCTRI                                                 03629000
JFCRSV29 EQU   JFCBCTRI                                                 03630000
JFCBMSGP EQU   JFCBCTRI                                                 03631000
JFCBSPAC EQU   JFCBCTRI                                                 03632000
JFCRUNIT EQU   JFCBPQTY                                                 03633000
JFCBEXTL EQU   JFCBS001+30                                              03634000
JFCMSVGP EQU   JFCBS001+22                                              03635000
@NM00037 EQU   JFCBS001                                                 03636000
JFCAVOLS EQU   JFCBVOLS                                                 03637000
JFCBNVOL EQU   JFCUCSEG+9                                               03638000
JFCBNTCS EQU   JFCUCSEG+8                                               03639000
JFCSOWA  EQU   JFCOUTLI+1                                               03640000
JFCSEND  EQU   JFCCPRI                                                  03641000
JFCEQUAL EQU   JFCCPRI                                                  03642000
JFCRECV  EQU   JFCCPRI                                                  03643000
JFCRSV34 EQU   JFCCPRI                                                  03644000
JFCRSV33 EQU   JFCCPRI                                                  03645000
JFCRSV55 EQU   JFCCPRI                                                  03646000
JFCRSV54 EQU   JFCCPRI                                                  03647000
JFCRSV53 EQU   JFCCPRI                                                  03648000
JFCRSV27 EQU   JFCUCSOP                                                 03649000
JFCRSV26 EQU   JFCUCSOP                                                 03650000
JFCFCBVR EQU   JFCUCSOP                                                 03651000
JFCFCBAL EQU   JFCUCSOP                                                 03652000
JFCVER   EQU   JFCUCSOP                                                 03653000
JFCRSV25 EQU   JFCUCSOP                                                 03654000
JFCFOLD  EQU   JFCUCSOP                                                 03655000
JFCBEXTP EQU   JFCUCSOP                                                 03656000
JFCUCSID EQU   JFCUCSEG                                                 03657000
JFCINTVL EQU   JFCSPPRT+19                                              03658000
JFCDBUFN EQU   JFCRESRV+3                                               03659000
JFCCYLOF EQU   JFCRESRV+2                                               03660000
JFCRKP   EQU   JFCRESRV                                                 03661000
JFCPCIR2 EQU   JFCPCI                                                   03662000
JFCPCIR1 EQU   JFCPCI                                                   03663000
JFCPCIN2 EQU   JFCPCI                                                   03664000
JFCPCIN1 EQU   JFCPCI                                                   03665000
JFCPCIA2 EQU   JFCPCI                                                   03666000
JFCPCIA1 EQU   JFCPCI                                                   03667000
JFCPCIX2 EQU   JFCPCI                                                   03668000
JFCPCIX1 EQU   JFCPCI                                                   03669000
JFCBUFMX EQU   JFCNCP                                                   03670000
JFCLRECL EQU   JFCAMSYN                                                 03671000
JFCBAXBF EQU   JFCBUFSI                                                 03672000
JFCREL   EQU   JFCREORG                                                 03673000
JFCRSV22 EQU   JFCDEL                                                   03674000
JFCSRCHD EQU   JFCRSV20                                                 03675000
JFCOPTQ  EQU   JFCACT                                                   03676000
JFCFEED  EQU   JFCIND                                                   03677000
JFCCBWU  EQU   JFCEXT                                                   03678000
JFCWUMSG EQU   JFCOVER                                                  03679000
JFCSDNAM EQU   JFCWVCBD                                                 03680000
@NM00036 EQU   JFCRECFM                                                 03681000
JFCCHAR  EQU   JFCRECFM                                                 03682000
JFCRFS   EQU   JFCRECFM                                                 03683000
JFCRFB   EQU   JFCRECFM                                                 03684000
JFCRFO   EQU   JFCRCFM                                                  03685000
JFCFMREC EQU   JFCRCFM                                                  03686000
JFCRSV16 EQU   JFCDSRG2                                                 03687000
JFCRSV15 EQU   JFCDSRG2                                                 03688000
JFCORGTR EQU   JFCDSRG2                                                 03689000
JFCORGAM EQU   JFCDSRG2                                                 03690000
JFCRSV13 EQU   JFCDSRG2                                                 03691000
JFCORGTQ EQU   JFCDSRG2                                                 03692000
JFCORGTX EQU   JFCDSRG2                                                 03693000
JFCORGGS EQU   JFCDSRG2                                                 03694000
JFCORGU  EQU   JFCDSRG1                                                 03695000
JFCORGPO EQU   JFCDSRG1                                                 03696000
JFCORGMQ EQU   JFCDSRG1                                                 03697000
JFCORGCQ EQU   JFCDSRG1                                                 03698000
JFCORGCX EQU   JFCDSRG1                                                 03699000
JFCORGDA EQU   JFCDSRG1                                                 03700000
JFCORGPS EQU   JFCDSRG1                                                 03701000
JFCORGIS EQU   JFCDSRG1                                                 03702000
JFCTRKBL EQU   JFCLIMCT+1                                               03703000
@NM00035 EQU   JFCLIMCT                                                 03704000
JFCDEN   EQU   JFCSPPRT+1                                               03705000
JFCPRTSP EQU   JFCSPPRT                                                 03706000
JFCONE   EQU   JFCMODE                                                  03707000
JFCTWO   EQU   JFCMODE                                                  03708000
JFCRSV07 EQU   JFCMODE                                                  03709000
JFCRSV06 EQU   JFCMODE                                                  03710000
JFCMODER EQU   JFCMODE                                                  03711000
JFCMODEO EQU   JFCMODE                                                  03712000
JFCEBCD  EQU   JFCMODE                                                  03713000
JFCBIN   EQU   JFCMODE                                                  03714000
JFCRSV32 EQU   JFCCODE                                                  03715000
JFCTTY   EQU   JFCCODE                                                  03716000
JFCASCII EQU   JFCCODE                                                  03717000
JFCNCR   EQU   JFCCODE                                                  03718000
JFCBUR   EQU   JFCCODE                                                  03719000
JFCFRI   EQU   JFCCODE                                                  03720000
JFCBCD   EQU   JFCCODE                                                  03721000
JFCNOCON EQU   JFCCODE                                                  03722000
ASCBEND  EQU   ASCB+208                                                 03723000
ASCBSRBT EQU   ASCB+200                                                 03724000
ASCBSWTL EQU   ASCB+196                                                 03725000
ASCBRS14 EQU   ASCB+195                                                 03726000
ASCBSMCT EQU   ASCB+194                                                 03727000
ASCBRS12 EQU   ASCB+192                                                 03728000
ASCBPCTT EQU   ASCB+188                                                 03729000
ASCBVGTT EQU   ASCB+184                                                 03730000
ASCBLGCB EQU   ASCB+180                                                 03731000
ASCBJBNS EQU   ASCB+176                                                 03732000
ASCBJBNI EQU   ASCB+172                                                 03733000
ASCBMCC  EQU   ASCB+168                                                 03734000
ASCBRTWA EQU   ASCB+164                                                 03735000
ASCBIQEA EQU   ASCB+160                                                 03736000
ASCBXMPQ EQU   ASCB+156                                                 03737000
ASCBRS01 EQU   ASCB+154                                                 03738000
ASCBFMCT EQU   ASCB+152                                                 03739000
ASCBOUXB EQU   ASCB+148                                                 03740000
ASCBOUCB EQU   ASCB+144                                                 03741000
ASCBMECB EQU   ASCB+140                                                 03742000
ASCBQECB EQU   ASCB+136                                                 03743000
ASCBCMSB EQU   ASCB+132                                                 03744000
ASCBCMSF EQU   ASCB+128                                                 03745000
ASCBTCBS EQU   ASCB+124                                                 03746000
ASCBNVSC EQU   ASCB+122                                                 03747000
ASCBVSC  EQU   ASCB+120                                                 03748000
ASCBSRBS EQU   ASCB+118                                                 03749000
ASCBSSRB EQU   ASCB+116                                                 03750000
ASCBRV06 EQU   ASCBFLG2                                                 03751000
ASCBRV05 EQU   ASCBFLG2                                                 03752000
ASCBRV04 EQU   ASCBFLG2                                                 03753000
ASCBSNQS EQU   ASCBFLG2                                                 03754000
ASCBS2S  EQU   ASCBFLG2                                                 03755000
ASCBCEXT EQU   ASCBFLG2                                                 03756000
ASCBPXMT EQU   ASCBFLG2                                                 03757000
ASCBXMPT EQU   ASCBFLG2                                                 03758000
ASCBRF07 EQU   ASCBDSP1                                                 03759000
ASCBRF06 EQU   ASCBDSP1                                                 03760000
ASCBRF05 EQU   ASCBDSP1                                                 03761000
ASCBRF04 EQU   ASCBDSP1                                                 03762000
ASCBRF03 EQU   ASCBDSP1                                                 03763000
ASCBRF02 EQU   ASCBDSP1                                                 03764000
ASCBFAIL EQU   ASCBDSP1                                                 03765000
ASCBNOQ  EQU   ASCBDSP1                                                 03766000
ASCBSWCT EQU   ASCB+112                                                 03767000
ASCBASXB EQU   ASCB+108                                                 03768000
ASCBTMCH EQU   ASCB+104                                                 03769000
ASCBNSWP EQU   ASCBFLG1                                                 03770000
ASCBTYP1 EQU   ASCBFLG1                                                 03771000
ASCBSTND EQU   ASCBFLG1                                                 03772000
ASCBABNT EQU   ASCBFLG1                                                 03773000
ASCBTERM EQU   ASCBFLG1                                                 03774000
ASCBS3S  EQU   ASCBFLG1                                                 03775000
ASCBCMSH EQU   ASCBFLG1                                                 03776000
ASCBTOFF EQU   ASCBFLG1                                                 03777000
ASCBRF01 EQU   ASCBRCTF                                                 03778000
ASCBTMLW EQU   ASCBRCTF                                                 03779000
ASCBOUT  EQU   ASCBRCTF                                                 03780000
ASCBWAIT EQU   ASCBRCTF                                                 03781000
ASCBRV08 EQU   ASCBRCTF                                                 03782000
ASCBFQU  EQU   ASCBRCTF                                                 03783000
ASCBFRS  EQU   ASCBRCTF                                                 03784000
ASCBTMNO EQU   ASCBRCTF                                                 03785000
ASCBAFFN EQU   ASCBFW1                                                  03786000
ASCBDUMP EQU   ASCB+96                                                  03787000
ASCBQSVC EQU   ASCB+92                                                  03788000
ASCBUBET EQU   ASCB+88                                                  03789000
ASCBECB  EQU   ASCB+84                                                  03790000
ASCBJSTL EQU   ASCB+80                                                  03791000
ASCBEWST EQU   ASCB+72                                                  03792000
ASCBEJST EQU   ASCB+64                                                  03793000
ASCBTSB  EQU   ASCB+60                                                  03794000
ASCBCSCB EQU   ASCB+56                                                  03795000
ASCBRSM  EQU   ASCB+52                                                  03796000
ASCBLDA  EQU   ASCB+48                                                  03797000
ASCBSTOR EQU   ASCB+44                                                  03798000
ASCBDP   EQU   ASCB+43                                                  03799000
ASCBRV07 EQU   ASCB+42                                                  03800000
ASCBIOSM EQU   ASCB+40                                                  03801000
ASCBSEQN EQU   ASCB+38                                                  03802000
ASCBCPUS EQU   ASCB+32                                                  03803000
ASCBSPL  EQU   ASCB+28                                                  03804000
ASCBLSLQ EQU   ASCB+24                                                  03805000
ASCBFSLQ EQU   ASCB+20                                                  03806000
ASCBIOSP EQU   ASCB+16                                                  03807000
ASCBLOCK EQU   ASCB+12                                                  03808000
ASCBBWDP EQU   ASCB+8                                                   03809000
ASCBFWDP EQU   ASCB+4                                                   03810000
ASCBASCB EQU   ASCB                                                     03811000
ASCBEGIN EQU   ASCB                                                     03812000
WPLTXTL  EQU   WPLTXT+125                                               03813000
@NM00075 EQU   WPLTXT                                                   03814000
WPLRSV05 EQU   WPLMCSF2                                                 03815000
WPLRSV04 EQU   WPLMCSF2                                                 03816000
WPLMCSFN EQU   WPLMCSF2                                                 03817000
WPLRSV03 EQU   WPLMCSF2                                                 03818000
WPLNOWTP EQU   WPLMCSF2                                                 03819000
WPLMCSFK EQU   WPLMCSF2                                                 03820000
WPLMCSFI EQU   WPLMCSF2                                                 03821000
WPLMCSFH EQU   WPLMCSF1                                                 03822000
WPLMCSFG EQU   WPLMCSF1                                                 03823000
WPLMCSFF EQU   WPLMCSF1                                                 03824000
WPLMCSFE EQU   WPLMCSF1                                                 03825000
WPLMCSFD EQU   WPLMCSF1                                                 03826000
WPLMCSFC EQU   WPLMCSF1                                                 03827000
WPLMCSFB EQU   WPLMCSF1                                                 03828000
WPLRECB  EQU   WPLRF+4                                                  03829000
WPLRPTRA EQU   WPLRPTR+1                                                03830000
WPLRLN   EQU   WPLRPTR                                                  03831000
WPLMLLT2 EQU   WPLMLLTF+1                                               03832000
WPLRSV24 EQU   WPLMLLT1                                                 03833000
WPLRSV23 EQU   WPLMLLT1                                                 03834000
WPLRSV22 EQU   WPLMLLT1                                                 03835000
WPLRSV21 EQU   WPLMLLT1                                                 03836000
WPLMLLTB EQU   WPLMLLT1                                                 03837000
WPLMLLTA EQU   WPLMLLT1                                                 03838000
WPLAREA  EQU   WPLLS01+2                                                03839000
WPLLTF2  EQU   WPLLTF+1                                                 03840000
WPLRSV20 EQU   WPLLTF1                                                  03841000
WPLRSV19 EQU   WPLLTF1                                                  03842000
WPLRSV18 EQU   WPLLTF1                                                  03843000
WPLRSV17 EQU   WPLLTF1                                                  03844000
WPLLTFD  EQU   WPLLTF1                                                  03845000
WPLLTFC  EQU   WPLLTF1                                                  03846000
WPLLTFA  EQU   WPLLTF1                                                  03847000
WPLQID   EQU   WPLFLGS+6                                                03848000
WPLRSV32 EQU   WPLMSGT2                                                 03849000
WPLRSV31 EQU   WPLMSGT2                                                 03850000
WPLRSV30 EQU   WPLMSGT2                                                 03851000
WPLRSV29 EQU   WPLMSGT2                                                 03852000
WPLRSV28 EQU   WPLMSGT2                                                 03853000
WPLRSV27 EQU   WPLMSGT2                                                 03854000
WPLRSV26 EQU   WPLMSGT2                                                 03855000
WPLRSV25 EQU   WPLMSGT2                                                 03856000
WPLRSV16 EQU   WPLMSGT1                                                 03857000
WPLRSV15 EQU   WPLMSGT1                                                 03858000
WPLMSGTF EQU   WPLMSGT1                                                 03859000
WPLRSV14 EQU   WPLMSGT1                                                 03860000
WPLMSGTD EQU   WPLMSGT1                                                 03861000
WPLMSGTC EQU   WPLMSGT1                                                 03862000
WPLMSGTB EQU   WPLMSGT1                                                 03863000
WPLMSGTA EQU   WPLMSGT1                                                 03864000
WPLRSV13 EQU   WPLROUT2                                                 03865000
WPLROUTO EQU   WPLROUT2                                                 03866000
WPLROUTN EQU   WPLROUT2                                                 03867000
WPLROUTM EQU   WPLROUT2                                                 03868000
WPLROUTL EQU   WPLROUT2                                                 03869000
WPLROUTK EQU   WPLROUT2                                                 03870000
WPLROUTJ EQU   WPLROUT2                                                 03871000
WPLROUTI EQU   WPLROUT2                                                 03872000
WPLROUTH EQU   WPLROUT1                                                 03873000
WPLROUTG EQU   WPLROUT1                                                 03874000
WPLROUTF EQU   WPLROUT1                                                 03875000
WPLROUTE EQU   WPLROUT1                                                 03876000
WPLROUTA EQU   WPLROUT1                                                 03877000
WPLRSV12 EQU   WPLDESC2                                                 03878000
WPLRSV11 EQU   WPLDESC2                                                 03879000
WPLRSV10 EQU   WPLDESC2                                                 03880000
WPLRSV09 EQU   WPLDESC2                                                 03881000
WPLRSV08 EQU   WPLDESC2                                                 03882000
WPLRSV07 EQU   WPLDESC2                                                 03883000
WPLDESCJ EQU   WPLDESC2                                                 03884000
WPLDESCI EQU   WPLDESC2                                                 03885000
WPLDESCH EQU   WPLDESC1                                                 03886000
WPLDESCG EQU   WPLDESC1                                                 03887000
WPLDESCF EQU   WPLDESC1                                                 03888000
WPLDESCE EQU   WPLDESC1                                                 03889000
WPLDESCC EQU   WPLDESC1                                                 03890000
WPLDESCB EQU   WPLDESC1                                                 03891000
WPLDESCA EQU   WPLDESC1                                                 03892000
ESTLEPAP EQU   ESTUSERP+20                                              03893000
ESTSIOTP EQU   ESTUSERP+16                                              03894000
ESTASCTP EQU   ESTUSERP+12                                              03895000
ESTAJCTP EQU   ESTUSERP+8                                               03896000
ESTALCTP EQU   ESTUSERP+4                                               03897000
@NM00074 EQU   ESTAFLGS                                                 03898000
ESTRECRD EQU   ESTAFLGS                                                 03899000
ESTRECUR EQU   ESTAFLGS                                                 03900000
ESTASTEP EQU   ESTAFLGS                                                 03901000
ESTAAUTO EQU   ESTAPARM                                                 03902000
CMRETCDE EQU   CMUNRB+14                                                03903000
CMOSYOUT EQU   CMUNRB+13                                                03904000
@NM00073 EQU   CMODISP                                                  03905000
@NM00072 EQU   CMRBBYT4                                                 03906000
@NM00071 EQU   CMRBBYT4                                                 03907000
CMNODEN  EQU   CMRBBYT4                                                 03908000
CMSSERR  EQU   CMRBBYT4                                                 03909000
CMINTERR EQU   CMRBBYT4                                                 03910000
CMSSIERR EQU   CMRBBYT4                                                 03911000
CMCATERR EQU   CMRBBYT4                                                 03912000
CMSCRERR EQU   CMRBBYT4                                                 03913000
@NM00070 EQU   CMRBBYT3                                                 03914000
CMSSKEEP EQU   CMRBBYT3                                                 03915000
CMNOHOLD EQU   CMRBBYT3                                                 03916000
CMOVSYOT EQU   CMRBBYT3                                                 03917000
CMWAIT   EQU   CMRBBYT3                                                 03918000
CMDYNUNA EQU   CMRBBYT3                                                 03919000
CMHOLD   EQU   CMRBBYT3                                                 03920000
CMDEL    EQU   CMRBBYT3                                                 03921000
@NM00069 EQU   CMRBBYT2                                                 03922000
@NM00068 EQU   CMRBBYT2                                                 03923000
@NM00067 EQU   CMRBBYT2                                                 03924000
CMSETPRV EQU   CMRBBYT2                                                 03925000
CMCKDAVL EQU   CMRBBYT2                                                 03926000
CMCKAVOL EQU   CMRBBYT2                                                 03927000
CMCHKUN  EQU   CMRBBYT2                                                 03928000
@NM00066 EQU   CMRBBYT1                                                 03929000
CMOUSRID EQU   CMRBBYT1                                                 03930000
CMCNDISP EQU   CMRBBYT1                                                 03931000
CMNMDISP EQU   CMRBBYT1                                                 03932000
CMNODISP EQU   CMRBBYT1                                                 03933000
@NM00065 EQU   CMFMBYT4                                                 03934000
@NM00064 EQU   CMFMBYT4                                                 03935000
@NM00063 EQU   CMFMBYT4                                                 03936000
@NM00062 EQU   CMFMBYT4                                                 03937000
@NM00061 EQU   CMFMBYT4                                                 03938000
@NM00060 EQU   CMFMBYT4                                                 03939000
CMALSTCT EQU   CMFMBYT4                                                 03940000
CMLSTCJS EQU   CMFMBYT4                                                 03941000
CMJES3   EQU   CMFMBYT3                                                 03942000
@NM00059 EQU   CMFMBYT3                                                 03943000
@NM00058 EQU   CMFMBYT3                                                 03944000
CMPUBPRV EQU   CMFMBYT3                                                 03945000
CMSCRVL1 EQU   CMFMBYT3                                                 03946000
CMNOSMF  EQU   CMFMBYT3                                                 03947000
CMDSRALL EQU   CMFMBYT3                                                 03948000
CMTIOTNQ EQU   CMFMBYT2                                                 03949000
CMPURGE  EQU   CMFMBYT2                                                 03950000
CMNERMSG EQU   CMFMBYT2                                                 03951000
CMRDDENT EQU   CMFMBYT2                                                 03952000
CMGENDEQ EQU   CMFMBYT2                                                 03953000
CMCHATTR EQU   CMFMBYT2                                                 03954000
CMFDSABS EQU   CMFMBYT1                                                 03955000
CMVLRLSE EQU   CMFMBYT1                                                 03956000
CMUNUNIT EQU   CMFMBYT1                                                 03957000
CMDSRLSE EQU   CMFMBYT1                                                 03958000
CMDPCATS EQU   CMFMBYT1                                                 03959000
@NM00057 EQU   VUTENFLG                                                 03960000
@NM00055 EQU   PDIE+51                                                  03961000
PDISTPNO EQU   PDIE+46                                                  03962000
@NM00054 EQU   PDIE+45                                                  03963000
@NM00053 EQU   PDIUNWA                                                  03964000
PDIJOBLB EQU   PDIUNWA                                                  03965000
@NM00052 EQU   PDIUNWA                                                  03966000
PDICSTAT EQU   PDIUNWA                                                  03967000
PDIDSNAM EQU   PDIE                                                     03968000
PDINPDIP EQU   PDIBLOCK                                                 03969000
@NM00051 EQU   VMVUSER                                                  03970000
VMVPROCD EQU   VMVUSER                                                  03971000
VMVVUNTP EQU   VMVRQBLK+44                                              03972000
@NM00050 EQU   VMVMINFO+1                                               03973000
@NM00049 EQU   VMVACTON                                                 03974000
VMVRTAIN EQU   VMVACTON                                                 03975000
VMVDSMT  EQU   VMVACTON                                                 03976000
VMVRETCD EQU   VMVRQBLK+36                                              03977000
VMVJSNMP EQU   VMVRQBLK+32                                              03978000
VMVDSNMP EQU   VMVRQBLK+28                                              03979000
VMVMVLSR EQU   VMVRQBLK+18                                              03980000
VMVUVLSR EQU   VMVRQBLK+12                                              03981000
@NM00048 EQU   VMVRQBLK+8                                               03982000
VMVOPTB4 EQU   VMVFNMAP+3                                               03983000
@NM00047 EQU   VMVOPTB3                                                 03984000
VMVNUMSG EQU   VMVOPTB3                                                 03985000
VMVCUVOL EQU   VMVOPTB3                                                 03986000
VMVDUPVL EQU   VMVOPTB3                                                 03987000
VMVNSPVT EQU   VMVOPTB2                                                 03988000
VMVNSLTP EQU   VMVOPTB2                                                 03989000
VMVSLTAP EQU   VMVOPTB2                                                 03990000
VMVNLTAP EQU   VMVOPTB2                                                 03991000
VMVALTAP EQU   VMVOPTB2                                                 03992000
VMVSTRG  EQU   VMVOPTB2                                                 03993000
VMVPUBLC EQU   VMVOPTB2                                                 03994000
VMVPRIVT EQU   VMVOPTB2                                                 03995000
VMVVDEND EQU   VMVOPTB1                                                 03996000
VMVVRLBL EQU   VMVOPTB1                                                 03997000
VMVDWTOR EQU   VMVOPTB1                                                 03998000
VMVMTMSG EQU   VMVOPTB1                                                 03999000
VMVMOUNT EQU   VMVOPTB1                                                 04000000
UCBERADR EQU   UCBUCS+12                                                04001000
UCBFCBID EQU   UCBUCS+8                                                 04002000
UCBERCNT EQU   UCBUCS+7                                                 04003000
UCBRSV51 EQU   UCBUCS+6                                                 04004000
UCBFCBPE EQU   UCBFCBOP                                                 04005000
UCBRSV49 EQU   UCBFCBOP                                                 04006000
UCBRSV48 EQU   UCBFCBOP                                                 04007000
UCBRSV47 EQU   UCBFCBOP                                                 04008000
UCBRSV46 EQU   UCBFCBOP                                                 04009000
UCBRSV45 EQU   UCBFCBOP                                                 04010000
UCBRSV44 EQU   UCBFCBOP                                                 04011000
UCBFCBO1 EQU   UCBFCBOP                                                 04012000
UCBUCSPE EQU   UCBUCSOP                                                 04013000
UCBRSV43 EQU   UCBUCSOP                                                 04014000
UCBRSV42 EQU   UCBUCSOP                                                 04015000
UCBRSV41 EQU   UCBUCSOP                                                 04016000
UCBRSV40 EQU   UCBUCSOP                                                 04017000
UCBRSV39 EQU   UCBUCSOP                                                 04018000
UCBUCSO2 EQU   UCBUCSOP                                                 04019000
UCBUCSO1 EQU   UCBUCSOP                                                 04020000
UCBUCSID EQU   UCBUCS                                                   04021000
UCBMDRBA EQU   UCBMDRBF+1                                               04022000
UCBRV075 EQU   UCBMDRBF                                                 04023000
UCBRV074 EQU   UCB3800X+32                                              04024000
UCBIMAGE EQU   UCB3800X+28                                              04025000
UCBFCBNM EQU   UCB3800X+24                                              04026000
UCBCHAR4 EQU   UCB3800X+20                                              04027000
UCBCHAR3 EQU   UCB3800X+16                                              04028000
UCBCHAR2 EQU   UCB3800X+12                                              04029000
UCBCHAR1 EQU   UCB3800X+8                                               04030000
UCBCGMID EQU   UCB3800X+4                                               04031000
UCBBRSTA EQU   UCBACTIV                                                 04032000
UCBRV063 EQU   UCBACTIV                                                 04033000
UCBRV062 EQU   UCBACTIV                                                 04034000
UCBRV061 EQU   UCBACTIV                                                 04035000
UCBRV060 EQU   UCBACTIV                                                 04036000
UCBRV059 EQU   UCBACTIV                                                 04037000
UCBRV058 EQU   UCBACTIV                                                 04038000
UCBRV057 EQU   UCBACTIV                                                 04039000
UCBRV050 EQU   UCB3800X+2                                               04040000
UCBCGMNO EQU   UCB3800X+1                                               04041000
UCBRV083 EQU   UCBOPTNS                                                 04042000
UCBBRSTR EQU   UCBOPTNS                                                 04043000
UCBRV056 EQU   UCBOPTNS                                                 04044000
UCBRV055 EQU   UCBOPTNS                                                 04045000
UCBRV054 EQU   UCBOPTNS                                                 04046000
UCBRV053 EQU   UCBOPTNS                                                 04047000
UCBRV052 EQU   UCBOPTNS                                                 04048000
UCBRV051 EQU   UCBOPTNS                                                 04049000
UCBRV073 EQU   UCB3540X+7                                               04050000
UCBRV072 EQU   UCBDKBYT                                                 04051000
UCBRV071 EQU   UCBDKBYT                                                 04052000
UCBRV070 EQU   UCBDKBYT                                                 04053000
UCBRV069 EQU   UCBDKBYT                                                 04054000
UCBRV068 EQU   UCBDKBYT                                                 04055000
UCBRV067 EQU   UCBDKBYT                                                 04056000
UCBVLVER EQU   UCBDKBYT                                                 04057000
UCBDKAMX EQU   UCBDKBYT                                                 04058000
UCBVLSER EQU   UCB3540X                                                 04059000
UCBRDATA EQU   UCBOCR+4                                                 04060000
UCBFRID  EQU   UCBOCR                                                   04061000
UCBCLN   EQU   UCBMT+14                                                 04062000
UCBERG   EQU   UCBMT+12                                                 04063000
UCBMS    EQU   UCBMT+11                                                 04064000
UCBNB    EQU   UCBMT+10                                                 04065000
UCBPW    EQU   UCBMT+9                                                  04066000
UCBPR    EQU   UCBMT+8                                                  04067000
UCBSIO   EQU   UCBMT+6                                                  04068000
UCBTW    EQU   UCBMT+5                                                  04069000
UCBTR    EQU   UCBMT+4                                                  04070000
UCBTWT   EQU   UCBMT+3                                                  04071000
UCBTRT   EQU   UCBMT+2                                                  04072000
UCBCTD   EQU   UCBMT                                                    04073000
UCBWTOID EQU   UCBCMEXT+17                                              04074000
@NM00046 EQU   @NM00045                                                 04075000
UCBMIHSF EQU   @NM00045                                                 04076000
UCBMFCNT EQU   UCBCMEXT+12                                              04077000
UCBPMSK  EQU   UCBCMEXT+10                                              04078000
UCBCCWOF EQU   UCBCMEXT+8                                               04079000
UCBRV041 EQU   UCBCMEXT+6                                               04080000
UCBMIHPB EQU   UCBFLP1                                                  04081000
UCBMIHTB EQU   UCBFLP1                                                  04082000
UCBERLOG EQU   UCBFLP1                                                  04083000
UCBSWAPF EQU   UCBFLP1                                                  04084000
UCBINHIO EQU   UCBFLP1                                                  04085000
UCBNSWAP EQU   UCBFLP1                                                  04086000
UCBSHRUP EQU   UCBFLP1                                                  04087000
UCBNSRCH EQU   UCBFLP1                                                  04088000
UCBSNSCT EQU   UCBCMEXT+4                                               04089000
UCBHPDV  EQU   @NM00044                                                 04090000
UCBHALI  EQU   @NM00044                                                 04091000
UCBRSV09 EQU   @NM00044                                                 04092000
UCBRSV08 EQU   @NM00044                                                 04093000
UCBRSV07 EQU   @NM00044                                                 04094000
UCBRSV06 EQU   @NM00044                                                 04095000
UCBRSV05 EQU   @NM00044                                                 04096000
UCBRSV04 EQU   @NM00044                                                 04097000
UCBDTI   EQU   UCBCMEXT+2                                               04098000
UCBSTI   EQU   UCBCMEXT+1                                               04099000
UCBETI   EQU   UCBCMEXT                                                 04100000
UCBEXTP  EQU   UCBEXTPT+1                                               04101000
UCBDDRSW EQU   UCBFLC                                                   04102000
UCBTICBT EQU   UCBFLC                                                   04103000
UCBIVRR  EQU   UCBFLC                                                   04104000
UCBIVRS  EQU   UCBFLC                                                   04105000
UCBITF   EQU   UCBFLC                                                   04106000
UCBUDE   EQU   UCBFLC                                                   04107000
UCBWAA   EQU   UCBFLC                                                   04108000
UCBATTP  EQU   UCBFLC                                                   04109000
UCBUNTYP EQU   UCBTBYT4                                                 04110000
UCBRSV11 EQU   UCBDVCLS                                                 04111000
UCBRSV10 EQU   UCBDVCLS                                                 04112000
UCB3CHAR EQU   UCBDVCLS                                                 04113000
UCB3DISP EQU   UCBDVCLS                                                 04114000
UCB3COMM EQU   UCBDVCLS                                                 04115000
UCBDVPWR EQU   UCB2OPT7                                                 04116000
UCBVLPWR EQU   UCB2OPT6                                                 04117000
UCB2OPT5 EQU   UCBTBYT2                                                 04118000
UCBRPS   EQU   UCBDUDN2                                                 04119000
UCBRR    EQU   UCBDUDN1                                                 04120000
UCB2OPT1 EQU   UCBTBYT2                                                 04121000
UCB2OPT0 EQU   UCBTBYT2                                                 04122000
UCB1FEA7 EQU   UCBTBYT1                                                 04123000
UCBD6250 EQU   UCB1FEA6                                                 04124000
UCBD1600 EQU   UCB1FEA5                                                 04125000
UCB1FEA4 EQU   UCBTBYT1                                                 04126000
UCB1FEA3 EQU   UCBTBYT1                                                 04127000
UCB1FEA2 EQU   UCBTBYT1                                                 04128000
UCB1FEA1 EQU   UCBTBYT1                                                 04129000
UCB1FEA0 EQU   UCBTBYT1                                                 04130000
UCBNAME  EQU   UCBOB+13                                                 04131000
UCBRV029 EQU   UCBWGT                                                   04132000
UCBVHRSN EQU   UCBWGT                                                   04133000
UCBVORSN EQU   UCBWGT                                                   04134000
UCBMTPXP EQU   UCBWGT                                                   04135000
UCBREW   EQU   UCBWGT                                                   04136000
UCBPUB   EQU   UCBWGT                                                   04137000
UCBOUT   EQU   UCBWGT                                                   04138000
UCBIN    EQU   UCBWGT                                                   04139000
UCBCPU   EQU   UCBOB+11                                                 04140000
UCBLCI   EQU   UCBOB+10                                                 04141000
UCBCNT   EQU   UCBOB+9                                                  04142000
UCBRV017 EQU   UCBCHM1                                                  04143000
UCBRV016 EQU   UCBCHM1                                                  04144000
UCBRV015 EQU   UCBCHM1                                                  04145000
UCBRV014 EQU   UCBCHM1                                                  04146000
UCBSPB   EQU   UCBPTH1                                                  04147000
UCBPPB   EQU   UCBPTH1                                                  04148000
UCBSPA   EQU   UCBPTH0                                                  04149000
UCBPPA   EQU   UCBPTH0                                                  04150000
UCBSIGP  EQU   UCBFLB                                                   04151000
UCBVALPH EQU   UCBFLB                                                   04152000
UCBCRHSN EQU   UCBFLB                                                   04153000
UCBCRHRV EQU   UCBFLB                                                   04154000
UCBRESVH EQU   UCBFLB                                                   04155000
UCBSPST  EQU   UCBFLB                                                   04156000
UCBASNS  EQU   UCBFLB                                                   04157000
UCBIORST EQU   UCBFLB                                                   04158000
UCBQISCE EQU   UCBFL1                                                   04159000
UCBACTV  EQU   UCBFL1                                                   04160000
UCBSAP   EQU   UCBFL1                                                   04161000
UCBNOTRC EQU   UCBCUB                                                   04162000
UCBPSNS  EQU   UCBFL1                                                   04163000
UCBUSING EQU   UCBPST                                                   04164000
UCBNOTRD EQU   UCBNRY                                                   04165000
UCBBUSYD EQU   UCBBSY                                                   04166000
UCBUA    EQU   UCBCHAN+1                                                04167000
UCBCHA   EQU   UCBCHAN                                                  04168000
UCBDADI  EQU   UCBSTAT                                                  04169000
UCBSYSR  EQU   UCBSTAT                                                  04170000
UCBUNLD  EQU   UCBSTAT                                                  04171000
UCBCHGS  EQU   UCBSTAT                                                  04172000
UCBONLI  EQU   UCBSTAT                                                  04173000
UCBID    EQU   UCBOB+2                                                  04174000
UCBALTPH EQU   UCBFL5                                                   04175000
UCBALTCU EQU   UCBFL5                                                   04176000
UCBENVRD EQU   UCBFL5                                                   04177000
UCBVSDR  EQU   UCBFL5                                                   04178000
UCBSASK  EQU   UCBFL5                                                   04179000
UCBAMV   EQU   UCBAF                                                    04180000
UCBDCC   EQU   UCBFL5                                                   04181000
UCBRV011 EQU   UCBJBNR                                                  04182000
UCBOLDSM EQU   UCBJBNR                                                  04183000
UCBRV003 EQU   UCBJBNR                                                  04184000
UCBDUC   EQU   UCBJBNR                                                  04185000
UCBVRDEV EQU   UCBJBNR                                                  04186000
UCBCMSEG EQU   UCBOB                                                    04187000
UCBPFXND EQU   UCB+512                                                  04188000
UCBIOQ   EQU   UCB+508                                                  04189000
UCBLOCK  EQU   UCB+504                                                  04190000
UCBPXST  EQU   UCB+504                                                  04191000
@NM00041 EQU   UCB                                                      04192000
@NM00040 EQU   JFCBX+144                                                04193000
JFCBXDEV EQU   JFCBX+140                                                04194000
JFCBXNAM EQU   JFCBX+96                                                 04195000
@NM00039 EQU   JFCBX+94                                                 04196000
JFCBXVOL EQU   JFCBX+4                                                  04197000
@NM00038 EQU   JFCBX+3                                                  04198000
JFCRSV05 EQU   JFCEROPT                                                 04199000
JFCRSV04 EQU   JFCEROPT                                                 04200000
JFCRSV03 EQU   JFCEROPT                                                 04201000
JFCRSV02 EQU   JFCEROPT                                                 04202000
JFCTOPT  EQU   JFCEROPT                                                 04203000
JFCABN   EQU   JFCEROPT                                                 04204000
JFCSKP   EQU   JFCEROPT                                                 04205000
JFCACC   EQU   JFCEROPT                                                 04206000
JFCBUFL  EQU   JFCAMPTR+2                                               04207000
JFCFWORD EQU   JFCBFTEK                                                 04208000
JFCDWORD EQU   JFCBFTEK                                                 04209000
JFCHIER1 EQU   JFCBFTEK                                                 04210000
JFCDYN   EQU   JFCBFTEK                                                 04211000
JFCEXC   EQU   JFCBFTEK                                                 04212000
JFCBBFTR EQU   JFCBBFTA                                                 04213000
JFCSIM   EQU   JFCBBFTA                                                 04214000
JFCHIER  EQU   JFCBFTEK                                                 04215000
JFCBFOUT EQU   JFCBUFNO                                                 04216000
JFCBUFIN EQU   JFCBUFNO                                                 04217000
JFCTEMP  EQU   JFCBIND2                                                 04218000
JFCREQ   EQU   JFCBIND2                                                 04219000
JFCENT   EQU   JFCBIND2                                                 04220000
JFCSHARE EQU   JFCBIND2                                                 04221000
JFCSECUR EQU   JFCBIND2                                                 04222000
JFCDISP  EQU   JFCBIND2                                                 04223000
JFCPDS   EQU   JFCBIND1                                                 04224000
JFCGDG   EQU   JFCBIND1                                                 04225000
JFCADDED EQU   JFCBIND1                                                 04226000
JFCLOC   EQU   JFCBIND1                                                 04227000
JFCRLSE  EQU   JFCBIND1                                                 04228000
JFCBXPDT EQU   INFMJFCB+83                                              04229000
JFCBCRDT EQU   INFMJFCB+80                                              04230000
JFCBOPS2 EQU   JFCBMASK+7                                               04231000
JFCRCTLG EQU   JFCBFLG2                                                 04232000
JFCBBUFF EQU   JFCBFLG2                                                 04233000
JFCTRACE EQU   JFCBFLG2                                                 04234000
JFCSDRPS EQU   JFCBFLG2                                                 04235000
JFCMODNW EQU   JFCBFLG2                                                 04236000
JFCNRPS  EQU   JFCDEFER                                                 04237000
JFCOUTOP EQU   JFCBFLG2                                                 04238000
JFCINOP  EQU   JFCBFLG2                                                 04239000
JFCBPWBP EQU   JFCOPEN                                                  04240000
@NM00034 EQU   JFCOPEN                                                  04241000
JFCDUAL  EQU   JFCBFLG1                                                 04242000
JFCSLDES EQU   JFCBFLG1                                                 04243000
JFCSLCRE EQU   JFCBFLG1                                                 04244000
JFCSTAND EQU   JFCBFLG1                                                 04245000
JFCBOPS1 EQU   JFCBMASK                                                 04246000
JFCBVLSQ EQU   INFMJFCB+70                                              04247000
JFCRSV31 EQU   JFCFUNC                                                  04248000
JFCFNCBT EQU   JFCFUNC                                                  04249000
JFCFNCBX EQU   JFCFUNC                                                  04250000
JFCFNCBD EQU   JFCFUNC                                                  04251000
JFCFNCBW EQU   JFCFUNC                                                  04252000
JFCFNCBP EQU   JFCFUNC                                                  04253000
JFCFNCBR EQU   JFCFUNC                                                  04254000
JFCFNCBI EQU   JFCFUNC                                                  04255000
JFCBFOFL EQU   JFCBUFOF                                                 04256000
JFCNL    EQU   JFCBLTYP                                                 04257000
JFCSL    EQU   JFCBLTYP                                                 04258000
JFCNSL   EQU   JFCBLTYP                                                 04259000
JFCSUL   EQU   JFCBLTYP                                                 04260000
JFCBLP   EQU   JFCBLTYP                                                 04261000
JFCBLTM  EQU   JFCBLTYP                                                 04262000
JFCBAL   EQU   JFCBLTYP                                                 04263000
JFCRSV38 EQU   JFCBLTYP                                                 04264000
JFCVINDX EQU   INFMJFCB+64                                              04265000
JFCNLREC EQU   INFMJFCB+62                                              04266000
JFCBADBF EQU   INFMJFCB+60                                              04267000
JFCAMSTR EQU   JFCBFRID+2                                               04268000
JFCAMCRO EQU   JFCBFRID                                                 04269000
JFCBDSCB EQU   INFMJFCB+53                                              04270000
JFCPAT   EQU   JFCBTSDM                                                 04271000
JFCNDCB  EQU   JFCBTSDM                                                 04272000
JFCNDSCB EQU   JFCBTSDM                                                 04273000
JFCNWRIT EQU   JFCBTSDM                                                 04274000
JFCTTR   EQU   JFCBTSDM                                                 04275000
JFCSDS   EQU   JFCBTSDM                                                 04276000
JFCVSL   EQU   JFCBTSDM                                                 04277000
JFCCAT   EQU   JFCBTSDM                                                 04278000
JFCIPLTX EQU   JFCBELNM                                                 04279000
JFCBQNAM EQU   JFCBDSNM                                                 04280000
SIODDSNL EQU   INDMSIOT+173                                             04281000
SIOVDSNL EQU   INDMSIOT+172                                             04282000
SIOVDSNT EQU   INDMSIOT+170                                             04283000
SVOLUNNO EQU   INDMSIOT+168                                             04284000
SIOTVMVP EQU   INDMSIOT+164                                             04285000
SIOTNPTR EQU   INDMSIOT+152                                             04286000
SIOTETIO EQU   INDMSIOT+148                                             04287000
SIOTATE  EQU   INDMSIOT+144                                             04288000
SVOLUNAD EQU   INDMSIOT+140                                             04289000
SIOTEDLP EQU   INDMSIOT+136                                             04290000
SIOTEDLS EQU   INDMSIOT+132                                             04291000
SIOTRSNC EQU   INDMSIOT+130                                             04292000
SCTANAME EQU   INDMSIOT+122                                             04293000
SIOTSSIC EQU   INDMSIOT+120                                             04294000
@NM00033 EQU   INDMSIOT+108                                             04295000
SIOTSSNM EQU   INDMSIOT+104                                             04296000
@NM00032 EQU   SIOTBYT2                                                 04297000
SIOTCVOL EQU   SIOTBYT2                                                 04298000
SIOTCNEW EQU   SIOTBYT2                                                 04299000
SIOTCALC EQU   SIOTBYT2                                                 04300000
SIOTGALL EQU   SIOTBYT2                                                 04301000
SIOTDMND EQU   SIOTBYT2                                                 04302000
SIOTOPUC EQU   INDMSIOT+99                                              04303000
SIOTOUTR EQU   INDMSIOT+97                                              04304000
SIOTOUTC EQU   INDMSIOT+96                                              04305000
SIOTSSWA EQU   INDMSIOT+93                                              04306000
SIOTNPRV EQU   SIOTALTD                                                 04307000
SIOJCATS EQU   SIOTALTD                                                 04308000
@NM00031 EQU   SIOTALTD                                                 04309000
@NM00030 EQU   SIOTALTD                                                 04310000
@NM00029 EQU   INDMSIOT+91                                              04311000
SIOTNDSB EQU   INDMSIOT+88                                              04312000
@NM00028 EQU   INDMSIOT+84                                              04313000
SIOTDPCD EQU   INDMSIOT+82                                              04314000
@NM00027 EQU   SIOTBYT4                                                 04315000
SIOTRACT EQU   SIOTBYT4                                                 04316000
SIOTRACD EQU   SIOTBYT4                                                 04317000
SIOTPROT EQU   SIOTBYT4                                                 04318000
SCTOUTPN EQU   INDMSIOT+80                                              04319000
SCTOUTNO EQU   INDMSIOT+76                                              04320000
SCTOUTNM EQU   INDMSIOT+68                                              04321000
SIOUCBAD EQU   SCTUTYPE+5                                               04322000
SIOUCNVT EQU   SCTUTYPE+4                                               04323000
SIOUBYT4 EQU   SIOTDEVT+3                                               04324000
@NM00026 EQU   SIOUBYT3                                                 04325000
SIO3UREC EQU   SIOUBYT3                                                 04326000
SIO3DISP EQU   SIOUBYT3                                                 04327000
SIO3DACC EQU   SIOUBYT3                                                 04328000
SIO3COMM EQU   SIOUBYT3                                                 04329000
SIO3TAPE EQU   SIOUBYT3                                                 04330000
SIOUBYT2 EQU   SIOTDEVT+1                                               04331000
SIOUBYT1 EQU   SIOTDEVT                                                 04332000
SIOTOMN  EQU   SCTSBYT4                                                 04333000
SIOTIPDI EQU   SCTSBYT4                                                 04334000
SIOTVAFF EQU   SCTSBYT4                                                 04335000
SIOTSTEP EQU   SCTSBYT4                                                 04336000
SIOTASCI EQU   SCTSBYT4                                                 04337000
@NM00025 EQU   SCTSBYT4                                                 04338000
SIOTGDGA EQU   SCTSBYT4                                                 04339000
SCTSGDGS EQU   SCTSBYT4                                                 04340000
SCTSOLD  EQU   SCTSBYT3                                                 04341000
SCTSMOD  EQU   SCTSBYT3                                                 04342000
SCTSNEW  EQU   SCTSBYT3                                                 04343000
SCTSYSOU EQU   SCTSBYT3                                                 04344000
SCTVREF  EQU   SCTSBYT3                                                 04345000
SCTALCHK EQU   SCTSBYT3                                                 04346000
SCTSYSNE EQU   SCTSBYT3                                                 04347000
SCTDSNRF EQU   SCTSBYT3                                                 04348000
SCTRECVD EQU   SCTSBYT2                                                 04349000
SCTDEFER EQU   SCTSBYT2                                                 04350000
SCTLABEL EQU   SCTSBYT2                                                 04351000
SCTUNLBD EQU   SCTSBYT2                                                 04352000
SCTJOBLB EQU   SCTSBYT2                                                 04353000
SCTVOLAF EQU   SCTSBYT2                                                 04354000
SIOTCATL EQU   SCTSBYT2                                                 04355000
SIOCLUNL EQU   SCTSBYT2                                                 04356000
SIOTJSCT EQU   SCTSBYT1                                                 04357000
SCTUNAFF EQU   SCTSBYT1                                                 04358000
SCTPARLM EQU   SCTSBYT1                                                 04359000
SIOTQDSN EQU   SCTSBYT1                                                 04360000
SIOTGDSN EQU   SCTSBYT1                                                 04361000
SIOTCCAT EQU   SCTSBYT1                                                 04362000
SCTSYSIN EQU   SCTSBYT1                                                 04363000
SIOTUNCT EQU   SCTSDISP                                                 04364000
SIOTCTLG EQU   SCTSDISP                                                 04365000
SIOTDLET EQU   SCTSDISP                                                 04366000
SIOTKEEP EQU   SCTSDISP                                                 04367000
SIOTPASS EQU   SCTSDISP                                                 04368000
SIOTPRIV EQU   SCTSDISP                                                 04369000
S3400DSP EQU   SCTSDISP                                                 04370000
SIOTRETN EQU   SCTSDISP                                                 04371000
SIOTVLCT EQU   INDMSIOT+54                                              04372000
SCTNMBUT EQU   INDMSIOT+53                                              04373000
SIOTRTRY EQU   SIOTBYT0                                                 04374000
SIOTPUPV EQU   SIOTBYT0                                                 04375000
SIOTNOPV EQU   SIOTBYT0                                                 04376000
SIOTGIGN EQU   SIOTBYT0                                                 04377000
SPVTAMSG EQU   SIOTBYT0                                                 04378000
SIOTFUDA EQU   SIOTBYT0                                                 04379000
SIOTDYAL EQU   SIOTBYT0                                                 04380000
SIOTSSDS EQU   SIOTBYT0                                                 04381000
SIOTGIID EQU   INDMSIOT+50                                              04382000
SCTVOLCT EQU   INDMSIOT+49                                              04383000
SCTSPOOL EQU   INDMSIOT+48                                              04384000
SIOTQNAM EQU   SIOTTSTC                                                 04385000
SIOTDSNM EQU   SIOTTSTC                                                 04386000
SIOTTRKM EQU   SIOTTSTC                                                 04387000
SIOTSSMG EQU   SIOTTSTC                                                 04388000
SIOTSSGP EQU   SIOTTSTC                                                 04389000
@NM00024 EQU   SIOTTSTC                                                 04390000
SIOTTERM EQU   SIOTTSTC                                                 04391000
SIOTINFC EQU   SIOTTSTC                                                 04392000
@NM00023 EQU   SIOTBYT3                                                 04393000
SIOTDSID EQU   SIOTBYT3                                                 04394000
S3400OFF EQU   SIOTBYT3                                                 04395000
SIOTJES3 EQU   SIOTBYT3                                                 04396000
SIOCDEVT EQU   SIOTBYT3                                                 04397000
SIOALIAS EQU   SIOTBYT3                                                 04398000
SCTDDINO EQU   INDMSIOT+44                                              04399000
SIOTDDNT EQU   SIOTBYT1                                                 04400000
SIOTALCD EQU   SIOTBYT1                                                 04401000
SIODADSM EQU   SIOTBYT1                                                 04402000
SIOTDADR EQU   SIOTBYT1                                                 04403000
SIODUNAL EQU   SIOTBYT1                                                 04404000
SIOVAMDS EQU   SIOTBYT1                                                 04405000
SIOTHOLD EQU   SIOTBYT1                                                 04406000
SIOTOCKP EQU   SIOTBYT1                                                 04407000
SIOPSCNT EQU   INDMSIOT+42                                              04408000
SIOTREFN EQU   INDMSIOT+40                                              04409000
SIOTOTUN EQU   INDMSIOT+39                                              04410000
SIOTVRSB EQU   INDMSIOT+36                                              04411000
@NM00022 EQU   INDMSIOT+35                                              04412000
@NM00021 EQU   INDMSIOT+31                                              04413000
SCTPSIOT EQU   INDMSIOT+28                                              04414000
SIOTAFID EQU   INDMSIOT+26                                              04415000
SIOTVLSP EQU   INDMSIOT+24                                              04416000
SIODSNTE EQU   INDMSIOT+22                                              04417000
SIOTUNAF EQU   SCTUSADD                                                 04418000
SIOTDEST EQU   INDMSIOT+12                                              04419000
SCTDDNAM EQU   INDMSIOT+4                                               04420000
SIOTTYPE EQU   INDMSIOT+3                                               04421000
SIOTDSKA EQU   INDMSIOT                                                 04422000
ACTACCNT EQU   IEFAACTB+32                                              04423000
ACTJNFLD EQU   IEFAACTB+31                                              04424000
ACTJTIME EQU   IEFAACTB+28                                              04425000
ACTPRGNM EQU   IEFAACTB+8                                               04426000
@NM00020 EQU   IEFAACTB+7                                               04427000
ACTNEXT  EQU   IEFAACTB+4                                               04428000
ACTIDENT EQU   IEFAACTB+3                                               04429000
ACTDSKAD EQU   IEFAACTB                                                 04430000
@NM00019 EQU   INJMJCT+175                                              04431000
JCTACODE EQU   INJMJCT+168                                              04432000
JCTPRFMF EQU   INJMJCT+167                                              04433000
JCTUSER  EQU   INJMJCT+160                                              04434000
JCTSSD   EQU   INJMJCT+157                                              04435000
@NM00018 EQU   INJMJCT+156                                              04436000
JCTSRBT  EQU   INJMJCT+152                                              04437000
JCTJMRJD EQU   INJMJCT+149                                              04438000
JCTJMRJT EQU   INJMJCT+146                                              04439000
JCTJMRSS EQU   INJMJCT+143                                              04440000
JCTJMRTL EQU   INJMJCT+140                                              04441000
JCTJMRCL EQU   INJMJCT+139                                              04442000
JCTJMROP EQU   INJMJCT+138                                              04443000
JCTJMRD  EQU   INJMJCT+137                                              04444000
JCTJMR   EQU   INJMJCT+134                                              04445000
JCTCKIDT EQU   INJMJCT+118                                              04446000
JCTCKIDL EQU   INJMJCT+117                                              04447000
@NM00017 EQU   JCTSTAT2                                                 04448000
JCTBLP   EQU   JCTSTAT2                                                 04449000
JCTPERFM EQU   JCTSTAT2                                                 04450000
JCTSWSM  EQU   JCTSTAT2                                                 04451000
JCTENDIT EQU   JCTSTAT2                                                 04452000
JCTADSPC EQU   JCTSTAT2                                                 04453000
JCTSPSYS EQU   JCTSTAT2                                                 04454000
@NM00016 EQU   INJMJCT+115                                              04455000
JCTSSTR  EQU   INJMJCT+112                                              04456000
JCTJSBTM EQU   JCTJSB                                                   04457000
JCTJSBEX EQU   JCTJSB                                                   04458000
JCTJSBAL EQU   JCTJSB                                                   04459000
JCTJSBIN EQU   JCTJSB                                                   04460000
@NM00015 EQU   JCTJSB                                                   04461000
JCTVOLSQ EQU   INJMJCT+110                                              04462000
JCTNRCKP EQU   INJMJCT+108                                              04463000
JCTNTRK  EQU   INJMJCT+107                                              04464000
JCTCKTTR EQU   INJMJCT+104                                              04465000
JCTDEVT  EQU   INJMJCT+100                                              04466000
@NM00014 EQU   INJMJCT+99                                               04467000
JCTSTIOT EQU   INJMJCT+96                                               04468000
JCTSNUMB EQU   INJMJCT+95                                               04469000
JCTQIDNT EQU   INJMJCT+94                                               04470000
JCTEQREG EQU   INJMJCT+92                                               04471000
@NM00013 EQU   INJMJCT+91                                               04472000
JCTDSDRA EQU   JCTRSW2                                                  04473000
JCTDSOJB EQU   JCTRSW2                                                  04474000
JCTDSOCR EQU   JCTRSW2                                                  04475000
JCTRESTT EQU   JCTRSW2                                                  04476000
JCTNOCKP EQU   JCTRSW2                                                  04477000
JCTNORST EQU   JCTRSW2                                                  04478000
JCTNARST EQU   JCTRSW2                                                  04479000
JCTSYSCK EQU   JCTRSW2                                                  04480000
@NM00012 EQU   JCTRSW1                                                  04481000
JCTSTEPR EQU   JCTRSW1                                                  04482000
JCTCKPTR EQU   JCTRSW1                                                  04483000
JCTCKFT  EQU   JCTRSW1                                                  04484000
JCTCONTR EQU   JCTRSW1                                                  04485000
JCTSTERM EQU   JCTRSW1                                                  04486000
JCTWARMS EQU   JCTRSW1                                                  04487000
@NM00011 EQU   JCTCCODE+3                                               04488000
JCTJDPOP EQU   JCTCCODE+2                                               04489000
JCTJDPCD EQU   JCTCCODE                                                 04490000
@NM00010 EQU   INJMJCT+53                                               04491000
JCTSCT   EQU   INJMJCT+52                                               04492000
JCTSMRBA EQU   INJMJCT+44                                               04493000
@NM00009 EQU   INJMJCT+43                                               04494000
JCTACTAD EQU   INJMJCT+40                                               04495000
@NM00008 EQU   INJMJCT+39                                               04496000
JCTJCTX  EQU   INJMJCT+36                                               04497000
@NM00007 EQU   INJMJCT+35                                               04498000
JCTSDKAD EQU   INJMJCT+32                                               04499000
JCTJCSMF EQU   INJMJCT+31                                               04500000
JCTGDGNT EQU   INJMJCT+28                                               04501000
@NM00006 EQU   INJMJCT+27                                               04502000
JCTJTPTN EQU   INJMJCT+16                                               04503000
JCTJPRTY EQU   JCTJBYTE                                                 04504000
INCMMGL1 EQU   JCTJMGLV                                                 04505000
INCMMGL2 EQU   JCTJMGLV                                                 04506000
@NM00005 EQU   JCTJMGLV                                                 04507000
INCMALL  EQU   JCTJMGLV                                                 04508000
JCTJMGPO EQU   INJMJCT+6                                                04509000
INCMNSET EQU   JCTJSTAT                                                 04510000
INCMCAT  EQU   INDMCTLG                                                 04511000
INCMSTS  EQU   JCTJSTAT                                                 04512000
JCTABEND EQU   JCTJSTAT                                                 04513000
@NM00004 EQU   JCTJSTAT                                                 04514000
JCTJSTPC EQU   JCTJSTAT                                                 04515000
@NM00003 EQU   JCTJSTAT                                                 04516000
JCTJBLBS EQU   JCTJSTAT                                                 04517000
JCTJSRNO EQU   INJMJCT+4                                                04518000
JCTIDENT EQU   INJMJCT+3                                                04519000
JCTDSKAD EQU   INJMJCT                                                  04520000
@NM00099 EQU   PSA+3668                                                 04521000
PSASTAK  EQU   PSA+3072                                                 04522000
@NM00098 EQU   PSA+1048                                                 04523000
PSAUSEND EQU   PSA+1048                                                 04524000
PSARV062 EQU   PSA+1044                                                 04525000
PSACDAL  EQU   PSA+1040                                                 04526000
PSAWTCOD EQU   PSA+1036                                                 04527000
PSAATCVT EQU   PSA+1032                                                 04528000
PSAPCPSW EQU   PSA+1024                                                 04529000
PSAPIR2  EQU   PSA+1020                                                 04530000
PSARV059 EQU   PSA+1018                                                 04531000
PSASVC13 EQU   PSA+1016                                                 04532000
PSALSFCC EQU   PSA+1012                                                 04533000
PSASFACC EQU   PSA+1008                                                 04534000
PSASTOP  EQU   PSA+992                                                  04535000
PSASTART EQU   PSA+976                                                  04536000
PSARSPSW EQU   PSA+968                                                  04537000
PSASRPSW EQU   PSA+960                                                  04538000
PSARV045 EQU   PSA+892                                                  04539000
PSARV044 EQU   PSA+888                                                  04540000
PSARV043 EQU   PSA+884                                                  04541000
PSARV042 EQU   PSA+880                                                  04542000
PSARV041 EQU   PSA+876                                                  04543000
PSARV040 EQU   PSA+872                                                  04544000
PSARV025 EQU   PSA+868                                                  04545000
PSADSSED EQU   PSA+868                                                  04546000
PSADSSPR EQU   PSA+864                                                  04547000
PSADSSFW EQU   PSA+860                                                  04548000
PSADSS14 EQU   PSA+856                                                  04549000
PSADSSPP EQU   PSA+848                                                  04550000
PSADSSRP EQU   PSA+840                                                  04551000
PSADSS05 EQU   PSADSSF4                                                 04552000
PSADSS10 EQU   PSADSSF4                                                 04553000
PSADSSVE EQU   PSADSSF4                                                 04554000
PSADSSDE EQU   PSADSSF4                                                 04555000
PSADSSC0 EQU   PSADSSF4                                                 04556000
PSADSSIE EQU   PSADSSF4                                                 04557000
PSADSS12 EQU   PSADSSF4                                                 04558000
PSADSSRC EQU   PSADSSF4                                                 04559000
PSARV057 EQU   PSADSSF3                                                 04560000
PSARV056 EQU   PSADSSF3                                                 04561000
PSARV055 EQU   PSADSSF3                                                 04562000
PSADSSMC EQU   PSADSSF3                                                 04563000
PSADSSRW EQU   PSADSSF3                                                 04564000
PSADSSNM EQU   PSADSSF3                                                 04565000
PSADSSES EQU   PSADSSF3                                                 04566000
PSADSSGP EQU   PSADSSF3                                                 04567000
PSADSSF2 EQU   PSADSSFL+1                                               04568000
PSADSSPI EQU   PSADSSF1                                                 04569000
PSADSSOI EQU   PSADSSF1                                                 04570000
PSADSSSP EQU   PSADSSF1                                                 04571000
PSADSSTP EQU   PSADSSF1                                                 04572000
PSADSSDW EQU   PSADSSF1                                                 04573000
PSADSSDD EQU   PSADSSF1                                                 04574000
PSADSSDM EQU   PSADSSF1                                                 04575000
PSADSSMV EQU   PSADSSF1                                                 04576000
PSADSSTS EQU   PSA+816                                                  04577000
PSADSSWK EQU   PSA+812                                                  04578000
PSADSSR3 EQU   PSA+808                                                  04579000
PSADSSR2 EQU   PSA+804                                                  04580000
PSADSSRS EQU   PSA+800                                                  04581000
PSASTOR  EQU   PSA+796                                                  04582000
PSACPUSA EQU   PSA+794                                                  04583000
PSAVSTAP EQU   PSA+792                                                  04584000
PSAWKVAP EQU   PSA+788                                                  04585000
PSAWKRAP EQU   PSA+784                                                  04586000
PSAMCHIC EQU   PSA+783                                                  04587000
PSARV061 EQU   PSA+782                                                  04588000
PSASYMSK EQU   PSA+781                                                  04589000
PSAMCHFL EQU   PSA+780                                                  04590000
PSACR0   EQU   PSA+776                                                  04591000
PSAPSWSV EQU   PSA+768                                                  04592000
PSACLHS  EQU   PSAHLHI                                                  04593000
PSALKR15 EQU   PSALKSA+60                                               04594000
PSALKR14 EQU   PSALKSA+56                                               04595000
PSALKR13 EQU   PSALKSA+52                                               04596000
PSALKR12 EQU   PSALKSA+48                                               04597000
PSALKR11 EQU   PSALKSA+44                                               04598000
PSALKR10 EQU   PSALKSA+40                                               04599000
PSALKR9  EQU   PSALKSA+36                                               04600000
PSALKR8  EQU   PSALKSA+32                                               04601000
PSALKR7  EQU   PSALKSA+28                                               04602000
PSALKR6  EQU   PSALKSA+24                                               04603000
PSALKR5  EQU   PSALKSA+20                                               04604000
PSALKR4  EQU   PSALKSA+16                                               04605000
PSALKR3  EQU   PSALKSA+12                                               04606000
PSALKR2  EQU   PSALKSA+8                                                04607000
PSALKR1  EQU   PSALKSA+4                                                04608000
PSALKR0  EQU   PSALKSA                                                  04609000
PSARV023 EQU   PSACLHT+52                                               04610000
PSALOCAL EQU   PSACLHT+48                                               04611000
PSACMSL  EQU   PSACLHT+44                                               04612000
PSAOPTL  EQU   PSACLHT+40                                               04613000
PSATPACL EQU   PSACLHT+36                                               04614000
PSATPDNL EQU   PSACLHT+32                                               04615000
PSATPNCL EQU   PSACLHT+28                                               04616000
PSAIOSLL EQU   PSACLHT+24                                               04617000
PSAIOSUL EQU   PSACLHT+20                                               04618000
PSAIOSCL EQU   PSACLHT+16                                               04619000
PSAIOSSL EQU   PSACLHT+12                                               04620000
PSASALCL EQU   PSACLHT+8                                                04621000
PSAASML  EQU   PSACLHT+4                                                04622000
PSADISPL EQU   PSACLHT                                                  04623000
PSASRSA  EQU   PSA+636                                                  04624000
PSARV050 EQU   PSA+634                                                  04625000
PSADSSGO EQU   PSA+633                                                  04626000
PSARECUR EQU   PSA+632                                                  04627000
PSAHLHIS EQU   PSA+628                                                  04628000
PSAIPCSA EQU   PSA+624                                                  04629000
@NM00097 EQU   PSA+621                                                  04630000
PSAIPCDM EQU   PSA+620                                                  04631000
PSAIPCD  EQU   PSA+616                                                  04632000
@NM00096 EQU   PSA+613                                                  04633000
PSAIPCRM EQU   PSA+612                                                  04634000
PSAIPCR  EQU   PSA+608                                                  04635000
PSAMCHEX EQU   PSA+600                                                  04636000
PSAMPSW  EQU   PSA+592                                                  04637000
PSAEXPS2 EQU   PSA+584                                                  04638000
PSAEXPS1 EQU   PSA+576                                                  04639000
PSAPIREG EQU   PSA+572                                                  04640000
PSARSREG EQU   PSA+568                                                  04641000
PSAGPREG EQU   PSA+556                                                  04642000
PSARV022 EQU   PSASUP4                                                  04643000
PSARV021 EQU   PSASUP4                                                  04644000
PSARV020 EQU   PSASUP4                                                  04645000
PSARV019 EQU   PSASUP4                                                  04646000
PSARV018 EQU   PSASUP4                                                  04647000
PSARV017 EQU   PSASUP4                                                  04648000
PSARV016 EQU   PSASUP4                                                  04649000
PSARV015 EQU   PSASUP4                                                  04650000
PSARV014 EQU   PSASUP3                                                  04651000
PSAULCMS EQU   PSASUP3                                                  04652000
PSARV012 EQU   PSASUP3                                                  04653000
PSAESTA  EQU   PSASUP3                                                  04654000
PSASPR   EQU   PSASUP3                                                  04655000
PSAPSREG EQU   PSASUP3                                                  04656000
PSAPI2   EQU   PSASUP3                                                  04657000
PSAIOSUP EQU   PSASUP3                                                  04658000
PSALCR   EQU   PSASUP2                                                  04659000
PSARTM   EQU   PSASUP2                                                  04660000
PSAACR   EQU   PSASUP2                                                  04661000
PSAIPCE2 EQU   PSASUP2                                                  04662000
PSAIPCES EQU   PSASUP2                                                  04663000
PSAIPCEC EQU   PSASUP2                                                  04664000
PSAGTF   EQU   PSASUP2                                                  04665000
PSAIPCRI EQU   PSASUP2                                                  04666000
PSATYPE6 EQU   PSASUP1                                                  04667000
PSATCTL  EQU   PSASUP1                                                  04668000
PSADISP  EQU   PSASUP1                                                  04669000
PSALOCK  EQU   PSASUP1                                                  04670000
PSAPI    EQU   PSASUP1                                                  04671000
PSAEXT   EQU   PSASUP1                                                  04672000
PSASVC   EQU   PSASUP1                                                  04673000
PSAIO    EQU   PSASUP1                                                  04674000
PSAANEW  EQU   PSA+544                                                  04675000
PSATOLD  EQU   PSA+540                                                  04676000
PSATNEW  EQU   PSA+536                                                  04677000
PSALCCAR EQU   PSA+532                                                  04678000
PSALCCAV EQU   PSA+528                                                  04679000
PSAPCCAR EQU   PSA+524                                                  04680000
PSAPCCAV EQU   PSA+520                                                  04681000
PSACPULA EQU   PSA+518                                                  04682000
PSACPUPA EQU   PSA+516                                                  04683000
PSAPSA   EQU   PSA+512                                                  04684000
FLCHDEND EQU   PSA+512                                                  04685000
FLCCRSAV EQU   FLCMCLA+280                                              04686000
FLCGRSAV EQU   FLCMCLA+216                                              04687000
FLCFPSAV EQU   FLCMCLA+184                                              04688000
FLCFLA   EQU   FLCMCLA+88                                               04689000
FLCRGNCD EQU   FLCMCLA+84                                               04690000
FLCFSAA  EQU   FLCFSA+1                                                 04691000
@NM00095 EQU   FLCFSA                                                   04692000
@NM00094 EQU   FLCMCLA+72                                               04693000
FLCMCIC  EQU   FLCMCLA+64                                               04694000
@NM00093 EQU   FLCMCLA+20                                               04695000
FLCIOAA  EQU   FLCIOA+1                                                 04696000
@NM00092 EQU   FLCIOA                                                   04697000
@NM00091 EQU   FLCMCLA+15                                               04698000
@NM00090 EQU   FLCMCLA+14                                               04699000
@NM00089 EQU   FLCMCLA+12                                               04700000
FLCLCL   EQU   FLCMCLA+8                                                04701000
FLCIOELA EQU   FLCIOEL+1                                                04702000
@NM00088 EQU   FLCIOEL                                                  04703000
FLCCHNID EQU   FLCMCLA                                                  04704000
@NM00087 EQU   PSA+160                                                  04705000
FLCMTRCD EQU   PSA+157                                                  04706000
@NM00086 EQU   PSA+156                                                  04707000
FLCPERA  EQU   FLCPER+1                                                 04708000
@NM00085 EQU   FLCPER                                                   04709000
@NM00084 EQU   PSA+151                                                  04710000
FLCPERCD EQU   PSA+150                                                  04711000
FLCMCNUM EQU   PSA+149                                                  04712000
@NM00083 EQU   PSA+148                                                  04713000
FLCTEAA  EQU   FLCTEA+1                                                 04714000
@NM00082 EQU   FLCTEA                                                   04715000
PSAPIPC  EQU   PSAPICOD                                                 04716000
PSAPIMC  EQU   PSAPICOD                                                 04717000
PSAPIPER EQU   PSAPICOD                                                 04718000
PSARV049 EQU   FLCPICOD                                                 04719000
FLCPILCB EQU   FLCPIILC                                                 04720000
@NM00081 EQU   FLCPIILC                                                 04721000
@NM00080 EQU   PSAEPPSW                                                 04722000
FLCSVCN  EQU   PSAESPSW+2                                               04723000
FLCSILCB EQU   FLCSVILC                                                 04724000
@NM00079 EQU   FLCSVILC                                                 04725000
@NM00078 EQU   PSAESPSW                                                 04726000
FLCEICOD EQU   PSAEEPSW+2                                               04727000
PSASPAD  EQU   PSAEEPSW                                                 04728000
@NM00077 EQU   PSA+128                                                  04729000
FLCINPSW EQU   PSA+120                                                  04730000
FLCMNPSW EQU   PSA+112                                                  04731000
FLCPNPSW EQU   PSA+104                                                  04732000
FLCSNPSW EQU   PSA+96                                                   04733000
FLCENPSW EQU   PSA+88                                                   04734000
FLCTRACE EQU   PSA+84                                                   04735000
FLCTIMER EQU   PSA+80                                                   04736000
FLCCVT2  EQU   PSA+76                                                   04737000
FLCCAW   EQU   PSA+72                                                   04738000
FLCCSW   EQU   PSA+64                                                   04739000
FLCIOPSW EQU   PSA+56                                                   04740000
FLCMOPSW EQU   PSA+48                                                   04741000
FLCPOPSW EQU   PSA+40                                                   04742000
FLCSOPSW EQU   PSA+32                                                   04743000
FLCEOPSW EQU   PSA+24                                                   04744000
@NM00076 EQU   FLCICCW2+4                                               04745000
FLCCVT   EQU   FLCICCW2                                                 04746000
FLCICCW1 EQU   FLCROPSW                                                 04747000
FLCIPPSW EQU   FLCRNPSW                                                 04748000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04749000
@RC00269 EQU   @RC00266                                                 04750000
@RF00323 EQU   @RC00312                                                 04751000
@RF00412 EQU   @RC00381                                                 04752000
@RC00385 EQU   @RC00381                                                 04753000
@RC00462 EQU   @RC00459                                                 04754000
@RF00389 EQU   @RC00385                                                 04755000
@RC00464 EQU   @RC00462                                                 04756000
@RC00467 EQU   @RC00464                                                 04757000
@ENDDATA EQU   *                                                        04758000
         END   IEFBB416,(C'PLS1206',0701,78124)                         04759000
