         TITLE 'IEFSD101, PPT SCAN'                                     00050002
IEFSD101 CSECT                                                   Y01054 00100000
*        SEE CHANGE ACTIVITY IN PROLOG FOR FLAGGING INFORMATION.        00110002
* C-STATEMENTS NEAR LABEL LPPT8                                @ZA03944 00115041
* A STATEMENTS NEAR LABEL SKIPKEY                              @ZA11857 00120041
* A STATEMENTS NEAR LABEL LPPT3                                @ZA11857 00125041
* DELETED STATEMENTS THAT WERE ADDED FOR @ZA11857              @ZA16879 00133041
* CHANGED STATEMENT NEAR LPPT3 AND ADDED STATEMENTS NEAR LPPT9 @ZA16879 00138041
* C STATEMENTS AFTER LABEL CONTINUE                            @ZA20168 00144041
         BALR  R12,0                                                    00150000
*                                                                     * 00200000
*********************************************************************** 00450000
*                                                                     * 00500000
*     MODULE NAME = IEFSD101                                            00550002
*                                                                       00600002
*     DESCRIPTIVE NAME = PPT SCAN                                       00650002
*                                                                       00660002
*     COPYRIGHT = NONE                                                  00670002
*                                                                       00700002
*     STATUS = SU7 PTF                                         @ZA20168 00720041
*                                                                       00800002
*     FUNCTION = TO SCAN THE PROGRAM PROPERTIES TABLE (PPT),            00850002
*     ASSIGN SPECIAL PROPERTIES WHERE INDICATED, AND BUILD THE          00860002
*     GETPART WORK TABLE (GWT).                                         00900002
*                                                                       00950002
*      OPERATION:                                                       01000002
*                                                                       01050002
*      1) CALL IEFSMFIE FOR SMF PROCESSING.                             01100002
*                                                                       01160002
*      1A) SET UP FIELDS CHSTEP AND CHPROCSN FOR USE BY         YM06960 01170002
*      THE PROCESSOR OF DISPLAY A.                              YM06960 01180002
*                                                                       01200002
*      2) IF THE STEP IS TO RUN IN V=R, MOVE THE PROTECT KEY IN         01250002
*      THE JCT TO THE TCB. IF THE STEP IS TO RUN IN V=V, MOVE A         01300002
*      PROTECT KEY OF 8 TO THE TCB. (THE KEY WILL BE PROPOGATED         01350002
*      WHEN THE DAUGHTER IS ATTACHED.)                                  01400002
*                                                                       01450002
*      3) BEFORE ASSIGNING ANY SPECIAL PROPERTIES TURN OFF ALL          01500002
*      PROPERTIES WHICH MAY HAVE BEEN SET FOR A PREVIOUS STEP.          01510002
*      THEN SCAN THE PPT FOR THE PROGRAM NAME. IF                       01520002
*      NOT FOUND, SKIP TO STEP 4. IF FOUND, SET AN INDICATOR            01530002
*      IN THE LCT THAT THE NAME WAS IN THE PPT.                         01540002
*                                                                       01542002
*         A) IF THE 'NON-CANCELABLE' PROPERTY IS INDICATED, SET         01544002
*         AN INDICATOR IN THE LCT AND SET THE CSCB NON-                 01546002
*         CANCELABLE.                                                   01546402
*                                                                       01546802
*         B) IF A SPECIAL PROTECT KEY IS INDICATED, MOVE THE     Y02656 01547202
*         PROTECT KEY FROM THE PPT TO THE CURRENT TCB. (THIS     Y02656 01547602
*         WILL OVERLAY THE KEY PREVIOUSLY SET.)                  Y02656 01547702
*                                                                       01548502
*         C) IF THE PROGRAM NAME IS AUTHORIZED TO BE NON-        Y02669 01548602
*         SWAPPABLE, SET THE CORRESPONDING INDICATOR IN THE      Y02669 01548702
*         LCT.                                                 @ZA16879 01549241
*                                                                       01550402
*         D) IF THE PROGRAM NAME IS 'PRIVILEGED' (WITH RESPECT   Y02655 01552402
*         TO THE SYSTEM RESOURCES MANAGER) SET AN INDICATOR IN   Y02655 01552502
*         THE LCT.                                               Y02655 01552902
*                                                                       01554502
*         E) IF THE 'SYSTEM TASK' PROPERTY IS INDICATED AND THE  Y02652 01556502
*         JOB IS 'STARTED' AND '1-STEP', SET THE SYSTEM TASK     Y02652 01556602
*         INDICATOR IN THE LCT. IF THE 'SYSTEM TASK' PROPERTY    Y02652 01556702
*         IS INDICATED BUT THE OTHER TWO CONDITIONS ARE NOT MET, Y02652 01557202
*         SET THE INDICATOR IN THE LCT WHICH INDICATES THAT      Y02652 01557602
*         IEFSD162 SHOULD ISSUE MESSAGE IEF188I PROBLEM PROGRAM  Y02652 01558002
*         ATTRIBUTES ASSIGNED.                                   Y02652 01558102
*                                                                       01558402
*         F) IF THE 'NO DATA SET INTEGRITY' (NDSI) PROPERTY IS   Y02652 01558802
*         INDICATED AND THE JOB IS 1-STEP, SET THE INDICATOR IN  Y02652 01559202
*         THE LCT WHICH INDICATES THAT 'NO DATA SET INTEGRITY'   Y02652 01559302
*         HAS BEEN REQUESTED. IF THERE IS NO UNAUTHORIZED JOBLIB Y02652 01559402
*         OR STEPLIB, THE PROPERTY WILL BE ASSIGNED BY IEFSD162. Y02652 01560602
*         IF THE NDSI PROPERTY IS INDICATED AND THE JOB IS MULTI-Y02652 01565402
*         STEP, SET THE INDICATOR IN THE LCT WHICH INDICATES     Y02652 01566602
*         THAT IEFSD162 SHOULD ISSUE MESSAGE IEF188I PROBLEM     Y02652 01567802
*         PROGRAM ATTRIBUTES ASSIGNED. THEN PROCEED TO STEP 4.   Y02652 01569002
*                                                                       01569102
*         G. IF THIS IS THE FIRST STEP OF A JOB, CONTINUE WITH   Y02651 01569402
*         STEP H, BECAUSE TASK AFFINITY IS SET ELSEWHERE FOR THE Y02651 01569502
*         FIRST STEP. IF THE MASK FOR CPU-TASK AFFINITY IS ALL   Y02651 01569802
*         BINARY 1'S, CONTINUE WITH STEP H (BECAUSE NO SPECIAL   Y02651 01569902
*         CPU IS REQUIRED FOR THAT PROGRAM). IF NOT ALL BINARY   Y02651 01570002
*         1'S, INVOKE IEFICPUA TO SET THE AFFINITY IN THE ASCB.  Y02651 01570102
*         IF THE RETURN CODE IS 0, CONTINUE WITH STEP H. IF THE  Y02651 01571502
*         RETURN CODE IS NON-ZERO, SET THE JOB FAILED INDICATOR  Y02651 01571902
*         IN THE JCT AND ISSUE MESSAGE IEF173I, TO INDICATE      Y02651 01572302
*         THAT THE JOB HAS BEEN FAILED.                          Y02651 01572702
*         (IEFIMASK IS INVOKED TO CONVERT THE 16-BIT MASK OF     Y02651 01573102
*         CPU'S REQUIRED FOR AFFINITY TO THE LIST OF CPU ID'S    Y02651 01574202
*         WHICH IS REQUIRED FOR THE MESSAGE.)                    Y02651 01576202
*                                                                       01578202
*         H. IF THE PROPERTY 'BYPASS PASSWORD PROTECTION' IS     Y02656 01579002
*         INDICATED, SET THE CORRESPONDING INDICATOR IN THE      Y02656 01580102
*         JSCB.                                                  Y02656 01581202
*                                                              @ZA16879 01581341
*         I. IF THE PROPERTY 'FIRST LEVEL PREFERRED USAGE'     @ZA16879 01581441
*         IS INDICATED, SET THE CORRESPONDING INDICATOR IN     @ZA16879 01581541
*         THE LCT.                                             @ZA16879 01581641
*                                                              @ZA16879 01581741
*         J. IF THE PROPERTY 'SECOND LEVEL PREFERRED USAGE'    @ZA16879 01581841
*         IS INDICATED, SET BOTH THE FIRST AND SECOND LEVEL    @ZA16879 01581941
*         PREFERRED USAGE INDICATORS IN THE LCT.               @ZA16879 01582041
*                                                              @ZA16879 01582141
*         K. IF THE PROPERTY 'NOT SECOND LEVEL PREFERRED       @ZA16879 01582241
*         USAGE' IS INDICATED, SET THE CORRESPONDING INDICATOR @ZA16879 01582341
*         IN THE LCT.                                          @ZA16879 01582441
*                                                                       01583641
*      3A. IF THIS IS A CHECKPOINT RESTART JOB STEP, THE SCT   @ZA20168 01584241
*      PROGRAM NAME FIELD WILL BE CHANGED TO IEFRSTRT WHICH    @ZA20168 01584341
*      INVOKES THE RESTART SVC. THE RESTART SVC COMPLETES      @ZA20168 01584441
*      RESTART PROCESSING. THIS IS DONE AFTER PPT PROCESSING   @ZA20168 01584541
*      IS COMPLETE FOR REAL PROGRAM NAME.                      @ZA20168 01584641
*                                                                       01584741
*      4. THE GETPART WORK TABLE (GWT) IS THEN BUILT, BUT ONLY   Y02669 01584841
*      IF THE CURRENT STEP IS TO BE EXECUTED AND ONE OF THE      Y02669 01584941
*      FOLLOWING IS TRUE:                                        Y02669 01585602
*      .  A REGION SIZE WAS SPECIFIED                            Y02669 01586702
*      .  V=R WAS SPECIFIED                                      Y02669 01587802
*      .  A REGION BEGINNING AT A SPECIFIC ADDRESS IS REQUIRED   Y02669 01588902
*         (FOR A CHECKPOINT RESTART).                            Y02669 01590002
*      (THESE ARE THE ONLY SITUATIONS UNDER WHICH A REGION IS    Y02669 01591102
*      GOTTEN FOR A STEP.)                                       Y02669 01592202
*                                                                       01593302
*      5. THEN EXIT TO IEFSD102.                                        01594402
*                                                                       01595502
*     NOTES                                                             01596602
*                                                                       01597702
*      CHARACTER DEPENDENT CODE = NONE                                  01598802
*                                                                       01599902
*      DEPENDENCIES = IEFSDPPT, THE PROGRAM PROPERTIES TABLE            01601002
*                     CONTAINS PROGRAM NAMES                            01602102
*                                                                       01603202
*      RESTRICTIONS = NONE                                              01604302
*                                                                       01605402
*      REGISTER CONVENTIONS = STANDARD                                  01606502
*                                                                       01607602
*      PATCH LABEL = PATCH                                              01608702
*                                                                       01609802
*     MODULE TYPE = PROCEDURE                                           01609902
*                                                                       01611302
*      PROCESSOR = ASSEMBLER                                            01612702
*                                                                       01614102
*      MODULE SIZE = 1000 BYTES                                         01615502
*                                                                       01616902
*      ATTRIBUTES = PAGED LPA, ZERO PSW PROTECT KEY,                    01618302
*                   REENTRANT, REFRESHABLE, SUPERVISOR STATE            01619702
*                                                                       01621102
*     ENTRY POINT = IEFSD101                                            01622502
*                                                                       01623902
*           PURPOSE = SAME AS FUNCTION                                  01625302
*                                                                       01626702
*           LINKAGE =                                                   01628102
*           FROM IEFSD161 VIA BRANCH FOR FIRST STEP OF JOB              01629502
*           FROM IEFSD164 VIA BRANCH FOR OTHER THAN FIRST STEP          01630902
*                                                                       01632302
*           INPUT DATA = REGISTER ONE POINTS TO LCT                     01633702
*                        LCTSCTAD, SCT ADDRESS                          01635102
*                        LCTQDRTY, CSCB ADDRESS                         01636502
*                                                                       01637902
*           REGISTERS SAVED = NONE                                      01639302
*                                                                       01640702
*           REGISTERS CONTENTS DURING PROCESSING =                      01642102
*           R10 POINTS TO LCT                                           01643502
*           R15 POINTS TO ENTRY IN PPT                                  01644902
*                                                                       01646302
*           REGISTERS RESTORED = NONE                                   01647702
*                                                                       01649102
*     EXIT - NORMAL = TO IEFSD102 VIA BRANCH                            01650502
*                                                                       01651902
*            CONDITIONS = ALWAYS                                        01653302
*                                                                       01654702
*            OUTPUT DATA =   GETPART PARAMETER LIST POINTER IN LCT      01656102
*                            LCT ADDRESS IN REG 1                       01657502
*                                                                       01658902
*            RETURN CODES = NONE                                        01660302
*                                                                       01661702
*     EXIT - ERROR = NONE                                               01663102
*                                                                       01664502
*     EXTERNAL REFERENCES :                                             01668402
*                                                                       01668802
*           ROUTINES =                                                  01669202
*           IEFSMFIE, TO SET UP USER JOB AND STEP                       01670402
*           INITIATION EXITS FOR SMF, CALLED VIA BALR                   01672402
*           INPUT IS ADDRESS OF LCT IN REG 1                            01674402
*                                                                       01674502
*           IEFICPUA TO SET THE MASK FOR TASK-CPU AFFINITY IN    Y02651 01674602
*              THE ASCB.                                         Y02651 01674702
*           INPUTS:                                              Y02651 01674802
*              A MASK OF ELIGIBLE CPU'S                          Y02651 01677002
*              A MASK OF ONLINE CPU'S                            Y02651 01679002
*              AN AREA TO RETURN THE MASK OF ELIGIBLE CPU'S      Y02651 01679402
*                 WHICH ARE ONLINE                               Y02651 01679502
*           LINKAGE IS VIA BALR                                  Y02651 01679602
*           OUTPUT IS THE MASK FOR TASK-CPU AFFINITY SET WHERE   Y02651 01679702
*              INDICATED (IN THE ASCB).                          Y02651 01679902
*              RETURN CODE IS 0 IF AFFINITY WAS SUCCESSFULLY     Y02651 01680002
*              SET OR NON-ZERO IF NOT SET.                       Y02651 01680102
*                                                                       01680202
*           IEFIMASK TO CONVERT A BIT STRING TO A CORRESPONDING  Y02651 01680302
*              LIST OF HEXADECIMAL CHARACTERS.                   Y02651 01681202
*           INPUT:                                               Y02651 01681602
*              THE BIT STRING TO BE CONVERTED                    Y02651 01682002
*              A HALFWORD CONTAINING THE NUMBER OF BITS TO BE    Y02651 01682402
*                 CONVERTED (16)                                 Y02651 01682802
*              AN AREA TO CONTAIN THE OUTPUT LIST                Y02651 01682902
*              A HALFWORD TO CONTAIN THE NUMBER OF ENTRIES PUT   Y02651 01683002
*                 IN THE LIST                                    Y02651 01683102
*           LINKAGE IS VIA BALR.                                 Y02651 01683402
*           OUTPUT:                                              Y02651 01683802
*              A LIST OF PRINTABLE HEXADECIMAL CHARACTERS,       Y02651 01683902
*                 REPRESENTING THE BIT POSITIONS IN THE INPUT    Y02651 01684002
*                 LIST WHICH WERE ON. THE ELEMENTS OF THE LIST   Y02651 01684102
*                 ARE SEPARATED BY COMMAS.                       Y02651 01684202
*              A HALFWORD, CONTAINING THE NUMBER OF ENTRIES      Y02651 01684302
*                 PUT IN THE LIST                                Y02651 01684602
*                                                                       01685402
*            DATA AREAS = IEFSDPPT, THE PROGRAM PROPERTIES TABLE,       01685802
*            TO ASSIGN PROPERTIES TO THE PROGRAM BEING ATTACHED.        01686202
*                                                                       01686702
*            CONTROL BLOCKS = CSCB, JCT, LCT, SCT, TCB,                 01689002
*              CVT, CSD, ASCB, JSCB                            @ZA16879 01690041
*                                                                       01693602
*            TABLES = GWT (PARAMETER LIST FOR GETPART)                  01695902
*                                                                       01698202
*            MACROS = GETMAIN, FREEMAIN, WTO                     Y02651 01708502
*                                                                       01708602
*            ENQUEUE RESOURCES = NONE                                   01713402
*                                                                       01715402
*            CHANGE LEVEL = SEE MODID MACRO AT BEGINNING OF MODULE.     01717402
*        CODE HAS BEEN ADDED FOR THE FOLLOWING SUPPORT CODES:           01717802
*                                                                Y02652 01718202
*                                                                Y02655 01718602
*                                                                Y02656 01719002
*                                                                Y02669 01719102
*                                                                Y02651 01719402
*                                                                       01719741
*        CODE HAS BEEN ADDED FOR THE FOLLOWING APARS:                   01720041
*                                                              @ZA03944 01720341
*                                                              @ZA11857 01720641
*                                                              @ZA16879 01721241
*                                                              @ZA20168 01721341
*                                                                       01721841
*     MESSAGES = IEF173I JJJ FAILED, CPU (X,Y,...) OFFLINE       Y02651 01722341
*                                                                       01723402
*********************************************************************** 01725402
         EJECT                                                          01727802
R0       EQU   0                                                        01727902
R1       EQU   1                                                        01728002
R2       EQU   2                                                        01728102
R3       EQU   3                                                        01728202
R4       EQU   4                                                        01728502
R5       EQU   5                                                        01728602
R6       EQU   6                                                        01728702
R7       EQU   7                                                        01728802
R8       EQU   8                                                        01728902
R9       EQU   9                                                        01729002
R10      EQU   10                                                       01729402
R11      EQU   11                                                       01729702
R12      EQU   12                                                       01730102
R13      EQU   13                                                       01730502
R14      EQU   14                                                       01730902
R15      EQU   15                                                       01731302
         USING *,R12                                                    01743202
         USING  IEFLOT,R10                                              01746602
         USING IEFSCT,R9                                                01750000
IEFSD101 MODID                                                   Y01886 01800000
         LR    R10,R1                   LCT ADDRESS                     02300000
*********************************************************************** 02760002
*                                                                       02770002
*        CALL IEFSMFIE FOR SMF PROCESSING                               02780002
*                                                                       02790002
*********************************************************************** 02792002
         L     R15,VCONSMF             GO TO SMF INIT EXIT         SMF1 02850000
         BALR  R14,R15                 PASS LCT IN R1              SMF1 02900000
         L     R4,LCTJCTAD         ADDRESS OF JCT                 M0396 02950002
         USING JCT,R4              JCT ADDRESSABILITY             M0396 03000002
         L     R9,LCTSCTAD              GET SCT ADDRESS                 03050002
         L     R8,LCTTCBAD         GET POINTER TO CURRENT TCB    Y02652 03100002
         USING TCB,R8                                            Y02652 03150002
*********************************************************************** 03152002
*                                                                       03154002
*        SET UP FIELDS IN CSCB TO BE USED BY DISPLAY A                  03156002
*                                                                       03158002
*********************************************************************** 03160002
         L     R2,LCTQDRTY         ADDRESS OF CSCB               Y02652 03162002
         USING IEFCSCB,R2          CSCB ADDRESSABILITY           Y02652 03164002
         CLI   CHTRKID,CHTSID      CHECK FOR LOGON              YM06960 03166002
         BE    SKIPCODE            NO PROCESSING IS REQUIRED    YM06960 03168002
*                                  IF LOGON                     YM06960 03170002
*        DIFFERENT PROCESSING IS DONE, DEPENDING UPON WHETHER   YM06960 03178002
*        THE CSCB IS FOR A 'JOB' OR 'START OR MOUNT'            YM06960 03180002
         CLI   CHVCD,CHXSTART                                   YM06960 03182002
         BE    SMCSCB              START                        YM06960 03184002
         CLI   CHVCD,CHXMOUNT                                   YM06960 03186002
         BE    SMCSCB              MOUNT                        YM06960 03188002
*        INITIATED JOB'S PROCESSING                             YM06960 03200002
         CLC   SCTSCLPC,BLANKS     CHECK WHETHER A PROC WAS     YM06960 03202002
*                                  INVOLVED                     YM06960 03204002
         BE    NOPROC              NO PROC (OR A PROC WITH NO   YM06960 03206002
*                                  NAME ON THE EXEC PROC=       YM06960 03208002
*                                  STATEMENT)                   YM06960 03210002
         MVC   CHSTEP,SCTSCLPC     PUT NAME OF STEP WHICH       YM06960 03212002
*                                  CALLED THE PROC AS THE       YM06960 03214002
*                                  STEPNAME                     YM06960 03216002
         MVC   CHPROCSN,SCTSNAME   PUT NAME ON EXEC PGM=        YM06960 03218002
*                                  STATEMENT AS PROCSTEPNAME    YM06960 03220002
         B     SKIPCODE            SKIP ELSE CLAUSE(S)          YM06960 03222002
NOPROC   EQU   *                                                YM06960 03224002
         MVC   CHSTEP,SCTSNAME     SET STEPNAME FOR STEP WITH   YM06960 03226002
*                                  NO PROC INVOLVED             YM06960 03228002
         MVC   CHPROCSN,BLANKS     CLEAR PROCSTEPNAME           YM06960 03229002
         B     SKIPCODE            SKIP ELSE CLAUSE(S)          YM06960 03230002
SMCSCB   EQU   *                                                YM06960 03232002
         MVC   CHPROCSN,SCTSNAME   SET PROCSTEPNAME FOR START   YM06960 03250002
*                                  OR MOUNT                     YM06960 03260002
SKIPCODE EQU   *                                                YM06960 03270002
*********************************************************************** 03280002
*                                                                       03290002
*        ASSIGN PROTECT KEY                                             03300002
*                                                                       03350002
*********************************************************************** 03400002
         TM    SCTSSTAT,EAADDRBT   CHECK FOR V=R                 Y02656 03450002
         BNO   VIRTKEY             NOT V=R, SET V=V KEY          Y02656 03500002
         MVC   TCBPKF,JCTJSRNO     MOVE UNIQUE KEY FOR V=R       Y02656 03550002
         B     SKIPKEY             BRANCH AROUND 'ELSE' CLAUSE   Y02656 03600002
VIRTKEY  EQU   *                                                 Y02656 03650002
         MVI   TCBPKF,KEYVIRT      SET V=V KEY                   Y02656 03700002
SKIPKEY  EQU   *                                                 Y02656 03750002
*********************************************************************** 03800002
*                                                                       03850002
*       TURN OFF PROPERTIES SET FOR PREVIOUS STEP                       03900002
*                                                                       03950002
*********************************************************************** 04000002
*        (THE PREVIOUS STEP MAY EVEN BE IN THE PREVIOUS JOB,     Y02652 04002002
*        BECAUSE THE LCT IS NOT AUTOMATICLY CLEARED BETWEEN      Y02652 04004002
*        JOBS.)                                                  Y02652 04006002
         L     R5,LCTJSCB          POINT TO P/P JSCB             Y02656 04022002
         USING IEZJSCB,R5                                        Y02656 04024002
         L     R7,LCTASCBA         POINT TO ASCB                 Y02652 04030002
         USING ASCB,R7                                           Y02652 04040002
         XC    LCTINTSW(D1),LCTINTSW  ZERO INTERNAL SWITCHES       I272 05000000
         MVI   LCTINTS2,CLEAR      CLEAR STEP RELATED SWITCHES   Y02652 05050002
         MVI   LCTPUBYT,CLEAR      CLEAR PREFERRED USAGE FLAGS @ZA16879 05100041
         OI    CHACT,CHCL          MAKE STEP CANCELLABLE          M0396 05350000
         NI    LCTOPSW1,FOXFOX-LCTCANF TURN OFF CANCEL AT ALLOC   M1377 05400000
         TM    SCTSDP,SCTFSTEP                                   Y02651 05440402
         BO    LEAVAFFN            TURN OFF CPU-TASK AFFINITY    Y02651 05440802
*              ONLY IF NOT FIRST STEP OF A JOB. PROCESSING FOR   Y02651 05441202
*              THE FIRST STEP IS PERFORMED IN IEFSD161.          Y02651 05441602
         MVC   ASCBAFFN,NOAFFIN    TURN OFF CPU-TASK AFFINITY    Y02651 05442002
*        (IT IS USUALLY TURNED OFF BY IEFSD263, BUT IEFSD263 WILLY02651 05442402
*        BE BYPASSED IF THERE IS AN ALLOCATION ERROR.)           Y02651 05442802
LEAVAFFN EQU   *                                                 Y02651 05442902
         NI    JSCBSWT1,X'FF'-JSCBPASS TURN OFF BYPASS PASSWORD  Y02656 05443202
*                                  PROTECTION                    Y02656 05443702
*                                                                       05444002
*        CHECK WHETHER TO SCAN PPT                               Y02652 05446002
*                                                                       05448002
         TM    CHCECB,POSTED       HAS JOB BEEN CANCELLED         M0396 05450000
         BO    CONTINUE            SKIP CHECKING PPT             Y01054 05500000
         TM    JCTJSTAT,INCMSTS    HAS JOB BEEN FAILED            M0396 05700000
         BO    CONTINUE            YES, DO NOT PERFORM SCAN       M3174 05750000
         TM    LCTOPSW3,LCTNSYS    CHECK WHETHER SPECIAL         Y02652 05752002
*                                  PROPERTIES MAY BE ASSIGNED    Y02652 05754002
         BO    CONTINUE            CANNOT BE ASSIGNED            Y02652 05756002
*********************************************************************** 05760002
*                                                                       05770002
*        SCAN PROGRAM PROPERTIES TABLE AND ASSIGN PROPERTIES            05780002
*                                                                       05790002
*********************************************************************** 05792002
         L     R11,IEFSDPPT        GET ADDR OF PROB PROG TABLE    20032 05800002
         USING PPT,R11                                           Y01054 05850002
CHKEND   EQU   *                                                 Y02652 05860002
         CLI   PPTNAME,FOXFOX      CHECK FOR END OF TABLE        Y01054 05900002
         BE    CONTINUE            NAME NOT IN PPT               Y02652 05910002
         CLC   PPTNAME(D8),SCTPGMNM                              Y01054 05950000
         BE    LPPT1               BRANCH IF PROGRAM NAME IS IN  Y01054 06000000
*                                  PPT                           Y01054 06050000
         LA    R11,PPTLEN(0,R11)   INCREMENT POINTER IN PPT      Y01054 06100002
         B     CHKEND              CHECK NEXT ENTRY              Y02652 06150002
         SPACE                                                          06200002
*********************************************************************** 06210002
LPPT1    EQU   *                                                 Y01054 06250000
         OI    LCTINTSW,LCTINPPT   INDICATE THAT NAME IS IN PPT  Y02652 06260002
*        NON-CANCELABLE                                          Y02652 06270002
*                                                                       06280002
         TM    PPTBYTE1,PPTNCNCL   IS PROGRAM TO BE              Y01054 06300000
*                                  NON-CANCELABLE                Y01054 06350000
         BNO   LPPT2               NO, DON'T SET INDICATOR       YO1054 06400000
         OI    LCTOPSW1,LCTCANF    YES, INDICATE NON-CANCELABLE  Y01054 06450000
         NI    CHACT,X'FF'-CHCL    SET NON-CANCELABLE            Y02652 06452002
         SPACE                                                          06460002
*********************************************************************** 06470002
LPPT2    EQU   *                                                 Y01054 06500000
*        SPECIAL PROTECT KEY                                     Y02656 06520002
*                                                                       06530002
         TM    PPTBYTE1,PPTSKEY                                  Y02656 06580002
         BNO   LPPT3               CHECK NEXT PROPERTY           Y02656 06630002
         MVC   TCBPKF,PPTKEY   MOVE SPECIAL KEY                  Y02656 06680002
         SPACE                                                          06690002
*********************************************************************** 06700002
LPPT3    EQU   *                                                 Y02652 06730002
*        NON-SWAPPABLE                                           Y02669 06830002
*                                                                       06880002
         TM    PPTBYTE1,PPTNSWP                                  Y02669 07090002
         BNO   LPPT4               CHECK NEXT PROPERTY           Y02669 07092002
         OI    LCTPUBYT,LCTNSWP    INDICATE NON-SWAPPABLE      @ZA16879 07092641
         SPACE                                                          07098002
*********************************************************************** 07098102
LPPT4    EQU   *                                                 Y02652 07098402
*        PRIVILEGED                                              Y02655 07098602
*                                                                       07098702
         TM    PPTBYTE1,PPTPRIV                                  Y02655 07098802
         BNO   LPPT5               CHECK NEXT PROPERTY           Y02655 07099202
         OI    LCTINTSW,LCTPRIV    SET TO BE PRIVILEGED          Y02655 07099602
         SPACE                                                          07099702
*********************************************************************** 07099802
LPPT5    EQU   *                                                 Y02652 07100002
*        SYSTEM TASK                                             Y02652 07106002
*                                                                       07108002
         TM    PPTBYTE1,PPTSYSTK                                 Y02652 07108202
         BNO   LPPT6               CHECK NEXT PROPERTY           Y02652 07112402
*        TO BE A SYSTEM TASK, A JOB MUST BE BOTH 'STARTED' AND   Y02652 07114402
*        '1-STEP'                                                Y02652 07116402
         TM    LCTOPSW1,LCTONEJF   CHECK FOR STARTED TASK        Y02652 07116502
         BNO   SETPPAA1            TASK IS NOT STARTED           Y02652 07119802
*        (ALTHOUGH LCTONEJF IS SET FOR LOGON, ALL PPT PROCESSING Y02652 07120202
*        IS SKIPPED FOR LOGON BECAUSE LCTNSYS IS SET.)           Y02652 07120602
         TM    SCTSDP,SCTFSTEP     FIRST HALF OF CHECK FOR 1-STEPY02652 07121802
         BNO   SETPPAA1            NOT FIRST STEP                Y02652 07122202
         L     R8,SCTANSCT         IF 1-STEP, PTR. TO NEXT SCT   Y02652 07122602
*                                  IS 0                          Y02652 07123002
         LTR   R8,R8                                             Y02652 07123102
         BZ    SETSYSTK            TASK IS 1-STEP                Y02652 07123202
SETPPAA1 EQU   *                                                 Y02652 07128002
         OI    LCTINTSW,LCTPPAA    INDICATE WARNING MSG. SHOULD  Y02652 07130002
*                                  BE WRITTEN                    Y02652 07132002
         B     LPPT6               SKIP 'ELSE' CLAUSE            Y02652 07132402
SETSYSTK EQU   *                                                 Y02652 07132502
         OI    LCTINTS2,LCTSYS     SET AS SYSTEM TASK            Y02652 07132802
         SPACE                                                          07142402
*********************************************************************** 07147202
LPPT6    EQU   *                                                 Y02652 07152002
*        NO DATA SET INTEGRITY                                   Y02652 07156802
*                                                                       07161602
         TM    PPTBYTE1,PPTNDSI                                  Y02652 07166402
         BNO   LPPT7               CHECK NEXT PROPERTY           Y02652 07171202
*        TO HAVE NDSI, A JOB MUST BE '1-STEP'                    Y02652 07173202
         TM    SCTSDP,SCTFSTEP     FIRST HALF OF CHECK FOR 1-STEPY02652 07175202
         BNO   SETPPAA2            NOT FIRST STEP                Y02652 07175602
         L     R8,SCTANSCT         IF 1-STEP, PTR. TO NEXT SCT   Y02652 07175702
*                                  IS 0                          Y02652 07175802
         LTR   R8,R8                                             Y02652 07175902
         BZ    SETNDSI             TASK IS 1-STEP                Y02652 07185102
SETPPAA2 EQU   *                                                 Y02652 07200402
         OI    LCTINTSW,LCTPPAA    INDICATE WARNING MSG. SHOULD  Y02652 07202402
*                                  BE WRITTEN                    Y02652 07202802
         B     LPPT7               SKIP 'ELSE' CLAUSE            Y02652 07203202
SETNDSI  EQU   *                                                 Y02652 07203602
         OI    LCTINTSW,LCTNDSI    SET NDSI                      Y02652 07203702
         SPACE                                                          07204002
*********************************************************************** 07206002
LPPT7    EQU   *                                                 Y02652 07206402
*        CPU-TASK AFFINITY                                       Y02651 07206802
*                                                                Y02615 07207202
         TM    SCTSDP,SCTFSTEP     CHECK FOR FIRST STEP. THE     Y02651 07207602
*                                  FIRST STEP IS CHECKED FOR     Y02651 07207702
*                                  AFFINITY IN A PREVIOUS MODULE Y02651 07207802
*                                  SO THE JOB CAN                Y02651 07208202
*                                  BE PUT ON THE HOLD QUEUE IF   Y02651 07209602
*                                  NECESSARY                     Y02651 07210002
         BO    LPPT8               CHECK NEXT PROPERTY IF FIRST  Y02651 07211202
*                                  STEP                          Y02651 07211602
         CLC   PPTCPUA,NOAFFIN     DO NOT ASSIGN AFFINITY IF     Y02651 07211702
*                                  PROGRAM CAN RUN ON ANY CPU    Y02651 07211802
         BE    LPPT8               CHECK NEXT PROPERTY           Y02651 07212202
*        GET TEMPORARY STORAGE REQUIRED TO ASSIGN CPU-TASK       Y02651 07212602
*        AFFINITY                                                Y02615 07213002
         LA    R0,GETMAIN2                                       Y02651 07213202
         GETMAIN R,LV=(0)                                        Y02651 07213302
         LR    R8,R1               SAVE PTR. TO WORKAREA         Y02651 07213702
         USING WORKAREA,R8                                       Y02651 07213802
         LA    R13,REGSAVE         POINT TO REGISTER SAVE AREA   Y02651 07214102
         SPACE                                                          07214202
*        INVOKE IEFICPUA TO ASSIGN AFFINITY                      Y02651 07214302
         LA    R15,PPTCPUA         PASS MASK OF ELIGIBLE CPU'S   Y02651 07214402
         ST    R15,ICPUMEP                                       Y02651 07214502
*        PASS MASK OF AVAILABLE CPU'S (IN CSD)                   Y02651 07214602
         L     R15,CVTPTR                                        Y02651 07214702
         USING CVTMAP,R15                                        Y02651 07214802
         L     R15,CVTCSD                                        Y02651 07214902
         USING CSD,R15                                           Y02651 07215002
         LA    R15,CSDCPUJS                                      Y02651 07216402
         ST    R15,ICPUMAP                                       Y02651 07218802
         DROP  R15                                               Y02651 07218902
         LA    R15,ASCBAFFN        PASS AREA TO RETURN MASK OF   Y02651 07219202
*                                  ELIGIBLE AND ONLINE CPU'S     Y02651 07219302
         ST    R15,ICPUMOP                                       Y02651 07219402
         L     R15,VCONICPU                                      Y02651 07219502
         BALR  R14,R15                                           Y02651 07219602
         LTR   R15,R15             IF RETURN CODE IS 0,          Y02651 07219702
*                                  PROCESSING FOR AFFINITY IS    Y02651 07219802
*                                  COMPLETE                      Y02651 07219902
         BZ    AFFINOK             SKIP ERROR PROCESSING         Y02651 07221802
         SPACE                                                          07224402
*        BECAUSE AFFINITY COULD NOT BE ASSIGNED (INDICATED BY A  Y02651 07224802
*        NON-ZERO RETURN CODE FROM IEFICPUA), FAIL THE JOB AND   Y02651 07225202
*        ISSUE MESSAGE IEF173I                                   Y02651 07225302
         OI    JCTJSTAT,INCMSTS    FAIL THE JOB                  Y02651 07225402
         L     R15,LCTIMSG         POINT TO TABLE AT BEGINNING   Y02651 07225502
*                                  OF MESSAGE MODULE             Y02651 07228202
         USING MESSAGES,R15                                      Y02651 07230202
         AH    R15,DISPLD          ADD DISPLACEMENT IN MESSAGE   Y02651 07232202
*                                  MODULE TO ADDRESS OF MESSAGE  Y02651 07232602
*                                  MODULE TO GET POINTER TO      Y02651 07233002
*                                  MESSAGE                       Y02651 07233402
         MVC   MSGD(MSGDLEN),0(R15) MOVE MSG. TEXT TO BUFFER     Y02651 07233902
         MVC   MSGDJOB,JCTJNAME    MOVE JOBNAME TO MESSAGE       Y02651 07235402
         SPACE                                                          07237402
*        INVOKE IEFIMASK TO CONVERT THE BIT MASK TO A LIST       Y02651 07237802
         DROP  R15                                               Y02651 07237902
         LA    R15,MASKLEN         SET UP LENGTH OF BIT STRING   Y02651 07238202
         STH   R15,IMSKNUMI                                      Y02651 07238302
         LA    R15,PPTCPUA         PASS BIT STRING               Y02651 07238602
         ST    R15,IMSKMSKP                                      Y02651 07239002
         LA    R15,IMSKNUMI        PASS LENGTH OF BIT STRING     Y02651 07239102
         ST    R15,IMSKNUMP                                      Y02651 07239202
         LA    R15,MSGDLIST        PASS AREA TO PUT LIST         Y02651 07239302
         ST    R15,IMSKLSTP                                      Y02651 07240102
         LA    R15,IMSKNUMO        PASS AREA FOR LENGTH OF LIST  Y02651 07240502
         ST    R15,IMSKNLP                                       Y02651 07240902
         L     R15,VCONIMSK                                      Y02651 07241302
         BALR  R14,R15                                           Y02651 07241702
*        REMOVE ANY UNUSED SLOTS FROM THE END OF THE CPU LIST    Y02651 07242002
         LH    R15,IMSKNUMO        GET NUMBER OF ENTRIES PUT IN  Y02651 07242402
*                                  OUTPUT LIST                   Y02651 07242802
         SLL   R15,1                                             Y02651 07242902
         BCTR  R15,0               GET LENGTH OF OUTPUT LIST     Y02651 07243002
         LA    R14,MSGDLIST(R15)   POINT TO FIRST UNUSED SLOT IN Y02651 07243102
*                                  CPU LIST                      Y02651 07243202
         MVC   0(L'MSGDEND,R14),MSGDEND REMOVE THE BLANKS        Y02651 07243302
*        REDUCE THE WTO LENGTH TO ACCOUNT FOR THE NEW SIZE       Y02651 07243402
         LA    R14,L'MSGDLIST                                    Y02651 07243502
         SR    R14,R15             GET NUMBER OF BLANKS REMOVED  Y02651 07246402
*                                  FROM THE MESSAGE              Y02651 07248402
         LH    R15,MSGDSIZE                                      Y02651 07248802
         SR    R15,R14                                           Y02651 07249202
         STH   R15,MSGDSIZE        SET NEW WTO SIZE              Y02651 07249302
         XR    R0,R0                                             Y02651 07251302
         IC    R0,CHUCMP           GET CONSOLE ID, IN CASE THE   Y02651 07251702
*                                  JOB WAS STARTED. IF THE JOB   Y02651 07252102
*                                  WAS INITIATED, THE CONSOLE ID Y02651 07252502
*                                  WILL BE 0, INDICATING THE     Y02651 07252902
*                                  MASTER CONSOLE.               Y02651 07253002
         WTO   MF=(E,MSGD)                                       Y02651 07253102
AFFINOK  EQU   *                                                 Y02651 07255102
*        FREE THE WORKAREA GOTTEN TO ASSIGN AFFINITY             Y02651 07257902
         LA    R0,GETMAIN2                                       Y02651 07258002
         FREEMAIN R,LV=(0),A=(R8)                                Y02651 07267202
         DROP  R8                                                Y02651 07269202
         SPACE                                                          07276402
*********************************************************************** 07285602
LPPT8    EQU   *                                                 Y02651 07294802
*        BYPASS PASSWORD PROTECTION                              Y02656 07295202
*                                                                Y02656 07295602
         TM    PPTBYTE1,PPTNOPAS                                 Y02656 07296002
         BNO   LPPT9               CHECK NEXT PROPERTY           Y02656 07296402
         OI    LCTINTS2,LCTBPPAS   SET INDICATOR TO BYPASS PASSWORD     07296541
*                                  PROTECTION                  @ZA03944 07296741
         SPACE                                                          07316002
*********************************************************************** 07325402
LPPT9    EQU   *                                                 Y02656 07334802
         TM    PPTPUBYT,PPT1LPU    1ST LEVEL PREFERRED USAGE?  @ZA16879 07335441
         BNO   LPPT10              CHECK NEXT PROPERTY         @ZA16879 07335841
         OI    LCTPUBYT,LCT1LPU    YES, INDICATE 1ST LEVEL PREFERRED    07336641
*                                  USAGE                       @ZA16879 07337241
         SPACE                                                          07337841
*********************************************************************** 07338441
LPPT10   EQU   *                                               @ZA16879 07339041
         TM    PPTPUBYT,PPT2LPU    2ND LEVEL PREFERRED USAGE?  @ZA16879 07339541
         BNO   LPPT11              CHECK NEXT PROPERTY         @ZA16879 07340041
         OI    LCTPUBYT,LCT1LPU+LCT2LPU INDICATE BOTH 1ST AND  @ZA16879 07340541
*                                  2ND LEVEL PREFERRED USAGE   @ZA16879 07341041
         SPACE                                                          07344241
*********************************************************************** 07345041
LPPT11   EQU   *                                               @ZA16879 07345841
         TM    PPTPUBYT,PPTN2LP    NOT 2ND LEVEL PREFERRED     @ZA16879 07346441
         BNO   LPPT12              CHECK NEXT PROPERTY         @ZA16879 07347041
         OI    LCTPUBYT,LCTN2LP    INDICATE NOT 2ND LEVEL      @ZA16879 07347641
         SPACE                                                          07349041
*********************************************************************** 07349841
LPPT12   EQU   *                                               @ZA16879 07350641
CONTINUE EQU   *                                                  M0396 07351441
***************************************************************@ZA20168 07351541
*                                                              @ZA20168 07351641
*        IF THIS IS A CHECKPOINT/RESTART JOB, PUT PROGRAM NAME @ZA20168 07351741
*        IEFRSTRT IN CURRENT SCT SO RESTRAT SVC WILL BE INVOKED@ZA20168 07351841
*        AT ATTACH TIME TO COMPLETE RESTART PROCESSING. THIS   @ZA20168 07351941
*        CHANGE ALLOWS PROPER PPT PROCESSING FOR THE PROGRAM.  @ZA20168 07352041
*                                                              @ZA20168 07352141
***************************************************************@ZA20168 07352241
         TM    LCTOPSW2,LCTCKRST  CHKPT/RST BIT SET BY XB609?  @ZA20168 07352341
         BZ    SD101004           IF NO, CONTINUE PROCESSING   @ZA20168 07352441
         MVC   SCTPGMNM(D8),IEFRSTRT   PGM NAME TO INVOKE SVC  @ZA20168 07352541
         NI    LCTOPSW2,255-LCTCKRST   TURN OFF C/R BIT        @ZA20168 07352641
SD101004 EQU   *                                               @ZA20168 07352741
*********************************************************************** 07353602
*                                                                       07363002
*        CHECK WHETHER GWT IS TO BE GOTTEN                              07372402
*                                                                       07422402
*********************************************************************** 07472402
         XR    R8,R8               CLEAR GWT POINTER IN CASE GWT Y02669 07522402
*                                  IS NOT TO BE GOTTEN           Y02669 07532402
*        REGIONS ARE GOTTEN ONLY IF ONE OF THE FOLLOWING IS TRUE.Y02669 07542402
*        THEY ARE THEREFORE THE ONLY CASES WHEN A GETPART WORK   Y02669 07544402
*        TABLE (GWT) IS GOTTEN.                                  Y02669 07546402
*              A SPECIFIC REGION SIZE WAS REQUESTED              Y02669 07548402
*              A V=R REGION WAS REQUESTED                        Y02669 07548802
*              A CHECKPOINT RESTART IS BEING DONE (SPECIFIC      Y02669 07549202
*               ADDRESS)                                         Y02669 07549302
         LH    R3,SCTMSSZE         GET REGION SIZE (OR 0)        Y02669 07549702
         L     R7,SCTMSADR         GET SPECIFIC ADDRESS (OR 0)   Y02669 07554002
         LTR   R3,R3               CHECK FOR SPECIFIC SIZE       Y02669 07558202
         BNZ   CHKGWT              SIZE SPECIFIED                Y02669 07562402
         TM    SCTSSTAT,EAADDRBT   CHECK FOR V=R                 Y02669 07566602
         BO    CHKGWT              V=R                           Y02669 07576602
         LTR   R7,R7               CHECK FOR SPECIFIC ADDRESS    Y02669 07580602
         BZ    SD101007            NOT A SPECIFIC ADDRESS        Y02669 07582602
CHKGWT   EQU   *                                                 Y02669 07583002
         TM    JCTJSTAT,JCTABEND   HAS ABEND OCCURED WHICH MIGHT        07583302
*                                   ALLOW A FOLLOWING STEP TO           07600000
*                                   EXECUTE                             07650000
         BZ    SD101006            NO, GO TEST JOB FAIL AND JOB         07700000
*                                   FLUSH BITS                          07750000
         TM    SCTABCND,SCTEVEN+SCTONLY                                 07800000
*                                  YES, IS THIS STEP TO RUN AFTER       07850000
*                                   THE ABEND                           07900000
         BZ    SD101007            NO, SKIP GETTING GWT          Y02669 07950002
         CLI   SCTABCND+2,0        WERE EIGHT CONDITIONS PRESENT        08000000
*                                   FOR THIS STEP                       08050000
         BNE   SD101007            YES, NOT EVEN/ONLY, SKIP      Y02669 08100002
*                                  GETTING GWT                   Y02669 08150002
         B     SD101008            THIS STEP WILL BE EXECUTED- GO       08200000
*                                   GET REQUESTED REGION                08250000
SD101006 EQU   *                                                        08300000
         TM    JCTJSTAT,INCMSTS    IS JOB FAIL BIT ON            Y02652 08350002
         BZ    SD101008            NO, GO GET REQUESTED REGION          08400000
         XC    SCTMSADR+D1(D3),SCTMSADR+D1  ZERO H0 ADDRESS      A44225 08550000
         B     SD101007            DO NOT GET GWT                Y02669 08600002
SD101008 EQU   *                                                        08650000
*****************************************************************YM2727 08660001
*                                                                YM2727 08670001
*  THIS  ROUTINE BUILDS THE GETPART WORK TABLE.THIS TABLE IS TO BE LS17 08700000
*  USED AS A PARAMETER LIST FOR LIST FORM OF GETMAIN TO OBTAIN A   LS17 08750000
*  REGION                                                          LS17 08800000
*                                                                YM2727 08802001
*****************************************************************YM2727 08810001
         L     R0,GETMAIN1         GET SP AND SIZE FOR GWT       Y01054 08850000
         GETMAIN R,LV=(0)          GET CORE FOR GETPART WK TBLE    LS17 08900000
         LR    R8,R1                                               LS17 08950000
         USING GETPTWT,R8                                          LS17 09000000
         XC    GETPTWT(GPSIZE),GETPTWT  CLEAR GWT TO ZEROES      Y01054 09050000
         LA    R3,GPSIZEH0         GET PTR. TO REGION SIZE LIST  Y01054 09450000
         ST    R3,GPSIZEA                                        Y01054 09500000
         LA    R3,GPADDH0          GET PTR. TO REGION ADDR. LIST Y01054 09550000
         ST    R3,GPADDLT                                        Y01054 09600000
         MVI   GPCODE,GPECBMOD     SET CODE FOR ECB MODE         Y01054 09650000
         LH    R3,SCTMSSZE         REGION SIZE FROM SCT          Y01054 09800000
         SLL   R3,10               CONVERT TO BYTES              Y01054 09850000
         ST    R3,GPSIZEH0         STORE SIZE                    Y01054 09900000
*        IF A SPECIFIC SIZE WAS NOT REQUESTED, A REQUEST FOR 0   Y02669 09910002
*        BYTES IS A REQUEST FOR THE DEFAULT SIZE                 Y02669 09920002
         TM    SCTSSTAT,EAADDRBT   CHECK FOR REAL OR VIRT        Y02669 09970002
         BNO   SETVIRT             GO SET VIRT                   Y02669 10020002
         OI    GPSUBP,GPREAL       SET REAL                      Y02669 10070002
         B     SETADDR             SKIP 'ELSE' CLAUSE            Y02669 10120002
SETVIRT  EQU   *                                                 Y02669 10170002
         OI    GPSUBP,GPVIRT       SET VIRT                      Y02669 10220002
SETADDR  EQU   *                                                 Y02669 10270002
*        (REG 7 WAS PREVIOUSLY SET UP TO CONTAIN THE VALUE AT    Y02669 10280002
*        SCTMSADR.)                                              Y02669 10300002
         ST    R7,GPADDH0          SET SPECIFIC ADDR. (IF ANY)   Y02669 10320002
SETEND   EQU   *                                                 Y01054 10350000
         OI    GPSIZEH0,GPENDLST   INDICATE END OF LIST          Y01054 10400000
SD101007 EQU   *                                                 Y02669 10410002
         ST    R8,LCTPARM3             GETMAIN PARAM FOR IEFSD102  LS17 10450000
         LR    R1,R10                   RESTORE LCT ADDRESS             10500000
         L     R15,VCON102                                       Y02652 10550002
         BR    R15                 EXIT TO IEFSD102              Y02652 10560002
         EJECT                                                          10600002
VCONSMF  DC    V(IEFSMFIE)             *                           SMF1 11450000
IEFSDPPT DC    V(IEFSDPPT)         ADDR OF PROB PROG TABLE        20032 11500000
VCON102  DC    V(IEFSD102)         EXIT                          Y02652 11510002
VCONICPU DC    V(IEFICPUA)         CPU-TASK AFFINITY ROUTINE     Y02651 11520002
VCONIMSK DC    V(IEFIMASK)         MASK CONVERT ROUTINE          Y02651 11530002
GETMAIN1 DS    0F                                                Y01054 11550000
         DC    AL1(TCORE)          SUBPOOL                       Y01054 11600000
         DC    AL3(GPSIZE)         SIZE                          Y01054 11650000
NOAFFIN  DC    X'FFFF'             MASK FOR NO AFFINITY          Y02651 11652002
BLANKS   DC    C'        '         BLANKS                       YM06960 11656002
IEFRSTRT DC    C'IEFRSTRT'         TO INVOKE RESTART SVC       @ZA20168 11658041
PATCH    DC    8F'0'                                             Y02652 11660002
         SPACE 3                                                        11710002
TCORE    EQU   253                                                 LS17 12500000
M10      EQU   10                                                  I272 12600000
D0       EQU   0                   DISPLACEMENT                   20032 12650000
D1       EQU   1                                                   I272 12700000
D3       EQU   3                                                   I272 12800000
D4       EQU   4                                                   I272 12850000
D8       EQU   8                                                   I272 12900000
POSTED   EQU   X'40'               BIT TO INDICATE POSTED ECB     M0396 13000000
FOXFOX   EQU   X'FF'               USED TO AND OFF                20032 13100000
KEYVIRT  EQU   X'80'               V=V KEY                       Y02656 13110002
CLEAR    EQU   X'00'                                             Y02652 13110102
MASKLEN  EQU   16                  LENGTH OF BIT STRING          Y02651 13110202
CHXSTART EQU   X'04'               VERB CODE FOR START COMMAND  YM06960 13110302
CHXMOUNT EQU   X'0C'               VERB CODE FOR MOUNT COMMAND  YM06960 13120302
         SPACE 3                                                        13130302
WORKAREA DSECT                                                   Y02651 13140302
*        THIS WORKAREA MAY BE USED FOR THE FOLLOWING PURPOSES:   Y02651 13158202
*              - TO PASS PARAMETERS TO IEFICPUA                  Y02651 13168202
*              - TO PASS PARAMETERS TO IEFIMASK                  Y02651 13170202
*              - A BUFFER TO BUILD MESSAGE IEF173I               Y02651 13178202
         SPACE                                                          13198202
*        THIS SECTION OF THE WORKAREA IS USED TO PASS            Y02651 13200202
*        PARAMETERS TO IEFICPUA                                  Y02651 13202202
ICPUMEP  DS    F                   PTR. TO MASK OF ELIGIBLE      Y02651 13204202
*                                  CPU'S                         Y02651 13206202
ICPUMAP  DS    F                   PTR. TO MASK OF AVAILABLE     Y02651 13222202
*                                  CPU'S                         Y02651 13232202
ICPUMOP  DS    F                   PTR. TO OUTPUT MASK           Y02651 13234202
         SPACE                                                          13236202
*        THIS SECTION OF THE WORKAREA IS USED TO PASS            Y02651 13236602
*        PARAMETERS TO IEFIMASK                                  Y02651 13237002
         ORG   WORKAREA                                          Y02651 13237402
IMSKMSKP DS    F                   PTR. TO BIT MASK              Y02651 13237802
IMSKNUMP DS    F                   PTR. TO LENGTH OF BIT MASK    Y02651 13237902
IMSKLSTP DS    F                   PTR. TO OUTPUT LIST           Y02651 13238002
IMSKNLP  DS    F                   PTR. TO NUMBER OF ENTRIES PUT Y02651 13238102
*                                  IN OUTPUT LIST                Y02651 13243402
IMSKNUMI DS    H                   NUMBER OF BITS TO BE          Y02651 13245402
*                                  CONVERTED                     Y02651 13247402
IMSKNUMO DS    H                   NUMBER OF ENTRIES PUT IN      Y02651 13247802
*                                  OUTPUT LIST                   Y02651 13248202
         SPACE                                                          13248602
*        THIS SECTION OF THE WORKAREA IS A BUFFER TO BUILD       Y02651 13248702
*        MESSAGE IEF173I                                         Y02651 13248802
MSGD     DS    0F                                                Y02651 13262102
MSGDSIZE DS    H                   MESSAGE LENGTH                Y02651 13272102
         DS    CL10                                              Y02651 13274102
MSGDJOB  DS    CL8                 JOBNAME SLOT                  Y02651 13274502
         DS    CL14                                              Y02651 13274902
MSGDLIST DS    CL31                CPU LIST                      Y02651 13275302
MSGDEND  DS    CL13                PORTION TO BE MOVED           Y02651 13275402
MSGDLEN  EQU   *-MSGDSIZE                                        Y02651 13279802
         DS    0D                  ROUND TO DOUBLEWORD FOR       Y02651 13280202
*                                  GETMAIN/FREEMAIN              Y02651 13280602
GETMAIN2 EQU   *-WORKAREA                                        Y02651 13281802
         SPACE 3                                                        13283802
MESSAGES DSECT                                                   Y02651 13284202
*        THE TABLE AT THE BEGINNING OF IEFIB621 WHICH IS USED    Y02651 13284302
*        TO LOCATE THE MESSAGES IN IEFIB650                      Y02651 13288702
         DS    12F                 SPACE USED FOR THE FIRST 12   Y02651 13290702
*                                  MESSAGES                      Y02651 13292702
         DS    0F                  ENTRY FOR MESSAGE IEF173I     Y02651 13293102
*        MESSAGE IEF173I IS MESSAGE X'0D' WITHIN IEFIB621        Y02651 13293202
         DS    2C                                                Y02651 13304502
DISPLD   DS    H                   DISPLACEMENT OF MSG. IEF173I  Y02651 13314502
         SPACE 3                                                        13316102
         IEFZB610                                                Y01054 13327402
         EJECT                                                          13338702
IEFLOT   DSECT                                                          13350000
         IEFALLCT                                                       13352002
         SPACE 4                                                        13402002
JCT      DSECT                                                          13500000
         IEFAJCTB                                                       13550000
         SPACE 4                                                        13560002
IEFSCT   DSECT                                                          13600002
         IEFASCTB                                                       13610002
         SPACE 4                                                        13620002
IEFCSCB  DSECT                                                          13650000
         IEECHAIN                                                       13652002
         SPACE 4                                                        13654002
         IEFZB600                                                Y01054 13660002
         SPACE 4                                                        13662002
         IKJTCB                                                   20029 13750002
         SPACE 4                                                        13760002
         IHAASCB                                                        13800002
         SPACE 4                                                        13850002
         CVT   DSECT=YES                                                13860002
         SPACE 4                                                        13870002
         IHACSD                                                         13880002
         SPACE 4                                                        13890002
         IEZJSCB                                                        13892002
         END                                                            13900002
