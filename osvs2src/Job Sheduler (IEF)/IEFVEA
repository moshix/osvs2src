*********************************************************************** 00020000
*                                                                       00070002
*   MODULE NAME= IEFVEA                                                 00120002
*                                                                       00170002
*   DESCRIPTIVE NAME= EXECUTE STATEMENT PROCESSOR                       00220002
*                                                                       00270002
*   COPYRIGHT= N/A                                                      00320002
*                                                                       00370002
*   STATUS= REL 037 PTF                                        @ZA29589 00420003
*                                                                       00470002
*   FUNCTION= GENERAL DESCRIPTION                                       00520002
*             IEFVEA IS THE MAIN PROCESSOR FOR EXECUTE CARDS.           00530002
*             IT CREATES THE SCT FOR THE STEP WHILE ALSO CREATING       00540002
*             OVERRIDE TABLES FOR STEP OVERRIDES,AND REFERBACK TABLES   00550002
*             FOR STEP REFERBACKS.                                      00560002
*             IT CONVERTS KEYWORD INTERNAL TEXT TO CONTROL BLOCK        00562002
*             REPRESENTATIONS.                                          00564002
*             IT CHAINS THE JOBLIB SIOT AND JFCB,AND ANY CONCATEN-      00566002
*             ATIONS INTO THE SCT - SIOT CHAIN.                         00568002
*                                                                       00568102
*             AM/0 SUPPORT                                              00568402
*             IF THE CONVERTER FINDS A STEPCAT CARD IN THE              00568502
*             JCL INPUT IT WILL INTERROGATE THE INTERNAL TEXT           00568602
*             TO FIND THE EXEC CARD FOR THAT STEP.WHEN                  00568702
*             THE EXEC CARD TEXT IS FOUND,A BIT WILL BE                 00570602
*             TURNED ON IN THE PREFIX TO SIGNAL THAT A STEPCAT EXISTS.  00572602
*             IEFVEA WILL TEST THIS BIT (STRESTPC) TO                   00572702
*             DETERMINE WHETHER TO CHAIN THE JOBCAT SIOT AND JFCB       00572802
*             INTO THE CHAIN OFF THE PRESENT STEP SCT.                  00572902
*             THE BIT ON SIGNALS NOT TO CHAIN THE JOBCAT BLOCKS.        00573002
*                                                                       00573102
*             THE SCTCAT AND SCTCATR FIELDS IN THE SCT HAVE BEEN        00573202
*             COMBINED INTO ONE FIELD.(SCTPCAT)                         00574802
*                                                                       00575202
*             SWA SUPPORT                                               00576702
*             ALL REFERENCES TO THE 3RD BYTE OF A TTR HAS BEEN          00578602
*             REMOVED.USING THAT TEST TO DETERMINE IF A CONTROL         00580502
*             BLOCK EXISTS IS NOT VALID WITH SWA VIRTUAL ADDRESSES      00582402
*                                                                       00584302
*      OPERATION=                                                       00586202
*                 IEFVEA USES IEFVGK TO POINT TO THE NEXT PIECE         00588102
*                 OF DATA IN THE TEXT CREATED BY IEFVFA.IT THEN         00590002
*                 GAINS CONTROL FROM IEFVGK VIA THE BRANCH TABLE        00600002
*                 IF IT IS A NEW KEYWORD BEING PROCESSED,OR TO          00610002
*                 THE NEXT EXECUTABLE INSTRUCTION IF PROCESSING         00612002
*                 POSITIONAL DATA.                                      00614002
*                 EACH KEYWORD HAS A KEYWORD SUBROUTINE TO HANDLE       00616002
*                 ANY SPECIAL PROCESSING.MOST OF THE PROCESSING         00618002
*                 IS HANDLED BY GOING TO IEFVGT TO TEST AND STORE       00618402
*                 ACCORDING TO THE PDT ENTRIES FOR THE KEYWORD.         00618802
*                 WHEN THE LAST PIECE OF DATA HAS BEEN HANDLED,         00619202
*                 IEFVGK GOES TO IEFVEA'S CLEANUP ROUTINE WHERE         00619602
*                 HOUSEKEEPING IS PERFORMED.                            00619702
*                 IF AN ERROR OCCURS,IEFVEA LOADS AN ERROR CODE         00619802
*                 AND GOES TO IEFVGM TO PUT OUT A MESSAGE.IT            00619902
*                 REGAINS CONTROL AND EXITS TO IEFVHE.                  00626602
*                                                                       00640002
*   NOTES                                                               00670002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              00720002
*      DEPENDENCIES= NONE                                               00770002
*      RESTRICTIONS= NONE                                               00820002
*      REGISTER CONVENTIONS= REGISTERS AFTER INITIALIZATION:            00870002
*             R0- WORK REGISTER                                         00870402
*             R1- WORK REGISTER                                         00872002
*             R2- WORK REGISTER                                         00874002
*             R3- WORK REGISTER                                         00876002
*             R4- WORK REGISTER                                         00878002
*             R5- PTR TO SWA MANAGER REMOTE PARAM LIST                  00878402
*             R6- ADDRESS OF IEFVHQ                                     00878802
*             R7-                                                       00879202
*             R8- ADDRESS OF IEFVGT                                     00879602
*             R9- ADDRESS OF IEFVGK                                     00879702
*             RA- LOCAL WORK AREA POINTER                               00879802
*             RB- BASE REGISTER                                         00879902
*             RC- IWA POINTER                                           00883202
*             RD- SAVE AREA POINTER                                     00885202
*             RE- WORK REGISTER                                         00885602
*             RF- WORK REGISTER                                         00886002
*                                                                       00886402
*      PATCH-LABEL= PATCH                                               00886702
*                                                                       00890002
*   MODULE TYPE= PROCEDURE                                              00892002
*      PROCESSOR= ASSEMBLER                                             00894002
*      MODULE SIZE= N/A                                                 00896002
*      ATTRIBUTES= NCAL,LET,LIST,XREF,RENT,REFR,PAGED LPA               00898002
*                                                                       00898402
*   ENTRY POINT= IEFVEA                                                 00898802
*      PURPOSE= TO PROCESS EXEC CARD TEXT                               00899202
*      LINKAGE= BRANCH                                                  00899602
*      INPUT DATA= IWA                                                  00899702
*      REGISTERS SAVED= 14-12                                           00899802
*      REGISTER CONTENTS DURING PROCESSING= SEE REGISTER CONVENTIONS    00899902
*      REGISTERS RESTORED= 14-12                                        00906602
*                                                                       00908602
*   EXIT - NORMAL= IEFVHE                                               00910602
*      CONDITIONS= EXEC CARD PROCESSING COMPLETED                       00912602
*      OUTPUT DATA= CONTROL BLOCKS CREATED.                             00913002
*      RETURN CODES= NONE                                               00913102
*                                                                       00913202
*   EXIT - ERROR= IEFVHE                                                00919902
*      CONDITIONS= AFTER AN ERROR IS DETECTED.                          00921902
*                  AN EXIT IS TAKEN TO IEFVGM WITH A MESSAGE CODE       00922302
*                  AND THE MESSAGE IS PUT INTO THE MESSAGE              00922702
*                  DATA SET.CONTROL IS GIVEN BACK TO IEFVEA             00923102
*                  AND AFTER CLEANUP IT GOES TO IEFVHE.                 00923502
*      OUTPUT DATA= ERROR MESSAGE                                       00923902
*      RETURN CODES= NONE                                               00925902
*                                                                       00926302
*   EXTERNAL REFERENCES=                                                00926402
*      ROUTINES= IEFVGI,IEFVGS,IEFVGT,IEFVGK,IEFVHQ,IEFVHF,IEFVGM       00926502
*      DATA AREAS= IWA.EWA,ORWA,QMPA                                    00933202
*      CONTROL BLOCKS= JCT,SCT,SIOT,QMPA,JFCB                           00935203
*      TABLE= IEFVKEYS                                                  00937202
*      MACROS= IEFAJCTB, IEFASCTB, IEFQMNGR, IEFJFCB, IEFSIOT           00939203
*      ENQUEUE RESOURCES= NONE                                          00939602
*      CHANGE LEVEL= Y02668,ZA03866,Z40MPTH,Z40RPSM,                    00939703
*                    ZA07749,OZ07749,ZA08776,OZ09444                    00940003
*                    OZ10064,OZ12397,OZ16392,OZ15772,OZ27750            00940303
*                    OZ30305,OZ29589                           @ZA29589 00940703
*                                                                       00941103
*  MESSAGES= IEF632I - FORMAT ERROR 'COND'                            * 00941802
*            IEF637I - EXCESSIVE ACCOUNT FIELD LENGTH                 * 00943802
*            IEF613I - PROCEDURE WITHIN PROCEDURE                     * 00945802
*            IEF639I - INVALID O'RIDE KEYWORD                         * 00946402
*            IEF632I - FORMAT ERROR 'PGM'                             * 00949802
*            IEF615I - EXCESSIVE PROCSTEP NAME                        * 00951802
*            IEF642I - EXCESSIVE PARAMETER LENGTH                     * 00953802
*            IEF632I - FORMAT ERROR 'TIME'                            * 00955802
*            IEF638I - SPECIFIED NUMBER EXCEEDS MAX                   * 00956202
*            IEF645I - INVALID REFERBACK                              * 00956302
*            IEF646I - REQUIRED POSITIONAL PARAMETER MISSING          * 00956402
*            IEF670I - NO VALUE ASSIGNED TO SYMBOLIC PARAMETER        * 00956502
*                      ON PROC STATEMENT VIA EXEC STMT                * 00961902
*                                                                       00967602
*                                                                       00969603
*********************************************************************** 00973002
*                                                                     * 00978402
         EJECT                                                          00983802
         MACRO                                                          00989202
&A       KKK   &B,&C,&D,&E                                              00994602
&A       EQU   *                                                        01000000
         DC    FL1'&B'            NBR PARAMS THIS KEY.                  01020000
         DC    BL1'&C'      1 MEANS SUBPARAM OK THIS POSITION           01040000
         DC    Y(&D-EABASE)   OFFSET TO KEY PROCESSOR.                  01060000
         DC    Y(&E-EABASE)    OFFSET TO PDT.                           01080000
         SPACE                                                          01100000
         MEND                                                           01120000
         MACRO                                                          01140000
         CCC   &A,&B                                                    01160000
         DC    XL1'32'                 CONTROL INFO/COMPARE BYTES.      01180000
         DC    C'&A'                   COMPARE PATTERN.                 01200000
         DC    XL1'00'                 FUNCT/TABLE - OR/EWA.            01220000
         DC    AL1(EATEMP1+2-EAWORK)   OFFSET IN EWA.                   01240000
         DC    AL1(&B)               BIT PATTERN.                       01260000
         MEND                                                           01280000
         TITLE 'IEFVEA - NEL'                                           01290001
EANEL    DSECT                                                          01292001
         IEFNEL SUBCOM=I                                         Y02668 01294002
         TITLE 'IEFVEA - KEYS'                                          01300000
         IEFVKEYS                                                       01320000
         TITLE 'IEFVEA - JCT'                                           01340000
EAJCT    DSECT                                                          01360000
         IEFAJCTB                                                       01380000
         TITLE 'IEFVEA - IEFQMNGR'                                      01400000
         IEFQMNGR                                                       01420000
         TITLE 'IEFVEA - SIOT'                                          01440000
EASIOT   DSECT                                                          01460000
         IEFASIOT                                                       01480000
         TITLE 'IEFVEA - JFCB'                                          01500000
EAJFCB   DSECT                                                          01520000
         IEFJFCBN                                                       01540000
         TITLE 'IEFVEA - SCT'                                           01560000
EASCT    DSECT                                                          01580000
         IEFASCTB                                                       01600000
         TITLE 'IEFVEA - IWA'                                           01620000
         IEFCOMWA                                                       01640002
         IEFVMIWA                                                       01645002
         IEFTXTFT                                                Y02668 01650002
         TITLE 'IEFVEA - EWA'                                           01660000
         IEFVMEWA                                                       01680000
EAWORK   EQU   EWA                                                      01700000
SIOT     EQU   ACT                                                      01720000
JFCB     EQU   EAAUXWK                                                  01740000
         TITLE 'IEFVEA - ORWA'                                          01760000
ORTABLE  DSECT                                                          01770002
         IEFVORWA                                                       01780000
         TITLE 'IEFVEA - DSNT'                                          01780103
DDDSNT   DSECT                                                 @ZA15772 01783103
         IEFDSNT                                               @ZA15772 01786103
         EJECT                                                          01789103
         TITLE 'IEFVEA - EQUATES'                                       01800000
*                                                                     * 01820000
*********************************************************************** 01840000
*                                                                     * 01860000
*        ERROR MESSAGE NUMBERS                                        * 01880000
*                                                                     * 01900000
*********************************************************************** 01920000
*                                                                     * 01940000
EAR40    EQU   X'20'              IEF632I FORMAT ERROR 'COND'.          01960000
EAR45    EQU   X'25'              IEF637I EXCESSIVE ACCT FIELD LENGTH.  01980000
EAR50    EQU   X'0D'              IEF613I PROCEDURE WITHIN PROCEDURE.   02000000
EAR51    EQU   X'0C'              IEF612I PROCEDURE NOT FOUND IN PROC.  02020000
EAR52    EQU   X'0E'              IEF614I I/O ERROR SEARCHING FOR PRO.  02040000
EAR53    EQU   X'09'              IEF639I INVALID O'RIDE KEYWORD.       02060000
EAR54    EQU   X'20'              IEF632I FORMAT ERROR 'PGM'            02080000
EAR55    EQU   X'0F'              IEF615I EXCESSIVE PROCSTEP NAME.      02100000
EAR56    EQU   X'2A'              IEF642I EXCESSIVE PARAMETER LENGTH.   02120000
EAR57    EQU   X'20'              IEF632I FORMAT ERROR 'TIME'.          02140000
EAR58    EQU   X'26'              EIF638I SPECIFIED NUMERIC EXCEEDS MAX 02160000
EAR59    EQU   X'2D'              IEF645I INVALID REFERBACK.        394 02180000
EAR60    EQU   X'2E'              IEF646I REQUIRED POS. PARAM MISSING.  02190014
EAR61    EQU   X'46'              IEF670I NO VALUE ASSIGNED TO    21016 02195001
*                                 SYMBOLIC PARAM. ON PROC         21016 02197001
*                                 STMT VIA EXEC STMT              21016 02199001
EAR62    EQU   X'49'              IEF673I ADDRSPC=REAL INVALID   Y01029 02199401
WRNMSG04 EQU   X'02'              IEF674I - INVALID DYNAMNBR     Y02670 02199502
WRNMSG03 EQU   X'04'                                             Y02655 02199602
WRNMSG05 EQU   X'13'              IEF675I PERFORM VALUE UNDEF'D YM00368 02199802
         SPACE                                                          02200000
*                                                                     * 02220000
*********************************************************************** 02240000
*                                                                     * 02260000
*        OTHER EQUATED SYMBOLS.                                       * 02280000
*                                                                     * 02300000
*********************************************************************** 02320000
*                                                                     * 02340000
DICTLEN  EQU   0             LENGTH OF DICTIONARY ENTRY.        YM01882 02342002
DICTID   EQU   1             ENTRY IDENTIFIER.                  YM01882 02344002
DICTSIOT EQU   2             3 BYTE SVA OF SIOT FOR ENTRY..     YM01882 02346002
DICTJFCB EQU   5             3 BYTE SVA OF NEW JFCB FOR ENTRY   YM01882 02348002
DICTNAME EQU   8             NAME OF DD CARD FOR ENTRY.         YM01882 02350002
DDVERB   EQU   X'10'         DD CARD ID FOR DICTIONARY ENTRY..  YM01882 02352002
DENLEN   EQU   14            LENGTH OF JOBCAT ENTRY IN DICTIONARYM01882 02354002
EASCTID  EQU   X'02'              SCT ID.                               02360000
EASMBLST EQU   173                OFFSET TO LAST SMB PTR IN SCT.   AACA 02365017
EABIT5   EQU   4                  BIT-5  FOR SYSFLGS - CHECK POINT.AACA 02370017
EABIT6   EQU   2                  BIT-6  FOR SYSFLGS - ABEND.      AACA 02375017
EAJBLIB  EQU   128                JOBLIB BIT IN JCT.                    02380000
EADCTPRC EQU   X'80'              EXEC PROC DICT INDICATOR.             02400000
EADCTPGM EQU   X'40'              EXEC PGM DICT INDICATOR.              02420000
EADCTPPM EQU   X'20'              PGM WITHIN PROC DICT INDICATOR.       02440000
EAJCTREG EQU   92                 REGION OFFSET IN JCT.                 02480000
VOLTID   EQU   X'06'              ID OF VOLUME TABLE.                   02500000
EAJFNEW  EQU   X'C0'              DISP = NEW BIT SETTING IN JFCB.       02520000
EASINEW  EQU   X'04'              DISP = NEW BIT SETTING IN SIOT.       02540000
EAJFOLD  EQU   X'40'              DISP = OLD BIT SETTING IN JFCB. 010   02560000
EASIOLD  EQU   X'01'              DISP = OLD BIT SETTING IN SIOT.       02580000
EAJFSHR  EQU   X'08'              DISP = SHR  BIT SETTING IN JFCB. 010  02600000
EASIPAS  EQU   X'10'              DISP = PASS BIT IN SIOT.          010 02620000
EASYSOUT EQU   X'08'              SYSOUT BIT IN SCTSBYT3 OF SIOT.   394 02640000
EASDISPC EQU   X'10'    MASK TO CLEAR ALL DISP SETTINGS BUT PASS Y02113 02644002
EASBYTE3 EQU   X'F9'    MASK TO CLEAR NEW MOD DISP SETTING.      Y02113 02648002
VOLAFOFF EQU   X'DF'    MASK TO TURN VOL.AFF. OFF              @ZA02726 02651003
SCTSTEND EQU   INSMSCT+172         STEP START AND END BYTE         AACA 02654017
STEPEND  EQU   X'40'                                               AACA 02656017
ONE      EQU   1                                                   I283 02656519
EVEN     EQU   X'01'                                               I283 02657019
E3       EQU   3                                                        02657102
E6       EQU   6                                                        02657202
E7       EQU   7                                                        02657302
E16      EQU   16                                                  I283 02657519
E8       EQU   8                                                        02657702
LCSBIT   EQU   X'04'                                               I283 02658019
E182     EQU   182                                                 I283 02658519
E0       EQU   0                                                 Y01029 02658601
E1       EQU   1                                                 Y01029 02658901
E2       EQU   2                                                   I283 02659019
E4       EQU   4                                                   I283 02659519
STMINSEC EQU   X'03'              TIME KEYWORD CONTAINS STEP,    A49826 02660003
TJOBCAT  EQU   IWAJSIOT           TTR OF JOBCAT SIOT             Y01113 02660203
*                                 MINUTE AND SECOND PARAMETERS.  A49826 02660401
MINUTES  EQU   X'01'              TIME KEYWORD CONTAINS MINUTE   A49826 02660801
*                                 PARAMETER ONLY.                A49826 02661201
ZERO     EQU   X'00'              SECOND PARAMETER IN TIME       A49826 02661601
*                                 KEYWORD HAS ZERO VALUE.        A49826 02661701
JCATSWZ  EQU   DDSWX1         AM/0 SWITCH FIELD                  Y01113 02662001
JCATSW   EQU   IWAJCAT            JOBCAT SWITCH                  Y01113 02663001
ORBYT2KY EQU   PRFMEEK             1ST KEYWD IN ORID FL BYTE 2. YM00368 02663502
DISPLID  EQU   7     DISPLACEMENT OF BLOCK ID IN REMOTE LIST     Y02621 02664002
PROCORID EQU   X'0A'  ID OF PROC OVERRIDE TABLE FOR SWA WRITES   Y02621 02665002
JFCBSID  EQU   X'1C'   ID OF JFCB FOR SWA WRITES                 Y02621 02666002
DICTRYID EQU   X'25'              ID OF REFERBACK DISTIONARY   @ZA12397 02666103
ORDYNMOR EQU   16                                                Y02670 02666603
EADYNM   EQU   X'04'              DYNAMNBR FLAG                  Y02670 02666703
EAPRFM   EQU   X'02'              PERFORM FLAG                  YM00368 02666803
ORPRFMOR EQU   32                                                Y02655 02666903
SWADSNT  EQU   TWORK              DSNT SVA SAVE AREA           @ZA15772 02667903
DSNCOUNT EQU   TWORK+4            COUNT OF DSNT BLOCKS         @ZA15772 02668903
         EJECT                                                          02670903
         TITLE 'IEFVEA - EXECUTE ROUTINE'                               02673301
IEFVEA   CSECT                                                          02680000
*                                                                       02700003
*A 026510,077430,077460,247310                                 @ZA02726 02730103
*C 030000,030100,078080                                        @ZA02726 02740103
* AFTER EAREG4 CHANGE BRANCH TARGET                            @ZA03866 02745103
* DEFINE SWITCH FOR FIRST STEP EXEC ON DEFERRED STP RSTRT      @ZA07749 02746103
* NEAR- EAPGM001 - SET SW WHEN RESTART FIRST STEP FOUND        @ZA07749 02746803
* AT -EARWA21B -TEST AND CLEAR SWITCH BEFORE PROCESSING JOBLIB @ZA07749 02747503
* AFTER EAPGM85 INSERT ONE INSTRUCTION TO INIT.ACT ID          @ZA08776 02748203
* D DO NOT RESET EAFRSTEP UNTIL CLEARED BY INITIALIZATION      @ZA09444 02749603
* CODE AFTER LABELS EAPRFMP & EAPRFME MOVED AFTER EAPRFM3      @ZA10064 02749803
* A EQU FOR DICTRYID AND CODE AT LABELS EARWA6 AND EARWA60     @ZA12397 02749903
* CHANGED BRANCH TARGET TO EARWA6 NEAR EARWA21A                @ZA12397 02756103
* CHANGED R5 TO R6 AFTER LABEL EARWA6                          @ZA16392 02757103
* ADDED CODE AFTER LABEL EARWA6                                @ZA15772 02757403
* DELETE INSTREAM PROCS AND DCB DSECTS                         @ZA18864 02757703
* MERGE SU4,10,16 CODE TO REL 037 BASE PTF                     @ZA27750 02757803
* SET FIRST EXEC PGM= RECEIVED SWITCH                          @ZA30305 02757903
* UPDATE JOBLIB SVA IN VOL=REF=*.JOBLIB SIOT                   @ZA29589 02758003
*                                                                       02758103
*********************************************************************   02760103
*                       INPUT TO THIS ROUTINE                       *   02780101
*                                                                   *   02830101
*                  RC = ADDRESS OF INTERPRETER WORK AREA            *   02840101
*                  RD = CURRENT REGISTER SAVE AREA                  *   02850101
*                                                                   *   02852101
*********************************************************************   02854101
         BALR  RB,0               REGISTER 11 IS THE BASE REGISTER      02860000
         USING *,RB,R8                                                  02870019
EABASE   EQU   *                                                  O106  02880019
EASNBS0  DS    0H                                                       02890019
*****************************************************************Y02668 02891002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 02892002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 02893002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 02894002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 02895002
         DC    C'VEA '             MOD ID USED BY TRACE.         Y02668 02896002
* TRACE RETURNS HERE.                                            Y02668 02897002
*****************************************************************Y02668 02898002
         L     R8,EASNBS1              SECOND BASE                O106  02900019
         B     EAA1                    BRANCH AROUND ID           O106  02910019
EASNBS1  DC    A(EASNBS0+MAX)          VALUE OF SECOND BASE             02920019
         MODID BR=NO                                             Y01886 02960001
         DC    C'SU10'              FUNCTION ID AND            @Z40MPTH 03000003
*        DC    C'02' LEV # (PROC O'RIDE OF PERFORM KWRD ON EXEC@ZA10064 03003003
*              (WITH PERFORM KEYWORD ON JOB CARD ALSO)         @ZA10064 03006003
*        DC    C'03' LEV # (SEARCH,UPDATE,REWRITE JOBLIB DICT           03009003
*              ON DEFERRED STEP RESTART WITH JOBLIB DD)        @ZA12397 03012003
*        DC    C'04' LEV # (LOCATION 0 OVERLAY FIXED)          @ZA16392 03015003
*        DC    C'05' LEV # (SUPPORT VOL REF TO DSN ON JOBLIB)  @ZA15772 03018003
*        DC    C'06' LEV # (DELETE UNUSED DSECTS)              @ZA18864 03021003
*        DC    C'07' LEV # (MERGE SU4,10,16 TO 037 PTF)        @ZA27750 03024003
*        DC    C'08' LEV # (SET FIRST EXEC RECEIVED SWITCH     @ZA30305 03028003
         DC    C'09' LEV # (UPDATE JOBLIB SVA FOR VOL=REF)     @ZA29589 03030003
         EJECT                                                          03036003
*********************************************************************** 03040000
**                                                                   ** 03060000
**             HEADER PORTION OF EXEC ROUTINE.                       ** 03080000
**                                                                   ** 03100000
*********************************************************************** 03120000
*                                                                       03140000
*        REGISTER USAGE.                                                03160000
*                                                                       03180000
*                                                                       03200000
*              R8 = SCT ADDRESS.                                        03220000
*              R9 = TEST AND STORE ADDRESS.                             03240000
*              RA = LOCAL AND GET/T+S WORK AREA.                        03260000
*              RB = EXEC ROUTINE BASE REGISTER.                         03280000
*              RC = INTERPRETER WORK AREA.                              03300000
*              RD = CURRENT REGISTER SAVE AREA.                         03320000
*              RE = LINK RETURN REGISTER.                               03340000
*              RF = ADDRESS OF GET KEY/POS ROUTINE.                     03360000
*                                                                       03380000
         SPACE 2                                                        03400000
EAA1     DS    0H                                                       03420000
         L     RA,CTRLWAP         WORK AREA                             03460000
         USING EAWORK,RA          LWA ADDRESSING.                       03480000
         L     R9,EATESTOR        TEST & STORE ADDRESSING.              03500000
         L     RF,EAGETKEP        GET KEY/POS ADDRESSING.               03520000
*                                                                       03570001
         NI    SCT+SCTSTAT2-INSMSCT,FF-SCTSPSYS INITIALIZE SYSIN A41722 03572001
*              BIT IN SCT TO ZERO FOR EACH NEW SCT.              A41722 03574001
*                                                                       03574101
* ZERO OUT ANY STEPCAT INDICATORS LEFT IN THE SCT AND IWA FROM   Y01113 03574401
* THE PREVIOUS STEP TO INSURE THAT THEY ARE NOT PROPOGATED TO    Y01113 03574801
* SUCCEEDING STEPS                                               Y01113 03575201
         XC    SCT+SCTPCAT-INSMSCT(MVTHREE),SCT+SCTPCAT-INSMSCT  Y02113*03576002
                                   ZERO FIRST PRIVATE CATALOG    Y02113*03576402
                                   POINTER IN SCT.               Y02113 03576802
* CLEAR LAST SIOT FIELD IN CASE THERE ARE NO DD'S FOR THIS STEP. Y02668 03577202
         XC    SCT+SCTLSIOT-INSMSCT(4),SCT+SCTLSIOT-INSMSCT      Y02668*03577602
                                   CASE NO DD'S FOR THIS STEP.   Y02668 03578002
         XC    SCT+SCTCATCT-INSMSCT(E2),SCT+SCTCATCT-INSMSCT            03578402
*                                 ZERO CAT COUNT                 Y02668 03578602
         NI    DDSWX1,FF-IWASCAT            ZERO THE STEPCAT     Y01113 03578801
*              INDICATOR IN THE IWA                              Y01113 03579601
*   INITIALIZE WORK AREA.                                               03600000
*                                                                       03620000
         XC    0(EAREGSV-EWA,RA),0(RA) CLEAR EWA                   AACA 03640017
         MVC   EASNSV(8),EABLANK  BLANK STEPNAME.                       03660000
         MVC   EAPCSV(8),EABLANK  BLANK PROCNAME.                       03680000
         MVC   EAPRSV(8),EABLANK  BLANK OVERRIDDEN PROCSTEP.            03700000
         LA    R7,SIOT                                           Y02668 03720002
         ST    R7,IWASIOTP                                       Y02668 03740002
         LA    R7,JFCB                                           Y02668 03760002
         ST    R7,IWAJFCBP                                       Y02668 03780002
*                                                                       03800000
*   INITIALIZE CORE FOR GET KEY/POS AND TEST & STORE.                   03820000
*                                                                       03840000
         LA    R7,EACLEANP        CLEANUP ADDRESS.                      03860000
         ST    R7,TCLEANUP                                              03880000
         LA    R7,EABRANCH        BRANCH TABLE.                         03900000
         ST    R7,TBRANCH                                               03920000
         NI    SWD,FF-FDDRCV      CLEAR FIRST DD RECEIVED SWITCH.       03940000
         TM    SWH,CPSYSFLG       IS THIS CHCKPT/RSTRT EXEC STMT.  AACA 03950017
         BO    EAA2A              YES. CONTINUE                    AACA 03960017
         OC    JCT+JCTSDKAD-INJMJCT(MVFOUR),JCT+JCTSDKAD-INJMJCT Y02621 03970002
*              DOES AN SCT CHAIN EXIST OFF THIS JCT?             Y02621 03976002
         BNZ   EAE3    YES,CONTINUE-NO CHAIN ONE IT              Y02621 03982002
*                                                                  AACA 03990017
*   FIRST EXEC- POINT JCTSDKAD AT SCT TTR, IF NO RESTART POINT     AACA 04000017
*        JCTSSTR AT SCT TTR ALSO.                                  AACA 04010017
*                                                                  AACA 04020017
         MVC   JCT+JCTSDKAD-INJMJCT(MVTHREE),SCT+SCTANSCT-INSMSCT O106  04026019
*                                      CHAIN IN FIRST STEP        O106  04032019
         OC    JCT+JCTSSTR-INJMJCT(MVFOUR),JCT+JCTSSTR-INJMJCT   Y02621 04040002
*              IS THERE A FIRST STEP TO RESTART ALREADY IN JCT?  Y02621 04046002
         BNZ   EAE3                    YES. CONTINUE.            Y02621 04052002
EAA2A    DS    0H                                                  AACA 04060017
         MVC   JCT+JCTSSTR-INJMJCT(MVTHREE),SCT+SCTANSCT-INSMSCT  O106  04080019
*                                      NO,MOVE FIRST STEP TO STRT O106  04100019
*                                                                       04140000
*   CHECK FOR PROCLIB BEING USED.                                       04160000
*                                                                       04180000
EAE3     DS    0H                                                       04200000
         TM    SWE,PROC           PROCLIB BEING USED.                   04220000
         BO    EAG3               YES.GO TO GET FIRST KEY/POS.          04240000
*                                                                       04260000
*   PROCLIB NOT BEING USED. EXEC SWITCHES OFF, CLEAR CALLING            04280000
*        STEPNAME IN SCT.                                               04300000
*                                                                       04320000
         XC    SWF(1),SWF          CLEAR OVERRIDE FLAGS.         Y02668 04340002
         NI    SWG,FF-ORRDOR-ORSDPOR-ORDYNMOR-ORPRFMOR          YM00368 04348002
*                                 CLEAR O'RIDE FLAGS            YM00368 04352002
         MVC   SCT+SCTSCLPC-INSMSCT(MVEIGHT),EABLANK              O106  04357019
*                                      BLANK CALLING STEPNAME IN  O106  04364019
*                                      SCT                        O106  04371019
*                                                                       04380000
*   GET FIRST KEY.                                                      04400000
*                                                                       04420000
EAG3     DS    0H                                                       04440000
         BALR  RE,RF              LINK TO IEFVGK.                       04460000
         EJECT                                                          04480000
*********************************************************************** 04500000
*                                                                     * 04520000
*              EXEC KEY PROCESSING.                                   * 04540000
*                                                                     * 04560000
*********************************************************************** 04580000
EAEXEC   DS    0H                                                       04600000
*                                                                       04620000
*   STEPNAME - CHECK FOR FIRST CHAR ALPHA AND MOVE TO EASNSV IN EAWORK. 04640000
*                                                                       04660000
         L     R6,TKEYPX          GET KEY ADDRESS.             @ZA30305 04680003
         LA    R6,1(R6)           POINT AT NUMBER BYTE.        @ZA30305 04690003
         CLI   0(R6),X'02'        EXEC PROC STATEMENT          @ZA30305 04700003
         BE    EAEXEC2            YES. EXEC PROCEDURE STMT.    @ZA30305 04710003
         LA    R6,1(R2,R3)        POINT AT NEXT KEY            @ZA30305 04720003
         CLI   0(R6),PGMEK        IS NEXT KEY PGM=             @ZA30305 04730003
         BE    EAEXEC1            YES GO GET IT.                    438 04740003
         CLI   0(R6),PROCEK       IS NEXT KEY PROC=            @ZA30305 04750003
         BNE   EAPGM10            NO - FORMAT ERROR.                438 04840000
         BE    EAEXEC2                                         @ZA30305 04860003
EAEXEC1  DS    0H                                                   438 04862003
         TM    SWD,FEXRCV         IS THIS FIRST EXEC PGM=      @ZA30305 04864003
         BO    EAEXEC2            NO, BRANCH                   @ZA30305 04866003
         OI    SWD,FEXRCV         YES, SET INDICATOR           @ZA30305 04868003
EAEXEC2  DS    0H                                              @ZA30305 04870003
         BALR  RE,9               TEST AND STORE STEPNAME      @ZA30305 04872003
         STC   R2,EASNSVL         STORE STEPNAME LENGTH        @ZA30305 04874003
*                                                                     * 04880000
*   GET NEXT KEY OR PROCNAME.                                           04900000
*                                                                       04920000
         BALR  RE,RF              GET KEY/POS.                          04940000
         SPACE                                                          04960000
         L     R4,PROCBADD         POINT PDT REG TO PROC PDT BY  Y02668 04980002
         AR    R4,RB               ADDING BASE AND DISPACEMENT.  Y02668 04990002
         B     EAPROC             IF PROCNAME. GO TO PROCESS.           05000000
         EJECT                                                          05020000
*********************************************************************** 05040000
*                                                                     * 05060000
*              PROC KEY PROCESSING.                                   * 05080000
*                                                                     * 05100000
*********************************************************************** 05120000
EAPROC   DS    0H                                                       05140000
*                                                                       05140717
         NI    SCT+SCTSSTAT-INSMSCT,ZEROPRKY  TURN OFF ZERO PRO-  O106  05141119
*                                      TECT KEY                   O106  05141519
*                                                                       05142117
*                                                                       05143014
*   CHECK FOR SYMBOLIC PARAMETER DEFAULT OPTION.                        05146014
*                                                                       05149014
         L     RE,TEXTBUFP         ADDR OF TEXT STRING PFX.     YM01546 05152002
         USING TEXT,RE             PREFIX ADDRESSABILITY.       YM01563 05153002
         TM    STRINDCS,PROCSTR    PROC STATEMENT?               Y02668 05154002
         BO    EAPROC2             YES, CHECK FOR CONFLICTING KEYY02668 05155002
         DROP  RE                                               YM01563 05156002
* GET NEXT KEY. EXEC PROC HAS BEEN HANDLED IN VFA.               Y02668 05160002
EAPROC0  DS    0H                                                Y02668 05260002
         SPACE                                                          05500000
         SR    R6,R6                                                    05520000
         IC    R6,EASNSVL         PICK UP LENGTH OF STEPNAME.           05540000
         EX    R6,EAMVC1          MOVE TO WORK SPACE FOR DICT BUILD.    05560000
         MVI   EAREGSV+1,EADCTPRC SET INDICATOR FOR EXEC PROC.          05580000
         LA    R6,2(R6)           INCREMENT TO GET LENGTH OF DICT ENTRY 05600000
         STC   R6,EAREGSV         SET LENGTH.                           05620000
         LA    R1,EAREGSV         POINT TO START OF DICT ENTRY.         05640000
         L     R6,EAINPUT         LOAD DICT BUILD ROUTINE ADDRESS.      05660000
         SPACE                                                          05680000
         BALR  RE,R6              LINK TO ENTER EXEC PROC INTO DICT.    05700000
         SPACE                                                          05720000
         SPACE                                                          05740000
         MVC   SCT+SCTSCLPC-INSMSCT(MVEIGHT),EASNSV               O106  05750019
*                                      MOVE CALLING STEPNAME      O106  05760019
*                                      TO SCT                     O106  05770019
         SPACE                                                          05780000
         LA    R6,EAORTABL        ORIDE TABLE ADDRESS TO R6.            05800000
         XC    0(176,R6),0(R6)    ZERO OVERRIDE TABLE.                  05820000
         BALR  RE,RF               EXEC PROC HANDLED IN VFA. GET Y02668*05826002
                                   NEXT KEY.                     Y02668 05832002
         SPACE                                                          05840000
         SPACE                                                          06320914
*                                                                       06321814
*   SYMBOLIC PROC STATEMENT - CHECK FOR ANY EXEC KEYWORDS ON STATEMENT  06322714
*        BY TESTING FOR ENDKEY IN TEXTBUFFER.  ALSO, TURN OFF SYMBOLIC  06323614
*        PROC STMT FLAG IN IWA.                                         06324514
*                                                                       06325414
EAPROC2  DS    0H                                                       06326314
         TM    SWE,PROC           PROC SWITCH ON                   AABA 06326916
         BZ    EAPROC0             BRANCH NO TO TEST AND STORE.  Y02668 06327502
         LA    R6,1(R2,R3)         POINT AT NEXT KEYWORD.               06328114
         CLI   0(R6),ENDK          IS IT AN ENDKEY.                     06329014
         BE    EAEXITHF           YES. EXIT TO IEFVHF              AACA 06329917
*                                                                       06330814
*   SYMBOLIC KEYWORD ERROR - FAIL JOB ISSUE MESSAGE              A47546 06331701
*                                                                       06332614
         MVI   MSGKEY,X'00'        SET NO SECONDARY MESSAGE.      21016 06333501
         MVI   MSGSEC,EAR61        SET ERROR MESSAGE.                   06334414
         B     EAERRTN             ISSUE MSG AND FAIL JOB.       A47546 06338101
         SPACE 2                                                        06340000
EAMVC1   MVC   EAREGSV+1(1),EASNSVL    MOVE NAME OF STEP TO DICT BUILD. 06360000
         EJECT                                                          06380000
*********************************************************************** 06400000
*                                                                     * 06420000
*              PGM KEYWORD ROUTINE.                                   * 06440000
*                                                                     * 06460000
*********************************************************************** 06480000
EAPGM    DS    0H                                                       06500000
         LTR   R2,R2              PGMNAME PRESENT.                 438  06520000
         BZ    EAPGM10            PROGRAM NAME MISSING.            438  06540000
         IC    R6,IWASNUMB         MOVE IN STEP NO. FROM IWA     Y02668 06560002
         LA    R6,1(R6)            INCREMENT STEP NUMBER         Y02668 06580002
         STC   R6,IWASNUMB         PUT UPDATED STEP NO. IN IWA   Y02668 06600002
         STC   R6,SCT+SCTSNUMB-INSMSCT STEP NO. PUT IN SCT       Y02668 06620002
         OI    SWA,SCTTQ           INDICATE SCT TO BE PUT TO Q.  Y02668 06680002
*   MOVE NEXT SCT TTR TO SCTDISKA, SET SCT ID=2, ADD ONE TO SCTCNT IN   06800000
*        IWA &  CLEAR REST OF SCT EXCEPT SCTINPVL(PARM),SCTSTIME(TIME), 06820000
*        SCTSDPCD(COND) ABD BYTES 167 &168 (REGION SLOT).               06840000
*                                                                       06860000
         MVC   SCT+SCTDISKA-INSMSCT(MVTHREE),SCT+SCTANSCT-INSMSCT O106  06890019
*                                      MOVE NEXT TTR TO NEW SCT   O106  06920019
         MVI   SCT+SCTTBLID-INSMSCT,EASCTID  SET SCT ID TO TWO    O106  06950019
*                                                                       07000000
*   ENTER STEPNAME AND SCT TTR INTO DICTIONARY.                         07020000
*                                                                       07040000
         SR    R6,R6                                                    07060000
         IC    R6,EASNSVL         GET LENGTH OF STEPNAME.               07080000
         EX    R6,EAMVC2          MOVE TO WORK SPACE FOR DICT BUILD.    07100000
         MVI   EAREGSV+1,EADCTPGM SET INDICATOR FOR EXEC PGM.           07120000
         TM    SWE,PROC           IS THIS A PROCEDURE.                  07140000
         BZ    EAPGM0             NO. GO TO MOVE SCT TTR TO DICT.       07160000
         MVI   EAREGSV+1,EADCTPPM YES. OVERLAY PGM IND WITH PROC PGM.   07180000
EAPGM0   DS    0H                                                       07200000
         MVC   EAREGSV+DISPLTWO(MVTHREE),SCT+SCTDISKA-INSMSCT     O106  07210019
*                                      MOVE SCT TTR TO DICT BUILD O106  07220019
         LA    R6,5(R6)           INCREMENT FOR PROPER LENGTH OF DICT   07240000
         STC   R6,EAREGSV              ENTRY.                           07260000
         LA    R1,EAREGSV         POINT TO START OF DICTIONARY ENTRY.   07280000
         L     R6,EAINPUT         GET DICT BUILD ROUTINE ADDRESS.       07300000
         SPACE                                                          07320000
         BALR  RE,R6              LINK TO ENTER PGM INTO DICTIONARY.    07340000
         SPACE                                                          07360000
*                                                                       07380000
*   CLEAR SCT.                                                          07400000
*                                                                       07420000
         XC    SCT+SCTLALOC-INSMSCT(CLTHIRTN),SCT+SCTLALOC-INSMSCT O106 07450019
         SR    R6,R6                                                    07480000
         ST    R6,SCT+SCTAFACT-INSMSCT  CLEAR ACT TTR             O106  07490019
*  CLEAR FIELDS FOR NEXT STEP.                                  YM00366 07510002
         XC    SCT+SCTNSMSG-INSMSCT(1),SCT+SCTNSMSG-INSMSCT     YM00366 07516002
         XC    SCT+SCTSTYPE-INSMSCT(1),SCT+SCTSTYPE-INSMSCT     YM00366 07522002
         STH   R6,SCT+SCTRPACT-INSMSCT CLEAR RELATIVE PTR TOACT   O106  07530019
*                                      STEP ENTRY                 O106  07540019
         MVC   SCT+SCTSNAME-INSMSCT(MVEIGHT),EABLANK BLANK STEPNAMEO106 07550019
         TM    SWE,PROC           READING FROM PROCLIB.             248 07580000
         BO    EAPGM00            YES.                              248 07600000
         MVC   SCT+SCTSCLPC-INSMSCT(MVEIGHT),EABLANK  NO BLANK    O106  07608019
*                                      CALLING STEP NAME          O106  07616019
         MVI   SCT+SCTSSTAT-INSMSCT,INITBLK  CLEAR INTERNAL STEP  O106  07624019
*                                      STATUS                     O106  07632019
EAPGM00  DS    0H                                                   248 07640000
         MVC   SCT+SCTPGMNM-INSMSCT(MVEIGHT),EABLANK BLANK PGMNM  O106  07660019
         OI    EASW1,EAERLYER     INDICATE FAKE SCT NOT NEEDED.         07680000
*                                                                  AACA 07680517
*   CHECK FOR STEPFLUSH - IF STEPNAME OF THIS STEP MATCHES         AACA 07681017
*        STEPNAME FROM RESTART PARAMETER ON THE JOB STATEMENT,     AACA 07681517
*        INDICATE STEP FOUND BY TURNING OFF CPSTPFL IN SWH OF IWA. AACA 07682017
*        IF CHECKID WAS SPECIFIED LINK TO EARSTSUB TO REARRANGE    AACA 07682517
*        SCT/SMB CHAIN.  IF NOT, MOVE THIS SCT TTR TO JCTSSTR.     AACA 07683017
         TM    SWH,CPSTPFL         FLUSHING TO A SPECIFIC STEP? YM00371 07683502
         BZ    EAPGM005            NO, CONTINUE.                YM00371 07683602
         CLI   IWAJOBS3,C'*'       RESTART THIS STEP? (REST=*). YM00371 07683702
         BNE   EAPGM001            BR NO TO CHECK STEPNAMES.    YM00371 07683802
*  RESTART AT FIRST STEP - RESTART=*.                           YM00371 07683902
         NI    SWH,255-CPSTPFL     CLEAR C/R FLUSH FLAG.        YM00371 07684002
         B     EAPGM005            TREAT AS IF NO RESTART FOR   YM00371*07684102
                                   CHAINING PURPOSES.           YM00371 07684202
EAPGM001 DS    0H                                               YM00371 07684302
         CLC   IWAJOBS1(MVEIGHT),SCT+SCTSCLPC-INSMSCT  IS THE     O106  07684819
*                                      CALLING STEPNAME           O106  07685119
*              THE SAME AS THE ONE SPECIFIED IN THE JOB RESTART    AACA 07685517
*              PARAMETER.  (IN THE CASE OF A NON-PROCEDURE STEP    AACA 07686017
*              BOTH FIELDS ARE BLANK.)                             AACA 07686517
         BNE   EAPGM004            NO CONTINUE                     AACA 07687017
         CLC   IWAJOBS3(8),EASNSV YES. ARE THE STEPNAMES THE SAME. AACA 07687517
         BNE   EAPGM004            NO CONTINUE                     AACA 07688017
*                                                                  AACA 07688517
*   RESTART STEP FOUND                                             AACA 07689017
*                                                                  AACA 07689517
         NI    SWH,FF-CPSTPFL     INDICATE RESTART STEP FOUND      AACA 07690017
         MVC   JCTSNUMB+JCT-INJMJCT,IWASNUMB MOVE RESTART STEP  YA01834 07690202
         OI    EASW2,EACLCOND      THIS SWITCH INDICATES        YM00371 07690502
* TO THE SUBRTN WHICH CONNECTS JOBLIB SIOTS TO THIS SCT THAT       AACA 07691017
* THIS WILL BE THE 1ST STEP RUN IN THE RESTARTED JOB AND THAT      AACA 07691517
* THE STEP CONDITION CODES ARE TO BE ZEROED IN THE CLEAN-UP RTN.   AACA 07692017
         OI    EASW2,EAFRSTEP     INDICATE FIRST STEP FOR A    @ZA07749 07692103
*                                 DEFERRED STEP RESTART        @ZA07749 07692203
         CLI   JCT+JCTCKIDL-INJMJCT,X'00'   IS CHECKID PRESENT.    AACA 07692517
         BE    EAPGM003           NO GO TO MOVE SCT TTR TO JCTSSTR AACA 07693017
         IC    R6,JCTSNUMB+JCT-INJMJCT  YES...DECREMENT THE     YA01834 07693102
         BCTR  R6,0                     JCT RESTART STEP        YA01834 07693202
         STC   R6,JCTSNUMB+JCT-INJMJCT  NUMBER BY ONE           YA01834 07693302
*                                                                  AACA 07693517
         BAL   RE,EARSTSUB        FOUND THE RESTART STEP - LINK TO AACA 07694017
*                                      CHAIN SCT + SMB TTRS.       AACA 07694517
         B     EAPGM005           CONTINUE                         AACA 07695017
EAPGM003 DS    0H                                                  AACA 07695517
         MVC   JCT+JCTSSTR-INJMJCT(MVTHREE),SCT+SCTDISKA-INSMSCT  O106  07695819
*                                      SCT TTR TO JCTSSTR         O106  07696119
*              TO INDICATE TO INITIATOR THAT THIS IS THE FIRSTSTEP AACA 07696517
*              OF THE JOB TO BE RUN WHEN IT IS RESTARTED.          AACA 07697017
         B     EAPGM005            CONTINUE                        AACA 07697117
EAPGM004 DS 0H                                                          07697217
         OI    SCT+SCTSTEND-INSMSCT,STEPEND  SET STEP ENDED BIT   O106  07700219
*                                      IN SCT.  BIT MUST BE SET   O106  07703219
*                                      FOR WARM START             O106  07706219
         SPACE                                                          07709219
EAPGM005 DS    0H                                                       07712219
*                                                                       07715219
         XC    EATEMP3(E4),EATEMP3   ZERO 1ST JOBCAT PTR FILED   Y02113 07720002
         SR    R0,R0              SETUP R0 FOR JOBCAT COUNT      Y02113 07730002
         SR    R6,R6              CLEAR REG FOR JOBLIB COUNT     Y02113 07740002
         CLI   SCT+SCTSNUMB-INSMSCT,FRSTSTEP   1ST STEP?       @ZA02726 07743003
         BE    SKIP      YES-BRANCH AROUND CLEAR DSNT INSTRS.  @ZA02726 07746003
*      I N I T I A L I Z E  C O M M O N  S C T  F I E L D S      Y02113 07750002
         XC    SCT+SCTLDSTB-INSMSCT(E4),SCT+SCTLDSTB-INSMSCT     Y02668 07760002
*                                      CLEAR LEN OF DSNAME TABLE Y02113 07770002
         XC    SCT+SCTADSTB-INSMSCT(CLFOUR),SCT+SCTADSTB-INSMSCT Y02668 07780002
*              CLEAR DSN POINTER IN SCT.                         Y02668 07790002
*  INITIALIZATION OF SCT FIELDS IS COMPLETE.                    YM04927 07800002
*  CHECK IF SCT IS FOR CHECKPT/RESTART EXEC - PGM=IEFDSDRP.     YM04927 07804002
SKIP     TM    SWH,CPSYSFLG        THIS A CHECKPT/RESTART EXEC @ZA02726 07808003
         BO    EAPGM011            BR YES, BYPASS CHAINING.     YM04927 07812002
*  STANDARD EXEC. CHAIN JOBLIB/JOBCAT SIOTS, IF ANY.            YM04927 07816002
*                                                                       07820002
         TM    JCT+JCTJSTAT-INJMJCT,EAJBLIB  DOES A JOBLIB              07830003
*                                            EXIST               Y02113 07835003
         BZ    EAPGM010     NO,NO JOBLIB SIOTS TO CHAIN TO STEP. Y02113 07840002
*                           YES,SET UP TO CHAIN JOBLIB SIOTS.    Y02113 07850002
         MVC   EATTRSV(MVFOUR),TJOBLIB  MOVE JOBLIB POINTER TO   Y02113 07860002
*              START READING FROM FIRST JOBLIB SIOT THRU COUNT.  Y02113 07870002
         IC    R6,JBCONCAT    GET THE NUMBER OF JOBLIB SIOTS.    Y02113 07880002
         L     R5,TEXTBUFP   LOAD ADDRESS OF TEXT BUFFER TO SET  Y02113 07890002
         USING TEXT,R5                                                  07900002
         TM    STREINDC,ETXSTPCT   DOES STEP HAVE A STEPCAT DD?  Y02668 07910002
         BO    EAPGM007    YES,DO NOT INCLUDE JOBCAT SIOT COUNT. Y02113 07920002
EAPGM006 DS    0H                                                Y02668 07930002
         IC    R0,IWACATCT  GET THE NUMBER OF JOBCAT SIOTS.      Y02113 07940002
EAPGM007 DS    0H                                                Y02668 07950002
         DROP  R5                                                Y02668 07960002
*        CALCULATE THE NUMBER OF SIOTS TO BE READ AND CHAINED    Y02113 07970002
*   JOBLIB. SET SCTLALOG, AND DDINTNO = NBR JOBLIB SIOTS.        Y02668 07980002
*        SCT AND IWA.                                            Y02113 07990002
*                                                                Y02113 08000002
         AR    R6,R0  ADD THE JOBLIB AND JOBCAT COUNTS TO GET    Y02113 08010002
*              TOTAL NUMBER OF SIOTS THAT WILL BE READ IN.       Y02113 08020002
         STH   R0,SCT+SCTCATCT-INSMSCT SET CATALOG SIOT COUNT    Y02668 08030002
         STH   R6,SCT+SCTLALOC-INSMSCT  SET NUMBER OF SIOTS FOR  Y02113 08040002
*              CALCULATION OF ALLOCATE WORK AREA.                Y02113 08050002
         STH   R6,DDINTNO         DD INTERNAL NBR.               Y02668 08060002
         MVC   SCT+SCTFSIOT-INSMSCT(MVFOUR),TSIOT  SET UP FOR    Y02113 08070002
*              STARTING SIOT CHAIN FROM FIRST SIOT CREATED NO    Y02113 08080002
*              MATTER WHICH ONE IT WILL BE.                      Y02113 08090002
EAPGM008 DS    0H                                                Y02668 08100002
*        READ CHAIN AND WRITE CODE.THE SUBROUTINE USED WILL READ Y02113 08110002
*        CHAIN AND WRITE OUT AGAIN JOBLIB AND JOBCAT SIOTS.THE   Y02113 08120002
*        ORIGINAL JOBCAT AND /OR JOBLIB SIOTS ARE USED AS MODELS.Y02113 08130002
         SPACE                                                          08140002
         SR    R5,R5     ZERO IN REGISTER 5 INDICATES READ.      Y02113 08150002
         SPACE                                                          08160002
         BAL   RE,EARWA  READ IN THE SIOT AND JFCB AND CHAIN.    Y02113 08170002
*        JOBLIB AND JOBCAT DSNAMES MUST BE CHECKED FOR DSENQ     Y02668 08172002
*        ENTRIES TO BE BUILT,IF THEY DON'T EXIST                 Y02668 08174002
         L     R5,EAVDBSD         ADDR OF DSENQ TABLE ROUTINE.   Y02668 08176002
         BALR  RE,R5              CHECK DSNAME IN DSENQ TABLE    Y02668 08178002
         SPACE                                                          08180002
*        LAST JOBLIB OR JOBCAT SIOT IN STEP,IF NO OTHER DD CARDS Y02668 08180702
*        EXIST FOR STEP,MUST HAVE A ZERO NEXT SIOT POINTER.      Y02668 08181402
         LA    R5,E1     LOAD A ONE INTO REGISTER 5.             Y02668 08182102
         CR    R6,R5     HAVE WE READ IN THE LAST SIOT TO BE     Y02668 08182802
*              CHAINED TO THIS STEP?                             Y02668 08183502
         BNE   EAWRITES  NO,CONTINUE NORMAL PROCESSING.          Y02668 08184202
         LA    R5,WAEXCPFX  LOAD ADDRESS OF EXEC CARD PREFIX     Y02668 08184902
         USING TEXT,R5                                                  08185602
         TM    STREINDC,ETXNODD  IS THE NO DD INDICATOR ON FOR   Y02668 08186302
*                                THIS STEP?(NO DD CARDS).        Y02668 08187002
         DROP  R5                                                Y02668 08187702
         BZ    EAWRITES  NO,THEN DD CARDS FOLLOW FOR STEP        Y02668 08188402
         CLI   E1(R3),C'*'         IS THIS PGM=*. ?             YM00365 08188602
         BE    EAWRITES         YES.  DO NOT ZERO NEXT SOIT PTR YM00365 08188802
         LA    R5,SIOT     LOAD ADDRESS OF CURRENT SIOT.         Y02668 08189102
         USING INDMSIOT,R5                                       Y02668 08190002
         XC    SCTPSIOT(MVFOUR),SCTPSIOT                         Y02668 08192002
*              ZERO THE NEXT SIOT POINTER TO SIGNAL LAST SIOT    Y02668 08194002
*              FOR THE STEP.                                     Y02668 08196002
         DROP  R5                                                Y02668 08200002
         SPACE                                                          08202002
EAWRITES DS    0H    WRITE NEXT SIOT/JFCB OUT                    Y02668 08204002
         LA    R5,E4     4 IN REGISTER 5 INDICATES WRITE,ASSIGN. Y02113 08206002
         SPACE                                                          08208002
         BAL   RE,EARWA  WRITE AND ASSIGN SIOT AND ITS JFCB.     Y02113 08210002
         SPACE                                                          08220002
         BCT   R6,EAPGM008  CONTINUE READING AND CHAINING UNTIL  Y02113 08230002
*              CALCULATED NUMBER OF SIOTS HAS BEEN PROCESSED.    Y02113 08240002
*                                                                       08250002
         OC    EATEMP3(MVFOUR),EATEMP3 WAS A JOBCAT SIOT FOUND   Y02113 08260002
*              DURING THE READ,CHAIN,WRITE PROCESS?              Y02113 08270002
         BZ    EAPGM009  NO,DO NOT SET UP JOBCAT POINTERS.       Y02113 08280002
         MVC   SCT+SCTPCAT-INSMSCT(MVFOUR),EATEMP3  MOVE IN      Y02113 08290002
*              FIRST SIOT POINTER FOR STEPCAT                    Y02113 08300002
         OI    SCT+SCTSTYPE-INSMSCT,SCTJSCAT  TURN ON JOBCAT BIT Y02113 08310002
*                                                                       08320002
EAPGM009 DS    0H                                                Y02668 08330002
         TM    SWD,FEXRCV  IS THIS THE FIRST STEP FOR THE JOB.   Y02113 08340002
         BZ    EAPGM22     YES,PROCESS FIRST STEP LOGIC.         Y02113 08350002
         B     EAPGM5      NO,FIRST STEP ALREADY ENCOUNTERED.    Y02113 08360002
*                                                                       08370002
EAPGM010 DS    0H                                                Y02668 08380002
         TM    JCATSWZ,JCATSW    DOES A JOBCAT EXIST?            Y02113 08390002
         BZ    EAPGM011    NO,NO CHAINING OF JOBCAT OR JOBLIB.   Y02113 08400002
         L     R5,TEXTBUFP        LOAD POINTER TO EXEC CARD TEXT Y02113 08410002
         USING TEXT,R5                                           Y02668 08420002
         TM    STREINDC,ETXSTPCT   DOES STEP HAVE A STEPCAT DD?  Y02668 08430002
         DROP  R5                                                Y02668 08440002
         BO    EAPGM011            YES,IGNORE JOBCAT CHAINING.   Y02113 08450002
*        JOBCAT EXISTS,START CHAINING FROM FIRST JOBCAT SIOT.    Y02113 08460002
         MVC   EATTRSV(MVFOUR),TJOBCAT SET UP TO CHAIN FROM FIRSTY02113 08470002
         B     EAPGM006   GET JOBCAT COUNT AND READ,CHAIN,WRITE. Y02113 08480002
*                                                                       08490002
EAPGM011 DS    0H                                                Y02668 08500002
*        NO JOBCAT OR JOBLIB SIOTS ARE TO BE CHAINED FROM THE    Y02113 08510002
*        SCT.INITIALIZATION HAS BEEN DONE.                       Y02113 08520002
*                                                                Y02113 08530002
         XC    DDINTNO(2),DDINTNO   NO. CLEAR NBR SIOTS IN IWA.  Y02668 08540002
         LA    R5,WAEXCPFX         GET SAVED EXEC PFX BASE       Y02668 08541002
         USING TEXT,R5             SET ADDRESSABILITY            Y02668 08542002
         TM    STREINDC,ETXNODD    ANY DD'S IN THIS STEP?        Y02668 08543002
         DROP  R5                                                Y02668 08544002
         BO    EAPGM009            YES  DON'T SET SIOT PTR       Y02668 08545002
         MVC   SCT+SCTFSIOT-INSMSCT(MVFOUR),TSIOT  PUT NEXT SIOT Y02113 08550002
*              AS FIRST SIOT TO START CHAINING STEP'S DD CARDS.  Y02113 08560002
         B     EAPGM009 TEST FOR FIRST STEP AND CONTINUE.        Y02113 08570002
         SPACE                                                          08580002
EAPGM22  DS   0H                                                 Y02113 08590002
         TM    SWH,CPSTPFL        FLUSHING TO A SPECIFIC STEP      AACA 09128001
         BZ    EAPGM4             NO. CONTINUE                     AACA 09132001
*                                                                  AACA 09136001
         L     RF,EAGETKEP        RESTORE GET KEY/POS ADDRESS.     AACA 09210001
EAPGM4   DS    0H                                                       09215001
         OI    SWD,FEXRCV         SET FIRST EXEC RECVD THIS JOB SWITCH. 09220000
*                                                                       09240000
*   CHECK FOR OVERRIDES.                                                09260000
EAPGM5   DS    0H                                                       09280000
*                                                                       09300000
*   PARM O'RIDE CHECK.                                                  09320000
*                                                                       09340000
         TM    SWF,ORPARMOR       CHECK PARM O'RIDE.                    09360000
         BO    EAPGM5A            YES. GO TO SWITCHES SET.              09380000
         SPACE                                                          09400000
         XC    SCT+SCTXBTTR-INSMSCT(CLTHREE),SCT+SCTXBTTR-INSMSCT O106  09410019
*                                      NO, ZERO PARM TTR          O106  09420019
         XC    SCT+SCTSEXEC-INSMSCT(CLTWO),SCT+SCTSEXEC-INSMSCT   O106  09430019
*                                      CLEAR LENGTH OF PARM FIELD O106  09440019
         B     EAPGM6             GO TO CHECK COND O'RIDE.              09460000
EAPGM5A  DS    0H                                                       09480000
         OI    SWF,ORPARMBL       PARM BLOCK ON.                        09500000
         NI    SWF,FF-ORPARMOR    PARM O'RIDE OFF.                      09520000
*                                                                       09540000
*   COND O'RIDE CHECK.                                                  09560000
*                                                                       09580000
EAPGM6   DS    0H                                                       09600000
         TM    SWF,ORCONDOR       COND O'RIDE ON.                       09620000
         BO    EAPGM7             YES. GO TO TIME O'RIDE CHECK.         09640000
         XC    SCT+SCTSDPCD-INSMSCT(CL48),SCT+SCTSDPCD-INSMSCT    O106  09650019
*                                      NO, ZERO COND FIELDS IN SC<O106  09660019
*                                                                       09680000
*   TIME O'RIDE CHECK.                                                  09700000
*                                                                       09720000
EAPGM7   DS    0H                                                       09740000
         TM    SWF,ORTIMEOR       TIME O'RIDE ON.                       09760000
         BO    EAPGM7A            YES. GO TO SET TIME SWITCHES.         09780000
         TM    SWF,ORTIME0        NO. IS TIME ZERO ON.                  09800000
         BO    EAPGM7B            YES. GO TO ZERO STEP TIME IN SCT.     09820000
         B     EAPGM8             GO TO CHECK ACCT O'RIDE.              09860000
EAPGM7A  DS    0H                                                       09880000
         OI    SWF,ORTIME0        TIME ZERO ON.                         09900000
         TM    SWH,CPSTPFL             STEP FLUSH SW ON          A30886 09906020
         BO    EAPGM8                  YES,TIME FROM PRIOR SCT   A30886 09912020
         NI    SWF,FF-ORTIMEOR    TIME O'RIDE OFF.                      09920000
         B     EAPGM8             GO TO CHECK ACCT O'RIDE.              09940000
EAPGM7B  DS    0H                                                       09960000
         XC    SCT+SCTSTIME-INSMSCT(CLTHREE),SCT+SCTSTIME-INSMSCT O106  09970019
*                                      ZERO STEP EXECUTION TIME   O106  09980019
*                                      IN SCT                     O106  09990019
*                                                                       10000000
*   ACCT O'RIDE CHECK.                                                  10020000
*                                                                       10040000
EAPGM8   DS    0H                                                       10060000
         TM    SWF,ORACTOR        ACCT O'RIDE ON.                       10080000
         BZ    EAPGM8A            NO. GO TO CHECK REGION O'RIDE.        10100000
         TM    EASW2,EAEACCTE          IS ACCT=  SWITCH SET ON   A22206 10101018
         BZ    EAPGM85                 NO, BR TO CREATE A ACT    A22206 10102018
         NI    EASW2,FF-EAEACCTE       TURN OFF ACCT=  SWITCH    A22206 10103018
         MVC   SCT+SCTAFACT-INSMSCT(E4),TACT                 A22206O106 10103619
***  MOVE TTR OF OVERRIDE ACT TO SCT FOR FIRST PROCSTEP ONLY.    A38608 10104201
         B     EAPGM8A                 BR TO REGION O'RIDE CHECK A22206 10105018
EAPGM85  DS    0H                                                A22206 10106018
***   FOR REMAINING PROCSTEPS,READ OVERRIDE ACT,OBTAIN NEXT      A38608 10106401
***   AVAILABLE TTR FOR NEW ACT,CHAIN NEW ACT TO PROCSTEP'S      A38608 10106801
***   SCT,AND WRITE COPY OF OVERRIDE ACT AS PROCSTEP'S ACT.      A38608 10106901
         LA    R7,QPARM                QMGR PARAMETER AREA       A22206 10107018
         USING IOPARAMS,R7                                       A22206 10108018
         L     R6,QMPCL                QMPCA ADDRESS             A22206 10109018
         LA    R5,EAAUXWK              AUX. WORKAREA ADDRESS     A22206 10110018
         ST    R5,0(R6)                TO QMPCA                  A22206 10111018
         MVC   4(4,R6),TACT            MOVE ACT TTR TO QMPEX     A22206 10112018
         MVI   QMPOP,QMREAD            INDICATE READ FUNCTION    A22206 10113018
         L     R5,EAVHQ                IEFVHQ ADDRESS            A22206 10114018
         BALR  RE,R5                   LINK TO QMGR TO READ      A22206 10115018
         MVC   E4(E4,R6),TNEXT       MOVE NEXT AVAILABLE TTR TO  A38608 10115401
*                                    QMPEX FOR WRITE.            A38608 10115801
         MVC   SCT+SCTAFACT-INSMSCT(E4),TNEXT CHAIN TO SCT       A38608 10115901
         LA    R5,EAAUXWK              AUX. WORKAREA ADDRESS     A22206 10118018
         USING ACTDSKAD,R5                                       A22206 10119018
         MVC   ACTDSKAD(E4),TNEXT      UPDATE SELF TTR NEW ACT   A38608 10119401
         MVI   ACTIDENT,ACTID        SET SWA BLOCK ID FOR ACT  @ZA08776 10120203
         L     R5,EAVHQ                IEFVHQ ADDRESS            A22206 10121018
         BALR  RE,R5                   LINK TO QMGR TO WRITE/ASN A22206 10122018
         MVC   TNEXT(4),0(R6)          UPDATE TNEXT TTR          A22206 10123018
*   FALL THRU TO EAPGM8A                                                10140000
*                                                                       10160000
*   REGION O'RIDE CHECK.                                                10180000
*                                                                       10200000
EAPGM8A  DS    0H                                                       10220000
         TM    SWF,ORREGOR        REGION O'RIDE ON.                     10240000
         BO    EAPGM8B            YES. GO TO SET EXEC REGION FLAG.  354 10260000
         XC    SCT+SCTMSSZE-INSMSCT(E2),SCT+SCTMSSZE-INSMSCT     Y02668 10270002
*                                      NO, ZERO REGION SIOT       O106  10280019
         B     EAPGM8H            GO TO CONTINUE CHECK           Y02670 10300002
EAPGM8B  DS    0H                                                   354 10320000
         OI    EASW2,EAREGION     TURN ON REGION SPECIFIED FLAG.        10328014
*                                                                Y02670 10328602
*   DYNAMNBR O'RIDE CHECK                                        Y02670 10329202
*                                                                Y02670 10329802
EAPGM8H  DS    0H                                                Y02670 10330402
         TM    SWG,ORDYNMOR       DYNAMNBR O'RIDE ON?            Y02670 10331002
         BO    EAPGM8I            YES, CONTINUE                  Y02670 10331602
         XC    SCT+SCTNIUSL-INSMSCT(E2),SCT+SCTNIUSL-INSMSCT     Y02670 10332202
*                                 CLEAR DYNAMNBR FIELD           Y02670 10332802
         B     EAPGM8M                                          YM00368 10333402
EAPGM8I  DS    0H                                                Y02670 10334002
         OI    EASW2,EADYNM       TURN ON DYNAMNBR FLAG          Y02670 10334602
*                                                               YM00368 10334702
*    PERFORM O'RIDE CHECK                                       YM00368 10334802
*                                                               YM00368 10334902
EAPGM8M  DS    0H                                               YM00368 10335002
         TM    SWG,ORPRFMOR       PERFORM O'RIDE ON?            YM00368 10335102
         BO    EAPGM8L            YES GO SET PERFORM EXEC FLAG  YM00368 10335202
         XC    SCT+SCTPRFMF-INSMSCT(E1),SCT+SCTPRFMF-INSMSCT    YM00368 10335302
         B    EAPGM8C             CONTINUE                      YM00368 10335402
EAPGM8L  DS    0H                                               YM00368 10335502
         OI    EASW2,EAPRFM       SET EXEC PERFORM FLAG         YM00368 10335602
*                                                                       10336014
*   ADDRSPC O'RIDE CHECK.                                        Y01029 10344001
*                                                                       10352014
EAPGM8C  DS    0H                                                Y01029 10360001
         TM    SWF,ORADDROR          ADDRSPC OVERRIDE ON?        Y01029 10364001
         BO    EAPGM8D               YES, SET EXEC ADDRSPC FLAG  Y01029 10368001
         NI    SCT+SCTSSTAT-INSMSCT,FF-EAADDRBT                  Y01029 10370001
*                                 NO, CLEAR ADDRSPC FLAG         Y01029 10372001
         B     EAPGM8E            CONTINUE.                      Y01029 10374001
EAPGM8D  DS    0H                                                Y01029 10376001
         OI    EASW2,EAADDR       SET EXEC ADDRSPC FLAG.         Y01029 10377001
*                                                                  AACA 10377217
*   RD O'RIDE CHECK                                                AACA 10377417
*                                                                  AACA 10377617
EAPGM8E  DS    0H                                                       10378014
         TM    SWG,ORRDOR         RD O'RIDE ON.                    AACA 10378417
         BO    EAPGM8F            YES. CONTINUE                    AACA 10378817
         NI    SCT+SCTSSTAT-INSMSCT,CLFLAGS  NO CLEAR FLAGS       O106  10379519
*                                                                  I241 10380218
*   SDP O'RIDE CHECK                                               I241 10381218
*                                                                  I241 10382218
EAPGM8F  DS    0H                                                  I241 10383218
         TM    SWG,ORSDPOR         SDP O'RIDE ON                   I241 10384218
         BO    EAPGM8G             YES, CONTINUE                   I241 10385218
         OI    SCT+SCTSDP-INSMSCT,INIT1   INITIALIZE FIELD        O106  10386219
         NI    SCT+SCTSDP-INSMSCT,INIT2   INITIALIZE FIELD        O106  10387219
         NI    SCT+SCTSDP-INSMSCT+DISPLONE,INIT3 INIT FIELD       O106  10388219
         OI    SCT+SCTSDP-INSMSCT+DISPLONE,INIT4 INIT FIELD       O106  10389219
EAPGM8G  DS    0H                                                  I241 10390218
*                                                                  I241 10391218
*   MOVE STEPNAME (OR BLANKS) TO SCT.                                   10400000
*                                                                       10420000
         MVC   SCT+SCTSNAME-INSMSCT(MVEIGHT),EASNSV STEPNAME TO SCTO106 10440019
*                                                                       10460000
*   LINK TO TEST & STORE. CHECK FOR *. - SET EAPGMSDF FLAG IN LWA.      10480000
*        IF NOT *.- CHECK PGMNM FOR 8 CHAR & ALPHA & MVC TO SCT.        10500000
*        AND SET EAPGMEF IN LWA.                                        10520000
*                                                                       10540000
         BALR  RE,R9              LINK TO TEST & STORE                  10560000
         SPACE                                                          10580000
         TM    EASW1,EAPGMSDF     TEST FOR *.                           10600000
         BZ    EAPGM9             NO. GO TO GET NEXT KEY.               10620000
*                                                                       10640000
*   PGM=*.  LINK TO SEARCH DICTIONARY ROUTINE.  R1 = PTR TO DICT. ENTRY 10660000
*                                                                       10680000
         BALR RE,RF               GET STEPNAME.                         10700000
         SPACE                                                          10720000
         L     R6,EASEARCH                                              10740000
         BALR RE,R6               LINK TO SEARCH DICTIONARY.            10760000
         SPACE                                                          10780000
         MVC   EATTRSV(3),2(R1)   MOVE SIOT TTR TO TEMP SAVE AREA.      10800000
         SPACE                                                          10820000
*                                                                       10840000
*   LINK TO READ IN PGM= *. SIOT.   ASSIGN A NEW TTR.                   10860000
*                                                                       10880000
         SR    R5,R5              SET R5 FOR READ.                      10900000
         BAL   RE,EARWA           LINK TO QMGR READ INTERFACE.          10920000
         L     R5,EAVDBSD         ADDR OF DSENQ TABLE ROUTINE.   Y02668 10926002
         BALR  RE,R5              CHECK DSNAME IN DSENQ TABLE    Y02668 10932002
         SPACE                                                          10940000
         LA    R4,SIOT            SIOT ADDRESSING.                      10960000
         USING INDMSIOT,R4                                              10980000
         MVC   SCT+SCTGOTTR-INSMSCT(MVTHREE),EATEMP1  SAVE TTR OF O106  10990019
*                                      REF SIOT                   O106  11000019
         OC    SCT+SCTFSIOT-INSMSCT(MVFOUR),SCT+SCTFSIOT-INSMSCT       *11020002
                                   1ST SIOT PTR INITIALIZED?    YM01562 11024002
         BNZ   EAPGM8K       FIRST SIOT PTR INIT,CONTINUE...    YM00365 11028002
         MVC   SCT+SCTFSIOT-INSMSCT(MVTHREE),SIOTDSKA MOVE SIOT YM01562 11032002
*              SVA TO FIRST SIOT PTR IN SCT.                    YM01562 11036002
EAPGM8K  DS    0H                                               YM00365 11038002
         LA    R5,WAEXCPFX   LOAD ADDRESS OF EXEC PREFIX.       YM01562 11040002
         USING TEXT,R5                                          YM01562 11044002
         TM    STREINDC,ETXNODD    ANY DD CARDS IN STEP ?       YM01562 11048002
         DROP  R5                                               YM01562 11052002
         BZ    EAPGM8J       YES,DON'T ZERO NEXT SIOT PTR...    YM01586 11056002
         XC    SCTPSIOT(MVFOUR),SCTPSIOT    ZERO NEXT SIOT PTR, YM01562 11060002
*              BECAUSE READ ROUTINE INITIALIZED IT WITH TNEXT+4 YM01562 11064002
EAPGM8J  DS    0H                                               YM01562 11068002
         OI    SCT+SCTSTYPE-INSMSCT,GOSTEP  SCTGOSTP IN SCT ON    O106  11080019
         SR    R2,R2                                                    11100000
         LA    R3,1                                                     11120000
         LH    R2,SCT+SCTLALOC-INSMSCT                           Y02668 11140002
         AR    R2,R3              *    ADD ONE TO SCTLALOC.             11160000
         STH   R2,SCT+SCTLALOC-INSMSCT                           Y02668 11180002
         LH    R2,DDINTNO         *                              Y02668 11210002
         AR    R2,R3              *    ADD ONE TO DDINTNO.       Y02668 11240002
         STH   R2,DDINTNO         *                              Y02668 11270002
         STH   R2,SCTDDINO        SET DD INTERNAL NBR IN SIOT.   Y02668 11300002
         MVC   SCTDDNAM(8),EAPGMSD MOVE 'PGM=*.DD' TO DDNAME FIELD.     11340000
         NI    SCTSBYT2,SCTUNLBD+SCTRECVD                        A32757 11352020
         NI    SCTSBYT1,SCTDUMMY                                 A32757 11356020
*                                                                       11360000
*   WRITE AND ASSIGN SIOT   UPDATE TNEXT.                               11380000
*                                                                       11400000
         LA    R5,4               SET R5 FOR WRITE & ASSIGN.            11420000
         BAL   RE,EARWA           LINK TO QMGR W&A INTERFACE.           11440000
*                                                                       11460000
*   GET NEXT KEYWORD.                                                   11480000
*                                                                       11500000
         BALR  RE,RF              *    MAKE GET ROUTINE STEP THRU TO    11520000
         BALR  RE,RF              *         END OF PGM=*. PARAMETERS.   11540000
EAPGM9   DS    0H                                                       11560000
         BALR  RE,RF              LINK TO GET KEY.                      11580000
EAPGM10  DS    0H                                                       11600000
         SPACE                                                          11620000
         MVI   MSGSEC,EAR54       - ERROR - PGM FIELD FORMAT ERROR.     11640000
         B     EACLEANP           GO TO FAIL JOB & PUT OUTMSG.          11660000
         SPACE                                                          11680000
EAPGM11  DS    0H                                                   438 11700000
         MVI   MSGKEY,EXECK       SET SECONDARY ERROR MSG TO EXEC.  438 11720000
         B     EAPGM10            GO SET FORMAT ERROR.              438 11740000
         SPACE 2                                                        11760000
EAMVC2   MVC   EAREGSV+4(1),EASNSVL    MOVE NAME OF STEP TO DICT BUILD. 11780000
         EJECT                                                          11783016
         EJECT                                                          11813016
*********************************************************************** 11820000
*                                                                     * 11840000
*              ACCT/ACCT. KEYWORD ROUTINE.                            * 11860000
*                                                                     * 11880000
*********************************************************************** 11900000
EAACTP   DS    0H                 (ACCT.) KEYWORD.                      11920000
         SPACE                                                          11940000
         BAL   RE,EAORIDE         LINK TO UPDATE O'RIDE TABLES AND SET  11960000
*                                      ACT O'RIDE FLAG IN TABLE.        11980000
         BALR  RE,RF              LINK TO GET 1ST ACCT FIELD.           12000000
         L     R6,TNUM            R6 (CNTR2) MAINTAINS TOTAL LENGTH 220 12020000
         BCTR  R6,0               EACH ACCNT FIELD + NBR ACCT FLDS. 220 12040000
         B     EAACT2             GO TO MOVE ACTNG INFO TO ACT.         12060000
         SPACE 2                                                        12080000
EAACTE   DS    0H                 (ACCT) KEYWORD.                       12100000
         SPACE                                                          12120000
         L     R6,TNUM            R6 (CNTR2) = TOTAL LENG ACT FLD.  220 12140000
         TM    SWE,PRCV           IS PRIME PROC BUFFER SW ON.           12160000
         BZ    EAACT1             NO.  GO TO CHECK ACCT ORIDE SW.       12180000
         OI    SWF,ORACTOR        YES.  PUT ON ACT O'RIDE SW.           12200000
         OI    EASW2,EAEACCTE          SET ACCT=  SWITCH         A22206 12210018
         B     EAACT2             GO TO MOVE ACTNG INFO TO ACT.         12220000
         SPACE                                                          12240000
EAACT1   DS    0H                                                       12260000
         TM    SWF,ORACTOR        IS ACT O'RIDE FLAG ON.                12280000
         BZ    EAACT2             NO.  GO TO MOVE ACTNG INFO TO ACT.    12300000
         OI    EASW1,EAACTORF     SET FLAG TO INDICATE O'RIDE FLAG ON.  12320000
*                                                                       12340000
*   ACCOUNTING INFORMATION TO BE MOVED TO ACT.                          12360000
*                                                                       12380000
EAACT2   DS    0H                                                       12400000
         LA    R1,ACT             STEP ACT ADDRESS.                     12420000
         XC    0(176,R1),0(R1)    CLEAR ACT.                            12440000
         LA    R7,ACTJNFLD-ACTDSKAD+1(R1)   ACT FLD ADDRESS TO R7.      12460000
         SR    R5,R5         R5 = CNTR1. - NBR ACTNG FIELDS.            12480000
EAACT3   DS    0H                                                       12500000
         AR    R6,R2              INCREMENT CNTR 2 BY ACTNG FLD LEN.    12520000
         LA    R0,144                                                   12540000
         CLR   R6,R0              DOES ACCTNG INFO EXCEED 144 BYTES.    12560000
         BH    EAACT4A            YES. GO TO SET ERROR MESSAGE.         12580000
         SPACE                                                          12600000
         LTR   R2,R2              IS THIS A NULL PARAMETER.             12620000
         BZ    EAACT4             YES. GO TO CHECK FOR LAST PARAM.      12640000
         SPACE                                                          12660000
         EX    R2,EAACTMV1        MOVE ACCOUNTING INFO TO ACT.          12680000
         SPACE                                                          12700000
EAACT4   DS    0H                                                   220 12720000
         LA    R5,1(R5,0)         ADD ONE TO CNTR /.                    12740000
         LA    R7,1(R7,R2)        POINT TO NEXT ACT STORE POSITION.     12760000
         CLC   TNUM(4),TCT        ACCTNG FIELDS COMPLETED.              12780000
         BE    EAACT5             YES. GO TO SET NBR ACT FIELDS.        12800000
         SPACE                                                          12820000
         BALR  RE,RF              GET NEXT ACCNTG INFO.                 12840000
         SPACE                                                          12860000
         B     EAACT3             GO TO CHECK NEXT ACCTNG INFO.         12880000
         SPACE                                                          12900000
*   ERROR - ACTNG FIELD EXCEEDS 144 CHARACTERS.                         12920000
EAACT4A  DS    0H                                                       12940000
         MVI   MSGSEC,EAR45       MOVE MSG NBR TO IWA.                  12960000
         B     EAERRTN            GO TO ERROR RETURN.                   12980000
         SPACE                                                          13000000
EAACT5   DS    0H                                                       13020000
         STC   R5,ACTJNFLD-ACTDSKAD(R1)     STORE NBR ACT FLDS.         13040000
         SPACE                                                          13060000
         TM    EASW1,EAACTORF     WAS THIS AN OVERRIDE ACT.             13080000
         BO    EAACTXIT           YES. GO TO GET NEXT KEY.              13100000
*                                                                       13120000
*   PUT ACT IN Q.  WRITE AND ASSIGN.                                    13140000
*                                                                       13160000
         LA    R7,QPARM           QMANAGER PARAMETER AREA.              13180000
         USING IOPARAMS,R7                                              13200000
         L     R6,QMPCL           QMPCA ADDRESS TO R6.                  13220000
         ST    R1,0(R6)           ACT ADDRESS TO QMPCA.                 13240000
         MVC   4(4,R6),TNEXT      TTR TO QMPEX.                         13260000
         MVC   0(3,R1),TNEXT      TTR TO ACT.                           13280000
         MVI   3(R1),ACTID        SET ACT ID.                           13300000
         SPACE                                                          13340000
         L     RF,EAVHQ           IEFVHQ ADDRESS TO R15.                13360000
         BALR  RE,RF              LINK TO QMANAGER INTERFACE.           13380000
         SPACE                                                          13400000
         L     RF,EAGETKEP        RESTORE GET KEY/POS ADDRESS.          13420000
         SPACE                                                          13440000
         TM    EASW1,EAPGMSDF+EAPGMEF  IS THIS PGM= OR PGM=*.     17583 13460017
         BZ    EAACT6             NO. GO TO CHECK FOR ACT./ACT.         13480000
         MVC   SCT+SCTAFACT-INSMSCT(MVFOUR),TNEXT  YES, MOVE ACT  O106  13490019
*                                      TTR TO SCT                 O106  13500019
         B     EAACT8             GO TO UPDATE TNEXT.                   13520000
EAACT6   DS    0H                                                       13540000
         CLI   MSGKEY,ACCTPEK     IS THIS AN ACT. KEY.                  13560000
         BNE   EAACT7             NO (ACT) GO TO MOVE ACT TTR TO IWA.   13580000
         LA    R4,EAORTABL        O'RIDE TABLE ADDRESSING.              13600000
         USING ORTABLE,R4                                               13620000
         MVC   ORACTTTR(3),TNEXT  (ACT.)-MOVE ACT TTR TO O'RIDE TABLE.  13640000
         B     EAACT8             GO TO UPDATE TNEXT.                   13660000
         SPACE                                                          13680000
EAACT7   DS    0H                                                       13700000
         MVC   TACT(4),TNEXT      (ACT) MOVE ACT TTR TO TACT OF IWA.    13720000
EAACT8   DS    0H                                                       13740000
         MVC   TNEXT(4),0(R6)     UPDATE TNEXT.                         13760000
EAACTXIT DS    0H                                                       13780000
         BALR  RE,RF              GO GET NEXT KEY.                      13800000
         SPACE 2                                                        13820000
EAACTMV1 MVC   0(1,R7),0(R3)      ACTNG FIELD & LENGTH TO ACT. EXECUTED 13840000
         EJECT                                                          13860000
*********************************************************************** 13880000
*                                                                     * 13900000
*              PARM/PARM. KEYWORD ROUTINE.                            * 13920000
*                                                                     * 13940000
*********************************************************************** 13960000
         SPACE                                                          13980000
EAPARMP  DS    0H                 (PARM.) KEYWORD.                      14000000
         SPACE                                                          14020000
         BAL   RE,EAORIDE         LINK TO UPDATE O'RIDE TABLES AND SET  14040000
*                                      PARM O'RIDE FLAG IN TABLE.       14060000
         BALR  RE,RF              LINK TO GET PARM FIELD.               14080000
         SPACE                                                          14100000
         MVC   EAORTABL+ORPARM-ORTABLE(3),TNEXT  SET UP TTR FOR PARM X  14120017
         LA    R5,EAORTABL+ORPARMSZ-ORTABLE PARM SIZE ADDR TO R5.       14140000
         B     EAPARM2A           GO TO ENTER PARM IN O'RIDE TABLE.     14160000
         SPACE 2                                                        14180000
EAPARME  DS    0H                 (PARM) KEYWORD.                       14200000
         SPACE                                                          14220000
         TM    SWE,PRCV           PRIME PROCEDURE BUFFER.               14240000
         BO    EAPARM1            YES. GO TO PUT PARM O'RIDE ON IN IWA. 14260000
         SPACE                                                          14280000
         TM    SWF,ORPARMBL       IS PARM BLOCK SET.                    14300000
         BZ    EAPARM2            NO.  GO TO ENTER PARM IN SCT.         14320000
         B     EAPARM4            YES. GO TO GET NEXT KEY.              14340000
         SPACE                                                          14360000
EAPARM1  DS    0H                                                       14380000
         OI    SWF,ORPARMOR       TURN ON PARM O'RIDE FLAG.             14400000
EAPARM2  DS    0H                                                       14420000
         MVC   SCT+SCTXBTTR-INSMSCT(MVTHREE),TNEXT  SET UP TTR FOR O106 14430019
*                                      PARM EXTENSION             O106  14440019
         LA    R5,SCT+SCTSEXEC-INSMSCT ADDR OF PARM SIZE SLOT IN  O106  14450019
*                                      SCT                        O106  14460019
EAPARM2A DS    0H                                                       14480000
         SR    R6,R6              SET R6 FOR LENGTH OF PARM FIELD.      14500000
         XC    EAAUXWK(176),EAAUXWK     CLEAR PARM TABLE           AACA 14508017
         MVC   EAAUXWK(3),TNEXT         TTR TO PARM TABLE          AACA 14516017
         MVI   EAAUXWK+3,EAPXID   MOVE IN PARM EXT ID              AACA 14524017
         LA    R7,EAAUXWK+4                                        AACA 14532017
         NI    EASW1,FF-EAPARMF1  TURN OFF POSIBLE PREVIOUS BYPASS SW.  14540000
EAPARM2B DS    0H                                                       14560000
         AR    R6,R2              R6 = LENGTH OF PARM FIELD.            14580000
         LA    R0,100             MAX LENGTH=100                   AACA 14600017
         CLR   R6,R0              DOES PARM FIELD EXCEED MAXIMUM.       14620000
         BH    EAPARM3            YES. GO TO SET ERROR MESSAGE.         14640000
         SPACE                                                          14660000
         TM    EASW1,EAPARMF1     BYPASS STORE SWITCH ON.               14680000
         BO    EAPARM2D           YES. GO TO CHECK LENGTH & GET KEY.    14700000
         SPACE                                                          14720000
         LTR   R2,R2              NULL PARAMETER.                       14740000
         BZ    EAPARM2C           YES. GO TO CHECK OF FIELD.            14760000
         SPACE                                                          14780000
         BCTR  R2,0                                                     14800000
         EX    R2,EAPARMV1        MOVE PARM FIELD TO TABLE.             14820000
         LA    R7,1(R2,R7)         POINT TO NEXT STORAGE LOC      RE511 14830014
         SPACE                                                          14840000
EAPARM2C DS    0H                                                       14860000
         CLC   TNUM(4),TCT        END OF PARM FIELD.                    14880000
         BE    EAPARM2E           YES. GO TO MOVE IN PARM FIELD LENGTH. 14900000
         SPACE                                                          14920000
         MVI   0(R7),C','         RESTORE COMMA.                        14960000
         LA    R7,1(0,R7)         POINT TO NEXT STORE LOCATION.         14980000
         SPACE                                                          15000000
EAPARM2D DS    0H                                                       15020000
         LA    R6,1(0,R6)         INDEX R6 FOR COMMA COUNT.             15040000
         SPACE                                                          15060000
         BALR  RE,RF              LINK TO GET NEXT PARAM/KEY.           15080000
         SPACE                                                          15100000
         B     EAPARM2B           GO TO ERROR CHECK & STORE PARM FIELD. 15120000
         SPACE                                                          15140000
EAPARM2E DS    0H                                                       15160000
         ST    R6,EATEMP1         STORE PARM FIELD LENGTH INTO SCT.     15180000
         MVC   0(2,R5),EATEMP1+2       OR O'RIDE TABLE.                 15200000
         LA    R7,QPARM                                            AACA 15201017
         USING IOPARAMS,R7                                         AACA 15202017
         L     R6,QMPCL                 REMOTE LIST ADDRESS        AACA 15203017
         LA    R5,EAAUXWK               PARM TABLE ADDRESS         AACA 15204017
         ST    R5,0(R6)                 PARM ADDR TO REMOTE LIST   AACA 15205017
         MVC   4(4,R6),TNEXT            TTR TO REMOTE LIST         AACA 15206017
         SPACE                                                          15207017
         L     R5,EAVHQ                 LINK TO IEFVHQ             AACA 15208017
         BALR  RE,R5                                               AACA 15209017
         SPACE                                                          15210017
         MVC   TNEXT(4),0(R6)           REPLACE TNEXT              AACA 15211017
         BALR  RE,RF              GO GET NEXT KEY.                      15220000
         SPACE                                                          15240000
EAPARM3  DS    0H                                                       15260000
         MVI   MSGSEC,EAR56       PARM FIELD FORMAT ERROR.              15280000
         B     EACLEANP                                                 15300000
         SPACE                                                          15320000
EAPARM4  DS    0H                                                       15340000
         SR    R6,R6              SET R6 FOR LENGTH OF PARM FIELD.      15360000
         OI    EASW1,EAPARMF1     SET PARM STORE BYPASS SWITCH.         15380000
         B     EAPARM2B           GO TO STEP THRU PARM FIELDS.          15400000
         SPACE 2                                                        15420000
EAPARMV1 MVC   0(1,R7),1(R3)      PARM FIELD TO SCT/O'RIDE (EXECUTED).  15440000
         EJECT                                                          15460000
*********************************************************************** 15480000
*                                                                     * 15500000
*              TIME./TIME KEYWORD ROUTINE.                            * 15520000
*                                                                     * 15540000
*********************************************************************** 15560000
         SPACE                                                          15580000
EATIMEP  DS    0H                 (TIME.) KEYWORD.                      15600000
         SPACE                                                          15620000
         BAL   RE,EAORIDE         LINK TO O'RIDE ROUTINE TO UPDATE      15640000
*                                      TABLE & TURN ON TIME O'RIDE FLAG 15660000
         BALR  RE,RF              LINK TO GET TIME FIELD.               15680000
         B     EATIME2            GO TO CONVERT TIME.                   15700000
         SPACE 2                                                        15720000
EATIMEE  DS    0H                 (TIME) KEYWORD.                       15740000
         SPACE                                                          15760000
         TM    SWE,PRCV           PRIME PROC BUFFER.                    15780000
         BZ    EATIME1            NO. GO TO CHECK FOR TIME 0.           15800000
         OI    SWF,ORTIMEOR       YES. PUT ON TIME O'RIDE FLAG IN IWA.  15820000
         B     EATIME2            GO TO CONVERT TIME.                   15840000
EATIME1  DS    0H                                                       15860000
         TM    SWF,ORTIME0        TIME ZERO ON.                         15880000
         BO    EATIME4A           YES. GO TO GET NEXT KEY.              15900000
*  FALL THROUGH TO CONVERT TIME.                                YM01546 15940002
*                                                                       15950001
EATIME2  DS    0H                                                       15960000
*                                                                       16032001
*   CONVERT (MINS,SECONDS) TO 100THS OF SECONDS.                        16035001
         XC    EATEMP1(8),EATEMP1 ZERO TEMPORARY SLOTS TO SAVE TIMES.   16040000
         SPACE                                                          16060000
         BALR  RE,R9              CONVERT MINS TO BINARY,MVC TO TEMP1.  16080000
         SPACE                                                          16100000
         CLC   TNUM(4),TCT        ARE THERE SECONDS TO CONVERT.         16120000
         BE    EATIME3            NO. GO TO STORE MINUTES.              16140000
         SPACE                                                          16160000
         BALR  RE,RF              GET SECONDS.                          16180000
         SPACE                                                          16200000
         BALR  RE,R9              CONVERT SECS TO BINARY, MVC TO TEMP2. 16220000
         SPACE                                                          16240000
         L     R6,EATEMP2         *                                     16260000
         MH    R6,EA100           *    CONVERT SECS TO 100THS SECS.     16280000
         ST    R6,EATEMP2         *                                     16300000
         SPACE                                                          16320000
EATIME3  DS    0H                                                       16340000
         L     R6,EATEMP1         CONVERT MINUTES TO                    16360000
         MH    R6,EA6000               100THS SECONDS.                  16380000
         SPACE                                                          16400000
         AL    R6,EATEMP2         ADD SECONDS TO MINUTES.               16420000
         SPACE                                                          16440000
         ST    R6,EATEMP1         SAVE CONVERTED TIME.                  16460000
*                                                                       16480000
*   CHECK FOR (TIME/TIME.).                                             16500000
*                                                                       16520000
EATIME3A EQU   *                       CHECK FOR (TIME/TIME.).  A49826  16526001
*                                                               A49826  16532001
         CLI   MSGKEY,TIMEEEK     IS THIS A (TIME) KEY.                 16540000
         BNE   EATIME4            NO. (TIME.) GO TO MOVE TIME TO O'RIDE 16560000
*                                                                       16580000
*   (TIME) KEY - PUT TIME IN SCT.                                       16600000
*                                                                       16620000
         MVC   SCT+SCTSTIME-INSMSCT(MVTHREE),EATEMP1+DISPLONE     O106  16630019
*                                      MOVE TIME TO SCT           O106  16640019
         B     EATIME5            GO TO GET NEXT KEY.                   16660000
*                                                                       16680000
*   (TIME.) - PUT TIME IN O'RIDE TABLE.                                 16700000
*                                                                       16720000
EATIME4  DS    0H                                                       16740000
         LA    R6,EAORTABL        O'RIDE PABLE ADDRESS TO R6.           16760000
         USING ORTABLE,R6                                               16780000
         MVC   ORMAXTIM(3),EATEMP1+1   MOVE TIME TO O'RIDE TABLE.       16800000
         DROP  R6                                                       16820000
         B     EATIME5            GO TO GET NEXT KEY.                   16840000
*                                                                       16860000
*   TIME ZERO - LINK TO STEP THRU MINS.                                 16880000
*                                                                       16900000
EATIME4A DS    0H                                                       16920000
         BALR  RE,RF              LINK TO STEP THRU MINS.               16940000
*                                                                       16960000
*   TIME EXIT - GET NEXT KEYWORD.                                       16980000
*                                                                       17000000
EATIME5  DS    0H                                                       17020000
         BALR  RE,RF              LINK TO GET NEXT KEY.                 17040000
*                                                                       17060000
*   ERROR - GET SHOULD NOT RETURN HERE.  FORMAT ERROR.                  17080000
*                                                                       17100000
         MVI   MSGSEC,EAR57       TIME FIELD FORMAT ERROR.              17120000
         B     EACLEANP           GO TO CLEANUP.                        17140000
         EJECT                                                          17160000
*********************************************************************** 17180000
*                                                                     * 17200000
*              COND/COND. KEYWORD ROUTINE.                            * 17220000
*                                                                     * 17240000
*********************************************************************** 17260000
         SPACE                                                          17280000
EACONDP  DS    0H                 (COND.) KEYWORD.                      17300000
         SPACE                                                          17320000
         BAL   RE,EAORIDE         LINK TO O'RIDE ROUTINE TO UPDATE      17340000
*                                      TABLE & TURN ON COND O'RIDE FLAG 17360000
         BALR  RE,RF              LINK TO GET COND FIELD.               17380000
         B     EACOND2            GO TO SET UP PTR TO O'RIDE TABLE.     17400000
         SPACE 2                                                        17420000
EACONDE  DS    0H                 (COND) KEYWORD.                       17440000
*                                                                       17460000
*   CHECK FOR PRIME PROC BUFFER.                                        17480000
*                                                                       17500000
         TM    SWE,PRCV           IS PRCV ON.                           17520000
         BO    EACOND1            YES. GO TO SET COND O'RIDE SW IN IWA. 17540000
*                                                                       17560000
*   NOT PRIME PROC BUFFER - CHECK FOR COND O'RIDE SW ON IN IWA.         17580000
*                                                                       17600000
         TM    SWF,ORCONDOR       IS ORCONDOR ON.                       17620000
         BO    EACOND4            YES. GO TO SET COND STORE BYPASS SW.  17640000
*                                                                       17660000
*   NOT PRIME PROC BUFFER - NOT COND O'RIDE - SET TO STORE INTO SCT.    17680000
*        IF PRIME PROC BUFFER - SET TO STORE INTO DUMMY SCT.            17700000
*                                                                       17720000
EACOND0  DS    0H                                                       17740000
         LA    R7,SCT+SCTSDPCD-INSMSCT POINT R7 TO SCT DEPENDENCY CODE  17760000
*                                          STORE LOCATION.              17780000
         B     EACOND3            GO TO PROCESS COND FIELDS.            17800000
*                                                                       17820000
*                                                                       17840000
*   COND WITH PRCV ON - SET COND O'RIDE SWITCH IN IWA.                  17860000
*                                                                       17880000
EACOND1  DS    0H                                                       17900000
         OI    SWF,ORCONDOR       SET COND O'RIDE SW IN IWA.            17920000
         B     EACOND0            GO TO SET R7 = DUMMY SCT ADDRESS.     17940000
*                                                                       17960000
*   SET R7 TO STORE COND PARAMETERS INTO O'RIDE TABLE.                  17980000
*                                                                       18000000
EACOND2  DS    0H                                                       18020000
         LA    R7,EAORTABL+ORCONDCD-ORTABLE R7=STORE ADDR IN O'RIDE TAB 18040000
*                                                                       18060000
*   CLEAR OLD COND FIELDS IN SCT (O'RIDE COND FIELDS ALREADY CLEARED)   18080000
*   TURN OFF EACONORF - BYPASS STORE FLAG.                              18100000
*                                                                       18120000
EACOND3  DS    0H                                                       18140000
         XC    0(48,R7),0(R7)     CLEAR OLD SCT COND FIELDS.            18160000
         NI    EASW1,FF-EACONORF  TURN OFF BYPASS STORE FLAG.           18180000
         SPACE                                                          18200000
         B     EACOND5            GO TO PROCESS COND FIELDS.            18220000
*                                                                       18240000
*   COND - PRCV OFF - COND O'RIDE SW ON - SET STORE BYPASS SWITCH.      18260000
*                                                                       18280000
EACOND4  DS    0H                                                       18300000
         OI    EASW1,EACONORF     SET BYPASS STORE SWITCH.              18320000
*                                                                       18340000
*   PROCESS COND PARAMETERS - EVEN,ONLY,(CODE,OPERATOR,STEPNAME.   HW16 18350016
*                                                       PROCSTEP)  HW16 18360016
*                                                                       18380000
EACOND5  DS    0H                                                       18400000
         XC    EATEMP1(6),EATEMP1 CLEAR TEMP SAVE FOR DEPENDENCIES.     18420000
         MVI   MSGSEC,EAR40       SET ERROR CODE IF EXIT THRU GET       18440000
*                                      OCCURS BEFORE COND IS COMPLETE.  18460000
         LTR   R2,R2               IS IT NULL PARAMETER            3974 18460816
         BNZ   EACOND5A            NO, OK                          3974 18461616
*                                  IF THERE IS A NULL PARAMETER,   3974 18462416
*                                    THE NUMBER OF SUCH PARAMETERS 3974 18463216
*                                    MUST BE ZERO (COND.STEP=BLANK)3974 18464016
*                                    OR ONE (COND=BLANK)           3974 18464816
         CLI   TNUM1+3,X'01'       IS THE NUMBER OF SUBPARAMETERS  3974 18465616
*                                    ZERO OR ONE                   3974 18466416
         BH    EAERRTN             NO, COND FIELD FORMAT ERROR     3974 18467216
         MVI   MSGSEC,X'00'        CLEAR ERROR CODE                3974 18468016
         BALR  RE,RF               GO GET NEXT KEYWORD             3974 18468816
EACOND5A EQU   *                                                   3974 18469616
*                                                                  HW16 18470416
*   CHECK EVEN OR ONLY PARAMETERS, SET INDICATORS IN SCT           HW16 18471216
*                                                                  HW16 18472016
         CLC   0(5,R3),EAEVEN      TEST FOR EVEN PARAMETER         HW16 18472816
         BE    EACOND9B            YES, GO SET SCT EVEN BIT        HW16 18473616
*                                                                  HW16 18474416
         CLC   0(5,R3),EAONLY      TEST FOR ONLY PARAMETER         HW16 18475216
         BE    EACOND9C            YES, GO SET SCT ONLY BIT        HW16 18476016
*                                                                  HW16 18476816
*   PROCESS (CODE,OPERATOR,STEPNAME.PROCSTEP) PARAMETER            HW16 18477616
*                                                                  HW16 18478416
*                                                                       18480000
*   CODE - CVB, CHECK FOR 4095 MAX AND MOVE TO EATEMP1(2).              18500000
*                                                                       18520000
         BALR  RE,R9              LINK TO TEST & STORE CODE.            18540000
*                                                                       18560000
*   CHECK FOR PROPER FORMAT FOR CONDITION FIELDS.                       18580000
*                                                                       18600000
         BCTR  R3,0               POINT TO SUBPARAMETER INDICATOR BYTE. 18620000
         TM    0(R3),X'80'        IS HIGH ORDER BIT ON.             438 18640000
         BZ    EAERRTN            NO.- COND FIELD FORMAT ERROR.         18660000
*                                                                       18680000
*   GET OPERATOR.                                                       18700000
*                                                                       18720000
         BALR  RE,RF              LINK TO GET OPERATOR.                 18740000
         LTR   R2,R2              IS THERE AN OPERATOR.                 18760000
         BZ    EAERRTN            NO.  ERROR.                           18780000
*                                                                       18800000
*   OPERATOR - CHECK OPERATOR SPELLING AND MOVE HEX BIT PATTERN         18820000
*        TO EATEMP1+2(1).                                               18840000
*                                                                       18860000
         BALR  RE,R9              LINK TO TEST & STORE OPERATOR.        18880000
*                                                                       18900000
*   CHECK FOR STEPNAME.                                                 18920000
*                                                                       18940000
         CLC   TNUM1(4),TCT1      IS THERE A STEPNAME AFTER OPERATOR.   18960000
         BE    EACOND17           NO. GO TO PUT IN ZERO TTR.            18980000
*                                                                       19000000
*   GET STEPNAME.                                                       19020000
*                                                                       19040000
         BALR  RE,RF              LINK TO GET STEPNAME.                 19060000
*                                                                       19080000
*                                                                       19100000
*   BLANK 8 CHAR SLOT IN WORK AREA & SAVE STEPNAME (THRU T&S) FOR       19120000
*        FUTURE REFERENCE.                                              19140000
*                                                                       19160000
         MVC   EAREGSV(8),EABLANK BLANK WORK SPACE.                     19180000
         BALR  RE,R9              LINK TO MOVE STEPNAME TO EAREGSV.     19200000
         SPACE                                                          19220000
*                                                                       19240000
*   CHECK FOR STEPNAME.PROCSTEP.                                        19260000
*                                                                       19280000
         CLC   TNUM1(4),TCT1      DOES PROCSTEP FOLLOW STEPNAME.        19300000
         BE    EACOND7            NO. GO TO CHECK PROCEDURE.            19320000
*                                                                       19340000
         OI    EASW1,EACNDF1      INDICATE PROCSTEP FOLLOWS STEP YM4022 19390001
*                                                                YM4022 19440001
         LA    R0,2               SET UP NBR OF ARGUMENTS FOR    YM4022 19450001
*                                 SEARCH.                        YM4022 19460001
*     SET UP NBR OF ARGUMENTS, INDICATE SEARCH FOR SCT AND       YM4022 19470001
*        LOAD R4 WITH ADDRESS OF SEARCH ROUTINE.                        19480000
*                                                                       19500000
EACOND6  DS    0H                                                       19520000
         LR    R1,R3              LENGTH PTR TO R1.                     19540000
         BCTR  R1,0               POINT BYTE BEFORE LENGTH.             19560000
         STC   R0,0(R1)           SET NBR OF PARAMETERS.                19580000
         OI    SRCHSW1,SRCHF2     INDICATE SCT SEARCH.                  19600000
         L     R4,EASEARCH        SEARCH ADDRESS TO R4.                 19620000
         B     EACOND9            GO TO CHECK BYPASS.                   19640000
*                                                                       19660000
*   NO PROCSTEP - CHECK FOR PRCV ON.                                    19680000
*                                                                       19700000
EACOND7  DS    0H                                                       19720000
         CLI   MSGKEY,CONDPEK     IS THIS A (COND.).                    19740000
         BE    EACOND8            YES. GO TO SET QUALIFYING INDICATOR.  19760000
         CLC   EAREGSV(8),EASNSV  IS STEPNAME IN COND FIELD       M1726 19765020
*                                 SAME AS NAME OF THIS STEP       M1726 19770020
         BE    EAERRTN            YES,FORMAT ERROR IN COND FIELD  M1726 19775020
         SPACE                                                          19780000
         LA    R0,1               SET NBR PARAMETERS = 1.               19800000
         B     EACOND6            GO TO SET UP SEARCH PARAMS.           19820000
*                                                                       19840000
*   STEPNAME ONLY - PRCV ON - INDICATE PROCEDURE STEPNAME IS TO BE      19860000
*        USED TO QUALIFY REFER BACK.                                    19880000
*                                                                       19900000
EACOND8  DS    0H                                                       19920000
         OI    EASW1,EACNDF2      SET QUALIFY INDICATOR.                19940000
*   FALL THRU FOR NEXT TWO TESTS - TAKE BRANCH TO EACOND10 IF THE       19960000
*        BYPASS STORE SWITCH IS NOT ON.                                 19980000
         SPACE                                                          20000000
*                                                                       20020000
*   CHECK FOR BYPASS STORE SWITCH.                                      20040000
*                                                                       20060000
EACOND9  DS    0H                                                       20080000
         TM    EASW1,EACONORF     IS BYPASS SWITCH ON.                  20100000
         BO    EACOND15           YES. GO TO GET NEXT KEY.              20120000
*                                                                       20140000
*   CHECK FOR (COND.) KEY - SEARCH DICT IF NOT AND MOVE SCT TTR + CODE  20160000
*        AND OPERATOR TO SCT. (OR DUMMY SCT).                           20180000
*                                                                       20200000
         CLI   MSGKEY,CONDPEK     IS THIS A (COND.).                    20220000
         BE    EACOND10           YES. GO TO CHECK QUALIFYING STEPNAMES 20240000
         SPACE                                                          20260000
         BALR  RE,R4              LINK TO SEARCH FOR SCT TTR.           20280000
         SPACE                                                          20300000
         MVC   EATEMP1+3(3),2(R1) MOVE SCT TTR TO TEMP SAVE.            20320000
*                                                                       20340000
*   MOVE CODE, OPERATOR & TTR TO SCT.                                   20360000
*                                                                       20380000
EACOND9A DS    0H                                                       20382016
         MVC   0(6,R7),EATEMP1    MOVE CODE,OPERATOR & TTR TO SCT.      20384016
         LA    R7,6(R7)           INCREMENT SCT STORE POINTER.          20386016
         B     EACOND15           GO TO CYCLE THRU AGAIN.               20388016
EACOND9B DS    0H                                                  HW16 20390016
         OI    EATEMP1,SCTEVEN     SET EVEN INDICATOR IN EATEMP1   HW16 20392016
         B     EACOND9D            CONTINUE                        HW16 20394016
EACOND9C DS    0H                                                  HW16 20396016
         OI    EATEMP1,SCTONLY     SET ONLY INDICATOR IN EATEMP1   HW16 20398016
EACOND9D DS    0H                                                  HW16 20400016
         CLI   MSGKEY,CONDPEK      O'RIDE IN PROGRESS?             HW16 20402016
         BE    EACOND9E            YES, STORE INTO O'RIDE TABLE    HW16 20404016
*                                                                  HW16 20406016
*   STORE EATEMP1 IN SCT (EIGHTH COND SLOT) - EVEN OR ONLY         HW16 20408016
*                                                                  HW16 20410016
         TM    EASW1,EACONORF      TEST BYPASS STORE SWITCH        HW16 20412016
         BO    EACOND15            IF ON, GET NEXT PARAM/KEY       HW16 20414016
*                                  IF OFF, PROCEED                 HW16 20416016
         OC    SCT+SCTABCND-INSMSCT(OC6),SCT+SCTABCND-INSMSCT     O106  20417019
*                                      IF SLOT IS NON ZERO        O106  20418019
*              EITHER TOO MANY COND OR MULTIPLE EVEN'S/ONLY'S      HW16 20420016
         BC    7,EAERRTN           GO TO ERROR ROUTINE             HW16 20422016
         OC    SCT+SCTABCND-INSMSCT(OC6),EATEMP1                  O106  20423019
*                                      EVEN OR ONLY INTO SLOT     O106  20424019
         B     EACOND15            GET NEXT PARAMETER / KEY        HW16 20426016
EACOND9E DS    0H                                                  HW16 20428016
*                                                                  HW16 20430016
*   STORE EATEMP1 IN O'RIDE TABLE (EIGHTH COND SLOT) - EVEN OR ONLYHW16 20432016
*                                                                  HW16 20434016
         OC    EAORTABL+ORCONDCD-ORTABLE+84(12),EAORTABL+ORCONDCD-ORTABX20436016
               LE+84               IF THIS FIELD ALREADY NON-ZERO, HW16 20438016
*              EITHER TOO MANY COND OR MULTIPLE EVEN'S/ONLY'S      HW16 20440016
         BC    7,EAERRTN           GO TO ERROR ROUTINE             HW16 20442016
         OC    EAORTABL+ORCONDCD-ORTABLE+84(1),EATEMP1      PUT    HW16 20444016
*                                  EVEN OR ONLY INTO O'RIDE TABLE  HW16 20446016
         B     EACOND15            GET NEXT PARAMETER / KEY        HW16 20448016
*                                                                       20480000
*   CHECK FOR REFERENCES WITHIN CALLING PROCEDURE. - IF NOT SEARCH DICT 20500000
*                                                                       20520000
EACOND10 DS    0H                                                       20540000
         CLC   EAREGSV(8),EASNSV  IS STEPNAME IN COND FIELD SAME AS     20560000
*                                      THE NAME OF THIS STEP.           20580000
         BE    EACOND11           YES. GO TO GET PROCSTEP.              20600000
         SPACE                                                          20620000
         TM    EASW1,EACNDF2      IS STEPNAME TO BE QUALIFIED.          20640000
         BO    EACOND14           YES. GO TO QUALIFY SINGLE STEPNAME.   20660000
         SPACE                                                          20680000
         BALR  RE,R4              LINK TO SEARCH DICTIONARY.            20700000
         SPACE                                                          20720000
         MVC   EATEMP1+3(3),2(R1) MOVE SCT TTR TO TEMP SAVE.            20740000
*                                                                       20760000
*   MOVE CODE, OPERATOR & TTR TO O'RIDE TABLE.                          20780000
*                                                                       20800000
EACOND1A DS    0H                                                       20820000
         MVC   0(6,R7),EATEMP1    MOVE CODE,OPERATOR & TTR TO O'RIDE.   20840000
         B     EACOND13           GO TO INCREMENT O'RIDE PTR.           20860000
*                                                                       20880000
*   GET PROCSTEP AND WITHIN THIS PROCEDURE.                             20900000
*                                                                       20920000
EACOND11 DS    0H                                                       20940000
         TM    EASW1,EACNDF1      IS THE NAME OF THIS PROCEDURE THE     20960000
*                                      ONLY NAME IN COND FIELD.         20980000
         BZ    EACOND14            GO TO QUALIFY SINGLE NAME    YA02850 21000002
         SPACE                                                          21020000
         BALR  RE,RF              GET PROCSTEP.                         21040000
         NI    EASW1,FF-EACNDF1   TURN OFF EACNDF1.                     21060000
*                                                                       21080000
*   STORE PARAMETERS IN ORIDE TABLE.                                    21100000
*                                                                       21120000
EACOND12 DS    0H                                                       21140000
         MVC   11(1,R7),0(R3)     STORE LENGTH.                         21160000
         MVC   0(3,R7),EATEMP1    STORE CODE & OPERATOR.                21180000
         MVC   3(8,R7),1(R3)      STORE STEPNAME.                       21200000
         LA    RE,EAORTABL        START OF O'RIDE TABLE ADDR TO RE.     21220000
         MVC   ORSTEPL-ORTABLE(9,RE),EASNSVL  MOVE PROC STEPNAME TO TAB 21240000
*                                                                       21260000
*   INCREMENT O'RIDE STORE POINTER.                                     21280000
*                                                                       21300000
EACOND13 DS    0H                                                       21320000
         LA    R7,12(R7)          POINT R7 TO NEXT O'RIDE STORE.        21340000
         B     EACOND15           GO TO CYCLE THRU AGAIN.               21360000
*                                                                       21380000
*   SET HIGH ORDER BIT OF LENGTH BYTE TO INDICATE QUALIFYING CONDITONAL 21400000
*        STEPNAME.                                                      21420000
*                                                                       21440000
EACOND14 DS    0H                                                       21460000
         OI    0(R3),X'80'        SET HIGH ORDER BIT OF LENGTH.         21480000
         B     EACOND12           GO TO STORE INTO O'RIDE TABLE.        21500000
*                                                                       21520000
*   SET UP PARAMETERS TO GET NEXT COND OR NEXT KEY.                     21540000
*                                                                       21560000
EACOND15 DS    0H                                                       21580000
         TM    EASW1,EACNDF1      IS THERE A PROCSTEP.           YM4022 21590001
         BZ    EACOND16           NO GO TO CLEAR FLAGS           YM4022 21592001
         BALR  RE,RF              YES POINT TO PROCSTEP          YM4022 21594001
EACOND16 DS    0H                                                YM4022 21596001
         ST    RB,TPDTP           FORCE TEST & STORE TO RE-CYCLE.       21600000
         NI    EASW1,FF-EACNDF1-EACNDF2   TURN OFF HSKPNG FLAGS.        21700000
         MVI   MSGSEC,X'00'       CLEAR ERROR MSG SLOT.                 21720000
         BALR  RE,RF              GET NEXT KEY OR NEXT COND.            21740000
         B     EACOND5            COND - GO TO RE-CYCLE.                21760000
*                                                                       21780000
*   NO STEPNAME AFTER OPERATOR - INDICATE DEPENDENCY ON COMPLETION      21800000
*        CODES OF ALL PREVIOUS STEPS.                                   21820000
*                                                                       21840000
EACOND17 DS    0H                                                       21860000
         TM    EASW1,EACONORF     ARE WE BYPASSING STORE.               21880000
         BO    EACOND15           YES GO TO RE-CYCLE.                   21900000
         SPACE                                                          21920000
         CLI   MSGKEY,CONDPEK      IS THIS A (COND.) KEYWORD       HW16 21940016
         BE    EACOND1A           YES. GO TO MOVE CODE, OPERATOR &      21960016
*                                           ZERO TTR TO O'RIDE TABLE.   21980000
         B     EACOND9A           NOT PROC. GO TO MOVE CODE,OPERATOR &  22000000
*                                  ZERO TTR TO SCT                      22020002
         EJECT                                                          22021002
***********************************************************     YM00368 22022002
*                                                         *     YM00368 22023002
*              PERFORM./PERFORM KEYWORD ROUTINE           *     YM00368 22024002
*                                                         *     YM00368 22025002
***********************************************************     YM00368 22026002
*                                                         *     YM00368 22027002
*  THE EXEC PERFORM VALUE IS USED ONLY IF THE PERFORM     *     YM00368 22028002
*  KEYWORD WAS NOT SPECIFIED ON THE JOB STMT. IF SPECIFIED*     YM00368 22029002
*  THE JOB PERFORM VALUE (OR A DEFAULT IF THE JOB VALUE   *     YM00360 22030002
*  NULL OR INVALID) OVERRIDES EXEC PERFORM SPECIFICATIONS.*     YM00368 22031002
*                                                         *     YM00368 22032002
*  IF THE PERFORM KEYWORD WAS NOT SPECIFIED ON THE JOB    *     YM00368 22033002
*  STMT, IEFVJA OBTAINS A DEFAULT VALUE FOR USE BY IEFVEA *     YM00368 22034002
*  IN THE EVENT EXEC PERFORM VALUES WERE OMITTED OR       *     YM00368 22035002
*  INVALID.                                               *     YM00368 22036002
*                                                         *     YM00368 22037002
***********************************************************     YM00368 22038002
EAPRFMP  DS    0H                                               YM00368 22039002
         OI    SWG,ORFLG2SW        SET NEW KEYWORD O'RIDE FLAG. YM00368 22040702
         BAL   RE,EAORIDE         LINK TO O'RIDE RTNE TO UPDATE  Y02655 22040802
*                                 TABLE & TURN ON PERFORM O'RIDE Y02655 22041002
*                                 FLAG                           Y02655 22041202
         BALR  RE,RF              LINK TO GET PERFORM FIELD      Y02655 22041402
         LA    R7,EAORTABL+ORPRMVAL-ORTABLE POINT TO PERFORM     Y02655 22041602
*                                 IN O'RIDE                      Y02655 22041802
         B     EAPRFM3                                           Y02655 22042002
EAPRFME  DS    0H                 (PERFORM) KEYWORD              Y02655 22042202
         TM    SWE,PRCV            STMT INVOKE A PROCEDURE?     YM00368 22042802
         BO    EAPRFM1            YES GO TURN ON PERFORM O'RIDE  Y02655 22043002
*                                 IN IWA                         Y02655 22043202
         TM    SWG,ORPRFMOR       IS IWA O'RIDE FLAG ON?         Y02655 22043402
         BZ    EAPRFM2            NO GO ENTER PERFORM INTO SCT   Y02655 22043602
         BALR  RE,RF              YES GO GET NEXT KEY            Y02655 22043802
EAPRFM1  DS    0H                                                Y02655 22044002
         OI    SWG,ORPRFMOR       TURN ON IWA O'RIDE FLAG        Y02655 22044202
EAPRFM2  DS    0H                                                Y02655 22044402
         LA    R7,SCT+SCTPRFMF-INSMSCT PERFORM ADDR IN SCT       Y02655 22044602
EAPRFM3  DS    0H                                                Y02655 22044802
         TM    JCT+JCTSTAT2-INJMJCT,JCTPERFM PERFORM ON JOBCARD@ZA10064 22044903
         BO    EAPRFM9            YES, BRANCH TO EXIT          @ZA10064 22045003
         MVI   EATEMP1,E0         ZERO TEMP STORAGE             YM00368 22045203
         MVI   SCT+SCTPRFMF-INSMSCT,E0 ZERO PERFORM FIELD       YM00368 22045303
         LTR   R2,R2              PERFORM VALUE SPEC'D?         YM00368 22045402
         BZ    EAPRFM7            NO, BYPASS KEY PROCESSING     YM00368 22045602
         BALR  RE,R9               GO TO TEST AND STORE.        YM00368 22045802
         CLI   MSGSEC,E0           VGT ENTERS MSG CODE IF ERROR.YM00368 22046002
         BNE   EAPRFM7             BRANCH ON ERROR.             YM00368 22047002
*  IEFVGT WILL ACCEPT VALUES IN THE RANGE OF 0-255.             YM00368 22048002
         CLI   EATEMP1,E0         ZERO SPEC'D?                   Y02655 22049802
         BE    EAPRFM7             BRANCH YES, ZERO IS INVALID. YM00368 22050002
         SR    R1,R1              CLEAR REGISTER                 Y02655 22050202
         IC    R1,EATEMP1         LOAD VALUE FOR SYSEVENT        Y02655 22050402
         SYSEVENT VERIFYPG                                       Y02655 22050802
         L     RF,EAGETKEP        GET KEY ADDRESS                Y02655 22051002
*  SRM RETURNS ZERO IN BYTE 2 IF SPECIFIED VALUE IS DEFINED TO  YM00368 22051202
*  SYSTEM, OR A DEFAULT VALUE IF SPECIFIED VALUE IS UNDEFINED.  YM00368 22051302
         CLM   R1,E2,CONHZERO      ZERO RETURN CODE?            YM00376 22051402
         BE    EAPRFM6             BRANCH YES, VALID VALUE.     YM00368 22051502
         STCM  R1,E2,EATEMP1       SAVE DEFAULT VALUE.          YM00376 22051602
         MVC   E0(E1,R7),EATEMP1  PUT VALUE IN SCT/O'RIDE TABLE  Y02655 22052002
         LA    R2,WRNMSG05         PRF VALUE UNDEFINED MSG CODE.YM00368 22052202
         B     EAPRFM8             BR TO ISSUE WARNING MSG.     YM00368 22052302
EAPRFM6  DS    0H                                               YM00368 22052402
         MVC   0(1,R7),EATEMP1     PUT VAL IN SCT/O'RIDE TABLE. YM00368 22052502
         BALR  RE,RF               GO GET NEXT KEY.             YM00368 22052602
*  ERROR ENTRY - PERFORM VALUE INVALID OR OMITTED.              YM00368 22052702
EAPRFM7  DS    0H                                               YM00368 22052802
*  PERFORM ERROR.                                                       22052902
*  ERROR MAY BE ON EXEC PGM OR EXEC PROC STMT. A WARNING MSG IS YM00368 22053002
*  ISSUED AND A DEFAULT VALUE IS UNCONDITIONALLY ENTERED IN     YM00368 22053102
*  BOTH THE OVERRIDE TABLE AND THE SCT, TO COVER BOTH CASES.    YM00368 22053202
         MVC   EAORTABL+ORPRMVAL-ORTABLE(1),JCT+JCTPRFMF-INJMJCT        22053302
*                                  DEFAULT FOR PERFORM.STEP=    YM00368 22053402
         MVC   SCT+SCTPRFMF-INSMSCT(1),JCT+JCTPRFMF-INJMJCT     YM00368 22053502
*                                  DFLT FOR PERF= ON EXEC PROC  YM00368 22053602
         LA    R2,WRNMSG03         PRF VAL INVALID/OMITTED MSG. YM00368 22053702
EAPRFM8  DS    0H                                               YM00368 22053802
         MVI   MSGKEY,E0          CLEAR SECONDARY MSG FIELD     YM00368 22053902
         L     R5,EAVGM            MESSAGE MODULE ADDRESS.      YM00368 22054002
         BALR  RE,R5               ISSUE WARNING MSG. JOB IS    YM00368 22054102
*                                  NOT FAILED.                  YM00368 22054202
EAPRFM9  DS    0H                                               YM00368 22054302
         MVI   MSGSEC,0            CLEAR MSG CODE FOR NEXT TIME YM00368 22054402
         BALR  RE,RF               GO GET NEXT KEY.             YM00368 22054502
         EJECT                                                          22054602
************************************************************     Y02670 22054702
*                                                          *     Y02670 22055202
*        DYNAMNBR./DYNAMNBR KEYWORD ROUTINE                *     Y02670 22055302
*                                                          *     Y02670 22055402
************************************************************     Y02670 22055502
         SPACE                                                          22055602
EADYNMP  DS    0H                 (DYNAMNBR.) KEYWORD            Y02670 22055702
         OI    SWG,ORFLG2SW       TURN ON NEW O'RIDE KEY FLAG    Y02670 22055802
         BAL   RE,EAORIDE         LINK TO O'RIDE ROUTINE TO UP-  Y02670 22055902
*                                 DATE TABLE AND TURN ON DYNAMNBRY02670 22056002
*                                 O'RIDE FLAG                    Y02670 22056102
         BALR  RE,RF              LINK TO GET DYNAMNBR FIELD     Y02670 22056202
         LA    R7,EAORTABL+ORDYNVAL-ORTABLE POINT TO DYNAMNBR    Y02670 22056302
*                                 IN O'RIDE                      Y02670 22056402
         B     EADYNM3                                           Y02670 22056502
EADYNME  DS    0H                 (DYNAMNBR) KEYWORD             Y02670 22056602
         TM    SWE,PRCV           PRIME PROCEDURE BUFFER?        Y02670 22056702
         BO    EADYNM1            YES GO TURN ON DYNAMNBR O'RIDE Y02670 22056802
*                                 IN IWA                         Y02670 22056902
         TM    SWG,ORDYNMOR       IS O'RIDE FLAG ON IN IWA       Y02670 22057002
         BZ    EADYNM2            YES GO TO GET NEXT KEY         Y02670 22057102
         BALR  RE,RF              GO GET NEXT KEY                Y02670 22057202
EADYNM1  DS    0H                                                Y02670 22057302
         OI    SWG,ORDYNMOR       TURN ON IWA O'RIDE FLAG        Y02670 22057402
EADYNM2  DS    0H                                                Y02670 22057502
         LA    R7,SCT+SCTNIUSL-INSMSCT DYNAMNBR ADDR IN SCT      Y02670 22057602
EADYNM3  DS    0H                                                Y02670 22057702
         LTR   R2,R2              DYNAMNBR SPEC'D?               Y02670 22057802
         BZ    EADYNM5            NO, GO TO GET NEXT KEY         Y02670 22057902
         XC    EATEMP1(E2),EATEMP1 ZERO TEMP STORAGE             Y02670 22058002
         XC    SCT+SCTNIUSL-INSMSCT(E2),SCT+SCTNIUSL-INSMSCT     Y02670 22058102
*                                 CLEAR DYNAMNBR FIELD           Y02670 22058202
         BALR  RE,R9              GO TO TEST & STORE             Y02670 22058302
         CLI   MSGSEC,E0          ERROR DETECTED?                Y02670 22058402
         BE    EADYNM4            NO GO MOVE IN VALUE            Y02670 22058502
         MVI   MSGSEC,E0          CLEAR MSG FIELD                Y02670 22058602
         MVI   MSGKEY,E0          CLEAR SECONDARY MSG FIELD     YM00369 22058702
         LA    R2,WRNMSG04        LOAD WRN MSG FOR VGM          YM00369 22058802
         L     R5,EAVGM           GET MSG MODULE ADDR            Y02670 22058902
         BALR  RE,R5              GO PRINT MSG                   Y02670 22059002
         B     EADYNM5                                           Y02670 22059102
EADYNM4  DS    0H                                                Y02670 22059202
         MVC   E0(E2,R7),EATEMP1 PUT VALUE IN SCT/O'RIDE TABLE   Y02670 22059302
EADYNM5  DS    0H                                                Y02670 22059402
         BALR  RE,RF              GO GET NEXT KEY                Y02670 22059502
         EJECT                                                          22059602
*********************************************************************** 22060000
*                                                                     * 22080000
*              REGION./REGION KEYWORD ROUTINE.                        * 22100000
*                                                                     * 22120000
*********************************************************************** 22140000
         SPACE                                                          22160000
EAREGP   DS    0H                 (REGION.) KEYWORD.                    22180000
         SPACE                                                          22200000
         BAL   RE,EAORIDE         LINK TO O'RIDE ROUTINE TO UPDATE TAB  22220000
*                                      AND TURN ON REGION O'RIDE FLAG.  22240000
         BALR  RE,RF              LINK TO GET REGION FIELD.             22260000
         SPACE                                                          22280000
         LA    R7,EAORTABL+ORREG-ORTABLE POINT AT REGION IN O'RIDE AACA 22300017
         B     EAREG3             GO TO ENTER REGION INTO O'RIDE TABLE. 22320000
         SPACE 2                                                        22340000
EAREGE   DS    0H                 (REGION) KEYWORD.                     22360000
         SPACE                                                          22380000
         TM    SWE,PRCV           PRIME PROCEDURE BUFFER.               22400000
         BO    EAREG1             YES. GO TURN ON REGION O'RIDE IN IWA. 22420000
         SPACE                                                          22440000
         TM    SWF,ORREGOR        IS REGION O'RIDE FLAG ON IN IWA.      22460000
         BZ    EAREG2             NO. GO TO ENTER REGION IN SCT.        22480000
         BALR  RE,RF              YES. GO GET NEXT KEY.                 22500000
         SPACE                                                          22520000
EAREG1   DS    0H                                                       22540000
         OI    SWF,ORREGOR        TURN ON REGION O'RIDE FLAG IN IWA.    22560000
EAREG2   DS    0H                                                       22580000
         XC    SCT+SCTMSSZE-INSMSCT(E2),SCT+SCTMSSZE-INSMSCT     Y02668 22590002
*                                 CLEAR REGION REQ FLDS IN SCT.  A41178 22592001
         LA    R7,SCT+SCTMSSZE-INSMSCT ADDR OF REGION SLOT IN SCT O106  22600019
         SPACE                                                          22620000
EAREG3   DS    0H                                                       22640000
         XC    EATEMP2(E2),EATEMP2      ZERO FLAG FIELD          Y01029 22642001
         LTR   R2,R2              IS PRIMARY REGION SPECIFIED.     AACA 22645017
         BZ    EAREG5             NO. GO TO SET UP LCS.            AACA 22650017
EAREG3A  DS    0H                                                  AACA 22655017
         LA    R6,0(R2,R3)        POINT TO LAST CHAR. IN REGION FIELD.  22660000
         CLI   0(R6),C'K'         IS IT A 'K'.                          22680000
         BNE   EAPGM10            NO. -FORMAT ERROR (REGION)-  @ZA03866 22700003
         SPACE                                                          22720000
EAREG4   DS    0H                                                       22840000
         BCTR  R2,0               DECREMENT R2 TO GET NBRS ONLY.        22860000
         LTR   R2,R2         WAS 'K' ONLY SOECIFICATION?        YA02009 22866002
         BZ    EAPGM10       YES,FORMAT ERROR IN REGION FIELD.. YA02009 22872002
         BALR  RE,R9              LINK TO CVB AND MVC TO EATEMP1.       22880000
         SPACE                                                          22900000
         TM    EATEMP2,EAREGION   FIRST PASS ?                   Y01029 22950001
         BZ    EAREG4A            YES, MVC INTO SCT/O'RIDE       Y01029 22952001
         SPACE                                                          22954001
         AH    R5,EATEMP1          NO,ADD H1 TO H0               Y01029 22956001
         C     R5,MAXVAL           MAX REGION SPECIFIED?         Y01029 22956401
         BH    REGERR              YES, ERROR                    Y01029 22956801
         STH    R5,E0(R7)         SCT/O'RIDE REGION SIZE         Y01029 22958001
         B     EAREG5             CONTINUE REGION PROCESSING     Y01029 22958401
         SPACE                                                          22958801
EAREG4A  LH    R5,EATEMP1         H0 - LATER COMPUTE H0 + H1     Y01029 22959201
         MVC   E0(E2,R7),EATEMP1  MOVE H0 REGION TO SCT/O'RIDE   Y01029 22959601
         OI    EATEMP2,EAREGION   FIRST PASS - H0 SPECIFIED      Y01029 22959701
         SPACE                                                          22960001
EAREG5   DS    0H                                                       22980000
         OI    EASW2,EAREGION     REGION SPECIFIED ON EXEC       Y01029 22990001
         BALR  RE,RF              LINK TO GET NEXT KEY.                 23000000
         SPACE                                                          23003017
EAREG6   DS    0H                                                  AACA 23006017
         ST    RB,TPDTP           SET PDT TO TOP.                  AACA 23009017
         B     EAREG3A            GO TO PROCESS LCS REGION.        AACA 23015017
REGERR   MVI  MSGSEC,EAR58        MOVE IN REGION ERROR NUM       Y01029 23017001
         B    EAERRTN             PROCESS ERROR MSG              Y01029 23019001
         EJECT                                                          23020000
*********************************************************************** 23020314
*                                                                     * 23020614
*              ROLL./ROLL KEYWORD ROUTINE.                            * 23020914
*                                                                     * 23021214
*********************************************************************** 23021514
EAROLLP  DS    0H                 (ROLL.) KEYWORD.                      23021814
EAROLLE  DS    0H                 (ROLL) KEYWORD.                       23024514
         BALR  RE,RF              LINK TO GET NEXT KEY.                 23033814
         B     EAROLLP                                           Y01029 23035001
         EJECT                                                          23035101
*********************************************************************** 23035401
*                                                                    ** 23035501
*             ADDRSPC./ADDRSPC= KEYWORD ROUTINE                      ** 23035601
*                                                                    ** 23035901
*********************************************************************** 23037901
EAADDRP  DS    0H                 (ADDRSPC.) KEYWORD             Y01029 23038301
         SPACE                                                          23038801
         BAL   RE,EAORIDE         LINK TO O'RIDE RTN TO UP TAB   Y01029 23039901
         BALR  RE,RF              LINK TO GET ADDRSPC FIELD      Y01029 23040201
         LA    R7,EAORTABL+ORADDR-ORTABLE                        Y01029 23040601
*                                 ADDRSPC LOC IN O;RIDE TAB      Y01029 23041001
         B     EAADDR3            PUT ADDRSPC FLAGS IN TAB       Y01029 23041201
EAADDRE  DS    0H                 (ADDRSPC) KEYWORD              Y01029 23041601
         SPACE                                                          23041701
         TM    SWE,PRCV           PRIME PROCEDURE BUFFER         Y01029 23041801
         BO    EAADDR1            YES, TURN ON O'RIDE IN IWA     Y01029 23041901
         TM    SWF,ORADDROR       ADDRSPC O'RIDE IN IWA ?        Y0102  23042001
         BZ    EAADDR2            NO, ENTER ADDRSPC IN SCT       Y01029 23042101
         BALR  RE,RF              GET NEXT KEY                   Y01029 23042201
EAADDR1  DS    0H                                                       23042501
         OI    SWF,ORADDROR       TURN ON ADDRSPC O'RIDE IN IWA  Y01029 23042601
EAADDR2  DS    0H                                                Y01029 23042701
         LA    R7,SCT+SCTSSTAT-INSMSCT                           Y01029 23042801
*                                 ADDRESS OF ADDRSPC FLAG IN SCT        23043201
EAADDR3  DS    0H                                                Y01029 23043601
         LTR   R2,R2              ADDRSPC KEY SPECIFIED?         Y01029 23043701
         BZ    EAGETK             GET  NEXT KEY(NULLIFY)         Y01029 23043801
         MVI   EATEMP1,E0         CLEAR TEMP STORAGE             Y01029 23043901
         BALR  RE,R9              TEST AND STORE                 Y01029 23044001
EAADDR4  DS    0H                                                Y01029 23045301
         TM    EATEMP1,EAADDRBT   ADDRSPC = REAL?                Y01029 23045401
         BZ    EAADDR6            NO, INDICATE ADDRSPC ON EXEC   Y01029 23045501
         L     R3,WANELPTR         ADDRESS OF NEL.               Y02668 23046202
         USING EANEL,R3           NEL ADDRESSABILITY             Y01029 23047701
         TM    NELOPSW2,NELADSPC  IS THIS A TSO USER ?           Y01029 23048101
         BO    EAADRER1           YES, NOT PERMITTED - ERROR MSG Y01029 23048501
         DROP  R3                                                       23048701
         TM    SWD,JOBADDRF       ADDRSPC SPECIFIED ON JOB ?     Y01029 23049401
         BO    EAADDR6            YES, SET ADDRSPC ON EXEC       Y01029 23049601
         OI    JCT+JCTSTAT2-INJMJCT,JCTADSPC   SET JCT ADDR = REAL      23050001
EAADDR5  DS    0H                                                Y01029 23050701
         OC    E0(E1,R7),EATEMP1  SET ADDRSPC INFO IN SCT/O'RIDE TABLE  23051401
         SPACE                                                          23052101
EAADDR6  DS    0H                                                Y01029 23052801
         OI    EASW2,EAADDR       INDICATE ADDRSPC ON EXEC       Y01029 23053501
EAGETK   DS    0H                                                Y01029 23053901
         BALR  RE,RF              GET KEY                        Y01029 23054201
EAADRER1 DS    0H                                                Y01029 23054901
         MVI   MSGSEC,EAR62       ADDRSPC=REAL INVALID           Y01029 23055601
         MVI   MSGKEY,EXECK       ON EXEC STATEMENT              Y01029 23056001
         B     EAERRTN                                           Y01029 23056301
EAADRERR DS    0H                                                Y01029 23056701
         MVI   MSGSEC,EAR60        REQ. PARM MISSING             Y01029 23057101
         B     EAERRTN             GO TO ERROR RTN               Y01029 23057501
*********************************************************************** 23058401
*                                                                 *AACA 23059101
*              RD./RD KEYWORD ROUTINE                             *AACA 23059801
*                                                                 *AACA 23060501
*******************************************************************AACA 23061201
EARDP    DS    0H                 (RD.) KEYWORD                    AACA 23061901
         SPACE                                                          23062601
         BAL   RE,EAORIDE         LINK TO O'RIDE ROUTINE TO UPDATE AACA 23063301
*                                 TABLE AND TURN ON RD O'RIDE      AACA 23064001
*                                 FLAG.                            AACA 23064701
         BALR  RE,RF              LINK TO GET RD FIELD.            AACA 23065401
         SPACE                                                          23066101
         LA    R7,EAORTABL+ORRD-ORTABLE POINT AT RD FIELD IN TABLE AACA 23066801
         B     EARD3              ENTER RD FLAGS IN O'RIDE TABLE   AACA 23067501
         SPACE 3                                                        23068201
EARDE    DS    0H                 (RD) KEYWORD                     AACA 23068901
         SPACE                                                          23069601
         TM    SWE,PRCV           PRIME PROCEDURE BUFFER           AACA 23070301
         BO    EARD1              YES GO TURN ON RD O'RIDE IN IWA  AACA 23071001
         SPACE                                                          23071701
         TM    SWG,ORRDOR         RD O'RIDE ON IN IWA.             AACA 23072401
         BZ    EARD2              NO. GO TO ENTER RD FLAGS IN SCT. AACA 23073101
         BALR  RE,RF              YES. GO TO GET NEXT KEY          AACA 23073801
         SPACE                                                          23074501
EARD1    DS    0H                                                  AACA 23075201
         OI    SWG,ORRDOR         SET RD O'RIDE FLAG IN IWA        AACA 23075901
EARD2    DS    0H                                                  AACA 23076601
         LA    R7,SCT+SCTSSTAT-INSMSCT POINT AT R0 FLAGS IN SCT   O106  23077301
         SPACE 3                                                        23078001
EARD3    DS    0H                                                  AACA 23078701
         MVI   EATEMP1,X'00'      CLEAR TEMP STORAGE.              AACA 23079401
         SPACE                                                          23080101
         BALR  RE,R9              LINK TO GT TO SET BITS IN TEMP1  AACA 23080801
         SPACE                                                          23081501
         OC    0(1,R7),EATEMP1    SET BITS IN SCT/O'RIDE TABLE     AACA 23082201
         SPACE                                                          23082901
         BALR  RE,RF              LINK TO GK TO GET NEXT KEY       AACA 23083601
         EJECT                                                     7777 23084301
*******************************************************************I241 23085001
*                                                                  I241 23085701
*              SDP./SDP KEYWORD ROUTINE                            I241 23086401
*                                                                  I241 23087101
*******************************************************************I241 23087801
EASDPP   DS    0H                  (SDP.) KEYWORD                  I241 23088501
         BAL   RE,EAORIDE          LINK TO O'RIDE ROUTINE TO UPDATEI241 23089201
*                                     TABLE AND TURN ON SDP O'RIDE I241 23089901
*                                     FLAG                         I241 23090601
         BALR  RE,RF               LINK TO GET SDP FIELD           I241 23091301
         LA    R7,EAORTABL+ORSDP-ORTABLE POINT AT SDP IN O'RIDE    I241 23092001
         B     EASDP3              GO TO ENTER SDP IN O'RIDE TABLE I241 23092701
EASDPE   DS    0H                  (SDP) KEYWORD                   I241 23093401
         TM    SWE,PRCV            IS THIS PROC STATEMENT          I241 23094101
         BO    EASDP1              YES, GO TURN ON SDP O'RIDE IN   I241 23094801
*                                     IWA                          I241 23095501
         TM    SWG,ORSDPOR         IS SDP O'RIDE FLAG ON IN IWA    I241 23096201
         BZ    EASDP2              NO, GO ENTER SDP INTO SCT       I241 23096901
EASDP6   DS    0H                                                  I241 23097601
         BALR  RE,RF               YES, GO GET NEXT KEY            I241 23098301
         B     EASDP6              GO GET NEXT KEY                 I241 23099001
EASDP1   DS    0H                                                  I241 23099701
         OI    SWG,ORSDPOR         TURN ON SDP O'RIDE FLAG IN IWA  I241 23100401
EASDP2   DS    0H                                                  I241 23101101
         LA    R7,SCT+SCTSDP-INSMSCT   ADDR OF SDP IN SCT         O106  23101801
EASDP3   DS    0H                                                  I241 23102501
         OI    0(R7),X'10'         SET NO PRTY BIT                 I241 23103201
         MVI   1(R7),X'0B'         SET DEFAULT                     I241 23103901
         LTR   R2,R2               IS THERE PRTY SPECIFIED         I241 23104601
         BNZ   EASDP4              YES, GO CONVERT                 I241 23105301
         CLC   TNUM(4),TCT         NUMBER PARAMETERS EQUAL TO      I241 23106001
*                                     NUMBER PROCESSED             I241 23106701
         BE    EASDP6              YES, GO GET NEXT KEY            I241 23107401
EASDP4   DS    0H                                                  I241 23108101
         NI    0(R7),B'11101111'   TURN OFF NO PARM  BIT           I241 23108801
         LTR   R2,R2                    IS THERE PRTY SPECIFIED    I241 23109501
         BZ    EASDP5                   NO, GO GET NEXT KEY        I241 23110201
         MVI   EATEMP1,X'00'       CLEAR TEMP FIELD                I241 23110901
         BALR  RE,R9                    LINK TO CVB AND MVC TO TEMPI241 23111601
         MVN   0(1,R7),EATEMP1          MOVE SDP TO SCT OR O'RIDE  I241 23112301
EASDP5   DS    0H                                                  I241 23113001
         BALR  RE,RF                    LINK TO GET NEXT KEY       I241 23113701
         ST    RB,TPDTP                 SET PDT TO TOP             I241 23114401
         LA    R7,1(R7)                 POINT R7 AT NEXT SAVE SLOT I241 23115101
         B     EASDP4                   GO PROCESS SECOND FIELD    I241 23115801
         EJECT                                                     I241 23116501
*******************************************************************I241 23117201
*                                                                  I241 23117901
*              READ/WRITE & ASSIGN.                                   * 23118601
*                                                                     * 23119301
*                 R5 = 0  READ IN SIOT & JFCB USING EATTRSV.          * 23120000
*                         ASSIGN:                                     * 23140000
*                            1. TSIOT TO SIOT.                        * 23160000
*                            2. TNEXT TO JFCB.                        * 23180000
*                            3. MVC TNEXT+4 TO TSIOT & TO SCTPSIOT.   * 23200000
*                                                                     * 23220000
*                 R5 = 4  WRITE AND ASSIGN SIOT & JFCB.               * 23240000
*                         UPDATE TNEXT & TNEXT+4.                     * 23260000
*                                                                     * 23280000
*********************************************************************** 23300000
EARWA    DS    0H                                                       23320000
         STM   RE,R7,EAREGSV      SAVE REGS 14 - 7.                     23340000
         SPACE                                                          23360000
         LA    R7,QPARM           QMANAGER PARAMETER                    23380000
         USING IOPARAMS,R7             LIST ADDRESSING.                 23400000
         L     R3,EAVHQ           QMNGR (IEFVHQ) ADDRESS.               23420000
         L     R6,QMPCL           DATA RECORD POINTER.                  23440000
         LA    R4,SIOT            SIOT ADDRESS.                         23460000
         USING INDMSIOT,R4             ADDRESSING.                      23480000
         ST    R4,0(R6)           SIOT ADDRESS TO QMPCA.                23500000
         LA    R2,JFCB            JFCB ADDRESS.                         23520000
         USING EAJFCB,R2                                                23540000
*                                                                       23560000
*   CHECK FOR READ / WRITE & ASSIGN.                                    23580000
*                                                                       23600000
         B     *+4(R5)                                                  23620000
         B     EARWA2             READ.                                 23640000
*                                                                       23660000
*   WRITE AND ASSIGN.                                                   23680000
*                                                                       23700000
EARWA1   DS    0H                                                       23720000
         MVI   DISPLID(R6),ZERO     ZERO OUT BLOCK ID IN QMPA    Y02621 23726002
*              FOR WRITE OF SIOT                                 Y02621 23732002
         MVC   4(3,R6),SIOTDSKA   MOVE SIOT TTR TO QMPEX.               23740000
         MVC   SCT+SCTLSIOT-INSMSCT(MVTHREE),SIOTDSKA            Y02668 23746002
*                                  MOVE SIOT TTR TO SCT          Y02668 23752002
*                                                                       23760000
*   WRITE AND ASSIGN SIOT.                                              23780000
*                                                                       23800000
         BALR  RE,R3              LINK TO QMGR. W&A SIOT.               23820000
         SPACE                                                          23840000
         MVC   TNEXT(4),0(R6)     MOVE NEW TTR TO TNEXT.                23860000
         SPACE                                                          23880000
         TM    EASW1,EAPGMSDF     PGM = *.                              23900000
         BO    EARWA3             YES. RETURN.                          23920000
         MVC   4(4,R6),SCTPJFCB   JFCB TTR TO QMPEX.                    23940000
         MVI   DISPLID(R6),JFCBSID BLOCK ID TO REMOTE LIST       Y02621 23950002
         ST    R2,0(R6)           JFCB ADDR TO QMPCA.                   23960000
*                                                                       23980000
*   WRITE AND ASSIGN JFCB.                                              24000000
*                                                                       24020000
         BALR  RE,R3              LINK TO QMGR. W&A JFCB.               24040000
         SPACE                                                          24060000
         MVC   TNEXT+4(4),0(R6)   MOVE NEW TTR TO TNEXT+4.              24080000
         SPACE                                                          24100000
         B     EARWA3             GO TO RESTORE REGS & RETURN.          24120000
         SPACE                                                          24140000
*                                                                       24160000
*   READ.                                                               24180000
*                                                                       24200000
EARWA2   DS    0H                                                       24220000
         MVC   4(4,R6),EATTRSV    MOVE SIOT TTR TO QMPEX.               24240000
         MVI   QMPOP,QMREAD       SET QMPOP TO READ.                    24260000
*                                                                       24280000
*   READ SIOT.                                                          24300000
*                                                                       24320000
         BALR  RE,R3              LINK TO QMGR. READ SIOT.              24340000
         TM    EASW1,EAPGMSDF      IS THIS A PGM=*. REF ?       YA56859 24360002
         BZ    EARWA2A             NO  BYPASS SYSIN SYSOUT TEST YA56859 24370002
         TM    SCTSBYT3,EASYSOUT  IS THIS REFERENCE TO A SYSOUT DD. 394 24380000
         BO    EARWA4             YES. ERROR.                       394 24400000
         TM    SCTSBYT1,SCTSYSIN  IS THIS REFERENCE TO A SYSIN DD.  394 24420000
         BO    EARWA4             YES. ERROR.                       394 24440000
EARWA2A  DS    0H                                               YA56859 24450002
         MVC   EATEMP1(3),SIOTDSKA     MOVE SIOT TTR FOR PGM=*.         24460000
         MVC   EATTRSV(4),SCTPSIOT     MOVE TTR OF NEXT SIOT TO SAVE.   24480000
         MVC   SIOTDSKA(3),TSIOT  ASSIGN NEW TTR TO THIS SIOT.          24500000
         MVC   TSIOT(4),TNEXT     UPDATE POINTER TO NEXT SIOT           24520000
         MVC   SCTPSIOT(4),TNEXT       IN IWA & IN THIS SIOT.           24522001
         CLC   SCTDDNAM(8),EARWA50  IS THIS FIRST JOBCAT SIOT    Y01113 24530001
         BNE   EARWA20              IF NO, BYPASS SAVING TTR     Y01113 24532001
         MVC   EATEMP3(3),SIOTDSKA  SAV TTR OF 1ST JBCAT         Y01113 24534001
EARWA20  DS     0H                                               Y01113 24544001
         TM    EASW1,EAPGMSDF     PGM=*.                           AACA 24545017
         BO    EARWA22            YES. GO TO READ JFCB           Y02668 24550002
EARWA21  DS    0H                                                  AACA 24665017
         TM    SIOTALTD,SIOJCATS   IS THIS A JOBCAT SIOT         Y01113 24710001
         BZ    EARWA21A      NO,CHECK FOR FIRST STEP FOR JOBLIB YM01882 24712002
*        SETUP TO ENTER JOBCAT INTO REFERBACK DICTIONARY...     YM01882 24712102
         LA    R1,DICTDD        AREA TO BUILD DICT. ENTRY.      YM01882 24712202
         MVI   DICTLEN(R1),DENLEN  MOVE IN ENTRY LENGTH...      YM01882 24712302
         MVI   DICTID(R1),DDVERB  IDENTIFY ENTRY AS DD CARD.    YM01882 24712402
         MVC   DICTSIOT(E3,R1),SIOTDSKA  MOVE SIOT SVA TO ENTRY YM01882 24712502
         MVC   DICTJFCB(E3,R1),TNEXT+4  MOVE JFCB SVA TO ENTRY  YM01882 24712602
         MVC   DICTNAME(E6,R1),EARWA50  MOVE NAME TO ENTRY..    YM01882 24712702
         L     RF,EAINPUT    ADDRESS OF IEFVGI,DICTIONARY INSERTYM01882 24712802
         BALR  RE,RF         GO TO IEFVGI...                    YM01882 24712902
         B     EARWA22       CONTINUE PROCESSING..              YM01882 24713002
EARWA21A DS    0H                                               YM01882 24713102
         CLI   SCT+SCTSNUMB-INSMSCT,FRSTSTEP  THIS THE FIRST STEPY02113 24714002
         BE    EARWA5      POINT JOBLIB DICT. ENTRY TO NEW SIOT YM01882 24716002
         TM    EASW2,EAFRSTEP     CHECK FOR FIRST STEP OF A    @ZA07749 24716503
*                                 DEFERRED STEP RESTART        @ZA07749 24717303
         BO    EARWA6             PROCESS JOBLIB FOR 1ST STEP  @ZA12397 24718103
         OI    SCTSDISP,EASIPAS   TURN ON PASS INDICATOR-JOBLIB  Y02113 24720002
         NI    SCTSDISP,EASDISPC  CLEAR OTHER DISP SETTINGIN BYTEY02113 24722002
         OI    SCTSBYT2,SCTJOBLB  TURN ON JOBLIB INDICATOR       Y02113 24724002
         OI    SCTSBYT3,EASIOLD   TURN ON OLD INDICATOR-JOBLIB   Y02113 24726002
         NI    SCTSBYT3,EASBYTE3  CLEAR NEW,MOD SETTING IN FIELD Y02113 24728002
         NI    SCTSBYT2,VOLAFOFF     TURN VOL AFFINITY OFF     @ZA02726 24731003
         XC    SCTVOLCT(1),SCTVOLCT  ZERO VOL COUNT FIELD       YM00396 24734002
         MVC   SCTUTYPE(8),EABLANK   BLANK UNIT TYPE                010 24740000
EARWA22  DS    0H                                                  AACA 24750017
***************************************************************@ZA29589 24750203
**                                                             @ZA29589 24750403
**       IF VOL=REF=*.JOBLIB IS SPECIFIED ON A DD THAT IS      @ZA29589 24750603
**       CONCATENATED TO JOBLIB, WE MUST INSURE THAT THE SVA   @ZA29589 24750803
**       OF REFERED TO SIOT IS UPDATED TO POINT TO THE NEWLY   @ZA29589 24751003
**       CREATED JOBLIB SIOT.                                  @ZA29589 24751203
**                                                             @ZA29589 24751403
***************************************************************@ZA29589 24751603
         TM    SCTSBYT2,SCTJOBLB        JOBLIB?                @ZA29589 24751803
         BNO   EARWA22A                 NO,READ JFCB           @ZA29589 24752003
         TM    SCTSBYT1,SIOTCCAT        JOBLIB CONCATENATION?  @ZA29589 24752203
         BNO   EARWA22A                 NO,READ JFCB           @ZA29589 24752403
         TM    SCTSBYT3,SCTVREF         VOL=REF=*.JOBLIB ?     @ZA29589 24752603
         BNO   EARWA22A                 NO,READ JFCB           @ZA29589 24752703
**                                                                      24752803
***************************************************************@ZA29589 24753003
**                                                                      24753203
**       THERE ARE TWO INCORE BUFFERS FOR THE REFERBACK DICT-  @ZA29589 24753403
**       IONARY. THEY ARE POINTED TO BY SREFB AND DREFB. WHEN  @ZA29589 24753603
**       THE FIRST BUFFER IS FULL, IT IS WRITTEN OUT AND THE   @ZA29589 24753803
**       BUFFER SPACE POINTED TO BY SREFB WILL NOW BE USED TO  @ZA29589 24754003
**       CONTAIN THE THIRD SECTION OF THE DICTIONARY. SINCE    @ZA29589 24754203
**       THE JOBLIB DD ENTRY ALWAYS THE FIRST ENTRY IN THE     @ZA29589 24754403
**       FIRST SECTION OF THE DICTIONARY, WE MUST SEARCH THE   @ZA29589 24754603
**       DICTIONARY FOR THE JOBLIB ENTRY. WHEN THE SEARCH IS   @ZA29589 24754803
**       COMPLETE,DREFB WILL CONTAIN THE POINTER TO THE BUFFER @ZA29589 24755003
**                                                                      24755203
***************************************************************@ZA29589 24755403
**                                                                      24755603
         LA    R3,EARWA60+1             SET UP TO REREAD THE   @ZA29589 24755803
         L     RF,EASEARCH              REFERBACK DICTIONARY   @ZA29589 24756003
         BALR  RE,RF                    CALL VGS TO SEARCH     @ZA29589 24756503
         LA    R1,DREFB+E7              POINT TO JOBLIB SVA    @ZA29589 24757003
         MVC   SIOTVRSB(E3),DICTSIOT(R1) COPY JOBLIB SVA       @ZA29589 24757503
         L     R3,EAVHQ                 RELOAD QMGR INTERFACE  @ZA29589 24758003
EARWA22A DS    0H                                                       24758503
         MVC   4(4,R6),SCTPJFCB   MOVE JFCB TTR TO QMPEX.               24760000
         ST    R2,0(R6)           JFCB ADDRESS TO QMPCA.                24780000
         MVI   QMPOP,QMREAD       SET QMPOP TO READ.                    24800000
*                                                                       24820000
*   READ JFCB.                                                          24840000
*                                                                       24860000
         BALR  RE,R3              LINK TO QMGR. READ JFCB.              24880000
         TM    EASW1,EAPGMSDF     PGM=*.?                        Y02668 24886002
         BO    EARWA3             YES, GO TO RETURN              Y02668 24892002
         SPACE                                                          24900000
         MVC   SCTPJFCB(4),TNEXT+4     ASSIGN NEW TTR TO JFCB.          24920000
         SPACE                                                          24940000
*                                                                       25020000
*   RESTORE REGISTERS - RETURN.                                         25040000
*                                                                       25060000
EARWA3   DS    0H                                                       25080000
         LM    RE,R7,EAREGSV      RESTORE REGISTERS 14 - 7.             25100000
         SPACE                                                          25120000
         BR    RE                 RETURN.                               25140000
         SPACE                                                          25160000
*                                                                       25180000
*   INVALID REFERBACK TO A SYSOUT/SYSIN DD STATEMENT.               394 25200000
*                                                                       25220000
EARWA4   DS    0H                                                   394 25240000
         MVI   MSGSEC,EAR59       SET ERROR MESSAGE CODE.           394 25260000
         B     EAERRTN            GO TO CLEANUP.                    394 25280000
EARWA5   DS    0H                                                       25282002
         TM    SCTSBYT1,SIOTCCAT  CONCATENATION TO JOBLIB ?     YM07752 25282602
         BO    EARWA22       YES,BYPASS UPDATE OF SVA IN DICT.  YM07752 25283202
*        CHANGE  REFERBACK DICTIONARY FOR NEW JOBLIB SVAS       YM01882 25284002
         LA    R1,SREFB+E7   POINT TO INPUT  DISCTIONARY JOBLIB YM01882 25286002
         MVC   DICTSIOT(E3,R1),SIOTDSKA SIOT SVA TO ENTRY       YM01882 25288002
         MVC   DICTJFCB(E3,R1),TNEXT+E4   JFCB SVA TO DICT ENTRYYM01882 25290002
         B     EARWA22       CONTINUE WITH NORMAL PROCESS       YM01882 25292002
EARWA6   DS    0H                                              @ZA12397 25292103
*  THE FOLLOWING CODE WAS ADDED TO SUPPORT VOL REF TO DSNAME   @ZA15772 25292203
*  ON JOBLIB FOR DEFERRED RESTART                              @ZA15772 25292303
         TM    SCTSBYT3,SCTDSNRF  VOL REF TO DSNAME PRESENT    @ZA15772 25292403
         BZ    EARWA603           NO, CONTINUE                 @ZA15772 25293303
         TM    SCTSBYT1,SIOTCCAT  CONCATENATION TO JOBLIB      @ZA15772 25293603
         BZ    EARWA600           NO, READ 1ST STEP SCT        @ZA15772 25293903
         L     R5,SCT+SCTADSTB-INSMSCT  GET SVA OF DSNT        @ZA15772 25295603
         ST    R5,SWADSNT        SET TO READ IN DSNT IF NEEDED @ZA15772 25295703
         LTR   R5,R5              HAVE WE FOUND DSNT CHAIN YET?@ZA15772 25296003
         BNZ   EARWA601           YES, BYPASS READ OF SCT      @ZA15772 25296103
EARWA600 EQU   *                                               @ZA15772 25296203
*  READ IN 1ST STEP SCT TO FIND VALID DSNT CHAIN ADDR          @ZA15772 25296303
         MVC   E4(E4,R6),JCT+JCTSDKAD-INJMJCT  SVA OF 1ST SCT  @ZA15772 25296403
         ST    R2,E0(R6)          SET TO READ INTO JFCB SLOT   @ZA15772 25296503
         MVI   QMPOP,QMREAD       SET SWA PARM TO READ         @ZA15772 25296603
         BALR  RE,R3              GO TO VHQ TO READ IN 1ST SCT @ZA15772 25296703
         XC    TWORK(E8),TWORK    CLEAR TEMPORARY WORK AREA    @ZA15772 25296803
*  THIS CODE MOVES HEAD OF DSNT CHAIN FROM 1ST STEP SCT TO     @ZA15772 25296903
*  CURRENT STEP SCT (1ST STEP OF DEFERRED RESTART)             @ZA15772 25297003
         MVC   SCT+SCTADSTB-INSMSCT(E4),JFCB+SCTADSTB-INSMSCT  DSNT SVA 25297603
*                                  TO CURRENT SCT              @ZA15772 25299603
         MVC   SWADSNT(E4),JFCB+SCTADSTB-INSMSCT  SAVE DSNT SVA@ZA15772 25301603
EARWA601 EQU   *                  ENTER FOR JOBLIB CONCAT. AND @ZA15772 25303603
         LA    R5,DSNAME                                       @ZA15772 25311303
         USING DSNTABLE,R5                                     @ZA15772 25311403
         OI    SWC,DSNTQ          TELL VHH TO WRITE LAST DSNT  @ZA15772 25311503
*                                                              @ZA15772 25311703
*  LOOP TO READ IN LAST DSNT FOR JOBLIB.  THERE MAY BE ADDED   @ZA15772 25311803
*  VOL REFS TO DSNAME IN NON-JOBLIB DDS IN RESTART STEP TO BE  @ZA15772 25311903
*  ADDED TO LAST DSNT.                                         @ZA15772 25312003
*                                                              @ZA15772 25312103
         LH    R0,SIOVDSNT        GET OFFSET TO DSNT ENTRY     @ZA15772 25312203
         SRDA  R0,32              SET UP TO DIVIDE BY 168      @ZA15772 25314203
         D     R0,DSNTLEN                                      @ZA15772 25314303
*  R1=QUOTIENT.  NUMBER BLOCKS, MINUS 1, FOR CURRENT ENTRY     @ZA15772 25314403
*  R0=REMAINDER. THIS IS OFFSET TO CURRENT DSNAME ENTRY.       @ZA15772 25314503
         LA    R1,E1(R1)          INCREMENT READ COUNT         @ZA15772 25314803
         STH   R1,DSNCOUNT        SAVE COUNT OF DSNTS TO READ  @ZA15772 25314903
         SR    R1,R1              CLEAR REG FOR LOOP CONTROL   @ZA15772 25315003
EARWA602 EQU   *                                               @ZA15772 25315103
         MVC   E4(E4,R6),SWADSNT  DSNT SVA INTO EXT PARM       @ZA15772 25315203
         ST    R5,E0(R6)          READ INTO DSNT BUFFER        @ZA15772 25315303
         MVI   QMPOP,QMREAD       SET TO READ                  @ZA15772 25315403
         BALR  RE,R3              GO TO VHQ TO READ IN DSNT    @ZA15772 25315503
         MVC   SWADSNT(E4),DSNTNSVA    SAVE ADDR NEXT DSNT     @ZA15772 25315603
         LA    R1,E1(R1)          INCREMENT COUNT OF BLOCKS    @ZA15772 25315803
         CH    R1,DSNCOUNT        HAS CORRECT BLOCK BEEN READ? @ZA15772 25315903
         BL    EARWA602           NO, GO READ NEXT ONE         @ZA15772 25316003
         SR    R1,R1              CLEAR REG                    @ZA15772 25316103
         IC    R1,SIOVDSNL        GET LENGTH DSN IN VOL REF    @ZA15772 25316203
         AH    R1,SIOVDSNT        ADD OFFSET TO DSN ENTRY      @ZA15772 25316303
         ST    R1,SCT+SCTLDSTB-INSMSCT  UPDATE DSNT REL LENGTH @ZA15772 25316403
EARWA603 EQU   *                  NON VOL REF ON JOBLIB ENTRY  @ZA15772 25316503
         XR    RF,RF               ZERO REG                    @ZA12397 25316603
         CL    RF,TSREFB           HAS 1ST DICT BEEN WRITTEN   @ZA12397 25316703
*                                  OUT TO SWA?                 @ZA12397 25316803
         BE    EARWA5              NO, 1ST DICT IN INPUT BUFFER@ZA12397 25316903
         TM    SCTSBYT1,SIOTCCAT   CONCATENATION TO JOBLIB?    @ZA12397 25317003
         BO    EARWA22             YES, BYPASS UPDATE OF SVA   @ZA12397 25317103
         LA    R3,EARWA60+1        POINT TO LENGTH BYTE        @ZA12397 25317203
         L     RF,EASEARCH         LOAD VGS VCON               @ZA12397 25317303
         BALR  RE,RF               GO TO SEARCH FOR JOBLIB     @ZA12397 25317403
         LA    R1,DREFB+E7         POINT TO SEARCH DICT. JOBLIB@ZA12397 25317503
         MVC   DICTSIOT(E3,R1),SIOTDSKA SIOT SVA TO ENTRY      @ZA12397 25317603
         MVC   DICTJFCB(E3,R1),TNEXT+E4 JFCB SVA TO ENTRY      @ZA12397 25317703
         LA    R1,DREFB            POINT TO BEGINNING OF DICT. @ZA12397 25317803
         ST    R1,E0(R6)           ADDR TO REMOTE PARM LIST    @ZA16392 25317903
         MVI   QPARM+QMPOP-QMNAM,QMWRTE INDICATE WRITE         @ZA12397 25318103
         MVC   E4(E3,R6),TSREFB   REWRITING FIRST DICT.        @ZA16392 25318203
         MVI   E7(R6),DICTRYID    INDICATE ID FOR DICTIONARY   @ZA16392 25318303
         L     R3,EAVHQ           LOAD VHQ VCON                @ZA12397 25318403
         BALR  RE,R3              LINK TO VHQ TO WRITE BACK    @ZA12397 25318503
*                                 UPDATED DICTIONARY           @ZA12397 25318603
         B     EARWA22            CONTINUE WITH NORMAL PROCESS @ZA12397 25318703
         DROP  R2                                                       25318803
         DROP  R4                                                       25318903
         DROP  R7                                                       25319003
EARWA50  DS    0H                                                Y01113 25319103
         DC    CL8'JOBCAT  '       FOR COMPARE WITH SIOT DDNAME  Y01113 25319203
EARWA60  DC    FL1'1'              ONE SEARCH ARGUMENT         @ZA12397 25319303
         DC    FL1'6'              LENGTH OF 6                 @ZA12397 25319403
         DC    CL6'JOBLIB'         SEARCH ARGUMENT = JOBLIB    @ZA12397 25319503
         EJECT                                                          25319803
*********************************************************************** 25320000
*                                                                     * 25340000
*              O'RIDE TABLES HANDLING.                                * 25360000
*                                                                     * 25380000
*********************************************************************** 25400000
EAORIDE  DS    0H                                                       25420000
         SPACE                                                          25440000
         STM   RE,R7,EAREGSV      SAVE REGISTERS 14THRU 7.              25460000
         ST    RB,TPDTP           INITIALIZE TO START AT PDT TOP.       25480000
         SPACE                                                          25500000
         TM    EASW1,EAPGMSDF+EAPGMEF  IS THIS AN EXEC PGM STATEMENT.   25520000
         BM    EAPGM10            YES. ERROR.                           25540000
         SPACE                                                          25560000
         CLI   0(R3),X'08'        DOES PROCSTEP EXCEED 8 BYTES.         25580000
         BH    EAORIDE4           YES -ERROR-.                          25600000
         LTR   R2,R2               DOES PROCSTEP NAME FOLLOW      18053 25606017
         BNE   EAORIDE8            THE OVERRIDE.  YES             18053 25612017
         MVI   MSGSEC,EAR60        PROCSTEP NAME LENGTH IS ZERO   180   25618001
         B     EAERRTN             SET POSITIONAL PARAM MISSING         25622001
*                                                                       25624017
EAORIDE8 DS    0H                                                 18053 25630017
         LA    R7,EAORTABL        ORIDE TABLE ADDRESS.                  25640000
         USING ORTABLE,R7                                               25660000
*                                                                       25680000
*   SET UP QMANAGER PARAMETER AREA.                                     25700000
*                                                                       25720000
         LA    R6,QPARM           QMANAGER PARAMETER                    25740000
         USING IOPARAMS,R6             LIST ADDRESSING.                 25760000
         L     R5,QMPCL           QMPCA ADDRESS TO R5.                  25780000
         SPACE                                                          25800000
*                                                                       25820000
*   INITIALIZE WORK SPACE AND SET R4 = PDT O'RIDE SLOT.                 25840000
*                                                                       25860000
         BCTR  R4,0               POINT TO O'RIDE FLAG FOR THIS KEY.    25880000
         SPACE                                                          25900000
         L     RF,EAVHQ           SET RF TO IEFVHQ ADDRESS              25920000
         MVC   EAPRSV(8),EABLANK  BLANK OUT PROCSTEP TEMP SAVE.         25940000
         BCTR  R2,0                                                     25960000
         EX    R2,EAORIDMV        MOVE PROCSTEP TO TEMP SAVE.           25980000
         SPACE                                                          26000000
*                                                                       26020000
*   CHECK FOR FIRST ENTRY INTO O'RIDE TABLE.                            26040000
*                                                                       26060000
         CLI   ORNMNXST,X'00'     STEPNAME IN O'RIDE TABLE EQUAL ZERO.  26080000
         BE    EAORIDE2           YES. GO TO INITIALIZE TABLE.          26100000
*                                                                       26120000
*   CHECK FOR MATCHING STEPNAMES.                                       26140000
*                                                                       26160000
         CLC   ORNMNXST(8),EAPRSV IS STEP TO BE O'RIDDEN SAME AS STEP   26180000
*                                      ALREADY ENTERED IN O'RIDE TABLE. 26200000
         BE    EAORIDE3           YES. GO TO CHECK FOR DUPLICATE KEYS.  26220000
*                                                                       26240000
*   NEW STEPNAME - PUT OUT PREVIOUS OVERRIDE TABLE.                     26260000
*                                                                       26280000
         MVC   ORNMNXST(8),EAPRSV PUT THIS STEPNAME INTO O'RIDE TABLE   26300000
*                                      SLOT 'NEXT STEP TO BE O'RIDDEN'. 26320000
         MVC   ORCHAIN(3),TNEXT   MOVE TNEXT TO CHAIN TTR.              26340000
         ST    R7,0(R5)           O'RIDE TABLE ADDRESS TO QMPCA.        26360000
         MVC   4(3,R5),ORTTR      O'RIDE TABLE TTR TO QMPEX.            26380000
         MVI   DISPLID(R5),PROCORID    BLOCK ID TO REMOTE LIST   Y02621 26390002
*                                                                       26400000
*   LINK TO IEFVHQ TO WRITE & ASSIGN PREVIOUS O'RIDE TABLE.             26420000
*                                                                       26440000
         BALR  RE,RF              LINK TO QMANAGER INTERFACE MODULE.    26460000
         SPACE                                                          26480000
         MVC   TNEXT(4),0(R5)     UPDATE TNEXT.                         26500000
*                                                                       26520000
*   MOVE O'RIDE CHAIN TTR TO BE TTR OF NEW O'RIDE TABLE, ZERO REST OF   26540000
*        O'RIDE TABLE AND PUT IN NEW STEPNAME.                          26560000
*                                                                       26580000
         MVC   ORTTR(3),ORCHAIN   MOVE CHAIN TTR TO THIS TTR.           26600000
         XC    ORCHAIN(ORTABEND-ORCHAIN),ORCHAIN ZERO REST OF TABLE.    26620000
         MVC   ORNMNXST(8),EAPRSV MOVE STEPNAME TO O'RIDE TABLE.        26640000
         MVI   EAPRSVF,X'00'      CLEAR DUPLICATE FLAG SW.          303 26660000
         MVI   EAPRSVF2,0          CLEAR DUPLIC FLAG BYTE 2.    YM00368 26670002
*                                                                       26680000
*   SET OVERRIDE FLAG IN TABLE, RESTORE REGS & RETURN.                  26700000
*                                                                       26720000
EAORIDE1 DS    0H                                                       26740000
         TM    SWG,ORFLG2SW       NEW O'RIDE KEYWORD?            Y02668 26742002
         BZ    EAORID1A           NO, CONTINUE PROCESSING        Y02668 26744002
         NI    SWG,FF-ORFLG2SW    TURN NEW O'RIDE FLAG OFF       Y02668 26746002
         OC    ORFLAGS2(1),0(R4)  SET UP O'RIDE FLAG FOR KEY     Y02668 26748002
         OC    EAPRSVF2(1),ORFLAGS2 SET UP BYTE 2 DUPLIC CHECK. YM00368 26750002
         B     EAORID2A           GO TO RETURN                   Y02668 26752002
EAORID1A DS    0H                                                Y02668 26754002
         OC    ORFLAGS(1),0(R4)   SET O'RIDE FLAGS FOR THIS KEY.        26760000
         OC    EAPRSVF(1),ORFLAGS SET UP DUPLICATE CHECK.           303 26780000
EAORID2A DS    0H                                                Y02668 26790002
         LM    RE,R7,EAREGSV      RESTORE REGISTERS.                    26800000
         BR    RE                 RETURN.                               26820000
         SPACE                                                          26840000
*                                                                       26860000
*   FIRST ENTRY INTO O'RIDE TABLE. MOVE STEPNAME TO O'RIDE TABLE AND    26880000
*        TO ORIDSNM IN IWA.  ASSIGN A TTR TO THE O'RIDE TABLE AND SAVE  26900000
*        IT IN TPROC OF THE IWA.  SET POVRX IN IWA.  SET O'RIDE ID.     26920000
*                                                                       26940000
EAORIDE2 DS    0H                                                       26960000
         XC    ORTABLE(176),ORTABLE    BE SURE O'RIDE TABLE SLOT CLEAR. 26980000
         MVI   QMPOP,QMASGN       SET QMPOP TO ASSIGN TTR.              27000000
         SPACE                                                          27020000
         BALR  RE,RF              LINK TO QMANAGER INTERFACE (IEFVHQ).  27040000
         SPACE                                                          27060000
         MVC   TPROC(4),0(R5)     MOVE TTR TO IWA.                      27080000
         MVC   ORTTR(3),0(R5)     MOVE TTR TO O'RIDE TABLE.             27100000
         MVI   ORID,ORIDFLAG      SET PROCEDURE O'RIDE TABLE ID.        27120000
         MVC   ORNMNXST(8),EAPRSV MOVE STEPNAME TO O'RIDE TABLE.        27140000
         MVC   ORIDSNM(8),EAPRSV  MOVE STEPNAME TO IWA.                 27160000
         OI    SWE,POVRX          SET O'RIDE PROC EXEC STMT SW IN IWA.  27180000
         B     EAORIDE1           GO TO SET O'RIDE FLAG &RETURN.        27200000
*                                                                       27220000
*   STEPNAME = STEPNAME IN O'RIDE TABLE-CHECK FOR DUPLICATE USE OF      27240000
*        KEYWORDS.                                                      27260000
*                                                                       27280000
EAORIDE3 DS    0H                                                       27300000
         CLI   MSGKEY,ORBYT2KY     ORIDE FLAG FOR THIS KEYWD    YM00368*27320002
                                   IN FLAG BYTE 2?              YM00368 27322002
         BH    EAORID3A            BRANCH NO.                   YM00368 27324002
         NC    EAPRSVF2(1),0(R4)   CHECK FOR DUPLIC ORIDE IN    YM00368*27326002
                                   FLAG BYTE 2.                 YM00368 27328002
         BC    8,EAORIDE1          NO DUP, BRANCH TO EXIT.      YM00368 27330002
         B     EAORID3G            YES DUP, BR TO ISSUE ERR MSG.YM00368 27332002
EAORID3A DS    0H                                               YM00368 27334002
         NC    EAPRSVF(1),0(R4)   CHECK FOR DUPLICATE OVERRIDE.     303 27340000
         BC    8,EAORIDE1         NO. - OK. GO TO RESTORE REGS &EXIT.   27360000
*                                                                       27380000
*   ERROR -DUPLICATE USE OF KEYWORD-                                    27400000
*                                                                       27420000
EAORID3G DS    0H                                               YM00368 27430002
         MVI   MSGSEC,EAR53       SET ERROR MSG NBR.                    27440000
         B     EACLEANP           GO TO CLEANUP ROUTINE.                27460000
         SPACE                                                          27480000
*                                                                       27500000
*   ERROR -PROCSTEP EXCEEDS EIGHT CHARACTERS-                           27520000
*                                                                       27540000
EAORIDE4 DS    0H                                                       27560000
         MVI   MSGSEC,EAR55       SET ERROR MSG NBR.                    27580000
         B     EACLEANP           GO TO CLEANUP ROUTINE.                27600000
         SPACE 2                                                        27620000
EAORIDMV MVC   EAPRSV(1),1(R3)    MOVE PROCSTEP TO TEMP SAVE.(EXECUTED) 27640000
         EJECT                                                          27641017
*******************************************************************AACA 27642017
*                                                                 *AACA 27643017
*              CHECKPOINT/RESTART SCT/SMB CHAINING SUBROUTINE.    *AACA 27644017
*                                                                 *AACA 27645017
*******************************************************************AACA 27646017
EARSTSUB DS    0H                                                  AACA 27647017
         STM   RE,R7,EAREGSV      SAVE REGISTERS 14 THRU 7.        AACA 27648017
         SPACE                                                          27649017
         L     R5,QPARM+QMPCL-IOPARAMS  REMOTE LIST ADDRESS        AACA 27650017
         LA    R6,EAAUXWK         SPACE FOR C/R SCT.               AACA 27651017
         ST    R6,0(R5)           ADDR TO REMOTE LIST              AACA 27652017
         MVC   4(3,R5),JCT+JCTSSTR-INJMJCT C/R SCT TTR             AACA 27653017
         MVI   7(R5),X'00'        JUST TO BE SURE LAST BYTE ZERO   AACA 27654017
         MVI   QPARM+QMPOP-IOPARAMS,QMREAD  SET TO READ.           AACA 27655017
         L     R7,EAVHQ           ADDR OF QMNGR INTERFACE -IEFVHQ  AACA 27656017
         SPACE                                                          27657017
         BALR  RE,R7              LINK TO QMNGR - READ IN C/R SCT  AACA 27658017
         SPACE                                                          27659017
         MVC   EAAUXWK+SCTANSCT-INSMSCT(MVTHREE),SCT+SCTDISKA-INSMSCT   27659619
*                                      CHAIN R/I C/R SCT          O106  27660219
*                                                   TO THIS STEP.  AACA 27661017
         SPACE                                                          27665017
         MVI   QPARM+QMPOP-IOPARAMS,QMWRTE  SET TO WRITE C/R SCT.  AACA 27666017
         SPACE                                                          27667017
         BALR  RE,R7              LINK TO QMNGR - WRITE C/R SCT.   AACA 27668017
         SPACE                                                          27669017
         LM    RE,R7,EAREGSV      RESTORE REGS.                    AACA 27670017
         BR    RE                 RETURN.                          AACA 27671017
         EJECT                                                          27672017
*******************************************************************AACA 27673017
**                                                                   ** 27700000
**             CLEANUP PORTION OF EXECUTE ROUTINE.                   ** 27720000
**                                                                   ** 27740000
*********************************************************************** 27760000
EAERRTN0 DS    0H                                                       27780000
         MVI   MSGKEY,X'00'       CLEAR SECONDARY MESSAGE SLOT.         27800000
EACLEANP DS    0H                                                       27820000
EAERRTN  EQU   *                                                        27840000
         LA    R7,JCT             JCT ADDRESSING.                       27860000
         USING EAJCT,R7                                                 27880000
         SPACE                                                          27900000
         LA    R4,EAORTABL        O'RIDE TABLE ADDRESS TO R4.           27920000
         USING ORTABLE,R4                                               27940000
         SPACE                                                          27960000
         LA    R6,QPARM           Q-MANAGER PARAMETER                   27980000
         USING IOPARAMS,R6             AREA ADDRESSING.                 28000000
         L     R5,QMPCL           QMPCA ADDRESS TO R5.                  28020000
         ST    R4,0(R5)           O'RIDE TABLE ADDRESS TO QMPCA.        28040000
         SPACE                                                          28060000
         CLI   MSGSEC,X'00'       HAS AN ERROR OCCURRED.                28080000
         BNE   EAERRTNA           YES. GO TO FAIL JOB AND PUT OUT MSG.  28100000
EAERRTN1 DS    0H                                               YM00382 28110002
*                                                                       28120000
*   NO ERRORS.  CHECK FOR POVRX ON AND O'RIDES FOR THIS STEP.           28140000
*                                                                       28160000
         TM    SWE,POVRX          O'RIDE PROC EXEC STMT.                28180000
         BZ    EAEXIT             NO.  EXIT TO IEFVHF.                  28200000
*                                                                       28220000
*        POVRX ON - ARE THERE OVERRIDES.                                28240000
*                                                                       28260000
         TM    SWE,PROC            STATEMENT FROM A PROC?        Y02668 28266002
         BZ    EACL1              NO-CANNOT BE OVERRIDDEN         17163 28272016
         CLC   ORIDSNM(8),EASNSV  IS THERE AN OVERRIDE TABLE FOR STEP.  28280000
         BNE   EACL1               NO. DO NOT READ IN POT       YM08035 28300002
         CLC   TPROC(3),EAENDOR    IS POT PTR ZERO ?            YM08035 28310002
         BNE   EACL4               NO. GO TO READ IN POT        YM08035 28320002
*                                                                       28340000
*   NO O'RIDES - CHECK FOR PRIME PROC BUFF & PUT OUT LAST O'RIDE TABLE. 28360000
*                                                                       28380000
EACL1    DS    0H                                                       28400000
         TM    SWE,PRCV            STATEMENT INVOKE A PROC?      Y02668 28420002
         BZ    EAEXIT              BR NO, NO O'RIDE TABLE BUILT. Y02668 28450002
*                                                                       28480000
*   PUT OUT LAST O'RIDE TABLE.                                          28500000
*                                                                       28520000
EACL2    DS    0H                                                       28540000
         TM    JCTJSTAT,INCMSTS   CHECK FOR JOB FAILED.                 28560000
         BZ    EACL3              JOB OK - GO TO PUT OUT TABLE.         28580000
*        FAILED JOB - ZERO O'RIDE FLAGS.                                28600000
         MVI   ORFLAGS,X'00'      ZERO O'RIDE FLAGS.                    28620000
         MVI   ORFLAGS2,X'00'     ZERO NEW O'RIDE FLAGS         YM00368 28630002
         SPACE                                                          28640000
*        Q-MANAGER LINK.                                                28660000
EACL3    DS    0H                                                       28680000
         MVC   4(3,R5),ORTTR      TTR TO QMPEX.                         28700000
         MVI   DISPLID(R5),PROCORID    BLOCK ID TO REMOTE LIST   Y02621 28710002
         MVI   QMPOP,QMWRTE       SET QMPOP FOR WRITE ONLY.             28720000
         SPACE                                                          28740000
         L     RF,EAVHQ           IEFVHQ ADDRESS.                       28760000
         BALR  RE,RF              LINK TO Q-MANAGER INTERFACE.          28780000
         B     EAEXIT             GO TO EXIT.                           28800000
*                                                                       28820000
*   O'RIDE TABLE IN AND MOVE PARAMETERS TO SCT.                         28840000
*                                                                       28860000
EACL4    DS    0H                                                       28880000
         SPACE                                                          28900000
         MVC   4(3,R5),TPROC      MOVE TTR OF PROC O'RIDE TABLE TO      28920000
*                                      Q-MANAGER PARAM AREA (QMPEX).    28940000
         MVI   QMPOP,QMREAD       INDICATE READ.                        28960000
         SPACE                                                          28980000
         L     RF,EAVHQ           IEFVHQ ADDRESS.                       29000000
         BALR  RE,RF              LINK TO IEFVHQ (Q-MNGR INTERFACE).    29020000
         SPACE                                                          29040000
         MVC   TPROC(3),ORCHAIN   MOVE TTR OF NEXT O'RIDE TABLE TO IWA. 29060000
         MVC   ORIDSNM(8),ORNMNXST     MOVE NAME OF NEXT STEP TO IWA.   29080000
         SPACE                                                          29100000
*                                                                       29120000
*   CHECK FOR COND OVERRIDES.                                           29140000
*                                                                       29160000
         TM    ORFLAGS,EACONDOR   ARE THERE COND O'RIDES.               29180000
         BZ    EACL5              NO. GO TO CHECK FOR PARM O'RIDES.     29200000
         SPACE                                                          29220000
         MVI   MSGKEY,CONDPEK     YES. SET SECONDARY MSG NBR.           29240000
         XC    SCT+SCTSDPCD-INSMSCT(MV48),SCT+SCTSDPCD-INSMSCT    O106  29260019
*                                      ZERO OUT SCT DEPENDENCIES  O106  29280019
         LA    R3,SCT+SCTSDPCD-INSMSCT SCT STORE LOCATION         O106  29300019
         LA    R2,ORCONDCD        O'RIDE TABLE PICK UP ADDRESS.         29320000
*                                                                  HW16 29322016
*   EVEN OR ONLY TO EIGHTH COND SLOT IN SCT                        HW16 29324016
*                                                                  HW16 29326016
         MVC   42(1,R3),84(R2)     MOVE SCTABCND BYTE,             HW16 29328016
*                                  WHETHER SPECIFIED OR NOT        HW16 29330016
*                                                                  HW16 29332016
         SPACE                                                          29340000
EACL4A   DS    0H                                                       29360000
         CLI   2(R2),X'00'        HAVE WE FINISHED ALL CONDS.           29380000
         BE    EACL5              YES. GO TO CHECK FOR PARM O'RIDES.    29400000
         SPACE                                                          29420000
         CLI   11(R2),X'00'       IS LENGTH ZERO/SCT TTR RESOLVED.      29440000
         BNE   EACL4C             NO. GO TO SEARCH DICT FOR SCT TTR.    29460000
*                                                                       29480000
*   SCT TTR RESOLVED - MOVE O'RIDE COND FIELD TO SCT.                   29500000
*                                                                       29520000
EACL4B   DS    0H                                                       29540000
         SPACE                                                          29560000
         MVC   0(6,R3),0(R2)      MOVE O'RIDE COND FIELD TO SCT.        29580000
         SPACE                                                          29600000
         LA    R2,12(R2)          POINT R2 AT NEXT O'RIDE COND FIELD.   29620000
         LA    R3,6(R3)           POINT R3 AT NEXT SCT COND FIELD.      29640000
         B     EACL4A             GO TO CHECK FOR MORE COND FIELDS.     29660000
*                                                                       29680000
*   SEARCH DICTIONARY TO RESOLVE SCT TTR.                               29700000
*                                                                       29720000
EACL4C   DS    0H                                                       29740000
         SPACE                                                          29760000
         SR    R1,R1                                                    29780000
         IC    R1,ORSTEPL         *    SET UP NAME OF PROCEDURE FOR     29800000
         EX    R1,EACLMV1         *         SEARCH. LENGTH+STEPNAME.    29820000
         SPACE                                                          29840000
         LA    RE,EAREGSV+2(R1)   POINT AT NEXT STORE BYTE.             29860000
*                                                                       29880000
*   CHECK FOR CONDITIONAL SEARCH ON PROCEDURE STEPNAME.                 29900000
*                                                                       29920000
         IC    R1,11(R2)          PICK UP PROCSTEP LENGTH BYTE.         29940000
         STC   R1,EATEMP2         PUT COPY OF LENGTH IN TEMP FOR TEST.  29960000
         NI    EATEMP2,X'80'      CHECK FOR HIGH ORDER BIT ON.          29980000
         BC    8,EACL4D           NO. GO TO SET UP UNCONDITIONAL SEARCH 30000000
*                                                                       30020000
*   CONDITIONAL SEARCH ON (STEPNAME).PROCSTEP - PROCSTEP MAY BE OUTSIDE 30040000
*        THE PROCEDURE NAMED BY (STEPNAME).  THIS IS USED SO THAT A     30060000
*        REFERENCE CAN BE MADE TO A STEP OF A PROCEDURE WITHOUT         30080000
*        NAMING THE PROCEDURE.                                          30100000
*                                                                       30120000
         STC   R1,EATEMP2         COPY OF LENGTH TO TEMP TO TURN OFF    30140000
         NI    EATEMP2,X'7F'           HIGH ORDER BIT.                  30160000
         IC    R1,EATEMP2         PICK UP LENGTH ONLY.                  30180000
         OI    SRCHSW1,SRCHF1     INDICATE CONDITIONAL SEARCH.          30200000
         B     EACL4E             GO TO SEARCH.                         30220000
*                                                                       30240000
*   UNCONDITIONAL SEARCH ON STEPNAME.PROCSTEP.                          30260000
*                                                                       30280000
EACL4D   DS    0H                                                       30300000
*                                                                       30320000
*   SET UP REGS AND LINK TO SEARCH DICTIONARY FOR SCT TTR.              30340000
*                                                                       30360000
EACL4E   DS    0H                                                       30380000
         EX    R1,EACLMV2         MOVE PROCSTEP TO SEARCH SETUP.        30400000
         STC   R1,0(RE)           PUT IN PROCSTEP LENGTH.               30420000
         ST    R3,EATEMP1         SAVE R3.                              30440000
         LA    R3,EAREGSV+1       POINT R3 AT STEPNAME.PROCSTEP.        30460000
         MVI   EAREGSV,X'02'      INDICATE NBR PARAMETERS.              30480000
         OI    SRCHSW1,SRCHF2     INDICATE SEARCH FOR SCT.              30500000
         SPACE                                                          30520000
         L     RF,EASEARCH        LINK TO SEARCH.                       30540000
         BALR  RE,RF                                                    30560000
         SPACE                                                          30580000
         MVC   3(3,R2),2(R1)      MOVE TTR FROM DICT TO O'RIDE.         30600000
         L     R3,EATEMP1         RESTORE R3.                           30620000
         B     EACL4B             GO TO MOVE O'RIDE ENTRY TO SCT.       30640000
         SPACE 2                                                        30660000
EACLMV1  MVC   EAREGSV+1(1),ORSTEPL                                     30680000
EACLMV2  MVC   1(1,RE),3(R2)                                            30700000
         SPACE 2                                                        30720000
*                                                                       30740000
*   PARM O'RIDE CHECK.                                                  30760000
*                                                                       30780000
EACL5    DS    0H                                                       30800000
         TM    ORFLAGS,EAPARMOR   ARE THERE PARM O'RIDES.               30820000
         BZ    EACL6              NO. GO TO CHECK FOR TIME O'RIDES.     30840000
         SPACE                                                          30860000
         MVC   SCT+SCTXBTTR-INSMSCT(MVTHREE),ORPARM               O106  30870019
*                                      MOVE PARM ORIDES TTRO TO SCTO106 30880019
         MVC   SCT+SCTSEXEC-INSMSCT(MVTWO),ORPARMSZ               O106  30890019
*                                      MOVE PARM SIZE TO SCT      O106  30900019
         SPACE                                                          30920000
*                                                                       30940000
*   TIME O'RIDE CHECK.                                                  30960000
*                                                                       30980000
EACL6    DS    0H                                                       31000000
         TM    ORFLAGS,EATIMEOR   ARE THERE TIME O'RIDES.               31020000
         BZ    EACL7              NO. GO TO CHECK FOR ACT O'RIDES.      31040000
         SPACE                                                          31060000
         MVC   SCT+SCTSTIME-INSMSCT(MVTHREE),ORMAXTIM             O106  31070019
*                                      MOVE TIME O'RIDES TO SCT   O106  31080019
         SPACE                                                          31100000
*                                                                       31120000
*   ACT O'RIDES CHECK.                                                  31140000
*                                                                       31160000
EACL7    DS    0H                                                       31180000
         TM    ORFLAGS,EAACCTOR   ARE THERE ACT O'RIDES.                31200000
         BZ    EACL8              NO. GO TO CHECK REGION O'RIDES.       31220000
         SPACE                                                          31240000
         MVC   SCT+SCTAFACT-INSMSCT(MVTHREE),ORACTTTR             O106  31250019
*                                      MOVE ACT TTR TO SCT        O106  31260019
         SPACE                                                          31280000
*                                                                       31300000
*   REGION O'RIDES CHECK.                                               31320000
*                                                                       31340000
EACL8    DS    0H                                                       31360000
         TM    ORFLAGS,EAREGOR    IS THERE A REGION O'RIDE.             31380000
         BZ    EACL9              NO. GO TO CHECK FOR ADDRSPC O'RIDES.  31400001
         SPACE                                                          31420000
         MVC   SCT+SCTMSSZE-INSMSCT(E2),ORREG                    Y02668 31427002
*                                 MOVE REGION PARM TO SCT    O106       31434001
         OI    EASW2,EAREGION     INDICATE REGION ON EXEC STMT.         31443014
         SPACE                                                          31446014
*                                                                       31449014
*   ADDRSPC O'RIDES CHECK.                                              31452001
*                                                                       31455014
EACL9    DS    0H                                                       31458014
         TM    ORFLAGS,EAADDROR   IS THERE  ADDRSPC O'RIDE?.     Y01029 31461001
         BZ    EACL10             NO. GO TO CHECK RD O'RIDES       AACA 31464017
         NI    SCT+SCTSSTAT-INSMSCT,FF-EAADDRBT                  Y01029 31465001
*                                 CLEAR SCTSSTAT                 Y01029 31466001
         OC    SCT+SCTSSTAT-INSMSCT(OC1),ORADDR                  Y01029 31467001
*                                 SET  ADDRSPC O'RIDE FLAGS             31468001
         OI    EASW2,EAADDR       SET ADDRSPC ON EXEC STMT FLAG. Y01029 31473001
*                                                                  AACA 31476017
*   RD O'RIDES CHECK                                               AACA 31479017
*                                                                  AACA 31482017
EACL10   DS    0H                                                  AACA 31485017
         TM    ORFLAGS,EARDOR     IS THERE A RD O'RIDE             AACA 31488017
         BZ    EACL11             NO. CONTINUE                     AACA 31491017
         NI    SCT+SCTSSTAT-INSMSCT,CLFLAGS   CLEAR RD FLAGS      O106  31493019
         OC    SCT+SCTSSTAT-INSMSCT(OC1),ORRD SET RD O'RIDE FLAGS O106  31495019
*                                                                  I241 31498018
*   SDP O'RIDES CHECK                                              I241 31500018
EACL11   DS    0H                                                  I241 31502018
         TM    ORFLAGS,EASDPOR     IS THERE AN SDP O'RIDE          I241 31504018
         BZ    EACL12              NO, CONTINUE                    I241 31506018
         NI    SCT+SCTSDP-INSMSCT,ZERSDP  ZERO SDP FIELD          O106  31507019
         OC    SCT+SCTSDP-INSMSCT(OC1),ORSDP  MOVE IN O'RIDES     O106  31508019
         MVC   SCT+SCTSDP-INSMSCT+DISPLONE(MVONE),ORSDP+DISPLONE  O106  31509019
*                                      MOVE IN O'RIDES            O106  31510019
*                                                                Y02655 31510102
*    PERFORM O'RIDES CHECK                                       Y02655 31510202
EACL12   DS    0H                                                Y02655 31510502
         TM    ORFLAGS2,EAPRFMOR IS THERE PERFORM O'RIDE         Y02655 31511002
         BZ    EACL13             NO CONTINUE                    Y02655 31511502
         MVC   SCT+SCTPRFMF-INSMSCT(MVONE),ORPRMVAL              Y02655 31512002
*                                 MOVE IN O'RIDE                 Y02655 31512502
*                                                                Y02670 31513002
*    DYNAMNBR O'RIDES CHECK                                      Y02670 31513802
EACL13   DS    0H                                                Y02670 31514602
         TM    ORFLAGS2,EADYNMOR  IS THERE DYNAMNBR O'RIDE       Y02670 31515402
         BZ    EACL14             NO, CONTINUE                   Y02670 31516202
         MVC   SCT+SCTNIUSL-INSMSCT(MVTWO),ORDYNVAL              Y02670 31517002
*                                 MOVE IN O'RIDE                 Y02670 31517802
EACL14   DS    0H                                                Y02668 31518602
*   CHECK FOR END OF OVERRIDE CHAIN.                                    31520000
*                                                                       31540000
         CLC   ORCHAIN(3),EAENDOR IS THE CHAIN TTR ZERO.                31580000
         BNE   EAEXIT             NO. GO TO EXIT.                       31600000
         SPACE                                                          31620000
         NI    SWE,FF-POVRX       END OF O'RIDE CHAIN - TURN OFF FLAG   31640000
*                                      INDICATING O'RIDE PROC EXEC STMT 31660000
         SPACE 3                                                        31680000
EAEXIT   DS    0H                                                  I283 31688019
*************************************************************** YM02711 31704002
*        STEP DEFAULTS FOR REGION AND ADDRSPC                   YM02711 31711002
*************************************************************** YM02711 31718002
*  ADDRSPC=REAL AND NO REGION SPECIFIED ON JOB OR EXEC          YM02711 31725002
*  REGION LEFT ZERO                                             YM02711 31732002
*************************************************************** YM02711 31739002
         TM    SWD,JOBADDRF        ADDRSPC ON JOB STMT ?        YM02711 31746002
         BZ    EAEXIT2             NO - CHECK JOB REGION        YM02711 31753002
         NI    SCT+SCTSSTAT-INSMSCT,FF-EAADDRBT                 YM02711 31760002
*                                  CLEAR POSSIBLE EXEC SETTING  YM02711 31767002
         TM    IWAJBADR,JCTADSPC   JOB ADDRSPC=REAL ?           YM02711 31774002
         BZ    EAEXIT2             NO - CHECK FOR JOB REGION    YM02711 31781002
         OI    SCT+SCTSSTAT-INSMSCT,EAADDRBT                    YM02711 31788002
*                                  SET SCT ADDRSPC=REAL         YM02711 31795002
EAEXIT2  DS    0H                                               YM02711 31802002
         LA    RF,WAJOBPFX         ADDR OF PSEUDO JOB PFX       YM02711 31809002
         USING TEXT,RF             TEXT PREFIX ADDRESSABILITY   YM02711 31816002
         TM    STRJINDC,JTXREGDF   IS JOB REGION A DEFAULT ?    YM02711 31823002
         BZ    EAEXIT2A            NO - MOVE JOB REGION         YM02711 31830002
         DROP  RF                                               YM02711 31837002
         CLC   SCT+SCTMSSZE-INSMSCT(E2),EAENDOR REGION ON EXEC  YM02711 31844002
         BNE   EAEXIT3             YES - CHECK FOR JOB RD       YM02711 31851002
         TM    SCT+SCTSSTAT-INSMSCT,EAADDRBT ADRSPC=REAL IN SCT YM02711 31858002
         BO    EAEXIT3             NO - CHECK FOR JOB RD        YM02711 31865002
EAEXIT2A DS    0H                                               YM02711 31872002
         MVC   SCT+SCTMSSZE-INSMSCT(E2),IWAJOBS6                YM02711 31879002
*                                  MOVE IN JOB REGION           YM02711 31886002
EAEXIT3  DS    0H                                                       31896001
         TM    IWAINTS8,JOBRDNR+JOBRDNC+JOBRDR  RD ON JOB STMT.    AACA 31897201
         BZ    EAEXIT4            NO. GO TO EXIT                   AACA 31898401
         NI    SCT+SCTSSTAT-INSMSCT,CLFLAGS CLEAR SCTSSTAT        O106  31899601
         OC    SCT+SCTSSTAT-INSMSCT(OC1),IWAINTS8  SET JOB RD FLG O106  31900801
EAEXIT4  DS    0H                                                  AACA 31902001
         TM    SWH,CPSYSFLG       IS THIS CHCKPT/RSTRT EXEC STMT   AACA 31903201
         BZ    EAEXIT5            NO. CONTINUE.                    AACA 31904401
         OI    SCT+SCTSSTAT-INSMSCT,PROTKEY  ALLOW DSDRP PROTECT  O106  31905601
*                                      KEY OF ZERO                O106  31906801
EAEXIT5  DS    0H                                                  AACA 31908001
         TM    EASW2,EACLCOND      Q. RESTARTING JOB               AACA 31909201
         BZ    EAEXIT6              BR - NO                        AACA 31910401
         XC    SCT+SCTSDPCD-INSMSCT(CL48),SCT+SCTSDPCD-INSMSCT    O106  31911601
*                                      CLEAR STEP CONDITION CODES O106  31912801
         NI    EASW2,255-EACLCOND  CLEAR COND. CODE SW.            AACA 31914001
EAEXIT6  EQU   *                                                   AACA 31915201
         SPACE 3                                                        31916401
EAEXITHF DS    0H                                                  AACA 31917601
*  PERFORM KEYWORD CHECK.                                       YM00368 31918802
         L     RE,TEXTBUFP        ADDR TEXT STRING PREFIX       YM00368 31923802
         USING TEXT,RE            PREFIX ADDRESSABILITY         YM00368 31928802
         TM    STRINDCS,PROCSTR   PROC STMT?                    YM00368 31933802
         BO    EAEXITB            YES, SKIP PERF PROCESSING.    YM00368 31938802
         TM    STREINDC,ETXPRCV    STMT INVOKE A PROCEDURE?     YM00368 31943802
         BO    EAEXITB             BR YES,PRF ALREADY PROCESSED YM00368*31948802
                                   IN PERFORM ROUTINE.          YM00368 31953802
         DROP  RE                                                       31958802
         CLI   SCT+SCTPRFMF-INSMSCT,E0 PERFORM SPEC'D ON EXEC?  YM00368 31963802
         BNE   EAEXITB            YES, CONTINUE                 YM00368 31968802
*  ENTER PERFORM VALUE SPECIFIED ON JOB STMT, OR DEFAULT IF     YM00368 31973802
*  JOB VALUE INVALID OR OMITTED.                                YM00368 31978802
         MVC   SCT+SCTPRFMF-INSMSCT(E1),JCT+JCTPRFMF-INJMJCT    YM00376 31983802
EAEXITB  DS    0H                                               YM00368 31988802
         L     RF,EAVHE           SET EXIT                      YM00368 31993802
         BR    RF                  TO ROUTER.                   YM00368 31998802
*                                                               YM00368 32003802
*  ERROR - FAIL JOB AND ISSUE ERROR MESSAGE.                    YM00368 32008802
*                                                               YM00368 32013802
EAERRTNA DS    0H                                                       32020000
         SR    R2,R2                                                    32040000
         IC    R2,MSGSEC          ERROR MESSAGE NBR TO R2.              32060000
         OI    JCTJSTAT,INCMSTS   FAIL JOB.                             32080000
         L     RF,EAVGM           LINK TO PUT OUT                       32100000
         BALR  RE,RF                   ERROR MESSAGE.                   32120000
         B     EAERRTN1            CONTINUE CLEANUP             YM00382 32122002
*********************************************************************   32340219
*                                                                   *   32340419
*                    CONSTANTS                                      *   32340619
*                                                                   *   32340819
*********************************************************************   32341019
         SPACE                                                          32341219
FF       EQU   X'FF'                   ALL ONES                         32341419
         DS    0F                                                       32344201
EABLANK  DC    CL8'        '           8 BLANKS                         32344501
EATESTOR DC    V(IEFVGT)               TEST AND STORE                   32345001
EAGETKEP DC    V(IEFVGK)               GET KEY/POS                      32345501
EAVGM    DC    V(IEFVGM)               MESSAGE MODULE                   32346001
EAINPUT  DC    V(IEFVGI)               DICTIONARY INPUT ROUTINE         32346501
EASEARCH DC    V(IEFVGS)               DICTIONARY SEARCH ROUTINE        32347001
EAVHQ    DC    V(IEFVHQ)               Q-MANAGER INTERFACE              32347501
EAVHE    DC    V(IEFVHE)           ROUTER.                       Y02668 32348002
EAVDBSD  DC    V(IEFVDBSD)        ADDRESS OF DSENQ TABLE RTNE,   Y02668 32348202
EAVHR    DC    V(IEFVHR)               ERROR MSG WTO ROUTINE            32348501
PROCBADD DC    A(EAPROCB-EABASE)   DISPLACEMENT OF PROC PDT.     Y02668 32348702
EA100    DC    H'100'                  CONVERSION OF SECS TO 100THS     32349001
*                                      SECS                             32349501
EA6000   DC    H'6000'                 CONVERSION OF MINS TO 100THS     32350001
*                                      SECS                             32350501
CONHZERO DC    H'0'                HALFWORD ZERO.               YM00368 32350702
EAENDOR  DC    XL3'000000'             INDICATES END OF COND FIELDS     32351001
EAPGMSD  DC    C'PGM=*.DD'             DDNAME INTO PGM=*.SIOT           32351501
EAEVEN   DC    XL5'04C5E5C5D5'         TEXT BUFFER COND 'EVEN' ENTRY    32352001
EAONLY   DC    XL5'04D6D5D3E8'         TEXT BUFFER COND 'ONLY' ENTRY    32352501
         DS    0F                                                       32352601
MAXVAL   DC    XL4'00003FFF'           MAX REGION SIZE           Y01029 32352901
EASIOTBT DS    0C                      MASK FOR DISP=(OLD,PASS) NOT     32355201
*                                      EQUAL JOBLIB                     32356001
         DC    AL1(EASIPAS)            SCTSDISP  DISP=  PASS            32356801
         DC    X'00'                   SCTSBYT1                         32357601
         DC    AL1(SCTJOBLB)           SCRSBYT2 JOBLIB                  32358401
         DC    AL1(EASIOLD)            SCTSBYT3  DISP=  OLD             32359201
         DC    X'00'                   SCTBYT4                          32360001
DSNTLEN  DC    F'168'                  USED TO DIVIDE DSNT REL LEN      32364003
*                                                              @ZA15772 32365003
EAPXID   EQU   X'0C'                   PARM FIELD EXTENSION ID          32368001
MVONE    EQU   1                       LENGTH OF MOVE             O106  32368801
MVTWO    EQU   2                       LENGTH OF MOVE             O106  32369601
MVTHREE  EQU   3                       LENGTH OF MOVE             O106  32370401
MVFOUR   EQU   4                       LENGTH OF MOVE             O106  32371201
MVEIGHT  EQU   8                       LENGTH OF MOVE             O106  32372001
MV48     EQU   48                      LENGTH OF MOVE             O106  32372801
ZEROPRKY EQU   X'FB'                   ZERO PROTECT KEY BIT       O106  32373601
INSTPROC EQU   X'80'                                              M4763 32374401
DISPLONE EQU   1                       DISPLACEMENT               O106  32375201
DISPLZER EQU    0                      DISPLACEMENT                4327 32376001
DISPLTWO EQU   2                       DISPLACEMENT               O106  32376801
DISPLFOR EQU   4                       DISPLACEMENT             O106    32377601
DISPLATE EQU   8                       DISPLACEMENT                4327 32378401
DISPLELE EQU   11                      DISPLACEMENT                4327 32379201
COMPATE  EQU   8                       LENGTH OF COMPARE           4327 32380001
CLTWO    EQU   2                       LENGTH OF CLEAR            O106  32380801
CLTHREE  EQU   3                       LENGTH OF CLEAR            O106  32381601
CLFOUR   EQU   4                       LENGTH OF CLEAR            O106  32382401
CLEIGHT  EQU   8                       LENGTH OF CLEAR            O106  32383201
CLTHIRTN EQU   13                      LENGTH OF CLEAR            O106  32384001
CL48     EQU   48                      LENGTH OF CLEAR            O106  32384801
OC1      EQU   1                                                  O106  32385601
OC6      EQU   6                       CHECK FOR TOO MANY COND OR O106  32386401
*                                      MULTIPLE OF EVENHS/ONLYS'S O106  32387201
COMTWO   EQU   2                       LENGTH OF COMPARE          O106  32388001
FRSTSTEP EQU   X'01'         TEST FOR FIRST STEP IN SCT.         Y02113 32388402
INITBLK  EQU   X'00'                   INITIALIZE TO ZEROS        O106  32388801
CLFLAGS  EQU   X'C7'                   CLEAR FLAGS IN SCTSSTWAT   O106  32389601
INIT1    EQU   B'00010000'                                        O106  32390401
INIT2    EQU   B'11110000'                                        O106  32391201
MAX      EQU   4096                    VALUE OF SECOND BASE       O106  32392001
INIT3    EQU   X'0'                                               O106  32392801
INIT4    EQU   X'0B'                                              O106  32393601
GOSTEP   EQU   X'80'                   EQU IN SCT,SCTGOSTP        O106  32394401
ZERSDP   EQU   X'E0'                   ZERO SDP FIELD             O106  32395201
LCSREG   EQU   X'01'                   LCS REGION                 O106  32396001
PROTKEY  EQU   X'04'                   DSDRP PROTECT KEY          O106  32396801
CZERO    DC    CL2'00'                                                  32397601
         EJECT                                                          32398401
*********************************************************************** 32399201
**                                                                   ** 32400000
**             TABLES FOR EXEC ROUTINE                               ** 32420000
**                                                                   ** 32440000
*********************************************************************** 32460000
*                                                                       32480000
*   BRANCHING TABLE FOR GET KEY/POS.                                    32500000
*                                                                       32520000
EABRANCH DS    0H                                                       32540000
         SPACE                                                          32560000
*   EXEC KEY                                                            32580000
EAEXECA  KKK   02,0,EAEXEC,EAEXECB                                      32600000
*   TIME= KEY                                                           32620000
EATIMEEA KKK   02,0,EATIMEE,EATIMEEB                                    32640000
*   PARM= KEY                                                           32660000
EAPARMEA KKK   100,0,EAPARME,EAPARMEB                              AACA 32680017
*   COND= KEY                                                           32700000
EACONDEA KKK   08,11111111,EACONDE,EACONDEB                             32720000
*   ACCT= KEY                                                           32740000
EAACTEA  KKK   72,0,EAACTE,EAACTEB                                      32760000
*   TIME. KEY                                                           32780000
EATIMEPA KKK   03,0,EATIMEP,EATIMEPB                                    32800000
*   PARM. KEY                                                           32820000
EAPARMPA KKK   101,0,EAPARMP,EAPARMPB                              AACA 32840017
*   COND. KEY                                                           32860000
EACONDPA KKK   09,11111111,EACONDP,EACONDPB                             32880000
*   ACCT. KEY                                                           32900000
EAACTPA  KKK   73,0,EAACTP,EAACTPB                                      32920000
*   PROC KEY                                                            32940000
EAPROCA  KKK   01,00000000,EAPROC,EAPROCB                               32960000
*   PGM KEY                                                             32980000
EAPGMA   KKK   01,10000000,EAPGM,EAPGMB                                 33000000
*   REGION= KEY                                                         33020000
EAREGEA  KKK   02,0,EAREGE,EAREGEB                                 AACA 33040017
*   REGION. KEY                                                         33060000
EAREGPA  KKK   03,0,EAREGP,EAREGPB                                 AACA 33070017
*   ROLL= KEY                                                           33084014
EAROLLEA KKK   02,0,EAROLLE,EAROLLEB                                    33088014
*   ROLL. KEY                                                           33092014
EAROLLPA KKK   03,0,EAROLLP,EAROLLPB                                    33096014
*   RD. KEY                                                        AACA 33096417
EARDPA   KKK   02,0,EARDP,EARDPB                                   AACA 33096817
*   RD= KEY                                                        AACA 33097217
EARDEA   KKK   01,0,EARDE,EARDEB                                   AACA 33097617
*************************DUMMY ENTRY*****************************Y02668 33098402
         DC    XL6'0'                                            Y02668 33098702
*****************************************************************Y02668 33099002
         SPACE                                                     7777 33099318
*   SDP= KEY                                                       I241 33099418
EASDPEA  KKK   02,0,EASDPE,EASDPEB                                 I241 33099518
         SPACE                                                          33099618
*   SDP. KEY                                                       I241 33099718
EASDPPA  KKK   03,0,EASDPP,EASDPPB                                 I241 33099818
         SPACE                                                          33099901
*    ADDRSPC= KEY                                                Y01029 33106601
EAADDREA KKK   01,0,EAADDRE,EAADDREB                             Y01029 33108601
         SPACE                                                          33110601
*     ADDRSPC. KEY                                               Y01029 33112601
EAADDRPA KKK   02,0,EAADDRP,EAADDRPB                             Y01029 33113001
*    PERFORM= KEY                                                Y02655 33113302
EAPRFMEA KKK  01,0,EAPRFME,EAPRFMEB                              Y02655 33114302
*    PERFORM.= KEY                                               Y02655 33115302
EAPRFMPA KKK   02,0,EAPRFMP,EAPRFMPB                             Y02655 33116302
*    DYNAMNBR= KEY                                               Y02670 33116502
EADYNMEA KKK   01,0,EADYNME,EADYNMEB                             Y02670 33116702
*    DYNAMNBR.= KEY                                              Y02670 33116902
EADYNMPA KKK   02,0,EADYNMP,EADYNMPB                             Y02670 33117102
         EJECT                                                          33117302
*                                                                       33120000
*   PARAMETER DESCRIPTER TABLE FOR TEST & STORE.                        33140000
*                                                                       33160000
         SPACE 2                                                        33180000
*********************************************************************** 33200000
*                                                                       33220000
*****    EXEC  KEYWORD PARAMETER DESCRIPTER TABLE.                      33240000
*                                                                       33260000
EAEXECB  EQU   *                  EXEC PDT.                             33280000
         DC    AL1(EAENDK1-EAEXECB)    LENGTH OF EXEC PDT.              33300000
*   STEPNAME - MAX LENGTH = 8 - 1ST CHAR ALPHA - MVC TO EAWORK.         33320000
EAST1    EQU   *                                                        33340000
         DC    AL1(EAEND1-EAST1)       LENGTH OF STEPNAME PDT.          33360000
         DC    XL1'20'                 BYTES CNTRL INFO/BYTES TO COMP.  33380000
         DC    FL1'8'                  MAX PARAMETER LENGTH.            33400000
         DC    XL1'60'                 FUNCT/TABLE.                     33420000
         DC    AL1(EASNSV-EAWORK)      OFFSET IN TABLE.                 33440000
EAEND1   EQU   *                       END STEPNAME POS PDT.            33460000
EAENDK1  EQU   *                       END EXEC KEY PDT.                33480000
*********************************************************************** 33500000
         SPACE 2                                                        33520000
*********************************************************************** 33540000
*                                                                       33560000
*****    PROC  KEYWORD PARAMETER DESCRIPTER TABLE.                      33580000
*                                                                       33600000
EAPROCB  EQU   *                  PROC PDT.                             33620000
         DC    AL1(EAENDK2-EAPROCB)    LENGTH OF PROC PDT.              33640000
*   PROCNAME - MAX LENGTH = 8 - 1ST CHAR ALPHA - MOVE TO EAWORK.        33660000
EAST2    EQU   *                                                        33680000
         DC    AL1(EAEND2-EAST2)       LENGTH OF 1ST PROCNAME PDT.      33700000
         DC    XL1'20'                 CONTROL INFO/COMPARE BYTES.      33720000
         DC    FL1'8'                  MAXIMUM LENGTH OF PROCNAME.      33740000
         DC    XL1'60'                 FUNCT/TABLE.                     33760000
         DC    AL1(EAPCSV-EAWORK)      OFFSET IN TABLE.                 33780000
EAEND2   EQU   *                                                        33800000
EAENDK2  EQU   *                                                        33820000
*********************************************************************** 33840000
         SPACE 2                                                        33860000
*********************************************************************** 33880000
*                                                                       33900000
*****    PGM   KEYWORD PARAMETER DESCRIPTER TABLE.                      33920000
*                                                                       33940000
EAPGMB   EQU   *                  PGM PDT.                              33960000
         DC    AL1(EAENDK3-EAPGMB)     LENGTH OF PGM PDT.               33980000
*   PROGRAMNAME - CHECK FOR *. - NOT *. MAX LENGTH=8 - MVC TO SCT.      34000000
EAST4    EQU   *                                                        34020000
         DC    AL1(EAEND4-EAST4)       LENGTH OF 1ST PGMNM PDT.         34040000
         DC    XL1'31'                 CONTROL INFO/COMPARE BYTES.      34060000
         DC    C'*'                    COMPARE PATTERN.                 34080000
         DC    XL1'00'                 FUNCT/TABLE.  OR/LWA             34100000
         DC    AL1(EASW1-EAWORK)       OFFSET IN TABLE.                 34120000
         DC    AL1(EAPGMSDF)           BIT PATTERN.                     34140000
         DC    XL1'50'                 CONTROL INFO/COMPARE BYTES.      34160000
         DC    FL1'8'                  MAXIMUM PARAM LENGTH.            34180000
         DC    XL1'62'                 FUNCT/TABLE. 1ST ALPHA & MVC/SCT 34200000
         DC    AL1(SCTPGMNM-INSMSCT)   OFFSET IN TABLE.                 34220000
         DC    XL1'00'                 FUNCT/TABLE.  OR/LWA.            34240000
         DC    AL1(EASW1-EAWORK)       OFFSET IN TABLE.                 34260000
         DC    AL1(EAPGMEF)            BIT PATTERN.                     34280000
EAEND4   EQU   *                                                        34300000
EAENDK3  EQU   *                                                        34320000
*******************************************************************AABA 34323016
         SPACE 2                                                        34326016
         SPACE 2                                                        34392016
*******************************************************************AABA 34395016
*                                                                       34400000
*****    ACCT  KEYWORD PARAMETER DESCRIPTER TABLE.                      34420000
*****    ACCT. KEYWORD PARAMETER DESCRIPTER TABLE.                      34440000
*                                                                       34460000
         DC    AL1(EAACCTOR)      ACT O'RIDE FLAG (USED BY EAORIDE).    34480000
EAACTPB  EQU   *                                                        34500000
EAACTEB  EQU   *             (ACT) PDT.  ** NOT USED FOR TEST & STORE** 34520000
*********************************************************************** 34540000
         SPACE 2                                                        34560000
*********************************************************************** 34580000
*                                                                       34600000
*****    PARM  KEYWORD PARAMETER DESCRIPTER TABLE.                      34620000
*****    PARM. KEYWORD PARAMETER DESCRIPTER TABLE.                      34640000
*                                                                       34660000
         DC    AL1(EAPARMOR)      PARM O'RIDE FLAG (USED BY EAORIDE).   34680000
EAPARMPB EQU   *                                                        34700000
EAPARMEB EQU   *             (PARM) PDT.                                34720000
*********************************************************************** 34740000
         SPACE 2                                                        34760000
*********************************************************************** 34780000
*                                                                       34800000
*****    TIME  KEYWORD PARAMETER DESCRIPTER TABLE.                      34820000
*****    TIME. KEYWORD PARAMETER DESCRIPTER TABLE.                      34840000
*                                                                       34860000
         DC    AL1(EATIMEOR)      TIME O'RIDE FLAG (USED BY EAORIDE).   34880000
EATIMEPB EQU   *                                                        34900000
EATIMEEB EQU   *                                                        34920000
         DC    AL1(EAENDK6-EATIMEPB)   LENGTH OF (TIME/TIME.) PDT.      34940000
*   MINS - CONVERT TO BINARY MOVE TO EATEMP1+1.                         34960000
EAST7    EQU   *                                                        34980000
         DC    AL1(EAEND7-EAST7)       LENGTH OF MINS PDT.              35000000
         DC    XL1'50'            BYTES CONTROL INFO/COMPARE BYTES      35020000
         DC    FL1'4'             MAXIMUM PARAMETER LENGTH.             35040000
         DC    XL1'30'            FUNCT/TABLE. (CVB(3)/EWA)             35060000
         DC    AL1(EATEMP1+1-EAWORK)   OFFSET IN EWA.                   35080000
         DC    FL3'1440'          MAXIMUM NUMBER OF MINUTES.            35100000
EAEND7   EQU   *                                                        35120000
EAST8    EQU   *                                                        35140000
         DC    AL1(EAEND8-EAST8)       LENGTH OF SECS PDT.              35160000
         DC    XL1'50'            BYTES CONTROL INFO/COMPARE BYTES      35180000
         DC    FL1'2'             MAXIMUM PARAMETER LENGTH.             35200000
         DC    XL1'30'            FUNCT/TABLE. (CVB(3)/EWA)             35220000
         DC    AL1(EATEMP2+1-EAWORK)   OFFSET IN EWA.                   35240000
         DC    FL3'59'            MAX NBR CVB.                          35260000
EAEND8   EQU   *                                                        35280000
EAENDK6  EQU   *                                                        35300000
*********************************************************************** 35320000
         SPACE 2                                                        35340000
*********************************************************************** 35360000
*                                                                       35380000
*****    COND  KEYWORD PARAMETER DESCRIPTER TABLE.                      35400000
*****    COND. KEYWORD PARAMETER DESCRIPTER TABLE.                      35420000
*                                                                       35440000
*   OPERATOR BIT PATTERNS FOR COND KEYWORD.                             35460000
EAGT     EQU   X'20'              GT OPERATOR.                          35480000
EAGE     EQU   X'B0'              GE OPERATOR.                          35500000
EAEQ     EQU   X'80'              EQ OPERATOR.                          35520000
EANE     EQU   X'70'              NE OPERATOR.                          35540000
EALE     EQU   X'D0'              LE OPERATOR.                          35560000
EALT     EQU   X'40'              LT OPERATOR.                          35580000
*                                                                       35600000
         DC    AL1(EACONDOR)      COND O'RIDE FLAG (USED BY EAORIDE).   35620000
EACONDPB EQU   *                                                        35640000
EACONDEB EQU   *                                                        35660000
         DC    AL1(EAENDK7-EACONDPB)   LENGTH OF (COND/COND.) PDT.      35680000
*   CODE - CONVERT TO BINARY MVC TO EATEMP1(2).                         35700000
EAST9    EQU   *                                                        35720000
         DC    AL1(EAEND9-EAST9)       LENGTH OF CODE PDT.              35740000
         DC    XL1'40'                 BYTES CONTROL INFO/COMPARE BYTES 35760000
         DC    FL1'4'                  MAXIMUM PARAMETER LENGTH.        35780000
         DC    XL1'20'                 FUNCT/TABLE - CVB(2)/EWA.        35800000
         DC    AL1(EATEMP1-EAWORK)     OFFSET IN EWA.                   35820000
         DC    FL2'4095'               MAXIMUM NUMBER FOR CODE.         35840000
EAEND9   EQU   *                                                        35860000
         SPACE                                                          35880000
*   OPERATORS - SEARCH FOR OPERATOR - MVC HEX PATTERN TO EATEMP1+2.     35900000
EAST10   EQU   *                                                        35920000
         DC    AL1(EAEND10-EAST10)     LENGTH OF OPERATORS PDT.         35940000
*   GT                                                                  35960000
         CCC   GT,EAGT                                                  35980000
*   GE                                                                  36000000
         CCC   GE,EAGE                                                  36020000
*   EQ                                                                  36040000
         CCC   EQ,EAEQ                                                  36060000
*   NE                                                                  36080000
         CCC   NE,EANE                                                  36100000
*   LE                                                                  36120000
         CCC   LE,EALE                                                  36140000
*   LT                                                                  36160000
         CCC   LT,EALT                                                  36180000
EAEND10  EQU   *                                                        36200000
         SPACE                                                          36220000
*   STEPNAME - MOVE TO WORK AREA.                                       36240000
EAST11   EQU   *                                                        36260000
         DC    AL1(EAEND11-EAST11)     LENGTH OF STEPNAME PDT.          36280000
         DC    XL1'20'                 CONTROL BYTES/COMPARE BYTES.     36300000
         DC    FL1'8'                  MAXIMUM PARAMETER LENGTH.        36320000
         DC    XL1'50'                 FUNCT/TABLE. (MVC/EWA).          36340000
         DC    AL1(EAREGSV-EAWORK)     OFFSET IN EWA.                   36360000
EAEND11  EQU   *                                                        36380000
EAENDK7  EQU   *                                                        36400000
*********************************************************************** 36420000
         SPACE 2                                                        36440000
*********************************************************************** 36460000
*                                                                       36480000
*****    REGION  KEYWORD PARAMETER DESCRIPTER TABLE.                    36500000
*****    REGION. KEYWORD PARAMETER DESCRIPTER TABLE.                    36520000
*                                                                       36540000
         DC    AL1(EAREGOR)       REGION O'RIDE FLAG (USED BY EAORIDE). 36560000
EAREGPB  EQU   *                                                        36580000
EAREGEB  EQU   *                                                        36600000
         DC    AL1(EAENDK8-EAREGPB)    LENGTH OF (REGION/REGION.) PDT.  36620000
*   CONVERT TO BINARY - MVC TO SCT.                                     36640000
EAST12   EQU   *                                                        36660000
         DC    AL1(EAEND12-EAST12)     LENGTH OF REGION PDT.            36680000
         DC    XL1'40'                 BYTES CONTROL INFO/COMPARE BYTES 36700000
         DC    FL1'5'                  MAXIMUM PARAMETER LENGTH.        36720000
         DC    XL1'20'                 FUNCT/TABLE. (CVB(2)/EWA)        36740000
         DC    AL1(EATEMP1-EAWORK)     OFFSET IN EWA.                   36760000
         DC    XL2'3FFF'          16383 - MAXIMUM K FOR REGION     1500 36780014
EAEND12 EQU    *                                                        36800000
EAENDK8 EQU    *                                                        36820000
*********************************************************************** 36840000
         SPACE 3                                                        36840514
*********************************************************************** 36841014
*                                                                       36841514
*****    ROLL= KEYWORD PARAMETER DESCRIPTER TABLE.               Y01029 36842001
*****    ROLL. KEYWORD PARAMETER DESCRIPTER TABLE.                      36842514
*                                                                       36843014
EAROLLEB EQU   *                                                        36844014
EAROLLPB EQU   *                                                        36844514
         DC    AL1(EAENDK9-EAROLLPB)                                    36854501
EAEND14  EQU   *                                                        36856514
EAENDK9  EQU   *                                                        36857014
*******************************************************************AACA 36857517
         SPACE 2                                                        36858017
*******************************************************************AACA 36858517
*                                                                  AACA 36859017
****   RD= KEYWORD PARAMETER DESCRIPTOR TABLE                      AACA 36859517
****   RD. KEYWORD PARAMETER DESCRIPTOR TABLE                      AACA 36860017
*                                                                  AACA 36860517
         DC    AL1(EARDOR)  RD O'RIDE FLAG (USED BY EAORIDE)       AACA 36861017
EARDEB   EQU   *                                                   AACA 36861517
EARDPB   EQU   *                                                   AACA 36862017
         DC    AL1(EAENDK10-EARDPB)  LENGTH OF (RD/RD.) PDT        AACA 36862517
EAST15   EQU   *                                                   AACA 36863017
         DC    AL1(EAEND15-EAST15)   LENGTH OF POSITIONAL PDT      AACA 36863517
         DC    XL1'31'               CTRL BYTES/COMPARE BYTES      AACA 36864017
         DC    C'R'                  COMPARE PATTERN               AACA 36864517
         DC    XL1'00'               OR / EWA                      AACA 36865017
         DC    AL1(EATEMP1-EAWORK)   OFFSET                        AACA 36865517
         DC    AL1(SCTDORST)           BIT.  CR                    AACA 36866017
         DC    XL1'32'               CTRL/COMPARE                  AACA 36866517
         DC    C'NR'                 COMPARE PATTERN               AACA 36867017
         DC    XL1'00'               OR/EWA                        AACA 36867517
         DC    AL1(EATEMP1-EAWORK)   OFFSET                        AACA 36868017
         DC    AL1(SCTNORST)           BIT.  CR                    AACA 36868517
         DC    XL1'32'               CTRL/COMPARE                  AACA 36869017
         DC    C'NC'                 COMPARE PATTERN               AACA 36869517
         DC    XL1'00'               OR/EWA                        AACA 36870017
         DC    AL1(EATEMP1-EAWORK)   OFFSET                        AACA 36870517
         DC    AL1(SCTNOCKP)           BIT.  CR                    AACA 36871017
         DC    XL1'63'               CTRL/COMPARE                  AACA 36871517
         DC    C'RNC'                COMPARE PATTERN               AACA 36872017
         DC    XL1'00'               OR/EWA                        AACA 36872517
         DC    AL1(EATEMP1-EAWORK)   OFFSET                        AACA 36873017
         DC    AL1(SCTNOCKP)           BIT.  CR                    AACA 36873517
         DC    XL1'00'               OR/EWA                        AACA 36874017
         DC    AL1(EATEMP1-EAWORK)   OFFSET                        AACA 36874517
         DC    AL1(SCTDORST)           BIT.  CR                    AACA 36875017
EAEND15  EQU   *                                                   AACA 36875517
EAENDK10 EQU   *                                                   AACA 36876017
         SPACE                                                     7777 36906018
*******************************************************************I241 36936018
*                                                                  I241 36966018
*****    SDP  KEYWORD PAPAMETER DESCRIPTER TABLE                   I241 36996018
*****    SDP.  KEWORD PAPAMETER DESCRIPTER TABLE                   I241 37026018
*                                                                  I241 37056018
         DC    AL1(EASDPOR)       SDP O'RIDE FLAG (USED BY EAORIDE)I241 37086018
EASDPEB  EQU   *                                                   I241 37116018
EASDPPB  EQU   *                                                   I241 37146018
         DC    AL1(EAENDK12-EASDPEB) LENGTH OF (SDP/SDP.) PDT      I241 37176018
*   CONVERT TO BINARY - CHECK MAXIMUM                              I241 37206018
EAST17   EQU   *                                                   I241 37236018
         DC    AL1(EAEND17-EAST17) LENGTH OF SDP PDT               I241 37266018
         DC    XL1'30'             BYTES CONTROL INFO/COMPARE BYTESI241 37296018
         DC    FL1'2'              MAXIMUM PARAMETER LENGTH        I241 37326018
         DC    XL1'10'             FUNCTION/TABLE  (CVB(1)/EWA)    I241 37356018
         DC    AL1(EATEMP1-EAWORK) OFFSET IN EWA                   I241 37386018
         DC    XL1'0F'             MAXIMUM  PRIORITY NUMBER        I241 37416018
EAEND17  EQU   *                                                   I241 37446018
EAENDK12 EQU   *                                                   I241 37476018
         EJECT                                                     I241 37506018
*******************************************************************I241 37508001
*******************************************************************I241 37516001
*          ADDRSPC= KEYWORD PARAMETER DESCRIPTOR TABLE           Y01029 37526001
*          ADDRSPC. KEYWORD PARAMETER DESCRIPTOR TABLE           Y01029 37528001
*****************************************************************Y01029 37536001
         DC    AL1(EAADDROR)      ADDRSPC O'RIDE FLAG            Y01029 37636001
EAADDRPB EQU   *                                                 Y01029 37636401
EAADDREB EQU   *                                                 Y01029 37638001
         DC    AL1(EAENDK13-EAADDRPB)                            Y01029 37638401
*                                 LENGTH POSITIONAL PDT                 37638801
EAST18   EQU   *                                                        37639201
         DC    AL1(EAEND18-EAST18)                                      37639601
*                                 LENGTH POSITIONAL PDT                 37639701
         DC    XL1'34'            CONTROL INFO BYTES                    37639801
         DC    C'REAL'            COMPARE PATTERN                       37639901
         DC    XL1'00'            FUNC-TABLE (OR/EWA)                   37689901
         DC    AL1(EATEMP1-EAWORK)                                      37699901
*                                 OFFSET IN EWA                         37709901
         DC    AL1(EAADDRBT)      BIT PATTERN                           37719901
         DC    XL1'04'            CONTROL INFO/COMPARE BYTE             37729901
         DC    C'VIRT'            COMPARE PATTERN                       37731901
EAEND18  EQU   *                                                        37733901
EAENDK13 EQU   *                                                        37735901
         EJECT                                                          37736002
         DC    AL1(EAPRFMOR)                                     Y02655 37736102
EAPRFMPB EQU   *                                                 Y02655 37736202
EAPRFMEB EQU   *                                                 Y02655 37736302
         DC   AL1(EAENDK14-EAPRFMPB) LENGTH POSITIONAL PARAMETER Y02655 37736402
EAST19   EQU   *                                                 Y02655 37736502
         DC    AL1(EAEND19-EAST19) LENGTH POSITIONAL PARAMETER   Y02655 37736602
         DC    XL1'30'            CONTROL INFO/COMPARE BYTES     Y02655 37736702
         DC    FL1'3'             MAX PARAMETER LENGTH           Y02655 37736802
         DC    XL1'10'            FUNCTION/TABLE                 Y02655 37736902
         DC    AL1(EATEMP1-EAWORK) OFFSET IN EWA                 Y02655 37737002
         DC    XL1'FF'            MAX NUMBER                     Y02655 37737102
EAEND19  EQU   *                                                 Y02655 37737202
EAENDK14 EQU   *                                                 Y02655 37737302
         EJECT                                                          37737402
************************************************************     Y02670 37737502
*        DYNAMNBR= KEYWORD PARAMETER DESCRIPTOR TABLE      *     Y02670 37737602
*        DYNAMNBR. KEYWORD PARAMETER DESCRIPTOR TABLE      *     Y02670 37737702
************************************************************     Y02670 37737802
         SPACE                                                          37737902
         DC    AL1(EADYNMOR)                                     Y02670 37738002
EADYNMPB EQU   *                                                 Y02670 37738102
EADYNMEB EQU   *                                                 Y02670 37738202
         DC    AL1(EAENDK15-EADYNMPB) LENGTH POSITIONAL PDT      Y02670 37738302
EAST20   EQU   *                                                 Y02670 37738402
         DC    AL1(EAEND20-EAST20) LENGTH POSITIONAL PDT         Y02670 37738502
         DC    XL1'40'            CONTROL INFO/COMPARE BYTES     Y02670 37738602
         DC    FL1'4'             MAX PARAMETER LENGTH           Y02670 37738702
         DC    XL1'20'            FUNCTION/TABLE                 Y02670 37738802
         DC    AL1(EATEMP1-EAWORK) OFFSET IN EWA                 Y02670 37738902
         DC    XL2'0663'          MAX NBR                        Y02670 37739002
EAEND20  EQU   *                                                 Y02670 37739102
EAENDK15 EQU   *                                                 Y02670 37739202
PATCH    DC    25F'0'             **********PATCH SPACE**********Y02668 37739302
         END                                                            37739901
