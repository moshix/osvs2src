         EJECT                                                          00020002
         IEFCOMWA                                                Y02668 00030002
AWA      DSECT                                                          00040000
         IEFVMAWA                                                       00060000
         EJECT                                                          00080002
         IFGRPL                                                  Y02668 00090002
         EJECT                                                          00100002
NEL      DSECT                                                          00110002
         IEFNEL SUBCOM=C                                                00120002
         EJECT                                                          00130002
         IEFVKEYS                                                 19874 00190019
         IEFTXTFT                                                       00195002
*********************************************************************** 00200000
**********************************************************************  00220000
IEFVGM   CSECT                                                          00240000
*/*                                                                     00290002
**********************************************************************  00340002
*                                                                       00350002
*   MODULE NAME= IEFVGM                                                 00352002
*                                                                       00354002
*   DESCRIPTIVE NAME= MESSAGE MODULE                                    00356002
*                                                                       00358002
*   COPYRIGHT= N/A                                                      00358402
*                                                                       00358802
* STATUS - VS2 SU 16 - IN THIS MODULE, SU 16 SUPPORTS          @G16APPK 00358903
*          VPSS SUPPORT(SU 29 - @G29AN2E) AND RACF             @G16APPK 00359803
*          VERSION 2(SU 32 - @G32HPPJ).                        @G16APPK 00360703
*          SU16 PTF                                            @ZA19982 00361603
*          MERGE SU4,10,16 CODE TO REL 037 PTF                 @ZA27753 00362003
*                                                                       00362503
*   FUNCTION= PRINT OUT ERROR MESSAGES OR JCL STATEMENTS                00363403
*      OPERATION= WHEN IEFVGM RECEIVES CONTROL REGISTER 2 CONTAINS THE  00364303
*                 PRIMARY MESSAGE NUMBER OR IS ZERO.  IF A     @G29AN2E 00365203
*                 PRIMARY MESSAGE NUMBER IS GIVEN, THEN THE    @G29AN2E 00366103
*                 MESSAGE IS LOCATED AND PUT TO THE MESSAGE    @G29AN2E 00367003
*                 DATA SET.  IF REGISTER 2 IS ZERO AND         @G29AN2E 00367903
*                 AOMSGTXT FLAG IS ON IN THE COMWA, THEN AN    @G29AN2E 00368803
*                 ERROR MESSAGE IN THE VGM MESSAGE BUFFER IS   @G29AN2E 00369703
*                 PUT TO THE MESSAGE DATA SET.  IF REGISTER 2  @G29AN2E 00370603
*                 IS ZERO AND AOMSGTXT FLAG IS NOT ON, THEN A  @G29AN2E 00371503
*                 STATEMENT (POINTED TO BY REGISTER 9) IS      @G29AN2E 00372403
*                 PACKED AND PUT TO THE LIST DATA SET.  IF AN  @G29AN2E 00373303
*                 I/O ERROR IS ENCOUNTERED, AN I/O ERROR WTO   @G29AN2E 00374203
*                 IS ISSUED AND EXIT IS TO THE TERMINATION     @G29AN2E 00375103
*                 ROUTINE.                                     @G29AN2E 00376003
*                                                              @G29AN2E 00376903
*                 A WARNING WTO IS ISSUED IF IT HAS NOT        @G29AN2E 00377803
*                 PREVIOUSLY BEEN ISSUED IN CASES WHEN THE     @G29AN2E 00378703
*                 PRIMARY MESSAGE NUMBER IS A WARNING          @G29AN2E 00379603
*                 MESSAGE OR WHEN AOWRNREQ IS TURNED ON IN     @G29AN2E 00380503
*                 THE COMWA.                                   @G29AN2E 00381403
*                                                              @G29AN2E 00382303
*                                                                       00385802
*   NOTES                                                               00387802
*      CHARACTER CODE DEPENDENCIES= EBCDIC                              00389802
*      DEPENDENCIES= NONE                                               00391802
*      RESTRICTIONS= NONE                                               00391902
*      REGISTER CONVENTIONS= R0-RF                                      00392302
*      PATCH-LABEL= PATCH                                               00392402
*                                                                       00398002
*   MODULE TYPE= PROCEEDURE                                             00400002
*      PROCESSOR= ASSEMBLER                                             00402002
*      MODULE SIZE=                                                     00402402
*      ATTRIBUTES= NCAL,LET,LIST,XREF,RENT,REFR                         00402802
*                                                                       00403202
*   ENTRY POINT= IEFVGM                                                 00403302
*      PURPOSE= WRITE OUT A MESSAGE                                     00403402
*      LINKAGE= LOAD VCON BRANCH REGISTER                               00403502
*      INPUT DATA= STATEMENT (REG 2=ZERO, REG 9=STATEMENT POINTER)      00417402
*                  ERROR MESSAGE (REG 2=PRIMARY MESSAGE NUMBER)         00419402
*      REGISTERS SAVED= 14,12                                           00427402
*      REGISTER CONTENTS DURING PROCESSING= N/A                         00429402
*      REGISTERS RESTORED= 14,12                                        00429802
*                                                                       00430202
*   EXIT - NORMAL= BRANCH REGISTER 14                                   00430602
*      CONDITIONS= MESSAGE OR STATEMENT WRITTEN                         00431002
*      OUTPUT DATA= NONE                                                00431102
*      RETURN CODES= NONE                                               00431202
*                                                                       00438202
*   EXIT - ERROR= LOAD TERMINATION RTN VCON AND BRANCH REGISTER         00440202
*      CONDITIONS= I/O ERROR ON PUT OF MESSAGE OR STATEMENT.            00440302
*      OUTPUT DATA= SET TERM BIT IN WORK AREA                           00440402
*      RETURN CODES= AN 8 IN WORK AREA RETURN CODE FIELD                00440502
*                                                                       00440602
*    EXTERNAL REFERANCES= NONE                                          00442402
*      ROUTINES= NONE                                                   00444502
*      DATA AREAS= IWA,AWA,NEL                                          00446602
*      CONTROL BLOCKS= NONE                                             00448702
*      TABLE= NONE                                                      00450802
*      MACROS= GETMAIN FREEMAIN RETURN IEFSAVER IEFRELSE                00452902
*      ENQUEUE RESOURCES= N/A                                           00455002
*                                                                       00457103
*   MESSAGES= NONE                                                      00459103
*                                                                       00461103
*   CHANGE LEVEL = Z40MPTH,G29AN2E,G32HPPJ                     @G32HPPJ 00463103
*   CHANGE LEVEL = Z40MPTH,ZA19982,ZA27753                     @ZA27753 00465103
*                                                                       00471702
**********************************************************************  00473702
**/                                                                     00477602
*********************************************************************** 00481702
*********************************************************************** 00485602
*********************************************************************** 00497402
*********************************************************************** 00509201
AOSTMTLT EQU   10            LENGTH OF STMT # FIELD IN MSG       Y02668 00549202
HDRLINES EQU   2                                                 Y02668 00551502
HDRLTH   EQU   17                                                Y02668 00551602
VFBMSG   EQU   X'FF'                                             Y02668 00551802
VGM0     EQU   0                                               @G29AN2E 00552703
VGM1     EQU   1                                               @G29AN2E 00553603
VGM9     EQU   9                                               @G29AN2E 00554503
L160     EQU   160                                             @G29AN2E 00555403
MAXLEN   EQU   110           MAXIMUN LENGTH TEXT TO BE PASSED  @G29AN2E 00556303
B3       EQU   B'0011'       ICM MASK                          @G29AN2E 00557203
AOMSGLO  EQU   8             OFFSET TO MSG LENGTH              @G29AN2E 00558103
*                                                                       00559201
         SAVE  (14,12)                 SAVE USER REGS                   00980000
         BALR  RB,0                    SETUP MODULE BASE                01000000
         USING *,RB                                                     01020000
*****************************************************************Y02668 01021002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 01022002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 01023002
         CNOP  2,4                                                      01024002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 01025002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 01026002
         DC    C'VGM '             MOD ID USED BY TRACE.         Y02668 01027002
* TRACE RETURNS HERE.                                            Y02668 01028002
*****************************************************************Y02668 01029002
         B     GM1                 BR AROUND MODULE IDENTIFIER   Y02668 01030002
         MODID BR=NO                                             Y02668 01050002
*        DC    C'SU32'             FUNCTION ID                 @G32HPPJ 01096003
*        DC    C'01'               LEVEL # (PROTECT)           @G32HPPJ 01098003
*        DC    C'02'          LEVEL # (PUT MSG 50 IN TABLE)    @ZA19982 01100003
         DC    C'03'   LEV # (MERGE SU4,10,16 CODE TO 037 PTF) @ZA27753 01102003
GM1      DS    0H                                                       01110002
*********************************************************************** 01140002
*                   ISSUE WARNING WTO IF                         Y02668 01170002
*                   WARNING MSG IS ISSUED                        Y02668 01200002
*********************************************************************** 01230002
         TM    AOSW1,AOVFBSW       CREATED MSG INDICATED       @YA00069 01240003
         BO    GM200               YES.  GO TO PROCESS MSG     @YA00069 01250003
         LTR   R2,R2               MSG OR STMT TO BE ISSUED?     Y02668 01260002
         BZ    GM200               STMT.  BYPASS WTO CODE        Y02668 01290002
         TM    SWI,WAWRNWTO        HAS A WARNING WTO BEEN ISSUED Y02668 01320002
         BO    GM200               YES.  GO TO PROCESS MSG       Y02668 01350002
         TM    AOSW4,AOWRNREQ      IS WARNING REQUESTED?       @G29AN2E 01360003
         BO    GM150                                           @G29AN2E 01370003
         LA    R6,GWRNKEYS         GET KEY TABLE ADDRESS         Y02668 01380002
         LA    R8,GWKEYLTH         GET TABLE LENGTH              Y02668 01410002
GM100    DS    0H                                                Y02668 01440002
         CLM   R2,1,0(R6)          IS THIS A WARNING KEY?        Y02668 01470002
         BE    GM150               YES ISSUE WARNING WTO         Y02668 01500002
         LA    R6,1(R6)            NO  INCREMENT TABLE POINTER   Y02668 01530002
         BCT   R8,GM100            DECREMENT AND SEARCH TABLE    Y02668 01560002
         B     GM200               NOT A WARNING MESSAGE -       Y02668 01590002
*                                  GO TO PROCESS MESSAGE         Y02668 01620002
GM150    DS    0H                                                Y02668 01650002
*********************************************************************** 01680002
*        ISSUE WARNING WRITE TO OPERATOR                         Y02668 01710002
*********************************************************************** 01740002
         IEFSAVER   ,              SAVE AREA FOR IEFVHR          Y02668 01790002
         TM    AOSW4,AODFWMSG     WRN MSG ISSUED TO CONSOLE?    YM00398 01800002
         BO    GM160               YES, DO NOT ISSUE AGAIN      YM00398 01810002
         LA    R5,IEF677I          GET WARNING MESSAGE KEY       Y02668 01830002
         L     RF,IEFVHRV          GET IEFVHR ADDRESS            Y02668 01860002
         BALR  RE,RF               GO TO PUT OUT WTO             Y02668 01890002
         OI    AOSW4,AODFWMSG     CONSOLE WRN MSG ISSUED        YM00398 01900002
GM160    DS    0H                                               YM00398 01910002
         IEFRELSE   ,              RELEASE IEFVHR SAVE AREA      Y02668 01940002
         TM    AOSW4,AOWRNREQ      IS WARNING REQUESTED        @G29AN2E 01950003
         BZ    GM200               NO, GO PROCESS MSG          @G29AN2E 01960003
         NI    AOSW4,X'FF'-AOWRNREQ TURN OFF WARNING REQ FLAG  @G29AN2E 01970003
         XR    R2,R2               CLER WORK REG               @G29AN2E 01980003
         TM    AOSW4,AOMSGTXT      HAS TEXT ALSO BEEN PASSED?  @G29AN2E 01990003
         BO    GM230               YES, GO PROCESS TEXT        @G29AN2E 02000003
         B     GM600               GO EXIT                     @G29AN2E 02010003
*                                                                       02020000
*                                                                       02040000
*********************************************************************** 02060000
*             ENTRY DETERMINATION                                       02080000
*             WORK AREA PREPARATION                                     02100000
*             .R2 CONTAINS MESSAGE NO. OF SECONDARY MESSAGE      OR     02120000
*             .R2 EQUAL ZERO AND R9 CONTAINS STATEMENT PTR              02140000
*             .R6 CONTAINS ADDR OF WORK BUFFER                          02160000
*********************************************************************** 02180000
GM200    EQU   *                                                        02200000
         TM    AOSW4,AOMSGTXT      IS TEXT PASSED?             @G29AN2E 02203003
         BO    GM230               YES - CHECK MSG LEN         @G29AN2E 02206003
         L     R1,WAMSGBUF         GET WORK AREA ADDRESS         Y02668 02210002
         MVI   0(R1),C' '          BLANK OUT                     Y02668 02246002
         MVC   1(159,R1),0(R1)     WORK BUFFER                   Y02668 02252002
         LR    R6,R1                   SAVE BUFFER PTR                  02260000
         LR    R8,R1                   SAVE ADDR BUFFER                 02280000
         TM    AOSW1,AOVFBSW       CALLED BY VFB?                Y02668 02286002
         BO    AOEPCVT             YES, GO TO MOVE STMT #        Y02668 02292002
GM210    LTR   R2,R2                   TEST FOR MESSAGE          Y02668 02300002
         BZ    GM400                   BCH ON STATEMENT ENTRY           02320000
         L     R7,CTRLWAP          MESSAGE ENTRY-GET SEC MESSAGE        02340000
         USING AWA,R7                                                   02360000
         L     R9,TEXTBUFP         ADDR OF TEXT STRING.          Y02668 02380002
         USING TEXT,R9             PREFIX ADDRESSABILITY.        Y02668 02382002
         TM    STRINDCS,PROCSTR    PROC STATEMENT?               Y02668 02384002
         BZ    GM225               BRANCH NO.                    Y02668 02386002
         DROP  R9                                                Y02668 02388002
         CLI   MSGKEY,EXECK       IS EXECK IN MSGKEY?            A32755 02394020
         BNE   GM225              TRANSFER IF MSGKEY NOT EXEC.   A32755 02396020
         MVI   MSGKEY,INTKEY3     MOVE PROC KEY INTO MSGKEY.     A32755 02398020
GM225    DS    0H                                                A32755 02398420
         SR    R9,R9               CLEAR SEC MSG NUMBER REG.     Y02668 02399202
         IC    R9,MSGKEY               LOCATE SECONDARY MSG NO          02400000
         DROP  R7                                                       02420000
         B     AOEPCVT            SKIP TO MOVE STMT #          @G29AN2E 02420803
GM230    DS    0H                                              @G29AN2E 02421603
         L     R1,WAMSGBUF        GET ADDR OF MSG BUFFER       @G29AN2E 02422403
         LR    R8,R1              SAVE ADDR                    @G29AN2E 02423203
         XR    R7,R7              CLEAR WORK REG               @G29AN2E 02424003
         CH    R7,AOMSGLO(R1)     IS LENGTH OF MSG>0           @G29AN2E 02424803
         BE    GM600              NO, GO EXIT                  @G29AN2E 02425603
         LA    R7,MAXLEN          STORE MAX ALLOWABLE MSG LEN  @G29AN2E 02426403
         CH    R7,AOMSGLO(R1)     IS MSG LONGER THAN MAX       @G29AN2E 02427203
         BNH   GM235              YES, ASSUME MAX LENGTH       @G29AN2E 02428003
         ICM   R7,B3,AOMSGLO(R1)  NO, GET ACTUAL LENGTH        @G29AN2E 02428803
GM235    DS    0H                                              @G29AN2E 02429603
         LA    R7,AOSTMTLT(R7)     GET TOTAL LENGTH TO WRITE   @G29AN2E 02430403
         LA    RE,L160             GET LENGTH OF BUFFER        @G29AN2E 02431203
         SR    RE,R7               GET TOTAL BLANKS NEEDED     @G29AN2E 02432003
         LR    RF,R1               GET ADDR OF BUFFER          @G29AN2E 02432803
         AR    RF,R7               GET ADDR OF FIRST BLANK     @G29AN2E 02433603
         MVI   VGM0(RF),C' '       MOVE FIRST BLANK            @G29AN2E 02434403
         BCTR  RE,0                GET NUMBER LEFT TO DO       @G29AN2E 02435203
         BCTR  RE,0                DECREMENT FOR MOVE          @G29AN2E 02436003
         EX    RE,MVCBLANK         BLANK OUT REST OF BUFFER    @G29AN2E 02436803
         MVI   VGM0(R1),C' '       BLANK OUT FIRST CHAR        @G29AN2E 02437603
         MVC   VGM1(VGM9,R1),VGM0(R1) BLANK OUT NEXT 9 CHARS   @G29AN2E 02438403
*                                                                Y02668 02440002
* MOVE IN STMT # FOR THIS MESSAGE                                Y02668 02441002
*                                                                Y02668 02442002
         SPACE 2                                                 Y02668 02443002
AOEPCVT  DS    0H                                                Y02668 02444002
         LH    R4,WASTMTNO         GET NUMBER OF THIS STMT       Y02668 02445002
         CVD   R4,AOEPWORK         CONVERT TO DECIMAL            Y02668 02447002
         UNPK  0(5,R8),AOEPWORK(8) UNPACK STMT# TO MSG BUFFER    Y02668 02448002
         OI    4(R8),X'F0'         CHANGE SIGN TO ZONE           Y02668 02449002
         LR    R4,R8                                             Y02668 02450002
AOEPCVT1 DS    0H                                                Y02668 02451002
         CLI   0(R4),X'F0'         CHECK FOR LEADING ZERO        Y02668 02452002
         BNE   AOEPCVT2            BRANCH IF NO                  Y02668 02453002
         MVI   0(R4),C' '          CHANGE LEADING ZERO TO BLANK  Y02668 02454002
         LA    R4,1(R4)            POINTS TO NEXT BYTE           Y02668 02455002
         B     AOEPCVT1            BRANCH TO CHECK AGAIN         Y02668 02456002
AOEPCVT2 DS    0H                                                Y02668 02457002
         TM    AOSW4,AOMSGTXT      IS TEXT PASSED?             @G29AN2E 02457303
         BO    GM355               YES, GO CHECK HEADER        @G29AN2E 02457603
         LA    R7,AOSTMTLT         R7=STMT # LENGTH              Y02668 02458002
         LA    R8,0(R7,R8)         ADJUST PTR INTO BUFFER        Y02668 02459002
         SR    R4,R4         PRIMARY MESSAGE SCAN BEGINS AT BEGINNI0725 02460000
*                            OF TABLE                              0725 02480000
         TM    AOSW1,AOVFBSW       FROM VFB?                     Y02668 02481002
         BZ    GM300               NO, BRANCH AROUND             Y02668 02482002
         IC    R4,IWAMSLEN         GET MSG LENGTH                Y02668 02483002
         LR    R3,R9               SAVE PTR                      Y02668 02484002
         NI    AOSW1,255-AOVFBSW   TURN OFF VFB SWITCH           Y02668 02485002
         LA    R2,VFBMSG           IND MSG TO PUT ROUTINE        Y02668 02485502
AOEP0235 DS    0H                                                Y02668 02486002
         AR    R7,R4               ADD LENGTHS                   Y02668 02487002
         BCTR  R4,0                DECREMENT BY 1 FOR MOVE       Y02668 02488002
         EX    R4,MVC3             EXECUTE MOVE                  Y02668 02489002
         B     GM350                                             Y02668 02490002
GM250    EQU   *                                                        02520000
         LTR   R9,R9                   TEST FOR SECOND MSG              02540000
         BZ    GM350          BCH ON NO SECONDARY MSG FOUND             02560000
         LR    R2,R9                 RESET FOR SECOND MSG               02580000
         LA    R4,KEFAC      SECONDARY MESSAGE SCAN BEGINS AT MIDDLE725 02600000
*                            OF TABLE                              0725 02620000
         XR    R9,R9                  FLAG END OF MSGS                  02640000
*                                                                       02680000
*********************************************************************** 02700000
*********************************************************************** 02720000
*             ERROR MESSAGE PROCESSING-                                 02740000
*             THERE EXIST 2 POSSIBLE MESSAGES-PRIMARY MSG NO. IS IN THE 02760000
*             REG 2-SECONDARY MSG NO. IN IWA UNDER LABEL MSGKEY.        02780000
*             PRIMARY MSG IS LOCATED AND INSERTED INTO THE BUFFER AREA  02800000
*             THEN THE SECONDARY MSG IS LOCATED,INSERTED INTO THE       02820000
*             BUFFER,AND THE 2 MSG LENGTHS ARE TOTALLED AND INSERTED    02840000
*             IN FRONT OF COMPLETED MESSAGE.                            02860000
*             .R2 CONTAINS MSG NUMBER -SEARCH ARGUMENT                  02880000
*             .R3 SCANS TABLE OF MSG MOD AND MSGS WITHIN PARTICULAR     02900000
*              MODULE -ENDS POINTING TO LENGTH CHARACTER OF MSG DESIRED 02920000
*             .R4  ON ENTRY TO TABLE SCAN ROUTINE POINTS TO RELATIV0725 02940000
*              START LOCATION WHERE SCAN IS TO BEGIN. PRIMARY MESSA0725 02960000
*              START AT THE BEGINNING -SECONDARY MESSAGES START AT 0725 02980000
*              MIDDLE. THEN  REG4  IS ZEROED TO BE USED            0725 03000000
*             .R4 USED TO INCREMENT SCANNING REG                        03020000
*             .R5 HOLDS ADDR OF SYMBOLIC NAME OF MSG MODULE LOADED      03040000
*              TO DELETE LATER                                          03060000
*             .R6 POINTS TO BUFFER AREA                                 03080000
*             .R8 USED TO PUT MSG IN START OF BUFFER -FIRST MSG         03100000
*                             OR     MIDDLE OF BUFFER-SECOND MSG        03120000
*             .R9 HOLDS SECOND MSG NO. DURING PROCESSING OF PRIMARY     03140000
*              MSG                                                      03160000
*********************************************************************** 03180000
GM300    EQU   *                                                        03200000
         LA    R3,GMT1                 TABLE ADDR                       03220000
         ALR   R3,R4               ADJUST TO STARTING POINT       19874 03240019
         SR    R4,R4                                                    03260000
GM305    EQU   *                                                        03280000
         IC    R4,0(R3)                HI NO. OF MODULE                 03300000
         CR    R2,R4                   MESSAGE IN THIS MODULE           03320000
         BNH   GM320               YES, LOAD MODULE               19874 03350019
GM310    EQU   *                                                        03380000
         LA    R3,2(R3)                TEST NEXT NO.                    03400000
         CLI   0(R3),X'00'         IS IT END OF TABLE              0725 03420000
         BNE   GM305            BCH ON NO                          0725 03440000
         B     GM350          GO PUT OUT PRIMARY ONLY              0725 03460000
GM320    EQU   *                                                        03480000
         SR    R4,R4                   SETUP TO LOAD MSG MOD            03500000
         IC    R4,1(R3)                POSITION OF MOD VCON IN TABLE    03520000
         LA    R3,GMT2                 TBL OF VCONS                     03540000
         AR    R3,R4                   PLUS POSITION OF PARTIC MOD      03560000
         LR    R0,R3                   SETUP TO LOAD                    03580000
         LR    R5,R3                   SAVE ADDR OF SYMBOLIC MODULE     03600000
         LOAD  EPLOC=(0)                                                03620000
         LR    R3,R0                   LOCATION OF ENTRY PT             03640000
*                                                                       03660000
*********************************************************************** 03680000
*             SCAN MESSAGES IN MODULE FOR PARTICULAR MESSAGE NO.        03700000
*             .FORMAT OF MESSAGE-1 BYTE MESSAGE NO                      03720000
*                                1 BYTE LENGTH OF MESSAGE               03740000
*                                MESSAGE                                03760000
*********************************************************************** 03780000
GM330    EQU   *                                                        03800000
         SR    R4,R4                                                    03820000
         CLI   0(R3),X'FF'                                              03840000
         BE    GM339               BCH NO MSG FOUND                     03860000
         IC    R4,0(R3)                MESSAGE NO.                      03880000
         CR    R2,R4                   IS THIS THE MESSAGE              03900000
         BE    GM340                   BCH  ON  YES                     03920000
         IC    R4,1(R3)                NO-LENGTH OF MSG                 03940000
         LA    R3,2(R4,R3)    ADJUST TO POINT TO NEXT MSG               03960000
         B     GM330                                                    03980000
*                                                                       04000000
GM339    EQU   *                                                        04020000
         LR    R0,R5          SETUP TO DELETE MSG MODULE                04040000
         DELETE EPLOC=(0)                                               04060000
GM3395   EQU   *             EXIT POINT                            0725 04080000
         LR    R3,R6          ADDR OF BUFFER TO FREE                    04100000
         B     GM600             EXIT FROM ROUTINE                      04120000
*********************************************************************** 04140000
*             MESSAGE FOUND                                             04160000
*             .MOVE MSG INTO BUFFER+1                                   04180000
*             .SAVE MSG LENGTH IN REG7                                  04200000
*             .TEST END OF MESSAGES-REG1 IS ZERO                        04220000
*             .DELETE MODULE AND RESCAN FOR SECOND MSG                  04240000
*             .R3 POINTS TO MSG                                         04260000
*             .R7 TOTALS LENGTH OF BOTH MSGS                            04280000
*             .R8 BUFFER ADJUST REG TO INSERT MSGS                      04300000
*********************************************************************** 04320000
GM340    EQU   *                                                        04340000
         IC    R4,1(R3)                LENGTH OF MSG                    04360000
         LA    R3,2(R3)                POINTS TO MSG CONTENT            04380000
         CLI   0(R3),C' '          IS THIS SECOND LINE OF MSG    Y02668 04383002
         BNE   GM345               BRANCH NO                     Y02668 04386002
         MVI   0(R6),C' '          BLANK OUT STMT #              Y02668 04389002
         MVC   1(5,R6),0(R6)       ALREADY IN THE BUFFER         Y02668 04392002
GM345    DS    0H                                                Y02668 04395002
         AR    R7,R4                   TOTAL LENGTH                     04400000
         BCTR  R4,0                    DECREMENT COUNT ONE FOR EXEC MVC 04420000
         EX    R4,MVC3                 MOVE MSG INTO BUFFER             04440000
         LR    R0,R5                   ADDR OF SYMBOLIC NAME TO DELETE  04460000
         DELETE EPLOC=(0)                                               04480000
         LTR   R9,R9                    TEST END OF MSGS                04500000
         BZ    GM350                   BCH YES                          04520000
         LA    R8,2(R4,R8)         ADJUST PTR INTO BUFFER        Y02668 04540002
         MVI   0(R8),C' '               MOVE IN BLANK FOR SPACING       04560000
         LA    R7,1(R7)                ADJUST LENGTH TO INCLUDE SPACE   04580000
         B     GM250                                                    04600000
MVC3     MVC   0(0,R8),0(R3)                                     Y02668 04620002
GM350    EQU   *                                                        04640000
         LTR   R7,R7        IS THERE A PRIMARY MSG TO PUT OUT      0725 04660000
         BZ    GM3395                BCH NO TO EXIT                0725 04680000
         MVI   0(R6),C' '              BLANK FIRST BYTE          Y02668 04700002
GM355    DS    0H                                              @G29AN2E 04710003
         LA    R5,WAJOBPFX         ADDR OF IWA JOB PFX           Y02668 04720002
         USING TEXT,R5             SET ADDRESSIBILITY TO PFX     Y02668 04730002
         TM    STRJINDC,JTXMHEDR   HAS A HEADER BEEN WRITTEN ?   Y02668 04740002
         BZ    GM700               NO GO TO WRITE HEADER         Y02668 04750002
         DROP  R5                  DROP TEXT BASE                Y02668 04760002
GM360    EQU   *                                                 Y02668 04770002
         TM    AOSW4,AOMSGTXT      IS TEXT PASSED?             @G29AN2E 04771003
         BO    GM365               YES, GO SET UP FOR PUT      @G29AN2E 04772003
         LR    R3,R6               GET MESSAGE ADDRESS           Y02668 04773002
         LA    R4,1(R7)            GET MESSAGE LENGTH            Y02668 04776002
         BAL   R9,GM500            GO TO WRITE MSG               Y02668 04780002
         B     GM600               RETURN TO CALLER              Y02668 04790002
GM365    DS    0H                                              @G29AN2E 04791003
         L     R3,WAMSGBUF         GET ADDR OF BUFFER          @G29AN2E 04792003
         LR    R4,R7               GET LENGTH OF MESSAGE       @G29AN2E 04793003
         BAL   R9,GM500            GO TO WRITE TEXT            @G29AN2E 04794003
         B     GM600               RETURN TO CALLER            @G29AN2E 04795003
*********************************************************************** 04800000
*********************************************************************** 04820000
*             STATEMENT PROCESSING-                                     04840000
*             .INPUT-REG9 PTS TO STATEMENT                              04860000
*              MOVE STATEMENT INTO MESSAGE BUFFER                       04880002
*********************************************************************** 05220000
GM400    EQU   *                                                        05240000
         LR    R3,R6                   ADDR OF BUFFER                   05260000
         SR    R7,R7          CLEAR                                I68  05330018
         IC    R7,IWAMSLEN    PICK UP MESSAGE LENGTH - USUALLY 80  I68  05340018
         LR    R4,R7          PUT LENGTH IN REG 4                Y02668 05360002
         L     R9,AOWSTMT          R9 PTR TO 'WRITE' BUFFER      Y02668 05390002
         BCTR  R7,0                    LESS CT FOR EXEC MVC      Y02668 05400002
         EX    R7,MVC1                 MOVE DATA FIELD           Y02668 05700002
         BAL   R9,GM500            GO TO  WRITE STMT             Y02668 06040002
         B     GM600               RETURN TO CALLER              Y02668 06240002
*                                                                       06440000
**********************************************************************  06460000
*             PUT STATEMENT OR ERROR MESSAGE MESSAGE DATASET            06480002
*             .R3 -PTR TO MESSAGE OR STATEMENT                          06560000
*             .R4 -LENGTH OF MESSAGE OR PACKED STATEMENT                06580000
**********************************************************************  06600000
GM500    EQU   *                                                        06620000
         L     R5,WANELPTR         GET NEL BASE                  Y02668 06640002
         USING NEL,R5              ESTABLISH BASE                Y02668 06648002
         LA    RA,RPLADDR          GET RPL BASE                  Y02668 06656002
         USING IFGRPL,RA           ESTABLISH BASE                Y02668 06664002
         MVI   RPLREQ,RPLPUT       OPERATION TO BE A PUT         Y02668 06672002
         TM    AOSW4,AOMSGTXT      IS TEXT PASSED?             @G29AN2E 06680003
         BO    GM5005                                          @G29AN2E 06682003
         LTR   R2,R2               TEST FOR STMT OR MSG          Y02668 06684003
         BZ    PUTSTMT             GO TO STMT PROCESSING         Y02668 06686003
GM5005   DS    0H                                              @G29AN2E 06688003
         MVC   RPLDACB,NELMSGCB    MOVE IN ACB POINTER           Y02668 06696002
         B     GM551               BRANCH ARROUND TEXT PROC      Y02668 06704002
PUTSTMT  MVC   RPLDACB,NELSTMCB    MOVE ACB POINTER              Y02668 06712002
GM551    ST    R3,RPLAREA          POINTER TO RECORD             Y02668 06720002
         XC    RPLARG(4),RPLARG    ZERO FIELD                    Y02668 06728002
         MVI   RPLOPT1,RPLSEQ      SET TO SEQUENTIAL             Y02668 06736002
         ST    R4,RPLRLEN          STORE RECORD LENGTH.          Y02668 06744002
         XC    RPLBUFL(4),RPLBUFL  ZERO BUFFER LENGTH.           Y02668 06752002
         XC    RPLDDDD(4),RPLDDDD  ZERO RETURN POINTER           Y02668 06760002
         ST    RD,IWASACHN         CHAIN SAVE AREAS              Y02668 06768002
         LA    RD,IWAIOSA          POINT OT ACC. MTHD. SAVE AREA Y02668 06772002
         LR    R1,RA            REG. 1 POINTS TO RPL             Y02668 06776002
         PUT   RPL=(1)                                                  06784002
         L     RD,IWASACHN         RESTORE SAVE AREA POINTER     Y02668 06800002
         TM    AOSW1,AOIOERR       I/O ERROR FROM LIST DATA SET? Y02668 06816002
         BO    ERREXIT             IF YES GO TO IEFVHN           Y02668 06824002
         LTR   RF,RF               CHECK RETURN CODE             Y02668 06832002
         BCR   8,R9                RETURN TO CALLER              Y02668 06840002
**********************************************************************  06848002
*        I/O ERROR MESSAGE HANDLER                               Y02668 06856002
**********************************************************************  06864002
         CLC   RPLDACB,NELMSGCB    I/O ERROR ON MSG DATA SET?    Y02668 06904002
         BE    MSGDSERR            ISSUE MSG ERROR WTO           Y02668 06912002
         LA    R5,4                I/O ERROR MSG CODE            Y02668 06915002
         L     RF,IEFVHRV          GET WTO RTN ADDR              Y02668 06918002
         BALR  RE,RF               GO TO ISSUE MSG               Y02668 06921002
         LA    R2,20               I/O ERROR MSG CODE            Y02668 06924002
         MVI   AOSW1,AOIOERR       SET LIST I/O ERROR IN IWA     Y02668 06928002
         MVC   1(159,R6),0(R6)     ZERO WORK BUFFER              Y02668 06936002
         LR    R8,R6               SET WORK BUFFER POINTER       Y02668 06944002
         B     GM210               GO TO PUT OUT MESSAGE         Y02668 06952002
MSGDSERR DS    0H                                                Y02668 06953002
         LA    R5,5                I/O ERROR MSG CODE            Y02668 06954002
         L     RF,IEFVHRV          GET WTO RTN ADDR              Y02668 06955002
         BALR  RE,RF               GO TO ISSUE MSG               Y02668 06956002
**********************************************************************  06960002
*        EXIT ROUTINE I/O ERROR                                  Y02668 06968002
**********************************************************************  06976002
ERREXIT  DS    0H                                                Y02668 06984002
         MVC   IWARET(2),PGMERROR  SET RETURN CODE IN IWA        Y02668 06992002
         OI    AOSW4,CWATERM       INDICATE TERMINATION          Y02668 07000002
         L     RF,TERMRTN          GET TERMINATION ADDRESS       Y02668 07008002
         BR    RF                  GO TO TERMINATION             Y02668 07016002
IEFVHRV  DC    V(IEFVHR)                                         Y02668 07024002
**********************************************************************  07060000
*             EXIT ROUTINE                                              07080000
*             .FREE CORE BUFFER AREA                                    07100000
*             .RETURN                                                   07120000
**********************************************************************  07140000
GM600    EQU   *                                                        07160000
GM650    EQU   *                                                        07240000
         RETURN (14,12)                                                 07260000
*****************************************************************Y02668 07260802
*   PUT HEADER ROUTINE                                           Y02668 07261602
*****************************************************************Y02668 07262402
GM700    EQU   *                                                 Y02668 07263202
         LA    R3,HEADER           GET HEADER ADDRESS            Y02668 07264002
         LA    R4,HDRLTH           GET HEADER LENGTH             Y02668 07264802
         LA    R8,HDRLINES         GET NUMBER OF LINES TO PRINT  Y02668 07265602
GM750    EQU   *                                                 Y02668 07266402
         BAL   R9,GM500            GO TO PRINT HEADER            Y02668 07267202
         LA    R3,HDRLTH(R3)       GET NEXT LINE ADDRESS         Y02668 07268002
         BCT   R8,GM750            LOOP TO PRINT NEXT LINE       Y02668 07268802
         LA    R3,WAJOBPFX         ADDR OF IWA JOB PFX           Y02668 07269602
         USING TEXT,R3             SET ADDRESSIBILITY TO PFX     Y02668 07270402
         OI    STRJINDC,JTXMHEDR   INDICATE HEADER WRITTEN       Y02668 07271202
         DROP  R3                  DROP TEXT BASE                Y02668 07272002
         B     GM360               RETURN TO PRINT MSG           Y02668 07275202
PGMERROR DC    X'0024'             PGM ERROR RETURN CODE         Y02668 07276002
HEADER   DC    CL17' STMT NO. MESSAGE'                           Y02668 07276802
         DC    CL17'-                '                           Y02668 07277602
MVC1     MVC   0(0,R6),0(R9)                                     Y02668 07280002
MVCBLANK MVC   VGM1(0,RF),VGM0(RF)   BLANK OUT REST OF BUFFER  @G29AN2E 07320003
*********************************************************************** 07360000
*             .A PRIMARY MESSAGE CONTAINS THE IEF6..I  IDENTIFICATION   07380000
*              AND ALWAYS APPEARS FIRST IN THE MESSAGE LINE.            07400000
*              IT DESCRIBES THE ERROR                                   07420000
*             .A SECONDARY MESSAGE DOES NOT HAVE AN IDENTIFICATION. IT  07440000
*              IS ASSOCIATED WITH A PARTICULAR INTERPRETER KEY. IT      07460000
*              ALWAYS FOLLOWS THE PRIMARY MESSAGE IN THE MESSAGE LINE   07480000
*              IT IDENTIFIES THE PARTICULAR PARAMETER FIELD IN ERROR    07500000
*              AND ON WHICH PARTICULAR TYPE JCL STATEMENT THE ERROR     07520000
*              OCCURRED                                                 07540000
*                                                                       07560000
*              PRIMARY MESSAGES ARE IDENTIFIED BY A PARTICULAR INTE0725 07580000
*              NAL MESSAGE NUMBER.  SECONDARY MESSAGES ARE IDENTIFI0725 07600000
*              BY THEIR INTERNAL KEY.                              0725 07620000
*             TWO TABLES ARE USED TO OBTAIN ANY GIVEN MESSAGE NUMBER    07640000
*             .TABLE1 - EACH ENTRY IN GMT1 IS 2 BYTES                   07660000
*              (GMT1)        .FIRST BYTE IS THE HIGHEST MSG NUMBER      07680000
*                                CONTAINED IN THE MODULE LOCATED AT     07700000
*                                A DISPLACEMENT VALUE  INDICATED BY THE 07720000
*                            .THE SECOND BYTE VALUE  WITHIN             07740000
*             .TABLE2 - EACH ENTRY IN GMT2 IS  8 BYTES - THE TABLE IS   07760000
*              (GMT2)  A LIST OF MESSAGE TEXT MODULES                   07780000
*                                                                       07800000
*  NOTES--     PRIMARY MESSAGE NUMBERS ARE LOCATED IN THE FIRST HAL0725 07820000
*              OF THE TABLE GMT1-SCAN BEGINS AT THE BEGINNING.     0725 07840000
*              SECONDARY MESSAGE NUMBERS (KEYS) ARE LOCATED IN THE 0725 07860000
*              LAST HALF-SCAN BEGINS AT THE MIDDLE                 0725 07880000
*                                                                       07900000
*             TABLE INSERTS SHOULD REQUIRE ONLY REASSEMBLY TO CORRECT   07920000
*              POSITION DISPLACEMENTS WITHIN TABLE 2                    07940000
*                                                                       07960000
*********************************************************************** 07980000
*          TABLE 1 -OF HIGH MESSAGE NUMBERS AND THEIR RESPECTIVE MODULE 08000000
*              POSITION DISPLACEMENTS WITHIN TABLE 2                    08020000
GMT1     EQU   *                                                        08040000
         DC    X'07'                                                    08060000
         DC    AL1(M1-GMT2)                                             08080000
         DC    X'0F'                                                    08100000
         DC    AL1(M2-GMT2)                                             08120000
         DC    X'17'                                                    08140000
         DC    AL1(M3-GMT2)                                             08160000
         DC    X'1F'                                                    08180000
         DC    AL1(M4-GMT2)                                             08200000
         DC    X'27'                                                    08220000
         DC    AL1(M5-GMT2)                                             08240000
         DC    X'2F'                                                    08260000
         DC    AL1(M6-GMT2)                                             08280000
         DC    X'37'                                                    08300000
         DC    AL1(M7-GMT2)                                             08320000
         DC    X'3F'                                               0725 08340000
         DC    AL1(M70-GMT2)                                       0725 08360000
         DC    X'50'                                           @ZA19982 08366003
         DC    AL1(M71-GMT2)                                      O106  08372019
         DC    X'00'       END OF PRIMARY MESSAGES                 0725 08380000
GMTK     EQU   *                                                   0725 08400020
         DC    AL1(THRESHMK)                                M3944,M5688 08402020
         DC    AL1(M76-GMT2)                                M3944,M5688 08402420
         DC    AL1(QNAMEK)                                        M3131 08404020
         DC    AL1(M67-GMT2)                                      20002 08408020
         DC    AL1(DUMMK)                                         19874 08420019
         DC    AL1(M78-GMT2)                                       0725 08440000
         DC    AL1(DISPK)                                         19874 08460019
         DC    AL1(M8-GMT2)                                             08480000
         DC    AL1(SEPMK)                                         19874 08500019
         DC    AL1(M9-GMT2)                                             08520000
         DC    AL1(BUFLMK)                                        19874 08540019
         DC    AL1(M10-GMT2)                                            08560000
         DC    AL1(DSORGMK)                                       19874 08580019
         DC    AL1(M11-GMT2)                                            08600000
         DC    AL1(NTMMK)                                         19874 08620019
         DC    AL1(M12-GMT2)                                            08640000
         DC    AL1(DDK)                                           19874 08660019
         DC    AL1(M13-GMT2)                                            08680000
         DC    AL1(RDPEK)                                         19874 08686019
         DC    AL1(M19-GMT2)                                       AAAA 08692015
         DC    AL1(CONDPEK)                                       19874 08702019
         DC    AL1(M14-GMT2)                                            08720000
         DC    AL1(EXECK)                                         19874 08730019
         DC    AL1(M15-GMT2)                                            08743014
         DC    AL1(ROLLJK)                                        19874 08747019
         DC    AL1(M17-GMT2)                                            08752014
         DC    AL1(JOBK)                                          19874 08772019
         DC    AL1(M16-GMT2)                                            08800000
         DC    AL1(INTKEY8)                                   M3738O106 08806019
         DC    AL1(M18-GMT2)                                            08812014
         DC    X'00'                                                    08820000
         DS    0D                                                       08840000
*          TABLE 2 -OF MESSAGE TEXT MODULES                             08860000
GMT2     EQU   *                                                        08880000
M1       DC    CL8'IEFVGM1'   MSG NOS   01   -  07                      08900000
M2       DC    CL8'IEFVGM2'             08   -  0F                      08920000
M3       DC    CL8'IEFVGM3'             10   -  17                      08940000
M4       DC    CL8'IEFVGM4'             18   -  1F                      08960000
M5       DC    CL8'IEFVGM5'             20   -  27                      08980000
M6       DC    CL8'IEFVGM6'             28   -  2F                      09000000
M7       DC    CL8'IEFVGM7'             30   -  37                 0725 09020000
M70      DC    CL8'IEFVGM70'            38   -  3F                 0725 09040000
M71      DC    CL8'IEFVGM71'            40   -  50             @ZA19982 09050003
*             INSERT NEW MODULES OF PRIMARY MESSAGES HERE          0725 09060000
*                                                                  0725 09080000
*             MODULES OF MESSAGES ASSOCIATED WITH  INTERNAL KEYS   0725 09100000
M76      DC    CL8'IEFVGM76'            1B   -  2E             @G32HPPJ 09106003
M67      DC    CL8'IEFVGM67'            2F   -  36          M3944,M5688 09116020
M78      DC    CL8'IEFVGM78'            37   -  3E                19874 09120019
M8       DC    CL8'IEFVGM8'             3F   -  46                19874 09140019
M9       DC    CL8'IEFVGM9'             47   -  4E                19874 09160019
M10      DC    CL8'IEFVGM10'            4F   -  56                19874 09180019
M11      DC    CL8'IEFVGM11'            57   -  5E                19874 09200019
M12      DC    CL8'IEFVGM12'            5F   -  66                19874 09220019
M13      DC    CL8'IEFVGM13'            67   -  6E                19874 09240019
M19      DC    CL8'IEFVGM19'            7E   -  85                19874 09260019
M14      DC    CL8'IEFVGM14'            86   -  8D                19874 09280019
M15      DC    CL8'IEFVGM15'            8E   -  94                19874 09300019
M17      DC    CL8'IEFVGM17'            A5   -  AC                19874 09320019
M16      DC    CL8'IEFVGM16'            AD   -  B4                19874 09340019
M18      DC    CL8'IEFVGM18'            F0   -  F7                19874 09360019
CF0      DC    F'0'                                                     09420000
CF0F     DC    X'0000FFFF'                                              09440000
KEFAC    EQU   GMTK-GMT1      DISPLACEMENT FACTOR TO SCAN KEY MSGS 0725 09460000
*********************************************************************** 09760002
*     WARNING MESSAGE KEY TABLE                                  Y02668 10060002
*********************************************************************** 10360002
GWRNKEYS EQU   *                   BEGINNING OF WRN KEY TABLE    Y02668 10660002
         DC    X'02'               MSG - IEF674I                 Y02668 10960002
         DC    X'04'               MSG - IEF675I                 Y02668 11260002
         DC    X'13'               MSG - IEF676I                 Y02668 11560002
         DC    X'30'               MSG - IEF648I                 Y02668 11860002
         DC    X'37'               MSG - IEF655I                 Y02668 12160002
         DC    X'38'               MSG - IEF681I                 Y02668 12460002
         DC    X'42'               MSG - IEF682I                 Y02668 12760002
         DC    X'4A'               MSG - IEF684I                 Y02668 13060002
         DC    X'4B'               MSG - IEF685I                 Y02668 13360002
         DC    X'50'          MSG - IEF686I                    @ZA19982 13410003
GWKEYEND EQU   *                   END OF WRN KEY TABLE          Y02668 13660002
GWKEYLTH EQU   GWKEYEND-GWRNKEYS   LENGTH OF WARNING KEY TABLE   Y02668 13960002
IEF677I  EQU   1                   WARNING WTO KEY               Y02668 14260002
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 15630002
         END                                                            15640000
