*********************************************************************** 00020002
*                                                                       00028002
*   MODULE NAME= IEFVHL                                                 00036002
*                                                                       00044002
*   DESCRIPTIVE NAME= NULL STATEMENT, OR END OF FILE, PROCESSOR         00052002
*                                                                       00060002
*   COPYRIGHT= N/A                                                      00068002
*                                                                       00076002
*   STATUS= OS/VS2 RELEASE 3                                            00084003
*                                                                       00092002
*   FUNCTION= ENTERED AS A RESULT OF NULL STATEMENT GENERATED BY IEFVHA 00100002
*             AT END OF FILE ON THE JCL DATA SET OR PROCEDURE - MODULE  00108002
*             PERFORMS END OF FILE PROCESSING.                          00116002
*      OPERATION= .CHECKS WHICH INPUT DATA SET REACHED END OF FILE,     00124002
*                  THEN CHECKS THE EOF FLAG FOR THE OTHER. IF EOF IS    00132002
*                  INDICATED FOR BOTH, MODULE SETS THE END OF           00140002
*                  CONVERSION FLAG FOR IEFVHF.                          00148002
*                 .IF EOF HAS BEEN REACHED ONLY ON THE JCL DATA SET,    00156002
*                  FLAGS ARE SET TO CAUSE CONTINUED READING FROM THE    00164002
*                  PROCEDURE LIBRARY.                                   00172002
*                 .IF EOF HAS BEEN REACHED ONLY ON THE PROCEDURE, ALL   00180002
*                  PROCEDURE FLAGS ARE CLEARED TO CAUSE CONTINUED       00188002
*                  READING FROM THE JCL DATA SET.                       00196002
*                                                                       00204002
*   NOTES                                                               00212002
*      CHARACTER CODE DEPENDENCIES= NONE                                00220002
*      DEPENDENCIES= NONE                                               00228002
*      RESTRICTIONS= NONE                                               00236002
*      REGISTER CONVENTIONS=                                            00244002
*                            R9- STATEMENT POINTER                      00252002
*                            RA- STATEMENT PARAMETER LIST POINTER       00260002
*                            RB- BASE REGISTER                          00268002
*                            RC- CWA POINTER                            00276002
*                            RD- SAVE AREA POINTER                      00284002
*      PATCH-LABEL= PATCH                                               00292002
*                                                                       00300002
*   MODULE TYPE= BAL                                                    00308002
*      PROCESSOR= ASSEMBLER                                             00316002
*      ATTRIBUTES= NCAL,LET,LIST,XREF,REFR,RENT                         00324002
*                                                                       00332002
*   ENTRY POINT= IEFVHL                                                 00340002
*      PURPOSE= END OF FILE PROCESSING                                  00348002
*      LINKAGE= BRANCH ON REGISTER                                      00356002
*      INPUT DATA= CONVERTER WORK AREA                                  00364002
*                  RC- POINTS TO CWA                                    00372002
*      REGISTERS SAVED= NONE                                            00380002
*      REGISTER CONTENTS DURING PROCESSING= SEE REGISTER CONVENTIONS    00388002
*      REGISTERS RESTORED= NONE                                         00396002
*                                                                       00404002
*   EXIT - NORMAL= BRANCH TO IEFVHA                                     00412002
*      CONDITIONS= END OF FILE ON JCL DATA SET, A PROCEDURE LIBRARY IS  00420002
*                  STILL BEING READ, AND PROC BUFFER IS TO BE PRIMED    00428002
*      OUTPUT DATA= UPDATED FLAGS IN CWA                                00436002
*      RETURN CODES= NONE                                               00444002
*                                                                       00452002
*   EXIT - NORMAL= BRANCH TO IEFVHEB                                    00460002
*      CONDITIONS= END OF FILE ON JCL DATA SET, A PROCEDURE LIBRARY IS  00468002
*                  STILL BEING READ, AND PROC BUFFER ALREADY CONTAINS A 00476002
*                  JCL STATEMENT TO BE PROCESSED                        00484002
*      OUTPUT DATA= UPDATED FLAGS IN CWA                                00492002
*                   R9- POINTS TO PROCEDURE INPUT BUFFER                00500002
*      RETURN CODES= NONE                                               00508002
*                                                                       00516002
*   EXIT - NORMAL= BRANCH TO IEFVHCB                                    00524002
*      CONDITIONS= END OF FILE ON PROCEDURE AND NO END OF FILE ON       00532002
*                  JCL DATA SET                                         00540002
*      OUTPUT DATA= UPDATED FLAGS IN CWA                                00548002
*                   R9- POINTS TO JCL DATA SET INPUT BUFFER             00556002
*      RETURN CODES= NONE                                               00564002
*                                                                       00572002
*   EXIT - NORMAL= BRANCH TO IEFVHF                                     00580002
*      CONDITIONS= END OF FILE ON BOTH PROCEDURE AND JCL DATA SET       00588002
*      OUTPUT DATA= END OF CONVERSION FLAG SET                          00596002
*      RETURN CODES= NONE                                               00604002
*                                                                       00612002
*   EXIT - ERROR= NONE                                                  00620002
*                                                                       00628002
*   EXTERNAL REFERENCES=                                                00636002
*      ROUTINES= NONE                                                   00644002
*      DATA AREAS= CONVERTER WORK AREA                                  00652002
*      CONTROL BLOCKS= NONE                                             00660002
*      TABLES= NONE                                                     00668002
*      MACROS= IEFVMCWA                                                 00676002
*      ENQUEUE RESOURCES= NONE                                          00684002
*      CHANGE LEVEL= OZ03636                                   @ZA03636 00692003
*                                                                       00700002
*   MESSAGES= NONE                                                      00708002
*                                                                       00716002
*********************************************************************** 00724002
         EJECT                                                          00732002
         IEFCOMWA                                                Y02668 00820002
         IEFCVRWA                                                Y02668 00850002
         EJECT                                                          00880000
IEFVHL   CSECT                                                          00900000
*                                                                A26315 00910019
*                   R9=STMT PTR                                         00920000
*                   RA=STMT PARM PTR                                    00940000
*                   RD=PTR TO CURRENT REG SAVE AREA                     00960000
         BALR  RB,0                                                     00980000
         USING *,RB          *                                          01000000
*****************************************************************Y02028 01022002
* MODULE TRACE CODE - FOR TESTING.                               Y02028 01024002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02028 01026002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02028 01028002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02028 01030002
         DC    C'VHL '             MOD ID USED BY TRACE.         Y02028 01032002
* TRACE RETURNS HERE.                                            Y02028 01034002
*****************************************************************Y02028 01036002
         B     F1                                                       01040000
         MODID BR=NO                                             Y01886 01090001
         DC    C'SPLT'             FUNCTION ID AND               Y02028 01100002
         DC    C'04'     LEVEL NUMBER( STMT # )                  Y02668 01110002
         DC    C'REL3 PTF'        FUNCTION ID AND              @ZA03636 01113003
         DC    C'01'         LEVEL (BAD PROC CLEANUP)          @ZA03636 01115003
F1       DS    0H                                                       01120000
         TM    SWC,IOERR                I/O  ERROR               A26315 01126019
         BO    F23                      BR  YES                  A26315 01132019
         TM    SWE,GPI                  PROC STMT                       01140000
         BO    F2                       BR YES                          01160000
         OI    SWC,NRCV                 NULL STMT RCVD                  01180000
         NI    SWB,255-FRCV             TURN OFF 1ST STMT RCVD          01200000
         TM    SWE,PROC                 PROCEDURE ON                    01220000
         BO    F14                                                      01240000
         TM    SWA,JTOP                 JOB TO PROCESS                  01260000
         BZ    F16                      BR NO                           01280000
         TM    SWA,EOFR                 RDR EOF                         01300000
         BZ    F22                      BR NO                           01320000
         B     F23                                                      01340000
F14      DS    0H                                                       01360000
         OI    SWE,GPI                  PROC STMT ON                    01380000
         NI    SWE,255-POVRD            DD ORIDE OFF                    01400000
         TM    SWE,PRCV                 PRIME PROC BUFF                 01420000
         BO    F15                                                      01440000
         LA    RA,PSTMT                 PROC PARM                       01460000
         L     R9,0(0,RA)               PROC STMT                       01480000
         L     RF,IEFVHEBV         EXIT                          Y02028 01500002
         BR    RF                  TO PRE-SCAN ROUTINE.          Y02028 01520002
F15      DS    0H                                                       01540000
         NI    SWE,255-PRCV             PRIME OFF                       01560000
         OI    SWD,SYMPRC            **SET 1ST ACCESS FLAG              01570014
F16      DS    0H                                                       01580000
         L     RF,IEFVHAV                                               01600000
         BR    RF                  EXIT TO GET STMT                     01620000
F2       DS    0H                                                       01640000
         OI    SWE,PREF                 PROC EOF                        01660000
         TM    SWA,EOFR                 RDR EOF                         01680000
         BO    F23                      BR YES                          01700000
         TM    SWC,NRCV                 RDR NULL RCVD                   01720000
         BO    F22                      BR YES                          01740000
         L     RF,IEFVHCBV         SET EXIT TO VERB ID                  01760000
         B     F231                                                     01780000
F22      DS    0H                                                       01800000
         L     R9,RSTMT                 PTR TO RDR BUFFER               01820000
         OI    AOSW4,CWATERM       INDICATE CONVERSION COMPLETE. Y02668 01840002
         OI    AOSW1,AOPRTSW       TELL VHEB TO PRINT            Y02668 01860002
         L     RE,IEFVHFV          SET VHEB EXIT TO VHF          Y02668 01880002
         L     RF,IEFVHEBV         EXIT TO VHEB WHO IN TURN      Y02668 01900002
         BR    RF                  CALLS VGM WHO EXITS TO VHF    Y02668 01920002
F23      DS    0H                                                       01960000
         OI    AOSW4,CWATERM       INDICATE CONVERSION COMPLETE. Y02668 01980002
         L     RF,IEFVHFV          SET EXIT TO CONTROL ROUTINE.  Y02028 01990002
F231     DS    0H                                                       02000000
         TM    SWE,GPI                 PROC BEING HANDLED      @ZA03636 02003003
         BZ    NOTPROC                 NO                      @ZA03636 02006003
         NI    SWI,255-BLKPRC          RESET BLOCKING SWITCH   @ZA03636 02009003
         MVC   PSTMT(4),IWAINTS4       RESTORE BEGIN OF BUFFER @ZA03636 02012003
NOTPROC  EQU   *                       NOT DOING PROC          @ZA03636 02015003
         LA    RA,RSTMT                 STMT PARM                       02020000
         L     R9,0(0,RA)               RDR STMT                        02040000
         NI    SWE,255-PROC-GPI         PROC & GPI OFF                  02060000
         BR    RF                  EXIT TO VERB ID OR JOB CONTROL C     02080000
IEFVHAV  DC    V(IEFVHA)                GET                             02120000
IEFVHCBV DC    V(IEFVHCB)               VERB ID B                       02140000
IEFVHEBV DC    V(IEFVHEB)          PRE-SCAN ROUTINE.             Y02028 02160002
IEFVHFV  DC    V(IEFVHF)           CONTROL ROUTINE.              Y02028 02170002
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02028 02180002
         END                                                            02200000
