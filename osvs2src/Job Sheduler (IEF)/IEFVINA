*********************************************************************** 00100019
*                                                                     * 00200019
* MODULE NAME - IEFVINA                                               * 00350002
*                                                                     * 00400019
* DESCRIPTIVE NAME - INSTREAM PROCEDURE CONTROL  AND GET ROUTINE      * 00450002
*                                                                     * 00460002
* COPYRIGHT - N/A                                                     * 00470002
*                                                                     * 00480002
* STATUS - OS/VS2 RELEASE 3 PTF                               @ZA03865  00490000
*                                                                     * 00492002
* FUNCTION - READS INSTREAM PROCEDURES FROM THE JCL DATA SET AND CALLS* 00494002
*            A SERIES OF SUBROUTINES TO RECORD THE PRESENCE OF THE    * 00496002
*            PROCEDURE AND TO SAVE IT IN COMPRESSED FORM IN SWA.      * 00498002
*                                                                     * 00500019
* OPERATION -THIS MODULE ACTS AS THE ROUTING ROUTINE FOR INSTREAM     * 00600002
*            PROCEDURES.  IT GETS CORE FOR A PARAMETER LIST (24 BYTES * 00700019
*            AND INITIALIZES IT FOR VARIOUS ROUTINES AND FOR A QMPA   * 00800019
*            AND EXTERNAL PARAMETER LIST.  BOTH PARAMETER LIST AND    * 00900019
*            QMPA ARE FREED BEFORE EXIT FROM THE MODULE.              * 01000019
*                                                                     * 01100019
*            THE MODULE CONSISTS OF A MAIN FLOW AND FIVE SUBROUTINES, * 01200019
*            ONE OF WHICH CONTAINS AN INTERNAL SUBROUTINE.            * 01300019
*                                                                     * 01400019
*            VINAPARM:  THIS SUBROUTINE GETS CORE FOR THE PARAMETER   * 01500019
*            LIST AND INITIALIZES IT FOR IEFVINB AND/OR IEFVINC.        01600019
*                                                                     * 01700019
*            VINAERR:  THIS SUBROUTINE HANDLES ERROR CONDITIONS       * 01800019
*            AND UTILIZES THE INTERNAL SUBROUTINE VINAMSG1 TO WRITE   * 01900002
*            THE   ERROR MESSAGE TO SYSOUT.                           * 02050002
*                                                                     * 03000019
*            THE JOB FAILED BIT IS SET ON  AND CONTROL IS             * 03100002
*            TRANSFERRED TO IEFVHA (PROC) OR THE COMPRESS SUBROUTINE  * 03200019
*            (PEND) TO GET ANOTHER RECORD                             * 03300019
*                                                                     * 03400019
*            VINACONT:  THIS SUBROUTINE PROCESSES THE PROC OR PEND    * 03500019
*            STATEMENT WHICH IS TO BE CONTINUED.  IT SETS A HIGH      * 03600019
*            ORDER BIT TO INDICATE THAT THIS IS A CONTINUED STATEMENT * 03700019
*            AND BRANCHES TO THE SYNTAX SUBROUTINE, VINASYNT.         * 03800019
*                                                                     * 03900019
*            VINAMSG:  THIS ROUTINE UTILIZES AN INTERNAL ROUTINE,     * 04000019
*            VINAMSG1 TO WRITE THE MESSAGE TO SYSOUT IF ONE IS        * 04150002
*            NEEDED.  IT BUILDS A PARAMETER LIST FOR IEZNCODE AND     * 04200019
*            USES IEZNCODE TO COMPRESS THE RECORD.  IT USES IEFVHQ AND  04300019
*            THE SWA MANAGER TO ASSIGN AND WRITE RECORDS TO SWA.      * 04400002
*                                                                     * 04600019
*            VINASYNT:  THIS SUBROUTINE BRANCHES TO IEFVINE TO        * 04700019
*            SYNTAX CHECK THE PROC AND PEND STATEMENTS.  IT TESTS FOR * 04800019
*            COMMON ERROR CONDITIONS.  INVALID LABEL AND DELIMITER    * 04900019
*            ERRORS IN THE COMMENTS FIELD.                            * 05000019
*                                                                     * 05100019
* NOTES - NONE                                                        * 05150002
*     CHARACTER CODE DEPENDENCIES - EBCDIC                            * 05160002
*     DEPENDENCIES - NONE                                             * 05170002
*     RESTRICTIONS - NONE                                             * 05180002
*     REGISTER CONVENTIONS - R11 - BASE REG                           * 05190002
*                            R12 - CONVERTER WORK AREA                * 05192002
*     PATCH-LABEL - PATCH                                             * 05194002
*                                                                     * 05196002
* MODULE TYPE - BAL CSECT                                             * 05198002
*     PROCESSOR - ASSEMBLER                                           * 05198402
*     ATTRIBUTES - REFRESHABLE,PRIVILEGED, KEY 0, PAGEABLE LPA        * 05198802
*                                                                     * 05199202
* ENTRY POINT - IEFVINA FROM IEFVHCB                                  * 05199602
*     PURPOSE - PROCESS INSTREAM PROCEDURE                           *  05199702
*     LINKAGE - BALR                                                  * 05199802
*     INPUT -                                                         * 05199902
*               R12 - PTR TO CONVERTER WORK AREA                      * 05233202
*               R13 - PTR TO REG SAVE AREA                            * 05283202
*     REGISTERS SAVED - R14-R12                                       * 05293202
*     REGISTER CONTENTS DURING PROCESSING -                           * 05295202
*               R0  - WORK REG                                        * 05297202
*               R1  - STATEMENT PTR                                   * 05299202
*               R2  - SUBROUTINE LINKAGE ANDWORK REG                 *  05299602
*               R3  - WORK REG                                        * 05299702
*               R4  - RETURN CODE AND WORK REG                        * 05299802
*               R5  - INPUT STMT PTR AND SUBRTN LINKAGE REG           * 05299902
*               R6  - NEL AND QMPA BASE                               * 05333202
*               R7  - PTR TO INSTREAM WORK AREA                       * 05383202
*               R8  - NEL AND JCT BASE REG                            * 05393202
*               R9  - PTR TO INPUT BUFFER                             * 05395202
*               R10 - LOCAL WORK AREA BASE                            * 05397202
*               R11 - CSECT BASE REG                                  * 05399202
*               R12 - PTR TO CONVERTER WORK AREA                      * 05399602
*               R13 - PTR TO REG SAVE AREA                            * 05399702
*               R14 - LINKAGE REG                                     * 05399802
*               R15 - LINKAGE REG                                     * 05399902
*     REGISTERS RESTORED - R9 AND R10                                 * 05433202
*                                                                     * 05483202
* EXIT - NORMAL - BR 15 TO IEFVHA TO GET NEXT STMT                    * 05493202
*     CONDITIONS - PEND STATEMENT FOUND                               * 05495202
*     OUTPUT - ENTRY MADE IN INSTREAM PROCEDURE DIRECTORY AND         * 05497202
*              ACTUAL PROCEDURE SAVED IN SWA                          * 05499202
*     RETURN CODES - NONE                                             * 05499602
*                                                                     * 05499702
* EXIT-ERROR - BR 15 TO IEFVHA                                        * 05549702
*     CONDITIONS - INCORRECT LABEL FIELD ON PROC OR PEND STMT         * 05599702
*                - EXCESSIVE NUMBER OF INSTREAM PROCEDURES            * 05649702
*                - EOF REACHED WITHOUT FINDING PEND STMT              * 05699702
*                - INVALID CARD IN PROCEDURE                          * 05749702
*     OUTPUT - JOB FAIL BIT SET AND APPROPRIATE ERROR MSG ISSUED      * 05799702
*     RETURN CODES - NONE                                             * 05849702
*                                                                       05859702
* EXIT-ERROR - BR 15 TO IEFVHF                                          05869702
*     CONDITIONS - I/O ERROR READING  FROM JCL DATA SET                 05879702
*     OUTPUT - TERMINATION BIT(CWATERM) SET IN CWA                      05889702
*     RETURN CODES - CWARET INITIALIZED TO 8                            05891702
*                                                                     * 05899702
* EXTERNAL REFERENCES -                                               * 05949702
*     ROUTINES - IEFVHQ, IEFVGM,IEZNCODE, IEFVINB,IEFVINC,IEFVINE     * 05999702
*     DATA AREAS - CONVERTER WORK AREA,INSTREAM WORK AREA,            * 06049702
*                  PARMLIST FOR EXTERNAL RTNS                         * 06099702
*     CONTROL BLOCKS - QMPA,ACB,RPL                                     06149702
*     TABLES - CONVERTER/INTERPRETER KEYS(IEFVKEYS)                   * 06199702
*     MACROS - GET, PUT, GETMAIN, FREEMAIN, IEFSAVER, SAVE, IEFRELSE  * 06249702
*     ENQUEUE RESOURCES - NONE                                        * 06299702
*     CHANGE LEVEL - Y02668,APAR OZ03865                              * 06349700
*                                                                     * 06399702
* MESSAGES -                                                          * 06449702
*            IEF662I INVALID LABEL ON PROC STMT                       * 06499702
*            IEF662I INVALID LABEL ON PEND STMT                       * 06549702
*            IEF663I NO LABEL ON THE PROC STATEMENT                   * 06599702
*            IEF665I EXCESSIVE NUMBER OF INSTREAM PROCEDURES          * 06649702
*                                                                     * 08100019
* MORE DETAILED                                                       * 08150002
* OPERATION - .ADDRESSIBILITY IS ESTABLISHED FOR THE WORK AREA, THE   * 13900002
*              QMPA,  AND THE MODULE                                  * 14000002
*             .A SAVE AREA IS GOTTEN                                  * 14100019
*             . MSGKEY IS STORED FOR THE PROC VERB                    * 14200019
*             .VINASYNT SUBROUTINE IS EXECUTED                        * 14300019
*             .CHECK MADE FOR NO PROCEDURE NAME                       * 14400019
*             . IF AN ERROR EXISTS, CONTROL IS PASSED TO VINAERR TO   * 14500019
*              WRITE THE STATEMENT AND ERROR MSG                      * 14650002
*             .IF NO ERROR EXISTS, THE LENGTH OF THE PROCEDURE NAME   * 14700019
*              IS SAVED                                               * 14800019
*             .A CHECK IS MADE TO SEE IF THIS IS A FIRST INSTREAM     * 14900002
*              PROCEDURE                                              * 15000019
*             .IF IT IS NOT, A PARM LIST IS MADE FOR IEFVINB AND      * 15100019
*              CONTROL IS PASSEDTO IEFVINB TO SEARCH THE DIRECTORY    * 15200019
*              CONTROL IS THEN PASSED TO IEFVINC                      * 15300019
*             . IF THE COUNT FIELD IN THE WORK AREA IS ONE, INDICATING  15400002
*              THAT THIS IS THE FIRST INSTREAM PROCEDURE, THE QMPA IS * 15500002
*              INITIALIZED AND AN ASSIGN DONE.                        * 15600002
*             .A PARM LIST IS GOTTEN AND BUILT FOR IEFVINC AND CONTROL* 15700002
*              IS TRANSFERRED TO BUILD A DIRECTORY ENTRY.             * 15800019
*             .A CHECK IS MADE TO SEE IF TOO MANY PROCEDURES WERE     * 15900019
*              ALREADY ENCOUNTERED.                                   * 16000002
*             . IF THEY WERE, CONTROL IS TRANSFERRED TO VINAERR TO    * 16100019
*              WRITE THE ERROR MESSAGE                                * 16250002
*             . THE NEXT STATEMNET IS READ AND TESTED FOR A PEND      * 16300002
*             .IF NOT A PEND,  THE STATEMENT IS WRITTEN TO SYSOUT AND   16550002
*              THE RECORD IS COMPRESSED AND IF NECESSARY WRITTEN TO   * 16600019
*              SWA .  ANOTHER RECORD IS READ                          * 16700002
*             .IF IT IS  A PEND STATEMENT THE PARAMETER LIST AND SAVE   16800002
*              AREA ARE FREED AND EXIT IS MADE TO IEFVHA              * 16900002
*                                                                     * 17200019
*********************************************************************** 17300019
         EJECT                                                          17400019
         IEFCOMWA                                                Y02668 17500002
         IEFCVRWA                                                Y02668 17550002
         EJECT                                                          17600019
         IEFVMEWA                                                       17700019
         EJECT                                                          17800019
         IEFTXTFT                                                Y02668 18050002
         EJECT                                                          18100019
         IEFQMNGR                                                       18200019
         DCBD  DSORG=(PS)                                               18520019
         EJECT                                                          18540019
         IEFVKEYS                                                       18560019
         EJECT                                                          18580019
         IFGRPL                                                         18584002
         EJECT                                                   Y02668 18585002
         IDARMRCD                                                Y02668 18586002
         EJECT                                                          18588002
NEL      DSECT                                                          18592002
         IEFNEL SUBCOM=C                                                18596002
         EJECT                                                          18600019
WORKAREA DSECT                                                          18700019
         USING WORKAREA,R7                                              18800019
WKTTR    DS    CL4                     POINTER TO NEXT RECORD           18900019
WKQMPAPT DS    CL4                     ADDRESS OF QMPA                  19000019
WKRECORD DS    CL168                   COMPRESSED RECORD                19100019
WKPTR1   DS    CL4                     POINTER TO ITSELF                19200019
WKCT     DS    CL1                     NUMBER OF ENTRIES MADE IN        19300019
WKPTR2   DS    CL3                     HOLDER FOR TTR ASSIGNED FROM     19400019
*                                      THE QUEUE MANAGER          O106  19500019
WKPROCN1 DS    CL8                     PROCEDURE NAME                   19600019
WKTTR1   DS    CL3                     TTR OF FIRST RECORD              19700019
WKPROCN2 DS    CL8                     PROCEDURE NAME                   19800019
WKTTR2   DS    CL3                     TTR OF FIRST RECORD              19900019
WKPROCN3 DS    CL8                     PROCEDURE NAME                   20000019
WKTTR3   DS    CL3                     TTR OF FIRST RECORD              20100019
WKPROCN4 DS    CL8                     PROCEDURE NAME                   20200019
WKTTR4   DS    CL3                     TTR OF FIRST RECORD              20300019
WKPROCN5 DS    CL8                     PROCEDURE NAME                   20400019
WKTTR5   DS    CL3                     TTR OF FIRST RECORD              20500019
WKPROCN6 DS    CL8                     PROCEDURE NAME                   20600019
WKTTR6   DS    CL3                     TTR OF FIRST RECORD              20700019
WKPROCN7 DS    CL8                     PROCEDURE NAME                   20800019
WKTTR7   DS    CL3                     TTR OF FIRST RECORD              20900019
WKPROCN8 DS    CL8                     PROCEDURE NAME                   21000019
WKTTR8   DS    CL3                     TTR OF FIRST RECORD              21100019
WKPROCN9 DS    CL8                     PROCEDURE NAME                   21200019
WKTTR9   DS    CL3                     TTR OF FIRST RECORD              21300019
WKPROCNA DS    CL8                     PROCEDURE NAME                   21400019
WKTTRA   DS    CL3                     TTR OF FIRST RECORD              21500019
WKPROCNB DS    CL8                     PROCEDURE NAME                   21600019
WKTTRB   DS    CL3                     TTR OF FIRST RECORD              21700019
WKPROCNC DS    CL8                     PROCEDURE NAME                   21800019
WKTTRC   DS    CL3                     TTR OF FIRST RECORD              21900019
WKPROCND DS    CL8                     PROCEDURE NAME                   22000019
WKTTRD   DS    CL3                     TTR OF FIRST RECORD              22100019
WKPROCNE DS    CL8                     PROCEDURE NAME                   22200019
WKTTRE   DS    CL3                     TTR OF FIRST RECORD              22300019
WKPROCNF DS    CL8                     PROCEDURE NAME                   22400019
WKTTRF   DS    CL3                     TTR OF FIRST RECORD              22500019
         EJECT                                                          22530019
         EJECT                                                          22600019
IEZPARM  DSECT                         PARAMETER AREA                   22700019
         USING IEZPARM,R1                                               22800019
IEZADDR  DS    CL4                     ADDRESS OF PARAMETER LIST        22900019
IEZUNCOM DS    A                       PTR TO UNCOMPRESSED RECORD       23000019
IEZCOMPR DS    A                       PTR TO NEXT COMPRESSED RECORD    23100019
IEZLEN   DS    H                       LENGTH OF UNCOMPRESSED RECORD    23200019
IEZOUT   DS    H                       LENGTH OF AREA FOR OUTPUT RECORD 23300019
IEZCHAR  DS    C                       CHARACTER CODE OF BLANK          23400019
IEZTYPE  DS    B                       FLAG ASSOCIATED WITH RECORD      23500019
IEZRES   DS    H                       WORK AREA                        23600019
         ORG IEZADDR                                                    23700019
ADDSS    DS    CL4                     ADDRESS OF PARAMETER LIST        23800019
PROCNAME DS    CL8                     PROCEDURE NAME                   23900019
DIRECT   DS    CL4                     ADDRESS OF DIRECTORY             24000019
IWAPTR   DS    CL4                     ADDRESS OF IWA                   24100019
RTCD     DS    CL4                     RETURN CODE FROM VINB            24200019
         EJECT                                                          24300019
IEFVINA  CSECT                                                          24400019
* A 554626-554632, C 554120                                    @ZA01933 24420003
* CODE ADDED NEAR LABEL VINACOMP                               @ZA03865 24430000
BUFLTH   EQU   90                  STMT # + MSG LENGTH           Y02668 24440002
STNLTH   EQU   10                  STMT# LENGTH                  Y02668 24450002
STMTLTH  EQU   BUFLTH-STNLTH       MSG LENGTH                    Y02668 24460002
BLANK    EQU   C' '                                              Y02668 24470002
DISPLID  EQU   7             DISPLACEMENT OF ID IN REMOTE LIST   Y02621 24480002
INSRECID EQU   X'25'         ID FOR INSTREAM RECORDS PUT TO SWA  Y02621 24490002
         SAVE (14,12)                                                   24500019
         BALR  RB,0                                                     24600019
         USING *,RB                                                     24700019
*****************************************************************Y02668 24710002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 24720002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 24730002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 24740002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 24750002
         DC    C'VINA'             MOD ID USED BY TRACE.         Y02668 24760002
* TRACE RETURNS HERE.                                            Y02668 24770002
*****************************************************************Y02668 24780002
         B     VINA000                                                  24800019
         SPACE                                                          24900019
         MODID BR=NO                                             Y01886 24950001
         DC    C'SPLT'                                           Y02668 25050002
         DC    C'06'               LEVEL # (VHA/VINA LOAD MERGE).Y02668 25150002
         DC    C'REL3'              FUNCTION ID AND            @ZA01933 25200003
         DC    C'02'         LEVEL# (IEZPARM INITIALIZATION)   @ZA03865 25250000
         SPACE                                                          25300019
VINA000  DS    0H                                                       25400019
         L     R7,IWAWKBF              ADDRESSIBILITY FOR WORK AREA     25500019
         L     R6,WKQMPAPT             ADDRESS OF IN-STREAM QMPA   3391 25590019
         USING IOPARAMS,R6             FOR QMPA                         25650019
         LA    R8,WAJOBPFX         ADDR OF PSEUDO JOB PFX.       Y02668 25800002
         USING TEXT,R8             PREFIX ADDRESSABILITY.        Y02668 26000002
         IEFSAVER                                                       26200019
         L     R3,PDCBP                ADDRESS OF PROC DCB        19093 26210019
         USING IHADCB,R3                                                26220019
*                                                             M3739O106 26226019
         MVC   IWABPAM(MVTHREE),DCBREAD+DISPLONE SAVE ADDR OF BPAM O106 26232019
         DROP  R3                                                       26290019
         SPACE                                                          26300019
**********************************************************************  26400019
*                                                                    *  26500019
* SYNTAX CHECK PROC AND PEND STATEMENTS                              *  26600019
*                                                                    *  26700019
**********************************************************************  26800019
         SPACE                                                          26900019
         L     RA,CTRLWAP              ADDRESS OF CONTROL AREA          27000019
         MVI   MSGKEY,INTKEY3          SECONDARY MSG IF NEEDED     4360 27100019
         BAL   R2,VINASYNT             SYNTAX CHECKER                   27200019
         SPACE                                                          27300019
         LTR   R4,R4                   TEST FOR EXISTENCE OF PROC NAME  27400019
         BZ    VINAERR                 NO PROC NAME                     27500019
VINA010  DS    0H                                                 4329  27550019
         LR    R3,R4                   LENGTH OF PROC NME               27620019
         BCTR  R3,R0                   DECREMENT FOR MOVE               27700019
         CLI   WKCT,NOENTRY            SEE IF THIS IS THE               27800019
         BNE   VINA130                 IN-LINE PROCEDURE                27900019
         SPACE                                                          28000019
**********************************************************************  28100019
*                                                                    *  28200019
* INITIALIZE CORE FOR THE QMPA AND DO ASSIGN/START                   *  28300019
*                                                                    *  28400019
**********************************************************************  28500019
         SPACE                                                          28600019
VINA020  DS    0H                                                  3391 28660019
         OI    QMPOP,QMASGS            ASSIGN/START                     29000019
         L     R5,RSTMT                ADDRESS OF INPUT BUFFER          29200019
         L     R1,CTRLWAP          GET ADDR OF EXT. PARM. LIST   Y02668 29400002
         ST    R1,QMPCL                ADDRESS OF EXTERNAL PARAMETER    29500019
*                                      LIST                             29600019
VINA025  DS    0H                                                  3391 29650019
         MVI   QMPCM,ASSIGN1           NUMBER OF RECORDS TO ASSIGN      29700019
         L     RF,VIEFVHQ              Q MANAGER INTERFACE              29900019
         BALR  RE,RF                                                    30000019
         L     R1,QMPCL                ADDR OF EXTERNAL PARM LIST  3391 30260019
         MVC   WKPTR1+DISPLONE(MVTHREE),DISPLZER(R1)   TTR RETURNED3391 30320019
         SPACE                                                          30400019
         BAL   R2,VINAPARM             GET CORE FOR PARM LIST, ESTAB-   30500019
         XC    RTCD(MVFOUR),RTCD       RETURN CODE FOR IEFVINB          30600019
         SPACE                                                          30700019
VINA030  DS    0H                                                       30800019
*                                      LIST ADDRESSIBILITY FOR DSECT,   30900019
*                                      BUILD PARM LIST FOR VINB AND/OR  31000019
*                                      VINC                             31100019
         L     RF,VIEFVINC             DIRECTORY BUILD ROUTINE          31300019
         BALR  RE,RF                                                    31400019
         L     R1,IWAPARM              ADDRESS OF PARM LIST             31700019
         L     RF,RTCD                 RETURN CODE FROM IEFVINC         31800019
         LTR   RF,RF                   EXCESSIVE NAMBER OF              31900019
         BNE   VINAERR3                IN-LINE PROCEDURES               32000019
         BAL   R4,VINAMSG              CREATE AN SMB IF NECESSARY       32400019
         SPACE                                                          32800019
VINA040  DS    0H                                                       32900019
         NI    SWZ,X'FF'-CMT           INITIALIZE COMMENT SWITCH F39049 32950020
         BAL   R5,VINAGET               GO TO ACCESS METHOD      Y02668 33000002
         SPACE                                                          33130019
VINA043  DS    0H                                                  3156 33160019
         L     R1,RSTMT                ADDRESS OF INPUT BUFFER          33200019
         LA    R2,VINAEND(R1)          COLUMN 71 OF STMT           3156 33230019
         LA    R4,VINA040              GET ANOTHER REOCRD          3156 33260019
         CLC   DISPLZER(MVTWO,R1),VINASLH SEE IF THE FIRST 2 CHARACTERS 33300019
         BE    VINA045                 CHECK THE VERB                   33400019
         MVC   DISPLZER(MVONE,R1),VINABLNK     MOVE BLANK TO     A35012 33440020
*                                              FIRST BYTE OF     A35012 33480020
*                                              BUFFER            A35012 33520020
         MVC   DISPLONE(MV79,R1),DISPLZER(R1)  AND CLEAR.        A35012 33560020
         MVC   DISPLZER(MV46,R1),VINASLH GENERATE //SYSIN DD *    M3738 33600019
         B     VINA140                  SET DATA FLUSH BUT       A35013 33700020
         SPACE                                                          33800019
VINA045  DS    0H                                                       33900019
         CLI   DISPLTWO(R1),VINASTE    IS THIS A COMMENT STMT     4362  33930019
         BE    VINA072                 CREATE AN SMB             A39049 33960020
         LA    R1,DISPLONE(R1)         BUMP STATEMENT POINTER           34000019
         SPACE                                                          34100019
VINA050  DS    0H                                                       34200019
         LA    R1,DISPLONE(R1)         BUMP STATEMENT POINTER           34300019
         CLI   DISPLZER(R1),INITBLK    TEST FOR A BLANK                 34400019
         BNE     VINA075               LABEL ON STATEMENT               34500019
         SPACE                                                          34600019
VINA060  DS    0H                                                       34700019
         LA    R1,DISPLONE(R1)         BUMP STTEMENT POINTR             34800019
         CR    R2,R1                   END OF STMT                 3156 34830019
         BL    VINACNT0                YES, CHECK FOR CONTINUATIOA39900 34860020
*                                      NULL SO FAR               A39900 34870020
         CLI   DISPLZER(R1),INITBLK    NEXT NON-BLNAK SHOULD BE VERB    34900019
         BE    VINA060                 A  BLANK                         35000019
VINA065  DS    0H                                                 4362  35050019
         SPACE                                                          35100019
         CLC   DISPLZER(MVFIVE,R1),VINAPEND     IS THERE A PEND VERB    35200019
         BE    VINA080                 PEND VERB                        35300019
         CLC   DISPLZER(COMPFIVE,R1),VINAEXEC EXEC VERB?         SM4182 35350001
         BNE   VINA066            BRANCH. NOT AN EXEC CARD.      SM4182 35400001
         LA    R1,DISPLFOR(R1)    BUMP PTR PAST VERB.            SM4182 35450001
VINA068  LA    R1,DISPLONE(R1)    BUMP PTR BY ONE.               SM4182 35500001
         CR    R2,R1              END OF STMT?                   SM4182 35550001
         BL    VINACNT            YES, CHECK FOR CONTINUATION.   SM4182 35560001
         CLI   DISPLZER(R1),INITBLK  CHECK FOR OPERAND.          SM4182 35570001
         BE    VINA068            CONTINUE SCAN FOR NON-BLANK.   SM4182 35580001
         B     VINACNT8           CHECK FOR CONTINUATION.        SM4182 35590001
VINA066  CLC   DISPLZER(COMTHREE,R1),VINADD    DD VERB           SM4182 35600001
         BNE   VINA073                 GET ANOTHER RECORD               35700019
         LA    R1,DISPLTWO(R1)         BUMP POINTER PAST VERB           35800019
         SPACE                                                          35900019
*********************************************************************** 36000019
*                                                                     * 36100019
* CHECK FOR DD * OR DD DATA.  IF EITHER EXIST THE DATA WILL BE FLUSHED  36200019
* BY THE READER/INTERPRETER                                           * 36300019
*                                                                     * 36400019
*********************************************************************** 36500019
VINA070  DS    0H                                                       36600019
         LA    R1,DISPLONE(R1)         BUMP POINTER                     36700019
         CR    R2,R1                   END OF STMT?                3156 36730019
         BL    VINACNT                 YES, CHECK FOR CONTINUATION 3156 36760019
         CLI   DISPLZER(R1),INITBLK    CHECK FOR OPERAND                36800019
         BE    VINA070                 NO OPERAND                       36900019
         SPACE                                                          37000019
         CLC   DISPLZER(COMPTWO,R1),VINAST   COMPARE FOR DD *           37100019
         BE    VINA140                 DD *                             37200019
         CLC   DISPLZER(COMPFIVE,R1),VINADATA    DD DATA                37300019
         BE    VINA150                 DD DATA                          37400019
         CLC   DISPLZER(COMPTWO,R1),VINASTCM   DD *,?             4362  37420019
         BE    VINA140                 SET THE DATA FLUSH BIT     4362  37440019
         CLC   DISPLZER(COMPFIVE,R1),VINADATC  DD  DATA,?         4362  37460019
         BE    VINA150                 SET THE DATA FLUSH BITS    4362  37480019
         B     VINA073                 CONTINUE THE SCAN         A39049 37490020
         SPACE                                                          37500019
VINA072  DS    0H                                                A39049 37550020
         OI    SWZ,CMT                 INDICATE COMMENT CARD     A39049 37560020
         SPACE                                                          37570020
VINA073  DS    0H                                                       37600019
         BAL   R5,VINACNT8             CHECK FOR CONTINUATION           37700019
         SPACE                                                          37900019
VINA075  DS    0H                                                       38000019
         LA    R1,DISPLONE(R1)         BUMP POINTER                     38100019
         CR    R2,R1                   END OF STMT?                3156 38130019
         BL    VINACNT                 YES, CHECK FOR CONTINUATION 3156 38160019
         CLI   DISPLZER(R1),INITBLK    END OF LABEL                     38200019
         BNE   VINA075                 END OF LABEL                     38300019
         SPACE                                                          38320019
VINA078  DS    0H                                                 4362  38340019
         LA    R1,DISPLONE(R1)         BUMP POINTER               4362  38360019
         CR    R2,R1                   END OF STMT?                3156 38366019
         BL    VINACNT                 YES, CHECK FOR CONTINUATION 3156 38372019
         CLI   DISPLZER(R1),INITBLK    BEGINING OF VERB?          4362  38380019
         BE    VINA078                 NO                         4362  38400019
         SPACE                                                          38420019
         CLC   DISPLZER(MVFOUR,R1),VINAJOB   THIS A JOB VERB?     4362  38440019
         BE    VINA120                 XCTL TO IEFVHCB            4362  38460019
         B     VINA065                 CHECK FOR PEND STMT        4362  38480019
         SPACE                                                          38500019
VINA080  DS    0H                                                       38600019
         MVI   MSGKEY,INTKEY6          ON THE PEND STMT            4360 38700019
         L     R1,IWAPARM              ADDRESS OF PARAMETER LIST        38800019
         CLI   IEZLEN+DISPLONE,INPLN    SEE IF RECORD WAS COMPRESS19086 38810019
         BE    VINA085                  PROCEDURE HAD STATEMENTS. 19086 38820019
         LA    R2,WKRECORD              ADDRESS OF WORK RECORD    19086 38830019
         ST    R2,IEZCOMPR              NEXT AVAILABLE BYTE FOR   19086 38840019
*                                       COMPRESSED RECORD         19086 38850019
         SPACE                                                          38860019
VINA085  DS    0H                                                 19086 38870019
         L     R2,IEZCOMPR             ADDRESS OF WHERE EOF MARKER      38900019
*                                      SHOULD GO                        39000019
         XC    DISPLZER(MVTWO,R2),DISPLZER(R2)  EOF MARKER              39100019
         BAL   R2,VINASYNT             SUNTAX CHECKER                   39200019
         SPACE                                                          39300019
VINA090  DS    0H                                                       39400019
         BAL   R5,VINAMSG0             CREATE AN SMB IF NECESSARY       39500019
         LA    R5,VINA096              RETURN FROM QUEUE WRITE   A40299 39550001
*                                      SUBROUTINE TO XCTL TO VHA A40299 39570001
         SPACE                                                          39600019
*********************************************************************** 39700019
*                                                                     * 39800019
* WRITE THE LAST RECORD OF THE PROCEDURE ONTO THE JOB QUEUE           * 39900019
*                                                                     * 40000019
*********************************************************************** 40100019
VINA095  DS    0H                                                 19086 40150019
         XC    WKTTR(MVFOUR),WKTTR     CLEAR TTR OF NEXT RECORD FIELD   40200019
*                                      TO INDICATE END OF PROCEDURE     40300019
         L     RF,VIEFVHQ              ADDRESS OF IEFVHQ                40500019
         MVI   QMPOP,QMWRTE            SET FUNCTION BYTE TO WRITE       40600019
         L     R6,QMPCL                ADDR OF EXTERNAL PARM LIST  3391 40700019
         MVC   DISPLZER(MVFOUR,R6),IWAWKBF  ADDR OF WORK AREA      3391 40800019
         MVC   DISPLFOR(MVTHREE,R6),WKPTR2  TTR OF WHERE RECORD SHOULD  40900019
*                                      GO ON JOB QUEUE             3391 41000019
         MVI   DISPLID(R6),INSRECID  BLOCK ID TO REMOTE LIST     Y02621 41050002
         BALR  RE,RF                   WRITE RECORD ON JOB QUEUE        41100019
         BR    R5                      RETURN TO CALLER          A40299 41450001
         SPACE                                                          41452001
VINA096  DS    0H                                                A40299 41460001
         BAL   R5,VINAEXIT             FREE SAVE AREA AND CORE   A40299 41470001
         SPACE                                                          41480001
VINA100  DS    0H                                                       41500019
         SPACE                                                          42400019
         L     RF,VIEFVHA          ADDR OF GET ROUTINE.          Y02668 42500002
         BR    RF                  BRANCH.                       Y02668 42550002
         SPACE                                                          42600019
VINA120  DS    0H                                                       42700019
         LA    RA,RSTMT                ADDRESS OF PARM LIST       19093 42900019
         L     R9,RSTMT                ADDRESS OF READER BUFFER   19093 43100019
         SPACE                                                          43300019
         BAL   R5,VINAEXIT                                        19093 43500019
         SPACE                                                          43700019
         L     RF,VIEFVHCB         ADDR OF VERB ID ROUTINE.      Y02668 43800002
         BR    RF                  BRANCH.                       Y02668 43850002
         SPACE                                                          43900019
VINA130  DS    0H                                                       44000019
         L     R5,RSTMT                ADDRESS OF BSAM BUFFER           44100019
         BAL   R2,VINAPARM             GET CORE FOR PARM LIST           44200019
         L     RF,VIEFVINB             ADDRESS OF DIRECTORY SEARCH      44300019
*                                      ROUTINE                          44400019
         BALR  RE,RF                                                    44500019
         B     VINA030                 CREATE AN SMB IF ONE IS NEEDED   44600019
         SPACE                                                          44700019
VINA140  DS    0H                                                       44800019
         B     VINA160                 CREATE AN SMB FOR STATEMNT       45000019
         SPACE                                                          45100019
VINA150  DS    0H                                                       45200019
VINA160  DS    0H                                                       45400019
         BAL   R4,VINAMSG              CREATE AN SMB FOR STATEMENT      45500019
         L     R1,IWAPARM               ADDRESS OF PARM LIST      19086 45530019
         L     R2,IEZCOMPR              NEXT AVAILABLE BYTE       19086 45560019
         XC    DISPLZER(MVTWO,R2),DISPLZER(R2) EODAD MARKER       19086 45590019
         LA    R5,VINA096               DON'T RETURN FROM SUBRRTNA40299 45600001
         B     VINA095                  WRITE PROC ON JOB QUEUE   19086 45620019
         EJECT                                                          45650019
         EJECT                                                          45700019
**********************************************************************  45800019
*                                                                    *  45900019
* THIS SUBROUTINE WILL GET CORE FOR A 20 BYTE PARAMETER LIST         *  46000019
* THIS PARAMETER LIST IS USED FOR THE DIRECTORY SEARCH ROUTINE       *  46100019
* IEFVINB, THE DIRECTORY BUILD ROUTINE, IEFVINC AND FOR THE COMPRESS *  46200019
* ROUTINE, IEZNCODE.  THE SUBROUTINE WILL INITIALIZE THE PARM LIST   *  46300019
* TO CONTAIN THE VALUES NEEDED FOR BOTH IEFVINB AND IEFVINC.  THAT IS   46400019
*     BYTES        VALUE                                             *  46500019
*     0-3          ADDRESS OF ITSELF                                 *  46600019
*     4-11         PROCEDURE NAME                                       46700019
*     12-15        ADDRESS OF THE DIRECTORY                          *  46800019
*     16-19        RETURN CODE FOR IEFVINB                           *  46900019
*     20-23        RETURN CODE FROM IEFVINC                          *  47000019
*                                                                    *  47100019
* CONTROL IS TRANSFERRED ON REGISTER 2                               *  47200019
* THIS ROUTINE WILL ESTABLISH ADDRESSIBILITY ON THE DSECT FOR THE    *  47300019
* PARAMETER LIST USED BY IEZNCODE                                    *  47400019
*                                                                    *  47500019
**********************************************************************  47600019
         SPACE                                                          47700019
VINAPARM DS    0H                                                       47800019
         LA    R0,VINACORE             LENGTH OF CORE                   47900019
         GETMAIN R,LV=(0)                                               48000019
         ST    R1,ADDSS                ADDR OF PARM LIST          M4268 48060019
         O     R1,IWAPARM              RETAIN INFO IN HIGH ORDER  M4268 48120019
*                                      BYTE OF FIELD              M4268 48180019
         ST    R1,IWAPARM              ADDR OF PARM LIST          M4268 48240019
         MVI   PROCNAME,INITBLK        CLEAR PROCNAME FIELD             48300019
         MVC   PROCNAME+DISPLONE(MVSEVEN),PROCNAME   TO BLANKS          48400019
         EX    R3,VINAMV2              MOVE PROCNAME TO PARM LIST       48500019
         LA    R3,WKPTR1               ADDRESS OF DIRECTORY             48600019
         ST    R3,DIRECT               ADDRESS OF DIRECTORY             48700019
         ST    RF,RTCD                 RETURN CODE FROM VINB            48800019
         ST    RC,IWAPTR               ADDRESS OF IWA                   48900019
         BR    R2                                                       49000019
         EJECT                                                          49100019
**********************************************************************  49200019
*                                                                    *  49300019
* THIS SUBROUTINE WILL INITIALIZE REGISTER 2 WITH AN ERROR CODE AND  *  49400019
* BRANCH TO A SUBROUTINE WHICH PRINTS THE ERROR MESSAGE.  THE JOB    *  49500019
* FAILED BIT IS SET AND CONTROL RETURNED TO XCTL TO IEFVHA.          *  49600019
*                                                                    *  49700019
**********************************************************************  49800019
         SPACE                                                          49900019
VINAERR  DS    0H                                                       50000019
         MVI   MSGSEC,PRIMARY1         NO PROCEDURE NAME                50100019
         B     VINAERR0                NO PROCEDURE NAME                50200019
         SPACE                                                          50300019
VINAERR2 DS    0H                      LABEL ERROR                      50400019
         MVI   MSGSEC,PRIMARY2         LABEL ERROR                      50500019
         CLI   MSGKEY,INTKEY6          IS  ERROR ON PEND CARD?    M1867 50510001
         BNE   VINAERR0                NO - ONLY ISSUE ERROR MSG  M1867 50520001
         BAL   R5,VINA095              QUEUE RECORDS SHOULD BE...A40299 50550001
*                                      ...WRITTEN FOR THIS ERROR A40299 50560001
*                                      CONDITION TO PREVENT THE  A40299 50570001
*                                      R/I FROM ABENDING WHEN IT A40299 50580001
*                                      EXPANDS THE PROCEDURE.    A40299 50590001
         SPACE                                                          50592001
         B     VINAERR0                LABEL ERROR                      50600019
         SPACE                                                          50700019
         SPACE                                                          51100019
VINAERR3 DS    0H                                                       51200019
         MVI   MSGSEC,PRIMARY4         EXCESSIVE NUMBER OF PROCS        51300019
         MVI   MSGKEY,DISPLZER         CLEAR SECONDARY MSG KEY          51400019
         SPACE                                                          51500019
VINAERR0 DS    0H                      ERROR                            51600019
         BAL   R5,VINAMSG0         CREATE AN SMB                  19085 51900019
         SPACE                                                          52200019
         XR    R2,R2                   INSERT PRIMARY MSG CODE          52400019
         IC    R2,MSGSEC               FOR ERROR MESSAGE                52500019
         BAL   R5,VINAMSG1             CREATE SMB FOR ERROR MSG         52600019
         OI    STRJINDC,JTXJOBFL   SET JOB FAILED BIT.           Y02668 52700002
         DROP  R8                                                Y02668 52720002
         L     R2,IWAPARM              ADDRESS OF PARM LIST       19093 52750001
         LTR   R2,R2                   PARM LIST GOTTEN?          19093 52760001
         LA    R5,VINA100              XCTL TO IEFVHA             19093 52810001
         BZ    VINAEXT1                PARMLIST WASN'T GOTTEN     19093 52820001
         B     VINAEXIT                FREE CORE FOR PARM LIST    19093 52870001
         EJECT                                                          53200019
VINACNT0 DS    0H                                                A39900 53210020
         CLI  DISPLONE(R2),INITBLK     IS THIS TRULY A NULL      A39900 53220020
*                                      STATEMENT                 A39900 53260020
         BNE  VINACNT1                 NO, IT HAS CONTINUATION   A39900 53270020
         BAL  R5,VINAMSG0              GO TO WRITE OUT NULL      A39900 53280020
         B    VINA120                  XCTL TO IEFVHCB AS FOR    A39900 53290020
*                                      JOB CARD                  A39900 53292020
VINACNT  DS    0H                                                       53300019
         CLI   DISPLONE(R2),INITBLK    IS THIS STMT CONTINUED      3156 53400019
         BE    VINAMSG                 NO, CREATE AN SMB           3156 53500019
*  CONTINUATION ON STATEMENT                                      3156* 53600019
         SPACE                                                          53700019
VINACNT1 DS    0H                                                  3156 53800019
         BAL   R4,VINAMSG              CREATE AN SMB               3156 53900019
         SPACE                                                          53950020
         TM    SWZ,CMT                 IS A COMMENT CARD BEING   A39049 53960020
*                                      PROCESSED?                A39049 53962020
         BO    VINA040                 RETURN TO MAINLINE PROCES.A39049 53970020
         SPACE                                                          53980020
         BAL   R5,VINAGET               GO TO ACCESS METHOD      Y02668 54000002
         L     R1,RSTMT                ADDR OF INPUT BUFFER      Y02668 54100002
         LA    R2,VINAEND(R1)          POINTER TO COLUMN 71        3156 54300019
         LA    R1,MVTHREE(R1)          INCREMENT TO COLUMN 4 WHERE 3156 54400019
*                                      CONTINUATION CAN BEGIN      3156 54500019
         SPACE                                                          54600019
VINACNT3 DS    0H                                                  3156 54700019
         CLC   DISPLZER(MVFIVE,R1),VINAPEND   IS THIS A PEND COMMENT    54800019
         LA    R4,VINA040              GET ANOTHER RECORD          3156 54900019
         BE    VINACNT                 YES, CHECK FOR CONTINUTAION 3156 55000019
         LA    R1,DISPLONE(R1)         INCREMENT POINTER           3156 55100019
         CR    R2,R1                   END OF 2TATEMENT?           3156 55200019
         BL    VINA043                 YES, SC1N STATEMENT         3156 55300019
         B     VINACNT3                CHECK FOR PEND COMMENT      3156 55400019
VINACNT8 DS    0H                                                       55402019
         XR    R3,R3                                               3157 55404019
VINACT10 DS    0H                                                  3157 55406019
         CLI   DISPLZER(R1),VINAQUOT   CHECK FOR LITERAL           3157 55408019
         BNE   VINACT16                NOT A LITERAL               3157 55410019
         CLI   DISPLONE(R1),VINAQUOT   CHECK FOR A LITERAL     @ZA01933 55412003
         LA    R5,VINACT10             ONLY ONE QUOTE, A LITERAL   3157 55414019
         BE    VINACT14                NOT A LITERAL               3157 55416019
*****  QUOTE INDICATES A LITERAL, SET SWITCH                      3157* 55418019
         SPACE                                                          55420019
         LTR   R3,R3                   END OR BEGINNING OF LITERAL 3157 55422019
         LA    R5,VINACNT8             CLEAR LITERAL SWITCH        3157 55424019
         BNZ   VINACT12                END OF LITERAL, CHECK FOR   3157 55426019
*                                      ', ' TO INDICATE CONTIN     3157 55428019
         LA    R3,DISPLONE             START OF LITERAL, SET SW    3157 55430019
         LA    R5,VINACT10             CHECK FOR LITERAL           3157 55432019
         SPACE                                                          55434019
VINACT12 DS    0H                                                  3157 55436019
         LA    R1,DISPLONE(R1)         INCREMENT POINTER           3157 55438019
         SPACE                                                          55440019
VINACT14 DS    0H                                                  3157 55442019
         LA    R1,DISPLONE(R1)         INCREMENT POINTER           3157 55444019
         CR    R2,R1                   END OF STATEMENT            3157 55446019
         BL    VINACNT                 CHECK FOR CONTINUATION      3157 55448019
         BR    R5                      RETURN TO CALLER            3157 55450019
VINACT16 DS    0H                                                  3157 55452019
         LA    R5,VINACT10             CHECK FOR LITERAL           3157 55454019
         LTR   R3,R3                   IS THIS IN A LITERAL?       3157 55456019
         BNZ   VINACT14                IN A LITERAL, CHECK FOR END 3157 55458019
         CLC   DISPLZER(MVTWO,R1),VINACONT      CONTINUATION?      3157 55460019
         BE    VINACNT1                CONTINUATION OF STMT        3157 55462019
         CLI   DISPLZER(R1),INITBLK    CHECK FOR NON-BLANK     @ZA01933 55462603
         BE    VINACNT                 CHECK FOR CONTINUATION  @ZA01933 55463203
         B     VINACT14                INCREMENT POINTER           3157 55464019
         EJECT                                                          55466019
         EJECT                                                          55500019
         EJECT                                                          57000019
**********************************************************************  57100019
*                                                                    *  57200019
* THIS SUBROUTINE CREATES AN SMB IF ONE IS NEEDED.  IT INITIALIZES    * 57300019
* THE PARAMETER LIST FOR IEZNCODE WHEN THE FIRST IN-LINE PROCEDURE IS * 57400019
* ENCOUNTERED.  THE PARAMETER LIST IS MAPPED IN THE DSECT, IEZPARM.   * 57500019
*                                                                     * 57600019
* IT BRANCHES TO IEZNCODE TO COMPRESS THE RECORD AND CHECKS A         * 57700019
* RETURN CODE UPON RETURN.  IF THE OUTPUT AREA IS FULL, IT USES IEFVHQ  57800019
* AND THE QUEUE MANAGER TO ASSIGN A NEW RECORD, AND WRITE THE RECORD  * 57900019
* TO THE JOB QUEUE.  CONTROL IS THEN RETURNED TO IEZNCODE.  WHEN THE  * 58000019
* COMPRESSED RECORD HAS BEEN PLACED IN THE OUTPUT BUFFER, CONTROL IS  * 58100019
* RETURNED TO THE CALLER THROUGH REGISTER 4.                          * 58200019
         SPACE                                                          58300019
*                                                                    *  58400019
**********************************************************************  58500019
VINAMSG  DS    0H                                                       58600019
         LA    R5,VINACOMP             NEXT INSTRUCTION TO BE EXECUTED  58700019
         SPACE                                                          58800019
VINAMSG0 DS    0H                                                       58900019
         TM    IWAJMSGL,AOMSGLV1+AOMSGLV2  MSGLEVEL = 1 OR 2?   YM02706 59000002
         BC    8,0(R5)             NO, RETURN TO CALLER.         Y02668 59100002
         L     R9,RSTMT                ADDRESS OF INPUT BUFFER          59200019
         L     R2,AOWSTMT          R2 PTR TO'WRITE' BUFFER       Y02668 59220002
         MVI   0(R2),BLANK         BLANK OUT BUFFER BEFORE       Y02668 59240002
         MVC   1(BUFLTH,R2),0(R2)  MOVEING STMT IN               Y02668 59260002
         MVC   STNLTH(STMTLTH,R2),0(R9) MOVE STMT INTO BUFFER    Y02668 59280002
**********************************************************************  59300019
*                                                                    *  59400019
* CREATE SMB                                                            59500019
*                                                                    *  59600019
**********************************************************************  59700019
         SPACE                                                          59800019
         XR    R2,R2                   INDICATE NO ERROR MESSAGE        59900019
*                                      AFTER THE FOLLOWING SUBROUTINE   60000019
*                                      WHICH BRANCHES TO IEFVGM TO      60100019
*                                      CREATE SMB'S                     60200019
         SPACE                                                          60300019
**********************************************************************  60400019
*                                                                    *  60500019
* THIS SUBROUTINE USES IEFVGM TO CREATE AN SMB FOR AN ERROR OR A STMT*  60600019
* IT RETURNS CONTROL ON REGISTER 5                                   *  60700019
*                                                                    *  60800019
**********************************************************************  60900019
         SPACE                                                          61000019
VINAMSG1 DS    0H                                                       61100019
         OI    SWA,JTOP                SET JOB TO PROCESS BIT           61200019
         L     RF,VIEFVGM              CREATE                           61300019
         BALR  RE,RF                                                    61400019
         BR    R5                                                       61500019
         SPACE                                                          61600019
VINACOMP DS    0H                                                       61700019
         L     R1,IWAPARM              ADDRESS OF PARAMETER AREA        61800019
         SLL   R1,8                    CLEAR HIGH ORDER BYTE   @ZA03865 61820000
         SRL   R1,8                                            @ZA03865 61840000
         CL    R1,0(0,R1)              CHECK IF INITIALIZED    @ZA03865 61860000
         BNE   VINACOM2                ALREADY INITIALIZED     @ZA03865 61880000
         LA    R5,DISPLFOR(R1)         ADDRESS OF PARAMETER LIST        62100019
         ST    R5,IEZADDR              PARAMETER LIST                   62200019
         LA    R3,INPLN                LENGTH OF INPUT BUFFER           62400019
         STH   R3,IEZLEN                                                62500019
         LA    R3,WKRECORD             ADDRESS OF WORK RECORD           62600019
         ST    R3,IEZCOMPR                                              62700019
         MVI   IEZCHAR,INITBLK         BLANKS TO BE COMPRESSED          62800019
         LA    R3,OUTLN                LENGTH OF OUTPUT BUFFER          62900019
         STH   R3,IEZOUT               AREA                             63000019
         MVI   IEZTYPE,TYPEZER         NOT SPECIAL                      63100019
         SPACE                                                          63200019
VINACOM2 DS    0H                                                       63300019
         MVC   IEZUNCOM(MVFOUR),RSTMT   ADDRESS OF INPUT BUFFER  A34832 63350020
         L     R1,IWAPARM              ADDRESS OF PARAMETER LIST        63400019
         L     RF,VIEZN                ADDRESS OF COMPRESS ROUTINE      63500019
         BALR  RE,RF                                                    63600019
         SPACE                                                          63700019
         LTR   RF,RF                                                    63800019
         BCR   EQU,R4                  RECORD WAS COMPRESSED            63900019
**********************************************************************  64000019
*                                                                    *  64100019
* IF THIS IS A PEND VERB CONTROL IS TRANSFERRED TO VIN015 TO XCTL       64200019
* TO VHA.  FOR ANY OTHER STATEMNT ANOTHER STATEMENT WILL BE READ.       64300019
*                                                                    *  64400019
**********************************************************************  64500019
         SPACE                                                          64600019
         MVI   QMPOP,QMASGN            ASSIGN                           64700019
         L     RF,VIEFVHQ              Q MANAGER INTERFACE              64900019
         BALR  RE,RF                   Q MANAGER INTERFACE              65000019
         L     R2,QMPCL                ADDR OF EXTERNAL PARM LIST  3391 65100019
         MVC   DISPLFOR(MVTHREE,R2),WKPTR2   RECORD ON QUEUE       3391 65200019
         MVC   WKPTR2(MVTHREE),DISPLZER(R2) TTR RETURNED FROM ASSIGN    65300019
         MVC   WKTTR(MVTHREE),DISPLZER(R2) ADDR OF NEXT RECORD IN PROC  65400019
         MVC   DISPLZER(MVFOUR,R2),IWAWKBF CORE ADDR OF WORK BUFFER3391 65500019
         MVI   DISPLID(R2),INSRECID  MOVE BLOCK ID FOR WRITE     Y02621 65550002
         MVI   QMPOP,QMWRTE            WRITE THE RRCORD TO THE Q        65600019
         BALR  RE,RF                                                    65900019
         LA    R2,WKRECORD             REINITIALIZE POINTER TO          66200019
         ST    R2,IEZCOMPR             WHERE NEXT COMPRESSED RECORD     66300019
*                                      SHOULD GO                        66400019
         LA    R2,OUTLN                LENGTH OF OUTPUT BEFFER          66500019
         STH   R2,IEZOUT               LENGTH OF OUTPUT BUFFER          66600019
         B     VINACOM2                COMPRESS THE RECORD              66700019
         EJECT                                                          66800019
**********************************************************************  66900019
*                                                                    *  67000019
* THIS SUBROUTINE BRANCHES TO IEFVINE TO SYNTAX THE PROC OR PEND     *  67100019
* STATEMENTS.  UPON RETURN IT TESTS COMMON ERROR CONDITIONS.         *  67200019
*        IF THE HIGH ORDER BIT OF THE RETURN CODE IS SET A CONTINUA- *  67300019
*        TION IS EXPECTED.  CONTROL IS PASSED TO THE CONTINUATION SUB*  67400019
*        ROUTINE                                                     *  67500019
*                                                                    *  67600019
*        IF THE RETURN CODE IS 12, AN ERROR EXISTS IN THE LABEL FIELD*  67700019
*        CONTROL IS PASSED TO AN ERROR ROUTINE                       *  67800019
*        IF THE RETURN CODE IS 16, AN ERROR EXISTS IN THE USE OF     *  67900019
*        COMMENTS.  CONTROL IS PASSED TO AN ERROR ROUTINE            *  68000019
*                                                                    *  68100019
*        IF NONE OF THESE ERROR EXIST CONTROL IS RETURNED THROUGH    *  68200019
*        REGISTER 2                                                  *  68300019
*                                                                    *  68400019
**********************************************************************  68500019
         SPACE                                                          68600019
VINASYNT DS    0H                                                       68700019
         L     R1,RSTMT                ADDRESS OF INPUT BUFFER          68800019
         L     RF,VIEFVINE             SYNTAX CHECKER                   68900019
         BALR  RE,RF                                                    69000019
         L     R4,DISPL10(RD)          RETURN CODE FROM IEFVINE   4329  69100019
         LA    R3,ERRTEST              CHECK FOR ERROR                  69400019
         CR    R4,R3                   ARE THERE ANY ERRORS?      4329  69500019
         BE    VINAERR2                ERROR IN THE LABEL FIELD         69700019
         BR    R2                      RETURN TO CALLER            O106 69900019
         EJECT                                                          70100019
*********************************************************************** 70300019
*                                                                     * 70500019
*  THIS SUBROUTINE IS THE FIRST PORTION OF THE READER END OF FILE     * 70700019
*  ROUTINE.  IT IS USED ONLY IF THE CONDITION OCCURS IN IEFVINA.  IT  * 70900019
*    SETS THE READER END OF FILE BIT IN IWA AND FREES CORE.       O106* 71100019
*    IT THEN XCTL'S TO IEFVHA TO FINISH CLOSING SYSIN                 * 71400019
*                                                                     * 71700019
*********************************************************************** 71900019
         SPACE                                                          72100019
VINAEOF  DS    0H                                                 19093 72300019
         SPACE                                                          72500019
         OI    IWAPARM,EOFRINPR        SET READER EOF BIT         19093 72700019
         LA    R5,VINA100              XCTL TO IEFVHA             19093 72900019
         SPACE                                                          73100019
VINAEXIT DS    0H                                                 19093 73300019
         SPACE                                                          73500019
         LA    R0,VINACORE             LENGTH OF CORE             19093 73700019
         L     R1,IWAPARM              ADDRESS OF PARM LIST       19093 73900019
         FREEMAIN  R,LV=(0),A=(1)                                       74100019
         XC    IWAPARM+DISPLONE(MVTHREE),IWAPARM+DISPLONE         19093 74300019
*                                      CLEAR PARM LIST POINTER    19093 74500019
         SPACE                                                          74700019
VINAEXT1 DS    0H                                                 19093 74900019
         MVI   MSGKEY,DISPLZER         CLEAR SECONDARY MESSAGE KEY19093 75100019
         SPACE                                                          75300019
         IEFRELSE                                                       75500019
         SPACE                                                          75700019
         BR    R5                      RETURN TO THE CALLER       19093 75900019
*********************************************************************** 76100019
*                                                                     * 76300019
*  THIS SUBROUTINE IS THE FIRST PORTION OF THE SYNAD ROUTINE FOR N      76500019
*  AN I/O ERROR SHOULD IT OCCUR WHILE READING AN INPUT RECORD IN  O106* 76700019
*  LOAD MODULE.  THE I/O ERROR BIT IN THE IWA IS SET, THE EODAD   O106* 76900019
*  AND SYNAD ROUTINE ADDRESSES ARE REPLACED IN THE QAAM DCB, CORE O106* 77100019
*  IS FREED AND CONTROL IS RETURNED TO IEFVHA TO COMPLETE PROCESSING  * 77300019
*  OF THE I/O ERROR                                               O106* 77500019
*                                                                     * 77700019
*********************************************************************** 77900019
         SPACE                                                          78100019
VINASYND DS    0H                                                 19093 78300019
         OI    SWC,IOERR               SET I/O ERROR SWITCH IN IWA19093 78500019
         LA    R5,VINA100              XCTL TO IEFVHA FOR INPUT  A49933 78550001
         B     VINAEXIT                REPLACE DCB ADDRESSES      19093 78700019
VINAGET  DS    0H                                                Y02668 78705002
         LA    R4,RPLADDR               GET ADDRESS OF RPL       Y02668 78710002
         USING IFGRPL,R4                SET BASE FOR RPL         Y02668 78715002
         L     R2,WANELPTR              GET ADDRESS OF NEL       Y02668 78720002
         USING NEL,R2                   SET BASE FOR NEL         Y02668 78725002
         MVI RPLREQ,RPLGET              REQUEST IS A GET         Y02668 78730002
         MVC   RPLDACB,NELJCLCB         SET POINTER TO ACB       Y02668 78735002
         MVC   RPLAREA,RSTMT            SET POINTER TO BUFFER    Y02668 78740002
         XC    RPLARG(4),RPLARG         ZERO UNUSED FIELD        Y02668 78745002
         MVI   RPLOPT1,RPLSEQ           GET IS SEQUENTIAL        Y02668 78750002
         XC    RPLRLEN(4),RPLRLEN       ZERO UNUSED FIELD        Y02668 78755002
         LA    R0,80                    GET BUFFER LENGTH        Y02668 78760002
         ST    R0,RPLBUFL               SET MAXIMUM BUFFER LENTH Y02668 78765002
         XC    RPLDDDD(4),RPLDDDD       ZERO UNUSED FIELD        Y02668 78770002
         DROP  R2                       RELEASE BASE FOR NEL     Y02668 78775002
         ST    RD,IWASACHN         SAVE SAVE AREA POINTER        Y02668 78780002
         LA    RD,IWAIOSA          SAVE AREA FOR ACCESS METHOD   Y02668 78782002
         LR    R1,R4                    POINT TO RPL             Y02668 78785002
         GET   RPL=(1)                                                  78790002
         L     RD,IWASACHN         RESTORE SAVE AREA POINTER     Y02668 78795002
         LTR   RF,RF               CHECK FOR ERROR               Y02668 78820002
         BCR   8,R5                     RETURN NO ERROR          Y02668 78825002
         CLI   RPLRTNCD,RPLLOGER   IS THIS A LOGICAL ERROR ?     Y02668 78826002
         BNE   ERREXIT             NO. GO TO ERROR EXIT          Y02668 78827002
         CLI   RPLERRCD,RPLEODER   IS END OF DATA DETECTED ?     Y02668 78828002
         BE    VINAEOF             YES. GO TO EOF ROUTINE        Y02668 78829002
         DROP  R4                  RELEASE BASE FOR RPL          Y02668 78829502
ERREXIT  DS    0H                                                       78830002
         MVC   IWARET(2),PGMERROR  SET RETURN CODE               Y02668 78835002
         LA    R5,4                I/O ERROR MSG CODE            Y02668 78840002
         L     RF,VIEFVHR               GET POINTER TO IEFVHR    Y02668 78845002
         BALR  RE,RF                    WRITE MSG TO OPERATOR    Y02668 78850002
         LA    R2,20               I/O ERROR MSG CODE            Y02668 78855002
         L     RF,VIEFVGM               GET ADDRESS OF IEFVGM    Y02668 78860002
         BALR  RE,RF                    WRITE OUT ERROR MSG      Y02668 78865002
         L     RF,TERMRTN          GET TERMINATION ADDRESS       Y02668 78870002
         BR    RF                  GO TO TERMINATION             Y02668 78880002
         EJECT                                                          78900019
         DS    0F                                                       79100019
VIEFVINB DC    V(IEFVINB)              ADDRESS OF DIRECTORY SEARCH      79300019
VIEFVINC DC    V(IEFVINC)              ADDRESS OF DIRECTORY BUILD       79500019
VIEFVINE DC    V(IEFVINE)              ADDRESS OF SYNTAX CHECKER        79700019
VIEFVHQ  DC    V(IEFVHQ)               ADDRESS OF Q MANAGER INTERFACE   79900019
VIEFVGM  DC    V(IEFVGM)               ADDRESS OF MESSAGE MODULE        80100019
VIEZN    DC    V(IEZNCODE)             ADDRESS OF COMPRESS ROUTINE      80300019
VIEFVHR  DC    V(IEFVHR)                                                80320002
VIEFVHCB DC    V(IEFVHCB)          ADDRESS OF VERB ID MODULE.    Y02668 80360002
VIEFVHA  DC    V(IEFVHA)           ADDRESS OF GET MODULE.        Y02668 80420002
         SPACE                                                          80500019
VINASTCM DC    C'*,'                   DD    *,   STATEMENT       4362  80700019
VINADATC DC    C'DATA,'                SYSIN  DD  DATA,DCB=       4362  80900019
VINADATA DC    C'DATA '                DD DATA STATEMENT                81100019
VINAPEND DC    C'PEND '                                                 81300019
VINAJOB  DC    C'JOB '                                                  81500019
VINAEXEC DC    C'EXEC '           EXEC STATEMENT                 SM4182 81550001
         SPACE                                                          81700019
VINAMV2  MVC   PROCNAME(0),2(R5)                                        81900019
VINAMOVE MVC   QMNAM(0),2(R5)          PROCNAME TO QMPA                 82100019
         SPACE                                                          82300019
* THE FOLLOWING FIVE DC'S MUST REMAIN IN THIS ORDER.  THEY FORM THE   * 82500019
* GENERATED DD * STATEMENT.                                           * 82700019
VINASLH  DC    X'6161'                 FIRST TWO CHARACTERS OF STMT     82900019
VINASYS  DC    C'SYSIN '               PART OF GENERATED STMT           83100019
VINADD   DC    C'DD '                  DD VERB                          83300019
VINAST   DC    C'* '               OPERAND OF GENERATED STMT            83400019
         DC    C'INSTREAM PROC GENERATED STATEMENT ' COMMENT OF GEN DD  83500019
VINABLNK DC    C' '                     BLANK TO CLEAR READER    A35012 83560020
*                                       BUFFER                   A35012 83620020
         SPACE                                                          83700019
VINAPLUS DC    C'++'                   IN-LINE PROCEDURE                83900019
PGMERROR DC    X'0024'             PGM ERROR CODE (36)           Y02668 84000002
VINACORE EQU   24                      LENGTH OF THE PARAMETER LIST     84100019
QMSYSOUT EQU   X'3'                    DEQUEUE TYPE                     84300019
WORKLN   EQU   352                     LENGTH OF WORK BUFFER       O106 84500019
QMPALN1  EQU   48                      LENGTH OF QMPA              O106 84700019
EOFRINPR EQU   X'40'                   INDICATE END OF READER           84800019
VINAQUOT EQU   C''''                   TEST FOR A LITERAL               84900019
VINACONT DC    C', '                   CHECK FOR CONTINUATION      3157 85000019
VINASTE  EQU   C'*'                    CHECK FOR COMMENT STATEMENT4362  85100019
MVONE    EQU   1                        LENGTH OF MOVE           A35012 85200020
MVTWO    EQU   2                       LENGTH OF MOVE                   85300019
MVTHREE  EQU   3                       LENGTH OF MOVE                   85500019
MVFOUR   EQU   4                       LENGTH OF MOVE                   85700019
MVFIVE   EQU   5                       LENGTH OF MOVE                   85900019
MVSEVEN  EQU   7                       LENGTH OF MOVE                   86100019
MVEIGHT  EQU   8                       LENGTH OF MOVE                   86300019
MV46     EQU   46                                                 M3738 86500019
MV79     EQU   79                       LENGTH OF READER STATE-  A35012 86600020
*                                       MENT MINUS ONE FOR MOVE  A35012 86700020
DISPLZER EQU   0                       DISPLACEMENT                     86900019
DISPLONE EQU   1                       DISPLACEMENT                     87100019
DISPLTWO EQU   2                       DISPLACEMENT                     87300019
DISPL3   EQU   3                       DISPLACEMENT                     87500019
DISPLFOR EQU   4                       DISPLACEMENT                     87700019
DISPL10  EQU   16                      REGISTER 15 IN THE SAVE AREA,    87900019
*                                      RETURN CODE FROM IEFVINE         88100019
DISPL24  EQU   X'24'                   REGISTER 4 IN THE SAVE AREA4329  88300019
COMPTWO  EQU   2                       LENGTH OF COMPARE                88500019
COMTHREE EQU   3                       LENGTH OF COMPARE                88700019
COMPFIVE EQU   5                       LENGTH OF COMPARE                88900019
NOENTRY  EQU   0                       NO IN-LINE PROCEDURES HAVE BEEN  89100019
*                                      ENCOUNTERED YET                  89300019
VINAEND  EQU   70                      END OF STATEMENT            3156 89400019
INPLN    EQU   80                      LENGTH OF INPUT BUFFER FOR       89500019
*                                      IEZNCODE                         89700019
OUTLN    EQU   168                     LENGTH OF OUTPUT BUFFER FOR      89900019
*                                      IEZNCODE                         90100019
TYPEZER  EQU   X'00'                   NOT A SPECIAL RECORD             90300019
EQU      EQU   8                       BRANCH ON EQUAL-RECORD FIT IN    90500019
*                                      THE BUFFER                       90700019
INITBLK  EQU   X'40'                   INITIALIZE QMNAM TO BLANKS       90900019
QMPALN   EQU   36                  LENGTH OF QMPA                       91100019
QMTPYONE EQU   1                       LENGTH OF QMTPY FIELD            91300019
QMTPYF   EQU   15                      DISPLACEMENT INTO QMPA TO        91500019
*                                      QMPTY FIELD                      91700019
ASSIGN1  EQU   X'10'                   NUMBER OF RECORDS TO ASSIGN      91900019
PRIMARY1 EQU   X'3F'                   NO PROCEDURE NAME                92100019
PRIMARY2 EQU   X'3E'                   SYNTAX ERROR                     92300019
PRIMARY4 EQU   X'41'                   EXCESSIVE NUMBER OF PROCEDURES   92700019
HIORDER  EQU   X'80'                   CONTINUATION OF A PEND OR PROC   92900019
*                                      STATEMENT                        93100019
ERRTEST  EQU   12                      TEST FOR ERROR ON PROCEDURE      93300019
*                                      DELIMITERS                       93500019
LENGONE  EQU   1                       NUMBER OF BITS TO SHIFT TO TURN  93700019
*                                      OFF HIGH ORDER BIT               93900019
CLFOUR   EQU   4                       CLEAR PTRS IN IWA          19093 94100019
SYMPARM  EQU   X'40'                   SYMBOLIC PARAMETERS EXIST  4329  94300019
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 94400002
         END                                                            94500019
