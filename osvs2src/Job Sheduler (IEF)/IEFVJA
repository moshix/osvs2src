*********************************************************************** 00020000
*                                                                     * 00040002
*  MODULE NAME= IEFVJA                                                * 00090002
*                                                                     * 00100002
*  DESCRIPTIVE NAME= JOB STATEMENT PROCESSOR                          * 00140002
*                                                                     * 00150002
*  COPYRIGHT= N/A                                                     * 00190002
*                                                                     * 00200002
*  STATUS= OS/VS2 REL. 037 PTF                                @ZA26751* 00240003
*                                                                     * 00260002
*  FUNCTION= THIS IS THE MAIN PROCESSING MODULE FOR A JOB STATEMENT.  * 00290002
*            IT 1. CREATES AND INITIALIZES CONTROL BLOCKS AND         * 00340002
*                  TABLES.                                            * 00390002
*               2. CHECKS VALIDITY OF JOB CARD KEYWORDS, AND IN       * 00440002
*                  SOME CASES THEIR VALUES.                           * 00490002
*               3. SETS JOB-FAIL BIT FOR INVALID KEYWORDS.            * 00540002
*                                                                     * 00550002
*  OPERATION= IT INITIALIZES A JCT FOR A JOB BY SETTING MSGCLASS=A,   * 00590002
*             MSGLEVEL=0, INTERNAL JOB SERIAL NUMBER=1, JCT ID=0,     * 00640002
*             TYPRUN= SETUP AND SETS THE DEFAULT PRIORITY WHICH HAD   * 00690002
*             BEEN SPECIFIED IN THE READER PARMS. IEFVJA ALSO         * 00740002
*             SETS UP A JOB ACCOUNT CONTROL TABLE EVEN IF ACCOUNTING  * 00750002
*             INFORMATION HAS NOT BEEN SPECIFIED. IT INITIALIZES THE  * 00760002
*             NUMBER OF SIOTS SLOT (DDINO) IN THE IWA AND SETS THE    * 00770002
*             FIRST TIME.                                             * 00772002
*             THE PARAMETER DESCRIPTOR TABLE (PDT), USED TO CHECK THE * 00774002
*             FORMAT OF THE KEYWORD IS USED BY THE EXTERNAL ROUTINE   * 00776002
*             IEFVGT TO PROCESS THE KEYWORD VALUE; THE KEYWORD BRANCH * 00778002
*             TABLE (KBT) IS USED BY IEFVGK TO GET THE NEXT KEY.      * 00778402
*             THE INTERNAL TEXT IS THEN PROCESSED BY THE APPROPIATE   * 00778802
*             KEYWORD ROUTINE. IF THE ROUTINE FINDS THE KEYWORD IN-   * 00779202
*             VALID, THE PROCESSING ROUTINE GOES TO THE CLEAN-UP      * 00779602
*             ROUTINE WHICH SETS THE JOB-FAIL BIT IN THE JCT, AND     * 00779702
*             PLACES THE APPROPIATE ERROR MESSAGE IN MSGSEC.          * 00779802
*                                                                     * 00779902
*  NOTES                                                              * 00780002
*      CHARACTER CODE DEPENDENCIES= EBCDIC                            * 00786602
*      DEPENDENCIES= NONE                                             * 00788602
*      RESTRICTIONS= NONE                                             * 00790602
*      REGISTER CONVENTIONS= IWASL (NAME OF AREA IN IWA WHERE         * 00792602
*                            REGISTER CONVENTIONS ARE ESTABLISHED)    * 00793002
*      PATCH LABEL= PATCH                                             * 00793102
*                                                                     * 00794802
*  MODULE TYPE= PROCEDURE                                             * 00798302
*      PROCESSOR= ASSEMBLER                                           * 00800002
*      MODULE SIZE= N/A                                               * 00801902
*      ATTIRBUTES= READ ONLY / REENTRANT / PAGED LPA                  * 00803902
*                                                                     * 00804302
*  ENTRY POINT= IEFVJA                                                * 00805902
*      PURPOSE= MAIN ENTRY POINT                                      * 00806302
*      LINKAGE= BR                                                    * 00806402
*      INPUT DATA= INTERNAL TEXT, IWA, NEL                            * 00806502
*      REGISTERS SAVED= NONE                                          * 00813202
*      REGISTER CONTENTS DURING PROCESSING=                           * 00815202
*              R5 = ERROR MESSAGE CODE REGISTER.                      * 00817202
*              R8 = JCT ADDRESSING.                                   * 00819202
*              R9 = ADDRESS OF TEST AND STORE.                        * 00819602
*              RA = LOCAL AND GET-T+S WORK AREA.                      * 00819702
*              RB = JOB ROUTINE BASE REGISTER.                        * 00819802
*              RC = INTERPRETER WORK AREA.                            * 00819902
*              RD = REGISTER SAVE AREA.                               * 00826502
*              RE = LINK RETURN REGISTER.                             * 00828502
*              RF = ADDRESS OF GET KEY/POS ROUTINE.                   * 00830502
*      REGISTERS RESTORED= NONE                                       * 00832502
*                                                                     * 00832902
*  EXIT - NORMAL= IEFVHE                                              * 00833302
*      CONDITIONS= WHEN PROCESSING OF JOB CARD IS COMPLETE            * 00833402
*      OUTPUT DATA= REGISTERS 12 AND 13 REMAIN UNCHANGED              * 00833502
*      RETURN CODES= NONE                                             * 00835602
*                                                                     * 00836002
*  EXIT - ERROR= IEFVHE                                               * 00837602
*      CONDITION= AFTER AN ERROR HAS BEEN FOUND ON THE JOB CARD       * 00839602
*      OUTPUT DATA= ERROR MESSAGE VIA IEFVGM                          * 00839702
*      RETURN CODES= NONE                                             * 00839802
*                                                                     * 00839902
*  EXTERNAL REFERENCES=                                               * 00845602
*      ROUTINES= IEFVGK,IEFVGT,IEFVGM,IEFVHQ                          * 00847602
*      DATA AREAS= IWA,LWA,NEL                                        * 00849602
*      CONTROL BLOCKS= JCT - C,U,M                                    * 00850002
*                      QMPA - U,M                                     * 00850402
*                      JACT - C,U,M                                   * 00851202
*                      JMR  - U                               @ZA02952* 00851303
*          KEY: C=CREATE, U= USED, M=MODIFY                           * 00854303
*      TABLES= IEFVKEYS (TABLE OF VALID KEYS)                         * 00859103
*      MACROS= IEFVMIWA, IEFVMJWA, IEFAJCTB, IEFQMNGR                 * 00863103
*                                                                     * 00866103
*  MESSAGES= IEF639I - INVALID CLASS DESIGNATION                      * 00871003
*            IEF642I - EXCESSIVE PARAMETER LENGTH                     * 00873003
*            IEF646I - POSITIONAL PARAMETER MISSING                   * 00876803
*            IEF675I - PERFORM VALUE INVALID OR OMITTED - SYSTEM      * 00882603
*                      DEFAULT SUBSTITUTED                            * 00884603
*            IEF676I - PERFORM VALUE UNDEFINED TO SYSTEM - DEFAULT    * 00888403
*                      SUBSTITUTED                                    * 00890403
*                                                                     * 00894203
*   CHANGE LEVEL = OZ02952,OZ04561,OZ25756,OZ26751            @ZA26751* 00894803
*                = Z40RPTH, Z40RPSM, OZ27750                  @ZA27750* 00895003
*                                                                     * 00895403
*********************************************************************** 00896203
*                                                                     * 00900003
         EJECT                                                          00904003
         MACRO                                                          00908003
         KKK   &A,&B,&C,&D                                              00912003
         DC    XL1'&A'            NBR PARAMS THIS KEY.                  00916003
         DC    BL1'&B'       1 MEANS SUBPARAM OK THIS POS.              00920000
         DC    Y(&C)            OFFSET TO KEY PROCESSOR.                00940000
         DC    Y(&D)            OFFSET TO PDT.                          00960000
         MEND                                                           00980000
         MACRO                                                          01000000
         SSS   &A,&B                                                    01020000
         DC    XL1'&A'            NBR CNTRL BYTES/NBR BYTES COMPARE.    01040000
         DC    C'&B'              COMPARE PATTERN.                      01060000
         MEND                                                           01080000
         MACRO                                                          01100000
         MMM   &A,&B,&C                                                 01120000
         DC    FL1'&A'            MAX PARAMETER LENGTH.                 01140000
         DC    XL1'&B'            FUNCT/TABLE.                          01160000
         DC    AL1(&C)            OFFSET IN TABLE.                      01180000
         MEND                                                           01200000
         MACRO                                                          01220000
         DDD   &A,&B,&C,&D                                              01240000
         DC    XL1'&A'            FUNCT/TABLE.                          01260000
         DC    AL1(&B)            OFFSET IN TABLE.                      01280000
         DC    FL&C'&D'           MAX NBR (CVB).                        01300000
         MEND                                                           01320000
         MACRO                                                          01340000
         CCC   &A,&B                                                    01360000
         DC    FL1'&A'            LENGTH OF THIS POSITIONAL PDT.        01380000
         DC    XL1'&B'            NBR CNTRL BYTES/NBR BYTES COMPARE.    01400000
         MEND                                                           01420000
         MACRO                                                          01440000
         BBB   &A,&B,&C                                                 01460000
         DC    XL1'&A'            FUNCT/TABLE.                          01480000
         DC    AL1(&B)          OFFSET IN TABLE.                        01500000
         DC    XL1'&C'            BIT PATTERN.                          01520000
         MEND                                                           01540000
         MACRO                                                          01560000
         BBC   &A,&B,&C                                                 01580000
         DC    XL1'&A'            FUNCT/TABLE.                          01600000
         DC    AL1(&B)            OFFSET IN TABLE.                      01620000
         DC    AL1(&C)            BIT PATTERN.                          01640000
         MEND                                                           01660000
         TITLE 'IEFVJA - NEL'                                           01670001
JANEL    DSECT                                                          01672001
         IEFNEL SUBCOM=I                                         Y02668 01674002
         TITLE 'IEFVJA - KEYS'                                          01675003
         IEFVKEYS                                                       01682003
         TITLE 'IEFVJA - JMR'                                           01689003
         IEFJMR                                                @ZA02952 01696003
         EJECT                                                          01703003
         TITLE 'IEFVJA - IEFQMNGR'                                      01720000
         IEFQMNGR                                                       01740000
         TITLE 'IEFVJA - JCT'                                           01760000
JAJCT    DSECT                                                          01780000
JAACT    EQU   JAJCT                                                    01800000
         IEFAJCTB                                                       01820000
         TITLE 'IEFVJA - JCTX'                                 @Z40RPSM 01825003
JAJCTX   DSECT                                                          01830003
         IEFJCTX                                               @Z40RPSM 01835003
         TITLE 'IEFVJA - IWA'                                           01840000
         IEFCOMWA                                                       01860002
         EJECT                                                          01860602
         IEFVMIWA                                                       01861202
         IEFTXTFT                                                       01862002
         EJECT                                                          01870002
         TITLE 'IEFVJA - JWA'                                           01880000
         IEFVMJWA                                                       01900000
JAWORK   EQU   JWA                                                      01920000
         TITLE 'IEFVJA - JOB ROUTINE'                                   01940000
IEFVJA   CSECT                                                          01960000
* A PDT - SCAN KEYWORD                                         @ZA04561 01962003
* A 031565-031595,016760,008513  D 022198,031500               @ZA02952 01964003
* A 030350  C 030300                                           @ZA02952 01966003
* CHANGE PDT, BRANCH TABLE, AND CODE FOR PRTY                  @ZA26751 01968003
* CHANGE PDT, BRANCH TABLE, AND CODE FOR TYPRUN                @ZA26751 01970003
* RECOMPILE TO CORRECT MICROFICHE                              @ZA25756 01972003
*********************************************************************** 01980000
*                                                                     * 02000000
*        INPUT TO THIS ROUTINE:                                       * 02020000
*                                                                     * 02040000
*              RC = ADDRESS OF INTERPRETER WORK AREA.                 * 02060000
*              RD = CURRENT REGISTER SAVE AREA.                       * 02080000
*                                                                     * 02100000
*********************************************************************** 02120000
         SPACE                                                          02140000
JAERMAX  EQU   X'26'              ERROR NBR USED TO INDEX TO ERROR RTN. 02160001
JAFORMAT EQU   32                 ERROR MSG NBR FO FORMAT ERROR.   287  02180000
JANOREAL EQU   X'49'              IEF673I ADDRSPC=REAL INVALID   Y01029 02182001
JABADCLS EQU   39                 IEF639I INVALID CLASS DESIGNATION.    02184015
JAMISSIN EQU   46                 IEF646I ERROR MSG - POS PARAM MISSING 02188015
JAADDRSP EQU   X'80'              ADDRSPC FLAG                          02198001
JAREGOFF EQU   92                 OFFSET TO REGION STORE SLOT IN JCT.   02200000
JALENGTH EQU   42            IEF642I - EXCESSIVE PARAMETER LENGTH  AACA 02210017
JAALPHA  EQU   47      IEF647I-NON-ALPHABETIC FIRST CHARACTER  @Z40RPTH 02210503
WRNMSG03 EQU   X'04'              INVALID PERFORM VALUE          Y02655 02211002
WRNMSG05 EQU   X'13'              PERFORM VAL NOT SYS DEF'D     YM00368 02212002
JAZERO   EQU   0                   ZERO DISPLACEMENT              M1715 02213020
JA2      EQU   2                   DISPLACEMENT BYTE            YM00376 02213302
JA8      EQU   8                   LENGTH FOR MOVE               Y02655 02213702
JA16     EQU   16                  LENGTH F0R MOVE               Y02655 02214402
LENZERO  EQU   X'00'               PARAM LENGTH ZERO              M1715 02216020
         SPACE 2                                                        02220000
         BALR  RB,0               REGISTER 11 IS THE BASE REGISTER      02240000
         USING *,RB                    OF THE JOB ROUTINE.              02260000
JABASE   EQU   *                                                        02280000
*****************************************************************Y02668 02282002
* MODULE TRACE CODE - FOR TESTING.                               Y02668 02284002
         L     RF,TRACEV           LOAD TRACE RTNE ADDR.         Y02668 02286002
         BALR  RE,RF               ENTER MOD ID IN TRACE RECORD. Y02668 02288002
TRACEV   DC    V(TRACE)            TRACE RTNE ADDR.              Y02668 02290002
         DC    C'VJA '             MOD ID USED BY TRACE.         Y02668 02292002
* TRACE RETURNS HERE.                                            Y02668 02294002
*****************************************************************Y02668 02296002
         B     JAA1               ********************                  02300000
         MODID BR=NO                                             Y01889 02320001
         DC    C'REL37'             FUNCTION ID AND            @Z40RPTH 02380003
*        DC    C'02'       LEV # (TYPRUN = SCAN)               @ZA04561 02385003
*        DC    C'04'       LEV # (RACF)                        @Z40RPSM 02388003
*        DC    C'05'  LEV # (MERGE SU4,10,16 CODE TO 037 PTF)  @ZA27750 02391003
         DC    C'06'       LEV # (REMOVE TYRUN & PRTY CODE)    @ZA26751 02394003
      EJECT                                                             02400003
*********************************************************************** 02420000
**                                                                   ** 02440000
**             HEADER PORTION OF JOB ROUTINE.                        ** 02460000
**                                                                   ** 02480000
*********************************************************************** 02500000
*                                                                       02520000
*        REGISTER USAGE:                                                02540000
*                                                                       02560000
*              R5 = ERROR MESSAGE CODE REGISTER.                        02580000
*              R8 = JCT ADDRESSING.                                     02600000
*              R9 = ADDRESS OF TEST AND STORE.                          02620000
*              RA = LOCAL AND GET-T+S WORK AREA.                        02640000
*              RB = JOB ROUTINE BASE REGISTER.                          02660000
*              RC = INTERPRETER WORK AREA.                              02680000
*              RD = REGISTER SAVE AREA.                                 02700000
*              RE = LINK RETURN REGISTER.                               02720000
*              RF = ADDRESS OF GET KEY/POS ROUTINE.                     02740000
*                                                                       02760000
         SPACE                                                          02780000
JAA1     DS    0H                                                       02800000
         L     RA,CTRLWAP         LOCAL WORK AREA                       02840000
         USING JAWORK,RA               ADDRESSING.                      02860000
         L     R9,JATESTOR        T AND S ADDRESS.                      02880000
         XC    JAWORK(JATEMP2+2-JAWORK),JAWORK   ZERO WORK AREA.        02900000
         L     RF,JAGETKEP        GET KEY/POS ADDRESS.                  02920000
         LA    R8,JCT             JCT                                   02940000
         USING JAJCT,R8                ADDRESSING.                      02960000
*                                                                       02980000
*   INITIALIZE JCT - JOBNAME SLOT TO BLANKS, DEFAULT MSGLEVEL,     I68  03000018
*        DEFAULT PRTY, INTERNAL JOB SER = 1,TYPRUN=SETUP, & JCT ID=0.   03020000
*        STEP NUMBER=1, CHECKPOINT ID TO BLANKS                @ZA02952 03030003
*        JOBCLASS IS SET TO DEFAULT VALUE USED BY JES.         @ZA02952 03035003
*        USER ID TO BLANKS                                     @Z40RPTH 03036003
*        GROUP ID TO BLANKS                                    @Z40RPSM 03037003
*                                                                       03040000
         MVI   JCTJNAME,C' '                                            03060000
         MVC   JCTJNAME+1(7),JCTJNAME  BLANK JOBNAME SLOT.              03080000
         MVI   JCTJSRNO,X'01'      SET INTERNAL JOB SER NBR TO 1        03100000
         MVI   JCTSNUMB,X'01'     SET STEP NUMBER=1                AACA 03152017
         MVI   JCTCKIDT,C' '           * MOVE BLANKS INTO          AACA 03154017
         MVC   JCTCKIDT+1(15),JCTCKIDT * CHECKPOINT ID SLOT        AACA 03156017
         MVI   JCTUSER,C' '            * MOVE BLANKS INTO      @Z40RPTH 03156503
         MVC   JCTUSER+1(6),JCTUSER    * USER ID SLOT          @Z40RPTH 03156603
         LA    R3,JCTX                   ADDRESS JCTX          @Z40RPSM 03156703
         USING JAJCTX,R3                JCTX ADDRESSABILITY    @Z40RPSM 03156803
         MVI   JCTXGROP,C' '            * MOVE BLANKS INTO     @Z40RPSM 03156903
         MVC   JCTXGROP+1(7),JCTXGROP  * JCTX .                @Z40RPSM 03157003
         MVI   JCTXIDNT,JCTXID      SWA ID INTO JCTXIDNT       @Z40RPSM 03157103
         DROP  R3                                              @Z40RPSM 03157203
         L     R3,WANELPTR         ADDRESS OF NEL              @ZA02952 03157303
         USING JANEL,R3            NEL ADDRESSABILITY          @ZA02952 03157403
         L     R4,NELJMR           JMR ADDRESS                 @ZA02952 03157903
         USING JMR,R4              JMR ADDRESSABILITY          @ZA02952 03158003
         MVC   JCTJCSMF,JMRCLASS   SET JOBCLASS DEFAULT IN JCT @ZA02952 03158503
         DROP  R4                  RELEASE REGISTER 4          @ZA02952 03159003
         DROP  R3                  RELEASE REGISTER 3          @ZA02952 03159503
*                                                                       03160000
*   NOTE - IEFVHA ORIGINALLY ZEROES JCT, IEFVHH ZEROES JCT AFTER        03180000
*        EACH JOB STATEMENT.  THEREFORE, JCT ID IS ALREADY = 0,         03200000
*        AND TYPRUN = SETUP                                        I68  03220018
         SPACE                                                          03240000
*                                                                       03260000
*   CLEAR ACT                                                           03280000
*                                                                       03300000
         LA    R4,JACT            ACT ADDRESS.                          03320000
         XC    0(176,R4),0(R4)    ZERO 176 BYTE ACT.                    03340000
         MVI   ACTPRGNM-ACTDSKAD(R4),C' '   BLANK PGMNM SLOT.           03360000
         MVC   ACTPRGNM-ACTDSKAD+1(19,R4),ACTPRGNM-ACTDSKAD(R4)         03380000
*                                                                  AACA 03382017
* BLANK RESTART STEPNAME SLOT IN IWA, CLEAR CHKPT/RESTART SWITCHES AACA 03384017
*                                                                  AACA 03386017
         TM    SWH,CPSTPFL        IS C/R STEP FLUSH ON             AACA 03388017
         BZ    JAAA1               IF NO, DON'T BLANK FIELD     YM01573 03390002
*                                  FOR VEA                      YM01573 03391002
         MVC   IWAJOBS1(16),ACTPRGNM-ACTDSKAD(R4) USE BLANKS IN ACTAACA 03392017
*                                 TO BLANK OUT SLOT IN IWA              03394017
JAAA1    DS    0H                                                       03396017
         MVI   IWAINTS8,X'00'     CLEAR SWITCHES.                  AACA 03398017
*                                                                       03400000
*   ERROR MESSAGES SETUP.                                               03420000
*                                                                       03440000
         OI    JASW1,JANOJBNM+JANOPGNM+JANOACTN+JAACTPUT  SET ERROR SWS 03460000
         LA    R5,JAERMAX         SET ERROR MESSAGE REGISTER FOR        03480000
*                                      INDEXING ON ERROR RETURNS.       03500000
*                                                                       03520000
*   INITIALIZE DICTIONARY SWITCH FOR ENTRIES TO DICT 1 (SREFB).         03540000
*   CLEAR DDINO IN IWA (NECESSARY FOR JOBLIB WHEN NOT 1ST JOB).         03560000
*   CLEAR REGION AND ROLL SWITCHES IN IWA - CLEAR ROLL FIELD.      AACA 03570017
*   CLEAR REGION SPACE IN IWA.                                     AACA 03580017
*   SET NORESTART FLAG IN JCT - TO BE CLEARED IF RESTART SPECIFIED.AACA 03590017
*                                                                       03600000
         NI    SWD,FF-DCTFST-JOBREGNS-JOBADDRF  CLEAR SWITCHES IN SWD.  03606001
         MVI   IWAJBADR,LENZERO     CLEAR ADDRSPC FLAG          Y01029  03616001
         NI    JCTSTAT2,FF-JCTADSPC     CLEAR ADDRSPC FLAG      Y01029  03616401
         OI    SWD,DBFST          TURN ON FIRST ENTRY DSENQ SW     750  03640000
         XC    DDINTNO(2),DDINTNO CLEAR NBR DD STMTS SLOT IN IWA Y02668 03660002
         XC    IWAJOBS6(4),IWAJOBS6     CLEAR REGION SPACE.        AACA 03670017
*****************************************************************Y01113 03672001
*     CLEAR JOBCAT FIELDS AND SWITCH IN IWA                      Y01113 03674001
*****************************************************************Y01113 03676001
         XC    IWAJSIOT(4),IWAJSIOT    CLEAR TTR FIELD           Y01113 03678001
         NI    DDSWX1,FF-IWAJCAT-IWASCAT-IWASCAT2 CLR SWITCHES   Y01113 03678401
         XC    IWACATCT(1),IWACATCT  CLEAR P.C. COUNT FIELD      Y01113 03678501
         XC    JBCONCAT(1),JBCONCAT  CLEAR JOBLIB COUNT FIELD    Y01113 03678601
         SPACE                                                          03678801
*                                                                       03680000
*   INITIALIZE CORE FOR GET KEY/POS AND TEST & STORE.                   03700000
*                                                                       03720000
         LA    R7,JACLEANP        CLEANUP ADDRESS.                      03740000
         ST    R7,TCLEANUP                                              03760000
         LA    R7,JABRANCH        BRANCHING TABLE ADDRESS.              03780000
         ST    R7,TBRANCH                                               03800000
*                                                                       03820000
*   GET FIRST KEY.                                                      03840000
*                                                                       03860000
         BALR  RE,RF              GO TO GET FIRST KEY.                  03880000
         EJECT                                                          03900000
*********************************************************************** 03920000
*                                                                     * 03940000
*              JOB KEY PROCESSING.                                    * 03960000
*                                                                     * 03980000
*********************************************************************** 04000000
JAJOB    DS    0H                                                       04020000
*                                                                       04040000
*   JOBNAME.                                                            04060000
*                                                                       04080000
         BALR  RE,R9              GO TO TEST AND STORE JOBNAME.         04100000
*                                                                       04120000
*   ACCOUNT NUMBER.                                                     04140000
*                                                                       04160000
         BALR  RE,RF              GET NEXT POSITIONAL - ACCOUNT NBR.    04180000
         SPACE                                                          04200000
         LA    R7,JACT+ACTJNFLD-ACTDSKAD+1  ADDR OF ACCNT FIELD TO R7.  04220000
         LA    R0,1               CNTR1 = NBR OF ACCNT FIELDS.          04240000
         L     R6,TNUM1           CNTR2 = TOTAL LENGTH ACCNT FIELD.     04260000
         LTR   R2,R2              NULL PARAMETER.                       04280000
         BZ    JAC3               YES. GO CHECK FOR ACCNTING INFO.      04300000
         SPACE                                                          04320000
         NI    JASW1,X'FF'-JANOACTN-JAACTPUT     TURN OFF NO ACT SW &   04340000
*                                           NO ACT PUT SWITCH.          04360000
         EX    R2,JAJOBMV1        MOVE LENGTH AND ACNT NBR TO ACT.      04380000
         AR    R6,R2                   OF ACNT FIELDS + LENGTH.         04400000
JAC3     DS    0H                                                       04420000
         LA    R7,1(R7,R2)        POINT TO NEXT ACT STORE POSITION.     04440000
         CLC   TNUM1,TCT1         ACCOUNTING INFO TO STORE.             04460000
         BE    JAE2               NO GO TO GET NEXT POSITIONAL.         04480000
         SPACE                                                          04500000
         BALR  RE,RF              GET POSITIONAL - ACCOUNTING INFO.     04520000
         SPACE                                                          04540000
         A     R0,JA1             INCREMENT CNTR1 BY ONE.               04560000
         LTR   R2,R2              IS THIS A NULL PARAMETER.             04580000
         BZ    JAC3               NO.  GO GET NEXT POSITIONAL.          04600000
         SPACE                                                          04620000
         AR    R6,R2              ADD LENGTH TO CNTR 2.                 04640000
         NI    JASW1,X'FF'-JAACTPUT    TURN OFF NO ACT TO PUT SW.       04660000
         CL    R6,JA144           DOES TOTAL ACCNTING FIELD EXCEDE 144. 04680000
         BH    JAER6              YES. -ERROR- ACCNT FIELD EXCEDES 144. 04700000
         SPACE                                                          04720000
         EX    R2,JAJOBMV1        NO. MOVE ACTNG INFO TO ACT.           04740000
         SPACE                                                          04760000
         B     JAC3               GO TO CHECK FOR MORE ACTNG INFO.      04780000
         SPACE                                                          04800000
JAE2     DS    0H                                                       04820000
         STC   R0,JACT+ACTJNFLD-ACTDSKAD   STORE NBR ACCNT FIELDS.      04840000
         SPACE                                                          04860000
*                                                                       04880000
*   PROGRAMMER NAME.                                                    04900000
*                                                                       04920000
         BALR  RE,RF              GET NEXT POSITIONAL - PROG NAME.      04940000
         SPACE                                                          04960000
         BALR  RE,R9              TEST AND STORE PROGRAMMER NAME.       04980000
         SPACE                                                          05000000
         BALR  RE,RF              GO GET NEXT KEY.                      05020000
         SPACE                                                          05040000
JAJOBMV1 MVC   0(1,R7),0(R3)      MOVE ACNTNG FIELDS TO ACT (EXECUTED). 05060000
         EJECT                                                          05080000
*********************************************************************** 05100000
*                                                                     * 05120000
*     GROUP/USER/MSGLEVEL/MSGCLASS/RD   KEY PROCESSING.        @Z40RPSM 05140003
*                                                                     * 05160000
*********************************************************************** 05180000
JARD     DS    0H                                                 M1715 05182020
         CLI   JAZERO(R3),LENZERO      PARAMETER LENGTH ZERO?     M1715 05184020
         BE    JAER1                   YES-ERROR CONDITION.       M1715 05186020
         BALR  RE,R9               TEST AND STORE.               Y02668 05186602
         MVC   IWAINTS8(1),JCTRSW2 MOVE CKPT SWS TO WA FOR VEA.  Y02668 05187202
         NI    IWAINTS8,JCTNORST+JCTNOCKP+JCTRESTT    CLEAR      Y02668*05187802
                                   REDUNDANT BITS.               Y02668 05188402
         BALR  RE,RF               GET NEXT KEY.                 Y02668 05189002
JAUSER   DS    0H                                              @Z40RPTH 05190003
JAGROUP  DS    0H                                              @Z40RPSM 05200003
JAMSCL   DS    0H                                                       05240000
         BALR  RE,R9              TEST AND STORE.                       05320000
         BALR  RE,RF              GO TO GET NEXT KEY               I68  05321018
JAMSLV   DS    0H   PARM OR SYSGEN DEFAULT VALUES ARE ALREADY SET  I68  05322018
         LTR   R2,R2          IS LENGTH OF JCL LEVEL ZERO          I68  05323018
         BZ    JAMSLGET       YES - GO GET ALLOCATION LEVEL        I68  05324018
         NI    JCTJMGLV,X'8F' NO - CLEAR DEFAULT JCL LEVEL         I68  05325018
JAMSLGET BALR  RE,R9                   TEST AND STORE             M3309 05326018
         BALR  RE,RF                   GET NEXT KEY               M3309 05327018
         LTR   R2,R2          IS LENGTH OF ALLOCATION LEVEL ZERO   I68  05328018
         BZ    JAMSLOUT       YES - BRANCH NO MORE MSGLEVEL PROCESSING  05329018
         NI    JCTJMGLV,X'7F' NO - CLEAR DEFAULT ALLOCATION LEVEL  I68  05330018
         BALR  RE,R9          GO TO TEST AND STORE                 I68  05331018
JAMSLOUT BALR  RE,RF          GO TO GET NEXT KEY                   I68  05332018
         EJECT                                                          05332403
*********************************************************************** 05332803
*                                                                     * 05333703
*     TYPRUN KEYWORD PROCESSING                               @ZA26751* 05334603
*                                                                     * 05335503
*  THE INTERPRETER DOES NOT PROCESS THIS KEYWORD BUT RATHER   @ZA26751* 05336403
*  ALLOWS ALL THE PROCESSING TO BE DONE BY THE JOB ENTRY      @ZA26751* 05337303
*  SUBSYSTEM (JES).                                           @ZA26751* 05338203
*                                                                     * 05339103
*********************************************************************** 05340003
         SPACE 2                                                        05340903
JATYP    DS    0H                 TYPRUN KEYWORD PROCESSING    @ZA26751 05341803
         BALR  RE,RF              GO TO GET NEXT KEY           @ZA26751 05342703
         B     JATYP              LOOP UNTIL NEW KEYWORD FOUND @ZA26751 05343603
         SPACE 2                                                        05344503
*********************************************************************** 05345403
*                                                                     * 05346303
*     PRTY KEY PROCESSING                                     @ZA26751* 05347203
*                                                                     * 05348103
*  THE INTERPRETER DOES NOT PROCESS THIS KEYWORD BUT RATHER   @ZA26751* 05349003
*  ALLOWS ALL THE PROCESSING TO BE DONE BY THE JOB ENTRY      @ZA26751* 05349903
*  SUBSYSTEM (JES).                                           @ZA26751* 05350803
*                                                                     * 05351703
*********************************************************************** 05352603
         SPACE 2                                                        05353503
JAPRTY   DS    0H                 PRTY KEYWORD PROCESSING      @ZA26751 05354403
         BALR  RE,RF              GO TO GET NEXT KEY           @ZA26751 05355303
         B     JAPRTY             LOOP UNTIL NEW KEYWORD FOUND @ZA26751 05356203
         SPACE 2                                                        05357103
         EJECT                                                          05360217
*******************************************************************AACA 05360417
*                                                                  AACA 05360617
*              RESTART KEY PROCESSING.                             AACA 05360817
*                                                                  AACA 05361017
*******************************************************************AACA 05361217
JAREST   DS    0H                                                  AACA 05361417
*                                                                  AACA 05361617
*        IF RESTART=STEPNAME OR STEPNAME.PROCSTEPNAME, IEFVGT      AACA 05361817
*        CHECKS 1ST CHARACTER ALPHA AND TEMPORARILY MOVES UP TO 17 AACA 05362017
*        BYTES TO SRCHL1.  (THIS IS A REFERBACK WORK AREA WHICH IS AACA 05362217
*        NOT USED DURING JOB STATEMENT PROCESSING.)  ALSO          AACA 05362417
*        SETS BITS JATCKPTR AND JATSTEPR IN JCT. IF THERE IS A CHECKID, 05362617
*        JATSTEPR IS TURNED OFF AND UP TO 16 BYTES ARE MOVED TO    AACA 05362817
*        JATCKIDT OF JCT.  JATCKIDL IS SET BY STC OF R2.           AACA 05363017
         OI    SWH,CPFLGXX        INDICATE RESTART                 AACA 05363617
         LTR   R2,R2              1ST PARAMETER IS REQUIRED.       AACA 05363817
         BZ    JAER1              NOT THERE - ERROR.               AACA 05364017
         CLI   1(R3),C'*'         IS IT RESTART = *.               AACA 05364217
         BNE   JAREST1            NO. GO CHECK STEPNAME            AACA 05364417
         C     R2,JA1             ONE CHARACTER ONLY.              AACA 05364617
         BNE   JAER1              NO - ERROR.                      AACA 05364817
         ST    R4,TPDTP           * SET UP PDT POINTERS FOR GT SO  AACA 05365017
         LA    R6,JAST5           * THAT IT WILL LOOK AT 2ND ENTRY AACA 05365217
         ST    R6,TCPDTP          * IN RESTART PDT BYPASSING 1ST.  AACA 05365417
         MVI   IWAJOBS3,C'*'      INDICATE CHECKPOINT IS 1ST STEP. AACA 05365617
         B     JAREST5            GO TO PROCESS CHECKID.           AACA 05365817
         SPACE                                                          05366017
JAREST1  DS    0H                                                  AACA 05366217
         BALR  RE,R9         ERROE CHECK STEPNAME & MVC TO SRCHL1  AACA 05366417
         SPACE                                                          05366617
         LA    R4,8          SET UP FOR SCAN OF STEPNAME.PROCSTEP  AACA 05366817
         LR    R6,R2              TOTAL LENGTH.                    AACA 05367017
         LR    R7,R3              POINTER TO PARAMETER.            AACA 05367217
JAREST2  DS    0H                                                  AACA 05367417
         CLI   1(R3),C'.'         SCAN FOR PERIOD.                 AACA 05367617
         BE    JAREST3       STEPNAME.PROCSTEP - GO SAVE STEPNAME  AACA 05367817
         LA    R3,1(R3,0)         NO HIT - POINT AT NEXT BYTE.     AACA 05368017
         BCT   R6,JAREST2         DECREMENT COUNT AND TRY AGAIN.   AACA 05368217
         LR    R6,R2              STEPNAME.   - RESTORE R6.        AACA 05368417
         B     JAREST4            GO TO SAVE STEPNAME.             AACA 05368617
JAREST3  DS    0H                                                  AACA 05368817
         SR    R2,R6         DETERMINE LENGTH OF CALLING STEPNAME  AACA 05369017
         CLR   R2,R4                                               AACA 05369217
         BH    JAER1                                               AACA 05369417
         BCTR  R2,0                                                AACA 05369617
         EX    R2,JARESTM1        MOVE CALLING STEPNAME TO IWAJOBS1AACA 05369817
         LA    R7,1(R3)           POINT R7 AT PROCSTEP-1.          AACA 05370017
         BCTR  R6,0               DECREMENT BECAUSE OF PERIOD.     AACA 05370217
JAREST4  DS    0H                                                  AACA 05370417
         CLR   R6,R4              DOES STEPNAME EXCEED 8 CHARACTERSAACA 05370617
         BH    JAER1              YES - ERROR                      AACA 05370817
         BCTR  R6,0               DECREMENT FOR EX STMT.           AACA 05371017
         EX    R6,JARESTM2   MOVE STEPNAME OR PROCSTEP TO IWAJOBS3 AACA 05371217
JAREST5  DS    0H                                                  AACA 05371417
         BALR  RE,RF              GET CHECKID.                     AACA 05371817
         BALR  RE,R9         CHECK 1ST CHAR ALPHA - MOVE TO JCT    AACA 05372017
         STC   R2,JCTCKIDL        IF NOT SAVE CHECKID LENGTH IN JCTAACA 05372317
*                                                                  AACA 05372517
         BALR  RE,RF              GET NEXT KEYWORD                 AACA 05372617
         SPACE 2                                                        05372817
JARESTM1 MVC   IWAJOBS1(1),1(R7)       EXECUTED.                   AACA 05373017
JARESTM2 MVC   IWAJOBS3(1),1(R7)       EXECUTED.                   AACA 05373217
         EJECT                                                          05380000
*********************************************************************** 05400000
*                            TIME KEY PROCESSING                      * 05622018
*********************************************************************** 05623018
JATIME   XC    JCTJMRSS+DEC1(DEC8),JCTJMRSS+DEC1 CLEAR THE WORK    SMF1 05624018
*                                           FIELDS                 SMF1 05625018
         BALR  RE,R9                   CONVETT MIN TO BINARY       SMF1 05626018
         CLC   TNUM(DEC4),TCT          ARE ALL SUB PARAMS DONE     SMF1 05627018
         BE    JATIME1                 YES                         SMF1 05628018
         BALR  RE,RF                   NO, GO GET 2ND ONE (SECS)   SMF1 05629018
         BALR  RE,R9                   AND CONVERT TO BINARY       SMF1 05630018
JATIME1  L     R6,JCTJMRSS+DEC1        *                           SMF1 05631018
         MH    R6,JA6000               MIN TO 1/100 SECS           SMF1 05632018
         L     R7,JCTJMRSS+DEC5        *                           SMF1 05633018
         MH    R7,JA100                SECS TO 1/100 SECS          SMF1 05634018
         AR    R6,R7                   ADD TOGETHER                SMF1 05635018
         SLL   R6,DEC8                 SHIFT LEFT ONE BYTE         SMF1 05636018
         ST    R6,JCTJMRTL             AND STORE                   SMF1 05637018
         XC    JCTJMRSS+DEC1(DEC8),JCTJMRSS+DEC1  REINITIALIZE @YA02020 05637302
*              FIELD TO ZERO AFTER USE....                     @YA02020 05637602
         BALR  RE,RF                   AND GO AWAY FOR NEXT        SMF1 05638018
*                                           KEYWORD                SMF1 05639018
         EJECT                                                          05640000
*********************************************************************** 05660000
*                                                                     * 05680000
*              COND KEY PROCESSING                                    * 05700000
*                                                                     * 05720000
*********************************************************************** 05740000
JACOND   DS    0H                                                       05760000
         SPACE                                                          05780000
         LA    R7,JCTJDPCD        DEPENDENCY CODE ADDR TO R7.           05800000
JBB2     DS    0H                                                       05820000
         OI    JASW1,JACONDER     SET COND ERROR FLAG.                  05840000
*                                                                       05860000
*   DEPENDENCY CODE                                                     05880000
*                                                                       05900000
         BALR  RE,R9              TEST & STORE CODE. (TEMP1)            05920000
*                                                                       05940000
*   CHECK FOR THE COND AS A SUBPARAMETER. (PROPER NBR PARENTHESIS).     05960000
*                                                                       05980000
         BCTR  R3,0               POINT TO BYTE BEFORE TLENP. HOPEFULLY 06000000
*                                      IT IS THE SUBPARAMETER BYTE.     06020000
         SR    R2,R2                                                    06040000
         IC    R2,0(R3)           PICK UP BYTE.                         06060000
         SRL   R2,4               SHIFT TO GET HIGH ORDER BITS ONLY.    06080000
         X     R2,JAMSK1          CHECK FOR SUBPARM INDICATOR ONLY.     06100000
         BC    4,JAER1            IF OTHER BITS ON NOT SUBPARM -ERROR-  06120000
*                                                                       06140000
*   DEPENDENCY OPERATOR                                                 06160000
*                                                                       06180000
         BALR  RE,RF              GET OPERATOR.                         06200000
         SPACE                                                          06220000
         LTR   R2,R2              IS THERE AN OPERATOR.                 06240000
         BZ    JAER1              NO. ERROR.                            06260000
         SPACE                                                          06280000
         CLC   TNUM1(4),TCT1      ARE THERE MORE PARAMS IN COND FIELD.  06300000
         BNE   JAER1              YES. ERROR.                           06320000
         SPACE                                                          06340000
         XC    JATEMP2(2),JATEMP2      ZERO TEMP2 FOR OR OF OP CODE.    06360000
*                                                                       06380000
*   DEPENDENCY OPERATOR                                                 06400000
*                                                                       06420000
         BALR  RE,R9              TEST & STORE OPERATOR. (TEMP 2)       06440000
         SPACE                                                          06460000
         ST    RB,TPDTP           SPOIL PDTP SO THAT T&S WILL START AT  06480000
*                                      TOP AND CYCLE THRU TABLE AGAIN.  06500000
         MVC   0(4,R7),JATEMP1    MOVE CODE & OPERATOR TO JCT.          06520000
         LA    R7,4(R7,0)         INCREMENT TO NEXT STORE POSITION.     06540000
         NI    JASW1,X'FF'-JACONDER    TURN OFF COND ERROR FLAG.        06560000
         SPACE                                                          06580000
         BALR  RE,RF              GO TO GET NEXT COND CODE OR NEXT KEY. 06600000
         SPACE                                                          06620000
         B     JBB2               IF ANOTHER COND GO TO PROCESS.        06640000
         EJECT                                                          06660000
*********************************************************************** 06680000
*                                                                     * 06700000
*              REGION KEY PROCESSING.                                 * 06720000
*                                                                     * 06740000
*********************************************************************** 06760000
JAREG    DS    0H                                                       06780000
         LTR   R2,R2              IS PRIMARY REGION SPECIFIED      AACA 06810017
         BZ    JAREG01            NO-GO GET NEXT KEY               AACA 06840017
         BAL   RE,JAREG1          CHECK HIGH SPEED REGION SYNTAX.  AACA 06870017
         BALR  RE,R9              LINK TO TEST NUMERICS, CVB & MVC-JCT. 06920000
         OI    SWD,JOBREGNS        SET SW - REGION ON JOB STMT.  Y02668 06920502
         MVC   IWAJOBS6(2),JAREGOFF(R8) MOVE REGION TO IWA FOR SCT.AACA 06921017
         SPACE                                                          06922017
JAREG01  DS    0H                                                  AACA 06923017
         ST    R4,TPDTP           * SET UP PDT POINTERS FOR GT SO  AACA 06924017
         LA    R6,JAREGB+1        * THAT IT WILL LOOK AT 2ND ENTRY AACA 06925017
         ST    R6,TCPDTP          * IN REGION PDT, BYPASSING 1ST.  AACA 06926017
         BALR  RE,RF                                               AACA 06927017
         SPACE                                                          06928017
         BAL   RE,JAREG1          CHECK LCS.                       AACA 06929017
         BALR  RE,R9              CVB & MOVE TO JATEMP1.           AACA 06930017
         SR    R4,R4              ZERO R4                        Y01029 06930401
         IC    R4,JATEMP1         FIRST BYTE H1 IN R4            Y01029 06930501
         SLL   R4,8               MOVE FIRST BYTE H1             Y01029 06930601
         IC    R4,JATEMP1+1       INSERT SECOND BYTE OF H1       Y01029 06930701
         AH    R4,JAREGOFF(R8)    ADD H0 VALUE TO H1             Y01029 06939001
         C     R4,MAXVAL          MAX VALUE EXCEEDED ?           Y01029 06939401
         BH    JAER77             YES, ERROR MSG                 Y01029 06939801
         STH   R4,JAREGOFF(R8)    JCT REGION = H0 + H1           Y01029 06940801
         STH   R4,IWAJOBS6        IWA REGION = H0 + H1           Y01029 06942601
         BALR  RE,RF              GET NEXT KEY.                    AACA 06944401
         SPACE                                                          06946201
JAREG1   DS    0H                                                  AACA 06948001
         LA    R6,0(R2,R3)        CHECK FOR REGION OF XXXXXK.      AACA 06949801
         CLI   0(R6),C'K'                                          AACA 06951601
         BNE   JAER1              NO 'K'.  GO TO ERROR.            AACA 06953401
         BCTR  R2,0               SET TO PROCESS NUMERICS ONLY.    AACA 06955201
         LTR   R2,R2         WAS 'K' ONLY SPECIFICATION?        YA02009 06955802
         BZ    JAER1         YES,FORMAT ERROR IN REGION FIELD.. YA02009 06956402
         BR    RE                 RETURN.                          AACA 06957001
         EJECT                                                          06958801
*********************************************************************** 06960615
*                                                                     * 06960915
*                                                                     * 06961215
*              ROLL KEY PROCESSING.                                   * 06961515
*                                                                     * 06961815
*********************************************************************** 06962115
JAROLL   DS    0H                                                       06962415
         SPACE                                                          06966315
         BALR  RE,RF              GET NEXT KEYWORD.                     06966615
         B     JAROLL                                           Y01029  06966701
         EJECT                                                          06966915
*********************************************************************** 06967215
*                                                                     * 06967515
*              CLASS KEY PROCESSING.                                  * 06967815
*                                                                     * 06968115
*********************************************************************** 06968415
JACLASS  DS    0H                                               YM00362 06968702
         LA    R7,JACLSTBL         ADDR OF TABLE OF CLASSES.    YM00362 06969002
         LA    R6,JACLSLTH         CLASS TABLE LENGTH.          YM00362 06969302
JACLASS1 DS    0H                                               YM00362 06969602
         CLC   0(1,R7),1(R3)       SPECIFIED CLASS IN TABLE?    YM00362 06969902
         BE    JACLASS2            BR YES TO ENTER CLASS IN JCT.YM00362 06970202
         LA    R7,1(R7)            POINT TO NEXT ENTRY IN TABLE.YM00362 06970502
         BCT   R6,JACLASS1         REDUCE ENTRY COUNT, AND BR   YM00362*06970802
                                   TO CHECK NEXT ENTRY.         YM00362 06971102
* FALL THRU IF ALL ENTRIES CHECKED AND NO MATCH FOUND.          YM00362 06971402
* SPECIFIED CLASS IS INVALID.                                   YM00362 06971702
         MVI   MSGSEC,JABADCLS    SET MSG NBR FOR IEF639I               06972315
         B     JACLEANP           GO TO CLEANUP.                        06972615
JACLASS2 DS    0H                                                       06973215
         BALR  RE,R9              TEST FOR ONE BYTE ONLY.               06973515
         MVC   JCTJCSMF(1),1(R3)   MOVE JOBCLASS VALUE TO JCT.  YM00361 06973802
         BALR  RE,RF              GO TO GET NEXT KEYWORD.               06974115
         SPACE 2                                                        06974402
*  TABLE OF VALID CLASS VALUES.                                 YM00362 06974602
JACLSTBL DS    0C                                               YM00362 06974802
         DC    C'ABCDEFGHI'                                     YM00362 06975002
         DC    C'JKLMNOPQR'                                     YM00362 06975202
         DC    C'STUVWXYZ'                                      YM00362 06975402
         DC    C'0123456789'                                    YM00362 06975602
JACLSEND DS    0C                                               YM00362 06975802
JACLSLTH EQU   JACLSEND-JACLSTBL                                YM00362 06976002
         EJECT                                                          06976701
*********************************************************************** 06978201
**                                                                   ** 06978801
**                   ADDRSPC KEY PROCESSING                          ** 06978901
**                                                                   ** 06979001
**                                                                   ** 06979201
*********************************************************************** 06979401
*                                                                       06979801
JAADDR   DS    0H                                                Y01029 06979901
         LTR   R2,R2              ADDRSPC PARAMETER SPECIFIED?   Y01029 06986701
         BZ    TEST               NO, GET NEXT KEY(NULLIFY)      Y01029 06988601
         BALR  RE,R9              TEST AND STORE ROUTINE         Y01029 06990601
         OI    SWD,JOBADDRF        SET SW - ADDRSPC ON JOB STMT. Y02668 06991602
         TM    JCTSTAT2,JCTADSPC  ADDRSPC=REAL?                  Y01029 06992601
         BZ    TEST               NO,NO TSO CHECK               Y01029  06992701
         L     R3,WANELPTR         ADDRESS OF NEL.               Y02668 06993102
         USING JANEL,R3            NEL ADDRESSABILITY            Y01029 06993501
         TM    NELOPSW2,NELADSPC   IS THIS A TSO USER ?          Y01029 06993901
         BZ    JAADDR1             NO GO TO SET ADDRSPC BIT      Y01029 06994001
         DROP  R3                                                       06994401
         MVI   MSGSEC,JANOREAL     YES, ADDRSPC=REAL INVALID     Y01029 06997401
         MVI   MSGKEY,JOBK         ON JOB STATEMENT              Y01029 06999401
         B     JAERRTN             EXIT TO ERROR RTN             Y01029 06999801
JAADDR1  DS    0H                                                Y01029 07000201
         OI    IWAJBADR,JCTADSPC                                 Y01029 07000701
TEST     DS    0H                                                Y01029 07002701
         BALR  RE,RF               GO GET NEXT KEY               Y01029 07005702
         EJECT                                                          07005802
************************************************************     Y02655 07005902
**                                                        **     Y02655 07006002
**                 PERFORM KEY PROCESSING                 **     Y02655 07006102
**                                                        **     Y02655 07006202
************************************************************     Y02655 07006302
          SPACE                                                         07006402
JAPRFM   DS    0H                                                Y02655 07006502
         OI    JCT+JCTSTAT2-INJMJCT,JCTPERFM SET JOB PRFM FLAG. YM00368 07006602
         LTR   R2,R2               PERFORM VALUE SPECIFIED?     YM00368 07008602
         BZ    JAPRFM1             NO, ISSUE WARNING MSG.       YM00368 07010602
         BALR  RE,R9               GO TO TEST AND STORE RTNE.   YM00368 07012602
         CLI   MSGSEC,JAZERO       VGT ENTERS MSG CODE IF ERROR.YM00368 07014602
         BE    JAPRFM2             BRANCH ON ERROR.             YM00368 07016602
         MVI   MSGSEC,JAZERO       ZERO MESSAGE FIELD.          YM00368 07018602
JAPRFM1  DS    0H                                               YM00368 07020602
         MVI   MSGKEY,JAZERO       CLEAR SECONDARY MSG FIELD.   YM00368 07022602
         LA    R2,WRNMSG03         LOAD WARNING MSG CODE.       YM00368 07024602
         L     R3,JAVGM            GET MESSAGE MODULE ADDRESS.  YM00368 07026602
         BALR  RE,R3               ISSUE MESSAGE.               YM00368 07028602
         BALR  RE,RF               GO GET NEXT KEY.             YM00368 07030602
*  IEFVGT WILL ACCEPT VALUES IN THE RANGE OF 0-255.             YM00368 07032602
JAPRFM2  DS    0H                                               YM00368 07034602
         CLI   JCT+JCTPRFMF-INJMJCT,JAZERO VALUE EQUAL ZERO?    YM00368 07036602
         BE    JAPRFM1             BRANCH YES, ZERO IS INVALID. YM00368 07038602
         SR    R1,R1               CLEAR REG 1.                 YM00368 07040602
         IC    R1,JCT+JCTPRFMF-INJMJCT GET SPECIFIED VALUE.     YM00368 07042602
         SYSEVENT VERIFYPG         VALIDATE VALUE.              YM00368 07044602
         L     RF,JAGETKEP         RESTORE GET KEY ADDRESS.     YM00368 07046602
*  SRM RETURNS ZERO IN BYTE 2 IF SPECIFIED VALUE IS DEFINED TO  YM00368 07048602
*  SYSTEM, OR A DEFAULT VALUE IF SPECIFIED VALUE IS UNDEFINED.  YM00368 07050602
         CLM   R1,JA2,JACON0       ZERO RETURN CODE ?           YM00376 07052602
         BZ    JAPRFM3             BRANCH YES, VALID VALUE.     YM00368 07054602
*  SPECIFIED VALUE IS INVALID.                                  YM00368 07056602
         STCM  R1,JA2,JCT+JCTPRFMF-INJMJCT ENTER DEFAULT IN JCT.YM00376 07058602
         MVI   MSGKEY,JAZERO       CLEAR SECONDARY MSG FIELD.   YM00368 07060602
         LA    R2,WRNMSG05         INSERT WARNING MSG FOR VGM.  YM00368 07062602
         L     R3,JAVGM            GET MESSAGE MODULE ADDRESS.  YM00368 07064602
         BALR  RE,R3               ISSUE MESSAGE.               YM00368 07066602
JAPRFM3  DS    0H                                               YM00368 07068602
         BALR  RE,RF               GO GET NEXT KEY.             YM00368 07070602
         EJECT                                                  YM00368 07072602
***************************************************************@Z40RPTH 07074603
**                                                           **@Z40RPTH 07074703
**           PASSWORD KEYWORD PROCESSING                     **@Z40RPSM 07074803
**                                                           **@Z40RPTH 07074903
* REGISTER 4 CONTAINS THE ADDRESS OF THE PDT FOR THE PASSWORD  @Z40RPSM 07075003
* KEYWORD.  THE PDT WILL NOT BE USED SINCE NO DATA WILL BE     @Z40RPTH 07075103
* MOVED TO A CONTROL BLOCK.  ALL PASSWORD KEYWORD PROCESSING IS@Z40RPSM 07075203
* HANDLED BY THIS ROUTINE.  THEREFORE, REGISTER 4 CAN BE       @Z40RPTH 07075303
* DESTROYED AND USED AS A WORK REGISTER.                       @Z40RPTH 07075403
***************************************************************@Z40RPTH 07075503
         SPACE 2                                                        07075603
JAPASS   DS    0H                                              @Z40RPSM 07075703
         LA    R4,EIGHT       PUT VALUE 8 IN REG. 4            @Z40RPSM 07075803
         CR    R2,R4          PASSWORD LENGTH GREATER THAN 8?  @Z40RPSM 07075903
         BNH   PASSOK         NO,PASSWORD IS VALID             @Z40RPSM 07076003
         B     JAER8          YES,ISSUE ERROR MESSAGE IEF642I  @Z40RPTH 07076103
PASSOK   BALR  RE,RF          GET NEXT KEYWORD                 @Z40RPSM 07076203
         B JAPASS             FOR 2ND PASSWORD                 @Z40RPSM 07076303
         EJECT                                                          07076403
***************************************************************@Z40RPTH 07076503
**                                                           **@Z40RPTH 07076603
**               NOTIFY KEYWORD PROCESSING                   **@Z40RPTH 07076703
**                                                           **@Z40RPTH 07076803
* REGISTER 4 CONTAINS THE ADDRESS OF THE PDT FOR THE NOTIFY    @Z40RPTH 07076903
* KEYWORD.  THE PDT WILL NOT BE USED SINCE NO DATA WILL BE     @Z40RPTH 07077003
* MOVED TO A CONTROL BLOCK. ALL NOTIFY KEYWORD PROCESSING IS   @Z40RPTH 07077103
* HANDLED BY THIS ROUTINE. THEREFORE, REGISTER 4 CAN BE        @Z40RPTH 07077203
* DESTROYED AND USED AS A WORK REGISTER.                       @Z40RPTH 07077303
***************************************************************@Z40RPTH 07077403
         SPACE 2                                                        07077503
JANOTIFY DS    0H                                              @Z40RPTH 07077603
         LA    R4,SEVEN        PUT VALUE 7 IN REG. 4           @Z40RPTH 07077703
         CR    R2,R4           USER ID GREATER THAN 7 CHARS?   @Z40RPTH 07077803
         BNH   CHECKN          NO,CHECK FIRST CHARACTER        @Z40RPTH 07077903
         B     JAER8          YES,ISSUE ERROR MESSAGE IEF642I  @Z40RPTH 07078003
CHECKN   LA    R3,1(0,R3)     POINT TO FIRST CHARACTER         @Z40RPTH 07078103
         CLI   0(R3),E9       COMPARE FIRST CHAR. TO X'E9'=Z   @Z40RPTH 07078203
         BH    JAER9          NUMERIC FIRST CHAR. INVALID      @Z40RPTH 07078303
         BALR  RE,RF          GET NEXT KEYWORD                 @Z40RPTH 07078403
         EJECT                                                          07078503
*********************************************************************** 07078603
**                                                                   ** 07078703
**             CLEANUP PORTION OF JOB ROUTINE.                       ** 07080602
**                                                                   ** 07082602
*********************************************************************** 07084602
JACLEANP DS    0H                                                       07086602
*                                                               YM00368 07088602
*   PERFORM CHECK.                                              YM00368 07090602
*                                                               YM00368 07092602
         CLI JCT+JCTPRFMF-INJMJCT,JAZERO PERF VALUE SPECIFIED?  YM00368 07094602
         BNE   JAE1               YES,CONTINUE NORMAL PROCESSINGYM00368 07096602
*  PERFORM VALUE NOT SPECIFIED ON JOB STMT. IEFVJA OBTAINS      YM00368 07098602
*  DEFAULT FOR EXEC PROCESSOR IN THE EVENT A PERFORM VALUE      YM00368 07100602
*  WAS NOT SPECIFIED ON AN EXEC STMT.                           YM00368 07102602
         SR    R1,R1              CLEAR REG FOR SYSEVENT        YM00368 07104602
         SYSEVENT VERIFYPG                                      YM00368 07106602
         STCM  R1,JA2,JCT+JCTPRFMF-INJMJCT SAVE DEFLT VALUE     YM00368 07108602
*                                                                       07120000
*   ERROR CHECK.                                                        07140000
*                                                                       07160000
         CLI   MSGSEC,X'00'       IS ERROR FLAG EQUAL ZERO.             07180000
         BNE   JAERRTN            NO - ERROR.                           07200000
*                                                                       07220000
*   JOBNAME CHECK.                                                      07240000
*                                                                       07260000
JAE1     DS    0H                                                       07280000
         TM    JASW1,JANOJBNM     IS THE NO JOBNAME SWITCH ON.          07300000
         BO    JAER4              YES. -ERROR- -NO JOBNAME-             07320000
*                                                                       07340000
*   CONDITION CHECK.                                                    07360000
*                                                                       07380000
         MVI   MSGKEY,CONDJK      SET SECONDARY MESSAGE FOR COND.       07400000
         TM    JASW1,JACONDER     IS THE CONDITION ERROR SWITCH ON.     07420000
         BO    JAER1              YES. -ERROR- -OPERATOR MISSING-       07440000
*                                                                       07460000
*   CHECK FOR ACCOUNT NUMBER OR PROGRAMMER NAME NEEDED AND MISSIOG.     07480000
*                                                                       07500000
         LA    R3,WAJOBPFX         ADDR OF PSEUDO JOB PFX.       Y02668 07506002
         USING TEXT,R3             PREFIX ADDRESSABILITY.        Y02668 07512002
         TM    JASW1,JANOPGNM     IS THERE A PROGRAMMER NAME.           07520000
         BZ    JAE12              YES. GO TO CHECK ACCNT NBR.           07540000
         TM    STRJINDC,JTXPROGN   PROGR NAME REQUIRED?          Y02668 07580002
         BO    JAER2              YES. ERROR -PROGRAMMER NAME MISS-     07600000
         SPACE                                                          07620000
JAE12    DS    0H                                                       07640000
         TM    JASW1,JANOACTN     IS THERE AN ACCOUNT NUMBER.           07660000
         BZ    JABLPCHK            BYPASS ACCT # REQUIRED CHECK. Y02668 07680002
         TM    STRJINDC,JTXACCTN   ACCT NUMBER REQUIRED?         Y02668 07700002
         BO    JAER3              YES. -ERROR-  -ACT NBR MISSING-       07740000
*  CHECK IF BYPASS LABEL PROCESSING DEFAULT SPECIFIED.           Y02668 07742002
JABLPCHK DS    0H                                                Y02668 07744002
         TM    STRJLABD,JTXLABLP   IS DEFAULT BLP?               Y02668 07746002
         BZ    JAACTCK             NO, DEFLT IS NL, NO BIT SET.  Y02668 07748002
         OI    JCTSTAT2,JCTBLP     SET BLP FLAG IN JCT.          Y02668 07750002
         DROP  R3                                                Y02668 07752002
*                                                                       07760000
*   ACT TO PUT OUT.                                                     07780000
*                                                                       07800000
JAACTCK DS     0H                                                       07820000
         LA    R4,JACT            JOB ACT ADDRESS TO R4.                07840000
         MVC   0(3,R4),TNEXT      DISK ADDR THIS ACT TO ACT.            07860000
         MVI   3(R4),ACTID        ACT IDENT = 1.                        07880000
         LA    R7,QPARM           Q-MANAGER PARAMETER AREA.             07900000
         USING IOPARAMS,R7             LIST ADDRESSING.                 07920000
         L     R6,QMPCL           QMPCA ADDRESS TO R6.                  07940000
         ST    R4,0(R6)           ACT ADDRESS TO QMPCA.                 07960000
         MVC   4(4,R6),TNEXT      TTR TO QMPEX.                         07980000
         L     RF,JAVHQ           IEFVHQ ADDRESS TO R15.                08000000
         SPACE                                                          08020000
         BALR  RE,RF              LINK TO QMANAGER TO WRITE AND ASSIGN. 08040000
         SPACE                                                          08060000
         MVC   JCTACTAD(4),TNEXT  MOVE ACT TTR TO JCT.                  08080000
         MVC   TNEXT(4),0(R6)     REPLACE TTR IN IWA.                   08100000
*   FALL THROUGH TO EXIT.                                               08120000
         SPACE                                                          08140000
*                                                                       08160000
*   EXIT TO IEFVHF.                                                     08180000
*                                                                       08200000
JAEXIT   DS    0H                                                       08220000
         MVI   MSGKEY,DEC0         ZERO SECONDARY MESSAGE        Y02668 08230002
         SPACE                                                          08240000
         L     RF,JAVHE            SET EXIT TO ROUTER.           Y02668 08260002
         SPACE                                                          08280000
         BR    RF                 ***   EXIT   ***                      08300000
         EJECT                                                          08320000
*********************************************************************** 08340000
**                                                                   ** 08360000
**             ERROR ROUTINES.                                       ** 08380000
**                                                                   ** 08400000
*********************************************************************** 08420000
         SPACE                                                          08440000
JAER2    BCTR  R5,0               IEF633I - PROGRAMMER NAME MISSING.    08460000
JAER3    BCTR  R5,0               IEF634I - ACCOUNT NUMBER MISSING.     08480000
JAER4    BCTR  R5,0               IEF635I - JOBNAME MISSING.            08500000
JAER5    BCTR  R5,0               NOT USED BY IEFVJA.                   08520000
JAER6    BCTR  R5,0               IEF637I - ACCT FIELD EXCEEDS MAXIMUM. 08540001
*                                      MSG NBR IS STORED INTO IWA.      08542001
JAER77   STC   R5,MSGSEC          IEF638I - MAX REGION EXCEEDED  Y01029 08550001
         MVI   MSGKEY,JOBK        SET MSGKEY TO JOB KEY.                08580000
         SPACE                                                          08600000
*                                                                       08620000
*   FAIL JOB - ENTER MESSAGE INTO SMB.                                  08640000
*                                                                       08660000
JAERRTN  DS    0H                                                       08680000
         OI    JCTJSTAT,INCMSTS   FAIL JOB.                             08700000
         OI    JCTJMGLV,INCMMGL1  DEFAULT TO MESSAGE LEVEL = 1.         08720000
         SPACE                                                          08740000
         CLI   JCTJNAME,C' '      TEST FOR JOBNAME IN JCT         22297 08746018
         BNE   JAERMSG             YES,GO PUT OUT MESSAGE         22297 08752018
         MVC   JCTJNAME(8),JAERDUM  NO,PUT DUMMY NAME IN JCT      22297 08758018
*                                       THEN GO PUT OUT MESSAGE   22297 08764018
JAERMSG  SR    R2,R2                                              22297 08770018
         IC    R2,MSGSEC          MSG NBR TO R2.                        08780000
         L     RF,JAVGM           IEFVGM ADDRESS TO R15.                08800000
         SPACE                                                          08820000
         BALR  RE,RF              LINK TO MESSAGE MODULE.               08840000
         SPACE                                                          08860000
         B     JAACTCK            GO TO PUT OUT ACT & EXIT.             08880000
         SPACE 2                                                        08900000
JAER1    DS    0H                                                       08920000
         MVI   MSGSEC,JAFORMAT    SET MESSAGE FOR FORMAT ERROR.         08940000
         B     JAERRTN                                                  08960000
         SPACE 3                                                        08962017
JAER7    DS    0H                                                  AACA 08964017
         MVI   MSGSEC,JAMISSIN    IEF646I - REQ POS PARAM MISSING. AACA 08966017
         B     JAERRTN                                             AACA 08968017
         SPACE 3                                                   AACA 08970017
JAER8    DS    0H                                                  AACA 08972017
         MVI   MSGSEC,JALENGTH IEF642I-EXCESSIVE PARAMETER LENGTH  AACA 08974017
         B     JAERRTN                                             AACA 08976017
         SPACE 3                                                        08976603
JAER9    DS    0H                                              @Z40RPTH 08977203
         MVI   MSGSEC,JAALPHA      IEF647I-NON ALPHABETIC      @Z40RPTH 08977803
*                                  FIRST CHARACTER             @Z40RPTH 08978403
         B     JAERRTN                                         @Z40RPTH 08979003
         EJECT                                                          08980000
*********************************************************************** 09000000
**                                                                   ** 09020000
**             TABLES FOR JOB ROUTINE.                               ** 09040000
**                                                                   ** 09060000
*********************************************************************** 09080000
*                                                                       09100000
*   BRANCHING TABLE FOR GET KEY/POS.                                    09120000
*                                                                       09140000
         SPACE                                                          09160000
JABRANCH DS    0H                                                       09180000
JAJOBA   EQU   *                  JOB KEY.                              09200000
         KKK   03,01000000,JAJOB-JABASE,JAJOBB-JABASE                   09220000
JAMSLVA  EQU   *                  MSGLEVEL KEY.                         09240000
         KKK   02,00000000,JAMSLV-JABASE,JAMSLVB-JABASE            I68  09260018
JAMSCLA  EQU   *                  MSGCLASS KEY.                         09280000
         KKK   01,00000000,JAMSCL-JABASE,JAMSCLB-JABASE                 09300000
JATYPA   EQU   *                  TYPRUN KEY.                           09320000
         KKK   FF,00000000,JATYP-JABASE,JATYPB-JABASE          @ZA26751 09340003
JAPRTYA  EQU   *                  PRTY KEY.                             09350003
         KKK   FF,00000000,JAPRTY-JABASE,JAPRTYB-JABASE        @ZA26751 09360003
JACONDA  EQU   *                  COND KEY.                             09400000
         KKK   08,11111111,JACOND-JABASE,JACONDB-JABASE                 09420000
JAREGA   EQU   *                  REGION KEY.                           09440000
         KKK   02,0,JAREG-JABASE,JAREGB-JABASE                     AACA 09444017
JACLASSA EQU   *                  CLASS KEY.                       AACA 09448017
         KKK   01,0,JACLASS-JABASE,JACLASSB-JABASE                 AACA 09452017
JAROLLA  EQU   *                  ROLL KEY.                        AACA 09456017
         KKK   02,0,JAROLL-JABASE,JAROLLB-JABASE                   AACA 09460017
JARDA    EQU   *                  RD KEY.                          AACA 09464017
         KKK   01,0,JARD-JABASE,JARDB-JABASE                       AACA 09468017
JARESTA  EQU   *                  RESTART KEY.                     AACA 09472017
         KKK   02,0,JAREST-JABASE,JARESTB-JABASE                   AACA 09476017
JATIMEA  EQU   *                       TIME KEY               M0444SMF1 09477018
         KKK   02,00000000,JATIME-JABASE,JATIMEB-JABASE       M0444SMF1 09478018
JANOTIFA EQU   *                  NOTIFY KEY                      20001 09478620
         KKK   01,0,JANOTIFY-JABASE,JANOTIFB-JABASE               20001 09479220
JAADDRA  EQU   *                   ADDRSPC KEY                  Y01029  09479701
         KKK   01,0,JAADDR-JABASE,JAADDRB-JABASE                Y01029  09479801
JAPRFMA  EQU   *                        PERFORM KEY              Y02655 09479902
         KKK   01,0,JAPRFM-JABASE,JAPRFMB-JABASE                 Y02655 09480002
JAUSERA  EQU   *                   USER KEY                    @Z40RPTH 09480203
         KKK   01,0,JAUSER-JABASE,JAUSERB-JABASE               @Z40RPTH 09482203
JAPASSA  EQU   *               PASSWORD KEY                    @Z40RPSM 09484203
         KKK   02,0,JAPASS-JABASE,JAPASSB-JABASE               @Z40RPSM 09486203
JAGROUPA EQU *                GROUP KEYWORD.                   @Z40RPSM 09488203
         KKK   01,0,JAGROUP-JABASE,JAGROUPB-JABASE             @Z40RPSM 09490203
         EJECT                                                          09492203
*                                                                       09500000
*   PARAMETER DESCRIPTER TABLE FOR TEST AND STORE (PDT).                09520000
*                                                                       09540000
         SPACE                                                          09560000
JAJOBB   EQU   *                  JOB PDT.                              09580000
         DC    FL1'17'            LENGTH OF PDT FOR JOB.                09600000
*   JOBNAME                                                             09620000
         CCC   8,50                                                     09640000
         MMM   8,61,JCTJNAME-INJMJCT                                    09660000
         BBC   40,JASW1-JAWORK,FF-JANOJBNM                              09680000
*   PROGRAMMER NAME.                                                    09700000
         CCC   8,50                                                     09720000
         MMM   20,53,ACTPRGNM-ACTDSKAD                                  09740000
         BBC   40,JASW1-JAWORK,FF-JANOPGNM-JAACTPUT                     09760000
         SPACE                                                          09780000
JATYPB   EQU   *                  TYPRUN PDT.                  @ZA26751 09800003
*              DUMMY PDT SINCE TYPRUN IS A SUBSYSTEM RATHER    @ZA26751 09840003
*              THAN A CONTROL PROGRAM KEYWORD                  @ZA26751 09880003
         SPACE                                                          09960000
JAMSLVB  EQU   *                  MSGLEVEL PDT.                         09980000
         DC    AL1(MSLENDX-JAMSLVB)     LENGTH OF MSGLEVEL PDT     I68  09983018
JAMSLVC  DC    AL1(JAMSLVD-JAMSLVC)     LENGTH OF FIRST POSITIONAL PDT  09986018
*   TWO        JCL LEVEL                                           I68  09989018
         SSS   31,2                                                I68  09992018
         BBC   01,JCTJMGLV-INJMJCT,INCMMGL2                        I68  09995018
*   ONE                                                                 10040000
         SSS   31,1                                                     10060000
         BBC   01,JCTJMGLV-INJMJCT,INCMMGL1                             10080000
*   ZERO                                                                10100000
         SSS   01,0                                                     10120000
JAMSLVD  DC    AL1(MSLENDX-JAMSLVD)     LENGTH OF SECOND POSITIONAL PDT 10122018
*   ONE        ALLOCATION LEVEL                                    I68  10124018
         SSS   31,1                                                I68  10126018
         BBC   01,JCTJMGLV-INJMJCT,INCMALL                         I68  10128018
*   ZERO                                                           I68  10130018
         SSS   01,0                                                I68  10132018
MSLENDX  EQU   *                                                   I68  10134018
         SPACE                                                          10140000
JAMSCLB  EQU   *                  MSGCLASS PDT.                         10160000
         DC    FL1'7'             LENGTH OF MSGCLASS PDT.               10180000
         CCC   6,30                                                     10200000
         DC    FL1'1'             MAX PARAMETER LENGTH.                 10220000
         DC    XL1'70'            FUNCT/TABLE.                          10240000
         DC    XL1'51'            FUNCT/TABLE.                          10260000
         DC    AL1(JCTJMGPO-INJMJCT)   OFFSET IN TABLE.                 10280000
         SPACE                                                          10300000
JAPRTYB  EQU   *                  PRTY PDT.                    @ZA26751 10320003
*              DUMMY PDT SINCE PRTY IS A SUBSYSTEM RATHER      @ZA26751 10340003
*              THAN A CONTROL PROGRAM KEYWORD.                 @ZA26751 10360003
JATIMEB  EQU   *                       TIME PDT                    SMF1 10402018
         DC    FL1'17'                 LENGTH OF TIME PDT          SMF1 10404018
         CCC   8,50                                                     10406018
         MMM   4,31,JCTJMRSS+2-INJMJCT                                  10408018
         DC    FL3'1440'               MAXIMUM NUMBER OF MINUTES   SMF1 10410018
         CCC   8,50                                                     10412018
         MMM   2,31,JCTJMRSS+6-INJMJCT                                  10414018
         DC    FL3'59'                 MAXIMUM NUMBER OF SECONDS   SMF1 10416018
JANOTIFB EQU   *                  JUST LABEL FOR NOTIFY PDT    @Z40RPTH 10416303
*                                 NO FUNCTIONAL PDT            @Z40RPTH 10417303
         SPACE                                                          10420000
JACONDB  EQU   *                  COND PDT.                             10440000
         DC    FL1'45'            LENGTH OF COND PDT.                   10460000
*   CODE.                                                               10480000
         CCC   7,40                                                     10500000
         DC    FL1'4'             MAXIMUM PARAMETER LENGTH.             10520000
         DDD   20,JATEMP1-JAWORK,2,4095                                 10540000
         DC    FL1'37'            LENGTH THIS POSITIONAL PDT.           10560000
*   OPERATORS.                                                          10580000
*   GT                                                                  10600000
         SSS   32,GT                                                    10620000
         BBB   00,JATEMP2-JAWORK,20                                     10640000
*   GE                                                                  10660000
         SSS   32,GE                                                    10680000
         BBB   00,JATEMP2-JAWORK,B0                                     10700000
*   EQ                                                                  10720000
         SSS   32,EQ                                                    10740000
         BBB   00,JATEMP2-JAWORK,80                                     10760000
*   NE                                                                  10780000
         SSS   32,NE                                                    10800000
         BBB   00,JATEMP2-JAWORK,70                                     10820000
*   LE                                                                  10840000
         SSS   32,LE                                                    10860000
         BBB   00,JATEMP2-JAWORK,D0                                     10880000
*   LT                                                                  10900000
         SSS   32,LT                                                    10920000
         BBB   00,JATEMP2-JAWORK,40                                     10940000
         SPACE                                                          10960000
JAREGB   EQU   *                  REGION PDT.                           10980000
         DC    AL1(JAEND7-JAREGB)       LENGTH OF REGION PDT.      AACA 11000017
         CCC   07,40                                            YM00395 11020002
         DC    FL1'5'             MAXIMUM PARAMETER LENGTH.             11040000
         DC    XL1'21' FUNCT/TABLE.                                     11060000
         DC    AL1(JAREGOFF) OFFSET IN TABLE.                           11080000
         DC    XL2'3FFF'          MAX REGION SEZE.                 AACA 11080817
JAST7    EQU   *                                                   AACA 11082417
         DC    AL1(JAEND7-JAST7)  LENGTH LCS PDT.                  AACA 11083217
         DC    XL1'40'            CONTROL/COMPARE.                 AACA 11084017
         DC    FL1'5'             MAX PARAMETER LENGTH.            AACA 11084817
         DC    XL1'20'            CVB (2)/ JWA.                    AACA 11085617
         DC    AL1(JATEMP1-JAWORK)      OFFSET.                    AACA 11086417
         DC    XL2'3FFF'          MAX   LCS SIZE.                  AACA 11087217
JAEND7   EQU   *                                                   AACA 11088017
         SPACE                                                          11088817
JAROLLB  EQU   *                  ROLL PDT                       Y01029 11090801
         DC    AL1(JAEND2-JAROLLB)                                      11098801
JAEND2   EQU   *                                                   AACA 11101617
JACLASSB EQU   *                  CLASS PDT.                       AACA 11102417
         DC    AL1(JAEND3-JACLASSB)    LENGTH OF CLASS PDT.        AACA 11103217
JAST3    EQU   *                                                   AACA 11104017
         DC    AL1(JAEND3-JAST3)       LENGTH OF 1ST POS PARAM.    AACA 11104817
         DC    XL1'10'                 CONTROL/COMPARE             AACA 11105617
         DC    XL1'01'                 MAX PARAMETER LENGTH.       AACA 11106417
         DC    XL1'70'                 CHECK FOR ALPHA/NUMERIC.    AACA 11107217
JAEND3   EQU   *                                                   AACA 11108017
         SPACE                                                          11108817
JARDB    EQU   *                  RD PDT.                          AACA 11109617
         DC    AL1(JAEND4-JARDB)                                   AACA 11110417
JAST4    EQU   *                                                   AACA 11111217
         DC    AL1(JAEND4-JAST4)                                   AACA 11112017
         SSS   31,R                                                AACA 11112817
         BBC   01,JCTRSW2-INJMJCT,JCTRESTT                       Y02668 11113602
         SSS   32,NR                                               AACA 11114417
         BBC   01,JCTRSW2-INJMJCT,JCTNORST                       Y02668 11115202
         SSS   32,NC                                               AACA 11116017
         BBC   01,JCTRSW2-INJMJCT,JCTNOCKP                       Y02668 11116802
         SSS   63,RNC                                              AACA 11117617
         BBC   01,JCTRSW2-INJMJCT,JCTRESTT                       Y02668 11118402
         BBC   01,JCTRSW2-INJMJCT,JCTNOCKP                       Y02668 11119202
JAEND4   EQU   *                                                   AACA 11120017
         SPACE                                                          11120817
JARESTB  EQU   *                  RESTART PDT.                     AACA 11121617
         DC    AL1(JAEND6-JARESTB)     LENGTH TOTAL PDT.           AACA 11122417
JAST5    EQU   *                                                   AACA 11123217
         DC    AL1(JAEND5-JAST5)       LENGTH 1ST PARAM PDT.       AACA 11124017
         DC    XL1'20'            CTRL BYTES/COMPARE BYTES         AACA 11124817
         MMM   17,60,SRCHL1-JAWORK                                 AACA 11125617
JAEND5   EQU   *                                                   AACA 11126417
JAST6    EQU   *                                                   AACA 11127217
         DC    AL1(JAEND6-JAST6)       LENGTH CHKID PDT.           AACA 11128017
         DC    XL1'20'            CTRL BYTES/COMPARE BYTES         AACA 11128817
         MMM   16,51,JCTCKIDT-INJMJCT                            A43678 11129601
JAEND6   EQU   *                                                 Y01029 11130401
JAADDRB  EQU   *                         ADDRSPC PDT             Y01029 11132401
         DC   AL1(JAEND8-JAADDRB)        LENGTH ADDRSPC PDT      Y01029 11134401
JAST1A   EQU   *                                                 Y01029 11136501
         DC   AL1(JAEND8-JAST1A)         LENGTH POSITIONAL PDT   Y01029 11138401
         SSS   34,REAL                                          YM00395 11138802
         BBC  01,JCTSTAT2-INJMJCT,JCTADSPC                       Y01029 11139201
         SSS   04,VIRT                                          YM00395 11139602
JAEND8   EQU   *                                                 Y01029 11139901
JAPRFMB  EQU   *                        PERFORM PDT              Y02655 11140002
         DC    AL1(JAEND9-JAPRFMB)      LENGTH PERFORM PDT       Y02655 11142002
JAST9    EQU   *                                                 Y02655 11144002
         DC    AL1(JAEND9-JAST9)        LENGTH POSITIONAL PDT    Y02655 11146002
         DC    XL1'30'            CONTROL BYTE                   Y02655 11148002
         DC    FL1'3'             MAX PARAMETER LENGTH           Y02655 11150002
         DC    XL1'11'            FUNCTION/TABLE                 Y02655 11152002
         DC    AL1(JCTPRFMF-INJMJCT) OFFSET IN TABLE             Y02655 11154002
         DC    XL1'FF'            MAX NBR (CVB)                  Y02655 11156002
JAEND9   EQU   *                                                 Y02655 11158002
JAUSERB  EQU   *                   USER PDT                    @Z40RPTH 11158103
         DC    AL1(JAUSER3-JAUSERB) LENGTH OF ENTRY            @Z40RPTH 11158203
JAUSER1  DS    0C                  START OF POSITION           @Z40RPTH 11158303
         DC    AL1(JAUSER3-JAUSER1) LENGTH OF POSITION         @Z40RPTH 11158403
         DC    XL1'20'           CONTROL BYTE                  @Z40RPTH 11158503
JAUSER2  DS    0C                  START OF CONTROL BYTES      @Z40RPTH 11158603
         MMM   7,61,JCTUSER-INJMJCT                            @Z40RPTH 11158703
JAUSER3  DS    0C                  END OF ENTRY                @Z40RPTH 11158803
         SPACE 2                                               @Z40RPTH 11158903
JAPASSB  EQU   *                   JUST LABEL FOR PASSWORD     @Z40RPSM 11159003
*                                  NO FUNCTIONAL PDT           @Z40RPSM 11159103
JAGROUPB EQU   *                   GROUP PDT.                  @Z40RPSM 11159203
         DC AL1(JAGROUP3-JAGROUPB) LENGTH OF ENTRY.            @Z40RPSM 11159303
JAGROUP1 DS    0C                  START OF POSITION.          @Z40RPSM 11159403
         DC AL1(JAGROUP3-JAGROUP1) LENGTH OF POSITION.         @Z40RPSM 11159503
         DC XL1'20'                CONTROL BYTE.               @Z40RPSM 11159603
JAGROUP2 DS   0C                   START OF CONTROL BYTE.      @Z40RPSM 11159703
         MMM  8,6D,JCTXGROP-JCTXIN                             @Z40RPSM 11159803
JAGROUP3 DS   0C                   END OF ENTRY.               @Z40RPSM 11159903
*********************************************************************** 11160000
*                                                                     * 11180000
*              CONSTANTS                                              * 11200000
*                                                                     * 11220000
*********************************************************************** 11240000
FILLER   DS    0F                                                Y01029 11246401
MAXVAL   DC    XL4'00003FFF'           MAX REGION VALUE          Y01029 11249201
JA100    DC    H'100'                  CONVERSION OF SECS TO       SMF1 11252001
*                                           100THS SECS.           SMF1 11254801
JA6000   DC    H'6000'                 CONVERSION OF MINS TO       SMF1 11257601
*                                           100THS SECS            SMF1 11260401
JACON0   DC    H'0'                HALFWORD ZERO CONSTANT.      YM00376 11260902
DEC0     EQU   0                       NUMERIC EQUATE            Y02668 11261402
DEC3     EQU   3                       NUMERIC EQUATE                   11263201
DEC1     EQU   1                       NUMERIC EQUATE                   11266001
DEC8     EQU   8                       NUMERIC EQUATE                   11268801
DEC4     EQU   4                       NUMERIC EQUATE                   11271601
DEC5     EQU   5                       NUMERIC EQUATE                   11274401
EIGHT    EQU   8              MAXIMUM LENGTH OF PASSWORD       @Z40RPSM 11275103
SEVEN    EQU   7              MAXIMUM LENGTH OF NOTIFY ID      @Z40RPTH 11275803
E9       EQU   C'Z'           LETTER Z                         @Z40RPTH 11276503
JATESTOR DC    V(IEFVGT)          TEST AND STORE.                       11277201
JAGETKEP DC    V(IEFVGK)          GET KEY/POS.                          11280000
JAVHQ    DC    V(IEFVHQ)          QMANAGER INTERFACE.                   11300000
JAVGM    DC   V(IEFVGM)           MESSAGE MODULE.                       11320000
JAVHE    DC    V(IEFVHE)           CONTROL ROUTINE.              Y02668 11340002
PATCH    DC    25F'0'              **********PATCH SPACE*********Y02668 11345002
JAERDUM  DC    C'JOBFAIL '                                        22297 11350018
JAMSK1   DC    F'8'               MASK FOR COND SUBPARM CHECK.          11360000
JA144    DC    F'144'                                                   11380000
JA1      DC    F'1'                                                     11400000
         END                                                            11420000
