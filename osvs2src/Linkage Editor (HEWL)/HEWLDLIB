*TITLE 'HEWLLIBR' - LIBRARY PROCESSOR                                 * 00040021
*STATUS-CHANGE LEVEL 20                                                 00060021
*        INCREMENTAL 288 - W-CON - ADDED                        INC288  00080021
*        TSO CHANGES FOR IDENTIFY AND INCORE DATA SET                 * 00100021
*                                                               YM05556 00110001
*                                                               YM05562 00112001
*                                                               YM05575 00114001
* I063800,I112000                                               ZA01335 00116002
* C125200,C127400  PRINT UNPRINTABLE CHAR                      @Z12914* 00118037
*FUNCTION/OPERATION:                                                  * 00120021
*        1)HEWACALL-TRYS TO RESOLVE EXTERNAL REFERENCES IN THE CESD,  * 00140021
*              WHICH ARE STILL UNRESOLVED AT THE END OF THE PRIMARY   * 00160021
*              INPUT STREAM.  IT CALLS FROM PARTITIONED DATA SETS,    * 00180021
*              (OR OPTIONALLY FROM THE LINK PACK AREA)                * 00200021
*              MEMBERS WHOSE NAMES ARE EXTERNAL REFERENCES IN THE     * 00220021
*              CESD.  IT DETERMINES WHETHER THE CALLED MEMBERS ARE    * 00240021
*              OBJECT MODULES OR LOAD MODULES. THEN PASSES CONTROL    * 00260021
*              TO THE APPROPRIATE PROCESSOR.                          * 00280021
*                                                                     * 00300021
*        2)HEWLODE-DETERMINES RECORD TYPE,THEN PASSES CONTROL TO THE  * 00320021
*              APPROPRIATE ROUTINE FOR RECORD PROCESSING.             * 00340021
*                                                                     * 00360021
*        3)LMTXT-PROCESSES LOAD MODULE TEXT.                          * 00380021
*                                                                     * 00400021
*        4)COMMON-ASSIGNS ADDRESSES TO COMMON.                        * 00420021
*                                                                     * 00440021
*        5)PSEUDOR-ASSIGNS DISPLACEMENTS TO PSEUDO REGISTERS          * 00460021
*                                                                     * 00480021
*        6)FINISHUP-PRINTS FINISHING MESSAGES-UNRESOLVED ER'S,        * 00500021
*              TOTAL LENGTH,ENTRY ADDRESS. ASSIGNS ENTRY POINT        * 00520021
*                                                                     * 00540021
*        7)HEWERROR-FORMATS AND PRINTS ERROR MESSAGES. LOGS           * 00560021
*              ERROR IN BIT MAP.                                      * 00580021
*                                                                     * 00600021
*        8)HEWBTMAP-PRINTS THE DIAGNOSTIC MESSAGE DIRECTORY           * 00620021
*              FOR ERRORS LOGGED IN THE BIT MAP                       * 00640021
*                                                                     * 00660021
*ENTRY POINTS:                                                        * 00680021
*        1)HEWACALL-FOR AUTOMATIC LIBRARY CALL PROCESSING             * 00700021
*        2)HEWLODE-FOR LOAD MODULE PROCESSING                         * 00720021
*        3)HEWERROR-FOR PRINTING AND LOGGING ERROR MESSAGES           * 00740021
*        4)HEWBTMAP-FOR PRINTING DIAGNOSTIC MESSAGES FOR ERRORS       * 00760021
*              LOGGED IN BIT MAP                                      * 00780021
*                                                                     * 00800021
*INPUT:  ALL ROUTINES EXPECT                                          * 00820021
*              #13-ADDRESS OF SAVE AREA                               * 00840021
*              #14-RETURN ADDRESS                                     * 00860021
*              #15-ADDRESS OF THEIR ENTRY POINT                       * 00880021
*              #11-ADDRESS OF COMMUNICATION AREA                      * 00900021
*        IN ADDITION-IEWERROR EXPECTS                                 * 00920021
*              #0-ERROR CODE                                          * 00940021
*              #1-POINTER TO QUALIFYINY DATA(IF ANY)                  * 00960021
*EXTERNAL ROUTINES:                                                   * 00980021
*        HEWOPNLB-OPEN SYSLIB                                         * 01000021
*        HEWLRLD-PROCESSES RLD'S                                      * 01020021
*        HEWLREAD-READ CONTROL AND TEXT RECORDS                       * 01040021
*        HEWLESD-PROCESSES CESD                                       * 01060021
*        HEWLEND-PROCESSES END OF MODULE                              * 01080021
*        TRANSID-TRANSLATES ESDID TO TRANSLATION TABLE ENTRY ADDRESS  * 01100021
*        HEWLMAP-CREATES MAP PRINTOUT                                 * 01120021
*        HEWLPRNT-PRINTS MESSAGES                                     * 01140021
*        HEWLERTN-RELOCATES RLD'S                                     * 01160021
*        HEWPRIME-PRIMES BUFFERS                                      * 01180021
*        HEWLRELO-PROCESS OBJECT MODULES                              * 01200021
*        HEWLCNVT-CONVERTS BINARY QUANTITIES TO PRINTABLE HEX         * 01220021
*        HEWTERM -PRINTS DIAGNOSTICS ON SYSTERM                       * 01230000
*EXITS-NORMAL:TO CALLER       L    13,4(13)                           * 01260021
*                             SR   15,15                              * 01280021
*                             RETURN (14,12),T,RC=(15)                * 01300021
*                                                                     * 01320021
*     -ERROR: TO HEWERROR     LA    0,ERCODE                          * 01340021
*                             L    15,V(HEWERROR)                     * 01360021
*                             BALR 14,15                              * 01380021
*                                                                     * 01400021
*TABLES/WORKAREAS:REFER TO LOADER PLM FOR DETAILED DESCRIPTION        * 01420021
*        1)CESD                                                       * 01440021
*        2)TRANSLATION TABLE                                          * 01460021
*        3)BLDL LIST                                                  * 01480021
*        4)COMMUNICATIONS AREA (HEWLDCOM)                             * 01500021
*ATTRIBUTES:READ ONLY,REUSABLE,REENTRANT                              * 01520021
*NOTES: NONE                                                          * 01540021
*                                                                     * 01560021
*********************************************************************** 01580021
         EJECT                                                          01600021
HEWLLIBR CSECT                                                          01620021
*C059500                                                         S21016 01640021
*C232200                                                         M4115  01644000
*                                                               YA00126 01654001
*                                                               YA00323 01656001
*                                                               YA00398 01658001
*I063900-063920,A112100-112140                                  ZA01335 01658402
*A049131    SEE FIX FOR OY07896                                 YA07896 01658837
HEWACALL EQU   *                                                        01660021
         ENTRY HEWACALL                                                 01680021
         ENTRY HEWLODE                                                  01700021
CQFF     EQU   X'FF'                                                    01720021
EMVT     EQU   X'10'                    MVT SYSTEM                      01740021
EMFT     EQU   X'20'                    MFT SYSTEM                      01760021
ECESD    EQU   X'20'                    CESD RECORD                     01780021
ESYMSCAT EQU   X'D0'                    SYM, IDR, OR SCAT/TRANS  S21016 01800021
ETXT     EQU   X'01'                    TEXT RECORD                     01820021
ERLD     EQU   X'02'                    RLD RECORD                      01840021
ELAST    EQU   X'08'                    END OF MODULE                   01860021
ELTXT    EQU   X'08'                    TXT REC LAST IN MODULE          01880021
ELENGTH  EQU   2                        DISPLACEMENT OF LENGTH          01900021
EIDLNG   EQU   4                        LENGTH OF ENTRY IN ID/LENGTH    01920021
ERLDFLG  EQU   X'0C'                    FLAG FOR RLD                    01940021
ERLDADDR EQU   4                        FLAG-ADDRESS                    01960021
EBLDLRC  EQU   X'08'                    RETURN CODE-BLDL ERROR          01980021
EBLDLTTR EQU   8                        TTR                             02000021
EBLDLDIS EQU   4                        SIZE OF BLDL LIST DISCRIPTION   02020021
EADRLENT EQU   4                        ENTRY SIZE IN ADDRESS LIST      02040021
EBLDLR   EQU   10                       R                               02060021
EBLDLSIZ EQU   20                       BYTES NEEDED FOR EACH BLDL      02080021
*                                       ENTRY                           02100021
EBLDLENT EQU   16                       SIZE OF ENTRY                   02120021
*                                       FIELD                           02140021
ESDNAME  EQU   4                        NAME                            02160021
ERTYPE   EQU   X'02'                                                    02180021
ESDRELCH EQU   12                       PTR TO RELOCATION CHAIN         02200021
ESDCHADR EQU   0                        CHAIN ADDRESS TO NEXT ENTRY     02220021
ESDCMCHN EQU   16                       PTR TO CHAINED CM ENTRY         02240021
ESDTYPE  EQU   12                      TYPE                             02260021
ESDLAA   EQU   12                      LINK EDIT ASSIGNED ADDRESS       02280021
ESDLNG   EQU   16                       LENGTH OF CONTROL SECTION       02300021
ESDRELOC EQU   16                       RELOCATION CONSTANT             02320021
ESDPRALN EQU   16                       ALIGNMENT VALUE                 02340021
ETTR     EQU   X'10'                    TTR RECEIVED BIT IN DESD        02360021
EBLDLATT EQU   X'20'                    BLDL ATTEMPTED BIT IN CESD      02380021
EDELETE  EQU   X'80'                    DELETE BIT IN CESD              02400021
ZERO     EQU   0                                                        02420021
ENCAL    EQU   X'08'                    NEVER CALL BIT IN CESD          02440021
WEAKCALL EQU   X'40'               W-CON BIT IN CESD             INC288 02460021
ECXDADR  EQU   4                                                        02480021
PARM     EQU   1                                                        02500021
WORKA    EQU   2                                                        02520021
WORKB    EQU   3                                                        02540021
CUM      EQU   4                                                        02560021
ID       EQU   5                                                        02580021
ADR      EQU   6                                                        02600021
LNG      EQU   7                                                        02620021
PTR      EQU   8                                                        02640021
CESD     EQU   9                                                        02660021
MAINT    EQU   10                                                       02680021
CMPTR    EQU   11                                                       02700021
BASE     EQU   12                                                       02720021
SAVEREG  EQU   13                                                       02740021
RETURN   EQU   14                                                       02760021
BRANCH   EQU   15                                                       02780021
R0       EQU   0                                                        02800021
R1       EQU   1                                                        02820021
R2       EQU   2                                                        02840021
R3       EQU   3                                                        02860021
R4       EQU   4                                                        02880021
R5       EQU   5                                                        02900021
R6       EQU   6                                                        02920021
R7       EQU   7                                                        02940021
R8       EQU   8                                                        02960021
R9       EQU   9                                                        02980021
R10      EQU   10                                                       03000021
R11      EQU   11                                                       03020021
R12      EQU   12                                                       03040021
R13      EQU   13                                                       03060021
R14      EQU   14                                                       03080021
R15      EQU   15                                                       03100021
TRMRECSZ EQU   81                  LENGTH OF SYSTERM RECORD             03120021
         USING *,15                                                     03140021
         SAVE  (14,12),T,*              SAVE CALLERS REGISTERS          03160021
         LR    BASE,15                  PUT BASE ADDR IN BASE REG       03180021
         DROP  15                                                       03200021
         USING HEWACALL,BASE       ESTABLISH BASE                       03220021
         USING ERCODES,0                                                03240021
         L     SAVEREG,8(SAVEREG)       NEW SAVE AREA ADDRESS           03260021
         USING HEWLDCOM,CMPTR      COMMUNICATION AREA                   03280021
         OI    CMLIBFLG,CQAUTOC         AUTOCALL IN PROCESS             03300021
         TM    CMPRMFLG,CQCALL          AUTOCALL                        03320021
         BZ    COMMON                   NO-ASSIGN ADDR TO COMMON        03340021
         L     CESD,CMERCHN             GET PTR TO ER CHAIN             03360021
         LTR   CESD,CESD                ER CHAIN EMPTY                  03380021
         BZ    COMMON                   YES-ASSIGN ADDR TO COMMON       03400021
         TM    CMPRMFLG,CQRES           LIBRARY RESIDENT IN LPA         03420021
         BZ    OPNLIB                   NO-OPEN SYSLIB                  03440021
*                                                                       03460021
*********************************************************************** 03480021
*                                                                       03500021
*              CHECK FOR VS1/VS2 SYSTEM                                 03520001
*                                                                       03540000
*********************************************************************** 03560021
*                                                                       03580021
         LA    ADR,16                   GET ADDR OF PTR TO CVT          03600021
         L     PTR,0(ADR)               GET ADDR OF CVT                 03620021
         USING CVTSECT,PTR                                              03640021
         TM    CVTDCB,CVT4MS1           VS2 SYSTEM                      03660001
         BO    CDESRCH2                 YES - SKIP TEST FOR VS1         03680001
CDESRCH1 EQU   *                                                        03732000
         MVC   CMSYSTYP(1),CVTDCB       SET CODE FOR VS1 SYSTEM         03734001
         OI    CMLIBFLG,CQMFTLPA        SET BIT FOR VS1 LPA             03740001
LPABIT1  OI    CMLIBFLG,CQLPASRH        TURN ON LPA SEARCH BIT          03760000
*                                                                       03780021
*********************************************************************** 03800021
*                                                                       03820021
*              INITIALIZE FOR CDE SEARCH                                03840021
*                                                                       03860021
*********************************************************************** 03880021
*                                                                       03900021
LPALIB1  NI    CMRELFLG,CQFF-CQLIB      INDICATE LPA LIBRARY            03920000
         LA    WORKA,CMERCHN            GET ADDR OF PTR TO ER CHAIN     03940021
         ST    WORKA,CMPREVPT           SAVE AS PREVIOUS PTR            03960021
         LA    ADR,16                   GET ADDR OF PTR TO CVT          03980021
         L     PTR,0(ADR)               GET ADDR OF CVT                 04000021
*                                                                       04020021
*********************************************************************** 04040021
*                                                                       04060021
*              CONTENTS DIRECTORY ENTRY SEARCH FOR VS1                  04080001
*                                                                       04100021
*********************************************************************** 04120021
*                                                                       04140021
         USING CDENTRY,ADR                                              04160021
         L     ADR,CVTQLPAQ             GET ADDR OF TOP OF CONTENTS     04180021
*                                       DIRECTORY IN LPA QUEUE          04200021
         LTR   ADR,ADR                  QUEUE EMPTY                     04220021
         BZ    OPNLIB                   YES-OPEN SYSLIB                 04240021
GETNAME1 TM    ESDTYPE(CESD),ENCAL+WEAKCALL NVCALL OR W-CON      INC288 04260000
         BC    5,CDEER1            YES. GET NEXT ER              INC288 04280000
         LM    WORKA,WORKB,ESDNAME(CESD) GET NAME INTO TWO REGISTERS    04300021
CDECOMP1 C     WORKA,CDNAME             COMPARE FIRST HALF OF NAMES     04320021
         BE    CDECOMP2                 EQUAL-COMPARE SECOND HALF       04340021
NOCOMP   L     ADR,CDCHAIN              GET NEXT IN CHAIN               04360021
         LA    ADR,0(ADR)               CLEAR HIGH BYTE                 04380021
         LTR   ADR,ADR                  END OF CHAIN                    04400021
         BNE   CDECOMP1                 NO-COMPARE NAMES                04420021
CDEER1   ST    CESD,CMPREVPT            SAVE PREVIOUS POINTER           04440000
         L     CESD,ESDCHADR(CESD)      GET NEXT ER                     04460021
CDEER11  LTR   CESD,CESD                ANY LEFT                        04480000
         BZ    BLDLER                   NO-SEE IF ALL ARE RESOLVED      04500021
         L     ADR,CVTQLPAQ             GET ADDR OF FIRST CDE           04520021
         DROP  PTR                                                      04540021
         B     GETNAME1                                                 04560000
CDECOMP2 C     WORKB,CDNAME+4           COMPARE SECOND HALF OF NAME     04580021
         BNE   NOCOMP                   NOT EQUAL-CONTINUE SEARCH       04600021
         B     SDCHNG                   GO CHANGE ENTRY TO SD           04610000
*                                                                       04750000
*********************************************************************** 04752000
*                                                                       04754000
CDESRCH2 EQU   *                                                        04754400
         USING CVTSECT,PTR                                              04754500
         MVC   CMSYSTYP(1),CVTDCB       INDICATE SYSTEM IS VS2          04754801
         DROP  PTR                                                      04755200
LPABIT2  OI    CMLIBFLG,CQLPASRH        TURN ON LPA SEARCH BIT          04756000
*                                                                       04758000
*********************************************************************** 04758400
*                                                                       04758800
*              INITIALIZE FOR CDE SEARCH                                04759200
*                                                                       04759600
*********************************************************************** 04759700
*                                                                       04759800
LPALIB2  NI    CMRELFLG,CQFF-CQLIB      INDICATE LPA LIBRARY            04759900
         LA    WORKA,CMERCHN            GET ADDR OF PTR TO ER CHAIN     04766600
         ST    WORKA,CMPREVPT           SAVE AS PREVIOUS PTR            04768600
SETCVTPT LA    ADR,16                   GET ADDR OF PTR TO CVT  YM05556 04770601
         L     R3,0(ADR)                GET ADDR OF CVT         YM05254 04772601
         USING CVTSECT,R3                                       YM05254 04773001
*                                                                       04773100
*********************************************************************** 04773200
*                                                                       04779900
*              CONTENTS DIRECTORY ENTRY SEARCH FOR VS2                  04781901
*                                                                       04783900
*********************************************************************** 04785900
*                                                                       04786300
GETNAME2 TM    ESDTYPE(CESD),ENCAL+WEAKCALL NVCALL OR W-CON      INC288 04786400
         BC    5,CDEER2                YES. GET NEXT ER          INC288 04786500
         LM    R0,R1,ESDNAME(CESD)     GET NAME INTO R0 AND R1          04793200
         STM   R2,R10,CMRSAVE          SAVE REGS (IEAVVMSR WILL         04793600
*                                      CHANGE SOME OF THOSE SAVED)      04794000
         L     BRANCH,CVTLPDSR         V(IEAVVMSR)                      04795200
         BALR  RETURN,BRANCH                                            04797200
*   IEAVVMSR WILL RETURN TO R14 IF MATCH IS FOUND, R14 + 4 IF NO MATCH  04797600
         B     SDCHNG2                  MATCHING ER                     04799200
         LM    R2,R10,CMRSAVE           RESTORE REGS                    04799300
CDEER2   ST    CESD,CMPREVPT            SAVE PREVIOUS POINTER           04799600
         L     CESD,ESDCHADR(CESD)      GET NEXT ER                     04799700
CDEER12  LTR   CESD,CESD                ANY LEFT                        04799800
         BZ    BLDLER                   NO-SEE IF ALL ARE RESOLVED      04799900
         B     SETCVTPT                                         YM05556 04806501
*                                                                       04856500
*********************************************************************** 04866500
*                                                                       04876500
*              CHANGE ENTRY TO SD                                       04878500
*                                                                       04878900
*********************************************************************** 04879300
*                                                                       04879700
SDCHNG2  EQU   *                        FROM VS2 ROUTINE                04882001
         LM    R2,R10,CMRSAVE           RESTORE REGS                    04884000
SDCHNG   EQU   *                        FROM VS1 ROUTINE                04885501
         L     PARM,ESDRELCH(CESD)      GET ADDR OF RLD CHAIN           04887800
         LA    PARM,0(PARM)             CLEAR TYPE FIELD                04890100
         TM    CMSYSTYP,CVT4MS1         VS2 SYSTEM?                     04892401
         BO    ENTR2                    GET ENTRY POINT FOR VS2         04894701
         TM    CMLIBFLG,CQMFTLPA        MFT LPA                         04897000
         BO    MFTENTRY                 YES-GET ENTRY POINT             04899300
         L     CUM,CDENTPT              GET ENTRY POINT ADDRESS         04901600
         B     CLEARFLG                 AROUND VS2 ENTRY POINT          04903901
ENTR2    EQU   *                        VS2 SYSTEM                      04906201
         LR    CUM,R0                   GET ENTRY POINT ADDR            04908500
CLEARFLG EQU   *                                                        04910800
         L     CUM,16(CUM)              ENTRY POINT             YA07896 04913137
         ST    CUM,ESDRELCH(CESD)       PUT IN CESD ENTRY               04915400
         L     WORKA,ESDCHADR(CESD)     GET PTR TO NEXT ER              04917700
         ST    WORKA,CMBLDLPT           SAVE IT                         04920021
         L     WORKB,CMPREVPT           REMOVE MATCHED ER FROM CHAIN    04940021
         ST    WORKA,0(WORKB)                                           04960021
         L     WORKB,CMSDCHN            PUT ON SD CHAIN                 04980021
         ST    WORKB,0(CESD)                                            05000021
         ST    CESD,CMSDCHN                                             05020021
         L     BRANCH,MAPRTN            GET ADDR OF MAP ROUTINE         05040021
         BALR  RETURN,BRANCH            MAP ENTRY                       05060021
         L     BRANCH,RLDRES            RELOCATE RLD'S                  05080021
         BALR  RETURN,BRANCH                                            05100021
         L     CESD,CMBLDLPT            GET NEXT ER                     05120021
         TM    CMSYSTYP,CVT4MS1         VS2 SYSTEM?                     05130001
         BO    CDEER12                  LOOK FOR MATCH IN VS2           05140001
         B     CDEER11                  LOOK FOR MATCH IN VS1           05152001
MFTENTRY L     CUM,CDENTPT+4            GET ADDR OF ENTRY POINT         05160021
         B     CLEARFLG                 MAKE INTO SD ENTRY              05180021
BLDLER   L     CESD,CMERCHN             GET ADDR OF FIRST ER            05200021
         LTR   CESD,CESD                ANY ER'S                        05220021
         BZ    COMMON                   NO-ASSIGN ADDR TO COMMON        05240021
         DROP  ADR                                                      05260021
*                                                                       05280021
*********************************************************************** 05300021
*                                                                       05320021
*              OPEN SYSLIB                                              05340021
*                                                                       05360021
*********************************************************************** 05380021
*                                                                       05400021
OPNLIB   TM    CMSTATUS,CQLIBOPN       IS SYSLIB OPEN?                  05420021
         BO    MOREER                  YES                              05440021
         L     BRANCH,OPNSYSLI         NO, GET ADDR OF OPEN RTN         05460021
         BALR  RETURN,BRANCH            OPEN SYSLIB                     05480021
         TM    CMSTATUS,CQLIBOPN        SYSLIB OPEN                     05500021
         BZ    COMMON                   NO-ASSIGN ADDRESSES TO COMMON   05520021
*                                                                       05540021
*********************************************************************** 05560021
*                                                                       05580021
*              INITIAL BLDL LIST-GET START ADDRESS AND MAXIMUM          05600021
*              NUMBER OF ENTRIES                                        05620021
*                                                                       05640021
*********************************************************************** 05660021
*                                                                       05680021
MOREER   OI    CMRELFLG,CQLIB           INDICATE SYSLIB                 05700021
         L     LNG,CMLOWTBL             GET LOW TABLE ADDRESS           05720021
         L     PTR,CMNXTTXT             GET HIGH TEXT ADDRESS           05740021
         ST    PTR,CMBLDLPT             USE AS ADDR OF BLDL LIST        05760021
         LA    WORKA,EBLDLENT           FOR INITIALIZING BLDL LIST      05780021
         ST    WORKA,0(PTR)             INITIALIZE FIRST 2 HALF WORDS   05800021
*                                       IN BLDL LIST TO 0 AND 26        05820021
         LA    PTR,EBLDLDIS(PTR)                                        05840021
         SR    LNG,PTR                  GET LENGTH OF BLDL LIST         05860021
         SR    ADR,ADR                  CLEAR EVEN REG FOR DIVIDE       05880021
         LA    WORKA,EBLDLSIZ           BLDL ENTRY SIZE PLUS BLDL LIST  05900021
         DR    ADR,WORKA                DIVIDE SIZE OF BLDL LIST AREA   05920021
*                                       BY 20 TO GET NUMBER OF ENTRIES  05940021
         LR    ADR,PTR                  FOR ADDR OF LAST USED POSITION  05960021
*                                       IN BLDL LIST                    05980021
         LR    WORKB,PTR                                                06000021
         LR    ID,PTR                                                   06020021
         LA    WORKA,EBLDLENT           SIZE OF EACH ENTRY              06040021
         SR    CUM,CUM                  CLEAR-NUM OF ENTRIES            06060021
         L     CESD,CMERCHN                                             06080021
*                                                                       06100021
*********************************************************************** 06120021
*                                                                       06140021
*              SET UP BLDL LIST                                         06160021
*                                                                       06180021
*********************************************************************** 06200021
*                                                                       06220021
ENDCH    LTR   CESD,CESD                END OF ER CHAIN                 06240021
         BE    ANYENT                   YES-SEE IF ANY ENTRIES IN BLDL  06260021
         TM    ESDTYPE(CESD),EBLDLATT   HAS BLDL BEEN ATTEMPTED         06280021
         BZ    MNCAL                    NO-SEE IF MARKED NCAL           06300021
NXTER    L     CESD,ESDCHADR(CESD)      GET PTR TO NEXT ER              06320021
         B     ENDCH                    SEE IF END OF CHAIN             06340021
MNCAL    TM    ESDTYPE(CESD),ENCAL+WEAKCALL  NVCALL OR W-CON     INC288 06360021
         BC    5,NXTER             YES. GET NEXT ER              INC288 06380021
         TM    ESDRELOC(CESD),X'80'    SPECIAL DELETE BIT ON?   ZA01335 06390002
         BO    NXTER                   YES, DON'T RESOLVE       ZA01335 06392002
         OI    ESDTYPE(CESD),EBLDLATT   TURN ON BLDL ATTEMPTED BIT      06400021
         LTR   CUM,CUM                  FIRST ENTRY                     06420021
         BNZ   LASTENTR                                                 06440021
         LTR   LNG,LNG                  MAXIMUM NUM ENTRIES ZERO        06460021
         BNZ   ENTER1                   NO-MOVE NAME INTO BLDL LIST     06480021
*                                                                       06500021
*********************************************************************** 06520021
*                                                                       06540021
*              PRINT ERROR MESSAGE-PROGRAM TOO LARGE                    06560021
*                                                                       06580021
*********************************************************************** 06600021
*                                                                       06620021
TOOBIG   LA    ZERO,ERSIZE2             GET ERROR CODE FOR BIT MAP      06640021
         L     BRANCH,LOGRTN            GET ADDR OF ERROR LOG RTN       06660021
         BR    BRANCH                   LOG ERROR MESSAGE               06680021
*                                                                       06700021
*********************************************************************** 06720021
*                                                                       06740021
*              PUT NAMES IN ALPHABETICAL ORDER                          06760021
*                                                                       06780021
*********************************************************************** 06800021
*                                                                       06820021
ANYENT   LTR   CUM,CUM                  ANY ENTRIES IN BLDL LIST        06840021
         BZ    COMMON                   NO-ASSIGN ADDR TO COMMON        06860021
         B     MOVEADR                                                  06880021
LASTENTR LA    ID,EBLDLENT(ID)                                          06900021
COMPNAME CLC   ESDNAME(8,CESD),0(PTR)   COMPARE THIS NAME TO PREVIOUS   06920021
*                                       NAME IN LIST                    06940021
         BNL   ENTER                    LOW OR EQUAL MOVE NAME TO LIST  06960021
         LA    ADR,EBLDLENT(PTR)        GET ADDR OF NEXT POSITION       06980021
*                                       IN BLDL LIST                    07000021
         MVC   0(12,ADR),0(PTR)         MOVE PREVIOUS NAME DOWN ONE     07020021
*                                       POSITION                        07040021
         CR    PTR,WORKB                PTR AT FIRST ENTRY              07060021
         BE    ENTER1                                                   07080021
         SR    PTR,WORKA                SET PTR BACK ONE ENTRY          07100021
         B     COMPNAME                                                 07120021
ENTER    LA    PTR,EBLDLENT(PTR)        GET ADDR OF NEXT POSITION       07140021
ENTER1   MVC   0(8,PTR),ESDNAME(CESD)   MOVE NAME INTO BLDL LIST        07160021
         ST    CESD,8(PTR)              PUT ADDR OF CESD ENTRY NEXT     07180021
*                                       TO NAME                         07200021
         LA    CUM,1(CUM)               UPDATE NUMBER OF ENTRIES        07220021
         LR    PTR,ID                                                   07240021
         CR    CUM,LNG                  NUMBER OF ENTRIES EQUAL MAX     07260021
         BNE   NXTER                    NO-GET NEXT ER                  07280021
*                                                                       07300021
*********************************************************************** 07320021
*                                                                       07340021
*              PUT ADDRESSES OF CESD ENTRIES IN ADDRESS LIST            07360021
*                                                                       07380021
*********************************************************************** 07400021
*                                                                       07420021
MOVEADR  LR    ADR,WORKB                ADDR OF FIRST BLDL ENTRY        07440021
         LA    PTR,EBLDLENT(ID)         ADDR OF FIRST ADR LIST ENTRY    07460021
         LR    WORKA,PTR                SAVE ADDRESS                    07480021
         L     WORKB,CMBLDLPT           GET ADDR OF BLDL LIST           07500021
         STH   CUM,0(WORKB)             PUT IN NUMBER OF ENTRIES        07520021
         LR    LNG,CUM                  NUMBER OF ENTRIES IN LIST       07540021
         LR    ID,ADR                   SAVE FIRST ENTRY ADDRESS        07560021
ADRLIST  MVC   0(4,PTR),8(ADR)          MOVE CESD ADDR FROM BLDL LIST   07580021
         LA    ADR,EBLDLENT(ADR)        GET ADDR OF NEXT ENTRY          07600021
         LA    PTR,EADRLENT(PTR)                                        07620021
         BCT   LNG,ADRLIST              BRANCH UNTIL NO MORE ENTRIES    07640021
*                                                                       07660021
*********************************************************************** 07680021
*                                                                       07700021
*              ISSUE BLDL MACRO                                         07720021
*                                                                       07740021
*********************************************************************** 07760021
*                                                                       07780021
DOBLDL   L     PARM,CMRDCBPT            GET ADDR OF SYSLIB DCB          07800021
         L     ZERO,CMBLDLPT            GET ADDR OF BLDL LIST           07820021
         BLDL  (1),(0)                                                  07840021
         LA    WORKB,EBLDLRC            GET RETURN CODE FOR BLDL ERR    07860021
         CR    BRANCH,WORKB             BLDL ERROR?                     07880021
         BNE   MOVETTR                  NO-CONTINUE                     07900021
         LA    ZERO,ERIOUT4             GET ERROR CODE FOR BLDL ERROR   07920021
         L     BRANCH,LOGRTN            GET ADDR OF ERROR LOG RTN       07940021
         BALR  RETURN,BRANCH            LOG ERROR                       07960021
         B     COMMON                   ASSIGN ADDR TO COMMON           07980021
*                                                                       08000021
*********************************************************************** 08020021
*                                                                       08040021
*              PUT TTR'S IN CESD ENTRIES                                08060021
*                                                                       08080021
*********************************************************************** 08100021
*                                                                       08120021
MOVETTR  LR    PTR,WORKA                GET ADDR OF FIRST ENTRY IN      08140021
*                                       ADDRESS LIST                    08160021
         LR    ADR,ID                   GET ADDR FIRST BLDL ENTRY       08180021
HAVETTR  CLI   EBLDLR(ADR),X'00'        THIS ENTRY NOT FOUND-R=0        08200021
         BE    NXTENT                   YES-GET NEXT ENTRY              08220021
         L     WORKB,0(PTR)             GET ADDR OF CESD ENTRY          08240021
         MVC   ESDRELOC(4,WORKB),EBLDLTTR(ADR) MOVE TTR TO CESD         08260021
         OI    ESDTYPE(WORKB),ETTR      MARK CESD ENTRY TTR             08280021
NXTENT   LA    ADR,EBLDLENT(ADR)        INCREMENT BLDL LIST POINTER     08300021
         LA    PTR,EADRLENT(PTR)        INCREMENT ADDRESS LIST POINTER  08320021
         BCT   CUM,HAVETTR              PROCESS ALL ENTRIES             08340021
         L     CESD,CMERCHN             PICK UP ER CHAIN PTR            08360021
NEXT     LTR   CESD,CESD                END OF CHAIN                    08380021
         BZ    TESTLIB                  YES-ANY MORE ER'S               08400021
         TM    ESDTYPE(CESD),ETTR       THIS ENTRY HAVE TTR             08420021
         BO    DOFIND                   YES-ISSUE FIND MACRO            08440021
NEXT1    L     CESD,ESDCHADR(CESD)      PICK UP PTR TO NEXT ER          08460021
         B     NEXT                                                     08480021
*                                                                       08500021
*********************************************************************** 08520021
*                                                                       08540021
*              ISSUE FIND MACRO                                         08560021
*                                                                       08580021
*********************************************************************** 08600021
*                                                                       08620021
DOFIND   NI    ESDTYPE(CESD),CQFF-ETTR  TURN OFF TTR RECEIVED BIT       08640021
         LA    WORKA,ESDRELOC(CESD)     GET ADDR OF TTR FOR FIND        08660021
         L     ADR,CMRDCBPT             GET ADDR OF SYSLIB DCB          08680021
         FIND  (ADR),(WORKA),C                                          08700021
         LA    R0,72                                                    08704021
         LR    R1,R13                                                   08708021
         SR    R1,R0              GET NEXT SAVE AREA IN CHAIN           08712021
         ST    R1,8(R13)          RESET FORWARD PTR                     08716021
         NI    CMIOFLGS,CQFF-CQEOCB-CQEOFB-CQEOFSB-CQIGNCR              08720021
*                                       INITIALIZE EOF BITS             08740021
         TM    CMIOFLGS,CQRECFM         LOAD MODULE-CHECK RECFM IN DCB  08760021
         BZ    OBJECT                   NO-PRIME OBJ MOD BUFFERS        08780021
         L     BRANCH,LOADRTN           GET ADDR OF LOAD MOD PROC       08800021
         BALR  RETURN,BRANCH            PROCESS LOAD MODULE             08820021
TESTCC   L     CESD,CMERCHN                                             08840021
         B     NEXT                                                     08860021
OBJECT   L     BRANCH,PRIMRTN           GET ADDR OF PRIME ROUTINE       08880021
         BALR  RETURN,BRANCH            GO PRIME OBJ MOD BUFFERS        08900021
         L     BRANCH,RELORTN           GET ADDR OF OBJ MOD PROCESSOR   08920021
         BALR  RETURN,BRANCH            GO PROCESS OBJ MODULE           08940021
         B     TESTCC                                                   08960021
*                                                                       08980021
*********************************************************************** 09000021
*                                                                       09020021
*              CHECK FOR MORE ER'S AND WHICH LIBRARY TO SEARCH          09040021
*                                                                       09060021
*********************************************************************** 09080021
*                                                                       09100021
TESTLIB  L     CESD,CMERCHN             GET ADDR OF FIRST ER            09120021
         LTR   CESD,CESD                CHAIN EMPTY                     09140021
         BZ    COMMON                   YES-ASSIGN ADDR TO COMMON       09160021
         TM    CMLIBFLG,CQLPASRH        RESIDENT LIBRARY                09180021
         BO    SRCLPA                   YES-SEARCH LPA AREA             09200000
         B     MOREER                   NO-ISSUE BLDL                   09220021
SRCLPA   EQU   *                                                        09230000
         TM    CMSYSTYP,CVT4MS1         VS2 SYSTEM?                     09232001
         BO    LPALIB2                  SEARCH VS2 LPA                  09234001
         B     LPALIB1                  SEARCH VS1 LPA                  09238001
*********************************************************************** 09240021
*                                                                       09260021
*              ASSIGN ADDRESSES TO COMMON                               09280021
*                                                                       09300021
*********************************************************************** 09320021
*                                                                       09340021
COMMON   NI    CMLIBFLG,CQFF-CQAUTOC    TURN OFF AUTOCALL BIT           09360021
         L     CESD,CMCMCHN             PICK UP PTR TO COMMON CHAIN     09380021
         MVC   CMTOPCOD(4),CMNXTTXT  SAVE TOP OF CODE WHICH CAN'T BE    09400021
*                                    OVERLAID.                          09420021
COMMON1  LTR   CESD,CESD                END OF CHAIN                    09440021
         BZ    PSEUDOR                  YES-ASSIGN DISPLACEMENTS TO PR  09460021
         L     PARM,ESDRELCH(CESD)      GET ADDR OF ER CHAIN FOR  RELOC 09480021
         LA    PARM,0(PARM)             CLEAR TYPE FIELD                09500021
         IC    WORKB,ESDTYPE(CESD)      SAVE TYPE FIELD                 09520021
         L     PTR,ESDCMCHN(CESD)       PICK UP PTR TO CHAINED CM ENTRY 09540021
         L     ADR,CMNXTTXT             GET NEXT TXT ADDRESS            09560021
         OI    CMFLAG4,CQCOMMON        SHOW COMMON RECEIVED             09580021
         LA    ADR,7(ADR)               ROUND IT TO DOUBLEWORD BOUNDARY 09600021
*                                       ADD SEVEN                       09620021
         ST    ADR,ESDRELCH(CESD)       PLACE IN ESD ENTRY              09640021
         NI    ESDRELCH+3(CESD),X'F8'   AND OFF 3 LOW ORDER BITS        09660021
         L     ADR,ESDRELCH(CESD)       GET ROUNDED OFF ADDRESS         09680021
         ST    ADR,ESDCMCHN(CESD)                                       09700021
         STC   WORKB,ESDTYPE(CESD)      RESTORE TYPE                    09720021
         L     WORKA,ESDLNG(PTR)        GET LENGTH OF COMMON            09740021
         LA    WORKA,0(WORKA)                                           09760021
         AR    ADR,WORKA                ADD LENGTH OF COMMON TO ADDR    09780021
         C     ADR,CMHITBL              LESS THAN HIGH TABLE            09800021
         BNL   TOOBIG                   NOT LOW-TERMINATE               09820021
         ST    ADR,CMNXTTXT             UPDATE NEXT TXT ADDR            09840021
         L     BRANCH,MAPRTN            GET ADDR OF MAP ROUTINE         09860021
         BALR  RETURN,BRANCH            MAP ENTRY                       09880021
         L     BRANCH,RLDRES            GET ADDR OF RLD RESOLUTION RTN  09900021
         BALR  RETURN,BRANCH            RESOLVE RLD'S                   09920021
         L     CESD,ESDCHADR(CESD)      PICK UP NEXT PTR IN CHAIN       09940021
         B     COMMON1                                                  09960021
*                                                                       09980021
*********************************************************************** 10000021
*                                                                       10020021
*              ASSIGN DISPLACEMENTS TO PSEUDO REGISTERS                 10040021
*                                                                       10060021
*********************************************************************** 10080021
*                                                                       10100021
PSEUDOR  SR    CUM,CUM                  ZERO LOCATION CTR FOR PR'S      10120021
         LH    WORKB,CMWTBFCT          PICK UP COUNT IN BUFFER          10140021
         LTR   WORKB,WORKB             IS COUNT ZERO                    10160021
         BZ    PSEUDOR1                YES-DON'T CLEAR BUFFER           10180021
         L     BRANCH,PRTRTN            GET ADDR OF IEWLPRNT            10200021
         BALR  RETURN,BRANCH            PURGE RRINT BUFFER              10220021
PSEUDOR1 L     CESD,CMPRCHN             PICK UP ADDR OF PR CHAIN        10240021
         LTR   CESD,CESD                END OF CHAIN                    10260021
         BZ    FINISHUP                 SKIP THIS ROUTINE               10280021
         MVI   CMPRTCTL,CTSPACE2        SET UP CARRIAGE CONTROL         10300021
PRC2     SR    WORKA,WORKA              CLEAR REGISTER                  10320021
         SR    LNG,LNG                                                  10340021
         BCTR  WORKA,0                  SET TO ALL FF'S                 10360021
         IC    LNG,ESDPRALN(CESD)       PICK UP ALIGNMENT FACTOR        10380021
         SR    WORKA,LNG                SUBTRACT ALIGN FACTOR FROM FF'S 10400021
         AR    CUM,LNG                  ADD ALIGNMENT FACTOR TO PR      10420021
*                                       LOCATION COUNTER                10440021
         NR    CUM,WORKA                AND SUM WITH F'S-ALIGNMENT      10460021
*                                       VALUE EQUAL ASSIGNED ADDRESS    10480021
         IC    WORKB,ESDTYPE(CESD)      SAVE TYPE FIELD                 10500021
         L     PARM,ESDTYPE(CESD)       GET ADDR OF RLD'S FOR RELOC     10520021
         LA    PARM,0(PARM)             CLEAR HIGH BYTE                 10540021
         ST    CUM,ESDTYPE(CESD)        PUT ASSIGN ADDR IN CESD         10560021
         STC   WORKB,ESDTYPE(CESD)      RESTORE TYPE                    10580021
         L     WORKA,ESDLNG(CESD)       GET LENGTH OF PR                10600021
         LA    WORKA,0(WORKA)           CLEAR HIGH BYTE                 10620021
         AR    CUM,WORKA                ADD LENGTH TO PR LOCATION CTR   10640021
         L     BRANCH,MAPRTN            GET ADDR OF MAP ROUTINE         10660021
         BALR  RETURN,BRANCH            MAP CESD ENTRY                  10680021
         L     BRANCH,RLDRES            GET ADDR OF RLD RESOLUTION RTN  10700021
         BALR  RETURN,BRANCH                                            10720021
         L     CESD,ESDCHADR(CESD)      GET PTR TO NEXT PR              10740021
         LTR   CESD,CESD                END OF CHAIN                    10760021
         BNZ   PRC2                                                     10780021
PRA4     L     BRANCH,PRTRTN            GET ADDR OF IEWLPRNT(PRINT RTN) 10800021
         BALR  RETURN,BRANCH            FLUSH LAST MAP LINE             10820021
PRA5     MVI   CMPRTCTL,CTSPACE2        SET UP CARRIAGE CONTROL         10840021
         L     ADR,CMCXDPT              GET ADDR OF LOCATION REQUESTING 10860021
*                                       CUMULATIVE LENGTH               10880021
NEXTCXD1 LTR   ADR,ADR                 ZERO IF NCAL SPECIFIED           10900021
         BZ    FINISHUP                 SKIP FILLING IN LENGTH FOR CXD  10920021
NEXTCXD  L     WORKA,ECXDADR(ADR)       GET ADDR OF LOCATION REQUESTING 10940021
         ST    CUM,0(WORKA)             PUT TOTAL LENGTH AT THAT LOC    10960021
         L     ADR,0(ADR)               GET ADDR OF NEXT LOC            10980021
         B     NEXTCXD1                CHECK FOR NEXT CXD               11000021
*                                                                       11020021
*********************************************************************** 11040021
*                                                                       11060021
*              ISSUE UNRESOLVED ER MESSAGES                             11080021
*                                                                       11100021
*********************************************************************** 11120021
*                                                                       11140021
FINISHUP L     CESD,CMERCHN             GET ADDR OF ER CHAIN            11160021
DEB2     LTR   CESD,CESD                END OF CHAIN                    11180021
         BZ    NOTXT                                                    11200021
         TM    ESDRELOC(CESD),X'80'    SPECIAL DELETE BIT ON?   ZA01335 11210002
         BO    DEF2                    YES, NO MESSAGE          ZA01335 11212002
         TM    CMPRMFLG,CQCALL          AUTOCALL SPECIFIED              11220021
         BZ    DED2                     NO-ISSUE WARNING MESSAGES       11240021
         TM    ESDTYPE(CESD),ENCAL      MARKED NEVER CALL               11260021
         BO    DED2                     YES-WARNING MESSAGE             11280021
         TM    ESDTYPE(CESD),WEAKCALL  IS IT MARKED W-CON        INC288 11300021
         BO    DEF2                YES. GET NEXT ER              INC288 11320021
         LA    ZERO,ERRELO2             GET ERROR CODE FOR ERROR MSG    11340021
         B     DEE2                                                     11360021
NOTXT    TM    CMLIBFLG,CQNOTXT         SEE IF ANY TXT RECEIVED         11380021
         BO    DEA4                     YES-FIND ENTRY PT               11400021
         LA    ZERO,ERINPT3             GET ERROR CODE FOR NO TEXT      11420021
         L     BRANCH,LOGRTN            GET ADDR OF ERROR LOG RTN       11440021
         BALR  RETURN,BRANCH            LOG ERROR MESSAGE               11460021
         B     BADCC                    QUIT                            11480021
DED2     LA    ZERO,ERRELO1             GET ERROR CODE FOR WARNING MSG  11500021
DEE2     LA    PARM,ESDNAME(CESD)                                       11520021
         L     BRANCH,LOGRTN            GET ADDR OF LOG ROUTINE         11540021
         BALR  RETURN,BRANCH            LOG ERROR MESSAGE               11560021
DEF2     L     CESD,ESDCHADR(CESD)      GET ADDR OF NEXT ER IN CHAIN    11580021
         B     DEB2                                                     11600021
*                                                                       11620021
*********************************************************************** 11640021
*                                                                       11660021
*              FIND ENTRY POINT ADDRESS                                 11680021
*                                                                       11700021
*********************************************************************** 11720021
*                                                                       11740021
DEA4     TM    CMPRMFLG,CQEPNAME+CQEPADDR ENTRY POINT NAME AND ADDRESS  11760021
*                                         RECEIVED                      11780021
         BO    DEB3                     YES-ENTRY ADDR ALREADY SET      11800021
         BZ    USETXT                   NEITHER-USE FIRST TXT ADDR      11820021
         TM    CMPRMFLG,CQEPNAME        ENTRY POINT NAME RECEIVED       11840021
         BO    USETXT1                  YES-USE FIRST TXT               11860021
         L     CESD,CMEPCESD            GET ADDR OF EP CESD             11880021
         TM    ESDTYPE(CESD),ERTYPE     EP AN ER?                       11900021
         BO    USETXT2                                                  11920021
         B     DEB3                                                     11940021
USETXT   LA    ZERO,ERENTR1             ERROR CODE FOR NEITHER EP NAME  11960021
*                                       OR EP ADDR RECEIVED             11980021
         B     ERRO                                                     12000021
USETXT1  LA    ZERO,ERENTR2             ERROR CODE FOR EP NAME NOT      12020021
*                                       FOUND                           12040021
         LA    PARM,CMEPNAME           PRINT NAME RECEIVED              12060021
ERRO     L     BRANCH,LOGRTN                                            12080021
         BALR  RETURN,BRANCH                                            12100021
USETXT2  LH    WORKA,CMNUMXS       GET NUMBER OF EXTENTS                12120021
         LTR   WORKA,WORKA         ANY PRELOADED TEXT                   12140021
         BNZ   DEB3                YES. LEAVE EP  ADDR                  12160021
         MVC   CMEPADDR(4),CMBEGADR  UES FIRST TEXT AS EP.              12180021
DEB3     L     PARM,CMNXTTXT            GET ADDR OF NXT FREE TXT        12200021
         S     PARM,CMBEGADR            SUBTRACT ADDR OF BEGINNING OF   12220021
*                                       TXT FROM ADDR OF END OF TXT     12240021
         L     WORKA,CMXLCHN       GET EXTENT CHAIN                     12260021
LEN1     LTR   WORKA,WORKA         ANY PRE-LOADED TEXT                  12280021
         BZ    LEN2                NO. BRANCH                           12300021
         A     PARM,8(WORKA)       YES. ADD LENGTH OF EXTENT            12320021
         L     WORKA,0(WORKA)      GET NEXT EXTENT IN CHAIN             12340021
         B     LEN1                LOOP BACK                            12360021
LEN2     EQU   *                                                        12380021
         ST    BASE,CMBLDLPT            SAVE BASE REGISTER              12400021
         L     BRANCH,CNVTRTN           GET ADDR OF CONVERT ROUTINE     12420021
         BALR  RETURN,BRANCH            CONVERT LENGTH TO PRINTABLE HEX 12440021
         L     BASE,CMBLDLPT            RESTORE BASE REGISTER           12460021
         L     ADR,CMPUTREC             GET ADDR OF PRINT BUFFER        12480021
         MVC   3(MSG2LNG,ADR),MSG2      TOTAL LENGTH                    12500021
         MVC   6+MSG2LNG(6,ADR),CMXDBLWD+1  MOVE IN LENGTH      @Z12914 12520037
         MVI   CMPRTCTL,CTSPACE2        SET UP CARRIAGE CONTROL         12540021
         L     BRANCH,PRTRTN            GET ADDR OF PRINT ROUTINE       12560021
         BALR  RETURN,BRANCH                                            12580021
         L     PARM,CMEPADDR            GET ENTRY POINT ADDR            12600021
         ST    BASE,CMBLDLPT            SAVE BASE REGISTER              12620021
         L     BRANCH,CNVTRTN                                           12640021
         BALR  RETURN,BRANCH                                            12660021
         L     BASE,CMBLDLPT            RESTORE BASE REGISTER           12680021
         L     ADR,CMPUTREC             GET ADDR OF PRINT BUFFER        12700021
         MVC   3(MSG3LNG,ADR),MSG3      ENTRY ADDRESS                   12720021
         MVC   5+MSG3LNG(6,ADR),CMXDBLWD+1  MOVE IN ADDR        @Z12914 12740037
         L     BRANCH,PRTRTN                                            12760021
         BALR  RETURN,BRANCH                                            12780021
         B     BADCC1                                                   12800021
         DROP  BASE                                                     12820021
         EJECT                                                          12840021
*                                                                       12860021
*********************************************************************** 12880021
*                                                                       12900021
*              LOAD MODULE PROCESSOR                                    12920021
*                                                                       12940021
*********************************************************************** 12960021
*                                                                       12980021
         USING *,BRANCH                                                 13000021
HEWLODE  SAVE  (14,12),T,*        SAVE CALLERS REGISTERS                13020021
         L     BASE,AUTOCALL                                            13040021
         DROP  15                                                       13060021
         USING HEWACALL,BASE                                            13080021
         L     SAVEREG,8(SAVEREG)       NEW SAVE AREA ADDRESS           13100021
         NI    CMLIBFLG,CQFF-CQFIRST    INITIALIZE FLAGE                13120021
*                                                                       13140021
*********************************************************************** 13160021
*                                                                       13180021
*              READ CONTROL RECORD                                      13200021
*                                                                       13220021
*********************************************************************** 13240021
*                                                                       13260021
RDCNTRL  SR    ZERO,ZERO                INDICATE READ CONTROL RECORD    13280021
         L     BRANCH,READRTN           GET ADDRESS OF READ ROUTINE     13300021
         BALR  RETURN,BRANCH            GO TO READ                      13320021
RDCNTRL1 TM    CMIOFLGS,CQEOCB          END OF CONCATENATION            13340021
         BO    PROCEOM                  YES-PROCESS END OF MODULE       13360021
IGN      NI    CMLIBFLG,CQFF-CQDELETE-CQKEEPS                           13380021
         TM    CMIOFLGS,CQIGNCR         IGNORE CONTROL REC BIT ON       13400021
         BO    RDCNTRL                  YES-READ ANOTHER RECORD         13420021
         L     ADR,CMGETREC             GET ADDR OF INPUT BUFFER        13440021
         USING DCNTRLB,ADR              ESTABLISH DSECT ADDRESS         13460021
         TM    DTYPE,ESYMSCAT           REC TYPE SYM OR SCAT/TRAN       13480021
         BM    RDCNTRL                  YES-IGNORE-READ ANOTHER REC     13500021
         TM    DTYPE,ECESD              RECORD TYPE CESD                13520021
         BZ    FINCESD1                 NO-FINISH PROCESSING CESD       13540021
         OI    CMLIBFLG,CQFIRST         FIRST REC IS CESD               13560021
         OI    CMLIBFLG,CQCESDR         TURN ON CESD RECEIVED BIT       13580021
         LH    ID,DESID                 GET ID OF FIRST ITEM            13600021
         LH    LNG,DCOUNT               GET COUNT OF ESD DATA           13620021
         LA    PTR,DESDDATA             GET ADDR OF START OF DATA       13640021
         L     BRANCH,CESDRTN           GET ADDR OF ESD PROCESSOR       13660021
         BALR  RETURN,BRANCH            PROCESS ESD'S                   13680021
         B     RDCNTRL                  READ ANOTHER CONTROL RECORD     13700021
*                                                                       13720021
*********************************************************************** 13740021
*                                                                       13760021
*              PROCESS CESD                                             13780021
*                                                                       13800021
*********************************************************************** 13820021
*                                                                       13840021
FINCESD1 TM    CMLIBFLG,CQFIRST         WAS FIRST REC CESD              13860021
         BO    FINCESD                  YES-CONTINUE                    13880021
         LA    ZERO,ERINPT6             SET ERROR CODE-INVALID INPUT    13900021
         L     BRANCH,LOGRTN            GET ADDR OF LOG ROUTINE         13920021
         BALR RETURN,BRANCH             LOG ERROR                       13940021
         B     BADCC1                   RETURN                          13960021
FINCESD  TM    CMLIBFLG,CQCESDR         TEST CESD RECEIVED ON           13980021
         BZ    PROCRAT                  NO-PROCESS RLD'S AND TXT        14000021
         NI    CMLIBFLG,CQFF-CQCESDR    TURN OFF CESD RECEIVED BIT      14020021
         L     BRANCH,CESDRTN           GET ADDR OF ESD PROCESSOR       14040021
         BALR  RETURN,BRANCH            FINISH PROCESSING CESD          14060021
PROCRAT  TM    DTYPE,ERLD               RECORD TYPE RLD                 14080021
         BZ    PROCTXT                  NO-PROCESS TXT                  14100021
         LH    LNG,DRLDCNT              COUNT OF RLD DATA               14120021
         LA    PTR,DRLDDATA             GET ADDR OF START OF RLD DATA   14140021
         L     BRANCH,RLDRTN            GET ADDR OF RLD PROCESSOR RTN   14160021
         BALR  RETURN,BRANCH            PROCESS RLD'S                   14180021
         TM    DTYPE,ETXT               ALSO TXT CONTROL RECORD         14200021
         BO    LMTXT                    YES-GO TO LOAD MOD TXT PROCESS  14220021
         TM    DTYPE,ELAST              LAST RECORD BIT ON              14240021
         BZ    RDCNTRL                  NO-READ ANOTHER CONTROL RECORD  14260021
         TM    CMLIBFLG,CQAUTOC         AUTOCALL BIT ON                 14280021
         BO    PROCEOM                  GO TO EOM PROCESSOR             14300021
         OI    CMIOFLGS,CQIGNCR         SET IGNORE CONTROL REC BIT ON   14320021
         B     RDCNTRL                  READ ANOTHER RECORD             14340021
PROCTXT  TM    DTYPE,ETXT               TXT CONTROL RECORD              14360021
         BO    LMTXT                    GO TO LOAD MOD TXT PROCESSOR    14380021
         LA    ZERO,ERINPT6             SET ERROR CODE-INVALID INPUT    14400021
*                                       FROM LOAD MODULE                14420021
         L     BRANCH,LOGRTN            GET ADDR OF LOG ROUTINE         14440021
         BALR  RETURN,BRANCH            GO TO LOG ERROR MESSAGE         14460021
         B     RDCNTRL                  READ ANOTHER RECORD             14480021
*                                                                       14500021
*********************************************************************** 14520021
*                                                                       14540021
*              PROCESS END OF MODULES                                   14560021
*                                                                       14580021
*********************************************************************** 14600021
*                                                                       14620021
PROCEOM  L     BRANCH,EOMRTN            GET ADDR OF END OF MODULE PROC  14640021
         BALR  RETURN,BRANCH            GO PROCESS END OF MODULE        14660021
*                                                                       14680021
*********************************************************************** 14700021
*                                                                       14720021
*              ISSUE RETURN MACRO                                       14740021
*                                                                       14760021
*********************************************************************** 14780021
*                                                                       14800021
BADCC    NI    CMIOFLGS,CQFF-CQIGNCR    SET IGNORE CONTROL REC OFF      14820021
BADCC1   L     SAVEREG,4(SAVEREG)       PICT UP PTR TO CALLER'S SAVE    14840021
         RETURN (14,12),T               RESTORE REGISTERS AND RETURN    14860021
*                                                                       14880021
*********************************************************************** 14900021
*                                                                       14920021
*              PROCESS ID/LENGTH LIST                                   14940021
*                                                                       14960021
*********************************************************************** 14980021
*                                                                       15000021
LMTXT    SR    CUM,CUM                  CLEAR CUMULATING REGISTER       15020021
         LA    PTR,DID                  GET ADDRESS OF ID/LENGTH LIST   15040021
         LH    ZERO,DRLDCNT             LENGTH OF RLD ITEMS             15060021
         AR    PTR,ZERO                 ADD TO START OF DATA            15080021
         ST    PTR,CMBLDLPT             SAVE START ADDR OF ID/LENGTH    15100021
         LH    LNG,DCNTIDLN             GET LENGTH OF ID/LENGTH LIST    15120021
         LA    WORKB,EIDLNG             GET LENGTH OF EACH ENTRY        15140021
         LNR   WORKB,WORKB              MAKE NEG FOR DECREMENT          15160021
PICKID   BXLE  LNG,WORKB,FINIDL                                         15180021
         LH    ID,0(PTR)                                                15200021
         L     BRANCH,RENUMID           GET ADDRESS OF TRANSID          15220021
         BALR  RETURN,BRANCH            GO GET ADDR OF RNT ENTRY        15240021
         LTR   PARM,PARM                ENTRY EXISTS IF NOT ZERO        15260021
         BZ    SKIPREC                  IF ZERO-SKIP THIS RECORD        15280021
         B     MARKDEL                  SEE IF MARKED DELETE            15300021
DELETE   OI    CMLIBFLG,CQDELETE        TURN ON DELETE BIT              15320021
         AH    CUM,ELENGTH(PTR)         ADD LENGTH TO CUM REGISTER      15340021
         B     NEXTID                   GET NEXT ID                     15360021
MARKDEL  TM    ESDTYPE(CESD),EDELETE    ENTRY MARKED DELETE             15380021
         BO    DELETE                   YES-SET DELETE BIT              15400021
         TM    CMLIBFLG,CQKEEPS         FIRST 'KEEP' ID                 15420021
         BO    NOTFIRST                 NO-CONTINUE                     15440021
         L     WORKA,ESDRELOC(CESD)     GET RELATIVE RELOC CONSTANT     15460021
         AR    WORKA,CUM                ADD AMOUNT DELETED FROM FRONT   15480021
         OI    CMLIBFLG,CQNOTXT+CQKEEPS TXT HAS BEEN RECEIVED           15500021
NOTFIRST SR    CUM,CUM                  CLEAR CUMULATING REGISTER       15520021
         L     ID,ESDLAA(CESD)          GET LAST CSECT ADDR             15540021
         LA    ID,0(ID)                 CLEAR FLAG BYTE                 15560021
         AH    ID,ELENGTH(PTR)          ADD LENGTH OF CSECT             15580021
         ST    ID,CMLSTTXT              SAVE AS LAST TEXT ADDR          15600021
NEXTID   LA    PTR,EIDLNG(PTR)          GET ADDR OF NEXT ENTRY IN       15620021
*                                       ID/LENGTH LIST                  15640021
         B     PICKID                                                   15660021
FINIDL   TM    CMLIBFLG,CQKEEPS         KEEP SOME BIT ON                15680021
         BO    RDSETUP                  GET INFORMATION FOR TXT READ    15700021
*                                                                       15720021
*********************************************************************** 15740021
*                                                                       15760021
*              SKIP TXT RECORD                                          15780021
*                                                                       15800021
*********************************************************************** 15820021
*                                                                       15840021
SKIPREC  LA    ZERO,1                   INDICATE SKIP RECORD            15860021
         LNR   ZERO,ZERO                                                15880021
         L     PARM,CMGETREC            REG1 HAS ADDRESS OF RLD BUF     15900021
         B     LASTXT                   SEE IF LAST TXT REC IN MODULE   15920021
*                                                                       15940021
*********************************************************************** 15960021
*                                                                       15980021
*              READ TXT                                                 16000021
*                                                                       16020021
*********************************************************************** 16040021
*                                                                       16060021
RDSETUP  LR    PARM,WORKA               GET ADDR FOR TEXT READ          16080021
         MVI   DADDR,X'00'              GET RID OF CCW OP CODE          16100021
         A     PARM,DADDR               ADD ADDR FROM CONTROL REC       16120021
         L     ZERO,DCCOUNT             GET COUNT FROM CONTROL REC      16140021
         N     ZERO,COUNTAND            CLEAR TOP HALF WORD             16160021
         SR    ZERO,CUM                 SUBTRACT CUMULATING REGISTER    16180021
*                                       FROM COUNT-AMOUNT DELETED       16200021
*                                       FROM END                        16220021
         LR    WORKA,PARM               GET ADDR IN ANOTHER REG         16240021
         AR    WORKA,ZERO               ADD COUNT TO ADDR               16260021
         C     WORKA,CMLOWTBL           SUM EXCEED LOW TABLE ADDR       16280021
         BNH   LASTXT                   NO-SEE IF LAST TXT REC          16300021
         B     TOOBIG                   PRINT ERROR MESSAGE             16320021
LASTXT   TM    DTYPE,ELTXT              TXT REC LAST IN MODULE          16340021
         BZ    IDDEL                                                    16360021
         TM    CMLIBFLG,CQAUTOC         AUTOCALL BIT ON                 16380021
         BO    LMRDTXT                  YES-READ ONLY TEXT              16400021
         OI    CMIOFLGS,CQIGNCR         SET IGNORE CONTROL REC BIT ON   16420021
IDDEL    TM    CMLIBFLG,CQDELETE        ANY ID'S TO BE DELETED          16440021
         BO    LMRDTXT                  YES-READ ONLY TEXT              16460021
RDTAC    LNR   ZERO,ZERO                INDICATE READ TXT AND CONTROL   16480021
*                                       MAKE REG0 NEGATIVE              16500021
LMRDTXT  L     BRANCH,READRTN           GET ADDRESS OF READ ROUTINE     16520021
         BALR  RETURN,BRANCH            GO TO READ                      16540021
         TM    CMIOFLGS,CQEOCB          END OF CONCATENATION            16560021
         BZ    ANYDEL                   NO-ANY TXT TO BE DELETED        16580021
         TM    CMIOFLGS,CQEOFSB         END OF FILE ON FIRST READ       16600021
         BZ    ANYDEL                   NO-ANY TXT TO BE DELETED        16620021
         NI    CMLIBFLG,CQFF-CQDELETE-CQKEEPS CLEAR DELETE AND KEEP     16640021
*                                             SOME BITS                 16660021
         LA    ZERO,ERINPT6             INVALID INPUT FROM LOAD MOD     16680021
*                                       TEXT RECORD EXPECTED-NOT REC    16700021
         L     BRANCH,LOGRTN            GET ADDR OF LOG ROUTINE         16720021
         BALR  RETURN,BRANCH            GO TO LOG ERROR MESSAGE         16740021
         B     PROCEOM                  GO TO PROCESS END OF MOD        16760021
ANYDEL   TM    CMLIBFLG,CQDELETE        ANY TEXT TO BE DELETED          16780021
         BO    ALLDEL                   YES-ALL TO BE DELETED           16800021
DELALL   LTR   ZERO,ZERO                CONTROL REC READ                16820021
*                                       REG0 LESS THAN ZERO             16840021
         BNL   PROCEOM                  NO-GO TO PROCESS EOM            16860021
         B     RDCNTRL1                                                 16880021
*                                                                       16900021
*********************************************************************** 16920021
*                                                                       16940021
*              DELETE SOME TXT                                          16960021
*                                                                       16980021
*********************************************************************** 17000021
*                                                                       17020021
ALLDEL   NI    CMLIBFLG,CQFF-CQDELETE   TURN OFF DELETE TXT BIT         17040021
         TM    CMLIBFLG,CQKEEPS         ALL TXT TO BE DELETED           17060021
         BZ    DELALL                   YES-DELETE ALL                  17080021
         NI    CMLIBFLG,CQFF-CQKEEPS    TURN OFF KEEP SOME BIT          17100021
         LR    WORKA,PARM               GET ADDR OF FIRST TXT READ      17120021
         L     PTR,CMBLDLPT             RESTORE PTR TO FIRST ID         17140021
         LH    LNG,DCNTIDLN             GET LENGTH OF ID/LENGTH LIST    17160021
         LA    WORKB,EIDLNG             GET LENGTH OF EACH ENTRY        17180021
         LNR   WORKB,WORKB              MAKE NEGATIVE FOR DECREMENT     17200021
*                                                                       17220021
*********************************************************************** 17240021
*                                                                       17260021
*              MOVE TXT TO CORRECT LOCATION                             17280021
*                                                                       17300021
*********************************************************************** 17320021
*                                                                       17340021
GETID    BXLE  LNG,WORKB,RDCNTRL                                        17360021
         LH    ID,0(PTR)                                                17380021
         LH    CUM,ELENGTH(PTR)         GET LENGTH OF CSECT             17400021
         L     BRANCH,RENUMID           GET ADDR OF TRANSID             17420021
         BALR  RETURN,BRANCH            GET ADDR OF RNT ENTRY           17440021
         TM    ESDTYPE(CESD),EDELETE    THIS ENTRY MARKED DELETE        17460021
         BO    GETNXT                   YES-GET NEXT ID                 17480021
         L     PARM,ESDLAA(CESD)        GET ADDR OF THIS ID FROM CESD   17500021
         CR    WORKA,PARM               TXT IN RIGHT PLACE              17520021
         BE    GETNXT                   YES-GET NEXT ID                 17540021
         LA    ZERO,256                 GET CONSTANT 256 FOR TEST       17560021
MOVELOOP CR    CUM,ZERO                 LENGTH GREATER THAN 256         17580021
         BNH   MOVELESS                 NO-MOVE REMAINING BYTES         17600021
         MVC   0(256,PARM),0(WORKA)     MOVE 256 CHARACTERS             17620021
         AR    WORKA,ZERO               INCREMENT MOVE ADDRESSES        17640021
         AR    PARM,ZERO                                                17660021
         SR    CUM,ZERO                 DECREMENT LENGTH                17680021
         B     MOVELOOP                 COMPARE-STILL GREATER THAN 256  17700021
LASTMOVE MVC   0(1,PARM),0(WORKA)       MOVE FOR LESS THAN 256          17720021
MOVELESS BCTR  CUM,0                    DECREMENT MOVE FOR EXECUTE MVC  17740021
         EX    CUM,LASTMOVE             MOVE LAST TXT                   17760021
         LA    CUM,1(CUM)               GET BACK TO CORRECT LENGTH      17780021
GETNXT   AR    WORKA,CUM                POINT TO NEXT CESECT            17800021
         LA    PTR,EIDLNG(PTR)          GET ADDR OF NEXT ENTRY IN       17820021
*                                       ID/LENGTH LIST                  17840021
         B     GETID                                                    17860021
      EJECT                                                             17880021
*********************************************************************** 17900021
*   ERROR LOG ROUTINE --- THIS ROUTINE FORMATS AND PRINTS ERROR         17920021
*  MESSAGE ON THE SYSPRINT AND SYSTERM DATA SETS.IF A SEV 4 ERROR IS  * 17940021
*  DETECTED RETURN IS TO THE HIGHEST LEVEL CALLING ROUTINE.           * 17960021
*                                                                       17980021
*                                                                       18000021
*                                                                       18020021
*    UPON ENTRY -- REGISTER 0 CONTAINS A MESSAGE CODE                   18040021
*                  REGISTER 1 CONTAINS A POINTER TO QUALIFYING          18060021
*                 INFORMATION (IF IT EXISTS)                            18080021
*                                                                       18100021
*                                                                       18120021
         ENTRY HEWERROR                                                 18140021
*                                                                       18160021
*********************************************************************** 18180021
HEWERROR SAVE  (14,12),,*         SAVE CALLERS REGISTERS                18200021
         USING HEWERROR,R15       IDENTIFY ENTRY POINT                  18220021
         L     R12,AUTOCALL            LOAD CSECT BASE                  18240021
         DROP  R15                       DROP ENTRY POINT BASE          18260021
         USING HEWACALL,R12       AND IDENTIFY CSECT BASE               18280021
         SPACE                                                          18300021
         L     R13,8(R13)          GET NEXT SAVE AREA POINTER           18320021
         SPACE                                                          18340021
         LR    R2,R0               MOVE ERROR CODE                      18360021
         LA    R3,1                  SET BIT                            18380021
         SLL   R3,0(R2)                SHIFT BY ERROR CODE              18400021
         O     R3,CMBITMAP               INSERT INTO BITMAP             18420021
         ST    R3,CMBITMAP                 AND STORE BITMAP BACK        18440021
*                                                                       18460021
         AR    R2,R2               FORM INDEX                           18480021
         AR    R2,R2                 FROM ERROR CODE                    18500021
*                                                                       18520021
         TM    CMPRMFLG,CQTERM     WAS TERM OPTION PASSED               18540021
         BNO   RRCHKPRT            NO. CHECK SYSPRINT                   18560021
         L     R8,CMTRMREC         YES. GET PTR TO TERM BUFFER          18580021
         LA    R9,TRMRECSZ-MSGPLEN  MAXIMUM LENGTH OF IDENTIFYING INFO  18600021
         BAL   R14,RRSETUP         MOVE MESSAGE IN                      18620021
         L     R15,TRMRTN          AND PRINT IT                         18640021
         BALR  R14,R15                                                  18660021
RRCHKPRT TM    CMSTATUS,CQPRTOPN   IS THE SYSPRINT DATA SET OPEN        18680021
         BZ    RRERCODE              NO - DON'T SET UP MESSAGE          18700021
*                                                                       18720021
         LH    R6,CMWTBFCT         IS THERE ANYTHING                    18740021
         LTR   R6,R6                 IN THE PRINT BUFFER                18760021
         BZ    RRMESSG                 NO - DON'T PURGE                 18780021
*                                                                       18800021
         L     R15,PRTRTN            YES - GO PURGE                     18820021
         BALR  R14,R15                 CURRENT PRINT BUFFER             18840021
*                                                                       18860021
RRMESSG  L     R8,CMPUTREC         GET POINTER TO PRINT BUFFER          18880021
         LH    R9,CMWLRECL         GET LENGTH OF PRINT BUFFER           18900021
         LA    R3,MSGPLEN          GET LENGTH OF PREFIX                 18920021
         SR    R9,R3               GET LENGTH OF QUALIFYING INFO        18940021
         BAL   R14,RRSETUP         MOVE MESSAGE IN                      18960021
         B     RRPRNT              AND GO PRINT IT                      18980021
*                                                                       19000021
*              SET UP MESSAGE IN BUFFER POINTED TO BY R8                19020021
*        R9 CONTAINS MAXIMUM LENGTH OF QUALIFYING INFO                  19040021
         USING MSGDSECT,R8                                              19060021
RRSETUP  EQU   *                                                        19080021
*                                                                       19100021
         L     R7,ERTABLE(R2)      GET POINTER TO MESSAGE NUMBER        19120021
         MVC   MSGPREFX(4),RRPREFX   MOVE PREFIX TO PRINT BUFFER        19140021
         MVC   MSGNUMBR(3),0(R7)       AND MOVE IN MESSAGE NUMBER       19160021
*                                                                       19180021
         SR    R6,R6               GET QUALIFYING                       19200021
         SLDL  R6,8                  DATA LENGTH                        19220021
         LTR   R6,R6               IS THERE ANY                         19240021
         BZ    RRSETRTN            NO. RETURN                           19260021
*                                                                       19280021
         CR    R6,R9               WILL IT OVERFLOW BUFFER              19300021
         BNH   RRMOV               NO. OKAY                             19320021
         LR    R6,R9               YES. TRUNCATE IT                     19340021
RRMOV    EQU   *                                                        19360021
         BCTR  R6,0                DECREMENT LENGTH FOR EXECUTE         19380021
         EX    R6,RRXTRAMV           AND MOVE INFO INTO PRINT BUFFER    19400021
RRSETRTN BR    R14                 RETURN                               19420021
*                                                                       19440021
RRPRNT   L     R15,PRTRTN          AND PRINT                            19460021
         BALR  R14,R15               THE ERROR MESSAGE                  19480021
*                                                                       19500021
RRERCODE L     R7,ERTABLE(R2)      RELOAD POINTER TO MESSAGE NUMBER     19520021
         IC    R15,2(R7)             PICK UP LOW ORDER CHARACTER        19540021
         LA    R6,7           GET SEVERITY CODE                         19560021
         NR    R15,R6                                                   19580021
         LA    R6,1                                                     19600021
         TM    CMPRMFLG,CQLET      IS 'LET' SPECIFIED                   19620021
         BZ    RRTSTCOD           NO                                    19640021
         SR    R15,R6         YES. REDUCE CONDITION CODE BY 1           19660021
RRTSTCOD CR    R15,R6         IS IT ONE OR LESS                         19680021
         BNH   RRTRYH         YES. OKAY                                 19700021
         OI    CMFLAG4,CQNOEX      SET 'NO EXECUTION' FLAG              19720021
RRTRYH   IC    R15,2(R7)      RELOAD CODE                               19740021
         LA    R6,4                    AND OFF ALL                      19760021
         NR    R15,R6                    BUT SEVERITY 4                 19780021
RRABORT  L     R13,4(R13)          IF MESSAGE NOT SEVERITY 4 -- RETURN  19800021
         BZ    RRRETURN                                                 19820021
         SPACE                                                          19840021
*   A SEVERITY 4 ERROR HAS BEEN DETECTED ---- EXECUTION IS NO LONGER    19860021
*  POSSIBLE.  THE FOLLOWING CODE WILL PROCEED BACK THROUGH THE SAVE     19880021
*  AREA CHAIN TO THE HIGHEST LEVEL ROUTINE SO THAT DATA-SETS CAN BE     19900021
*  CLOSED AND MAIN STORAGE FREED.                                       19920021
*                                                                       19940021
*                                                                       19960021
         OI    CMSTATUS,CQABORT         SET ABORT BIT FOR CONTROL       19980021
         TM    CMSTATUS,CQRETURN        RETURN REQUESTED-SEVERITY 4     20000021
         BO    RRRETURN                                                 20020021
         C     R13,CMFSTSAV        DOES R13 POINT TO FIRST SAVE AREA    20040021
         BNE   RRABORT               NO - GO TRY NEXT                   20060021
*                                                                       20080021
RRRETURN RETURN (14,12),T                                               20100021
*                                                                       20120021
*                                                                       20140021
RRXTRAMV MVC   MSGTEXT(0),0(R1)    EXECUTED MOVE TEXT INTO MESSAGE      20160021
         EJECT                                                          20180021
*********************************************************************** 20200021
*                                                                     * 20220021
*   ERROR BIT-MAP PROCESSOR --- DIAGNOSTIC MESSAGE DICTIONARY PRINT   * 20240021
*                                                                     * 20260021
*   THE BIT MAP IS CHECKED FOR ALL ZERO (NO ERRORS)                   * 20280021
*   IF IT IS ALL ZERO--IT SETS THE CONDITION CODE AND RETURNS         * 20300021
*                                                                     * 20320021
*   MESSAGES TO BE PRINTED ARE SELECTED VIA INDEX INTO THE            * 20340021
*   MESSAGE TABLE USING THE POSITION OF THE BIT SET IN THE BIT        * 20360021
*   MAP AS THE INDEX VALUE.                                           * 20380021
*                                                                     * 20400021
*   PRINTS MESSAGES ON SYSPRINT AND/OR SYSTERM.                       * 20420021
*   IF NEITHER ARE WANTED, THE MESSAGES ARE                           * 20440021
*   NOT PRINTED BUT THE BIT MAP IS STILL SCANNED FOR THE              * 20460021
*   HIGHEST SEVERITY CODE.                                            * 20480021
*                                                                     * 20500021
*   BEFORE RETURNING THE SEVERITY CODE IS CHANGED TO THE CONDITION    * 20520021
*   CODE AND SET IN REGISTER 15.                                      * 20540021
*                                                                     * 20560021
*********************************************************************** 20580021
         SPACE 3                                                        20600021
HEWBTMAP SAVE  (14,12),,*                                               20620021
         ENTRY HEWBTMAP                                                 20640021
         USING HEWBTMAP,R15                                             20660021
         L     R12,AUTOCALL                                             20680021
         DROP  R15                                                      20700021
         USING HEWACALL,R12                                             20720021
         SPACE                                                          20740021
         L     R13,8(R13)                                               20760021
         SPACE                                                          20780021
         SPACE                                                          20800021
         L     R3,CMBITMAP         LOAD BIT-MAP                         20820021
         SR    R0,R0                    INITIALIZE SEVERITY CODE        20840021
         LTR   R3,R3                 IS IT ALL ZERO                     20860021
         BZ    BMRETURN                YES - RETURN                     20880021
         SPACE                                                          20900021
         MVI   CMPRTCTL,CTSPACE3       SET UP CARRIAGE CONTROL          20920021
         SR    R2,R2               SET INDEX TO ZERO                    20940021
         LA    R5,127                  SET MASK                         20960021
BMCHKBIT LA    R4,1                CHECK IF LOW ORDER                   20980021
         NR    R4,R3                 BIT IS SET IN BIT-MAP              21000021
         BZ    BMNXTCHK                NO - DON'T PRINT THIS MESSAGE    21020021
         L     R6,ERTABLE(R2)           GET PTR TO ERROR TABLE          21040021
         IC    R0,2(R6)                 SAVE SEVERITY CODE              21060021
         TM    CMPRMFLG,CQTERM     WAS TERM OPTION PASSED               21080021
         BZ    BMCHKPRT            NO. CHECK SYSPRINT                   21100021
         L     R8,CMTRMREC         YES. GET POINTER TO TERM BUFFER      21120021
         BAL   R14,BMSETUP         MOVE MESSAGE IN                      21140021
         L     R15,TRMRTN          AND                                  21160021
         BALR  R14,R15             PRINT IT                             21180021
BMCHKPRT TM    CMSTATUS,CQPRTOPN   PRINT OPEN                           21200021
         BZ    BMNXTCHK                 NO-SKIP BIT MAP                 21220021
         L     R8,CMPUTREC             YES - GET POINTER TO PRINT BUF   21240021
         L     R6,ERTABLE(R2)      GET PTR TO ERROR TABLE               21260021
         BAL   R14,BMSETUP         MOVE MESSAGE IN                      21280021
         B     BMPRNT              AND PRINT IT                         21300021
BMSETUP  EQU   *                                                        21320021
         MVC   1(4,R8),RRPREFX     MOVE 'IEW1' TO PRINT BUFFER          21340021
         MVC   5(3,R8),0(R6)         MOVE IN MESSAGE NUMBER             21360021
         SR    R7,R7                                                    21380021
         LA    R8,12(R8)           UPDATE PRINT BUFFER POINTER          21400021
         SPACE                                                          21420021
BMMESSG  LA    R6,4(R6)            JUMP TO NEXT LENGTH-ADCON PAIR       21440021
         L     R9,0(R6)              LOAD THE ADCON TO PHRASE           21460021
         IC    R7,0(R6)              LOAD THE LENGTH OF THE PHRASE      21480021
         NR    R7,R5                   KNOCK OFF INDICATOR BIT          21500021
         EX    R7,MVPHRASE             AND MOVE THE PHRASE TO PRNT BUF  21520021
         LTR   R9,R9               WAS THAT THE LAST PHRASE IN MESSAGE  21540021
         LA    R8,1(R7,R8)           UPDATE THE PRINT BUFFER POINTER    21560021
         BC    11,BMMESSG            N/ - GO MOVE NEXT PHRASE           21580021
         BR    R14                 RETURN                               21600021
BMPRNT   EQU   *                                                        21620021
         SPACE                                                          21640021
         L     R15,PRTRTN            YES - GET ADDRESS OF PRINT RTN     21660021
         BALR  R14,R15                 AND GO PRINT THE MESSAGE         21680021
         SPACE 2                                                        21700021
BMNXTCHK SRA   R3,1                SHIFT BIT-MAP RIGHT                  21720021
         LA    R2,4(R2)              UPDATE INDEX INTO ERROR TABLE      21740021
         BNZ   BMCHKBIT                AND GO CHECK THIS BIT (IF ANY)   21760021
         SPACE 3                                                        21780021
BMRETURN L     R13,4(R13)          ALL DONE - PICK UP PREVIOUS SAVE     21800021
         LA    R15,7                    PUT SEVERITY CODE INTO          21820021
         NR    R15,R0                   REGISTER 15 AND                 21840021
         SLL   R15,2                             CHANGE TO CONDITION C  21860021
         BZ    BMRET                    RETURN IF CONDITION CODE ZERO   21880021
         LA    R14,8                    SEVERITY 2 CONSTANT     YA00126 21890001
         CR    R15,R14                  CK FOR ERROR GT SEV 2   YA00126 21892001
         BH    BMRET                    YES GT SEV 2            YA00126 21894001
         TM    CMPRMFLG,CQLET           LET SPECIFIED                   21900021
         BZ    BMRET                    NO-RETURN                       21920021
         LA    R10,4                    SUBTRACT FOUR FROM              21940021
         SR    R15,R10                  CONDITION CODE                  21960021
BMRET    RETURN (14,12),T,RC=(15)       RETURN                          21980021
         SPACE                                                          22000021
MVPHRASE MVC   0(0,R8),0(R9)       EXECUTED MOVE PHRASE TO PRINT BUFFER 22020021
         EJECT                                                          22040021
ERTABLE  DS    0F                                                       22060021
         DC    AL1(8)                                                   22080021
         DC    AL3(MSRELO1)                                             22100021
         DC    AL1(0)                                                   22120021
         DC    AL3(MSENTR1)                                             22140021
         DC    AL1(80)                                                  22160021
         DC    AL3(MSINPT8)                                             22180021
         SPACE                                                          22200021
         DC    AL1(0)                                                   22220021
         DC    AL3(MSINPT10)                                            22240021
         DC    AL1(0)                                                   22260021
         DC    AL3(MSINPT2)                                             22280021
         DC    AL1(8)                                                   22300021
         DC    AL3(MSRELO2)                                             22320021
         DC    AL1(8)                                                   22340021
         DC    AL3(MSINPT4)                                             22360021
         DC    AL1(0)                                                   22380021
         DC    AL3(MSINPT5)                                             22400021
         DC    AL1(0)                                                   22420021
         DC    AL3(MSINPT7)                                             22440021
         DC    AL1(80)                                                  22460021
         DC    AL3(MSINPT9)                                             22480021
         DC    AL1(8)                                                   22500021
         DC    AL3(MSINPT1)                                             22520021
         SPACE                                                          22540021
         DC    AL1(0)                                                   22560021
         DC    AL3(MSINPT3)                                             22580021
         DC    AL1(8)                                                   22600021
         DC    AL3(MSENTR2)                                             22620021
         DC    AL1(0)                                                   22640021
         DC    AL3(MSIOUT4)                                             22660021
         DC    AL1(0)                                                   22680021
         DC    AL3(MSINPT6)                                             22700021
         SPACE                                                          22720021
         DC    AL1(8)                                                   22740021
         DC    AL3(MSIOUT3)                                             22760021
         DC    AL1(8)                                                   22780021
         DC    AL3(MSIOUT1)                                             22800021
         DC    AL1(67)                                                  22820021
         DC    AL3(MSIOUT2)                                             22840021
         DC    AL1(0)                                                   22860021
         DC    AL3(MSSIZE2)                                             22880021
         DC    AL1(0)                                                   22900021
         DC    AL3(MSSIZE3)                                             22920021
         DC    AL1(8)                                                   22940021
         DC    AL3(MSIDEN1)                                             22960021
         DC    AL1(8)                                                   22980021
         DC    AL3(MSIDEN2)                                             23000021
         DC    AL1(8)                                            YM5575 23010001
         DC    AL3(MSINPT11)                                     YM5575 23012001
         SPACE                                                          23020021
PHRASE1  DC    C'WARNING - '                                            23040021
PLNGTH1  EQU   *-PHRASE1                                                23060021
         SPACE                                                          23080021
PHRASE2  DC    C'ERROR - '                                              23100021
PLNGTH2  EQU   *-PHRASE2                                                23120021
         SPACE                                                          23140021
PHRASE3  DC    C'UNRESOLVED EXTERNAL REFERENCE'                         23160021
PLNGTH3  EQU   *-PHRASE3                                                23180021
         SPACE                                                          23200021
PHRASE4  DC    C' (NOCALL SPECIFIED)'                           YM05562 23220001
PLNGTH4  EQU   *-PHRASE4                                                23240021
         SPACE                                                          23260021
PHRASE5  DC    C'NO '                                                   23280021
PLNGTH5  EQU   *-PHRASE5                                                23300021
         SPACE                                                          23320021
PHRASE6  DC    C'ENTRY POINT '                                          23340021
PLNGTH6  EQU   *-PHRASE6                                                23360021
         SPACE                                                          23380021
PHRASE7  DC    C'RECEIVED'                                              23400021
PLNGTH7  EQU   *-PHRASE7                                                23420021
         SPACE                                                          23440021
PHRASE8  DC    C'INVALID'                                               23460021
PLNGTH8  EQU   *-PHRASE8                                                23480021
         SPACE                                                          23500021
PHRASE9  DC    C' NOT AN OBJECT RECORD'                                 23520021
PLNGTH9  EQU   *-PHRASE9                                                23540021
         SPACE                                                          23560021
PHRASE10 DC    C' SPECIFIED'                                            23580021
PLNGTH10 EQU   *-PHRASE10                                               23600021
         SPACE                                                          23620021
PHRASE11 DC    C'UNACCEPTABLE '                                         23640021
PLNGTH11 EQU   *-PHRASE11                                               23660021
         SPACE                                                          23680021
PHRASE12 DC    C'RECORD FORMAT'                                         23700021
PLNGTH12 EQU   *-PHRASE12                                               23720021
         SPACE                                                          23740021
PHRASE13 DC    C'NO TEXT '                                              23760021
PLNGTH13 EQU   *-PHRASE13                                               23780021
         SPACE                                                          23800021
PHRASE14 DC    C' RECORD FROM '                                         23820021
PLNGTH14 EQU   *-PHRASE14                                               23840021
         SPACE                                                          23860021
PHRASE15 DC    C'OBJECT MODULE'                                         23880021
PLNGTH15 EQU   *-PHRASE15                                               23900021
         SPACE                                                          23920021
PHRASE16 DC    C'LOAD MODULE'                                           23940021
PLNGTH16 EQU   *-PHRASE16                                               23960021
         SPACE                                                          23980021
         SPACE                                                          24000021
PHRASE18 DC    C'CARD '                                                 24020021
PLNGTH18 EQU   *-PHRASE18                                               24040021
         SPACE                                                          24060021
PHRASE19 DC    C' LENGTH'                                               24080021
PLNGTH19 EQU   *-PHRASE19                                               24100021
         SPACE                                                          24120021
PHRASE20 DC    C'DOUBLY DEFINED ESD'                                    24140021
PLNGTH20 EQU   *-PHRASE20                                               24160021
         SPACE                                                          24180021
PHRASE21 DC    C' 2 BYTE ADCON'                                         24200021
PLNGTH21 EQU   *-PHRASE21                                               24220021
         SPACE                                                          24240021
PHRASE22 DC    C' ID '                                                  24260021
PLNGTH22 EQU   *-PHRASE22                                               24280021
         SPACE                                                          24300021
PHRASE23 DC    C'BLKSIZE IS '                                           24320021
PLNGTH23 EQU   *-PHRASE23                                               24340021
         SPACE                                                          24360021
PHRASE24 DC    C' (VARIABLE ON INPUT)'                                  24380021
PLNGTH24 EQU   *-PHRASE24                                               24400021
         SPACE                                                          24420021
PHRASE25 DC    C' BUT NOT MATCHED'                                      24440021
PLNGTH25 EQU   *-PHRASE25                                               24460021
         SPACE                                                          24480021
PHRASE26 DC    C'I/O ERROR WHILE SEARCHING LIBRARY DIRECTORY'           24500021
PLNGTH26 EQU   *-PHRASE26                                               24520021
         SPACE                                                          24540021
PHRASE27 DC    C'DDNAME '                                               24560021
PLNGTH27 EQU   *-PHRASE27                                               24580021
         SPACE                                                          24600021
PHRASE28 DC    C'CANNOT BE OPENED'                                      24620021
PLNGTH28 EQU   *-PHRASE28                                               24640021
         SPACE                                                          24660021
PHRASE29 DC    C'HAD SYNCHRONOUS ERROR'                                 24680021
PLNGTH29 EQU   *-PHRASE29                                               24700021
         SPACE                                                          24720021
         SPACE                                                          24740021
PHRASE31 DC    C'AVAILABLE STORAGE EXCEEDED'                            24760021
PLNGTH31 EQU   *-PHRASE31                                               24780021
         SPACE                                                          24800021
PHRASE32 DC    C' TOO LARGE'                                            24820021
PLNGTH32 EQU   *-PHRASE32                                               24840021
         SPACE                                                          24860021
PHRASE33 DC    C'TOO MANY EXTERNAL NAMES IN INPUT MODULE'               24880021
PLNGTH33 EQU   *-PHRASE33                                               24900021
         SPACE 2                                                        24920021
PHRASE34 DC    C'END '                                                  24940021
PLNGTH34 EQU   *-PHRASE34                                               24960021
PHRASE35 DC    C'IDENTIFICATION FAILED'                                 24980021
PLNGTH35 EQU   *-PHRASE35                                               25000021
PHRASE36 DC    C' - DUPLICATE PROGRAM NAME FOUND'                       25020021
PLNGTH36 EQU   *-PHRASE36                                               25040021
PHRASE37 DC    C'COMMON EXCEEDS SIZE OF CSECT WITH SAME NAME'    YM5575 25050001
PLNGTH37 EQU   *-PHRASE37                                        YM5575 25052001
         DS    0F                                                       25060021
MSRELO1  DC    C'001 '                                                  25080021
         DC    AL1(PLNGTH1-1),AL3(PHRASE1)                              25100021
         DC    AL1(PLNGTH3-1),AL3(PHRASE3)                              25120021
         DC    AL1(128+PLNGTH4-1),AL3(PHRASE4)                          25140021
         SPACE                                                          25160021
MSRELO2  DC    C'012 '                                                  25180021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              25200021
         DC    AL1(128+PLNGTH3-1),AL3(PHRASE3)                          25220021
         SPACE                                                          25240021
MSIOUT1  DC    C'024 '                                                  25260021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              25280021
         DC    AL1(PLNGTH27-1),AL3(PHRASE27)                            25300021
         DC    AL1(128+PLNGTH28-1),AL3(PHRASE28)                        25320021
         SPACE                                                          25340021
MSIOUT2  DC    C'034 '                                                  25360021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              25380021
         DC    AL1(PLNGTH27-1),AL3(PHRASE27)                            25400021
         DC    AL1(128+PLNGTH29-1),AL3(PHRASE29)                        25420021
         SPACE                                                          25440021
MSIOUT3  DC    C'044 '                                                  25460021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              25480021
         DC    AL1(PLNGTH11-1),AL3(PHRASE11)                            25500021
         DC    AL1(PLNGTH12-1),AL3(PHRASE12)                            25520021
         DC    AL1(128+PLNGTH24-1),AL3(PHRASE24)                        25540021
         SPACE                                                          25560021
MSIOUT4  DC    C'053 '                                                  25580021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              25600021
         DC    AL1(128+PLNGTH26-1),AL3(PHRASE26)                        25620021
         SPACE                                                          25640021
         SPACE                                                          25660021
MSINPT1  DC    C'072 '                                                  25680021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              25700021
         DC    AL1(PLNGTH23-1),AL3(PHRASE23)                            25720021
         DC    AL1(128+PLNGTH8-1),AL3(PHRASE8)                          25740021
         SPACE                                                          25760021
MSINPT2  DC    C'082 '                                                  25780021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              25800021
         DC    AL1(PLNGTH8-1),AL3(PHRASE8)                              25820021
         DC    AL1(PLNGTH19-1),AL3(PHRASE19)                            25840021
         DC    AL1(128+PLNGTH10-1),AL3(PHRASE10)                        25860021
         SPACE                                                          25880021
MSINPT3  DC    C'093 '                                                  25900021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              25920021
         DC    AL1(PLNGTH13-1),AL3(PHRASE13)                            25940021
         DC    AL1(128+PLNGTH7-1),AL3(PHRASE7)                          25960021
         SPACE                                                          25980021
MSINPT4  DC    C'102 '                                                  26000021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              26020021
         DC    AL1(128+PLNGTH20-1),AL3(PHRASE20)                        26040021
         SPACE                                                          26060021
MSINPT5  DC    C'112 '                                                  26080021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              26100021
         DC    AL1(PLNGTH8-1),AL3(PHRASE8)                              26120021
         DC    AL1(128+PLNGTH21-1),AL3(PHRASE21)                        26140021
         SPACE                                                          26160021
MSINPT6  DC    C'123 '                                                  26180021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              26200021
         DC    AL1(PLNGTH8-1),AL3(PHRASE8)                              26220021
         DC    AL1(PLNGTH14-1),AL3(PHRASE14)                            26240021
         DC    AL1(128+PLNGTH16-1),AL3(PHRASE16)                        26260021
         SPACE                                                          26280021
MSINPT7  DC    C'132 '                                                  26300021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              26320021
         DC    AL1(PLNGTH8-1),AL3(PHRASE8)                              26340021
         DC    AL1(PLNGTH22-1),AL3(PHRASE22)                            26360021
         DC    AL1(128+PLNGTH7-1),AL3(PHRASE7)                          26380021
         SPACE                                                          26400021
MSINPT8  DC    C'141 '                                                  26420021
         DC    AL1(PLNGTH1-1),AL3(PHRASE1)                              26440021
         DC    AL1(PLNGTH18-1),AL3(PHRASE18)                            26460021
         DC    AL1(PLNGTH7-1),AL3(PHRASE7)                              26480021
         DC    AL1(128+PLNGTH9-1),AL3(PHRASE9)                          26500021
         SPACE                                                          26520021
MSINPT9  DC    C'152 '                                                  26540021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              26560021
         DC    AL1(PLNGTH8-1),AL3(PHRASE8)                              26580021
         DC    AL1(PLNGTH14-1),AL3(PHRASE14)                            26600021
         DC    AL1(128+PLNGTH15-1),AL3(PHRASE15)                        26620021
         SPACE                                                          26640021
MSINPT10 DC    C'182 '                                                  26660021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              26680021
         DC    AL1(PLNGTH5-1),AL3(PHRASE5)                              26700021
         DC    AL1(PLNGTH34-1),AL3(PHRASE34)                            26720021
         DC    AL1(PLNGTH18-1),AL3(PHRASE18)                            26740021
         DC    AL1(128+PLNGTH7-1),AL3(PHRASE7)                          26760021
MSINPT11 DC    C'232 '                                           YM5575 26770001
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                       YM5575 26772001
         DC    AL1(128+PLNGTH37-1),AL3(PHRASE37)                 YM5575 26774001
MSENTR1  DC    C'161 '                                                  26780021
         DC    AL1(PLNGTH1-1),AL3(PHRASE1)                              26800021
         DC    AL1(PLNGTH5-1),AL3(PHRASE5)                              26820021
         DC    AL1(PLNGTH6-1),AL3(PHRASE6)                              26840021
         DC    AL1(128+PLNGTH7-1),AL3(PHRASE7)                          26860021
         SPACE                                                          26880021
MSENTR2  DC    C'173 '                                                  26900021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              26920021
         DC    AL1(PLNGTH6-1),AL3(PHRASE6)                              26940021
         DC    AL1(PLNGTH7-1),AL3(PHRASE7)                              26960021
         DC    AL1(128+PLNGTH25-1),AL3(PHRASE25)                        26980021
         SPACE                                                          27000021
MSSIZE2  DC    C'194 '                                                  27020021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              27040021
         DC    AL1(128+PLNGTH31-1),AL3(PHRASE31)                        27060021
         SPACE                                                          27080021
MSSIZE3  DC    C'204 '                                                  27100021
         DC    AL1(PLNGTH2-1),AL3(PHRASE2)                              27120021
         DC    AL1(128+PLNGTH33-1),AL3(PHRASE33)                        27140021
MSIDEN1  DC    C'214 '                                                  27160021
         DC    AL1(PLNGTH35-1),AL3(PHRASE35)                            27180021
         DC    AL1(128+PLNGTH36-1),AL3(PHRASE36)                        27200021
MSIDEN2  DC    C'224 '                                                  27220021
         DC    AL1(128+PLNGTH35-1),AL3(PHRASE35)                        27240021
RRPREFX  DC    C'IEW1'                                                  27260021
AUTOCALL DC    A(HEWACALL)                                              27280021
LOADRTN  DC    A(HEWLODE)         LOAD MODULE PROCESSOR                 27300021
RLDRTN   DC    V(HEWLRLD)         RLD PROCESSOR                         27320021
READRTN  DC    V(HEWLREAD)        READ ROUTINE                          27340021
CESDRTN  DC    V(HEWLESD)         ESD AND CESD PROCESSOR                27360021
LOGRTN   DC    A(HEWERROR)        ERROR LOG ROUTINE                     27380021
EOMRTN   DC    V(HEWLEND)         END CARD AND END  OF MODULE           27400021
*                                       PROCESSOR                       27420021
RENUMID  DC    V(TRANSID)               RENUMBER TBL-ID ROUTINE         27440021
MAPRTN   DC    V(HEWLMAP)         MAP PROCESSOR                         27460021
OPNSYSLI DC    V(HEWOPNLB)        OPEN SYSLIB ROUTINE                   27480021
PRTRTN   DC    V(HEWLPRNT)        PRINT ROUTINE                         27500021
TRMRTN   DC    V(HEWTERM)         SYSTERM OUTPUT ROUTINE                27520021
RLDRES   DC    V(HEWLERTN)        RLD RESOLUTION ROUTINE                27540021
PRIMRTN  DC    V(HEWPRIME)        BUFFER PRIME ROUTINE                  27560021
RELORTN  DC    V(HEWLRELO)        OBJECT MODULE PROCESSOR               27580021
CNVTRTN  DC    V(HEWLCNVT)        CONVERT TO HEX ROUTINE                27600021
COUNTAND DC    X'0000FFFF'              CONSTANT FOR AND INST           27620021
MSG2     DC    C'TOTAL LENGTH'                                          27640021
MSG2LNG  EQU   *-MSG2                                                   27660021
MSG3     DC    C'ENTRY ADDRESS'                                         27680021
MSG3LNG  EQU   *-MSG3                                                   27700021
MAINTDS  DS    37F                                                      27720021
         EJECT                                                          27740021
*   MESSAGE LINE FORMAT DSECT                                           27760021
         SPACE 2                                                        27780021
MSGDSECT DSECT                                                          27800021
         DC    C' '                                                     27820021
MSGPREFX DC    C'IEW0'        MESSAGE PREFIX                            27840021
MSGNUMBR DS    CL3            MESSAGE NUMBER (AND SEVERITY)             27860021
         DC    C'  '                                                    27880021
MSGTEXT  DS    C              QUALIFYING INFORMATION                    27900021
MSGPLEN  EQU   MSGTEXT-MSGDSECT    LENGTH OF PREFIX,ETC                 27920021
CVTSECT  DSECT                                                          27940021
         CVT                                                            27960000
         HEWLDCOM                                                       27980021
DCNTRLB  DSECT                                                          28000021
DTYPE    DS    CL1                      TYPE IDENTIFICATION             28020021
         DS    CL3                                                      28040021
DESID    DS    CL2                      ESDID OF FIRST ESD ITEM         28060021
DCOUNT   DS    CL2                      BYTES OF ESD DATA               28080021
DESDDATA EQU   *                        START OF ESD DATA               28100021
         ORG   DESID                                                    28120021
DCNTIDLN DS    CL2                      BYTES OF ID/LENGTH LIST         28140021
         DS    CL2                                                      28160021
DCCW     EQU   *                        CHANNEL COMMAND WORD            28180021
DADDR    DS    CL4                      DATA ADDRESS                    28200021
DCCOUNT  DS    CL4                      BYTES OF TXT DATA               28220021
DID      DS    CL2                      CESD ENTRY NUMBER               28240021
DLENGTH  DS    CL2                      LENGTH OF TEXT RECORD           28260021
         ORG   DCOUNT                                                   28280021
DRLDCNT  DS    CL2                      BYTES OF RLD INFORMATION        28300021
         DS    CL8                                                      28320021
DRLDDATA EQU   *                        START OF RLD DATA               28340021
CDENTRY  DSECT                                                          28360021
CDCHAIN  DS    4C                       CHAIN ADDR-NEXT ENTRY           28380021
CDROLL   DS    1C                       COUNT OF ROLL OUTS              28400021
CDRPB    DS    3C                       ADDRESS OF PRB                  28420021
CDNAME   DS    8C                       NAME                            28440021
CDENTPT  DS    4C                       RELOCATED ENTRY POINT           28460021
         END                                                            28480021
