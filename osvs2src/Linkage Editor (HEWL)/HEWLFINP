HEWLFINP CSECT                                                          00050021
*                                                                       00052021
*174500-176500,209500-211500,429500-434500,551500-552500         S21016 00060021
*647500-670500,758500-760500                                     S21016 00062021
*694500-695500,712500-718500                                     S01904 00064021
*A653500                                                          M4123 00072021
*D680500-681500                                                   M4319 00074021
*A717500                                                          M4320 00076021
*A208500,A301500                                                 A51444 00078000
*C201500                     OY00131                                    00078403
*I532500,C533500,I746500                                OX04563,OY03738 00078802
* D703500                                                       ZA01413 00079237
* C209300                                                      @ZA02229 00079637
* A31051021 THRU 3152021                                       @ZA07586 00109637
         TITLE '  HEWLFINP INPUT PROCESSOR '                            00150021
HEWLCINP EQU   *                                                        00250021
*FUNCTION/OPERATION: THIS MODULE READS ALL INPUT TO LINK EDITOR. THIS * 00350021
*      CONSISTS OF OBJECT MODULES(CARDS),LOAD MODULES(LINK EDITOR     * 00450021
*      OUTPUT) AND CONTROL CARDS. IT DETERMINES WHICH PROCESSOR       * 00550021
*      MUST BE SELECTED TO PROCESS THE RECORD AND SELECTS IT. IT      * 00650021
*      PERFORMS ALL THE SET UP REQUIRED TO PROCESS THE PARTICULAR     * 00750021
*      REORD. IT ALSO SAVES DELINK TABLE VALUES FOR THE RLD AND ESD   * 00850021
*      PROCESSORS. IF AUTOMATIC LIBRARY CALL IS REQUIRED OR INCLUDE   * 00950021
*      CARDS HAVE BEEN READ, THE APPROPRIATE PROCESSOR IS SELECTED.   * 01050021
*ENTRY POINTS  HEWLFINP-BEGINNING OF CSECT ENTERED BY INITIALIZER     * 01150021
*               HEWLCINP- BEGINNING OF CSECT,ENTERED BY COMMON ROUT-  * 01250021
*                         INES                                        * 01350021
*               HEWLCDLK- DELINK TABLE ROUTINE,ENTERED BY ESD AND RLD * 01450021
*              HEWLFMDI-MODULE INPUT- ENTERED BY INPUT CONTROL        * 01550021
*               HEWLERDM- READ ROUTINE-USED BY HEWLEMDI               * 01650021
*               HEWLCEOD- END OF DATA ENTRY FOR LIBRARY DCB- ALSO     * 01750021
*                         ENTERED FROM HEWLEMDI WHEN END OF MODULE    * 01850021
*                         RECORD IS READ FROM LOAD MODULE             * 01950021
*               HEWLEEON- END OF DATA ENTRY FOR SYSLIN DCB            * 02050021
*                ALL ROUTINES ENTERED BY BCR 15,15 EXCEPT             * 02150021
*                    HEWLCDLK -BALR 14,15                             * 02250021
*                    HEWLERDM -BALR  7,15                             * 02350021
*INPUT:  80 COLUMN CARDS - OBJECT MODULES- F FORMAT                   * 02450021
*           COLUMN 1 - 12-9-2 PUNCH                                   * 02550021
*           COLUMN 2 THRU 4 = TYPE (ESD,TXT,RLD,END,SYM)              * 02650021
*              ESD  COLUMNS- 11-12 BYTE COUNT                         * 02750021
*                            15-16 ID OF FIRST ESD ITEM               * 02850021
*                            17-66 ESD ITEMS (3)                      * 02950021
*                                                                     * 03050021
*              TXT  COLUMNS- 6-7-8 24 BIT ASSEMBLED ADDRESS OF TXT    * 03150021
*                            11-12 NUMBER OF BYTES OF TXT ON CARD     * 03250021
*                            15-16 ESDID OF CSECT CONTAINING TXT      * 03350021
*                            17-72 TXT INFORMATION                    * 03450021
*                                                                     * 03550021
*              RLD  COLUMNS- 11-12 NUMBER OF BYTES OF RLD ON CARD     * 03650021
*                            17-72 RLD ITEMS                          * 03750021
*                                                                     * 03850021
*              END  COLUMNS- 6-7-8 OPTIONAL 24 BIT ASSM. ADD. OF      * 03950021
*                                  ENTRY POINT                        * 04050021
*                            15-16 ID OF ASSM. ADD. ENTRY POINT       * 04150021
*                            17-24 SYMBOL OF EXTERNAL SYMBOL ENTRY    * 04250021
*                            29-32 LENGTH OF CONTROL SECTION WHICH    * 04350021
*                                  WAS NOT SPECIFIED ON ESD CARD      * 04450021
*                                                                     * 04550021
*              SYM  COLUMNS- 11-12 NUMBER OF BYTES OF TESTRAN INFO.   * 04650021
*                                  ON CARD                            * 04750021
*                            17-72 TESTRAN INFORMATION                * 04850021
*                                                                     * 04950021
*                                                                     * 05050021
*        U RECORDS-LOAD MODULES                                       * 05150021
*             TXT RECORDS - RECORDS WHOSE MAXIMUM LENGTH IS TXTBSIZE *  05250021
*                            BYTES. THEY ARE PRECEEDED BY CCW RECORDS * 05350021
*              CCW RECORD- BYTE-0 - IDENTIFICATION BYTE = X'01'       * 05450021
*                              -1-3 NOT USED                          * 05550021
*                              -4-5 NO. OF BYTES OF ID/LENGTH         * 05650021
*                              -6-7 NO. OF BYTES OF RLD INFORMATION   * 05750021
*                              -8   NOT USED(READ COMMAND)            * 05850021
*                              -9-11 LINKED ADDRESS OF TXT RECORD     * 05950021
*                              -12   FLAGS                            * 06050021
*                              -13  NOT USED                          * 06150021
*                              -14-15 COUNT OF TXT RECORD WHICH       * 06250021
*                                     FOLLOWS                         * 06350021
*                                                                     * 06450021
*              IF THE RECORD CONTAINS RLD INFORMATION, THE RLD ITEMS  * 06550021
*              FOLLOW AND THE IDENTIFICATION BYTE CONTAINS A X'02'    * 06650021
*              (BIT 6 IS SET) , E.G. CCW AND RLD IS X'03'.            * 06750021
*              FOLLOWING THE RLD INFORMATION, IS A 4 BYTE FIELD.      * 06850021
*              BYTES 0-1 ARE THE ID OF THE FOLLOWING TXT RECORD, BYTES* 06950021
*              2-3 ARE THE LENGTH OF THE FOLLOWING TXT RECORD.        * 07050021
*              IN ADDITION TO RLD INFORMATION THE IDENTIFICATION      * 07150021
*              BYTE MAY HAVE BITS 4 AND 5 SET ON. BIT 4 INDICATES     * 07250021
*              END OF MODULE, BIT 5 INDICATES END OF SEGMENT. THESE   * 07350021
*              BITS MAY BE SET IN ANY COMBINATION WITH CCW AND RLD,   * 07450021
*              OR THEY MAY BE SET ALONE.                              * 07550021
*              FOR ALL THE ABOVE MENTIONED RECORDS THE FORMAT IS THE  * 07650021
*              SAME.                                                  * 07750021
*              SYM RECORD- BYTE-0 - IDENTIFICATION BYTE= X'40'        * 07850021
*                              -1 -  EITHER (1XXXXXXX)- MEANING THE   * 07950021
*                                   RECORD CONTAINS ESD ITEMS NOT IN  * 08050021
*                                   TEST FORM,OR (0XXXXXXX)- MEANING  * 08150021
*                                   THE OPPOSITE                      * 08250021
*                              -2-3 NUMBER OF BYTES OF TESTRAN DATA   * 08350021
*                              -4-243 - TESTRAN DATA                  * 08450021
*                                                                     * 08550021
*              CESD RECORD- BYTE-0 - IDENTIFICATION BYTE= X'20'       * 08650021
*                               -1-3 - NOT USED                       * 08750021
*                               -4-5 - ESDID OF FIRST ESD ITEM        * 08850021
*                               -6-7 - NO. OF BYTES OF CESD INFO.     * 08950021
*                               -8-247 - CESD DATA                    * 09050021
*              SCATTER/TRANSLATION RECORD                             * 09150021
*                           BYTE-0 - IDENTIFICATION BYTE= X'10'       * 09250021
*                                1 - NOT USED                         * 09350021
*                                2-3 NUMBER OF BYTES OF SCATTER/      * 09450021
*                                    TRANSLATION INFO FOLLOWING       * 09550021
*                                4-1023 - DATA                        * 09650021
*                                                                     * 09750021
*        CONTROL CARDS- THEY ARE 80 COLUMN CARDS FOUND ONLY IN OBJECT * 09850021
*                       MODULES. THEIR GENERAL FORMAT FOLLOWS(THEY    * 09950021
*                       ARE FREE FORM.                                * 10050021
*                        COLUMN 1 CONTAINS A BLANK                    * 10150021
*                        THE OPERATOR NOW FOLLOWS, FOLLOWED BY AT     * 10250021
*                        LEAST ONE BLANK, FOLLOWED BY THE OPERAND.    * 10350021
*OUTPUT: N/A                                                          * 10450021
*                                                                     * 10550021
*EXTERNAL ROUTINES  HEWLFESD- ESD PROCESSOR                           * 10650021
*                   HEWLFEND- END PROCESSOR                           * 10750021
*                   HEWLFSCN- CONTROL CARD PROCESSOR                  * 10850021
*                   HEWLFSYM- SYM PROCESSOR                           * 10950021
*                   HEWLFRAT- RLD AND TXT PROCESSOR                   * 11050021
*                   HEWLFINC- INCLUDE PROCESSOR                       * 11150021
*                   HEWLCAUT- AUTOMATIC LIBRARY CALL PROCESSOR        * 11250021
*                                                                     * 11350021
*EXITS NORMAL  HEWLFADA- ADDRESS ASSIGNMENTS-AT NAME CARD OR END OF   * 11450021
*                         DATA ON SYSLIN IF NCALL OPTION IS SPECIFIED * 11550021
*                         AND DATA IS PRESENT                         * 11650021
*              HEWLFFNL- FINAL PROCESSOR. AT END OF DATA ON SYSLIN    * 11750021
*                         IF NO INPUT HAS BEEN PROCESSED IN THIS      * 11850021
*                         RECURSION                                   * 11950021
*               HEWLCAUT- AUTOMATIC LIBRARY CALL- IF NCALL IS NOT ON  * 12050021
*                         AND DATA HAS BEEN RECEIVED AT END OF DATA   * 12150021
*                         ON SYSLIN (THIS ROUTINE WILL EITHER RETURN  * 12250021
*                         TO THE INPUT PROCESSOR OR BRANCH TO ADDRESS * 12350021
*                         ASSIGNMENT IF ALL LIBRARY CALLS HAVE BEEN   * 12450021
*                         COMPLETED)                                  * 12550021
*EXITS ERROR:  THERE ARE NO ERROR EXITS TO THE SYSTEM. ALL ERRORS     * 12650021
*              ARE RELAYED THROUGH THE ERROR DIAGNOSTIC ROUTINE       * 12750021
*              (HEWLFLOG) WHICH THEN DECIDES WHETHER TO PROCEED OR    * 12850021
*              STOP.                                                  * 12950021
*                    ERRORS:  22-A CONTROL CARD WAS DISCOVED WITHIN   * 13050021
*                                 AN OBJECT MODULE OR AN ILLEGALL     * 13150021
*                                 CARD WAS DISCOVERED WITHIN AN OBJECT* 13250021
*                                 MODULE. SEVERITY = 1 - WARNING      * 13350021
*                             21- A CONTROL CARD CONTINUATION WAS     * 13450021
*                                 EXPECTED BUT NOT RECEIVED.          * 13550021
*                                 SEVERITY = 2 - ERROR                * 13650021
*                             23- UNRECOGNIZABLE LOAD MODULE INPUT    * 13750021
*                                 SEVERITY= 1                         * 13850021
*TABLES/WORK AREAS:  N/A                                              * 13950021
*ATTRIBUTES: REUSABLE                                                 * 14050021
*                                                                     * 14150021
*NOTES: N/A                                                             14250021
         ENTRY  HEWLCINP                                                14350021
         ENTRY HEWLCICA                                                 14450021
*              ENTRY POINT FOR INCLUDE ADDRESS CONSTANT               * 14550021
         ENTRY HEWLCEOD                                                 14650021
*              ENTRY POINT FOR LIBRARY END OF DATA                    * 14750021
         ENTRY HEWLEEON                                                 14850021
*              ENTRY POINT FOR SYSLIN END OF DATA                     * 14950021
         ENTRY HEWLERDM                                                 15050021
*              ENTRY POINT FOR READ MACRO                             * 15150021
BASE     EQU   12                                                       15250021
REG6     EQU   6                                                        15350021
READDATA EQU   320                                                      15450021
APT      EQU   2                                                        15550021
TEMP     EQU   1                                                        15650021
TEMP1    EQU   7                                                        15750021
BUFFER   EQU   10                                                       15850021
AUTOLIB  EQU   X'40'                                                    15950021
BUFFADD  EQU   4                                                        16050021
TAMP     EQU   11                                                       16150021
LOADMOD  EQU   X'20'                                                    16250021
DCBADD   EQU   8                                                        16350021
DCBPNT   EQU   0                                                        16450021
COL1     EQU   0                                                        16550021
SLASH    EQU   C'/'                                                     16650021
EOFON    EQU   X'80'                                                    16750021
EOFOFF   EQU   X'7F'                                                    16850021
BLANK    EQU   X'40'                                                    16950021
INMODON  EQU   X'02'                                                    17050021
COL5     EQU   4                                                        17150021
COL11    EQU   10                                                       17250021
COL15    EQU   14                                                       17350021
COL33    EQU   32                      CARD COLUMN 33 (START OF  S21016 17450021
*                                      IDR DATA FIELD ON OBJECT  S21016 17550021
*                                      MODULE END RECORD)        S21016 17650021
INMODOFF EQU   X'FD'                                                    17750021
ENTRYPT  EQU   X'08'                                                    17850021
ABSOLUTE EQU   X'FB'                                                    17950021
SYMBOLIC EQU   X'04'                                                    18050021
NOLGTH   EQU   X'40'                                                    18150021
COL29    EQU   28                                                       18250021
ESD      EQU   1                                                        18350021
ESDWRITE EQU   X'01'                                                    18450021
TEST     EQU   X'10'                                                    18550021
NAME     EQU   X'40'                                                    18650021
INCLUDE  EQU   X'80'                                                    18750021
NCALL    EQU   X'80'                                                    18850021
ENDINPUT EQU   X'20'                                                    18950021
EXITON   EQU   X'01'    INDICATOR FOR OPEN EXIT TAKEN                   19050021
EXITOFF  EQU   X'FE'      INDICATOR TO TURN OFF EXIT ON INDICATOR       19150021
TEMP2    EQU   0                                                        19250021
SYSRET   EQU   14                                                       19350021
SYSBRNCH EQU   15                                                       19450021
PRECL    EQU   8                                                        19550021
READCNT  EQU   9                                                        19650021
REG3     EQU   3                                                        19750021
REG4     EQU   4                                                        19850021
REG5     EQU   5                                                        19950021
SAVEAREA EQU   13                                                       20050021
RECCNT   EQU   18                                                       20250021
CURBUF   EQU   20                                                       20350021
BLKFAC   EQU   16                                                       20450021
READSW   EQU   24                                                       20550021
LRECL    EQU   14                                                       20650021
BLKSIZ   EQU   12                                                       20750021
****************    EQUATES FOR MESSAGES     ******************         20850037
MSG      EQU   0                                                        20880037
IEW0484  EQU   X'430'                                                   20910037
IEW0234  EQU   X'417'                                  @XA02229,OY00131 20930037
IEW0594  EQU   X'43B'                                                   20950037
IEW0123  EQU   X'030C'                 DISP=0,SEV=3,MSG=12       A51444 20970037
IEW0143  EQU   X'030E'                 DISP=0,SEV=3,MSG=14       A51444 20990037
****************************************************************        21030037
MODTYPE  EQU   X'FC'                   MODULE TYPE INDICATORS    S21016 21060037
*                                      FOR IDR                   S21016 21090037
PARMPTR  EQU   1                       PARAMETER LIST POINTER    S21016 21120037
         EJECT                                                          21150037
         LR    BASE,SYSBRNCH                                            21250021
         USING APTDSECT,APT                                             21350021
         USING HEWLCINP,BASE                                            21450021
*              INCLUDE,AUTOMATIC LIBRARY CALL, AND INITIALIZER ENTER  * 21550021
*              AT HEWLEINP WITH REG 15 CONTAINING THE ADDRESS OF      * 21650021
*              HEWLEINP                                               * 21750021
         B     INP10                                                    21850037
MODID    DC    C' HEWLFINP '                                            21890037
         DC    C' OZ07586 12/03/75 ',0H'0'                              21940037
         SPACE 3                                                        21990037
INP10    L     REG5,HEWLCLAC       ADDRESS OF CURRENT CONTROL BLOCK     22050021
         L     DCBADD,DCBPNT(0,REG5)   ADDRESS OF DECB                  22150021
         LA    TEMP1,HEWLFMDI           RETURN ADDRESS                  22250021
         TM    APT1,LOADMOD        IS THIS A LOAD MODULE                22350021
         BC    1,INP11                 YES                              22450021
         LH    REG6,RECCNT(0,REG5)     NO--GET CURRENT RECORD NUMBER    22550021
         BCT   REG6,INP10C             BRANCH IF RECORDS LEFT IN BUFFR  22650021
         LH    READCNT,BLKSIZ(0,REG5)  NONE LEFT. USE BLKSIZ FOR RD CNT 22750021
INP10A   L     BUFFER,BUFFADD(0,REG5)  SWITCH BUFFER ADDRESSES          22850021
         MVC   BUFFADD(4,REG5),BUFFADD+4(REG5)                          22950021
         ST    BUFFER,BUFFADD+4(0,REG5)                                 23050021
         LA    SAVEAREA,REGSA      ADDRESS OF SAVE AREA                 23150021
         LR    REG6,BASE               WILL USE REG6 FOR BASE REG       23250021
         TM    READSW(REG5),X'80'      IS THIS FIRST READ               23350021
         BC    1,INP10B                YES--DONT CHECK                  23450021
         TM    READSW(REG5),X'02'  HAS PVS READ ALREADY BEEN CHECKED    23550021
         BC    1,INP11B            YES--DON'T RECHECK                   23650021
         MVC   RECCNT(2,REG5),BLKFAC(REG5)  INITIALIZE RECCORD COUNT    23750021
         USING HEWLCINP,REG6                                            23850021
         DROP  BASE                                                     23950021
INP11A   CHECK (8)                                                      24050021
         TM    APT1,LOADMOD        IS THIS A LOAD MODULE                24150021
         BCR   1,TEMP1                 YES--READ IS FINISHED            24250021
INP11B   NI    READSW(REG5),X'FD'  TURN OFF ALREADY CHECKED SWITCH      24350021
         TM    READSW(REG5),X'04'      CHECK FOR INVALID BLOCKSIZE      24450021
         BC    8,INP10B                NO                               24550021
         LA    MSG,IEW0594             YES--ERR MSG 594                 24650037
         L     SYSBRNCH,ERDIG      ADDRESS OF ERROR LOGGER              24750021
         BR    SYSBRNCH                SHOULD NOT RETURN                24850021
INP11    LA    READCNT,260             SET UP FOR READING LOAD MODULE   24950021
         L     BUFFER,RLDINPAD     ADDR OF RLD INPUT BUFFER             25050021
         LR    REG6,BASE                                                25150021
HEWLERDM LA    SAVEAREA,REGSA                                           25250021
INP10B   READ  (8),SF,,(BUFFER),(READCNT),MF=E                          25350021
         TM    APT1,LOADMOD        IS THIS A LOAD MODULE                25450021
         BC    1,INP11A                YES--GO CHECK AND RETURN         25550021
         DROP  REG6                                                     25650021
         USING HEWLCINP,BASE                                            25750021
         TM    READSW(REG5),X'80'      WAS THIS FIRST READ              25850021
         BC    8,INP10E                NO                               25950021
         NI    READSW(REG5),X'7D'   YES--TURN OFF FIRST TIME SW         26050021
         BC    15,INP10A               AND READ AGAIN                   26150021
INP10E   L     BUFFER,BUFFADD(0,REG5)  NEW CHECKED BUFFER ADDRESS       26250021
         BC    15,INP10D                                                26350021
INP10C   L     BUFFER,CURBUF(0,REG5)   UPDATE CURRENT BUFFER ADDRESS    26450021
         AH    BUFFER,LRECL(0,REG5)                                     26550021
         STH   REG6,RECCNT(0,REG5)                                      26650021
INP10D   ST    BUFFER,CURBUF(0,REG5)                                    26750021
         BCR   15,TEMP1                CONTINUE                         26850021
INP13    CLI   COL1(BUFFER),BLANK                                       26950021
*              IF INPUT IS NOT CONTROL CARD - BRANCH                    27050021
         BC    7,INP20A                 ERROR--B AD CARD                27150021
         TM    APT2,INMODON        IS IN MODULE BIT ON                  27250021
         BC    1,INP18                  ERROR-CONTROL CRD IN MODULE     27350021
         L     SYSBRNCH,CRDSCN                                          27450021
         OI    APTSWS,X'04'        SET INPUT RECEIVED                   27550021
*              THE CARD SCAN REQUIRES THE CARD BUFFER ADDRESS IN      * 27650021
*              REGISTER ONE                                           * 27750021
         LR    TEMP,BUFFER                                              27850021
         BALR  SYSRET,SYSBRNCH                                          27950021
*              RETURN ADDRESS IS IN REGISTER 14                       * 28050021
         TM    APT3,NAME          TEMPORARY - MAYBE                     28150021
*              IF CONTROL CARD IS NOT NAME CARD,BRANCH                * 28250021
         BC    8,INP10                                                  28350021
         LH    REG6,RECCNT(0,REG5) GET NUMBER RECRDS LEFT IN BUFFER     28450021
         BCT   REG6,INP14          ARE ANY MORE RECORDS LEFT IN BUFFER  28550021
INP14    OI    APT1,AUTOLIB                                             28650021
*              SET AUTOMATIC LIBRARY CALL INDICATOR ON                * 28750021
         BC    15,EODA                                                  28850021
*                                                                     * 28950021
*                   **** END OF DATA ON SYSLIN ****                   * 29050021
*                                                                     * 29150021
*                                                                     * 29250021
HEWLEEON OI    APT1,AUTOLIB                                             29350021
*              SET AUTOMATIC LIBRARY CALL BIT ON                      * 29450021
*              SET END OF INPUT ON                                    * 29550021
         OI    APT3,ENDINPUT                                            29650021
         ST    SYSBRNCH,SAVE602        STORE RETURN ADDRESS             29750021
         BAL   SYSBRNCH,TESTEND        GO TO END CARD TEST              29850021
         L     SYSBRNCH,SAVE602        RESTORE RETURN ADDRESS           29950021
         TM    APTSWS,X'04'            HAS INPUT BEEN RECEIVED          30050021
         BC    1,EODA                                                   30150021
         TM    APTSW2,REINTRY          TEST IF FIRST TIME THRU   A51444 30200000
         BO    INP14A                  BRANCH IF NOT FIRST TIME  A51444 30210000
         LA    MSG,IEW0123             SET UP FOR MESSAGE 12     A51444 30220037
         L     SYSBRNCH,ERDIG          GET ADDR OF ERROR RTN     A51444 30226037
         BALR  SYSRET,SYSBRNCH         GO TO LOG MESSAGE 12      A51444 30232037
         LA    MSG,IEW0143             SET UP FOR MESSAGE 14     A51444 30238037
         L     SYSBRNCH,ERDIG          GET ADDR OF ERROR RTN     A51444 30244000
         BALR  SYSRET,SYSBRNCH         GO TO LOG MESSAGE 14      A51444 30246000
INP14A   EQU   *                       ERROR LOGGING BYPASS      A51444 30248000
         L     SYSBRNCH,FINALPRC                                        30250021
*              IF NO GOOD INPUT WAS RECEIVED- GO TO FINAL PROCESSOR   * 30350021
         BCR   15,SYSBRNCH                                              30450021
*                                                                     * 30550021
*                   **** END OF DATA ON LIBRARY DCB ****              * 30650021
*                                                                     * 30750021
*                                                                     * 30850021
HEWLCEOD TM    HEWLCRBB+24,X'08'       IS IGNORE EOF BIT ON?            30950037
         BCR   1,SYSRET                RETURN TO LIBOP                  31000037
BASESET  BALR  BASE,0                     RE-ESTABLISH BASE    @ZA07586 31050037
         L     BASE,INPADD-BASESET-2(BASE)  TO BEGIN OF INP    @ZA07586 31100037
         TM    APT1,LOADMOD            IS THIS A LOAD MODULE?           31150021
         BC    1,EODA                  YES - NO END CARD TEST           31250021
         ST    SYSBRNCH,SAVE602        STORE RETURN ADD.                31350021
         BAL   SYSBRNCH,TESTEND        GO TO END CARD TEST              31450021
         L     SYSBRNCH,SAVE602        RESTORE RETURN ADD.              31550021
EODA     TM    APT1,INCLUDE                                             31650021
*              IF MORE INCLUDES REQUESTED,GO TO INCLUDE PROCESSOR     * 31750021
         BC    1,INP16                                                  31850021
         NI    APT1,X'DF'                                               31950021
*              CLEAR LOAD MODULE INDICATOR AND                        * 32050021
*              RE-INITIALIZE READ BLOCK                               * 32150021
         LA    TEMP,HEWLCRBN                                            32250021
         ST    TEMP,HEWLCLAC                                            32350021
         TM    APT1,AUTOLIB                                             32450021
*              IF NOT EOF ON SYS(IN(OR EQUIVALENT), CONTINUE          * 32550021
         BC    8,INP10                                                  32650021
         TM    APT0,NCALL                                               32750021
         BC    1,INP15                                                  32850021
*              IF THE NCALL OPTION WAS SELECTED-ADDRESS ASSGN IS NEXT * 32950021
         L     SYSBRNCH,AUTOCALL                                        33050021
         BCR   15,SYSBRNCH                                              33150021
*              AUTOMATIC LIBRARY CALL IS NOW SELECTED                   33250021
INP15    L     SYSBRNCH,RLDADD         GO TO RLD/TXT FOR PURGE          33350021
         OI    NEWSW,X'01'             INDICATE PURGE TO TXT/RLD        33450021
         BALR  SYSRET,SYSBRNCH                                          33550021
         USING *,SYSBRNCH              RETURNS ON 15                    33650021
         L     SYSBRNCH,ADDADDA        ADDRESS OF ADDRESS ASSIGNMENT    33750021
         DROP  SYSBRNCH                                                 33850021
         BCR   15,SYSBRNCH                                              33950021
*              THE BRANCH TO ADDRESS ASSIGNMENT IS ACCOMPLISHED       * 34050021
*              THROUGH THE ROOT SEGMENT-THE ROOT ENTRY POINT IS       * 34150021
*              CALLED-HEWLCADA                                        * 34250021
INP16    L     SYSBRNCH,HEWLCICA                                        34350021
         BCR   15,SYSBRNCH                                              34450021
*              SELECT THE INCLUDE PROCESSOR                           * 34550021
INP18    LH    MSG,IEW0222              CONTROL CARD IN MODULE          34650037
         L     SYSBRNCH,ERDIG                                           34750037
         LA    SYSRET,INP10             RETURN TO READ NEXT CARD        34850037
         BCR   15,SYSBRNCH              BRANCH TO ERROR ROUTINE         34950037
ADDADDA  DC    V(HEWLFADA)                                              35150021
HEWLCICA DC    V(HEWLFINC)                                              35250021
CRDSCN   DC    V(HEWLFSCN)                                              35350021
AUTOCALL DC    V(HEWLCAUT)                                              35450021
FINALPRC DC    V(HEWLCFNI)                                              35550021
*              ADDRESS OF ABORT ENTRY TO FINAL PROCESSOR              * 35650021
*              USED TO TERMINATE LINK EDITOR                          * 35750021
*                                                                     * 35850021
*    THE LOAD OR OBJECT MODULE PROCESSOR IS NOW SELECTED              * 35950021
*                                                                     * 36050021
HEWLFMDI ST    BASE,BASAVE                                              36150021
         TM    APT1,LOADMOD                                             36250021
*              IF THE INPUT IS LOAD MODULE, BRANCH                    * 36350021
         BC    1,INP270                                                 36450021
*                                                                     * 36550021
*                   **** OBJECT MODULE PROCESSING STARTS ****         * 36650021
*                             **** HERE ****                          * 36750021
*                                                                     * 36850021
INP20    CLI   COL1(BUFFER),X'02'                                       36950021
*              IF THE CARD IS OBJECT MODULE, BRANCH                   * 37050021
         BC    8,INP40                                                  37150021
         B     INP13                    CHECK FOR CONTROL CARD          37250021
INP20A   LH    MSG,IEW0222         NOT OBJ MODULE INPUT                 37350037
         L     TEMP1,INPADD                                             37450021
INP21    L     SYSBRNCH,ERDIG                                           37550021
*              BRANCH TO ERROR ROUTINE                                * 37650021
         BALR  14,15                                                    37750021
         LR    SYSBRNCH,TEMP1                                           37850021
*              SKIP CARD, RETURN TO INPUT CONTROL TO READ NEXT CARD   * 37950021
         BCR   15,TEMP1                                                 38050021
INP22    LH    MSG,IEW0212         CONTINUATION NOT RECEIVED            38150037
         NI    APT2,X'FE'                                               38250021
*              CLEAR CONTINUATION BIT                                 * 38350021
         LA    TEMP1,INP20                                              38450021
         BC    15,INP21                                                 38550021
INP40    TM    APT2,X'01'          IS CONTINUATION EXPECTED             38650021
         BC    1,INP22             YES--WHEN CONTINTUATION IS EXPECTED  38750021
*                           AND NOT RECEIVED AN ERROR CONDITION ARISES  38850021
         LA    REG6,16(BUFFER)                                          38950021
*              REG6 CONTAINS THE ADDRESS OF COL 17                    * 39050021
         OI    APT2,INMODON                                             39150021
*              SET IN MODULE INDICATOR ON                             * 39250021
         L     TEMP2,COL1(BUFFER)                                       39350021
*              REGISTER 0 CONTAINS COLS 1 THRU 4                      * 39450021
         L     REG3,COL5(BUFFER)                                        39550021
*              REG3 CONTAINS COLS 5 THRU 8                            * 39650021
         LA    REG3,0(REG3)                                             39750021
         LH    REG4,COL11(BUFFER)                                       39850021
*              REG4 CONTAINS COLS 11 AND 12                           * 39950021
         LH    REG5,COL15(BUFFER)                                       40050021
*              REG5 CONTAINS COLS 15 AND 16                           * 40150021
*                                                                     * 40250021
*              THE FOLLOWING CODE EXAMINES COLS 1 THRU 4 AND          * 40350021
*              DETERMINES WHAT TYPE OF CARD WAS INPUT. IT THEN        * 40450021
*              BRANCHES TO THE APPROPRIATE SECTION OF CODE TO         * 40550021
*              PROCESS THE CARD                                       * 40650021
         LA    READCNT,5                                                40750021
         LA    TEMP,SYMTAB                                              40850021
INP50    LM    SYSRET,SYSBRNCH,0(TEMP)                                  40950021
         CR    TEMP2,SYSRET                                             41050021
         BC    8,INP60                                                  41150021
         LA    TEMP,8(TEMP)                                             41250021
         BCT   READCNT,INP50                                            41350021
         BC    15,INP20A                                                41450021
INP60    SLL   READCNT,2                                                41550021
         LA    TEMP,INP110                                              41650021
         LA    TEMP1,INP99                                              41750021
SWITCH   BC    15,SWITCH(READCNT)                                       41850021
         BC    15,INP65       END                                       41950021
         BC    15,INP150      SYM                                       42050021
         BC    15,INP140      ESD                                       42150021
         BC      15,INP130      RLD                                     42250021
         BC    15,INP160      TXT                                       42350021
*            END CARD PROCESSING                                        42450021
INP65    NI    ENDCD,X'FE'             END CARD FOUND                   42550021
         TM    APTSWS,X'02'            HAVE SYMS BEEN RECEIVED          42650021
*              IF SYMS HAVE BEEN RECEIVED,GO TO SYM PROC FOR PURGE    * 42750021
         BC    1,INP170                                                 42850021
         CLI   COL33(BUFFER),BLANK     DOES END CARD HAVE IDR    S21016 42950021
*                                      DATA? (IF NOT PRESENT,    S21016 43050021
*                                      COL.33 IS BLANK)          S21016 43150021
         BE    INP70                   NO, BRANCH                S21016 43250021
         OI    IDRSWS,OBJIDR           TURN ON OBJ.MOD.INDICATOR S21016 43350021
         B     INP340                  GO TO PROCESS IDR DATA    S21016 43450021
INP70    TM    APT1,ENTRYPT                                             43550021
*        IF AN  ENTRY POINT WAS RECEIVED, SKIP THE FOLLOWING          * 43650021
         BC    1,INP90                                                  43750021
         CH    REG5,ZBLNK+2                                             43850021
*        IF THE ENTRY POINT IS NOT ABSOLUTE, SKIP TO INP80            * 43950021
         BC    8,INP80                                                  44050021
         CL    REG3,ZBLNK                                               44150021
         BC    8,INP80                                                  44250021
*        SET ABSOLUTE INDICATOR ON                                    * 44350021
         NI    APT1,ABSOLUTE                                            44450021
         ST    REG3,EPSM                                                44550021
INP80    CLI   0(REG6),X'40'                                            44650021
*        IF THE ENTRY POINT IS NOT SYMBOLIC, SKIP TO INP90            * 44750021
         BC    8,INP90                                                  44850021
         OI    APT1,SYMBOLIC                                            44950021
*        SET SYMBOLIC INDICATOR ON  AS WELL AS ENTRY POINT INDICATOR  * 45050021
         OI    APT1,ENTRYPT                                             45150021
         MVC   EPSM(8),0(REG6)                                          45250021
INP90    L     REG4,COL29(0,BUFFER)                                     45350021
         CL    REG4,BLNK                                                45450021
*              IF THERE IS NO LENGTH ON THE END CARD, BRANCH          * 45550021
         BC    8,INP98                                                  45650021
         OI    APT2,X'80'                                               45750021
*              SET LENGTH RECEIVED BIT ON                             * 45850021
INP98    L     TEMP,INPADD             RETURN TO BEGINNING              45950021
INP99    ST    TEMP,BASAVE1                                             46050021
         LA    SAVEAREA,REGSA      ADDRESS OF SAVE AREA                 46150021
         OI    APTSWS,X'04'                                             46250021
INP100   BALR  SYSRET,SYSBRNCH                                          46350021
*              BRANCH TO PROCESSOR                                    * 46450021
         BALR  BASE,0                                                   46550021
         USING *,BASE                                                   46650021
         LM    BASE,SAVEAREA,BASAVE                                     46750021
         USING HEWLCINP,BASE                                            46850021
         LR    SYSBRNCH,SAVEAREA                                        46950021
*              RETURN TO POINT IN CODE SPECIFIED IN REG 13            * 47050021
         BCR   15,SYSBRNCH                                              47150021
INP110   L     SYSBRNCH,INPADD                                          47250021
         TM    APTSWS,ESD          IS RETURN FROM ESD PROC              47350021
         BCR   8,SYSBRNCH                                               47450021
         NI    APTSWS,X'FE'        CLEAR ESD RETURN                     47550021
         TM    APT1,ESDWRITE                                            47650021
*              IF ESD WRITE INDICATOR IS OFF, BRANCH                  * 47750021
         BCR   8,SYSBRNCH                                               47850021
         NI    APT1,X'FE'                                               47950021
*              CLEAR ESD WRITE INDICATOR                              * 48050021
         TM    PDSE7,TEST                                               48150021
*              IF TEST OPTION IS OFF, BRANCH                          * 48250021
         BCR   8,SYSBRNCH                                               48350021
         LR    TEMP,SYSBRNCH                                            48450021
*              INITIALIZE REGISTERS FOR SYM PROCESSOR (COUNT AND      * 48550021
*              BUFFER ADDRESS)                                        * 48650021
         L     REG6,HEWLCLAC                                            48750021
         LH    REG4,LRECL(0,REG6)                                       48850021
         L     REG6,CURBUF(0,REG6)     ADDRESS OF CURRENT INPUT OBJ BF  48950021
         L     SYSBRNCH,SYMADD                                          49050021
         TM    APT1,LOADMOD                                             49150021
*              IF THE INPUT IS OBJECT MOD, BRANCH                     * 49250021
         BC    8,INP111                                                 49350021
         SR    REG4,REG4                                                49450021
*              INDICATE PURGE FOR SYM                                 * 49550021
         BC    15,INP99                                                 49650021
INP111   OI    APTSWS,X'02'        SET SYM RECEIVED ON (ESD)            49750021
         BC    15,INP99                                                 49850021
*              RLD  PROCESSING                                        * 49950021
INP130   NI    APT0,X'FD'                                               50050021
*              ESD  PROCESSING                                        * 50150021
         BCR   15,TEMP1                                                 50250021
INP140   OI    APTSWS,ESD          SET ESD CARD BIT ON                  50350021
         CLC   76(4,BUFFER),CARD1      IS THIS FIRST OBJ CARD           50450021
         BCR   7,TEMP1                 NO                               50550021
         ST    SYSBRNCH,SAVE602        STORE RETURN ADDRESS             50650021
         BAL   SYSBRNCH,TESTEND        GO TO END CARD TEST              50750021
         L     SYSBRNCH,SAVE602        RESTORE RETURN ADDRESS           50850021
         BCR   15,TEMP1                                                 50950021
TESTEND  TM    ENDCD,X'81'             WAS END CARD FOUND               51050021
         BCR   12,SYSBRNCH             YES                              51150021
         STM   14,15,SAVE602+4                                          51250021
         LH    MSG,IEW0602+4           ERROR MESSAGE IEW0602            51350037
         L     SYSBRNCH,ERDIG          ERROR ROUTINE ADDRESS            51450021
         BALR  14,15                   BRANCH TO ERROR LOG              51550021
         LM    14,15,SAVE602+4                                          51650021
         BCR   15,SYSBRNCH                                              51750021
*              SYM PROCESSING                                         * 51850021
INP150   CLC   76(4,BUFFER),CARD1      FIRST ESD CARD                   51950021
         BNE   NOFRT                   NO                               52050021
         OI    ENDCD,X'80'             TURN ON TEST FOR END CARD        52150021
         BAL   SYSBRNCH,TESTEND                                         52250021
NOFRT    L     SYSBRNCH,INPADD                                          52350021
         LR    REG6,BUFFER                                              52450021
         TM    PDSE7,TEST                                               52550021
*              IF TEST OPTION IS OFF, GO TO NEXT CARD                 * 52650021
         BCR   8,SYSBRNCH                                               52750021
         L     SYSBRNCH,SYMADD                                          52850021
         OI    APTSWS,X'02'        SET SYM RECEIVED BIT ON              52950021
         LA    REG4,80                                                  53050021
         BCR   15,TEMP1                                                 53150021
*              TXT PROCESSING                                           53250021
INP160   CH    REG4,MAXOBJLN           VALIDATE DATA LN OX04563,OY03738 53300002
         BH    INP20A                  LOG ERR IF HIGH  OX04563,OY03738 53310002
         OI    ENDCD,X'01'             TEST END CARD    OX04563,OY03738 53350002
         TM    APTSWS,X'02'            HAVE SYMS BEEN RECEIVED          53450021
*              IF THEY HAVE, DO A SYM PURGE                           * 53550021
         BC    1,INP170                                                 53650021
         OI    APT0,X'02'                                               53750021
*              SET TXT BIT ON IN APT                                  * 53850021
         BCR   15,TEMP1                                                 53950021
*              SYM PURGE BEFORE TXT                                   * 54050021
INP170   SR    REG4,REG4                                                54150021
         NI    APTSWS,X'FD'        CLEAR SYM RECEIVED BIT               54250021
         L     SYSBRNCH,SYMADD                                          54350021
         BALR  TEMP,TEMP1                                               54450021
         L     REG6,HEWLCLAC                                            54550021
*              RESET THE BUFFER ADDRESS AND BRANCH TO PROCESS CARD    * 54650021
         L     BUFFER,CURBUF(0,REG6)                                    54750021
         BC    15,INP40                                                 54850021
SCAT     EQU   X'10'                                                    54950021
ESDREC   EQU   X'20'                                                    55050021
IDREC    EQU   X'80'                   LOAD MODULE RECORD TYPE   S21016 55150021
*                                      FOR IDR                   S21016 55250021
CCW      EQU   1                                                        55350021
RLD      EQU   X'02'                                                    55450021
LSTLST   EQU   X'08'                                                    55550021
BYTESRLD EQU   6                                                        55650021
SYM      EQU   X'40'                                                    55750021
*                                                                     * 55850021
*                        **** LOAD MODULE PROCESSING STARTS ****      * 55950021
*                             **** HERE ****                          * 56050021
*                                                                     * 56150021
INP270   LA    TEMP1,INP99                                              56250021
*              SET UP BRANCHING REGISTERS                             * 56350021
         CLI   COL1(BUFFER),SYM                                         56450021
*              IF THE RECORD IS NOT SYM, BRANCH                       * 56550021
         BC    7,INP281                                                 56650021
         TM    PDSE7,TEST                                               56750021
*              IF THE TEST OPTION IS NOT ON, BRANCH                   * 56850021
         BC    8,INP315                                                 56950021
         LA    TEMP,INP315             RTN ADD TO GO TO INPUT PROC      57050021
         SR    4,4                                                      57150021
*              INDICATE PURGE, BRANCH                                 * 57250021
         L     SYSBRNCH,SYMADD                                          57350021
         BCR   15,TEMP1                                                 57450021
INP280   TM    COL1(BUFFER),LSTLST                                      57550021
*              IF THE RECORD IS END-OF-MODULE,BRANCH                  * 57650021
         BC    1,INP282                                                 57750021
         LA    MSG,IEW0234                                              57850037
         L     TEMP1,INPADD             SKIP THIS RECORD                57950021
         BC    15,INP21                 BRANCH TO ERROR ROUTINE         58050021
INP282   L     TEMP,EOFADD                                              58150021
         L     TAMP,INPADD                                              58250021
*              PREPARE TO BRANCH TO END OF FILE AFTER END PROCESS     * 58350021
         ST    TAMP,BASAVE                                              58450021
         L     SYSBRNCH,ENDADD                                          58550021
*              BRANCH TO END PROCESSOR                                * 58650021
         BC    15,INP99                                                 58750021
INP281   TM    COL1(BUFFER),ESDREC                                      58850021
*              IF RECORD IS NOT ESD, BRANCH                           * 58950021
         BC    8,INP290                                                 59050021
         LA    TEMP,INP110                                              59150021
         OI    APTSWS,ESD          SET ESD BIT ON                       59250021
         LH    REG4,6(BUFFER)                                           59350021
*              REG4 CONTAINS THE BYTE COUNT                           * 59450021
         LH    REG5,4(BUFFER)                                           59550021
*              REG5 CONTAINS THE ID OF THE FIRST ESD ITEM             * 59650021
         LA    REG6,8(BUFFER)                                           59750021
*              REG6 CONTAINS THE ADDRESS OF THE ESD INFO                59850021
         L     SYSBRNCH,ESDADD                                          59950021
         BCR   15,TEMP1                                                 60050021
INP290   TM    COL1(BUFFER),RLD                                         60150021
*              IF THE RECORD IS NOT RLD, BRANCH                       * 60250021
         BC    8,INP300                                                 60350021
         LA    REG6,16(BUFFER)                                          60450021
*              REG6 CONTAINS THE ADDRESS OF THE RLD DATA              * 60550021
         LH    REG4,BYTESRLD(BUFFER)                                    60650021
*              REG4 CONTAINS THE RLD BYTE COUNT                       * 60750021
         L     SYSBRNCH,TXTADD                                          60850021
         ST    DCBADD,BASAVE2                                           60950021
         BALR  TEMP,TEMP1          TO RLD PROCESSOR                     61050021
INP299   L     DCBADD,BASAVE2                                           61150021
INP300   L     BUFFER,RLDINPAD          ADDR OF LAOD MOD BUFFER         61250021
*              RESTORE DCBADDRESS AND BUFFER ADDRESS                  * 61350021
         TM    COL1(BUFFER),CCW                                         61450021
*              IF THE RECORD IS NOT TXT, BRANCH                       * 61550021
         BC    8,INP305                                                 61650021
         L     REG3,8(BUFFER)                                           61750021
*              REG3 CONTAINS THE ASSIGNED ADDRESS                     * 61850021
         LA    REG3,0(REG3)                                             61950021
         LH    REG6,BYTESRLD(BUFFER)                                    62050021
         LA    REG6,16(BUFFER,REG6)                                     62150021
         L     REG4,12(BUFFER)                                          62250021
         LA    REG4,0(REG4)                                             62350021
*              REG4 CONTAINS THE TXT BYTE COUNT                       * 62450021
         LH    REG5,0(REG6)                                             62550021
*              REG5 CONTAINS THE TXT ID                               * 62650021
         LA    TEMP,INP310                                              62750021
         L     SYSBRNCH,TXTADD                                          62850021
         OI    APT0,X'02'                                               62950021
*              SET TXT INDICATOR ON AND BRANCH TO TXT PROCESSOR       * 63050021
         BC    15,INP99                                                 63150021
INP305   TM    COL1(BUFFER),RLD                                         63250021
*              IF THE RECORD IS NOT RLD BRANCH                        * 63350021
         BC    8,INP320                                                 63450021
INP310   L     BUFFER,RLDINPAD          ADDR OF LOAD MOD BUFFER         63550021
*              RE-INITIALIZE THE BUFFER ADDRESS                       * 63650021
         NI    APT0,X'FD'                                               63750021
*              CLEAR TXT INDICATOR                                    * 63850021
         TM    COL1(BUFFER),LSTLST                                      63950021
*              IF THE RECORD IS END OF MODULE, BRANCH                 * 64050021
         BC    1,INP282                                                 64150021
INP315  L     SYSBRNCH,INPADD                                           64250021
*              BRANCH TO INPUT CONTROL                                * 64350021
         BCR   15,SYSBRNCH                                              64450021
INP320   TM    COL1(BUFFER),SCAT                                        64550021
*              IF THE INPUT IS NOT SCATTER, BRANCH                      64650021
         BZ    INP330                  GO TO TEST FOR IDR        S21016 64750021
         BC    15,INP315                                                64850021
INP330   CLI   COL1(BUFFER),IDREC      IS RECORD TYPE IDR?       S21016 64950021
         BNE   INP280                  IF NOT, BRANCH            S21016 65050021
         OI    IDRSWS,LMDIDR           TURN LOAD MOD. INDICATOR  S21016 65150021
INP340   STM   SAVEAREA,PARMPTR,IDRSAV  SAVE LINKAGE REGS (13-1) S21016 65250021
         LA    PARMPTR,BUFADDR         POINT TO PARAMETER LIST   S21016 65350021
         LA    SAVEAREA,REGSA          LOAD ADDR. OF SAVE AREA    M4123 65400021
         L     SYSBRNCH,IDRADDR        GET ADDR.OF IDR PROCESSOR S21016 65450021
         ST    BUFFER,BUFADDR          PLACE ADDR.OF REC.IN      S21016 65550021
*                                      PARAMETER LIST            S21016 65650021
         BALR  SYSRET,SYSBRNCH         CALL IDR PROCESSOR        S21016 65750021
         LM    SAVEAREA,PARMPTR,IDRSAV  RESTORE LINKAGE REG'S.   S21016 65850021
         TM    IDRSWS,LMDIDR           WAS LOAD MOD.IDR JUST     S21016 65950021
*                                      PROCESSED?                S21016 66050021
         BO    INP350                  YES, CONTINUE PROCESSING  S21016 66150021
*                                      WITH NEXT LOAD MOD.RECORD S21016 66250021
         NI    IDRSWS,MODTYPE          NO, TURN OFF MOD.TYPE     S21016 66350021
*                                      INDICATORS                S21016 66450021
         B     INP70                   CONTINUE PROCESSING       S21016 66550021
*                                      OF OBJECT MOD. END CARD   S21016 66650021
INP350   NI    IDRSWS,MODTYPE          TURN OFF MODULE TYPE      S21016 66750021
*                                      INDICATORS                S21016 66850021
         B     INP315                  RETURN TO LOAD MODULE     S21016 66950021
*                                      PROCESSOR                 S21016 67050021
         ENTRY HEWLCDLK                                                 67150021
RNTR     EQU   4                                                        67250021
RNT      EQU   5                                                        67350021
TEMP4    EQU   0                                                        67450021
TEMP3    EQU   1                                                        67550021
CESD     EQU   3                                                        67650021
         USING HEWLCDLK,SYSBRNCH                                        67850021
HEWLCDLK STM   RNTR,DCBADD,REGSA   SAVE REGISTERS                       67950021
         ST    TEMP3,REGSA+24                                           68250021
         SLL   TEMP3,4                  COMPUTE CESD LINE ADDRESS       68350021
         AR    TEMP3,CESD                                               68450021
         NC    9(3,TEMP3),9(TEMP3)      IS THE ASSEMBLED ADDRESS ZERO   68550021
         BC    8,DLK3                   YES,BRANCH TO RETURN            68650021
         L     REG6,DLKT           ADDRESS OF DELINK TABLE              68750021
         LH    TEMP1,ENDTC         INCREMENT CURRENT COUNT OF           68850021
         LA    TEMP1,1(TEMP1)           DELINK TABLE ENTRIES            68950021
         CH    TEMP1,ENDTX         IS DELINK TABLE EXEEDED              69050021
         BC    2,DLKTBLOF               YES,BRANCH TO ERROR ROUTINE     69150021
DLK4     STH   TEMP1,ENDTC         SET DELINK TBL CURRENT COUNT         69250021
         LR    DCBADD,TEMP1             SAVE UPDATED DELINK COUNT       69350021
         SLL   RNTR,2                  GET RENUMBERING TBL ENTRY S01904 69450021
         A     RNTR,RECNT              COMPUTE RNT LINE ADDR     S01904 69550021
         STH   TEMP1,0(RNTR)            SET DELINK TBL LINE IN RNTID    69650021
         OI    2(RNTR),X'04'            SET DELINK VALUE SAVED BIT      69750021
         SLL   DCBADD,2                                                 69850021
         AR    TEMP1,DCBADD             COMPUTE DELINK TBL ENTRY ADDRS  69950021
         L     REG6,DLKT               ADDRESS OF DELINK TABLE   S01904 70050021
         AR    REG6,TEMP1                                               70150021
         MVC   2(3,REG6),9(TEMP3)       SAVE ASSM. ADDRESS IN DLK TBL.  70250021
         TM    3(RNTR),X'40'            IS TYPE IN RNT -CHAIN-          70450021
         BC    8,DLK2                   NO,BRANCH                       70550021
         MVC   0(2,REG6),14(TEMP3)      SAVE CHAIN ID IN DELINK TBL.    70650021
         BC    15,DLK3                                                  70750021
DLK2     MVC   0(2,REG6),REGSA+26  MOVE CESDID TO DLK TBL               70850021
DLK3     LM    RNTR,DCBADD,REGSA   RESTORE                              70950021
         NI    8(TEMP3),X'EF'           CLEAR DELINK BIT IN CESD TYPE   71050021
         BCR   15,SYSRET                RETURN                          71150021
DLKTBLOF TM    APT4,X'C0'              CAN REALLOC BE DONE?      S01904 71250021
         BO    DLKTBLF                 ALREADY DONE-GO TO ERROR RTN     71350021
         STM   TEMP2,SYSBRNCH,BRNCHSV  SAVE REGISTERS            S01904 71450021
         L     SYSBRNCH,ERDIGA         ADDRESS OF REALLOC RTN    S01904 71550021
         BALR  SYSRET,SYSBRNCH         GO TO REALLOC RTN         S01904 71650021
         LM    TEMP2,SYSBRNCH,BRNCHSV  RESTORE REGISTERS         S01904 71750021
         MVC   REGSA+4(4),RECNT        UPDATE PTR TO RNT          M4320 71760021
         B     DLK4                    PROCEED                   S01904 71850021
DLKTBLF  LA    MSG,IEW0484              LOAD REG 0 WITH ERROR CODE      71950037
         L     SYSBRNCH,ERDIG      LOAD REG15 WITH ADDRESS OF           72050021
*                                       ERROR DIAGNOSTIC ROUTINE        72150021
         BCR   15,SYSBRNCH              THIS IS A TERMINAL ERROR        72250021
*****                         ERROR                               ***** 72350021
         DROP  SYSBRNCH                                                 72450021
         DS    0F                                                       72550021
BASAVE   DS    1F                                                       72650021
BASAVE1  DS    1F                                                       72750021
BASAVE2  DS    1F                                                       72850021
SYMTAB   DC    X'02'                                                    72950021
         DC    C'TXT'                                                   73050021
TXTADD   DC    V(HEWLFRAT)                                              73150021
         DC    X'02'                                                    73250021
         DC    C'RLD'                                                   73350021
RLDADD   DC    V(HEWLFRAT)                                              73450021
         DC    X'02'                                                    73550021
         DC    C'ESD'                                                   73650021
ESDADD   DC    V(HEWLFESD)                                              73750021
         DC    X'02'                                                    73850021
         DC    C'SYM'                                                   73950021
SYMADD   DC    V(HEWLFSYM)                                              74050021
         DC    X'02'                                                    74150021
         DC    C'END'                                                   74250021
ENDADD   DC    V(HEWLFEND)                                              74350021
RDMACRO  DC    V(HEWLERDM)                                              74450021
EOFADD   DC    V(HEWLCEOD)                                              74550021
INPADD   DC    V(HEWLCINP)                                              74650021
MAXOBJLN DC    H'56'                   TEXT DATA LEN    OX04563,OY03738 74700002
******** ERROR MSG **************************************************** 74750037
IEW0602  DC    F'0',X'223C'            ERROR IEWL0602 MESSAGE           74810037
IEW0222  DC    X'1216'                                                  74870037
IEW0212  DC    X'1215'                                                  74930037
*********************************************************************** 74990037
ENDCD    DC    X'00'                   SWITCH FOR END CARD TEST         75050021
*        0  BIT X'80' START END CARD TESTING                            75150021
*        1-6          SPARE                                             75250021
*        7     X'01' LOOK FOR END CARD                                  75350021
CARD1    DC    C'0001'                 END CRD TEST- 1ST ESD CRD        75450021
SAVE602  DS    3F                      FOR END CRD TEST SAVEAREA        75550021
ZBLNK    DC    X'00404040'                                              75650021
BLNK     DC    C'    '                                                  75750021
IDRADDR  DC    V(HEWLFIDR)             ADDRESS OF IDR PROCESSOR  S21016 75850021
IDRSAV   DS    5F                      SAVE AREA FOR IDR RTN.    S21016 75950021
BUFADDR  DS    F                       IDR PARAMETER LIST        S21016 76050021
****************************************************************        76150037
*        PATCH AREA                                            *        79150037
****************************************************************        82150037
PATCH    DC    20F'0',C'PATCH AREA' FOR PROG MAINT                      85150037
         HEWAPT                                                         88150037
         END                                                            91150037
