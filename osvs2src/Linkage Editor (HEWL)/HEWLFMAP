         TITLE    'HEWLFMAP  CROSS REFERENCE AND MODULE MAP'            00100021
HEWLFMAP CSECT                                                          00200021
*                                                                     * 00300021
*THIS CSECT IS CALLED IF MAP OR XREF IS SPECIFIED.                    * 00400021
*IT PRODUCES THE REQUESTED DATA.                                      * 00500021
*                                                                     * 00600021
*ENTRY ONLY AT HEWLFMAP BY ANY MEANS                                  * 00700021
*                                                                     * 00800021
*INPUT: SYSLMOD LOAD MODULE                                           * 00900021
*                                                                     * 01000021
*OUTPUT: MAP ON PRINTER                                               * 01100021
*                                                                     * 01200021
*EXIT: NORMAL RETURN                                                  * 01300021
*                                                                     * 01400021
*XCESDTAB IS THE ADDRESS OF THE TABLE WHERE COMPOSITE ESD ENTRIES     * 01500021
*ARE COLLECTED (16-BYTE ENTRIES).                                     * 01600021
*XADDCESD IS THE ADDRESS OF THE TABLE OF ADDRESSES FROM ESD ENTRIES   * 01700021
*FOR THE PRESENT SEGMENT (4-BYTE ENTRIES).                            * 01800021
*XAD2CESD IS THE ADDRESS OF THE TABLE CORRESPONDING TO XADDCESD CON-  * 01900021
*TAINING RESPECTIVE ENTRY NUMBERS (2-BYTE ENTRIES).                   * 02000021
*RLDIN IS RLD INPUT BUFFER.                                           * 02100021
*PRLIN IS PRINT OUTPUT BUFFER.                                        * 02200021
*PRHDR IS SAVED HEADER BUFFER.                                        * 02300021
*                                                                     * 02400021
*REUSABLE                                                             * 02500021
*                                                                     * 02600021
R0       EQU   0                                                        02700021
R1       EQU   1                                                        02800021
RPAR     EQU   1                                                        02900021
RJ       EQU   1                                                        03000021
APT      EQU   2                                                        03100021
RD       EQU   3                                                        03200021
RENTRY   EQU   4                                                        03300021
RI       EQU   4                                                        03400021
RPLACE   EQU   4                                                        03500021
RF       EQU   5                                                        03600021
RST      EQU   5                                                        03700021
RST2     EQU   6                                                        03800021
RG       EQU   6                                                        03900021
RWORK    EQU   7                                                        04000021
RH       EQU   7                                                        04100021
RIN      EQU   7                                                        04200021
RA       EQU   8                                                        04300021
RB       EQU   9                                                        04400021
RE       EQU   10                                                       04500021
RC       EQU   11                                                       04600021
RBASE    EQU   12                                                       04700021
RSAVREG  EQU   13                                                       04800021
R14      EQU   14                                                       04900021
R15      EQU   15                                                       05000021
         EXTRN HEWLCMDB                                                 05100021
         EXTRN APTXLIST                ADDRESS OF OPEN EXIT LIST        05200021
         ENTRY JFCBADDR                ADDRESS OF SYSLMOD JFCB          05300021
ALBIT    EQU   X'80'                                                    05400021
XREFBIT  EQU   X'40'                 BIT SET FOR XREF OPTION            05500021
OVERBIT  EQU   X'20'                 OVERLAY BIT                        05600021
ESDIND   EQU   X'20'                 ESD INDICATOR                      05700021
PRIVCODE EQU   X'04'                 PRIVATE CODE                       05800021
HEXTEN   EQU   X'10'                 HEXADECIMAL TEN FOR CONVERSION     05900021
DECTEN   EQU   X'0A'                 DECIMAL TEN FOR CONVERSION         06000021
PRIVDEL  EQU   X'14'                 CODE FOR ENTAB AND SEGTAB          06100021
NEVCALL  EQU   X'06'                 NEVER CALL BITS                    06200021
CUMLNREQ EQU   X'30'                    FLAG FOR CUM PSEUDO REG LN REQ  06300021
EOMOD    EQU   X'08'                 END OF MODULE BIT                  06400021
SKIP     EQU   X'0B'                   IMMEDIATE SPACE                  06500021
SINGLE   EQU   X'09'                   PRINT AND SPACE                  06600021
DOUBLE   EQU   X'11'                   PRINT AND SPACE 2                06700021
TRIPLE   EQU   X'19'                   PRINT AND SPACE 3                06800021
SKIP2    EQU   X'13'                   IMMEDIATE SPACE 2                06900021
SKIP3    EQU   X'1B'                   IMMEDIATE SPACE 3                07000021
RESTORE  EQU   X'8B'                   SKIP TO CHANNEL 1                07100021
TSO      EQU   X'80'                   TSO SWITCH IN APTSWS             07200021
         USING *,R15                 SET UP BASE ADDRESSABILITY         07300021
         USING APTDSECT,APT       ESTABLISH ADDRESSABILITY FOR APT      07400021
START    EQU   *                     FOR LATER STATEMENT OF BASE ADDR   07500021
         BC    15,MODID+6              BRANCH AROUND MODULE IDENT       07600021
MODID    DC    C'05MMAP'                                                07700021
         NC    ENCDC(2),ENCDC          TEST FOR NO ESDS                 07800021
         BC    7,MAP000                                                 07900021
         BR    R14                     RETURN                           08000021
MAP000   EQU   *                                                        08100021
         OI    NEWSW,X'10'             INDICATE MAP/XREF IN OPERATION   08200021
         STM   R14,RBASE,SPACES+12 SAVE REG                             08300021
         LR    RBASE,R15             LOAD PERMANENT BASE                08400021
         USING START,RBASE           PROPER USING                       08500021
         DROP  R15                   OLD BASE                           08600021
         LA    RSAVREG,REGSA      LOAD SAVE AREA ADDRESS                08700021
         EJECT                                                          08800021
*                                                                       08900021
*        THIS PROGRAM PRODUCES A MEMORY MAP AND A CROSS REFERENCE       09000021
*        TABLE AS SUPPLEMENTARY OUTPUT FROM THE LINKAGE EDITOR          09100021
*                                                                       09200021
         TM    APTSWS,TSO          TSO MODE?                            09300021
         BZ    TSO1               NO - BRANCH                           09400021
         LA    RA,40               CHANGE LINE COUNTS                   09500021
         STH   RA,COUNT                                                 09600021
         LA    RA,20(RA)                                                09700021
         STH   RA,COUNT2                                                09800021
TSO1     LH    RA,ENCDC            NUMBER OF CESD ENTRIES               09900021
         LA    RA,20(0,RA)             ADD SAFETY FACTOR                10000021
         TM    NEWSW,X'40'             IS ENTRY FROM INTERMEDIATE       10100021
         BC    8,ALLOC                 NO--DO GETMAIN FOR CESD          10200021
         L     R1,CHESD                YES--USE CESD IN CORE            10300021
         LA    R1,16(0,R1)             INCREMENT TO FIRST ENTRY         10400021
         B     ALLOCA                                                   10500021
ALLOC    LH    R0,ENCDX                MAXIMUM NUMBER OF ENTRIES        10600021
         SLL   R0,4                  MULTIPLY BY SIXTEEN                10700021
         ST    R0,SAVMAIN            SAVE LENGTH OF AREA OBTAINED       10800021
         L     R1,CHESD                USE CESD FOR TABLES              10900021
ALLOCA   ST    R1,XCESDTAB             STORE ADDRESS OF CESD            11000021
         LH    R1,ENR1C                NO. OF ENTRIES IN RLD NOTELIST   11100021
         MH    R1,RLDNTSZ              TIMES BYTES PER ENTRY            11200021
         L     R0,RNT1                 INITIALIZE SAVRLDNT              11300021
         AR    R1,R0                                                    11400021
         ST    R1,RLDNTEND             SAVE END ADDRESS                 11500021
         SH    R0,RLDNTSZ              ONE ENTRY BEFORE BEGINNING       11600021
         ST    R0,SAVRLDNT                                              11700021
         LM    R0,R1,HEWLCRBB+4        ADDRESSES OF SYSLIB OBJ BUFFERS  11800021
         CR    R0,R1                   USE LOWER ADDRESS AS START       11900021
         BNH   ALLOCB                       FOR WORK AREA               12000021
         LR    R0,R1                                                    12100021
ALLOCB   ST    R0,XAD2CESD                                              12200021
*                                                                       12300021
*        FIRST, A HEADER IS PUT OUT WITH A SKIP TO ONE.                 12400021
*                                                                       12500021
         MVI   CNTLCH,SKIP2            SKIP TWO LINES                   12600021
         TM    APTSWS,TSO          TSO MODE?                            12700021
         BC    1,MAP0005           YES - BRANCH                         12800021
         MVC   LINCOUNT+1(1),LINECNT+1  INITIALIZE LINE COUNTER         12900021
         CLI   LINCOUNT+1,X'0A'      TEST FOR ROOM ON PAGE              13000021
         BC    3,MAP0005             NO                                 13100021
         MVI   CNTLCH,RESTORE          RESTORE PAGE CHARACTER           13200021
         MVI   LINCOUNT+1,NUMBLINS+2   SET LINE COUNTER                 13300021
MAP0005  EQU   *                                                        13400021
         BAL   R14,CNTRL               TO CARRIAGE CONTROL ROUTNIE      13500021
         TM    APT0,XREFBIT       TEST FOR XREFS                        13600021
         BC    3,PUTHC               PUT XREF HDR                       13700021
         MVC   PRLIN+55(10),TOPHDM   NO  PUT MAP HEADER                 13800021
         B     PUTHEAD               PUT HEADER                         13900021
TOPHDM   DC    C'MODULE MAP'         MAP HEADER                         14000021
TOPHDC   DC    C'CROSS REFERENCE TABLE'                                 14100021
SGHD     DC    C'NAME    ORIGIN  LENGTH  SEG. NO.'                      14200021
SEGHD    EQU   SGHD+24               ADDR OF WORDS SEG. NO.             14300021
NAMLOC   DC    C'NAME   LOCATION'                                       14400021
PUTHC    MVC   PRLIN+49(21),TOPHDC   MOVE IN XREF HEADER                14500021
PUTHEAD  LA    R15,PUTLINS                                              14600021
         L     RD,DCBLMOD            LOAD ADDRESS OF DCB                14700021
         MVI   PRLIN,DOUBLE            PRINT AND SPACE 2                14800021
         BALR  R14,R15               CALL PRINT SUBROUTINE              14900021
         TM    NEWSW,X'40'             IS ENTRY FROM INTERMEDIATE       15000021
         BC    1,L1OUT                 YES--BYPASS READ                 15100021
*                                                                       15200021
*        END OF DATA EXIT IS REPLACED BY SPECIAL ONE FOR THIS CSECT.    15300021
*                                                                       15400021
         MVC   SAVEODAD(3),33(RD)    SAVE END OF DATA ADDRESS           15500021
         MVC   33(3,RD),SPECEOD      LOAD SPECIAL ADDRESS               15600021
MAPPOINT CLOSE ((RD))                CLOSE SYSLMOD FOR OUTPUT           15700021
         TM    JFCBADDR,X'80'          IS SYSLMOD OPEN J REQUIRD        15800021
         BZ    NORMLOPN                NO--BRANCH                       15900021
         GETMAIN EU,LV=200,A=JFCBADDR  GETMAIN AN AREA FOR JFCB         16000021
         L     1,XLSTADDR              GET SYSLMOD EXIT LST ADDR        16100021
         MVC   5(3,1),JFCBADDR+1       JFCB AREA ADDR TO EXT LST        16200021
         RDJFCB ((RD),(INPUT))         ISSUE RDJFCB FOR SYSLMOD         16300021
         L     6,JFCBADDR              LOAD JFCB ADDR INTO REG          16400021
         MVC   44(8,6),PDSE1           MOVE MEM NAME INTO JFCB          16500021
         OI    52(6),X'08'             INHIBT JFCB RETRN TO JOBQ        16600021
         OPEN  ((RD),(INPUT)),TYPE=J   OPEN J SYSLMOD FOR INPUT         16700021
         B     ARNDOPN                 BYPASS NORMAL OPEN               16800021
NORMLOPN OPEN  ((RD))                  OPEN SYSLMOD FOR INPUT           16900021
ARNDOPN  LA    R0,CTTR                 LOAD DCB ADDRESS                 17000021
         POINT (RD),(0)              POINT TO FIRST ESD                 17100021
         L     RIN,XCESDTAB          LOAD INPUT PTR W ADDR OF TBL       17200021
         LR    RST,RIN               SVE START REG                      17300021
MAP001   READ  DECB2,SF,(RD),RLDIN,256  READ RECORD FROM MODULE         17400021
         CHECK DECB2                                                    17500021
         TM    RLDIN,ESDIND          TEST FOR ESD INDICATOR             17600021
L0SW     BC    0,L1OUT               NOP SW SET BY 1ST ESD              17700021
         BC    8,MAP001              LOOP TO READ ANOTHER RECORD        17800021
         MVI   L0SW+1,X'80'          SET SW FOR ESD FOUND               17900021
         LH    RA,RLDIN+6            LOAD NUMBER OF ESD BYTES           18000021
         EX    RA,ESDMVC             EXECUTE MOVE TO ESD TABLE          18100021
         AR    RIN,RA                INCREMENT POINTER                  18200021
         TM    RLDIN,EOMOD           TEST FOR LAST ESD + NO TEXT        18300021
         BC    3,L1OUT               READ NO MORE                       18400021
         B     MAP001                LOOP TO READ AGAIN                 18500021
ESDMVC   MVC   0(0,RIN),RLDIN+8      EXECUTED TO MOVE ESD TO TABLE      18600021
SAVEND   DS    1F                    SAVE LIMIT OF ESDS                 18700021
*                                                                       18800021
*        PROCESS ASSEMBLED ESD ENTRIES                                  18900021
*                                                                       19000021
L1OUT    L     RST,XCESDTAB            ADDRESS OF CESD                  19100021
         NC    ENR1C(2),ENR1C          CHECK FOR NO RLDS                19200021
         BC    7,L1GO                  IF THERE ARE RLDS                19300021
         MVI   L5SW2+1,X'00'         PREVENT XREFS                      19400021
L1GO     LH    RIN,ENCDC               NUMBER OF CESD ENTRIES           19500021
         SLL   RIN,4                   TIMES 16 FOR NUMBER OF BYTES     19600021
         A     RIN,XCESDTAB            ADD START OF TABLE               19700021
         BCTR  RIN,0                   DECREMENT BY ONE                 19800021
         ST    RIN,SAVEND            SAVE                               19900021
         TM    SAVATS,OVERBIT     TEST FOR OVERLAY                      20000021
         BC    3,L1CONT              YES                                20100021
         MVI   L2SW+1,X'00'          PROC ALL ENTRIES                   20200021
         MVC   SEGHD(8),SEGHD-1      BLANK OUT SEG. NO. FROM HDR        20300021
L1CONT   LA    RIN-1,16              LOAD STOPPING FACTOR               20400021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   20500021
*                                                                       20600021
MAP002   EQU   L1CONT                LOOP TO PROCESS A SEGMENT          20700021
*                                                                       20800021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   20900021
         TM    APT0,XREFBIT       TEST FOR CROSS REFERENCES             21000021
L1SW     BC    0,NONEWHDR            SKIP HEADER IF NO XREFS AFTER 1ST  21100021
         MVI   L1SW+1,X'80'          MAKE NOP BRANCH FROM NOW ON        21200021
         MVC   PRHDR+2(117),PRHDR+1  PREVENT LAST HEADER FROM PRINTIN   21300021
         MVC   PRLIN+2(28),PRLIN+1   BLANK OUT POSS RESIDUE             21400021
         MVI   CNTLCH,SKIP             SKIP A LINE                      21500021
         BAL   R14,CNTRL                                                21600021
         LA    R15,PUTLINS             ADDRESS OF PRINT ROUTINE         21700021
         MVC   PRLIN+3(15),CTLSEC                                       21800021
         MVC   PRLIN+41(5),ENTRY     PUT HEADER                         21900021
         TM    APTSWS,TSO          TSO MODE?                            22000021
         BC    1,MAP0025           YES - BRANCH                         22100021
         CLI   LINCOUNT+1,X'05'      TEST FOR BOTTOM OF PAGE            22200021
         BC    3,MAP0025             NO  GO AHEAD AND PRINT             22300021
         MVI   LINCOUNT+1,X'01'      RESET LINE COUNTER FOR SKIP        22400021
MAP0025  EQU   *                                                        22500021
         MVI   PRLIN,DOUBLE            PRINT AND DOUBLE SPACE           22600021
         BALR  R14,R15               CALL SUBR TO PRIT LINE             22700021
         MVC   PRLIN+5(32),SGHD      MOVE IN SEG HEADER                 22800021
         MVC   PRLIN+43(15),NAMLOC                                      22900021
         MVC   PRLIN+63(15),NAMLOC                                      23000021
         TM    APTSWS,TSO          TSO MODE?                            23100021
         BC    1,TEMP              YES - BRANCH                         23200021
         MVC   PRLIN+83(15),NAMLOC                                      23300021
         MVC   PRLIN+103(15),NAMLOC                                     23400021
TEMP     MVI   PRLIN,DOUBLE        PRINT + DOUBLE SPACE                 23500021
         MVC   PRHDR(119),PRLIN        SAVE HEADER FOR NEW PAGE         23600021
         BALR  R14,R15               CALL SUBROUTINE                    23700021
NONEWHDR LA    RENTRY,1              INIT ENTRY COUNTER                 23800021
         L     RB,RNT1                 ADDRESS OF RLD NOTELIST          23900021
         SH    RB,RLDNTSZ              MINUS SIZE OF ENTRY              24000021
         ST    RB,SAVRLDNT                                              24100021
         L     RB,XAD2CESD           INIT ADDR OF 2 BYTE TABLE          24200021
         ST    RB,SAVID                INITIALIZE SAVID TO FIRST        24300021
*                                                                       24400021
*        LOOP TO SELECT ESD ENTRIES FOR THIS SEGMENT                    24500021
*                                                                       24600021
L2        CLI  8(RST),X'0A'                                             24700021
      BE   L2CTL                                                        24800021
       TM   8(RST),X'03'                                                24900021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   25000021
*                                                                       25100021
MAP003   EQU   L2                    LOOP TO SELECT ESD ENTRIES         25200021
*                                                                       25300021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   25400021
         BC    8,PROCSEG             PROCESS SEGTION                    25500021
         TM    8(RST),X'06'          TEST FOR PSEUDO REG  OR NULL       25600021
         BC    3,L2CTL               YES  LOP TO NEXT                   25700021
         TM    8(RST),X'05'          TEST FOR COMMON                    25800021
         BC    3,PROCSEG             YES  TREAT AS SECTION              25900021
         BC    8,L2CTL               EXTERNAL REF = UNRESOLVED          26000021
         LH    RPAR,14(0,RST)        LOAD SECT ENTRY NO. AS PARAMETER   26100021
         BAL   R14,SEGSUBR           CALL SUBR TO LOCATE ENTRY          26200021
         CH    RPAR,SEGNO            IN THIS SEGMENT                    26300021
L2SW     BC    7,L2CTL               NO  LOOP AGAIN                     26400021
         STH   RENTRY,0(0,RB)        STORE ENTRY NUMBER                 26500021
         LA    RB,2(0,RB)            ADVANCE POINTERS                   26600021
L2CTL    LA    RENTRY,1(0,RENTRY)    ADVANCE ENTRY NUMBER               26700021
         BXLE  RST,RIN-1,L2          LOOP CTL STEPS THRU ESDS           26800021
         ST    RB,IDEND                SAVE ADDRESS OF END OF ID LIST   26900021
         C     RB,XAD2CESD           TEST FOR NO ENTRIES                27000021
         BC    8,L5SW2-4             OMIT PROCESSING                    27100021
         EJECT                                                          27200021
*                                                                       27300021
*        THE FOLLO WING PROGRAM SORTS THE ENTRIES FOR                   27400021
*        THIS SEGMENT USING TWO TABLES, ON EOF TWO BYTE ENTRIES         27500021
*        AND  ONE OF 4 BYTE (ADDRESS) ENTRIES ON WHICH THE              27600021
*        SORT IS DONE.                                                  27700021
*                                                                       27800021
*        SORT REGISTER USAGE IS AS FOLLOWS                              27900021
*        RA    ADDRESS OF CURRENT COMPARAND IN FOUR BYTE TABLE          28000021
*        RB    ADDRESS OF LAST ENTRY FULLY SORTED IN FOUR BYTE TABLE    28100021
*        RC    LIMIT FOR SORT = END OF FOUR BYTE TABLE                  28200021
*        RD    COMPARAND                                                28300021
*        RE    PLUS FOUR FOR INCREMENT                                  28400021
*        RF    USED FOR EXCHANGE OF TWO BYTE ENTRIES                    28500021
*        RG    MINUS FOUR FOR DECREMENT                                 28600021
*        RH    LIMIT FOR SORT = START OF FOUR BYTE TABLE                28700021
*        RI    ADDRESS OF CURRENT ENTRY IN TWO BYTE TABLE               28800021
*        RJ    ADDRESS OF TWO BYTE ENTRY FOR LAST FULLY SORTED ITEM     28900021
*                                                                       29000021
         LR    RC,RB                   END OF TWO BYTE TABLE            29100021
         LA    RE,2                    LOAD INCREMENT FOR SORT          29200021
         SR    RC,RE                 SUBTRACT 4 FOR LIMIT               29300021
         BCTR  RC,0                  AND 1 MORE                         29400021
         LNR   RG,RE                 LOAD DECREMENT FOR SORT            29500021
         L     RA,XAD2CESD             ADDR OF 2 BYTE TABLE             29600021
         CR    RA,RC                 TEST FOR BUT ONE ENTRY             29700021
         BC    3,MAP0055             YES  SKIP SORT                     29800021
         L     RI,XAD2CESD           LOAD ADDR OF 2 BYTE TABLE          29900021
         LR    RH,RA                 LOAD START ADDRESS                 30000021
         BCTR  RH,0                  MINUS ONE FOR LIMIT                30100021
SL1      LR    RJ,RI                 LOAD CURRENT ADDR FOR 2BYTE TBL    30200021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   30300021
*                                                                       30400021
MAP004   EQU   SL1                   MAJOR SORT LOOP                    30500021
*                                                                       30600021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   30700021
         LR    RB,RA                 LOAD CURRENT ADDR FOR 4BYTE TBL    30800021
SL2      LH    RD,0(0,RA)              CESD ID                          30900021
         BCTR  RD,0                    MINUS ONE                        31000021
         SLL   RD,4                    TIMES 16                         31100021
         A     RD,XCESDTAB             PLUS CESD ADDRESS                31200021
         L     RD,8(0,RD)              ASSIGNED ADDRESS                 31300021
         LA    RD,0(0,RD)                                               31400021
         LH    RF,2(0,RA)              CESD ID NEXT ENTRY               31500021
         BCTR  RF,0                    MINUS ONE                        31600021
         SLL   RF,4                    TIMES 16                         31700021
         A     RF,XCESDTAB             PLUS ADDRESS OF CESD             31800021
         L     RF,8(0,RF)              LKED ASSIGNED ADDRESS            31900021
         LA    RF,0(0,RF)                                               32000021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   32100021
*                                                                       32200021
MAP005   EQU   SL2                   MINOR SORT LOOP                    32300021
*                                                                       32400021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   32500021
         CR    RD,RF                   COMPARE ADDRESSES                32600021
         BC    4,INORD               IN ORDER                           32700021
         BC    2,XCHANGE             MUST BE EXCHANGED                  32800021
*        MUST NOW TEST FOR SECT FOLLOWING SYMBOL AT SAME LOCATION.      32900021
         ST    RPAR,RPARSAV          SAVE PARAM REGISTER                33000021
         LH    RPAR,2(0,RI)          LOAD ENTRY NUMBER OF LAST AS PAR   33100021
         BAL   R14,SEGSUBR           SUBR TO LOCATE CESD ENTRY          33200021
         L     RPAR,RPARSAV          RESTORE PARAMETER REGISTER         33300021
         TM    8(R15),X'03'          TEST FOR CSECT OR PRIVATE          33400021
         BC    8,XCHANGE             BRANCH IF SO TO EXCHANGE           33500021
         TM    8(R15),X'05'          TEST FOR COMMON                    33600021
         BC    12,INORD              BRANCH TO IN ORDER IF NOT          33700021
XCHANGE  LH    RF,0(0,RI)              LOAD ID OF CESD ITEM             33800021
         MVC   0(2,RI),2(RI)         EXCHANGE ENTRIES                   33900021
         STH   RF,2(0,RI)                                               34000021
         BCTR  RI,0                  DECREMENT POINTER BY 2             34100021
         BCTR  RI,0                                                     34200021
         BXH   RA,RG,SL2             DECR & LOOP BACK THRU TBL TO ST    34300021
INORD    LR    RA,RB                 RELOAD PTR FROM CURRENT            34400021
         LR    RI,RJ                 RELOAD PTR FROM CURRENT            34500021
         LA    RI,2(0,RI)            ADD 2 TO 2BYTE PTR                 34600021
         BXLE  RA,RE,SL1             INCR PTR &LOOP BACK TIL DONE       34700021
         EJECT                                                          34800021
*                                                                       34900021
*        THE FOLLOW ING PROGRAM PROCESSE THE SORTED ESD ENTRIES         35000021
*        FOR A SEGMNENT AND PRODUCES A MEMORY MAP.                      35100021
*                                                                       35200021
MAP0055  SR    RPLACE,RPLACE         ZERO REG FOR ENTRY COUNTER         35300021
         L     RST,XAD2CESD          LOAD PT RTO TOP OF 2BYTE TABLE     35400021
         LR    RST2,RST                                                 35500021
         LA    RC-1,2                  INCREMENT FOR BXLE               35600021
         AR    RC,RC-1               RESTORE LIMIT TO END               35700021
L5       LH    RPAR,0(0,RST)         LOAD ENTRY NUMBER                  35800021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   35900021
*                                                                       36000021
MAP006   EQU   L5                    LOOP THROUGH TABLE ENTRIES         36100021
*                                                                       36200021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   36300021
         BAL   R14,SEGSUBR           CALL SUBR TO LOCATE ENTRY          36400021
         LR    RA,R15                SAVE POINTER                       36500021
         TM    8(R15),X'03'          TEST FOR SECT OR PRIV CODE         36600021
         BC    8,PUTSECT             YES                                36700021
         TM    8(R15),X'05'          \)ST FOR COMMON                    36800021
         BC    12,L5CONT1            NO  CONTINUE                       36900021
         B     PUTSECT               HANDLE AS SECTION                  37000021
PROCSEG  CLC   SEGNO+1(1),12(RST)    TEST FOR THIS SEGMENT NUMBER       37100021
         B     L2SW                  TEST IN LINE                       37200021
L5CONT1  CH    RPLACE,COUNT        LINE FINISHED?                       37300021
         BC    7,L5CONT2             NO  CONTINUE                       37400021
         SR    RPLACE,RPLACE         REZERO REG                         37500021
         LA    R15,PUTLINS           SUBR TO PRINT                      37600021
         BALR  R14,R15               CALL SUBROUTINE                    37700021
L5CONT2  LR    RWORK,RPLACE          COMPUTE PLACE FOR LABEL            37800021
         LA    RPLACE,20(0,RPLACE)   INCR NAME COUNTER                  37900021
         LA    RWORK,PRLIN(RWORK)    ADD ADDR OF PR LINE TO REG         38000021
         L     RPAR,8(0,RA)            LOAD ADDRESS OF THIS ENTRY       38100021
         BAL   R14,BINBCDS           CALL CONVERSION SUBROUTINE         38200021
         LR    R15,RA                RESTORE POINTER                    38300021
         MVC   41(8,RWORK),0(R15)    MOVE IN NAME                       38400021
         MVC   51(6,RWORK),COLLECT   MOVE IN LOC                        38500021
L5CTL    LA    RST,2(0,RST)          ADD 2 TO TABLE POINTER             38600021
         BXLE  RST2,RC-1,L5          INCR PTR & LOOP TIL END            38700021
         LA    R15,PUTLINS           SUBR PUT LINE TO PUT LABELS LEFT   38800021
         BALR  R14,R15               CALL SUBROUTINE                    38900021
         TM    APT0,XREFBIT       TEST FOR CROSS REFS CALL              39000021
L5SW2    BC    3,XREFS               YES  NOP IF NO MORE RLDS           39100021
XRRET    LA    R15,PUTLINS             ADDRESS OF PRINT SUBROUTINE      39200021
         BALR  R14,R15                                                  39300021
         CLI   CUMLEN+5,C' '           TEST FOR ANY CUM LEN REQ         39400021
         BC    8,NXTSEGNO            NO                                 39500021
         MVC   PRLIN+3(58),CUMREQ    DENOTE CUM LENGTH REQUEST          39600021
         BALR  R14,R15               CALL SUBROUTINE                    39700021
         MVC   CUMLEN(6),CUMLEN-1    BLANK OUT CUN LENGTH               39800021
NXTSEGNO CLC   CSNO(2),SEGNO      TEST FOR HIGHEST SEGMENT NUMBER       39900021
         BC    8,CLEANUP             YES  GET FINAL ITEMS               40000021
         LH    RA,SEGNO              LOAD SEGMENT NUMBER                40100021
         LA    RA,1(0,RA)            ADD 1 TO SEGMENT NO.               40200021
         STH   RA,SEGNO              RESTORE                            40300021
         L     RIN,SAVEND            RESTORE INPUT REGISTER             40400021
         L     RST,XCESDTAB          LOAD ADDRESS OF ESD TABLE          40500021
         BC    15,L1CONT             LOOP TO NEXT SEGMENT               40600021
COUNT    DC    H'80'                 RECORD LENGTH - TSO                40700021
COUNT2   DC    H'120'                RECORD LENGTH - MVT                40800021
SAVEODAD DS    3C                    SAVE END OF DATA ADDRESS HERE      40900021
SPECEOD  DC    AL3(XRRET)            ADDR OF ALTERNATE EO DATA EXIT     41000021
         EJECT                                                          41100021
*                                                                       41200021
*        ROUTINE TO PUT OUT SECTION LINE                                41300021
*                                                                       41400021
PUTSECT  LTR   RPLACE,RPLACE         TEST FOR NO LSYMBOLS               41500021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   41600021
*                                                                       41700021
MAP007   EQU   PUTSECT               ROUTINE TO PROCESS SECTION         41800021
*                                                                       41900021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   42000021
         BC    8,L5CONT3             NONE                               42100021
         LA    R15,PUTLINS           SUBR TO PRINT                      42200021
         BALR  R14,R15               CALL SUBROUTINE                    42300021
L5CONT3  L     RPAR,8(0,RA)            LOAD ADDRESS OF SECT             42400021
         LA    R15,BINBCDS           SUBR TO CVT FROM BIN TO BCD        42500021
         BALR  R14,R15               CALL SUBROUTINE                    42600021
         MVC   PRLIN+13(6),COLLECT   MOVE IN ADDRESS                    42700021
         LR    RWORK,RA              RESTORE POINTER TO ENTRY           42800021
         L     RPAR,12(0,RWORK)      LOAD ADDRESS FOR CONVERSION        42900021
         BALR  R14,R15               CALL SUBROUTINE                    43000021
         MVC   PRLIN+21(6),COLLECT   MOVE IN ADDRESS                    43100021
SECCONT  TM    8(RWORK),X'80'        TEST FO LIBRARY                    43200021
         BC    8,*+8                 NO                                 43300021
         MVI   PRLIN+11,C'*'         MOVE IN LIBR DESIGNATUON           43400021
         MVC   PRLIN+3(8),0(RWORK)   MOVE IN NAME                       43500021
         TM    8(RWORK),X'01'        TEST FOR COMMONP                   43600021
         BC    8,NOTCOM              NOT COMMON                         43700021
         CLI   0(RWORK),C' '         TEST FOR BLANK                     43800021
         BC    7,OVERTEST            OMIT OTHER TESTS                   43900021
         MVC   PRLIN+2(9),BLANKCOM   DESIGNATE BLANK COMMON             44000021
         B     OVERTEST              OMIT OTHER TESTS                   44100021
NOTCOM   CLI   8(RWORK),PRIVDEL      TEST FOR SEGTAB OR ENTAB           44200021
         BC    7,SEGTSTS             NO                                 44300021
         MVC   PRLIN+2(6),ENTAB      SET ENTAB DESIGNATOR               44400021
L5SW3    BC    0,SEGPRINT            SW FOR ENTABS FROM NOW ON          44500021
         MVI   L5SW3+1,X'F0'         SET SW FOR ENTAB HENCEFORTH        44600021
         MVC   PRLIN+2(7),SEGTAB     LOAD SEGTAB DESIGNATOR             44700021
         B     SEGPRINT              BYPASS UNNEEEDED TESTS             44800021
SEGTSTS  TM    8(RWORK),PRIVCODE     TEST FOR PRIVATE CODE              44900021
         BC    8,OVERTEST            NO  TEST OVERLAY NEXT              45000021
         MVC   PRLIN+2(9),PRIVATE    PLACE PRIVATE DESIGNATOR           45100021
OVERTEST TM    SAVATS,OVERBIT     TEST FOR OVERLAY                      45200021
         BC    8,PRINTSEC            NO  PRINT LINE                     45300021
SEGPRINT SR    RPAR,RPAR             CLEAR REG FOR PARAMETER            45400021
         IC    RPAR,12(0,RWORK)      INSERT SEGMENT NUMBER              45500021
         CVD   RPAR,COLLECT-1        CONVERT TO DECIMAL                 45600021
         UNPK  COLLECT(5),COLLECT+5(3) UNPACK QUANTITY                  45700021
        MVC   PRLIN+30(3),COLLECT     MOVE INTO PRINT LINE              45800021
         CLI   PRLIN+30,C'0'           CHECK FOR LEADING ZERO           45900021
         BC    7,PRINTSEC              NO                               46000021
         MVI   PRLIN+30,C' '           MOVE IN BLANK                    46100021
         CLI   PRLIN+31,C'0'         TEST FOR LEADING ZERO              46200021
         BC    7,PRINTSEC            NO  CONTINUE                       46300021
         MVI   PRLIN+31,C' '         REPLACE ZERO WITH LEADING BLANK    46400021
PRINTSEC LA    R15,PUTLINS           LOAD ADDR OF SUBR TO PRINT LINE    46500021
         SR    RPLACE,RPLACE         ZERO REGISTER                      46600021
         BALR  R14,R15               CALL SUBROUTINE                    46700021
         BC    15,L5CTL              LOOP TO NEXT TABLE ENTRY           46800021
         DS    0F                    ALIGN TO FULL WORD BOUNDARY        46900021
DCBLMOD  DC    AL4(HEWLCMDB)                                            47000021
WKWORD   DC    AL4(0)                WORD ON BOUNDRY                    47100021
SAVMAIN  DS    2F                    WORDS FOR FREE MAIN MACRO          47200021
XCESDTAB EQU   SAVMAIN+4             ADDRESS OF CESD ENTRIES            47300021
XADDCESD DS    1F                    ADDRESS FO 4 BYTE TABLE            47400021
XAD2CESD DS    1F                    ADDRESS OF 2 BYTE TABLE            47500021
SAVID    DC    F'0'                    POINTER TO CURRENT ID            47600021
SAVRLDNT DC    F'0'                    POINTER TO CURRENT RLD NOTELIST  47700021
RLDNTEND DC    F'0'                    END OF RLD NOTELIST              47800021
IDEND    DC    F'0'                    END OF ID LIST                   47900021
ALIGNF   DC    F'0'                    TO ALIGN ADDRESS TO FULL WORD    48000021
SAVAD    DC    F'0'                    SAVE ADDRESS OF SECTION          48100021
RMASK    DC    X'00007FFF'             MASK OUT HI ORDER BIT R POINTER  48200021
ALIGNH   DC    H'0'                    TO ALIGN COUNT TO HALF WORD      48300021
FIVE     DC    H'5'                    SIZE OF DELINK TABLE ENTRY       48400021
RLDNTSZ  DC    H'9'                    SIZE OF RLD NOTELIST             48500021
SEGNO    DC    AL2(1)                CURRENT SEGMENT NUMBER             48600021
PRIVATE  DC    C'$PRIVATE '          PRIVATE CODE DESIGNATOR            48700021
ENTAB    DC    C'$ENTAB'             ENTAB DESIGNATOR                   48800021
SEGTAB   DC    C'$SEGTAB'            SEGTAB DESIGNATOR                  48900021
BLANKCOM DC    C'$BLANKCOM'          BL ANK COMMON DESIGNATOR           49000021
CTLSEC   DC    C'CONTROL SECTION'                                       49100021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   49200021
         EJECT                                                          49300021
*                                                                       49400021
*        THIS ROUTINE PROCESSE RLD ENRTIES TO GET X REF TABLE           49500021
*                                                                       49600021
XREFS    EQU   *                                                        49700021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   49800021
*                                                                       49900021
MAP008   EQU   XREFS                 ROUTINE TO PROCESS RLDS FOR SEG    50000021
*                                                                       50100021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   50200021
         MVC   PRHDR+2(117),PRHDR+1  PREVENT LAST HEADER FROM PRINTIN   50300021
         MVI   CNTLCH,SKIP2            IMMEDIATE SKIP 2 LINES           50400021
         BAL   R14,CNTRL                                                50500021
         LA    R15,PUTLINS             ADDRESS OF PRINT ROUTNIE         50600021
         MVC   PRLIN+3(30),CRHEAD    PUT IN XREF HEADER                 50700021
         MVC   PRLIN+34(15),CTLSEC                                      50800021
         MVC   PRLIN+51(8),SEGHD                                        50900021
         TM    APTSWS,TSO          TSO MODE?                            51000021
         BC    1,TEMP2             YES - BRANCH                         51100021
         MVC   PRLIN+60(59),PRLIN+1    COMPLETE HEADING                 51200021
TEMP2    LA    RST,PRLIN           ADDRESS OF PRINT LINE                51300021
         MVI   PRLIN,DOUBLE            PRINT AND DOUBLE SPACE           51400021
         MVC   PRHDR(119),PRLIN        SAVE HEADER FOR NEW PAGE         51500021
         BALR  R14,R15               CALL SUBROUTINE                    51600021
         LA    RC-1,4                                                   51700021
         LNR   RA,RC-1               LOAD DECREMENTFOR BXH              51800021
         SR    RA+1,RA+1             ZERO FOR TEST OF BXH               51900021
         TM    NEWSW,X'40'             IS ENTRY FROM INTERMEDIATE       52000021
         BC    8,XL1CONT               NO--CARD ALREADY READ            52100021
MAP009   TM    NEWSW,X'40'             IS ENTRY FROM INTERMEDIATE       52200021
         BC    8,MAP009A               NO--GO READ A RECORD             52300021
MAP0091  L     RD,SAVID                ADDRESS OF CURRENT ID            52400021
         L     RC,SAVRLDNT             ADDRESS OF RLD NOTELIST ITEM     52500021
MAP0090  LA    RC,9(0,RC)              UPDATE TO NEXT RLD NOTELIST      52600021
MAP00901 C     RC,RLDNTEND             IS END OF LIST REACHED           52700021
         BNL   MAP0092                 YES                              52800021
         CLC   0(2,RC),0(RD)           ARE RLDS FOR THIS ID             52900021
         BC    7,MAP0090               NO--CHECK NEXT ENTRY             53000021
         MVC   ALIGNF+1(3),6(RC)       YES--GET ADDRESS OF RLD DATA     53100021
         MVC   ALIGNH(2),4(RC)         AND NUMBER OF BYTES              53200021
         ST    RC,SAVRLDNT             SAVE POINTER TO RLD NOTELIST     53300021
         L     RD,ALIGNF               DISPLACEMENT OF RLD DATA         53400021
         AR    RD,RD                   TIMES 4                          53500021
         AR    RD,RD                                                    53600021
         TM    2(RC),X'10'             IS IT IN BUFFER 2                53700021
         BC    1,MAP0093               YES                              53800021
         A     RD,RLDOUT1              NO--ADD ADDRESS OF BUFFER 1      53900021
         BC    15,MAP0094                                               54000021
MAP0093  A     RD,RLDOUT2              ADD ADDRESS OF BUFFER 2          54100021
MAP0094  LH    RC,ALIGNH               NUMBER OF WORDS OF RLD DATA      54200021
         AR    RC,RC                   TIMES FOUR                       54300021
         AR    RC,RC                                                    54400021
         SR    RD,RC                   START OF RLD DATA                54500021
         B     XL3                     GO TO PROCESS RLDS               54600021
MAP0092  LA    RD,2(0,RD)              UPDATE POINTER TO NEXT ID        54700021
         C     RD,IDEND                IS END OF ID LIST REACHED        54800021
         BNL   XRRET                   YES--CHECK FOR ANOTHER SEGMENT   54900021
         ST    RD,SAVID                NO--SAVE ADDRESS OF ID           55000021
         L     RC,RNT1                 AND START AT TOP OF RLD NOTELIST 55100021
         B     MAP00901                TO SEARCH LIST FOR THIS ID       55200021
MAP009A  L     RD,DCBLMOD              ADDRESS OF SYSLMOD DCB           55300021
         READ  DECB4,SF,(RD),RLDIN,256                                  55400021
XL1      EQU   MAP009                                                   55500021
         CHECK DECB4                                                    55600021
XL1CONT  TM    RLDIN,X'02'           TEST FOR RLD                       55700021
         BC    8,RLDOUTA               TEST FURTHER                     55800021
XL1A     LA    RD,RLDIN+16           INIT REG TO 1ST RLD DATA           55900021
         LH    RC,RLDIN+6            LOAD COUNT OF RLD DATA             56000021
XL3      TM    4(RD),X'20'           TEST FOR PSEUDO                    56100021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   56200021
*                                                                       56300021
MAP010   EQU   XL3                   LOOP TO PROCESS RLD ENTRY          56400021
*                                                                       56500021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   56600021
         BC    12,XL3CONT            NO  GO ON                          56700021
         TM    4(RD),CUMLNREQ        TEST FOR PSEUDO REG LENGTH REQ     56800021
         BC    12,XL3A               NO                                 56900021
         CLI   CUMLEN+5,C' '         TEST FOR ONE ALREADYENCOUNTERED    57000021
         BC    7,XL3A                YES                                57100021
         L     RPAR,4(0,RD)          LOAD ADDRESS FOR CONVERSION        57200021
         BAL   R14,BINBCDS           CALL CONVERSION SUBROUTINE         57300021
         MVC   CUMLEN(6),COLLECT     MOVE IN ADDRESS                    57400021
XL3A     TM    4(RD),X'01'           TEST FOR CONTINUATION              57500021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   57600021
*                                                                       57700021
MAP011   EQU   XL3A                  LOOP TO PASS OVER RLD ENTRIES      57800021
*                                                                       57900021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   58000021
         BC    8,XGETNXT2              NO--GET NEXT RLD ITEM            58100021
         SR    RD,RA                 ADD 4 TO REG                       58200021
         BXH   RC,RA,XL3A            LOOP                               58300021
         B     RLDOUTA                                                  58400021
XL4      MVC   4(26,RST),3(RST)        BLANK OUT UNWANTED ADDRESS NAME  58500021
         B     XL3A                    SKIP OVER ANY CONTINUATIONS      58600021
XL3CONT  LH    RPAR,2(0,RD)          LOAD POINTER                       58700021
         BAL   R14,SEGSUBR           CALL SUBR TO LOCATE ENTRY          58800021
         CH    RPAR,SEGNO            TEST FOR THIS  SEGMENT             58900021
         BC    7,XRRET               NO  RETURN                         59000021
         L     RPAR,4(0,RD)          LOAD ADDRESS FOR CONVERSION        59100021
         TM    NEWSW,X'40'             IS ENTRY FROM INTERMEDIATE       59200021
         BC    8,XL4CONT               NO                               59300021
         LH    R14,2(0,RD)             GET P POINTER                    59400021
         SLL   R14,2                   TIMES 4                          59500021
         A     R14,RECNT               PLUS START OF RELCTN CNST TABLE  59600021
         L     R14,0(0,R14)            GET RELOCATION CONSTANT          59700021
         ST    R14,SAVAD               SAVE IT FOR POSSIBLE LATER USE   59800021
         AR    RPAR,R14                ADD RELOCATION CONSTANT          59900021
XL4CONT  BAL   R14,BINBCDS             CALL CONVERSION SUBROUTINE       60000021
         MVC   4(6,RST),COLLECT        MOVE IN ADDRESS                  60100021
         LH    RPAR,0(0,RD)          LOAD ENTRY NUMBER                  60200021
         TM    0(RD),X'80'             IS DELINK BIT ON                 60300021
         BC    8,XL5CONT               NO--HAVE REAL R POINTER          60400021
         N     RPAR,RMASK              YES--GET REAL R POINTER          60500021
         MH    RPAR,FIVE               R POINTER TIMES LENGTH OF DELINK 60600021
         A     RPAR,DLKT               PLUS ADDRESS OF DELINK TABLE     60700021
         MVC   ALIGNH(2),0(RPAR)       ALIGN R POINTER TO HALF WORD     60800021
         LH    RPAR,ALIGNH             REAL R POINTER FROM DELINK TABLE 60900021
XL5CONT  STH   RPAR,ALIGNH             SAVE R POINTER                   61000021
         LTR   RPAR,RPAR             TEST R POINTER FOR ZERO            61100021
         BC    8,XL4                 BYPASS ENTAB ENTRIES               61200021
         BAL   R14,SEGSUBR           CALL SUBR TO LOCATE ENTRY          61300021
         LR    RPLACE,R15            SAVE ADDR IN CONVENIENT REG        61400021
         MVC   22(8,RST),0(RPLACE)     MOVE IN SYMBOL                   61500021
         CLI   8(RPLACE),X'02'       TEST FOR UNRESOLVED                61600021
         BC    8,UNRES               YES                                61700021
      CLI   8(RPLACE),X'0A'                                             61800021
       BC   8,WXT                                                       61900021
         CLI   8(RPLACE),X'07'         TEST FOR NULL                    62000021
         BC    8,XL4                   YES--OMIT REFERENCE              62100021
         TM    8(RPLACE),X'03'       TEST FOR CONTROL SECTIOMN          62200021
         BC    8,RLDSECT             YES                                62300021
         TM    8(RPLACE),X'05'       TEST FOR SECTION                   62400021
         BC    3,RLDSECT             YES                                62500021
         CLC   14(2,RPLACE),2(RD)    TEST FOR INTERNAL REFERENCE        62600021
         BC    8,XL4                 YES  SKIP THIS REFERENCE           62700021
         LH    RPAR,14(0,RPLACE)     LOAD REF NO. FOR THIS ENTRY        62800021
         BAL   R14,SEGSUBR           CALL SUBR TO LOCATE ENTRY          62900021
         LR    RPLACE,R15            PLACE ADDR IN CONVENIENT REG       63000021
RLDSECT  CLC   ALIGNH(2),2(RD)         CHECK FOR SAME ID                63100021
*        NOTE--RPOINTER WAS PUT IN ALIGNH AT XL5CONT                    63200021
         BC    8,XL4                 YES  SKIP THIS ONE                 63300021
        MVC   38(8,RST),0(RPLACE)     MOVE IN SECTION NAME              63400021
         TM    SAVATS,OVERBIT     TEST FOR OVERLAY                      63500021
         BC    8,MAP0119             OMIT SEGMENT NUMBER                63600021
         SR    RPAR,RPAR             CLEAR PARAMETER REG                63700021
         IC    RPAR,12(RPLACE)       INSERT SEG NO                      63800021
         CVD   RPAR,COLLECT-1        CONVERT TO DECIMAL                 63900021
         UNPK  COLLECT(5),COLLECT+5(3) UNPACK QUANTITY                  64000021
         MVC   53(3,RST),COLLECT       MOVE INTO PRINT LINE             64100021
         CLI   53(RST),C'0'            CHECK FOR LEADING ZERO           64200021
         BC    7,MAP0119               NO                               64300021
         MVI   53(RST),C' '            YES--MOVE IN BLANK               64400021
         CLI   54(RST),C'0'            CHECK FOR LEADING ZERO           64500021
         BC    7,MAP0119             NO  CONTINUE                       64600021
         MVI   54(RST),C' '            MOVE IN BLANK                    64700021
MAP0119  LA    R15,PUTLINS           LOAD ADDRESS OF PRINT ROUTINE      64800021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   64900021
*                                                                       65000021
*        CODING FOR MULTIPLE RLD ENTRIES                                65100021
*                                                                       65200021
XL2      TM    4(RD),X'01'           TEST FOR ANOTHER ADDR              65300021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   65400021
*                                                                       65500021
MAP012   EQU   XL2                   LOOP FOR SAME R AND P POINTERS     65600021
*                                                                       65700021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   65800021
         BC    8,XGETNXT             NO                                 65900021
         MVC   SVAR1(34),22(RST)       SAVE DATA FROM POINTERS          66000021
         LA    R14,PRLIN                                                66100021
         TM    APTSWS,TSO          TSO MODE?                            66200021
         BC    1,MAP0122           YES - BRANCH                         66300021
         CR    R14,RST                 IS LINE FULL                     66400021
         BC    7,MAP0122               YES--GO PRINT                    66500021
         LA    RST,60(0,RST)           NO--SET TO SECOND HALF OF LINE   66600021
         B     MAP0123                                                  66700021
MAP0122  BALR  R14,R15                 TO PRINT ROUTINE                 66800021
         LA    RST,PRLIN               SET RST TO FIRST OF LINE         66900021
MAP0123  SR    RD,RA                   ADD 4 TO POINTER                 67000021
         MVC   22(34,RST),SVAR1        RESTORE DATA                     67100021
         L     RPAR,4(0,RD)          LOAD ADDRESS FOR CONVERSION        67200021
         TM    NEWSW,X'40'             IS ENTRY FROM INTERMEDIATE       67300021
         BC    8,MAP0125               NO                               67400021
         A     RPAR,SAVAD              YES--ADD ASSIGNED ADDRESS        67500021
MAP0125  BAL   R14,BINBCDS             CALL CONVERSION SUBROUTINE       67600021
         MVC   4(6,RST),COLLECT        MOVE IN NEW ADDRESS              67700021
         LA    R15,PUTLINS           LOAD ADDR FO PRINT SUBR            67800021
         BXH   RC,RA,XL2             LOOP & DECR COUNT                  67900021
         B     RLDOUTA                 EXIT                             68000021
*                                                                       68100021
*        END FO CODING FOR MULTIPLE ENTRIES                             68200021
*                                                                       68300021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   68400021
XGETNXT  LA    R14,PRLIN                                                68500021
         TM    APTSWS,TSO          TSO MODE?                            68600021
         BC    1,MAP0124           YES - BRANCH                         68700021
        CR    R14,RST                 IS LINE FULL                      68800021
        BC    7,MAP0124               YES--GO PRINT                     68900021
         LA    RST,60(0,RST)          SET RST TO SECOND HALF OF LINE    69000021
        B     XGETNXT2                                                  69100021
MAP0124  BALR  R14,R15                 TO PRINT ROUTINE                 69200021
         LA    RST,PRLIN               SET RST TO FIRST OF PRINT LINE   69300021
XGETNXT2 AR    RC,RA                   SUBTRACT 4 FROM COUNT            69400021
RLDOUT   LA    RD,8(0,RD)            ADD 8 TO POINTER                   69500021
         BXH   RC,RA,XL3             GET NEXT RLD IF ANY                69600021
RLDOUTA  TM    NEWSW,X'40'             IS ENTRY FROM INTERMEDIATE       69700021
         BC    1,MAP0091               YES--BYPASS READ                 69800021
        TM    RLDIN,X'09'             TEST FOR EOMOD OR TXT NEXT        69900021
         BC    8,XL1                 THERE IS SUCH A CARD               70000021
         TM    RLDIN,EOMOD           TEST FOR END OF MOD                70100021
         BC    3,XRRET               YES                                70200021
         L     RD,DCBLMOD                                               70300021
         READ  DECB5,SF,(RD),RLDIN,1    SKIP OVER TEXT RECORD           70400021
         CHECK DECB5                                                    70500021
         B     XL1                   EXIT RLD RTN                       70600021
UNRES    MVC   37(11,RST),UNRESOLV     MOVE IN '$UNRESOLVED'            70700021
         CLI   13(RPLACE),NEVCALL    TEST FOR NEVER CALL                70800021
         BC    7,MAP0119             NO  LEAVE UNRESOLVED               70900021
         MVC   37(11,RST),NEVERCAL     MOVE IN '$NEVER-CALL'            71000021
         B     MAP0119               RETURN TO MAIN LINE                71100021
WXT   MVC   37(14,RST),UNRESOLV                                         71200021
      B   MAP0119                                                       71300021
RLDIN    DS    64F                   RLD READ INTO HERE                 71400021
UNRESOLV  DC C'$UNRESOLVED(W)'                                          71500021
NEVERCAL DC    C'$NEVER-CALL'        NEVER CALL DESIGNATOR              71600021
SVAR1    DS    34C                   SAVE AREA                          71700021
CRHEAD   DC    C'LOCATION  REFERS TO SYMBOL  IN'                        71800021
CUMREQ   DC    C'LOCATION        REQUESTS CUMULAT'                      71900021
         DC    C'IVE PSEUDO REGISTER LENGTH'                            72000021
CUMLEN   EQU   CUMREQ+9              LOC OF ADDRESS                     72100021
         EJECT                                                          72200021
*                                                                       72300021
*        THIS ROUTINE ENDS THE MAP                                      72400021
*                                                                       72500021
CLEANUP  SR    RPLACE,RPLACE         ZERO REG CTR REGISTER              72600021
         MVC   PRHDR+2(117),PRHDR+1  PREVENT LAST HEADER FROM PRINTIN   72700021
         MVC   PRLIN+2(30),PRLIN+1   BLANK OUT POSS INTERNAL REF        72800021
         C     RPLACE,PRAL        TEST FOR NO PSEUDO REGISTERS          72900021
         BC    8,ENTOT1              NONE  OMIT PROCESSING              73000021
         L     RC,SAVEND             LOAD POINTER TO LAST ESD           73100021
         LA    RC-1,16               LOAD INDEXING FACTOR               73200021
         L     RST2,XCESDTAB         LOAD ADDR OF ESD TABLE             73300021
*                                                                       73400021
*        LIST PSEUDO REGISTERS                                          73500021
*                                                                       73600021
         MVC   PRLIN+20(100),PRLIN+19  BLANK OUT ERSIDUE                73700021
         MVC   PRLIN+2(16),PSEUDOS                                      73800021
         MVI   PRLIN,DOUBLE            PRINT AND DOUBLE SPACE           73900021
         LA    R15,PUTLINS           PRINT SUBROUTINE                   74000021
         BALR  R14,R15               CALL SUBROUTINE                    74100021
         MVC   PRLIN+5(22),NAMOLEN   CREATE HEADER                      74200021
         MVC   PRLIN+35(22),NAMOLEN                                     74300021
         TM    APTSWS,TSO          TSO MODE?                            74400021
         BC    1,TEMP3             YES - BRANCH                         74500021
         MVC   PRLIN+65(22),NAMOLEN                                     74600021
         MVC   PRLIN+95(22),NAMOLEN                                     74700021
TEMP3    MVI   PRLIN,TRIPLE        PRINT AND TRIPLE SPACE               74800021
         MVC   PRHDR(119),PRLIN                                         74900021
         BALR  R14,R15               CALL SUBROUTINE                    75000021
L7       TM    8(RST2),X'06'         TEST FOR PSEUDO                    75100021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   75200021
*                                                                       75300021
MAP013   EQU   L7                    LOOP TO PROCESS PSEUDO REGS        75400021
*                                                                       75500021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   75600021
         BC    12,L7CTL              NO                                 75700021
         TM    8(RST2),X'01'         TEST FOR PSEUDO                    75800021
         BC    3,L7CTL               NO  GO TO NEXT ESD ENTRY           75900021
ONEFND   CH    RPLACE,COUNT2       LINE FULL?                           76000021
         BC    7,L7CONT              NO                                 76100021
         SR    RPLACE,RPLACE         REZERO POINTER                     76200021
         LA    R15,PUTLINS           SUBR TO PUT 1 LINE                 76300021
         BALR  R14,R15               CALL SUBROUTINE                    76400021
L7CONT   LR    RWORK,RPLACE          FORM ACTUAL PRINT ADDR             76500021
         LA    RWORK,PRLIN(RWORK)                                       76600021
         L     RPAR,8(0,RST2)        LOAD ADDDRESS FOR CONVERSION       76700021
         LA    R15,BINBCDS           CONVERT SUBR                       76800021
         BALR  R14,R15               CALL SUBROUTINE                    76900021
         MVC   3(8,RWORK),0(RST2)    MOVE IN NAME                       77000021
         MVC   13(6,RWORK),COLLECT   MOVE IN LOC                        77100021
         L     RPAR,12(0,RST2)       LOAD ADDRESS FOR CONVERSION        77200021
         BALR  R14,R15               CALL SUBROUTINE                    77300021
         MVC   21(6,RWORK),COLLECT   MOVE TO PRINT LINE                 77400021
         LA    RPLACE,30(0,RPLACE)   ADD TO COUNTER                     77500021
L7CTL    BXLE  RST2,RC-1,L7          LOOP TO NEXT ESD TIL LAST          77600021
         LTR   RPLACE,RPLACE         TEST FOR NO PSEUDO REGS            77700021
         BC    8,ENTOT               BRANCH AROUND PUT                  77800021
         LA    R15,PUTLINS           SUBR TO PRINT LINE                 77900021
         MVI   PRLIN,DOUBLE            PRINT AND DOUBLE SPACE           78000021
         BALR  R14,R15               CALL SUBROUTINE                    78100021
*                                                                       78200021
*        PUT OUT ENTRY ADDRESS AND TOTAL LENGTH                         78300021
*                                                                       78400021
ENTOT    L     RPAR,PRAL          LOAD PSEUDO LENGTH                    78500021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   78600021
*                                                                       78700021
MAP014   EQU   ENTOT                 ROUTINE FOR LENGTH OF PSEUDOS      78800021
*                                                                       78900021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   79000021
         MVC   PRHDR+2(117),PRHDR+1  BLANK OUT PRINT HEADER             79100021
         BAL   R14,BINBCDS           CALL CONVERSION SUBROUTINE         79200021
         MVC   PRLIN+2(32),CUMPS     PUT IN INDICATOR                   79300021
         MVC   PRLIN+36(6),COLLECT   MOVE IN QUANTITY                   79400021
         LA    R15,PUTLINS           SUBROUTINE TO PNINT LINE           79500021
         BALR  R14,R15               CALL SUBROUTINE                    79600021
ENTOT1   MVC   PRLIN+2(13),ENTADD    LOAD INDICATOR                     79700021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   79800021
*                                                                       79900021
HEWLFAPX EQU   ENTOT1                  ENTRY AFTER SYNAD EXIT           80000021
         ENTRY HEWLFAPX                                                 80100021
*                                                                       80200021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   80300021
         MVC   PRHDR+2(117),PRHDR+1  BLANK OUT PRINT HEADER             80400021
         MVC   WKWORD+1(3),PDSE11  MOVE ENTRY ADDRESS                   80500021
         L     RPAR,WKWORD           LOAD FULL WORD                     80600021
         TM    PDSE3,ALBIT         TEST FOR ALIAS                       80700021
         BC    8,MAP0153             NO  ENTRY ADDRESS CORRECT          80800021
         L     RPAR,IOCT           PICK UP RIGHT ENTRY ADDRESS          80900021
         SRL   RPAR,8                                                   81000021
MAP0153  EQU   *                                                        81100021
         BAL   R14,BINBCDS           CALL CONVERSION SUBROUTINE         81200021
         MVC   PRLIN+18(6),COLLECT   STORE NUMBER                       81300021
         LA    R15,PUTLINS           PRINT LINE                         81400021
         BALR  R14,R15               CALL SUBROUTINE                    81500021
         MVC   PRLIN+2(12),TOTLEN    LOAD TITLE                         81600021
         MVC   WKWORD+1(3),PDSE9   LOAD TOTAL LENGTH IN FULL WORD       81700021
         L     R1,WKWORD             LOAD IN FOLL WORD                  81800021
         BAL   R14,BINBCDS           CALL CONVERSION SUBROUTINE         81900021
         MVC   PRLIN+18(6),COLLECT   STORE NUMBER                       82000021
         MVI   PRLIN,DOUBLE            PRINT AND DOUBLE SPACE           82100021
         LA    R15,PUTLINS           PRINT LINE                         82200021
         BALR  R14,R15               CALL SUBROUTINE                    82300021
         MVI   L2SW+1,X'70'          RESET SWITCHES                     82400021
         MVI   L1SW+1,X'00'                                             82500021
         MVI   L5SW3+1,X'00'                                            82600021
         MVI   L5SW2+1,X'30'                                            82700021
         TM    NEWSW,X'40'             IS ENTRY FROM INTERMEDIATE       82800021
         BC    1,MAP0154               YES--BYPASS FREEMAIN AND CLOSE   82900021
         L     RA,DCBLMOD                                               83000021
         MVC   33(3,RA),SAVEODAD     RESTORE END OF DATA ADDRESS        83100021
         CLOSE ((RA))                                                   83200021
         TM    JFCBADDR,X'80'          WAS OPEN J REQUIRED              83300021
         BZ    MAP0154                 NO--BRANCH                       83400021
         FREEMAIN E,LV=200,A=JFCBADDR  FREE JFCB AREA                   83500021
MAP0154  MVC   SEGHD(8),SAVSEG         RESTORE SEG. NO. TO HDRS         83600021
         MVI   SEGNO+1,X'01'                                            83700021
         MVI   L0SW+1,X'00'                                             83800021
         MVC   LINECNT+1(1),LINCOUNT+1 RESTORE LINE COUNT TO APT        83900021
         NI    NEWSW,X'EF'             INDICATE MAP/XREF NOT OPERATING  84000021
         LM    R14,RBASE,SPACES+12                                      84100021
         BR    R14                     RETURN                           84200021
         DS    0F                                                       84300021
PSEUDOS  DC    C'PSEUDO REGISTERS'      HEADER FOR PSEUDO REGISTERS     84400021
NAMOLEN  DC    C'NAME    ORIGIN  LENGTH'  HEADER FOR PSEUDOS            84500021
CUMPS    DC    C'TOTAL LENGTH OF PSEUDO REGISTERS' LINE FOR OUT PUT     84600021
ENTADD   DC    C'ENTRY ADDRESS'                                         84700021
ENTRY    EQU   ENTADD                WORD ENTRY                         84800021
TOTLEN   DC    C'TOTAL LENGTH'                                          84900021
SAVSEG   DC    C'SEG. NO.'           FOR RESTORATION FO SEG. NO.        85000021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   85100021
         EJECT                                                          85200021
*                                                                       85300021
*        THIS SUBROUTINE TAKES A BINARY QUANTITY FROM RPAR              85400021
*        AND CONVERTS IT TO PRINT CHARACTERS TO THE BASE                85500021
*        INDICATED BY THE VARIABLE TEN.  THIS RESULT IS PLACED          85600021
*        IN THE SIX CHARACTER AREA COLLECT.  THE SUBROUTINE             85700021
*        RETURNS ON REGISTER R14.                                       85800021
*                                                                       85900021
BINBCDS  LA    RPAR,0(0,RPAR)        CLEAR HIGH ORDER BITS              86000021
         LTR   RPAR,RPAR             TEST FOR ZERO                      86100021
         BC    7,CVTCONT             NO                                 86200021
         MVC   COLLECT(6),ZERO       STORE ZERO INDICATOR               86300021
         BR    R14                   RETURN                             86400021
TEN      DC    A(16)                   DIVIDE CONSTANT                  86500021
ZERO     DC    C'    00'             ZERO INDICATOR                     86600021
CVTCONT  ST    RPAR,COLLECT-1        PLACE BINARY QUANT IN BUFFER       86700021
         UNPK  COLLECT(7),COLLECT(4)  UNPACK BINARY QUANTITY            86800021
         MVZ   COLLECT(6),COLLECT-1  ZERO ALL ZONES FOR TRANSLATE       86900021
         TR    COLLECT(6),TRTABLE    TRANSLATE FOR PRINTING             87000021
*                                                                       87100021
*        CHANGE LEADING ZEROS TO BLANKS                                 87200021
*                                                                       87300021
         LA    R0,1                  LOAD INCREMENT                     87400021
         LA    RPAR,COLLECT          LOAD START ADDRESS                 87500021
HIZEROS  CLI   0(RPAR),C'0'          TEST FOR ZERO                      87600021
         BCR   7,R14                 NO  DONE SO RETURN                 87700021
         MVI   0(RPAR),C' '          REPLACE ZERO WITH LEADING BLANK    87800021
         BXH   RPAR,R0,HIZEROS       INCR + LOOP TO NEXT DIGIT ALWAYS   87900021
BUFFER   DS    1D                    DOUBLE WORD AREA FOR CONVERSION    88000021
COLLECT  EQU   BUFFER+1              ADDRESS OF CONVERTED DATA          88100021
TRTABLE  DC    C'0123456789ABCDEF '  TABLE FOR TRANSLATION              88200021
         EJECT                                                          88300021
*                                                                       88400021
*        THIS SUBROUTINE PUTS OUT A LINE FROM PRLIN AND THEN            88500021
*        BLANKS IT OUT.                                                 88600021
*                                                                       88700021
         DS    0H                                                       88800021
PUTLINS  STM   RE,R15,PRSAV          SAVE REGISTERS                     88900021
SET4LINE LA    RE,PRLIN              SET FOR PRINT OF LINE              89000021
         TM    APTSWS,TSO          TSO MODE?                            89100021
         BC    1,PRINT             YES - BRANCH                         89200021
         LH    R15,LINCOUNT          LOAD LINE COUNT INTO REGISTER      89300021
         BCT   R15,CHKSNGL                                              89400021
         B     CHKHDR                  IF AT END OF PAGE                89500021
CHKSNGL  CLI   PRLIN,SINGLE            WAS SINGLE SPACE REQUESTED       89600021
         BE    NOPAGE                  YES--GO PRINT                    89700021
         BCT   R15,CHKDBL              NO--DECREMENT COUNT AGAIN        89800021
         B     CHKHDR                  IF AT END OF PAGE                89900021
CHKDBL   CLI   PRLIN,DOUBLE            WAS DOUBLE SPACE REQUESTED       90000021
         BE    NOPAGE                  YES--GO PRINT                    90100021
         BCT   R15,NOPAGE              NO--MUST BE TRIPLE--DECREMENT    90200021
CHKHDR   CLC   PRLIN+1(118),PRHDR+1    IS THIS LINE HEADER              90300021
         BE    HEADPNT                 YES--DON'T PRINT TWICE           90400021
         LA    RE,PRHDR                SET TO PRINT HEADER              90500021
HEADPNT  MVI   LINCOUNT+1,NUMBLINS     RESET LINE COUNTER               90600021
         L     R15,HEWLCWBB+20         ADDRESS OF PRINT BUFFER          90700021
         MVI   0(R15),RESTORE          INSERT CONTROL CH FOR RESTORE    90800021
         L     R15,PRNTAD              ADDRESS OF PRINT ROUTINE         90900021
         BALR  R14,R15                                                  91000021
         B     PRINT                 GO TO PRINT                        91100021
NOPAGE   STC   R15,LINCOUNT+1        STORE UPDATED LINE COUNT           91200021
         CLI   LINCOUNT+1,X'02'      TEST FOR BOTTOM OF PAGE            91300021
         BC    3,PRINT               NO  GO AHEAD AND PRINT             91400021
         CLC   PRLIN+1(118),PRHDR+1  TEST FOR HEADER                    91500021
         BE    HEADPNT                 NO DOUBLE HEAD PRINT             91600021
PRINT    L     RC,HEWLCWBB+20      ADDRESS OF PRINT BUFFER              91700021
         MVC   0(121,RC),0(RE)         MOVE MESSAGE TO PRINT BUFFER     91800021
         L     R15,PRNTAD              ADDRESS OF PRINT ROUTINE         91900021
         BALR  R14,R15                                                  92000021
         TM    APTSWS,TSO          TSO MODE?                            92100021
         BC    1,PREXIT            YES - BRANCH                         92200021
         LA    R15,PRHDR             LOAD FOR TEST FOR HEADER           92300021
         CR    R15,RE                TEST FOR HEADER LAST               92400021
         BE    SET4LINE              YES  PUT OUT PROPER LINE           92500021
PREXIT   LM    RE,R15,PRSAV          NO  RESTORE REGISTERS              92600021
         MVI   PRLIN,SINGLE          SET PRLIN BUFFER TO SINGLE SPACE   92700021
         MVC   PRLIN+2(118),PRLIN+1  BLANK OUT PRINT LINE               92800021
         BR    R14                   EXIT                               92900021
*                                                                       93000021
*        THIS SUBROUTINE PERFORMS IMMEDIATE SKIP OPERATIONS, USING      93100021
*        THE CARRIAGE COTNROL CHARACTER FROM LOCATION CNTLCH            93200021
*                                                                       93300021
CNTRL    ST    R14,SAV14               SAVE R14                         93400021
         TM    APTSWS,TSO          TSO MODE?                            93500021
         BC    1,CNTRLB            YES - BRANCH                         93600021
         LH    R15,LINCOUNT                                             93700021
         BCT   R15,CNTRLA              DECREMENT LINE COUNT             93800021
         B     NEWPAGE                 IF AT END OF PAGE                93900021
CNTRLA   CLI   CNTLCH,SKIP             WAS SKIP ONE REQUESTED           94000021
         BE    CNTRLB                  YES                              94100021
         BCT   R15,CNTRLB              NO--DECREMENT LINE COUNT AGAIN   94200021
NEWPAGE  MVI   LINCOUNT+1,X'01'        INDICATE END OF PAGE             94300021
         BR    R14                     AND RETURN                       94400021
CNTRLB   STH   R15,LINCOUNT            STORE UPDATED LINE COUNT         94500021
         L     R15,HEWLCWBB+20         ADDRESS OF PRINT BUFFER          94600021
         MVC   0(1,R15),CNTLCH         MOVE IN CONTROL CHARACTER        94700021
         L     R15,PRNTAD              ADDRESS OF PRINT ROUTINE         94800021
         BALR  R14,R15                                                  94900021
         L     R14,SAV14               RESTORE R14                      95000021
         BR    R14                     RETURN                           95100021
SAV14    DC    F'0'                                                     95200021
CNTLCH   DC    AL1(SKIP)                                                95300021
         DS    0F                                                       95400021
PRSAV    DS    6F                    SAVE AREA                          95500021
RPARSAV  EQU   PRSAV+8               SAVE R1 IN SORT OVER BASE SAVE     95600021
NUMBLINS EQU   53                    NUMBER OF LINES ON PAGE AFTER 1ST  95700021
LINCOUNT DC    AL2(54)               COUNTER OF LINES ON A PAGE         95800021
PRHDR    DC    AL1(DOUBLE)             CONTROL CH PRINT AND SPACE 2     95900021
         DC    4C'                              '                       96000021
PRLIN    DC    AL1(SINGLE)             CONTROL CH PRINT AND SPACE       96100021
         DC    4C'                              '  BUFFER               96200021
PRNTAD   DC    V(HEWLEPNT)             ADDRESS OF PRINT ROUTINE         96300021
JFCBADDR DC    F'00'                   ADDR OF JFCB AREA                96400021
XLSTADDR DC    A(APTXLIST)             ADDR OF SYSLMOD EXIT LIST        96500021
         EJECT                                                          96600021
*                                                                       96700021
*        THIS SUBROUTINE TAKES AN ANTRY NUMBER FROM RPAR                96800021
*        AND RETURNS THE ADDRESS OF THAT ENTRY IN R15                   96900021
*        AND ITS SEGMENT NUMBER IN RPAR                                 97000021
*                                                                       97100021
SEGSUBR  SLL   RPAR,4                MULT BY 16                         97200021
         L     R15,XCESDTAB          LOAD ADDRESS OF ESD TABLE          97300021
         AR    R15,RPAR              ADD PARAMETER                      97400021
         S     R15,TEN               AND SUBTRACT SIXTEEN               97500021
         SR    RPAR,RPAR             CLEAR REG                          97600021
         IC    RPAR,12(0,R15)        INSERT SEG NUMBER                  97700021
         BR    R14                   RETURN                             97800021
*                                                                       97900021
         HEWAPT                                                         98000021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   98100021
         END                                                            98200021
