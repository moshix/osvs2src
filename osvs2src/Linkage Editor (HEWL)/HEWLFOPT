         TITLE    'HEWLFOPT  ATTRIBUTES AND OPTIONS PROCESSOR'          00050021
*                                                                     * 00100021
*********************************************************************** 00150021
*                                                                     * 00200021
*                                                                     * 00250021
* STATUS -  CHANGE LEVEL  000                                         * 00300021
*                                                                     * 00350021
* FUNCTION/OPERATION -   THIS ROUTINE SCANS & ANALYZES THE ATTRIBUTES * 00400021
* & OPTIONS CONTROL INFORMATION WHICH IS PASSED TO IT INDIRECTLY      * 00450021
* FROM THE PARAMETER LIST.                                            * 00500021
*                                                                     * 00550021
*     THIS PARAMETER INFORMATION INDICATES WHAT MODULE ATTRIBUTES     * 00600021
*  AND  L/E.  PROCESSING OPTIONS ARE TO BE USED IN GENERATING THE     * 00650021
*  TYPE OF LOAD MODULE DESIRED. THE INFORMATION IS BASED ON THE       * 00700021
*  PARAMETERS  SPECIFIED IN THE  'EXEC' CONTROL CARD BY THE           * 00750021
*  PROGRAMMER USER, OR THOSE PASSED BY A LINK, XCTL, OR ATTACH MACRO  * 00800021
*   FROM ANOTHER PROGRAM.                                             * 00850021
*                                                                     * 00900021
*  THESE OPTIONS & ATTRIBUTES ARE CHECKED FOR VALIDITY & ARE ALSO     * 00950021
*  ANALYZED  TO   DETERMINE IF THEY ARE REQUESTED IN COMBINATIONS     * 01000021
* WHICH  ARE  ALLOWABLE. THE RESULTS OF THIS PROCESSING ARE THEN      * 01050021
* INDICATED BY  -                                                       01100021
*                                                                     * 01150021
*  1.- THE SETTING OF INTERNAL INDICATORS IN THE ALL PURPOSE TABLE    * 01200021
*  2.- PRINTED MESSAGES INDICATING WHAT ATTRIBUTES/OPTIONS  WERE      * 01250021
*  SPECIFIED & WHETHER OR NOT THEY  WERE VALID & ACCEPTED.            * 01300021
*                                                                     * 01350021
*  THIS ROUTINE HAS A CHARACTER CODE DEPENDENCE                       * 01400021
*       THE HEXADECIMAL REPRESENTATION OF A ZERO                      * 01450021
*            IS EXPECTED TO BE  F0                                    * 01500021
*       THE ZONE OF ANY DIGIT IS EXPECTED TO BE  F                    * 01550021
*                                                                     * 01600021
*                                                                     * 01650021
*  ENTRY POINTS -                                                     * 01700021
*                                                                     * 01750021
*   (1)  HEWLFOPT = MODULE NAME                                       * 01800021
*                                                                     * 01850021
* ENTERED FROM INITIAL PROCESSOR - BY  THIS'CALLING  SEQUENCE '-      * 01900021
*                                                                     * 01950021
*       L  1,       ADDRESS OF PARAMETER LIST BYTE  COUNT             * 02000021
*       L  15,      HEWLFOPT = ENTRY POINT                            * 02050021
*       BALR 14,15  LINKAGE                                           * 02100021
*                                                                     * 02150021
* ENTERED FORM SCN -'BY THIS CALLING SEQUENCE'                        * 02200021
*  L RA = LENGTH OF PARMS ON THE PARM CARD.                           * 02250021
*  L RB = ADDRESS OF THE PARMS IN THE SYSLIN BUFFER.                  * 02300021
* L RF = ADDRESS OF HEWLFOPT (ENTRY POINT).                           * 02350021
* BALR RE,RF                                                          * 02400021
*                                                                     * 02450021
*                                                                     * 02500021
*                                                                     * 02550021
*  INPUT -                                                            * 02600021
*                                                                     * 02650021
*        THE PARAMETER LIST ADDRESS IS PASSED  IN REG. NO.1  WHICH IS * 02700021
* USED TO OBTAIN A  BYTE COUNT & ASSOCIATED PARAMETER INFORMATION.    * 02750021
*                                                                     * 02800021
*                                                                     * 02850021
*      THE FOLLOWING  ARE COMPLETE LISTS  OF  THE  'ATTRIBUTE   AND   * 02900021
*  OPTION ' SYMBOLS  WHICH ARE AVAILABLE  FOR  USE, AND  THEY WILL    * 02950021
*  DETERMINE THE CHARACTERISTICS OF THE LOAD  MODULE TO BE CREATED.     03000021
*                                                                     * 03050021
*      (A)       - MODULE  ATTRIBUTES -                               * 03100021
*                                                                     * 03150021
* 1.- SCTR =  FORMAT OF MODULE IS SUITABLE FOR EITHER SCATTER OR      * 03200021
*             BLOCK LOADING.                                          * 03250021
*                                                                     * 03300021
* 2.- OVLY =  MODULE STRUCTURED IN OVERLAY.                           * 03350021
*                                                                     * 03400021
* 3.- HIAR = MODULE TO BE LOADED INTO SELECTED STORAGE HIERARCHIES.   * 03450021
*                                                                     * 03500021
* 4.- RENT = MODULE IS RE-ENTERABLE                                   * 03550021
*                                                                     * 03600021
* 5.- REUS = MODULE IS SERIALLY  RE-USABLE                            * 03650021
*                                                                     * 03700021
* 6.- REFR = MODULE IS REFRESHABLE                                    * 03750021
*                                                                     * 03800021
* 7.- TEST = MODULE CONTAINS TESTING SYMBOL TABLES FOR USE BY THE     * 03850021
*            TEST TRANSLATOR                                          * 03900021
*                                                                     * 03950021
*                                                                     * 04000021
*      (B) -  PROCESSING  OPTIONS -                                   * 04050021
*                                                                     * 04100021
*                                                                     * 04150021
*  1.-  NCAL  =     NO  AUTOMATIC  LIBRARY  CALL .                    * 04200021
*                                                                     * 04250021
*  2.-  LET   =    LOAD MODULE IS MARKED EXECUTABLE - ALLOWING MINOR  * 04300021
*                  ERROR  CONDITIONS DETECTED  DURING PROCESSING.     * 04350021
*                                                                     * 04400021
*  3.- XCAL   =    ALLOWS 'EXCLUSIVE BRANCH'  TYPE ERRORS , ONLY.     * 04450021
*                                                                     * 04500021
*  4.- LIST   =   OUTPUTS LISTING OF ALL L/E. CONTROL  STATEMENTS.    * 04550021
*                  IN CARD - IMAGE FORMATS.                           * 04600021
*                                                                     * 04650021
*  5.- MAP    =   PRODUCES A MAP  OF THE LOAD MODULE'S STRUCTURE.     * 04700021
*                                                                     * 04750021
*  6.- XREF   =  PRODUCES A CROSS - REFERENCE TABLE OF THE            * 04800021
*                 MODULE WHICH ALSO INCLUDES A MAP.                   * 04850021
*                                                                     * 04900021
*                                                                     * 04950021
* 7.- PRINT  = WRITE HEADERS, ALLOW XREF,MAP,LIST IF SPECIFIED.       * 05000021
* 8.-NOPRINT =  PRINT ONLY ERRORS.                                    * 05050021
* 9.-NOXREF  =  DO NOT PERFORM AN XREF LISTING FOR THIS MODULE.       * 05100021
*10.- NOCALL =  DO NOT PERFORM AUTOMATIC CALL FOR UNRESOLVED ERS.     * 05150021
*11.- CALL   =  PERFORM AUTOMATIC CALL ON SYSLIB FOR UNRESOLVED ERS.  * 05200021
*12.- NORENT =  DO NOT MARK THIS MODULE AS RE-ENTRANT.                * 05250021
*13.- NOREUS =  DO NOT MARK THIS MODULE AS RE-USEABLE.                * 05300021
*14.- TERM   =  THE TERMINAL IS BEING SUPPORTED.                      * 05350021
*15.- NOTERM = THE TERMINAL  IS NOT BEING SUPPORTED FOR THIS RUN.     * 05400021
*                                                                     * 05450021
*  * SPECIAL OPTIONS -                                                * 05500021
*                                                                     * 05550021
*  1. - DC    =  'DOWNWARD COMPATIBILTY' - MEANS THIS MODULE IS       * 05600021
*                 ACCEPTABLE AS INPUT  TO ALL LEVELS OF LINKAGE       * 05650021
*                 EDITORS.                                            * 05700021
*                                                                     * 05750021
* 2. -  OL    = ' ONLY LOADABLE '- INDICATOR IS SET - ON.             * 05800021
*                                                                     * 05850021
* 3. -  NE    = ' NOT EDITABLE ' -MEANS  THAT  THE ' ESD ' INFORMATION* 05900021
*                IS ELIMINATED  AND THEREFORE THIS MODULE WILL  NOT   * 05950021
*                BE ACCEPTED  BY  LINKAGE EDITOR FOR RE-PROCESSING.   * 06000021
*                                                                     * 06050021
* 4.- SIZE = OPTION PERMITTING SPECIFICATION OF                         06100021
*                 A) MAXIMUM NUMBER BYTES OF MAIN  STORAGE AVAILABLE    06150021
*                   TO THE LINKAGE EDITOR  (VALUE1)                     06200021
*                   WHERE VALUE1=(DESIGN PT X 1024) TO 9999999          06250021
*                              OR (DP K) TO 9999K                       06300021
*                 B) SIZE OF LOAD MODULE BUFFER (VALUE2)                06350021
*                   WHERE VALUE2= 6144 TO 102400                        06400021
*                              OR 6K TO 100K                            06450021
*                                                                       06500021
*                 THE FOLLOWING FORMATS ARE ACCEPTED:                 * 06550021
*                               SIZE=VALUE1                           * 06600021
*                                 SIZE=(VALUE1)                       * 06650021
*                                   SIZE=(,VALUE2)                    * 06700021
*                                     SIZE=(VALUE1,VALUE2)            * 06750021
*                                       SIZE=(,)                      * 06800021
*                 DEFAULT VALUES ARE SET DURING SYSTEM GENERATION     * 06850021
*                                                                     * 06900021
* 5.- ALIGN2 = OPTION SPECIFYING THAT 2K-PAGE BOUNDARY IS TO BE USED    06910021
*              WHERE PAGE ALIGNMENT IS REQUIRED. DEFAULT VALUE FOR      06920021
*              PAGE ALIGNMENT IS 4K.                                    06930021
*                                                                     * 06950021
*                                                                     * 07000021
*                                                                     * 07050021
*      THESE PARAMETERS MUST BE SPECIFIED IN CERTAIN VALID            * 07100021
*  COMBINATIONS (INDICATED IN TABLE) IN ORDER TO BE ACCEPTED FOR      * 07150021
*  ANY GIVEN LINKAGE EDITOR PROCESSING.                               * 07200021
*                                                                     * 07250021
* ** TABLE - COMBINATIONS OF  'INCOMPATIBLE' ATTRIBUTES & OPTIONS **  * 07300021
*---------------------------------------------------------------------* 07350021
*                                                                     * 07400021
* PARM. SPECIFIED  ***  COMBINATIONS - 'NOT ALLOWABLE ' WITH.         * 07450021
* ---------------        ------------------------------------         * 07500021
*                                                                     * 07550021
*   1.  SCTR       *    OVLY                                          * 07600021
*                                                                     * 07650021
*   2.  OVLY       *    SCTR,RENT, REUS, HIAR, REFR                   * 07700021
*                                                                     * 07750021
*   3.  HIAR       *    OVLY                                          * 07800021
*                                                                     * 07850021
*   4.  RENT       *    REUS, REFR, OVLY                              * 07900021
*                                                                     * 07950021
*   5.  REUS       *    RENT, REFR, OVLY                              * 08000021
*                                                                     * 08050021
*   7.  TEST       *    NE                                            * 08100021
*                                                                     * 08150021
*   6.  REFR       *    RENT, REUS, OVLY                              * 08200021
*                                                                     * 08250021
*   8.  LET        *    XCAL                                          * 08300021
*                                                                     * 08350021
*   9.  XCAL       *    LET                                           * 08400021
*                                                                     * 08450021
*   10. MAP        *    XREF, NE                                      * 08500021
*                                                                     * 08550021
*   11. XREF       *    MAP, NE                                       * 08600021
*                                                                     * 08650021
*   12. NE         *    MAP, XREF, TEST                               * 08700021
*                                                                     * 08750021
*   13. NCAL       *    -N/A-                                         * 08800021
*                                                                     * 08850021
*   14. LIST       *    -N/A-                                         * 08900021
*                                                                     * 08950021
*   15. OL         *    -N/A-                                         * 09000021
*                                                                     * 09050021
*   16. DC         *    -N/A-                                         * 09100021
*                                                                     * 09150021
*   17. SIZE       *    -N/A-                                         * 09200021
*                                                                     * 09250021
*---------------------------------------------------------------------* 09300021
*                                                                     * 09350021
*  OUTPUT -                                                           * 09400021
*                                                                     * 09450021
*        MESSAGES ARE PRINTED - OUT, TO INFORM  THE USER OF  WHAT -   * 09500021
*  LINKAGE EDITOR OPTIONS & ATTRIBUTES WERE PROCESSED & AS TO         * 09550021
*  WHETHER OR NOT THEY ARE VALID & COMPATIBLE.                        * 09600021
*                                                                     * 09650021
* IN THE CASE OF THE NOPRINT OPTION THE ONLY FORM OF OUTPUT ON SYSPRINT 09700021
* THAT SHALL OCCUR IS, THE PRINTING OF ERROR MEASAGES.                * 09750021
*                                                                     * 09850021
*   EXTERNAL  ROUTINES -      NONE                                    * 09900021
*                                                                     * 09950021
*  EXITS - NORMAL -                                                   * 10000021
*                                                                     * 10050021
*        AT THE COMPLETION OF PROCESSING ALL OPTIONS/ATTRIBUTES,      * 10100021
*  RETURN CONTROL IS TRANSFERED BACK  TO THE INITIALIZER (THAT IS TO  * 10150021
*  THE NEXT SEQUENTIAL INSTRUCTION, THE POINT AT WHICH EXIT  WAS      * 10200021
*  MADE  FROM  ' HEWLFINT ' MODULE).                                  * 10250021
*                                                                     * 10300021
*                                                                     * 10350021
*                                                                     * 10400021
*  EXITS - ERROR -  NONE                                              * 10450021
*                                                                     * 10500021
*  TABLES/WORK AREAS -  N/A.                                          * 10550021
*                                                                     * 10600021
*  ATTRIBUTES -  N/A.                                                 * 10650021
*                                                                     * 10700021
*  NOTES -  N/A.                                                      * 10750021
*                                                                     * 10800021
*                                                                     * 10850021
*********************************************************************** 10900021
*                                                                       10950021
*                                                                       11000021
HEWLFOPT CSECT                                                          11050021
**********************************************************************  11100021
*397600,413600                                                   S01904 11150021
*184600-700,266100-200,3011-302312,423700,433100-400             Y01048 11160000
*417500                                                           M4507 11170000
*A189100-189300                                                 OY00338 11180001
*C416500,C422500                                                 YM5557 11190001
*185500                                                         XA05449 11192003
**********************************************************************  11200021
         SPACE 1                                                        11250021
R0       EQU   0    PARAMATER  REGISTER                                 11300021
R1       EQU   1    PARAMATER  REGISTER                                 11350021
R2       EQU   2                                                        11400021
R3       EQU   3                                                        11450021
R4       EQU   4                                                        11500021
R5       EQU   5                                                        11550021
R6       EQU   6                                                        11600021
R7       EQU   7                                                        11650021
R8       EQU   8                                                        11700021
R9       EQU   9                                                        11750021
RA       EQU   10                                                       11800021
RB       EQU   11                                                       11850021
RC       EQU   12   BASE REGISTER                                       11900021
RD       EQU   13   SAVE AREA POINTER REGISTER                          11950021
RE       EQU   14   RETURN REGISTER                                     12000021
RF       EQU   15   GO TO REGISTER                                      12050021
 EJECT                                                                  12100021
PARMREG  EQU   1                                                        12150021
DISP8    EQU   8                                                        12200021
BYTES8   EQU   8                                                        12250021
CONCODE8 EQU   8                                                        12300021
DISP4    EQU   4                                                        12350021
DISP1    EQU   1                                                        12400021
DISP2    EQU   2                                                        12450021
BYTES1   EQU   1                                                        12500021
BYTES4   EQU   4                                                        12550021
BLANK    EQU   C' '                                                     12600021
K        EQU   C'K'                                                     12650021
COMMA    EQU   C','                                                     12700021
LPAREN   EQU   C'('                                                     12750021
RPAREN   EQU   C')'                                                     12800021
NULL     EQU   X'00'                                                    12850021
NOOVLY   EQU   X'BF'                                                    12900021
EQUAL    EQU   C'='                                                     12950021
SIZE     EQU   X'01'                                                    13000021
LPRENRCV EQU   X'02'                                                    13050021
RPRENRCV EQU   X'04'                                                    13100021
VAL1RCVD EQU   X'08'   VALUE1 RECIEVED OR ACCEPTED FOR DEFAULT          13150021
GENOPTST EQU   X'10'     INDICATES A GENERATED DEFAULT ACTIVATED        13200021
USEDEF   EQU   X'20'   ERROR ENCOUNTERED WHICH NEGATES USER VALUES DEF. 13250021
KFORM    EQU   X'40'                                                    13300021
INCOMPT  EQU   X'80'  INCOMPATABLE OPTIONS MESSAGE NECESSARY            13350021
NOXML    EQU   X'97' RST MASK TO TURN OFF XREF,MAP AND LIST FOR NOPRINT 13400021
SCNDTIME EQU   X'20'  MOTP ENTERED FOR THE SECOND TIME                  13450021
RESET    EQU   X'F0'   RESET MASK FOR SIZE SWITCHES                     13500021
NUMBER   EQU   X'F0'   MASK FOR CHECKING VALID NUMERICAL ZONES          13550021
RSTKFORM EQU   X'BF'   RESET MASK  FOR K FORM                           13600021
HIAR     EQU   X'04'                                                    13650021
NOHIAR   EQU   X'FB'                                                    13700021
SCTR     EQU   X'04'                                                    13750021
NOSCTR   EQU   X'FB'                                                    13800021
RENT     EQU   X'10'                                                    13850021
XREF     EQU   X'40'                                                    13900021
TEST     EQU   X'10'                                                    13950021
REFR     EQU   X'01'                                                    14000021
CALL     EQU   X'7F'                                                    14050021
NORNR    EQU   X'3F'                                                    14100021
RENTREUS EQU   X'C0'                                                    14150021
NOREFR   EQU   X'FE'                                                    14200021
MAP      EQU   X'20'                                                    14250021
NE       EQU   X'08'                                                    14300021
NONE     EQU   X'F7'                                                    14350021
NOMAP    EQU   X'DF'                                                    14400021
NOXREF   EQU   X'BF'                                                    14450021
NOLIST   EQU   X'F7'                                                    14500021
NOTERM   EQU   X'FD'                                                    14550021
NOTEST   EQU   X'EF'                                                    14600021
DCBS     EQU   X'10'                                                    14650021
TERM     EQU   X'02'                                                    14700021
OL       EQU   X'08'                                                    14750021
NCAL     EQU   X'80'                                                    14800021
XCAL     EQU   X'04'                                                    14850021
LET      EQU   X'10'                                                    14900021
REUS     EQU   X'40'                                                    14950021
LIST     EQU   X'08'                                                    15000021
DC       EQU   X'7F'                                                    15050021
OVLY     EQU   X'20'                                                    15100021
NORENT   EQU   X'7F'                                                    15150021
NOREUS   EQU   X'BF'                                                    15200021
TABLEEND EQU   X'FF'                                                    15250021
MULT1024 EQU   10                                                       15300021
NEWPAGE  EQU   X'19'                                                    15350021
 EJECT                                                                  15400021
         USING VRT,R6                                                   15450021
         USING APTDSECT,R2                                              15500021
         USING DEFDSECT,R1                                              15550021
         USING *,15                                                     15600021
         STM   RE,RD,SAVEA              SAVE REGISTERS                  15650021
         DROP 15                                                        15700021
         BALR  RC,R0                                                    15750021
         USING *,RC                                                     15800021
         BC    15,MOID+6                                                15850021
MOID     DC    C'01MOPT'                                                15900021
 EJECT                                                                  15950021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 16000021
*                                                                     * 16050021
*  THIS IS THE OPTION SCANNING ROUTINE . IT WILL CHECK THE PARM.      * 16100021
*   FIELD FOR VALID OPTIONS. INVALID OPTIONS AND VALID OPTIONS WILL   * 16150021
*    BE PLACED IN THE PRINT BUFFER TO BE PRINTED UPON RETURN TO INT.  * 16200021
*    PARMREG HAS POINTER TO 1ST BYTE OF THE PARAMATER FIELD PASSED ON * 16250021
*    THE EXEC CARD.                                                   * 16300021
* R6 ALWAYS POINTS TO A WORK AREA                                     * 16350021
* R2 ALWAYS POINTS TO APT                                             * 16400021
* R8 WHILE SCANNING FOR PARAMATERS HAS THE ADR OF NXT AVAIL POS IN    * 16450021
* PARAMATER MESSAGE TO PLACE THE PARAMATER                              16500021
*                                                                     * 16550021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 16600021
  SPACE 2                                                               16650021
         TM    APTSWS,SCNDTIME    SECOND TIME IN OPT                    16700021
         BZ    OPT01                                                    16750021
         L     R6,TXTIO           USE THE TXTIO TABLE FOR BUFFER        16800021
         MVI   NOTVLD,TABLEEND    DO NOT ACCEPT TABLE ALLOCATING PARMS. 16850021
         MVI   MESGNO1,NEWPAGE     ITERATIONS MUST BEGIN ON NEW PAGE    16900021
         B     OPT02                                                    16950021
 SPACE 1                                                                17000021
OPT01    LH    RA,0(0,PARMREG)     NO. OF BYTES PASSED IN THE LIST      17050021
         LA    RB,DISP2(0,PARMREG) ADDRESS OF THE FIRST BYTE            17100021
         SPACE 1                                                        17150021
         GETMAIN R,LV=274         ACQUIRE DYNAMIC WORK SPACE            17200021
         LR    R6,R1              PRIME DSCT REG                        17250021
         SPACE 1                                                        17300021
OPT02    MVI   INTERN1,NULL       CLEAR THE SWITCHES                    17350021
         XC    MSGONE(4),MSGONE                                         17400021
         XC    MSGTWO(4),MSGTWO                                         17450021
         XC    MSGTHREE(4),MSGTHREE                                     17500021
         LTR   RA,RA               IS LENGTH THAT WAS PASSED = 0        17550021
         BNP   NOTANY             NO PARAMATERS                         17600021
         MVI   TRTBUF,NULL        CLEAR FIRST BYTE                      17650021
         MVC   TRTBUF+BYTES1(255),TRTBUF CLR REST OF BUFFER             17700021
         SPACE 1                                                        17750021
         MVI   TRTBUF+COMMA,COMMA MOVE COMMA TO COMMA DISPLACEMENT      17800021
         MVI   TRTBUF+EQUAL,EQUAL MOVE EQUAL TO EQUAL DISPLACEMENT      17850021
         MVI   TRTBUF+LPAREN,LPAREN MOVE IN LEFT PARENTHESIS            17900021
         MVI   TRTBUF+RPAREN,RPAREN MOVE IN RIGHT PARENTHESIS           17950021
         MVI   TRTBUF+BLANK,BLANK MOVE IN A BLANK(MAKES PARMS FREE-FORM 18000021
         MVC   OPTIONS(76),BLK1 RESET THE LINE                          18050021
         MVC   GENDFLTS(20),BLK2    CLEAR THE LINE                      18100021
         LA    R8,OPTIONS         ADDRESS OF PLACE OPTIONS AREA         18150021
         L     R1,DEFADR          ADDRESS OF DEF                        18200021
SCANOPT  BCTR  RA,0                -1 FOR MACHINE LENGTH OF LIST        18250021
         LR    R0,R2               SAVE DSECT BASE                      18300021
         EX    RA,SCAN             SCAN FOR = OR                        18350021
         BNE   OPTFOUND            IF STOPPED CHECK FOR VALID OPTION    18400021
         LA    R9,DISP1(0,RA)     PRINE R 9 WITH TRUE LENGTH            18450021
         TM    INTERN1,APF        AM I SEARCHING                 Y01048 18460000
         BO    APFRTN60           FOR AUTHORIZATION CODE         Y01048 18470000
         TM    INTERN1,SIZE       WAS I IN THE SIZE SEARCH              18500021
         BO    OPT111             IF SO CONTINUE SIZE EXTRACTION        18550021
         LTR   R7,RA              TRANSFER THE LENGTH                   18600021
         BNM   LASTSCN            IF MORE THAN 0 CONTINUE SCAN  XA05449 18650003
OPTEXIT  BCTR  R8,0                -1 TO GET ADDRESS OF LAST COMMA      18700021
         CLI   0(R8),RPAREN       STOPPED LAST BY A )                   18750021
         BE    EXIT               IF SO DO NOT BLANK IT OUT             18800021
         MVI   0(R8),BLANK         BLANK OUT LAST COMMA                 18850021
EXIT     EQU   *                                                        18900021
         LA    R3,MESGNO1    POINT TO START OF TEXT             OY00338 18910001
         SR    R8,R3         CALC LENGTH OF TEXT                OY00338 18920001
         STC   R8,HEADRS     SAVE ACTUAL TEXT LENGTH            OY00338 18930001
 EJECT                                                                  18950021
*** TEST FOR ALLOWABLE OPTIONS                                          19000021
 SPACE 1                                                                19050021
         TM    NEWSW,HIAR         IS HIAR OPTION ON                     19100021
         BZ    OPT11B             NO PROCESS OTHER OPTIONS              19150021
         OI    PDSE7,SCTR         SET SCTR OPTION ON                    19200021
OPT11B   TM    APT0,XREF          IS XREF OPTION ON                     19250021
         BZ    OPT12              NO                                    19300021
         TM    APT0,MAP           IS MAP OPTION ON                      19350021
         BZ    OPT13              BRANCH IF NOT                         19400021
         NI    APT0,NOMAP         SET MAP OPTION OFF                    19450021
         B     OPT13                                                    19500021
OPT12    TM    APT0,MAP           IS THE MAP OPTION ON                  19550021
         BZ    OPT14              NO                                    19600021
OPT13    TM    PDSE8,NE           IS NE OPTION ON                       19650021
         BZ    OPT14              NO                                    19700021
         NI    PDSE8,NONE         SET NE OFF - WANTS MAP -              19750021
         OI    INTERN1,INCOMPT    INDICATE INCOMPATABLE OPTIONS         19800021
OPT14    TM    PDSE7,TEST         IS TEST ON                            19850021
         BZ    OPT16              NO                                    19900021
         TM    PDSE8,NE                IS NE ON                         19950021
         BZ    OPT16              NO CONTINUE                           20000021
         NI    PDSE8,NONE         CLEAR NE INDICATOR                    20050021
         OI    INTERN1,INCOMPT    INDICATE INCOMPATABLE OPTIONS         20100021
OPT16    TM    PDSE7,OVLY         IS OVERLAY OPTION ON                  20150021
         BZ    OPT26              EXIT                                  20200021
         TM    PDSE7,RENTREUS     IS RENT OR REUS ON                    20250021
         BNZ   OPT16B             YES -RESET OPTION -                   20300021
         TM    PDSE8,REFR         IS REFR ON                            20350021
         BZ    OPT16A             NO -TEST FOR SCTR-                    20400021
OPT16B   NI    PDSE8,NOREFR       CLEAR REFR                            20450021
         NI    PDSE7,NORNR        CLEAR REUS AND RENT                   20500021
         OI    INTERN1,INCOMPT    INDICATE INCOMPATABLE OPTIONS         20550021
OPT16A   TM    PDSE7,SCTR         IS SCTR ON                            20600021
         BZ    OPT26              EXIT                                  20650021
         NI    PDSE7,NOSCTR       CLEAR SCTR                            20700021
         NI    NEWSW,NOHIAR       CLEAR HIAR                            20750021
         OI    INTERN1,INCOMPT    INDICATE INCOMPATABLE OPTIONS         20800021
OPT26    EQU   *    ** END OF INCOMPATABLE OPTIONS SCAN **              20850021
 EJECT                                                                  20900021
***                                                                     20950021
*** THIS SECTION CHECKS IF USER SPECD VAL 1 OR 2                        21000021
*** DEFAULTS VALUES NOT SPECD DEFAULTS BOTH IF CONFLICT WITH DESIGN PT. 21050021
**                                                                      21100021
*** R3 = VALUE 1  0 IF SPECIFIED INCORRECTLY OR IF USER WANTS DEFAULT   21150021
*** R4 = VALUE 2  0 IF SPECIFIED INCORRECTLY OR IF USER WANTS DEFAULT   21200021
         SPACE 2                                                        21250021
         L     R1,DEFADR           ADDRESS OF HEWLFDEF                  21300021
         MVC   IDENT(BYTES4),DEFNAME DESIGN NAME OF EDITOR              21350021
         LM    R3,R4,VALUE1       USER(IF SPECD) R3=VALUE1,R4=VALUE2    21400021
         LM    R9,RB,DEFDSNPT DEFAULTS R9=DSNPT,RA=DEFVAL1,RB=DEFVAL2   21450021
  SPACE 1                                                               21500021
         TM    INTERN1,USEDEF     SIZE SPECD INCORRECTLY                21550021
         BO    OPT320             IF SO USE DEFAULTS                    21600021
         LTR   R3,R3               DID USER SPECIFY A VALID VALUE       21650021
         BP    OPT300                                                   21700021
         LR    R3,RA              GET DEFAULT VALUE 1                   21750021
         ST    RA,VALUE1          USE DEFAULT VALUE 1                   21800021
         OI    INTERN1,USEDEF     INDICATE DEFAULT(S) USED              21850021
         B     OPT330              CHECK VALUE2                         21900021
         SPACE 1                                                        21950021
OPT300   CR    R3,R9              IS VALUE 1 LT DSNPT                   22000021
         BNL   OPT330              NO CHECK VALUE 2                     22050021
OPT320   STM   RA,RB,VALUE1       USE DEFAULT VALUES 1 AND 2            22100021
         B     OPT380               DEF VALUES IN EXIT                  22150021
OPT330   LTR   R4,R4              DID USER SPEC. VALUE 2                22200021
         BNP   OPT350              USER WANTS DEFAULT VALUE 2           22250021
         CR    R3,R4              IS VALUE 2 GT VALUE 1                 22300021
         BL    OPT350              YES  ERROR                           22350021
         C     R4,MINVAL2         VALUE 2 LT MINIMUM                    22400021
         BL    OPT350              USE DEFAULT VALUE2                   22450021
         C     R4,MAXVAL2         DOES VALUE 2 EXCEED MAXIMUM           22500021
         BNH   OPT390              VALUE 2 ACCEPTABLE                   22550021
OPT350   ST    RB,VALUE2          USE DEFAULT VALUE 2                   22600021
         SPACE 1                                                        22650021
OPT380   OI    INTERN1,USEDEF      INDICATE VALUE DEFAULTED             22700021
 EJECT                                                                  22750021
***                                                                     22800021
*** THIS SECTION SETS UP A MESSAGE INDICATING THE VALUES USED AND       22850021
** WETHER THEY ARE DEFAULTS OR VARIABLE OPTIONS SPECIFIED BY THE USER,  22900021
***                                                                     22950021
 SPACE 2                                                                23000021
OPT390   LA    R8,VALUES          ADDRESS OF MESSAGE 1 VALUES USED SLOT 23050021
         L     R1,VALUE1          QUANTITY VALUE1                       23100021
         BAL   RE,OPT500          DELETE LEADING ZEROS - PLACE IN MSG   23150021
         MVI   0(R8),COMMA        INSERT THE COMMA SEPARATOR            23200021
         LA    R8,DISP1(0,R8)     BUMP POINTER TO NEXT BLANK            23250021
         L     R1,VALUE2          QUANTITY VALUE2                       23300021
         BAL   RE,OPT500          DELETE LEADING ZEROS - PLACE IN MSG   23350021
         MVI   0(R8),RPAREN       INSERT THE R PAREN TERMINATOR         23400021
         TM    INTERN1,USEDEF          DEFAULTS USED?                   23450021
         BZ    OPT510                  NO                               23500021
         MVC   DEFAULTM+10(17),DEFS    YES - MOVE IN DEFAULT            23550021
OPT510   EQU   *                                                        23600021
 SPACE 2                                                                23650021
***                                                                     23700021
***      THIS SECTION SETS UP THE MESSAGES RETURNED TO INT              23750021
***   THIS SECTION DELETS HEADER MESSAGES WHEN THE NO PRINT OPTION      23800021
*** HAS BEEN CODED IN THE PARAMATER FIELD.                              23850021
***                                                                     23900021
 SPACE 2                                                                23950021
         LM    R3,R5,HEADRS       LN AND ADR OF MESSAGES 1 AND 2        24000021
         STM   R3,R4,MSGONE       PS TO INT THROUGH APT                 24050021
OPT775   TM    INTERN1,INCOMPT    WERE THERE INCOMPATABLE OPTIONS       24100021
         BZ    OPT800             NO -DO NOT ISSUE MESSAGE -            24150021
         ST    R5,MSGTHREE        SAVE IN APT                           24200021
OPT800   EQU   *                                                        24250021
 EJECT                                                                  24300021
***                                                                     24350021
*** EPILOG                                                              24400021
***                                                                     24450021
 SPACE 1                                                                24500021
         TM    APTSWS,SCNDTIME    SECOND TIME IN OPT                    24550021
         BO    OPT999             DO NOT ISSUE THE FREE MAIN            24600021
         FREEMAIN R,LV=274,A=(6) FREE DYNAMIC WORK SPACE                24650021
 SPACE 2                                                                24700021
RETURN   LM    RE,RD,SAVEA                                              24750021
         BR    RE                       RETURN                          24800021
    SPACE 1                                                             24850021
*        THIS SECTION PRINTS THE HEADER MESSAGES AFTER A PARM CARD      24900021
*        HAS  BEEN ENCOUNTERED.  HEWLFINT PRINTS THE MESSAGES FROM      24950021
*        THE PARMS ON THE EXEC CARD.                                    25000021
*                                                                       25050021
OPT999   EQU   *                                                        25100021
         L     RF,=V(HEWLEPNT)    ADDRESS OF THE PRINT ROUTINE          25150021
         LA    R3,MSGONE               GET ADDRESS OF LENGTH AND ADD.   25200021
*                                      OF FIRST MESSAGE                 25250021
         LA    R5,MSGTHREE        PRIME END REG                         25300021
         LA    R4,4               INDEX                                 25350021
OPT997   L     R8,HEWLCWBB+20     ADDRESS OF SYSPRINT BUFFER            25400021
         SR    R9,R9                                                    25450021
         IC    R9,0(0,R3)              GET LENGTH OF THE MESSAGE        25500021
         LTR   R9,R9              IS IT ZERO                            25550021
         BZ    OPT998             NO PRINT SKIP                         25600021
         L     RB,0(0,R3)              PUT ADDRESS OF MESSAGE IN RB     25650021
         EX    R9,MVOPT2M         MOOE THE OPTION TO THE MESSAGE        25700021
         BALR  RE,RF              PRINT THE HEADER                      25750021
OPT998   BXLE  R3,R4,OPT997                                             25800021
         B     RETURN                                                   25850021
         EJECT                                                          25900021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 25950021
*                                                                     * 26000021
*RB  IS USED TO HOLD THE LAST(STOPPED AT) ADDRESS IN THE PARM FIELD   * 26050021
*RA  IS USED TO HOLD THE NUMBER OF BYTES OF OPTIONS LEFT IN PARM FIELD* 26100021
* R9 IS USED TO HOLD THE TRUE LENGTH OF AN OPTION FOR ADDRESS UPDATEING 26150021
* R7 IS USED TO HOLD MACHINE LENGTH OF OPTION FOR EX INSTRUCTIONS.    * 26200021
*                                                                     * 26250021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 26300021
         SPACE 2                                                        26350021
OPTFOUND STC   R2,FUNCBYTE         SAVE THE STOPPER BYTE.               26400021
         LR    R2,R0               RESTORE DSECT BASE.                  26450021
         LR    R7,R1               TIC CURRENT(STOPPED AT) ADDRESS.     26500021
         SR    R7,RB               LAST ADR-CUR ADR = LENGTH OF OPTION  26550021
         LR    R9,R7              TRANSFERR LENGTH TO R9                26600021
         TM    INTERN1,APF        AM I SEARCHING                 Y01048 26610000
         BO    APFRTN             FOR AUTHORIZATION CODE         Y01048 26620000
         TM    INTERN1,SIZE  AM I LOOKING FOR SIZE AFT(SIZE=)           26650021
         BZ    CHECKOPT            IF NOT DETERMINE IF VALID OPTION.    26700021
         MVI   TRTBUF+EQUAL,NULL DELETE = FROM TRT TABLE                26750021
* R7 CONTAINS TRUE LENGTH NOT MACH LENGTH BECAUSE (, MEANS DEFAULT      26800021
* THAT VALUE WHERE AS LIST,,, MEANS IGNORE AND WOULD NOT CAUSE VAL1 OR  26850021
* VAL2 RCVD SWITCH SETTING                                              26900021
         SPACE 1                                                        26950021
         TM    INTERN1,LPRENRCV    ( RECIEVED ?                         27000021
         BZ    OPT101              NO                                   27050021
         CLI   FUNCBYTE,COMMA      STOPPED BY COMMA                     27100021
         BE    OPT100              YES CHECK IF VAL1 RCVD YET           27150021
         CLI   FUNCBYTE,BLANK     STOPPED BY A BLANK                    27200021
         BE    OPT107             YES SKIP FREE FORM                    27250021
* AT THIS POINT HAD TO BE STOPPED BY A ) BECAUSE NO OTHERS ARE STOPPERS 27300021
         OI    INTERN1,RPRENRCV    SET ) RECIEVED                       27350021
         TM    INTERN1,VAL1RCVD    VALUE 1 RECIEVED YET                 27400021
         BO    OPT102              YES CHECK FOR VALUE 2 RECIEVED       27450021
         LA    RF,VALUE1          ADDRESS OF VALUE1                     27500021
         BAL   RE,MOVEVAL          CHANGE RADIX OF VALUE POINTED BY RB  27550021
         OI    INTERN1,VAL1RCVD   INDICATE VALUE 1 R*CIEVED             27600021
         B     OPT103                                                   27650021
         SPACE 1                                                        27700021
OPT101   CLI   FUNCBYTE,LPAREN     STOPPED BY (                         27750021
         BE    OPT104              YES CHECK LENGTH                     27800021
         CLI   FUNCBYTE,COMMA      STOPPED BY ,                         27850021
         BE    OPT105              YES                                  27900021
         CLI   FUNCBYTE,BLANK     STOPPED BY A BLANK                    27950021
         BE    OPT112             YES SKIP FREE FORM                    28000021
         CLI   FUNCBYTE,EQUAL     STOPPED BY EQUAL -FREE FORM -         28050021
         BE    OPT112             YES SKIP FREE FORM                    28100021
         B     SIZEINVL            -ERROR- POSSIBLE *SIZE=)*            28150021
         SPACE 1                                                        28200021
OPT104   OI    INTERN1,LPRENRCV   SET ( RECIEVED                        28250021
         B     OPT112                                                   28300021
         SPACE 1                                                        28350021
OPT100   TM    INTERN1,VAL1RCVD    VALUE 1 RECIEVED YET                 28400021
         BO    OPT102              YES CHECK IF VALUE 2 RECIEVED        28450021
         LA    RF,VALUE1          ADDRESS OF VALUE1                     28500021
         BAL   RE,MOVEVAL          CONVERT FROM RADIX 10 TO RADIX 2     28550021
         OI    INTERN1,VAL1RCVD    INDICATE VALUE 1 RECIEVED            28600021
         B     GOBY                CONTINUE                             28650021
         SPACE 1                                                        28700021
OPT102   LA    RF,VALUE2          ADDRESS OF VALUE2                     28750021
OPT106   BAL   RE,MOVEVAL         CONVERT FROM RADIX 10 TO RADIX 2      28800021
OPT103   NI    INTERN1,RESET       CLEAR SWITCHES USED FOR SIZE SRCH    28850021
         MVI   TRTBUF+EQUAL,EQUAL RESTORE = SIGN TO TRT TABLE           28900021
         B     GOBY                CONTINUE                             28950021
 SPACE 1                                                                29000021
OPT105   LA    RF,VALUE1          ADDRESS OF VALUE1                     29050021
         B     OPT106             END OF SCAN -SIZE=100K-               29100021
OPT107   TM    INTERN1,VAL1RCVD   VALUE 1 RECIEVED YET                  29150021
         BO    OPT108             YES                                   29200021
         LA    RF,VALUE1          ADDRESS OF VALUE1                     29250021
         BAL   RE,MOVEVAL                                               29300021
         B     GOBY                                                     29350021
 EJECT                                                                  29400021
OPT108   LA    RF,VALUE2          ADDRESS OF VALUE2                     29450021
         BAL   RE,MOVEVAL                                               29500021
         B     GOBY                                                     29550021
 SPACE 1                                                                29600021
OPT111   LR    R7,R9              LAST SCAN R7=R9                       29650021
         B     OPT100 CONTINUE                                          29700021
         SPACE 2                                                        29750021
SIZEINVL OI    INTERN1,USEDEF      SIZE SPEC. INVALIDLY                 29800021
* AT THIS POINT POSSIBLE TOGIVE MESSAGE                                 29850021
         B     INVALIDR                                                 29900021
         SPACE 1                                                        29950021
ZEROLN   LA    RB,DISP1(0,RB)      UPDATE LAST(STOPPED AT) ADDRESS.     30000021
         B     TSTCNT1                                                  30050021
         EJECT                                                          30100021
*                                                                Y01048 30110000
*        APFRTN-CHECK VALUE FOR AC=N, IF VALUE OKAY              Y01048 30120000
*               MOVE TO APT                                      Y01048 30130000
*                                                                Y01048 30140000
*        R1    WORK                                              Y01048 30142000
*        R2    BASE OF DSECT                                     Y01048 30144000
*        R4    WORK                                              Y01048 30146000
*        R5    WORK                                              Y01048 30148000
*        R7    MACHINE LENGTH OF VALUE                           Y01048 30148400
*        R9    REAL LENGTH OF VALUE                              Y01048 30148800
*        RA    NUM. OF BYTES LEFT IN PARM FIELD                  Y01048 30149200
*        RB    POINTS TO VALUE TO BE CONVERTED                   Y01048 30149600
APFRTN   DS    0H                                                Y01048 30149700
         LTR   R9,R7              LENGTH = 0?                    Y01048 30149800
         BNP   OPT112             YES - SKIP                     Y01048 30149900
         CLI   FUNCBYTE,COMMA     IS STOPPER A COMMA?            Y01048 30166600
         BE    APFRTN10           YES - OKAY                     Y01048 30176600
         CLI   FUNCBYTE,BLANK     IS STOPPER A BLANK?            Y01048 30178600
         BE    APFRTN10           YES - OKAY                     Y01048 30180600
         BCTR  R7,0               NO                             Y01048 30182600
         B     ACINVALD           ERROR                          Y01048 30183000
APFRTN10 EQU   *                                                 Y01048 30183100
         BCTR  R7,0               GET MACHINE LENGTH             Y01048 30183200
         LA    R3,8               MAX NUM DIGITS                 Y01048 30188800
         CR    R3,R9              ARE THERE TOO MANY?            Y01048 30190800
         BL    ACINVALD           YES - ERROR                    Y01048 30192800
         LA    R5,0(RB,R7)        LAST NUM IN STR                Y01048 30193200
         LR    R1,RB              FIRST NUM IN STR               Y01048 30193600
         LA    R4,1               INDEX                          Y01048 30194000
APFRTN30 EQU   *                                                 Y01048 30194100
         TM    0(R1),NUMBER       IS IT A DIGIT?                 Y01048 30194200
         BNO   ACINVALD           NO - ERROR                     Y01048 30194300
         BXLE  R1,R4,APFRTN30     SCAN ALL DIGITS                Y01048 30208200
         XC    WORK,WORK          CLEAR WORK                     Y01048 30218200
         EX    R7,PACK            PACK VALUE                     Y01048 30220200
         CVB   R1,WORK            CONVERT TO BINARY              Y01048 30220600
         LA    R4,K255            MAX ALLOWED                    Y01048 30221000
         CR    R1,R4              GREATER THAN MAX?              Y01048 30221400
         BH    ACINVALD           YES - ERROR                    Y01048 30221800
         STC   R1,APTAPFAC        SAVE APF CODE FOR BOTH         Y01048 30221900
         STC   R1,PDSAPFAC        REAL AND DEFAULT VALUES        Y01048 30222000
APFRTN50 NI    INTERN1,FF-APF     OFF INTERNAL SW                Y01048 30222100
         B     GOBY               MOVE TO PRINT                  Y01048 30226700
APFRTN60 LR    R7,R9              PRIME R7                       Y01048 30228700
         B     APFRTN10           LAST SCAN                      Y01048 30230700
ACINVALD NI    INTERN1,FF-APF     OFF INTERNAL SWITCH            Y01048 30231100
         B     INVALIDR           MESSAGE                        Y01048 30231200
         EJECT                                                          30231300
CHECKOPT EQU   *                   ENTRY FOR FIRST TIME                 30231500
         LTR   R9,R7               TRANSFER BACK TO AND TEST FOR 0 INR9 30236100
         BNP   OPT112             LENGTH OF OPTION 0 (,,OR==OR=,OR,=)   30250021
* ,( OR (( OR =( OR (= OR (, OR ), OR )= OR )) OR ,) OR ),              30300021
         BCTR  R7,0                -1 FOR MACHINE LENGTH                30350021
LASTSCN  EQU   *                                                        30400021
         LA    R3,OPTFIELD        ADDRESS OF ACCEPTABLE OPTIONS         30450021
         SR    R4,R4              CLEAR LENGTH REGISTER                 30500021
         SR    R5,R5              CLEAR INDEX REG                       30550021
         SPACE 1                                                        30600021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 30650021
*                                                                     * 30700021
* DETERMINES IF OPTION IS A VALID SELECTION IF NOT INSERT INVALID& SKIP 30750021
*                                                                     * 30800021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 30850021
         SPACE 1                                                        30900021
CHKOPT   IC    R4,0(0,R3)     LENGTH OF THE OPTION                      30950021
         CR    R4,R9              LN OF OPT IN LIST=LN OF OPT FOUND     31000021
         BNE   UPPTR              NO CHECK THE NEXT ENTRY               31050021
         EX    R7,COMPOPT         COMPARE THE TWO OPTIONS FOR =         31100021
         BE    OPT10              SET THE OPTION                        31150021
         SPACE 1                                                        31200021
UPPTR    LA    R3,1(R4,R3)        LN OF INST+LN BYTE(1)+LN OPT=NXT OPT  31250021
         LA    R5,DISP4(0,R5)     UP INDEX TO NEXT OPTION SETTER        31300021
         CLI   0(R3),TABLEEND     END OF ACCEPTABLE OPTIONS             31350021
         BNE   CHKOPT             CHECK THE NEXT OPTION IN THE LIST     31400021
* AT THIS POINT THE OPTION WAS NOT ONE OF THE ACCEPTABLE OPTIONS        31450021
 SPACE 1                                                                31500021
INVALIDR MVC   0(7,R8),INVMSG     OPTION INVALID MOVE MSG TO BUFFER     31550021
         MVC   7(BYTES1,R8),FUNCBYTE MOVE STOPPER BYTE                  31600021
         LA    R8,DISP8(0,R8)      UPDATE POINTER                       31650021
         B     RSTPTR              SAVE   POINTER                       31700021
OPT10    EX    R0,SETOPTS(R5)     SET OR RESET THE SWITCH(OPTION)       31750021
GOBY     EX    R7,MVOPT2M          MOVE THE OPTION TO HEADER MESSAGE    31800021
OPT112   EQU   *                                                        31850021
         LA    R3,0(R8,R9)        LN OF OPT+MSG ADR=POS FOR STOPPER     31900021
         MVC   0(BYTES1,R3),FUNCBYTE MOVE IN THE STOPPER BYTE           31950021
         LTR   R9,R9              WAS THE LENGTH OF THE OPTION 0        32000021
         BNP   SHRT               IF SO SKIP THE ALTERNATE INS          32050021
         CLI   FUNCBYTE,BLANK     WAS THE STOPPER A BLANG               32100021
         BE    OPT113             IF SO DO NOT MOVE IT                  32150021
         LA    R8,DISP2(R7,R8)     A(MSG)+MACH. LENGTH+2(,+1)=NEW PTR.  32200021
RSTPTR   LA    RB,DISP1(R9,RB)    UPDATE THE ADDRESS                    32250021
TSTCNT1  SR    RA,R9               LENGTH LEFT - AMMOUNT PROCESSED.     32300021
TSTCNT2  LTR   RA,RA               IS LENGTH STILL >0                   32350021
         BNP   OPTEXIT             TERMINATE  IF O OR -                 32400021
         B     SCANOPT             CONTINUE                             32450021
         SPACE 2                                                        32500021
SHRT     CLI   0(R3),BLANK        STOPPED BY A BLANK CHARACTER          32550021
         BE    ZEROLN             DO NOT MOVE BLANKS TO MESSAGE         32600021
         LA    R8,DISP1(R7,R8)                                          32650021
         B     ZEROLN                                                   32700021
  SPACE 1                                                               32750021
OPT113   LA    R8,0(R9,R8)        DO NOT INCLUDE THE LENGTH OF THE BLK  32800021
         B     RSTPTR                                                   32850021
 SPACE 1                                                                32900021
         EJECT                                                          32950021
***                                                                     33000021
*** UPON ENTRY R1 HAS THE VALUE TO BE CONVERTED                         33050021
*** THIS SECTION DELETES LEADING ZEROES FORM NUMBERS TO PRINT           33100021
***                                                                     33150021
 SPACE 1                                                                33200021
OPT500   LA    R4,7               MAX LENGTH OF THE VALUE               33250021
         CVD   R1,WORK            CONVERT TO DECIMAL NUMBER             33300021
         OI    WORK+7,X'0F'       CHANGE ZONE                           33350021
         UNPK  WORK1,WORK+DISP4(BYTES4)   UNPACK FOR PRINTING           33400021
         LA    RB,WORK1+DISP1     ADDRESS OF UNPACKED VALUE             33450021
OPT508   CLI   0(RB),C'0'         IS THIS A LEADING ZERO                33500021
         BNE   OPT512             DON'T DELETE                          33550021
         LA    RB,1(0,RB)         CHECK THE NEXT ONE                    33600021
         BCT   R4,OPT508          CONTINUE DLETING LEADING ZEROS        33650021
OPT512   LA    R4,WORK1+BYTES8     LAST BYTE OF VALUE IN WORK           33700021
         SR    R4,RB              AM NUL-LN OF VAL=NO VLD NON-ZERO      33750021
         BCTR  R4,0               - 1 FOR THE EXECUTE LENGTH            33800021
         EX    R4,MVOPT2M         MOVE THE VALUE TO THE MESSAGE         33850021
         LA    R8,DISP1(R4,R8) MC LN OF VAL+1ST ADR=ADR OF NXT BLK      33900021
         BR    RE                 RETURN                                33950021
 EJECT                                                                  34000021
***                                                                     34050021
***  UPON ENTRY INTO THIS ROUTINE (WHICH CONVERTS DECIMAL NUMBER IN K O 34100021
***  EXPLICIT FORMAT TO A HEXADECIMAL NUMBER)                           34150021
***  R1  UTILITY                                                        34200021
***  R2  BASE OF DSECT                                                  34250021
***  R3  UTILITY                                                        34300021
***  R4  UTILITY                                                        34350021
***  R5  POINTS TO THE LOCATION TO PLACE IT IN                          34400021
***  R7  MACHINE LENGTH OF VALUE   R9-1                                 34450021
***  R9 LENGTH OF VALUE (TRUE)                                          34500021
***  RA  # BYTES LEFT IN PARM FIELD                                     34550021
***  RB  POINTS TO THE VALUE TO BE CONVERTED                            34600021
***  RE HOLDS THE RETURN ADDRESS                                        34650021
         SPACE 2                                                        34700021
MOVEVAL  LTR   R4,R9               LN OF VALUE 0 -USE DEFAULT-          34750021
         BCR   CONCODE8,RE         YES -RETURN USER DEFAULTS THIS VALUE 34800021
         BCTR  R7,0               LN OF OPT-1 = MACH LN                 34850021
         LA    R1,0(RB,R7) MACH.LN+A(VAL)=A(LAST BYTE OF VAL)*R7=R9-1*  34900021
         CLI   0(R1),K             IS VALUE IMPLICIT  K                 34950021
         BNE   EXPLICIT                                                 35000021
         OI    INTERN1,KFORM       INDICATE IMPLICIT VALUE              35050021
         TM    INTERN1,VAL1RCVD   VALUE 1 RECIEVED YET                  35100021
         BZ    OPT600             YES CHECK LENTH                       35150021
         LA    R3,4                MAX.NO.CHARS. FOR IMPLICIT VALUE     35200021
OPT633   BCTR  R4,0               -1 FROM CHAR CNT, TO NOT CHECK K      35250021
         BCTR  R7,0       -1 FROM CHAR CNT FOR K                        35300021
OPT750   CR    R3,R9              CHARACTER COUNT OF VALUE TOO BIG      35350021
         BL    SIZEINVL                                                 35400021
CHKZONES BCTR  R4,0                                                     35450021
         LA    R5,0(RB,R4)         LAST NUMBER IN STRING                35500021
         LR    R1,RB              STARTING ADDRESS OF VALUE             35550021
         LA    R4,1               INDEX                                 35600021
NUMCK    TM    0(R1),NUMBER        ARE THE ZONES VALID                  35650021
         BNO   SIZEINVL            ZONES INVALID                        35700021
         BXLE  R1,R4,NUMCK        CONTINUE CHECKING ZONES               35750021
         XC    WORK,WORK          CLEAR WORK                            35800021
         EX   R7,PACK      PACK VALUE                                   35850021
         CVB   R1,WORK             CONVERT TO RADIX 2                   35900021
         TM    INTERN1,KFORM       WAS VALUE IMPLICIT                   35950021
         BZ    STOREVAL            NO                                   36000021
         NI    INTERN1,RSTKFORM    RESET SW                             36050021
         SLL   R1,MULT1024        MULT BY 1024 MAKE EXPLICIT            36100021
         LA    R7,1(R7)   ADD 1 TO IMPL. CHAR CNT FOR MACH LN           36150021
STOREVAL ST    R1,0(0,RF)         RECORD THE VALUE                      36200021
         BR    RE                                                       36250021
         SPACE 1                                                        36300021
EXPLICIT TM    INTERN1,VAL1RCVD   VALUE 1 RECIEVED YET                  36350021
         BO    OPT700             YES CHECK VALUE 2 RECIEVED            36400021
         LA    R3,6                MAX NO CHARS FOR EXPLICIT FORM       36450021
         B     OPT750                                                   36500021
         SPACE 2                                                        36550021
OPT600   LA    R3,5                MAX.NO.CHARS. FOR IMPLICIT VALUE     36600021
         B     OPT633                                                   36650021
         SPACE 2                                                        36700021
OPT700   LA    R3,7                MAX NO CHARS FOR EXPLICIT FORM       36750021
         B     OPT750                                                   36800021
         SPACE 1                                                        36850021
NOTANY   MVC   OPTIONS+2(BYTES4),NONEM  NO OPTIONS SPECIFIED            36900021
         B     EXIT                                                     36950021
         SPACE 1                                                        37000021
***   THIS SECTION ISOLATES THOSE  OPTIONS SET ON BY GENERATED          37050021
***   DEFAULTS                                                          37100021
***                                                                     37150021
 SPACE 1                                                                37200021
OPT950   NC    SAVATS(BYTES1),0(R3) ISOLATE OPTIONC                     37250021
         BR    RE                                                       37300021
 SPACE 1                                                                37350021
MVOPT2M  MVC   0(0,R8),0(RB)     MOVE OPTION TO HEADER MESSAGE          37400021
COMPOPT  CLC   0(0,RB),1(R3) COMPARE FOR VALID OPTION                   37450021
SCAN     TRT   0(0,RB),TRTBUF      TRT THROUGH THE PARM FIELD           37500021
PACK     PACK  WORK,0(0,RB)  PACK SIZE FOR RADIX CONVERSION             37550021
TSWITCH  TM    SAVATS,0 TEST THE ISOLATED OPTIONS                       37600021
         EJECT                                                          37650021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 37700021
*                                                                     * 37750021
* THESE ARE THE ALLOWABLE OPTIONS.                                    * 37800021
*                                                                     * 37850021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 37900021
         SPACE 2                                                        37950021
OPTFIELD EQU   *                  ** LINKAGE EDITOR OPTIONS **          38000021
 SPACE 1                                                                38050021
GENLST2  EQU   *                                                        38100021
         DC    X'04',C'XREF'      CROSS REFERENCE LISTING               38150021
         DC    X'03',C'MAP'       A MAP OF THE OUTPUT MODULE            38200021
         DC    X'04',C'LIST'      LIST THE CONTROL CARDS                38250021
GENLST1  EQU   *                                                        38300021
         DC    X'04',C'RENT'      MODULE IS RE-ENTRANT                  38350021
         DC    X'04',C'REUS'      MODULE IS SERIALLY RE-USEABLE         38400021
         DC    X'04',C'TEST'      MARK MODULE TEST                      38450021
         DC    X'03',C'LET'       DO NOT MARK NOT EXECUTABLE FOR ERRORS 38500021
         DC    X'04',C'XCAL'      IGNORE EXCLUSIVE CALLS IN OVERLAY     38550021
         DC    X'04',C'NCAL'      NO AUTOMALIC CALL LIBRARY             38600021
         DC    X'02',C'OL'        MARK -FETCH ONLY BY LOAD MACRO-       38650021
         DC    X'02',C'NE'        NOT-EDITABLE- NO CESD PRODUCED        38700021
         DC    X'02',C'DC'        1K RECORDS ON SYSLMOD FOR E'15-18-    38750021
         DC    X'04',C'REFR'      MATK -REFETCH AT ANY POINT- ER RECVY  38800021
         DC    X'04',C'TERM'      SUPPORT TERMINAL IN OS/TS             38850021
         DC    X'04',C'CALL'      USE SYSLIB FOR UNRES ERS              38900021
***                                                                     38950021
*** NEGATIVE OPTIONS SUPPORT                                            39000021
***                                                                     39050021
         DC    X'06',C'NOTEST'    DO NOT MARK IN TEST                   39100021
         DC    X'06',C'NOTERM'    NO TERMINAL SUPPORT                   39150021
         DC    X'06',C'NOLIST'    DO NOT LIST CONTROL CARDS             39200021
         DC    X'06',C'NOXREF'    NO CROSS-REFERENCE LISTING            39250021
         DC    X'05',C'NOMAP'     NO MAP OF LOAD MODULE                 39300021
         DC    X'06',C'NORENT'    MODULE NOT REENTRABLE                 39350021
         DC    X'06',C'NOREUS'    MODULE NOT REUSEABLE                  39400021
         DC    X'06',C'NOCALL'    SAME AS NCAL                          39450021
NOTVLD   EQU   *                                                        39500021
         DC    X'04',C'HIAR'      NOTE STORAGE HIARCHIES                39550021
         DC    X'04',C'SIZE'      USE FOLLOWING SIZES FOR EDIT RUN      39600021
         DC    X'04',C'DCBS'      USE DDCARD DCBBLKSIZE IF CAN          39650021
         DC    X'04',C'OVLY'      MODULE IS AN OVERLAY STRUCTURE        39700021
         DC    X'04',C'SCTR'      MARK MODULE BLOCK OR SCATTER LOAD     39750021
         DC    X'06',C'ALIGN2'    ALIGN ON 2K PAGE BOUNDARY      S01904 39760021
         DC    X'02',C'AC'        AUTHORIZATION CODE             Y01048 39770000
         DC    X'FF'              *** END OF OPTIONS ***                39800021
  EJECT                                                                 39850021
SETOPTS  DS    0H                                                       39900021
 SPACE 1                                                                39950021
         OI    APT0,XREF          XREF OPTION                           40000021
         OI    APT0,MAP           MAP OPTION                            40050021
         OI    APT0,LIST          LIST OPTION                           40100021
         OI    PDSE7,RENTREUS     RENT, AND REUS                        40150021
         OI    PDSE7,REUS         REUSABLE REUS OPTION                  40200021
         OI    PDSE7,TEST         TEST OPTION                           40250021
         OI    APT0,LET           LET OPTION                            40300021
         OI    APT0,XCAL          XCAL - EXCLUSIVE CALLS- OPTION        40350021
         OI    APT0,NCAL          NCAL - NO CALL- OPTION                40400021
         OI    PDSE7,OL            OL ONLY LOADABLE OPTION              40450021
         OI    PDSE8,NE           NOT EDITABLE -NE- OPTION              40500021
         NI    PDSE8,DC           DC OPTION                             40550021
         OI    PDSE8,REFR         MARK REFRESHABLE                      40600021
         OI    NEWSW,TERM         INDICATE TERMINAL OUTPUT              40650021
         NI    APT0,CALL          PERFORM AUTOCALL FOR UNRES - ER       40700021
         NI    PDSE7,NOTEST       RESET TEST ATTRIBUTE                  40750021
         NI    NEWSW,NOTERM       NO TERMINAL OUTPUT                    40800021
         NI    APT0,NOLIST        NO LIST                               40850021
         NI    APT0,NOXREF        NO XREF                               40900021
         NI    APT0,NOMAP         NO MAP                                40950021
         NI    PDSE7,NORENT       INDICATE NOT-REENTRANT                41000021
         NI    PDSE7,NOREUS       INDICATE NOT REUSEABLE                41050021
         OI    APT0,NCAL          NO AUTO CALL                          41100021
         OI    NEWSW,HIAR         HIARCHY OPTION                        41150021
         OI    INTERN1,SIZE       SIZEOPTION                            41200021
         OI    APTSWS,DCBS        DCBS OPTION                           41250021
         OI    PDSE7,OVLY         OVLY OPTION                           41300021
         OI    PDSE7,SCTR         SCTR OPTION ON                        41350021
         OI    APT4,ALIGN2        SET SWITCH FOR ALIGN2 OPTION   S01904 41360021
         OI    INTERN1,APF        AUTHORIZATION CODE             Y01048 41370000
 EJECT                                                                  41400021
         DS    0F                                                       41450021
GENSET1  DC    AL4(2,GENLST1,GENMASK1,3)                                41500021
GENSET2  DC    AL4(GENLST2,GENMASK2,3)                                  41550021
DEFADR   DC    V(HEWLFDEF)                                              41600021
HEADRS   DC    AL1(152),AL3(MESGNO1) LENGTH & ADD OF MESSAGE 1   YM5557 41650001
         DC    AL1(59),AL3(MESGNO2)    LENGTH AND ADDR OF MSG 2         41700021
         DC    AL1(029),AL3(MESGNO3) LENGTH AND ADDRESS OF MSG 3  M4507 41750000
MINVAL2  DC    A(6*1024) MINIMUM VALUE 2                                41800021
MAXVAL2  DC    A(100*1024)                                              41850021
GENMASK1 DC    AL1(RENT,REUS,TEST)                                      41900021
GENMASK2 DC    AL1(XREF,MAP,LIST)                                       41950021
    SPACE 1                                                             42000021
INVMSG   DC    CL7'INVALID'                                             42050021
MESGNO1  DC    X'09'                                                    42100021
IDENT    DC    C'XXXX-LEVEL LINKAGE EDITOR OPTIONS SPECIFIED'           42150021
BLK1     DC    CL1' '  BLANK TO RESET THE LINE                          42200021
OPTIONS  DC    27CL4' '                                          YM5557 42250001
MESGNO2  DC    X'09'                                                    42300021
DEFAULTM DC    CL11' '                 LEADING BLANKS                   42350021
         DC    C'VARIABLE OPTIONS USED -  SIZE=('                       42400021
VALUES   DC    CL16' '                                                  42450021
BLK2     DC    CL1' '  BLANK TO CLEAR LINE                              42500021
GENDFLTS DC    8CL4' '                                                  42550021
MESGNO3  DC    X'09'                                                    42600021
         DC    C'   ** OPTIONS INCOMPATIBLE **'                         42650021
DEFS     DC    CL17'DEFAULT OPTION(S)'                                  42700021
NONEM    DC    C'NONE'                                                  42750021
         DS    0F                                                       42800021
SAVEA    DS    16F  SAVE AREA                                           42850021
         DS    20F   PROVIDE 20 FULL WORDS OF MAINTENANCE AREA *******  42900021
     EJECT                                                              42950021
VRT      DSECT                                                          43000021
         DS    0D                                                       43050021
WORK     DC    1D'0'                                                    43100021
WORK1    DC    1D'0'                                                    43150021
TRTBUF   DC    256XL1'0'                                                43200021
FUNCBYTE DC XL1'0'                                                      43250021
INTERN1 DC XL1'0'                                                       43300021
APF      EQU   X'10'              AUTH CODE BEING HANDLED        Y01048 43310000
K255     EQU   255                AUTH CODE MAX                  Y01048 43320000
FF       EQU   X'FF'                                             Y01048 43330000
X01      EQU   X'01'                                             Y01048 43340000
APTDSECT HEWAPT                                                         43350021
 EJECT                                                                  43400021
DEFDSECT DSECT                                                          43450021
DEFID    DS    CL4 MODULE IDENTIFIER                                    43500021
DEFDSNPT DS    F   DESIGN POINT                                         43550021
DEFVAL1  DS    F   DEFAULT VALUE 1                                      43600021
DEFVAL2  DS    F   DEFAULT VALUE 2                                      43650021
DEFNAME  DS    CL4 EDITOR NAME F44,F88,F128,F256                        43700021
         END                                                            43750021
