         TITLE  'HEWLFROU-ENTRY,SYNAD,AND PRINT ROUTINES'               00060021
*  THIS CSECT IS THE ENTRY POINT OF LINKAGE EDITOR F AND CONTAINS AN  * 00100021
* UNCONDITIONAL BRANCH TO HEWLFINT WHERE INTERNAL PROCESSING BEGINS.  * 00150021
*  THE ERROR DIAGNOSTIC AND LOG ROUTINE AND A COMMON PRINT ROUTINE,   * 00200021
* THE  EXIT LIST (APTEXLST,APTXLIST) AND A COMMON SYNAD ROUTINE ARE   * 00250021
* ALSO IN THIS CSECT.                                                 * 00300021
*  DCB MACROS FOR SYSLIN, SYSLMOD, SYSUT1, SYSPRINT, AND SYSLIB,      * 00350021
* ARE PRESENT AND THE CSECT CONTAINS APPROPRIATE VCONS, EXTRNS AND    * 00400021
* ENTRIES SO THAT  CERTAIN EXCLUSIVE CALLS BETWEEN SEGMENTS WILL BE   * 00450021
* ALLOWED                                                             * 00500021
*                                                                     * 00550021
HEWLFROU CSECT                                                          00600021
**********************************************************************  00650021
*385200-391600,430800-436400,446800-447600,453200-464400         S21016 00660021
*503600-964400                                                   S01904 00670021
*020200,140900                                                   A47001 00670400
*C222800                                                        OX01131 00670802
*C851600,C854800                                                 YM5281 00671202
*A717700-717984                                                  XM1692 00671602
*A706500-706700,A944100-944392,C940400                          OX04245 00671702
*I022800,I501200,I964400                                OX04280,OY03413 00671802
*A644400,I644900-645100                                 OX05441,OY05016 00671902
*I053200,I107600,C108400                                        OZ01414 00693937
*C964500                                                       @XA11383 00703937
*C168400                                                       @ZA07606 00706937
*                                                                       00709937
         EJECT                                                          00712937
**********************************************************************  00716037
         ENTRY HEWLCRO1                                                 00738037
         ENTRY HEWLCRO2                                                 00760021
         ENTRY HEWLCRO3                                                 00840021
         ENTRY APTEND                                                   00920021
         ENTRY HEWLCSDB                                                 01000021
         ENTRY HEWLCMDB                                                 01080021
         ENTRY HEWLCPDB                                                 01160021
         ENTRY HEWLCUDB                                                 01240021
         ENTRY HEWLTMDB                                                 01320021
         ENTRY HEWLFLOG                                                 01400021
         ENTRY HEWLFLDB                                                 01480021
         ENTRY APTEXLST                                                 01560021
         ENTRY APTXLIST                                                 01640021
         ENTRY HEWLEPNT                                                 01720021
         ENTRY HEWLCADA                                                 01800021
         ENTRY     ENQNAME                                              01880021
         ENTRY     MINOR                                                01960021
         ENTRY INDDNAME                                          A47001 02010000
         EXTRN HEWLEEON                                                 02040021
         EXTRN HEWLCEOD                                                 02120021
         EXTRN HEWLXIT2                                                 02200021
         EXTRN MSGFOUR                                                  02280021
         ENTRY HEWVLDCK                                 OX04280,OY03413 02330002
*                                                                     * 02360021
*   REGISTERS AND EQUATES                                             * 02440021
*                                                                     * 02520021
R0       EQU   0                                                        02600021
R1       EQU   1                                                        02680021
REG2     EQU   2                                                        02760021
REG3     EQU   3                                                        02840021
REG4     EQU   4                                                        02920021
BUFFADD  EQU   4                                                        03000021
REG5     EQU   5                                                        03080021
PRECL    EQU   8                                                        03160021
R9       EQU   9                                                        03240021
TSO      EQU   X'80'                   TSO SWITCH IN APTSWS             03320021
TERM     EQU   X'02'                   TERM SWITCH IN NEWSW             03400021
TERMCHK  EQU   X'08'                   TERMINAL CHECK SWITCH            03480021
NOCHK    EQU   X'F7'                   NO CHECK NEEDED                  03560021
TERMWRT  EQU   X'04'                   TERMINAL WRITE SWITCH            03640021
NOTRMWRT EQU   X'FB'                   NO WRITE NEEDED                  03720021
FLUSH    EQU   X'02'                   FLUSH REQUESTED                  03800021
R10      EQU   10                                                       03880021
R11      EQU   11                                                       03960021
R12      EQU   12                                                       04040021
R13      EQU   13                                                       04120021
R14      EQU   14                                                       04200021
REG14    EQU   14                                                       04280021
R15      EQU   15                                                       04360021
REG15    EQU   15                                                       04440021
BLKSIZ   EQU   12                                                       04520021
LRECL    EQU   14                                                       04600021
BLKFAC   EQU   16                                                       04680021
RECCNT   EQU   18                                                       04760021
CURBUF   EQU   20                                                       04840021
PRNTSW   EQU   24                                                       04920021
READSW   EQU   24                                                       05000021
NUMBLINS EQU   53                      NUMBER OF LINES PER PAGE         05080021
LETON    EQU   X'10'                                                    05160021
NOEX     EQU   X'FD'                                                    05240021
NOLIN    EQU   55                                                       05320021
TERMON   EQU   X'04'                                            OZ01414 05370037
         USING *,15                                                     05400021
         BC    15,OVERNAME            BRANCH AROUND MODULE IDENT        05480037
         DC    C' 01/26/76 OZ07606'   DATE/APAR NUMBER                  05560037
         DC    C' HEWLFROU ',0H'0'    MOD ID                            05610037
         SPACE 3                                                        05660037
OVERNAME L     15,HEWLCINT                                              05710037
         BR    15                       BRANCH TO INITIALIZATION        05760037
HEWLCINT DC    V(HEWLFINT)                                              05810037
*********************************************************************** 05860037
*        BRANCH TO HEWLFINT                                           * 05910037
*********************************************************************** 05960037
         TITLE 'HEWLFROU'                                               06010037
*********************************************************************** 06060037
* COMMON SYNAD ROUTINE                                                * 06110037
*********************************************************************** 06160037
         USING *,15                                                     06280021
         USING APTDSECT,REG2                                            06360021
         USING IHADCB,1                                                 06440021
HEWLCRO1 LR    REG3,0                  ADDRESS OF DECB                  06520021
         NI    ENTRYSW,X'7F'           INDICATE ENTRY FROM BSAM         06600021
         LA    REG3,0(0,REG3)          DESTRUCT H1 ORDER BYTE           06680021
         LA    REG4,DECBLIN            ADDRESS OF SYSLIN DECB           06760021
         CR    REG3,REG4               IS THIS SYSLIN                   06840021
         BC    8,CKBLKSZ               YES--CHECK FOR SHORT BLOCK       06920021
         LA    REG4,DECBLIB            NO--CHECK IF THIS IS SYSLIB      07000021
         CR    REG3,REG4                                                07080021
         BC    7,CHECKPNT              NO--GO CHECK FOR SYSPRINT        07160021
         TM    HEWLCRBB+24,X'08'       IS IGNORE ERROR BIT ON           07240021
         BCR   1,14                    YES--RETURN                      07320021
CKBLKSZ  L     REG3,16(0,REG3)         ADDRESS OF STATUS INDICATORS     07400021
         CLI   13(REG3),X'40'          IS IT INCORRECT LENGTH           07480021
         BC    7,SYNERR                NO--GO TO ERROR ROUTINE          07560021
         LH    REG4,BLKFAC(0,REG5)     YES--CHECK FOR VALID SHORT BLOCK 07640021
         LH    REG3,14(0,REG3)         RESIDUAL COUNT                   07720021
DECREC   BCTR  REG4,0                  DECREMENT RECORD COUNT           07800021
         SH    REG3,LRECL(0,REG5)      SUBTRACT LOGICAL RECORD LENGTH   07880021
         BP    DECREC                  LOOP UNTIL ZERO OR MINUS         07960021
         BM    SYNERR                  NOT VALID SHORT BLOCK            08040021
         STH   REG4,RECCNT(0,REG5)     SAVE NUMBER OF RECORDS.          08120021
         BR    14                      RETURN TO CONTROL PROGRAM        08200021
SYNERR   TM    ENTRYSW,X'80'           WAS ENTRY FROM BPAM              08280021
         BC    8,BSAMERR               NO                               08360021
         B     BPAMERR                 GO TO BPAM MACRO                 08440021
CHECKPNT LA    REG4,DECBPRNT           CHECK FOR SYSPRINT               08520021
         CR    REG3,REG4                                                08600021
         BC    7,BSAMERR               NO                               08680021
         OI    NEWSW,X'08'             SET IMMEDIATE ABORT BIT          08760021
         B     ABORT                                                    08840021
BSAMERR  ST    REG4,SAVE4              SAVE REGISTER 4                  08920021
         LR    REG4,REG15              SAVE BASE REGISTER               09000021
         SYNADAF ACSMETH=BSAM          BSAM                             09080021
         LR    REG15,REG4              RESTORE BASE REGISTER            09160021
         L     REG4,SAVE4              RESTORE REGISTER 4               09240021
MESGPRNT OI    BITMAP+4,X'10'          INDICATE ERR 294 FOR BIT MAP     09320021
         MVI   HISEV+1,X'04'           MOVE IN SEVERITY 4               09400021
MESGPNTA LH    REG3,LINECNT            CHECK FOR END OF PAGE            09480021
         BCT   REG3,NOPAGE                                              09560021
         LA    REG3,NUMBLINS           INITIALIZE LINE COUNT            09640021
         L     REG4,HEWLCWBB+20        ADDRESS OF PRINT BUFFER          09720021
         MVI   0(REG4),X'8B'           RESTORE CHARACTER                09800021
         LR    REG4,REG15              SAVE BASE REG                    09880021
         L     REG15,PRNTAD            ADDRESS OF PRINT ROUTINE         09960021
         BALR  REG14,REG15                                              10040021
         LR    REG15,REG4              RESTORE BASE REG                 10120021
NOPAGE   STH   REG3,LINECNT            STORE UPDATED LINE COUNT         10200021
         L     REG4,HEWLCWBB+20        ADDRESS OF PRINT BUFFER          10280021
         MVC   26(94,REG4),32(1)       MOVE FORMATTED MESSAGE TO BUFF   10360021
         MVC   0(20,REG4),MESG1        MOVE IN IEW0294                  10440021
         TM    NEWSW,X'10'             WAS ENTRY FROM MAP               10520021
         BC    8,MESGPNTB              NO                               10600021
         MVC   0(8,REG4),MESG3         YES--MOVE IN IEW0630             10680021
MESGPNTB LR    REG4,REG15              SAVE BASE REGISTER               10760021
         TM    NEWSW,TERM              TERM OPTION SPEC?        OZ01414 10810037
         BZ    NOTERM                  NO? BRANCH               OZ01414 10820037
         OI    HEWLCWBB+24,TERMON      SET ON TERM.WRITE SW     OZ01414 10830037
NOTERM   L     REG15,PRNTAD            LOAD ADD OF PRT ROUTINE  OZ01414 10840037
         BALR  REG14,REG15                                              10920021
         LR    REG15,REG4              RESTORE BASE REG                 11000021
         SYNADRLS                                                       11080021
         LR    REG15,REG4    RESTORE BASE VALUE TO R15                  11160021
         TM    NEWSW,X'10'             WAS ENTRY FROM MAP               11240021
         BC    8,ABORT                 NO--ABORT                        11320021
         L     REG15,MAPADD            YES--RETURN TO MAP               11400021
         BR    REG15                                                    11480021
ABORT    L     REG15,SYNADROU          GO TO FINAL                      11560021
         BR    REG15                                                    11640021
         USING *,REG15                                                  11720021
HEWLCRO2 L     REG15,BASEADD           SET UP BASE REG                  11800021
         USING HEWLCRO1,REG15                                           11880021
         OI    ENTRYSW,X'80'           INDICATE BPAM ENTRY              11960021
         TM    HEWLCRBB+24,X'08'       IS IGNORE ERROR BIT ON           12040021
         BCR   1,14                    YES--RETURN                      12120021
         TM    DCBRECFM,X'40'          NO--IS RECFM FIXED               12200021
         LR    REG3,0                  DECB ADDRESS TO REG3             12280021
         BC    8,CKBLKSZ               YES--GO CHECK FOR SHORT BLOCK    12360021
BPAMERR  ST    REG4,SAVE4              SAVE REGISTER 4                  12440021
         LR    REG4,REG15              SAVE BASE REGISTER               12520021
         SYNADAF ACSMETH=BPAM          BPAM                             12600021
         LR    REG15,REG4              RESTORE BASE REGISTER            12680021
         L     REG4,SAVE4              RESTORE REGISTER 4               12760021
         TM    NEWSW,X'10'             WAS ENTRY FROM MAP               12840021
         BC    8,MESGPRNT              NO                               12920021
         OI    BITMAP,X'40'            INCICATE ERR 630 FOR BIT MAP     13000021
         B     MESGPNTA                                                 13080021
         USING *,REG15                                                  13160021
HEWLCRO3 L     REG15,BASEADD           SET UP BASE REG                  13240021
         USING HEWLCRO1,REG15                                           13320021
         ST    REG4,SAVE4              SAVE REGISTER 4                  13400021
         LR    REG4,REG15              SAVE BASE REGISTER               13480021
         SYNADAF   ACSMETH=EXCP                                         13560021
         LR    REG15,REG4              RESTORE BASE REGISTER            13640021
         L     REG4,SAVE4              RESTORE REGISTER 4               13720021
         B     MESGPRNT                GO TO PRINT MESSAGE              13800021
SAVE4    DC    F'0'                    SAVE AREA FOR REGISTER 4         13880021
MAPADD   DC    V(HEWLFAPX)             ADDRESS OF MAP TO CLEAN UP       13960021
BASEADD  DC    A(HEWLCRO1)                                              14040021
INDDNAME DC    C'SYSLIN  '         TO SAVE SYSLIN DDNAME         A47001 14090000
ENTRYSW  DC    X'00'                                                    14120021
*        BIT 0 - 0  ENTRY FROM BSAM                                     14200021
*                1  ENTRY FROM BPAM                                     14280021
MESG1    DC    X'09'                   CONTROL CHARACTER PRINT AND SP   14360021
         DC    C'IEW0294'                                               14440021
         DC    C'  SYNAD EXIT'                                          14520021
MESG3    DC    X'09'                   CONTROL CHARACTER PRINT AND SP   14600021
         DC    C'IEW0630'                                               14680021
SYNADROU DC    V(HEWLCSNX)             ADDRESS TO FINAL PROCESSOR       14760021
         EJECT                                                          14840021
*********************************************************************** 14920021
*                                                                     * 15000021
*  DCB EXIT ROUTINE FOR SYSLIN,SYSLIB, AND SYSPRINT                   * 15080021
*                                                                     * 15160021
*********************************************************************** 15240021
         USING *,15                                                     15320021
         USING IHADCB,1                                                 15400021
HEWLEXIT EQU   *                                                        15480021
         NI    DCBBUFNO,X'00'      ZERO OUT BUFFER NUMBER FIELD         15560021
         TM    DCBRECFM,X'80'      CHECK FOR FORMAT F-BITS 01=10        15640021
         BC    8,EXIT4                 NO--RETURN                       15720021
         TM    DCBRECFM,X'40'                                           15800021
         BC    1,EXIT4                 NO--RETURN                       15880021
         NI    DCBRECFM,X'E7'          TURN OFF B AND S BITS            15960021
         L     REG5,HEWLCLAC           ADDRESS OF CURRENT CONTROL BLOCK 16040021
         LA    REG3,0(0,R1)            ADDRESS OF DCB                   16120021
         L     REG4,HEWLCWBB           ADDRESS OF SYSPRINT DCB          16200021
         LA    REG4,0(0,REG4)          DESTRUCT HI ORDER BYTE           16280021
         CR    REG3,REG4               IS THIS SYSPRINT                 16360021
         BC    7,EXITA                 NO                               16440021
****************************************************************        16520037
*  UNDER TSO, SYSPRINT IS ALWAYS UNBLOCKED; LRECL=BLKSIZE=81.  *        16580037
****************************************************************        16640037
         TM    APTSWS,TSO          IS TSO IN EFFECT?                    16700037
         BC    8,TSO1              NO-BRANCH                            16760037
         CLI   DCBDEVT,X'4F'       IS TERM USED FOR SYSPRINT?  @ZA07606 16840037
         BNE   TSO1                BR IF NOT USED              @ZA07606 16880037
         LA    REG5,81             LOAD LRECL FOR TERMINAL              16920021
         STH   REG5,DCBLRECL       STORE IN DCB                         17000021
         STH   REG5,DCBBLKSI           STORE BLOCKSIZE                  17080021
         STH   REG5,HEWLCWBB+14    STORE IN SYSPRINT CONT. BLOCK        17160021
TSO1     LA    REG5,HEWLCWBB       LOAD CONTROL BLOCK                   17240021
         L     8,TEST                                                   17320021
         CLI   0(8),X'00'                                               17400021
         BE    EXITA                                                    17480021
         LH    REG4,DCBLRECL                                            17560021
         CH    REG4,DCBBLKSI                                            17640021
         BL    EXITB                                                    17720021
         MVI   0(8),X'00'                                               17800021
         B     EXITB                                                    17880021
EXITA    LH    REG4,DCBBLKSI                                            17960021
         LTR   REG4,REG4                                                18040021
         BC    7,EXIT1                 IF BLOCKSIZE NOT 0 BRANCH        18120021
         LH    REG4,DCBLRECL                                            18200021
EXITB    STH   REG4,DCBBLKSI       MAKE BLKSI = LRECL                   18280021
EXIT1    SR    PRECL,PRECL                                              18360021
         LH    REG3,MAXBF              MAXIMUM BLOCKING FACTOR          18440021
EXIT2    LA    PRECL,1(0,PRECL)        DIVIDE BLKSI BY LRECL            18520021
         SH    REG4,DCBLRECL           TO FIND BLOCKING FACTOR          18600021
         BC    8,EXIT3                                                  18680021
         BCT   REG3,EXIT2              FALL THRU IF BLKSIZE TO BIG      18760021
         MVI   BLKFAC+1(REG5),41       INDICATE INVALID BLOCKSIZE       18840021
         OI    READSW(REG5),X'04'      INDICATE INVALID BLOCKSIZE       18920021
         BR    R14                     RETURN                           19000021
EXIT3    STH   PRECL,BLKFAC(0,REG5)    SAVE BLOCKING FACTOR             19080021
         MVI   RECCNT+1(REG5),X'01'    INITIALIZE RECORD COUNT TO ONE   19160021
         MVC   BLKSIZ(2,REG5),DCBBLKSI SAVE BLOCK SIZE IN CONTROL BLOCK 19240021
         OI    READSW(REG5),X'80'      SET SWITCH TO PRIME BUFFER       19320021
         NI    READSW(REG5),X'FB'      TURN OFF INVALID BLOCKSIZE BIT   19400021
         LA    REG3,HEWLCWBB           IS THIS SYSPRINT                 19480021
         CR    REG3,REG5                                                19560021
         BC    7,EXIT4                 NO--RETURN                       19640021
         STH   PRECL,RECCNT(0,REG5)    YES--RESET RECCNT TO BLK FACTOR  19720021
         BCT   PRECL,EXIT5             IS IT BLOCKED                    19800021
         BC    15,EXIT4                NO                               19880021
EXIT5    OI    DCBRECFM,X'10'          YES--TURN ON BLOCK BIT           19960021
EXIT4    BR    R14                     RETURN                           20040021
         DROP  15                                                       20120021
*********************************************************************** 20200021
*                                                                     * 20280021
*        DCB EXIT ROUTINE FOR SYSUT1                                  * 20360021
*                                                                     * 20440021
*********************************************************************** 20520021
         USING *,15                                                     20600021
         USING IHADCB,1                                                 20680021
HEWLXIT1 EQU   *                                                        20760021
         NI    DCBBUFNO,X'00'          ZERO OUT BUFFER NUMBER           20840021
         BR    R14                     RETURN                           20920021
         DROP  15                                                       21000021
*  SYSTERM IS ALWAYS UNBLOCKED. LRECL=81 FOR TSO,121 FOR BCKGRND        21080021
*                                                                       21160021
         USING *,15                                                     21240021
         USING IHADCB,1                                                 21320021
TERMEX   TM    APTSWS,TSO              IN TSO MODE?                     21400021
         BO    EXIT6                   YES - BRANCH                     21480021
         LA    REG5,121                NO--SET BLKSIZE,LRECL=121        21560021
         STH   REG5,DCBLRECL                                            21640021
         STH   REG5,DCBBLKSI                                            21720021
EXIT6    BR    14                      RETURN                           21800021
         DROP  15                                                       21880021
*                                                                     * 21960021
*  DCB MACROS FOR SYSLIN, SYSLMOD, SYSUT1, SYSPRINT, SYSLIB           * 22040021
*                                                                     * 22120021
*         *         *         *         *         *         *         * 22200021
         SPACE 3                                                        22250037
         DC    0F'0'                                                    22260037
         DC    C'SYSLIN '                                               22270037
HEWLCSDB DCB   DSORG=PS,MACRF=(R),DDNAME=SYSLIN,RECFM=FB,LRECL=80,     X22280002
               NCP=1,EODAD=HEWLEEON,SYNAD=HEWLCRO1,EXLST=APTEXLST       22360021
         SPACE 3                                                        22410037
         DC    C'SYSLMOD'                                               22420037
SYSLMOD  DCB   DSORG=PO,MACRF=(R,W),DDNAME=SYSLMOD,RECFM=U,            X22440021
               NCP=1,EODAD=HEWLCRO2,SYNAD=HEWLCRO2,EXLST=APTXLIST       22520021
HEWLCMDB EQU   SYSLMOD                                                  22600021
         SPACE 3                                                        22650037
         DC    C'SYSUT1'                                                22660037
SYSUT1   DCB   DSORG=PS,MACRF=(WP,RP),DDNAME=SYSUT1,DEVD=DA,RECFM=U,   X22680021
               BLKSIZE=3072,NCP=1,EODAD=HEWLCRO1,SYNAD=HEWLCRO1,       X22760021
               EXLST=APTELIST                                           22840021
HEWLCUDB EQU   SYSUT1                                                   22920021
         SPACE 3                                                        22970037
         DC    C'SYSPRINT'                                              22980037
SYSPRINT DCB   DSORG=PS,MACRF=(W),DDNAME=SYSPRINT,DEVD=DA,             X23000021
               NCP=1,RECFM=FA,LRECL=121,SYNAD=HEWLCRO1,EXLST=APTEXLST   23080021
HEWLCPDB EQU   SYSPRINT                                                 23160021
         SPACE 3                                                        23210037
         DC    C'SYSTERM'                                               23220037
SYSTERM  DCB   DSORG=PS,MACRF=(W),DDNAME=SYSTERM,NCP=1,DEVD=DA,        X23240021
               RECFM=FA,LRECL=81,BLKSIZE=81,BUFNO=0,                   X23320021
               EXLST=TERMEXIT                                           23400021
HEWLTMDB EQU   SYSTERM                                                  23480021
         SPACE 3                                                        23530037
         DC    C'SYSLIB'                                                23540037
HEWLFLDB DCB   DSORG=PO,MACRF=(R),DDNAME=SYSLIB,NCP=1,EODAD=HEWLCEOD,  C23560021
               SYNAD=HEWLCRO2,EXLST=APTEXLST,LRECL=80                   23640021
         TITLE 'HEWLFROU COMMON PRINT ROUTINE'                          23690037
*         *         *         *         *         *         *         * 23720021
*                                                                     * 23800021
*   COMMON PRINT ROUTINE                                              * 23880021
*                                                                     * 23960021
*         *         *         *         *         *         *         * 24040021
APTEND   EQU   *                                                        24120021
         USING *,R15                                                    24200021
HEWLEPNT STM   R9,R1,SAVREGS       SAVE REGISTERS                       24280021
         LR    R12,R15                 R12 IS BASE REG                  24360021
         USING HEWLEPNT,R12                                             24440021
         DROP  R15                                                      24520021
         LA    R13,REGSA           ADDRESS OF SAVE AREA                 24600021
         LA    R11,HEWLCWBB        ADDRESS OF PRINT CONTROL BLOCK       24680021
         L     R10,CURBUF(0,R11)        PICK UP BUF ADDR                24760021
         TM    0(R10),X'02'             SKIP LINES ONLY                 24840021
         BNO   TRANCHAR                 NO, PRINT LINE                  24920021
         NI    0(R10),X'FD'             TURN OFF BIT                    25000021
TRANCHAR EQU   *                                                        25080021
         LA    R0,CVTABEND              PICK UP TABLE END ADDR          25160021
         LA    R15,CONVERTB             PICK UP TABLE BEGINADDR         25240021
TRANLOOP EQU   *                                                        25320021
         CLC   0(1,R10),0(R15)          COMPARE CHAR WITH TABLE         25400021
         BE    OUTLPTR                  MATCH FOUND                     25480021
         LA    R15,2(R15)               UPDATE TABLE PTR                25560021
         CR    R15,R0                   END OF TABLE REACHED            25640021
         BNH   TRANLOOP                 NO, CONTINUE SEARCH             25720021
         B     PRINTK                   ASSUMED ALREADY ASA CHAR        25800021
OUTLPTR  EQU   *                                                        25880021
         MVC   0(1,R10),1(R15)          MATCH FOUND, PICK UP ASA CHAR   25960021
PRINTK   EQU   *                                                        26040021
* ****************************************************************** *  26120021
*                                                                       26200021
*        THIS SECTION OF CODE DOES WRITES TO THE SYSTERM DATASET.       26280021
*        THE SYSTERM DATA SET MAY RESIDE ON ANY DEVICE, BUT ITS         26360021
*        PRIMARY PURPOSE IS TO ISSUE ERROR MESSAGES TO THE TSO          26440021
*        USER'S TERMINAL.  THEREFORE, SYSTERM IS ALWAYS UNBLCKD,        26520021
*        LRECL=81, BLKSIZE=81.  SINCE THE ERROR MESSAGES ARE            26600021
*        ALSO WRITTEN ON THE SYSPRINT DATA SET, THE SAME BUFFERS        26680021
*        ARE USED.                                                      26760021
*                                                                       26840021
* ****************************************************************** *  26920021
         TM    PRNTSW(R11),TERMCHK     NEED TERMINAL CHECK?             27000021
         BC    8,TSO2                  NO - BRANCH AROUND               27080021
         CHECK DECBPRN2                CHECK LAST TERMINAL WRITE        27160021
         NI    PRNTSW(R11),NOCHK       TURN OFF CHECK SWITCH            27240021
TSO2     TM    PRNTSW(R11),TERMWRT     WRITE TO TERM. NEEDED?           27320021
         BC    8,TSO3                  NO - GO DO SYSPRINT              27400021
         L     R9,TERMDCB              LOAD  TERMINAL DCB               27480021
         L     R10,CURBUF(R11)         LOAD CURRENT RECORD ADD.         27560021
         WRITE DECBPRN2,SF,(R9),(R10)  WRITE RECORD                     27640021
         OI    PRNTSW(R11),TERMCHK     TURN ON TERM CHECK SWITCH        27720021
         NI    PRNTSW(R11),NOTRMWRT  TURN OFF TERM. WRITE SWITCH        27800021
TSO3     TM    PRNTSW(R11),FLUSH       IS THIS A FLUSH?                 27880021
         BC    8,PRINTD                NO                               27960021
         CLC   RECCNT(2,R11),BLKFAC(R11) YES--IS ANYTHING IN BUFFER     28040021
         BNE   PRINTG                  NO--GO CHECK LAST PRINT          28120021
         TM    PRNTSW(R11),X'80'       WAS THERE ANY WRITE              28200021
         BC    1,PRINTE                NO--GO RETURN                    28280021
PRINTI   OI    PRNTSW(R11),X'01'       YES--SET CHECK ONLY BIT          28360021
         BC    15,PRINTF               AND GO CHECK                     28440021
PRINTG   LH    R10,BLKFAC(0,R11)                                        28520021
         SH    R10,RECCNT(0,R11)       NUMBER OF RECORDS TO WRITE       28600021
         MH    R10,LRECL(0,R11)        SIZE OF BLOCK                    28680021
         L     R14,HEWLCWBB                                             28760021
         USING IHADCB,R14                                               28840021
         STH   R10,DCBBLKSI                                             28920021
         DROP  R14                                                      29000021
         BC    15,PRINTH               GO TO PRINT                      29080021
PRINTD   LH    R10,RECCNT(0,R11)       CHECK IF BUFFER FULL             29160021
         BCT   R10,PRINTB              BRANCH IF NOT FULL               29240021
PRINTH   L     R10,BUFFADD(0,R11)      SWITCH BUFFERS                   29320021
         MVC   BUFFADD(4,R11),BUFFADD+4(R11)                            29400021
         ST    R10,BUFFADD+4(0,R11)                                     29480021
         MVC   RECCNT(2,R11),BLKFAC(R11) RESTORE RECORD COUNT           29560021
         TM    PRNTSW(R11),X'80'       IS THIS FIRST WRITE              29640021
         BC    1,PRINTA                YES--DON'T CHECK                 29720021
PRINTF   CHECK DECBPRNT                                                 29800021
         TM    PRNTSW(R11),X'01'       IS CHECK ONLY SW ON              29880021
         BC    1,PRINTE                YES--GO RETURN                   29960021
PRINTA   WRITE DECBPRNT,SF,HEWLCPDB,(R10)                               30040021
         TM    PRNTSW(R11),X'02'       WAS THIS A FLUSH                 30120021
         BC    1,PRINTI                YES--GO CHECK                    30200021
         NI    PRNTSW(R11),X'7F'       TURN OFF FIRST WRITE SW          30280021
         L     R10,BUFFADD(0,R11)      GET NEW BUFFER                   30360021
         BC    15,PRINTC                                                30440021
PRINTB   STH   R10,RECCNT(0,R11)                                        30520021
         L     R10,CURBUF(0,R11)       UPDATE CURRENT BUFFER ADDRESS    30600021
         AH    R10,LRECL(0,R11)                                         30680021
PRINTC   ST    R10,CURBUF(0,R11)                                        30760021
         MVI   0(R10),C' '             CLEAN OUT NEW BUFFER             30840021
         MVC   1(120,R10),0(R10)                                        30920021
PRINTE   LM    R9,R1,SAVREGS       RESTORE REGISTERS                    31000021
         BR    R14                     AND RETURN                       31080021
SAVREGS  DS    9F                  SAVE AREA                            31160021
TERMDCB  DC    A(HEWLTMDB)         ADDRESS OF TERMINAL DCB              31240021
CONVERTB EQU   *                                                        31320021
         DC    X'09'                    MACH CHAR--PRINT ON NEXT LINE   31400021
         DC    C' '                     ASA CHAR--PRT ON NEXT LINE      31480021
         DC    X'11'                    MACH CHAR--SKIP LINE THEN PRT   31560021
         DC    C'0'                     ASA CHAR--SKIP LINE THEN PRT    31640021
         DC    X'19'                    MACH CHAR-SKIP 2 LINES THEN PRT 31720021
         DC    C'-'                     ASA CHAR--SKIP 2 LINES THEN PRT 31800021
         DC    X'89'                    MACH CHAR--TOP OF PAGE THEN PRT 31880021
         DC    C'1'                     ASA CHAR--TOP OF PAGE THEN PRT  31960021
CVTABEND EQU   *                                                        32040021
         TITLE  'HEWLFROU  ERROR DIAGNOSTIC AND LOG ROUTINE'            32120021
*              *                   *              *                   * 32200021
*FUNCTION                                                             * 32280021
*1.THE ERROR DIAGNOSTIC ROUTINE WILL OUTPUT A MESSAGE FOR EACH ERROR  * 32360021
*  CONDITION UNCOVERED DURING LINKAGE EDITING. IT WILL ALSO LOG CON-  * 32440021
*  TROL CARDS, IF THE LIST OPTION HAS BEEN SPECIFIED. IT WILL NOT     * 32520021
*  OUTPUT AN ENGLISH MESSAGE. ALL MESSAGES WILL BE IN THE FORMAT      * 32600021
*  IEWMMMS, WHERE 'MMM' IS THE ERROR MESSAGE NUMBER AND 'S' IS THE    * 32680021
*  SEVERITY. A CARD, SYMBOL, TWO SYMBOLS, OR BLANKS MAY FOLLOW,       * 32760021
*  DEPENDING IF ADDITIONAL INFORMAION IS REQUIRED.                    * 32840021
*2.ALSO INCLUDED IS A NUMBER OF 'V' TYPE ADCONS. THIS IS TO ALLOW     * 32920021
*  CALLS BETWEEN VARIOUS SUBROUTINES IN THE LINKAGE EDITOR OVERLAY    * 33000021
*  TREE.                                                              * 33080021
*                                                                     * 33160021
*ENTRY POINTS                                                         * 33240021
*  HEWLFLOG                                                           * 33320021
*  THE CALLING SEQUENCE IS: GR14=RETURN ADD GR15=ADD OF ERROR ROUTINE * 33400021
*  GR0=ERROR CODE. THE FOLLOWING TWO REGISTERS ARE OPTIONAL:          * 33480021
*  GR1=ADDRESS OF SYMBOL, GR13=ADDRESS OF 2ND SYMBOL.                 * 33560021
*                                                                     * 33640021
*  INPUT - FROM VARIOUS PROCESSORS WITHIN THE LINKAGE EDITOR          * 33720021
*                                                                     * 33800021
*  OUTPUT - ALWAYS TO SYSPRNT                                         * 33880021
*                                                                     * 33960021
*  EXTERNAL ROUTINES - NONE                                           * 34040021
*                                                                     * 34120021
*  EXITS - RETURN ADDRESS SPECIFIED IN REGISTER 14 IS LOADED INTO R15.* 34200021
*          R15 IS USED TO ALLOW CONTROL, WITHIN THE EDITOR, TO PASS TO* 34280021
*          ANOTHER OVERLAY SEGMENT(IF CONTROL IS NOT TO BE RETURNED TO* 34360021
*          THE SENDER).                                               * 34440021
*                                                                     * 34520021
*  WORK AREA - A THIRTY-TWO BYTE BUFFER IS USED FOR THE MESSAGE HEADER* 34600021
*                                                                     * 34680021
*  ATTRIBUTES - REUSABLE                                              * 34760021
*                                                                     * 34840021
*NOTES:                                                               * 34920021
* THE ERROR CODE IN R0 WILL APPEAR AS FOLLOWS:                        * 35000021
*                                                                     * 35080021
*  *     *     *    *    *    *    *    *    *    *                   * 35160021
*  *           *DISPOSITION   *SEVERITY * MESSAGE *                   * 35240021
*  * BITS ZERO *  0 TO 3      * 0 TO 4  *         *                   * 35320021
*  * TO 12 = 0 * (OPTIONAL)   *         * NUMBER  *                   * 35400021
*  *     *     *    *    *    *    *    *    *    *                   * 35480021
*                                                                     * 35560021
*              DISPOSITION     SEVEVERITY  MESSAGE NUMBER             * 35640021
*                =4 BITS          =4 BITS      =8 BITS                * 35720021
*                                                                     * 35800021
*  TO LOG A CARD  R0 IS SET TO ZERO.(DISPOSITION AND SEVERITY = ZERO  * 35880021
*  A DISPOSITION OF 1 = INCLUDE INPUT BUFFER IN MESSAGE(CARD IMAGE)   * 35960021
*  A DISPOSITION OF 2 = INCLUDE SYMBOL(ADDRESS IN R1) IN MESSAGE      * 36040021
*  A DISPOSITION OF 3 = INCLUDE 2 SYMBOLS(ADD IN R1 AND R13/          * 36120021
*                                                                     * 36200021
*  SEVERITY 1 = A CONDITION THAT MAY CAUSE AN ERROR DURING EXECUTION  * 36280021
*  OF THE OUTPUT MODULE. A MODULE MAP OR CROSS REFERENCE TABLE IS PRO-* 36360021
*  DUCED IF SPECIFIED BY THE PROGRAMMER. THE OUTPUT MODULE IS MARKED  * 36440021
*  EXECUTABLE                                                         * 36520021
*                                                                     * 36600021
*  SEVERITY 2 =  AN ERROR THAT COULD MAKE EXECUTION OF THE OUTPUT MOD-* 36680021
*  ULE IMPOSSIBLE. PROCESSING CONTINUES. A MODULE MAP OR CROSS        * 36760021
*  REFERENCE TABLE IS PRODUCED IF SO SPECIFIED BY THE PROGRAMMER. THE * 36840021
*  OUTPUT MODULE IS MARKED NOT EXECUTABLE UNLESS THE 'LET' OPTION HAS * 36920021
*  BEEN SPECIFIED                                                     * 37000021
*                                                                     * 37080021
*  SEVERITY 3 = AN ERROR THAT COULD MAKE EXECUTION OF THE OUTPUT MOD- * 37160021
*  ULE IMPOSSIBLE. LINKAGE EDITOR PROCESSING CONTINUES. A MODULE MAP  * 37240021
*  OR CROSS REFERENCE TABLE IS PRODUCED IF REQUESTED. THE OUTPUT MOD- * 37320021
*  ULE IS MARKED 'NOT EXECUTABLE'.                                    * 37400021
*                                                                     * 37480021
*  SEVERITY 4 = A CONDITION FROM WIHCH NO RECOVERY IS POSSIBE.        * 37560021
*  PROCESSING CONTINUES.                                              * 37640021
*                                                                     * 37720021
*  THE ERROR DIAGNOSTIC ROUTINE WILL SET A BIT IN A BIT-MAP THAT WILL * 37800021
*  BE SCANNED BY THE FINAL PROCESSOR. THE FINAL PROCESSOR WILL OUTPUT * 37880021
*  ONLY THOSE ERROR MESSAGES THAT HAVE BEEN DETECTED WITHIN THE EDITOR* 37960021
*                                                                     * 38040021
*  THE ERROR DIAGNOSTIC ROUTINE WILL UPDATE THE LINE COUNT INDICATOR  * 38120021
*  IN THE ALL PURPOSE TABLE. IT WILL SKIP TO A NEW PAGE WHEN THE LINE * 38200021
*  COUNT EQUALS ZERO(MAXIMUM NUMBER OF LINES = 55)                    * 38280021
*              *                   *              *                   * 38360021
         SPACE 1                                                 S21016 38440021
**************  SYMBOLIC EQUATES FOR IDR SUPPORT  ************** S21016 38520021
POS12    EQU   12                      DISPLACEMENT OF 12 BYTES  S21016 38600021
NODISP   EQU   0                       NULL DISPLACEMENT         S21016 38680021
LEN80    EQU   80                      LENGTH OF A CARD IMAGE    S21016 38760021
MXIII    EQU   63                      SIXTY-THREE               S21016 38840021
LOGIDNT  EQU   X'20'                   SWITCH INDICATING A CARD  S21016 38920021
*                                      IMAGE TO BE LOGGED IS     S21016 39000021
*                                      NOT IN THE INPUT BUFFER   S21016 39080021
*                                      BUT IS POINTED TO BY R1   S21016 39160021
         SPACE 1                                                 S21016 39240021
HEWLFLOG EQU   *                                                        39320021
         USING LOG01,12                                                 39400021
         STM   R11,R1,SPACES+12                                         39480021
         BALR  12,0                                                     39560021
*TEST IF THIS SEVERITY CODE IS HIGHEST RECEIVED                         39640021
LOG01    SRL   R0,12          ISOLATE DISPOSITION                       39720021
         STC   R0,HEWLEDE1        SAVE DISPOSITION                      39800021
         NI    HEWLEDE1+2,X'0F'   ISOLATE SEVERITY                      39880021
         CLC   HEWLEDE1+2(1),HISEV+1 COMPARE IF NEW SEVERITY CODE IS    39960021
*                                       GREATER                         40040021
         BC    4,LOG02                                                  40120021
         MVC   HISEV+1(1),HEWLEDE1+2 RESET SEVERITY CODE TO NEW HIGH    40200021
LOG02    L     R0,HEWLEDE1                                              40280021
         STH   R0,X+8                                                   40360021
         SR    R0,R0                                                    40440021
         IC    R0,X+9  INSERT MESS NO IN R0                             40520021
         CVD   R0,X  CONVERT MESS NO TO DECIMAL                         40600021
         UNPK  X+5(3),X+6(2)  CONVERT MESS NO TO ALPHA-NUM.             40680021
         MVZ   X+7(2),X+5  MOVE ZONE BITS TO LAST BYTE OF MESS NO.+S.C. 40760021
         MVC   X+1(4),DUMH MOVE CONTROL CHAR. AND IDENTIFIER            40840021
*                          HEADER WITH MESS NO. AND S.C. NOW COMPLETE   40920021
*IT MUST NOW BE DETERMINED IF ANY ADDITIONAL ACTION IS REQUIRED. THE    41000021
*DISPOSITION BYTE IS NOW  TESTED. IT HAS BEEN STORED IN SAREAS          41080021
         L     R15,PRNTAD              ADDRESS OF PRINT ROUTINE         41160021
         TM    APTSWS,TSO              TSO IN EFFECT?                   41240021
         BO    TSO4                    YES - NO PAGING                  41320021
         LH    R11,LINECNT             CHECK FOR END OF PAGE            41400021
         BCT   R11,LOG07               BRANCH IF NO                     41480021
         LA    R11,NOLIN               NUMBER OF LINES PER PAGE         41560021
         L     R14,HEWLCWBB+20         ADDRESS OF PRINT BUFFER          41640021
         MVI   0(R14),X'8B'            CONTROL CHARACTER FOR RESTORE    41720021
         BALR  R14,R15                 TO PRINT ROUTINE                 41800021
LOG07    STH   R11,LINECNT             STORE UPDATED LINE COUNT         41880021
TSO4     TM    NEWSW,TERM              TERM OPTION SPEC.?               41960021
         BZ    TSO5                    NO - BRANCH                      42040021
         OI    HEWLCWBB+24,TERMWRT     SET ON TERM. WRITE SWITCH        42120021
TSO5     L     R14,HEWLCWBB+20         LOAD ADD. OF CURRNT RECRD        42200021
         L     R11,HEWLEDE1                                             42280021
         LTR   R11,R11                                                  42360021
         BC    8,LOG03                                                  42440021
         CLI   HEWLEDE1,X'02'                                           42520021
         BC    2,LOG04     DISPOSITION EQ 3, OUTPUT TWO SYMBOLS         42600021
         BC    8,LOG05     DISPOSITION EQ 2, OUTPUT ONE SYMBOL          42680021
         CLI   HEWLEDE1,X'01'                                           42760021
         BC    4,LOG010    DISPOSITION EQ 0, NO ACTION                  42840021
*LOG03 IS DISPOSITION 1, OUTPUT CARD IMAGE                              42920021
*THE FOLLOWING CODE HANDLES THE OUTPUTTING OF CARD IMAGES               43000021
LOG03    TM    IDRSWS,LOGIDNT          IS THE CARD IMAGE ADDRESS S21016 43080021
*                                      IN REGISTER 1?            S21016 43160021
         BZ    LOG03A                  IF NOT, BRANCH            S21016 43240021
         MVC   POS12(LEN80,R14),NODISP(R1)  MOVE CARD IMAGE TO   S21016 43320021
*                                      PRINT BUFFER              S21016 43400021
         B     LOG010                  GO TO PRINT THE MESSAGE   S21016 43480021
LOG03A   L     R11,HEWLCLAC            ADDRESS OF READ CONTROL   S21016 43560021
*                                      BLOCK                     S21016 43640021
         L     R11,CURBUF(0,R11)       ADDRESS OF CURRENT INPUT BUFFER  43720021
         MVC   12(80,R14),0(R11)       MOVE CARD IMAGE TO PRINT BUFFER  43800021
         B     LOG010                                                   43880021
*IF ENTERED AT LOG3 TWO SYMBOLS ARE FORMATTED, AT LOG4 ONLY 1 SYMBOL    43960021
LOG04    MVC   20(8,R14),0(R13)                                         44040021
LOG05    L     R1,SPACES+36            RESTORE CONTINETS OF REGISTER 1  44120021
         MVC   10(8,R14),0(R1)                                          44200021
LOG010   MVC   0(8,R14),X+1   MOVE HEADER TO MESS. BUF. AREA            44280021
         BALR  R14,R15                 TO PRINT ROUTINE                 44360021
*A BIT IS NOW SET TO TELL THE FINAL PROCESSOR WHAT MESSAGE TO OUTPUT    44440021
         LA    R15,1                                                    44520021
         SR    R14,R14                                                  44600021
          CLI   HEWLEDE1+3,MXIII       IS MSG NO. > 63 ?         S21016 44680021
          BH    MAP2                   IF SO, BRANCH             S21016 44760021
         MVC   S+3(1),HEWLEDE1+3                                        44840021
S        SLDL  R14,0                                                    44920021
         SRDL  R14,1                                                    45000021
         O     R14,BITMAP                                               45080021
         O     R15,BITMAP+4                                             45160021
         STM   R14,R15,BITMAP                                           45240021
          B     BYPASS                 BRNCH AROUND BITMAP2 CODE S21016 45320021
MAP2      IC    R14,HEWLEDE1+3         GET MESSAGE NUMBER        S21016 45400021
          S     R14,SIXTY3             SUBTRACT 63               S21016 45480021
          STC   R14,HEWLEDE1+3         STORE MESSAGE NUMBER-63   S21016 45560021
          SR    R14,R14                ZERO REGISTER             S21016 45640021
          MVC   S2+3(1),HEWLEDE1+3     MOVE MSG.NO. - 63 TO      S21016 45720021
*                                      SHIFT INSTRUCTION         S21016 45800021
S2        SLDL  R14,0                  SHIFT ONE-BIT TO POSITION S21016 45880021
          SRDL  R14,1                  CORRESPONDING TO MSG.NO.  S21016 45960021
          O     R14,BITMAP2            TURN ON APPROPRIATE       S21016 46040021
          O     R15,BITMAP2+4          BIT AND STORE             S21016 46120021
          STM   R14,R15,BITMAP2        IN BITMAP2                S21016 46200021
          B     BYPASS                 BRANCH AROUND CONSTANT    S21016 46280021
SIXTY3    DC    A(63)                  VALUE 63 FOR SUBTRACT     S21016 46360021
BYPASS    EQU   *                                                S21016 46440021
         CLI   HEWLEDE1+2,X'03'                                         46520021
         BC    2,LOG014  ABORT                                          46600021
         BC    8,LOG012   SET NOT EXECUTABLE                            46680021
         CLI   HEWLEDE1+2,X'02'                                         46760021
         BC    4,LOG013  NORMAL RETURN                                  46840021
*TEST IF EXECUTE OPTION IS SPECIFIED                                    46920021
*THIS MEANS SEVERITY CODE WAS 2                                         47000021
         TM    APT0,LETON                                               47080021
         BC    1,LOG013                                                 47160021
LOG012   NI    PDSE7,NOEX                                               47240021
LOG013   LM    R11,R1,SPACES+12                                         47320021
         LR    R15,R14                                                  47400021
         BCR   15,R15                                                   47480021
LOG014   L     15,ADD1             TRANSFER TO FINAL PROCESSOR TO ABEND 47560021
         NI    PDSE7,NOEX         SET NO EXEC BIT IN APT                47640021
         BALR  14,15                                                    47720021
         DC    V(HEWLFMAP)                                              47800021
HEWLCADA DC    V(HEWLFADA)                                              47880021
         DC    V(HEWLENAM)                                              47960021
         DC    V(HEWLCFNI)                                              48040021
         DC    V(HEWLCEOI)                                              48120021
         DC    V(HEWLFINP)                                              48200021
         DC    V(HEWLFSCD)                                              48280021
DCB      DC    A(HEWLCPDB)                                              48360021
ADD1     DC    V(HEWLCFAB)                                              48440021
PRNTAD   DC    A(HEWLEPNT)         ADDRESS OF PRINT ROUTINE             48520021
         DC    V(HEWLFFNL)                                              48600021
TERMEXIT DC    X'85'                   END FLAG                         48680021
         DC    AL3(TERMEX)             SYSTERM EXIT ADDRESS             48760021
APTELIST DC    X'85'                                                    48840021
         DC    AL3(HEWLXIT1)                                            48920021
APTEXLST DC    X'85'                   EXIT LIST--END AND DCB EXIT      49000021
         DC    AL3(HEWLEXIT)  ADR OF INPUT EXIT                         49080021
APTXLIST DC   X'05'                                                     49160021
         DC    AL3(HEWLXIT2)                                            49240021
         DC    X'87'                                                    49320021
         DC    AL3(0)                                                   49400021
DUMH     DC    X'09'                   CARRIAGE CONTROL PRINT AND SPACE 49480021
         DC    C'IEW'                                                   49560021
         DS    0D                                                       49640021
X        DS    5H                                                       49720021
TEST     DC    A(MSGFOUR)                                               49800021
         DS    0F                                                       49880021
*        DC FOR MAJOR AND MINOR NAMES FOR SYSLMOD ENQ,DEQ               49960021
ENQNAME  DC    C'SYSIEWLP'                                              50040021
MINOR    DC    44C' '                                                   50120021
         TITLE 'VALIDITY CHECK ROUTINE'                                 50130002
*                                                       OX04280,OY03413 50140002
* THIS SUBROUTINE SCANS THE MEMBER NAME AND ALIAS       OX04280,OY03413 50170002
* NAMES FOR VALID CHARACTERS                            OX04280,OY03413 50180002
* THE SUBROUTINE IS CALLED BY SCN DURING THE            OX04280,OY03413 50184002
* PROCESSING OF NAME AND ALIAS CONTROL STATEMENTS AND   OX04280,OY03413 50186002
* BY FNL WHEN THE MEMBER NAME IS TAKEN FROM THE         OX04280,OY03413 50188002
* SYSLMOD DD STATEMENT (VIA THE DEB)                    OX04280,OY03413 50188402
* INPUT - REGISTER 9 CONTAINS A POINTER TO THE          OX04280,OY03413 50188802
*         CHARACTER STRING                              OX04280,OY03413 50189202
* OUTPUT - A ZERO VALUE IN REGISTER 9 INDICATING        OX04280,OY03413 50189602
*          A VALID NAME                                 OX04280,OY03413 50189702
*        - A NONZERO VALUE IN REGISTER 9 INDICATING     OX04280,OY03413 50189802
*          AN INVALID NAME                              OX04280,OY03413 50189902
*                                                       OX04280,OY03413 50190602
THISCHR  EQU   9                       POINTS TO PRESENT CHAR. AND      50192102
*                                      SCNDS BASE                A37667 50192202
LASTCHR  EQU   10                      POINTS TO LAST CHAR       A37667 50192302
FSTCHAR  EQU   X'02'                   WORKING ON 1ST CHARACTER  A37667 50192702
NOTFST   EQU   X'FD'                   NOT FIRST CHARACTER       A37667 50194702
         USING VLDCHAR,REG15                            OX04280,OY03413 50194802
VLDCHAR  ST    LASTCHR,SAVR            SAVE REG 10               A37667 50194902
HEWVLDCK EQU   VLDCHAR                                                  50195302
         USING SCNDS,THISCHR                                     A37667 50195502
         LA    LASTCHR,LAST            PICK UP ADDR OF LAST CHAR A37667 50196402
         MVI   OPT2,FSTCHAR            TURN ON FIRST CHAR SWITCH A37667 50198002
* THE FOLLOWING CODE IS CHARACTER DEPENDENT                      A37667 50198402
VALIDLP  CLI   THIS,C'Z'               IS CHAR GREATER THAN 'Z'  A37667 50198802
         BH    CHAR1                   YES, CHECK IF 1ST CHAR    A37667 50199202
         CLI   THIS,C'S'               SI IT 'S' OR  GREATER     A37667 50199602
         BNL   CHAROK                  YES, SO VALID CHAR        A37667 50199702
         CLI   THIS,C'R'               IS CHAR GREATER THAN 'R'  A37667 50199902
         BH    CHARERR                 YES, ERROR                A37667 50200002
         CLI   THIS,C'J'               IS IT 'J' OR  GREATER     A37667 50226602
         BNL   CHAROK                  YES, SO VALID CHAR        A37667 50236602
         CLI   THIS,C'I'               IS CHAR GREATER THAN 'I'  A37667 50246602
         BH    CHARERR                 YES, ERROR                A37667 50248602
         CLI   THIS,X'C0'              IS IT 12-0 PUNCH OR GTR    M0556 50250602
         BNL   CHAROK                  YES, SO VALID CHAR        A37667 50252602
         CLI   THIS,C'@'               IS CHAR '@'?              A37667 50253002
         BE    CHAROK                  YES, VALID                A37667 50253102
         CLI   THIS,C'#'               IS IT '#'                 A37667 50253202
         BE    CHAROK                  YES, SO VALID CHAR        A37667 50262102
         CLI   THIS,C'$'               IS IT '$'                 A37667 50264102
         BE    CHAROK                  YES, SO VALID CHAR        A37667 50266102
CHAR1    TM    OPT2,FSTCHAR            IS THIS THE 1ST CHAR      A37667 50268102
         BO    CHARERR                 YES, SO ERROR             A37667 50270102
         CLI   THIS,C'9'               IS IT GREATER THAN '9'    A37667 50270502
         BH    CHARERR                 YES, SO INVALID           A37667 50270902
         CLI   THIS,C'0'               IS IT LESS THAN '0'       A37667 50271002
         BL    CHARERR                 YES, SO INVALID           A37667 50293202
CHAROK   NI    OPT2,NOTFST             TURN OFF FIRST CHAR BIT   A37667 50303202
         LA    THISCHR,NEXT            UPDATE PTR                A37667 50313202
         CR    THISCHR,LASTCHR         HAVE WE FINISHED          A37667 50315202
         BH    VALIDOUT                YES                       A37667 50315302
         CLI   THIS,C' '               IS THIS DELIM    OX04280,OY03413 50315402
         BE    VALIDOUT                YES, SO FINISHED          A37667 50315502
         B     VALIDLP                 CONTINUE                  A37667 50322902
VALIDOUT SR    THISCHR,THISCHR         INDICATE   VALID NAME     A37667 50324902
CHARERR  L     LASTCHR,SAVR            RESTORE REGS              A37667 50328902
         BR    R14                     RETURN                    A37667 50338902
OPT2     DC    X'00'               FOR CHECKING VALID CHARACTERS A37667 50339302
SAVR     DS    F                      SAVE AREA REG14   OX04280,OY03413 50339702
         DROP  REG15                                    OX04280,OY03413 50349702
         TITLE  'HEWLFROU  TABLE ALLOCATION ROUTINE'                    50352602
         ENTRY HEWLFALK                                                 50360021
*********************************************************************   50440021
*                                                                    *  50520021
*        HEWLFALK--TABLE ALLOCATION ROUTINE                          *  50600021
*                                                                    *  50680021
**********************************************************************  50760021
*                                                                    *  50840021
*        STATUS:  AOS/1,AOS/2--RELEASE 1                             *  50920021
*                                                                    *  51000021
*        FUNCTION :                                                  *  51080021
*              TO ALLOCATE TABLES USED BY THE LINKAGE EDITOR,        *  51160021
*              AND TO EXPAND THEM TO THEIR MAXIMUM SIZES             *  51240021
*              WHEN A TABLE OVERFLOW SITUATION OCCURS.               *  51320021
*                                                                    *  51400021
*                                                                    *  51480021
*        ENTRY POINT : HEWLFALK                                      *  51560021
*              1) RECEIVING CONTROL FROM HEWLFINT FOR                *  51640021
*                 INITIAL ALLOCATION                                 *  51720021
*              2) RECEIVING CONTROL FROM HEWLFINP,HEWLFESD,          *  51800021
*                 HEWLFRAT,HEWLFADA,HEWLFREL FOR REALLOCATION.       *  51880021
*                                                                    *  51960021
*        EXTERNAL REFERENCES : NONE                                  *  52040021
*                                                                    *  52120021
*        INPUT :                                                     *  52200021
*              REGISTER 2 CONTAINS THE ADDR OF HEWLFAPT              *  52280021
*              REGISTER 14 CONTAINS THE RETURN ADDRESS.              *  52360021
*                                                                    *  52440021
*        OUTPUT : NONE                                               *  52520021
*                                                                    *  52600021
*        EXIT NORMAL : TO CALLING ROUTINE                            *  52680021
*                                                                    *  52760021
*        EXIT ERROR : NONE                                           *  52840021
*                                                                    *  52920021
*        TABLES/WORK AREAS :                                         *  53000021
*              HEWLFAPT    - LINKAGE EDITOR COMMUNICATION AREA       *  53080021
*              ALOCTABL - ALLOCATION TABLE                           *  53160021
*              TMPADRSV - TEMPORARY TABLE ADDR SAVE AREA             *  53240021
*                                                                    *  53320021
*        ATTRIBUTES : SERIALLY REUSABLE,PROBLEM PROGRAM MODE ,ENABLED*  53400021
*                                                                    *  53480021
*        NOTES : ALL REGISTERS SAVED BY THE CALLING ROUTINE          *  53560021
*                                                                    *  53640021
*********************************************************************   53720021
         EJECT                                                          53800021
*********************************************************************   53880021
*                                                                    *  53960021
*        EQUATES FOR REGISTERS                                       *  54040021
*                                                                    *  54120021
*********************************************************************   54200021
REG0     EQU   0                       REGISTER 0                       54280021
TABLPT2  EQU   1                       TEMPORARY ADDR SAVE AREA PT      54360021
APTBASE  EQU   2                       BASE REG FOR APT                 54440021
INDXRG   EQU   3                       INDEX REGISTER                   54520021
ALOCPT   EQU   4                       ALLOCATING ADDR                  54600021
TABLPT1  EQU   5                       ALLOCATION TABLE PT              54680021
WORK1    EQU   7                       WORK REGISTER                    54760021
WORK2    EQU   8                       WORK REGISTER                    54840021
WORK3    EQU   9                       WORK REGISTER                    54920021
BYTSPRWT EQU   11                      BYTES PER WEIGHT                 55000021
BASE     EQU   12                      BASE REGISTER                    55080021
RETURN   EQU   14                      RETURN REGISTER                  55160021
         SPACE 3                                                        55240021
*********************************************************************   55320021
*                                                                    *  55400021
*        MISCELLANEOUS OFFSETS AND MASKS                             *  55480021
*                                                                    *  55560021
*********************************************************************   55640021
         SPACE 2                                                        55720021
O        EQU   0                       ZERO                             55800021
I        EQU   1                       ONE                              55880021
IV       EQU   4                       DECIMAL VALUE 4                  55960021
VIII     EQU   8                       DECIMAL VALUE 8                  56040021
TENN     EQU   10                      DECIMAL VALUE 10                 56120021
IO       EQU   X'10'                   HEX 10                           56200021
EO       EQU   X'E0'                   HEX E0                           56280021
FO       EQU   X'F0'                   HEX F0                           56360021
FF       EQU   X'FF'                   HEX FF                           56440021
ENDFLG   EQU   X'FF'                   END INDICATOR OF ALLOC TABLE     56520021
HEX100   EQU   256                     HEX 100                          56600021
OVERBIT  EQU   X'20'                   OVERLAY                          56680021
HIARCHY  EQU   X'04'                   HIARCHY SPECIFIED                56760021
         EJECT                                                          56840021
*********************************************************************   56920021
*                                                                    *  57000021
*        ALLOCATION OF ADDRESSES AND SIZES OF TABLES                 *  57080021
*                                                                    *  57160021
*********************************************************************   57240021
         SPACE 3                                                        57320021
HEWLFALK BALR  BASE,0                   ESTABLISH    ROUTINE            57400021
         USING *,BASE                  ADDRESSABILITY                   57480021
         USING APTDSECT,APTBASE        ADDRESSABILITY FOR APT           57560021
         XR    BYTSPRWT,BYTSPRWT       INITIALIZE BYTES PER WEIGHT      57640021
         MVC   CSNOSV(4),CSNO          GET CURRENT SEGMENT NUMBER       57720021
         MVC   TTRLIST(4),HEWLCRBB+IV  INITIALIZE TTR LIST ADDR         57800021
         MVC   TOTALWT,SIMPLWT         INITIALIZE TOTAL WEIGHT          57880021
         TM    SAVATS,OVERBIT          IS OVLY SPECIFIED                57960021
         BO    TBAL001                 YES,BRANCH OUT                   58040021
         TM    NEWSW,HIARCHY           IS HIARCHY SPECIFIED      S01904 58120021
         BZ    TBAL010                 NO,BRANCH OUT             S01904 58200021
         MVC   TOTALWT,HIARWT          INITIALIZE TOTAL WEIGHT   S01904 58280021
         MVI   TBAL101A+I,O            HIARCHY TABLE IS ALLOC    S01904 58360021
         B     TBAL010                 BRANCH OUT                S01904 58440021
TBAL001  MVI   TBAL101+I,O             OVLY TBL WILL BE ALLOC    S01904 58520021
         MVC   TOTALWT,OVLYWT          INITIALIZE WEIGHT         S01904 58600021
TBAL010  TM    APT4,REALOCTE           IS THIS REALLOCATION      S01904 58680021
         BZ    TBAL020                 NO,BRANCH OUT             S01904 58760021
         L     BYTSPRWT,FFCADR         GET HIGHEST ADDR GETMAINED       58840021
         S     BYTSPRWT,HIGHSV         SIZE OF CORE FOR TBL ALLOC       58920021
         N     BYTSPRWT,DBLWRD         DOUBLE WORD BDY ALIGNMENT        59000021
         XR    BYTSPRWT-I,BYTSPRWT-I  INITIALIZE FOR DIVISION           59080021
         D     BYTSPRWT-I,TOTALWT      CALCULATE BYTES PER WEIGHT       59160021
TBAL020  LA    TABLPT1,ALOCTABL        INITIALIZE ALLOC TBL      S01904 59240021
         LA    TABLPT2,TMPADRSV        INIT TBL ADDR SAVEAREA    S01904 59320021
         MVC   FSTPHIGH,TXTBFEND       INITIALIZE ALL            S01904 59400021
         MVC   INTPHIGH(VIII),FSTPHIGH  ALLOCATING ADDR          S01904 59480021
TBAL100  XR    INDXRG,INDXRG           ZERO OUT INDEX REG        S01904 59560021
         TM    FLG2(TABLPT1),HIARSW    TABLE FOR HIARCHY         S01904 59640021
TBAL101A BO    TBAL250       COND BRANCH SET DYNAMICALLY         S01904 59720021
         TM    FLG1(TABLPT1),OVLY      IS TBL USED FOR OVLY      S01904 59800021
TBAL101  BO    TBAL250       COND BRANCH SET DYNAMICALLY         S01904 59880021
         L     ALOCPT,FSTPHIGH         ALLOCATING ADDR=1ST PASS HIGH    59960021
         TM    FLG1(TABLPT1),FRSTPS IS TABLE USED FOR 1ST PASS          60040021
         BO    TBAL110                 YES,BRANCH OUT            S01904 60120021
         L     ALOCPT,SCDPHIGH         ALLOC ADDR=INTR PASS HIGH S01904 60200021
TBAL110  TM    FLG1(TABLPT1),INTRPS  IS TBL USED FOR INTR PASS   S01904 60280021
         BZ    TBAL120                 NO,BRANCH OUT             S01904 60360021
         C     ALOCPT,INTPHIGH         ALLOC ADDR>INTR PASS HIGH S01904 60440021
         BNL   TBAL120       YES,BRANCH OUT                      S01904 60520021
         L     ALOCPT,INTPHIGH         NO,ALLOC ADDR=INTR PASS HIGH     60600021
TBAL120  TM    FLG1(TABLPT1),SCDPS     IS TABLE USED IN 2ND PASS S01904 60680021
         BZ    TBAL200                 NO,BRANCH OUT             S01904 60760021
         C     ALOCPT,SCDPHIGH         ALLOC ADDR>2ND PASS HIGH  S01904 60840021
         BNL   TBAL200                 YES,BRANCH OUT            S01904 60920021
         L     ALOCPT,SCDPHIGH         NO,ALLOC ADDR=2ND PASS HIGH      61000021
TBAL200  TM    FLG1(TABLPT1),ZERONTRY  PREFIX NEEDED             S01904 61080021
         LR    REG0,ALOCPT             SAVE ALLOC ADDR TEMPORARY S01904 61160021
         BZ    TBAL201                 NO,BRANCH OUT             S01904 61240021
         IC    INDXRG,BYTS(TABLPT1)    YES,GET BYTES PER ENTRY   S01904 61320021
         SR    ALOCPT,INDXRG           DECREMENT ALLOC ADDR      S01904 61400021
TBAL201  TM    APT4,REALOCTE           REALLOCATION?             S01904 61480021
         BM    TBAL400                 YES,BRANCH OUT            S01904 61560021
TBAL203  IC    INDXRG,ADDR(TABLPT1)    GET TABLE ADDR INDEX      S01904 61640021
         ST    ALOCPT,CSNO(INDXRG)     SAVE TABLE ADDR IN APT    S01904 61720021
TBAL204  LR    ALOCPT,REG0             RESTORE ALLOCATING ADDR   S01904 61800021
         LR    WORK1,BYTSPRWT          GET BYTES PER WEIGHT      S01904 61880021
         MH    WORK1,WEIT(TABLPT1)     CALCULATE SIZE TO BE EXPANDED    61960021
         AH    WORK1,MIN(TABLPT1)      ADD TO MIN SIZE OF TABLE  S01904 62040021
         TM    FLG1(TABLPT1),CUTOFF    IS THERE A LIMIT TO SIZE  S01904 62120021
         BZ    TBAL210                 NO,BRANCH OUT             S01904 62200021
         TM    FLG1(TABLPT1),SCDPS     IS TABLE USED FOR 2ND PASS       62280021
         BO    TBAL205                 YES,BRANCH OUT            S01904 62360021
         C     WORK1,SZSYSUT1          NO,COMPARE WITH SYSUT1 TRK SIZE  62440021
         BL    TBAL210                 LOW,NO FIX NEEDED         S01904 62520021
         L     WORK1,SZSYSUT1          PICK UP TRACK SIZE        S01904 62600021
         N     WORK1,DBLWRD            FORCE TO DBL WORD BDY     S01904 62680021
TBAL205  LA    WORK3,IV                GET DECIMAL VALUE FOUR    S01904 62760021
         M     WORK3-I,SZSYSUT1        MULTIPLY TRACK SIZE BY 4  S01904 62840021
         CR    WORK1,WORK3             COMPARE WITH ALLOC SIZE   S01904 62920021
         BL    TBAL210                 LOW,BRANCH OUT            S01904 63000021
         LR    WORK1,WORK3             FIX SIZE                  S01904 63080021
         N     WORK1,DBLWRD            FORCE TO DBL WORD BDY     S01904 63160021
TBAL210  LA    ALOCPT,O(WORK1,ALOCPT)  UPDATE ALLOC ADDR         S01904 63240021
         LA    ALOCPT,8(ALOCPT)        FORCE TO NEXT HIGHER      S01904 63320021
         N     ALOCPT,DBLWRD           DOUBLE WORD BDY           S01904 63400021
         TM    FLG1(TABLPT1),FRSTPS    TABLE USED IN 1ST PASS    S01904 63480021
         BZ    TBAL220                 NO,BRANCH OUT             S01904 63560021
         ST    ALOCPT,FSTPHIGH         UPDATE 1ST PASS HIGH      S01904 63640021
TBAL220  TM    FLG1(TABLPT1),INTRPS    IS TABLE FOR INTR PASS    S01904 63720021
         BZ    TBAL230                 NO,BRANCH OUT             S01904 63800021
         ST    ALOCPT,INTPHIGH         YES,UPDATE INTR PASS HIGH S01904 63880021
TBAL230  TM    FLG1(TABLPT1),SCDPS     TABLE USED IN 2ND PASS    S01904 63960021
         BZ    TBAL240                 NO,BRANCH OUT             S01904 64040021
         ST    ALOCPT,SCDPHIGH         YES,UPDATE 2ND PASS HIGH  S01904 64120021
TBAL240  IC    INDXRG,BYTS(TABLPT1)    PICK UP NO OF BYTES PER ENTRY    64200021
         XR    WORK1-I,WORK1-I         CLEAR REG FOR DIVISION    S01904 64280021
         DR    WORK1-I,INDXRG          CALCULATE MAX NO OF ENTRIES      64360021
         C     WORK1,MAXENTRY          LESS THAN 32K?   OX05441,OY05016 64440002
         BNH   TBAL245                 YES, CONTINUE    OX05441,OY05016 64490002
         L     WORK1,MAXENTRY          ELSE SET TO MAX ALLOWED  OY05016 64500002
TBAL245  EQU   *                                        OX05441,OY05016 64510002
         IC    INDXRG,ENTRY(TABLPT1)   PICK UP ENTRY ADDR INDEX  S01904 64520021
         STH   WORK1,CSNO(INDXRG)      STORE MAX NO OF ENTRIES   S01904 64600021
TBAL250  LA    TABLPT1,TENN(TABLPT1)   UPDATE ALLOCATION PTR     S01904 64680021
         TM    O(TABLPT1),ENDFLG       END OF TABLE REACHED      S01904 64760021
         BNO   TBAL100                 NO,CONTINUE ALLOCATION    S01904 64840021
TBAL260  TM    APT4,REALOCTE           REALLOCATION?             S01904 64920021
         BM    TBAL300                 YES,BRANCH OUT            S01904 65000021
         CLC   SCDPHIGH+1(3),INTPHIGH+1  2ND PASS HIGH>INTR PASS HIGH   65080021
         BH    TBAL260A                YES,BRANCH OUT            S01904 65160021
         MVC   HIGHSV+1(3),INTPHIGH+1  SAVE HIGHER ADDR          S01904 65240021
         B     TBAL901                 EXIT                      S01904 65320021
TBAL260A MVC   HIGHSV+1(3),SCDPHIGH+1  USE 2ND PASS HIGH         S01904 65400021
         B     TBAL901                 EXIT                      S01904 65480021
         EJECT                                                          65560021
*********************************************************************   65640021
*                                                                    *  65720021
*        MOVING AND CLEARING TABLES AFTER REALLOCATION               *  65800021
*                                                                    *  65880021
********************************************************************    65960021
         SPACE 3                                                        66040021
TBAL300  SH    TABLPT2,FOUR            UPDATE TABLE PTR          S01904 66120021
TBAL301  SH    TABLPT1,TEN             UPDATE TABLE PTR          S01904 66200021
         TM    FLG1(TABLPT1),ENDMOVE   NO MORE MOVE REQUIRED     S01904 66280021
         BO    TBAL900                 NO MORE,BRANCH OUT        S01904 66360021
         TM    FLG1(TABLPT1),MOVETBL   TABLE HAS TO BE MOVED     S01904 66440021
         BZ    TBAL301                 NO,BRANCH OUT             S01904 66520021
         NI    FLG1(TABLPT1),FF-MOVETBL  RESET SWITCH            S01904 66600021
         IC    INDXRG,ADDR(TABLPT1)    GET TABLE ADDR INDEX      S01904 66680021
         L     WORK2,CSNO(INDXRG)      PICK UP OLD TABLE ADDR    S01904 66760021
         L     WORK3,O(TABLPT2)        PICK UP NEW TABLE ADDR    S01904 66840021
         ST    WORK3,CSNO(INDXRG)      STORE NEW TABLE ADDR IN APT      66920021
         IC    INDXRG,CURNTRY(TABLPT1) GET CURRENT NO OF ENTRIES INDEX  67000021
         LH    WORK1,CSNO(INDXRG)      PICK UP CORRENT NO OF ENTRIES    67080021
         TM    FLG1(TABLPT1),ZERONTRY  IS THERE A PREFIX         S01904 67160021
         BZ    TBAL310                 NO,BRANCH OUT             S01904 67240021
         LA    WORK1,I(WORK1)          YES,INCREMENT NO OF ENTRIES      67320021
TBAL310  IC    INDXRG,BYTS(TABLPT1)    GET NO OF BYTES PER ENTRY S01904 67400021
         MR    WORK1-I,INDXRG          BYTES TO BE MOVED         S01904 67480021
         AR    WORK2,WORK1                                       S01904 67560021
         AR    WORK3,WORK1                                       S01904 67640021
         XR    WORK1-I,WORK1-I         CLEAR REG BEFORE DIVISION S01904 67720021
         D     WORK1-I,HEXI00          DIVIDE BY 256             S01904 67800021
         LTR   WORK1,WORK1             QUOTIENT EQUAL TO ZERO    S01904 67880021
         BZ    TBAL320                 YES,BRANCH OUT            S01904 67960021
TBAL330  S     WORK2,HEXI00                                      S01904 68040021
         S     WORK3,HEXI00                                      S01904 68120021
         MVC   MOVESV(HEX100),O(WORK2)                           S01904 68200021
         XC    O(HEX100,WORK2),O(WORK2)  CLEAR 256 BYTES AT A TIME      68280021
         MVC   O(HEX100,WORK3),MOVESV    MOVE DATA TO NEW AREA   S01904 68360021
         BCT   WORK1,TBAL330           DECREMENT QUOTIENT BY ONE S01904 68440021
TBAL320  LTR   WORK1-I,WORK1-I         IS THE REMAINDER ZERO     S01904 68520021
         BZ    TBAL300                 GO TO PROCESS NEXT ENTRY  S01904 68600021
         SR    WORK2,WORK1-I                                     S01904 68680021
         SR    WORK3,WORK1-I                                     S01904 68760021
         BCTR  WORK1-I,REG0            NO,DECREMENT BY 1 FOR EX  S01904 68840021
         EX    WORK1-I,MOVEINST        MOVE THAT MANY BYTES      S01904 68920021
         EX    WORK1-I,MOVEINSA                                  S01904 69000021
         EX    WORK1-I,CLEAR           CLEAR THAT MANY BYTES     S01904 69080021
         B     TBAL300                 GO PROCESS NEXT TABLE     S01904 69160021
MOVEINST MVC   MOVESV(I),O(WORK2)                                S01904 69240021
MOVEINSA MVC   O(I,WORK3),MOVESV                                 S01904 69320021
CLEAR    XC    O(O,WORK2),O(WORK2)     CLEAR INSTRUCTION FOR EX  S01904 69400021
         EJECT                                                          69480021
********************************************************************    69560021
*              RETURN TO CALLING ROUTINE                            *   69640021
********************************************************************    69720021
         SPACE 3                                                        69800021
TBAL900  OI    APT4,REALOCTD           REALLOCATION DONE         S01904 69880021
**********************************************************************  69960021
*         THE FOLLOWING CODE UPDATES THE APT TO REFLECT              *  70040021
*         THE CHANGES IN  REALLOCATING THE IDR TABLES .              *  70120021
*         THE ADDRESS OF THE NEXT AVAILABLE ENTRY IS CALCULATED      *  70200021
*         AND STORED IN THE APT - IDRXXEND.                          *  70280021
**********************************************************************  70360021
         L     WORK1,IDRTRTAB          GET ADDR OF IDRTR TABLE   S01904 70440021
         AH    WORK1,IDRTRCUR          COMPUTE NEXT AVAIL ENTRY  S01904 70520021
         ST    WORK1,IDRTREND          STORE ADDRESS IN APT      S01904 70600021
         L     WORK1,IDRTITAB          GET ADR OF IDR TI TABLE  OX04245 70650002
         AH    WORK1,IDRTICUR          COMPUTE NEXT AVAIL ENTRY OX04245 70660002
         ST    WORK1,IDRTIEND          STORE ADDRESS IN APT     OX04245 70670002
         L     WORK1,IDRUDTAB          GET ADDR OF IDRUD TABLE   S01904 70680021
         AH    WORK1,IDRUDCUR          COMPUTE NEXT AVAIL ENTRY  S01904 70760021
         ST    WORK1,IDRUDEND          STORE ADDRESS IN APT      S01904 70840021
         L     WORK1,IDRZPTAB          GET ADDR OF IDRZP TABLE   S01904 70920021
         AH    WORK1,IDRZPCUR          COMPUTE NEXT AVAIL ENTRY  S01904 71000021
         ST    WORK1,IDRZPEND          STORE ADDRESS IN APT      S01904 71080021
**********************************************************************  71160021
         MVC   CSNO(4),CSNOSV                                    S01904 71240021
         B     TBAL901A                RETURN TO CALLING RTN     S01904 71320021
TBAL901  OI    APT4,INALOCTD           INITIAL ALLOCATION DONE   S01904 71400021
         XC    CSNO(4),CSNO            ZERO OUT NO OF SEGMENTS   S01904 71480021
         MVC   ENT1X1(4),ENT1X                                   S01904 71560021
TBAL901A MVI   TBAL101+I,IO            RESTORE BRANCH INSTR      S01904 71640021
         MVI   TBAL101A+I,IO           RESTORE BRANCH INSTR      S01904 71720021
         LH    WORK1,ENRNX             GET MAX. ENTRIES IN RNT   XM1692 71770002
         STH   WORK1,ENRNC             STORE IN CURRENT          XM1692 71780002
*                                      CURRENT NO. ENTRIES IN    XM1692 71790002
*                                      RNT MUST ALWAYS EQUAL     XM1692 71792002
*                                      MAX NO. ENTRIES SINCE     XM1692 71794002
*                                      LR PROCESSING CAN PUT     XM1692 71796002
*                                      DEPEND FLAGS IN FOR       XM1692 71798002
*                                      CESDIDS NOT YET RECEIVED  XM1692 71798402
         BR    RETURN                  RETURN TO CALLING RTN     S01904 71800021
         EJECT                                                          71880021
********************************************************************    71960021
*                                                                   *   72040021
*              CLEARING TABLES THAT NEED NOT BE MOVED               *   72120021
*                                                                   *   72200021
********************************************************************    72280021
         SPACE 3                                                        72360021
TBAL400  TM    FLG1(TABLPT1),ENDMOVE   TABLE NOT TO BE MOVED?    S01904 72440021
         BO    TBAL203                 RETURN                    S01904 72520021
         TM    FLG2(TABLPT1),NOMOVE    IS IT A BUFFER            S01904 72600021
         BO    TBAL203                 YES,GO CLEAR THE BUFFER   S01904 72680021
         IC    INDXRG,CURNTRY(TABLPT1) GET CUR NO OF ENTRIES INDEX      72760021
         LH    WORK1,CSNO(INDXRG)      PICK UP CUR NO OF ENTRIES S01904 72840021
         LTR   WORK1,WORK1             IS IT ZERO                S01904 72920021
         BZ    TBAL203                 YES,NORMAL PROCESSING     S01904 73000021
TBAL410  ST    ALOCPT,O(TABLPT2)       SAVE NEW TABLE ADDR TEMP  S01904 73080021
         LA    TABLPT2,IV(TABLPT2)     UPDATE PTR                S01904 73160021
         OI    FLG1(TABLPT1),MOVETBL   SET SWITCH TO MOVE TABLE  S01904 73240021
         B     TBAL204                 GO ALLOCATE SIZE OF TABLE S01904 73320021
         EJECT                                                          73400021
********************************************************************    73480021
*                                                                   *   73560021
*                  TABLES AND WORK AREAS                            *   73640021
*                                                                   *   73720021
********************************************************************    73800021
         SPACE 3                                                        73880021
TEN      DC    H'10'         DECIMAL VALUE 10                    S01904 73960021
FOUR     DC    H'4'          DECIMAL VALUE FOUR                  S01904 74040021
FSTPHIGH DC    F'0'          FIRST PASS ALLOC ADDR               S01904 74120021
INTPHIGH DC    F'0'          INTERMEDIATE PASS ALLOC ADDR        S01904 74200021
SCDPHIGH DC    F'0'          SECOND PASS ALLOC ADDR              S01904 74280021
HIGHSV   DC    F'0'          HIGHEST ADDRESS ASSIGNED            S01904 74360021
CSNOSV   DC    F'0'          CURRENT NUMBER OF ENTRIES           S01904 74440021
MAXENTRY DC    X'00007FFF'   MAX NO OF ENTRIES IN ANY TABLE      S01904 74520021
DBLWRD   DC    X'FFFFFFF8'   DOUBLE WORD MASK                    S01904 74600021
SIMPLWT  DC    AL4(ROUNDSIM) TOTAL WEIGHT FOR SIMPLE STRUCTURE          74680000
HIARWT   DC    AL4(ROUNHIAR) TOTAL WEIGHT FOR HIARCHY                   74760000
OVLYWT   DC    AL4(ROUNOVLY) TOTAL WEIGHT FOR OVLY                      74840000
HEXI00   DC    X'00000100'   VALUE 256                           S01904 74920021
TOTALWT  DS    F             TOTAL WEIGHT                        S01904 75000021
         EJECT                                                          75080021
*              ALLOCATION TABLE                                     *   75160021
*********************************************************************   75240021
*                                                                    *  75320021
*        OFFSETS FOR ALLOCATION TABLE ENTRIES                        *  75400021
*                                                                    *  75480021
*********************************************************************   75560021
FLG1     EQU   0                       SWITCHES                         75640021
ADDR     EQU   1                       INDEX FOR ADDR OF TABLE          75720021
ENTRY    EQU   2                       INDEX FOR MAX # OF ENTRIES       75800021
BYTS     EQU   3                       BYTES PER WEIGHT                 75880021
WEIT     EQU   4                       WEIGHT OF THE TABLE              75960021
MIN      EQU   6                       MINIMUM SIZE OF THE TABLE        76040021
CURNTRY  EQU   8                       INDEX FOR CURRENT # OF ENTRIES   76120021
FLG2     EQU   9                       SECOND FLAG                      76200021
*********************************************************************   76280021
*                                                                    *  76360021
*        MASKS IN ALLOCATION TABLE                                   *  76440021
*MASKS FOR FLG1                                                         76520021
OVLY     EQU   X'80'                   TABLE USED FOR OVERLAY ONLY      76600021
FRSTPS   EQU   X'40'                   TABLE USED IN 1ST PASS           76680021
*INTRPS  EQU   X'20'                   TABLE USED IN INTERMEDIATE PASS  76760021
*ABOVE SYMBOL DEFINED IN APT                                            76840021
*SCDPS   EQU   X'10'                   TABLE USED IN SECOND PASS        76920021
*ABOVE SYMBOL DEFINED IN APT                                            77000021
ENDMOVE  EQU   X'08'                   NO MORE MOVING NEEDED            77080021
MOVETBL  EQU   X'04'                   TABLE IS TO BE MOVED             77160021
CUTOFF   EQU   X'02'                   THERE IS A LIMIT TO THE SIZE     77240021
ZERONTRY EQU   X'01'                   THERE IS A PREFIX                77320021
*MASKS FOR FLAG2                                                        77400021
NOMOVE   EQU   X'80'                   TABLE NOT TO BE MOVED            77480021
HESDD    EQU   X'40'                   HESD ENTRY IN ALLOCATION TBL     77560021
HIARSW   EQU   X'20'                   HIERARCHY TABLE                  77640021
*******************************************************************     77720021
*******************************************************************     77800021
ALOCTABL EQU   *                                                        77880021
*******************************************************************     77960021
*              RLD INPUT BUFFER 1ST PASS                         S01904 78040021
*******************************************************************     78120021
ALRLD1   DC    X'48'                                             S01904 78200021
         DC    AL1(RLDINPAD-CSNO)                                S01904 78280021
         DC    AL1(CSNO-CSNO)                                    S01904 78360021
         DC    X'01'                                             S01904 78440021
         DC    AL2(WT1)                                          S01904 78520000
         DC    AL2(MIN1)                                         S01904 78600000
         DC    AL1(CSNO-CSNO)                                    S01904 78680021
         DC    X'00'                                             S01904 78760021
*******************************************************************     78840021
*              ALIAS TABLE ENTRY                                 S01904 78920021
*******************************************************************     79000021
ALALIAS  DC    X'38'                                             S01904 79080021
         DC    AL1(ALAS-CSNO)                                    S01904 79160021
         DC    AL1(BUFSIZ-CSNO)                                  S01904 79240021
         DC    X'01'                                             S01904 79320021
         DC    AL2(WT2)                                          S01904 79400000
         DC    AL2(MIN2)                                         S01904 79480000
         DC    AL1(CSNO-CSNO)                                    S01904 79560021
         DC    X'00'                                             S01904 79640021
*******************************************************************     79720021
*              CESD TABLE ENTRY                                  S01904 79800021
*******************************************************************     79880021
ALCESD   DC    X'49'                                             S01904 79960021
         DC    AL1(CHESD-CSNO)                                   S01904 80040021
         DC    AL1(ENCDX-CSNO)                                   S01904 80120021
         DC    X'10'                                             S01904 80200021
         DC    AL2(WT3)                                         S01904  80280000
         DC    AL2(MIN3)                                         S01904 80360000
         DC    AL1(ENCDC-CSNO)                                   S01904 80440021
         DC    X'00'                                             S01904 80520021
*******************************************************************     80600021
*              HESD TABLE ENTRY                                  S01904 80680021
*******************************************************************     80760021
ALHESDP  DC    X'38'                                             S01904 80840021
         DC    AL1(HESD-CSNO)                                    S01904 80920021
         DC    AL1(CSNO-CSNO)                                    S01904 81000021
         DC    X'01'                                             S01904 81080021
         DC    AL2(WT4)                                         S01904  81160000
         DC    AL2(MIN4)                                         S01904 81240000
         DC    AL1(CSNO-CSNO)                                    S01904 81320021
         DC    X'00'                                             S01904 81400021
ALHESD   DC    X'38'                                             S01904 81480021
         DC    AL1(CSNO-CSNO)                                    S01904 81560021
         DC    AL1(ENCDX-CSNO)                                   S01904 81640021
         DC    X'08'                                             S01904 81720021
         DC    AL2(WT5)                                        S01904   81800000
         DC    AL2(MIN5)                                         S01904 81880000
         DC    AL1(ENCDC-CSNO)                                   S01904 81960021
         DC    X'00'                                             S01904 82040021
*******************************************************************     82120021
*              TEXT NOTE LIST 2 ENTRY                            S01904 82200021
*******************************************************************     82280021
ALTNL2   DC    X'32'                                             S01904 82360021
         DC    AL1(TNLS2-CSNO)                                   S01904 82440021
         DC    AL1(ENT2X-CSNO)                                   S01904 82520021
         DC    X'07'                                             S01904 82600021
         DC    AL2(WT6)                                         S01904  82680000
         DC    AL2(MIN6)                                         S01904 82760000
         DC    AL1(ENT2C-CSNO)                                   S01904 82840021
         DC    X'00'                                             S01904 82920021
*******************************************************************     83000021
*              RLD NOTE LIST 2 ENTRY                             S01904 83080021
*******************************************************************     83160021
ALRNL2   DC    X'32'                                             S01904 83240021
         DC    AL1(RNLS2-CSNO)                                   S01904 83320021
         DC    AL1(ENR2X-CSNO)                                   S01904 83400021
         DC    X'09'                                             S01904 83480021
         DC    AL2(WT7)                                         S01904  83560000
         DC    AL2(MIN7)                                         S01904 83640000
         DC    AL1(ENR2C-CSNO)                                   S01904 83720021
         DC    X'00'                                             S01904 83800021
*******************************************************************     83880021
*              TEXT IO TABLE ENTRY                               S01904 83960021
*******************************************************************     84040021
ALTXTIO  DC    X'70'                                             S01904 84120021
         DC    AL1(TXTIO-CSNO)                                   S01904 84200021
         DC    AL1(ENTOX-CSNO)                                   S01904 84280021
         DC    X'01'                                             S01904 84360021
         DC    AL2(WT8)                                         S01904  84440000
         DC    AL2(MIN8)                                         S01904 84520000
         DC    AL1(ENTOC-CSNO)                                   S01904 84600021
         DC    X'00'                                             S01904 84680021
*******************************************************************     84760021
*              RENUMBERING TABLE/RELOC CONSTANT TABLE            S01904 84840021
*******************************************************************     84920021
ALRNTRLC DC    X'71'                                             S01904 85000021
         DC    AL1(RECNT-CSNO)                                   S01904 85080021
         DC    AL1(ENRNX-CSNO)                                  OX02397 85160003
         DC    X'04'                                             S01904 85240021
         DC    AL2(WT9)                                          S01904 85320002
         DC    AL2(MIN9)                                         S01904 85400000
         DC    AL1(ENRNC-CSNO)                                  OX02397 85480003
         DC    X'00'                                             S01904 85560021
*******************************************************************     85640021
*              DELINK TABLE ENTRY                                S01904 85720021
*******************************************************************     85800021
ALDELINK DC    X'71'                                             S01904 85880021
         DC    AL1(DLKT-CSNO)                                    S01904 85960021
         DC    AL1(ENDTX-CSNO)                                   S01904 86040021
         DC    X'05'                                             S01904 86120021
         DC    AL2(WT10)                                         S01904 86200000
         DC    AL2(MIN10)                                        S01904 86280000
         DC    AL1(ENDTC-CSNO)                                   S01904 86360021
         DC    X'00'                                             S01904 86440021
*******************************************************************     86520021
*              RLD OUTPUT BUFFER 2ND PASS                        S01904 86600021
*******************************************************************     86680021
ALRLD2   DC    X'10'                                             S01904 86760021
         DC    AL1(RLDOUTBF-CSNO)                                S01904 86840021
         DC    AL1(CSNO-CSNO)                                    S01904 86920021
         DC    X'01'                                             S01904 87000021
         DC    AL2(WT11)                                        S01904  87080000
         DC    AL2(MIN11)                                        S01904 87160000
         DC    AL1(ENRLD2X-CSNO)                                 S01904 87240021
         DC    X'80'                                             S01904 87320021
*******************************************************************     87400021
*              TEXT NOTE LIST 1                                  S01904 87480021
*******************************************************************     87560021
ALTNL1   DC    X'62'                                             S01904 87640021
         DC    AL1(TNT1-CSNO)                                    S01904 87720021
         DC    AL1(ENT1X-CSNO)                                   S01904 87800021
         DC    X'07'                                             S01904 87880021
         DC    AL2(WT12)                                        S01904  87960000
         DC    AL2(MIN12)                                        S01904 88040000
         DC    AL1(ENT1C-CSNO)                                   S01904 88120021
         DC    X'00'                                             S01904 88200021
*******************************************************************     88280021
*              RLD NOTE LIST 1                                   S01904 88360021
*******************************************************************     88440021
ALRNL1   DC    X'62'                                             S01904 88520021
         DC    AL1(RNT1-CSNO)                                    S01904 88600021
         DC    AL1(ENR1X-CSNO)                                   S01904 88680021
         DC    X'09'                                             S01904 88760021
         DC    AL2(WT13)                                        S01904  88840000
         DC    AL2(MIN13)                                        S01904 88920000
         DC    AL1(ENR1C-CSNO)                                   S01904 89000021
         DC    X'00'                                             S01904 89080021
*******************************************************************     89160021
*              ORDER TABLE ENTRY                                 S01904 89240021
*******************************************************************     89320021
ALORDER  DC    X'60'                                             S01904 89400021
         DC    AL1(ORDRADR-CSNO)                                 S01904 89480021
         DC    AL1(ORDRMAX-CSNO)                                 S01904 89560021
         DC    X'01'                                             S01904 89640021
         DC    AL2(WT14)                                        S01904  89720000
         DC    AL2(MIN14)                                        S01904 89800000
         DC    AL1(ORDRCUR-CSNO)                                 S01904 89880021
         DC    X'00'                                             S01904 89960021
*******************************************************************     90040021
*              HIERARCHY TABLE ENTRY                             S01904 90120021
*******************************************************************     90200021
ALHIAR   DC    X'61'                                             S01904 90280021
         DC    AL1(HIARADD-CSNO)                                 S01904 90360021
         DC    AL1(CSNO-CSNO)                                    S01904 90440021
         DC    X'01'                                             S01904 90520021
         DC    AL2(WT15)                                        S01904  90600000
         DC    AL2(MIN15)                                        S01904 90680000
         DC    AL1(ENCDC-CSNO)                                   S01904 90760021
         DC    X'20'                                             S01904 90840021
*******************************************************************     90920021
*              SEGMENT TABLE ENTRY                               S01904 91000021
*******************************************************************     91080021
ALSEG    DC    X'F1'                                             S01904 91160021
         DC    AL1(SGT1-CSNO)                                    S01904 91240021
         DC    AL1(ENS1X-CSNO)                                   S01904 91320021
         DC    X'01'                                             S01904 91400021
         DC    AL2(WT16)                                        S01904  91480000
         DC    AL2(MIN16)                                        S01904 91560000
         DC    AL1(ENS1X-CSNO)                                   S01904 91640021
         DC    X'00'                                             S01904 91720021
*******************************************************************     91800021
*              CALLS LIST ENTRY                                  S01904 91880021
*******************************************************************     91960021
ALCALL   DC    X'E0'                                             S01904 92040021
         DC    AL1(CLLT-CSNO)                                    S01904 92120021
         DC    AL1(ENCLX-CSNO)                                   S01904 92200021
         DC    X'01'                                             S01904 92280021
         DC    AL2(WT17)                                        S01904  92360000
         DC    AL2(MIN17)                                        S01904 92440000
         DC    AL1(ENCLC-CSNO)                                   S01904 92520021
         DC    X'00'                                             S01904 92600021
*******************************************************************     92680021
*              ENTRY LIST ENTRY                                  S01904 92760021
*******************************************************************     92840021
ALENT    DC    X'90'                                             S01904 92920021
         DC    AL1(SELST-CSNO)                                   S01904 93000021
         DC    AL1(ENELTX-CSNO)                                  S01904 93080021
         DC    X'06'                                             S01904 93160021
         DC    AL2(WT18)                                        S01904  93240000
         DC    AL2(MIN18)                                        S01904 93320000
         DC    AL1(ENELTC-CSNO)                                  S01904 93400021
         DC    X'00'                                             S01904 93480021
*******************************************************************     93560021
*               IDR TRANSLATOR DATA TABLE ENTRY                         93640021
*******************************************************************     93720021
ALIDRTR   DC    X'60'                                                   93800021
          DC    AL1(IDRTRTAB-CSNO)                                      93880021
          DC    AL1(IDRTRLEN-CSNO)                                      93960021
          DC    X'01'                                           OX04245 94040002
          DC    AL2(WT19)                                               94120000
          DC    AL2(MIN19)                                              94200000
          DC    AL1(IDRTRCUR-CSNO)                                      94280021
          DC    X'00'                                                   94360021
*******************************************************************     94410002
*         IDR TRANSLATOR ID TABLE ENTRY                         OX04245 94412002
*******************************************************************     94420002
ALIDRTI  DC    X'60'                                            OX04245 94430002
         DC    AL1(IDRTITAB-CSNO)                               OX04245 94432002
         DC    AL1(IDRTILEN-CSNO)                               OX04245 94434002
         DC    X'01'                                            OX04245 94436002
         DC    AL2(WT22)                                        OX04245 94438002
         DC    AL2(MIN22)                                       OX04245 94438402
         DC    AL1(IDRTICUR-CSNO)                               OX04245 94438802
         DC    X'00'                                            OX04245 94439202
*******************************************************************     94440021
*               IDR USER DATA TABLE ENTRY                               94520021
*******************************************************************     94600021
ALIDRUD   DC    X'60'                                                   94680021
          DC    AL1(IDRUDTAB-CSNO)                                      94760021
          DC    AL1(IDRUDLEN-CSNO)                                      94840021
          DC    X'01'                                                   94920021
          DC    AL2(WT20)                                               95000000
          DC    AL2(MIN20)                                              95080000
          DC    AL1(IDRUDCUR-CSNO)                                      95160021
          DC    X'00'                                                   95240021
*******************************************************************     95320021
*               IDR ZAP DATA TABLE ENTRY                                95400021
*******************************************************************     95480021
ALIDRZP   DC    X'60'                                                   95560021
          DC    AL1(IDRZPTAB-CSNO)                                      95640021
          DC    AL1(IDRZPLEN-CSNO)                                      95720021
          DC    X'01'                                                   95800021
          DC    AL2(WT21)                                               95880000
          DC    AL2(MIN21)                                              95960000
          DC    AL1(IDRZPCUR-CSNO)                                      96040021
          DC    X'00'                                                   96120021
ALEND    DC    X'FF'                                             S01904 96200021
         SPACE 3                                                        96280021
TMPADRSV DS    14F             TABLE ADDRESS SAVE AREA           S01904 96360021
MOVESV   DC    XL256'0'        DATA MOVEMENT AREA                S01904 96440021
********************************************                            96450037
*        PATCH AREA                        *                            96460037
********************************************                            96470037
PATCH    DC    20F'0',C'PATCH AREA ' FOR PROG MAINT                     96480037
SCNDS    DSECT                         FOR VALID CHAR SCAN       A37667 96490002
THIS     DS    CL1                     POINTS TO PRESENT CHAR    A37667 96500002
NEXT     DS    CL1                     POINTS TO NEXT CHAR       A37667 96510002
         DS    CL5                                               A37667 96512002
LAST     DS    CL1                     ENDING ADDR               A37667 96514002
         TITLE 'DCB MAP'                                                96516002
         DCBD  DSORG=(PS,PO)                                            96520021
         HEWAPT                                                         96600021
HEWLEDE1 EQU   SPACES+32                                                96680021
         END                                                            96760021
