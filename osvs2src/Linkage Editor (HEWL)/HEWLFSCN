         TITLE    'LINK EDITOR CONTROL CARD SCANNER AND PROCESSOR'      00050021
*                                                                       00100021
*STATUS: CHANGE LEVEL 000                                               00150021
*                                                                       00200021
*FUNCTION/OPERATION    SCANS AND PROCESSES THE'PROGRAMMER PUNCHED CARDS 00250021
*    NAMELY:OVERLAY,REPLACE,LIBRARY,INCLUDE,INSERT,ENTRY,CHANGE,ALIAS,  00300021
*     NAME, SETSSI,  HIARCHY                                          * 00350021
*    SINCE THESE CARDS ARE IN THE GENERAL FORM:                         00400021
*      OPERATION   OPD01(OPD11,OPD12,OPD13...),OPD02,...,(OPD14),...    00450021
*    THE OPERANDS ARE EITHER OUTSIDE PARENTHESIS OR INSIDE.THEY GO      00500021
*    INTO EITHER OPD0 OR OPD0, RESPECTIVELY. DEPENDING ON THE CARD FOR- 00550021
*    -MAT,AN OPERAND IS PLACED IN OPD0,AN OPERAND IS PLACED IN OPD1,    00600021
*    OR BOTH. THEN, THE SCAN IS INTERRUPTED AND THE CORRESPONDING CARD  00650021
*    PROCESSOR IS 'BALR'"D. WHEN CONTROL RETURNS,SCANNING IS RESUMED.   00700021
*    THE PROCESSING CONSISTS IN ONE OF THE FOLLOWING:                   00750021
*    1- ADDING A NEW ITEM IN A CHAIN IN THE CESD (COMPOSITE ESD)        00800021
*    2- FILLING AN INFORMATION INTO THE APT (ALL PURPOSE TABLE),OR      00850021
*       INTO THE PDS DIRECTORY (THE TABLE THAT WILL BE THE PARTITIONED  00900021
*       DATA SET DIRECTORY OF THE OUTPUT MODULE)                        00950021
*    3- OPERATING UPON AN EXISTING LINE OF THE CESD                     01000021
*                                                                       01050021
*ENTRY POINTS - HEWLFSCN  SCAN AND PROCESS THE CONTROL CARD           * 01100021
*                                                                       01150021
*                          CALL.SEQ.  LA    1,CARD BEGINNING            01200021
*                                      L    15,=V(HEWLKSCN)             01250021
*                                     BALR  14,15                       01300021
*     (DATA IS PASSED BY LOCATION)                                      01350021
*INPUT:  - 80 BYTES SOMEWHERE IN MAIN STORAGE , REPRESENTING A          01400021
*          CONTROL CARD                                                 01450021
*        - COMPOSITE ESD (CESD)                                         01500021
*        - ALL PURPOSE TABLE (APT) IN WHICH FLAGS ARE TESTED            01550021
*OUTPUT: - PARTS OF 2 TABLES IN MAIN STORAGE : COMPOSITE ESD (CESD)     01600021
*          AND PARTITIONED DATA SET DIRECTORY   (PDS DY)                01650021
*                                                                       01700021
*EXTERNAL ROUTINES:  - HEWLFLOG ERROR ROUTINE WHOSE ADDRESS IS IN THE   01750021
*                      ALL PURPOSE TABLE                                01800021
*                    - HEWLCINC   'INCLUDE PROCESSOR'WHICH CHOOSES THE  01850021
*                      ADDITIONAL INPUT TO BE READ, AND PREPARES IT     01900021
*                      (OPEN,BLDL,FIND). GETS CNTRL AFTER AN INCLUDE    01950021
*                      CARD                                             02000021
*                                                                       02050021
*EXITS -NORMAL:   1- RETURN TO THE CARD READER  HEWLEINP AFTER COMPLE-  02100021
*                    TION OF A ONE CARD SCAN (GENERALLY)                02150021
*                 2- CALLS THE INCLUDE PROCESSOR HEWLCINC AFTER COMPLE- 02200021
*                    TION OF THE SCAN OF ONE INCLUDE CARD  (OR SEVERAL  02250021
*                    INCLUDE CARDS IN CASE OF CONTINUATION)             02300021
*      -ERROR:                                                          02350021
*********************************************************************** 02400021
*            CONDITIONS                  *DATA PASSED TO RTN HEWLKLOG * 02450021
*********************************************************************** 02500021
*INVALID STATEMENT .SCAN TERMINATED      * X'121E' IN R0,CARD AD IN R1* 02550021
*NOT ENOUGH PLACE IN CESD                * X'141G' IN R0,CARD AD IN R1* 02600021
*TOO MANY OVERLAY REGIONS                * X'141F' IN R0,CARD AD IN R1* 02650021
*TOO MANY OVERLAY SEGMENTS               * X'1420' IN R0,CARD AD IN R1* 02700021
*TOO MANY ALIASES                        * X'2221' IN R0,SYMBOL  IN R1* 02750021
*NAME CRD ON LIBR DATA SET. CRD IGNORED  * X'1231' IN R0,CARD AD IN R1* 02800021
*********************************************************************** 02850021
*                                                                       02900021
*TABLES/WORK AREAS:    CESD , APT                                       02950021
*                                                                       03000021
*ATTRIBUTES:           REUSABLE                                         03050021
*             (THIS CONTROL SECTION IS IN A SEGMENT OF AN OVERLAY TREE) 03100021
*NOTES:    NONE                                                         03150021
*                                                                       03200021
HEWLFSCN CSECT                                                          03250021
*A086000,151000,164000,182000,186000,245000,259000,265000,280000 S21016 03300021
*A303600,815000,826000,858000                                    S21016 03350021
*C115000-116000,184000,243000-244000,248000-249000,254000,260000 S21016 03400021
*C849400                                                         S21016 03450021
*041600-900,054000,063000-800,210220-40,433500-450,435500-700,   Y01048 03460000
*438000,439500,446500,495100-496182,554600-554920                Y01048 03470000
*034800,342600-800,399800-920,530800                             A47001 03472000
*A332100                                                        OX01981 03474002
*A598600-598700                                                 OX03080 03476003
*C184500,C190000-193000                                 OX03126,OY02822 03478002
*D032100-032420,I041500,C141050,C141300-141350          OX04280,OY03413 03478402
*D295580-295900,C331100-331400,C419600-419900           OX04280,OY03413 03478802
*D431010-431460,D525500,I526000,D530700                 OX04280,OY03413 03479202
*D548500-548700                                         OX04280,OY03413 03479602
*I272000                                                OX05439,OY04537 03479703
*I584000                                                        XA05437 03484703
* SEE FIX FOR XA05437                                           YA03750 03486703
* I561500,D584100-584200                                        ZM30869 03488702
*                                                               OZ01403 03488802
* I603960                                                       ZA01400 03489102
*                                                                       03490003
* A6099996                                                      ZA01418 03492037
         EXTRN INDDNAME                                          A47001 03495003
***  SUBROUTINE  HEWLKSCN IS THE PROGRAMMER PUNCHED CARD SCANNER.       03500021
***  THE 'CARD READER' PROGRAM  RECOGNIZES THE PROGRAMMER PUNCHED       03550021
***  CARD BY A BLANK IN COLUMN 1 .                                      03600021
***  CARD READER BRANCHES TO HEWLKSCN BY  BALR 14,15  WHERE  15  IS     03650021
***  LOADED WITH A V TYPE ADCON FOR HEWLKSCN                            03700021
***  THE CARD READER PUTS IN  REG. 1  THE ADDRESS OF THE BYTE OF THE    03750021
***  INPUT BUFFER WHICH CONTAINS COLUMN 1                               03800021
R0       EQU   0                                                        03850021
R1       EQU   1                                                        03900021
R3       EQU   3                                                        03910021
P2       EQU   13                                                       03950021
R13      EQU   13                                                       03960021
R14      EQU   14                                                       04000021
R15      EQU   15                                                       04050021
BASE     EQU   12                                                       04100021
R12      EQU   7                                                        04150021
REG9     EQU   9                       GEN REG 9        OX04280,OY03413 04152002
TREG     EQU   4                  PTR TO TRANS TABLE             Y01048 04160000
BASE2    EQU   5                  SECOND BASE REGISTER           Y01048 04170000
SSINFO   EQU   6                  SSI INFORMATION                Y01048 04180000
SAVR7    EQU   7                  USED WITH SSINFO               Y01048 04190000
ERR1LTL  EQU   X'121E'        WRONG LINKEDIT CNTRL CARD .CARD IGNORED   04200021
ERR2LTL  EQU   X'1419'        NOT ENOUGH PLACE IN CESD                  04250021
ERR3LTL  EQU   X'141F'        ERROR   TOO MANY OVERLAY REGIONS          04300021
ERR4LTL  EQU   X'1420'        ERROR   TOO MANY OVERLAY SEGMENTS         04350021
ERR6LTL  EQU   X'2221'    TOO MANY ALIASES                              04400021
ERR8LTL  EQU   X'2248'                                           A37667 04420000
ERR10LTL EQU   X'1231'  NAME CRD ON LIBR DATA SET .CRD IGNORED          04450021
SPSTROPT EQU   X'02'                   SPECIAL STRING OPTION BIT S21016 04500021
SPSTRFLG EQU   X'80'                   SPECIAL STRING FLAG       S21016 04550021
NOTSPSTR EQU   X'FD'                   BIT CONFIGURATION TO      S21016 04600021
*                                      TURN OFF SPECIAL STRING   S21016 04650021
*                                      OPTION BIT                S21016 04700021
LEVEL1   EQU   X'40'                   LEVEL 1 OPERAND FLAG      S21016 04750021
*                                      IN STAT                   S21016 04800021
NOLEV0   EQU   X'20'                   FLAG IN OPTION INDICATING S21016 04850021
*                                      LEVEL 0 OPERAND WAS       S21016 04900021
*                                      ABSENT                    S21016 04950021
COMMA    EQU   C','                    COMMA -- FOR COMPARISON   S21016 05000021
QUOTE    EQU   C''''                   QUOTE -- FOR COMPARISON   S21016 05050021
SPECMAX  EQU   41                      MAX. COUNTER VALUE FOR    S21016 05100021
*                                      NO. OF CHARS. IN A        S21016 05150021
*                                      SPECIAL STRING            S21016 05200021
NORMAX   EQU   9                       MAX. COUNTER VALUE FOR    S21016 05250021
*                                      NO. OF CHARS. IN A        S21016 05300021
*                                      NORMAL STRING             S21016 05350021
TABSIZE  EQU   16                      NO. OF ENTRIES IN  Y01031,Y01048 05400000
*                                      PROC. ENTRY TABLE  Y01031,S21016 05460000
CURCHAR  EQU   0                       OFFSET IN STRING FOR      S21016 05500021
*                                      CURRENT CHARACTER         S21016 05550021
NEXTCHAR EQU   1                       OFFSET IN STRING FOR      S21016 05600021
*                                      NEXT CHAR.                S21016 05650021
ONECHAR  EQU   1                       A SINGLE CHARACTER IN     S21016 05700021
*                                      STRING                    S21016 05750021
CHAR7    EQU   7                       THE 7TH CHARACTER IN A    S21016 05800021
*                                      FIELD                     S21016 05850021
CHAR8    EQU   8                       THE 8TH CHARACTER IN A    S21016 05900021
*                                      FIELD                     S21016 05950021
LEN32    EQU   32                      LENGTH OF 32 BYTES        S21016 06000021
SAPTR    EQU   13                      POINTER TO LOCAL SAVEAREA S21016 06050021
         ST    BASE,8(15)                                               06100021
         BC    15,12(15)                                                06150021
         DS    CL4                                                      06200021
         BALR  BASE,0                                                   06250021
         USING *,BASE,BASE2                                      Y01048 06300000
         USING APTDSECT,2                                               06350021
         LR    BASE2,BASE         SET UP SECOND BASE REG         Y01048 06360000
         LA    BASE2,4095(BASE2)  TO ADDRESS THE NEXT            Y01048 06370000
         LA    BASE2,1(BASE2)     4K BYTES                       Y01048 06380000
         BC    15,MODID+6                                               06400021
MODID   DC     C'00MSCN'                                                06450021
         STM   00,15,SAVR                                               06500021
         TM    APT0,X'08'    IS LOG OPTION ON                           06550021
         BC    8,SCN900    BR. IF NOT                                   06600021
         XR    0,0                                                      06650021
         L     15,ERDIG                                                 06700021
         BALR  14,15   TO ERR.LOG. SUBROUTINE TO LOG THE CARD           06750021
SCN900   MVC   COL72(1),71(R1)   SAVE  COLUMN 72 'S CONTENT             06800021
         LA    R0,71(0,R1)                                              06850021
         ST    R0,SAVACOL              SAVE ADDRESS OF COLUMN 72        06900021
          TM    APT2,X'01'  IS THIS CARD A CONTINUATION OF PR5V CRD.    06950021
         BC    1,SCN10240        BRANCH IF YES                          07000021
SCN1000  NI    STAT,X'00'        INITIATES STATUS BYTE FOR NEW CARD     07050021
***   P2  POINTS TO THE CURRENT BYTE IN AREA WHERE OPERAND IS BUILT     07100021
***                                                 (OPD0 OR OPD1)      07150021
         LA    P2,OPD1           SET P2 AT OPD1 TO READ OPERATION       07200021
         MVI   OPTION,X'80'         SIGNAL THAT OPTION1 REQUIRED IN RD8 07250021
*                           **DEBUG LE NOTINOV**  RESET OPTION  ATL1    07300021
         BAL  R14,SCN11RD8          BRANCH TO READ  A   SYMBOL.         07350021
*                                   RETURN FROM  RD8(1)                 07400021
         TM    STAT,X'01'           TEST IF  ENDED BY BLANK             07450021
         BC    14,SCN10230          BRANCH IF NOT, TO ERROR (MEANS -    07500021
*                         - OPERATION NOT FOLLOWED BY BLANK )           07550021
         LA    R14,TABSIZE             INIT SEARCH ON PROCESSOR  S21016 07600021
*                                      ENTRIES TABLE (12 ENTRIES S21016 07650021
*                                      IN TABLE)                 S21016 07700021
         LA    R15,PROCTABL                                             07750021
SCN10100 CLC   0(8,R15),OPD1    OPERATION SYMBOL IS IN OPD1             07800021
         BC    8,SCN10120          BRANCH TO SCN10120 WHEN MATCH FOUND  07850021
SCN10105 LA    R15,12(R15)                                              07900021
         BCT   R14,SCN10100                                             07950021
         BC    15,SCN10230         BRANCH TO ERROR WHEN MATCH NOT FOUND 08000021
***                                ERROR IN THE CARD                    08050021
SCN10120 MVC   PROCENTY(4),8(R15)      SAVE  THE PROCESSOR ENTRY POINT  08100021
         LA    P2,OPD0                SET  P2 ON OPD0 TO READ 1ST OPRD  08150021
         MVI   STAT,X'80'     SET OPD0 NEW' & RESET 'ENDD BY BLANK'     08200021
         OI    OPTION,X'80'           SIGNAL OPTION'1' TO SUBPROGR RD8  08250021
         BAL   R14,SCN11RD8           BRANCH TO  SUBPROG. RD8           08300021
*                                     RETURN FROM RD8                   08350021
SCN10130 TM    OPTION,X'40'    IS AT LEAST ONE CHAR. FOUND ?    ATL1    08400021
         BC    8,SCN10220      BRANCH IF NO                             08450021
         NI    OPTION,X'DF'      RESET TO 0 THE BIT 'OPD0 ABSENT'       08500021
*                                  (OPD0 IS PRESENT)                    08550021
         OI    STAT,X'80'     SET 'OPD0 NEW' ON                         08600021
         TM    STAT,X'04'     ENDED BY LEFT PARENTHESIS ?               08650021
         BC    1,SCN10180     BRANCH IF YES                             08700021
SCN10140 L     R15,PROCENTY                                             08750021
         NI    APT2,X'FE'  RESET TO 0 THE CONTINUATION BIT              08800021
**THE PROCESSOR ENTRY POINT IS IN REGISTER R15                          08850021
         BALR  R14,R15                                                  08900021
*                                                                       08950021
*                                                                       09000021
*                                                                       09050021
**                         RETURN FROM THE PROCESSOR                    09100021
*                                                                       09150021
         TM    STAT,X'40'       TEST IF LEVEL =1 OR 0                   09200021
         BC    1,SCN10150       BRANCH IF  LEVEL=1                      09250021
         TM    STAT,X'02'       TEST  IF ENDED BY COMMA                 09300021
         BC    8,SCN10145     BR IF NOT                                 09350021
         CLC   PROCTABL+8(4),PROCENTY     IS IT OVERLAY                 09400021
         BC    8,SCN10230     IF YES,BR TO ERROR                        09450021
         CLC   PROCENTY,IDENTADD       IS IDENTIFY CARD BEING    S21016 09500021
*                                      SCANNED?                  S21016 09550021
         BE    SCN10230                IF SO, IT IS AN ERROR     S21016 09600021
         BC    15,SCN10170                                              09650021
SCN10145 TM    STAT,X'01'   TEST IF ENDED BY BLANK                      09700021
         BC    8,SCN10230       BRANCH TO ERROR  IF NOT                 09750021
** AT THIS POINT THE CARD IS TERMINATED EXCEPT IF A COMMENT CONTINUES   09800021
SCN10147 CLI   COL72,C' '                                               09850021
         BC    8,SCN10210     RETURN TO THE CARD READER PROG.(NO CONT.) 09900021
         OI    STAT,X'10'     SET COMMENT=1                             09950021
         OI    APT2,X'01'     SET CONTIN=1                              10000021
         BC    15,SCN10210    RETURN TO THE CARD READER PROG.           10050021
SCN10150 TM    STAT,X'08'          TEST IF ENDED BY RIGHT PARENTHESIS   10100021
         BC    1,SCN10160          BRANCH IF YES                        10150021
         TM    STAT,X'02'          TEST IF ENDED BY COMMA               10200021
         BC    8,SCN10230      BRANCH TO ERROR IF NOT                   10250021
         CLC   PROCENTY,IDENTADD       IS IDENTIFY CARD BEING    S21016 10300021
*                                      SCANNED?                  S21016 10350021
         BE    SCN10230                IF SO, IT IS AN ERROR     S21016 10400021
         NI    STAT,X'7F'    RESET  'OPD0 NEW' TO ZERO                  10450021
         BC    15,SCN10190    GO TO READ ONE MORE LEVEL 1 ITEM          10500021
SCN10160 NI    STAT,X'BF'       SET  LEVEL TO ZERO                      10550021
         LA    R1,1(R1)          UPDATE POINTER OF CARD COLUMN          10600021
         C     R1,SAVACOL       COMPARE R1 AND ADDR OF COL 72           10650021
*   RIGHT PARENT. IN COL. 71 IMPLIES NO CONTINUATION POSSIBLE           10700021
*   (CONTIN. OF OPERAND REQUIRES A COMMA , CONTIN. OFCOMMENT ..         10750021
*    ..REQUIRES THAT COMMENT ALREADY BEGUN )                            10800021
         BC    8,SCN10210       BRANCH TO THE RETURN TO CARD READER     10850021
         CLI   0(R1),C','       IS CHAR. UNDER P1  A COMMA              10900021
         BC    7,SCN10147              GO CHECK FOR CONTINUATION        10950021
         OI    STAT,X'02'       SET  'ENDED BY COMMA'                   11000021
SCN10170 LA    P2,OPD0        SET POINTER P2 ON OPD0                    11050021
         NI    OPTION,X'7F'       SIGNAL  OPTION=0 TO THE SUBPR.    RD8 11100021
         BAL   R14,SCN11RD8       BRANCH TO SUBPROG. RD8                11150021
*                                 RETURN FROM RD8                       11200021
         BC    15,SCN10130                                              11250021
SCN10180 OI    STAT,X'40'         SET LEVEL TO 1                        11300021
         CLC   PROCENTY,IDENTADD       IS IDENTIFY CARD BEING    S21016 11350021
*                                      SCANNED?                  S21016 11400021
         BNE   SCN10190                IF NOT, CONTINUE          S21016 11450021
         LA    P2,IDRSTRNG             IF YES, SET P2 TO POINT   S21016 11500021
*                                      TO SPECIAL STRING FOR     S21016 11550021
*                                      IDR DATA                  S21016 11600021
         OI    OPTION,SPSTROPT         TURN ON SPECIAL STRING    S21016 11650021
*                                      OPTION                    S21016 11700021
         B     SCN10193                CONTINUE                  S21016 11750021
SCN10190 LA    P2,OPD1            SET P2 ON OPD1                        11800021
SCN10193 NI    OPTION,X'7F'            SIGNAL OPTION=0 TO        S21016 11850021
*                                      SUBPROGRAM READ8          S21016 11900021
         BAL   R14,SCN11RD8       BRANCH  TO SUBPR.                     11950021
*                                 RETURN FROM RD8                       12000021
         NI    OPTION,NOTSPSTR         TURN OFF SPECIAL STRING   S21016 12050021
*                                      OPTION                    S21016 12100021
         TM    OPTION,X'40'         TEST BIT 'AT LEAST ONE'  ATL1       12150021
         BC    1,SCN10140         TOWARD PROCESSOR                      12200021
SCN10200 TM    STAT,X'01'        TEST IF  ENDED BY BLANK                12250021
         BC    8,SCN10230         BRANCH TO ERROR IF NOT                12300021
SCN10205 TM    OLDSTAT,X'02'      TEST IF OLD STATUS IS ENDED BY COMMA  12350021
         BC    8,SCN10230         BRANCH TO ERROR IF NOT (BLANK INSIDE  12400021
*                                 PARENTHESIS IS NOT ALLOWED,EXCEPT FOR 12450021
*                 THE  COMMA-BLANK CONTINUATION CONVENTION)             12500021
*   REGISTER  7  CONTAINS THE ADDRESS OF THE LIBRARY DCB                12550021
         CLI   COL72,C' '        TEST IF BLANK IN COL. 72               12600021
         BC    8,SCN10230         BRANCH TO ERROR IF YES                12650021
         OI    APT2,X'01'   SET CONTIN=1                                12700021
***          RETURN TO 'READ NEXT CARD'                                 12750021
SCN10210 TM    OPTION,X'10'  WAS IT AN INCLUDE CARD                     12800021
         BC    8,SCN10215                                               12850021
         TM    APT2,X'01'      IS CONTIN. EXPECTED                      12900021
         BC    1,SCN10215      YES                                      12950021
         L     15,INCLBRAD    BRANCH ADDR TO INCL PROC(ENTAB ENTRY)     13000021
         LM    00,14,SAVR                                               13050021
         BCR   15,15    GO TO INCL PROC                                 13100021
SCN10215 LM   00,15,SAVR                                                13150021
         L    BASE,8(15)                                                13200021
         BCR   15,R14             RETURN TO THE CALLER (CARD READER)    13250021
SCN10220 TM     STAT,X'04'    TEST IF ENDED BY LEFT PARENTH.            13300021
         BC      8,SCN10225       NO                                    13350021
         OI     OPTION,X'20'       SET 'OPD0 ABSENT' IN OPTION          13400021
         BC    15,SCN10180                                              13450021
SCN10225 TM    APT2,X'01'    TEST IF CONTIN=1                           13500021
         BC    8,SCN10200         BRANCH IF NOT                         13550021
*                     BRANCH TO ERROR SUBPROG.                          13600021
SCN10230 L     R1,SAVR+4     SLOT ADDR. OF 1ST COL OF CARD INTO R1      13650021
SCN10232 LH    0,ERR1         WRONG LK.EDIT CNTRL CRD. CRD.IGNORED      13700021
SCN10235 L     R15,ERDIG                                                13750021
         NI    APT2,X'FE'  RESET TO 0 THE CONTINUATION BIT              13800021
         BALR  R14,R15                                                  13850021
*                                                                       13900021
*                                                                       13950021
*                                                                       14000021
*                              RETURN FROM ERROR ROUTINE                14050021
         BC    15,SCN10210     GO TO READ NEXT CARD                     14100021
SCN10238 ST    R1,SAVRG1               SAV REG 1 A37667,OX04280,OY03413 14105002
         LA    R1,OPD0                 INVALID ALIAS NAME        A37667 14110000
         LH    R0,ERR8                                           A37667 14115000
         L     R15,ERDIG                                         A37667 14120000
         BALR  R14,R15                 LOG ERROR MESSAGE         A37667 14125000
         L     R14,SAVRG14             RES R14   A37667,OX04280,OY03413 14130002
         L     R1,SAVRG1               RES R1    A37667,OX04280,OY03413 14135002
         BR    14                                                A37667 14140000
SCN10240 TM    STAT,X'10'      TEST IF  COMMENT=1                       14150021
         BC    8,SCN10250      BRANCH IF NOT                            14200021
         CLI   COL72,C' '           TEST IF BLANK IN COL. 72            14250021
         BC    7,SCN10210           BRANCH IF NOT                       14300021
         NI    STAT,X'EF'    SET COMMENT=0                              14350021
         NI    APT2,X'FE'     SET CONTIN=0                              14400021
         BC    15,SCN10210                                              14450021
SCN10250 LA    R1,14(R1)            SET P1 ON COL. 15                   14500021
         TM    STAT,X'40'         TEST IF LEVEL =1                      14550021
         BC    1,SCN10190       YES                                     14600021
         BC    15,SCN10170                                              14650021
***    SUBROUTINE  SCN11RD8  READS 8 CHAR. OR LESS TO BUILD A SYMBOL    14700021
***    IN THE AREA POINTED TO BY P2                                     14750021
SCN11RD8 MVC   OLDSTAT(1),STAT    SAVE STATUS BYTE IN OLD STATUS        14800021
         MVI   0(P2),C' '                                               14850021
         MVC   1(7,P2),0(P2)    PAD BLANKS IN OPERAND AREA              14900021
         TM    OPTION,SPSTROPT         'SPECIAL STRING' OPTION   S21016 14950021
*                                      ON?                       S21016 15000021
         BZ    NOTSPEC                 BRANCH IF NOT             S21016 15050021
         LA    R15,SPECMAX             INITIALIZE CHAR. COUNT    S21016 15100021
*                                      FOR UP TO 40 CHARACTERS   S21016 15150021
*                                      IN OPERAND STRING         S21016 15200021
         MVC   CHAR8(LEN32,P2),CHAR7(P2)  PAD REMAINDER OF       S21016 15250021
*                                      OPERAND FIELD WITH BLANKS S21016 15300021
         B     CONTINUE                BRANCH AROUND NORMAL      S21016 15350021
*                                      CHAR COUNT                S21016 15400021
NOTSPEC  LA    R15,NORMAX              INITIALIZE CHAR. COUNT    S21016 15450021
*                                      (MAXIMUM 8 CHARACTERS)    S21016 15500021
CONTINUE NI    STAT,X'F0'              RESET TO 0 THE ENDED BY   S21016 15550021
*                                      '(' , ')' , ',' OR ' '    S21016 15600021
*                                      BIT                       S21016 15650021
           NI    OPTION,X'BF'   RESET TO 0 THE BIT 'AT LEAST ONE'       15700021
         XC    SPECSTR(2),SPECSTR      RESET TO 0 SPEC. STRING   S21016 15750021
*                                      INDICATOR AND LENGTH      S21016 15800021
SCN11000 LA    R1,1(R1)           UPDATE POINTER R1                     15850021
         CLI   0(R1),C' '         TEST IF THIS CHARACTER IS BLANK       15900021
         BE    SCN11006                BRANCH IF YES             S21016 15950021
SCN11001 C     R1,SAVACOL              IS THIS COLUMN 72?        S21016 16000021
         BC    7,SCN11002         OK IF NO                              16050021
         TM    OPTION,X'40'       WAS AT LEAST ONE CHARACTER RECEIVED   16100021
         BC    1,SCN10230         ERROR IF YES                          16150021
         BC    15,SCN10205        GO CHECK IF VALID CONITNUATION        16200021
SCN11002 TM    SPECSTR,SPSTRFLG        SCANNING A SPEC. STRING?  S21016 16250021
         BO    SCN11003                BRANCH IF YES             S21016 16300021
         CLI   CURCHAR(R1),COMMA       TEST IF THIS CHAR. IS     S21016 16350021
*                                      A COMMA                   S21016 16400021
         BC    8,SCN11010        BRANCH IF YES                          16450021
         CLI   0(R1),C'('        TEST IF THIS CHAR. IS LEFT PARENT.     16500021
         BC    8,SCN11020        BRANCH IF YES                          16550021
         CLI   0(R1),C')'        TEST IF THIS CHAR. IS RIGHT PARENT.    16600021
         BC    8,SCN11030        BRANCH IF YES                          16650021
SCN11003 CLI   CURCHAR(R1),QUOTE       TEST IF THIS CHAR. IS     S21016 16700021
*                                      A QUOTE                   S21016 16750021
         BE    SCN11060                BRANCH IF YES             S21016 16800021
SCN11004 BCT   R15,SCN11005            UPDATE COUNT & GO TO      S21016 16850021
*                                      MOVE THE CHARACTER        S21016 16900021
         BC    15,SCN10230   BRANCH TO ERROR IF MORE THAN 8 CHARACTERS  16950021
SCN11005 MVC   0(1,P2),0(R1)     MOVE THE CHAR. AT ADD POINTED TO BY P2 17000021
         OI    OPTION,X'40'      SET 'AT LEAST ONE'    ATL1=1           17050021
         LA    P2,1(P2)          UPDATE P2                              17100021
         BC    15,SCN11000                                              17150021
SCN11006 TM    SPECSTR,SPSTRFLG        SCANNING A SPECIAL        S21016 17200021
*                                      STRING?                   S21016 17250021
         BNO   SCN11040                BRANCH IF NO              S21016 17300021
         B     SCN11001                CONTINUE IF YES           S21016 17350021
SCN11010 OI    STAT,X'02'        SET  'ENDED BY COMMA'                  17400021
         BCR   15,R14            RETURN                                 17450021
SCN11020 OI    STAT,X'04'        SET  'ENDED BY LEFT PARENT.'           17500021
         BCR   15,R14            RETURN                                 17550021
SCN11030 OI    STAT,X'08'        SET  'ENDED BY RIGHT PARENT.'          17600021
         BCR   15,R14            RETURN                                 17650021
SCN11040 TM    OPTION,X'80'      TEST  IF OPTION=1                      17700021
         BC    8,SCN11050        BRANCH IF NOT                          17750021
         TM    OPTION,X'40'      TEST IF  'AT LEAST ONE'  ATL1=1        17800021
         BC    1,SCN11050    BR. IF YES                                 17850021
         C    R1,SAVACOL                                                17900021
         BC    8,SCN10230     GO TO ERROR                               17950021
         BC    15,SCN11000    GO & TRY NEXT COLUMN                      18000021
SCN11050 OI    STAT,X'01'        SET  'ENDED BY A BLANK'                18050021
         BCR   15,R14            RETURN                                 18100021
SCN11060 TM    SPECSTR,SPSTRFLG        SCANNING A SPECIAL        S21016 18150021
*                                      STRING?                   S21016 18200021
         BO    SCN11070                BRANCH IF YES             S21016 18250021
         TM    OPTION,SPSTROPT         SPECIAL STRING OPTION ON? S21016 18300021
         BNO   SCN11004                IF NOT, CONTINUE          S21016 18350021
         CH    R15,SPSTRLEN            1ST CHAR IN STRING?       S21016 18400021
         BNE   SCN10230                NOT, ERR  S21016,OX03126,OY02822 18450002
         OI    SPECSTR,SPSTRFLG        IF YES, TURN ON SPECIAL   S21016 18500021
*                                      STRING FLAG               S21016 18550021
         B     SCN11000                PROCESS NEXT CHAR.        S21016 18600021
SCN11070 CLI   NEXTCHAR(R1),QUOTE      IS NEXT CHAR. ALSO A      S21016 18650021
*                                      QUOTE?                    S21016 18700021
         BNE   SCN11080                IF NOT, BRANCH            S21016 18750021
         LA    R1,NEXTCHAR(R1)         IF IT IS, IGNORE 1ST      S21016 18800021
*                                      QUOTE                     S21016 18850021
         B     SCN11004                CONTINUE TO PROCESS THIS  S21016 18900021
*                                      CHAR.                     S21016 18950021
SCN11080 CLI   NEXTCHAR(R1),C')'       TEST END PAREN   OX03126,OY02822 19000002
         BNE   SCN10230                ERR IF NOT THERE OX03126,OY02822 19050002
         SH    R15,SPSTRLEN            CALC TRUE LENGTH OX03126,OY02822 19100002
         LCR   R15,R15                 OF SPECIAL STRNG OX03126,OY02822 19150002
         STH   R15,SPECSTR             STORE NO. OF CHARS. IN    S21016 19350021
*                                      STRING                    S21016 19400021
         LA    R15,ONECHAR             NO MORE CHARS. ALLOWED IN S21016 19450021
*                                      THIS STRING EVEN IF COUNT S21016 19500021
*                                      NOT EXHAUSTED (FINAL      S21016 19550021
*                                      QUOTE FOUND)              S21016 19600021
         B     SCN11000                GO TO CONTINUE SCAN       S21016 19650021
***   PROCESSORS VECTOR TABLE .                                         19700021
***   GIVES  THE ENTRY POINT OF EACH PROGRAMMER-PUNCHED-CARD PROCESSOR  19750021
         DS    0F                                                       19800021
PROCTABL DC    CL8'OVERLAY '                                            19850021
         DC    A(SCNOVERL)      4 BYTES ADCON                           19900021
         DC    CL8'REPLACE '                                            19950021
         DC    A(SCNREPLA)                                              20000021
         DC    CL8'LIBRARY '                                            20050021
         DC    A(SCNLIBRA)                                              20100021
         DC    CL8'INCLUDE '                                            20150021
         DC    A(SCNINCLU)                                              20200021
         DC    CL8'INSERT  '                                            20250021
         DC    A(SCNINSER)                                              20300021
         DC    CL8'ENTRY   '                                            20350021
         DC    A(SCNENTRY)                                              20400021
         DC    CL8'CHANGE  '                                            20450021
         DC    A(SCNCHANG)                                              20500021
         DC    CL8'ALIAS   '                                            20550021
         DC    A(SCNALIAS)                                              20600021
         DC    CL8'NAME    '                                            20650021
         DC    A(SCNNAME)                                               20700021
         DC    CL8'SETSSI'                                              20750021
         DC    A(SCNSETSI)                                              20800021
         DC    CL8'HIARCHY '                                            20850021
         DC    A(SCNHIARC)                                              20900021
IDENTOP  DC    CL8'IDENTIFY'                                     S21016 20950021
IDENTADD DC    A(SCNIDENT)                                       S21016 21000021
         DC    CL8'ORDER'                                       AOSCD   21010021
         DC    A(SCNORDR)                                       AOSCD   21012021
         DC    CL8'PAGE'                                        AOSCD   21014021
         DC    A(SCNPAGE)                                       AOSCD   21020021
         DC    CL8'SETCODE'       SETCODE OPERAND                Y01048 21022000
         DC    A(SCNSTCOD)        ADDRESS OF SETCODE RTN         Y01048 21024000
         DC    CL8'EXPAND '       EXPAND OPERAND                 Y01031 21026000
         DC    A(SCNEXPND)        ADDRESS OF EXPAND RTN          Y01031 21028000
PROCEND  EQU   *                                                        21030021
RF       EQU   13                                                       21050021
RE       EQU   15                                                       21100021
*  SCNHOL SELECTS A FREE LINE IN THE CESD.  ADDRESS OF THIS LINE        21150021
*  RETURNED TO CALLER BY REG. RE  ,  ID BY REG. RF  . THIS LINE COMES   21200021
*  FROM THE HOLES' CHAIN , OR IS A NEW LINE IN THE CESD                 21250021
*                                                                       21300021
*                                                                       21350021
*                                                                       21400021
SCNHOL   L     RE,FLCD             ADDR. OF THE HOLES CHAIN BEG.        21450021
         LTR   RE,RE         TEST IF ZERO                               21500021
         BC    8,HOL010      YES                                        21550021
*                            ADDR.OF HOLE IS IN RE                      21600021
         MVC   FLCD(4),12(RE)      UPDATE FLCD                          21650021
         LR    RF,RE                  HOLE ADDR. IN REG. RF             21700021
         S     RF,CHESD                                                 21750021
         SRL   RF,4              DIVIDE OFFSET BY 16 TO GET ID          21800021
         BCR   15,14             RETURN                                 21850021
HOL010   LH    RE,ENCDC       HIGHEST  ID USED IN CESD                  21900021
HOL010A  CH    RE,ENCDX       COMPARE TO MAX ID AVAILABLE IN CESD       21950021
         BL    HOL010B                 THERE IS STILL ROOM      AOSCD   21960021
         TM    APT4,REALOCTE           CAN REALLOC BE DONE?     AOSCD   21970021
         BO    HOL020                  NO/NO MORE PLACE IN ESD  AOSCD   21980021
         STM   R0,R15,BRNCHSV          SAVE REGISTERS           AOSCD   21990021
         L     R15,ERDIGA              ADDR OF REALLOC RTN      AOSCD   21992021
         BALR  R14,R15                 GO TO REALLOC RTN        AOSCD   21994021
         LM    R0,R15,BRNCHSV          RESTORE REGISTERS        AOSCD   21996021
         B     HOL010A                 CHECK IF REALLOC SUFFICIENT      21998021
         BC     8,HOL020   BRCH IF NO MORE PLACE IN CESD                22000021
HOL010B  LA    RE,1(RE)                                                 22050021
         LR    RF,RE                FREE LINE ID IN RF                  22100021
         STH   RE,ENCDC       UPDATE HIGHEST ID USED                    22150021
         SLL   RE,4                                                     22200021
         A     RE,CHESD       ADDRESS OF FREE LINE IN RE                22250021
         BCR   15,14                  RETURN                            22300021
*                                    NO MORE PLACE IN THE CESD          22350021
HOL020   LH    0,ERR2         NOT ENOUGH PLACE IN CESD  IRRECOVERABLE   22400021
         L     15,ERDIG                                                 22450021
         BALR  14,15                                                    22500021
         BC    15,*         DEBUG.PURPOSE.ERROR ROUT.SHOULD NOT RETURN  22550021
*HEWLEHOL GIVES ADDR. OF A FREE CESD LINE (MAY BE A HOLE) IN RE         22600021
* AND ITS ID IN RF                                                      22650021
* THE CALLER PUTS  THE RETURN ADDRESS IN  14                            22700021
*   OVERLAY PROCESSOR                                                   22750021
RX       EQU   11                                                       22800021
RY       EQU   10                                                       22850021
RZ       EQU   09                                                       22900021
*                                                                       22950021
*  SCNOVERL  ,GIVEN AN OVERLAY SYMBOL, UPDATES   1- THE OVERLAY CHAIN   23000021
*  2- THE CURRENT NO. OF SEGMENTS  AND THE TABLE SEGTA1                 23050021
*  3- THE CURRENT NO. OF REGIONS  AND THE TABLE  LSTS , IF  (REGION) IS 23100021
*     SPECIFIED                                                         23150021
SCNOVERL TM    PDSE7,X'20'    IS OVERLAY OPTION 'ON'                    23200021
         BC    8,SCN10230   BR. TO ERROR IF NOT                         23250021
         ST    14,SAV14L1   SAVE R14 BECAUSE OF THE CALL TO SCNHOL      23300021
         LH    RY,CSNO        GET CURRENT SEGMENT NUMBER                23350021
         STC  RY,PREVSEG                                                23400021
         TM    STAT,X'40'   TEST STATUS BYTE OF THE SCANNER             23450021
*                                 IS IT LEVEL=1                         23500021
          BC    8,OVR090                                                23550021
*                                 LEVEL=I ANNOUNCES 'REGION'            23600021
         CLC   OPD1(8),REGION                                           23650021
         BC    7,SCN10230     TOWARD ERRORLOG                           23700021
         BC    15,OVR100                                                23750021
OVR090   L     RX,OVCMBGAD                                              23800021
         LTR   RX,RX                                                    23850021
         BC    8,OVR115                                                 23900021
         BC    15,OVR120                                                23950021
OVR100   LH    RX,CRNO                                                  24000021
         CH    RX,MXNOREG                                               24050021
         BC    11,OVR105     TOOMANY REGIONS COMING                     24100021
         LA    RX,1(RX)                                                 24150021
         STH   RX,CRNO        UPDATE CURRENT REGION                     24200021
         XC    PREVSEG(1),PREVSEG    SET PREVSEG TO 0                   24250021
         BC    15,OVR110                                                24300021
OVR105   LH    0,ERR3         ERROR  TOO MANY REGIONS                   24350021
         L     15,ERDIG                                                 24400021
         BALR  14,15       BRANCH TO ERROR ROUTINE                      24450021
OVR110   L     RZ,OVCMBGAD        ADDRESS OF OVERLAY CHAIN BEGINNING    24500021
         LTR  RZ,RZ                                                     24550021
         BC   8,OVR115      BRANCH IF NO CHAIN EXISTS                   24600021
         XC    OVCMBGAD(1),OVCMBGAD    NULLIFY OVCMBGAD                 24650021
         LA   14,OVR115     FIX EXIT OF SMALL SUBROUTINE                24700021
         BC   15,OVR165    GO TO NULLIFICATION OF OVRL.CHAIN            24750021
OVR115   BAL   14,SCNHOL   GO & GET FREE LINE IN THE CESD               24800021
         ST    15,OVCMBGAD        INIT OVCMBGAD TO 1ST LINE OF CHAIN    24850021
         BC    15,OVR135                                                24900021
*                            HERE THE CHAIN EXISTS                      24950021
OVR120   CLC   OPD0(8),0(RX)      COMPARE  SYMBOLS                      25000021
         BC    8,OVR138         EQUAL                                   25050021
         L     RZ,8(RX)                                                 25100021
         LA    RZ,0(RZ)           WIPE THE TYPE                         25150021
         LTR   RZ,RZ    IS THE CHAIN ADDRESS =0                         25200021
         BC    8,OVR130           YES                                   25250021
         LR    RX,RZ                                                    25300021
         BC    7,OVR120       NO                                        25350021
OVR130   BAL   14,SCNHOL      GO $ GET A FREE LINE IN THE CESD          25400021
*                               LINE ADDR.IS IN R15 , ID IN R13         25450021
         ST   R15,8(RX)           PUT ADDR. OF NXT LINE IN CURR.LINE    25500021
         MVI   8(RX),X'02'        RESTORE CRUSHED TYPE                  25550021
OVR135   LR    RX,R15                                                   25600021
         MVC   0(8,RX),OPD0           PUT SYMBOL INTO  OVERLAY LINE     25650021
         MVC   12(1,RX),PREVSEG     PUT PREVSEG INTO OVERLAY LINE       25700021
*                                     (CSEG IS HERE 'PREVIOUS SEGT.' )  25750021
         XC    9(3,RX),9(RX)           ZEROE   THE CHAIN ADDRESS        25800021
         MVI   8(RX),X'02'             SET TYPE ER                      25850021
         MVI   13(RX),X'90'            SET SUBTYPE 'CONTROL  OVRLAY'    25900021
         L     8,SAV14L1      PREPARE RETURN TO CARD SCANNER            25950021
         BC    15,OVR140                                                26000021
OVR138   MVC   PREVSEG(1),12(RX)    PREV. SEG. TAKEN FROM MATCHED LINE  26050021
         LA    8,OVR160                                                 26100021
OVR140   LA    RY,1(RY)             ADD 1  IN CURRENT SEGM. NO.         26150021
         STH   RY,CSNO        UPDATE CSEG                               26200021
         CH    RY,ENS1X       COMPARE CSEG TO MAX PERMISSABLE           26250021
         BC    12,OVR150         OK                                     26300021
         LH    0,ERR4         ERROR  TOO MANY SEGMENTS IN THIS TREE     26350021
         L     15,ERDIG                                                 26400021
         BALR  14,15                                                    26450021
          BC    15,*        .STOP. THIS ERROR WAS IRRECOVERABLE         26500021
*                            ERROR ROUTINE SHOULD NOT  RETURN           26550021
OVR150   L     R15,SGT1       ADDR OF SEGTA1 MINUS 1 IN R15             26600021
         AR    R15,RY      ADD CURRENT SEGT. NO.                        26650021
         MVC   0(1,R15),PREVSEG     FILL ONE SEGTA1 ITEM                26700021
         LH    15,CRNO                                                  26750021
         STC   RY,LSTS(15)       STORE LAST SEG.FOR  THE CURRENT REGION 26800021
         BCR  15,8       RETURN OR GO TO NEXT INSTRUCTION               26850021
**              NULLIFICATION OF THE TAIL OF THE OVERLAY CONTROL CHAIN  26900021
OVR160   L     RZ,8(RX)                                                 26950021
         LA    RZ,0(RZ)                                                 27000021
         LTR   RZ,RZ              TEST IF CHAIN ADDR.IS ZERO(CHAIN END) 27050021
         BCR   8,14                                                     27100021
         XC    9(3,RX),9(RX)     SET ZERO AS CHAIN ADDRESS              27150021
OVR165  MVI   8(RZ),X'07'    NULLIFY TYPE OF NEXT LINE                  27200021
         XC    0(8,RZ),0(RZ)  AND CLEAR NAME FIELD      OX05439,OY04537 27210003
         LR    RX,RZ             TAKE NEXT LINE AS NEW CURRENT LINE     27250021
         MVC   12(4,RZ),FLCD  CHAIN THIS FREE LINE TO LAST FREE LINE    27300021
         ST    RZ,FLCD        UPDATE BEGINNING OF HOLES' CHAIN          27350021
         BC   15,OVR160           CHAIN CONTINUES                       27400021
SCNORDR  TM    OPTION,X'20'            IS OPD0 ABSENT           AOSCD   27410021
         BO    SCN10230                YES,ERROR                AOSCD   27420021
         TM    STAT,X'40'              IS LEVEL 1 PRESENT       AOSCD   27430021
         BZ    SCNORDR1                NO,BRANCH OUT            AOSCD   27440021
         CLC   OPD1(8),ORDRP           IS OPD1 VALID CHAR       AOSCD   27442021
         BNE   SCN10230                NO,ERROR                 AOSCD   27444021
         OI    SWITCH1,PAGE            SET PAGE ALIGN SWITCH    AOSCD   27446021
         OI    APT4,PAGEE              FLAG PAGE IN APT         AOSCD   27448021
SCNORDR1 OI    SWITCH1,ORDER           SET ORDER SWITCH         AOSCD   27448421
         OI    APT4,ORDERR             FLAG ORDERING IN APT     AOSCD   27448821
         B     INS001                                           AOSCD   27449221
SCNPAGE  OI    SWITCH1,PAGE            SET PAGE SWITCH          AOSCD   27449621
         OI    APT4,PAGEE              FLAG PAGE IN APT         AOSCD   27449721
*                                                                       27450021
*  SCNINSER   IS THE  INSERT CARD PROCESSOR.                            27500021
SCNINSER TM    STAT,X'40'     IS IT LEVEL 1                             27550021
         BZ    INS001          NO,BRANCH OUT                    AOSCD   27560021
         NI    SWITCH1,X'FF'-X'31'     RESET FLAG FOR ORDER & PAGE      27570021
         B     SCN10230            ERROR CONDITION-NO LEVEL 1 FOR INS   27580021
INS001   STM   R13,R3,TEMPRGSV         TEMPORARY SAVE           AOSCD   27590021
         LA    0,16           SET  INCREMENT  FOR THE BXLE              27700021
         L     15,CHESD       SET STARTING ADDR                         27750021
         LH    1,ENCDC                                                  27800021
         SLL   1,4                                                      27850021
         AR    1,15           HIGH LIMIT OF BXLE                        27900021
         LA    15,16(15)                                                27950021
INS100   CLC   OPD0(8),00(15)     COMPARE OPRD 0 WITH CESD SYMBOL       28000021
         BC    8,INS158           BRANCH  IF  MATCHING SYMBOL  FOUND    28050021
INS105   BXLE  15,0,INS100                                              28100021
*               SYMBOL NOT FOUND IN CESD                                28150021
         ST    14,SAV14L1                                               28200021
         BAL   14,SCNHOL      GO AND GET FREE LINE IN THE CESD          28250021
         L     14,SAV14L1                                               28300021
*              FREE LINE ADDR  IN R15  FREE LINE ID  IN R13             28350021
         MVC   0(8,R15),OPD0     SET  SYMBOL EQUAL TO OPD0              28400021
         XC    8(8,R15),8(R15)                                  AOSCD   28410021
         TM    SWITCH1,PAGE+ORDER      PAGE OR ORDER REQD       AOSCD   28420021
         BC    5,INS150                YES,BRANCH OUT           AOSCD   28430021
         MVI   8(R15),X'02'      SET  TYPE  ER                          28450021
         MVI   13(R15),X'00'     SET  SUBTYPE  PURE ER                  28500021
         BC    15,INS130                                                28550021
INS110   MVN   TEMP1(1),8(15)    INSULATE TYPE                          28600021
         CLI   TEMP1,X'02'   IS TYPE X'X2'                              28650021
         BC    7,INS130   BR. IF NOT                                    28700021
         CLI   13(15),X'02'   IS IT AN UNMATCHED LIBRARY MEMBER         28750021
         BC    7,INS120    BR IF NOT                                    28800021
         OI    13(15),X'01'   SET TYPE 'MATCHED LIBR MEMBER'            28850021
INS120   CLI   8(15),X'02'   CAN THE MATCHED LINE BE A CNTRL CARD       28900021
         BC    7,INS130         NO                                      28950021
         CLI   13(15),X'0F'    IS IT A CNTRL CARD BY ITS SUBTYPE        29000021
         BC    2,INS105          YES  CONTINUE THE SEARCH               29050021
INS130   OI    8(15),X'20'      SET  INSERT BIT IN TYPE                 29100021
         MVC   12(1,15),CSNO+1    INSERT THE CURRENT SEG.NO. AS 1 BYTE  29150021
INS140   LM    R13,R3,TEMPRGSV         RESTORE REGISTERS        AOSCD   29200021
         NI    SWITCH1,X'FF'-X'31'     RESET SWITCH             AOSCD   29210021
         BCR   15,14                   RETURN                   AOSCD   29212021
INS150   MVI   8(R15),X'0A'            FLAG A WX                AOSCD   29220021
INS151   STH   R13,IDSAV               SAVE CESD ID             AOSCD   29230021
         L     R13,ORDRADR             PICK UP ADD OF ORDER TABLE       29240021
         LH    R1,ORDRCUR              CURR NO OF BYTES USED    AOSCD   29250021
         LTR   R1,R1                   ARE THERE ANY IN USE?    AOSCD   29260021
         LA    R0,3                    3 BYTES PER ENTRY IN ORDER TBL   29270021
         BZ    INS152A                 NONE USED-BRANCH OUT     AOSCD   29280021
         AR    R1,R13                                           AOSCD   29290021
         SR    R1,R0                                            AOSCD   29292021
INS152   CLC   1(2,R13),IDSAV          MATCH IN THE ORDER TBL   AOSCD   29294021
         BE    INS155                  YES,BRANCH OUT           AOSCD   29296021
         BXLE  R13,R0,INS152           NO,CONTINUE SCANNING     AOSCD   29298021
INS152B  CLC   ORDRCUR(2),ORDRMAX      ORDER TABLE OVFLOW?      AOSCD   29298421
         BL    INS152A                 NO,BRANCH OUT            AOSCD   29298821
         TM    APT4,REALOCTE           CN WE REALLOCATE?        AOSCD   29299221
         BO    HOL020                  ALREADY DONE,BRANCH OUT  AOSCD   29299621
         STM   R0,R15,BRNCHSV          SAVE REGISTERS           AOSCD   29299721
         L     R15,ERDIGA              ADDR OF REALLOC RTN      AOSCD   29299821
         BALR  R14,R15                 GO TO REALLOC RTN        AOSCD   29299921
         LM    R0,R15,BRNCHSV          RESTORE REGISTERS        AOSCD   29316621
         L     R13,ORDRADR             NEW ADDR OF ORDER TBL    AOSCD   29326621
         AH    R13,ORDRCUR             PT TO AVAIL ENTRY        AOSCD   29328621
         B     INS152B                                          AOSCD   29330621
INS152A  MVC   1(2,R13),IDSAV          MOVE ID                  AOSCD   29332621
         AH    R0,ORDRCUR              INCREMENT CNT OF CURR BYTES      29333021
         STH   R0,ORDRCUR              USED IN ORDER TABLE      AOSCD   29333121
         TM    SWITCH1,ORDER           IS THIS AN ORDER STATEMENT       29333221
         BZ    INS153                  NO,BRANCH OUT            AOSCD   29338821
INS153A  LA    R13,0(R13)                                       AOSCD   29340821
         ST    R13,LASTORDR                                     AOSCD   29342821
         OI    0(R13),X'20'            FLAG FOR ORDER           AOSCD   29343221
INS153   TM    SWITCH1,PAGE            IS PAGE ALIGN REQUESTED  AOSCD   29343621
         BZ    INS154                  NO,BRANCH OUT            AOSCD   29344021
         OI    0(R13),X'10'            YES,MARK ENTRY SO        AOSCD   29344121
INS154   TM    SWITCH1,MATCH           WAS THERE A MATCH CESD   AOSCD   29344221
         BZ    INS140                  NO,RETURN                AOSCD   29344321
         OI    0(R13),X'80'            YES,MARK MATCH IN ENTRY  AOSCD   29358221
         B     INS140                  PROCEED                  AOSCD   29368221
INS155   TM    SWITCH1,ORDER           IS ORDER REQUESTED?      AOSCD   29370221
         BZ    INS153                  NO,BRANCH OUT            AOSCD   29370621
         LA    R13,0(R13)                                       AOSCD   29371021
         C     R13,LASTORDR                                     AOSCD   29371421
         BNL   INS153A                                          AOSCD   29371821
         TM    0(R13),X'20'            IS MATCHED ENTRY FOR ORDER       29371921
         BO    INS156                  YES,BRANCH OUT           AOSCD   29372021
         XC    0(3,R13),0(R13)         CLEAR ORDER ENTRY        AOSCD   29372121
         LA    R13,3(R1)                                        AOSCD   29376721
         OI    0(R13),X'10'            FLAG PAGE                AOSCD   29378721
         B     INS152B                 PROCEED                  AOSCD   29380721
INS156   LM    R13,R3,TEMPRGSV         RESTORE REGISTERS        AOSCD   29381121
         NI    SWITCH1,X'FF'-X'31'     RESET PAGE & ORDER FLAGS AOSCD   29381221
         LH    R0,ERR7                 LOAD ERROR CODE          AOSCD   29381321
         LA    R1,OPD0                 POINT TO OPD0            AOSCD   29381421
         B     SCN10235                                         AOSCD   29386021
INS158   TM    SWITCH1,PAGE+ORDER      PAGE OR ORDER REQUESTED  AOSCD   29386121
         BZ    INS110                  NO,BRANCH OUT            AOSCD   29388121
         OI    SWITCH1,MATCH           INDICATE MATCHED ENTRY   AOSCD   29390121
         LR    R13,R15                 CALCULATE CESD ID        AOSCD   29390521
         S     R13,CHESD                                        AOSCD   29390621
         SRL   R13,4                                            AOSCD   29390721
         MVN   TEMP1(1),8(R15)         MOVE TYPE                AOSCD   29402521
         CLI   TEMP1,0                 TYPE SD?                 AOSCD   29412521
         BE    INS151                  YES,BRANCH OUT           AOSCD   29414521
         CLI   TEMP1,X'05'             TYPE COMMON              AOSCD   29418421
         BE    INS151                  YES,BRANCH OUT           AOSCD   29420421
         CLI   TEMP1,X'02'             TYPE ER?                 AOSCD   29422421
         BNE   INS151                  NO,BRANCH OUT            AOSCD   29426321
         TM    13(R15),X'80'           CONTROL CARD ITEM?       AOSCD   29426421
         BZ    INS151                  NO,BRANCH OUT            AOSCD   29428421
         NI    SWITCH1,X'7F'                                    AOSCD   29428821
         B     INS105                                                   29429221
TEMPRGSV DC    7F'0'                   TEMPORARY SAVE AREA      AOSCD   29429621
ORDRP    DC    CL8'P'                  OPD1 CHAR FOR PAGE       AOSCD   29430021
LASTORDR DC    F'0'                                             AOSCD   29430121
IDSAV    DC    H'0'                    SAVEAREA FOR CESD ID     AOSCD   29430221
ERR7     DC    X'2241'                 ERROR CODE               AOSCD   29430321
SWITCH1  DC    X'00'                   SWITCH                   AOSCD   29434221
PAGE     EQU   X'10'                   FLAG FOR PAGE            AOSCD   29434321
ORDER    EQU   X'20'                   FLAG  FOR ORDERING       AOSCD   29436321
MATCH    EQU   X'01'                   FLAG FOR MATCH ENTRY     AOSCD   29436721
RG       EQU   0                                                        29438321
RJ       EQU   13                                                       29442221
RH       EQU   14                                                       29446121
RI       EQU   15                                                       29450021
RM       EQU   3                                                        29500021
SCNREPLA TM    OPTION,X'20'   IS OPD0 ABSENT                            29550021
         BC    1,SCN10230     BR TO ERR IF YES                          29600021
         OI    STATREPL,X'80'  SET BIT 'ENTERED BY REPLACE'             29650021
         TM    STAT,X'40'      WHAT LEVEL ?  (ZERO OR ONE)              29700021
         BC    1,REP115        BR. IF LEVEL 1  (2 OPERANDS)             29750021
         ST    14,SAV14L1                                               29800021
         BAL   14,SCNHOL   BR. AND GET A FREE LINE IN THE CESD          29850021
         L     14,SAV14L1                                               29900021
*  HEWLEHOL  HAS PUT  ADDR. OF FREE LINE IN  RI AND ID  IN RJ           29950021
         LA    RM,REP110      SET  EXIT  ADDRESS FOR THE SUBR. REP100   30000021
REP100   L     RJ,RCCE                                                  30050021
         LTR   RJ,RJ           DOES THE CHAIN ALREADY EXIST.            30100021
         BC    7,REP105        YES                                      30150021
         ST    RI,RCCB        GIVE  ITS FIRST VALUE TO RCCB             30200021
         BC    15,REP107                                                30250021
REP105   ST    RI,8(RJ)      PUT THIS NEW LINE ADDR.INTO PREV.LINE  ... 30300021
*                         ...TO FORM THE CHAIN                          30350021
         MVI   8(RJ),X'02'    RESTORE CRUSHED TYPE                      30400021
REP107   ST    RI,RCCE        UPDATE THE END ADDRESS OF THE  CHAIN      30450021
         MVC   0(8,RI),OPD0     OPERAND ZERO PUT IN LINE                30500021
         MVI   8(RI),X'02'      SET TYPE ER  IN THE LINE                30550021
         XC    9(3,RI),9(RI)   ZEROE   THE CHAINING ADDR.OF THIS NEWLIN 30600021
         BCR   15,RM                                                    30650021
REP110   MVI   13(RI),X'E8'       SET  SUBTYPE'CONTROL-DELETE'          30700021
         BCR   15,RH              RETURN                                30750021
SCNCHANG TM    STAT,X'40'     IS IT LEVEL1                              30800021
         BC    8,SCN10230     BR TO ERR IF NOT                          30850021
         TM    OPTION,X'20'   IS OPD0 ABSENT                            30900021
         BC    1,SCN10230     BR TO ERR IF YES                          30950021
         NI    STATREPL,X'7F'                                           31000021
*                          ENTERING  BY 'CHANGE'                        31050021
*                  TAKE 2 CONSECUTIVE FREE LINES IN THE CESD            31100021
REP115   LH    RJ,ENCDC                                                 31150021
         LA    RI,1(RJ)          ADD 1 TO HIGHEST ID USED               31200021
         SLL   RI,4              MULTIPLY BY 16                         31250021
         A     RI,CHESD       ADD ADDRESS OF CESD MINUS 16              31300021
*                 ADDR. OF FIRST FREE LINE OF A COUPLE IS IN RI         31350021
*                 CHECK IF TWO LINES WERE AVAILABLE IN THE CESD         31400021
         LA    RJ,2(RJ)                                                 31450021
REP117   EQU   *                                                OZ01403 31460002
         CH    RJ,ENCDX                                                 31500021
         BC    2,REP140              TO ERROR                           31550021
         STH   RJ,ENCDC       UPDATE ENCDC                              31600021
         LA    RM,REP120      SET EXIT ADDR. FOR THE SUBR. REP100       31650021
         BC    15,REP100      BR. TO SMALL INTERNAL SUBR.               31700021
REP120   MVC   16(8,RI),OPD1  PUT SYMBOL OPD1 IN   THE SECOND LINE      31750021
         MVI   24(RI),X'02'   PUT TYPE ER  IN THE SCD. LINE             31800021
         TM    STATREPL,X'80'                                           31850021
         BC    1,REP130       BR. IF REPLACE                            31900021
         MVI   13(RI),X'F0'    SUBTYPE CONTROL CHANGE IN FIRST LINE     31950021
         MVI   29(RI),X'F0'    SUBTYPE CONTROL CHANGE IN SECOND LINE    32000021
         BCR   15,RH            RETURN                                  32050021
REP130   MVI   13(RI),X'E0'       SET SUBTYPE  CNTRL REPLACE IN 1ST LIN 32100021
         MVI   29(RI),X'E0'       SET SUBTYPE  CNTRL REPLACE IN 2ND LIN 32150021
         BCR   15,RH             RETURN                                 32200021
REP140   EQU   *                                                OZ01403 32210002
         TM    APT4,REALOCTE     REALLOC. POSSIBLE?             OZ01403 32220002
         BO    REP142            BRANCH IF NOT                  OZ01403 32230002
         STM   R0,R15,BRNCHSV    SAVE REGS BEFORE REALLOC       OZ01403 32240002
         L     R15,ERDIGA        ADDR. OF REALLOC. RTN.         OZ01403 32242002
         BALR  R14,R15           GO TO REALLOC RTN.             OZ01403 32244002
         LM    R0,R15,BRNCHSV    RESTORE REGISTERS              OZ01403 32246002
         B     REP117            GO CHECK CESD AGAIN            OZ01403 32248002
REP142   LH    0,ERR2         NOT ENOUGH PLACE IN CESD  IRRECOVERABLE   32250003
         L     RI,ERDIG                                                 32300021
         BALR  14,15                                                    32350021
         BC    15,*       DEBUGGING PURPOSE. AS THE ERR.WAS IRRECOVE-   32400021
*                        -RABLE,THE ERROR ROUTINE SHOULD NOT RETURN     32450021
*                         HERE                                          32500021
SCNNAME  TM    OPTION,X'20'   IS OPD0 ABSENT                            32550021
         BC    1,SCN10230     BR TO ERR IF YES                          32600021
         L     15,HEWLCLAC    ADDRESS OF CURRENT READ BLOCK             32650021
         LA    0,0(0,15)               CLEAR HI ORDER BYTE              32700021
         LA    15,HEWLCRBN    ADDRESS OF SYSLIN READ BLOCK              32750021
         CR    0,15   IS PTER ,POINTOING TO SYSLIN READ BLOCK           32800021
         BC    8,NAM010    BR IF YES                                    32850021
         L     1,SAVR+4      ADDR OF FIRST COLUMN OF CARD INTO R1       32900021
         LH    0,ERR10  NAME CARD MUST BE IN MAIN STREAM                32950021
         BC    15,SCN10235  BR TO ERROR                                 33000021
NAM010   TM    APT3,X'40'   TEST IF NAMECRD ALREADY BEEN READ           33050021
         BCR   1,14                                                     33100021
         ST    R14,SAVRG14             SAV RETRN ADDR   OX04280,OY03413 33110002
         LA    REG9,OPD0               POINT TO NAME    OX04280,OY03413 33120002
         L     R15,ADRVLDCK            GET ADDR OF RTN  OX04280,OY03413 33130002
         BALR  R14,R15                 GO VALIDATE NAME OX04280,OY03413 33140002
         L     R14,SAVRG14             RES RETRN ADDR   OX04280,OY03413 33142002
         LTR   REG9,REG9               TEST VALID NAME  OX04280,OY03413 33144002
         BNZ   SCN10230                BRANCH IF INVAL  OX04280,OY03413 33146002
         OI    APT3,X'40'   SET BIT 'NAME CARD RECEIVED' 'ON'           33150021
         MVC   PDSE1(8),OPD0  PUT MEMBER NAME INTO PDS DIRY.            33200021
         NI    APT3,X'EF'              RESET REPLACE INDICATION OX01981 33210002
         TM    STAT,X'40'     TEST IF LEVEL 1                           33250021
         BCR   8,14       RETURN IF NOT (LEVEL 0 MEANS SINGLE OPRND)    33300021
         CLI   OPD1,C'R'     TEST IF CHAR.='R'                          33350021
         BC    7,SCN10230     BR. TO ERROR IF NOT                       33400021
         OI    APT3,X'10'    PUT BIT 'STOW AS AREPLACEMENT'             33450021
         BCR   15,14          RETURN                                    33500021
SCNENTRY TM    STAT,X'40'     IS IT LEVEL 1                             33550021
         BC    1,SCN10230     BR TO ERR IF YES                          33600021
         TM    APT1,X'02'     TEST IF ENTRY CARD PREVIOUSLY RECEIVED    33650021
         BCR   1,14           YES,RETURN                                33700021
         MVC   EPSM(8),OPD0   LAY ENTRY POINT SYMBOL INTO APT           33750021
         OI    APT1,X'0E'     SET B6=1=ENTRY NAME BY ENTRY CARD         33800021
*                             &  B5=1=ENTRY POINT IN SYMBOLIC           33850021
*    B4=1=ENTRY POINT RECEIVED                                          33900021
         BCR   15,14             RETURN                                 33950021
SCNLIBRA TM    STAT,X'40'     IS IT LEVEL 1                             34000021
         BC    8,SCN10230     BR TO ERR IF NOT                          34050021
         TM    OPTION,X'20'   IS OPD0 ABSENT                            34100021
         BC    1,LIB110   BR IF YES                                     34150021
         CLI   OPD0,C'*'   IS OPD0 *                                    34200021
         BC    8,LIB080   YES                                           34250021
         L     R6,INDDNMAD     GET SYSLIN DDNAME                 A47001 34260000
         CLC   0(8,R6),OPD0    COMPARE LIBRARY DDNAME            A47001 34270000
         BE    SCN10230        IF SAME, ERROR                    A47001 34280000
         TM    APT0,X'80'   TEST IF NCAL(NO AUT LIB CALL) IS ON         34300021
         BC    1,SCN10230  TO ERROR IF YES                              34350021
         OI    APT0,X'01'  SET SOME LIBRARY CARD HAS BEEN READ,'ON'     34400021
LIB080  ST    14,SAV14L1                                                34450021
         BAL  14,SCNLIBSB  TO SCN LIBR. SUBROUTINE                      34500021
         L    14,SAV14L1     RESTORE 14                                 34550021
         BC   15,LIB110                                                 34600021
**********                                                              34650021
*  THE SUBROUTINE SCNLIBSB                                              34700021
* LOOKS IF THE LIBRARY DDNAME IS ALREADY IN THE CESD . IF YES,USES IT.  34750021
* IF NOT,CREATES ONE NEW LINE FOR IT                                    34800021
SCNLIBSB TM    STAT,X'80'     IS OPD0 NEW                               34850021
         BCR   8,14           BR. IF NOT                                34900021
**                       MATCH OPD0 AGAINST THE CESD                    34950021
*                                                                       35000021
         XR    13,13                                                    35050021
         L     15,CHESD                                                 35100021
LIB090   LA    13,1(13)             UPDATE LINE ID                      35150021
         LA    15,16(15)            UPDATE LINE ADDRESS                 35200021
         CLC   0(8,15),OPD0         COMPARE LINE SYMBOL TO OPD0         35250021
         BC    8,LIB100             BR. IF EQ                           35300021
         CH    13,ENCDC       COMPARE LINE ID TO HIGHEST ID USED        35350021
         BC    4,LIB090             TRY NXT LINE                        35400021
*                                  MATCH NOT FOUND                      35450021
**                                 GO AND GET A FREE LINE IN CESD       35500021
LIB095   ST    14,SAV14L2                                               35550021
         BAL   14,SCNHOL                                                35600021
         L     14,SAV14L2                                               35650021
*  FREE LINE ADDR. IS IN 15 , FREE LINE ID IS IN 13                     35700021
         MVC   0(8,15),OPD0       LAY SYMBOL OPD0 INTO THIS LINE        35750021
         XC    14(2,15),14(15)                                          35800021
         MVI   8(15),X'02'    SET TYPE ER                               35850021
          MVI   13(15),X'B0'    SET SUBTYPE DDNAME                      35900021
LIB100   CLI   8(15),X'02'    IS THE CESD MATCH A DDNAME TYPE           35950021
         BC    7,LIB095       BR. IF NOT                                36000021
         CLI   13(15),X'B0'   IS THE CESD MATCH A DDNAME SUBTYPE        36050021
         BC    7,LIB095       BR. IF NOT                                36100021
         STH   13,DDLINID       SAVE  DDLINE ID                         36150021
         ST    15,DDLINAD       SAVE DD LINE ADDRESS                    36200021
         BCR   15,14          RETURN OF  SCNLIBSB                       36250021
*                                                                       36300021
*                                                                       36350021
*                                                                       36400021
**       MATCH  OPD1 AGAINST CESD ITEMS                                 36450021
*                                                                       36500021
LIB110  XR   13,13                                                      36550021
         L     15,CHESD                                                 36600021
LIB120   LA    13,1(13)            UPDATE LINE ID                       36650021
         LA    15,16(15)           UPDATE LINE ADDRESS                  36700021
         CLC   0(8,15),OPD1        COMPARE LINE SYMBOL TO OPD1          36750021
         BC    8,LIB130            BR. IF EQ                            36800021
         CH    13,ENCDC       COMPARE LINE ID TO HIGHEST ID USED        36850021
         BC    4,LIB120            TRY NXT LINE                         36900021
*                                  MATCH NOT FOUND                      36950021
         BC    15,LIB150           GO AND CREATE A LINE FOR OPD1        37000021
LIB130   MVC   TEMP1(1),8(15)      MOVE MATCHED TYPE                    37050021
         NI    TEMP1,X'07'         MASK OUT MATCHED TYPE                37100021
         CLI   TEMP1,X'02'         IS MATCHED TYPE AN ER                37150021
         BC    7,LIB140            BR. IF NOT                           37200021
         CLI   13(15),X'00'      IS MATCHED SUBTYPE AN ER               37250021
         BC    8,LIB160          BR IFYES                               37300021
         CLI   13(15),X'07'      IS MATCHED SUBTYPE A 'NEVER CALL' OR   37350021
*                                'NO CALL' OR 'LIBRARY MEMBER (MATCHED  37400021
*                                 OR UNMATCHED)'                        37450021
*                        (I.E.: IS SUBTYPE SMALLER THAN 7 . AT THIS     37500021
*                         POINT WE KNOW THAT SUBTYPE GREATER THAN 1 )   37550021
         BC    10,LIB150         BR. IF NOT                             37600021
*                   HERE,BECAUSE OF ITS MATCHING,THE CARD HAS TO BE     37650021
*                   IGNORED                                             37700021
LIB140   NI    IND1,X'7F'        RESET IND1(B0) TO 0                    37750021
         BCR   15,14             RETURN TO SCANNER                      37800021
**                            CREATE A LINE FOR OPD1                    37850021
*                                                                       37900021
LIB150   ST    14,SAV14L1                                               37950021
         BAL   14,SCNHOL      GO AND GET A FREE LINE IN THE  CESD       38000021
         L     14,SAV14L1                                               38050021
         OI    IND1,X'80'     SET IND1(B0=1) INDICATING NW LIN FOR OPD1 38100021
         MVC   0(8,15),OPD1       PUT OPD1 IN THE NEW LINE              38150021
         MVI   8(15),X'02'        SET ITS TYPE = ER                     38200021
LIB160   TM    OPTION,X'20'        TEST IF OPD0 ABSENT                  38250021
         BC    8,LIB180            BR. IF NOT                           38300021
         TM    IND1,X'80'         TEST IF NEW LINE WAS CREATED FOR OPD1 38350021
         BC    1,LIB170                                                 38400021
         MVI   13(15),X'05'       MARK SUBTYPE 'NO CALL,MATCHED'        38450021
         BC    15,LIB140          TOWARD RETURN                         38500021
LIB170   MVI   13(15),X'04'       MARK SUBTYPE 'NO CALL,UNMATCHED'      38550021
         BC    15,LIB140          TOWARD RETURN                         38600021
LIB180   CLI   OPD0,C'*'          TEST IF OPD0 IS *                     38650021
         BC    8,LIB200           BR.IF YES                             38700021
         MVI   9(15),X'00'  ZEROE OUT BYTE FOR LATER BLDL INDIC.        38750021
         TM    IND1,X'80'         TEST IF NEW LIN WAS CREATED FOR OPD1  38800021
         BC    1,LIB190           BR. IF YES                            38850021
         MVI   13(15),X'03'       MARK SUBTYPE'MATCHED LIBRARY MBR.'    38900021
         BC    15,LIB205                                                38950021
LIB190   MVI   13(15),X'02'       MARK SUBTYPE'UNMATCHED LIBR.MBR.'     39000021
         BC    15,LIB205                                                39050021
LIB200   MVI   13(15),X'06'       MARK SUBTYPE'NEVER CALL'              39100021
         BC    15,LIB140          TOWARD RETURN                         39150021
**             THE LINE OF OPD1 WILL BE JOINED TO THIS LIBR. CHAIN      39200021
LIB205   LH    3,DDLINID   INITIATE THE CRRT. LINE ID OF THE CHAIN      39250021
         L     4,DDLINAD      INITIATE THE CURRT.LIN.ADDR. OF THE CHAIN 39300021
LIB210   OC    14(2,04),14(04)   NXT ID OF THE CHAIN =00 ?              39350021
         BC    8,LIB220       BR. IF YES                                39400021
         LH    3,14(04)       UPDATE CURRENT LINE ID                    39450021
         LR    04,03                                                    39500021
         SLL   04,4           MULTIPLY ID BY 16                         39550021
         A     4,CHESD        ADD CHESD.  CURRENT LINE ADDRESS IN REG4  39600021
         BC    15,LIB210                                                39650021
LIB220   STH   13,14(04)      PUT MBR.ID IN'NEXT ID' FIELD OF CRRT.LIN. 39700021
         XC    14(2,15),14(15)    ZERO AS NXT ID AT MEMBER LINE         39750021
         STH   3,10(15)           PUT CRRT.ID AS PREV.ID AT MBR.ADDR.   39800021
         BC    15,LIB140          TOWARD  RETURN                        39850021
SCNINCLU TM    OPTION,X'20'   IS OPD0 ABSENT                            39900021
         BC    1,SCN10230     BR TO ERR IF YES                          39970000
         L     R6,INDDNMAD     GET SYSLIN DDNAME                 A47001 39980000
         CLC   0(8,R6),OPD0    COMPARE LIBRARY DDNAME            A47001 39990000
         BE    SCN10230        IF SAME, ERROR                    A47001 39992000
         ST    14,SAV14L1                                               40000021
         OI    OPTION,X'10'  SET 'INCLUDE CARD ITEM IN PROCESS'         40050021
         TM    STAT,X'40'       IS IT LEVEL=1                           40100021
         BC    8,INC050         BR. IF NOT                              40150021
*           SCNLIBSB LOOKS IN CESD IF DDNAME ALREADY ENTERED            40200021
         BAL   14,SCNLIBSB      DEFINE A LINE IN CESD AS DDLIN FOR OPD0 40250021
INC040   LA    08,INC150       PREPARE EXIT OF SUBROUTINE INC100        40300021
         BC    15,INC100                                                40350021
INC050   LA    08,INC120                                                40400021
*  INC100 IS SUBROUTINE THAT ENCHAINS A NEW ITEM INTO THE INCLUDE CHAIN 40450021
INC100   BAL   14,SCNHOL        TAKE FREE LINE IN CESD                  40500021
         L     07,INCBRKPT                                              40550021
         LTR   07,07            IS 'INCLUDE BREAK POINT ADDRESS' ZERO   40600021
          BC    7,INC110       NO                                       40650021
         XC    9(3,15),9(15)    NULLIFY CHAIN ADDR. OF NEW LINE         40700021
         BC    15,INC115                                                40750021
INC110   MVC   9(3,15),9(07)    PUT THE CHAIN ADDRESS FOUND AT LINE     40800021
*               POINTED TO BY INCBRKPT, AS CHAIN ADDR. OF THE NEW LINE  40850021
* THIS CHAIN ADDR. CAN BE POSITIVE OR NULL(HEAD OF CHAIN)               40900021
         ST    15,8(07)   PUT NEW LINE'S ADDR.AS CHN.ADDR.OF LINE       40950021
         MVI   8(07),X'02'        RESTORE CRUSHED TYPE                  41000021
*                                             POINTED TO BY INCBRKPT    41050021
INC115   ST    15,INCBRKPT        UPDATE INCBRKPT BY ADDR. OF NEW LINE  41100021
         OC    CRRTINCL+1(3),CRRTINCL+1    IS CRRTINCL NULL             41150021
         BC    7,INC117    BR. IF NOT                                   41200021
         ST    15,CRRTINCL      INITIATE CRRTINCL                       41250021
INC117   BCR   15,08      RETURN                                        41300021
INC120   MVC   0(8,15),OPD0    LAY LIBR.SYMBOL OPD0 IN THE NEW CESD LIN 41350021
         MVI   8(15),X'02'     SET TYPE ER                              41400021
         MVI   13(15),X'C0'    SET SUBTYPE 'CONTROL INCLUDE WITHOUT     41450021
*                              POINTER'                                 41500021
         BC    15,INC160                                                41550021
INC150   MVC   0(8,15),OPD1   LAY MBR.SYMBOL OPD1 IN THE NEW CESD LINE  41600021
         MVI   8(15),X'02'    SET TYPE ER                               41650021
         MVI   13(15),X'D0'   SET SUBTYPE 'CONTROL INCL. WITH POINTER'  41700021
         MVC   14(2,15),DDLINID   DDLINID AS THE CHAINED ID             41750021
INC160   L     14,SAV14L1                                               41800021
         BCR   15,14            RETURN TO THE SCANNER                   41850021
SCNALIAS TM    STAT,X'40'     IS IT LEVEL 1                             41900021
         BC    1,SCN10230     BR TO ERR IF YES                          41950021
         ST    R14,SAVRG14             SAV RETRN ADDR   OX04280,OY03413 41952002
         LA    REG9,OPD0               POINT TO NAME    OX04280,OY03413 41954002
         L     R15,ADRVLDCK            GET ADDR OF RTN  OX04280,OY03413 41956002
         BALR  R14,R15                 GO VALIDATE NAME OX04280,OY03413 41958002
         L     R14,SAVRG14             RES RETRN ADDR   OX04280,OY03413 41958402
         LTR   REG9,REG9               TEST VALID NAME  OX04280,OY03413 41958802
         BNZ   SCN10238                BRANCH IF INVAL  OX04280,OY03413 41959202
         LH    15,ENASC       LOAD CRRT NO OF ENTRIES IN ALIAS TABLE    42000021
         LA    15,1(15)       UPDATE IT                                 42050021
         CH    15,ENASX       COMPARE IT TO MAX.NO.OF ALIASES           42100021
         BC    12,ALI090      BR.IF 'LE'                                42150021
         LA    1,OPD0    ADDR OF ALIAS SYMBOL INTO REG 1                42200021
         LH    0,ERR6         TOO MANY ALIASES                          42250021
         BC    15,SCN10235                                              42300021
ALI090   STH   15,ENASC   STORE NEW NO. OF ALIASES                      42350021
         ST    14,SAV14L1                                               42400021
         BAL   14,SCNHOL      GO AND GET A FREE LINE IN THE CESD        42450021
         L     14,SAV14L1                                               42500021
*       FREE LINE ADDR. IN 15 , FREE LINE ID IN 13                      42550021
         XC     9(3,15),9(15)   SET ZERO IN THE CHAIN ADDR OF THIS LINE 42600021
         L     11,ALCB        TEST THE ALIAS CHAIN BEGINNING            42650021
         LTR   11,11                                                    42700021
         BC    8,ALI100       BR. IF 0 .(ALIAS CHAIN DOESNT EXIST)      42750021
         ST    11,8(15)    SLOT PREV. CHN ADDR INTO NEW ALIAS LINE      42800021
         MVI   8(15),X'02'    RESTORE CRUSHED TYPE                      42850021
ALI100   ST    15,ALCB        SLOT FREEADDR AS ALIAS CHAIN BEG.         42900021
         MVC   0(8,15),OPD0   LAY ALIAS SYMBOL (OPD0)INTO THE LINE      42950021
         MVI   8(15),X'02'    SET TYPE ER                               43000021
         MVI   13(15),X'A0'   SET SUBTYPE 'CONTROL ALIAS'               43050021
         BCR   15,14          RETURN                                    43100021
SCNSETSI EQU   *                                                        43150021
         TM    STAT,X'40'     IS IT LEVEL 1                             43200021
         BC    1,SCN10230     BR TO ERR IF YES                          43250021
         LA    3,8    INIT CHAR SELECTION                               43300021
SETSI010 IC    SSINFO,OPD0-1(3)    TAKE CURRENT DIGIT FROM OPD0  Y01048 43350000
         STC   SSINFO,TEST         SAVE DIGIT IN TEST            Y01048 43400000
         LA    TREG,TRANS          INIT SCAN OF TRANS TABLE      Y01048 43450000
         LA    15,16    COUNT FOR TRANS                                 43500021
SETSI015 CLC   TEST(1),0(TREG)     CHECK CURR DIGIT VS TRANS TAB Y01048 43550000
         BNE   SETSI050                                          Y01048 43600000
         IC    SSINFO,1(TREG)      OBTAIN BINARY EQUIVALENT      Y01048 43650000
         SRDL  SSINFO,4            SHIFT USEFUL INFO INTO SAVR7  Y01048 43700000
         BCT   3,SETSI010    NEXT DIGIT                                 43750021
         ST    SAVR7,SSI           STORE SSI INTO THE APT        Y01048 43800000
         OI    APT2,X'10'   SET 'STATUS INDICATOR RECEIVED'             43850021
         BCR   15,14    RETURN                                          43900021
SETSI050 LA    TREG,2(TREG)        POINT TO NEXT ENTRY IN TABLE  Y01048 43950000
         BCT   15,SETSI015                                              44000021
         BC    15,SCN10230   TO ERROR (CHAR NOT 0-9   A-F  )            44050021
*         *         *         *         *         *         *         * 44100021
*                                                                     * 44150021
*    SUBROUTINE SCNHIARC CHECKS FOR AND SAVES VALID LHN (HIERARCHY    * 44200021
*   NUMBER).  IT THEN LOOKS IF A NAME IS ALREADY IN CESD.             * 44250021
*          IF YES,  IT PUTS THE SAVED HN IN THE CORRESPONDING         * 44300021
*   HIAR TABLE ENTRY                                                  * 44350021
*           IF NO,  A LINE IS CREATED IN THE CESD--AND THIS ENTRY     * 44400021
*    NUMBER IS USED TO PLACE THE HN.                                  * 44450021
*                                                                     * 44500021
*         *         *         *         *         *         *         * 44550021
R6       EQU   6                                                        44600021
PTR      EQU   7                                                 Y01048 44650000
SCNHIARC TM    NEWSW,X'04'          IS HIAR OPTION BIT ON               44750021
         BC    8,SCN10230     NO- ERROR- CARD IGNORED                   44800021
         TM    STAT,X'40'     IS IT LEVEL 1  (NO PARENS FOR OPERANDS)   44850021
         BC    1,SCN10230     YES- ERROR-CARD IGNORED                   44900021
         TM    OPTION,X'04'   HAS HN BEEN FOUND                         44950021
         BC    1,HIAR100      YES                                       45000021
* FIND HN (HIARCHY NUMBER)                                              45050021
         TM    STAT,X'02'     DID SYMBOL END WITH COMMA                 45100021
         BC    8,SCN10230     NO- ERROR- CARD IGNORED                   45150021
* IS  HN VALID                                                          45200021
*   NOTE -- CHECKS HAVE BEEN DONE IN A MANNER WHICH SHOULD ALLOW      * 45250021
*            FOR CHANGE IN THE RANGE OF A VALID HN                    * 45300021
*    ARE ALL CHARACTERS DIGITS 0-9                                      45350021
         LA    PTR,OPD0       ADDRESS OF SYMBOL                         45400021
*              P2,WILL HAVE ADDR OF 1 PAST LAST BYTE OF SYMBOL          45450021
         SR    P2,PTR         P2 = NUMBER CHARACTERS IN SYMBOL          45500021
         LA    R6,3                                                     45550021
         CR    P2,R6                    IS SYMBOL MORE THAN 3 CHARACS   45600021
         BH    SCN10230                 YES-ERROR                       45650021
         LR    R6,P2                                                    45700021
HIAR050  CLI   0(PTR),C'0'              IS CHARACTER BETWEEN 0 AND 9    45750021
         BL    SCN10230                 NO- ERROR                       45800021
         CLI   0(PTR),C'9'                                              45850021
         BH    SCN10230                 NO- ERROR                       45900021
         LA    PTR,1(PTR)               UPDATE ADDRESS                  45950021
         BCT   R6,HIAR050                                               46000021
*  CHARACTERS ARE ALL NUMBERS-- IS THE SYMBOL EITHER 0 OR 1             46050021
*        CONVERT TO BINARY                                            * 46100021
         BCTR  P2,0                DECREMENT 1 FOR ESECUTE PACK         46150021
         EX    P2,PACK                                                  46200021
         CVB   R6,OPD0                                                  46250021
         STH   R6,HN                    SAVE HIERARCHY NUMBER           46300021
         SR    PTR,PTR                                                  46350021
         CR    R6,PTR                   IS HN = OR LESS THAN 0          46400021
         BL    SCN10230                YES -- ERROR                     46450021
         BE    HIAR075                                                  46500021
         BCT   R6,SCN10230             IF GREATER THAN ONE -- ERROR     46550021
HIAR075  OI    OPTION,X'04'            SET HN FOUND BIT                 46600021
         BR    14                                                       46650021
HIAR100  CLC   OPD0(7),COMMON    IS SYMBOL '*COMMON '                   46700021
         BNE   HIAR150                                                  46750021
         MVI   OPD0,C' '           YES- REPLACE SYMBOL WITH BLANKS      46800021
         MVC   OPD0+1(7),OPD0                                           46850021
         OI    OPTION,X'08'        INDICATE '*COMMON ' FOUND            46900021
*                                                                       46950021
* SEARCH CESD FOR IDENTICAL NAME                                      * 47000021
*                                                                       47050021
HIAR150  ST    R1,SAV01L1          SAVE CONTENTS REG 1                  47100021
         LA    R0,16               SET INCREMENT FOR BXLE               47150021
         L     R15,CHESD           START OF CESD                        47200021
         LH    R1,ENCDC            NUMBER ENTRIES IN CESD               47250021
         SLL   R1,4                NUMBER BYTES IN CESD                 47300021
         AR    R1,R15              END ADDRESS CESD (HIGH LIMIT OF BXLE 47350021
         LA    R15,16(R15)         ADDRESS CESD ENTRY                   47400021
HIAR200  CLC   OPD0(8),0(R15)      IS SYMBOL IDENT. WITH THAT IN CESD   47450021
          BNE   HIAR220            NO--CHECK NEXT ENTRY                 47500021
         CLI   8(R15),X'04'        YES--IS TYPE PRIVATE CODE (PC)       47550021
         BNE   HIAR350             IF NOT PC THEN FIND CESD ID          47600021
HIAR220  BXLE  R15,R0,HIAR200      INCREMENT CESD ADDR  END OF TABLE    47650021
*   END OF CESD--SYMBOL NOT FOUND IN  CESD                            * 47700021
         ST    14,SAV14L1          SAVE CONTENTS REG 14                 47750021
         BAL   14,SCNHOL           FIND FREE LINE IN CESD               47800021
         L     14,SAV14L1          RESTORE  R14                         47850021
* FREE LINE ADDRESS IN R15, FREE LINE ID IN R13                         47900021
         MVC   0(8,R15),OPD0       PUT SYMBOL IN CESD                   47950021
         TM    OPTION,X'08'        WAS SYMBOL FOR '*COMMON '            48000021
         BC    1,HIAR300           YES - SET TYPE TO 'CM'               48050021
         MVI   8(R15),X'02'        MARK NEW CESD ENTRY  'ER'            48100021
         XC    9(7,R15),9(R15)         CLEAR REMAINING BYTES     A35957 48150021
*                                                                     * 48200021
*  SET CORRESPONDING ENTRY IN HIAR TABLE TO HN   (USE CESD ID IN R13) * 48250021
*                                                                     * 48300021
HIAR250  L     PTR,HIARADD         GET ADDRESS OF HIARCHY TABLE         48350021
         AR    PTR,R13             GET ADDRESS OF HIARCHY ENTRY         48400021
         MVC   0(1,PTR),HN+1       PUT HN IN APPROPRIATE ENTRY IN TABLE 48450021
         TM    STAT,X'02'          DID SYMBOL END WITH A COMMA          48500021
         BC    1,HIAR290            YES--CONTINUE CHECKING CARD         48550021
* IS NEXT CARD A CONTINUATION CARD- NON-BLANK IN COL72 INDICATES THIS   48600021
         CLI   COL72,C' '          IS COL72 BLANK                       48650021
         BNE   HIAR290             NO- CONTINUATION EXPECTED            48700021
         NI    OPTION,X'FB'        SET HN FOUND BIT = 0                 48750021
*                                  GET NEXT SYMBOL (RETURN TO SCN)      48800021
HIAR290  L     R1,SAV01L1          RESTORE REG1                         48850021
* RETURN TO MAIN SCN RTN                                                48900021
         BR    14                  RETURN                               48950021
*                                                                     * 49000021
HIAR300  MVI   8(R15),X'05'        MARK CESD ENTRY 'CM'                 49050021
         MVC   12(1,R15),CSNO+1    ENTER SEGMENT NUMBER                 49100021
         NI    OPTION,X'F7'        TURN OFF COMMON SWITCH               49150021
         B     HIAR250                                                  49200021
*  FIND CESD ID                                                         49250021
HIAR350  S     R15,CHESD           REL. ADDRESS OF CESD ENTRY           49300021
         SRL   R15,4               CESD ID  (DIVIDE BY 16)              49350021
         LR    R13,R15             PUT ID IN R13                        49400021
         B     HIAR250                                                  49450021
*                                                                       49500021
*    SCNSTCOD--SCANS SETCODE STATEMENT AND IF IT IS VALID THE    Y01048 49510000
*              AUTHORIZATION CODE IS PLACED IN THE APT IN THE    Y01048 49520000
*              FIELD WHICH WILL EVENTUALLY BE PLACED IN THE PDS  Y01048 49530000
*                                                                Y01048 49540000
*              WORK REGISTERS ARE RX AND RY                      Y01048 49542000
*                                                                Y01048 49544000
SCNSTCOD DS    0H                                                Y01048 49546000
         TM    OPTION,X'20'       OPD0 PRESENT                   Y01048 49548000
         BO    SCN10230           NO - ERROR                     Y01048 49548400
         TM    STAT,X'C0'         TWO OPERANDS?                  Y01048 49548800
         BNO   SCN10230           NO - ERROR                     Y01048 49549200
         CLC   AC,OPD0            DOES OPD0='AC'?                Y01048 49549600
         BNE   SCN10230           NO - ERROR                     Y01048 49549700
         LA    RX,OPD1            CHECK FOR VALID DIGITS         Y01048 49549800
         LA    RY,8                                              Y01048 49549900
SCNSTC20 EQU   *                                                 Y01048 49566600
         CLI   0(RX),BLANK        IS THIS END OF FIELD?          Y01048 49576600
         BE    SCNSTC50           YES, BRANCH                    Y01048 49578600
         TM    0(RX),NUMBER       IS THIS A DIGIT?               Y01048 49580600
         BNO   SCN10230           NO - ERROR                     Y01048 49582600
         LA    RX,1(RX)           BUMP TO NEXT DIGIT             Y01048 49583000
         BCT   RY,SCNSTC20        SCAN TILL MAX OF 8 DIGITS      Y01048 49583100
SCNSTC50 EQU   *                                                 Y01048 49583200
         BCTR  RX,0               SUBTRACT 1 FROM END ADDR       Y01048 49588800
         LA    RY,OPD1            GET START ADDR                 Y01048 49590800
         SR    RX,RY              RX HAS MACHINE LGTH OF NUM     Y01048 49592800
         XC    OPD0(8),OPD0       USE OPD0 AS WORK SPACE         Y01048 49593200
         EX    RX,PACK1           PACK DIGIT                     Y01048 49593600
         CVB   RX,OPD0            CONVERT TO BINARY              Y01048 49594000
         LA    RY,K255            GET MAX VALUE                  Y01048 49594100
         CR    RX,RY              COMPARE REAL TO MAX            Y01048 49594200
         BH    SCN10230           IF TOO BIG - ERROR             Y01048 49594300
         STC   RX,PDSAPFAC        SAVE LATEST CODE FOR NOW       Y01048 49608200
         BR    R14                RETURN                         Y01048 49618200
*                                                                       49622200
TRANS   DC    CL1'0'                                                    49636100
         DC    XL1'00'                                                  49650021
        DC    CL1'1'                                                    49700021
         DC    XL1'01'                                                  49750021
        DC    CL1'2'                                                    49800021
         DC    XL1'02'                                                  49850021
        DC    CL1'3'                                                    49900021
         DC    XL1'03'                                                  49950021
        DC    CL1'4'                                                    50000021
         DC    XL1'04'                                                  50050021
        DC    CL1'5'                                                    50100021
         DC    XL1'05'                                                  50150021
        DC    CL1'6'                                                    50200021
         DC    XL1'06'                                                  50250021
        DC    CL1'7'                                                    50300021
         DC    XL1'07'                                                  50350021
        DC    CL1'8'                                                    50400021
         DC    XL1'08'                                                  50450021
        DC    CL1'9'                                                    50500021
         DC    XL1'09'                                                  50550021
        DC    CL1'A'                                                    50600021
         DC    XL1'0A'                                                  50650021
        DC    CL1'B'                                                    50700021
         DC    XL1'0B'                                                  50750021
        DC    CL1'C'                                                    50800021
         DC    XL1'0C'                                                  50850021
        DC    CL1'D'                                                    50900021
         DC    XL1'0D'                                                  50950021
        DC    CL1'E'                                                    51000021
         DC    XL1'0E'                                                  51050021
        DC    CL1'F'                                                    51100021
         DC    XL1'0F'                                                  51150021
         DS    0F                                                       51200021
SAVR     DS    CL64                                                     51250021
SAV14L1  DS    1F                                                       51300021
SAV14L2  DS    1F                                                       51350021
OPD0     DS    1D                                                       51400021
OPD1     DS    1D                                                       51450021
PROCENTY DS    1F             SAVE AREA FOR THE PROCESSOR ENTRY POINT   51500021
SAVACOL  DS    1F           SAVE AREA FOR ADDR. OF COL72                51550021
DDLINAD  DS    1F                                                       51600021
SAV01L1  DS    1F                                                       51650021
         DS    0F                                                       51700021
SPECSTR  DS    H                       FLAG AND COUNT FOR SPEC.  S21016 51750021
*                                      STRINGS (LEV.1 OPERANDS   S21016 51800021
*                                      OF IDENTIFY CONTROL       S21016 51850021
*                                      STATEMENT) FLAG IS IN     S21016 51900021
*                                      HI ORDER BIT OF HALFWORD  S21016 51950021
IDRSTRNG DS    CL40                    STRING OF IDR DATA        S21016 52000021
*                                      SPECIFIED ON AN IDENTIFY  S21016 52050021
*                                      CONTROL STATEMENT         S21016 52100021
*                                      (LEVEL 1 OPERAND)         S21016 52150021
SAVRG1   DS    F                       SAVE REG.1 WHILE          S21016 52200021
*                                      PROCESSING IDENTIFY CARD  S21016 52250021
SAVRG13  DS    F                       SAVE REG.13 WHILE         S21016 52300021
*                                      PROCESSING IDENTIFY CARD  S21016 52350021
SAVRG14  DS    F                       SAVE REG.14 WHILE         S21016 52400021
*                                      PROCESSING IDENTIFY CARD  S21016 52450021
LCLSAVE  DS    18F                     LOCAL SAVE AREA           S21016 52500021
INCLBRAD DC    V(HEWLFINC)                                              52600021
ADRVLDCK DC    V(HEWVLDCK)             ADR VLD CK RTN   OX04280,OY03413 52610002
REGION   DC    C'REGION  '                                              52650021
        DS     0F                                                       52700021
MXNOREG  DC    X'0003'   4 REGIONS ALLOWED.FIRST REGION IS REGION 0     52750021
ERR1     DC    AL2(ERR1LTL)                                             52800021
ERR2     DC    AL2(ERR2LTL)                                             52850021
ERR3     DC    AL2(ERR3LTL)                                             52900021
ERR4     DC    AL2(ERR4LTL)                                             52950021
ERR6     DC    AL2(ERR6LTL)                                             53000021
ERR8     DC    AL2(ERR8LTL)                                      A37667 53020000
ERR10    DC    AL2(ERR10LTL)                                            53050021
INDDNMAD DC    A(INDDNAME)                                       A47001 53080000
CIDRADD  DC    V(HEWLCIDR)             IDR PROCESSOR -- ENTRY    S21016 53100021
*                                      POINT FOR PROCESSING      S21016 53150021
*                                      DATA FROM AN IDENTIFY     S21016 53200021
*                                      CONTROL STATEMENT         S21016 53250021
SPSTRLEN DC    AL2(SPECMAX)            COUNTER VALUE FOR MAX.    S21016 53300021
*                                      LENGTH OF SPEC. STRINGS   S21016 53350021
ENASX    DC    H'16'    MAX. NO. OF ENTRIES IN ALIAS TABLE (HAS...      53400021
*    TO BE SMALLER THAN OR EQUAL TO THE MAX. NO. OF ENTRIES IN ...      53450021
*   THE ALIAS TABLE CREATED BY ADDRESS ASSIGNMENT )                     53500021
CONS    DC   X'00B7'                                                    53550021
DDLINID   DS    1H       ID OF DD LINE FOR LIBRARY OR INCLUDE           53600021
STAT     DC    X'00'     STATUS BYTE FOR THE SCANNER                    53650021
***  MEANING OF THE BITS IN STAT  IS :                                  53700021
***  B0     'OPD0 NEW'   THE OPERAND OF LEVEL 0 IS NEW (WHEN B0=1)      53750021
***  B1     'LEVEL 1 '   THE LEVEL OF THE LAST OPERAND IS 1 (WHEN B1=1) 53800021
***  B2     'CONTIN'   CONTINUATION BIT SET WHEN A CARD HAS THE CONTI-  53850021
**                    -NUATION CONDITION . USED AT THE FOLLOWING CARD   53900021
***  B3     'COMMENT'   THE CONTINUATION CONDITION OF THE PRESENT CARD  53950021
***                     APPLIES TO A COMMENT. NEXT CARD WILL BE A       54000021
***                     COMMENT CARD                                    54050021
***  B4     'END BY )'  THE LAST ALPHANUMERIC STRING IS FOLLOWED BY )   54100021
***  B5     'END BY ('  THE LAST ALPHANUMERIC STRING IS FOLLOWED BY (   54150021
***  B6     'END BY ,'      LAST ALPHAMERIC STRING IS FOLLOWED BY COMMA 54200021
***  B7     'END BY BLANK'  LAST ALPHAMERIC STRING IS FOLLOWED BY BLANK 54250021
OPTION   DC    X'00'      BYTE OF INDICATORE                            54300021
*                                                                     * 54350021
*  VALUE = 1   BIT 0    STRING EXPECTED TO BEGIN WITH BLANKS            54400021
*  VALUE = 1   BIT 1    INDICATES AT LEAST ONE VALID CHARACTER FOUND  * 54450021
*  VALUE = 1   BIT 2    MEANS OPD0 ABSENT                             * 54500021
*  VALUE = 1   BIT 3    PROCESSED AN INCLUDE CARD                     * 54550021
*  VALUE = 1   BIT 4    SYMBOL IS '*COMMON '                          * 54600021
*  VALUE = 1   BIT 5    THE HN (HIARCHY NUMBER) HAS BEEN FOUND        * 54650021
*  VALUE = 1   BIT 6    STRING MAY CONTAIN BLANKS AND SPECIAL  S21016 * 54700021
*                       CHARACTERS BETWEEN APOSTROPHES AND/OR  S21016 * 54750021
*                       MAY BE UP TO 40 CHARACTERS IN LENGTH   S21016 * 54800021
OLDSTAT  DC    X'00' OLD STATUS BYTE FOR THE SCANNER                    54900021
STATREPL DC    XL1'00'                                                  54950021
*                         B0=0='ENTERED BY CHANGE'                      55000021
COL72    DC    X'00' SAVE AREA FOR CHARACTER OF COLUMN 72               55050021
TEMP1    DC    X'00'                                                    55100021
         DS    50F                                                      55150021
HN       DC    H'00'              HIERARCHY NUMBER                      55200021
COMMON   DC    C'*COMMON '                                              55250021
PACK     PACK  OPD0(8),OPD0(0)                                          55300021
TEST     EQU   TEMP1                                                    55350021
IND1     DC    X'00'                                                    55400021
PREVSEG  DC    X'00'                                                    55450021
BLANK    EQU   C' '               BLANK                          Y01048 55460000
NUMBER   EQU   X'F0'              ZONE FOR DIGITS                Y01048 55470000
K255     EQU   255                MAX AUTH CODE                  Y01048 55480000
PACK1    PACK  OPD0(8),OPD1(0)    PACK AUTH CODE                 Y01048 55490000
AC       DC    CL8'AC      '      KEY WORD FOR AUTH CODE         Y01048 55492000
         EJECT                                                          55500000
*********************************************************************** 55550021
*                                                                     * 55600021
*                  SUB-PROGRAM SCNIDENT PROCESSES                     * 55650021
*                  USER-SUPPLIED IDR DATA FROM THE                    * 55700021
*                  IDENTIFY CONTROL STATEMENT                         * 55750021
*                                                              S21016 * 55800021
*********************************************************************** 55850021
         SPACE 2                                                 S21016 55900021
SCNIDENT TM    STAT,LEVEL1             TEST IF LEV.1 OPRND FOUND S21016 55950021
         BNO   SCN10230                IF NOT, BRANCH TO ERROR   S21016 56000021
         TM    OPTION,NOLEV0           TEST IF PREVIOUS OPERAND  S21016 56050021
*                                      WAS LEVEL 0               S21016 56100021
         BO    SCN10230                IF NOT, BRANCH TO ERROR   S21016 56150021
         NC    SPECSTR(2),SPECSTR      ANY VALID REC'D  XA05437,ZM30869 56160002
         BZ    SCN10230                BR IF NOT TO ERR XA05437,ZM30869 56170002
         ST    R1,SAVRG1               SAVE REG.1 CONTENTS       S21016 56200021
         LA    R1,PARMLIST             POINT REG.1 TO PARAMETER  S21016 56250021
*                                      LIST TO BE PASSED TO      S21016 56300021
*                                      IDR PROCESSOR             S21016 56350021
         STM   SAPTR,R14,SAVRG13       SAVE REG.13 CONTENTS      S21016 56400021
*                                      AND RETURN ADDR.          S21016 56450021
         LA    SAPTR,LCLSAVE           POINT TO LOCAL SAVE AREA  S21016 56500021
         L     R15,CIDRADD             GET ADDRESS OF IDR        S21016 56550021
*                                      PROCESSOR                 S21016 56600021
         BALR  R14,R15                 GO TO IDR PROCESSOR       S21016 56650021
*                                                                S21016 56700021
*                                      RETURN FROM IDR PROCESSOR S21016 56750021
         LM    SAPTR,R14,SAVRG13       RESTORE REG.13 CONTENTS   S21016 56800021
*                                      AND RETURN ADDR.          S21016 56850021
         L     R1,SAVRG1               RESTORE REG.1 CONTENTS    S21016 56900021
         BR    R14                     RETURN TO CONTINUE        S21016 56950021
*                                      SCANNING                  S21016 57000021
PARMLIST DS    0F                      PARAMETER LIST FOR IDR    S21016 57050021
*                                      MODULE                    S21016 57100021
IDNTSECT DC    A(OPD0)                 ADDR. OF CSECT NAME (LEV. S21016 57150021
*                                      0 OPRND OF IDENTIFY CARD) S21016 57200021
IDNTLEN  DC    A(SPECSTR)              ADDR. OF LENGTH OF IDR    S21016 57250021
*                                      DATA FROM IDENTIFY CARD   S21016 57300021
IDNTSTR  DC    A(IDRSTRNG)             ADDR. OF IDR DATA FROM    S21016 57350021
*                                      IDENTIFY CARD (LEVEL 1    S21016 57400021
*                                      OPERAND)                  S21016 57450021
         EJECT                                                          57500000
**********************************************************************  57550000
*                                                                    *  57600000
*        SUB-PROGRAM SCNEXPND CALLS HEWLFRAT TO ADD PATCH TEXT       *  57650000
*        TO THE END OF CONTROL SECTIONS SPECIFIED ON EXPAND          *  57700000
*        CONTROL STATEMENTS.  IF A NAMED COMMON SECTION IS           *  57750000
*        SPECIFIED ON AN EXPAND CARD, ITS LENGTH IS INCREASED        *  57800000
*        IN THE CESD.                                                *  57850000
*                                                                    *  57900000
*              RX AND RY ARE USED AS WORK REGISTERS.                 *  57950000
*                                                                    *  58000000
*                                                             Y01031 *  58050000
**********************************************************************  58100000
         SPACE 2                                                 Y01031 58150000
SCNEXPND TM    STAT,LEVEL1             TEST IF LEV.1 OPRND FOUND Y01031 58200000
         BNO   SCN10230                IF NOT, BRANCH TO ERROR   Y01031 58250000
         TM    OPTION,NOLEV0           TEST IF PREVIOUS OPERAND  Y01031 58300000
*                                      WAS LEVEL 0               Y01031 58350000
         BO    SCN10230                IF NOT, BRANCH TO ERROR   Y01031 58400000
         LA    RX,OPD1                 CHECK FOR VALID DIGITS    Y01031 58450000
         LA    RY,8                    IN THE LEVEL 1 OPERAND    Y01031 58500000
SCNXPD10 EQU   *                                                 Y01031 58550000
         CLI   0(RX),BLANK             IS THIS END OF FIELD?     Y01031 58600000
         BE    SCNXPD20                YES, BRANCH               Y01031 58650000
         TM    0(RX),NUMBER            IS THIS A DIGIT?          Y01031 58700000
         BNO   SCN10230                NO - ERROR                Y01031 58750000
         LA    RX,1(RX)                BUMP TO NEXT DIGIT        Y01031 58800000
         BCT   RY,SCNXPD10             SCAN TILL MAX OF 8 DIGITS Y01031 58850000
SCNXPD20 EQU   *                                                 Y01031 58900000
         BCTR  RX,0                    SUBTRACT 1 FROM END ADDR  Y01031 58950000
         LA    RY,OPD1                 GET START ADDR            Y01031 59000000
         SR    RX,RY                   RX HAS MACH. LGTH OF NUM  Y01031 59050000
         MVC   XPDSECT,OPD0            MOVE SECTION NAME         Y01031 59100000
         XC    OPD0(8),OPD0            USE OPD0 AS WORK SPACE    Y01031 59150000
         EX    RX,PACK1                PACK DIGIT                Y01031 59200000
         CVB   RX,OPD0                 CONVERT TO BINARY         Y01031 59250000
         LA    RY,K4095                GET MAX VALUE             Y01031 59300000
         CR    RX,RY                   COMPARE REAL TO MAX       Y01031 59350000
         BNH   SCNXPD30                IF < OR =, BRANCH         Y01031 59400000
         LR    RX,RY                   IF TOO BIG, TAKE MAX      Y01031 59450000
SCNXPD30 EQU   *                                                 Y01031 59500000
         STH   RX,XPDLEN               STORE LENGTH OF EXPANSION Y01031 59550000
*                                                                       59600000
*              SEARCH CESD FOR CSECT NAME TO BE EXPANDED         Y01031 59650000
*                                                                       59700000
         L     RX,CHESD                GET ADDR. OF CESD-16      Y01031 59750000
         LA    RX,CESDWTH(RX)          GET ADDR. OF 1ST LINE     Y01031 59800000
         LH    RY,ENCDC                GET NO. LINES IN CESD     Y01031 59850000
         LTR   RY,RY                   IS CESD SIZE ZERO?       OX03080 59860003
         BZ    SCN10230                ERROR IF NO CESD ENTRIES OX03080 59870003
         SLL   RY,FOUR                 MULTIPLY BY 16            Y01031 59900000
         AR    RY,RX                   GET ADDR. OF END OF CESD  Y01031 59950000
SCNXPD40 CLC   XPDSECT(LEN8),DISP0(RX) IS THIS THE CSECT?        Y01031 60000000
         BNE   SCNXPD50                IF NOT, BRANCH            Y01031 60050000
         TM    CESDTYPE(RX),SECTION    IS IT SD, PC OR CM?       Y01031 60100000
         BZ    SCNXPD60                IF SO,BRANCH              Y01031 60150000
SCNXPD50 LA    RX,CESDWTH(RX)          UPDATE TO NEXT LINE       Y01031 60200000
         CR    RX,RY                   END OF THE CESD?          Y01031 60250000
         BE    SCN10230                IF SO, IT IS AN ERROR     Y01031 60300000
         B     SCNXPD40                IF NOT, TEST NEXT LINE    Y01031 60350000
SCNXPD60 TM    CESDTYPE(RX),DELETE     IS IT MARKED DELETE?      Y01031 60360000
         BO    SCNXPD50                IF SO, CONTINUE SEARCH    Y01031 60370000
         L     RY,LENGTH(RX)           GET LENGTH OF SECTION     Y01031 60392000
         LA    RY,DISP0(RY)            CLEAR HIGH-ORDER BYTE     Y01031 60392400
         ST    RY,SAVELEN              SAVE UNEXPANDED LENGTH    Y01031 60392800
         AH    RY,XPDLEN               ADD EXPAND LENGTH         Y01031 60394000
         LA    RY,RNDUP(RY)            ADD 7 TO LENGTH           Y01031 60394417
         N     RY,DBLWD                ROUND TO DOUBLE WORD      Y01031 60394817
         ST    RY,TMPLEN               SAVE EXPANDED LENGTH      Y01031 60396000
         S     RY,SAVELEN              CALC TRUE EXPAND LENGTH  ZA01400 60398002
         STH   RY,XPDLEN               SAVE TRUE EXPAND LENGTH  ZA01400 60398102
         A     RY,SAVELEN              RESTORE EXPANDED LENGTH  ZA01400 60398202
         MVC   LENGTH+1(LEN3,RX),TMPLEN+1  UPDATE CESD LENGTH    Y01031 60398400
         TM    CESDTYPE(RX),COMSCT     IS IT A COMMON SECTION?   Y01031 60398500
         BNO   SCNXPD70                IF NOT, PROCESS AS AN SD  Y01031 60398600
         MVC   CMNAME,XPDSECT          MOVE CM NAME TO MESSAGE   Y01031 60398800
         UNPK  CMLEN(LEN5),XPDLEN(LEN3)  GET EXPAND LENGTH       Y01031 60399200
         NC    CMLEN(LEN4),ZONE        TURN OFF ZONE BITS        Y01031 60399600
         TR    CMLEN(LEN4),TRTAB       MAKE IT PRINTABLE         Y01031 60399700
         MVI   CMLEN+4,BLANK           CLEAR SIGN BYTE           Y01031 60403900
         ST    R1,SAVEONE              SAVE REGISTER ONE         Y01031 60405900
         LA    R1,XCMMSG               POINT TO THE MESSAGE      Y01031 60408200
         B     SCNXPD80                GO TO PRINT IT            Y01031 60412400
SCNXPD70 S     RX,CHESD                GET OFFSET TO CESD LINE   Y01031 60433300
         SRL   RX,FOUR                 DIVIDE BY 16 TO GET ESDID Y01031 60450000
         STH   RX,XPDID                SAVE CESDID               Y01031 60500000
         STM   R0,R15,SAVERGS          SAVE REGS. 0 THRU 15      Y01031 60550000
         L     R3,SAVELEN              ADDR. OF TEXT FOR RAT     Y01031 60570000
         L     R4,TMPLEN               GET EXPANDED CSECT LENGTH Y01031 60580017
         SR    R4,R3                   SUBTRACT OLD LNGTH TO GET Y01031 60582017
*                                      LENGTH OF TEXT FOR RAT    Y01031 60584017
         SR    R6,R6                   NO ID-LEN LIST PASSED     Y01031 60590000
         OI    APTSW3,XPDIND           INDICATE EXPAND ACTIVE    Y01031 60592000
         OI    APT0,TXTIND             INDICATE TEXT PROCESSING  Y01031 60594000
         OI    APT1,LMIND              INDICATE LOAD MODULE      Y01031 60596000
         L     R15,XPDTXTAD            GET EPA OF HEWLFRAT       Y01031 60600000
         LA    R13,REGSA               POINT TO SAVE AREA        Y01031 60610000
         ST    BASE,TMPBASE1           SAVE 1ST BASE REGISTER    Y01031 60612000
         ST    BASE2,TMPBASE2          SAVE 2ND BASE REGISTER    Y01031 60614000
         LR    R5,RX                   CESDID OF TEXT FOR RAT    Y01031 60620000
         CNOP  2,4                     INSURE FULLWORD ALIGNMENT Y01031 60630000
*                                      FOR RETURN ADDR FROM BALR Y01031 60640000
         BALR  R14,R15                 LINK TO TXT EXPAND RTN    Y01031 60650000
         B     DISP12(R15)             BRANCH AROUND SAVE AREA   Y01031 60650100
TMPBASE1 DS    1F                      SAVE AREA FOR 1ST BASEREG Y01031 60650200
TMPBASE2 DS    1F                      SAVE AREA FOR 2ND BASEREG Y01031 60650300
         L     BASE,DISP4(R15)         RESTORE 1ST BASE REGISTER Y01031 60658800
         L     BASE2,DISP8(R15)        RESTORE 2ND BASE REGISTER Y01031 60660800
         NI    APTSW3,XPDOFF           TURN OFF EXPAND ACTIVE    Y01031 60667500
         NI    APT0,TXTOFF             TURN OFF TEXT PROCESSING  Y01031 60676000
         NI    APT1,LMOFF              TURN OFF LOAD MODULE      Y01031 60684500
         LM    R0,R15,SAVERGS          RESTORE REGS. 0 THRU 15   Y01031 60693000
         MVC   SDNAME,XPDSECT          MOVE CSECT NAME TO MSG    Y01031 60701500
         UNPK  SDLEN(LEN5),XPDLEN(LEN3)  GET EXPAND LENGTH       Y01031 60710000
         NC    SDLEN(LEN4),ZONE        TURN OFF ZONE BITS        Y01031 60720000
         TR    SDLEN(LEN4),TRTAB       MAKE IT PRINTABLE         Y01031 60730000
         MVI   SDLEN+4,BLANK           CLEAR SIGN BYTE           Y01031 60740000
         UNPK  SDLOC(LEN7),SAVELEN+1(LEN4)  GET EXPAND OFFSET    Y01031 60742000
         NC    SDLOC(LEN6),ZONE        TURN OFF ZONE BITS        Y01031 60744000
         TR    SDLOC(LEN6),TRTAB       MAKE IT PRINTABLE         Y01031 60744400
         MVI   SDLOC+6,PERIOD          CLEAR SIGN BYTE           Y01031 60744800
         ST    R1,SAVEONE              SAVE REGISTER ONE         Y01031 60745200
         LA    R1,XSDMSG               POINT TO THE MESSAGE      Y01031 60746000
SCNXPD80 STM   R13,R15,SAVDEF          SAVE REGS. 13,14 & 15     Y01031 60748000
         L     R15,ERDIG               GET EPA OF LOG ROUTINE    Y01031 60748100
         ST    R0,SAVEZERO             SAVE REGISTER ZERO        Y01031 60748200
         LH    R0,XPDMSG               LOAD MESSAGE CODE         Y01031 60748400
         OI    IDRSWS,IDRMSG           INDICATE R1 -> MSG LINE   Y01031 60748800
         BALR  R14,R15                 LINK TO MESSAGE LOG RTN   Y01031 60749200
         LM    R13,R15,SAVDEF          RESTORE REGS. 13,14 & 15  Y01031 60749600
         LM    R0,R1,SAVEZERO          RESTORE REGISTERS 0 & 1   Y01031 60762200
         NI    IDRSWS,MSGOFF           TURN OFF SPECIAL MSG IND. Y01031 60774800
         BR    R14                     RETURN TO MAIN LINE       Y01031 60787400
XPDSECT  DS    CL8                     CSECT NAME FOR EXPAND     Y01031 60800000
XPDTXTAD DC    V(HEWLFRAT)             EP ADDR. OF FRAT FOR      Y01031 60850000
*                                      TEXT EXPANSION            Y01031 60900000
SAVERGS  DS    16F                     SAVE REGS. 0 THRU 15      Y01031 60950000
SAVDEF   EQU   SAVERGS+52              SAVE REGS. 13 THRU 15     Y01031 60960000
SAVEZERO DS    2F                      SAVE REGISTER ZERO        Y01031 60970000
SAVEONE  EQU   SAVEZERO+4              SAVE REGISTER ONE         Y01031 60972000
SAVELEN  DC    F'0'                    SAVE UNEXPANDED SD LENGTH Y01031 60980000
TMPLEN   DC    F'0'                    SAVE EXPANDED CM LENGTH   Y01031 60990000
XCMMSG   DS    0F                      MSG LINE FOR A COMMON     Y01031 60992000
CMLEN    DS    CL5                     NO. OF BYTES ADDED        Y01031 60994000
         DC    C'BYTES HAVE BEEN ADDED TO COMMON SECT.'     MSG  Y01031 60996037
CMNAME   DS    CL8                     COMMON NAME               Y01031 60998000
         DC    C'.'                    MSG TEXT                  Y01031 60998400
         DC    26C' '                  MSG TEXT                  Y01031 60998500
XSDMSG   DS    0F                      MSG LINE FOR A CSECT      Y01031 60998800
SDLEN    DS    CL5                     NO. OF BYTES ADDED        Y01031 60999200
         DC    C'BYTES HAVE BEEN ADDED TO CONTROL SECT.'  MSG    Z01418 60999637
SDNAME   DS    CL8                     CSECT NAME                Y01031 60999700
         DC    C' AT OFFSET '          MSG TEXT                  Y01031 60999800
SDLOC    DS    CL7                     CSECT OFFSET FOR EXPAND   Y01031 60999900
         DC    8C' '                   MSG TEXT                  Y01031 61009900
PERIOD   EQU   C'.'                    MSG TEXT                  Y01031 61016600
         DS    0H                      HALF-WORD ALIGNMENT       Y01031 61018600
XPDMSG   DC    X'104A'                 EXPAND SUCCESS MESSAGE    Y01031 61020600
XPDLEN   DC    H'0'                    LENGTH FOR AN EXPAND      Y01031 61026600
XPDID    DC    H'0'                    CESDID FOR AN EXPAND      Y01031 61028600
ZONE     DC    X'0F0F0F0F0F0F'         MASK TO TURN OFF ZONE     Y01031 61030600
*                                      BITS AFTER UNPACK         Y01031 61032600
TRTAB    DC    C'0123456789ABCDEF'     TRANSLATION TABLE         Y01031 61033000
DBLWD    DS    0F                      MASK TO ROUND LENGTH      Y01031 61033117
         DC    X'FFFFFFF8'             TO A DOUBLE WORD          Y01031 61033217
RNDUP    EQU   7                       ADD-ON TO INSURE ROUNDING Y01031 61038817
*                                      UP AND NOT DOWN           Y01031 61040817
K4095    EQU   4095                    MAX.LENGTH FOR EXPAND     Y01031 61044417
FOUR     EQU   4                       SHIFT LENGTH OF 4 BITS    Y01031 61050000
CESDWTH  EQU   8                       WIDTH OF A  CESD LINE     Y01031 61100000
LEN3     EQU   3                       LENGTH OF 3 BYTES         Y01031 61160000
LEN4     EQU   4                       LENGTH OF 4 BYTES         Y01031 61170000
LEN5     EQU   5                       LENGTH OF 5 BYTES         Y01031 61172000
LEN6     EQU   6                       LENGTH OF 6 BYTES         Y01031 61174000
LEN7     EQU   7                       LENGTH OF 7 BYTES         Y01031 61176000
LEN8     EQU   8                       LENGTH OF 8 BYTES         Y01031 61180000
DISP0    EQU   0                       DISPLACEMENT OF ZERO      Y01031 61200000
DISP4    EQU   4                       DISPLACEMENT OF 4 BYTES   Y01031 61202000
DISP8    EQU   8                       DISPLACEMENT OF 8 BYTES   Y01031 61204000
DISP12   EQU   12                      DISPLACEMENT OF 12 BYTES  Y01031 61206000
R4       EQU   4                       REGISTER 4                Y01031 61210000
R5       EQU   5                       REGISTER 5                Y01031 61220000
CESDTYPE EQU   8                       DISPLACEMENT TO TYPE      Y01031 61250000
*                                      FIELD IN A CESD LINE      Y01031 61300000
LENGTH   EQU   12                      DISPLACEMENT TO LENGTH    Y01031 61310000
*                                      FIELD IN A CESD LINE      Y01031 61320000
SECTION  EQU   X'02'                   MASK TO TEST FOR ALL      Y01031 61350000
*                                      CESD TYPES OTHER THAN     Y01031 61400000
*                                      SD, PC OR CM              Y01031 61450000
COMSCT   EQU   X'05'                   MASK TO TEST FOR A CM     Y01031 61460000
DELETE   EQU   X'10'                   MASK FOR CESD DELETE BIT  Y01031 61500000
IDRMSG   EQU   X'20'                   MASK TO LOG XPD MSG       Y01031 61510000
MSGOFF   EQU   X'DF'                   MASK TO RESET MSG SWITCH  Y01031 61520000
XPDIND   EQU   X'80'                   MASK TO SET XPAND SWITCH  Y01031 61550000
TXTIND   EQU   X'02'                   MASK TO SET TEXT SWITCH   Y01031 61600000
LMIND    EQU   X'20'                   MASK TO SET LOAD MOD SWCH Y01031 61650000
XPDOFF   EQU   X'7F'                   TO RESET XPAND SWITCH     Y01031 61700000
TXTOFF   EQU   X'FD'                   TO RESET TEXT SWITCH      Y01031 61750000
LMOFF    EQU   X'DF'                   TO RESET LOAD MOD SWCH    Y01031 61800000
         HEWAPT                                                         70000000
         END                                                            70050000
