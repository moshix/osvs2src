         TITLE '*/* IRBMFDHP - CHANNEL INTERVAL MEASUREMENT GATHERING M*00001000
               ODULE   '                                                00002000
IRBMFDHP CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IRBMFDHP  74.087'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         MVC   @PC00001(36),0(@01)                                 0001 00022000
*   STSMSAVE=GPR13P;                                               0018 00023000
*                                                                  0018 00024000
         L     @10,@PC00001                                        0018 00025000
         L     @10,DHSMAPTR(,@10)                                  0018 00026000
         ST    GPR13P,STSMSAVE(,@10)                               0018 00027000
*   /*****************************************************************/ 00028000
*   /*                                                               */ 00029000
*   /* MACDATE Y-2 73018                                             */ 00030000
*   /*                                                               */ 00031000
*   /*****************************************************************/ 00032000
*                                                                  0019 00033000
*   RESPECIFY                                                      0019 00034000
*    (GPR13P)UNRESTRICTED;                                         0019 00035000
*                                                                  0020 00036000
*/* BEGIN MAINLINE PROCESSING.  THIS MODULE IS EXECUTED IN THREE   0020 00037000
*       SECTIONS: PROLOG, MOVE, AND EPILOG.  ALL PROLOG SECTIONS IN     00038000
*       ALL INTERVAL-DRIVEN MG ROUTINES ARE GIVEN CONTROL BY ESVC14     00039000
*       FIRST.  THEN ALL MOVE SECTIONS GET CONTROL, ETC.  THIS     0020 00040000
*       NECESSITATES SPECIAL RETURN LINKAGE TO ESVC14 WHICH PRESERVES   00041000
*       DATA AND CODE ADDRESSABILITY.  THE MACRO NAME FOR THIS RETURN   00042000
*       AND REENTRY LINKAGE IS IRBBREAK                              */ 00043000
*                                                                  0020 00044000
*   /*****************************************************************/ 00045000
*   /*                                                               */ 00046000
*   /* PROLOG. THIS SECTION OBTAINS AND FIXES INTERVAL DATA STORAGE. */ 00047000
*   /* IT ALSO FIXES THE MOVE SECTION AND ALL DATA WHICH THAT SECTION*/ 00048000
*   /* OF CODE REFERENCES.                                           */ 00049000
*   /*                                                               */ 00050000
*   /*****************************************************************/ 00051000
*                                                                  0020 00052000
*   DHDTAPTR=STSMIADD;              /* LAST WRAP VALUES TO OUTPUT  0020 00053000
*                                      POINTER                       */ 00054000
*                                                                  0020 00055000
         MVC   DHDTAPTR(4),STSMIADD(@10)                           0020 00056000
*   /*****************************************************************/ 00057000
*   /*                                                               */ 00058000
*   /* FIX PROGRAM AND LOCAL DATA                                    */ 00059000
*   /*                                                               */ 00060000
*   /*****************************************************************/ 00061000
*                                                                  0021 00062000
*   DHPAGECB=DHECBRST;              /* RESET ECB                     */ 00063000
*                                                                  0021 00064000
         SR    @10,@10                                             0021 00065000
         ST    @10,DHPAGECB                                        0021 00066000
*   /*****************************************************************/ 00067000
*   /*                                                               */ 00068000
*   /* MACDATE Y-2 73018                                             */ 00069000
*   /*                                                               */ 00070000
*   /*****************************************************************/ 00071000
*                                                                  0022 00072000
*   RESPECIFY                                                      0022 00073000
*    (GPR00P,                                                      0022 00074000
*     GPR01P,                                                      0022 00075000
*     GPR14P,                                                      0022 00076000
*     GPR15P)RESTRICTED;                                           0022 00077000
*   GENERATE SETS(DHPAGECB);                                       0023 00078000
*                                                                  0023 00079000
         LA    GPR00P,DHPAGECB      ECB ADDRESS                         00080000
DHPAGFX1 PGFIX R,A=IRBMFDHP,EA=@ENDDATA,ECB=(GPR00P),LONG=N,           X00081000
               RELATED=(MFDHPGFX,IRBMFDHP(DHPAGFX4),IRBMFTRM(TR0110))   00082000
         WAIT  ECB=DHPAGECB                                             00083000
*   /*****************************************************************/ 00084000
*   /*                                                               */ 00085000
*   /* MACDATE Y-2 73018                                             */ 00086000
*   /*                                                               */ 00087000
*   /*****************************************************************/ 00088000
*                                                                  0024 00089000
*   RESPECIFY                                                      0024 00090000
*    (GPR00P,                                                      0024 00091000
*     GPR01P,                                                      0024 00092000
*     GPR14P,                                                      0024 00093000
*     GPR15P)UNRESTRICTED;                                         0024 00094000
*                                                                  0024 00095000
*   /*****************************************************************/ 00096000
*   /*                                                               */ 00097000
*   /* FIX AUTOMATIC DATA STORAGE                                    */ 00098000
*   /*                                                               */ 00099000
*   /*****************************************************************/ 00100000
*                                                                  0025 00101000
*   DHPAGECB=DHECBRST;              /* RESET ECB                     */ 00102000
*                                                                  0025 00103000
         SR    @10,@10                                             0025 00104000
         ST    @10,DHPAGECB                                        0025 00105000
*   /*****************************************************************/ 00106000
*   /*                                                               */ 00107000
*   /* MACDATE Y-2 73018                                             */ 00108000
*   /*                                                               */ 00109000
*   /*****************************************************************/ 00110000
*                                                                  0026 00111000
*   RESPECIFY                                                      0026 00112000
*    (GPR00P,                                                      0026 00113000
*     GPR01P,                                                      0026 00114000
*     GPR14P,                                                      0026 00115000
*     GPR15P)RESTRICTED;                                           0026 00116000
*   GENERATE SETS(DHPAGECB);                                       0027 00117000
*                                                                  0027 00118000
         LA    GPR15P,@ENDDATD      END ADDRESS                         00119000
         LA    GPR00P,DHPAGECB      ECB ADDRESS                         00120000
         LA    GPR01P,@DATD         BEGINNING ADDRESS                   00121000
DHPAGFX2 PGFIX R,A=(GPR01P),EA=(GPR15P),ECB=(GPR00P),LONG=N,           X00122000
               RELATED=(MFDHATFX,IRBMFDHP(DHPAGFX5),IRBMFTRM(TR0210))   00123000
         WAIT  ECB=DHPAGECB                                             00124000
*   /*****************************************************************/ 00125000
*   /*                                                               */ 00126000
*   /* MACDATE Y-2 73018                                             */ 00127000
*   /*                                                               */ 00128000
*   /*****************************************************************/ 00129000
*                                                                  0028 00130000
*   RESPECIFY                                                      0028 00131000
*    (GPR00P,                                                      0028 00132000
*     GPR01P,                                                      0028 00133000
*     GPR14P,                                                      0028 00134000
*     GPR15P)UNRESTRICTED;                                         0028 00135000
*                                                                  0028 00136000
*   /*****************************************************************/ 00137000
*   /*                                                               */ 00138000
*   /* ADD ENTRY TO STORAGE RESOURCE TABLE FOR AUTO DATA MACDATE Y-2 */ 00139000
*   /* 73018                                                         */ 00140000
*   /*                                                               */ 00141000
*   /*****************************************************************/ 00142000
*                                                                  0029 00143000
*   RESPECIFY                                                      0029 00144000
*    (GPR00P,                                                      0029 00145000
*     GPR01P)RESTRICTED;                                           0029 00146000
*   GENERATE;                                                      0030 00147000
         L     GPR00P,@SIZDATD      GET LENGTH OF AUTOMATIC DATA        00148000
         LA    GPR01P,@DATD         ADDRESS OF AUTOMATIC DATA           00149000
*   STSGFREE(STRVNSGT)=GPR00P;      /* SUBPOOL ZERO AND LENGTH       */ 00150000
         L     @10,@PC00001                                        0031 00151000
         L     @10,DHSMAPTR(,@10)                                  0031 00152000
         L     @15,STSMRVT(,@10)                                   0031 00153000
         L     @14,STRVNSGT(,@15)                                  0031 00154000
         LR    @09,@14                                             0031 00155000
         SLA   @09,3                                               0031 00156000
         L     @08,STRVSSGT(,@15)                                  0031 00157000
         LA    @07,0(@09,@08)                                      0031 00158000
         AL    @07,@CF00266                                        0031 00159000
         ST    GPR00P,STSGFREE(,@07)                               0031 00160000
*   STSGADD(STRVNSGT)=GPR01P;       /* ADDRESS                       */ 00161000
*                                                                  0032 00162000
         AL    @08,@CF00267                                        0032 00163000
         ST    GPR01P,STSGADD-4(@09,@08)                           0032 00164000
*   /*****************************************************************/ 00165000
*   /*                                                               */ 00166000
*   /* MACDATE Y-2 73018                                             */ 00167000
*   /*                                                               */ 00168000
*   /*****************************************************************/ 00169000
*                                                                  0033 00170000
*   RESPECIFY                                                      0033 00171000
*    (GPR00P,                                                      0033 00172000
*     GPR01P)UNRESTRICTED;                                         0033 00173000
*   STRVNSGT=STRVNSGT+1;            /* POINT TO NEXT SGT SLOT        */ 00174000
*                                                                  0034 00175000
         AH    @14,@CH00060                                        0034 00176000
         ST    @14,STRVNSGT(,@15)                                  0034 00177000
*   /*****************************************************************/ 00178000
*   /*                                                               */ 00179000
*   /* ALLOCATE STORAGE IN THE USERS KEY FOR INTERVAL DATA MACDATE   */ 00180000
*   /* Y-2 73018                                                     */ 00181000
*   /*                                                               */ 00182000
*   /*****************************************************************/ 00183000
*                                                                  0035 00184000
*   RESPECIFY                                                      0035 00185000
*    (GPR00P,                                                      0035 00186000
*     GPR01P,                                                      0035 00187000
*     GPR14P,                                                      0035 00188000
*     GPR15P)RESTRICTED;                                           0035 00189000
*   GPR00P=STSMIGMC;                /* SET SUBPOOL AND LENGTH INTO 0036 00190000
*                                      REGISTER                      */ 00191000
         L     GPR00P,STSMIGMC(,@10)                               0036 00192000
*   GENERATE;                                                      0037 00193000
DHGETMN1 GETMAIN R,LV=(0),RELATED=(MFDHISGM,IRBMFRGM(RGFREES1),        X00194000
               IRBMFTRM(TR0220),IRBMFDTA(DT200))                        00195000
*   STSMIADD=GPR01P+LENGTH(STSMIGMC);/* POINT TO SMF RCD PORTION OF     00196000
*                                      STORAGE                       */ 00197000
*                                                                  0038 00198000
         L     @10,@PC00001                                        0038 00199000
         L     @10,DHSMAPTR(,@10)                                  0038 00200000
         LA    @09,4                                               0038 00201000
         LR    @08,GPR01P                                          0038 00202000
         AR    @08,@09                                             0038 00203000
         ST    @08,STSMIADD(,@10)                                  0038 00204000
*   /*****************************************************************/ 00205000
*   /*                                                               */ 00206000
*   /* MACDATE Y-2 73018                                             */ 00207000
*   /*                                                               */ 00208000
*   /*****************************************************************/ 00209000
*                                                                  0039 00210000
*   RESPECIFY                                                      0039 00211000
*    (GPR00P,                                                      0039 00212000
*     GPR01P,                                                      0039 00213000
*     GPR14P,                                                      0039 00214000
*     GPR15P)UNRESTRICTED;                                         0039 00215000
*   DHSMIADD=STSMIADD;              /* MOVE TO TEMPORARY STARAGE     */ 00216000
*                                                                  0040 00217000
         ST    @08,DHSMIADD                                        0040 00218000
*   /*****************************************************************/ 00219000
*   /*                                                               */ 00220000
*   /* FIX INTERVAL DATA STORAGE AREA                                */ 00221000
*   /*                                                               */ 00222000
*   /*****************************************************************/ 00223000
*                                                                  0041 00224000
*   DHPAGECB=DHECBRST;              /* RESET ECB                     */ 00225000
*                                                                  0041 00226000
         SR    @15,@15                                             0041 00227000
         ST    @15,DHPAGECB                                        0041 00228000
*   /*****************************************************************/ 00229000
*   /*                                                               */ 00230000
*   /* MACDATE Y-2 73018                                             */ 00231000
*   /*                                                               */ 00232000
*   /*****************************************************************/ 00233000
*                                                                  0042 00234000
*   RESPECIFY                                                      0042 00235000
*    (GPR00P,                                                      0042 00236000
*     GPR01P,                                                      0042 00237000
*     GPR14P,                                                      0042 00238000
*     GPR15P)RESTRICTED;                                           0042 00239000
*   GPR01P=DHSMIADD-LENGTH(STSMIGMC);/* BEGINNING ADDRESS            */ 00240000
         SR    @08,@09                                             0043 00241000
         LR    GPR01P,@08                                          0043 00242000
*   GPR15P=GPR01P+STSMILEN;         /* ENDING ADDRESS +1             */ 00243000
         LR    GPR15P,GPR01P                                       0044 00244000
         SR    @09,@09                                             0044 00245000
         ICM   @09,7,STSMILEN(@10)                                 0044 00246000
         AR    GPR15P,@09                                          0044 00247000
*   GENERATE SETS(DHPAGECB);                                       0045 00248000
*                                                                  0045 00249000
         LA    GPR00P,DHPAGECB      ECB ADDRESS                         00250000
DHPAGFX3 PGFIX R,A=(GPR01P),EA=(GPR15P),ECB=(GPR00P),LONG=N,           X00251000
               RELATED=(MFDHISFX,IRBMFDHP(DHPAGFX6),IRBMFTRM(TR0210))   00252000
         WAIT  ECB=DHPAGECB                                             00253000
*   /*****************************************************************/ 00254000
*   /*                                                               */ 00255000
*   /* MACDATE Y-2 73018                                             */ 00256000
*   /*                                                               */ 00257000
*   /*****************************************************************/ 00258000
*                                                                  0046 00259000
*   RESPECIFY                                                      0046 00260000
*    (GPR00P,                                                      0046 00261000
*     GPR01P,                                                      0046 00262000
*     GPR14P,                                                      0046 00263000
*     GPR15P)UNRESTRICTED;                                         0046 00264000
*                                                                  0046 00265000
*   /*****************************************************************/ 00266000
*   /*                                                               */ 00267000
*   /* SET SUBPOOL AND LENGTH INTO FIRST WORD OF GOTTEN AREA         */ 00268000
*   /*                                                               */ 00269000
*   /*****************************************************************/ 00270000
*                                                                  0047 00271000
*   EVAL(DHSMIADD-LENGTH(STSMIGMC))->DHDTAGMC=STSMIGMC;            0047 00272000
*                                                                  0047 00273000
         L     @10,DHSMIADD                                        0047 00274000
         SH    @10,@CH00112                                        0047 00275000
         L     @15,@PC00001                                        0047 00276000
         L     @01,DHSMAPTR(,@15)                                  0047 00277000
         MVC   DHDTAGMC(4,@10),STSMIGMC(@01)                       0047 00278000
*   /*****************************************************************/ 00279000
*   /*                                                               */ 00280000
*   /* RETURN TO CALLER BY SPECIAL RETURN SEQUENCE WHICH DOES NOT    */ 00281000
*   /* FREE AUTOMATIC DATA OR INVALIDATE ADDRESSING. THE PURPOSE IS  */ 00282000
*   /* TO ALLOW ALL PROLOGS, MOVES, AND EPILOGS TO EXECUTE TOGETHER. */ 00283000
*   /* THE EFFECT IN ANY INTERVAL-DRIVEN MG ROUTINE IS AS IF THE     */ 00284000
*   /* PROLOG, MOVE, AND EPILOG WERE EXECUTED AS SEQUENTIAL CODE     */ 00285000
*   /* DHMOVE: IRBBREAK MACDATE Y-2 73018                            */ 00286000
*   /*                                                               */ 00287000
*   /*****************************************************************/ 00288000
*                                                                  0048 00289000
*DHMOVE:                                                           0048 00290000
*                                                                  0048 00291000
*   /*****************************************************************/ 00292000
*   /*                                                               */ 00293000
*   /* INDICATE NEXT ROUTINE ADDRESS TO SVC MAINLINE FOR REENTRY     */ 00294000
*   /*                                                               */ 00295000
*   /*****************************************************************/ 00296000
*                                                                  0048 00297000
*   STSMENTR=ADDR(DHRT0020);                                       0048 00298000
DHMOVE   L     @10,@PC00001                                        0048 00299000
         L     @10,DHSMAPTR(,@10)                                  0048 00300000
         LA    @15,DHRT0020                                        0048 00301000
         ST    @15,STSMENTR(,@10)                                  0048 00302000
*   RESPECIFY                                                      0049 00303000
*    (GPR00P,                                                      0049 00304000
*     GPR01P,                                                      0049 00305000
*     GPR14P,                                                      0049 00306000
*     GPR15P)RESTRICTED;                                           0049 00307000
*   GENERATE;                                                      0050 00308000
         STM   @02,@12,28(@13)     SAVE REGISTERS FOR NEXT SEGMENT      00309000
         L     @13,4(,@13)         BACK CHAIN TO CALLERS SAVEAREA       00310000
         LM    @14,@12,12(@13)     RESTORE CALLERS REGISTERS            00311000
         BR    @14                 RETURN TO CALLER                     00312000
*                                                                  0051 00313000
*   /*****************************************************************/ 00314000
*   /*                                                               */ 00315000
*   /* REENTRY POINT FROM CALLER, IGX00014.                          */ 00316000
*   /*                                                               */ 00317000
*   /*****************************************************************/ 00318000
*                                                                  0051 00319000
*DHRT0020:                                                         0051 00320000
*   GENERATE;                                                      0051 00321000
DHRT0020 DS    0H                                                  0051 00322000
         STM   @14,@12,12(@13)     SAVE CALLERS REGISTERS               00323000
         L     @01,0(,@01)         GET ADDRESS OF SAVE AREA ADDRESS     00324000
         L     @01,0(,@01)         GET SAVE AREA ADDRESS                00325000
         LM    @02,@12,28(@01)     RELOAD REGISTERS                     00326000
         ST    @13,4(,@01)         BACK CHAIN NEW SAVEAREA TO OLD       00327000
         ST    @01,8(,@13)         FORWARD CHAIN FROM OLD TO NEW        00328000
         LR    @13,@01             R13 NOW POINTS TO NEW SAVEAREA       00329000
*   RESPECIFY                                                      0052 00330000
*    (GPR00P,                                                      0052 00331000
*     GPR01P,                                                      0052 00332000
*     GPR14P,                                                      0052 00333000
*     GPR15P)UNRESTRICTED;                                         0052 00334000
*                                                                  0052 00335000
*   /*****************************************************************/ 00336000
*   /*                                                               */ 00337000
*   /* BEGIN MOVE SEGMENT. THIS CODE IS ENTERED DISABLED AND EXECUTES*/ 00338000
*   /* WITH NO PAGE FAULTS. THE FUNCTION IS TO MOVE DATA INTO STORAGE*/ 00339000
*   /* OBTAINED BY THE PROLOG PROVIDE ADDRESSABILITY TO SMF RECORD IN*/ 00340000
*   /* NEW INTERVAL STORAGE                                          */ 00341000
*   /*                                                               */ 00342000
*   /*****************************************************************/ 00343000
*                                                                  0053 00344000
*   RESPECIFY                                                      0053 00345000
*     SMFRCD73 BASED(DHSMIADD);                                    0053 00346000
*                                                                  0053 00347000
*   /*****************************************************************/ 00348000
*   /*                                                               */ 00349000
*   /* MOVE IN STANDARD SMF HEADER                                   */ 00350000
*   /*                                                               */ 00351000
*   /*****************************************************************/ 00352000
*                                                                  0054 00353000
*   SMFRCD73=DHSMFHDR(1:LENGTH(SMFRCD73));                         0054 00354000
*                                                                  0054 00355000
         L     @10,DHSMIADD                                        0054 00356000
         L     @15,@PC00001+16                                     0054 00357000
         MVC   SMFRCD73(48,@10),DHSMFHDR(@15)                      0054 00358000
*   /*****************************************************************/ 00359000
*   /*                                                               */ 00360000
*   /* FILL IN UNSET FIELDS                                          */ 00361000
*   /*                                                               */ 00362000
*   /*****************************************************************/ 00363000
*                                                                  0055 00364000
*   SMF73RTY=DHRCDTYP;              /* INSERT RECORD TYPE            */ 00365000
         MVI   SMF73RTY(@10),X'49'                                 0055 00366000
*   SMF73SAM=ECCESAMP;              /* NUMBER OF SAMPLES             */ 00367000
         L     @15,@PC00001                                        0056 00368000
         L     @01,DHSMAPTR(,@15)                                  0056 00369000
         L     @01,STSMEDAD(,@01)                                  0056 00370000
         MVC   SMF73SAM(4,@10),ECCESAMP(@01)                       0056 00371000
*   SMF73A=SMF73A&&SMF73A;          /* ZERO MF/1 CHANNEL CONTROL AREA*/ 00372000
         LA    @15,SMF73SIZ(,@10)                                  0057 00373000
         AH    @15,SMF73SIZ(,@10)                                  0057 00374000
         XC    SMF73A(8,@15),SMF73A(@15)                           0057 00375000
*   SMF73SHC=LENGTH(SMF73A);        /* SIZE OF CHANNEL CONTROL AREA  */ 00376000
         MVC   SMF73SHC(2,@15),@CH00056                            0058 00377000
*   SMF73SHD=LENGTH(SMF73B);        /* SIZE OF CHANNEL DATA AREA     */ 00378000
*                                                                  0059 00379000
         MVC   SMF73SHD(2,@15),@CH00123                            0059 00380000
*   /*****************************************************************/ 00381000
*   /*                                                               */ 00382000
*   /* LOOP THROUGH CPU ENTRIES AND CHANNEL DATA BLOCKS MOVING IN    */ 00383000
*   /* DATA. ALSO COUNT NUMBER OF CHANNELS PROCESSED                 */ 00384000
*   /*                                                               */ 00385000
*   /*****************************************************************/ 00386000
*                                                                  0060 00387000
*   DHCHACNT=1;                     /* INITIALIZE CHANNEL COUNT      */ 00388000
         LA    @10,1                                               0060 00389000
         ST    @10,DHCHACNT                                        0060 00390000
*   DO DHCPERIX=1 TO ECCECPUS;      /* LOOP THROUGH CPE TABLE        */ 00391000
*                                                                  0061 00392000
         B     @DE00061                                            0061 00393000
@DL00061 DS    0H                                                  0062 00394000
*     /***************************************************************/ 00395000
*     /*                                                             */ 00396000
*     /* LOOP THROUGH CHANNELS FOR THIS CPU                          */ 00397000
*     /*                                                             */ 00398000
*     /***************************************************************/ 00399000
*                                                                  0062 00400000
*     DO DHCDBRIX=1 TO ECCPCNUM(DHCPERIX);                         0062 00401000
*                                                                  0062 00402000
         LA    @10,1                                               0062 00403000
         B     @DE00062                                            0062 00404000
@DL00062 DS    0H                                                  0063 00405000
*       /*************************************************************/ 00406000
*       /*                                                           */ 00407000
*       /* ZERO CHANNEL ENTRY                                        */ 00408000
*       /*                                                           */ 00409000
*       /*************************************************************/ 00410000
*                                                                  0063 00411000
*       SMF73B(DHCHACNT)=SMF73B(DHCHACNT)&&SMF73B(DHCHACNT);       0063 00412000
*                                                                  0063 00413000
         L     @15,DHCHACNT                                        0063 00414000
         SLA   @15,4                                               0063 00415000
         L     @14,DHSMIADD                                        0063 00416000
         LA    @09,SMF73SIZ(,@14)                                  0063 00417000
         AH    @09,SMF73SIZ(,@14)                                  0063 00418000
         LH    @14,SMF73SHC(,@09)                                  0063 00419000
         AR    @14,@09                                             0063 00420000
         ST    @15,@TF00001                                        0063 00421000
         ALR   @15,@14                                             0063 00422000
         AL    @15,@CF00268                                        0063 00423000
         XC    SMF73B(16,@15),SMF73B(@15)                          0063 00424000
*       /*************************************************************/ 00425000
*       /*                                                           */ 00426000
*       /* ASSUME INVALID ENTRY AND MARK AS SUCH                     */ 00427000
*       /*                                                           */ 00428000
*       /*************************************************************/ 00429000
*                                                                  0064 00430000
*       SMF73HID(DHCHACNT)=DHNOTVLD;                               0064 00431000
         LA    @15,255                                             0064 00432000
         L     @01,@TF00001                                        0064 00433000
         AL    @01,@CF00269                                        0064 00434000
         STC   @15,SMF73HID-2(@01,@14)                             0064 00435000
*       IF ECCDVALD(DHCDBRIX)='0'B THEN                            0065 00436000
*                                                                  0065 00437000
         LR    @15,@10                                             0065 00438000
         MH    @15,@CH00263                                        0065 00439000
         L     @09,DHCPERIX                                        0065 00440000
         LR    @08,@09                                             0065 00441000
         SLA   @08,3                                               0065 00442000
         L     @07,@PC00001                                        0065 00443000
         L     @01,DHSMAPTR(,@07)                                  0065 00444000
         L     @01,STSMEDAD(,@01)                                  0065 00445000
         L     @01,ECCECPEQ(,@01)                                  0065 00446000
         AL    @01,@CF00267                                        0065 00447000
         L     @08,ECCPCDBQ-4(@08,@01)                             0065 00448000
         ST    @15,@TF00002                                        0065 00449000
         ALR   @15,@08                                             0065 00450000
         AL    @15,@CF00270                                        0065 00451000
         TM    ECCDVALD(@15),B'00000100'                           0065 00452000
         BZ    @RT00065                                            0065 00453000
*         /***********************************************************/ 00454000
*         /*                                                         */ 00455000
*         /* CHANNEL HAS NEVER BEEN ONLINE. SKIP THIS CHANNEL.       */ 00456000
*         /*                                                         */ 00457000
*         /***********************************************************/ 00458000
*                                                                  0066 00459000
*         GO TO DHLAB2;                                            0066 00460000
*                                                                  0066 00461000
*       /*************************************************************/ 00462000
*       /*                                                           */ 00463000
*       /* SET IN CPU IDENTIFIER (PHYSICAL ADDRESS)                  */ 00464000
*       /*                                                           */ 00465000
*       /*************************************************************/ 00466000
*                                                                  0067 00467000
*       SMF73CID(DHCHACNT)=DHCPERIX-1;                             0067 00468000
*                                                                  0067 00469000
         BCTR  @09,0                                               0067 00470000
         L     @15,@TF00001                                        0067 00471000
         AL    @15,@CF00268                                        0067 00472000
         STH   @09,SMF73CID(@15,@14)                               0067 00473000
*       /*************************************************************/ 00474000
*       /*                                                           */ 00475000
*       /* SET IN CHANNEL IDENTIFIER (PHYSICAL ADDRESS)              */ 00476000
*       /*                                                           */ 00477000
*       /*************************************************************/ 00478000
*                                                                  0068 00479000
*       SMF73HID(DHCHACNT)=DHCDBRIX-1;                             0068 00480000
*                                                                  0068 00481000
         BCTR  @10,0                                               0068 00482000
         L     @15,@TF00001                                        0068 00483000
         AL    @15,@CF00269                                        0068 00484000
         STC   @10,SMF73HID-2(@15,@14)                             0068 00485000
*       /*************************************************************/ 00486000
*       /*                                                           */ 00487000
*       /* SET CHANNEL TYPE FLAGS                                    */ 00488000
*       /*                                                           */ 00489000
*       /*************************************************************/ 00490000
*                                                                  0069 00491000
*       IF ECCDCTYP(DHCDBRIX)=SELECTOR THEN                        0069 00492000
         AL    @08,@TF00002                                        0069 00493000
         AL    @08,@CF00268                                        0069 00494000
         TM    ECCDCTYP-4(@08),B'11110000'                         0069 00495000
         BNZ   @RF00069                                            0069 00496000
*         SMF73TYP(DHCHACNT)=SELECTOR;                             0070 00497000
         AL    @14,@TF00001                                        0070 00498000
         AL    @14,@CF00271                                        0070 00499000
         NI    SMF73TYP-3(@14),B'00001111'                         0070 00500000
*       ELSE                                                       0071 00501000
*         DO;                                                      0071 00502000
         B     @RC00069                                            0071 00503000
@RF00069 DS    0H                                                  0072 00504000
*           IF ECCDCTYP(DHCDBRIX)=MULTPLEX THEN/* IS CHANNEL TYPE  0072 00505000
*                                      BYTE MULTIPLEX                */ 00506000
         L     @10,DHCDBRIX                                        0072 00507000
         MH    @10,@CH00263                                        0072 00508000
         L     @15,DHCPERIX                                        0072 00509000
         SLA   @15,3                                               0072 00510000
         L     @14,@PC00001                                        0072 00511000
         L     @01,DHSMAPTR(,@14)                                  0072 00512000
         L     @01,STSMEDAD(,@01)                                  0072 00513000
         L     @01,ECCECPEQ(,@01)                                  0072 00514000
         AL    @01,@CF00267                                        0072 00515000
         L     @01,ECCPCDBQ-4(@15,@01)                             0072 00516000
         ALR   @01,@10                                             0072 00517000
         AL    @01,@CF00268                                        0072 00518000
         TM    ECCDCTYP-4(@01),B'00010000'                         0072 00519000
         BNO   @RF00072                                            0072 00520000
         TM    ECCDCTYP-4(@01),B'11100000'                         0072 00521000
         BNZ   @RF00072                                            0072 00522000
*             SMF73TYP(DHCHACNT)=MULTPLEX;                         0073 00523000
         L     @10,DHCHACNT                                        0073 00524000
         SLA   @10,4                                               0073 00525000
         L     @15,DHSMIADD                                        0073 00526000
         LA    @14,SMF73SIZ(,@15)                                  0073 00527000
         AH    @14,SMF73SIZ(,@15)                                  0073 00528000
         LH    @15,SMF73SHC(,@14)                                  0073 00529000
         AR    @15,@14                                             0073 00530000
         ALR   @15,@10                                             0073 00531000
         AL    @15,@CF00271                                        0073 00532000
         NI    SMF73TYP-3(@15),B'00011111'                         0073 00533000
         OI    SMF73TYP-3(@15),B'00010000'                         0073 00534000
*           ELSE                    /* ELSE IT IS BLOCK MULTIPLEX    */ 00535000
*             SMF73TYP(DHCHACNT)=BLKMPLEX;                         0074 00536000
         B     @RC00072                                            0074 00537000
@RF00072 L     @10,DHCHACNT                                        0074 00538000
         SLA   @10,4                                               0074 00539000
         L     @15,DHSMIADD                                        0074 00540000
         LA    @14,SMF73SIZ(,@15)                                  0074 00541000
         AH    @14,SMF73SIZ(,@15)                                  0074 00542000
         LH    @15,SMF73SHC(,@14)                                  0074 00543000
         AR    @15,@14                                             0074 00544000
         ALR   @15,@10                                             0074 00545000
         AL    @15,@CF00271                                        0074 00546000
         NI    SMF73TYP-3(@15),B'00101111'                         0074 00547000
         OI    SMF73TYP-3(@15),B'00100000'                         0074 00548000
*         END;                                                     0075 00549000
*                                                                  0075 00550000
@RC00072 DS    0H                                                  0076 00551000
*       /*************************************************************/ 00552000
*       /*                                                           */ 00553000
*       /* SET CHANNEL TYPE INVALID FLAG IF NECESSARY                */ 00554000
*       /*                                                           */ 00555000
*       /*************************************************************/ 00556000
*                                                                  0076 00557000
*       IF ECCDIVID(DHCDBRIX)='1'B THEN                            0076 00558000
@RC00069 L     @10,DHCDBRIX                                        0076 00559000
         MH    @10,@CH00263                                        0076 00560000
         L     @15,DHCPERIX                                        0076 00561000
         SLA   @15,3                                               0076 00562000
         L     @14,@PC00001                                        0076 00563000
         L     @01,DHSMAPTR(,@14)                                  0076 00564000
         L     @01,STSMEDAD(,@01)                                  0076 00565000
         L     @01,ECCECPEQ(,@01)                                  0076 00566000
         AL    @01,@CF00267                                        0076 00567000
         L     @01,ECCPCDBQ-4(@15,@01)                             0076 00568000
         ALR   @01,@10                                             0076 00569000
         AL    @01,@CF00270                                        0076 00570000
         TM    ECCDIVID(@01),B'00001000'                           0076 00571000
         BNO   @RF00076                                            0076 00572000
*         DO;                                                      0077 00573000
*           SMF73IID(DHCHACNT)='1'B;                               0078 00574000
         L     @10,DHCHACNT                                        0078 00575000
         SLA   @10,4                                               0078 00576000
         L     @15,DHSMIADD                                        0078 00577000
         LA    @14,SMF73SIZ(,@15)                                  0078 00578000
         AH    @14,SMF73SIZ(,@15)                                  0078 00579000
         LH    @15,SMF73SHC(,@14)                                  0078 00580000
         AR    @15,@14                                             0078 00581000
         ST    @10,@TF00001                                        0078 00582000
         ALR   @10,@15                                             0078 00583000
         AL    @10,@CF00271                                        0078 00584000
         OI    SMF73IID-3(@10),B'00000100'                         0078 00585000
*           SMF73TYP(DHCHACNT)=DHIVCTYP;                           0079 00586000
         AL    @15,@TF00001                                        0079 00587000
         AL    @15,@CF00271                                        0079 00588000
         NI    SMF73TYP-3(@15),B'00001111'                         0079 00589000
*         END;                                                     0080 00590000
*                                                                  0080 00591000
*       /*************************************************************/ 00592000
*       /*                                                           */ 00593000
*       /* INSERT DATA IF CHANNEL IS ONLINE. USE COMPARE AND SWAP    */ 00594000
*       /* LOGIC. MACDATE Y-2 73018                                  */ 00595000
*       /*                                                           */ 00596000
*       /*************************************************************/ 00597000
*                                                                  0081 00598000
*       RESPECIFY                                                  0081 00599000
*        (GPR00P,                                                  0081 00600000
*         GPR06P)RESTRICTED;                                       0081 00601000
@RF00076 DS    0H                                                  0082 00602000
*DHLAB1:                            /* START TO COUNT SIOS AND BUSY     00603000
*                                      SAMPLES                       */ 00604000
*       GPR06P=ADDR(ECCDFLGS(DHCDBRIX));                           0082 00605000
*                                                                  0082 00606000
DHLAB1   L     @10,DHCDBRIX                                        0082 00607000
         MH    @10,@CH00263                                        0082 00608000
         L     @01,DHCPERIX                                        0082 00609000
         SLA   @01,3                                               0082 00610000
         L     @15,@PC00001                                        0082 00611000
         L     @15,DHSMAPTR(,@15)                                  0082 00612000
         L     @15,STSMEDAD(,@15)                                  0082 00613000
         L     @15,ECCECPEQ(,@15)                                  0082 00614000
         AL    @15,@CF00267                                        0082 00615000
         L     GPR06P,ECCPCDBQ-4(@01,@15)                          0082 00616000
         AL    GPR06P,@CF00270                                     0082 00617000
         LA    GPR06P,ECCDFLGS(@10,GPR06P)                         0082 00618000
*       /*************************************************************/ 00619000
*       /*                                                           */ 00620000
*       /* WORD CONTAINING FLAGS TO REGISTER                         */ 00621000
*       /*                                                           */ 00622000
*       /*************************************************************/ 00623000
*                                                                  0083 00624000
*       GENERATE(L    GPR00P,0(,GPR06P));                          0083 00625000
         L    GPR00P,0(,GPR06P)                                         00626000
*       IF ECCDALIV(DHCDBRIX)='1'B THEN                            0084 00627000
         L     @10,DHCDBRIX                                        0084 00628000
         MH    @10,@CH00263                                        0084 00629000
         L     @07,DHCPERIX                                        0084 00630000
         SLA   @07,3                                               0084 00631000
         L     @01,@PC00001                                        0084 00632000
         L     @01,DHSMAPTR(,@01)                                  0084 00633000
         L     @01,STSMEDAD(,@01)                                  0084 00634000
         L     @01,ECCECPEQ(,@01)                                  0084 00635000
         AL    @01,@CF00267                                        0084 00636000
         L     @07,ECCPCDBQ-4(@07,@01)                             0084 00637000
         ST    @10,@TF00001                                        0084 00638000
         ALR   @10,@07                                             0084 00639000
         AL    @10,@CF00270                                        0084 00640000
         TM    ECCDALIV(@10),B'00000001'                           0084 00641000
         BNO   @RF00084                                            0084 00642000
*         DO;                                                      0085 00643000
*                                                                  0085 00644000
*           /*********************************************************/ 00645000
*           /*                                                       */ 00646000
*           /* SUCCESSFUL SIOS                                       */ 00647000
*           /*                                                       */ 00648000
*           /*********************************************************/ 00649000
*                                                                  0086 00650000
*           SMF73CNT(DHCHACNT)=ECCDSIOS(DHCDBRIX);                 0086 00651000
*                                                                  0086 00652000
         L     @10,DHCHACNT                                        0086 00653000
         SLA   @10,4                                               0086 00654000
         L     @01,DHSMIADD                                        0086 00655000
         LA    @15,SMF73SIZ(,@01)                                  0086 00656000
         AH    @15,SMF73SIZ(,@01)                                  0086 00657000
         LH    @01,SMF73SHC(,@15)                                  0086 00658000
         AR    @01,@15                                             0086 00659000
         L     @15,@TF00001                                        0086 00660000
         AL    @15,@CF00278                                        0086 00661000
         L     @15,ECCDSIOS-8(@15,@07)                             0086 00662000
         LA    @14,0(@10,@01)                                      0086 00663000
         AL    @14,@CF00278                                        0086 00664000
         ST    @15,SMF73CNT-4(,@14)                                0086 00665000
*           /*********************************************************/ 00666000
*           /*                                                       */ 00667000
*           /* BUSY SAMPLES                                          */ 00668000
*           /*                                                       */ 00669000
*           /*********************************************************/ 00670000
*                                                                  0087 00671000
*           SMF73BSY(DHCHACNT)=ECCDBUSY(DHCDBRIX);                 0087 00672000
*                                                                  0087 00673000
         L     @15,@TF00001                                        0087 00674000
         AL    @15,@CF00266                                        0087 00675000
         L     @15,ECCDBUSY-12(@15,@07)                            0087 00676000
         LA    @14,0(@10,@01)                                      0087 00677000
         AL    @14,@CF00266                                        0087 00678000
         ST    @15,SMF73BSY-8(,@14)                                0087 00679000
*           /*********************************************************/ 00680000
*           /*                                                       */ 00681000
*           /* BUSY/CPU WAIT SAMPLES                                 */ 00682000
*           /*                                                       */ 00683000
*           /*********************************************************/ 00684000
*                                                                  0088 00685000
*           SMF73OLP(DHCHACNT)=ECCDOLAP(DHCDBRIX);                 0088 00686000
         L     @15,@TF00001                                        0088 00687000
         AL    @07,@CF00267                                        0088 00688000
         L     @07,ECCDOLAP-16(@15,@07)                            0088 00689000
         AL    @01,@CF00267                                        0088 00690000
         ST    @07,SMF73OLP-12(@10,@01)                            0088 00691000
*         END;                                                     0089 00692000
*       ELSE                                                       0090 00693000
*         DO;                                                      0090 00694000
*                                                                  0090 00695000
         B     @RC00084                                            0090 00696000
@RF00084 DS    0H                                                  0091 00697000
*           /*********************************************************/ 00698000
*           /*                                                       */ 00699000
*           /* ZERO SIOS, BUSY SAMPLES, AND OVERLAP SAMPLES          */ 00700000
*           /*                                                       */ 00701000
*           /*********************************************************/ 00702000
*                                                                  0091 00703000
*           SMF73CNT(DHCHACNT)=DHDTZERO;                           0091 00704000
         SR    @10,@10                                             0091 00705000
         L     @07,DHCHACNT                                        0091 00706000
         SLA   @07,4                                               0091 00707000
         L     @01,DHSMIADD                                        0091 00708000
         LA    @15,SMF73SIZ(,@01)                                  0091 00709000
         AH    @15,SMF73SIZ(,@01)                                  0091 00710000
         LH    @01,SMF73SHC(,@15)                                  0091 00711000
         AR    @01,@15                                             0091 00712000
         LA    @15,0(@07,@01)                                      0091 00713000
         AL    @15,@CF00278                                        0091 00714000
         ST    @10,SMF73CNT-4(,@15)                                0091 00715000
*           SMF73BSY(DHCHACNT)=DHDTZERO;                           0092 00716000
         LA    @15,0(@07,@01)                                      0092 00717000
         AL    @15,@CF00266                                        0092 00718000
         ST    @10,SMF73BSY-8(,@15)                                0092 00719000
*           SMF73OLP(DHCHACNT)=DHDTZERO;                           0093 00720000
         AL    @01,@CF00267                                        0093 00721000
         ST    @10,SMF73OLP-12(@07,@01)                            0093 00722000
*         END;                                                     0094 00723000
*                                                                  0094 00724000
*       /*************************************************************/ 00725000
*       /*                                                           */ 00726000
*       /* SET CONFIGURATION CHANGED FLAG IF NECESSARY               */ 00727000
*       /*                                                           */ 00728000
*       /*************************************************************/ 00729000
*                                                                  0095 00730000
*       IF ECCDCCHG(DHCDBRIX)='1'B THEN                            0095 00731000
@RC00084 L     @10,DHCDBRIX                                        0095 00732000
         MH    @10,@CH00263                                        0095 00733000
         L     @07,DHCPERIX                                        0095 00734000
         SLA   @07,3                                               0095 00735000
         L     @01,@PC00001                                        0095 00736000
         L     @01,DHSMAPTR(,@01)                                  0095 00737000
         L     @01,STSMEDAD(,@01)                                  0095 00738000
         L     @01,ECCECPEQ(,@01)                                  0095 00739000
         AL    @01,@CF00267                                        0095 00740000
         L     @07,ECCPCDBQ-4(@07,@01)                             0095 00741000
         ALR   @07,@10                                             0095 00742000
         AL    @07,@CF00270                                        0095 00743000
         TM    ECCDCCHG(@07),B'00000010'                           0095 00744000
         BNO   @RF00095                                            0095 00745000
*         SMF73VAC(DHCHACNT)='1'B;                                 0096 00746000
         L     @10,DHCHACNT                                        0096 00747000
         SLA   @10,4                                               0096 00748000
         L     @07,DHSMIADD                                        0096 00749000
         LA    @01,SMF73SIZ(,@07)                                  0096 00750000
         AH    @01,SMF73SIZ(,@07)                                  0096 00751000
         LH    @07,SMF73SHC(,@01)                                  0096 00752000
         AR    @07,@01                                             0096 00753000
         ALR   @07,@10                                             0096 00754000
         AL    @07,@CF00271                                        0096 00755000
         OI    SMF73VAC-3(@07),B'00000010'                         0096 00756000
*       ELSE                                                       0097 00757000
*         SMF73VAC(DHCHACNT)='0'B;                                 0097 00758000
*                                                                  0097 00759000
         B     @RC00095                                            0097 00760000
@RF00095 L     @10,DHCHACNT                                        0097 00761000
         SLA   @10,4                                               0097 00762000
         L     @07,DHSMIADD                                        0097 00763000
         LA    @01,SMF73SIZ(,@07)                                  0097 00764000
         AH    @01,SMF73SIZ(,@07)                                  0097 00765000
         LH    @07,SMF73SHC(,@01)                                  0097 00766000
         AR    @07,@01                                             0097 00767000
         ALR   @07,@10                                             0097 00768000
         AL    @07,@CF00271                                        0097 00769000
         NI    SMF73VAC-3(@07),B'11111101'                         0097 00770000
*       /*************************************************************/ 00771000
*       /*                                                           */ 00772000
*       /* SET CURRENT CHANNEL ONLINE/OFFLINE STATUS                 */ 00773000
*       /*                                                           */ 00774000
*       /*************************************************************/ 00775000
*                                                                  0098 00776000
*       IF ECCDALIV(DHCDBRIX)='1'B THEN                            0098 00777000
@RC00095 L     @10,DHCDBRIX                                        0098 00778000
         MH    @10,@CH00263                                        0098 00779000
         L     @07,DHCPERIX                                        0098 00780000
         SLA   @07,3                                               0098 00781000
         L     @01,@PC00001                                        0098 00782000
         L     @01,DHSMAPTR(,@01)                                  0098 00783000
         L     @01,STSMEDAD(,@01)                                  0098 00784000
         L     @01,ECCECPEQ(,@01)                                  0098 00785000
         AL    @01,@CF00267                                        0098 00786000
         L     @07,ECCPCDBQ-4(@07,@01)                             0098 00787000
         ALR   @07,@10                                             0098 00788000
         AL    @07,@CF00270                                        0098 00789000
         TM    ECCDALIV(@07),B'00000001'                           0098 00790000
         BNO   @RF00098                                            0098 00791000
*         SMF73STA(DHCHACNT)='1'B;                                 0099 00792000
         L     @10,DHCHACNT                                        0099 00793000
         SLA   @10,4                                               0099 00794000
         L     @07,DHSMIADD                                        0099 00795000
         LA    @01,SMF73SIZ(,@07)                                  0099 00796000
         AH    @01,SMF73SIZ(,@07)                                  0099 00797000
         LH    @07,SMF73SHC(,@01)                                  0099 00798000
         AR    @07,@01                                             0099 00799000
         ALR   @07,@10                                             0099 00800000
         AL    @07,@CF00271                                        0099 00801000
         OI    SMF73STA-3(@07),B'00000001'                         0099 00802000
*       ELSE                                                       0100 00803000
*         SMF73STA(DHCHACNT)='0'B;                                 0100 00804000
*                                                                  0100 00805000
         B     @RC00098                                            0100 00806000
@RF00098 L     @10,DHCHACNT                                        0100 00807000
         SLA   @10,4                                               0100 00808000
         L     @07,DHSMIADD                                        0100 00809000
         LA    @01,SMF73SIZ(,@07)                                  0100 00810000
         AH    @01,SMF73SIZ(,@07)                                  0100 00811000
         LH    @07,SMF73SHC(,@01)                                  0100 00812000
         AR    @07,@01                                             0100 00813000
         ALR   @07,@10                                             0100 00814000
         AL    @07,@CF00271                                        0100 00815000
         NI    SMF73STA-3(@07),B'11111110'                         0100 00816000
*       /*************************************************************/ 00817000
*       /*                                                           */ 00818000
*       /* MACDATE Y-2 73018                                         */ 00819000
*       /*                                                           */ 00820000
*       /*************************************************************/ 00821000
*                                                                  0101 00822000
*       RESPECIFY                                                  0101 00823000
*        (GPR01P)RESTRICTED;                                       0101 00824000
@RC00098 DS    0H                                                  0102 00825000
*       GPR01P=GPR00P&ECCDCCOF;     /* TURN OFF CONFIGURATION CHANGED   00826000
*                                      FLAG.                         */ 00827000
         LR    GPR01P,GPR00P                                       0102 00828000
         N     GPR01P,@CF00134                                     0102 00829000
*       GENERATE(CS GPR00P,GPR01P,0(GPR06P));                      0103 00830000
         CS GPR00P,GPR01P,0(GPR06P)                                     00831000
*       BC(7,DHLAB1);               /* BRANCH IF UNSUCCESSFUL        */ 00832000
*                                                                  0104 00833000
         BC    7,DHLAB1                                            0104 00834000
*       /*************************************************************/ 00835000
*       /*                                                           */ 00836000
*       /* MACDATE Y-2 73018                                         */ 00837000
*       /*                                                           */ 00838000
*       /*************************************************************/ 00839000
*                                                                  0105 00840000
*       RESPECIFY                                                  0105 00841000
*        (GPR00P,                                                  0105 00842000
*         GPR01P,                                                  0105 00843000
*         GPR06P)UNRESTRICTED;                                     0105 00844000
*DHLAB2:                                                           0106 00845000
*                                                                  0106 00846000
*       /*************************************************************/ 00847000
*       /*                                                           */ 00848000
*       /* INCREMENT NUMBER OF CHANNELS PROCESSED                    */ 00849000
*       /*                                                           */ 00850000
*       /*************************************************************/ 00851000
*                                                                  0106 00852000
*       DHCHACNT=DHCHACNT+1;                                       0106 00853000
DHLAB2   LA    @10,1                                               0106 00854000
         A     @10,DHCHACNT                                        0106 00855000
         ST    @10,DHCHACNT                                        0106 00856000
*     END;                                                         0107 00857000
         LA    @10,1                                               0107 00858000
         A     @10,DHCDBRIX                                        0107 00859000
@DE00062 ST    @10,DHCDBRIX                                        0107 00860000
         L     @15,DHCPERIX                                        0107 00861000
         SLA   @15,3                                               0107 00862000
         L     @14,@PC00001                                        0107 00863000
         L     @01,DHSMAPTR(,@14)                                  0107 00864000
         L     @01,STSMEDAD(,@01)                                  0107 00865000
         L     @01,ECCECPEQ(,@01)                                  0107 00866000
         AL    @01,@CF00283                                        0107 00867000
         CH    @10,ECCPCNUM-2(@15,@01)                             0107 00868000
         BNH   @DL00062                                            0107 00869000
*   END;                                                           0108 00870000
         LA    @10,1                                               0108 00871000
         A     @10,DHCPERIX                                        0108 00872000
@DE00061 ST    @10,DHCPERIX                                        0108 00873000
         L     @15,@PC00001                                        0108 00874000
         L     @01,DHSMAPTR(,@15)                                  0108 00875000
         L     @01,STSMEDAD(,@01)                                  0108 00876000
         SR    @00,@00                                             0108 00877000
         IC    @00,ECCECPUS(,@01)                                  0108 00878000
         CR    @10,@00                                             0108 00879000
         BNH   @DL00061                                            0108 00880000
*   SMF73CHA=DHCHACNT-1;            /* TOTAL NUMBER OF CHANNELS      */ 00881000
*                                                                  0109 00882000
         L     @10,DHSMIADD                                        0109 00883000
         LA    @15,SMF73SIZ(,@10)                                  0109 00884000
         AH    @15,SMF73SIZ(,@10)                                  0109 00885000
         L     @10,DHCHACNT                                        0109 00886000
         BCTR  @10,0                                               0109 00887000
         STH   @10,SMF73CHA(,@15)                                  0109 00888000
*   /*****************************************************************/ 00889000
*   /*                                                               */ 00890000
*   /* RETURN AND REENTER THROUGH SPECIAL INTERFACE DHEPILOG:        */ 00891000
*   /* IRBBREAK MACDATE Y-2 73018                                    */ 00892000
*   /*                                                               */ 00893000
*   /*****************************************************************/ 00894000
*                                                                  0110 00895000
*DHEPILOG:                                                         0110 00896000
*                                                                  0110 00897000
*   /*****************************************************************/ 00898000
*   /*                                                               */ 00899000
*   /* INDICATE NEXT ROUTINE ADDRESS TO SVC MAINLINE FOR REENTRY     */ 00900000
*   /*                                                               */ 00901000
*   /*****************************************************************/ 00902000
*                                                                  0110 00903000
*   STSMENTR=ADDR(DHRT0024);                                       0110 00904000
DHEPILOG L     @10,@PC00001                                        0110 00905000
         L     @10,DHSMAPTR(,@10)                                  0110 00906000
         LA    @15,DHRT0024                                        0110 00907000
         ST    @15,STSMENTR(,@10)                                  0110 00908000
*   RESPECIFY                                                      0111 00909000
*    (GPR00P,                                                      0111 00910000
*     GPR01P,                                                      0111 00911000
*     GPR14P,                                                      0111 00912000
*     GPR15P)RESTRICTED;                                           0111 00913000
*   GENERATE;                                                      0112 00914000
         STM   @02,@12,28(@13)     SAVE REGISTERS FOR NEXT SEGMENT      00915000
         L     @13,4(,@13)         BACK CHAIN TO CALLERS SAVEAREA       00916000
         LM    @14,@12,12(@13)     RESTORE CALLERS REGISTERS            00917000
         BR    @14                 RETURN TO CALLER                     00918000
*                                                                  0113 00919000
*   /*****************************************************************/ 00920000
*   /*                                                               */ 00921000
*   /* REENTRY POINT FROM CALLER, IGX00014.                          */ 00922000
*   /*                                                               */ 00923000
*   /*****************************************************************/ 00924000
*                                                                  0113 00925000
*DHRT0024:                                                         0113 00926000
*   GENERATE;                                                      0113 00927000
DHRT0024 DS    0H                                                  0113 00928000
         STM   @14,@12,12(@13)     SAVE CALLERS REGISTERS               00929000
         L     @01,0(,@01)         GET ADDRESS OF SAVE AREA ADDRESS     00930000
         L     @01,0(,@01)         GET SAVE AREA ADDRESS                00931000
         LM    @02,@12,28(@01)     RELOAD REGISTERS                     00932000
         ST    @13,4(,@01)         BACK CHAIN NEW SAVEAREA TO OLD       00933000
         ST    @01,8(,@13)         FORWARD CHAIN FROM OLD TO NEW        00934000
         LR    @13,@01             R13 NOW POINTS TO NEW SAVEAREA       00935000
*   RESPECIFY                                                      0114 00936000
*    (GPR00P,                                                      0114 00937000
*     GPR01P,                                                      0114 00938000
*     GPR14P,                                                      0114 00939000
*     GPR15P)UNRESTRICTED;                                         0114 00940000
*                                                                  0114 00941000
*   /*****************************************************************/ 00942000
*   /*                                                               */ 00943000
*   /* BEGIN EPILOG PROCESSING. THIS CODE IS ENTERED ENABLED. ITS    */ 00944000
*   /* FUNCTION IS TO FREE FIXED PAGES, TO COMPLETE THE SMF RECORD   */ 00945000
*   /* AND TO TRACE IF DESIRED. FIRST UNFIX PROGRAM AND STATIC LOCAL */ 00946000
*   /* DATA STORAGE. MACDATE Y-2 73018                               */ 00947000
*   /*                                                               */ 00948000
*   /*****************************************************************/ 00949000
*                                                                  0115 00950000
*   RESPECIFY                                                      0115 00951000
*    (GPR00P,                                                      0115 00952000
*     GPR01P,                                                      0115 00953000
*     GPR14P,                                                      0115 00954000
*     GPR15P)RESTRICTED;                                           0115 00955000
*   GENERATE;                                                      0116 00956000
*                                                                  0116 00957000
DHPAGFX4 PGFREE  R,A=IRBMFDHP,EA=@ENDDATA,RELATED=(MFDHPGFX,           X00958000
               IRBMFDHP(DHPAGFX1))                                      00959000
*   /*****************************************************************/ 00960000
*   /*                                                               */ 00961000
*   /* MACDATE Y-2 73018                                             */ 00962000
*   /*                                                               */ 00963000
*   /*****************************************************************/ 00964000
*                                                                  0117 00965000
*   RESPECIFY                                                      0117 00966000
*    (GPR00P,                                                      0117 00967000
*     GPR01P,                                                      0117 00968000
*     GPR14P,                                                      0117 00969000
*     GPR15P)UNRESTRICTED;                                         0117 00970000
*                                                                  0117 00971000
*   /*****************************************************************/ 00972000
*   /*                                                               */ 00973000
*   /* PAGE FREE AUTOMATIC STORAGE MACDATE Y-2 73018                 */ 00974000
*   /*                                                               */ 00975000
*   /*****************************************************************/ 00976000
*                                                                  0118 00977000
*   RESPECIFY                                                      0118 00978000
*    (GPR00P,                                                      0118 00979000
*     GPR01P,                                                      0118 00980000
*     GPR14P,                                                      0118 00981000
*     GPR15P)RESTRICTED;                                           0118 00982000
*   GENERATE;                                                      0119 00983000
*                                                                  0119 00984000
         LA    GPR15P,@ENDDATD      END ADDRESS                         00985000
         LA    GPR01P,@DATD         BEGINNING ADDRESS                   00986000
DHPAGFX5 PGFREE R,A=(GPR01P),EA=(GPR15P),RELATED=(MFDHATFX,            X00987000
               IRBMFDHP(DHPAGFX2))                                      00988000
*   /*****************************************************************/ 00989000
*   /*                                                               */ 00990000
*   /* MACDATE Y-2 73018                                             */ 00991000
*   /*                                                               */ 00992000
*   /*****************************************************************/ 00993000
*                                                                  0120 00994000
*   RESPECIFY                                                      0120 00995000
*    (GPR00P,                                                      0120 00996000
*     GPR01P,                                                      0120 00997000
*     GPR14P,                                                      0120 00998000
*     GPR15P)UNRESTRICTED;                                         0120 00999000
*   STRVNSGT=STRVNSGT-1;            /* REMOVE ENTRY FOR AUTOMATIC  0121 01000000
*                                      STORAGE.                      */ 01001000
*                                                                  0121 01002000
         L     @10,@PC00001                                        0121 01003000
         L     @10,DHSMAPTR(,@10)                                  0121 01004000
         L     @15,STSMRVT(,@10)                                   0121 01005000
         L     @14,STRVNSGT(,@15)                                  0121 01006000
         BCTR  @14,0                                               0121 01007000
         ST    @14,STRVNSGT(,@15)                                  0121 01008000
*   /*****************************************************************/ 01009000
*   /*                                                               */ 01010000
*   /* UNFIX INTERVAL STORAGE DATA MACDATE Y-2 73018                 */ 01011000
*   /*                                                               */ 01012000
*   /*****************************************************************/ 01013000
*                                                                  0122 01014000
*   RESPECIFY                                                      0122 01015000
*    (GPR00P,                                                      0122 01016000
*     GPR01P,                                                      0122 01017000
*     GPR14P,                                                      0122 01018000
*     GPR15P)RESTRICTED;                                           0122 01019000
*   GPR01P=DHSMIADD-LENGTH(STSMIGMC);/* BEGINNING ADDRESS            */ 01020000
         L     GPR01P,DHSMIADD                                     0123 01021000
         SH    GPR01P,@CH00112                                     0123 01022000
*   GPR15P=GPR01P+STSMILEN;         /* ENDING ADDRESS+1              */ 01023000
         LR    GPR15P,GPR01P                                       0124 01024000
         SR    @09,@09                                             0124 01025000
         ICM   @09,7,STSMILEN(@10)                                 0124 01026000
         AR    GPR15P,@09                                          0124 01027000
*   GENERATE;                                                      0125 01028000
*                                                                  0125 01029000
DHPAGFX6 PGFREE  R,A=(GPR01P),EA=(GPR15P),RELATED=(MFDHISFX,           X01030000
               IRBMFDHP(DHPAGFX3))                                      01031000
*   /*****************************************************************/ 01032000
*   /*                                                               */ 01033000
*   /* MACDATE Y-2 73018                                             */ 01034000
*   /*                                                               */ 01035000
*   /*****************************************************************/ 01036000
*                                                                  0126 01037000
*   RESPECIFY                                                      0126 01038000
*    (GPR00P,                                                      0126 01039000
*     GPR01P,                                                      0126 01040000
*     GPR14P,                                                      0126 01041000
*     GPR15P)UNRESTRICTED;                                         0126 01042000
*   IF DHFSTCLL='1'B THEN           /* RETURN IF FIRST CALL, RETURN  */ 01043000
         L     @10,@PC00001+8                                      0127 01044000
         TM    DHFSTCLL(@10),B'10000000'                           0127 01045000
         BO    @RT00127                                            0127 01046000
*     RETURN;                       /* RETURN TO MFDATA SVC        0128 01047000
*                                      PROCESSOR-IGX00014            */ 01048000
*                                                                  0128 01049000
*   /*****************************************************************/ 01050000
*   /*                                                               */ 01051000
*   /* NOW HAVE TWO PARTIALLY COMPLETED SMF RECORDS WITH ENCODED     */ 01052000
*   /* INFORMATION. ONE CONTAINS DATA FROM THE LAST INTERVAL (POINTED*/ 01053000
*   /* TO BY DHDTAPTR). THE OTHER CONTAINS DATA COLLECTED AT THIS    */ 01054000
*   /* INTERVAL (POINTED TO BY DHSMIADD). COMPLETE THE SMF RECORD    */ 01055000
*   /* POINTED TO BY DHDTAPTR. PROVIDE DEFAULT ADDRESSABILITY TO THE */ 01056000
*   /* OUTPUT RECORD. THE OTHER RECORD WILL BE EXPLICITLY            */ 01057000
*   /* POINTER-QUALIFIED. SET EXPLICIT POINTER QUALIFIER FOR THIS    */ 01058000
*   /* INTERVAL SMFB ARRAY                                           */ 01059000
*   /*                                                               */ 01060000
*   /*****************************************************************/ 01061000
*                                                                  0129 01062000
*   RESPECIFY                                                      0129 01063000
*     SMFRCD73 BASED(DHSMIADD);                                    0129 01064000
*   DHSMFB=ADDR(SMF73B);                                           0130 01065000
*                                                                  0130 01066000
         L     @10,DHSMIADD                                        0130 01067000
         LA    @15,SMF73SIZ(,@10)                                  0130 01068000
         AH    @15,SMF73SIZ(,@10)                                  0130 01069000
         LH    @10,SMF73SHC(,@15)                                  0130 01070000
         AR    @10,@15                                             0130 01071000
         ST    @10,DHSMFB                                          0130 01072000
*   /*****************************************************************/ 01073000
*   /*                                                               */ 01074000
*   /* PROVIDE DEFAULT ADDRESSABILITY TO OUTPUT SUPERVISOR SMF RECORD*/ 01075000
*   /*                                                               */ 01076000
*   /*****************************************************************/ 01077000
*                                                                  0131 01078000
*   RESPECIFY                                                      0131 01079000
*     SMFRCD73 BASED(DHDTAPTR);                                    0131 01080000
*                                                                  0131 01081000
*   /*****************************************************************/ 01082000
*   /*                                                               */ 01083000
*   /* INSERT LAST INTERVAL START TIME, DATE, AND INTERVAL DURATION  */ 01084000
*   /* INTO THE SMF RECORD                                           */ 01085000
*   /*                                                               */ 01086000
*   /*****************************************************************/ 01087000
*                                                                  0132 01088000
*   SMF73IST=DHINTSRT;              /* LAST INTERVAL START TIME      */ 01089000
         L     @10,DHDTAPTR                                        0132 01090000
         L     @15,@PC00001+24                                     0132 01091000
         MVC   SMF73IST(4,@10),DHINTSRT(@15)                       0132 01092000
*   SMF73DAT=DHINTDAT;              /* LAST INTERVAL DATE IN FORM  0133 01093000
*                                      00YYDDDF                      */ 01094000
         L     @15,@PC00001+28                                     0133 01095000
         MVC   SMF73DAT(4,@10),DHINTDAT(@15)                       0133 01096000
*   SMF73INT=DHINTLEN;              /* INTERVAL DURATION             */ 01097000
         L     @15,@PC00001+32                                     0134 01098000
         MVC   SMF73INT(4,@10),DHINTLEN(@15)                       0134 01099000
*   DHCHACNT=1;                     /* NEXT AVAILABLE CHANNEL SLOT   */ 01100000
         LA    @10,1                                               0135 01101000
         ST    @10,DHCHACNT                                        0135 01102000
*   DO DHCHAIDX=1 TO SMF73CHA;                                     0136 01103000
*                                                                  0136 01104000
         B     @DE00136                                            0136 01105000
@DL00136 DS    0H                                                  0137 01106000
*     /***************************************************************/ 01107000
*     /*                                                             */ 01108000
*     /* IF THIS CHANNEL IS VALID                                    */ 01109000
*     /*                                                             */ 01110000
*     /***************************************************************/ 01111000
*                                                                  0137 01112000
*     IF DHSMFB->SMF73HID(DHCHAIDX)^=DHNOTVLD THEN                 0137 01113000
         LA    @15,255                                             0137 01114000
         L     @14,DHSMFB                                          0137 01115000
         SLA   @10,4                                               0137 01116000
         LA    @01,0(@10,@14)                                      0137 01117000
         AL    @01,@CF00269                                        0137 01118000
         SR    @00,@00                                             0137 01119000
         IC    @00,SMF73HID-2(,@01)                                0137 01120000
         CR    @15,@00                                             0137 01121000
         BE    @RF00137                                            0137 01122000
*       DO;                                                        0138 01123000
*                                                                  0138 01124000
*         /***********************************************************/ 01125000
*         /*                                                         */ 01126000
*         /* IF THIS CHANNEL WAS INVALID LAST INTERVAL               */ 01127000
*         /*                                                         */ 01128000
*         /***********************************************************/ 01129000
*                                                                  0139 01130000
*         IF SMF73HID(DHCHAIDX)=DHNOTVLD THEN                      0139 01131000
         L     @09,DHDTAPTR                                        0139 01132000
         LA    @08,SMF73SIZ(,@09)                                  0139 01133000
         AH    @08,SMF73SIZ(,@09)                                  0139 01134000
         LH    @09,SMF73SHC(,@08)                                  0139 01135000
         AR    @09,@08                                             0139 01136000
         LA    @01,0(@10,@09)                                      0139 01137000
         AL    @01,@CF00269                                        0139 01138000
         SR    @00,@00                                             0139 01139000
         IC    @00,SMF73HID-2(,@01)                                0139 01140000
         CR    @15,@00                                             0139 01141000
         BNE   @RF00139                                            0139 01142000
*           DO;                                                    0140 01143000
*                                                                  0140 01144000
*             /*******************************************************/ 01145000
*             /*                                                     */ 01146000
*             /* MOVE ENTRY TO OUTPUT RECORD                         */ 01147000
*             /*                                                     */ 01148000
*             /*******************************************************/ 01149000
*                                                                  0141 01150000
*             SMF73B(DHCHAIDX)=DHSMFB->SMF73B(DHCHAIDX);           0141 01151000
*                                                                  0141 01152000
         ST    @10,@TF00001                                        0141 01153000
         ALR   @10,@09                                             0141 01154000
         AL    @10,@CF00268                                        0141 01155000
         AL    @14,@TF00001                                        0141 01156000
         AL    @14,@CF00268                                        0141 01157000
         MVC   SMF73B(16,@10),SMF73B(@14)                          0141 01158000
*             /*******************************************************/ 01159000
*             /*                                                     */ 01160000
*             /* SET VARY ACTIVITY FLAG AND ZERO SIOS, BUSY SAMPLES  */ 01161000
*             /* AND OVERLAP SAMPLES.                                */ 01162000
*             /*                                                     */ 01163000
*             /*******************************************************/ 01164000
*                                                                  0142 01165000
*             SMF73VAC(DHCHAIDX)='1'B;                             0142 01166000
         LR    @10,@09                                             0142 01167000
         AL    @10,@TF00001                                        0142 01168000
         AL    @10,@CF00271                                        0142 01169000
         OI    SMF73VAC-3(@10),B'00000010'                         0142 01170000
*             SMF73CNT(DHCHAIDX)=DHDTZERO;                         0143 01171000
         SR    @10,@10                                             0143 01172000
         L     @08,@TF00001                                        0143 01173000
         AL    @08,@CF00278                                        0143 01174000
         ST    @10,SMF73CNT-4(@08,@09)                             0143 01175000
*             SMF73BSY(DHCHAIDX)=DHDTZERO;                         0144 01176000
         L     @08,@TF00001                                        0144 01177000
         AL    @08,@CF00266                                        0144 01178000
         ST    @10,SMF73BSY-8(@08,@09)                             0144 01179000
*             SMF73OLP(DHCHAIDX)=DHDTZERO;                         0145 01180000
         L     @08,@TF00001                                        0145 01181000
         AL    @09,@CF00267                                        0145 01182000
         ST    @10,SMF73OLP-12(@08,@09)                            0145 01183000
*           END;                                                   0146 01184000
*         ELSE                      /* THIS CPU WAS VALID LAST     0147 01185000
*                                      INTERVAL                      */ 01186000
*           DO;                                                    0147 01187000
*                                                                  0147 01188000
         B     @RC00139                                            0147 01189000
@RF00139 DS    0H                                                  0148 01190000
*             /*******************************************************/ 01191000
*             /*                                                     */ 01192000
*             /* MOVE OVER STATUS AND VARY FLAGS                     */ 01193000
*             /*                                                     */ 01194000
*             /*******************************************************/ 01195000
*                                                                  0148 01196000
*             IF DHSMFB->SMF73VAC(DHCHAIDX)='1'B THEN              0148 01197000
         L     @10,DHCHAIDX                                        0148 01198000
         SLA   @10,4                                               0148 01199000
         L     @01,DHSMFB                                          0148 01200000
         ALR   @01,@10                                             0148 01201000
         AL    @01,@CF00271                                        0148 01202000
         TM    SMF73VAC-3(@01),B'00000010'                         0148 01203000
         BNO   @RF00148                                            0148 01204000
*               SMF73VAC(DHCHAIDX)='1'B;                           0149 01205000
         L     @15,DHDTAPTR                                        0149 01206000
         LA    @14,SMF73SIZ(,@15)                                  0149 01207000
         AH    @14,SMF73SIZ(,@15)                                  0149 01208000
         LH    @15,SMF73SHC(,@14)                                  0149 01209000
         AR    @15,@14                                             0149 01210000
         ALR   @15,@10                                             0149 01211000
         AL    @15,@CF00271                                        0149 01212000
         OI    SMF73VAC-3(@15),B'00000010'                         0149 01213000
*             ELSE                                                 0150 01214000
*               SMF73VAC(DHCHAIDX)='0'B;                           0150 01215000
         B     @RC00148                                            0150 01216000
@RF00148 L     @10,DHCHAIDX                                        0150 01217000
         SLA   @10,4                                               0150 01218000
         L     @15,DHDTAPTR                                        0150 01219000
         LA    @14,SMF73SIZ(,@15)                                  0150 01220000
         AH    @14,SMF73SIZ(,@15)                                  0150 01221000
         LH    @15,SMF73SHC(,@14)                                  0150 01222000
         AR    @15,@14                                             0150 01223000
         ALR   @15,@10                                             0150 01224000
         AL    @15,@CF00271                                        0150 01225000
         NI    SMF73VAC-3(@15),B'11111101'                         0150 01226000
*             IF DHSMFB->SMF73STA(DHCHAIDX)='1'B THEN/* TEST FOR   0151 01227000
*                                      STATUS FLAG                   */ 01228000
@RC00148 L     @10,DHCHAIDX                                        0151 01229000
         SLA   @10,4                                               0151 01230000
         L     @01,DHSMFB                                          0151 01231000
         ALR   @01,@10                                             0151 01232000
         AL    @01,@CF00271                                        0151 01233000
         TM    SMF73STA-3(@01),B'00000001'                         0151 01234000
         BNO   @RF00151                                            0151 01235000
*               SMF73STA(DHCHAIDX)='1'B;                           0152 01236000
         L     @15,DHDTAPTR                                        0152 01237000
         LA    @14,SMF73SIZ(,@15)                                  0152 01238000
         AH    @14,SMF73SIZ(,@15)                                  0152 01239000
         LH    @15,SMF73SHC(,@14)                                  0152 01240000
         AR    @15,@14                                             0152 01241000
         ALR   @15,@10                                             0152 01242000
         AL    @15,@CF00271                                        0152 01243000
         OI    SMF73STA-3(@15),B'00000001'                         0152 01244000
*             ELSE                  /* STATUS FLAG IS OFF            */ 01245000
*               SMF73STA(DHCHAIDX)='0'B;                           0153 01246000
*                                                                  0153 01247000
         B     @RC00151                                            0153 01248000
@RF00151 L     @10,DHCHAIDX                                        0153 01249000
         SLA   @10,4                                               0153 01250000
         L     @15,DHDTAPTR                                        0153 01251000
         LA    @14,SMF73SIZ(,@15)                                  0153 01252000
         AH    @14,SMF73SIZ(,@15)                                  0153 01253000
         LH    @15,SMF73SHC(,@14)                                  0153 01254000
         AR    @15,@14                                             0153 01255000
         ALR   @15,@10                                             0153 01256000
         AL    @15,@CF00271                                        0153 01257000
         NI    SMF73STA-3(@15),B'11111110'                         0153 01258000
*             /*******************************************************/ 01259000
*             /*                                                     */ 01260000
*             /* IF VARY ACTIVITY WAS DETECTED, OR IF CHANNEL IS     */ 01261000
*             /* OFFLINE                                             */ 01262000
*             /*                                                     */ 01263000
*             /*******************************************************/ 01264000
*                                                                  0154 01265000
*             IF SMF73VAC(DHCHAIDX)='1'B|SMF73STA(DHCHAIDX)='0'B THEN   01266000
@RC00151 L     @10,DHCHAIDX                                        0154 01267000
         SLA   @10,4                                               0154 01268000
         L     @15,DHDTAPTR                                        0154 01269000
         LA    @14,SMF73SIZ(,@15)                                  0154 01270000
         AH    @14,SMF73SIZ(,@15)                                  0154 01271000
         LH    @15,SMF73SHC(,@14)                                  0154 01272000
         AR    @15,@14                                             0154 01273000
         ALR   @15,@10                                             0154 01274000
         AL    @15,@CF00271                                        0154 01275000
         TM    SMF73VAC-3(@15),B'00000010'                         0154 01276000
         BNZ   @RT00154                                            0154 01277000
         TM    SMF73STA-3(@15),B'00000001'                         0154 01278000
         BO    @RF00154                                            0154 01279000
@RT00154 DS    0H                                                  0155 01280000
*               DO;                 /* ZERO DATA                     */ 01281000
*                 SMF73CNT(DHCHAIDX)=DHDTZERO;                     0156 01282000
         SR    @10,@10                                             0156 01283000
         L     @15,DHCHAIDX                                        0156 01284000
         SLA   @15,4                                               0156 01285000
         L     @14,DHDTAPTR                                        0156 01286000
         LA    @09,SMF73SIZ(,@14)                                  0156 01287000
         AH    @09,SMF73SIZ(,@14)                                  0156 01288000
         LH    @14,SMF73SHC(,@09)                                  0156 01289000
         AR    @14,@09                                             0156 01290000
         LA    @01,0(@15,@14)                                      0156 01291000
         AL    @01,@CF00278                                        0156 01292000
         ST    @10,SMF73CNT-4(,@01)                                0156 01293000
*                 SMF73BSY(DHCHAIDX)=DHDTZERO;                     0157 01294000
         LA    @01,0(@15,@14)                                      0157 01295000
         AL    @01,@CF00266                                        0157 01296000
         ST    @10,SMF73BSY-8(,@01)                                0157 01297000
*                 SMF73OLP(DHCHAIDX)=DHDTZERO;                     0158 01298000
         AL    @14,@CF00267                                        0158 01299000
         ST    @10,SMF73OLP-12(@15,@14)                            0158 01300000
*               END;                                               0159 01301000
*             ELSE                  /* NO VARY ACTIVITY WAS DETECTED    01302000
*                                      AND THE CHANNEL IS ONLINE.  0160 01303000
*                                      MOVE DATA.                    */ 01304000
*               DO;                                                0160 01305000
         B     @RC00154                                            0160 01306000
@RF00154 DS    0H                                                  0161 01307000
*                 SMF73CNT(DHCHAIDX)=DHSMFB->SMF73CNT(DHCHAIDX)-   0161 01308000
*                     SMF73CNT(DHCHAIDX);                          0161 01309000
*                                                                  0161 01310000
         L     @10,DHCHAIDX                                        0161 01311000
         SLA   @10,4                                               0161 01312000
         L     @15,DHDTAPTR                                        0161 01313000
         LA    @14,SMF73SIZ(,@15)                                  0161 01314000
         AH    @14,SMF73SIZ(,@15)                                  0161 01315000
         LH    @15,SMF73SHC(,@14)                                  0161 01316000
         AR    @15,@14                                             0161 01317000
         L     @01,DHSMFB                                          0161 01318000
         AL    @01,@CF00278                                        0161 01319000
         L     @14,SMF73CNT-4(@10,@01)                             0161 01320000
         LA    @01,0(@10,@15)                                      0161 01321000
         AL    @01,@CF00278                                        0161 01322000
         SL    @14,SMF73CNT-4(,@01)                                0161 01323000
         LA    @01,0(@10,@15)                                      0161 01324000
         AL    @01,@CF00278                                        0161 01325000
         ST    @14,SMF73CNT-4(,@01)                                0161 01326000
*                 /***************************************************/ 01327000
*                 /*                                                 */ 01328000
*                 /* IF CHANNEL TYPE IS INVALID, OR IF CHANNEL IS A  */ 01329000
*                 /* BYTE MULTIPLEXOR, DONT COLLECT DATA             */ 01330000
*                 /*                                                 */ 01331000
*                 /***************************************************/ 01332000
*                                                                  0162 01333000
*                 IF SMF73IID(DHCHAIDX)='1'B THEN                  0162 01334000
         ST    @10,@TF00001                                        0162 01335000
         ALR   @10,@15                                             0162 01336000
         AL    @10,@CF00271                                        0162 01337000
         TM    SMF73IID-3(@10),B'00000100'                         0162 01338000
         BNO   @RF00162                                            0162 01339000
*                   DO;                                            0163 01340000
*                     SMF73BSY(DHCHAIDX)=DHDTZERO;                 0164 01341000
         SR    @10,@10                                             0164 01342000
         L     @14,@TF00001                                        0164 01343000
         AL    @14,@CF00266                                        0164 01344000
         ST    @10,SMF73BSY-8(@14,@15)                             0164 01345000
*                     SMF73OLP(DHCHAIDX)=DHDTZERO;                 0165 01346000
         L     @14,@TF00001                                        0165 01347000
         AL    @15,@CF00267                                        0165 01348000
         ST    @10,SMF73OLP-12(@14,@15)                            0165 01349000
*                     GO TO DHLAB6; /* PASS OVER DATA COLLECTION   0166 01350000
*                                      ROUTINE AND INCR SLOT CTR     */ 01351000
         B     DHLAB6                                              0166 01352000
*                   END;                                           0167 01353000
*                 IF SMF73TYP(DHCHAIDX)=MULTPLEX THEN/* TEST FOR   0168 01354000
*                                      MULTIPLEXER CHANNEL           */ 01355000
@RF00162 L     @10,DHCHAIDX                                        0168 01356000
         SLA   @10,4                                               0168 01357000
         L     @15,DHDTAPTR                                        0168 01358000
         LA    @14,SMF73SIZ(,@15)                                  0168 01359000
         AH    @14,SMF73SIZ(,@15)                                  0168 01360000
         LH    @15,SMF73SHC(,@14)                                  0168 01361000
         AR    @15,@14                                             0168 01362000
         ST    @10,@TF00001                                        0168 01363000
         ALR   @10,@15                                             0168 01364000
         AL    @10,@CF00271                                        0168 01365000
         TM    SMF73TYP-3(@10),B'00010000'                         0168 01366000
         BNO   @RF00168                                            0168 01367000
         TM    SMF73TYP-3(@10),B'11100000'                         0168 01368000
         BNZ   @RF00168                                            0168 01369000
*                   DO;                                            0169 01370000
*                     SMF73BSY(DHCHAIDX)=DHDTZERO;                 0170 01371000
         SR    @10,@10                                             0170 01372000
         L     @14,@TF00001                                        0170 01373000
         AL    @14,@CF00266                                        0170 01374000
         ST    @10,SMF73BSY-8(@14,@15)                             0170 01375000
*                     SMF73OLP(DHCHAIDX)=DHDTZERO;                 0171 01376000
         L     @14,@TF00001                                        0171 01377000
         AL    @15,@CF00267                                        0171 01378000
         ST    @10,SMF73OLP-12(@14,@15)                            0171 01379000
*                     GO TO DHLAB6; /* PASS OVER DATA COLLECTION   0172 01380000
*                                      ROUTINE AND INCR SLOT CTR     */ 01381000
         B     DHLAB6                                              0172 01382000
*                   END;                                           0173 01383000
*                                                                  0173 01384000
*                 /***************************************************/ 01385000
*                 /*                                                 */ 01386000
*                 /* COLLECT DATA                                    */ 01387000
*                 /*                                                 */ 01388000
*                 /***************************************************/ 01389000
*                                                                  0174 01390000
*                 SMF73BSY(DHCHAIDX)=DHSMFB->SMF73BSY(DHCHAIDX)-   0174 01391000
*                     SMF73BSY(DHCHAIDX);                          0174 01392000
@RF00168 L     @10,DHCHAIDX                                        0174 01393000
         SLA   @10,4                                               0174 01394000
         L     @15,DHDTAPTR                                        0174 01395000
         LA    @14,SMF73SIZ(,@15)                                  0174 01396000
         AH    @14,SMF73SIZ(,@15)                                  0174 01397000
         LH    @15,SMF73SHC(,@14)                                  0174 01398000
         AR    @15,@14                                             0174 01399000
         L     @14,DHSMFB                                          0174 01400000
         LA    @01,0(@10,@14)                                      0174 01401000
         AL    @01,@CF00266                                        0174 01402000
         L     @09,SMF73BSY-8(,@01)                                0174 01403000
         LA    @08,0(@10,@15)                                      0174 01404000
         AL    @08,@CF00266                                        0174 01405000
         SL    @09,SMF73BSY-8(,@08)                                0174 01406000
         LA    @08,0(@10,@15)                                      0174 01407000
         AL    @08,@CF00266                                        0174 01408000
         ST    @09,SMF73BSY-8(,@08)                                0174 01409000
*                 SMF73OLP(DHCHAIDX)=DHSMFB->SMF73OLP(DHCHAIDX)-   0175 01410000
*                     SMF73OLP(DHCHAIDX);                          0175 01411000
         AL    @14,@CF00267                                        0175 01412000
         L     @14,SMF73OLP-12(@10,@14)                            0175 01413000
         LA    @01,0(@10,@15)                                      0175 01414000
         AL    @01,@CF00267                                        0175 01415000
         SL    @14,SMF73OLP-12(,@01)                               0175 01416000
         AL    @15,@CF00267                                        0175 01417000
         ST    @14,SMF73OLP-12(@10,@15)                            0175 01418000
*DHLAB6:                            /* END OF DATA COLLECTION        */ 01419000
*               END;                                               0176 01420000
DHLAB6   DS    0H                                                  0177 01421000
*           END;                                                   0177 01422000
*                                                                  0177 01423000
@RC00154 DS    0H                                                  0178 01424000
*         /***********************************************************/ 01425000
*         /*                                                         */ 01426000
*         /* MOVE ENTRY INTO PROPER SLOT (IF NEEDED) AND INCREMENT   */ 01427000
*         /* SLOT COUNTER                                            */ 01428000
*         /*                                                         */ 01429000
*         /***********************************************************/ 01430000
*                                                                  0178 01431000
*         IF DHCHACNT^=DHCHAIDX THEN                               0178 01432000
@RC00139 L     @10,DHCHACNT                                        0178 01433000
         L     @15,DHCHAIDX                                        0178 01434000
         CR    @10,@15                                             0178 01435000
         BE    @RF00178                                            0178 01436000
*           DO;                                                    0179 01437000
*             DHSMFPR1=ADDR(SMF73B(DHCHACNT));                     0180 01438000
         SLA   @10,4                                               0180 01439000
         L     @14,DHDTAPTR                                        0180 01440000
         LA    @09,SMF73SIZ(,@14)                                  0180 01441000
         AH    @09,SMF73SIZ(,@14)                                  0180 01442000
         LH    @08,SMF73SHC(,@09)                                  0180 01443000
         AR    @08,@09                                             0180 01444000
         AL    @10,@CF00268                                        0180 01445000
         LA    @10,SMF73B(@10,@08)                                 0180 01446000
         ST    @10,DHSMFPR1                                        0180 01447000
*             DHSMFPR2=ADDR(SMF73B(DHCHAIDX));                     0181 01448000
         SLA   @15,4                                               0181 01449000
         AL    @08,@CF00268                                        0181 01450000
         LA    @15,SMF73B(@15,@08)                                 0181 01451000
         ST    @15,DHSMFPR2                                        0181 01452000
*             DHSMFPR1->DHSMF73B=DHSMFPR2->DHSMF73B;               0182 01453000
         MVC   DHSMF73B(16,@10),DHSMF73B(@15)                      0182 01454000
*           END;                                                   0183 01455000
*         DHCHACNT=DHCHACNT+1;                                     0184 01456000
@RF00178 LA    @10,1                                               0184 01457000
         A     @10,DHCHACNT                                        0184 01458000
         ST    @10,DHCHACNT                                        0184 01459000
*       END;                                                       0185 01460000
*   END;                                                           0186 01461000
*                                                                  0186 01462000
@RF00137 LA    @10,1                                               0186 01463000
         A     @10,DHCHAIDX                                        0186 01464000
@DE00136 ST    @10,DHCHAIDX                                        0186 01465000
         L     @01,DHDTAPTR                                        0186 01466000
         LA    @15,SMF73SIZ(,@01)                                  0186 01467000
         L     @14,DHDTAPTR                                        0186 01468000
         AH    @15,SMF73SIZ(,@14)                                  0186 01469000
         CH    @10,SMF73CHA(,@15)                                  0186 01470000
         BNH   @DL00136                                            0186 01471000
*   /*****************************************************************/ 01472000
*   /*                                                               */ 01473000
*   /* SET NUMBER OF CHANNEL ENTRIES                                 */ 01474000
*   /*                                                               */ 01475000
*   /*****************************************************************/ 01476000
*                                                                  0187 01477000
*   SMF73CHA=DHCHACNT-1;                                           0187 01478000
*                                                                  0187 01479000
         L     @10,DHDTAPTR                                        0187 01480000
         LA    @15,SMF73SIZ(,@10)                                  0187 01481000
         AH    @15,SMF73SIZ(,@10)                                  0187 01482000
         L     @14,DHCHACNT                                        0187 01483000
         BCTR  @14,0                                               0187 01484000
         STH   @14,SMF73CHA(,@15)                                  0187 01485000
*   /*****************************************************************/ 01486000
*   /*                                                               */ 01487000
*   /* SET NUMBER OF SAMPLES                                         */ 01488000
*   /*                                                               */ 01489000
*   /*****************************************************************/ 01490000
*                                                                  0188 01491000
*   SMF73SAM=DHSMIADD->SMF73SAM-SMF73SAM;                          0188 01492000
*                                                                  0188 01493000
         L     @01,DHSMIADD                                        0188 01494000
         L     @15,SMF73SAM(,@01)                                  0188 01495000
         SL    @15,SMF73SAM(,@10)                                  0188 01496000
         ST    @15,SMF73SAM(,@10)                                  0188 01497000
*   /*****************************************************************/ 01498000
*   /*                                                               */ 01499000
*   /* SET ACTUAL RECORD LENGTH                                      */ 01500000
*   /*                                                               */ 01501000
*   /*****************************************************************/ 01502000
*                                                                  0189 01503000
*   SMF73LEN=LENGTH(SMFRCD73)+LENGTH(SMF73A)+SMF73CHA*LENGTH(SMF73B);   01504000
*                                                                  0189 01505000
         SLA   @14,4                                               0189 01506000
         AH    @14,@CH00264                                        0189 01507000
         STH   @14,SMF73LEN(,@10)                                  0189 01508000
*   /*****************************************************************/ 01509000
*   /*                                                               */ 01510000
*   /* TRACE TO SMF DATA SET IF DIRECTED TO DO SO                    */ 01511000
*   /*                                                               */ 01512000
*   /*****************************************************************/ 01513000
*                                                                  0190 01514000
*   IF DHTRACE='1'B THEN                                           0190 01515000
         L     @15,@PC00001+12                                     0190 01516000
         TM    DHTRACE(@15),B'10000000'                            0190 01517000
         BNO   @RF00190                                            0190 01518000
*     DO;                                                          0191 01519000
*                                                                  0191 01520000
*       /*************************************************************/ 01521000
*       /*                                                           */ 01522000
*       /* MACDATE Y-2 73018                                         */ 01523000
*       /*                                                           */ 01524000
*       /*************************************************************/ 01525000
*                                                                  0192 01526000
*       RESPECIFY                                                  0192 01527000
*        (GPR00P,                                                  0192 01528000
*         GPR01P,                                                  0192 01529000
*         GPR14P,                                                  0192 01530000
*         GPR15P)RESTRICTED;                                       0192 01531000
*       GPR01P=DHDTAPTR;            /* SMF RECORD ADDRESS TO REGISTER*/ 01532000
         LR    GPR01P,@10                                          0193 01533000
*       GENERATE(SMFWTM (GPR01P));                                 0194 01534000
*                                                                  0194 01535000
         SMFWTM (GPR01P)                                                01536000
*       /*************************************************************/ 01537000
*       /*                                                           */ 01538000
*       /* MACDATE Y-2 73018                                         */ 01539000
*       /*                                                           */ 01540000
*       /*************************************************************/ 01541000
*                                                                  0195 01542000
*       RESPECIFY                                                  0195 01543000
*        (GPR00P,                                                  0195 01544000
*         GPR01P,                                                  0195 01545000
*         GPR14P,                                                  0195 01546000
*         GPR15P)UNRESTRICTED;                                     0195 01547000
*     END;                                                         0196 01548000
*                                                                  0196 01549000
*   /*****************************************************************/ 01550000
*   /*                                                               */ 01551000
*   /* GET USER STORAGE FOR THE RETURN SMF RECORD DATA, MOVE THE DATA*/ 01552000
*   /* IN AND FREE THE SUPERVISOR COPY. THE RETURN PARAMETER WILL    */ 01553000
*   /* POINT TO THE USER STORAGE SMF DATA AREA. THE SUBPOOL AND      */ 01554000
*   /* LENGTH WILL PREFIX THE DATA AREA. THIS STORAGE WILL BE FREED  */ 01555000
*   /* BY THE USER                                                   */ 01556000
*   /*                                                               */ 01557000
*   /*****************************************************************/ 01558000
*                                                                  0197 01559000
*   DHSMFSBP=STSMSSP;               /* SMF RECORD USER STORAGE SBPOOL*/ 01560000
@RF00190 L     @10,@PC00001                                        0197 01561000
         L     @10,DHSMAPTR(,@10)                                  0197 01562000
         MVC   DHSMFSBP(1),STSMSSP(@10)                            0197 01563000
*   DHSMFLEN=SMF73LEN+LENGTH(DHSMFGMC);/* ACTUAL LENGTH OF RECORD  0198 01564000
*                                      PLUS ROOM FOR SUBPOOL AND   0198 01565000
*                                      LENGTH                        */ 01566000
*                                                                  0198 01567000
         LA    @10,4                                               0198 01568000
         L     @01,DHDTAPTR                                        0198 01569000
         AH    @10,SMF73LEN(,@01)                                  0198 01570000
         STCM  @10,7,DHSMFLEN                                      0198 01571000
*   /*****************************************************************/ 01572000
*   /*                                                               */ 01573000
*   /* MACDATE Y-2 73018                                             */ 01574000
*   /*                                                               */ 01575000
*   /*****************************************************************/ 01576000
*                                                                  0199 01577000
*   RESPECIFY                                                      0199 01578000
*    (GPR00P,                                                      0199 01579000
*     GPR01P,                                                      0199 01580000
*     GPR14P,                                                      0199 01581000
*     GPR15P)RESTRICTED;                                           0199 01582000
*   GPR00P=DHSMFGMC;                /* GETMAIN CONTROL WORD TO REG   */ 01583000
         L     GPR00P,DHSMFGMC                                     0200 01584000
*   GENERATE(GETMAIN R,LV=(0));                                    0201 01585000
         GETMAIN R,LV=(0)                                               01586000
*   DHRETDTA=GPR01P+LENGTH(DHSMFGMC);/* POINT PARM TO RETURN RECORD  */ 01587000
*                                                                  0202 01588000
         L     @10,@PC00001+4                                      0202 01589000
         LA    @09,4                                               0202 01590000
         LR    @08,GPR01P                                          0202 01591000
         AR    @08,@09                                             0202 01592000
         ST    @08,DHRETDTA(,@10)                                  0202 01593000
*   /*****************************************************************/ 01594000
*   /*                                                               */ 01595000
*   /* MACDATE Y-2 73018                                             */ 01596000
*   /*                                                               */ 01597000
*   /*****************************************************************/ 01598000
*                                                                  0203 01599000
*   RESPECIFY                                                      0203 01600000
*    (GPR00P,                                                      0203 01601000
*     GPR01P,                                                      0203 01602000
*     GPR14P,                                                      0203 01603000
*     GPR15P)UNRESTRICTED;                                         0203 01604000
*                                                                  0203 01605000
*   /*****************************************************************/ 01606000
*   /*                                                               */ 01607000
*   /* MOVE ALL PERTINENT CONTROL INFORMATION TO REGISTERS, CHANGE TO*/ 01608000
*   /* USERS KEY AND CREATE USER RECORD MACDATE Y-2 73018            */ 01609000
*   /*                                                               */ 01610000
*   /*****************************************************************/ 01611000
*                                                                  0204 01612000
*   RESPECIFY                                                      0204 01613000
*    (GPR00P,                                                      0204 01614000
*     GPR01P,                                                      0204 01615000
*     GPR05P,                                                      0204 01616000
*     GPR06P,                                                      0204 01617000
*     GPR14P,                                                      0204 01618000
*     GPR15P)RESTRICTED;                                           0204 01619000
*   GPR05P=DHSMFGMC;                /* GETMAIN CONTROL WRD TO REG    */ 01620000
         L     GPR05P,DHSMFGMC                                     0205 01621000
*   GPR06P=DHRETDTA-LENGTH(DHSMFGMC);/* PREFIX ADDRESS               */ 01622000
         LCR   @09,@09                                             0206 01623000
         AR    @09,@08                                             0206 01624000
         LR    GPR06P,@09                                          0206 01625000
*   GPR00P=DHRETDTA;                /* USER SMF RECORD ADDRESS       */ 01626000
         LR    GPR00P,@08                                          0207 01627000
*   GPR14P=DHDTAPTR;                /* SYSTEM SMF RECORD ADDRESS     */ 01628000
         L     GPR14P,DHDTAPTR                                     0208 01629000
*   GPR01P=DHSMFLEN;                /* LENGTH TO MOVE                */ 01630000
         SR    @10,@10                                             0209 01631000
         ICM   @10,7,DHSMFLEN                                      0209 01632000
         LR    GPR01P,@10                                          0209 01633000
*   GPR15P=DHSMFLEN;                /* LENGTH TO MOVE                */ 01634000
*                                                                  0210 01635000
         LR    GPR15P,@10                                          0210 01636000
*   /*****************************************************************/ 01637000
*   /*                                                               */ 01638000
*   /* CHANGE TO USERS KEY MACDATE Y-2 73018                         */ 01639000
*   /*                                                               */ 01640000
*   /*****************************************************************/ 01641000
*                                                                  0211 01642000
*   RESPECIFY                                                      0211 01643000
*    (GPR02P,                                                      0211 01644000
*     GPR03P,                                                      0211 01645000
*     GPR04P)RESTRICTED;                                           0211 01646000
*   GPR03P=DHTCBADR;                /* TCB ADDRESS TO REGISTER       */ 01647000
         L     @10,@PC00001+20                                     0212 01648000
         L     GPR03P,DHTCBADR(,@10)                               0212 01649000
*   GENERATE SETS(DHSAVKEY);                                       0213 01650000
*                                                                  0213 01651000
         USING TCB,GPR03P                                               01652000
DHMODES1 MODESET EXTKEY=TCB,SAVEKEY=DHSAVKEY,WORKREG=4,                X01653000
               RELATED=(MFDHUKEY,IRBMFDHP(DHMODES2))                    01654000
         DROP  GPR03P                                                   01655000
*   /*****************************************************************/ 01656000
*   /*                                                               */ 01657000
*   /* MACDATE Y-2 73018                                             */ 01658000
*   /*                                                               */ 01659000
*   /*****************************************************************/ 01660000
*                                                                  0214 01661000
*   RESPECIFY                                                      0214 01662000
*    (GPR02P,                                                      0214 01663000
*     GPR03P,                                                      0214 01664000
*     GPR04P)UNRESTRICTED;                                         0214 01665000
*   GENERATE;                                                      0215 01666000
*                                                                  0215 01667000
         ST    GPR05P,0(,GPR06P)    STORE SUBPOOL AND LENGTH IN PREFIX  01668000
         MVCL  GPR00P,GPR14P        MOVE RECORD                         01669000
*   /*****************************************************************/ 01670000
*   /*                                                               */ 01671000
*   /* CHANGE BACK TO SYSTEM KEY MACDATE Y-2 73018                   */ 01672000
*   /*                                                               */ 01673000
*   /*****************************************************************/ 01674000
*                                                                  0216 01675000
*   RESPECIFY                                                      0216 01676000
*    (GPR02P,                                                      0216 01677000
*     GPR04P)RESTRICTED;                                           0216 01678000
*   GENERATE REFS(DHSAVKEY);                                       0217 01679000
*                                                                  0217 01680000
DHMODES2 MODESET KEYADDR=DHSAVKEY,WORKREG=4,                           X01681000
               RELATED=(MFDHUKEY,IRBMFDHP(DHMODES1))                    01682000
*   /*****************************************************************/ 01683000
*   /*                                                               */ 01684000
*   /* MACDATE Y-2 73018                                             */ 01685000
*   /*                                                               */ 01686000
*   /*****************************************************************/ 01687000
*                                                                  0218 01688000
*   RESPECIFY                                                      0218 01689000
*    (GPR02P,                                                      0218 01690000
*     GPR04P)UNRESTRICTED;                                         0218 01691000
*                                                                  0218 01692000
*   /*****************************************************************/ 01693000
*   /*                                                               */ 01694000
*   /* MACDATE Y-2 73018                                             */ 01695000
*   /*                                                               */ 01696000
*   /*****************************************************************/ 01697000
*                                                                  0219 01698000
*   RESPECIFY                                                      0219 01699000
*    (GPR00P,                                                      0219 01700000
*     GPR01P,                                                      0219 01701000
*     GPR05P,                                                      0219 01702000
*     GPR06P,                                                      0219 01703000
*     GPR14P,                                                      0219 01704000
*     GPR15P)UNRESTRICTED;                                         0219 01705000
*                                                                  0219 01706000
*   /*****************************************************************/ 01707000
*   /*                                                               */ 01708000
*   /* NOW FREE SYSTEM SMF RECORD STORAGE MACDATE Y-2 73018          */ 01709000
*   /*                                                               */ 01710000
*   /*****************************************************************/ 01711000
*                                                                  0220 01712000
*   RESPECIFY                                                      0220 01713000
*    (GPR00P,                                                      0220 01714000
*     GPR01P,                                                      0220 01715000
*     GPR14P,                                                      0220 01716000
*     GPR15P)RESTRICTED;                                           0220 01717000
*   GPR00P=STSMIGMC;                /* GETMAIN CONTROL WORD TO REG   */ 01718000
         L     @10,@PC00001                                        0221 01719000
         L     @10,DHSMAPTR(,@10)                                  0221 01720000
         L     GPR00P,STSMIGMC(,@10)                               0221 01721000
*   GPR01P=DHDTAPTR-LENGTH(STSMIGMC);/* POINT TO BEGINNING OF STORAGE*/ 01722000
         L     GPR01P,DHDTAPTR                                     0222 01723000
         SH    GPR01P,@CH00112                                     0222 01724000
*   GENERATE;                                                      0223 01725000
*                                                                  0223 01726000
DHGETMN2 FREEMAIN R,LV=(0),A=(1),RELATED=(MFDHISGM,IRBMFDHP(DHGETMN1))  01727000
*   /*****************************************************************/ 01728000
*   /*                                                               */ 01729000
*   /* MACDATE Y-2 73018                                             */ 01730000
*   /*                                                               */ 01731000
*   /*****************************************************************/ 01732000
*                                                                  0224 01733000
*   RESPECIFY                                                      0224 01734000
*    (GPR00P,                                                      0224 01735000
*     GPR01P,                                                      0224 01736000
*     GPR14P,                                                      0224 01737000
*     GPR15P)UNRESTRICTED;                                         0224 01738000
*   RETURN;                         /* RETURN TO CALLER              */ 01739000
@EL00001 L     @13,4(,@13)                                         0225 01740000
@EF00001 L     @00,@SIZDATD                                        0225 01741000
         LR    @01,@11                                             0225 01742000
         FREEMAIN R,LV=(0),A=(1)                                        01743000
@ER00001 LM    @14,@12,12(@13)                                     0225 01744000
         BR    @14                                                 0225 01745000
*   END                                                            0226 01746000
*                                                                  0226 01747000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01748000
*/*%INCLUDE SYSLIB  (IFASMFR )                                       */ 01749000
*                                                                  0226 01750000
*       ;                                                          0226 01751000
         B     @EL00001                                            0226 01752000
@DATA    DS    0H                                                       01753000
@CH00060 DC    H'1'                                                     01754000
@CH00112 DC    H'4'                                                     01755000
@CH00056 DC    H'8'                                                     01756000
@CH00123 DC    H'16'                                                    01757000
@CH00263 DC    H'20'                                                    01758000
@CH00264 DC    H'56'                                                    01759000
@DATD    DSECT                                                          01760000
         DS    0F                                                       01761000
@SA00001 DS    18F                                                      01762000
@PC00001 DS    9F                                                       01763000
@TF00001 DS    F                                                        01764000
@TF00002 DS    F                                                        01765000
IRBMFDHP CSECT                                                          01766000
         DS    0F                                                       01767000
@CF00270 DC    F'-20'                                                   01768000
@CF00268 DC    F'-16'                                                   01769000
@CF00269 DC    F'-14'                                                   01770000
@CF00271 DC    F'-13'                                                   01771000
@CF00278 DC    F'-12'                                                   01772000
@CF00266 DC    F'-8'                                                    01773000
@CF00283 DC    F'-6'                                                    01774000
@CF00267 DC    F'-4'                                                    01775000
@CF00134 DC    XL4'FDFFFFFF'                                            01776000
@DATD    DSECT                                                          01777000
         DS    0D                                                       01778000
DHCPERIX DS    F                                                        01779000
DHDTAPTR DS    A                                                        01780000
DHSMFB   DS    A                                                        01781000
DHSMFPR1 DS    A                                                        01782000
DHSMFPR2 DS    A                                                        01783000
DHSMIADD DS    A                                                        01784000
DHCHAIDX DS    F                                                        01785000
DHPAGECB DS    F                                                        01786000
DHCHACNT DS    F                                                        01787000
DHCDBRIX DS    F                                                        01788000
DHSAVKEY DS    CL1                                                      01789000
         DS    CL3                                                      01790000
DHSMFGMC DS    CL4                                                      01791000
         ORG   DHSMFGMC                                                 01792000
DHSMFSBP DS    FL1                                                      01793000
DHSMFLEN DS    FL3                                                      01794000
         ORG   DHSMFGMC+4                                               01795000
IRBMFDHP CSECT                                                          01796000
         DS    0F                                                       01797000
@SIZDATD DC    AL1(0)                                                   01798000
         DC    AL3(@ENDDATD-@DATD)                                      01799000
         DS    0D                                                       01800000
DHPATCH  DS    CL200                                                    01801000
IRBMFDHP CSECT                                                          01802000
         IKJTCB                                                         01803000
IRBMFDHP CSECT                                                          01804000
@DATD    DSECT                                                          01805000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01806000
@ENDDATD EQU   *                                                        01807000
IRBMFDHP CSECT                                                          01808000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01809000
@01      EQU   01                                                       01810000
@02      EQU   02                                                       01811000
@03      EQU   03                                                       01812000
@04      EQU   04                                                       01813000
@05      EQU   05                                                       01814000
@06      EQU   06                                                       01815000
@07      EQU   07                                                       01816000
@08      EQU   08                                                       01817000
@09      EQU   09                                                       01818000
@10      EQU   10                                                       01819000
@11      EQU   11                                                       01820000
@12      EQU   12                                                       01821000
@13      EQU   13                                                       01822000
@14      EQU   14                                                       01823000
@15      EQU   15                                                       01824000
GPR00P   EQU   @00                                                      01825000
GPR01P   EQU   @01                                                      01826000
GPR14P   EQU   @14                                                      01827000
GPR15P   EQU   @15                                                      01828000
GPR05P   EQU   @05                                                      01829000
GPR13P   EQU   @13                                                      01830000
GPR03P   EQU   @03                                                      01831000
GPR04P   EQU   @04                                                      01832000
GPR06P   EQU   @06                                                      01833000
GPR02P   EQU   @02                                                      01834000
GPR00F   EQU   @00                                                      01835000
GPR01F   EQU   @01                                                      01836000
GPR14F   EQU   @14                                                      01837000
GPR15F   EQU   @15                                                      01838000
STSMA    EQU   0                                                        01839000
STSMOPT  EQU   STSMA                                                    01840000
STSMOFLG EQU   STSMOPT+3                                                01841000
STSMSAVE EQU   STSMA+24                                                 01842000
STSMENTR EQU   STSMA+28                                                 01843000
STSMEDAD EQU   STSMA+32                                                 01844000
STSMIGMC EQU   STSMA+36                                                 01845000
STSMILEN EQU   STSMIGMC+1                                               01846000
STSMIADD EQU   STSMA+40                                                 01847000
STSMRVT  EQU   STSMA+44                                                 01848000
STSMSSP  EQU   STSMA+52                                                 01849000
ECCEDT   EQU   0                                                        01850000
ECCECPEQ EQU   ECCEDT                                                   01851000
ECCECPUS EQU   ECCEDT+7                                                 01852000
ECCESAMP EQU   ECCEDT+8                                                 01853000
ECCPE    EQU   0                                                        01854000
ECCPFLGS EQU   ECCPE                                                    01855000
ECCPCNUM EQU   ECCPE+2                                                  01856000
ECCPCDBQ EQU   ECCPE+4                                                  01857000
ECCDB    EQU   0                                                        01858000
ECCDFLGS EQU   ECCDB                                                    01859000
ECCDIVID EQU   ECCDFLGS                                                 01860000
ECCDVALD EQU   ECCDFLGS                                                 01861000
ECCDCCHG EQU   ECCDFLGS                                                 01862000
ECCDALIV EQU   ECCDFLGS                                                 01863000
ECCDCHID EQU   ECCDB+4                                                  01864000
ECCDCTYP EQU   ECCDCHID                                                 01865000
ECCDSIOS EQU   ECCDB+8                                                  01866000
ECCDBUSY EQU   ECCDB+12                                                 01867000
ECCDOLAP EQU   ECCDB+16                                                 01868000
SMFRCD73 EQU   0                                                        01869000
SMF73LEN EQU   SMFRCD73                                                 01870000
SMF73RTY EQU   SMFRCD73+5                                               01871000
SMF73SIZ EQU   SMFRCD73+18                                              01872000
SMF73IST EQU   SMFRCD73+20                                              01873000
SMF73DAT EQU   SMFRCD73+24                                              01874000
SMF73INT EQU   SMFRCD73+28                                              01875000
SMF73SAM EQU   SMFRCD73+36                                              01876000
SMF73PTR EQU   0                                                        01877000
SMF73A   EQU   0                                                        01878000
SMF73SHC EQU   SMF73A                                                   01879000
SMF73CHA EQU   SMF73A+2                                                 01880000
SMF73SHD EQU   SMF73A+4                                                 01881000
SMF73B   EQU   0                                                        01882000
SMF73CID EQU   SMF73B                                                   01883000
SMF73HID EQU   SMF73B+2                                                 01884000
SMF73FG2 EQU   SMF73B+3                                                 01885000
SMF73TYP EQU   SMF73FG2                                                 01886000
SMF73IID EQU   SMF73FG2                                                 01887000
SMF73VAC EQU   SMF73FG2                                                 01888000
SMF73STA EQU   SMF73FG2                                                 01889000
SMF73CNT EQU   SMF73B+4                                                 01890000
SMF73BSY EQU   SMF73B+8                                                 01891000
SMF73OLP EQU   SMF73B+12                                                01892000
STRVT    EQU   0                                                        01893000
STRVSSGT EQU   STRVT+8                                                  01894000
STRVNSGT EQU   STRVT+12                                                 01895000
STSGT    EQU   0                                                        01896000
STSGFREE EQU   STSGT                                                    01897000
STSGADD  EQU   STSGT+4                                                  01898000
DHSMF73B EQU   0                                                        01899000
DHDTAGMC EQU   0                                                        01900000
IKEBC    EQU   0                                                        01901000
IKEBF15  EQU   0                                                        01902000
IKEBF31  EQU   0                                                        01903000
IKEBP15  EQU   0                                                        01904000
IKEBP31  EQU   0                                                        01905000
IKEBP8   EQU   0                                                        01906000
DHSMAPTR EQU   0                                                        01907000
DHRETDTA EQU   0                                                        01908000
DHFSTCLL EQU   0                                                        01909000
DHTRACE  EQU   0                                                        01910000
DHSMFHDR EQU   0                                                        01911000
DHTCBADR EQU   0                                                        01912000
DHINTSRT EQU   0                                                        01913000
DHINTDAT EQU   0                                                        01914000
DHINTLEN EQU   0                                                        01915000
STSMB    EQU   STSMOPT                                                  01916000
@NM00004 EQU   STSMB+3                                                  01917000
STSMDEVF EQU   @NM00004                                                 01918000
STSMC    EQU   STSMOPT                                                  01919000
@NM00006 EQU   STSMC+3                                                  01920000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01921000
STSMWKLD EQU   @NM00006                                                 01922000
@NM00007 EQU   @NM00006                                                 01923000
@NM00005 EQU   STSMC                                                    01924000
STSMCRDR EQU   STSMDEVF                                                 01925000
STSMUNIT EQU   STSMDEVF                                                 01926000
STSMGRAP EQU   STSMDEVF                                                 01927000
STSMDA   EQU   STSMDEVF                                                 01928000
STSMTP   EQU   STSMDEVF                                                 01929000
STSMTAPE EQU   STSMDEVF                                                 01930000
@NM00003 EQU   STSMB                                                    01931000
STSGLEN  EQU   STSGFREE+1                                               01932000
STSGSP   EQU   STSGFREE                                                 01933000
STRVNPRT EQU   STRVT+4                                                  01934000
STRVSPRT EQU   STRVT                                                    01935000
@NM00008 EQU   SMF73FG2                                                 01936000
SMF73RV2 EQU   SMF73A+6                                                 01937000
SMF73RLS EQU   SMFRCD73+44                                              01938000
SMF73RV1 EQU   SMFRCD73+42                                              01939000
SMF73MFV EQU   SMFRCD73+40                                              01940000
SMF73SUB EQU   SMFRCD73+34                                              01941000
SMF73CYC EQU   SMFRCD73+32                                              01942000
SMF73SID EQU   SMFRCD73+14                                              01943000
SMF73DTE EQU   SMFRCD73+10                                              01944000
SMF73TME EQU   SMFRCD73+6                                               01945000
SMF73FLG EQU   SMFRCD73+4                                               01946000
SMF73SEG EQU   SMFRCD73+2                                               01947000
ECCDLSIO EQU   ECCDB+6                                                  01948000
ECCDCMOD EQU   ECCDCHID                                                 01949000
ECCDRS02 EQU   ECCDB+1                                                  01950000
ECCDRS01 EQU   ECCDFLGS                                                 01951000
ECCPRS02 EQU   ECCPE+1                                                  01952000
ECCPVALD EQU   ECCPFLGS                                                 01953000
ECCPRS01 EQU   ECCPFLGS                                                 01954000
ECCECCHK EQU   ECCEDT+12                                                01955000
ECCERS01 EQU   ECCEDT+4                                                 01956000
STSMRSV1 EQU   STSMA+53                                                 01957000
STSMLCOM EQU   STSMA+48                                                 01958000
STSMISP  EQU   STSMIGMC                                                 01959000
STSMINTP EQU   STSMA+20                                                 01960000
STSMTERM EQU   STSMA+12                                                 01961000
STSMINIT EQU   STSMA+4                                                  01962000
STSMSTA  EQU   STSMOFLG                                                 01963000
@NM00002 EQU   STSMOFLG                                                 01964000
@NM00001 EQU   STSMOPT                                                  01965000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01966000
@RT00065 EQU   DHLAB2                                                   01967000
@RT00127 EQU   @EL00001                                                 01968000
@ENDDATA EQU   *                                                        01969000
         END   IRBMFDHP,(C'PL/S-II',0502,74087)                         01970000
