         TITLE '*/* IRBMFRDR - DEVICE REPORT GENERATOR                 *00001000
                       '                                                00002000
IRBMFRDR CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IRBMFRDR  74.087'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @10,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@10                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @09,@01                                             0001 00016000
         USING @DATD,@09                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @09,8(,@13)                                         0001 00020000
         LR    @13,@09                                             0001 00021000
         MVC   @PC00001(12),0(@01)                                 0001 00022000
*                                                                  0014 00023000
*/* BEGIN MAINLINE PROCESSING                                        */ 00024000
*                                                                  0014 00025000
*   /*****************************************************************/ 00026000
*   /*                                                               */ 00027000
*   /* BEGIN REPORT GENERATOR PROCESSING. CREATE ONE REPORT FOR EACH */ 00028000
*   /* ACTIVE DEVICE CLASS.                                          */ 00029000
*   /*                                                               */ 00030000
*   /*****************************************************************/ 00031000
*                                                                  0014 00032000
*   DO RDCLSIDX=1 TO DIM(DDDVADD);                                 0014 00033000
         LA    @08,1                                               0014 00034000
         STH   @08,RDCLSIDX                                        0014 00035000
@DL00014 DS    0H                                                  0015 00036000
*     IF DDDVADD(RDCLSIDX)^=0 THEN  /* IF DATA EXISTS FOR THIS CLASS */ 00037000
         SR    @15,@15                                             0015 00038000
         SLA   @08,2                                               0015 00039000
         L     @14,@PC00001                                        0015 00040000
         L     @01,RDDTAPTR(,@14)                                  0015 00041000
         AL    @01,@CF00249                                        0015 00042000
         C     @15,DDDVADD(@08,@01)                                0015 00043000
         BE    @RF00015                                            0015 00044000
*       DO;                                                        0016 00045000
*                                                                  0016 00046000
*         /***********************************************************/ 00047000
*         /*                                                         */ 00048000
*         /* INITIALIZE FOR THIS CLASS                               */ 00049000
*         /*                                                         */ 00050000
*         /***********************************************************/ 00051000
*                                                                  0017 00052000
*         RDPAGE=1;                 /* FIRST PAGE                    */ 00053000
         LA    @08,1                                               0017 00054000
         ST    @08,RDPAGE                                          0017 00055000
*         RDLINE=RGMAXLN;           /* LINE VARIABLE SET TO CAUSE  0018 00056000
*                                      HEADER TO BE INSERTED         */ 00057000
         MVC   RDLINE(4),@CF00095                                  0018 00058000
*         RDSIOTOT=0;               /* TOTAL SIO COUNT               */ 00059000
*                                                                  0019 00060000
         ST    @15,RDSIOTOT                                        0019 00061000
*         /***********************************************************/ 00062000
*         /*                                                         */ 00063000
*         /* FORMAT DATA FOR EACH DEVICE ENTRY IN THIS CLASS         */ 00064000
*         /*                                                         */ 00065000
*         /***********************************************************/ 00066000
*                                                                  0020 00067000
*         DO RDDEVIDX=1 TO SMF74DEV;                               0020 00068000
*                                                                  0020 00069000
         B     @DE00020                                            0020 00070000
@DL00020 DS    0H                                                  0021 00071000
*           /*********************************************************/ 00072000
*           /*                                                       */ 00073000
*           /* PLACE ENTRIES IN GROUPS OF FOUR                       */ 00074000
*           /*                                                       */ 00075000
*           /*********************************************************/ 00076000
*                                                                  0021 00077000
*           IF RDDEVIDX//4=1 THEN                                  0021 00078000
         LA    @15,1                                               0021 00079000
         LR    @00,@08                                             0021 00080000
         SRDA  @00,32                                              0021 00081000
         D     @00,@CF00058                                        0021 00082000
         CR    @00,@15                                             0021 00083000
         BNE   @RF00021                                            0021 00084000
*             RDLINE=RDLINE+1;      /* INCREMENT LINE INDEX          */ 00085000
*                                                                  0022 00086000
         A     @15,RDLINE                                          0022 00087000
         ST    @15,RDLINE                                          0022 00088000
*           /*********************************************************/ 00089000
*           /*                                                       */ 00090000
*           /* IF NO MORE ROOM ON THIS PAGE, GET NEW PAGE            */ 00091000
*           /*                                                       */ 00092000
*           /*********************************************************/ 00093000
*                                                                  0023 00094000
*           IF RDLINE>=(RGMAXLN-3)THEN                             0023 00095000
@RF00021 L     @08,RDLINE                                          0023 00096000
         CH    @08,@CH00232                                        0023 00097000
         BL    @RF00023                                            0023 00098000
*             DO;                                                  0024 00099000
*               IF RDDEVIDX>1 THEN  /* IF THIS IS NOT FIRST ENTRY    */ 00100000
         LH    @08,RDDEVIDX                                        0025 00101000
         CH    @08,@CH00081                                        0025 00102000
         BNH   @RF00025                                            0025 00103000
*                 CALL MFWRTPAG;    /* WRITE OUT PAGE AND CLEAR    0026 00104000
*                                      INTERNAL PAGE IMAGE           */ 00105000
*                                                                  0026 00106000
         L     @08,@PC00001+4                                      0026 00107000
         L     @15,RDVECTAB+12(,@08)                               0026 00108000
         BALR  @14,@15                                             0026 00109000
*               /*****************************************************/ 00110000
*               /*                                                   */ 00111000
*               /* BUILD NEW HEADER. START WITH STANDARD HEADER      */ 00112000
*               /*                                                   */ 00113000
*               /*****************************************************/ 00114000
*                                                                  0027 00115000
*               CALL MFHDRISR(                                     0027 00116000
*                                                                  0027 00117000
*               /*****************************************************/ 00118000
*               /*                                                   */ 00119000
*               /* POINTER TO SMF RECORD                             */ 00120000
*               /*                                                   */ 00121000
*               /*****************************************************/ 00122000
*                                                                  0027 00123000
*                   DDDVADD(RDCLSIDX),                             0027 00124000
*                                                                  0027 00125000
*               /*****************************************************/ 00126000
*               /*                                                   */ 00127000
*               /* TITLE                                             */ 00128000
*               /*                                                   */ 00129000
*               /*****************************************************/ 00130000
*                                                                  0027 00131000
*                   LNGTPTR(RDTPART(RDCLSIDX))->LNGTXTD,           0027 00132000
*                                                                  0027 00133000
*               /*****************************************************/ 00134000
*               /*                                                   */ 00135000
*               /* TITLE LENGTH                                      */ 00136000
*               /*                                                   */ 00137000
*               /*****************************************************/ 00138000
*                                                                  0027 00139000
*                   LNGTPTR(RDTPART(RDCLSIDX))->LNGTXTL,RDPAGE/* PAGE   00140000
*                                      NUMBER                        */ 00141000
*                   );                                             0027 00142000
@RF00025 LH    @08,RDCLSIDX                                        0027 00143000
         LR    @15,@08                                             0027 00144000
         SLA   @15,2                                               0027 00145000
         L     @14,@PC00001                                        0027 00146000
         L     @01,RDDTAPTR(,@14)                                  0027 00147000
         AL    @01,@CF00249                                        0027 00148000
         LA    @15,DDDVADD(@15,@01)                                0027 00149000
         ST    @15,@AL00001                                        0027 00150000
         AR    @08,@08                                             0027 00151000
         LH    @08,RDTPART-2(@08)                                  0027 00152000
         SLA   @08,2                                               0027 00153000
         L     @15,@CA00125                                        0027 00154000
         AL    @15,@CF00249                                        0027 00155000
         L     @08,LNGTPTR-IRBMFLDV(@08,@15)                       0027 00156000
         LA    @15,LNGTXTD(,@08)                                   0027 00157000
         ST    @15,@AL00001+4                                      0027 00158000
         ST    @08,@AL00001+8                                      0027 00159000
         LA    @08,RDPAGE                                          0027 00160000
         ST    @08,@AL00001+12                                     0027 00161000
         L     @08,@PC00001+4                                      0027 00162000
         L     @15,RDVECTAB+4(,@08)                                0027 00163000
         LA    @01,@AL00001                                        0027 00164000
         BALR  @14,@15                                             0027 00165000
*               RDPAGE=RDPAGE+1;    /* NEXT PAGE NUMBER              */ 00166000
*                                                                  0028 00167000
         LA    @08,1                                               0028 00168000
         A     @08,RDPAGE                                          0028 00169000
         ST    @08,RDPAGE                                          0028 00170000
*               /*****************************************************/ 00171000
*               /*                                                   */ 00172000
*               /* BUILD SPECIAL DEVICE HEADER. INSERT 'DEVICE'      */ 00173000
*               /* MACDATE Y-2 73018                                 */ 00174000
*               /*                                                   */ 00175000
*               /*****************************************************/ 00176000
*                                                                  0029 00177000
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */ 00178000
*                   LNGTPTR(LDPART7)->LNGTXTD,/* TEXT                */ 00179000
*                   LNGTPTR(LDPART7)->LNGTXTL,/* LENGTH              */ 00180000
*                   LINE8,          /* START LINE                    */ 00181000
*                   COLA            /* START COLUMN                  */ 00182000
*                   );                                             0029 00183000
*                                                                  0029 00184000
         L     @08,@CA00125                                        0029 00185000
         L     @08,LNGTPTR-IRBMFLDV+24(,@08)                       0029 00186000
         LA    @15,LNGTXTD(,@08)                                   0029 00187000
         ST    @15,@AL00001                                        0029 00188000
         ST    @08,@AL00001+4                                      0029 00189000
         LA    @08,@CF00054                                        0029 00190000
         ST    @08,@AL00001+8                                      0029 00191000
         LA    @08,@CF00081                                        0029 00192000
         ST    @08,@AL00001+12                                     0029 00193000
         L     @08,@PC00001+4                                      0029 00194000
         L     @15,RDVECTAB+8(,@08)                                0029 00195000
         LA    @01,@AL00001                                        0029 00196000
         BALR  @14,@15                                             0029 00197000
*               /*****************************************************/ 00198000
*               /*                                                   */ 00199000
*               /* INSERT 'ADDRESS' MACDATE Y-2 73018                */ 00200000
*               /*                                                   */ 00201000
*               /*****************************************************/ 00202000
*                                                                  0030 00203000
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */ 00204000
*                   LNGTPTR(LDPART8)->LNGTXTD,/* TEXT                */ 00205000
*                   LNGTPTR(LDPART8)->LNGTXTL,/* LENGTH              */ 00206000
*                   LINE9,          /* START LINE                    */ 00207000
*                   COLA            /* START COLUMN                  */ 00208000
*                   );                                             0030 00209000
*                                                                  0030 00210000
         L     @08,@CA00125                                        0030 00211000
         L     @08,LNGTPTR-IRBMFLDV+28(,@08)                       0030 00212000
         LA    @15,LNGTXTD(,@08)                                   0030 00213000
         ST    @15,@AL00001                                        0030 00214000
         ST    @08,@AL00001+4                                      0030 00215000
         LA    @08,@CF00141                                        0030 00216000
         ST    @08,@AL00001+8                                      0030 00217000
         LA    @08,@CF00081                                        0030 00218000
         ST    @08,@AL00001+12                                     0030 00219000
         L     @08,@PC00001+4                                      0030 00220000
         L     @15,RDVECTAB+8(,@08)                                0030 00221000
         LA    @01,@AL00001                                        0030 00222000
         BALR  @14,@15                                             0030 00223000
*               /*****************************************************/ 00224000
*               /*                                                   */ 00225000
*               /* INSERT 'VOLUME SERIAL' IF THIS IS THE TAPE OR DASD*/ 00226000
*               /* REPORT                                            */ 00227000
*               /*                                                   */ 00228000
*               /*****************************************************/ 00229000
*                                                                  0031 00230000
*               IF SMF74SUB(2)=TAPE|SMF74SUB(2)=DASD THEN          0031 00231000
         LH    @08,RDCLSIDX                                        0031 00232000
         SLA   @08,2                                               0031 00233000
         L     @15,@PC00001                                        0031 00234000
         L     @01,RDDTAPTR(,@15)                                  0031 00235000
         AL    @01,@CF00249                                        0031 00236000
         L     @08,DDDVADD(@08,@01)                                0031 00237000
         CLI   SMF74SUB+1(@08),X'80'                               0031 00238000
         BE    @RT00031                                            0031 00239000
         CLI   SMF74SUB+1(@08),X'20'                               0031 00240000
         BNE   @RF00031                                            0031 00241000
@RT00031 DS    0H                                                  0032 00242000
*                 DO;                                              0032 00243000
*                                                                  0032 00244000
*                   /*************************************************/ 00245000
*                   /*                                               */ 00246000
*                   /* MACDATE Y-2 73018                             */ 00247000
*                   /*                                               */ 00248000
*                   /*************************************************/ 00249000
*                                                                  0033 00250000
*                   CALL MFISRTXT(  /* INSERT TEXT ROUTINE           */ 00251000
*                       LNGTPTR(LDPART20)->LNGTXTD,/* TEXT           */ 00252000
*                       LNGTPTR(LDPART20)->LNGTXTL,/* LENGTH         */ 00253000
*                       LINE8,      /* START LINE                    */ 00254000
*                       COLA5       /* START COLUMN                  */ 00255000
*                       );                                         0033 00256000
*                                                                  0033 00257000
         L     @08,@CA00125                                        0033 00258000
         L     @08,LNGTPTR-IRBMFLDV+76(,@08)                       0033 00259000
         LA    @15,LNGTXTD(,@08)                                   0033 00260000
         ST    @15,@AL00001                                        0033 00261000
         ST    @08,@AL00001+4                                      0033 00262000
         LA    @08,@CF00054                                        0033 00263000
         ST    @08,@AL00001+8                                      0033 00264000
         LA    @08,@CF00051                                        0033 00265000
         ST    @08,@AL00001+12                                     0033 00266000
         L     @08,@PC00001+4                                      0033 00267000
         L     @15,RDVECTAB+8(,@08)                                0033 00268000
         LA    @01,@AL00001                                        0033 00269000
         BALR  @14,@15                                             0033 00270000
*                   /*************************************************/ 00271000
*                   /*                                               */ 00272000
*                   /* MACDATE Y-2 73018                             */ 00273000
*                   /*                                               */ 00274000
*                   /*************************************************/ 00275000
*                                                                  0034 00276000
*                   CALL MFISRTXT(  /* INSERT TEXT ROUTINE           */ 00277000
*                       LNGTPTR(LDPART21)->LNGTXTD,/* TEXT           */ 00278000
*                       LNGTPTR(LDPART21)->LNGTXTL,/* LENGTH         */ 00279000
*                       LINE9,      /* START LINE                    */ 00280000
*                       COLA5       /* START COLUMN                  */ 00281000
*                       );                                         0034 00282000
         L     @08,@CA00125                                        0034 00283000
         L     @08,LNGTPTR-IRBMFLDV+80(,@08)                       0034 00284000
         LA    @15,LNGTXTD(,@08)                                   0034 00285000
         ST    @15,@AL00001                                        0034 00286000
         ST    @08,@AL00001+4                                      0034 00287000
         LA    @08,@CF00141                                        0034 00288000
         ST    @08,@AL00001+8                                      0034 00289000
         LA    @08,@CF00051                                        0034 00290000
         ST    @08,@AL00001+12                                     0034 00291000
         L     @08,@PC00001+4                                      0034 00292000
         L     @15,RDVECTAB+8(,@08)                                0034 00293000
         LA    @01,@AL00001                                        0034 00294000
         BALR  @14,@15                                             0034 00295000
*                 END;                                             0035 00296000
*                                                                  0035 00297000
*               /*****************************************************/ 00298000
*               /*                                                   */ 00299000
*               /* INSERT 'DEVICE' MACDATE Y-2 73018                 */ 00300000
*               /*                                                   */ 00301000
*               /*****************************************************/ 00302000
*                                                                  0036 00303000
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */ 00304000
*                   LNGTPTR(LDPART7)->LNGTXTD,/* TEXT                */ 00305000
*                   LNGTPTR(LDPART7)->LNGTXTL,/* LENGTH              */ 00306000
*                   LINE7,          /* START LINE                    */ 00307000
*                   COLB            /* START COLUMN                  */ 00308000
*                   );                                             0036 00309000
*                                                                  0036 00310000
@RF00031 L     @08,@CA00125                                        0036 00311000
         L     @08,LNGTPTR-IRBMFLDV+24(,@08)                       0036 00312000
         LA    @15,LNGTXTD(,@08)                                   0036 00313000
         ST    @15,@AL00001                                        0036 00314000
         ST    @08,@AL00001+4                                      0036 00315000
         LA    @08,@CF00138                                        0036 00316000
         ST    @08,@AL00001+8                                      0036 00317000
         LA    @08,@CF00211                                        0036 00318000
         ST    @08,@AL00001+12                                     0036 00319000
         L     @08,@PC00001+4                                      0036 00320000
         L     @15,RDVECTAB+8(,@08)                                0036 00321000
         LA    @01,@AL00001                                        0036 00322000
         BALR  @14,@15                                             0036 00323000
*               /*****************************************************/ 00324000
*               /*                                                   */ 00325000
*               /* INSERT 'ACTIVITY' MACDATE Y-2 73018               */ 00326000
*               /*                                                   */ 00327000
*               /*****************************************************/ 00328000
*                                                                  0037 00329000
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */ 00330000
*                   LNGTPTR(LDPART9)->LNGTXTD,/* TEXT                */ 00331000
*                   LNGTPTR(LDPART9)->LNGTXTL,/* LENGTH              */ 00332000
*                   LINE8,          /* START LINE                    */ 00333000
*                   COLB            /* START COLUMN                  */ 00334000
*                   );                                             0037 00335000
*                                                                  0037 00336000
         L     @08,@CA00125                                        0037 00337000
         L     @08,LNGTPTR-IRBMFLDV+32(,@08)                       0037 00338000
         LA    @15,LNGTXTD(,@08)                                   0037 00339000
         ST    @15,@AL00001                                        0037 00340000
         ST    @08,@AL00001+4                                      0037 00341000
         LA    @08,@CF00054                                        0037 00342000
         ST    @08,@AL00001+8                                      0037 00343000
         LA    @08,@CF00211                                        0037 00344000
         ST    @08,@AL00001+12                                     0037 00345000
         L     @08,@PC00001+4                                      0037 00346000
         L     @15,RDVECTAB+8(,@08)                                0037 00347000
         LA    @01,@AL00001                                        0037 00348000
         BALR  @14,@15                                             0037 00349000
*               /*****************************************************/ 00350000
*               /*                                                   */ 00351000
*               /* INSERT 'COUNT' MACDATE Y-2 73018                  */ 00352000
*               /*                                                   */ 00353000
*               /*****************************************************/ 00354000
*                                                                  0038 00355000
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */ 00356000
*                   LNGTPTR(LDPART10)->LNGTXTD,/* TEXT               */ 00357000
*                   LNGTPTR(LDPART10)->LNGTXTL,/* LENGTH             */ 00358000
*                   LINE9,          /* START LINE                    */ 00359000
*                   COLB            /* START COLUMN                  */ 00360000
*                   );                                             0038 00361000
*                                                                  0038 00362000
         L     @08,@CA00125                                        0038 00363000
         L     @08,LNGTPTR-IRBMFLDV+36(,@08)                       0038 00364000
         LA    @15,LNGTXTD(,@08)                                   0038 00365000
         ST    @15,@AL00001                                        0038 00366000
         ST    @08,@AL00001+4                                      0038 00367000
         LA    @08,@CF00141                                        0038 00368000
         ST    @08,@AL00001+8                                      0038 00369000
         LA    @08,@CF00211                                        0038 00370000
         ST    @08,@AL00001+12                                     0038 00371000
         L     @08,@PC00001+4                                      0038 00372000
         L     @15,RDVECTAB+8(,@08)                                0038 00373000
         LA    @01,@AL00001                                        0038 00374000
         BALR  @14,@15                                             0038 00375000
*               /*****************************************************/ 00376000
*               /*                                                   */ 00377000
*               /* INSERT 'PERCENT' MACDATE Y-2 73018                */ 00378000
*               /*                                                   */ 00379000
*               /*****************************************************/ 00380000
*                                                                  0039 00381000
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */ 00382000
*                   LNGTPTR(LDPART11)->LNGTXTD,/* TEXT               */ 00383000
*                   LNGTPTR(LDPART11)->LNGTXTL,/* LENGTH             */ 00384000
*                   LINE8,          /* START LINE                    */ 00385000
*                   COLC            /* START COLUMN                  */ 00386000
*                   );                                             0039 00387000
*                                                                  0039 00388000
         L     @08,@CA00125                                        0039 00389000
         L     @08,LNGTPTR-IRBMFLDV+40(,@08)                       0039 00390000
         LA    @15,LNGTXTD(,@08)                                   0039 00391000
         ST    @15,@AL00001                                        0039 00392000
         ST    @08,@AL00001+4                                      0039 00393000
         LA    @08,@CF00054                                        0039 00394000
         ST    @08,@AL00001+8                                      0039 00395000
         LA    @08,@CF00213                                        0039 00396000
         ST    @08,@AL00001+12                                     0039 00397000
         L     @08,@PC00001+4                                      0039 00398000
         L     @15,RDVECTAB+8(,@08)                                0039 00399000
         LA    @01,@AL00001                                        0039 00400000
         BALR  @14,@15                                             0039 00401000
*               /*****************************************************/ 00402000
*               /*                                                   */ 00403000
*               /* INSERT 'BUSY' MACDATE Y-2 73018                   */ 00404000
*               /*                                                   */ 00405000
*               /*****************************************************/ 00406000
*                                                                  0040 00407000
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */ 00408000
*                   LNGTPTR(LDPART12)->LNGTXTD,/* TEXT               */ 00409000
*                   LNGTPTR(LDPART12)->LNGTXTL,/* LENGTH             */ 00410000
*                   LINE9,          /* START LINE                    */ 00411000
*                   COLC            /* START COLUMN                  */ 00412000
*                   );                                             0040 00413000
*                                                                  0040 00414000
         L     @08,@CA00125                                        0040 00415000
         L     @08,LNGTPTR-IRBMFLDV+44(,@08)                       0040 00416000
         LA    @15,LNGTXTD(,@08)                                   0040 00417000
         ST    @15,@AL00001                                        0040 00418000
         ST    @08,@AL00001+4                                      0040 00419000
         LA    @08,@CF00141                                        0040 00420000
         ST    @08,@AL00001+8                                      0040 00421000
         LA    @08,@CF00213                                        0040 00422000
         ST    @08,@AL00001+12                                     0040 00423000
         L     @08,@PC00001+4                                      0040 00424000
         L     @15,RDVECTAB+8(,@08)                                0040 00425000
         LA    @01,@AL00001                                        0040 00426000
         BALR  @14,@15                                             0040 00427000
*               /*****************************************************/ 00428000
*               /*                                                   */ 00429000
*               /* INSERT 'MEAN' MACDATE Y-2 73018                   */ 00430000
*               /*                                                   */ 00431000
*               /*****************************************************/ 00432000
*                                                                  0041 00433000
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */ 00434000
*                   LNGTPTR(LDPART13)->LNGTXTD,/* TEXT               */ 00435000
*                   LNGTPTR(LDPART13)->LNGTXTL,/* LENGTH             */ 00436000
*                   LINE8,          /* START LINE                    */ 00437000
*                   COLD            /* START COLUMN                  */ 00438000
*                   );                                             0041 00439000
*                                                                  0041 00440000
         L     @08,@CA00125                                        0041 00441000
         L     @08,LNGTPTR-IRBMFLDV+48(,@08)                       0041 00442000
         LA    @15,LNGTXTD(,@08)                                   0041 00443000
         ST    @15,@AL00001                                        0041 00444000
         ST    @08,@AL00001+4                                      0041 00445000
         LA    @08,@CF00054                                        0041 00446000
         ST    @08,@AL00001+8                                      0041 00447000
         LA    @08,@CF00095                                        0041 00448000
         ST    @08,@AL00001+12                                     0041 00449000
         L     @08,@PC00001+4                                      0041 00450000
         L     @15,RDVECTAB+8(,@08)                                0041 00451000
         LA    @01,@AL00001                                        0041 00452000
         BALR  @14,@15                                             0041 00453000
*               /*****************************************************/ 00454000
*               /*                                                   */ 00455000
*               /* INSERT 'QLENGTH' MACDATE Y-2 73018                */ 00456000
*               /*                                                   */ 00457000
*               /*****************************************************/ 00458000
*                                                                  0042 00459000
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */ 00460000
*                   LNGTPTR(LDPART14)->LNGTXTD,/* TEXT               */ 00461000
*                   LNGTPTR(LDPART14)->LNGTXTL,/* LENGTH             */ 00462000
*                   LINE9,          /* START LINE                    */ 00463000
*                   COLD            /* START COLUMN                  */ 00464000
*                   );                                             0042 00465000
         L     @08,@CA00125                                        0042 00466000
         L     @08,LNGTPTR-IRBMFLDV+52(,@08)                       0042 00467000
         LA    @15,LNGTXTD(,@08)                                   0042 00468000
         ST    @15,@AL00001                                        0042 00469000
         ST    @08,@AL00001+4                                      0042 00470000
         LA    @08,@CF00141                                        0042 00471000
         ST    @08,@AL00001+8                                      0042 00472000
         LA    @08,@CF00095                                        0042 00473000
         ST    @08,@AL00001+12                                     0042 00474000
         L     @08,@PC00001+4                                      0042 00475000
         L     @15,RDVECTAB+8(,@08)                                0042 00476000
         LA    @01,@AL00001                                        0042 00477000
         BALR  @14,@15                                             0042 00478000
*               RDLINE=LINE13;      /* INITIALIZE LINE NUMBER FOR  0043 00479000
*                                      NEXT ENTRY                    */ 00480000
         MVC   RDLINE(4),@CF00097                                  0043 00481000
*             END;                                                 0044 00482000
*                                                                  0044 00483000
*           /*********************************************************/ 00484000
*           /*                                                       */ 00485000
*           /* FORMAT AND INSERT ENTRY FOR THIS DEVICE. FIRST,       */ 00486000
*           /* CONVERT AND INSERT UCB EXTERNAL DEVICE ADDRESS. FORM  */ 00487000
*           /* HHHF TO HHHF40                                        */ 00488000
*           /*                                                       */ 00489000
*           /*********************************************************/ 00490000
*                                                                  0045 00491000
*           RDPACKAD=SMF74ADD(RDDEVIDX);                           0045 00492000
*                                                                  0045 00493000
@RF00023 MVI   RDPACKAD+2,C' '                                     0045 00494000
         LH    @08,RDDEVIDX                                        0045 00495000
         MH    @08,@CH00234                                        0045 00496000
         LH    @15,RDCLSIDX                                        0045 00497000
         SLA   @15,2                                               0045 00498000
         L     @14,@PC00001                                        0045 00499000
         L     @01,RDDTAPTR(,@14)                                  0045 00500000
         AL    @01,@CF00249                                        0045 00501000
         L     @15,DDDVADD(@15,@01)                                0045 00502000
         LA    @14,SMF74SIZ(,@15)                                  0045 00503000
         AH    @14,SMF74SIZ(,@15)                                  0045 00504000
         LH    @15,SMF74SDC(,@14)                                  0045 00505000
         AR    @15,@14                                             0045 00506000
         ALR   @15,@08                                             0045 00507000
         AL    @15,@CF00250                                        0045 00508000
         MVC   RDPACKAD(2),SMF74ADD(@15)                           0045 00509000
*           /*********************************************************/ 00510000
*           /*                                                       */ 00511000
*           /* FORM FHFHFHFF04                                       */ 00512000
*           /*                                                       */ 00513000
*           /*********************************************************/ 00514000
*                                                                  0046 00515000
*           UNPK(RDWRKSTR(1:5),RDPACKAD);                          0046 00516000
*                                                                  0046 00517000
         UNPK  RDWRKSTR(5),RDPACKAD(3)                             0046 00518000
*           /*********************************************************/ 00519000
*           /*                                                       */ 00520000
*           /* FORM (IN EBCDIC) HHH                                  */ 00521000
*           /*                                                       */ 00522000
*           /*********************************************************/ 00523000
*                                                                  0047 00524000
*           TR(RDWRKSTR(1:3),RDTRTAB);                             0047 00525000
*                                                                  0047 00526000
         LA    @08,RDDTRTAB                                        0047 00527000
         SH    @08,@CH00171                                        0047 00528000
         TR    RDWRKSTR(3),RDTRTAB(@08)                            0047 00529000
*           /*********************************************************/ 00530000
*           /*                                                       */ 00531000
*           /* MACDATE Y-2 73018                                     */ 00532000
*           /*                                                       */ 00533000
*           /*********************************************************/ 00534000
*                                                                  0048 00535000
*           CALL MFISRTXT(          /* INSERT TEXT ROUTINE           */ 00536000
*               RDWRKSTR,           /* TEXT                          */ 00537000
*               3,                  /* LENGTH                        */ 00538000
*               RDLINE,             /* START LINE                    */ 00539000
*               COLA                /* START COLUMN                  */ 00540000
*               );                                                 0048 00541000
*                                                                  0048 00542000
         LA    @08,RDWRKSTR                                        0048 00543000
         ST    @08,@AL00001                                        0048 00544000
         LA    @08,@CF00107                                        0048 00545000
         ST    @08,@AL00001+4                                      0048 00546000
         LA    @08,RDLINE                                          0048 00547000
         ST    @08,@AL00001+8                                      0048 00548000
         LA    @08,@CF00081                                        0048 00549000
         ST    @08,@AL00001+12                                     0048 00550000
         L     @08,@PC00001+4                                      0048 00551000
         L     @15,RDVECTAB+8(,@08)                                0048 00552000
         LA    @01,@AL00001                                        0048 00553000
         BALR  @14,@15                                             0048 00554000
*           /*********************************************************/ 00555000
*           /*                                                       */ 00556000
*           /* INSERT VOLUME SERIAL NUMBER IF THIS IS THE DASD OR    */ 00557000
*           /* TAPE REPORT                                           */ 00558000
*           /*                                                       */ 00559000
*           /*********************************************************/ 00560000
*                                                                  0049 00561000
*           IF SMF74SUB(2)=TAPE|SMF74SUB(2)=DASD THEN              0049 00562000
*                                                                  0049 00563000
         LH    @08,RDCLSIDX                                        0049 00564000
         SLA   @08,2                                               0049 00565000
         L     @15,@PC00001                                        0049 00566000
         L     @01,RDDTAPTR(,@15)                                  0049 00567000
         AL    @01,@CF00249                                        0049 00568000
         L     @08,DDDVADD(@08,@01)                                0049 00569000
         CLI   SMF74SUB+1(@08),X'80'                               0049 00570000
         BE    @RT00049                                            0049 00571000
         CLI   SMF74SUB+1(@08),X'20'                               0049 00572000
         BNE   @RF00049                                            0049 00573000
@RT00049 DS    0H                                                  0050 00574000
*             /*******************************************************/ 00575000
*             /*                                                     */ 00576000
*             /* MACDATE Y-2 73018                                   */ 00577000
*             /*                                                     */ 00578000
*             /*******************************************************/ 00579000
*                                                                  0050 00580000
*             CALL MFISRTXT(        /* INSERT TEXT ROUTINE           */ 00581000
*                 SMF74SER(RDDEVIDX),/* TEXT                         */ 00582000
*                 LENGTH(SMF74SER(RDDEVIDX)),/* LENGTH               */ 00583000
*                 RDLINE,           /* START LINE                    */ 00584000
*                 COLA5             /* START COLUMN                  */ 00585000
*                 );                                               0050 00586000
*                                                                  0050 00587000
         LH    @08,RDDEVIDX                                        0050 00588000
         MH    @08,@CH00234                                        0050 00589000
         LH    @15,RDCLSIDX                                        0050 00590000
         SLA   @15,2                                               0050 00591000
         L     @14,@PC00001                                        0050 00592000
         L     @01,RDDTAPTR(,@14)                                  0050 00593000
         AL    @01,@CF00249                                        0050 00594000
         L     @15,DDDVADD(@15,@01)                                0050 00595000
         LA    @14,SMF74SIZ(,@15)                                  0050 00596000
         AH    @14,SMF74SIZ(,@15)                                  0050 00597000
         LH    @15,SMF74SDC(,@14)                                  0050 00598000
         AR    @15,@14                                             0050 00599000
         AL    @15,@CF00251                                        0050 00600000
         LA    @08,SMF74SER-8(@08,@15)                             0050 00601000
         ST    @08,@AL00001                                        0050 00602000
         LA    @08,@CF00047                                        0050 00603000
         ST    @08,@AL00001+4                                      0050 00604000
         LA    @08,RDLINE                                          0050 00605000
         ST    @08,@AL00001+8                                      0050 00606000
         LA    @08,@CF00051                                        0050 00607000
         ST    @08,@AL00001+12                                     0050 00608000
         L     @08,@PC00001+4                                      0050 00609000
         L     @15,RDVECTAB+8(,@08)                                0050 00610000
         LA    @01,@AL00001                                        0050 00611000
         BALR  @14,@15                                             0050 00612000
*           /*********************************************************/ 00613000
*           /*                                                       */ 00614000
*           /* IF CONFIGURATION CHANGE HAS OCCURRED OR IF DEVICE IS  */ 00615000
*           /* OFFLINE, INSERT PROPER MESSAGE AND NO DATA.           */ 00616000
*           /*                                                       */ 00617000
*           /*********************************************************/ 00618000
*                                                                  0051 00619000
*           IF SMF74VAC(RDDEVIDX)='1'B|SMF74STA(RDDEVIDX)='0'B THEN     00620000
@RF00049 LH    @08,RDDEVIDX                                        0051 00621000
         MH    @08,@CH00234                                        0051 00622000
         LH    @15,RDCLSIDX                                        0051 00623000
         SLA   @15,2                                               0051 00624000
         L     @14,@PC00001                                        0051 00625000
         L     @01,RDDTAPTR(,@14)                                  0051 00626000
         AL    @01,@CF00249                                        0051 00627000
         L     @15,DDDVADD(@15,@01)                                0051 00628000
         LA    @14,SMF74SIZ(,@15)                                  0051 00629000
         AH    @14,SMF74SIZ(,@15)                                  0051 00630000
         LH    @15,SMF74SDC(,@14)                                  0051 00631000
         AR    @15,@14                                             0051 00632000
         ALR   @15,@08                                             0051 00633000
         AL    @15,@CF00252                                        0051 00634000
         TM    SMF74VAC-3(@15),B'00000010'                         0051 00635000
         BNZ   @RT00051                                            0051 00636000
         TM    SMF74STA-3(@15),B'00000001'                         0051 00637000
         BO    @RF00051                                            0051 00638000
@RT00051 DS    0H                                                  0052 00639000
*             DO;                                                  0052 00640000
*               IF SMF74VAC(RDDEVIDX)='1'B THEN                    0053 00641000
         LH    @08,RDDEVIDX                                        0053 00642000
         MH    @08,@CH00234                                        0053 00643000
         LH    @15,RDCLSIDX                                        0053 00644000
         SLA   @15,2                                               0053 00645000
         L     @14,@PC00001                                        0053 00646000
         L     @01,RDDTAPTR(,@14)                                  0053 00647000
         AL    @01,@CF00249                                        0053 00648000
         L     @15,DDDVADD(@15,@01)                                0053 00649000
         LA    @14,SMF74SIZ(,@15)                                  0053 00650000
         AH    @14,SMF74SIZ(,@15)                                  0053 00651000
         LH    @15,SMF74SDC(,@14)                                  0053 00652000
         AR    @15,@14                                             0053 00653000
         ST    @08,@TF00001                                        0053 00654000
         ALR   @08,@15                                             0053 00655000
         AL    @08,@CF00252                                        0053 00656000
         TM    SMF74VAC-3(@08),B'00000010'                         0053 00657000
         BNO   @RF00053                                            0053 00658000
*                 DO;               /* CONFIGURATION CHANGE HAS BEEN    00659000
*                                      DETECTED                      */ 00660000
*                   IF SMF74STA(RDDEVIDX)='1'B THEN                0055 00661000
*                                                                  0055 00662000
         AL    @15,@TF00001                                        0055 00663000
         AL    @15,@CF00252                                        0055 00664000
         TM    SMF74STA-3(@15),B'00000001'                         0055 00665000
         BNO   @RF00055                                            0055 00666000
*                     /***********************************************/ 00667000
*                     /*                                             */ 00668000
*                     /* INSERT 'NOW ONLINE' MACDATE Y-2 73018       */ 00669000
*                     /*                                             */ 00670000
*                     /***********************************************/ 00671000
*                                                                  0056 00672000
*                     CALL MFISRTXT(/* INSERT TEXT ROUTINE           */ 00673000
*                         LNGTPTR(LDPART15)->LNGTXTD,/* TEXT         */ 00674000
*                         LNGTPTR(LDPART15)->LNGTXTL,/* LENGTH       */ 00675000
*                         RDLINE,   /* START LINE                    */ 00676000
*                         COLB-3    /* START COLUMN                  */ 00677000
*                         );                                       0056 00678000
         L     @08,@CA00125                                        0056 00679000
         L     @08,LNGTPTR-IRBMFLDV+56(,@08)                       0056 00680000
         LA    @15,LNGTXTD(,@08)                                   0056 00681000
         ST    @15,@AL00001                                        0056 00682000
         ST    @08,@AL00001+4                                      0056 00683000
         LA    @08,RDLINE                                          0056 00684000
         ST    @08,@AL00001+8                                      0056 00685000
         LA    @08,@CF00243                                        0056 00686000
         ST    @08,@AL00001+12                                     0056 00687000
         L     @08,@PC00001+4                                      0056 00688000
         L     @15,RDVECTAB+8(,@08)                                0056 00689000
         LA    @01,@AL00001                                        0056 00690000
         BALR  @14,@15                                             0056 00691000
*                   ELSE                                           0057 00692000
*                                                                  0057 00693000
*                     /***********************************************/ 00694000
*                     /*                                             */ 00695000
*                     /* INSERT 'NOW OFFLINE' MACDATE Y-2 73018      */ 00696000
*                     /*                                             */ 00697000
*                     /***********************************************/ 00698000
*                                                                  0057 00699000
*                     CALL MFISRTXT(/* INSERT TEXT ROUTINE           */ 00700000
*                         LNGTPTR(LDPART16)->LNGTXTD,/* TEXT         */ 00701000
*                         LNGTPTR(LDPART16)->LNGTXTL,/* LENGTH       */ 00702000
*                         RDLINE,   /* START LINE                    */ 00703000
*                         COLB-4    /* START COLUMN                  */ 00704000
*                         );                                       0057 00705000
         B     @RC00055                                            0057 00706000
@RF00055 L     @08,@CA00125                                        0057 00707000
         L     @08,LNGTPTR-IRBMFLDV+60(,@08)                       0057 00708000
         LA    @15,LNGTXTD(,@08)                                   0057 00709000
         ST    @15,@AL00001                                        0057 00710000
         ST    @08,@AL00001+4                                      0057 00711000
         LA    @08,RDLINE                                          0057 00712000
         ST    @08,@AL00001+8                                      0057 00713000
         LA    @08,@CF00244                                        0057 00714000
         ST    @08,@AL00001+12                                     0057 00715000
         L     @08,@PC00001+4                                      0057 00716000
         L     @15,RDVECTAB+8(,@08)                                0057 00717000
         LA    @01,@AL00001                                        0057 00718000
         BALR  @14,@15                                             0057 00719000
*                 END;                                             0058 00720000
*               ELSE                                               0059 00721000
*                                                                  0059 00722000
*                 /***************************************************/ 00723000
*                 /*                                                 */ 00724000
*                 /* NO CONFIGURATION CHANGE HAS BEEN DETECTED.      */ 00725000
*                 /* INSERT 'OFFLINE' MACDATE Y-2 73018              */ 00726000
*                 /*                                                 */ 00727000
*                 /***************************************************/ 00728000
*                                                                  0059 00729000
*                 CALL MFISRTXT(    /* INSERT TEXT ROUTINE           */ 00730000
*                     LNGTPTR(LDPART17)->LNGTXTD,/* TEXT             */ 00731000
*                     LNGTPTR(LDPART17)->LNGTXTL,/* LENGTH           */ 00732000
*                     RDLINE,       /* START LINE                    */ 00733000
*                     COLB          /* START COLUMN                  */ 00734000
*                     );                                           0059 00735000
         B     @RC00053                                            0059 00736000
@RF00053 L     @08,@CA00125                                        0059 00737000
         L     @08,LNGTPTR-IRBMFLDV+64(,@08)                       0059 00738000
         LA    @15,LNGTXTD(,@08)                                   0059 00739000
         ST    @15,@AL00001                                        0059 00740000
         ST    @08,@AL00001+4                                      0059 00741000
         LA    @08,RDLINE                                          0059 00742000
         ST    @08,@AL00001+8                                      0059 00743000
         LA    @08,@CF00211                                        0059 00744000
         ST    @08,@AL00001+12                                     0059 00745000
         L     @08,@PC00001+4                                      0059 00746000
         L     @15,RDVECTAB+8(,@08)                                0059 00747000
         LA    @01,@AL00001                                        0059 00748000
         BALR  @14,@15                                             0059 00749000
*             END;                                                 0060 00750000
*           ELSE                                                   0061 00751000
*                                                                  0061 00752000
*             /*******************************************************/ 00753000
*             /*                                                     */ 00754000
*             /* DEVICE IS ONLINE AND NO CONFIGURATION CHANGE WAS    */ 00755000
*             /* DETECTED. INSERT DATA                               */ 00756000
*             /*                                                     */ 00757000
*             /*******************************************************/ 00758000
*                                                                  0061 00759000
*             DO;                                                  0061 00760000
*                                                                  0061 00761000
         B     @RC00051                                            0061 00762000
@RF00051 DS    0H                                                  0062 00763000
*               /*****************************************************/ 00764000
*               /*                                                   */ 00765000
*               /* INCREMENT TOTAL SIO COUNT                         */ 00766000
*               /*                                                   */ 00767000
*               /*****************************************************/ 00768000
*                                                                  0062 00769000
*               RDSIOTOT=RDSIOTOT+SMF74CNT(RDDEVIDX);              0062 00770000
*                                                                  0062 00771000
         LH    @08,RDDEVIDX                                        0062 00772000
         MH    @08,@CH00234                                        0062 00773000
         LH    @15,RDCLSIDX                                        0062 00774000
         SLA   @15,2                                               0062 00775000
         L     @14,@PC00001                                        0062 00776000
         L     @01,RDDTAPTR(,@14)                                  0062 00777000
         AL    @01,@CF00249                                        0062 00778000
         L     @15,DDDVADD(@15,@01)                                0062 00779000
         LA    @14,SMF74SIZ(,@15)                                  0062 00780000
         AH    @14,SMF74SIZ(,@15)                                  0062 00781000
         LH    @15,SMF74SDC(,@14)                                  0062 00782000
         AR    @15,@14                                             0062 00783000
         LA    @01,0(@08,@15)                                      0062 00784000
         AL    @01,@CF00253                                        0062 00785000
         L     @14,SMF74CNT-16(,@01)                               0062 00786000
         L     @07,RDSIOTOT                                        0062 00787000
         ALR   @07,@14                                             0062 00788000
         ST    @07,RDSIOTOT                                        0062 00789000
*               /*****************************************************/ 00790000
*               /*                                                   */ 00791000
*               /* INSERT DEVICE ACTIVITY COUNT. IF LT 1,000,000,    */ 00792000
*               /* INSERT AS NN,NNN. IF GE 1,000,000, INSERT AS      */ 00793000
*               /* NNN.NNNM                                          */ 00794000
*               /*                                                   */ 00795000
*               /*****************************************************/ 00796000
*                                                                  0063 00797000
*               IF SMF74CNT(RDDEVIDX)<1000000 THEN                 0063 00798000
         CL    @14,@CF00229                                        0063 00799000
         BNL   @RF00063                                            0063 00800000
*                 DO;                                              0064 00801000
*                                                                  0064 00802000
*                   /*************************************************/ 00803000
*                   /*                                               */ 00804000
*                   /* MACDATE Y-2 73018                             */ 00805000
*                   /*                                               */ 00806000
*                   /*************************************************/ 00807000
*                                                                  0065 00808000
*                   CALL IRBMFCNV(  /* CONVERSION ROUTINE            */ 00809000
*                       SMF74CNT(RDDEVIDX),/* INPUT VALUE            */ 00810000
*                       RDDATSCF,   /* INPUT SCALE                   */ 00811000
*                       RDWRKSTR,   /* OUTPUT STRING                 */ 00812000
*                       RDCOUNTL,   /* OUTPUT LENGTH                 */ 00813000
*                       RDNOPLCE,   /* PLACES RIGHT OF DEC PT        */ 00814000
*                       RDCOMMAS,   /* COMMAS FLAG                   */ 00815000
*                       RDNOFLOT    /* MAX PRECISION FLAG            */ 00816000
*                       );                                         0065 00817000
*                                                                  0065 00818000
         MVC   @AL00001+4(24),@AL00065                             0065 00819000
         AL    @15,@CF00253                                        0065 00820000
         LA    @08,SMF74CNT-16(@08,@15)                            0065 00821000
         ST    @08,@AL00001                                        0065 00822000
         LA    @08,RDWRKSTR                                        0065 00823000
         ST    @08,@AL00001+8                                      0065 00824000
         L     @08,@PC00001+4                                      0065 00825000
         L     @15,RDVECTAB(,@08)                                  0065 00826000
         LA    @01,@AL00001                                        0065 00827000
         BALR  @14,@15                                             0065 00828000
*                   /*************************************************/ 00829000
*                   /*                                               */ 00830000
*                   /* MACDATE Y-2 73018                             */ 00831000
*                   /*                                               */ 00832000
*                   /*************************************************/ 00833000
*                                                                  0066 00834000
*                   CALL MFISRTXT(  /* INSERT TEXT ROUTINE           */ 00835000
*                       RDWRKSTR,   /* TEXT                          */ 00836000
*                       RDCOUNTL,   /* LENGTH                        */ 00837000
*                       RDLINE,     /* START LINE                    */ 00838000
*                       COLB        /* START COLUMN                  */ 00839000
*                       );                                         0066 00840000
         LA    @08,RDWRKSTR                                        0066 00841000
         ST    @08,@AL00001                                        0066 00842000
         LA    @08,@CF00138                                        0066 00843000
         ST    @08,@AL00001+4                                      0066 00844000
         LA    @08,RDLINE                                          0066 00845000
         ST    @08,@AL00001+8                                      0066 00846000
         LA    @08,@CF00211                                        0066 00847000
         ST    @08,@AL00001+12                                     0066 00848000
         L     @08,@PC00001+4                                      0066 00849000
         L     @15,RDVECTAB+8(,@08)                                0066 00850000
         LA    @01,@AL00001                                        0066 00851000
         BALR  @14,@15                                             0066 00852000
*                 END;                                             0067 00853000
*               ELSE                                               0068 00854000
*                 DO;                                              0068 00855000
*                                                                  0068 00856000
         B     @RC00063                                            0068 00857000
@RF00063 DS    0H                                                  0069 00858000
*                   /*************************************************/ 00859000
*                   /*                                               */ 00860000
*                   /* MACDATE Y-2 73018                             */ 00861000
*                   /*                                               */ 00862000
*                   /*************************************************/ 00863000
*                                                                  0069 00864000
*                   CALL IRBMFCNV(  /* CONVERSION ROUTINE            */ 00865000
*                       SMF74CNT(RDDEVIDX),/* INPUT VALUE            */ 00866000
*                       RDMILSCF,   /* INPUT SCALE                   */ 00867000
*                       RDWRKSTR,   /* OUTPUT STRING                 */ 00868000
*                       RDCOUNTL,   /* OUTPUT LENGTH                 */ 00869000
*                       RDDECMIL,   /* PLACES RIGHT OF DEC PT        */ 00870000
*                       RDNOCOMA,   /* COMMAS FLAG                   */ 00871000
*                       RDNOFLOT    /* MAX PRECISION FLAG            */ 00872000
*                       );                                         0069 00873000
         MVC   @AL00001+4(24),@AL00069                             0069 00874000
         LH    @08,RDDEVIDX                                        0069 00875000
         MH    @08,@CH00234                                        0069 00876000
         LH    @15,RDCLSIDX                                        0069 00877000
         SLA   @15,2                                               0069 00878000
         L     @14,@PC00001                                        0069 00879000
         L     @01,RDDTAPTR(,@14)                                  0069 00880000
         AL    @01,@CF00249                                        0069 00881000
         L     @15,DDDVADD(@15,@01)                                0069 00882000
         LA    @14,SMF74SIZ(,@15)                                  0069 00883000
         AH    @14,SMF74SIZ(,@15)                                  0069 00884000
         LH    @15,SMF74SDC(,@14)                                  0069 00885000
         AR    @15,@14                                             0069 00886000
         AL    @15,@CF00253                                        0069 00887000
         LA    @08,SMF74CNT-16(@08,@15)                            0069 00888000
         ST    @08,@AL00001                                        0069 00889000
         LA    @08,RDWRKSTR                                        0069 00890000
         ST    @08,@AL00001+8                                      0069 00891000
         L     @08,@PC00001+4                                      0069 00892000
         L     @15,RDVECTAB(,@08)                                  0069 00893000
         LA    @01,@AL00001                                        0069 00894000
         BALR  @14,@15                                             0069 00895000
*                   RDWRKSTR(8)='M';/* MILLIONS                      */ 00896000
*                                                                  0070 00897000
         MVI   RDWRKSTR+7,C'M'                                     0070 00898000
*                   /*************************************************/ 00899000
*                   /*                                               */ 00900000
*                   /* MACDATE Y-2 73018                             */ 00901000
*                   /*                                               */ 00902000
*                   /*************************************************/ 00903000
*                                                                  0071 00904000
*                   CALL MFISRTXT(  /* INSERT TEXT ROUTINE           */ 00905000
*                       RDWRKSTR,   /* TEXT                          */ 00906000
*                       RDCOUNTL+1, /* LENGTH                        */ 00907000
*                       RDLINE,     /* START LINE                    */ 00908000
*                       COLB        /* START COLUMN                  */ 00909000
*                       );                                         0071 00910000
         LA    @08,RDWRKSTR                                        0071 00911000
         ST    @08,@AL00001                                        0071 00912000
         LA    @08,@CF00054                                        0071 00913000
         ST    @08,@AL00001+4                                      0071 00914000
         LA    @08,RDLINE                                          0071 00915000
         ST    @08,@AL00001+8                                      0071 00916000
         LA    @08,@CF00211                                        0071 00917000
         ST    @08,@AL00001+12                                     0071 00918000
         L     @08,@PC00001+4                                      0071 00919000
         L     @15,RDVECTAB+8(,@08)                                0071 00920000
         LA    @01,@AL00001                                        0071 00921000
         BALR  @14,@15                                             0071 00922000
*                 END;                                             0072 00923000
*                                                                  0072 00924000
*               /*****************************************************/ 00925000
*               /*                                                   */ 00926000
*               /* INSERT PERCENT BUSY IF DIVISOR IS NOT ZERO        */ 00927000
*               /*                                                   */ 00928000
*               /*****************************************************/ 00929000
*                                                                  0073 00930000
*               IF SMF74SAM^=RDDVZERO THEN                         0073 00931000
@RC00063 LH    @08,RDCLSIDX                                        0073 00932000
         SLA   @08,2                                               0073 00933000
         L     @15,@PC00001                                        0073 00934000
         L     @01,RDDTAPTR(,@15)                                  0073 00935000
         AL    @01,@CF00249                                        0073 00936000
         L     @08,DDDVADD(@08,@01)                                0073 00937000
         L     @15,SMF74SAM(,@08)                                  0073 00938000
         LTR   @15,@15                                             0073 00939000
         BZ    @RF00073                                            0073 00940000
*                 DO;                                              0074 00941000
*                                                                  0074 00942000
*                   /*************************************************/ 00943000
*                   /*                                               */ 00944000
*                   /* CALCULATE (SMF74ACT(RDDEVIDX)*100000)         */ 00945000
*                   /* /SMF74SAM) MACDATE Y-2 73018                  */ 00946000
*                   /*                                               */ 00947000
*                   /*************************************************/ 00948000
*                                                                  0075 00949000
*                   RESPECIFY                                      0075 00950000
*                    (GPR00P,                                      0075 00951000
*                     GPR01P,                                      0075 00952000
*                     GPR14P,                                      0075 00953000
*                     GPR15P)RESTRICTED;                           0075 00954000
*                   GPR01F=SMF74ACT(RDDEVIDX);/* LARGE VALUE TO REG  */ 00955000
         ST    @15,@TF00001                                        0076 00956000
         LH    @07,RDDEVIDX                                        0076 00957000
         MH    @07,@CH00234                                        0076 00958000
         LA    @06,SMF74SIZ(,@08)                                  0076 00959000
         AH    @06,SMF74SIZ(,@08)                                  0076 00960000
         LH    @08,SMF74SDC(,@06)                                  0076 00961000
         AR    @08,@06                                             0076 00962000
         AL    @08,@CF00254                                        0076 00963000
         L     GPR01F,SMF74ACT-20(@07,@08)                         0076 00964000
*                   GPR15F=SMF74SAM;/* DENOMINATOR TO REGISTER       */ 00965000
         L     GPR15F,@TF00001                                     0077 00966000
*                   GENERATE REFS(C100000);                        0078 00967000
*                                                                  0078 00968000
        M     GPR00F,C100000       MAY SPILL TO DOUBLE WORD             00969000
        DR    GPR00F,GPR15F        RESULT FITS IN SINGLE WORD           00970000
*                   /*************************************************/ 00971000
*                   /*                                               */ 00972000
*                   /* MACDATE Y-2 73018                             */ 00973000
*                   /*                                               */ 00974000
*                   /*************************************************/ 00975000
*                                                                  0079 00976000
*                   CALL IRBMFCNV(  /* CONVERSION ROUTINE            */ 00977000
*                       EVAL(GPR01F),/* INPUT VALUE                  */ 00978000
*                       RDTHOSCF,   /* INPUT SCALE                   */ 00979000
*                       RDWRKSTR,   /* OUTPUT STRING                 */ 00980000
*                       RDPCTLEN,   /* OUTPUT LENGTH                 */ 00981000
*                       RDPCTPLC,   /* PLACES RIGHT OF DEC PT        */ 00982000
*                       RDNOCOMA,   /* COMMAS FLAG                   */ 00983000
*                       RDNOFLOT    /* MAX PRECISION FLAG            */ 00984000
*                       );                                         0079 00985000
*                                                                  0079 00986000
         MVC   @AL00001+4(24),@AL00079                             0079 00987000
         ST    GPR01F,@AFTEMPS                                     0079 00988000
         LA    @08,@AFTEMPS                                        0079 00989000
         ST    @08,@AL00001                                        0079 00990000
         LA    @08,RDWRKSTR                                        0079 00991000
         ST    @08,@AL00001+8                                      0079 00992000
         L     @08,@PC00001+4                                      0079 00993000
         L     @15,RDVECTAB(,@08)                                  0079 00994000
         LA    @01,@AL00001                                        0079 00995000
         BALR  @14,@15                                             0079 00996000
*                   /*************************************************/ 00997000
*                   /*                                               */ 00998000
*                   /* MACDATE Y-2 73018                             */ 00999000
*                   /*                                               */ 01000000
*                   /*************************************************/ 01001000
*                                                                  0080 01002000
*                   RESPECIFY                                      0080 01003000
*                    (GPR00P,                                      0080 01004000
*                     GPR01P,                                      0080 01005000
*                     GPR14P,                                      0080 01006000
*                     GPR15P)UNRESTRICTED;                         0080 01007000
*                 END;                                             0081 01008000
*               ELSE                                               0082 01009000
*                 RDWRKSTR(1:5)=LNGTPTR(LDPART19)->LNGTXTD(1:LNGTPTR(   01010000
*                     LDPART19)->LNGTXTL);                         0082 01011000
*                                                                  0082 01012000
         B     @RC00073                                            0082 01013000
@RF00073 MVI   RDWRKSTR+1,C' '                                     0082 01014000
         MVC   RDWRKSTR+2(3),RDWRKSTR+1                            0082 01015000
         L     @08,@CA00125                                        0082 01016000
         L     @08,LNGTPTR-IRBMFLDV+72(,@08)                       0082 01017000
         L     @15,LNGTXTL(,@08)                                   0082 01018000
         BCTR  @15,0                                               0082 01019000
         EX    @15,@SM00255                                        0082 01020000
*               /*****************************************************/ 01021000
*               /*                                                   */ 01022000
*               /* MACDATE Y-2 73018                                 */ 01023000
*               /*                                                   */ 01024000
*               /*****************************************************/ 01025000
*                                                                  0083 01026000
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */ 01027000
*                   RDWRKSTR,       /* TEXT                          */ 01028000
*                   RDPCTLEN,       /* LENGTH                        */ 01029000
*                   RDLINE,         /* START LINE                    */ 01030000
*                   COLC            /* START COLUMN                  */ 01031000
*                   );                                             0083 01032000
*                                                                  0083 01033000
@RC00073 LA    @08,RDWRKSTR                                        0083 01034000
         ST    @08,@AL00001                                        0083 01035000
         LA    @08,@CF00135                                        0083 01036000
         ST    @08,@AL00001+4                                      0083 01037000
         LA    @08,RDLINE                                          0083 01038000
         ST    @08,@AL00001+8                                      0083 01039000
         LA    @08,@CF00213                                        0083 01040000
         ST    @08,@AL00001+12                                     0083 01041000
         L     @08,@PC00001+4                                      0083 01042000
         L     @15,RDVECTAB+8(,@08)                                0083 01043000
         LA    @01,@AL00001                                        0083 01044000
         BALR  @14,@15                                             0083 01045000
*               /*****************************************************/ 01046000
*               /*                                                   */ 01047000
*               /* INSERT MEAN QLENGTH IF DIVISOR IS NOT ZERO        */ 01048000
*               /*                                                   */ 01049000
*               /*****************************************************/ 01050000
*                                                                  0084 01051000
*               IF SMF74SAM^=RDDVZERO THEN                         0084 01052000
         LH    @08,RDCLSIDX                                        0084 01053000
         SLA   @08,2                                               0084 01054000
         L     @15,@PC00001                                        0084 01055000
         L     @01,RDDTAPTR(,@15)                                  0084 01056000
         AL    @01,@CF00249                                        0084 01057000
         L     @08,DDDVADD(@08,@01)                                0084 01058000
         L     @15,SMF74SAM(,@08)                                  0084 01059000
         LTR   @15,@15                                             0084 01060000
         BZ    @RF00084                                            0084 01061000
*                 DO;                                              0085 01062000
*                                                                  0085 01063000
*                   /*************************************************/ 01064000
*                   /*                                               */ 01065000
*                   /* CALCULATE (SMF74QUE(RDDEVIDX)*1000) /SMF74SAM)*/ 01066000
*                   /* MACDATE Y-2 73018                             */ 01067000
*                   /*                                               */ 01068000
*                   /*************************************************/ 01069000
*                                                                  0086 01070000
*                   RESPECIFY                                      0086 01071000
*                    (GPR00P,                                      0086 01072000
*                     GPR01P,                                      0086 01073000
*                     GPR14P,                                      0086 01074000
*                     GPR15P)RESTRICTED;                           0086 01075000
*                   GPR01F=SMF74QUE(RDDEVIDX);/* LARGE VALUE TO REG  */ 01076000
         ST    @15,@TF00001                                        0087 01077000
         LH    @07,RDDEVIDX                                        0087 01078000
         MH    @07,@CH00234                                        0087 01079000
         LA    @06,SMF74SIZ(,@08)                                  0087 01080000
         AH    @06,SMF74SIZ(,@08)                                  0087 01081000
         LH    @08,SMF74SDC(,@06)                                  0087 01082000
         AR    @08,@06                                             0087 01083000
         AL    @08,@CF00249                                        0087 01084000
         L     GPR01F,SMF74QUE-24(@07,@08)                         0087 01085000
*                   GPR15F=SMF74SAM;/* DENOMINATOR TO REGISTER       */ 01086000
         L     GPR15F,@TF00001                                     0088 01087000
*                   GENERATE REFS(C1000);                          0089 01088000
*                                                                  0089 01089000
        M     GPR00F,C1000         MAY SPILL TO DOUBLE WORD             01090000
        DR    GPR00F,GPR15F        RESULT FITS IN SINGLE WORD           01091000
*                   /*************************************************/ 01092000
*                   /*                                               */ 01093000
*                   /* MACDATE Y-2 73018                             */ 01094000
*                   /*                                               */ 01095000
*                   /*************************************************/ 01096000
*                                                                  0090 01097000
*                   CALL IRBMFCNV(  /* CONVERSION ROUTINE            */ 01098000
*                       EVAL(GPR01F),/* INPUT VALUE                  */ 01099000
*                       RDTHOSCF,   /* INPUT SCALE                   */ 01100000
*                       RDWRKSTR,   /* OUTPUT STRING                 */ 01101000
*                       RDPCTLEN,   /* OUTPUT LENGTH                 */ 01102000
*                       RDPCTPLC,   /* PLACES RIGHT OF DEC PT        */ 01103000
*                       RDNOCOMA,   /* COMMAS FLAG                   */ 01104000
*                       RDNOFLOT    /* MAX PRECISION FLAG            */ 01105000
*                       );                                         0090 01106000
*                                                                  0090 01107000
         MVC   @AL00001+4(24),@AL00090                             0090 01108000
         ST    GPR01F,@AFTEMPS                                     0090 01109000
         LA    @08,@AFTEMPS                                        0090 01110000
         ST    @08,@AL00001                                        0090 01111000
         LA    @08,RDWRKSTR                                        0090 01112000
         ST    @08,@AL00001+8                                      0090 01113000
         L     @08,@PC00001+4                                      0090 01114000
         L     @15,RDVECTAB(,@08)                                  0090 01115000
         LA    @01,@AL00001                                        0090 01116000
         BALR  @14,@15                                             0090 01117000
*                   /*************************************************/ 01118000
*                   /*                                               */ 01119000
*                   /* MACDATE Y-2 73018                             */ 01120000
*                   /*                                               */ 01121000
*                   /*************************************************/ 01122000
*                                                                  0091 01123000
*                   RESPECIFY                                      0091 01124000
*                    (GPR00P,                                      0091 01125000
*                     GPR01P,                                      0091 01126000
*                     GPR14P,                                      0091 01127000
*                     GPR15P)UNRESTRICTED;                         0091 01128000
*                 END;                                             0092 01129000
*               ELSE                                               0093 01130000
*                 RDWRKSTR(1:5)=LNGTPTR(LDPART19)->LNGTXTD(1:LNGTPTR(   01131000
*                     LDPART19)->LNGTXTL);                         0093 01132000
*                                                                  0093 01133000
         B     @RC00084                                            0093 01134000
@RF00084 MVI   RDWRKSTR+1,C' '                                     0093 01135000
         MVC   RDWRKSTR+2(3),RDWRKSTR+1                            0093 01136000
         L     @08,@CA00125                                        0093 01137000
         L     @08,LNGTPTR-IRBMFLDV+72(,@08)                       0093 01138000
         L     @15,LNGTXTL(,@08)                                   0093 01139000
         BCTR  @15,0                                               0093 01140000
         EX    @15,@SM00255                                        0093 01141000
*               /*****************************************************/ 01142000
*               /*                                                   */ 01143000
*               /* MACDATE Y-2 73018                                 */ 01144000
*               /*                                                   */ 01145000
*               /*****************************************************/ 01146000
*                                                                  0094 01147000
*               CALL MFISRTXT(      /* INSERT TEXT ROUTINE           */ 01148000
*                   RDWRKSTR,       /* TEXT                          */ 01149000
*                   RDPCTLEN,       /* LENGTH                        */ 01150000
*                   RDLINE,         /* START LINE                    */ 01151000
*                   COLD            /* START COLUMN                  */ 01152000
*                   );                                             0094 01153000
@RC00084 LA    @08,RDWRKSTR                                        0094 01154000
         ST    @08,@AL00001                                        0094 01155000
         LA    @08,@CF00135                                        0094 01156000
         ST    @08,@AL00001+4                                      0094 01157000
         LA    @08,RDLINE                                          0094 01158000
         ST    @08,@AL00001+8                                      0094 01159000
         LA    @08,@CF00095                                        0094 01160000
         ST    @08,@AL00001+12                                     0094 01161000
         L     @08,@PC00001+4                                      0094 01162000
         L     @15,RDVECTAB+8(,@08)                                0094 01163000
         LA    @01,@AL00001                                        0094 01164000
         BALR  @14,@15                                             0094 01165000
*             END;                                                 0095 01166000
*           RDLINE=RDLINE+1;        /* INCREMENT LINE NUMBER         */ 01167000
@RC00051 LA    @08,1                                               0096 01168000
         A     @08,RDLINE                                          0096 01169000
         ST    @08,RDLINE                                          0096 01170000
*         END;                                                     0097 01171000
*                                                                  0097 01172000
         LA    @08,1                                               0097 01173000
         AH    @08,RDDEVIDX                                        0097 01174000
@DE00020 STH   @08,RDDEVIDX                                        0097 01175000
         LH    @15,RDCLSIDX                                        0097 01176000
         SLA   @15,2                                               0097 01177000
         L     @14,@PC00001                                        0097 01178000
         L     @01,RDDTAPTR(,@14)                                  0097 01179000
         AL    @01,@CF00249                                        0097 01180000
         L     @01,DDDVADD(@15,@01)                                0097 01181000
         LA    @15,SMF74SIZ(,@01)                                  0097 01182000
         LH    @14,RDCLSIDX                                        0097 01183000
         SLA   @14,2                                               0097 01184000
         L     @07,@PC00001                                        0097 01185000
         L     @01,RDDTAPTR(,@07)                                  0097 01186000
         AL    @01,@CF00249                                        0097 01187000
         L     @01,DDDVADD(@14,@01)                                0097 01188000
         AH    @15,SMF74SIZ(,@01)                                  0097 01189000
         CH    @08,SMF74DEV(,@15)                                  0097 01190000
         BNH   @DL00020                                            0097 01191000
*         /***********************************************************/ 01192000
*         /*                                                         */ 01193000
*         /* FINISHED WITH ALL DEVICES IN CLASS. INSERT TOTAL SIO AND*/ 01194000
*         /* WRITE OUT PAGE                                          */ 01195000
*         /*                                                         */ 01196000
*         /***********************************************************/ 01197000
*                                                                  0098 01198000
*         RDLINE=RDLINE+1;          /* ONE BLANK LINE                */ 01199000
*                                                                  0098 01200000
         LA    @08,1                                               0098 01201000
         A     @08,RDLINE                                          0098 01202000
         ST    @08,RDLINE                                          0098 01203000
*         /***********************************************************/ 01204000
*         /*                                                         */ 01205000
*         /* INSERT 'TOTAL' MACDATE Y-2 73018                        */ 01206000
*         /*                                                         */ 01207000
*         /***********************************************************/ 01208000
*                                                                  0099 01209000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 01210000
*             LNGTPTR(LDPART18)->LNGTXTD,/* TEXT                     */ 01211000
*             LNGTPTR(LDPART18)->LNGTXTL,/* LENGTH                   */ 01212000
*             RDLINE,               /* START LINE                    */ 01213000
*             COLA                  /* START COLUMN                  */ 01214000
*             );                                                   0099 01215000
*                                                                  0099 01216000
         L     @08,@CA00125                                        0099 01217000
         L     @08,LNGTPTR-IRBMFLDV+68(,@08)                       0099 01218000
         LA    @15,LNGTXTD(,@08)                                   0099 01219000
         ST    @15,@AL00001                                        0099 01220000
         ST    @08,@AL00001+4                                      0099 01221000
         LA    @08,RDLINE                                          0099 01222000
         ST    @08,@AL00001+8                                      0099 01223000
         LA    @08,@CF00081                                        0099 01224000
         ST    @08,@AL00001+12                                     0099 01225000
         L     @08,@PC00001+4                                      0099 01226000
         L     @15,RDVECTAB+8(,@08)                                0099 01227000
         LA    @01,@AL00001                                        0099 01228000
         BALR  @14,@15                                             0099 01229000
*         /***********************************************************/ 01230000
*         /*                                                         */ 01231000
*         /* INSERT TOTAL DEVICE ACTIVITY. IF LT 1,000,000, INSERT AS*/ 01232000
*         /* NNN,NNN. IF GE 1,000,000, INSERT AS N,NNN,NNN.NNNM      */ 01233000
*         /*                                                         */ 01234000
*         /***********************************************************/ 01235000
*                                                                  0100 01236000
*         IF RDSIOTOT<1000000 THEN                                 0100 01237000
         L     @08,RDSIOTOT                                        0100 01238000
         C     @08,@CF00229                                        0100 01239000
         BNL   @RF00100                                            0100 01240000
*           DO;                                                    0101 01241000
*                                                                  0101 01242000
*             /*******************************************************/ 01243000
*             /*                                                     */ 01244000
*             /* MACDATE Y-2 73018                                   */ 01245000
*             /*                                                     */ 01246000
*             /*******************************************************/ 01247000
*                                                                  0102 01248000
*             CALL IRBMFCNV(        /* CONVERSION ROUTINE            */ 01249000
*                 RDSIOTOT,         /* INPUT VALUE                   */ 01250000
*                 RDDATSCF,         /* INPUT SCALE                   */ 01251000
*                 RDWRKSTR,         /* OUTPUT STRING                 */ 01252000
*                 RDCOUNTL,         /* OUTPUT LENGTH                 */ 01253000
*                 RDNOPLCE,         /* PLACES RIGHT OF DEC PT        */ 01254000
*                 RDCOMMAS,         /* COMMAS FLAG                   */ 01255000
*                 RDNOFLOT          /* MAX PRECISION FLAG            */ 01256000
*                 );                                               0102 01257000
*                                                                  0102 01258000
         MVC   @AL00001+4(24),@AL00102                             0102 01259000
         LA    @08,RDSIOTOT                                        0102 01260000
         ST    @08,@AL00001                                        0102 01261000
         LA    @08,RDWRKSTR                                        0102 01262000
         ST    @08,@AL00001+8                                      0102 01263000
         L     @08,@PC00001+4                                      0102 01264000
         L     @15,RDVECTAB(,@08)                                  0102 01265000
         LA    @01,@AL00001                                        0102 01266000
         BALR  @14,@15                                             0102 01267000
*             /*******************************************************/ 01268000
*             /*                                                     */ 01269000
*             /* MACDATE Y-2 73018                                   */ 01270000
*             /*                                                     */ 01271000
*             /*******************************************************/ 01272000
*                                                                  0103 01273000
*             CALL MFISRTXT(        /* INSERT TEXT ROUTINE           */ 01274000
*                 RDWRKSTR,         /* TEXT                          */ 01275000
*                 RDCOUNTL,         /* LENGTH                        */ 01276000
*                 RDLINE,           /* START LINE                    */ 01277000
*                 COLB              /* START COLUMN                  */ 01278000
*                 );                                               0103 01279000
         LA    @08,RDWRKSTR                                        0103 01280000
         ST    @08,@AL00001                                        0103 01281000
         LA    @08,@CF00138                                        0103 01282000
         ST    @08,@AL00001+4                                      0103 01283000
         LA    @08,RDLINE                                          0103 01284000
         ST    @08,@AL00001+8                                      0103 01285000
         LA    @08,@CF00211                                        0103 01286000
         ST    @08,@AL00001+12                                     0103 01287000
         L     @08,@PC00001+4                                      0103 01288000
         L     @15,RDVECTAB+8(,@08)                                0103 01289000
         LA    @01,@AL00001                                        0103 01290000
         BALR  @14,@15                                             0103 01291000
*           END;                                                   0104 01292000
*         ELSE                                                     0105 01293000
*           DO;                                                    0105 01294000
*                                                                  0105 01295000
         B     @RC00100                                            0105 01296000
@RF00100 DS    0H                                                  0106 01297000
*             /*******************************************************/ 01298000
*             /*                                                     */ 01299000
*             /* MACDATE Y-2 73018                                   */ 01300000
*             /*                                                     */ 01301000
*             /*******************************************************/ 01302000
*                                                                  0106 01303000
*             CALL IRBMFCNV(        /* CONVERSION ROUTINE            */ 01304000
*                 RDSIOTOT,         /* INPUT VALUE                   */ 01305000
*                 RDMILSCF,         /* INPUT SCALE                   */ 01306000
*                 RDWRKSTR,         /* OUTPUT STRING                 */ 01307000
*                 RDCOUNTM,         /* OUTPUT LENGTH                 */ 01308000
*                 RDDECMIL,         /* PLACES RIGHT OF DEC PT        */ 01309000
*                 RDCOMMAS,         /* COMMAS FLAG                   */ 01310000
*                 RDNOFLOT          /* MAX PRECISION FLAG            */ 01311000
*                 );                                               0106 01312000
         MVC   @AL00001+4(24),@AL00106                             0106 01313000
         LA    @08,RDSIOTOT                                        0106 01314000
         ST    @08,@AL00001                                        0106 01315000
         LA    @08,RDWRKSTR                                        0106 01316000
         ST    @08,@AL00001+8                                      0106 01317000
         L     @08,@PC00001+4                                      0106 01318000
         L     @15,RDVECTAB(,@08)                                  0106 01319000
         LA    @01,@AL00001                                        0106 01320000
         BALR  @14,@15                                             0106 01321000
*             RDWRKSTR(14)='M';     /* MILLIONS                      */ 01322000
*                                                                  0107 01323000
         MVI   RDWRKSTR+13,C'M'                                    0107 01324000
*             /*******************************************************/ 01325000
*             /*                                                     */ 01326000
*             /* MACDATE Y-2 73018                                   */ 01327000
*             /*                                                     */ 01328000
*             /*******************************************************/ 01329000
*                                                                  0108 01330000
*             CALL MFISRTXT(        /* INSERT TEXT ROUTINE           */ 01331000
*                 RDWRKSTR,         /* TEXT                          */ 01332000
*                 RDCOUNTM+1,       /* LENGTH                        */ 01333000
*                 RDLINE,           /* START LINE                    */ 01334000
*                 COLB+RDMILSCF     /* START COLUMN                  */ 01335000
*                 );                                               0108 01336000
         LA    @08,RDWRKSTR                                        0108 01337000
         ST    @08,@AL00001                                        0108 01338000
         LA    @08,@CF00150                                        0108 01339000
         ST    @08,@AL00001+4                                      0108 01340000
         LA    @08,RDLINE                                          0108 01341000
         ST    @08,@AL00001+8                                      0108 01342000
         LA    @08,@CF00233                                        0108 01343000
         ST    @08,@AL00001+12                                     0108 01344000
         L     @08,@PC00001+4                                      0108 01345000
         L     @15,RDVECTAB+8(,@08)                                0108 01346000
         LA    @01,@AL00001                                        0108 01347000
         BALR  @14,@15                                             0108 01348000
*           END;                                                   0109 01349000
*                                                                  0109 01350000
*         /***********************************************************/ 01351000
*         /*                                                         */ 01352000
*         /* WRITE OUT PAGE                                          */ 01353000
*         /*                                                         */ 01354000
*         /***********************************************************/ 01355000
*                                                                  0110 01356000
*         CALL MFWRTPAG;                                           0110 01357000
@RC00100 L     @08,@PC00001+4                                      0110 01358000
         L     @15,RDVECTAB+12(,@08)                               0110 01359000
         BALR  @14,@15                                             0110 01360000
*       END;                                                       0111 01361000
*   END;                                                           0112 01362000
@RF00015 LA    @08,1                                               0112 01363000
         AH    @08,RDCLSIDX                                        0112 01364000
         STH   @08,RDCLSIDX                                        0112 01365000
         CH    @08,@CH00047                                        0112 01366000
         BNH   @DL00014                                            0112 01367000
*   RETURN;                         /* RETURN TO CALLER              */ 01368000
@EL00001 L     @13,4(,@13)                                         0113 01369000
@EF00001 L     @00,@SIZDATD                                        0113 01370000
         LR    @01,@09                                             0113 01371000
         FREEMAIN R,LV=(0),A=(1)                                        01372000
@ER00001 LM    @14,@12,12(@13)                                     0113 01373000
         BR    @14                                                 0113 01374000
*   END                                                            0114 01375000
*                                                                  0114 01376000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01377000
*/*%INCLUDE SYSLIB  (IFASMFR )                                       */ 01378000
*/*%INCLUDE SYSLIB  (IRBRGCON)                                       */ 01379000
*/*%INCLUDE SYSLIB  (IRBMFLDM)                                       */ 01380000
*                                                                  0114 01381000
*       ;                                                          0114 01382000
@DATA    DS    0H                                                       01383000
@CH00234 DC    H'28'                                                    01384000
@CH00232 DC    H'57'                                                    01385000
@CH00171 DC    XL1'0'                                                   01386000
         DC    C'0'                                                     01387000
@SM00255 MVC   RDWRKSTR(0),LNGTXTD(@08)                                 01388000
         DS    0F                                                       01389000
@AL00065 EQU   *                       LIST WITH   6 ARGUMENT(S)        01390000
@AL00102 DC    A(@CF00197)             LIST WITH   6 ARGUMENT(S)        01391000
         DS    F                                                        01392000
         DC    A(@CF00138)                                              01393000
         DC    A(@CF00197)                                              01394000
         DC    A(@CB00191)                                              01395000
         DC    A(@CB00193)                                              01396000
@AL00069 DC    A(@CF00202)             LIST WITH   6 ARGUMENT(S)        01397000
         DS    F                                                        01398000
         DC    A(@CF00138)                                              01399000
         DC    A(@CF00107)                                              01400000
         DC    A(@CB00193)                                              01401000
         DC    A(@CB00193)                                              01402000
@AL00079 EQU   *                       LIST WITH   6 ARGUMENT(S)        01403000
@AL00090 DC    A(@CF00207)             LIST WITH   6 ARGUMENT(S)        01404000
         DS    F                                                        01405000
         DC    A(@CF00135)                                              01406000
         DC    A(@CF00065)                                              01407000
         DC    A(@CB00193)                                              01408000
         DC    A(@CB00193)                                              01409000
@AL00106 DC    A(@CF00202)             LIST WITH   6 ARGUMENT(S)        01410000
         DS    F                                                        01411000
         DC    A(@CF00097)                                              01412000
         DC    A(@CF00107)                                              01413000
         DC    A(@CB00191)                                              01414000
         DC    A(@CB00193)                                              01415000
@DATD    DSECT                                                          01416000
         DS    0F                                                       01417000
@SA00001 DS    18F                                                      01418000
@PC00001 DS    3F                                                       01419000
@AL00001 DS    7A                                                       01420000
@TF00001 DS    F                                                        01421000
@AFTEMPS DS    1F                                                       01422000
IRBMFRDR CSECT                                                          01423000
         DS    0F                                                       01424000
@CF00250 DC    F'-28'                                                   01425000
@CF00252 DC    F'-25'                                                   01426000
@CF00251 DC    F'-20'                                                   01427000
@CF00253 DC    F'-12'                                                   01428000
@CF00254 DC    F'-8'                                                    01429000
@CF00202 DC    F'-6'                                                    01430000
@CF00249 DC    F'-4'                                                    01431000
@CF00207 DC    F'-3'                                                    01432000
@CF00197 DC    F'0'                                                     01433000
@CF00081 DC    F'1'                                                     01434000
@CH00081 EQU   @CF00081+2                                               01435000
@CF00065 DC    F'2'                                                     01436000
@CF00107 DC    F'3'                                                     01437000
@CF00058 DC    F'4'                                                     01438000
@CF00135 DC    F'5'                                                     01439000
@CF00047 DC    F'6'                                                     01440000
@CH00047 EQU   @CF00047+2                                               01441000
@CF00138 DC    F'7'                                                     01442000
@CF00054 DC    F'8'                                                     01443000
@CF00141 DC    F'9'                                                     01444000
@CF00097 DC    F'13'                                                    01445000
@CF00150 DC    F'14'                                                    01446000
@CF00051 DC    F'15'                                                    01447000
@CF00233 DC    F'24'                                                    01448000
@CF00244 DC    F'26'                                                    01449000
@CF00243 DC    F'27'                                                    01450000
@CF00211 DC    F'30'                                                    01451000
@CF00213 DC    F'45'                                                    01452000
@CF00095 DC    F'60'                                                    01453000
@CF00229 DC    F'1000000'                                               01454000
@DATD    DSECT                                                          01455000
         DS    0D                                                       01456000
RDPAGE   DS    F                                                        01457000
RDLINE   DS    F                                                        01458000
RDSIOTOT DS    F                                                        01459000
RDCLSIDX DS    H                                                        01460000
RDDEVIDX DS    H                                                        01461000
RDPACKAD DS    CL3                                                      01462000
RDWRKSTR DS    CL14                                                     01463000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01464000
@ENDDATD EQU   *                                                        01465000
IRBMFRDR CSECT                                                          01466000
         DS    0F                                                       01467000
@SIZDATD DC    AL1(0)                                                   01468000
         DC    AL3(@ENDDATD-@DATD)                                      01469000
@CA00125 DC    A(IRBMFLDV)                                              01470000
         DS    0D                                                       01471000
C100000  DC    F'100000'                                                01472000
C1000    DC    F'1000'                                                  01473000
@CB00191 DC    B'10000000'                                              01474000
@CB00193 DC    B'00000000'                                              01475000
RDDTRTAB DC    CL16'0123456789ABCDEF'                                   01476000
RDPATCH  DS    CL200                                                    01477000
RDTPART  DC    H'1'                                                     01478000
         DC    H'2'                                                     01479000
         DC    H'3'                                                     01480000
         DC    H'4'                                                     01481000
         DC    H'5'                                                     01482000
         DC    H'6'                                                     01483000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01484000
@01      EQU   01                                                       01485000
@02      EQU   02                                                       01486000
@03      EQU   03                                                       01487000
@04      EQU   04                                                       01488000
@05      EQU   05                                                       01489000
@06      EQU   06                                                       01490000
@07      EQU   07                                                       01491000
@08      EQU   08                                                       01492000
@09      EQU   09                                                       01493000
@10      EQU   10                                                       01494000
@11      EQU   11                                                       01495000
@12      EQU   12                                                       01496000
@13      EQU   13                                                       01497000
@14      EQU   14                                                       01498000
@15      EQU   15                                                       01499000
GPR01F   EQU   @01                                                      01500000
GPR15F   EQU   @15                                                      01501000
GPR00P   EQU   @00                                                      01502000
GPR01P   EQU   @01                                                      01503000
GPR14P   EQU   @14                                                      01504000
GPR15P   EQU   @15                                                      01505000
GPR11P   EQU   @11                                                      01506000
GPR12P   EQU   @12                                                      01507000
GPR00F   EQU   @00                                                      01508000
GPR14F   EQU   @14                                                      01509000
         EXTRN IRBMFLDV                                                 01510000
DDDVT    EQU   0                                                        01511000
SMFRCD74 EQU   0                                                        01512000
SMF74SIZ EQU   SMFRCD74+18                                              01513000
SMF74SUB EQU   SMFRCD74+34                                              01514000
SMF74SAM EQU   SMFRCD74+36                                              01515000
SMF74PTR EQU   0                                                        01516000
SMF74A   EQU   0                                                        01517000
SMF74SDC EQU   SMF74A                                                   01518000
SMF74DEV EQU   SMF74A+2                                                 01519000
SMF74B   EQU   0                                                        01520000
SMF74ADD EQU   SMF74B                                                   01521000
SMF74CNF EQU   SMF74B+3                                                 01522000
SMF74VAC EQU   SMF74CNF                                                 01523000
SMF74STA EQU   SMF74CNF                                                 01524000
SMF74SER EQU   SMF74B+8                                                 01525000
SMF74CNT EQU   SMF74B+16                                                01526000
SMF74ACT EQU   SMF74B+20                                                01527000
SMF74QUE EQU   SMF74B+24                                                01528000
LNGTXT   EQU   0                                                        01529000
LNGTXTL  EQU   LNGTXT                                                   01530000
LNGTXTD  EQU   LNGTXT+4                                                 01531000
IRBMFCNV EQU   0                                                        01532000
MFHDRISR EQU   0                                                        01533000
MFISRTXT EQU   0                                                        01534000
MFWRTPAG EQU   0                                                        01535000
RDTRTAB  EQU   0                                                        01536000
IKEBC    EQU   0                                                        01537000
IKEBF15  EQU   0                                                        01538000
IKEBF31  EQU   0                                                        01539000
IKEBP15  EQU   0                                                        01540000
IKEBP31  EQU   0                                                        01541000
IKEBP8   EQU   0                                                        01542000
RDDTAPTR EQU   0                                                        01543000
RDVECTAB EQU   0                                                        01544000
RDPMAPTR EQU   0                                                        01545000
DDDVADD  EQU   DDDVT                                                    01546000
LNG      EQU   IRBMFLDV                                                 01547000
LNGTPTR  EQU   LNG                                                      01548000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01549000
SMF74RV4 EQU   SMF74B+14                                                01550000
SMF74TYP EQU   SMF74B+4                                                 01551000
@NM00001 EQU   SMF74CNF                                                 01552000
SMF74RV3 EQU   SMF74B+2                                                 01553000
SMF74RV2 EQU   SMF74A+6                                                 01554000
SMF74SDD EQU   SMF74A+4                                                 01555000
SMF74RLS EQU   SMFRCD74+44                                              01556000
SMF74RV1 EQU   SMFRCD74+42                                              01557000
SMF74MFV EQU   SMFRCD74+40                                              01558000
SMF74CYC EQU   SMFRCD74+32                                              01559000
SMF74INT EQU   SMFRCD74+28                                              01560000
SMF74DAT EQU   SMFRCD74+24                                              01561000
SMF74IST EQU   SMFRCD74+20                                              01562000
SMF74SID EQU   SMFRCD74+14                                              01563000
SMF74DTE EQU   SMFRCD74+10                                              01564000
SMF74TME EQU   SMFRCD74+6                                               01565000
SMF74RTY EQU   SMFRCD74+5                                               01566000
SMF74FLG EQU   SMFRCD74+4                                               01567000
SMF74SEG EQU   SMFRCD74+2                                               01568000
SMF74LEN EQU   SMFRCD74                                                 01569000
DDDVCRDR EQU   DDDVT+20                                                 01570000
DDDVTAPE EQU   DDDVT+16                                                 01571000
DDDVTP   EQU   DDDVT+12                                                 01572000
DDDVDA   EQU   DDDVT+8                                                  01573000
DDDVGRAP EQU   DDDVT+4                                                  01574000
DDDVUNIT EQU   DDDVT                                                    01575000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01576000
@RC00053 EQU   @RC00051                                                 01577000
@RC00055 EQU   @RC00053                                                 01578000
@ENDDATA EQU   *                                                        01579000
         END   IRBMFRDR,(C'PL/S-II',0502,74087)                         01580000
