         TITLE '*/* IRBMFRGM - REPORT GENERATOR CONTROL MODULE         *00001000
                       '                                                00002000
IRBMFRGM CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IRBMFRGM  74.087'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         MVC   @PC00001(12),0(@01)                                 0001 00022000
*                                                                  0032 00023000
*/* STATIC TO AUTOMATIC INITIALIZATION  -  THIS INITIALIZATION MOVES    00024000
*   COPIES OF STATIC VARIABLES INTO AUTOMATIC STORAGE WHICH WAS    0032 00025000
*   OBTAINED ON ENTRY TO THIS MODULE                                 */ 00026000
*                                                                  0032 00027000
*   RGCLOSPL=RGCLSSPL;              /* STATIC CLOSE PARAMETER LIST 0032 00028000
*                                      MOVED TO AUTOMATIC STORAGE    */ 00029000
         MVC   RGCLOSPL(4),RGCLSSPL                                0032 00030000
*   RGDCB=RGSDCB;                   /* STATIC DCB MOVED TO AUTOMATIC    00031000
*                                      STORAGE                       */ 00032000
         MVC   RGDCB(96),RGSDCB                                    0033 00033000
*   RGESTAPL=RGESTSPL;              /* STATIC ESTAE PARAMETER LIST 0034 00034000
*                                      MOVED TO AUTOMATIC STORAGE    */ 00035000
         MVC   RGESTAPL(16),RGESTSPL                               0034 00036000
*   RGOPENPL=RGOPNSPL;              /* STATIC OPEN PARAMETER LIST  0035 00037000
*                                      MOVED TO AUTOMATIC STORAGE    */ 00038000
         MVC   RGOPENPL(4),RGOPNSPL                                0035 00039000
*                                                                  0036 00040000
*/* GENERAL INITIALIZATION                                           */ 00041000
*                                                                  0036 00042000
*   /*****************************************************************/ 00043000
*   /*                                                               */ 00044000
*   /* LOAD BINARY TO CHARACTER CONVERSION ROUTINE                   */ 00045000
*   /*                                                               */ 00046000
*   /*****************************************************************/ 00047000
*                                                                  0036 00048000
*   RESPECIFY                                                      0036 00049000
*    (GPR00F,                                                      0036 00050000
*     GPR01F,                                                      0036 00051000
*     GPR14F,                                                      0036 00052000
*     GPR15F)RESTRICTED;                                           0036 00053000
*   GENERATE;                                                      0037 00054000
RGLOAD1  LOAD  EP=IRBMFCNV,RELATED=(MFRGLCNV,IRBMFRGM(RGLOAD8))         00055000
*   RGVECTAB(1)=GPR00P;             /* SAVE ENTRY POINT TO PASS TO 0038 00056000
*                                      REPORT GENERATORS             */ 00057000
         ST    GPR00P,RGVECTAB                                     0038 00058000
*   RESPECIFY                                                      0039 00059000
*    (GPR00F,                                                      0039 00060000
*     GPR01F,                                                      0039 00061000
*     GPR14F,                                                      0039 00062000
*     GPR15F)UNRESTRICTED;                                         0039 00063000
*                                                                  0039 00064000
*   /*****************************************************************/ 00065000
*   /*                                                               */ 00066000
*   /* INITIALIZE REST OF VECTOR TABLE                               */ 00067000
*   /*                                                               */ 00068000
*   /*****************************************************************/ 00069000
*                                                                  0040 00070000
*   RGVECTAB(2)=ADDR(MFHDRISR);                                    0040 00071000
         LA    @10,MFHDRISR                                        0040 00072000
         ST    @10,RGVECTAB+4                                      0040 00073000
*   RGVECTAB(3)=ADDR(MFISRTXT);                                    0041 00074000
         LA    @10,MFISRTXT                                        0041 00075000
         ST    @10,RGVECTAB+8                                      0041 00076000
*   RGVECTAB(4)=ADDR(MFWRTPAG);                                    0042 00077000
*                                                                  0042 00078000
         LA    @10,MFWRTPAG                                        0042 00079000
         ST    @10,RGVECTAB+12                                     0042 00080000
*   /*****************************************************************/ 00081000
*   /*                                                               */ 00082000
*   /* SET UP ESTAE PARAMETER LIST DO NOT ALLOW REPORT RETRY UNTIL   */ 00083000
*   /* SYSOUT IS OPENED.                                             */ 00084000
*   /*                                                               */ 00085000
*   /*****************************************************************/ 00086000
*                                                                  0043 00087000
*   MFSERTRY='1'B;                                                 0043 00088000
         L     @10,@PC00001                                        0043 00089000
         OI    MFSERTRY(@10),B'00000001'                           0043 00090000
*   RGESTSEL=ADDR(MFSEL);           /* ADDRESS OF SUBTASK ELEMENT    */ 00091000
         ST    @10,RGESTSEL                                        0044 00092000
*   RGESTALL=ADDR(RGALLARG);        /* ADDRESS OF ALLOCATION MODULE     00093000
*                                      ARGUMENTS                     */ 00094000
         LA    @15,RGALLARG                                        0045 00095000
         ST    @15,RGESTALL                                        0045 00096000
*   RGESTDCB=ADDR(RGDCB);           /* ADDRESS OF REPORT DCB         */ 00097000
         LA    @15,RGDCB                                           0046 00098000
         ST    @15,RGESTDCB                                        0046 00099000
*   RGESTDCM=MFSEMDCB;              /* ADDRESS OF MESSAGE DCB        */ 00100000
         MVC   RGESTDCM(4),MFSEMDCB(@10)                           0047 00101000
*   RGESTRTY=ADDR(RGRETRY);         /* RETRY ADDRESS FOR ESTAE       */ 00102000
         LA    @10,RGRETRY                                         0048 00103000
         ST    @10,RGESTRTY                                        0048 00104000
*   RGESTPAG=ADDR(RGPAGE);          /* ADDRESS OF INTERNAL PAGE IMAGE*/ 00105000
         LA    @10,RGPAGE                                          0049 00106000
         ST    @10,RGESTPAG                                        0049 00107000
*   RGESTOPN=ADDR(RGOPENPL);        /* ADDRESS OF OPEN PARM LIST     */ 00108000
         LA    @10,RGOPENPL                                        0050 00109000
         ST    @10,RGESTOPN                                        0050 00110000
*   RGESTCLS=ADDR(RGCLOSPL);        /* ADDRESS OF CLOSE PARM LIST    */ 00111000
         LA    @10,RGCLOSPL                                        0051 00112000
         ST    @10,RGESTCLS                                        0051 00113000
*   RGESTCNV=RGVECTAB(1);           /* ADDRESS OF CONVERSION ROUTINE */ 00114000
         MVC   RGESTCNV(4),RGVECTAB                                0052 00115000
*   RGESTREG=ADDR(RGRTYREG);        /* ADDRESS OF REGISTER SAVE AREA.*/ 00116000
*                                                                  0053 00117000
         LA    @10,RGRTYREG                                        0053 00118000
         ST    @10,RGESTREG                                        0053 00119000
*   /*****************************************************************/ 00120000
*   /*                                                               */ 00121000
*   /* ESTABLISH ESTAE ENVIRONMENT TO PROCEDURE IRBMFSAR             */ 00122000
*   /*                                                               */ 00123000
*   /*****************************************************************/ 00124000
*                                                                  0054 00125000
*   RESPECIFY                                                      0054 00126000
*    (GPR00F,                                                      0054 00127000
*     GPR01F,                                                      0054 00128000
*     GPR02P,                                                      0054 00129000
*     GPR03P,                                                      0054 00130000
*     GPR14F,                                                      0054 00131000
*     GPR15F)RESTRICTED;                                           0054 00132000
*                                                                  0054 00133000
*   /*****************************************************************/ 00134000
*   /*                                                               */ 00135000
*   /* SET ESTAE PARAMETER LIST ADDRESS INTO REGISTER FOR ESTAE      */ 00136000
*   /*                                                               */ 00137000
*   /*****************************************************************/ 00138000
*                                                                  0055 00139000
*   GPR02P=ADDR(RGESTPRM);                                         0055 00140000
         LA    GPR02P,RGESTPRM                                     0055 00141000
*   GPR03P=ADDR(IRBMFSAR);          /* GET ADDRESS OF RECOVERY     0056 00142000
*                                      ROUTINE                       */ 00143000
         L     GPR03P,@CV00592                                     0056 00144000
*   GENERATE REFS(RGESTPRM)SETS(RGESTAPL);                         0057 00145000
         ESTAE (3),PARAM=(2),MF=(E,RGESTAPL),RECORD=YES                 00146000
*   IF GPR15F^=0 THEN               /* IF IMPOSSIBLE RETURN CODE     */ 00147000
         LTR   GPR15F,GPR15F                                       0058 00148000
         BZ    @RF00058                                            0058 00149000
*     DO;                                                          0059 00150000
*       RGERRCDE=2;                 /* IMPOSSIBLE RETURN CODE FROM 0060 00151000
*                                      ESTAE                         */ 00152000
         MVC   RGERRCDE(2),@CH00089                                0060 00153000
*       GO TO RGERR2;               /* ABEND                         */ 00154000
         B     RGERR2                                              0061 00155000
*     END;                                                         0062 00156000
*   RESPECIFY                                                      0063 00157000
*    (GPR00F,                                                      0063 00158000
*     GPR01F,                                                      0063 00159000
*     GPR02P,                                                      0063 00160000
*     GPR03P,                                                      0063 00161000
*     GPR14F,                                                      0063 00162000
*     GPR15F)UNRESTRICTED;                                         0063 00163000
*                                                                  0063 00164000
@RF00058 DS    0H                                                  0064 00165000
*   /*****************************************************************/ 00166000
*   /*                                                               */ 00167000
*   /* POINT DCB LABEL STRUCTURE TO AUTOMATIC DCB                    */ 00168000
*   /*                                                               */ 00169000
*   /*****************************************************************/ 00170000
*                                                                  0064 00171000
*   DCBPTR=ADDR(RGDCB);                                            0064 00172000
         LA    DCBPTR,RGDCB                                        0064 00173000
*   DCBSYNA=ADDR(MFSYNAD);          /* SET ADDRESS OF SYNAD ROUTINE     00174000
*                                      INTO DCB                      */ 00175000
*                                                                  0065 00176000
         LA    @10,MFSYNAD                                         0065 00177000
         STCM  @10,7,DCBSYNA+52(DCBPTR)                            0065 00178000
*   /*****************************************************************/ 00179000
*   /*                                                               */ 00180000
*   /* INITIALIZE INTERNAL PAGE IMAGE                                */ 00181000
*   /*                                                               */ 00182000
*   /*****************************************************************/ 00183000
*                                                                  0066 00184000
*   RGLASTLN=RGNOPAGE;              /* NO LINES CONTAIN NON-BLANK  0066 00185000
*                                      CHARACTERS. (BLANK PAGE)      */ 00186000
         SR    @10,@10                                             0066 00187000
         STH   @10,RGLASTLN                                        0066 00188000
*   DO RGLOOP=1 TO RGMAXLN;                                        0067 00189000
         LA    RGLOOP,1                                            0067 00190000
@DL00067 DS    0H                                                  0068 00191000
*     RGLENGTH(RGLOOP)=RGNOLINE;    /* INDICATES LINE IS BLANK.      */ 00192000
         SR    @10,@10                                             0068 00193000
         LR    @07,RGLOOP                                          0068 00194000
         MH    @07,@CH00789                                        0068 00195000
         STH   @10,RGLENGTH-126(@07)                               0068 00196000
*     RGFILL(RGLOOP)=RGNOFILL;      /* FILL ZEROS FOR VARIABLE LENGTH   00197000
*                                      RECORD                        */ 00198000
         STH   @10,RGFILL-126(@07)                                 0069 00199000
*     RGCARCTL(RGLOOP)=' ';         /* CARRIAGE CONTROL CHARACTER    */ 00200000
         LA    @10,RGCARCTL-126(@07)                               0070 00201000
         MVI   0(@10),C' '                                         0070 00202000
*     RGLINE(RGLOOP)=' ';           /* BLANK LINE                    */ 00203000
         LA    @10,RGLINE-126(@07)                                 0071 00204000
         MVI   1(@10),C' '                                         0071 00205000
         MVC   2(118,@10),1(@10)                                   0071 00206000
         MVI   0(@10),C' '                                         0071 00207000
*   END;                                                           0072 00208000
         AH    RGLOOP,@CH00072                                     0072 00209000
         CH    RGLOOP,@CH00339                                     0072 00210000
         BNH   @DL00067                                            0072 00211000
*                                                                  0073 00212000
*/* BEGIN MAINLINE PROCESSING                                        */ 00213000
*                                                                  0073 00214000
*   /*****************************************************************/ 00215000
*   /*                                                               */ 00216000
*   /* THIS SUBTASK MAY ONLY EXECUTE IF ALL OTHER SUBTASKS HAVE      */ 00217000
*   /* COMPLETED                                                     */ 00218000
*   /*                                                               */ 00219000
*   /*****************************************************************/ 00220000
*                                                                  0073 00221000
*   DO WHILE(MFSESTID^=(MFPCALST+1));/* WAIT IF THIS IS NOT THE NEXT    00222000
*                                      SUBTASK TO GO                 */ 00223000
*                                                                  0073 00224000
         B     @DE00073                                            0073 00225000
@DL00073 DS    0H                                                  0074 00226000
*     /***************************************************************/ 00227000
*     /*                                                             */ 00228000
*     /* WAIT FOR ONE SECOND                                         */ 00229000
*     /*                                                             */ 00230000
*     /***************************************************************/ 00231000
*                                                                  0074 00232000
*     RESPECIFY                                                    0074 00233000
*      (GPR00F,                                                    0074 00234000
*       GPR01F,                                                    0074 00235000
*       GPR14F,                                                    0074 00236000
*       GPR15F)RESTRICTED;                                         0074 00237000
*     GENERATE REFS(RGONESEC);                                     0075 00238000
         STIMER WAIT,DINTVL=RGONESEC                                    00239000
*     RESPECIFY                                                    0076 00240000
*      (GPR00F,                                                    0076 00241000
*       GPR01F,                                                    0076 00242000
*       GPR14F,                                                    0076 00243000
*       GPR15F)UNRESTRICTED;                                       0076 00244000
*   END;                                                           0077 00245000
*                                                                  0077 00246000
@DE00073 L     @10,@PC00001                                        0077 00247000
         L     @07,@PC00001+4                                      0077 00248000
         LA    @15,1                                               0077 00249000
         A     @15,MFPCALST(,@07)                                  0077 00250000
         CL    @15,MFSESTID(,@10)                                  0077 00251000
         BNE   @DL00073                                            0077 00252000
*   /*****************************************************************/ 00253000
*   /*                                                               */ 00254000
*   /* CALCULATE UNIQUE DDNAME FROM SUBTASK ID TO USE IN ALLOCATING  */ 00255000
*   /* SYSOUT DATA SET                                               */ 00256000
*   /*                                                               */ 00257000
*   /*****************************************************************/ 00258000
*                                                                  0078 00259000
*   CALL IRBMFCNV(MFSESTID,         /* PARAMETER 1 - SUBTASK ID TO BE   00260000
*                                      CONVERTED                     */ 00261000
*       0,                          /* PARAMETER 2 - SCALE FACTOR ON    00262000
*                                      THE INPUT VALUE               */ 00263000
*       RGDDNAME(4:8),              /* PARAMETER 3 - OUTPUT STRING IN   00264000
*                                      FORM NNNNN WHERE N IS A     0078 00265000
*                                      DECIMAL DIGIT OR BLANK      0078 00266000
*                                      (LEADING ZEROS SUPPRESSED)    */ 00267000
*       5,                          /* PARAMETER 4 - OUTPUT STRING 0078 00268000
*                                      LENGTH                        */ 00269000
*       0,                          /* PARAMETER 5 - DIGITS TO THE 0078 00270000
*                                      RIGHT OF THE DECIMAL POINT IN    00271000
*                                      THE OUTPUT STRING             */ 00272000
*       '0'B,                       /* PARAMETER 6 - NO COMMAS TO BE    00273000
*                                      INSERTED                      */ 00274000
*       '0'B);                      /* PARAMETER 7 - NO FLOATING OF     00275000
*                                      NUMBER IN OUTPUT FIELD FOR  0078 00276000
*                                      MAXIMUM PRECISION.            */ 00277000
         MVC   @AL00001+4(24),@AL00078                             0078 00278000
         LA    @10,MFSESTID(,@10)                                  0078 00279000
         ST    @10,@AL00001                                        0078 00280000
         LA    @10,RGDDNAME+3                                      0078 00281000
         ST    @10,@AL00001+8                                      0078 00282000
         L     @15,RGVECTAB                                        0078 00283000
         LA    @01,@AL00001                                        0078 00284000
         BALR  @14,@15                                             0078 00285000
*   RESPECIFY                                                      0079 00286000
*    (GPR15F)RESTRICTED;                                           0079 00287000
*   IF GPR15F^=0 THEN               /* TEST FOR IMPOSSIBLE RETURN  0080 00288000
*                                      CODE                          */ 00289000
         LTR   GPR15F,GPR15F                                       0080 00290000
         BZ    @RF00080                                            0080 00291000
*     DO;                                                          0081 00292000
*       RGERRCDE=1;                 /* IMPOSSIBLE RETURN CODE FROM 0082 00293000
*                                      CONVERSION ROUTINE            */ 00294000
         MVC   RGERRCDE(2),@CH00072                                0082 00295000
*       GO TO RGERR2;               /* ABEND                         */ 00296000
         B     RGERR2                                              0083 00297000
*     END;                                                         0084 00298000
*   RESPECIFY                                                      0085 00299000
*    (GPR15F)UNRESTRICTED;                                         0085 00300000
*                                                                  0085 00301000
@RF00080 DS    0H                                                  0086 00302000
*   /*****************************************************************/ 00303000
*   /*                                                               */ 00304000
*   /* INSERT LEADING ZEROS                                          */ 00305000
*   /*                                                               */ 00306000
*   /*****************************************************************/ 00307000
*                                                                  0086 00308000
*   DO RGLOOP=4 TO LENGTH(RGDDNAME);                               0086 00309000
         LA    RGLOOP,4                                            0086 00310000
@DL00086 DS    0H                                                  0087 00311000
*     IF RGDDNAME(RGLOOP)=' ' THEN  /* INSERT ZERO IN PLACE OF BLANK */ 00312000
         LA    @10,RGDDNAME-1(RGLOOP)                              0087 00313000
         CLI   0(@10),C' '                                         0087 00314000
         BNE   @RF00087                                            0087 00315000
*       RGDDNAME(RGLOOP)='0';                                      0088 00316000
         LA    @10,RGDDNAME-1(RGLOOP)                              0088 00317000
         MVI   0(@10),C'0'                                         0088 00318000
*   END;                                                           0089 00319000
@RF00087 AH    RGLOOP,@CH00072                                     0089 00320000
         CH    RGLOOP,@CH00052                                     0089 00321000
         BNH   @DL00086                                            0089 00322000
*   RGDDNAME(1:3)='MFR';            /* COMPLETE DDNAME               */ 00323000
         MVC   RGDDNAME(3),@CC00656                                0090 00324000
*   DCBDDNAM=RGDDNAME;              /* SET INTO DCB                  */ 00325000
*                                                                  0091 00326000
         LA    @10,40                                              0091 00327000
         AR    @10,DCBPTR                                          0091 00328000
         MVC   DCBDDNAM(8,@10),RGDDNAME                            0091 00329000
*   /*****************************************************************/ 00330000
*   /*                                                               */ 00331000
*   /* ALLOCATE DATA SET                                             */ 00332000
*   /*                                                               */ 00333000
*   /*****************************************************************/ 00334000
*                                                                  0092 00335000
*   RGALLDDN=DCBDDNAM;              /* DDNAME TO TEMPORARY ARGUMENT  */ 00336000
         MVC   RGALLDDN(8),DCBDDNAM(@10)                           0092 00337000
*   RGALLSOU=MFCOOUTV;              /* SYSOUT CLASS TO TEMPORARY   0093 00338000
*                                      ARGUMENT FROM COMMON OPTION 0093 00339000
*                                      AREA                          */ 00340000
*                                                                  0093 00341000
         L     @10,@PC00001                                        0093 00342000
         L     @10,MFSECOA(,@10)                                   0093 00343000
         MVC   RGALLSOU(1),MFCOOUTV(@10)                           0093 00344000
*   /*****************************************************************/ 00345000
*   /*                                                               */ 00346000
*   /* SET TEMPORARY ARGUMENT FOR UNALLOCATION AT CLOSE. UNALLOCATE  */ 00347000
*   /* ONLY IF REALTIME REPORTS ARE DESIRED                          */ 00348000
*   /*                                                               */ 00349000
*   /*****************************************************************/ 00350000
*                                                                  0094 00351000
*   IF MFCOREPV=RGREALTM THEN                                      0094 00352000
         TM    MFCOREPV(@10),B'00000010'                           0094 00353000
         BNO   @RF00094                                            0094 00354000
         TM    MFCOREPV(@10),B'00000001'                           0094 00355000
         BNZ   @RF00094                                            0094 00356000
*     RGALLUNA='1'B;                /* UNALLOCATE REALTIME REPORTS   */ 00357000
         OI    RGALLUNA,B'10000000'                                0095 00358000
*   ELSE                                                           0096 00359000
*     RGALLUNA='0'B;                /* DONT UNALLOCATE DEFERRED    0096 00360000
*                                      REPORTS                       */ 00361000
*                                                                  0096 00362000
         B     @RC00094                                            0096 00363000
@RF00094 NI    RGALLUNA,B'01111111'                                0096 00364000
*   /*****************************************************************/ 00365000
*   /*                                                               */ 00366000
*   /* LOAD ALLOCATION MODULE                                        */ 00367000
*   /*                                                               */ 00368000
*   /*****************************************************************/ 00369000
*                                                                  0097 00370000
*   RGMODULE='IRBMFALL';            /* MODULE NAME TO RECEIVE CONTROL*/ 00371000
@RC00094 MVC   RGMODULE(8),@CC00657                                0097 00372000
*   RESPECIFY                                                      0098 00373000
*    (GPR00F,                                                      0098 00374000
*     GPR01F,                                                      0098 00375000
*     GPR14F,                                                      0098 00376000
*     GPR15F)RESTRICTED;                                           0098 00377000
*   GENERATE REFS(RGMODULE);                                       0099 00378000
RGLOAD2  LOAD  EPLOC=RGMODULE,RELATED=(MFRGLALL,IRBMFRGM(RGLOAD3))      00379000
*   RGENTRYP=GPR00P;                /* SAVE ENTRY POINT FOR CALL     */ 00380000
         LR    RGENTRYP,GPR00P                                     0100 00381000
*   RESPECIFY                                                      0101 00382000
*    (GPR00F,                                                      0101 00383000
*     GPR01F,                                                      0101 00384000
*     GPR14F,                                                      0101 00385000
*     GPR15F)UNRESTRICTED;                                         0101 00386000
*                                                                  0101 00387000
*   /*****************************************************************/ 00388000
*   /*                                                               */ 00389000
*   /* CALL ALLOCATION MODULE                                        */ 00390000
*   /*                                                               */ 00391000
*   /*****************************************************************/ 00392000
*                                                                  0102 00393000
*   CALL IRBMFALL(RGALLDDN,         /* DDNAME                        */ 00394000
*       RGALLSOU,                   /* SYSOUT CLASS                  */ 00395000
*       RGALLUNA);                  /* UNALLOCATION AT CLOSE FLAG    */ 00396000
*                                                                  0102 00397000
         LA    @10,RGALLDDN                                        0102 00398000
         ST    @10,@AL00001                                        0102 00399000
         LA    @10,RGALLSOU                                        0102 00400000
         ST    @10,@AL00001+4                                      0102 00401000
         LA    @10,RGALLUNA                                        0102 00402000
         ST    @10,@AL00001+8                                      0102 00403000
         LR    @15,RGENTRYP                                        0102 00404000
         LA    @01,@AL00001                                        0102 00405000
         BALR  @14,@15                                             0102 00406000
*   /*****************************************************************/ 00407000
*   /*                                                               */ 00408000
*   /* DELETE ALLOCATION MODULE                                      */ 00409000
*   /*                                                               */ 00410000
*   /*****************************************************************/ 00411000
*                                                                  0103 00412000
*   RESPECIFY                                                      0103 00413000
*    (GPR00F,                                                      0103 00414000
*     GPR01F,                                                      0103 00415000
*     GPR14F,                                                      0103 00416000
*     GPR15F)RESTRICTED;                                           0103 00417000
*   GENERATE REFS(RGMODULE);                                       0104 00418000
RGLOAD3  DELETE EPLOC=RGMODULE,RELATED=(MFRGLALL,IRBMFRGM(RGLOAD2))     00419000
*   RESPECIFY                                                      0105 00420000
*    (GPR00F,                                                      0105 00421000
*     GPR01F,                                                      0105 00422000
*     GPR14F,                                                      0105 00423000
*     GPR15F)UNRESTRICTED;                                         0105 00424000
*                                                                  0105 00425000
*   /*****************************************************************/ 00426000
*   /*                                                               */ 00427000
*   /* DATA SET IS NOW ALLOCATED. OPEN IT                            */ 00428000
*   /*                                                               */ 00429000
*   /*****************************************************************/ 00430000
*                                                                  0106 00431000
*   RESPECIFY                                                      0106 00432000
*    (GPR00F,                                                      0106 00433000
*     GPR01F,                                                      0106 00434000
*     GPR14F,                                                      0106 00435000
*     GPR15F)RESTRICTED;                                           0106 00436000
*   GENERATE REFS(RGDCB)SETS(RGOPENPL);                            0107 00437000
         OPEN  (RGDCB,(OUTPUT)),MF=(E,RGOPENPL)                         00438000
*   RESPECIFY                                                      0108 00439000
*    (GPR00F,                                                      0108 00440000
*     GPR01F,                                                      0108 00441000
*     GPR14F,                                                      0108 00442000
*     GPR15F)UNRESTRICTED;                                         0108 00443000
*   IF DCBOFOPN='0'B THEN           /* TEST FOR OPEN ERROR           */ 00444000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0109 00445000
         BZ    @RT00109                                            0109 00446000
*     GO TO RGERR1;                 /* GENERATE ABEND DUE TO OPEN  0110 00447000
*                                      ERROR                         */ 00448000
*                                                                  0110 00449000
*   /*****************************************************************/ 00450000
*   /*                                                               */ 00451000
*   /* LOAD, CALL, AND DELETE THE REPORT GENERATOR FOR EACH ACTIVE   */ 00452000
*   /* MEASUREMENT OPTION SAVE REGISTERS FOR RETRY ON ERROR          */ 00453000
*   /*                                                               */ 00454000
*   /*****************************************************************/ 00455000
*                                                                  0111 00456000
*   GENERATE(STM  @02,@13,RGRTYREG);                               0111 00457000
*                                                                  0111 00458000
         STM  @02,@13,RGRTYREG                                          00459000
*   /*****************************************************************/ 00460000
*   /*                                                               */ 00461000
*   /* REPORT RETRY IS NOW ALLOWED.                                  */ 00462000
*   /*                                                               */ 00463000
*   /*****************************************************************/ 00464000
*                                                                  0112 00465000
*   MFSERTRY='0'B;                                                 0112 00466000
         L     @10,@PC00001                                        0112 00467000
         NI    MFSERTRY(@10),B'11111110'                           0112 00468000
*RGRETRY:                           /* RETRY POINT FROM ESTAE      0113 00469000
*                                      RECOVERY EXIT                 */ 00470000
*   DO RGLOOP=1 TO MFMVNUM;         /* LOOP THROUGH MEASUREMENT    0113 00471000
*                                      VECTOR TABLE                  */ 00472000
RGRETRY  LA    RGLOOP,1                                            0113 00473000
         B     @DE00113                                            0113 00474000
@DL00113 DS    0H                                                  0114 00475000
*     IF MFMVADD(RGLOOP)->MFPMOPT=0 THEN                           0114 00476000
         LR    @10,RGLOOP                                          0114 00477000
         SLA   @10,2                                               0114 00478000
         L     @05,@PC00001+8                                      0114 00479000
         L     @10,MFMVADD-4(@10,@05)                              0114 00480000
         ICM   @05,15,MFPMOPT(@10)                                 0114 00481000
         BZ    @RT00114                                            0114 00482000
*       GO TO RGLAB2;               /* BYPASS IF OPTION NOT ACTIVE   */ 00483000
*     RGMODULE=MFMVADD(RGLOOP)->    /* ADDRESS PROPER PMA            */ 00484000
*         MFPMSARG;                 /* SET REPORT GENERATOR NAME INTO   00485000
*                                      TEMPORARY ARGUMENT FOR LOAD   */ 00486000
*                                                                  0116 00487000
         MVC   RGMODULE(8),MFPMSARG(@10)                           0116 00488000
*     /***************************************************************/ 00489000
*     /*                                                             */ 00490000
*     /* LOAD REPORT GENERATOR                                       */ 00491000
*     /*                                                             */ 00492000
*     /***************************************************************/ 00493000
*                                                                  0117 00494000
*     RESPECIFY                                                    0117 00495000
*      (GPR00F,                                                    0117 00496000
*       GPR01F,                                                    0117 00497000
*       GPR14F,                                                    0117 00498000
*       GPR15F)RESTRICTED;                                         0117 00499000
*     GENERATE REFS(RGMODULE);                                     0118 00500000
RGLOAD4  LOAD  EPLOC=RGMODULE,RELATED=(MFRGLRXR,IRBMFRGM,(RGLOAD5))     00501000
*     RGENTRYP=GPR00P;              /* SAVE ENTRY POINT FOR CALL     */ 00502000
         LR    RGENTRYP,GPR00P                                     0119 00503000
*     RESPECIFY                                                    0120 00504000
*      (GPR00F,                                                    0120 00505000
*       GPR01F,                                                    0120 00506000
*       GPR14F,                                                    0120 00507000
*       GPR15F)UNRESTRICTED;                                       0120 00508000
*                                                                  0120 00509000
*     /***************************************************************/ 00510000
*     /*                                                             */ 00511000
*     /* CALL REPORT GENERATOR                                       */ 00512000
*     /*                                                             */ 00513000
*     /***************************************************************/ 00514000
*                                                                  0121 00515000
*     CALL IRBMFRXR(                /* REPORT FORMATTER PROGRAM      */ 00516000
*         DTMVADD(RGLOOP),          /* ADDRESS OF DATA TO BE       0121 00517000
*                                      FORMATTED AND PRINTED.        */ 00518000
*         RGVECTAB,                 /* VECTOR TABLE OF COMMON      0121 00519000
*                                      SUBROUTINES                   */ 00520000
*         MFMVADD(RGLOOP)           /* ADDRESS OF PMA FOR THIS REPORT*/ 00521000
*         );                                                       0121 00522000
*                                                                  0121 00523000
         LR    @10,RGLOOP                                          0121 00524000
         SLA   @10,2                                               0121 00525000
         L     @15,@PC00001                                        0121 00526000
         L     @01,MFSEDTMV(,@15)                                  0121 00527000
         LA    @15,DTMVADD-4(@10,@01)                              0121 00528000
         ST    @15,@AL00001                                        0121 00529000
         LA    @15,RGVECTAB                                        0121 00530000
         ST    @15,@AL00001+4                                      0121 00531000
         L     @15,@PC00001+8                                      0121 00532000
         LA    @10,MFMVADD-4(@10,@15)                              0121 00533000
         ST    @10,@AL00001+8                                      0121 00534000
         LR    @15,RGENTRYP                                        0121 00535000
         LA    @01,@AL00001                                        0121 00536000
         BALR  @14,@15                                             0121 00537000
*     /***************************************************************/ 00538000
*     /*                                                             */ 00539000
*     /* DELETE REPORT GENERATOR                                     */ 00540000
*     /*                                                             */ 00541000
*     /***************************************************************/ 00542000
*                                                                  0122 00543000
*     RESPECIFY                                                    0122 00544000
*      (GPR00F,                                                    0122 00545000
*       GPR01F,                                                    0122 00546000
*       GPR14F,                                                    0122 00547000
*       GPR15F)RESTRICTED;                                         0122 00548000
*     GENERATE REFS(RGMODULE);                                     0123 00549000
RGLOAD5  DELETE EPLOC=RGMODULE,RELATED=(MFRGLRXR,IRBMFRGM(RGLOAD4))     00550000
*     RESPECIFY                                                    0124 00551000
*      (GPR00F,                                                    0124 00552000
*       GPR01F,                                                    0124 00553000
*       GPR14F,                                                    0124 00554000
*       GPR15F)UNRESTRICTED;                                       0124 00555000
*RGLAB2:                            /* END OF MEASUREMENT VECTOR   0125 00556000
*                                      TABLE LOOP                    */ 00557000
*   END;                                                           0125 00558000
*                                                                  0125 00559000
RGLAB2   AH    RGLOOP,@CH00072                                     0125 00560000
@DE00113 L     @10,@PC00001+8                                      0125 00561000
         C     RGLOOP,MFMVNUM(,@10)                                0125 00562000
         BNH   @DL00113                                            0125 00563000
*   /*****************************************************************/ 00564000
*   /*                                                               */ 00565000
*   /* DO NOT ALLOW REPORT RETRY.                                    */ 00566000
*   /*                                                               */ 00567000
*   /*****************************************************************/ 00568000
*                                                                  0126 00569000
*   MFSERTRY='1'B;                                                 0126 00570000
*                                                                  0126 00571000
         L     @10,@PC00001                                        0126 00572000
         OI    MFSERTRY(@10),B'00000001'                           0126 00573000
*   /*****************************************************************/ 00574000
*   /*                                                               */ 00575000
*   /* CLOSE SYSOUT DATA SET. IF THIS IS A REALTIME DATA SET IT WILL */ 00576000
*   /* BE UNALLOCATED AND PRINTED IMMEDIATELY. OTHERWISE, IT WILL BE */ 00577000
*   /* PRINTED FOLLOWING MF/1 TERMINATION.                           */ 00578000
*   /*                                                               */ 00579000
*   /*****************************************************************/ 00580000
*                                                                  0127 00581000
*   RESPECIFY                                                      0127 00582000
*    (GPR00F,                                                      0127 00583000
*     GPR01F,                                                      0127 00584000
*     GPR14F,                                                      0127 00585000
*     GPR15F)RESTRICTED;                                           0127 00586000
*   GENERATE REFS(RGDCB)SETS(RGCLOSPL);                            0128 00587000
         CLOSE (RGDCB,DISP),MF=(E,RGCLOSPL)                             00588000
*   RESPECIFY                                                      0129 00589000
*    (GPR00F,                                                      0129 00590000
*     GPR01F,                                                      0129 00591000
*     GPR14F,                                                      0129 00592000
*     GPR15F)UNRESTRICTED;                                         0129 00593000
*   MFPCALST=MFSESTID;              /* INDICATE THAT THIS SUBTASK IS    00594000
*                                      THE LAST ONE TO COMPLETE    0130 00595000
*                                      PROCESSING                    */ 00596000
*                                                                  0130 00597000
         L     @10,@PC00001+4                                      0130 00598000
         L     @15,@PC00001                                        0130 00599000
         MVC   MFPCALST(4,@10),MFSESTID(@15)                       0130 00600000
*   /*****************************************************************/ 00601000
*   /*                                                               */ 00602000
*   /* FREE INTERVAL DATA STORAGE AREAS AND THE INTERVAL DATA        */ 00603000
*   /* MEASUREMENT VECTOR TABLE                                      */ 00604000
*   /*                                                               */ 00605000
*   /*****************************************************************/ 00606000
*                                                                  0131 00607000
*   DO RGLOOP=1 TO DTMVNUM;                                        0131 00608000
         LA    RGLOOP,1                                            0131 00609000
         B     @DE00131                                            0131 00610000
@DL00131 DS    0H                                                  0132 00611000
*     IF DTMVADD(RGLOOP)=0 THEN     /* BYPASS IF NO DATA             */ 00612000
         LR    @10,RGLOOP                                          0132 00613000
         SLA   @10,2                                               0132 00614000
         L     @05,@PC00001                                        0132 00615000
         L     @05,MFSEDTMV(,@05)                                  0132 00616000
         L     @10,DTMVADD-4(@10,@05)                              0132 00617000
         LTR   @10,@10                                             0132 00618000
         BZ    @RT00132                                            0132 00619000
*       GO TO RGLAB3;               /* FREE MEASUREMENT VECTOR TABLE */ 00620000
*     RESPECIFY                                                    0134 00621000
*      (GPR00F,                                                    0134 00622000
*       GPR01F,                                                    0134 00623000
*       GPR14F,                                                    0134 00624000
*       GPR15F)RESTRICTED;                                         0134 00625000
*                                                                  0134 00626000
*     /***************************************************************/ 00627000
*     /*                                                             */ 00628000
*     /* ADDRESS PROPER DATA AREA                                    */ 00629000
*     /*                                                             */ 00630000
*     /***************************************************************/ 00631000
*                                                                  0135 00632000
*     GPR00F=(DTMVADD(RGLOOP)-LENGTH(RGSBPLLN))->RGSBPLLN;/* SUBPOOL    00633000
*                                      AND LENGTH TO REGISTER 0      */ 00634000
*                                                                  0135 00635000
         SH    @10,@CH00065                                        0135 00636000
         L     GPR00F,RGSBPLLN(,@10)                               0135 00637000
*     /***************************************************************/ 00638000
*     /*                                                             */ 00639000
*     /* ADDRESS OF AREA TO BE FREED TO REGISTER 1                   */ 00640000
*     /*                                                             */ 00641000
*     /***************************************************************/ 00642000
*                                                                  0136 00643000
*     GPR01P=(DTMVADD(RGLOOP)-LENGTH(RGSBPLLN));                   0136 00644000
*                                                                  0136 00645000
         LR    GPR01P,@10                                          0136 00646000
*     /***************************************************************/ 00647000
*     /*                                                             */ 00648000
*     /* FREE INTERVAL DATA AREA                                     */ 00649000
*     /*                                                             */ 00650000
*     /***************************************************************/ 00651000
*                                                                  0137 00652000
*     GENERATE;                                                    0137 00653000
RGFREES1 FREEMAIN R,LV=(0),A=(1)                                        00654000
*     RESPECIFY                                                    0138 00655000
*      (GPR00F,                                                    0138 00656000
*       GPR01F,                                                    0138 00657000
*       GPR14F,                                                    0138 00658000
*       GPR15F)UNRESTRICTED;                                       0138 00659000
*RGLAB3:                            /* END OF ROUTINE TO FREE      0139 00660000
*                                      INTERVAL DATA STORAGE AREA    */ 00661000
*   END;                                                           0139 00662000
*                                                                  0139 00663000
RGLAB3   AH    RGLOOP,@CH00072                                     0139 00664000
@DE00131 L     @10,@PC00001                                        0139 00665000
         L     @10,MFSEDTMV(,@10)                                  0139 00666000
         C     RGLOOP,DTMVNUM(,@10)                                0139 00667000
         BNH   @DL00131                                            0139 00668000
*   /*****************************************************************/ 00669000
*   /*                                                               */ 00670000
*   /* FREE DATA MEASUREMENT VECTOR TABLE                            */ 00671000
*   /*                                                               */ 00672000
*   /*****************************************************************/ 00673000
*                                                                  0140 00674000
*   RESPECIFY                                                      0140 00675000
*    (GPR00F,                                                      0140 00676000
*     GPR01F,                                                      0140 00677000
*     GPR14F,                                                      0140 00678000
*     GPR15F)RESTRICTED;                                           0140 00679000
*                                                                  0140 00680000
*   /*****************************************************************/ 00681000
*   /*                                                               */ 00682000
*   /* SET SUBPOOL AND LENGTH INTO REGISTER ZERO. THESE EXIST IN WORD*/ 00683000
*   /* PRECEDING DTMVT                                               */ 00684000
*   /*                                                               */ 00685000
*   /*****************************************************************/ 00686000
*                                                                  0141 00687000
*   GPR00F=(ADDR(DTMVT)-LENGTH(RGSBPLLN))->RGSBPLLN;               0141 00688000
         L     @10,@PC00001                                        0141 00689000
         L     @10,MFSEDTMV(,@10)                                  0141 00690000
         SH    @10,@CH00065                                        0141 00691000
         L     GPR00F,RGSBPLLN(,@10)                               0141 00692000
*   GPR01P=ADDR(DTMVT)-LENGTH(RGSBPLLN);/* ADDRESS TO REG 1          */ 00693000
         LR    GPR01P,@10                                          0142 00694000
*   GENERATE;                                                      0143 00695000
         FREEMAIN R,LV=(0),A=(1)                                        00696000
*   RESPECIFY                                                      0144 00697000
*    (GPR00F,                                                      0144 00698000
*     GPR01F,                                                      0144 00699000
*     GPR14F,                                                      0144 00700000
*     GPR15F)UNRESTRICTED;                                         0144 00701000
*                                                                  0144 00702000
*   /*****************************************************************/ 00703000
*   /*                                                               */ 00704000
*   /* WRITE MESSAGE IRB101I MF/1 REPORT AVAILABLE FOR PRINTING IF   */ 00705000
*   /* THIS IS A REALTIME REPORT.                                    */ 00706000
*   /*                                                               */ 00707000
*   /*****************************************************************/ 00708000
*                                                                  0145 00709000
*   IF MFCOREPV=RGREALTM THEN       /* IF REPORT OPTION IS REALTIME  */ 00710000
         L     @10,@PC00001                                        0145 00711000
         L     @10,MFSECOA(,@10)                                   0145 00712000
         TM    MFCOREPV(@10),B'00000010'                           0145 00713000
         BNO   @RF00145                                            0145 00714000
         TM    MFCOREPV(@10),B'00000001'                           0145 00715000
         BNZ   @RF00145                                            0145 00716000
*     DO;                                                          0146 00717000
*                                                                  0146 00718000
*       /*************************************************************/ 00719000
*       /*                                                           */ 00720000
*       /* LOAD MESSAGE MODULE                                       */ 00721000
*       /*                                                           */ 00722000
*       /*************************************************************/ 00723000
*                                                                  0147 00724000
*       RGMODULE='IRBMFMPR';        /* MODULE TO LOAD                */ 00725000
         MVC   RGMODULE(8),@CC00664                                0147 00726000
*       RESPECIFY                                                  0148 00727000
*        (GPR00F,                                                  0148 00728000
*         GPR01F,                                                  0148 00729000
*         GPR14F,                                                  0148 00730000
*         GPR15F)RESTRICTED;                                       0148 00731000
*       GENERATE REFS(RGMODULE);                                   0149 00732000
RGLOAD6  LOAD  EPLOC=RGMODULE,RELATED=(MFRGLMPR,IRBMFRGM(RGLOAD7))      00733000
*       RGENTRYP=GPR00P;            /* SAVE ENTRY POINT FOR CALL     */ 00734000
         LR    RGENTRYP,GPR00P                                     0150 00735000
*       RESPECIFY                                                  0151 00736000
*        (GPR00F,                                                  0151 00737000
*         GPR01F,                                                  0151 00738000
*         GPR14F,                                                  0151 00739000
*         GPR15F)UNRESTRICTED;                                     0151 00740000
*                                                                  0151 00741000
*       /*************************************************************/ 00742000
*       /*                                                           */ 00743000
*       /* CALL MESSAGE MODULE                                       */ 00744000
*       /*                                                           */ 00745000
*       /*************************************************************/ 00746000
*                                                                  0152 00747000
*       CALL IRBMFMPR(MID101I,      /* MESSAGE INDEX NUMBER          */ 00748000
*           RGSADDR,                /* DUMMY VARIABLE TEXT/PART LIST */ 00749000
*           RGSADDR,                /* DUMMY REPLY BUFFER ADDRESS    */ 00750000
*           RGSADDR);               /* DUMMY DCB ADDRESS             */ 00751000
*                                                                  0152 00752000
         LR    @15,RGENTRYP                                        0152 00753000
         LA    @01,@AL00152                                        0152 00754000
         BALR  @14,@15                                             0152 00755000
*       /*************************************************************/ 00756000
*       /*                                                           */ 00757000
*       /* DELETE MESSAGE MODULE                                     */ 00758000
*       /*                                                           */ 00759000
*       /*************************************************************/ 00760000
*                                                                  0153 00761000
*       RESPECIFY                                                  0153 00762000
*        (GPR00F,                                                  0153 00763000
*         GPR01F,                                                  0153 00764000
*         GPR14F,                                                  0153 00765000
*         GPR15F)RESTRICTED;                                       0153 00766000
*       GENERATE REFS(RGMODULE);                                   0154 00767000
RGLOAD7  DELETE EPLOC=RGMODULE,RELATED=(MFRGLMPR,IRBMFRGM(RGLOAD6))     00768000
*       RESPECIFY                                                  0155 00769000
*        (GPR00F,                                                  0155 00770000
*         GPR01F,                                                  0155 00771000
*         GPR14F,                                                  0155 00772000
*         GPR15F)UNRESTRICTED;                                     0155 00773000
*     END;                                                         0156 00774000
*                                                                  0156 00775000
*   /*****************************************************************/ 00776000
*   /*                                                               */ 00777000
*   /* DELETE CONVERSION MODULE                                      */ 00778000
*   /*                                                               */ 00779000
*   /*****************************************************************/ 00780000
*                                                                  0157 00781000
*   RGMODULE='IRBMFCNV';                                           0157 00782000
@RF00145 MVC   RGMODULE(8),@CC00665                                0157 00783000
*   RESPECIFY                                                      0158 00784000
*    (GPR00F,                                                      0158 00785000
*     GPR01F,                                                      0158 00786000
*     GPR14F,                                                      0158 00787000
*     GPR15F)RESTRICTED;                                           0158 00788000
*   GENERATE REFS(RGMODULE);                                       0159 00789000
RGLOAD8  DELETE EPLOC=RGMODULE,RELATED=(MFRGLCNV,IRBMFRGM(RGLOAD1))     00790000
*   RESPECIFY                                                      0160 00791000
*    (GPR00F,                                                      0160 00792000
*     GPR01F,                                                      0160 00793000
*     GPR14F,                                                      0160 00794000
*     GPR15F)UNRESTRICTED;                                         0160 00795000
*                                                                  0160 00796000
*   /*****************************************************************/ 00797000
*   /*                                                               */ 00798000
*   /* CANCEL ESTAE ENVIRONMENT                                      */ 00799000
*   /*                                                               */ 00800000
*   /*****************************************************************/ 00801000
*                                                                  0161 00802000
*   RESPECIFY                                                      0161 00803000
*    (GPR00F,                                                      0161 00804000
*     GPR01F,                                                      0161 00805000
*     GPR14F,                                                      0161 00806000
*     GPR15F)RESTRICTED;                                           0161 00807000
*   GENERATE SETS(RGESTAPL);                                       0162 00808000
         ESTAE 0,MF=(E,RGESTAPL)                                        00809000
*   IF GPR15F^=0 THEN               /* IMPOSSIBLE RETURN CODE        */ 00810000
         LTR   GPR15F,GPR15F                                       0163 00811000
         BZ    @RF00163                                            0163 00812000
*     DO;                                                          0164 00813000
*       RGERRCDE=3;                 /* IMPOSSIBLE RETURN CODE FROM 0165 00814000
*                                      ESTAE CANCEL                  */ 00815000
         MVC   RGERRCDE(2),@CH00127                                0165 00816000
*       GO TO RGERR2;               /* ABEND                         */ 00817000
         B     RGERR2                                              0166 00818000
*     END;                                                         0167 00819000
*   RESPECIFY                                                      0168 00820000
*    (GPR00F,                                                      0168 00821000
*     GPR01F,                                                      0168 00822000
*     GPR14F,                                                      0168 00823000
*     GPR15F)UNRESTRICTED;                                         0168 00824000
@RF00163 DS    0H                                                  0169 00825000
*   RETURN CODE(0);                 /* TERMINATE MF1 REPORT SUBTASK. */ 00826000
*                                                                  0169 00827000
         L     @13,4(,@13)                                         0169 00828000
         L     @00,@SIZDATD                                        0169 00829000
         LR    @01,@11                                             0169 00830000
         FREEMAIN R,LV=(0),A=(1)                                        00831000
         SR    @15,@15                                             0169 00832000
         L     @14,12(,@13)                                        0169 00833000
         LM    @00,@12,20(@13)                                     0169 00834000
         BR    @14                                                 0169 00835000
*   /*****************************************************************/ 00836000
*   /*                                                               */ 00837000
*   /* OPEN ERROR COMES HERE                                         */ 00838000
*   /*                                                               */ 00839000
*   /*****************************************************************/ 00840000
*                                                                  0170 00841000
*RGERR1:                                                           0170 00842000
*   GENERATE(ABEND 1300,DUMP);                                     0170 00843000
*                                                                  0170 00844000
RGERR1   ABEND 1300,DUMP                                                00845000
*   /*****************************************************************/ 00846000
*   /*                                                               */ 00847000
*   /* UNEXPECTED RETURN CODES COME HERE                             */ 00848000
*   /*                                                               */ 00849000
*   /*****************************************************************/ 00850000
*                                                                  0171 00851000
*RGERR2:                                                           0171 00852000
*                                                                  0171 00853000
*   /*****************************************************************/ 00854000
*   /*                                                               */ 00855000
*   /* MACDATE Y-2 73018                                             */ 00856000
*   /*                                                               */ 00857000
*   /*****************************************************************/ 00858000
*                                                                  0171 00859000
*   RESPECIFY                                                      0171 00860000
*    (GPR15P)RESTRICTED;                                           0171 00861000
RGERR2   DS    0H                                                  0172 00862000
*   GPR15P=RGERRCDE;                /* CODE TO REGISTER              */ 00863000
*                                                                  0172 00864000
         LH    GPR15P,RGERRCDE                                     0172 00865000
*   /*****************************************************************/ 00866000
*   /*                                                               */ 00867000
*   /* MACDATE Y-2 73018                                             */ 00868000
*   /*                                                               */ 00869000
*   /*****************************************************************/ 00870000
*                                                                  0173 00871000
*   RESPECIFY                                                      0173 00872000
*    (GPR15P)UNRESTRICTED;                                         0173 00873000
*   GENERATE(ABEND 1301,DUMP);                                     0174 00874000
         ABEND 1301,DUMP                                                00875000
*                                                                  0175 00876000
*/*                                                                  */ 00877000
*/*** START OF SPECIFICATIONS ****************************************  00878000
*                                                                    */ 00879000
*/*                                                                  */ 00880000
*/* SUBROUTINE-NAME = MFISRTXT                                       */ 00881000
*/*                                                                  */ 00882000
*/* DESCRIPTIVE-NAME = REPORT INSERT TEXT ROUTINE                    */ 00883000
*/*                                                                  */ 00884000
*/* FUNCTION = INSERTS TEXT INTO THE INTERNAL PAGE IMAGE.            */ 00885000
*/*                                                                  */ 00886000
*/* ENTRY-POINT = MFISRTXT                                           */ 00887000
*/*                                                                  */ 00888000
*/*    PURPOSE = SEE FUNCTION                                        */ 00889000
*/*                                                                  */ 00890000
*/*    LINKAGE = R1 - PARAMETER LIST ADDRESS                         */ 00891000
*/*                                                                  */ 00892000
*/* INPUT = PARAMETER 1 - TEXT TO INSERT                             */ 00893000
*/*         PARAMETER 2 - LENGTH OF TEXT TO INSERT                   */ 00894000
*/*         PARAMETER 3 - BEGINNING LINE                             */ 00895000
*/*         PARAMETER 4 - BEGINNING COLUMN                           */ 00896000
*/*                                                                  */ 00897000
*/**** END OF SPECIFICATIONS *****************************************  00898000
*                                                                    */ 00899000
*/*                                                                  */ 00900000
*/* INSERT TEXT PROCEDURE                                            */ 00901000
*                                                                  0175 00902000
*MFISRTXT:                                                         0175 00903000
*   PROCEDURE(ISTEXT,               /* TEXT TO BE INSERTED INTO THE     00904000
*                                      INTERNAL PAGE IMAGE           */ 00905000
*       ISTXTLEN,                   /* LENGTH OF TEXT                */ 00906000
*       ISBEGLIN,                   /* BEGINNING LINE                */ 00907000
*       ISBEGCOL)                   /* BEGINNING COLUMN              */ 00908000
*       ;                                                          0175 00909000
         B     @PB00002                                            0175 00910000
MFISRTXT STM   @14,@12,12(@13)                                     0175 00911000
         MVC   @PC00002(16),0(@01)                                 0175 00912000
*                                                                  0176 00913000
*/* BEGIN MISCELLANEOUS DECLARATION                                  */ 00914000
*                                                                  0176 00915000
*   DECLARE                                                        0176 00916000
*     ISTEXT                        /* PARAMETER 1 - TEXT TO BE    0176 00917000
*                                      INSERTED INTO THE INTERNAL  0176 00918000
*                                      PAGE IMAGE                    */ 00919000
*         CHARACTER(*),                                            0176 00920000
*     ISTXTLEN                      /* PARAMETER 2 - TEXT LENGTH     */ 00921000
*         FIXED BINARY(31),                                        0176 00922000
*     ISBEGLIN                      /* PARAMETER 3 - LINE ON WHICH TO   00923000
*                                      BEGIN INSERTING TEXT          */ 00924000
*         FIXED BINARY(31),                                        0176 00925000
*     ISBEGCOL                      /* PARAMETER 4 - COLUMN ON WHICH    00926000
*                                      TO BEGIN INSERTING TEXT       */ 00927000
*         FIXED BINARY(31),                                        0176 00928000
*     ISLSTCOL                      /* LAST COLUMN - TEMPORARY VBL.  */ 00929000
*         FIXED BINARY(31);                                        0176 00930000
*                                                                  0177 00931000
*/* BEGIN MAINLINE PROCESSING                                        */ 00932000
*                                                                  0177 00933000
*   /*****************************************************************/ 00934000
*   /*                                                               */ 00935000
*   /* CHECK PARAMETERS FOR VALIDITY                                 */ 00936000
*   /*                                                               */ 00937000
*   /*****************************************************************/ 00938000
*                                                                  0177 00939000
*   ISLSTCOL=ISBEGCOL+ISTXTLEN-1;                                  0177 00940000
*                                                                  0177 00941000
         L     @10,@PC00002+12                                     0177 00942000
         L     @10,ISBEGCOL(,@10)                                  0177 00943000
         L     @15,@PC00002+4                                      0177 00944000
         L     @15,ISTXTLEN(,@15)                                  0177 00945000
         LR    ISLSTCOL,@10                                        0177 00946000
         AR    ISLSTCOL,@15                                        0177 00947000
         BCTR  ISLSTCOL,0                                          0177 00948000
*   /*****************************************************************/ 00949000
*   /*                                                               */ 00950000
*   /* SET UP TEMPORARY VARIABLE FOR LAST COLUMN IN WHICH TO INSERT  */ 00951000
*   /* TEXT                                                          */ 00952000
*   /*                                                               */ 00953000
*   /*****************************************************************/ 00954000
*                                                                  0178 00955000
*   IF ISTXTLEN<=0|                 /* NO TEXT TO INSERT             */ 00956000
*       ISBEGLIN<=0|                /* BEGINNING LINE NEGATIVE OR  0178 00957000
*                                      ZERO                          */ 00958000
*       ISBEGCOL<=0|                /* BEGINNING COLUMN NEGATIVE OR     00959000
*                                      ZERO                          */ 00960000
*       ISBEGLIN>RGMAXLN|           /* BEGINNING LINE HIGHER THAN  0178 00961000
*                                      MAXIMUM LINE NUMBER           */ 00962000
*       ISLSTCOL>RGMAXCOL THEN      /* TEXT WILL NOT FIT ON LINE     */ 00963000
         SR    @05,@05                                             0178 00964000
         CR    @15,@05                                             0178 00965000
         BNH   @RT00178                                            0178 00966000
         L     @15,@PC00002+8                                      0178 00967000
         L     @15,ISBEGLIN(,@15)                                  0178 00968000
         CR    @15,@05                                             0178 00969000
         BNH   @RT00178                                            0178 00970000
         CR    @10,@05                                             0178 00971000
         BNH   @RT00178                                            0178 00972000
         CH    @15,@CH00339                                        0178 00973000
         BH    @RT00178                                            0178 00974000
         CH    ISLSTCOL,@CH00372                                   0178 00975000
         BNH   @RF00178                                            0178 00976000
@RT00178 DS    0H                                                  0179 00977000
*     RETURN CODE(4);               /* RETURN TO REPORT GENERATOR.   */ 00978000
         LA    @15,4                                               0179 00979000
         L     @14,12(,@13)                                        0179 00980000
         LM    @00,@12,20(@13)                                     0179 00981000
         BR    @14                                                 0179 00982000
*   RGLINE(ISBEGLIN,ISBEGCOL:ISLSTCOL)=ISTEXT(1:ISTXTLEN);/* INSERT     00983000
*                                      TEXT                          */ 00984000
@RF00178 L     @10,@PC00002+8                                      0180 00985000
         L     @10,ISBEGLIN(,@10)                                  0180 00986000
         LR    @05,@10                                             0180 00987000
         MH    @05,@CH00789                                        0180 00988000
         L     @15,@PC00002+12                                     0180 00989000
         L     @15,ISBEGCOL(,@15)                                  0180 00990000
         LR    @14,@05                                             0180 00991000
         AR    @14,@15                                             0180 00992000
         LA    @01,RGLINE-127(@14)                                 0180 00993000
         LCR   @15,@15                                             0180 00994000
         AR    @15,ISLSTCOL                                        0180 00995000
         L     @14,@PC00002                                        0180 00996000
         EX    @15,@SM00796                                        0180 00997000
*   RGLENGTH(ISBEGLIN)=MAX(RGLENGTH(ISBEGLIN),ISLSTCOL);/* SET NEW 0181 00998000
*                                      LENGTH FOR RECORD             */ 00999000
         LH    @15,RGLENGTH-126(@05)                               0181 01000000
         CR    @15,ISLSTCOL                                        0181 01001000
         BNL   *+6                                                      01002000
         LR    @15,ISLSTCOL                                        0181 01003000
         STH   @15,RGLENGTH-126(@05)                               0181 01004000
*   RGLASTLN=MAX(RGLASTLN,ISBEGLIN);/* SET NEW LAST LINE CONTAINING     01005000
*                                      NON-BLANK CHARACTERS          */ 01006000
         LH    @15,RGLASTLN                                        0182 01007000
         CR    @15,@10                                             0182 01008000
         BNL   *+6                                                      01009000
         LR    @15,@10                                             0182 01010000
         STH   @15,RGLASTLN                                        0182 01011000
*   RETURN CODE(0);                 /* RETURN TO REPORT GENERATOR.   */ 01012000
         SR    @15,@15                                             0183 01013000
         L     @14,12(,@13)                                        0183 01014000
         LM    @00,@12,20(@13)                                     0183 01015000
         BR    @14                                                 0183 01016000
*   END;                                                           0184 01017000
*                                                                  0185 01018000
*/*                                                                  */ 01019000
*/*** START OF SPECIFICATIONS ****************************************  01020000
*                                                                    */ 01021000
*/*                                                                  */ 01022000
*/* SUBROUTINE-NAME = MFHRDISR                                       */ 01023000
*/*                                                                  */ 01024000
*/* DESCRIPTIVE-NAME = REPORT HEADER INSERTION ROUTINE               */ 01025000
*/*                                                                  */ 01026000
*/* FUNCTION = BUILDS AND INSERTS A STANDARD REPORT HEADER INTO THE  */ 01027000
*/*            INTERNAL PAGE IMAGE.  DATA IS OBTAINED FROM AN SMF    */ 01028000
*/*            RECORD HEADER WHICH IS PASSED ON INPUT.               */ 01029000
*/*                                                                  */ 01030000
*/* ENTRY-POINT = MFHDRISR                                           */ 01031000
*/*                                                                  */ 01032000
*/*    PURPOSE = SEE FUNCTION                                        */ 01033000
*/*                                                                  */ 01034000
*/*    LINKAGE = R1 - PARAMETER LIST ADDRESS                         */ 01035000
*/*                                                                  */ 01036000
*/* INPUT = PARAMETER 1 - ADDRESS OF SMF RECORD HEADER AND MF/1      */ 01037000
*/*                       COMMON CONTROL DATA AREA                   */ 01038000
*/*         PARAMETER 2 - TITLE TEXT                                 */ 01039000
*/*         PARAMETER 3 - TITLE LENGTH                               */ 01040000
*/*         PARAMETER 4 - PAGE NUMBER                                */ 01041000
*/*                                                                  */ 01042000
*/**** END OF SPECIFICATIONS *****************************************  01043000
*                                                                    */ 01044000
*/*                                                                  */ 01045000
*/* HEADER SUBROUTINE                                                */ 01046000
*                                                                  0185 01047000
*MFHDRISR:                                                         0185 01048000
*   PROCEDURE(HDRECPTR,             /* POINTER TO INTERNAL IMAGE OF     01049000
*                                      AN SMF RECRD                  */ 01050000
*       HDTITLE,                    /* TITLE TEXT                    */ 01051000
*       HDTITLEN,                   /* TITLE LENGTH                  */ 01052000
*       HDPAGE)                     /* PAGE NUMBER                   */ 01053000
*       ;                                                          0185 01054000
MFHDRISR STM   @14,@12,@SA00003                                    0185 01055000
         MVC   @PC00003(16),0(@01)                                 0185 01056000
*                                                                  0186 01057000
*/* BEGIN MACRO DECLARATIONS                                         */ 01058000
*                                                                  0186 01059000
*   /*****************************************************************/ 01060000
*   /*                                                               */ 01061000
*   /* INCLUDE A DECLARATION FOR THE SMF HEADER AND COMMON MF/1      */ 01062000
*   /* CONTROL DATA. ANY MF/1-GENERATED SMF RECORD WILL DO           */ 01063000
*   /*                                                               */ 01064000
*   /*****************************************************************/ 01065000
*                                                                  0186 01066000
*/*                                                                  */ 01067000
*/*  MACMEAN IFASMFR MEANS SYSTEM MANAGEMENT FACILITY RECORD MAPPING */ 01068000
*/*  MACCOMP Y-2 SC102/BL27P                                         */ 01069000
*/*  MACSTAT Y-2 73298/42020                                         */ 01070000
*/*  METHOD OF ACCESS                                                */ 01071000
*/*   PL/S - USER DEFINES MACRO VARIABLE IFARXX WHERE XX=RECORD NUM  */ 01072000
*/*          DECLARE SMFXXPTR PTR(31) OR RESPECIFY FOR BASE          */ 01073000
*/*          INCLUDE MACRO FROM LIBRARY                              */ 01074000
*/*           EXAMPLE %IFAR08 = 'YES',           NOTE. THE COMMA REP-*/ 01075000
*/*                   DCL SMF08PTR PTR(31),      RESENTS A SEMI-COLON*/ 01076000
*/*                   %INCLUDE SYSLIB(IFASMFR),  BUT ISN'T TO AVIOD  */ 01077000
*/*                                              A DIAGNOSTIC.       */ 01078000
*/*           ALLOWABLE RECORD TYPES ARE 00,02-11,14,17-22,26,       */ 01079000
*/*           31,34,35,40,43,45,47-49,62,64,68-74.                   */ 01080000
*/*           15 CAN BE SPECIFIED BUT TYPE 14 IS CREATED FOR IT.     */ 01081000
*                                                                  0186 01082000
*   DCL                                                            0186 01083000
*     1 SMFRCD70 BASED(SMF70PTR)BDY(WORD),                         0186 01084000
*                                                                  0186 01085000
*/* RECORD TYPE 70 - CPU ACTIVITY                                    */ 01086000
*                                                                  0186 01087000
*       3 SMF70LEN FIXED(15),       /* RDW RECORD LENGTH             */ 01088000
*       3 SMF70SEG FIXED(15),       /* RDW SEGMENT DESCRIPTOR        */ 01089000
*       3 SMF70FLG BIT(8),          /* OPERATING ENVIRONMENT         */ 01090000
*       3 SMF70RTY FIXED(8),        /* RECORD TYPE 70                */ 01091000
*       3 SMF70TME FIXED(31)BDY(BYTE),/* TOD RECORD WRITTEN          */ 01092000
*       3 SMF70DTE CHAR(4),         /* DATE RECORD WRITTEN           */ 01093000
*       3 SMF70SID CHAR(4),         /* SYSTEM ID FROM INSTALLATION   */ 01094000
*                                                                  0186 01095000
*         /***********************************************************/ 01096000
*         /*                                                         */ 01097000
*         /* COMMON CONTROL DATA                                     */ 01098000
*         /*                                                         */ 01099000
*         /***********************************************************/ 01100000
*                                                                  0186 01101000
*       3 SMF70SIZ PTR(15),         /* SIZE OF COMMON CONTROL DATA 0186 01102000
*                                      AREA                          */ 01103000
*       3 SMF70IST CHAR(4),         /* TOD INTERVAL START 0HHMMSSF   */ 01104000
*       3 SMF70DAT CHAR(4),         /* DATE INTERVAL START 00YYDDDF  */ 01105000
*       3 SMF70INT CHAR(4),         /* DURATION OF INTERVAL MMSSTTTF */ 01106000
*       3 SMF70CYC CHAR(2),         /* RESV                          */ 01107000
*       3 SMF70SUB CHAR(2),         /* RESV                          */ 01108000
*       3 SMF70SAM FIXED(32),       /* RESV                          */ 01109000
*       3 SMF70MFV CHAR(2),         /* MF/1 VERSION #                */ 01110000
*       3 SMF70RV1 CHAR(2),         /* RESV                          */ 01111000
*       3 SMF70RLS CHAR(4);         /* OP SYS REL # & LEVEL NNLL     */ 01112000
*                                                                  0186 01113000
*/* CPU CONTROL AREA VARIABLES                                       */ 01114000
*                                                                  0187 01115000
*   DCL                                                            0187 01116000
*     1 SMF70A BASED(ADDR(SMF70SIZ)+SMF70SIZ)BDY(WORD),            0187 01117000
*       3 SMF70SCC PTR(15),         /* SIZE OF CPU CONTROL AREA      */ 01118000
*       3 SMF70CPU FIXED(15),       /* # CPU MEASUREMENTS IN CPU DATA*/ 01119000
*       3 SMF70SCD FIXED(15),       /* SIZE OF EACH CPU DATA AREA    */ 01120000
*       3 SMF70RV2 CHAR(2);         /* RESV                          */ 01121000
*                                                                  0187 01122000
*/* CPU DATA AREA VARIABLES                                          */ 01123000
*                                                                  0188 01124000
*   DCL                                                            0188 01125000
*     1 SMF70B(*)BASED(ADDR(SMF70SCC)+SMF70SCC)BDY(WORD),          0188 01126000
*       3 SMF70WAT CHAR(8),         /* CPU WAIT, TOD CLOCK FORMAT    */ 01127000
*       3 SMF70CID FIXED(15),       /* CPU IDENTIFIER                */ 01128000
*       3 SMF70RV3 CHAR(1),         /* RESV                          */ 01129000
*       3 SMF70CNF BIT(8),          /* CONFIGURATION ACTIVITY        */ 01130000
*         5 * BIT(6),               /* RESV                          */ 01131000
*         5 SMF70VAC BIT(1),        /* DATA INVALID, VARIED ON OR OFF*/ 01132000
*         5 SMF70STA BIT(1),        /* =1 FOR ONLINE AT END OF     0188 01133000
*                                      INTERVAL                      */ 01134000
*       3 SMF70RV4 CHAR(1),         /* RESV                          */ 01135000
*       3 SMF70SER CHAR(3);         /* CPU SERIAL # FORM HHHHHH      */ 01136000
*                                                                  0189 01137000
*/* BEGIN MISCELLANEOUS DECLARATIONS                                 */ 01138000
*                                                                  0189 01139000
*   DECLARE                                                        0189 01140000
*     HDRECPTR                      /* PARAMETER 1 - POINTER TO    0189 01141000
*                                      INTERNAL SMF RECORD IMAGE     */ 01142000
*         POINTER(31),                                             0189 01143000
*     HDTITLE                       /* PARAMETER 2 - TITLE TEXT TO BE   01144000
*                                      INSERTED                      */ 01145000
*         CHARACTER(*),                                            0189 01146000
*     HDTITLEN                      /* PARAMETER 3 - TITLE LENGTH    */ 01147000
*         FIXED BINARY(31),                                        0189 01148000
*     HDPAGE                        /* PARAMETER 4 - PAGE NUMBER     */ 01149000
*         FIXED BINARY(31),                                        0189 01150000
*     SMF70PTR                      /* UNUSED SMF RECORD POINTER     */ 01151000
*         POINTER(31)BASED,                                        0189 01152000
*     HDWRKSTR                      /* WORKING STRING                */ 01153000
*         CHARACTER(20),                                           0189 01154000
*     HDUNPKST                      /* STRING USED TO UNPACK PACKED     01155000
*                                      DECIMAL DATA                  */ 01156000
*         CHARACTER(7),                                            0189 01157000
*     HDDAYS                        /* DAYS IN MONTH                 */ 01158000
*         (12)FIXED BINARY(15)INITIAL(31,/* JANUARY                  */ 01159000
*         28,                       /* FEBRUARY                      */ 01160000
*         31,                       /* MARCH                         */ 01161000
*         30,                       /* APRIL                         */ 01162000
*         31,                       /* MAY                           */ 01163000
*         30,                       /* JUNE                          */ 01164000
*         31,                       /* JULY                          */ 01165000
*         31,                       /* AUGUST                        */ 01166000
*         30,                       /* SEPTEMBER                     */ 01167000
*         31,                       /* OCTOBER                       */ 01168000
*         30,                       /* NOVEMBER                      */ 01169000
*         31),                      /* DECEMBER                      */ 01170000
*     HDRELEAS                      /* FIXED BINARY OS/VS SYSTEM   0189 01171000
*                                      NUMBER                        */ 01172000
*         FIXED BINARY(8)DEFINED(SMF70FLG),                        0189 01173000
*     HDTOTDAY                      /* USED TO CALCULATE MONTH AND 0189 01174000
*                                      DAY FROM THE JULIAN DATE      */ 01175000
*         FIXED BINARY(31),                                        0189 01176000
*     HDBINDAY                      /* BINARY DAY OF MONTH           */ 01177000
*         FIXED BINARY(31),                                        0189 01178000
*     HDBINYR                       /* BINARY YEAR                   */ 01179000
*         FIXED BINARY(31),                                        0189 01180000
*     HDCVBSRC                      /* CONVERT TO BINARY INSTRUCTION    01181000
*                                      SOURCE FIELD                  */ 01182000
*         CHARACTER(2),                                            0189 01183000
*     HDLOOPV                       /* LOOP VARIABLE                 */ 01184000
*         FIXED BINARY(31),                                        0189 01185000
*     HDBINMO                       /* MONTH OF YEAR IN BINARY       */ 01186000
*         FIXED BINARY(31),                                        0189 01187000
*     IRBMFLTV                      /* LANGUAGE PART VECTOR TABLE    */ 01188000
*         (*)POINTER(31)EXTERNAL NONLOCAL;                         0189 01189000
*                                                                  0190 01190000
*/* MACRO DECLARATIONS                                               */ 01191000
*/*  LANGUAGE PARTS TABLE                                            */ 01192000
*/**** START OF SPECIFICATIONS ***************************************/ 01193000
*/*                                                                  */ 01194000
*/* MACCOMP Y-2 SC1CQ/GAM20                                          */ 01195000
*/* MACSTAT Y-2 73121/Y02150                                         */ 01196000
*/* MACMEAN MFLNG MEANS LANGUAGE PARTS                               */ 01197000
*/*                                                                  */ 01198000
*/* MODULE-NAME = IRBMFLNG                                           */ 01199000
*/*                                                                  */ 01200000
*/* DESCRIPTIVE-NAME = LANGUAGE PARTS                                */ 01201000
*/*                                                                  */ 01202000
*/* COPYRIGHT = NONE                                                 */ 01203000
*/*                                                                  */ 01204000
*/* STATUS = RELEASE 2, VERSION 0                                    */ 01205000
*/*                                                                  */ 01206000
*/* FUNCTION = MAPPING MACRO FOR THE MFLNG.  IT DEFINES THE LOCATION */ 01207000
*/*            AND SIZE OF MF/1 COMMON-LANGUAGE PARTS.               */ 01208000
*/*                                                                  */ 01209000
*/* NOTES = SEE BELOW                                                */ 01210000
*/*                                                                  */ 01211000
*/* MODULE-TYPE = PLS MAPPING MACRO                                  */ 01212000
*/*                                                                  */ 01213000
*/* CHANGE-ACTIVITY =                                                */ 01214000
*/*                                                                  */ 01215000
*/* A000000-999999                                             Y02150*/ 01216000
*/*                                                                  */ 01217000
*/* METHOD-OF-INVOCATION = SEE BELOW                                 */ 01218000
*/*                                                                  */ 01219000
*/*    PLS - .QUESTION MARK.IRBMFLNG ATTRIBUT(ATTRIBUTES)            */ 01220000
*/*          WHERE ATTRIBUTES ARE ANY ACCEPTABLE PLS ATTRIBUTES      */ 01221000
*/*          FOR STRUCTURE DECLARATIONS.                             */ 01222000
*/*                                                                  */ 01223000
*/**** END OF SPECIFICATIONS *****************************************/ 01224000
*                                                                  0190 01225000
*   /*****************************************************************/ 01226000
*   /*                                                               */ 01227000
*   /* ?IRBMFLNG ATTRIBUT(DEFINED(IRBMFLTV))                         */ 01228000
*   /*                                                               */ 01229000
*   /*****************************************************************/ 01230000
*                                                                  0190 01231000
*   DECLARE                                                        0190 01232000
*     1 LNG                         /* LANGUAGE PARTS                */ 01233000
*           DEFINED(IRBMFLTV)BDY(WORD),                            0190 01234000
*      2 LNGTPTR                    /* TEXT POINTER                  */ 01235000
*            (*)PTR(31),                                           0190 01236000
*     1 LNGTXT                      /* TEXT                          */ 01237000
*           BDY(WORD)BASED,                                        0190 01238000
*      2 LNGTXTL                    /* TEXT LENGTH                   */ 01239000
*            FIXED(31),                                            0190 01240000
*      2 LNGTXTD                    /* TEXT DATA                     */ 01241000
*            CHAR(*);                                              0190 01242000
*                                                                  0190 01243000
*/*  LANGUAGE PARTS CONSTANTS                                        */ 01244000
*/*                                                                  */ 01245000
*/**** START OF SPECIFICATIONS ***************************************/ 01246000
*/*                                                                  */ 01247000
*/* MACCOMP Y-2 SC1CQ/GAM20                                          */ 01248000
*/* MACSTAT Y-2 73114/Y02150                                         */ 01249000
*/*                                                                  */ 01250000
*/* MODULE-NAME = IRBMFLTM                                           */ 01251000
*/*                                                                  */ 01252000
*/* DESCRIPTIVE-NAME = LANGUAGE PART INDEX CONSTANTS FOR LANGUAGE    */ 01253000
*/*                    PARTS MODULE IRBMFLTV                         */ 01254000
*/*                                                                  */ 01255000
*/* COPYRIGHT = NONE                                                 */ 01256000
*/*                                                                  */ 01257000
*/* STATUS = RELEASE 2 / VERSION 0                                   */ 01258000
*/*                                                                  */ 01259000
*/* FUNCTION = PROVIDES SYMBOLIC NAMES FOR REFERENCES TO LANGUAGE    */ 01260000
*/*            PARTS                                                 */ 01261000
*/*                                                                  */ 01262000
*/* NOTES = NONE                                                     */ 01263000
*/*                                                                  */ 01264000
*/* MODULE-TYPE = PLS MACRO                                          */ 01265000
*/*                                                                  */ 01266000
*/* CHANGE-ACTIVITY = SEE BELOW                                      */ 01267000
*/*                                                                  */ 01268000
*/* A000000-999999                                             Y02150*/ 01269000
*/*                                                                  */ 01270000
*/* METHOD-OF-INVOCATION = SEE BELOW                                 */ 01271000
*/*                                                                  */ 01272000
*/*    PLS - %INCLUDE DDNAME(IRBMFLTM)                               */ 01273000
*/*                                                                  */ 01274000
*/**** END OF SPECIFICATIONS *****************************************/ 01275000
*/*                                                                  */ 01276000
*                                                                  0191 01277000
*   DECLARE                                                        0191 01278000
*     LTPART1                       /* 'PAGE '                       */ 01279000
*         FIXED BINARY(31)CONSTANT(1),                             0191 01280000
*     LTPART2                       /* 'OS/VS'                       */ 01281000
*         FIXED BINARY(31)CONSTANT(2),                             0191 01282000
*     LTPART3                       /* 'RELEASE '                    */ 01283000
*         FIXED BINARY(31)CONSTANT(3),                             0191 01284000
*     LTPART4                       /* 'SYSTEM ID '                  */ 01285000
*         FIXED BINARY(31)CONSTANT(4),                             0191 01286000
*     LTPART5                       /* 'MF/1 VERSION '               */ 01287000
*         FIXED BINARY(31)CONSTANT(5),                             0191 01288000
*     LTPART6                       /* 'DATE '                       */ 01289000
*         FIXED BINARY(31)CONSTANT(6),                             0191 01290000
*     LTPART7                       /* 'TIME '                       */ 01291000
*         FIXED BINARY(31)CONSTANT(7),                             0191 01292000
*     LTPART8                       /* 'INTERVAL '                   */ 01293000
*         FIXED BINARY(31)CONSTANT(8),                             0191 01294000
*     LTPART9                       /* 'CYCLE '                      */ 01295000
*         FIXED BINARY(31)CONSTANT(9),                             0191 01296000
*     LTPART10                      /* ' SECONDS'                    */ 01297000
*         FIXED BINARY(31)CONSTANT(10);                            0191 01298000
*                                                                  0192 01299000
*/* BEGIN CONSTANTS DECLARATIONS                                     */ 01300000
*                                                                  0192 01301000
*   DECLARE                                                        0192 01302000
*     HDDALEAP                      /* EXTRA DAY IN LEAP YEAR CYCLE. */ 01303000
*         CONSTANT(1),                                             0192 01304000
*     HDMONFEB                      /* MONTH NUMBER OF FEBRUARY.     */ 01305000
*         CONSTANT(2),                                             0192 01306000
*     HDYRLEAP                      /* YEARS IN LEAP YEAR CYCLE.     */ 01307000
*         CONSTANT(4),                                             0192 01308000
*     HDNOSAMP                      /* SMF CYCLE FIELD VALUE WHEN  0192 01309000
*                                      SAMPLING IS NOT USED - CYCLE=0*/ 01310000
*         BIT(16)CONSTANT('000F'X);                                0192 01311000
*                                                                  0193 01312000
*/* BEGIN GENERAL INITIALIZATION                                     */ 01313000
*                                                                  0193 01314000
*   /*****************************************************************/ 01315000
*   /*                                                               */ 01316000
*   /* PROVIDE ADDRESSABILITY FOR SMF RECORD INTERNAL HEADER         */ 01317000
*   /*                                                               */ 01318000
*   /*****************************************************************/ 01319000
*                                                                  0193 01320000
*   RESPECIFY                                                      0193 01321000
*     SMFRCD70 BASED(HDRECPTR);                                    0193 01322000
*                                                                  0194 01323000
*/* BEGIN MAINLINE PROCESSING                                        */ 01324000
*                                                                  0194 01325000
*   /*****************************************************************/ 01326000
*   /*                                                               */ 01327000
*   /* INSERT TITLE UP TO MAXIMUM LENGTH OF RGMAXCOL COLUMN          */ 01328000
*   /*                                                               */ 01329000
*   /*****************************************************************/ 01330000
*                                                                  0194 01331000
*   IF HDTITLEN>0 THEN              /* IF A TITLE IS DESIRED         */ 01332000
         L     @10,@PC00003+8                                      0194 01333000
         L     @10,HDTITLEN(,@10)                                  0194 01334000
         LTR   @10,@10                                             0194 01335000
         BNP   @RF00194                                            0194 01336000
*     CALL MFISRTXT(                /* TEXT INSERTION ROUTINE        */ 01337000
*                                                                  0195 01338000
*     /***************************************************************/ 01339000
*     /*                                                             */ 01340000
*     /* TITLE TO INSERT                                             */ 01341000
*     /*                                                             */ 01342000
*     /***************************************************************/ 01343000
*                                                                  0195 01344000
*         HDTITLE,                                                 0195 01345000
*                                                                  0195 01346000
*     /***************************************************************/ 01347000
*     /*                                                             */ 01348000
*     /* TITLE LENGTH                                                */ 01349000
*     /*                                                             */ 01350000
*     /***************************************************************/ 01351000
*                                                                  0195 01352000
*         MIN(HDTITLEN,RGMAXCOL),                                  0195 01353000
*                                                                  0195 01354000
*     /***************************************************************/ 01355000
*     /*                                                             */ 01356000
*     /* INSERTION LINE                                              */ 01357000
*     /*                                                             */ 01358000
*     /***************************************************************/ 01359000
*                                                                  0195 01360000
*         RGHDR1,                                                  0195 01361000
*                                                                  0195 01362000
*     /***************************************************************/ 01363000
*     /*                                                             */ 01364000
*     /* INSERTION COLUMN (CENTERED)                                 */ 01365000
*     /*                                                             */ 01366000
*     /***************************************************************/ 01367000
*                                                                  0195 01368000
*         (RGMAXCOL-MIN(HDTITLEN,RGMAXCOL))/2+1);                  0195 01369000
*                                                                  0195 01370000
         L     @15,@PC00003+4                                      0195 01371000
         ST    @15,@AL00001                                        0195 01372000
         LA    @15,120                                             0195 01373000
         CR    @10,@15                                             0195 01374000
         BNH   *+6                                                      01375000
         LR    @10,@15                                             0195 01376000
         ST    @10,@AFTEMPS                                        0195 01377000
         LA    @14,@AFTEMPS                                        0195 01378000
         ST    @14,@AL00001+4                                      0195 01379000
         LA    @14,@CF00072                                        0195 01380000
         ST    @14,@AL00001+8                                      0195 01381000
         LR    @00,@15                                             0195 01382000
         SR    @00,@10                                             0195 01383000
         SRDA  @00,32                                              0195 01384000
         D     @00,@CF00089                                        0195 01385000
         AH    @01,@CH00072                                        0195 01386000
         ST    @01,@AFTEMPS+4                                      0195 01387000
         LA    @10,@AFTEMPS+4                                      0195 01388000
         ST    @10,@AL00001+12                                     0195 01389000
         LA    @01,@AL00001                                        0195 01390000
         BAL   @14,MFISRTXT                                        0195 01391000
*   /*****************************************************************/ 01392000
*   /*                                                               */ 01393000
*   /* INSERT PAGE XXXX                                              */ 01394000
*   /*                                                               */ 01395000
*   /*****************************************************************/ 01396000
*                                                                  0196 01397000
*   HDWRKSTR(1:5)=LNGTPTR(LTPART1)->LNGTXTD(1:LNGTPTR(LTPART1)->LNGTXTL 01398000
*       );                                                         0196 01399000
@RF00194 MVI   HDWRKSTR+1,C' '                                     0196 01400000
         MVC   HDWRKSTR+2(3),HDWRKSTR+1                            0196 01401000
         L     @10,@CA00736                                        0196 01402000
         L     @10,LNGTPTR-IRBMFLTV(,@10)                          0196 01403000
         L     @15,LNGTXTL(,@10)                                   0196 01404000
         BCTR  @15,0                                               0196 01405000
         EX    @15,@SM00798                                        0196 01406000
*   CALL IRBMFCNV(                  /* CONVERSION PROGRAM            */ 01407000
*       HDPAGE,                     /* BINARY INPUT                  */ 01408000
*       0,                          /* INPUT SCALE FACTOR            */ 01409000
*       HDWRKSTR(6:9),              /* OUTPUT STRING                 */ 01410000
*       4,                          /* OUTPUT STRING LENGTH          */ 01411000
*       0,                          /* DIGITS TO THE RIGHT OF THE  0197 01412000
*                                      DECIMAL POINT ON OUTPUT       */ 01413000
*       '0'B,                       /* NO COMMAS                     */ 01414000
*       '0'B);                      /* NO FLOAT                      */ 01415000
         MVC   @AL00001+4(24),@AL00197                             0197 01416000
         L     @10,@PC00003+12                                     0197 01417000
         ST    @10,@AL00001                                        0197 01418000
         LA    @10,HDWRKSTR+5                                      0197 01419000
         ST    @10,@AL00001+8                                      0197 01420000
         L     @15,RGVECTAB                                        0197 01421000
         LA    @01,@AL00001                                        0197 01422000
         BALR  @14,@15                                             0197 01423000
*   CALL MFISRTXT(                  /* INSERT TEXT PROGRAM           */ 01424000
*       HDWRKSTR,                   /* TEXT                          */ 01425000
*       9,                          /* LENGTH                        */ 01426000
*       2,                          /* START LINE                    */ 01427000
*       RGMAXCOL-8);                /* START COLUMN                  */ 01428000
*                                                                  0198 01429000
         MVC   @AL00001+4(12),@AL00198                             0198 01430000
         LA    @10,HDWRKSTR                                        0198 01431000
         ST    @10,@AL00001                                        0198 01432000
         LA    @01,@AL00001                                        0198 01433000
         BAL   @14,MFISRTXT                                        0198 01434000
*   /*****************************************************************/ 01435000
*   /*                                                               */ 01436000
*   /* INSERT OS/VSN                                                 */ 01437000
*   /*                                                               */ 01438000
*   /*****************************************************************/ 01439000
*                                                                  0199 01440000
*   HDWRKSTR(1:5)=LNGTPTR(LTPART2)->LNGTXTD(1:LNGTPTR(LTPART2)->LNGTXTL 01441000
*       );                                                         0199 01442000
         MVI   HDWRKSTR+1,C' '                                     0199 01443000
         MVC   HDWRKSTR+2(3),HDWRKSTR+1                            0199 01444000
         L     @10,@CA00736                                        0199 01445000
         L     @10,LNGTPTR-IRBMFLTV+4(,@10)                        0199 01446000
         L     @15,LNGTXTL(,@10)                                   0199 01447000
         BCTR  @15,0                                               0199 01448000
         EX    @15,@SM00798                                        0199 01449000
*   CALL IRBMFCNV(                  /* CONVERSION PROGRAM            */ 01450000
*       EVAL(HDRELEAS),             /* SYSTEM NUMBER IN FULLWORD     */ 01451000
*       0,                          /* INTEGER INPUT                 */ 01452000
*       HDWRKSTR(6),                /* OUTPUT STRING                 */ 01453000
*       1,                          /* OUTPUT LENGTH                 */ 01454000
*       0,                          /* INTEGER OUTPUT                */ 01455000
*       '0'B,                       /* NO COMMAS                     */ 01456000
*       '0'B);                      /* NO FLOAT                      */ 01457000
         MVC   @AL00001+4(24),@AL00200                             0200 01458000
         L     @10,@PC00003                                        0200 01459000
         L     @10,HDRECPTR(,@10)                                  0200 01460000
         SR    @15,@15                                             0200 01461000
         IC    @15,HDRELEAS(,@10)                                  0200 01462000
         ST    @15,@AFTEMPS                                        0200 01463000
         LA    @10,@AFTEMPS                                        0200 01464000
         ST    @10,@AL00001                                        0200 01465000
         LA    @10,HDWRKSTR+5                                      0200 01466000
         ST    @10,@AL00001+8                                      0200 01467000
         L     @15,RGVECTAB                                        0200 01468000
         LA    @01,@AL00001                                        0200 01469000
         BALR  @14,@15                                             0200 01470000
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */ 01471000
*       HDWRKSTR,                   /* STRING TO INSERT              */ 01472000
*       6,                          /* LENGTH                        */ 01473000
*       RGHDR3,                     /* START LINE                    */ 01474000
*       RGCOLA);                    /* START COLUMN                  */ 01475000
*                                                                  0201 01476000
         MVC   @AL00001+4(12),@AL00201                             0201 01477000
         LA    @10,HDWRKSTR                                        0201 01478000
         ST    @10,@AL00001                                        0201 01479000
         LA    @01,@AL00001                                        0201 01480000
         BAL   @14,MFISRTXT                                        0201 01481000
*   /*****************************************************************/ 01482000
*   /*                                                               */ 01483000
*   /* INSERT RELEASE NN.NN                                          */ 01484000
*   /*                                                               */ 01485000
*   /*****************************************************************/ 01486000
*                                                                  0202 01487000
*   HDWRKSTR(1:8)=LNGTPTR(LTPART3)->LNGTXTD(1:LNGTPTR(LTPART3)->LNGTXTL 01488000
*       );                                                         0202 01489000
         MVI   HDWRKSTR+1,C' '                                     0202 01490000
         MVC   HDWRKSTR+2(6),HDWRKSTR+1                            0202 01491000
         L     @10,@CA00736                                        0202 01492000
         L     @10,LNGTPTR-IRBMFLTV+8(,@10)                        0202 01493000
         L     @15,LNGTXTL(,@10)                                   0202 01494000
         BCTR  @15,0                                               0202 01495000
         EX    @15,@SM00798                                        0202 01496000
*   HDWRKSTR(9:10)=SMF70RLS(1:2);                                  0203 01497000
         L     @10,@PC00003                                        0203 01498000
         L     @10,HDRECPTR(,@10)                                  0203 01499000
         MVC   HDWRKSTR+8(2),SMF70RLS(@10)                         0203 01500000
*   HDWRKSTR(11)='.';               /* INSERT SEPARATOR              */ 01501000
         MVI   HDWRKSTR+10,C'.'                                    0204 01502000
*   HDWRKSTR(12:13)=SMF70RLS(3:4);                                 0205 01503000
         MVC   HDWRKSTR+11(2),SMF70RLS+2(@10)                      0205 01504000
*   CALL MFISRTXT(                  /* INSERT TEXT ROUTINE           */ 01505000
*       HDWRKSTR,                   /* STRING TO INSERT              */ 01506000
*       13,                         /* LENGTH                        */ 01507000
*       RGHDR4,                     /* START LINE                    */ 01508000
*       RGCOLA);                    /* START COLUMN                  */ 01509000
*                                                                  0206 01510000
         MVC   @AL00001+4(12),@AL00206                             0206 01511000
         LA    @10,HDWRKSTR                                        0206 01512000
         ST    @10,@AL00001                                        0206 01513000
         LA    @01,@AL00001                                        0206 01514000
         BAL   @14,MFISRTXT                                        0206 01515000
*   /*****************************************************************/ 01516000
*   /*                                                               */ 01517000
*   /* INSERT SYSTEM ID XXXX                                         */ 01518000
*   /*                                                               */ 01519000
*   /*****************************************************************/ 01520000
*                                                                  0207 01521000
*   HDWRKSTR(1:10)=LNGTPTR(LTPART4)->LNGTXTD(1:LNGTPTR(LTPART4)->  0207 01522000
*       LNGTXTL);                                                  0207 01523000
         MVI   HDWRKSTR+1,C' '                                     0207 01524000
         MVC   HDWRKSTR+2(8),HDWRKSTR+1                            0207 01525000
         L     @10,@CA00736                                        0207 01526000
         L     @10,LNGTPTR-IRBMFLTV+12(,@10)                       0207 01527000
         L     @15,LNGTXTL(,@10)                                   0207 01528000
         BCTR  @15,0                                               0207 01529000
         EX    @15,@SM00798                                        0207 01530000
*   HDWRKSTR(11:14)=SMF70SID;       /* SYSTEM ID                     */ 01531000
         L     @10,@PC00003                                        0208 01532000
         L     @10,HDRECPTR(,@10)                                  0208 01533000
         MVC   HDWRKSTR+10(4),SMF70SID(@10)                        0208 01534000
*   CALL MFISRTXT(                  /* INSERT TEXT PROGRAM           */ 01535000
*       HDWRKSTR,                   /* TEXT                          */ 01536000
*       14,                         /* LENGTH                        */ 01537000
*       RGHDR3,                     /* START LINE                    */ 01538000
*       RGCOLB);                    /* START COLUMN                  */ 01539000
*                                                                  0209 01540000
         MVC   @AL00001+4(12),@AL00209                             0209 01541000
         LA    @10,HDWRKSTR                                        0209 01542000
         ST    @10,@AL00001                                        0209 01543000
         LA    @01,@AL00001                                        0209 01544000
         BAL   @14,MFISRTXT                                        0209 01545000
*   /*****************************************************************/ 01546000
*   /*                                                               */ 01547000
*   /* INSERT MF/1 VERSION NN                                        */ 01548000
*   /*                                                               */ 01549000
*   /*****************************************************************/ 01550000
*                                                                  0210 01551000
*   HDWRKSTR(1:13)=LNGTPTR(LTPART5)->LNGTXTD(1:LNGTPTR(LTPART5)->  0210 01552000
*       LNGTXTL);                                                  0210 01553000
         MVI   HDWRKSTR+1,C' '                                     0210 01554000
         MVC   HDWRKSTR+2(11),HDWRKSTR+1                           0210 01555000
         L     @10,@CA00736                                        0210 01556000
         L     @10,LNGTPTR-IRBMFLTV+16(,@10)                       0210 01557000
         L     @15,LNGTXTL(,@10)                                   0210 01558000
         BCTR  @15,0                                               0210 01559000
         EX    @15,@SM00798                                        0210 01560000
*   HDWRKSTR(14:15)=SMF70MFV;       /* MF/1 VERSION                  */ 01561000
         L     @10,@PC00003                                        0211 01562000
         L     @10,HDRECPTR(,@10)                                  0211 01563000
         MVC   HDWRKSTR+13(2),SMF70MFV(@10)                        0211 01564000
*   CALL MFISRTXT(                  /* INSERT TEXT PROGRAM           */ 01565000
*       HDWRKSTR,                   /* TEXT                          */ 01566000
*       15,                         /* LENGTH                        */ 01567000
*       RGHDR4,                     /* START LINE                    */ 01568000
*       RGCOLB);                    /* START COLUMN                  */ 01569000
*                                                                  0212 01570000
         MVC   @AL00001+4(12),@AL00212                             0212 01571000
         LA    @10,HDWRKSTR                                        0212 01572000
         ST    @10,@AL00001                                        0212 01573000
         LA    @01,@AL00001                                        0212 01574000
         BAL   @14,MFISRTXT                                        0212 01575000
*   /*****************************************************************/ 01576000
*   /*                                                               */ 01577000
*   /* INSERT DATE MM/DD/YY. SOURCE IS JULIAN DATE IN FORM 00YYDDDF  */ 01578000
*   /* FIRST CONVERT JULIAN DAY (DDD) INTO MONTH-DAY NOTATION (MMDD) */ 01579000
*   /*                                                               */ 01580000
*   /*****************************************************************/ 01581000
*                                                                  0213 01582000
*   CVB(HDBINDAY,SMF70DAT(3:4));    /* CONVERT DAY (DDDF) INTO BINARY*/ 01583000
         L     @10,@PC00003                                        0213 01584000
         L     @10,HDRECPTR(,@10)                                  0213 01585000
         XC    @TS00001(8),@TS00001                                0213 01586000
         MVC   @TS00001+6(2),SMF70DAT+2(@10)                       0213 01587000
         CVB   @10,@TS00001                                        0213 01588000
         ST    @10,HDBINDAY                                        0213 01589000
*   HDCVBSRC='000F'X;               /* INITIALIZE CVB SOURCE FIELD   */ 01590000
         MVC   HDCVBSRC(2),@CB00756                                0214 01591000
*   HDCVBSRC(1)=SMF70DAT(2);        /* MOVE IN YEAR TO GET FORMAT  0215 01592000
*                                      YY0F                          */ 01593000
         L     @10,@PC00003                                        0215 01594000
         L     @10,HDRECPTR(,@10)                                  0215 01595000
         MVC   HDCVBSRC(1),SMF70DAT+1(@10)                         0215 01596000
*   CVB(HDBINYR,HDCVBSRC);          /* GET YEARS TIMES TEN IN BINARY */ 01597000
         XC    @TS00001(8),@TS00001                                0216 01598000
         MVC   @TS00001+6(2),HDCVBSRC                              0216 01599000
         CVB   @10,@TS00001                                        0216 01600000
         ST    @10,HDBINYR                                         0216 01601000
*   HDBINYR=HDBINYR/10;             /* GET BINARY YEARS              */ 01602000
*                                                                  0217 01603000
         L     @00,HDBINYR                                         0217 01604000
         SRDA  @00,32                                              0217 01605000
         D     @00,@CF00512                                        0217 01606000
         ST    @01,HDBINYR                                         0217 01607000
*   /*****************************************************************/ 01608000
*   /*                                                               */ 01609000
*   /* NOW HAVE BINARY NUMBERS TO WORK WITH. SUM DAYS IN MONTH       */ 01610000
*   /* ADJUSTING FOR LEAP YEAR UNTIL GREATER THAN JULIAN DAY.        */ 01611000
*   /* (INDEX-1) WILL THEN BE THE MONTH                              */ 01612000
*   /*                                                               */ 01613000
*   /*****************************************************************/ 01614000
*                                                                  0218 01615000
*   HDTOTDAY=0;                     /* SET ACCUMULATOR TO ZERO       */ 01616000
         SR    HDTOTDAY,HDTOTDAY                                   0218 01617000
*   DO HDLOOPV=1 TO 12 WHILE(HDTOTDAY<HDBINDAY);                   0219 01618000
*                                                                  0219 01619000
         LA    HDLOOPV,1                                           0219 01620000
@DL00219 C     HDTOTDAY,HDBINDAY                                   0219 01621000
         BNL   @DC00219                                            0219 01622000
*     /***************************************************************/ 01623000
*     /*                                                             */ 01624000
*     /* TEST FOR FEBRUARY AND LEAP YEAR - FOR THE TWENTIETH CENTURY,*/ 01625000
*     /* THE LEAP YEAR WILL BE DIVISIBLE BY 4                        */ 01626000
*     /*                                                             */ 01627000
*     /***************************************************************/ 01628000
*                                                                  0220 01629000
*     IF HDLOOPV=HDMONFEB&          /* TRUE = FEBRUARY               */ 01630000
*         HDBINYR//HDYRLEAP=0 THEN  /* TRUE = LEAP YEAR              */ 01631000
         CH    HDLOOPV,@CH00089                                    0220 01632000
         BNE   @RF00220                                            0220 01633000
         L     @00,HDBINYR                                         0220 01634000
         SRDA  @00,32                                              0220 01635000
         D     @00,@CF00065                                        0220 01636000
         LTR   @00,@00                                             0220 01637000
         BNZ   @RF00220                                            0220 01638000
*       HDTOTDAY=HDTOTDAY+HDDALEAP; /* INCREMENT FEBRUARY FOR LEAP 0221 01639000
*                                      YEAR                          */ 01640000
         AH    HDTOTDAY,@CH00072                                   0221 01641000
*     HDTOTDAY=HDTOTDAY+HDDAYS(HDLOOPV);/* INCREMENT FOR DAYS IN   0222 01642000
*                                      MONTH                         */ 01643000
@RF00220 LR    @10,HDLOOPV                                         0222 01644000
         AR    @10,@10                                             0222 01645000
         AH    HDTOTDAY,HDDAYS-2(@10)                              0222 01646000
*   END;                                                           0223 01647000
*                                                                  0223 01648000
         AH    HDLOOPV,@CH00072                                    0223 01649000
         CH    HDLOOPV,@CH00516                                    0223 01650000
         BNH   @DL00219                                            0223 01651000
@DC00219 DS    0H                                                  0224 01652000
*   /*****************************************************************/ 01653000
*   /*                                                               */ 01654000
*   /* (INDEX-1) IS NOW MONTH AND THE DAY OF MONTH MAY NOW BE        */ 01655000
*   /* CALCULATED AND SAVED                                          */ 01656000
*   /*                                                               */ 01657000
*   /*****************************************************************/ 01658000
*                                                                  0224 01659000
*   HDBINMO=HDLOOPV-1;              /* INDEX-1 IS MONTH              */ 01660000
         LR    @10,HDLOOPV                                         0224 01661000
         BCTR  @10,0                                               0224 01662000
         ST    @10,HDBINMO                                         0224 01663000
*   HDBINDAY=HDDAYS(HDBINMO)-(HDTOTDAY-HDBINDAY);                  0225 01664000
*                                                                  0225 01665000
         LR    @05,@10                                             0225 01666000
         AR    @05,@05                                             0225 01667000
         LR    @15,HDTOTDAY                                        0225 01668000
         S     @15,HDBINDAY                                        0225 01669000
         LCR   @15,@15                                             0225 01670000
         AH    @15,HDDAYS-2(@05)                                   0225 01671000
         ST    @15,HDBINDAY                                        0225 01672000
*   /*****************************************************************/ 01673000
*   /*                                                               */ 01674000
*   /* ADJUST DAY OF MONTH FOR LEAP YEAR                             */ 01675000
*   /*                                                               */ 01676000
*   /*****************************************************************/ 01677000
*                                                                  0226 01678000
*   IF HDBINMO=HDMONFEB&            /* TRUE = FEBRUARY               */ 01679000
*       HDBINYR//HDYRLEAP=0 THEN    /* TRUE =LEAP YEAR               */ 01680000
         CH    @10,@CH00089                                        0226 01681000
         BNE   @RF00226                                            0226 01682000
         L     @00,HDBINYR                                         0226 01683000
         SRDA  @00,32                                              0226 01684000
         D     @00,@CF00065                                        0226 01685000
         LTR   @00,@00                                             0226 01686000
         BNZ   @RF00226                                            0226 01687000
*     HDBINDAY=HDBINDAY+HDDALEAP;                                  0227 01688000
*                                                                  0227 01689000
         AH    @15,@CH00072                                        0227 01690000
         ST    @15,HDBINDAY                                        0227 01691000
*   /*****************************************************************/ 01692000
*   /*                                                               */ 01693000
*   /* HDBINDAY NOW CONTAINS DAY OF MONTH. HDBINMO CONTAINS MONTH.   */ 01694000
*   /* HDBINYR CONTAINS YEAR. BUILD STRING TO INSERT INTO PAGE IMAGE.*/ 01695000
*   /* INSERT 'DATE '                                                */ 01696000
*   /*                                                               */ 01697000
*   /*****************************************************************/ 01698000
*                                                                  0228 01699000
*   HDWRKSTR(1:5)=LNGTPTR(LTPART6)->LNGTXTD(1:LNGTPTR(LTPART6)->LNGTXTL 01700000
*       );                                                         0228 01701000
@RF00226 MVI   HDWRKSTR+1,C' '                                     0228 01702000
         MVC   HDWRKSTR+2(3),HDWRKSTR+1                            0228 01703000
         L     @10,@CA00736                                        0228 01704000
         L     @10,LNGTPTR-IRBMFLTV+20(,@10)                       0228 01705000
         L     @15,LNGTXTL(,@10)                                   0228 01706000
         BCTR  @15,0                                               0228 01707000
         EX    @15,@SM00798                                        0228 01708000
*   CALL IRBMFCNV(                  /* CONVERSION PROGRAM            */ 01709000
*       HDBINMO,                    /* INPUT MONTH IN BINARY         */ 01710000
*       0,                          /* SCALE FACTOR FOR INPUT        */ 01711000
*       HDWRKSTR(6:7),              /* OUTPUT STRING                 */ 01712000
*       2,                          /* LENGTH                        */ 01713000
*       0,                          /* DIGITS TO RIGHT OF DECIMAL IN    01714000
*                                      OUTPUT                        */ 01715000
*       '0'B,                       /* NO COMMAS                     */ 01716000
*       '0'B);                      /* NO FLOAT                      */ 01717000
         MVC   @AL00001+4(24),@AL00229                             0229 01718000
         LA    @10,HDBINMO                                         0229 01719000
         ST    @10,@AL00001                                        0229 01720000
         LA    @10,HDWRKSTR+5                                      0229 01721000
         ST    @10,@AL00001+8                                      0229 01722000
         L     @15,RGVECTAB                                        0229 01723000
         LA    @01,@AL00001                                        0229 01724000
         BALR  @14,@15                                             0229 01725000
*   HDWRKSTR(8)='/';                /* INSERT SEPARATOR              */ 01726000
         MVI   HDWRKSTR+7,C'/'                                     0230 01727000
*   CALL IRBMFCNV(                  /* CONVERSION PROGRAM            */ 01728000
*       HDBINDAY,                   /* INPUT BINARY DAY              */ 01729000
*       0,                          /* INPUT SCALE FACTOR            */ 01730000
*       HDWRKSTR(9:10),             /* OUTPUT STRING                 */ 01731000
*       2,                          /* LENGTH                        */ 01732000
*       0,                          /* NO DIGITS TO RIGHT OF DECIMAL    01733000
*                                      ON OUTPUT                     */ 01734000
*       '0'B,                       /* NO COMMAS                     */ 01735000
*       '0'B);                      /* NO FLOAT                      */ 01736000
         MVC   @AL00001+4(24),@AL00231                             0231 01737000
         LA    @10,HDBINDAY                                        0231 01738000
         ST    @10,@AL00001                                        0231 01739000
         LA    @10,HDWRKSTR+8                                      0231 01740000
         ST    @10,@AL00001+8                                      0231 01741000
         L     @15,RGVECTAB                                        0231 01742000
         LA    @01,@AL00001                                        0231 01743000
         BALR  @14,@15                                             0231 01744000
*   IF HDWRKSTR(9)=' ' THEN                                        0232 01745000
         CLI   HDWRKSTR+8,C' '                                     0232 01746000
         BNE   @RF00232                                            0232 01747000
*     HDWRKSTR(9)='0';              /* FILL IN LEADING ZERO          */ 01748000
         MVI   HDWRKSTR+8,C'0'                                     0233 01749000
*   HDWRKSTR(11)='/';               /* INSERT SEPARATOR              */ 01750000
@RF00232 MVI   HDWRKSTR+10,C'/'                                    0234 01751000
*   CALL IRBMFCNV(                  /* CONVERSION PROGRAM            */ 01752000
*       HDBINYR,                    /* INPUT BINARY YEAR             */ 01753000
*       0,                          /* INPUT SCALE FACTOR            */ 01754000
*       HDWRKSTR(12:13),            /* OUTPUT STRING                 */ 01755000
*       2,                          /* LENGTH                        */ 01756000
*       0,                          /* DIGITS TO RIGHT OF DECIMAL  0235 01757000
*                                      POINT IN OUTPUT               */ 01758000
*       '0'B,                       /* NO COMMAS                     */ 01759000
*       '0'B);                      /* NO FLOAT                      */ 01760000
         MVC   @AL00001+4(24),@AL00235                             0235 01761000
         LA    @10,HDBINYR                                         0235 01762000
         ST    @10,@AL00001                                        0235 01763000
         LA    @10,HDWRKSTR+11                                     0235 01764000
         ST    @10,@AL00001+8                                      0235 01765000
         L     @15,RGVECTAB                                        0235 01766000
         LA    @01,@AL00001                                        0235 01767000
         BALR  @14,@15                                             0235 01768000
*   IF HDWRKSTR(12)=' ' THEN        /* INSERT LEADING ZERO           */ 01769000
         CLI   HDWRKSTR+11,C' '                                    0236 01770000
         BNE   @RF00236                                            0236 01771000
*     HDWRKSTR(12)='0';                                            0237 01772000
         MVI   HDWRKSTR+11,C'0'                                    0237 01773000
*   CALL MFISRTXT(                  /* INSERT TEXT PROGRAM           */ 01774000
*       HDWRKSTR,                   /* TEXT                          */ 01775000
*       13,                         /* LENGTH                        */ 01776000
*       RGHDR3,                     /* START LINE                    */ 01777000
*       RGCOLC);                    /* START COLUMN                  */ 01778000
*                                                                  0238 01779000
@RF00236 MVC   @AL00001+4(12),@AL00238                             0238 01780000
         LA    @10,HDWRKSTR                                        0238 01781000
         ST    @10,@AL00001                                        0238 01782000
         LA    @01,@AL00001                                        0238 01783000
         BAL   @14,MFISRTXT                                        0238 01784000
*   /*****************************************************************/ 01785000
*   /*                                                               */ 01786000
*   /* INSERT TIME HH/MM/SS                                          */ 01787000
*   /*                                                               */ 01788000
*   /*****************************************************************/ 01789000
*                                                                  0239 01790000
*   UNPK(HDUNPKST(1:6),SMF70IST);   /* UNPACK INTERVAL START TIME  0239 01791000
*                                      FROM 0HHMMSSF TO EBCDIC       */ 01792000
*                                                                  0239 01793000
         L     @10,@PC00003                                        0239 01794000
         L     @10,HDRECPTR(,@10)                                  0239 01795000
         UNPK  HDUNPKST(6),SMF70IST(4,@10)                         0239 01796000
*   /*****************************************************************/ 01797000
*   /*                                                               */ 01798000
*   /* INSERT 'TIME '                                                */ 01799000
*   /*                                                               */ 01800000
*   /*****************************************************************/ 01801000
*                                                                  0240 01802000
*   HDWRKSTR(1:5)=LNGTPTR(LTPART7)->LNGTXTD(1:LNGTPTR(LTPART7)->LNGTXTL 01803000
*       );                                                         0240 01804000
         MVI   HDWRKSTR+1,C' '                                     0240 01805000
         MVC   HDWRKSTR+2(3),HDWRKSTR+1                            0240 01806000
         L     @10,@CA00736                                        0240 01807000
         L     @10,LNGTPTR-IRBMFLTV+24(,@10)                       0240 01808000
         L     @15,LNGTXTL(,@10)                                   0240 01809000
         BCTR  @15,0                                               0240 01810000
         EX    @15,@SM00798                                        0240 01811000
*   HDWRKSTR(6:7)=HDUNPKST(1:2);    /* MOVE HH                       */ 01812000
         MVC   HDWRKSTR+5(2),HDUNPKST                              0241 01813000
*   HDWRKSTR(8)='.';                /* INSERT SEPARATOR              */ 01814000
         MVI   HDWRKSTR+7,C'.'                                     0242 01815000
*   HDWRKSTR(9:10)=HDUNPKST(3:4);   /* MOVE MM                       */ 01816000
         MVC   HDWRKSTR+8(2),HDUNPKST+2                            0243 01817000
*   HDWRKSTR(11)='.';               /* INSERT SEPARATOR              */ 01818000
         MVI   HDWRKSTR+10,C'.'                                    0244 01819000
*   HDWRKSTR(12:13)=HDUNPKST(5:6);  /* MOVE SS                       */ 01820000
         MVC   HDWRKSTR+11(2),HDUNPKST+4                           0245 01821000
*   CALL MFISRTXT(                  /* INSERT TEXT PROGRAM           */ 01822000
*       HDWRKSTR,                   /* TEXT                          */ 01823000
*       13,                         /* LENGTH                        */ 01824000
*       RGHDR4,                     /* START LINE                    */ 01825000
*       RGCOLC);                    /* START COLUMN                  */ 01826000
*                                                                  0246 01827000
         MVC   @AL00001+4(12),@AL00246                             0246 01828000
         LA    @10,HDWRKSTR                                        0246 01829000
         ST    @10,@AL00001                                        0246 01830000
         LA    @01,@AL00001                                        0246 01831000
         BAL   @14,MFISRTXT                                        0246 01832000
*   /*****************************************************************/ 01833000
*   /*                                                               */ 01834000
*   /* INSERT INTERVAL MM/SS.TTT                                     */ 01835000
*   /*                                                               */ 01836000
*   /*****************************************************************/ 01837000
*                                                                  0247 01838000
*   UNPK(HDUNPKST,SMF70INT);        /* UNPACK INTERVAL LENGTH FROM 0247 01839000
*                                      MMSSTTTF FORM TO EBCDIC       */ 01840000
*                                                                  0247 01841000
         L     @10,@PC00003                                        0247 01842000
         L     @10,HDRECPTR(,@10)                                  0247 01843000
         UNPK  HDUNPKST(7),SMF70INT(4,@10)                         0247 01844000
*   /*****************************************************************/ 01845000
*   /*                                                               */ 01846000
*   /* INSERT 'INTERVAL '                                            */ 01847000
*   /*                                                               */ 01848000
*   /*****************************************************************/ 01849000
*                                                                  0248 01850000
*   HDWRKSTR(1:9)=LNGTPTR(LTPART8)->LNGTXTD(1:LNGTPTR(LTPART8)->LNGTXTL 01851000
*       );                                                         0248 01852000
         MVI   HDWRKSTR+1,C' '                                     0248 01853000
         MVC   HDWRKSTR+2(7),HDWRKSTR+1                            0248 01854000
         L     @10,@CA00736                                        0248 01855000
         L     @10,LNGTPTR-IRBMFLTV+28(,@10)                       0248 01856000
         L     @15,LNGTXTL(,@10)                                   0248 01857000
         BCTR  @15,0                                               0248 01858000
         EX    @15,@SM00798                                        0248 01859000
*   HDWRKSTR(10:11)=HDUNPKST(1:2);  /* MOVE MM                       */ 01860000
         MVC   HDWRKSTR+9(2),HDUNPKST                              0249 01861000
*   HDWRKSTR(12)='.';               /* INSERT SEPARATOR              */ 01862000
         MVI   HDWRKSTR+11,C'.'                                    0250 01863000
*   HDWRKSTR(13:14)=HDUNPKST(3:4);  /* MOVE SS                       */ 01864000
         MVC   HDWRKSTR+12(2),HDUNPKST+2                           0251 01865000
*   HDWRKSTR(15)='.';               /* INSERT PERIOD                 */ 01866000
         MVI   HDWRKSTR+14,C'.'                                    0252 01867000
*   HDWRKSTR(16:18)=HDUNPKST(5:7);  /* MOVE TTT                      */ 01868000
         MVC   HDWRKSTR+15(3),HDUNPKST+4                           0253 01869000
*   CALL MFISRTXT(                  /* INSERT TEXT PROGRAM           */ 01870000
*       HDWRKSTR,                   /* TEXT                          */ 01871000
*       18,                         /* LENGTH                        */ 01872000
*       RGHDR3,                     /* START LINE                    */ 01873000
*       RGCOLD);                    /* START COLUMN                  */ 01874000
*                                                                  0254 01875000
         MVC   @AL00001+4(12),@AL00254                             0254 01876000
         LA    @10,HDWRKSTR                                        0254 01877000
         ST    @10,@AL00001                                        0254 01878000
         LA    @01,@AL00001                                        0254 01879000
         BAL   @14,MFISRTXT                                        0254 01880000
*   /*****************************************************************/ 01881000
*   /*                                                               */ 01882000
*   /* INSERT CYCLE 0.TTT, IF NECESSARY                              */ 01883000
*   /*                                                               */ 01884000
*   /*****************************************************************/ 01885000
*                                                                  0255 01886000
*   IF SMF70CYC^=HDNOSAMP THEN      /* SAMPLING IS DESIRED           */ 01887000
         L     @10,@PC00003                                        0255 01888000
         L     @10,HDRECPTR(,@10)                                  0255 01889000
         CLC   SMF70CYC(2,@10),@CB00756                            0255 01890000
         BE    @RF00255                                            0255 01891000
*     DO;                                                          0256 01892000
*       UNPK(HDUNPKST(1:3),SMF70CYC);/* UNPACK SAMPLING CYCLE LENGTH    01893000
*                                      FROM FORM TTTF TO EBCDIC      */ 01894000
*                                                                  0257 01895000
         L     @10,@PC00003                                        0257 01896000
         L     @10,HDRECPTR(,@10)                                  0257 01897000
         UNPK  HDUNPKST(3),SMF70CYC(2,@10)                         0257 01898000
*       /*************************************************************/ 01899000
*       /*                                                           */ 01900000
*       /* INSERT 'CYCLE '                                           */ 01901000
*       /*                                                           */ 01902000
*       /*************************************************************/ 01903000
*                                                                  0258 01904000
*       HDWRKSTR(1:6)=LNGTPTR(LTPART9)->LNGTXTD(1:LNGTPTR(LTPART9)->    01905000
*           LNGTXTL);                                              0258 01906000
         MVI   HDWRKSTR+1,C' '                                     0258 01907000
         MVC   HDWRKSTR+2(4),HDWRKSTR+1                            0258 01908000
         L     @10,@CA00736                                        0258 01909000
         L     @15,LNGTPTR-IRBMFLTV+32(,@10)                       0258 01910000
         L     @14,LNGTXTL(,@15)                                   0258 01911000
         BCTR  @14,0                                               0258 01912000
         EX    @14,@SM00800                                        0258 01913000
*       HDWRKSTR(7:8)='0.';                                        0259 01914000
         MVC   HDWRKSTR+6(2),@CC00764                              0259 01915000
*       HDWRKSTR(9:11)=HDUNPKST(1:3);/* INSERT TTT                   */ 01916000
*                                                                  0260 01917000
         MVC   HDWRKSTR+8(3),HDUNPKST                              0260 01918000
*       /*************************************************************/ 01919000
*       /*                                                           */ 01920000
*       /* INSERT ' SECONDS'                                         */ 01921000
*       /*                                                           */ 01922000
*       /*************************************************************/ 01923000
*                                                                  0261 01924000
*       HDWRKSTR(12:19)=LNGTPTR(LTPART10)->LNGTXTD(1:LNGTPTR(LTPART10)  01925000
*           ->LNGTXTL);                                            0261 01926000
         MVI   HDWRKSTR+12,C' '                                    0261 01927000
         MVC   HDWRKSTR+13(6),HDWRKSTR+12                          0261 01928000
         L     @10,LNGTPTR-IRBMFLTV+36(,@10)                       0261 01929000
         L     @15,LNGTXTL(,@10)                                   0261 01930000
         BCTR  @15,0                                               0261 01931000
         EX    @15,@SM00802                                        0261 01932000
*       CALL MFISRTXT(              /* INSERT TEXT PROGRAM           */ 01933000
*           HDWRKSTR,               /* TEXT                          */ 01934000
*           19,                     /* LENGTH                        */ 01935000
*           RGHDR4,                 /* START LINE                    */ 01936000
*           RGCOLD);                /* START COLUMN                  */ 01937000
         MVC   @AL00001+4(12),@AL00262                             0262 01938000
         LA    @10,HDWRKSTR                                        0262 01939000
         ST    @10,@AL00001                                        0262 01940000
         LA    @01,@AL00001                                        0262 01941000
         BAL   @14,MFISRTXT                                        0262 01942000
*     END;                                                         0263 01943000
*   RETURN;                         /* RETURN TO CALLER              */ 01944000
@EL00003 DS    0H                                                  0264 01945000
@EF00003 DS    0H                                                  0264 01946000
@ER00003 LM    @14,@12,@SA00003                                    0264 01947000
         BR    @14                                                 0264 01948000
*   END;                                                           0265 01949000
         B     @EL00003                                            0265 01950000
*                                                                  0266 01951000
*/*                                                                  */ 01952000
*/*** START OF SPECIFICATIONS ****************************************  01953000
*                                                                    */ 01954000
*/*                                                                  */ 01955000
*/* SUBROUTINE-NAME = MFWRTPAG                                       */ 01956000
*/*                                                                  */ 01957000
*/* DESCRIPTIVE-NAME = REPORT WRITE INTERNAL PAGE IMAGE ROUTINE      */ 01958000
*/*                                                                  */ 01959000
*/* FUNCTION = WRITES THE INTERNAL PAGE IMAGE, LINE BY LINE, TO A    */ 01960000
*/*            SYSOUT DATA SET.                                      */ 01961000
*/*                                                                  */ 01962000
*/* ENTRY-POINT = MFWRTPAG                                           */ 01963000
*/*                                                                  */ 01964000
*/*    PURPOSE = SEE FUNCTION                                        */ 01965000
*/*                                                                  */ 01966000
*/**** END OF SPECIFICATIONS *****************************************  01967000
*                                                                    */ 01968000
*/*                                                                  */ 01969000
*/* WRITE INTERNAL PAGE IMAGE SUBROUTINE                             */ 01970000
*                                                                  0266 01971000
*MFWRTPAG:                                                         0266 01972000
*   PROCEDURE;                                                     0266 01973000
MFWRTPAG STM   @14,@12,@SA00004                                    0266 01974000
*                                                                  0267 01975000
*/* BEGIN MISCELLANEOUS DECLARATIONS                                 */ 01976000
*                                                                  0267 01977000
*   DECLARE                                                        0267 01978000
*     WRSKIPLN                      /* LINES TO SKIP BEFORE PRINTING */ 01979000
*         FIXED BINARY(15),                                        0267 01980000
*     WRLOOPV                       /* LOOP VARIABLE                 */ 01981000
*         FIXED BINARY(15),                                        0267 01982000
*     WRCARCC                       /* POSSIBLE CARRIAGE CONTROL   0267 01983000
*                                      CHARACTERS                    */ 01984000
*         CHARACTER(3)STATIC LOCAL INITIAL(' 0-');                 0267 01985000
*                                                                  0268 01986000
*/* BEGIN MAINLINE PROCESSING                                        */ 01987000
*                                                                  0268 01988000
*   /*****************************************************************/ 01989000
*   /*                                                               */ 01990000
*   /* CHECK FOR SOMETHING TO WRITE                                  */ 01991000
*   /*                                                               */ 01992000
*   /*****************************************************************/ 01993000
*                                                                  0268 01994000
*   IF RGLASTLN=RGNOPAGE THEN       /* NO NON-BLANK LINES IN PAGE.   */ 01995000
         ICM   @10,3,RGLASTLN                                      0268 01996000
         BZ    @RT00268                                            0268 01997000
*     RETURN;                       /* RETURN TO REPORT GENERATOR.   */ 01998000
*                                                                  0269 01999000
*   /*****************************************************************/ 02000000
*   /*                                                               */ 02001000
*   /* WRITE PAGE TO SYSOUT DATA SET                                 */ 02002000
*   /*                                                               */ 02003000
*   /*****************************************************************/ 02004000
*                                                                  0270 02005000
*   WRSKIPLN=1;                     /* SKIP ONE LINE BEFORE PRINTING */ 02006000
         LA    @10,1                                               0270 02007000
         LR    WRSKIPLN,@10                                        0270 02008000
*   DO WRLOOPV=1 TO RGLASTLN;       /* DO FOR ALL LINES UP TO LAST   */ 02009000
*                                                                  0271 02010000
         LR    WRLOOPV,@10                                         0271 02011000
         B     @DE00271                                            0271 02012000
@DL00271 DS    0H                                                  0272 02013000
*     /***************************************************************/ 02014000
*     /*                                                             */ 02015000
*     /* MUST WRITE FIRST LINE                                       */ 02016000
*     /*                                                             */ 02017000
*     /***************************************************************/ 02018000
*                                                                  0272 02019000
*     IF WRLOOPV=1 THEN             /* FIRST LINE                    */ 02020000
         CH    WRLOOPV,@CH00072                                    0272 02021000
         BNE   @RF00272                                            0272 02022000
*       RGCARCTL(WRLOOPV)='1';      /* SET SKIP TO TOP OF PAGE       */ 02023000
*                                                                  0273 02024000
         LR    @10,WRLOOPV                                         0273 02025000
         MH    @10,@CH00789                                        0273 02026000
         LA    @05,RGCARCTL-126(@10)                               0273 02027000
         MVI   0(@05),C'1'                                         0273 02028000
*     /***************************************************************/ 02029000
*     /*                                                             */ 02030000
*     /* THIS IS NOT THE FIRST LINE                                  */ 02031000
*     /*                                                             */ 02032000
*     /***************************************************************/ 02033000
*                                                                  0274 02034000
*     ELSE                                                         0274 02035000
*       DO;                                                        0274 02036000
         B     @RC00272                                            0274 02037000
@RF00272 DS    0H                                                  0275 02038000
*         IF WRSKIPLN<3&            /* HAVE NOT FOUND 2 PREVIOUS   0275 02039000
*                                      BLANK LINES                   */ 02040000
*             RGLENGTH(WRLOOPV)=RGNOLINE/* THIS IS A BLANK LINE. THIS   02041000
*                                      WILL NEVER BE TRUE FOR LAST 0275 02042000
*                                      LINE (RGLASTLN).              */ 02043000
*           THEN                                                   0275 02044000
         CH    WRSKIPLN,@CH00127                                   0275 02045000
         BNL   @RF00275                                            0275 02046000
         LR    @10,WRLOOPV                                         0275 02047000
         MH    @10,@CH00789                                        0275 02048000
         LH    @10,RGLENGTH-126(@10)                               0275 02049000
         LTR   @10,@10                                             0275 02050000
         BNZ   @RF00275                                            0275 02051000
*           DO;                                                    0276 02052000
*             WRSKIPLN=WRSKIPLN+1;  /* INCREMENT NUMBER OF BLANK   0277 02053000
*                                      LINES TO SKIP OVER            */ 02054000
         AH    WRSKIPLN,@CH00072                                   0277 02055000
*             GO TO WRLAB1;         /* CONTINUE IN LOOP              */ 02056000
         B     WRLAB1                                              0278 02057000
*           END;                                                   0279 02058000
*         RGCARCTL(WRLOOPV)=WRCARCC(WRSKIPLN);/* SET UP CARRIAGE   0280 02059000
*                                      CONTROL CHAR                  */ 02060000
@RF00275 LR    @10,WRLOOPV                                         0280 02061000
         MH    @10,@CH00789                                        0280 02062000
         LA    @01,RGCARCTL-126(@10)                               0280 02063000
         LA    @10,WRCARCC-1(WRSKIPLN)                             0280 02064000
         MVC   0(1,@01),0(@10)                                     0280 02065000
*       END;                                                       0281 02066000
*                                                                  0281 02067000
*     /***************************************************************/ 02068000
*     /*                                                             */ 02069000
*     /* WRITE OUT LINE. FIRST SET UP RECORD LENGTH                  */ 02070000
*     /*                                                             */ 02071000
*     /***************************************************************/ 02072000
*                                                                  0282 02073000
*     IF RGLENGTH(WRLOOPV)=RGNOLINE THEN/* IF NO NON-BLANK DATA      */ 02074000
*                                                                  0282 02075000
@RC00272 LR    @10,WRLOOPV                                         0282 02076000
         MH    @10,@CH00789                                        0282 02077000
         LH    @05,RGLENGTH-126(@10)                               0282 02078000
         LTR   @05,@05                                             0282 02079000
         BNZ   @RF00282                                            0282 02080000
*       /*************************************************************/ 02081000
*       /*                                                           */ 02082000
*       /* SET LENGTH TO INCLUDE RDW,CCC, AND ONE BLANK              */ 02083000
*       /*                                                           */ 02084000
*       /*************************************************************/ 02085000
*                                                                  0283 02086000
*       RGLENGTH(WRLOOPV)=LENGTH(RGLINCTL)+1;                      0283 02087000
         LA    @05,6                                               0283 02088000
         STH   @05,RGLENGTH-126(@10)                               0283 02089000
*     ELSE                                                         0284 02090000
*       RGLENGTH(WRLOOPV)=RGLENGTH(WRLOOPV)+LENGTH(RGLINCTL);/* SET     02091000
*                                      LENGTH TO INCLUDE RDW,CCC, AND   02092000
*                                      ALL CHARACTERS UP TO THE LAST    02093000
*                                      NON-BLANK CHARACTER           */ 02094000
         B     @RC00282                                            0284 02095000
@RF00282 LR    @10,WRLOOPV                                         0284 02096000
         MH    @10,@CH00789                                        0284 02097000
         LA    @05,5                                               0284 02098000
         AH    @05,RGLENGTH-126(@10)                               0284 02099000
         STH   @05,RGLENGTH-126(@10)                               0284 02100000
*     WRSKIPLN=1;                   /* RESET VARIABLE TO SKIP ONE  0285 02101000
*                                      LINE BEFORE PRINTING ON NEXT     02102000
*                                      PASS                          */ 02103000
@RC00282 LA    WRSKIPLN,1                                          0285 02104000
*     RESPECIFY                                                    0286 02105000
*      (GPR00P,                                                    0286 02106000
*       GPR01P,                                                    0286 02107000
*       GPR14P,                                                    0286 02108000
*       GPR15P)RESTRICTED;                                         0286 02109000
*                                                                  0286 02110000
*     /***************************************************************/ 02111000
*     /*                                                             */ 02112000
*     /* REGISTER ZERO CONTAINS ADDRESS OF BUFFER TO WRITE           */ 02113000
*     /*                                                             */ 02114000
*     /***************************************************************/ 02115000
*                                                                  0287 02116000
*     GPR00P=ADDR(RGPAGIMG(WRLOOPV));                              0287 02117000
         LR    GPR00P,WRLOOPV                                      0287 02118000
         MH    GPR00P,@CH00789                                     0287 02119000
         LR    @10,GPR00P                                          0287 02120000
         LA    GPR00P,RGPAGIMG-126(@10)                            0287 02121000
*     GENERATE SETS(RGDCB)FLOWS(MFSYNAD)(PUT RGDCB);/* WRITE LINE    */ 02122000
         PUT RGDCB                                                      02123000
*     RESPECIFY                                                    0289 02124000
*      (GPR00P,                                                    0289 02125000
*       GPR01P,                                                    0289 02126000
*       GPR14P,                                                    0289 02127000
*       GPR15P)UNRESTRICTED;                                       0289 02128000
*WRLAB1:                            /* END OF LOOP FOR ALL LINES.    */ 02129000
*   END;                                                           0290 02130000
*                                                                  0290 02131000
WRLAB1   AH    WRLOOPV,@CH00072                                    0290 02132000
@DE00271 CH    WRLOOPV,RGLASTLN                                    0290 02133000
         BNH   @DL00271                                            0290 02134000
*   /*****************************************************************/ 02135000
*   /*                                                               */ 02136000
*   /* REINITIALIZE PAGE IMAGE                                       */ 02137000
*   /*                                                               */ 02138000
*   /*****************************************************************/ 02139000
*                                                                  0291 02140000
*   DO WRLOOPV=1 TO RGLASTLN;                                      0291 02141000
         LA    WRLOOPV,1                                           0291 02142000
         B     @DE00291                                            0291 02143000
@DL00291 DS    0H                                                  0292 02144000
*     RGLENGTH(WRLOOPV)=RGNOLINE;   /* INDICATES LINE IS BLANK.      */ 02145000
         SR    @10,@10                                             0292 02146000
         LR    @05,WRLOOPV                                         0292 02147000
         MH    @05,@CH00789                                        0292 02148000
         STH   @10,RGLENGTH-126(@05)                               0292 02149000
*     RGFILL(WRLOOPV)=RGNOFILL;     /* FILL CHARACTER.               */ 02150000
         STH   @10,RGFILL-126(@05)                                 0293 02151000
*     RGCARCTL(WRLOOPV)=' ';        /* SKIP ONE LINE BEFORE PRINTING */ 02152000
         LA    @10,RGCARCTL-126(@05)                               0294 02153000
         MVI   0(@10),C' '                                         0294 02154000
*     RGLINE(WRLOOPV)=' ';          /* BLANK LINE                    */ 02155000
         LA    @10,RGLINE-126(@05)                                 0295 02156000
         MVI   1(@10),C' '                                         0295 02157000
         MVC   2(118,@10),1(@10)                                   0295 02158000
         MVI   0(@10),C' '                                         0295 02159000
*   END;                                                           0296 02160000
         AH    WRLOOPV,@CH00072                                    0296 02161000
@DE00291 CH    WRLOOPV,RGLASTLN                                    0296 02162000
         BNH   @DL00291                                            0296 02163000
*   RGLASTLN=RGNOPAGE;              /* INDICATE BLANK PAGE.          */ 02164000
         SR    @10,@10                                             0297 02165000
         STH   @10,RGLASTLN                                        0297 02166000
*   RETURN;                         /* RETURN TO CALLER              */ 02167000
@EL00004 DS    0H                                                  0298 02168000
@EF00004 DS    0H                                                  0298 02169000
@ER00004 LM    @14,@12,@SA00004                                    0298 02170000
         BR    @14                                                 0298 02171000
*   END;                                                           0299 02172000
*                                                                  0299 02173000
         B     @EL00004                                            0299 02174000
*/*                                                                  */ 02175000
*/*** START OF SPECIFICATIONS ****************************************  02176000
*                                                                    */ 02177000
*/*                                                                  */ 02178000
*/* SUBROUTINE-NAME = MFSYNAD                                        */ 02179000
*/*                                                                  */ 02180000
*/* DESCRIPTIVE-NAME = SYNAD ROUTINE FOR I/O ERRORS TO REPORT SYSOUT */ 02181000
*/*                    DATA SETS                                     */ 02182000
*/*                                                                  */ 02183000
*/* FUNCTION = HANDLES ERRORS OCCURRING WHILE WRITING THE INTERNAL   */ 02184000
*/*            PAGE IMAGE TO THE SYSOUT DATA SET.                    */ 02185000
*/*                                                                  */ 02186000
*/* ENTRY-POINT = MFSYNAD                                            */ 02187000
*/*                                                                  */ 02188000
*/*    PURPOSE = SEE FUNCTION                                        */ 02189000
*/*                                                                  */ 02190000
*/*    LINKAGE = R2 - R13 AS THEY EXISTED PRIOR TO PUT MACRO.        */ 02191000
*/*              R14 - RETURN ADDRESS                                */ 02192000
*/*              ALL REGISTERS TRANSPARENT                           */ 02193000
*/*                                                                  */ 02194000
*/**** END OF SPECIFICATIONS *****************************************  02195000
*                                                                    */ 02196000
*/*                                                                  */ 02197000
*/* SYNAD ROUTINE FOR MFWRTPAG PROCEDURE                             */ 02198000
*                                                                  0300 02199000
*MFSYNAD:                                                          0300 02200000
*   PROCEDURE OPTIONS(NOSAVE NOSAVEAREA);                          0300 02201000
MFSYNAD  DS    0H                                                  0301 02202000
*                                                                  0301 02203000
*/* BEGIN MISCELLANEOUS DECLARATIONS                                 */ 02204000
*                                                                  0301 02205000
*   DECLARE                                                        0301 02206000
*     SYSAVEA                       /* PROGRAM SAVE AREA FOR       0301 02207000
*                                      REGISTERS ON ENTRY            */ 02208000
*         CHARACTER(64)BOUNDARY(WORD),                             0301 02209000
*     SYBUFPTR                      /* POINTER TO MESSAGE            */ 02210000
*         POINTER(31),                                             0301 02211000
*     SYMESSAG                      /* MESSAGE                       */ 02212000
*         CHARACTER(128)BASED(SYBUFPTR),                           0301 02213000
*     SYLOOPV                       /* LOOP VARIABLE                 */ 02214000
*         FIXED BINARY(15),                                        0301 02215000
*     SYMSGPRM                      /* VARIABLE TEXT ADDRESS LIST TO    02216000
*                                      PASS TO MESSAGE PROCESSOR     */ 02217000
*         POINTER(31);                                             0301 02218000
*                                                                  0302 02219000
*/* BEGIN MISCELLANEOUS STRUCTURE DECLARATIONS                       */ 02220000
*                                                                  0302 02221000
*   DECLARE                                                        0302 02222000
*     1 SYVSEG,                     /* REPRESENTS SYNAD TEXT WHEN  0302 02223000
*                                      PASSED TO MESSAGE PROCESSOR   */ 02224000
*      2 SYVPART                    /* WILL BE ZERO INDICATING THAT     02225000
*                                      THIS STRUCTURE CONTAINS TEXT  */ 02226000
*            FIXED BINARY(15),                                     0302 02227000
*      2 SYVLEN                     /* LENGTH OF TEXT                */ 02228000
*            FIXED BINARY(15),                                     0302 02229000
*      2 SYVTEXT                    /* TEXT                          */ 02230000
*            CHARACTER(128);                                       0302 02231000
*                                                                  0303 02232000
*/* BEGIN PROCESSING                                                 */ 02233000
*                                                                  0303 02234000
*   /*****************************************************************/ 02235000
*   /*                                                               */ 02236000
*   /* SAVE REGISTERS AND ISSUE SYNADAF MACRO TO GET ERROR MESSAGE   */ 02237000
*   /* AND ESTABLISH NEW SAVE AREA. REGISTERS 2-13 ARE TRANSPARENT   */ 02238000
*   /* FROM THE PUT MACRO IN MFWRTPAG                                */ 02239000
*   /*                                                               */ 02240000
*   /*****************************************************************/ 02241000
*                                                                  0303 02242000
*   GENERATE SETS(SYSAVEA);                                        0303 02243000
*                                                                  0303 02244000
         STM   @00,@15,SYSAVEA      SAVE REGISTERS                      02245000
         SYNADAF ACSMETH=QSAM       ISSUE SYNAD MACRO                   02246000
*   /*****************************************************************/ 02247000
*   /*                                                               */ 02248000
*   /* REGISTER 13 NOW POINTS TO A SAVE AREA OBTAINED BY SYNADAF     */ 02249000
*   /*                                                               */ 02250000
*   /*****************************************************************/ 02251000
*                                                                  0304 02252000
*   RESPECIFY                                                      0304 02253000
*    (GPR01P)RESTRICTED;                                           0304 02254000
*   SYBUFPTR=GPR01P;                /* SAVE POINTER TO MESSAGE       */ 02255000
         LR    SYBUFPTR,GPR01P                                     0305 02256000
*   RESPECIFY                                                      0306 02257000
*    (GPR01P)UNRESTRICTED;                                         0306 02258000
*                                                                  0306 02259000
*   /*****************************************************************/ 02260000
*   /*                                                               */ 02261000
*   /* INITIALIZE VARIABLE PART LISTS AND THEN WRITE MESSAGE IRB401I */ 02262000
*   /* I/O ERROR ON MF/1 WRITE. THE SYNAD TEXT FOLLOWS. 'SYNAD TEXT' */ 02263000
*   /*                                                               */ 02264000
*   /*****************************************************************/ 02265000
*                                                                  0307 02266000
*   SYMSGPRM=ADDR(SYVSEG);          /* ADDRESS LIST POINTS TO      0307 02267000
*                                      VARIABLE MESSAGE SEGMENT      */ 02268000
         LA    @10,SYVSEG                                          0307 02269000
         ST    @10,SYMSGPRM                                        0307 02270000
*   SYVPART=0;                      /* INDICATES TEXT                */ 02271000
         SR    @10,@10                                             0308 02272000
         STH   @10,SYVPART                                         0308 02273000
*   SYVLEN=LENGTH(SYVTEXT);         /* LENGTH OF SYNAD TEXT          */ 02274000
         MVC   SYVLEN(2),@CH00782                                  0309 02275000
*   SYVTEXT=SYMESSAG;               /* MOVE MESSAGE INTO PARM LIST   */ 02276000
*                                                                  0310 02277000
         MVC   SYVTEXT(128),SYMESSAG(SYBUFPTR)                     0310 02278000
*   /*****************************************************************/ 02279000
*   /*                                                               */ 02280000
*   /* LOAD MESSAGE PROCESSOR                                        */ 02281000
*   /*                                                               */ 02282000
*   /*****************************************************************/ 02283000
*                                                                  0311 02284000
*   RESPECIFY                                                      0311 02285000
*    (GPR00P,                                                      0311 02286000
*     GPR01P,                                                      0311 02287000
*     GPR14P,                                                      0311 02288000
*     GPR15P)RESTRICTED;                                           0311 02289000
*   GENERATE;                                                      0312 02290000
SYLOAD1  LOAD  EP=IRBMFMPR,RELATED=(MFSYLMPR,MFSYNAD(SYLOAD2))          02291000
*   RGENTRYP=GPR00P;                                               0313 02292000
         LR    RGENTRYP,GPR00P                                     0313 02293000
*   RESPECIFY                                                      0314 02294000
*    (GPR00P,                                                      0314 02295000
*     GPR01P,                                                      0314 02296000
*     GPR14P,                                                      0314 02297000
*     GPR15P)UNRESTRICTED;                                         0314 02298000
*                                                                  0314 02299000
*   /*****************************************************************/ 02300000
*   /*                                                               */ 02301000
*   /* CALL MESSAGE MODULE                                           */ 02302000
*   /*                                                               */ 02303000
*   /*****************************************************************/ 02304000
*                                                                  0315 02305000
*   CALL IRBMFMPR(                  /* MESSAGE MODULE                */ 02306000
*       MID400I,                    /* MESSAGE INDEX                 */ 02307000
*       SYMSGPRM,                   /* VARIABLE SEGMENT LIST         */ 02308000
*       0,                          /* DUMMY REPLY BUFFER            */ 02309000
*       MFSEMDCB);                  /* MESSAGE DATA SET DCB ADDRESS  */ 02310000
*                                                                  0315 02311000
         LA    @10,@CF00525                                        0315 02312000
         ST    @10,@AL00001                                        0315 02313000
         LA    @10,SYMSGPRM                                        0315 02314000
         ST    @10,@AL00001+4                                      0315 02315000
         LA    @10,@CF00500                                        0315 02316000
         ST    @10,@AL00001+8                                      0315 02317000
         L     @10,@PC00001                                        0315 02318000
         LA    @10,MFSEMDCB(,@10)                                  0315 02319000
         ST    @10,@AL00001+12                                     0315 02320000
         LR    @15,RGENTRYP                                        0315 02321000
         LA    @01,@AL00001                                        0315 02322000
         BALR  @14,@15                                             0315 02323000
*   /*****************************************************************/ 02324000
*   /*                                                               */ 02325000
*   /* RELEASE SAVE AREA AND BUFFER. DELETE MESSAGE MODULE AND AND   */ 02326000
*   /* RELOAD REGISTERS. THEN ABEND.                                 */ 02327000
*   /*                                                               */ 02328000
*   /*****************************************************************/ 02329000
*                                                                  0316 02330000
*   RESPECIFY                                                      0316 02331000
*    (GPR00P,                                                      0316 02332000
*     GPR01P,                                                      0316 02333000
*     GPR14P,                                                      0316 02334000
*     GPR15P)RESTRICTED;                                           0316 02335000
*   GENERATE REFS(SYSAVEA);                                        0317 02336000
SYLOAD2  DELETE EP=IRBMFMPR,RELATED=(MFSYLMPR,MFSYNAD(SYLOAD1))         02337000
         SYNADRLS                                                       02338000
         LM    @00,@15,SYSAVEA      RESTORE REGISTERS                   02339000
         ABEND 1310,DUMP                                                02340000
*   RESPECIFY                                                      0318 02341000
*    (GPR00P,                                                      0318 02342000
*     GPR01P,                                                      0318 02343000
*     GPR14P,                                                      0318 02344000
*     GPR15P)UNRESTRICTED;                                         0318 02345000
*   END;                                                           0319 02346000
@EL00005 DS    0H                                                  0319 02347000
@EF00005 DS    0H                                                  0319 02348000
@ER00005 BR    @14                                                 0319 02349000
*   END                                                            0320 02350000
*                                                                  0320 02351000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02352000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 02353000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 02354000
*/*%INCLUDE SYSLIB  (IRBRGCON)                                       */ 02355000
*/*%INCLUDE SYSLIB  (IRBMFMID)                                       */ 02356000
*/*%INCLUDE SYSLIB  (IFASMFR )                                       */ 02357000
*/*%INCLUDE SYSLIB  (IRBMFLTM)                                       */ 02358000
*                                                                  0320 02359000
*       ;                                                          0320 02360000
@EL00001 L     @13,4(,@13)                                         0320 02361000
@EF00001 L     @00,@SIZDATD                                        0320 02362000
         LR    @01,@11                                             0320 02363000
         FREEMAIN R,LV=(0),A=(1)                                        02364000
@ER00001 LM    @14,@12,12(@13)                                     0320 02365000
         BR    @14                                                 0320 02366000
@DATA    DS    0H                                                       02367000
@CH00052 DC    H'8'                                                     02368000
@CH00516 DC    H'12'                                                    02369000
@CH00339 DC    H'60'                                                    02370000
@CH00372 DC    H'120'                                                   02371000
@CH00789 DC    H'126'                                                   02372000
@CH00782 DC    H'128'                                                   02373000
@SM00796 MVC   0(0,@01),ISTEXT(@14)                                     02374000
@SM00798 MVC   HDWRKSTR(0),LNGTXTD(@10)                                 02375000
@SM00800 MVC   HDWRKSTR(0),LNGTXTD(@15)                                 02376000
@SM00802 MVC   HDWRKSTR+11(0),LNGTXTD(@10)                              02377000
         DS    0F                                                       02378000
@AL00078 DC    A(@CF00500)             LIST WITH   6 ARGUMENT(S)        02379000
         DS    F                                                        02380000
         DC    A(@CF00366)                                              02381000
         DC    A(@CF00500)                                              02382000
         DC    A(@CB00653)                                              02383000
         DC    A(@CB00653)                                              02384000
@AL00152 DC    A(@CF00089)             LIST WITH   4 ARGUMENT(S)        02385000
         DC    A(RGSADDR)                                               02386000
         DC    A(RGSADDR)                                               02387000
         DC    A(RGSADDR)                                               02388000
@AL00197 DC    A(@CF00500)             LIST WITH   6 ARGUMENT(S)        02389000
         DS    F                                                        02390000
         DC    A(@CF00065)                                              02391000
         DC    A(@CF00500)                                              02392000
         DC    A(@CB00653)                                              02393000
         DC    A(@CB00653)                                              02394000
@AL00198 DC    A(@CF00510)             LIST WITH   3 ARGUMENT(S)        02395000
         DC    A(@CF00089)                                              02396000
         DC    A(@CF00791)                                              02397000
@AL00200 DC    A(@CF00500)             LIST WITH   6 ARGUMENT(S)        02398000
         DS    F                                                        02399000
         DC    A(@CF00072)                                              02400000
         DC    A(@CF00500)                                              02401000
         DC    A(@CB00653)                                              02402000
         DC    A(@CB00653)                                              02403000
@AL00201 DC    A(@CF00344)             LIST WITH   3 ARGUMENT(S)        02404000
         DC    A(@CF00127)                                              02405000
         DC    A(@CF00375)                                              02406000
@AL00206 DC    A(@CF00375)             LIST WITH   3 ARGUMENT(S)        02407000
         DC    A(@CF00065)                                              02408000
         DC    A(@CF00375)                                              02409000
@AL00209 DC    A(@CF00519)             LIST WITH   3 ARGUMENT(S)        02410000
         DC    A(@CF00127)                                              02411000
         DC    A(@CF00377)                                              02412000
@AL00212 DC    A(@CF00055)             LIST WITH   3 ARGUMENT(S)        02413000
         DC    A(@CF00065)                                              02414000
         DC    A(@CF00377)                                              02415000
@AL00229 EQU   *                       LIST WITH   6 ARGUMENT(S)        02416000
@AL00231 EQU   *                       LIST WITH   6 ARGUMENT(S)        02417000
@AL00235 DC    A(@CF00500)             LIST WITH   6 ARGUMENT(S)        02418000
         DS    F                                                        02419000
         DC    A(@CF00089)                                              02420000
         DC    A(@CF00500)                                              02421000
         DC    A(@CB00653)                                              02422000
         DC    A(@CB00653)                                              02423000
@AL00238 DC    A(@CF00375)             LIST WITH   3 ARGUMENT(S)        02424000
         DC    A(@CF00127)                                              02425000
         DC    A(@CF00379)                                              02426000
@AL00246 DC    A(@CF00375)             LIST WITH   3 ARGUMENT(S)        02427000
         DC    A(@CF00065)                                              02428000
         DC    A(@CF00379)                                              02429000
@AL00254 DC    A(@CF00525)             LIST WITH   3 ARGUMENT(S)        02430000
         DC    A(@CF00127)                                              02431000
         DC    A(@CF00381)                                              02432000
@AL00262 DC    A(@CF00527)             LIST WITH   3 ARGUMENT(S)        02433000
         DC    A(@CF00065)                                              02434000
         DC    A(@CF00381)                                              02435000
@DATD    DSECT                                                          02436000
         DS    0F                                                       02437000
@SA00001 DS    18F                                                      02438000
@PC00001 DS    3F                                                       02439000
@SA00003 DS    15F                                                      02440000
@PC00003 DS    4F                                                       02441000
@PC00002 DS    4F                                                       02442000
@SA00004 DS    15F                                                      02443000
@AL00001 DS    7A                                                       02444000
@AFTEMPS DS    2F                                                       02445000
IRBMFRGM CSECT                                                          02446000
         DS    0F                                                       02447000
@CF00500 DC    F'0'                                                     02448000
@CF00072 DC    F'1'                                                     02449000
@CH00072 EQU   @CF00072+2                                               02450000
@CF00089 DC    F'2'                                                     02451000
@CH00089 EQU   @CF00089+2                                               02452000
@CF00127 DC    F'3'                                                     02453000
@CH00127 EQU   @CF00127+2                                               02454000
@CF00065 DC    F'4'                                                     02455000
@CH00065 EQU   @CF00065+2                                               02456000
@CF00366 DC    F'5'                                                     02457000
@CF00344 DC    F'6'                                                     02458000
@CF00510 DC    F'9'                                                     02459000
@CF00512 DC    F'10'                                                    02460000
@CF00375 DC    F'13'                                                    02461000
@CF00519 DC    F'14'                                                    02462000
@CF00055 DC    F'15'                                                    02463000
@CF00525 DC    F'18'                                                    02464000
@CF00527 DC    F'19'                                                    02465000
@CF00377 DC    F'38'                                                    02466000
@CF00379 DC    F'65'                                                    02467000
@CF00381 DC    F'90'                                                    02468000
@CF00791 DC    F'112'                                                   02469000
@DATD    DSECT                                                          02470000
         DS    0D                                                       02471000
HDBINDAY DS    F                                                        02472000
HDBINYR  DS    F                                                        02473000
HDBINMO  DS    F                                                        02474000
SYMSGPRM DS    A                                                        02475000
RGERRCDE DS    H                                                        02476000
SYLOOPV  DS    H                                                        02477000
         DS    0D                                                       02478000
@TS00001 DS    CL8                                                      02479000
RGCLOSPL DS    CL4                                                      02480000
RGDCB    DS    CL96                                                     02481000
RGESTAPL DS    CL16                                                     02482000
RGOPENPL DS    CL4                                                      02483000
RGDDNAME DS    CL8                                                      02484000
RGMODULE DS    CL8                                                      02485000
RGRTYREG DS    CL48                                                     02486000
RGALLARG DS    CL10                                                     02487000
         ORG   RGALLARG                                                 02488000
RGALLDDN DS    CL8                                                      02489000
RGALLSOU DS    CL1                                                      02490000
RGALLUNA DS    BL1                                                      02491000
         ORG   RGALLARG+10                                              02492000
         DS    CL2                                                      02493000
RGESTPRM DS    CL40                                                     02494000
         ORG   RGESTPRM                                                 02495000
RGESTALL DS    AL4                                                      02496000
RGESTDCB DS    AL4                                                      02497000
RGESTDCM DS    AL4                                                      02498000
RGESTSEL DS    AL4                                                      02499000
RGESTRTY DS    AL4                                                      02500000
RGESTPAG DS    AL4                                                      02501000
RGESTOPN DS    AL4                                                      02502000
RGESTCLS DS    AL4                                                      02503000
RGESTCNV DS    AL4                                                      02504000
RGESTREG DS    AL4                                                      02505000
         ORG   RGESTPRM+40                                              02506000
HDWRKSTR DS    CL20                                                     02507000
HDUNPKST DS    CL7                                                      02508000
HDCVBSRC DS    CL2                                                      02509000
         DS    CL3                                                      02510000
SYSAVEA  DS    CL64                                                     02511000
SYVSEG   DS    CL132                                                    02512000
         ORG   SYVSEG                                                   02513000
SYVPART  DS    FL2                                                      02514000
SYVLEN   DS    FL2                                                      02515000
SYVTEXT  DS    CL128                                                    02516000
         ORG   SYVSEG+132                                               02517000
RGVECTAB DS    4A                                                       02518000
IRBMFRGM CSECT                                                          02519000
         DS    0F                                                       02520000
@SIZDATD DC    AL1(0)                                                   02521000
         DC    AL3(@ENDDATD-@DATD)                                      02522000
@CV00592 DC    V(IRBMFSAR)                                              02523000
@CA00736 DC    A(IRBMFLTV)                                              02524000
         DS    0D                                                       02525000
RGSADDR  DC    A(0)                                                     02526000
@CC00764 DC    C'0.'                                                    02527000
@CC00656 DC    C'MFR'                                                   02528000
@CC00657 DC    C'IRBMFALL'                                              02529000
@CC00664 DC    C'IRBMFMPR'                                              02530000
@CC00665 DC    C'IRBMFCNV'                                              02531000
@CB00756 DC    X'000F'                                                  02532000
@CB00653 DC    B'00000000'                                              02533000
         DS    CL4                                                      02534000
RGONESEC DC    CL8'00000100'                                            02535000
WRCARCC  DC    CL3' 0-'                                                 02536000
RGPATCH  DS    CL200                                                    02537000
         DS    CL1                                                      02538000
HDDAYS   DC    H'31'                                                    02539000
         DC    H'28'                                                    02540000
         DC    H'31'                                                    02541000
         DC    H'30'                                                    02542000
         DC    H'31'                                                    02543000
         DC    H'30'                                                    02544000
         DC    H'31'                                                    02545000
         DC    H'31'                                                    02546000
         DC    H'30'                                                    02547000
         DC    H'31'                                                    02548000
         DC    H'30'                                                    02549000
         DC    H'31'                                                    02550000
IRBMFRGM CSECT                                                          02551000
RGCLSSPL CLOSE (RGSDCB,DISP),MF=L                                       02552000
IRBMFRGM CSECT                                                          02553000
RGSDCB   DCB   DDNAME=MFR00000,                                        X02554000
               DSORG=PS,                                               X02555000
               MACRF=PM,                                               X02556000
               RECFM=VBA,                                              X02557000
               LRECL=125,                                              X02558000
               BLKSIZE=1693                                             02559000
IRBMFRGM CSECT                                                          02560000
RGESTSPL ESTAE RGSADDR,PARAM=RGSADDR,MF=L                               02561000
IRBMFRGM CSECT                                                          02562000
RGOPNSPL OPEN  (RGSDCB,(OUTPUT)),MF=L                                   02563000
@DATD    DSECT                                                          02564000
         DS    0F                   FULLWORD BOUNDARY                   02565000
RGGENPAG DS    CL7562              STORAGE FOR PAGE TABLE               02566000
@DATD    DSECT                                                          02567000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02568000
@ENDDATD EQU   *                                                        02569000
IRBMFRGM CSECT                                                          02570000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02571000
@01      EQU   01                                                       02572000
@02      EQU   02                                                       02573000
@03      EQU   03                                                       02574000
@04      EQU   04                                                       02575000
@05      EQU   05                                                       02576000
@06      EQU   06                                                       02577000
@07      EQU   07                                                       02578000
@08      EQU   08                                                       02579000
@09      EQU   09                                                       02580000
@10      EQU   10                                                       02581000
@11      EQU   11                                                       02582000
@12      EQU   12                                                       02583000
@13      EQU   13                                                       02584000
@14      EQU   14                                                       02585000
@15      EQU   15                                                       02586000
SYBUFPTR EQU   @04                                                      02587000
WRLOOPV  EQU   @04                                                      02588000
WRSKIPLN EQU   @05                                                      02589000
HDLOOPV  EQU   @05                                                      02590000
HDTOTDAY EQU   @04                                                      02591000
ISLSTCOL EQU   @04                                                      02592000
RGLOOP   EQU   @04                                                      02593000
RGENTRYP EQU   @05                                                      02594000
DCBPTR   EQU   @06                                                      02595000
GPR12P   EQU   @12                                                      02596000
GPR11P   EQU   @11                                                      02597000
GPR00F   EQU   @00                                                      02598000
GPR01F   EQU   @01                                                      02599000
GPR14F   EQU   @14                                                      02600000
GPR15F   EQU   @15                                                      02601000
GPR00P   EQU   @00                                                      02602000
GPR01P   EQU   @01                                                      02603000
GPR14P   EQU   @14                                                      02604000
GPR15P   EQU   @15                                                      02605000
GPR02P   EQU   @02                                                      02606000
GPR03P   EQU   @03                                                      02607000
         EXTRN IRBMFLTV                                                 02608000
IHADCB   EQU   0                                                        02609000
IHADCS00 EQU   0                                                        02610000
DCBFDAD  EQU   IHADCS00+5                                               02611000
IHADCS01 EQU   0                                                        02612000
DCBDVTBL EQU   IHADCS01                                                 02613000
IHADCS11 EQU   0                                                        02614000
DCBRELB  EQU   IHADCS11                                                 02615000
DCBREL   EQU   DCBRELB+1                                                02616000
DCBBUFCB EQU   IHADCS11+4                                               02617000
DCBDSORG EQU   IHADCS11+10                                              02618000
DCBDSRG1 EQU   DCBDSORG                                                 02619000
DCBDSRG2 EQU   DCBDSORG+1                                               02620000
DCBIOBAD EQU   IHADCS11+12                                              02621000
DCBODEB  EQU   DCBIOBAD                                                 02622000
DCBLNP   EQU   DCBODEB                                                  02623000
DCBQSLM  EQU   DCBLNP                                                   02624000
DCBIOBAA EQU   DCBODEB+1                                                02625000
IHADCS50 EQU   0                                                        02626000
DCBSVCXL EQU   IHADCS50                                                 02627000
DCBEODAD EQU   IHADCS50+4                                               02628000
DCBBFALN EQU   DCBEODAD                                                 02629000
DCBHIARC EQU   DCBBFALN                                                 02630000
DCBBFTEK EQU   DCBHIARC                                                 02631000
DCBBFT   EQU   DCBBFTEK                                                 02632000
DCBEXLST EQU   IHADCS50+8                                               02633000
DCBRECFM EQU   DCBEXLST                                                 02634000
DCBRECLA EQU   DCBRECFM                                                 02635000
IHADCS24 EQU   0                                                        02636000
DCBDDNAM EQU   IHADCS24                                                 02637000
DCBOFLGS EQU   IHADCS24+8                                               02638000
DCBOFLWR EQU   DCBOFLGS                                                 02639000
DCBOFOPN EQU   DCBOFLGS                                                 02640000
DCBIFLG  EQU   IHADCS24+9                                               02641000
DCBMACR  EQU   IHADCS24+10                                              02642000
DCBMACR1 EQU   DCBMACR                                                  02643000
DCBMRFE  EQU   DCBMACR1                                                 02644000
DCBMRGET EQU   DCBMRFE                                                  02645000
DCBMRAPG EQU   DCBMACR1                                                 02646000
DCBMRRD  EQU   DCBMRAPG                                                 02647000
DCBMRCI  EQU   DCBMACR1                                                 02648000
DCBMRMVG EQU   DCBMRCI                                                  02649000
DCBMRLCG EQU   DCBMACR1                                                 02650000
DCBMRABC EQU   DCBMACR1                                                 02651000
DCBMRPT1 EQU   DCBMRABC                                                 02652000
DCBMRSBG EQU   DCBMRPT1                                                 02653000
DCBMRCRL EQU   DCBMACR1                                                 02654000
DCBMRCHK EQU   DCBMRCRL                                                 02655000
DCBMRRDX EQU   DCBMRCHK                                                 02656000
DCBMRDMG EQU   DCBMACR1                                                 02657000
DCBMACR2 EQU   DCBMACR+1                                                02658000
DCBMRPUT EQU   DCBMACR2                                                 02659000
DCBMRWRT EQU   DCBMACR2                                                 02660000
DCBMRMVP EQU   DCBMACR2                                                 02661000
DCBMR5WD EQU   DCBMACR2                                                 02662000
DCBMRLDM EQU   DCBMR5WD                                                 02663000
DCBMRLCP EQU   DCBMRLDM                                                 02664000
DCBMR4WD EQU   DCBMACR2                                                 02665000
DCBMRPT2 EQU   DCBMR4WD                                                 02666000
DCBMRTMD EQU   DCBMRPT2                                                 02667000
DCBMR3WD EQU   DCBMACR2                                                 02668000
DCBMRCTL EQU   DCBMR3WD                                                 02669000
DCBMRSTK EQU   DCBMRCTL                                                 02670000
DCBMR1WD EQU   DCBMACR2                                                 02671000
DCBMRSWA EQU   DCBMR1WD                                                 02672000
DCBMRDMD EQU   DCBMRSWA                                                 02673000
IHADCS25 EQU   0                                                        02674000
DCBMACRF EQU   IHADCS25+2                                               02675000
DCBMACF1 EQU   DCBMACRF                                                 02676000
DCBMFFE  EQU   DCBMACF1                                                 02677000
DCBMFGET EQU   DCBMFFE                                                  02678000
DCBMFAPG EQU   DCBMACF1                                                 02679000
DCBMFRD  EQU   DCBMFAPG                                                 02680000
DCBMFCI  EQU   DCBMACF1                                                 02681000
DCBMFMVG EQU   DCBMFCI                                                  02682000
DCBMFLCG EQU   DCBMACF1                                                 02683000
DCBMFABC EQU   DCBMACF1                                                 02684000
DCBMFPT1 EQU   DCBMFABC                                                 02685000
DCBMFSBG EQU   DCBMFPT1                                                 02686000
DCBMFCRL EQU   DCBMACF1                                                 02687000
DCBMFCHK EQU   DCBMFCRL                                                 02688000
DCBMFDMG EQU   DCBMACF1                                                 02689000
DCBMACF2 EQU   DCBMACRF+1                                               02690000
DCBMFPUT EQU   DCBMACF2                                                 02691000
DCBMFWRT EQU   DCBMACF2                                                 02692000
DCBMFMVP EQU   DCBMACF2                                                 02693000
DCBMF5WD EQU   DCBMACF2                                                 02694000
DCBMFLDM EQU   DCBMF5WD                                                 02695000
DCBMFLCP EQU   DCBMFLDM                                                 02696000
DCBMF4WD EQU   DCBMACF2                                                 02697000
DCBMFPT2 EQU   DCBMF4WD                                                 02698000
DCBMFTMD EQU   DCBMFPT2                                                 02699000
DCBMF3WD EQU   DCBMACF2                                                 02700000
DCBMFCTL EQU   DCBMF3WD                                                 02701000
DCBMFSTK EQU   DCBMFCTL                                                 02702000
DCBMF1WD EQU   DCBMACF2                                                 02703000
DCBMFSWA EQU   DCBMF1WD                                                 02704000
DCBMFDMD EQU   DCBMFSWA                                                 02705000
DCBDEBAD EQU   IHADCS25+4                                               02706000
DCBIFLGS EQU   DCBDEBAD                                                 02707000
IHADCS27 EQU   0                                                        02708000
DCBGET   EQU   IHADCS27                                                 02709000
DCBPUT   EQU   DCBGET                                                   02710000
DCBGETA  EQU   DCBPUT+1                                                 02711000
IHADCS36 EQU   0                                                        02712000
DCBGERR  EQU   IHADCS36                                                 02713000
DCBPERR  EQU   DCBGERR                                                  02714000
DCBCHECK EQU   DCBPERR                                                  02715000
DCBOPTCD EQU   DCBCHECK                                                 02716000
DCBOPTH  EQU   DCBOPTCD                                                 02717000
DCBOPTO  EQU   DCBOPTH                                                  02718000
DCBOPTZ  EQU   DCBOPTCD                                                 02719000
DCBGERRA EQU   DCBCHECK+1                                               02720000
DCBPERRA EQU   DCBGERRA                                                 02721000
DCBSYNAD EQU   IHADCS36+4                                               02722000
DCBSYNA  EQU   DCBSYNAD+1                                               02723000
DCBCIND1 EQU   IHADCS36+8                                               02724000
DCBCIND2 EQU   IHADCS36+9                                               02725000
DCBIOBA  EQU   IHADCS36+16                                              02726000
DCBCICB  EQU   DCBIOBA                                                  02727000
IHADCS52 EQU   0                                                        02728000
DCBDIRCT EQU   IHADCS52                                                 02729000
DCBQSWS  EQU   DCBDIRCT                                                 02730000
DCBUSASI EQU   DCBQSWS                                                  02731000
DCBQADFS EQU   DCBUSASI                                                 02732000
DCBBUFOF EQU   DCBDIRCT+1                                               02733000
IHADCS37 EQU   0                                                        02734000
DCBFLAG1 EQU   IHADCS37                                                 02735000
IHADCS40 EQU   0                                                        02736000
DCBEOBAD EQU   IHADCS40                                                 02737000
DCBCCCW  EQU   IHADCS40+4                                               02738000
DCBRECAD EQU   DCBCCCW                                                  02739000
DCBRECBT EQU   DCBRECAD                                                 02740000
DCBRCREL EQU   DCBRECBT                                                 02741000
DCBCNTRL EQU   IHADCS40+12                                              02742000
DCBEROPT EQU   DCBCNTRL                                                 02743000
DTMVT    EQU   0                                                        02744000
DTMVNUM  EQU   DTMVT                                                    02745000
DTMVOPT  EQU   DTMVT+4                                                  02746000
MFCOA    EQU   0                                                        02747000
MFCOTCE  EQU   MFCOA                                                    02748000
MFCOTCEF EQU   MFCOTCE                                                  02749000
MFCOTCEL EQU   MFCOTCE+3                                                02750000
MFCOCYC  EQU   MFCOA+4                                                  02751000
MFCOCYCF EQU   MFCOCYC                                                  02752000
MFCOOUT  EQU   MFCOA+8                                                  02753000
MFCOOUTF EQU   MFCOOUT                                                  02754000
MFCOOUTV EQU   MFCOOUT+3                                                02755000
MFCOINT  EQU   MFCOA+12                                                 02756000
MFCOINTF EQU   MFCOINT                                                  02757000
MFCOREP  EQU   MFCOA+16                                                 02758000
MFCOREPF EQU   MFCOREP                                                  02759000
MFCOREPL EQU   MFCOREP+3                                                02760000
MFCOREPV EQU   MFCOREPL                                                 02761000
MFCOSTP  EQU   MFCOA+20                                                 02762000
MFCOSTPF EQU   MFCOSTP                                                  02763000
MFCOOPI  EQU   MFCOA+24                                                 02764000
MFCOOPIF EQU   MFCOOPI                                                  02765000
MFCOOPIL EQU   MFCOOPI+3                                                02766000
MFCOMEM  EQU   MFCOA+28                                                 02767000
MFCOMEMF EQU   MFCOMEM                                                  02768000
MFPMA    EQU   0                                                        02769000
MFPMOPT  EQU   MFPMA                                                    02770000
@NM00036 EQU   MFPMOPT+3                                                02771000
MFPMSARG EQU   MFPMA+4                                                  02772000
IRBMFALL EQU   0                                                        02773000
IRBMFCNV EQU   0                                                        02774000
IRBMFMPR EQU   0                                                        02775000
IRBMFRXR EQU   0                                                        02776000
RGSBPLLN EQU   0                                                        02777000
SMFRCD70 EQU   0                                                        02778000
SMF70FLG EQU   SMFRCD70+4                                               02779000
SMF70SID EQU   SMFRCD70+14                                              02780000
SMF70SIZ EQU   SMFRCD70+18                                              02781000
SMF70IST EQU   SMFRCD70+20                                              02782000
SMF70DAT EQU   SMFRCD70+24                                              02783000
SMF70INT EQU   SMFRCD70+28                                              02784000
SMF70CYC EQU   SMFRCD70+32                                              02785000
SMF70MFV EQU   SMFRCD70+40                                              02786000
SMF70RLS EQU   SMFRCD70+44                                              02787000
SMF70PTR EQU   0                                                        02788000
SMF70A   EQU   0                                                        02789000
SMF70SCC EQU   SMF70A                                                   02790000
SMF70B   EQU   0                                                        02791000
SMF70CNF EQU   SMF70B+11                                                02792000
LNGTXT   EQU   0                                                        02793000
LNGTXTL  EQU   LNGTXT                                                   02794000
LNGTXTD  EQU   LNGTXT+4                                                 02795000
SYMESSAG EQU   0                                                        02796000
IKEBC    EQU   0                                                        02797000
IKEBF15  EQU   0                                                        02798000
IKEBF31  EQU   0                                                        02799000
IKEBP15  EQU   0                                                        02800000
IKEBP31  EQU   0                                                        02801000
IKEBP8   EQU   0                                                        02802000
MFSEL    EQU   0                                                        02803000
MFSEPARM EQU   MFSEL+4                                                  02804000
MFSESECB EQU   MFSEL+20                                                 02805000
MFSECOA  EQU   MFSEL+24                                                 02806000
MFSEDTMV EQU   MFSEL+28                                                 02807000
MFSESTID EQU   MFSEL+32                                                 02808000
MFSEFLAG EQU   MFSEL+47                                                 02809000
MFSERTRY EQU   MFSEFLAG                                                 02810000
MFSEMDCB EQU   MFSEL+48                                                 02811000
MFPCALST EQU   0                                                        02812000
MFMVT    EQU   0                                                        02813000
MFMVNUM  EQU   MFMVT                                                    02814000
MFMVOPT  EQU   MFMVT+4                                                  02815000
ISTEXT   EQU   0                                                        02816000
ISTXTLEN EQU   0                                                        02817000
ISBEGLIN EQU   0                                                        02818000
ISBEGCOL EQU   0                                                        02819000
HDRECPTR EQU   0                                                        02820000
HDTITLE  EQU   0                                                        02821000
HDTITLEN EQU   0                                                        02822000
HDPAGE   EQU   0                                                        02823000
DTMVADD  EQU   DTMVOPT                                                  02824000
MFCOOPTN EQU   MFCOA                                                    02825000
MFMVADD  EQU   MFMVOPT                                                  02826000
MFPMB    EQU   MFPMOPT                                                  02827000
@NM00039 EQU   MFPMB+2                                                  02828000
MFPMDEVF EQU   @NM00039                                                 02829000
MFPMC    EQU   MFPMOPT                                                  02830000
@NM00041 EQU   MFPMC+3                                                  02831000
RGPAGE   EQU   RGGENPAG                                                 02832000
RGLASTLN EQU   RGPAGE                                                   02833000
RGPAGIMG EQU   RGPAGE+2                                                 02834000
RGLINCTL EQU   RGPAGIMG                                                 02835000
RGLENGTH EQU   RGLINCTL                                                 02836000
RGFILL   EQU   RGLINCTL+2                                               02837000
RGCARCTL EQU   RGLINCTL+4                                               02838000
RGLINE   EQU   RGPAGIMG+5                                               02839000
HDRELEAS EQU   SMF70FLG                                                 02840000
LNG      EQU   IRBMFLTV                                                 02841000
LNGTPTR  EQU   LNG                                                      02842000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02843000
MFPMWKLD EQU   @NM00041                                                 02844000
@NM00042 EQU   @NM00041                                                 02845000
@NM00040 EQU   MFPMC                                                    02846000
MFPMCRDR EQU   MFPMDEVF                                                 02847000
MFPMUNIT EQU   MFPMDEVF                                                 02848000
MFPMGRAP EQU   MFPMDEVF                                                 02849000
MFPMDA   EQU   MFPMDEVF                                                 02850000
MFPMTP   EQU   MFPMDEVF                                                 02851000
MFPMTAPE EQU   MFPMDEVF                                                 02852000
@NM00038 EQU   MFPMB                                                    02853000
MFCOCTRL EQU   MFCOOPTN                                                 02854000
MFMVDEV  EQU   MFMVOPT+16                                               02855000
MFMVCHA  EQU   MFMVOPT+12                                               02856000
MFMVWKL  EQU   MFMVOPT+8                                                02857000
MFMVPAG  EQU   MFMVOPT+4                                                02858000
MFMVCPU  EQU   MFMVOPT                                                  02859000
@NM00045 EQU   MFSEFLAG                                                 02860000
@NM00044 EQU   MFSEL+44                                                 02861000
MFSEITOD EQU   MFSEL+36                                                 02862000
MFSESCOD EQU   MFSESECB+1                                               02863000
@NM00043 EQU   MFSESECB                                                 02864000
MFSESTAD EQU   MFSEL+16                                                 02865000
MFSEMFMV EQU   MFSEPARM+8                                               02866000
MFSEALST EQU   MFSEPARM+4                                               02867000
MFSESEL  EQU   MFSEPARM                                                 02868000
MFSENEXT EQU   MFSEL                                                    02869000
SMF70SER EQU   SMF70B+13                                                02870000
SMF70RV4 EQU   SMF70B+12                                                02871000
SMF70STA EQU   SMF70CNF                                                 02872000
SMF70VAC EQU   SMF70CNF                                                 02873000
@NM00046 EQU   SMF70CNF                                                 02874000
SMF70RV3 EQU   SMF70B+10                                                02875000
SMF70CID EQU   SMF70B+8                                                 02876000
SMF70WAT EQU   SMF70B                                                   02877000
SMF70RV2 EQU   SMF70A+6                                                 02878000
SMF70SCD EQU   SMF70A+4                                                 02879000
SMF70CPU EQU   SMF70A+2                                                 02880000
SMF70RV1 EQU   SMFRCD70+42                                              02881000
SMF70SAM EQU   SMFRCD70+36                                              02882000
SMF70SUB EQU   SMFRCD70+34                                              02883000
SMF70DTE EQU   SMFRCD70+10                                              02884000
SMF70TME EQU   SMFRCD70+6                                               02885000
SMF70RTY EQU   SMFRCD70+5                                               02886000
SMF70SEG EQU   SMFRCD70+2                                               02887000
SMF70LEN EQU   SMFRCD70                                                 02888000
MFPMSTA  EQU   @NM00036                                                 02889000
@NM00037 EQU   @NM00036                                                 02890000
@NM00035 EQU   MFPMOPT                                                  02891000
MFPMCON  EQU   MFPMOPT                                                  02892000
MFCOMEMV EQU   MFCOMEM+2                                                02893000
@NM00034 EQU   MFCOMEM+1                                                02894000
MFCOMEMC EQU   MFCOMEMF                                                 02895000
MFCOOPIV EQU   MFCOOPIL                                                 02896000
@NM00033 EQU   MFCOOPIL                                                 02897000
@NM00032 EQU   MFCOOPI+1                                                02898000
MFCOOPIC EQU   MFCOOPIF                                                 02899000
MFCOSTPV EQU   MFCOSTP+2                                                02900000
@NM00031 EQU   MFCOSTP+1                                                02901000
MFCOSTPU EQU   MFCOSTPF                                                 02902000
MFCOSTPS EQU   MFCOSTPF                                                 02903000
MFCOSTPC EQU   MFCOSTPF                                                 02904000
@NM00030 EQU   MFCOREPL                                                 02905000
@NM00029 EQU   MFCOREP+1                                                02906000
MFCOREPC EQU   MFCOREPF                                                 02907000
MFCOINTV EQU   MFCOINT+2                                                02908000
@NM00028 EQU   MFCOINT+1                                                02909000
MFCOINTC EQU   MFCOINTF                                                 02910000
@NM00027 EQU   MFCOOUT+1                                                02911000
MFCOOUTC EQU   MFCOOUTF                                                 02912000
MFCOCYCV EQU   MFCOCYC+2                                                02913000
@NM00026 EQU   MFCOCYC+1                                                02914000
MFCOCYCC EQU   MFCOCYCF                                                 02915000
MFCOTCEV EQU   MFCOTCEL                                                 02916000
@NM00025 EQU   MFCOTCEL                                                 02917000
@NM00024 EQU   MFCOTCE+1                                                02918000
MFCOTCEC EQU   MFCOTCEF                                                 02919000
DTMVDEV  EQU   DTMVOPT+16                                               02920000
DTMVCHA  EQU   DTMVOPT+12                                               02921000
DTMVWKL  EQU   DTMVOPT+8                                                02922000
DTMVPAG  EQU   DTMVOPT+4                                                02923000
DTMVCPU  EQU   DTMVOPT                                                  02924000
DCBEOB   EQU   IHADCS40+20                                              02925000
DCBPRECL EQU   IHADCS40+18                                              02926000
@NM00023 EQU   IHADCS40+16                                              02927000
DCBCNTRA EQU   DCBCNTRL+1                                               02928000
@NM00022 EQU   DCBEROPT                                                 02929000
DCBERABE EQU   DCBEROPT                                                 02930000
DCBERSKP EQU   DCBEROPT                                                 02931000
DCBERACC EQU   DCBEROPT                                                 02932000
DCBLRECL EQU   IHADCS40+10                                              02933000
@NM00021 EQU   IHADCS40+9                                               02934000
@NM00020 EQU   IHADCS40+8                                               02935000
DCBRECA  EQU   DCBRECAD+1                                               02936000
@NM00019 EQU   DCBRECBT                                                 02937000
DCBRCFGT EQU   DCBRCREL                                                 02938000
DCBRCTRU EQU   DCBRCREL                                                 02939000
DCBLCCW  EQU   DCBEOBAD                                                 02940000
@NM00018 EQU   DCBFLAG1                                                 02941000
DCBSTFLS EQU   DCBFLAG1                                                 02942000
DCBSTQCK EQU   DCBFLAG1                                                 02943000
DCBDIRCQ EQU   DCBBUFOF                                                 02944000
DCBQSTRU EQU   DCBUSASI                                                 02945000
@NM00017 EQU   DCBUSASI                                                 02946000
DCBQADF3 EQU   DCBQADFS                                                 02947000
DCBQADF2 EQU   DCBQADFS                                                 02948000
DCBQADF1 EQU   DCBQADFS                                                 02949000
DCBBLBP  EQU   DCBUSASI                                                 02950000
@NM00016 EQU   DCBUSASI                                                 02951000
DCBCICBA EQU   DCBCICB+1                                                02952000
@NM00015 EQU   DCBCICB                                                  02953000
DCBOFFSW EQU   IHADCS36+15                                              02954000
DCBOFFSR EQU   IHADCS36+14                                              02955000
DCBWCPL  EQU   IHADCS36+13                                              02956000
DCBWCPO  EQU   IHADCS36+12                                              02957000
DCBBLKSI EQU   IHADCS36+10                                              02958000
DCBCNQSM EQU   DCBCIND2                                                 02959000
DCBCNFEO EQU   DCBCIND2                                                 02960000
DCBCNCHS EQU   DCBCIND2                                                 02961000
DCBCNBFP EQU   DCBCIND2                                                 02962000
DCBCNIOE EQU   DCBCIND2                                                 02963000
DCBCNCLO EQU   DCBCIND2                                                 02964000
DCBCNWRO EQU   DCBCIND2                                                 02965000
DCBCNSTO EQU   DCBCIND2                                                 02966000
DCBCNEXB EQU   DCBCIND1                                                 02967000
@NM00014 EQU   DCBCIND1                                                 02968000
DCBCNBRM EQU   DCBCIND1                                                 02969000
@NM00013 EQU   DCBCIND1                                                 02970000
DCBCNEVA EQU   DCBCIND1                                                 02971000
DCBCNEVB EQU   DCBCIND1                                                 02972000
DCBCNSRD EQU   DCBCIND1                                                 02973000
DCBCNTOV EQU   DCBCIND1                                                 02974000
DCBIOBL  EQU   DCBSYNAD                                                 02975000
DCBCHCKA EQU   DCBPERRA                                                 02976000
@NM00012 EQU   DCBOPTCD                                                 02977000
DCBOPTT  EQU   DCBOPTCD                                                 02978000
DCBSRCHD EQU   DCBOPTZ                                                  02979000
DCBOPTQ  EQU   DCBOPTCD                                                 02980000
DCBBCKPT EQU   DCBOPTO                                                  02981000
DCBOPTC  EQU   DCBOPTCD                                                 02982000
DCBOPTU  EQU   DCBOPTCD                                                 02983000
DCBOPTW  EQU   DCBOPTCD                                                 02984000
DCBPUTA  EQU   DCBGETA                                                  02985000
@NM00011 EQU   DCBPUT                                                   02986000
DCBDEBA  EQU   DCBDEBAD+1                                               02987000
@NM00010 EQU   DCBIFLGS                                                 02988000
DCBIFIOE EQU   DCBIFLGS                                                 02989000
DCBIFPCT EQU   DCBIFLGS                                                 02990000
DCBIFEC  EQU   DCBIFLGS                                                 02991000
DCBMFSTI EQU   DCBMFDMD                                                 02992000
DCBMFAWR EQU   DCBMFSTK                                                 02993000
DCBMFUIP EQU   DCBMFTMD                                                 02994000
DCBMFIDW EQU   DCBMFLCP                                                 02995000
DCBMFWRK EQU   DCBMFMVP                                                 02996000
DCBMFRDQ EQU   DCBMFWRT                                                 02997000
DCBMFGTQ EQU   DCBMFPUT                                                 02998000
DCBMFSTL EQU   DCBMACF2                                                 02999000
DCBMFCK  EQU   DCBMFDMG                                                 03000000
DCBMFRDX EQU   DCBMFCHK                                                 03001000
DCBMFDBF EQU   DCBMFSBG                                                 03002000
DCBMFRDI EQU   DCBMFLCG                                                 03003000
DCBMFRDK EQU   DCBMFMVG                                                 03004000
DCBMFWRQ EQU   DCBMFRD                                                  03005000
DCBMFPTQ EQU   DCBMFGET                                                 03006000
DCBMFECP EQU   DCBMACF1                                                 03007000
DCBTIOT  EQU   IHADCS25                                                 03008000
DCBMRSTI EQU   DCBMRDMD                                                 03009000
DCBMRAWR EQU   DCBMRSTK                                                 03010000
DCBMRUIP EQU   DCBMRTMD                                                 03011000
DCBMRIDW EQU   DCBMRLCP                                                 03012000
DCBMRWRK EQU   DCBMRMVP                                                 03013000
DCBMRRDQ EQU   DCBMRWRT                                                 03014000
DCBMRGTQ EQU   DCBMRPUT                                                 03015000
DCBMRSTL EQU   DCBMACR2                                                 03016000
DCBMRCK  EQU   DCBMRDMG                                                 03017000
DCBPGFXA EQU   DCBMRRDX                                                 03018000
DCBMRDBF EQU   DCBMRSBG                                                 03019000
DCBMRRDI EQU   DCBMRLCG                                                 03020000
DCBMRRDK EQU   DCBMRMVG                                                 03021000
DCBMRWRQ EQU   DCBMRRD                                                  03022000
DCBMRPTQ EQU   DCBMRGET                                                 03023000
DCBMRECP EQU   DCBMACR1                                                 03024000
@NM00009 EQU   DCBIFLG                                                  03025000
DCBIBIOE EQU   DCBIFLG                                                  03026000
DCBIBPCT EQU   DCBIFLG                                                  03027000
DCBIBEC  EQU   DCBIFLG                                                  03028000
DCBOFIOF EQU   DCBOFLGS                                                 03029000
DCBOFUEX EQU   DCBOFLGS                                                 03030000
DCBOFTM  EQU   DCBOFLGS                                                 03031000
DCBOFPPC EQU   DCBOFLGS                                                 03032000
DCBOFEOV EQU   DCBOFLGS                                                 03033000
DCBOFLRB EQU   DCBOFLGS                                                 03034000
DCBOFIOD EQU   DCBOFLWR                                                 03035000
DCBEXLSA EQU   DCBEXLST+1                                               03036000
DCBRECKL EQU   DCBRECFM                                                 03037000
DCBRECCC EQU   DCBRECFM                                                 03038000
DCBRECSB EQU   DCBRECFM                                                 03039000
DCBRECBR EQU   DCBRECFM                                                 03040000
DCBRECTO EQU   DCBRECLA                                                 03041000
DCBRECL  EQU   DCBRECLA                                                 03042000
DCBEODA  EQU   DCBEODAD+1                                               03043000
DCBBFA   EQU   DCBBFTEK                                                 03044000
DCBH0    EQU   DCBBFTEK                                                 03045000
DCBBFTKD EQU   DCBBFTEK                                                 03046000
DCBBFTE  EQU   DCBBFT                                                   03047000
DCBBFTKR EQU   DCBBFT                                                   03048000
DCBBFTS  EQU   DCBBFT                                                   03049000
DCBH1    EQU   DCBBFTEK                                                 03050000
DCBSVCXA EQU   DCBSVCXL+1                                               03051000
@NM00008 EQU   DCBSVCXL                                                 03052000
DCBODEBA EQU   DCBIOBAA                                                 03053000
@NM00007 EQU   DCBQSLM                                                  03054000
DCBUPDBT EQU   DCBQSLM                                                  03055000
DCBUPDCM EQU   DCBQSLM                                                  03056000
DCB1DVDS EQU   DCBQSLM                                                  03057000
@NM00006 EQU   DCBDSRG2                                                 03058000
DCBDSGTR EQU   DCBDSRG2                                                 03059000
DCBACBM  EQU   DCBDSRG2                                                 03060000
@NM00005 EQU   DCBDSRG2                                                 03061000
DCBDSGTQ EQU   DCBDSRG2                                                 03062000
DCBDSGTX EQU   DCBDSRG2                                                 03063000
DCBDSGGS EQU   DCBDSRG2                                                 03064000
DCBDSGU  EQU   DCBDSRG1                                                 03065000
DCBDSGPO EQU   DCBDSRG1                                                 03066000
DCBDSGMQ EQU   DCBDSRG1                                                 03067000
DCBDSGCQ EQU   DCBDSRG1                                                 03068000
DCBDSGCX EQU   DCBDSRG1                                                 03069000
DCBDSGDA EQU   DCBDSRG1                                                 03070000
DCBDSGPS EQU   DCBDSRG1                                                 03071000
DCBDSGIS EQU   DCBDSRG1                                                 03072000
DCBBUFL  EQU   IHADCS11+8                                               03073000
DCBBUFCA EQU   DCBBUFCB+1                                               03074000
DCBBUFNO EQU   DCBBUFCB                                                 03075000
DCBDEVT  EQU   DCBREL                                                   03076000
DCBKEYLE EQU   DCBRELB                                                  03077000
DCBTRBAL EQU   IHADCS01+6                                               03078000
@NM00004 EQU   IHADCS01+5                                               03079000
@NM00003 EQU   IHADCS01+4                                               03080000
DCBDVTBA EQU   DCBDVTBL+1                                               03081000
@NM00002 EQU   DCBDVTBL                                                 03082000
DCBKEYCN EQU   IHADCS00+4                                               03083000
DCBRELAD EQU   IHADCS00                                                 03084000
@NM00001 EQU   IHADCB                                                   03085000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03086000
@RT00109 EQU   RGERR1                                                   03087000
@RT00114 EQU   RGLAB2                                                   03088000
@RT00132 EQU   RGLAB3                                                   03089000
@RF00255 EQU   @EL00003                                                 03090000
@RT00268 EQU   @EL00004                                                 03091000
@PB00005 EQU   @EL00001                                                 03092000
@PB00004 EQU   @PB00005                                                 03093000
@PB00003 EQU   @PB00004                                                 03094000
@PB00002 EQU   @PB00003                                                 03095000
@ENDDATA EQU   *                                                        03096000
         END   IRBMFRGM,(C'PL/S-II',0502,74087)                         03097000
