         TITLE '*/* IRBMFRHR - CHANNEL REPORT GENERATOR                *00001000
                       '                                                00002000
IRBMFRHR CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IRBMFRHR  74.087'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @10,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@10                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN R,LV=(0)                                               00015000
         LR    @09,@01                                             0001 00016000
         USING @DATD,@09                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @09,8(,@13)                                         0001 00020000
         LR    @13,@09                                             0001 00021000
         MVC   @PC00001(12),0(@01)                                 0001 00022000
*                                                                  0013 00023000
*/* BEGIN MAINLINE PROCESSING                                        */ 00024000
*                                                                  0013 00025000
*   /*****************************************************************/ 00026000
*   /*                                                               */ 00027000
*   /* BEGIN REPORT GENERATOR PROCESSING. CREATE ONE REPORT ONLY.    */ 00028000
*   /* FIRST INITIALIZE VARIABLES.                                   */ 00029000
*   /*                                                               */ 00030000
*   /*****************************************************************/ 00031000
*                                                                  0013 00032000
*   RHPAGE=1;                       /* FIRST PAGE                    */ 00033000
         LA    @08,1                                               0013 00034000
         ST    @08,RHPAGE                                          0013 00035000
*   RHLINE=RGMAXLN;                 /* TRIGGER HEADING BY SETTING  0014 00036000
*                                      LINE NUMBER ABOVE MAXIMUM     */ 00037000
         MVC   RHLINE(4),@CF00085                                  0014 00038000
*   RHCPUNO=-1;                     /* PRESET CPU NUMBER TO TRIGGER     00039000
*                                      NEW CPU                       */ 00040000
*                                                                  0015 00041000
         MVC   RHCPUNO(4),@CF00216                                 0015 00042000
*   /*****************************************************************/ 00043000
*   /*                                                               */ 00044000
*   /* LOOP THROUGH CHANNEL ENTRIES                                  */ 00045000
*   /*                                                               */ 00046000
*   /*****************************************************************/ 00047000
*                                                                  0016 00048000
*   DO RHCHAIDX=1 TO SMF73CHA+1;    /* LAST LOOP IS TO PRINT FINAL 0016 00049000
*                                      TOTALS                        */ 00050000
*                                                                  0016 00051000
         LR    RHCHAIDX,@08                                        0016 00052000
         B     @DE00016                                            0016 00053000
@DL00016 DS    0H                                                  0017 00054000
*     /***************************************************************/ 00055000
*     /*                                                             */ 00056000
*     /* CHECK FOR END OF OLD CPU AND BEGINNING OF NEW CPU OR LAST   */ 00057000
*     /* TIME THROUGH LOOP                                           */ 00058000
*     /*                                                             */ 00059000
*     /***************************************************************/ 00060000
*                                                                  0017 00061000
*     IF RHCHAIDX=SMF73CHA+1|RHCPUNO^=SMF73CID(RHCHAIDX)THEN       0017 00062000
         L     @08,@PC00001                                        0017 00063000
         L     @08,RHDTAPTR(,@08)                                  0017 00064000
         LA    @03,SMF73SIZ(,@08)                                  0017 00065000
         AH    @03,SMF73SIZ(,@08)                                  0017 00066000
         LA    @08,1                                               0017 00067000
         AH    @08,SMF73CHA(,@03)                                  0017 00068000
         CR    RHCHAIDX,@08                                        0017 00069000
         BE    @RT00017                                            0017 00070000
         LR    @08,RHCHAIDX                                        0017 00071000
         SLA   @08,4                                               0017 00072000
         LH    @15,SMF73SHC(,@03)                                  0017 00073000
         AR    @15,@03                                             0017 00074000
         L     @03,RHCPUNO                                         0017 00075000
         AL    @15,@CF00240                                        0017 00076000
         CH    @03,SMF73CID(@08,@15)                               0017 00077000
         BE    @RF00017                                            0017 00078000
@RT00017 DS    0H                                                  0018 00079000
*       DO;                                                        0018 00080000
*         IF RHCHAIDX^=1 THEN       /* IF NOT THE FIRST ENTRY        */ 00081000
         LA    @08,1                                               0019 00082000
         CR    RHCHAIDX,@08                                        0019 00083000
         BE    @RF00019                                            0019 00084000
*           DO;                                                    0020 00085000
*                                                                  0020 00086000
*             /*******************************************************/ 00087000
*             /*                                                     */ 00088000
*             /* PRINT TOTALS                                        */ 00089000
*             /*                                                     */ 00090000
*             /*******************************************************/ 00091000
*                                                                  0021 00092000
*             RHLINE=RHLINE+1;      /* ONE BLANK LINE                */ 00093000
*                                                                  0021 00094000
         A     @08,RHLINE                                          0021 00095000
         ST    @08,RHLINE                                          0021 00096000
*             /*******************************************************/ 00097000
*             /*                                                     */ 00098000
*             /* INSERT 'TOTAL' MACDATE Y-2 73018                    */ 00099000
*             /*                                                     */ 00100000
*             /*******************************************************/ 00101000
*                                                                  0022 00102000
*             CALL MFISRTXT(        /* INSERT TEXT ROUTINE           */ 00103000
*                 LNGTPTR(LHPART1)->LNGTXTD,/* TEXT                  */ 00104000
*                 LNGTPTR(LHPART1)->LNGTXTL,/* LENGTH                */ 00105000
*                 RHLINE,           /* START LINE                    */ 00106000
*                 COLA              /* START COLUMN                  */ 00107000
*                 );                                               0022 00108000
*                                                                  0022 00109000
         L     @08,@CA00100                                        0022 00110000
         L     @08,LNGTPTR-IRBMFLHV(,@08)                          0022 00111000
         LA    @03,LNGTXTD(,@08)                                   0022 00112000
         ST    @03,@AL00001                                        0022 00113000
         ST    @08,@AL00001+4                                      0022 00114000
         LA    @08,RHLINE                                          0022 00115000
         ST    @08,@AL00001+8                                      0022 00116000
         LA    @08,@CF00075                                        0022 00117000
         ST    @08,@AL00001+12                                     0022 00118000
         L     @08,@PC00001+4                                      0022 00119000
         L     @15,RHVECTAB+8(,@08)                                0022 00120000
         LA    @01,@AL00001                                        0022 00121000
         BALR  @14,@15                                             0022 00122000
*             /*******************************************************/ 00123000
*             /*                                                     */ 00124000
*             /* INSERT TOTAL SIOS FOR CPU. IF LT 1,000,000,INSERT AS*/ 00125000
*             /* NNN,NNN. IF GE 1,000,000, INSERT AS N,NNN,NNN.NNNM  */ 00126000
*             /*                                                     */ 00127000
*             /*******************************************************/ 00128000
*                                                                  0023 00129000
*             IF RHSIOTOT<1000000 THEN                             0023 00130000
         L     @08,RHSIOTOT                                        0023 00131000
         C     @08,@CF00217                                        0023 00132000
         BNL   @RF00023                                            0023 00133000
*               DO;                                                0024 00134000
*                                                                  0024 00135000
*                 /***************************************************/ 00136000
*                 /*                                                 */ 00137000
*                 /* MACDATE Y-2 73018                               */ 00138000
*                 /*                                                 */ 00139000
*                 /***************************************************/ 00140000
*                                                                  0025 00141000
*                 CALL IRBMFCNV(    /* CONVERSION ROUTINE            */ 00142000
*                     RHSIOTOT,     /* INPUT VALUE                   */ 00143000
*                     RHDATSCF,     /* INPUT SCALE                   */ 00144000
*                     RHWRKSTR,     /* OUTPUT STRING                 */ 00145000
*                     RHCOUNTL,     /* OUTPUT LENGTH                 */ 00146000
*                     RHNOPLCE,     /* PLACES RIGHT OF DEC PT        */ 00147000
*                     RHCOMMAS,     /* COMMAS FLAG                   */ 00148000
*                     RHNOFLOT      /* MAX PRECISION FLAG            */ 00149000
*                     );                                           0025 00150000
*                                                                  0025 00151000
         MVC   @AL00001+4(24),@AL00025                             0025 00152000
         LA    @08,RHSIOTOT                                        0025 00153000
         ST    @08,@AL00001                                        0025 00154000
         LA    @08,RHWRKSTR                                        0025 00155000
         ST    @08,@AL00001+8                                      0025 00156000
         L     @08,@PC00001+4                                      0025 00157000
         L     @15,RHVECTAB(,@08)                                  0025 00158000
         LA    @01,@AL00001                                        0025 00159000
         BALR  @14,@15                                             0025 00160000
*                 /***************************************************/ 00161000
*                 /*                                                 */ 00162000
*                 /* MACDATE Y-2 73018                               */ 00163000
*                 /*                                                 */ 00164000
*                 /***************************************************/ 00165000
*                                                                  0026 00166000
*                 CALL MFISRTXT(    /* INSERT TEXT ROUTINE           */ 00167000
*                     RHWRKSTR,     /* TEXT                          */ 00168000
*                     RHCOUNTL,     /* LENGTH                        */ 00169000
*                     RHLINE,       /* START LINE                    */ 00170000
*                     COLD          /* START COLUMN                  */ 00171000
*                     );                                           0026 00172000
         LA    @08,RHWRKSTR                                        0026 00173000
         ST    @08,@AL00001                                        0026 00174000
         LA    @08,@CF00114                                        0026 00175000
         ST    @08,@AL00001+4                                      0026 00176000
         LA    @08,RHLINE                                          0026 00177000
         ST    @08,@AL00001+8                                      0026 00178000
         LA    @08,@CF00200                                        0026 00179000
         ST    @08,@AL00001+12                                     0026 00180000
         L     @08,@PC00001+4                                      0026 00181000
         L     @15,RHVECTAB+8(,@08)                                0026 00182000
         LA    @01,@AL00001                                        0026 00183000
         BALR  @14,@15                                             0026 00184000
*               END;                                               0027 00185000
*             ELSE                                                 0028 00186000
*               DO;                                                0028 00187000
*                                                                  0028 00188000
         B     @RC00023                                            0028 00189000
@RF00023 DS    0H                                                  0029 00190000
*                 /***************************************************/ 00191000
*                 /*                                                 */ 00192000
*                 /* MACDATE Y-2 73018                               */ 00193000
*                 /*                                                 */ 00194000
*                 /***************************************************/ 00195000
*                                                                  0029 00196000
*                 CALL IRBMFCNV(    /* CONVERSION ROUTINE            */ 00197000
*                     RHSIOTOT,     /* INPUT VALUE                   */ 00198000
*                     RHMILSCF,     /* INPUT SCALE                   */ 00199000
*                     RHWRKSTR,     /* OUTPUT STRING                 */ 00200000
*                     RHCOUNTM,     /* OUTPUT LENGTH                 */ 00201000
*                     RHDECMIL,     /* PLACES RIGHT OF DEC PT        */ 00202000
*                     RHCOMMAS,     /* COMMAS FLAG                   */ 00203000
*                     RHNOFLOT      /* MAX PRECISION FLAG            */ 00204000
*                     );                                           0029 00205000
         MVC   @AL00001+4(24),@AL00029                             0029 00206000
         LA    @08,RHSIOTOT                                        0029 00207000
         ST    @08,@AL00001                                        0029 00208000
         LA    @08,RHWRKSTR                                        0029 00209000
         ST    @08,@AL00001+8                                      0029 00210000
         L     @08,@PC00001+4                                      0029 00211000
         L     @15,RHVECTAB(,@08)                                  0029 00212000
         LA    @01,@AL00001                                        0029 00213000
         BALR  @14,@15                                             0029 00214000
*                 RHWRKSTR(14)='M'; /* MILLIONS                      */ 00215000
*                                                                  0030 00216000
         MVI   RHWRKSTR+13,C'M'                                    0030 00217000
*                 /***************************************************/ 00218000
*                 /*                                                 */ 00219000
*                 /* MACDATE Y-2 73018                               */ 00220000
*                 /*                                                 */ 00221000
*                 /***************************************************/ 00222000
*                                                                  0031 00223000
*                 CALL MFISRTXT(    /* INSERT TEXT ROUTINE           */ 00224000
*                     RHWRKSTR,     /* TEXT                          */ 00225000
*                     RHCOUNTM+1,   /* LENGTH                        */ 00226000
*                     RHLINE,       /* START LINE                    */ 00227000
*                     COLD+RHMILSCF /* START COLUMN                  */ 00228000
*                     );                                           0031 00229000
         LA    @08,RHWRKSTR                                        0031 00230000
         ST    @08,@AL00001                                        0031 00231000
         LA    @08,@CF00126                                        0031 00232000
         ST    @08,@AL00001+4                                      0031 00233000
         LA    @08,RHLINE                                          0031 00234000
         ST    @08,@AL00001+8                                      0031 00235000
         LA    @08,@CF00135                                        0031 00236000
         ST    @08,@AL00001+12                                     0031 00237000
         L     @08,@PC00001+4                                      0031 00238000
         L     @15,RHVECTAB+8(,@08)                                0031 00239000
         LA    @01,@AL00001                                        0031 00240000
         BALR  @14,@15                                             0031 00241000
*               END;                                               0032 00242000
*                                                                  0032 00243000
*             /*******************************************************/ 00244000
*             /*                                                     */ 00245000
*             /* SKIP TWO LINES                                      */ 00246000
*             /*                                                     */ 00247000
*             /*******************************************************/ 00248000
*                                                                  0033 00249000
*             RHLINE=RHLINE+2;                                     0033 00250000
*                                                                  0033 00251000
@RC00023 LA    @08,2                                               0033 00252000
         A     @08,RHLINE                                          0033 00253000
         ST    @08,RHLINE                                          0033 00254000
*             /*******************************************************/ 00255000
*             /*                                                     */ 00256000
*             /* DONT CONTINUE IF ON LAST LOOP                       */ 00257000
*             /*                                                     */ 00258000
*             /*******************************************************/ 00259000
*                                                                  0034 00260000
*             IF RHCHAIDX=SMF73CHA+1 THEN                          0034 00261000
         L     @08,@PC00001                                        0034 00262000
         L     @08,RHDTAPTR(,@08)                                  0034 00263000
         LA    @03,SMF73SIZ(,@08)                                  0034 00264000
         AH    @03,SMF73SIZ(,@08)                                  0034 00265000
         LA    @08,1                                               0034 00266000
         AH    @08,SMF73CHA(,@03)                                  0034 00267000
         CR    RHCHAIDX,@08                                        0034 00268000
         BE    @RT00034                                            0034 00269000
*               GO TO RHLAB4;                                      0035 00270000
*           END;                                                   0036 00271000
*                                                                  0036 00272000
*         /***********************************************************/ 00273000
*         /*                                                         */ 00274000
*         /* SET NEW CPU ID NUMBER                                   */ 00275000
*         /*                                                         */ 00276000
*         /***********************************************************/ 00277000
*                                                                  0037 00278000
*         RHCPUNO=SMF73CID(RHCHAIDX);                              0037 00279000
@RF00019 LR    @08,RHCHAIDX                                        0037 00280000
         SLA   @08,4                                               0037 00281000
         L     @03,@PC00001                                        0037 00282000
         L     @03,RHDTAPTR(,@03)                                  0037 00283000
         LA    @15,SMF73SIZ(,@03)                                  0037 00284000
         AH    @15,SMF73SIZ(,@03)                                  0037 00285000
         LH    @03,SMF73SHC(,@15)                                  0037 00286000
         AR    @03,@15                                             0037 00287000
         AL    @03,@CF00240                                        0037 00288000
         LH    @08,SMF73CID(@08,@03)                               0037 00289000
         ST    @08,RHCPUNO                                         0037 00290000
*         RHNEWCPU='1'B;            /* INDICATE NEW CPU              */ 00291000
*                                                                  0038 00292000
         OI    RHNEWCPU,B'10000000'                                0038 00293000
*         /***********************************************************/ 00294000
*         /*                                                         */ 00295000
*         /* INITIALIZE TOTALS ACCUMULATORS                          */ 00296000
*         /*                                                         */ 00297000
*         /***********************************************************/ 00298000
*                                                                  0039 00299000
*         RHCHACNT=-1;              /* INITIALIZE NUMBER OF CHANNELS    00300000
*                                      ON CPU                        */ 00301000
         MVC   RHCHACNT(4),@CF00216                                0039 00302000
*         RHSIOTOT=0;               /* SIO TOTAL OF CPU              */ 00303000
         SR    @08,@08                                             0040 00304000
         ST    @08,RHSIOTOT                                        0040 00305000
*       END;                                                       0041 00306000
*                                                                  0041 00307000
*     /***************************************************************/ 00308000
*     /*                                                             */ 00309000
*     /* IF NO MORE ROOM ON PAGE, GET NEW PAGE AND INSERT HEADER     */ 00310000
*     /*                                                             */ 00311000
*     /***************************************************************/ 00312000
*                                                                  0042 00313000
*     IF RHLINE>=(RGMAXLN-3)THEN                                   0042 00314000
@RF00017 L     @08,RHLINE                                          0042 00315000
         CH    @08,@CH00226                                        0042 00316000
         BL    @RF00042                                            0042 00317000
*       DO;                                                        0043 00318000
*         IF RHCHAIDX>1 THEN        /* IF THIS IS NOT FIRST PAGE     */ 00319000
         CH    RHCHAIDX,@CH00075                                   0044 00320000
         BNH   @RF00044                                            0044 00321000
*           CALL MFWRTPAG;          /* WRITE OUT PAGE IMAGE          */ 00322000
*                                                                  0045 00323000
         L     @08,@PC00001+4                                      0045 00324000
         L     @15,RHVECTAB+12(,@08)                               0045 00325000
         BALR  @14,@15                                             0045 00326000
*         /***********************************************************/ 00327000
*         /*                                                         */ 00328000
*         /* BUILD NEW HEADER. START WITH STANDARD HEADER            */ 00329000
*         /*                                                         */ 00330000
*         /***********************************************************/ 00331000
*                                                                  0046 00332000
*         CALL MFHDRISR(RHDTAPTR,   /* POINTER TO SMF RECORD         */ 00333000
*                                                                  0046 00334000
*         /***********************************************************/ 00335000
*         /*                                                         */ 00336000
*         /* TITLE                                                   */ 00337000
*         /*                                                         */ 00338000
*         /***********************************************************/ 00339000
*                                                                  0046 00340000
*             LNGTPTR(LHPART2)->LNGTXTD,                           0046 00341000
*                                                                  0046 00342000
*         /***********************************************************/ 00343000
*         /*                                                         */ 00344000
*         /* LENGTH OF TITLE                                         */ 00345000
*         /*                                                         */ 00346000
*         /***********************************************************/ 00347000
*                                                                  0046 00348000
*             LNGTPTR(LHPART2)->LNGTXTL,RHPAGE/* PAGE NUMBER         */ 00349000
*             );                                                   0046 00350000
@RF00044 L     @08,@PC00001                                        0046 00351000
         ST    @08,@AL00001                                        0046 00352000
         L     @08,@CA00100                                        0046 00353000
         L     @08,LNGTPTR-IRBMFLHV+4(,@08)                        0046 00354000
         LA    @03,LNGTXTD(,@08)                                   0046 00355000
         ST    @03,@AL00001+4                                      0046 00356000
         ST    @08,@AL00001+8                                      0046 00357000
         LA    @08,RHPAGE                                          0046 00358000
         ST    @08,@AL00001+12                                     0046 00359000
         L     @08,@PC00001+4                                      0046 00360000
         L     @15,RHVECTAB+4(,@08)                                0046 00361000
         LA    @01,@AL00001                                        0046 00362000
         BALR  @14,@15                                             0046 00363000
*         RHPAGE=RHPAGE+1;          /* NEW PAGE NUMBER               */ 00364000
*                                                                  0047 00365000
         LA    @08,1                                               0047 00366000
         A     @08,RHPAGE                                          0047 00367000
         ST    @08,RHPAGE                                          0047 00368000
*         /***********************************************************/ 00369000
*         /*                                                         */ 00370000
*         /* BUILD SPECIAL CHANNEL HEADER. FIRST INSERT 'CPU' MACDATE*/ 00371000
*         /* Y-2 73018                                               */ 00372000
*         /*                                                         */ 00373000
*         /***********************************************************/ 00374000
*                                                                  0048 00375000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00376000
*             LNGTPTR(LHPART3)->LNGTXTD,/* TEXT                      */ 00377000
*             LNGTPTR(LHPART3)->LNGTXTL,/* LENGTH                    */ 00378000
*             LINE10,               /* START LINE                    */ 00379000
*             COLA                  /* START COLUMN                  */ 00380000
*             );                                                   0048 00381000
*                                                                  0048 00382000
         L     @08,@CA00100                                        0048 00383000
         L     @08,LNGTPTR-IRBMFLHV+8(,@08)                        0048 00384000
         LA    @03,LNGTXTD(,@08)                                   0048 00385000
         ST    @03,@AL00001                                        0048 00386000
         ST    @08,@AL00001+4                                      0048 00387000
         LA    @08,@CF00119                                        0048 00388000
         ST    @08,@AL00001+8                                      0048 00389000
         LA    @08,@CF00075                                        0048 00390000
         ST    @08,@AL00001+12                                     0048 00391000
         L     @08,@PC00001+4                                      0048 00392000
         L     @15,RHVECTAB+8(,@08)                                0048 00393000
         LA    @01,@AL00001                                        0048 00394000
         BALR  @14,@15                                             0048 00395000
*         /***********************************************************/ 00396000
*         /*                                                         */ 00397000
*         /* INSERT 'CHANNEL' MACDATE Y-2 73018                      */ 00398000
*         /*                                                         */ 00399000
*         /***********************************************************/ 00400000
*                                                                  0049 00401000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00402000
*             LNGTPTR(LHPART4)->LNGTXTD,/* TEXT                      */ 00403000
*             LNGTPTR(LHPART4)->LNGTXTL,/* LENGTH                    */ 00404000
*             LINE8,                /* START LINE                    */ 00405000
*             COLB                  /* START COLUMN                  */ 00406000
*             );                                                   0049 00407000
*                                                                  0049 00408000
         L     @08,@CA00100                                        0049 00409000
         L     @08,LNGTPTR-IRBMFLHV+12(,@08)                       0049 00410000
         LA    @03,LNGTXTD(,@08)                                   0049 00411000
         ST    @03,@AL00001                                        0049 00412000
         ST    @08,@AL00001+4                                      0049 00413000
         LA    @08,@CF00044                                        0049 00414000
         ST    @08,@AL00001+8                                      0049 00415000
         LA    @08,@CF00112                                        0049 00416000
         ST    @08,@AL00001+12                                     0049 00417000
         L     @08,@PC00001+4                                      0049 00418000
         L     @15,RHVECTAB+8(,@08)                                0049 00419000
         LA    @01,@AL00001                                        0049 00420000
         BALR  @14,@15                                             0049 00421000
*         /***********************************************************/ 00422000
*         /*                                                         */ 00423000
*         /* INSERT 'NUMBER' MACDATE Y-2 73018                       */ 00424000
*         /*                                                         */ 00425000
*         /***********************************************************/ 00426000
*                                                                  0050 00427000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00428000
*             LNGTPTR(LHPART5)->LNGTXTD,/* TEXT                      */ 00429000
*             LNGTPTR(LHPART5)->LNGTXTL,/* LENGTH                    */ 00430000
*             LINE9,                /* START LINE                    */ 00431000
*             COLB                  /* START COLUMN                  */ 00432000
*             );                                                   0050 00433000
*                                                                  0050 00434000
         L     @08,@CA00100                                        0050 00435000
         L     @08,LNGTPTR-IRBMFLHV+16(,@08)                       0050 00436000
         LA    @03,LNGTXTD(,@08)                                   0050 00437000
         ST    @03,@AL00001                                        0050 00438000
         ST    @08,@AL00001+4                                      0050 00439000
         LA    @08,@CF00117                                        0050 00440000
         ST    @08,@AL00001+8                                      0050 00441000
         LA    @08,@CF00112                                        0050 00442000
         ST    @08,@AL00001+12                                     0050 00443000
         L     @08,@PC00001+4                                      0050 00444000
         L     @15,RHVECTAB+8(,@08)                                0050 00445000
         LA    @01,@AL00001                                        0050 00446000
         BALR  @14,@15                                             0050 00447000
*         /***********************************************************/ 00448000
*         /*                                                         */ 00449000
*         /* INSERT 'AND TYPE' MACDATE Y-2 73018                     */ 00450000
*         /*                                                         */ 00451000
*         /***********************************************************/ 00452000
*                                                                  0051 00453000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00454000
*             LNGTPTR(LHPART6)->LNGTXTD,/* TEXT                      */ 00455000
*             LNGTPTR(LHPART6)->LNGTXTL,/* LENGTH                    */ 00456000
*             LINE10,               /* START LINE                    */ 00457000
*             COLB                  /* START COLUMN                  */ 00458000
*             );                                                   0051 00459000
*                                                                  0051 00460000
         L     @08,@CA00100                                        0051 00461000
         L     @08,LNGTPTR-IRBMFLHV+20(,@08)                       0051 00462000
         LA    @03,LNGTXTD(,@08)                                   0051 00463000
         ST    @03,@AL00001                                        0051 00464000
         ST    @08,@AL00001+4                                      0051 00465000
         LA    @08,@CF00119                                        0051 00466000
         ST    @08,@AL00001+8                                      0051 00467000
         LA    @08,@CF00112                                        0051 00468000
         ST    @08,@AL00001+12                                     0051 00469000
         L     @08,@PC00001+4                                      0051 00470000
         L     @15,RHVECTAB+8(,@08)                                0051 00471000
         LA    @01,@AL00001                                        0051 00472000
         BALR  @14,@15                                             0051 00473000
*         /***********************************************************/ 00474000
*         /*                                                         */ 00475000
*         /* INSERT 'CHANNEL' MACDATE Y-2 73018                      */ 00476000
*         /*                                                         */ 00477000
*         /***********************************************************/ 00478000
*                                                                  0052 00479000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00480000
*             LNGTPTR(LHPART4)->LNGTXTD,/* TEXT                      */ 00481000
*             LNGTPTR(LHPART4)->LNGTXTL,/* LENGTH                    */ 00482000
*             LINE8,                /* START LINE                    */ 00483000
*             COLD                  /* START COLUMN                  */ 00484000
*             );                                                   0052 00485000
*                                                                  0052 00486000
         L     @08,@CA00100                                        0052 00487000
         L     @08,LNGTPTR-IRBMFLHV+12(,@08)                       0052 00488000
         LA    @03,LNGTXTD(,@08)                                   0052 00489000
         ST    @03,@AL00001                                        0052 00490000
         ST    @08,@AL00001+4                                      0052 00491000
         LA    @08,@CF00044                                        0052 00492000
         ST    @08,@AL00001+8                                      0052 00493000
         LA    @08,@CF00200                                        0052 00494000
         ST    @08,@AL00001+12                                     0052 00495000
         L     @08,@PC00001+4                                      0052 00496000
         L     @15,RHVECTAB+8(,@08)                                0052 00497000
         LA    @01,@AL00001                                        0052 00498000
         BALR  @14,@15                                             0052 00499000
*         /***********************************************************/ 00500000
*         /*                                                         */ 00501000
*         /* INSERT 'ACTIVITY' MACDATE Y-2 73018                     */ 00502000
*         /*                                                         */ 00503000
*         /***********************************************************/ 00504000
*                                                                  0053 00505000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00506000
*             LNGTPTR(LHPART7)->LNGTXTD,/* TEXT                      */ 00507000
*             LNGTPTR(LHPART7)->LNGTXTL,/* LENGTH                    */ 00508000
*             LINE9,                /* START LINE                    */ 00509000
*             COLD                  /* START COLUMN                  */ 00510000
*             );                                                   0053 00511000
*                                                                  0053 00512000
         L     @08,@CA00100                                        0053 00513000
         L     @08,LNGTPTR-IRBMFLHV+24(,@08)                       0053 00514000
         LA    @03,LNGTXTD(,@08)                                   0053 00515000
         ST    @03,@AL00001                                        0053 00516000
         ST    @08,@AL00001+4                                      0053 00517000
         LA    @08,@CF00117                                        0053 00518000
         ST    @08,@AL00001+8                                      0053 00519000
         LA    @08,@CF00200                                        0053 00520000
         ST    @08,@AL00001+12                                     0053 00521000
         L     @08,@PC00001+4                                      0053 00522000
         L     @15,RHVECTAB+8(,@08)                                0053 00523000
         LA    @01,@AL00001                                        0053 00524000
         BALR  @14,@15                                             0053 00525000
*         /***********************************************************/ 00526000
*         /*                                                         */ 00527000
*         /* INSERT 'COUNT' MACDATE Y-2 73018                        */ 00528000
*         /*                                                         */ 00529000
*         /***********************************************************/ 00530000
*                                                                  0054 00531000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00532000
*             LNGTPTR(LHPART8)->LNGTXTD,/* TEXT                      */ 00533000
*             LNGTPTR(LHPART8)->LNGTXTL,/* LENGTH                    */ 00534000
*             LINE10,               /* START LINE                    */ 00535000
*             COLD                  /* START COLUMN                  */ 00536000
*             );                                                   0054 00537000
*                                                                  0054 00538000
         L     @08,@CA00100                                        0054 00539000
         L     @08,LNGTPTR-IRBMFLHV+28(,@08)                       0054 00540000
         LA    @03,LNGTXTD(,@08)                                   0054 00541000
         ST    @03,@AL00001                                        0054 00542000
         ST    @08,@AL00001+4                                      0054 00543000
         LA    @08,@CF00119                                        0054 00544000
         ST    @08,@AL00001+8                                      0054 00545000
         LA    @08,@CF00200                                        0054 00546000
         ST    @08,@AL00001+12                                     0054 00547000
         L     @08,@PC00001+4                                      0054 00548000
         L     @15,RHVECTAB+8(,@08)                                0054 00549000
         LA    @01,@AL00001                                        0054 00550000
         BALR  @14,@15                                             0054 00551000
*         /***********************************************************/ 00552000
*         /*                                                         */ 00553000
*         /* INSERT 'PERCENT' MACDATE Y-2 73018                      */ 00554000
*         /*                                                         */ 00555000
*         /***********************************************************/ 00556000
*                                                                  0055 00557000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00558000
*             LNGTPTR(LHPART9)->LNGTXTD,/* TEXT                      */ 00559000
*             LNGTPTR(LHPART9)->LNGTXTL,/* LENGTH                    */ 00560000
*             LINE8,                /* START LINE                    */ 00561000
*             COLE                  /* START COLUMN                  */ 00562000
*             );                                                   0055 00563000
*                                                                  0055 00564000
         L     @08,@CA00100                                        0055 00565000
         L     @08,LNGTPTR-IRBMFLHV+32(,@08)                       0055 00566000
         LA    @03,LNGTXTD(,@08)                                   0055 00567000
         ST    @03,@AL00001                                        0055 00568000
         ST    @08,@AL00001+4                                      0055 00569000
         LA    @08,@CF00044                                        0055 00570000
         ST    @08,@AL00001+8                                      0055 00571000
         LA    @08,@CF00202                                        0055 00572000
         ST    @08,@AL00001+12                                     0055 00573000
         L     @08,@PC00001+4                                      0055 00574000
         L     @15,RHVECTAB+8(,@08)                                0055 00575000
         LA    @01,@AL00001                                        0055 00576000
         BALR  @14,@15                                             0055 00577000
*         /***********************************************************/ 00578000
*         /*                                                         */ 00579000
*         /* INSERT 'CHANNEL' MACDATE Y-2 73018                      */ 00580000
*         /*                                                         */ 00581000
*         /***********************************************************/ 00582000
*                                                                  0056 00583000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00584000
*             LNGTPTR(LHPART4)->LNGTXTD,/* TEXT                      */ 00585000
*             LNGTPTR(LHPART4)->LNGTXTL,/* LENGTH                    */ 00586000
*             LINE9,                /* START LINE                    */ 00587000
*             COLE                  /* START COLUMN                  */ 00588000
*             );                                                   0056 00589000
*                                                                  0056 00590000
         L     @08,@CA00100                                        0056 00591000
         L     @08,LNGTPTR-IRBMFLHV+12(,@08)                       0056 00592000
         LA    @03,LNGTXTD(,@08)                                   0056 00593000
         ST    @03,@AL00001                                        0056 00594000
         ST    @08,@AL00001+4                                      0056 00595000
         LA    @08,@CF00117                                        0056 00596000
         ST    @08,@AL00001+8                                      0056 00597000
         LA    @08,@CF00202                                        0056 00598000
         ST    @08,@AL00001+12                                     0056 00599000
         L     @08,@PC00001+4                                      0056 00600000
         L     @15,RHVECTAB+8(,@08)                                0056 00601000
         LA    @01,@AL00001                                        0056 00602000
         BALR  @14,@15                                             0056 00603000
*         /***********************************************************/ 00604000
*         /*                                                         */ 00605000
*         /* INSERT 'BUSY' MACDATE Y-2 73018                         */ 00606000
*         /*                                                         */ 00607000
*         /***********************************************************/ 00608000
*                                                                  0057 00609000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00610000
*             LNGTPTR(LHPART10)->LNGTXTD,/* TEXT                     */ 00611000
*             LNGTPTR(LHPART10)->LNGTXTL,/* LENGTH                   */ 00612000
*             LINE10,               /* START LINE                    */ 00613000
*             COLE                  /* START COLUMN                  */ 00614000
*             );                                                   0057 00615000
*                                                                  0057 00616000
         L     @08,@CA00100                                        0057 00617000
         L     @08,LNGTPTR-IRBMFLHV+36(,@08)                       0057 00618000
         LA    @03,LNGTXTD(,@08)                                   0057 00619000
         ST    @03,@AL00001                                        0057 00620000
         ST    @08,@AL00001+4                                      0057 00621000
         LA    @08,@CF00119                                        0057 00622000
         ST    @08,@AL00001+8                                      0057 00623000
         LA    @08,@CF00202                                        0057 00624000
         ST    @08,@AL00001+12                                     0057 00625000
         L     @08,@PC00001+4                                      0057 00626000
         L     @15,RHVECTAB+8(,@08)                                0057 00627000
         LA    @01,@AL00001                                        0057 00628000
         BALR  @14,@15                                             0057 00629000
*         /***********************************************************/ 00630000
*         /*                                                         */ 00631000
*         /* INSERT 'PERCENT' MACDATE Y-2 73018                      */ 00632000
*         /*                                                         */ 00633000
*         /***********************************************************/ 00634000
*                                                                  0058 00635000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00636000
*             LNGTPTR(LHPART9)->LNGTXTD,/* TEXT                      */ 00637000
*             LNGTPTR(LHPART9)->LNGTXTL,/* LENGTH                    */ 00638000
*             LINE8,                /* START LINE                    */ 00639000
*             COLF                  /* START COLUMN                  */ 00640000
*             );                                                   0058 00641000
*                                                                  0058 00642000
         L     @08,@CA00100                                        0058 00643000
         L     @08,LNGTPTR-IRBMFLHV+32(,@08)                       0058 00644000
         LA    @03,LNGTXTD(,@08)                                   0058 00645000
         ST    @03,@AL00001                                        0058 00646000
         ST    @08,@AL00001+4                                      0058 00647000
         LA    @08,@CF00044                                        0058 00648000
         ST    @08,@AL00001+8                                      0058 00649000
         LA    @08,@CF00204                                        0058 00650000
         ST    @08,@AL00001+12                                     0058 00651000
         L     @08,@PC00001+4                                      0058 00652000
         L     @15,RHVECTAB+8(,@08)                                0058 00653000
         LA    @01,@AL00001                                        0058 00654000
         BALR  @14,@15                                             0058 00655000
*         /***********************************************************/ 00656000
*         /*                                                         */ 00657000
*         /* INSERT 'CHAN BUSY' MACDATE Y-2 73018                    */ 00658000
*         /*                                                         */ 00659000
*         /***********************************************************/ 00660000
*                                                                  0059 00661000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00662000
*             LNGTPTR(LHPART11)->LNGTXTD,/* TEXT                     */ 00663000
*             LNGTPTR(LHPART11)->LNGTXTL,/* LENGTH                   */ 00664000
*             LINE9,                /* START LINE                    */ 00665000
*             COLF                  /* START COLUMN                  */ 00666000
*             );                                                   0059 00667000
*                                                                  0059 00668000
         L     @08,@CA00100                                        0059 00669000
         L     @08,LNGTPTR-IRBMFLHV+40(,@08)                       0059 00670000
         LA    @03,LNGTXTD(,@08)                                   0059 00671000
         ST    @03,@AL00001                                        0059 00672000
         ST    @08,@AL00001+4                                      0059 00673000
         LA    @08,@CF00117                                        0059 00674000
         ST    @08,@AL00001+8                                      0059 00675000
         LA    @08,@CF00204                                        0059 00676000
         ST    @08,@AL00001+12                                     0059 00677000
         L     @08,@PC00001+4                                      0059 00678000
         L     @15,RHVECTAB+8(,@08)                                0059 00679000
         LA    @01,@AL00001                                        0059 00680000
         BALR  @14,@15                                             0059 00681000
*         /***********************************************************/ 00682000
*         /*                                                         */ 00683000
*         /* INSERT '& CPU BUSY' MACDATE Y-2 73018                   */ 00684000
*         /*                                                         */ 00685000
*         /***********************************************************/ 00686000
*                                                                  0060 00687000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00688000
*             LNGTPTR(LHPART12)->LNGTXTD,/* TEXT                     */ 00689000
*             LNGTPTR(LHPART12)->LNGTXTL,/* LENGTH                   */ 00690000
*             LINE10,               /* START LINE                    */ 00691000
*             COLF                  /* START COLUMN                  */ 00692000
*             );                                                   0060 00693000
         L     @08,@CA00100                                        0060 00694000
         L     @08,LNGTPTR-IRBMFLHV+44(,@08)                       0060 00695000
         LA    @03,LNGTXTD(,@08)                                   0060 00696000
         ST    @03,@AL00001                                        0060 00697000
         ST    @08,@AL00001+4                                      0060 00698000
         LA    @08,@CF00119                                        0060 00699000
         ST    @08,@AL00001+8                                      0060 00700000
         LA    @08,@CF00204                                        0060 00701000
         ST    @08,@AL00001+12                                     0060 00702000
         L     @08,@PC00001+4                                      0060 00703000
         L     @15,RHVECTAB+8(,@08)                                0060 00704000
         LA    @01,@AL00001                                        0060 00705000
         BALR  @14,@15                                             0060 00706000
*         RHLINE=CDATLINE;          /* INITIALIZE LINE NUMBER FOR  0061 00707000
*                                      NEXT ENTRY                    */ 00708000
         MVC   RHLINE(4),@CF00087                                  0061 00709000
*         RHNEWCPU='1'B;            /* TRIGGER NEW CPU SO THAT CPU 0062 00710000
*                                      NUMBER WILL BE PRINTED ON   0062 00711000
*                                      FIRST LINE OF PAGE.           */ 00712000
         OI    RHNEWCPU,B'10000000'                                0062 00713000
*       END;                                                       0063 00714000
*                                                                  0063 00715000
*     /***************************************************************/ 00716000
*     /*                                                             */ 00717000
*     /* INCREMENT CHANNELS ON CPU COUNTER. SKIP LINE IF MULTIPLE OF */ 00718000
*     /* FOUR FOR CHANNEL GROUPING. DONT SKIP IF TOP OF PAGE.        */ 00719000
*     /*                                                             */ 00720000
*     /***************************************************************/ 00721000
*                                                                  0064 00722000
*     RHCHACNT=RHCHACNT+1;                                         0064 00723000
@RF00042 LA    @08,1                                               0064 00724000
         L     @03,RHCHACNT                                        0064 00725000
         AR    @03,@08                                             0064 00726000
         ST    @03,RHCHACNT                                        0064 00727000
*     IF RHCHACNT//4=0&RHLINE^=CDATLINE THEN                       0065 00728000
         LR    @00,@03                                             0065 00729000
         SRDA  @00,32                                              0065 00730000
         D     @00,@CF00049                                        0065 00731000
         LTR   @00,@00                                             0065 00732000
         BNZ   @RF00065                                            0065 00733000
         L     @03,RHLINE                                          0065 00734000
         CH    @03,@CH00087                                        0065 00735000
         BE    @RF00065                                            0065 00736000
*       RHLINE=RHLINE+1;                                           0066 00737000
*                                                                  0066 00738000
         AR    @03,@08                                             0066 00739000
         ST    @03,RHLINE                                          0066 00740000
*     /***************************************************************/ 00741000
*     /*                                                             */ 00742000
*     /* FORMAT AND INSERT DATA FOR THIS CHANNEL. FIRST CHECK TO SEE */ 00743000
*     /* IF THIS IS A NEW CPU. IF SO, INSERT CPU NUMBER              */ 00744000
*     /*                                                             */ 00745000
*     /***************************************************************/ 00746000
*                                                                  0067 00747000
*     IF RHNEWCPU='1'B THEN         /* IF THIS IS A NEW CPU          */ 00748000
@RF00065 TM    RHNEWCPU,B'10000000'                                0067 00749000
         BNO   @RF00067                                            0067 00750000
*       DO;                                                        0068 00751000
*         RHNEWCPU='0'B;            /* RESET FLAG                    */ 00752000
*                                                                  0069 00753000
         NI    RHNEWCPU,B'01111111'                                0069 00754000
*         /***********************************************************/ 00755000
*         /*                                                         */ 00756000
*         /* INSERT CPU NUMBER MACDATE Y-2 73018                     */ 00757000
*         /*                                                         */ 00758000
*         /***********************************************************/ 00759000
*                                                                  0070 00760000
*         CALL IRBMFCNV(            /* CONVERSION ROUTINE            */ 00761000
*             RHCPUNO,              /* INPUT VALUE                   */ 00762000
*             RHDATSCF,             /* INPUT SCALE                   */ 00763000
*             RHWRKSTR,             /* OUTPUT STRING                 */ 00764000
*             RHCPULEN,             /* OUTPUT LENGTH                 */ 00765000
*             RHNOPLCE,             /* PLACES RIGHT OF DEC PT        */ 00766000
*             RHNOCOMA,             /* COMMAS FLAG                   */ 00767000
*             RHNOFLOT              /* MAX PRECISION FLAG            */ 00768000
*             );                                                   0070 00769000
*                                                                  0070 00770000
         MVC   @AL00001+4(24),@AL00070                             0070 00771000
         LA    @08,RHCPUNO                                         0070 00772000
         ST    @08,@AL00001                                        0070 00773000
         LA    @08,RHWRKSTR                                        0070 00774000
         ST    @08,@AL00001+8                                      0070 00775000
         L     @08,@PC00001+4                                      0070 00776000
         L     @15,RHVECTAB(,@08)                                  0070 00777000
         LA    @01,@AL00001                                        0070 00778000
         BALR  @14,@15                                             0070 00779000
*         /***********************************************************/ 00780000
*         /*                                                         */ 00781000
*         /* MACDATE Y-2 73018                                       */ 00782000
*         /*                                                         */ 00783000
*         /***********************************************************/ 00784000
*                                                                  0071 00785000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00786000
*             RHWRKSTR,             /* TEXT                          */ 00787000
*             RHCPULEN,             /* LENGTH                        */ 00788000
*             RHLINE,               /* START LINE                    */ 00789000
*             COLA                  /* START COLUMN                  */ 00790000
*             );                                                   0071 00791000
         LA    @08,RHWRKSTR                                        0071 00792000
         ST    @08,@AL00001                                        0071 00793000
         LA    @08,@CF00056                                        0071 00794000
         ST    @08,@AL00001+4                                      0071 00795000
         LA    @08,RHLINE                                          0071 00796000
         ST    @08,@AL00001+8                                      0071 00797000
         LA    @08,@CF00075                                        0071 00798000
         ST    @08,@AL00001+12                                     0071 00799000
         L     @08,@PC00001+4                                      0071 00800000
         L     @15,RHVECTAB+8(,@08)                                0071 00801000
         LA    @01,@AL00001                                        0071 00802000
         BALR  @14,@15                                             0071 00803000
*       END;                                                       0072 00804000
*                                                                  0072 00805000
*     /***************************************************************/ 00806000
*     /*                                                             */ 00807000
*     /* INSERT REST OF CHANNEL DATA. START WITH CHANNEL NUMBER      */ 00808000
*     /*                                                             */ 00809000
*     /***************************************************************/ 00810000
*                                                                  0073 00811000
*     RHCHANO(2)=SMF73HID(RHCHAIDX);                               0073 00812000
@RF00067 LR    @08,RHCHAIDX                                        0073 00813000
         SLA   @08,4                                               0073 00814000
         L     @03,@PC00001                                        0073 00815000
         L     @03,RHDTAPTR(,@03)                                  0073 00816000
         LA    @15,SMF73SIZ(,@03)                                  0073 00817000
         AH    @15,SMF73SIZ(,@03)                                  0073 00818000
         LH    @03,SMF73SHC(,@15)                                  0073 00819000
         AR    @03,@15                                             0073 00820000
         AL    @03,@CF00243                                        0073 00821000
         SR    @15,@15                                             0073 00822000
         IC    @15,SMF73HID-2(@08,@03)                             0073 00823000
         STC   @15,RHCHANO+1                                       0073 00824000
*     UNPK(RHWRKSTR(1:3),RHCHANO(2:3));/* FORM FCFCXX                */ 00825000
         UNPK  RHWRKSTR(3),RHCHANO+1(2)                            0074 00826000
*     TR(RHWRKSTR(1:2),RHTRTAB);    /* PRINTABLE CHARACTERS          */ 00827000
*                                                                  0075 00828000
         LA    @08,@CC00161                                        0075 00829000
         SH    @08,@CH00160                                        0075 00830000
         TR    RHWRKSTR(2),RHTRTAB(@08)                            0075 00831000
*     /***************************************************************/ 00832000
*     /*                                                             */ 00833000
*     /* MACDATE Y-2 73018                                           */ 00834000
*     /*                                                             */ 00835000
*     /***************************************************************/ 00836000
*                                                                  0076 00837000
*     CALL MFISRTXT(                /* INSERT TEXT ROUTINE           */ 00838000
*         RHWRKSTR(2),              /* TEXT                          */ 00839000
*         1,                        /* LENGTH                        */ 00840000
*         RHLINE,                   /* START LINE                    */ 00841000
*         COLB                      /* START COLUMN                  */ 00842000
*         );                                                       0076 00843000
*                                                                  0076 00844000
         LA    @08,RHWRKSTR+1                                      0076 00845000
         ST    @08,@AL00001                                        0076 00846000
         LA    @08,@CF00075                                        0076 00847000
         ST    @08,@AL00001+4                                      0076 00848000
         LA    @08,RHLINE                                          0076 00849000
         ST    @08,@AL00001+8                                      0076 00850000
         LA    @08,@CF00112                                        0076 00851000
         ST    @08,@AL00001+12                                     0076 00852000
         L     @08,@PC00001+4                                      0076 00853000
         L     @15,RHVECTAB+8(,@08)                                0076 00854000
         LA    @01,@AL00001                                        0076 00855000
         BALR  @14,@15                                             0076 00856000
*     /***************************************************************/ 00857000
*     /*                                                             */ 00858000
*     /* INSERT CHANNEL TYPE                                         */ 00859000
*     /*                                                             */ 00860000
*     /***************************************************************/ 00861000
*                                                                  0077 00862000
*     IF SMF73IID(RHCHAIDX)='1'B THEN                              0077 00863000
         LR    @08,RHCHAIDX                                        0077 00864000
         SLA   @08,4                                               0077 00865000
         L     @03,@PC00001                                        0077 00866000
         L     @03,RHDTAPTR(,@03)                                  0077 00867000
         LA    @15,SMF73SIZ(,@03)                                  0077 00868000
         AH    @15,SMF73SIZ(,@03)                                  0077 00869000
         LH    @03,SMF73SHC(,@15)                                  0077 00870000
         AR    @03,@15                                             0077 00871000
         ALR   @03,@08                                             0077 00872000
         AL    @03,@CF00244                                        0077 00873000
         TM    SMF73IID-3(@03),B'00000100'                         0077 00874000
         BNO   @RF00077                                            0077 00875000
*       DO;                         /* CHANNEL TYPE FIELD IS INVALID */ 00876000
*                                                                  0078 00877000
*         /***********************************************************/ 00878000
*         /*                                                         */ 00879000
*         /* INSERT 'INVALID' MACDATE Y-2 73018                      */ 00880000
*         /*                                                         */ 00881000
*         /***********************************************************/ 00882000
*                                                                  0079 00883000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00884000
*             LNGTPTR(LHPART13)->LNGTXTD,/* TEXT                     */ 00885000
*             LNGTPTR(LHPART13)->LNGTXTL,/* LENGTH                   */ 00886000
*             RHLINE,               /* START LINE                    */ 00887000
*             COLC                  /* START COLUMN                  */ 00888000
*             );                                                   0079 00889000
         L     @08,@CA00100                                        0079 00890000
         L     @08,LNGTPTR-IRBMFLHV+48(,@08)                       0079 00891000
         LA    @03,LNGTXTD(,@08)                                   0079 00892000
         ST    @03,@AL00001                                        0079 00893000
         ST    @08,@AL00001+4                                      0079 00894000
         LA    @08,RHLINE                                          0079 00895000
         ST    @08,@AL00001+8                                      0079 00896000
         LA    @08,@CF00117                                        0079 00897000
         ST    @08,@AL00001+12                                     0079 00898000
         L     @08,@PC00001+4                                      0079 00899000
         L     @15,RHVECTAB+8(,@08)                                0079 00900000
         LA    @01,@AL00001                                        0079 00901000
         BALR  @14,@15                                             0079 00902000
*         GO TO RHLAB2;             /* THEN GO TO INSERT CHANNEL   0080 00903000
*                                      STATUS                        */ 00904000
         B     RHLAB2                                              0080 00905000
*       END;                                                       0081 00906000
*     IF SMF73TYP(RHCHAIDX)=MULTPLEX THEN                          0082 00907000
@RF00077 LR    @08,RHCHAIDX                                        0082 00908000
         SLA   @08,4                                               0082 00909000
         L     @03,@PC00001                                        0082 00910000
         L     @03,RHDTAPTR(,@03)                                  0082 00911000
         LA    @15,SMF73SIZ(,@03)                                  0082 00912000
         AH    @15,SMF73SIZ(,@03)                                  0082 00913000
         LH    @03,SMF73SHC(,@15)                                  0082 00914000
         AR    @03,@15                                             0082 00915000
         ALR   @03,@08                                             0082 00916000
         AL    @03,@CF00244                                        0082 00917000
         TM    SMF73TYP-3(@03),B'00010000'                         0082 00918000
         BNO   @RF00082                                            0082 00919000
         TM    SMF73TYP-3(@03),B'11100000'                         0082 00920000
         BNZ   @RF00082                                            0082 00921000
*       DO;                         /* TEST FOR BYTE MPX CHANNEL     */ 00922000
*                                                                  0083 00923000
*         /***********************************************************/ 00924000
*         /*                                                         */ 00925000
*         /* INSERT 'BYTE MPX' MACDATE Y-2 73018                     */ 00926000
*         /*                                                         */ 00927000
*         /***********************************************************/ 00928000
*                                                                  0084 00929000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00930000
*             LNGTPTR(LHPART14)->LNGTXTD,/* TEXT                     */ 00931000
*             LNGTPTR(LHPART14)->LNGTXTL,/* LENGTH                   */ 00932000
*             RHLINE,               /* START LINE                    */ 00933000
*             COLC                  /* START COLUMN                  */ 00934000
*             );                                                   0084 00935000
         L     @08,@CA00100                                        0084 00936000
         L     @08,LNGTPTR-IRBMFLHV+52(,@08)                       0084 00937000
         LA    @03,LNGTXTD(,@08)                                   0084 00938000
         ST    @03,@AL00001                                        0084 00939000
         ST    @08,@AL00001+4                                      0084 00940000
         LA    @08,RHLINE                                          0084 00941000
         ST    @08,@AL00001+8                                      0084 00942000
         LA    @08,@CF00117                                        0084 00943000
         ST    @08,@AL00001+12                                     0084 00944000
         L     @08,@PC00001+4                                      0084 00945000
         L     @15,RHVECTAB+8(,@08)                                0084 00946000
         LA    @01,@AL00001                                        0084 00947000
         BALR  @14,@15                                             0084 00948000
*         GO TO RHLAB2;             /* THEN GO TO INSERT CHANNEL   0085 00949000
*                                      COUNT OR STATUS               */ 00950000
         B     RHLAB2                                              0085 00951000
*       END;                                                       0086 00952000
*     IF SMF73TYP(RHCHAIDX)=SELECTOR THEN                          0087 00953000
@RF00082 LR    @08,RHCHAIDX                                        0087 00954000
         SLA   @08,4                                               0087 00955000
         L     @03,@PC00001                                        0087 00956000
         L     @03,RHDTAPTR(,@03)                                  0087 00957000
         LA    @15,SMF73SIZ(,@03)                                  0087 00958000
         AH    @15,SMF73SIZ(,@03)                                  0087 00959000
         LH    @03,SMF73SHC(,@15)                                  0087 00960000
         AR    @03,@15                                             0087 00961000
         ALR   @03,@08                                             0087 00962000
         AL    @03,@CF00244                                        0087 00963000
         TM    SMF73TYP-3(@03),B'11110000'                         0087 00964000
         BNZ   @RF00087                                            0087 00965000
*       DO;                         /* TEST FOR SELECTOR CHANNEL     */ 00966000
*                                                                  0088 00967000
*         /***********************************************************/ 00968000
*         /*                                                         */ 00969000
*         /* INSERT 'SELECTOR' MACDATE Y-2 73018                     */ 00970000
*         /*                                                         */ 00971000
*         /***********************************************************/ 00972000
*                                                                  0089 00973000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 00974000
*             LNGTPTR(LHPART15)->LNGTXTD,/* TEXT                     */ 00975000
*             LNGTPTR(LHPART15)->LNGTXTL,/* LENGTH                   */ 00976000
*             RHLINE,               /* START LINE                    */ 00977000
*             COLC                  /* START COLUMN                  */ 00978000
*             );                                                   0089 00979000
         L     @08,@CA00100                                        0089 00980000
         L     @08,LNGTPTR-IRBMFLHV+56(,@08)                       0089 00981000
         LA    @03,LNGTXTD(,@08)                                   0089 00982000
         ST    @03,@AL00001                                        0089 00983000
         ST    @08,@AL00001+4                                      0089 00984000
         LA    @08,RHLINE                                          0089 00985000
         ST    @08,@AL00001+8                                      0089 00986000
         LA    @08,@CF00117                                        0089 00987000
         ST    @08,@AL00001+12                                     0089 00988000
         L     @08,@PC00001+4                                      0089 00989000
         L     @15,RHVECTAB+8(,@08)                                0089 00990000
         LA    @01,@AL00001                                        0089 00991000
         BALR  @14,@15                                             0089 00992000
*         GO TO RHLAB2;             /* THEN GO TO INSERT CHANNEL   0090 00993000
*                                      COUNT OR STATUS               */ 00994000
         B     RHLAB2                                              0090 00995000
*       END;                                                       0091 00996000
*     IF SMF73TYP(RHCHAIDX)=BLKMPLEX THEN/* TEST FOR BLOCK MPX     0092 00997000
*                                      CHANNEL                       */ 00998000
*                                                                  0092 00999000
@RF00087 LR    @08,RHCHAIDX                                        0092 01000000
         SLA   @08,4                                               0092 01001000
         L     @03,@PC00001                                        0092 01002000
         L     @03,RHDTAPTR(,@03)                                  0092 01003000
         LA    @15,SMF73SIZ(,@03)                                  0092 01004000
         AH    @15,SMF73SIZ(,@03)                                  0092 01005000
         LH    @03,SMF73SHC(,@15)                                  0092 01006000
         AR    @03,@15                                             0092 01007000
         ALR   @03,@08                                             0092 01008000
         AL    @03,@CF00244                                        0092 01009000
         TM    SMF73TYP-3(@03),B'00100000'                         0092 01010000
         BNO   @RF00092                                            0092 01011000
         TM    SMF73TYP-3(@03),B'11010000'                         0092 01012000
         BNZ   @RF00092                                            0092 01013000
*       /*************************************************************/ 01014000
*       /*                                                           */ 01015000
*       /* INSERT 'BLOCK MPX' MACDATE Y-2 73018                      */ 01016000
*       /*                                                           */ 01017000
*       /*************************************************************/ 01018000
*                                                                  0093 01019000
*       CALL MFISRTXT(              /* INSERT TEXT ROUTINE           */ 01020000
*           LNGTPTR(LHPART16)->LNGTXTD,/* TEXT                       */ 01021000
*           LNGTPTR(LHPART16)->LNGTXTL,/* LENGTH                     */ 01022000
*           RHLINE,                 /* START LINE                    */ 01023000
*           COLC                    /* START COLUMN                  */ 01024000
*           );                                                     0093 01025000
         L     @08,@CA00100                                        0093 01026000
         L     @08,LNGTPTR-IRBMFLHV+60(,@08)                       0093 01027000
         LA    @03,LNGTXTD(,@08)                                   0093 01028000
         ST    @03,@AL00001                                        0093 01029000
         ST    @08,@AL00001+4                                      0093 01030000
         LA    @08,RHLINE                                          0093 01031000
         ST    @08,@AL00001+8                                      0093 01032000
         LA    @08,@CF00117                                        0093 01033000
         ST    @08,@AL00001+12                                     0093 01034000
         L     @08,@PC00001+4                                      0093 01035000
         L     @15,RHVECTAB+8(,@08)                                0093 01036000
         LA    @01,@AL00001                                        0093 01037000
         BALR  @14,@15                                             0093 01038000
*RHLAB2:                                                           0094 01039000
*                                                                  0094 01040000
*     /***************************************************************/ 01041000
*     /*                                                             */ 01042000
*     /* INSERT CHANNEL ACTIVITY COUNT OR STATUS                     */ 01043000
*     /*                                                             */ 01044000
*     /***************************************************************/ 01045000
*                                                                  0094 01046000
*     IF SMF73VAC(RHCHAIDX)='1'B THEN                              0094 01047000
@RF00092 DS    0H                                                  0094 01048000
RHLAB2   LR    @08,RHCHAIDX                                        0094 01049000
         SLA   @08,4                                               0094 01050000
         L     @03,@PC00001                                        0094 01051000
         L     @03,RHDTAPTR(,@03)                                  0094 01052000
         LA    @15,SMF73SIZ(,@03)                                  0094 01053000
         AH    @15,SMF73SIZ(,@03)                                  0094 01054000
         LH    @03,SMF73SHC(,@15)                                  0094 01055000
         AR    @03,@15                                             0094 01056000
         ST    @08,@TF00001                                        0094 01057000
         ALR   @08,@03                                             0094 01058000
         AL    @08,@CF00244                                        0094 01059000
         TM    SMF73VAC-3(@08),B'00000010'                         0094 01060000
         BNO   @RF00094                                            0094 01061000
*       DO;                         /* CONFIGURATION CHANGE DETECTED */ 01062000
*         IF SMF73STA(RHCHAIDX)='1'B THEN                          0096 01063000
*                                                                  0096 01064000
         AL    @03,@TF00001                                        0096 01065000
         AL    @03,@CF00244                                        0096 01066000
         TM    SMF73STA-3(@03),B'00000001'                         0096 01067000
         BNO   @RF00096                                            0096 01068000
*           /*********************************************************/ 01069000
*           /*                                                       */ 01070000
*           /* INSERT 'NOW ONLINE' MACDATE Y-2 73018                 */ 01071000
*           /*                                                       */ 01072000
*           /*********************************************************/ 01073000
*                                                                  0097 01074000
*           CALL MFISRTXT(          /* INSERT TEXT ROUTINE           */ 01075000
*               LNGTPTR(LHPART17)->LNGTXTD,/* TEXT                   */ 01076000
*               LNGTPTR(LHPART17)->LNGTXTL,/* LENGTH                 */ 01077000
*               RHLINE,             /* START LINE                    */ 01078000
*               COLD-3              /* START COLUMN                  */ 01079000
*               );                                                 0097 01080000
         L     @08,@CA00100                                        0097 01081000
         L     @08,LNGTPTR-IRBMFLHV+64(,@08)                       0097 01082000
         LA    @03,LNGTXTD(,@08)                                   0097 01083000
         ST    @03,@AL00001                                        0097 01084000
         ST    @08,@AL00001+4                                      0097 01085000
         LA    @08,RHLINE                                          0097 01086000
         ST    @08,@AL00001+8                                      0097 01087000
         LA    @08,@CF00235                                        0097 01088000
         ST    @08,@AL00001+12                                     0097 01089000
         L     @08,@PC00001+4                                      0097 01090000
         L     @15,RHVECTAB+8(,@08)                                0097 01091000
         LA    @01,@AL00001                                        0097 01092000
         BALR  @14,@15                                             0097 01093000
*         ELSE                                                     0098 01094000
*                                                                  0098 01095000
*           /*********************************************************/ 01096000
*           /*                                                       */ 01097000
*           /* INSERT 'NOW OFFLINE' MACDATE Y-2 73018                */ 01098000
*           /*                                                       */ 01099000
*           /*********************************************************/ 01100000
*                                                                  0098 01101000
*           CALL MFISRTXT(          /* INSERT TEXT ROUTINE           */ 01102000
*               LNGTPTR(LHPART18)->LNGTXTD,/* TEXT                   */ 01103000
*               LNGTPTR(LHPART18)->LNGTXTL,/* LENGTH                 */ 01104000
*               RHLINE,             /* START LINE                    */ 01105000
*               COLD-4              /* START COLUMN                  */ 01106000
*               );                                                 0098 01107000
         B     @RC00096                                            0098 01108000
@RF00096 L     @08,@CA00100                                        0098 01109000
         L     @08,LNGTPTR-IRBMFLHV+68(,@08)                       0098 01110000
         LA    @03,LNGTXTD(,@08)                                   0098 01111000
         ST    @03,@AL00001                                        0098 01112000
         ST    @08,@AL00001+4                                      0098 01113000
         LA    @08,RHLINE                                          0098 01114000
         ST    @08,@AL00001+8                                      0098 01115000
         LA    @08,@CF00237                                        0098 01116000
         ST    @08,@AL00001+12                                     0098 01117000
         L     @08,@PC00001+4                                      0098 01118000
         L     @15,RHVECTAB+8(,@08)                                0098 01119000
         LA    @01,@AL00001                                        0098 01120000
         BALR  @14,@15                                             0098 01121000
*         GO TO RHLAB4;             /* THEN PLACE LINE POINTER ON  0099 01122000
*                                      NEXT LINE                     */ 01123000
         B     RHLAB4                                              0099 01124000
*       END;                                                       0100 01125000
*     IF SMF73STA(RHCHAIDX)='0'B THEN                              0101 01126000
@RF00094 LR    @08,RHCHAIDX                                        0101 01127000
         SLA   @08,4                                               0101 01128000
         L     @03,@PC00001                                        0101 01129000
         L     @03,RHDTAPTR(,@03)                                  0101 01130000
         LA    @15,SMF73SIZ(,@03)                                  0101 01131000
         AH    @15,SMF73SIZ(,@03)                                  0101 01132000
         LH    @03,SMF73SHC(,@15)                                  0101 01133000
         AR    @03,@15                                             0101 01134000
         ALR   @03,@08                                             0101 01135000
         AL    @03,@CF00244                                        0101 01136000
         TM    SMF73STA-3(@03),B'00000001'                         0101 01137000
         BNZ   @RF00101                                            0101 01138000
*       DO;                         /* CHANNEL IS OFFLINE            */ 01139000
*                                                                  0102 01140000
*         /***********************************************************/ 01141000
*         /*                                                         */ 01142000
*         /* INSERT 'OFFLINE' MACDATE Y-2 73018                      */ 01143000
*         /*                                                         */ 01144000
*         /***********************************************************/ 01145000
*                                                                  0103 01146000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 01147000
*             LNGTPTR(LHPART19)->LNGTXTD,/* TEXT                     */ 01148000
*             LNGTPTR(LHPART19)->LNGTXTL,/* LENGTH                   */ 01149000
*             RHLINE,               /* START LINE                    */ 01150000
*             COLD                  /* START COLUMN                  */ 01151000
*             );                                                   0103 01152000
         L     @08,@CA00100                                        0103 01153000
         L     @08,LNGTPTR-IRBMFLHV+72(,@08)                       0103 01154000
         LA    @03,LNGTXTD(,@08)                                   0103 01155000
         ST    @03,@AL00001                                        0103 01156000
         ST    @08,@AL00001+4                                      0103 01157000
         LA    @08,RHLINE                                          0103 01158000
         ST    @08,@AL00001+8                                      0103 01159000
         LA    @08,@CF00200                                        0103 01160000
         ST    @08,@AL00001+12                                     0103 01161000
         L     @08,@PC00001+4                                      0103 01162000
         L     @15,RHVECTAB+8(,@08)                                0103 01163000
         LA    @01,@AL00001                                        0103 01164000
         BALR  @14,@15                                             0103 01165000
*         GO TO RHLAB4;             /* THEN PLACE LINE POINTER ON  0104 01166000
*                                      NEXT LINE                     */ 01167000
         B     RHLAB4                                              0104 01168000
*       END;                                                       0105 01169000
*                                                                  0105 01170000
*     /***************************************************************/ 01171000
*     /*                                                             */ 01172000
*     /* INSERT COUNT. NO CHANNEL CONFIGURATION CHANGE WAS DETECTED  */ 01173000
*     /* AND THE CHANNEL IS ONLINE. IF LT 1,000,000, INSERT AS       */ 01174000
*     /* NNN,NNN. IF GT 1,000,000, INSERT AS NNN.NNNM.               */ 01175000
*     /*                                                             */ 01176000
*     /***************************************************************/ 01177000
*                                                                  0106 01178000
*     IF SMF73CNT(RHCHAIDX)<1000000 THEN                           0106 01179000
@RF00101 LR    @08,RHCHAIDX                                        0106 01180000
         SLA   @08,4                                               0106 01181000
         L     @03,@PC00001                                        0106 01182000
         L     @03,RHDTAPTR(,@03)                                  0106 01183000
         LA    @15,SMF73SIZ(,@03)                                  0106 01184000
         AH    @15,SMF73SIZ(,@03)                                  0106 01185000
         LH    @03,SMF73SHC(,@15)                                  0106 01186000
         AR    @03,@15                                             0106 01187000
         LA    @01,0(@08,@03)                                      0106 01188000
         AL    @01,@CF00245                                        0106 01189000
         L     @15,SMF73CNT-4(,@01)                                0106 01190000
         CL    @15,@CF00217                                        0106 01191000
         BNL   @RF00106                                            0106 01192000
*       DO;                                                        0107 01193000
*                                                                  0107 01194000
*         /***********************************************************/ 01195000
*         /*                                                         */ 01196000
*         /* MACDATE Y-2 73018                                       */ 01197000
*         /*                                                         */ 01198000
*         /***********************************************************/ 01199000
*                                                                  0108 01200000
*         CALL IRBMFCNV(            /* CONVERSION ROUTINE            */ 01201000
*             SMF73CNT(RHCHAIDX),   /* INPUT VALUE                   */ 01202000
*             RHDATSCF,             /* INPUT SCALE                   */ 01203000
*             RHWRKSTR,             /* OUTPUT STRING                 */ 01204000
*             RHCOUNTL,             /* OUTPUT LENGTH                 */ 01205000
*             RHNOPLCE,             /* PLACES RIGHT OF DEC PT        */ 01206000
*             RHCOMMAS,             /* COMMAS FLAG                   */ 01207000
*             RHNOFLOT              /* MAX PRECISION FLAG            */ 01208000
*             );                                                   0108 01209000
*                                                                  0108 01210000
         MVC   @AL00001+4(24),@AL00108                             0108 01211000
         AL    @03,@CF00245                                        0108 01212000
         LA    @08,SMF73CNT-4(@08,@03)                             0108 01213000
         ST    @08,@AL00001                                        0108 01214000
         LA    @08,RHWRKSTR                                        0108 01215000
         ST    @08,@AL00001+8                                      0108 01216000
         L     @08,@PC00001+4                                      0108 01217000
         L     @15,RHVECTAB(,@08)                                  0108 01218000
         LA    @01,@AL00001                                        0108 01219000
         BALR  @14,@15                                             0108 01220000
*         /***********************************************************/ 01221000
*         /*                                                         */ 01222000
*         /* MACDATE Y-2 73018                                       */ 01223000
*         /*                                                         */ 01224000
*         /***********************************************************/ 01225000
*                                                                  0109 01226000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 01227000
*             RHWRKSTR,             /* TEXT                          */ 01228000
*             RHCOUNTL,             /* LENGTH                        */ 01229000
*             RHLINE,               /* START LINE                    */ 01230000
*             COLD                  /* START COLUMN                  */ 01231000
*             );                                                   0109 01232000
         LA    @08,RHWRKSTR                                        0109 01233000
         ST    @08,@AL00001                                        0109 01234000
         LA    @08,@CF00114                                        0109 01235000
         ST    @08,@AL00001+4                                      0109 01236000
         LA    @08,RHLINE                                          0109 01237000
         ST    @08,@AL00001+8                                      0109 01238000
         LA    @08,@CF00200                                        0109 01239000
         ST    @08,@AL00001+12                                     0109 01240000
         L     @08,@PC00001+4                                      0109 01241000
         L     @15,RHVECTAB+8(,@08)                                0109 01242000
         LA    @01,@AL00001                                        0109 01243000
         BALR  @14,@15                                             0109 01244000
*       END;                                                       0110 01245000
*     ELSE                                                         0111 01246000
*       DO;                                                        0111 01247000
*                                                                  0111 01248000
         B     @RC00106                                            0111 01249000
@RF00106 DS    0H                                                  0112 01250000
*         /***********************************************************/ 01251000
*         /*                                                         */ 01252000
*         /* MACDATE Y-2 73018                                       */ 01253000
*         /*                                                         */ 01254000
*         /***********************************************************/ 01255000
*                                                                  0112 01256000
*         CALL IRBMFCNV(            /* CONVERSION ROUTINE            */ 01257000
*             SMF73CNT(RHCHAIDX),   /* INPUT VALUE                   */ 01258000
*             RHMILSCF,             /* INPUT SCALE                   */ 01259000
*             RHWRKSTR,             /* OUTPUT STRING                 */ 01260000
*             RHCOUNTL,             /* OUTPUT LENGTH                 */ 01261000
*             RHDECMIL,             /* PLACES RIGHT OF DEC PT        */ 01262000
*             RHNOCOMA,             /* COMMAS FLAG                   */ 01263000
*             RHNOFLOT              /* MAX PRECISION FLAG            */ 01264000
*             );                                                   0112 01265000
         MVC   @AL00001+4(24),@AL00112                             0112 01266000
         LR    @08,RHCHAIDX                                        0112 01267000
         SLA   @08,4                                               0112 01268000
         L     @03,@PC00001                                        0112 01269000
         L     @03,RHDTAPTR(,@03)                                  0112 01270000
         LA    @15,SMF73SIZ(,@03)                                  0112 01271000
         AH    @15,SMF73SIZ(,@03)                                  0112 01272000
         LH    @03,SMF73SHC(,@15)                                  0112 01273000
         AR    @03,@15                                             0112 01274000
         AL    @03,@CF00245                                        0112 01275000
         LA    @08,SMF73CNT-4(@08,@03)                             0112 01276000
         ST    @08,@AL00001                                        0112 01277000
         LA    @08,RHWRKSTR                                        0112 01278000
         ST    @08,@AL00001+8                                      0112 01279000
         L     @08,@PC00001+4                                      0112 01280000
         L     @15,RHVECTAB(,@08)                                  0112 01281000
         LA    @01,@AL00001                                        0112 01282000
         BALR  @14,@15                                             0112 01283000
*         RHWRKSTR(8)='M';          /* MILLIONS                      */ 01284000
*                                                                  0113 01285000
         MVI   RHWRKSTR+7,C'M'                                     0113 01286000
*         /***********************************************************/ 01287000
*         /*                                                         */ 01288000
*         /* MACDATE Y-2 73018                                       */ 01289000
*         /*                                                         */ 01290000
*         /***********************************************************/ 01291000
*                                                                  0114 01292000
*         CALL MFISRTXT(            /* INSERT TEXT ROUTINE           */ 01293000
*             RHWRKSTR,             /* TEXT                          */ 01294000
*             RHCOUNTL+1,           /* LENGTH                        */ 01295000
*             RHLINE,               /* START LINE                    */ 01296000
*             COLD                  /* START COLUMN                  */ 01297000
*             );                                                   0114 01298000
         LA    @08,RHWRKSTR                                        0114 01299000
         ST    @08,@AL00001                                        0114 01300000
         LA    @08,@CF00044                                        0114 01301000
         ST    @08,@AL00001+4                                      0114 01302000
         LA    @08,RHLINE                                          0114 01303000
         ST    @08,@AL00001+8                                      0114 01304000
         LA    @08,@CF00200                                        0114 01305000
         ST    @08,@AL00001+12                                     0114 01306000
         L     @08,@PC00001+4                                      0114 01307000
         L     @15,RHVECTAB+8(,@08)                                0114 01308000
         LA    @01,@AL00001                                        0114 01309000
         BALR  @14,@15                                             0114 01310000
*       END;                                                       0115 01311000
*                                                                  0115 01312000
*     /***************************************************************/ 01313000
*     /*                                                             */ 01314000
*     /* GATHER SIO TOTAL ON CPU                                     */ 01315000
*     /*                                                             */ 01316000
*     /***************************************************************/ 01317000
*                                                                  0116 01318000
*     RHSIOTOT=RHSIOTOT+SMF73CNT(RHCHAIDX);                        0116 01319000
*                                                                  0116 01320000
@RC00106 LR    @08,RHCHAIDX                                        0116 01321000
         SLA   @08,4                                               0116 01322000
         L     @03,@PC00001                                        0116 01323000
         L     @03,RHDTAPTR(,@03)                                  0116 01324000
         LA    @15,SMF73SIZ(,@03)                                  0116 01325000
         AH    @15,SMF73SIZ(,@03)                                  0116 01326000
         LH    @03,SMF73SHC(,@15)                                  0116 01327000
         AR    @03,@15                                             0116 01328000
         L     @15,RHSIOTOT                                        0116 01329000
         LA    @14,0(@08,@03)                                      0116 01330000
         AL    @14,@CF00245                                        0116 01331000
         AL    @15,SMF73CNT-4(,@14)                                0116 01332000
         ST    @15,RHSIOTOT                                        0116 01333000
*     /***************************************************************/ 01334000
*     /*                                                             */ 01335000
*     /* DONT PRINT CHANNEL BUSY OR CHANNEL BUSY/CPU WAIT IF THE     */ 01336000
*     /* CHANNEL TYPE IS INVALID OR MULTPLEX                         */ 01337000
*     /*                                                             */ 01338000
*     /***************************************************************/ 01339000
*                                                                  0117 01340000
*     IF SMF73IID(RHCHAIDX)='1'B|SMF73TYP(RHCHAIDX)=MULTPLEX THEN  0117 01341000
         ST    @08,@TF00001                                        0117 01342000
         ALR   @08,@03                                             0117 01343000
         AL    @08,@CF00244                                        0117 01344000
         TM    SMF73IID-3(@08),B'00000100'                         0117 01345000
         BO    @RT00117                                            0117 01346000
         AL    @03,@TF00001                                        0117 01347000
         AL    @03,@CF00244                                        0117 01348000
         TM    SMF73TYP-3(@03),B'00010000'                         0117 01349000
         BNO   @RF00117                                            0117 01350000
         TM    SMF73TYP-3(@03),B'11100000'                         0117 01351000
         BZ    @RT00117                                            0117 01352000
*       GO TO RHLAB4;               /* THEN PLACE LINE POINTER ON  0118 01353000
*                                      NEXT LINE                     */ 01354000
*                                                                  0118 01355000
*     /***************************************************************/ 01356000
*     /*                                                             */ 01357000
*     /* INSERT PERCENT CHANNEL BUSY IF DIVISOR IS NOT ZERO          */ 01358000
*     /*                                                             */ 01359000
*     /***************************************************************/ 01360000
*                                                                  0119 01361000
*     IF SMF73SAM^=0 THEN                                          0119 01362000
@RF00117 L     @08,@PC00001                                        0119 01363000
         L     @08,RHDTAPTR(,@08)                                  0119 01364000
         L     @03,SMF73SAM(,@08)                                  0119 01365000
         LTR   @03,@03                                             0119 01366000
         BZ    @RF00119                                            0119 01367000
*       DO;                                                        0120 01368000
*                                                                  0120 01369000
*         /***********************************************************/ 01370000
*         /*                                                         */ 01371000
*         /* CALCULATE (SMF73BSY(RHCHAIDX)*100000)/SMF73SAM MACDATE  */ 01372000
*         /* Y-2 73018                                               */ 01373000
*         /*                                                         */ 01374000
*         /***********************************************************/ 01375000
*                                                                  0121 01376000
*         RESPECIFY                                                0121 01377000
*          (GPR00P,                                                0121 01378000
*           GPR01P,                                                0121 01379000
*           GPR14P,                                                0121 01380000
*           GPR15P)RESTRICTED;                                     0121 01381000
*         GPR01F=SMF73BSY(RHCHAIDX);/* LARGE VALUE TO REGISTER       */ 01382000
         LR    @07,RHCHAIDX                                        0122 01383000
         SLA   @07,4                                               0122 01384000
         LA    @06,SMF73SIZ(,@08)                                  0122 01385000
         AH    @06,SMF73SIZ(,@08)                                  0122 01386000
         LH    @08,SMF73SHC(,@06)                                  0122 01387000
         AR    @08,@06                                             0122 01388000
         AL    @08,@CF00246                                        0122 01389000
         L     GPR01F,SMF73BSY-8(@07,@08)                          0122 01390000
*         GPR15F=SMF73SAM;          /* DENOMINATOR TO REGISTER       */ 01391000
         LR    GPR15F,@03                                          0123 01392000
*         GENERATE REFS(C100000);                                  0124 01393000
*                                                                  0124 01394000
        M     GPR00F,C100000       MAY SPILL INTO DOUBLE WORD           01395000
        DR    GPR00F,GPR15F        RESULT FITS INTO SINGLE WORD         01396000
*         /***********************************************************/ 01397000
*         /*                                                         */ 01398000
*         /* MACDATE Y-2 73018                                       */ 01399000
*         /*                                                         */ 01400000
*         /***********************************************************/ 01401000
*                                                                  0125 01402000
*         CALL IRBMFCNV(            /* CONVERSION ROUTINE            */ 01403000
*             EVAL(GPR01F),         /* INPUT VALUE                   */ 01404000
*             RHTHOSCF,             /* INPUT SCALE                   */ 01405000
*             RHWRKSTR,             /* OUTPUT STRING                 */ 01406000
*             RHPCTLEN,             /* OUTPUT LENGTH                 */ 01407000
*             RHPCTPLC,             /* PLACES RIGHT OF DEC PT        */ 01408000
*             RHNOCOMA,             /* COMMAS FLAG                   */ 01409000
*             RHNOFLOT              /* MAX PRECISION FLAG            */ 01410000
*             );                                                   0125 01411000
*                                                                  0125 01412000
         MVC   @AL00001+4(24),@AL00125                             0125 01413000
         ST    GPR01F,@AFTEMPS                                     0125 01414000
         LA    @08,@AFTEMPS                                        0125 01415000
         ST    @08,@AL00001                                        0125 01416000
         LA    @08,RHWRKSTR                                        0125 01417000
         ST    @08,@AL00001+8                                      0125 01418000
         L     @08,@PC00001+4                                      0125 01419000
         L     @15,RHVECTAB(,@08)                                  0125 01420000
         LA    @01,@AL00001                                        0125 01421000
         BALR  @14,@15                                             0125 01422000
*         /***********************************************************/ 01423000
*         /*                                                         */ 01424000
*         /* MACDATE Y-2 73018                                       */ 01425000
*         /*                                                         */ 01426000
*         /***********************************************************/ 01427000
*                                                                  0126 01428000
*         RESPECIFY                                                0126 01429000
*          (GPR00P,                                                0126 01430000
*           GPR01P,                                                0126 01431000
*           GPR14P,                                                0126 01432000
*           GPR15P)UNRESTRICTED;                                   0126 01433000
*       END;                                                       0127 01434000
*     ELSE                                                         0128 01435000
*       RHWRKSTR(1:5)=LNGTPTR(LHPART20)->LNGTXTD(1:LNGTPTR(LHPART20)->  01436000
*           LNGTXTL);                                              0128 01437000
*                                                                  0128 01438000
         B     @RC00119                                            0128 01439000
@RF00119 MVI   RHWRKSTR+1,C' '                                     0128 01440000
         MVC   RHWRKSTR+2(3),RHWRKSTR+1                            0128 01441000
         L     @08,@CA00100                                        0128 01442000
         L     @08,LNGTPTR-IRBMFLHV+76(,@08)                       0128 01443000
         L     @03,LNGTXTL(,@08)                                   0128 01444000
         BCTR  @03,0                                               0128 01445000
         EX    @03,@SM00247                                        0128 01446000
*     /***************************************************************/ 01447000
*     /*                                                             */ 01448000
*     /* MACDATE Y-2 73018                                           */ 01449000
*     /*                                                             */ 01450000
*     /***************************************************************/ 01451000
*                                                                  0129 01452000
*     CALL MFISRTXT(                /* INSERT TEXT ROUTINE           */ 01453000
*         RHWRKSTR,                 /* TEXT                          */ 01454000
*         RHPCTLEN,                 /* LENGTH                        */ 01455000
*         RHLINE,                   /* START LINE                    */ 01456000
*         COLE                      /* START COLUMN                  */ 01457000
*         );                                                       0129 01458000
*                                                                  0129 01459000
@RC00119 LA    @08,RHWRKSTR                                        0129 01460000
         ST    @08,@AL00001                                        0129 01461000
         LA    @08,@CF00110                                        0129 01462000
         ST    @08,@AL00001+4                                      0129 01463000
         LA    @08,RHLINE                                          0129 01464000
         ST    @08,@AL00001+8                                      0129 01465000
         LA    @08,@CF00202                                        0129 01466000
         ST    @08,@AL00001+12                                     0129 01467000
         L     @08,@PC00001+4                                      0129 01468000
         L     @15,RHVECTAB+8(,@08)                                0129 01469000
         LA    @01,@AL00001                                        0129 01470000
         BALR  @14,@15                                             0129 01471000
*     /***************************************************************/ 01472000
*     /*                                                             */ 01473000
*     /* INSERT PERCENT CHANNEL BUSY/CPU WAIT IF DIVISOR IS NOT ZERO */ 01474000
*     /*                                                             */ 01475000
*     /***************************************************************/ 01476000
*                                                                  0130 01477000
*     IF SMF73SAM^=0 THEN                                          0130 01478000
         L     @08,@PC00001                                        0130 01479000
         L     @08,RHDTAPTR(,@08)                                  0130 01480000
         L     @03,SMF73SAM(,@08)                                  0130 01481000
         LTR   @03,@03                                             0130 01482000
         BZ    @RF00130                                            0130 01483000
*       DO;                                                        0131 01484000
*                                                                  0131 01485000
*         /***********************************************************/ 01486000
*         /*                                                         */ 01487000
*         /* CALCULATE (SMF73OLP(RHCHAIDX)*100000)/SMF73SAM MACDATE  */ 01488000
*         /* Y-2 73018                                               */ 01489000
*         /*                                                         */ 01490000
*         /***********************************************************/ 01491000
*                                                                  0132 01492000
*         RESPECIFY                                                0132 01493000
*          (GPR00P,                                                0132 01494000
*           GPR01P,                                                0132 01495000
*           GPR14P,                                                0132 01496000
*           GPR15P)RESTRICTED;                                     0132 01497000
*         GPR01F=SMF73OLP(RHCHAIDX);/* LARGE VALUE TO REGISTER       */ 01498000
         LR    @07,RHCHAIDX                                        0133 01499000
         SLA   @07,4                                               0133 01500000
         LA    @06,SMF73SIZ(,@08)                                  0133 01501000
         AH    @06,SMF73SIZ(,@08)                                  0133 01502000
         LH    @08,SMF73SHC(,@06)                                  0133 01503000
         AR    @08,@06                                             0133 01504000
         AL    @08,@CF00249                                        0133 01505000
         L     GPR01F,SMF73OLP-12(@07,@08)                         0133 01506000
*         GPR15F=SMF73SAM;          /* DENOMINATOR TO REGISTER       */ 01507000
         LR    GPR15F,@03                                          0134 01508000
*         GENERATE REFS(C100000);                                  0135 01509000
*                                                                  0135 01510000
        M     GPR00F,C100000       MAY SPILL INTO DOUBLE WORD           01511000
        DR    GPR00F,GPR15F        RESULT FITS INTO SINGLE WORD         01512000
*         /***********************************************************/ 01513000
*         /*                                                         */ 01514000
*         /* MACDATE Y-2 73018                                       */ 01515000
*         /*                                                         */ 01516000
*         /***********************************************************/ 01517000
*                                                                  0136 01518000
*         CALL IRBMFCNV(            /* CONVERSION ROUTINE            */ 01519000
*             EVAL(GPR01F),         /* INPUT VALUE                   */ 01520000
*             RHTHOSCF,             /* INPUT SCALE                   */ 01521000
*             RHWRKSTR,             /* OUTPUT STRING                 */ 01522000
*             RHPCTLEN,             /* OUTPUT LENGTH                 */ 01523000
*             RHPCTPLC,             /* PLACES RIGHT OF DEC PT        */ 01524000
*             RHNOCOMA,             /* COMMAS FLAG                   */ 01525000
*             RHNOFLOT              /* MAX PRECISION FLAG            */ 01526000
*             );                                                   0136 01527000
*                                                                  0136 01528000
         MVC   @AL00001+4(24),@AL00136                             0136 01529000
         ST    GPR01F,@AFTEMPS                                     0136 01530000
         LA    @08,@AFTEMPS                                        0136 01531000
         ST    @08,@AL00001                                        0136 01532000
         LA    @08,RHWRKSTR                                        0136 01533000
         ST    @08,@AL00001+8                                      0136 01534000
         L     @08,@PC00001+4                                      0136 01535000
         L     @15,RHVECTAB(,@08)                                  0136 01536000
         LA    @01,@AL00001                                        0136 01537000
         BALR  @14,@15                                             0136 01538000
*         /***********************************************************/ 01539000
*         /*                                                         */ 01540000
*         /* MACDATE Y-2 73018                                       */ 01541000
*         /*                                                         */ 01542000
*         /***********************************************************/ 01543000
*                                                                  0137 01544000
*         RESPECIFY                                                0137 01545000
*          (GPR00P,                                                0137 01546000
*           GPR01P,                                                0137 01547000
*           GPR14P,                                                0137 01548000
*           GPR15P)UNRESTRICTED;                                   0137 01549000
*       END;                                                       0138 01550000
*     ELSE                                                         0139 01551000
*       RHWRKSTR(1:5)=LNGTPTR(LHPART20)->LNGTXTD(1:LNGTPTR(LHPART20)->  01552000
*           LNGTXTL);                                              0139 01553000
*                                                                  0139 01554000
         B     @RC00130                                            0139 01555000
@RF00130 MVI   RHWRKSTR+1,C' '                                     0139 01556000
         MVC   RHWRKSTR+2(3),RHWRKSTR+1                            0139 01557000
         L     @08,@CA00100                                        0139 01558000
         L     @08,LNGTPTR-IRBMFLHV+76(,@08)                       0139 01559000
         L     @03,LNGTXTL(,@08)                                   0139 01560000
         BCTR  @03,0                                               0139 01561000
         EX    @03,@SM00247                                        0139 01562000
*     /***************************************************************/ 01563000
*     /*                                                             */ 01564000
*     /* MACDATE Y-2 73018                                           */ 01565000
*     /*                                                             */ 01566000
*     /***************************************************************/ 01567000
*                                                                  0140 01568000
*     CALL MFISRTXT(                /* INSERT TEXT ROUTINE           */ 01569000
*         RHWRKSTR,                 /* TEXT                          */ 01570000
*         5,                        /* LENGTH                        */ 01571000
*         RHLINE,                   /* START LINE                    */ 01572000
*         COLF                      /* START COLUMN                  */ 01573000
*         );                                                       0140 01574000
@RC00130 LA    @08,RHWRKSTR                                        0140 01575000
         ST    @08,@AL00001                                        0140 01576000
         LA    @08,@CF00110                                        0140 01577000
         ST    @08,@AL00001+4                                      0140 01578000
         LA    @08,RHLINE                                          0140 01579000
         ST    @08,@AL00001+8                                      0140 01580000
         LA    @08,@CF00204                                        0140 01581000
         ST    @08,@AL00001+12                                     0140 01582000
         L     @08,@PC00001+4                                      0140 01583000
         L     @15,RHVECTAB+8(,@08)                                0140 01584000
         LA    @01,@AL00001                                        0140 01585000
         BALR  @14,@15                                             0140 01586000
*RHLAB4:                                                           0141 01587000
*                                                                  0141 01588000
*     /***************************************************************/ 01589000
*     /*                                                             */ 01590000
*     /* POINT TO NEXT LINE                                          */ 01591000
*     /*                                                             */ 01592000
*     /***************************************************************/ 01593000
*                                                                  0141 01594000
*     RHLINE=RHLINE+1;                                             0141 01595000
RHLAB4   LA    @08,1                                               0141 01596000
         A     @08,RHLINE                                          0141 01597000
         ST    @08,RHLINE                                          0141 01598000
*   END;                            /* LOOP ON CHANNEL ENTRIES       */ 01599000
         AH    RHCHAIDX,@CH00075                                   0142 01600000
@DE00016 L     @08,@PC00001                                        0142 01601000
         L     @08,RHDTAPTR(,@08)                                  0142 01602000
         LA    @08,SMF73SIZ(,@08)                                  0142 01603000
         L     @03,@PC00001                                        0142 01604000
         L     @03,RHDTAPTR(,@03)                                  0142 01605000
         AH    @08,SMF73SIZ(,@03)                                  0142 01606000
         LA    @03,1                                               0142 01607000
         AH    @03,SMF73CHA(,@08)                                  0142 01608000
         CR    RHCHAIDX,@03                                        0142 01609000
         BNH   @DL00016                                            0142 01610000
*   CALL MFWRTPAG;                  /* WRITE LAST PAGE               */ 01611000
         L     @08,@PC00001+4                                      0143 01612000
         L     @15,RHVECTAB+12(,@08)                               0143 01613000
         BALR  @14,@15                                             0143 01614000
*   RETURN;                         /* RETURN TO CALLER              */ 01615000
@EL00001 L     @13,4(,@13)                                         0144 01616000
@EF00001 L     @00,@SIZDATD                                        0144 01617000
         LR    @01,@09                                             0144 01618000
         FREEMAIN R,LV=(0),A=(1)                                        01619000
@ER00001 LM    @14,@12,12(@13)                                     0144 01620000
         BR    @14                                                 0144 01621000
*   END                                                            0145 01622000
*                                                                  0145 01623000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01624000
*/*%INCLUDE SYSLIB  (IFASMFR )                                       */ 01625000
*/*%INCLUDE SYSLIB  (IRBRGCON)                                       */ 01626000
*/*%INCLUDE SYSLIB  (IRBMFLHM)                                       */ 01627000
*                                                                  0145 01628000
*       ;                                                          0145 01629000
@DATA    DS    0H                                                       01630000
@CH00226 DC    H'57'                                                    01631000
@CH00160 DC    XL1'0'                                                   01632000
         DC    C'0'                                                     01633000
@SM00247 MVC   RHWRKSTR(0),LNGTXTD(@08)                                 01634000
         DS    0F                                                       01635000
@AL00025 EQU   *                       LIST WITH   6 ARGUMENT(S)        01636000
@AL00108 DC    A(@CF00184)             LIST WITH   6 ARGUMENT(S)        01637000
         DS    F                                                        01638000
         DC    A(@CF00114)                                              01639000
         DC    A(@CF00184)                                              01640000
         DC    A(@CB00178)                                              01641000
         DC    A(@CB00180)                                              01642000
@AL00029 DC    A(@CF00189)             LIST WITH   6 ARGUMENT(S)        01643000
         DS    F                                                        01644000
         DC    A(@CF00087)                                              01645000
         DC    A(@CF00097)                                              01646000
         DC    A(@CB00178)                                              01647000
         DC    A(@CB00180)                                              01648000
@AL00070 DC    A(@CF00184)             LIST WITH   6 ARGUMENT(S)        01649000
         DS    F                                                        01650000
         DC    A(@CF00056)                                              01651000
         DC    A(@CF00184)                                              01652000
         DC    A(@CB00180)                                              01653000
         DC    A(@CB00180)                                              01654000
@AL00112 DC    A(@CF00189)             LIST WITH   6 ARGUMENT(S)        01655000
         DS    F                                                        01656000
         DC    A(@CF00114)                                              01657000
         DC    A(@CF00097)                                              01658000
         DC    A(@CB00180)                                              01659000
         DC    A(@CB00180)                                              01660000
@AL00125 EQU   *                       LIST WITH   6 ARGUMENT(S)        01661000
@AL00136 DC    A(@CF00195)             LIST WITH   6 ARGUMENT(S)        01662000
         DS    F                                                        01663000
         DC    A(@CF00110)                                              01664000
         DC    A(@CF00056)                                              01665000
         DC    A(@CB00180)                                              01666000
         DC    A(@CB00180)                                              01667000
@DATD    DSECT                                                          01668000
         DS    0F                                                       01669000
@SA00001 DS    18F                                                      01670000
@PC00001 DS    3F                                                       01671000
@AL00001 DS    7A                                                       01672000
@TF00001 DS    F                                                        01673000
@AFTEMPS DS    1F                                                       01674000
IRBMFRHR CSECT                                                          01675000
         DS    0F                                                       01676000
@CF00240 DC    F'-16'                                                   01677000
@CF00243 DC    F'-14'                                                   01678000
@CF00244 DC    F'-13'                                                   01679000
@CF00245 DC    F'-12'                                                   01680000
@CF00246 DC    F'-8'                                                    01681000
@CF00189 DC    F'-6'                                                    01682000
@CF00249 DC    F'-4'                                                    01683000
@CF00195 DC    F'-3'                                                    01684000
@CF00216 DC    F'-1'                                                    01685000
@CF00184 DC    F'0'                                                     01686000
@CF00075 DC    F'1'                                                     01687000
@CH00075 EQU   @CF00075+2                                               01688000
@CF00056 DC    F'2'                                                     01689000
@CF00097 DC    F'3'                                                     01690000
@CF00049 DC    F'4'                                                     01691000
@CF00110 DC    F'5'                                                     01692000
@CF00112 DC    F'6'                                                     01693000
@CF00114 DC    F'7'                                                     01694000
@CF00044 DC    F'8'                                                     01695000
@CF00117 DC    F'9'                                                     01696000
@CF00119 DC    F'10'                                                    01697000
@CF00087 DC    F'13'                                                    01698000
@CH00087 EQU   @CF00087+2                                               01699000
@CF00126 DC    F'14'                                                    01700000
@CF00135 DC    F'19'                                                    01701000
@CF00237 DC    F'21'                                                    01702000
@CF00235 DC    F'22'                                                    01703000
@CF00200 DC    F'25'                                                    01704000
@CF00202 DC    F'40'                                                    01705000
@CF00204 DC    F'55'                                                    01706000
@CF00085 DC    F'60'                                                    01707000
@CF00217 DC    F'1000000'                                               01708000
@DATD    DSECT                                                          01709000
         DS    0D                                                       01710000
RHCHACNT DS    F                                                        01711000
RHCPUNO  DS    F                                                        01712000
RHPAGE   DS    F                                                        01713000
RHLINE   DS    F                                                        01714000
RHSIOTOT DS    F                                                        01715000
RHWRKSTR DS    CL14                                                     01716000
RHCHANO  DS    CL3                                                      01717000
RHNEWCPU DS    BL1                                                      01718000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01719000
@ENDDATD EQU   *                                                        01720000
IRBMFRHR CSECT                                                          01721000
         DS    0F                                                       01722000
@SIZDATD DC    AL1(0)                                                   01723000
         DC    AL3(@ENDDATD-@DATD)                                      01724000
@CA00100 DC    A(IRBMFLHV)                                              01725000
         DS    0D                                                       01726000
C100000  DC    F'100000'                                                01727000
@CC00161 DC    C'0123456789ABCDEF'                                      01728000
@CB00178 DC    B'10000000'                                              01729000
@CB00180 DC    B'00000000'                                              01730000
RHPATCH  DS    CL200                                                    01731000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01732000
@01      EQU   01                                                       01733000
@02      EQU   02                                                       01734000
@03      EQU   03                                                       01735000
@04      EQU   04                                                       01736000
@05      EQU   05                                                       01737000
@06      EQU   06                                                       01738000
@07      EQU   07                                                       01739000
@08      EQU   08                                                       01740000
@09      EQU   09                                                       01741000
@10      EQU   10                                                       01742000
@11      EQU   11                                                       01743000
@12      EQU   12                                                       01744000
@13      EQU   13                                                       01745000
@14      EQU   14                                                       01746000
@15      EQU   15                                                       01747000
RHCHAIDX EQU   @02                                                      01748000
GPR01F   EQU   @01                                                      01749000
GPR15F   EQU   @15                                                      01750000
GPR00P   EQU   @00                                                      01751000
GPR01P   EQU   @01                                                      01752000
GPR14P   EQU   @14                                                      01753000
GPR15P   EQU   @15                                                      01754000
GPR11P   EQU   @11                                                      01755000
GPR12P   EQU   @12                                                      01756000
GPR00F   EQU   @00                                                      01757000
GPR14F   EQU   @14                                                      01758000
         EXTRN IRBMFLHV                                                 01759000
SMFRCD73 EQU   0                                                        01760000
SMF73SIZ EQU   SMFRCD73+18                                              01761000
SMF73SAM EQU   SMFRCD73+36                                              01762000
SMF73PTR EQU   0                                                        01763000
SMF73A   EQU   0                                                        01764000
SMF73SHC EQU   SMF73A                                                   01765000
SMF73CHA EQU   SMF73A+2                                                 01766000
SMF73B   EQU   0                                                        01767000
SMF73CID EQU   SMF73B                                                   01768000
SMF73HID EQU   SMF73B+2                                                 01769000
SMF73FG2 EQU   SMF73B+3                                                 01770000
SMF73TYP EQU   SMF73FG2                                                 01771000
SMF73IID EQU   SMF73FG2                                                 01772000
SMF73VAC EQU   SMF73FG2                                                 01773000
SMF73STA EQU   SMF73FG2                                                 01774000
SMF73CNT EQU   SMF73B+4                                                 01775000
SMF73BSY EQU   SMF73B+8                                                 01776000
SMF73OLP EQU   SMF73B+12                                                01777000
LNGTXT   EQU   0                                                        01778000
LNGTXTL  EQU   LNGTXT                                                   01779000
LNGTXTD  EQU   LNGTXT+4                                                 01780000
IRBMFCNV EQU   0                                                        01781000
MFHDRISR EQU   0                                                        01782000
MFISRTXT EQU   0                                                        01783000
MFWRTPAG EQU   0                                                        01784000
RHTRTAB  EQU   0                                                        01785000
IKEBC    EQU   0                                                        01786000
IKEBF15  EQU   0                                                        01787000
IKEBF31  EQU   0                                                        01788000
IKEBP15  EQU   0                                                        01789000
IKEBP31  EQU   0                                                        01790000
IKEBP8   EQU   0                                                        01791000
RHDTAPTR EQU   0                                                        01792000
RHVECTAB EQU   0                                                        01793000
RHPMAPTR EQU   0                                                        01794000
LNG      EQU   IRBMFLHV                                                 01795000
LNGTPTR  EQU   LNG                                                      01796000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01797000
@NM00001 EQU   SMF73FG2                                                 01798000
SMF73RV2 EQU   SMF73A+6                                                 01799000
SMF73SHD EQU   SMF73A+4                                                 01800000
SMF73RLS EQU   SMFRCD73+44                                              01801000
SMF73RV1 EQU   SMFRCD73+42                                              01802000
SMF73MFV EQU   SMFRCD73+40                                              01803000
SMF73SUB EQU   SMFRCD73+34                                              01804000
SMF73CYC EQU   SMFRCD73+32                                              01805000
SMF73INT EQU   SMFRCD73+28                                              01806000
SMF73DAT EQU   SMFRCD73+24                                              01807000
SMF73IST EQU   SMFRCD73+20                                              01808000
SMF73SID EQU   SMFRCD73+14                                              01809000
SMF73DTE EQU   SMFRCD73+10                                              01810000
SMF73TME EQU   SMFRCD73+6                                               01811000
SMF73RTY EQU   SMFRCD73+5                                               01812000
SMF73FLG EQU   SMFRCD73+4                                               01813000
SMF73SEG EQU   SMFRCD73+2                                               01814000
SMF73LEN EQU   SMFRCD73                                                 01815000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01816000
@RT00034 EQU   RHLAB4                                                   01817000
@RC00096 EQU   RHLAB4                                                   01818000
@RT00117 EQU   RHLAB4                                                   01819000
@ENDDATA EQU   *                                                        01820000
         END   IRBMFRHR,(C'PL/S-II',0502,74087)                         01821000
