IEE0303D TITLE 'TRANSLATE AND CHAIN DESCRIPTION'                        00200002
*********************************************************************** 00400018
*                                                                     * 00600018
* MODULE NAME =     IEE0303D                                          * 00650002
*                                                                     * 00700002
* DESCRIPTIVE NAME =                                                  * 00750002
*                   CHAIN MANIPULATION: QEDIT MACRO FUNCTION          * 00760002
*                   MGCR MACRO FUNCTION.                              * 00770002
* COPYRIGHT =       N/A                                               * 00780002
*                                                                     * 01000018
* STATUS =          OS/VS2 - RELEASE 3                        @ZA08456* 01050003
*                                                                     * 01100002
* FUNCTION =        THIS MODULE PERFORMS CSCB AND CIB CHAIN           * 01150002
*                   MANIPULATION PROCESSING. IF COMMANDS ARE          * 01170002
*                   BEING PROCESSED, THIS MODULE BRANCHES TO          * 01180002
*                   IEE5403D TO TRANSLATE THE COMMAND. BLOCKS         * 01190002
*                   CAN BE ADDED TO CHAIN, DELETED FROM CHAIN         * 01192002
*                   OR THE CIB COUNT CAN BE MODIFIED, OR AN           * 01194002
*                   ABTERM REQUEST CAN BE COMMUNICATED TO ABTERM      * 01196002
*                   BY THIS MODULE.                                   * 01198002
*                                                                     * 01208002
* OPERATION =       THE PROCESSING METHODS USED IN THIS MODULE        * 01248002
*                   ARE MAINLY SUBROUTINES.  COMMON ROUTINES          * 01298002
*                   ARE USED FOR CHAIN MANIPULATION OF BOTH           * 01348002
*                   CIB AND CSCB CHAINS, AND SPECIALIZED SUB-         * 01398002
*                   ROUTINES HANDLE UNIQUE SITUATIONS SUCH            * 01448002
*                   AS THE ABTERM ENTRY.  INITIAL PROCESSING          * 01498002
*                   VALIDITY CHECKS ISSUER FOR A SYSTEM PRO-          * 01548002
*                   TECT KEY (LESS THAN EIGHT). IF SVC34 IS BEING     * 01598002
*                   CALLED BY A PROBLEM PROGRAM, A BIT IS             * 01608002
*                   SET IN THE XSA, TO BE TESTED WHEN SVC34           * 01618002
*                   OR QEDIT FUNCTIONS ARE BEING CALLED.              * 01628002
*                   A PROBLEM PROGRAM IS ALLOWED ONLY A SUBSET        * 01638002
*                   OF THESE FUNCTIONS. PARM VALUES                   * 01640002
*                   IN R0 AND R1 ARE EXAMINED. IF COMMAND             * 01648002
*                   TRANSLATION IS NEEDED, A BRANCH IS TAKEN          * 01698002
*                   TO IEE5403D.                                      * 01748002
*                   IF INPUT INDICATES TASK TO BE DONE IS             * 01798002
*                   CSCB CHAIN MANIPULATION, FLAGS IN THE CSCB        * 01848002
*                   INDICATE ACTION TO BE TAKEN.                      * 01898002
*                       CHABT = INDICATE ENTRY TO ABTERM.             * 01948002
*                       CHAD  = ADD CSCB TO CHAIN.                    * 01998002
*                       CHDL  = DELETE CSCB FROM CHAIN.               * 01998402
*                       CHFC  = FREE CORE FOR CSCB.                   * 01998802
*                   IF ABTERM BIT IS ON, XAV+D4 WILL CONTAIN A        * 01999202
*                   POINTER TO THE ABTERM PARAMETERS.                 * 01999602
*                   THE PARAMETERS TO ABTERM ARE THE TCB POINTER      * 01999702
*                   OF THE TASK TO BE TERMINATED AND THE              * 02009702
*                   COMPLETION CODE.  ABTERM IS INVOKED AND THE       * 02019702
*                   PARAMETERS PASSED VIA THE CALLRTM MACRO,          * 02019802
*                   TYPE=ABTERM.                                      * 02019902
          EJECT                                                         02152002
*                   IF THE INPUT INDICATES ACTION TO BE TAKEN         * 02160002
*                   IS CIB CHAIN MANIPULATION, NO FLAGS ARE SET       * 02170002
*                   IN THE CONTROL BLOCKS.  IF THE BLOCK IS ON        * 02180002
*                   THE CHAIN IT IS REMOVED AND THE CORE IS           * 02190002
*                   FREED.  IF IT IS NOT ON THE CHAIN, IT IS          * 02192002
*                   ADDED.                                            * 02194002
*                   FOR SETTING CIB COUNT IN THE CSCB, R1             * 02244002
*                   CONTAINS THE COMPLEMENT OF THE COUNT.             * 02294002
*                   R0 CONTAINS THE COMPLEMENT OF THE ORIGIN          * 02344002
*                   ADDRESS, (I.E. CHCIBP IN CSCB).                   * 02394002
*                   IF CIB IS TO BE PROCESSED, THE ORIGIN             * 02444002
*                   POINTER IS TESTED FOR VALIDITY. IF THE            * 02494002
*                   ORIGIN IS INVALID, AN ERROR CODE IS               * 02544002
*                   RETURNED.                                         * 02594002
*                   FOR CHAIN MANIPULATION, R1 CONTAINS THE           * 02644002
*                   COMPLEMENTED BLOCK ADDRESS. R0, IF POSI-          * 02694002
*                   TIVE CONTAINS THE ORIGIN ADDRESS.  IF R0          * 02744002
*                   IS ZERO ONLY CSCB PROCESSING IS PERFORMED.        * 02794002
*                                                                     * 02844002
* CHARACTER CODE DEPENDENCIES =                                       * 02894002
*                   ANY CHARACTER CODE OTHER THAN EBCDIC WILL         * 02944002
*                   REQUIRE REASSEMBLY OF MODULE.                     * 02994002
*                                                                     * 03004002
* DEPENDENCIES =    CALLRTM: TYPE=ABTERM                              * 03044002
*                                                                     * 03046002
* REGISTER CONVENTIONS =                                              * 03048002
*                   R0  = INPUT PARM REG: SEE INPUT SECTION           * 03048102
*                   R1  = INPUT PARM REG: SEE INPUT SECTION           * 03048402
*                   R14 = RETURN REGISTER                             * 03098402
*                   R15 = RETURN CODE REGISTER                        * 03148402
*                                                                     * 03158402
* PATCH LABEL =     PATCH: RESERVED PATCH AREA                        * 03198402
*                                                                     * 03208402
* MODULE TYPE =     CSECT                                             * 03248402
*                                                                     * 03258402
* MODULE SIZE =     FORMER DESIGN POINT CONSTRAINTS OF 1K             * 03298402
*                   LOADS FOR SVCS HAVE BEEN REMOVED.                 * 03348402
*                   SIZE = HEX 35F                                    * 03358402
*                                                                     * 03368402
* ATTRIBUTES =      REENTRANT, PAGED LPA, ZERO PSW KEY, SUP-          * 03398402
*                   ERVISOR MODE.                                     * 03448402
*                                                                     * 03458402
* ENTRY POINT =     IEE0303D FROM IEE0003D.                           * 03498402
*                                                                     * 03508402
* PURPOSE =         CSCB, CIB CHAIN MANIPULATION AND ABTERM           * 03548402
*                   ENTRY.                                            * 03552402
*                                                                     * 03558402
* LINKAGE =         BRANCH FROM IEE0003D.                             * 03598402
         EJECT                                                          03608402
* INPUT DATA =      FOR SYSTEM TASKS ISSUING SVC34                    * 03648402
*                                                                     * 03658402
*                   R1    R0     FUNCTION ACTION                      * 03698402
*                                                                     * 03708402
*                   POS   N/A    PROCESS COMMAND:TO IEE5403D.         * 03748402
*                   ZERO  POS    FREE CIB CHAIN                       * 03798402
*                   ZERO  ZERO   ERROR: RC/8 BR14                     * 03848402
*                   ZERO  NEG    SET CHCIBCT TO ZERO                  * 03898402
*                   NEG   POS    CIB CHAIN ADD OR DELETE              * 03948402
*                   NEG   ZERO   CSCB PROCESSING                      * 03998402
*                   NEG   NEG    STORE R1 IN CHCIBCT                  * 04048402
*                                                                     * 04058402
*                   FOR A PROBLEM PROGRAM ISSUING SVC34.              * 04098402
*                                                                     * 04108402
*                   POS   N/A    RC/8 BR14                            * 04148402
*                   ZERO  POS    RC/8 BR14                            * 04158402
*                   ZERO  ZERO   RC/8 BR14                            * 04198402
*                   ZERO  NEG    SET CHCIBCT TO ZERO                  * 04208402
*                   NEG   POS    DELETE CIB                           * 04248402
*                   NEG   ZERO   CSCB PROCESSING                      * 04298402
*                   NEG   NEG    STORE R1 IN CHCIBCT                  * 04348402
*                                                                     * 04398402
*                   THE QEDIT OR MGCR MACROS CAN BE USED              * 04398502
*                   TO ISSUE SVC34.                                   * 04398602
*                   R5 CONTAINS PTR TO CALLERS RB.                    * 04398802
*                   R14 CONTAINS RETURN ADDRESS.                      * 04399202
*                   XAN CONTAINS PTR TO ABTERM PARM LIST.             * 04399602
*                                                                     * 04399702
* REGISTERS SAVED = R1,R2,R14: DURING PROCESSING.                     * 04399802
*                                                                     * 04399902
* REGISTER CONTENTS DURING PROCESSING =                               * 04400002
*                   R2  = ADDRESSIBILITY FOR CHAINS                   * 04449902
*                   R3  = ADDRESSIBILITY FOR PROGRAM.                 * 04459902
*                   R4  = CHAIN MANIPULATION REG.                     * 04469902
*                   R5  = PTR TO CALLERS RB.                          * 04479902
*                         CHAIN MANIPULATION                          * 04481902
*                   R6  = CIBCT REG.                                  * 04489902
*                   R7  = CHAIN MANIPULATION REG.                     * 04491902
*                   R8  = CVT ADDRESSIBILITY.                         * 04493902
*                         CIB CHAIN MANIPULATION.                     * 04495902
*                         SAVEREG FOR R1 DURING ABTERM.               * 04497902
*                   R9  = XSA ADDRESSIBILITY                          * 04498302
*                   R10 = BASEA ADDRESSIBILITY                        * 04499102
*                         CSCB ORIGIN POINTER.                        * 04499502
*                   R11 = SETLOCK.                                    * 04499602
*                   R12 = BAL REG FOR SUBROUTINES                     * 04499702
*                   R13 = PTR TO ABTERM PARMS.                        * 04499802
         EJECT                                                          04583202
* EXIT - NORMAL =   TRBRANCH                                          * 04616602
* CONDITIONS =      SVC34 IS ISSUED FOR COMMAND TRANSLATION           * 04666602
*                   AND COMMAND PROCESSING. A BRANCH IS TAKEN         * 04716602
*                   TO IEE5403D.                                      * 04726602
* OUTPUT DATA =     SAME AS INPUT.                                    * 04766602
* RETURN CODE =     NONE.                                             * 04816602
*                                                                     * 04866602
* EXIT - NORMAL =   XENABLE                                           * 04916602
* CONDITIONS =      SUCCESSFUL COMPLETION OF CHAIN MANIPULATION       * 04966602
* OUTPUT DATA =     CSCB OR CIB ADDED OR DELETED FROM CHAIN.          * 05016602
*                   CHCIBCT FIELD IN CSCB UPDATED.                    * 05066602
* RETURN CODE =     R15 = 0.                                          * 05116602
*                                                                     * 05166602
* EXIT - ERROR =    XERR.                                             * 05216602
* CONDITIONS =      1. INPUT CSCB PTR NOT EQUAL TO ANY CSCB           * 05266602
*                   ON CSCB CHAIN FOR DELETE CSCB ENTRY.              * 05316602
*                   2. INPUT CIB PTR NOT EQUAL TO ANY CHCIBP          * 05366602
*                   ON CSCB CHAIN.                                    * 05416602
* OUTPUT DATA =     NONE.                                             * 05466602
* RETURN CODE =     R15 = FOUR.                                       * 05516602
*                                                                     * 05566602
* EXIT - ERROR =    ERRORHER.                                         * 05616602
* CONDITIONS =      1. P/P ISSUES SVC34 WITH COMMAND PROCES-          * 05666602
*                   SING INDICATED. (R1 POSITIVE.)                    * 05716602
*                   2. P/P ISSUES SVC34 WITH FREE CIB CHAIN           * 05766602
*                   (R1 = 0 AND R0 POSITIVE.)                         * 05816602
*                   3. R1 AND R0 ARE BOTH EQUAL ZERO.                 * 05916602
* OUTPUT DATA =     NONE.                                             * 05966602
* RETURN CODE =     R15 = EIGHT.                                      * 05976602
*                                                                     * 05977002
* EXIT - ERROR=     ERROROUT                                          * 05978602
* CONDITIONS =      1. P/P ISSUES SVC34 TO GO TO ABTERM.              * 05980602
*                   2. P/P ISSUES SVC34 TO ADD CSCB.                  * 05981002
* OUTPUT DATA =     NONE.                                             * 05982602
* RETURN CODE =     R15 = EIGHT.                                      * 05984602
*                                                                     * 05985002
*                                                                     * 05986602
* EXIT - ERROR =    XENABLE                                           * 05996602
* CONDITIONS =      CIB TO BE ADDED EXCEEDS LIMIT COUNT IN            * 05998602
*                   CHCIBCT FIELD IN CSCB.                            * 05999002
* OUTPUT DATA =     NONE.                                             * 05999402
* RETURN CODE =     R15 = EIGHT.                                      * 05999802
         EJECT                                                          06049802
* EXTERNAL REFERENCES =                                               * 06050002
* ROUTINES =        IEE5403D: COMMAND TRANSLATION MODULE.             * 06100002
* DATA AREAS =      NONE.                                             * 06150002
* CONTROL BLOCKS =  IEECHAIN  CSCB                                    * 06200002
*                   IEEBASEA  MASTER RESIDENT CORE                    * 06250002
*                   IEZCIB    COMMAND INPUT BUFFER                    * 06300002
*                   CVT                                               * 06350002
*                   IEEXSA    EXTENDED SAVE AREA                      * 06400002
*                   IHAPSA    PREFIX STORAGE AREA                     * 06410002
* TABLES =          NONE.                                             * 06450002
* MACROS =          FREEMAIN, MODID, CALLRTM: TYPE=ABTERM,            * 06500002
*                   TESTAUTH, ENQ, SETLOCK, SYSEVENT, SPOST,          * 06502002
*                   AND DEQ.                                          * 06504002
*                   DURING CHAIN MANIPULATION ROUTINES, THE           * 06510002
*                   CSCB AND CIB ARE PROTECTED VIA ENQ.               * 06520002
*                   THE ENQ IS EXCLUSIVE.                             * 06522002
*                   MAJOR NAME=SYSIEFSD. MINOR NAME=Q10.              * 06523003
* CHANGE ACTIVITY                                             @ZA08456* 06524003
*            OZ08456                                          @ZA08456* 06526003
* MESSAGES =        NONE.                                             * 06550002
*                                                                     * 07800018
* SYSGEN =          THIS MODULE IS INCLUDED IN LOAD MODULE            * 07810002
*                   IGC0003D, IN DLIB AOSB3 AND IS GENERATED          * 07820002
*                   VIA SYSGEN MACRO SGIEF441. IT RESIDES IN          * 07830002
*                   LPALIB.                                           * 07840002
* LIBRARIES =       NONE.                                             * 07842002
*********************************************************************** 07850002
* NOTES - A ROUTINE THAT ISSUES AN SVC 34 MUST HAVE PROTECT KEY       * 14200018
*        OF LESS THAN EIGHT; I.E. SYSTEM KEY.                         * 14400002
*       - FLAGS WERE NOT USED TO INDICATE WHAT PROCESSING SHOULD BE   * 14600018
*         PERFORMED ON A CIB TO ALLOW FUTURE NON-ZERO PROTECT KEY     * 14800018
*         ROUTINES CERTAIN CIB PROCESSING(DELETE ONE CIB,SET MAX CNT) * 15000018
*         THIS WOULD NOT BE POSSIBLE IF ROUTINE HAD TO SET FLAGS      * 15200018
*         IN A CIB WHICH IS IN PROTECTED STORAGE(S.P.245)             * 15400002
*                                                                     * 15600018
*********************************************************************** 15800018
         TITLE ' CSCB'                                                  16200002
DSCHAIN  DSECT                                                          16400018
         IEECHAIN                                                       16600018
         TITLE ' PREFIX STORAGE AREA'                                   16850002
         IHAPSA                                                         16900002
         TITLE ' MASTER RESIDENT CORE'                                  17000018
         IEEBASEA                                                       17200018
         TITLE ' COMMUNICATIONS VECTOR TABLE'                           17400018
CVT      DSECT                                                   Y02669 17600002
         CVT                                                            17800001
         TITLE ' EXTENDED SAVE AREA'                                    18200018
TRXSA    DSECT                                                          18400018
         IEEXSA                                                         18600018
         TITLE ' COMMAND INPUT BUFFER'                                  18650002
CIBD     DSECT                                                          20000018
CIB      IEZCIB                                                         20200018
         TITLE 'IEE0303D QEDIT'                                         20400002
IEE0303D CSECT                                                          20600018
* A 480620-480640                                                YM1157 20600101
* D 481500-481800                                                YM1157 20600201
* A 428020-428040                                              @YM08433 20650203
* A 428070-428150,429000,861250-861270                         @YM07259 20700203
* C 884000                                                     @YM07259 20800202
* CODE ADDED TO ENQRTN                                         @ZA08456 20850203
         SPACE                                                          21000018
* R E G I S T E R   A S S I G N M E N T S                               21200018
         SPACE                                                          21400018
R0       EQU   0     UCM INDICATOR                                 IMCS 21600018
R1       EQU   1    INPUT REG, PTR TO BUFFER                            21800018
R2       EQU   2    XSA BASE REG                                        22000018
R3       EQU   3    MODULE BASE REG                                     22200018
R4       EQU   4    XSA WORKREG                                         22400018
R5       EQU   5    TRANSLATE WORK REG                                  22600018
R6       EQU   6    TRANSLATE WORK REG                                  22800018
R7       EQU   7                                                        23000018
R8       EQU   8                                                        23200018
R9       EQU   9                                                        23400018
R10      EQU   10                                                       23600018
R11      EQU   11                                                       23800018
R12      EQU   12                                                       24000018
R13      EQU   13                                                       24200018
R14      EQU   14                                                       24400018
R15      EQU   15   XCTL PARA-REG                                       24600018
CHABT    EQU   X'01'                   ABTERM BIT OF CHAIN ELEMENT      25000018
FOXZERO  EQU   X'F0'                                               SMCS 25800018
D0       EQU   0                        USED FOR OFFSETS,LENGTHS,ETC.   26200018
D2       EQU   2                        *                               26600018
D3       EQU   3                        *                        Y02651 26610002
D4       EQU   4                        *                        Y02669 26650002
D8       EQU   8                        *                        Y02669 26700002
D17      EQU   17                                                       27000018
D28      EQU   28                                                 20030 27040020
D96      EQU   96                                                 20002 27080020
X00      EQU   X'00'                                              20002 27120020
PKNOTO   EQU   X'01'              CALLER A PROBLEM PROGRAM       E02669 27160002
DONTDEQ  EQU   X'02'              IF CALLER HOLDS ENQ            Y02651 27162002
SIXTEEN  EQU   X'16'              LENGTH OF CSCB (DW) FOR CMD     M5390 27170020
         EJECT                                                          27600002
         BALR  R3,0                                                     27800018
         USING *,R3                                                     28000018
         MODID BRANCH=YES                                        Y01886 28050001
         SPACE                                                          28200018
* BASE THE XSA AND TEST FOR CALLING ROUTINE HAVING SYSTEM        Y02669 28400002
* PROTECT KEY.                                                   Y02669 28600002
         SPACE                                                          28800018
RCORE    EQU   R10                                                      28900018
         SPACE                                                          29000018
         USING CVT,R8                                            Y02669 29100002
         L     R8,CVTPTR           ADDRESS CVT                          29200018
         L     RCORE,CVTMSER       ADDRESS MASTER RESIDENT CORE         29300018
         USING BASE,RCORE                                               29350002
         USING TRXSA,R9                                          Y02669 30400002
         LR    R9,R2               SAVE PTR TO XSA                20002 30440020
         MVI   XAE,X00             CLEAR FLAG(S) BYTE            Y02669 30450002
         EJECT                                                          30490002
*********************************************************************** 30530002
*                                                                       30532002
*     THE FOLLOWING BRANCH TABLE PROCESSES RETURN CODES FROM     Y02669 30540002
*     THE TESTAUTH MACRO ISSUED IN IEE0303D. THE RETURN CODES    Y02669 30550002
*     ARE EXPLAINED BELOW.                                       Y02669 30570002
*                                                                       30572002
*********************************************************************** 30580002
         ST    R14,XAP              SAVE RETURN ADDRESS REG      Y02669 30580402
         STM   R0,R1,XAX            SAVE INPUT REGISTERS         Y02669 30582002
         TESTAUTH KEY=YES           QUERY QEDIT/MGCR CALLER      Y02669 30590002
         LM    R0,R1,XAX            RESTORE INPUT REGISTERS      Y02669 30590402
*********************************************************************** 30590802
         B     TABLE(R15)           PROCESS RETURN CODE          Y02669 30592002
TABLE    EQU   *                                                        30594002
         B     PROCESS              R/C=0: SYSTEM KEY            Y02669 30596002
         B     TSTR1                R/C=4: PROBLEM PROGRAM KEY   Y02669 30598002
         B     ERRORHER             R/C=8: TESTAUTH CALLER ERROR Y02669 30598402
*********************************************************************** 30598502
*     ABOVE INSTRUCTION SEQUENCE DEPENDENT ON TESTAUTH RETURN    Y02669 30598602
*     CODES.                                                     Y02669 30598702
*********************************************************************** 30599102
*     THE FOLLOWING CODE VALIDITY CHECKS A P/P CALLER.           YM5130 30599502
*     IT WILL ALLOW A P/P TO SET A CIBCT TO ZERO, BUT            YM5130 30599902
*     WILL EDIT OUT AN INPUT OF ZEROES IN REG ONE AND            YM5130 30649902
*     IN REG ZERO PLUS AN INPUT OF FREEING THE CIB               YM5130 30659902
*     CHAIN ENTIRELY.                                            YM5130 30669902
*********************************************************************** 30679902
TSTR1    EQU   *                                                        30699902
         LTR   R1,R1               DELETE CIB OR UP CIB CT.       M5694 30820020
         BP    ERRORHER            ALLOW P/P TO SET CIBCOUNT     A56067 30830002
*                                  TO ZERO                       A56067 30880002
*                                  IF R1 IS ZERO, RO CANNOT BE   YM5130 30890002
*                                  ZERO OR POS. FOR P/P          YM5130 30892002
         BM    CONT                IF MINUS, BYPASS NEXT CHECK   YM5130 30900002
         LTR   R0,R0               INSURE R0 IS NEGATIVE.        YM5130 30900402
         BM    CONT                IF SO, CONTINUE               YM5130 30900802
         B     ERRORHER            IF NOT, SET BAD RET CODE      YM5130 30901202
CONT     EQU   *                                                 YM5130 30901602
         OI    XAE,PKNOTO          PREVENT ADDING A CIB          Y02669 30902002
         B     XCHAIN              CONTINUE                       M5694 30904020
PROCESS  EQU   *                                                   AAAA 31400018
         LTR   R1,R1               IF NEG, CHAIN MANIPULATION           33800018
         BM    XCHAIN                                                   34000018
         BP    TRBRANCH            IF POS.GO TO TRANSLATE CMD.   Y02669 34200002
*                                                                  CIB  34400018
* IF REG.1 IS ZERO,PROCESSING COULD EITHER BE FREEING OF CIB CHAIN CIB  34600018
* OR SETTING A MAX CIB COUNT OF ZERO IN CSCB.                      CIB  34800002
* TO DETERMINE FUNCTION REG.0 MUST BE EXAMINED                     CIB  35200018
*                                                                  CIB  35400018
         XR    R15,R15             INITIALLY SET NORMAL RETURN          35500018
         LTR   REG0,REG0                IF REG.0 IS NEGATIVE       CIB  35600018
         BM    XSETCNT1                    SET MAX CIB CNT OF ZERO CIB  35800002
         BP    XFREECHN                 IF POS., FREE CIB CHAIN    CIB  36000018
*                                                                  CIB  36200018
* IF NONE OF ABOVE CONDITIONS EXIST, BOTH REGS ARE ZERO            CIB  36400018
*                                                                  CIB  36600018
ERRORHER EQU   *                                                  20002 36610002
         LA    R15,8               P/P TRYING TO ISSUE CMD        M5694 36620002
         L     R14,XAP             RESTORE RETURN ADDRESS        Y02669 36630002
         BR    R14                 RETURN                          AAAA 36640002
TRBRANCH EQU   *                                                        38000002
         L     R15,VCON54          SET UP BRANCH TO IEE5403D     Y02669 38050002
         BR    R15                 GO TO TRANSLATE COMMAND       Y02669 38100002
         TITLE ' CHAIN MANIPULATION'                                    39200018
         SPACE                                                          39400018
REG0     EQU   R0                                                       39600018
REG1     EQU   R1                                                       39800018
RX       EQU   R4                                                       40000018
RV       EQU   R5                                                       40200018
F        EQU   X'FF'                                                    40600018
         SPACE                                                          40800018
XCHAIN   EQU  *                                                         41000018
         USING CHAIN,REG1                                               41900002
         LPR   REG1,REG1           MAKE REG1 POINTER POSITIVE           42800018
         LTR   REG0,REG0           TEST FOR CSCB PROCESSING    @YM08433 42802003
         BNZ   ISSUEENQ            IF NOT THEN ISSUE ENQ       @YM08433 42804003
         TM    CHSTS,CHABT         IS THIS AN ABTERM REQ       @YM07259 42807002
         BO    NOENQ               NO ENQ FOR ABTERM           @YM07259 42815003
ISSUEENQ EQU   *                                                        42842002
         BAL   R12,ENQRTN          GO TO ENQ ON CSCB RECOURSE    Y02651 42850002
NOENQ    EQU   *                                               @YM07259 42950003
         SR    R15,R15             INITIALLY SET NORMAL RETURN     CIB  43200018
*                                                                  CIB  43400018
         LTR   REG0,REG0           TEST FOR SETTING MAX CIB COUNT  CIB  43600018
         BM    XSETCNT             IF NEGATIVE,SET COUNT IN CSCB   CIB  43800018
         BZ    XCSCBCHN            IF ZERO,CSCB CHAIN PROCESSING   CIB  44000018
XCIBCHN  EQU   *                                                  20030 44180020
         BAL   R12,XCHKCSCB        VALIDITY CHECK ORIGIN ADDRESS   CIB  44200018
         BAL   R12,XFRST                INITIALIZE REGISTERS       CIB  44600018
         BAL   R12,XSCHN           ATTEMPT TO REMOVE FROM CHAIN    CIB  45000018
         BAL   R12,XCFC                 FREE CORE                  CIB  45200018
         B     XRSTECB                  TEST FOR EMPTY CIB CHAIN   CIB  45400018
XCSCBCHN LR    R0,RCORE                 SET ORIGIN POINTER         CIB  46000018
         BAL   R12,XFRST                INITIALIZE REGISTERS       CIB  46200018
         TM    CHSTS,CHABT             IS SVC 34 FOR ABTERM             46400018
         BO    XEOT                    YES. GO TO GO TO ABTERM          46600018
         TM    CHSTS,CHAD          ADDITION TO THE CHAIN                46800018
         BO    XCHAD                                                    47000018
         TM    CHSTS,CHDL+CHFC     IS THIS DELETE OR FREE BLOCK    CIB  47200018
         BZ    XENABLE                  IF NOT,ENABLE AND RETURN   CIB  47400018
         BAL   R12,XSCHN                REMOVE BLOCK IF IN CHAIN   CIB  47600018
XCHKFR   TM    CHSTS,CHFC               IS FREE BIT ON             CIB  47800018
         BZ    XENABLE                  IF NOT,ENABLE AND RETURN   CIB  48000018
         STM   R0,R1,XAX          SAVE REG PARMS AROUND POST     YM0402 48000102
*                                 PURGE OUTSTANDING POSTS        Y02651 48000402
         SPOST                                                          48002002
         LM    R0,R1,XAX          RESTORE REG INPUT PARMS        YM0402 48004002
         TM    CHSZE,SIXTEEN      DETERMINE IF CSCB FOR CMD       M5390 48010020
         BO    JUSTCSCB           YES- NO CIB TO FREE             M5390 48020020
         LR    R7,R1              SAVE CSCB PTR                   M4603 48030020
         L     R1,CHCIBP          PTR TO CIB                      M4603 48060020
         CL    R1,BLANK           CIB POINTER IN CSCB BLANK?     YM1157 48062001
         BE    FREECSCB           YES, FREE THE CSCB             YM1157 48064001
         LA    R1,D0(R1)          CLEAR HIGH ORDER BYTE           M1878 48070001
         LTR   R1,R1              CIB PTR IN CSCB ZERO            M4603 48090020
         BZ    FREECSCB           YES-FREE CSCB                   M4603 48120020
BACK     L     R8,0(R1)           SAVE PTR TO NEXT CIB            M4603 48210020
         LA    R8,D0(R8)          CLEAR HIGH ORDER BYTE           M1878 48220001
         BAL   R12,FREECIB        BRANCH TO FREE THIS CIB         M4603 48240020
         LTR   R1,R8              ANY MORE CIB'S                  M4603 48270020
         BP    BACK               YES-CONTINUE FREEING            M4603 48300020
FREECSCB LR    R1,R7              RESTORE CSCB PTR                M4603 48330020
JUSTCSCB BAL   R12,XCFC           FREE CSCB CORE                  M5390 48360020
         B     XENABLE                  ENABLE AND RETURN          CIB  48400018
*                                                                       48600018
         SPACE                                                          48800018
* ADD THE ELEMENT TO THE CHAIN                                          49000018
         SPACE                                                          49200018
XCHAD    EQU   *                                                        49400018
XCHNSC   EQU   *                                                        49600018
         LTR   RX,RX               IS THE CURRENT PTR = 0               49800018
         BZ    XCHND               IF SO, END OF CHAIN HAS BEEN REACHED 50000018
         LR    RV,RX               IF NOT, SAVE THAT POINTER            50200018
         L     RX,0(RX)            GET NEXT POINTER                     50400018
         B     XCHNSC              CONTINUE CHAIN SCAN                  50600018
XCHND    EQU   *                                                        50800018
         TM    XAE,PKNOTO          CHECK FOR PROTECT KEY NOT 0   Y02669 50880002
         BO    ERROROUT            ERROR IF KEY NOT 0            Y02651 50960002
         ST    REG1,0(RV)          INSERT ELEMENT PNTER IN CHAIN        51000018
         NI    CHSTS,F-CHAD        TURN OFF CHAIN ADDITION SWITCH       51200018
         ST    RX,CHPTR            STORE ZERO IN PTR OF ADDED ELEMENT   51400018
         CR    REG0,RCORE          IS ORIGIN CSCB CHAIN ORIGIN     CIB  51600018
         BNE   XENABLE             IF NOT,RETURN(ENABLE AND EXIT)  CIB  51800018
* DELETE THE ELEMENT FROM THE CHAIN                                     52800018
XSCHN    EQU   *                                                        53000018
         LTR   RX,RX                    END OF CHAIN OR CHAIN EMPTY     53200018
         BZ    XCHER                    CHECK FOR POSSIBLE ERROR        53400018
         CLR   REG1,RX                  IS THIS THE ELEMENT             53600018
         BE    XCHFND                   IF SO,REMOVE                    53800018
         LR    RV,RX                    IF NOT,SAVE POINTER             54000018
         L     RX,0(RX)                 GET NEXT POINTER                54200018
         B     XSCHN                    CONTINUE SCAN                   54400018
XCHFND   EQU   *                                                        54600018
         MVC   0(4,RV),CHPTR            REMOVE ELMT FROM CHAIN          54800018
         NI    CHSTS,F-CHDL             TURN OFF DELETION SWITCH        55000018
         BR    R12                      RETURN TO PROPER SECTION   CIB  55200018
*                                                                       55400018
XCFC     EQU   *                                                        55600018
         NI    CHSTS,F-CHFC             TURN OFF FREE SWITCH            55800018
         LR    RX,REG0                 SAVE ORIGIN PTR             CIB  56000018
FREECIB  SR    REG0,REG0                                          M4603 56200020
         IC    REG0,CHSZE               BLOCK SIZE IN DBL WORDS         56400018
         SLL   REG0,3                   CONVERT TO BYTES FOR FREEMAIN   56600018
         O     REG0,X245M               INSERT POOL NUMBER        20030 56800020
         FREEMAIN R,LV=(0),A=(1)                                        57000018
         LR    R0,RX                    RESTORE ORIGIN PTR         CIB  57200018
         SR    R15,R15             SET NORMAL RETURN              M3480 57300020
         BR    R12                      RETURN TO PROPER SECTION   CIB  57400018
*                                                                  CIB  57600018
XCHER    EQU   *                                                   CIB  57800018
         CR    REG0,RCORE               IS THIS CSCB               CIB  58000018
         BNE   XCHNDTST                 IF NOT,CAN BLOCK BE ADDED  CIB  58200018
*                                                                  CIB  58400018
         TM    CHSTS,CHDL               IS THIS DELETE BLOCK       CIB  58600018
         BZ    XCHKFR                   IF NOT,TEST FOR FREE CORE  CIB  58800018
         B     XERR                     SYSTEM ERROR               CIB  59000018
*                                                                       59200018
         EJECT                                                          59400018
*********************************************************************** 59600018
*                                                                     * 59800002
*              INTERNAL SUBROUTINES FOR CIB CHAIN MANIPULATION        * 60000018
*                                                                     * 60200018
*********************************************************************** 60400018
         SPACE 3                                                        60600018
*                                                                       60800018
* ROUTINE TO SET WORK REGS WITH ORIGIN AND BLOCK POINTERS               61000018
*                                                                       61200018
XFRST    EQU   *                                                   CIB  61400018
         LR    RV,R0                    MOVE ORIGIN POINTER        CIB  61600018
         L     RX,0(RV)                 GET FIRST BLOCK POINTER    CIB  61800018
         LA    RX,0(RX)                 CLEAR HIGH ORDER BYTE      CIB  62000018
         BR    R12                      RETURN                     CIB  62200018
         SPACE 3                                                   CIB  62400018
*                                                                 M4385 62470019
******************************************************************M4385 62540019
*                                                                 M4385 62610019
* THIS ROUTINE IS ENTERED TO CLEAR THE COMMUNICATIONS ECB WHEN    M4385 62680019
* THE CIB CHAIN IS EMPTY.                                        Y02669 62750002
*                                                                 M4385 63100019
******************************************************************M4385 63170019
*                                                                 M4385 63240019
XRSTECB  EQU   *                                                   CIB  63400018
         BAL   R12,XFRST                INITIALIZE REGISTERS       CIB  63600018
         LTR   RX,RX                    IS CHAIN EMPTY             CIB  63800018
         BNZ   XENABLE                  IF NOT,ENABLE AND RETURN   CIB  64000018
         SH    RV,FOUR                  SET POINTER TO ECB ADDRESS CIB  64200018
         L     RV,0(RV)                 GET ADDRESS OF ECB         CIB  64400018
         XC    0(4,RV),0(RV)            CLEAR COMMUNICATIONS ECB   CIB  64600018
         B     XENABLE                  ENABLE AND RETURN          CIB  64800018
         EJECT                                                    CIB   65000002
*********************************************************************** 65050002
*     AN EXCLUSIVE ENQ IS DONE ON THE CSCB RECOURSE IN THIS      Y02651 65060002
*     SUBROUTINE.  IT IS ENTERED FROM LABELS XCHAIN, XSETCNT1,   Y02651 65070002
*     AND XFREECHN.                                              Y02651 65080002
*********************************************************************** 65100002
ENQRTN   EQU   *                                                        65150002
         STM   R0,R1,XAX          SAVE REG PARMS AROUND ENQ      Y02651 65160002
         SYSEVENT DONTSWAP        MAKE MEMORY NON=SWAPPABLE      YM0405 65160402
         MVC   XASAVSTD(ENQLNG),ENQLIST                          Y02651 65162002
         LA    R1,XASAVSTD        LIST FORM OF MACRO             Y02651 65170002
         ENQ   ,MF=(E,(1))        ISSUE EXCLUSIVE ENQ            Y02651 65180002
         LTR   R15,R15            IS RETURN CODE ZERO?         @ZA08456 65180603
         BZ    RESTORE            CONTINUE IF YES              @ZA08456 65181003
         CLI   D3(R15),D8         RESOURCE ALREADY HELD?         Y02651 65182002
         BNE   RESTORE            CONTINUE IF NO                 Y02651 65184002
         OI    XAE,DONTDEQ        IF ENQ HELD, SET BIT TO        Y02651 65186002
*                                 BYPASS DEQ ROUTINE AT EXIT.    Y02651 65186402
RESTORE  EQU   *                                                 Y02651 65188002
         LM    R0,R1,XAX          RESTORE R1 PARMS               Y02651 65190002
         BR    R12                RETURN TO MAINLINE             Y02651 65192002
*                                                                  CIB  65200018
* ROUTINE TO FREE ALL CIB BLOCKS WHEN TASK TERMINATES              CIB  65400018
* ANY REMAINING CIB CORE IS FREED WHEN THE STARTED TASK TERMINATES CIB  65600018
*                                                                  CIB  65800018
XFREECHN EQU   *                                                   CIB  66000018
         BAL   R12,ENQRTN               GO ENQ ON CSCB RECOURSE  Y02651 66050002
         SR    R15,R15                  SET NORMAL RETURN CODE     CIB  66200018
         BAL   R12,XFRST                INITIALIZE REGISTERS       CIB  66400018
XTEST    LTR   REG1,RX                  END OF CIB CHAIN?          CIB  66600018
         BZ    XRSTECB                  IF YES,CLEAR ECB,RETURN    CIB  66800018
         BAL   R12,XSCHN                DELETE FROM CHAIN          CIB  67000018
         L     R2,0(REG1)               GET NEXT PTR. BEFORE FREE  CIB  67200018
         BAL   R12,XCFC                 FREE CORE OF CIB           CIB  67400018
         LR    RX,R2                    MOVE NEXT BLOCK POINTER    CIB  67600018
         B     XTEST                    CHECK POINTER              CIB  67800018
*                                                                  CIB  68000018
         SPACE 3                                                   CIB  68200018
*                                                                  CIB  68400018
* ROUTINE TO SET THE MAXIMUM CIB COUNT IN THE CSCB                 CIB  68600018
* THE COUNT IS INITIALLY SET TO ZERO BY L-SHAPE AND MAY BE CHANGED CIB  68800018
* BY AUTHORIZED PROGRAMS                                           CIB  69000018
*                                                                  CIB  69200018
XSETCNT1 EQU   *                                                        69250002
         BAL   R12,ENQRTN               GO ENQ ON CSCB RECOURSE  Y02651 69300002
XSETCNT  EQU   *                                                   CIB  69400018
         LPR   REG0,REG0                MAKE ORIGIN PTR.POSITIVE   CIB  69600018
         BAL   R12,XNOGCB               GO TO FIND CSCB            CIB  69800018
         DROP  REG1                                                CIB  70000018
         USING CHAIN,R2                                            CIB  70200018
         STC   REG1,CHCIBCTR            INSERT COUNT INTO CSCB     CIB  70400018
         DROP  R2                                                  CIB  70600018
         USING CHAIN,REG1                                          CIB  70800018
         B     XENABLE                  ENABLE AND RETURN          CIB  71000018
*                                                                  CIB  71200018
*                                                                  CIB  71400018
         SPACE 3                                                   CIB  71600018
*                                                                  CIB  71800018
* ROUTINE TO DETERMINE WHETHER OR NOT ANOTHER CIB MAY BE ADDED     CIB  72000018
* A STOP COMMAND IS ADDED AUTOMATICALLY * THE COUNT IS NOT CHECKED CIB  72200018
*                                                                  CIB  72400018
XCHNDTST EQU   *                                                   CIB  72600018
         DROP  REG1                                                CIB  72800018
         USING CIBD,REG1                                           CIB  73000018
         CLI   CIBVERB,CIBSTOP          IS THIS STOP COMMAND       CIB  73200018
         BE    XCHND                    IF YES, ADD COMMAND        CIB  73400018
         SR    R6,R6                    CLEAR COUNT REGISTER       CIB  73600018
         LR    R7,REG0                  MOVE ORIGIN POINTER        CIB  73800018
XTEST3   L     R7,0(R7)                 GET ADDRESS OF FIRST BLOCK CIB  74000018
         LA    R7,0(R7)                CLEAR HIGH ORDER BIT        CIB  74200018
         LTR   R7,R7                    IS PTR ZERO                CIB  74400018
         BZ    XENDCNT                  IF END OF CHAIN,CHECK COUNTCIB  74600018
         LA    R6,1(R6)                 INCR.CT.OF CIB'S ON CHAIN  CIB  74800018
         B     XTEST3                   CONTINUE SCAN              CIB  75000018
*                                                                  CIB  75200018
         DROP  R1                                                  CIB  75400018
         USING CHAIN,R2                                            CIB  75600018
XENDCNT  EQU   *                                                   CIB  75800018
         BAL   R12,XNOGCB               FIND CORRECT CSCB          CIB  76000018
         SR    R7,R7                    CLEAR COUNT REGISTER       CIB  76200018
         IC    R7,CHCIBCTR              GET MAX.COUNT FROM CSCB    CIB  76400018
         CR    R6,R7                    IS LIMIT EXCEEDED          CIB  76600018
         BL    XCHND                    IF NOT, ADD CIB            CIB  76800018
         LA    R15,8                    IF YES,REJECT COMMAND      CIB  77000018
         B     XENABLE                  ENABLE AND RETURN          CIB  77200018
         DROP  R2                                                  CIB  77400018
         SPACE 3                                                   CIB  77600018
*                                                                  CIB  77800018
* ROUTINE TO VALIDITY CHECK ORIGIN POINTERS                        CIB  78000018
* THE CHECK IS PERFORMED ONLY FOR CIB ORIGIN POINTER               CIB  78200018
*                                                                  CIB  78400018
XCHKCSCB EQU   *                                                   CIB  78600018
         USING CHAIN,R2                                            CIB  78800018
XNOGCB   L     R2,BACHN                 GET ADDRESS FIRST CSCB     CIB  80800018
XTEST2   LTR   R2,R2                    TEST FOR END OF CHAIN      CIB  81000018
         BZ    XERR                     IF NO CSCB FOUND,ERROR     CIB  81200018
         LA    R7,CHCIBP                GET ADDRESS CIB ORIGIN     CIB  81400018
         CR    REG0,R7                  IS THIS CORRECT CSCB       CIB  81600018
         BNE   XNEXT                    IF NOT,CONTINUE SCAN       CIB  81800018
         BR    R12                      IF YES,RETRN WITH CSCB PTR CIB  82000018
XNEXT    L     R2,CHPTR                 GET NEXT BLOCK ADDRESS     CIB  82200018
         B     XTEST2                   TEST FOR END OF CHAIN      CIB  82400018
         DROP  R2                                                  CIB  82600018
         USING CHAIN,REG1                                          CIB  82800018
ERROROUT EQU   *                                                        82850002
         LA    R15,D8             SET ERROR CODE OF EIGHT        Y02669 82900002
         B    XENABLE             GO TO DEQ AND RETURN           Y02669 82950002
XERR     EQU   *                                                   CIB  83400018
         LA    15,4                     SET ERROR CODE             CIB  83600018
XENABLE  EQU   *                                                        84000018
         TM    XAE,DONTDEQ        DID SVC34 CALLER DO ENQ?       Y02651 84010002
         BO    RETURN             IF YES, LET HIM DO DEQ.        Y02651 84020002
         ST    R15,XAD            SAVE RETURN CODES              Y02651 84050002
         MVC   XASAVSTD(DEQLNG),DEQLIST                          Y02651 84060002
         LA    R1,XASAVSTD        LIST FORM DEQ MACRO            Y02651 84100002
         DEQ   ,MF=(E,(1))        ISSUE DEQ FOR CSCB RECOURSE    Y02651 84150002
         SYSEVENT OKSWAP          MAKE MEMORY SWAPPABLE          Y02651 84160002
         L     R15,XAD            RESTORE RETURN CODES           Y02651 84200002
RETURN   EQU   *                                                 Y02651 84210002
         L     R14,XAP            RESTORE RETURN ADDRESS         Y02651 84250002
         BR    14                 RETURN TO SYSTEM               Y02651 85000002
         EJECT                                                          85400018
*********************************************************************** 86060002
*     THE FOLLOWING ROUTINE INVOKES ABTERM. IT IS ENTERED        Y02669 86062002
*     WHEN SVC34 IS CALLED BY A SYSTEM TASK WITH CHABT ON        Y02669 86064002
*     IN THE CSCB.  INPUT PARAMETERS CONSIST OF TWO WORDS        Y02669 86066002
*     POINTED TO NOW IN XAN. THEY ARE THE TCB OF THE TASK        Y02669 86068002
*     TO BE TERMINATED AND THE COMPLETION CODE. CURRENT          Y02669 86068402
*     KNOWN CALLER IS THE INITIATOR AFTER GETTING CONTROL        Y02669 86068802
*     FROM SVC34 WHEN A CANCEL COMMAND IS ISSUED.                Y02669 86069202
*     LOCAL LOCK IS OBTAINED AS REQUIRED BY CALLRTM MACRO WITH   Y02669 86070002
*     TYPE=ABTERM SPECIFIED.  LOCK IS RELEASD AT LABEL CLRLOCK.  Y02669 86080002
*********************************************************************** 86110002
XEOT     EQU   *                                                 Y02669 86120002
         TM    XAE,PKNOTO              SVC34 CALLED BY P/P?      Y02669 86122002
         BNO   NOABTERM                YES, SET BAD RETURN CODE  Y02669 86124002
         LA    R15,D8                  RC = 8 INTO REG 15      @YM07259 86125002
         B     RETURN                  RETURN TO CALLER        @YM07259 86126002
NOABTERM EQU   *                                               @YM07259 86127002
         NI    CHSTS,F-CHABTERM        NO, TURN OFF ABTERM BIT   Y02669 86130002
         LR    R8,R1                   SAVE R1 BEFORE LOCKING    Y02651 86160002
GETLOCK  EQU   *                                                        86210002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *86650002
               RELATED=(CALLRTM,IEE0303D(CLRLOCK))                      86650102
         L     R13,XAN                 GET  PTR TO ABTERM PRMS   Y02669 86652002
         LA    R13,D0(R13)             CLEAR HIGH ORDER BYTE     Y02669 86654002
         L     R11,D0(R13)             GET TCB PTR FOR MACRO     Y02669 86660002
         L     R5,D4(R13)              GET COMPLETION CODE       Y02669 86670002
         CLC   D4(D4,R13),DUMP         IS DUMP REQUESTED?        Y02669 86700002
         BNE   NODUMP                  NO, REQUEST NO DUMP.      Y02669 86750002
*********************************************************************** 86752002
*     GO TO ABTERM REQUESTING DUMP                               Y02669 86752402
*********************************************************************** 86754002
         CALLRTM TYPE=ABTERM,COMPCOD=(R5),TCB=(R11),DUMP=YES,STEP=YES   86760002
         B     CLRLOCK                 GO RELEASE LOCK           Y02651 86770002
*********************************************************************** 86772002
*     GO TO ABTERM REQUESTING NO DUMP                            Y02669 86774002
*********************************************************************** 86776002
NODUMP   EQU   *                                                 Y02669 86780002
         CALLRTM TYPE=ABTERM,COMPCOD=(R5),TCB=(R11),DUMP=NO,STEP=YES    86790002
CLRLOCK   EQU   *                                                Y02651 86840002
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(CALLRTM,IEE0303D(GETLOCK)) 86890002
         LR    R1,R8                   RESTORE REG 1                    88000018
         B     RETURN                 RETURN TO CALLER         @YM07259 88400002
         EJECT                                                          88600018
         DS    0F                                                       88800018
X245M    DC    X'F5000000'              SUBPOOL 245 MASK          20030 89000020
DUMP     DC    X'00000122'             DUMP COMPLETION CODE      Y02669 89050002
FOUR     DC    H'4'                                                     89200018
         DS    0F                                                       89203020
VCON54   DC    V(IEE5403D)        COMMAND PROCESSING MODULE      Y02669 89205002
BLANK    DC    X'40404040'        TEST ABSENCE OF CIB IN CSCB     M4603 89206020
         DS    0D                                                       89258402
ENQLIST  ENQ   (SYSNAME,RNAME,E,3,SYSTEM),RET=HAVE,MF=L          Y02651 89308402
ENQEND   EQU   *                  LABEL TO CALCULATE LENGTH      Y02651 89318402
         DS    0D                                                       89358402
DEQLIST  DEQ   (SYSNAME,RNAME,3,SYSTEM),RET=HAVE,MF=L            Y02651 89408402
DEQEND   EQU   *                  LABEL TO CALCULATE LENGTH      Y02651 89418402
ENQLNG   EQU   ENQEND-ENQLIST     LENGTH OF ENQLIST FOR MOVE     Y02651 89468402
DEQLNG   EQU   DEQEND-DEQLIST     LENGTH OF DEQLIST FOR MOVE     Y02651 89478402
         DS    0F                                                Y02651 89488402
SYSNAME  DC    C'SYSIEFSD'        MAJOR NAME                     Y02651 89508402
RNAME    DC    C'Q10'             MINOR NAME                     Y02651 89558402
         DS    0F                                              @ZA08456 89568403
PATCH    DC    CL50'***IEE0303D PATCH AREA***'                 @ZA08456 89578403
         END                                                            89600018
