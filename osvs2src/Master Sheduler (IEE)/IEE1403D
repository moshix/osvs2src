         TITLE 'HALT, SWITCH SYNTAX CHECK; TRACE PROCESSING'            00020002
*****************************************************************Y02669 00070002
*                                                                Y02669 00120002
*  MODULE NAME =  IEE1403D                                       Y02669 00130002
*                                                                Y02669 00132002
*  DESCRIPTIVE NAME =  HALT/ SWITCH SYNTAX CHECKER; TRACE      @Y02669P 00134002
*                      PROCESSOR                               @Y02669P 00135002
*                                                                Y02669 00136002
*  COPYRIGHT =                                                   Y02669 00138002
*                                                                Y02669 00138402
*  STATUS =  OS/VS2 - RELEASE 3                                @Y30LPSV 00138803
*                                                                Y02669 00139202
*  FUNCTION =                                                    Y02669 00139602
*              THIS MODULE SYNTAX CHECKS THE HALT (Z) AND        Y02669 00139702
*              SWITCH (I) COMMANDS, AND EXECUTES THE TRACE     @Y02669P 00139802
*              COMMAND.                                        @Y02669P 00139902
*                                                                Y02669 00149902
*     OPERATION =                                                Y02669 00159902
*              A. PERFORMS VALIDITY CHECKING OF THE EOD OPERAND TO    * 00180000
*                 ASCERTAIN WHETHER THE OPERAND OF HALT IS NULL OR    * 00200000
*                 MISPELLED.                                          * 00220000
*                                                                     * 00240000
*              B. IF THE OPERAND IS NULL, CONTROL PASSES TO THE  Y02669 00260002
*                 APPROPRIATE ERROR ERROR EXIT TO SET UP THE     Y02669 00262002
*                 INTERFACE TO THE MESSAGE MODULE (IEE0503D)     Y02669 00264002
*                 TO ISSUE MESSAGE IEE311I.                      Y02669 00266002
*                                                                     * 00340000
*              C. IF THE OPERAND WAS MISSPELLED, CONTROL PASSES  Y02669 00360002
*                 TO THE APPROPRIATE ERROR ERROR EXIT TO SET UP  Y02669 00362002
*                 THE INTERFACE TO THE MESSAGE MODULE (IEE0503D) Y02669 00364002
*                 TO ISSUE MESSAGE IEE309I.                      Y02669 00366002
*                                                                     * 00440000
*                 (IF THE OPERAND BEGINS WITH 'TP,' OR 'TP',      20002 00444002
*                 THIS MODULE BRANCHES TO IED1303D FOR TCAM      Y02669 00448002
*                 PROCESSING)                                     20002 00452020
*                                                                 20002 00456020
*                 (IF THE OPERAND BEGINS WITH 'NET,'  OR 'NET ', Y02674 00466002
*                 THIS MODULE BRANCHES TO ISTCFF3D FOR VTAM      Y02674 00476002
*                 PROCESSING)                                    Y02674 00486002
*                                                                Y02669 00496002
*              D. IF THE OPERAND IS 'SMF' OR 'EOD', CONTROL      Y02669 00506002
*                 PASSES TO IEE0803D TO BUILD A CSCB.            Y02669 00515602
*                 THIS IS TO AVOID PROCESSING HALT/SWITCH CMDS     R271 00518001
*                 UNDER THE COMMUNICATIONS TASK.                   R271 00518401
*                                                                     * 00520000
*              E. IF THE OPERAND ON TRACE IS 'ON', BIT BATRACE @Y02669P 00523002
*                 IS SET 'ON', AND THE INTERFACE TO THE        @Y02669P 00526002
*                 MESSAGE MODULE (IEE0503D) IS SET UP TO ISSUE @Y02669P 00529002
*                 MESSAGE IEE712I.                             @Y02669P 00532002
*                                                              @Y02669P 00535002
*                 IF THE OPERAND ON TRACE IS 'OFF', BIT        @Y02669P 00538002
*                 BATRACE IS SET 'OFF', AND THE MESSAGE        @Y02669P 00541002
*                 INTERFACE IS AGAIN SET FOR MESSAGE IEE712I.  @Y02669P 00544002
*                                                              @Y02669P 00547002
*                 IF THE OPERAND ON TRACE IS 'STATUS' OR       @Y02669P 00550002
*                 NULL, CVTTRACE IS TESTED.                    @Y02669P 00576002
*                 IF THE FIELD CONTAINS X'07FB', INDICATING    @Y02669P 00579002
*                 THAT THE SYSTEM TRACE IS INACTIVE, THE       @Y02669P 00582002
*                 MESSAGE INTERFACE IS AGAIN SET FOR MESSAGE   @Y02669P 00585002
*                 IEE341I.  OTHERWISE, THE SYSTEM TRACE IS     @Y02669P 00588002
*                 ACTIVE, AND THE MESSAGE INTERFACE IS         @Y02669P 00591002
*                 SET FOR MESSAGE IEE382I.                     @Y02669P 00594002
*                                                              @Y02669P 00597002
*                 IF NONE OF THE ABOVE OPERANDS IS PRESENT,    @Y02669P 00600002
*                 THE MESSAGE INTERFACE IS SET FOR MESSAGE     @Y02669P 00603002
*                 IEE535I.                                     @Y02669P 00606002
*                                                              @Y30LPSV 00607003
*              F. IF THE OPERAND ON HALT IS 'DINIT','LONG',    @Y30LPSV 00608003
*                 OR 'SNAP' THE INTERFACE TO THE MESSAGE       @Y30LPSV 00609003
*                 MODULE IS SET UP TO ISSUE MESSAGE IEE084I.   @Y30LPSV 00610003
*                                                              @Y30LPSV 00611003
*                 IF THE OPERAND BEGINS WITH 'S,', THIS MODULE @Y30LPSV 00612003
*                 BRANCHES TO IEE9403D FOR SS/1 PROCESSING.    @Y30LPSV 00616003
*                                                                     * 00620002
*  NOTES =                                                       Y02669 00624002
*                                                              @Y02669P 00628002
*           TO BE EFFECTIVE, 'TRACE ON' AND 'TRACE OFF'        @Y02669P 00632002
*           MUST BE ISSUED BEFORE THE SYSTEM TRACE IS          @Y02669P 00636002
*           TERMINATED BY IEEVWAIT, WHEN INITIALIZATION        @Y02669P 00640002
*           OF THE PRIMARY JOB ENTRY SUBSYSTEM IS COMPLETE.    @Y02669P 00644002
*                                                              @Y02669P 00648002
*           TRACE IS INVALID IN THE INPUT STREAM.              @Y30LPSV 00652003
*                                                              @Y02669P 00656002
*     CHARACTER CODE DEPENDENCIES =  THIS MODULE HAS BEEN WRITTENY02669 00660002
*                                    IN SUCH A WAY THAT, IF THE  Y02669 00670002
*                                    CHARACTER CODE IS CHANGED   Y02669 00720002
*                                    FROM EBCDIC, REASSEMBLY WILLY02669 00770002
*                                    YIELD A VALID MODULE.       Y02669 00820002
*                                                                     * 00870002
*     DEPENDENCIES =                                             Y02669 00920002
*                                                                     * 00970002
*     RESTRICTIONS =  THIS MODULE EXPECTS REGISTER TWO TO POINT  Y02669 01020002
*                     AN EXTENDED SAVE AREA (XSA), AND         @Y02669P 01070002
*                     REGISTER TEN TO POINT TO MASTER          @Y02669P 01100002
*                     RESIDENT DATA AREA(BASEA).               @Y02669P 01130002
*                                                                     * 01160002
*     REGISTER CONVENTIONS =                                     Y02669 01220002
*                   REGISTER 2     ADDRESS OF XSA                Y02669 01270002
*                   REGISTER 5     ADDRESS OF CVT              @Y02669P 01320002
*                   REGISTER 7     ADDRESS OF TRACE TABLE      @Y02669P 01340002
*                   REGISTER 8     MESSAGE CODE                  Y02669 01370002
*                   REGISTER 9     EXIT BRANCH ADDRESS           Y02669 01372002
*                   REGISTER 10    ADDRESS OF BASEA            @Y02669P 01392002
*                   REGISTER 11    ADDRESS OF COMMAND OPERAND    Y02669 01420002
*                   REGISTER 12    MODULE BASE                   Y02669 01470002
*                   REGISTER 15    RETURN CODE                   Y02669 01472002
*                                                                     * 01474002
*     PATCH-LABEL =  PATCH                                       Y02669 01476002
*                                                                     * 01478002
*  MODULE-TYPE =  CSECT                                          Y02669 01478402
*                                                                       01478802
*     PROCESSOR =  ASSEMBLER                                     Y02669 01479202
*                                                                       01479602
*     MODULE-SIZE =  APPROXIMATELY X'200'                      @Y30LPSV 01479703
*                                                                       01479902
*     ATTRIBUTES =                                               Y02669 01480002
*                  PAGED LPA                REENTRANT            Y02669 01480402
*                  ZERO PSW PROTECT KEY     REUSABLE             Y02669 01480502
*                  SUPERVISOR MODE          REFRESHABLE          Y02669 01480602
*                                                                       01480702
*  ENTRY POINT =  IEE1403D, FROM IEE0403D                        Y02669 01480802
*                                                                       01481302
*     PURPOSE =  TO SYNTAX CHECK THE HALT AND SWITCH COMMANDS    Y02669 01481402
*                AND PROCESS THE TRACE COMMAND                 @Y02669P 01481502
*                                                                       01481602
*     LINKAGE =  VIA BRANCH FROM IEE0403D                        Y02669 01481802
*                                                                       01481902
*     INPUT DATA =  REGISTER TWO CONTAINS THE ADDRESS OF AN XSA  Y02669 01482002
*                   INITIALIZED AS FOLLOWS:                      Y02669 01482102
*                                                                       01482202
*                   XAN       VERB CODE (HALT, SWITCH OR TRACE)@Y02669P 01482302
*                   XAL       ADDRESS OF COMMAND OPERAND         Y02669 01482402
*                   REGISTER TEN CONTAINS THE ADDRESS OF BASEA @Y02669P 01482502
*                                                                       01482802
*     REGISTERS SAVED =  NONE                                    Y02669 01483202
*                                                                       01483702
*     REGISTER CONTENTS DURING PROCESSING =  SEE REGISTER CON-   Y02669 01484202
*                                            VENTIONS            Y02669 01484702
*                                                                       01485202
*     REGISTERS RESTORED =  NONE                                 Y02669 01485302
*                                                                       01485402
*  EXIT-NORMAL =  MSGBRCH                                      @Y02669P 01485502
*                                                                       01485602
*     CONDITIONS =  OPERAND ON TRACE WAS 'ON' OR 'OFF'         @Y02669P 01485702
*                                                                       01485802
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING: @Y02669P 01485903
*                    XAE      MESSAGE CODE X'03'               @Y02669P 01487902
*                    XAV      COMMAND VERB                     @Y02669P 01488302
*                    ***      OTHER FIELDS ARE UNCHANGED       @Y02669P 01488702
*                                                                       01489102
*     RETURN CODES =  ZERO                                     @Y02669P 01489502
*                                                                       01489902
*  EXIT-NORMAL = CSCBBRCH                                        Y02669 01490302
*                                                                       01490702
*     CONDITIONS =  COMMAND IS 'HALT EOD' OR 'SWITCH SMF'        Y02669 01491102
*                   EXIT TO CSCB CREATION MODULE (IEE0803D) VIA  Y02669 01491502
*                   BRANCH ON VCON.                              Y02669 01491902
*                                                                       01492302
*  OUTPUT DATA =  REGISTER TWO POINTS TO THE XSA CONTAINING:     Y02669 01492702
*                 XAV   COMMAND VERB                             Y02669 01493102
*                 OTHER FIELDS ARE UNCHANGED                     Y02669 01493502
*                                                                       01493902
*     RETURN CODES =  NONE                                       Y02669 01494302
*                                                                       01495202
*  EXIT-NORMAL =  TPBRCH                                         Y02669 01495302
*                                                                       01495402
*     CONDITIONS =  OPERAND ON HALT WAS 'TP ' OR 'TP,'           Y02669 01495502
*                   EXIT TO TCAM PROCESSOR (IED1303D) VIA BRANCH Y02669 01495602
*                   ON VCON.                                     Y02669 01495802
*                                                                       01496002
*     OUTPUT DATA =  SAME AS EXIT CSCBBRCH                       Y02669 01496202
*                                                                       01496402
*     RETURN CODES =  NONE                                       Y02669 01496602
*                                                                       01496802
*  EXIT-NORMAL =  NETBRCH                                        Y02674 01497002
*                                                                       01497102
*     CONDITIONS =  OPERAND ON HALT WAS 'NET ' OR 'NET,'         Y02674 01497302
*                   EXIT TO VTAM PROCESSOR (ISTCFF3D) VIA        Y02674 01497502
*                   BRANCH ON VCON.                              Y02674 01497802
*                                                                       01498002
*     OUTPUT DATA =  SAME AS EXIT CSCBBRCH                       Y02669 01498202
*                                                                       01498402
*     RETURN CODES =  NONE                                       Y02669 01498602
*                                                                       01498802
*  EXIT-NORMAL = SS1BRCH                                       @Y30LPSV 01498903
*                                                                       01500103
*     CONDITIONS = OPERAND ON HALT WAS 'S,LONG' OR             @Y30LPSV 01500803
*                  'S,SNAP'. EXIT TO SS/1 PROCESSOR (IEE9403D) @Y30LPSV 01501203
*                  VIA BRANCH ON VCON.                         @Y30LPSV 01501603
*                                                                       01501703
*     OUTPUT DATA = SAME AS EXIT CSCBBRCH                      @Y30LPSV 01501803
*                                                                       01501903
*  EXIT-NORMAL =  MSGBRCH                                      @Y02669P 01502003
*                                                                       01502203
*     CONDITIONS = OPERAND ON TRACE WAS 'STATUS' OR NULL, AND  @Y02669P 01503403
*                  SYSTEM TRACING WAS IN EFFECT                @Y02669P 01504603
*                                                                       01505603
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING  @Y02669P 01506603
*                    XAE      MESSAGE CODE X'34'               @Y02669P 01508203
*                    XAV      COMMAND VERB                     @Y02669P 01509403
*                    ***      OTHER FIELDS ARE UNCHANGED       @Y02669P 01510603
*                                                                       01512603
*     RETURN CODES =  ZERO                                     @Y02669P 01513003
*                                                                       01515003
*  EXIT-NORMAL =  MSGBRCH                                      @Y02669P 01516003
*                                                                       01517003
*     CONDITIONS =  OPERAND ON TRACE WAS 'STATUS' OR NULL,     @Y02669P 01518203
*                   AND SYSTEM TRACING WAS NOT ACTIVE.         @Y02669P 01520003
*                                                                       01520903
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING  @Y02669P 01521803
*                    XAE      MESSAGE CODE X'24'               @Y02669P 01523603
*                    XAV      COMMAND VERB                     @Y02669P 01524503
*                    ***      OTHER FIELDS ARE UNCHANGED       @Y02669P 01525403
*                                                                       01527202
*     RETURN CODES =  ZERO                                     @Y02669P 01528103
*                                                                       01529003
*  EXIT-ERROR =  MSGBRCH                                         Y02669 01530803
*                                                                       01531803
*     CONDITIONS = MISSING OPERAND ON HALT OR SWITCH.          @Y02669P 01533003
*                  EXIT TO MESSAGE MODULE (IEE0503D) VIA         Y02669 01534003
*                  BRANCH ON VCON TO ISSUE MESSAGE IEE311I.      Y02669 01535003
*                                                                       01536003
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 01538003
*                    XAE      MESSAGE CODE X'0B'                 Y02669 01539003
*                    XAV      COMMAND VERB                       Y02669 01540003
*                    ***      OTHER FIELDS ARE UNCHANGED         Y02669 01541003
*                                                                       01542003
*     RETURN CODES =  FOUR.                                      Y02669 01544003
*                                                                       01545003
*  EXIT-ERROR =  MSGBRCH                                         Y02669 01546003
*                                                                       01547003
*     CONDITIONS = OPERAND NEITHER 'SMF' FOR SWITCH NOR 'EOD',   Y02669 01548003
*                  'TP ', 'TP,', 'NET ', OR 'NET,' FOR HALT.     Y02669 01550003
*                  EXIT TO MESSAGE MODULE (IEE0503D) VIA         Y02669 01551003
*                  BRANCH ON VCON TO ISSUE MESSAGE IEE309I.      Y02669 01552003
*                                                                       01553003
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 01554003
*                    XAE      MESSAGE CODE X'09'                 Y02669 01555003
*                    XAV      COMMAND VERB                       Y02669 01556003
*                    ***      OTHER FIELDS ARE UNCHANGED         Y02669 01557003
*                                                                       01558003
*     RETURN CODES =  FOUR.                                      Y02669 01560003
*                                                                       01562002
*  EXIT-ERROR =  MSGBRCH                                       @Y02669P 01563003
*                                                                       01564003
*     CONDITIONS =  OPERAND ON TRACE WAS NOT AMONG 'ON',       @Y02669P 01565003
*                   'OFF', 'STATUS' AND NULL.                  @Y02669P 01566003
*                                                                       01568003
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING  @Y02669P 01569003
*                    XAE      MESSAGE CODE X'3E'               @Y02669P 01570003
*                    XAV      COMMAND VERB                     @Y02669P 01571003
*                    ***      OTHER FIELDS ARE UNCHANGED       @Y02669P 01572003
*                                                                       01574003
*     RETURN CODES =  FOUR                                     @Y02669P 01575003
*                                                                       01575503
*  EXIT-ERROR = MSGBRCH                                        @Y30LPSV 01576003
*                                                                       01576103
*     CONDITIONS = OPERAND ON HALT WAS EITHER 'LONG'           @Y30LPSV 01576203
*                  OR 'SNAP'. EXIT TO MESSAGE MODULE           @Y30LPSV 01576303
*                  (IEE0503D) TO ISSUE MESSAGE IEE084I.        @Y30LPSV 01576403
*                                                                       01576503
*     OUTPUT DATA = REGISTER TWO POINTS TO AN XSA CONTAINING   @Y30LPSV 01577003
*                   XAE      MESSAGE CODE X'19'                @Y30LPSV 01577203
*                   XAV      COMMAND VERBS                     @Y30LPSV 01577403
*                   ***      OTHER FIELDS ARE UNCHANGED        @Y30LPSV 01577603
*                                                                       01577803
*     RETURN CODES = FOUR                                      @Y30LPSV 01578003
*                                                                       01578303
*  EXTERNAL REFERENCES =                                         Y02669 01578603
*                                                                       01579003
*     ROUTINES = IEE0503D - TO ISSUE MESSAGES, VIA BRANCH        Y02669 01580003
*                IEE0803D - TO BUILD CSCB, VIA BRANCH            Y02669 01581003
*                IED1303D - TO PROCESS TCAM COMMANDS, VIA BRANCH Y02669 01582003
*                ISTCFF3D - TO PROCESS VTAM COMMANDS, VIA BRANCH Y02674 01583003
*                IEE9403D - TO PROCESS SS/1 COMMANDS, VIA BRCH @Y30LPSV 01584003
*                                                                       01584503
*     DATA AREAS =  NONE                                         Y02669 01586003
*                                                                       01587003
*     CONTROL BLOCKS =  XSA, CVT, BASEA                        @Y02669P 01588003
*                                                                       01589003
*     TABLES =  NONE                                             Y02669 01590803
*                                                                       01591603
*     MACROS =  MODID, IEEXSA, CVT, IEEBASEA                   @Y02669P 01593203
*                                                                       01594003
*     CHANGE LEVEL =  Y02669, Y02674, @Y30LPSV                 @Y30LPSV 01595603
*                                                                       01596303
*  MESSAGES =                                                    Y02669 01598003
*            CODE                         TEXT                   Y02669 01599003
*            X'09'       IEE309I  (VERB)  UNIDENTIFIABLE KEYWORD Y02669 01600003
*            X'0B'       IEE311I  (VERB)  PARAMETER MISSING      Y02669 01601003
*            X'24'       IEE341I  (VERB)  NOT ACTIVE           @Y02669P 01602003
*            X'34'       IEE382I  (VERB)  CURRENTLY ACTIVE     @Y02669P 01603003
*            X'3E'       IEE535I  (VERB)  INVALID PARAMETER    @Y02669P 01605003
*            X'03'       IEE712I  (VERB)  PROCESSING COMPLETE  @Y02669P 01606003
*            X'19'       IEE084I  (VERB)  SS/1 PARAMETER       @Y30LPSV 01606703
*                                         MISSING              @Y30LPSV 01607403
*                                                                       01608103
*            ALL MESSAGES CONTAINED IN AND ISSUED BY IEE0503D.   Y02669 01608803
*                                                                       01609503
*  SYSGEN =  THIS MODULE IS IN LOAD MODULE IGC0003D IN           Y02669 01610503
*            SYS1.LPALIB.  IT IS INCLUDED AT SYSGEN FROM DLIB    Y02669 01611503
*            AOSB3 BY SYSGEN MACRO SGIEF441.                     Y02669 01612503
*                                                                       01613503
*  SYSTEM LIBRARIES =  THIS MODULE MAKES REFERENCE TO NO SYSTEM  Y02669 01614503
*                      LIBRARIES.                                Y02669 01615503
*                                                                       01616503
*********************************************************************** 01617503
         EJECT                                                          01620003
*********************************************************************** 01622003
*   SYNTAX =                                                            01623003
*             ************                                              01624003
*             *  ON      *                                              01625003
*      TRACE  *  OFF     *     TRACE CANNOT BE ABBREVIATED; STATUS      01626003
*             *  STATUS  *     IS THE DEFAULT                           01627003
*             ************                                              01628003
*                                                                       01629003
***************************************************************@Y02669P 01630003
         EJECT                                                          01631003
* REGISTERS USED                                                        01632003
PARREG    EQU  2                       USED FOR ADDRESSABILITY TO XSA   01633003
R5       EQU   5                       REG POINTS CVT          @Y02669P 01634003
WKREG    EQU   8                       CODE REGISTER                    01635003
BRCHREG  EQU   9                       EXIT BRANCH REGISTER      Y02669 01636003
LISTREG  EQU   11                      REG POINTS TO EOD OPERAND        01640000
R10      EQU   10                      BASEA ADDRESS REGISTER  @Y02669P 01660002
BASEREG  EQU   12                      BASE   REGISTER                  01700000
RETCDREG EQU   15                      RETURN CODE REGISTER      Y02669 01702002
E0       EQU   0                                                  20002 01740901
E1       EQU   1                       *                       @Y02669P 01741902
E2       EQU   2                       *                       @Y30LPSV 01742903
E3       EQU   3                                                  20002 01744101
E4       EQU   4                                                 Y02669 01744502
E5       EQU   5                       *                       @Y30LPSV 01744703
E6       EQU   6                       *                       @Y30LPSV 01744903
E7       EQU   7                       *                       @Y02669P 01745102
E8       EQU   8                                                  20002 01745701
SWITCHCD EQU   52                      SWITCH VERB CODE        @Y02669P 01748702
TRACECD  EQU   20                      TRACE VERB CODE         @Y02669P 01751702
HALTCD   EQU   60                      HALT VERB CODE          @Y02669P 01756902
FOUR     EQU   4                       COMMAND NOT EXECUTED      Y02669 01758902
*                                      RETURN CODE               Y02669 01759402
XFF      EQU   255                     MASK FOR TURNING OFF    @Y02669P 01759902
*                                      BITS                    @Y02669P 01760402
IEE084I  EQU   X'19'                ERROR CODE- MESSAGE MODULE @Y30LPSV 01767803
*                                   C'SS/1 PARAMETER MISSING'  @Y30LPSV 01767903
*                                                                       01768003
IEE309I  EQU   X'09'                   ERROR CODE- MESSAGE MODULE       01774003
*                                      C'UNIDENTIFIABLE KEYWORD.'Y02669 01775003
*                                                              @Y30LPSV 01776003
IEE311I  EQU   X'0B'                   ERROR CODE- MESSAGE MODULEY02669 01779303
*                                      C' PARAMETER MISSING.'    Y02669 01781303
*                                                                       01784003
IEE341I  EQU   X'24'                   ERROR CODE- MSG MODULE  @Y02669P 01786003
*                                      C' NOT ACTIVE '         @Y02669P 01788703
*                                                                       01790703
IEE382I  EQU   X'34'                   ERROR CODE- MSG MODULE  @Y02669P 01792703
*                                      C' CURRENTLY ACTIVE '   @Y02669P 01793703
*                                                                       01794703
IEE535I  EQU   X'3E'                   ERROR CODE- MSG MODULE  @Y02669P 01798103
*                                      C' INVALID PARAMETER '  @Y02669P 01800103
*                                                                       01802803
IEE712I  EQU   X'03'                   ERROR CODE- MSG MODULE  @Y02669P 01803803
*                                      C' PROCESSING COMPLETE '@Y02669P 01804803
*                                                                       01807503
         EJECT                                                          01809503
IEE1403D CSECT                                                   Y02669 01812203
         BALR  BASEREG,0               ESTABLISH ADDRESSIBILITY FOR     01814203
         USING *,BASEREG               MODULE                    Y02669 01816903
         MODID BRANCH=YES                                        Y02669 01817903
         USING EXSAVSEC,PARREG         SET ADDRESSIBILITY FOR ESA       01818903
*                                                                       01821603
         L     LISTREG,XAL             LOAD POINTER TO OPERAND          01823603
*                                                                       01826303
         LA    LISTREG,0(LISTREG)      GET ADDR OF OPERAND              01828303
*                                                                       01831003
         LA    WKREG,IEE311I           SET FOR MSG IEE311I       Y02669 01835703
         CLI   XAN,SWITCHCD            ENTRY FOR SWITCH?       @Y02669P 01836702
         BE    SWITCH                  YES, BRANCH TO SWITCH   @Y02669P 01837302
*                                      CODE                    @Y02669P 01837903
         CLI   XAN,TRACECD             ENTRY FOR TRACE?        @Y02669P 01839403
         BE    TRACE                   YES, BRANCH TO TRACE    @Y02669P 01841703
*                                      CODE                    @Y02669P 01843503
*                                                                       01845503
*        OTHERWISE, ENTRY IS FOR HALT                          @Y02669P 01847503
*                                                                       01849503
         EJECT                                                          01851503
***************************************************************@Y02669P 01853503
*                                                              @Y02669P 01855503
* ENTRY WAS MADE FOR A HALT COMMAND                            @Y02669P 01859202
*                                                              @Y02669P 01862202
***************************************************************@Y02669P 01865202
         SPACE 2                                                        01868602
         MVC   XAV(E8),AHALT           MOVE HALT VERB TO XSA   @Y02669P 01920302
*                                      FOR MSG                 @Y02669P 01929702
         LTR   LISTREG,LISTREG         OPERAND NULL?           @Y02669P 01934402
         BZ    MSGBRCH                 YES, BRANCH FOR MSG     @Y02669P 01939102
*                                      IEE311I                 @Y02669P 01948502
         SPACE 2                                                        01954502
*                                                                       01960502
*        TEST FOR TCAM OPERANDS                                  Y02669 01966502
*                                                                       01972502
         SPACE                                                          01978502
         CLC   E0(E3,LISTREG),TPCOMMA  Q. 'TP,'                  Y02669 01984502
         BE    TPBRCH                  YES, BRANCH TO 1303D      Y02669 01990502
         CLC   E0(E3,LISTREG),TPBLANK  Q. 'TP '                  Y02669 01996502
         BE    TPBRCH                  YES, BRANCH TO 1303D      Y02669 02002502
           SPACE                                                        02008502
*                                                                       02014502
*        TEST FOR VTAM OPERANDS                                  Y02674 02020502
*                                                                       02026502
         SPACE                                                          02032502
         CLC   E0(E4,LISTREG),NETCOMMA Q. 'NET,'                 Y02674 02038502
         BE    NETBRCH                 YES, BRANCH TO ISTCFF3D   Y02674 02044502
         CLC   E0(E4,LISTREG),NETBLANK Q. 'NET '                 Y02674 02050502
         BE    NETBRCH                 YES, BRANCH TO ISTCFF3D   Y02674 02056502
         SPACE 1                                               @Y30LPSV 02057103
*                                                              @Y30LPSV 02057703
*        TEST FOR SS/1 OPERANDS                                @Y30LPSV 02058303
*                                                              @Y30LPSV 02058903
         SPACE 1                                               @Y30LPSV 02059503
         CLC   E0(E2,LISTREG),S        Q. 'S,'                 @Y30LPSV 02060103
         BE    SS1BRCH                 YES, BRANCH TO IEE9403D @Y30LPSV 02060703
         LA    WKREG,IEE084I           SET UP FOR ERROR MSG    @Y30LPSV 02061303
         CLC   E0(E5,LISTREG),LONG     Q. 'LONG'               @Y30LPSV 02068503
         BE    MSGBRCH                 YES,TAKE ERROR MSG EXIT @Y30LPSV 02070503
         CLC   E0(E5,LISTREG),SNAP     Q. 'SNAP'               @Y30LPSV 02072503
         BE    MSGBRCH                 YES,TAKE ERROR MSG EXIT @Y30LPSV 02074503
         EJECT                                                 @Y30LPSV 02076503
*                                                              @Y30LPSV 02078503
*        TEST FOR END OF DAY                                   @Y30LPSV 02080503
*                                                              @Y30LPSV 02081503
         SPACE 1                                               @Y30LPSV 02082503
         CLC   E0(E4,LISTREG),AEOD     OPERAND = EOD?            Y02669 02083503
         BE    CSCBBRCH                YES- GO TO IEE0803D       Y02669 02084503
ERROR    LA    WKREG,IEE309I           SET UP FOR ERROR          A40296 02086503
         B     MSGBRCH                 TAKE ERROR EXIT           A40296 02089503
          EJECT                                                         02092503
***************************************************************@Y02669P 02098503
*                                                                A40296 02104503
* ENTRY WAS MADE FOR A SWITCH COMMAND                            A40296 02110503
*                                                                A40296 02116503
***************************************************************@Y02669P 02122503
          SPACE 2                                                       02128503
SWITCH   MVC   XAV(E8),ASWITCH         MOVE SWITCH VERB TO     @Y02669P 02134503
*                                      XSA FOR MSG             @Y02669P 02140503
         LTR   LISTREG,LISTREG         OPERAND NULL?           @Y02669P 02146503
         BZ    MSGBRCH                 YES, BRANCH FOR MSG     @Y02669P 02152503
*                                      IEE311I                 @Y02669P 02158503
         CLC   E0(E4,LISTREG),ASMF     OPERAND = SMF?            Y02669 02167503
         BNE   ERROR                   NO - BAD OPERAND          A40296 02170503
         B     CSCBBRCH                YES - GOTO IEE0803D     @Y02669P 02176503
       EJECT                                                            02182503
***************************************************************@Y02669P 02188503
*                                                              @Y02669P 02194503
* ENTRY WAS MADE FOR A TRACE COMMAND                           @Y02669P 02200503
*                                                              @Y02669P 02206503
***************************************************************@Y02669P 02212503
        SPACE 2                                                         02218503
TRACE    MVC   XAV(E8),ATRACE          MOVE TRACE VERB TO XSA  @Y02669P 02224503
*                                      FOR MSG                 @Y02669P 02230503
         LTR   LISTREG,LISTREG         OPERAND NULL?           @Y02669P 02236503
         BZ    TRACESTS                YES, DO STATUS          @Y02669P 02242503
*                                      PROCESSING              @Y02669P 02248503
         USING BASE,R10                BASEA ADDRESSABILITY    @Y02669P 02254502
         LA    WKREG,IEE712I           SET UP FOR MSG IEE712I; @Y02669P 02260502
*                                      USED FOR BOTH ON AND OFF@Y02669P 02266502
         CLC   E0(E3,LISTREG),ON       TRACE ON?               @Y02669P 02272502
         BE    TRACEON                 YES, DO ON PROCESSING   @Y02669P 02278502
         CLC   E0(E4,LISTREG),OFF      TRACE OFF?              @Y02669P 02284502
         BE    TRACEOFF                YES, DO OFF PROCESSING  @Y02669P 02290502
         CLC   E0(E7,LISTREG),STATUS   TRACE STATUS            @Y02669P 02296502
         BE    TRACESTS                YES, DO STATUS          @Y02669P 02302502
*                                      PROCESSING              @Y02669P 02308502
         LA    WKREG,IEE535I           SET UP FOR IEE535I;     @Y02669P 02314502
         B     MSGBRCH                 TAKE MSG EXIT           @Y02669P 02320502
         SPACE 2                                                        02326502
* TRACE ON ROUTINE                                             @Y02669P 02332502
         SPACE                                                          02338502
TRACEON  OI    BASPBYTE,BATRACE        SET TRACE BIT ON        @Y02669P 02344502
         B     MSGBRCH1                TAKE MSG EXIT FOR       @Y02669P 02354502
*                                      IEE712I                 @Y02669P 02378802
         SPACE 2                                                        02378902
* TRACE OFF ROUTINE                                            @Y02669P 02379302
         SPACE                                                          02379402
TRACEOFF NI    BASPBYTE,XFF-BATRACE    SET TRACE BIT OFF       @Y02669P 02379502
         B     MSGBRCH1                TAKE MSG EXIT FOR       @Y02669P 02379602
*                                      IEE712I                 @Y02669P 02379702
         SPACE 2                                                        02379902
* TRACE STATUS ROUTINE                                         @Y02669P 02380102
         SPACE                                                          02380402
TRACESTS L     R5,CVTPTR               CVT...                  @Y02669P 02380502
         USING CVT,R5                  ...ADDRESSABILITY       @Y02669P 02380602
         CLC   CVTTRACE,TRACNACT       CVT TRACE BRCH INACTIVE @Y02669P 02380702
         BE    MIEE341I                YES - NO TRACE ACTIVE   @Y02669P 02380802
         LA    WKREG,IEE382I           SET UP FOR MSG IEE382I  @Y02669P 02380902
         B     MSGBRCH1                TAKE MSG EXIT           @Y02669P 02381002
MIEE341I LA    WKREG,IEE341I           SET UP FOR MSG IEE341I  @Y02669P 02381102
         B     MSGBRCH1                TAKE MSG EXIT           @Y02669P 02381302
         EJECT                                                          02381402
**************************************************************** Y02669 02381502
*                                                                Y02669 02381602
*        BRANCH EXIT ROUTINES                                    Y02669 02381702
*                                                                Y02669 02381802
**************************************************************** Y02669 02381902
       SPACE 2                                                          02382002
*                                                                Y02669 02382102
*        EXIT TO CSCB CREATION                                   Y02669 02382202
*                                                                Y02669 02382302
          SPACE                                                         02382402
CSCBBRCH EQU   *                                                 Y02669 02382502
         L     BRCHREG,CSCBMOD         GET ADDRESS OF CSCB       Y02669 02383302
*                                      CREATION MODULE           Y02669 02383402
         BR    BRCHREG                 BRANCH TO IT              Y02669 02384002
       SPACE 2                                                          02384602
*                                                                Y02669 02385202
*        EXIT TO TCAM PROCESSOR                                  Y02669 02385802
*                                                                Y02669 02386402
          SPACE                                                         02387002
TPBRCH EQU   *                                                   Y02669 02387602
         L     BRCHREG,TPMOD           GET ADDRESS OF TCAM       Y02669 02388202
*                                      PROCESSOR MODULE          Y02669 02388802
         BR    BRCHREG                 BRANCH TO IT              Y02669 02389402
       SPACE 2                                                          02390002
*                                                                Y02674 02390602
*        EXIT TO VTAM PROCESSOR                                  Y02674 02391202
*                                                                Y02674 02391802
          SPACE                                                         02392402
NETBRCH EQU   *                                                  Y02674 02393002
         L     BRCHREG,NETMOD          GET ADDRESS OF VTAM       Y02674 02393602
*                                      PROCESSOR MODULE          Y02674 02394202
         BR    BRCHREG                 BRANCH TO IT              Y02674 02394802
         SPACE 2                                                        02394903
*                                                              @Y30LPSV 02395003
*              EXIT TO SS/1 PROCESSOR                          @Y30LPSV 02399003
*                                                              @Y30LPSV 02403303
SS1BRCH  EQU   *                                               @Y30LPSV 02407303
         L     BRCHREG,SS1MOD          GET ADDRESS OF SS/1     @Y30LPSV 02411303
*                                      PROCESSOR MODULE        @Y30LPSV 02413303
         BR    BRCHREG                 BRANCH TO IT            @Y30LPSV 02417303
         EJECT                                                 @Y30LPSV 02419303
*                                                                Y02669 02423303
*        EXIT TO MESSAGE MODULE                                  Y02669 02425303
*                                                                Y02669 02431303
          SPACE                                                         02433303
MSGBRCH EQU   *                        ERROR MESSAGE EXIT      @Y02669P 02435303
         STC   WKREG,XAE               STORE CODE IN EXT SAVE AREA.     02439303
         L     BRCHREG,MSGMOD          GET ADDRESS OF MESSAGE    Y02669 02443303
*                                      MODULE                    Y02669 02446303
         LA    RETCDREG,FOUR           SET FAILING RET CODE      Y02669 02449303
         BR    BRCHREG                 BRANCH TO MESSAGE MODULE  Y02669 02452303
         SPACE                                                          02455303
MSGBRCH1 EQU  *                        SUCCESS MESSAGE EXIT    @Y02669P 02458303
         STC   WKREG,XAE               STORE CODE IN EXT SAVE AREA.     02463302
         L     BRCHREG,MSGMOD          GET ADDRESS OF MESSAGE    Y02669 02483302
*                                      MODULE                    Y02669 02503302
         SR    RETCDREG,RETCDREG       SET SUCCESS RET CODE      Y02669 02523302
         BR    BRCHREG                 BRANCH TO MESSAGE MODULE  Y02669 02543302
        EJECT                                                           02610002
**************************************************************** Y02669 02630002
*                                                                Y02669 02632002
*        MODULE CONSTANTS                                        Y02669 02634002
*                                                                Y02669 02636002
**************************************************************** Y02669 02638002
        SPACE 3                                                         02688002
AHALT    DC    CL8'HALT'               VERB                             02700000
TPMOD    DC    V(IED1303D)             TCAM MODULE               Y02669 02708002
NETMOD   DC    V(ISTCFF3D)             VTAM MODULE               Y02674 02710002
MSGMOD   DC    V(IEE0503D)             MESSAGE MODULE            Y02669 02717002
CSCBMOD  DC    V(IEE0803D)             CSCB CREATE MODULE        Y02669 02719002
SS1MOD   DC    V(IEE9403D)             SS1 MODULE              @Y30LPSV 02729003
*                                                                       02740000
AEOD     DC    C'EOD '                 EOD OPERAND                      02920000
ATRACE   DC    CL8'TRACE'              TRACE VERB FOR MESSAGES @Y02669P 02920102
ASWITCH  DC    C'SWITCH  '                                       A40296 02920202
TPCOMMA  DC    C'TP,'                  TCAM                       20002 02920302
TPBLANK  DC    C'TP '                  PARAMETERS                 20002 02922002
NETCOMMA DC    C'NET,'                 VTAM                      Y02674 02924002
NETBLANK DC    C'NET '                 PARAMETERS                Y02674 02926002
ASMF     DC    C'SMF '                                           A35849 02928002
TRACNACT DC    X'07FB'                 TRACE INACTIVE INDICATOR@Y02669P 02930002
*                                      IN CVT                  @Y02669P 02932002
ON       DC    C'ON '                  TRACE                   @Y02669P 02934002
OFF      DC    C'OFF '                 COMMAND                 @Y02669P 02936002
STATUS   DC    C'STATUS '              OPERANDS                @Y02669P 02938002
*                                                                       02940002
S        DC   C'S,'                    SS/1 TRIGGER            @Y30LPSV 02940303
LONG     DC   C'LONG '                 SS/1-ONLY               @Y30LPSV 02940903
SNAP     DC   C'SNAP '                 SECONDARY OPERANDS      @Y30LPSV 02941203
*                                                              @Y30LPSV 02941503
PATCH    DC    CL50'***  IEE1403D  PATCH AREA ***'             @Y02669P 02942002
*                                                                       02944002
         TITLE 'CVT'                                           @Y02669P 02950002
         CVT   DSECT=YES                                       @Y02669P 02952002
         TITLE 'MASTER RESIDENT DATA AREA'                     @Y02669P 02954002
         IEEBASEA                                              @Y02669P 02956002
         TITLE 'EXTENDED SAVE AREA'                                     02957002
EXSAVSEC DSECT                          DSECT FOR EXTENDED SAVE AREA.   02958002
         IEEXSA                                                         02960002
         END                                                            03630201
