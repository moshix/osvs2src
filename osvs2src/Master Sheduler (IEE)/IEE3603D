 TITLE 'IEE3603D - VARY ONLINE/CONSOLE PATH VERIFICATION ROUTINE'       00150003
IEE3603D CSECT                                                 @Z30LPTJ 00180003
         ENTRY IEE36ENT                                        @Z30LPTJ 00210003
* C 011665-011815,013404-013584,014120-014180,014362-014402,   @YM07231 00260002
* C 014524-014584,015679-015719,705858,705718-705738,          @YM07231 00330002
* C 820200-820340                                              @YM07231 00360002
* C 012922,015679,488000,820460-820487                         @ZM30436 00380003
* C 012922                                                     @ZM30445 00384003
* A 015699,133293,226958-226978,227038,705911-705912,705915,   @ZM30445 00388003
* A 707148-707178,707318                                       @ZM30445 00392003
* C 012922,015699,492000                                       @ZM30479 00396003
* LOOPENQ(C) - STIMER CODED INCORRECTLY                        @ZA09414 00397003
* LOOPENQ(C) - INTERLOCK PROBLEM WITH ALLOCATION               @ZA09166 00398003
         SPACE 1                                                        00400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         00600000
*                                                             *         00800000
* MODULE NAME       = IEE3603D                                          00850002
*   CSECT NAME      = IEE3603D                                          00900002
*                                                                       00950002
* LOAD MODULE NAME  = IEE3603D                                          00960002
*                                                                       00970002
* DESCRIPTIVE NAME  = MP VARY COMMAND PRE-PROCESSOR AND FIRST           00980002
*                     VARY ONLIN/OFFLINE/CONSOLE ATTACHED RTN           00990002
*                     PATH AVAILABILITY CHECKER                         00992002
*                                                                       00994002
* COPYRIGHT         = MISSING                                           00996002
*                                                                       00998002
* STATUS            = OS/VS/2 RELEASE 3 PTF UZ03709            @ZA09166 00998403
*                                                                       00998802
* FUNCTION          = THIS ROUTINE SETS UP THE ENVIRONMENT FOR          00999202
*                     THE VARY ONLINE/OFFLINE/AND CONSOLE PROCESSOR     00999602
*                     AND THEN IT WILL PREVENT DEVICES WHICH HAVE       00999702
*                     NO AVAILABLE PATHS FROM BECOMING ONLINE           00999802
*                     OR CONSOLES                                       00999902
*                                                                       01049902
* OPERATION         = AS THE FIRST THING, IT WILL HAVE A STAE           01059902
*                     ENVIRONMENT CREATED BY IEECB860.                  01069902
*                     THEN, THIS ROUTINE WILL GETMAIN ENOUGH CORE       01079902
*                     FOR A DUMMY XSA,SAVE AREA AND WORK AREA,          01089902
*                     AND IT WILL INITIALIZE THE TABLES                 01090302
*                     FOR THE REST OF THE ONLINE/OFFLINE/CONSOLE        01091902
*                     COMMAND PROCESSOR TO USE.                         01093902
*                     AT THIS POINT, AN ENQ ON SYSIEFSD, Q4 IS @ZA09166 01094003
*                     ATTEMPTED. IF THE RESOURCE IS OBTAINED,  @ZA09166 01094103
*                     PROCESSING CONTINUES. IF THE RESOURCE    @ZA09166 01094203
*                     CAN'T BE OBTAINED, AN STIMER WAIT IS     @ZA09166 01094303
*                     ISSUED FOR 5 SECONDS AND THE ENQ IS      @ZA09166 01094403
*                     RE-ISSUED. IF THE RESOURCE STILL CAN'T   @ZA09166 01094503
*                     BE OBTAINED, A WTOR FOR IEE799I IS       @ZA09166 01094603
*                     ISSUED WITH THE OPTION OF RETRY,CANCEL OR@ZA09166 01094703
*                     WAIT. IF THE OPERATOR REPLIES RETRY,     @ZA09166 01094803
*                     THE WHOLE PROCESS IS REPEATED. IF THE    @ZA09166 01094903
*                     OPERATOR REPLIES CANCEL, MESSAGE IEE756I @ZA09166 01095003
*                     IS ISSUED AND PROCESSING IS TERMINATED.  @ZA09166 01095103
*                     IF THE OPERATOR REPLIES WAIT, AN         @ZA09166 01095203
*                     UNCONDITIONAL ENQ IS ISSUED.             @ZA09166 01095303
*                     THE FOLLOWING FIELDS WILL BE INITIALIZED          01095902
*                       XAL WILL POINT TO CHBUF=PTR TO PARAMS           01097902
*                            IN THE VARY COMMAND                        01098302
*                       XAU WILL CONTAIN THE UCM ID OF THE ISSUING      01098702
*                            CONSOLE FROM THE INFOR IN THE CSCB         01099102
*                       XAV IS INIT TO THE COMMAND VERB = VARY          01099502
*                       XAR IS INIT TO THE LENGTH OF THE COMMAND        01099602
*                            THIS IS ALWAYS THE LENGTH OF THE CMD       01099702
*                            BUFFER IN THE CSCB = 124 BYTES             01099802
*                       XAS IS INIT TO THE R/I COMMAND AUTH.            01133202
*                            FROM THE CSCB (IF THE R/I ISSUED THE       01143202
*                            COMMAND, ELSE THIS FIELD IN THE CSCB       01153202
*                            IS ZEROES AND IT IS COPIED AS SUCH)        01163202
*                     IF A VARY RANGE COMMAND IS PRESENT, THEN @Z30LPTJ 01163603
*                     A BRANCH IS MADE TO IEECB904 TO EXPAND   @Z30LPTJ 01164003
*                     THE UNITS IN THE COMMAND INTO A VARY     @Z30LPTJ 01164403
*                     COMMAND WITH INDIVIDUAL DEVICES.         @Z30LPTJ 01164803
*                     THEN THE COMMAND SYNTAX IS CHECKED.               01165202
*                     A NORMAL EXIT IS TAKEN FOR INVALID SYNTAX.        01165602
*                     THEN, EACH UNIT IS CHECKED FOR GOOD PATHS.        01166002
*                     A MESSAGE IS WRITTEN FOR EACH UNIT HAVING NO      01166402
*                     GOOD PATHS OR EACH UNIT IN USE BY A      @YM07231 01166502
*                     SYSTEM COMPONENT AND THE UNIT IS DELETED @YM07231 01171502
*                     FROM THE BUFFER.  UNITS HAVING GOOD      @YM07231 01176502
*                     PATHS ARE LEFT IN THE COMMAND BUFFER.    @YM07231 01181502
*                     FINALLY, WHEN ALL UNITS HAVE BEEN CHECKED, A      01188002
*                     NORMAL EXIT IS TAKEN IF ANY UNITS ARE LEFT IN     01188402
*                     THE COMMAND BUFFER. OTHERWISE, AN ERROR EXIT      01188802
*                     IS TAKEN.                                         01192502
*                                                                       01194502
* NOTES                                                                 01194902
*   DEPENDENCIES    = NONE                                              01195302
*   CHARACTER/CODE DEPENDENCIES                                         01195702
*                   = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW         01196102
*                     CHARACTER/CODE SET                                01196202
*   RESTRICTIONS    = R2 CONTAINS THE PTR TO THE DUMMY XSA ON OUTPUT    01246202
*   REGISTER CONVENTIONS                                                01256202
*                   = REGISTERS ARE DEFINED AT LABEL: DEFREG            01266202
*   PATCH LABEL     = PATCH                                             01276202
*                                                                       01286202
* MODULE TYPE       = CSECT                                             01288202
*   PROCESSOR       = ASSEMBLER                                         01290202
*   MODULE SIZE     = VS/2 = 'B00'                             @ZM30479 01292203
*   ATTRIBUTES      = REENTRANT,REUSABLE,REFRESHABLE,                   01294202
*                     PAGED LPA,ZERO PSW PROTECT KEY                    01294602
*                                                                       01295002
* ENTRY POINTS      = IEE3603D FROM IEEVWAIT                            01295402
*   PURPOSE         = TO PRESET THE ENVIRONMENT FOR THE VARY ONLINE/    01295802
*                     OFFLINE/CONSOLE CMDS, TO ROUT THE OFFLINE CMD     01295902
*                     DIRECTLY TO IEE3303D, TO TEST PATH-AVAILABILITY   01296002
*                     FOR UNITS GOING TO THE ONLINE AND CONSOLE STATES  01296102
*   LINKAGE         = ATTACH                                            01312802
*   INPUT           = REG1 HAS A PTR TO THE CSCB                        01322802
*   REGISTERS SAVED = R14 = RETURN ADDRESS REG IS SAVED ON ENTRY        01324802
*                     R1  = CSCB PTR                                    01326802
*   REGISTER USAGE  = R2 PTR TO DUMMY XSA                               01328802
*                     R3 PTR TO THE CSCB UNTIL IT IS STORED             01329202
*                     R12 ADDRESSABILITY REGISTER                       01329302
*                     R13 PTR TO WORK AREA                              01329402
*   REGISTER RESTORED                                                   01335002
*                   = R14                                               01337002
*                                                              @Z30LPTJ 01337203
* ENTRY POINTS      = IEE36ENT FROM IEECB904                   @Z30LPTJ 01337803
*   PURPOSE         = TO EXECUTE NORMAL VARY PROCESSING AFTER  @Z30LPTJ 01338403
*                     EXPANSION OF THE VARY RANGE COMMAND INTO @Z30LPTJ 01339003
*                     INDIVIDUAL DEVICE UNITS HAS TAKEN PLACE. @Z30LPTJ 01339603
*   LINKAGE         = BRANCH                                   @Z30LPTJ 01340203
*   INPUT           = REGISTER 2 POINTING TO THE XSA           @Z30LPTJ 01340803
*   REGISTERS SAVED = NONE                                     @Z30LPTJ 01341403
*   REGISTER USAGE  = REGISTER 2 POINTING TO THE DUMMY XSA     @Z30LPTJ 01342003
*                     REGISTER 12 IS THE ADDRESSABILITY BASE   @Z30LPTJ 01342603
*                     REGISTER 13 POINTS TO THE WORK AREA      @Z30LPTJ 01343203
*   REGISTERS RESTORED                                         @Z30LPTJ 01343803
*                   = REGISTER 14                              @Z30LPTJ 01344403
*                                                                       01345203
* EXITS - NORMAL -1 = IEE3303D VIA BRANCH                               01346403
*   CONDITIONS      = A NORMAL EXIT IS TAKEN IF THE COMMAND HAS A       01347403
*                     GROSS SYNTAX ERROR, WHICH WOULD MAKE THE TOTAL    01348403
*                     COMMAND, INVALID.  OR IF AFTER DELETION OF        01349403
*                     ALL UNAVAILABLE UNITS, AND UNITS IN USE  @YM07231 01352403
*                     BY A SYSTEM COMPONENT, AT LEAST ONE UNIT @YM07231 01354403
*                     IS LEFT IN THE COMMAND, OR BEFORE        @YM07231 01356403
*                     PROCESSING IF A 'VARY OFFLINE' IS FOUND. @YM07231 01358402
*   OUTPUT          = IF EXIT IS TAKEN TO IEE3303D, REGISTER 2          01365302
*                     POINTS TO THE DUMMY XSA                           01367302
*                     R13 PTS TO THE SAVE AREA WORD 17 =CSCB PTR        01369302
*   RETURN CODES    = NONE                                              01369702
*                                                                       01370102
* EXITS - NORMAL -2 = IEEVDEV - MP PATH VERIFICATION SUBROUTINE         01370202
*   CONDITIONS      = A UNIT HAS BEEN FOUND THAT IS VALID AND THE       01370302
*                     PATH NOW HAS TO BE VERIFIED AS BEING OPEN OR NOT  01375202
*                     EVEN THOUGH 3603D WILL GO TO IEEVDEV AS MANY      01375302
*                     TIMES AS THERE ARE UNITS IN THE COMMAND WHICH     01375402
*                     ARE NOT ONLINE AT THE TIME OF THIS MODULE'S       01375502
*                     EXECUTION, ONLY ONE LOAD/DELETE AND ONE           01378302
*                     GETMAIN/FREEMAIN FOR VDEV'S PARAM CORE IS         01380302
*                     EXECUTED. ONE THE LOAD IS PERFORMED, THE ADDR     01380702
*                     OF IEEVDEV IS STORED IN THE XAP FOR FUTURE        01381102
*                     USE. ELSE THIS AREA IS 0 (PRESET AT XSA           01381503
*                     INIT TIME).                                       01382403
*                     ONCE THE CORE FOR IEEVDEV'S PARAM LIST AND        01385003
*                     SAVE AREA IS GOTTEN, ITS ADDRESS IS STORED        01386403
*                     IN THE XAD FOR FUTURE USE. ELSE THIS AREA         01387103
*                     IS 0 (PRESET AT XSA INIT TIME).                   01388103
*                     THE FREEMAIN OF VDEV'S PARAM AND SAVE AREA        01390003
*                     CORE AND THE DELETE OF IEEVDEV ARE DONE EITHER    01391003
*                     ON EXIT TO IEE3303D OR UPON THE 'RETURN'          01392803
*                     EXIT, WHICHEVER IS TAKEN.                         01394803
*   OUTPUT          = REG1 PTS TO A PTR WHICH PTS TO A TWO WORD PARAM   01395803
*                     LIST:                                             01396803
*                          WORD 1: PTR TO THE UCB TO HAVE PATH SEARCHED 01397803
*                          WORD 2,BYTE1 : FUNCTION CODE = VARY = X'00'  01401203
*                                  REST OF WORD 2 IS NOT APPLICABLE     01402203
*                     R13 PTS TO A 72 SAVE AREA                       P 01404003
*   RETURN CODES    = RETURN CODE 4 OR 12 MEANS THAT THERE IS NO        01405003
*                     AVAILABLE PATH TO THIS DEVICE AND THEREFORE       01406803
*                     IT CANNOT BE VARIED ONLINE OR THE CONSOLE         01407803
*                     STATE.                                            01409603
*                     RET CODE OF 16 MEANS THAT THE UNIT HAS BEEN       01412003
*                     FOUND TO BE IN USE BY A SYSTEM COMPONENT @YM07231 01413003
*                     RIGHT NOW, THEREFORE IT CANNOT BE VARIED @YM07231 01414003
*                     ONLINE, OR TESTED FOR PATHS , OR VARIED  @YM07231 01416003
*                     TO THE CONSOLE STATE.                    @YM07231 01418002
*                     A RET CODE OF 8 MEANS THE IEEVDEV COULD NOT       01421702
*                     GET ENOUGH CORE TO PROCESS AND THEREFORE          01422702
*                     NO PATH VERIFICATION WAS DONE.                    01424602
*                     THE COMMAND AS ABORTED AT THIS TIME.              01427502
*                                                              @Z30LPTJ 01427803
* EXITS - NORMAL -3 = IEECB904 - VARY RANGE PROCESSOR ROUTINE  @Z30LPTJ 01428303
*   CONDITIONS      = WHENEVER IEE3603D DETECTS A VARY RANGE   @Z30LPTJ 01428803
*                     COMMAND IN THE COMMAND BUFFER AND IT HAS @Z30LPTJ 01429303
*                     SOME PRIMARY GOOD SYNTAX.  A RETURN FROM @Z30LPTJ 01429803
*                     IEECB904 WILL HAVE A NEW BUFFER (POINTED @Z30LPTJ 01430303
*                     TO BY THE XAL FIELD IN THE XSA) WHICH    @Z30LPTJ 01430803
*                     WILL CONTAIN THE EXPANDED FORM OF THE    @Z30LPTJ 01431303
*                     VARY RANGE COMMAND (UP TO 28 SINGLE      @Z30LPTJ 01431803
*                     DEVICE UNITS).                           @Z30LPTJ 01432303
*   OUTPUT          = REGISTER 2 POINTING TO THE XSA           @Z30LPTJ 01432803
*   RETURN CODES    = NONE                                     @Z30LPTJ 01433303
*                                                                       01434303
* EXITS - ERROR     = BR14 (RETURN TO THE SVC HANDLER)                  01435203
*   CONDITIONS      = AN ERROR EXIT IS TAKEN IF NOTHING IS LEFT         01436203
*                     IN THE COMMAND BUFFER AFTER ALL UNITS             01440203
*                     ARE DELETED, OR WHEN THE STAE ENVIRONMENT@YM07231 01444003
*                     CANNOT BE CREATED SUCCESSFULLY.          @YM07231 01448003
*                     THE ABOVE-MENTIONED CONDITIONS HOLD TRUE @Z30LPTJ 01448603
*                     ONLY IF THE VARY RANGE BIT IS NOT ON.    @Z30LPTJ 01449303
*                     OR, THE FIRST TIME THAT IEEVDEV RETURNS A         01450003
*                     RETURN CODE OF 8 (INSUFF. CORE FOR PROCESSING)    01452003
*                     ALSO, AN ERROR EXIT IS MADE IF THE VARY  @Z30LPTJ 01453003
*                     RANGE COMMAND IS SYNTAXICALLY INCORRECT. @Z30LPTJ 01455003
*   OUTPUT          = FOR EACH UNIT IN THE VARY ONLINE OR      @Z30LPTJ 01457003
*                     VARY CONSOLE COMMAND THAT HAS:           @Z30LPTJ 01459003
*                      A) NO AVAILABLE PATHS -                 @Z30LPTJ 01461003
*                          NO PATHS MESSAGE (IEE025I)          @Z30LPTJ 01463003
*                      B) THE UNIT IN USE BY A SYSTEM          @Z30LPTJ 01465003
*                         COMPONENT -                          @Z30LPTJ 01467003
*                          SYSTEM COMPONENT MESSAGE (IEE329I)  @Z30LPTJ 01469003
*                      C) NO UCB -                             @Z30LPTJ 01471003
*                          UNIT REF INVALID MESSAGE (IEE313I)  @Z30LPTJ 01473003
*                      D) CHARACTERS AFTER THE 'OFFLINE' OR    @Z30LPTJ 01473503
*                         'ONLINE' KEYWORDS -                  @Z30LPTJ 01474003
*                          TERM LENGTH ERROR MESSAGE (IEE303I) @Z30LPTJ 01474503
*                     THE FOLLOWING ERROR MESSAGES ARE ISSUED  @Z30LPTJ 01475003
*                     WHEN A VARY RANGE COMMAND HAS SYNTAX     @Z30LPTJ 01477003
*                     ERRORS:                                  @Z30LPTJ 01479003
*                      A) RIGHT PARENTHESIS AND COMMA NOT      @Z30LPTJ 01481003
*                         PRESENT WHEN EXPECTED                @Z30LPTJ 01483003
*                          DELIMITER ERROR MESSAGE (IEE307I)   @Z30LPTJ 01485003
*                      B) MIXTURE OF SINGLE AND RANGE UNITS -  @Z30LPTJ 01487003
*                          TERM LENGTH ERROR MESSAGE (IEE308I) @Z30LPTJ 01489003
*                      C) 'CONSOLE' KEYWORD SPECIFIED -        @Z30LPTJ 01491003
*                          PARAMETER CONFLICT MESSAGE (IEE312I)@Z30LPTJ 01493003
*   RETURN CODES    = NONE                                              01495203
*                                                                       01496203
* EXTERNAL REFERENCES                                                   01498202
*   ROUTINE         = IEE3303D                                          01500202
*                     IEEVDEV = (PATH CHECKER SUBROUTINE)               01500602
*                     IEECB860 = (STAE PROCESSOR)                       01501002
*                     IEECB904 = (VARY RANGE PROCESSOR)        @Z30LPTJ 01501203
*   DATA AREAS      = SEE EXITS - OUTPUT DATA                           01501402
*                                                                       01501802
* CONTROL BLOCKS    = DUMMY EXTENDED SAVE AREA (XSA)                    01501902
*                     COMMAND SCHEDULING CONTROL BLOCK (CSCB)           01502002
*                       FIELDS TESTED  - CHBUF                          01502102
*                                        CHUCMP                         01506802
*                       FIELDS UPDATED - CHSTS -BIT= CHFC               01508802
*                     CVT                                               01510802
*                       FIELDS TESTED  - CVTILK2                        01511202
*                                        CVTPTR                         01511302
*                       FIELDS UPDATED - NONE                           01511402
*                     UNIT CONTROL BLOCK (UCB)                          01523002
*                       FIELDS TESTED  - UCBNAME                        01533002
*                       FIELDS UPDATED - NONE                           01533402
*                                                                       01533802
* TABLES            = 136 BYTE WORK AREA IN SUBPOOL 229 OF LSQA         01534202
*                     48 BYTES FOR USE AS A DUMMY XSA FOR               01534602
*                     THE VARY ONLINE/OFFLINE/CONSOLE PROCESSORS        01534702
*                     84 BYTES FOR THE SAVE AREA FOR VARY AND           01534802
*                     THE ONE WORD-CSCB-POINTER-STORE                   01538702
*                     AND 4-WORD SAVE FOR REGS AT SETLOCK TIME          01540702
*                                                                       01540802
* MACROS            = GETMAIN,FREEMAIN,WTO,LOAD,DELETE,MGCR,ENQ,DEQ     01541102
*                                                                       01541502
* MAPPING MACROS    = IEEXSA                                            01541902
*                     CVT                                               01542302
*                     IEFUCBOB                                          01542402
*                     IEECHAIN                                          01542502
*   SERIALIZATION   = NO LOCKS ARE OBTAINED IN THIS ROUTINE             01546402
*                    FOR PROTECTION AGAINST ALLOC, ANOTHER VARY OR      01546802
*                     UNLOAD COMMAND THIS ROUTINE ISSUES THE ENQ ON     01547202
*                     Q4 WHICH WILL PROTECT ALL OR THE COMMAND PROCESOR 01547602
*                                                                       01548002
*                     THE ENQ IS ISSUED IN THIS MODULE                  01548103
*                     THE DEQ ARE ISSUED IN THE FOLLOWING PLACES:       01548302
*                          IEEDEQUE IN THIS MODULE WHEN ERRORS ARE      01550403
*                              ENCOUNTERED                              01551403
*                          SDEQUE IN IEE3303D                           01552802
*                          UDEQUE IN IEE4203D                           01553202
*                          KDEQUE IN IEE4403D                           01554302
*                          ODEQUE IN IEE4603D                           01556302
*                          CDEQUE IN IEE4903D                           01556702
*                          VDEQUE IN IEE3103D                           01556902
*                          CDEQUE IN IEE7303D                           01557302
*                          CDEQUE IN IEE4803D                           01557402
*                          CDEQUE IN IEECB904                  @Z30LPTJ 01557503
*                                                                       01561703
* CHANGE LEVEL      = Y02669, Y02651, Y02653, Z30LPTJ, ZM30436 @ZM30436 01567903
*                     ZM30445, ZM30479, ZA09166, ZA09414       @ZA09166 01569903
*                                                                       01571903
* CHANGE ACTIVITY   = N/A                                               01576003
*                                                                       01578003
* MESSAGES          = 'IEE025I UNIT XXX HAS NO LOGICAL  PATHS'          01581003
*                     'IEE025I UNIT XXX HAS NO PHYSICAL PATHS'          01584203
*                     'IEE329I XXX IN USE BY A SYSTEM          @YM07231 01588203
*                                               COMPONENT'     @YM07231 01592303
*                     'IEE313I XXX UNIT REF INVALID'           @Z30LPTJ 01594303
*                     'IEE084I XXX 3851 PARAMETER MISSING'     @Z30LPTJ 01595303
*                       WHERE XXX IS THE UNIT NAME             @Z30LPTJ 01596303
*                     'IEE328I VARY COMMAND ABORTED'                    01598303
*                     'IEE307I VARY DELIMITER ERROR'           @Z30LPTJ 01600403
*                     'IEE308I VARY TERM LENGTH ERROR'         @Z30LPTJ 01601403
*                     'IEE312I VARY PARAMETERS CONFLICT'       @Z30LPTJ 01602403
*                     'IEE799A VARY CONSOLE DELAYED - REPLY    @ZA09166 01602903
*                      RETRY,CANCEL OR WAIT'                   @ZA09166 01603003
*                                                                       01603403
* ABEND CODES       = NONE                                              01604403
*                                                                       01608503
* PACKAGING         = IEE3603D WILL BE PART OF LOAD MODULE              01613503
*                       IEE3603D                                        01618502
*                     THIS LOAD MODULE ALIASES ARE                      01628502
*                       NONE                                            01638502
*                     THIS LOAD MODULE ENTRY POINTS ARE                 01640502
*                       IEE3603D                                        01642502
*                     THIS MODULE WILL RESIDE IN: LPALIB                01644502
*                                                                       01646502
* SYSGEN            = SUPPLIED BY SECTIONS                              01646602
*                       LOAD MODULE NAME                                01646702
*                       PACKAGING                                       01659502
*                       THIS CSECT WILL BE INCLUDED AT SYSGEN FROM      01661502
*                       DLIB -AOSB3- BY MACRO -SGIEF441-                01663502
*                                                                       01669502
* SYSTEM LIBRARIES  = NONE                                              01671502
*                                                                       01671902
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         01672302
         EJECT                                                          01685102
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         01723402
*                                                             *         01761702
* EQUATES                                                     *         01800000
*                                                             *         02000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         02200000
         SPACE 1                                                        02400000
DEFREG   EQU   *                                                 Y02669 02450002
R0       EQU   0                                                        02600002
R1       EQU   1                   INPUT = CSCB POINTER          Y02669 02800002
R2       EQU   2                   DUMMY XSA POINTER             Y02669 03000002
R3       EQU   3                   MODULE'S CSCB POINTER         Y02669 03200002
R4       EQU   4                   EOB POINTER                   Y02669 03400002
R5       EQU   5                                                        03600002
R6       EQU   6                                                        03800002
R7       EQU   7                                                        04000002
R8       EQU   8                   WORK AREA POINTER             Y02669 04200002
R9       EQU   9                                                        04400002
R10      EQU   10                                                       04600002
R11      EQU   11                                                       04800002
R12      EQU   12                  ADDRESSABILITY                Y02669 05000002
R13      EQU   13                  SAVE AREA POINTER             Y02669 05200002
R14      EQU   14                                                       05400002
R15      EQU   15                                                       05600002
         SPACE 1                                                        07800000
BE       EQU   8                   BCR CONDITION MASK                   08000000
BNE      EQU   7                   BCR CONDITION MASK                   08200000
         SPACE 1                                                        08800000
K0       EQU   0                                                        09000002
K1       EQU   1                                                        09200002
K2       EQU   2                                                        09400002
K3       EQU   3                                                        09600002
K4       EQU   4                                                        09800002
K5       EQU   5                                                 Y02669 09850002
K6       EQU   6                                                        10000002
K7       EQU   7                                                        10200002
K8       EQU   8                                                        10400002
K9       EQU   9                                               @YM3411P 10420002
K12      EQU   12                                                Y02669 10450002
K13      EQU   13                                                       10600002
K16      EQU   16                                                Y02669 10650002
K17      EQU   17                                                       10670002
K24      EQU   24                                                Y02669 10700002
K28      EQU   28                                              @YM3369P 10750002
K130     EQU   130                                             @Z30LPTJ 10770003
K136     EQU   136                                             @Z30LPTJ 10780003
K140     EQU   140                                             @Z30LPTJ 10790003
         SPACE 1                                                        10800000
XC1      EQU   X'C1'                                           @YM3411P 10850002
XC6      EQU   X'C6'                                           @YM3411P 10900002
XF0      EQU   X'F0'                                           @YM3411P 10950002
X4D      EQU   C'('                                                     12000002
X40      EQU   C' '                                                     12200002
X5D      EQU   C')'                                                     12400002
X6B      EQU   C','                                                     12600002
TWELV    EQU   12                                                Y02669 13050002
FOR      EQU   4                                                 Y02669 13100002
ZERO     EQU   0                                                 Y02669 13150002
EIT      EQU   8                                                 Y02669 13160002
SIXTEEN  EQU   16                                                Y02669 13170002
D132     EQU   132                                               Y02669 13180002
*              NOTE: IF THE SIZE OF THIS 'D132' IS CHANGED     @Z30LPTJ 13181003
*                    (REFLECTING CHANGE IN XSA MACRO SIZE),    @Z30LPTJ 13182003
*                    SUCH CHANGE MUST ALSO BE MADE TO THE SAME @Z30LPTJ 13183003
*                    LABEL IN THE FOLLOWING MODULES:           @Z30LPTJ 13184003
*                      IEE3103D  IEE4403D  IEE4903D            @Z30LPTJ 13185003
*                      IEE3303D  IEE4603D  IEE7303D            @Z30LPTJ 13186003
*                      IEE4203D  IEE4803D  IEECB904            @Z30LPTJ 13187003
D124     EQU   124                                               Y02669 13190002
D48      EQU   48                                                Y02669 13192002
D64      EQU   64                                                Y02669 13194002
D68      EQU   68                                                Y02669 13194402
D512     EQU   512                                               Y02669 13195202
TWENTY   EQU   20                                                     P 13198002
TREE08   EQU   308                                             @Z30LPTJ 13198403
*              NOTE: IF THE SIZE OF THIS 'TREE08' IS           @Z30LPTJ 13198603
*                    CHANGED, SUCH CHANGE MUST ALSO BE MADE    @Z30LPTJ 13198803
*                    AT THE 'SPSIZEC' LABEL IN IEECB904.       @Z30LPTJ 13199003
ECBPOST  EQU   X'40'                                                    13199202
BLANK    EQU   C' '                                            @Z30LPTJ 13199303
LEFPAREN EQU   C'('                                            @Z30LPTJ 13219303
RTPAREN  EQU   C')'                                            @Z30LPTJ 13239303
COMMA    EQU   C','                                            @Z30LPTJ 13259303
HYPHEN   EQU   C'-'                                            @Z30LPTJ 13279303
OHDASH   EQU   C'O'                                            @Z30LPTJ 13299303
EYEDASH  EQU   C'I'                                            @Z30LPTJ 13319303
RI       EQU   X'80'                                           @ZM30445 13329303
         EJECT                                                          13350003
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         13400000
*                                                             *         13600000
* ENTRY CODE AND INITIALIZATION                               *         13800000
*                                                             *         14000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         14200000
         USING CHAIN1,R3                                         Y02669 14450002
         USING IEE36XSA,R2         TO REF EXTENDED SAVE AREA            14600000
         USING IEE36WRK,R8        TO REFERENCE WORK AREA                15000002
         SPACE 1                                                        15200000
         BALR  R12,R0              INITIALIZE BASE REGISTER             15400000
         USING *,R12        TO ESTAB BASE OF ADDRBILITY          Y02669 15450002
         SPACE 1                                                        15500002
         MODID BR=YES                                                   15550002
         SPACE 1                                                        15600000
         LR    R3,R1              CSCB PTR                       Y02669 15650002
         LR    R4,R14             SAVE RET ADDRESS               Y02653 15700002
         LOAD  EP=IEECB860                                       Y02653 15750002
         LR    R6,R0              SAVE RTN'S ADDRESS             Y02653 15760002
*                                                                       15770002
         L     R0,IEE36GMP         INIT GETMAIN LV PARAM REG            15800002
       GETMAIN R,LV=(0)            GETMAIN WORK/SAVE AREA               16000000
         LR    R8,R1              INIT SAVE AREA REG             Y02653 16050002
         ST    R3,K12(R8)         SAVE CSCB POINTER              Y02653 16100002
         ST    R3,K0(R8)          SAVE CSCB PTR FOR STAE         Y02653 16110002
         ST    R4,K8(R8)          SAVE REUTRN ADDRESS            Y02653 16120002
         LA    R4,K16(R8)         GET ADDR OF STAE CMD PARAM     Y02653 16130002
         ST    R4,K4(R8)          AND STORE FOR STAE             Y02653 16140002
         MVC   K16(K5,R8),LVARY   INIT CMD PARAM TO HAVE SIZE    Y02653 16142002
*                                 OF CMD AND COMMAND VERB        Y02653 16144002
         LR    R15,R6             ADDRESS OF STAE RTN            Y02653 16146002
         LR    R13,R8             SAVE SA PTR                   YM02653 16146202
         STM   R0,R15,K24(R13) STR REGS SO CB860 DOESN'T CLOBBERYM02653 16146402
         BALR  R14,R15            GO TO SET UP STAE ENVIRONMNT   Y02653 16148002
*                                                                Y02653 16148402
         LM    R0,R14,K24(R13)    RESTORE REGS                  YM02653 16148502
         LR    R5,R15             SAVE RETURN CODE FROM STAE     Y02653 16148802
         DELETE EP=IEECB860                                      Y02653 16149202
         L     R3,K12(R8)         RE-OBTAIN CSCB PTR             Y02653 16149602
         L     R4,K8(R8)          RE-OBTAIN RETURN ADDRESS       Y02653 16149702
         LTR   R5,R5              STAE IS OK?                    Y02653 16149802
         BZ    STAEOK             YES                            Y02653 16149902
         LR    R1,R8              NO, GOTTEN CORE PTR INTO R1    Y02653 16166602
         L     R0,IEE36GMP        AND SIZE INTO R0 FOR FREE      Y02653 16176602
         FREEMAIN R,LV=(0),A=(1)                                 Y02653 16178602
         LR    R1,R3              CSCB PTR                       Y02653 16180602
         OI    CHSTS,CHFC         SET - FREE CSCB BIT            Y02653 16182602
         MGCR  (1),CHAIN                                         Y02653 16183002
         LR    R14,R4             RETURN ADDRESS TO R14          Y02653 16183102
         BR    R14                RETURN                         Y02653 16183202
*                                                                Y02653 16188802
STAEOK   EQU   *                                                 Y02653 16190802
         ST    R4,IEE36S14        SAVE RETURN REGISTER           Y02669 16192802
         LA    R0,D132            DUMMY XSA AND SAVE AREA CORE   Y02669 16193602
         GETMAIN R,LV=(0)                                        Y02669 16194002
         LR    R2,R1              DUMMY XSA POINTER              Y02669 16194102
         LA    R13,D48(R1)        SAVE AREA POINTER              Y02669 16194202
         XC    K0(D48,R2),K0(R2)  ZERO OUT DUMMY XSA             Y02669 16194302
         LR    R1,R3              CSCB PTR INTO REG1 FOR STORE   Y02669 16244302
         L     R14,IEE36S14         RESTORE REG14 FOR SAVE       Y02669 16246302
         STM   R0,R15,K0(R13)     SAVE REGS                      Y02669 16254302
         ST    R3,D64(R13)        CSCB PTR TO WORD17 OF SAVEAREA Y02669 16264302
         LA    R4,CHBUF           PTR TO CMD PARAM LIST          Y02669 16274302
         LA    R4,K0(R4)                                         Y02669 16284302
         ST    R4,XAL             STORE PTR TO PARAMS IN D XSA   Y02669 16286302
         MVC   XAU(K1),CHUCMP     UCMID INTO DUMMY XSA           Y02669 16288302
         MVC   XAV(K8),VARY       VARY VERB                      Y02669 16290302
         LA    R4,D124            SIZE OF PARAM LIST BUFFER      Y02669 16292702
         ST    R4,XAR             INTO DUMMY XSA                 Y02669 16293102
         MVC   XAS(K2),CHINC      MOVE R/I AUTH OR 0             Y02669 16293502
         DROP  R3                                                Y02669 16373502
*                                                                Y02669 16400002
         L     R3,XAL              GET PTR TO BEGIN OF OPERANDS         17200000
         LA    R3,K0(R3)           CLEAR HIGH ORDER BYTE OF ADR         17400000
         MVC   XAX(K8),IEE3303D     SET EXIT IDENTIFIER          Y02669 18400002
*                       XAP (1WORD) IS ZEROES NOW = NO LOAD FOR  Y02669 18450002
*                       IEEVDEV WAS PERFORMED AS YET             Y02669 18500002
*                       XAD (1 WORD) IS ALSO 0, NO GOTTEN        Y02669 18550002
*                       CORE FOR IEEVDEV PARAM AS YET            Y02669 18600002
         EJECT                                                          19200000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         19450002
*                                                             *         19600000
* DETERMINE LENGTH OF OPERANDS                                *         19800000
*                                                             *         20000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         20200000
         SPACE 1                                                        20400000
         LR    R6,R3               GET POINTER TO BEG OF BUFFER         20600002
         AR    R4,R6              POINTER TO EOB INTO REG4       Y02669 20850002
IEE36030 EQU   *                                                        21600003
         CLI   K0(R6),BLANK       IS THIS CHARACTER A BLANK?   @Z30LPTJ 21700003
         BE    IEE3603A           EXIT IF A BLANK IS FOUND     @Z30LPTJ 21800003
         CLC   K0(K6,R6),ONLINE   IS IT NOW 'ONLINE' KEYWORD?  @Z30LPTJ 21820003
         BE    CHKON              YES, CHECK FOR ITS VALIDITY  @Z30LPTJ 21840003
         CLC   K0(K7,R6),OFFLINE  IS IT NOW 'OFFLINE' KEYWORD? @Z30LPTJ 21860003
         BE    CHKOFF             YES, CHECK FOR ITS VALIDITY  @Z30LPTJ 21880003
         LA    R6,K1(R6)          INCREMENT TO NEXT CHARACTER  @Z30LPTJ 21900003
         CR    R6,R4              PAST END OF BUFFER?          @Z30LPTJ 22000003
         BNH   IEE36030           NO, LOOP UNTIL LAST END BLANK@Z30LPTJ 22100003
IEE3603A EQU   *                                               @Z30LPTJ 22200003
         LR    R4,R6              SAVE 'END OF COMMAND' POINTER@Z30LPTJ 22210003
         BCTR  R4,R0              DECREMENT IT BY ONE          @Z30LPTJ 22220003
         LR    R5,R4              POINTER TO  LAST NON-BLANK     Y02669 22250002
         SH    R5,FOUR            POINTER TO 'NLINE,'FLINE,OR    Y02669 22300002
*                                 'NSOLE                         Y02669 22350002
         LR    R6,R3              GET POINTER TO BEG OF BUFFER @Z30LPTJ 22350103
         B     STRTSCAN           START SCANNING THE COMMAND   @Z30LPTJ 22350703
         SPACE                                                          22351303
CHKON    EQU   *                                               @Z30LPTJ 22351903
         LA    R6,K6(R6)          POINT PAST 'ONLINE' KEYWORD  @Z30LPTJ 22352503
         B     CHECKER            AVOID 'OFFLINE' INCREMENTER  @Z30LPTJ 22353103
CHKOFF   EQU   *                                               @Z30LPTJ 22360803
         LA    R6,K7(R6)          POINT PAST 'OFFLINE' KEYWORD @Z30LPTJ 22361403
CHECKER  EQU   *                                               @Z30LPTJ 22362003
         CLI   K0(R6),BLANK       IS THERE A REQUIRED BLANK?   @Z30LPTJ 22362603
         BE    IEE3603A           YES, A BLANK IS FOUND        @Z30LPTJ 22363203
         B     TERM               NO, TAKE ERROR EXIT          @Z30LPTJ 22363803
         EJECT                                                          22364803
************************************************************** @Z30LPTJ 22367803
*                                                            * @Z30LPTJ 22370803
* DETERMINE IF THERE IS A VARY RANGE COMMAND                 * @Z30LPTJ 22378803
*                                                            * @Z30LPTJ 22385803
************************************************************** @Z30LPTJ 22392803
STRTSCAN EQU   *                                               @Z30LPTJ 22395803
         LR    R10,R6             OBTAIN AN INDEXING REGISTER  @Z30LPTJ 22399803
         CLI   K0(R10),LEFPAREN   IS THERE A LEFT PARENTHESIS? @Z30LPTJ 22406803
         BNE   SCANHERE           NO, AVOID INDEXING           @Z30LPTJ 22413803
         LA    R10,K1(R10)        INDEX TO NEXT CHARACTER      @Z30LPTJ 22420803
SCANHERE EQU   *                                               @Z30LPTJ 22427803
         CLI   K3(R10),HYPHEN     IS 3RD CHARACTER A HYPHEN?   @Z30LPTJ 22430803
         BNE   ONVARY             NO, DO NOT ENTER VARY RANGE  @Z30LPTJ 22434803
         CLI   K2(R10),EYEDASH    IS 2ND CHARACTER AN 'I'      @Z30LPTJ 22441803
         BE    ONVARY             YES, DO NOT ENTER VARY RANGE @Z30LPTJ 22448803
         CLI   K2(R10),OHDASH     IS 2ND CHARACTER AN 'O'      @Z30LPTJ 22455803
         BE    ONVARY             YES, DO NOT ENTER VARY RANGE @Z30LPTJ 22462803
         CLC   K0(K5,R5),FLINE    IS THIS VARY OFFLINE?        @Z30LPTJ 22465803
         BE    RANGLOOP           YES, AVOID ONLINE BIT SETTING@Z30LPTJ 22469803
         CLC   K0(K5,R5),NLINE    IS THIS VARY ONLINE?         @Z30LPTJ 22476803
         BNE   CONFLICT           NO, ISSUE ERROR MESSAGE      @Z30LPTJ 22483803
         OI    XAAVRANG,XAARNG4   TURN ONLINE BIT ON           @Z30LPTJ 22490803
RANGLOOP EQU   *                                               @Z30LPTJ 22497803
         CLI   K7(R10),COMMA      IS 7TH CHARACTER A COMMA?    @Z30LPTJ 22500803
         BNE   CHECK              NO, CHECK END DELIMTER       @Z30LPTJ 22504803
         CLC   K8(K6,R10),ONLINE  IS IT ONLINE KEYWORD NOW?    @Z30LPTJ 22511803
         BE    NEXTMOD            YES, GO TO IEECB904          @Z30LPTJ 22518803
         CLC   K8(K7,R10),OFFLINE IS IT OFFLINE KEYWORD NOW?   @Z30LPTJ 22525803
         BE    NEXTMOD            YES, GO TO IEECB904          @Z30LPTJ 22532803
         CLC   K8(K7,R10),CONSOLE IS IT CONSOLE KEYWORD?       @Z30LPTJ 22534803
         BE    CONFLICT           YES, ISSUE ERROR MESSAGE     @Z30LPTJ 22536803
         LA    R10,K8(R10)        INDEX TO NEXT SET OF RANGE   @Z30LPTJ 22539803
         CLI   K3(R10),HYPHEN     IS 3RD CHARACTER A HYPHEN?   @Z30LPTJ 22546803
         BE    RANGLOOP           YES, CHECK FURTHER           @Z30LPTJ 22553803
         B     TERM               NO, ISSUE ERROR MESSAGE      @Z30LPTJ 22560803
CHECK    EQU   *                                               @Z30LPTJ 22567803
         CLI   K7(R10),RTPAREN    IS IT A RIGHT PARENTHESIS?   @Z30LPTJ 22574803
         BNE   DELIMIT            NO, ISSUE ERROR MESSAGE      @Z30LPTJ 22581803
         CLI   K8(R10),COMMA      IS NEXT CHARACTER A COMMA?   @Z30LPTJ 22588803
         BNE   DELIMIT            NO, ISSUE ERROR MESSAGE      @Z30LPTJ 22595803
         CLC   K9(K6,R10),ONLINE  IS IT ONLINE KEYWORD NOW?    @Z30LPTJ 22602803
         BE    NEXTMOD            YES, GO TO IEECB904          @Z30LPTJ 22609803
         CLC   K9(K7,R10),OFFLINE IS IT OFFLINE KEYWORD NOW?   @Z30LPTJ 22616803
         BE    NEXTMOD            YES, GO TO IEECB904          @Z30LPTJ 22623803
         CLC   K9(K7,R10),CONSOLE IS IT CONSOLE KEYWORD?       @Z30LPTJ 22625803
         BNE   TERM               NO, ISSUE ERROR MESSAGE      @Z30LPTJ 22627803
         EJECT                                                          22630803
************************************************************** @Z30LPTJ 22631803
*                                                            * @Z30LPTJ 22632803
* ERROR MESSAGES ARE ISSUED HERE DUE TO BAD VARY RANGE       * @Z30LPTJ 22633803
* COMMANDS                                                   * @Z30LPTJ 22634803
*                                                            * @Z30LPTJ 22635803
************************************************************** @Z30LPTJ 22636803
CONFLICT EQU   *                                               @Z30LPTJ 22637803
         MVC   XSA(CONFLNG),CONFMSG SET UP MESSAGE BUFFER      @Z30LPTJ 22640803
         B     MSGOUT             GO TO WTO ISSUER             @Z30LPTJ 22644803
TERM     EQU   *                                               @Z30LPTJ 22651803
         MVC   XSA(TERMLNG),TERMMSG SET UP MESSAGE BUFFER      @Z30LPTJ 22658803
         B     MSGOUT             GO TO WTO ISSUER             @Z30LPTJ 22665803
DELIMIT  EQU   *                                               @Z30LPTJ 22672803
         MVC   XSA(DELIMLNG),DELIMMSG SET UP MESSAGE BUFFER    @Z30LPTJ 22679803
MSGOUT   EQU   *                                               @Z30LPTJ 22686803
         SR    R0,R0              CLEAR FOR NEXT INSTRUCTION   @Z30LPTJ 22693803
         TM    XAU,RI             IS THIS FROM INPUT STREAM?   @ZM30445 22695803
         BO    XAUIN1             YES, DON'T INSERT CONSOLE ID @ZM30445 22697803
         IC    R0,XAU             INSERT CONSOLE ID            @Z30LPTJ 22700803
XAUIN1   EQU   *                                               @ZM30445 22703803
         LA    R1,XSA             GET POINTER TO MESSAGE BUFFER@Z30LPTJ 22707803
         WTO   MF=(E,(1))         ISSUE ERROR MESSAGE          @Z30LPTJ 22707903
         LM    R0,R15,K0(R13)     RESTORE REGISTERS            @Z30LPTJ 22716803
         LR    R4,R14             PREPARE FOR RETURN EXECUTION @Z30LPTJ 22718803
         B     NODELETE           PREPARE TO RETURN TO CALLER  @Z30LPTJ 22719803
         EJECT                                                          22721803
************************************************************** @Z30LPTJ 22729803
*                                                            * @Z30LPTJ 22730803
* A GOOD VARY RANGE COMMAND HAS BEEN ISSUED                  * @Z30LPTJ 22731803
*                                                            * @Z30LPTJ 22732803
************************************************************** @Z30LPTJ 22733803
NEXTMOD  EQU   *                                               @Z30LPTJ 22734803
         LR    R10,R14            SAVE RETURN TO CALLER ADDRESS@Z30LPTJ 22735803
         L     R0,WORKAREA        OBTAIN CORE SPECIFICATION    @Z30LPTJ 22749803
         GETMAIN R,LV=(0)         GET THE DATA AREA CORE       @Z30LPTJ 22756803
         LR    R9,R1              SET DATA AREA ADDRESSABILITY @Z30LPTJ 22759803
NEXTMODA EQU   *                                               @Z30LPTJ 22761803
         XC    XAD(K4),XAD        CLEAR XAD ACROSS VARY AREA   @Z30LPTJ 22765803
         XC    XAP(K4),XAP        CLEAR XAP ACROSS VARY AREA   @Z30LPTJ 22767803
         L     R15,VCON904        GET IEECB904 ADDRESS         @Z30LPTJ 22770803
         BR    R15                GO TO VARY RANGE PROCESSOR   @Z30LPTJ 22791803
         EJECT                                                          22819803
************************************************************** @Z30LPTJ 22820803
*                                                            * @Z30LPTJ 22821803
* SECONDARY ENTRY POINT AFTER A VARY RANGE COMMAND HAS BEEN  * @Z30LPTJ 22822803
* PROPAGATED INTO INDIVIDUAL UNITS                           * @Z30LPTJ 22823803
*                                                            * @Z30LPTJ 22824803
************************************************************** @Z30LPTJ 22826803
IEE36ENT EQU   *                                               @Z30LPTJ 22827003
         LR    R14,R10            GET RETURN TO CALLER ADDRESS @Z30LPTJ 22827203
         L     R5,D64(R13)        OBTAIN THE CSCB POINTER      @Z30LPTJ 22848803
         USING CHAIN1,R5          ESTABLISH CSCB ADDRESSABILITY@Z30LPTJ 22849803
         MVC   XAU(K1),CHUCMP     RE-SET UCM ID                @Z30LPTJ 22850803
         MVC   XAS(K2),CHINC      RE-SET R/I AUTHORITY         @Z30LPTJ 22851803
         DROP  R5                                              @Z30LPTJ 22852803
         MVC   XAV(K8),VARY       RE-SET VARY VERB INDICATOR   @Z30LPTJ 22853803
         MVC   XAX(K8),IEE3303D   RE-SET EXIT IDENTIFIER       @Z30LPTJ 22854803
         L     R3,XAL             GET POINTER TO NEW COMMAND   @Z30LPTJ 22855803
         LA    R3,K0(R3)          CLEAR HIGH ORDER BYTE        @Z30LPTJ 22856803
         L     R6,K136(R3)        OBTAIN SAVED XAD             @Z30LPTJ 22857803
         ST    R6,XAD             RESTORE XAD INTO THE XSA     @Z30LPTJ 22858803
         L     R6,K140(R3)        OBTAIN SAVED XAP             @Z30LPTJ 22864803
         ST    R6,XAP             RESTORE XAP INTO THE XSA     @Z30LPTJ 22869803
         LR    R6,R3              NEEDED FOR VARY PROCESSING   @Z30LPTJ 22875803
         LA    R4,D124            RE-ESTABLISH BUFFER SIZE     @Z30LPTJ 22881803
         ST    R4,XAR             PUT INTO XSA SLOT            @Z30LPTJ 22889803
         AR    R4,R6              OBTAIN END OF BUFFER POINTER @Z30LPTJ 22896803
BUFFLOOP EQU   *                                               @Z30LPTJ 22903803
         BCTR  R4,R0              DECREMENT END ADDRESS BY ONE @Z30LPTJ 22906803
         CLI   K0(R4),BLANK       IS THIS CHARACTER A BLANK?   @Z30LPTJ 22910803
         BE    BUFFLOOP           YES, LOOK FOR LAST END BLANK @Z30LPTJ 22917803
         LR    R5,R4              POINTER TO LAST NON-BLANK    @Z30LPTJ 22924803
         SH    R5,FOUR            POINTER TO 'NLINE' OR 'FLINE'@Z30LPTJ 22931803
         TM    XAAVRANG,XAARNG2   ENQ DONE ALREADY?            @Z30LPTJ 22938803
         BO    DIDENQ             YES, PROCESS THE COMMAND     @Z30LPTJ 22957803
ENQBIT   EQU   *                                               @Z30LPTJ 22961803
         OI    XAAVRANG,XAARNG2   TURN ENQ RESOURCE BIT ON     @Z30LPTJ 22965803
         EJECT                                                          22973803
************************************************************** @Z30LPTJ 22977803
*                                                            * @Z30LPTJ 22981803
* COMMON VARY PROCESSING                                     * @Z30LPTJ 22989803
*                                                            * @Z30LPTJ 22993803
************************************************************** @Z30LPTJ 23000003
ONVARY   EQU   *                                               @Z30LPTJ 23006003
         CLC   K0(K5,R5),FLINE    IS IT AN OFFLINE COMMAND?      Y02669 23012003
         BE    OFFLENQ            YES, DO ENQ FOR THIS COMMAND @YM5443P 23020003
         CLC   K0(K5,R5),NLINE    IS IT AN ONLINE COMMAND?     @YM5443P 23040003
         BE    ONLENQ             YES, DO ENQ FOR THIS COMMAND @YM5443P 23060003
         LA    R11,K5             OBTAIN MAXIMUM CTR COMPRAND  @YM5443P 23080003
         LA    R10,K1             SET INCREMENTER TO ONE       @YM5443P 23100003
         LR    R9,R10             SET COUNTER TO ONE           @YM5443P 23120003
         ENQ   MF=(E,IEFSCONA)                                 @YM5443P 23160003
LOOPENQ  EQU   *                                               @YM5443P 23180003
         XC    ECBAREA(K4),ECBAREA CLEAR ECB AREA              @YM5443P 23190003
         MVC   ENQMVC(ENQLNTH),IEFSCONB                        @YM5443P 23200003
         LA    R1,ENQMVC                                       @YM5443P 23220003
         ENQ   MF=(E,(1)),ECB=ECBAREA                          @YM5443P 23240003
         LTR   R15,R15            IS RESOURCE OBTAINED?        @YM5443P 23260003
         BZ    DIDENQ             YES,EXIT                     @YM5443P 23280003
         STIMER WAIT,DINTVL=TIMELOC NO, WAIT 5 SECONDS?        @ZA09414 23300003
         TM    ECBAREA,ECBPOST    ECB POSTED?                  @YM5443P 23320003
         BO    DIDENQ             YES,EXIT                     @YM5443P 23340003
         DEQ   MF=(E,IEFSCONC)    NO, DEQUEUE                  @YM5443P 23360003
         BXLE  R9,R10,LOOPENQ     FIFTH ENQUEUE ATTEMPTED?     @YM5443P 23380003
REISSUE  EQU   *                  SET UP TO ISSUE WTOR         @ZA09166 23400803
         MVC   IEE799D(IEE799L),IEE799B MOVE LIST FORM TO DSECT@ZA09166 23401603
         SR    R0,R0              CLEAR WORK REGISTER          @ZA09166 23402403
         ST    R0,ECBAREA         CLEAR THE ECB                @ZA09166 23403203
         TM    XAU,RI             IS THE CMD FROM INPUT STREAM @ZA09166 23404003
         BO    NOCNSID            YES, NO CONSOLE ID NEEDED    @ZA09166 23404803
         IC    R0,XAU             GET THE CONSOLE ID           @ZA09166 23405603
NOCNSID  EQU   *                  ISSUE THE WTOR               @ZA09166 23406403
         WTOR   ,RPYAREA,6,ECBAREA,MF=(E,IEE799) ISSUE MSG     @ZA09166 23407203
         WAIT  ECB=ECBAREA        WAIT FOR A REPLY             @ZA09166 23408003
         OC    RPYAREA(L'RPYAREA),BLANKS CAPITALIZE REPLY      @ZA09166 23408803
         CLC   RPYAREA(L'CANCEL),CANCEL IS REPLY CANCEL        @ZA09166 23409603
         BNE   NOTCANCL           YES, EXIT THIS MODULE        @ZA09166 23410403
         SR    R0,R0               CLEAR R0 FOR CONS. ID       @ZA09166 23410503
         TM    XAU,RI              IS THIS FROM INPUT STREAM   @ZA09166 23410603
         BO   NOCNSID1             YES, DON'T INSERT CONSOLE ID@ZA09166 23410703
         IC    R0,XAU              CONSOLE ID FOR WTO          @ZA09166 23410803
NOCNSID1 EQU   *                                               @ZA09166 23410903
         WTO   MF=(E,IEE756I)      ISSUE VARY CNACELLED MSG    @ZA09166 23411003
         B     IEE36050            TERMINATE THE VARY COMMAND  @ZA09166 23411103
NOTCANCL EQU   *                                               @ZA09166 23411203
         CLC   RPYAREA(L'RETRY),RETRY IS REPLY RETRY           @ZA09166 23411903
         BNE   NOTRETRY           NO, CHECK FOR WAIT           @ZA09166 23412003
         LA    R11,K5             GET COUNTER FOR ENQ LOOP     @ZA09166 23412803
         LA    R10,K1             GET INCREMENT FOR ENQ LOOP   @ZA09166 23413603
         LR    R9,R10             START COUNT AT ONE           @ZA09166 23414403
         XC    ECBAREA(L'ECBAREA),ECBAREA CLEAR THE ECB        @ZA09166 23415203
         B     LOOPENQ            TRY THE ENQ LOOP AGAIN       @ZA09166 23416003
NOTRETRY EQU   *                  REPLY NOT RETRY, CHECK WAIT  @ZA09166 23416803
         CLC   RPYAREA(L'WAIT),WAIT WAS REPLY WAIT             @ZA09166 23417603
         BNE   REISSUE            NO, REISSUE WTOR             @ZA09166 23418403
         ENQ   MF=(E,IEFSCOND)    YES, OBTAIN RESOURCE         @YM5443P 23419203
         B     DIDENQ                                          @YM5443P 23420003
OFFLENQ  EQU   *                                               @YM5443P 23440003
         ENQ   MF=(E,IEFSOFFA)                                 @YM5443P 23460003
         ENQ   MF=(E,IEFSOFFB)                                 @YM5443P 23480003
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 23490003
         BO    DIDENQ             YES, PROCESS THE COMMAND     @Z30LPTJ 23500003
         B     IEE360D0           EXIT TO IEE3303D             @YM5443P 23520003
ONLENQ   EQU   *                                               @YM5443P 23540003
         ENQ   MF=(E,IEFSDONA)                                 @YM5443P 23560003
         ENQ   MF=(E,IEFSDONB)                                 @YM5443P 23580003
DIDENQ   EQU   *                                               @YM5443P 23600003
         SR    R4,R6               CALCULATE LENGTH OF OPERANDS         23620003
         BCTR  R6,R0               DECREMENT BUFFER ADDRESS             23640003
         SPACE 1                                                        24000000
         BAL   R14,IEE36140        LINK TO FIND NEXT TERM LGTH          24200000
         LA    R7,K0(R5,R6)        GET ADDR OF CHAR AFTER TERM          24400000
         BAL   R11,IEE36120        SEE IF SINGLE VALID TERM             25800002
         BNE   IEE36060            IF NOT, CHECK FOR MULT TERMS         26000000
         SPACE 1                                                        26200000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         26400000
*                                                             *         26600000
* VERIFY PATHS FOR SINGLE OPERAND (DEVICE) SPECIFIED          *         26800000
*                                                             *         27000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         27200000
         SPACE 1                                                        27400000
         BAL   R10,IEE360E0        SEE IF UNIT HAS GOOD PATHS           27600000
         B     IEE360D0            IF SO, TAKE NORMAL EXIT              27800000
         EJECT                                                          28000003
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         28200000
*                                                             *         28400000
* ERROR EXIT CODE (RETURN TO SYSTEM                           *         28600002
*                                                             *  Y02669 28800002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         29000000
         SPACE 1                                                        29200000
IEE36050 EQU   *                                                 Y02651 29250002
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 29250403
         BNO   IEEDEQUE           NO, AVOID EXIT TO IEECB904   @Z30LPTJ 29250803
         OI    XAAVRANG,XAARNG3   TURN TERMINATION BIT ON      @Z30LPTJ 29251603
         LM    R0,R15,K0(R13)     RESTORE REGISTERS            @Z30LPTJ 29252003
         B     NEXTMODA           EXIT VIA IEECB904            @Z30LPTJ 29256003
         SPACE 2                                                        29260003
IEE36904 EQU   *                                               @Z30LPTJ 29261003
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 29262003
         BO    NEXTMODA           YES, PROCESS MORE UNITS      @Z30LPTJ 29263003
         SPACE 2                                                        29264003
*****************************************************************Y02651 29265003
*                                                                Y02651 29270002
*  SINCE THIS IS A TERMINAL EXIT WE MUST DEQUE OFF BEFORE GETTINGY02651 29280002
*  OUT OF THIS COMMAND PROCESSOR                                 Y02651 29292002
*                                                                Y02541 29294002
IEEDEQUE EQU   *                                                 Y02651 29296002
         DEQ   MF=(E,IEFDEQUE)                                   Y02651 29298002
*                                                                Y02651 29298402
*****************************************************************Y02651 29300002
         SPACE 5                                                        29360003
         LM    R0,R15,K0(R13)           RESTORE REGS             Y02669 29370002
         LR    R4,R14             SAVE RET ADDRESS               Y02669 29410002
         L     R15,XAP            GET IEEVDEV ADDRESS          @Z30LPTJ 29413003
         LTR   R15,R15            IS THERE AN ADDRESS?         @Z30LPTJ 29416003
         BZ    NODELETE           NOPE, NO DELETE REQUIRED     @Z30LPTJ 29419003
         XC    XAP(K4),XAP        MUST ISSUED DELETE FOR VDEV  @Z30LPTJ 29422003
         DELETE EP=IEEVDEV                                     @Z30LPTJ 29425003
         L     R1,XAD             ADDR OF VDEV PARAM CORE      @Z30LPTJ 29428003
         LTR   R1,R1              ANY PTR?, JUST IN CASE       @Z30LPTJ 29431003
         BZ    NODELETE           NOPE, NOTHING TO FREE        @Z30LPTJ 29434003
         LA    R0,TREE08         SIZE OF THAT CORE             @Z30LPTJ 29437003
         FREEMAIN R,LV=(0),A=(1)                               @Z30LPTJ 29440003
         XC    XAD(K4),XAD        ZERO OUT CORE PTR            @Z30LPTJ 29443003
NODELETE EQU   *                                               @Z30LPTJ 29446003
         L     R0,IEE36GMP        3603D WORK AREA SIZE         @Z30LPTJ 29455003
         LR    R1,R8              AND POINTER                  @Z30LPTJ 29458003
         FREEMAIN R,LV=(0),A=(1)                               @Z30LPTJ 29461003
         L     R1,D64(R13)        CSCB PTR                       Y02669 29480003
         USING CHAIN1,R1                                         Y02669 29510002
         OI    CHSTS,CHFC         SET - FREE CSCB BIT            Y02669 29560002
         MGCR  (1),CHAIN                                         Y02669 29570002
         LA    R0,D132            CORE GOTTEN FOR VARY = SIZE    Y02669 29587202
         LR    R1,R2              POINTER INTO REG1              Y02669 29590002
      FREEMAIN R,LV=(0),A=(1)      FREE UP WORK/SAVE AREA               29600000
         LR    R14,R4             RESTORE RETURN REG             Y02669 29760002
         BR    R14                 EXIT - NO VARY ONLINE DONE           29800000
         EJECT                                                          30000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         30200000
*                                                             *         30400000
* LOOP TO CHECK SYNTAX OF EACH TERM                           *         30600000
*   EXIT - TO IEE360D0 FOR ANY INVALID TERM                   *         30800000
*        - TO IEE36080 (NSI) IF ALL TERMS ARE VALID           *         31000000
*                                                             *         31200000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         31400000
         SPACE 1                                                        31600000
IEE36060 LR    R6,R3               GET PTR TO BEG OF OPERANDS           31800000
         SPACE 1                                                        32000000
IEE36070 BAL   R11,IEE36110        LINK TO VALIDATE NEXT TERM           32200000
         BNE   IEE360D0            TAKE NORMAL EXIT ON INV TERM         32400000
         ALR   R6,R5               UPDATE INDEX TO NEXT TERM            32600000
         CLC   K0(K2,R6),IEE36END  SEE IF DELIMETED BY C'),'            32800000
         BNE   IEE36070            LOOP UNTIL END OF LIST FOUND         33000000
         SPACE 1                                                        33200000
         LR    R6,R3               GET PTR TO BEG OF OPERANDS           33400000
         SPACE 1                                                        33600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         33800000
*                                                             *         34000000
* LOOP TO VERIFY PATHS FOR EACH OPERAND (DEVICE) SPECIFIED    *         34200000
*                                                             *         34400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         34600000
         SPACE 1                                                        34800000
IEE36080 BAL   R14,IEE36140        LINK TO LOCATE NEXT TERM             35000000
         BAL   R10,IEE360E0        LINK TO CHECK UNIT'S PATHS           35200000
         SPACE 1                                                        35400000
         B     IEE360B0            UPDATE INDEX FOR GOOD PATH           35600000
         SPACE 1                                                        35800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         36000000
*                                                             *         36200000
* CODE TO DELETE UNIT HAVING NO PATHS FROM THE XSA            *         36400000
*                                                             *         36600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         36800000
         SPACE 1                                                        37000000
         SLR   R4,R5               SUBTR LGTH TO DELETE FR TOTL         37200000
         LA    R7,K1(R6,R4)        GET ADDR OF NEW END OF BUFFR         37400000
         LA    R9,K0(R5,R6)        GET ADDR OF NEXT TERM                37600000
         EX    R4,IEE36090         OVERLAY DELETED TERM                 37800000
         BCTR  R5,R0               DECREMENT LENGTH BY ONE              38000000
         BCTR  R5,R0               DECREMENT LENGTH BY ONE              38200000
         MVI   K0(R7),X40          MOVE BLANK INTO END OF BUFFR         38400000
         EX    R5,IEE360A0         BLANK OUT END OF BUFFER              38600000
         B     IEE360C0            GO TO SEE IF FINISHED                38800000
         SPACE 1                                                        39000000
IEE36090 MVC   K0(K0,R6),K0(R9)    EX TO OVERLAY DELETED UNIT           39200000
IEE360A0 MVC   K1(K0,R7),K0(R7)    EX TO BLANK REMAINDER OF BUF         39400000
         EJECT                                                          39600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         39800000
*                                                             *         40000000
* CODE TO UPDATE INDEX, LEAVING GOOD UNIT IN THE XSA          *         40200000
*                                                             *         40400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         40600000
         SPACE 1                                                        40800000
IEE360B0 MVI   K0(R3),X4D          SET SWITCH FOR GOOD UNIT             41000000
         ALR   R6,R5               UPDATE OPERANDS INDEX                41200000
         SLR   R4,R5               DECREMENT REMAINING LENGTH           41400000
         SPACE 1                                                        41600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         41800000
*                                                             *         42000000
* CODE TO LOOP UNTIL SCAN IS COMPLETE                         *         42200000
*   EXIT - TO IEE36080 IF SCAN IS NOT COMPLETE                *         42400000
*        - TO IEE360D0 (NSI) IF ANY UNIT IS LEFT IN THE XSA   *         42600000
*        - TO IEE36050 IF NO UNIT IS LEFT IN THE XSA          *         42800000
*                                                             *         43000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         43200000
         SPACE 1                                                        43400000
IEE360C0 CLI   K0(R6),X5D          SEE IF SCAN IS COMPLETE              43600000
         BNE   IEE36080            LOOP UNTIL SCAN IS COMPLETED         43800000
         CLI   K0(R3),X4D          SEE IF ANY TERMS LEFT IN XSA         44000000
         BNE   IEE36904            IF NOT, IGNORE THE COMMAND  @Z30LPTJ 44200003
        SPACE 1                                                         44400003
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         44600000
*                                                             *         44800000
* NORMAL EXIT CODE (EXIT TO VARY COMMAND PROCESSOR)           *  Y02669 45000002
*                                                             *         45200002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         45400000
         SPACE 1                                                        45600000
IEE360D0 EQU   *                                                 Y02669 45650002
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 45660003
         BO    EXIT33             YES, DO NOT FREE AREAS       @Z30LPTJ 45670003
         LR    R1,R8              3603D'S WORK AREA POINTER      Y02669 45700002
         L     R0,IEE36GMP        AND ITS SIZE                   Y02669 45750002
      FREEMAIN R,LV=(0),A=(1)      FREE UP WORK/SAVE AREA               46000000
         L     R15,XAP                                           Y02669 46010002
         LTR   R15,R15            DID WE EVER LOAD IEEVDEV?      Y02669 46020002
         BZ    EXIT33             NOPE, NO DELETE REQUIRED       Y02669 46030002
         XC    XAP(K4),XAP        WE MUST DELETE VDEV FIRST      Y02669 46040002
         DELETE EP=IEEVDEV                                       Y02669 46042002
         L     R1,XAD             GET ADDR OF VDEV PARAM CORE    Y02669 46042402
         LTR   R1,R1              ANY PTR, JUST IN CASE          Y02669 46042802
         BZ    EXIT33             NOPE, NOTHING TO FREE          Y02669 46043202
         LA    R0,TREE08         GET SIZE INTO R0               YM01603 46043602
         FREEMAIN R,LV=(0),A=(1)                                 Y02669 46043702
         XC    XAD(K4),XAD        ZERO PARAM PTR                 Y02669 46043802
EXIT33   EQU   *                                                 Y02669 46044002
         L     R15,VCON33         ADDRESS OF IEE3303D          @Z30LPTJ 46047003
         LM    R0,R14,K0(R13)     RESTORE THE REGISTERS        @Z30LPTJ 46050003
         BR    R15                EXIT TO 3303D                  Y02669 46150002
         EJECT                                                          46400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         46600000
*                                                             *         46800000
* ROUTINE TO SET INDEX AND LINK TO CHECK PATHS FOR AN OPERAND *         47000000
*   EXIT - TO K0(R10) IF TERM IS SATISFACTORY (GOOD PATHS)    *         47200000
*        - TO K4(R10) IF TERM SHOULD BE REJECTED (NO PATHS)   *         47400000
*                                                             *         47600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         47800000
         SPACE 1                                                        48000000
IEE360E0 LR    R7,R6               GET PATH TEST OPERAND INDEX          48200000
         CLC   K1(K3,R7),IEE36CIN  SEE IF COMPOSITE CONSOLE    @ZM30436 48800003
         BE    IEE36100            IF SO, GO TEST BOTH UNITS            49000000
         CLC   K1(K2,R7),IEE36OUT  SEE IF OUTPUT-ONLY CONSOLE  @ZM30479 49200003
         BNE   IEE360F0            IF NOT, GO TEST NON-MCS UNIT         49400000
         LA    R7,K2(R7)           UPDATE INDEX FOR O-UNIT              49600000
IEE360F0 BAL   R11,IEE361A0        LINK TO TEST UNIT'S PATHS            49800000
         LTR   R15,R15            DOES THE UNIT HAVE A PATH?     Y02669 49850002
         BNZ   K4(R10)            NOPE, OMIT THIS UNIT           Y02669 49900002
         BR    R10                 ELSE TAKE A NORMAL EXIT              50200000
IEE36100 LA    R7,K3(R7)           UPDATE INDEX FOR I-UNIT              50400000
         BAL   R11,IEE361A0        LINK TO CHECK I-UNIT'S PATHS         50600000
         ST    R15,D68(R13)   STORE RET CODE FOR FUTURE USE      Y02669 50650002
         LA    R7,K6(R7)           UPDATE TEST INDEX FOR O-UNIT         50800000
         BAL   R11,IEE361A0        LINK TO CHECK O-UNIT'S PATHS         51000000
         BALR  R7,R0               SAVE CONDITION CODE BITS             51200000
         LTR   R15,R15            IS THE O-UNIT PATHABLE?        Y02669 51250002
         BNZ   K4(R10)            NOPE, OMIT THIS COMPOSITE      Y02669 51300002
         L     R15,D68(R13)    GET CODE FROM I-UNIT              Y02669 51350002
         LTR   R15,R15            IS THE I-UNIT PATHABLE?        Y02669 51360002
         BNZ   K4(R10)            NOPE, OMIT THIS COMPOSITE UNIT Y02669 51370002
         BR    R10           YES, ALL IS OK WITH THIS UN IT      Y02669 51380002
         EJECT                                                          52800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         53000000
*                                                             *         53200000
* ROUTINE TO VALIDATE SYNTAX OF SPECIFIED TERM                *         53400000
*   EXIT - CC=0 ONLY IF SYNTAX OF TERM IS VALID               *         53600000
* THE FOLLOWING TERMS ARE CONSIDERED VALID                    *         53800000
*        DDD      - ANY I/O DEVICE DDD                        *         54000000
*       DDD/B     - BIN B OF DATA CELL DDD                    *         54200000
*       O-DDD     - OUTPUT-ONLY CONSOLE DDD                   *         54400000
*   (I-DDD,O-DDD) - COMPOSITE CONSOLE DDD/DDD                 *         54600000
*                                                             *         54800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         55000000
         SPACE 1                                                        55200000
IEE36110 BAL   R14,IEE36140        LINK TO IDENTIFY NEXT TERM           55400000
IEE36120 CH    R5,IEE36H04         SEE IF LENGTH IS 4                   55600000
         BCR   BE,R11              IF SO, EXIT (VALID TERM)             55800000
         CH    R5,IEE36H06         SEE IF LENGTH IS 6                   56000000
         BNE   IEE36130            IF NOT, CHECK FOR COMPOS CON         56200002
         CLC   K1(K2,R6),IEE36OUT  SEE IF OUTPUT-ONLY CONSOLE           56800000
         BR    R11                 EXIT (VALID OR INVALID TERM)         57000000
IEE36130 CH    R5,IEE36H14         SEE IF LENGTH OF TERM IS 14          57200000
         BCR   BNE,R11             IF NOT, EXIT (INVALID TERM)          57400000
         CLC   K1(K3,R6),IEE36CIN  SEE IF BEGIN WITH C'(I-'             57600000
         BCR   BNE,R11             IF NOT, EXIT (INVALID TERM)          57800000
         CLC   K7(K3,R6),IEE36COU  SEE IF 6TH ON ARE C',O-'             58000000
         BCR   BNE,R11             IF NOT, EXIT (INVALID TERM)          58200000
         CLI   K13(R6),X5D         SEE IF LAST CHAR IS C')'             58400000
         BR    R11                 EXIT (VALID OR INVALID TERM)         58600000
         EJECT                                                          58800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         59000000
*                                                             *         59200000
* ROUTINE TO LOCATE NEXT COMMA NOT WITHIN PARENTHESES         *         59400000
*   EXIT - TO IEE360D0 IF SCAN EXCEEDS LOGICAL END OF BUFFER  *         59600000
*        - TO IEE360D0 IF MORE THAN 2 LEVELS OF PARENTHESES   *         59800000
*        - TO K0(R14) IF COMMA NOT WITHIN PARENTHESES LOCATED *         60000000
*        - TO K0(R14) IF UNPAIRED PARENTHESES ENCOUNTERED     *         60200000
*                                                             *         60400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         60600000
         SPACE 1                                                        60800000
IEE36140 STM   R9,R11,K8(R8)      SAVE WORK REGISTER CONTENTS    Y02669 61000002
         SR    R9,R9               ZERO PARENTHESES COUNTER             61200000
         LA    R10,K1              INITIALIZE BXLE INCREMENT            61400000
         LA    R11,K0(R4,R6)       INITIALIZE BXLE COMPARAND            61600000
         LR    R5,R6               INITIALIZE OPERANDS INDEX            61800000
IEE36150 CLI   K1(R5),X4D          SEE IF NEXT CHAR IS C'('             62000000
         BE    IEE36170            IF SO, ADD 1 TO PAREN COUNTR         62200000
         CLI   K1(R5),X5D          IF NOT, SEE IF IT IS C')'            62400000
         BE    IEE36180            IF SO, DECREM PAREN COUNTER          62600000
         CLI   K1(R5),X6B          SEE IF IT IS A COMMA                 62800000
         BNE   IEE36160            IF NOT, KEEP SEARCHING               63000000
         LTR   R9,R9               SEE IF COMMA IS WITHIN ( )'S         63200000
         BZ    IEE36190            IF NOT, EXIT-END OF TERM FND         63400000
IEE36160 BXLE  R5,R10,IEE36150     LOOP TO CHECK NEXT CHARACTER         63600000
         B     IEE360D0            NORMAL EXIT IF END OF BUFFER         63800000
IEE36170 CR    R9,R10              SEE IF MORE THAN 2 LEVELS ()         64000000
         BH    IEE360D0            IF SO, TAKE A NORMAL EXIT            64200000
         BXLE  R9,R10,IEE36160     IF NOT, INC PAREN COUNT,LOOP         64400000
IEE36180 SR    R9,R10              DECREMENT PAREN COUNTER              64600000
         BNM   IEE36160            LOOP IF ()'S ARE PAIRED              64800000
IEE36190 SLR   R5,R6               CALCULATE LENGTH OF TERM             65000000
         ALR   R5,R10                  UPDATE LENGTH BY ONE             65200000
         LM    R9,R11,K8(R8)       RESTORE THE WORK REGISTERS    Y02669 65400002
         BR    R14                 RETURN WITH LGTH IN REG R5           65600000
         EJECT                                                          65800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         66100002
*                                                             *         66400002
*  ROUTINE TO VALIDATE GOOD PATHS FOR DDD AT DISPL K1(R7)     *         66700002
*                                                             *         67000002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         67300002
IEE361A0 EQU   *                                                 Y02669 67850002
         STM   R0,R6,K8(R8)                                      Y02669 67900002
         MVC   IOSAREA+K5(K3),K1(R7) MOVE UNIT INTO WORK AREA  @YM3411P 68060002
         LA    R3,K9               ESTABLISH ADDER OF 9        @YM3411P 68060902
         LA    R5,K3               ESTABLISH BYTE COUNTER      @YM3411P 68061502
TRILOOP  LA    R6,IOSAREA+K4(R5)   GET CURRENT BYTE ADDRESS    @YM3411P 68062102
         TM    K0(R6),XF0          IS IT NUMERIC?              @YM3411P 68062702
         BO    AROUND              YES, BRANCH                 @YM3411P 68063302
         CLI   K0(R6),XC1          NO, IS IT BELOW 'A'?        @YM3411P 68063902
         BL    UNITMSG             YES, ERROR EXIT             @YM3411P 68064502
         CLI   K0(R6),XC6          NO, IS IT ABOVE 'F'?        @YM3411P 68065402
         BH    UNITMSG             YES, ERROR EXIT             @YM3411P 68067202
         IC    R4,K0(R6)           NO, PREPARE FOR ADDITION    @YM3411P 68068202
         AR    R4,R3               CHANGE NUMBER TO ALPHA      @YM3411P 68070002
         STC   R4,IOSAREA+K4(R5)   STORE BACK INTO WORKAREA    @YM3411P 68072002
AROUND   BCT   R5,TRILOOP          THREE BYTES DONE?           @YM3411P 68074002
         PACK  IOSAREA(K4),IOSAREA+K5(K3) YES, TAKE OUT ZONES  @YM3411P 68076002
         L     R6,IOSAREA          PREPARE FOR IOSGEN MACRO    @YM3411P 68078002
         SRL   R6,K4               SHIFT OUT SIGN BIT          @YM3411P 68080002
         LR    R9,R13              SAVE SAVE AREA POINTER      @YM3411P 68110002
         LR    R1,R7               SAVE BUFFER POINTER         @YM3411P 68140002
         LA    R13,IOSAREA         POINTER TO IOSGEN SAVE AREA @YM3411P 68170002
         IOSGEN UCBLOOK            SCAN FOR SPECIFIED UCB      @YM3411P 68200002
         LR    R13,R9              RESTORE SAVE AREA POINTER   @YM3411P 68250002
         LR    R9,R7               PUT UCB ADDRESS INTO R9     @YM3411P 68260002
         LR    R7,R1               RESTORE BUFFER POINTER      @YM3411P 68270002
         LTR   R15,R15             RETURN CODE 0?              @YM3411P 68300002
         BNZ   UNITMSG             NO, ISSUE ERROR MESSAGE     @YM3411P 68350002
         USING OUCB,R9             YES, ESTABLISH UCB BASE     @YM3411P 68450002
         TM    UCBWGT,UCBMTPXP     SUB-UCB'S EXIST?            @YM3411P 68550002
         BNO   GOODUCB             NO, BRANCH                  @YM3411P 68650002
         L     R1,UCBBASE          YES, GET MASTER UCB ADDRESS @YM3411P 68750002
         LA    R1,D512(R1)         GET POINTER TO BASE UCB     @YM3411P 68850002
         CR    R9,R1               DOES UCB ADDRESSES MATCH?   @YM3411P 68900002
         BNE   UNITMSG             NO, ISSUE ERROR MESSAGE     @YM3411P 68950002
GOODUCB  EQU   *                   YES, PROCEED WITH EXECUTION @YM3411P 69050002
************************************************************** @Z30LPTJ 69060003
*                                                            * @Z30LPTJ 69070003
* IF VARY RANGE IS PRESENT, INCREMENT GOOD UNIT COUNTER FOR  * @Z30LPTJ 69080003
* THE DISPLAY UNIT COMMAND WHICH WILL BE ISSUED AT THE END   * @Z30LPTJ 69090003
* OF THE VARY RANGE PROCESS.  IF THE UCB INDICATES THAT THIS * @Z30LPTJ 69100003
* IS AN ALTERNATE PATH, OR IS A DEVICE WITHOUT AN UCB DEVICE * @Z30LPTJ 69102003
* NAME, THE COUNT IS NOT INCREMENTED.  INSTEAD A BIT IS      * @Z30LPTJ 69103003
* MARKED AND AIDS IN THE OUTPUT FROM IEECB904.               * @Z30LPTJ 69104003
*                                                            * @Z30LPTJ 69110003
************************************************************** @Z30LPTJ 69120003
         TM    XAAVRANG,XAARNG1    VARY RANGE BEING PROCESSED? @Z30LPTJ 69130003
         BNO   GOODUCB1            NO, PROCEED NORMALLY        @Z30LPTJ 69200003
         CLC   UCBNAME(K3),K1(R7)  DOES UCB NAMES MATCH?       @Z30LPTJ 69220003
         BNE   ALTMARK             NO, DO NOT INCLUDE IN COUNT @Z30LPTJ 69240003
         SR    R1,R1               PREPARE FOR NEXT INSTRUCTION@Z30LPTJ 69247003
         C     R1,UCBTYP           DEVICE TYPE INFO. PRESENT?  @Z30LPTJ 69254003
         BE    ALTMARK             NO, DO NOT INCLUDE IN COUNT @Z30LPTJ 69261003
         L     R1,XAL              GET VARY RANGE BUFFER @     @Z30LPTJ 69270003
         LH    R6,K130(R1)         GET VALID UNIT COUNTER      @Z30LPTJ 69340003
         LA    R6,K1(R6)           INCREMENT IT BY ONE         @Z30LPTJ 69410003
         STH   R6,K130(R1)         STORE THE COUNTER           @Z30LPTJ 69480003
         B     GOODUCB1            AVOID BIT SETTING           @Z30LPTJ 69490003
ALTMARK  EQU   *                                               @Z30LPTJ 69500003
         OI    XAAVRANG,XAARNG5    INDICATE A NON-COUNTED      @Z30LPTJ*69510003
                                    DEVICE                     @Z30LPTJ 69530003
GOODUCB1 EQU   *                                               @Z30LPTJ 69550003
         CLI   UCBTBYT3,UCB3UREC   TEST FIRST BYTE FOR DSM     @Z30LPTJ 69560003
         BNE   GOODUCB2            DATA STAGING MANAGER NOT UP @Z30LPTJ 69570003
         CLI   UCBTBYT4,UCBDSM     TEST SECOND BYTE FOR DSM    @Z30LPTJ 69580003
         BE    SS1MSG              IT IS A DSM, PUT OUT MSG.   @Z30LPTJ 69590003
GOODUCB2 EQU   *                                               @Z30LPTJ 69600003
         TM    UCBSTAT,UCBONLI     IF DEV IS ONLINE, THEN THERE  Y02669 69650002
         BO    IEE36200            IS NOT REASON TO CHECK PATHS  Y02669 69700002
         TM    XAAVRANG,XAARNG1    VARY RANGE BEING PROCESSED? @Z30LPTJ 69750003
         BNO   CHKPATH             NO, PROCEED NORMALLY        @Z30LPTJ 69800003
         TM    XAAVRANG,XAARNG4    OFFLINE BEING PROCESSED?    @Z30LPTJ 69850003
         BNO   IEE36200            YES, AVOID CHECKING PATHS   @Z30LPTJ 69900003
CHKPATH  EQU   *                                               @Z30LPTJ 69950003
         L     R1,XAD             PTR TO CORE FOR VDEV           Y02669 70050002
         LTR   R1,R1              CORE GOTTEN BEFORE?            Y02669 70100002
         BNZ   GOTBEFOR           WE ALREADY HAVE IT             Y02669 70150002
         GETMAIN R,LV=308       CORE FOR IEEVDEV SUBROUTINE     YM01603 70250002
         ST    R1,XAD             STORE FOR FUTURE USE           Y02669 70260002
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 70262003
         BNO   GOTBEFOR           NO, AVOID SAVING XAD         @Z30LPTJ 70264003
         L     R5,XAL             GET VARY RANGE BUFFER        @Z30LPTJ 70266003
         ST    R1,K136(R5)        SAVE XAD INTO BUFFER SLOT    @Z30LPTJ 70268003
GOTBEFOR EQU   *                                                 Y02669 70270002
         ST    R14,TWELV(R1)      STORE RETURN ADDRESS           Y02669 70300002
         ST    R13,SIXTEEN(R1)    SAVE 3603D'S SAVE AREA PTR    YM01603 70310002
         LA    R14,FOR(R1)        GET ADDR OF PARAM LST ITSELF   Y02669 70350002
         ST    R14,ZERO(R1)       STORE ADDR IN PARAMLIST PTR    Y02669 70360002
         XC    FOR(EIT,R1),FOR(R1)                               Y02669 70370002
*  BYTE ONE OF THE SECND WORD OF THE PARAMLIST HAS A X'00'       Y02669 70380002
*  THIS IS A FUNCTION CODE = VARY ONLINE AND CONSOLE             Y02669 70390002
*  PROCESSING                                                    Y02669 70392002
         ST    R9,FOR(R1)         UCB PTR INTO WORD 1            Y02669 70394002
         LA    R13,TWENTY(R1)   INIT R13 TO IEEVDEV'S SAVE AREA YM01603 70394102
         L     R15,XAP            XAP IS 0 IF NO LOAD FOR VDEV   Y02669 70394402
*                                 WAS EVER DONE BEFORE,OR IT WILLY02669 70394602
         LTR   R15,R15            HAVE THE ADDR IF LOAD DONE     Y02669 70394802
         BNZ   EXTVDEV                                           Y02669 70395202
*                                 FOUND ADDR OF VDEV, NO LOAD    Y02669 70395602
         LR    R6,R1              SAVE PTR TO PARAM IN REG6(TEMP)Y02669 70396002
         LOAD  EP=IEEVDEV                                        Y02669 70398002
         LR    R1,R6              RESTORE PARAM LIST PTR         Y02669 70398402
         LR    R15,R0             SUBROUTINE'S ADDRES INTO R15   Y02669 70398802
         ST    R15,XAP            STORE FOR FUTURE USE           Y02669 70398902
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 70399003
         BNO   EXTVDEV            NO, AVOID SAVING XAP         @Z30LPTJ 70404003
         L     R5,XAL             GET VARY RANGE BUFFER        @Z30LPTJ 70409003
         ST    R15,K140(R5)       SAVE XAP INTO BUFFER SLOT    @Z30LPTJ 70414003
EXTVDEV  EQU   *                                                 Y02669 70419003
         BALR  R14,R15            GO TO SUBROUTINE TO CHECK      Y02669 70424003
*                                 PATH TO THIS DEVICE            Y02669 70429003
         LR    R6,R15             SAVE RETURN CODE FROM SUBRTN   Y02669 70434003
         L     R14,TWELV(R1)      RESTORE CALLERS ADDRESS        Y02669 70439003
         L     R13,SIXTEEN(R1) REINIT R13 TO PTR TO 3603D'S SAVEYM01603 70449802
         SR    R15,R15                                           Y02669 70471902
         LTR   R6,R6              IS PATH TO DEVICE AVAILABLE    Y02669 70479902
         BZ    IEE36200           YES, ALL IS OK FOR THIS DEV.   Y02669 70489902
         MVC   IEE36MSG(LENG),IEE36INT INITIALIZE MSG BUFFER   @YM3411P 70490102
         LA    R15,K4             CHECK FOR RETCODE OR 4         Y02669 70490302
         CR    R6,R15             IS IT RETCODE OF 4?            Y02669 70490702
         BE    NOPATHB            YES, NO LOGICAL PATH         @YM3369P 70491102
         LA    R15,K12            CHECK RETCODE OR 12            Y02669 70491502
         CR    R6,R15             IS IT 12? NO PATH AGAIN.       Y02669 70491602
         BE    NOPATHA            YES, NO PHYSICAL PATH        @YM3369P 70491702
         LA    R15,K8             CHECK RETCODE OR 8             Y02669 70491802
         CR    R6,R15             IS IT 8? INSUF CORE?           Y02669 70541802
         BE    INSUFCOR           YES, ABORT COMMAND             Y02669 70551802
         L     R1,XAD             DEVICE IS IN USE BY SYSTEM   @YM07231*70571802
                                   COMPONENT                   @YM07231 70576802
*                                 GET CORE PTR TO MSG            Y02669 70581802
         LA    R1,TWENTY(R1)      INDEX TO MSG BUFFER            Y02669 70583802
         MVC   K0(COMPLN,R1),COMPMSG MOVE MESSAGE              @YM07231 70585802
         MVC   K12(K3,R1),K1(R7)  MOVE IN UNIT NAME              Y02669 70587802
         B     MESSG              GO ISSUE MSG                   Y02669 70589802
INSUFCOR EQU   *                  INSUFF CORE FOR PROCC          Y02669 70590202
         LA    R1,INSUFMSG        GET PTR TO MSG                 Y02669 70590602
         SR    R0,R0              CLEAR R0 FOR CONSOLE ID        Y02669 70591002
         TM    XAU,RI             IS THIS FROM INPUT STREAM?   @ZM30445 70591103
         BO    XAUIN2             YES, DON'T INSERT CONSOLE ID @ZM30445 70591203
         IC    R0,XAU                                            Y02669 70591402
XAUIN2   EQU   *                                               @ZM30445 70591503
         WTO   MF=(E,(1))         ISSUE MSG                      Y02669 70595503
         B     IEE36050           RETURN EXIT, ABORT COMMAND     Y02669 70599503
*                                                                Y02669 70603503
*                                                                Y02669 70608402
NOPATHA  EQU   *                                               @YM3369P 70611402
         MVC   IEE36FIL(K8),IEEPHYS    MOVE IN 'PHYSICAL'      @YM3369P 70614402
         B     NOPATH             AVOID NEXT INSTRUCTION       @YM3369P 70616402
NOPATHB  EQU   *                                               @YM3369P 70618402
         MVC   IEE36FIL(K8),IEELOGIC   MOVE IN 'LOGICAL '      @YM3369P 70620402
NOPATH   EQU   *                  NOPATHS MSG RTN                Y02669 70622402
         MVC   IEE36BUF(K3),K1(R7)     MOVE BAD UNIT INTO MSG    Y02669 70625102
*                                 BUFFER                         Y02669 70641802
ADDRMSG  EQU   *                                               @YM3411P 70681802
         LA    R1,IEE36MSG        GET ADDR OF MESSAGE FOR WTO    Y02669 70691802
MESSG    EQU   *                                                 Y02669 70701802
         SR    R0,R0              CLEAR R0 FOR CONS. ID          Y02669 70711802
         TM    XAU,RI             IS THIS FROM INPUT STREAM?   @ZM30445 70714803
         BO    XAUIN3             YES, DON'T INSERT CONSOLE ID @ZM30445 70717803
         IC    R0,XAU                                            Y02669 70721802
XAUIN3   EQU   *                                               @ZM30445 70731803
         WTO   MF=(E,(1))         WRITE NO PATHS MESSAGE         Y02669 70741802
NOUNIT   EQU   *                                               @Z30LPTJ 72741803
         LA    R15,K4             INDICATE NO PATH UNIT          Y02669 75650002
         SPACE 1                                                        75800000
IEE36200 LM    R0,R6,K8(R8)       RESTORE REGISTER CONTENTS      Y02669 76000002
         BR    R11                 RETURN TO CALLER                     76200000
UNITMSG  EQU   *                                               @YM3411P 76240002
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 76248003
         BO    NOUNIT             YES, SKIP MESSAGE OUTPUT     @Z30LPTJ 76264003
         MVC   IEE36MSG(REFLNG),REFMSG  LOAD IEE313I MSG       @YM3411P 76280002
MOVEUNIT EQU   *                                               @Z30LPTJ 76300003
         MVC   IEE36DEV(K3),K1(R7)  MOVE BAD UNIT INTO MSG     @YM3411P 76320002
         B     ADDRMSG                                         @YM3411P 76360002
         SPACE                                                          76368003
SS1MSG   EQU   *                                               @Z30LPTJ 76376003
         MVC   IEE36MSG(SS1LENG),SS1TEXT LOAD IEE084I MESSAGE  @Z30LPTJ 76384003
         B     MOVEUNIT            BRANCH TO LOAD UNIT VALUE   @Z30LPTJ 76392003
         EJECT                                                          76400002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  Y02651 76410002
*                                                                Y02651 76412002
*  THE LIST FORM OF THE ENQ AND DEQ INSTRUCTION ISSUED IN THIS   Y02651 76414002
*  MODULE FOLLOW:                                                Y02651 76416002
*                                                                Y02651 76418002
IEFSCONA ENQ   (IEFSQCBS,IEFVQCBS,S,K7,SYSTEM),MF=L            @YM5443P 76418202
ENQBEGIN EQU *                                                 @ZA09166 76419203
IEFSCONB ENQ   (IEFSQCBS,IEFQ4QCB,E,K2,SYSTEM),MF=L,ECB=ZERO   @YM5443P 76421202
ENQEND   EQU   *                                               @YM5443P 76424202
ENQLNTH  EQU   ENQEND-ENQBEGIN                                 @ZA09166 76427203
IEFSCONC DEQ   (IEFSQCBS,IEFQ4QCB,K2,SYSTEM),RET=HAVE,MF=L     @YM5443P 76431402
IEFSCOND ENQ   (IEFSQCBS,IEFQ4QCB,E,K2,SYSTEM),MF=L            @YM5443P 76434502
IEFSOFFA ENQ   (IEFSQCBS,IEFVQCBS,E,K7,SYSTEM),MF=L            @YM5443P 76435502
IEFSOFFB ENQ   (IEFSQCBS,IEFQ4QCB,S,K2,SYSTEM),MF=L            @YM5443P 76515502
IEFSDONA ENQ   (IEFSQCBS,IEFVQCBS,E,K7,SYSTEM),MF=L            @YM5443P 76595502
IEFSDONB ENQ   (IEFSQCBS,IEFQ4QCB,S,K2,SYSTEM),MF=L            @YM5443P 76675502
IEFDEQUE DEQ   (IEFSQCBS,IEFQ4QCB,K2,SYSTEM,IEFSQCBS,IEFVQCBS,K7,      *76755502
               SYSTEM),RET=HAVE,MF=L                           @YM5443P 76845502
IEFSQCBS DC    C'SYSIEFSD'                                       Y02651 76937602
IEFQ4QCB DC    C'Q4'                                             Y02651 77037602
IEFVQCBS DC    C'VARYDEV'                                      @YM5443P 77137602
*                                                                Y02651 77237602
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  Y02651 77337602
         EJECT                                                          77437602
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         77600000
*                                                             *         77800000
* CONSTANTS SECTION (READ-ONLY)                               *         78000000
*                                                             *         78200000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         78400000
         SPACE 1                                                        78600000
IEE36GMP DS    0F                  GETMAIN/FREEMAIN LV PARAM            78800000
         DC    X'E5'               SUBPOOL 229 INDICATOR                79000002
         DC    AL3(GETLEN)         LGTH OF GETMAIN'ED WORK AREA         79200002
WORKAREA DC    X'E5000020'         DATA AREA CORE SPECIFICATION@Z30LPTJ 79300003
*              NOTE: IF THE SIZE OF 'WORKAREA' IS CHANGED IN   @Z30LPTJ 79320003
*                    IEECB904, SUCH CHANGE MUST ALSO BE MADE   @Z30LPTJ 79340003
*                    TO 'WORKAREA' HERE.                       @Z30LPTJ 79360003
IEE36CIN DC    C'(I-'              MASK FOR COMPOSITE I-UNIT            79400000
IEE36END DC    C')'                MASK FOR END OF OPR SUBLIST          79600000
IEE36COU DC    C','                MASK FOR COMPOSITE O-UNIT            79800000
IEE36OUT DC    C'O-'               MASK FOR OUTPUT-ONLY CONSOLE         80000000
IEE3303D DC    C'IEE3303D'                                       Y02669 80800002
IEEPHYS  DC    C'PHYSICAL'         'PHYSICAL' INSERTION        @YM3369P 80900002
IEELOGIC DC    C'LOGICAL '         'LOGICAL ' INSERTION        @YM3369P 80950002
IEE36H04 DC    H'04'               TO COMPARE FOR TERM LENGTH 4         81000000
IEE36H06 DC    H'06'               TO COMPARE FOR TERM LENGTH 6         81200000
IEE36H14 DC    H'14'               TO COMPARE FOR TERM LGTH 14          81400000
IEE36INT WTO   'IEE025I UNIT DDD HAS NO LOGICAL  PATHS',MF=L,DESC=(5), *81600002
               MCSFLAG=(REG0,RESP) NO PATHS MESSAGE FOR VARY   @YM3369P 81800002
LENG     EQU   *-IEE36INT                                               82000002
COMPMSG  WTO   'IEE329I     IN USE BY A SYSTEM COMPONENT',             *82020002
               MF=L,DESC=(5),MCSFLAG=(REG0,RESP)               @YM07231 82027002
COMPLN   EQU   *-COMPMSG                                       @YM07231 82034002
INSUFMSG WTO   'IEE328I VARY     COMMAND ABORTED',MF=L,DESC=(5),       *82046003
               MCSFLAG=(REG0,RESP)                             @ZM30436 82046903
REFMSG   WTO   'IEE313I DDD      UNIT REF INVALID',MF=L,DESC=(5),      *82047803
               MCSFLAG=(REG0,RESP)                             @ZM30436 82048703
REFLNG   EQU   *-REFMSG                                        @YM3411P 82049602
TERMMSG  WTO   'IEE308I VARY     TERM LENGTH ERROR',MF=L,DESC=(5),     *82049703
               MCSFLAG=(REG0,RESP)                             @Z30LPTJ 82049803
TERMLNG  EQU   *-TERMMSG                                       @Z30LPTJ 82055903
DELIMMSG WTO   'IEE307I VARY     DELIMITER ERROR',MF=L,DESC=(5),       *82060003
               MCSFLAG=(REG0,RESP)                             @Z30LPTJ 82062003
DELIMLNG EQU   *-DELIMMSG                                      @Z30LPTJ 82064003
CONFMSG  WTO   'IEE312I VARY     PARAMETERS CONFLICT',MF=L,DESC=(5),   *82066003
               MCSFLAG=(REG0,RESP)                             @Z30LPTJ 82070003
CONFLNG  EQU   *-CONFMSG                                       @Z30LPTJ 82072003
SS1TEXT  WTO   'IEE084I          3851 PARAMETER MISSING',MF=L,         *82074003
               DESC=(5),MCSFLAG=(REG0,RESP)                    @Z30LPTJ 82076003
         DS    0F                                              @ZA09166 82077003
SS1LENG  EQU   *-SS1TEXT                                       @Z30LPTJ 82078003
IEE799B  EQU   *                  BEGINNING OF WTOR LIST       @ZA09166 82078403
IEE799LS WTOR  'IEE799A VARY CONSOLE DELAYED - REPLY RETRY,CANCEL,OR WA*82078603
               IT',,6,DESC=(5),MCSFLAG=(REG0,RESP),MF=L        @ZA09166 82078803
IEE799L  EQU   *-IEE799B          LENGTH OF WTOR LIST          @ZA09166 82079003
IEE756I  WTO   'IEE756I VARY COMMAND CANCELLED BY OPERATOR',   @ZA09166*82079203
               MF=L,DESC=(5),MCSFLAG=(REG0,RESP)               @ZA09166 82079403
         DS    0F                                                Y02669 82080003
VCON33   DC    V(IEE3303D)                                       Y02669 82100002
VCON904  DC    V(IEECB904)                                     @Z30LPTJ 82120003
LVARY    DC    X'04E5C1D9E8'                                     Y02653 82150002
VARY     DC    CL8'VARY    '                                     Y02653 82160002
         DS    0H                                                Y02669 82180002
FOUR     DC    H'4'                                              Y02669 82190002
FLINE    DC    C'FLINE'                                          Y02669 82192002
NLINE    DC    C'NLINE'                                                 82192502
ONLINE   DC    C'ONLINE'                                       @Z30LPTJ 82202703
OFFLINE  DC    C'OFFLINE'                                      @Z30LPTJ 82212703
CONSOLE  DC    C'CONSOLE'                                      @Z30LPTJ 82222703
BLANKS   DC    CL6'      '        BLANKS TO CAPITALIZE REPLY   @ZA09166 82224703
CANCEL   DC    C'CANCEL'          REPLY OF CANCEL              @ZA09166 82226703
RETRY    DC    C'RETRY'           REPLY OF RETRY               @ZA09166 82228703
WAIT     DC    C'WAIT'            REPLY OF WAIT                @ZA09166 82230703
         DS    0D                                                       82233003
TIMELOC  DC    C'00000500'                                              82253003
         SPACE 3                                                        82273003
PATCH    DC    CL120'***IEE3603D***'                           @Z30LPTJ 82293003
         EJECT                                                          82313003
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         82400000
*                                                             *         82600000
* DSECT TO REFERENCE GETMAIN'ED WORK/SAVE AREA                *         82800000
*                                                             *         83000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         83200000
         SPACE 1                                                        83400000
IEE36WRK DSECT                                                          83600000
         DS    18F                 REGISTER SAVE AREA                   83800000
IEE36S14 DS    F                   WORD TO SAVE REGISTER 14             84000000
         DS    F                   WORD TO SAVE REGISTER 15             84200000
         DS    F                   WORD TO SAVE REGISTER 0              84400000
         DS    F                   WORD TO SAVE REGISTER 1              84600000
IEE36MSG DS    CL(LENG)            BUFFER TO BUILD NO PATHS MSG         84800002
IEE36DEV EQU   IEE36MSG+K12        LOC OF UNIT IN UNIT REF MSG @YM3411P 84850002
IEE36BUF EQU   IEE36MSG+K17        LOC OF UNIT IN NO PATHS MSG          84900002
IEE36FIL EQU   IEE36MSG+K28        LOCATION OF FILLER IN NO    @YM3369P 84970002
*                                       PATHS MESSAGE          @YM3369P 85050002
IOSAREA  DS    16F                 IOSGEN SAVE AREA            @YM3411P 85070002
ECBAREA  DS    F                   ECB POST AREA               @YM5443P 85100002
ENQMVC   EQU   *                   ENQ LIST AREA               @YM5443P 85150002
OFFSET   ENQ   (,,E,K2,SYSTEM),ECB=ZERO,MF=L ENQ LIST          @ZA09166 85152003
RPYAREA  DS    CL6                REPLY BUFFER                 @ZA09166 85153003
         DS    0F                                              @ZA09166 85156003
IEE799D  EQU   *                  AREA FOR WTOR LIST FOR       @ZA09166 85158003
IEE799   WTOR  'IEE799A VARY CONSOLE DELAYED - REPLY RETRY,CANCEL,OR WA*85166003
               IT',,6,DESC=(5),MCSFLAG=(REG0,RESP),MF=L        @ZA09166 85174003
         DS    0D                  END OF GETMAIN'ED WORK AREA          85200000
GETLEN   EQU   *-IEE36WRK          LGTH OF GETMAIN'ED WORK AREA@Z30LPTJ 85400003
*              NOTE: IF THE SIZE OF THIS 'GETLEN' IS           @Z30LPTJ 85450003
*                    CHANGED, SUCH CHANGE MUST ALSO BE MADE    @Z30LPTJ 85500003
*                    AT THE 'SPSIZEA' LABEL IN IEECB904.       @Z30LPTJ 85550003
         EJECT                                                          85600000
IEE36XSA DSECT                                                          85800000
         IEEXSA                                                         86000000
         EJECT                                                          86650002
         CVT   DSECT=YES                                                86651002
         EJECT                                                          86652002
         IECDIOCM                                                       86653002
         EJECT                                                          86654002
         IECDIOCX                                                       86655002
         EJECT                                                          86656002
CHAIN1   DSECT                                                          86660002
         IEECHAIN                                                       86700002
         SPACE 1                                                        86800000
        EJECT                                                           86850002
OUCB    DSECT                                                           86900002
        IEFUCBOB                                                        86950002
         END                                                            87000000
