      TITLE 'IEE4103D - VARY HARDCOPY MESSAGE MODULE'                   00300002
IEE4103D CSECT                                                          00600018
*********************************************************************** 00650002
*                                                                       01100002
* MODULE NAME      = IEE4103D                                           01150002
*    CSECT NAME    = IEE4103D                                           01160002
*                                                                       01162002
* LOAD MODULE NAME = IGC0003D                                           01170002
*                                                                       01180002
* DESCRIPTIVE NAME = HARDCOPY INFORMATIONAL MESSAGE MODULE              01194002
*                                                                       01196002
* COPYRIGHT        = MISSING                                            01198802
*                                                                       01199202
* STATUS           = OS/VS/2 RELEASE 3                         @Z30LPTJ 01199603
*                                                                       01199702
* FUNCTION         = ISSUES A HEADER AND A HARDCPY INFORMATIONAL        01249902
*                    MESSAGE FOR A DEVICE THAT HAS JUST BEEN VARIED     01259902
*                    AS A HARDCPY DEVICE.                               01269902
*                                                                       01279902
* OPERATION        = THIS MODULE, USES THE INFO IN THE UNIT CONTROL     01289902
*                    MODULE (UCM),THE UNIT CONTROL MODULE ENTRY (UCME), 01293902
*                    AND THE MODULE PREFIX (UCMPRFX) TO CONSTRUCT THE   01295902
*                    HARDCPY MESSAGE.                                   01297902
*                    THE MESSAGE CONTAINS THE PHYSICAL DEVICE ADDRS OF  01298302
*                    THE HARDCPY DEVICE, INFO AS TO WHETHER IT IS       01298702
*                    A STAND-ALONE O-UNIT, AN I/O UNIT, OR PART OF      01299102
*                    A COMPOSITE, IT WILL SHOW ITS ALTERNATE, ITS       01299502
*                    ROUTE CODES AND WHAT INFORMATION IS TO GO TO       01299602
*                    HARDCPY (STCMDS,INCMDS,NOCMDS,CMDS,OFF).           01299702
*                                                                       01299802
* NOTES                                                                 01309802
*    DEPENCENCIES  = NONE                                               01349802
*    CHARACTER/CODE DEPENDENCIES                                        01351802
*                  = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW          01353802
*                    CHARACTER/CODE SET.                                01355802
*                                                                       01359802
* RESTRICTIONS     = REG2 PTR TO THE XSA ON INPUT                       01361802
*                    REG5 PTR TO THE MESSAGE BUFFER GETMAIN'ED          01389802
*                    BY IEE7203D                                        01391802
*    REGISTER CONVENTIONS                                               01392202
*                  = REGISTERS ARE DEFINED AT LABEL: DEFREG             01392602
*    PATCH LABEL   = PATCH                                              01393002
*                                                                       01393802
* MODULE TYPE      = CSECT                                              01394202
*    PROCESSOR     = ASSEMBLER                                          01394602
*    MODULE SIZE   = VS/2 = '38A'                              @ZM30445 01395003
*    ATTRIBUTES    = REENTRANT, REUSABLE, REFRESHABLE, PAGED LPA,       01395802
*                    ZERO PSW PROTECT KEY, SUPERVISOR MODE              01397802
*                                                                       01398202
* ENTRY POINT      = IEE4103D FROM IEE7203D                             01399402
*    PURPOSE       = TO ISSUE HARDCPY MESSAGE                           01399502
*    LINKAGE       = BRANCH                                             01399602
*    INPUT         = REG2 POINTS TO THE XSA                             01399702
*                    REG1 POINTS TO THE MESSAGE AREA GETMAIN'ED         01449702
*                    BY 7203D                                           01459702
*                    REG12 POINTS TO THE UNIT FIELD OR IS ZERO          01469702
*                    IF THE UNIT IN THE COMMAND IS SYSLOG               01479702
*                    REG14 CONTAINS THE RETURN ADDRESS                  01489702
*    REGISTERS SAVED= NONE                                              01491702
*    REGISTER USAGE= R0      UCMID REG FOR WTO                          01495702
*                    R1      INDEX IN MSG BUFFER AND WTO PTR            01497702
*                    R2      XSA PTR                                    01498102
*                    R3      UCM PTR                                    01498502
*                    R4      UCMPRFX PTR                                01498902
*                    R5      MESSAGE FBUFFER PTR                        01499302
*                    R9      UCME PTR                                   01499402
*                    R11     UCME'S OF ALTERNATE CONSOLE PTR            01499502
*                    R12     PTR TO UNIT FIELD OF 0 IF UNIT IS SYSLOG   01499602
*                    R13     COMPOSITE'S UCME PTR IF ANY                01533002
*                    R15     UCB PTR                                    01543002
*    REGISTERS RESTORED                                                 01553002
*                  = NONE                                               01563002
*                                                                       01565002
* EXITS - NORMAL   = BR14 TO CALLER OF SVC 34                           01565402
*    CONDITIONS    = MESSAGE WAS ISSUED                                 01566202
*    OUTPUT        = R2 PTS TO THE XSA                                  01566302
*    RETURN CODES  = NONE                                               01566402
*                                                                       01577602
* EXITS - ERROR    = NONE                                               01587602
*                                                                       01588002
* EXTERNAL REFERENCES                                                   01588402
*    ROUTINES      = NONE                                               01588802
*    DATA AREAS    = NONE                                               01594502
*                                                                       01594902
* CONTROL BLOCKS   = . EXTENDED SAVE AREA (XSA)                         01595302
*                    . UNIT CONTROL BLOCK (UCB)                         01595702
*                       FIELDS TESTED  - UCBNAME                        01596102
*                       FIELDS UPDATED - NONE                           01596202
*                    . UNIT CONTROL MODULE (UCM)                        01646202
*                       FIELDS TESTED  - UCMALTEN                       01656202
*                                        UCMATR - BIT= UCMOF            01666202
*                                        UCMCOMPC                       01676202
*                                        UCMHRDRT                       01686202
*                                        UCMID                          01688202
*                                        UCMSDS1 - BIT= UCMSDS1A        01690202
*                                                       UCMSDS1B        01692202
*                                        UCMSFLGS - BIT= UCMSYSC        01694202
*                                        UCMUCB                         01694602
*                                        UCMVEA                         01695002
*                                        UCMXECB                        01695402
*                       FIELDS UPDATED - NONE                           01695802
*                    . CVT                                              01695902
*                       FIELDS TESTED  - CVTCUCB                        01696002
*                       FIELDS UPDATED - NONE                           01696102
*                                                                       01712802
* TABLES           = MESSAGE BUFFER GETMAIN'ED BY IEE7203D              01722802
*                                                                       01724802
* MACROS           = WTO, FREEMAIN, SETLOCK                             01726802
*                                                                       01728802
* MAPPING MACROS   = IEEXSA                                             01729202
*                    IEECUCM                                            01729302
*                    IEFUCBOB                                           01729402
*                    CVT                                                01735002
*                    IHAPSA                                             01735102
*    SERIALIZATION = NO LOCKS ARE REQUIRED IN THIS MODULE FOR THE UCB.  01735402
*                    THE ONE FIELD USED IN HERE IS UCBNAME WHICH        01735802
*                    ALWAYS REMAINS UNCHANGED.                          01736202
*                    THE UCM IS PROTECTED VIA THE LOCAL AND CMS LOCKS.  01736602
*                    THIS PROTECTION IS REQUIRED AGAINST ANOTHER VARY   01736702
*                    COMMAND OR COMM. TASK.                             01736802
*                    THESE LOCKS ARE OBTAINED AT:                       01736902
*                         HSETLK IN MODULE IEE7203D                     01739502
*                    AND RELEASED AT:                                   01741502
*                         HUNSTLK IN THIS MODULE                        01741902
*                    AS SOON AS UCM FIELDS ARE NOT REQUIRED ANY LONGER. 01742302
*                    FIELDS WHICH MUST BE PROTECTED:                    01745202
*                         UCMALTEN - ALTERNATE CONSOLE PTR - UCM        01747202
*                         UCMSDS1  - BIT =UCMSDS1A,UCMSDS1B,            01747602
*                                         STCMDS,  INCMDS  - UCM        01748002
*                                    HARDCPY BITS IN THE UCM            01748402
*                         UCMSFLGS - BIT = UCMSYSC         - UCM        01748502
*                                    CMDS SET FOR HARDCPY BIT           01749002
*                         UCMHRDRT - HARDCPY ROUTCODES     - UCM        01749402
*                                                                       01750202
* CHANGE LEVEL     = Y02669, Y02651, Z30LPTJ, ZM30445          @ZM30445 01751503
*                                                                       01754402
* CHANGE ACTIVITY  = N/A                                                01757302
*                                                                       01760202
* MESSAGES         = 'IEE349I HARDCOPY CONSOLE'                         01760502
*                    'CONSOLE/ALT  COND  AUTH  ID  ROUTCD'              01770502
*                    'MESSAGE CONTAINING THE INFO FOR THE DEVICE AS     01780502
*                    CAPTIONED ABOVE'                                   01790502
*                                                                       01800502
* ABEND CODES      = NONE                                               01830502
*                                                                       01832502
* PACKAGING        = IEE4103D WILL BE PART OF LOAD MODULE               01838502
*                       = IGC0003D                                      01838902
*                    THIS LOAD MODULE ALIASES ARE                       01839302
*                       = NONE                                          01839702
*                    THIS LOAD MODULE ENTRY POINTS ARE                  01840102
*                       = IGC0003D                                      01840202
*                    MODULE WILL RESIDE IN: LPALIB                      01849802
*                                                                       01859502
* SYSGEN           = SUPPLIED BY SECTIONS:                              01869102
*                    LOAD MODULE NAME                                   01871102
*                    PACKAGING                                          01873102
*                    THIS CSECT WILL BE INCLUDED AT SYSGEN FROM         01873202
*                    DLIB -AOSB3- BY MACRO -SGIEF441-                   01873302
*                                                                       01873502
* SYSTEM LIBRARIES = NONE                                               01873602
*                                                                       01873702
*********************************************************************** 01873802
         EJECT                                                          01883802
*                                                                       01890302
DEFREG   EQU   *                                                 Y02669 01890402
R0       EQU   0                                                        01890502
R1       EQU   1                                                        02400018
CXSA     EQU   2                   PTR TO XSA                           03200018
R3       EQU   3                                                        04000018
R4       EQU   4                   ON ENTRY HAS CONTENTS OF XAD         04800018
R5       EQU   5                                                        05600018
R6       EQU   6                   ADDRESSABILITY REG                   06400018
R7       EQU   7                                                        07200018
R8       EQU   8                   ON ENTRY,HAS PTR T O GOTTEN CORE     08000018
R9       EQU   9                                                        08800018
R10      EQU   10                                                       09600018
R11      EQU   11                                                       10400018
R12      EQU   12                                                       11200018
R13      EQU   13                                                       12000018
R14      EQU   14                                                Y02651 12050002
CRETURN  EQU   14                  RETRN REGISTER                       12800018
R15      EQU   15                                                       13600018
*                                                                       14400018
*        LENGTH DEFINITIONS                                             15200018
*                                                                       16000018
COMMA    EQU   C','                                                     17600018
CSLASH   EQU   C'/'                                                     17720002
CDASH    EQU   C'-'                                                     17810018
CHRDCPY  EQU   C'H'                    CONSOLE IS HARDCOPY              17950018
L3       EQU   3                       LENGTH OF PHYSICAL DEV ADDR      18020018
L6       EQU   6                       DISPLACEMENT OF O-UNITPAST I-    18090018
CBACK    EQU   X'FF'                                                    20000018
*                                                                       20800018
ZERO     EQU   0                                                        20850018
ONE      EQU   1                                                        20900018
TWO      EQU   2                                                        20950018
TRE      EQU   3                                                        21000018
FOR      EQU   4                                                        21050018
SIX      EQU   6                                                        21100018
TWLV     EQU   12                                                       21250018
FIFTN    EQU   15                                                       21300018
ONEDGT   EQU   X'F0'                                                    21450018
LENMSG   EQU   X'7C'                   LENGTH OF MLWTO MSG        21002 21596001
ZONEBIT  EQU   X'0F'                   ZONE BIT FOR UNPACK        21002 21598001
BLNK     EQU   X'40'                   BLANK                      21002 21598401
WORD     EQU   3                       OFFSET TO DOUBLE WORD      21002 21599601
WORDZONE EQU   10                      OFFSET TO ZONE BYTE        21002 21599701
WORDID   EQU   9                       OFFSET TO CONSOLE ID       21002 21599801
RI       EQU   X'80'                                           @ZM30445 21599903
         EJECT                                                          21600018
         BALR  R6,ZERO                  ADDRESSABILITY                  22400018
         USING *,R6                ADDRESSABILITY                       23200018
         MODID BR=YES                                            Y01886 23250001
         USING XSASET,CXSA              ADDRESSABILITY FOR XSA          24000018
*                                                                       24800018
         L     R3,CVTPTR                                                28800018
         USING CVTSET,R3                                                29600018
         L     R3,CVTCUCB          PTR TO UCM                           30400018
         DROP  R3                                                       31200018
         USING UCM,R3           ADDRESSABILITY FOR UCM           Y02669 32000002
         LR    R5,R1               GET MSG CORE PTR INTO REG5    Y02669 32050002
*                                                                       32800018
         USING CMESSAGE,R5                                        19084 33200019
         LA    R1,CHEADR           POINTER TO DECLARED HEADER     19084 33300019
         MVC   ZERO(LENMSG,R5),ZERO(R1)  MOVE MLWTO INTO BUFFER   21002 33400001
*                                                                       34100019
*********************************************************************** 34200019
*        HARDCOPY MESSAGE ROUTINE                                       34300019
*********************************************************************** 34400019
*                                                                       34500019
         LR    R4,R3                                             Y02669 34700002
         SH    R4,CFOUR                                                 34800019
         L     R4,ZERO(R4)                                              34900019
         USING UCMPRFX,R4                                               35000019
         LTR   R12,R12             IS IT SYSLOG                   19084 35400019
         BZ    CSYSLG              YES                                  35500019
         LM    R9,R11,UCMVEA          1ST,SIZE AND LAST UCME            35600019
         USING UCMLIST,R9             UCME ADDRESSIBILITY               35700019
         USING UCBSET,R15              UCB ADDRESSIBILITY               35800019
CLOOP1   L     R15,UCMUCB              PTR TO UCME'S UCB                35900019
         CLC   ZERO(L3,R12),UCBNAME        IS UCME FOR UNIT IN CIB19084 36000019
         BE    CHRDIN                  YES,PROCESS                      36100019
         BXLE  R9,R10,CLOOP1          TRY NEXT ONE                      36200019
*                                                                       36300019
*********************************************************************** 36400019
* PREPARE FOR MESSAGE BUILDING BY MOVING IN HEADER AND BASIC SYNTAX   * 36500019
*********************************************************************** 36600019
*                                                                       36700019
CHRDIN   EQU   *                                                        36800019
         L     R13,UCMCOMPC            GET COMPOSITE PTR,IF IT IS       36900019
         LTR   R13,R13                 NOT ZERO,UNIT IS A COMPOSITE     37000019
         BZ    CONEU                   IF ZERO ONLY ONE UNIT            37100019
         TM    UCMATR,UCMOF             IS IT O-UNIT                    37200019
         BZ   CHMOVE              NO, OK                                37300019
         LR    R9,R13              R9 PTR TO UCME OF I-UNIT NOW         37400019
         L     R13,UCMCOMPC        R13, NOT PTS TO UCME OF OUTPUT UNIT  37500019
         L     R15,UCMUCB                                               37600019
CHMOVE   EQU   *                                                        37700019
         MVC   XUNIT1(L3),UCBNAME        INSERT I-UNIT ADDR             37800019
         MVI   XBLANK,COMMA            INSERT DELIMITER                 37900019
         L    R15,TWLV(R13)                                             38000019
CONEU    EQU   *                                                        38100019
         MVC   XUNIT2(L3),UCBNAME        INSERT UNIT                    38200019
         MVI   XCOMMA,CSLASH           SET DELIMITER                    38400019
         L     R11,UCMALTEN            OBTAIN ALTERNATE PTR (I-UNIT)    38500019
         DROP  R9                      ..                               38600019
         USING UCMLIST,R11             ..                               38700019
         LTR   R11,R11                 DO WE HAVE A COMPOSITE?   Y02669 38750002
         BZ    CATTRBTE                NOPE, IT IS ONE CONS SYSTEY02669 38760002
         L     R15,UCMUCB              OBTAIN ALTERNATE'S UCB PTR       38800019
         MVC   XAUNIT1(L3),UCBNAME     PLACE ALT'S ADDR IN MSG          38900019
         L     R11,UCMCOMPC            OBTAIN O-UNIT PTR                39000019
         LTR   R11,R11                 IF PTR=0,NO O-UNIT               39100019
         BZ    CATTRBTE            RETURN                               39200019
         MVI   XBLK,COMMA              ALT=COMPOSITE,SET DELIMITER      39300019
         L     R15,UCMUCB              ..                               39400019
         MVC   XAUNIT2(L3),UCBNAME     INSERT 2ND ALTCON ADDR           39500019
         DROP  R11,R15                 ..                               39600019
         USING UCMLIST,R9              ..                               39700019
CATTRBTE EQU   *                                                        39800019
*********************************************************************** 39850001
* AUTHORITY CODE DETERMINATION.                                   21002 39852001
*********************************************************************** 39860001
         MVI   XMSGSTAT,CHRDCPY    ASSUME HARDCOPY                      39900019
         MVC   XMSGAUTH(SIX),CNO       INSERT NOCMDS              21002 40110001
         TM    UCMSDS1,UCMSDS1A        IS THIS STCMDS             21002 40120001
         BO    CHDCPST                 YES, MOVE STCMDS INTO MSG  21002 40130001
         TM    UCMSDS1,UCMSDS1B        IS THIS INCMDS             21002 40460001
         BO    CHRDCPIN                NO, CK TO SEE IF CMDS      21002 40470001
         TM    UCMSFLGS,UCMSYSC        IS THIS CMDS               21002 40480001
         BZ    CRT7A                   NO COMMANDS ASSUMED        21002 40490001
         MVC   XMSGAUTH(SIX),CMDS      MOVE CMDS TO MSG AREA      21002 40494001
         B     CRT7A                   CONTINUE                   21002 40496001
CHRDCPIN EQU   *                                                  21002 40598401
         MVC   XMSGAUTH(TWO),CIN       MOVE IN INCMDS             21002 40598801
         B     CRT7A                   CONTINUE                   21002 40598901
CHDCPST  EQU   *                                                  21002 40599001
         MVC   XMSGAUTH(TWO),CST       MOVE IN STCMDS             21002 40599101
         B     CRT7A                   CONTINUE                   21002 40602501
*********************************************************************** 40604501
*          FILL IN CONSOLE ID                                    21002* 40604901
*********************************************************************** 40605301
CRT7A    EQU   *                                                  21002 40605701
         LTR   R12,R12             IS THIS SYSLOG ?               21002 40606001
         BZ    RTCDET              YES, NO CONSOLE ID.            21002 40609401
         CLI   XUNIT2,BLNK             COMPOSITE CONSOLE          21002 40612801
         BNE   NOCOMP                  NO, USE UCME IN REG 9      21002 40616201
         L     R9,UCMCOMPC             UCME OF OUTPUT CONSOLE     21002 40619601
NOCOMP   EQU   *                                                  21002 40620001
         SR    R11,R11                 CLEAR FOR CONSOLE ID       21002 40620901
         IC    R11,UCMID               GET CONSOLE ID             21002 40632201
         CVD   R11,XMSGWK+WORD         CONVERT TO DECIMAL         21002 40643501
         OI    XMSGWK+WORDZONE,ZONEBIT                            21002 40654801
         UNPK  XMSGID(TRE),XMSGWK+WORDID(TWO)                     21002 40666101
         MVI   XMSGID,BLNK             BLNAK OUT FIRST BYTE       21002 40677401
*********************************************************************** 40688701
*                                                                     * 40700019
* ROUTING CODE DETERMINATION                                          * 40800019
*                                                                     * 40900019
*********************************************************************** 41000019
RTCDET   EQU   *                                                  21002 41050001
         LH    R11,UCMHRDRT        PRESET TO CHECK ROUT CODE            41200019
         SPACE 10                                                       41250002
***************************************************              Y02651 41260002
*                                                                Y02651 41260402
* AT THIS POINT NO LOCKS ARE NEEDE ANY LONGER                    Y02651 41260802
*  THESE LOCKS WERE OBTAINED AT:                                 Y02651 41261202
*              HSETLK                                            Y02651 41261602
HUNSTLK EQU   *                                                  Y02651 41261702
         STM   R11,R14,XASAVLOC                                  Y02651 41264602
         SETLOCK RELEASE,TYPE=CMS,RELATED=(IEE7203D(HSETLK))     Y02651 41267602
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(IEE7203D(HSETLK))   Y02651 41270502
         LM    R11,R14,XASAVLOC                                  Y02651 41272502
*                                                                Y02651 41273402
***************************************************              Y02651 41281002
         SPACE 10                                                       41290502
         LTR   R11,R11             ARE NO ROUTCDES ALLOWED              41300019
         BZ    CNONE1                  NO ROUT RTN                      41400019
         CH    R11,CRTALL                                               41500019
         BE    CRTALLL                 ALL ROUT RTN                     41600019
*                                                                       41700019
* PROCESSING OF INDIVIDUAL ROUTING CODES                                41800019
*                                                                       41900019
         SLL   R11,FIFTN              LEFT JUSTIFY                      42100019
         LA    R10,CTABLE          GET PTR TO CONVERSION TABLE          42200019
         LA    R1,XMSGWK+ONE           GET POINTER TO WORK AREA-  21002 42300001
*                                      MUST BE ON WORD BOUNDARY   21002 42350001
NEXT     EQU   *                                                        42400019
         SLL   R11,ONE                                                  42500019
         LTR   R11,R11             IS BIT ON                            42600019
         BZ    NOMORE              NO, NOMORE,GO TO TRANCRIBE RT CODES  42700019
         BNM   NEXT1               NO, BUT OTHERS ON                    42800019
         MVC   ZERO(TWO,R1),ZERO(R10)   MOVE IN RT CDE                  42900019
         LA    R1,TWO(R1)            PT TO NEXT SPACE TO WRITE          43000019
NEXT1    EQU   *                                                        43100019
         LA    R10,TWO(R10)          PT TO NEXT CODE IN TABLE           43200019
         B     NEXT                    GO PROCESS NEXT RTCD             43300019
NOMORE   EQU   *                                                        43400019
         SR    R7,R7               ZERO OUT COUNTER               19084 43500019
         MVI   ZERO(R1),CBACK           PLACE END DELIMITER             43600019
         LA    R10,XMSGWK+ONE          ADDRESS OF WORK AREA       21002 43700001
*                                      MUST BE ON WORD BOUNDARY   21002 43750001
         LA    R1,XMSGRTCD         GET PTR TO RT CD AREA                43800019
BEGIN    EQU   *                                                        43900019
         MVC   ZERO(TWO,R1),ZERO(R10)                                   44000019
         CLI   ZERO(R10),ONEDGT         ONE OR TWO DIGITS NUMBER        44100019
         BNE   MOVED                   ALREADY FULLY MOVED              44200019
         MVC   ZERO(ONE,R1),ONE(R10)                                    44300019
         BCTR  R1,ZERO                  MINUS 1                         44400019
MOVED    EQU   *                                                        44500019
         LA    R1,TWO(R1)                                               44600019
ENDCHK   EQU   *                                                        44700019
         CLI   TWO(R10),CBACK                                           44800019
         BE    CISSUE1                  GO ISSUE MSG                    44900019
         MVI   ZERO(R1),COMMA                                           45000019
         SR    R7,R7               ZERO OUT COUNTER               19084 45100019
ENDCHK2  EQU   *                                                        45200019
         LH    R11,ZERO(R10)                                            45300019
         MVC   ONE(TWO,R1),TWO(R10)                                     45400019
         CH    R11,TAB09           IS NEXT NUMB A  TWO DIGIT NUMB       45500019
         BNE   ENDCHK3             NO, OK, GO PROCESS NORMAL            45600019
         AH    R11,FOX7            YES, ADD SPECIAL CAHRACTER           45700019
         B     ENDCHK5             GO PROCESS NORMAL                    45800019
ENDCHK3  EQU   *                                                        45900019
         AH    R11,HONE            ADD ONE TO COMPARE REG               46000019
ENDCHK5  EQU   *                                                        46100019
         LA    R10,TWO(R10)                                             46200019
         CH    R11,ZERO(R10)                                            46300019
         BE    SLASH                    GO MOVE IN A DASH               46400019
ENDSLASH EQU   *                                                        46500019
         CLI   ONE(R1),ONEDGT           ONE OR TWO DIGITS NUMBER        46600019
         BE    MOVEOVER                 ONE DIGIT, GO MOVE IT 1 MORE    46700019
         LA    R1,ONE(R1)               UPDATE PTR                      46800019
CONT     EQU   *                                                        46900019
         LA    R1,TWO(R1)                                               47000019
         LTR   R7,R7               FIRST TIME AROUND              19084 47100019
         BNZ   ENDCHK              NO, BRANCH                           47200019
         CLI   TWO(R10),CBACK          IS IT A DELIMITER                47300019
         BE    CISSUE1                  YES,GO ISSUE MSG                47400019
         MVI   ZERO(R1),COMMA           MOVE IN ','                     47500019
         B     ENDCHK2             CHECK NEXT DIGIT                     47600019
MOVEOVER EQU   *                                                        47700019
         MVC   ONE(ONE,R1),TWO(R1)                                      47800019
         B     CONT                     MOVED OVER, CONTINUE PROCESS    47900019
SLASHRTN EQU   *                                                        48000019
         LA    R10,TWO(R10)                                             48100019
         CLI   TWO(R10),CBACK      END DELIMITER                        48200019
         BE    SLASH6              YES, GO FINISH UP                    48300019
SLASH    EQU   *                                                        48400019
         MVI   ZERO(R1),CDASH         MOVE IN DASH                      48500019
         CH    R11,TAB09           2S IT GOING TO A TWO UNIT DIGIT      48600019
         BNE   SLASH2              (O, CONTINUE NORMAL PROCESS          48700019
         AH    R11,FOX7            YES, ADD F7  TO  THE COMPARE REG     48800019
         B     SLASH4              RETURN TO NORMAL PROCESS             48900019
SLASH2   EQU   *                                                        49000019
         AH    R11,HONE            ADD ONE TO COMPARE REG               49100019
SLASH4   EQU   *                                                        49200019
         CH    R11,TWO(R10)                                             49300019
         BE    SLASHRTN                GO TO RTN TO CHECK DASH          49400019
SLASH6   EQU   *                                                        49500019
         MVC   ONE(TWO,R1),ZERO(R10)                                    49600019
         BCTR  R7,ZERO             MAKE IT SECOND TIME AROUND SWTH19084 49700019
         B     ENDSLASH                 GO,CONTINUE PROCESS             49800019
*                                                                 19084 49900019
CSYSLG   EQU   *                                                  19084 50000019
         MVC   XUNIT1(L6),CSYSLOG      INSERT 'SYSLOG'            19084 50100019
         B     CATTRBTE                GO MOVE ATTRIBUTE          19084 50200019
*                                                                       50300019
CNONE1   EQU   *                                                        50400019
         MVC   XMSGRTCD(FOR),CNONE   INSERT NONE                        50500019
         LA    R1,XMSGRTCD+FOR       PRT PAST ROUTCDE PARM              50600019
         B     CISSUE1                 GO ISSUE MSG                     50700019
*                                                                       50800019
CRTALLL  MVC   XMSGRTCD(TRE),CALL                                       50900019
         LA    R1,XMSGRTCD+TRE                                          51000019
         EJECT                                                          51100019
*                                                                       51200019
*         REG 1 MUST PT TO THE CHARACTER AFTER LAST ROUT CODE           51300019
*                                                                       51400019
*                                                                       51500019
*********************************************************************** 51600019
*                                                                     * 51700019
*  MESSAGE ISSUING ROUTINE                                            * 51800019
*                                                                     * 51900019
*********************************************************************** 52000019
CISSUE1  EQU   *                                                        52100019
         LA    R9,XMSGHDR              ADDR OF BEGIN OF DATA LINE 21002 52450001
         SR    R1,R9                   LENGTH OF DATA LINE        21002 52460001
         STH   R1,XMSGHDR              LENGTH OF LABEL LINE       21002 52470001
         LR    R1,R5                   PTR TO WTO LIST            19084 52500019
         SR    R0,R0                                                    52600019
         TM    XAU,RI              IS THIS FROM INPUT STREAM?  @ZM30445 52630003
         BO    XAUIN               YES, DON'T INSERT CONSOLE ID@ZM30445 52660003
         IC    R0,XAU              UCM ID OF ISSUER                     52700019
XAUIN    EQU   *                                               @ZM30445 52750003
*                                                                       52800019
         WTO   MF=(E,(1))                                               52900019
         LR    R1,R5               PTR TO GOTTEN CORE             19084 53000019
         FREEMAIN R,LV=160,A=(1),SP=229                          Y02669 53100002
         BR    CRETURN             RETURN                         19084 53200019
*                                                                 19084 53300019
*********************************************************************** 65568018
*                                                                       65568218
         EJECT                                                          65572018
*                                                                       65600018
*              CONSTANT DEFINITION AREA                                 66400018
*                                                                       67200018
*                                                                       68000018
CHEADR   WTO   ('IEE349I HARDCOPY CONSOLE',C),('CONSOLE/ALT     COND   *68040001
               AUTH   ID  ROUTCD',L),('                                *68050001
                       ',DE),MF=L,DESC=(5),MCSFLAG=(QREG0,RESP)   21002 68060001
         DS    0F                                                       68120018
CRTALL   DC    X'FFFF'                 ALL CURRENT RT CODES             68180018
CALL     DC    C'ALL'              USED FOR ROUT AND AUTH               68240018
CNONE    DC    C'NONE'             USED FOR ROUT AND AUTH               68300018
CNO      DC    C'NO'               DO NOT SEPARATE THIS                 68360018
CMDS     DC    C'CMDS  '               ANY CMDS CONSTANT          21002 68474001
CIN      DC    C'IN'                   INCMDS                     21002 68476001
CST      DC    C'ST'                   STCMDS                     21002 68478001
CSYSLOG  DC    C'SYSLOG'           IF HCPY IS SYSLOG                    68480018
CFOUR    DC    H'4'                USED TO GET UCMPFX PTR               68540018
         DS    0F                                                       68600018
FOX7     DC    X'00F7'             CONSTANT FOR ROUT RTN                68660018
HONE     DC    X'0001'                 **                               68730018
*                                                                       71200018
*********************************************************************** 71220018
CTABLE   DC    C'01'               ROUT CONVERSION TABLE                71240018
         DC    C'02'                   **                               71260018
         DC    C'03'                   **                               71280018
         DC    C'04'                   **                               71300018
         DC    C'05'                   **                               71320018
         DC    C'06'                   **                               71340018
         DC    C'07'                   **                               71360018
         DC    C'08'                   **                               71380018
TAB09    DC    C'09'                   **                               71400018
         DC    C'10'                   **                               71420018
         DC    C'11'                   **                               71440018
         DC    C'12'                   **                               71460018
         DC    C'13'                   **                               71480018
         DC    C'14'                   **                               71500018
         DC    C'15'                   **                               71520018
         DC    C'16'                   **                               71530003
PATCH    DC    CL50'**IEE4103D***'                             @Z30LPTJ 71540003
*********************************************************************** 71560018
CMESSAGE DSECT                                                          71600018
CONTROL  DS    CL36                    CONTROL LINE               21002 71634001
LABEL    DS    CL44                    LABEL LINE                 21002 71636001
XMSGHDR  DS    CL4                     HEADER FOR DISPLAY LINE    21002 71638001
XTEXT    EQU   *                                                        71640018
*         MESSAGE CONFIGURATION OF  UNITS FOR 1ST WTO ISSUED            71660018
*                                                                       71680018
XUNIT1   DS    CL3                     1ST PHYSICAL UNIT ADDRESS        71700018
XBLANK   DS    CL1                     DELIMITER BETWEEN CONSOLES       71720018
XUNIT2   DS    CL3                     ADDR OF O-UNIT IF ANY            71740018
XCOMMA   DS    CL1                     DELIMITER-FOLLOWING ARE ALTCONS  71760018
XAUNIT1  DS    CL3                     1ST ADDR OF ALTCON UNIT          71780018
XBLK     DS    CL1                     DELIMITER BETWEEN ALTCONS        71800018
XAUNIT2  DS    CL3                     O-UNIT (COMPOSITE) FIELD         71820018
XMSGPAD1 DS    CL2                     BLANK AREA                       71840018
XMSGSTAT DS    CL1                     CONDITION INDICATOR              71860018
XMSGPAD2 DS    CL3                     BLANK AREA                       71880018
XMSGAUTH DS    CL1                     INDICATION BEGINNING AUTH FIELD  71900018
XMSGPAD3 DS    CL7                     BLANKS                     21002 71920001
XMSGID   DS    CL3                     CONSOLE ID                 21002 71930001
XMSGPAD4 DS    CL1                     BLANKS                     21002 71932001
XMSGRTCD DS    CL8                BEGGINIG OF ROUTE CODE FIELD          71940018
XMSGWK   DS    CL30                 ROUTE CODE WORRK AREA               71960018
         SPACE 3                                                        71980002
         EJECT                                                          72000018
UCBSET   DSECT                                                          72800018
         IEFUCBOB                                                       73600018
         EJECT                                                          74400018
CVTSET   DSECT                                                          75200018
         CVT                                                            76000018
         EJECT                                                          76800018
XSASET   DSECT                                                          77600018
         IEEXSA                                                         78400018
         EJECT                                                          94400018
UCMSET   DSECT                                                          95200018
         IEECUCM     FORMAT=NEW                                         96000002
         EJECT                                                          96050002
         IHAPSA                                                         96100002
         END                                                            96800018
