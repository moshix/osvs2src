 TITLE ' IEE4703D - VARY HARDCPY PROCESSOR'                             00100002
HUCMSET  DSECT                                                          00200018
         IEECUCM  FORMAT=NEW                                            00400002
         EJECT                                                          00600018
         IEEBASEA                                                       00800018
         EJECT                                                          01000018
HXSASET  DSECT                                                          01200018
         IEEXSA                                                         01400018
         EJECT                                                          06400018
HCVTSET  DSECT                                                          06600018
         CVT   SYS=VMS                                                  06800018
         EJECT                                                          07600018
IEE4703D CSECT                                                          07800018
*                                                                       07808003
* A HROUTRTN  APPROX 358500   KK2 APPROX 369000                @ZA12703 07816003
* D HROUTRTN  APPROX 355500   KPAR7 APPROX 400000-403000       @ZA12703 07822003
* A KPAR3     APPROX 387500                                    @ZA12703 07828003
*                                                                       07840003
*****************************************************************Y02669 07850002
*                                                                Y02669 07900002
*  THE COMMAND PROCESSED IN THIS MODULE IS:                      Y02669 07950002
*                                                                Y02669 07960002
*                     ***     *** ***                               *** 07970002
*   ***    ***        *         * *        ***                    *** * 07980002
*   *        *        *  NOCMDS * *        *                        * * 07990002
*   * XXX    *        *  INCMDS * *        * ALL                    * * 07992002
* V *        *,HARDCPY* ,STCMDS * * ,ROUT= * NONE                   * * 07994002
*   * SYSLOG *        *  CMDS   * *        * ROUTCODE(,ROUTCODE...  * * 07996002
*   *        *        *  OFF    * *        *                        * * 07998402
*   ***    ***        *         * *        ***                    *** * 07998802
*                     ***     *** ***                               *** 07999202
*****************************************************************Y02669 08000002
*                                                                       08050002
         EJECT                                                          08060002
**********************************************************************  08070002
* MODULE NAME      = IEE4703D                                           08100002
*    CSECT NAME    = IEE4703D                                           08110002
*                                                                       08150002
* LOAD MODULE NAME = IGC0003D                                           08200002
*                                                                       08250002
* DESCRIPTIVE NAME = VARY HARDCPY OPERAND PROCESSOR                     08400002
*                                                                       08450002
* COPYRIGHT        = MISSING                                            08600002
*                                                                       08650002
* STATUS           = OS/VS/2 RELEASE 3  PTF UZ05997            @ZA12703 08670003
*                                                                       08750002
* FUNCTION         = THIS MODULE INDICATES WHAT CHANGE ARE  TO          08900002
*                    BE MADE BY SETTING BITS IN THE XSA.                08950002
*                    1. IT VALIDITY CHECKS ROUTING CODES IF THEY        09000002
*                       ARE SPECIFIED AND INITIALIZES A FIELD,          09050002
*                       (XRTCODE), WHICH CONTAINS NEW ROUTING           09100002
*                       CODES.  IT ALSO SETS A BIT TO INDICATE          09150002
*                       THAT ROUTING CODES ARE CHANGING.                09200002
*                    2. IT VALIDITY CHECKS THE NEW AUTHORITY IF IT      09250002
*                       IS SPECIFIED.  IT SETS A BIT INDICATING         09300002
*                       WHAT THE NEW AUTHORITY WILL BE AND A BIT        09350002
*                       INDICATING THAT THE AUTHORITY IS CHANGING.      09400002
*                                                                       09450002
* OPERATION        = UPON RECEIVING CONTROL, THE COMMAND AUTHORITY      09500002
*                    OF THE ISSUING CONSOLE IS CHECKED.  IF THE         09550002
*                    ISSUER WAS THE MASTER CONSOLE, THE SYNTAX          09600002
*                    OF THE UNIT FIELD, AND THE PRESENCE OF             09650002
*                    KEYWORDS SUCH AS ROUT=,CMDS,STCMDS,INCMDS,         09700002
*                    NOCMDS,OFF ARE CHECKED.                            09750002
*                    IF HARDCPY,OFF  WAS ISSUED FROM THE MASTER         09800002
*                    CONSOLE, THAN CONTROL IS GIVEN TO ITS              09850002
*                    PROCESSOR - IEE5703D-.                             09900002
*                                                                       09950002
* NOTES                                                                 09960002
*    DEPENDENCIES  = NONE                                               09970002
*    CHARACTER/CODE DEPENDENCIES                                        09980002
*                  = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW          09990002
*                    CHARACTER/CODE SET.                                09992002
*                                                                       10042002
* RESTRICTIONS     = REG2 PTS TO THE XSA ON INPUT                       10150002
*    REGISTER CONVENTIONS                                               10200002
*                  = REGISTER ARE DEFINED AT LABEL: DEFREG              10210002
*    PATCH LABEL   = PATCH                                              10220002
*                                                                       10250002
* MODULE TYPE      = CSECT                                              10260002
*    PROCESSOR     = ASSEMBLER                                          10270002
*    MODULE SIZE   = VS/2 = '2BE'                              @Z30LPTJ 10280003
*    ATTRIBUTES    = REENTRANT, REUSABLE, REFRESHABLE, PAGED LPA,       10300002
*                    ZERO PSW PROTECT KEY, SUPERVISOR MODE              10350002
*                                                                       10400002
* ENTRY POINT      = IEE4703D FROM IEE3203D                             10550002
*    PURPOSE       = TO BEGIN PROCESSING A VARY HARDCPY COMMAND         10600002
*    LINKAGE       = BRANCH                                             10650002
*    INPUT         = REG2 POINTS TO THE XSA                             10700002
*                    XAR POINTS TO THE COMMAND BUFFER                   10750002
*                    XAL POINTS TO THE COMMAND PARAMETERS               10800002
*                    IN THE COMMAND BUFFER                              10850002
*                    XAV CONTAINS THE VERB                              10900002
*    REGISTERS SAVED= NONE                                              10950002
*    REGISTER USAGE= R2  XSA PTR                                        11050002
*                    R5  UCME PTR                                       11100002
*                    R6  EXTERIOR PARENS SWITCH                         11150002
*                    R7  END OF BUFFER PTR                              11200002
*                    R9  UNIT PTR                                       11250002
*                    R10 UCM PTR                                        11300002
*                    R11 UMPRFX PTR                                     11350002
*    REGISTERS RESTORED                                                 11400002
*                  = NONE                                               11450002
*                                                                       11500002
* EXITS - NORMAL 1 = TO IEE7203D                                        11550002
*                    VIA BRANCH                                         11600002
*    CONDITIONS    = WHEN INITIAL UNIT SCAN HAS COMPLETED               11650002
*                    WE EXIT TO 7203D TO PROCESS THE UNIT OR            11700002
*                    SYSLOG PARM AND TO MAKE ANY CHANGES TO THE         11750002
*                    ROUTING OR HARDCPY FUNCTIONS.                      11800002
*   OUTPUT         = R2 PTS TO THE XSA                                  11850002
*   RETURN CODES   = NONE                                               11900002
*                                                                       12000002
* EXITS - NORMAL 2 = TO IEE5703D                                        12050002
*                    VIA BRANCH                                         12100002
*    CONDITIONS    = TO PROCESS A HARDCPY,OFF COMMAND                   12150002
*    OUTPUT        = REG 2 PTS TO THE XSA                               12200002
*                    XAE = X'00'                                        12250002
*    RETURN CODES  = NONE                                               12300002
*                                                                       12400002
* EXITS - ERROR    = TO IEE5703D VIA BRANCH                             12450002
*    CONDITIONS    = ERROR HAS BEEN DETECTED IN THE COMMAND             12550002
*    OUTPUT        = REG2 PTR TO THE XSA                                12600002
*                    XAE = X'20' - MEANS:  IEE5703D MUST GO             12650002
*                                 TO IEE0503D FOR MSG:                  12700002
*                                 'IEE309I UNIDENTIFIABLE KEYWORD'      12750002
*                    XAE = X'24' - MEANS:  IEE5703D MUST GO             12800002
*                                 TO IEE2103D FOR MSG:                  12850002
*                                 'IEE345I AUTHORITY INVALID'           12900002
*                    XAE = X'28' - MEANS: IEE5703D MUST GO              12950002
*                                 TO IEE0503D FOR MSG:                  13000002
*                                 'IEE306I INVALID NUMERICS'            13050002
*    RETURN CODES  = NONE                                               13100002
*                                                                       13200002
* EXTERNAL REFERENCES                                                   13250002
*    ROUTINES      = IEE7203D                                           13300002
*                  = IEE5703D                                           13350002
*    DATA AREAS    = SEE EXITS - OUTPUT - DATA                          13400002
*                                                                       13450002
* CONTROL BLOCKS   = .EXTENDED SAVE AREA (XSA)                          13500002
*                    .UNIT CONTROL MODULE (UCM)                         13550002
*                       FIELDS TESTED  - UCMDISP- BIT= UCMDISPA         13600002
*                                        UCMVEA                         13650002
*                       FIELDS UPDATED - NONE                           13700002
*                    .CVT                                               13750002
*                       FIELDS TESTED  - CVTCUCB                        13800002
*                       FIELDS UPDATED - NONE                           13850002
*                                                                       13900002
* TABLES           = NONE                                               13950002
*                                                                       14000002
* MACROS           = NONE                                               14050002
*                                                                       14100002
* MAPPING MACROS   = IEEXSA                                             14150002
*                    IEECUCM                                            14200002
*                    CVT                                                14250002
*    SERIALIZATION = NO SERIALIZATION IS REQUIRED IN THIS MODULE.       14260002
*                    ONLY FIELD TESTED IS 'UCMDISP' AREA IN THE UCM TO  14270002
*                    CHECK BIT = UCMDISP = DID THE MASTER CONSOLE       14280002
*                    ISSUE THE COMMAND (SINCE IT IS ONLY VALID FROM     14290002
*                    THE MASTER CONSOLE.)                               14292002
*                    A SITUATION COULD ARISE WHERE THE 'MASTER CONSOLE' 14294002
*                    IS CHANGING TO OR FROM THE MASTER CONSOLE STATE    14296002
*                    WHEN CONTROL IS RECEIVED IN THIS MODULE FOR A      14298402
*                    VARY HARDCPY OR VARY HARDCPY,OFF COMMAND.          14298802
*                    HOWEVER, IF IT IS CHANGING TO THE MASTER CONSOLE   14299202
*                    STATE AND THE UCMDISP BIT IS STILL NOT ON, THEN    14299602
*                    THE COMMAND IS REJECTED AS IT WOULD HAPPEN IF THE  14299702
*                    BIT WAS OFF AND TECHNICALLY, AS LONG AS THE        14299802
*                    BIT IS OFF THE DEVICE IS NOT THE MASTER.           14299902
*                    IF IT IS CHANGING TO THE MASTER CONSOLE STATE AND  14333202
*                    AND THIS BIT IS ON ALREADY, THEN IT IS A MASTER    14383202
*                    CONSOLE AND CAN ISSUE THIS COMMAND ANYWAY. (A LOCK 14393202
*                    WOULD NOT CHANGE THESE SITUATIONS)                 14395202
*                    IF IT IS CHANGING OUT OF THE MASTER CONSOLE STATE  14397202
*                    WHETHER A LOCK IS HELD OF NOT IN THIS FIELD, AS    14399202
*                    LONG AS UCMDISPA IS STILL ON, THIS DEVICE IS       14399602
*                    TECHNICALLY STILL THE MASTER CONSOLE AND CAN       14399702
*                    ISSUE THIS COMMANDS.                               14399802
*                                                                       14400002
* CHANGE LEVEL     = Y02669, Y02651, Z30LPTJ, ZA12703          @ZA12703 14420003
*                                                                       14500002
* CHANGE ACTIVITY  = N/A                                                14510002
*                                                                       14520002
* MESSAGES         = REFER TO EXITS - ERROR                             14550002
*                                                                       14600002
* ABEND CODES      = NONE                                               14750002
*                                                                       14800002
* PACKAGING        = IEE4703D WILL BE PART OF LOAD MODULE               14950002
*                       = IGC0003D                                      15000002
*                    THIS LOAD MODULE ALIASES ARE                       15050002
*                       = NONE                                          15100002
*                    THIS LOAD MODULE ENTRY POINTS ARE                  15150002
*                       = IGC0003D                                      15200002
*                    THIS ROUTINE WILL RESIDE IN: LPALIB                15210002
*                                                                       15250002
* SYSGEN           = SUPPLIED BY THE FOLLOWING SECTIONS:                15450002
*                    LOAD MODULE NAME                                   15500002
*                    PACKAGING                                          15550002
*                    THIS CSECT WILL BE INCLUDED AT SYSGEN FROM         15560002
*                    DLIB -AOSB3- BY MACRO -SGIEF441-                   15570002
*                                                                       15600002
* SYSTEM LIBRARIES = NONE                                               15650002
*                                                                       15700002
*********************************************************************** 26000018
      EJECT                                                             26050002
F0       EQU   X'F0'                                              M3945 26060020
F1       EQU   X'F1'                                              M3945 26070020
F6       EQU   X'F6'                                              M3945 26080020
F9       EQU   X'F9'                                              M3945 26090020
         EJECT                                                          26100018
* HARDCOPY PROCESSOR REGISTER ASSIGNMENTS-                            * 26200018
         SPACE 10                                                       26300019
DEFREG   EQU   *                                                 Y02669 26350002
R0      EQU   0                                                         26400018
R1       EQU   1                                                  19084 26450019
R2       EQU   2                   XSA                            19084 26500019
R3       EQU   3                   ADDRESS                        19084 26550019
R4       EQU   4                   UCME                           19084 26600019
R5       EQU   5                                                  19084 26650019
R6       EQU   6                                                        26700019
R7       EQU   7                                                        26750019
R8       EQU   8                   STAE                           19084 26800019
R9       EQU   9                   UNIT PTR                       19084 26850019
R10      EQU   10                  UCM                            19084 26900019
R11      EQU   11                  UCMPFX                         19084 26950019
R12      EQU   12                  UNIT PTR IF 0,ITS SYSLOG       19084 27000019
R13      EQU   13                                                       27050019
R14      EQU   14                      RETURN REGISTER                  27100019
R15      EQU   15                                                 19084 27150019
         SPACE 10                                                       27200019
*                                                                       27250019
* ISSUING CONSOLE IDENT MASKS                                           27300019
*                                                                       27350019
HSYSTEM  EQU   0                       SYSTEM ISSUING ID                27400019
HRI      EQU   X'80'                   READER/INTERPRETER ID            27450019
*                                                                       27500019
         SPACE 5                                                        27550019
*                                                                       27600019
* ERROR MESSAGE CODES                                                   27650019
*                                                                       27700019
ERR41    EQU   24                  AUTHORITY INVALID - 2103D      19084 27750019
ERR9     EQU   20                  KEYWORD MISPELLED - 0503D      19084 27900019
ERR6     EQU   28                  INVALID NUMERICS - 0503D       19084 27950019
*                                                                       28000019
         SPACE 5                                                        28050019
*                                                                 19084 28100019
* GENERAL EQUATES                                                 19084 28150019
*                                                                 19084 28200019
HOFFCD   EQU   X'00'               VARY HARDCPY,OFF      5703D    19084 28400019
*                                                                 19084 28500019
*                                                                 19084 28550019
BLANK    EQU   C' '                                                     28600019
COMMA    EQU   C','                                               19084 28650019
BLK      EQU   C' '                                               19084 28700019
LEFPAREN EQU   C'('                                               19084 28750019
RTPAREN  EQU   C')'                                               19084 28800019
*                                                                       28850019
* NUMERAL EQUATES                                                 19084 28900019
*                                                                 19084 28950019
ZERO     EQU   0                                                        29000019
ONE      EQU   1                                                        29050019
TWO      EQU   2                                                        29100019
TRE      EQU   3                                                        29150019
FOR      EQU   4                                                        29200019
FIV      EQU   5                                                        29250019
SIX      EQU   6                                                        29300019
EIT      EQU   8                                                        29350019
ELEV     EQU   11                                                       29400019
SVN      EQU   7                                                        29450019
TWLV     EQU   12                                                 19084 29500019
SIXTN    EQU   16                                                 19084 29600019
FOX      EQU   255                                                      29650019
         EJECT                                                          29700019
*********************************************************************** 29750019
*                                                                     * 29800019
* HARDCOPY PROCESSING MODULE                                          * 29850019
*                                                                     * 29900019
*********************************************************************** 29950019
         BALR  R3,ZERO             ADDRESSABILITY                 19084 30000019
         USING *,R3                                               19084 30050019
         MODID BR=YES                                            Y01886 30060001
         USING XSA,R2                                             19084 30100019
         MVC   XAX(EIT),HCPYMOD                                  Y02669 30110002
         L     R15,CVTPTR          CVT POINTER                    19084 30150019
         USING HCVTSET,R15                                        19084 30200019
         L     R10,CVTCUCB         PTR TO UCM                     19084 30250019
         USING UCM,R10                                           Y02669 30300002
*                                                                 19084 30350019
         LR    R11,R10             PTR TO UCM                     19084 30400019
         LA    R1,FOR                                             19084 30450019
         SR    R11,R1              MINUS FOUR IS PTR TO PFX       19084 30500019
         L     R11,ZERO(R11)                                      19084 30550019
         USING UCMPRFX,R11                                        19084 30600019
         L     R9,XAL              PTR TO UNITS                   19084 30650019
         LA    R9,ZERO(R9)         CLEAR HIGH ORDER BYTE          19084 30700019
         XC    XAS(EIT),XAS                                       19084 30750019
*********************************************************************** 30800019
*                                                                       30850019
* CHECK OF COMMAND AUTHORITY FOR VARY HARDCPY                           30900019
*                                                                       30950019
*********************************************************************** 31000019
         CLI   XAU,HSYSTEM         DID SYSTEM ISSUE THE COMMAND         31050019
         BE    HSYNTAX                   YES,BEGIN UNIT SCAN      19084 31100019
*                                                                       31150019
         CLI   XAU,HRI             DID THE R/I ISSUE IT                 31200019
         BNE   HCONSOLE                NO,CHECK CONSOLES CMD AUTHORITY  31250019
         MVI   XAU,HSYSTEM             R/I MESSAGES ALSO RETURN MSTCONS 31300019
HERR1    EQU   *                                                  19084 31350019
         MVI   XAE,ERR41           ERROR IS AUTHORITY INVALID     19084 31400019
         B     HOFFMVC             GO TO XCTL ROUTINE             19084 31450019
*                                                                 19084 31500019
HCONSOLE EQU   *                                                  19084 31550019
         SR    R5,R5                                              19084 31600019
         IC    R5,XAU              ISSUING CONSOLE ID             19084 31650019
         LM    R6,R7,UCMVEA        PTR TO 1ST UCME AND SIZE       19084 31700019
*                                                                 19084 31750019
         BCTR  R5,ZERO             MINUS1                         19084 31800019
         MR    R4,R7               TIMES ZIZE                     19084 31850019
         AR    R5,R6               PLUS ADDR OF 1ST UCME          19084 31900019
         USING UCMLIST,R5                                         19084 31950019
         TM    UCMDISP,UCMDISPA    MASTER CONSOLE WAS ISSUED      19084 32000019
         BZ    HERR1               NO, AUTHORITY INVALID          19084 32050019
         DROP  R5                                                 19084 32100019
         EJECT                                                          32150019
*********************************************************************** 32200019
*                                                                 19084 32250019
*        SYNTAX SCAN, TRY TO FIND SECONDARY KEYWORD               19084 32300019
*                                                                 19084 32350019
*********************************************************************** 32400019
*        R9 PTS TO BEGINNING OF UNIT FIELD                        19084 32450019
*                                                                 19084 32500019
*        A.    SCAN TOWARDS -,HARDCPY-                            19084 32550019
*        *******************************                          19084 32600019
HSYNTAX  EQU   *                                                  19084 32650019
         LR    R12,R9              SAVE UNIT PTR                  19084 32700019
HLOOPFND EQU   *                                                  19084 32750019
         CLI   ZERO(R9),COMMA      IS THIS THE UNITS COMMA        19084 32800019
         LA    R9,ONE(R9)          NO, INDEX BY ONE               19084 32850019
         BNE   HLOOPFND            GO CHECK NEXT CHARACTER        19084 32900019
         SPACE 10                                                 19084 32950019
*        FOUND KEYWORD                                            19084 33000019
*        B.    INDEX PAST KEYWORD AND CHECK FOR OTHERS PRESENT    19084 33050019
*        ******************************************************** 19084 33100019
HKEYFND  EQU   *                                                  19084 33150019
         LA    R9,SVN(R9)          INDEX PAST KEYWORD             19084 33200019
         CLI   ZERO(R9),COMMA      COMMA FOLLOWS KEYWORD          19084 33250019
         BNE   HEOB                NO, GO CHECK END OF BUFFER     19084 33300019
         SPACE 10                                                 19084 33350019
*                                                                 19084 33400019
*        OTHER KEYWORDS ARE PRESENT                               19084 33450019
*        C.    CHECK FOR CMDS,NOCMDS,OFF AND ,                    19084 33500019
*        ****************************************                 19084 33550019
         CLC   ONE(FOR,R9),HCMDS       IS IS CMDS TO HCPY KEYWORD 19084 33600019
         BE    HSET1               YES, GO SET SWITCHES           19084 33650019
         CLC   ONE(SIX,R9),HNOCMDS     IS IT CMDS NOT TO HCPY     19084 33700019
         BNE   HSP8                NO MAYBE OTHER KEYWORD         19084 33750019
INCRMT   EQU   *                                                  21002 33760001
         LA    R9,SVN(R9)          INDEX PAST IT                  19084 33800019
HSP6     EQU   *                                                  19084 33850019
         OI    XASOPCOD,XACMD     TURN ON CMD TO BE CHANGED BIT@Z30LPTJ 33900003
         B     HROUTCK                 CHECK ROUT KEYWORD.        21002 33910001
*                                                                 19084 33950019
HSP8     EQU   *                                                  19084 34450019
         CLC   ONE(SIX,R9),HINCMDS     IS THIS INCMDS             21002 34492001
         BE    HSET3                   SET BITS TO INDICATE INCMDS21002 34494001
         CLC   ONE(SIX,R9),HSTCMDS     IS THIS STCMDS             21002 34496001
         BE    HSET4                   YES, SET BITS TO INDICATE  21002 34498001
         LA    R9,ONE(R9)          INDEX BY ONE                   19084 34500019
         CLC   ZERO(TRE,R9),HOFF       IS IT THE HARDCPY,OFF      19084 34550019
         BNE   HROUTCK             NO, CHECK IF ,ROUT= PRESENT    19084 34600019
*                                  FOR HARDCPY,, CMD              19084 34650019
         MVI   XAE,HOFFCD          SER ,OFF CODE FOR 5703D        19084 34700019
         B     HOFFMVC             GO TO 5703D EXIT               19084 34750019
HSET1    EQU   *                                                  19084 34800019
         OI    XASWITCH,XAHRDCMD   TURN TO MEAN THAT CMDS ARE  @Z30LPTJ 34850003
         LA    R9,FIV(R9)          INDEX PAST KEYWORD             19084 34900019
         B     HSP6                GO CHECK ENDINGS               19084 34950019
HSET3    EQU   *                                                  21002 34960001
         OI    XASWITCH,XAINHDCP       INDICATE INCMDS         @Z30LPTJ 34970003
         B     INCRMT                  INCREMENT PAST INCMDS.     21002 34982001
HSET4    EQU   *                                                  21002 34990001
         OI    XASWITCH,XASTHDCP       INDICATE STCMDS         @Z30LPTJ 34992003
         B     INCRMT                  INCREMENT PAST STCMDS.     21002 34994001
         SPACE 6                                                  21002 35000001
*        D.    CHECK FOR PRESENCE OF ROUT= KEYWORD                21002 35010001
*        **********************************************           21002 35020001
HROUTCK  EQU   *                                                  21002 35030001
         CLC   ZERO(SIX,R9),HROUT      IS ,ROUT=PRESENT           21002 35040001
         BE    HROUTRTN                YES,GO CHECK ROUT=         21002 35042001
         CLC   ZERO(FIV,R9),HROUT+ONE  IS IT 'ROUT='              21002 35044001
         BNE   HEOB                    NO, CHECK END OF BUFFER    21002 35046001
         BCTR  R9,ZERO                 MINUS ONE                  21002 35048001
         EJECT                                                    19084 35050019
*                                                                 19084 35100019
*        E.    ROUT= IS PRESENT                                   19084 35150019
*        **************************                               19084 35200019
*                                                                 19084 35250019
*********************************************************************** 35300019
*              VALUES FOR ROUT=                                   19084 35350019
**********************************************************************  35400019
*                                                                 19084 35450019
HROUTRTN EQU   *                                                  19084 35500019
         SR    R6,R6               CLEAR EXTERIOR PARENS SWITCH   19084 35550019
         LA    R9,SIX(R9)       UPDATE TO PARM                    19084 35650019
         CLI   ZERO(R9),LEFPAREN   ARE THERE INDIVIDUAL ROUTCODES 19084 35700019
         BE    KPAREN2        YES, GO PROCESS                     19084 35750019
         CLC   ZERO(TRE,R9),KALL   ARE ALL RTCDS TO BE ASSIGNED   19084 35800019
         BNE   KK2            NO, GO CHECK FOR OTHERS             19084 35850019
         OI    XASWITCH,XAROUT       ROUT CODES TO BE CHANGED  @ZA12703 35870003
         MVC   XARTCODE(TWO),KFFFF   SET ALL ROUTING CODES     @Z30LPTJ 35900003
         BCTR  R9,ZERO                                            19084 35950019
HEOB1    EQU   *                                                  19084 36000019
         LA    R9,FOR(R9)          INDEX PAST KEYWORD JUST CHECKED19084 36050019
HEOB     EQU   *                                                  19084 36100019
         L     R7,XAR             PTR TO LIST POSITION            19084 36150019
         LA    R7,ZERO(R7)         CLEAR HIGH ORDER BYTE          19084 36200019
         AH    R7,ZERO(R7)         COMPUTE END OF BUFFER          19084 36250019
         CR    R9,R7               ARE WE AT THE END              19084 36300019
         BH    HERR2               NO, WE ARE OVER ERROR          19084 36350019
         BE    HSCAN               WE ARE OK, GO START PROCESS    19084 36400019
         CLI   ZERO(R9),BLANK      IS BLANK A DELIMITER FOR END   19084 36450019
         BE    HSCAN               GO START PROCESS               19084 36500019
HERR2    EQU   *                                                  19084 36550019
         MVI   XAE,ERR9            ERROR CODE IS 9KEYWORD MISPELD 19084 36600019
         B     HOFFMVC             GO TO EXIT RTN                 19084 36650019
*                                                                 19084 36700019
*                                                                 19084 36750019
KK2      EQU   *                                                  19084 36800019
         CLC   ZERO(FOR,R9),KNONE  ARE THERE NO RTCDS TO BE ASSGND19084 36850019
         BNE   KPAR1               NONE IS NOT THE PARM CHECK MORE19084 36900019
         OI    XASWITCH,XAROUT     ROUT CODES TO BE CHANGED    @ZA12703 36910003
         SR    R1,R1               CLEAR REGISTER              @ZA12703 36920003
         STH   R1,XARTCODE         NO ROUTE CODES WANTED       @ZA12703 36930003
         B     HEOB1               GO CHECK END OF BUFFER         19084 36950019
*                                                                 19084 37000019
KPAREN2  EQU   *                                                  19084 37050019
         LA    R9,ONE(R9)       UPDATE TO PASS THE PAREN          19084 37100019
         BCTR  R6,ZERO             SET EXTERNAL PARENS SWITCH     19084 37150019
*                                                                 19084 37200019
KPAR1    EQU   *                                                  19084 37250019
         XC    XAP(TWLV),XAP       CLEAR AREA FOR CVB OF RT CDS   19084 37300019
         CLI   ONE(R9),COMMA       ONE DIGIT NUM FOLLOWED BY COMMA19084 37350019
         BE    KPAR6               YES,GO PROCESS                 19084 37400019
         CLI   ONE(R9),RTPAREN     IS A RIGHT PARENS THAT FOLLOWS 19084 37450019
         BE    KPAR1B              FIND IF NEEDED                 19084 37500019
         CLI   TWO(R9),COMMA       TWO DIGIT NUM FOLLOWED BY COMMA19084 37550019
         BE    KPAR2          YES                                 19084 37600019
KPAR1B   EQU   *                                                  19084 37650019
         LTR   R6,R6          EXTERIOR PAREN SWITH SET            19084 37700019
         BZ    KPAR8          NO, ERROR                           19084 37750019
         CLI   ONE(R9),RTPAREN     YES,ONE DIGIT NUMB PLUS )      19084 37800019
         BE    KPAR6          YES, PROCESS                        19084 37850019
         CLI   TWO(R9),RTPAREN     TWO DIGIT NUM FOLLOWED BY ')'  19084 37900019
         BNE   HERR2               NO, KEYWORD IS MISPELLED       19084 38000019
*                                                                 19084 38050019
KPAR2    EQU   *                                                  19084 38100019
         CLI   ZERO(R9),F1             SYNTAX CHECK THE ROUTING   M3945 38107020
         BNE   HERR6                   CODE. THE 1ST DIGIT MUST   M3945 38114020
         CLI   ONE(R9),F0              BE 1, THE 2ND DIGIT MUST   M3945 38121020
         BL    HERR6                   BE 0-6. OTHERWISE, AN      M3945 38128020
         CLI   ONE(R9),F6              ERROR CONDITION HAS BEEN   M3945 38135020
         BH    HERR6                   DETECTED                   M3945 38142020
         PACK  XAD+TWO(TWO),ZERO(TWO,R9)  RTCODE IS 2 DIGITS      19084 38150019
KPAR3    EQU   *                                                  19084 38200019
         LA    R9,TWO(R9)           INDEX PAST DIGITS             19084 38250019
         LA    R13,SIXTN           MAXIMUM VALUE ALLOWED          19084 38300019
         CVB   R4,XAP         CONVERT PACKED DECIMAL              19084 38350019
         LTR   R4,R4          IS IT ZERO                          19084 38400019
         BZ    HERR6          YES, ILLEGAL                        19084 38450019
         CR    R4,R13         IS IT 16                            19084 38500019
         BE    KPAR7               YES, NO ROUT TO BE SET         19084 38550019
         BH    HERR6               HIGH, IT IS ILLEGAL KEYWORD    19084 38600019
*                                                                 19084 38650019
         BCTR  R4,ZERO             SET TO ZERO BASE               19084 38750019
         OI    XASWITCH,XAROUT     ROUT CODES TO BE CHANGED    @ZA12703 38770003
         SLL   R13,ELEV            SET FIRST BIT OF MASK ON       19084 38800019
         SRL   R13,ZERO(R4)        MOVE TO APPROPRIATE RT CODE BIT19084 38850019
         O     R13,XACMDATH     SET BIT IN INDICATOR AREA      @Z30LPTJ 38900003
         ST    R13,XACMDATH     AND SAVE IN XSA                @Z30LPTJ 38950003
*                                                                 19084 39000019
KPAR5    EQU   *                                                  19084 39050019
         LTR   R6,R6          EXTERIOR PARENS SET                 19084 39100019
         BZ    HEOB                GO CHECK IF END OF BUFFER      19084 39150019
         CLI   ZERO(R9),RTPAREN    YES,CHECK IF ')' PRESENT       19084 39200019
         LA    R9,ONE(R9)          YES, UPDATE PAST PARENS        19084 39250019
         BNE   KPAR1          NO, MORE ROUT CODES, PROCESS        19084 39300019
         B     HEOB                GO PUT IT IN ROUT FIELD        19084 39350019
*                                                                 19084 39400019
KPAR8    EQU   *                                                  19084 39450019
         CLI   ONE(R9),BLK         BLANK MAY FOLLOW SINGLE DIGIT  19084 39500019
         BNE   KPAR2               GO PROCESS IT                  19084 39550019
KPAR6    EQU   *                                                  19084 39600019
         CLI   ZERO(R9),F0             SYNTAX CHECK THE DIGIT     M3945 39610020
         BL    HERR6                   USED AS THE ROUTCODE. IT   M3945 39620020
         CLI   ZERO(R9),F9             MUST BE 0-9 SINCE ROUTCODE M3945 39630020
         BH    HERR6                   IS ONE CHARACTER           M3945 39640020
         PACK  XAD+TRE(ONE),ZERO(ONE,R9)     ROUT CODE IS ONE DGT 19084 39650019
         BCTR  R9,ZERO                                            19084 39700019
         B     KPAR3          GO TO PROCESS                       19084 39750019
*                                                                 19084 39800019
KPAR7    EQU   *                                                  19084 39850019
         LTR   R6,R6               ANY MORE ROUTS                 19084 39900019
         BNZ   KPAR5               MAYBE, GO CHECK                19084 39950019
         B     HEOB                GO CHECK ACCURACY OF EOB       19084 40400019
         EJECT                                                          41170019
         EJECT                                                          58700019
*********************************************************************** 58800019
*                                                                       58900019
* ERROR MESSAGE ROUTINES                                                59000019
* AND EXIT ROUTINE                                                19084 59100019
*                                                                       59200019
*********************************************************************** 59300019
*                                                                       59400019
*                                                                       59500019
HSCAN    EQU   *                                                  21002 59700001
         MVC   XAX+TRE(TWO),UNITSCAN       IGC7203D              Y02669 59750002
         L     R15,VCON72              ADDRESS OF 7203D          Y02669 59800002
         BR    R15                                               Y02669 59850002
HERR6    EQU   *                                                  19084 61400019
         MVI   XAE,ERR6            INVALID NUMERICS               19084 61500019
HOFFMVC  EQU   *                                                  21002 61670001
         MVC   XAX+TRE(TWO),OFFMOD         IGC5703D              Y02669 61680002
         L     R15,VCON57          ADDRESS OF IEE5703D           Y02669 61682002
         BR    R15                 XCTL TO HARDCOPY OFF PROCESSORY02669 61690002
         EJECT                                                          61700019
*********************************************************************** 61800019
*                                                                       61900019
* CONSTANTS USED BY HARDCPY PROCESSOR                                   62000019
*                                                                       62100019
*********************************************************************** 62200019
OFFMOD   DC    C'57'         HARDCPY,OFF PROCESSOR               Y02669 62900002
HOFF     DC    C'OFF'              HARDCPY,OFF                    19084 63000019
*                                                                 19084 63100019
*                                                                 19084 63200019
*        DO NOT SEPARATE THE FOLLOWING TWO DECALRES -NO CMDS-     19084 63300019
HNOCMDS  DC    C'NO'               NO CMDS TO HCPY                19084 63400019
HCMDS    DC    C'CMDS'             CMDS TO HARDCPY                19084 63500019
HINCMDS  DC    C'INCMDS'               NO STATUS DISPLAY TO       21002*63550001
                                       HARDCOPY.                  21002 63552001
HSTCMDS  DC    C'STCMDS'               NO DYNAMIC STATUS DISPLAY  21002*63560001
                                       TO HARDCOPY.               21002 63570001
HROUT    DC    C',ROUT='           ROUT KEYWORD                   19084 63600019
KNONE    DC    C'NONE'             CHECK FOR ROUT=                19084 63700019
KFFFF    DC    X'FFFF'             MASK FOR ALL ROUT CODES        19084 63800019
KALL     DC    C'ALL'              CHECK FOR ALL AUTH,RTCDS       19084 63900019
UNITSCAN DC    C'72'           UNIT SCAN PROCESSOR               Y02669 74000002
HCPYMOD  DC    CL8'IEE4703D'                                     Y02669 74010002
         DS    0F                                                Y02669 74050002
VCON57   DC    V(IEE5703D)                                       Y02669 74100002
VCON72   DC    V(IEE7203D)                                       Y02669 74150002
                   SPACE 5                                              74160002
PATCH    DC   CL50'***IEE4703D***'                             @Z30LPTJ 74170003
*                                                                       74180002
         END                                                            74200018
