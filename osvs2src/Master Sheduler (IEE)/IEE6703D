        TITLE 'IEE6703D K AND STOPTR COMMAND HANDLER'                   00100002
*********************************************************************** 00150002
*                                                                     * 00200002
*   MODULE NAME         =       IEE6703D                        Y02669* 00250002
*                                                                     * 00300002
*   DESCRIPTIVE NAME    =       CONTROL (K) AND STOPTR (PT)     Y02669* 00350002
*                               COMMAND HANDLER FOR GRAPHICS    Y02669* 00360002
*                               DEVICES                         Y02669* 00370002
*                                                                     * 00400002
*   COPYRIGHT           =       N/A                             Y02669* 00450002
*                                                                     * 00500002
*   STATUS              =       01 - UPDATE FOR VS/2 RELEASE 3 ZA03632* 00550003
*                                                                     * 00600002
*   FUNCTION            =       SYNTAX CHECK CONTROL (K)        Y02669* 00650002
*                               COMMANDS. SCHEDULES K COMMANDS  Y02669* 00700002
*                               BY POSTING DIDOCS, WHEN THEY    Y02669* 00710002
*                               MUST BE HANDLED BY USING THE    Y02669* 00750002
*                               TRANSIENT PORTION OF THE        Y02669* 00800002
*                               DISPLAY CONTROL MODULE (DCM).   Y02669* 00850002
*                               K COMMANDS WHICH ARE HANDLED    Y02669* 00900002
*                               USING ONLY THE RESIDENT PORTION Y02669* 00950002
*                               OF THE DCM ARE HANDLED BY       Y02669* 01000002
*                               ROUTING THE COMMAND TO THE      Y02669* 01050002
*                               APPROPIATE ROUTINES FOR         Y02669* 01050802
*                               ADDITIONAL PROCESSING.          Y02669* 01051202
*                                                                     * 01052402
*                               FOR STOPTR COMMANDS FOR WHICH   Y02669* 01054002
*                               THE SCREEN MUST BE CLEARED      Y02669* 01054402
*                               (I.E. PT A OR IF THERE IS NO    Y02669* 01054802
*                               REMAINING ACTIVE TRACK OPTION)  Y02669* 01055202
*                               A PARAMETER LIST IS BUILT IN    Y02669* 01055602
*                               SP241 CONTAINING THE COMMAND    Y02669* 01056002
*                               AND OPERANDS, TRACK PROCESSOR   Y02669* 01058002
*                               IS POSTED AND EITHER CONTROL    Y02669* 01058402
*                               IS RETURNED OR DIDOCS POSTED.   Y02669* 01060002
*                                                                     * 01080002
*    OPERATION          =       FOR THE FOLLOWING COMMANDS,     Y02669* 01090002
*                               IF AN L OPERAND WAS SPECIFIED   Y02669* 01090402
*                               MESSAGE 'IEE926I' IS ISSUED VIA Y02669* 01090802
*                               IEE5603D. OTHERWISE A K-PARM    Y02669* 01091202
*                               LIST IS BUILT WITH A MODULE     Y02669* 01092002
*                               IDENTIFIER, THE OPERAND LIST,   Y02669* 01092402
*                               THE AREA ID, AND A CONTROL      Y02669* 01094002
*                               COMMAND INDICATOR.              Y02669* 01096002
*                               (SEE DATA AREAS)                Y02669* 01096402
*                               CONTROL IS THEN EITHER RETURNED Y02669* 01098002
*                               OR DIDOCS IS POSTED (SEE EXITS).Y02669* 01098402
         EJECT                                                          01098502
*                                                                     * 01098802
*                                  COMMANDS     MOD ID          Y02669* 01099702
*                                  ________    _________        Y02669* 01099802
*                                  K  E,       IGC5607B         Y02669* 01100002
*                                  K  E,N      IGC5407B         Y02669* 01110002
*                                  K  S        IGC5A07B         Y02669* 01120002
*                                  K  S,       IGC5A07B         YM1913* 01125002
*                                  K  D        IGC5907B         Y02669* 01130002
*                                  K  D,N      IGC5907D         Y02669* 01140002
*                                  K  D,N,HOLD IGC5907D         Y02669* 01142002
*                                  K  E,PFK    IGC6B07B         Y02669* 01144002
*                                  K  D,PFK    IGC6B07B         Y02669* 01146002
*                                  K  N        IGC6B07B         Y02669* 01148002
*                                  K  E        IGC5807B         Y02669* 01148402
*                                  K  E,SEG    IGC5807B         Y02669* 01148802
*                                                                     * 01149202
*                               FOR THE FOLLOWING COMMANDS,     Y02669* 01149602
*                               NO PROCESSING IS DONE IN THIS   Y02669* 01149702
*                               MODULE:                         Y02669* 01149802
*                                                                     * 01160002
*                                  K  V    BRANCHES TO IEE7703D Y02669* 01162302
*                                  K  C,D  BRANCHES TO IEE7803D Y02669* 01172302
*                                  K  A    BRANCHES TO IEE6803D Y02669* 01174302
*                                  K  T    BRANCHES TO IEE6803D Y02669* 01184302
*                                                                     * 01187002
*                               FOR THE FOLLOWING COMMANDS,     Y02669* 01187402
*                               INITIAL PROCESSING IS DONE IN   Y02669* 01189402
*                               THIS MODULE.                    Y02669* 01191602
*                               THEN THE K-PARM LIST IS BUILT   Y02669* 01193602
*                               AND CONTROL IS EITHER RETURNED  Y02669* 01195602
*                               OR DIDOCS IS POSTED (SEE EXITS).Y02669* 01195702
*                                                                     * 01202002
*                                  COMMAND      MOD ID          Y02669* 01204002
*                                  ________    ________         Y02669* 01206002
*                                  K   E,D     IGC6P07B         Y02669* 01208002
*                                  K   D,F     IGC6N07B         Y02669* 01208402
*                                  K   D,U     IGC6N07B         Y02669* 01208802
*                                  K   D,H     IGC6N07B         Y02669* 01208902
*                                                                     * 01209302
*                               BASED ON THE L=CCA OPERAND ON   Y02669* 01210902
*                               THE COMMAND THE INITIAL         Y02669* 01211302
*                               PROCESSING IS AS FOLLOWS:       Y02669* 01211702
*                          #### IF AN AREA IS SPECIFIED ON THE  Y02669* 01212902
*                               COMMAND AND IT DOES NOT MATCH   Y02669* 01213302
*                               ANY EXISTING AREA - 'IEE151I    Y02669* 01213702
*                               NO DISPLAY IN AREA.'            Y02669* 01214902
         EJECT                                                          01216902
*                                                                     * 01219502
*                             # IF AREAS MATCH AND OPERAND      Y02669* 01219602
*                               FIELD IS D,H OR D,U:            Y02669* 01220802
*                               IF NO DISPLAY IN AREA - IEE158I Y02669* 01222002
*                               IF IT IS NOT DYNAMIC - IEE158I  Y02669* 01223202
*                               OTHERWISE FLAG SET IN SACB FOR  Y02669* 01224402
*                               HOLD AND CLEARED FOR UPDATE:    Y02669* 01225402
*                                  DCMADFLG = DCMAHOLD (X'40')  Y02669* 01226802
*                               AND THE PARM LIST IS BUILT.     Y02669* 01228002
*                                                                     * 01228402
*                             # IF AREAS MATCH AND OPERAND      Y02669* 01229202
*                               FIELD IS D,F:                   Y02669* 01229602
*                               IF NO DISPLAY IN AREA - IEE158I Y02669* 01231602
*                               IF FRAMING IN PROCESS - IEE158I Y02669* 01232802
*                               IF LAST FRAME ON SCREEN-IEE158I Y02669* 01234002
*                               OTHERWISE SET FRAMING IN        Y02669* 01235202
*                               PROCESS BIT IN DCM:             Y02669* 01236402
*                                  DCMAFLG1 - DCMAFRPR (X'10')  Y02669* 01237602
*                               AND THE PARM LIST IS BUILT.     Y02669* 01238802
*                                                                     * 01239202
*                             # IF AREAS MATCH AND OPERAND      Y02669* 01240002
*                               FIELD IS E,D:                   Y02669* 01241202
*                               IF NO DISPLAY IN AREA - IEE158I Y02669* 01242402
*                               IF DISPLAY IS DYNAMIC - IEE151I Y02669* 01243602
*                                 USE STOPTR                    Y02669* 01244402
*                               OTHERWISE, THE PARM LIST IS     Y02669* 01244802
*                               BUILT.                          Y02669* 01246002
*                                                                     * 01247202
*                          #### IF AREA IS NOT SPECIFIED  ON    Y02669* 01248402
*                               THE COMMAND & THERE IS NO AREA  Y02669* 01249602
*                               IN USE OR THERE IS NO DISPLAY   Y02669* 01250802
*                               IN ANY AREA:                    Y02669* 01251202
*                               FOR D,H AND D,U & E,D AND D,F:  Y02669* 01253202
*                                   IEE158I NO DISP ON SCREEN   Y02669* 01253602
*                               OR IF DISPLAY IS NOT DYNAMIC    Y02669* 01254002
*                                   IEE158I-NO DYNAMIC DISPLAY  Y02669* 01260402
*                                                                     * 01261502
*                              # IF AREA IS IN USE AND DISPLAY  Y02669* 01262602
*                               IS ON SCREEN:                   Y02669* 01263702
*                               FOR E,D AND D,F: IF THERE IS    Y02669* 01264802
*                               MORE THAN ONE ON SCREEN -       Y02669* 01265402
*                                   IEE927I SPECIFY L OPERAND   Y02669* 01266002
*                               IF DYNAMIC DISPLAY - IEE151I    Y02669* 01266602
*                                   USE STOPTR TO DELETE        Y02669* 01267202
*                               IF TOP DISPLAY AREA MOVE AREA   Y02669* 01268102
*                               ID FROM DCM (DCMAID) TO XSA     Y02669* 01269202
*                               (XASDID) AND BUILD PARM LIST.   Y02669* 01270302
*                                                                     * 01271402
         EJECT                                                          01272502
*                             # IF AREA IN USE, WITH DISPLAY IN Y02669* 01273602
*                               AREA                            Y02669* 01274702
*                               FOR D,H AND D,U:                Y02669* 01277502
*                               IF NOT A DYNAMIC DISPLAY        Y02669* 01278802
*                               IEE158I - DISPLAY NOT DYNAMIC   Y02669* 01280102
*                               IF SACB DOESN'T INDICATE THAT   Y02669* 01281402
*                               DISPLAY IN DYNAMIC - IEE927I    Y02669* 01282702
*                               SPECIFY L OPERAND               Y02669* 01284002
*                               IF AREA DEFINED IN SACB MOVE    Y02669* 01284102
*                               AREA ID FROM DCM TO XSA AND     Y02669* 01284202
*                               BUILD THE PARM LIST.            Y02669* 01284302
*                                                                     * 01284402
*                               FOR THE K D,U & STOPTR COMMAND  Y02669* 01284502
*                               THE TRACK PROCESSOR IS POSTED.  Y02669* 01284902
*                               POST IS BRANCH ENTERED THE    @Y02668P* 01285103
*                               LOCKS ARE HELD. LOCAL POST    @Y02668P* 01285803
*                               IF THE COMMAND WAS ISSUED IN  @Y02668P* 01286503
*                               COMTASK'S MEMORY. BRANCH      @ZA03632* 01287203
*                               ENTRY POST IF A MEMORY OTHER  @ZA03632* 01287603
*                               THAN COMTASK ISSUED THE CMD.  @Y02668P* 01288603
*                               (JES3)                        @Y02668P* 01289303
*                                                                     * 01291203
*                               FOR THE STOPTR COMMAND, IF THE  Y02669* 01292303
*                               SCREEN MUST BE CLEARED AND THE  Y02669* 01293403
*                               TARGET AND ISSUING CONSOLE ARE  Y02669* 01295603
*                               THE SAME, A PARM LIST IS BUILT  Y02669* 01297803
*                               IN THE DCM (SEE DATA AREAS FOR  Y02669* 01300003
*                               DESCRIPTION) IN WHICH A STOPTR  Y02669* 01302703
*                               FLAG IS SET, CONTROL IS EITHER  Y02669* 01304703
*                               RETURNED OR DIDOCS IS POSTED    Y02669* 01306703
*                               (SEE EXITS FOR CONDITIONS).     Y02669* 01308603
*                               IF THE TARGET CONSOLE IS NOT    Y02669* 01310503
*                               THE SAME AS THE ISSUING, AN     Y02669* 01314303
*                               AREA MUST BE GOTTEN FOR THE     Y02669* 01316203
*                               PARM LIST FROM SUBPOOL 241      Y02269* 01318103
*                               AND CHAINED TO THE TARGET'S     Y02669* 01320003
*                               RESIDENT DCM. OTHERWISE THE     Y02669* 01322003
*                               PARM LIST IS BUILT IN THE       Y02669* 01324003
*                               TARGET'S TRANSIENT DCM.         Y02669* 01326003
*                               CONTROL IS EITHER RETURNED      Y02669* 01328003
*                               OR DIDOCS IS POSTED.(SEE EXITS) Y02669* 01330003
*                                                                     * 01332003
*   NOTES                                                       Y02669* 01334003
*                                                                     * 01336003
*      CHARACTER CODE                                           Y02669* 01338003
*        DEPENDENCIES   =       ANY CHARACTER CODE OTHER THAN   Y02669* 01340003
*                               EBCDIC WILL REQUIRE REASSEMBLY  Y02669* 01342003
*                               OF THIS MODULE.                 Y02669* 01344003
*                                                                     * 01350002
*      DEPENDENCIES     =       NONE                            Y02669* 01420002
*                                                                     * 01450002
*      RESTRICTIONS     =       ALL TARGET CONSOLES MUST BE     Y02669* 01500002
*                               CRT (GRAPHICS) EXCEPT FOR K C,D Y02669* 01510002
*                               THE L OPERAND IS INVALID ON     Y02669* 01520002
*                               MOST OF THE K COMMANDS.         Y02669* 01530002
*                               (SEE OPERATION)                 Y02669* 01540002
*                                                                     * 01550002
*      REGISTER                                                 Y02669* 01600002
*        CONVENTIONS    =       NONE                            Y02669* 01650002
*                                                                     * 01700002
*      PATCH-LABEL      =       PATCH                           Y02669* 01750002
*                                                                     * 01800002
*   MODULE TYPE         =       CSECT                           Y02669* 01850002
*                                                                     * 01900002
*      PROCESSOR        =       N/A                             Y02669* 01950002
*                                                                     * 02000002
*      MODULE SIZE      =       X'504' + X'48' PATCH AREA       Y02669* 02050002
*                                                                     * 02100002
*      ATTRIBUTES       =       REENTRANT, REFRESHABLE,         Y02669* 02150002
*                               SUPERVISOR MODE, KEY 0,         Y02669* 02210002
*                               PAGED LPA                       Y02669* 02220002
*                                                                     * 02250002
*   ENTRY POINT         =       IEE6703D FROM IEE7503D          Y02669* 02300002
*      PURPOSE          =       TO PROCESS ALL K COMMANDS       Y02669* 02350002
*      LINKAGE          =       BRANCH                          Y02669* 02400002
*      INPUT DATA       =       REG 2 POINTS TO THE XSA         Y02669* 02450002
*                                 XAL-POINTS TO OPERANDS        Y02669* 02460002
*                                 XAN-CONTAINS COMMAND CODE     Y02669* 02470002
*                                 XAS-L=CCA INFORMATION         Y02669* 02480002
*                                 XASSDS5-ON LOCKS HELD         Y02651* 02482002
*                                 XAU-ISSUING UCME INDICATOR    Y02669* 02490002
*                               REG 14 CONTAINS THE RETURN ADDR Y02669* 02500002
*                                                                     * 02550002
*   ENTRY POINT         =       IEE6703D FROM IEE5503D          Y02669* 02600002
*      PURPOSE          =       TO PROCESS THE STOPTR COMMAND   Y02669* 02650002
*      LINKAGE          =       BRANCH                          Y02669* 02700002
*      INPUT DATA       =       REG 2 POINTS TO THE XSA         Y02669* 02750002
*                                 XAL-POINTS TO OPERANDS        Y02669* 02760002
*                                 XAN-COMMAND CODE              Y02669* 02770002
*                                 XAS-L=CCA INFORMATION         Y02669* 02780002
*                             XASSDS3 - ON CMD ISSUED FROM    @Y02668P* 02780603
*                                     ANOTHER MEMORY (JES3)   @Y02668P* 02781203
*                                 XASSDS5-ON LOCKS HELD         Y02651* 02782002
*                                 XAU-ISSUING UCME INDICATOR    Y02669* 02790002
*                               REG 14 CONTAINS THE RETURN ADDR Y02669* 02800002
*                                                                     * 02850002
*      REGISTERS SAVED  =       REGISTERS 11 - 14 BEFORE        Y02651* 02900002
*                               ISSUING SETLOCK AT LOCKSOFF.    Y02651* 02920002
*                                                                     * 02950002
         EJECT                                                          02960002
*      REGISTER CONTENTS                                        Y02669* 03000002
*       DURING PROCESSIMG=      R0  WORK REG                    Y02669* 03050002
*                               R1  WORK REG                    Y02669* 03100002
*                               R2  BASE REG FOR XSA            Y02669* 03150002
*                               R3  WORK REG+TEMP BASE FOR UCM  Y02669* 03200002
*                               R4  WORK REG                    Y02669* 03250002
*                               R5  BASE REG FOR TRANSIENT DCM  Y02669* 03300002
*                               R6  OPERAND POINTER             Y02669* 03350002
*                               R7  WORK REG                    Y02669* 03360002
*                               R8  WORK REG+TEMP BASE FOR RDCM Y02669* 03370002
*                               R9  BASE REG FOR UCM ENTRY+ BAL Y02669* 03372002
*                               R10 BASE REG FOR K PARM LIST    Y02669* 03374002
*                               R11 REG FOR MODULE INDICATOR    Y02669* 03376002
*                               R12 BASE REG FOR SACB           Y02669* 03378002
*                               R13 BASE REG FOR THIS MODULE    Y02669* 03378802
*                               R14 RETURN REG                  Y02669* 03379202
*                               R15 LINK REG                    Y02669* 03379602
*                                                                     * 03380002
*      REGISTERS RESTORED=      REGISTERS 11 - 14 AFTER ISSUING Y02651* 03390002
*                               SETLOCK AT LOCKSOFF.            Y02651* 03391002
*                                                                     * 03392002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03392402
*                                                                     * 03392802
**  EXIT - NORMAL       =       RETURN VIA BR R14 FROM RETURN   Y02669* 03394002
*                               AFTER RELEASING LOCKS           Y02651* 03394402
*      CONDITIONS       =       IMMEDIATE COMMAND PROCESSING IF Y02669* 03396002
*                            1  NO GETMAIN WAS NEEDED FOR THE   Y02669* 03398002
*                               K PARM LIST.                    Y02669* 03399702
*                            2  A GETMAIN WAS NEEDED AND THE    Y02669* 03402402
*                               TARGET DEVICE WAS BUSY.         Y02669* 03404102
*                            3  A GETMAIN WAS NEEDED AND THE    Y02669* 03405802
*                               TARGET DEVICE WAS NOT READY.    Y02669* 03407502
*                            4  UPON RETURN FROM THE POST.      Y02669* 03409202
*      OUTPUT DATA      =       COMMAND PARM LIST IN DCM        Y02669* 03410902
*                               (SEE DATA AREAS)                Y02669* 03411302
*      RETURN CODES     =       NONE                            Y02669* 03412602
*                                                                     * 03414302
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03427902
*                                                                     * 03429602
**  EXIT - NORMAL       =       BRANCH TO IEE6803D FROM D6803D  Y02669* 03431302
*      CONDITIONS       =       TO PROCESS K A,NN,NN COMMAND    Y02669* 03433002
*      OUTPUT DATA      =       SAME AS INPUT(LOCKS STILL HELD) Y02669* 03434702
*      RETURN CODES     =       NONE                            Y02669* 03436402
*                                                                     * 03438102
         EJECT                                                          03438502
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03440102
*                                                                     * 03440302
**  EXIT - NORMAL       =       BRANCH TO IEE6903D FROM D6903D  Y02669* 03440702
*      CONDITIONS       =       TO PROCESS K A COMMAND          Y02669* 03440802
*                                          K A,REF COMMAND      Y02669* 03441002
*                                          K A,NONE COMMAND     Y02669* 03441402
*                                          ALL K T COMMANDS     Y02669* 03441902
*      OUTPUT DATA      =       SAME AS INPUT(LOCKS STILL HELD) Y02669* 03442002
*      RETURN CODES     =       NONE                            Y02669* 03442202
*                                                                     * 03442402
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03442602
*                                                                     * 03442802
**  EXIT - NORMAL       =       BRANCH TO IEE7703D FROM D7703D  Y02669* 03443002
*      CONDITIONS       =       TO PROCESS K V COMMAND          Y02669* 03443202
*      OUTPUT DATA      =       SAME AS INPUT(LOCKS STILL HELD) Y02669* 03444302
*      RETURN CODES     =       NONE                            Y02669* 03446302
*                                                                     * 03446702
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03447102
*                                                                     * 03447402
**  EXIT - NORMAL       =       BRANCH TO IEE7803D FROM D7803D  Y02669* 03450302
*      CONDITIONS       =       PROCESS K C,D COMMAND           Y02669* 03453202
*      OUTPUT DATA      =       SAME AS INPUT(LOCKS STILL HELD) Y02669* 03465202
*      RETURN CODES     =       NONE                            Y02669* 03466002
*                                                                     * 03466102
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03466202
*                                                                     * 03466402
**  EXIT - NORMAL       =       RETURN VIA BR R14 AFTER POSTING Y02669* 03466502
*                               DIDOCS FROM POST                Y02669* 03469802
*                               AFTER RELEASING LOCKS           Y02651* 03471802
*      CONDITIONS       =    1  IF A GETMAIN WAS NEEDED AND     Y02669* 03473302
*                               THE DEVICE IS WAITING.          Y02669* 03476602
*                            2  IF A GETMAIN WAS NEEDED AND     Y02669* 03477002
*                               THE DEVICE WAS READY.           Y02669* 03477402
*      OUTPUT DATA      =       COMMAND PARM LIST IN GETMAINED  Y02669* 03477702
*                               AREA AND CHAINED TO DCM AND     Y02669* 03487702
*                               FLAG SET IN DCM INDICATING      Y02669* 03488102
*                               VALID K COMMAND                 Y02669* 03488502
*                                 DCMSVC34 - DCMMYCMD (X'80')   Y02669* 03489502
*      RETURN CODES     =       NONE                            Y02669* 03490702
*                                                                     * 03491502
         EJECT                                                          03491602
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03516002
*                                                                     * 03517402
**  EXIT - ERROR        =       BRANCH TO IEE5603D FROM D5603D  Y02669* 03518802
*      CONDITIONS       =       TO PROCESS ERROR MESSAGES       Y02669* 03520202
*      OUTPUT DATA      =       ERROR CODES FOR MESSAGES ISSUED Y02669* 03521602
*                               IN IEE5603D AND IEE5903D.       Y02669* 03523002
*      RETURN CODES     =       XAE WILL CONTAIN AN INDEX FOR   Y02669* 03524402
*                               THE MAJOR MESSAGE FOR IEE5603D: Y02669* 03525802
*                                  X'03' - IEE151I DELETE       Y02669* 03527202
*                                          REQUEST INCONSISTENT Y02669* 03528602
*                                  X'04' - IEE156I INVALID      Y02669* 03530002
*                                          OPERAND              Y02669* 03531402
*                                  X'05' - IEE158I K REQUEST    Y02669* 03532802
*                                          INCONSISTENT         Y02669* 03534202
*                                  X'09' - IEE921I REJECTED   @Y02668P* 03534403
*                                  X'0B' - IEE925I OPERAND      Y02669* 03534602
*                                  X'0C' - IEE926I L=CCA        Y02669* 03535602
*                                          OPERAND INVALID      Y02669* 03537002
*                                  X'0D' - IEE927I - K REQUEST  Y02669* 03538402
*                                          AMBIGUOUS            Y02669* 03539802
*                                  X'0E' - IEE930I-INSUFFICIENT Y02669* 03540202
*                                          STORAGE FOR COMMAND  Y02669* 03540602
*                               XASTSAVE WILL CONTAIN AN INDEX  Y02669* 03541202
*                               FOR THE MINOR MESSAGE FOR       Y02669* 03542602
*                               IEE5903D:                       Y02669* 03544002
*                                 IEE151I:                              03544402
*                                  X'04' - USE STOPTR TO DELETE Y02669* 03545402
*                                  X'06' - NO DISPLAY ON SCREEN Y02669* 03546802
*                                  X'07' - NO DISPLAY IN AREA   Y02669* 03548202
*                                 IEE158I:                              03548602
*                                  X'06' - NO DISPLAY ON SCREEN Y02669* 03549002
*                                  X'07' - NO DISPLAY IN AREA   Y02669* 03549402
*                                  X'08' - LAST FRAME DISPLAYED Y02669* 03549602
*                                  X'09' - FRAME NOT COMPLETE   Y02669* 03551002
*                                  X'0A' - DISPLAY IS NOT       Y02669* 03552402
*                                          DYNAMIC              Y02669* 03553802
*                                 IEE921I:                    @Y02668P* 03553903
*                                  X'19' - NEEDS DISPLAY AREA @Y02668P* 03555603
*                                 IEE925I:                              03558003
*                                  X'1A' - FOR CRT ONLY         Y02669* 03559403
*                                 IEE926I:                              03560403
*                                  X'18' - ON THIS COMMAND      Y02669* 03562203
*                                 IEE927I:                              03563603
*                                  X'17' - SPECIFY L OPERAND    Y02669* 03565003
*                               XASSDS5 - ON LOCKS HELD         Y02651* 03566403
*                                                                     * 03567803
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03569203
*                                                                     * 03570403
*   EXTERNAL                                                    Y02669* 03572003
*    REFERENCES                                                 Y02669* 03573403
*                                                                     * 03576202
*      ROUTINES         =       POSTS DIDOCS UCMECB             Y02669* 03577603
*                                     POSTCODE X'FE'            Y02669* 03578603
*                               POSTS TRACK DCMATECB            Y02669* 03579603
*                                     POSTCODE X'04'            Y02669* 03580603
*                               POSTS TRACK DCMATECB            Y02669* 03581603
*                                     POSTCODE X'08'            Y02669* 03582603
*                               BRANCHES TO  IEE7703D           Y02669* 03583603
*                                            IEE7803D           Y02669* 03584603
*                                            IEE6803D           Y02669* 03585603
*                                            IEE6903D           Y02669* 03586603
*                                            IEE5603D/IEE5903D  Y02669* 03587603
*                                                                     * 03588603
*      DATA AREAS       =       NONE                            Y02669* 03589603
*                                                                     * 03597202
*      CONTROL BLOCKS   =       CVT      R -  ADDRESS UCM       Y02669* 03598602
*                               IEEXSA   R -  INPUT INFORMATION Y02669* 03600002
*                                        W -  GETMAIN WORK AREA Y02669* 03600802
*                               IEECUCM  R -  ADDRESS DCM       Y02669* 03602402
*                                        W -  UPDATE            Y02669* 03604002
*                               IEERDCM  R -  COMPARE           Y02669* 03605602
*                                        W -  UPDATE            Y02669* 03607202
*                               IEECVMAP C -  SUBPOOL 230       Y02669* 03608802
*                               (KPARAM) W -  BUILD PARM LIST   Y02669* 03610402
*                                        R -  KPARAM CHAIN ADDR Y02669* 03612002
*                               IEETDCM  W -  FLAG, CHAIN KPARAMY02669* 03613602
*                               IHAPSA   - NECESSARY FOR SETLOCKY02651* 03614002
*                                                                     * 03615202
*    TABLES      = A COMPARE TABLE IS USED TO  DETERMINE THE    Y02669* 03618402
*                  VALIDITY OF THE OPERANDS ON THE CONTROL      Y02669* 03620002
*                  COMMANDS.                                    Y02669* 03620102
*                  THE FORMAT OF EACH ENTRY IS THE SAME.        Y02669* 03621602
*                                                                     * 03623202
*                  DLEN   DC   AL1(L'XXX-1) - LENGTH OF         Y02669* 03624802
*                                             SPECIFIC OPERAND  Y02669* 03626402
*                  XXX    DC   C'YYYYY' - CHARACTER OPERAND     Y02669* 03628002
*                                         REPRESENTATION        Y02669* 03629602
*                                                                     * 03631202
*                  DLEN AND 'XXX' ARE USED IN AN EX OF A CLC.   Y02669* 03632802
*                  IF THE OPERANDS MATCH, A BRANCH IS TAKEN TO  Y02669* 03634402
*                  EITHER PROCESS THE COMMAND OR IN TURN        Y02669* 03636002
*                  BRANCH TO THE PROPER PROCESSOR.              Y02669* 03637602
*                  OTHERWISE, THE REGISTER USED TO ADDRESS THE  Y02669* 03639202
*                  TABLE IS INCREMENTED BY TWO + THE VALUE OF   Y02669* 03640802
*                  DLEN TO REACH THE NEXT TABLE ENTRY.          Y02669* 03642402
*                                                                     * 03644002
*                  A BRANCH TABLE IS USED IN CONNECTION WITH    Y02669* 03645602
*                  THE COMPARE TABLE. IT CONSISTS OF BRANCHES   Y02669* 03647202
*                  TO THE PROPER OPERAND PROCESSORS. AN INDEX   Y02669* 03648802
*                  REGISTER IS MAINTAINED THROUGHOUT THE SCAN   Y02669* 03650402
*                  OF THE COMPARE TABLE. THIS IS USED AT        Y02669* 03652002
*                  DBRANCH TO GIVE CONTROL TO THE INDICATED     Y02669* 03653602
*                  PROCESSOR VIA THE BRANCH TABLE.              Y02669* 03655202
*                                                                     * 03656802
*      MACROS           =       MODID                           Y02669* 03658402
*                               CONDITIONAL BRANCH ENTRY        Y02651* 03660002
*                                 GETMAIN SP241 FOR KPARAM      Y02651* 03661602
*                               BRANCH ENTRY POST - DIDOCS    @ZA03632* 03662603
*                                 UCMECB - POSTCODE (X'FE')     Y02669* 03664802
*                               BRANCH ENTRY POST - IEECB800    Y02651* 03665002
*                                 DCMATECB - PTCODE (X'04')     Y02651* 03665202
*                                 (FOR STOPTR A COMMAND)        Y02651* 03675202
*                                 DCMATECB - KDUCODE (X'08')    Y02651* 03677202
*                                 (FOR K D,U COMMAND)           Y02651* 03679202
*                               SETLOCK - CMS & LOCAL RELEASED  Y02651* 03681202
*                                                                     * 03684702
*      ENQUEUED                                                 Y02669* 03685102
*       RESOURCES       =       NONE                            Y02669* 03690702
*                                                                     * 03699202
*      CHANGE LEVEL     =       Y02669                          Y02669* 03702202
*                               Y02651                          Y02651* 03706402
*                               YM1913                          YM1913* 03709402
*                               YM7666                        @YM7666P* 03713602
*                               Y02668                        @Y02668P* 03714603
*                               ZA01568                       @ZA01568* 03715603
*                               ZA02576                       @ZA02576* 03716103
*                               ZA03632                       @ZA03632* 03716303
*                               ZA09164                       @ZA09164* 03716403
*      LOCKS HELD       =       CMS AND LOCAL LOCKS WERE        Y02651* 03716602
*                               OBTAINED IN IEE7503D FOR BOTH   Y02651* 03720802
*                               STOPTR AND CONTROL COMMANDS.    Y02651* 03728002
*                               THEY MUST BE RELEASED BEFORE    Y02651* 03731002
*                               RETURNING AT RETURN,          @ZA03632* 03735203
*                               OR BRANCHING                  @ZA03632* 03739203
*                               TO IEE0503D, AT D0503D          Y02651* 03749602
*                               OTHERWISE THEY ARE RELEASED IN  Y02651* 03752602
*                               IEE5603D, IEE5903D, IEE6803D,   Y02651* 03756802
*                               IEE6903D, IEE7703D, OR IEE7803D.Y02651* 03764002
*                                                                     * 03767002
*      MESSAGES         =       THE FOLLOWING MESSAGES ARE      Y02669* 03771202
*                               CONTAINED IN AND ISSUED FROM    Y02669* 03774202
*                               IEE5603D AND IEE5903D:          Y02669* 03778402
*                                                                     * 03779102
*                                MSGID  CODE  IN MESSAGE TEXT   Y02669* 03779802
*                                _____  ____  __ ____________   Y02669* 03780502
*                               IEE151I X'03' 56 DELETE REQUEST Y02669* 03781202
*                                                  INCONSISTENT Y02669* 03781902
*                                       X'04' 59 USE STOPTR TO  Y02669* 03782602
*                                                  DELETE       Y02669* 03783302
*                                       X'06' 59 NO DISPLAY ON  Y02669* 03784002
*                                                  SCREEN       Y02669* 03784702
*                                       X'07' 59 NO DISPLAY IN  Y02669* 03785602
*                                                  AREA         Y02669* 03786602
*                               IEE156I X'04' 56 INVALID OPERND Y02669* 03787602
*                               IEE158I X'05' 56 K REQUEST      Y02669* 03788602
*                                                  INCONSISTENT Y02669* 03789602
*                                       X'06' 59 NO DISPLAY ON  Y02669* 03790602
*                                                  SCREEN       Y02669* 03791602
*                                       X'07' 59 NO DISPLAY IN  Y02669* 03792802
*                                                  AREA         Y02669* 03795802
*                                       X'08' 59 LAST FRAME     Y02669* 03800002
*                                                  DISPLAYED    Y02669* 03801002
*                                       X'09' 59 FRAME NOT      Y02669* 03802002
*                                                  COMPLETE     Y02669* 03803002
*                                       X'0A' 59 DISPLAY IS NOT Y02669* 03804002
*                                                  DYNAMIC      Y02669* 03805002
*                               IEE921I X'09' 56 REJECTED     @Y02668P* 03805203
*                                             59 NEEDS        @Y02668P* 03805403
*                                                DISPLAY AREA @Y02668P* 03805603
*                               IEE925I X'0B' 56 OPERAND        Y02669* 03806002
*                                       X'1A' 59 FOR CRT ONLY   Y02669* 03807002
*                               IEE926I X'0C' 56 L=CCA OPERAND  Y02669* 03808002
*                                                  INVALID      Y02669* 03809002
*                                       X'1A' 59 ON THIS CMND   Y02669* 03810002
*                               IEE927I X'0D' 56 K REQUEST      Y02669* 03811002
*                                                  AMBIGUOUS    Y02669* 03812002
*                                       X'17' 59 SPECIFY L      Y02669* 03813002
*                                                  OPERAND      Y02669* 03814002
*                               IEE930I X'0E' 56 INSUFFICIENT   Y02669* 03815002
*                                                  STORAGE FOR  Y02669* 03816002
*                                                  COMMAND      Y02669* 03817002
*                                                                     * 03818002
*                              THE FOLLOWING MESSAGE IS IN    @Y02668P* 03818203
*                              IEE0503D                       @Y02668P* 03818403
*                                                             @Y02668P* 03818603
*                               MSGID CODE TEXT               @Y02668P* 03819003
*                              IEE777I X'15' INVALID FROM     @Y02668P* 03823003
*                                             SUBSYSTEM       @Y02668P* 03824003
*                                             CONSOLE         @Y02668P* 03825003
*      SYSGEN           =       INCLUDE WITH SVC 34 IN LOAD     Y02669* 03828003
*                               MODULE IGC0003D, DLIB AOSB3,    Y02669* 03831003
*                               MACRO SGIEF441, TARGLIB LPALIB  Y02669* 03834003
*                                                                     * 03837003
*      SYSTEM LIBRARIES =       NONE                            Y02669* 03840003
*                                                                     * 03843003
*********************************************************************** 03846003
         EJECT                                                          03850002
IEE6703D CSECT                                                          03857002
* A- 643196 C- 602500                                         @ZA01568* 03860003
* C-344700,344800                                             @ZA02576* 03862003
* POST (C)                                                    @ZA03632* 03862603
* SACBSCAN (C), PROCESS (D)                                   @ZA09164* 03863203
*********************************************************************** 03864002
*                                                                     * 03871002
*                         REGISTER EQUATES                            * 03878002
*                                                                     * 03885002
*********************************************************************** 03892002
REG0     EQU   0                   WORK REG                             03900001
REG1     EQU   1                   WORK REG                             04000001
XSAREG   EQU   2                   BASE REG FOR XSA                     04100001
REG3     EQU   3                   WORK REG & TEMP BASE FOR UCM  Y02669 04250002
REG4     EQU   4                   WORK REG                             04260002
TDCMREG  EQU   5                   BASE REG FOR TRANSIENT DCM           04400001
REG6     EQU   6                   REGISTER CONTAINING OPERAND POINTER  04500001
REG7     EQU   7                   WORK REG                             04700001
REG8     EQU   8                   BASE FOR RESIDENT DCM & WORK REG     04800002
REG9     EQU   9                   UCME BASE & BAL REG           Y02651 04910002
KREG     EQU   10                  BASE REG FOR K PARAMETER LIST Y02651 04950002
MODREG   EQU   11                  REG FOR MODULE INDICATOR             05100001
SACBREG  EQU   12                  BASE REG FOR SACB                    05200001
BASEREG  EQU   13                  BASE REG FOR THIS MODULE             05300002
REG14    EQU   14                  RETURN REG                           05400001
R15      EQU   15                  LINK REG                             05500001
         EJECT                                                          05600001
*********************************************************************** 05650002
*                                                                     * 05700001
*                          NUMBER CONSTANTS                           * 05800002
*                                                                     * 05900001
*********************************************************************** 05950002
ZERO     EQU   0                   NUMBER CONSTANT                      06100001
ONE      EQU   1                   NUMBER CONSTANT                      06300001
N2       EQU   2                   NUMBER CONSTANT                      06400001
N3       EQU   3                   NUMBER CONSTANT               Y02669 06450002
N4       EQU   4                   NUMBER CONSTANT                      06800001
N5       EQU   5                   NUMBER CONSTANT             @YM7666P 06801002
N7       EQU   7                   NUMBER CONSTANT                      06802002
N8       EQU   8                   NUMBER CONSTANT             @YM7666P 07602002
*********************************************************************** 08450002
*                                                                     * 08500002
*                        CHARACTER CONSTANTS                          * 08550002
*                                                                     * 08560002
*********************************************************************** 08570002
DCHAR    EQU   C'D'                DISPLAY CONSTANT                     08600001
ECHAR    EQU   C'E'                ERASE CONSTANT                       08650002
HCHAR    EQU   C'H'                HOLD CONSTANT                        08900001
UCHAR    EQU   C'U'                UPDATE CONSTANT                      08950002
*********************************************************************** 09450002
*                                                                     * 09460002
*                     SPECIAL CODES AND MASKS                         * 09470002
*                                                                     * 09480002
*********************************************************************** 09490002
PT       EQU   X'C8'               STOPTR CODE                   Y02669 09500002
POSTCODE EQU   X'FE'               CODE USED IN POSTING UCM ECB         09800001
PTCODE   EQU   X'04'               CODE FOR POSTING TRACK ECB    Y02651 09850002
KDUCODE  EQU   X'08'               CODE FOR POSTING TRACK ECB    Y02651 09860002
WAITCODE EQU   X'80'               ECB WAIT CODE                        09900001
REDYCODE EQU   X'00'               ECB READY CODE                       10000001
XFF      EQU   X'FF'               MASK FOR TURNING OFF FLAGS    Y02669 10200002
M7       EQU   7                   MASK FOR ADDRESS FOR ICM      Y02669 10250002
M8       EQU   8                   MASK FOR ICM XMPOST         @Y02668P 10270003
SP241    EQU   241                 SUBP NUMBER FOR KPARM GETMAIN Y02669 10300002
         EJECT                                                          10300402
*********************************************************************** 10302002
*                                                                     * 10304002
*                      ERROR CODES                                    * 10306002
*                                                                     * 10308002
*********************************************************************** 10308402
MSG151   EQU   3                   IEE151I DELETE INCONSISTENT   Y02669 10310002
MSG151A  EQU   4                           USE STOP TRACK        Y02669 10320002
MSG156   EQU   4                   IEE156I INVALID OPERAND       Y02669 10330002
MSG158   EQU   5                   IEE158I K REQUEST INCONSIST   Y02669 10340002
MSG158A  EQU   8                           LAST FRAME DISPLAY    Y02669 10342002
MSG158B  EQU   9                           FRAME NOT COMPLETE    Y02669 10344002
MSG158C  EQU   10                          DISPLAY NOT DYNAMIC   Y02669 10346002
MSG1581A EQU   6                           NO DISPLAY ON SCREEN  Y02669 10348002
MSG1581B EQU   7                           NO DISPLAY IN AREA    Y02669 10348402
MSG921   EQU   9                   IEE921I REJECTED            @Y02668P 10348503
MSG921A  EQU   19                           NEEDS DISPLAY AREA @Y02668P 10348603
MSG925   EQU   11                  IEE925I OPERAND               Y02669 10358603
MSG925A  EQU   26                          FOR CRT ONLY          Y02669 10370802
MSG926   EQU   12                  IEE926I L OPERAND INVALID     Y02669 10378102
MSG926A  EQU   24                          ON THIS COMMAND       Y02669 10385402
MSG927   EQU   13                  IEE927I K REQUEST AMBIGUOUS   Y02669 10392702
MSG927A  EQU   23                          SPECIFY L OPERAND     Y02669 10400002
MSG930   EQU   14                  IEE930I INSUFFICIENT          Y02669 10500002
*                                          STORAGE FOR COMMAND   Y02669 10600002
MSG777   EQU   X'15'               IEE777I INVALID FROM        @Y02668P 10630003
*                                          SUBSYSTEM CONSOLE  @Y02668P* 10660003
         EJECT                                                          10700001
         BALR  BASEREG,ZERO        SET UP ADDRESSIBILITY                11100001
         USING *,BASEREG           FOR PROGRAM                          11200001
         MODID BRANCH=YES                                        Y01886 11250001
*********************************************************************** 11350002
*           INITIALIZATION REGISTER USAGE                        Y02669 11600002
*           2  -  XSA BASE REG                                   Y02669 11610002
*           3  -  UCM BASE - THEN WORK REG                       Y02669 11612002
*           5  -  TDCM BASE REG                                  Y02669 11620002
*           6  -  ADDRESS OF K COMMAND OPERANDS                  Y02669 11630002
*           7  -  WORK REG                                       Y02669 11640002
*           8  -  WORK REG - THEN RESIDENT DCM BASE REG          Y02669 11642002
*           9  -  UCME BASE REG                                  Y02669 11642402
*          11  -  MODREG                                         Y02669 11646002
*          13  -  MODULE BASE REG                                Y02669 11648002
*********************************************************************** 11650002
         USING DXSA,XSAREG         EXTENDED SAVEAREA ADDRESSIBILITY     11660002
         L     REG3,CVTPTR         GET CVT POINTER               Y02669 11700002
         USING DCVT,REG3           ADDRESSIBILITY OF CVT         Y02669 11800002
         L     REG3,CVTCUCB        GET UCM POINTER               Y02669 11900002
         DROP  REG3                                              Y02669 12000002
         SPACE   3                                                      12010002
*********************************************************************** 12050002
*       GET UCM ENTRY ADDRESS                                    Y02669 12052002
*********************************************************************** 12060002
         USING UCM,REG3            ADDRESSABILITY OF UCM         Y02669 12100002
         L     REG7,UCMVEA         GET POINTER TO FIRST UCME            12200002
         SR    REG9,REG9           CLEAR WORK REGISTER           Y02669 12300002
         IC    REG9,XASCID         GET TARGET CONSOLE ID         Y02669 12400002
         BCTR  REG9,ZERO           DECREMENT BY ONE              Y02669 12500002
         M     REG8,UCMVEZ         MULT ID BY SIZE                      12600001
         AR    REG9,REG7           SET PTR TO UCM ENTRY          Y02669 12700002
         DROP  REG3                                              Y02669 12750002
         USING UCMLIST,REG9        ADDRESSIBILITY OF UCM ENTRY   Y02669 12800002
         TM    UCMDISP,UCMDISPC    IS TARGET A GRAPHICS?         Y02669 12802002
         BO    GRAPHICS            YES, CONTINUE                 Y02669 12804002
         SR    REG6,REG6           CLEAR REGISTER                Y02669 12804402
         ICM   REG6,M7,XAL+1       GET 3 BYTE ADDR OF OPERANDS   Y02669 12804802
         CLC   ZERO(N3,REG6),CDCHAR IS COMMAND K C,D?            Y02669 12806802
         BE    D7803D              YES, IEE7803D WILL HANDLE     Y02669 12808002
         B     ERR925A             NO, TARGET MUST BE CRT        Y02669 12808402
         EJECT                                                          12810002
*********************************************************************** 13460002
*       ADDRESS RESIDENT AND TRANSIENT DCM FOR TARGET CONSOLE    Y02669 13472002
*       WILL ALWAYS BE CRT DEVICE.                               Y02669 13474002
*********************************************************************** 13480002
GRAPHICS EQU   *                                                        13530002
         L     REG8,UCMXB          GET ADDRESS OF RESIDENT DCM   Y02669 13600002
         USING DCMTSRT,REG8        ADDRESSIBILITY FOR DCM        Y02669 13700002
         L     TDCMREG,DCMADTRN    GET ADDRESS OF TRAN DCM       Y02669 13750002
         USING DCMSTRT,TDCMREG     ADDRESSIBILITY OF TRANS DCM   Y01012 13760002
         SR    REG6,REG6           CLEAR REGISTER                Y02669 13760402
         ICM   REG6,M7,XAL+1       GET 3 BYTE ADDR OF OPERANDS   Y02669 13760802
         BZ    KALONE              IF BLANK TREAT AS K E         Y02669 13761202
         SPACE   3                                                      13762002
*********************************************************************** 14056202
*       THIS IS A STOPTR COMMAND?                                Y02669 14058802
*  STOPTR OPERANDS WERE VALIDITY CHECKED IN IEE5503D             Y02669 14060802
*********************************************************************** 14061402
         L     MODREG,DCMNINT5     SET CODE FOR SDS INTERFACE 5  Y02669 14063402
         CLI   XAN,PT              IS THIS STOPTR?               Y02669 14064002
         BE    TESTOWN             YES                           Y02669 14066002
        EJECT                                                           14068002
*********************************************************************** 14071802
*       LOOP THROUGH BRANCH TABLE SEARCHING FOR OPERANDS         Y02669 14074402
*          REGISTERS USED FOR LOOP - 1, 3, 7, 15                 Y02669 14077002
*********************************************************************** 14079602
         SPACE  2                                                       14092002
         SR    REG3,REG3           CLEAR REG FOR OP LENGTH       Y02669 14094002
         SR    R15,R15             USED TO INDEX BRANCH TABLE    Y02669 14096002
         LA    REG7,DENTAB         CALCULATE TABLE END ADDRESS   Y02669 14098402
         LA    REG1,DTAB           CALCULATE TABLE BEGIN ADDRESS Y02669 14098802
         USING DTAB,REG1           EST. ADDRESSABILITY TO TABLE  Y02669 14099202
DLOOP    EQU   *                                                        14099302
         IC    REG3,DLEN           LENGTH OF COMPARE TAB ENTRY-1 Y02669 14099602
         EX    REG3,DCOMPARE       CHECK FOR MATCH               Y02669 14099702
         BE    BRTABLE(R15)        IF MATCH,PROCESS ACCORDINGLY  Y02669 14099802
         LA    REG1,N2(REG3,REG1)  NO MATCH, GO TO NEXT ENTRY    Y02669 14099902
         LA    R15,N4(R15)         INCRE INDEX FOR BRANCH TABLE  Y02669 14133202
         CR    REG1,REG7           END OF COMPARE TABLE REACHED  Y02669 14183202
         BL    DLOOP               NO, GO BACK AND CHECK NEXT    Y02669 14193202
*                                  TABLE ENTRY                   Y02669 14195202
         DROP  REG1                NECESSARY TO RE-EST BASE REG         14195602
         B     ERR156              YES, INVALID OPERAND - ERROR  Y02669 14197202
         EJECT                                                          15000001
*********************************************************************** 23950002
*         K   E,                                                 Y02669 23960002
*********************************************************************** 24000002
SEDEL1   EQU   *                                                 Y02669 24050002
         L     MODREG,DCMNDEL1     SET CODE FOR DELETE 1 ROUTINE Y02669 31900002
         B     TESTL               BRANCH TO CHECK FOR L OPERAND Y02669 31950002
         SPACE 3                                                        32000001
*********************************************************************** 32050002
*         K   E,N                                                Y02669 32100002
*********************************************************************** 33100002
SECMD    EQU   *                                                 Y02669 33150002
         L     MODREG,DCMNCMD1     SET CODE FOR COMMAND ROUTINE  Y02669 33200002
         B     TESTL               BRANCH TO CHECK FOR L OPERAND Y02669 33300002
         SPACE 3                                                        33400001
*********************************************************************** 33410002
*         K   S                                                  Y02669 33412002
*********************************************************************** 33420002
SPECOPT  EQU   *                                                 Y02669 33430002
         L     MODREG,DCMNOPT1     SET CODE FOR OPTIONS ROUTINE  Y02669 33450002
         B     TESTL               BRANCH TO CHECK FOR L OPERAND Y02669 33500002
         SPACE 3                                                        33550002
*********************************************************************** 33700002
*         K   D                                                  Y02669 33710002
*         K   D,N                                                Y02669 33720002
*         K   D,N,HOLD                                           Y02669 33730002
*********************************************************************** 33750002
SEDEL4   EQU   *                                                 Y02669 33760002
         L     MODREG,DCMNDEL4     SET CODE FOR DELETE 4 ROUTINE Y02669 33800002
         B     TESTL               BRANCH TO TEST FOR L OPERAND         33900001
         SPACE 3                                                        34000001
*********************************************************************** 34200002
*         K   E,PFK                                              Y02669 34210002
*         K   D,PFK                                              Y02669 34220002
*         K   N                                                  Y02669 34230002
*********************************************************************** 34250002
SEPFK    EQU   *                                                 Y02669 34260002
         L     MODREG,DCMNPFK2     SET CODE FOR PFK 2 ROUTINE    Y02669 34300002
         B     TESTL               BRANCH TO TEST FOR L OPERAND         34400002
         EJECT                                                          34410002
*********************************************************************** 34420002
*         K          (DEFAULT)                                   Y02669 34420402
*         K   E                                                  Y02669 34422002
*         K   E,SEG                                              Y02669 34424002
*********************************************************************** 34430002
KALONE   EQU   *                                                 Y02669 34440002
         L     MODREG,DCMNDEL3     GET FOR DELETE 3              Y02669 34450002
         SPACE   3                                                      34460002
*********************************************************************** 34460402
*  THE L OPERAND IS INVALID ON ALL OF THE ABOVE COMMANDS         Y02669 34460802
*********************************************************************** 34461202
TESTL    EQU   *                                                 Y02669 34462002
         TM    XASSDS,XASSDS3     CMD INVALID FROM ASSOC       @Y02668P 34464003
         BO    DERR777            CNSL BRANCH ERROR MSG        @Y02668P 34466003
         TM    XASSDS,XASSDS2+XASSDS4 WAS L OPERAND SPECIFIED? @ZA02576 34470003
         BM    ERR926              YES, BRANCH FOR  MSG EXIT   @ZA02576 34480003
         OI    DCMSVC34,DCMTYPE1   K COMMAND NOT ROUTABLE               34490002
         B     SETDCM              BRANCH TO SET DCM FLAG AND EXIT      34492002
         SPACE 3                                                        34542002
*********************************************************************** 34544002
*         K   V                                                  Y02669 34546002
*********************************************************************** 34550002
D7703D   EQU   *                                                 Y02669 34552002
         TM    XASSDS,XASSDS3      IF JES3 ISSUED K V          @Y02668P 34554003
         BO    DERR777             BRANCH INVALID FROM         @Y02668P 34556003
*                                  SUBSYSTEM CONSOLE          @Y02668P* 34558003
         L     R15,VCON7703        BRANCH TO HANDLE THE K  V CMD Y02669 34562002
         BR    R15                 BRANCH TO IEE7703D            Y02669 34572002
         SPACE 3                                                        34574002
*********************************************************************** 34574402
*         K   T                                                  Y02669 34574802
*         K   A                                                  Y02669 34578502
*         K   A,REF                                              Y02669 34582802
*         K   A,NONE                                             Y02669 34586502
*********************************************************************** 34590202
D6903D   EQU   *                                                 Y02669 34593902
         L     R15,VCON6903        BRANCH TO HANDLE THE K T & A  Y02669 34597602
         BR    R15                 BRANCH TO IEE6903D            Y20669 34601302
         SPACE 3                                                        34605002
*********************************************************************** 34608702
*         K   A,NN,NN                                            Y02669 34612402
*********************************************************************** 34619802
D6803D   EQU   *                                                 Y02669 34623502
         L     R15,VCON6803        BRANCH TO HANDLE K A,NN,NN    Y02669 34627202
         BR    R15                 BRANCH TO IEE6803D            Y02669 34630902
         EJECT                                                          34632902
*********************************************************************** 34633302
*         K   C,D                                                Y02669 34633702
*********************************************************************** 34634102
D7803D   EQU   *                                                 Y02669 34634502
         L     R15,VCON7803        BRANCH TO HANDLE K C,D,ID     Y02669 34647602
         BR    R15                 BRANCH TO IEE7803D            Y02669 34657602
         SPACE 3                                                        34673802
*********************************************************************** 34686902
*         K   E,D                                                Y02669 34700002
*********************************************************************** 34742002
SETFLG   EQU   *                                                 Y02669 34752002
         L     MODREG,DCMNINT5     SET CODE FOR SDS INTERFACE 5  Y02669 34802002
         B     PROCESS             BRANCH TO PROCESS OPERAND     Y02669 34852002
         SPACE 3                                                        34892002
*********************************************************************** 34942002
*         K   D,F                                                Y02669 34992002
*********************************************************************** 35042002
SETFLGMD EQU   *                                                 Y02669 35052002
         L     MODREG,DCMNINT3     SET CODE FOR SDS INTERFACE 3  Y02669 35062002
         B     PROCESS             BRANCH TO PROCESS OPERAND     Y02669 35102002
         SPACE  3                                                       36600002
*********************************************************************** 36610002
*          K   D,H                                               Y02669 36620002
*          K   D,U                                               Y02669 36630002
*********************************************************************** 36640002
MODSET   EQU   *                                                 Y02669 36640402
         L     MODREG,DCMNINT3     SET CODE FOR SDS INTERFACE 3  Y02669 36642002
         EJECT                                                          36644002
*********************************************************************** 36650002
*                                                                     * 36700001
*           COMMON SUBROUTINE FOR K D,H OR K D,U PROCESSING           * 36800002
*                                                                     * 36910002
*********************************************************************** 36950002
         SPACE   2                                                      37200002
         L     SACBREG,DCMADSDS    GET SACBPTR                 @Y02668P 37500003
         LTR   SACBREG,SACBREG     IF ZERO                     @Y02668P 37510003
         BZ    ERR921              NO AREA EXISTS              @Y02668P 37520003
         USING DCMACB,SACBREG      SET BASE FOR SACB             Y02669 37550002
         CLI   XASDID,ZERO         WAS AREA SPECIFIED ON COMMAND?Y02669 37600002
         BNE   AREA                YES, BRANCH                   Y02669 37650002
SACBTEST EQU   *                                                 Y02669 37750002
         TM    DCMASACB,DCMAUSE    IS AREA IN USE?               Y02669 37800002
         BZ    NOINUSE             NO, BRANCH                    Y02669 37850002
         TM    DCMAFLG1,DCMADISP   IS DISPLAY IN AREA?           Y02669 37900002
         BZ    NXTSACB             NO, TEST OTHER SACB'S         Y02669 37950002
         OI    XASPLS3,ONE         SET DISP ON SCREEN SWITCH RE- Y02669 38000002
*                                  SERVED BIT SET TO 0 IN 7503D  Y02669 38020002
         TM    DCMADFLG,DCMADD     IS IT A DYNAMIC DISPLAY?      Y02669 38050002
         BO    TESTCMD             YES, WHICH COMMAND IS THIS    Y02669 38100002
NXTSACB  EQU   *                                                 Y02669 38150002
         ICM   SACBREG,N7,DCMACBNX+1 GET NEXT SACB POINTER       Y02669 38200002
         BZ    NOINUSE             THERE ARE NO MORE             Y02669 38250002
         B     SACBTEST            CONTINUE SEARCH               Y02669 38300002
         SPACE 2                                                        38310002
NOINUSE  EQU   *                                                 Y02669 38400002
         TM    XASPLS3,ONE         IS DISPLAY ON SCREEN FLAG ON? Y02669 38450002
         BO    DYDISP              YES IEE158 DISP NOT DYNAMIC   Y02669 38500002
         B     NODISPS             NO IEE158 NO DISP ON SCREEN   Y02669 38550002
         EJECT                                                          38560002
AREA     EQU   *                                                 Y02669 38600002
         CLC   DCMAID(ONE),XASDID  COMPARE SACB WITH SPECIFIED A Y02669 38650002
         BE    TFLG                MATCH? YES,                   Y02669 38700002
         ICM   SACBREG,N7,DCMACBNX+1 NO, GET NEXT SACB           Y02669 38750002
         BNZ   AREA                ANYMORE? YES,CONTINUE SEARCH  Y02669 38800002
         B     NODISPA             NO, IEE151 NO DISPLAY IN AREA Y02669 38850002
         SPACE 2                                                        38900002
TFLG     EQU   *                                                 Y02669 39250002
         TM    DCMAFLG1,DCMADISP   IS THERE A DISPLAY IN AREA?   Y02669 39300002
         BZ    NODISPA             ERR IEE158 NO DISP IN AREA    Y02669 39350002
         TM    DCMADFLG,DCMADD     IS DYNAMIC DISPLAY IN AREA?   Y02669 39400002
         BO    TESTUD              YES, WHICH COMMAND IS THIS    Y02669 39450002
         B     DYDISP              ERR IEE158 DISP NOT DYNAMIC   Y02669 39500002
         SPACE 2                                                        39550002
TESTCMD  EQU   *                                                 Y02669 39560002
         MVC   XASDID,DCMAID       PUT AREA ID IN XAS            Y02669 39570002
TESTUD   EQU   *                                                 Y02669 39600002
         CLI   N2(REG6),UCHAR      IS THIS AN UPDATE COMMAND?    Y02669 39650002
         BNE   SETHOLD             NO, BRANCH TO PROCESS D,H     Y02669 39700002
*********************************************************************** 39820002
*     D,U                                                        Y02669 39830002
*********************************************************************** 39840002
UPDATE   EQU   *                                                 Y02669 39842002
         NI    DCMADFLG,XFF-DCMAHOLD TURN OFF HOLD FLAG IN DCM   Y02669 39844002
         ST    SACBREG,XAXSACB     SAVE SACB PTR FOR POST        Y02669 39844402
         B     TESTOWN             BRANCH TO BUILD K PARM LIST   Y02669 39846002
*********************************************************************** 39848402
*     D,H                                                        Y02669 39848802
*********************************************************************** 39849202
SETHOLD  EQU   *                                                 Y02669 39849602
         OI    DCMADFLG,DCMAHOLD   SET ON HOLD FLAG IN DCM       Y02669 39849702
         B     TESTOWN             BRANCH TO BUILD K PARM LIST   Y02669 39849802
         EJECT                                                          39849902
*********************************************************************** 39850002
*                                                                     * 39900002
*           COMMON SUBROUTINE FOR K E,D OR K D,F PROCESSING           * 39950002
*                                                                     * 40000002
*********************************************************************** 40260002
         SPACE   2                                                      40290002
PROCESS  EQU   *                                                        40291003
         L     SACBREG,DCMADSDS    GET SACBPTR                 @Y02668P 40292003
         LTR   SACBREG,SACBREG     IF ZERO                     @Y02668P 40292503
         BZ    ERR921              NO AREA EXISTS              @Y02668P 40293003
         USING DCMACB,SACBREG      SET BASE FOR SACB             Y02669 40296002
         CLI   XASDID,ZERO         WAS AREA SPECIFIED ON COMMAND?Y02669 40298002
         BNE   AREASPEC            YES, BRANCH                   Y02669 40298402
         XC    XASAVSTD(N8),XASAVSTD CLEAR SACB ADDR SAVE AREA @YM7666P 40298602
SACBSCAN EQU   *                                                 Y02669 40298802
         TM    DCMASACB,DCMAUSE    IS AREA IN USE?               Y02669 40299202
         BZ    AREACHEK            NO, CHECK DISPLAY FOUND     @ZA09164 40299603
         TM    DCMADFLG,DCMADD     TRACK IN AREA?              @YM7666P 40301703
         BO    TESTTR              YES, CHECK IT OUT           @YM7666P 40302702
         TM    DCMAFLG1,DCMADISP   IS DISPLAY IN AREA?           Y02669 40305702
         BO    FOUNDONE            YES, IS IT THE RIGHT ONE      Y02669 40307702
NEXTSACB EQU   *                                               @YM7666P 40311002
         ICM   SACBREG,N7,DCMACBNX+1  IS THERE ANOTHER AREA?     Y02669 40314002
         BZ    AREACHEK            NO, GO SEE IF ONE ALREADY   @YM7666P 40317002
*                                  FOUND                       @YM7666P 40319002
         B     SACBSCAN            YES, CHECK IT OUT             Y02669 40321002
AREACHEK EQU   *                                               @YM7666P 40321102
         ICM   SACBREG,M7,XASAVSTD+1 DISPLAY AREA FOUND?       @YM7666P 40322102
*                                  GETS ADDR OF DISPLAY SACB   @YM7666P 40323102
         BZ    NOHITS              NO, CHECK IF TRACK FOUND    @YM7666P 40324102
         B     WHICHONE            YES, DETERMINE COMMAND      @YM7666P 40325102
NOHITS   EQU   *                                               @YM7666P 40326102
         ICM   SACBREG,M7,XASAVSTD+N5 TRACK FOUND?             @YM7666P 40327102
*                                  GETS ADDR OF TRACK SACB     @YM7666P 40328102
         BNZ   TRFOUND             YES, DETERMINE COMMAND      @YM7666P 40329102
         B     NODISPS             NO, ERR NO DISPLAY ON       @YM7666P 40330102
*                                  SCREEN                      @YM7666P 40331102
TRFOUND  EQU   *                                               @YM7666P 40332102
         CLI   N2(REG6),DCHAR      IS THIS ERASE DISPLAY CMD?  @YM7666P 40333102
         BE    USEPT               YES, ERR IEE151I USE STOPTR @YM7666P 40334102
         MVC   XASDID,DCMAID       NO, PUT TRACK AREA ID IN    @YM7666P 40335102
         B     FRAME               XSA AND GO HANDLE FRAME     @YM7666P 40336102
         EJECT                                                          40339202
AREASPEC EQU   *                                                 Y02669 40340202
         CLC   DCMAID(ONE),XASDID  SACB ID MATCH SPECIFIED ID?   Y02669 40341202
         BE    MATCHID             YES, IS DISPLAY IN AREA       Y02669 40342202
         ICM   SACBREG,N7,DCMACBNX+1 GET ADDRESS OF NEXT SACB    Y02669 40343202
         BNZ   AREASPEC            CONTINUE SEARCH OF SACB'S     Y02669 40345202
         B     NODISPA             ERR-NO DISPLAY IN AREA        Y02669 40346202
MATCHID  EQU   *                                                 Y02669 40347202
         TM    DCMAFLG1,DCMADISP   IS THERE A DISPLAY IN AREA?   Y02669 40348202
         BO    WHICHONE            YES, WHICH COMMAND IS THIS    Y02669 40349202
         B     NODISPA             ERR-NO DISPLAY IN AREA        Y02669 40350202
FOUNDONE EQU   *                                                 Y02669 40353202
         CLI   XASDID,ZERO         FIRST TIME DISPLAY FOUND?   @YM7666P 40354202
         BNE   PROCESS             NO, DEFAULT TO LOWEST DISP  @ZA09164 40355203
         MVC   XASDID,DCMAID       SAVE AREA ID FOR LATER      @YM7666P 40356202
         ST    SACBREG,XASAVSTD    SAVE DISPLAY SACB ADDR      @YM7666P 40357202
         B     NEXTSACB            CHECK NEXT AREA             @YM7666P 40358202
WHICHONE EQU   *                                                 Y02669 40359202
         CLI   N2(REG6),DCHAR      IS THIS ERASE DISPLAY CMND?   Y02669 40360202
         BNE   FRAME               BRANCH NO                     Y02669 40363202
         TM    DCMADFLG,DCMADD     IS THIS A DYNAMIC DISPLAY?    Y02669 40365202
         BO    USEPT               YES IEE151 USE STOPTR COMMAND Y02669 40365602
         B     TESTOWN             BRANCH NO  K E,D IS VALID     Y02669 40366002
         SPACE 3                                                        40366402
FRAME    EQU   *                                                 Y02669 40366502
         TM    DCMAFLG1,DCMAFRPR   IS FRAMING IN PROCESS?        Y02669 40366602
         BO    FRMNTCMP            YES IEE158 FRAME NOT COMPLETE Y02669 40377702
         TM    DCMAFLG1,DCMADEND   IS THIS THE LAST FRAME?       Y02669 40387702
         BO    LASTFRAM            YES IEE158 LAST FRAME DISPLAY Y02669 40388102
         OI    DCMAFLG1,DCMAFRPR   SET FRAMING IN PROCESS FLAG   Y02669 40388502
         B     TESTOWN             BRANCH TO BUILD K PARM LIST   Y02669 40388602
         EJECT                                                          53650002
***************************************************************@YM7666P 53651002
*                                                              @YM7666P 53655002
* CHECK FOR TRACK FOUND IN AREA WHILE PROCESSING K E,D OR      @YM7666P 53659002
* K D,F WITHOUT L=CCA                                          @YM7666P 53663002
*                                                              @YM7666P 53667002
* FOR K E,D: AN AREA CONTAINING TRACK WILL NOT BE CONSIDERED,  @YM7666P 53671002
*            SINCE ONLY STOPTR CAN DELETE A TRACK, UNLESS IT   @YM7666P 53675002
*            IS THE ONLY OCCUPIED AREA ON THE SCREEN.  THIS    @YM7666P 53679002
*            WILL BE TREATED AS AN ERROR.                      @YM7666P 53683002
*                                                              @YM7666P 53687002
* FOR K D,F: AN AREA CONTAINING TRACK WILL BE CONSIDERED ONLY  @YM7666P 53691002
*            IF THE DISPLAY IS THE ONLY DISPLAY ON THE SCREEN. @YM7666P 53695002
*            IF ANOTHER DISPLAY IS THERE, IT WILL BE FRAMED IN @YM7666P 53699002
*            PREFERENCE TO THE TRACK.                          @YM7666P 53703002
*                                                              @YM7666P 53707002
***************************************************************@YM7666P 53711002
         SPACE 3                                                        53720002
TESTTR   EQU   *                                               @YM7666P 53725002
         ST    SACBREG,XASAVSTD+N4 SAVE TRACK AREA SACB ADDR   @YM7666P 53735002
         B     NEXTSACB            CHECK NEXT AREA             @YM7666P 53745002
         EJECT                                                          53770002
*********************************************************************** 53775002
*                                                                     * 53780002
* BUILD PARAMETER LIST WITH COMMAND AND OPERANDS.  FIRST DETERMINE IF * 53800001
* GETMAIN HAS TO BE ISSUED IF TARGET AND ISSUING CONSOLE ARE NOT      * 53900002
* THE SAME OR IF THE DCM WILL BE USED FOR THE PARAMETER LIST          * 53950002
*                                                                     * 54100001
*********************************************************************** 54150002
         SPACE 3                                                        54200001
*********************************************************************** 54250002
*   DOES TARGET CONSOLE = ISSUING ?                                   * 54350002
*********************************************************************** 54450002
TESTOWN  EQU   *                                                        54600001
         TM    XASSDS,XASSDS3      IF CMD FROM ASSOC CNSL               54630003
         BO    GETKPARM            GETMAIN KPARM LIST          @Y02668P 54660003
         CLC   XAU(ONE),XASCID     IS THE TARGET ID EQUAL TO THE ISSUE- 54700001
         BE    SETDCM              ING CONSOLE? IF NO, ISSUE GETMAIN.   54800002
*********************************************************************** 54850002
*   TARGET CONSOLE DOES NOT = ISSUING                                 * 54900002
*                        OR                                   @Y02668P* 54910003
*   CMD ISSUED FROM JES3 ASSOCIATED CONSOLE                   @Y02668P* 54920003
*********************************************************************** 54950002
GETKPARM EQU   *                                                        55050003
         L     KREG,DCMADKP        GET POINTER TO PARAMETER LIST        55200001
         USING KPARAM,KREG         ADDRESSIBILITY FOR K LIST            55300001
         LA    REG0,DCMADKP        GET ADDRESS OF POINTER        Y02651 55400002
SRCLST   EQU   *                                                 Y02669 55450002
         LTR   KREG,KREG           K PARM ALREADY ON CHAIN?      Y02669 55800002
         BZ    GETAREA             NO, BRANCH TO GETMAIN ONE            55900002
         L     KREG,KCHAIN         GET POINTER TO NEXT K LIST           56300001
         LA    REG0,KCHAIN         GET ITS POINTER               Y02651 56400002
         B     SRCLST              BRANCH TO SEARCH LISTS               56500001
         EJECT                                                          56600002
*********************************************************************** 56650002
*   LOCKS MUST BE HELD FOR CHAINING THEREFORE DO BRANCH ENTRY TO      * 56700002
*   GETMAIN                                                           * 56710002
*      REGISTERS DESTROYED : 0, 1, 3, 4, 7, 14, 15                    * 56720002
*      INPUT TO GETMAIN : R4 POINTS TO CURRENT TCB                    * 56730002
*                         R7 POINTS TO CURRENT ASCB                   * 56740002
*********************************************************************** 56750002
GETAREA  EQU   *                                                        56900001
         L     REG4,CVTPTR         GET ADDRESS OF CVT            Y02651 56910002
         USING DCVT,REG4           ADDRESSABILITY OF CVT         Y02651 56950002
         L     REG4,CVTTCBP        GET ADDRESS OF TCB & ASCB PTRSY02651 56960002
         DROP  REG4                                              Y02651 56960402
         USING TCBASCB,REG4        ADDRESSABILITY OF IEFPTRS     Y02651 56962002
         L     REG7,ASCBPTR        ADDRESS OF ASCB FOR INTERFACE Y02651 57000002
         L     REG4,TCBPTR         ADDRESS OF TCB FOR INTERFACE  Y02651 57002002
         DROP  REG4                                              Y02651 57010002
         SR    REG4,REG4           INTERFACE FOR BRANCH ENTRY    Y02651 57050002
         ST    REG14,XAP           RETURN ADDRESS MUST BE SAVED  Y02651 57100002
         ST    REG0,XAD            K LIST ADDRESS MUST BE SAVED  Y02651 57150002
         GETMAIN  RC,LV=KPLLNGTH,SP=SP241,BRANCH=YES             Y02651 57300002
         L     REG14,XAP           RESTORE RETURN ADDRESS        Y02651 57350002
         L     REG4,XAD            RESTORE K LIST ADDRESS        Y02651 57360002
         LTR   R15,R15             WAS GETMAIN OK?                      57400002
         BC    N7,ERR930           NO, ISSUE IEE930I             Y02669 57460002
         ST    REG1,0(REG4)        YES, CHAIN K PARM             Y02651 57520002
         LR    KREG,REG1           GET AREA ADDRESS              Y02651 57600002
         XC    KFLGS(N7),KFLGS     ZERO FLAG BYTE AND POINTER           57700001
         OI    KFLGS,KGM           INDICATE AREA WAS GETMAINED          57800001
         B     BLDLST              BRANCH TO BUILD PARAMETER LIST       57900001
         EJECT                                                          58000002
*********************************************************************** 58050002
*   TARGET CONSOLE = ISSUING                                          * 58100002
*********************************************************************** 58150002
SETDCM   EQU   *                                                        58300001
         OI    DCMSVC34,DCMMYCMD   ISSUING CONSOLE TO HANDLE COMMAND    58400002
         LA    KREG,DCMINLGN       GET ADDRESS OF TRANS DCM PARAM LIST  58500002
         MVI   KFLGS,ZERO          ZERO FLAG BYTE ONLY           Y02669 58550002
*********************************************************************** 58600002
*   BUILD PARM LIST FOR ALL REQUESTS                                  * 58650002
*********************************************************************** 58700002
BLDLST   EQU   *                                                        59000001
         SR    REG7,REG7           CLEAR REGISTER                Y02669 59050002
         CR    REG6,REG7           IS OPERAND POINTER ZERO?      Y02669 59100002
         BE    NOPERAND            YES, IGNORE MOVE OF OPERANDS  Y02669 59110002
         L     REG7,XAR            NO, GET BEGINNING ADDRESS OF  Y02669 59120002
*                                  COMMAND BUFFER                Y02669 59130002
         LA    REG7,0(REG7)        CLEAR HI ORDER BYTE           Y02669 59140002
         AH    REG7,0(REG7)        CALCULATE END OF CMD BUFFER   Y02669 59142002
         SR    REG7,REG6           CALCULATE LENGTH OF OPERANDS  Y02669 59144002
         CH    REG7,LGTH125        IS LENGTH LESS THAN 125     @YM3473P 59144102
         BL    EXEC                YES BRANCH AND CONTINUE     @YM3473P 59144202
         LH    REG7,LGTH124        NO MAKE IT 125              @YM3473P 59144302
*  DON'T DECREMENT FOR EXECUTE - MUST HAVE AT LEAST 1 BLANK AT END FOR* 59144402
*  FOR PROPER INTERFACE                                               * 59144802
EXEC     EQU   *                                               @YM3473P 59145402
         EX    REG7,MOVEOPS        MOVE OPERANDS INTO K LIST     Y02669 59146002
NOPERAND EQU   *                                                        59150002
         ST    MODREG,KMOD         PUT MODULE INDICATOR IN DCM   Y02669 59200002
         MVC   KAID(ONE),XASDID    MOVE AREA ID INTO LIST               59300001
         CLI   XAN,PT              IS COMMAND STOP TRACK?        Y02669 59700002
         BE    SETMON              YES BRANCH                           59800001
         OI    KFLGS,KK            SET CONTROL COMD INDICATOR           60200001
         CLC   ZERO(N3,REG6),DUCHAR IS THIS THE K D,U COMMAND? @ZA01568 60250003
         BE    POSTRACK            GO POST TRACK PROCESSOR       Y02669 60260002
         B     INDSET              BRANCH TO TEST FOR GETMAIN           60300001
         EJECT                                                          60310002
*********************************************************************** 60350002
*   BRANCH ENTRY POST FOR STOP TRACK AND K D,U                @Y02668P* 60360003
*    1. LOCAL POST IF THE COMMAND IS ISSUED IN COMTASK        @Y02668P* 60362003
*       MEMORY                                                @Y02668P* 60364003
*    2. CROSS MEMORY POST IF THE COMMAND WAS ISSUED           @Y02668P* 60366003
*       FROM ANOTHER MEMORY (JES3)                            @Y02668P* 60368003
*********************************************************************** 60370002
         SPACE   3                                                      60400002
SETMON   EQU   *                                                 Y02669 60450002
         OI    KFLGS,KPT           SET STOPTR INDICATOR          Y02669 60700002
POSTRACK EQU   *                                                 Y02651 60700402
         STM   KREG,R15,XASAVSTD   SAVE REGS BEFORE POST         Y02651 60702002
         DROP  KREG                                              Y02651 60710002
         L     SACBREG,XAXSACB     GET ADDR OF SACB WITH TRACK   Y02669 60750002
         USING DCMACB,SACBREG      SET UP ADDRESSABILITY         Y02669 60760002
         L     MODREG,DCMATECB     GET ADDR OF TRACK CANCEL ECB  Y02669 60770002
         DROP  SACBREG                                           Y02669 60780002
         CLI   N2(REG6),UCHAR      IS THIS THE K D,U COMMAND?    Y02651 60780402
         BNE   SETPTCDE            NO, SET STOPTR POST CODE      Y02651 60780802
         LA    KREG,KDUCODE        ELSE, SET UPDATE MODE CODE    Y02651 60781202
         B     GOTOPOST            BRANCH ENTER POST ROUTINE     Y02651 60781602
SETPTCDE EQU   *                                                 Y02651 60781702
         LA    KREG,PTCODE         LOAD POST CODE FOR STOPTR     Y02651 60782002
GOTOPOST EQU   *                                                 Y02651 60782402
         L     REG14,CVTPTR        GET ADDRESS OF CVT            Y02651 60784002
         USING DCVT,REG14          ADDRESSABILITY TO CVT         Y02651 60786002
         L     R15,CVT0PT01        GET ADDRESS OF POST ROUTINE   Y02651 60788002
         TM    XASSDS,XASSDS3      DID COMTASK ISSUE THE CMD?  @Y02668P 60788103
         BZ    BRPOST              YES, BRANCH LOCAL POST      @Y02668P 60788203
         LA    SACBREG,CVTBRET     NO, JES3 XMPOST ERRET R12   @Y02668P 60793403
         ICM   MODREG,M8,XPOST     INDICATE XMPOST             @Y02668P 60796403
         L     REG3,CVTCUCB        GET ADDRESS OF UCM BASE     @Y02668P 60800403
         USING UCM,REG3            ADDRESSABILITY TO THE UCM   @Y02668P 60804403
         L     BASEREG,UCMASCB     ASCB TO BE POSTED R13       @Y02668P 60809603
BRPOST   EQU   *                                               @Y02668P 60814603
         DROP  REG14                                             Y02651 60816603
         BALR  REG14,R15           BRANCH ENTER POST             Y02651 60819603
         LM    KREG,R15,XASAVSTD   RESTORE REGS AFTER POST       Y02651 60824603
         USING KPARAM,KREG         RESTORE ADDRESSABILITY        Y02651 60829603
         SPACE 2                                                        60839603
INDSET   EQU   *                                                 Y02669 60850002
         TM    KFLGS,KGM           WAS K PARM GETMAINED HERE?    Y02669 61100002
         BO    TSTBSY              YES, BRANCH                          61200001
         B     RETURN              ELSE RETURN                   Y02669 61250002
         SPACE 2                                                        61700001
TSTBSY   EQU   *                                                 Y02669 61750002
         TM    UCMSTS,UCMBF        IS TARGET DEVICE BUSY?        Y02669 62000002
         BO    RETURN              YES, BRANCH TO RETURN                62100001
         SPACE 2                                                        62200001
         TM    UCMECB,WAITCODE     IS TARGET DEVICE WAITING?            62500002
         BO    POST                YES, BRANCH TO POST                  62600001
         SPACE 3                                                        62700001
         CLI   UCMECB,REDYCODE     IS TARGET DEVICE READY?              63000002
         BNE   RETURN              NO, BRANCH TO RETURN                 63100001
         EJECT                                                          63200002
*********************************************************************** 63210002
*        POST DIDOCS IF THE TARGET DEVICE IS WAITING USING    @Y02668P* 63250003
*          THE POST MACRO                                     @Y02668P* 63256003
*           1. RELEASE THE LOCKS. THE LOCKS ARE ALWAYS HELD   @Y02668P* 63262003
*              ON ENTRY TO IEE6703D                           @Y02668P* 63268003
*           2. LOCAL POST IF THE COMMAND WAS ISSUED IN        @Y02668P* 63274003
*              COMTASK MEMORY                                 @Y02668P* 63280003
*           3. CROSS MEMORY POST IF A MEMORY OTHER THAN       @Y02668P* 63286003
*              COMTASK ISSUED THE COMMAND (JES3)              @Y02668P* 63292003
*********************************************************************** 63300002
         SPACE 2                                                        63350002
POST     EQU   *                                                        63500001
         DROP  REG8                                              Y02669 63510002
         STM   KREG,R15,XASAVSTD   SAVE REGS BEFORE POST       @ZA03632 63512003
         LA    MODREG,UCMECB       ADDR OF ECB TO POST         @ZA03632 63514003
         LA    KREG,POSTCODE       POST CODE REG               @ZA03632 63516003
         L     REG14,CVTPTR        PTR TO CVT                  @ZA03632 63518003
         USING DCVT,REG14          CVT ADDRESSABILITY          @ZA03632 63520003
         L     R15,CVT0PT01        ADDR OF POST ROUTINE        @ZA03632 63522003
         TM    XASSDS,XASSDS3      DID COMM TASK ISSUE CMND?   @ZA03632 63524003
         BZ    LOCPOST             YES, BRANCH TO LOCAL POST   @ZA03632 63526003
         LA    SACBREG,CVTBRET     XMPOST ERRET ADDR           @ZA03632 63528003
         ICM   MODREG,M8,XPOST     INDICATE XMPOST             @ZA03632 63530003
         L     REG3,CVTCUCB        ADDR OF UCM BASE            @ZA03632 63532003
         USING UCM,REG3            UCM ADDRESSABILITY          @ZA03632 63534003
         L     BASEREG,UCMASCB     ASCB TO BE POSTED           @ZA03632 63536003
LOCPOST  EQU   *                                               @ZA03632 63538003
         DROP  REG14                                           @ZA03632 63540003
         BALR  REG14,R15           BRANCH ENTER POST           @ZA03632 63542003
         LM    KREG,R15,XASAVSTD   RESTORE REGISTERS           @ZA03632 63544003
RETURN   EQU   *                                                 Y02669 63752002
         BAL   REG8,LOCKSOFF       GO RELEASE LOCKS              Y02651 63754002
         BR    REG14               RETURN TO CALLER              Y02669 63760002
         EJECT                                                          63760103
*********************************************************************** 63760503
* LOCKS MUST BE RELEASED BEFORE POSTING, RETURNING OR BRANCHING  Y02651 63760603
*                        TO IEE0503D                             Y02651 63760702
*********************************************************************** 63762202
         SPACE 2                                                        63764202
LOCKSOFF EQU   *                                                 Y02651 63768902
         STM   MODREG,REG14,XASAVLOC SAVE REGS AROUND SETLOCK    Y02651 63770802
         SETLOCK RELEASE,TYPE=CMS,RELATED=(K,IEE7503D(LOCKSET))         63772702
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(K,IEE7503D(LOCKSET))       63774602
         LM    MODREG,REG14,XASAVLOC RESTORE REGS AFTER SETLOCK  Y02651 63776502
         NI    XASSDS,XFF-XASSDS5  INDICATE NO LOCKS SET         Y02651 63778402
         BR    REG8                RETURN TO MAINLINE            Y02651 63780302
         EJECT                                                          63782202
*********************************************************************** 63784102
*                                                                     * 63786002
*                            ERROR EXITS                         Y02669 63787902
*                                                                     * 63789802
* NOTE: LOCKS ARE ALWAYS HELD ON ENTRY TO IEE6703D                    * 63791702
*********************************************************************** 63793602
         SPACE                                                          63795502
ERR156   EQU   *                                                        63797402
         SR    REG7,REG7           CLEAR REGISTER                Y02669 63799302
         CR    REG6,REG7           IS OPERAND POINTER ZERO?      Y02669 63801202
         BE    KEDEFAUT            YES, NO OPERANDS K E DEFAULT  Y02669 63803102
         LA    REG6,ZERO(REG6)     SET OP POINTER                Y02669 63805002
KEDEFAUT EQU   *                   CURSOR POINTER CAN BE ZERO    Y02669 63806902
         ST    REG6,XASTSAVE       CURSOR ADDRESS FOR MSG RTN    Y02669 63808802
         MVI   XAE,MSG156          IEE156I  - INVALID OPERAND    Y02669 63810702
         B     D5603D              BRANCH TO EXIT                Y02669 63812602
         SPACE  2                                                       63814502
USEPT    EQU   *                                                        63816402
         MVI   XASTSAVE,MSG151A    SECOND MSG CODE -USE STOPTR   Y02669 63818302
         SPACE 1                                                        63820202
ERR151   EQU   *                                                        63822102
         MVI   XAE,MSG151          IEE151I  -DELETE INCONSISTENT Y02669 63824002
         B     STOREOP             BRANCH TO MSG EXIT            Y02669 63825902
         SPACE  2                                                       63827802
NODISPA  EQU   *                                                        63829702
         MVI   XASTSAVE,MSG1581B   SECOND CODE - NO DISPLAY IN AREA     63831602
         CLI   ZERO(REG6),ECHAR    IS THIS AN ERASE OPERAND?      M2087 63833502
         BE    ERR151              BRANCH YES FOR DELETE MSG      M2087 63835402
         B     ERR158              NO, K MSG                            63837302
         SPACE  1                                                       63839202
NODISPS  EQU   *                                                        63841102
         MVI   XASTSAVE,MSG1581A   SECOND CODE - NO DISPLAY ON SCREEN   63843002
         CLI   ZERO(REG6),ECHAR    IS THIS AN ERASE OPERAND?      M2087 63844902
         BE    ERR151              BRANCH YES FOR DELETE MSG      M2087 63846802
         B     ERR158              NO, K MSG                            63848702
         SPACE  1                                                       63850602
LASTFRAM EQU   *                                                        63852502
         MVI   XASTSAVE,MSG158A    SECOND CODE - LAST FRAME DISPLAY     63854402
         B     ERR158              BRANCH TO MAJOR MSG CODE             63856302
         SPACE  1                                                       63858202
FRMNTCMP EQU   *                                                        63860102
         MVI   XASTSAVE,MSG158B    SECOND CODE - FRAME NOT COMPLETE     63862002
         B     ERR158              BRANCH TO MAJOR MSG CODE             63863902
         EJECT                                                          63865802
DYDISP   EQU   *                                                        63867702
         MVI   XASTSAVE,MSG158C    SECOND CODE - DISPLAY NOT DYNAMIC    63869602
ERR158   EQU   *                                                        63871502
         MVI   XAE,MSG158          IEE158I  - K REQUEST INCONSISTENT    63873402
         B     STOREOP             BRANCH TO EXIT                Y02669 63875302
ERR921   EQU   *                                                        63875603
         MVI   XAE,MSG921          IEE921I - REJECTED          @Y02668P 63875903
         MVI   XASTSAVE,MSG921A    NEEDS DISPLAY AREA          @Y02668P 63876203
         B     STOREOP             BR, SET CURSOR POINTER      @Y02668P 63876503
         SPACE 2                                                        63877202
ERR925A  EQU   *                                                        63877602
         MVC   XASOPTR(N3),XAL+ONE MOVE OPERAND POINTER IN       Y02669 63878002
         MVI   XASTSAVE,MSG925A    2ND CODE-FOR CRT ONLY         Y02669 63878402
         MVI   XAE,MSG925          MSG CODE-IEE925I OPERAND      Y02669 63878802
         B     D5603D              BRANCH TO EXIT                Y02669 63878902
         SPACE 2                                                        63879002
ERR926   EQU   *                                                        63879102
         MVI   XAE,MSG926          IEE926I  - L OPERAND INVALID         63881002
         MVI   XASTSAVE,MSG926A    SECOND CODE - ON THIS COMMAND        63882902
         B     STOREOP             BRANCH TO STORE OPERAND       Y02669 63884802
         SPACE 2                                                        63886702
ERR927   EQU   *                                                        63888602
         MVI   XASTSAVE,MSG927A    SECOND CODE - SPECIFY L OPERAND      63890502
         MVI   XAE,MSG927          IEE927I  - K REQUEST AMBIGUOUS       63895202
         LA    REG6,N3(REG6)       SET CURSOR TO 'L' POSITION    Y02669 63896202
         B     STOREOP                                                  63896702
         SPACE 2                                                        63897202
ERR930   EQU   *                                                        63897402
         MVI   XAE,MSG930          IEE930I- INSUFFICIENT STORAGE Y02669 63897602
         SPACE 2                                                        63906602
STOREOP  EQU   *                                                        63915602
         STCM  REG6,N7,XASOPTR     SAVE CURSOR POINTER           Y02669 63924602
D5603D   EQU   *                                                        63933602
         L     R15,VCON5603        RT AND K MSG MODULE NAME      Y02669 63942602
         BR    R15                 BRANCH TO IEE5603D            Y02669 63951602
DERR777  EQU   *                                                        63981603
         MVI   XAE,MSG777          INVALID FROM SUBSYSTEM CNSL @Y02668P 64011603
D0503D   EQU   *                                               @Y02668P 64041603
         BAL   REG8,LOCKSOFF       RELEASE THE LOCKS           @Y02668P 64071603
         L     R15,VCON0503        BRANCH TO MESSAGE MODULE    @Y02668P 64101603
         BR    R15                                             @Y02668P 64131603
         EJECT                                                          64176702
*********************************************************************** 64186702
*                                                                     * 64196702
*                 CONSTANTS USED IN THIS ROUTINE                      * 64206702
*                                                                     * 64208702
*********************************************************************** 64210702
         SPACE   3                                                      64212702
VCON5603 DC    V(IEE5603D)         RT AND K MSG RTN NAME         Y02669 64216302
VCON6803 DC    V(IEE6803D)         K A,NN,NN RTN NAME            Y02669 64266402
VCON6903 DC    V(IEE6903D)         K A,REF & K A,NONE RTN NAME   Y02669 64276402
VCON7703 DC    V(IEE7703D)         K V RTN NAME                  Y02669 64298802
VCON7803 DC    V(IEE7803D)         K C,D,ID RTN NAME             Y02669 64299202
VCON0503  DC   V(IEE0503D)                                     @Y02668P 64299303
CDCHAR   DC    C'C,D'              CONSTANT COMPARE              Y02669 64309603
DFCHAR   DC    C'D,F'              CONSTANT COMPARE            @YM7666P 64314603
DUCHAR   DC    C'D,U'              CONSTANT COMPARE            @ZA01568 64319603
LGTH125  DC    H'125'              MAX LENGTH K PARM LIST      @YM3473P 64324603
LGTH124  DC    H'124'              MAX LGTH K PARM LIST MINUS1 @YM3473P 64333203
XPOST    DC    X'80'               FLAG FOR XMPOST             @Y02668P 64336203
         SPACE                                                          64340203
DCOMPARE CLC   ONE(ZERO,REG1),ZERO(REG6) LOOK FOR MATCH IN TABLE Y02669 64347203
MOVEOPS  MVC   KOPN(ZERO),ZERO(REG6)    MOVE OPERANDS INTO KLIST Y02669 64354203
         SPACE   5                                                      64361203
*********************************************************************** 64368203
*                           PATCH AREA                                * 64375203
*********************************************************************** 64383202
PATCH    DC    C'****PATCH AREA****'                                    64393202
PATCH1   DC    C'IEE6703D-TEST ONLY'                                    64395202
PATCH2   DC    36C' '                                                   64397202
         EJECT                                                          64400002
*********************************************************************** 67160002
*                                                                     * 67170002
*                           BRANCH  TABLE                             * 67180002
*                                                                     * 67190002
*        THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE WITH  Y02669 67192002
*        THE 'COMPARE TABLE'                                     Y02669 67194002
*********************************************************************** 67196002
         SPACE   5                                                      67198002
BRTABLE  DS    0H                                                Y02669 67198402
         B     KALONE             BRANCH TO PROCESS K  E         Y02669 67198802
         B     SECMD              BRANCH TO PROCESS K  E,N       Y02669 67199202
         B     SEPFK              BRANCH TO PROCESS K  E,PFK     Y02669 67199602
         B     KALONE             BRANCH TO PROCESS K  E,SEG     Y02669 67199702
         B     SETFLG             BRANCH TO PROCESS K  E,D       Y02669 67199802
         B     SEDEL1             BRANCH TO PROCESS K  E,        Y02669 67210002
         B     SEDEL4             BRANCH TO PROCESS K  D         Y02669 67233202
         B     SEDEL4             BRANCH TO PROCESS K  D,N       Y02669 67243202
         B     SEDEL4             BRANCH TO PROCESS K  D,N,HOLD  Y02669 67253202
         B     SETFLGMD           BRANCH TO PROCESS K  D,F       Y02669 67263202
         B     MODSET             BRANCH TO PROCESS K  D,H       Y02669 67265202
         B     MODSET             BRANCH TO PROCESS K  D,U       Y02669 67265402
         B     SEPFK              BRANCH TO PROCESS K  D,PFK     Y02669 67265602
         B     ERR156             BRANCH ERROR K D               Y02669 67266002
         B     SPECOPT            BRANCH TO PROCESS K  S         Y02669 67266102
         B     SPECOPT            BRANCH TO PROCESS K  S,        YM1913 67266202
         B     SEPFK              BRANCH TO PROCESS K  N         Y02669 67266402
         B     D7703D             BRANCH TO PROCESS K  V         Y02669 67266502
         B     D6903D             BRANCH TO PROCESS K  T         Y02669 67276502
         B     D6903D             BRANCH TO PROCESS K A          Y02669 67286502
         B     D6903D             BRANCH TO PROCESS K A,REF      Y02669 67286602
         B     D6903D             BRANCH TO PROCESS K A,NONE     Y02669 67286702
         B     D6803D             BRANCH TO PROCESS K A,NN,NN    Y02669 67286802
         B     D7803D             BRANCH TO PROCESS K C,D        Y02669 67286902
         EJECT                                                          67288502
*********************************************************************** 67288602
*  NOTE: THE FOLLOWING TABLE MUST BE THE LAST ITEM IN THIS            * 67288702
*        MODULE SINCE A USING FOR THE TABLE IS ISSUED ON              * 67288802
*        REGISTER 1 AND THUS CAN REESTABLISH THE MODULE'S             * 67289702
*        BASE REGISTER FOR ANY CODE WHICH FOLLOWS THIS TABLE.         * 67290602
*                                                                     * 67291502
*                          COMPARE TABLE                              * 67295702
*                                                                     * 67296102
*           THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE    Y02669 67299102
*           WITH THE BRANCH TABLE                                Y02669 67302102
*********************************************************************** 67305102
DTAB     EQU   *                                                 Y02669 67308102
DLEN     EQU   *                                                 Y02669 67311102
         DC    AL1(L'ERASE-1)       LENGTH OF OPERAND -1         Y02669 67314102
ERASE    DC    C'E '                VALID OPERAND                       67322102
         DC    AL1(L'ERASEN-1)                                   Y02669 67332102
ERASEN   DC    C'E,N '                                           Y02669 67342102
         DC    AL1(L'ERASEPFK-1)                                 Y02669 67344102
ERASEPFK DC    C'E,PFK '                                         Y02669 67346102
         DC    AL1(L'ERASESEG-1)                                 Y02669 67348102
ERASESEG DC    C'E,SEG '                                         Y02669 67356702
         DC    AL1(L'ERASED-1)                                   Y02669 67358702
ERASED   DC    C'E,D '                                           Y02669 67360702
         DC    AL1(L'ERASEC-1)                                   Y02669 67364302
ERASEC   DC    C'E'                                              Y02669 67364402
         DC    AL1(L'DISPLAY-1)                                  Y02669 67364502
DISPLAY  DC    C'D '                                             Y02669 67364702
         DC    AL1(L'DISPLAYN-1)                                 Y02669 67365102
DISPLAYN DC    C'D,N '                                           Y02669 67365202
         DC    AL1(L'DNHOLD-1)                                   Y02669 67365302
DNHOLD   DC    C'D,N,HOLD '                                      Y02669 67365402
         DC    AL1(L'DISPLAYF-1)                                 Y02669 67374002
DISPLAYF DC    C'D,F '                                           Y02669 67376002
         DC    AL1(L'DISPLAYH-1)                                 Y02669 67378002
DISPLAYH DC    C'D,H '                                           Y02669 67380002
         DC    AL1(L'DISPLAYU-1)                                 Y02669 67382002
DISPLAYU DC    C'D,U '                                           Y02669 67382102
         DC    AL1(L'DPFK-1)                                     Y02669 67385202
DPFK     DC    C'D,PFK '                                         Y02669 67391302
         DC    AL1(L'JUSTD-1)                                    Y02669 67393302
JUSTD    DC    C'D'                                              Y02669 67393702
         DC    AL1(L'SPEC-1)                                     Y02669 67394202
SPEC     DC    C'S '                                             Y02669 67397102
         DC    AL1(L'SPECC-1)                                    YM1913 67401102
SPECC    DC    C'S,'                                             YM1913 67405102
         DC    AL1(L'NPFK-1)                                     Y02669 67409302
NPFK     DC    C'N'                                              Y02669 67412802
         DC    AL1(L'VARY-1)                                     Y02669 67416102
VARY     DC    C'V'                                              Y02669 67426102
         DC    AL1(L'TR-1)                                       Y02669 67436102
TR       DC    C'T'                                              Y02669 67438102
         DC    AL1(L'A-1)                                        Y02669 67440102
A        DC    C'A '                                             Y02669 67442102
         DC    AL1(L'AREF-1)                                     Y02669 67442502
AREF     DC    C'A,REF '                                         Y02669 67442902
         DC    AL1(L'ANONE-1)                                    Y02669 67443302
ANONE    DC    C'A,NONE '                                        Y02669 67443702
         DC    AL1(L'ADIGIT-1)                                   Y02669 67443802
ADIGIT   DC    C'A,'                                             Y02669 67443902
         DC    AL1(L'CD-1)                                       Y02669 67444102
CD       DC    C'C,D'                                            Y02669 67444202
DENTAB   EQU   *                                                 Y02669 67500002
         EJECT                                                          68400001
DXSA     DSECT                                                          68450002
         IEEXSA                                                         68460002
         EJECT                                                          68499602
DCVT     DSECT                                                          68500001
         CVT                                                            68600001
         EJECT                                                          68700001
         IEECUCM  FORMAT=NEW                                            68900002
         EJECT                                                          69000001
         IEERDCM                                                        69200002
         EJECT                                                          69250002
DCMSTRT  DSECT                                                          69300002
         IEETDCM                                                        69350002
         EJECT                                                          69600001
PLIST    DSECT                                                          69700001
         IEECVMAP KPARAM                                                69800001
         EJECT                                                          69900001
         IHAPSA                                                         69950002
         EJECT                                                          69960002
         IEFPTRS                                                        69970002
         END                                                            70000001
