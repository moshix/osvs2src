         TITLE 'IEE6803D SVC 34 K A COMMAND LOAD 2'                     00950002
*********************************************************************** 01100001
*                                                                     * 01110002
* MODULE NAME         =  IEE6803D                               Y02669* 01150002
*                                                                     * 01152002
* DESCRIPTIVE NAME    =  CONTROL (K) A COMMAND                  Y02669* 01160002
*                                                                     * 01162002
* COPYRIGHT           =  N/A                                    Y02669* 01170002
*                                                                     * 01172002
* STATUS              =  01 - UPDATE FOR VS/2 RELEASE 3       @ZA06992* 01180003
*                                                                     * 01182002
* FUNCTION            =  HANDLES K A,NN,NN...CONTROL COMMAND.   Y02669* 01190002
*                        ALSO REFERRED TO AS K A,LL,LL...               01190602
*                                                                     * 01191202
*   OPERATION         =  BASED ON THE TARGET CONSOLE ID IN      Y02669* 01192002
*                        XASCID, ADDRESSABILITY TO THE UCME,    Y02669* 01192302
*                        DCM, AND SACB IS ESTABLISHED. IF THE   Y02669* 01194302
*                        TARGET IS MESSAGE STREAM ONLY,         Y02669* 01195502
*                        'IEE926I OUTPUT ONLY' IS ISSUED.       Y02669* 01196002
*                                                                     * 01196802
*                        NEXT THE 'NN' OPERANDS ARE VALIDITY    Y02669* 01197202
*                        CHECKED. IF ANY IS NOT A DIGIT,        Y02669* 01197302
*                        'IEE156I INVALID OPERAND' IS ISSUED.   Y02669* 01197402
*                                                                     * 01197602
*                        THE DIGITS ARE THEN PACKED AND         Y02669* 01197902
*                        CONVERTED TO BINARY.  IF ANY OF THE    Y02669* 01198202
*                        AREA DEFINITIONS IS GREATER THAN THE   Y02669* 01198502
*                        TOTAL SCREEN SIZE, 'IEE924I SCREEN     Y02669* 01198802
*                        SIZE EXCEEDED' IS ISSUED.              Y02669* 01199102
*                        IF ANY VALUE IS LESS THAN THE SMALLEST Y02669* 01199502
*                        POSSIBLE AREA SIZE, 'IEE924I AREA TOO  Y02669* 01199602
*                        SMALL' IS ISSUED.                      Y02669* 01204602
*                        IF THE TOTAL OF THE AREA DEFINITIONS   Y02669* 01205602
*                        IS GREATER THAN THE SCREEN SIZE        Y02669* 01206602
*                        'IEE914I SCREEN SIZE EXCEEDED' IS      Y02669* 01207602
*                        ISSUED.                                Y02669* 01208602
*                                                                     * 01209602
*                        IN ALL OF THE ABOVE CASES, NONE OF THE Y02669* 01210002
*                        AREA DEFINITIONS ARE ACCEPTED.         Y02669* 01210402
*                                                                     * 01210502
*                        NEXT THE SACB CHAIN IS EXAMINED TO SEE Y02669* 01210602
*                        IF ANY AREAS ARE PRESENTLY DEFINED.    Y02269* 01211602
*                        IF SO, THEY CAN ONLY BE REDEFINED IF   Y02669* 01212602
*                        THEY CONTAIN NO DISPLAY OR ARE         Y02669* 01213002
*                        LOCATED ABOVE THE HIGHEST AREA         Y02669* 01213202
*                        CONTAINING A DISPLAY. IF THERE IS A    Y02669* 01213502
*                        DISPLAY IN ONE OF THE AREAS AND        Y02669* 01217602
*                        THE NEW DEFINITION IS A DIFFERENT      Y02669* 01221602
*                        LENGTH, 'IEE924I DISPLAY IN OR ABOVE   Y02669* 01222602
*                        AREA' IS ISSUED.                       Y02669* 01224602
*                                                                     * 01225602
         EJECT                                                          01226602
*                        GETMAINING THE AREA NEEDED FOR ALL     Y02669* 01227602
*                        THE SACB'S (SCREEN AREA CONTROL BLOCK) Y02669* 01228602
*                        THE SACB CHAIN IS BUILT AND            Y02669* 01229602
*                        INITIALIZED.                           Y02669* 01230102
*                        EACH SACB IS MARKED IN USE             Y02669* 01230602
*                            DCMASACB - DCMAUSE  X'80'          Y02669* 01231602
*                        IF THE GETMAIN FAILS FOR THE SACB'S,   Y02669* 01232602
*                        'IEE937I INSUFFICIENT STORAGE FOR      Y02669* 01233602
*                        COMMAND' IS ISSUED.                    Y02669* 01235602
*                                                                     * 01236602
*                        FINALLY A GETMAIN IS ISSUED FOR        Y02669* 01237602
*                        'IEE928I'. IF IT FAILS CONTROL IS      Y02669* 01238602
*                        RETURNED TO THE SYSTEM WITH A NON-ZERO Y02669* 01239602
*                        REG 15. IF SUCCESSFUL, A WTO IS        Y02669* 01240102
*                        ISSUED, THE CORE FREED, AND CONTROL    Y02669* 01240602
*                        RETURNED.                              Y02669* 01241102
*                                                                     * 01241602
* NOTES                  FOR FUTURE SCREEN SIZES:               Y02669* 01243602
*                        THIS MODULE WILL HAVE DIFFICULTIES IF  Y02669* 01244102
*                        AN ATTEMPT IS MADE TO DEFINE MORE THAN Y02669* 01244602
*                        12 AREAS OR 48 LINES. THE MESSAGE      Y02669* 01245102
*                        BUFFER FOR 'IEE928I' CAN NOT           Y02669* 01246602
*                        ACCOMMODATE MORE THAN 13 AREAS.        Y02669* 01247602
*                                                                     * 01248602
*   CHARACTER-CODE                                              Y02669* 01249602
*    DEPENDENCIES     =  ANY CHARACTER CODE OTHER THAN EBCDIC   Y02669* 01250602
*                        WILL REQUIRE REASSEMBLY OF THIS MODULE.Y02669* 01251602
*                        NOTE THAT THIS MODULE IS DEPENDENT     Y02669* 01252602
*                        UPON THE CHARACTER REPRESENTATION      Y02669* 01253602
*                        OF THE DECIMAL DIGIT IE. X'F1' = 1.    Y02669* 01254602
*                                                                     * 01255602
*   DEPENDENCIES      =  IEE6703D WILL ISSUE ERROR MESSAGE      Y02669* 01257602
*                        'IEE925I FOR CRT ONLY', IF TARGET      Y02669* 01258602
*                        CONSOLE IS NOT A CRT.                  Y02669* 01259602
*                                                                     * 01260602
*   RESTRICTIONS      =  THE TARGET CONSOLE MUST BE CRT.        Y02669* 01261602
*                        (VERIFIED IN IEE6703D)                 Y02669* 01262602
*                        TARGET CONSOLE CAN NOT BE MESSAGE      Y02669* 01263602
*                        STREAM ONLY.                           Y02669* 01264602
*                        'NN' MUST BE A DIGIT.                  Y02669* 01265602
*                                                                     * 01266602
*   REGISTER                                                    Y02669* 01268602
*    CONVENTIONS      =  NONE                                   Y02669* 01269602
*                                                                     * 01270602
*   PATCH-LABEL       =  PATCH                                  Y02669* 01271602
*                                                                     * 01272602
* MODULE TYPE         =  CSECT                                  Y02669* 01273602
*                                                                     * 01274602
*   PROCESSOR         =  N/A                                    Y02669* 01275602
*                                                                     * 01276602
*   MODULE SIZE       =  X'3C0' + X'48' PATCH AREA              Y02669* 01277602
*                                                                     * 01279602
*   ATTRIBUTES        =  REFRESHABLE, REENTRANT, SUPERVISOR     Y02669* 01280602
*                        MODE, KEY 0, PAGED LPA                 Y02669* 01281102
*                                                                     * 01281602
* ENTRY POINT         =  IEE6803D FROM IEE6703D                 Y02669* 01282602
*   PURPOSE           =  TO PROCESS THE K A,NN,NN COMMAND       Y02669* 01283602
*   LINKAGE           =  BRANCH                                 Y02669* 01284602
*   INPUT DATA        =  REG 2 POINTS TO THE XSA                Y02669* 01285602
*                          XAS CONTAINS L=CCA INFORMATION       Y02669* 01286602
*                             XASSDS5 ON - LOCKS HELD           Y02651* 01287602
*                          XAL ADDRESSES OPERAND BUFFER         Y02669* 01288602
*                     =  REG 14 CONTAINS THE RETURN ADDRESS     Y02669* 01290602
*                                                                     * 01291602
*   REGISTERS SAVED   =  REG 14 IS SAVED IN XSA (XAP)           Y02669* 01292602
*                        REGISTERS 11-14 ARE SAVED BEFORE       Y02651* 01293602
*                        ISSUING SETLOCK AT ZAPSACB.            Y02651* 01294602
*                                                                     * 01295102
*   REGISTER CONTENTS                                           Y02669* 01295602
*    DURING PROCESSING=  R0  - WORK REG                         Y02669* 01296602
*                        R1  - WORK REG                         Y02669* 01297602
*                        R2  - BASE REG FOR XSA                 Y02669* 01298602
*                        R3  - WORK REG                         Y02669* 01299602
*                        R4  - WORK REG & OPERAND POINTER       Y02669* 01301602
*                        R5  - WORK REG                         Y02669* 01302602
*                        R6  - WORK REG                         Y02669* 01303602
*                        R7  - BASE REG FOR SACB                Y02669* 01304602
*                        R8  - BASE REG FOR UCME                Y02669* 01305602
*                        R9  - WORK REG                         Y02669* 01306602
*                        R10 - BASE REG FOR RESIDENT DCM        Y02669* 01307602
*                        R11 - BRANCH REG FOR SUBROUTINE        Y02669* 01308602
*                        R12 - BASE REG UCM                     Y02669* 01309602
*                        R13 - BASE REG FOR MODULE              Y02669* 01310602
*                        R14 - SUBROUTINE AND MODULE RETURN REG Y02669* 01311602
*                        R15 - CODE REG                         Y02669* 01313602
*                                                                     * 01314402
*   REGISTERS RESTORED=  REGISTER 14 RESTORED AT BRANCH14       Y02669* 01315202
*                        REGISTERS 11-14 ARE RESTORED AFTER     Y02651* 01316002
*                        ISSUING SETLOCK AT ZAPSACB.            Y02651* 01316602
*                                                                     * 01317202
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01317802
*                                                                     * 01318402
* EXIT - NORMAL       =  RETURN VIA BR 14                       Y02669* 01319402
*   CONDITIONS        =  FOR K A,LL,LL...                       Y02669* 01320802
*   OUTPUT DATA       =  TARGET CONSOLE'S SACBS ARE UPDATED AND Y02669* 01321802
*                        UPDATED STATUS INFORMATION OF SACB     Y02669* 01322802
*                        BLOCKS IS ISSUED TO SOURCE CONSOLE     Y02669* 01323802
*                        DEVICE VIA WTO 'IEE928I'.              Y02669* 01324802
*   RETURN CODES      =  NONE                                   Y02669* 01325802
*                                                                     * 01327802
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01328802
*                                                                     * 01329802
* EXIT - ERROR        =  BRANCH TO IEE5603D FROM ERRORMSG       Y02669* 01330802
*   CONDITIONS        =  TO ISSUE ERROR MESSAGES                Y02669* 01331802
*   OUTPUT DATA       =  REG 2 POINTS TO XSA                    Y02669* 01332802
*                           XAE CONTAINS MAJOR MESSAGE INDEX    Y02669* 01333802
*                             X'04' - IEE156I INVALID OPERAND   Y02669* 01334802
*                             X'0A' - IEE924I INVALID AREA      Y02669* 01335802
*                                             DEFINITION        Y02669* 01336802
*                             X'0C' - IEE926I OPERAND INVALID   Y02669* 01340102
*                             X'0E' - IEE928I INSUFFICIENT      Y02669* 01340802
*                                          STORAGE FOR COMMAND  Y02669* 01341202
*                           XASTSAVE POINTS TO INVALID OPERAND  Y02669* 01341602
*                           OR CONTAINS MINOR MESSAGE INDEX     Y02669* 01341702
*                            IEE924I INVALID AREA DEFINITION    Y02669* 01341802
*                             X'0F' - SCREEN SIZE EXCEEDED      Y02669* 01341902
*                             X'10' - AREA TOO SMALL            Y02669* 01342002
*                             X'11' - DISPLAY IN OR ABOVE AREA  Y02669* 01342402
*                            IEE926I OPERAND INVALID            Y02669* 01359502
*                             X'1D' - OUTPUT ONLY               Y02669* 01359902
*                           XASSDS5 STILL ON LOCKS HELD         Y02651* 01360802
*   RETURN CODES      =  NONE                                   Y02669* 01366002
*                                                                     * 01371202
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01376402
*                                                                     * 01381602
* EXIT - ERROR        =  RETURN VIA BR 14 FROM RETURN           Y02669* 01386802
*   CONDITIONS        =  IF GETMAIN FAILS FOR MESSAGE BUFFER    Y02669* 01392002
*   OUTPUT DATA       =  LOCKS RELEASED BEFORE GETMAIN          Y02651* 01394002
*                        REG 2 POINTS TO XSA                    Y02669* 01397202
*                           XASSDS5 TURNED OFF - LOCKS RELEASED Y02651* 01399202
*   RETURN CODES      =  REG 15 NON-ZERO                        Y02669* 01402402
*                                                                     * 01407602
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01412802
*                                                                     * 01418002
* EXTERNAL REFERENCES                                           Y02669* 01423202
*                                                                     * 01428402
*   ROUTINES          =  IEE5603D                               Y02669* 01433602
*                                                                     * 01438802
*   DATA AREAS        =  NONE                                   Y02669* 01444002
*                                                                     * 01449202
*   CONTROL BLOCKS    =  IEECUCM   R - ADDRESS DCM              Y02669* 01454402
*                        IEEXSA    R - INPUT                    Y02669* 01459602
*                                  W - ERROR CODES              Y02669* 01464802
*                        IEERDCM   G - WHEN AREA DEFINED        Y02669* 01475202
*                         (SACB)   R - CHECK STATUS             Y02669* 01480402
*                                  W - INITIALIZE AND CHAIN     Y02669* 01485602
*                        CVT       R - ADDRESS UCM              Y02669* 01490802
*                        IHAPSA    NECESSARY FOR SETLOCK        Y02651* 01492802
*                        IEFPTRS   GET ADDRESS OF TCB & ASCB    Y02651* 01494802
*                                                                     * 01496002
*   TABLES            =  INTERNAL TABLE OF SACB ID'S  (A-K)     Y02669* 01501202
*                                                                     * 01506402
*   MACROS            =  GETMAIN   FOR SACB FROM SUBPOOL 241    Y02651* 01511602
*                                  (BRANCH ENTRY)               Y02651* 01512602
*                                  FOR WTO FROM SUBPOOL 229     Y02669* 01513602
*                        FREEMAIN  FOR WTO FORM SUBPOOL 229     Y02669* 01516802
*                        WTO                                    Y02669* 01522002
*                        MODID                                  Y02669* 01527202
*                        SETLOCK   CMS AND LOCAL LOCKS RELEASED Y02651* 01532402
*                                                                     * 01537602
*   LOCKS HELD        =  CMS AND LOCAL LOCKS OBTAINED IN        Y02651* 01553202
*                        IEE7503D ARE RELEASED AND XASSDS5      Y02651* 01558402
*                        IS RESET BEFORE ISSUING GETMAIN FOR    Y02651* 01563602
*                        'IEE928I' AT ZAPSACB.                  Y02651* 01565602
*                                                                     * 01568802
*   CHANGE LEVEL      =  Y02669                                 Y02669* 01574002
*                        Y02651                                 Y02651* 01579202
*                        YM1912                                 YM1912* 01581202
*                        ZA06491                              @ZA06491* 01582203
*                        ZA06692                              @ZA06692* 01583203
*                                                                     * 01584402
* MESSAGES            =  THE FOLLOWING MESSAGE IS CONTAINED IN  Y02669* 01589602
*                        AND ISSUED FROM THIS MODULE:           Y02669* 01594602
*                                                                     * 01600002
*                        IEE928I DISPLAY AREA ID'S FOR CONSOLE  Y02669* 01700002
*                                'CC' ARE  '...'                Y02669* 01800002
*                                                                     * 01900002
*                        THE FOLLOWING MESSAGES ARE CONTAINED   Y02669* 02000002
*                        IN AND ISSUED FROM IEE5603D AND        Y02669* 02100002
*                        IEE5903D:                              Y02669* 02200002
*                                                                     * 02300002
*                         MSGID  CODE  IN MESSAGE TEXT          Y02669* 02400002
*                         _____  ____  __ ____________          Y02669* 02500002
*                        IEE156I X'04' 56 INVALID OPERAND       Y02669* 02600002
*                        IEE924I X'0A' 56 INVALID AREA          Y02669* 02700002
*                                            DEFINITION         Y02669* 02800002
*                                X'0F' 59 SCREEN SIZE EXCEEDED  Y02669* 02900002
*                                X'10' 59 AREA TOO SMALL        Y02669* 03000002
*                                X'11' 59 DISPLAY IN OR ABOVE   Y02669* 03100002
*                                            AREA               Y02669* 03200002
*                        IEE926I X'0C' 56 OPERAND INVALID       Y02669* 03300002
*                                X'1D' 59 OUTPUT ONLY           Y02669* 03400002
*                        IEE928I X'0E' 56 INSUFFICIENT STORAGE  Y02669* 03500002
*                                            FOR COMMAND        Y02669* 03600002
*                                                                     * 03700002
* SYSGEN              =  INCLUDE WITH SVC IN LOAD               Y02669* 03900002
*                        MODULE IGC003D,DLIB AOSB3,             Y02669* 04100002
*                        MACRO SGIEF441, TARGLIB LPALIB         Y02669* 04300002
*                                                                     * 04500002
* SYSTEM LIBRARIES    =  NONE                                   Y02669* 04700002
*                                                                     * 04900002
*********************************************************************** 05100001
         EJECT                                                          05200001
IEE6803D CSECT                                                          05250002
* A INCORE                                                     @ZA06491 05258003
* C FREEXTRA                                                   @ZA06491 05266003
* D ZAPSACB                                                    @ZA06491 05274003
* A SACBINIT                                                   @ZA06491 05282003
* C FREESACB                                                   @ZA06491 05290003
* A NEXTSACB                                                   @ZA06992 05295003
*********************************************************************** 05300001
*                                                                     * 05400002
*                             REGISTERS                               * 05500002
*                                                                     * 05600002
*********************************************************************** 05700001
R0       EQU   0                   WORK REG                             05710002
R1       EQU   1                   WORK REG                             05720002
PARMREG  EQU   2                   BASE REG FOR XSA                     05750002
R3       EQU   3                   WORK REG                             05810002
R4       EQU   4                   WORK REG                             05820002
KOPS     EQU   4                   OPERAND POINTER                      05850002
R5       EQU   5                   WORK REG                             06000002
R6       EQU   6                   WORK REG                             06050002
SACBPT   EQU   7                   SACB BASE REG                        06460002
UCMEBASE EQU   8                   UCME BASE REG                        06500002
R8       EQU   8                   PART OF EVEN-ODD PAIR         Y02669 06510002
R9       EQU   9                   PART OF EVEN-ODD PAIR         Y02669 06550002
RDCMBASE EQU   10                  RESIDENT DCM BASE REG                06600002
RB       EQU   11                  SUBROUTINE BRANCH REG                06650002
UCMBASE  EQU   12                  UCM BASE REG                         06700002
MYBASE   EQU   13                  MODULE BASE REG                      06750002
RETURN14 EQU   14                  SUBROUTINE RETURN REG         Y02669 06760002
R15      EQU   15                  CODE REG                      Y02669 08000002
         EJECT                                                          08010002
*********************************************************************** 08050002
*                                                                     * 08100002
*                      MESSAGE FLAG BIT SETTINGS                      * 08200002
*                                                                     * 08210002
*********************************************************************** 08250002
IEE156I  EQU   X'04'               MAJOR - INVALID OPERAND              08300002
IEE924   EQU   X'0A'               MAJOR - INVALID AREA DEFINITION      08500002
IEE924I  EQU   X'11'                 DISPLAY IN OR ABOVE AREA           08600002
IEE924I2 EQU   X'10'                 AREA TOO SMALL                     08700002
IEE924I3 EQU   X'0F'                 SCREEN SIZE EXCEEDED               08800002
IEE926I  EQU   X'0C'               MAJOR - OPERAND INVALID              09150002
IEE926   EQU   X'1D'                 OUTPUT ONLY                 Y02669 09150402
IEE931I  EQU   X'0E'               MAJOR - INSUF. STOR. FOR CMD         09152002
*********************************************************************** 09250002
*                                                                     * 09260002
*                       EQUATES                                       * 09270002
*                                                                     * 09280002
*********************************************************************** 09290002
N0       EQU   0                   FIELD INCREMENT                      09300001
N1       EQU   1                   FIELD INCREMENT                      09400001
N2       EQU   2                   FIELD INCREMENT                      09500001
N3       EQU   3                   FIELD INCREMENT                      09600001
N4       EQU   4                   FIELD INCREMENT                      09700001
N6       EQU   6                   FIELD INCREMENT                      09900001
N7       EQU   7                   FIELD INCREMENT                      10000001
N8       EQU   8                   FIELD INCREMENT                      10100002
N10      EQU   10                  FIELD INCREMENT               Y02669 10110002
N12      EQU   12                  FIELD INCREMENT               Y02669 10150002
N26      EQU   26                  FIELD INCREMENT                      10300002
N42      EQU   42                  FIELD INCREMENT                      10400002
N49      EQU   49                  FIELD SIZE                           10550002
N80      EQU   80                  FIELD SIZE                           10560002
*********************************************************************** 10570002
*                                                                     * 10580002
*                        CHARACTER CONSTANTS                          * 10590002
*                                                                     * 10592002
*********************************************************************** 10594002
BLANK    EQU   C' '                BLANK CHARACTER CONSTANT             11100002
COMMA    EQU   C','                COMMA CHARACTER CONSTANT             11120002
ZERO     EQU   X'00'               ZERO CHARACTER CONSTANT              11140002
XFF      EQU   X'FF'               MASK FOR NI                   Y02651 11170402
SIGN     EQU   X'FC'               USED TO CONVERT F TO C FOR CVB       11180002
DIGIT    EQU   X'F0'               DIGIT CHAR REPRESENTATION     Y02669 11200002
MCSMASK  EQU   X'41'               WTO MCS FLAGS                        11400002
PTRCVT   EQU   16                  CVT ADDRESS                          11600002
SP241    EQU   241                 SUBPOOL FOR SACB              Y02651 11900002
SP229    EQU   229                 SUBPOOL FOR MESSAGE           Y02651 11950002
         EJECT                                                          12200001
*********************************************************************** 12300001
*                                                                     * 12350002
*          ESTABLISH ADDRESSABILITY FOR MODULE AND                    * 12700002
*              BASE REGS FOR UCM, UCME, DCM, SACB                     * 12710002
*        ON ENTRY, REGISTER 2 CONTAINS ADDRESS OF XSA                 * 12750002
*                                                                     * 12800002
*********************************************************************** 12900001
         BALR  MYBASE,N0           ESTABLISH ROUTINE 'S                 13300001
         USING *,MYBASE            BASE REGISTER                        13400001
         MODID BRANCH=YES                                        Y01886 13450001
         USING FAUXSA,PARMREG      ESTABLISH XSA ADDRESSABILITY         13500002
         L     UCMBASE,PTRCVT      GET CVT ADDRESS               Y02669 13700002
         USING CVTSECT,UCMBASE     BASE CVT REG                         13800001
         L     UCMBASE,CVTCUCB     GET UCM POINTER FROM CVT             13900002
         DROP  UCMBASE                                           Y02669 13950002
         USING UCM,UCMBASE         ESTABLISH UCM ADDRESSABILITY  Y02669 14000002
         USING UCMLIST,UCMEBASE    BASE UCM ENTRY LIST                  14100001
         USING DCMTSRT,RDCMBASE    ESTABLISH RDCM BASE REG       Y02669 14200002
         USING DCMACB,SACBPT       BASE SACB REG                        14400001
         SPACE 3                                                        14500001
         ST    RETURN14,XAP        SAVE RETURN POINTER           Y02669 14800002
         EJECT                                                          15760002
*********************************************************************** 15800002
*                                                                     * 18100002
*    FIND AND BASE UCM ENTRY RESIDENT DCM AND SACB                    * 26050002
*    INPUT- REG 1-CONSOLE ID RIGHT JUSTIFIED, HIGH ORDER BYTES ZERO   * 26100002
*    OUTPUT-POINTER TO UCMENTRY SPECIFIED BY CONSOLE ID IN UCMEBASE   * 26150002
*    REG USAGE-DESTROYS CONTENTS OF: REG 0,1,UCMEBASE                 * 26200002
*                                                                     * 26205002
* NOTE: IEE7503D INSURES THAT THE TARGET CONSOLE IS A CRT.            * 26225002
*********************************************************************** 26260002
         SPACE 2                                                        26270002
         SR    R1,R1               CLEAR REG                            26280002
         IC    R1,XASCID           LOAD TARGET CONSOLE ID        Y02669 26290002
         BCTR  R1,ZERO             SUBTRACT ONE FROM CONSOLE ID         26298401
         L     UCMEBASE,UCMVEA     POINT TO FIRST UCME ENTRY            26298502
         M     R0,UCMVEZ           MULTIPLY ENTRY SIZE BY REDUCED ID    26298801
         AR    UCMEBASE,R1         POINT TO DESIRED UCM ENTRY           26299201
         L     RDCMBASE,UCMXB      LOAD ADDRESS OF RESIDENT DCM         26299802
         L     SACBPT,DCMADSDS     LOAD SACB POINTER FROM RDCM          26299902
*********************************************************************** 26310402
*                                                                     * 26310802
*           IF TARGET IS MESSAGE STREAM = IEE926I                Y02669 26314002
*                                                                     * 26316002
*********************************************************************** 26318002
         L     KOPS,XAL            LOAD POINTER TO OPERANDS      Y02669 26318402
         LA    KOPS,N0(KOPS)       CLEAR HI ORDER BYTE           Y02669 26318802
         TM    UCMDISP,UCMDISPF    IS IT A MSG STREAM CONSOLE?          26340002
         BO    MSGSTRM             YES, INVALID TARGET           Y02669 26350002
         EJECT                                                          26366002
*********************************************************************** 26366102
*                                                                     * 26366402
*               PRIME REGS FOR NN SYNTEX CHECKING                Y02669 26366502
*    ON ENTRY K A,DIGIT HAS BEEN VALIDITY CHECKED                Y02669 26366602
*                                                                     * 26366702
*    NOTE: DIGITS CAN BE ONLY 1 OR 2 DIGITS LONG, RANGING FROM 4 Y02669 26373202
*          TO MESSAGE AREA SIZE IN VALUE                         Y02669 26378702
*          2260 - 8; 2250 - 63                                   Y02669 26378802
*    ERR - IEE156I INVALID OPERAND - IF DIGIT INVALID            Y02669 26379102
*                                                                     * 26380202
*********************************************************************** 26386802
         SPACE 2                                                        26388802
         SR    R0,R0               CLEAR REG FOR TOTAL COUNTER   Y02669 26438802
         SR    R1,R1               CLEAR REG FOR NUMBER OF AREAS Y02669 26440802
         LA    R6,XASAVSTD         GET ADDR OF SAVE LENGTHS AREA Y02669 26442802
         LA    KOPS,N2(KOPS)       BUMP POINTER BEYOND COMMA     Y02669 26700002
         ST    KOPS,XASAVLOC       SAVE OP PTR FOR IEE924I(ERROR)Y02669 26750002
LLLOOP   EQU   *                                                        26900001
         XC    XAX(N8),XAX         CLEAR PACKING AREA            Y02669 27100002
         TM    N0(KOPS),DIGIT      IS 1ST CHAR A DIGIT?          Y02669 27170002
         BNO   BADKOP              NO - IEE156I INVALID OPERAND         27180002
         CLI   N1(KOPS),BLANK      IS 2ND CHAR A BLANK?                 27200002
         BE    ONEDIGIT            NO, 1 DIGIT LENGTH                   27300002
         CLI   N1(KOPS),COMMA      IS 2ND CHAR A COMMA?                 27400002
         BE    ONEDIGIT            YES, 1 DIGIT LENGTH                  27450002
         TM    N1(KOPS),DIGIT      IS 2ND CHAR A DIGIT?                 27452002
         BNO   BADKOP              NO, IEE156I INVALID OPERAND          27454002
         CLI   N2(KOPS),BLANK      IS 3RD CHAR A BLANK?                 27460002
         BE    TWODIGIT            NO, 2 DIGIT LENGTH                   27500002
         CLI   N2(KOPS),COMMA      IS 3RD CHAR A COMMA?                 27550002
         BE    TWODIGIT            YES, 2 DIGIT LENGTH                  27560002
         B     BADKOP              NO, IEE156I INVALID OPERAND          27570002
         EJECT                                                          27580002
*********************************************************************** 27582002
*                                                                     * 27590002
*                  PACK AND CONVERT TO BINARY                         * 27592002
*     BUMP OPERAND POINTER TO CHARACTER FOLLOWING LAST VALID DIGIT    * 27592402
*                                                                     * 27594002
*********************************************************************** 27596002
ONEDIGIT EQU   *                                                        27600001
         MVC   XAX+N7(N1),N0(KOPS) MOVE THE DIGIT                Y02669 28000002
         LA    KOPS,N1(KOPS)       BUMP POINTER TO NEXT NN              28100002
         B     GOPACK              GO PACK IT                           28200001
TWODIGIT EQU   *                                                        28400001
         MVC   XAX+N6(N2),N0(KOPS) MOVE THE DIGIT                Y02669 28500002
         LA    KOPS,N2(KOPS)       BUMP POINTER TO NEXT NN              28600002
GOPACK   EQU   *                                                        28800001
         PACK  XAX+N4(N4),XAX+N4(N4)  PACK NUMBER                Y02669 28900002
         NI    XAX+N7,SIGN         CONVERT FOX TO CHARLIE        Y02669 29000002
         SR    R5,R5               CLEAR REG                     Y02669 29050002
         CVB   R5,XAX              CONVERT IT TO A BINARY NUMBER Y02669 29200002
*********************************************************************** 29210002
*                                                                     * 29250002
*    IF NUMBER GREATER THAN MSG AREA = IEE924I - SCREEN SIZE EXCEEDED * 29260002
*    IF NUMBER LESS THAN FOUR = IEE924I - AREA TOO SMALL              * 29270002
*    IF TOTAL NUMBER GREATER THAN MSG AREA = IEE924I - AREA TOO SMALL * 29280002
*                                                                     * 29290002
*********************************************************************** 29340002
         CH    R5,DCMRMSAL         IS NN GREATER THAN MSG AREA?         29400002
         BH    TOOBIG              YES-IT'S AN ERROR             Y02669 29500002
         CH    R5,FOUR             IS IT LESS THAN FOUR?         Y02669 29700002
         BL    TOOSMALL            YES--IT'S AN ERROR            Y02669 29800002
         AR    R0,R5               ADD TO LINE COUNTER                  30200001
         CH    R0,DCMRMSAL         DOES LINE COUNT EXCEED MAX. NUMBER?  30300002
         BH    TOOBIG              YES--IT'S AN ERROR            Y02669 30400002
         STC   R5,N0(R6)           SAVE AREA LENGTH                     30600002
         LA    R6,N1(R6)           BUMP LENGTH SAVE AREA POINTER        30700001
         LA    R1,N1(R1)           BUMP AREA COUNTER                    30800001
         CLI   N0(KOPS),BLANK      ANY MORE DIGITS?                     31300002
         BE    NOMORELL            NO                            Y02669 31400002
         CLI   N0(KOPS),COMMA      NEXT CHAR COMMA?              Y02669 31402002
         BNE   BADKOP              NO, IEE156I                   Y02669 31404002
         LA    KOPS,N1(KOPS)       BUMP POINTER BEYOND COMMA     Y02669 31404402
         B     LLLOOP              CHECK NEXT OPERAND            Y02669 31404802
         EJECT                                                          31406002
NOMORELL EQU   *                                                        31570002
         LTR   SACBPT,SACBPT       ANY SACB'S DEFINED?                  31600002
         BZ    ENDLL               NO - SKIP NEXT 2 LOOPS               31700001
         SPACE 2                                                        32950002
*********************************************************************** 33410002
*                                                                     * 33450002
*    THE FOLLOWING CODE CHECK THAT SACBS ARE REDEFINED ONLY           * 33500002
*    IF THERE IS NO DISPLAY IN OR ABOVE AREAS                         * 33600002
*    IF SACB HAS DIFFERENT LENGTH THAN THE REDEFINITION LENGTH   Y02669 33610002
*    ERR - IEE924I DISPLAY IN OR ABOVE AREA                      Y02669 33620002
*                                                                     * 33650002
*********************************************************************** 33660002
         SPACE 2                                                        33670002
         LA    R6,XASAVSTD         GET POINTER TO AREA LENGTHS   Y02669 33680002
TSTNXTBL EQU   *                                                        33700001
         CLC   DCMAID(N1),DCMTOPDS IS BLOCK ABOVE USED AREA?     Y02669 33950002
         BH    BUMP                NO - COMPARE LENGTHS          Y02669 34000002
COMPLL   EQU   *                                                        34500001
         CLC   DCMALN+N1(N1),N0(R6) YES- ARE LENGTHS THE SAME?   Y02669 34600002
         BNE   ERROR               IF NOT THE SAME IT'S AN ERROR        34700001
BUMP     EQU   *                                                        34800001
         ICM   SACBPT,N7,DCMACBNX+1   IS THERE ANOTHER AREA?     Y02669 35000002
         BZ    ENDLL               NO, LAST SACB INSPECTED              35200002
         LA    R6,N1(R6)           BUMP LENGTHS POINTER          Y02669 35400002
         B     TSTNXTBL            DECRE PTR AND CHK NEXT BLOCK  Y02669 35500002
         EJECT                                                          35550002
*********************************************************************** 35600002
*    ALL THE SACBS HAVE BEEN INSPECTED- INITIALIZE TO DESIRED LENGTH  * 35700002
*    PRIME POINTERS TO ID TABLE, SACB CHAIN START AND LOAD SIZE OF    * 35750002
*    SCREEN                                                           * 35760002
*********************************************************************** 35810002
ENDLL    EQU   *                                                        36000001
         LA    R3,TABLE            LOAD ADDR OF AREA ID TABLE    Y02669 36100002
         LA    R6,XASAVSTD         GET POINTER TO LENGTHS        Y02669 36200002
         L     SACBPT,DCMADSDS     GET ADDRESS OF FIRST SACB            36300002
         LA    R5,DCMADSDS         SAVE ADDR OF CHAIN ORIGIN     Y02669 36400002
         LH    R4,DCMRMSAL         LOAD SIZE OF MSG AREA                36600001
         LA    R4,N1(R4)           BUMP IT BY ONE                       36700001
*********************************************************************** 36710002
*                                                                     * 36750002
*     IF SACB DEFINED AND IN USE, IGNORE IT                           * 36760002
*     IF SACB DEFINED AND NOT IN USE, REINITIALIZE IT                 * 36762002
*     IF NO SACB IS DEFINED, ISSUE GETMAIN AND INITIALIZE IT          * 36764002
*                                                                     * 36770002
*********************************************************************** 36820002
INCORE2  EQU   *                                                        36900001
         LTR   SACBPT,SACBPT       ANY AREA DEFINED?                    37000002
         BZ    GETCORE             NO--GETMAIN MORE SACB'S              37100002
         TM    DCMAFLG1,DCMADISP   IS SACB BEING USED?                  37300002
         BO    NOINIT              YES                           Y02669 37400002
         BAL   R15,SACBINIT        GO INITIALIZE SACB            Y02669 37500002
         B     INCORE              CONTINUE SACB INITIALIZATION  Y02669 37600002
NOINIT   EQU   *                                                 Y02669 37700002
         BCTR  R3,N0               DECREMENT TABLE ID POINTER    Y02669 37900002
         LA    R6,N1(R6)           INCREMENT LL LENGTH POINTER   Y02669 38000002
         SR    R4,R4               INIT STARTING POINT TO               38050002
         IC    R4,DCMATOP          CALCULATE TOP ROW NO.                38060002
         LR    R5,SACBPT           UPDATE PTR TO PREVIOUS BLOCK  Y02669 38100002
INCORE   EQU   *                                                        38300001
         MVC   DCMTOPAR,DCMAID        MOVE TOP SACB AREA ID TO @ZA06491 38350003
         L     SACBPT,N0(SACBPT)   LOAD ADDR OF NEXT SACB               38400001
         BCT   R1,INCORE2          DECR. SACB LL COUNT                  38600001
FREEXTRA EQU   *                                                 YM1912 38620002
         LTR   SACBPT,SACBPT       ARE THERE ANY NOT REDEFINED?  YM1912 38640002
         BZ    ALLDONE             NO, OK TO CONTINUE            YM1912 38660002
         TM    DCMASACB,DCMAGM     IS IT A GETMAINED SACB?     @ZA06491 38662003
         BO    FREESACB            YES, GO FREEMAIN IT         @ZA06491 38664003
         XC    DCMACLR(DCMCLRLN),DCMACLR RE-INITIALIZE SACB    @ZA06491 38666003
         NI    DCMASACB,XFF-DCMAUSE TURN OFF IN-USE BIT        @ZA06491 38668003
         XC    DCMALN(N2),DCMALN   ZERO OUT SACB LENGTH FIELD  @ZA06491 38670003
         LR    R5,SACBPT           SAVE PREVIOUS BLOCK PTR     @ZA06491 38672003
         L     SACBPT,N0(SACBPT)   LOAD ADDR OF NEXT SACB      @ZA06491 38682003
         B     FREEXTRA            LOOP TIL ALL UNUSED ARE FREED YM1912 38730002
ALLDONE  EQU   *                                                 Y02669 38750002
         LR    SACBPT,R5           RESTORE PT TO LAST BLOCK      Y02669 38800002
         B     ZAPSACB                                                  38900001
         EJECT                                                          39750002
*********************************************************************** 39800002
*    GET CORE FOR MULTI SACB'S AND INITIALIZE THEM                    * 39810002
*    BRANCH ENTRY TO GETMAIN USED SINCE LOCKS NEED TO BE HELD         * 39818002
*      REGISTERS DESTROYED: 0, 1, 3, 4, 7, 14, 15                     * 39826002
*      INPUT INFORMATION: R4 POINTS TO CURRENT TCB                    * 39834002
*                         R7 (SACBPT) POINTS TO CURRENT ASCB          * 39842002
*********************************************************************** 39850002
GETCORE  EQU   *                                                        40800001
         ST    R1,XASTSAVE         SAVE SACB COUNT               Y02669 40810002
         LA    R9,DCMACBSZ         LOAD BYTE COUNT WANTED        Y02669 40820002
         M     R8,XASTSAVE         MULTIPLY SACB COUNT BY SIZE   Y02669 40830002
         STM   R3,R4,XASAVLOC      SAVE ACROSS GETMAIN           Y02651 40840002
         L     R4,PTRCVT           GET ADDRESS OF CVT            Y02651 40850002
         USING CVTSECT,R4          ADDRESSABILITY OF CVT         Y02651 40900002
         L     R4,CVTTCBP          GET ADDRESS OF TCBS & ASCBS   Y02651 40950002
         DROP  R4                                                Y02651 40952002
         USING TCBASCB,R4          ADDRESSABILITY OF IEFPTRS     Y02651 40960002
         L     SACBPT,ASCBPTR      ADDRESS OF ASCB FOR INTERFACE Y02651 41000002
         L     R4,TCBPTR           ADDRESS OF TCB FOR INTERFACE  Y02651 41050002
         GETMAIN RC,LV=(9),SP=SP241,BRANCH=YES                   Y02651 41060002
         LTR   R15,R15             TEST RETURN CODE              Y02669 41700002
         BNZ   MSG931              ERROR NO CORE                 Y02669 41800002
         LM    R3,R4,XASAVLOC      RESTORE AFTER GETMAIN         Y02651 41850002
         LR    SACBPT,R1           LOAD ADDR OF SACB CORE        Y02669 42300002
         L     R1,XASTSAVE         RESTORE SACB COUNTER          Y02669 42400002
         B     INIT3               GO INITIALIZE THEM                   42500002
         EJECT                                                          43500002
INIT2    EQU   *                                                        43700001
         LA    SACBPT,DCMACBSZ(SACBPT) BUMP SACB POINTER TO NEXT Y02669 43800002
INIT3    EQU   *                                                        44100001
         OI    DCMASACB,DCMAGM     SET GETMAINED FLAG BIT IN SACB ON    44300002
         BAL   R15,SACBINIT        GO INITIALIZE SACB            Y02669 44500002
         BCT   R1,INIT2            CONTINUE SACB INITIALIZATION  Y02669 46200002
         SPACE 2                                                        46250002
ZAPSACB  EQU   *                                                        46600001
         SR    R1,R1               INITIALIZE TO ZERO          @YM2777P 46650002
         ST    R1,DCMACBNX         ZERO OUT POINTER-TO-NEXT      Y02669 46700002
         EJECT                                                          46850002
*********************************************************************** 46860002
*       GETMAIN CORE FOR AND ISSUE IEE928I                              46870002
*********************************************************************** 46880002
         SPACE 2                                                        46900001
         STM   RB,RETURN14,XASAVLOC                              Y02651 47200002
         SETLOCK RELEASE,TYPE=CMS,RELATED=(K,IEE7503D(LOCKSET))         47250002
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(K,IEE7503D(LOCKSET))       47260002
         LM    RB,RETURN14,XASAVLOC                              Y02651 47270002
         NI    XASSDS,XFF-XASSDS5                                Y02651 47280002
         LA    R1,XASAVLOC+N12    GET ADDR OF WHERE TO PUT ADDR  Y02669 47282002
         MVC   XASAVLOC(N10),GETAREA     MOVE PARM LIST TO XSA   Y02669 47284002
         ST    R1,XASAVLOC+N4     WHERE TO PUT ADDR FOR GETMAIN  Y02669 47286002
         LA    R1,XASAVLOC        ADDR OF PARM LIST FOR GETMAIN  Y02669 47288002
         GETMAIN  MF=(E,(1))                                     Y02669 47290002
         LTR   R15,R15             TEST RETURN CODE                     47300002
         BNZ   RETURN              IF NOT ZERO;MEANS NO CORE     Y02669 47350002
         SPACE                                                          47400002
         L     R6,XASAVLOC+N12     LOAD GETMAINED ADDR           Y02669 47450002
         LR    R1,R6               SAVE POINTER                         47500001
         MVC   N4(L'IEE928I,R6),IEE928I      MOVE MSG INTO GETMAINED    47550001
         LA    R6,N49(R6)          BUMP MESSAGE POINTER                 47600002
         L     SACBPT,DCMADSDS     RESET SACB PT                        47650002
NEXTSACB EQU   *                                                        48000001
         TM    DCMASACB,DCMAUSE  IS AREA IN USE?               @ZA06992 48050003
         BZ    LASTONE           IF NO, BYPASS ID IN MSG       @ZA06992 48100003
         MVC   N0(N1,R6),DCMAID    MOVE AREA ID INTO MSG                48300002
         MVI   N1(R6),COMMA        MOVE IN COMMA AFTER AREA ID          48350002
         LA    R6,N2(R6)           BUMP MESSAGE POINTER                 48400002
         ICM   SACBPT,N7,DCMACBNX+1   GET POINTER TO NEXT SACB   Y02669 48550002
         BNZ   NEXTSACB            YES-KEEP ON LOOPING                  48650002
LASTONE  EQU   *                                               @ZA06992 48700003
         BCTR  R6,N0               GET RID OF EXTRA COMMA               48850002
         SR    R4,R4               CLEAR REG                     Y02669 49050002
         IC    R4,XASCID           GET TARGET'S CONSOLE ID       Y02669 49100002
         CVD   R4,XAX              CONVERT TO DECIMAL            Y02669 49250002
         UNPK  XAX(N3),XAX+N6(N2)  UNPACK NUMBER                 Y02669 49300002
         OI    XAX+N2,DIGIT        FIX SIGN                      Y02669 49350002
         MVC   N42(N2,R1),XAX+N1   PUT CC INTO MSG               Y02669 49400002
         MVC   N0(N4,R6),DESCR5    MOVE DESCRIPTOR CODE          Y02669 49650002
         SR    R6,R1               GET LENGTH OF MSG                    49750001
         STH   R6,N0(R1)           STORE FOR WTO                        49800001
         MVI   N2(R1),MCSMASK      ID PASSED AND QUEUE BY ID FLAGS      49850001
         MVI   N3(R1),N0           ZERO SECOND MCSFLGS BYTE             49900001
         SR    R0,R0               CLEAR REG                     Y02669 49910002
         IC    R0,XAU              LOAD SOURCE DEVICE ID                49950001
         LR    R6,R1               SAVE POINTER TO PARAMETER LIST       49952001
         SPACE                                                          49960002
         WTO   MF=(E,(1))                                               50000001
         FREEMAIN R,SP=SP229,LV=N80,A=(6)                        Y02669 50020002
RETURN   EQU   *                                                 Y02669 50148002
         L     RETURN14,XAP       RESTORE RETURN REG             Y02669 50150002
         BR    RETURN14           GO BACK TO SYSTEM              Y02669 50200002
         EJECT                                                          50460001
GETAREA  GETMAIN  EC,LV=N80,A=MSG931,SP=SP229,MF=L               Y02669 50702002
         SPACE 2                                                        50702602
SACBINIT EQU   *                                                 Y02669 50703202
         ST    SACBPT,N0(R5)       SET UP CHAINING OF BLOCKS     Y02669 50703802
         XC    DCMALN(N26),DCMALN  CLEAR SACB WITH ZEROS         Y02669 50704402
         LR    R5,SACBPT           SAVE PT TO THIS BLOCK         Y02669 50705002
         MVC   DCMAID(N1),N0(R3)   MOVE AREA ID INTO SACB        Y02669 50705602
         MVC   DCMTOPAR,DCMAID     MOVE TOP SACB AREA ID INTO R@ZA06491 50705903
         BCTR  R3,N0               DECR TABLE POINTER            Y02669 50706202
         MVC   DCMALN+N1(N1),N0(R6)   MOVE LL OF AREA INTO SACB  Y02669 50706802
         LA    R6,N1(R6)           BUMP PT                       Y02669 50707402
         SH    R4,DCMALN           MINUS NO. OF LINES FOR THIS AREA     50708002
         STC   R4,DCMATOP          SAVE TOP ROW NO. OF AREA      Y02669 50708602
         OI    DCMASACB,DCMAUSE    SET IN-USE FLAG BIT ON        Y02669 50709202
         MVC   DCMAFR(N2),F0F0     INITIALIZE FRAME NO.          Y02669 50710002
         BR    R15                                               Y02669 50711002
         EJECT                                                          50712002
*********************************************************************** 50713002
* NOTE: LOCKS HELD ON ENTRY TO IEE6803D - BRANCH ENTRY TO FREEMAIN    * 50714002
*       IS NECESSARY TO DECHAIN AND FREE SACB'S                       * 50715002
*         REGISTERS DESTROYED : 0, 1, 3, 4, 7, 14, 15                 * 50716002
*         INPUT INFORMATION: R4 POINTS TO CURRENT TCB                 * 50720002
*                            R7 POINTS TO CURRENT ASCB                * 50722002
*********************************************************************** 50722202
FREESACB EQU   *                                                 YM1912 50722402
         L     R4,PTRCVT           GET ADDRESS OF CVT            YM1912 50722602
         USING CVTSECT,R4          ADDRESSABILITY FOR CVT        YM1912 50722802
         L     R4,CVTTCBP          ADDRESS OF TCBS & ASCBS       YM1912 50723002
         DROP  R4                                                YM1912 50723202
         USING TCBASCB,R4          ADDRESSABILITY FOR IEFPTRS    YM1912 50723402
         LR    R1,SACBPT           ADDR OF AREA TO FREE UP       YM1912 50723602
         L     SACBPT,N0(SACBPT)   RESET SACB POINTER            YM1912 50723802
         ST    SACBPT,XASAVSTD     SAVE DCM BASE REG             YM1912 50724002
         L     SACBPT,ASCBPTR      ADDRESS OF ASCB FOR INTERFACE YM1912 50724202
         L     R4,TCBPTR           ADDRESS OF TCB FOR INTERFACE  YM1912 50724402
         LA    R0,DCMACBSZ         PASS SACB LENGTH                     50725202
         FREEMAIN RC,LV=(0),A=(1),SP=SP241,BRANCH=YES                   50726002
         L     SACBPT,XASAVSTD     RESTORE DCM BASE REG          YM1912 50726802
         B     FREEXTRA          LOOP TIL ALL UNUSED SACBS FREE@ZA06491 50727603
         EJECT                                                          50728402
*********************************************************************** 50729202
*                                                                     * 50730002
*                          ERROR EXITS                           Y02669 50731002
*                                                                     * 50732002
*********************************************************************** 50736002
         SPACE 2                                                        50740002
TOOSMALL EQU   *                                                 Y02669 50742002
         BCTR  KOPS,N0             POINT TO BAD VALUE            Y02669 50745002
         MVI   XASTSAVE,IEE924I2   AREA TOO SMALL                Y02669 50749602
         B     ERROR2              BRANCH TO ERROR EXIT                 50749702
TOOBIG   EQU   *                                                 Y02669 50752702
         SH    KOPS,TWO            POINT TO INVALID VALUE      @YM4785P 50755702
         CLI   N0(KOPS),COMMA      POINTING TO DIGIT?            Y02669 50758702
         BNE   MSG924I3            YES, GET ERROR CODE           Y02669 50761702
         LA    KOPS,N1(KOPS)       NO, ADVANCE TO DIGIT          Y02669 50764702
MSG924I3 EQU   *                                                 Y02669 50767702
         MVI   XASTSAVE,IEE924I3   SCREEN SIZE EXCEEDED          Y02669 50770702
         B     ERROR2              BRANCH TO ERROR EXIT                 50776602
ERROR    EQU   *                                                        50782602
         MVI   XASTSAVE,IEE924I    DISPLAY IN OR ABOVE AREA      Y02669 50783002
         L     KOPS,XASAVLOC       RETRIEVE OP PTR               Y02669 50783102
ERROR2   EQU   *                                                        50783202
         MVI   XAE,IEE924          SET ON MAJOR FLAG BIT         Y02669 50788802
         B     STOREOP             STORE BAD OPERAND ADDR        Y02669 50790802
         SPACE 2                                                        50791202
MSGSTRM  EQU   *                                                 Y02669 50791602
         MVI   XAE,IEE926I         INDICATE INVALID OP                  50792802
         MVI   XASTSAVE,IEE926     INDICATE MSG STREAM OUTPUT    Y02669 50794802
         B     STOREOP                                           Y02669 50796802
         SPACE 2                                                        50798802
MSG931   EQU   *                                                        50800001
         MVI   XAE,IEE931I         CORE NOT AVAILABLE            Y02669 50850002
         B     D5603D              GO TO PUT OUT MSG             Y02669 50900002
         SPACE 2                                                        52710002
BADKOP   EQU   *                                                        52760001
         MVI   XAE,IEE156I         IEE156I INVALID OPERAND              52770002
STOREOP  EQU   *                                                        52790001
         STCM  KOPS,N7,XASOPTR     SAVE OPERAND POINTER          Y02669 52792002
D5603D   EQU   *                                                 Y02669 52796002
         L     RETURN14,XAP        RESTORE RETURN REG            Y02669 52863202
         L     R15,VCON5603                                      Y02669 52871502
         BR    R15                                               Y02669 52873102
         EJECT                                                          52893301
*********************************************************************** 53510002
*                                                                     * 53520002
*                       SACB AREA ID TABLE                       Y02669 53530002
*          NOTE: FOLLOWING TABLE IS INTERNAL TO THIS MODULE.          * 53550002
*                IT WILL BE NECESSARY TO EXPAND THIS TABLE TO    Y02669 53600002
*                TO SUPPORT MORE THAN 11 AREAS OR A SCREEN       Y02669 53602002
*                WITH MORE THAN 47 LINES.                        Y02669 53604002
*                                                                     * 53610002
*********************************************************************** 53650002
         SPACE 2                                                        53660002
         DC    C'K'                SACB AREA ID                         53700001
         DC    C'J'                SACB AREA ID                         53800001
         DC    C'I'                SACB AREA ID                         53900001
         DC    C'H'                SACB AREA ID                         54000001
         DC    C'G'                SACB AREA ID                         54100001
         DC    C'F'                SACB AREA ID                         54200001
         DC    C'E'                SACB AREA ID                         54300001
         DC    C'D'                SACB AREA ID                         54400001
         DC    C'C'                SACB AREA ID                         54500001
         DC    C'B'                SACB AREA ID                         54600001
TABLE    DC    C'A'                BOTTOM SACB AREA ID                  54700001
         EJECT                                                          54710002
*********************************************************************** 54750002
*                                                                     * 54760002
*                           CONSTANTS                            Y02669 54770002
*                                                                     * 54780002
*********************************************************************** 54790002
         SPACE 2                                                        54790402
TWO      DC    H'2'                CONSTANT                    @YM4785P 54791202
FOUR     DC    H'4'                CONSTANT                             54792002
F0F0     DC    XL2'F0F0'           AREA FRAME NUMBER ZERO               54794002
IEE928I  DC    CL45'IEE928I DISPLAY AREA ID''S FOR CONSOLE CC ARE'      54900001
DESCR5   DC    B'00001000000000000000000000000000' DESCRIPTOR CODE+RT   54950002
VCON5603 DC    V(IEE5603D)         MSG MODULE NAME               Y02669 55000002
         SPACE  5                                                       55160002
*********************************************************************** 55162002
*                                                                     * 55170002
*                           PATCH AREA                           Y02669 55180002
*                                                                     * 55190002
*********************************************************************** 55192002
         SPACE 2                                                        55194002
PATCH    DC    CL68'***PATCH AREA - IEE6803D***'                 Y01939 55200001
         EJECT                                                          55250001
         IEECUCM  FORMAT=NEW                                            56100002
         EJECT                                                          56150002
         IEERDCM                                                        56300002
         EJECT                                                          56350002
FAUXSA   DSECT                                                          56500001
         IEEXSA                                                         56600001
         EJECT                                                          56650002
CVTSECT  DSECT                                                          56700001
         CVT                                                            56800001
         EJECT                                                          56810002
         IEFPTRS                                                        56850002
         EJECT                                                          56900002
         IHAPSA                                                         56950002
         END                                                            57100001
