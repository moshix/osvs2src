         TITLE 'IEE7503D -- L=CCA AND LIST PROCESSOR'                   00100002
*********************************************************************** 00150002
*                                                                     * 00152002
* MODULE NAME      =  IEE7503D                                  Y02669* 00160002
*                                                                     * 00170002
* DESCRIPTIVE NAME =  L=CCA AND ITS DEFAULTS AND LIST           Y02669* 00180002
*                     OPERAND PROCESSOR                         Y02669* 00182002
*                                                                     * 00190002
* COPYRIGHT        =  N/A                                       Y02669* 00192002
*                                                                     * 00194002
* STATUS           =  OS/VS2 RELEASE 037  SU 17               @ZA29986* 00194100
*                                                                     * 00198002
* FUNCTION         =  THIS MODULE PROCESSES THE FOLLOWING       Y02669* 00198402
*                     OPERANDS ON THE FOLOWING COMMANDS:        Y02669* 00199702
*                     COMMAND            OPERANDS               Y02669* 00201702
*                     ______             ________               Y02669* 00202102
*                     D  C,K                                    Y02669* 00203702
*                     D  CONSOLES  (C)                          YM1916* 00205702
*                     D  U                                      Y02669* 00206102
*                     D  M                                      Y02669* 00206202
*                     D  3850                                 @Z40LPTA* 00206341
*                     D  DMN                                  @Z40BPSV* 00206441
*                     D  SLIP                                 @G17SPTJ* 00206641
*                     D  DUMP (D)                             @G33CPMR* 00206833
*                     K  COMMANDS       L=CCA AND DEFAULTS      Y02669* 00207141
*                     PT JOBS  (J)                              Y02669* 00207302
*                        TS                                     Y02669* 00207402
*                        A                                      Y02669* 00207502
*                   __________________________________________  Y02669* 00207602
*                     D  JOBS  (J)                              Y02669* 00208102
*                        TS                                     Y02669* 00209702
*                        A               L=CCA AND DEFAULTS     Y02669* 00211702
*                     TR JOBS  (J)          AND ,LIST           Y02669* 00212802
*                        TS                   OR ,L             Y02669* 00213202
*                        A                                      Y02669* 00213302
*                                                                     * 00215002
* SPECIAL NOTE    =   THE FOLLOWING TERMS ARE INTERCHANGABLE:   Y02669* 00216002
*                       NULL AND X'00'                          Y02669* 00217802
*                       GRAPHICS AND CRT                        Y02669* 00218202
*                       'Z' AND IN-LINE                         Y02669* 00219602
*                       SOURCE, ISSUING AND REQUESTING CONSOLE  Y02669* 00220002
*                       'A' AND AREA                            Y02669* 00220902
*                       'CC' AND TARGET CONSOLE ID              Y02669* 00221302
*                       'L' OPERAND AND 'L=CCA';'L=CC';'L=A'    Y02669* 00221702
*                        OUT-OF-LINE, IN AN AREA AND 'A'        Y02669* 00222102
*                     THE FOLLOWING DEFINITIONS MAY BE USEFUL:  Y02669* 00222502
*                       STATUS DISPLAY (SD)-A CRT IN OUTPUT     Y02669* 00222902
*                         ONLY MODE, DIVIDED INTO AREAS INTO    Y02669* 00223002
*                         WHICH ONLY DYNAMIC AND STATUS         Y02669* 00223102
*                         DISPLAYS CAN APPEAR                   Y02669* 00223202
*                       MESSAGE STREAM (MS)-A CRT IN OUTPUT     Y02669* 00223302
*                         ONLY MODE, WHICH CAN NOT BE DIVIDED   Y02669* 00223402
*                         INTO AREAS AND RECEIVES ONLY IN-LINE  Y02669* 00223502
*                         OPERATOR TYPE MESSAGES                Y02669* 00223602
*                       FULL CAPABILITY (FC)-A CRT IN INPUT-    Y02669* 00223702
*                         OUTPUT MODE WHICH CAN BE DIVIDED INTO Y02669* 00223802
*                         AREAS WHICH CAN RECEIVE BOTH DYNAMIC  Y02669* 00223902
*                         AND STATUS DISPLAYS BUT WHICH ALSO    Y02669* 00224002
*                         CONTAINS AN IN-LINE PORTION AT THE    Y02669* 00224102
*                         TOP OF THE SCREEN FOR OPERATOR TYPE   Y02669* 00224402
*                         MESSAGES                              Y02669* 00224502
*                         IT CAN ALSO BE USED TO ENTER COMMANDS Y02669* 00224602
*                       STATUS DISPLAY-A MULTI-LINE WTO ISSUED  Y02669* 00224702
*                         AS THE RESULT OF MOST 'DISPLAY'       Y02669* 00224802
*                         COMMANDS WHICH APPEARS IN AN AREA 'A' Y02669* 00224902
*                         (OUT-OF-LINE) ON A SD OR FC CRT IF    Y02669* 00225002
*                         'L=A' IS SPECIFIED. OR CAN APPEAR     Y02669* 00225102
*                         IN-LINE ON A MS OR FC CRT.            Y02669* 00225202
*                       DYNAMIC DISPLAY-A MULTI-LINE WTO        Y02669* 00225302
*                         RESULTING FROM A TRACK COMMAND WHICH  Y02669* 00225402
*                         IS PERIODICALLY UPDATED BASED ON A    Y02669* 00225702
*                         TIME INTERVAL.                        Y02669* 00226302
*                         THIS DISPLAY CAN ONLY APPEAR IN AN    Y02669* 00226902
*                         AREA (OUT-OF-LINE) ON A SD OR FC CRT. Y02669* 00227502
*                       IN-LINE (Z) REFERS TO THE MESSAGE       Y02669* 00228102
*                         STREAM PRODUCED ON A MS OR FC CRT.    Y02669* 00228702
*                       OUT-OF-LINE REFERS TO THE AREAS         Y02669* 00229302
*                         DEFINED ON A SD OR FC CRT.            Y02669* 00229902
*                                                                     * 00230502
* OPERATION       =   IF THE REQUESTOR IS JES2(XAN=X'22'), THE  Y02669* 00231102
*                     ENTRY POINT IS IEE7603D, REGISTERS 0 - 14 Y02669* 00231202
*                     ARE SAVED IN XASAVSTD,(REGISTER 2 POINTS  Y02669* 00231302
*                     TO XSA ON ENTRY) LOCKS ARE OBTAINED AND   Y02669* 00231402
*                     THE SPECIAL JES2 INTERFACE CODE INVOKED.  Y02669* 00231702
*                                                                     * 00232902
*                     IF THE REQUESTOR IS A JES3 ASSOCIATED   @Y02668P* 00233203
*                     CONSOLE THEN THE COMMAND WAS NOT ISSUED @Y02668P* 00233503
*                     IN COMTASK'S MEMORY. THE CURRENT TCB    @Y02668P* 00233803
*                     POINTER IN IEFPTRS IS COMPARED TO       @Y02668P* 00236703
*                     COMTASK TCB IN THE UCM(TCBPTR=UCMPAX)   @Y02668P* 00237303
*                     IF THE DON'T MATCH XASSDS3 BIT IS SET   @Y02668P* 00237903
*                     ON. ONLY ROUTABLE (L=CCA) COMMANDS      @Y02668P* 00238703
*                     WILL BE VALID. EXECPT FOR K V,USE=.     @Y02668P* 00238903
*                     ALL MESSAGES WILL BE ISSUED VIA WTO.    @Y02668P* 00239103
*                     THE FOLLOWING MODULES WILL CHECK THE    @Y02668P* 00239303
*                     BIT 1. IEE5603D                         @Y02668P* 00239503
*                         2. IEE6703D                         @Y02668P* 00239703
*                         3. IEE6903D                         @Y02668P* 00240203
*                     IN THE FOLLOWING 'A' WILL REPRESENT THE   Y02669* 00240703
*                     A FIELD IN THE L=CCA OPERAND.             Y02669* 00241203
*                                                                     * 00241703
*                     THE ROUTING FIELD IN THE XSA (XAS) IS     Y02669* 00243703
*                     INITIALIZED TO ZEROES.                    Y02669* 00246603
*                                                                     * 00248603
*                     ALL OF THE ABOVE COMMANDS ARE FIRST       Y02669* 00250603
*                     INTERROGATED FOR THE 'L=CCA' OPERAND.     Y02669* 00252603
*                     IF STOPTR (PT) DOES NOT HAVE ANY         @YM2774P 00254603
*                     OPERAND (D AND TR HAVE ALREADY BEEN      @YM2774P 00256603
*                     'CHECKED), 'IEE311I' IS ISSUED.          @YM2774P 00258603
*                     IF FOUND, IT IS TRANSLATED AND PLACED     Y02669* 00260603
*                     IN THE XSA (XAS), THE 'L' OPERAND IS      Y02669* 00264002
*                     REMOVED FROM THE OPERAND BUFFER, AND      Y02669* 00264402
*                     THE VALUES PLACED IN THE XSA ARE THEN     Y02669* 00264802
*                     VALIDITY CHECKED.                         Y02669* 00265202
*                        XASSDS = XASSDS2 (X'40') 'L' WAS       Y02669* 00266002
*                                 SPECIFIED ON THE COMMAND.     Y02669* 00266402
*                        XASCID = THE SPECIFIED 'CC' VALUE      Y02669* 00266802
*                        XASDID = THE SPECIFIED 'A' VALUE       Y02669* 00267202
*                                                                     * 00267602
*                     IF THE 'L' OPERAND IS FOUND ON A COMMAND  Y02669* 00268402
*                     ISSUED FROM A TSO TERMINAL (XAA ^= X'00'),Y02669* 00268802
*                     'IEE305I COMMAND INVALID' IS ISSUED.      Y02669* 00269202
*                                                                     * 00270002
*                     IF 'CC' SPECIFIES AN INVALID CONSOLE ID,  Y02669* 00270402
*                     I.E. 'CC' IS HIGHER THAN THE CONSOLE ID   Y02669* 00270802
*                     DEFINED BY THE LAST UCME, OR '00'         Y02669* 00271202
*                     'IEE926I 'CC' NOT A CONSOLE' IS ISSUED.   Y02669* 00271602
*                                                                     * 00272202
*                     IF 'A' IS MORE THAN 1 CHARACTER,          Y02669* 00272802
*                     'IEE156I INVALID OPERAND' IS ISSUED.      Y02669* 00273202
*                                                                     * 00274002
*      MSGRT          IF THE 'L' OPERAND IS NOT FOUND ON THE    Y02669* 00274402
*      DEFAULTS       COMMAND, THE RCT (ROUTING CONTROL TABLE), Y02669* 00274802
*                     POINTED TO BY THE REQUESTING UCME AND     Y02669* 00275202
*                     BUILT AS THE RESULT OF A MSGRT COMMAND    Y02669* 00275602
*                     FOR THE REQUESTING CONSOLE, IS SCANNED    Y02669* 00276402
*                     TO SEE IF A DEFAULT ROUTING VALUE WAS     Y02669* 00277002
*                     SPECIFIED FOR THIS COMMAND.               Y02669* 00277202
*                       K= DEFAULTS FOR ALL CONTROL (K)         Y02669* 00277602
*                          COMMANDS                             Y02669* 00278202
*                       T= DEFAULTS FOR ALL TRACK AND STOPTR    Y02669* 00278802
*                          COMMANDS                             Y20669* 00279202
*                       D=O REPRESENTS DISPLAY CONSOLES (C)     Y02669* 00280002
*                     IF SO, THE ROUTING DEFAULTS ARE PLACED    Y02669* 00280402
*                     IN THE XSA AND VALIDITY CHECKED.          Y02669* 00280802
*                        XASCID = THE MSGRT DEFAULT VALUE       Y02669* 00281202
*                        XASDID = THE MSGRT DEFAULT OR X'00'    Y02669* 00282002
*                        XASSDS = X'00' 'L' NOT SPECIFED        Y02669* 00282402
*                                       ON THE COMMAND          Y02669* 00282802
*                                                                     * 00283202
*      INTERNALLY     IF THE ISSUING CONSOLE ID IS ZERO         YM1557* 00284002
*      ISSUED         (XAU=00) THE COMMAND WAS ISSUED           YM1557* 00284402
*      COMMAND        INTERNALLY. IF THE COMMAND WAS CONTROL    YM1557* 00284802
*                     (K), CONTROL IS RETURNED WITHOUT ANY      YM1557* 00285202
*                     ERROR MESSAGE. IF THE COMMAND WAS TRACK   YM1557* 00286002
*                     OR STOPTR, 'IEE927I  SPECIFY L OPERAND'   YM1557* 00286402
*                     IS ISSUED AND CONTROL RETURNED. ALL       YM1557* 00286802
*                     DISPLAY COMMANDS WILL BE ROUTED TO THE    YM1557* 00287202
*                     MASTER CONSOLE.                           YM1557* 00288002
*                                                                       00288402
*      SYSTEM         IF THERE IS NO CORRESPONDING RCT ENTRY    Y02669* 00288802
*      DEFAULTS       FOR THIS COMMAND, THE SYSTEM DEFAULTS     Y02669* 00289202
*                     TO THE REQUESTING CONSOLE. THE ROUTING    Y02669* 00290002
*                     INFORMATION IS PLACED IN THE XSA AND      Y02669* 00290502
*                     VALIDITY CHECKED.                         Y02669* 00291002
*                        XASCID = XAU (REQUESTING CONSOLE ID)   Y02669* 00291502
*                        XASDID = NULL                          Y02669* 00292002
*                        XASSDS = X'00' 'L' NOT SPECIFED        Y02669* 00292402
*                                       ON THE COMMAND          Y02669* 00292802
*                                                                     * 00293202
*      VALIDITY       THE VALUES IN XAS ARE THEN CHECKED FOR    Y02669* 00294002
*      CHECKING       ROUTING AUTHORITY, AND TO ENSURE THAT THE Y02669* 00294402
*                     TARGET CONSOLE IS ACTIVE WITH AREA 'A'    Y02669* 00294802
*                     DEFINED.                                  Y02669* 00295202
*                                                                     * 00295902
*                     IF THE TARGET AND REQUESTING CONSOLES ARE Y02669* 00296302
*                     NOT THE SAME (XASCID ^= XAU), THE SOURCE  Y02669* 00296702
*                     CONSOLE IS CHECKED FOR ROUTING AUTHORITY  Y02669* 00297502
*                     (UCMAUTH = X'20'). IF IT DOES NOT         Y02669* 00297902
*                     HAVE AUTHORITY TO ROUTE THE COMMAND,      Y02669* 00298302
*                     'IEE345I AUTHORITY INVALID' IS ISSUED.    Y02669* 00298702
*                                                                     * 00299502
*                     IF THE TARGET CONSOLE IS A SUBSYSTEM     @Y02668P 00299603
*                     (JES3) CONSOLE UCMDISPK WILL BE          @Y02668P 00299803
*                     ON. THE COMMAND WILL BE                  @Y02668P 00300003
*                     REJECTED. ERROR MESSAGE IEE926I          @Y02668P 00300203
*                     L=CCA OPERAND INVALID-CC SUBSYSTEM       @Y02668P 00300403
*                     CONSOLE IS ISSUED.                       @Y02668P 00300703
*                                                                     * 00304303
*                     IF THE TARGET CONSOLE IS NOT ACTIVE,      Y02669* 00304703
*                     (UCMATR ^= X'10') 'IEE926I 'CC' NOT A     Y02669* 00310303
*                     CONSOLE' IS ISSUED.                       Y02669* 00310703
*                                                                     * 00311503
*                     IF THE COMMAND IS OTHER THAN CONTROL VARY Y02669* 00312003
*                     (K V) OR THE TARGET CONSOLE IS NOT        Y02669* 00312503
*                     MESSAGE STREAM (MS) - AN OUTPUT CONSOLE   Y02669* 00312903
*                     WHICH DISPLAYS ALL REGULAR MESSAGES SENT  Y02669* 00313303
*                     TO THE OPERATOR, OR STATUS DISPLAY (SD)   Y02669* 00313703
*                     - AN OUTPUT CONSOLE WHICH DISPLAYS ONLY   Y02669* 00314503
*                     THOSE COMMANDS WHICH POSSESS AN 'L=CCA'   Y02669* 00315003
*                     OPERAND (UCMDISP ^= X'06'),               Y02669* 00315503
*                     'IEE926I FULL CAPABILITY' IS ISSUED.      Y02669* 00316003
*                     (ONLY K V COMMANDS CAN BE ROUTED TO A     Y02669* 00316503
*                     FULL CAPABILITY CONSOLE)                  Y02669* 00317003
*                                                                     * 00317502
*                     IF 'A' WAS SPECIFIED AND THE TARGET IS    Y02669* 00318003
*                     EITHER A NON-CRT (UCMDISP ^= X'20') OR    Y02669* 00318503
*                     MESSAGE STREAM ONLY (UCMDISP = X'04'),    Y02669* 00319003
*                     THE AREA FIELD IN THE XAS IS SET TO 'Z'   Y02669* 00319503
*                     (X'E9') TO INDICATE AN IN-LINE DISPLAY    Y02669* 00320003
*                     AREA ( XASDID = X'E9' ).                  Y02669* 00320503
*                     HOWEVER, IF THE TARGET IS A CRT DEVICE    Y02669* 00321003
*                     AND NOT MS ONLY, THE COMMAND IS ROUTED.   Y02669* 00321503
*                     (MS AND NON-CRT HAVE NO AREAS DEFINED.)   Y02669* 00322003
*                                                                     * 00322502
*                     IF 'A' WAS SPECIFIED AND THE TARGET       Y02669* 00323003
*                     DEVICE IS CRT (UCMDISP = X'20'),          Y02669* 00323403
*                     WITH THE AREA DEFINED AS IN-LINE          Y02669* 00323803
*                     (XASDID = 'Z'), AND THE TARGET IS STATUS  Y02669* 00324203
*                     DISPLAY ONLY (UCMDISP = X'02'),           Y02669* 00325003
*                     'IEE926I 'A' NOT AN AREA' IS ISSUED.      Y02669* 00325503
*                     HOWEVER, IF THE TARGET IS NOT STATUS      Y02669* 00326003
*                     DISPLAY ONLY, THE COMMAND IS ROUTED.      Y02669* 00326503
*                     (SD HAVE ONLY AREAS DEFINED, NO IN-LINE.) Y02669* 00327003
*                                                                     * 00327503
*                     IF THE TARGET IS CRT, WITH 'A' DEFINED    Y02669* 00328003
*                     ON THE COMMAND BUT FOR AN AREA THAT IS    Y02669* 00328503
*                     NOT DEFINED TO THE DEVICE; I.E. NO SACB   Y02669* 00329003
*                     (SCREEN AREA CONTROL BLOCK) WAS BUILT AS  Y02669* 00329503
*                     THE RESULT OF A CONTROL (K) A COMMAND,    Y02669* 00330003
*                     'IEE926I 'A' NOT AN AREA' IS ISSUED, BUT  Y02669* 00330503
*                     IF AN SACB EXISTS, THE COMMAND IS ROUTED. Y02669* 00331003
*                     (THE AREA MUST BE DEFINED PRIOR TO THE    Y02669* 00331503
*                     COMMAND BEING ISSUED.)                    Y02669* 00332003
*                                                                     * 00332503
*                     IF THE TARGET IS NON-CRT, WITH THE AREA   Y02669* 00333003
*                     DEFINED ON THE COMMAND 'IEE926I 'A' NOT   Y02669* 00333503
*                     AN AREA' IS ISSUED.                       Y02669* 00334003
*                     HOWEVER, IF THE AREA IS IN-LINE           Y02669* 00334503
*                     (I.E. 'Z') THE COMMAND IS ROUTED.         Y02669* 00335003
*      K COMMANDS     ONLY ROUTABLE K COMMANDS,EXCEPT FOR K V, @ZM30446 00337503
*                     ARE VALID FROM A SUBSYSTEM ( DUMMY )     @ZM30446 00337603
*                     CONSOLE. CONTROL IS PASSED               @ZM30446 00337703
*                     TO IEE6703D FOR ADDITIONAL VALIDITY      @Y02668P 00363703
*                     CHECKING AND ROUTING                     @Y02668P 00364303
*                                                                     * 00364903
*      ALL DISPLAY    ADDITIONAL VALIDITY CHECKING IS PERFORMED Y02669* 00365403
*      COMMANDS       IN THIS MODULE FOR D M; U; C,K; AND       Y02669* 00366003
*      INCLUDING      CONSOLES (C):, D 3850                    @Z40LPTA 00366404
*      DISPLAY        IF THE AREA 'A' HAD ALREADY BEEN DEFINED  Y02669* 00366803
*      ACTIVE         AS IN-LINE (XASDID = 'Z'), CONTROL IS     Y02669* 00367203
*      COMMANDS       GIVEN TO IEE0803D TO BUILD A CSCB.        Y02669* 00368003
*                                                                     * 00368403
*                     IF THE AREA 'A' HAS BEEN DEFINED AS       Y02669* 00369003
*                     OUT-OF-LINE (A WAS SPECIFIED ON THE       Y02669* 00369103
*                     COMMAND OR DEFAULTED AND XASDID CONTAINS  Y02669* 00370003
*                     THAT VALUE) AND THE SACB INDICATES THAT A Y02669* 00370403
*                     A DYNAMIC DISPLAY, (I.E. TR), ALREADY     Y02669* 00370803
*                     EXISTS IN THAT AREA, 'IEE926I DYNAMIC     Y02669* 00371403
*                     DISPLAY IN AREA' IS ISSSUED.              Y02669* 00371903
*                     HOWEVER, IF THE AREA DOES NOT CONTAIN     Y02669* 00372403
*                     A DYNAMIC DISPLAY, CONTROL IS GIVEN TO    Y02669* 00373003
*                     IEE0803D. A DISPLAY MAY OVERLAY ANOTHER   Y02669* 00373403
*                     EXISTING STATUS DISPLAY BUT NOT A         Y02669* 00373803
*                     DYNAMIC DISPLAY.                          Y02669* 00374203
*                                                                     * 00374603
*                     IF THE AREA HAS NOT BEEN GIVEN A DEFAULT  Y02669* 00375403
*                     VALUE (XASDID = NULL) YET, ONE IS NOW     Y02669* 00375803
*                     OBTAINED FROM THE SACB'S AS FOLLOWS:      Y02669* 00376203
*                      1-THE BOTTOM-MOST EMPTY AREA             Y02669* 00376803
*                      2-IF NONE, THE AREA CONTAINING THE       Y02669* 00377503
*                        OLDEST STATIC DISPLAY                  Y02669* 00377903
*                      3-IF NO AREA IS AVAILABLE, THE DISPLAY   Y02669* 00378303
*                        IS PUT IN-LINE (XASDID = 'Z')          Y02669* 00378703
*                      4-IF THE CONSOLE HAS NO MESSAGE STREAM   Y02669* 00379503
*                        ALSO REFERRED TO AS IN-LINE,           Y02669* 00379903
*                        THE COMMAND IS CANCELLED. EITHER       Y02669* 00380303
*                        'IEE921I DISPLAY AREA BUSY OR          Y02669* 00380703
*                        NEEDS DISPLAY AREA' IS ISSUED.         Y02669* 00381303
*                     FOR ALL VALID CONDITIONS, CONTROL GOES    Y02669* 00381903
*                     TO IEE0803D TO BUILD A CSCB.              Y02669* 00382203
*                                                                     * 00382603
*      DISPLAY        FOR D JOBS (J); A; AND TS FURTHER         Y02669* 00383203
*      ACTIVE         VALIDITY CHECKING IS PERFORMED.           Y02669* 00383803
*      COMMANDS       THE OPERAND BUFFER IS SCANNED FOR         Y02669* 00384503
*                     ',LIST' (,L).                             Y02669* 00384803
*                     IF FOUND THE XAXMASK FIELD IS SHIFTED     Y02669* 00385403
*                     RIGHT ONE BIT TO TURN ON THE 'LIST'       Y02669* 00385803
*                     INDICATOR FOR THE APPROPIATE COMMAND.     Y02669* 00386203
*                     CONTROL IS THEN GIVEN TO IEE0803D.        Y02669* 00386603
*                                                                     * 00387503
*       STOPTR        ADDITIONAL VALIDITY CHECKING FOR STOPTR   Y02669* 00387903
*       COMMANDS      IS ALSO PERFORMED IN THIS MODULE.         Y02669* 00388303
*                                                               Y02669* 00388703
*                     STOPTR COMMANDS ARA INVALID ON A         @Y02668P 00389503
*                     SUBSYSTEM CONSOLE. THE UCMDISPK BIT      @Y02668P 00389803
*                     IS CHECKED IN THE CONSOLE UCME           @Y02668P 00390103
*                     IF THE TARGET IS NON-CRT, 'IEE921I        Y02669* 00390603
*                     NEEDS DISPLAY AREA' IS ISSUED.            Y02669* 00391303
*                                                                     * 00392003
*                     IF AREA 'A' IS DEFINED AS 'Z', 'IEE921I   Y02669* 00392303
*                     NEEDS DISPLAY AREA' IS ISSUED.  IT IS     Y02669* 00392703
*                     IMPOSSIBLE TO HAVE A DYNAMIC DISPLAY      Y02669* 00393303
*                     IN-LINE.                                  Y02669* 00393703
*                                                                     * 00394203
*                     IF THE AREA 'A' IS NULL, THE SACB'S ARE   Y02669* 00394703
*                     SEARCHED FOR AN AREA CONTAINING A TRACK   Y02669* 00395503
*                     DISPLAY. IF ONE IS FOUND THE XASDID FIELD Y02669* 00395903
*                     IS OVERLAID WITH THE AREA ID FROM THE     Y02669* 00396303
*                     SACB (DCMAID), AND THE ADDRESS OF THIS    Y02669* 00396703
*                     SACB IS PLACED IN XAXSACB AND CONTROL     Y02669* 00397103
*                     IS GIVEN TO IEE5503D. IF NO AREA IS       Y02669* 00397603
*                     FOUND IN THE SACB'S, 'IEE921I NO TRACK    Y02669* 00398103
*                     TO STOP' IS ISSUED.                       Y02669* 00398603
*                                                                     * 00399303
*                     IF 'A' WAS SPECIFIED ON THE COMMAND AND   Y02669* 00399703
*                     IT DOES NOT MATCH ANY AREA DEFINED BY AN  Y02669* 00400103
*                     SACB'S, 'IEE921I NO TRACK TO STOP' IS     Y02669* 00401003
*                     ISSUED.                                   Y02669* 00401303
*                                                                     * 00401703
*                     IF IT DOES MATCH, THE ADDRESS OF THE      Y02669* 00402203
*                     SACB IS PLACED IN XAXSACB AND CONTROL     Y02669* 00403003
*                     GIVEN TO IEE5503D.                        Y02669* 00403303
*                                                                     * 00404003
*       TRACK         TRACK COMMANDS REQUIRE SLIGHTLY           Y02669* 00404403
*       COMMANDS      DIFFERENT VALIDITY CHECKING.              Y02669* 00405003
*                                                                     * 00405303
*                     IF THE TARGET CONSOLE IS NON-CRT,         Y02669* 00405603
*                     'IEE921I NEEDS DISPLAY AREA' IS           Y02669* 00406203
*                     ISSUED. TRACK IS ONLY VALID TO CRT.       Y02669* 00407003
*                                                                     * 00407303
*                     IF AREA 'A' IS DEFINED AS IN-LINE 'Z',    Y02669* 00407803
*                     'IEE921I NEEDS DISPLAY AREA' IS ISSUED.   Y02669* 00408403
*                     ( TRACK COMMAND CAN NOT APPEAR IN-LINE.)  Y02669* 00409003
*                                                                     * 00409203
*                     IF THERE IS NO EMPTY AREA  ON THE SCREEN  Y02669* 00409603
*                     AND XASDID IS STILL NULL, A DEFAULT IS    Y02669* 00410103
*                     SUPPLIED (SAME AS FOR DISPLAY EXCEPT      Y02669* 00410803
*                     THAT IF NO DISPLAY AREA IS AVAILABLE      Y02669* 00411203
*                     A TRACK COMMAND WILL BE REJECTED AND      Y02669* 00412003
*                     EITHER 'IEE921I DISPLAY AREA BUSY'        Y02669* 00412303
*                     OR 'NEEDS DISPLAY AREA' IS ISSUED.        Y02669* 00412703
*                                                                     * 00413403
*                     IF THE RESULTING AREA OR IF THE AREA      Y02669* 00413703
*                     SPECIFIED ON THE COMMAND CONTAINS A       Y02669* 00414103
*                     DYNAMIC DISPLAY, 'IEE926I DISPLAY         Y02669* 00414803
*                     ALREADY EXISTS' IS ISSUED.                Y02669* 00415503
*                                                                     * 00415803
*                     IN ALL VALID CASES, THE SACB CHAIN IS     Y02669* 00416503
*                     SEARCHED FOR AN AREA CONTAINING A         Y02669* 00416703
*                     TRACK DISPLAY.                            Y02669* 00417203
*                                                                     * 00417603
*                     IF ONE IS NOT FOUND, THIS IS THE FIRST    Y02669* 00418303
*                     TR COMMAND FOR THIS CONSOLE AND CONTROL   Y02669* 00419003
*                     IS GIVEN TO IEE0803D TO CREATE A CSCB     Y02669* 00419303
*                     SO THAT IEEVWAIT CAN ATTACH THE DISPLAY/  Y02669* 00419803
*                     TRACK PROCESSOR FOR THIS CONSOLE.         Y02669* 00420403
*                                                                     * 00420703
*                     IF AN ENTRY IS FOUND, THIS TRACK COMMAND  Y02669* 00421103
*                     WAS ISSUED TO UPDATE THE TRACK ENTRY.     Y02669* 00421603
*                     HOWEVER,  IF THE DISPLAY IS CURRENTLY IN  Y02669* 00422203
*                     THE HOLD MODE (K D,H WAS ISSUED) AND THE  Y02669* 00423003
*                     OPTIONS ON THIS TRACK COMMAND ARE         Y02669* 00423403
*                     IDENTICAL TO THE ONES CURRENT BEING       Y02669* 00423803
*                     DISPLAYED, IT IS ASSUMED THAT THE         Y02669* 00424303
*                     OPERATOR IS ATTEMPTING TO BRING IT OUT    Y02669* 00424603
*                     OF ITS HOLD MODE AND 'IEE921I DISPLAY     Y02669* 00425503
*                     ALREADY EXISTS' IS ISSUED AND CONTROL     Y02669* 00425803
*                     IS RETURNED. ( THE OPERATOR SHOULD HAVE   Y02669* 00426203
*                     ISSED K D,U WHICH BRINGS IT OUT OF THE    Y02669* 00427003
*                     HOLD MODE.) IF THEY DIFFER THE OPTION     Y02669* 00427403
*                     FLAGS IN THE CORRESPONDING SACB ARE       Y02669* 00427803
*                     UPDATED AND CONTROL IS RETURNED.          Y02669* 00428503
*                                                                     * 00428903
*      JES2 SCREEN    FIRST THE CONSOLE ID(XASCID) IS           Y02669* 00429303
*      AREA VALIDITY  INTERROGATED TO INSURE THAT IT IS DEFINED Y02669* 00430003
*      CHECKING       TO THE SYSTEM, ACTIVE, AND CAPABLE OF     Y02669* 00430403
*                     RECEIVING STATUS DISPLAYS. IF NOT, RETURN Y02669* 00430803
*                     CODE =12. THEN THE AREA ID(XASDID) IS     Y02669* 00431203
*                     CHECKED. IF IT IS NOT DEFINED TO THE      Y02669* 00432003
*                     CONSOLE RC = 16. IF IT CONTAINS A DYNAMIC Y02669* 00432403
*                     TRACK DISPLAY RC = 8. IF IT CONTAINS      Y02669* 00432803
*                     A STATUS DISPLAY RC = 4. IF IT IS         Y02669* 00433203
*                     AVAILABLE OR IF THE CONSOLE WAS NON-CRT,  Y02669* 00434003
*                     RC = 0.                                   Y02669* 00434403
*                                                                     * 00434803
*      INVALID        IF ANY COMMAND OTHER THAN THE ONES        Y02669* 00435203
*      COMMANDS       SPECIFIED IN THE FUNCTION SECTION ARE     Y02669* 00436003
*                     ENCOUNTERED, 'IEE305I COMMAND INVALID'    Y02669* 00436403
*                     IS ISSUED.                                Y02669* 00436803
*                                                                     * 00437203
*      JES3 VALIDITY  1. A JES3 CONSOLE CANNOT ISSUE A TRACK   @Y02668P 00438003
*      CHECKING          STOPTRACK OR K COMMAND (EXCEPT K C,D) @Y02668P 00438403
*                        TO ITSELF OR OTHER SUBSYSTEM CONSOLES @Y02668P 00438803
*                     2. SYSTEM COMMANDS CANNOT BE ROUTED TO   @Y02668P 00439203
*                        A SUBSYSTEM CONSOLE BY USING L=CCA    @Y02668P 00439603
*                                                                     * 00440103
*                                                                     * 00440603
* NOTES                                                         Y02669* 00441103
*                                                                     * 00441603
*    CHARACTER-CODE                                             Y02669* 00442403
*    DEPENDENCIES  =  ANY CHARACTER CODE OTHER THEN EBCDIC      Y02669* 00442803
*                     WILL REQUIRE REASSEMBLY OF THIS MODULE,   Y02669* 00443303
*                     PROVIDED THAT DECIMAL DIGITS CONTINUE     Y02669* 00443703
*                     TO BE REPRESENTED IN THE FORM X'FZ',      Y02669* 00444103
*                     WHERE 'Z' IS ANY HEXADECIMAL DIGIT.       Y02669* 00445003
*                     OTHERWISE, THE CODE WHICH VERIFIES THAT   Y02669* 00445403
*                     THE CONSOLE ID ON THE ROUTING OPERAND (L) Y02669* 00445803
*                     IS NUMERIC WILL HAVE TO BE CHANGED, TOO.  Y02669* 00446203
*                                                                     * 00446603
*    DEPENDENCIES  =  MSGRT COMMAND WILL PROVIDE DEFAULT        Y02669* 00447403
*                     ROUTING FOR D JOBS (J); A; TS AND         Y02669* 00447803
*                     TR JOBS (J); TS AND A. TR=A WILL BE USED  Y02669* 00448203
*                     FOR DEFAULT ROUTING ALL TRACK AND STOPTR  Y02669* 00449003
*                     COMMANDS.                                 Y02669* 00449403
*                                                                     * 00449803
*                     SVC 100 WILL REJECT AS INVALID FROM ANY   Y02669* 00450203
*                     TIME SHARING TERMINAL D A AND THE TRACK   Y02669* 00450603
*                     COMMANDS.                                 Y02669* 00451403
*                                                                     * 00451803
*                     DIDOCS WILL NOT PROCESS K D,H AND K D,U   Y02669* 00452203
*                     THE SAME FOR TRACKING AS FOR MONITORING.  Y02669* 00453003
*                     IN ADDITION, 2 WORDS WILL BE ADDED TO THE Y02669* 00453403
*                     SACB TO CONTAIN THE INDICATORS OF THE     Y02669* 00453803
*                     DESIRED TRACK FUNCTIONS FOR THAT CONSOLE  Y02669* 00454203
*                     AND THE TRACK ECB.                        Y02669* 00454603
*                     ALSO A BIT INDICATOR IS BEING ADDED TO    Y02669* 00455303
*                     THE DCM (DCMADFLG) TO INDICATE TO SVC 34  Y02669* 00456003
*                     THAT THIS IS A DIDOCS ISSUED TRACK IN     Y02669* 00456503
*                     RESPONSE TO A K D,U COMMAND.              Y02669* 00457003
*                     (TO BRING A TRACK DISPLAY OUT OF ITS HOLD Y02669* 00457503
*                     MODE, THE OPERATOR ISSUES A K D,U COMMAND Y02669* 00458003
*                     CAUSING DIDOCS TO ISSUE AN INTERNAL       Y02669* 00458503
*                     TRACK COMMAND.)                           Y02669* 00459003
*                                                                     * 00459503
*                     THE UCM, DCM, AND ASSOCIATED CONTROL      Y02669* 00460003
*                     BLOCKS WILL BE ALTERED TO REFLECT THE     Y02669* 00460503
*                     REPLACEMENT OF THE TRACK COMMAND FOR THE  Y02669* 00461003
*                     MONITOR ACTIVE COMMAND.                   Y02669* 00461503
*                                                                     * 00462003
*                     THE READER/INTERPRETER WILL REJECT THE    Y02669* 00462503
*                     TRACK COMMAND FROM THE INPUT STREAM.      Y02669* 00463003
*                                                                     * 00463503
*                     SVC 100 WILL REJECT AS INVALID ANY        Y02669* 00464003
*                     COMMAND WHICH IS NOT VALID FROM A TSO     Y02669* 00464503
*                     TERMINAL.                                 Y02669* 00465003
*                                                                     * 00465503
*                     JES2 WILL USE ENTRY POINT IEE7603D AND    Y02669* 00466003
*                     WILL SUPPLY THE ADDRESS OF A 134 BYTE     Y02669* 00466503
*                     XSA IN REGISTER 2. THE XSA WILL CONTAIN   Y02669* 00467003
*                     BINARY ZEROES EXCEPT FOR:                 Y02669* 00467503
*                           XAN    - X'22' VERBCODE             Y02669* 00468003
*                           XASCID - 1 BYTE BINARY CONSOLE ID   Y02669* 00468503
*                           XASDID - 1 BYTE CHARACTER AREA ID   Y02669* 00469003
*                     JES2 WILL BE IN KEY 0 AND THE XSA IN      Y02669* 00469503
*                     PAGABLE STORAGE.                          Y02669* 00470003
*                                                                     * 00470503
*                     UPON RETURN, REGISTER 15 WILL CONTAIN A   Y02669* 00471003
*                     RETURN CODE                               Y02669* 00471503
*                       0 - AREA IS AVAILABLE; CONSOLE IS       Y02669* 00472003
*                           NON-CRT                             Y02669* 00472503
*                       4 - AREA ALREADY CONTAINS A DISPLAY     Y02669* 00473003
*                       8 - AREA PRESENTLY CONTAINS A TRACK     Y02669* 00473503
*                           DISPLAY                             Y02669* 00474003
*                      12 - INVALID CONSOLE ID                  Y02669* 00474503
*                             CONSOLE NOT DEFINED               Y02669* 00475003
*                             CONSOLE NOT ACTIVE                Y02669* 00475503
*                             CONSOLE INCAPABLE OF RECEIVING    Y02669* 00476003
*                             STATUS DISPLAYS                   Y02669* 00476503
*                      16 - INVALID AREA ID                     Y02669* 00477003
*                     A WTO SHOULD NEVER BE ISSUED TO THE       Y02669* 00477503
*                     REQUESTED CONSOLE AND AREA IF THE         Y02669* 00478003
*                     RETURN CODES ARE 8, 12, 16. THE           Y02669* 00478503
*                     SUBSYSTEM SHOULD DECIDE IF IT IS          Y02669* 00479003
*                     DESIGNED TO OVERLAY THE EXISTING          Y02669* 00479503
*                     DISPLAY IN THE CASE OF RETURN CODE OF 4.  Y02669* 00480003
*                                                                     * 00480503
*    RESTRICTIONS  =  TRACK COMMANDS ARE INVALID FROM ANY       Y02669* 00481003
*                     TIME SHARING TERMINAL.                    Y02669* 00481503
*                                                                     * 00482003
*                     THE L=CCA OPERAND IS NOT VALID ON ANY     Y02669* 00482503
*                     COMMAND ISSUED FROM A TIME SHARING        Y02669* 00483003
*                     TERMINAL.                                 Y02669* 00483503
*                                                                     * 00484003
*                     THE TRACK COMMAND IS ONLY VALID FOR A     Y02669* 00484503
*                     TARGET CRT DEVICE.                        Y02669* 00485003
*                                                                     * 00485503
*                     CONTROL AND TRACK COMMAND ARE NOT VALID   Y02669* 00486003
*                     FROM THE INPUT STREAM.                    Y02669* 00486503
*                                                                     * 00487003
*                     ONLY K V CAN BE ROUTED TO A FULL          Y02669* 00487503
*                     CAPABILITY CONSOLE.                       Y02669* 00488003
*                                                                     * 00488503
*                     ANY TR, OR PT COMMAND ISSUED              YM1557* 00489003
*                     INTERNALLY MUST SPECIFY THE 'L' OPERAND.  YM1557* 00489503
*                     ANY DISPLAY COMMAND ISSUED INTERNALLY     YM1557* 00490003
*                     WILL BE ROUTED TO THE MASTER CONSOLE.     YM1557* 00490503
*                     ANY CONTROL COMMAND ISSUED INTERNALLY     YM1557* 00491003
*                     WILL RESULT IN A RETURN TO THE SYSTEM     YM1557* 00491503
*                     WITH NO MESSAGE ISSUED.                   YM1557* 00492003
*                                                                     * 00492503
*    REGISTER/                                                  Y02669* 00493003
*    CONVENTIONS   =  REGISTERS 0 - 14 SAVED IN XASAVSTD AND    Y02669* 00493503
*                     RESTORED FOR ALL JES2 REQUESTS.           Y02669* 00494003
*                                                                     * 00494503
*    PATCH-LABEL   =  PATCH                                     Y02669* 00495003
*                                                                     * 00495503
* MODULE TYPE      =  CSECT                                     Y02669* 00496003
*                                                                     * 00496503
*    PROCESSOR     =  N/A                                       Y02669* 00497003
*                                                                     * 00497503
*    MODULE SIZE   =  X'989'                                  @ZA29986* 00497600
*                                                                     * 00498503
*    ATTRIBUTES    =  REENTRANT, REFRESHABLE, KEY 0,            Y02669* 00499003
*                     SUPERVISOR MODE, PAGED LPA                Y02669* 00499503
*                                                                     * 00500002
* ENTRY POINT      =  IEE7503D FROM IEE0403D                    Y02669* 01950002
*    PURPOSE       =  TO PROCESS THE K AND STOPTR OPERANDS      Y02669* 01960002
*    LINKAGE       =  BRANCH                                    Y02669* 01970002
*    INPUT DATA    =  REGISTER 2 - POINTER TO THE XSA           Y02669* 01980002
*                        XAL - POINTS TO 1ST OPERAND IN BUFFER  Y02669* 01980402
*                        XAN - CONTAINS VERB CODE X'C8' STOPTR  Y02669* 01980802
*                                                 X'90' CONTROL Y02669* 01980902
*                        XAA - CONTAINS X'00' -INVALID FROM TSO Y02669* 01981202
*                        XAV - CONTAINS COMMAND VERB            Y02669* 01985902
*                        XAR - POINTS TO COMMAND BUFFER LENGTH  Y02669* 01987002
*                        XAU - CONTAINS REQUESTING CONSOLE ID   Y02669* 01988102
*                              (00-INTERNAL OR INPUT STREAM-K)  Y02669* 01988502
*                              (00-INTERNAL - STOPTR)           Y02669* 01988902
*                        XAP - POINTS TO END OF BUFFER +1       Y02669* 01989002
*                              ( FOR IEEBUFSC )                 Y02669* 01989102
*                                                                     * 01989202
* ENTRY POINT      =  IEE7503D FROM IEE3503D                    Y02669* 01991402
*    PURPOSE       =  TO PROCESS THE D AND TR OPERANDS          Y02669* 01992502
*    LINKAGE       =  BRANCH                                    Y02669* 01993602
*    INPUT DATA    =  REGISTER 2 - POINTER TO THE XSA           Y02669* 01994702
*                        XAL - POINTS TO 1ST OPERAND IN BUFFER  Y02669* 01995802
*                        XAN - CONTAINS VERB CODE               Y02669* 01996902
*                                X'2C' - DISPLAY C,K            Y02669* 01997302
*                                X'32' - DISPLAY M              Y02669* 01997802
*                                X'3E' - DISPLAY CONSOLES (C)   YM1916* 01998102
*                                X'42' - DISPLAY R              Y02669* 01998402
*                                X'52' - DISPLAY U              Y02669* 01998702
*                                X'F3' - DISPLAY 3850         @Z40LPTA* 01998841
*                                X'88' - DISPLAY DMN          @Z40BPSV* 01998941
*                                X'A8' - DISPLAY SLIP         @G17SPTJ* 01999041
*                                X'B0' - DISPLAY DUMP (D)     @G33CPMR* 01999133
*                                X'68' - D TS; JOBS (J); A      Y02669* 01999341
*                                X'C4' - TRACK                  Y02669* 01999541
*                        XAA - CONTAINS ASID (X'00'FOR TRACK    Y02669* 01999602
*                              AND D A AND U)                   Y02669* 01999802
*                        XAV - CONTAINS COMMAND VERB            Y02669* 02000002
*                        XAR - POINTS TO COMMAND BUFFER LENGTH  Y02669* 02000202
*                        XAU - CONTAINS REQUESTING CONSOLE ID   Y02669* 02001302
*                              (00-INTERNAL OR INPUT STREAM-D)  Y02669* 02001702
*                              (00-INTERNAL - TRACK)            Y02669* 02002102
*                        XAXMASK - CONTAINS AN INDICATOR        Y02669* 02002402
*                                  SPECIFYING THE DESIRED       Y02669* 02003502
*                                  DISPLAY OR TRACK FUNCTION:   Y02669* 02004602
*                                    X'80' FOR JOBS  (J)        Y02669* 02005702
*                                    X'08' FOR TS               Y02669* 02006702
*                                    X'88' FOR A                Y02669* 02007702
*                                    X'00' FOR ALL OTHER FNS    Y02669* 02010102
*                        XAP - POINTS TO END OF BUFFER +1       Y02669* 02010502
*                              ( FOR IEEBUFSC )                 Y02669* 02010902
*                                                                     * 02011002
* ENTRY POINT      =  IEE7603D FROM JES2                        Y02669* 02012202
*    PURPOSE       =  TO VERIFY THE ROUTING OPERAND 'L=CCA'     Y02669* 02016902
*                     FOR ALL JES2 ORIENTED COMMANDS            Y02669* 02017902
*    LINKAGE       =  BRANCH                                    Y02669* 02018902
*    INPUT DATA    =  REGISTER 2 - POINTER TO XSA               Y02669* 02021102
*                        XAN - CONTAINS VERB CODE X'22'         Y02669* 02022102
*                        XASCID - DESIRED TARGET CONSOLE ID     Y02669* 02023302
*                        XASDID - DESIRED AREA ID ON TARGET     Y02669* 02024402
*                        REST OF XSA ZEROES                     Y02669* 02025502
*                                                                     * 02026902
* REGISTERS USAGE                                               Y02669* 02028802
*    SAVED         =  REGISTER 14 SAVED BEFORE ISSUING IEEBUFSC Y02669* 02029802
*                                 RESTORED AT NOL               Y02669* 02030802
*                                             OPFOUND           Y02669* 02031802
*                                             ERRONL            Y02669* 02032802
*                     REGISTERS 11 - 14 SAVED BEFORE ISSUING    Y02651* 02034802
*                               SETLOCK AT LOCKSET AND LOCKSOFF Y02651* 02035802
*                  =  REGISTERS 0 - 14 SAVED IN XASAVSTD AT     Y02669* 02036802
*                               ENTRY POINT IEE7603D.           Y02669* 02037802
*                                                                     * 02038802
*    CONTAINED     =  R0  -  USED IN ODD EVEN PAIR              Y02669* 02040802
*                     R1  -  PARM REG FOR INTERNAL SUBROUTINES  Y02669* 02041802
*                     R2  -  INPUT - BASE REG FOR XSA           Y02669* 02042802
*                     R3  -  BASE REG FOR UCM                   Y02669* 02043802
*                     R4  -  USED IN ODD EVEN PAIR              Y02669* 02044802
*                     R5  -  USED IN ODD EVEN PAIR              Y02669* 02045802
*                     R6  -  TARGET AREA ID                     Y02669* 02046802
*                     R7  -  TARGET CONSOLE ID                  Y02669* 02048802
*                     R8  -  WORK REG - OPERAND POINTER         Y02669* 02049802
*                     R9  -  WORK REG - USED FOR RCT SCAN       Y02669* 02050802
*                     R10 -  BASE REG FOR RESIDENT DCM          Y02669* 02051802
*                     R11 -  BASE REG FOR RCT & SACB            Y02669* 02052802
*                     R12 -  BASE REG FOR UCME                  Y02669* 02053802
*                     R13 -  MODULE BASE REG                    Y02669* 02054802
*                     R14 -  RETURN ADDRESS                     Y02669* 02055802
*                     R15 -  USED FOR BAL,RETURN CODE                   02058802
*                                                                     * 02059402
*    RESTORED      =  REGISTERS 11 - 14 RESTORED AFTER ISSUING  Y02651* 02079702
*                               SETLOCK AT LOCKSET AND LOCKSOFF Y02651* 02084702
*                  =  REGISTER  0 - 14 RESTORED AT JES2EXIT     Y02669* 02085702
*                               BEFORE RETURNING TO JES2        Y02669* 02086702
*                                                                     * 02089702
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02099702
* NOTE: FOR ALL EXITS, IF THE 'L' OPERAND WAS SPECIFIED ON THE  Y02669* 02099802
*       COMMAND, IT WILL BE REMOVED FROM THE COMMAND BUFFER     Y02669* 02100002
*       BEFORE EXITING.                                         Y02669* 02160002
*       THE EXCEPTION, FOR N,PFK THE L= OPERAND IS PASSED TO  @ZA12152* 02180033
*       DIDOCS FOR PROCESSING.                                @ZA12152* 02190033
*                                                                     * 02220002
* EXIT - NORMAL    =  BRANCH TO IEE0803D FROM D0803D            Y02669* 02292402
*    CONDITIONS    =  TO BUILD CSCB'S FOR D COMMANDS            Y02669* 02292802
*    OUTPUT DATA   =  R2 POINTS TO XSA WHICH CONTAINS           Y02669* 02293202
*                        SAME AS INPUT PLUS                     Y02669* 02294002
*                        XASCID = 'CC' VALUE OR XAU             Y02669* 02296002
*                        XASDID = 'A' VALUE OR 'Z'              Y02669* 02296802
*                        XASSDS = XASSDS2 (X'40') IF 'L'        Y02669* 02297602
*                                 OPERAND SPECIFIED ON COMMAND  Y02669* 02298402
*                        XAN - CONTAINS VERB CODE               Y02669* 02299602
*                                 X'2C' - DISPLAY C,K           Y02669* 02299702
*                                 X'32' - DISPLAY M             Y02669* 02299902
*                                 X'3E' - DISPLAY CONSOLES (C)  YM1916* 02300802
*                                 X'52' - DISPLAY U             Y02669* 02301702
*                                 X'68' - D JOBS (J); TS; A     Y02669* 02302602
*                                 X'88' - DISPLAY DMN         @Z40BPSV* 02302941
*                                 X'A8' - DISPLAY SLIP        @G17SPTJ* 02303241
*                                 X'B0' - DISPLAY DUMP (D)    @G33CPMR* 02303333
*                     IF 'LIST' ('L') WAS SPECIFIED:            Y02669* 02303502
*                        XAXMASK  X'40' JOBS,LIST   (J,L)       Y02669* 02304402
*                                 X'04' TS,LIST     (TS,L)      Y02669* 02305302
*                                 X'44' A,LIST      (A,L)       Y02669* 02306202
*    RETURN CODES  =  NONE                                      Y02669* 02307602
* 2  CONDITIONS    =  TO BUILD CSCB'S FOR TR INITIAL COMMANDS   Y02669* 02309802
*    OUTPUT DATA   =  R2 POINTS TO XSA WHICH CONTAINS           Y02669* 02312002
*                        SAME AS INPUT PLUS                     Y02669* 02314202
*                        XASCID = 'CC' VALUE OR XAU             Y02669* 02316402
*                        XASDID = 'A' VALUE OR DEFAULT          Y02669* 02318602
*                        XASSDS = XASSDS2 (X'40') IF 'L'        Y02669* 02320802
*                                 OPERAND SPECIFIED ON COMMAND  Y02669* 02323002
*                        XAXSACB - CONTAINS ADDRESS OF DCMATECB Y02669* 02325002
*                        DCMAUTME - WILL BE SET TO THE DEFAULT  Y02669* 02336202
*                                   TIME INTERVAL - 30 SECONDS  Y02669* 02338202
*                     IF 'LIST' ('L') WAS SPECIFIED:            Y02669* 02342602
*                        DCMTMASK X'40' JOBS,LIST   (J,L)       Y02669* 02343602
*                                 X'04' TS,LIST     (TS,L)      Y02669* 02344602
*                                 X'44' A,LIST      (A,L)       Y02669* 02345602
*                                                                     * 02349102
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02351102
*                                                                     * 02351502
* EXIT - NORMAL    =  RETURN VIA BR R14 FROM RETURN             Y02669* 02352002
*    CONDITIONS    =  ADDITIONAL TRACK COMMAND ISSUED FOR       Y02669* 02352402
*                     ALREADY EXISTING TRACK TASK               Y02669* 02352602
*    OUTPUT DATA   =  SACB FIELDS UPDATE                        Y02669* 02353202
*    RETURN CODES  =  NONE                                      Y02669* 02353402
*                                                                     * 02353602
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02353802
*                                                                     * 02355202
* EXIT - NORMAL    =  BRANCH TO IEE5503D FROM D5503D            Y02669* 02357602
*    CONDITIONS    =  TO PROCESS THE PT COMMAND                 Y02669* 02360002
*    OUTPUT DATA   =  R2 POINTS TO XSA WHICH CONTAINS           Y02669* 02362402
*                      SAME AS INPUT PLUS                       Y02669* 02364802
*                      XAXSACB CONTAINS ADDRESS OF SACB         Y02669* 02367202
*                      XAS CONTAINS TARGET CONSOLE & AREA ID    Y02669* 02369602
*                        XASCID = 'CC' VALUE OR XAU             Y02669* 02372002
*                        XASDID = 'A' VALUE OR DEFAULT          Y02669* 02374402
*                        XASSDS = XASSDS2 (X'40') IF 'L'        Y02669* 02376802
*                                 OPERAND SPECIFIED ON COMMAND  Y02669* 02379202
*    RETURN CODES  =  NONE                                      Y02669* 02381602
*                                                                     * 02384002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02386402
*                                                                     * 02388802
* EXIT - NORMAL    =  BRANCH TO IEE6703D FROM D6703D            Y02669* 02391202
*    CONDITIONS    =  FOR ALL K COMMANDS                        Y02669* 02393602
*    OUTPUT DATA   =  REG 2 POINTS TO XSA WHICH CONTAINS        Y02669* 02396002
*                      SAME AS INPUT PLUS                       Y02669* 02398402
*                      XAS CONTAINS TARGET CONSOLE & AREA ID    Y02669* 02400802
*                        XASCID = 'CC' VALUE OR XAU             Y02669* 02403202
*                        XASDID = 'A' VALUE OR 'Z'              Y02669* 02405602
*                        XASSDS = XASSDS2 (X'40') IF 'L'        Y02669* 02408002
*                                 OPERAND SPECIFIED ON COMMAND  Y02669* 02410402
*                        XASSDS = XASSDS3 IF A TASK OTHER     @Y02668P* 02411003
*                                 THAN COMTASK ISSUED THE     @Y02668P* 02411603
*                                 COMMAND (JES3)              @Y02668P* 02412203
*    RETURN CODES  =  NONE                                      Y02669* 02412802
*                                                                     * 02422802
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02424802
*                                                                     * 02446802
* EXIT - NORMAL    =  BRANCH TO IEE2903D FROM D2903D            Y02669* 02447502
*    CONDITIONS    =  FOR DISPLAY REQUESTS                      Y02669* 02449602
*    OUTPUT DATA   =  REG 2 POINTS TO XSA WHICH CONTAINS        Y02669* 02451702
*                      SAME AS INPUT PLUS                       Y02669* 02453802
*                      XAS CONTAINS TARGET CONSOLE & AREA ID    Y02669* 02455902
*                        XASCID = 'CC' VALUE OR XAU             Y02669* 02458002
*                        XASDID = 'A' VALUE OR 'Z'              Y02669* 02460102
*                        XASSDS = XASSDS2 (X'40') IF 'L'        Y02669* 02462202
*                                 OPERAND SPECIFIED ON COMMAND  Y02669* 02464302
*    RETURN CODES  =  NONE                                      Y02669* 02466402
*                                                                     * 02468502
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02469502
*                                                                     * 02470602
** EXIT - NORMAL   =  RETURN VIA BR R14 TO JES2 FROM JES2EXIT   Y02669* 02476902
*     CONDITIONS   =  DESIRED ROUTING REQUEST VALIDITY CHECKED  Y02669* 02477602
*     OUTPUT DATA  =  REGISTER 2 STILL POINTS TO XSA            Y02669* 02478302
*     RETURN CODES =  REGISTER 15 CONTAINS                      Y02669* 02479002
*                        0 IF CONSOLE AND AREA IDS WERE VALID   Y02669* 02479702
*                        4 IF THE AREA PRESENTLY CONTAINS       Y02669* 02480402
*                          ANOTHER DISPLAY                      Y02669* 02481102
*                        8 IF THE AREA PRESENTLY CONTAINS A     Y02669* 02481802
*                          TRACK DISPLAY                        Y02669* 02483202
*                       12 IF THE CONSOLE ID IS INVALID         Y02669* 02483402
*                                 CONSOLE ID TOO HIGH           Y02669* 02483602
*                                 CONSOLE NOT ACTIVE            Y02669* 02483802
*                                 CONSOLE FULL CAPABILITY       Y02669* 02484002
*                       16 IF THE AREA ID IS INVALID            Y02669* 02484202
*                                                                     * 02484702
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02485302
*                                                                     * 02490302
* EXIT - NORMAL     =  BRANCH TO IEE9403D FROM D9403D          @Z40LPTA 02490704
*    CONDITIONS     =  FOR DISPLAY 3850 REQUEST                @Z40LPTA 02491104
*    OUTPUT DATA    =  R2 PTR TO XSA WHICH CONTAINS            @Z40LPTA 02491504
*                         SAME AS INPUT PLUS                   @Z40LPTA 02491904
*                         XASCID = 'CC' VALUE OR XAU           @Z40LPTA 02492304
*                         XASDID = 'A' VALUE OR 'Z'            @Z40LPTA 02492704
*                         XAN    = (X'68') DISPLAY VERB CODE   @Z40LPTA 02493104
*    RETURN CODES    =  NONE.                                  @Z40LPTA 02493504
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02493904
*                                                                     * 02494304
** EXIT - ERROR  = BRANCH TO IEE0503D FROM D0503D               Y02669* 02495302
*   CONDITIONS   = TO ISSUE MESSAGE 'IEE305I COMMAND INVALID',  Y02669* 02500302
*                  IF AN INVALID COMMAND IS ENCOUNTERED, OR     Y02669* 02505302
*                  IF TSO ISSUES ANY COMMAND OTHER THAN DISPLAY Y02669* 02510302
*                   OR INCLUDES THE 'L' OPERAND ON ANY COMMAND  Y02669* 02515302
*                  IF THE STOP TRACK COMMAND DOES NOT          @YM2774P 02520302
*                   HAVE ANY OPERANDS THEN ISSUE MESSAGE       @YM2774P 02540302
*                   'IEE311I PARAMETER MISSING'                @YM2774P 02560302
*                   TRACK, STOP TRACK, AND K COMMAND           @Y02668P 02565303
*                   (EXCEPT K C, D) ARE INVALID                @Y02668P 02570303
*                   FROM A SUBSYSTEM CONSOLE.                  @Y02668P 02575303
*   OUTPUT DATA  = ERROR CODES FOR MESSAGE ISSUED IN IEE0503D   Y02669* 02585302
*                  IN XSA POINTED TO BY REG 2                   Y02669* 02635302
*                  XAE WILL CONTAIN  X'05' FOR IEE305I          Y02669* 02685302
*                                    X'0B' FOR IEE311I          YM1917* 02735302
*                                    X'15' FPR IEE777I         @Y02668P 02755303
*                  XAV STILL CONTAINS COMMAND VERB FOR MESSAGE  Y02669* 02785302
*   RETURN CODES = NONE                                         Y02669* 02835302
*                                                                     * 02885302
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02935302
*                                                                     * 02985302
* EXIT - ERROR     =  BRANCH TO IEE5603D FROM D5603D            Y02669* 03100002
*    CONDITIONS    =  ANY ERROR CONDITIONS REQUIRING A MESSAGE  Y02669* 03160002
*    OUTPUT DATA   =  REG 2 POINTS TO XSA CONTAINING ERROR      Y02669* 03162002
*                     CODES FOR IEE5603D AND IEE5903D.          Y02669* 03164002
*                     XAE WILL CONTAIN AN INDEX FOR THE         Y02669* 03166002
*                     MAJOR MESSAGE FOR IEE5603D:               Y02669* 03168002
*                        X'04' - IEE156I INVALID OPERAND        Y02669* 03169202
*                        X'08' - IEE345I CM AUTHORITY INVALID   Y02669* 03169602
*                        X'09' - IEE921I CM OP REJECTED         Y02669* 03169702
*                        X'0B' - IEE925I 'CMD' OPERAND          Y02669* 03169802
*                        X'0C' - IEE926I L=CCA OPERAND INVALID  Y02669* 03169902
*                        X'0D' - IEE927I REQUEST AMBIGIOUS      YM1557* 03171902
*                     XASTSAVE WILL CONTAIN AN INDEX FOR THE    Y02669* 03176002
*                     MINOR MESSAGE FOR IEE5903D:               Y02669* 03176402
*                      IEE921I CM OP REJECTED:                  Y02669* 03178402
*                        X'0C' - DISPLAY ALREADY EXISTS         Y02669* 03186402
*                        X'0D' - DISPLAY AREA BUSY              Y02669* 03196402
*                        X'0E' - NO TRACK TO STOP               Y02669* 03200402
*                        X'19' - NEEDS DISPLAY AREA             Y02669* 03202402
*                        X'1F' - SUBSYSTEM CONSOLE             @Y02668P 03202503
*                      IEE925I 'XAE' OPERAND:                   Y02669* 03207303
*                        X'1A' - FOR CRT ONLY                   Y02669* 03207703
*                      IEE926I L=CCA OPERAND INVALID:           Y02669* 03211303
*                        X'12' - NOT AN AREA                    Y02669* 03213303
*                        X'13' - NOT A CONSOLE                  Y02669* 03215303
*                        X'14' - FULL CAPABILITY                Y02669* 03217303
*                        X'15' - DYNAMIC DISPLAY IN AREA        Y02669* 03219303
*                        X'1F' - SUBSYSTEM CONSOLE             @Y02668P 03221303
*                      IEE927I REQUEST AMBIGIOUS                YM1557* 03223303
*                        X'17' - SPECIFY L OPERAND              YM1557* 03225303
*                     XAV STILL CONTAINS COMMAND VERB FOR THE   Y02669* 03227303
*                     MESSAGE                                   Y02669* 03229303
*                     XAU CONTAINS CONSOLE ID FOR MESSAGE       Y02669* 03231303
*                     ROUTING (MAY BE X'00' IF INTERNAL)        YM1557* 03233303
*    RETURN CODES  =  NONE                                      Y02669* 03241402
*                                                                     * 03300002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03380202
*                                                                     * 03390102
* EXTERNAL                                                      Y02669* 03400002
*   REFERENCES                                                  Y02669* 03450002
*                                                                     * 03550002
*    ROUTINES      =  BRANCHES TO  IEE6703D   IEE0803D          Y02669* 04399102
*                                  IEE5503D   IEE5603D/IEE5903D Y02669* 04399502
*                                  IEE0503D   IEE2903D          Y02669* 04399902
*                                  IEE9403D                    @Z40LPTA 04400704
*                                                                     * 04401602
*   DATA AREAS   = PSEUDO-SACB TO BE USED THROUGHOUT SVC 34     Y02669* 04403202
*                    ORG   XAX                                  Y02669* 04403302
*                  XAXMASK  DS    C       REQUEST FLAGS         Y02669* 04403402
*                  XAXJOBS  EQU   X'80'   JOBS        (J)       Y02669* 04404502
*                  XAXJOBSL EQU   X'40'   JOBS,LIST   (J,L)     Y02669* 04405502
*                  XAXTS    EQU   X'08'   TS                    Y02669* 04407702
*                  XAXTSL   EQU   X'04'   TS,LIST     (TS,L)    Y02669* 04408102
*                  XAXA     EQU   X'88'   A                     Y02669* 04409102
*                  XAXAL    EQU   X'44'   A,LIST      (A,L)     Y02669* 04410102
*                  XAXFREE  DS    C       RESERVED              Y02669* 04412002
*                  XAXUTME  DS    H       TIME INTERVAL VALUE   Y02669* 04412802
*                  XAXSACB  DS    F       ADDRESS OF SACB       Y02669* 04413602
*                                                                     * 04414402
*   DATA AREAS  =  SACB (SCREEN AREA CONTORL BLOCK)             Y02669* 04415202
*                  DCMADFLG  DS   C       STATUS INDICATORS     Y02669* 04415602
*                  DCMADD    EQU  X'80'   TRACK ACTIVE IN AREA  Y02669* 04415702
*                  DCMAHOLD  EQU  X'40'   TRACK DISPLAY HELD    Y02669* 04415802
*                  DCMATRCK  DS   C       REQUEST INDICATORS    Y02669* 04416002
*                  DCMATJOB  EQU  X'80'   JOBS        (J)       Y02669* 04416802
*                  DCMATJBL  EQU  X'40'   JOBS,LIST   (J,L)     Y02669* 04417802
*                  DCMATTS   EQU  X'08'   TS                    Y02669* 04420002
*                  DCMATTSL  EQU  X'04'   TS,LIST     (TS,L)    Y02669* 04420802
*                  DCMATA    EQU  X'88'   A                     Y02669* 04421602
*                  DCMATAL   EQU  X'44'   A,LIST      (A,L)     Y02669* 04422402
*                  DCMTUTME  DS   H       TIME INTERVAL VALUE   Y02669* 04422802
*                  DCMATECB  DS   F       TRACK ECB             Y02669* 04423402
*                                                                     * 04427202
*    CONTROL BLOCKS=  CVT           R - ADDRESS UCM & BASEA     Y02669* 04428002
*                     IEEXSA        R - INPUT INFORMATION       Y02669* 04429602
*                                   W - OUTPUT INFORMATION      Y02669* 04430402
*                     IEECUCM       R - ADDRESS DCM, RCT        Y02669* 04431202
*                                       DEVICE STATUS           Y02669* 04432002
*                     IEECVMAP (RCT) R - ROUTING DEFAULTS       Y02669* 04432402
*                     IEERDCM       R - ADDRESS SACB            Y02669* 04432802
*                     SACB          R - PRESENT TRACK STATUS    Y02669* 04434402
*                                   W - UPDATE OR INIT STATUS   Y02669* 04435202
*                                       FOR TRACK ONLY          Y02669* 04436002
*                     IHAPSA          - NECESSARY FOR SETLOCK   Y02651* 04436802
*                                                                     * 04437602
*    TABLES        =  NONE                                      Y02669* 04438402
*                                                                     * 04439202
*    MACROS        =  MODID                                     Y02669* 04440002
*                     IEEBUFSC                                  Y02669* 04440802
*                                                                     * 04441602
*    ENQUEUE                                                    Y02669* 04442402
*     RESOURCES    =  NONE                                      Y02669* 04443202
*                                                                     * 04444002
*    LOCKS HELD    =  LOCKS ARE OBTAINED AT LOCKSET AND         Y02651* 04444802
*                     RELEASED:                                 Y02651* 04445402
*                      1) AT RETURN BEFORE RETURNING            Y02651* 04446002
*                      2) AT D0503D BEFORE EXITING TO IEE0503D  Y02651* 04446602
*                      3) AT D0803D BEFORE EXITING TO IEE0803D  Y02651* 04447202
*                      4) AT JES2EXIT BEFORE RETURNING TO JES2  Y02669* 04447502
*                      5) FOR STOPTR IN IEE5503D OR IEE6703D    Y02651* 04447802
*                      6) FOR K IN IEE6703D, IEE7703D, IEE7803D Y02651* 04448402
*                        IEE6803D, IEE6903D, IEE5603D, IEE5903D Y02651* 04449002
*                                                                     * 04449602
*    CHANGE LEVEL  =  Y02669                                    Y02669* 04450402
*                     Y02651                                    Y02651* 04450602
*                     YM1557                                    YM1557* 04450802
*                     YM1916                                    YM1916* 04450902
*                     YM1917                                    YM1917* 04451002
*                     YM1920                                    YM1920* 04451102
*                     Y02668                                   @Y02668P 04455103
*                     ZM30445                                  @ZM30445 04457103
*                     ZM30446                                  @ZM30446 04458103
*                     ZA02576                                  @ZA02576 04459003
*                     ZA03611                                  @ZA03611 04459504
*                     Z40LPTA                                  @Z40LPTA 04459604
*                     Z40BPSV                                 @Z40BPSV* 04459741
*                     G17SPTJ                                 @G17SPTJ* 04459841
*                     ZA10516                                 @ZA10516* 04460441
*                     ZA12152                                 @ZA12152* 04460633
*                     G33CPMR                                 @G33CPMR* 04460933
*                     ZA16595                                 @ZA16595* 04461233
*                     ZA29986                                 @ZA29986* 04461300
*                                                                     * 04461541
* MESSAGES         =  THE FOLLOWING MESSAGE IS CONTAINED IN     Y02669* 04462002
*                     AND ISSUED FROM IEE0503D:                 Y02669* 04464002
*                                                                     * 04468002
*                      MSGID  CODE     MESSAGE TEXT             Y02669* 04474002
*                      _____  ____     ____________             Y02669* 04476002
*                     IEE305I X'05'    COMMAND INVALID          Y02669* 04478002
*                     IEE311I X'0B'    PARAMETER MISSING        YM1917* 04482002
*                                                                     * 04486602
*                     THE FOLLOWING MESSAGES ARE CONTAINED IN   Y02669* 04489602
*                     AND ISSUED FROM IEE5603D AND IEE5903D:    Y02669* 04492602
*                                                                     * 04495602
*                      MSGID  CODE  IN MESSAGE TEXT             Y02669* 04498602
*                      _____  ____  __  ____________            Y02669* 04504602
*                     IEE156I X'04' 56 INVALID OPERAND          Y02669* 04507602
*                     IEE345I X'08' 56 AUTHORITY INVALID        Y02669* 04510602
*                     IEE921I X'09' 56 REJECTED                 Y02669* 04513602
*                             X'0C' 59 DISPLAY ALREADY EXISTS   Y02669* 04516602
*                             X'0D' 59 DISPLAY AREA BUSY        Y02669* 04522602
*                             X'0E' 59 NO TRACK TO STOP         Y02669* 04525602
*                             X'19' 59 NEEDS DISPLAY AREA       Y02669* 04528602
*                             X'1F' - SUBSYSTEM CONSOLE        @Y02668P 04530603
*                     IEE925I X'0B' 56 OPERAND                  Y02669* 04532602
*                             X'1A' 59 FOR CRT ONLY             Y02669* 04536602
*                     IEE926I X'0C' 56 L OPERAND INVALID        Y02669* 04539602
*                             X'12' 59 NOT AN AREA              Y02669* 04542602
*                             X'13' 59 NOT A CONSOLE            Y02669* 04545602
*                             X'14' 59 FULL CAPABILITY          Y02669* 04548602
*                             X'15' 59 DYNAMIC DISPLAY IN AREA  Y02669* 04551602
*                             X'1F' 59 SUBSYSTEM CONSOLE       @Y02668P 04552603
*                                                                     * 04554602
* SYSGEN           =  INCLUDED WITH SVC 34 IN LOAD MODULE       Y02669* 04557602
*                     IGC0003D, DLIB AOSB3, MACRO SGIEF441,     Y02669* 04560602
*                     TARGLIB LPALIB                            Y02669* 04563602
*                                                                     * 04566602
* SYSTEM LIBRARIES =  NONE                                      Y02669* 04569602
*                                                                     * 04572602
*********************************************************************** 04575602
         EJECT                                                          04578602
IEE7503D CSECT                                                   Y02669 04581602
         ENTRY IEE7603D            ENTRY POINT FOR JES2 ONLY     Y02669 04583602
IEE7603D EQU   *                                                 Y02669 04585602
* A-190710,190726,190741 C- 190740,190744                      @ZM30445 04586203
* C- 461000 D - 539043-539122                                  @ZM30446 04586903
* A-208600                                                     @ZA02576 04587203
* THIS APAR WRITTEN TO SUPPORT MSS 'D 3850' S/C Z40LPTA        @ZA07152 04589041
* A - CODE ADDED TO SUPPORT 'DISPLAY DUMP'                     @G33CPMR 04589433
* A (COMTASK ) APPROX. 111724                                  @ZA12152 04589533
* A (KNOL    ) APPROX. 187600                                  @ZA12152 04589633
* A (NCCHAR  ) APPROX. 602920                                  @ZA12152 04589733
* C (ERRONL  ) ADD LABEL LFIRST                                @ZA16595 04590033
* C (NEXTAREA) TEST FOR POSSIBLE GENED AREAS NOT IN USE        @ZA29986 04590100
*                                                                       04590333
* ********************************************************************* 04590433
*                                                                     * 04590602
*                                REGISTER USAGE                       * 04600002
*                                                                     * 04998802
*********************************************************************** 05048802
REG0     EQU   0                   USED WITH REG1 AS EVEN/ODD PAIR      05148202
REG1     EQU   1                   PARM REG FOR INTERNAL SUBROUTINES    05200002
*                                  USED WITH REG0 AS EVEN/ODD PAIR      05400002
XSABASE  EQU   2                   INPUT-BASE REGISTER FOR XSA          05500002
UCMBASE  EQU   3                   BASE REGISTER FOR UCM                05600002
WORK4    EQU   4                   WORK REG, PART OF EVEN/ODD PAIR      06000002
WORK5    EQU   5                   WORK REG, PART OF EVEN/ODD PAIR      06100002
AREA     EQU   6                   TARGET AREA ID                       06500002
CONSID   EQU   7                   TARGET CONSOLE ID                    06600002
OPPTR    EQU   8                   POINTS WITHIN COMMAND OPERAND FIELD  06700002
RCTSCAN  EQU   9                   WORK REG FOR RCT SCAN                06900001
RDCMBASE EQU   10                  BASE REGISTER FOR RESIDENT DCM       07000002
RCTBASE  EQU   11                  BASE ROUTING CONTROL TABLE           07100002
SACBBASE EQU   11                  BASE SCREEN AREA CONTROL BLOCK       07300002
UCMEBASE EQU   12                  BASE REG - UCME (SOURCE THEN TARGET) 07500002
MYBASE   EQU   13                  BASE REGISTER FOR THIS ROUTINE       07700002
RETURN14 EQU   14                  RETURN REGISTER               Y02669 07800002
R15      EQU   15                                                       08050002
         EJECT                                                          08060002
*********************************************************************** 08070002
*                                                                     * 08080002
*                           CONSTANTS                                 * 08090002
*                                                                     * 08092002
*********************************************************************** 08094002
E0       EQU   0                   CONSTANT                             08098002
E1       EQU   1                   CONSTANT                             08098402
E2       EQU   2                   CONSTANT                             08098802
E3       EQU   3                   CONSTANT                             08099202
E4       EQU   4                   CONSTANT                             08099602
E5       EQU   5                   CONSTANT                      Y02669 08100602
E6       EQU   6                   CONSTANT                      Y02669 08101902
E7       EQU   7                   CONSTANT - MASK FOR ICM INSTRUCTION  08107102
E8       EQU   8                   CONSTANT - MASK FOR ICM INSTRUCTION  08109402
*********************************************************************** 08111702
*                                                                     * 08114002
*                         CHARACTER EQUATES                           * 08116302
*                                                                     * 08118602
*********************************************************************** 08120902
BLANK    EQU   C' '                BLANK                                08123202
COMMA    EQU   C','                COMMA                                08125502
ACHAR    EQU   C'A'                CHARACTER A FOR COMPARE       Y02669 08127502
CCHAR    EQU   C'C'                CHARACTER C FOR COMPARE       Y02669 08127802
DCHAR    EQU   C'D'                CHARACTER D FOR COMPARE              08129802
KCHAR    EQU   C'K'                CHARACTER K FOR COMPARE              08130102
OCHAR    EQU   C'O'                CHARACTER O FOR COMPARE              08132402
PCHAR    EQU   C'P'                CHARACTER P FOR COMPARE     @G33CPMR 08133433
VCHAR    EQU   C'V'                CHARACTER V                   Y02669 08134702
TCHAR    EQU   C'T'                CHARACTER T                   Y02669 08136702
Z        EQU   C'Z'                ID OF MESSAGE STREAM AREA (INLINE)   08137002
*********************************************************************** 08171202
*                     BRANCH CONDITION CODES                          * 08173302
*********************************************************************** 08188902
NOMORE   EQU   8                   BRANCH ON ZERO                       08193602
EQ       EQU   8                   BRANCH ON EQUAL                      08198302
NONEON   EQU   8                   BRANCH ON ZERO                       08203002
*********************************************************************** 08212402
*                                                                     * 08217102
*                         VERB CODES                                  * 08221802
*                                                                     * 08226502
*********************************************************************** 08231202
K        EQU   X'90'               VERB CODE FOR K (CONTROL)            08235902
D        EQU   X'68'               VERB CODE FOR D (DISPLAY)            08240602
DR       EQU   X'42'               VERB CODE FOR D R             Y02669 08242602
DU       EQU   X'52'               VERB CODE FOR D U             Y02669 08245302
D38      EQU   X'F3'               VERB CODE FOR D 3850        @Z40LPTA 08247304
TR       EQU   X'C4'               VERB CODE FOR TR (TRACK)      Y02669 08250002
PT       EQU   X'C8'               VERB CODE FOR PT (STOPTR)     Y02669 08300002
JES2     EQU   34                  VERB CODE FOR JES2            Y02669 08305002
NULL     EQU   X'00'               CODE INDICATES NO AREA SPECIFIED     08310402
*                                  OR DEFAULT PROVIDED BY MSGRT         08310802
F0       EQU   X'F0'               MASK FOR DETERMINING NUMERICS        08311702
C0       EQU   X'C0'               MASK FOR DETERMINING LETTERS  Y02669 08311802
DBLWORD  EQU   8                   LENGTH OF A DOUBLE WORD              08311902
PTRCVT   EQU   16                  LOCATION OF POINTER TO CVT           08312002
ASTRICK  EQU   X'5C'               SPECIAL AREA FILLER         @Z40LPTA 08313004
XFF      EQU   X'FF'               MASK FOR NI                   Y02651 08314002
         EJECT                                                          08322002
*********************************************************************** 08348102
*                                                                     * 08348202
*                     ERROR MESSAGE CODES                             * 08348402
*                                                                     * 08348502
*********************************************************************** 08349402
MSG156   EQU   04                  IEE156I CM INVALID OPERAND -  Y02669 08353202
MSG305   EQU   05                  IEE305I CM COMMAND INVALID    Y02669 08353602
MSG311   EQU   11                  IEE311I PARAMETER MISSING     YM1917 08354002
MSG345   EQU   08                  IEE345I CM AUTHORITY INVALID  Y02669 08354402
MSG921   EQU   09                  IEE921I CM OP REJECTED        Y02669 08355602
MSG921A  EQU   12                       DISPLAY ALREADY EXISTS   Y02669 08356802
MSG921B  EQU   13                       DISPLAY AREA BUSY        Y02669 08358002
MSG921C  EQU   14                       NO TRACK TO STOP         Y02669 08359202
MSG921D  EQU   25                       NEEDS DISPLAY AREA       Y02669 08360402
MSG921E  EQU   31                       SUBSYSTEM CONSOLE      @Y02668P 08360603
MSG925   EQU   11                  IEE925I 'COMMAND' OPERAND     Y02669 08360802
MSG925A  EQU   26                       FOR CRT ONLY             Y02669 08361202
MSG926   EQU   12                  IEE926I L=CCA OPERAND INVALID Y02669 08361602
MSG926A  EQU   18                       CCA NOT AN AREA          Y02669 08362802
MSG926B  EQU   19                       CC NOT A CONSOLE         Y02669 08364002
MSG926C  EQU   20                       CC FULL CAPABILITY       Y02669 08365202
MSG926D  EQU   21                       DYNAMIC DISPLAY IN AREA  Y02669 08366402
MSG926E  EQU   31                       SUBSYSTEM CONSOLE      @Y02668P 08366603
MSG927   EQU   13                  IEE927I REQUEST AMBIGIOUS     YM1557 08366802
MSG927A  EQU   23                       SPECIFY L OPERAND        YM1557 08367202
*********************************************************************** 08368802
*                                                                     * 08370002
*                 JES2 INTERFACE RETURN CODES                    Y02669 08371002
*                                                                     * 08372002
*********************************************************************** 08373002
OKCCA    EQU   0                   0 - VALID ROUTING REQUEST     Y02669 08373202
AREANUSE EQU   4                   4 - ANOTHER DISPLAY IN AREA   Y02669 08373402
TRINAREA EQU   8                   8 - TRACK DISPLAY IN AREA     Y02669 08373602
BADCONSL EQU   12                  12 - INVALID CONSOLE ID       Y02669 08374002
*                                       CONSOLE ID TOO HIGH      Y02669 08375002
*                                       CONSOLE NOT ACTIVE       Y02669 08376002
*                                       CONSOLE FULL CAPABILITY  Y02669 08377002
BADAREA  EQU   16                  16 - INVALID AREA REQUEST     Y02669 08380002
         EJECT                                                          08385002
*********************************************************************** 08390002
*                                                                     * 08398002
*                ESTABLISH ADDRESSABILITY                             * 08406002
*                REGISTER 2 POINTS TO XSA                             * 08414002
*                INITIALIZE ROUTING FIELD (XAS) TO ZEROES             * 08422002
*                OBTAIN THE LOCAL AND CMS LOCKS                       * 08430002
* NOTE: IF REQUEST FROM JES2 BRANCH TO SPECIAL CODE AT JES2CODE       * 08438002
*********************************************************************** 08446002
         USING DXSA,XSABASE        BASE XSA                      Y02669 08454002
         STM   REG0,RETURN14,XASAVSTD   SAVE REGISTERS FOR JES2  Y02669 08462002
         SPACE                                                          08478002
         BALR  MYBASE,0                                                 08486002
         USING *,MYBASE            BASE THIS MODULE                     08500001
         MODID BRANCH=YES                                        Y01886 08550001
         L     WORK4,PTRCVT        GET CVT POINTER               Y02669 09200002
         USING DCVT,WORK4          BASE CVT                      Y02669 09300002
         L     WORK5,CVTTCBP       SET TCB POINTER             @Y02668P 09350003
         L     UCMBASE,CVTCUCB     GET UCM POINTER                      09400001
         DROP  WORK4                                             Y02669 09450002
         USING TCBASCB,WORK5       BASE IEFPTRS                @Y02668P 09458003
         L     WORK4,TCBPTR        CURRENT TCB ADDRESS,SAVE    @Y02668P 09466003
*                                  WORK4 UNTIL AFTER THE TCB   @Y02668P 09474003
*                                  IS IDENTIFIED               @Y02668P 09482003
         DROP  WORK5                                                    09490003
         USING UCM,UCMBASE         BASE UCM                      Y02669 09500002
         USING UCMLIST,UCMEBASE    BASE UCM ENTRY                       09600001
         USING DCMTSRT,RDCMBASE    BASE RESIDENT DCM             Y02669 09700002
         USING DRCT,RCTBASE        BASE ROUTING CONTROL TABLE           09800001
         SPACE 2                                                        10610002
LOCKSET  EQU   *                                                 Y02651 10650002
         STM   RCTBASE,RETURN14,XASAVLOC                         Y02651 10700002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(K,TR,D,PT,     *10750002
               LOCKSOFF,IEE5503D,5603D,5903D,6703D,6803D,6903D,7703D,  *10800002
               7803D)                                                   10810002
         SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,RELATED=(K,TR,D,PT,       *10850002
               LOCKSOFF,IEE5503D,5603D,5903D,6703D,6803D,6903D,7703D,  *10900002
               7803D)                                                   10950002
         LM    RCTBASE,RETURN14,XASAVLOC                         Y02651 11000002
         CLI   XAN,JES2                 REQUEST FROM JES2?     @YM4796P 11002602
         BE    JES2CODE                 YES,BR TO  JES2 CODE   @YM4796P 11002902
         XC    XAS(DBLWORD),XAS         ZERO OUT XAS           @YM2773P 11003202
         OI    XASSDS,XASSDS5           INDICATE LOCKS HELD    @YM2773P 11003502
         C     WORK4,UCMPXA        CURRENT TCB = COMTASK?      @Y02668P 11003703
         BE    COMTASK             YES,BRANCH                  @Y02668P 11009703
         OI    XASSDS,XASSDS3      NO,ANOTHER TASK ISSUE CMD   @Y02668P 11015703
COMTASK  EQU   *                                                        11024003
         EJECT                                                          11034003
*********************************************************************** 11044002
*                                                                     * 11044402
*     INVOKE IEEBUFSC TO SCAN THE OPERAND BUFFER POINTED TO BY XAL    * 11044802
*     FOR THE L= OPERAND AND RETURN THE ADDRESS OF THE 'CCA' VALUE    * 11044902
*     AND ITS LENGTH.                                                 * 11047602
*                                                                     * 11053102
*     OPERATION  1. SET UP PTR TO BUFFER -1 AND PTR TO KEYWORD LENGTH * 11055502
*                2. IF BUFFER PTR = SPECIFIED KEYWORD GOTO (3).       * 11057902
*                   A. IF NOT, INCREMENT BUFFER PTR BY ONE.           * 11067902
*                   B. IF PTR IS AT END OF BUFFER SET UP NOT FOUND    * 11069902
*                      RETURN CODE (8) IN R15 AND EXIT.               * 11073902
*                   C. IF PTR IS AT A COMMA, GO BACK TO OPERATION 2.  * 11075902
*                   D. IF PTR IS AT A BLANK SET UP NOT FOUND RETURN   * 11077902
*                      CODE (8) IN R15 AND EXIT.                      * 11081902
*                   E. OTHERWISE GO TO OPERATION 2.A.                 * 11083902
*                3. AT FOUND ROUTINE SET UP R14 TO POINT TO KEYWORD   * 11085902
*                   VALUE                                             * 11088702
*                4. SCAN KEYWORD VALUE TO THE END OF THE BUFFER, A    * 11090702
*                   COMMA OR A BLANK                                  * 11092702
*                5. CALCULATE LENGTH OF KEYWORD VALUE.                * 11093102
*                6. IF LENGTH IS < OR = ZERO, SET UP AN INVALID KEYWORD 11093502
*                   VALUE LENGTH RETURN CODE (4) IN R15 AND EXIT.     * 11093902
*                7. OTHERWISE, SET GOOD RETURN CODE (0) IN R15 AND EXIT 11094302
*                                                                     * 11104202
*    INPUT       R0 - PTR TO LAST BYTE OF BUFFER + 1                  * 11127502
*                R1 - PTR TO BEGINNING OF BUFFER                      * 11129502
*                R15- PTR TO KEYWORD WITH THE LENGTH OF THE KEYWORD   * 11137502
*                     IN THE HIGH ORDER BYTE.                         * 11139502
*                     EG. KEYWORD FORMAT 'DSNAME=' R15 WOULD POINT    * 11139902
*                     TO THE 'D' WITH A 6 IN THE HIGH ORDER BYTE.     * 11140302
*                                                                     * 11140702
*     OUTPUT     R1   LENGTH OF KEYWORD VALUE                         * 11141102
*                R14  PTR TO FIRST BYTE OF KEYWORD VALUE IN BUFFER    * 11141802
*                     OR WORKAREA                                     * 11143802
*                R15  RETURN CODE OF ZERO.                            * 11147302
*                                                                     * 11149302
*     ERROR      R15  CONTAINS 4 IF KEYWORD HAS AN INVALID LENGTH     * 11149702
*     OUTPUT                   8 IF KEYWORD WAS NOT FOUND IN BUFFER   * 11150102
*                                                                     * 11150502
*     EXIT       TO NEXT SEQUENTIAL INSTRUCTION AFTER MACRO CALL      * 11150602
*                                                                     * 11154802
*     NOTES      LISTS OF OPERANDS IN PARENTHESES ARE NOT PROCESSED.  * 11156802
*                THIS MACRO IS INTENDED TO PROCESS ONLY A SINGLE      * 11158802
*                VALUE FOR A GIVEN KEYWORD.                           * 11158902
*                                                                     * 11163202
*********************************************************************** 11165202
         EJECT                                                          11167202
         ICM   REG0,E7,XAP+1       R0 PTR TO BUFFER END + 1      Y02669 11169602
         ICM   REG1,E7,XAL+1       R1 PTR TO BUFFER BEGINNING    Y02669 11172402
         BZ    KNOL                BRANCH IF NO POINTER        @ZA12152 11172533
         CLC   E0(E2,REG1),NCCHAR  IS COMMAND K N,PFK          @ZA12152 11172633
         BE    KNOL                YES, BYPASS SCAN FOR L=     @ZA12152 11172733
         LA    R15,LEQUALS         R15 PTR TO KEYWORD EQUATE     Y02669 11172802
         ICM   R15,E8,C1               HI-ORDER BYTE IS LENGTH   Y02669 11173202
         LR    WORK5,RETURN14      SAVE RETURN ADDRESS           Y02669 11175202
         IEEBUFSC                                                Y02669 11176002
*********************************************************************** 11177502
*                                                                     * 11177602
*        REG1 - LENGTH OF VALUE FOLLOWING THE KEYWORD                 * 11177902
*               STORED IN XASAVSTD                                    * 11178302
*        RETURN14 - PTR TO FIRST BYTE OF KEYWORD VALUE                * 11178602
*                   LOADED INTO OPPTR                                 * 11178702
*        REG15 - RETURN CODE 0 - ALL WENT WELL                        * 11179002
*                            4 - PTR TO END OF BUFFER + 1 WAS WRONG   * 11179402
*                            8 - KEYWORD WAS NOT FOUND                * 11179802
*        XASAVSTD - LENGTH OF 'CCA' INFORMATION                       * 11179902
*        XASTSAVE - PTR TO 'C' OF L=CCA                               * 11180002
*        XASAVSTD+4 - PTR TO , PRECEDING OPERAND                      * 11180102
*        XASAVSTD+8 - PTR TO 'L' OF L=CCA                             * 11190102
*                                                                     * 11199202
*  ERR - IEE156I INVALID OPERAND - L= IS FIRST OPERAND ON COMMAND     * 11201202
*********************************************************************** 11205502
         SPACE 2                                                        11211802
         CH    R15,C4               DETERMINE RETURN CODE        Y02669 11228702
         BH    NOL                  8 - NO 'L' IN OPERAND BUFFER Y02669 11233802
         BL    OPFOUND              0 - L OPERAND WAS FOUND      Y02669 11238902
ERRONL   EQU   *                                                 Y02669 11244002
         SH    RETURN14,C2              POINT TO 'L'           @YM5459P 11245002
LFIRST   LR    OPPTR,RETURN14           FOR IEE5603D           @ZA16595 11245533
         LR    RETURN14,WORK5       4 - ERROR CONDITION          Y02669 11249102
         B     ERR156                   IEE156I INVALID OPERAND  Y02669 11254202
OPFOUND  EQU   *                                                        11259302
         ST    REG1,XASAVSTD        SAVE LENGTH OF KEYWORD VALUE Y02669 11264402
         LR    OPPTR,RETURN14           SAVE ADDR OF 'CCA' VALUE Y02669 11269502
         ST    OPPTR,XASTSAVE           SAVE CURSOR POINTER      Y02669 11271502
         BCTR  RETURN14,0               POINT TO EQUAL SIGN      Y02669 11274602
         BCTR  RETURN14,0               POINT TO 'L'             Y02669 11279702
         ST    RETURN14,XASAVSTD+E8     SAVE ADDR OF 'L'         Y02669 11284802
         BCTR  RETURN14,0               POINT TO PRECEDING ,     Y02669 11287402
         CLI   E0(RETURN14),COMMA       'L=' NOT ALLOWED AS    @ZA16595 11287633
*                                       FIRST OPERAND: TEST IT @ZA16595 11287833
         BE    LCOM                     NOT FIRST: OK          @ZA16595 11288033
         LA    RETURN14,E1(RETURN14)    FIRST: ERROR, POSITION @ZA16959 11288233
*                                       CURSOR TO 'L' AND      @ZA16959 11288433
         B     LFIRST                   GO ISSUE ERROR MESSAGE @ZA16959 11288633
LCOM     ST    RETURN14,XASAVSTD+E4     SAVE ADDR OF ,           Y02669 11289633
         LR    RETURN14,WORK5           RESTORE REGISTER 14      Y02669 11300002
         EJECT                                                          13600001
*********************************************************************** 13650002
*                                                                     * 13660002
*                'L' OPERAND FOUND ON COMMAND                         * 13670002
*                                                                     * 13680002
*  ERR - IEE156I INVALID OPERAND - 'L=CCA' INVALID FROM TSO TERMINAL  * 13682002
*                                   'CC' = 0000                       * 13684002
*********************************************************************** 13690002
         SPACE 2                                                        13692002
LFOUND   EQU   *                                                        13700001
         CLC   XAA(E2),ZERO        IS COMMAND FROM TSO TERMINAL? Y02669 13850002
         BNE   ERR305              YES, NO L OPERAND ALLOWED     YM1917 13860002
         CLC   E0(E2,OPPTR),F0F0   DOES L=00? - INVALID CONSOLE  Y02669 13870002
         BE    ERR926B             ID - ERROR MSG                Y02669 13880002
         OI    XASSDS,XASSDS2      INDICATE L OPERAND SPECIFIED ON CMD  13900002
         TM    E0(OPPTR),F0        1ST CHAR A NUMBER (FIRST 4 BITS F)?  14150002
         BNO   CCNTSPEC            BRANCH IF NOT A NUMBER (NO CC)       14250002
         SPACE 2                                                        14252002
*********************************************************************** 14260002
*                                                                     * 14270002
*                'CC' OR 'C' SPECIFIED ON COMMAND                     * 14280002
*                                                                     * 14290002
*  ERR - IEE926I 'CC' NOT A CONSOLE - TARGET CONSOLE ID WAS INVALID   * 14290402
*********************************************************************** 14292002
         SPACE  2                                                       14294002
         TM    E1(OPPTR),F0        IS SECOND CHARACTER A NUMBER? Y02669 14300002
         BO    TWODIGIT            YES, TWO-DIGIT NUMBER                14800002
         PACK  XAP(DBLWORD),E0(E1,OPPTR)  PACK THE CONSOLE ID           15300001
         LA    OPPTR,E1(OPPTR)     OPPTR=1ST CHAR AFTER 'CC'     Y02669 15400002
         B     CHECKCC             VALIDITY CHECK                       15600002
TWODIGIT EQU   *                                                        15700001
         PACK  XAP(DBLWORD),E0(E2,OPPTR)  PACK THE CONSOLE ID           15800001
         LA    OPPTR,E2(OPPTR)     OPPTR=1ST CHAR AFTER 'CC'     Y02669 15900002
CHECKCC  EQU   *                                                        16100001
         CVB   CONSID,XAP          CONVERT CONSOLE ID TO BINARY         16400002
         STC   CONSID,XASCID       STORE CONSOLE ID IN XSA              16600001
         L     UCMEBASE,UCMVEL     BASE LAST UCMENTRY                   16700001
         CLC   XASCID(E1),UCMID    ID HIGHER THAN HIGHEST VALID  Y02669 17050002
         BH    ERR926B             CONSOLES ID? YES, ERROR       Y02669 17100002
         EJECT                                                          17110002
*********************************************************************** 17150002
*                                                                     * 17160002
*    CHECK IF AREA ID IS SPECIFIED. AT THIS POINT OPPTR POINTS TO     * 17200002
*    THE FIRST CHAR AFTER THE CONSOLE ID                              * 17400002
*    IF NO 'A' IS SPECIFIED XASDID WILL REMAIN X'00' - NULL           * 17410002
*                                                                     * 17450002
*********************************************************************** 17550002
         SPACE  2                                                       17600002
         CLI   E0(OPPTR),BLANK     IS POINTER AT END OF COMMAND? Y02669 17700002
         BE    REMOVEL             YES, NO 'A' IS SPECIFIED             17800002
         CLI   E0(OPPTR),COMMA     IS POINTER AT END OF OPERAND? Y02669 17900002
         BE    REMOVEL             NO , NO 'A' IS SPECIFIED             18000002
         SPACE                                                          18100001
*********************************************************************** 18110002
*                                                                     * 18110402
*                'A' OPERAND FOUND ON COMMAND                         * 18112002
*                                                                     * 18114002
*    IT IS ASSUMED THAT THE FIRST CHAR AFTER THE CONSOLE ID           * 18120002
*    (OR AFTER THE = IF CC IS NOT SPECIFIED) IS THE AREA ID.          * 18130002
*    IF THE ID IS NOT VALID IT WILL BE DISCOVERED WHEN LOOKING FOR    * 18142002
*    AN SACB TO MATCH IT.                                             * 18144002
*                                                                     * 18144402
*  ERR - IEE156I INVALID OPERAND - 'A' WAS MORE THAN 1 CHARACTER      * 18144802
*********************************************************************** 18146002
         SPACE  2                                                       18148002
STOREA   EQU   *                                                        18148402
         TM    E0(OPPTR),C0        1ST CHAR A LETTER (FIRST 3 BITS F)?  18148502
         BNO   ERR926A             IF NOT LETTER-INVALID AREA    Y02669 18148602
         MVC   XASDID(E1),E0(OPPTR)  MOVE AREA ID INTO XSA       Y02669 18148802
         LA    OPPTR,E1(OPPTR)     INCREMENT POINTER TO NEXT CHARY02669 18149202
         CLI   E0(OPPTR),BLANK     IS POINTER AT END OF COMMAND? Y02669 18149602
         BE    REMOVEL             YES, BRANCH TO REMOVE L              18149702
         CLI   E0(OPPTR),COMMA     IS POINTER AT END OF OPERAND  Y02669 18149802
         BE    REMOVEL             YES, BRANCH TO REMOVE L              18149902
         B     ERR156              BRANCH TO ERROR ROUTINE       Y02669 18156502
         EJECT                                                          18171002
*********************************************************************** 18710002
*                                                                     * 18712002
*                'L' OPERAND WAS NOT SPECIFIED ON THE COMMAND         * 18720002
*         CHECK RCT FOR ROUTING DEFAULTS SET BY MSGRT COMMAND         * 18722002
*                                                                     * 18724002
*********************************************************************** 18730002
         SPACE  2                                                       18740002
NOL      EQU   *                   NO L OPERAND WAS FOUND               18750002
         LR    RETURN14,WORK5      RESTORE R14 AFTER IEEBUFSC    Y02669 18760002
KNOL     EQU   *                  COMMAND WAS N,PFK BUFSC SKIP @ZA12152 18780033
         CLC   XAA(E2),ZERO        IS COMMAND FROM TSO TERMINAL? Y02669 18800002
         BNE   TESTOPER            YES, CHECK DISPLAY OPERANDS   Y02669 18830002
         SPACE  2                                                       18860002
*********************************************************************** 18870002
*                                                                     * 18872002
*                'CC' NOR 'C' WAS SPECIFIED ON THE COMMAND            * 18880002
*                                                                     * 18882002
*********************************************************************** 18890002
         SPACE  2                                                       18892002
CCNTSPEC EQU   *                                                        18900002
         SR    REG1,REG1          CLEAR PARAMETER REG                   18950002
         ICM   REG1,E1,XAU        GET SOURCE CONSOLE ID          Y02669 18980002
         BNZ   NOTINTEN           IF ZERO NO DEFAULTING          YM1557 19020002
INTERNAL EQU   *                                                 YM1557 19030002
         CLI   XAV,DCHAR          ONLY A DISPLAY COMMAND CAN BE  YM1557 19040002
*                                 ISSUED INTERNALLY WITHOUT    @YM7698P 19050002
*                                 THE L OPERAND. THE K, TR AND @YM7698P 19050102
*                                 STOPTR COMMANDS CAN NOT BE   @YM7698P 19056002
*                                 ISSUED INTERNALLY WITHOUT    @YM7698P 19057002
         BNE   RETURN             THE L OPERAND                @YM7698P 19058002
         LR    WORK4,UCMBASE      GET ADDRESS OF UCM             YM1557 19059002
         LA    WORK5,E4           PUT 4 IN REG5 FOR SUBSTRACT    YM1557 19060002
         SR    WORK4,WORK5        UCM MINUS 4 AND                YM1557 19063002
         L     WORK4,E0(WORK4)    GET REAL ADDRESS OF UCM PREF @ZA03611 19064004
         USING UCMPRFX,WORK4      ESTABLISH UCM PREFIX BASE      YM1557 19065002
         L     UCMEBASE,UCMMCENT  GET UCME ADDR FOR MASTER       YM1557 19067002
         DROP  WORK4                                             YM1557 19068002
         MVC   XASCID(E1),UCMID   USE MASTER CONSOLE ID AS       YM1557 19070002
         MVC   XAU(E1),UCMID      BOTH SOURCE AND TARGET       @ZM30445 19071003
         MVI   XASDID,Z           DEFAULT WITH INSTREAM          YM1557 19072002
         TM    XASSDS,XASSDS2     L OPERAND SPECIFIED ?        @ZM30445 19072603
         BNO   TSTCMND            NO,CHECK COMND BEING ISSUED  @ZM30445 19074003
         LA    OPPTR,E1(OPPTR)    BUMP OPERAND PTR             @ZM30445 19074603
         B     REMOVEL            YES, GO REMOVE IT            @ZM30445 19075203
*********************************************************************** 19076002
*                  GET ISSUING CONSOLE'S UCM ENTRY                    * 19078002
*********************************************************************** 19080002
NOTINTEN EQU   *                                                 YM1557 19080402
         BAL   R15,FINDUCME        BASE SOURCE UCM ENTRY         Y02669 19082002
         EJECT                                                          19084002
*********************************************************************** 19086002
*                                                                     * 19088002
*                 GET ISSUING CONSOLE'S ROUTING CONTROL TABLE         * 19088402
*                                                                     * 19088802
*********************************************************************** 19089202
         SPACE  2                                                       19090002
         ICM   RCTBASE,E7,UCMRCTA  SEE IF RCT IS PRESENT         Y02669 19100002
         BZ    NOCOMP              NO, ROUTE TO ISSUING CONSOLE         19250002
         ST    RCTBASE,XAD         SAVE BASE RCT ADDRESS         Y02669 19252002
ACTIVE   EQU   *                                                 Y02669 19260002
         TM    RCTCODE,RCTACT      IS ENTRY ACTIVE?              Y02669 19300002
         BO    COMPCMD             YES, GO COMPARE               Y02669 19330002
LASTRCT  EQU   *                                                 Y02669 19360002
         TM    RCTCODE,RCTCON      NO, IS IT LAST ENTRY?         Y02669 19400002
         BO    NEXTRCT             NO, LOAD NEXT POINTER         Y02669 19450002
         BM    NOCOMP              YES, COMPARE NOT FOUND              X19500002
                                        ROUTE TO ISSUING                19550002
         LA    RCTBASE,RCTENT2     POINT TO NEXT ENTRY                  19600002
         B     ACTIVE              GO TEST IT                           19650002
NEXTRCT  EQU   *                                                 Y02669 19660002
         ICM   RCTBASE,E7,RCTCODE+1 LOAD NEW POINTER             Y02669 19700002
         BZ    NOCOMP              IF NONE, ROUTE TO ISSUING     Y02669 19750002
         B     ACTIVE              GO TEST IT                    Y02669 19752002
         SPACE                                                          19754002
*********************************************************************** 19762002
*         CHECK RCT FOR ENTRY FOR COMMAND FOR A DEFAULT 'CC' VALUE    * 19772002
*********************************************************************** 19780002
COMPCMD  EQU   *                                                 Y02669 19800002
         CLC   XAV(E1),RCTVER      DO COMMAND AND TABLE MATCH?          19850002
         BE    OPTEST              YES, GO TEST OPERAND                 19880002
         CLI   XAV,CCHAR          NO, IS COMMAND VERB 'CONTROL'? Y02669 19910002
         BNE   TRCMD               NO, IS CMD VERB TR?           Y02669 19960002
         CLI   RCTVER,KCHAR        YES, IS TABLE ENTRY 'K'?             20050002
         BE    TESTENT             YES, BYPASS OPERAND CHECK     Y02669 20100002
         B     LASTRCT             NO, RETURN TO TABLE SCAN      Y02669 20102002
TRCMD    EQU   *                                                 Y02669 20110002
         CLI   RCTVER,TCHAR        IS TABLE ENTRY 'T'?           Y02669 20140002
         BNE   LASTRCT             NO, RETURN TO TABLE SCAN      Y02669 20140402
         CLI   XAN,PT              IS COMMAND VERB 'STOPTR'?     Y02669 20142002
         BE    TESTENT             YES, BYPASS OPERAND CHECK     Y02669 20154002
         B     LASTRCT             NO, RETURN TO TABLE SCAN      Y02669 20156002
         SPACE  2                                                       20160002
OPTEST   EQU   *                                                        20200002
         CLI   RCTVER,KCHAR        IS TABLE ENTRY 'K'?           Y02669 20210002
         BE    TESTENT             YES, BYPASS OPERAND TEST      Y02669 20230002
         CLI   RCTVER,TCHAR        IS TABLE ENTRY 'T'FOR TR?     Y02669 20240002
         BE    TESTENT             YES, BYPASS OPERAND TEST      Y02669 20242002
         L     RCTSCAN,XAL         POINT TO OPERAND                     20250002
         CLC   E0(E2,RCTSCAN),DCBLANK   IS OPERAND D C         @YM4791P 20260002
         BE    DCOPER                                          @YM4791P 20270002
         CLC   E0(L'CONSOLES,RCTSCAN),CONSOLES   IS OPERAND 'CONSOLES'? 20280002
         BE    DCOPER              YES, COMPARE WITH RCT         YM1916 20290002
         CLI   E0(RCTSCAN),DCHAR   IS 1ST CHAR A 'D'?          @G33CPMR 20293033
         BNE   PROCEED             NO, AVOID 'D' CHAR. TESTS   @G33CPMR 20296033
         CLC   E0(L'DUMP,RCTSCAN),DUMP IS OPERAND 'DUMP'?      @G33CPMR 20300033
         BE    DDOPER              YES, COMPARE WITH RCT       @G33CPMR 20306033
         CLC   E0(L'DMN,RCTSCAN),DMN IS OPERAND 'DMN'?         @G33CPMR 20308033
         BNE   DDOPER              NO, COMPARE WITH RCT        @G33CPMR 20310033
PROCEED  EQU   *                                               @G33CPMR 20312033
         CLC   RCTOPD(E1),E0(RCTSCAN)  DOES OPERAND MATCH TABLE? YM1916 20320002
         BE    TESTENT             YES, GO TO INSERT VALUES      Y02669 20350002
         BNE   DACTCMD             NO                            Y02669 20430002
DCOPER   EQU   *                                                 Y02669 20470002
         CLI   RCTOPD,OCHAR        YES, IS TABLE ENTRY 'O'?             20500002
         BNE   LASTRCT             NO, RETURN TO TABLE SCAN      Y02669 20550002
         B     TESTENT             YES, GO INSERT VALUES         Y02669 20560002
DDOPER   EQU   *                                               @G33CPMR 20562033
         CLI   RCTOPD,PCHAR        IS TABLE ENTRY 'P'?         @G33CPMR 20563033
         BNE   LASTRCT             NO, RETURN TO TABLE SCAN    @G33CPMR 20564033
         B     TESTENT             YES, GO TO VALUE INSERTION  @G33CPMR 20565033
         SPACE 2                                                        20570002
DACTCMD  EQU   *                                                 Y02669 20580002
         CLI   RCTOPD,ACHAR        IS TABLE ENTRY 'A'?           Y02669 20590002
         BNE   LASTRCT             NO, RETURN TO TABLE SCAN      Y02669 20592002
         CLI   XAN,D               IS COMMAND VERB D JOBS; TS; A?Y02669 20594002
         BNE   LASTRCT             NO, RETURN TO TABLE SCAN      Y02669 20596002
         EJECT                                                          20600002
*********************************************************************** 20770002
*                                                                     * 20780002
*  IF NO DEFAULT WAS FOUND IN RCT THE DISPLAY IS ROUTED TO THE        * 20790002
*  ISSUING CONSOLE                                                    * 20792002
*  'CC' EQUALS XAU VALUE AND 'A' EQUALS X'00'                         * 20794002
*  OTHERWISE, THE DEFAULTS FOUND IN THE RCT ARE STORED IN THE XSA.    * 20802002
*                                                                     * 20810002
*  IF 'A' WAS SPECIFIED ON THE COMMAND ITS VALUE OVERRIDES RCT VALUE  * 20818002
*                                                                     * 20826002
*********************************************************************** 20834002
         SPACE  2                                                       20842002
TESTENT  EQU   *                                                        20850002
         OI    XASSDS,XASSDS4      SET 'L' OPERAND FROM RCT    @ZA02576 20860003
         MVC   XASDID(E1),RCTAID   STORE AREA ID (00-NONE)       Y02669 20880002
         CLI   XASDID,ASTRICK       THIS SPECIAL RCTAID FILLER @Z40LPTA 20882004
         BNE   NOTAST              NO, PROCEED                 @Z40LPTA 20884004
         MVI   XASDID,NULL         RE-SET TO NULL (00)         MZ40LPTA 20886004
NOTAST   EQU   *                                               @Z40LPTA 20888004
         CLI   RCTCID,NULL         IS CONSOLE ID PROVIDED IN RCT?Y02669 20894002
         BE    NOCOMP              NO, ROUTE TO ISSUING          Y02669 20894602
         MVC   XASCID(E1),RCTCID   YES,STORE CONSOLE ID FROM RCT Y02669 20895202
         B     LTEST               SEE IF L OPERAND WAS PRESENT         20895802
NOCOMP   EQU   *                                                 Y02669 20896402
         MVC   XASCID(E1),XAU      PUT SOURCE ID IN XSA                 20898002
LTEST    EQU   *                                                        20946702
         TM    XASSDS,XASSDS2      WAS L OPERAND PRESENT ON COMMAND?    20970402
         BO    STOREA              YES, GET AREA OPERAND FROM IT        20994102
         B     VALIDITY            NO, VALIDITY CHECK VALUES     Y02669 21017802
         EJECT                                                          21041502
*********************************************************************** 21065202
*                                                                     * 21065602
*    'L' OPERAND IS REMOVED FROM COMMAND SO THAT OTHER COMMAND        * 21066702
*    HANDLERS WILL NOT SEE IT                                         * 21200002
*    AT ENTRY HERE OPPTR POINTS TO THE BLANK OR COMMA WHICH DELIMITS  * 21400002
*    THE 'L' OPERAND.                                                 * 21600002
*    A POINTER TO THE 'L' IS SAVED IN XASAVSTD + 8                    * 21700002
*                     ',' PRECEDING THE OPERAND IN XASAVSTD+4         * 21750002
*   THE LENGTH OF THE OPERAND IS SAVED IN XASAVSTD                    * 21800002
*                                                                     * 21850002
*********************************************************************** 21950002
         SPACE                                                          21960002
MOVEOP   MVC   E0(E0,WORK5),E0(OPPTR)  PUSH REST OF OPERANDS OVER       21970002
BLANKOUT MVC   E1(E0,WORK5),E0(WORK5)  BLANK OUT FIELD POINTED TO       21980002
*                                       BY WORK5                        21990002
         SPACE                                                          21992002
REMOVEL  EQU   *                                                        22000002
         L     WORK4,XASAVSTD      GET LENGTH OF L OPERAND       Y02669 22100002
         LA    WORK4,E1(WORK4)     LESS 2 FOR PROPAGATE & EX     Y02669 22200002
         CLI   E0(OPPTR),BLANK     IS POINTER AT END OF COMMAND? Y02669 22500002
         BNE   REMOVELC            NO, MOVE REST OF COMMAND OVER        22800002
         SPACE                                                          22850002
*********************************************************************** 22950002
*                                                                     * 22950402
*          'L' OPERAND IS AT END OF COMMAND SO JUST BLANK IT OUT      * 22952002
*                                                                     * 22954002
*********************************************************************** 22960002
         SPACE                                                          22970002
         L     WORK5,XASAVSTD+E4   GET ADDRESS OF COMMA BEFORE L Y02669 23200002
         MVI   E0(WORK5),BLANK     BLANK FIRST BYTE, THEN        Y02669 23300002
         EX    WORK4,BLANKOUT      BLANK OUT REST OF OPERAND     Y02669 23400002
         B     VALIDITY            CHECK CONSOLE AND AREA VALIDITY      23600002
         SPACE 2                                                        23800002
*********************************************************************** 23850002
*                                                                     * 23860002
*        'L' OPERAND IS NOT LAST OPERAND. REMOVE IS, MOVE THE REST OF * 23900002
*       THE COMMAND OVER, AND BLANK WHERE COMMAND WAS MOVED FROM      * 24000002
*                                                                     * 24250002
*********************************************************************** 24350002
         SPACE                                                          24352002
REMOVELC EQU   *                                                        24360002
         L     WORK5,XAR           GET PARM LIST POINTER       @ZA10516 24365041
         LA    WORK5,E0(WORK5)     COMPUTE END OF PARM LIST BY:@ZA10516 24370041
         LR    R15,WORK5           GET BEGINNING ADDR OF LIST  @ZA10516 24380041
         AH    R15,0(WORK5)        ADD LENGTH OF PARM LIST     @ZA10516 24390041
         BCTR  R15,E0              POINT TO LAST CHARACTER       Y02669 24394002
         SR    R15,OPPTR           GET LENGTH OF OPERAND FIELD   Y02669 24700002
*                                  AFTER L OPERAND (-1 FOR EX)   Y02669 24800002
         L     WORK5,XASAVSTD+E4   GET ADDRESS OF COMMA BEFORE L Y02669 25000002
         EX    R15,MOVEOP          PUSH REST OF OPERANDS OVER    Y02669 25100002
         LA    WORK5,E1(WORK5)     CALCULATE ADDRESS OF FIELD TO Y02669 25200002
         AR    WORK5,R15             BE BLANKED                  Y02669 25300002
*                                  (WORK4 STILL HAS ADJUSTED     Y02669 25400002
*                                       LENGTH OF L OPERAND)     Y02669 25500002
         MVI   E0(WORK5),BLANK     BLANK FIRST BYTE THEN         Y02669 25600002
         EX    WORK4,BLANKOUT      PROPAGATE THRU REST OF FIELD  Y02669 25650002
         EJECT                                                          26500001
*********************************************************************** 33000001
*                                                                     * 33100001
*  AT ENTRY TO THIS SECTION OF CODE, THE TARGET CONSOLE ID AND AREA   * 33200002
* ID HAVE BEEN PUT IN THE XSA, EITHER FROM THE 'L' PARAMETER, THE     * 33300002
* DEFAULTS SPECIFIED BY THE MSGRT COMMAND, OR SYSTEM DEFINED          * 33400002
* DEFAULTS (ISSUING CONSOLE)                                          * 33500002
*                                                                     * 33600001
*        THIS CODE CHECKS FOR ROUTING AUTHORITY, AND ENSURES THAT     * 33700001
* 'CC' SPECIFIES AN ACTIVE CONSOLE WITH AREA 'A' DEFINED.             * 33800002
*                                                                     * 33900001
*   ERR - IEE345I AUTHORITY INVALID - ISSUING CONSOLE WASN'T ALLOWED  * 33950002
*                                     TO ISSUE COMMAND                * 33960002
*         IEE926I 'CC' NOT A CONSOLE     - TARGET CONSOLE NOT ACTIVE  * 33970002
*         IEE926I 'CC' FULL CAPABILITY   - COMMAND VALID ONLY TO MS   * 33980002
*                                          OR SD CONSOLE              * 33990002
*                                                                     * 33992002
*********************************************************************** 34000001
         SPACE 2                                                        34100001
VALIDITY EQU   *                                                        34200001
         USING DCMACB,SACBBASE     BASE SCREEN AREA CONTROL BLOCK       34300001
         CLC   XASCID(E1),XAU      IS TARGET AND SOURCE SAME?    Y02669 34350002
         BE    SRCEQTRG            IF YES, BRANCH                       35000001
         SPACE  2                                                       35050002
*********************************************************************** 35150002
*                                                                     * 35150402
*                 TARGET AND SOURCE ARE NOT THE SAME                  * 35150802
*   GET THE UCM ENTRY ADDRESS OF THE SOURCE AND BASE THE UCME         * 35152002
*                                                                     * 35154002
*********************************************************************** 35160002
         SPACE  2                                                       35162002
         SR    REG1,REG1                                         Y02669 35164002
         IC    REG1,XAU            GET SOURCE CONSOLE ID         Y02669 35170002
         LTR   REG1,REG1           IF ZERO, ISSUED INTERNALLY    YM1557 35180002
         BZ    AUTHOK              ASSUME AUTHORITY OK           YM1557 35190002
         BAL   R15,FINDUCME        FIND ITS UCME                 Y02669 35200002
         TM    UCMAUTH,UCMAUTH3    DOES SOURCE CONSOLE HAVE CONS        35700002
*                                       AUTHORITY TO ROUTE?             35800002
         BZ    ERR345              NO,  BRANCH TO ERROR ROUTINE  Y02669 36000002
         EJECT                                                          36050002
*********************************************************************** 36150002
*                                                                     * 36152002
*   GET THE UCM ENTRY ADDRESS OF THE TARGET CONSOLE AND BASE THE UCME * 36158002
*                                                                     * 36164002
*********************************************************************** 36170002
         SPACE  2                                                       36172002
AUTHOK   EQU   *                                                 YM1557 36172402
         SR    REG1,REG1                                         Y02669 36174002
         IC    REG1,XASCID         GET TARGET CONSOLE ID         Y02669 36180002
         BAL   R15,FINDUCME        FIND ITS UCME                 Y02669 36200002
         TM    UCMDISP2,UCMDISPK   IF ON SUBSYSTEM CONSOLE     @Y02668P 36300003
         BO    ERR926E             BRANCH TO ERROR ROUTINE     @Y02668P 36400003
         TM    UCMATR,UCMUF        IS CONSOLE ACTIVE?                   36600002
         BZ    ERR926B             NO,  BRANCH TO ERROR ROUTINE  Y02669 36700002
         CLI   XAN,K               IS THIS CONTROL COMMAND?             36750002
         BNE   CHKFULC             NO, GO CHECK FOR FULL CAPABILITY     36760002
         L     WORK4,XAL           GET POINTER TO 1ST OPERAND    Y02669 36770002
         CLI   E0(WORK4),VCHAR     IS COMMAND K V?               Y02669 36780002
         BE    CHKAREA             YES, ALLOW ROUTING EVEN IF          X36790001
                                        FULL CAPABILITY                 36792002
         SPACE  2                                                       36802002
*********************************************************************** 36842002
*                                                                     * 36842402
*     TARGET CONSOLE MUST BE MESSAGE STREAM OR STATUS DISPLAY         * 36844002
*     OR THE SAME AS ISSUING CONSOLE FOR ALL COMMANDS EXCEPT K V      * 36846002
*                                                                     * 36846102
*   ERR - IEE926I 'CC' FULL CAPABILITY                                * 36846402
*                                                                     * 36846802
*********************************************************************** 36848002
         SPACE  2                                                       36848402
CHKFULC  EQU   *                                                        36850001
         TM    UCMDISP,UCMDISPF+UCMDISPG IS CONSOLE MS OR SD?           36900002
         BZ    ERR926C             NO,  BRANCH TO ERROR ROUTINE  Y02669 37200002
         B     CHKAREA             BRANCH TO CHECK AREA                 37700001
         EJECT                                                          37750002
*********************************************************************** 37850002
*                                                                     * 37852002
*                TARGET IS THE SAME AS THE SOURCE                     * 37852402
*   GET THE UCM ENTY ADDRESS OF THE TARGET CONSOLE AND BASE THE UCME  * 37852502
*                                                                     * 37852802
*********************************************************************** 37860002
         SPACE  2                                                       37870002
SRCEQTRG EQU   *                                                        37900002
         SR    REG1,REG1                                         Y02669 37950002
         IC    REG1,XASCID         FIND TARGET CONSOLE UCME      Y02669 38000002
         BAL   R15,FINDUCME                                      Y02669 38050002
         SPACE  2                                                       38400002
*********************************************************************** 38450002
*                                                                     * 38452002
*   FROM THIS POINT ON IN THIS MODULE, UCMEBASE CONTAINS THE          * 38460002
*   ADDRESS OF THE TARGET CONSOLE'S UCM ENTRY.                        * 38462002
*                                                                     * 38464002
*********************************************************************** 38470002
         SPACE  2                                                       38480002
CHKAREA  EQU   *                                                        38500001
         CLI   XASDID,NULL        IS AREA NULL,NO 'A' SPECIFIED? Y02669 39200002
         BNZ   AREAEXST            NO, DOES AREA EXIST ON TARGET        39400002
         TM    UCMDISP,UCMDISPC    YES, IS TARGET CONSOLE A CRT?        39700002
         BZ    SETZ                NO, BRANCH TO SET AREA=Z             39800001
         TM    UCMDISP,UCMDISPF    YES, IS TARGET MESSAGE STREAM?       39900002
         BZ    CHKCMND             NO,BRANCH TO CHECK COMMAND           39910002
         SPACE  2                                                       39920002
*********************************************************************** 39950002
*                                                                     * 39952002
*   AREA REMAINS NULL AT THIS POINT IF TARGET IS A STATUS DISPLAY     * 39970002
*   OR FULL CAPABILITY CRT CONSOLE                                    * 39980002
*  IF TARGET IS NON-CRT OR MESSAGE STREAM ONLY CRT, INDICATE AREA=Z   * 39980402
*                                                                     * 39982002
*********************************************************************** 39990002
         SPACE  2                                                       40040002
SETZ     EQU   *                                                        40600001
         MVI   XASDID,Z            IF TARGET IS NON-CRT OR MSG STREAM   40800002
         B     CHKCMND             BRANCH TO CHECK COMMAND              41100001
         EJECT                                                          41150002
*********************************************************************** 41250002
*                                                                     * 41260002
*       FIND OUT IF THE AREA SPECIFIED EXISTS ON THE TARGET           * 41400002
*                                                                     * 41450002
*  ERR - IEE926I 'A' NOT AN AREA - TARGET IS STATUS DISPLAY ONLY      * 41460002
*                                  AND AREA 'Z' WAS SPECIFIED         * 41462002
*        IEE926I 'A' NOT AN AREA - TARGET IS NOT A CRT AND AREA IS    * 41470002
*                                  NOT IN-LINE                        * 41480002
*********************************************************************** 41550002
         SPACE  2                                                       41560002
AREAEXST EQU   *                                                        41600002
         TM    UCMDISP,UCMDISPC    IS TARGET A CRT?                     41700002
         BO    CRT                 IF YES, BRANCH                       41800001
         CLI   XASDID,Z            IS AREA = Z?                         41900002
         BNE   ERR926A             NO,  BRANCH TO ERROR ROUTINE  Y02669 42000002
         B     CHKCMND             YES, BRANCH TO CHECK COMMAND         42100001
CRT      EQU   *                   TARGET IS A CRT                      42200001
         CLI   XASDID,Z            IS AREA = Z?                         42300002
         BNE   OUTOLINE            NO, BRANCH                           42400001
         TM    UCMDISP,UCMDISPG    IS TARGET STATUS DISPLAY ONLY?       42500002
         BO    ERR926A             YES, BRANCH TO ERROR ROUTINE  Y02669 42600002
         B     CHKCMND             NO, BRANCH TO CHECK COMMAND          42700001
         SPACE  2                                                       43110002
*********************************************************************** 43150002
*                                                                     * 43150402
*   FIND THE SCREEN CONTROL BLOCK FOR THE SPECIFIED AREA.             * 43151402
*   ADDRESS IS PUT IN SACBBASE, ZERO IF NONE FOUND.                   * 43152402
*                                                                     * 43153402
*  ERR - IEE926I NOT AN AREA - SPECIFIED AREA DOES NOT EXIST (NO SACB)* 43154402
*********************************************************************** 43160002
         SPACE  2                                                       43170002
OUTOLINE EQU   *                                                        43172002
         BAL   R15,FINDSACB                                      Y02669 43200002
         LTR   SACBBASE,SACBBASE   IS SPECIFIED AREA DEFINED?           43700002
         BZ    ERR926A             NO,  BRANCH TO ERROR ROUTINE  Y02669 43800002
         EJECT                                                          43850002
*********************************************************************** 44100001
*                                                                     * 44200001
*    IF THE COMMAND IS CONTROL, 1-IF K COMMAND ISSUED INTERNALLY      * 44300002
*                                 RETURN TO CALLER                    * 44310002
*                               2-IF K COMMAND ISSUED GO TO IEE6703D  * 44350002
*    OTHERWISE CONTINUE                                               * 44400002
*                                                                     * 44600001
*********************************************************************** 44700001
         SPACE 2                                                        44800001
CHKCMND  EQU   *                                                        44900002
         CLI   XAN,K               IS COMMAND CONTROL?                  45100002
         BE    D6703D              YES, BRANCH TO PROCESS CMND @ZM30446 46100003
         SPACE 3                                                        48400002
*********************************************************************** 52910002
*                                                                     * 52920002
*     THE ONLY COMMANDS HANDLED BEYOND THIS POINT ARE:                * 52926002
*         DISPLAY   C,K; CONSOLES (C); MATRIX; UNITS;                 * 52932002
*                   JOBS (J); TS; A                                   * 52938002
*         TRACK     JOBS (J); TS; A                                   * 52944002
*         STOPTR    JOBS (J); TS; A                                   * 52950002
*                                                                     * 52956002
*  ERR - IEE305I COMMAND INVALID - OTHER THAN D, TR, PT               * 52962002
*********************************************************************** 52968002
         SPACE  2                                                       53018002
TSTCMND  EQU   *                                                        53100002
         CLI   XAN,TR              IS COMMAND TRACK?             Y02669 53122102
         BE    DACTIVE             YES, BRANCH                   Y02669 53132102
         CLI   XAN,PT              IS COMMAND STOPTR?            Y02669 53144102
         BE    STOPTR              YES, BRANCH                   Y02669 53146102
TESTOPER EQU   *                                                 Y02669 53156102
         CLI   XAV,DCHAR           IS COMMAND DISPLAY?           Y02669 53175702
         BNE   ERR305              ANY OTHER COMMAND IS ERROR    YM1917 53177202
         SPACE  2                                                       53177302
         CLI   XAN,D               IS COMMAND D JOBS (J); TS; A? Y02669 53177602
         BNE   DISPLAY             NO, BRANCH                    Y02669 53178002
         EJECT                                                          53178702
*********************************************************************** 53178802
*                                                                     * 53178902
*     DISPLAY INIT; JOBS (J); TS; A ARE FIRST SEACHED FOR ,LIST       * 53179602
*         (,L) THEN TREATED LIKE THE OTHER DISPLAY COMMANDS           * 53180302
*                                                                     * 53181002
*********************************************************************** 53181902
         SPACE  2                                                       53186002
DACTIVE  EQU   *                                                 Y02669 53186102
         L     REG1,XAL            GET ADDRESS OF OPERANDS       Y02669 53186202
         CLI   XAXMASK,XAXJOBS     IS THIS JOBS?                 Y02669 53186502
         BH    ACTIVEOP            NO, ACTIVE                    Y02669 53186702
         BL    TS                  NO, TS                        Y02669 53187702
         CLC   E0(E2,REG1),JOCHAR  ARE FIRST 2 CHARS 'JO'?       Y02669 53188102
         BNE   ACTIVEOP            NO, MIGHT BE JUST 'J'         Y02669 53188502
         LA    REG1,E4(REG1)       FOR JOBS BUMP PAST 'S'        Y02669 53189702
         B     COMPARE             END OF OPERANDS?              Y02669 53191702
ACTIVEOP EQU   *                                                 Y02669 53193702
         LA    REG1,E1(REG1)       FOR 'A' AND 'J' BUMP PAST     Y02669 53194102
         B     COMPARE             END OF OPERANDS?              Y02669 53197502
TS       EQU   *                                                 Y02669 53197802
         LA    REG1,E2(REG1)       FOR TS BUMP PAST 'S'          Y02669 53198302
COMPARE  EQU   *                                                 Y02669 53198402
         CLI   E0(REG1),BLANK      IS OPERAND FOLLOWED BY BLANK? Y02669 53198802
         BE    DORTR               YES, CONTINUE                 Y02669 53199502
         CLC   E0(E6,REG1),LIST    IS OPERAND AFTER , 'LIST '?   Y02669 53199902
         BE    LISTOPT             YES, CHANGE BITS              Y02669 53200302
         CLC   E0(E3,REG1),JUSTL   NO, IS IT JUST 'L '?          Y02669 53200702
         BNE   ERR156A             NO, INVALID OPERAND           Y02669 53201102
LISTOPT  EQU   *                                                        53201502
         SR    WORK4,WORK4                                       Y02669 53201902
         IC    WORK4,XAXMASK       GET REQUEST FLAGS FROM XSA    Y02669 53202302
         SRL   WORK4,E1            SHIFT RIGHT 1 FOR 'LIST'      Y02669 53202702
         STC   WORK4,XAXMASK       RESTORE REQUEST FLAGS         Y02669 53203102
DORTR    EQU   *                                                 Y02669 53203502
         CLI   XAN,TR              TRACK COMMAND?                Y02669 53203902
         BE    TRACK               YES                           Y02669 53204302
         EJECT                                                          53205102
*********************************************************************** 53205502
*                                                                     * 53205902
*     DISPLAY CONSOLES (C); C,K; M; AND U ARE CONSIDERED DISPLAYS     * 53206302
*                                                                     * 53206702
*  ERR - IEE926I DYNAMIC DISPLAY IN AREA - DISPLAY ALREADY IN AREA    * 53207102
*********************************************************************** 53207502
         SPACE  2                                                       53207902
DISPLAY  EQU   *                   DISPLAY COMMAND                      53208302
         CLC   XAA(E2),ZERO        IS THIS FROM A TSO USER?      Y02669 53208402
         BNE   D0803D              YES, EXIT                     Y02669 53208702
         CLI   XASDID,Z            IS AREA = Z?                         53209102
         BE    D0803D              YES, EXIT                     Y02669 53209502
         CLI   XASDID,NULL         AREA SPECIFIED IN CMD OR BY DEFAULT  53209902
         BE    DEFAREA             NO, PROVIDE DEFAULT AREA             53210302
         TM    DCMADFLG,DCMADD     TRACK ALREADY IN AREA?               53211002
         BO    ERR926D             YES, BRANCH TO ERROR ROUTINE  Y02669 53213202
         B     D0803D              GO BUILD CSCB - IEE0803D      Y02669 53214302
         EJECT                                                          53215402
*********************************************************************** 53215802
*                                                                     * 53216202
*        IF NO AREA IS SPECIFIED IN THE COMMAND AND NO DEFAULT IS     * 53216302
* FOUND IN THE ROUTING CONTROL TABLE, A DEFAULT AREA IS ESTABLISHED   * 53216402
* AS FOLLOWS:                                                         * 53216502
*        (1) THE BOTTOM-MOST EMPTY AREA                               * 53216602
*        (2) IF NONE EMPTY, THE AREA CONTAINING THE OLDEST STATIC     * 53216702
*            DISPLAY                                                  * 53216802
*        (3) IF NO DISPLAY AREAS AVAILABLE, A TRACK COMMAND IS        * 53217202
*            REJECTED; A STATIC DISPLAY IS PUT IN LINE                * 53217602
*        (4) IF THE CONSOLE HAS NO MESSAGE STREAM, A DISPLAY COMMAND  * 53217702
*            IS REJECTED                                              * 53217802
*                                                                     * 53217902
*   ERR-IEE921I NEEDS DISPLAY AREA - 1 TRACK WITH NO SACB DEFINED     * 53218002
*                                    2 DISPLAY WITH NO SACB DEFINED   * 53218102
*                                    AND TARGET IS STATUS DISPLAY     * 53218202
*               DISPLAY AREA BUSY  - NO STATUS DISPLAY TO OVERLAY     * 53218302
*********************************************************************** 53219102
         SPACE                                                          53219402
DEFAREA  EQU   *                                                        53219702
         L     RDCMBASE,UCMXB      GET ADDRESS OF RESIDENT DCM   Y02669 53220002
         CLI   DCMTOPAR,E0         ANY AREAS DEFINED FOR TARGET?        53220302
         BE    MSGSTRM             NO, PUT IN LINE               Y02669 53220602
         SPACE                                                          53220902
*********************************************************************** 53221202
*     LOOK FOR BOTTOM-MOST EMPTY AREA                                 * 53221502
*********************************************************************** 53221802
         SPACE                                                          53222102
SRCHAREA EQU   *                                                 Y02669 53222402
         SR    WORK4,WORK4                                       Y02669 53222702
         L     SACBBASE,DCMADSDS   GET POINTER TO FIRST SACB     Y02669 53223002
CONTSRCH EQU   *                                                        53223302
         TM    DCMASACB,DCMAUSE    DOES SACB DEFINE AN AREA?            53223602
         BNO   STATIC              NO, ANY STATIC DISPLAY TO OVERLAY    53223902
         TM    DCMAFLG1,DCMADISP   AREA CONTAIN DISPLAY?                53224202
         BO    FIRSTARE            YES, LOOK FOR ANOTHER AREA    Y02669 53224502
         TM    DCMADFLG,DCMADD     AREA RESERVED FOR TRACK?      Y02669 53224802
         BO    UPDATE              YES,LOOK AT NEXT              Y02669 53226902
         B     AFOUND              IF ONLY 1 AREA THIS WILL BE 0 Y02669 53227502
FIRSTARE EQU   *                                                        53227802
         TM    DCMADFLG,DCMADD     AREA RESERVED FOR TRACK?      Y02669 53228102
         BO    UPDATE              YES,LOOK AT NEXT              Y02669 53228402
         LTR   WORK4,WORK4         NO, FIRST DEFAULT AREA?       Y02669 53228702
         BZ    FIRST               YES                           Y02669 53229002
CHKNEXTA EQU   *                                                 Y02669 53229302
         CLC   DCMATIME(L'DCMATIME),DCMATIME-DCMACB(WORK4) NO    Y02669 53229602
         BH    UPDATE              IS THIS DISPLAY OLDER?               53229902
FIRST    EQU   *                                                        53230202
         LR    WORK4,SACBBASE      YES                                  53230502
UPDATE   EQU   *                                                        53230802
         ICM   SACBBASE,E7,DCMACBNX+1 POINT TO NEXT SACB         Y02669 53231102
         BNZ   CONTSRCH            CONTINUE SEARCH               Y02669 53231402
         SPACE                                                          53231702
*********************************************************************** 53232002
*     LOOK FOR OLDEST STATIC DISPLAY TO OVERLAY                  Y02669 53232302
*********************************************************************** 53233102
         SPACE                                                          53233502
STATIC   EQU   *                                                        53233902
         LTR   WORK4,WORK4         WAS ANY STATIC DISPLAY FOUND?        53235502
         BZ    MSGSTRM             NO, TRY TO PUT IN MESS STREAM Y02669 53235902
PUTINOLD EQU   *                                                        53236102
         LR    SACBBASE,WORK4      YES, BASE SACB FOR AREA WITH         53236302
*                                       OLDEST DISPLAY                  53236702
AFOUND   EQU   *                                                 Y02669 53237102
         MVC   XASDID(E1),DCMAID   PUT ID OF AREA FOUND IN XSA   Y02669 53237302
         B     D0803D              GO BUILD CSCB FOR DISPLAY     Y02669 53237502
MSGSTRM  EQU   *                                                        53237902
         TM    UCMDISP,UCMDISPE+UCMDISPF MSG ST OR FULL CAPABILITY?     53238302
         BZ    ERR921D             NO, BRANCH TO ERROR ROUTINE   Y02669 53238502
         MVI   XASDID,Z            INDICATE MSG STREAM IN XSA           53238702
         B     D0803D              EXIT                                 53239102
         EJECT                                                          53239502
*********************************************************************** 53239702
*                                                                     * 53239902
*                  STOPTR HANDLING                                    * 53240302
*   ERR - IEE311I PARAMETER MISSING - PT REQUIRES AN OPERAND   @YM2774P 53240502
*   ERR - IEE925I OPERAND FOR CRT ONLY - TARGET IS NON-CRT            * 53240702
*********************************************************************** 53240902
         SPACE  2                                                       53241102
STOPTR   EQU   *                   STOP TRACK COMMAND            Y02669 53241502
         TM    UCMDISP2,UCMDISPK   IS THIS SUBSYSTEM CONSOLE?  @Y02668P 53243503
         BO    ERR921E             YES, BRANCH FOR ERROR       @Y02668P 53243903
         ICM   REG1,E7,XAL+1       R1 PTR BUFFER BEGINNING     @YM2774P 53245903
         BZ    ERR311              PT MUST HAVE AN OPERAND     @YM2774P 53247903
         TM    UCMDISP,UCMDISPC    IS TARGET A CRT?              Y02669 53251403
         BNO   ERR925A             ERR-COMMAND VALID ONLY TO CRT Y02669 53253003
         CLI   XASDID,Z            AREA = Z (INLINE NOT IN AREA)?       53255003
         BE    ERR921D             YES - TRACK CAN'T BE INLINE   Y02669 53257003
         SPACE  2                                                       53259003
         L     RDCMBASE,UCMXB      GET ADDRESS OF RESIDENT DCM   Y02669 53261003
         CLI   XASDID,NULL         AREA NULL?                           53263003
         BE    FINDTRAR            YES, FIND AREA WITH TRACK     Y02669 53265003
         SPACE  2                                                       53267003
*********************************************************************** 53269803
*                                                                     * 53270303
*     SEE IF AREA SPECIFIED HAS SPECIFIED TRACK IN IT                 * 53272803
*  ERR - IEE921I NO TRACK TO STOP - AREA NOT DEFINED BY SACB          * 53275003
*********************************************************************** 53277003
         SPACE  2                                                       53279003
         TM    DCMADFLG,DCMADD     IS THERE A TRACK IN AREA?     Y02669 53281003
         BNO   ERR921C             NO,  BRANCH TO ERROR ROUTINE  Y02669 53283003
         B     PROCESPT            YES                           Y02669 53285003
         EJECT                                                          53286003
*********************************************************************** 53287403
*                                                                     * 53289003
*    LOOK FOR AREA CONTAINING SPECIFIED DYNAMIC DISPLAY               * 53291003
*                                                                     * 53293003
*  ERR - IEE921I NO TRACK TO STOP - NO AREA CONTAINS TRACK DISPLAY    * 53295003
*********************************************************************** 53297003
         SPACE  2                                                       53299003
FINDTRAR EQU   *                                                        53300003
         L     SACBBASE,DCMADSDS   GET FIRST SACB ADDRESS               53301003
CONTINU1 EQU   *                                                        53302003
         TM    DCMASACB,DCMAUSE    DOES SACB DEFINE AN ACTIVE AREA?     53303003
         BNO   ERR921C             NO,  BRANCH TO ERROR ROUTINE  Y02669 53304003
         TM    DCMADFLG,DCMADD     IS THERE A TRACK IN AREA?     Y02669 53305003
         BO    TRFOUND             YES, BRANCH TO STORE AREA ID  Y02669 53306003
         ICM   SACBBASE,E7,DCMACBNX+1 NO, IS THERE ANOTHER SACB?        53307003
         BZ    ERR921C             NO, NO AREA WITH TRACK        Y02669 53308003
         B     CONTINU1            YES, CONTINUE SEARCH                 53309003
TRFOUND  EQU   *                                                 Y02669 53310003
         MVC   XASDID(E1),DCMAID   PUT AREA ID IN XAS                   53311003
PROCESPT EQU   *                                                        53312003
         ST    SACBBASE,XAXSACB    PUT ADDRESS OF SACB IN XSA    Y02669 53313003
         B     D5503D              GO TO IEE5503D                Y02669 53328702
         EJECT                                                          53331102
*********************************************************************** 53331502
*                                                                     * 53331602
*        IN THE CASE OF A TRACK COMMAND, IF AN OUT-OF-LINE DISPLAY    * 53338402
*  IS REQUESTED, A SPECIFIED TARGET AREA (EITHER BY THE 'L' OPERAND   * 53342402
*  OR THE ROUTING CONTROL TABLE) IS CHECKED FOR AVAILABILITY.         * 53344402
*  IF NO AREA IS SPECIFIED, A DEFAULT AREA IS PROVIDED.               * 53346402
*  CERTAIN CONDITIONS ARE THEN SET UP AND APPROPIATE EXIT TAKEN.      * 53348402
*                                                                     * 53352102
*   ERR-IEE925I OPERAND FOR CRT ONLY - TRACK TO NON-CRT               * 53352502
*       IEE921I NEEDS DISPLAY AREA - TRACK TO AREA = Z (IN-LINE)      * 53352902
*                                    TARGET HAS NO DEFINED AREAS      * 53353302
*********************************************************************** 53354102
         SPACE 2                                                        53356102
TRACK    EQU   *                   TRACK COMMAND                        53375702
         TM    UCMDISP2,UCMDISPK   IS THIS SUBSYSTEM CONSOLE?  @Y02668P 53376103
         BO    ERR921E             YES, BRANCH CMD INVALID     @Y02668P 53376503
         TM    UCMDISP,UCMDISPC    IS TARGET CONSOLE A CRT?             53376902
         BZ    ERR925A             NO, BRANCH TO ERROR ROUTINE   Y02669 53396602
         CLI   XASDID,Z            IS AREA = Z?                         53424002
         BE    ERR921D             YES, ERR TR CAN'T GO INLINE   Y02669 53424402
         L     RDCMBASE,UCMXB      INSURE ADDRESSABILITY TO DCM  Y02669 53425402
         CLI   DCMTOPAR,E0         ANY AREAS DEFINED FOR TARGET? Y02669 53426402
         BE    ERR921D             NO, TR NEEDS DISPLAY AREA     Y02669 53428402
         SPACE                                                          53433902
         SR    WORK4,WORK4         INIT FOR BOTTOM-MOST          Y02669 53434302
         ST    SACBBASE,XAXSACB    SAVE SACB BASE OF 'A'         Y02669 53435902
         L     SACBBASE,DCMADSDS   GET POINTER TO FIRST SACB            53436302
CHKFORTR EQU   *                                                 Y02669 53436702
         TM    DCMADFLG,DCMADD     DOES THIS AREA HAVE TRACK?    Y02669 53436802
         BO    TRHERE              YES, BRANCH TO CHECK FURTHER  Y02669 53442602
         TM    DCMAFLG1,DCMADISP   IS THERE DISPLAY IN AREA    @YM4789P 53444602
         BO    NEXTAREA            YES,CHECK NEXT AREA         @YM4789P 53445002
         LTR   WORK4,WORK4         IS THIS AN EMPTY AREA       @YM4793P 53445602
         BNZ   NEXTAREA            NO CONTINUE SEARCH          @YM4793P 53446202
         LR    WORK4,SACBBASE      YES,EMPTY AREA FOR TRACK    @YM4789P 53447202
NEXTAREA EQU   *                                                        53449102
         ICM   SACBBASE,E7,DCMACBNX+1 BASE NEXT SACB             Y02669 53451702
         BZ    RESTBASE            NO MORE SACBS               @ZA29986 53452700
         TM    DCMASACB,DCMAUSE    SACB DEFINE ACTIVE AREA?    @ZA29986 53453300
         BO    CHKFORTR            YES, CONTINUE SEARCH        @ZA29986 53453900
         SPACE  2                                                       53455402
RESTBASE EQU   *                                                 Y02669 53455502
         CLI   XASDID,NULL        WAS AREA SPECIFIED IN COMMAND? Y02669 53456502
         BE    USEMPTY             NO, DEFAULT AVAILABLE?        Y02669 53457502
         L     SACBBASE,XAXSACB    USE 'A' FROM CMND OR DEFAULT  Y02669 53460902
         B     TRSETUP                                           Y02669 53463602
USEMPTY  EQU   *                                                        53464602
         LTR   WORK4,WORK4         IS THIS AREA EMPTY          @YM4789P 53476302
         BZ    INUSE               NO,DISPLAY IN AREA          @YM4789P 53478302
         LR    SACBBASE,WORK4      YES,AREA IS EMPTY           @YM4789P 53478502
         MVC   XASDID(E1),DCMAID   AREA ID IN THE SACB         @YM4789P 53478702
         B     TRSETUP                                         @YM4789P 53478902
INUSE    EQU   *                   DISPLAY IN AREA             @YM4789P 53479302
         L     SACBBASE,DCMADSDS                               @YM4789P 53479602
         MVC   XASDID(E1),DCMAID                               @YM4789P 53479902
         B     TRSETUP                                           Y02669 53480302
         EJECT                                                          53480802
*********************************************************************** 53481302
* SPECIFIED TR ALREADY ON TARGET CONSOLE.  THIS IS AN ERROR           * 53482302
*  ERR - IEE921I DISPLAY ALREADY EXISTS - HOLD FLAG ON                * 53483302
*********************************************************************** 53486302
         SPACE  2                                                       53487302
TRHERE   EQU   *                                                        53488302
         CLI   XASDID,NULL         WAS AN AREA SPECIFIED       @YM4793P 53489102
         BE    TRHERE1             NO, AREA OK                 @YM4793P 53489902
         C     SACBBASE,XAXSACB    IS TR IN AREA SPECIFIED     @YM4793P 53490702
         BNE   ERR921A             NO, ERROR                   @YM4793P 53491502
TRHERE1  EQU   *                                               @YM4793P 53492302
         TM    DCMADFLG,DCMAHOLD   YES, HOLD MODE FLAG ON?       Y02669 53493302
         BNO   TRSETUP             NO, SET UP FOR TRACK COMMAND  Y02669 53494302
         CLC   DCMATRCK,XAXMASK    YES, CHANGING OPTIONS?        Y02669 53495302
         BE    ERR921A             NO, ERROR - CAN'T GET OUT OF        X53496302
                                   HOLD MODE BY OPERATOR ISSUING TR     53497302
         SPACE 2                                                        53508102
*********************************************************************** 53510102
*  RETURN IF ONLY UPDATING ALREADY EXISTING TRACK DISPLAY             * 53510902
*  GOTO IEE0803D IF THIS IS THE INITIAL TRACK REQUEST                 * 53511502
*********************************************************************** 53512102
         SPACE 2                                                        53518002
TRSETUP  EQU   *                                                 Y02669 53520002
         OC    DCMATRCK(E1),XAXMASK  GET NEW OPTIONS FROM XSA    Y02669 53542002
         TM    DCMADFLG,DCMADD    TRACK ALREADY DEFINED IN AREA? Y02669 53544002
         BO    RETURN              YES, ALTER BITS AND RETURN    Y02669 53545702
         OI    DCMADFLG,DCMADD     RESERVE AREA FOR TRACK        Y02669 53547702
         MVC   DCMAUTME(E2),UDEFAULT SET DEFAULT TIME INTERVAL   Y02669 53548102
         LA    WORK4,DCMATECB      GET ADDRESS OF TRACK ECB      Y02669 53549702
         ST    WORK4,XAXSACB       PASS ADDRESS TO IEE0803D      Y02669 53549802
         B     D0803D              EXIT TO CREATE CSCB           Y02669 53550102
         EJECT                                                          53550502
*********************************************************************** 53746802
*                                                                     * 53747102
* FIND AND BASE UCM ENTRY SUBROUTINE                                  * 53747802
*    INPUT - REG1   - CONSOLE ID, RIGHT JUSTIFIED                     * 53748502
*                     (HIGH ORDER BYTES MUST BE ZERO)                 * 53749202
*    OUTPUT         - POINTER TO UCM ENTRY SPECIFIED BY CONSOLE       * 53749902
*                     ID IN REGISTER UCMEBASE                         * 53750602
*    REGISTER USAGE - DESTROYS CONTENTS OF FOLLOWING REGS:            * 53751302
*                     REG0, REG1, UCMEBASE                            * 53752002
*                     R15 IS RETURN REGISTER                          * 53752702
*                                                                     * 53753402
*********************************************************************** 53754102
         SPACE 2                                                        53754802
FINDUCME EQU   *                                                        53755502
         L     UCMEBASE,UCMVEA     POINT TO FIRST ENTRY IN UCM          53756202
         BCTR  REG1,E0             SUBTRACT ONE FROM CONSOLE ID         53756902
         M     REG0,UCMVEZ         MULTIPLY ENTRY SIZE BY REDUCED ID    53757602
         AR    UCMEBASE,REG1       POINT TO DESIRED UCM ENTRY           53758302
         BR    R15                 RETURN TO MAIN LINE                  53759002
         EJECT                                                          53759702
*********************************************************************** 53760402
*                                                                     * 53761102
* FIND AND BASE SACB SUBROUTINE                                       * 53761802
*    GIVEN A PARTICULAR CRT CONSOLE AND A ONE CHARACTER AREA ID       * 53762502
* THIS SUBROUTINE FINDS AND BASES THE SCREEN AREA CONTROL BLOCK       * 53763202
* (SACB) WHICH MATCHES THAT ID.  IF NONE IS FOUND, A ZERO IS          * 53763902
* RETURNED AS THE BASE.                                               * 53764602
*    INPUT -  XASDID   - ONE CHARACTER AREA ID (POINTED TO BY REG2)   * 53765302
*             UCMEBASE - ADDRESS OF UCM ENTRY OF A CRT CONSOLE        * 53766702
*    OUTPUT - SACBBASE - ADDRESS OF SACB WITH MATCHING ID             * 53767402
*                        (ZERO IF NO MATCH)                           * 53768102
*    REGISTER USAGE    - DESTROYS CONTENTS OF FOLLOWING REGS:         * 53768802
*                         SACBBASE, RDCMBASE                          * 53769502
*                         R15 IS RETURN REGISTER                      * 53770202
*                                                                     * 53770902
*********************************************************************** 53771602
         SPACE 2                                                        53772302
FINDSACB EQU   *                                                        53773002
         L     RDCMBASE,UCMXB      GET RESIDENT DCM ADDRESS             53774402
         ICM   SACBBASE,E7,DCMADSDS+1   GET FIRST SACB ADDRESS   Y02669 53775102
         BZ    SACBEXIT                                          Y02669 53775402
CONTINUE EQU   *                                                        53775802
         TM    DCMASACB,DCMAUSE    DOES SACB DEFINE AN AREA?            53777902
         BNO   ENDOSACB            NO, BRANCH TO RETURN                 53778602
         CLC   XASDID,DCMAID       COMPARE PASSED ID AND SACB ID Y02669 53779302
         BCR   EQ,R15              EQUAL? RETURN TO MAIN LINE           53780702
         ICM   SACBBASE,E7,DCMACBNX+1 NOT EQUAL, GET NEXT SACB   Y02669 53781402
         BZ    SACBEXIT            IF NO MORE SACB'S, RETURN     Y02669 53781902
         B     CONTINUE            CONTINUE SEARCH                      53782102
ENDOSACB EQU   *                                                        53782802
         SR    SACBBASE,SACBBASE   INDICATE NO SACB MATCH FOUND         53783502
SACBEXIT EQU   *                                                 Y02669 53783802
         BR    R15                 RETURN TO MAIN LINE                  53784202
         EJECT                                                          53786202
*********************************************************************** 53786502
*                                                                     * 53786802
*                   RELEASE CMS AND LOCAL LOCKS SUBROUTINE            * 53787102
*                                                                     * 53787402
*********************************************************************** 53787702
LOCKSOFF EQU   *                                                        53788202
         STM   RCTBASE,RETURN14,XASAVLOC  SAVE REGS FOR SETLOCK  Y02651 53790202
         SETLOCK RELEASE,TYPE=CMS,RELATED=(LOCKSET)                     53790302
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LOCKSET)                   53790402
         LM    RCTBASE,RETURN14,XASAVLOC  RESTORE REGS AFTER     Y02651 53790502
         NI    XASSDS,XFF-XASSDS5       INDICATE LOCKS NOT HELD  Y02651 53790802
         BR    R15                        RETURN TO MAIN LINE    Y02651 53791102
         EJECT                                                          53791602
*********************************************************************** 53797002
*                                                                     * 53797602
*                      SPECIAL JES2 INTERFACE                         * 53798202
*                                                                     * 53798802
*              SVC 34 WILL RETURN TO THE ADDRESS PROVIDED      @YM7238P 53799002
*              IN REGISTER 14. AT THAT TIME, REGISTER 15       @YM7238P 53799202
*              WILL CONTAIN ONE OF THE FOLLOWING RETURN        @YM7238P 53799402
*              CODES                                           @YM7238P 53800302
*                 0   REQUESTED AREA NOT IN USE                @YM7238P 53802402
*                 4   AREA IN USE BY STATIC DISPLAY            @YM7238P 53802702
*                 8   AREA IN USE BY TRACK;DISPLAY MAY NOT     @YM7238P 53803002
*                     BE OVERLAID                              @YM7238P 53803302
*                 12  SPECIFIED CONSOLE NOT SYSGENED, NOT      @YM7238P 53803602
*                     ACTIVE OR NOT A TARGET FOR STATUS        @YM7238P 53803802
*                     DISPLAYS                                 @YM7238P 53804002
*                 16  REQUESTED AREA NOT DEFINED ON SPECIFIED  @YM7238P 53804202
*                     CONSOLE.                                 @YM7238P 53804502
*                                                                     * 53804802
*********************************************************************** 53805402
JES2CODE EQU   *                                                 Y02669 53805602
         OI    XASSDS,XASSDS5          INDICATE LOCKS HELD     @YM4796P 53805802
         L     UCMEBASE,UCMVEL         BASE LAST UCM ENTRY       Y02669 53806002
         CLC   XASCID(E1),UCMID        ID HIGHER THAN HIGHEST    Y02669 53806302
*                                      VALID CONSOLE ID?         Y02669 53806602
         BNH   VALIDCON                NO, CONSOLE ID IS VALID   Y02669 53807802
         LA    WORK4,BADCONSL          YES, CONSOLE ID TOO HIGH  Y02669 53808402
         B     JES2EXIT                RETURN WITH 12 ERROR CODE Y02669 53809002
VALIDCON EQU   *                                                 Y02669 53809602
         SR    REG1,REG1                                         Y02669 53810802
         IC    REG1,XASCID             GET TARGET CONSOLE ID     Y02669 53811202
         BAL   R15,FINDUCME            FIND ITS UCME             Y02669 53812602
         TM    UCMATR,UCMUF            IS CONSOLE ACTIVE?        Y02669 53813202
         BO    ACTIVEID                YES, CONSOLE IS ACTIVE    Y02669 53813502
         LA    WORK4,BADCONSL          NO, CONSOLE NOT ACTIVE    Y02669 53814502
         B     JES2EXIT                RETURN WITH 12 ERROR CODE Y02669 53815502
ACTIVEID EQU   *                                                 Y02669 53816502
         TM    UCMDISP,UCMDISPC        IS TARGET CONSOLE A CRT?  Y02669 53817502
         BO    CRTCONSL                YES                       Y02669 53818502
         B     OKAREA                  NO, RETURN WITH 0 RETURN  Y02669 53819502
*                                      CODE                      Y02669 53820502
CRTCONSL EQU   *                                                 Y02669 53821502
         CLI   XASDID,Z               IS THE AREA IN LINE Z    @YM7238P 53830602
         BNE   NOTZ                   YES,CHECK TYPE OF CONSL  @YM7238P 53831002
         TM    UCMDISP,UCMDISPF       IS THIS AN MS CONSOLE    @YM7238P 53831402
         BO    OKAREA                 YES,BRANCH Z IS VALID    @YM7238P 53831802
         TM    UCMDISP,UCMDISPE       IS THIS AN FC CONSOLE    @YM7238P 53832202
         BO    FCTEST1                YES,BRANCH CK IN-LINE    @YM7238P 53834202
         B     RTCODE16               BRANCH SD CONSL INVALID  @YM7238P 53836802
NOTZ     EQU   *                                               @YM7238P 53838802
         TM    UCMDISP,UCMDISPG       IS THIS SD CONSOLE       @YM7238P 53839402
         BO    OKCONSL                YES,BR CK FOR VALID AREA @YM7238P 53840002
         TM    UCMDISP,UCMDISPE       IS THIS FC CONSOLE       @YM7238P 53840602
         BO    FCTEST2                YES,BR CK CMD SOURCE     @YM7238P 53841202
         B     RTCODE16               BRANCH MS CONSL INVALID  @YM7238P 53841802
FCTEST1  CLC   XASCID(E1),XAU         DOES SOURCE=TARGET CONSL @YM7238P 53842402
         BE    OKAREA                 YES,BRANCH IN-LINE VALID @YM7238P 53843002
         B     RTCODE12               NO,CAN NOT ROUTE TO FC   @YM7238P 53843202
FCTEST2  CLC   XASCID(E1),XAU         DOES SOURCE=TARGET CONSL @YM7238P 53843402
         BE    OKCONSL                YES,BR OUT-OF-LINE VALID @YM7238P 53843602
RTCODE12 EQU   *                                               @YM7238P 53843802
         LA    WORK4,BADCONSL         RETURN CODE 12           @YM7238P 53844002
         B     JES2EXIT                                        @YM7238P 53844202
OKCONSL  EQU   *                                                 Y02669 53845002
         BAL   R15,FINDSACB            FIND AREA'S SACB          Y02669 53845502
         LTR   SACBBASE,SACBBASE       IS SPECIFIED AREA DEFINED?Y02669 53846002
         BNZ   AREAIS                  YES, AREA EXISTS ON       Y02669 53847002
*                                      CONSOLE                   Y02669 53849902
RTCODE16 EQU   *                                               @YM7238P 53850902
         LA    WORK4,BADAREA           NO, AREA NOT DEFINED TO   Y02669 53852802
*                                      CRT                       Y02669 53854802
         B     JES2EXIT                RETURN WITH 16 ERROR CODE Y02669 53857702
AREAIS   EQU   *                                                 Y02669 53858702
         TM    DCMADFLG,DCMADD         TRACK ALREADY IN AREA?    Y02669 53862602
         BZ    NOTRACK                 NO                        Y02669 53864602
         LA    WORK4,TRINAREA          YES, AREA CONTAINS TRACK  Y02669 53867502
         B     JES2EXIT                RETURN WITH 8 ERROR CODE  Y02669 53869502
NOTRACK  EQU   *                                                 Y02669 53872402
         TM    DCMAFLG1,DCMADISP       AREA CONTAIN DISPLAY?     Y02669 53874402
         BZ    OKAREA                  NO                        Y02669 53877302
         LA    WORK4,AREANUSE          YES, AREA CONTAINS        Y02669 53879302
*                                      ANOTHER DISPLAY           Y02669 53882202
         B     JES2EXIT                RETURN WITH 4 ERROR CODE  Y02669 53886202
OKAREA   EQU   *                                                 Y02669 53888202
         LA    WORK4,OKCCA             CONSOLE & AREA VALID      Y02669 53890202
JES2EXIT EQU   *                                                 Y02669 53892202
         BAL   R15,LOCKSOFF            HAVE LOCKS RELEASED       Y02669 53896202
         LR    R15,WORK4               LOAD RETURN CODE          Y02669 53898202
         LM    REG0,RETURN14,XASAVSTD  RESTORE JES2 REGISTERS    Y02669 53900202
         BR    RETURN14                RETURN TO JES2            Y02669 53904202
         EJECT                                                          53914203
*********************************************************************** 53916203
*                                                                     * 53917203
*                             EXITS                                   * 53919303
*                                                                     * 53923303
*********************************************************************** 53925303
RETURN   EQU   *                                                 Y02669 53927303
         BAL   R15,LOCKSOFF       RELEASE LOCKS HELD             Y02651 53929303
         BR    RETURN14           RETURN TO SYSTEM               Y02669 53931303
         SPACE 2                                                        53935303
D5503D   EQU   *                                                 Y02669 53937303
         L     R15,VCON5503       EXIT TO 2ND LOAD OF STOPTR     Y02669 53939303
         BR    R15                                               Y02669 53941303
         SPACE 2                                                        53943303
D2903D   EQU   *                                                 Y02669 53946303
         L     R15,VCON2903       EXIT TO DISPLAY REQUEST MOD    Y02669 53949303
         BR    R15                                               Y02669 53951303
         SPACE 2                                                        53953303
D6703D   EQU   *                                                 Y02669 53956403
         L     R15,VCON6703       EXIT TO HANDLE CONTROL COMMAND Y02669 53958403
         BR    R15                FOR GRAPHICS CONSOLES          Y02669 53960403
         SPACE 2                                                        53960604
D9403D   EQU   *                                               @Z40LPTA 53960804
         MVI   XAN,D              RE-SET TO DISPLAY VERB       @Z40LPTA 53961204
         L     R15,VCON9403       EXIT TO MSS CMND PROCESSING  @Z40LPTA 53961604
         BR    R15                                             @Z40LPTA 53962004
         SPACE 2                                                        53962403
D0803D   EQU   *                                                        53966403
         BAL   R15,LOCKSOFF       RELEASE LOCKS HELD             Y02651 53968403
         OI    XASSDS,XASSDS1     INDICATE STATUS DISPLAY-MEANS  Y02669 53970403
*                                 SOMETHING IN XASCID, XASDID    Y02669 53972403
         CLI   XAN,DR             IF THIS IS A DISPLAY REQUEST   Y02669 53974403
         BE    D2903D             GO TO IEE2903D, ELSE           Y02669 53974904
         CLI   XAN,D38            THIS A D 3850 COMMAND?       @Z40LPTA 53975404
         BE    D9403D             GO TO IEE9403D               @Z40LPTA 53976404
         L     R15,VCON0803       GO BUILD CSCB                  Y02669 53980403
         BR    R15                                               Y02669 53982403
         EJECT                                                          53984403
*********************************************************************** 53986403
*                                                                     * 53988403
*                          ERROR CODES                                * 53993502
*   XAE = MAJOR ERROR CODE FOR IEE5603D                               * 54030602
*   XASTSAVE = MINOR CODE FOR IEE5903D                                * 54067702
*   XASOPTR (XASTSAVE+1) = OPERAND POINTER FOR IEE5603D & IEE5903D    * 54104802
*                                                                     * 54141902
*********************************************************************** 54179002
         SPACE 2                                                        54216102
*********************************************************************** 54218102
*              IEE156I INVALID OPERAND                                * 54226102
*********************************************************************** 54236102
ERR156A  EQU   *                                                        54246102
         CLC   E0(E6,REG1),LISTC   ADDITIONAL BAD OPERAND?       YM1920 54246402
         BNE   BADAOP              NO, LIST NOT SPECIFIED        YM1920 54246702
         LA    REG1,E5(REG1)       YES, POINT TO INFO AFTER LIST YM1920 54247102
BADAOP   EQU   *                                                 YM1920 54247602
         LR    OPPTR,REG1          SET UP POINTER                Y02669 54248102
ERR156   EQU   *                                                 Y02669 54253202
         MVI   XAE,MSG156          MSG CODE-IEE156I INVALID OP   Y02669 54290302
         ST    OPPTR,XASTSAVE      SAVE POINTER TO BAD OPERAND   Y02669 54300302
         B     D5603D              BRANCH TO ERROR EXIT          Y02669 54327402
         SPACE                                                          54364502
*********************************************************************** 54366502
*              IEE345I AUTHORITY INVALID                              * 54374502
*********************************************************************** 54384502
ERR345   EQU   *                                                 Y02669 54401602
         MVI   XAE,MSG345          MSG CODE-IEE345 AUTH INVALID  Y02669 54438702
         B     STOREOP             BRANCH TO ERROR EXIT          Y02669 54475802
         SPACE                                                          54512902
*********************************************************************** 54514902
*              IEE921I CM OP REJECTED                                 * 54522902
*                      DISPLAY ALREADY EXISTS                         * 54526902
*                      DISPLAY AREA BUSY                              * 54530902
*                      NO TRACK TO STOP                               * 54534902
*                      NEEDS DISPLAY AREA                             * 54538902
*                      SUBSYSTEM CONSOLE                       @Y02668P 54542903
*********************************************************************** 54546902
ERR921A  EQU   *                                                        54550002
         MVI   XASTSAVE,MSG921A    2ND CODE-DISP ALREADY EXISTS  Y02669 54560002
         B     ERR921              BRANCH TO GET MAJOR CODE      Y02669 54570002
         SPACE                                                          54572002
ERR921B  EQU   *                                                 Y02669 54580002
         MVI   XASTSAVE,MSG921B    2ND CODE-DISPLAY AREA BUSY    Y02669 54590002
         B     ERR921              BRANCH TO GET MAJOR CODE      Y02669 54592002
         SPACE                                                          54592402
ERR921C  EQU   *                                                 Y02669 54594002
         MVI   XASTSAVE,MSG921C    2ND CODE-NO TRACK TO STOP     Y02669 54596002
         B     ERR921              BRANCH TO GET MAJOR CODE      Y02669 54598002
ERR921E  EQU   *                                               @Y02668P 54598103
         MVI   XASTSAVE,MSG921E    2ND CODE-CC SUBSYSTEM       @Y02668P 54599203
         B     ERR921              CONSOLE                     @Y02668P 54599903
         SPACE                                                          54600903
ERR921D  EQU   *                                                 Y02669 54601903
         MVI   XASTSAVE,MSG921D    2ND CODE-NEEDS DISPLAY AREA   Y02669 54602903
ERR921   EQU   *                                                 Y02669 54603903
         MVC   XASOPTR(E3),XAL+E1  MOVE OPERAND POINTER IN       Y02669 54604903
         MVI   XAE,MSG921          MSG CODE-IEE921I CM OP REJ    Y02669 54605903
         B     D5603D              BRANCH TO ERROR EXIT          Y02669 54606903
         SPACE                                                          54607903
*********************************************************************** 54609902
*              IEE925I OPERAND                                        * 54611002
*                      FOR CRT ONLY                                   * 54616002
*********************************************************************** 54621402
ERR925A  EQU   *                                                 Y02669 54622102
         MVC   XASOPTR(E3),XAL+E1  MOVE OPERAND POINTER IN       Y02669 54632102
         MVI   XASTSAVE,MSG925A    2ND CODE-FOR CRT ONLY         Y02669 54633202
         MVI   XAE,MSG925          MSG CODE-IEE925I OPERAND      Y02669 54643202
         B     D5603D                                            Y02669 54653202
         SPACE                                                          54663202
*********************************************************************** 54666702
*              IEE926I L OPERAND INVALID                              * 54668702
*                      DYNAMIC DISPLAY IN AREA                        * 54669702
*********************************************************************** 54670802
ERR926D  EQU   *                                                 Y02669 54670902
         MVI   XASTSAVE,MSG926D    2ND CODE-DYNAMIC DISP IN AREA Y02669 54671002
         MVI   XAE,MSG926          MSG CODE-IEE926I L OP INVALID Y02669 54676602
         B     STOREOP                                           Y02669 54682002
         SPACE                                                          54682402
*********************************************************************** 54682702
*              IEE926I L OPERAND INVALID                              * 54688302
*                      CCA NOT AN AREA                                * 54693302
*                      CC NOT A CONSOLE                               * 54698302
*                      CC FULL CAPABILITY                             * 54703302
*                      CC SUBSYSTEM CONSOLE                    @Y02668P 54706303
*********************************************************************** 54710702
ERR926A  EQU   *                                                 Y02669 54716302
         MVI   XASTSAVE,MSG926A    2ND CODE-CCA NOT AN AREA      Y02669 54721902
         B     ERR926              BRANCH TO GET MAJOR CODE      Y02669 54727502
         SPACE                                                          54733102
ERR926B  EQU   *                                                 Y02669 54738702
         MVI   XASTSAVE,MSG926B    2ND CODE-CC NOT A CONSOLE     Y02669 54744302
         BCTR  OPPTR,E0            SET CURSOR POINTER TO         Y02669 54746302
         BCTR  OPPTR,E0            BEGINNING OF OPERAND          Y02669 54748302
         B     ERR926              BRANCH TO GET MAJOR CODE      Y02669 54749902
ERR926E  EQU   *                                               @Y02668P 54750803
         L     OPPTR,XASTSAVE      CURSOR PTR AFTER L=         @Y02668P 54751703
         MVI   XASTSAVE,MSG926E    2ND-CODE-CC OR CCA          @Y02668PX54752603
                                   SUBSYSTEM CONSOLE           @Y02668P 54753503
         B     ERR926                                          @Y02668P 54754403
         SPACE                                                          54755502
ERR926C  EQU   *                                                 Y02669 54761102
         MVI   XASTSAVE,MSG926C    2ND CODE-CC FULL CAPABILITY   Y02669 54766702
ERR926   EQU   *                                                 Y02669 54816702
         MVI   XAE,MSG926          MSG CODE-IEE926I L OP INVALID Y02669 54866702
         B     STOREOP                                           Y02669 54867102
         SPACE                                                          54868702
*********************************************************************** 54876702
*              IEE927I REQUEST AMBIGIOUS                         YM1557 54886702
*                      SPECIFY L OPERAND                         YM1557 54896702
*********************************************************************** 54906702
ERR927   EQU   *                                                 YM1557 54908702
         MVI   XASTSAVE,MSG927A    2ND CODE- SPECIFY L OPERAND   YM1557 54910702
         MVI   XAE,MSG927          MSG CODE-IEE927I REQUEST      YM1557 54912702
         BCTR  OPPTR,E0            POINT INVALID OP              Y02669 54913302
         BCTR  OPPTR,E0            POINTER TO L                  Y02669 54913902
STOREOP  EQU   *                                                 Y02669 54914702
         STCM  OPPTR,E7,XASOPTR    SAVE CURSOR POINTER           Y02669 54915102
         SPACE 3                                                        54916702
*********************************************************************** 54966702
*                                                                     * 55016702
*                         ERROR EXITS                                 * 55066702
*                                                                     * 55116702
*********************************************************************** 55166702
D5603D   EQU   *                                                 Y02669 55216702
         L     R15,VCON5603        GET ADDR OF MSG MOD IEE5603D  Y02669 55266702
         BR    R15                                               Y02669 55316702
         SPACE  2                                                       55366702
ERR305   EQU   *                                                 YM1917 55416702
         MVI   XAE,MSG305          MSG CODE-IEE305I INVALID CMD  YM1917 55417702
         B     D0503D                                            YM1917 55418702
         SPACE                                                          55419702
ERR311   EQU   *                                                 YM1917 55420702
         MVI   XAE,MSG311          MSG CODE-IEE311I PARM MISSING YM1917 55421702
D0503D   EQU   *                                                 YM1917 55422702
         BAL   R15,LOCKSOFF        RELEASE LOCKS HELD            YM1917 55426702
         L     R15,VCON0503        BRANCH TO IEE0503D TO ISSUE   YM1917 55516702
         BR    R15                                               YM1917 56516702
         EJECT                                                          58800001
*********************************************************************** 58900001
*                                                                     * 59000001
*                             CONSTANTS                               * 59100001
*                                                                     * 59200001
*********************************************************************** 59300001
         SPACE 2                                                        59400001
ZERO     DC    H'0'                CONSTANT                      Y02669 59500002
ZEROES   DC    F'0'                CONSTANT                      Y02669 59510002
C1       DC    X'01'                                             Y02669 59550002
C2       DC    H'2'                CONSTANT                    @YM5459P 59620002
C3       DC    H'3'                CONSTANT                             59700002
C4       DC    H'4'                                                     59750002
F0F0     DC    C'00'               INVALID CONSOLE ID COMPARE    Y02669 59800002
UDEFAULT DC    H'0030'             UTME DEFAULT OF 30 SECONDS    Y02669 59850002
CONSOLES DC    C'CONSOLES'         CONSOLES OPERAND FOR COMPARE         60000001
DUMP     DC    C'DUMP'             DUMP OPERAND FOR COMPARE    @G33CPMR 60050033
DMN      DC    C'DMN'              DMN OPERAND FOR COMPARE     @G33CPMR 60070033
CCOMMAK  DC    C'C,K'              C,K OPERAND FOR COMPARE       YM1916 60100002
LEQUALS  DC    C'L='               INPUT FOR IEEBUFSC            Y02669 60250002
LIST     DC    C',LIST '           COMPARE FOR LIST OPERAND      Y02669 60254002
LISTC    DC    C',LIST,'           COMPARE FOR ADDITIONAL OPER   YM1920 60256002
JUSTL    DC    C',L '              COMPARE FOR SHORT L FOR LIST  Y02669 60258002
JOCHAR   DC    C'JO'               COMPARE FOR BEGINNING OF JOBS Y02669 60264002
DCBLANK  DC    C'C '               C OPERAND FOR D CONSOLES     @YM4791 60274002
CDCHAR   DC    C'C,D'              COMPARE FOR D C,D           @Y02668P 60284003
NCCHAR   DC    C'N,'               COMPARE FOR K N,PFK         @ZA12152 60292033
         SPACE                                                          60300001
*********************************************************************** 60350002
*                                                                     * 60360002
*                     MODULE NAMES FOR BRANCHES                       * 60370002
*                                                                     * 60380002
*********************************************************************** 60390002
         SPACE  2                                                       60440002
VCON2903 DC    V(IEE2903D)         DISPLAY REQUESTS              Y02669 60600002
VCON6703 DC    V(IEE6703D)         CONTROL COMMAND - GRAPHICS    Y02669 60610002
VCON5603 DC    V(IEE5603D)         ROUTING MESSAGE MODULE        Y02669 61000002
VCON0803 DC    V(IEE0803D)         CSCB CREATION ROUTINE         Y02669 61060002
VCON5503 DC    V(IEE5503D)         STOPTR HANDLER, SECOND LOAD   Y02669 61080002
VCON0503 DC    V(IEE0503D)         SVC 34 MESSAGE MODULE         Y02669 61082002
VCON9403 DC    V(IEE9403D)         MSS INTERFACE MODULE        @Z40LPTA 61086004
         SPACE  2                                                       61090002
*********************************************************************** 61130002
*                                                                     * 61180002
*                        MAINTAINANCE AREA                            * 61230002
*                                                                     * 61280002
*********************************************************************** 61330002
         SPACE                                                          61380002
PATCH    DC    5CL25'** IEE7503D PATCH AREA **'                @ZA29986 61430000
         EJECT                                                          61480000
         IEFPTRS                                                        64430003
         EJECT                                                          67500001
DXSA     DSECT                                                          67600001
         IEEXSA                                                         67700001
         EJECT                                                          69500001
         IEERDCM                                                        69700002
         EJECT                                                          69800001
DRCT     DSECT                                                          69900001
         IEECVMAP RCT                                                   70000001
         EJECT                                                          70100001
         IEECUCM FORMAT=NEW                                             70300002
         EJECT                                                          70400001
DCVT     DSECT                                                          70500001
         CVT                                                            70600001
         EJECT                                                          71150002
         IHAPSA                                                         71200002
         END                                                            71250002
