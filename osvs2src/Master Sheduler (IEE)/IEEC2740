         TITLE 'IEEC2740 - BTAM CONSOLE PROCESSOR FOR THE 2740 '        00200000
IEEC2740 CSECT                                                          00250000
         ENTRY IGCXX07B                                                 00300000
*********************************************************************** 00350000
*                                                                       00400000
* MODULE NAME:                                                          00450000
*    IEEC2740                                                           00500000
*                                                                       00550000
* DESCRIPTIVE NAME:                                                     00600000
*    BTAM CONSOLE PROCESSOR FOR THE 2740                                00650000
*                                                                       00700000
* COPYRIGHT:                                                            00750000
*    NONE                                                               00800000
*                                                                       00850000
* FUCTION:                                                              00900000
*    PERFORM THE BASIC FUNCTIONS FOR A 2740 IN A MULTIPLE CONSOLE       00950000
*    ENVIRONMENT:                                                       01000000
*        OPEN                                                           01050000
*        WRITE                                                          01100000
*        READ                                                           01150000
*        CLOSE                                                          01200000
*                                                                       01250000
* NOTES:                                                                01300000
*    DEPENDENCIES:                                                      01350000
*        THIS MODULE HAS CPU MODEL DEPENDENT TIMING LOOPS.              01400000
*    RESTRICTIONS:                                                      01450000
*        THIS MODULE IS FOR A 2740 CONSOLE IN MCS ONLY.                 01500000
*    REGISTER CONVENTIONS:                                              01550000
*        SEE 'REGISTER DEFINITION' BELOW.                               01600000
*    NOTES:                                                             01650000
*        THIS MODULE HAS HARD CODED MODEL CONTROL BLOCKS.               01700000
*                                                                       01750000
* PATCH LABEL:                                                          01800000
*    PACHAREA (420 BYTES)                                               01850000
*                                                                       01900000
* MODULE TYPE:                                                          01950000
*    PROCEDURE                                                          02000000
*    PROCESSOR:                                                         02050000
*        BAL                                                            02100000
*    MODULE SIZE:                                                       02150000
*        4272 BYTES                                                     02200000
*    ATTRIBUTES:                                                        02250000
*        REENTRANT, ENABLED, KEY 0, SUPERVISOR STATE, LOCAL AND         02300000
*        CMS LOCKS HELD.                                                02350000
*                                                                       02400000
* ENTRY POINT:                                                          02450000
*    IEEC2740                                                           02500000
*    IGCXX07B                                                           02550000
*    PURPOSE:                                                           02600000
*        SEE 'FUNCTION'                                                 02650000
*    LINKAGE:                                                           02700000
*        FROM THE COMMUNICATIONS TASK VIA SVC 72                        02750000
*    INPUT:                                                             02800000
*        REG 1 = ADDRESS OF CXSA                                        02850000
*    OUTPUT:                                                            02900000
*        FOR OPEN                                                       02950000
*            A DEB IS ADDED TO THE DEB CHAIN OF THE COMM TASK TCB.      03000000
*            THE UCM ENTRY AND ITS CONTROL BLOCKS (DEB,DCB,ETC.)        03050000
*            ARE INITIALIZED FOR THE 2740.                              03100000
*            THE EIL (EVENT INDICATOR LIST) IS MODIFIED TO POINT TO AN  03150000
*            ECB FOR THE 2740.                                          03200000
*            BTAM MODULES ARE LOADED, IGG019MA, IGG019MB, AND IGG019M0, 03250000
*            AND IGG019MR.                                              03300000
*            THE LINE TO THE 2740 IS INITIALIZED USING EXCP.            03350000
*        FOR WRITE                                                      03400000
*            IF THE LINE TO THE 2740 HAS BEEN 'PREPARED' FOR            03450000
*            A PREVIOUS 'READ', IT IS RESET USING 'HALT I/O'.           03500000
*            A MESSAGE IS FOUND ON THE OUTPUT QUEUE, TRANSLATED         03550000
*            TO 2740 CODE, AND SENT TO THE 2740 USING THE BTAM          03600000
*            ROUTINE 'IGG019MA'.                                        03650000
*        FOR READ                                                       03700000
*            THE LINE TO THE 2740 IS 'PREPARED' FOR INPUT.              03750000
*            WHEN THE COMPLETE MESSAGE IS RECEIVED, IT IS               03800000
*            TRANSLATED TO EBCDIC AND SENT TO SVC 34.                   03850000
*        FOR CLOSE                                                      03900000
*            ALL OUTSTANDING MESSAGES ARE SENT.                         03950000
*            ALL OUTSTANDING REPLIES ARE RECEIVED.                      04000000
*            THE UCM ENTRY AND ITS CONTROL BLOCKS ARE DE-INITIALIZED.   04050000
*            THE DEB IS REMOVED FROM THE DEB CHAIN OF THE COMM          04100000
*            TASK'S TCB.                                                04150000
*            THE UCB IS SET SO IT CAN BE ALLOCATED TO ANOTHER           04200000
*            TASK IF REQUESTED.                                         04250000
*            THE BTAM MODULES ARE DELETED.                              04300000
*                                                                       04350000
* EXITS-NORMAL:                                                         04400000
*    RETURN VIA BR REG 14                                               04450000
*                                                                       04500000
* EXITS-ERROR:                                                          04550000
*    TO CONSOLE SWITCH BY BRANCH                                        04600000
*                                                                       04650000
* EXTERNAL REFERENCES:                                                  04700000
*    ROUTINES:                                                          04750000
*        IGG019MA (BTAM 'READ/WRITE')                                   04800000
*        SVC 34 (SYSTEM COMMAND HANDLER)                                04850000
*        SVC 16 (IOS PURGE I/O ROUTINE)                                 04900000
*        SVC 10 (GETMAIN/FREEMAIN)                                      04950000
*        SVC 8 (LOAD)                                                   05000000
*        SVC 9 (DELETE)                                                 05050000
*        SVC 43 (CIRB)                                                  05100000
*    DATA AREAS:                                                        05150000
*        ASMTRTAB - TO GENERATE TRANSLATE TABLES FOR 2740               05200000
*            INPUT AND OUTPUT.                                          05250000
*    CONTROL BLOCKS:                                                    05300000
*        DCB   (MAPPED BY DCBD)                                         05350000
*        DECB  (MAPPED BY IHADECB)                                      05400000
*        DEB   (MAPPED BY IEZDEB)                                       05450000
*        UCM   (MAPPED BY IEECUCM)                                      05500000
*        WQE   (MAPPED BY IHAWQE)                                       05550000
*        TCB   (MAPPED BY IKJTCB)                                       05600000
*        UCB   (MAPPED BY IEFUCBOB)                                     05650000
*        CQE   (MAPPED BY IHACTM)                                       05700000
*        CXSA  (MAPPED BY IHACTM)                                       05750000
*        IOB   (MAPPED BY IEZIOB)                                       05800000
*        IQE   (MAPPED BY IHAIQE)                                       05850000
*        IRB   (MAPPED BY IKJRB)                                        05900000
*        CVT PREFIX                                                     05950000
*                                                                       06000000
* TABLES AND WORKAREAS:                                                 06050000
*    DYNAMICALLY GOTTEN BUFFERS FOR READ AND WRITE DATA AREAS           06100000
*    DYNAMICALLY GOTTEN BUFFERS FOR I/O CONTROL BLOCKS                  06150000
*                                                                       06200000
* MACROS:                                                               06250000
*    GETMAIN                                                            06300000
*    LOAD                                                               06350000
*    CIRB                                                               06400000
*    WRITE                                                              06450000
*    NIL                                                                06500000
*    DELETE                                                             06550000
*    FREEMAIN                                                           06600000
*    READ                                                               06650000
*    SETLOCK                                                            06700000
*                                                                       06750000
* CHANGE ACTIVITY:                                                      06800000
*    YA01058  (IN BASE)                                                 06850000
*    YA01059  (IN BASE)                                                 06900000
*    YA01063  (IN BASE)                                                 06950000
*    YA01247  (IN BASE)                                                 07000000
*    YA00837  (IN BASE)                                                 07050000
*    YM02593  (9/25/73)                                                 07100000
*    YM04057  (10/1/73)                                                 07150000
*    YM04091  (11/7/73)                                                 07200000
*    YA02125  (11/7/73)                                                 07250000
*    YA02443  (11/7/73)                                                 07300000
*    YA02444  (COVERED BY YM04057 AND YM04091)                          07350000
*    YA02445  (11/7/73)                                                 07400000
*    YM04095  (11/15/73)                                                07450000
*    YM04096  (11/15/73)                                                07500000
*    YM05650  (2/7/74)                                                  07550000
*    YM05695  (2/28/74)                                                 07600000
*    YM07708  (3/26/74)                                                 07610000
*    ZA00515  (7/02/74)                                                 07620000
*    ZA00517  (8/13/74)                                                 07630000
*    AZ04651  (07/14/75)          AZ04667  (07/01/75)                   07635000
*    AZ14029  (09/14/76)          AZ17703  (03/15/77)                   07640000
*    AZ17713  (03/18/77)          G51CK02  (05/20/77)                   07645000
*********************************************************************** 07700000
         EJECT                                                          07750000
IGCXX07B EQU   *                                                        07800000
         LR    RBASE,RCODE         PROGRAM BASE                         07850000
         USING IEEC2740,RBASE                                           07900000
         B     BEGIN               BRANCH AROUD ID                      07910000
         DC    C'IEEC2740'         MODULE ID                            07920000
         DC    C'010579'           PTF NUMBER                           07925000
         DC    C'** MVS *'                                              07930000
         DC    C'&SYSDATE'         DATE LAST ASSEMBLY                   07935000
         DS    0H                                                       07940000
BEGIN    EQU   *                                                        07942000
         LA    RBASE2,CONSTS       SET BASE FOR CONSTANT    LD @ZA00515 07944003
         USING CONSTS,RBASE2       CONSTANT ADDRESSABILITY  LD @ZA00515 07946003
         LR    RCXSATCB,RPARM      SAVE ADDR OF EXTENDED SAVE AREA      07950000
         USING CXSA,RCXSATCB                                            08000000
*                                                                     * 08050003
*        CSAXA WILL BE USED TO SAVE RETURN ADDRESS (BYTES 1,2,3)      * 08055003
*        HIGH ORDER BYTE OF CASXA (BYTE 0) WILL BE USED AS A FLAG     * 08060003
*        FOR GETLOCK AND SETFRR IN THE FOLLOWING MANNER:              * 08065003
*        CASXA+0 = X'80' LOCAL LOCK OBTAINED                          * 08070003
*                  X'40' CMS LOCK OBTAINED                            * 08075003
*                  X'20' FRR OBTAINED                                 * 08080003
*                                                                     * 08085003
         XC    CSAXA(L1),CSAXA     CLEAR LOCKS & FRR FLAGS  LD @ZA00515 08090003
         STCM  RLINK,L7,CSAXA+L1   SAVE RETURN ADDRESS      LD @ZA00515 08095003
         L     RUCME,CSAUCM        UCM ENTRY BASE                       08100000
         USING UCMLIST,RUCME                                            08150000
         L     RUCM,CSACTLM        UCM BASE BASE                        08200000
         USING UCM,RUCM                                         YM05695 08250000
         USING IHADCB,RDCB                                              08300000
         USING UCBOB,RUCB                                               08350000
         USING DEBBASIC,RDEB                                            08400000
         USING WQE,RWQE                                                 08450000
*                                                                     * 08452003
*        SET UP ESTAE ENVIROMENT                                      * 08454003
*                                                                     * 08456003
         ICM   RWORK1,L15,CSANPTR  GET RECOVERY AREA        LD @ZA00515 08458003
         BZ    NOESTAE             NOT THERE, BYPASS        LD @ZA00515 08460003
         USING PARMLIST,RWORK1     PARMLIST ADDRESSABILITY  LD @ZA00515 08462003
         LA    RWORK2,ERRORTRY     GET 2740 RECOVERY ADDR   LD @ZA00515 08464003
         C     RWORK2,PARMRTAD     OUR RETRY IN STACK       LD @ZA00515 08466003
         BE    NOESTAE             YES, LEAVE IT            LD @ZA00515 08468003
         MVC   CSANAME(L8),PARMRTAD SAVE RETRY & REGSAVE    LD @ZA00515 08470003
         ST    RWORK2,PARMRTAD     SAVE RETRY ADDRESS       LD @ZA00515 08472003
         DROP  RWORK1                                       LD @ZA00515 08474003
         USING UCBOB,RUCB          RE-BASE UCB              LD @ZA00515 08476003
NOESTAE  EQU   *                                            LD @ZA00515 08478003
*                                                                     * 08480003
*        ESTAE OR FRR RECOVERY WILL ENTER HERE FOR AN                 * 08482003
*        OPEN RETRY                                                   * 08484003
*                                                                     * 08486003
OPNRTRY  EQU   *                                            LD @ZA00515 08488003
         BAL   RCODE,GETLOCK       OBTAIN LOCAL AND CMS LOCKS   YM02593 08500000
         L     RUCB,UCMUCB         BASE UCB                     YM02593 08550000
         L     RDCB,UCMDCB         BASE DCB AND COMMON DSECT    YM04096 08600000
*                                  IF ZERO, IT WILL BE SET BY   YM04096 08650000
*                                  OPEN ROUTINE.                YM04096 08700000
         TM    UCMSTS,UCMTA        IS THIS AN OPEN REQUEST      YM02593 08750000
         BO    OPEN                YES                          YM02593 08800000
         LA    RDEB,CBDEB          BASE DEB                     YM02593 08850000
         BAL   RCODE,FREELOCK      RELEASE CMS AND LOCAL LOCKS  YM02593 08900000
         TM    UCMSTS,UCMCF        IS THIS A CLOSE REQUEST      YM02593 08950000
         BO    CLOSE               YES                          YM02593 09000000
         B     OTHER               CHECK FOR OTHER FUNCTIONS    YM02593 09050000
OPEN     EQU   *                                                        09100000
         NC    UCMDCB(L4),UCMDCB   CONSOLE ALREADY OPEN         YM02593 09150000
         BNZ   OPENEND             YES, DON'T OPEN AGAIN        YM02593 09200000
         BAL   RCODE,FREELOCK      RELEASE CMS AND LOCAL LOCKS  YM02593 09250000
         ICM   RWORK,L15,CSANPTR   GET RECOVERY AREA        LD @ZA00515 09258003
         BZ    NORCVRY             IF NONE, SKIP SET UP     LD @ZA00515 09266003
         USING PARMLIST,RWORK      PARMLIST ADDRESSABILITY  LD @ZA00515 09274003
         OI    PARMFTPT,OPENREQ    THIS IS AN OPEN REQUEST  LD @ZA00515 09282003
NORCVRY  EQU   *                                            LD @ZA00515 09290003
         GETMAIN R,LV=CBSIZ,SP=SUBPOOL                                  09300000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 09308003
         BZ    NORCVRY1            IF NONE, SKIP SET UP     LD @ZA00515 09316003
         ST    RPARM,UCMDCB        SAVE DCB ADDR FOR RCVRY  LD @ZA00515 09324003
         OI    PARMFTPT,GTMAINON   INDICATE GETMAIN DONE    LD @ZA00515 09332003
NORCVRY1 EQU   *                                            LD @ZA00515 09340003
         LR    RDCB,RPARM          ADDRESS OF AREA OBTAINED             09350000
         MVC   IHADCB(CBLEN1),DCB401   COPY MODEL CONTROL       YM02593 09400000
         MVC   IOBSTDRD(CBLEN2),IOB401   BLOCKS TO                      09450000
         MVC   SAVEAREA(CBLEN3),XSAVE   THIS NEW AREA           YM02593 09500000
         LA    RDEB,CBDEB          BASE DEB                             09550000
         LA    RWORK,DECB          POINTER TO DECB              YM02593 09600000
         ST    RWORK,IOBECBPT      STORE DECB ADDRESS                   09650000
         ST    RDCB,IOBDCBPT       STORE DCB ADDRESS                    09700000
         LA    RLINK,IOBCPA        POINT TO CHANNEL PROGRAM AREA        09750000
         ST    RLINK,IOBSTART      AND STORE IN IOB                     09800000
         ST    RDEB,DCBDEBAD       INITIALIZE DEB ADDRESS               09850000
         LA    RLINK,IOBLNTH       GET MY IOB LENGTH                    09900000
         LA    RPARM,IOBSTDRD      POINT TO IOB                         09950000
         SR    RPARM,RLINK         SUBTRACT FROM IOB ADDRESS            10000000
         IC    RLINK,DCBIOBAD      SAVE DCBDEVTP                        10050000
         ST    RPARM,DCBIOBAD      STORE IOB ADDRESS-LENGTH IN DCB      10100000
         STC   RLINK,DCBIOBAD      SAVE DCBDEVTP                        10150000
         ST    RDCB,DECDCBAD       INITIALIZE DCB ADDRESS IN DECB       10200000
         LA    RLINK,CBIRB         INITIALIZE IRB POINTER SLOT          10250000
         ST    RLINK,DEBIRBAD      IN DEB                               10300000
         LA    RLINK,APPVTAB       INITIALIZE AVT               YM02593 10350000
         IC    RPARM,DEBAPPAD      SAVE BYTE                    YM05695 10400000
         ST    RLINK,DEBAPPAD      IN DEB                               10450000
         STC   RPARM,DEBAPPAD      SAVE BYTE                    YM05695 10500000
         LA    RPARM,MESSAGE       ADDRESS OF MSG AREA          YM02593 10550000
         ST    RPARM,DECAREA       DATA AREA FOR DECB                   10600000
         L     RPARM,CVTPTR        POINT TO CVT                 YM04057 10650000
         USING CVTMAP,RPARM                                     YM04057 10700000
         L     RPARM,CVTSVDCB      GET SVCLIB DCB ADDR          YM04057 10750000
         DROP  RPARM                                            YM04057 10800000
         LOAD  EPLOC=MA,DCB=(1)    LOAD IGG019MA                YM04057 10850000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 10858003
         BZ    NORCVRY2            IF NONE, SKIP SET UP     LD @ZA00515 10866003
         OI    PARMFTPT,LOADMAON   INDICATE LOAD FOR        LD @ZA00515*10874003
                                   IGG019MA IS DONE         LD @ZA00515 10882003
NORCVRY2 EQU   *                                            LD @ZA00515 10890003
         IC    RPARM,DCBOFLGS      SAVE FLAGS                           10900000
         ST    RZERO,DCBREAD       STORE MA ADDRESS                     10950000
         STC   RPARM,DCBOFLGS      RESTORE FLAGS                        11000000
         L     RPARM,CVTPTR        POINT TO CVT                 YM04057 11050000
         USING CVTMAP,RPARM                                     YM04057 11100000
         L     RPARM,CVTSVDCB      GET SVCLIB DCB ADDR          YM04057 11150000
         DROP  RPARM                                            YM04057 11200000
         LOAD  EPLOC=MB,DCB=(1)    LOAD IGG019MB                YM04057 11250000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 11258003
         BZ    NORCVRY3            IF NONE, SKIP SET UP     LD @ZA00515 11266003
         OI    PARMFTPT,LOADMBON   INDICATE LOAD FOR        LD @ZA00515*11274003
                                   IGG019MB WAS DONE        LD @ZA00515 11282003
NORCVRY3 EQU   *                                            LD @ZA00515 11290003
         L     RPARM,DEBAPPAD      BASE VECTOR TABLE                    11300000
         USING DEBAVT,RPARM                                             11350000
         ST    RZERO,DEBCEA        STORE CHANNEL END APPENDAGE ADDR     11400000
         ST    RZERO,DEBXCEA       STORE ABNORMAL END APPENDAGE ADDR    11450000
         DROP RPARM                                                     11500000
         L     RPARM,CVTPTR        POINT TO CVT                 YM04091 11550000
         USING CVTMAP,RPARM                                     YM04091 11600000
         L     RPARM,CVTSVDCB      POINT TO SVCLIB DCB          YM04091 11650000
         DROP  RPARM                                            YM04091 11700000
         LOAD EPLOC=MR,DCB=(1)     LOAD IGG019MR                YM04091 11750000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 11758003
         BZ    NORCVRY4            IF NONE, SKIP SET UP     LD @ZA00515 11766003
         OI    PARMFTPT,LOADMRON   INDICATE LOAD FOR        LD @ZA00515*11774003
                                   IGG019MR WAS DONE        LD @ZA00515 11782003
NORCVRY4 EQU   *                                            LD @ZA00515 11790003
         CIRB  EP=(RZERO),KEY=SUPR,MODE=SUPR,STAB=(RE),WKAREA=5         11800000
         USING RBSECT,RPARM                                             11850000
         USING IQESECT,RLNTH                                            11900000
         LA    RLNTH,RBIQEWRK      ADDRESS OF IQE                       11950000
         ST    RLNTH,TEMP2         SAVE ADDRESS OF IQE                  12000000
         ST    RLNTH,RBNEXAV       SET POINTER TO IQE IN IRB            12050000
         XC    IQELNK(L8),IQELNK   ZERO IQELINK AND IQEPARM             12100000
         ST    RPARM,IQEIRB        IRB ADDRESS IN THIRD WORD            12150000
         MVI   IQESTAT2,ZERO       ZERO THESE FLAG BYTES                12200000
         MVI   IQEFLAGS,ZERO       DITTO                                12250000
         MVC   IQEDCB(L16),IQELNK   DUPLICATE SECOND 16 BYTES           12300000
         LA    RLNTH,IQEDCB        BASE SECOND 16                       12350000
         ST    RLNTH,RBIQEWRK      STORE IN IRB                         12400000
         DROP  RLNTH                                                    12450000
         L     RLNTH,DEBIRBAD      ADDRESS OF IRB POINTER               12500000
         ST    RPARM,ZERO(RLNTH)   STORE IRB ADDRESS                    12550000
         DROP  RPARM                                                    12600000
         LOAD  EPLOC=M0            LOAD IGG019M0                        12650000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 12658003
         BZ    NORCVRY5            IF NONE, SKIP SET UP     LD @ZA00515 12666003
         OI    PARMFTPT,LOADM0ON   INDICATE LOAD FOR        LD @ZA00515*12674003
                                   IGG019M0 WAS DONE        LD @ZA00515 12682003
NORCVRY5 EQU   *                                            LD @ZA00515 12690003
         L     RPARM,DCBREAD       PUT IGG019M0 IN THE                  12700000
         LA    RPARM,DEVIODIR(RPARM)                                    12750000
         ST    RPARM,CSAXB         'DEVICE I/O DIRECTORY' (IN           12800000
         USING IODIRECT,RPARM      BTAM R/W ROUTINE)                    12850000
OPENA    EQU   *                                                        12900000
         TM    IODEVTP,IOFULL      IS THE DIRECTORY FULL                12950000
         BO    ERRC1               YES, ERROR                 LD YM7708 13000000
         NC    IODEVTP(L4),IODEVTP   IS THIS ENTRY IN USE               13050000
         BZ    OPENB               NO, USE IT                           13100000
         CLC   IODEVTP,DCBDEVTP    DOES 2740 HAVE THE CHECKING FEATURE  13150000
         BE    OPENC               YES, USE IT AS IT IS                 13200000
         LA    RPARM,IONEXT        POINT TO NEXT ENTRY                  13250000
         B     OPENA               CHECK IT                             13300000
OPENB    EQU   *                                                        13350000
         ST    RZERO,IODEVMOD      SET FOR 2740 WITH CHECKING FEATURE   13400000
         MVC   IODEVTP,DCBDEVTP    INITIALIZE ENTRY                     13450000
OPENC    EQU   *                                                        13500000
         S     RPARM,CSAXB         FIND ENTRY DISPLACEMENT              13550000
         SRL   RPARM,DIVIDE4       COMPUTE TOTAL                        13600000
         STC   RPARM,DCBDEVTP      STORE IN DCB                         13650000
         BAL   RCODE,GETLOCK       OBTAIN LOCAL AND CMS LOCKS           13700000
         SR    RLNTH,RLNTH         CLEAR REG                    YM05650 13750000
         IC    RLNTH,UCMID         GET MY CONSOLE NUMBER        YM05650 13800000
         BCTR  RLNTH,ZERO          REDUCE BY ONE                YM05650 13850000
         SLL   RLNTH,MULT4         MULTIPLY BY EIL ENTRY SIZE   YM05650 13900000
         DROP  RPARM                                                    13950000
         L     RPARM,UCMLSTP       POINT TO EIL                         14000000
         USING UCMEIL,RPARM                                             14050000
         LA    RPARM,UCMIECBA      POINT TO FIRST EIL ENTRY     YM05650 14100000
         DROP  RPARM                                                    14150000
         AR    RPARM,RLNTH         POINT TO CORRECT ENTRY       YM05650 14200000
         LA    RWORK,DECB          POINTER TO DECB              YM02593 14250000
         IC    RZERO,ZERO(RPARM)   SAVE STOPPER                         14300000
         ST    RWORK,ZERO(RPARM)   YES, STORE ECB IN EIL                14350000
         STC   RZERO,ZERO(RPARM)   SAVE STOPPER                         14400000
OPEND    EQU   *                                                        14450000
         ST    RCXSATCB,TEMP1      SAVE XSA ADDRESS                     14500000
         DROP  RCXSATCB                                                 14550000
         L     RCXSATCB,UCMPXA     ADDRESS OF TCB                       14600000
         USING TCB,RCXSATCB                                             14650000
         ST    RCXSATCB,DEBTCBAD   SET THE DEB TCB ADDRESS              14700000
         L     RPARM,TCBDEB        POINT TO DEB CHAIN                   14750000
         ST    RDEB,TCBDEB         PUT THE DEB ON THE CHAIN             14800000
         IC    RZERO,DEBAMLNG      SAVE FLAGS                           14850000
         ST    RPARM,DEBDEBAD      SET FORWARD POINTER                  14900000
         STC   RZERO,DEBAMLNG      RESTORE FLAGS                        14950000
         IC    RZERO,DEBDCBAD      SAVE BYTE                    YM05695 15000000
         ST    RDCB,DEBDCBAD       PUT DCB ADDRESS IN DEB               15050000
         STC   RZERO,DEBDCBAD      SAVE BYTE                    YM05695 15100000
         ST    RUCB,DEBSUCBA       PUT UCB ADDRESS IN DEB               15150000
         MVC   DEBPRIOR,TCBDSP     SET DEB PRIORITY                     15200000
         MVZ   DEBPROTG,TCBPKF     SET DEB PROTECT KEY                  15250000
         L     RLNTH,TEMP2         PICK UP ADDRESS OF IQE               15300000
         ST    RCXSATCB,L12(RLNTH)   PUT TCB ADDRESS IN IQE             15350000
         DROP  RCXSATCB                                                 15400000
         USING CXSA,RCXSATCB                                            15450000
         L     RCXSATCB,TEMP1      RE-ESTABLISH BASE FOR XSA            15500000
         ST    RDCB,UCMDCB         SET THE DCB ADDR IN UCM              15550000
         LA    RWORK,DECB          GET ADDRESS OF DECB          YM02593 15600000
         ST    RWORK,UCMECB        PUT IT IN THE UCM                    15650000
         OI    UCMATR,UCMUF        SET 2740 AS ACTIVE                   15700000
         NI    UCMDEVC,ONES-UCMDEVB   PREPARE IS NOT IN PROGRESS        15750000
         OI    DCBOFLGS,OPENFL     SET DCB OPEN FOR 'LOPEN'             15800000
         MVI   DCBIFLGS,ZERO       ZERO IFLGS FOR 'LOPEN'               15850000
         NI    IOBINCAM,X7F        CLEAR SAD/ENABLE FAIL                15900000
         TM    IOBINCAM,IOBINUSE   IS IOB BUSY                          15950000
         BO    ERRC                YES, SWITCH                          16000000
         BAL   RCODE,FREELOCK      RELEASE CMS & LOCAL LOCKS            16050000
         OI    IOBINCAM,IOBINUSE   SET IOB AS BUSY                      16100000
         LA    RMSG,IOBCPA         POINT TO CHANNEL PGM AREA            16150000
         MVC   ZERO(L8,RMSG),DISABLE   MOVE IN DISABLE CCW              16200000
         LA    RMSG,L8(RMSG)       POINT TO NEXT CCW SLOT               16250000
         TM    UCBTYP+L3,CU0103    IS CONTROL UNIT 2701 OR 2703         16300000
         BO    OPENF               YES, DO NOT ISSUE SAD                16350000
         SR    RLNTH,RLNTH         CLEAR REG                            16400000
         IC    RLNTH,UCBTYP+L1     INSERT SAD CODE                      16450000
         N     RLNTH,ANDMASK       CLEAR UNUSED BITS                    16500000
         IC    RLNTH,SADCODE(RLNTH)   GET SAD COMMAND CODE              16550000
         STC   RLNTH,ZERO(RMSG)    STORE IN CCW                         16600000
         MVC   L1(L7,RMSG),CCWCONST   MOVE IN REMAINDER OF CCW          16650000
         LA    RMSG,L8(RMSG)       POINT TO NEXT CCW SLOT               16700000
OPENF    EQU   *                                                        16750000
         MVC   ZERO(L8,RMSG),ENABLE   MOVE IN ENABLE                    16800000
         NI    DECSDECB,ONES-X7E   CLEAR ECB                            16850000
         LA    RPARM,IOBSTDRD      POINT TO IOB FOR EXCP                16900000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 16910003
         BZ    NORCVRY6            IF NONE, SKIP SET UP     LD @ZA00515 16920003
         OI    PARMFTPT,IOSTART    INDICATE START I/O       LD @ZA00515 16930003
NORCVRY6 EQU   *                                            LD @ZA00515 16940003
         EXCP  (1)                                                      16950000
         TIME  DEC                                                      17000000
         L     RCODE,CVTPTR        POINT TO CVT                         17050000
         SH    RCODE,HSIX          POINT TO CPU MODEL ID                17100000
         CLC   ZERO(L2,RCODE),MOD145   MODEL 145                        17150000
         BE    IS145               YES                                  17200000
         CLC   ZERO(L2,RCODE),MOD155   MODEL 155                        17250000
         BE    IS155               YES                                  17300000
         CLC   ZERO(L2,RCODE),MOD158   MODEL 158            LD @ZA00517 17310000
         BE    IS158               YES                      LD @ZA00517 17320000
         CLC   ZERO(L2,RCODE),MOD165   MODEL 165                        17350000
         BE    IS165               YES                                  17400000
         CLC   ZERO(L2,RCODE),MOD168   MODEL 168            LD @ZA00517 17410000
         BE    IS168               YES                      LD @ZA00517 17420000
         CLC   ZERO(L2,RCODE),MOD3031  MODEL 3031              @G51CK02 17422000
         BE    IS3031              YES                         @G51CK02 17424000
         CLC   ZERO(L2,RCODE),MOD3032  MODEL 3032              @G51CK02 17426000
         BE    IS3032              YES                         @G51CK02 17428000
         CLC   ZERO(L2,RCODE),MOD3033  MODEL 3033              @G51CK02 17430000
         B     IS3033              YES OR ASSUME 3033          @G51CK02 17432000
  SPACE 1                                                               17434000
*                                  NEW MODEL TESTS SHOULD BE INSERTED   17436000
*                                  HERE                                 17438000
  SPACE 2                                                               17440000
IS145    EQU   *                                                        17442000
         L     RCODE,TIME145       LOAD LOOP COUNT                      17444000
         B     TIMELOOP            DO LOOP                              17446000
IS155    EQU   *                                                        17448000
IS158    EQU   *                                            LD @ZA00517 17450000
         L     RCODE,TIME155       LOAD LOOP COUNT                      17452000
         B     TIMELOOP            DO LOOP                              17454000
IS165    EQU   *                                                        17456000
IS168    EQU   *                                            LD @ZA00517 17458000
         L     RCODE,TIME165       LOAD LOOP COUNT                      17460000
         B     TIMELOOP            DO LOOP                              17462000
IS3031   EQU   *                                               @G51CK02 17464000
         L     RCODE,TIME3031      LOAD LOOP COUNT             @G51CK02 17466000
         B     TIMELOOP            DO LOOP                     @G51CK02 17468000
IS3032   EQU   *                                               @G51CK02 17470000
         L     RCODE,TIME3032      LOAD LOOP COUNT             @G51CK02 17472000
         B     TIMELOOP            DO LOOP                     @G51CK02 17474000
IS3033   EQU   *                                               @G51CK02 17476000
         L     RCODE,TIME3033      LOAD LOOP COUNT             @G51CK02 17478000
         B     TIMELOOP            DO LOOP                     @G51CK02 17480000
  SPACE 2                                                               17482000
TIMELOOP EQU   *                                                        17650000
         TM    DECSDECB,X7E        I/O COMPLETED            LD @ZA00515 17700003
         BO    OPENK               YES, EXIT LOOP                       17750000
         BCT   RCODE,TIMELOOP      LOOP 5 SECONDS                       17800000
         B     OPENK               EXIT                                 17850000
  SPACE 2                                                               18150000
OPENK    EQU   *                                                        18200000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 18201003
         BZ    NORCVRY7            IF NONE, SKIP SET UP     LD @ZA00515 18202003
         NI    PARMFTPT,IOEND      INDICATE I/O WAS         LD @ZA00515*18203003
                                   SUCCESSFUL               LD @ZA00515 18204003
NORCVRY7 EQU   *                                            LD @ZA00515 18205003
         BAL   RCODE,GETLOCK       OBTAIN LOCAL & CMS LOCKS             18210000
         NI    UCMSTS,ONES-UCMBF   THE 2740 IS NOT BUSY                 18250000
         TM    DECSDECB,X7E        GOOD COMPLETION                      18300000
         BNO   ERRC                NO, SWITCH                           18350000
         NI    UCMDEVC,ONES-UCMDEVE   RESET I/O COMPLETE                18400000
         MVI   DECTYPE+L1,ONES     INDICATE BREAK                       18450000
         NI    UCMSTS,ONES-UCMTA   OPEN HAS BEEN PERFORMED              18500000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 18510003
         BZ    NORCVRY8            IF NONE, SKIP SET UP     LD @ZA00515 18520003
         NI    PARMFTPT,OPENOFF    SAME IN PARMLIST         LD @ZA00515 18530003
NORCVRY8 EQU   *                                            LD @ZA00515 18540003
         B     OTHER1              CHECK FOR OTHER FUNCTIONS            18550000
OPENEND  EQU   *                                                        18600000
         NI    UCMSTS,ONES-UCMTA   OPEN HAS BEEN PERFORMED              18650000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 18658003
         BZ    NORCVRY9            IF NONE, SKIP SET UP     LD @ZA00515 18666003
         NI    PARMFTPT,OPENOFF    SAME IN PARMLIST         LD @ZA00515 18674003
         DROP  RWORK                                        LD @ZA00515 18682003
NORCVRY9 EQU   *                                            LD @ZA00515 18690003
         B     RET                 RETURN                               18700000
OTHER    EQU   *                                                        18750000
         BAL   RCODE,GETLOCK       OBTAIN LOCAL AND CMS LOCKS           18800000
OTHER1   EQU   *                                                        18850000
         TM    UCMDEVC,UCMDEVE     HAS AN I/O OPERATION JUST COMPLETED  18900000
         BNO   OUTP                NO, CHECK FOR OTHER FUNCTIONS        18950000
         NI    UCMSTS,ONES-UCMBF   THE 2740 IS NOT BUSY                 19000000
         NI    UCMDEVC,ONES-UCMDEVE   TURN OFF I/O COMPLETE             19050000
         TM    DCBTIOT,TRMRESET    IOCMP ON RESET MESSAGE               19100000
         BO    ERRA                YES                                  19150000
         TM    UCMDEVC,UCMDEVB+UCMDEVG   IS IT I/O FROM A WRITE         19200000
         BZ    WRITE               YES, MIXED FALLS THROUGH             19250000
         BO    READ                CHECK OTHER FUNCTIONS                19300000
         TM    UCMDEVC,UCMDEVB     IS IT I/O FROM READ                  19350000
         BO    READA               YES                                  19400000
READ     EQU   *                                                        19450000
         NI    UCMDEVC,ONES-UCMDEVG-UCMDEVB  RESET PREPARE AND HALTIO   19500000
         B     OUTP                OUTPUT AFTER HALTIO                  19550000
READA    EQU   *                                                        19600000
         NI    UCMDEVC,ONES-UCMDEVB   RESET PREPARE IN PROGRESS         19650000
         TM    DECSDECB,X7E        GOOD COMPLETION                      19700000
         BNO   ERR                 NO, SWITCH                           19750000
         NI    DCBTIOT,ONES-BIDHIT-RETRIED    RESET DCB FLAGS           19800000
         TR    MESSAGE,IECTRC40    TRANSLATE INPUT TO EBCDIC            19850000
         MVI   MESSAGE+L'MESSAGE-L1,EOB   FORCE EOB                     19900000
         LA    RPARM,MESSAGE       POINT TO MESSGAE                     19950000
         LR    RZERO,RPARM         AGAIN                                20000000
READB    EQU   *                                                        20050000
         CLI   ZERO(RPARM),EOT     EOT FOUND                            20100000
         BE    OUTP                YES                                  20150000
         CLI   ZERO(RPARM),BSP     BACKSPACE FOUND                      20200000
         BNE   READC               NO, CHECK FOR EOB                    20250000
         CLI   L1(RPARM),RTRN      YES, IS IT FOR A CANCEL FUNCTION     20300000
         BE    OUTP                YES, CHECK FOR OUTPUT                20350000
         LR    RLINK,RPARM         NO, BACKSPACE MESSAGE                20400000
         BCTR  RLINK,ZERO                                               20450000
         CR    RLINK,RZERO         START OF MESSAGE AREA                20500000
         BL    OUTP                YES, CANCEL MESSAGE                  20550000
         SR    RPARM,RZERO         CALCULATE THE                        20600000
         LNR   RPARM,RPARM         REMAINING BUFFER LENGTH              20650000
         LA    RPARM,PARTLNTH(RPARM)                                    20700000
         EX    RPARM,BKSPCMVC      BACKSPACE 2 SPACES                   20750000
         LR    RPARM,RLINK         RESET THE SCAN POINTER               20800000
         B     READB               LOOK AT NEXT CHARACTER               20850000
READC    EQU   *                                                        20900000
         CLI   ZERO(RPARM),EOB     ARE WE AT THE END OF MSG             20950000
         BE    READF               YES                                  21000000
         CLI   ZERO(RPARM),RTRN    IS THE CHAR CARRIAGE RETURN          21050000
         BNE   READE               NO                                   21100000
         MVI   ZERO(RPARM),BLANK   CHANGE IT TO BLANK                   21150000
READE    EQU   *                                                        21200000
         LA    RPARM,L1(RPARM)     BUMP TO NEXT CHARACTER               21250000
         B     READB               LOOK AT THE NEXT CHARACTER           21300000
READF    EQU   *                                                        21350000
         MVI   ZERO(RPARM),BLANK   CHANGE IT TO BLANK                   21400000
         SR    RPARM,RZERO         COMPUTE LENGTH                       21450000
         LA    RPARM,L4(RPARM)     OF MESSAGE                           21500000
         STH   RPARM,MESSLNTH      PREPARE THE MSG FOR                  21550000
         SR    RZERO,RZERO         CLEAR REG                            21600000
         IC    RZERO,UCMID         TELL SVC 34 ITS FROM ME              21650000
         LA    RPARM,MSG           BASE PARAMETER LIST          YM02593 21700000
         BAL   RCODE,FREELOCK      RELEASE CMS & LOCAL LOCKS            21750000
         SVC   34                  GIVE COMMAND TO SYSTEM               21800000
         B     OUTPB               CONTINUE TERMINAL OPERATIONS         21850000
WRITE    EQU   *                                                        21900000
         L     RPARM,UCMWLAST      POINT TO QUEUE ENTRY WRITTEN         21950000
         USING CQEWQE,RPARM                                             22000000
         TM    DECSDECB,X7E        GOOD COMPLETION                      22050000
         BNO   ERRB                NO, SWITCH                           22100000
         NI    DCBTIOT,ONES-RETRIED-WREOT   RESET DCB FLAGS             22150000
         CLI   DECTYPE+L1,WRRESET   COMPLETE ON WR EOT                  22200000
         BNE   WRITA               NO, SET WQE USED                     22250000
         MVI   DECTYPE+L1,ONES     SET BREAK                            22300000
         B     OUTPB               CONTINUE OPERATIONS                  22350000
WRITA    EQU   *                                                        22400000
         TM    CQEFLAG,CQEMAJOR    WAS WRITE PERFORMED ON MLWTO         22450000
         BO    WRITD               YES                                  22500000
WRITB    EQU   *                                                        22550000
         OI    CQEFLAG,CQEAVAIL    DEQUEUE FROM THIS CONSOLE            22600000
         NI    CQEFLAG,ONES-CQEENTR   NO LONGER VALID                   22650000
         OI    UCMSTS,UCMTB        DEQUEUE WORK TO BE DONE              22700000
WRITC    EQU   *                                                        22750000
         CLI   DECRESPN+1,SPACE    OPERATOR ATTENTION                   22800000
         BNE   OUTPB               NO, WRITE ANOTHER                    22850000
         OI    DCBTIOT,BIDHIT      OPERATOR WANTS IN                    22900000
         B     PREP                SET UP FOR READ                      22950000
WRITD    EQU   *                                                        23000000
         NC    UCMMLAST(L4),UCMMLAST   MINOR JUST WRITTEN               23050000
         BNZ   WRITG               YES                                  23100000
         L     RWQE,CQEWQE         MAJOR POINTER                        23150000
         TM    WMJMLTYP,WMJMLTYD   END INDICATOR IN MAJOR               23200000
         BO    WRITJ               YES, SET UP FOR PURGE                23250000
         TM    WMJMMLW,WMJMMLWF    MINOR QUEUEING IN PROCESS            23300000
         BO    WRITK               YES, WAIT FOR IT                     23350000
WRITF    EQU   *                                                        23400000
         L     RWQE,CQEWQE         MAJOR POINTER                YA02445 23450000
         TM    WMJMMLW,WMJMMLWH    ANY MINOR TEXT EXISTS                23500000
         BO    WRITK               NO                                   23550000
         NI    CQEFLAG,ONES-CQEATTOP   STARTING NEW MINOR CHAIN         23600000
         MVC   UCMMLAST(L4),WMJMMIN   NEXT LINE TO BE WRITTEN           23650000
         B     WRITC               CHECK ATTN                           23700000
WRITG    EQU   *                                                        23750000
         L     RWQE,UCMMLAST       POINT TO MINOR WRITTEN               23800000
         SR    RLNTH,RLNTH         CLEAR REG                            23850000
         IC    RLNTH,WMNMUC1       GET USE COUNT                        23900000
         BCTR  RLNTH,RZERO         REDUCE BY ONE                        23950000
         STC   RLNTH,WMNMUC1       STORE USE COUNT                      24000000
         LTR   RLNTH,RLNTH         USE COUNT = 0                        24050000
         BNZ   WRITH               NO                                   24100000
         L     RLNTH,CQEWQE        MAJOR POINTER                        24150000
         OI    L4(RLNTH),WMJMMLWG   TELL DEQ TO CHECK CHAIN             24200000
         OI    UCMSTS,UCMTB        TELL DEQ TO CHECK MY QUEUE           24250000
WRITH    EQU   *                                                        24300000
         TM    WMNMLT1,WMNMLT1D    END INDICATOR IN THIS LINE           24350000
         BO    WRITJ               YES, PURGE                           24400000
WRITI    EQU   *                                                        24450000
         NC    WMNMNX1(L3),WMNMNX1   NEXT LINE EXIST                    24500000
         BZ    WRITK               NO                                   24550000
         L     RLNTH,WMNMUC1       POINT TO NEXT MINOR                  24600000
         LA    RLNTH,ZERO(RLNTH)   CLEAR OUT USE COUNT                  24650000
         NC    L5(L2,RLNTH),L5(RLNTH)   NEXT LINE TYPE FILLED IN        24700000
         BZ    WRITK               NO, WAIT FOR IT                      24750000
         MVC   UCMMLAST+L1(L3),WMNMNX1   NEXT LINE TO WRITE             24800000
         B     WRITC               CHECK ATTN                           24850000
WRITJ    EQU   *                                                        24900000
         NI    UCMSTS,ONES-UCMTC   NO LONGER WORKING ON MLWTO           24950000
         B     WRITB               COMPLETE PURGE                       25000000
WRITK    EQU   *                                                        25050000
         NI    UCMSTS,ONES-UCMPF   NO MORE OUTPUT UNTIL WE RECEIVE      25100000
*                                  ANOTHER MLWTO LINE                   25150000
         OI    UCMSDS5,UCMSDS5A    WAITING ON AN MLWTO                  25200000
         B     PREP                PUT UP READ                          25250000
WRITL    EQU   *                                                        25300000
         L     RPARM,UCMWLAST      CURRENT OUTQ ENTRY                   25350000
         NI    UCMSDS5,ONES-UCMSDS5A   TURN OFF WAITING BIT             25400000
         NC    UCMMLAST(L4),UCMMLAST   WAS LAST WRITE FOR MINOR         25450000
         BZ    WRITM               NO                                   25500000
         TM    CQEFLAG,CQEATTOP    HAS MINOR CHAIN BEEN RORDERED        25550000
         BO    WRITF               YES, START WITH FIRST MINOR          25600000
         L     RWQE,UCMMLAST       BASE WQE                             25650000
         B     WRITI               GET NEW LINE PTR                     25700000
WRITM    EQU   *                                                        25750000
         L     RWQE,CQEWQE         CURRENT WQE                          25800000
         B     WRITF               GET NEXT LINE                        25850000
OUTP     EQU   *                                                        25900000
         TM    UCMSTS,UCMPF        IS THERE OUTPUT PENDING              25950000
         BNO   PREP                NO, SET UP FOR READ                  26000000
         TM    DCBTIOT,PURGE       IS PURGE IN PROCESS                  26050000
         BNO   OUTPA               NO, CONTINUE                         26100000
         CLI   DECSDECB,X48        IS PURGE COMPLETE                    26150000
         BNE   RET                 NO, EXIT                             26200000
OUTPA    EQU   *                                                        26250000
         TM    UCMDEVC,UCMDEVB     YES, IS PREPARE IN PROGRESS          26300000
         BO    HALT                YES, HALT PREPARE                    26350000
OUTPB    EQU   *                                                        26400000
         TM    UCMSDS5,UCMSDS5A    WERE WE WAITING ON AN MLWTO          26450000
         BO    WRITL               YES, CONTINUE WITH WRITE             26500000
         TM    UCMSTS,UCMTC        WORKING ON MLWTO                     26550000
         BO    OUTPQ               YES, WRITE LINE                      26600000
         L     RPARM,UCMOUTQ       IS THERE ANYTHING                    26650000
         LTR   RPARM,RPARM         IN THE OUTPUT QUEUE                  26700000
         BZ    PREP                NO, SET UP FOR READ                  26750000
OUTPC    EQU   *                                                        26800000
         TM    CQEFLAG,CQEENTR     VALID ENTRY                          26850000
         BO    OUTPG               YES, SET UP FOR WRITE                26900000
OUTPD    EQU   *                                                        26950000
         TM    CQEFLAG,CQEEOB      POINTER TO NEXT BLOCK                27000000
         BO    OUTPE               YES                                  27050000
         BZ    OUTPF               THIS IS A NULL ENTRY                 27100000
         NI    UCMSTS,ONES-UCMPF   TURN OFF OUTPUT PENDING              27150000
         B     PREP                SET UP FOR READ                      27200000
OUTPE    EQU   *                                                        27250000
         L     RPARM,CQEWQE        POINT TO NEXT BLOCK                  27300000
         LA    RPARM,ZERO(RPARM)   CLEAR OUT FLAGS                      27350000
         B     OUTPC               TRY THE NEXT ENTRY                   27400000
OUTPF    EQU   *                                                        27450000
         LA    RPARM,CQEWQE+L4     POINT TO NEXT ENTRY                  27500000
         B     OUTPC               CHECK IT                             27550000
OUTPG    EQU   *                                                        27600000
         L     RWQE,CQEWQE         GET WQE                              27650000
         TM    CQEFLAG,CQEMLQHC    IS IT QUEUED FOR HARDCOPY            27700000
         BNO   OUTPH               NO                                   27750000
         TM    WQEXA,WQEPURGE      PURGE BIT OFF                        27800000
         BNO   OUTPI               YES, PUT IT OUT                      27850000
         TM    WQEAVAIL,WQEBUFC    NO, BUT IS IT READY FOR HARDCOPY     27900000
         BO    OUTPI               YES, PUT IT OUT                      27950000
         B     OUTPP               NO, DEQUEUE IT                       28000000
OUTPH    EQU   *                                                        28050000
         TM    WQEXA,WQEPURGE      IS THIS MSG TO BE PURGED             28100000
         BO    OUTPP               YES - DON'T WRITE IT                 28150000
         OI    WQEAVAIL,WQEBUFC    SHOW MSG READY FOR HARDCOPY          28200000
OUTPI    EQU   *                                                        28250000
         ST    RPARM,TEMP2         SAVE THAT ENTRY POINTER FOR MSG      28300000
         TM    CQEFLAG,CQEMAJOR    IS THIS ENTRY AN MLWTO               28350000
         BO    OUTPQ               YES, GO WRITE IT                     28400000
         L     RLNTH,WQENBR        PICK UP MSG LENTH                    28450000
         BCTR  RLNTH,ZERO          REDUCE FOR EXECUTE                   28500000
         TM    CQEFLAG,CQEMLQHC    REQUEST FOR HARDCOPY FORMAT          28550000
         BNO   OUTPJ               NO                                   28600000
         LA    RLNTH,L23(RLNTH)    BUMP FOR HARDCOPY TEXT               28650000
         LA    RPARM,WQERR         POINT TO HARDCOPY TEXT               28700000
         B     OUTPR               MOVE TEXT                            28750000
OUTPJ    EQU   *                                                        28800000
         TM    UCMDISP2,UCMDISPI   HASP TIMESTAMP AND JOBNAME           28850000
         BO    HASPBOTH            YES                                  28900000
         TM    UCMDISP2,UCMDISPJ   HASP JOBNAME ONLY                    28950000
         BO    HASPONE             YES                                  29000000
         LA    RPARM,WQETXT        POINT TO TEXT                        29050000
         B     OUTPR               MOVE IT                              29100000
HASPBOTH EQU   *                                                        29150000
         LA    RLNTH,L18(RLNTH)    BUMP FOR BOTH                        29200000
         LA    RPARM,WQETS         POINT TO TEXT                        29250000
         B     OUTPR               MOVE IT                              29300000
HASPONE  EQU   *                                                        29350000
         LA    RLNTH,L9(RLNTH)     BUMP FOR NAME                        29400000
         LA    RPARM,WQEJOBNM      POINT TO TEXT                        29450000
         B     OUTPR               MOVE IT                              29500000
OUTPK    EQU   *                                                        29550000
         LA    RLNTH,ZERO(RLNTH)                                        29600000
         LA    RPARM,L127          MAX CHARS 127                        29650000
         CR    RPARM,RLNTH         IF MSG LESS THAN 127                 29700000
         BH    OUTPL               BRANCH                               29750000
         LR    RLNTH,RPARM         MSG GREATER THAN 127                 29800000
OUTPL    EQU   *                                                        29850000
         LA    RPARM,MESSAGE(RLNTH)   SET RETURN EOB                    29900000
         MVC   ZERO(L'RETRNEOB,RPARM),RETRNEOB                          29950000
         TM    DECTYPE+L1,RST      IS BREAK NECESSARY                   30000000
         BO    OUTPM               CHECK UCB                            30050000
         MVI   DECTYPE+L1,WRCONT   NO, WRITE CONTINUE                   30100000
         B     OUTPO                                                    30150000
OUTPM    EQU   *                                                        30200000
         CLI   UCBTYP,T2740B       DO WE NEED BREAK                     30250000
         BE    OUTPN               YES, SET UP WRITE BREAK              30300000
         MVI   DECTYPE+L1,WRINIT   NO, SET UP WR INITIAL                30350000
         B     OUTPO                                                    30400000
OUTPN    EQU   *                                                        30450000
         MVI   DECTYPE+L1,WRBREAK   WRITE BREAK                         30500000
OUTPO    EQU   *                                                        30550000
         BAL   RCODE,FREELOCK      RELEASE CMS AND LOCAL LOCKS          30600000
         LA    ROPEN,SAVEAREA      REG SAVE AREA                        30650000
         LA    RLNTH,DECB          POINT TO DECB            LD @ZA00515 30700003
         WRITE (RLNTH),T,MF=E                               LD @ZA00515 30750003
         LR    RLNTH,RCODE                                              30800000
         BAL   RCODE,GETLOCK       OBTAIN LOCAL & CMS LOCKS             30850000
         LTR   RLNTH,RLNTH         TEST R/W RETURN CODE                 30900000
         BNZ   ERRC                BAD CODE, SWITCH                     30950000
         OI    UCMSTS,UCMBF        THE 2740 IS BUSY                     31000000
         TM    DCBTIOT,TRMRESET+WREOT   AVOID STORING WQE ADDR          31050000
         BNZ   RET                 YES, DIDN'T USE WQE                  31100000
         L     RPARM,TEMP2         GET SAVED WQE POINTER                31150000
         ST    RPARM,UCMWLAST      SAVE CURRENT MSG  POINTER ENTRY      31200000
         B     RET                 RETURN                               31250000
OUTPP    EQU   *                                                        31300000
         OI    UCMSTS,UCMTB        DEQUEUE REQUIRED                     31350000
         NI    CQEFLAG,ONES-CQEENTR   NO LONGER VALID                   31400000
         OI    CQEFLAG,CQEAVAIL    WQE IS TO BE DEQUEUED                31450000
         B     OUTPD               CHECK FOR END OF Q BLOCK             31500000
OUTPQ    EQU   *                                                        31550000
         SR    RLNTH,RLNTH         CLEAR REG                            31600000
         TM    UCMSTS,UCMTC        WORKING ON MLWTO                     31650000
         BO    OUTPT               YES, OLD WRITE                       31700000
         XC    UCMMLAST(L4),UCMMLAST   ZERO LAST MINOR POINTER          31750000
         OI    UCMSTS,UCMTC        NOW WORKING ON MLWTO                 31800000
         IC    RLNTH,WMJMTXTL+L1   GET TEXT LENGTH                      31850000
         BCTR  RLNTH,RZERO         REDUCE FOR EXECUTE                   31900000
         TM    CQEFLAG,CQEMLQHC    MLWTO FOR HARDCOPY                   31950000
         BO    OUTPS               YES, INCLUDE HARDCOPY TEXT           32000000
         TM    UCMDISP2,UCMDISPI   HASP TS AND JN                       32050000
         BO    HASMBOTH            YES                                  32100000
         TM    UCMDISP2,UCMDISPJ   HASP JN ONLY                         32150000
         BO    HASMONE             YES                                  32200000
         LA    RPARM,WMJMTXT       POINT TO TEXT                        32250000
         B     OUTPR               MOVEIT                               32300000
HASMBOTH EQU   *                                                        32350000
         LA    RLNTH,L18(RLNTH)    BUMP FOR BOTH                        32400000
         LA    RPARM,WMJMTS        POINT TO TEXT                        32450000
         B     OUTPR               MOVE IT                              32500000
HASMONE  EQU   *                                                        32550000
         LA    RLNTH,L9(RLNTH)     BUMP FOR NAME                        32600000
         LA    RPARM,WMJMJBNM      POINT TO TEXT                        32650000
OUTPR    EQU   *                                                        32700000
         EX    RLNTH,MOVETXT       MOVE TEXT TO MESSAGE AREA            32750000
         LA    RLNTH,L1(RLNTH)     RESTORE LENGTH                       32800000
         TR    MESSAGE,MODTABLE    TRANSLATE EBCDIC TO 2740             32850000
         B     OUTPK               COMPLETE SET UP                      32900000
OUTPS    EQU   *                                                        32950000
         LA    RLNTH,L23(RLNTH)    ADD TO LENGTH FOR HCTXT              33000000
         LA    RPARM,WMJMRR        POINT TO TEXT                        33050000
         B     OUTPR               MOVE IT                              33100000
OUTPT    EQU   *                                                        33150000
         L     RPARM,UCMWLAST      CURRENT OUTQ ENTRY                   33200000
         L     RWQE,UCMMLAST       POINT MINOR HALF                     33250000
         IC    RLNTH,WMNMTL1       GET LENGTH                           33300000
         LTR   RLNTH,RLNTH         LENGTH ZERO                          33350000
         BZ    WRITG               YES, HANDLE AS LAST OR END           33400000
         TM    CQEFLAG,CQEMLQHC    MLWTO FOR HARDCOPY                   33450000
         BO    OUTPU               YES                                  33500000
         BCTR  RLNTH,RZERO         REDUCE FOR EXECUTE                   33550000
         LA    RPARM,WMNMTXT1      POINT TO TEXT                        33600000
         B     OUTPR               MOVE IT                              33650000
OUTPU    EQU   *                                                        33700000
         LA    RPARM,WMNMHCT1      TEXT POINTER                         33750000
         LA    RLNTH,L3(RLNTH)     ADD TO TEXT LENGTH FOR HCTXT         33800000
         B     OUTPR               MOVE IT                              33850000
         DROP  RPARM                                                    33900000
CLOSE    EQU   *                                                        33950000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 33957003
         BZ    NORCVRY0            IF NONE, SKIP SET UP     LD @ZA00515 33964003
         USING PARMLIST,RWORK      PARMLIST ADDRESSABILITY  LD @ZA00515 33971003
         OI    PARMFTPT,CLOSEREQ   THIS IS A CLOSE REQUEST  LD @ZA00515 33978003
         DROP  RWORK                                        LD @ZA00515 33985003
NORCVRY0 EQU   *                                            LD @ZA00515 33992003
         TM    DCBTIOT,PURGE       IS PURGE IN PROCESS                  34000000
         BNO   CLOSA               NO, CONTINUE                         34050000
         CLI   DECSDECB,X48        IS PURGE COMPLETE                    34100000
         BNE   RET                 NO, EXIT                             34150000
CLOSA    EQU   *                                                        34200000
         TM    UCMDEVC,UCMDEVB     PREPARE IN PROGRESS                  34250000
         BO    HALT1               YES                        LD YM7708 34300000
         TM    UCBFL1,UCBPOST      OPERATION IN PROGRESS                34350000
         BO    RET                 YES, INTERRUPT EXPECTED              34400000
         TM    IOBFLAG1,IOBERRTN   ERP IN CONTROL                       34450000
         BO    RET                 YES, ALLOW TO FINISH                 34500000
         L     RPARM,UCMOUTQ       ARE THERE ANY MSGS OR REPLIES        34550000
         LTR   RPARM,RPARM         OUTSTANDING                          34600000
         BZ    CLOSD               NO, CLOSE THE 2740                   34650000
CLOSB    EQU   *                                                        34700000
         USING CQEWQE,RPARM                                             34750000
         TM    CQEFLAG,CQEENTR     VALID ENTRY                          34800000
         BNO   CLOSB1              NO, CHECK FURTHER                    34850000
         OI    CQEFLAG,CQEAVAIL    DEQUEUE FROM THIS CONSOLE            34900000
         NI    CQEFLAG,ONES-CQEENTR   NO LONGER VALID                   34950000
         OI    UCMSTS,UCMTB        DEQUEUE WORK TO BE DONE              35000000
CLOSB1   EQU   *                                                        35050000
         TM    CQEFLAG,CQEEOB      POINTER TO NEXT BLOCK                35100000
         BM    CLOSD               NO, CLOSE THE 2740                   35150000
         BO    CLOSC               YES                                  35200000
         LA    RPARM,CQEWQE+L4     BUMP TO NEXT ENTRY                   35250000
         B     CLOSB               CHECK IT                             35300000
CLOSC    EQU   *                                                        35350000
         L     RPARM,CQEWQE        POINT TO NEXT BLOCK                  35400000
         B     CLOSB               TRY THE NEXT ENTRY                   35450000
         DROP  RPARM                                                    35500000
CLOSD    EQU   *                                                        35550000
         NI    UCMATR,ONES-UCMUF   THIS 2740 IS INACTIVE                35600000
         SR    RLNTH,RLNTH         CLEAR REG                    YM05650 35650000
         IC    RLNTH,UCMID         GET MY CONSOLE ID            YM05650 35700000
         BCTR  RLNTH,ZERO          REDUCE BY ONE                YM05650 35750000
         SLL   RLNTH,MULT4         MULTIPLY BY EIL ENTRY SIZE   YM05650 35800000
         L     RPARM,UCMLSTP       POINT TO EIL                         35850000
         USING UCMEIL,RPARM                                             35900000
         LA    RPARM,UCMIECBA      POINT TO FIRST EIL ENTRY     YM05650 35950000
         DROP  RPARM                                                    36000000
         AR    RPARM,RLNTH         POINT TO CORRECT ENTRY       YM05650 36050000
         IC    RZERO,ZERO(RPARM)   SAVE FLAGS                           36100000
         ST    RUCME,ZERO(RPARM)   RESET ENTRY                          36150000
         STC   RZERO,ZERO(RPARM)   RESTORE FLAGS                        36200000
CLOSF    EQU   *                                                        36250000
         TM    UCBSTAT,UCBCHGS     DEVICE GOING TO OFFLINE              36300000
         BNO   CLOSH               NO                                   36350000
         NIL   UCBSTAT,X'00',REF=UCBOB,WREGS=(RZERO,RLINK,RCODE)        36400000
         B     CLOSI               CONTINUE                             36450000
CLOSH    EQU   *                                                        36500000
         NIL   UCBSTAT,X'80',REF=UCBOB,WREGS=(RZERO,RLINK,RCODE)        36550000
CLOSI    EQU   *                                                        36600000
         ST    RCXSATCB,TEMP1                                   YM04095 36650000
         DROP  RCXSATCB                                         YM04095 36700000
         L     RCXSATCB,UCMPXA     POINT TO TCB                 YM04095 36750000
         USING TCB,RCXSATCB                                     YM04095 36800000
         LA    RDEB,CBDEB          POINT TO OUR DEB             YM02593 36850000
         L     RPARM,TCBDEB        POINT TO DEB OFF TCB QUEUE   YM04095 36900000
         LA    RPARM,0(RPARM)      CLEAR HI-ORDER BYTE         @ZA17703 36920000
         CR    RPARM,RDEB          IS OUR DEB FIRST             YM04095 36950000
         BNE   CLOSJ               NO                           YM04095 37000000
         MVC   TCBDEB(L4),DEBDEBAD   MAKE SECOND DEB FIRST DEB  YM04095 37050000
         B     CLOSK               CONTINUE                     YM04095 37100000
CLOSJ    EQU   *                                                YM04095 37150000
         DROP  RDEB                                             YM04095 37200000
         USING DEBBASIC,RPARM                                   YM04095 37250000
         LR    RCXSATCB,RPARM      SAVE THIS DEB POINTER        YM04095 37300000
         ICM   RPARM,L7,DEBDEBB    POINT TO NEXT DEB           @ZA04651 37350000
         CR    RPARM,RDEB          IS THIS OUR DEB              YM04095 37400000
         BNE   CLOSJ               NO, TRY THE NEXT DEB         YM04095 37450000
         MVC   L5(L3,RCXSATCB),DEBDEBAD+L1   RECHAIN DEB QUEUE  YM04095 37500000
CLOSK    EQU   *                                                YM04095 37550000
         DROP  RPARM                                            YM04095 37600000
         USING DEBBASIC,RDEB                                    YM04095 37650000
         DROP  RCXSATCB                                         YM04095 37700000
         USING CXSA,RCXSATCB                                    YM04095 37750000
         L     RCXSATCB,TEMP1      BASE CXSA                            37800000
         NI    UCMSTS,ONES-UCMCF-UCMBF   CLOSE PERFORMED, BUSY OFF      37850000
         SR    RLINK,RLINK         CLEAR DCB AND DECB ADDRESSES         37900000
         ST    RLINK,UCMDCB        IN UCM ENTRY                         37950000
         ST    RLINK,UCMECB                                             38000000
         BAL   RCODE,FREELOCK      RELEASE CMS & LOCAL LOCKS            38050000
DELETEM0 EQU   *                                            LD @ZA00515 38070003
         DELETE EPLOC=M0           DELETE IGG019MA                      38100000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 38110003
         BZ    NOESTAE0            IF NONE, SKIP SET UP     LD @ZA00515 38112003
         USING PARMLIST,RWORK      PARMLIST ADDRESSABILITY  LD @ZA00515 38114003
         NI    PARMFTPT,LOADM0OF   IGG019M0 DELETED         LD @ZA00515 38116003
NOESTAE0 EQU   *                                            LD @ZA00515 38118003
DELETEMR EQU   *                                            LD @ZA00515 38120003
         DELETE EPLOC=MR           DELETE 1GG019MB                      38150000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 38160003
         BZ    NOESTAE1            IF NONE, SKIP SET UP     LD @ZA00515 38162003
         NI    PARMFTPT,LOADMROF   IGG019MR DELETED         LD @ZA00515 38166003
NOESTAE1 EQU   *                                            LD @ZA00515 38168003
DELETEMB EQU   *                                            LD @ZA00515 38170003
         DELETE EPLOC=MB           DELETE IGG019M0                      38200000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 38210003
         BZ    NOESTAE2            IF NONE, SKIP SET UP     LD @ZA00515 38212003
         NI    PARMFTPT,LOADMBOF   IGG019MB DELETED         LD @ZA00515 38214003
NOESTAE2 EQU   *                                            LD @ZA00515 38216003
DELETEMA EQU   *                                            LD @ZA00515 38220003
         DELETE EPLOC=MA           DELETE IGG019MR                      38250000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 38260003
         BZ    NOESTAE3            IF NONE, SKIP SET UP     LD @ZA00515 38262003
         NI    PARMFTPT,LOADMAOF   IGG019MA DELETED         LD @ZA00515 38264003
NOESTAE3 EQU   *                                            LD @ZA00515 38266003
FREEMAIN EQU   *                                            LD @ZA00515 38270003
         FREEMAIN R,LV=CBSIZ,A=(RDCB),SP=SUBPOOL   FREE BUFFER          38300000
         ICM   RWORK,L15,CSANPTR   GET PTR TO RECOVERY AREA LD @ZA00515 38310003
         BZ    NOESTAE4            IF NONE, SKIP SET UP     LD @ZA00515 38320003
         NI    PARMFTPT,GTMAINOF   FREEMAIN DONE            LD @ZA00515 38330003
         DROP  RWORK                                        LD @ZA00515 38332003
NOESTAE4 EQU   *                                            LD @ZA00515 38340003
         B     RETA                LEAVE                                38350000
PREP     EQU   *                                                        38400000
         MVI   MESSAGE,X01         BLANK MESSAGE AREA PRIOR             38450000
         MVC   MESSAGE+1(L139),MESSAGE   TO READ                        38500000
         CLI   UCBTYP,T2740B       DO WE HAVE BREAK                     38550000
         BNE   PREPA               NO, ISSUE RD INITIAL                 38600000
         TM    DECTYPE+L1,RST      IS BREAK NECESSARY                   38650000
         BO    PREPB               YES                                  38700000
         TM    DCBTIOT,BIDHIT      OPERATOR WANTS IN                    38750000
         BO    PREPA               YES, DON'T USE BREAK                 38800000
         MVI   DECTYPE+L1,WRRESET   WRITE EOT OP TYPE                   38850000
         OI    DCBTIOT,WREOT       WE ARE WRITING EOT                   38900000
         B     OUTPO               GO TO ISSUE WRITE                    38950000
PREPA    EQU   *                                                        39000000
         MVI   DECTYPE+L1,RDINIT   READ INITIAL                         39050000
         B     PREPC                                                    39100000
PREPB    EQU   *                                                        39150000
         MVI   DECTYPE+L1,RDBREAK   READ INITIAL BREAK                  39200000
PREPC    EQU   *                                                        39250000
         BAL   RCODE,FREELOCK      RELEASE CMS & LOCAL LOCKS            39300000
         LA    ROPEN,SAVEAREA      REG SAVE AREA                        39350000
         LA    RLNTH,DECB          POINT TO DECB            LD @ZA00515 39400003
         READ  (RLNTH),T,MF=E                               LD @ZA00515 39450003
         LR    RLNTH,RCODE                                              39500000
         BAL   RCODE,GETLOCK       OBTAIN LOCAL & CMS LOCKS             39550000
         LTR   RLNTH,RLNTH         TEST R/W RETURN CODE                 39600000
         BNZ   ERRC                BAD CODE, SWITCH                     39650000
         OI    UCMSTS,UCMBF        THE 2740 IS BUSY                     39700000
         OI    UCMDEVC,UCMDEVB     PREPARE IS IN PROGRESS               39750000
         TM    DCBTIOT,BIDHIT      OPERATOR ATTN                        39800000
         BNO   RET                 NO                                   39850000
         MVI   DECRESPN,ZERO       YES, BLOCK WRITE                     39900000
         B     RET                 LEAVE                                39950000
HALT1    EQU   *                                              LD YM7708 39960000
         BAL   RCODE,GETLOCK       OBTAIN LOCAL AND CMS LOCKS LD YM7708 39970000
HALT     EQU   *                                                        40000000
         CLI   UCBID,ONES          VALID UCB                            40050000
         BNE   ERRC                NO, SWITCH                           40100000
         CLI   DECRESPN,ZERO       IS DATA BEING TRANSFERRED            40150000
         BE    RET                 YES, RETURN                          40200000
         OI    DCBTIOT,PURGE       SHOW PURGE IN PROCESS                40250000
         NI    UCMDEVC,ONES-UCMDEVB   TURN OFF PREPARE                  40300000
         OI    UCMSTS,UCMBF        DEVICE IS BUSY                       40350000
         OI    UCMDEVC,UCMDEVG     INDICATE HALT I/O IN PROCESS         40400000
         NI    IOBINCAM,ONES-IOBINUSE   IOB BUSY BIT OFF                40450000
         NI    IOBFLAG1,ONES-IOBERRTN-IOBIOERR   TURN OFF ERP FLAGS     40500000
         MVI   DECTYPE+L1,ONES     INDICATE BREAK                       40550000
         BAL   RCODE,FREELOCK      RELEASE CMS & LOCAL LOCKS            40600000
         LA    RPARM,CBPURGE       PURGE PARM LIST                      40650000
         LA    RDEB,CBDEB          POINT TO DEB                         40700000
         ST    RDEB,ZERO(RPARM)    DEB ADDRESS TO PARM LIST             40750000
         MVI   ZERO(RPARM),XE0     PURGE OPTIONS                        40800000
         L     RLINK,UCMPXA        PICK UP TCB ADDRESS                  40850000
         ST    RLINK,L4(RPARM)     AND PUT IT IN PARM LIST              40900000
         LA    RLNTH,IOBSTDRD      POINT TO IOB                 YM05650 40950000
         IC    RZERO,DEBUSRPG      SAVE EXLIST                  YM05695 41000000
         ST    RLNTH,DEBUSRPG      PUT IT IN PURGE SLOT         YM05650 41050000
         STC   RZERO,DEBUSRPG      SAVE EXLIST                  YM05695 41100000
         MVC   IOBRSTRB(L3),FOXFOX   SET AS LAST IOB            YM05650 41150000
         LA    RLNTH,DEBUSRPG      PURGE IOB CHAIN POINTER              41200000
         ST    RLNTH,L8(RPARM)     STORE IT                             41250000
         MVI   L8(RPARM),L1        SET FOR ONE I/O TO PURGE     YM05650 41300000
         SVC   16                  PURGE SVC                            41350000
         NI    IOBINCAM,ONES-IOBINUSE   IOB BUSY BIT OFF                41400000
         NI    IOBFLAG1,ONES-IOBERRTN-IOBIOERR   TURN OFF ERP FLAGS     41450000
         XC    IOBRSTRB(L3),IOBRSTRB   RESTORE IOBRSTR                  41500000
         MVI   DECTYPE+L1,ONES     INDICATE BREAK                       41550000
         NI    DCBTIOT,ONES-PURGE   SHOW PURGE COMPLETE                 41600000
         B     RETA                LEAVE                                41650000
RET      EQU   *                                                        41700000
         BAL   RCODE,FREELOCK      RELEASE CMS & LOCAL LOCKS            41750000
RETA     EQU   *                                                        41800000
         L     RLINK,CSAXA         RESTORE RETURN ADDRESS               41850000
RETURN   EQU   *                                                        41900000
         ICM   RWORK1,L15,CSANPTR  GET RECOVERY AREA        LD @ZA00515 41902003
         BZ    NOESTAE5            NOT THERE, BYPASS        LD @ZA00515 41904003
         USING PARMLIST,RWORK1     PARMLIST ADDRESSABILITY  LD @ZA00515 41906003
         MVC   PARMRTAD(L8),CSANAME RESTORE RETRY & REGSAVE LD @ZA00515 41908003
NOESTAE5 EQU   *                                            LD @ZA00515 41910003
         NI    PARMFTPT,CLOSEOFF   INDICATE CLOSE DONE      LD @ZA00515 41912003
         DROP  RWORK1                                                   41914003
         USING UCBOB,RUCB          RE-BASE UCB              LD @ZA00515 41916003
*                                                                     * 41918003
*        ADDRESS OF END-OF-EXTEND APPENDAGE RTN FOR AVR               * 41920003
*                                                                     * 41922003
DEBEOEAP EQU   *                                            LD @ZA00515 41924003
*                                                                     * 41926003
*        ADDRESS OF START I/O APPENDAGE RTN FOR AVT                   * 41928003
*                                                                     * 41930003
DEBSIOAP EQU   *                                            LD @ZA00515 41932003
*                                                                     * 41934003
*        ADDRESS OF PCI APPENDAGE RTN FOR AVT                         * 41936003
*                                                                     * 41938003
DEBPCIAP EQU   *                                            LD @ZA00515 41940003
         BR    RLINK               VIA THE ADDRESS IN REG 14            41950000
GETLOCK  EQU   *                                                        42000000
         STM   RUCME,RLINK,CSAXC   SAVE REGS USED BY SETLOCK            42050000
         TM    CSAXA,LOCALON       DO WE HAVE LOCAL LOCK    LD @ZA00515 42060003
         BNZ   TESTCMS             YES, DONT GET IT         LD @ZA00515 42070003
GETLOCL  SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        X42100000
               RELATED=(WQE,IEEC2740(FREELOCL))                         42150000
         OI    CSAXA,LOCALON       SET LOCAL LOCK FLAG ON   LD @ZA00515 42160003
TESTCMS  EQU   *                                            LD @ZA00515 42170003
         TM    CSAXA,CMSON         DO EW HAVE CMS LOCK      LD @ZA00515 42180003
         BNZ   TESTFRR             YES, DONT GET IT         LD @ZA00515 42190003
GETCMS   SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                          X42200000
               RELATED=(UCM,IEEC2740(FREECMS))                          42250000
         OI    CSAXA,CMSON         SET CMS LOCK FLAG ON     LD @ZA00515 42252003
TESTFRR  EQU   *                                            LD @ZA00515 42254003
         TM    CSAXA,FRRON         DO EW HAVE FRR           LD @ZA00515 42256003
         BNZ   RESTORE1            YES, DONT GET IT         LD @ZA00515 42258003
         L     RFRRADD,UCMFRRAD    GET ADDR OF COMM FRR RTN LD @ZA00515 42260003
         USING PSA,RZERO           BASE THE PSA (ADDR=0)    LD @ZA00515 42262003
GETFRR   SETFRR A,FRRAD=(14),PARMAD=(13),WRKREGS=(12,13),              *42264003
               RELATED=(CMS-LOCK,IEEC2740(FREEFRR))         LD @ZA00515 42266003
         ST    RPARMADD,CSADCBP    SAVE FRR PARMLIST PTR    LD @ZA00515 42268003
         USING PARMLIST,RPARMADD   PARMLIST ADDRESSABILITY  LD @ZA00515 42270003
         ICM   RWORK3,L15,CSANPTR  GET ESTAE PARMLIST ADD   LD @ZA00515 42272003
         BZ    NOESTAE6            NO THERE, BYPASS         LD @ZA00515 42274003
         MVC   PARMLIST(PARMSIZE),ZERO(RWORK3) COPY ESTAE PARMLIST TO  *42276003
                                              FRR PARMLIST  LD @ZA00515 42278003
NOESTAE6 EQU   *                                            LD @ZA00515 42280003
         MVC   PARMID,SVC72ID      MOVE ID IN FOR RECOVERY  LD @ZA00515 42282003
         DROP  RPARMADD                                        @ZA14029 42283000
         OI    CSAXA,FRRON         SET FRR FLAD ON          LD @ZA00515 42284003
RESTORE1 EQU   *                                            LD @ZA00515 42286003
         LM    RUCME,RLINK,CSAXC   RESTORE REGS AFTER SETLOCK           42300000
         BR    RCODE               RETURN TO CALLER                     42350000
FREELOCK EQU   *                                                        42400000
         STM   RUCME,RLINK,CSAXC   SAVE REGS USED BY SETLOCK            42450000
         TM    CSAXA,FRRON         DO WQ HAVE FRR           LD @ZA00515 42454003
         BZ    CHECKCMS            NO, DONT FREE IT         LD @ZA00515 42458003
         USING PSA,RZERO           BASE THE PSA (ADDR=0)    LD @ZA00515 42462003
FREEFRR  SETFRR D,WRKREGS=(12,13),                                     *42466003
               RELATED=(CMS-LOCK,IEEC2740(GETFRR))          LD @ZA00515 42470003
         XC    CSADCBP,CSADCBP     ZERO PTR                 LD @ZA00515 42474003
         NI    CSAXA,FRROFF        SET FRR FLAG OFF         LD @ZA00515 42478003
CHECKCMS EQU   *                                            LD @ZA00515 42482003
         TM    CSAXA,CMSON         DO WE HAVE CMS LOCK      LD @ZA00515 42486003
         BZ    CHECKLCL            NO, DONT FREE IT         LD @ZA00515 42490003
FREECMS  SETLOCK RELEASE,TYPE=CMS,                                     X42500000
               RELATED=(UCM,IEEC2740(GETCMS))                           42550000
         NI    CSAXA,CMSOFF        SET CMS FLAG OFF         LD @ZA00515 42560003
CHECKLCL EQU   *                                            LD @ZA00515 42570003
         TM    CSAXA,LOCALON       DO WE HAVE LOCAL LOCK    LD @ZA00515 42580003
         BZ    RESTORE2            NO, RETURN TO CALLER     LD @ZA00515 42590003
FREELOCL SETLOCK RELEASE,TYPE=LOCAL,                                   X42600000
               RELATED=(WQE,IEEC2740(GETLOCL))                          42650000
         NI    CSAXA,LOCALOFF      SET LOCAL LOCK FLAG OFF  LD @ZA00515 42660003
RESTORE2 EQU   *                                            LD @ZA00515 42670003
         LM    RUCME,RLINK,CSAXC   RESTORE REGS AFTER SETLOCK           42700000
         BR    RCODE               RETURN TO CALLER                     42750000
ERR      EQU     *                                                      42800000
         CLI   UCBTYP,T2740B       DO WE HAVE BREAK                     42850000
         BNE   ERRC                NO, SWITCH                           42900000
         TM    DECSENS0,TIMEOUT    READ TIMEOUT                         42950000
         BNO   ERRB                NO, CHECK RETRY                      43000000
         MVC   MESSAGE(L34),TOERMSG   MOVE IN TIMEOUT MESSAGE           43050000
         OI    DCBTIOT,TRMRESET                                         43100000
         B     OUTPN               GO TO WRITE IT                       43150000
ERRA     EQU   *                                                        43200000
         NI    DCBTIOT,ONES-TRMRESET   AFTER IO COMPLETE ON WRITE       43250000
         TM    DECSDECB,X7E        GOOD COMPLETION                      43300000
         BNO   ERRC                NO, SWITCH                           43350000
         B     OUTP                                                     43400000
ERRB     EQU   *                                                        43450000
         CLI   UCBTYP,T2740B       DO WE HAVE BREAK                     43500000
         BNE   ERRC                NO, SWITCH                           43550000
         TM    DECSENS0,RETRYMSK   SHOULD WE RETRY AFTER                43600000
         BNZ   ERRC                THIS ERROR                           43650000
         TM    DCBTIOT,RETRIED     HAVE WE RETRIED                      43700000
         BO    ERRC                YES, SWITCH                          43750000
         MVI   DECTYPE+L1,ONES     NO, SET BREAK                        43800000
         OI    DCBTIOT,RETRIED     AND RETRY                            43850000
         OC    UCMMLAST,UCMMLAST   IS UCMLAST ZERO?            @ZA17713 43860000
         BNZ   OUTP                NO BRANCH                   @ZA17713 43870000
         NI    UCMSTS,ONES-UCMTC   TURN OFF INLINE WTO         @ZA17713 43880000
         B     OUTP                                                     43900000
ERRC1    EQU   *                                              LD YM7708 43910000
         BAL   RCODE,GETLOCK       OBTAIN LOCAL AND CMS LOCKS LD YM7708 43920000
ERRC     EQU   *                                                        43950000
         OI    UCMDEVC,UCMDEVCC    INDICATE CONSOLE SWITCH              44000000
         NI    UCMDEVC,ONES-UCMDEVCC-UCMDEVE-UCMDEVB   RESET ALL        44050000
         NI    UCMSTS,ONES-UCMTA-UCMBF   CNSLE FLGS FOR NO QUICK REOPEN 44100000
         BAL   RCODE,FREELOCK      RELEASE LOCKS              LD YM7708 44110000
         LR    RPARM,RCXSATCB      POINT TO CXSA                        44150000
         L     RLINK,CSAXA         SET RETURN ADDRESS                   44200000
         ICM   RWORK1,L15,CSANPTR  GET RECOVERY AREA        LD @ZA00515 44207003
         BZ    NOESTAE7            BOT THERE, BYPASS        LD @ZA00515 44214003
         USING PARMLIST,RWORK1     PARMLIST ADDRESSABILITY  LD @ZA00515 44221003
         MVC   PARMRTAD(L8),CSANAME RESTORE RETRY & REGSAVE LD @ZA00515 44228003
         DROP  RWORK1                                       LD @ZA00515 44235003
NOESTAE7 EQU   *                                            LD @ZA00515 44242003
         L     RCODE,UCMSWCH       ADDRESS OF CONSOLE SWITCH            44250000
         BR    RCODE               GO TO CONSOLE SWITCH                 44300000
         EJECT                                                          44350000
*                                                                     * 44350203
*                                                                     * 44350403
*        ESTAE RETRY ROUTINE FOR 2740'S                     LD @ZA00515 44350603
*                                                                     * 44350803
*                                                                     * 44351003
         SPACE 3                                                        44351203
ERRORTRY DS    0H                                           LD @ZA00515 44351403
         BALR  RTRYBASE,RZERO      SET SUBROUTINE BASE      LD @ZA00515 44351603
         USING *,RTRYBASE                                   LD @ZA00515 44351803
         L     RBASE,ADDR2740      RESET MAINLINE BASE      LD @ZA00515 44352003
         L     RBASE2,ADDRCONS     RESET CONSTANT BASE      LD @ZA00515 44352203
         USING PSA,RZERO           BASE PSA ON LOCATION 0   LD @ZA00515 44352403
         L     RWORK,PSATOLD       GET PTR TO MY TCB        LD @ZA00515 44352603
         DROP  RZERO                                        LD @ZA00515 44352803
         USING TCB,RWORK           TCB ADDRESSABILITY       LD @ZA00515 44353003
         L     RWORK,TCBRBP        GET PTR TO MY SVRB       LD @ZA00515 44353203
         DROP  RWORK                                        LD @ZA00515 44353403
         USING RBSECT,RWORK        RB ADDRESSABILITY        LD @ZA00515 44353603
         LA    RCXSATCB,RBEXSAVE   TELOAD CXSA BASE         LD @ZA00515 44353803
         DROP  RWORK                                        LD @ZA00515 44354003
         L     RLINK,FREERTN       ADDR OF FREELOCK RTN     LD @ZA00515 44354203
         BALR  RCODE,RLINK         GO FREE LOCKS IF ANY AND LD @ZA00515*44354403
                                   DELETE FRR               LD @ZA00515 44354603
         L     RWORK,CSANPTR       GET REVOVERY PARMLIST    LD @ZA00515 44354803
         USING PARMLIST,RWORK      PARMLIST ADDRESSABILITY  LD @ZA00515 44355003
         TM    PARMFTPT,OPENREQ    IS OPEN PENDING          LD @ZA00515 44355203
         BO    OPNRCVRY            YES GO TO SET UP RETRY   LD @ZA00515 44355403
         TM    PARMFTPT,CLOSEREQ   IS CLOSE PENDING         LD @ZA00515 44355603
         BO    CLSRCVRY            YES GO SET UP RETRY      LD @ZA00515 44355803
         SPACE 2                                                        44356003
*                                                                     * 44356203
*        ADDITIONAL RECOVERY WILL GO HERE                   LD @ZA00515 44356403
*                                                                     * 44356603
         SPACE 2                                                        44356803
SWTCHCSL EQU   *                                            LD @ZA00515 44357003
         L     RRTRN,SWTCHADR      SET FOR CONSOLE SWITCH   LD @ZA00515 44357203
         B     RETRY                                        LD @ZA00515 44357403
         EJECT                                                          44357603
*                                                                     * 44357803
*                                                                     * 44358003
*        OPEN RECOVERY SETUP SUBROUTINE                               * 44358203
*                                                                     * 44358403
*                                                                     * 44358603
         SPACE 2                                                        44358803
OPNRCVRY EQU   *                                            LD @ZA00515 44359003
         TM    PARMFTPT,IOSTART    I/O SUCCESSFUL?          LD @ZA00515 44359203
         BO    SWTCHCSL            NO SWITCH CONSOLE        LD @ZA00515 44359403
         TM    PARMFTPT,GTMAINON   WAS GETMAIN DONE         LD @ZA00515 44359603
         BO    CHECKLD             YES CHECK IF LOADS       LD @ZA00515*44359803
                                   WERE DONE                LD @ZA00515 44360003
         L     RRTRN,RTRYOPN       SET OPEN RETRY ADDREES   LD @ZA00515*44360203
                                   FROM BEGINNING           LD @ZA00515 44360403
         B     RETRY               GO TO RETRY              LD @ZA00515 44360603
         EJECT                                                          44360803
*                                                                     * 44361003
*                                                                     * 44361203
*        CLOSE RECOVERY SETUP SUBROUTINE                              * 44361403
*                                                                     * 44361603
*                                                                     * 44361803
         SPACE 2                                                        44362003
CLSRCVRY EQU   *                                            LD @ZA00515 44362203
         TM    PARMFTPT,GTMAINON   WAS FREEMAIN DONE        LD @ZA00515 44362403
         BO    CHECKLD1            NO, CHECK IF DELETES     LD @ZA00515*44362603
                                   DONE                     LD @ZA00515 44362803
         L     RRTRN,RTRYCLS       SET CLOSE RETRY ADDRESS  LD @ZA00515 44363003
         B     RETRY               GO TO RETRY              LD @ZA00515 44363203
         EJECT                                                          44363403
*                                                                     * 44363603
*                                                                     * 44363803
*        THIS SUBROUTINE WILL CHECK HOW MANY LOADS OR DELETES HAS     * 44364003
*        BEEN DONE. ACCORDINGLY WILL SET UP THE RETRY                 * 44364203
*                                                                     * 44364403
*                                                                     * 44364603
         SPACE 2                                                        44364803
CHECKLD  EQU   *                                            LD @ZA00515 44365003
         MVC   CSAXC,CSAXA         SAVE RTN ADDR FROM       LD @ZA00515*44365203
                                   MAINLINE                 LD @ZA00515 44365403
         LA    RLINK,RTNENTRY      SET NEW RETURN ADDR      LD @ZA00515 44365603
         ST    RLINK,CSAXA         FOR MAINLINE             LD @ZA00515 44365803
CHECKLD1 EQU   *                                            LD @ZA00515 44366003
         TM    PARMFTPT,LOADM0ON   IS IGG019M0 LOAD DONE    LD @ZA00515 44366203
         BZ    CHECKMR             NO, CHECK NEXT           LD @ZA00515 44366403
         L     RRTRN,M0DELETE      SET RETRY ADDR           LD @ZA00515 44366603
         B     RETRY1              RETRY                    LD @ZA00515 44366803
         SPACE 2                                                        44367003
CHECKMR  EQU   *                                            LD @ZA00515 44367203
         TM    PARMFTPT,LOADMRON   IS IGG019MR LOAD DONE    LD @ZA00515 44367403
         BZ    CHECKMB             NO, CHECK NEXT           LD @ZA00515 44367603
         L     RRTRN,MRDELETE      SET RETRY ADDRESS        LD @ZA00515 44367803
         B     RETRY1              GO TO RETRY              LD @ZA00515 44368003
         SPACE 2                                                        44368203
CHECKMB  EQU   *                                            LD @ZA00515 44368403
         TM    PARMFTPT,LOADMBON   IS IGG019MB LOAD DONE    LD @ZA00515 44368603
         BZ    CHECKMA             NO, CHECK NEXT           LD @ZA00515 44368803
         L     RRTRN,MBDELETE      SET RETRY ADDRESS        LD @ZA00515 44369003
         B     RETRY1              GO TO RETRY              LD @ZA00515 44369203
         SPACE 2                                                        44369403
CHECKMA  EQU   *                                            LD @ZA00515 44369603
         TM    PARMFTPT,LOADMAON   IS IGG019MA LOAD DONE    LD @ZA00515 44369803
         BZ    CONTINUE            NO, CONTINUE             LD @ZA00515 44370003
         L     RRTRN,MADELETE      SET RETRY ADDRESS        LD @ZA00515 44370203
         B     RETRY1              GO TO RETRY              LD @ZA00515 44370403
         SPACE 2                                                        44370603
CONTINUE EQU   *                                            LD @ZA00515 44370803
         L     RRTRN,FRMADDR       SET RETRY ADDRESS        LD @ZA00515 44371003
         B     RETRY1              GO TO RETRY              LD @ZA00515 44371203
         SPACE 2                                                        44371403
RTNENTRY EQU   *                                            LD @ZA00515 44371603
         MVC   CSAXA,CSAXC         RESTORE RETURN ADDREES   LD @ZA00515*44371803
                                   FOR MAINLINE             LD @ZA00515 44372003
         L     RRTRN,RTRYOPN       SET RETRY ADDRESS FOR    LD @ZA00515*44372203
                                   OPEN                     LD @ZA00515 44372403
         B     RETRY               GO TO RETRY              LD @ZA00515 44372603
         EJECT                                                          44372803
*                                                                     * 44373003
*                                                                     * 44373203
*        EXIT ROUTINE                                       *           44373403
*                                                                     * 44373603
*                                                                     * 44373803
         SPACE 2                                                        44374003
RETRY    EQU   *                                            LD @ZA00515 44374203
         XC    PARMFTPT,PARMFTPT   CLEAR FOOTPRINTS         LD @ZA00515 44374403
RETRY1   EQU   *                                            LD @ZA00515 44374603
         L     RUCME,CSAUCM        RELOAD UCME PTR          LD @ZA00515 44374803
         L     RUCM,CSACTLM        RELOAD UCM BASE          LD @ZA00515 44375003
         L     RDCB,UCMDCB         RELOAD DCB BASE          LD @ZA00515 44375203
         L     RUCB,UCMUCB         RELOAD UCB BASE          LD @ZA00515 44375403
         LA    RDEB,CBDEB          RELOAD DEB BASE          LD @ZA00515 44375603
         XC    UCMECB,UCMECB       CLEAR ECB FIELD IN UCM   LD @ZA00515 44375703
         XC    UCMDCB,UCMDCB       CLEAR DCB FIELD IN UCM   LD @ZA00515 44376203
         DROP  RTRYBASE                                     LD @ZA00515 44379003
         USING IEEC2740,RBASE      MAIN LINE ADDRESSABILITY LD @ZA00515 44379503
         BR    RRTRN               GO TO RETRY              LD @ZA00515 44380003
         DROP  RWORK                                        LD @ZA00515 44380503
         EJECT                                                          44381003
*                                                                     * 44381503
*                                                                     * 44382003
*        CONSTANTS AND EQUATION FOR ESTAE RETRY ROUTINE               * 44382503
*                                                                     * 44383003
*                                                                     * 44383503
         SPACE 2                                                        44384003
ADDR2740 DC    A(IEEC2740)         ADDR OF MAINLINE         LD @ZA00515 44384503
ADDRCONS DC    A(CONSTS)           ADDR OF MAINLINE CONST.  LD @ZA00515 44385003
RTRYOPN  DC    A(OPNRTRY)          ADDR OF OPEN RETRY       LD @ZA00515 44385503
FREERTN  DC    A(FREELOCK)         ADDR OF FREELOCKS RTN    LD @ZA00515 44386003
RTRYCLS  DC    A(RETA)             ADDR OF CLOSE RETRY      LD @ZA00515 44386503
FRMADDR  DC    A(FREEMAIN)         ADDR OF FREEMAIN RETRY   LD @ZA00515 44387003
SWTCHADR DC    A(ERRC1)            ADDR OF SWITCH CONSOLE   LD @ZA00515 44387503
*                                                                     * 44388003
*        ADDRESSES OF DELETES RETRY                                   * 44388503
*                                                                     * 44389003
M0DELETE DC    A(DELETEM0)                                  LD @ZA00515 44389503
MRDELETE DC    A(DELETEMR)                                  LD @ZA00515 44390003
MBDELETE DC    A(DELETEMB)                                  LD @ZA00515 44390503
MADELETE DC    A(DELETEMA)                                  LD @ZA00515 44391003
         SPACE 4                                                        44391503
GTMAINON EQU   B'10000000'                                  LD @ZA00515 44392003
GTMAINOF EQU   B'01111111'                                  LD @ZA00515 44392503
OPENREQ  EQU   B'01000000'                                  LD @ZA00515 44393003
OPENOFF  EQU   B'10111111'                                  LD @ZA00515 44393503
CLOSEREQ EQU   B'00100000'                                  LD @ZA00515 44394003
CLOSEOFF EQU   B'11011111'                                  LD @ZA00515 44394503
IOSTART  EQU   B'00010000'                                  LD @ZA00515 44395003
IOEND    EQU   B'11101111'                                  LD @ZA00515 44395503
LOADMAON EQU   B'00001000'                                  LD @ZA00515 44396003
LOADMAOF EQU   B'11110111'                                  LD @ZA00515 44396503
LOADMBON EQU   B'00000100'                                  LD @ZA00515 44397003
LOADMBOF EQU   B'11111011'                                  LD @ZA00515 44397503
LOADMRON EQU   B'00000010'                                  LD @ZA00515 44398003
LOADMROF EQU   B'11111101'                                  LD @ZA00515 44398503
LOADM0ON EQU   B'00000001'                                  LD @ZA00515 44399003
LOADM0OF EQU   B'11111110'                                  LD @ZA00515 44399503
**********                                                              44400000
*                                                                       44450000
*        EXECUTED INSTRUCTIONS                                          44500000
*                                                                       44550000
**********                                                              44600000
MOVETXT  EQU   *                                                        44650000
         MVC   MESSAGE(ZERO),ZERO(RPARM)                                44700000
BKSPCMVC EQU   *                                                        44750000
         MVC   ZERO(L1,RLINK),L2(RLINK)                                 44800000
         EJECT                                                          44810003
CONSTS   EQU   *                                            LD @ZA00515 44820003
         SPACE 3                                                        44830003
**********                                                              44850000
*                                                                       44900000
*        CONSTANTS                                                      44950000
*                                                                       45000000
**********                                                              45050000
MOD145   DC    XL2'0145'           CPU ID                               45100000
MOD155   DC    XL2'0155'           CPU ID                               45150000
MOD158   DC    XL2'0158'           CPU ID                   LD @ZA00517 45160000
MOD165   DC    XL2'0165'           CPU ID                               45200000
MOD168   DC    XL2'0168'           CPU ID                   LD @ZA00517 45210000
MOD3031  DC    XL2'3031'           CPU ID                      @G51CK02 45220000
MOD3032  DC    XL2'3032'           CPU ID                      @G51CK02 45230000
MOD3033  DC    XL2'3033'           CPU ID                      @G51CK02 45240000
ANDMASK  DC    F'3'                                                     45250000
SVC72ID  DC    CL4'VCTR'           RECOVERY IDENTIFIER      LD @ZA00515 45270003
TIME145  DC    XL4'0011B39F'       5 SECONDS                            45300000
TIME155  DC    XL4'002753A8'       5 SECONDS                            45350000
TIME165  DC    XL4'005971BC'       5 SECONDS                            45400000
TIME3031 DC    XL4'00381936'       5 SECONDS                   @G51CK02 45420000
TIME3032 DC    XL4'0069F6BC'       5 SECONDS                   @G51CK02 45440000
TIME3033 DC    XL4'00BA1532'       5 SECONDS                   @G51CK02 45460000
DISABLE  DC    X'2F00000060010001'                                      45500000
ENABLE   DC    X'2700000020240001'                                      45550000
MA       DC    CL8'IGG019MA'       NAME OF BTAM R/W ROUTINE             45600000
MB       DC    CL8'IGG019MB'       NAME OF BTAM CEA ROUTINE             45650000
M0       DC    CL8'IGG019M0'       NAME OF BTAM DEV  I/O ROUTINE        45700000
MR       DC    CL8'IGG019MR'       NAME OF OLT CONTROL MODULE           45750000
HSIX     DC    H'6'                CONSTANT                             45800000
SADCODE  DC    X'13171B1F'                                              45850000
*                   I E E X X X X   T I M E O U T   -                   45900000
TOERMSG  DC    XL18'F3EBEB020715F301A6F3C9EBCCA9A6014001'               45950000
*                   T E R M I N A L   R E S E T                         46000000
         DC    XL16'A6EBD2C9F3CAE2C601D2EBA5EBA65B3D'                   46050000
         ASMTRTAB RC40                                                  46100000
MODTABLE EQU   *                                                        46150000
*                 0 1 2 3 4 5 6 7 8 9 A B C D E F                       46200000
         DC    X'01011601010101010101010101010101' 0                    46250000
         DC    X'01010101010101010101010101010101' 1                    46300000
         DC    X'01010101010101010101010101010101' 2                    46350000
         DC    X'01010101010101010101010101010188' 3                    46400000
         DC    X'01010101010101010101A0768493E1B7' 4                    46450000
         DC    X'61010101010101010101D757909587F6' 5                    46500000
         DC    X'4023010101010101010101378BC08EA3' 6                    46550000
         DC    X'010101010101010101018816208D8296' 7                    46600000
         DC    X'01626467686B6D6E7073010101010101' 8                    46650000
         DC    X'01434546494A4C4F5152010101010101' 9                    46700000
         DC    X'01012526292A2C2F3132010101010101' A                    46750000
         DC    X'01010101010101010101010101010101' B                    46800000
         DC    X'01E2E4E7E8EBEDEEF0F3010101010101' C                    46850000
         DC    X'01C3C5C6C9CACCCFD1D2010101010101' D                    46900000
         DC    X'0101A5A6A9AAACAFB1B2010101010101' E                    46950000
         DC    X'15020407080B0D0E1013010101010101' F                    47000000
CCWCONST DC    X'00000060240001'   CCW SKELETON                         47050000
RETRNEOB DC    0XL10'0'                                                 47100000
         DC    AL1(RTRN2740)                                            47150000
         DC    8AL1(IDLE)                                               47200000
         DC    AL1(EOB2740)                                             47250000
FOXFOX   DC    X'FFFFFF'           STOPPER FOR PURGE            YM05650 47300000
PACHAREA EQU   *                                                        47350000
         DC    100X'00'            PATCH AREA FOR MAINTENANCE  @ZA17713 47400000
         EJECT                                                          47450000
**********                                                              47500000
*                                                                       47550000
*        REGISTER DEFINITION                                            47600000
*                                                                       47650000
**********                                                              47700000
RZERO    EQU   0                   WORK REG                             47750000
RPARM    EQU   1                   CXSA BASE/WORK REG/EIL BASE/CQE BASE 47800000
*                                  AVT BASE/IO DIRECTORY BASE           47850000
RUCM     EQU   2                   UCM BASE                             47900000
RUCB     EQU   3                   UCB BASE                             47950000
RWORK1   EQU   RUCB                WORK REGISTER            LD @ZA00515 47970003
RMSG     EQU   4                   WORK REG/CURRENT MESSAGE BASE        48000000
RTRYBASE EQU   RMSG                BASE FOR RETRY RTN       LD @ZA00515 48020003
RBASE    EQU   5                   PROGRAM BASE                         48050000
RWQE     EQU   6                   WQE BASE/WORK REG                    48100000
RBASE2   EQU   7                   BASE REG FOR CONSTANT    LD @ZA00515 48150003
RDCB     EQU   8                   DCB BASE/COMMON DSECT BASE           48200000
RWORK2   EQU   RDCB                WORK REGISTER            LD @ZA00515 48210003
RWORK4   EQU   RDCB                                         LD @ZA00515 48220003
RCXSATCB EQU   9                   CXSA BASE/TCB BASE/WORK REG          48250000
RDEB     EQU   10                  DEB BASE                             48300000
RUCME    EQU   11                  UCM ENTRY BASE                       48350000
RLNTH    EQU   12                  LENGTH OF TEXT/WORK REG              48400000
RWORK3   EQU   RLNTH               WORK REGISTER            LD @ZA00515 48410003
RRTRN    EQU   RLNTH                                        LD @ZA00515 48420003
ROPEN    EQU   13                  WORK REG                             48450000
RPARMADD EQU   ROPEN               PARM ADD FROM SETFRR     LD @ZA00515 48460003
RWORK    EQU   ROPEN               WORK REGISTER            LD @ZA00515 48470003
RLINK    EQU   14                  LINK REG/WORK REG                    48500000
RFRRADD  EQU   RLINK               ADDR OF COMM FRR RTN     LD @ZA00515 48520003
RCODE    EQU   15                  LINK REG/WORK REG                    48550000
         EJECT                                                          48600000
**********                                                              48650000
*                                                                       48700000
*        MISCELLANEOUS EQUATES                                          48750000
*                                                                       48800000
**********                                                              48850000
DEVTP40  EQU   X'0C'               2740 CODE FOR 'DCBDEVTP'             48900000
CU0103   EQU   X'02'                                                    48950000
MULT4    EQU   2                   TO MULTIPLY BY 4, SHIFT BY 2         49000000
DIVIDE4  EQU   2                   TO DIVIDE BY 4, SHIFT BY 2           49050000
IDLE     EQU   X'5E'                                                    49100000
RTRN2740 EQU   X'5B'               2740 CARR RETN-NEW LINE              49150000
EOB2740  EQU   X'3D'               2740 EOB                             49200000
RTRN     EQU   X'15'               2740 CARRIAGE RETURN                 49250000
BSP      EQU   X'16'               2740 BACKSPACE                       49300000
EOB      EQU   X'26'               EOB CHARACTER                        49350000
EOT      EQU   X'37'               END-OF-TRANSMISSION CHARACTER        49400000
DEVIODIR EQU   12                  DISPLACEMENT OF THE 'DEVICE I/O      49450000
*                                  DIRECTORY' FROM THE BEGINNING OF     49500000
*                                  THE 'BTAM R/W ROUTINE' (IGG019MA)    49550000
IOFULL   EQU   X'FF' I             INDICATOR OF THE 'FULL' CONDITION OF 49600000
*                                  THE DEVICE I/O DIRECTORY             49650000
ZERO     EQU   0                   LENGTH AND DISPLACEMENT              49700000
L1       EQU   1                   LENGTH AND DISPLACEMENT              49750000
L2       EQU   2                   LENGTH AND DISPLACEMENT              49800000
L3       EQU   3                   LENGTH AND DISPLACEMENT              49850000
L4       EQU   4                   LENGTH AND DISPLACEMENT              49900000
L5       EQU   5                   LENGTH AND DISPLACEMENT              49950000
L7       EQU   7                   LENGTH AND DISPLACEMENT              50000000
L8       EQU   8                   LENGTH AND DISPLACEMENT              50050000
L9       EQU   9                   LENGTH AND DISPLACEMENT              50100000
L12      EQU   12                  LENGTH AND DISPLACEMENT              50150000
L15      EQU   15                  MASK FOR ICM INSTR.      LD @ZA00515 50170003
L16      EQU   16                  LENGTH AND DISPLACEMENT              50200000
L18      EQU   18                  LENGTH AND DISPLACEMENT              50250000
L23      EQU   23                  LENGTH AND DISPLACEMENT              50300000
L34      EQU   34                  LENGTH AND DISPLACEMENT              50350000
L40      EQU   40                  LENGTH AND DISPLACEMENT              50400000
L127     EQU   127                 LENGTH AND DISPLACEMENT              50450000
L139     EQU   139                 LENGTH AND DISPLACEMENT              50500000
X01      EQU   X'01'               MASK                                 50550000
X80      EQU   X'80'               MASK                                 50600000
X48      EQU   X'48'               MASK                                 50650000
X7E      EQU   X'7E'               MASK                                 50700000
X7F      EQU   X'7F'               MASK                                 50750000
XE0      EQU   X'E0'               MASK                                 50800000
ONES     EQU   X'FF'               AND MASK                             50850000
SUBPOOL  EQU   255                 COMM TASK SUBPOOL                    50900000
RETRYMSK EQU   X'88'                                                    50950000
BLANK    EQU   C' '                BLANK                                51000000
RST      EQU   X'80'                                                    51050000
SPACE    EQU   X'01'               2740 TRANSCODE SPACE                 51100000
WRINIT   EQU   X'02'                                                    51150000
T2740B   EQU   X'59'                                                    51200000
WRCONT   EQU   X'04'               WR CONTINUE OP TYPE                  51250000
WRBREAK  EQU   X'16'               WR BREAK OP TYPE                     51300000
WRRESET  EQU   X'0A'               WRITE EOT OP TYPE                    51350000
RDINIT   EQU   X'81'               READ INITIAL OP TYPE                 51400000
RDBREAK  EQU   X'95'               READ BREAK OP TYPE                   51450000
TIMEOUT  EQU   X'01'               TIMEOUT BIT IN SENSE FIELD           51500000
UCBPOST  EQU   X'20'               UCBFL1 POST BIT                      51550000
TRMRESET EQU   X'01'                                                    51600000
BIDHIT   EQU   X'02'                                                    51650000
RETRIED  EQU   X'04'                                                    51700000
WREOT    EQU   X'08'               WRITING EOT INDICATOR                51750000
PURGE    EQU   X'10'               PURGE IN PROCESS INDICATOR           51800000
OPENFL   EQU   X'10'               DCB IS OPEN                          51850000
LOCALON  EQU   X'80'               MASK FOR LOCAL LCK IND.  LD @ZA00515 51857003
LOCALOFF EQU   X'7F'                                        LD @ZA00515 51864003
CMSON    EQU   X'40'               MASK FOR CMS LCK IND.    LD @ZA00515 51871003
CMSOFF   EQU   X'BF'                                        LD @ZA00515 51878003
FRRON    EQU   X'20'               MASK FOR FRR IND.        LD @ZA00515 51885003
FRROFF   EQU   X'DF'                                        LD @ZA00515 51892003
         EJECT                                                          51900000
**********                                                              51950000
*                                                                       52000000
*        MODEL BTAM CONTROL BLOCKS FOR 2740 CONSOLE                     52050000
*                                                                       52100000
**********                                                              52150000
*                                                                       52200000
*              **********                                               52250000
*              *        *                                               52300000
*              *  DCB   *                                               52350000
*              *        *                                               52400000
*              **********                                               52450000
*                                                                       52500000
DCB401   DS    0D                                                       52550000
         ORG   *+20                MOVE FORWARD PAST THE UNUSED SPACE   52600000
*                                  COMMON INTERFACE                     52650000
         DC    AL1(0),AL3(0),AL2(0)   DCBBUFNO,DCBBUFCB,DCBBUFL         52700000
         DC    X'1000'             DCBDSORG = CX                        52750000
         DC    AL1(DEVTP40),AL3(IOB401-IOBLNTH)   DCBDEVTP,DCBIOBAD     52800000
*                                  FOUNDATION EXTENSION                 52850000
         DC    AL1(0),X'16',AL2(0)   DCBBFTEK,DCBERROP = (R,W,E)        52900000
         DC    AL1(IOBLNTH),AL3(0)   DCBIOBX,DCBEXLST                   52950000
*                                  FOUNDATION SEGMENT (AFTER OPEN)      53000000
         DC    AL2(0),X'2020',AL1(0),AL3(DEB401)   DCBTIOT,DCBMACRF,    53050000
*                                  DCBIFLGS,DCBDEBAD                    53100000
         DC    AL1(0),AL3(0)       DCBOFLGS,DCBREAD/DCBWRITE            53150000
         DC    A(0)                DCBLERB                              53200000
*                                                               YM02593 53250000
*              **********                                       YM02593 53300000
*              *        *                                       YM02593 53350000
*              *  AVT   *                                       YM02593 53400000
*              *        *                                       YM02593 53450000
*              **********                                       YM02593 53500000
*                                                               YM02593 53550000
APP2740  DC    A(DEBEOEAP,DEBSIOAP,DEBPCIAP,0,0)   AVT      LD @ZA00515 53600003
*                                                                       53650000
*                                                                       53700000
*              **********                                               53750000
*              *        *                                               53800000
*              *  DECB  *                                               53850000
*              *        *                                               53900000
*              **********                                               53950000
*                                                                       54000000
         DS    0D                  TO MATCH COMMON DSECT ALIGNMENT      54050000
         READ DECB401,T,DCB401,,L'MESSAGE,,1,MF=L                       54100000
*              **********                                               54150000
*              *        *                                               54200000
*              *  IOB   *                                               54250000
*              *        *                                               54300000
*              **********                                               54350000
*                                                                       54400000
IOB401   DS    0D                                                       54450000
*                                  STANDARD FIELDS                      54500000
         DC    X'C2',AL1(0,0,0,0),AL3(DECB401)   IOBFLAG1,IOBFLAG2,     54550000
*                                  IOBSENS0,IOBSENS1,IOBECBPT           54600000
         DC    AL1(0),AL3(IOB401),XL4'00',AL1(0),AL3(CP401)   IOBFLAG3, 54650000
*                                  IOBCSW,IOBSIOCC,IOBSTART             54700000
         DC    A(DCB401,0),AL2(0,0)   IOBDCBPT,IOBRESTR,IOBINCAM,       54750000
*                                  IOBERRCT                             54800000
*                                  BTAM EXTENSION SEGMENT               54850000
         DC    AL1(0),XL7'00',XL8'00',XL16'00'   IOBUCBX,IOBWORK,       54900000
*                                  IOBERCCW,IOBERINF                    54950000
CP401    DC    28F'0'              CHANNEL PROGRAM AREA         YA02125 55000000
         DC    2F'0'               ERP EXTENSION               @ZA04667 55010000
*                                                                       55050000
*                                                                       55070000
*              **********                                               55100000
*              *        *                                               55150000
*              *  DEB   *                                               55200000
*              *        *                                               55250000
*              **********                                               55300000
*                                                                       55350000
*                                  PREFIX SECTION                       55400000
         DC    A(0),AL1((DEBEND1-DEB401)/8+1),AL3(0)  DEBDCBMK,DEBLNGTH 55450000
*                                  BASIC SECTION                        55500000
DEB401   DC    AL1(0),AL3(0)       DEBNMSUB,DEBTCBAD                    55550000
         DC    AL1(4),AL3(0)       DEBAMLNG,DEBDEBAD                    55600000
         DC    AL1(0),AL3(DEBIRB1),AL1(0),AL3(0)   DEBOFLGS,DEBIRBAD,   55650000
*                                  DEBOPATB,DEBSYSPG                    55700000
         DC    AL1(1),AL3(0),AL1(0),AL3(0)   DEBNMEXT = 1,              55750000
*                                  DEBUSPRG,DEBPRIOR,DEBECBAD           55800000
         DC    X'0F',AL3(DCB401),AL1(2),AL3(APP2740)   DEBPROTG/        55850000
*                                  DEBDEBID,DEBDCBAD,DEBEXSCL = 2,      55900000
*                                  DEBAPPAD                             55950000
*                                  DEVICE DEPENDENT SECTION             56000000
         DC    A(0)                DEBSUCBA                             56050000
DEBEND1  EQU   *                   END OF DEB                           56100000
DEBIRB1  DC    A(0)                                                     56150000
PURGE1   DC    3F'0'               PARM LIST FOR PURGE                  56200000
*                                                                       56250000
*              **********                                               56300000
*              *        *                                               56350000
*              *  SAVE  *                                               56400000
*              *  AREA  *                                               56450000
*              *        *                                               56500000
*              **********                                               56550000
*                                                                       56600000
XSAVE    DC    20F'0'                                                   56650000
*                                                                       56700000
*              **********                                               56750000
*              *        *                                               56800000
*              *  MSG   *                                               56850000
*              *  BUFFR *                                               56900000
*              *        *                                               56950000
*              **********                                               57000000
*                                                                       57050000
XMSGAREA DC    XL144'00'                                                57100000
*                                                                       57150000
**********                                                              57200000
*                                                                       57250000
*        END OF CONTROL BLOCKS                                          57300000
*                                                                       57350000
**********                                                              57400000
         EJECT                                                          57450000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 57500000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 57550000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 57600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 57650000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 57700000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 57750000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 57800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 57850000
*                                                                       57900000
*                                                                       57950000
*  XXXXX    XXXXX    X   X    X   X    XXXXX    X   X                   58000000
*  X        X   X    XX XX    XX XX    X   X    XX  X                   58050000
*  X        X   X    X X X    X X X    X   X    X X X                   58100000
*  X        X   X    X   X    X   X    X   X    X  XX                   58150000
*  X        X   X    X   X    X   X    X   X    X   X                   58200000
*  XXXXX    XXXXX    X   X    X   X    XXXXX    X   X                   58250000
*                                                                       58300000
*                                                                       58350000
*  XXX     XXXXX   XXXXX   XXXXX   XXXXX                                58400000
*  X  X    X       X       X         X                                  58450000
*  X   X   XXXXX   XXXXX   X         X                                  58500000
*  X   X       X   X       X         X                                  58550000
*  X  X        X   X       X         X                                  58600000
*  XXX     XXXXX   XXXXX   XXXXX     X                                  58650000
*                                                                       58700000
*                                                                       58750000
**********                                                      YM02593 58800000
*                                                               YM02593 58850000
*        DSECT FOR GETMAINED AREA FOR MODEL CONTROL             YM02593 58900000
*        BLOCKS IN THE FOLLOWING SEQUENCE:                      YM02593 58950000
*              DCB                 ADDRESSING LABEL = IHADCB    YM02593 59000000
*              AVT                 ADDRESSING LABEL = APPVTAB   YM02593 59050000
*              DECB                ADDRESSING LABEL = DECB      YM02593 59100000
*              IOB                 ADDRESSING LABEL = IOBSTDRD  YM02593 59150000
*              DEB                 ADDRESSING LABEL = CBDEB     YM02593 59200000
*              SAVEAREA            ADDRESSING LABEL = SAVEAREA  YM02593 59250000
*              MESSAGEAREA         ADDRESSING LABEL = MSG       YM02593 59300000
*        NOTE-THE DEB IS NOT MAPPED WITHIN THE COMMON DSECT     YM02593 59350000
*             BECAUSE THE MACRO DOES NOT ACCEPT DSECT=NO        YM02593 59400000
*                                                               YM02593 59450000
*                                                               YM02593 59500000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 59550000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 59600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 59650000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 59700000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 59750000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 59800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 59850000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 59900000
         EJECT                                                          59950000
         DS    0D                  FOR ALIGNMENT                YM02593 60000000
         DCBD  DSORG=BX                                         YM02593 60050000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 60100000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 60150000
         SPACE 5                                                        60200000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 60250000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 60300000
         ORG   DCBLERB+4                                        YM02593 60350000
APPVTAB  DS    5F                  APPENDAGE VECTOR TABLE       YM02593 60400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 60450000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 60500000
         SPACE 5                                                        60550000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 60600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 60650000
         IHADECB DSECT=NO                                       YM02593 60700000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 60750000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 60800000
         SPACE 5                                                        60850000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 60900000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 60950000
**********                                                      YM02593 61000000
*                                                               YM02593 61050000
*        THE FOLLOWING ORG IS 16 LESS THAN THE SIZE OF THE      YM02593 61100000
*        DECB SO THE IOBSTDRD FIELD OF THE IOB (NOT THE IOB     YM02593 61150000
*        PREFIX) WILL BE THE FIRST LOGICAL PORTION OF THE IOB   YM02593 61200000
*                                                               YM02593 61250000
         ORG   DECB+24                                          YM02593 61300000
         IEZIOB DSECT=NO                                        YM02593 61350000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 61400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 61450000
         SPACE 5                                                        61500000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 61550000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 61600000
         ORG   IOBSTDRD+176                                     YA02125 61650000
IOBLNTH  EQU   *-IOBSTDRD          LENGTH OF THIS IOB           YM02593 61660000
ERPEXT   DS    2F              INCREASE GETMAIN FOR THE        @ZA04667 61670000
*                              ERPEXT BY 2 FULL WORDS          @ZA04667 61700000
CBLEN1   EQU   IOBSTDRD-IHADCB     LENGTH OF DCB AND DECB       YM02593 61750000
CBDEBP   DS    2F                                                       61800000
CBDEB    DS    9F                                                       61850000
CBIRB    DS    F                                                        61900000
CBPURGE  DS    3F                                                       61950000
CBLEN2   EQU   *-IOBSTDRD                                       YM02593 62000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 62050000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 62100000
         SPACE 5                                                        62150000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 62200000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 62250000
SAVEAREA DS    18F                                              YM02593 62300000
TEMP1    DS    F                                                YM02593 62350000
TEMP2    DS    F                                                YM02593 62400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 62450000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 62500000
         SPACE 5                                                        62550000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 62600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 62650000
*                                  DSECT FOR AN INPUT MESSAGE   YM02593 62700000
MCSFLAGS EQU   0                   SVC 34 FLAGS FOR MCS SUPPORT         62750000
MSGLNTH  EQU   144                 LENGTH OF INPUT MESSAGE              62800000
PARTLNTH EQU   MSGLNTH-6           THE PARTIAL LENGTH USED IN EDITING A 62850000
*                                  MESSAGE                              62900000
MSG      EQU   *                                                YM02593 62950000
MESSLNTH DS    XL2                 LENGTH OF THIS MESSAGE               63000000
MESSFLGS DS    XL2                 IGNORED BY SVC 34                    63050000
MESSAGE  DS    CL(MSGLNTH-4)       THE MESSAGE CONTENT                  63100000
CBLEN3   EQU   *-SAVEAREA                                     LD YM7713 63150000
CBSIZ    EQU   *-IHADCB                                         YM02593 63200000
         EJECT                                                          63250000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 63300000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 63350000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 63400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 63450000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 63500000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 63550000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 63600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 63650000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 63700000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 63750000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 63800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 63850000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 63900000
*                                                                       63950000
*                                                                       64000000
*  XXXXX   X   X   XXX                                                  64050000
*  X       XX  X   X  X                                                 64100000
*  XXXXX   X X X   X   X                                                64150000
*  X       X  XX   X   X                                                64200000
*  X       X   X   X  X                                                 64250000
*  XXXXX   X   X   XXX                                                  64300000
*                                                                       64350000
*                                                                       64400000
*  XXXXX    XXXXX    X   X    X   X    XXXXX    X   X                   64450000
*  X        X   X    XX XX    XX XX    X   X    XX  X                   64500000
*  X        X   X    X X X    X X X    X   X    X X X                   64550000
*  X        X   X    X   X    X   X    X   X    X  XX                   64600000
*  X        X   X    X   X    X   X    X   X    X   X                   64650000
*  XXXXX    XXXXX    X   X    X   X    XXXXX    X   X                   64700000
*                                                                       64750000
*                                                                       64800000
*  XXX     XXXXX   XXXXX   XXXXX   XXXXX                                64850000
*  X  X    X       X       X         X                                  64900000
*  X   X   XXXXX   XXXXX   X         X                                  64950000
*  X   X       X   X       X         X                                  65000000
*  X  X        X   X       X         X                                  65050000
*  XXX     XXXXX   XXXXX   XXXXX     X                                  65100000
*                                                                       65150000
*                                                                       65200000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 65250000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 65300000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 65350000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 65400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 65450000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 65500000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 65550000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 65600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 65650000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 65700000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 65750000
         EJECT                                                          65800000
         IEZDEB LIST=YES                                                65850000
         EJECT                                                          65900000
         IKJTCB                                                         65950000
         EJECT                                                          66000000
CVT      DSECT                                                          66050000
         CVT                                                            66100000
         EJECT                                                          66150000
UCBSET   DSECT                                                          66200000
         IEFUCBOB                                                       66250000
         EJECT                                                          66300000
         IHACTM CQE                                                     66350000
         EJECT                                                          66400000
         IHACTM CXSA                                                    66450000
         EJECT                                                          66452000
         IHACTM FTPT                                                    66460000
         EJECT                                                          66470000
         IHAFRRS                                                        66480000
         EJECT                                                          66500000
         IHAPSA                                                         66550000
         EJECT                                                          66600000
         IHAIQE                                                         66650000
         EJECT                                                          66700000
         IKJRB                                                          66750000
         EJECT                                                          66800000
*                                  MACRO CALL CHANGE            YM05695 66850000
         IEECUCM FORMAT=NEW                                             66900000
         EJECT                                                          66950000
         IHAWQE                                                         67000000
         EJECT                                                          67050000
IODIRECT DSECT                                                          67100000
IODEVTP  DS    0XL1                CODE SAVED HERE FROM 'DCBDEVTP'      67150000
IODEVMOD DS    F                   ADDRESS DEVICE I/O MODULE            67200000
IONEXT   DS    0F                  NEXT DIRECTORY ENTRY                 67250000
         END                                                            67300000
