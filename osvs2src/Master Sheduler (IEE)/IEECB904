         TITLE 'IEECB904 - VARY RANGE PROCESSOR MODULE                 *00001000
                        '                                               00002000
IEECB904 CSECT ,                                                   0001 00003000
@PROLOG  BALR  @11,0                                               0001 00004000
@PSTART  DS    0H                                                  0001 00005000
         USING @PSTART,@11                                         0001 00006000
         MODID BR=YES                                                   00007000
DEFREG   DS    0H                                                  0004 00008000
*                                                                  0094 00009000
*/*                      END OF CSCB                                 */ 00010000
*                                                                  0095 00011000
         EJECT                                                          00012000
*                                                                  0095 00013000
*/********************************************************************/ 00014000
*/*                                                                  */ 00015000
*/* THIS IS THE MAIN VARY RANGE ROUTINE                              */ 00016000
*/*                                                                  */ 00017000
*/********************************************************************/ 00018000
*                                                                  0095 00019000
         SPACE 1                                                        00020000
*   IF XAARNG1=OFF THEN             /* IS THIS FIRST TIME ENTRY?     */ 00021000
         TM    XAARNG1+42(XSAPTR),B'10000000'                      0095 00022000
         BNZ   @RF00095                                            0095 00023000
*     DO;                           /* YES, DO INITIALIZATION        */ 00024000
*       CALL GETSAVE;               /* GET VARY RANGE WORKAREA       */ 00025000
         BAL   @14,GETSAVE                                         0097 00026000
*       RFY                                                        0098 00027000
*        (R8,                                                      0098 00028000
*         R10,                                                     0098 00029000
*         R12) UNRSTD;                                             0098 00030000
*       RFY                                                        0099 00031000
*         BUFF BASED(XAL);                                         0099 00032000
*       IF CHARSCAN(ONE:ONE)=LEFTPARN THEN/* IF FIRST CHAR IS A '(', */ 00033000
         L     @12,XAL-1(,XSAPTR)                                  0100 00034000
         LA    @12,0(,@12)                                         0100 00035000
         L     @10,SCANPTR(,@12)                                   0100 00036000
         CLI   CHARSCAN(@10),C'('                                  0100 00037000
         BNE   @RF00100                                            0100 00038000
*         SCANPTR=SCANPTR+ONE;      /* INDEX TO NEXT CHARACTER       */ 00039000
         AL    @10,@CF00099                                        0101 00040000
         ST    @10,SCANPTR(,@12)                                   0101 00041000
*     END;                                                         0102 00042000
*   ELSE                                                           0103 00043000
*     LM(R0,R13,REGSAVE);           /* OBTAIN REGISTERS              */ 00044000
         B     @RC00095                                            0103 00045000
@RF00095 L     @12,XAL-1(,XSAPTR)                                  0103 00046000
         LM    R0,R13,REGSAVE(@12)                                 0103 00047000
*   IF XAARNG3=OFF THEN             /* TERMINATION EXIT?             */ 00048000
@RC00095 TM    XAARNG3+42(XSAPTR),B'00100000'                      0104 00049000
         BNZ   @RF00104                                            0104 00050000
*     DO WHILE((CHARSCAN(ONE:SIX)^=ONL)&(CHARSCAN(ONE:SEVEN)^=OFFL)&(   00051000
*           CHARSCAN(ONE:SEVEN)^=COMAONL)&(CHARSCAN(ONE:EIGHT)^=   0105 00052000
*           COMAOFFL));             /* NO, WORK ON COMMAND UNTIL   0105 00053000
*                                      'ONLINE' OR 'OFFLINE'         */ 00054000
         B     @DE00105                                            0105 00055000
@DL00105 DS    0H                                                  0106 00056000
*       SWITCH=OFF;                 /* CLEAR THE SWITCH              */ 00057000
         NI    SWITCH(R9),B'01111111'                              0106 00058000
*       IF((FIRST=ZERO)&(LAST=ZERO)&(CURRENT=ZERO)) THEN/* A NEW     */ 00059000
         SLR   @12,@12                                             0107 00060000
         L     @10,XAL-1(,XSAPTR)                                  0107 00061000
         LA    @10,0(,@10)                                         0107 00062000
         CH    @12,FIRST(,@10)                                     0107 00063000
         BNE   @RF00107                                            0107 00064000
         CH    @12,LAST(,@10)                                      0107 00065000
         BNE   @RF00107                                            0107 00066000
         CH    @12,CURRENT(,@10)                                   0107 00067000
         BNE   @RF00107                                            0107 00068000
*         DO;                       /* RANGE TO BE WORKED ON?        */ 00069000
*           CALL SYNTAX;            /* YES, INSPECT THE RANGE        */ 00070000
         BAL   @14,SYNTAX                                          0109 00071000
*           IF SWITCH=ON THEN       /* IS THE RANGE CORRECT          */ 00072000
         TM    SWITCH(R9),B'10000000'                              0110 00073000
         BNO   @RF00110                                            0110 00074000
*             DO;                   /* CHARACTER-WISE?               */ 00075000
*               MSGCODE=UNITINV;    /* NO, SET ERROR CODE            */ 00076000
         MVI   MSGCODE(R9),X'01'                                   0112 00077000
*               CALL WRITEOUT;      /* WRITE OUT ERROR MESSAGE       */ 00078000
         BAL   @14,WRITEOUT                                        0113 00079000
*             END;                                                 0114 00080000
*           ELSE                    /* YES, INSERT RANGE UNITS       */ 00081000
*             CALL SETUP;           /* INTO THE NEW BUFFER           */ 00082000
         B     @RC00110                                            0115 00083000
@RF00110 BAL   @14,SETUP                                           0115 00084000
*           IF((SWITCH=OFF)&(FIRST>LAST)) THEN/* WAS A VALID RANGE   */ 00085000
@RC00110 TM    SWITCH(R9),B'10000000'                              0116 00086000
         BNZ   @RF00116                                            0116 00087000
         L     @12,XAL-1(,XSAPTR)                                  0116 00088000
         LA    @12,0(,@12)                                         0116 00089000
         CLC   FIRST(2,@12),LAST(@12)                              0116 00090000
         BNH   @RF00116                                            0116 00091000
*             DO;                   /* SPECIFIED?                    */ 00092000
*               SWITCH=ON;          /* NO, SET SWITCH ON             */ 00093000
         OI    SWITCH(R9),B'10000000'                              0118 00094000
*               MSGCODE=RANGEINV;   /* SET ERROR CODE                */ 00095000
         MVI   MSGCODE(R9),X'03'                                   0119 00096000
*               CALL WRITEOUT;      /* WRITE OUT ERROR MESSAGE       */ 00097000
         BAL   @14,WRITEOUT                                        0120 00098000
*             END;                                                 0121 00099000
*         END;                                                     0122 00100000
@RF00116 DS    0H                                                  0123 00101000
*       IF SWITCH=OFF THEN          /* IF NO ERRORS INCURRED, DO     */ 00102000
@RF00107 TM    SWITCH(R9),B'10000000'                              0123 00103000
         BNZ   @RF00123                                            0123 00104000
*         DO;                       /* FURTHER PROCESSING            */ 00105000
*           IF HIGHADDR=FOXFFF THEN /* HAS HIGH ADDRESS BEEN         */ 00106000
         L     @12,XAL-1(,XSAPTR)                                  0125 00107000
         LA    @12,0(,@12)                                         0125 00108000
         CLC   HIGHADDR(2,@12),@CH00153                            0125 00109000
         BNE   @RF00125                                            0125 00110000
*             DO;                   /* PROCESSED?                    */ 00111000
*               SWITCH=ON;          /* YES, SET SWITCH ON            */ 00112000
         OI    SWITCH(R9),B'10000000'                              0127 00113000
*               IF VALCTR=ZERO THEN /* IS THERE ANY VALID UNITS      */ 00114000
         LH    @10,VALCTR(,@12)                                    0128 00115000
         LTR   @10,@10                                             0128 00116000
         BNZ   @RF00128                                            0128 00117000
*                 DO;               /* TO BE DISPLAYED?              */ 00118000
*                   MSGCODE=UNITSINV;/* NO, SET ERROR CODE           */ 00119000
         MVI   MSGCODE(R9),X'02'                                   0130 00120000
*                   IF FIRST=LAST THEN/* IF RANGE ENDPOINTS ARE      */ 00121000
         CLC   FIRST(2,@12),LAST(@12)                              0131 00122000
         BNE   @RF00131                                            0131 00123000
*                     MSGCODE=UNITINV;/* SAME, WRITE OUT ONE UNIT    */ 00124000
         MVI   MSGCODE(R9),X'01'                                   0132 00125000
*                   IF XAARNG5=ON THEN/* ANY NON-COUNTED DEVICES?    */ 00126000
@RF00131 TM    XAARNG5+42(XSAPTR),B'00001000'                      0133 00127000
         BNO   @RF00133                                            0133 00128000
*                     MSGCODE=VARYPROC;/* YES, PUT OUT PROCESS. MSG  */ 00129000
         MVI   MSGCODE(R9),X'04'                                   0134 00130000
*                   CALL WRITEOUT;  /* WRITE OUT THE MESSAGE         */ 00131000
@RF00133 BAL   @14,WRITEOUT                                        0135 00132000
*                 END;                                             0136 00133000
*               ELSE                /* YES, DO A 'DISPLAY UNITS'     */ 00134000
*                 CALL DISPLAY;     /* FOR ALL VALID UNITS           */ 00135000
         B     @RC00128                                            0137 00136000
@RF00128 BAL   @14,DISPLAY                                         0137 00137000
*             END;                                                 0138 00138000
@RC00128 DS    0H                                                  0139 00139000
*         END;                                                     0139 00140000
@RF00125 DS    0H                                                  0140 00141000
*       IF SWITCH=ON THEN           /* WERE THERE ANY OUTPUT         */ 00142000
@RF00123 TM    SWITCH(R9),B'10000000'                              0140 00143000
         BNO   @RF00140                                            0140 00144000
*         DO;                       /* PROCESSED?                    */ 00145000
*           FIRST=ZERO;             /* YES, ZERO OUT OLD RANGE       */ 00146000
         SLR   @12,@12                                             0142 00147000
         L     @10,XAL-1(,XSAPTR)                                  0142 00148000
         LA    @10,0(,@10)                                         0142 00149000
         STH   @12,FIRST(,@10)                                     0142 00150000
*           LAST=ZERO;              /* SPECIFICATIONS FOR NEXT       */ 00151000
         STH   @12,LAST(,@10)                                      0143 00152000
*           CURRENT=ZERO;           /* PASS, IF ANY                  */ 00153000
         STH   @12,CURRENT(,@10)                                   0144 00154000
*           VALCTR=ZERO;            /* ZERO VALID UNIT COUNTER       */ 00155000
         STH   @12,VALCTR(,@10)                                    0145 00156000
*           XAARNG5=OFF;            /* TURN OFF ALT. PATH BIT        */ 00157000
         NI    XAARNG5+42(XSAPTR),B'11110111'                      0146 00158000
*           SCANPTR=SCANPTR+EIGHT;  /* UPDATE CHARACTER POINTER      */ 00159000
         LA    @12,8                                               0147 00160000
         AL    @12,SCANPTR(,@10)                                   0147 00161000
         ST    @12,SCANPTR(,@10)                                   0147 00162000
*         END;                                                     0148 00163000
*       ELSE                        /* NO OUTPUT, THEN IT MUST BE    */ 00164000
*         DO;                       /* A NEW COMMAND TO BE BUILT     */ 00165000
         B     @RC00140                                            0149 00166000
@RF00140 DS    0H                                                  0150 00167000
*           CALL BUILDER;           /* BUILD THE NEW COMMAND         */ 00168000
         BAL   @14,BUILDER                                         0150 00169000
*           IF CURRENT>LAST THEN    /* INDICATE HIGH ADDRESS HAS     */ 00170000
         L     @12,XAL-1(,XSAPTR)                                  0151 00171000
         LA    @12,0(,@12)                                         0151 00172000
         CLC   CURRENT(2,@12),LAST(@12)                            0151 00173000
         BNH   @RF00151                                            0151 00174000
*             HIGHADDR=FOXFFF;      /* BEEN REACHED                  */ 00175000
         MVC   HIGHADDR(2,@12),@CH00153                            0152 00176000
*           LM(R0,R15,REGSAVE);     /* RESTORE IEE3603D'S REGS.      */ 00177000
@RF00151 L     @12,XAL-1(,XSAPTR)                                  0153 00178000
         LM    R0,R15,REGSAVE(@12)                                 0153 00179000
*           CALL IEE36ENT;          /* PROCESS THRU VARY AREA        */ 00180000
         L     @15,@CV00275                                        0154 00181000
         BALR  @14,@15                                             0154 00182000
*         END;                                                     0155 00183000
*     END;                                                         0156 00184000
@RC00140 DS    0H                                                  0156 00185000
@DE00105 L     @12,XAL-1(,XSAPTR)                                  0156 00186000
         L     @12,SCANPTR(,@12)                                   0156 00187000
         CLC   CHARSCAN(6,@12),ONL                                 0156 00188000
         BE    @DC00105                                            0156 00189000
         CLC   CHARSCAN(7,@12),OFFL                                0156 00190000
         BE    @DC00105                                            0156 00191000
         CLC   CHARSCAN(7,@12),COMAONL                             0156 00192000
         BE    @DC00105                                            0156 00193000
         CLC   CHARSCAN(8,@12),COMAOFFL                            0156 00194000
         BNE   @DL00105                                            0156 00195000
@DC00105 DS    0H                                                  0157 00196000
*   RFY                                                            0157 00197000
*    (R10) RSTD;                    /* RESTRICT REGISTER 10          */ 00198000
@RF00104 DS    0H                                                  0158 00199000
*   CALL TERMEXIT;                  /* PREPARE FOR TERMINATION       */ 00200000
         BAL   @14,TERMEXIT                                        0158 00201000
*   R14=R10;                        /* GET CALLER'S ADDRESS          */ 00202000
         LR    R14,R10                                             0159 00203000
         EJECT                                                          00204000
*GETSAVE:                                                          0160 00205000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0160 00206000
*                                                                  0160 00207000
@EL00001 DS    0H                                                  0160 00208000
@EF00001 DS    0H                                                  0160 00209000
@ER00001 BR    @14                                                 0160 00210000
GETSAVE  DS    0H                                                  0161 00211000
*/********************************************************************/ 00212000
*/*                                                                  */ 00213000
*/* THIS SUBROUTINE IS CALLED ON A FIRST TIME ENTRY TO IEECB904 AS   */ 00214000
*/* TO ESTABLISH THE NECESSARY DATA AREAS                            */ 00215000
*/*                                                                  */ 00216000
*/********************************************************************/ 00217000
*                                                                  0161 00218000
         SPACE 1                                                        00219000
*   RFY                                                            0161 00220000
*    (R8,                                                          0161 00221000
*     R10,                                                         0161 00222000
*     R12) RSTD;                    /* RESTRICT REGISTERS            */ 00223000
*   XAARNG1=ON;                     /* INDICATE VARY RANGE IS UP     */ 00224000
         OI    XAARNG1+42(XSAPTR),B'10000000'                      0162 00225000
*   R0=GETINFO;                     /* PREPARE FOR GETMAIN           */ 00226000
         L     R0,GETINFO                                          0163 00227000
*   DO;                             /* GETMAIN (R) LV(R0)            */ 00228000
*     RESPECIFY                                                    0165 00229000
*      (GPR01F,                                                    0165 00230000
*       GPR00F) RESTRICTED;                                        0165 00231000
*     GPR00F=R0;                    /* LENGTH REQUESTED              */ 00232000
*     GPR01F=-1;                    /* INDICATE A GETMAIN REQUEST    */ 00233000
         SLR   GPR01F,GPR01F                                       0167 00234000
         BCTR  GPR01F,0                                            0167 00235000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 00236000
         SVC   10                                                  0168 00237000
*     RESPECIFY                                                    0169 00238000
*      (GPR01F,                                                    0169 00239000
*       GPR00F) UNRESTRICTED;                                      0169 00240000
*   END;                            /* GETMAIN (R) LV(R0) ISSUE    0170 00241000
*                                      GETMAIN                       */ 00242000
*   RFY                                                            0171 00243000
*     BUFF BASED(R1);                                              0171 00244000
*   BUFF(K125:K208)=''B;            /* ZERO OUT DATA AREAS           */ 00245000
         XC    BUFF+124(84,R1),BUFF+124(R1)                        0172 00246000
*   SCANPTR=XAL;                    /* SAVE OLD XAL IN DATA AREA     */ 00247000
         L     @03,XAL-1(,XSAPTR)                                  0173 00248000
         LA    @03,0(,@03)                                         0173 00249000
         ST    @03,SCANPTR(,R1)                                    0173 00250000
*   RFY                                                            0174 00251000
*     BUFF BASED(XAL);              /* ESTABLISH XAL TO POINT TO     */ 00252000
*   XAL=R1;                         /* THE NEWLY OBTAINED BUFFER     */ 00253000
         STCM  R1,7,XAL(XSAPTR)                                    0175 00254000
*   STM(R0,R15,REGSAVE);            /* SAVE IEE3603D'S REGISTERS     */ 00255000
         L     @03,XAL-1(,XSAPTR)                                  0176 00256000
         LA    @03,0(,@03)                                         0176 00257000
         STM   R0,R15,REGSAVE(@03)                                 0176 00258000
*   RFY                                                            0177 00259000
*    (R8,                                                          0177 00260000
*     R10,                                                         0177 00261000
*     R12) UNRSTD;                  /* UNRESTRICT RESTRICTED REGS    */ 00262000
*   END GETSAVE;                                                   0178 00263000
@EL00002 DS    0H                                                  0178 00264000
@EF00002 DS    0H                                                  0178 00265000
@ER00002 BR    @14                                                 0178 00266000
         EJECT                                                          00267000
*SYNTAX:                                                           0179 00268000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0179 00269000
*                                                                  0179 00270000
SYNTAX   DS    0H                                                  0180 00271000
*/********************************************************************/ 00272000
*/*                                                                  */ 00273000
*/* THIS SUBROUTINE IS CALLED TO CHECK THE VALIDITY OF EACH          */ 00274000
*/* CHARACTER IN THE RANGE SPECIFICATION                             */ 00275000
*/*                                                                  */ 00276000
*/********************************************************************/ 00277000
*                                                                  0180 00278000
         SPACE 1                                                        00279000
*   SYNPTR=SCANPTR;                 /* SET POINTER FOR SCANNING      */ 00280000
         L     @12,XAL-1(,XSAPTR)                                  0180 00281000
         L     SYNPTR,SCANPTR(,@12)                                0180 00282000
*   MSGPTR=SYNPTR;                  /* SET POINTER FOR MESSAGE       */ 00283000
         ST    SYNPTR,MSGPTR(,R9)                                  0181 00284000
*   DO COUNTERA=ONE BY ONE TO TWO WHILE SWITCH=OFF;/* SCAN THE RANGE */ 00285000
         LA    COUNTERA,1                                          0182 00286000
@DL00182 TM    SWITCH(R9),B'10000000'                              0182 00287000
         BNZ   @DC00182                                            0182 00288000
*     DO COUNTER=ONE BY ONE TO THREE;/* SCAN THE 3 DIGIT UNIT        */ 00289000
         LA    COUNTER,1                                           0183 00290000
@DL00183 DS    0H                                                  0184 00291000
*       IF(((SYNSCAN<FOXZERO)|(SYNSCAN>FOXNINE))&((SYNSCAN<ABLE)|( 0184 00292000
*           SYNSCAN>FOX))) THEN     /* IF AN INCORRECT CHARACTER     */ 00293000
         CLI   SYNSCAN(SYNPTR),C'0'                                0184 00294000
         BL    @GL00007                                            0184 00295000
         CLI   SYNSCAN(SYNPTR),C'9'                                0184 00296000
         BNH   @RF00184                                            0184 00297000
@GL00007 CLI   SYNSCAN(SYNPTR),C'A'                                0184 00298000
         BL    @RT00184                                            0184 00299000
         CLI   SYNSCAN(SYNPTR),C'F'                                0184 00300000
         BNH   @RF00184                                            0184 00301000
@RT00184 DS    0H                                                  0185 00302000
*         SWITCH=ON;                /* IS DETECTED, MARK IT          */ 00303000
         OI    SWITCH(R9),B'10000000'                              0185 00304000
*       SYNPTR=SYNPTR+ONE;          /* UPDATE TO NEXT DIGIT          */ 00305000
@RF00184 AL    SYNPTR,@CF00099                                     0186 00306000
*     END;                                                         0187 00307000
         AL    COUNTER,@CF00099                                    0187 00308000
         C     COUNTER,@CF00103                                    0187 00309000
         BNH   @DL00183                                            0187 00310000
*     IF((SYNSCAN=HYPHEN)&(SWITCH=OFF)) THEN/* END OF FIRST UNIT     */ 00311000
         CLI   SYNSCAN(SYNPTR),C'-'                                0188 00312000
         BNE   @RF00188                                            0188 00313000
         TM    SWITCH(R9),B'10000000'                              0188 00314000
         BNZ   @RF00188                                            0188 00315000
*       DO;                         /* WITHOUT ANY ERROR(S)?         */ 00316000
*         SYNPTR=SYNPTR+ONE;        /* YES, UPDATE TO NEXT UNIT      */ 00317000
         AL    SYNPTR,@CF00099                                     0190 00318000
*         MSGPTR=SYNPTR;            /* UPDATE MESSAGE POINTER        */ 00319000
         ST    SYNPTR,MSGPTR(,R9)                                  0191 00320000
*       END;                                                       0192 00321000
*   END;                                                           0193 00322000
@RF00188 AL    COUNTERA,@CF00099                                   0193 00323000
         C     COUNTERA,@CF00101                                   0193 00324000
         BNH   @DL00182                                            0193 00325000
@DC00182 DS    0H                                                  0194 00326000
*   END SYNTAX;                                                    0194 00327000
@EL00003 DS    0H                                                  0194 00328000
@EF00003 DS    0H                                                  0194 00329000
@ER00003 BR    @14                                                 0194 00330000
         EJECT                                                          00331000
*SETUP:                                                            0195 00332000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0195 00333000
*                                                                  0195 00334000
SETUP    DS    0H                                                  0196 00335000
*/********************************************************************/ 00336000
*/*                                                                  */ 00337000
*/* THIS SUBROUTINE INSERTS THE LOW AND HIGH ADDRESSES INTO ITS      */ 00338000
*/* RESPECTIVE DATA AREAS IN THE BUFFER AFTER PACKING                */ 00339000
*/*                                                                  */ 00340000
*/********************************************************************/ 00341000
*                                                                  0196 00342000
         SPACE 1                                                        00343000
*   SYNPTR=SCANPTR;                 /* SET POINTER FOR SCANNING      */ 00344000
         L     @12,XAL-1(,XSAPTR)                                  0196 00345000
         L     SYNPTR,SCANPTR(,@12)                                0196 00346000
*   DO UNTIL((SYNSCAN=COMMA)|(SYNSCAN=RGHTPARN));/* SCAN THE RANGE   */ 00347000
@DL00197 DS    0H                                                  0198 00348000
*     TEMPAREA(ONE:THREE)=MOVEUNIT; /* PUT UNIT IN TEMPORARY AREA    */ 00349000
         MVC   TEMPAREA(3,R9),MOVEUNIT(SYNPTR)                     0198 00350000
*     TEMPTR=ADDR(TEMPAREA);        /* GET TEMPORARY AREA POINTER    */ 00351000
         LA    TEMPTR,TEMPAREA(,R9)                                0199 00352000
*     DO COUNTER=ONE BY ONE TO THREE;/* SCAN THE 3 DIGIT UNIT        */ 00353000
         LA    COUNTER,1                                           0200 00354000
@DL00200 DS    0H                                                  0201 00355000
*       IF((TRANAREA(ONE:ONE)>=ABLE)&(TRANAREA(ONE:ONE)<=FOX)) THEN     00356000
         CLI   TRANAREA(TEMPTR),C'A'                               0201 00357000
         BL    @RF00201                                            0201 00358000
         CLI   TRANAREA(TEMPTR),C'F'                               0201 00359000
         BH    @RF00201                                            0201 00360000
*         TR(TRANAREA,TABLEA);      /* CONVERT IT IF 'A' TO 'F'      */ 00361000
         TR    TRANAREA(1,TEMPTR),TABLEA                           0202 00362000
*       TEMPTR=TEMPTR+ONE;          /* GO TO NEXT CHARACTER          */ 00363000
@RF00201 AL    TEMPTR,@CF00099                                     0203 00364000
*     END;                                                         0204 00365000
         AL    COUNTER,@CF00099                                    0204 00366000
         C     COUNTER,@CF00103                                    0204 00367000
         BNH   @DL00200                                            0204 00368000
*     PACK(PACKAREA(ONE:TWO),TEMPAREA(ONE:THREE));/* PACK THE 3    0205 00369000
*                                      DIGITS                        */ 00370000
         PACK  PACKAREA(2,R9),TEMPAREA(3,R9)                       0205 00371000
*     SRL(PACKAREA,FOUR);           /* SHIFT OUT THE SIGN BIT        */ 00372000
         LH    @12,PACKAREA(,R9)                                   0206 00373000
         N     @12,@CF00627                                        0206 00374000
         LA    @10,4                                               0206 00375000
         SRL   @12,0(@10)                                          0206 00376000
         STH   @12,PACKAREA(,R9)                                   0206 00377000
*     DIGIT=DIGIT&ZEROFFF;          /* REMOVE HIGH BIT               */ 00378000
         LA    @12,4095                                            0207 00379000
         LH    @10,DIGIT(,R9)                                      0207 00380000
         N     @10,@CF00627                                        0207 00381000
         NR    @12,@10                                             0207 00382000
         STH   @12,DIGIT(,R9)                                      0207 00383000
*     IF HYPHENCK=HYPHEN THEN       /* IS THIS THE FIRST UNIT OF     */ 00384000
         CLI   HYPHENCK(SYNPTR),C'-'                               0208 00385000
         BNE   @RF00208                                            0208 00386000
*       DO;                         /* THE RANGE SPECIFICATION?      */ 00387000
*         FIRST=PACKAREA;           /* YES, PUT PACKED UNIT INTO     */ 00388000
         L     @12,XAL-1(,XSAPTR)                                  0210 00389000
         LA    @12,0(,@12)                                         0210 00390000
         LH    @10,PACKAREA(,R9)                                   0210 00391000
         N     @10,@CF00627                                        0210 00392000
         STH   @10,FIRST(,@12)                                     0210 00393000
*         CURRENT=PACKAREA;         /* RESPECTIVE AREAS              */ 00394000
         STH   @10,CURRENT(,@12)                                   0211 00395000
*         SYNPTR=SYNPTR+ONE;        /* UPDATE POINTER BY ONE         */ 00396000
         AL    SYNPTR,@CF00099                                     0212 00397000
*       END;                                                       0213 00398000
*     ELSE                          /* NO, PUT PACKED UNIT INTO      */ 00399000
*       LAST=PACKAREA;              /* 'LAST' DATA AREA              */ 00400000
         B     @RC00208                                            0214 00401000
@RF00208 L     @12,XAL-1(,XSAPTR)                                  0214 00402000
         LH    @10,PACKAREA(,R9)                                   0214 00403000
         N     @10,@CF00627                                        0214 00404000
         STH   @10,LAST(,@12)                                      0214 00405000
*     SYNPTR=SYNPTR+THREE;          /* UPDATE POINTER PAST UNIT      */ 00406000
@RC00208 AL    SYNPTR,@CF00103                                     0215 00407000
*   END;                                                           0216 00408000
@DE00197 CLI   SYNSCAN(SYNPTR),C','                                0216 00409000
         BE    @DC00197                                            0216 00410000
         CLI   SYNSCAN(SYNPTR),C')'                                0216 00411000
         BNE   @DL00197                                            0216 00412000
@DC00197 DS    0H                                                  0217 00413000
*   END SETUP;                                                     0217 00414000
@EL00004 DS    0H                                                  0217 00415000
@EF00004 DS    0H                                                  0217 00416000
@ER00004 BR    @14                                                 0217 00417000
         EJECT                                                          00418000
*WRITEOUT:                                                         0218 00419000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0218 00420000
*                                                                  0218 00421000
WRITEOUT DS    0H                                                  0219 00422000
*/********************************************************************/ 00423000
*/*                                                                  */ 00424000
*/* THIS SUBROUTINE INVOKES A MESSAGE PRINTOUT                       */ 00425000
*/*                                                                  */ 00426000
*/********************************************************************/ 00427000
*                                                                  0219 00428000
         SPACE 1                                                        00429000
*   STM(R0,R1,SAVEPTRS);            /* SAVE REGISTERS 0 AND 1        */ 00430000
         STM   R0,R1,SAVEPTRS(R9)                                  0219 00431000
*   IF((MSGCODE=UNITINV)|(MSGCODE=UNITSINV)) THEN/* IS IT UNIT REF 0220 00432000
*                                      INV?                          */ 00433000
         CLI   MSGCODE(R9),X'01'                                   0220 00434000
         BE    @RT00220                                            0220 00435000
         CLI   MSGCODE(R9),X'02'                                   0220 00436000
         BNE   @RF00220                                            0220 00437000
@RT00220 DS    0H                                                  0221 00438000
*     DO;                           /* YES, PROCESS                  */ 00439000
*       MSGBUFF(ONE:K42)=UNTMSG;    /* INSERT UNIT REF INV. TEXT     */ 00440000
         L     @12,XAL-1(,XSAPTR)                                  0222 00441000
         LA    @12,0(,@12)                                         0222 00442000
         MVC   MSGBUFF(42,@12),UNTMSG                              0222 00443000
*       IF MSGCODE=UNITINV THEN     /* ONE UNIT INVALID?             */ 00444000
         CLI   MSGCODE(R9),X'01'                                   0223 00445000
         BNE   @RF00223                                            0223 00446000
*         UNIT(ONE:THREE)=MSG;      /* YES, INSERT THE UNIT          */ 00447000
         L     @10,MSGPTR(,R9)                                     0224 00448000
         MVC   UNIT(3,@12),MSG(@10)                                0224 00449000
*       ELSE                        /* NO, IT IS AN INVALID          */ 00450000
*         UNIT(ONE:SEVEN)=CHARSCAN; /* VARY RANGE SPECIFICATION      */ 00451000
         B     @RC00223                                            0225 00452000
@RF00223 L     @12,XAL-1(,XSAPTR)                                  0225 00453000
         LA    @12,0(,@12)                                         0225 00454000
         L     @10,SCANPTR(,@12)                                   0225 00455000
         MVC   UNIT(7,@12),CHARSCAN(@10)                           0225 00456000
*     END;                                                         0226 00457000
*   ELSE                                                           0227 00458000
*     DO;                                                          0227 00459000
         B     @RC00220                                            0227 00460000
@RF00220 DS    0H                                                  0228 00461000
*       IF MSGCODE=VARYPROC THEN    /* IS IT A COMPLETION CODE?      */ 00462000
         CLI   MSGCODE(R9),X'04'                                   0228 00463000
         BNE   @RF00228                                            0228 00464000
*         MSGBUFF(ONE:K44)=VRYMSG;  /* YES, SET MESSAGE TEXT         */ 00465000
         L     @12,XAL-1(,XSAPTR)                                  0229 00466000
         MVC   MSGBUFF(44,@12),VRYMSG                              0229 00467000
*       ELSE                                                       0230 00468000
*         DO;                       /* INSERT THE INVALID RANGE      */ 00469000
         B     @RC00228                                            0230 00470000
@RF00228 DS    0H                                                  0231 00471000
*           MSGBUFF(ONE:K42)=RNGMSG;/* MESSAGE TEXT                  */ 00472000
         L     @12,XAL-1(,XSAPTR)                                  0231 00473000
         LA    @12,0(,@12)                                         0231 00474000
         MVC   MSGBUFF(42,@12),RNGMSG                              0231 00475000
*           RANGE(ONE:SEVEN)=CHARSCAN;/* INSERT THE RANGE UNITS      */ 00476000
         L     @10,SCANPTR(,@12)                                   0232 00477000
         MVC   RANGE(7,@12),CHARSCAN(@10)                          0232 00478000
*         END;                                                     0233 00479000
*     END;                                                         0234 00480000
@RC00228 DS    0H                                                  0235 00481000
*   R0=ZEROZERO;                    /* CLEAR WTO REGISTER    @ZM30445*/ 00482000
@RC00220 SLR   R0,R0                                               0235 00483000
*   IF XAU^=RI THEN                 /* FROM INPUT STREAM?    @ZM30445*/ 00484000
         CLI   XAU(XSAPTR),X'80'                                   0236 00485000
         BE    @RF00236                                            0236 00486000
*     R0=XAU;                       /* INSERT CONSOLE ID     @ZM30445*/ 00487000
         SLR   R0,R0                                               0237 00488000
         IC    R0,XAU(,XSAPTR)                                     0237 00489000
*   DO;                             /* WTOP MF(E,MSGBUFF)            */ 00490000
@RF00236 DS    0H                                                  0239 00491000
*     RFY                                                          0239 00492000
*       GPR01P RSTD;                /* RESTRICT REG 1                */ 00493000
*     GPR01P=ADDR(MSGBUFF);         /* ADDRESS CONTROL PROGRAM LIST  */ 00494000
         L     GPR01P,XAL-1(,XSAPTR)                               0240 00495000
         LA    GPR01P,0(,GPR01P)                                   0240 00496000
*     SVC(35);                      /* ISSUE WTO SVC                 */ 00497000
         SVC   35                                                  0241 00498000
*     RFY                                                          0242 00499000
*       GPR01P UNRSTD;              /* RELEASE REG 1                 */ 00500000
*   END;                            /* WTOP MF(E,MSGBUFF) WRITE OUT     00501000
*                                      THE MESSAGE                   */ 00502000
*   LM(R0,R1,SAVEPTRS);             /* RESTORE REGISTERS 0 AND 1     */ 00503000
         LM    R0,R1,SAVEPTRS(R9)                                  0244 00504000
*   END WRITEOUT;                                                  0245 00505000
@EL00005 DS    0H                                                  0245 00506000
@EF00005 DS    0H                                                  0245 00507000
@ER00005 BR    @14                                                 0245 00508000
         EJECT                                                          00509000
*BUILDER:                                                          0246 00510000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0246 00511000
*                                                                  0246 00512000
BUILDER  DS    0H                                                  0247 00513000
*/********************************************************************/ 00514000
*/*                                                                  */ 00515000
*/* THIS SUBROUTINE BUILDS A NEW COMMAND IMAGE FROM A SPECIFIED      */ 00516000
*/* RANGE BY INSERTING INDIVIDUAL UNITS                              */ 00517000
*/*                                                                  */ 00518000
*/********************************************************************/ 00519000
*                                                                  0247 00520000
         SPACE 1                                                        00521000
*   OPERAND(ONE:K124)=BLANK;        /* BLANK OUT THE COMMAND IMAGE 0247 00522000
*                                      FIELD                         */ 00523000
         L     @12,XAL-1(,XSAPTR)                                  0247 00524000
         LA    @12,0(,@12)                                         0247 00525000
         MVI   OPERAND+1(@12),C' '                                 0247 00526000
         MVC   OPERAND+2(122,@12),OPERAND+1(@12)                   0247 00527000
         MVI   OPERAND(@12),C' '                                   0247 00528000
*   OPERPTR=XAL;                    /* SET POINTER TO 1ST INSERT     */ 00529000
         LR    OPERPTR,@12                                         0248 00530000
*   INSERTS(ONE:ONE)=LEFTPARN;      /* INSERT A LEFT PARENTHESIS     */ 00531000
         MVI   INSERTS(OPERPTR),C'('                               0249 00532000
*   DO COUNTER=ONE BY ONE TO K28 WHILE LAST>=CURRENT;/* INSERTION  0250 00533000
*                                      LOOP                          */ 00534000
         LA    COUNTER,1                                           0250 00535000
@DL00250 L     @12,XAL-1(,XSAPTR)                                  0250 00536000
         LA    @12,0(,@12)                                         0250 00537000
         LH    @10,CURRENT(,@12)                                   0250 00538000
         CH    @10,LAST(,@12)                                      0250 00539000
         BH    @DC00250                                            0250 00540000
*     OPERPTR=OPERPTR+ONE;          /* UPDATE INSERTION POINTER      */ 00541000
         AL    OPERPTR,@CF00099                                    0251 00542000
*     PACKAREA=CURRENT;             /* OBTAIN PACKED VALUE           */ 00543000
         STH   @10,PACKAREA(,R9)                                   0252 00544000
*SHIFTLBL:                                                         0253 00545000
*     SLL(PACKAREA,FOUR);           /* SHIFT TO PUT IN SIGN BIT ***     00546000
*                                      'SHIFTLBL' LABEL IS USED TO 0253 00547000
*                                      BREAK PLS REGISTER HISTORY ****/ 00548000
SHIFTLBL LH    @12,PACKAREA(,R9)                                   0253 00549000
         N     @12,@CF00627                                        0253 00550000
         LA    @10,4                                               0253 00551000
         SLL   @12,0(@10)                                          0253 00552000
         STH   @12,PACKAREA(,R9)                                   0253 00553000
*     DIGIT=DIGIT|ZEROFOX;          /* INSERT SIGN BIT               */ 00554000
         LA    @12,15                                              0254 00555000
         LH    @10,DIGIT(,R9)                                      0254 00556000
         N     @10,@CF00627                                        0254 00557000
         OR    @12,@10                                             0254 00558000
         STH   @12,DIGIT(,R9)                                      0254 00559000
*     UNPK(TEMPAREA(ONE:THREE),PACKAREA(ONE:TWO));/* UNPACK THE VALUE*/ 00560000
         UNPK  TEMPAREA(3,R9),PACKAREA(2,R9)                       0255 00561000
*     TR(TEMPAREA,TABLEB);          /* ASSURE CORRECT HEX VALUES     */ 00562000
         TR    TEMPAREA(3,R9),TABLEB                               0256 00563000
*     INSERTS(ONE:THREE)=TEMPAREA;  /* PUT VALUE INTO BUFFER         */ 00564000
         MVC   INSERTS(3,OPERPTR),TEMPAREA(R9)                     0257 00565000
*     OPERPTR=OPERPTR+THREE;        /* UPDATE BUFFER PAST UNIT       */ 00566000
         AL    OPERPTR,@CF00103                                    0258 00567000
*     INSERTS(ONE:ONE)=COMMA;       /* INSERT A COMMA                */ 00568000
         MVI   INSERTS(OPERPTR),C','                               0259 00569000
*     CURRENT=CURRENT+ONE;          /* INCREMENT UNIT VALUE          */ 00570000
         L     @12,XAL-1(,XSAPTR)                                  0260 00571000
         LA    @12,0(,@12)                                         0260 00572000
         LA    @10,1                                               0260 00573000
         AH    @10,CURRENT(,@12)                                   0260 00574000
         STH   @10,CURRENT(,@12)                                   0260 00575000
*   END;                                                           0261 00576000
         AL    COUNTER,@CF00099                                    0261 00577000
         C     COUNTER,@CF00113                                    0261 00578000
         BNH   @DL00250                                            0261 00579000
@DC00250 DS    0H                                                  0262 00580000
*   INSERTS(ONE:ONE)=RGHTPARN;      /* INSERT A RIGHT PARENTHESIS    */ 00581000
         MVI   INSERTS(OPERPTR),C')'                               0262 00582000
*   OPERPTR=OPERPTR+ONE;            /* UPDATE POINTER BY ONE         */ 00583000
         LA    @12,1                                               0263 00584000
         ALR   OPERPTR,@12                                         0263 00585000
*   INSERTS(ONE:ONE)=COMMA;         /* INSERT A COMMA                */ 00586000
         MVI   INSERTS(OPERPTR),C','                               0264 00587000
*   OPERPTR=OPERPTR+ONE;            /* UPDATE POINTER PAST COMMA     */ 00588000
         ALR   OPERPTR,@12                                         0265 00589000
*   IF XAARNG4=ON THEN              /* IF THIS IS ONLINE, THEN       */ 00590000
         TM    XAARNG4+42(XSAPTR),B'00010000'                      0266 00591000
         BNO   @RF00266                                            0266 00592000
*     INSERTS(ONE:SIX)=ONL;         /* INSERT 'ONLINE' KEYWORD       */ 00593000
         MVC   INSERTS(6,OPERPTR),ONL                              0267 00594000
*   ELSE                            /* NO, THIS IS OFFLINE, SO       */ 00595000
*     INSERTS(ONE:SEVEN)=OFFL;      /* INSERT 'OFFLINE' KEYWORD      */ 00596000
         B     @RC00266                                            0268 00597000
@RF00266 MVC   INSERTS(7,OPERPTR),OFFL                             0268 00598000
*   END BUILDER;                                                   0269 00599000
@EL00006 DS    0H                                                  0269 00600000
@EF00006 DS    0H                                                  0269 00601000
@ER00006 BR    @14                                                 0269 00602000
         EJECT                                                          00603000
*DISPLAY:                                                          0270 00604000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0270 00605000
*                                                                  0270 00606000
DISPLAY  DS    0H                                                  0271 00607000
*/********************************************************************/ 00608000
*/*                                                                  */ 00609000
*/* THIS SUBROUTINE IS CALLED TO ISSUE A DISPLAY UNIT FOR VALID UNITS*/ 00610000
*/*                                                                  */ 00611000
*/********************************************************************/ 00612000
*                                                                  0271 00613000
         SPACE 1                                                        00614000
*   STM(R0,R1,SAVEPTRS);            /* SAVE REGISTERS 0 AND 1        */ 00615000
         STM   R0,R1,SAVEPTRS(R9)                                  0271 00616000
*   CMDCOPY=DSPIMAGE;               /* SET UP THE COMMAND            */ 00617000
         L     @12,XAL-1(,XSAPTR)                                  0272 00618000
         LA    @12,0(,@12)                                         0272 00619000
         MVC   CMDCOPY(43,@12),DSPIMAGE                            0272 00620000
*   UNITNUM(ONE:THREE)=CHARSCAN;    /* INSERT FIRST UNIT             */ 00621000
         L     @10,SCANPTR(,@12)                                   0273 00622000
         MVC   UNITNUM(3,@12),CHARSCAN(@10)                        0273 00623000
*   CVD(VALCTR,CVDAREA);            /* CONVERT COUNT TO DECIMAL      */ 00624000
         LH    @10,VALCTR(,@12)                                    0274 00625000
         CVD   @10,CVDAREA(,R9)                                    0274 00626000
*   TEMPAREA(ONE:THREE)=CVDAREA(SIX:EIGHT);/* PREPARE FOR UNPACK     */ 00627000
         MVC   TEMPAREA(3,R9),CVDAREA+5(R9)                        0275 00628000
*   DIGITA=DIGITA|ZEROFOXA;         /* INSERT SIGN BIT               */ 00629000
         LA    @10,15                                              0276 00630000
         SLR   @08,@08                                             0276 00631000
         ICM   @08,7,DIGITA(R9)                                    0276 00632000
         OR    @10,@08                                             0276 00633000
         STCM  @10,7,DIGITA(R9)                                    0276 00634000
*   UNPK(NUMAREA(ONE:FOUR),TEMPAREA(ONE:THREE));/* UNPACK THE COUNTER*/ 00635000
         UNPK  NUMAREA(4,R9),TEMPAREA(3,R9)                        0277 00636000
*   TR(NUMAREA,TABLEB);             /* ASSURE CORRECT HEX VALUES     */ 00637000
         TR    NUMAREA(4,R9),TABLEB                                0278 00638000
*   NUMBER=NUMAREA;                 /* PUT COUNT INTO COMMAND        */ 00639000
         MVC   NUMBER(4,@12),NUMAREA(R9)                           0279 00640000
*   R0=ZEROZERO;                    /* CLEAR WTO REGISTER    @ZM30445*/ 00641000
         SLR   R0,R0                                               0280 00642000
*   IF XAU^=RI THEN                 /* FROM INPUT STREAM?    @ZM30445*/ 00643000
         CLI   XAU(XSAPTR),X'80'                                   0281 00644000
         BE    @RF00281                                            0281 00645000
*     R0=XAU;                       /* OBTAIN CONSOLE ID     @ZM30445*/ 00646000
         SLR   R0,R0                                               0282 00647000
         IC    R0,XAU(,XSAPTR)                                     0282 00648000
*   R1=XAL;                         /* OBTAIN THE COMMAND ADDRESS    */ 00649000
@RF00281 L     R1,XAL-1(,XSAPTR)                                   0283 00650000
         LA    R1,0(,R1)                                           0283 00651000
*   GENERATE;                                                      0284 00652000
*                                  /* ISSUE THE COMMAND             */  00653000
 MGCR (R1)                                                              00654000
*   LM(R0,R1,SAVEPTRS);             /* RESTORE REGISTERS 0 AND 1     */ 00655000
         LM    R0,R1,SAVEPTRS(R9)                                  0285 00656000
*   END DISPLAY;                                                   0286 00657000
@EL00007 DS    0H                                                  0286 00658000
@EF00007 DS    0H                                                  0286 00659000
@ER00007 BR    @14                                                 0286 00660000
         EJECT                                                          00661000
*TERMEXIT:                                                         0287 00662000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0287 00663000
*                                                                  0287 00664000
TERMEXIT DS    0H                                                  0288 00665000
*/********************************************************************/ 00666000
*/*                                                                  */ 00667000
*/* THIS SUBROUTINE IS CALLED TO PROCESS A PREPARATION FOR A RETURN  */ 00668000
*/* TO CALLER                                                        */ 00669000
*/*                                                                  */ 00670000
*/********************************************************************/ 00671000
*                                                                  0288 00672000
         SPACE 1                                                        00673000
*CDEQUE:                                                           0288 00674000
*   DO;                             /* DEQ LS(2) MF(E,IEFDEQ)        */ 00675000
CDEQUE   DS    0H                                                  0289 00676000
*     RFY                                                          0289 00677000
*       GPR01F RESTRICTED;                                         0289 00678000
*     GPR01F=ADDR(IEFDEQ02);                                       0290 00679000
         LA    GPR01F,IEFDEQ02                                     0290 00680000
*     SVC(48);                                                     0291 00681000
         SVC   48                                                  0291 00682000
*     RFY                                                          0292 00683000
*       GPR01F UNRESTRICTED;                                       0292 00684000
*   END;                            /* DEQ LS(2) MF(E,IEFDEQ) RELEASE   00685000
*                                      THE RESOURCES                 */ 00686000
*   RFY                                                            0294 00687000
*    (R10) RSTD;                                                   0294 00688000
*   LM(R0,R13,REGSAVE);             /* RETREIVE PERTINENT REGS       */ 00689000
         L     @12,XAL-1(,XSAPTR)                                  0295 00690000
         LM    R0,R13,REGSAVE(@12)                                 0295 00691000
*   R0=IEE36GMP;                    /* PREPARE FOR FREEMAIN          */ 00692000
         ICM   R0,15,IEE36GMP                                      0296 00693000
*   DO;                             /* FREEMAIN(R) LV(R0)A(IEE36WRK) */ 00694000
*     RESPECIFY                                                    0298 00695000
*      (GPR01F,                                                    0298 00696000
*       GPR00F) RESTRICTED;                                        0298 00697000
*     GPR00F=R0;                    /* LENGTH REQUESTED              */ 00698000
*     GPR01F=ADDR(IEE36WRK);        /* SET REGISTER ONE              */ 00699000
         LR    GPR01F,R8                                           0300 00700000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 00701000
         SVC   10                                                  0301 00702000
*     RESPECIFY                                                    0302 00703000
*      (GPR01F,                                                    0302 00704000
*       GPR00F) UNRESTRICTED;                                      0302 00705000
*   END;                            /* FREEMAIN(R) LV(R0)A(IEE36WRK)    00706000
*                                      FREE IEE3603D'S WORK AREA     */ 00707000
*   R0=DATAAREA;                    /* PREPARE FOR FREEMAIN          */ 00708000
         L     R0,DATAAREA                                         0304 00709000
*   DO;                             /* FREEMAIN(R) LV(R0)A(WORKAREA) */ 00710000
*     RESPECIFY                                                    0306 00711000
*      (GPR01F,                                                    0306 00712000
*       GPR00F) RESTRICTED;                                        0306 00713000
*     GPR00F=R0;                    /* LENGTH REQUESTED              */ 00714000
*     GPR01F=ADDR(WORKAREA);        /* SET REGISTER ONE              */ 00715000
         LR    GPR01F,R9                                           0308 00716000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 00717000
         SVC   10                                                  0309 00718000
*     RESPECIFY                                                    0310 00719000
*      (GPR01F,                                                    0310 00720000
*       GPR00F) UNRESTRICTED;                                      0310 00721000
*   END;                            /* FREEMAIN(R) LV(R0)A(WORKAREA)    00722000
*                                      FREE THE DATA AREA CORE       */ 00723000
*   IF RANGEXAP^=ZEROZERO THEN      /* DID WE LOAD IEEVDEV?          */ 00724000
         L     @12,XAL-1(,XSAPTR)                                  0312 00725000
         L     @12,RANGEXAP(,@12)                                  0312 00726000
         LTR   @12,@12                                             0312 00727000
         BZ    @RF00312                                            0312 00728000
*     DO;                           /* YES, DELETE IEEVDEV           */ 00729000
*       DO;                         /* DELETE EP(IEEVDEV)            */ 00730000
*         RESPECIFY                                                0315 00731000
*          (GPR00P) RESTRICTED;                                    0315 00732000
*         GPR00P=ADDR(IEEVDEV);     /* ->ENTRY NAME                  */ 00733000
         LA    GPR00P,@CC00097                                     0316 00734000
*         SVC(9);                   /* DELETE SVC                    */ 00735000
         SVC   9                                                   0317 00736000
*         RESPECIFY                                                0318 00737000
*          (GPR00P) UNRESTRICTED;                                  0318 00738000
*       END;                        /* DELETE EP(IEEVDEV) DELETE   0319 00739000
*                                      IEEVDEV                       */ 00740000
*       RANGEXAP=ZEROZERO;          /* INDICATE IEEVDEV DELETED      */ 00741000
         SLR   @12,@12                                             0320 00742000
         L     @08,XAL-1(,XSAPTR)                                  0320 00743000
         LA    @08,0(,@08)                                         0320 00744000
         ST    @12,RANGEXAP(,@08)                                  0320 00745000
*       IF RANGEXAD^=ZEROZERO THEN  /* IEEVDEV CORE EXISTING?        */ 00746000
         L     @08,RANGEXAD(,@08)                                  0321 00747000
         CR    @08,@12                                             0321 00748000
         BE    @RF00321                                            0321 00749000
*         DO;                       /* YES, FREE IEEVDEV CORE        */ 00750000
*           R0=THREE08;             /* GET IEEVDEV CORE SIZE         */ 00751000
         ICM   R0,15,THREE08                                       0323 00752000
*           DO;                     /* FREEMAIN(R) LV(R0)A(VDEVCORE) */ 00753000
*             RESPECIFY                                            0325 00754000
*              (GPR01F,                                            0325 00755000
*               GPR00F) RESTRICTED;                                0325 00756000
*             GPR00F=R0;            /* LENGTH REQUESTED              */ 00757000
*             GPR01F=ADDR(VDEVCORE);/* SET REGISTER ONE              */ 00758000
         LR    GPR01F,@08                                          0327 00759000
*             SVC(10);              /* R-FORM OF GETMAIN             */ 00760000
         SVC   10                                                  0328 00761000
*             RESPECIFY                                            0329 00762000
*              (GPR01F,                                            0329 00763000
*               GPR00F) UNRESTRICTED;                              0329 00764000
*           END;                    /* FREEMAIN(R) LV(R0)A(VDEVCORE)    00765000
*                                      FREE THE IEEVDEV CORE         */ 00766000
*           RANGEXAD=ZEROZERO;      /* INDICATE CORE FREED           */ 00767000
         L     @12,XAL-1(,XSAPTR)                                  0331 00768000
         SLR   @08,@08                                             0331 00769000
         ST    @08,RANGEXAD(,@12)                                  0331 00770000
*         END;                                                     0332 00771000
*     END;                                                         0333 00772000
@RF00321 DS    0H                                                  0334 00773000
*   R0=GETINFO;                     /* PREPARE FOR FREEMAIN          */ 00774000
@RF00312 L     R0,GETINFO                                          0334 00775000
*   DO;                             /* FREEMAIN(R) LV(R0)A(XALCORE)  */ 00776000
*     RESPECIFY                                                    0336 00777000
*      (GPR01F,                                                    0336 00778000
*       GPR00F) RESTRICTED;                                        0336 00779000
*     GPR00F=R0;                    /* LENGTH REQUESTED              */ 00780000
*     GPR01F=ADDR(XALCORE);         /* SET REGISTER ONE              */ 00781000
         L     GPR01F,XAL-1(,XSAPTR)                               0338 00782000
         LA    GPR01F,0(,GPR01F)                                   0338 00783000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 00784000
         SVC   10                                                  0339 00785000
*     RESPECIFY                                                    0340 00786000
*      (GPR01F,                                                    0340 00787000
*       GPR00F) UNRESTRICTED;                                      0340 00788000
*   END;                            /* FREEMAIN(R) LV(R0)A(XALCORE)     00789000
*                                      FREE THE BUFFER CORE          */ 00790000
*   R1=CSCBPTR;                     /* GET THE CSCB POINTER          */ 00791000
         L     @12,CSCBPTR(,R13)                                   0342 00792000
         LR    R1,@12                                              0342 00793000
*   CHFC=ON;                        /* SET FREE CSCB BIT             */ 00794000
         OI    CHFC(@12),B'00000010'                               0343 00795000
*   GENERATE;                                                      0344 00796000
*                                  /* DECHAIN THE CSCB FOR THIS     */  00797000
 MGCR (R1),CHAIN                   /* COMMAND                       */  00798000
*   R0=K132;                        /* GET XSA SIZE                  */ 00799000
         LA    R0,132                                              0345 00800000
*   DO;                             /* FREEMAIN(R) LV(R0)A(XSAVARY)  */ 00801000
*     RESPECIFY                                                    0347 00802000
*      (GPR01F,                                                    0347 00803000
*       GPR00F) RESTRICTED;                                        0347 00804000
*     GPR00F=R0;                    /* LENGTH REQUESTED              */ 00805000
*     GPR01F=ADDR(XSAVARY);         /* SET REGISTER ONE              */ 00806000
         LR    GPR01F,R2                                           0349 00807000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 00808000
         SVC   10                                                  0350 00809000
*     RESPECIFY                                                    0351 00810000
*      (GPR01F,                                                    0351 00811000
*       GPR00F) UNRESTRICTED;                                      0351 00812000
*   END;                            /* FREEMAIN(R) LV(R0)A(XSAVARY)     00813000
*                                      FREE THE XSA CORE             */ 00814000
*   END TERMEXIT;                                                  0353 00815000
@EL00008 DS    0H                                                  0353 00816000
@EF00008 DS    0H                                                  0353 00817000
@ER00008 BR    @14                                                 0353 00818000
*   RFY                                                            0354 00819000
*    (R10) UNRSTD;                                                 0354 00820000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 00821000
*     GPR00F FIXED(31) REG(0),                                     0355 00822000
*     GPR01F FIXED(31) REG(1),                                     0355 00823000
*     GPR00P PTR(31) REG(0),                                       0355 00824000
*     GPR01P PTR(31) REG(1);                                       0355 00825000
*   DECLARE                         /* COMMON VARIABLES              */ 00826000
*     I256C CHAR(256) BASED,                                       0356 00827000
*     I031F FIXED(31) BASED,                                       0356 00828000
*     I031P PTR(31) BASED,                                         0356 00829000
*     I015F FIXED(15) BASED,                                       0356 00830000
*     I015P PTR(15) BASED,                                         0356 00831000
*     I008P PTR(8) BASED,                                          0356 00832000
*     I001C CHAR(1) BASED;                                         0356 00833000
*   END IEECB904                                                   0357 00834000
*                                                                  0357 00835000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00836000
*/*%INCLUDE SYSLIB  (IEEXSA  )                                       */ 00837000
*/*%INCLUDE SYSLIB  (IEECHAIN)                                       */ 00838000
*                                                                  0357 00839000
*       ;                                                          0357 00840000
@DATA    DS    0H                                                       00841000
@CH00153 DC    XL2'FFFF'                                                00842000
@DATD    DSECT                                                          00843000
         DS    0F                                                       00844000
IEECB904 CSECT                                                          00845000
         DS    0F                                                       00846000
@CF00627 DC    XL4'0000FFFF'                                            00847000
@CF00099 DC    XL4'01'                                                  00848000
@CF00101 DC    XL4'02'                                                  00849000
@CF00103 DC    XL4'03'                                                  00850000
@CF00113 DC    XL4'1C'                                                  00851000
@DATD    DSECT                                                          00852000
         DS    0D                                                       00853000
IEECB904 CSECT                                                          00854000
         NOPR  ((@ENDDATD-@DATD)*16)                                    00855000
         DS    0F                                                       00856000
@SIZDATD DC    AL1(0)                                                   00857000
         DC    AL3(@ENDDATD-@DATD)                                      00858000
@CV00275 DC    V(IEE36ENT)                                              00859000
         DS    0D                                                       00860000
@CC00085 DC    C'SYSIEFSD'                                              00861000
@CC00097 DC    C'IEEVDEV '                                              00862000
@CC00091 DC    C'VARYDEV'                                               00863000
@CC00088 DC    C'Q4'                                                    00864000
         DS    CL3                                                      00865000
GETINFO  DS    CL4                                                      00866000
         ORG   GETINFO                                                  00867000
SBPOOL   DC    X'E6'                                                    00868000
SPSIZE   DC    AL3(208)                                                 00869000
         ORG   GETINFO+4                                                00870000
IEE36GMP DS    CL4                                                      00871000
         ORG   IEE36GMP                                                 00872000
SBPOOLA  DC    X'E5'                                                    00873000
ZEROES   DC    X'0000'                                                  00874000
SPSIZEA  DC    X'13'                                                    00875000
         ORG   IEE36GMP+4                                               00876000
DATAAREA DS    CL4                                                      00877000
         ORG   DATAAREA                                                 00878000
SBPOOLB  DC    X'E5'                                                    00879000
SPSIZEB  DC    AL3(32)                                                  00880000
         ORG   DATAAREA+4                                               00881000
COMAONL  DS    CL7                                                      00882000
         ORG   COMAONL                                                  00883000
@NM00001 DC    CL1','                                                   00884000
ONL      DC    CL6'ONLINE'                                              00885000
         ORG   COMAONL+7                                                00886000
COMAOFFL DS    CL8                                                      00887000
         ORG   COMAOFFL                                                 00888000
@NM00002 DC    CL1','                                                   00889000
OFFL     DC    CL7'OFFLINE'                                             00890000
         ORG   COMAOFFL+8                                               00891000
THREE08  DS    CL4                                                      00892000
         ORG   THREE08                                                  00893000
SBPOOLC  DC    X'00'                                                    00894000
ZEROESB  DC    X'00'                                                    00895000
SPSIZEC  DC    X'0134'                                                  00896000
         ORG   THREE08+4                                                00897000
         DS    CL1                                                      00898000
UNTMSG   DS    CL42                                                     00899000
         ORG   UNTMSG                                                   00900000
UNTMSG01 DC    H'38'                                                    00901000
UNTMSG02 DC    B'1110000000000000'                                      00902000
UNTMSG03 DC    CL34'IEE313I          UNIT REF. INVALID'                 00903000
UNTMSG04 DC    B'0000100000000000'                                      00904000
UNTMSG05 DC    B'0000000000000000'                                      00905000
         ORG   UNTMSG+42                                                00906000
         DS    CL2                                                      00907000
RNGMSG   DS    CL42                                                     00908000
         ORG   RNGMSG                                                   00909000
RNGMSG01 DC    H'38'                                                    00910000
RNGMSG02 DC    B'1110000000000000'                                      00911000
RNGMSG03 DC    CL34'IEE779I VARY         RANGE INVALID'                 00912000
RNGMSG04 DC    B'0000100000000000'                                      00913000
RNGMSG05 DC    B'0000000000000000'                                      00914000
         ORG   RNGMSG+42                                                00915000
         DS    CL2                                                      00916000
VRYMSG   DS    CL44                                                     00917000
         ORG   VRYMSG                                                   00918000
VRYMSG01 DC    H'40'                                                    00919000
VRYMSG02 DC    B'1110000000000000'                                      00920000
VRYMSG03 DC    CL36'IEE712I VARY     PROCESSING COMPLETE'               00921000
VRYMSG04 DC    B'0000100000000000'                                      00922000
VRYMSG05 DC    B'0000000000000000'                                      00923000
         ORG   VRYMSG+44                                                00924000
DSPIMAGE DS    CL43                                                     00925000
         ORG   DSPIMAGE                                                 00926000
HEAD1    DC    XL2'002B'                                                00927000
HEAD2    DC    XL2'0000'                                                00928000
DUCMD    DC    CL39'D U,,,DDD,NNNN,L=Z   VARY RANGE DISPLAY'            00929000
         ORG   DSPIMAGE+43                                              00930000
PATCH    DC    CL80'*** IEECB904 PATCH AREA ***'                        00931000
         DS    CL1                                                      00932000
IEFDEQ   DS    CL1                                                      00933000
         ORG   IEFDEQ                                                   00934000
IEFDEQ01 DS    AL4                                                      00935000
IEFDEQ02 DS    CL12                                                     00936000
         ORG   IEFDEQ02+0                                               00937000
IEFDEQ03 DC    B'01000000'                                              00938000
IEFDEQ04 DC    AL1(2)                                                   00939000
IEFDEQ05 DC    B'01000001'                                              00940000
@NM00007 DS    CL1                                                      00941000
IEFDEQ06 DC    AL4(@CC00085)                                            00942000
IEFDEQ07 DC    AL4(@CC00088)                                            00943000
         ORG   IEFDEQ02+12                                              00944000
         ORG   IEFDEQ02+12                                              00945000
         DC    B'11000000'                                              00946000
         DC    AL1(7)                                                   00947000
         DC    B'01000001'                                              00948000
         DS    CL1                                                      00949000
         DC    AL4(@CC00085)                                            00950000
         DC    AL4(@CC00091)                                            00951000
         ORG   IEFDEQ+28                                                00952000
IEFDEQ08 DS    AL4                                                      00953000
         ORG   IEFDEQ+32                                                00954000
@DATD    DSECT                                                          00955000
IEECB904 CSECT                                                          00956000
TABLEA   EQU *-C'A'                                                     00957000
         DC  X'FAFBFCFDFEFF'                                            00958000
TABLEB   EQU *-C'0'                                                     00959000
         DC  C'0123456789ABCDEF'                                        00960000
@DATD    DSECT                                                          00961000
@ENDDATD EQU   *                                                        00962000
IEECB904 CSECT                                                          00963000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00964000
@01      EQU   01                                                       00965000
@02      EQU   02                                                       00966000
@03      EQU   03                                                       00967000
@04      EQU   04                                                       00968000
@05      EQU   05                                                       00969000
@06      EQU   06                                                       00970000
@07      EQU   07                                                       00971000
@08      EQU   08                                                       00972000
@09      EQU   09                                                       00973000
@10      EQU   10                                                       00974000
@11      EQU   11                                                       00975000
@12      EQU   12                                                       00976000
@13      EQU   13                                                       00977000
@14      EQU   14                                                       00978000
@15      EQU   15                                                       00979000
TEMPTR   EQU   @04                                                      00980000
OPERPTR  EQU   @03                                                      00981000
COUNTERA EQU   @04                                                      00982000
COUNTER  EQU   @05                                                      00983000
SYNPTR   EQU   @03                                                      00984000
R9       EQU   @09                                                      00985000
R0       EQU   @00                                                      00986000
R1       EQU   @01                                                      00987000
R2       EQU   @02                                                      00988000
R8       EQU   @08                                                      00989000
R10      EQU   @10                                                      00990000
R12      EQU   @12                                                      00991000
R13      EQU   @13                                                      00992000
R14      EQU   @14                                                      00993000
R15      EQU   @15                                                      00994000
XSAPTR   EQU   @02                                                      00995000
GPR01F   EQU   @01                                                      00996000
GPR00F   EQU   @00                                                      00997000
GPR01P   EQU   @01                                                      00998000
GPR00P   EQU   @00                                                      00999000
R11      EQU   @11                                                      01000000
R3       EQU   @03                                                      01001000
R4       EQU   @04                                                      01002000
R5       EQU   @05                                                      01003000
R6       EQU   @06                                                      01004000
R7       EQU   @07                                                      01005000
XALCORE  EQU   0                                                        01006000
XSAVARY  EQU   0                                                        01007000
IEE36WRK EQU   0                                                        01008000
VDEVCORE EQU   0                                                        01009000
CHARSCAN EQU   0                                                        01010000
SYNSCAN  EQU   0                                                        01011000
MSG      EQU   0                                                        01012000
INSERTS  EQU   0                                                        01013000
TRANAREA EQU   0                                                        01014000
BUFF     EQU   0                                                        01015000
OPERAND  EQU   BUFF                                                     01016000
FIRST    EQU   BUFF+124                                                 01017000
LAST     EQU   BUFF+126                                                 01018000
CURRENT  EQU   BUFF+128                                                 01019000
VALCTR   EQU   BUFF+130                                                 01020000
SCANPTR  EQU   BUFF+132                                                 01021000
RANGEXAD EQU   BUFF+136                                                 01022000
RANGEXAP EQU   BUFF+140                                                 01023000
REGSAVE  EQU   BUFF+144                                                 01024000
MGCRCSCB EQU   0                                                        01025000
CSCBPTR  EQU   MGCRCSCB+64                                              01026000
WORKAREA EQU   0                                                        01027000
MSGPTR   EQU   WORKAREA                                                 01028000
SWAREA   EQU   WORKAREA+4                                               01029000
SWITCH   EQU   SWAREA                                                   01030000
MSGCODE  EQU   WORKAREA+5                                               01031000
PACKAREA EQU   WORKAREA+6                                               01032000
CVDAREA  EQU   WORKAREA+8                                               01033000
NUMAREA  EQU   CVDAREA                                                  01034000
SAVEPTRS EQU   WORKAREA+16                                              01035000
TEMPAREA EQU   WORKAREA+24                                              01036000
SYNSCANA EQU   0                                                        01037000
MOVEUNIT EQU   SYNSCANA                                                 01038000
HYPHENCK EQU   SYNSCANA+3                                               01039000
MSGBUFF  EQU   0                                                        01040000
BUF313   EQU   0                                                        01041000
UNIT     EQU   BUF313+12                                                01042000
BUF779   EQU   0                                                        01043000
RANGE    EQU   BUF779+17                                                01044000
CMDCOPY  EQU   0                                                        01045000
UNITNUM  EQU   CMDCOPY+10                                               01046000
NUMBER   EQU   CMDCOPY+14                                               01047000
XSAMAP   EQU   0                                                        01048000
XASVRB   EQU   XSAMAP                                                   01049000
XSA      EQU   XASVRB                                                   01050000
XAD      EQU   XSA+4                                                    01051000
XAX      EQU   XASVRB+8                                                 01052000
@NM00008 EQU   XASVRB+16                                                01053000
@NM00009 EQU   XASVRB+20                                                01054000
XAL      EQU   @NM00009+1                                               01055000
XAS      EQU   XASVRB+32                                                01056000
XAU      EQU   XASVRB+40                                                01057000
XAA      EQU   XASVRB+42                                                01058000
XASAVLOC EQU   XSAMAP+48                                                01059000
XASAVLOX EQU   XASAVLOC                                                 01060000
XASAVSTD EQU   XSAMAP+64                                                01061000
XASAVSTR EQU   XASAVSTD                                                 01062000
EEXSAS01 EQU   0                                                        01063000
EEXSAS02 EQU   0                                                        01064000
XADUSWIT EQU   EEXSAS02                                                 01065000
EEXSAS03 EQU   0                                                        01066000
XASDS    EQU   EEXSAS03+2                                               01067000
@NM00012 EQU   EEXSAS03+4                                               01068000
EEXSAS04 EQU   0                                                        01069000
XAXMASK  EQU   EEXSAS04                                                 01070000
EEXSAS05 EQU   0                                                        01071000
XASOPCOD EQU   EEXSAS05                                                 01072000
XASWITCH EQU   EEXSAS05+1                                               01073000
XALTCHG  EQU   XASWITCH                                                 01074000
XACOMPMS EQU   XASWITCH                                                 01075000
XARESV   EQU   EEXSAS05+2                                               01076000
EEXSAS06 EQU   0                                                        01077000
XAAVRANG EQU   EEXSAS06                                                 01078000
XAARNG1  EQU   XAAVRANG                                                 01079000
XAARNG3  EQU   XAAVRANG                                                 01080000
XAARNG4  EQU   XAAVRANG                                                 01081000
XAARNG5  EQU   XAAVRANG                                                 01082000
XAAVRNG2 EQU   EEXSAS06+1                                               01083000
CHAIN    EQU   0                                                        01084000
CHFLG    EQU   CHAIN+4                                                  01085000
CHSTS    EQU   CHFLG+2                                                  01086000
CHFC     EQU   CHSTS                                                    01087000
CHACT    EQU   CHFLG+3                                                  01088000
CHKEY    EQU   CHAIN+8                                                  01089000
CHPARM   EQU   CHKEY                                                    01090000
CHPKE    EQU   CHAIN+28                                                 01091000
CHTJID   EQU   CHAIN+30                                                 01092000
CHPROCSN EQU   CHAIN+32                                                 01093000
CHACT1   EQU   CHPROCSN+3                                               01094000
CHASM    EQU   CHAIN+40                                                 01095000
CHCIBP   EQU   CHASM+4                                                  01096000
CHRGNSZ  EQU   CHASM+8                                                  01097000
CHSTEP   EQU   CHASM+24                                                 01098000
CHSWT    EQU   CHSTEP                                                   01099000
CHSHORT  EQU   CHASM+32                                                 01100000
I001C    EQU   0                                                        01101000
I008P    EQU   0                                                        01102000
I015F    EQU   0                                                        01103000
I015P    EQU   0                                                        01104000
I031F    EQU   0                                                        01105000
I031P    EQU   0                                                        01106000
I256C    EQU   0                                                        01107000
DIGIT    EQU   PACKAREA                                                 01108000
DIGITA   EQU   TEMPAREA                                                 01109000
HIGHADDR EQU   CURRENT                                                  01110000
CHAINS01 EQU   CHASM                                                    01111000
CHTYPE   EQU   CHAINS01+124                                             01112000
CHTRSTAT EQU   CHAINS01+125                                             01113000
CHCSYSO  EQU   CHAINS01+134                                             01114000
*                                      START UNREFERENCED COMPONENTS    01115000
CHLAST   EQU   CHAINS01+136                                             01116000
CHSPA    EQU   CHAINS01+135                                             01117000
CHUSERID EQU   CHCSYSO                                                  01118000
CHJB     EQU   CHCSYSO                                                  01119000
CHDUMP   EQU   CHCSYSO                                                  01120000
CHQUE    EQU   CHCSYSO                                                  01121000
CHHOLD   EQU   CHCSYSO                                                  01122000
CHOUT    EQU   CHCSYSO                                                  01123000
CHINN    EQU   CHCSYSO                                                  01124000
CHALL    EQU   CHCSYSO                                                  01125000
CHINC    EQU   CHAINS01+132                                             01126000
CHPEND   EQU   CHAINS01+128                                             01127000
CHARID   EQU   CHAINS01+127                                             01128000
CHCNID   EQU   CHAINS01+126                                             01129000
@NM00018 EQU   CHTRSTAT                                                 01130000
CHTSL    EQU   CHTRSTAT                                                 01131000
CHTS     EQU   CHTRSTAT                                                 01132000
CHINITL  EQU   CHTRSTAT                                                 01133000
CHINIT   EQU   CHTRSTAT                                                 01134000
CHJOBSL  EQU   CHTRSTAT                                                 01135000
CHJOBS   EQU   CHTRSTAT                                                 01136000
CHDEF    EQU   CHTYPE                                                   01137000
CHHIAR   EQU   CHTYPE                                                   01138000
CHARSV29 EQU   CHTYPE                                                   01139000
CHARSV28 EQU   CHTYPE                                                   01140000
CHARSV27 EQU   CHTYPE                                                   01141000
CHARSV26 EQU   CHTYPE                                                   01142000
CHARSV25 EQU   CHTYPE                                                   01143000
CHDSTAT  EQU   CHTYPE                                                   01144000
CHBUF    EQU   CHAINS01                                                 01145000
CHARSV16 EQU   CHSHORT+100                                              01146000
CHARSV15 EQU   CHSHORT+96                                               01147000
CHJSCBVS EQU   CHSHORT+92                                               01148000
CHUSCVS  EQU   CHSHORT+88                                               01149000
@NM00017 EQU   CHSHORT+84                                               01150000
@NM00016 EQU   CHSHORT+80                                               01151000
CHSQA    EQU   CHSHORT+44                                               01152000
CHQPA    EQU   CHSHORT+8                                                01153000
CHJCL    EQU   CHSHORT+4                                                01154000
CHSPC    EQU   CHSHORT                                                  01155000
CHSPB    EQU   CHSTEP+4                                                 01156000
CHTCB    EQU   CHSTEP+1                                                 01157000
CHARSV23 EQU   CHSWT                                                    01158000
CHARSV22 EQU   CHSWT                                                    01159000
CHARSV21 EQU   CHSWT                                                    01160000
CHAC     EQU   CHSWT                                                    01161000
CHPSF    EQU   CHSWT                                                    01162000
CHPSD    EQU   CHSWT                                                    01163000
CHJCT    EQU   CHSWT                                                    01164000
CHARSV20 EQU   CHSWT                                                    01165000
CHCECB   EQU   CHASM+20                                                 01166000
CHECB    EQU   CHASM+16                                                 01167000
CHRGNAD  EQU   CHASM+12                                                 01168000
CHARSV18 EQU   CHRGNSZ+1                                                01169000
CHRPRTY  EQU   CHRGNSZ                                                  01170000
@NM00015 EQU   CHCIBP                                                   01171000
CHEND    EQU   CHCIBP                                                   01172000
CHECBP   EQU   CHASM                                                    01173000
CHDER    EQU   CHPROCSN+4                                               01174000
CHARSV10 EQU   CHACT1                                                   01175000
CHARSV09 EQU   CHACT1                                                   01176000
CHARSV08 EQU   CHACT1                                                   01177000
CHARSV07 EQU   CHACT1                                                   01178000
CHARSV06 EQU   CHACT1                                                   01179000
CHARSV05 EQU   CHACT1                                                   01180000
CHARSV04 EQU   CHACT1                                                   01181000
CHRDWTR  EQU   CHACT1                                                   01182000
CHARSV30 EQU   CHPROCSN+2                                               01183000
CHQID    EQU   CHPROCSN                                                 01184000
CHASID   EQU   CHTJID                                                   01185000
CHUCMP   EQU   CHAIN+29                                                 01186000
CHTRKID  EQU   CHPKE                                                    01187000
CHCIBCTR EQU   CHAIN+27                                                 01188000
CHUNIT   EQU   CHAIN+24                                                 01189000
CHCLS    EQU   CHAIN+16                                                 01190000
CHPCOI   EQU   CHPARM                                                   01191000
CHIFY    EQU   CHACT                                                    01192000
CHAIFX   EQU   CHACT                                                    01193000
CHCLD    EQU   CHACT                                                    01194000
CHCL     EQU   CHACT                                                    01195000
CHDSI    EQU   CHACT                                                    01196000
CHDISC   EQU   CHACT                                                    01197000
CHTERM   EQU   CHACT                                                    01198000
CHSWAP   EQU   CHACT                                                    01199000
CHABTERM EQU   CHSTS                                                    01200000
CHDL     EQU   CHSTS                                                    01201000
CHAD     EQU   CHSTS                                                    01202000
CHQSPC   EQU   CHSTS                                                    01203000
CHSOUT   EQU   CHSTS                                                    01204000
CHSYS    EQU   CHSTS                                                    01205000
CHAP     EQU   CHSTS                                                    01206000
CHSZE    EQU   CHFLG+1                                                  01207000
CHVCD    EQU   CHFLG                                                    01208000
CHPTR    EQU   CHAIN                                                    01209000
XAARNG16 EQU   XAAVRNG2                                                 01210000
XAARNG15 EQU   XAAVRNG2                                                 01211000
XAARNG14 EQU   XAAVRNG2                                                 01212000
XAARNG13 EQU   XAAVRNG2                                                 01213000
XAARNG12 EQU   XAAVRNG2                                                 01214000
XAARNG11 EQU   XAAVRNG2                                                 01215000
XAARNG10 EQU   XAAVRNG2                                                 01216000
XAARNG9  EQU   XAAVRNG2                                                 01217000
XAARNG8  EQU   XAAVRANG                                                 01218000
XAARNG7  EQU   XAAVRANG                                                 01219000
XAARNG6  EQU   XAAVRANG                                                 01220000
XAARNG2  EQU   XAAVRANG                                                 01221000
XARTCODE EQU   EEXSAS05+6                                               01222000
XACMDATH EQU   EEXSAS05+4                                               01223000
XALTPTR  EQU   EEXSAS05+3                                               01224000
XACRT2   EQU   XARESV                                                   01225000
XACENDCK EQU   XARESV                                                   01226000
XARES1   EQU   XASWITCH                                                 01227000
XASMF44  EQU   XASWITCH                                                 01228000
XASMF42  EQU   XASWITCH                                                 01229000
XAHRDREQ EQU   XASWITCH                                                 01230000
XASTHDCP EQU   XACOMPMS                                                 01231000
XAINHDCP EQU   XALTCHG                                                  01232000
XAHRDCMD EQU   XASWITCH                                                 01233000
XAROUT   EQU   XASWITCH                                                 01234000
XALTCON  EQU   XASOPCOD                                                 01235000
XACMD    EQU   XASOPCOD                                                 01236000
XALTCOM  EQU   XASOPCOD                                                 01237000
XARESB   EQU   XASOPCOD                                                 01238000
XAOFF    EQU   XASOPCOD                                                 01239000
XAON     EQU   XASOPCOD                                                 01240000
XARESA   EQU   XASOPCOD                                                 01241000
XACON    EQU   XASOPCOD                                                 01242000
XAXSACB  EQU   EEXSAS04+4                                               01243000
XAXUTME  EQU   EEXSAS04+2                                               01244000
XAXFREE  EQU   EEXSAS04+1                                               01245000
@NM00014 EQU   XAXMASK                                                  01246000
XAXTSL   EQU   XAXMASK                                                  01247000
XAXTS    EQU   XAXMASK                                                  01248000
@NM00013 EQU   XAXMASK                                                  01249000
XAXJOBSL EQU   XAXMASK                                                  01250000
XAXJOBS  EQU   XAXMASK                                                  01251000
XASOPTR  EQU   @NM00012+1                                               01252000
XASTSAVE EQU   @NM00012                                                 01253000
XASPLS3  EQU   EEXSAS03+3                                               01254000
XASSDS8  EQU   XASDS                                                    01255000
XASSDS7  EQU   XASDS                                                    01256000
XASSDS6  EQU   XASDS                                                    01257000
XASSDS5  EQU   XASDS                                                    01258000
XASSDS4  EQU   XASDS                                                    01259000
XASSDS3  EQU   XASDS                                                    01260000
XASSDS2  EQU   XASDS                                                    01261000
XASSDS1  EQU   XASDS                                                    01262000
XASDID   EQU   EEXSAS03+1                                               01263000
XASCID   EQU   EEXSAS03                                                 01264000
XACAHOLD EQU   EEXSAS02+2                                               01265000
XADRES1  EQU   EEXSAS02+1                                               01266000
XAUBLANK EQU   XADUSWIT                                                 01267000
XAOUNIT  EQU   XADUSWIT                                                 01268000
XAIOCOMP EQU   XADUSWIT                                                 01269000
XARES3   EQU   XADUSWIT                                                 01270000
XAUDVC   EQU   XADUSWIT                                                 01271000
XARES2   EQU   XADUSWIT                                                 01272000
XAIPAREN EQU   XADUSWIT                                                 01273000
XAXPAREN EQU   XADUSWIT                                                 01274000
@NM00011 EQU   EEXSAS01+44                                              01275000
XAT      EQU   EEXSAS01+20                                              01276000
XAF      EQU   EEXSAS01+12                                              01277000
XAI      EQU   EEXSAS01+4                                               01278000
XAH      EQU   EEXSAS01                                                 01279000
XASAVSDR EQU   XASAVSTR+68                                              01280000
XASAVSDQ EQU   XASAVSTR+64                                              01281000
XASAVSDP EQU   XASAVSTR+60                                              01282000
XASAVSDO EQU   XASAVSTR+56                                              01283000
XASAVSDN EQU   XASAVSTR+52                                              01284000
XASAVSDM EQU   XASAVSTR+48                                              01285000
XASAVSDL EQU   XASAVSTR+44                                              01286000
XASAVSDK EQU   XASAVSTR+40                                              01287000
XASAVSDJ EQU   XASAVSTR+36                                              01288000
XASAVSDI EQU   XASAVSTR+32                                              01289000
XASAVSDH EQU   XASAVSTR+28                                              01290000
XASAVSDG EQU   XASAVSTR+24                                              01291000
XASAVSDF EQU   XASAVSTR+20                                              01292000
XASAVSDE EQU   XASAVSTR+16                                              01293000
XASAVSDD EQU   XASAVSTR+12                                              01294000
XASAVSDC EQU   XASAVSTR+8                                               01295000
XASAVSDB EQU   XASAVSTR+4                                               01296000
XASAVSDA EQU   XASAVSTR                                                 01297000
XASAVLC4 EQU   XASAVLOX+12                                              01298000
XASAVLC3 EQU   XASAVLOX+8                                               01299000
XASAVLC2 EQU   XASAVLOX+4                                               01300000
XASAVLC1 EQU   XASAVLOX                                                 01301000
XAK      EQU   XASVRB+44                                                01302000
@NM00010 EQU   XASVRB+41                                                01303000
XAV      EQU   XASVRB+24                                                01304000
XAN      EQU   @NM00009                                                 01305000
XAR      EQU   @NM00008+1                                               01306000
XAE      EQU   @NM00008                                                 01307000
XAP      EQU   XSA                                                      01308000
COMMAL   EQU   CMDCOPY+18                                               01309000
ONECOMMA EQU   CMDCOPY+13                                               01310000
FRONT    EQU   CMDCOPY                                                  01311000
SUFFIXA  EQU   BUF779+24                                                01312000
PREFIXA  EQU   BUF779                                                   01313000
SUFFIX   EQU   BUF313+19                                                01314000
PREFIX   EQU   BUF313                                                   01315000
@NM00006 EQU   WORKAREA+28                                              01316000
@NM00005 EQU   WORKAREA+27                                              01317000
@NM00004 EQU   CVDAREA+4                                                01318000
@NM00003 EQU   SWAREA                                                   01319000
OFFSET   EQU   MGCRCSCB                                                 01320000
*                                      END UNREFERENCED COMPONENTS      01321000
@RF00100 EQU   @RC00095                                                 01322000
@RC00223 EQU   @RC00220                                                 01323000
@RC00266 EQU   @EL00006                                                 01324000
@PB00008 EQU   @EL00001                                                 01325000
@PB00007 EQU   @PB00008                                                 01326000
@PB00006 EQU   @PB00007                                                 01327000
@PB00005 EQU   @PB00006                                                 01328000
@PB00004 EQU   @PB00005                                                 01329000
@PB00003 EQU   @PB00004                                                 01330000
@PB00002 EQU   @PB00003                                                 01331000
@ENDDATA EQU   *                                                        01332000
         END   IEECB904,(C'PLS1546',0701,76177)                         01333000
