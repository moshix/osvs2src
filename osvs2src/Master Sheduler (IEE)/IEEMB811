         TITLE 'IPS SCANNER - IEEMB811                               '  00001000
IEEMB811 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'IEEMB811  73.117'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  BALR  @12,0                                               0001 00009000
@PSTART  DS    0H                                                  0001 00010000
         USING @PSTART,@12                                         0001 00011000
         LR    @10,@01                                             0001 00012000
         L     @00,@SIZDATD                                        0001 00013000
         GETMAIN R,LV=(0)                                               00014000
         LR    @11,@01                                             0001 00015000
         USING @DATD,@11                                           0001 00016000
         LR    @01,@10                                             0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LR    @13,@11                                             0001 00019000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00020000
         MVC   @PC00001(4),0(@01)                                  0001 00021000
*                                                                  0033 00022000
         EJECT                                                          00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* WHEN THIS MODULE IS ATTACHED REGISTER 1 POINTS TO THE SET     */ 00026000
*   /* PROCESSOR'S CSCB. THE IPS KEYWORD IS LOCATED IN CHBUF IN THIS */ 00027000
*   /* CSCB. IEEBUFSC WILL BE USED TO SCAN FOR THIS KEYWORD AND ITS  */ 00028000
*   /* PARAMETER. THIS ROUTINE INITIALIZES FOR IEEBUFSC.             */ 00029000
*   /*                                                               */ 00030000
*   /*****************************************************************/ 00031000
*                                                                  0034 00032000
*   REG14SAV=REG14;                 /* SAVE RETURN ADDRESS           */ 00033000
         ST    REG14,REG14SAV                                      0034 00034000
*   CALL ISSUSTAE;                  /* CREATE STAE ENVIRONMENT       */ 00035000
         BAL   @14,ISSUSTAE                                        0035 00036000
*   IF REG15=0 THEN                 /* CHECK IF STAE CREATED         */ 00037000
         SR    @10,@10                                             0036 00038000
         CR    REG15,@10                                           0036 00039000
         BNE   @RF00036                                            0036 00040000
*     DO;                                                          0037 00041000
*       PARMLIST=0;                 /* CLEAR MSG PARAMETER LIST      */ 00042000
         ST    @10,@TF00001                                        0038 00043000
         MVC   PARMLIST(4),@TF00001                                0038 00044000
*       REG0=ADDR(CHTYPE);          /* POINTER TO THE END OF THE   0039 00045000
*                                      BUFFER + 1                    */ 00046000
         LA    REG0,CHTYPE(,CSCBPTR)                               0039 00047000
*       REG15=ADDR(KEYWORD);        /* POINTER TO THE KEYWORD DESIRED*/ 00048000
         LA    REG15,KEYWORD                                       0040 00049000
*       REG15=REG15|KEYWDLEN;       /* GET KEYWORD LENGTH            */ 00050000
         O     REG15,KEYWDLEN                                      0041 00051000
*       REG1=ADDR(CHBUF);           /* POINTER TO THE BEGINNING OF 0042 00052000
*                                      THE BUFFER                    */ 00053000
         LA    REG1,CHBUF(,CSCBPTR)                                0042 00054000
*       REG2=REG1;                  /* SAVE CHBUF ADDR TO BUILD XSA     00055000
*                                      IN FOR MSG MOD IEE0503D       */ 00056000
         LR    REG2,REG1                                           0043 00057000
*       CALL SCANNAME;              /* GET IEEBUFSC TO SCAN NAME     */ 00058000
*                                                                  0044 00059000
         BAL   @14,SCANNAME                                        0044 00060000
*       /*************************************************************/ 00061000
*       /*                                                           */ 00062000
*       /* IF IEEBUFSC FINDS THE KEYWORD THE LENGTH OF THE VALUE IS  */ 00063000
*       /* CHECKED. IF TOO LARGE WE PUT OUT AN ERROR MSG. OTHERWISE  */ 00064000
*       /* REGISTER 1 IS POINTED TO THE IPS VALUE AND IEEMB812 (THE  */ 00065000
*       /* SYSTEM RESOURCE MANAGER MODULE) IS CALLED.                */ 00066000
*       /*                                                           */ 00067000
*       /*************************************************************/ 00068000
*                                                                  0045 00069000
*       IF REG15=0 THEN             /* IF IEEBUFSC FOUND             */ 00070000
         LTR   REG15,REG15                                         0045 00071000
         BNZ   @RF00045                                            0045 00072000
*         DO;                       /* THE KEYWORD THEN CHECK THE  0046 00073000
*                                      LENGTH OF THE PARAMETER       */ 00074000
*           IF REG1=2 THEN          /* LENGTH MUST EQUAL 2           */ 00075000
         CH    REG1,@CH00144                                       0047 00076000
         BNE   @RF00047                                            0047 00077000
*             DO;                   /* IF LENGTH OK THEN SETUP TO  0048 00078000
*                                      PASS TO THE MAMAGER           */ 00079000
*               IPSVALUE=REG5->NEWVALUE;/* SAVE IPS VALUE FOR LATER     00080000
*                                      MESSAGE INSERTION             */ 00081000
         MVC   IPSVALUE(2),NEWVALUE(REG5)                          0049 00082000
*               REG1=REG5;          /* REG1 POINTS TO IPS VALUE      */ 00083000
         LR    REG1,REG5                                           0050 00084000
*               CALL IEEMB812;      /* GO TO SYSTEM RES MANAGER    0051 00085000
*                                      INTERFACE MODULE              */ 00086000
         L     @15,@CV00206                                        0051 00087000
         BALR  @14,@15                                             0051 00088000
*                                                                  0052 00089000
*               /*****************************************************/ 00090000
*               /*                                                   */ 00091000
*               /* IF IEEMB812 ACCEPTS THE VALUE (RC = 0) THEN A     */ 00092000
*               /* SUCCESSFUL MESSAGE IS ISSUED. ERROR MESSAGES ARE  */ 00093000
*               /* ISSUED FOR ALL OTHER RETURN CODES.                */ 00094000
*               /*                                                   */ 00095000
*               /*****************************************************/ 00096000
*                                                                  0052 00097000
*               IF REG15^=0 THEN    /* IF VALUE NO GOOD              */ 00098000
         LTR   REG15,REG15                                         0052 00099000
         BZ    @RF00052                                            0052 00100000
*                 CALL CKRETURN;    /* THEN FIND OUT WHY             */ 00101000
         BAL   @14,CKRETURN                                        0053 00102000
*               ELSE                                               0054 00103000
*                 IWANTMSG='00'X;   /* OTHERWISE VALUE IS ACCEPTABLE,   00104000
*                                      PUT OUT SUCCESSFUL MSG        */ 00105000
         B     @RC00052                                            0054 00106000
@RF00052 MVI   IWANTMSG,X'00'                                      0054 00107000
*             END;                                                 0055 00108000
@RC00052 DS    0H                                                  0056 00109000
*           ELSE                                                   0056 00110000
*             IWANTMSG='08'X;       /* LENGTH IS TOO                 */ 00111000
         B     @RC00047                                            0056 00112000
@RF00047 MVI   IWANTMSG,X'08'                                      0056 00113000
*                                   /* LARGE                         */ 00114000
*         END;                                                     0057 00115000
*                                                                  0057 00116000
@RC00047 DS    0H                                                  0058 00117000
*       /*************************************************************/ 00118000
*       /*                                                           */ 00119000
*       /* RETURN CODES FROM IEEBUFSC OTHER THAN ZERO ARE NOW        */ 00120000
*       /* CHECKED. IF RC = 4 THEN THE KEYWORD PARAMETER WAS MISSING.*/ 00121000
*       /* FOR RC = 8 THEN THE KEYWORD WAS MISSING.                  */ 00122000
*       /*                                                           */ 00123000
*       /*************************************************************/ 00124000
*                                                                  0058 00125000
*       ELSE                        /* FOR RC OTHER THAN ZERO FROM 0058 00126000
*                                      IEEBUFSC                      */ 00127000
*         DO;                                                      0058 00128000
         B     @RC00045                                            0058 00129000
@RF00045 DS    0H                                                  0059 00130000
*           IF REG15=4 THEN         /* COULD NOT FIND THE            */ 00131000
         CH    REG15,@CH00041                                      0059 00132000
         BNE   @RF00059                                            0059 00133000
*             IWANTMSG='08'X;       /* PARAMETER, PUT OUT ERROR MSG  */ 00134000
         MVI   IWANTMSG,X'08'                                      0060 00135000
*           ELSE                                                   0061 00136000
*             IF REG15=8 THEN       /* WAS THERE A KEYWD             */ 00137000
         B     @RC00059                                            0061 00138000
@RF00059 CH    REG15,@CH00045                                      0061 00139000
         BNE   @RF00061                                            0061 00140000
*               IWANTMSG='09'X;     /* NO KEYWD PUT OUT ERROR MSG    */ 00141000
         MVI   IWANTMSG,X'09'                                      0062 00142000
*             ELSE                                                 0063 00143000
*               IWANTMSG='FF'X;     /* CANT IDENTIFY RC              */ 00144000
         B     @RC00061                                            0063 00145000
@RF00061 MVI   IWANTMSG,X'FF'                                      0063 00146000
*         END;                                                     0064 00147000
@RC00061 DS    0H                                                  0064 00148000
@RC00059 DS    0H                                                  0065 00149000
*       IF IWANTMSG^='FF'X THEN     /* IS IT A VALID MSG             */ 00150000
@RC00045 CLI   IWANTMSG,255                                        0065 00151000
         BE    @RF00065                                            0065 00152000
*         DO;                                                      0066 00153000
*           REG1=ADDR(PARMLIST);    /* PUT PARM ADDR IN 1            */ 00154000
         LA    REG1,PARMLIST                                       0067 00155000
*           CALL IEEMB814;          /* GOTO MSG MODULE               */ 00156000
         L     @15,@CV00207                                        0068 00157000
         BALR  @14,@15                                             0068 00158000
*         END;                                                     0069 00159000
*     END;                                                         0070 00160000
@RF00065 DS    0H                                                  0071 00161000
*   CALL FREECSCB;                  /* FREE CSCB                     */ 00162000
@RF00036 BAL   @14,FREECSCB                                        0071 00163000
*   REG14=REG14SAV;                 /* RESTORE RETURN ADDRESS        */ 00164000
         L     REG14,REG14SAV                                      0072 00165000
*   RETURN;                         /* RETURN TO CALLER              */ 00166000
@EL00001 L     @13,4(,@13)                                         0073 00167000
@EF00001 L     @00,@SIZDATD                                        0073 00168000
         LR    @01,@11                                             0073 00169000
         FREEMAIN R,LV=(0),A=(1)                                        00170000
@ER00001 BR    @14                                                 0073 00171000
*ISSUSTAE:                                                         0074 00172000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0074 00173000
*                                                                  0074 00174000
ISSUSTAE DS    0H                                                  0075 00175000
*   /*****************************************************************/ 00176000
*   /*                                                               */ 00177000
*   /* THIS ROUTINE CREATES A STAE ENVIRONMENT THRU MODULE IEECB860. */ 00178000
*   /* A PARAMETER LIST IS BUILT AND PASSED TO MODULE IEECB860 VIA   */ 00179000
*   /* REGISTER 1.                                                   */ 00180000
*   /*                                                               */ 00181000
*   /*****************************************************************/ 00182000
*                                                                  0075 00183000
*   REG6=REG1;                      /* SAVE SETS CSCB PTR            */ 00184000
         LR    REG6,REG1                                           0075 00185000
*   REG4=REG14;                     /* SAVE RETURN ADDR              */ 00186000
         LR    REG4,REG14                                          0076 00187000
*   REG1=ADDR(WORKAREA);            /* GET CORE FOR PARM LIST        */ 00188000
         LA    REG1,WORKAREA                                       0077 00189000
*   REG2=REG1;                      /* SAVE CORE ADDR                */ 00190000
         LR    REG2,REG1                                           0078 00191000
*   CSCBADDR=REG6;                  /* STORE CSCB PTR IN LIST        */ 00192000
         ST    REG6,CSCBADDR(,REG1)                                0079 00193000
*   REG5=ADDR(STAEBUF);             /* GET PTR TO CMD BUF            */ 00194000
         LA    REG5,STAEBUF(,REG1)                                 0080 00195000
*   BUFPTR=REG5;                    /* STORE CMD BUF PTR IN PARAMETER   00196000
*                                      LIST                          */ 00197000
         ST    REG5,BUFPTR(,REG1)                                  0081 00198000
*   CMDSIZE=3;                      /* STORE LENGTH OF CMD           */ 00199000
         MVI   CMDSIZE(REG1),X'03'                                 0082 00200000
*   COMMAND=SET;                    /* STORE VERB                    */ 00201000
         MVI   COMMAND+3(REG1),C' '                                0083 00202000
         MVC   COMMAND+4(7,REG1),COMMAND+3(REG1)                   0083 00203000
         MVC   COMMAND(3,REG1),SET                                 0083 00204000
*   RESPECIFY                                                      0084 00205000
*    (REG11,                                                       0084 00206000
*     REG12,                                                       0084 00207000
*     REG13)RESTRICTED;                                            0084 00208000
*   REG4SAV=REG4;                   /* SAVE RETURN ADDRESS           */ 00209000
         ST    REG4,REG4SAV(,REG1)                                 0085 00210000
*   REG6SAV=REG6;                   /* SAVE CSCB ADDRESS             */ 00211000
         ST    REG6,REG6SAV(,REG1)                                 0086 00212000
*   REG11SAV=REG11;                 /* SAVE DATA REG PTR             */ 00213000
         ST    REG11,REG11SAV(,REG1)                               0087 00214000
*   REG12SAV=REG12;                 /* SAVE BASE REG PTR             */ 00215000
         ST    REG12,REG12SAV(,REG1)                               0088 00216000
*   REG13SAV=REG13;                 /* SAVE SAVE AREA PTR            */ 00217000
         ST    REG13,REG13SAV(,REG1)                               0089 00218000
*   GEN(LOAD EP=IEECB860);          /* LOAD STAE CREATING MOD        */ 00219000
         LOAD EP=IEECB860                                               00220000
*   REG15=REG0;                     /* PUT ENTRY ADDR IN R15         */ 00221000
         LR    REG15,REG0                                          0091 00222000
*   REG1=REG2;                      /* RESTORE PARM PTR              */ 00223000
         LR    REG1,REG2                                           0092 00224000
*   GEN(BALR REG14,REG15);          /* BR TO STAE MODULE             */ 00225000
         BALR REG14,REG15                                               00226000
*   REG4=REG4SAV;                   /* RESTORE RETURN ADDRESS        */ 00227000
         L     REG4,REG4SAV(,REG1)                                 0094 00228000
*   REG6=REG6SAV;                   /* RESTORE CSCB ADDRESS          */ 00229000
         L     REG6,REG6SAV(,REG1)                                 0095 00230000
*   REG11=REG11SAV;                 /* RESTORE DATA REG PTR          */ 00231000
         L     REG11,REG11SAV(,REG1)                               0096 00232000
*   REG12=REG12SAV;                 /* RESTORE BASE REG PTR          */ 00233000
         L     REG12,REG12SAV(,REG1)                               0097 00234000
*   REG13=REG13SAV;                 /* RESTORE SAVE AREA PTR         */ 00235000
         L     REG13,REG13SAV(,REG1)                               0098 00236000
*   RESPECIFY                                                      0099 00237000
*    (REG11,                                                       0099 00238000
*     REG12,                                                       0099 00239000
*     REG13)UNRESTRICTED;                                          0099 00240000
*   REG5=REG15;                     /* SAVE RETURN CODE              */ 00241000
         LR    REG5,REG15                                          0100 00242000
*   GEN(DELETE EP=IEECB860);        /* DELETE STAE CREATE MOD        */ 00243000
         DELETE EP=IEECB860                                             00244000
*   REG15=REG5;                     /* PUT RC INTO REG15             */ 00245000
         LR    REG15,REG5                                          0102 00246000
*   REG14=REG4;                     /* RESTORE THE RETURN ADDR       */ 00247000
         LR    REG14,REG4                                          0103 00248000
*   END;                                                           0104 00249000
@EL00002 DS    0H                                                  0104 00250000
@EF00002 DS    0H                                                  0104 00251000
@ER00002 BR    @14                                                 0104 00252000
*FREECSCB:                                                         0105 00253000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0105 00254000
*                                                                  0105 00255000
FREECSCB DS    0H                                                  0106 00256000
*   /*****************************************************************/ 00257000
*   /*                                                               */ 00258000
*   /* THIS ROUTINE FREES THE SET CSCB BY ISSUING MGCR MACRO.        */ 00259000
*   /*                                                               */ 00260000
*   /*****************************************************************/ 00261000
*                                                                  0106 00262000
*   CHFC='1'B;                      /* TURN ON FREE CSCB BIT         */ 00263000
         OI    CHFC(CSCBPTR),B'00000010'                           0106 00264000
*   REG1=REG6;                      /* GET SETS CSCB PTR             */ 00265000
         LR    REG1,REG6                                           0107 00266000
*   GEN(MGCR (1),CHAIN);            /* ISSUE MACRO TO FREE           */ 00267000
         MGCR (1),CHAIN                                                 00268000
*   END;                                                           0109 00269000
@EL00003 DS    0H                                                  0109 00270000
@EF00003 DS    0H                                                  0109 00271000
@ER00003 BR    @14                                                 0109 00272000
*SCANNAME:                                                         0110 00273000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0110 00274000
*                                                                  0110 00275000
SCANNAME DS    0H                                                  0111 00276000
*/*                                                                0111 00277000
********************************************************************    00278000
**                                                                 0111 00279000
**     ROUTINE NAME        IEEBUFSC                                0111 00280000
**                                                                 0111 00281000
**     FUNCTION            TO SCAN A BUFFER FOR A GIVEN KEYWORD OF 0111 00282000
**                         A GIVEN LENGTH AND TO RETURN A POINTER  0111 00283000
**                         TO THE KEYWORD VALUE AND THE LENGTH OF  0111 00284000
**                         THE VALUE                               0111 00285000
**                                                                 0111 00286000
**     ENTRY POINT         IEEBUFSC                                0111 00287000
**                                                                 0111 00288000
**     ATTRIBUTES          REFRESHABLE                             0111 00289000
**                                                                 0111 00290000
**     OPERATION           1. SET UP PTR TO BUFFER -1 AND PTR      0111 00291000
**                            TO KEYWORD LENGTH                    0111 00292000
**                         2. IF BUFFER PTR = SPECIFIED KEYWORD    0111 00293000
**                            GO TO FOUND ROUTINE (3).             0111 00294000
**                            A. IF NOT, INCREMENT BUFFER PTR      0111 00295000
**                               BY ONE.                           0111 00296000
**                            B. IF PTR IS AT END OF BUFFER SET    0111 00297000
**                               UP NOT FOUND RETURN CODE (8) IN   0111 00298000
**                               R15 AND EXIT.                     0111 00299000
**                            C. IF PTR IS AT A COMMA, GO BACK TO  0111 00300000
**                               OPERATION 2.                      0111 00301000
**                            D. IF PTR IS AT A BLANK SET UP NOT   0111 00302000
**                               FOUND RETURN CODE (8) IN R15 AND  0111 00303000
**                               EXIT.                             0111 00304000
**                            E. OTHERWISE GO TO OPERATION 2.A.    0111 00305000
**                         3. AT FOUND ROUTINE SET UP R14 TO POINT 0111 00306000
**                            TO KEYWORD VALUE                     0111 00307000
**                         4. SCAN KEYWORD VALUE TO THE END OF     0111 00308000
**                            THE BUFFER, A COMMA OR A BLANK       0111 00309000
**                         5. CALCULATE LENGTH OF KEYWORD VALUE.   0111 00310000
**                         6. IF LENGTH IS < OR = ZERO, SET UP     0111 00311000
**                            AN INVALID KEYWORD VALUE LENGTH      0111 00312000
**                            RETURN CODE (4) IN R15 AND EXIT.     0111 00313000
**                         7. OTHERWISE, SET GOOD RETURN CODE      0111 00314000
**                            OF ZERO IN R15 AND EXIT.             0111 00315000
**                                                                 0111 00316000
**     EXTERNAL REFS       NONE                                    0111 00317000
**                                                                 0111 00318000
**     SVCS                NONE                                    0111 00319000
**                                                                 0111 00320000
**     INPUT               R1 - PTR TO BEGINNING OF BUFFER         0111 00321000
**                         R0 - PTR TO LAST BYTE OF BUFFER + 1     0111 00322000
**                         R15- PTR TO KEYWORD WITH THE LENGTH     0111 00323000
**                              OF THE KEYWORD IN THE HIGH ORDER   0111 00324000
**                              BYTE.                              0111 00325000
**                              EG. KEYWORD FORMAT 'DSNAME='       0111 00326000
**                                  R15 WOULD POINT TO THE 'D'     0111 00327000
**                                  WITH A 6 IN THE HIGH ORDER     0111 00328000
**                                  BYTE.                          0111 00329000
**                                                                 0111 00330000
**     OUTPUT              R14  PTR TO FIRST BYTE OF KEYWORD       0111 00331000
**                              VALUE IN BUFFER OR WORKAREA        0111 00332000
**                         R1   LENGTH OF KEYWORD VALUE            0111 00333000
**                         R15  RETURN CODE OF ZERO.               0111 00334000
**                                                                 0111 00335000
**     ERROR OUTPUT        R15  CONTAINS A FOUR IF KEYWORD         0111 00336000
**                              HAD AN INVALID LENGTH              0111 00337000
**                         R15  CONTAINS AN EIGHT IF THE KEYWORD   0111 00338000
**                              WAS NOT FOUND IN THE BUFFER        0111 00339000
**                                                                 0111 00340000
**     EXIT                TO NEXT SEQUENTIAL INSTRUCTION AFTER    0111 00341000
**                         MACRO CALL                              0111 00342000
**                                                                 0111 00343000
**     NOTES               LISTS OF OPERANDS IN PARENTHESES ARE    0111 00344000
**                         NOT PROCESSED, THIS MACRO IS INTENDED   0111 00345000
**                         TO PROCESS ONLY A SINGLE VALUE  FOR     0111 00346000
**                         A GIVEN KEYWORD                         0111 00347000
********************************************************************    00348000
*                                                                    */ 00349000
*                                                                  0111 00350000
*   REG4=REG14;                     /* SAVE RETURN ADDR              */ 00351000
         LR    REG4,REG14                                          0111 00352000
*   GEN(IEEBUFSC);                                                 0112 00353000
         IEEBUFSC                                                       00354000
*   REG5=REG14;                     /* SAVE IPS VALUE PTR            */ 00355000
         LR    REG5,REG14                                          0113 00356000
*   REG14=REG4;                     /* GET RETURN ADDR               */ 00357000
         LR    REG14,REG4                                          0114 00358000
*   END;                                                           0115 00359000
@EL00004 DS    0H                                                  0115 00360000
@EF00004 DS    0H                                                  0115 00361000
@ER00004 BR    @14                                                 0115 00362000
*CKRETURN:                                                         0116 00363000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0116 00364000
*                                                                  0116 00365000
CKRETURN DS    0H                                                  0117 00366000
*   /*****************************************************************/ 00367000
*   /*                                                               */ 00368000
*   /* THIS ROUTINE CHECKS THE RETURN CODE FROM IEEMB812 (SYSTEM RES */ 00369000
*   /* MANAGER INTERFACE MODULE). RC = 4 - INVALID SPECIFICATION RC =*/ 00370000
*   /* 8 - MEMBER MISSING RC = 12- I/O ERROR RC = 16- OPEN FAILED    */ 00371000
*   /*                                                               */ 00372000
*   /*****************************************************************/ 00373000
*                                                                  0117 00374000
*   IF REG15=4 THEN                 /* INVALID SPECIFICATION         */ 00375000
         CH    REG15,@CH00041                                      0117 00376000
         BNE   @RF00117                                            0117 00377000
*     IWANTMSG='08'X;               /* GET BAD SPEC MSG              */ 00378000
         MVI   IWANTMSG,X'08'                                      0118 00379000
*   ELSE                            /* OTHERWISE CHECK FURTHER       */ 00380000
*     IF REG15=8 THEN               /* IF MEMBER MISSING             */ 00381000
         B     @RC00117                                            0119 00382000
@RF00117 CH    REG15,@CH00045                                      0119 00383000
         BNE   @RF00119                                            0119 00384000
*       IWANTMSG='10'X;             /* GET NO FINDUM MSG             */ 00385000
         MVI   IWANTMSG,X'10'                                      0120 00386000
*     ELSE                          /* CHECK FURTHER                 */ 00387000
*       IF REG15=12 THEN            /* IF AN I/O ERROR               */ 00388000
         B     @RC00119                                            0121 00389000
@RF00119 CH    REG15,@CH00033                                      0121 00390000
         BNE   @RF00121                                            0121 00391000
*         IWANTMSG='18'X;           /* GET I/O ERROR MSG             */ 00392000
         MVI   IWANTMSG,X'18'                                      0122 00393000
*       ELSE                                                       0123 00394000
*         IF REG15=16 THEN                                         0123 00395000
         B     @RC00121                                            0123 00396000
@RF00121 CH    REG15,@CH00149                                      0123 00397000
         BNE   @RF00123                                            0123 00398000
*           IWANTMSG='20'X;         /* GET OPEN FAILED MSG           */ 00399000
         MVI   IWANTMSG,X'20'                                      0124 00400000
*         ELSE                                                     0125 00401000
*           IWANTMSG='FF'X;         /* CANT IDENTIFY RC              */ 00402000
         B     @RC00123                                            0125 00403000
@RF00123 MVI   IWANTMSG,X'FF'                                      0125 00404000
*   END;                                                           0126 00405000
@EL00005 DS    0H                                                  0126 00406000
@EF00005 DS    0H                                                  0126 00407000
@ER00005 BR    @14                                                 0126 00408000
*   END                                                            0127 00409000
*                                                                  0127 00410000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00411000
*/*%INCLUDE SYSLIB  (IEECHAIN)                                       */ 00412000
*                                                                  0127 00413000
*       ;                                                          0127 00414000
         B     @EL00001                                            0127 00415000
@DATA    DS    0H                                                       00416000
@CH00144 DC    H'2'                                                     00417000
@CH00041 DC    H'4'                                                     00418000
@CH00045 DC    H'8'                                                     00419000
@CH00033 DC    H'12'                                                    00420000
@CH00149 DC    H'16'                                                    00421000
@DATD    DSECT                                                          00422000
         DS    0F                                                       00423000
@SA00001 DS    18F                                                      00424000
@PC00001 DS    1F                                                       00425000
@TF00001 DS    F                                                        00426000
@ZTEMPS  DS    C                                                        00427000
@ZTEMPND EQU   *                                                        00428000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00429000
IEEMB811 CSECT                                                          00430000
         DS    0F                                                       00431000
@DATD    DSECT                                                          00432000
         DS    0D                                                       00433000
REG14SAV DS    A                                                        00434000
PARMLIST DS    CL4                                                      00435000
         ORG   PARMLIST                                                 00436000
@NM00005 DS    AL1                                                      00437000
IWANTMSG DS    AL1                                                      00438000
IPSVALUE DS    AL2                                                      00439000
         ORG   PARMLIST+4                                               00440000
WORKAREA DS    CL50                                                     00441000
@ENDDATD EQU   *                                                        00442000
IEEMB811 CSECT                                                          00443000
         DS    0F                                                       00444000
@SIZDATD DC    AL1(0)                                                   00445000
         DC    AL3(@ENDDATD-@DATD)                                      00446000
@CV00206 DC    V(IEEMB812)                                              00447000
@CV00207 DC    V(IEEMB814)                                              00448000
         DS    0D                                                       00449000
KEYWDLEN DC    XL4'03000000'                                            00450000
KEYWORD  DC    CL4'IPS='                                                00451000
SET      DC    CL3'SET'                                                 00452000
PATCH    DS    CL20                                                     00453000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00454000
@01      EQU   01                                                       00455000
@02      EQU   02                                                       00456000
@03      EQU   03                                                       00457000
@04      EQU   04                                                       00458000
@05      EQU   05                                                       00459000
@06      EQU   06                                                       00460000
@07      EQU   07                                                       00461000
@08      EQU   08                                                       00462000
@09      EQU   09                                                       00463000
@10      EQU   10                                                       00464000
@11      EQU   11                                                       00465000
@12      EQU   12                                                       00466000
@13      EQU   13                                                       00467000
@14      EQU   14                                                       00468000
@15      EQU   15                                                       00469000
CSCBPTR  EQU   @06                                                      00470000
REG0     EQU   @00                                                      00471000
REG1     EQU   @01                                                      00472000
REG2     EQU   @02                                                      00473000
REG3     EQU   @03                                                      00474000
REG4     EQU   @04                                                      00475000
REG5     EQU   @05                                                      00476000
REG6     EQU   @06                                                      00477000
REG7     EQU   @07                                                      00478000
REG11    EQU   @11                                                      00479000
REG12    EQU   @12                                                      00480000
REG13    EQU   @13                                                      00481000
REG14    EQU   @14                                                      00482000
REG15    EQU   @15                                                      00483000
CHAIN    EQU   0                                                        00484000
CHFLG    EQU   CHAIN+4                                                  00485000
CHSTS    EQU   CHFLG+2                                                  00486000
CHFC     EQU   CHSTS                                                    00487000
CHACT    EQU   CHFLG+3                                                  00488000
CHKEY    EQU   CHAIN+8                                                  00489000
CHPKE    EQU   CHAIN+28                                                 00490000
CHTJID   EQU   CHAIN+30                                                 00491000
CHACT1   EQU   CHAIN+35                                                 00492000
CHASM    EQU   CHAIN+40                                                 00493000
CHCIBP   EQU   CHASM+4                                                  00494000
CHRGNSZ  EQU   CHASM+8                                                  00495000
CHSHORT  EQU   CHASM+24                                                 00496000
CHSWT    EQU   CHSHORT                                                  00497000
STAELIST EQU   0                                                        00498000
CSCBADDR EQU   STAELIST                                                 00499000
BUFPTR   EQU   STAELIST+4                                               00500000
STAEBUF  EQU   STAELIST+8                                               00501000
CMDSIZE  EQU   STAEBUF                                                  00502000
COMMAND  EQU   STAEBUF+1                                                00503000
REGSAVE  EQU   STAELIST+20                                              00504000
REG4SAV  EQU   REGSAVE                                                  00505000
REG6SAV  EQU   REGSAVE+4                                                00506000
REG11SAV EQU   REGSAVE+8                                                00507000
REG12SAV EQU   REGSAVE+12                                               00508000
REG13SAV EQU   REGSAVE+16                                               00509000
NEWVALUE EQU   0                                                        00510000
DMY      EQU   0                                                        00511000
CHAINS01 EQU   CHASM                                                    00512000
CHBUF    EQU   CHAINS01                                                 00513000
CHTYPE   EQU   CHAINS01+124                                             00514000
CHTRSTAT EQU   CHAINS01+125                                             00515000
CHCSYSO  EQU   CHAINS01+134                                             00516000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00517000
CHLAST   EQU   CHAINS01+136                                             00518000
CHSPA    EQU   CHAINS01+135                                             00519000
CHUSERID EQU   CHCSYSO                                                  00520000
CHJB     EQU   CHCSYSO                                                  00521000
CHDUMP   EQU   CHCSYSO                                                  00522000
CHQUE    EQU   CHCSYSO                                                  00523000
CHHOLD   EQU   CHCSYSO                                                  00524000
CHOUT    EQU   CHCSYSO                                                  00525000
CHINN    EQU   CHCSYSO                                                  00526000
CHALL    EQU   CHCSYSO                                                  00527000
CHINC    EQU   CHAINS01+132                                             00528000
CHPEND   EQU   CHAINS01+128                                             00529000
CHARID   EQU   CHAINS01+127                                             00530000
CHCNID   EQU   CHAINS01+126                                             00531000
@NM00004 EQU   CHTRSTAT                                                 00532000
CHTSL    EQU   CHTRSTAT                                                 00533000
CHTS     EQU   CHTRSTAT                                                 00534000
CHINITL  EQU   CHTRSTAT                                                 00535000
CHINIT   EQU   CHTRSTAT                                                 00536000
CHJOBSL  EQU   CHTRSTAT                                                 00537000
CHJOBS   EQU   CHTRSTAT                                                 00538000
CHDEF    EQU   CHTYPE                                                   00539000
CHHIAR   EQU   CHTYPE                                                   00540000
CHARSV29 EQU   CHTYPE                                                   00541000
CHARSV28 EQU   CHTYPE                                                   00542000
CHARSV27 EQU   CHTYPE                                                   00543000
CHARSV26 EQU   CHTYPE                                                   00544000
CHARSV25 EQU   CHTYPE                                                   00545000
CHDSTAT  EQU   CHTYPE                                                   00546000
CHARSV16 EQU   CHSHORT+108                                              00547000
CHARSV15 EQU   CHSHORT+104                                              00548000
CHJSCBVS EQU   CHSHORT+100                                              00549000
CHUSCVS  EQU   CHSHORT+96                                               00550000
@NM00003 EQU   CHSHORT+92                                               00551000
@NM00002 EQU   CHSHORT+88                                               00552000
CHSQA    EQU   CHSHORT+52                                               00553000
CHQPA    EQU   CHSHORT+16                                               00554000
CHJCL    EQU   CHSHORT+12                                               00555000
CHSPC    EQU   CHSHORT+8                                                00556000
CHSPB    EQU   CHSHORT+4                                                00557000
CHTCB    EQU   CHSHORT+1                                                00558000
CHARSV23 EQU   CHSWT                                                    00559000
CHARSV22 EQU   CHSWT                                                    00560000
CHARSV21 EQU   CHSWT                                                    00561000
CHAC     EQU   CHSWT                                                    00562000
CHPSF    EQU   CHSWT                                                    00563000
CHPSD    EQU   CHSWT                                                    00564000
CHJCT    EQU   CHSWT                                                    00565000
CHARSV20 EQU   CHSWT                                                    00566000
CHCECB   EQU   CHASM+20                                                 00567000
CHECB    EQU   CHASM+16                                                 00568000
CHRGNAD  EQU   CHASM+12                                                 00569000
CHARSV18 EQU   CHRGNSZ+1                                                00570000
CHRPRTY  EQU   CHRGNSZ                                                  00571000
@NM00001 EQU   CHCIBP                                                   00572000
CHEND    EQU   CHCIBP                                                   00573000
CHECBP   EQU   CHASM                                                    00574000
CHDER    EQU   CHAIN+36                                                 00575000
CHARSV10 EQU   CHACT1                                                   00576000
CHARSV09 EQU   CHACT1                                                   00577000
CHARSV08 EQU   CHACT1                                                   00578000
CHARSV07 EQU   CHACT1                                                   00579000
CHARSV06 EQU   CHACT1                                                   00580000
CHARSV05 EQU   CHACT1                                                   00581000
CHARSV04 EQU   CHACT1                                                   00582000
CHRDWTR  EQU   CHACT1                                                   00583000
CHARSV30 EQU   CHAIN+34                                                 00584000
CHQID    EQU   CHAIN+32                                                 00585000
CHASID   EQU   CHTJID                                                   00586000
CHUCMP   EQU   CHAIN+29                                                 00587000
CHTRKID  EQU   CHPKE                                                    00588000
CHCIBCTR EQU   CHAIN+27                                                 00589000
CHUNIT   EQU   CHAIN+24                                                 00590000
CHCLS    EQU   CHAIN+16                                                 00591000
CHPARM   EQU   CHKEY                                                    00592000
CHIFY    EQU   CHACT                                                    00593000
CHAIFX   EQU   CHACT                                                    00594000
CHCLD    EQU   CHACT                                                    00595000
CHCL     EQU   CHACT                                                    00596000
CHDSI    EQU   CHACT                                                    00597000
CHDISC   EQU   CHACT                                                    00598000
CHTERM   EQU   CHACT                                                    00599000
CHSWAP   EQU   CHACT                                                    00600000
CHABTERM EQU   CHSTS                                                    00601000
CHDL     EQU   CHSTS                                                    00602000
CHAD     EQU   CHSTS                                                    00603000
CHQSPC   EQU   CHSTS                                                    00604000
CHSOUT   EQU   CHSTS                                                    00605000
CHSYS    EQU   CHSTS                                                    00606000
CHAP     EQU   CHSTS                                                    00607000
CHSZE    EQU   CHFLG+1                                                  00608000
CHVCD    EQU   CHFLG                                                    00609000
CHPTR    EQU   CHAIN                                                    00610000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00611000
@RC00123 EQU   @EL00005                                                 00612000
@RC00121 EQU   @EL00005                                                 00613000
@RC00119 EQU   @EL00005                                                 00614000
@RC00117 EQU   @EL00005                                                 00615000
@ENDDATA EQU   *                                                        00616000
         END   IEEMB811                                                 00617000
