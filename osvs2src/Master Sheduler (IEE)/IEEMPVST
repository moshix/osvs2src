         TITLE 'IEEMPVST - VARY STORAGE COMMAND PROCESSOR              *00001000
                        '                                               00002000
IEEMPVST CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(19)                                             0001 00007000
         DC    C'IEEMPVSTR0300076182'                              0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @11,0                                               0001 00010000
@PSTART  LA    @12,4095(,@11)                                      0001 00011000
         USING @PSTART,@11                                         0001 00012000
         USING @PSTART+4095,@12                                    0001 00013000
         LR    @09,@01                                             0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @10,@01                                             0001 00017000
         USING @DATD,@10                                           0001 00018000
         LR    @01,@09                                             0001 00019000
         ST    @13,@SA00001+4                                      0001 00020000
         LR    @13,@10                                             0001 00021000
         MVC   @PC00001(4),0(@01)                                  0001 00022000
*                                                                  0086 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* MAINLINE CODE -VARY STORAGE. INITIALIZE WORKAREA              */ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                                  0086 00029000
*   RETPTR=R14;                     /* SAVE RETURN ADDRESS           */ 00030000
         LR    RETPTR,R14                                          0086 00031000
*   CSCBPTR=R1;                     /* SAVE @ CSCB                   */ 00032000
         ST    R1,CSCBPTR                                          0087 00033000
*   FUNCBITS=''B;                   /* CLEAR FUNCTION FLAGS          */ 00034000
         XC    FUNCBITS(2),FUNCBITS                                0088 00035000
*   RSRWAP=0;                       /* NULL RSR WA                   */ 00036000
         SLR   @14,@14                                             0089 00037000
         ST    @14,RSRWAP                                          0089 00038000
*   VALFRA=0;                       /* ZERO RETRY ADDR               */ 00039000
         ST    @14,VALFRA                                          0090 00040000
*   INTERROR=-1;                    /* SET INTERNAL ERROR CODE       */ 00041000
         MVC   INTERROR(4),@CF02438                                0091 00042000
*   AVALRTN=ADDR(IEEVALST);         /* SET @ TO VALIDATE'S PAGE      */ 00043000
*                                                                  0092 00044000
         L     @14,@CV00128                                        0092 00045000
         ST    @14,AVALRTN                                         0092 00046000
*   /*****************************************************************/ 00047000
*   /*                                                               */ 00048000
*   /* SET ADDRESS CONSTANTS FOR DEBUGGING                           */ 00049000
*   /*                                                               */ 00050000
*   /*****************************************************************/ 00051000
*                                                                  0093 00052000
*   ENTRYPT=ADDR(IEEMPVST);         /* ENTRY POINT LOAD MODULE       */ 00053000
         L     @14,@CA00028                                        0093 00054000
         ST    @14,ENTRYPT                                         0093 00055000
*   STRTMWA=R10;                    /* START MAIN WORKAREA           */ 00056000
         ST    R10,STRTMWA                                         0094 00057000
*   ENDMWA=R10+@SIZDATD;            /* END ADDR +1 OF WORKAREA       */ 00058000
*                                                                  0095 00059000
         LR    @14,R10                                             0095 00060000
         AL    @14,@SIZDATD                                        0095 00061000
         ST    @14,ENDMWA                                          0095 00062000
*   /*****************************************************************/ 00063000
*   /*                                                               */ 00064000
*   /* SET CONSOLE ID FOR WTO                                        */ 00065000
*   /*                                                               */ 00066000
*   /*****************************************************************/ 00067000
*                                                                  0096 00068000
*   IF(CHUCMP^=0)&(CHUCMP^='80'X) THEN                             0096 00069000
         L     @14,CSCBPTR                                         0096 00070000
         CLI   CHUCMP(@14),0                                       0096 00071000
         BE    @RF00096                                            0096 00072000
         CLI   CHUCMP(@14),X'80'                                   0096 00073000
         BE    @RF00096                                            0096 00074000
*     CONSOLID=CHUCMP;              /* WTO SENT TO ISSUING CONSOLE   */ 00075000
*                                                                  0097 00076000
         MVC   CONSOLID(1),CHUCMP(@14)                             0097 00077000
*   /*****************************************************************/ 00078000
*   /*                                                               */ 00079000
*   /* WTO SENT TO MASTER FOR RDR OR INTERNAL CMDS                   */ 00080000
*   /*                                                               */ 00081000
*   /*****************************************************************/ 00082000
*                                                                  0098 00083000
*   ELSE                                                           0098 00084000
*     CONSOLID=UCMID;                                              0098 00085000
*                                                                  0098 00086000
         B     @RC00096                                            0098 00087000
@RF00096 L     @14,CVTPTR                                          0098 00088000
         L     @14,UCMBASPT(,@14)                                  0098 00089000
         AL    @14,@CF02903                                        0098 00090000
         L     @14,UCMMCSPT(,@14)                                  0098 00091000
         L     @14,UCMDVEPT(,@14)                                  0098 00092000
         MVC   CONSOLID(1),UCMID(@14)                              0098 00093000
*   /*****************************************************************/ 00094000
*   /*                                                               */ 00095000
*   /* INIT ESTAE PARM LIST AND SET ESTAE ENVIRONMENT                */ 00096000
*   /*                                                               */ 00097000
*   /*****************************************************************/ 00098000
*                                                                  0099 00099000
*   RFY                                                            0099 00100000
*    (R2) RSTD;                                                    0099 00101000
@RC00096 DS    0H                                                  0100 00102000
*   DATARG=R10;                     /* DATA REG OF MAIN WORKAREA     */ 00103000
         ST    R10,DATARG                                          0100 00104000
*   CODERG1=R11;                    /* CODE REG FOR FIRST 4096       */ 00105000
         ST    R11,CODERG1                                         0101 00106000
*   CODERG2=R12;                    /* CODE REG FOR NEXT 4096        */ 00107000
         ST    R12,CODERG2                                         0102 00108000
*   R2=ADDR(EPARML);                /* ADDR OF USER PARM LIST        */ 00109000
         LA    R2,EPARML                                           0103 00110000
*   ESTLIST=''B;                    /* ZERO ESTAE INTERFACE          */ 00111000
         XC    ESTLIST(16),ESTLIST                                 0104 00112000
*   R1=ADDR(ESTLIST);               /* SET PTR TO CNTRL BLCK         */ 00113000
         LA    R1,ESTLIST                                          0105 00114000
*   GEN(ESTAE ESTAERTN,PARAM=(2),MF=(E,(1)));                      0106 00115000
         ESTAE ESTAERTN,PARAM=(2),MF=(E,(1))                            00116000
*   RFY                                                            0107 00117000
*    (R2) UNRSTD;                                                  0107 00118000
*                                                                  0107 00119000
*   /*****************************************************************/ 00120000
*   /*                                                               */ 00121000
*   /* IF ESTAE ESTABLISHED SUCCESSFULLY THEN PROCESS COMMAND ELSE   */ 00122000
*   /* WRITE ERROR MSG AND EXIT                                      */ 00123000
*   /*                                                               */ 00124000
*   /*****************************************************************/ 00125000
*                                                                  0108 00126000
*   IF R15=0 THEN                                                  0108 00127000
*                                                                  0108 00128000
         LTR   R15,R15                                             0108 00129000
         BNZ   @RF00108                                            0108 00130000
*     /***************************************************************/ 00131000
*     /*                                                             */ 00132000
*     /* ESTAE SUCCESSFUL. PARSE AND PROCESS COMMAND                 */ 00133000
*     /*                                                             */ 00134000
*     /***************************************************************/ 00135000
*                                                                  0109 00136000
*     DO;                                                          0109 00137000
*       CALL SYNCHK;                /* PARSE COMMAND                 */ 00138000
*                                                                  0110 00139000
         BAL   @14,SYNCHK                                          0110 00140000
*       /*************************************************************/ 00141000
*       /*                                                           */ 00142000
*       /* CHECK IF GOOD PARSE                                       */ 00143000
*       /*                                                           */ 00144000
*       /*************************************************************/ 00145000
*                                                                  0111 00146000
*       IF RC=0 THEN                                               0111 00147000
*                                                                  0111 00148000
         ICM   @14,15,RC                                           0111 00149000
         BNZ   @RF00111                                            0111 00150000
*         /***********************************************************/ 00151000
*         /*                                                         */ 00152000
*         /* GOOD PARSE. PROCESS REQUEST AND CLEANUP                 */ 00153000
*         /*                                                         */ 00154000
*         /***********************************************************/ 00155000
*                                                                  0112 00156000
*         DO;                                                      0112 00157000
*           IF OFFLINE='1'B THEN    /* CHECK IF OFFLINE REQUEST      */ 00158000
*                                                                  0113 00159000
         TM    OFFLINE,B'10000000'                                 0113 00160000
         BNO   @RF00113                                            0113 00161000
*             /*******************************************************/ 00162000
*             /*                                                     */ 00163000
*             /* PROCESS OFFLINE REQUEST                             */ 00164000
*             /*                                                     */ 00165000
*             /*******************************************************/ 00166000
*                                                                  0114 00167000
*             CALL VSTOROFF;                                       0114 00168000
*                                                                  0114 00169000
         BAL   @14,VSTOROFF                                        0114 00170000
*           /*********************************************************/ 00171000
*           /*                                                       */ 00172000
*           /* PROCESS ONLINE REQUEST                                */ 00173000
*           /*                                                       */ 00174000
*           /*********************************************************/ 00175000
*                                                                  0115 00176000
*           ELSE                                                   0115 00177000
*             CALL VSTORON;                                        0115 00178000
*                                                                  0115 00179000
         B     @RC00113                                            0115 00180000
@RF00113 BAL   @14,VSTORON                                         0115 00181000
*           /*********************************************************/ 00182000
*           /*                                                       */ 00183000
*           /* FREE RSR WORKAREA IF ALLOCATED                        */ 00184000
*           /*                                                       */ 00185000
*           /*********************************************************/ 00186000
*                                                                  0116 00187000
*           IF RSRWAP^=0 THEN                                      0116 00188000
@RC00113 ICM   @14,15,RSRWAP                                       0116 00189000
         BZ    @RF00116                                            0116 00190000
*             DO;                                                  0117 00191000
*               DO;                 /* FREEMAIN(R)                 0118 00192000
*                                      LV(RSRWAL)SP(253)A(RSRPARML)  */ 00193000
*                 RESPECIFY                                        0119 00194000
*                  (GPR01F,                                        0119 00195000
*                   GPR00F) RESTRICTED;                            0119 00196000
*                 GPR00F=RSRWAL;    /* LENGTH REQUESTED              */ 00197000
         L     GPR00F,RSRWAL                                       0120 00198000
*                 GPR01F=253;       /* SP IN REG 1                   */ 00199000
         LA    GPR01F,253                                          0121 00200000
*                 GEN(SLL   GPR01F,24)                             0122 00201000
*                 NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;     0122 00202000
         SLL   GPR01F,24                                                00203000
*                 GPR00F=GPR00F|GPR01F;/* SP IN HI BYTE              */ 00204000
         OR    GPR00F,GPR01F                                       0123 00205000
*                 GPR01F=ADDR(RSRPARML);/* SET REGISTER ONE          */ 00206000
         L     GPR01F,RSRWAP                                       0124 00207000
*                 SVC(10);          /* R-FORM OF GETMAIN             */ 00208000
         SVC   10                                                  0125 00209000
*                 RESPECIFY                                        0126 00210000
*                  (GPR01F,                                        0126 00211000
*                   GPR00F) UNRESTRICTED;                          0126 00212000
*               END;                /* FREEMAIN(R)                 0127 00213000
*                                      LV(RSRWAL)SP(253)A(RSRPARML)  */ 00214000
*             END;                                                 0128 00215000
*         END;                      /* END OF PROCESS GOOD COMMAND   */ 00216000
*     END;                                                         0130 00217000
*   ELSE                                                           0131 00218000
*                                                                  0131 00219000
*     /***************************************************************/ 00220000
*     /*                                                             */ 00221000
*     /* ESTAE FAILED. WRITE MESSAGE AND EXIT                        */ 00222000
*     /*                                                             */ 00223000
*     /***************************************************************/ 00224000
*                                                                  0131 00225000
*     DO;                                                          0131 00226000
         B     @RC00108                                            0131 00227000
@RF00108 DS    0H                                                  0132 00228000
*       CALL WTORTN(7);             /* WRITE ERROR MSG               */ 00229000
         LA    @01,@AL00132                                        0132 00230000
         BAL   @14,WTORTN                                          0132 00231000
*     END;                                                         0133 00232000
*                                                                  0133 00233000
*   /*****************************************************************/ 00234000
*   /*                                                               */ 00235000
*   /* FREE CSCB AND EXIT                                            */ 00236000
*   /*                                                               */ 00237000
*   /*****************************************************************/ 00238000
*                                                                  0134 00239000
*   CHFC='1'B;                      /* SET FREE CSCB BIT             */ 00240000
@RC00108 L     @14,CSCBPTR                                         0134 00241000
         OI    CHFC(@14),B'00000010'                               0134 00242000
*   R1=CSCBPTR;                     /* SET PTR TO CSCB               */ 00243000
         LR    R1,@14                                              0135 00244000
*   GEN(MGCR (1),CHAIN);            /* FREE CSCB                     */ 00245000
*                                                                  0136 00246000
         MGCR (1),CHAIN                                                 00247000
*   /*****************************************************************/ 00248000
*   /*                                                               */ 00249000
*   /* RETURN TO SYSTEM                                              */ 00250000
*   /*                                                               */ 00251000
*   /*****************************************************************/ 00252000
*                                                                  0137 00253000
*NRMEXIT:                                                          0137 00254000
*   R14=RETPTR;                     /* RESTORE RETURN REG            */ 00255000
NRMEXIT  LR    R14,RETPTR                                          0137 00256000
*   RETURN;                         /* RETURN TO SYSTEM              */ 00257000
@EL00001 L     @13,4(,@13)                                         0138 00258000
@EF00001 L     @00,@SIZDATD                                        0138 00259000
         LR    @01,@10                                             0138 00260000
         FREEMAIN R,LV=(0),A=(1)                                        00261000
@ER00001 BR    @14                                                 0138 00262000
*                                                                  0139 00263000
*/* SYNTAX CHECKING ROUTINE                                          */ 00264000
*/*                                                                  */ 00265000
*/* FUNCTION - CHECK COMMAND AUTHORIZATION AND PARSE COMMAND TEXT    */ 00266000
*/*                                                                  */ 00267000
*/* INPUT - COMMAND STRING IN CSCB                                   */ 00268000
*/*                                                                  */ 00269000
*/* OUTPUT -                                                         */ 00270000
*/*   GOOD COMMAND:                                                  */ 00271000
*/*    - RC=0                                                        */ 00272000
*/*    - SET VALUE OF OFFLINE FLAG,START RANGE,END RANGE IN WORKAREA */ 00273000
*/*   BAD COMMAND:                                                   */ 00274000
*/*    - RC=4                                                        */ 00275000
*/*    - ERROR MESSAGE WRITTEN TO OPERATOR                           */ 00276000
*/*                                                                  */ 00277000
*/* COMMAND SYNTAX                                                   */ 00278000
*/*                                                                  */ 00279000
*/*    V   STOR(XXXXXK,XXXXXK),OFFLINE                               */ 00280000
*/*   VARY      YYYYYY YYYYYY  ONLINE                                */ 00281000
*/*                                                                  */ 00282000
*/*   XXXXXK - 1 TO 5 CHAR DECIMAL K ADDRESS                         */ 00283000
*/*   YYYYYY - 1 TO 6 CHAR HEXADECIMAL ADDRESS                       */ 00284000
*/*                                                                  */ 00285000
*                                                                  0139 00286000
*SYNCHK:                                                           0139 00287000
*   PROC;                                                          0139 00288000
SYNCHK   STM   @14,@12,@SA00002                                    0139 00289000
*   DCL                                                            0140 00290000
*     PARSEP PTR,                   /* PARSE POINTER                 */ 00291000
*     LPARSEP PTR;                  /* LOCAL PARSE PTR               */ 00292000
*   DCL                                                            0141 00293000
*     CHARS CHAR(12) BASED(PARSEP); /* STRING MAP                    */ 00294000
*   DCL                                                            0142 00295000
*     DIGIT CHAR(1) BASED(LPARSEP); /* CHARACTER MAP                 */ 00296000
*   DCL                                                            0143 00297000
*     NUMBR FIXED(8) BASED(LPARSEP);/* ARITH VALUE OF CHAR           */ 00298000
*   DCL                                                            0144 00299000
*     COUNT FIXED;                  /* NUM OF CHARS IN ADDR          */ 00300000
*   DCL                                                            0145 00301000
*     BADDRP PTR;                   /* PTR TO ANSWER BUFFER FOR    0145 00302000
*                                      CONVERTED ADDRESS USED BY   0145 00303000
*                                      PARSE ADDR RTNS               */ 00304000
*   DCL                                                            0146 00305000
*     BINADDR FIXED BASED(BADDRP);  /* MAP OF ANSWER BUFFER USED BY     00306000
*                                      PARSE ADDR RTNS               */ 00307000
*                                                                  0146 00308000
*   /*****************************************************************/ 00309000
*   /*                                                               */ 00310000
*   /* ACCEPT COMMAND ONLY IF FROM MASTER CONSOLE, READER WITH       */ 00311000
*   /* AUTHORITY OF E000, OR AN INTERNAL COMMAND. IF NONE OF THE     */ 00312000
*   /* ABOVE THEN REJECT COMMAND.                                    */ 00313000
*   /*                                                               */ 00314000
*   /*****************************************************************/ 00315000
*                                                                  0147 00316000
*   IF(CHUCMP=UCMID)|               /* MASTER CONSOLE?               */ 00317000
*       ((CHUCMP='80'X)&(AUTHCODE='E000'X))|/* VALID READER?         */ 00318000
*       (CHUCMP=0) THEN             /* INTERNAL COMMAND?             */ 00319000
         L     @14,CSCBPTR                                         0147 00320000
         L     @09,CVTPTR                                          0147 00321000
         L     @09,UCMBASPT(,@09)                                  0147 00322000
         AL    @09,@CF02903                                        0147 00323000
         L     @09,UCMMCSPT(,@09)                                  0147 00324000
         L     @09,UCMDVEPT(,@09)                                  0147 00325000
         CLC   CHUCMP(1,@14),UCMID(@09)                            0147 00326000
         BE    @RT00147                                            0147 00327000
         CLI   CHUCMP(@14),X'80'                                   0147 00328000
         BNE   @GL00002                                            0147 00329000
         CLC   AUTHCODE(2,@14),@CB02462                            0147 00330000
         BE    @RT00147                                            0147 00331000
@GL00002 L     @14,CSCBPTR                                         0147 00332000
         CLI   CHUCMP(@14),0                                       0147 00333000
         BE    @RT00147                                            0147 00334000
*     GO TO PARSECMD;               /* PARSE VALID CALLER'S CMD      */ 00335000
*                                                                  0148 00336000
*   /*****************************************************************/ 00337000
*   /*                                                               */ 00338000
*   /* REJECT COMMAND, INVALID CALLER                                */ 00339000
*   /*                                                               */ 00340000
*   /*****************************************************************/ 00341000
*                                                                  0149 00342000
*   ELSE                                                           0149 00343000
*     GO TO INVCALLR;               /* INVALID CALLER EXIT           */ 00344000
*                                                                  0149 00345000
         B     INVCALLR                                            0149 00346000
*   /*****************************************************************/ 00347000
*   /*                                                               */ 00348000
*   /* AUTHORIZED CALLER. PARSE COMMAND                              */ 00349000
*   /*                                                               */ 00350000
*   /*****************************************************************/ 00351000
*                                                                  0150 00352000
*PARSECMD:                                                         0150 00353000
*   PARSEP=ADDR(CHBUF)+4;           /* SET PARSE PTR AFTER STOR      */ 00354000
*                                                                  0150 00355000
PARSECMD L     PARSEP,CSCBPTR                                      0150 00356000
         LA    PARSEP,CHBUF(,PARSEP)                               0150 00357000
         AH    PARSEP,@CH00165                                     0150 00358000
*   /*****************************************************************/ 00359000
*   /*                                                               */ 00360000
*   /* PARSE FOR (                                                   */ 00361000
*   /*                                                               */ 00362000
*   /*****************************************************************/ 00363000
*                                                                  0151 00364000
*   IF CHARS(1:1)^='(' THEN                                        0151 00365000
         CLI   CHARS(PARSEP),C'('                                  0151 00366000
         BNE   @RT00151                                            0151 00367000
*     GO TO INVSYN;                 /* INVALID SYNTAX EXIT           */ 00368000
*   PARSEP=PARSEP+1;                /* INCR PTR PAST (               */ 00369000
*                                                                  0153 00370000
         AH    PARSEP,@CH00066                                     0153 00371000
*   /*****************************************************************/ 00372000
*   /*                                                               */ 00373000
*   /* SET UP TO PARSE START ADDR                                    */ 00374000
*   /*                                                               */ 00375000
*   /*****************************************************************/ 00376000
*                                                                  0154 00377000
*   TYPEADDR=''B;                   /* CLEAR ADRESS TYPE FLAGS       */ 00378000
         MVI   TYPEADDR,X'00'                                      0154 00379000
*   BADDRP=ADDR(SRANGE);            /* @ START OF RANGE VAR          */ 00380000
*                                                                  0155 00381000
         LA    BADDRP,SRANGE                                       0155 00382000
*   /*****************************************************************/ 00383000
*   /*                                                               */ 00384000
*   /* PARSE START ADDRESS                                           */ 00385000
*   /*                                                               */ 00386000
*   /*****************************************************************/ 00387000
*                                                                  0156 00388000
*   CALL DECMADDR;                  /* PARSE FOR DECIMAL M ADDR      */ 00389000
         BAL   @14,DECMADDR                                        0156 00390000
*   IF RC^=0 THEN                   /* NOT DECIMAL M ADDR            */ 00391000
         ICM   @14,15,RC                                           0157 00392000
         BZ    @RF00157                                            0157 00393000
*     DO;                                                          0158 00394000
*       CALL DECKADDR;              /* PARSE FOR DECIMAL K ADDR      */ 00395000
         BAL   @14,DECKADDR                                        0159 00396000
*       IF RC^=0 THEN               /* NOT DECIMAL K ADDR            */ 00397000
         ICM   @14,15,RC                                           0160 00398000
         BZ    @RF00160                                            0160 00399000
*         DO;                                                      0161 00400000
*           CALL HEXADDR;           /* PARSE FOR HEXADECIMAL ADDR    */ 00401000
         BAL   @14,HEXADDR                                         0162 00402000
*           IF RC^=0 THEN           /* NOT HEX ADDR                  */ 00403000
         ICM   @14,15,RC                                           0163 00404000
         BNZ   @RT00163                                            0163 00405000
*             GO TO INVADDR;        /* INVALID ADDRESS EXIT          */ 00406000
*         END;                                                     0165 00407000
*     END;                                                         0166 00408000
*                                                                  0166 00409000
@RF00160 DS    0H                                                  0167 00410000
*   /*****************************************************************/ 00411000
*   /*                                                               */ 00412000
*   /* ROUND DOWN START ADDRESS TO 4K PAGE                           */ 00413000
*   /*                                                               */ 00414000
*   /*****************************************************************/ 00415000
*                                                                  0167 00416000
*   SRANGE=(SRANGE/4096)*4096;                                     0167 00417000
*                                                                  0167 00418000
@RF00157 L     @02,SRANGE                                          0167 00419000
         SRDA  @02,32                                              0167 00420000
         D     @02,@CF00139                                        0167 00421000
         SLA   @03,12                                              0167 00422000
         ST    @03,SRANGE                                          0167 00423000
*   /*****************************************************************/ 00424000
*   /*                                                               */ 00425000
*   /* PARSE FOR , BETWEEN START AND END ADDRESSES                   */ 00426000
*   /*                                                               */ 00427000
*   /*****************************************************************/ 00428000
*                                                                  0168 00429000
*   IF CHARS(1:1)^=',' THEN                                        0168 00430000
         CLI   CHARS(PARSEP),C','                                  0168 00431000
         BNE   @RT00168                                            0168 00432000
*     GO TO INVSYN;                 /* INVALID SYNTAX EXIT           */ 00433000
*   PARSEP=PARSEP+1;                /* INCR PAST ,                   */ 00434000
*                                                                  0170 00435000
         AH    PARSEP,@CH00066                                     0170 00436000
*   /*****************************************************************/ 00437000
*   /*                                                               */ 00438000
*   /* SET UP TO PARSE END ADDR                                      */ 00439000
*   /*                                                               */ 00440000
*   /*****************************************************************/ 00441000
*                                                                  0171 00442000
*   BADDRP=ADDR(ERANGE);            /* @ END OF RANGE VAR.           */ 00443000
*                                                                  0171 00444000
         LA    BADDRP,ERANGE                                       0171 00445000
*   /*****************************************************************/ 00446000
*   /*                                                               */ 00447000
*   /* PARSE END ADDRESS                                             */ 00448000
*   /*                                                               */ 00449000
*   /*****************************************************************/ 00450000
*                                                                  0172 00451000
*   IF DECMA='1'B THEN                                             0172 00452000
*                                                                  0172 00453000
         TM    DECMA,B'10000000'                                   0172 00454000
         BNO   @RF00172                                            0172 00455000
*     /***************************************************************/ 00456000
*     /*                                                             */ 00457000
*     /* PARSE DECIMAL M ADDRESS                                     */ 00458000
*     /*                                                             */ 00459000
*     /***************************************************************/ 00460000
*                                                                  0173 00461000
*     CALL DECMADDR;                /* PARSE DECIMAL M ADDR          */ 00462000
         BAL   @14,DECMADDR                                        0173 00463000
*   ELSE                                                           0174 00464000
*     IF DECKA='1'B THEN            /* DECIMAL K ADDR ?              */ 00465000
         B     @RC00172                                            0174 00466000
@RF00172 TM    DECKA,B'01000000'                                   0174 00467000
         BNO   @RF00174                                            0174 00468000
*       CALL DECKADDR;              /* PARSE DECIMAL K ADDR          */ 00469000
*                                                                  0175 00470000
         BAL   @14,DECKADDR                                        0175 00471000
*   /*****************************************************************/ 00472000
*   /*                                                               */ 00473000
*   /* PARSE HEX ADDRESS                                             */ 00474000
*   /*                                                               */ 00475000
*   /*****************************************************************/ 00476000
*                                                                  0176 00477000
*     ELSE                                                         0176 00478000
*       CALL HEXADDR;                                              0176 00479000
*                                                                  0176 00480000
         B     @RC00174                                            0176 00481000
@RF00174 BAL   @14,HEXADDR                                         0176 00482000
*   /*****************************************************************/ 00483000
*   /*                                                               */ 00484000
*   /* CHECK IF GOOD PARSE                                           */ 00485000
*   /*                                                               */ 00486000
*   /*****************************************************************/ 00487000
*                                                                  0177 00488000
*   IF RC^=0 THEN                                                  0177 00489000
@RC00174 DS    0H                                                  0177 00490000
@RC00172 ICM   @14,15,RC                                           0177 00491000
         BNZ   @RT00177                                            0177 00492000
*     GO TO INVADDR;                /* REJECT IF FAILED              */ 00493000
*                                                                  0178 00494000
*   /*****************************************************************/ 00495000
*   /*                                                               */ 00496000
*   /* ROUND END ADDR UP TO 4K PAGE                                  */ 00497000
*   /*                                                               */ 00498000
*   /*****************************************************************/ 00499000
*                                                                  0179 00500000
*   ERANGE=((ERANGE+4096-1)/4096)*4096;                            0179 00501000
*                                                                  0179 00502000
         L     @02,ERANGE                                          0179 00503000
         SH    @02,@CH02883                                        0179 00504000
         SRDA  @02,32                                              0179 00505000
         D     @02,@CF00139                                        0179 00506000
         SLA   @03,12                                              0179 00507000
         ST    @03,ERANGE                                          0179 00508000
*   /*****************************************************************/ 00509000
*   /*                                                               */ 00510000
*   /* PARSE FUNCTION OPERAND                                        */ 00511000
*   /*                                                               */ 00512000
*   /*****************************************************************/ 00513000
*                                                                  0180 00514000
*   IF CHARS(1:9)='),ONLINE ' THEN  /* ONLINE?                       */ 00515000
         CLC   CHARS(9,PARSEP),@CC02473                            0180 00516000
         BNE   @RF00180                                            0180 00517000
*     OFFLINE='0'B;                 /* CLEAR OFFLINE FLAG            */ 00518000
*                                                                  0181 00519000
         NI    OFFLINE,B'01111111'                                 0181 00520000
*   /*****************************************************************/ 00521000
*   /*                                                               */ 00522000
*   /* NOT ONLINE, TEST IF OFFLINE                                   */ 00523000
*   /*                                                               */ 00524000
*   /*****************************************************************/ 00525000
*                                                                  0182 00526000
*   ELSE                                                           0182 00527000
*     IF CHARS(1:10)='),OFFLINE ' THEN/* OFFLINE?                    */ 00528000
         B     @RC00180                                            0182 00529000
@RF00180 CLC   CHARS(10,PARSEP),@CC02476                           0182 00530000
         BNE   @RF00182                                            0182 00531000
*       OFFLINE='1'B;               /* SET OFFLINE FLAG              */ 00532000
*                                                                  0183 00533000
         OI    OFFLINE,B'10000000'                                 0183 00534000
*   /*****************************************************************/ 00535000
*   /*                                                               */ 00536000
*   /* NO, THEN INVALID FUNCTION OPERAND                             */ 00537000
*   /*                                                               */ 00538000
*   /*****************************************************************/ 00539000
*                                                                  0184 00540000
*     ELSE                                                         0184 00541000
*       GO TO INVSYN;               /* INVALID SYNTAX EXIT           */ 00542000
*                                                                  0184 00543000
*   /*****************************************************************/ 00544000
*   /*                                                               */ 00545000
*   /* CHECK IF VALID ADDRESS PAIR                                   */ 00546000
*   /*                                                               */ 00547000
*   /*****************************************************************/ 00548000
*                                                                  0185 00549000
*   IF(ERANGE<=SRANGE)|(ERANGE>(CVTEORM+4096-1)) THEN              0185 00550000
@RC00180 L     @14,ERANGE                                          0185 00551000
         C     @14,SRANGE                                          0185 00552000
         BNH   @RT00185                                            0185 00553000
         L     @09,CVTPTR                                          0185 00554000
         L     @09,CVTEORM(,@09)                                   0185 00555000
         SH    @09,@CH02883                                        0185 00556000
         CR    @14,@09                                             0185 00557000
         BH    @RT00185                                            0185 00558000
*     GO TO INVADDR;                /* INVALID ERROR EXIT            */ 00559000
*                                                                  0186 00560000
*   /*****************************************************************/ 00561000
*   /*                                                               */ 00562000
*   /* RETURN FROM GOOD PARSE                                        */ 00563000
*   /*                                                               */ 00564000
*   /*****************************************************************/ 00565000
*                                                                  0187 00566000
*   RC=0;                           /* SET RETURN CODE               */ 00567000
         SLR   @14,@14                                             0187 00568000
         ST    @14,RC                                              0187 00569000
*   RETURN;                         /* RETURN TO MAINLINE            */ 00570000
*                                                                  0188 00571000
@EL00002 DS    0H                                                  0188 00572000
@EF00002 DS    0H                                                  0188 00573000
@ER00002 LM    @14,@12,@SA00002                                    0188 00574000
         BR    @14                                                 0188 00575000
*   /*****************************************************************/ 00576000
*   /*                                                               */ 00577000
*   /* INVALID SYNTAX ERROR EXIT                                     */ 00578000
*   /*                                                               */ 00579000
*   /*****************************************************************/ 00580000
*                                                                  0189 00581000
*INVSYN:                                                           0189 00582000
*   RC=4;                           /* SET RETURN CODE               */ 00583000
INVSYN   MVC   RC(4),@CF00165                                      0189 00584000
*   CALL WTORTN(9);                 /* INVALID SYNTAX ERROR MSG      */ 00585000
         LA    @01,@AL00190                                        0190 00586000
         BAL   @14,WTORTN                                          0190 00587000
*   RETURN;                         /* RETURN TO MAINLINE            */ 00588000
*                                                                  0191 00589000
         B     @EL00002                                            0191 00590000
*   /*****************************************************************/ 00591000
*   /*                                                               */ 00592000
*   /* INVALID ADDRESS ERROR EXIT                                    */ 00593000
*   /*                                                               */ 00594000
*   /*****************************************************************/ 00595000
*                                                                  0192 00596000
*INVADDR:                                                          0192 00597000
*   RC=4;                           /* SET RETURN CODE               */ 00598000
INVADDR  MVC   RC(4),@CF00165                                      0192 00599000
*   CALL WTORTN(12);                /* INVALID ADDRESS ERROR MSG     */ 00600000
         LA    @01,@AL00193                                        0193 00601000
         BAL   @14,WTORTN                                          0193 00602000
*   RETURN;                         /* RETURN TO MAINLINE            */ 00603000
*                                                                  0194 00604000
         B     @EL00002                                            0194 00605000
*   /*****************************************************************/ 00606000
*   /*                                                               */ 00607000
*   /* UNAUTHORIZED CALLER EXIT                                      */ 00608000
*   /*                                                               */ 00609000
*   /*****************************************************************/ 00610000
*                                                                  0195 00611000
*INVCALLR:                                                         0195 00612000
*   RC=4;                           /* SET RETURN CODE               */ 00613000
INVCALLR MVC   RC(4),@CF00165                                      0195 00614000
*   CALL WTORTN(8);                 /* UNAUTHORIZED CALLER MSG       */ 00615000
         LA    @01,@AL00196                                        0196 00616000
         BAL   @14,WTORTN                                          0196 00617000
*   RETURN;                         /* RETURN TO MAINLINE            */ 00618000
         B     @EL00002                                            0197 00619000
*                                                                  0198 00620000
*/* PARSE DECIMAL M ADDRESS                                          */ 00621000
*/*                                                                  */ 00622000
*/* INPUT -                                                          */ 00623000
*/*  PARSEP - @ FIRST CHAR OF ADDRESS STRING IN COMMAND              */ 00624000
*/*  BADDRP - @ OF FIXED BUFFER WHERE CONVERTED BINARY VALUE         */ 00625000
*/*          IS STORED                                               */ 00626000
*/*                                                                  */ 00627000
*/* OUTPUT -                                                         */ 00628000
*/*  PARSEP - INCR PAST STRING IF GOOD PARSE ELSE SAME AS INPUT      */ 00629000
*/*  RC      - 0 = GOOD PARSE                                        */ 00630000
*/*          - 4 = BAD PARSE                                         */ 00631000
*/*  BINADDR - BUFFER WHERE CONVERTED BINARY VALUE                   */ 00632000
*/*              OF ADDRESS IS RETURNED                              */ 00633000
*/*                                                                  */ 00634000
*                                                                  0198 00635000
*DECMADDR:                                                         0198 00636000
*   PROC OPTIONS(NOSAVEAREA);                                      0198 00637000
DECMADDR STM   @14,@05,12(@13)                                     0198 00638000
         STM   @07,@12,48(@13)                                     0198 00639000
*   RC=0;                           /* CLEAR RETURN CODE             */ 00640000
         SLR   @14,@14                                             0199 00641000
         ST    @14,RC                                              0199 00642000
*   LPARSEP=PARSEP;                 /* SET LOCAL PARSE PTR           */ 00643000
         LR    LPARSEP,PARSEP                                      0200 00644000
*   BINADDR=0;                      /* INIT CONVERTED VALUE          */ 00645000
         ST    @14,BINADDR(,BADDRP)                                0201 00646000
*   COUNT=0;                        /* ZERO DIGIT COUNT              */ 00647000
*                                                                  0202 00648000
         SLR   COUNT,COUNT                                         0202 00649000
*   /*****************************************************************/ 00650000
*   /*                                                               */ 00651000
*   /* CHAR STRING IS A DECIMAL NUMBER <=16.                         */ 00652000
*   /*                                                               */ 00653000
*   /*****************************************************************/ 00654000
*                                                                  0203 00655000
*   DO WHILE((DIGIT>='0')&(BINADDR<=16));                          0203 00656000
*                                                                  0203 00657000
         B     @DE00203                                            0203 00658000
@DL00203 DS    0H                                                  0204 00659000
*     /***************************************************************/ 00660000
*     /*                                                             */ 00661000
*     /* PROCESS VALID DIGIT. CONVERT CHARACTER VALUE TO BINARY AND  */ 00662000
*     /* ADD INTO SUM.                                               */ 00663000
*     /*                                                             */ 00664000
*     /***************************************************************/ 00665000
*                                                                  0204 00666000
*     BINADDR=(BINADDR*10)+NUMBR-240;/* ADD IN NUMBER VALUE          */ 00667000
         L     @14,BINADDR(,BADDRP)                                0204 00668000
         MH    @14,@CH00035                                        0204 00669000
         SLR   @07,@07                                             0204 00670000
         IC    @07,NUMBR(,LPARSEP)                                 0204 00671000
         ALR   @14,@07                                             0204 00672000
         SH    @14,@CH02485                                        0204 00673000
         ST    @14,BINADDR(,BADDRP)                                0204 00674000
*     LPARSEP=LPARSEP+1;            /* INCR LOCAL PARSE PTR          */ 00675000
         LA    @14,1                                               0205 00676000
         ALR   LPARSEP,@14                                         0205 00677000
*     COUNT=COUNT+1;                /* INCR DIGIT COUNT              */ 00678000
         ALR   COUNT,@14                                           0206 00679000
*   END;                                                           0207 00680000
*                                                                  0207 00681000
@DE00203 CLI   DIGIT(LPARSEP),C'0'                                 0207 00682000
         BL    @DC00203                                            0207 00683000
         L     @14,BINADDR(,BADDRP)                                0207 00684000
         CH    @14,@CH00064                                        0207 00685000
         BNH   @DL00203                                            0207 00686000
@DC00203 DS    0H                                                  0208 00687000
*   /*****************************************************************/ 00688000
*   /*                                                               */ 00689000
*   /* CHECK IF ILLEGAL DECIMAL M STRING . IF SO THEN SET ERROR      */ 00690000
*   /* RETURN CODE                                                   */ 00691000
*   /*                                                               */ 00692000
*   /*****************************************************************/ 00693000
*                                                                  0208 00694000
*   IF(COUNT=0)|(BINADDR>16)|(DIGIT^='M') THEN                     0208 00695000
         LTR   COUNT,COUNT                                         0208 00696000
         BZ    @RT00208                                            0208 00697000
         L     @14,BINADDR(,BADDRP)                                0208 00698000
         CH    @14,@CH00064                                        0208 00699000
         BH    @RT00208                                            0208 00700000
         CLI   DIGIT(LPARSEP),C'M'                                 0208 00701000
         BE    @RF00208                                            0208 00702000
@RT00208 DS    0H                                                  0209 00703000
*     RC=4;                         /* SET BAD PARSE RETURN CODE     */ 00704000
*                                                                  0209 00705000
         MVC   RC(4),@CF00165                                      0209 00706000
*   /*****************************************************************/ 00707000
*   /*                                                               */ 00708000
*   /* PROCESS GOOD PARSE. MULTIPLY CONVERTED VALUE BY 1 MEG         */ 00709000
*   /*                                                               */ 00710000
*   /*****************************************************************/ 00711000
*                                                                  0210 00712000
*   ELSE                                                           0210 00713000
*     DO;                                                          0210 00714000
         B     @RC00208                                            0210 00715000
@RF00208 DS    0H                                                  0211 00716000
*       BINADDR=BINADDR*1024*1024;  /* CONVERT TO M ADDR VALUE       */ 00717000
         L     @14,BINADDR(,BADDRP)                                0211 00718000
         SLA   @14,20                                              0211 00719000
         ST    @14,BINADDR(,BADDRP)                                0211 00720000
*       PARSEP=LPARSEP+1;           /* SET GLOBAL PARSE PTR PAST 'M' */ 00721000
         LA    PARSEP,1                                            0212 00722000
         ALR   PARSEP,LPARSEP                                      0212 00723000
*       DECMA='1'B;                 /* SET DECIMAL M FLAG            */ 00724000
         OI    DECMA,B'10000000'                                   0213 00725000
*     END;                                                         0214 00726000
*                                                                  0214 00727000
*   /*****************************************************************/ 00728000
*   /*                                                               */ 00729000
*   /* RETURN TO PARSE ROUTINE                                       */ 00730000
*   /*                                                               */ 00731000
*   /*****************************************************************/ 00732000
*                                                                  0215 00733000
*   RETURN;                                                        0215 00734000
@EL00003 DS    0H                                                  0215 00735000
@EF00003 DS    0H                                                  0215 00736000
@ER00003 LM    @14,@05,12(@13)                                     0215 00737000
         LM    @07,@12,48(@13)                                     0215 00738000
         BR    @14                                                 0215 00739000
*   END DECMADDR;                                                  0216 00740000
         B     @EL00003                                            0216 00741000
*                                                                  0217 00742000
*/* PARSE DECIMAL K ADDRESS                                          */ 00743000
*/*                                                                  */ 00744000
*/* INPUT -                                                          */ 00745000
*/*  PARSEP - @ FIRST CHAR OF ADDRESS STRING IN COMMAND              */ 00746000
*/*  BADDRP - @ OF FIXED BUFFER WHERE CONVERTED BINARY VALUE         */ 00747000
*/*          IS STORED                                               */ 00748000
*/*                                                                  */ 00749000
*/* OUTPUT -                                                         */ 00750000
*/*  PARSEP - INCR PAST STRING IF GOOD PARSE ELSE SAME AS INPUT      */ 00751000
*/*  RC      - 0 = GOOD PARSE                                        */ 00752000
*/*          - 4 = BAD PARSE                                         */ 00753000
*/*  BINADDR - BUFFER WHERE CONVERTED BINARY VALUE                   */ 00754000
*/*              OF ADDRESS IS RETURNED                              */ 00755000
*/*                                                                  */ 00756000
*                                                                  0217 00757000
*DECKADDR:                                                         0217 00758000
*   PROC OPTIONS(NOSAVEAREA);                                      0217 00759000
DECKADDR STM   @14,@05,12(@13)                                     0217 00760000
         STM   @07,@12,48(@13)                                     0217 00761000
*   RC=0;                           /* CLEAR RETURN CODE             */ 00762000
         SLR   @14,@14                                             0218 00763000
         ST    @14,RC                                              0218 00764000
*   LPARSEP=PARSEP;                 /* SET LOCAL PARSE PTR           */ 00765000
         LR    LPARSEP,PARSEP                                      0219 00766000
*   BINADDR=0;                      /* INIT CONVERTED VALUE          */ 00767000
         ST    @14,BINADDR(,BADDRP)                                0220 00768000
*   COUNT=0;                        /* INIT CHAR COUNTER             */ 00769000
*                                                                  0221 00770000
         SLR   COUNT,COUNT                                         0221 00771000
*   /*****************************************************************/ 00772000
*   /*                                                               */ 00773000
*   /* CHAR STRING IS 1-5 CHARS WITH EACH CHAR BETWEEN 0-9.          */ 00774000
*   /*                                                               */ 00775000
*   /*****************************************************************/ 00776000
*                                                                  0222 00777000
*   DO WHILE((DIGIT>='0')&(COUNT<=5));                             0222 00778000
*                                                                  0222 00779000
         B     @DE00222                                            0222 00780000
@DL00222 DS    0H                                                  0223 00781000
*     /***************************************************************/ 00782000
*     /*                                                             */ 00783000
*     /* PROCESS VALID DIGIT. CONVERT CHARACTER VALUE TO BINARY AND  */ 00784000
*     /* ADD INTO SUM.                                               */ 00785000
*     /*                                                             */ 00786000
*     /***************************************************************/ 00787000
*                                                                  0223 00788000
*     BINADDR=(BINADDR*10)+NUMBR-240;/* ADD IN NUMBER VALUE          */ 00789000
         L     @14,BINADDR(,BADDRP)                                0223 00790000
         MH    @14,@CH00035                                        0223 00791000
         SLR   @07,@07                                             0223 00792000
         IC    @07,NUMBR(,LPARSEP)                                 0223 00793000
         ALR   @14,@07                                             0223 00794000
         SH    @14,@CH02485                                        0223 00795000
         ST    @14,BINADDR(,BADDRP)                                0223 00796000
*     COUNT=COUNT+1;                /* INCR CHAR COUNTER             */ 00797000
         LA    @14,1                                               0224 00798000
         ALR   COUNT,@14                                           0224 00799000
*     LPARSEP=LPARSEP+1;            /* INCR LOCAL PARSE PTR          */ 00800000
         ALR   LPARSEP,@14                                         0225 00801000
*   END;                                                           0226 00802000
*                                                                  0226 00803000
@DE00222 CLI   DIGIT(LPARSEP),C'0'                                 0226 00804000
         BL    @DC00222                                            0226 00805000
         CH    COUNT,@CH01117                                      0226 00806000
         BNH   @DL00222                                            0226 00807000
@DC00222 DS    0H                                                  0227 00808000
*   /*****************************************************************/ 00809000
*   /*                                                               */ 00810000
*   /* CHECK IF ILLEGAL DECIMAL K STRING . IF SO THEN SET ERROR      */ 00811000
*   /* RETURN CODE                                                   */ 00812000
*   /*                                                               */ 00813000
*   /*****************************************************************/ 00814000
*                                                                  0227 00815000
*   IF(COUNT=0)|(COUNT>5)|(DIGIT^='K') THEN                        0227 00816000
         LTR   COUNT,COUNT                                         0227 00817000
         BZ    @RT00227                                            0227 00818000
         CH    COUNT,@CH01117                                      0227 00819000
         BH    @RT00227                                            0227 00820000
         CLI   DIGIT(LPARSEP),C'K'                                 0227 00821000
         BE    @RF00227                                            0227 00822000
@RT00227 DS    0H                                                  0228 00823000
*     RC=4;                         /* SET BAD PARSE RETURN CODE     */ 00824000
*                                                                  0228 00825000
         MVC   RC(4),@CF00165                                      0228 00826000
*   /*****************************************************************/ 00827000
*   /*                                                               */ 00828000
*   /* PROCESS GOOD PARSE. MULTIPLY CONVERTED VALUE BY 1024          */ 00829000
*   /*                                                               */ 00830000
*   /*****************************************************************/ 00831000
*                                                                  0229 00832000
*   ELSE                                                           0229 00833000
*     DO;                                                          0229 00834000
         B     @RC00227                                            0229 00835000
@RF00227 DS    0H                                                  0230 00836000
*       BINADDR=BINADDR*1024;       /* CONVERT TO K ADDR VALUE       */ 00837000
         L     @14,BINADDR(,BADDRP)                                0230 00838000
         SLA   @14,10                                              0230 00839000
         ST    @14,BINADDR(,BADDRP)                                0230 00840000
*       PARSEP=LPARSEP+1;           /* SET GLOBAL PARSE PTR PAST 'K' */ 00841000
         LA    PARSEP,1                                            0231 00842000
         ALR   PARSEP,LPARSEP                                      0231 00843000
*       DECKA='1'B;                 /* SET DECIMAL K FLAG            */ 00844000
         OI    DECKA,B'01000000'                                   0232 00845000
*     END;                                                         0233 00846000
*                                                                  0233 00847000
*   /*****************************************************************/ 00848000
*   /*                                                               */ 00849000
*   /* RETURN TO PARSE ROUTINE                                       */ 00850000
*   /*                                                               */ 00851000
*   /*****************************************************************/ 00852000
*                                                                  0234 00853000
*   RETURN;                                                        0234 00854000
@EL00004 DS    0H                                                  0234 00855000
@EF00004 DS    0H                                                  0234 00856000
@ER00004 LM    @14,@05,12(@13)                                     0234 00857000
         LM    @07,@12,48(@13)                                     0234 00858000
         BR    @14                                                 0234 00859000
*   END DECKADDR;                                                  0235 00860000
         B     @EL00004                                            0235 00861000
*                                                                  0236 00862000
*/* PARSE HEXADECIMAL ADDRESS                                        */ 00863000
*/*                                                                  */ 00864000
*/* INPUT -                                                          */ 00865000
*/*  PARSEP - @ FIRST CHAR OF ADDRESS STRING IN COMMAND              */ 00866000
*/*  BADDRP - @ OF FIXED BUFFER WHERE CONVERTED BINARY VALUE         */ 00867000
*/*          IS STORED                                               */ 00868000
*/*                                                                  */ 00869000
*/* OUTPUT -                                                         */ 00870000
*/*  PARSEP - INCR PAST STRING IF GOOD PARSE ELSE SAME AS INPUT      */ 00871000
*/*  RC      - 0 = GOOD PARSE                                        */ 00872000
*/*          - 4 = BAD PARSE                                         */ 00873000
*/*  BINADDR - BUFFER WHERE CONVERTED BINARY VALUE                   */ 00874000
*/*              OF ADDRESS IS RETURNED                              */ 00875000
*/*                                                                  */ 00876000
*                                                                  0236 00877000
*HEXADDR:                                                          0236 00878000
*   PROC OPTIONS(NOSAVEAREA);                                      0236 00879000
HEXADDR  STM   @14,@05,12(@13)                                     0236 00880000
         STM   @07,@12,48(@13)                                     0236 00881000
*   RC=0;                           /* CLEAR RETURN CODE             */ 00882000
         SLR   @14,@14                                             0237 00883000
         ST    @14,RC                                              0237 00884000
*   LPARSEP=PARSEP;                 /* SET LOCAL PARSE PTR           */ 00885000
         LR    LPARSEP,PARSEP                                      0238 00886000
*   BINADDR=0;                      /* INIT CONVERTED VALUE          */ 00887000
         ST    @14,BINADDR(,BADDRP)                                0239 00888000
*   COUNT=0;                        /* INIT CHAR COUNTER             */ 00889000
*                                                                  0240 00890000
         SLR   COUNT,COUNT                                         0240 00891000
*   /*****************************************************************/ 00892000
*   /*                                                               */ 00893000
*   /* SCAN CHAR STRING AND CONVERT HEX ADDR. CHAR STRING IS 1-6     */ 00894000
*   /* CHARS WITH EACH CHAR BETWEEN 0-9 OR A-F                       */ 00895000
*   /*                                                               */ 00896000
*   /*****************************************************************/ 00897000
*                                                                  0241 00898000
*   DO WHILE((((DIGIT>='A')&(DIGIT<='F'))|(DIGIT>='0'))&(COUNT<=6));    00899000
*                                                                  0241 00900000
         B     @DE00241                                            0241 00901000
@DL00241 DS    0H                                                  0242 00902000
*     /***************************************************************/ 00903000
*     /*                                                             */ 00904000
*     /* PROCESS VALID DIGIT. CONVERT CHARACTER VALUE TO BINARY AND  */ 00905000
*     /* ADD INTO SUM.                                               */ 00906000
*     /*                                                             */ 00907000
*     /***************************************************************/ 00908000
*                                                                  0242 00909000
*     IF DIGIT>='0' THEN                                           0242 00910000
*                                                                  0242 00911000
         CLI   DIGIT(LPARSEP),C'0'                                 0242 00912000
         BL    @RF00242                                            0242 00913000
*       /*************************************************************/ 00914000
*       /*                                                           */ 00915000
*       /* ADD IN VALUE OF NUMBER DIGIT                              */ 00916000
*       /*                                                           */ 00917000
*       /*************************************************************/ 00918000
*                                                                  0243 00919000
*       BINADDR=(BINADDR*16)+NUMBR-240;                            0243 00920000
*                                                                  0243 00921000
         L     @14,BINADDR(,BADDRP)                                0243 00922000
         SLA   @14,4                                               0243 00923000
         SLR   @07,@07                                             0243 00924000
         IC    @07,NUMBR(,LPARSEP)                                 0243 00925000
         ALR   @14,@07                                             0243 00926000
         SH    @14,@CH02485                                        0243 00927000
         ST    @14,BINADDR(,BADDRP)                                0243 00928000
*     /***************************************************************/ 00929000
*     /*                                                             */ 00930000
*     /* ADD IN VALUE OF LETTER DIGIT                                */ 00931000
*     /*                                                             */ 00932000
*     /***************************************************************/ 00933000
*                                                                  0244 00934000
*     ELSE                                                         0244 00935000
*       BINADDR=(BINADDR*16)+9+NUMBR-192;                          0244 00936000
         B     @RC00242                                            0244 00937000
@RF00242 L     @14,BINADDR(,BADDRP)                                0244 00938000
         SLA   @14,4                                               0244 00939000
         AL    @14,@CF00874                                        0244 00940000
         SLR   @07,@07                                             0244 00941000
         IC    @07,NUMBR(,LPARSEP)                                 0244 00942000
         ALR   @14,@07                                             0244 00943000
         SH    @14,@CH02497                                        0244 00944000
         ST    @14,BINADDR(,BADDRP)                                0244 00945000
*     COUNT=COUNT+1;                /* INCR CHAR COUNTER             */ 00946000
@RC00242 LA    @14,1                                               0245 00947000
         ALR   COUNT,@14                                           0245 00948000
*     LPARSEP=LPARSEP+1;            /* INCR LOCAL PARSE PTR          */ 00949000
         ALR   LPARSEP,@14                                         0246 00950000
*   END;                                                           0247 00951000
*                                                                  0247 00952000
@DE00241 CLI   DIGIT(LPARSEP),C'A'                                 0247 00953000
         BL    @GL00013                                            0247 00954000
         CLI   DIGIT(LPARSEP),C'F'                                 0247 00955000
         BNH   @GL00012                                            0247 00956000
@GL00013 CLI   DIGIT(LPARSEP),C'0'                                 0247 00957000
         BL    @DC00241                                            0247 00958000
@GL00012 CH    COUNT,@CH01580                                      0247 00959000
         BNH   @DL00241                                            0247 00960000
@DC00241 DS    0H                                                  0248 00961000
*   /*****************************************************************/ 00962000
*   /*                                                               */ 00963000
*   /* CHECK IF ILLEGAL HEX STRING. IF SO THEN SET ERROR RETURN CODE */ 00964000
*   /*                                                               */ 00965000
*   /*****************************************************************/ 00966000
*                                                                  0248 00967000
*   IF(COUNT=0)|(COUNT>6)|(DIGIT='K')|(DIGIT='M') THEN             0248 00968000
         LTR   COUNT,COUNT                                         0248 00969000
         BZ    @RT00248                                            0248 00970000
         CH    COUNT,@CH01580                                      0248 00971000
         BH    @RT00248                                            0248 00972000
         CLI   DIGIT(LPARSEP),C'K'                                 0248 00973000
         BE    @RT00248                                            0248 00974000
         CLI   DIGIT(LPARSEP),C'M'                                 0248 00975000
         BNE   @RF00248                                            0248 00976000
@RT00248 DS    0H                                                  0249 00977000
*     RC=4;                         /* SET BAD PARSE RETURN CODE     */ 00978000
*                                                                  0249 00979000
         MVC   RC(4),@CF00165                                      0249 00980000
*   /*****************************************************************/ 00981000
*   /*                                                               */ 00982000
*   /* PROCESS GOOD PARSE. TEST IF START ADDRESS                     */ 00983000
*   /*                                                               */ 00984000
*   /*****************************************************************/ 00985000
*                                                                  0250 00986000
*   ELSE                                                           0250 00987000
*     DO;                                                          0250 00988000
         B     @RC00248                                            0250 00989000
@RF00248 DS    0H                                                  0251 00990000
*       PARSEP=LPARSEP;             /* SET GLOBAL PARSE PTR          */ 00991000
         LR    PARSEP,LPARSEP                                      0251 00992000
*       HEXA='1'B;                  /* SET HEX FLAG ON               */ 00993000
         OI    HEXA,B'00100000'                                    0252 00994000
*     END;                                                         0253 00995000
*                                                                  0253 00996000
*   /*****************************************************************/ 00997000
*   /*                                                               */ 00998000
*   /* RETURN TO PARSE ROUTINE                                       */ 00999000
*   /*                                                               */ 01000000
*   /*****************************************************************/ 01001000
*                                                                  0254 01002000
*   RETURN;                                                        0254 01003000
@EL00005 DS    0H                                                  0254 01004000
@EF00005 DS    0H                                                  0254 01005000
@ER00005 LM    @14,@05,12(@13)                                     0254 01006000
         LM    @07,@12,48(@13)                                     0254 01007000
         BR    @14                                                 0254 01008000
*   END HEXADDR;                                                   0255 01009000
         B     @EL00005                                            0255 01010000
*   END SYNCHK;                                                    0256 01011000
*                                                                  0257 01012000
*/*        VARY OFFLINE PROCESSOR                                    */ 01013000
*/*  CHECK STATUS OF PAGES, IF ALL PAGES NOT OFFLINE THEN CALL RSR   */ 01014000
*/*  TO VARY RANGE OFFLINE.  AFTER RANGE SUCCESSFULLY VARIED OFFLINE */ 01015000
*/*  THEN ZERO ALL STORAGE IN RANGE, WRITE SMF RECORD, AND WRITE     */ 01016000
*/*  OFFLINE MESSAGE TO OPERATOR.                                    */ 01017000
*/*                                                                  */ 01018000
*                                                                  0257 01019000
*VSTOROFF:                                                         0257 01020000
*   PROC;                                                          0257 01021000
*                                                                  0257 01022000
VSTOROFF STM   @14,@12,@SA00006                                    0257 01023000
*   /*****************************************************************/ 01024000
*   /*                                                               */ 01025000
*   /* TIME DELAY CONSTANT TO CAUSE 1 SECOND WAIT BEFORE ISSUING     */ 01026000
*   /* OFFLINE WAITING TO COMPLETE MESSAGE                           */ 01027000
*   /*                                                               */ 01028000
*   /*****************************************************************/ 01029000
*                                                                  0258 01030000
*   DCL                                                            0258 01031000
*     WAITTIME CHAR(8) STATIC LOCAL BDY(DWORD) INIT('00000100');   0258 01032000
*   DCL                                                            0259 01033000
*     LOOPCNT PTR(31);              /* LOOP COUNTER          @ZA02972*/ 01034000
*                                                                  0259 01035000
*   /*****************************************************************/ 01036000
*   /*                                                               */ 01037000
*   /* START OF VSTOROFF. GET STATUS OF ALL PAGES IN RANGE           */ 01038000
*   /*                                                               */ 01039000
*   /*****************************************************************/ 01040000
*                                                                  0260 01041000
*   CALL RSRSTAT;                                                  0260 01042000
*                                                                  0260 01043000
         BAL   @14,RSRSTAT                                         0260 01044000
*   /*****************************************************************/ 01045000
*   /*                                                               */ 01046000
*   /* CHECK IF ERROR ENCOUNTERED, IF SO THEN EXIT                   */ 01047000
*   /*                                                               */ 01048000
*   /*****************************************************************/ 01049000
*                                                                  0261 01050000
*   IF RC^=0 THEN                                                  0261 01051000
         ICM   @14,15,RC                                           0261 01052000
         BNZ   @RT00261                                            0261 01053000
*     GO TO EXTVSOFF;               /* EXIT ROUTINE                  */ 01054000
*                                                                  0262 01055000
*   /*****************************************************************/ 01056000
*   /*                                                               */ 01057000
*   /* TEST IF ALL PAGES ALREADY OFFLINE                             */ 01058000
*   /*                                                               */ 01059000
*   /*****************************************************************/ 01060000
*                                                                  0263 01061000
*   ALRDOFF='1'B;                   /* ASSUME ALREADY OFFLINE        */ 01062000
*                                                                  0263 01063000
         OI    ALRDOFF,B'01000000'                                 0263 01064000
*   /*****************************************************************/ 01065000
*   /*                                                               */ 01066000
*   /* TEST OFFLINE STATUS OF EACH PAGE BY CHECKING EACH STATUS BYTE */ 01067000
*   /* IN RSR WORKAREA                                               */ 01068000
*   /*                                                               */ 01069000
*   /*****************************************************************/ 01070000
*                                                                  0264 01071000
*   DO RSRSTATP=RSRSLP TO RSRSLP+RSRFRCT-1;                        0264 01072000
*                                                                  0264 01073000
         L     @14,RSRWAP                                          0264 01074000
         L     @14,RSRSLP(,@14)                                    0264 01075000
         B     @DE00264                                            0264 01076000
@DL00264 DS    0H                                                  0265 01077000
*     /***************************************************************/ 01078000
*     /*                                                             */ 01079000
*     /* CLEAR ALREADY OFFLINE IF ONLINE OR SCHED OFFLINE            */ 01080000
*     /*                                                             */ 01081000
*     /***************************************************************/ 01082000
*                                                                  0265 01083000
*     IF(POFFLN='0'B)|(PINTRCP='1'B) THEN                          0265 01084000
         TM    PINTRCP(@14),B'01000000'                            0265 01085000
         BNZ   @RT00265                                            0265 01086000
         TM    POFFLN(@14),B'10000000'                             0265 01087000
         BO    @RF00265                                            0265 01088000
@RT00265 DS    0H                                                  0266 01089000
*       ALRDOFF='0'B;                                              0266 01090000
         NI    ALRDOFF,B'10111111'                                 0266 01091000
*   END;                                                           0267 01092000
*                                                                  0267 01093000
@RF00265 LA    @14,1                                               0267 01094000
         AL    @14,RSRSTATP                                        0267 01095000
@DE00264 ST    @14,RSRSTATP                                        0267 01096000
         L     @09,RSRWAP                                          0267 01097000
         SLR   @08,@08                                             0267 01098000
         ICM   @08,3,RSRFRCT(@09)                                  0267 01099000
         L     @09,RSRWAP                                          0267 01100000
         AL    @08,RSRSLP(,@09)                                    0267 01101000
         BCTR  @08,0                                               0267 01102000
         CR    @14,@08                                             0267 01103000
         BNH   @DL00264                                            0267 01104000
*   /*****************************************************************/ 01105000
*   /*                                                               */ 01106000
*   /* CHECK IF ALL STORAGE ALREADY OFFLINE IF SO THEN JUST WRITE    */ 01107000
*   /* OFFLINE MESSAGE AND EXIT                                      */ 01108000
*   /*                                                               */ 01109000
*   /*****************************************************************/ 01110000
*                                                                  0268 01111000
*   IF ALRDOFF='1'B THEN                                           0268 01112000
         TM    ALRDOFF,B'01000000'                                 0268 01113000
         BNO   @RF00268                                            0268 01114000
*     DO;                                                          0269 01115000
*       CALL WTORTN(2);             /* OFFLINE MESSAGE               */ 01116000
         LA    @01,@AL00270                                        0270 01117000
         BAL   @14,WTORTN                                          0270 01118000
*       GO TO EXTVSOFF;             /* EXIT ROUTINE                  */ 01119000
         B     EXTVSOFF                                            0271 01120000
*     END;                                                         0272 01121000
*                                                                  0272 01122000
*   /*****************************************************************/ 01123000
*   /*                                                               */ 01124000
*   /* ALL PAGES NOT ALREADY OFFLINE. SET UP AND ISSUE OFFLINE CALL  */ 01125000
*   /* TO RSR                                                        */ 01126000
*   /*                                                               */ 01127000
*   /*****************************************************************/ 01128000
*                                                                  0273 01129000
*   RSRSTUS='0'B;                   /* CLEAR STATUS REQUEST          */ 01130000
@RF00268 DS    0H                                                  0274 01131000
*   RSROFFLN='1'B;                  /* SET OFFLINE REQUEST           */ 01132000
         L     @14,RSRWAP                                          0274 01133000
         OI    RSROFFLN(@14),B'01000000'                           0274 01134000
         NI    RSRSTUS(@14),B'11110111'                            0274 01135000
*   RSRAECB=ADDR(RSRECB);           /* SET @ OF ECB FOR RSR          */ 01136000
         LA    @09,RSRECB(,@14)                                    0275 01137000
         ST    @09,RSRAECB(,@14)                                   0275 01138000
*   DO RSRSTATP=RSRSLP TO RSRSLP+RSRFRCT-1;                        0276 01139000
         L     @14,RSRSLP(,@14)                                    0276 01140000
         B     @DE00276                                            0276 01141000
@DL00276 DS    0H                                                  0277 01142000
*     RSRSTAT2=RSRSTAT2&&RSRSTAT2;  /* ZERO RSR STATUS BUFFER        */ 01143000
         XC    RSRSTAT2(1,@14),RSRSTAT2(@14)                       0277 01144000
*   END;                                                           0278 01145000
         AH    @14,@CH00066                                        0278 01146000
@DE00276 ST    @14,RSRSTATP                                        0278 01147000
         L     @09,RSRWAP                                          0278 01148000
         SLR   @08,@08                                             0278 01149000
         ICM   @08,3,RSRFRCT(@09)                                  0278 01150000
         L     @09,RSRWAP                                          0278 01151000
         AL    @08,RSRSLP(,@09)                                    0278 01152000
         BCTR  @08,0                                               0278 01153000
         CR    @14,@08                                             0278 01154000
         BNH   @DL00276                                            0278 01155000
*   R1=RSRWAP;                      /* SET @ RSR PARM LIST           */ 01156000
*                                                                  0279 01157000
         L     R1,RSRWAP                                           0279 01158000
*   /*****************************************************************/ 01159000
*   /*                                                               */ 01160000
*   /* CALL RSR TO PLACE STORAGE OFFLINE                             */ 01161000
*   /*                                                               */ 01162000
*   /*****************************************************************/ 01163000
*                                                                  0280 01164000
*   CALL RSR;                                                      0280 01165000
*                                                                  0280 01166000
         L     @14,CVTPTR                                          0280 01167000
         L     @14,PVTPTR(,@14)                                    0280 01168000
         L     @15,PVTPRCF(,@14)                                   0280 01169000
         BALR  @14,@15                                             0280 01170000
*   /*****************************************************************/ 01171000
*   /*                                                               */ 01172000
*   /* EXAMINE RETURN CODE IN REG 15 AND DO APPROPIATE PROCESSING    */ 01173000
*   /*                                                               */ 01174000
*   /*****************************************************************/ 01175000
*                                                                  0281 01176000
*   IF R15=0 THEN                                                  0281 01177000
*                                                                  0281 01178000
         LTR   R15,R15                                             0281 01179000
         BNZ   @RF00281                                            0281 01180000
*     /***************************************************************/ 01181000
*     /*                                                             */ 01182000
*     /* R15 =0. OFFLINE SUCCESSFUL, PROCESS OFFLINE STORAGE         */ 01183000
*     /*                                                             */ 01184000
*     /***************************************************************/ 01185000
*                                                                  0282 01186000
*     CALL PROCOFF;                                                0282 01187000
*                                                                  0282 01188000
         BAL   @14,PROCOFF                                         0282 01189000
*   /*****************************************************************/ 01190000
*   /*                                                               */ 01191000
*   /* NO, TEST IF R15=4                                             */ 01192000
*   /*                                                               */ 01193000
*   /*****************************************************************/ 01194000
*                                                                  0283 01195000
*   ELSE                                                           0283 01196000
*     IF R15=4 THEN                 /* R15=4?                        */ 01197000
*                                                                  0283 01198000
         B     @RC00281                                            0283 01199000
@RF00281 CH    R15,@CH00165                                        0283 01200000
         BNE   @RF00283                                            0283 01201000
*       /*************************************************************/ 01202000
*       /*                                                           */ 01203000
*       /* STORAGE SUCCESSFULLY SCHEDULED TO GO OFFLINE BUT ALL PAGES*/ 01204000
*       /* HAVE NOT BEEN PLACED OFFLINE YET                          */ 01205000
*       /*                                                           */ 01206000
*       /*************************************************************/ 01207000
*                                                                  0284 01208000
*       DO;                                                        0284 01209000
*         LOOPCNT=0;                /* RESET LOOP CONTROL    @ZA02972*/ 01210000
*                                                                  0285 01211000
         SLR   LOOPCNT,LOOPCNT                                     0285 01212000
*         /***********************************************************/ 01213000
*         /*                                                         */ 01214000
*         /* CALL FORCE OFFLINE ROUTINE TO TRY TO FORCE ALL PENDING  */ 01215000
*         /* PAGES IN RANGE OFFLINE.                                 */ 01216000
*         /*                                                         */ 01217000
*         /***********************************************************/ 01218000
*                                                                  0286 01219000
*TRYFORCE:                                                         0286 01220000
*         CALL FORCEOFF;            /*                       @ZA02972*/ 01221000
*                                                                  0286 01222000
TRYFORCE BAL   @14,FORCEOFF                                        0286 01223000
*         /***********************************************************/ 01224000
*         /*                                                         */ 01225000
*         /* WAIT 1 SECONDS FOR PROCESSING TO COMPLETE.              */ 01226000
*         /*                                                         */ 01227000
*         /***********************************************************/ 01228000
*                                                                  0287 01229000
*         GEN(STIMER WAIT,DINTVL=WAITTIME);/* GIVE RSR 1 SECONDS TO     01230000
*                                      TO COMPLETE                   */ 01231000
*                                                                  0287 01232000
         STIMER WAIT,DINTVL=WAITTIME                                    01233000
*         /***********************************************************/ 01234000
*         /*                                                         */ 01235000
*         /* IF RSR HAS NOT COMPLETED YET THEN ISSUE MESSAGE TO      */ 01236000
*         /* OPERATOR AFTER 5 TIMES, AND RETRY FORCE OFF EACH SECOND */ 01237000
*         /* UNTILL CANCELED OR SUCCESSFUL                           */ 01238000
*         /*                                                         */ 01239000
*         /***********************************************************/ 01240000
*                                                                  0288 01241000
*         IF RSRPOST='0'B THEN                                     0288 01242000
         L     @14,RSRWAP                                          0288 01243000
         TM    RSRPOST(@14),B'01000000'                            0288 01244000
         BNZ   @RF00288                                            0288 01245000
*           DO;                                                    0289 01246000
*             LOOPCNT=LOOPCNT+1;    /* INCREMENT LOOP COUNTER      0290 01247000
*                                                            @ZA02972*/ 01248000
         AH    LOOPCNT,@CH00066                                    0290 01249000
*             IF LOOPCNT=5 THEN     /* TIME TO WRITE MESSAGE YET?  0291 01250000
*                                                            @ZA02972*/ 01251000
         CH    LOOPCNT,@CH01117                                    0291 01252000
         BNE   @RF00291                                            0291 01253000
*               DO;                                                0292 01254000
*                 CALL STORSMF;     /* PUT OUT OFFLINE MSG   @ZA00801*/ 01255000
         BAL   @14,STORSMF                                         0293 01256000
*                 OFFDONE='1'B;     /* SIGNAL SMF RECORD WRITTEN   0294 01257000
*                                                            @ZA00801*/ 01258000
         OI    OFFDONE,B'00000010'                                 0294 01259000
*                 CALL WTORTN(5);   /* PEND OFFLINE MSG              */ 01260000
         LA    @01,@AL00295                                        0295 01261000
         BAL   @14,WTORTN                                          0295 01262000
*               END;                /*                       @ZA02972*/ 01263000
*                                                                  0296 01264000
*             /*******************************************************/ 01265000
*             /*                                                     */ 01266000
*             /* WAIT FOR RSR TO COMPLETE OR BE OVERRIDDEN           */ 01267000
*             /*                                                     */ 01268000
*             /*******************************************************/ 01269000
*                                                                  0297 01270000
*             GOTO TRYFORCE;        /* GO RETRY FORCE OFF ROUTINE  0297 01271000
*                                                            @ZA02972*/ 01272000
         B     TRYFORCE                                            0297 01273000
*           END;                                                   0298 01274000
*                                                                  0298 01275000
*         /***********************************************************/ 01276000
*         /*                                                         */ 01277000
*         /* CHECK WHY RSR HAS POSTED THE COMMAND PROCESSOR. POSTCODE*/ 01278000
*         /* OF 0 MEANS ALL PAGES HAVE BEEN PLACED OFFLINE           */ 01279000
*         /* SUCCESSFULLY. POSTCODE OF 4 MEANS A SUBSEQUENT ONLINE   */ 01280000
*         /* WITH PERFECT OVERLAP HAS OVERRIDEN OFFLINE REQUEST      */ 01281000
*         /*                                                         */ 01282000
*         /***********************************************************/ 01283000
*                                                                  0299 01284000
*         IF RSRPCODE=0 THEN                                       0299 01285000
*                                                                  0299 01286000
@RF00288 L     @14,RSRWAP                                          0299 01287000
         ICM   @09,7,RSRPCODE(@14)                                 0299 01288000
         BNZ   @RF00299                                            0299 01289000
*           /*********************************************************/ 01290000
*           /*                                                       */ 01291000
*           /* ALL PAGES PLACED OFFLINE SUCCESSFULLY                 */ 01292000
*           /*                                                       */ 01293000
*           /*********************************************************/ 01294000
*                                                                  0300 01295000
*           CALL PROCOFF;                                          0300 01296000
*                                                                  0300 01297000
         BAL   @14,PROCOFF                                         0300 01298000
*         /***********************************************************/ 01299000
*         /*                                                         */ 01300000
*         /* OFFLINE REQUEST OVERRIDDEN BY SUBSEQUENT ONLINE REQUEST */ 01301000
*         /*                                                         */ 01302000
*         /***********************************************************/ 01303000
*                                                                  0301 01304000
*         ELSE                                                     0301 01305000
*           DO;                                                    0301 01306000
         B     @RC00299                                            0301 01307000
@RF00299 DS    0H                                                  0302 01308000
*             CALL WTORTN(11);      /* OVERRIDDEN MESSAGE            */ 01309000
         LA    @01,@AL00302                                        0302 01310000
         BAL   @14,WTORTN                                          0302 01311000
*           END;                                                   0303 01312000
*       END;                                                       0304 01313000
*                                                                  0304 01314000
*   /*****************************************************************/ 01315000
*   /*                                                               */ 01316000
*   /* TEST IF RSR RETURNED WITH R15=8                               */ 01317000
*   /*                                                               */ 01318000
*   /*****************************************************************/ 01319000
*                                                                  0305 01320000
*     ELSE                                                         0305 01321000
*       IF R15=8 THEN               /* R15=8?                        */ 01322000
*                                                                  0305 01323000
         B     @RC00283                                            0305 01324000
@RF00283 CH    R15,@CH00058                                        0305 01325000
         BNE   @RF00305                                            0305 01326000
*         /***********************************************************/ 01327000
*         /*                                                         */ 01328000
*         /* OFFLINE RANGE OVERLAPS PERMANENTLY RESIDENT STORAGE     */ 01329000
*         /*                                                         */ 01330000
*         /***********************************************************/ 01331000
*                                                                  0306 01332000
*         CALL WTORTN(10);          /* PERM RESIDENT STOR ERROR      */ 01333000
*                                                                  0306 01334000
         LA    @01,@AL00306                                        0306 01335000
         BAL   @14,WTORTN                                          0306 01336000
*   /*****************************************************************/ 01337000
*   /*                                                               */ 01338000
*   /* NO, TEST IF RSR RETURNED WITH R15=16                          */ 01339000
*   /*                                                               */ 01340000
*   /*****************************************************************/ 01341000
*                                                                  0307 01342000
*       ELSE                                                       0307 01343000
*         IF R15=16 THEN            /* R15=16?                       */ 01344000
*                                                                  0307 01345000
         B     @RC00305                                            0307 01346000
@RF00305 CH    R15,@CH00064                                        0307 01347000
         BNE   @RF00307                                            0307 01348000
*           /*********************************************************/ 01349000
*           /*                                                       */ 01350000
*           /* OFFLINE REQUEST CAUSES INVALID OVERLAP                */ 01351000
*           /*                                                       */ 01352000
*           /*********************************************************/ 01353000
*                                                                  0308 01354000
*           CALL WTORTN(3);         /* INVALID OVERLAP MSG           */ 01355000
*                                                                  0308 01356000
         LA    @01,@AL00308                                        0308 01357000
         BAL   @14,WTORTN                                          0308 01358000
*   /*****************************************************************/ 01359000
*   /*                                                               */ 01360000
*   /* BAD RETURN CODE FROM RSR. ABEND THRU ESTAE EXIT               */ 01361000
*   /*                                                               */ 01362000
*   /*****************************************************************/ 01363000
*                                                                  0309 01364000
*         ELSE                                                     0309 01365000
*           DO;                                                    0309 01366000
         B     @RC00307                                            0309 01367000
@RF00307 DS    0H                                                  0310 01368000
*             INTERROR=R15;         /* SET INTERNAL ERROR CODE       */ 01369000
         ST    R15,INTERROR                                        0310 01370000
*             DO;                   /* ABEND(183) SYSTEM             */ 01371000
*               RESPECIFY                                          0312 01372000
*                (GPR01F) RESTRICTED;                              0312 01373000
*               GPR01F=((183)&'00000FFF'X)*4096;/* COMP CODE IN BITS    01374000
*                                      8-19                          */ 01375000
         L     GPR01F,@CF02885                                     0313 01376000
*               SVC(13);            /* ISSUE ABEND SVC               */ 01377000
         SVC   13                                                  0314 01378000
*               RESPECIFY                                          0315 01379000
*                (GPR01F) UNRESTRICTED;                            0315 01380000
*             END;                  /* ABEND(183) SYSTEM ABEND     0316 01381000
*                                      COMMAND PROCESSOR     @YM03534*/ 01382000
*           END;                                                   0317 01383000
*                                                                  0317 01384000
*   /*****************************************************************/ 01385000
*   /*                                                               */ 01386000
*   /* RETURN TO MAINLINE                                            */ 01387000
*   /*                                                               */ 01388000
*   /*****************************************************************/ 01389000
*                                                                  0318 01390000
*EXTVSOFF:                                                         0318 01391000
*   RETURN;                                                        0318 01392000
@EL00006 DS    0H                                                  0318 01393000
@EF00006 DS    0H                                                  0318 01394000
@ER00006 LM    @14,@12,@SA00006                                    0318 01395000
         BR    @14                                                 0318 01396000
*                                                                  0319 01397000
*/*        FORCE PAGES OFFLINE ROUTINE                               */ 01398000
*/*                                                                  */ 01399000
*/*    THIS ROUTINE WILL BE CALLED WHEN A RANGE OF STORAGE FAILS     */ 01400000
*/* TO GO OFFLINE IMMEDIATELY AFTER CALLING RSR.  THE ROUTINE WILL   */ 01401000
*/* ATTEMPT TO FORCE OFFLINE EACH PAGE IN THE RANGE WHICH IS STILL   */ 01402000
*/* WAITING TO BE RELEASED BY A USER BY EITHER ISSUING A PGOUT FOR   */ 01403000
*/* THAT PAGE OR TRYING TO SWAP OUT THE OWNER'S ENTIRE ADDRESS SPACE */ 01404000
*/*    THERE IS NO GUARENTEE THAT ALL THE PENDING PAGES IN THE RANGE */ 01405000
*/* WILL BE FORCED OFFLINE SUCESSFULLY, BUT THIS ROUTINE IS DESIGNED */ 01406000
*/* TO EXPEDIATE THE PROCESSING AND INCREASE THE PROBABILITY THAT A  */ 01407000
*/* GIVEN STORAGE RANGE WILL BE VARIED OFFLINE SUCCESSFULLY.         */ 01408000
*/*                                                                  */ 01409000
*                                                                  0319 01410000
*FORCEOFF:                                                         0319 01411000
*   PROC;                                                          0319 01412000
*                                                                  0319 01413000
FORCEOFF STM   @14,@12,@SA00007                                    0319 01414000
*   /*****************************************************************/ 01415000
*   /*                                                               */ 01416000
*   /* FUNCTION FLAGS                                                */ 01417000
*   /*                                                               */ 01418000
*   /*****************************************************************/ 01419000
*                                                                  0320 01420000
*   DCL                                                            0320 01421000
*     1 FOFFFLAG BIT(8),                                           0320 01422000
*      2 INLOOP BIT(1),             /* IN PROCESS LOOP, SCHEDULE   0320 01423000
*                                      RETRY AT NEXTPAGE             */ 01424000
*      2 PGFIXFLG BIT(1);           /* CODE FOR SUBROUTINE FIXED     */ 01425000
*                                                                  0320 01426000
*   /*****************************************************************/ 01427000
*   /*                                                               */ 01428000
*   /* START AND END SDDRESS OF RSR STATUS MAP                       */ 01429000
*   /*                                                               */ 01430000
*   /*****************************************************************/ 01431000
*                                                                  0321 01432000
*   DCL                                                            0321 01433000
*     1 MAPBOUND,                                                  0321 01434000
*      2 STRTRNGE FIXED,            /* START OF MAP                  */ 01435000
*      2 ENDRNGE FIXED;             /* END OF MAP                    */ 01436000
*   DCL                                                            0322 01437000
*     CNVTRLVT LABEL BASED(CVTPTRV);/* ADDR OF CONVERT REAL TO     0322 01438000
*                                      VIRTUAL ROUTINE               */ 01439000
*   DCL                                                            0323 01440000
*     MYTCB PTR BASED(CVTTCBP+4);   /* VALUE OF MY TCB ADDR          */ 01441000
*                                                                  0323 01442000
*   /*****************************************************************/ 01443000
*   /*                                                               */ 01444000
*   /* REGISTER UPDATE BLOCK FOR RETRY FROM ESTAE                    */ 01445000
*   /*                                                               */ 01446000
*   /*****************************************************************/ 01447000
*                                                                  0324 01448000
*   DCL                                                            0324 01449000
*     1 RUBWA BDY(WORD),                                           0324 01450000
*      2 * CHAR(2),                 /* FORCE PROPER ALIGNMENT        */ 01451000
*      2 RUBSA,                     /* REGISTER UPDATE BLOCK         */ 01452000
*       3 RREGSFLG CHAR(2),         /* RETRY FLAGS                   */ 01453000
*       3 RREGSSA CHAR(64);         /* REGISTER SAVE AREA            */ 01454000
*                                                                  0324 01455000
*   /*****************************************************************/ 01456000
*   /*                                                               */ 01457000
*   /* MAP OF VARIABLES IN SQA WORKAREA                              */ 01458000
*   /*                                                               */ 01459000
*   /*****************************************************************/ 01460000
*                                                                  0325 01461000
*   DCL                                                            0325 01462000
*     1 WASQA BASED(R9),            /* MAP OF WORKAREA IN SQA        */ 01463000
*      2 SRBBUFR CHAR(LENGTH(SRBSECT)),/* BUFFER FOR SRB C B         */ 01464000
*      2 XEPARML,                   /* LOCAL ESTAE PARM LIST         */ 01465000
*       3 XDATARG1 PTR,             /* DATA REG 1                    */ 01466000
*       3 XDATARG2 PTR,             /* DATA REG 2                    */ 01467000
*       3 XCODERG1 PTR,             /* CODE REG 1                    */ 01468000
*       3 XCODERG2 PTR,             /* CODE REG 2                    */ 01469000
*      2 PGFIXECB PTR,              /* PAGE FIX ECB                  */ 01470000
*       3 FIXPCODE PTR(24),         /* PGFIX POST CODE               */ 01471000
*      2 ASID FIXED(15),            /* TARGET MEMORY ASID            */ 01472000
*      2 VSL,                       /* VSL FOR PGOUT CALL            */ 01473000
*       3 VSLFLG1 BIT(8),           /* FLAG BYTE 1                   */ 01474000
*       3 VIRTADDR PTR(24),         /* VIRT ADDR OF TARGET PAGE      */ 01475000
*       3 VSLFLG2 BIT(8),           /* FLAG BYTE 2                   */ 01476000
*       3 ENDVADDR PTR(24),         /* END VIRT ADDR                 */ 01477000
*      2 ASCBP PTR,                 /* ADDR OF TARGET MEMORY ASCB    */ 01478000
*      2 SRBEXRTN PTR,              /* ADDR OF SRB EXIT ROUTINE      */ 01479000
*      2 RSCMEXRP PTR,              /* ADDR OF RESOURCE MANGER RETURN   01480000
*                                      POINT                         */ 01481000
*      2 SRBECB FIXED(31),          /* SRB ECB                       */ 01482000
*      2 SRBCREG PTR,               /* CODE REG FOR SRB RTN          */ 01483000
*      2 RSCMCRG PTR,               /* CODE REG FOR RESOURCE MANAGER    01484000
*                                      ROUTINE                       */ 01485000
*      2 HOBIT BIT(8),              /* VARIABLE TO SET HIGH ORDER BIT   01486000
*                                      FOR XMPOST                    */ 01487000
*      2 SQAFLAGS BIT(8),           /* FIXED FLAGS                   */ 01488000
*       3 RTCAOK BIT(1);            /* GOOD RTCA AVAILABLE FOR LOCAL    01489000
*                                      ESTAE ROUTINE                 */ 01490000
*   DCL                                                            0326 01491000
*     STRTPGA LABEL BASED(VIRTADDR),/* START ADDR OF 4K PAGE         */ 01492000
*     ENDPGA LABEL BASED(VIRTADDR+4095);/* END ADDR OF PAGE  @ZA11347*/ 01493000
*                                                                  0326 01494000
*   /*****************************************************************/ 01495000
*   /*                                                               */ 01496000
*   /* START OF FORCE OFFLINE SUBROUTINE CODE                        */ 01497000
*   /*                                                               */ 01498000
*   /*****************************************************************/ 01499000
*                                                                  0327 01500000
*   RFY                                                            0327 01501000
*    (R2,                                                          0327 01502000
*     R3,                                                          0327 01503000
*     R4,                                                          0327 01504000
*     R9) RSTD;                                                    0327 01505000
*   RFY                                                            0328 01506000
*     ASCB BASED(ASCBP);                                           0328 01507000
*                                                                  0328 01508000
*   /*****************************************************************/ 01509000
*   /*                                                               */ 01510000
*   /* GET SPACE IN SQA FOR VARIABLES WHICH ARE REQUIRED TO BE FIXED */ 01511000
*   /* AND COMMONLY ADDRESSABLE TO ALL MEMORIES                      */ 01512000
*   /*                                                               */ 01513000
*   /*****************************************************************/ 01514000
*                                                                  0329 01515000
*STRTFXCD:                                                         0329 01516000
*   DO;                             /* GETMAIN (RC) LV(LENGTH(WASQA))   01517000
*                                      SP(245)                       */ 01518000
STRTFXCD DS    0H                                                  0330 01519000
*     RESPECIFY                                                    0330 01520000
*      (GPR01F,                                                    0330 01521000
*       GPR15F,                                                    0330 01522000
*       GPR00F) RESTRICTED;                                        0330 01523000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 01524000
         SLR   GPR01F,GPR01F                                       0331 01525000
*     GPR15F=0;                     /* RC-TYPE GETMAIN               */ 01526000
         SLR   GPR15F,GPR15F                                       0332 01527000
*     GPR00F=LENGTH(WASQA);         /* LENGTH REQUESTED              */ 01528000
         LA    GPR00F,102                                          0333 01529000
*     GPR15F=GPR15F|((245)*256);    /* SP IN BYTE 2                  */ 01530000
         O     GPR15F,@CF02887                                     0334 01531000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 01532000
         SVC   120                                                 0335 01533000
*     RESPECIFY                                                    0336 01534000
*      (GPR01F,                                                    0336 01535000
*       GPR15F,                                                    0336 01536000
*       GPR00F) UNRESTRICTED;                                      0336 01537000
*   END;                            /* GETMAIN (RC) LV(LENGTH(WASQA))   01538000
*                                      SP(245)                       */ 01539000
*                                                                  0337 01540000
*   /*****************************************************************/ 01541000
*   /*                                                               */ 01542000
*   /* TEST IF GETMAIN FAILED                                        */ 01543000
*   /*                                                               */ 01544000
*   /*****************************************************************/ 01545000
*                                                                  0338 01546000
*   IF R15^=0 THEN                                                 0338 01547000
         LTR   R15,R15                                             0338 01548000
         BNZ   @RT00338                                            0338 01549000
*     GO TO EXITFOFF;               /* EXIT ROUTINE IF FAILED        */ 01550000
*   R9=R1;                          /* SET ADDRESSIBILITY TO WORKAREA*/ 01551000
*                                                                  0340 01552000
         LR    R9,R1                                               0340 01553000
*   /*****************************************************************/ 01554000
*   /*                                                               */ 01555000
*   /* SET UP LOCAL ESTAE ENVIRONMENT                                */ 01556000
*   /*                                                               */ 01557000
*   /*****************************************************************/ 01558000
*                                                                  0341 01559000
*   INLOOP='0'B;                    /* INDICATE NOT IN PAGE LOOP     */ 01560000
*   PGFIXFLG='0'B;                  /* CLEAR PAGE FIX FLAG           */ 01561000
         NI    INLOOP,B'00111111'                                  0342 01562000
*   XDATARG1=R10;                   /* PTR TO MAIN WA                */ 01563000
         ST    R10,XDATARG1(,R9)                                   0343 01564000
*   XDATARG2=R9;                    /* PTR TO WA IN SQA              */ 01565000
         ST    R9,XDATARG2(,R9)                                    0344 01566000
*   XCODERG1=R11;                   /* FIRST CODE REG                */ 01567000
         ST    R11,XCODERG1(,R9)                                   0345 01568000
*   XCODERG2=R12;                   /* SECOND CODE REG               */ 01569000
         ST    R12,XCODERG2(,R9)                                   0346 01570000
*   R2=ADDR(XEPARML);               /* SET PTR TO PARM LIST          */ 01571000
         LA    R2,XEPARML(,R9)                                     0347 01572000
*   ESTLIST=''B;                    /* ZERO CONTROL BLOCK            */ 01573000
         XC    ESTLIST(16),ESTLIST                                 0348 01574000
*   R1=ADDR(ESTLIST);               /* SET PTR TO C B                */ 01575000
         LA    R1,ESTLIST                                          0349 01576000
*   GEN(ESTAE LESTAE,PARAM=(2),MF=(E,(1)));/* SET ESTAE ENVIRN.      */ 01577000
*                                                                  0350 01578000
         ESTAE LESTAE,PARAM=(2),MF=(E,(1))                              01579000
*   /*****************************************************************/ 01580000
*   /*                                                               */ 01581000
*   /* TEST IF ESTAE FAILED                                          */ 01582000
*   /*                                                               */ 01583000
*   /*****************************************************************/ 01584000
*                                                                  0351 01585000
*   IF R15^=0 THEN                                                 0351 01586000
         SLR   @14,@14                                             0351 01587000
         CR    R15,@14                                             0351 01588000
         BNE   @RT00351                                            0351 01589000
*     GO TO FREESQA;                /* EXIT ROUTINE IF FAILED        */ 01590000
*                                                                  0352 01591000
*   /*****************************************************************/ 01592000
*   /*                                                               */ 01593000
*   /* FIX SUBROUTINE CODE. CAN NOT TOLERATE PAGE FAULTS WHILE       */ 01594000
*   /* HOLDING DISP LOCK WHEN TRYING TO SCHEDULE AN SRB ROUTINE      */ 01595000
*   /*                                                               */ 01596000
*   /*****************************************************************/ 01597000
*                                                                  0353 01598000
*   PGFIXECB=0;                     /* ZERO PGFIX ECB                */ 01599000
         ST    @14,PGFIXECB(,R9)                                   0353 01600000
*   DO;                             /* PGFIX (R) A(STRTFXCD)       0354 01601000
*                                      EA(ENDFXCD) ECB(PGFIXECB)   0354 01602000
*                                      LONG(Y) RELEASE(N)            */ 01603000
*     RESPECIFY                                                    0355 01604000
*      (GPR00P,                                                    0355 01605000
*       GPR01P) RESTRICTED;                                        0355 01606000
*     GPR00P=ADDR(PGFIXECB);        /* ECB ADDR                      */ 01607000
         LA    GPR00P,PGFIXECB(,R9)                                0356 01608000
*     GPR01P=ADDR(STRTFXCD);        /* PAGE ADDR                     */ 01609000
         LA    GPR01P,STRTFXCD                                     0357 01610000
*     RESPECIFY                                                    0358 01611000
*       GPR15P RESTRICTED;                                         0358 01612000
*     GPR15P=ADDR(ENDFXCD);         /* VSL ADDR                      */ 01613000
         LA    GPR15P,ENDFXCD                                      0359 01614000
*     GPR01P=GPR01P|'52000000'X;    /* R, PGFIX, RELEASE & LONG FLAGS*/ 01615000
         O     GPR01P,@CF02569                                     0360 01616000
*     SVC(113);                     /* ISSUE PGFIX SVC               */ 01617000
         SVC   113                                                 0361 01618000
*     RESPECIFY                                                    0362 01619000
*      (GPR00P,                                                    0362 01620000
*       GPR01P) UNRESTRICTED;                                      0362 01621000
*     RESPECIFY                                                    0363 01622000
*       GPR15P UNRESTRICTED;                                       0363 01623000
*   END;                            /* PGFIX (R) A(STRTFXCD)       0364 01624000
*                                      EA(ENDFXCD) ECB(PGFIXECB)   0364 01625000
*                                      LONG(Y) RELEASE(N)    @YA00802*/ 01626000
*                                                                  0364 01627000
*   /*****************************************************************/ 01628000
*   /*                                                               */ 01629000
*   /* TEST IF PGFIX FAILED                                          */ 01630000
*   /*                                                               */ 01631000
*   /*****************************************************************/ 01632000
*                                                                  0365 01633000
*   IF^((R15=0)|(R15=8)) THEN                                      0365 01634000
         LTR   R15,R15                                             0365 01635000
         BZ    @RF00365                                            0365 01636000
         CH    R15,@CH00058                                        0365 01637000
         BNE   @RT00365                                            0365 01638000
*     GO TO CANCLLT;                /* PGFIX FAILED                  */ 01639000
*   IF R15=8 THEN                   /* PGFIX PENDING?                */ 01640000
@RF00365 CH    R15,@CH00058                                        0367 01641000
         BNE   @RF00367                                            0367 01642000
*     DO;                                                          0368 01643000
*       DO;                         /* WAIT (1) ECB(PGFIXECB)        */ 01644000
*         RESPECIFY                                                0370 01645000
*          (GPR00P,                                                0370 01646000
*           GPR01P) RESTRICTED;                                    0370 01647000
*         GPR00P=1;                 /* LOAD WAIT COUNT               */ 01648000
         LA    GPR00P,1                                            0371 01649000
*         GPR01P=ADDR(PGFIXECB);    /* ADDRESS OF ECB                */ 01650000
         LA    GPR01P,PGFIXECB(,R9)                                0372 01651000
*         SVC(1);                   /* WAIT SVC                      */ 01652000
         SVC   1                                                   0373 01653000
*         RESPECIFY                                                0374 01654000
*          (GPR00P,                                                0374 01655000
*           GPR01P) UNRESTRICTED;                                  0374 01656000
*       END;                        /* WAIT (1) ECB(PGFIXECB) WAIT 0375 01657000
*                                      FOR FIX                       */ 01658000
*                                                                  0375 01659000
*       /*************************************************************/ 01660000
*       /*                                                           */ 01661000
*       /* TEST PGFIX POSTCODE                                       */ 01662000
*       /*                                                           */ 01663000
*       /*************************************************************/ 01664000
*                                                                  0376 01665000
*       IF FIXPCODE=4 THEN                                         0376 01666000
         CLC   FIXPCODE(3,R9),@CF00165+1                           0376 01667000
         BE    @RT00376                                            0376 01668000
*         GO TO CANCLLT;            /* PGFIX FAILED EXIT             */ 01669000
*     END;                                                         0378 01670000
*   PGFIXFLG='1'B;                  /* SET PGFIX FLAG ON             */ 01671000
*                                                                  0379 01672000
@RF00367 OI    PGFIXFLG,B'01000000'                                0379 01673000
*   /*****************************************************************/ 01674000
*   /*                                                               */ 01675000
*   /* INITIALIZE VARIABLES TO PROCESS EACH PENDING OFFLINE PAGE IN  */ 01676000
*   /* STORAGE RANGE                                                 */ 01677000
*   /*                                                               */ 01678000
*   /*****************************************************************/ 01679000
*                                                                  0380 01680000
*   STRTRNGE=RSRSLP;                /* START OF RSR STATUS MAP       */ 01681000
         L     @14,RSRWAP                                          0380 01682000
         L     @08,RSRSLP(,@14)                                    0380 01683000
         ST    @08,STRTRNGE                                        0380 01684000
*   ENDRNGE=RSRSLP+RSRFRCT-1;       /* END OF RSR STATUS MAP         */ 01685000
         SLR   @05,@05                                             0381 01686000
         ICM   @05,3,RSRFRCT(@14)                                  0381 01687000
         ALR   @05,@08                                             0381 01688000
         BCTR  @05,0                                               0381 01689000
         ST    @05,ENDRNGE                                         0381 01690000
*   FRAMEPTR=SRANGE;                /* REAL ADDR OF FIRST PAGE IN  0382 01691000
*                                      RANGE                         */ 01692000
         MVC   FRAMEPTR(4),SRANGE                                  0382 01693000
*   RREGSFLG='FFFF'X;               /* SET RUB FLAGS                 */ 01694000
*                                                                  0383 01695000
         MVC   RREGSFLG(2),@CB02572                                0383 01696000
*   /*****************************************************************/ 01697000
*   /*                                                               */ 01698000
*   /* PROCESS EACH PENDING OFFLINE PAGE IN RANGE                    */ 01699000
*   /*                                                               */ 01700000
*   /*****************************************************************/ 01701000
*                                                                  0384 01702000
*   DO RSRSTATP=STRTRNGE TO ENDRNGE;                               0384 01703000
         B     @DE00384                                            0384 01704000
@DL00384 DS    0H                                                  0385 01705000
*     GEN(STM R0,R15,RREGSSA);      /* SAVE RETRY REGS               */ 01706000
         STM R0,R15,RREGSSA                                             01707000
*     INLOOP='1'B;                  /* INDICATE IN DO LOOP           */ 01708000
         OI    INLOOP,B'10000000'                                  0386 01709000
*     IF PINTRCP='1'B THEN          /* CHECK IF PENDING              */ 01710000
*                                                                  0387 01711000
         L     @14,RSRSTATP                                        0387 01712000
         TM    PINTRCP(@14),B'01000000'                            0387 01713000
         BNO   @RF00387                                            0387 01714000
*       /*************************************************************/ 01715000
*       /*                                                           */ 01716000
*       /* PROCESS PENDING OFFLINE PAGE                              */ 01717000
*       /*                                                           */ 01718000
*       /*************************************************************/ 01719000
*                                                                  0388 01720000
*       DO;                                                        0388 01721000
*         R1=FRAMEPTR;              /* SET REAL ADDR                 */ 01722000
         L     R1,FRAMEPTR                                         0389 01723000
*         CALL CNVTRLVT;            /* CONVERT REAL ADDR TO ASID OF     01724000
*                                      ITS MEMORY AND VIRTUAL ADDRESS*/ 01725000
*                                                                  0390 01726000
         L     @08,CVTPTR                                          0390 01727000
         L     @15,CVTPTRV(,@08)                                   0390 01728000
         BALR  @14,@15                                             0390 01729000
*         /***********************************************************/ 01730000
*         /*                                                         */ 01731000
*         /* TEST IF CONVERT ROUTINE FAILED                          */ 01732000
*         /*                                                         */ 01733000
*         /***********************************************************/ 01734000
*                                                                  0391 01735000
*         IF R15^=0 THEN                                           0391 01736000
         LTR   R15,R15                                             0391 01737000
         BNZ   @RT00391                                            0391 01738000
*           GO TO NEXTPAGE;         /* SKIP TO NEXT PAGE IF MAPPING     01739000
*                                      FAILED                        */ 01740000
*         ASID=R0;                  /* SAVE ASID OF TARGET MEMORY    */ 01741000
         STH   R0,ASID(,R9)                                        0393 01742000
*         VIRTADDR=R1;              /* SAVE VIRTUAL ADDR OF PAGE     */ 01743000
*                                                                  0394 01744000
         STCM  R1,7,VIRTADDR(R9)                                   0394 01745000
*         /***********************************************************/ 01746000
*         /*                                                         */ 01747000
*         /* COMPLETE PARAMTER LIST FOR PAGEOUT                      */ 01748000
*         /*                                                         */ 01749000
*         /***********************************************************/ 01750000
*                                                                  0395 01751000
*         VSLFLG1='00'X;            /* CLEAR HIGH ORDER BYTE         */ 01752000
         MVI   VSLFLG1(R9),X'00'                                   0395 01753000
*         VSLFLG2='04'X;            /* SET FUNCTION CODE             */ 01754000
         MVI   VSLFLG2(R9),X'04'                                   0396 01755000
*         ENDVADDR=VIRTADDR+4095;   /* SET END ADDRESS       @ZA03275*/ 01756000
*                                                                  0397 01757000
         SLR   @14,@14                                             0397 01758000
         ICM   @14,7,VIRTADDR(R9)                                  0397 01759000
         LA    @08,4095                                            0397 01760000
         ALR   @08,@14                                             0397 01761000
         STCM  @08,7,ENDVADDR(R9)                                  0397 01762000
*         /***********************************************************/ 01763000
*         /*                                                         */ 01764000
*         /* TEST IF PAGE IN COMMON ADDRESS SPACE.                   */ 01765000
*         /*                                                         */ 01766000
*         /***********************************************************/ 01767000
*                                                                  0398 01768000
*         IF ASID=-1 THEN                                          0398 01769000
*                                                                  0398 01770000
         LH    @05,ASID(,R9)                                       0398 01771000
         CH    @05,@CH02438                                        0398 01772000
         BNE   @RF00398                                            0398 01773000
*           /*********************************************************/ 01774000
*           /*                                                       */ 01775000
*           /* TRY TO PAGE OUT PAGE IN COMMON ADDRESS SPACE          */ 01776000
*           /*                                                       */ 01777000
*           /*********************************************************/ 01778000
*                                                                  0399 01779000
*           DO;                                                    0399 01780000
*             DO;                   /* PGOUT (R) A(STRTPGA)        0400 01781000
*                                      EA(ENDPGA)                    */ 01782000
*               RESPECIFY                                          0401 01783000
*                (GPR00P,                                          0401 01784000
*                 GPR01P) RESTRICTED;                              0401 01785000
*               GPR00P=0;           /* NO ECB REQUIRED BY PGOUT      */ 01786000
         SLR   GPR00P,GPR00P                                       0402 01787000
*               GPR01P=ADDR(STRTPGA);/* PAGE ADDR                    */ 01788000
         LR    GPR01P,@14                                          0403 01789000
*               RESPECIFY                                          0404 01790000
*                 GPR15P RESTRICTED;                               0404 01791000
*               GPR15P=ADDR(ENDPGA);/* VSL ADDR                      */ 01792000
         LR    GPR15P,@08                                          0405 01793000
*               GPR15P=GPR15P|'04000000'X;/* PGOUT & KEEPREAL FLAG   */ 01794000
         O     GPR15P,@CF02576                                     0406 01795000
*               SVC(113);           /* ISSUE PGOUT SVC               */ 01796000
         SVC   113                                                 0407 01797000
*               RESPECIFY                                          0408 01798000
*                (GPR00P,                                          0408 01799000
*                 GPR01P,                                          0408 01800000
*                 GPR15P) UNRESTRICTED;                            0408 01801000
*             END;                  /* PGOUT(R) A(STRTPGA) EA(ENDPGA)*/ 01802000
*                                                                  0409 01803000
*             /*******************************************************/ 01804000
*             /*                                                     */ 01805000
*             /* GO PROCESS NEXT PAGE. IF PGOUT FAILED THERE IS      */ 01806000
*             /* NOTHING MORE WE CAN DO FOR THIS PAGE                */ 01807000
*             /*                                                     */ 01808000
*             /*******************************************************/ 01809000
*                                                                  0410 01810000
*           END;                                                   0410 01811000
*                                                                  0410 01812000
*         /***********************************************************/ 01813000
*         /*                                                         */ 01814000
*         /* PAGE IN LOCAL ADDRESS SPACE. TRY TO SWAP OUT ENTIRE     */ 01815000
*         /* ADDRESS SPACE                                           */ 01816000
*         /*                                                         */ 01817000
*         /***********************************************************/ 01818000
*                                                                  0411 01819000
*         ELSE                                                     0411 01820000
*           DO;                                                    0411 01821000
         B     @RC00398                                            0411 01822000
@RF00398 DS    0H                                                  0412 01823000
*             R1=0;                 /* ZERO ECB ADDR         @YM03531*/ 01824000
         SLR   R1,R1                                               0412 01825000
*             R2=ASID;              /* SET ASID OF ADDRESS SPACE     */ 01826000
         LH    R2,ASID(,R9)                                        0413 01827000
*             GEN(SYSEVENT REQSWAP,ASID=(R2));/* CALL OPTIMIZER      */ 01828000
         SYSEVENT REQSWAP,ASID=(R2)                                     01829000
*             IF R1=4 THEN          /* TEST IF MEMORY NON-SWAPPABLE  */ 01830000
*                                                                  0415 01831000
         LA    @14,4                                               0415 01832000
         CR    R1,@14                                              0415 01833000
         BNE   @RF00415                                            0415 01834000
*               /*****************************************************/ 01835000
*               /*                                                   */ 01836000
*               /* MEMORY IS NON-SWAPPABLE. TEST IF VALID ASCB       */ 01837000
*               /* ADDRESS, IF SO THEN SCHEDULE SRB ROUTINE TO RUN IN*/ 01838000
*               /* MEMORY OF THIS PAGE AND ISSUE PGOUT FOR THIS PAGE */ 01839000
*               /*                                                   */ 01840000
*               /*****************************************************/ 01841000
*                                                                  0416 01842000
*               DO;                                                0416 01843000
*                                                                  0416 01844000
*                 /***************************************************/ 01845000
*                 /*                                                 */ 01846000
*                 /* CONSTRUCT SRB CONRTOL BLOCK                     */ 01847000
*                 /*                                                 */ 01848000
*                 /***************************************************/ 01849000
*                                                                  0417 01850000
*                 RFY                                              0417 01851000
*                   SRBSECT BASED(R8);                             0417 01852000
*                 RFY                                              0418 01853000
*                   R8 RSTD;                                       0418 01854000
*                 R8=ADDR(SRBBUFR); /* SET ADDR TO SRB CB            */ 01855000
         LR    R8,R9                                               0419 01856000
*                 SRB=''B;          /* ZERO SRB                      */ 01857000
         XC    SRB(44,R8),SRB(R8)                                  0420 01858000
*                 SRBEP=ADDR(SRBRTN);/* ENTRY POINT SRB ROUTINE      */ 01859000
         LA    @05,SRBRTN                                          0421 01860000
         ST    @05,SRBEP(,R8)                                      0421 01861000
*                 SRBPARM=ADDR(WASQA);/* PARM = @ WA IN SQA. NO CPU     01862000
*                                      AFFINITY. RUN AT SYSTEM     0422 01863000
*                                      PRIORITY.                     */ 01864000
         ST    R9,SRBPARM(,R8)                                     0422 01865000
*                 SRBRMTR=ADDR(RESCMNGR);/* ADDR OF RESOURCE MANAGER    01866000
*                                      ROUTINE                       */ 01867000
         LA    @05,RESCMNGR                                        0423 01868000
         ST    @05,SRBRMTR(,R8)                                    0423 01869000
*                 SRBPTCB=MYTCB;    /* SET MY TCB ADDRESS            */ 01870000
         L     @05,CVTPTR                                          0424 01871000
         AL    @14,CVTTCBP(,@05)                                   0424 01872000
         MVC   SRBPTCB(4,R8),MYTCB(@14)                            0424 01873000
*                 SRBPASID=1;       /* ASID = MASTER SCHED ASID      */ 01874000
         MVC   SRBPASID(2,R8),@CH00066                             0425 01875000
*                 SRBECB=0;         /* ZERO ECB                      */ 01876000
*                                                                  0426 01877000
         SLR   @14,@14                                             0426 01878000
         ST    @14,SRBECB(,R9)                                     0426 01879000
*                 /***************************************************/ 01880000
*                 /*                                                 */ 01881000
*                 /* GET DISP LOCK TO INSURE THAT SRB ROUTINE WILL   */ 01882000
*                 /* NOT BE SCHEDULED TO AN ADDRESS SPACE WHICH HAS  */ 01883000
*                 /* ALREADY TERMINATED OR IN PROCESS OF TERMINATING */ 01884000
*                 /*                                                 */ 01885000
*                 /***************************************************/ 01886000
*                                                                  0427 01887000
*                 GENERATE REFS(PSALITA,FLC);                      0427 01888000
*                                                                  0427 01889000
         SETLOCK OBTAIN,TYPE=DISP,MODE=UNCOND,REGS=USE,                *01890000
               RELATED=(RTM,IEEMPVST(FORCEOFF,LESTAE))                  01891000
*                 /***************************************************/ 01892000
*                 /*                                                 */ 01893000
*                 /* GET PTR TO ASCB AND PLACE IN SRB CB             */ 01894000
*                 /*                                                 */ 01895000
*                 /***************************************************/ 01896000
*                                                                  0428 01897000
*                 ASCBP=ASVTENTY(ASID);/* GET PTR FROM ACVT          */ 01898000
         LH    @14,ASID(,R9)                                       0428 01899000
         SLA   @14,2                                               0428 01900000
         L     @05,CVTPTR                                          0428 01901000
         L     @05,ASVTPTR(,@05)                                   0428 01902000
         L     @07,ASVTENTY-4(@14,@05)                             0428 01903000
         ST    @07,ASCBP(,R9)                                      0428 01904000
*                 SRBASCB=ASCBP;    /* SET PTR IN SRB CB             */ 01905000
*                                                                  0429 01906000
         ST    @07,SRBASCB(,R8)                                    0429 01907000
*                 /***************************************************/ 01908000
*                 /*                                                 */ 01909000
*                 /* TEST IF MEMORY CAN BE SCHEDULED TO. ASVT ENTRY  */ 01910000
*                 /* CURRENTLY IN USE AND MEMORY NOT IN PROCESS OF   */ 01911000
*                 /* FAILING                                         */ 01912000
*                 /*                                                 */ 01913000
*                 /***************************************************/ 01914000
*                                                                  0430 01915000
*                 IF(ASVTAVAL(ASID)='0'B)&(ASCBFAIL='0'B) THEN     0430 01916000
*                                                                  0430 01917000
         ALR   @05,@14                                             0430 01918000
         TM    ASVTAVAL-4(@05),B'10000000'                         0430 01919000
         BNZ   @RF00430                                            0430 01920000
         TM    ASCBFAIL(@07),B'01000000'                           0430 01921000
         BNZ   @RF00430                                            0430 01922000
*                   /*************************************************/ 01923000
*                   /*                                               */ 01924000
*                   /* SCHEDULE SRB ROUTINE IN GOOD MEMORY, FREE LOCK*/ 01925000
*                   /* AND WAIT FOR ROUTINE TO COMPLETE              */ 01926000
*                   /*                                               */ 01927000
*                   /*************************************************/ 01928000
*                                                                  0431 01929000
*                   DO;                                            0431 01930000
*                     R1=ADDR(SRBBUFR);/* ADDR OF SRB CB             */ 01931000
         LR    R1,R9                                               0432 01932000
*                     GENERATE REFS(SRBFLNK,CVTLSMQ);              0433 01933000
         SCHEDULE SRB=(1),SCOPE=LOCAL                                   01934000
         SETLOCK RELEASE,TYPE=DISP,                                    *01935000
               RELATED=(RTM,IEEMPVST(FORCEOFF)),REGS=USE                01936000
*                     DO;           /* WAIT (1) ECB(SRBECB)          */ 01937000
*                       RESPECIFY                                  0435 01938000
*                        (GPR00P,                                  0435 01939000
*                         GPR01P) RESTRICTED;                      0435 01940000
*                       GPR00P=1;   /* LOAD WAIT COUNT               */ 01941000
         LA    GPR00P,1                                            0436 01942000
*                       GPR01P=ADDR(SRBECB);/* ADDRESS OF ECB        */ 01943000
         LA    GPR01P,SRBECB(,R9)                                  0437 01944000
*                       SVC(1);     /* WAIT SVC                      */ 01945000
         SVC   1                                                   0438 01946000
*                       RESPECIFY                                  0439 01947000
*                        (GPR00P,                                  0439 01948000
*                         GPR01P) UNRESTRICTED;                    0439 01949000
*                     END;          /* WAIT (1) ECB(SRBECB) WAIT FOR    01950000
*                                      SRB TO COMPLETE               */ 01951000
*                   END;                                           0441 01952000
*                                                                  0441 01953000
*                 /***************************************************/ 01954000
*                 /*                                                 */ 01955000
*                 /* TARGET MEMORY SCHEDULED TO TERMINATE. FREE LOCK */ 01956000
*                 /* AND PROCESS NEXT PAGE                           */ 01957000
*                 /*                                                 */ 01958000
*                 /***************************************************/ 01959000
*                                                                  0442 01960000
*                 ELSE                                             0442 01961000
*                   GENERATE;                                      0442 01962000
         B     @RC00430                                            0442 01963000
@RF00430 DS    0H                                                  0442 01964000
         SETLOCK RELEASE,TYPE=DISP,                                    *01965000
               RELATED=(RTM,IEEMPVST(FORCEOFF)),REGS=USE                01966000
*                   RFY                                            0443 01967000
*                     R8 UNRSTD;                                   0443 01968000
@RC00430 DS    0H                                                  0444 01969000
*                 RFY                                              0444 01970000
*                   SRBSECT BASED(SRBPTR);                         0444 01971000
*               END;                /* END OF SCHED SRB RTN        0445 01972000
*                                      PROCESSING                    */ 01973000
*           END;                    /* END OF NON-COMMON MEMORY    0446 01974000
*                                      PROCESSING                    */ 01975000
@RF00415 DS    0H                                                  0447 01976000
*       END;                        /* END OF PENDING OFFLINE PAGE 0447 01977000
*                                      PROCESSING                    */ 01978000
@RC00398 DS    0H                                                  0448 01979000
*NEXTPAGE:                                                         0448 01980000
*     FRAMEPTR=FRAMEPTR+4096;       /* INCR REAL PAGE ADDR           */ 01981000
@RF00387 DS    0H                                                  0448 01982000
NEXTPAGE LH    @14,@CH00139                                        0448 01983000
         AL    @14,FRAMEPTR                                        0448 01984000
         ST    @14,FRAMEPTR                                        0448 01985000
*   END;                            /* GO PROCESS NEXT PAGE IN RANGE */ 01986000
*                                                                  0449 01987000
         LA    @08,1                                               0449 01988000
         AL    @08,RSRSTATP                                        0449 01989000
@DE00384 ST    @08,RSRSTATP                                        0449 01990000
         C     @08,ENDRNGE                                         0449 01991000
         BNH   @DL00384                                            0449 01992000
*   /*****************************************************************/ 01993000
*   /*                                                               */ 01994000
*   /* CLEAR INLOOP STATE FLAG                                       */ 01995000
*   /*                                                               */ 01996000
*   /*****************************************************************/ 01997000
*                                                                  0450 01998000
*   INLOOP='0'B;                                                   0450 01999000
*                                                                  0450 02000000
         NI    INLOOP,B'01111111'                                  0450 02001000
*   /*****************************************************************/ 02002000
*   /*                                                               */ 02003000
*   /* UNFIX SUBROUTINE CODE                                         */ 02004000
*   /*                                                               */ 02005000
*   /*****************************************************************/ 02006000
*                                                                  0451 02007000
*   DO;                             /* PGFREE(R) A(STRTFXCD)       0451 02008000
*                                      EA(ENDFXCD) RELEASE(N)        */ 02009000
*     RESPECIFY                                                    0452 02010000
*      (GPR00P,                                                    0452 02011000
*       GPR01P) RESTRICTED;                                        0452 02012000
*     GPR00P=0;                     /* INDICATE NO PAGE ECB          */ 02013000
         SLR   GPR00P,GPR00P                                       0453 02014000
*     GPR01P=ADDR(STRTFXCD);        /* PAGE ADDR                     */ 02015000
         LA    GPR01P,STRTFXCD                                     0454 02016000
*     RESPECIFY                                                    0455 02017000
*       GPR15P RESTRICTED;                                         0455 02018000
*     GPR15P=ADDR(ENDFXCD);         /* VSL ADDR                      */ 02019000
         LA    GPR15P,ENDFXCD                                      0456 02020000
*     GPR01P=GPR01P|'20000000'X;    /* R, PGFREE & RELEASE FLAG      */ 02021000
         O     GPR01P,@CF02582                                     0457 02022000
*     SVC(113);                     /* ISSUE PGFREE SVC              */ 02023000
         SVC   113                                                 0458 02024000
*     RESPECIFY                                                    0459 02025000
*      (GPR00P,                                                    0459 02026000
*       GPR01P,                                                    0459 02027000
*       GPR15P) UNRESTRICTED;                                      0459 02028000
*   END;                            /* PGFREE(R) A(STRTFXCD)       0460 02029000
*                                      EA(ENDFXCD) RELEASE(N)        */ 02030000
*   PGFIXFLG='0'B;                  /* CLEAR PAGE FIX FLAG           */ 02031000
*                                                                  0461 02032000
         NI    PGFIXFLG,B'10111111'                                0461 02033000
*   /*****************************************************************/ 02034000
*   /*                                                               */ 02035000
*   /* CANCEL LOCAL ESTAE ENVIRONMENT                                */ 02036000
*   /*                                                               */ 02037000
*   /*****************************************************************/ 02038000
*                                                                  0462 02039000
*CANCLLT:                                                          0462 02040000
*   GEN(ESTAE 0);                                                  0462 02041000
*                                                                  0462 02042000
CANCLLT  ESTAE 0                                                        02043000
*   /*****************************************************************/ 02044000
*   /*                                                               */ 02045000
*   /* FREE WORKAREA IN SQA                                          */ 02046000
*   /*                                                               */ 02047000
*   /*****************************************************************/ 02048000
*                                                                  0463 02049000
*FREESQA:                                                          0463 02050000
*   DO;                             /* FREEMAIN(RC)                0463 02051000
*                                      LV(LENGTH(WASQA))A(WASQA)   0463 02052000
*                                      SP(245)                       */ 02053000
FREESQA  DS    0H                                                  0464 02054000
*     RESPECIFY                                                    0464 02055000
*      (GPR01F,                                                    0464 02056000
*       GPR15F,                                                    0464 02057000
*       GPR00F) RESTRICTED;                                        0464 02058000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 02059000
         SLR   GPR01F,GPR01F                                       0465 02060000
*     GPR15F=1;                     /* SET TYPE                      */ 02061000
         LA    GPR15F,1                                            0466 02062000
*     GPR00F=LENGTH(WASQA);         /* LENGTH REQUESTED              */ 02063000
         LA    GPR00F,102                                          0467 02064000
*     GPR01F=ADDR(WASQA);           /* SET REGISTER ONE              */ 02065000
         LR    GPR01F,R9                                           0468 02066000
*     GPR15F=GPR15F+((245)*256);    /* SUBPOOL VALUE                 */ 02067000
         AL    GPR15F,@CF02887                                     0469 02068000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 02069000
         SVC   120                                                 0470 02070000
*     RESPECIFY                                                    0471 02071000
*      (GPR01F,                                                    0471 02072000
*       GPR15F,                                                    0471 02073000
*       GPR00F) UNRESTRICTED;                                      0471 02074000
*   END;                            /* FREEMAIN(RC)                0472 02075000
*                                      LV(LENGTH(WASQA))A(WASQA)   0472 02076000
*                                      SP(245)                       */ 02077000
*                                                                  0472 02078000
*   /*****************************************************************/ 02079000
*   /*                                                               */ 02080000
*   /* RETURN TO OFFLINE PROCESSOR                                   */ 02081000
*   /*                                                               */ 02082000
*   /*****************************************************************/ 02083000
*                                                                  0473 02084000
*EXITFOFF:                                                         0473 02085000
*   RETURN;                                                        0473 02086000
@EL00007 DS    0H                                                  0473 02087000
@EF00007 DS    0H                                                  0473 02088000
@ER00007 LM    @14,@12,@SA00007                                    0473 02089000
         BR    @14                                                 0473 02090000
*                                                                  0474 02091000
*   /*****************************************************************/ 02092000
*   /*                                                               */ 02093000
*   /* THE FOLLOWING ROUTINES ALL RUN ASYNCHRONOUS AND POSSIBLY IN A */ 02094000
*   /* DIFFERENT MEMORY THAN THE VARY STORAGE MODULE. THESE ROUTINES */ 02095000
*   /* THEREFORE DO NOT HAVE ADDRESSABILITY TO THE MAIN WORKAREA AND */ 02096000
*   /* MAY ONLY REFER TO VARIABLES IN THE WORKAREA ALLOCATED IN SQA. */ 02097000
*   /*                                                               */ 02098000
*   /*****************************************************************/ 02099000
*                                                                  0474 02100000
*SRBRTN:                                                           0474 02101000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0474 02102000
*                                                                  0474 02103000
SRBRTN   DS    0H                                                  0475 02104000
*   /*****************************************************************/ 02105000
*   /*                                                               */ 02106000
*   /* SRB ROUTINE TO ISSUE PGOUT FOR PENDING OFFLINE PAGE           */ 02107000
*   /*                                                               */ 02108000
*   /*****************************************************************/ 02109000
*                                                                  0475 02110000
*   RFY                                                            0475 02111000
*     R8 RSTD;                                                     0475 02112000
*   GENERATE;                                                      0476 02113000
          USING *,R8                    SPEC CODE BASE REG              02114000
          LR    R8,R15                  INIT CODE REG                   02115000
          LR    R9,R1               INIT PTR TO WA IN SQA               02116000
*   SRBEXRTN=R14;                   /* SAVE @ SRB EXIT RTN           */ 02117000
*                                                                  0477 02118000
         ST    R14,SRBEXRTN(,R9)                                   0477 02119000
*   /*****************************************************************/ 02120000
*   /*                                                               */ 02121000
*   /* GET LOCAL LOCK                                                */ 02122000
*   /*                                                               */ 02123000
*   /*****************************************************************/ 02124000
*                                                                  0478 02125000
*   GENERATE;                                                      0478 02126000
*                                                                  0478 02127000
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *02128000
               RELATED=(MEMORY,IEEMPVST(SRBRTN)),REGS=USE               02129000
*   /*****************************************************************/ 02130000
*   /*                                                               */ 02131000
*   /* TRY TO PGOUT TARGET PAGE. SET UP BRANCH ENTRY TO PGOUT ROUTINE*/ 02132000
*   /*                                                               */ 02133000
*   /*****************************************************************/ 02134000
*                                                                  0479 02135000
*   R0=0;                           /* CLEAR R0                      */ 02136000
         SLR   R0,R0                                               0479 02137000
*   GEN(LM   R1,R2,VSL(R9));        /* LOAD REGS WITH VSL            */ 02138000
         LM   R1,R2,VSL(R9)                                             02139000
*   R4=0;                           /* INDICATE SRB RTN              */ 02140000
         SLR   R4,R4                                               0481 02141000
*   R15=PVTPSIB;                    /* LOAD ENTRY POINT FROM PVT     */ 02142000
         L     @05,CVTPTR                                          0482 02143000
         L     @05,PVTPTR(,@05)                                    0482 02144000
         L     R15,PVTPSIB(,@05)                                   0482 02145000
*   GEN(BALR  R14,R15);             /* BRANCH ENTRY PGOUT            */ 02146000
*                                                                  0483 02147000
         BALR  R14,R15                                                  02148000
*   /*****************************************************************/ 02149000
*   /*                                                               */ 02150000
*   /* XMPOST MAINLINE. INDICATE THAT PAGEOUT OPERATION COMPLETE     */ 02151000
*   /*                                                               */ 02152000
*   /*****************************************************************/ 02153000
*                                                                  0484 02154000
*XMPOST:                                                           0484 02155000
*   SRBCREG=R8;                     /* SAVE CODE REG                 */ 02156000
XMPOST   ST    R8,SRBCREG(,R9)                                     0484 02157000
*   R10=0;                          /* SET COMPLETION CODE           */ 02158000
         SLR   R10,R10                                             0485 02159000
*   R11=ADDR(SRBECB);               /* @ ECB                         */ 02160000
         LA    R11,SRBECB(,R9)                                     0486 02161000
*   HOBIT='80'X;                    /* INIT VALUE OF HOB             */ 02162000
         MVI   HOBIT(R9),X'80'                                     0487 02163000
*   GEN(ICM 11,8,HOBIT(9));         /* SET HIGH ORDER BIT            */ 02164000
         ICM 11,8,HOBIT(9)                                              02165000
*   R12=ADDR(XMPSTF);               /* @ OF RTN IF POST FAILS        */ 02166000
         LA    R12,XMPSTF                                          0489 02167000
*   R13=ASVTENTY(1);                /* @ ASCB FOR MASTR SCHED        */ 02168000
         L     @14,CVTPTR                                          0490 02169000
         L     @05,ASVTPTR(,@14)                                   0490 02170000
         L     R13,ASVTENTY(,@05)                                  0490 02171000
*   R15=CVT0PT01;                   /* BRANCH ENTRY POST             */ 02172000
         L     R15,CVT0PT01(,@14)                                  0491 02173000
*   GEN(BALR R14,R15);              /* CALL XMPOST                   */ 02174000
*                                                                  0492 02175000
         BALR R14,R15                                                   02176000
*   /*****************************************************************/ 02177000
*   /*                                                               */ 02178000
*   /* ONLY REGS 9 AND 14 ARE VALID AFTER XMPOST ROUTINE             */ 02179000
*   /*                                                               */ 02180000
*   /*****************************************************************/ 02181000
*                                                                  0493 02182000
*   R8=SRBCREG;                     /* RESTORE CODE REG              */ 02183000
*                                                                  0493 02184000
         L     R8,SRBCREG(,R9)                                     0493 02185000
*   /*****************************************************************/ 02186000
*   /*                                                               */ 02187000
*   /* RELEASE LOCAL LOCK                                            */ 02188000
*   /*                                                               */ 02189000
*   /*****************************************************************/ 02190000
*                                                                  0494 02191000
*   GENERATE;                                                      0494 02192000
*                                                                  0494 02193000
         SETLOCK RELEASE,TYPE=LOCAL,                                   *02194000
               RELATED=(MEMORY,IEEMPVST(SRBRTN)),REGS=USE               02195000
*   /*****************************************************************/ 02196000
*   /*                                                               */ 02197000
*   /* RETURN TO SRB EXIT ROUTINE                                    */ 02198000
*   /*                                                               */ 02199000
*   /*****************************************************************/ 02200000
*                                                                  0495 02201000
*   R14=SRBEXRTN;                   /* SET RETURN ADDRESS            */ 02202000
         L     R14,SRBEXRTN(,R9)                                   0495 02203000
*   GEN(BR R14);                    /* EXIT TO SRB EXIT RTN          */ 02204000
*                                                                  0496 02205000
         BR R14                                                         02206000
*   /*****************************************************************/ 02207000
*   /*                                                               */ 02208000
*   /* POST FAIL EXIT ROUTINE. JUST RETURN TO CALLER                 */ 02209000
*   /*                                                               */ 02210000
*   /*****************************************************************/ 02211000
*                                                                  0497 02212000
*XMPSTF:                                                           0497 02213000
*   GEN(BR R14);                                                   0497 02214000
*                                                                  0497 02215000
XMPSTF   BR R14                                                         02216000
*   /*****************************************************************/ 02217000
*   /*                                                               */ 02218000
*   /* DROP CODE ADDRESSABILITY REG 8                                */ 02219000
*   /*                                                               */ 02220000
*   /*****************************************************************/ 02221000
*                                                                  0498 02222000
*   GEN(DROP R8);                                                  0498 02223000
         DROP R8                                                        02224000
*   RFY                                                            0499 02225000
*     R8 UNRSTD;                                                   0499 02226000
*   END SRBRTN;                                                    0500 02227000
*                                                                  0500 02228000
@EL00008 DS    0H                                                  0500 02229000
@EF00008 DS    0H                                                  0500 02230000
@ER00008 BR    @14                                                 0500 02231000
*/*                                                                  */ 02232000
*/*                 RESOURCE MANAGER TERMINATION ROUTINE             */ 02233000
*/*    ROUTINE GIVEN CONTROL BY PURGEDQ IN THE EVENT  THAT           */ 02234000
*/*    A SCHEDULED SRB RTN CAN NOT BE DISPATCHED.                    */ 02235000
*/*                                                                  */ 02236000
*                                                                  0501 02237000
*RESCMNGR:                                                         0501 02238000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0501 02239000
RESCMNGR DS    0H                                                  0502 02240000
*   RFY                                                            0502 02241000
*     R8 RSTD;                                                     0502 02242000
*   GENERATE;                                                      0503 02243000
         BALR  R8,0                     GET @ ENTRY POINT               02244000
         USING *,R8                                                     02245000
         LR    R9,R2                PTR TO WA IN SQA                    02246000
*   RSCMEXRP=R14;                   /* SAVE RETURN ADDRESS           */ 02247000
*                                                                  0504 02248000
         ST    R14,RSCMEXRP(,R9)                                   0504 02249000
*   /*****************************************************************/ 02250000
*   /*                                                               */ 02251000
*   /* GET LOCAL LOCK                                                */ 02252000
*   /*                                                               */ 02253000
*   /*****************************************************************/ 02254000
*                                                                  0505 02255000
*   GENERATE;                                                      0505 02256000
*                                                                  0505 02257000
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *02258000
               RELATED=(MEMORY,IEEMPVST(RESCMNGR)),REGS=USE             02259000
*   /*****************************************************************/ 02260000
*   /*                                                               */ 02261000
*   /* XMPOST SRB ECB THAT SRB RTN PROCESSING HAS TERMINATED         */ 02262000
*   /*                                                               */ 02263000
*   /*****************************************************************/ 02264000
*                                                                  0506 02265000
*   RSCMCRG=R8;                     /* SAVE CODE REG                 */ 02266000
         ST    R8,RSCMCRG(,R9)                                     0506 02267000
*   R10=0;                          /* SET COMPLETION CODE           */ 02268000
         SLR   R10,R10                                             0507 02269000
*   R11=ADDR(SRBECB);               /* ADDR ECB                      */ 02270000
         LA    R11,SRBECB(,R9)                                     0508 02271000
*   HOBIT='80'X;                    /* SET VALUE OF HOB              */ 02272000
         MVI   HOBIT(R9),X'80'                                     0509 02273000
*   GEN(ICM 11,8,HOBIT(9));         /* SET HIGH ORDER BIT            */ 02274000
         ICM 11,8,HOBIT(9)                                              02275000
*   R12=ADDR(XMPFAIL);              /* XMPOST FAIL EXIT              */ 02276000
         LA    R12,XMPFAIL                                         0511 02277000
*   R13=ASVTENTY(1);                /* @ ASCB OF MSTR SCHED          */ 02278000
         L     @14,CVTPTR                                          0512 02279000
         L     @05,ASVTPTR(,@14)                                   0512 02280000
         L     R13,ASVTENTY(,@05)                                  0512 02281000
*   R15=CVT0PT01;                   /* BRANCH ENTRY XMPOST           */ 02282000
         L     R15,CVT0PT01(,@14)                                  0513 02283000
*   GEN(BALR R14,R15);              /* CALL XMPOST                   */ 02284000
*                                                                  0514 02285000
         BALR R14,R15                                                   02286000
*   /*****************************************************************/ 02287000
*   /*                                                               */ 02288000
*   /* ONLY REGS 9 AND 14 ARE VALID AFTER XMPOST ROUTINE RETURNS     */ 02289000
*   /*                                                               */ 02290000
*   /*****************************************************************/ 02291000
*                                                                  0515 02292000
*   R8=RSCMCRG;                     /* RESTORE CODE REG              */ 02293000
*                                                                  0515 02294000
         L     R8,RSCMCRG(,R9)                                     0515 02295000
*   /*****************************************************************/ 02296000
*   /*                                                               */ 02297000
*   /* RELEASE LOCAL LOCK                                            */ 02298000
*   /*                                                               */ 02299000
*   /*****************************************************************/ 02300000
*                                                                  0516 02301000
*   GENERATE;                                                      0516 02302000
*                                                                  0516 02303000
         SETLOCK RELEASE,TYPE=LOCAL,                                   *02304000
               RELATED=(MEMORY,IEEMPVST(RESCMNGR)),REGS=USE             02305000
*   /*****************************************************************/ 02306000
*   /*                                                               */ 02307000
*   /* RETURN TO SYSTEM                                              */ 02308000
*   /*                                                               */ 02309000
*   /*****************************************************************/ 02310000
*                                                                  0517 02311000
*   R14=RSCMEXRP;                   /* LOAD RETURN POINT             */ 02312000
         L     R14,RSCMEXRP(,R9)                                   0517 02313000
*   GEN(BR R14);                                                   0518 02314000
*                                                                  0518 02315000
         BR R14                                                         02316000
*   /*****************************************************************/ 02317000
*   /*                                                               */ 02318000
*   /* POST FAIL EXIT. JUST RETURN TO CALLER                         */ 02319000
*   /*                                                               */ 02320000
*   /*****************************************************************/ 02321000
*                                                                  0519 02322000
*XMPFAIL:                                                          0519 02323000
*   GEN(BR R14);                                                   0519 02324000
*                                                                  0519 02325000
XMPFAIL  BR R14                                                         02326000
*   /*****************************************************************/ 02327000
*   /*                                                               */ 02328000
*   /* DROP CODE ADDRESSABILITY REG 8                                */ 02329000
*   /*                                                               */ 02330000
*   /*****************************************************************/ 02331000
*                                                                  0520 02332000
*   GEN(DROP R8);                                                  0520 02333000
         DROP R8                                                        02334000
*   RFY                                                            0521 02335000
*     R8 UNRSTD;                                                   0521 02336000
*   END RESCMNGR;                                                  0522 02337000
@EL00009 DS    0H                                                  0522 02338000
@EF00009 DS    0H                                                  0522 02339000
@ER00009 BR    @14                                                 0522 02340000
*                                                                  0523 02341000
*/*                                                                  */ 02342000
*/*            LOCAL ESTAE ROUTINE                                   */ 02343000
*/*   ROUTINE TRAPS ERRORS FOR FORCEOFF SUBROUTINE                   */ 02344000
*/*                                                                  */ 02345000
*                                                                  0523 02346000
*LESTAE:                                                           0523 02347000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0523 02348000
LESTAE   DS    0H                                                  0524 02349000
*   RFY                                                            0524 02350000
*    (R7,                                                          0524 02351000
*     R8) RSTD;                                                    0524 02352000
*   DO;                             /* ENTESTAE (R10,R9,R11,R12)ERREX   02353000
*                                      IT(NRTCA)PARMREG(R15)         */ 02354000
*/*  ENTRY CODE FOR ESTAE ROUTINE.                                   */ 02355000
*/*  IF RTCA ALLOCATED THEN RESTORE CODE AND                         */ 02356000
*/*  DATA REGS FROM START OF USERS PARM LIST,                        */ 02357000
*/*  AND ESTABLISH ADDR TO ESTAE SAVE AREA                           */ 02358000
*/*  IF REQUIRED.                                                    */ 02359000
*/*  IF NO RTCA AVAILABLE THEN BRANCH TO ERROR                       */ 02360000
*/*  CODE AFTER ESTABLISHING ADDRESSABILITY                          */ 02361000
*                                                                  0526 02362000
*     GEN(USING *,GPR15P);                                         0526 02363000
         USING *,GPR15P                                                 02364000
*     GEN(CH    GPR00F,*+30);       /* CHECK IF RTCA ALLOC FAILED    */ 02365000
         CH    GPR00F,*+30                                              02366000
*     GEN(BNE   *+28);              /* NO,SAVE RTM REGS              */ 02367000
         BNE   *+28                                                     02368000
*     GEN(DROP  GPR15P);            /* DROP LOCAL ADDR               */ 02369000
         DROP  GPR15P                                                   02370000
*     GEN(LR    R15,GPR02P);        /* PTR TO USER PARM LIST         */ 02371000
         LR    R15,GPR02P                                               02372000
*     GEN(L     R10,00(R15));                                      0531 02373000
         L     R10,00(R15)                                              02374000
*     GEN(L     R9,04(R15));                                       0532 02375000
         L     R9,04(R15)                                               02376000
*     GEN(L     R11,08(R15));                                      0533 02377000
         L     R11,08(R15)                                              02378000
*     GEN(L     R12,12(R15));                                      0534 02379000
         L     R12,12(R15)                                              02380000
*     GEN(B     NRTCA);             /* BRANCH TO ERROR EXIT          */ 02381000
         B     NRTCA                                                    02382000
*     GEN(DC    H'12');             /* NO RTCA AVAIL RC              */ 02383000
         DC    H'12'                                                    02384000
*     GEN(STM   GPR14P,GPR12F,12(GPR13P));/* GOOD R13, SAVE RTM'S  0537 02385000
*                                      REGS                          */ 02386000
         STM   GPR14P,GPR12F,12(GPR13P)                                 02387000
*     GEN(L     R15,0(GPR01P));     /* PTR TO USER PARM LIST         */ 02388000
         L     R15,0(GPR01P)                                            02389000
*     GEN(L     R10,00(R15));                                      0539 02390000
         L     R10,00(R15)                                              02391000
*     GEN(L     R9,04(R15));                                       0540 02392000
         L     R9,04(R15)                                               02393000
*     GEN(L     R11,08(R15));                                      0541 02394000
         L     R11,08(R15)                                              02395000
*     GEN(L     R12,12(R15));                                      0542 02396000
         L     R12,12(R15)                                              02397000
*   END;                            /* ENTESTAE (R10,R9,R11,R12)ERREX   02398000
*                                      IT(NRTCA)PARMREG(R15)         */ 02399000
*                                                                  0543 02400000
*   /*****************************************************************/ 02401000
*   /*                                                               */ 02402000
*   /* GOOD RTCA SET FLAG ON                                         */ 02403000
*   /*                                                               */ 02404000
*   /*****************************************************************/ 02405000
*                                                                  0544 02406000
*   RTCAOK='1'B;                                                   0544 02407000
         OI    RTCAOK(R9),B'10000000'                              0544 02408000
*   GO TO PRCEST;                   /* PROCESS ESTAE                 */ 02409000
*                                                                  0545 02410000
         B     PRCEST                                              0545 02411000
*   /*****************************************************************/ 02412000
*   /*                                                               */ 02413000
*   /* NO RTCA AVAILABLE , CLEAR FLAG                                */ 02414000
*   /*                                                               */ 02415000
*   /*****************************************************************/ 02416000
*                                                                  0546 02417000
*NRTCA:                                                            0546 02418000
*   RTCAOK='0'B;                                                   0546 02419000
*                                                                  0546 02420000
NRTCA    NI    RTCAOK(R9),B'01111111'                              0546 02421000
*   /*****************************************************************/ 02422000
*   /*                                                               */ 02423000
*   /* PROCESS ESTAE                                                 */ 02424000
*   /*                                                               */ 02425000
*   /*****************************************************************/ 02426000
*                                                                  0547 02427000
*PRCEST:                                                           0547 02428000
*   R8=R14;                         /* SAVE RETURN ADDR              */ 02429000
PRCEST   LR    R8,R14                                              0547 02430000
*   R7=R1;                          /* SAVE PTR TO RTCA              */ 02431000
*                                                                  0548 02432000
         LR    R7,R1                                               0548 02433000
*   /*****************************************************************/ 02434000
*   /*                                                               */ 02435000
*   /* SCHEDULE RETRY AT NEXTPAGE IF IN LOOP AND GOOD RTCA AVAILABLE */ 02436000
*   /*                                                               */ 02437000
*   /*****************************************************************/ 02438000
*                                                                  0549 02439000
*   IF(INLOOP='1'B)&(RTCAOK='1'B) THEN                             0549 02440000
         TM    INLOOP,B'10000000'                                  0549 02441000
         BNO   @RF00549                                            0549 02442000
         TM    RTCAOK(R9),B'10000000'                              0549 02443000
         BNO   @RF00549                                            0549 02444000
*     DO;                                                          0550 02445000
*       R1=R7;                      /* RESTORE PTR TO RTCA           */ 02446000
         LR    R1,R7                                               0551 02447000
*       DO;                         /* SETRP RC(4)RETADDR(NEXTPAGE)RE   02448000
*                                      TREGS(YES)RUB(RUBSA)FRESDWA(YE   02449000
*                                      S)DUMP(NO)RECORD(NO)REGS(14,12   02450000
*                                      )                             */ 02451000
*         RESPECIFY                                                0553 02452000
*          (GPR00P,                                                0553 02453000
*           GPR01P,                                                0553 02454000
*           GPR14P,                                                0553 02455000
*           GPR15P) RSTD;                                          0553 02456000
*         GPR01P->SDWARCDE=4;       /* STORE RC INTO SDWA            */ 02457000
         MVI   SDWARCDE(GPR01P),X'04'                              0554 02458000
*         GPR01P->SDWARTYA=ADDR(NEXTPAGE);/* SAVE RETRY ADDRESS      */ 02459000
         LA    @06,NEXTPAGE                                        0555 02460000
         ST    @06,SDWARTYA(,GPR01P)                               0555 02461000
*         GPR01P->SDWAFREE='1'B;    /* SET FLAG TO FREE SDWA         */ 02462000
*         GPR01P->SDWARCRD='0'B;    /* TURN OFF RECORD INDICATOR     */ 02463000
         OI    SDWAFREE(GPR01P),B'00000100'                        0557 02464000
         NI    SDWARCRD(GPR01P),B'01111111'                        0557 02465000
*         GPR01P->SDWAREQ='0'B;     /* TURN OFF DUMP INDICATOR       */ 02466000
         NI    SDWAREQ(GPR01P),B'01111111'                         0558 02467000
*         GPR01P->SDWAUPRG='1'B;    /* TURN ON RETREGS INDICATOR     */ 02468000
         OI    SDWAUPRG(GPR01P),B'00001000'                        0559 02469000
*         GPR15P=ADDR(RUBSA);       /* GET PTR TO REG UPDATE BLOCK   */ 02470000
         LA    GPR15P,RUBSA                                        0560 02471000
*         GPR00P=GPR15P->I015F;     /* ACCESS REGISTER BIT PATTERN   */ 02472000
         LH    GPR00P,I015F(,GPR15P)                               0561 02473000
*         GPR15P=GPR15P+2;          /* CREATE PTR TO USER REG VALUES */ 02474000
         AL    GPR15P,@CF00182                                     0562 02475000
*         GPR14P=ADDR(GPR01P->SDWASRSV);/* CREATE PTR TO SDWA SAVE 0563 02476000
*                                      AREA                          */ 02477000
         LA    GPR14P,SDWASRSV(,GPR01P)                            0563 02478000
*         GEN(SLL   0,16);          /* SHIFT BIT PATTERN TO HIGH   0564 02479000
*                                      ORDER                         */ 02480000
         SLL   0,16                                                     02481000
*R0024:                                                            0565 02482000
*         GEN FLOWS(I0024);                                        0565 02483000
R0024    DS    0H                                                  0565 02484000
         ALR   0,0                    SHIFT BIT TO SIGN POSITION        02485000
         BC    12,I0024               BRANCH IF BIT NOT ON              02486000
         MVC   0(4,14),0(15)          MODIFY REGISTER IN SDWA           02487000
         LA    15,4(15)               UPDATE POINTER                    02488000
*I0024:                                                            0566 02489000
*         GENERATE FLOWS(R0024);                                   0566 02490000
I0024    DS    0H                                                  0566 02491000
         LA    14,4(14)               UPDATE PTR IN SDWA                02492000
         BC    5,R0024                TEST ALR CONDITION CODE TO TEST   02493000
*                                     IF ALL BITS EXHAUSTED             02494000
*         GEN(RETURN (14,12));                                     0567 02495000
         RETURN (14,12)                                                 02496000
*         RESPECIFY                                                0568 02497000
*          (GPR00P,                                                0568 02498000
*           GPR01P,                                                0568 02499000
*           GPR14P,                                                0568 02500000
*           GPR15P) UNRSTD;                                        0568 02501000
*       END;                                                       0569 02502000
*       RFY                                                        0570 02503000
*         SDWA BASED(SDWAPTR);                                     0570 02504000
*     END;                                                         0571 02505000
*                                                                  0571 02506000
*   /*****************************************************************/ 02507000
*   /*                                                               */ 02508000
*   /* CONTINUE TERMINATION. UNFIX SUBROUTINE CODE IF FIXED          */ 02509000
*   /*                                                               */ 02510000
*   /*****************************************************************/ 02511000
*                                                                  0572 02512000
*   IF PGFIXFLG='1'B THEN                                          0572 02513000
@RF00549 TM    PGFIXFLG,B'01000000'                                0572 02514000
         BNO   @RF00572                                            0572 02515000
*     DO;                                                          0573 02516000
*       DO;                         /* PGFREE(R) A(STRTFXCD)       0574 02517000
*                                      EA(ENDFXCD) ECB(PGFIXECB)   0574 02518000
*                                      RELEASE(N)                    */ 02519000
*         RESPECIFY                                                0575 02520000
*          (GPR00P,                                                0575 02521000
*           GPR01P) RESTRICTED;                                    0575 02522000
*         GPR00P=ADDR(PGFIXECB);    /* ECB ADDR                      */ 02523000
         LA    GPR00P,PGFIXECB(,R9)                                0576 02524000
*         GPR01P=ADDR(STRTFXCD);    /* PAGE ADDR                     */ 02525000
         LA    GPR01P,STRTFXCD                                     0577 02526000
*         RESPECIFY                                                0578 02527000
*           GPR15P RESTRICTED;                                     0578 02528000
*         GPR15P=ADDR(ENDFXCD);     /* VSL ADDR                      */ 02529000
         LA    GPR15P,ENDFXCD                                      0579 02530000
*         GPR01P=GPR01P|'20000000'X;/* R, PGFREE & RELEASE FLAG      */ 02531000
         O     GPR01P,@CF02582                                     0580 02532000
*         SVC(113);                 /* ISSUE PGFREE SVC              */ 02533000
         SVC   113                                                 0581 02534000
*         RESPECIFY                                                0582 02535000
*          (GPR00P,                                                0582 02536000
*           GPR01P,                                                0582 02537000
*           GPR15P) UNRESTRICTED;                                  0582 02538000
*       END;                        /* PGFREE(R) A(STRTFXCD)       0583 02539000
*                                      EA(ENDFXCD) ECB(PGFIXECB)   0583 02540000
*                                      RELEASE(N)                    */ 02541000
*     END;                                                         0584 02542000
*                                                                  0584 02543000
*   /*****************************************************************/ 02544000
*   /*                                                               */ 02545000
*   /* FREE SQA WORKAREA                                             */ 02546000
*   /*                                                               */ 02547000
*   /*****************************************************************/ 02548000
*                                                                  0585 02549000
*   IF RTCAOK='1'B THEN                                            0585 02550000
@RF00572 TM    RTCAOK(R9),B'10000000'                              0585 02551000
         BNO   @RF00585                                            0585 02552000
*     GOODRTCA='1'B;                                               0586 02553000
         OI    GOODRTCA,B'00001000'                                0586 02554000
*   ELSE                                                           0587 02555000
*     GOODRTCA='0'B;                /* SAVE RTCA IND                 */ 02556000
         B     @RC00585                                            0587 02557000
@RF00585 NI    GOODRTCA,B'11110111'                                0587 02558000
*   DO;                             /* FREEMAIN(R) LV(LENGTH(WASQA))S   02559000
*                                      P(245)A(WASQA)                */ 02560000
@RC00585 DS    0H                                                  0589 02561000
*     RESPECIFY                                                    0589 02562000
*      (GPR01F,                                                    0589 02563000
*       GPR00F) RESTRICTED;                                        0589 02564000
*     GPR00F=LENGTH(WASQA);         /* LENGTH REQUESTED              */ 02565000
         LA    GPR00F,102                                          0590 02566000
*     GPR01F=245;                   /* SP IN REG 1                   */ 02567000
         LA    GPR01F,245                                          0591 02568000
*     GEN(SLL   GPR01F,24)                                         0592 02569000
*     NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;                 0592 02570000
         SLL   GPR01F,24                                                02571000
*     GPR00F=GPR00F|GPR01F;         /* SP IN HI BYTE                 */ 02572000
         OR    GPR00F,GPR01F                                       0593 02573000
*     GPR01F=ADDR(WASQA);           /* SET REGISTER ONE              */ 02574000
         LR    GPR01F,R9                                           0594 02575000
*     SVC(10);                      /* R-FORM OF GETMAIN             */ 02576000
         SVC   10                                                  0595 02577000
*     RESPECIFY                                                    0596 02578000
*      (GPR01F,                                                    0596 02579000
*       GPR00F) UNRESTRICTED;                                      0596 02580000
*   END;                            /* FREEMAIN(R) LV(LENGTH(WASQA))S   02581000
*                                      P(245)A(WASQA)                */ 02582000
*                                                                  0597 02583000
*   /*****************************************************************/ 02584000
*   /*                                                               */ 02585000
*   /* RETURN TO RTM TO CONTINUE TERMINATION                         */ 02586000
*   /*                                                               */ 02587000
*   /*****************************************************************/ 02588000
*                                                                  0598 02589000
*   IF GOODRTCA='1'B THEN                                          0598 02590000
*                                                                  0598 02591000
         TM    GOODRTCA,B'00001000'                                0598 02592000
         BNO   @RF00598                                            0598 02593000
*     /***************************************************************/ 02594000
*     /*                                                             */ 02595000
*     /* CONTINUE TERM WITH GOOD RTCA                                */ 02596000
*     /*                                                             */ 02597000
*     /***************************************************************/ 02598000
*                                                                  0599 02599000
*     DO;                                                          0599 02600000
*       R1=R7;                      /* SET PTR TO RTCA               */ 02601000
         LR    R1,R7                                               0600 02602000
*       DO;                         /* SETRP RC(0)DUMP(NO)RECORD(NO)R   02603000
*                                      EGS(14,12)                    */ 02604000
*         RESPECIFY                                                0602 02605000
*          (GPR00P,                                                0602 02606000
*           GPR01P,                                                0602 02607000
*           GPR14P,                                                0602 02608000
*           GPR15P) RSTD;                                          0602 02609000
*         GPR01P->SDWARCDE=0;       /* SAVE RC VALUE                 */ 02610000
         MVI   SDWARCDE(GPR01P),X'00'                              0603 02611000
*         GPR01P->SDWARCRD='0'B;    /* TURN OFF RECORD INDICATOR     */ 02612000
         NI    SDWARCRD(GPR01P),B'01111111'                        0604 02613000
*         GPR01P->SDWAREQ='0'B;     /* TURN OFF DUMP INDICATOR       */ 02614000
         NI    SDWAREQ(GPR01P),B'01111111'                         0605 02615000
*         GEN(RETURN (14,12));                                     0606 02616000
         RETURN (14,12)                                                 02617000
*         RESPECIFY                                                0607 02618000
*          (GPR00P,                                                0607 02619000
*           GPR01P,                                                0607 02620000
*           GPR14P,                                                0607 02621000
*           GPR15P) UNRSTD;                                        0607 02622000
*       END;                                                       0608 02623000
*       RFY                                                        0609 02624000
*         SDWA BASED(SDWAPTR);                                     0609 02625000
*     END;                                                         0610 02626000
*   ELSE                                                           0611 02627000
*                                                                  0611 02628000
*     /***************************************************************/ 02629000
*     /*                                                             */ 02630000
*     /* CONTINUE TERMINATION WITH NO RTCA                           */ 02631000
*     /*                                                             */ 02632000
*     /***************************************************************/ 02633000
*                                                                  0611 02634000
*     DO;                                                          0611 02635000
         B     @RC00598                                            0611 02636000
@RF00598 DS    0H                                                  0612 02637000
*       GEN(LA R15,0);              /* SET RETURN CODE               */ 02638000
         LA R15,0                                                       02639000
*       GEN(LR R14,R8);             /* RESTORE R14                   */ 02640000
         LR R14,R8                                                      02641000
*       GEN(BR R14);                /* RETURN TO RTM                 */ 02642000
         BR R14                                                         02643000
*     END;                                                         0615 02644000
*   RFY                                                            0616 02645000
*    (R7,                                                          0616 02646000
*     R8) UNRSTD;                                                  0616 02647000
*ENDFXCD:                                                          0617 02648000
*   END LESTAE;                                                    0617 02649000
*                                                                  0617 02650000
@EL00010 DS    0H                                                  0617 02651000
@EF00010 DS    0H                                                  0617 02652000
@ER00010 BR    @14                                                 0617 02653000
*   /*****************************************************************/ 02654000
*   /*                                                               */ 02655000
*   /* END OF FORCEOFF SUBROUTINE                                    */ 02656000
*   /*                                                               */ 02657000
*   /*****************************************************************/ 02658000
*                                                                  0618 02659000
*   RFY                                                            0618 02660000
*    (R2,                                                          0618 02661000
*     R3,                                                          0618 02662000
*     R4,                                                          0618 02663000
*     R9) UNRSTD;                                                  0618 02664000
*   RFY                                                            0619 02665000
*     ASCB BASED(ASCBPTR);                                         0619 02666000
*   END FORCEOFF;                                                  0620 02667000
         B     @EL00007                                            0620 02668000
*                                                                  0621 02669000
*/*      PROCESS OFFLINE PAGES                                       */ 02670000
*/*  WRITE SMF RECORD AND OFFLINE MESSAGE TO OPERATOR.               */ 02671000
*/*  SERIALIZE TO INSURE THAT STATUS OF THIS RANGE REMAINS STATIC    */ 02672000
*/*  AND THEN ZERO ALL OFFLINE PAGES IN THE RANGE.                   */ 02673000
*/*                                                                  */ 02674000
*                                                                  0621 02675000
*PROCOFF:                                                          0621 02676000
*   PROC;                                                          0621 02677000
*                                                                  0621 02678000
PROCOFF  STM   @14,@12,@SA00011                                    0621 02679000
*   /*****************************************************************/ 02680000
*   /*                                                               */ 02681000
*   /* WRITE SMF RECORD                                              */ 02682000
*   /*                                                               */ 02683000
*   /*****************************************************************/ 02684000
*                                                                  0622 02685000
*   IF OFFDONE='0'B THEN            /* IF NOT ALREADY WRITTEN      0622 02686000
*                                                            @ZA00801*/ 02687000
         TM    OFFDONE,B'00000010'                                 0622 02688000
         BNZ   @RF00622                                            0622 02689000
*     CALL STORSMF;                 /*                       @YM06078*/ 02690000
         BAL   @14,STORSMF                                         0623 02691000
*   OFFDONE='0'B;                   /* RESET INDICATOR       @ZA00801*/ 02692000
*                                                                  0624 02693000
@RF00622 NI    OFFDONE,B'11111101'                                 0624 02694000
*   /*****************************************************************/ 02695000
*   /*                                                               */ 02696000
*   /* WRITE OFFLINE MESSAGE                                         */ 02697000
*   /*                                                               */ 02698000
*   /*****************************************************************/ 02699000
*                                                                  0625 02700000
*   CALL WTORTN(2);                 /*                       @YM06078*/ 02701000
*                                                                  0625 02702000
         LA    @01,@AL00625                                        0625 02703000
         BAL   @14,WTORTN                                          0625 02704000
*   /*****************************************************************/ 02705000
*   /*                                                               */ 02706000
*   /* SERIALIZE VALIDATION OF OFFLINE STORAGE WITH VARY STORAGE     */ 02707000
*   /* ONLINE. SERIALIZATION IS REQUIRED TO INSURE THAT THE OF PAGES */ 02708000
*   /* WITHIN THE RANGE DOES NOT CHANGE WHILE OFFLINE PAGES ARE BEING*/ 02709000
*   /* ZEROED.                                                       */ 02710000
*   /*                                                               */ 02711000
*   /*****************************************************************/ 02712000
*                                                                  0626 02713000
*   CALL SERIALZE;                                                 0626 02714000
*                                                                  0626 02715000
         BAL   @14,SERIALZE                                        0626 02716000
*   /*****************************************************************/ 02717000
*   /*                                                               */ 02718000
*   /* GET STATUS OF PAGES AGAIN TO INSURE THAT ONLY OFFLINE PAGES   */ 02719000
*   /* ARE ZEROED                                                    */ 02720000
*   /*                                                               */ 02721000
*   /*****************************************************************/ 02722000
*                                                                  0627 02723000
*   CALL RSRSTAT;                   /* GET STATUS OF PAGES           */ 02724000
*                                                                  0627 02725000
         BAL   @14,RSRSTAT                                         0627 02726000
*   /*****************************************************************/ 02727000
*   /*                                                               */ 02728000
*   /* SCAN STATUS MAP AND ZERO STORAGE IN OFFLINE PAGES ONLY. ALL   */ 02729000
*   /* PAGES SHOULD BE OFFLINE                                       */ 02730000
*   /*                                                               */ 02731000
*   /*****************************************************************/ 02732000
*                                                                  0628 02733000
*   FRAMEPTR=SRANGE;                /* SET @ OF FIRST 4K PAGE        */ 02734000
         MVC   FRAMEPTR(4),SRANGE                                  0628 02735000
*   DO RSRSTATP=RSRSLP TO RSRSLP+RSRFRCT-1;/* FOR EACH STATUS BYTE   */ 02736000
*                                                                  0629 02737000
         L     @14,RSRWAP                                          0629 02738000
         L     @14,RSRSLP(,@14)                                    0629 02739000
         B     @DE00629                                            0629 02740000
@DL00629 DS    0H                                                  0630 02741000
*     /***************************************************************/ 02742000
*     /*                                                             */ 02743000
*     /* VERIFY EACH PAGE IS OFFLINE                                 */ 02744000
*     /*                                                             */ 02745000
*     /***************************************************************/ 02746000
*                                                                  0630 02747000
*     IF(POFFLN='1'B)&(PINTRCP='0'B) THEN                          0630 02748000
*                                                                  0630 02749000
         TM    POFFLN(@14),B'10000000'                             0630 02750000
         BNO   @RF00630                                            0630 02751000
         TM    PINTRCP(@14),B'01000000'                            0630 02752000
         BNZ   @RF00630                                            0630 02753000
*       /*************************************************************/ 02754000
*       /*                                                           */ 02755000
*       /* ZERO STOR IN THIS OFFLINE PAGE                            */ 02756000
*       /*                                                           */ 02757000
*       /*************************************************************/ 02758000
*                                                                  0631 02759000
*       DO;                                                        0631 02760000
*         VALOFF='1'B;              /* SET OFFLINE VALIDATE FLAG   0632 02761000
*                                                            @ZAXXXXX*/ 02762000
         OI    VALOFF,B'10000000'                                  0632 02763000
*         VALFC=0;                  /* SET OFFLINE FUNCTION CODE     */ 02764000
         SLR   @14,@14                                             0633 02765000
         ST    @14,VALFC                                           0633 02766000
*         CALL IEEVALST(VALFC,FRAMEPTR,VALFRA);/* VALIDATE PAGE      */ 02767000
         LA    @14,VALFC                                           0634 02768000
         ST    @14,@AL00001                                        0634 02769000
         LA    @14,FRAMEPTR                                        0634 02770000
         ST    @14,@AL00001+4                                      0634 02771000
         LA    @14,VALFRA                                          0634 02772000
         ST    @14,@AL00001+8                                      0634 02773000
         L     @15,@CV00128                                        0634 02774000
         LA    @01,@AL00001                                        0634 02775000
         BALR  @14,@15                                             0634 02776000
*         VALOFF='0'B;              /* RESET OFFLINE FLAG    @ZAXXXXX*/ 02777000
         NI    VALOFF,B'01111111'                                  0635 02778000
*       END;                                                       0636 02779000
*     FRAMEPTR=FRAMEPTR+4096;       /* INCR @ TO NEXT PAGE           */ 02780000
@RF00630 LH    @14,@CH00139                                        0637 02781000
         AL    @14,FRAMEPTR                                        0637 02782000
         ST    @14,FRAMEPTR                                        0637 02783000
*   END;                                                           0638 02784000
*                                                                  0638 02785000
         LA    @14,1                                               0638 02786000
         AL    @14,RSRSTATP                                        0638 02787000
@DE00629 ST    @14,RSRSTATP                                        0638 02788000
         L     @09,RSRWAP                                          0638 02789000
         SLR   @08,@08                                             0638 02790000
         ICM   @08,3,RSRFRCT(@09)                                  0638 02791000
         L     @09,RSRWAP                                          0638 02792000
         AL    @08,RSRSLP(,@09)                                    0638 02793000
         BCTR  @08,0                                               0638 02794000
         CR    @14,@08                                             0638 02795000
         BNH   @DL00629                                            0638 02796000
*   /*****************************************************************/ 02797000
*   /*                                                               */ 02798000
*   /* VALIDATION DONE. REMOVE SERIALIZATION                         */ 02799000
*   /*                                                               */ 02800000
*   /*****************************************************************/ 02801000
*                                                                  0639 02802000
*   CALL UNSERLZE;                                                 0639 02803000
*                                                                  0639 02804000
         BAL   @14,UNSERLZE                                        0639 02805000
*   /*****************************************************************/ 02806000
*   /*                                                               */ 02807000
*   /* RETURN TO OFFLINE PROCESSOR                                   */ 02808000
*   /*                                                               */ 02809000
*   /*****************************************************************/ 02810000
*                                                                  0640 02811000
*   RETURN;                                                        0640 02812000
@EL00011 DS    0H                                                  0640 02813000
@EF00011 DS    0H                                                  0640 02814000
@ER00011 LM    @14,@12,@SA00011                                    0640 02815000
         BR    @14                                                 0640 02816000
*   END PROCOFF;                                                   0641 02817000
*   END VSTOROFF;                                                  0642 02818000
         B     @EL00006                                            0642 02819000
*                                                                  0643 02820000
*/*      VARY ONLINE PROCESSOR                                       */ 02821000
*/*  GET STATUS OF PAGES IN RANGE TO BE BROUGHT ONLINE.              */ 02822000
*/*  CALL TESTSTAT ROUTINE TO TEST STATUS OF PAGES IN RANGE.         */ 02823000
*/*  IF ALL PAGES IN RANGE NOT ALREADY ONLINE THEN CHECK IF          */ 02824000
*/*  ANY STORAGE ERRORS FOUND.  IF NO ERROR THEN CALL RSR TO BRING   */ 02825000
*/*  ENTIRE RANGE ONLINE.  IF ERRORS WERE FOUND THEN PROMPT          */ 02826000
*/*  OPERATOR FOR ONLINE OPTION AND THEN BRING THE SPECIFIED         */ 02827000
*/*  GOOD SUB RANGES OF STORAGE ONLINE.                              */ 02828000
*/*                                                                  */ 02829000
*                                                                  0643 02830000
*VSTORON:                                                          0643 02831000
*   PROC;                                                          0643 02832000
*                                                                  0643 02833000
VSTORON  STM   @14,@12,@SA00012                                    0643 02834000
*   /*****************************************************************/ 02835000
*   /*                                                               */ 02836000
*   /* WTOR VARIABLES                                                */ 02837000
*   /*                                                               */ 02838000
*   /*****************************************************************/ 02839000
*                                                                  0644 02840000
*   DCL                                                            0644 02841000
*     1 * BDY(WORD),                                               0644 02842000
*      2 WTORECB FIXED,             /* WTOR ECB                      */ 02843000
*      2 WTOREPLY CHAR(1);          /* WTOR REPLY AREA               */ 02844000
*                                                                  0644 02845000
*   /*****************************************************************/ 02846000
*   /*                                                               */ 02847000
*   /* VARIABLES TO SCAN BIT MAP FOR CALLS TO VBLCKON                */ 02848000
*   /*                                                               */ 02849000
*   /*****************************************************************/ 02850000
*                                                                  0645 02851000
*   DCL                                                            0645 02852000
*     PGCOUNT,                      /* NUM OF PAGES IN SUB RANGE     */ 02853000
*     STATPTR,                      /* PTR TO STATUS BYTE            */ 02854000
*     ENDADDR;                      /* END ADDR OF TOTAL RANGE       */ 02855000
*                                                                  0645 02856000
*   /*****************************************************************/ 02857000
*   /*                                                               */ 02858000
*   /* SERIALIZE VARY STORAGE ONLINE WITH ITSELF AND VALIDATION OF   */ 02859000
*   /* OFFLINE STORAGE IN VARY STOR OFFLINE. SERIALIZATION IS        */ 02860000
*   /* REQUIRED TO INSURE THAT ONLY OFFLINE STORAGE WILL BE          */ 02861000
*   /* VALIDATED.                                                    */ 02862000
*   /*                                                               */ 02863000
*   /*****************************************************************/ 02864000
*                                                                  0646 02865000
*   CALL SERIALZE;                                                 0646 02866000
*                                                                  0646 02867000
         BAL   @14,SERIALZE                                        0646 02868000
*   /*****************************************************************/ 02869000
*   /*                                                               */ 02870000
*   /* GET STATUS OF PAGES TO BE BROUGHT ONLINE                      */ 02871000
*   /*                                                               */ 02872000
*   /*****************************************************************/ 02873000
*                                                                  0647 02874000
*   CALL RSRSTAT;                                                  0647 02875000
*                                                                  0647 02876000
         BAL   @14,RSRSTAT                                         0647 02877000
*   /*****************************************************************/ 02878000
*   /*                                                               */ 02879000
*   /* CHECK IF ERROR ENCOUNTERED, IF SO THEN DEQUE OFF RESOURCE AND */ 02880000
*   /* RETURN                                                        */ 02881000
*   /*                                                               */ 02882000
*   /*****************************************************************/ 02883000
*                                                                  0648 02884000
*   IF RC^=0 THEN                                                  0648 02885000
         ICM   @14,15,RC                                           0648 02886000
         BNZ   @RT00648                                            0648 02887000
*     GO TO EXITVSON;               /* EXIT ROUTINE                  */ 02888000
*                                                                  0649 02889000
*   /*****************************************************************/ 02890000
*   /*                                                               */ 02891000
*   /* TEST STATUS OF STORAGE RANGE TO FIND ANY STORAGE ERRORS AND   */ 02892000
*   /* SEE IF ALL STORAGE ALREADY ONLINE                             */ 02893000
*   /*                                                               */ 02894000
*   /*****************************************************************/ 02895000
*                                                                  0650 02896000
*   ALRDON='1'B;                    /* ASSUME ALREADY ONLINE         */ 02897000
*   WTORFLAG='0'B;                  /* ASSUME NO BAD STORAGE         */ 02898000
         OI    ALRDON,B'00100000'                                  0651 02899000
         NI    WTORFLAG,B'11111011'                                0651 02900000
*   CALL TESTSTAT;                  /* TEST STATUS OF PAGES          */ 02901000
*                                                                  0652 02902000
         BAL   @14,TESTSTAT                                        0652 02903000
*   /*****************************************************************/ 02904000
*   /*                                                               */ 02905000
*   /* CHECK IF ROUTINE FAILED IF SO THEN DEQUE OFF RESOURCE AND     */ 02906000
*   /* RETURN                                                        */ 02907000
*   /*                                                               */ 02908000
*   /*****************************************************************/ 02909000
*                                                                  0653 02910000
*   IF RC^=0 THEN                                                  0653 02911000
         ICM   @14,15,RC                                           0653 02912000
         BNZ   @RT00653                                            0653 02913000
*     GO TO EXITVSON;               /* EXIT ROUTINE                  */ 02914000
*                                                                  0654 02915000
*   /*****************************************************************/ 02916000
*   /*                                                               */ 02917000
*   /* CHECK IF ALL STORAGE ALREADY ONLINE, IF SO THEN WRITE ONLINE  */ 02918000
*   /* MESSAGE AND EXIT                                              */ 02919000
*   /*                                                               */ 02920000
*   /*****************************************************************/ 02921000
*                                                                  0655 02922000
*   IF ALRDON='1'B THEN                                            0655 02923000
         TM    ALRDON,B'00100000'                                  0655 02924000
         BNO   @RF00655                                            0655 02925000
*     DO;                                                          0656 02926000
*       CALL WTORTN(1);             /* ONLINE MESSAGE                */ 02927000
         LA    @01,@AL00657                                        0657 02928000
         BAL   @14,WTORTN                                          0657 02929000
*       GO TO EXITVSON;             /* EXIT ROUTINE                  */ 02930000
         B     EXITVSON                                            0658 02931000
*     END;                                                         0659 02932000
*                                                                  0659 02933000
*   /*****************************************************************/ 02934000
*   /*                                                               */ 02935000
*   /* ALL PAGES NOT ONLINE, CHECK IF ANY STORAGE HAS STORAGE ERRORS.*/ 02936000
*   /* IF THERE ARE NO STORAGE ERRORS THEN ENTIRE STORAGE RANGE MAY  */ 02937000
*   /* BE BROUGHT ONLINE WITHOUT PROMPTING THE OPERATOR              */ 02938000
*   /*                                                               */ 02939000
*   /*****************************************************************/ 02940000
*                                                                  0660 02941000
*   IF WTORFLAG='0'B THEN                                          0660 02942000
*                                                                  0660 02943000
@RF00655 TM    WTORFLAG,B'00000100'                                0660 02944000
         BNZ   @RF00660                                            0660 02945000
*     /***************************************************************/ 02946000
*     /*                                                             */ 02947000
*     /* NO OPERATOR PROMPT REQUIRED, BRING ALL STORAGE ONLINE AND GO*/ 02948000
*     /* TO EXIT                                                     */ 02949000
*     /*                                                             */ 02950000
*     /***************************************************************/ 02951000
*                                                                  0661 02952000
*     DO;                                                          0661 02953000
*       CALL VBLCKON;               /* BRING ENTIRE RANGE ONLINE     */ 02954000
         BAL   @14,VBLCKON                                         0662 02955000
*       GO TO EXITVSON;             /* EXIT ROUTINE                  */ 02956000
         B     EXITVSON                                            0663 02957000
*     END;                                                         0664 02958000
*                                                                  0664 02959000
*   /*****************************************************************/ 02960000
*   /*                                                               */ 02961000
*   /* WTORFLAG SET, SOME STORAGE ERRORS WERE FOUND. PROMPT OPERATOR */ 02962000
*   /* AND THEN BRING SPECIFIED STORAGE ONLINE. ALL BAD STORAGE WILL */ 02963000
*   /* REMAIN OFFLINE                                                */ 02964000
*   /*                                                               */ 02965000
*   /*****************************************************************/ 02966000
*                                                                  0665 02967000
*PRMPTOPR:                                                         0665 02968000
*   WTORECB=0;                      /* CLEAR WTOR ECB                */ 02969000
*                                                                  0665 02970000
@RF00660 DS    0H                                                  0665 02971000
PRMPTOPR SLR   @14,@14                                             0665 02972000
         ST    @14,WTORECB                                         0665 02973000
*   /*****************************************************************/ 02974000
*   /*                                                               */ 02975000
*   /* ISSUE WTOR                                                    */ 02976000
*   /*                                                               */ 02977000
*   /*****************************************************************/ 02978000
*                                                                  0666 02979000
*   WTORPL=WTORL;                   /* COPY MASTER COPY INTO WA      */ 02980000
         MVC   WTORPL(69),WTORL                                    0666 02981000
*   R0=CONSOLID;                    /* SET CONSOLE ID                */ 02982000
         SLR   R0,R0                                               0667 02983000
         IC    R0,CONSOLID                                         0667 02984000
*   GEN(WTOR ,WTOREPLY,,WTORECB,MF=(E,WTORPL));                    0668 02985000
         WTOR ,WTOREPLY,,WTORECB,MF=(E,WTORPL)                          02986000
*   DO;                             /* WAIT (1) ECB(WTORECB)         */ 02987000
*     RESPECIFY                                                    0670 02988000
*      (GPR00P,                                                    0670 02989000
*       GPR01P) RESTRICTED;                                        0670 02990000
*     GPR00P=1;                     /* LOAD WAIT COUNT               */ 02991000
         LA    GPR00P,1                                            0671 02992000
*     GPR01P=ADDR(WTORECB);         /* ADDRESS OF ECB                */ 02993000
         LA    GPR01P,WTORECB                                      0672 02994000
*     SVC(1);                       /* WAIT SVC                      */ 02995000
         SVC   1                                                   0673 02996000
*     RESPECIFY                                                    0674 02997000
*      (GPR00P,                                                    0674 02998000
*       GPR01P) UNRESTRICTED;                                      0674 02999000
*   END;                            /* WAIT (1) ECB(WTORECB) WAIT FOR   03000000
*                                      REPLY                         */ 03001000
*                                                                  0675 03002000
*   /*****************************************************************/ 03003000
*   /*                                                               */ 03004000
*   /* CHECK FOR VALID REPLY OF '0','1', OR '2'                      */ 03005000
*   /*                                                               */ 03006000
*   /*****************************************************************/ 03007000
*                                                                  0676 03008000
*   IF^((WTOREPLY>='0')&(WTOREPLY<='2')) THEN                      0676 03009000
         CLI   WTOREPLY,C'0'                                       0676 03010000
         BL    @RT00676                                            0676 03011000
         CLI   WTOREPLY,C'2'                                       0676 03012000
         BH    @RT00676                                            0676 03013000
*     GO TO PRMPTOPR;               /* GO RE- PROMPT OPERATOR        */ 03014000
*                                                                  0677 03015000
*   /*****************************************************************/ 03016000
*   /*                                                               */ 03017000
*   /* PROCESS VALID REPLY. FIRST CHECK IF '2' ENTERED TO CANCEL     */ 03018000
*   /* ONLINE REQUEST                                                */ 03019000
*   /*                                                               */ 03020000
*   /*****************************************************************/ 03021000
*                                                                  0678 03022000
*   IF WTOREPLY='2' THEN                                           0678 03023000
         CLI   WTOREPLY,C'2'                                       0678 03024000
         BE    @RT00678                                            0678 03025000
*     GO TO EXITVSON;               /* CANCEL ENTERED, EXIT          */ 03026000
*                                                                  0679 03027000
*   /*****************************************************************/ 03028000
*   /*                                                               */ 03029000
*   /* CONTINUE PROCESSING ONLINE COMMAND. SINCE THE SUBRANGES OF    */ 03030000
*   /* STORAGE MAY BE IN UNITS SMALLER THAN 1 MEG UNITS, FOLD MEG    */ 03031000
*   /* UNITS TO K UNITS FOR ONLINE MESSAGES                          */ 03032000
*   /*                                                               */ 03033000
*   /*****************************************************************/ 03034000
*                                                                  0680 03035000
*   IF DECMA='1'B THEN                                             0680 03036000
         TM    DECMA,B'10000000'                                   0680 03037000
         BNO   @RF00680                                            0680 03038000
*     DO;                                                          0681 03039000
*       DECKA='1'B;                 /* SET K UNITS FLAG              */ 03040000
*       DECMA='0'B;                 /* CLEAR M UNITS FLAG            */ 03041000
         OI    DECKA,B'01000000'                                   0683 03042000
         NI    DECMA,B'01111111'                                   0683 03043000
*     END;                                                         0684 03044000
*                                                                  0684 03045000
*   /*****************************************************************/ 03046000
*   /*                                                               */ 03047000
*   /* CHECK IF '0' ENTERED REQUESTING THAT STORAGE SCHEDULED TO GO  */ 03048000
*   /* OFFLINE DUE TO STORAGE ERROR BE BROUGHT ONLINE ALONG WITH GOOD*/ 03049000
*   /* STORAGE. A REPLY OF '1' REQUESTS THAT ONLY GOOD STORAGE BE    */ 03050000
*   /* BROUGHT ONLINE                                                */ 03051000
*   /*                                                               */ 03052000
*   /*****************************************************************/ 03053000
*                                                                  0685 03054000
*   IF WTOREPLY='0' THEN                                           0685 03055000
*                                                                  0685 03056000
@RF00680 CLI   WTOREPLY,C'0'                                       0685 03057000
         BNE   @RF00685                                            0685 03058000
*     /***************************************************************/ 03059000
*     /*                                                             */ 03060000
*     /* SCAN STATUS MAP AND CLEAR STOR ERROR BIT IN STATUS BYTE FOR */ 03061000
*     /* ALL PAGES SCHEDULED TO GO OFFLINE DUE TO STORAGE ERROR      */ 03062000
*     /*                                                             */ 03063000
*     /***************************************************************/ 03064000
*                                                                  0686 03065000
*     DO RSRSTATP=RSRSLP TO RSRSLP+RSRFRCT-1;                      0686 03066000
*                                                                  0686 03067000
         L     @14,RSRWAP                                          0686 03068000
         L     @14,RSRSLP(,@14)                                    0686 03069000
         B     @DE00686                                            0686 03070000
@DL00686 DS    0H                                                  0687 03071000
*       /*************************************************************/ 03072000
*       /*                                                           */ 03073000
*       /* TEST IF SCHEDULED TO GO OFFLINE DUE TO ERROR              */ 03074000
*       /*                                                           */ 03075000
*       /*************************************************************/ 03076000
*                                                                  0687 03077000
*       IF(POFFLN='1'B)&(PINTRCP='1'B)&(PSTORERR='1'B) THEN        0687 03078000
         TM    POFFLN(@14),B'11100000'                             0687 03079000
         BNO   @RF00687                                            0687 03080000
*         PSTORERR='0'B;            /* CLEAR ERROR BIT               */ 03081000
         NI    PSTORERR(@14),B'11011111'                           0688 03082000
*     END;                                                         0689 03083000
*                                                                  0689 03084000
@RF00687 LA    @14,1                                               0689 03085000
         AL    @14,RSRSTATP                                        0689 03086000
@DE00686 ST    @14,RSRSTATP                                        0689 03087000
         L     @09,RSRWAP                                          0689 03088000
         SLR   @08,@08                                             0689 03089000
         ICM   @08,3,RSRFRCT(@09)                                  0689 03090000
         L     @09,RSRWAP                                          0689 03091000
         AL    @08,RSRSLP(,@09)                                    0689 03092000
         BCTR  @08,0                                               0689 03093000
         CR    @14,@08                                             0689 03094000
         BNH   @DL00686                                            0689 03095000
*   /*****************************************************************/ 03096000
*   /*                                                               */ 03097000
*   /* SCAN STATUS BUFFER AND ISOLATE EACH SUB RANGE OF GOOD STORAGE */ 03098000
*   /* AS DEFINED BY STORAGE ERROR BIT IN PAGES'S STATUS BYTE BEING  */ 03099000
*   /* SET OFF. AFTER EACH SUB RANGE IS ISOLATED THEN CALL RSR ONLINE*/ 03100000
*   /* TO BRING THE SUB RANGE ONLINE                                 */ 03101000
*   /*                                                               */ 03102000
*   /*****************************************************************/ 03103000
*                                                                  0690 03104000
*   ENDADDR=ERANGE;                 /* SAVE @ END TOTAL RANGE        */ 03105000
@RF00685 L     ENDADDR,ERANGE                                      0690 03106000
*   FRAMEPTR=SRANGE;                /* INIT @ OF FIRST 4K PAGE       */ 03107000
         MVC   FRAMEPTR(4),SRANGE                                  0691 03108000
*   STATPTR=RSRSLP;                 /* INIT @ OF FIRST STATUS BYTE   */ 03109000
*                                                                  0692 03110000
         L     @14,RSRWAP                                          0692 03111000
         L     STATPTR,RSRSLP(,@14)                                0692 03112000
*   /*****************************************************************/ 03113000
*   /*                                                               */ 03114000
*   /* SCAN ENTIRE STORAGE RANGE                                     */ 03115000
*   /*                                                               */ 03116000
*   /*****************************************************************/ 03117000
*                                                                  0693 03118000
*   DO WHILE(FRAMEPTR<ENDADDR);                                    0693 03119000
*                                                                  0693 03120000
         B     @DE00693                                            0693 03121000
@DL00693 DS    0H                                                  0694 03122000
*     /***************************************************************/ 03123000
*     /*                                                             */ 03124000
*     /* SKIP OVER BAD STORAGE TO START OF GOOD SUB RANGE            */ 03125000
*     /*                                                             */ 03126000
*     /***************************************************************/ 03127000
*                                                                  0694 03128000
*     DO WHILE((STATPTR->PSTORERR='1'B)&(FRAMEPTR<ENDADDR));       0694 03129000
         B     @DE00694                                            0694 03130000
@DL00694 DS    0H                                                  0695 03131000
*       FRAMEPTR=FRAMEPTR+4096;     /* INCR TO NEXT PAGE             */ 03132000
         LH    @14,@CH00139                                        0695 03133000
         AL    @14,FRAMEPTR                                        0695 03134000
         ST    @14,FRAMEPTR                                        0695 03135000
*       STATPTR=STATPTR+1;          /* INCR STATUS BYTE PTR          */ 03136000
         AL    STATPTR,@CF00066                                    0696 03137000
*     END;                                                         0697 03138000
*                                                                  0697 03139000
@DE00694 TM    PSTORERR(STATPTR),B'00100000'                       0697 03140000
         BNO   @DC00694                                            0697 03141000
         C     ENDADDR,FRAMEPTR                                    0697 03142000
         BH    @DL00694                                            0697 03143000
@DC00694 DS    0H                                                  0698 03144000
*     /***************************************************************/ 03145000
*     /*                                                             */ 03146000
*     /* ISOLATE SUB RANGE OF GOOD STORAGE                           */ 03147000
*     /*                                                             */ 03148000
*     /***************************************************************/ 03149000
*                                                                  0698 03150000
*     SRANGE=FRAMEPTR;              /* SAVE START OF SUB RANGE       */ 03151000
         MVC   SRANGE(4),FRAMEPTR                                  0698 03152000
*     PGCOUNT=0;                    /* INIT SIZE OF SUB RANGE        */ 03153000
*                                                                  0699 03154000
         SLR   PGCOUNT,PGCOUNT                                     0699 03155000
*     /***************************************************************/ 03156000
*     /*                                                             */ 03157000
*     /* SCAN UNTIL END OF GOOD SUB RANGE                            */ 03158000
*     /*                                                             */ 03159000
*     /***************************************************************/ 03160000
*                                                                  0700 03161000
*     DO WHILE((STATPTR->PSTORERR='0'B)&(FRAMEPTR<ENDADDR));       0700 03162000
         B     @DE00700                                            0700 03163000
@DL00700 DS    0H                                                  0701 03164000
*       FRAMEPTR=FRAMEPTR+4096;     /* INCR TO NEXT PAGE             */ 03165000
         LH    @14,@CH00139                                        0701 03166000
         AL    @14,FRAMEPTR                                        0701 03167000
         ST    @14,FRAMEPTR                                        0701 03168000
*       STATPTR=STATPTR+1;          /* INCR STATUS BYTE PTR          */ 03169000
         LA    @14,1                                               0702 03170000
         ALR   STATPTR,@14                                         0702 03171000
*       PGCOUNT=PGCOUNT+1;          /* INCR SIZE OF SUB RANGE        */ 03172000
         ALR   PGCOUNT,@14                                         0703 03173000
*     END;                                                         0704 03174000
*                                                                  0704 03175000
@DE00700 TM    PSTORERR(STATPTR),B'00100000'                       0704 03176000
         BNZ   @DC00700                                            0704 03177000
         C     ENDADDR,FRAMEPTR                                    0704 03178000
         BH    @DL00700                                            0704 03179000
@DC00700 DS    0H                                                  0705 03180000
*     /***************************************************************/ 03181000
*     /*                                                             */ 03182000
*     /* BRING SUB RANGE OF GOOD STORAGE ONLINE IF IT NOT EMPTY      */ 03183000
*     /*                                                             */ 03184000
*     /***************************************************************/ 03185000
*                                                                  0705 03186000
*     IF PGCOUNT>0 THEN                                            0705 03187000
         LTR   PGCOUNT,PGCOUNT                                     0705 03188000
         BNP   @RF00705                                            0705 03189000
*       DO;                                                        0706 03190000
*         ERANGE=FRAMEPTR;          /* SET END OF SUB RANGE          */ 03191000
         MVC   ERANGE(4),FRAMEPTR                                  0707 03192000
*         CALL VBLCKON;             /* BRING SUB RANGE OF STORAGE  0708 03193000
*                                      ONLINE                        */ 03194000
         BAL   @14,VBLCKON                                         0708 03195000
*       END;                                                       0709 03196000
*   END;                            /* GO ISOLATE NEXT GOOD SUB RANGE*/ 03197000
*                                                                  0710 03198000
@RF00705 DS    0H                                                  0710 03199000
@DE00693 C     ENDADDR,FRAMEPTR                                    0710 03200000
         BH    @DL00693                                            0710 03201000
*   /*****************************************************************/ 03202000
*   /*                                                               */ 03203000
*   /* EXIT CODE FOR VSTORON. DEQUE OFF RESOURCE AND RETURN TO       */ 03204000
*   /* MAINLINE                                                      */ 03205000
*   /*                                                               */ 03206000
*   /*****************************************************************/ 03207000
*                                                                  0711 03208000
*EXITVSON:                                                         0711 03209000
*   CALL UNSERLZE;                                                 0711 03210000
EXITVSON BAL   @14,UNSERLZE                                        0711 03211000
*   RETURN;                         /* RETURN TO MAINLINE            */ 03212000
@EL00012 DS    0H                                                  0712 03213000
@EF00012 DS    0H                                                  0712 03214000
@ER00012 LM    @14,@12,@SA00012                                    0712 03215000
         BR    @14                                                 0712 03216000
*                                                                  0713 03217000
*   /*****************************************************************/ 03218000
*   /*                                                               */ 03219000
*   /* TEST STATUS OF STORAGE TO BE BROUGHT ONLINE. TEST IF ANY      */ 03220000
*   /* STORAGE ERRORS AND ALSO CHECK IF ALL STORAGE IS ALREADY ONLINE*/ 03221000
*   /*                                                               */ 03222000
*   /*****************************************************************/ 03223000
*                                                                  0713 03224000
*TESTSTAT:                                                         0713 03225000
*   PROC;                                                          0713 03226000
TESTSTAT STM   @14,@12,@SA00013                                    0713 03227000
*   RC=0;                           /* SET GOOD RETURN CODE          */ 03228000
*                                                                  0714 03229000
         SLR   @14,@14                                             0714 03230000
         ST    @14,RC                                              0714 03231000
*   /*****************************************************************/ 03232000
*   /*                                                               */ 03233000
*   /* CANCEL PREVIOUS OFFLINE REQUEST IF ONLINE RANGE EXACTLY       */ 03234000
*   /* OVERLAPS OFFLINE RANGE. IF ONLINE REQUEST CAUSES IMPERFECT    */ 03235000
*   /* OVERLAP WITH AN ACTIVE OFFLINE REQUEST THEN REJECT ONLINE     */ 03236000
*   /* REQUEST                                                       */ 03237000
*   /*                                                               */ 03238000
*   /*****************************************************************/ 03239000
*                                                                  0715 03240000
*   RSROPTNS='';                    /* CLEAR OPTIONS FIELD           */ 03241000
         L     @14,RSRWAP                                          0715 03242000
         MVI   RSROPTNS(@14),X'00'                                 0715 03243000
*   RSRCANCL='1'B;                  /* REQUEST CANCEL FUNC           */ 03244000
         OI    RSRCANCL(@14),B'00000001'                           0716 03245000
*   R1=RSRWAP;                      /* SET @ RSR PARM LIST           */ 03246000
         LR    R1,@14                                              0717 03247000
*   CALL RSR;                       /* CANCEL PEND OFFLINE           */ 03248000
*                                                                  0718 03249000
         L     @14,CVTPTR                                          0718 03250000
         L     @14,PVTPTR(,@14)                                    0718 03251000
         L     @15,PVTPRCF(,@14)                                   0718 03252000
         BALR  @14,@15                                             0718 03253000
*   /*****************************************************************/ 03254000
*   /*                                                               */ 03255000
*   /* CHECK IF INVALID OVERLAP FOUND, IF SO WRITE ERROR MESSAGE AND */ 03256000
*   /* EXIT                                                          */ 03257000
*   /*                                                               */ 03258000
*   /*****************************************************************/ 03259000
*                                                                  0719 03260000
*   IF R15=16 THEN                                                 0719 03261000
         CH    R15,@CH00064                                        0719 03262000
         BNE   @RF00719                                            0719 03263000
*     DO;                                                          0720 03264000
*       CALL WTORTN(3);             /* INVALID OVERLAP MSG           */ 03265000
         LA    @01,@AL00721                                        0721 03266000
         BAL   @14,WTORTN                                          0721 03267000
*       RC=4;                       /* SET ERROR RC                  */ 03268000
         MVC   RC(4),@CF00165                                      0722 03269000
*       RETURN;                     /* RETURN TO CALLER              */ 03270000
@EL00013 DS    0H                                                  0723 03271000
@EF00013 DS    0H                                                  0723 03272000
@ER00013 LM    @14,@12,@SA00013                                    0723 03273000
         BR    @14                                                 0723 03274000
*     END;                                                         0724 03275000
*                                                                  0724 03276000
*   /*****************************************************************/ 03277000
*   /*                                                               */ 03278000
*   /* RANGE CLEARED OF PENDING OFFLINE REQUESTS IF ANY EXISTED. TEST*/ 03279000
*   /* STATUS OF STORAGE RANGE. STATUS BITS SET BY RSR STATUS CALL   */ 03280000
*   /* AND NOT MODIFIED BY RSR CANCEL CALL                           */ 03281000
*   /*                                                               */ 03282000
*   /*****************************************************************/ 03283000
*                                                                  0725 03284000
*   FRAMEPTR=SRANGE;                /* SET @ OF FIRST 4K PAGE        */ 03285000
*                                                                  0725 03286000
@RF00719 MVC   FRAMEPTR(4),SRANGE                                  0725 03287000
*   /*****************************************************************/ 03288000
*   /*                                                               */ 03289000
*   /* TEST STATUS OF EACH 4K PAGE BY SCANING STATUS BUFFER          */ 03290000
*   /*                                                               */ 03291000
*   /*****************************************************************/ 03292000
*                                                                  0726 03293000
*   DO RSRSTATP=RSRSLP TO RSRSLP+RSRFRCT-1;                        0726 03294000
*                                                                  0726 03295000
         L     @14,RSRWAP                                          0726 03296000
         L     @14,RSRSLP(,@14)                                    0726 03297000
         B     @DE00726                                            0726 03298000
@DL00726 DS    0H                                                  0727 03299000
*     /***************************************************************/ 03300000
*     /*                                                             */ 03301000
*     /* TEST IF PAGE IS NOT ONLINE IF SO THEN CLEAR ALREADY ONLINE  */ 03302000
*     /* FLAG                                                        */ 03303000
*     /*                                                             */ 03304000
*     /***************************************************************/ 03305000
*                                                                  0727 03306000
*     IF POFFLN='1'B THEN                                          0727 03307000
         TM    POFFLN(@14),B'10000000'                             0727 03308000
         BNO   @RF00727                                            0727 03309000
*       ALRDON='0'B;                /* CLEAR ALREADY ONLINE FLG      */ 03310000
*                                                                  0728 03311000
         NI    ALRDON,B'11011111'                                  0728 03312000
*     /***************************************************************/ 03313000
*     /*                                                             */ 03314000
*     /* TEST PAGE FOR STORAGE ERROR. IF OFFLINE THEN CALL VALIDATE  */ 03315000
*     /* ROUTINE TO ZERO PAGE AND SET STORAGE KEY = 0. IF ANY OFFLINE*/ 03316000
*     /* PAGE FAILS DURING VALIDATION OR IS FOUND TO BE SCHEDULED TO */ 03317000
*     /* GO OFFLINE DUE TO STORAGE ERROR THEN SET STORAGE ERROR BIT  */ 03318000
*     /* IN PAGES'S STATUS BYTE AND SET WTORFLAG SO THAT OPERATOR    */ 03319000
*     /* WILL BE PROMPTED AFTER ALL STORAGE IS TESTED                */ 03320000
*     /*                                                             */ 03321000
*     /***************************************************************/ 03322000
*                                                                  0729 03323000
*     IF(POFFLN='1'B)&(PINTRCP='0'B) THEN                          0729 03324000
*                                                                  0729 03325000
@RF00727 L     @14,RSRSTATP                                        0729 03326000
         TM    POFFLN(@14),B'10000000'                             0729 03327000
         BNO   @RF00729                                            0729 03328000
         TM    PINTRCP(@14),B'01000000'                            0729 03329000
         BNZ   @RF00729                                            0729 03330000
*       /*************************************************************/ 03331000
*       /*                                                           */ 03332000
*       /* VALIDATE PAGE WHICH IS ALREADY OFFLINE                    */ 03333000
*       /*                                                           */ 03334000
*       /*************************************************************/ 03335000
*                                                                  0730 03336000
*       DO;                                                        0730 03337000
*         PSTORERR='0'B;            /* CLEAR STOR ERROR BIT          */ 03338000
         NI    PSTORERR(@14),B'11011111'                           0731 03339000
*         VALFC=1;                  /* SET ONLINE FUNC FLAG          */ 03340000
         MVC   VALFC(4),@CF00066                                   0732 03341000
*         CALL IEEVALST(VALFC,FRAMEPTR,VALFRA);/* VALIDATE PAGE      */ 03342000
         LA    @14,VALFC                                           0733 03343000
         ST    @14,@AL00001                                        0733 03344000
         LA    @14,FRAMEPTR                                        0733 03345000
         ST    @14,@AL00001+4                                      0733 03346000
         LA    @14,VALFRA                                          0733 03347000
         ST    @14,@AL00001+8                                      0733 03348000
         L     @15,@CV00128                                        0733 03349000
         LA    @01,@AL00001                                        0733 03350000
         BALR  @14,@15                                             0733 03351000
*       END;                                                       0734 03352000
*                                                                  0734 03353000
*     /***************************************************************/ 03354000
*     /*                                                             */ 03355000
*     /* SKIP VALIDATION, CHECK STATUS IN MAP                        */ 03356000
*     /*                                                             */ 03357000
*     /***************************************************************/ 03358000
*                                                                  0735 03359000
*     ELSE                                                         0735 03360000
*                                                                  0735 03361000
*       /*************************************************************/ 03362000
*       /*                                                           */ 03363000
*       /* CHECK IF PAGE IS SCHEDULED TO GO OFFLINE DUE TO STORAGE   */ 03364000
*       /* ERROR. IF SO THEN WRITE INFORMATIONAL MESSAGE AND SET WTOR*/ 03365000
*       /* FLAG                                                      */ 03366000
*       /*                                                           */ 03367000
*       /*************************************************************/ 03368000
*                                                                  0735 03369000
*       IF(POFFLN='1'B)&(PINTRCP='1'B)&(PSTORERR='1'B) THEN        0735 03370000
         B     @RC00729                                            0735 03371000
@RF00729 L     @14,RSRSTATP                                        0735 03372000
         TM    POFFLN(@14),B'11100000'                             0735 03373000
         BNO   @RF00735                                            0735 03374000
*         DO;                                                      0736 03375000
*           CALL WTORTN(4);         /* WRITE PEND OFFLINE STOR ERROR    03376000
*                                      MSG                           */ 03377000
         LA    @01,@AL00737                                        0737 03378000
         BAL   @14,WTORTN                                          0737 03379000
*           WTORFLAG='1'B;          /* SET PROMPT OPER FLAG          */ 03380000
         OI    WTORFLAG,B'00000100'                                0738 03381000
*         END;                                                     0739 03382000
*                                                                  0739 03383000
*     /***************************************************************/ 03384000
*     /*                                                             */ 03385000
*     /* IF NO POSSIBLE STORAGE ERROR THEN CLEAR STOR ERROR FLAG     */ 03386000
*     /*                                                             */ 03387000
*     /***************************************************************/ 03388000
*                                                                  0740 03389000
*       ELSE                                                       0740 03390000
*         PSTORERR='0'B;            /* CLEAR STOR ERROR BIT          */ 03391000
         B     @RC00735                                            0740 03392000
@RF00735 L     @14,RSRSTATP                                        0740 03393000
         NI    PSTORERR(@14),B'11011111'                           0740 03394000
*     FRAMEPTR=FRAMEPTR+4096;       /* INCR TO NEXT PAGE             */ 03395000
@RC00735 DS    0H                                                  0741 03396000
@RC00729 LH    @14,@CH00139                                        0741 03397000
         AL    @14,FRAMEPTR                                        0741 03398000
         ST    @14,FRAMEPTR                                        0741 03399000
*   END;                            /* GO TEST NEXT PAGE             */ 03400000
*                                                                  0742 03401000
         LA    @14,1                                               0742 03402000
         AL    @14,RSRSTATP                                        0742 03403000
@DE00726 ST    @14,RSRSTATP                                        0742 03404000
         L     @09,RSRWAP                                          0742 03405000
         SLR   @08,@08                                             0742 03406000
         ICM   @08,3,RSRFRCT(@09)                                  0742 03407000
         L     @09,RSRWAP                                          0742 03408000
         AL    @08,RSRSLP(,@09)                                    0742 03409000
         BCTR  @08,0                                               0742 03410000
         CR    @14,@08                                             0742 03411000
         BNH   @DL00726                                            0742 03412000
*   /*****************************************************************/ 03413000
*   /*                                                               */ 03414000
*   /* RETURN TO VSTORON                                             */ 03415000
*   /*                                                               */ 03416000
*   /*****************************************************************/ 03417000
*                                                                  0743 03418000
*   RETURN;                                                        0743 03419000
         B     @EL00013                                            0743 03420000
*   END TESTSTAT;                                                  0744 03421000
*                                                                  0745 03422000
*   /*****************************************************************/ 03423000
*   /*                                                               */ 03424000
*   /* VARY BLOCK OF STORAGE ONLINE FROM SRANGE TO ERANGE            */ 03425000
*   /*                                                               */ 03426000
*   /*****************************************************************/ 03427000
*                                                                  0745 03428000
*VBLCKON:                                                          0745 03429000
*   PROC;                                                          0745 03430000
VBLCKON  STM   @14,@12,@SA00014                                    0745 03431000
*   RSROPTNS='';                    /* CLEAR OPTION FIELD            */ 03432000
         L     @14,RSRWAP                                          0746 03433000
         MVI   RSROPTNS(@14),X'00'                                 0746 03434000
*   RSRONLN='1'B;                   /* SET ONLINE OPTION             */ 03435000
         OI    RSRONLN(@14),B'10000000'                            0747 03436000
*   RSRSTRBN=(SRANGE/4096)*16;      /* SET START ADDR IN THE FORM  0748 03437000
*                                      SSP0                          */ 03438000
         L     @09,SRANGE                                          0748 03439000
         LH    @08,@CH00139                                        0748 03440000
         LR    @02,@09                                             0748 03441000
         SRDA  @02,32                                              0748 03442000
         DR    @02,@08                                             0748 03443000
         SLA   @03,4                                               0748 03444000
         STH   @03,RSRSTRBN(,@14)                                  0748 03445000
*   RSRFRCT=(ERANGE-SRANGE)/4096;   /* NUM OF PAGES                  */ 03446000
         LR    @02,@09                                             0749 03447000
         LCR   @02,@02                                             0749 03448000
         AL    @02,ERANGE                                          0749 03449000
         SRDA  @02,32                                              0749 03450000
         DR    @02,@08                                             0749 03451000
         STH   @03,RSRFRCT(,@14)                                   0749 03452000
*   DO RSRSTATP=RSRSLP TO RSRSLP+RSRFRCT-1;/* ZERO STATUS BUFFER     */ 03453000
         L     @14,RSRSLP(,@14)                                    0750 03454000
         B     @DE00750                                            0750 03455000
@DL00750 DS    0H                                                  0751 03456000
*     RSRSTAT2=''B;                                                0751 03457000
         MVI   RSRSTAT2(@14),X'00'                                 0751 03458000
*   END;                                                           0752 03459000
         AL    @14,@CF00066                                        0752 03460000
@DE00750 ST    @14,RSRSTATP                                        0752 03461000
         L     @09,RSRWAP                                          0752 03462000
         SLR   @08,@08                                             0752 03463000
         ICM   @08,3,RSRFRCT(@09)                                  0752 03464000
         L     @09,RSRWAP                                          0752 03465000
         AL    @08,RSRSLP(,@09)                                    0752 03466000
         BCTR  @08,0                                               0752 03467000
         CR    @14,@08                                             0752 03468000
         BNH   @DL00750                                            0752 03469000
*   R1=RSRWAP;                      /* SET @ RSR PARM LIST           */ 03470000
*                                                                  0753 03471000
         L     R1,RSRWAP                                           0753 03472000
*   /*****************************************************************/ 03473000
*   /*                                                               */ 03474000
*   /* CALL RSR ONLINE                                               */ 03475000
*   /*                                                               */ 03476000
*   /*****************************************************************/ 03477000
*                                                                  0754 03478000
*   CALL RSR;                                                      0754 03479000
*                                                                  0754 03480000
         L     @14,CVTPTR                                          0754 03481000
         L     @14,PVTPTR(,@14)                                    0754 03482000
         L     @15,PVTPRCF(,@14)                                   0754 03483000
         BALR  @14,@15                                             0754 03484000
*   /*****************************************************************/ 03485000
*   /*                                                               */ 03486000
*   /* CHECK RSR RETURN CODE IN REG 15 AND DO APPROPIATE PROCESSING  */ 03487000
*   /*                                                               */ 03488000
*   /*****************************************************************/ 03489000
*                                                                  0755 03490000
*   IF R15=0 THEN                                                  0755 03491000
*                                                                  0755 03492000
         LTR   R15,R15                                             0755 03493000
         BNZ   @RF00755                                            0755 03494000
*     /***************************************************************/ 03495000
*     /*                                                             */ 03496000
*     /* ONLINE PROCESSING SUCCESSFUL                                */ 03497000
*     /*                                                             */ 03498000
*     /***************************************************************/ 03499000
*                                                                  0756 03500000
*     DO;                                                          0756 03501000
*       CALL STORSMF;               /* WRITE ONLINE SMF RCRD         */ 03502000
         BAL   @14,STORSMF                                         0757 03503000
*       CALL WTORTN(1);             /* WRITE ONLINE MSG              */ 03504000
         LA    @01,@AL00758                                        0758 03505000
         BAL   @14,WTORTN                                          0758 03506000
*     END;                                                         0759 03507000
*                                                                  0759 03508000
*   /*****************************************************************/ 03509000
*   /*                                                               */ 03510000
*   /* TEST IF INVALID OVERLAP                                       */ 03511000
*   /*                                                               */ 03512000
*   /*****************************************************************/ 03513000
*                                                                  0760 03514000
*   ELSE                                                           0760 03515000
*     IF R15=16 THEN                /* R15=16?                       */ 03516000
*                                                                  0760 03517000
         B     @RC00755                                            0760 03518000
@RF00755 CH    R15,@CH00064                                        0760 03519000
         BNE   @RF00760                                            0760 03520000
*       /*************************************************************/ 03521000
*       /*                                                           */ 03522000
*       /* INVALID OVERLAP. UNDER NORMAL CONDITIONS THIS CONDITION   */ 03523000
*       /* SHOULD NEVER OCCUR BECAUSE THE ENTIRE RANGE HAS ALREADY   */ 03524000
*       /* BEEN CLEARED OF POSSIBLE INVALID OVERLAPS WITH PENDING    */ 03525000
*       /* OFFLINE REQUESTS                                          */ 03526000
*       /*                                                           */ 03527000
*       /*************************************************************/ 03528000
*                                                                  0761 03529000
*       CALL WTORTN(3);             /* INVALID OVERLAP MSG           */ 03530000
*                                                                  0761 03531000
         LA    @01,@AL00761                                        0761 03532000
         BAL   @14,WTORTN                                          0761 03533000
*   /*****************************************************************/ 03534000
*   /*                                                               */ 03535000
*   /* BAD RETURN CODE FROM RSR. SCHEDULE INTERNAL ABEND             */ 03536000
*   /*                                                               */ 03537000
*   /*****************************************************************/ 03538000
*                                                                  0762 03539000
*     ELSE                                                         0762 03540000
*       DO;                                                        0762 03541000
         B     @RC00760                                            0762 03542000
@RF00760 DS    0H                                                  0763 03543000
*         INTERROR=R15;             /* SAVE ERROR CODE               */ 03544000
         ST    R15,INTERROR                                        0763 03545000
*         DO;                       /* ABEND(183) SYSTEM             */ 03546000
*           RESPECIFY                                              0765 03547000
*            (GPR01F) RESTRICTED;                                  0765 03548000
*           GPR01F=((183)&'00000FFF'X)*4096;/* COMP CODE IN BITS 8-19*/ 03549000
         L     GPR01F,@CF02885                                     0766 03550000
*           SVC(13);                /* ISSUE ABEND SVC               */ 03551000
         SVC   13                                                  0767 03552000
*           RESPECIFY                                              0768 03553000
*            (GPR01F) UNRESTRICTED;                                0768 03554000
*         END;                      /* ABEND(183) SYSTEM EXIT THRU 0769 03555000
*                                      ESTAE                 @YM03534*/ 03556000
*       END;                                                       0770 03557000
*                                                                  0770 03558000
*   /*****************************************************************/ 03559000
*   /*                                                               */ 03560000
*   /* RETURN TO VSTORON                                             */ 03561000
*   /*                                                               */ 03562000
*   /*****************************************************************/ 03563000
*                                                                  0771 03564000
*   RETURN;                                                        0771 03565000
@EL00014 DS    0H                                                  0771 03566000
@EF00014 DS    0H                                                  0771 03567000
@ER00014 LM    @14,@12,@SA00014                                    0771 03568000
         BR    @14                                                 0771 03569000
*   END VBLCKON;                                                   0772 03570000
         B     @EL00014                                            0772 03571000
*   END VSTORON;                                                   0773 03572000
*                                                                  0774 03573000
*   /*****************************************************************/ 03574000
*   /*                                                               */ 03575000
*   /* START OF RSRSTAT ROUTINE TO GET STATUS OF ALL PAGES WITHIN THE*/ 03576000
*   /* REQUESTED RANGE OF STORAGE                                    */ 03577000
*   /*                                                               */ 03578000
*   /*****************************************************************/ 03579000
*                                                                  0774 03580000
*RSRSTAT:                                                          0774 03581000
*   PROC;                                                          0774 03582000
RSRSTAT  STM   @14,@12,@SA00015                                    0774 03583000
*   RC=0;                           /* SET GOOD RETURN CODE          */ 03584000
*                                                                  0775 03585000
         SLR   @14,@14                                             0775 03586000
         ST    @14,RC                                              0775 03587000
*   /*****************************************************************/ 03588000
*   /*                                                               */ 03589000
*   /* ALLOCATE RSR WORKAREA IF NOT ALREADY ALLOCATED                */ 03590000
*   /*                                                               */ 03591000
*   /*****************************************************************/ 03592000
*                                                                  0776 03593000
*   IF RSRWAP=0 THEN                                               0776 03594000
         C     @14,RSRWAP                                          0776 03595000
         BNE   @RF00776                                            0776 03596000
*     DO;                                                          0777 03597000
*       RSRWAL=LENGTH(RSRPARML)+((ERANGE-SRANGE)/4096);/* CALC LENGTH   03598000
*                                      / OF RSR WORKAREA             */ 03599000
*                                                                  0778 03600000
         L     @02,ERANGE                                          0778 03601000
         SL    @02,SRANGE                                          0778 03602000
         SRDA  @02,32                                              0778 03603000
         D     @02,@CF00139                                        0778 03604000
         AH    @03,@CH02856                                        0778 03605000
         ST    @03,RSRWAL                                          0778 03606000
*       /*************************************************************/ 03607000
*       /*                                                           */ 03608000
*       /* GET RSR WORKAREA FROM LSQA                                */ 03609000
*       /*                                                           */ 03610000
*       /*************************************************************/ 03611000
*                                                                  0779 03612000
*       DO;                         /* GETMAIN (RC) LV(RSRWAL)     0779 03613000
*                                      SP(253)                       */ 03614000
*         RESPECIFY                                                0780 03615000
*          (GPR01F,                                                0780 03616000
*           GPR15F,                                                0780 03617000
*           GPR00F) RESTRICTED;                                    0780 03618000
*         GPR01F=0;                 /* REG 1 MUST BE ZERO            */ 03619000
         SLR   GPR01F,GPR01F                                       0781 03620000
*         GPR15F=0;                 /* RC-TYPE GETMAIN               */ 03621000
         SLR   GPR15F,GPR15F                                       0782 03622000
*         GPR00F=RSRWAL;            /* LENGTH REQUESTED              */ 03623000
         L     GPR00F,RSRWAL                                       0783 03624000
*         GPR15F=GPR15F|((253)*256);/* SP IN BYTE 2                  */ 03625000
         O     GPR15F,@CF02888                                     0784 03626000
*         SVC(120);                 /* RC/RU-FORM OF GETMAIN         */ 03627000
         SVC   120                                                 0785 03628000
*         RESPECIFY                                                0786 03629000
*          (GPR01F,                                                0786 03630000
*           GPR15F,                                                0786 03631000
*           GPR00F) UNRESTRICTED;                                  0786 03632000
*       END;                        /* GETMAIN (RC) LV(RSRWAL)     0787 03633000
*                                      SP(253)                       */ 03634000
*                                                                  0787 03635000
*       /*************************************************************/ 03636000
*       /*                                                           */ 03637000
*       /* CHECK IF GETMAIN FAILED, IF SO THEN WRITE ERROR MESSAGE,  */ 03638000
*       /* SET ERROR RC AND RETURN                                   */ 03639000
*       /*                                                           */ 03640000
*       /*************************************************************/ 03641000
*                                                                  0788 03642000
*       IF R15^=0 THEN                                             0788 03643000
         LTR   R15,R15                                             0788 03644000
         BZ    @RF00788                                            0788 03645000
*         DO;                                                      0789 03646000
*           CALL WTORTN(6);         /* WORKING STORAGE NOT AVAIL     */ 03647000
         LA    @01,@AL00790                                        0790 03648000
         BAL   @14,WTORTN                                          0790 03649000
*           RC=4;                   /* SET ERROR RETURN CODE         */ 03650000
         MVC   RC(4),@CF00165                                      0791 03651000
*           RETURN;                 /* RETURN TO CALLER              */ 03652000
@EL00015 DS    0H                                                  0792 03653000
@EF00015 DS    0H                                                  0792 03654000
@ER00015 LM    @14,@12,@SA00015                                    0792 03655000
         BR    @14                                                 0792 03656000
*         END;                                                     0793 03657000
*       RSRWAP=R1;                  /* SAVE PTR TO GOOD RSR WA       */ 03658000
@RF00788 ST    R1,RSRWAP                                           0794 03659000
*     END;                                                         0795 03660000
*                                                                  0795 03661000
*   /*****************************************************************/ 03662000
*   /*                                                               */ 03663000
*   /* SET UP WORKAREA AND ISSUE CALL TO RSR TO GET STATUS           */ 03664000
*   /*                                                               */ 03665000
*   /*****************************************************************/ 03666000
*                                                                  0796 03667000
*   DO RSRSTATP=RSRWAP TO RSRWAP+RSRWAL-1;/* FOR EACH WA BYTE        */ 03668000
@RF00776 L     @14,RSRWAP                                          0796 03669000
         B     @DE00796                                            0796 03670000
@DL00796 DS    0H                                                  0797 03671000
*     RSRSTAT2=''B;                 /* ZERO ENTIRE WA                */ 03672000
         MVI   RSRSTAT2(@14),X'00'                                 0797 03673000
*   END;                                                           0798 03674000
*                                                                  0798 03675000
         AL    @14,@CF00066                                        0798 03676000
@DE00796 ST    @14,RSRSTATP                                        0798 03677000
         L     @09,RSRWAP                                          0798 03678000
         AL    @09,RSRWAL                                          0798 03679000
         BCTR  @09,0                                               0798 03680000
         CR    @14,@09                                             0798 03681000
         BNH   @DL00796                                            0798 03682000
*   /*****************************************************************/ 03683000
*   /*                                                               */ 03684000
*   /* SET UP RSR PARM LIST                                          */ 03685000
*   /*                                                               */ 03686000
*   /*****************************************************************/ 03687000
*                                                                  0799 03688000
*   RSRSTRBN=(SRANGE/4096)*16;      /* ADDR IN FORM SSP0             */ 03689000
         L     @14,RSRWAP                                          0799 03690000
         L     @09,SRANGE                                          0799 03691000
         LH    @08,@CH00139                                        0799 03692000
         LR    @02,@09                                             0799 03693000
         SRDA  @02,32                                              0799 03694000
         DR    @02,@08                                             0799 03695000
         SLA   @03,4                                               0799 03696000
         STH   @03,RSRSTRBN(,@14)                                  0799 03697000
*   RSRFRCT=(ERANGE-SRANGE)/4096;   /* NUM OF PAGES                  */ 03698000
         LR    @02,@09                                             0800 03699000
         LCR   @02,@02                                             0800 03700000
         AL    @02,ERANGE                                          0800 03701000
         SRDA  @02,32                                              0800 03702000
         DR    @02,@08                                             0800 03703000
         STH   @03,RSRFRCT(,@14)                                   0800 03704000
*   RSRSTUS='1'B;                   /* REQUEST STATUS FUNC           */ 03705000
         OI    RSRSTUS(@14),B'00001000'                            0801 03706000
*   RSRSLP=RSRWAP+LENGTH(RSRPARML); /* @ STATUS BUFFER               */ 03707000
         LA    @09,20                                              0802 03708000
         ALR   @09,@14                                             0802 03709000
         ST    @09,RSRSLP(,@14)                                    0802 03710000
*   R1=RSRWAP;                      /* SET @ RSR PARM LIST           */ 03711000
*                                                                  0803 03712000
         LR    R1,@14                                              0803 03713000
*   /*****************************************************************/ 03714000
*   /*                                                               */ 03715000
*   /* CALL RSR TO GET PAGE STATUS                                   */ 03716000
*   /*                                                               */ 03717000
*   /*****************************************************************/ 03718000
*                                                                  0804 03719000
*   CALL RSR;                                                      0804 03720000
*                                                                  0804 03721000
         L     @14,CVTPTR                                          0804 03722000
         L     @14,PVTPTR(,@14)                                    0804 03723000
         L     @15,PVTPRCF(,@14)                                   0804 03724000
         BALR  @14,@15                                             0804 03725000
*   /*****************************************************************/ 03726000
*   /*                                                               */ 03727000
*   /* CHECK RETURN CODE FROM RSR IN REG 15                          */ 03728000
*   /*                                                               */ 03729000
*   /*****************************************************************/ 03730000
*                                                                  0805 03731000
*   IF R15^=0 THEN                                                 0805 03732000
*                                                                  0805 03733000
         LTR   R15,R15                                             0805 03734000
         BZ    @RF00805                                            0805 03735000
*     /***************************************************************/ 03736000
*     /*                                                             */ 03737000
*     /* IF NOT SUCCESSFUL THEN ABEND ROUTINE AND EXIT THRU ESTAE    */ 03738000
*     /* ROUTINE                                                     */ 03739000
*     /*                                                             */ 03740000
*     /***************************************************************/ 03741000
*                                                                  0806 03742000
*     DO;                                                          0806 03743000
*       INTERROR=R15;               /* SET ERROR CODE                */ 03744000
         ST    R15,INTERROR                                        0807 03745000
*       DO;                         /* ABEND(183) SYSTEM             */ 03746000
*         RESPECIFY                                                0809 03747000
*          (GPR01F) RESTRICTED;                                    0809 03748000
*         GPR01F=((183)&'00000FFF'X)*4096;/* COMP CODE IN BITS 8-19  */ 03749000
         L     GPR01F,@CF02885                                     0810 03750000
*         SVC(13);                  /* ISSUE ABEND SVC               */ 03751000
         SVC   13                                                  0811 03752000
*         RESPECIFY                                                0812 03753000
*          (GPR01F) UNRESTRICTED;                                  0812 03754000
*       END;                        /* ABEND(183) SYSTEM ABEND     0813 03755000
*                                      COMMAND PROCESSOR     @YM03534*/ 03756000
*     END;                                                         0814 03757000
*                                                                  0814 03758000
*   /*****************************************************************/ 03759000
*   /*                                                               */ 03760000
*   /* RETURN TO CALLER                                              */ 03761000
*   /*                                                               */ 03762000
*   /*****************************************************************/ 03763000
*                                                                  0815 03764000
*   RETURN;                                                        0815 03765000
         B     @EL00015                                            0815 03766000
*   END RSRSTAT;                                                   0816 03767000
         B     @EL00015                                            0816 03768000
*                                                                  0817 03769000
*   /*****************************************************************/ 03770000
*   /*                                                               */ 03771000
*   /* ROUTINE TO CONSTRUCT AND WRITE SMF RECORD TYPE 22 TO REPRESENT*/ 03772000
*   /* STORAGE VARIED ONLINE/OFFLINE                                 */ 03773000
*   /*                                                               */ 03774000
*   /*****************************************************************/ 03775000
*                                                                  0817 03776000
*STORSMF:                                                          0817 03777000
*   PROC;                                                          0817 03778000
STORSMF  STM   @14,@12,@SA00016                                    0817 03779000
*   SMF22PTR=ADDR(SMFBUFR);         /* SET ADDRESSIBILITY FOR MAPPING   03780000
*                                      MACRO                         */ 03781000
         LA    SMF22PTR,SMFBUFR                                    0818 03782000
*   SMFBUFR=''B;                    /* ZERO SMF WORK BUFFER          */ 03783000
*                                                                  0819 03784000
         XC    SMFBUFR(32),SMFBUFR                                 0819 03785000
*   /*****************************************************************/ 03786000
*   /*                                                               */ 03787000
*   /* INIT HEADER PORTION OF RECORD                                 */ 03788000
*   /*                                                               */ 03789000
*   /*****************************************************************/ 03790000
*                                                                  0820 03791000
*   SMF22LEN=28;                    /* TOTAL LENGTH                  */ 03792000
         MVC   SMF22LEN(2,SMF22PTR),@CH01253                       0820 03793000
*   SMF22RTY=22;                    /* RECORD TYPE                   */ 03794000
*                                                                  0821 03795000
         MVI   SMF22RTY(SMF22PTR),X'16'                            0821 03796000
*   /*****************************************************************/ 03797000
*   /*                                                               */ 03798000
*   /* TEST WHICH FUNCTION                                           */ 03799000
*   /*                                                               */ 03800000
*   /*****************************************************************/ 03801000
*                                                                  0822 03802000
*   IF OFFLINE='1'B THEN                                           0822 03803000
*                                                                  0822 03804000
         TM    OFFLINE,B'10000000'                                 0822 03805000
         BNO   @RF00822                                            0822 03806000
*     /***************************************************************/ 03807000
*     /*                                                             */ 03808000
*     /* OFFLINE EVENT                                               */ 03809000
*     /*                                                             */ 03810000
*     /***************************************************************/ 03811000
*                                                                  0823 03812000
*     SMF22IND=3;                                                  0823 03813000
*                                                                  0823 03814000
         MVC   SMF22IND(2,SMF22PTR),@CH00397                       0823 03815000
*   /*****************************************************************/ 03816000
*   /*                                                               */ 03817000
*   /* ONLINE EVENT                                                  */ 03818000
*   /*                                                               */ 03819000
*   /*****************************************************************/ 03820000
*                                                                  0824 03821000
*   ELSE                                                           0824 03822000
*     SMF22IND=2;                                                  0824 03823000
         B     @RC00822                                            0824 03824000
@RF00822 MVC   SMF22IND(2,SMF22PTR),@CH00182                       0824 03825000
*   SMF22ECT=1;                     /* 1 ELEMENT FOLLOWING           */ 03826000
*                                                                  0825 03827000
@RC00822 MVC   SMF22ECT(2,SMF22PTR),@CH00066                       0825 03828000
*   /*****************************************************************/ 03829000
*   /*                                                               */ 03830000
*   /* FILL IN VARY ELEMENT                                          */ 03831000
*   /*                                                               */ 03832000
*   /*****************************************************************/ 03833000
*                                                                  0826 03834000
*   SMF22PTR=SMF22PTR+22;           /* SET ADDR TO ELEMENT           */ 03835000
         AH    SMF22PTR,@CH02650                                   0826 03836000
*   SMF22PTR->SMF22TID=3;           /* VARY STORAGE ELEMENT          */ 03837000
         MVI   SMF22TID(SMF22PTR),X'03'                            0827 03838000
*   SMF22PTR->SMF22PGL=SRANGE/4096; /* PAGE NUM OF START OF RANGE    */ 03839000
         L     @14,SRANGE                                          0828 03840000
         LH    @03,@CH00139                                        0828 03841000
         LR    @04,@14                                             0828 03842000
         SRDA  @04,32                                              0828 03843000
         DR    @04,@03                                             0828 03844000
         STH   @05,SMF22PGL(,SMF22PTR)                             0828 03845000
*   SMF22PTR->SMF22NPG=(ERANGE-SRANGE)/4096;/* NUM OF PAGES IN RANGE */ 03846000
*                                                                  0829 03847000
         LR    @04,@14                                             0829 03848000
         LCR   @04,@04                                             0829 03849000
         AL    @04,ERANGE                                          0829 03850000
         SRDA  @04,32                                              0829 03851000
         DR    @04,@03                                             0829 03852000
         STH   @05,SMF22NPG(,SMF22PTR)                             0829 03853000
*   /*****************************************************************/ 03854000
*   /*                                                               */ 03855000
*   /* WRITE SMF RECORD TO SMF DATA SET IF SMF IS ACTIVE             */ 03856000
*   /*                                                               */ 03857000
*   /*****************************************************************/ 03858000
*                                                                  0830 03859000
*   GEN(SMFWTM SMFBUFR);                                           0830 03860000
*                                                                  0830 03861000
         SMFWTM SMFBUFR                                                 03862000
*   /*****************************************************************/ 03863000
*   /*                                                               */ 03864000
*   /* RETURN TO CALLER                                              */ 03865000
*   /*                                                               */ 03866000
*   /*****************************************************************/ 03867000
*                                                                  0831 03868000
*   RETURN;                                                        0831 03869000
@EL00016 DS    0H                                                  0831 03870000
@EF00016 DS    0H                                                  0831 03871000
@ER00016 LM    @14,@12,@SA00016                                    0831 03872000
         BR    @14                                                 0831 03873000
*   END STORSMF;                                                   0832 03874000
*                                                                  0833 03875000
*   /*****************************************************************/ 03876000
*   /*                                                               */ 03877000
*   /* ESTAE ROUTINE                                                 */ 03878000
*   /*                                                               */ 03879000
*   /*****************************************************************/ 03880000
*                                                                  0833 03881000
*ESTAERTN:                                                         0833 03882000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0833 03883000
*                                                                  0833 03884000
ESTAERTN DS    0H                                                  0834 03885000
*/*                                                                  */ 03886000
*/*     ROUTINE WILL BE GIVEN CONROL BY RTM WHEN THIS TASK IS        */ 03887000
*/*  SCHEDULED FOR AN ABEND.                                         */ 03888000
*/*                                                                  */ 03889000
*                                                                  0834 03890000
*   DO;                             /* ENTESTAE (R10,R11,R12)SAVEAREA   03891000
*                                      (ESTAESA)ERREXIT(NORTCA)PARMRE   03892000
*                                      G(R15)                        */ 03893000
*/*  ENTRY CODE FOR ESTAE ROUTINE.                                   */ 03894000
*/*  IF RTCA ALLOCATED THEN RESTORE CODE AND                         */ 03895000
*/*  DATA REGS FROM START OF USERS PARM LIST,                        */ 03896000
*/*  AND ESTABLISH ADDR TO ESTAE SAVE AREA                           */ 03897000
*/*  IF REQUIRED.                                                    */ 03898000
*/*  IF NO RTCA AVAILABLE THEN BRANCH TO ERROR                       */ 03899000
*/*  CODE AFTER ESTABLISHING ADDRESSABILITY                          */ 03900000
*                                                                  0835 03901000
*     GEN(USING *,GPR15P);                                         0835 03902000
         USING *,GPR15P                                                 03903000
*     GEN(CH    GPR00F,*+30);       /* CHECK IF RTCA ALLOC FAILED    */ 03904000
         CH    GPR00F,*+30                                              03905000
*     GEN(BNE   *+28);              /* NO,SAVE RTM REGS              */ 03906000
         BNE   *+28                                                     03907000
*     GEN(DROP  GPR15P);            /* DROP LOCAL ADDR               */ 03908000
         DROP  GPR15P                                                   03909000
*     GEN(LR    R15,GPR02P);        /* PTR TO USER PARM LIST         */ 03910000
         LR    R15,GPR02P                                               03911000
*     GEN(L     R10,00(R15));                                      0840 03912000
         L     R10,00(R15)                                              03913000
*     GEN(L     R11,04(R15));                                      0841 03914000
         L     R11,04(R15)                                              03915000
*     GEN(L     R12,08(R15));                                      0842 03916000
         L     R12,08(R15)                                              03917000
*     GEN(LA    GPR13P,ESTAESA);    /* SET PTR TO ESTAE SA           */ 03918000
         LA    GPR13P,ESTAESA                                           03919000
*     GEN(B     NORTCA);            /* BRANCH TO ERROR EXIT          */ 03920000
         B     NORTCA                                                   03921000
*     GEN(DC    H'12');             /* NO RTCA AVAIL RC              */ 03922000
         DC    H'12'                                                    03923000
*     GEN(STM   GPR14P,GPR12F,12(GPR13P));/* GOOD R13, SAVE RTM'S  0846 03924000
*                                      REGS                          */ 03925000
         STM   GPR14P,GPR12F,12(GPR13P)                                 03926000
*     GEN(L     R15,0(GPR01P));     /* PTR TO USER PARM LIST         */ 03927000
         L     R15,0(GPR01P)                                            03928000
*     GEN(L     R10,00(R15));                                      0848 03929000
         L     R10,00(R15)                                              03930000
*     GEN(L     R11,04(R15));                                      0849 03931000
         L     R11,04(R15)                                              03932000
*     GEN(L     R12,08(R15));                                      0850 03933000
         L     R12,08(R15)                                              03934000
*     GEN(ST    GPR13P,ESTAESA+4);  /* SET PTR TO RTM SA             */ 03935000
         ST    GPR13P,ESTAESA+4                                         03936000
*     GEN(LA    GPR13P,ESTAESA);    /* SET PTR TO ESTAE SA           */ 03937000
         LA    GPR13P,ESTAESA                                           03938000
*   END;                            /* ENTESTAE (R10,R11,R12)SAVEAREA   03939000
*                                      (ESTAESA)ERREXIT(NORTCA)PARMRE   03940000
*                                      G(R15)                        */ 03941000
*   RFY                                                            0854 03942000
*    (R2,                                                          0854 03943000
*     R3,                                                          0854 03944000
*     R8) RSTD;                                                    0854 03945000
*   GOODRTCA='1'B;                  /* INDICATE GOOD RTCA            */ 03946000
         OI    GOODRTCA,B'00001000'                                0855 03947000
*   GO TO SAVEPTR;                  /* PROCESS ESTAE                 */ 03948000
         B     SAVEPTR                                             0856 03949000
*NORTCA:                                                           0857 03950000
*   GOODRTCA='0'B;                  /* INDICATE NO RTCA              */ 03951000
NORTCA   NI    GOODRTCA,B'11110111'                                0857 03952000
*   R8=R14;                         /* SAVE RETURN ADDR OF RTM       */ 03953000
*                                                                  0858 03954000
         LR    R8,R14                                              0858 03955000
*   /*****************************************************************/ 03956000
*   /*                                                               */ 03957000
*   /* SAVE PTR TO RTCA IN MAIN WORKAREA                             */ 03958000
*   /*                                                               */ 03959000
*   /*****************************************************************/ 03960000
*                                                                  0859 03961000
*SAVEPTR:                                                          0859 03962000
*   SDWAPTR=R1;                                                    0859 03963000
*                                                                  0859 03964000
SAVEPTR  LR    SDWAPTR,R1                                          0859 03965000
*   /*****************************************************************/ 03966000
*   /*                                                               */ 03967000
*   /* CHECK IF ERROR WAS VALIDATING OFFLINE STORAGE                 */ 03968000
*   /*                                                               */ 03969000
*   /*****************************************************************/ 03970000
*                                                                  0860 03971000
*   IF VALOFF='1'B&SDWACMPC='0C5000'X THEN/* ERROR           @ZAXXXXX*/ 03972000
         TM    VALOFF,B'10000000'                                  0860 03973000
         BNO   @RF00860                                            0860 03974000
         CLC   SDWACMPC(3,SDWAPTR),@CB02659                        0860 03975000
         BE    @RT00860                                            0860 03976000
*     GOTO RETRYOFF;                /* GO RETRY TO NEXT PAGE @ZAXXXXX*/ 03977000
*                                                                  0861 03978000
*   /*****************************************************************/ 03979000
*   /*                                                               */ 03980000
*   /* CHECK IF ERROR DUE TO STORAGE CHECK WHILE VALIDATING STORAGE  */ 03981000
*   /* IN IEEVALST ROUTINE                                           */ 03982000
*   /*                                                               */ 03983000
*   /*****************************************************************/ 03984000
*                                                                  0862 03985000
*   IF(GOODRTCA='1'B)&              /* GOOD RTCA AVAILABLE           */ 03986000
*       ((SDWASKYF='1'B)|(SDWASCK='1'B))&(SDWASRVL='1'B)&/* STOR   0862 03987000
*                                      ERROR                         */ 03988000
*       (SDWARFSA>=FRAMEPTR)&(SDWARFSA<=(FRAMEPTR+4096))&/* IN PAGE  */ 03989000
*       (VALFRA^=0) THEN            /* WHILE DAT OFF                 */ 03990000
*                                                                  0862 03991000
@RF00860 TM    GOODRTCA,B'00001000'                                0862 03992000
         BNO   @RF00862                                            0862 03993000
         TM    SDWASKYF(SDWAPTR),B'10010000'                       0862 03994000
         BZ    @RF00862                                            0862 03995000
         TM    SDWASRVL(SDWAPTR),B'10000000'                       0862 03996000
         BNO   @RF00862                                            0862 03997000
         L     @14,FRAMEPTR                                        0862 03998000
         L     @09,SDWARFSA(,SDWAPTR)                              0862 03999000
         CR    @09,@14                                             0862 04000000
         BL    @RF00862                                            0862 04001000
         AL    @14,@CF00139                                        0862 04002000
         CR    @09,@14                                             0862 04003000
         BH    @RF00862                                            0862 04004000
         ICM   @14,15,VALFRA                                       0862 04005000
         BZ    @RF00862                                            0862 04006000
*     /***************************************************************/ 04007000
*     /*                                                             */ 04008000
*     /* VALIDATION OF STORAGE FAILED DUE TO STORAGE CHECK. SET UP   */ 04009000
*     /* FOR RETRY TO CONTINUE VALIDATING STORAGE WITH THE NEXT PAGE */ 04010000
*     /*                                                             */ 04011000
*     /***************************************************************/ 04012000
*                                                                  0863 04013000
*     DO;                                                          0863 04014000
*       PSTORERR='1'B;              /* SET STOR ERROR BIT ON IN    0864 04015000
*                                      PAGE'S STATUS BYTE            */ 04016000
*       PINTRCP='0'B;               /* CLEAR INTERCEPT BIT TO      0865 04017000
*                                      INDICATE THAT STORAGE ERROR 0865 04018000
*                                      DUE TO VALIDATION FAILURE     */ 04019000
         L     @14,RSRSTATP                                        0865 04020000
         OI    PSTORERR(@14),B'00100000'                           0865 04021000
         NI    PINTRCP(@14),B'10111111'                            0865 04022000
*       WTORFLAG='1'B;              /* SET WTOR FLAG TO FORCE PROMPT    04023000
*                                      AFTER ALL PAGES TESTED        */ 04024000
         OI    WTORFLAG,B'00000100'                                0866 04025000
*RETRYOFF:                                                         0867 04026000
*       R1=SDWAPTR;                 /* LOAD PTR TO RTCA      @ZAXXXXX*/ 04027000
RETRYOFF LR    R1,SDWAPTR                                          0867 04028000
*       R2=VALFRA;                  /* LOAD RETRY ADDR               */ 04029000
*                                                                  0868 04030000
         L     R2,VALFRA                                           0868 04031000
*       /*************************************************************/ 04032000
*       /*                                                           */ 04033000
*       /* SCHEDULE RETRY TO LET VALIDATION CONTINUE. SCHEDULE RE-TRY*/ 04034000
*       /* WITH NO DUMP OR NO RECORD TO LOGREC RE TRY WILL BE AT THE */ 04035000
*       /* INTRUCTION IN IEEVALST WHICH SET THE DAT BIT BACK ON.     */ 04036000
*       /* AFTER DAT IS SET ON AGAIN CONTROL IS RETURN TO CALLER WITH*/ 04037000
*       /* ERROR BITS SET IN PAGE'S STATUS BYTE                      */ 04038000
*       /*                                                           */ 04039000
*       /*************************************************************/ 04040000
*                                                                  0869 04041000
*       GEN(L R13,4(R13));          /* RESTORE PTR TO RTM SA         */ 04042000
         L R13,4(R13)                                                   04043000
*       DO;                         /* SETRP RETADDR(VALSTRA)RETREGS(   04044000
*                                      YES)DUMP(NO)RECORD(NO)RC(4)FRE   04045000
*                                      SDWA(YES)REGS(14,12)          */ 04046000
*         RESPECIFY                                                0871 04047000
*          (GPR00P,                                                0871 04048000
*           GPR01P,                                                0871 04049000
*           GPR14P,                                                0871 04050000
*           GPR15P) RSTD;                                          0871 04051000
*         GPR01P->SDWARCDE=4;       /* STORE RC INTO SDWA            */ 04052000
         MVI   SDWARCDE(GPR01P),X'04'                              0872 04053000
*         GPR01P->SDWARTYA=ADDR(VALSTRA);/* SAVE RETRY ADDRESS       */ 04054000
         MVC   SDWARTYA(4,GPR01P),VALFRA                           0873 04055000
*         GPR01P->SDWAFREE='1'B;    /* SET FLAG TO FREE SDWA         */ 04056000
*         GPR01P->SDWARCRD='0'B;    /* TURN OFF RECORD INDICATOR     */ 04057000
         OI    SDWAFREE(GPR01P),B'00000100'                        0875 04058000
         NI    SDWARCRD(GPR01P),B'01111111'                        0875 04059000
*         GPR01P->SDWAREQ='0'B;     /* TURN OFF DUMP INDICATOR       */ 04060000
         NI    SDWAREQ(GPR01P),B'01111111'                         0876 04061000
*         GPR01P->SDWAUPRG='1'B;    /* TURN ON RETREGS INDICATOR     */ 04062000
         OI    SDWAUPRG(GPR01P),B'00001000'                        0877 04063000
*         GEN(RETURN (14,12));                                     0878 04064000
         RETURN (14,12)                                                 04065000
*         RESPECIFY                                                0879 04066000
*          (GPR00P,                                                0879 04067000
*           GPR01P,                                                0879 04068000
*           GPR14P,                                                0879 04069000
*           GPR15P) UNRSTD;                                        0879 04070000
*       END;                                                       0880 04071000
*       RFY                                                        0881 04072000
*         SDWA BASED(SDWAPTR);                                     0881 04073000
*     END;                                                         0882 04074000
*                                                                  0882 04075000
*   /*****************************************************************/ 04076000
*   /*                                                               */ 04077000
*   /* UNRECOVERABLE ERROR. FREE ALL RESOURCES IN PREPARATION TO     */ 04078000
*   /* CONTINUATION OF ABEND                                         */ 04079000
*   /*                                                               */ 04080000
*   /*****************************************************************/ 04081000
*                                                                  0883 04082000
*/*                                                                  */ 04083000
*                                                                  0883 04084000
*   /*****************************************************************/ 04085000
*   /*                                                               */ 04086000
*   /* FREE RSR WORKAREA IF ALLOCATED                                */ 04087000
*   /*                                                               */ 04088000
*   /*****************************************************************/ 04089000
*                                                                  0883 04090000
*   IF RSRWAP^=0 THEN                                              0883 04091000
@RF00862 ICM   @14,15,RSRWAP                                       0883 04092000
         BZ    @RF00883                                            0883 04093000
*     DO;                                                          0884 04094000
*       DO;                         /* FREEMAIN(R)                 0885 04095000
*                                      LV(RSRWAL)SP(253)A(RSRPARML)  */ 04096000
*         RESPECIFY                                                0886 04097000
*          (GPR01F,                                                0886 04098000
*           GPR00F) RESTRICTED;                                    0886 04099000
*         GPR00F=RSRWAL;            /* LENGTH REQUESTED              */ 04100000
         L     GPR00F,RSRWAL                                       0887 04101000
*         GPR01F=253;               /* SP IN REG 1                   */ 04102000
         LA    GPR01F,253                                          0888 04103000
*         GEN(SLL   GPR01F,24)                                     0889 04104000
*         NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;             0889 04105000
         SLL   GPR01F,24                                                04106000
*         GPR00F=GPR00F|GPR01F;     /* SP IN HI BYTE                 */ 04107000
         OR    GPR00F,GPR01F                                       0890 04108000
*         GPR01F=ADDR(RSRPARML);    /* SET REGISTER ONE              */ 04109000
         L     GPR01F,RSRWAP                                       0891 04110000
*         SVC(10);                  /* R-FORM OF GETMAIN             */ 04111000
         SVC   10                                                  0892 04112000
*         RESPECIFY                                                0893 04113000
*          (GPR01F,                                                0893 04114000
*           GPR00F) UNRESTRICTED;                                  0893 04115000
*       END;                        /* FREEMAIN(R)                 0894 04116000
*                                      LV(RSRWAL)SP(253)A(RSRPARML)  */ 04117000
*     END;                                                         0895 04118000
*                                                                  0895 04119000
*   /*****************************************************************/ 04120000
*   /*                                                               */ 04121000
*   /* PGFREE VALIDATE CODE AND DEQ OFF RESOURCE                     */ 04122000
*   /*                                                               */ 04123000
*   /*****************************************************************/ 04124000
*                                                                  0896 04125000
*   CALL UNSERLZE;                                                 0896 04126000
*                                                                  0896 04127000
@RF00883 BAL   @14,UNSERLZE                                        0896 04128000
*   /*****************************************************************/ 04129000
*   /*                                                               */ 04130000
*   /* FREE CSCB                                                     */ 04131000
*   /*                                                               */ 04132000
*   /*****************************************************************/ 04133000
*                                                                  0897 04134000
*   CHFC='1'B;                      /* SET FREE FUNC FLAG            */ 04135000
         L     @14,CSCBPTR                                         0897 04136000
         OI    CHFC(@14),B'00000010'                               0897 04137000
*   R1=CSCBPTR;                     /* SET PTR TO CSCB               */ 04138000
         LR    R1,@14                                              0898 04139000
*   GEN(MGCR (1),CHAIN);                                           0899 04140000
*                                                                  0899 04141000
         MGCR (1),CHAIN                                                 04142000
*   /*****************************************************************/ 04143000
*   /*                                                               */ 04144000
*   /* CHECK IF UNRECOVERABLE ERROR DUE TO REFERENCING UNCONFIGURED  */ 04145000
*   /* STORAGE DURING VALIDATION, IF SO THEN WRITE INFORMATIONAL MSG */ 04146000
*   /* TO OPERATOR AND CONTINUE ABEND WITH NO DUMP OR RECORD TO      */ 04147000
*   /* LOGREC                                                        */ 04148000
*   /*                                                               */ 04149000
*   /*****************************************************************/ 04150000
*                                                                  0900 04151000
*   IF(GOODRTCA='1'B)&              /* GOOD RTCA                     */ 04152000
*       (SDWACMPC>='0C5000'X)&(SDWACMPC<='0C5FFF'X)&/* ADDRESS PGM 0900 04153000
*                                      CHECK                         */ 04154000
*       (VALFRA^=0) THEN            /* IN VALIDATE                   */ 04155000
         TM    GOODRTCA,B'00001000'                                0900 04156000
         BNO   @RF00900                                            0900 04157000
         CLC   SDWACMPC(3,SDWAPTR),@CB02659                        0900 04158000
         BL    @RF00900                                            0900 04159000
         CLC   SDWACMPC(3,SDWAPTR),@CB02663                        0900 04160000
         BH    @RF00900                                            0900 04161000
         ICM   @14,15,VALFRA                                       0900 04162000
         BZ    @RF00900                                            0900 04163000
*     DO;                                                          0901 04164000
*       CALL WTORTN(13);            /* STORAGE NOT CONFIGURED MESSAGE*/ 04165000
*                                                                  0902 04166000
         LA    @01,@AL00902                                        0902 04167000
         BAL   @14,WTORTN                                          0902 04168000
*       /*************************************************************/ 04169000
*       /*                                                           */ 04170000
*       /* FREE MAIN WORKAREA                                        */ 04171000
*       /*                                                           */ 04172000
*       /*************************************************************/ 04173000
*                                                                  0903 04174000
*       R2=SDWAPTR;                 /* SAVE PTR TO RTCA              */ 04175000
         LR    R2,SDWAPTR                                          0903 04176000
*       GEN(L R13,4(R13));          /* RESTORE PTR TO RTM SA         */ 04177000
         L R13,4(R13)                                                   04178000
*       DO;                         /* FREEMAIN(R)                 0905 04179000
*                                      LV(@SIZDATD)SP(0)A(MAINWA)    */ 04180000
*         RESPECIFY                                                0906 04181000
*          (GPR01F,                                                0906 04182000
*           GPR00F) RESTRICTED;                                    0906 04183000
*         GPR00F=@SIZDATD;          /* LENGTH REQUESTED              */ 04184000
         L     GPR00F,@SIZDATD                                     0907 04185000
*         GPR01F=0;                 /* SP IN REG 1                   */ 04186000
         SLR   GPR01F,GPR01F                                       0908 04187000
*         GEN(SLL   GPR01F,24)                                     0909 04188000
*         NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;             0909 04189000
         SLL   GPR01F,24                                                04190000
*         GPR00F=GPR00F|GPR01F;     /* SP IN HI BYTE                 */ 04191000
         OR    GPR00F,GPR01F                                       0910 04192000
*         GPR01F=ADDR(MAINWA);      /* SET REGISTER ONE              */ 04193000
         LR    GPR01F,R10                                          0911 04194000
*         SVC(10);                  /* R-FORM OF GETMAIN             */ 04195000
         SVC   10                                                  0912 04196000
*         RESPECIFY                                                0913 04197000
*          (GPR01F,                                                0913 04198000
*           GPR00F) UNRESTRICTED;                                  0913 04199000
*       END;                        /* FREEMAIN(R)                 0914 04200000
*                                      LV(@SIZDATD)SP(0)A(MAINWA)    */ 04201000
*       R1=R2;                      /* MOVE @ RTCA TO R1             */ 04202000
         LR    R1,R2                                               0915 04203000
*CONFGERR:                                                         0916 04204000
*                                                                  0916 04205000
*       /*************************************************************/ 04206000
*       /*                                                           */ 04207000
*       /* RETURN TO RTM AND CONTINUE ABEND                          */ 04208000
*       /*                                                           */ 04209000
*       /*************************************************************/ 04210000
*                                                                  0916 04211000
*       DO;                         /* SETRP DUMP(NO)RECORD(NO)RC(0)R   04212000
*                                      EGS(14,12)                    */ 04213000
CONFGERR DS    0H                                                  0917 04214000
*         RESPECIFY                                                0917 04215000
*          (GPR00P,                                                0917 04216000
*           GPR01P,                                                0917 04217000
*           GPR14P,                                                0917 04218000
*           GPR15P) RSTD;                                          0917 04219000
*         GPR01P->SDWARCDE=0;       /* SAVE RC VALUE                 */ 04220000
         MVI   SDWARCDE(GPR01P),X'00'                              0918 04221000
*         GPR01P->SDWARCRD='0'B;    /* TURN OFF RECORD INDICATOR     */ 04222000
         NI    SDWARCRD(GPR01P),B'01111111'                        0919 04223000
*         GPR01P->SDWAREQ='0'B;     /* TURN OFF DUMP INDICATOR       */ 04224000
         NI    SDWAREQ(GPR01P),B'01111111'                         0920 04225000
*         GEN(RETURN (14,12));                                     0921 04226000
         RETURN (14,12)                                                 04227000
*         RESPECIFY                                                0922 04228000
*          (GPR00P,                                                0922 04229000
*           GPR01P,                                                0922 04230000
*           GPR14P,                                                0922 04231000
*           GPR15P) UNRSTD;                                        0922 04232000
*       END;                                                       0923 04233000
*       RFY                                                        0924 04234000
*         SDWA BASED(SDWAPTR);                                     0924 04235000
*     END;                                                         0925 04236000
*                                                                  0925 04237000
*   /*****************************************************************/ 04238000
*   /*                                                               */ 04239000
*   /* UNRECOVERABLE ERROR DUE TO INTERNAL ERROR. WRITE ERROR MESSAGE*/ 04240000
*   /* TO OPERATOR AND CONTINUE ABEND WITH A SDUMP OF THE MAIN       */ 04241000
*   /* WORKAREA AND WRITE A COPY OF THE RTCA TO SYS1.LOGREC          */ 04242000
*   /*                                                               */ 04243000
*   /*****************************************************************/ 04244000
*                                                                  0926 04245000
*   ELSE                                                           0926 04246000
*     DO;                                                          0926 04247000
         B     @RC00900                                            0926 04248000
@RF00900 DS    0H                                                  0927 04249000
*       CALL WTORTN(7);             /* COMMAND PROCESSOR FAILED      */ 04250000
*                                                                  0927 04251000
         LA    @01,@AL00927                                        0927 04252000
         BAL   @14,WTORTN                                          0927 04253000
*       /*************************************************************/ 04254000
*       /*                                                           */ 04255000
*       /* DUMP MAIN WORKAREA TO SYS1.DUMPNN                         */ 04256000
*       /*                                                           */ 04257000
*       /*************************************************************/ 04258000
*                                                                  0928 04259000
*       HOBEDMWA='80'X;             /* SET END OF LIST IND           */ 04260000
         MVI   HOBEDMWA,X'80'                                      0928 04261000
*       SDUMPI=SDUMPC;              /* INIT SDUMP INTERFACE          */ 04262000
         MVC   SDUMPI(70),SDUMPC                                   0929 04263000
*       R2=ADDR(STRTMWA);           /* SET PTR TO STOR LIST          */ 04264000
         LA    R2,STRTMWA                                          0930 04265000
*       GEN(SDUMP LIST=(2),MF=(E,SDUMPI));                         0931 04266000
*                                                                  0931 04267000
         SDUMP LIST=(2),MF=(E,SDUMPI)                                   04268000
*       /*************************************************************/ 04269000
*       /*                                                           */ 04270000
*       /* REMEMBER IF GOOD RTCA AVAILABLE                           */ 04271000
*       /*                                                           */ 04272000
*       /*************************************************************/ 04273000
*                                                                  0932 04274000
*       IF GOODRTCA='1'B THEN                                      0932 04275000
         TM    GOODRTCA,B'00001000'                                0932 04276000
         BNO   @RF00932                                            0932 04277000
*         DO;                                                      0933 04278000
*           R3=1;                   /* GOOD RTCA AVAIL               */ 04279000
         LA    R3,1                                                0934 04280000
*           GEN(L R13,4(R13));      /* RESTORE PTR TO RTM SA         */ 04281000
*                                                                  0935 04282000
         L R13,4(R13)                                                   04283000
*           /*********************************************************/ 04284000
*           /*                                                       */ 04285000
*           /* FILL IN MODULE IDENTIFICATION IN RTCA                 */ 04286000
*           /*                                                       */ 04287000
*           /*********************************************************/ 04288000
*                                                                  0936 04289000
*           SDWAMODN='IEEMPVST';    /* MODULE NAME                   */ 04290000
         MVC   SDWAMODN(8,SDWAPTR),@CC02667                        0936 04291000
*           SDWACSCT='IEEMPVST';    /* CSECT NAME                    */ 04292000
         MVC   SDWACSCT(8,SDWAPTR),@CC02667                        0937 04293000
*           SDWAREXN='ESTAERTN';    /* FRR ID                        */ 04294000
         MVC   SDWAREXN(8,SDWAPTR),@CC02668                        0938 04295000
*         END;                                                     0939 04296000
*                                                                  0939 04297000
*       /*************************************************************/ 04298000
*       /*                                                           */ 04299000
*       /* SET FLAG FOR NO RTCA                                      */ 04300000
*       /*                                                           */ 04301000
*       /*************************************************************/ 04302000
*                                                                  0940 04303000
*       ELSE                                                       0940 04304000
*         R3=0;                                                    0940 04305000
*                                                                  0940 04306000
         B     @RC00932                                            0940 04307000
@RF00932 SLR   R3,R3                                               0940 04308000
*       /*************************************************************/ 04309000
*       /*                                                           */ 04310000
*       /* FREE MAIN WORKAREA                                        */ 04311000
*       /*                                                           */ 04312000
*       /*************************************************************/ 04313000
*                                                                  0941 04314000
*       R2=SDWAPTR;                 /* SAVE PTR TO RTCA              */ 04315000
@RC00932 LR    R2,SDWAPTR                                          0941 04316000
*       DO;                         /* FREEMAIN(R)                 0942 04317000
*                                      LV(@SIZDATD)SP(0)A(MAINWA)    */ 04318000
*         RESPECIFY                                                0943 04319000
*          (GPR01F,                                                0943 04320000
*           GPR00F) RESTRICTED;                                    0943 04321000
*         GPR00F=@SIZDATD;          /* LENGTH REQUESTED              */ 04322000
         L     GPR00F,@SIZDATD                                     0944 04323000
*         GPR01F=0;                 /* SP IN REG 1                   */ 04324000
         SLR   GPR01F,GPR01F                                       0945 04325000
*         GEN(SLL   GPR01F,24)                                     0946 04326000
*         NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;             0946 04327000
         SLL   GPR01F,24                                                04328000
*         GPR00F=GPR00F|GPR01F;     /* SP IN HI BYTE                 */ 04329000
         OR    GPR00F,GPR01F                                       0947 04330000
*         GPR01F=ADDR(MAINWA);      /* SET REGISTER ONE              */ 04331000
         LR    GPR01F,R10                                          0948 04332000
*         SVC(10);                  /* R-FORM OF GETMAIN             */ 04333000
         SVC   10                                                  0949 04334000
*         RESPECIFY                                                0950 04335000
*          (GPR01F,                                                0950 04336000
*           GPR00F) UNRESTRICTED;                                  0950 04337000
*       END;                        /* FREEMAIN(R)                 0951 04338000
*                                      LV(@SIZDATD)SP(0)A(MAINWA)    */ 04339000
*       R1=R2;                      /* SET @ RTCA IN R1              */ 04340000
         LR    R1,R2                                               0952 04341000
*ERRORX:                                                           0953 04342000
*                                                                  0953 04343000
*       /*************************************************************/ 04344000
*       /*                                                           */ 04345000
*       /* RETURN TO RTM TO CONTINUE ABEND WITH DUMP OF RTCA         */ 04346000
*       /*                                                           */ 04347000
*       /*************************************************************/ 04348000
*                                                                  0953 04349000
*       IF R3=1 THEN                /* GOOD RTCA AVAIL               */ 04350000
ERRORX   CH    R3,@CH00066                                         0953 04351000
         BNE   @RF00953                                            0953 04352000
*         DO;                                                      0954 04353000
*           DO;                     /* SETRP DUMP(NO)RECORD(YES)RC(0)   04354000
*                                      REGS(14,12)                   */ 04355000
*             RESPECIFY                                            0956 04356000
*              (GPR00P,                                            0956 04357000
*               GPR01P,                                            0956 04358000
*               GPR14P,                                            0956 04359000
*               GPR15P) RSTD;                                      0956 04360000
*             GPR01P->SDWARCDE=0;   /* SAVE RC VALUE                 */ 04361000
         MVI   SDWARCDE(GPR01P),X'00'                              0957 04362000
*             GPR01P->SDWARCRD='1'B;/* TURN ON RECORD INDICATOR      */ 04363000
         OI    SDWARCRD(GPR01P),B'10000000'                        0958 04364000
*             GPR01P->SDWAREQ='0'B; /* TURN OFF DUMP INDICATOR       */ 04365000
         NI    SDWAREQ(GPR01P),B'01111111'                         0959 04366000
*             GEN(RETURN (14,12));                                 0960 04367000
         RETURN (14,12)                                                 04368000
*             RESPECIFY                                            0961 04369000
*              (GPR00P,                                            0961 04370000
*               GPR01P,                                            0961 04371000
*               GPR14P,                                            0961 04372000
*               GPR15P) UNRSTD;                                    0961 04373000
*           END;                                                   0962 04374000
*           RFY                                                    0963 04375000
*             SDWA BASED(SDWAPTR);                                 0963 04376000
*         END;                                                     0964 04377000
*                                                                  0964 04378000
*       /*************************************************************/ 04379000
*       /*                                                           */ 04380000
*       /* SET UP FOR RETURN FOR NO RTCA                             */ 04381000
*       /*                                                           */ 04382000
*       /*************************************************************/ 04383000
*                                                                  0965 04384000
*       ELSE                                                       0965 04385000
*         DO;                                                      0965 04386000
         B     @RC00953                                            0965 04387000
@RF00953 DS    0H                                                  0966 04388000
*           GENERATE;                                              0966 04389000
         LR   R14,R8                                                    04390000
         LA   R15,0                                                     04391000
         BR   R14                       RETURN TO RTM                   04392000
*         END;                                                     0967 04393000
*     END;                                                         0968 04394000
*   RFY                                                            0969 04395000
*    (R2,                                                          0969 04396000
*     R3,                                                          0969 04397000
*     R8) UNRSTD;                                                  0969 04398000
*   END ESTAERTN;                                                  0970 04399000
@EL00017 DS    0H                                                  0970 04400000
@EF00017 DS    0H                                                  0970 04401000
@ER00017 BR    @14                                                 0970 04402000
*                                                                  0971 04403000
*   /*****************************************************************/ 04404000
*   /*                                                               */ 04405000
*   /* MESSAGE ROUTINE                                               */ 04406000
*   /*                                                               */ 04407000
*   /*****************************************************************/ 04408000
*                                                                  0971 04409000
*WTORTN:                                                           0971 04410000
*   PROC(MIDENT);                                                  0971 04411000
*                                                                  0971 04412000
WTORTN   STM   @14,@12,@SA00018                                    0971 04413000
         MVC   @PC00018(4),0(@01)                                  0971 04414000
*/*  THIS ROUTINE ACCEPTS AS INPUT A MESSAGE ID AND SELECTS          */ 04415000
*/*  THE APPROPIATE MESSAGE FROM THE MESSAGE TABLE AND CONSTRUCTS    */ 04416000
*/*  A WTO PARM LIST AND ISSUES A WTO MACRO                          */ 04417000
*/*                                                                  */ 04418000
*                                                                  0972 04419000
*   DCL                                                            0972 04420000
*     MIDENT FIXED;                 /* MESSAGE NUMBER USED AS SEARCH    04421000
*                                      ARG INTO MESSAGE TABLE        */ 04422000
*/*                                                                  */ 04423000
*/*       FORMAT OF MESSAGE TABLE                                    */ 04424000
*/*        SET OF MESSAGE ENTRIES FOLLOWED BY A BYTE OF 0            */ 04425000
*/*                                                                  */ 04426000
*/*        EACH MESSAGE ENTRY PRECEEDED BY 1 BYTE LENGTH FIELD       */ 04427000
*/*          AND 1 BYTE MSG ID FIELD                                 */ 04428000
*/*                                                                  */ 04429000
*/*          NULL MSG ENTRIES HAVE LEN FIELD OF 2 AND NO TEXT        */ 04430000
*                                                                  0973 04431000
*   /*****************************************************************/ 04432000
*   /*                                                               */ 04433000
*   /* CREATE MESSAGE TABLE                                          */ 04434000
*   /*                                                               */ 04435000
*   /*****************************************************************/ 04436000
*                                                                  0973 04437000
*   DCL                                                            0973 04438000
*     1 MSGTBLE STATIC LOCAL,                                      0973 04439000
*      2 * FIXED(8) INIT(51),                                      0973 04440000
*      2 * FIXED(8) INIT(01),                                      0973 04441000
*      2 * CHAR(49) INIT(                                          0973 04442000
*            'IEE524I STORAGE LOCATIONS _____. TO _____. ONLINE'), 0973 04443000
*      2 * FIXED(8) INIT(52),                                      0973 04444000
*      2 * FIXED(8) INIT(02),                                      0973 04445000
*      2 * CHAR(50) INIT(                                          0973 04446000
*            'IEE510I STORAGE LOCATIONS _____. TO _____. OFFLINE'),     04447000
*      2 * FIXED(8) INIT(68),                                      0973 04448000
*      2 * FIXED(8) INIT(03),                                      0973 04449000
*      2 * CHAR(66) INIT(                                          0973 04450000
*'IEE519E VARY STOR REJECTED, (_____.,_____.) CAUSES INVALID OVERLAP'), 04451000
*      2 * FIXED(8) INIT(52),                                      0973 04452000
*      2 * FIXED(8) INIT(04),                                      0973 04453000
*      2 * CHAR(50) INIT(                                          0973 04454000
*            'IEE766I BAD STORAGE AT _____. CAN NOT BE VALIDATED'),     04455000
*      2 * FIXED(8) INIT(50),                                      0973 04456000
*      2 * FIXED(8) INIT(05),                                      0973 04457000
*      2 * CHAR(48) INIT(                                          0973 04458000
*            'IEE764I VARY STORAGE OFFLINE WAITING TO COMPLETE'),  0973 04459000
*      2 * FIXED(8) INIT(59),                                      0973 04460000
*      2 * FIXED(8) INIT(06),                                      0973 04461000
*      2 * CHAR(57) INIT(                                          0973 04462000
*            'IEE760I VARY STOR COMMAND REJECTED, STORAGE NOT AVAILABLE 04463000
*            ),                                                    0973 04464000
*      2 * FIXED(8) INIT(44),                                      0973 04465000
*      2 * FIXED(8) INIT(07),                                      0973 04466000
*      2 * CHAR(42) INIT('IEE713I VARY STOR COMMAND PROCESSOR FAILED'), 04467000
*      2 * FIXED(8) INIT(37),                                      0973 04468000
*      2 * FIXED(8) INIT(08),                                      0973 04469000
*      2 * CHAR(35) INIT('IEE345I VARY STOR AUTHORITY INVALID'),   0973 04470000
*      2 * FIXED(8) INIT(47),                                      0973 04471000
*      2 * FIXED(8) INIT(09),                                      0973 04472000
*      2 * CHAR(45) INIT('IEE715I VARY COMMAND REJECTED, INVALID SYNTAX 04473000
*            ),                                                    0973 04474000
*      2 * FIXED(8) INIT(74),                                      0973 04475000
*      2 * FIXED(8) INIT(10),                                      0973 04476000
*      2 * CHAR(72) INIT('IEE528I VARY STOR REJECTED,REQUEST OVERLAPS P 04477000
*RMANENTLY RESIDENT STORAGE'),                                     0973 04478000
*      2 * FIXED(8) INIT(62),                                      0973 04479000
*      2 * FIXED(8) INIT(11),                                      0973 04480000
*      2 * CHAR(60) INIT(                                          0973 04481000
*'IEE520I VARY STOR OFFLINE CANCELLED DUE TO SUBSEQUENT ONLINE'),  0973 04482000
*      2 * FIXED(8) INIT(45),                                      0973 04483000
*      2 * FIXED(8) INIT(12),                                      0973 04484000
*      2 * CHAR(43) INIT('IEE517I VARY STOR REJECTED, INVALID ADDRESS') 04485000
*         ,                                                        0973 04486000
*      2 * FIXED(8) INIT(66),                                      0973 04487000
*      2 * FIXED(8) INIT(13),                                      0973 04488000
*      2 * CHAR(64) INIT(                                          0973 04489000
*'IEE515E VARY STOR FAILED, STORAGE PHYSICALLY REMOVED FROM SYSTEM'),   04490000
*      2 * FIXED(8) INIT(0);                                       0973 04491000
*                                                                  0973 04492000
*   /*****************************************************************/ 04493000
*   /*                                                               */ 04494000
*   /* MAP OF ONLINE MESSAGE                                         */ 04495000
*   /*                                                               */ 04496000
*   /*****************************************************************/ 04497000
*                                                                  0974 04498000
*   DCL                                                            0974 04499000
*     1 MSG1 BASED(ADDR(WPLTXT)),   /* ONLINE MESSAGE                */ 04500000
*      2 * CHAR(26),                                               0974 04501000
*      2 MSG1SA CHAR(6),            /* START ADDR                    */ 04502000
*      2 * CHAR(4),                                                0974 04503000
*      2 MSG1EA CHAR(6);            /* END ADDR                      */ 04504000
*                                                                  0974 04505000
*   /*****************************************************************/ 04506000
*   /*                                                               */ 04507000
*   /* MAP OF OFFLINE MESSAGE                                        */ 04508000
*   /*                                                               */ 04509000
*   /*****************************************************************/ 04510000
*                                                                  0975 04511000
*   DCL                                                            0975 04512000
*     1 MSG2 BASED(ADDR(WPLTXT)),   /* OFFLINE MSG                   */ 04513000
*      2 * CHAR(26),                                               0975 04514000
*      2 MSG2SA CHAR(6),            /* START ADDR                    */ 04515000
*      2 * CHAR(4),                                                0975 04516000
*      2 MSG2EA(6);                 /* END ADDR                      */ 04517000
*                                                                  0975 04518000
*   /*****************************************************************/ 04519000
*   /*                                                               */ 04520000
*   /* MAP OF INVALID OVERLAP MESSAGE                                */ 04521000
*   /*                                                               */ 04522000
*   /*****************************************************************/ 04523000
*                                                                  0976 04524000
*   DCL                                                            0976 04525000
*     1 MSG3 BASED(ADDR(WPLTXT)),   /* INVALID OVERLAP               */ 04526000
*      2 * CHAR(29),                                               0976 04527000
*      2 MSG3SA CHAR(6),            /* START ADDR                    */ 04528000
*      2 * CHAR(1),                                                0976 04529000
*      2 MSG3EA CHAR(6);            /* END ADDR                      */ 04530000
*                                                                  0976 04531000
*   /*****************************************************************/ 04532000
*   /*                                                               */ 04533000
*   /* MAP OF STORAGE ERROR MESSAGE                                  */ 04534000
*   /*                                                               */ 04535000
*   /*****************************************************************/ 04536000
*                                                                  0977 04537000
*   DCL                                                            0977 04538000
*     1 MSG4 BASED(ADDR(WPLTXT)),   /* PEND OFFLINE STOR ERR         */ 04539000
*      2 * CHAR(23),                                               0977 04540000
*      2 MSG4SA CHAR(6);            /* FRAME START ADDR              */ 04541000
*                                                                  0977 04542000
*   /*****************************************************************/ 04543000
*   /*                                                               */ 04544000
*   /* VARIABLES TO REFERENCE MESSAGE TABLE                          */ 04545000
*   /*                                                               */ 04546000
*   /*****************************************************************/ 04547000
*                                                                  0978 04548000
*   DCL                                                            0978 04549000
*     MSGPTR PTR,                   /* PTR TO MSG ELEM               */ 04550000
*     MSGLEN FIXED(8),              /* LEN OF MSG TEXT               */ 04551000
*     MSGID FIXED(8);               /* ID OF MESSAGE                 */ 04552000
*                                                                  0978 04553000
*   /*****************************************************************/ 04554000
*   /*                                                               */ 04555000
*   /* FORMAT OF MESSAGE TABLE ENTRIES                               */ 04556000
*   /*                                                               */ 04557000
*   /*****************************************************************/ 04558000
*                                                                  0979 04559000
*   DCL                                                            0979 04560000
*     1 MSGELEM BASED(MSGPTR),                                     0979 04561000
*      2 LENELEM FIXED(8),          /* LEN OF ELEM                   */ 04562000
*      2 IDELEM FIXED(8),           /* ID OF ELEM                    */ 04563000
*      2 MTEXT CHAR(120);           /* MESSAGE TEXT                  */ 04564000
*                                                                  0979 04565000
*   /*****************************************************************/ 04566000
*   /*                                                               */ 04567000
*   /* LOCAL COPY OF ADDRESS TYPE FLAGS                              */ 04568000
*   /*                                                               */ 04569000
*   /*****************************************************************/ 04570000
*                                                                  0980 04571000
*   DCL                                                            0980 04572000
*     ADRTYPE BIT(8);                                              0980 04573000
*                                                                  0980 04574000
*   /*****************************************************************/ 04575000
*   /*                                                               */ 04576000
*   /* START OF WTO ROUTINE                                          */ 04577000
*   /*                                                               */ 04578000
*   /*****************************************************************/ 04579000
*                                                                  0981 04580000
*   WTOPARML=''B;                   /* ZERO WTO PARM LIST            */ 04581000
         XC    WTOPARML(130),WTOPARML                              0981 04582000
*   WPLPTR=ADDR(WTOPARML);          /* SET PTR TO PARM LIST          */ 04583000
*                                                                  0982 04584000
         LA    WPLPTR,WTOPARML                                     0982 04585000
*   /*****************************************************************/ 04586000
*   /*                                                               */ 04587000
*   /* FIND MESSAGE IN MESSAGE TABLE USING MIDENT AS SEARCH ARGUMENT */ 04588000
*   /*                                                               */ 04589000
*   /*****************************************************************/ 04590000
*                                                                  0983 04591000
*   MSGID=MIDENT;                   /* SAVE SEARCH ARG               */ 04592000
         L     @14,@PC00018                                        0983 04593000
         L     MSGID,MIDENT(,@14)                                  0983 04594000
*   MSGPTR=ADDR(MSGTBLE);           /* SET PTR TO FIRST MSG          */ 04595000
         LA    MSGPTR,MSGTBLE                                      0984 04596000
*   DO WHILE((LENELEM^=0)&(IDELEM^=MSGID));                        0985 04597000
         B     @DE00985                                            0985 04598000
@DL00985 DS    0H                                                  0986 04599000
*     MSGPTR=MSGPTR+LENELEM;        /* INCR TO NEXT MESSAGE          */ 04600000
         SLR   @14,@14                                             0986 04601000
         IC    @14,LENELEM(,MSGPTR)                                0986 04602000
         ALR   MSGPTR,@14                                          0986 04603000
*   END;                                                           0987 04604000
*                                                                  0987 04605000
@DE00985 CLI   LENELEM(MSGPTR),0                                   0987 04606000
         BE    @DC00985                                            0987 04607000
         SLR   @14,@14                                             0987 04608000
         IC    @14,IDELEM(,MSGPTR)                                 0987 04609000
         CR    MSGID,@14                                           0987 04610000
         BNE   @DL00985                                            0987 04611000
@DC00985 DS    0H                                                  0988 04612000
*   /*****************************************************************/ 04613000
*   /*                                                               */ 04614000
*   /* TEST IF MESSAGE FOUND. IF NOT THEN ABEND                      */ 04615000
*   /*                                                               */ 04616000
*   /*****************************************************************/ 04617000
*                                                                  0988 04618000
*   IF LENELEM=0 THEN                                              0988 04619000
         CLI   LENELEM(MSGPTR),0                                   0988 04620000
         BNE   @RF00988                                            0988 04621000
*     DO;                           /* ABEND(183) SYSTEM             */ 04622000
*       RESPECIFY                                                  0990 04623000
*        (GPR01F) RESTRICTED;                                      0990 04624000
*       GPR01F=((183)&'00000FFF'X)*4096;/* COMP CODE IN BITS 8-19    */ 04625000
         L     GPR01F,@CF02885                                     0991 04626000
*       SVC(13);                    /* ISSUE ABEND SVC               */ 04627000
         SVC   13                                                  0992 04628000
*       RESPECIFY                                                  0993 04629000
*        (GPR01F) UNRESTRICTED;                                    0993 04630000
*     END;                          /* ABEND(183) SYSTEM     @YM03534*/ 04631000
*                                                                  0994 04632000
*   /*****************************************************************/ 04633000
*   /*                                                               */ 04634000
*   /* CALC LENGTH OF FOUND MESSAGE                                  */ 04635000
*   /*                                                               */ 04636000
*   /*****************************************************************/ 04637000
*                                                                  0995 04638000
*   MSGLEN=LENELEM-2;                                              0995 04639000
*                                                                  0995 04640000
@RF00988 SLR   MSGLEN,MSGLEN                                       0995 04641000
         IC    MSGLEN,LENELEM(,MSGPTR)                             0995 04642000
         BCTR  MSGLEN,0                                            0995 04643000
         BCTR  MSGLEN,0                                            0995 04644000
*   /*****************************************************************/ 04645000
*   /*                                                               */ 04646000
*   /* SET WTO PARMS BEFORE MESSAGE TEXT                             */ 04647000
*   /*                                                               */ 04648000
*   /*****************************************************************/ 04649000
*                                                                  0996 04650000
*   WPLLGH=MSGLEN+4;                /* OFFSET TO END OF MESSAGE      */ 04651000
         LA    @14,4                                               0996 04652000
         LR    @07,MSGLEN                                          0996 04653000
         ALR   @07,@14                                             0996 04654000
         STH   @07,WPLLGH(,WPLPTR)                                 0996 04655000
*   WPLMCSFA='1'B;                  /* ROUTE/DESC PRESENT            */ 04656000
*   WPLMCSFB='1'B;                  /* QUE TO ID IN REG0             */ 04657000
*   WPLMCSFC='1'B;                  /* COMMAND RESPONSE              */ 04658000
*                                                                  0999 04659000
         OI    WPLMCSFA(WPLPTR),B'11100000'                        0999 04660000
*   /*****************************************************************/ 04661000
*   /*                                                               */ 04662000
*   /* MOVE MESSAGE TEXT INTO WTO PARM LIST                          */ 04663000
*   /*                                                               */ 04664000
*   /*****************************************************************/ 04665000
*                                                                  1000 04666000
*   WPLTXT(1:MSGLEN)=MTEXT(1:MSGLEN);                              1000 04667000
*                                                                  1000 04668000
         LR    @07,MSGLEN                                          1000 04669000
         BCTR  @07,0                                               1000 04670000
         EX    @07,@SM02915                                        1000 04671000
*   /*****************************************************************/ 04672000
*   /*                                                               */ 04673000
*   /* CHECK IF DYNAMIC MESSAGE IF SO THEN FILL IN ADRESS FIELDS     */ 04674000
*   /*                                                               */ 04675000
*   /*****************************************************************/ 04676000
*                                                                  1001 04677000
*   IF MSGID=1 THEN                                                1001 04678000
*                                                                  1001 04679000
         CH    MSGID,@CH00066                                      1001 04680000
         BNE   @RF01001                                            1001 04681000
*     /***************************************************************/ 04682000
*     /*                                                             */ 04683000
*     /* ONLINE MESSAGE                                              */ 04684000
*     /*                                                             */ 04685000
*     /***************************************************************/ 04686000
*                                                                  1002 04687000
*     DO;                                                          1002 04688000
*       CALL CONVBIN(SRANGE,MSG1SA);/* START ONLINE                  */ 04689000
         LA    @03,SRANGE                                          1003 04690000
         ST    @03,@AL00001                                        1003 04691000
         ALR   @14,WPLPTR                                          1003 04692000
         LA    @14,MSG1SA(,@14)                                    1003 04693000
         ST    @14,@AL00001+4                                      1003 04694000
         LA    @01,@AL00001                                        1003 04695000
         BAL   @14,CONVBIN                                         1003 04696000
*       CALL CONVBIN(ERANGE,MSG1EA);/* END ONLINE                    */ 04697000
         LA    @14,ERANGE                                          1004 04698000
         ST    @14,@AL00001                                        1004 04699000
         LA    @14,MSG1EA+4(,WPLPTR)                               1004 04700000
         ST    @14,@AL00001+4                                      1004 04701000
         LA    @01,@AL00001                                        1004 04702000
         BAL   @14,CONVBIN                                         1004 04703000
*     END;                                                         1005 04704000
*                                                                  1005 04705000
*   /*****************************************************************/ 04706000
*   /*                                                               */ 04707000
*   /* TEST IF OFFLINE MESSAGE                                       */ 04708000
*   /*                                                               */ 04709000
*   /*****************************************************************/ 04710000
*                                                                  1006 04711000
*   ELSE                                                           1006 04712000
*     IF MSGID=2 THEN               /* OFFLINE?                      */ 04713000
*                                                                  1006 04714000
         B     @RC01001                                            1006 04715000
@RF01001 CH    MSGID,@CH00182                                      1006 04716000
         BNE   @RF01006                                            1006 04717000
*       /*************************************************************/ 04718000
*       /*                                                           */ 04719000
*       /* OFFLINE MESSAGE                                           */ 04720000
*       /*                                                           */ 04721000
*       /*************************************************************/ 04722000
*                                                                  1007 04723000
*       DO;                                                        1007 04724000
*         CALL CONVBIN(SRANGE,MSG2SA);/* START OFFLINE               */ 04725000
         LA    @14,SRANGE                                          1008 04726000
         ST    @14,@AL00001                                        1008 04727000
         LA    @14,MSG2SA+4(,WPLPTR)                               1008 04728000
         ST    @14,@AL00001+4                                      1008 04729000
         LA    @01,@AL00001                                        1008 04730000
         BAL   @14,CONVBIN                                         1008 04731000
*         CALL CONVBIN(ERANGE,MSG1EA);/* END OFFLINE                 */ 04732000
         LA    @14,ERANGE                                          1009 04733000
         ST    @14,@AL00001                                        1009 04734000
         LA    @14,MSG1EA+4(,WPLPTR)                               1009 04735000
         ST    @14,@AL00001+4                                      1009 04736000
         LA    @01,@AL00001                                        1009 04737000
         BAL   @14,CONVBIN                                         1009 04738000
*       END;                                                       1010 04739000
*                                                                  1010 04740000
*   /*****************************************************************/ 04741000
*   /*                                                               */ 04742000
*   /* TEST IF INVALID OVERLAP MESSAGE                               */ 04743000
*   /*                                                               */ 04744000
*   /*****************************************************************/ 04745000
*                                                                  1011 04746000
*     ELSE                                                         1011 04747000
*       IF MSGID=3 THEN             /* INVALID OVERLAP?              */ 04748000
*                                                                  1011 04749000
         B     @RC01006                                            1011 04750000
@RF01006 CH    MSGID,@CH00397                                      1011 04751000
         BNE   @RF01011                                            1011 04752000
*         /***********************************************************/ 04753000
*         /*                                                         */ 04754000
*         /* INVALID OVERLAP MESSAGE                                 */ 04755000
*         /*                                                         */ 04756000
*         /***********************************************************/ 04757000
*                                                                  1012 04758000
*         DO;                                                      1012 04759000
*           CALL CONVBIN(SRANGE,MSG3SA);/* START OVERLAP             */ 04760000
         LA    @14,SRANGE                                          1013 04761000
         ST    @14,@AL00001                                        1013 04762000
         LA    @14,MSG3SA+4(,WPLPTR)                               1013 04763000
         ST    @14,@AL00001+4                                      1013 04764000
         LA    @01,@AL00001                                        1013 04765000
         BAL   @14,CONVBIN                                         1013 04766000
*           CALL CONVBIN(ERANGE,MSG3EA);/* END OVERLAP               */ 04767000
         LA    @14,ERANGE                                          1014 04768000
         ST    @14,@AL00001                                        1014 04769000
         LA    @14,MSG3EA+4(,WPLPTR)                               1014 04770000
         ST    @14,@AL00001+4                                      1014 04771000
         LA    @01,@AL00001                                        1014 04772000
         BAL   @14,CONVBIN                                         1014 04773000
*         END;                                                     1015 04774000
*                                                                  1015 04775000
*   /*****************************************************************/ 04776000
*   /*                                                               */ 04777000
*   /* TEST IF STORAGE ERROR MESSAGE                                 */ 04778000
*   /*                                                               */ 04779000
*   /*****************************************************************/ 04780000
*                                                                  1016 04781000
*       ELSE                                                       1016 04782000
*         IF MSGID=4 THEN           /* STORAGE ERROR?                */ 04783000
*                                                                  1016 04784000
         B     @RC01011                                            1016 04785000
@RF01011 CH    MSGID,@CH00165                                      1016 04786000
         BNE   @RF01016                                            1016 04787000
*           /*********************************************************/ 04788000
*           /*                                                       */ 04789000
*           /* STORAGE ERROR IN PENDING OFFLINE STORAGE              */ 04790000
*           /*                                                       */ 04791000
*           /*********************************************************/ 04792000
*                                                                  1017 04793000
*           DO;                                                    1017 04794000
*             ADRTYPE=TYPEADDR;     /* SAVE GLOBAL ADDR TYPE FLAGS   */ 04795000
         MVC   ADRTYPE(1),TYPEADDR                                 1018 04796000
*             IF DECMA='1'B THEN    /* CHECK IF ADDR RANGE ENTERED IN   04797000
*                                      MEG                           */ 04798000
         TM    DECMA,B'10000000'                                   1019 04799000
         BNO   @RF01019                                            1019 04800000
*               DO;                                                1020 04801000
*                 DECMA='0'B;       /* CLEAR MEG FLAG                */ 04802000
*                 DECKA='1'B;       /* SET K FLAG                    */ 04803000
         OI    DECKA,B'01000000'                                   1022 04804000
         NI    DECMA,B'01111111'                                   1022 04805000
*               END;                                               1023 04806000
*             CALL CONVBIN(FRAMEPTR,MSG4SA);/* PAGE ADDR OF ERROR    */ 04807000
@RF01019 LA    @14,FRAMEPTR                                        1024 04808000
         ST    @14,@AL00001                                        1024 04809000
         LA    @14,MSG4SA+4(,WPLPTR)                               1024 04810000
         ST    @14,@AL00001+4                                      1024 04811000
         LA    @01,@AL00001                                        1024 04812000
         BAL   @14,CONVBIN                                         1024 04813000
*             TYPEADDR=ADRTYPE;     /* RESTORE ADDR TYPE FLAGS       */ 04814000
         MVC   TYPEADDR(1),ADRTYPE                                 1025 04815000
*           END;                                                   1026 04816000
*                                                                  1026 04817000
*   /*****************************************************************/ 04818000
*   /*                                                               */ 04819000
*   /* SET UP ROUTE AND DESCRIPTER CODES AFTER MESSAGE               */ 04820000
*   /*                                                               */ 04821000
*   /*****************************************************************/ 04822000
*                                                                  1027 04823000
*   WPLPTR=WPLPTR+WPLLGH;           /* RESET PARM LIST MAP PTR       */ 04824000
@RF01016 DS    0H                                                  1027 04825000
@RC01011 DS    0H                                                  1027 04826000
@RC01006 DS    0H                                                  1027 04827000
@RC01001 AH    WPLPTR,WPLLGH(,WPLPTR)                              1027 04828000
*   WPLDESCE='1'B;                  /* IMMEDIATE CMD RESPONSE        */ 04829000
         OI    WPLDESCE(WPLPTR),B'00001000'                        1028 04830000
*   R0=CONSOLID;                    /* SET ID OF CONSOLE             */ 04831000
*                                                                  1029 04832000
         SLR   R0,R0                                               1029 04833000
         IC    R0,CONSOLID                                         1029 04834000
*   /*****************************************************************/ 04835000
*   /*                                                               */ 04836000
*   /* ISSUE WTO CALL                                                */ 04837000
*   /*                                                               */ 04838000
*   /*****************************************************************/ 04839000
*                                                                  1030 04840000
*   GEN(WTO MF=(E,WTOPARML));                                      1030 04841000
*                                                                  1030 04842000
         WTO MF=(E,WTOPARML)                                            04843000
*   /*****************************************************************/ 04844000
*   /*                                                               */ 04845000
*   /* RETURN TO CALLER                                              */ 04846000
*   /*                                                               */ 04847000
*   /*****************************************************************/ 04848000
*                                                                  1031 04849000
*   RETURN;                                                        1031 04850000
@EL00018 DS    0H                                                  1031 04851000
@EF00018 DS    0H                                                  1031 04852000
@ER00018 LM    @14,@12,@SA00018                                    1031 04853000
         BR    @14                                                 1031 04854000
*                                                                  1032 04855000
*   /*****************************************************************/ 04856000
*   /*                                                               */ 04857000
*   /* CONVERT BINARY TO EBCDIC ROUTINE                              */ 04858000
*   /*                                                               */ 04859000
*   /*****************************************************************/ 04860000
*                                                                  1032 04861000
*CONVBIN:                                                          1032 04862000
*   PROC(BINNUM,PRNTFLD) OPTIONS(NOSAVEAREA);                      1032 04863000
*                                                                  1032 04864000
CONVBIN  STM   @14,@12,12(@13)                                     1032 04865000
         MVC   @PC00019(8),0(@01)                                  1032 04866000
*/*  THIS ROUTINE ACCEPTS AS INPUT A BINARY NUMBER AND CONVERTS IT   */ 04867000
*/*  TO EITHER A PRINTABLE HEXADECIMAL OR DECIMAL K ADDRESS AND      */ 04868000
*/*  INSERTS IT INTO THE MESSAGE TEXT IN THE WTO PARM LIST           */ 04869000
*/*                                                                  */ 04870000
*                                                                  1033 04871000
*   DCL                                                            1033 04872000
*     BINNUM FIXED,                 /* BINARY NUMBER TO BE CONVERTED */ 04873000
*     PRNTFLD CHAR(6);              /* ANSWER FIELD                  */ 04874000
*   DCL                                                            1034 04875000
*     BLCKNUM FIXED,                /* BLOCK NUM (1K)                */ 04876000
*     BN FIXED,                     /* BINARY NUM BEING CONVERTED TO    04877000
*                                      HEX                           */ 04878000
*     CHINDX FIXED,                 /* SUB STRING PTR TO CHAR        */ 04879000
*     PKDEC CHAR(8) BDY(DWORD);     /* PACKED DECIMAL BUFR           */ 04880000
*                                                                  1034 04881000
*   /*****************************************************************/ 04882000
*   /*                                                               */ 04883000
*   /* HEX DIGIT TABLE                                               */ 04884000
*   /*                                                               */ 04885000
*   /*****************************************************************/ 04886000
*                                                                  1035 04887000
*   DCL                                                            1035 04888000
*     HEXSTRNG CHAR(16) CONSTANT('0123456789ABCDEF');              1035 04889000
*   DCL                                                            1036 04890000
*     HEXDIGIT(16) CHAR(1) BASED(ADDR(HEXSTRNG));/* MAP OF TABLE     */ 04891000
*                                                                  1036 04892000
*   /*****************************************************************/ 04893000
*   /*                                                               */ 04894000
*   /* CHECK WHICH ADDRESS MODE THE ADDRESS RANGE WAS SPECIFIED ON   */ 04895000
*   /* THE COMMAND. CONVERT THE BINARY ADDRESSES TO THE SAME MODE.   */ 04896000
*   /*                                                               */ 04897000
*   /*****************************************************************/ 04898000
*                                                                  1037 04899000
*   IF(DECMA='1'B)|(DECKA='1'B) THEN                               1037 04900000
         TM    DECMA,B'11000000'                                   1037 04901000
         BZ    @RF01037                                            1037 04902000
*     DO;                                                          1038 04903000
*                                                                  1038 04904000
*       /*************************************************************/ 04905000
*       /*                                                           */ 04906000
*       /* IF MEG ADDRESS THEN REDUCE NUMBER AND SET M               */ 04907000
*       /*                                                           */ 04908000
*       /*************************************************************/ 04909000
*                                                                  1039 04910000
*       IF DECMA='1'B THEN          /* ADDR IN MEG ?                 */ 04911000
         TM    DECMA,B'10000000'                                   1039 04912000
         BNO   @RF01039                                            1039 04913000
*         DO;                                                      1040 04914000
*           BLCKNUM=BINNUM/(1024*1024);/* ADDR IN 1M UNITS           */ 04915000
         L     @14,@PC00019                                        1041 04916000
         L     BLCKNUM,BINNUM(,@14)                                1041 04917000
         SRDA  BLCKNUM,32                                          1041 04918000
         D     BLCKNUM,@CF02884                                    1041 04919000
         LR    BLCKNUM,@03                                         1041 04920000
*           PRNTFLD(6)='M';         /* SET UNITS CHAR                */ 04921000
         L     @14,@PC00019+4                                      1042 04922000
         MVI   PRNTFLD+5(@14),C'M'                                 1042 04923000
*         END;                                                     1043 04924000
*                                                                  1043 04925000
*       /*************************************************************/ 04926000
*       /*                                                           */ 04927000
*       /* ELSE ROUND DOWN K NUMBER AND SET UNIT CHAR                */ 04928000
*       /*                                                           */ 04929000
*       /*************************************************************/ 04930000
*                                                                  1044 04931000
*       ELSE                                                       1044 04932000
*         DO;                                                      1044 04933000
         B     @RC01039                                            1044 04934000
@RF01039 DS    0H                                                  1045 04935000
*           BLCKNUM=BINNUM/1024;    /* ADDR IN 1K UNITS              */ 04936000
         L     @14,@PC00019                                        1045 04937000
         L     BLCKNUM,BINNUM(,@14)                                1045 04938000
         SRDA  BLCKNUM,32                                          1045 04939000
         D     BLCKNUM,@CF02487                                    1045 04940000
         LR    BLCKNUM,@03                                         1045 04941000
*           PRNTFLD(6)='K';         /* SET UNITS CHAR                */ 04942000
         L     @14,@PC00019+4                                      1046 04943000
         MVI   PRNTFLD+5(@14),C'K'                                 1046 04944000
*         END;                                                     1047 04945000
*       CVD(BLCKNUM,PKDEC);         /* CONVERT TO DECIMAL            */ 04946000
@RC01039 CVD   BLCKNUM,PKDEC                                       1048 04947000
*       UNPK(PRNTFLD(1:5),PKDEC);   /* UNPACK AND STORE IN MESSAGE   */ 04948000
         L     @14,@PC00019+4                                      1049 04949000
         UNPK  PRNTFLD(5,@14),PKDEC(8)                             1049 04950000
*       PRNTFLD(5)=PRNTFLD(5)|'F0'X;/* SET NUMERIC ZONE FOR LOW ORDER   04951000
*                                      BYTE                          */ 04952000
*                                                                  1050 04953000
         OI    PRNTFLD+4(@14),X'F0'                                1050 04954000
*       /*************************************************************/ 04955000
*       /*                                                           */ 04956000
*       /* BLANK OUT LEADING ZEROS                                   */ 04957000
*       /*                                                           */ 04958000
*       /*************************************************************/ 04959000
*                                                                  1051 04960000
*       DO CHINDX=1 TO 4 WHILE(PRNTFLD(CHINDX)='0');               1051 04961000
         LA    CHINDX,1                                            1051 04962000
@DL01051 L     @14,@PC00019+4                                      1051 04963000
         LR    @03,@14                                             1051 04964000
         ALR   @03,CHINDX                                          1051 04965000
         BCTR  @03,0                                               1051 04966000
         CLI   PRNTFLD(@03),C'0'                                   1051 04967000
         BNE   @DC01051                                            1051 04968000
*         PRNTFLD(CHINDX)=' ';      /* BLANK LEADING ZERO            */ 04969000
         ALR   @14,CHINDX                                          1052 04970000
         BCTR  @14,0                                               1052 04971000
         MVI   PRNTFLD(@14),C' '                                   1052 04972000
*       END;                                                       1053 04973000
         AL    CHINDX,@CF00066                                     1053 04974000
         CH    CHINDX,@CH00165                                     1053 04975000
         BNH   @DL01051                                            1053 04976000
@DC01051 DS    0H                                                  1054 04977000
*     END;                                                         1054 04978000
*                                                                  1054 04979000
*   /*****************************************************************/ 04980000
*   /*                                                               */ 04981000
*   /* CONVERT BINARY TO HEXADECIMAL                                 */ 04982000
*   /*                                                               */ 04983000
*   /*****************************************************************/ 04984000
*                                                                  1055 04985000
*   ELSE                                                           1055 04986000
*     DO;                                                          1055 04987000
         B     @RC01037                                            1055 04988000
@RF01037 DS    0H                                                  1056 04989000
*       BN=BINNUM;                  /* GET NUM TO BE CONVERTED       */ 04990000
         L     @14,@PC00019                                        1056 04991000
         L     BN,BINNUM(,@14)                                     1056 04992000
*       PRNTFLD='';                 /* BLANK ANSWER FIELD            */ 04993000
         L     @14,@PC00019+4                                      1057 04994000
         MVI   PRNTFLD(@14),C' '                                   1057 04995000
         MVC   PRNTFLD+1(5,@14),PRNTFLD(@14)                       1057 04996000
*       PRNTFLD(6)='0';             /* INIT ANSWER FIELD             */ 04997000
         MVI   PRNTFLD+5(@14),C'0'                                 1058 04998000
*       CHINDX=6;                   /* INIT SUB STRING PTR           */ 04999000
         LA    CHINDX,6                                            1059 05000000
*       DO WHILE(BN^=0);            /* CONVERT NUM LOOP              */ 05001000
*                                                                  1060 05002000
         B     @DE01060                                            1060 05003000
@DL01060 DS    0H                                                  1061 05004000
*         /***********************************************************/ 05005000
*         /*                                                         */ 05006000
*         /* CONVERT ADDR CHARACTER BY CHARACTER USING HEX DIGIT     */ 05007000
*         /* TABLE                                                   */ 05008000
*         /*                                                         */ 05009000
*         /***********************************************************/ 05010000
*                                                                  1061 05011000
*         PRNTFLD(CHINDX)=HEXDIGIT((BN//16)+1);/* COPY HEX CHAR FROM    05012000
*                                      HEX TABLE                     */ 05013000
         L     @14,@PC00019+4                                      1061 05014000
         ALR   @14,CHINDX                                          1061 05015000
         BCTR  @14,0                                               1061 05016000
         LR    @04,BN                                              1061 05017000
         SRDA  @04,32                                              1061 05018000
         D     @04,@CF00064                                        1061 05019000
         LA    @05,@CC02833                                        1061 05020000
         ALR   @05,@04                                             1061 05021000
         MVC   PRNTFLD(1,@14),HEXDIGIT(@05)                        1061 05022000
*         BN=BN/16;                 /* REDUCE BIN NUMBER             */ 05023000
         LR    @04,BN                                              1062 05024000
         SRDA  @04,32                                              1062 05025000
         D     @04,@CF00064                                        1062 05026000
         LR    BN,@05                                              1062 05027000
*         CHINDX=CHINDX-1;          /* DECR SUB STRING PTR           */ 05028000
         BCTR  CHINDX,0                                            1063 05029000
*       END;                                                       1064 05030000
@DE01060 LTR   BN,BN                                               1064 05031000
         BNZ   @DL01060                                            1064 05032000
*     END;                                                         1065 05033000
*                                                                  1065 05034000
*   /*****************************************************************/ 05035000
*   /*                                                               */ 05036000
*   /* RETURN TO WTORTN ROUTINE                                      */ 05037000
*   /*                                                               */ 05038000
*   /*****************************************************************/ 05039000
*                                                                  1066 05040000
*   RETURN;                                                        1066 05041000
@EL00019 DS    0H                                                  1066 05042000
@EF00019 DS    0H                                                  1066 05043000
@ER00019 LM    @14,@12,12(@13)                                     1066 05044000
         BR    @14                                                 1066 05045000
*   END CONVBIN;                                                   1067 05046000
         B     @EL00019                                            1067 05047000
*   END WTORTN;                                                    1068 05048000
*                                                                  1069 05049000
*   /*****************************************************************/ 05050000
*   /*                                                               */ 05051000
*   /* SERIALIZE VARY STORAGE CODE AND PAGE FIX VALIDATE'S CODE      */ 05052000
*   /*                                                               */ 05053000
*   /*****************************************************************/ 05054000
*                                                                  1069 05055000
*SERIALZE:                                                         1069 05056000
*   PROC OPTIONS(NOSAVEAREA);                                      1069 05057000
*                                                                  1069 05058000
SERIALZE STM   @14,@12,12(@13)                                     1069 05059000
*   /*****************************************************************/ 05060000
*   /*                                                               */ 05061000
*   /* SERIALIZE CODE USING SYSZVARY,VALIDATE                        */ 05062000
*   /*                                                               */ 05063000
*   /*****************************************************************/ 05064000
*                                                                  1070 05065000
*   DO;                             /* ENQ (QNAME,RNAME,E,8,SYSTEM)  */ 05066000
*     RESPECIFY                                                    1071 05067000
*      (GPR01P) RESTRICTED;                                        1071 05068000
*     I056(1:16)=I056(1:16)&&I056(1:16);/* ZERO OUT THE TABLE        */ 05069000
         XC    I056(16),I056                                       1072 05070000
*     I05604(1)=8;                  /* LENGTH OF MINOR RESOURCE NAME */ 05071000
         MVI   I05604,X'08'                                        1073 05072000
*     I05606(1)=ADDR(QNAME);        /* ADDRESS OF MAJOR RESOURCE NAME*/ 05073000
         LA    @14,QNAME                                           1074 05074000
         ST    @14,I05606                                          1074 05075000
*     I05607(1)=ADDR(RNAME);        /* ADDRESS OF MINOR RESOURCE NAME*/ 05076000
         LA    @14,RNAME                                           1075 05077000
         ST    @14,I05607                                          1075 05078000
*     I05603(1)='01000000'B;        /* SET BIT STRING 1 FOR RESOURCE    05079000
*                                      ELEMENT                       */ 05080000
         MVI   I05603,B'01000000'                                  1076 05081000
*     I05605(1)='01000000'B;        /* SET BIT STRING 2 FOR RESOURCE    05082000
*                                      ELEMENT                       */ 05083000
         MVI   I05605,B'01000000'                                  1077 05084000
*     I05603(1,1)='1'B;             /* SET END OF LIST BIT           */ 05085000
         OI    I05603,B'10000000'                                  1078 05086000
*     GPR01P=ADDR(I05602);          /* LOAD LIST ADDRESS             */ 05087000
         LA    GPR01P,I05602                                       1079 05088000
*     SVC(56);                      /* ISSUE ENQ SVC                 */ 05089000
         SVC   56                                                  1080 05090000
*     RESPECIFY                                                    1081 05091000
*      (GPR01P) UNRESTRICTED;                                      1081 05092000
*   END;                            /* ENQ (QNAME,RNAME,E,8,SYSTEM)  */ 05093000
*                                                                  1082 05094000
*   /*****************************************************************/ 05095000
*   /*                                                               */ 05096000
*   /* PAGE FIX VALIDATE'S CODE                                      */ 05097000
*   /*                                                               */ 05098000
*   /*****************************************************************/ 05099000
*                                                                  1083 05100000
*   DO;                             /* PGFIX (R) A(STRTVAL)        1083 05101000
*                                      EA(ENDVAL) ECB(VFIXECB)     1083 05102000
*                                      LONG(N) RELEASE(N)            */ 05103000
*     RESPECIFY                                                    1084 05104000
*      (GPR00P,                                                    1084 05105000
*       GPR01P) RESTRICTED;                                        1084 05106000
*     GPR00P=ADDR(VFIXECB);         /* ECB ADDR                      */ 05107000
         LA    GPR00P,VFIXECB                                      1085 05108000
*     GPR01P=ADDR(STRTVAL);         /* PAGE ADDR                     */ 05109000
         L     @14,AVALRTN                                         1086 05110000
         LR    GPR01P,@14                                          1086 05111000
*     RESPECIFY                                                    1087 05112000
*       GPR15P RESTRICTED;                                         1087 05113000
*     GPR15P=ADDR(ENDVAL);          /* VSL ADDR                      */ 05114000
         AL    @14,@CF00139                                        1088 05115000
         LR    GPR15P,@14                                          1088 05116000
*     GPR01P=GPR01P|'50000000'X;    /* R, PGFIX, RELEASE & LONG FLAGS*/ 05117000
         O     GPR01P,@CF02851                                     1089 05118000
*     SVC(113);                     /* ISSUE PGFIX SVC               */ 05119000
         SVC   113                                                 1090 05120000
*     RESPECIFY                                                    1091 05121000
*      (GPR00P,                                                    1091 05122000
*       GPR01P) UNRESTRICTED;                                      1091 05123000
*     RESPECIFY                                                    1092 05124000
*       GPR15P UNRESTRICTED;                                       1092 05125000
*   END;                            /* PGFIX (R) A(STRTVAL)        1093 05126000
*                                      EA(ENDVAL) ECB(VFIXECB)     1093 05127000
*                                      LONG(N) RELEASE(N)            */ 05128000
*   IF^((R15=0)|(R15=8)) THEN       /* ANY ERRORS?                   */ 05129000
         LTR   R15,R15                                             1094 05130000
         BZ    @RF01094                                            1094 05131000
         CH    R15,@CH00058                                        1094 05132000
         BE    @RF01094                                            1094 05133000
*     DO;                           /* ABEND(183) SYSTEM             */ 05134000
*       RESPECIFY                                                  1096 05135000
*        (GPR01F) RESTRICTED;                                      1096 05136000
*       GPR01F=((183)&'00000FFF'X)*4096;/* COMP CODE IN BITS 8-19    */ 05137000
         L     GPR01F,@CF02885                                     1097 05138000
*       SVC(13);                    /* ISSUE ABEND SVC               */ 05139000
         SVC   13                                                  1098 05140000
*       RESPECIFY                                                  1099 05141000
*        (GPR01F) UNRESTRICTED;                                    1099 05142000
*     END;                          /* ABEND(183) SYSTEM YES, ABEND     05143000
*                                                            @YM03534*/ 05144000
*   IF R15=8 THEN                   /* STILL PENDING                 */ 05145000
@RF01094 CH    R15,@CH00058                                        1101 05146000
         BNE   @RF01101                                            1101 05147000
*     DO;                                                          1102 05148000
*       DO;                         /* WAIT (1) ECB(VFIXECB)         */ 05149000
*         RESPECIFY                                                1104 05150000
*          (GPR00P,                                                1104 05151000
*           GPR01P) RESTRICTED;                                    1104 05152000
*         GPR00P=1;                 /* LOAD WAIT COUNT               */ 05153000
         LA    GPR00P,1                                            1105 05154000
*         GPR01P=ADDR(VFIXECB);     /* ADDRESS OF ECB                */ 05155000
         LA    GPR01P,VFIXECB                                      1106 05156000
*         SVC(1);                   /* WAIT SVC                      */ 05157000
         SVC   1                                                   1107 05158000
*         RESPECIFY                                                1108 05159000
*          (GPR00P,                                                1108 05160000
*           GPR01P) UNRESTRICTED;                                  1108 05161000
*       END;                        /* WAIT (1) ECB(VFIXECB) YES,  1109 05162000
*                                      WAIT TILL DONE                */ 05163000
*       IF VFIXCODE=4 THEN          /* ERROR ENCOUNTERED             */ 05164000
         CLC   VFIXCODE(3),@CF00165+1                              1110 05165000
         BNE   @RF01110                                            1110 05166000
*         DO;                       /* ABEND(183) SYSTEM             */ 05167000
*           RESPECIFY                                              1112 05168000
*            (GPR01F) RESTRICTED;                                  1112 05169000
*           GPR01F=((183)&'00000FFF'X)*4096;/* COMP CODE IN BITS 8-19*/ 05170000
         L     GPR01F,@CF02885                                     1113 05171000
*           SVC(13);                /* ISSUE ABEND SVC               */ 05172000
         SVC   13                                                  1114 05173000
*           RESPECIFY                                              1115 05174000
*            (GPR01F) UNRESTRICTED;                                1115 05175000
*         END;                      /* ABEND(183) SYSTEM YES, ABEND     05176000
*                                                            @YM03534*/ 05177000
*     END;                                                         1117 05178000
@RF01110 DS    0H                                                  1118 05179000
*   VFIXFLG='1'B;                   /* SET PAGE FIXED FLAG           */ 05180000
*                                                                  1118 05181000
@RF01101 OI    VFIXFLG,B'00010000'                                 1118 05182000
*   /*****************************************************************/ 05183000
*   /*                                                               */ 05184000
*   /* RETURN TO CALLER                                              */ 05185000
*   /*                                                               */ 05186000
*   /*****************************************************************/ 05187000
*                                                                  1119 05188000
*   RETURN;                                                        1119 05189000
@EL00020 DS    0H                                                  1119 05190000
@EF00020 DS    0H                                                  1119 05191000
@ER00020 LM    @14,@12,12(@13)                                     1119 05192000
         BR    @14                                                 1119 05193000
*   END SERIALZE;                                                  1120 05194000
*                                                                  1121 05195000
*   /*****************************************************************/ 05196000
*   /*                                                               */ 05197000
*   /* PAGE FREE VALIDATE'S CODE AND REMOVE SERIALIZATION            */ 05198000
*   /*                                                               */ 05199000
*   /*****************************************************************/ 05200000
*                                                                  1121 05201000
*UNSERLZE:                                                         1121 05202000
*   PROC OPTIONS(NOSAVEAREA);                                      1121 05203000
*                                                                  1121 05204000
UNSERLZE STM   @14,@12,12(@13)                                     1121 05205000
*   /*****************************************************************/ 05206000
*   /*                                                               */ 05207000
*   /* PAGE FREE CODE IF FIXED                                       */ 05208000
*   /*                                                               */ 05209000
*   /*****************************************************************/ 05210000
*                                                                  1122 05211000
*   IF VFIXFLG='1'B THEN                                           1122 05212000
         TM    VFIXFLG,B'00010000'                                 1122 05213000
         BNO   @RF01122                                            1122 05214000
*     DO;                           /* PGFREE(R) A(STRTVAL)        1123 05215000
*                                      EA(ENDVAL) ECB(VFIXECB)     1123 05216000
*                                      RELEASE(N)                    */ 05217000
*       RESPECIFY                                                  1124 05218000
*        (GPR00P,                                                  1124 05219000
*         GPR01P) RESTRICTED;                                      1124 05220000
*       GPR00P=ADDR(VFIXECB);       /* ECB ADDR                      */ 05221000
         LA    GPR00P,VFIXECB                                      1125 05222000
*       GPR01P=ADDR(STRTVAL);       /* PAGE ADDR                     */ 05223000
         L     @14,AVALRTN                                         1126 05224000
         LR    GPR01P,@14                                          1126 05225000
*       RESPECIFY                                                  1127 05226000
*         GPR15P RESTRICTED;                                       1127 05227000
*       GPR15P=ADDR(ENDVAL);        /* VSL ADDR                      */ 05228000
         AL    @14,@CF00139                                        1128 05229000
         LR    GPR15P,@14                                          1128 05230000
*       GPR01P=GPR01P|'20000000'X;  /* R, PGFREE & RELEASE FLAG      */ 05231000
         O     GPR01P,@CF02582                                     1129 05232000
*       SVC(113);                   /* ISSUE PGFREE SVC              */ 05233000
         SVC   113                                                 1130 05234000
*       RESPECIFY                                                  1131 05235000
*        (GPR00P,                                                  1131 05236000
*         GPR01P,                                                  1131 05237000
*         GPR15P) UNRESTRICTED;                                    1131 05238000
*     END;                          /* PGFREE(R) A(STRTVAL)        1132 05239000
*                                      EA(ENDVAL) ECB(VFIXECB)     1132 05240000
*                                      RELEASE(N)                    */ 05241000
*                                                                  1132 05242000
*   /*****************************************************************/ 05243000
*   /*                                                               */ 05244000
*   /* DEQ OFF SYSZVARY,VALIDATE RESOURCE                            */ 05245000
*   /*                                                               */ 05246000
*   /*****************************************************************/ 05247000
*                                                                  1133 05248000
*   DO;                             /* DEQ (QNAME,RNAME,8,SYSTEM)  1133 05249000
*                                      RET(HAVE)                     */ 05250000
@RF01122 DS    0H                                                  1134 05251000
*     I048(1:20)=I048(1:20)&&I048(1:20);                           1134 05252000
         XC    I048(20),I048                                       1134 05253000
*     RFY                                                          1135 05254000
*       GPR01F RESTRICTED;                                         1135 05255000
*     I04804(1)='11000000'B;        /* LISTEND BYTE                  */ 05256000
         MVI   I04804,B'11000000'                                  1136 05257000
*     I04805(1)=8;                  /* SET LENGTH                    */ 05258000
         MVI   I04805,X'08'                                        1137 05259000
*     I04806(1)='01000001'B;        /* OPTIONS                       */ 05260000
         MVI   I04806,B'01000001'                                  1138 05261000
*     I04807(1)=ADDR(QNAME);        /* QNAME ADDRESS                 */ 05262000
         LA    @14,QNAME                                           1139 05263000
         ST    @14,I04807                                          1139 05264000
*     I04808(1)=ADDR(RNAME);        /* RNAME ADDRESS                 */ 05265000
         LA    @14,RNAME                                           1140 05266000
         ST    @14,I04808                                          1140 05267000
*     GPR01F=ADDR(I04802);                                         1141 05268000
         LA    GPR01F,I04802                                       1141 05269000
*     SVC(48);                                                     1142 05270000
         SVC   48                                                  1142 05271000
*     RFY                                                          1143 05272000
*       GPR01F UNRESTRICTED;                                       1143 05273000
*   END;                            /* DEQ (QNAME,RNAME,8,SYSTEM)  1144 05274000
*                                      RET(HAVE)                     */ 05275000
*                                                                  1144 05276000
*   /*****************************************************************/ 05277000
*   /*                                                               */ 05278000
*   /* RETURN TO CALLER                                              */ 05279000
*   /*                                                               */ 05280000
*   /*****************************************************************/ 05281000
*                                                                  1145 05282000
*   RETURN;                                                        1145 05283000
@EL00021 DS    0H                                                  1145 05284000
@EF00021 DS    0H                                                  1145 05285000
@ER00021 LM    @14,@12,12(@13)                                     1145 05286000
         BR    @14                                                 1145 05287000
*   END UNSERLZE;                                                  1146 05288000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 05289000
*     GPR00F FIXED(31) REG(0),                                     1147 05290000
*     GPR01F FIXED(31) REG(1),                                     1147 05291000
*     GPR12F FIXED(31) REG(12),                                    1147 05292000
*     GPR15F FIXED(31) REG(15),                                    1147 05293000
*     GPR00P PTR(31) REG(0),                                       1147 05294000
*     GPR01P PTR(31) REG(1),                                       1147 05295000
*     GPR02P PTR(31) REG(2),                                       1147 05296000
*     GPR13P PTR(31) REG(13),                                      1147 05297000
*     GPR14P PTR(31) REG(14),                                      1147 05298000
*     GPR15P PTR(31) REG(15);                                      1147 05299000
*   DCL                                                            1148 05300000
*     1 I056 DEF(ILIST) BDY(WORD) CHAR(32767),/* LIST FOR ENQ        */ 05301000
*       3 I05601 PTR(31),           /* TCB OR ECB ADDRESS            */ 05302000
*       3 I05602(*) CHAR(12) BDY(WORD),/* ARRAY OF RESOURCE ELEMENTS */ 05303000
*         5 I05603 BIT(8),          /* BIT FLAGS 1                   */ 05304000
*         5 I05604 PTR(8),          /* MINOR RESOURCE NAME LENGTH    */ 05305000
*         5 I05605 BIT(8),          /* BIT FLAGS 2                   */ 05306000
*         5 I05655 CHAR(1),         /* CONTROL PGM USE               */ 05307000
*         5 I05606 PTR(31),         /* MAJOR RESOURCE NAME ADDR      */ 05308000
*         5 I05607 PTR(31);         /* MINOR RESOURCE NAME ADDR      */ 05309000
*   DCL                                                            1149 05310000
*     1 I048 DEF(ILIST) CHAR(32767) BDY(WORD),                     1149 05311000
*       3 I04801 PTR(31),           /* TCB ADDR                      */ 05312000
*       3 I04802(*) CHAR(12) BDY(WORD),                            1149 05313000
*         5 I04803 PTR(31),         /* UCB @ IN LAST ENTRY           */ 05314000
*           7 I04804 BIT(8),        /* FLAGS                         */ 05315000
*           7 I04805 PTR(8),        /* MINOR RESOURCE NAME LENGTH    */ 05316000
*           7 I04806 BIT(8),        /* FLAGS                         */ 05317000
*           7 * CHAR(1),            /* CONTROL PROGRAM USE           */ 05318000
*         5 I04807 PTR(31),         /* MAJOR RESOURCE NAME @         */ 05319000
*         5 I04808 PTR(31);         /* MINOR RESOURCE NAME @         */ 05320000
*   DECLARE                                                        1150 05321000
*     ILIST CHAR(20) BDY(DWORD);    /* STANDARD LIST                 */ 05322000
*   DECLARE                         /* COMMON VARIABLES              */ 05323000
*     I256C CHAR(256) BASED,                                       1151 05324000
*     I031F FIXED(31) BASED,                                       1151 05325000
*     I031P PTR(31) BASED,                                         1151 05326000
*     I015F FIXED(15) BASED,                                       1151 05327000
*     I015P PTR(15) BASED,                                         1151 05328000
*     I008P PTR(8) BASED,                                          1151 05329000
*     I001C CHAR(1) BASED;                                         1151 05330000
*                                                                  1151 05331000
*   /*****************************************************************/ 05332000
*   /*                                                               */ 05333000
*   /* ZAP AREA FOR MAINTENANCE                                      */ 05334000
*   /*                                                               */ 05335000
*   /*****************************************************************/ 05336000
*                                                                  1152 05337000
*ZAPAREA:                                                          1152 05338000
*   GEN( DC  25F'0');                                              1152 05339000
ZAPAREA   DC  25F'0'                                                    05340000
*   END IEEMPVST                                                   1153 05341000
*                                                                  1153 05342000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 05343000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 05344000
*/*%INCLUDE SYSLIB  (IEECHAIN)                                       */ 05345000
*/*%INCLUDE SYSLIB  (IEECUCM )                                       */ 05346000
*/*%INCLUDE SYSLIB  (IFASMFR )                                       */ 05347000
*/*%INCLUDE SYSLIB  (IFASMFR1)                                       */ 05348000
*/*%INCLUDE SYSLIB  (IFASMFR2)                                       */ 05349000
*/*%INCLUDE SYSLIB  (IFASMFR3)                                       */ 05350000
*/*%INCLUDE SYSLIB  (IFASMFR4)                                       */ 05351000
*/*%INCLUDE SYSLIB  (IFASMFR5)                                       */ 05352000
*/*%INCLUDE SYSLIB  (IFASMFR6)                                       */ 05353000
*/*%INCLUDE SYSLIB  (IFASMFR7)                                       */ 05354000
*/*%INCLUDE SYSLIB  (IFASMFR8)                                       */ 05355000
*/*%INCLUDE SYSLIB  (IFASMFR9)                                       */ 05356000
*/*%INCLUDE SYSLIB  (IFASMFRA)                                       */ 05357000
*/*%INCLUDE SYSLIB  (IFASMFRB)                                       */ 05358000
*/*%INCLUDE SYSLIB  (IFASMFRC)                                       */ 05359000
*/*%INCLUDE SYSLIB  (IFASMFRD)                                       */ 05360000
*/*%INCLUDE SYSLIB  (IEZWPL  )                                       */ 05361000
*/*%INCLUDE SYSLIB  (IHAESTA )                                       */ 05362000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 05363000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 05364000
*/*%INCLUDE SYSLIB  (IHAASVT )                                       */ 05365000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 05366000
*/*%INCLUDE SYSLIB  (IHAPVT  )                                       */ 05367000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 05368000
*                                                                  1153 05369000
*       ;                                                          1153 05370000
         B     @EL00001                                            1153 05371000
@DATA    DS    0H                                                       05372000
@CH02856 DC    H'20'                                                    05373000
@CH02650 DC    H'22'                                                    05374000
@CH01253 DC    H'28'                                                    05375000
@CH02497 DC    H'192'                                                   05376000
@CH02485 DC    H'240'                                                   05377000
@CH02883 DC    H'-4095'                                                 05378000
@SM02915 MVC   WPLTXT(0,WPLPTR),MTEXT(MSGPTR)                           05379000
         DS    0F                                                       05380000
@AL00132 EQU   *                       LIST WITH   1 ARGUMENT(S)        05381000
@AL00927 DC    A(@CF00851)             LIST WITH   1 ARGUMENT(S)        05382000
@AL00190 DC    A(@CF00874)             LIST WITH   1 ARGUMENT(S)        05383000
@AL00193 DC    A(@CF00037)             LIST WITH   1 ARGUMENT(S)        05384000
@AL00196 DC    A(@CF00058)             LIST WITH   1 ARGUMENT(S)        05385000
@AL00270 EQU   *                       LIST WITH   1 ARGUMENT(S)        05386000
@AL00625 DC    A(@CF00182)             LIST WITH   1 ARGUMENT(S)        05387000
@AL00295 DC    A(@CF01117)             LIST WITH   1 ARGUMENT(S)        05388000
@AL00302 DC    A(@CF00036)             LIST WITH   1 ARGUMENT(S)        05389000
@AL00306 DC    A(@CF00035)             LIST WITH   1 ARGUMENT(S)        05390000
@AL00308 EQU   *                       LIST WITH   1 ARGUMENT(S)        05391000
@AL00721 EQU   *                       LIST WITH   1 ARGUMENT(S)        05392000
@AL00761 DC    A(@CF00397)             LIST WITH   1 ARGUMENT(S)        05393000
@AL00657 EQU   *                       LIST WITH   1 ARGUMENT(S)        05394000
@AL00758 DC    A(@CF00066)             LIST WITH   1 ARGUMENT(S)        05395000
@AL00737 DC    A(@CF00165)             LIST WITH   1 ARGUMENT(S)        05396000
@AL00790 DC    A(@CF01580)             LIST WITH   1 ARGUMENT(S)        05397000
@AL00902 DC    A(@CF01028)             LIST WITH   1 ARGUMENT(S)        05398000
@DATD    DSECT                                                          05399000
         DS    0F                                                       05400000
@SA00001 DS    18F                                                      05401000
@PC00001 DS    1F                                                       05402000
@SA00002 DS    15F                                                      05403000
@SA00006 DS    15F                                                      05404000
@SA00012 DS    15F                                                      05405000
@SA00018 DS    15F                                                      05406000
@PC00018 DS    1F                                                       05407000
@SA00015 DS    15F                                                      05408000
@SA00011 DS    15F                                                      05409000
@SA00007 DS    15F                                                      05410000
@SA00016 DS    15F                                                      05411000
@SA00013 DS    15F                                                      05412000
@SA00014 DS    15F                                                      05413000
@PC00019 DS    2F                                                       05414000
@AL00001 DS    3A                                                       05415000
IEEMPVST CSECT                                                          05416000
         DS    0F                                                       05417000
@CF00148 DC    F'0'                                                     05418000
@CF00066 DC    F'1'                                                     05419000
@CH00066 EQU   @CF00066+2                                               05420000
@CF00182 DC    F'2'                                                     05421000
@CH00182 EQU   @CF00182+2                                               05422000
@CF00397 DC    F'3'                                                     05423000
@CH00397 EQU   @CF00397+2                                               05424000
@CF00165 DC    F'4'                                                     05425000
@CH00165 EQU   @CF00165+2                                               05426000
@CF01117 DC    F'5'                                                     05427000
@CH01117 EQU   @CF01117+2                                               05428000
@CF01580 DC    F'6'                                                     05429000
@CH01580 EQU   @CF01580+2                                               05430000
@CF00851 DC    F'7'                                                     05431000
@CF00058 DC    F'8'                                                     05432000
@CH00058 EQU   @CF00058+2                                               05433000
@CF00874 DC    F'9'                                                     05434000
@CF00035 DC    F'10'                                                    05435000
@CH00035 EQU   @CF00035+2                                               05436000
@CF00036 DC    F'11'                                                    05437000
@CF00037 DC    F'12'                                                    05438000
@CF01028 DC    F'13'                                                    05439000
@CF00064 DC    F'16'                                                    05440000
@CH00064 EQU   @CF00064+2                                               05441000
@CF02487 DC    F'1024'                                                  05442000
@CF00139 DC    F'4096'                                                  05443000
@CH00139 EQU   @CF00139+2                                               05444000
@CF02887 DC    F'62720'                                                 05445000
@CF02888 DC    F'64768'                                                 05446000
@CF02885 DC    F'749568'                                                05447000
@CF02884 DC    F'1048576'                                               05448000
@CF02903 DC    F'-4'                                                    05449000
@CF02438 DC    F'-1'                                                    05450000
@CH02438 EQU   @CF02438+2                                               05451000
@CF02569 DC    XL4'52000000'                                            05452000
@CF02576 DC    XL4'04000000'                                            05453000
@CF02582 DC    XL4'20000000'                                            05454000
@CF02851 DC    XL4'50000000'                                            05455000
@DATD    DSECT                                                          05456000
         DS    0D                                                       05457000
SRANGE   DS    F                                                        05458000
ERANGE   DS    F                                                        05459000
RSRWAP   DS    A                                                        05460000
RSRWAL   DS    F                                                        05461000
RSRSTATP DS    A                                                        05462000
RC       DS    F                                                        05463000
DUMMY    DS    A                                                        05464000
UCMFXPTR DS    A                                                        05465000
UCMPXPTR DS    A                                                        05466000
CONSOLID DS    FL1                                                      05467000
         DS    CL3                                                      05468000
@NM00001 DS    CL12                                                     05469000
         ORG   @NM00001                                                 05470000
ENTRYPT  DS    FL4                                                      05471000
STRTMWA  DS    FL4                                                      05472000
ENDMWA   DS    FL4                                                      05473000
         ORG   ENDMWA                                                   05474000
HOBEDMWA DS    BL1                                                      05475000
@NM00002 DS    AL3                                                      05476000
         ORG   @NM00001+12                                              05477000
FUNCBITS DS    BL2                                                      05478000
         ORG   FUNCBITS                                                 05479000
OFFLINE  DS    BL1                                                      05480000
ALRDOFF  EQU   FUNCBITS+0                                               05481000
ALRDON   EQU   FUNCBITS+0                                               05482000
VFIXFLG  EQU   FUNCBITS+0                                               05483000
GOODRTCA EQU   FUNCBITS+0                                               05484000
WTORFLAG EQU   FUNCBITS+0                                               05485000
OFFDONE  EQU   FUNCBITS+0                                               05486000
@NM00003 EQU   FUNCBITS+0                                               05487000
TYPEADDR DS    BL1                                                      05488000
         ORG   TYPEADDR                                                 05489000
DECMA    DS    BL1                                                      05490000
DECKA    EQU   TYPEADDR+0                                               05491000
HEXA     EQU   TYPEADDR+0                                               05492000
         ORG   FUNCBITS+2                                               05493000
         DS    CL2                                                      05494000
EPARML   DS    CL12                                                     05495000
         ORG   EPARML                                                   05496000
DATARG   DS    FL4                                                      05497000
CODERG1  DS    FL4                                                      05498000
CODERG2  DS    FL4                                                      05499000
         ORG   EPARML+12                                                05500000
@NM00011 DS    CL4                                                      05501000
         ORG   @NM00011                                                 05502000
INTERROR DS    FL4                                                      05503000
         ORG   @NM00011+4                                               05504000
VALSTWA  DS    CL12                                                     05505000
         ORG   VALSTWA                                                  05506000
VALFRA   DS    AL4                                                      05507000
VALFC    DS    FL4                                                      05508000
FRAMEPTR DS    AL4                                                      05509000
         ORG   VALSTWA+12                                               05510000
@NM00012 DS    CL1                                                      05511000
         ORG   @NM00012                                                 05512000
VALOFF   DS    BL1                                                      05513000
         ORG   @NM00012+1                                               05514000
         DS    CL3                                                      05515000
@NM00013 DS    CL8                                                      05516000
         ORG   @NM00013                                                 05517000
AVALRTN  DS    AL4                                                      05518000
VFIXECB  DS    FL4                                                      05519000
         ORG   VFIXECB                                                  05520000
         DS    CL1                                                      05521000
VFIXCODE DS    AL3                                                      05522000
         ORG   @NM00013+8                                               05523000
@NM00016 DS    CL4                                                      05524000
         ORG   @NM00016                                                 05525000
CSCBPTR  DS    AL4                                                      05526000
         ORG   @NM00016+4                                               05527000
SMFBUFR  DS    CL32                                                     05528000
WTOPARML DS    CL130                                                    05529000
         DS    CL2                                                      05530000
WTORPL   DS    CL69                                                     05531000
ESTLIST  DS    CL16                                                     05532000
         DS    CL3                                                      05533000
SDUMPI   DS    CL70                                                     05534000
FOFFFLAG DS    BL1                                                      05535000
         ORG   FOFFFLAG                                                 05536000
INLOOP   DS    BL1                                                      05537000
PGFIXFLG EQU   FOFFFLAG+0                                               05538000
         ORG   FOFFFLAG+1                                               05539000
         DS    CL1                                                      05540000
MAPBOUND DS    CL8                                                      05541000
         ORG   MAPBOUND                                                 05542000
STRTRNGE DS    FL4                                                      05543000
ENDRNGE  DS    FL4                                                      05544000
         ORG   MAPBOUND+8                                               05545000
RUBWA    DS    CL68                                                     05546000
         ORG   RUBWA                                                    05547000
@NM00105 DS    CL2                                                      05548000
RUBSA    DS    CL66                                                     05549000
         ORG   RUBSA                                                    05550000
RREGSFLG DS    CL2                                                      05551000
RREGSSA  DS    CL64                                                     05552000
         ORG   RUBWA+68                                                 05553000
@NM00106 DS    CL5                                                      05554000
         ORG   @NM00106                                                 05555000
WTORECB  DS    FL4                                                      05556000
WTOREPLY DS    CL1                                                      05557000
         ORG   @NM00106+5                                               05558000
ADRTYPE  DS    BL1                                                      05559000
         DS    CL6                                                      05560000
PKDEC    DS    CL8                                                      05561000
ILIST    DS    CL20                                                     05562000
ESTAESA  DS    18F                                                      05563000
IEEMPVST CSECT                                                          05564000
         DS    0F                                                       05565000
@SIZDATD DC    AL1(0)                                                   05566000
         DC    AL3(@ENDDATD-@DATD)                                      05567000
@CA00028 DC    A(IEEMPVST)                                              05568000
@CV00128 DC    V(IEEVALST)                                              05569000
         DS    0D                                                       05570000
@CC02833 DC    C'0123456789ABCDEF'                                      05571000
@CC02476 DC    C'),OFFLINE '                                            05572000
@CC02473 DC    C'),ONLINE '                                             05573000
@CC02667 DC    C'IEEMPVST'                                              05574000
@CC02668 DC    C'ESTAERTN'                                              05575000
@CB02659 DC    X'0C5000'                                                05576000
@CB02663 DC    X'0C5FFF'                                                05577000
@CB02462 DC    X'E000'                                                  05578000
@CB02572 DC    X'FFFF'                                                  05579000
QNAME    DC    CL8'SYSZVARY'                                            05580000
RNAME    DC    CL8'VALIDATE'                                            05581000
         DS    CL3                                                      05582000
WTORL    DS    CL69                                                     05583000
         ORG   WTORL                                                    05584000
WTORL01  DC    AL1(1)                                                   05585000
WTORL02  DC    AL3(@CF00148)                                            05586000
WTORL03  DC    AL4(@CF00148)                                            05587000
WTORL04  DC    H'57'                                                    05588000
WTORL05  DC    B'1100000000000000'                                      05589000
WTORL06  DC    CL53'IEE765D ENTER OPTION FOR VARY ONLINE:SELECT 0,1, ORC05590000
                2'                                                      05591000
WTORL07  DC    B'0100000000000000'                                      05592000
WTORL08  DC    B'0000000000000000'                                      05593000
         ORG   WTORL+69                                                 05594000
         DS    CL3                                                      05595000
WAITTIME DC    CL8'00000100'                                            05596000
MSGTBLE  DS    CL708                                                    05597000
         ORG   MSGTBLE                                                  05598000
@NM00107 DC    AL1(51)                                                  05599000
@NM00108 DC    AL1(1)                                                   05600000
@NM00109 DC    CL49'IEE524I STORAGE LOCATIONS _____. TO _____. ONLINE'  05601000
@NM00110 DC    AL1(52)                                                  05602000
@NM00111 DC    AL1(2)                                                   05603000
@NM00112 DC    CL50'IEE510I STORAGE LOCATIONS _____. TO _____. OFFLINE' 05604000
@NM00113 DC    AL1(68)                                                  05605000
@NM00114 DC    AL1(3)                                                   05606000
@NM00115 DC    CL66'IEE519E VARY STOR REJECTED, (_____.,_____.) CAUSES C05607000
               INVALID OVERLAP'                                         05608000
@NM00116 DC    AL1(52)                                                  05609000
@NM00117 DC    AL1(4)                                                   05610000
@NM00118 DC    CL50'IEE766I BAD STORAGE AT _____. CAN NOT BE VALIDATED' 05611000
@NM00119 DC    AL1(50)                                                  05612000
@NM00120 DC    AL1(5)                                                   05613000
@NM00121 DC    CL48'IEE764I VARY STORAGE OFFLINE WAITING TO COMPLETE'   05614000
@NM00122 DC    AL1(59)                                                  05615000
@NM00123 DC    AL1(6)                                                   05616000
@NM00124 DC    CL57'IEE760I VARY STOR COMMAND REJECTED, STORAGE NOT AVAC05617000
               ILABLE'                                                  05618000
@NM00125 DC    AL1(44)                                                  05619000
@NM00126 DC    AL1(7)                                                   05620000
@NM00127 DC    CL42'IEE713I VARY STOR COMMAND PROCESSOR FAILED'         05621000
@NM00128 DC    AL1(37)                                                  05622000
@NM00129 DC    AL1(8)                                                   05623000
@NM00130 DC    CL35'IEE345I VARY STOR AUTHORITY INVALID'                05624000
@NM00131 DC    AL1(47)                                                  05625000
@NM00132 DC    AL1(9)                                                   05626000
@NM00133 DC    CL45'IEE715I VARY COMMAND REJECTED, INVALID SYNTAX'      05627000
@NM00134 DC    AL1(74)                                                  05628000
@NM00135 DC    AL1(10)                                                  05629000
@NM00136 DC    CL72'IEE528I VARY STOR REJECTED,REQUEST OVERLAPS PERMANEC05630000
               NTLY RESIDENT STORAGE'                                   05631000
@NM00137 DC    AL1(62)                                                  05632000
@NM00138 DC    AL1(11)                                                  05633000
@NM00139 DC    CL60'IEE520I VARY STOR OFFLINE CANCELLED DUE TO SUBSEQUEC05634000
               NT ONLINE'                                               05635000
@NM00140 DC    AL1(45)                                                  05636000
@NM00141 DC    AL1(12)                                                  05637000
@NM00142 DC    CL43'IEE517I VARY STOR REJECTED, INVALID ADDRESS'        05638000
@NM00143 DC    AL1(66)                                                  05639000
@NM00144 DC    AL1(13)                                                  05640000
@NM00145 DC    CL64'IEE515E VARY STOR FAILED, STORAGE PHYSICALLY REMOVEC05641000
               D FROM SYSTEM'                                           05642000
@NM00146 DC    AL1(0)                                                   05643000
         ORG   MSGTBLE+708                                              05644000
IEEMPVST CSECT                                                          05645000
SDUMPC   SDUMP HDR='IEEMPVST - DUMP OF MAIN WORKAREA',MF=L              05646000
@DATD    DSECT                                                          05647000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                05648000
@ENDDATD EQU   *                                                        05649000
IEEMPVST CSECT                                                          05650000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05651000
@01      EQU   01                                                       05652000
@02      EQU   02                                                       05653000
@03      EQU   03                                                       05654000
@04      EQU   04                                                       05655000
@05      EQU   05                                                       05656000
@06      EQU   06                                                       05657000
@07      EQU   07                                                       05658000
@08      EQU   08                                                       05659000
@09      EQU   09                                                       05660000
@10      EQU   10                                                       05661000
@11      EQU   11                                                       05662000
@12      EQU   12                                                       05663000
@13      EQU   13                                                       05664000
@14      EQU   14                                                       05665000
@15      EQU   15                                                       05666000
CHINDX   EQU   @02                                                      05667000
BN       EQU   @03                                                      05668000
BLCKNUM  EQU   @02                                                      05669000
MSGID    EQU   @04                                                      05670000
MSGLEN   EQU   @06                                                      05671000
MSGPTR   EQU   @03                                                      05672000
ENDADDR  EQU   @03                                                      05673000
STATPTR  EQU   @02                                                      05674000
PGCOUNT  EQU   @04                                                      05675000
LOOPCNT  EQU   @02                                                      05676000
BADDRP   EQU   @03                                                      05677000
COUNT    EQU   @04                                                      05678000
LPARSEP  EQU   @02                                                      05679000
PARSEP   EQU   @06                                                      05680000
SDWAPTR  EQU   @04                                                      05681000
WPLPTR   EQU   @02                                                      05682000
SMF22PTR EQU   @02                                                      05683000
RETPTR   EQU   @03                                                      05684000
R0       EQU   @00                                                      05685000
R1       EQU   @01                                                      05686000
R2       EQU   @02                                                      05687000
R3       EQU   @03                                                      05688000
R4       EQU   @04                                                      05689000
R7       EQU   @07                                                      05690000
R8       EQU   @08                                                      05691000
R9       EQU   @09                                                      05692000
R10      EQU   @10                                                      05693000
R11      EQU   @11                                                      05694000
R12      EQU   @12                                                      05695000
R13      EQU   @13                                                      05696000
R14      EQU   @14                                                      05697000
R15      EQU   @15                                                      05698000
GPR01F   EQU   @01                                                      05699000
GPR00F   EQU   @00                                                      05700000
GPR15F   EQU   @15                                                      05701000
GPR00P   EQU   @00                                                      05702000
GPR01P   EQU   @01                                                      05703000
GPR15P   EQU   @15                                                      05704000
GPR14P   EQU   @14                                                      05705000
GPR02P   EQU   @02                                                      05706000
GPR12F   EQU   @12                                                      05707000
GPR13P   EQU   @13                                                      05708000
CVTPTR   EQU   16                                                       05709000
PSA      EQU   0                                                        05710000
FLCRNPSW EQU   PSA                                                      05711000
FLCROPSW EQU   PSA+8                                                    05712000
FLCICCW2 EQU   PSA+16                                                   05713000
PSAEEPSW EQU   PSA+132                                                  05714000
PSAESPSW EQU   PSA+136                                                  05715000
FLCSVILC EQU   PSAESPSW+1                                               05716000
PSAEPPSW EQU   PSA+140                                                  05717000
FLCPIILC EQU   PSAEPPSW+1                                               05718000
FLCPICOD EQU   PSAEPPSW+2                                               05719000
PSAPICOD EQU   FLCPICOD+1                                               05720000
FLCTEA   EQU   PSAEPPSW+4                                               05721000
FLCPER   EQU   PSA+152                                                  05722000
FLCMCLA  EQU   PSA+168                                                  05723000
FLCIOEL  EQU   FLCMCLA+4                                                05724000
FLCIOA   EQU   FLCMCLA+16                                               05725000
FLCFSA   EQU   FLCMCLA+80                                               05726000
PSASUPER EQU   PSA+552                                                  05727000
PSASUP1  EQU   PSASUPER                                                 05728000
PSASUP2  EQU   PSASUPER+1                                               05729000
PSASUP3  EQU   PSASUPER+2                                               05730000
PSASUP4  EQU   PSASUPER+3                                               05731000
PSACLHT  EQU   PSA+640                                                  05732000
PSALKSA  EQU   PSA+696                                                  05733000
PSAHLHI  EQU   PSA+760                                                  05734000
PSALITA  EQU   PSA+764                                                  05735000
PSADSSFL EQU   PSA+836                                                  05736000
PSADSSF1 EQU   PSADSSFL                                                 05737000
PSADSSF3 EQU   PSADSSFL+2                                               05738000
PSADSSF4 EQU   PSADSSFL+3                                               05739000
PSARSVT  EQU   PSA+896                                                  05740000
MAINWA   EQU   0                                                        05741000
RSR      EQU   0                                                        05742000
RSRPARML EQU   0                                                        05743000
RSRSTRBN EQU   RSRPARML                                                 05744000
RSRFRCT  EQU   RSRPARML+2                                               05745000
RSROPTNS EQU   RSRPARML+4                                               05746000
RSRONLN  EQU   RSROPTNS                                                 05747000
RSROFFLN EQU   RSROPTNS                                                 05748000
RSRSTUS  EQU   RSROPTNS                                                 05749000
RSRCANCL EQU   RSROPTNS                                                 05750000
RSRSLP   EQU   RSRPARML+8                                               05751000
RSRAECB  EQU   RSRPARML+12                                              05752000
RSRECB   EQU   RSRPARML+16                                              05753000
RSRECBB  EQU   RSRECB                                                   05754000
RSRPOST  EQU   RSRECBB                                                  05755000
RSRPCODE EQU   RSRECB+1                                                 05756000
RSRSTAT2 EQU   0                                                        05757000
POFFLN   EQU   RSRSTAT2                                                 05758000
PINTRCP  EQU   RSRSTAT2                                                 05759000
PSTORERR EQU   RSRSTAT2                                                 05760000
VALSTRA  EQU   0                                                        05761000
STRTVAL  EQU   0                                                        05762000
ENDVAL   EQU   0                                                        05763000
CVTMAP   EQU   0                                                        05764000
CVTTCBP  EQU   CVTMAP                                                   05765000
CVTDAR   EQU   CVTMAP+72                                                05766000
CVTFLGS1 EQU   CVTDAR                                                   05767000
CVTCUCB  EQU   CVTMAP+100                                               05768000
CVTDCB   EQU   CVTMAP+116                                               05769000
CVTIERLC EQU   CVTMAP+144                                               05770000
CVT0PT01 EQU   CVTMAP+152                                               05771000
CVTOPTA  EQU   CVTMAP+182                                               05772000
CVTOPTB  EQU   CVTMAP+183                                               05773000
CVTGTF   EQU   CVTMAP+236                                               05774000
CVTGTFST EQU   CVTGTF                                                   05775000
CVTGTFS  EQU   CVTGTFST                                                 05776000
CVTSTATE EQU   CVTGTFST                                                 05777000
CVTTMODE EQU   CVTGTFST                                                 05778000
CVTFORM  EQU   CVTGTFST                                                 05779000
CVTAQAVT EQU   CVTMAP+240                                               05780000
CVTTCMFG EQU   CVTAQAVT                                                 05781000
CVTVOLM2 EQU   CVTMAP+244                                               05782000
CVTTATA  EQU   CVTVOLM2                                                 05783000
CVTTSKS  EQU   CVTTATA                                                  05784000
CVTVOLF2 EQU   CVTTSKS                                                  05785000
CVTTAT   EQU   CVTTATA+1                                                05786000
CVTATER  EQU   CVTMAP+248                                               05787000
CVTEXT1  EQU   CVTMAP+252                                               05788000
CVTPURG  EQU   CVTMAP+260                                               05789000
CVTQMSG  EQU   CVTMAP+268                                               05790000
CVTDMSR  EQU   CVTMAP+272                                               05791000
CVTRSV37 EQU   CVTDMSR                                                  05792000
CVTDMSRF EQU   CVTRSV37                                                 05793000
CVTPTRV  EQU   CVTMAP+288                                               05794000
CVTEORM  EQU   CVTMAP+312                                               05795000
CVTERPV  EQU   CVTMAP+316                                               05796000
CVTINTLA EQU   CVTMAP+320                                               05797000
CVTAPF   EQU   CVTMAP+324                                               05798000
CVTEXT2  EQU   CVTMAP+328                                               05799000
CVTHJES  EQU   CVTMAP+332                                               05800000
CVTPGSIA EQU   CVTMAP+348                                               05801000
CVTA1F1  EQU   CVTMAP+356                                               05802000
CVTSYSK  EQU   CVTMAP+357                                               05803000
CVTVOLM1 EQU   CVTMAP+380                                               05804000
CVTVOLF1 EQU   CVTVOLM1                                                 05805000
CVTATMCT EQU   CVTMAP+388                                               05806000
CVTXTNT1 EQU   0                                                        05807000
CVTXTNT2 EQU   0                                                        05808000
CVTDSSV  EQU   CVTXTNT2                                                 05809000
CVTFLGBT EQU   CVTXTNT2+5                                               05810000
CVTQID   EQU   CVTXTNT2+24                                              05811000
CVTRV400 EQU   CVTXTNT2+52                                              05812000
CVTRV409 EQU   CVTXTNT2+53                                              05813000
CVTATCVT EQU   CVTXTNT2+64                                              05814000
CVTRV429 EQU   CVTXTNT2+84                                              05815000
CVTRV438 EQU   CVTXTNT2+85                                              05816000
CVTRV457 EQU   CVTXTNT2+112                                             05817000
CVTRV466 EQU   CVTXTNT2+113                                             05818000
CVTFIX   EQU   0                                                        05819000
CVTRELNO EQU   CVTFIX+252                                               05820000
CHAIN    EQU   0                                                        05821000
CHFLG    EQU   CHAIN+4                                                  05822000
CHSTS    EQU   CHFLG+2                                                  05823000
CHFC     EQU   CHSTS                                                    05824000
CHACT    EQU   CHFLG+3                                                  05825000
CHKEY    EQU   CHAIN+8                                                  05826000
CHPARM   EQU   CHKEY                                                    05827000
CHPKE    EQU   CHAIN+28                                                 05828000
CHUCMP   EQU   CHAIN+29                                                 05829000
CHTJID   EQU   CHAIN+30                                                 05830000
CHPROCSN EQU   CHAIN+32                                                 05831000
CHACT1   EQU   CHPROCSN+3                                               05832000
CHASM    EQU   CHAIN+40                                                 05833000
CHCIBP   EQU   CHASM+4                                                  05834000
CHRGNSZ  EQU   CHASM+8                                                  05835000
CHSTEP   EQU   CHASM+24                                                 05836000
CHSWT    EQU   CHSTEP                                                   05837000
CHSHORT  EQU   CHASM+32                                                 05838000
UCMPRFXP EQU   0                                                        05839000
UCM2EXT  EQU   0                                                        05840000
UCM2STA  EQU   UCM2EXT+8                                                05841000
UCM2SFLG EQU   UCM2STA                                                  05842000
UCMPRFX  EQU   0                                                        05843000
UCMMCENT EQU   UCMPRFX                                                  05844000
UCMSAVE0 EQU   UCMPRFX+4                                                05845000
UCMSFLGS EQU   UCMPRFX+84                                               05846000
UCMSFLG1 EQU   UCMSFLGS                                                 05847000
UCMSFLG2 EQU   UCMSFLGS+1                                               05848000
UCMXSA   EQU   UCMPRFX+104                                              05849000
UCMSDS1  EQU   UCMPRFX+156                                              05850000
UCM      EQU   0                                                        05851000
UCMDECB  EQU   UCM+12                                                   05852000
UCMRPYI  EQU   UCM+32                                                   05853000
UCMPXB   EQU   UCM+68                                                   05854000
UCMMODE  EQU   UCMPXB                                                   05855000
UCMVDATA EQU   UCM+72                                                   05856000
UCMRSV42 EQU   UCM+300                                                  05857000
UCMRSV51 EQU   UCM+301                                                  05858000
UCMEIL   EQU   0                                                        05859000
UCMRECBA EQU   UCMEIL+24                                                05860000
UCMEXIT  EQU   0                                                        05861000
UCMLIST  EQU   0                                                        05862000
UCMSTS   EQU   UCMLIST+24                                               05863000
UCMATR   EQU   UCMLIST+25                                               05864000
UCMXA    EQU   UCMLIST+26                                               05865000
UCMID    EQU   UCMXA                                                    05866000
UCMAUTH  EQU   UCMLIST+40                                               05867000
UCMAUTHA EQU   UCMAUTH                                                  05868000
UCMDISP  EQU   UCMLIST+42                                               05869000
UCMDISP1 EQU   UCMDISP                                                  05870000
UCMDISP2 EQU   UCMDISP+1                                                05871000
UCMMSG   EQU   UCMLIST+60                                               05872000
UCMMSG1  EQU   UCMMSG                                                   05873000
UCMDEVC  EQU   UCMLIST+63                                               05874000
UCMRCT   EQU   UCMLIST+68                                               05875000
UCMSDS5  EQU   UCMRCT                                                   05876000
UCMFEXTA EQU   0                                                        05877000
UCMFMGFS EQU   UCMFEXTA+8                                               05878000
UCMFFLG1 EQU   UCMFMGFS                                                 05879000
UCMPEXTA EQU   0                                                        05880000
UCMPDM1  EQU   UCMPEXTA+4                                               05881000
SMFRCD22 EQU   0                                                        05882000
SMF22LEN EQU   SMFRCD22                                                 05883000
SMF22RTY EQU   SMFRCD22+5                                               05884000
SMF22IND EQU   SMFRCD22+18                                              05885000
SMF22ECT EQU   SMFRCD22+20                                              05886000
SMF22CPU EQU   0                                                        05887000
SMF22CHL EQU   0                                                        05888000
SMF22STR EQU   0                                                        05889000
SMF22TID EQU   SMF22STR+1                                               05890000
SMF22PGL EQU   SMF22STR+2                                               05891000
SMF22NPG EQU   SMF22STR+4                                               05892000
SMF22IPL EQU   0                                                        05893000
SMF22VON EQU   0                                                        05894000
SMF22VOF EQU   0                                                        05895000
WPLRF    EQU   0                                                        05896000
WPLRPTR  EQU   WPLRF                                                    05897000
WPL      EQU   0                                                        05898000
WPLLGH   EQU   WPL                                                      05899000
WPLMCSF  EQU   WPL+2                                                    05900000
WPLMCSF1 EQU   WPLMCSF                                                  05901000
WPLMCSFA EQU   WPLMCSF1                                                 05902000
WPLMCSFB EQU   WPLMCSF1                                                 05903000
WPLMCSFC EQU   WPLMCSF1                                                 05904000
WPLMCSF2 EQU   WPLMCSF+1                                                05905000
WPLTXT   EQU   WPL+4                                                    05906000
WPLFLGS  EQU   0                                                        05907000
WPLDESC  EQU   WPLFLGS                                                  05908000
WPLDESC1 EQU   WPLDESC                                                  05909000
WPLDESCE EQU   WPLDESC1                                                 05910000
WPLDESC2 EQU   WPLDESC+1                                                05911000
WPLROUT  EQU   WPLFLGS+2                                                05912000
WPLROUT1 EQU   WPLROUT                                                  05913000
WPLROUT2 EQU   WPLROUT+1                                                05914000
WPLMSGTY EQU   WPLFLGS+4                                                05915000
WPLMSGT1 EQU   WPLMSGTY                                                 05916000
WPLMSGT2 EQU   WPLMSGTY+1                                               05917000
WPLLS01  EQU   0                                                        05918000
WPLLTF   EQU   WPLLS01                                                  05919000
WPLLTF1  EQU   WPLLTF                                                   05920000
WPLML    EQU   0                                                        05921000
WPLMLLTF EQU   WPLML+2                                                  05922000
WPLMLLT1 EQU   WPLMLLTF                                                 05923000
ESTA     EQU   0                                                        05924000
ESTAEXT  EQU   ESTA                                                     05925000
ESTAFLG1 EQU   ESTAEXT                                                  05926000
ESTAIO   EQU   ESTAFLG1                                                 05927000
ESTAFGRS EQU   ESTA+12                                                  05928000
ESTAFLG2 EQU   ESTAFGRS                                                 05929000
SDWA     EQU   0                                                        05930000
SDWAFIOB EQU   SDWA+4                                                   05931000
SDWAABCC EQU   SDWAFIOB                                                 05932000
SDWACMPF EQU   SDWAABCC                                                 05933000
SDWAREQ  EQU   SDWACMPF                                                 05934000
SDWACMPC EQU   SDWAABCC+1                                               05935000
SDWACTL1 EQU   SDWA+8                                                   05936000
SDWACMKA EQU   SDWACTL1                                                 05937000
SDWAMWPA EQU   SDWACTL1+1                                               05938000
SDWAPMKA EQU   SDWACTL1+4                                               05939000
SDWACTL2 EQU   SDWA+16                                                  05940000
SDWACMKP EQU   SDWACTL2                                                 05941000
SDWAMWPP EQU   SDWACTL2+1                                               05942000
SDWAPMKP EQU   SDWACTL2+4                                               05943000
SDWAGRSV EQU   SDWA+24                                                  05944000
SDWANAME EQU   SDWA+88                                                  05945000
SDWAEC1  EQU   SDWA+104                                                 05946000
SDWAEMK1 EQU   SDWAEC1                                                  05947000
SDWAMWP1 EQU   SDWAEC1+1                                                05948000
SDWAINT1 EQU   SDWAEC1+2                                                05949000
SDWANXT1 EQU   SDWAEC1+4                                                05950000
SDWAAEC1 EQU   SDWA+112                                                 05951000
SDWAILC1 EQU   SDWAAEC1+1                                               05952000
SDWAINC1 EQU   SDWAAEC1+2                                               05953000
SDWAICD1 EQU   SDWAINC1+1                                               05954000
SDWAEC2  EQU   SDWA+120                                                 05955000
SDWAEMK2 EQU   SDWAEC2                                                  05956000
SDWAMWP2 EQU   SDWAEC2+1                                                05957000
SDWAINT2 EQU   SDWAEC2+2                                                05958000
SDWANXT2 EQU   SDWAEC2+4                                                05959000
SDWAAEC2 EQU   SDWA+128                                                 05960000
SDWAILC2 EQU   SDWAAEC2+1                                               05961000
SDWAINC2 EQU   SDWAAEC2+2                                               05962000
SDWAICD2 EQU   SDWAINC2+1                                               05963000
SDWASRSV EQU   SDWA+136                                                 05964000
SDWAIDNT EQU   SDWA+200                                                 05965000
SDWAMCH  EQU   SDWA+204                                                 05966000
SDWASTCK EQU   SDWAMCH                                                  05967000
SDWAMCHI EQU   SDWAMCH+8                                                05968000
SDWAMCHS EQU   SDWAMCHI                                                 05969000
SDWASRVL EQU   SDWAMCHS                                                 05970000
SDWAMCHD EQU   SDWAMCHI+1                                               05971000
SDWASKYF EQU   SDWAMCHD                                                 05972000
SDWASCK  EQU   SDWAMCHD                                                 05973000
SDWARSR1 EQU   SDWAMCH+12                                               05974000
SDWARSR2 EQU   SDWAMCH+13                                               05975000
SDWARFSA EQU   SDWAMCH+16                                               05976000
SDWAFLGS EQU   SDWA+232                                                 05977000
SDWAERRA EQU   SDWAFLGS                                                 05978000
SDWAERRB EQU   SDWAFLGS+1                                               05979000
SDWAERRC EQU   SDWAFLGS+2                                               05980000
SDWAERRD EQU   SDWAFLGS+3                                               05981000
SDWAIOFS EQU   SDWA+238                                                 05982000
SDWARTYA EQU   SDWA+240                                                 05983000
SDWACPUA EQU   SDWA+248                                                 05984000
SDWAPARQ EQU   SDWA+252                                                 05985000
SDWARCDE EQU   SDWAPARQ                                                 05986000
SDWAACF2 EQU   SDWAPARQ+1                                               05987000
SDWARCRD EQU   SDWAACF2                                                 05988000
SDWAUPRG EQU   SDWAACF2                                                 05989000
SDWAFREE EQU   SDWAACF2                                                 05990000
SDWAACF3 EQU   SDWAPARQ+2                                               05991000
SDWAACF4 EQU   SDWAPARQ+3                                               05992000
SDWALKWA EQU   SDWA+256                                                 05993000
SDWALKWS EQU   SDWALKWA                                                 05994000
SDWARECP EQU   SDWA+292                                                 05995000
SDWAMODN EQU   SDWARECP                                                 05996000
SDWACSCT EQU   SDWARECP+8                                               05997000
SDWAREXN EQU   SDWARECP+16                                              05998000
SDWASNPA EQU   SDWA+320                                                 05999000
SDWADUMP EQU   SDWASNPA                                                 06000000
SDWADPFS EQU   SDWADUMP+1                                               06001000
SDWADDAT EQU   SDWASNPA+4                                               06002000
SDWASDAT EQU   SDWADDAT                                                 06003000
SDWAPDAT EQU   SDWADDAT+2                                               06004000
SDWADPSA EQU   SDWA+328                                                 06005000
SDWADPSL EQU   SDWADPSA                                                 06006000
SDWARA   EQU   SDWA+400                                                 06007000
SDWADPVA EQU   SDWARA+2                                                 06008000
SRBSECT  EQU   0                                                        06009000
SRB      EQU   SRBSECT                                                  06010000
SRBFLNK  EQU   SRB+4                                                    06011000
SRBASCB  EQU   SRB+8                                                    06012000
SRBFLC   EQU   SRB+12                                                   06013000
SRBPASID EQU   SRBFLC+2                                                 06014000
SRBPTCB  EQU   SRBFLC+4                                                 06015000
SRBEP    EQU   SRB+20                                                   06016000
SRBRMTR  EQU   SRB+24                                                   06017000
SRBPARM  EQU   SRB+28                                                   06018000
ASVT     EQU   0                                                        06019000
ASVTFRST EQU   ASVT+524                                                 06020000
ASVTENTY EQU   ASVT+528                                                 06021000
ASVTAVAL EQU   ASVTENTY                                                 06022000
ASCB     EQU   0                                                        06023000
ASCBSUPC EQU   ASCB+16                                                  06024000
ASCBFW1  EQU   ASCB+100                                                 06025000
ASCBRCTF EQU   ASCBFW1+2                                                06026000
ASCBFLG1 EQU   ASCBFW1+3                                                06027000
ASCBDSP1 EQU   ASCB+114                                                 06028000
ASCBFAIL EQU   ASCBDSP1                                                 06029000
ASCBFLG2 EQU   ASCB+115                                                 06030000
ASCBLKGP EQU   ASCB+128                                                 06031000
ASCBSRQ  EQU   ASCB+180                                                 06032000
ASCBSRQ1 EQU   ASCBSRQ                                                  06033000
ASCBSRQ2 EQU   ASCBSRQ+1                                                06034000
ASCBSRQ3 EQU   ASCBSRQ+2                                                06035000
ASCBSRQ4 EQU   ASCBSRQ+3                                                06036000
PVT      EQU   0                                                        06037000
PVTFLAG1 EQU   PVT                                                      06038000
PVTPSIB  EQU   PVT+72                                                   06039000
PVTPRCF  EQU   PVT+148                                                  06040000
PVTQS    EQU   PVT+304                                                  06041000
PVTWSAX  EQU   PVT+344                                                  06042000
CHARS    EQU   0                                                        06043000
DIGIT    EQU   0                                                        06044000
NUMBR    EQU   0                                                        06045000
BINADDR  EQU   0                                                        06046000
CNVTRLVT EQU   0                                                        06047000
MYTCB    EQU   0                                                        06048000
WASQA    EQU   0                                                        06049000
SRBBUFR  EQU   WASQA                                                    06050000
XEPARML  EQU   WASQA+44                                                 06051000
XDATARG1 EQU   XEPARML                                                  06052000
XDATARG2 EQU   XEPARML+4                                                06053000
XCODERG1 EQU   XEPARML+8                                                06054000
XCODERG2 EQU   XEPARML+12                                               06055000
PGFIXECB EQU   WASQA+60                                                 06056000
FIXPCODE EQU   PGFIXECB+1                                               06057000
ASID     EQU   WASQA+64                                                 06058000
VSL      EQU   WASQA+68                                                 06059000
VSLFLG1  EQU   VSL                                                      06060000
VIRTADDR EQU   VSL+1                                                    06061000
VSLFLG2  EQU   VSL+4                                                    06062000
ENDVADDR EQU   VSL+5                                                    06063000
ASCBP    EQU   WASQA+76                                                 06064000
SRBEXRTN EQU   WASQA+80                                                 06065000
RSCMEXRP EQU   WASQA+84                                                 06066000
SRBECB   EQU   WASQA+88                                                 06067000
SRBCREG  EQU   WASQA+92                                                 06068000
RSCMCRG  EQU   WASQA+96                                                 06069000
HOBIT    EQU   WASQA+100                                                06070000
SQAFLAGS EQU   WASQA+101                                                06071000
RTCAOK   EQU   SQAFLAGS                                                 06072000
STRTPGA  EQU   0                                                        06073000
ENDPGA   EQU   0                                                        06074000
I015F    EQU   0                                                        06075000
MSG1     EQU   0                                                        06076000
MSG1SA   EQU   MSG1+26                                                  06077000
MSG1EA   EQU   MSG1+36                                                  06078000
MSG2     EQU   0                                                        06079000
MSG2SA   EQU   MSG2+26                                                  06080000
MSG3     EQU   0                                                        06081000
MSG3SA   EQU   MSG3+29                                                  06082000
MSG3EA   EQU   MSG3+36                                                  06083000
MSG4     EQU   0                                                        06084000
MSG4SA   EQU   MSG4+23                                                  06085000
MSGELEM  EQU   0                                                        06086000
LENELEM  EQU   MSGELEM                                                  06087000
IDELEM   EQU   MSGELEM+1                                                06088000
MTEXT    EQU   MSGELEM+2                                                06089000
HEXDIGIT EQU   0                                                        06090000
I001C    EQU   0                                                        06091000
I008P    EQU   0                                                        06092000
I015P    EQU   0                                                        06093000
I031F    EQU   0                                                        06094000
I031P    EQU   0                                                        06095000
I256C    EQU   0                                                        06096000
UCM2PTR  EQU   0                                                        06097000
CSCB     EQU   0                                                        06098000
MIDENT   EQU   0                                                        06099000
BINNUM   EQU   0                                                        06100000
PRNTFLD  EQU   0                                                        06101000
CVTS01   EQU   CVTPGSIA                                                 06102000
CVTPVTP  EQU   CVTS01+8                                                 06103000
CVTLPDIA EQU   CVTS01+12                                                06104000
CVTDIRST EQU   CVTLPDIA                                                 06105000
CVTSLIDA EQU   CVTS01+24                                                06106000
CVTCTLFG EQU   CVTS01+50                                                06107000
CVTASVT  EQU   CVTS01+208                                               06108000
CVTLSMQ  EQU   CVTS01+268                                               06109000
CVTRV210 EQU   CVTS01+424                                               06110000
CVTRV219 EQU   CVTS01+425                                               06111000
CVTRV228 EQU   CVTS01+426                                               06112000
CVTRV237 EQU   CVTS01+427                                               06113000
CVTMFRTR EQU   CVTS01+452                                               06114000
CVTRV262 EQU   CVTS01+468                                               06115000
CVTRV271 EQU   CVTS01+469                                               06116000
CVTRV280 EQU   CVTS01+470                                               06117000
CVTRV289 EQU   CVTS01+471                                               06118000
CVTGSDA  EQU   CVTS01+600                                               06119000
CHAINS01 EQU   CHASM                                                    06120000
CHBUF    EQU   CHAINS01                                                 06121000
CHTYPE   EQU   CHAINS01+124                                             06122000
CHTRSTAT EQU   CHAINS01+125                                             06123000
CHINC    EQU   CHAINS01+132                                             06124000
CHCSYSO  EQU   CHAINS01+134                                             06125000
AUTHCODE EQU   CHINC                                                    06126000
UCMBASPT EQU   CVTCUCB                                                  06127000
UCMMCSPT EQU   UCMPRFXP                                                 06128000
UCMDVEPT EQU   UCMMCENT                                                 06129000
UCMEILPT EQU   DUMMY                                                    06130000
UCMEXTPT EQU   DUMMY                                                    06131000
UCMUEWPT EQU   DUMMY                                                    06132000
UCMIECBA EQU   UCMRECBA+4                                               06133000
ESTAPTR  EQU   DUMMY                                                    06134000
SRBPTR   EQU   DUMMY                                                    06135000
ASVTPTR  EQU   CVTASVT                                                  06136000
ASCBPTR  EQU   DUMMY                                                    06137000
PVTPTR   EQU   CVTPVTP                                                  06138000
FLC      EQU   PSA                                                      06139000
PSARSVTE EQU   PSARSVT                                                  06140000
I056     EQU   ILIST                                                    06141000
I05602   EQU   I056+4                                                   06142000
I05603   EQU   I05602                                                   06143000
I05604   EQU   I05602+1                                                 06144000
I05605   EQU   I05602+2                                                 06145000
I05606   EQU   I05602+4                                                 06146000
I05607   EQU   I05602+8                                                 06147000
I048     EQU   ILIST                                                    06148000
I04802   EQU   I048+4                                                   06149000
I04803   EQU   I04802                                                   06150000
I04804   EQU   I04803                                                   06151000
I04805   EQU   I04803+1                                                 06152000
I04806   EQU   I04803+2                                                 06153000
I04807   EQU   I04802+4                                                 06154000
I04808   EQU   I04802+8                                                 06155000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    06156000
@NM00154 EQU   I04803+3                                                 06157000
I04801   EQU   I048                                                     06158000
I05655   EQU   I05602+3                                                 06159000
I05601   EQU   I056                                                     06160000
PSARSAV  EQU   PSARSVTE+60                                              06161000
PSARSTK  EQU   PSARSVTE+56                                              06162000
PSAESAV3 EQU   PSARSVTE+52                                              06163000
PSAESTK3 EQU   PSARSVTE+48                                              06164000
PSAESAV2 EQU   PSARSVTE+44                                              06165000
PSAESTK2 EQU   PSARSVTE+40                                              06166000
PSAESAV1 EQU   PSARSVTE+36                                              06167000
PSAESTK1 EQU   PSARSVTE+32                                              06168000
PSAPSAV  EQU   PSARSVTE+28                                              06169000
PSAPSTK  EQU   PSARSVTE+24                                              06170000
PSAMSAV  EQU   PSARSVTE+20                                              06171000
PSAMSTK  EQU   PSARSVTE+16                                              06172000
PSASSAV  EQU   PSARSVTE+12                                              06173000
PSASSTK  EQU   PSARSVTE+8                                               06174000
PSANSTK  EQU   PSARSVTE+4                                               06175000
PSACSTK  EQU   PSARSVTE                                                 06176000
UCMIECBP EQU   UCMIECBA+1                                               06177000
UCMIECBF EQU   UCMIECBA                                                 06178000
CHLAST   EQU   CHAINS01+136                                             06179000
CHSPA    EQU   CHAINS01+135                                             06180000
CHUSERID EQU   CHCSYSO                                                  06181000
CHJB     EQU   CHCSYSO                                                  06182000
CHDUMP   EQU   CHCSYSO                                                  06183000
CHQUE    EQU   CHCSYSO                                                  06184000
CHHOLD   EQU   CHCSYSO                                                  06185000
CHOUT    EQU   CHCSYSO                                                  06186000
CHINN    EQU   CHCSYSO                                                  06187000
CHALL    EQU   CHCSYSO                                                  06188000
CHPEND   EQU   CHAINS01+128                                             06189000
CHARID   EQU   CHAINS01+127                                             06190000
CHCNID   EQU   CHAINS01+126                                             06191000
@NM00020 EQU   CHTRSTAT                                                 06192000
CHTSL    EQU   CHTRSTAT                                                 06193000
CHTS     EQU   CHTRSTAT                                                 06194000
CHINITL  EQU   CHTRSTAT                                                 06195000
CHINIT   EQU   CHTRSTAT                                                 06196000
CHJOBSL  EQU   CHTRSTAT                                                 06197000
CHJOBS   EQU   CHTRSTAT                                                 06198000
CHDEF    EQU   CHTYPE                                                   06199000
CHHIAR   EQU   CHTYPE                                                   06200000
CHARSV29 EQU   CHTYPE                                                   06201000
CHARSV28 EQU   CHTYPE                                                   06202000
CHARSV27 EQU   CHTYPE                                                   06203000
CHARSV26 EQU   CHTYPE                                                   06204000
CHARSV25 EQU   CHTYPE                                                   06205000
CHDSTAT  EQU   CHTYPE                                                   06206000
CVTRV628 EQU   CVTS01+728                                               06207000
CVTRV627 EQU   CVTS01+724                                               06208000
CVTRV626 EQU   CVTS01+720                                               06209000
CVTRV625 EQU   CVTS01+716                                               06210000
CVTRV624 EQU   CVTS01+712                                               06211000
CVTRV623 EQU   CVTS01+708                                               06212000
CVTRV622 EQU   CVTS01+704                                               06213000
CVTRV621 EQU   CVTS01+700                                               06214000
CVTIHASU EQU   CVTS01+696                                               06215000
CVTSUSP  EQU   CVTS01+692                                               06216000
CVTT6SVC EQU   CVTS01+688                                               06217000
CVTCDAL  EQU   CVTS01+684                                               06218000
CVTTCTL  EQU   CVTS01+680                                               06219000
CVTRSUME EQU   CVTS01+676                                               06220000
CVTJTERM EQU   CVTS01+672                                               06221000
CVTASMRM EQU   CVTS01+668                                               06222000
CVTTCASP EQU   CVTS01+664                                               06223000
CVT0PT03 EQU   CVTS01+660                                               06224000
CVT0PT0E EQU   CVTS01+656                                               06225000
CVTRV609 EQU   CVTS01+652                                               06226000
CVTCGK   EQU   CVTS01+648                                               06227000
CVTRAC   EQU   CVTS01+644                                               06228000
CVTRV606 EQU   CVTS01+640                                               06229000
CVTRV605 EQU   CVTS01+636                                               06230000
CVTRV604 EQU   CVTS01+632                                               06231000
CVTEFF02 EQU   CVTS01+628                                               06232000
CVTCBBR  EQU   CVTS01+624                                               06233000
CVTSSCR  EQU   CVTS01+620                                               06234000
CVTEVENT EQU   CVTS01+616                                               06235000
CVTCRCA  EQU   CVTS01+612                                               06236000
CVTTPIO  EQU   CVTS01+608                                               06237000
CVTADV   EQU   CVTS01+604                                               06238000
CVTGSDAB EQU   CVTGSDA                                                  06239000
CVTQV3   EQU   CVTS01+596                                               06240000
CVTQV2   EQU   CVTS01+592                                               06241000
CVTQV1   EQU   CVTS01+588                                               06242000
CVTRPT   EQU   CVTS01+584                                               06243000
CVTSSRB  EQU   CVTS01+580                                               06244000
CVTCSDRL EQU   CVTS01+576                                               06245000
CVTEXP1  EQU   CVTS01+572                                               06246000
CVTRMPMT EQU   CVTS01+568                                               06247000
CVTRMPTT EQU   CVTS01+564                                               06248000
CVTVPSA  EQU   CVTS01+560                                               06249000
CVTVSTOP EQU   CVTS01+556                                               06250000
CVTGTFR8 EQU   CVTS01+552                                               06251000
CVTQUIT  EQU   CVTS01+548                                               06252000
CVTVACR  EQU   CVTS01+544                                               06253000
CVTWTCB  EQU   CVTS01+540                                               06254000
CVTSTPRS EQU   CVTS01+536                                               06255000
CVT0PT02 EQU   CVTS01+532                                               06256000
CVTDARCM EQU   CVTS01+528                                               06257000
CVTIRECM EQU   CVTS01+524                                               06258000
CVTJRECM EQU   CVTS01+520                                               06259000
CVTVEMS0 EQU   CVTS01+516                                               06260000
CVTSPFRR EQU   CVTS01+512                                               06261000
CVTRLSTG EQU   CVTS01+508                                               06262000
CVT0TC0A EQU   CVTS01+504                                               06263000
CVTGMBR  EQU   CVTS01+500                                               06264000
CVTLFRM  EQU   CVTS01+496                                               06265000
CVTRMBR  EQU   CVTS01+492                                               06266000
CVTVIOP  EQU   CVTS01+488                                               06267000
CVTRV307 EQU   CVTS01+486                                               06268000
CVTRV306 EQU   CVTS01+484                                               06269000
CVTRV305 EQU   CVTS01+482                                               06270000
CVTRV304 EQU   CVTS01+480                                               06271000
CVTRV303 EQU   CVTS01+478                                               06272000
CVTRV302 EQU   CVTS01+476                                               06273000
CVTTRCA  EQU   CVTS01+472                                               06274000
CVTRV297 EQU   CVTRV289                                                 06275000
CVTRV296 EQU   CVTRV289                                                 06276000
CVTRV295 EQU   CVTRV289                                                 06277000
CVTRV294 EQU   CVTRV289                                                 06278000
CVTRV293 EQU   CVTRV289                                                 06279000
CVTRV292 EQU   CVTRV289                                                 06280000
CVTRV291 EQU   CVTRV289                                                 06281000
CVTRV290 EQU   CVTRV289                                                 06282000
CVTRV288 EQU   CVTRV280                                                 06283000
CVTRV287 EQU   CVTRV280                                                 06284000
CVTRV286 EQU   CVTRV280                                                 06285000
CVTRV285 EQU   CVTRV280                                                 06286000
CVTRV284 EQU   CVTRV280                                                 06287000
CVTRV283 EQU   CVTRV280                                                 06288000
CVTRV282 EQU   CVTRV280                                                 06289000
CVTRV281 EQU   CVTRV280                                                 06290000
CVTRV279 EQU   CVTRV271                                                 06291000
CVTRV278 EQU   CVTRV271                                                 06292000
CVTRV277 EQU   CVTRV271                                                 06293000
CVTRV276 EQU   CVTRV271                                                 06294000
CVTRV275 EQU   CVTRV271                                                 06295000
CVTRV274 EQU   CVTRV271                                                 06296000
CVTRV273 EQU   CVTRV271                                                 06297000
CVTRV272 EQU   CVTRV271                                                 06298000
CVTRV270 EQU   CVTRV262                                                 06299000
CVTRV269 EQU   CVTRV262                                                 06300000
CVTRV268 EQU   CVTRV262                                                 06301000
CVTRV267 EQU   CVTRV262                                                 06302000
CVTRV266 EQU   CVTRV262                                                 06303000
CVTRV265 EQU   CVTRV262                                                 06304000
CVTRV264 EQU   CVTRV262                                                 06305000
CVTRV263 EQU   CVTRV262                                                 06306000
CVTVFP   EQU   CVTS01+464                                               06307000
CVTVSI   EQU   CVTS01+460                                               06308000
CVTVPSIB EQU   CVTS01+456                                               06309000
CVTMFACT EQU   CVTMFRTR                                                 06310000
CVTMFCTL EQU   CVTS01+448                                               06311000
CVTPVBP  EQU   CVTS01+444                                               06312000
CVTPWI   EQU   CVTS01+440                                               06313000
CVTRV254 EQU   CVTS01+438                                               06314000
CVTRV253 EQU   CVTS01+436                                               06315000
CVTRV252 EQU   CVTS01+434                                               06316000
CVTRV251 EQU   CVTS01+433                                               06317000
CVTRV250 EQU   CVTS01+432                                               06318000
CVTRV249 EQU   CVTS01+431                                               06319000
CVTRV248 EQU   CVTS01+430                                               06320000
CVTRV247 EQU   CVTS01+429                                               06321000
CVTRV246 EQU   CVTS01+428                                               06322000
CVTRV245 EQU   CVTRV237                                                 06323000
CVTRV244 EQU   CVTRV237                                                 06324000
CVTRV243 EQU   CVTRV237                                                 06325000
CVTRV242 EQU   CVTRV237                                                 06326000
CVTRV241 EQU   CVTRV237                                                 06327000
CVTRV240 EQU   CVTRV237                                                 06328000
CVTRV239 EQU   CVTRV237                                                 06329000
CVTRV238 EQU   CVTRV237                                                 06330000
CVTRV236 EQU   CVTRV228                                                 06331000
CVTRV235 EQU   CVTRV228                                                 06332000
CVTRV234 EQU   CVTRV228                                                 06333000
CVTRV233 EQU   CVTRV228                                                 06334000
CVTRV232 EQU   CVTRV228                                                 06335000
CVTRV231 EQU   CVTRV228                                                 06336000
CVTRV230 EQU   CVTRV228                                                 06337000
CVTRV229 EQU   CVTRV228                                                 06338000
CVTRV227 EQU   CVTRV219                                                 06339000
CVTRV226 EQU   CVTRV219                                                 06340000
CVTRV225 EQU   CVTRV219                                                 06341000
CVTRV224 EQU   CVTRV219                                                 06342000
CVTRV223 EQU   CVTRV219                                                 06343000
CVTRV222 EQU   CVTRV219                                                 06344000
CVTRV221 EQU   CVTRV219                                                 06345000
CVTRV220 EQU   CVTRV219                                                 06346000
CVTRV218 EQU   CVTRV210                                                 06347000
CVTRV217 EQU   CVTRV210                                                 06348000
CVTRV216 EQU   CVTRV210                                                 06349000
CVTRV215 EQU   CVTRV210                                                 06350000
CVTRV214 EQU   CVTRV210                                                 06351000
CVTRV213 EQU   CVTRV210                                                 06352000
CVTRV212 EQU   CVTRV210                                                 06353000
CVTRV211 EQU   CVTRV210                                                 06354000
CVTLCCAT EQU   CVTS01+420                                               06355000
CVTPCCAT EQU   CVTS01+416                                               06356000
CVTIPCRP EQU   CVTS01+412                                               06357000
CVTIPCRI EQU   CVTS01+408                                               06358000
CVTIPCDS EQU   CVTS01+404                                               06359000
CVTAIDVT EQU   CVTS01+400                                               06360000
CVTSSAP  EQU   CVTS01+396                                               06361000
CVTEHCIR EQU   CVTS01+392                                               06362000
CVTEHDEF EQU   CVTS01+388                                               06363000
CVTDAIR  EQU   CVTS01+384                                               06364000
CVTPERFM EQU   CVTS01+380                                               06365000
CVT044R2 EQU   CVTS01+376                                               06366000
CVTFETCH EQU   CVTS01+372                                               06367000
CVTRSTWD EQU   CVTS01+368                                               06368000
CVTSPOST EQU   CVTS01+364                                               06369000
CVTIOBP  EQU   CVTS01+360                                               06370000
CVTASMVT EQU   CVTS01+356                                               06371000
CVTRECRQ EQU   CVTS01+352                                               06372000
CVTWSAC  EQU   CVTS01+348                                               06373000
CVTRV149 EQU   CVTS01+344                                               06374000
CVTWSAL  EQU   CVTS01+340                                               06375000
CVTSPSA  EQU   CVTS01+336                                               06376000
CVTGLMN  EQU   CVTS01+332                                               06377000
CVTVEAC0 EQU   CVTS01+328                                               06378000
CVT062R1 EQU   CVTS01+324                                               06379000
CVTRPOST EQU   CVTS01+320                                               06380000
CVTDQIQE EQU   CVTS01+316                                               06381000
CVTCSD   EQU   CVTS01+312                                               06382000
CVTLKRMA EQU   CVTS01+308                                               06383000
CVTRSPIE EQU   CVTS01+304                                               06384000
CVTRENQ  EQU   CVTS01+300                                               06385000
CVTLQCB  EQU   CVTS01+296                                               06386000
CVTFQCB  EQU   CVTS01+292                                               06387000
CVTQCS01 EQU   CVTS01+288                                               06388000
CVTAPFT  EQU   CVTS01+284                                               06389000
CVTPARRL EQU   CVTS01+280                                               06390000
CVTVWAIT EQU   CVTS01+276                                               06391000
CVTGSPL  EQU   CVTS01+272                                               06392000
CVTGSMQ  EQU   CVTS01+264                                               06393000
CVTEXPRO EQU   CVTS01+260                                               06394000
CVTOPCTP EQU   CVTS01+256                                               06395000
CVTSIC   EQU   CVTS01+252                                               06396000
CVTTPIOS EQU   CVTS01+248                                               06397000
CVTRTMS  EQU   CVTS01+244                                               06398000
CVTSDBF  EQU   CVTS01+240                                               06399000
CVTSCBP  EQU   CVTS01+236                                               06400000
CVTSDMP  EQU   CVTS01+232                                               06401000
CVTSV60  EQU   CVTS01+228                                               06402000
CVTRTMCT EQU   CVTS01+224                                               06403000
CVTASCBL EQU   CVTS01+220                                               06404000
CVTASCBH EQU   CVTS01+216                                               06405000
CVTGDA   EQU   CVTS01+212                                               06406000
CVTVVMDI EQU   CVTS01+204                                               06407000
CVTAQTOP EQU   CVTS01+200                                               06408000
CVTIOSCS EQU   CVTS01+196                                               06409000
CVTSDRM  EQU   CVTS01+192                                               06410000
CVTOPTE  EQU   CVTS01+188                                               06411000
CVTSTXU  EQU   CVTS01+184                                               06412000
CVTQUIS  EQU   CVTS01+180                                               06413000
CVTPARS  EQU   CVTS01+176                                               06414000
CVTS1EE  EQU   CVTS01+172                                               06415000
CVTFRAS  EQU   CVTS01+168                                               06416000
CVTQSAS  EQU   CVTS01+164                                               06417000
CVTCRAS  EQU   CVTS01+160                                               06418000
CVTCRMN  EQU   CVTS01+156                                               06419000
CVTDELCP EQU   CVTS01+152                                               06420000
CVTFRECL EQU   CVTS01+148                                               06421000
CVTGETCL EQU   CVTS01+144                                               06422000
CVTBLDCP EQU   CVTS01+140                                               06423000
CVTAUTHL EQU   CVTS01+136                                               06424000
CVTSCAN  EQU   CVTS01+132                                               06425000
CVTRV144 EQU   CVTS01+130                                               06426000
CVTMAXMP EQU   CVTS01+128                                               06427000
CVTSTCK  EQU   CVTS01+124                                               06428000
CVTRV139 EQU   CVTS01+123                                               06429000
CVTDSSAC EQU   CVTS01+122                                               06430000
CVTRV513 EQU   CVTS01+121                                               06431000
CVTIOSPL EQU   CVTS01+120                                               06432000
CVTPTGT  EQU   CVTS01+116                                               06433000
CVTCSPIE EQU   CVTS01+112                                               06434000
CVTSMFEX EQU   CVTS01+108                                               06435000
CVTOLT0A EQU   CVTS01+104                                               06436000
CVTSRBRT EQU   CVTS01+100                                               06437000
CVTPUTL  EQU   CVTS01+96                                                06438000
CVTASCRL EQU   CVTS01+92                                                06439000
CVTASCRF EQU   CVTS01+88                                                06440000
CVTRV326 EQU   CVTS01+84                                                06441000
CVTRV325 EQU   CVTS01+80                                                06442000
CVTRV324 EQU   CVTS01+76                                                06443000
CVT0VL01 EQU   CVTS01+72                                                06444000
CVTSHRVM EQU   CVTS01+68                                                06445000
CVTRV332 EQU   CVTS01+64                                                06446000
CVTTAS   EQU   CVTS01+60                                                06447000
CVTRSCN  EQU   CVTS01+56                                                06448000
CVTTRAC2 EQU   CVTS01+54                                                06449000
CVTTRACE EQU   CVTS01+52                                                06450000
CVTAPG   EQU   CVTS01+51                                                06451000
CVTSDTRC EQU   CVTCTLFG                                                 06452000
CVTGTRCE EQU   CVTCTLFG                                                 06453000
CVTNOMP  EQU   CVTCTLFG                                                 06454000
CVTRSV79 EQU   CVTCTLFG                                                 06455000
CVTDSTAT EQU   CVTCTLFG                                                 06456000
CVTRSV78 EQU   CVTCTLFG                                                 06457000
CVTRV333 EQU   CVTCTLFG                                                 06458000
CVTRV323 EQU   CVTCTLFG                                                 06459000
CVTSPVLK EQU   CVTS01+49                                                06460000
CVTRSV77 EQU   CVTS01+48                                                06461000
CVTRV331 EQU   CVTS01+44                                                06462000
CVTRV330 EQU   CVTS01+40                                                06463000
CVTRV329 EQU   CVTS01+36                                                06464000
CVTRV328 EQU   CVTS01+32                                                06465000
CVTRV322 EQU   CVTS01+28                                                06466000
CVTSLID  EQU   CVTSLIDA+1                                               06467000
CVTSYLK  EQU   CVTSLIDA                                                 06468000
CVTRV321 EQU   CVTS01+20                                                06469000
CVTRV320 EQU   CVTS01+16                                                06470000
CVTLPDIR EQU   CVTLPDIA+1                                               06471000
CVTRSV69 EQU   CVTDIRST                                                 06472000
CVTRSV68 EQU   CVTDIRST                                                 06473000
CVTRSV67 EQU   CVTDIRST                                                 06474000
CVTRSV66 EQU   CVTDIRST                                                 06475000
CVTRSV65 EQU   CVTDIRST                                                 06476000
CVTRSV64 EQU   CVTDIRST                                                 06477000
CVTRSV63 EQU   CVTDIRST                                                 06478000
CVTDICOM EQU   CVTDIRST                                                 06479000
CVTLPDSR EQU   CVTS01+4                                                 06480000
CVTGETL  EQU   CVTS01                                                   06481000
@NM00153 EQU   MSG4                                                     06482000
@NM00152 EQU   MSG3+35                                                  06483000
@NM00151 EQU   MSG3                                                     06484000
MSG2EA   EQU   MSG2+36                                                  06485000
@NM00150 EQU   MSG2+32                                                  06486000
@NM00149 EQU   MSG2                                                     06487000
@NM00148 EQU   MSG1+32                                                  06488000
@NM00147 EQU   MSG1                                                     06489000
PVTEND   EQU   PVT+1840                                                 06490000
PVTSPARE EQU   PVT+1838                                                 06491000
PVTCHUIC EQU   PVT+1836                                                 06492000
PVTCOMFX EQU   PVT+1834                                                 06493000
PVTSQAFX EQU   PVT+1832                                                 06494000
PVTCNTFX EQU   PVT+1830                                                 06495000
PVTDEFFX EQU   PVT+1828                                                 06496000
PVTFIXOK EQU   PVT+1826                                                 06497000
PVTPEROK EQU   PVT+1824                                                 06498000
PVTMAXFX EQU   PVT+1822                                                 06499000
PVTPERFX EQU   PVT+1820                                                 06500000
PVTRSRB  EQU   PVT+1776                                                 06501000
PVTRESV5 EQU   PVT+1773                                                 06502000
PVTSRBS  EQU   PVT+1772                                                 06503000
PVTSSRB  EQU   PVT+1768                                                 06504000
PVTACA   EQU   PVTWSAX+1400                                             06505000
PVTSAVE  EQU   PVTWSAX+1328                                             06506000
PVTWSA18 EQU   PVTWSAX+1256                                             06507000
PVTWSA17 EQU   PVTWSAX+1184                                             06508000
PVTWSA16 EQU   PVTWSAX+1112                                             06509000
PVTWSA15 EQU   PVTWSAX+1040                                             06510000
PVTWSA14 EQU   PVTWSAX+968                                              06511000
PVTWSA13 EQU   PVTWSAX+896                                              06512000
PVTWSA12 EQU   PVTWSAX+824                                              06513000
PVTWSA11 EQU   PVTWSAX+752                                              06514000
PVTWSA10 EQU   PVTWSAX+672                                              06515000
PVTWSA9  EQU   PVTWSAX+592                                              06516000
PVTWSA8  EQU   PVTWSAX+504                                              06517000
PVTWSA7  EQU   PVTWSAX+432                                              06518000
PVTWSA6  EQU   PVTWSAX+360                                              06519000
PVTWSA5  EQU   PVTWSAX+288                                              06520000
PVTWSA4  EQU   PVTWSAX+216                                              06521000
PVTWSA3  EQU   PVTWSAX+144                                              06522000
PVTWSA2  EQU   PVTWSAX+72                                               06523000
PVTWSA1  EQU   PVTWSAX                                                  06524000
PVTCIOQL EQU   PVTQS+36                                                 06525000
PVTCIOQF EQU   PVTQS+32                                                 06526000
PVTGFADL EQU   PVTQS+28                                                 06527000
PVTGFADF EQU   PVTQS+24                                                 06528000
PVTFPCBL EQU   PVTQS+20                                                 06529000
PVTFPCBF EQU   PVTQS+16                                                 06530000
PVTSQAQL EQU   PVTQS+14                                                 06531000
PVTSQAQF EQU   PVTQS+12                                                 06532000
PVTCFQL  EQU   PVTQS+10                                                 06533000
PVTCFQF  EQU   PVTQS+8                                                  06534000
PVTRSRVL EQU   PVTQS+6                                                  06535000
PVTRSRVF EQU   PVTQS+4                                                  06536000
PVTAFQL  EQU   PVTQS+2                                                  06537000
PVTAFQF  EQU   PVTQS                                                    06538000
PVTSPFR  EQU   PVT+302                                                  06539000
PVTCFMCT EQU   PVT+300                                                  06540000
PVTSPREC EQU   PVT+296                                                  06541000
PVTCAREC EQU   PVT+292                                                  06542000
PVTCAOUT EQU   PVT+288                                                  06543000
PVTCAIN  EQU   PVT+284                                                  06544000
PVTNSWPS EQU   PVT+280                                                  06545000
PVTNPREC EQU   PVT+276                                                  06546000
PVTSPOUT EQU   PVT+272                                                  06547000
PVTSPIN  EQU   PVT+268                                                  06548000
PVTVAMR  EQU   PVT+264                                                  06549000
PVTVAMO  EQU   PVT+260                                                  06550000
PVTVAMI  EQU   PVT+256                                                  06551000
PVTNPOUT EQU   PVT+252                                                  06552000
PVTNPIN  EQU   PVT+248                                                  06553000
PVTPRSET EQU   PVT+244                                                  06554000
PVTFRSLT EQU   PVT+240                                                  06555000
PVTPAGIO EQU   PVT+236                                                  06556000
PVTSWPIO EQU   PVT+232                                                  06557000
PVTPSWPP EQU   PVT+228                                                  06558000
PVTPPREF EQU   PVT+224                                                  06559000
PVTPOPBR EQU   PVT+220                                                  06560000
PVTPRELF EQU   PVT+216                                                  06561000
PVTPRELV EQU   PVT+212                                                  06562000
PVTPFREE EQU   PVT+208                                                  06563000
PVTPRELS EQU   PVT+204                                                  06564000
PVTPOUT  EQU   PVT+200                                                  06565000
PVTPFXLD EQU   PVT+196                                                  06566000
PVTPITAS EQU   PVT+192                                                  06567000
PVTPSRBP EQU   PVT+188                                                  06568000
PVTPDSEG EQU   PVT+184                                                  06569000
PVTPCSGB EQU   PVT+180                                                  06570000
PVTPCSEG EQU   PVT+176                                                  06571000
PVTPINV  EQU   PVT+172                                                  06572000
PVTPSWPC EQU   PVT+168                                                  06573000
PVTPSOUT EQU   PVT+164                                                  06574000
PVTPSWIN EQU   PVT+160                                                  06575000
PVTPRCV  EQU   PVT+156                                                  06576000
PVTPRCFI EQU   PVT+152                                                  06577000
PVTPVRC  EQU   PVT+144                                                  06578000
PVTPVRIN EQU   PVT+140                                                  06579000
PVTPVRLS EQU   PVT+136                                                  06580000
PVTPVEQR EQU   PVT+132                                                  06581000
PVTPPIOI EQU   PVT+128                                                  06582000
PVTPVRPO EQU   PVT+124                                                  06583000
PVTPRFR  EQU   PVT+120                                                  06584000
PVTPFP2  EQU   PVT+116                                                  06585000
PVTPFP   EQU   PVT+112                                                  06586000
PVTPFTE  EQU   PVT+108                                                  06587000
PVTPCB   EQU   PVT+104                                                  06588000
PVTREP2  EQU   PVT+100                                                  06589000
PVTPIOCP EQU   PVT+96                                                   06590000
PVTPIOP  EQU   PVT+92                                                   06591000
PVTPGFAD EQU   PVT+88                                                   06592000
PVTPGFA  EQU   PVT+84                                                   06593000
PVTPSQA  EQU   PVT+80                                                   06594000
PVTPSINT EQU   PVT+76                                                   06595000
PVTSRBID EQU   PVT+68                                                   06596000
PVTPCIWA EQU   PVT+64                                                   06597000
PVTHQSA  EQU   PVT+62                                                   06598000
PVTLQSA  EQU   PVT+60                                                   06599000
PVTOROOT EQU   PVT+56                                                   06600000
PVTPRCA  EQU   PVT+52                                                   06601000
PVTREUS  EQU   PVT+48                                                   06602000
PVTRESV4 EQU   PVT+46                                                   06603000
PVTRSUS  EQU   PVT+44                                                   06604000
PVTVROOT EQU   PVT+40                                                   06605000
PVTPCBLO EQU   PVT+38                                                   06606000
PVTPCBCT EQU   PVT+36                                                   06607000
PVTDFRS  EQU   PVT+34                                                   06608000
PVTRSQA  EQU   PVT+32                                                   06609000
PVTPTLB  EQU   PVT+31                                                   06610000
PVTPCBNO EQU   PVT+30                                                   06611000
PVTSRBNO EQU   PVT+29                                                   06612000
PVTSQDC  EQU   PVT+28                                                   06613000
PVTLCSA  EQU   PVT+26                                                   06614000
PVTLPRIV EQU   PVT+24                                                   06615000
PVTLVR   EQU   PVT+22                                                   06616000
PVTFVR   EQU   PVT+20                                                   06617000
PVTLPFN  EQU   PVT+18                                                   06618000
PVTFPFN  EQU   PVT+16                                                   06619000
PVTPFTP  EQU   PVT+12                                                   06620000
PVTSSPIN EQU   PVT+11                                                   06621000
PVTPCBS  EQU   PVT+10                                                   06622000
PVTPOOL  EQU   PVT+8                                                    06623000
PVTAFCOK EQU   PVT+6                                                    06624000
PVTAFCLO EQU   PVT+4                                                    06625000
PVTAFC   EQU   PVT+2                                                    06626000
PVTFLAG2 EQU   PVT+1                                                    06627000
PVTDUMP  EQU   PVTFLAG1                                                 06628000
PVTSIT   EQU   PVTFLAG1                                                 06629000
PVTLSI   EQU   PVTFLAG1                                                 06630000
PVTRESV1 EQU   PVTFLAG1                                                 06631000
PVTPCBLT EQU   PVTFLAG1                                                 06632000
PVTSRBIU EQU   PVTFLAG1                                                 06633000
PVTBGMS  EQU   PVTFLAG1                                                 06634000
PVTPMSG  EQU   PVTFLAG1                                                 06635000
ASCBEND  EQU   ASCB+208                                                 06636000
ASCBSRBT EQU   ASCB+200                                                 06637000
ASCBSWTL EQU   ASCB+196                                                 06638000
ASCBRS14 EQU   ASCB+195                                                 06639000
ASCBSMCT EQU   ASCB+194                                                 06640000
ASCBRS12 EQU   ASCB+192                                                 06641000
ASCBPCTT EQU   ASCB+188                                                 06642000
ASCBVGTT EQU   ASCB+184                                                 06643000
ASCBRV43 EQU   ASCBSRQ4                                                 06644000
ASCBRV42 EQU   ASCBSRQ4                                                 06645000
ASCBRV41 EQU   ASCBSRQ4                                                 06646000
ASCBRV40 EQU   ASCBSRQ4                                                 06647000
ASCBRV39 EQU   ASCBSRQ4                                                 06648000
ASCBRV38 EQU   ASCBSRQ4                                                 06649000
ASCBRV37 EQU   ASCBSRQ4                                                 06650000
ASCBRV36 EQU   ASCBSRQ4                                                 06651000
ASCBRV35 EQU   ASCBSRQ3                                                 06652000
ASCBRV34 EQU   ASCBSRQ3                                                 06653000
ASCBRV33 EQU   ASCBSRQ3                                                 06654000
ASCBRV32 EQU   ASCBSRQ3                                                 06655000
ASCBRV31 EQU   ASCBSRQ3                                                 06656000
ASCBRV30 EQU   ASCBSRQ3                                                 06657000
ASCBRV29 EQU   ASCBSRQ3                                                 06658000
ASCBRV28 EQU   ASCBSRQ3                                                 06659000
ASCBRV27 EQU   ASCBSRQ2                                                 06660000
ASCBRV26 EQU   ASCBSRQ2                                                 06661000
ASCBRV25 EQU   ASCBSRQ2                                                 06662000
ASCBRV24 EQU   ASCBSRQ2                                                 06663000
ASCBRV23 EQU   ASCBSRQ2                                                 06664000
ASCBRV22 EQU   ASCBSRQ2                                                 06665000
ASCBRV21 EQU   ASCBSRQ2                                                 06666000
ASCBRV20 EQU   ASCBSRQ2                                                 06667000
ASCBRV19 EQU   ASCBSRQ1                                                 06668000
ASCBRV18 EQU   ASCBSRQ1                                                 06669000
ASCBRV17 EQU   ASCBSRQ1                                                 06670000
ASCBRV16 EQU   ASCBSRQ1                                                 06671000
ASCBRV15 EQU   ASCBSRQ1                                                 06672000
ASCBRV14 EQU   ASCBSRQ1                                                 06673000
ASCBRV13 EQU   ASCBSRQ1                                                 06674000
ASCBSTA  EQU   ASCBSRQ1                                                 06675000
ASCBJBNS EQU   ASCB+176                                                 06676000
ASCBJBNI EQU   ASCB+172                                                 06677000
ASCBMCC  EQU   ASCB+168                                                 06678000
ASCBRTWA EQU   ASCB+164                                                 06679000
ASCBIQEA EQU   ASCB+160                                                 06680000
ASCBXMPQ EQU   ASCB+156                                                 06681000
ASCBRS01 EQU   ASCB+154                                                 06682000
ASCBFMCT EQU   ASCB+152                                                 06683000
ASCBOUXB EQU   ASCB+148                                                 06684000
ASCBOUCB EQU   ASCB+144                                                 06685000
ASCBMECB EQU   ASCB+140                                                 06686000
ASCBQECB EQU   ASCB+136                                                 06687000
ASCBLSQH EQU   ASCBLKGP+4                                               06688000
ASCBLOCK EQU   ASCBLKGP                                                 06689000
ASCBTCBS EQU   ASCB+124                                                 06690000
ASCBNVSC EQU   ASCB+122                                                 06691000
ASCBVSC  EQU   ASCB+120                                                 06692000
ASCBSRBS EQU   ASCB+118                                                 06693000
ASCBSSRB EQU   ASCB+116                                                 06694000
ASCBRV06 EQU   ASCBFLG2                                                 06695000
ASCBRV05 EQU   ASCBFLG2                                                 06696000
ASCBRV04 EQU   ASCBFLG2                                                 06697000
ASCBSNQS EQU   ASCBFLG2                                                 06698000
ASCBS2S  EQU   ASCBFLG2                                                 06699000
ASCBCEXT EQU   ASCBFLG2                                                 06700000
ASCBPXMT EQU   ASCBFLG2                                                 06701000
ASCBXMPT EQU   ASCBFLG2                                                 06702000
ASCBRF07 EQU   ASCBDSP1                                                 06703000
ASCBRF06 EQU   ASCBDSP1                                                 06704000
ASCBRF05 EQU   ASCBDSP1                                                 06705000
ASCBRF04 EQU   ASCBDSP1                                                 06706000
ASCBRF03 EQU   ASCBDSP1                                                 06707000
ASCBRF02 EQU   ASCBDSP1                                                 06708000
ASCBNOQ  EQU   ASCBDSP1                                                 06709000
ASCBSWCT EQU   ASCB+112                                                 06710000
ASCBASXB EQU   ASCB+108                                                 06711000
ASCBTMCH EQU   ASCB+104                                                 06712000
ASCBNSWP EQU   ASCBFLG1                                                 06713000
ASCBTYP1 EQU   ASCBFLG1                                                 06714000
ASCBSTND EQU   ASCBFLG1                                                 06715000
ASCBABNT EQU   ASCBFLG1                                                 06716000
ASCBTERM EQU   ASCBFLG1                                                 06717000
ASCBS3S  EQU   ASCBFLG1                                                 06718000
ASCBCMSH EQU   ASCBFLG1                                                 06719000
ASCBTOFF EQU   ASCBFLG1                                                 06720000
ASCBRF01 EQU   ASCBRCTF                                                 06721000
ASCBTMLW EQU   ASCBRCTF                                                 06722000
ASCBOUT  EQU   ASCBRCTF                                                 06723000
ASCBWAIT EQU   ASCBRCTF                                                 06724000
ASCBRV08 EQU   ASCBRCTF                                                 06725000
ASCBFQU  EQU   ASCBRCTF                                                 06726000
ASCBFRS  EQU   ASCBRCTF                                                 06727000
ASCBTMNO EQU   ASCBRCTF                                                 06728000
ASCBAFFN EQU   ASCBFW1                                                  06729000
ASCBDUMP EQU   ASCB+96                                                  06730000
ASCBRV44 EQU   ASCB+92                                                  06731000
ASCBUBET EQU   ASCB+88                                                  06732000
ASCBECB  EQU   ASCB+84                                                  06733000
ASCBJSTL EQU   ASCB+80                                                  06734000
ASCBEWST EQU   ASCB+72                                                  06735000
ASCBEJST EQU   ASCB+64                                                  06736000
ASCBTSB  EQU   ASCB+60                                                  06737000
ASCBCSCB EQU   ASCB+56                                                  06738000
ASCBRSM  EQU   ASCB+52                                                  06739000
ASCBLDA  EQU   ASCB+48                                                  06740000
ASCBSTOR EQU   ASCB+44                                                  06741000
ASCBDP   EQU   ASCB+43                                                  06742000
ASCBRV07 EQU   ASCB+42                                                  06743000
ASCBIOSM EQU   ASCB+40                                                  06744000
ASCBSEQN EQU   ASCB+38                                                  06745000
ASCBASID EQU   ASCB+36                                                  06746000
ASCBCPUS EQU   ASCB+32                                                  06747000
ASCBSPL  EQU   ASCB+28                                                  06748000
ASCBIOSP EQU   ASCB+24                                                  06749000
ASCBSYNC EQU   ASCBSUPC+4                                               06750000
ASCBSVRB EQU   ASCBSUPC                                                 06751000
ASCBCMSF EQU   ASCB+12                                                  06752000
ASCBBWDP EQU   ASCB+8                                                   06753000
ASCBFWDP EQU   ASCB+4                                                   06754000
ASCBASCB EQU   ASCB                                                     06755000
ASCBEGIN EQU   ASCB                                                     06756000
ASVTEND  EQU   ASVT+528                                                 06757000
ASVTAVAI EQU   ASVTFRST                                                 06758000
ASVTRS00 EQU   ASVT+520                                                 06759000
ASVTMAXU EQU   ASVT+516                                                 06760000
ASVTASVT EQU   ASVT+512                                                 06761000
ASVTBEGN EQU   ASVT+512                                                 06762000
@NM00080 EQU   ASVT                                                     06763000
@NM00079 EQU   SRB+40                                                   06764000
@NM00078 EQU   SRB+38                                                   06765000
SRBPRIOR EQU   SRB+37                                                   06766000
SRBPKF   EQU   SRB+36                                                   06767000
SRBSAVE  EQU   SRB+32                                                   06768000
SRBCPAFF EQU   SRBFLC                                                   06769000
SRBID    EQU   SRB                                                      06770000
@NM00077 EQU   SDWA+512                                                 06771000
SDWAVRA  EQU   SDWARA+4                                                 06772000
SDWAURAL EQU   SDWARA+3                                                 06773000
@NM00076 EQU   SDWADPVA                                                 06774000
SDWAEBC  EQU   SDWADPVA                                                 06775000
SDWAHEX  EQU   SDWADPVA                                                 06776000
SDWAVRAL EQU   SDWARA                                                   06777000
@NM00075 EQU   SDWA+396                                                 06778000
SDWACOMP EQU   SDWA+392                                                 06779000
SDWARCPL EQU   SDWA+364                                                 06780000
@NM00074 EQU   SDWADPSA+32                                              06781000
SDWATO4  EQU   SDWADPSL+28                                              06782000
SDWAFRM4 EQU   SDWADPSL+24                                              06783000
SDWATO3  EQU   SDWADPSL+20                                              06784000
SDWAFRM3 EQU   SDWADPSL+16                                              06785000
SDWATO2  EQU   SDWADPSL+12                                              06786000
SDWAFRM2 EQU   SDWADPSL+8                                               06787000
SDWATO1  EQU   SDWADPSL+4                                               06788000
SDWAFRM1 EQU   SDWADPSL                                                 06789000
@NM00073 EQU   SDWADDAT+3                                               06790000
@NM00072 EQU   SDWAPDAT                                                 06791000
SDWAUSPL EQU   SDWAPDAT                                                 06792000
SDWADPSW EQU   SDWAPDAT                                                 06793000
SDWATJPA EQU   SDWAPDAT                                                 06794000
SDWATLPA EQU   SDWAPDAT                                                 06795000
SDWADREG EQU   SDWAPDAT                                                 06796000
SDWADSAH EQU   SDWAPDAT                                                 06797000
SDWADSAS EQU   SDWAPDAT                                                 06798000
@NM00071 EQU   SDWADDAT+1                                               06799000
@NM00070 EQU   SDWASDAT                                                 06800000
SDWAQQS  EQU   SDWASDAT                                                 06801000
SDWACBS  EQU   SDWASDAT                                                 06802000
SDWAGTF  EQU   SDWASDAT                                                 06803000
SDWASWA  EQU   SDWASDAT                                                 06804000
SDWALSQA EQU   SDWASDAT                                                 06805000
SDWASQA  EQU   SDWASDAT                                                 06806000
SDWANUC  EQU   SDWASDAT                                                 06807000
@NM00069 EQU   SDWADUMP+2                                               06808000
@NM00068 EQU   SDWADPFS                                                 06809000
SDWASLST EQU   SDWADPFS                                                 06810000
@NM00067 EQU   SDWADPFS                                                 06811000
SDWADLST EQU   SDWADPFS                                                 06812000
SDWADPT  EQU   SDWADPFS                                                 06813000
SDWADPID EQU   SDWADUMP                                                 06814000
SDWADPLA EQU   SDWA+316                                                 06815000
@NM00066 EQU   SDWA+290                                                 06816000
SDWAASID EQU   SDWA+288                                                 06817000
SDWATALW EQU   SDWALKWS+28                                              06818000
SDWATDLW EQU   SDWALKWS+24                                              06819000
SDWATNLW EQU   SDWALKWS+20                                              06820000
SDWAAPLW EQU   SDWALKWS+16                                              06821000
SDWAIPLW EQU   SDWALKWS+12                                              06822000
SDWAILLW EQU   SDWALKWS+8                                               06823000
SDWAIULW EQU   SDWALKWS+4                                               06824000
SDWAICLW EQU   SDWALKWS                                                 06825000
SDWAFLLK EQU   SDWAACF4                                                 06826000
SDWACMS  EQU   SDWAACF4                                                 06827000
SDWAOPTM EQU   SDWAACF4                                                 06828000
SDWATADB EQU   SDWAACF4                                                 06829000
SDWATDNB EQU   SDWAACF4                                                 06830000
SDWATNCB EQU   SDWAACF4                                                 06831000
SDWAILCH EQU   SDWAACF4                                                 06832000
SDWAIUCB EQU   SDWAACF4                                                 06833000
SDWAICAT EQU   SDWAACF3                                                 06834000
SDWAIPRG EQU   SDWAACF3                                                 06835000
SDWASALL EQU   SDWAACF3                                                 06836000
SDWAASMP EQU   SDWAACF3                                                 06837000
SDWADISP EQU   SDWAACF3                                                 06838000
@NM00065 EQU   SDWAACF3                                                 06839000
@NM00064 EQU   SDWAACF2                                                 06840000
@NM00063 EQU   SDWAACF2                                                 06841000
SDWASPIN EQU   SDWAACF2                                                 06842000
@NM00062 EQU   SDWAACF2                                                 06843000
SDWALCPU EQU   SDWACPUA+2                                               06844000
@NM00061 EQU   SDWACPUA                                                 06845000
SDWARECA EQU   SDWA+244                                                 06846000
@NM00060 EQU   SDWA+239                                                 06847000
@NM00059 EQU   SDWAIOFS                                                 06848000
SDWANIOP EQU   SDWAIOFS                                                 06849000
SDWANOIO EQU   SDWAIOFS                                                 06850000
SDWAIOHT EQU   SDWAIOFS                                                 06851000
SDWAIOQR EQU   SDWAIOFS                                                 06852000
SDWAFMID EQU   SDWA+236                                                 06853000
@NM00058 EQU   SDWAERRD                                                 06854000
SDWAMCIV EQU   SDWAERRD                                                 06855000
SDWARPIV EQU   SDWAERRD                                                 06856000
SDWAMABD EQU   SDWAERRD                                                 06857000
SDWACTS  EQU   SDWAERRD                                                 06858000
SDWASTAE EQU   SDWAERRD                                                 06859000
SDWANRBE EQU   SDWAERRD                                                 06860000
SDWACLUP EQU   SDWAERRD                                                 06861000
@NM00057 EQU   SDWAERRC                                                 06862000
SDWAEAS  EQU   SDWAERRC                                                 06863000
SDWAPERC EQU   SDWAERRC                                                 06864000
SDWAIRB  EQU   SDWAERRC                                                 06865000
SDWASTAI EQU   SDWAERRC                                                 06866000
SDWASTAF EQU   SDWAERRC                                                 06867000
SDWASRBM EQU   SDWAERRB                                                 06868000
SDWALDIS EQU   SDWAERRB                                                 06869000
SDWAENRB EQU   SDWAERRB                                                 06870000
SDWATYP1 EQU   SDWAERRB                                                 06871000
@NM00056 EQU   SDWAERRB                                                 06872000
SDWAPGIO EQU   SDWAERRA                                                 06873000
SDWATEXC EQU   SDWAERRA                                                 06874000
SDWASVCE EQU   SDWAERRA                                                 06875000
SDWAABTM EQU   SDWAERRA                                                 06876000
SDWASVCD EQU   SDWAERRA                                                 06877000
SDWARKEY EQU   SDWAERRA                                                 06878000
SDWAPCHK EQU   SDWAERRA                                                 06879000
SDWAMCHK EQU   SDWAERRA                                                 06880000
SDWATIME EQU   SDWAMCH+20                                               06881000
@NM00055 EQU   SDWAMCH+14                                               06882000
SDWAVEQR EQU   SDWARSR2                                                 06883000
SDWAPGFX EQU   SDWARSR2                                                 06884000
SDWAFLSQ EQU   SDWARSR2                                                 06885000
SDWAFSQA EQU   SDWARSR2                                                 06886000
SDWANUCL EQU   SDWARSR2                                                 06887000
SDWASPER EQU   SDWARSR2                                                 06888000
SDWAINTC EQU   SDWARSR2                                                 06889000
SDWAOFLN EQU   SDWARSR2                                                 06890000
SDWACHNG EQU   SDWARSR1                                                 06891000
SDWAMSER EQU   SDWARSR1                                                 06892000
@NM00054 EQU   SDWARSR1                                                 06893000
SDWACPID EQU   SDWAMCH+10                                               06894000
SDWATERR EQU   SDWAMCHD                                                 06895000
SDWAFPRX EQU   SDWAMCHD                                                 06896000
SDWAINSF EQU   SDWAMCHD                                                 06897000
SDWAACR  EQU   SDWAMCHD                                                 06898000
SDWAPSWU EQU   SDWAMCHD                                                 06899000
SDWAREGU EQU   SDWAMCHD                                                 06900000
@NM00053 EQU   SDWAMCHS                                                 06901000
SDWARSRF EQU   SDWAMCHS                                                 06902000
SDWARSRC EQU   SDWAMCHS                                                 06903000
SDWAINVP EQU   SDWAMCHS                                                 06904000
SDWATSVL EQU   SDWAMCHS                                                 06905000
SDWARCDF EQU   SDWAMCHS                                                 06906000
SDWASCKE EQU   SDWASTCK+4                                               06907000
SDWASCKB EQU   SDWASTCK                                                 06908000
SDWALNTH EQU   SDWAIDNT+1                                               06909000
SDWASPID EQU   SDWAIDNT                                                 06910000
SDWASR15 EQU   SDWASRSV+60                                              06911000
SDWASR14 EQU   SDWASRSV+56                                              06912000
SDWASR13 EQU   SDWASRSV+52                                              06913000
SDWASR12 EQU   SDWASRSV+48                                              06914000
SDWASR11 EQU   SDWASRSV+44                                              06915000
SDWASR10 EQU   SDWASRSV+40                                              06916000
SDWASR09 EQU   SDWASRSV+36                                              06917000
SDWASR08 EQU   SDWASRSV+32                                              06918000
SDWASR07 EQU   SDWASRSV+28                                              06919000
SDWASR06 EQU   SDWASRSV+24                                              06920000
SDWASR05 EQU   SDWASRSV+20                                              06921000
SDWASR04 EQU   SDWASRSV+16                                              06922000
SDWASR03 EQU   SDWASRSV+12                                              06923000
SDWASR02 EQU   SDWASRSV+8                                               06924000
SDWASR01 EQU   SDWASRSV+4                                               06925000
SDWASR00 EQU   SDWASRSV                                                 06926000
SDWATRN2 EQU   SDWAAEC2+4                                               06927000
SDWAIPC2 EQU   SDWAICD2                                                 06928000
SDWAIMC2 EQU   SDWAICD2                                                 06929000
SDWAIPR2 EQU   SDWAICD2                                                 06930000
@NM00052 EQU   SDWAINC2                                                 06931000
@NM00051 EQU   SDWAILC2                                                 06932000
SDWAIL2  EQU   SDWAILC2                                                 06933000
@NM00050 EQU   SDWAILC2                                                 06934000
@NM00049 EQU   SDWAAEC2                                                 06935000
SDWAADD2 EQU   SDWANXT2+1                                               06936000
@NM00048 EQU   SDWANXT2                                                 06937000
@NM00047 EQU   SDWAEC2+3                                                06938000
SDWASGN2 EQU   SDWAINT2                                                 06939000
SDWAEXP2 EQU   SDWAINT2                                                 06940000
SDWADEC2 EQU   SDWAINT2                                                 06941000
SDWAFPO2 EQU   SDWAINT2                                                 06942000
SDWACC2  EQU   SDWAINT2                                                 06943000
@NM00046 EQU   SDWAINT2                                                 06944000
SDWAPGM2 EQU   SDWAMWP2                                                 06945000
SDWAWAT2 EQU   SDWAMWP2                                                 06946000
SDWAMCK2 EQU   SDWAMWP2                                                 06947000
SDWAECT2 EQU   SDWAMWP2                                                 06948000
SDWAKEY2 EQU   SDWAMWP2                                                 06949000
SDWAEXT2 EQU   SDWAEMK2                                                 06950000
SDWAIO2  EQU   SDWAEMK2                                                 06951000
SDWATRM2 EQU   SDWAEMK2                                                 06952000
@NM00045 EQU   SDWAEMK2                                                 06953000
SDWAPER2 EQU   SDWAEMK2                                                 06954000
@NM00044 EQU   SDWAEMK2                                                 06955000
SDWATRAN EQU   SDWAAEC1+4                                               06956000
SDWAIPC1 EQU   SDWAICD1                                                 06957000
SDWAIMC1 EQU   SDWAICD1                                                 06958000
SDWAIPR1 EQU   SDWAICD1                                                 06959000
@NM00043 EQU   SDWAINC1                                                 06960000
@NM00042 EQU   SDWAILC1                                                 06961000
SDWAIL1  EQU   SDWAILC1                                                 06962000
@NM00041 EQU   SDWAILC1                                                 06963000
@NM00040 EQU   SDWAAEC1                                                 06964000
SDWAADD1 EQU   SDWANXT1+1                                               06965000
@NM00039 EQU   SDWANXT1                                                 06966000
@NM00038 EQU   SDWAEC1+3                                                06967000
SDWASGN1 EQU   SDWAINT1                                                 06968000
SDWAEXP1 EQU   SDWAINT1                                                 06969000
SDWADEC1 EQU   SDWAINT1                                                 06970000
SDWAFPO1 EQU   SDWAINT1                                                 06971000
SDWACC1  EQU   SDWAINT1                                                 06972000
@NM00037 EQU   SDWAINT1                                                 06973000
SDWAPGM1 EQU   SDWAMWP1                                                 06974000
SDWAWAT1 EQU   SDWAMWP1                                                 06975000
SDWAMCK1 EQU   SDWAMWP1                                                 06976000
SDWAECT1 EQU   SDWAMWP1                                                 06977000
SDWAKEY1 EQU   SDWAMWP1                                                 06978000
SDWAEXT1 EQU   SDWAEMK1                                                 06979000
SDWAIO1  EQU   SDWAEMK1                                                 06980000
SDWATRM1 EQU   SDWAEMK1                                                 06981000
@NM00036 EQU   SDWAEMK1                                                 06982000
SDWAPER1 EQU   SDWAEMK1                                                 06983000
@NM00035 EQU   SDWAEMK1                                                 06984000
SDWAIOBR EQU   SDWA+100                                                 06985000
SDWAEPA  EQU   SDWA+96                                                  06986000
@NM00034 EQU   SDWANAME+4                                               06987000
SDWARBAD EQU   SDWANAME                                                 06988000
SDWAGR15 EQU   SDWAGRSV+60                                              06989000
SDWAGR14 EQU   SDWAGRSV+56                                              06990000
SDWAGR13 EQU   SDWAGRSV+52                                              06991000
SDWAGR12 EQU   SDWAGRSV+48                                              06992000
SDWAGR11 EQU   SDWAGRSV+44                                              06993000
SDWAGR10 EQU   SDWAGRSV+40                                              06994000
SDWAGR09 EQU   SDWAGRSV+36                                              06995000
SDWAGR08 EQU   SDWAGRSV+32                                              06996000
SDWAGR07 EQU   SDWAGRSV+28                                              06997000
SDWAGR06 EQU   SDWAGRSV+24                                              06998000
SDWAGR05 EQU   SDWAGRSV+20                                              06999000
SDWAGR04 EQU   SDWAGRSV+16                                              07000000
SDWAGR03 EQU   SDWAGRSV+12                                              07001000
SDWAGR02 EQU   SDWAGRSV+8                                               07002000
SDWAGR01 EQU   SDWAGRSV+4                                               07003000
SDWAGR00 EQU   SDWAGRSV                                                 07004000
SDWANXTP EQU   SDWACTL2+5                                               07005000
SDWASGP  EQU   SDWAPMKP                                                 07006000
SDWAEUP  EQU   SDWAPMKP                                                 07007000
SDWADOP  EQU   SDWAPMKP                                                 07008000
SDWAFPP  EQU   SDWAPMKP                                                 07009000
SDWACCP  EQU   SDWAPMKP                                                 07010000
SDWAILP  EQU   SDWAPMKP                                                 07011000
SDWAINTP EQU   SDWACTL2+2                                               07012000
SDWASPVP EQU   SDWAMWPP                                                 07013000
SDWAWATP EQU   SDWAMWPP                                                 07014000
SDWAMCKP EQU   SDWAMWPP                                                 07015000
@NM00033 EQU   SDWAMWPP                                                 07016000
SDWAKEYP EQU   SDWAMWPP                                                 07017000
SDWAEXTP EQU   SDWACMKP                                                 07018000
SDWAIOP  EQU   SDWACMKP                                                 07019000
SDWANXTA EQU   SDWACTL1+5                                               07020000
SDWASGA  EQU   SDWAPMKA                                                 07021000
SDWAEUA  EQU   SDWAPMKA                                                 07022000
SDWADOA  EQU   SDWAPMKA                                                 07023000
SDWAFPA  EQU   SDWAPMKA                                                 07024000
SDWACCA  EQU   SDWAPMKA                                                 07025000
SDWAILA  EQU   SDWAPMKA                                                 07026000
SDWAINTA EQU   SDWACTL1+2                                               07027000
SDWASPVA EQU   SDWAMWPA                                                 07028000
SDWAWATA EQU   SDWAMWPA                                                 07029000
SDWAMCKA EQU   SDWAMWPA                                                 07030000
@NM00032 EQU   SDWAMWPA                                                 07031000
SDWAKEYA EQU   SDWAMWPA                                                 07032000
SDWAEXTA EQU   SDWACMKA                                                 07033000
SDWAIOA  EQU   SDWACMKA                                                 07034000
@NM00031 EQU   SDWACMPF                                                 07035000
SDWASTCC EQU   SDWACMPF                                                 07036000
@NM00030 EQU   SDWACMPF                                                 07037000
SDWASTEP EQU   SDWACMPF                                                 07038000
SDWAPARM EQU   SDWA                                                     07039000
ESTARSVI EQU   ESTAFGRS+1                                               07040000
@NM00029 EQU   ESTAFLG2                                                 07041000
ESTABRNT EQU   ESTAFLG2                                                 07042000
@NM00028 EQU   ESTAFLG2                                                 07043000
ESTAEREC EQU   ESTAFLG2                                                 07044000
ESTATERM EQU   ESTAFLG2                                                 07045000
@NM00027 EQU   ESTAFLG2                                                 07046000
ESTAOWNR EQU   ESTA+8                                                   07047000
ESTAPARM EQU   ESTA+4                                                   07048000
ESTAEXIT EQU   ESTAEXT+1                                                07049000
ESTAHALT EQU   ESTAIO                                                   07050000
ESTANOIO EQU   ESTAIO                                                   07051000
ESTASYNC EQU   ESTAFLG1                                                 07052000
@NM00026 EQU   ESTAFLG1                                                 07053000
ESTAESTA EQU   ESTAFLG1                                                 07054000
@NM00025 EQU   ESTAFLG1                                                 07055000
ESTASTAR EQU   ESTAFLG1                                                 07056000
ESTASTAI EQU   ESTAFLG1                                                 07057000
WPLMLTXT EQU   WPLML+4                                                  07058000
WPLMLLT2 EQU   WPLMLLTF+1                                               07059000
WPLRSV24 EQU   WPLMLLT1                                                 07060000
WPLRSV23 EQU   WPLMLLT1                                                 07061000
WPLRSV22 EQU   WPLMLLT1                                                 07062000
WPLRSV21 EQU   WPLMLLT1                                                 07063000
WPLMLLTD EQU   WPLMLLT1                                                 07064000
WPLMLLTC EQU   WPLMLLT1                                                 07065000
WPLMLLTB EQU   WPLMLLT1                                                 07066000
WPLMLLTA EQU   WPLMLLT1                                                 07067000
WPLMLLEN EQU   WPLML+1                                                  07068000
WPLML0   EQU   WPLML                                                    07069000
WPLLINES EQU   WPLLS01+3                                                07070000
WPLAREA  EQU   WPLLS01+2                                                07071000
WPLLTF2  EQU   WPLLTF+1                                                 07072000
WPLRSV20 EQU   WPLLTF1                                                  07073000
WPLRSV19 EQU   WPLLTF1                                                  07074000
WPLRSV18 EQU   WPLLTF1                                                  07075000
WPLRSV17 EQU   WPLLTF1                                                  07076000
WPLLTFD  EQU   WPLLTF1                                                  07077000
WPLLTFC  EQU   WPLLTF1                                                  07078000
WPLLTFB  EQU   WPLLTF1                                                  07079000
WPLLTFA  EQU   WPLLTF1                                                  07080000
WPLQID   EQU   WPLFLGS+6                                                07081000
WPLRSV32 EQU   WPLMSGT2                                                 07082000
WPLRSV31 EQU   WPLMSGT2                                                 07083000
WPLRSV30 EQU   WPLMSGT2                                                 07084000
WPLRSV29 EQU   WPLMSGT2                                                 07085000
WPLRSV28 EQU   WPLMSGT2                                                 07086000
WPLRSV27 EQU   WPLMSGT2                                                 07087000
WPLRSV26 EQU   WPLMSGT2                                                 07088000
WPLRSV25 EQU   WPLMSGT2                                                 07089000
WPLRSV16 EQU   WPLMSGT1                                                 07090000
WPLRSV15 EQU   WPLMSGT1                                                 07091000
WPLMSGTF EQU   WPLMSGT1                                                 07092000
WPLRSV14 EQU   WPLMSGT1                                                 07093000
WPLMSGTD EQU   WPLMSGT1                                                 07094000
WPLMSGTC EQU   WPLMSGT1                                                 07095000
WPLMSGTB EQU   WPLMSGT1                                                 07096000
WPLMSGTA EQU   WPLMSGT1                                                 07097000
WPLRSV13 EQU   WPLROUT2                                                 07098000
WPLROUTO EQU   WPLROUT2                                                 07099000
WPLROUTN EQU   WPLROUT2                                                 07100000
WPLROUTM EQU   WPLROUT2                                                 07101000
WPLROUTL EQU   WPLROUT2                                                 07102000
WPLROUTK EQU   WPLROUT2                                                 07103000
WPLROUTJ EQU   WPLROUT2                                                 07104000
WPLROUTI EQU   WPLROUT2                                                 07105000
WPLROUTH EQU   WPLROUT1                                                 07106000
WPLROUTG EQU   WPLROUT1                                                 07107000
WPLROUTF EQU   WPLROUT1                                                 07108000
WPLROUTE EQU   WPLROUT1                                                 07109000
WPLROUTD EQU   WPLROUT1                                                 07110000
WPLROUTC EQU   WPLROUT1                                                 07111000
WPLROUTB EQU   WPLROUT1                                                 07112000
WPLROUTA EQU   WPLROUT1                                                 07113000
WPLRSV12 EQU   WPLDESC2                                                 07114000
WPLRSV11 EQU   WPLDESC2                                                 07115000
WPLRSV10 EQU   WPLDESC2                                                 07116000
WPLRSV09 EQU   WPLDESC2                                                 07117000
WPLRSV08 EQU   WPLDESC2                                                 07118000
WPLRSV07 EQU   WPLDESC2                                                 07119000
WPLDESCJ EQU   WPLDESC2                                                 07120000
WPLDESCI EQU   WPLDESC2                                                 07121000
WPLDESCH EQU   WPLDESC1                                                 07122000
WPLDESCG EQU   WPLDESC1                                                 07123000
WPLDESCF EQU   WPLDESC1                                                 07124000
WPLDESCD EQU   WPLDESC1                                                 07125000
WPLDESCC EQU   WPLDESC1                                                 07126000
WPLDESCB EQU   WPLDESC1                                                 07127000
WPLDESCA EQU   WPLDESC1                                                 07128000
WPLTXTL  EQU   WPLTXT+125                                               07129000
@NM00024 EQU   WPLTXT                                                   07130000
WPLRSV05 EQU   WPLMCSF2                                                 07131000
WPLRSV04 EQU   WPLMCSF2                                                 07132000
WPLMCSFN EQU   WPLMCSF2                                                 07133000
WPLRSV03 EQU   WPLMCSF2                                                 07134000
WPLNOWTP EQU   WPLMCSF2                                                 07135000
WPLMCSFK EQU   WPLMCSF2                                                 07136000
WPLMCSFJ EQU   WPLMCSF2                                                 07137000
WPLMCSFI EQU   WPLMCSF2                                                 07138000
WPLMCSFH EQU   WPLMCSF1                                                 07139000
WPLMCSFG EQU   WPLMCSF1                                                 07140000
WPLMCSFF EQU   WPLMCSF1                                                 07141000
WPLMCSFE EQU   WPLMCSF1                                                 07142000
WPLMCSFD EQU   WPLMCSF1                                                 07143000
WPLRECB  EQU   WPLRF+4                                                  07144000
WPLRPTRA EQU   WPLRPTR+1                                                07145000
WPLRLN   EQU   WPLRPTR                                                  07146000
SMF22FSI EQU   SMF22VOF+3                                               07147000
SMF22RVB EQU   SMF22VOF+2                                               07148000
SMF22FID EQU   SMF22VOF+1                                               07149000
SMF22RV6 EQU   SMF22VOF                                                 07150000
SMF22NSI EQU   SMF22VON+3                                               07151000
SMF22RVA EQU   SMF22VON+2                                               07152000
SMF22NID EQU   SMF22VON+1                                               07153000
SMF22RV5 EQU   SMF22VON                                                 07154000
SMF22ION EQU   SMF22IPL+2                                               07155000
SMF22IID EQU   SMF22IPL+1                                               07156000
SMF22RV4 EQU   SMF22IPL                                                 07157000
SMF22RV3 EQU   SMF22STR                                                 07158000
SMF22CPD EQU   SMF22CHL+5                                               07159000
SMF22CHA EQU   SMF22CHL+4                                               07160000
SMF22CHN EQU   SMF22CHL+2                                               07161000
SMF22CID EQU   SMF22CHL+1                                               07162000
SMF22RV2 EQU   SMF22CHL                                                 07163000
SMF22CPA EQU   SMF22CPU+5                                               07164000
SMF22RV1 EQU   SMF22CPU+4                                               07165000
SMF22CPN EQU   SMF22CPU+2                                               07166000
SMF22PID EQU   SMF22CPU+1                                               07167000
SMF22RV0 EQU   SMF22CPU                                                 07168000
SMF22SID EQU   SMFRCD22+14                                              07169000
SMF22DTE EQU   SMFRCD22+10                                              07170000
SMF22TME EQU   SMFRCD22+6                                               07171000
SMF22FLG EQU   SMFRCD22+4                                               07172000
SMF22SEG EQU   SMFRCD22+2                                               07173000
UCMPRSV2 EQU   UCMPEXTA+20                                              07174000
UCMPRSV1 EQU   UCMPDM1+8                                                07175000
UCMPNMCC EQU   UCMPDM1+4                                                07176000
UCMPWQE  EQU   UCMPDM1                                                  07177000
UCMPUCMP EQU   UCMPEXTA                                                 07178000
UCMFRSV3 EQU   UCMFEXTA+20                                              07179000
UCMF80WQ EQU   UCMFEXTA+18                                              07180000
UCMF60WQ EQU   UCMFEXTA+16                                              07181000
UCMFRSV2 EQU   UCMFMGFS+4                                               07182000
UCMFRSV1 EQU   UCMFMGFS+2                                               07183000
UCMFFLG2 EQU   UCMFMGFS+1                                               07184000
UCMFBR07 EQU   UCMFFLG1                                                 07185000
UCMFBR06 EQU   UCMFFLG1                                                 07186000
UCMFBR05 EQU   UCMFFLG1                                                 07187000
UCMFBR04 EQU   UCMFFLG1                                                 07188000
UCMFBR03 EQU   UCMFFLG1                                                 07189000
UCMFMSGN EQU   UCMFFLG1                                                 07190000
UCMFMSGA EQU   UCMFFLG1                                                 07191000
UCMFMSGE EQU   UCMFFLG1                                                 07192000
UCMFPPTR EQU   UCMFEXTA+4                                               07193000
UCMFUCMF EQU   UCMFEXTA                                                 07194000
UCMRCTA  EQU   UCMRCT+1                                                 07195000
UCMRSV31 EQU   UCMSDS5                                                  07196000
UCMSDS5G EQU   UCMSDS5                                                  07197000
UCMSDS5F EQU   UCMSDS5                                                  07198000
UCMRSV30 EQU   UCMSDS5                                                  07199000
UCMRSV29 EQU   UCMSDS5                                                  07200000
UCMSDS5C EQU   UCMSDS5                                                  07201000
UCMSDS5B EQU   UCMSDS5                                                  07202000
UCMSDS5A EQU   UCMSDS5                                                  07203000
UCMMLAST EQU   UCMLIST+64                                               07204000
UCMVHRSN EQU   UCMDEVC                                                  07205000
UCMDEVG  EQU   UCMDEVC                                                  07206000
UCMDEVF  EQU   UCMDEVC                                                  07207000
UCMDEVE  EQU   UCMDEVC                                                  07208000
UCMDEVD  EQU   UCMDEVC                                                  07209000
UCMDEVCC EQU   UCMDEVC                                                  07210000
UCMDEVB  EQU   UCMDEVC                                                  07211000
UCMDEVA  EQU   UCMDEVC                                                  07212000
UCMXOR   EQU   UCMLIST+62                                               07213000
UCMMSG2  EQU   UCMMSG+1                                                 07214000
UCMRSV27 EQU   UCMMSG1                                                  07215000
UCMRSV26 EQU   UCMMSG1                                                  07216000
UCMMSGF  EQU   UCMMSG1                                                  07217000
UCMMSGE  EQU   UCMMSG1                                                  07218000
UCMMSGD  EQU   UCMMSG1                                                  07219000
UCMMSGC  EQU   UCMMSG1                                                  07220000
UCMMSGB  EQU   UCMMSG1                                                  07221000
UCMMSGA  EQU   UCMMSG1                                                  07222000
UCMCOMPC EQU   UCMLIST+56                                               07223000
UCMWLAST EQU   UCMLIST+52                                               07224000
UCMOAOEN EQU   UCMLIST+48                                               07225000
UCMALTEN EQU   UCMLIST+44                                               07226000
UCMRV007 EQU   UCMDISP2                                                 07227000
UCMRV006 EQU   UCMDISP2                                                 07228000
UCMRV005 EQU   UCMDISP2                                                 07229000
UCMRV004 EQU   UCMDISP2                                                 07230000
UCMRV003 EQU   UCMDISP2                                                 07231000
UCMDISPK EQU   UCMDISP2                                                 07232000
UCMDISPJ EQU   UCMDISP2                                                 07233000
UCMDISPI EQU   UCMDISP2                                                 07234000
UCMDISPH EQU   UCMDISP1                                                 07235000
UCMDISPG EQU   UCMDISP1                                                 07236000
UCMDISPF EQU   UCMDISP1                                                 07237000
UCMDISPE EQU   UCMDISP1                                                 07238000
UCMDISPD EQU   UCMDISP1                                                 07239000
UCMDISPC EQU   UCMDISP1                                                 07240000
UCMDISPB EQU   UCMDISP1                                                 07241000
UCMDISPA EQU   UCMDISP1                                                 07242000
UCMAUTHB EQU   UCMAUTH+1                                                07243000
UCMRSV23 EQU   UCMAUTHA                                                 07244000
UCMRSV22 EQU   UCMAUTHA                                                 07245000
UCMRSV21 EQU   UCMAUTHA                                                 07246000
UCMRSV20 EQU   UCMAUTHA                                                 07247000
UCMRSV19 EQU   UCMAUTHA                                                 07248000
UCMAUTH3 EQU   UCMAUTHA                                                 07249000
UCMAUTH2 EQU   UCMAUTHA                                                 07250000
UCMAUTH1 EQU   UCMAUTHA                                                 07251000
UCMOUTQ  EQU   UCMLIST+36                                               07252000
UCMRSV18 EQU   UCMLIST+34                                               07253000
UCMRTCD  EQU   UCMLIST+32                                               07254000
UCMXB    EQU   UCMLIST+28                                               07255000
@NM00023 EQU   UCMXA+1                                                  07256000
UCMRSV17 EQU   UCMATR                                                   07257000
UCMRSV16 EQU   UCMATR                                                   07258000
UCMAT04  EQU   UCMATR                                                   07259000
UCMLF    EQU   UCMATR                                                   07260000
UCMUF    EQU   UCMATR                                                   07261000
UCMXF    EQU   UCMATR                                                   07262000
UCMIF    EQU   UCMATR                                                   07263000
UCMOF    EQU   UCMATR                                                   07264000
UCMTC    EQU   UCMSTS                                                   07265000
UCMTD    EQU   UCMSTS                                                   07266000
UCMTB    EQU   UCMSTS                                                   07267000
UCMTA    EQU   UCMSTS                                                   07268000
UCMCF    EQU   UCMSTS                                                   07269000
UCMBF    EQU   UCMSTS                                                   07270000
UCMPF    EQU   UCMSTS                                                   07271000
UCMAF    EQU   UCMSTS                                                   07272000
UCMNAME  EQU   UCMLIST+16                                               07273000
UCMUCB   EQU   UCMLIST+12                                               07274000
UCMDCB   EQU   UCMLIST+8                                                07275000
UCMSBR   EQU   UCMLIST+4                                                07276000
UCMECB   EQU   UCMLIST                                                  07277000
UCMTPSAV EQU   UCMEXIT+208                                              07278000
UCMXTSAV EQU   UCMEXIT+136                                              07279000
UCMDESCD EQU   UCMEXIT+132                                              07280000
UCMROUTC EQU   UCMEXIT+128                                              07281000
UCMMSTXT EQU   UCMEXIT                                                  07282000
UCMDECBA EQU   UCMEIL+20                                                07283000
UCMOECBA EQU   UCMEIL+16                                                07284000
UCMAECBA EQU   UCMEIL+12                                                07285000
UCMXECBA EQU   UCMEIL+8                                                 07286000
UCMNIPTR EQU   UCMEIL+4                                                 07287000
UCMRSV15 EQU   UCMEIL+3                                                 07288000
UCMRTCT  EQU   UCMEIL+2                                                 07289000
UCMRPYL  EQU   UCMEIL+1                                                 07290000
@NM00022 EQU   UCMEIL                                                   07291000
UCMRSV60 EQU   UCM+302                                                  07292000
UCMRSV59 EQU   UCMRSV51                                                 07293000
UCMRSV58 EQU   UCMRSV51                                                 07294000
UCMRSV57 EQU   UCMRSV51                                                 07295000
UCMRSV56 EQU   UCMRSV51                                                 07296000
UCMRSV55 EQU   UCMRSV51                                                 07297000
UCMRSV54 EQU   UCMRSV51                                                 07298000
UCMRSV53 EQU   UCMRSV51                                                 07299000
UCMRSV52 EQU   UCMRSV51                                                 07300000
UCMRSV50 EQU   UCMRSV42                                                 07301000
UCMRSV49 EQU   UCMRSV42                                                 07302000
UCMRSV48 EQU   UCMRSV42                                                 07303000
UCMRSV47 EQU   UCMRSV42                                                 07304000
UCMRSV46 EQU   UCMRSV42                                                 07305000
UCMRSV45 EQU   UCMRSV42                                                 07306000
UCMRSV44 EQU   UCMRSV42                                                 07307000
UCMRSV43 EQU   UCMRSV42                                                 07308000
UCMJES3T EQU   UCM+296                                                  07309000
UCMWAKUP EQU   UCM+292                                                  07310000
UCMFRRAD EQU   UCM+288                                                  07311000
UCMSWCH  EQU   UCM+284                                                  07312000
UCMASCB  EQU   UCM+280                                                  07313000
UCMWQECP EQU   UCM+276                                                  07314000
UCMORECP EQU   UCM+272                                                  07315000
UCMOECBT EQU   UCM+268                                                  07316000
UCMOECBH EQU   UCM+264                                                  07317000
UCMWECBT EQU   UCM+260                                                  07318000
UCMWECBH EQU   UCM+256                                                  07319000
UCMMBEND EQU   UCM+252                                                  07320000
UCMCTID  EQU   UCM+250                                                  07321000
UCMRSV61 EQU   UCM+248                                                  07322000
UCMRP2AD EQU   UCM+244                                                  07323000
UCMCRAAD EQU   UCM+240                                                  07324000
UCMWQLM1 EQU   UCM+238                                                  07325000
UCMRV001 EQU   UCM+237                                                  07326000
UCMRQLM1 EQU   UCM+236                                                  07327000
UCMMBPTR EQU   UCM+232                                                  07328000
UCMMQNXT EQU   UCM+228                                                  07329000
UCMMQEND EQU   UCM+224                                                  07330000
UCMMQPTR EQU   UCM+220                                                  07331000
UCMTRECB EQU   UCM+216                                                  07332000
UCMMNECB EQU   UCM+212                                                  07333000
UCMMNTR  EQU   UCM+208                                                  07334000
UCMR9SV  EQU   UCM+204                                                  07335000
UCMSAVE4 EQU   UCM+140                                                  07336000
UCMSAVE3 EQU   UCM+84                                                   07337000
UCMVEL   EQU   UCMVDATA+8                                               07338000
UCMVEZ   EQU   UCMVDATA+4                                               07339000
UCMVEA   EQU   UCMVDATA                                                 07340000
UCMINCR  EQU   UCM+71                                                   07341000
UCMMODEL EQU   UCM+70                                                   07342000
UCMCORE  EQU   UCM+69                                                   07343000
UCMFIX   EQU   UCMMODE                                                  07344000
UCMMCS   EQU   UCMMODE                                                  07345000
UCMOGCE  EQU   UCMMODE                                                  07346000
UCMAMFA  EQU   UCMMODE                                                  07347000
UCMRSV14 EQU   UCMMODE                                                  07348000
UCMTPUTA EQU   UCMMODE                                                  07349000
UCMNOCON EQU   UCMMODE                                                  07350000
UCMRSV11 EQU   UCMMODE                                                  07351000
UCMPXA   EQU   UCM+64                                                   07352000
UCMWQEND EQU   UCM+60                                                   07353000
UCMWQNR  EQU   UCM+58                                                   07354000
UCMRQNR  EQU   UCM+56                                                   07355000
UCMWQECB EQU   UCM+52                                                   07356000
UCMRQECB EQU   UCM+48                                                   07357000
UCMWQLM  EQU   UCM+46                                                   07358000
UCMRQLM  EQU   UCM+45                                                   07359000
@NM00021 EQU   UCMRPYI                                                  07360000
UCMRPYQ  EQU   UCM+28                                                   07361000
UCMWTOQ  EQU   UCM+24                                                   07362000
UCMLSTP  EQU   UCM+20                                                   07363000
UCMARECB EQU   UCM+16                                                   07364000
UCMLECB  EQU   UCMDECB                                                  07365000
UCMOECB  EQU   UCM+8                                                    07366000
UCMAECB  EQU   UCM+4                                                    07367000
UCMXECB  EQU   UCM                                                      07368000
UCMGMCNT EQU   UCMPRFX+158                                              07369000
UCMSDS2  EQU   UCMPRFX+157                                              07370000
UCMRSV09 EQU   UCMSDS1                                                  07371000
UCMRSV08 EQU   UCMSDS1                                                  07372000
UCMRSV07 EQU   UCMSDS1                                                  07373000
UCMRSV06 EQU   UCMSDS1                                                  07374000
UCMRSV05 EQU   UCMSDS1                                                  07375000
UCMRSV04 EQU   UCMSDS1                                                  07376000
UCMSDS1B EQU   UCMSDS1                                                  07377000
UCMSDS1A EQU   UCMSDS1                                                  07378000
UCMDTINT EQU   UCMPRFX+152                                              07379000
UCMLOGAD EQU   UCMPRFX+148                                              07380000
UCMNPECB EQU   UCMPRFX+144                                              07381000
UCMTPPTR EQU   UCMPRFX+140                                              07382000
UCMDOMRT EQU   UCMPRFX+136                                              07383000
UCMRUTCK EQU   UCMPRFX+132                                              07384000
UCMQRTN  EQU   UCMPRFX+128                                              07385000
UCM6WD   EQU   UCMXSA+20                                                07386000
UCM5WD   EQU   UCMXSA+16                                                07387000
UCM4WD   EQU   UCMXSA+12                                                07388000
UCM3WD   EQU   UCMXSA+8                                                 07389000
UCM2WD   EQU   UCMXSA+4                                                 07390000
UCM1WD   EQU   UCMXSA                                                   07391000
UCMRSV03 EQU   UCMPRFX+102                                              07392000
UCMHRDRT EQU   UCMPRFX+100                                              07393000
UCMUEXIT EQU   UCMPRFX+97                                               07394000
UCMXCT   EQU   UCMPRFX+96                                               07395000
UCMHCUCM EQU   UCMPRFX+92                                               07396000
UCMCMID  EQU   UCMPRFX+88                                               07397000
UCMOWTOR EQU   UCMPRFX+86                                               07398000
UCMRSV02 EQU   UCMSFLG2                                                 07399000
UCMSYSO  EQU   UCMSFLG2                                                 07400000
UCMSYSN  EQU   UCMSFLG2                                                 07401000
UCMSYSM  EQU   UCMSFLG2                                                 07402000
UCMSYSL  EQU   UCMSFLG2                                                 07403000
UCMSYSK  EQU   UCMSFLG2                                                 07404000
UCMSYSJ  EQU   UCMSFLG2                                                 07405000
UCMSYSI  EQU   UCMSFLG2                                                 07406000
UCMRSV35 EQU   UCMSFLG1                                                 07407000
UCMSYSG  EQU   UCMSFLG1                                                 07408000
UCMSYSF  EQU   UCMSFLG1                                                 07409000
UCMSYSE  EQU   UCMSFLG1                                                 07410000
UCMSYSD  EQU   UCMSFLG1                                                 07411000
UCMSYSC  EQU   UCMSFLG1                                                 07412000
UCMSYSB  EQU   UCMSFLG1                                                 07413000
UCMRSV01 EQU   UCMSFLG1                                                 07414000
UCMWTOX  EQU   UCMPRFX+80                                               07415000
UCMDOME  EQU   UCMPRFX+76                                               07416000
UCMSVR0  EQU   UCMSAVE0+68                                              07417000
UCMSVQ0  EQU   UCMSAVE0+64                                              07418000
UCMSVP0  EQU   UCMSAVE0+60                                              07419000
UCMSVO0  EQU   UCMSAVE0+56                                              07420000
UCMSVN0  EQU   UCMSAVE0+52                                              07421000
UCMSVM0  EQU   UCMSAVE0+48                                              07422000
UCMSVL0  EQU   UCMSAVE0+44                                              07423000
UCMSVK0  EQU   UCMSAVE0+40                                              07424000
UCMSVJ0  EQU   UCMSAVE0+36                                              07425000
UCMSVI0  EQU   UCMSAVE0+32                                              07426000
UCMSVH0  EQU   UCMSAVE0+28                                              07427000
UCMSVG0  EQU   UCMSAVE0+24                                              07428000
UCMSVF0  EQU   UCMSAVE0+20                                              07429000
UCMSVE0  EQU   UCMSAVE0+16                                              07430000
UCMSVD0  EQU   UCMSAVE0+12                                              07431000
UCMSVC0  EQU   UCMSAVE0+8                                               07432000
UCMSVB0  EQU   UCMSAVE0+4                                               07433000
UCMSVA0  EQU   UCMSAVE0                                                 07434000
UCM2FEXT EQU   UCM2EXT+12                                               07435000
UCM2STAA EQU   UCM2STA+1                                                07436000
UCMRV008 EQU   UCM2SFLG                                                 07437000
UCMRSV34 EQU   UCM2SFLG                                                 07438000
UCMRSV33 EQU   UCM2SFLG                                                 07439000
UCMRSV32 EQU   UCM2SFLG                                                 07440000
UCM2DSTR EQU   UCM2SFLG                                                 07441000
UCM2DTAK EQU   UCM2SFLG                                                 07442000
UCM2SENT EQU   UCM2SFLG                                                 07443000
UCM2SDWA EQU   UCM2SFLG                                                 07444000
UCM2PST  EQU   UCM2EXT+4                                                07445000
UCM2RID  EQU   UCM2EXT+2                                                07446000
UCM2WID  EQU   UCM2EXT                                                  07447000
CHARSV16 EQU   CHSHORT+100                                              07448000
CHARSV15 EQU   CHSHORT+96                                               07449000
CHJSCBVS EQU   CHSHORT+92                                               07450000
CHUSCVS  EQU   CHSHORT+88                                               07451000
@NM00019 EQU   CHSHORT+84                                               07452000
@NM00018 EQU   CHSHORT+80                                               07453000
CHSQA    EQU   CHSHORT+44                                               07454000
CHQPA    EQU   CHSHORT+8                                                07455000
CHJCL    EQU   CHSHORT+4                                                07456000
CHSPC    EQU   CHSHORT                                                  07457000
CHSPB    EQU   CHSTEP+4                                                 07458000
CHTCB    EQU   CHSTEP+1                                                 07459000
CHARSV23 EQU   CHSWT                                                    07460000
CHARSV22 EQU   CHSWT                                                    07461000
CHARSV21 EQU   CHSWT                                                    07462000
CHAC     EQU   CHSWT                                                    07463000
CHPSF    EQU   CHSWT                                                    07464000
CHPSD    EQU   CHSWT                                                    07465000
CHJCT    EQU   CHSWT                                                    07466000
CHARSV20 EQU   CHSWT                                                    07467000
CHCECB   EQU   CHASM+20                                                 07468000
CHECB    EQU   CHASM+16                                                 07469000
CHRGNAD  EQU   CHASM+12                                                 07470000
CHARSV18 EQU   CHRGNSZ+1                                                07471000
CHRPRTY  EQU   CHRGNSZ                                                  07472000
@NM00017 EQU   CHCIBP                                                   07473000
CHEND    EQU   CHCIBP                                                   07474000
CHECBP   EQU   CHASM                                                    07475000
CHDER    EQU   CHPROCSN+4                                               07476000
CHARSV10 EQU   CHACT1                                                   07477000
CHARSV09 EQU   CHACT1                                                   07478000
CHARSV08 EQU   CHACT1                                                   07479000
CHARSV07 EQU   CHACT1                                                   07480000
CHARSV06 EQU   CHACT1                                                   07481000
CHARSV05 EQU   CHACT1                                                   07482000
CHARSV04 EQU   CHACT1                                                   07483000
CHRDWTR  EQU   CHACT1                                                   07484000
CHARSV30 EQU   CHPROCSN+2                                               07485000
CHQID    EQU   CHPROCSN                                                 07486000
CHASID   EQU   CHTJID                                                   07487000
CHTRKID  EQU   CHPKE                                                    07488000
CHCIBCTR EQU   CHAIN+27                                                 07489000
CHUNIT   EQU   CHAIN+24                                                 07490000
CHCLS    EQU   CHAIN+16                                                 07491000
CHPCOI   EQU   CHPARM                                                   07492000
CHIFY    EQU   CHACT                                                    07493000
CHAIFX   EQU   CHACT                                                    07494000
CHCLD    EQU   CHACT                                                    07495000
CHCL     EQU   CHACT                                                    07496000
CHDSI    EQU   CHACT                                                    07497000
CHDISC   EQU   CHACT                                                    07498000
CHTERM   EQU   CHACT                                                    07499000
CHSWAP   EQU   CHACT                                                    07500000
CHABTERM EQU   CHSTS                                                    07501000
CHDL     EQU   CHSTS                                                    07502000
CHAD     EQU   CHSTS                                                    07503000
CHQSPC   EQU   CHSTS                                                    07504000
CHSOUT   EQU   CHSTS                                                    07505000
CHSYS    EQU   CHSTS                                                    07506000
CHAP     EQU   CHSTS                                                    07507000
CHSZE    EQU   CHFLG+1                                                  07508000
CHVCD    EQU   CHFLG                                                    07509000
CHPTR    EQU   CHAIN                                                    07510000
CVTLEVL  EQU   CVTRELNO+2                                               07511000
CVTNUMB  EQU   CVTRELNO                                                 07512000
CVTMDL   EQU   CVTFIX+250                                               07513000
@NM00015 EQU   CVTFIX+248                                               07514000
@NM00014 EQU   CVTFIX                                                   07515000
CVTRV482 EQU   CVTXTNT2+128                                             07516000
CVTRV481 EQU   CVTXTNT2+124                                             07517000
CVTRV480 EQU   CVTXTNT2+120                                             07518000
CVTRV479 EQU   CVTXTNT2+118                                             07519000
CVTRV478 EQU   CVTXTNT2+117                                             07520000
CVTRV477 EQU   CVTXTNT2+116                                             07521000
CVTRV476 EQU   CVTXTNT2+115                                             07522000
CVTRV475 EQU   CVTXTNT2+114                                             07523000
CVTRV474 EQU   CVTRV466                                                 07524000
CVTRV473 EQU   CVTRV466                                                 07525000
CVTRV472 EQU   CVTRV466                                                 07526000
CVTRV471 EQU   CVTRV466                                                 07527000
CVTRV470 EQU   CVTRV466                                                 07528000
CVTRV469 EQU   CVTRV466                                                 07529000
CVTRV468 EQU   CVTRV466                                                 07530000
CVTRV467 EQU   CVTRV466                                                 07531000
CVTRV465 EQU   CVTRV457                                                 07532000
CVTRV464 EQU   CVTRV457                                                 07533000
CVTRV463 EQU   CVTRV457                                                 07534000
CVTRV462 EQU   CVTRV457                                                 07535000
CVTRV461 EQU   CVTRV457                                                 07536000
CVTRV460 EQU   CVTRV457                                                 07537000
CVTRV459 EQU   CVTRV457                                                 07538000
CVTRV458 EQU   CVTRV457                                                 07539000
CVTRV456 EQU   CVTXTNT2+108                                             07540000
CVTRV455 EQU   CVTXTNT2+104                                             07541000
CVTRV454 EQU   CVTXTNT2+100                                             07542000
CVTRV453 EQU   CVTXTNT2+96                                              07543000
CVTRV452 EQU   CVTXTNT2+94                                              07544000
CVTRV451 EQU   CVTXTNT2+92                                              07545000
CVTRV450 EQU   CVTXTNT2+90                                              07546000
CVTRV449 EQU   CVTXTNT2+88                                              07547000
CVTRV448 EQU   CVTXTNT2+87                                              07548000
CVTRV447 EQU   CVTXTNT2+86                                              07549000
CVTRV446 EQU   CVTRV438                                                 07550000
CVTRV445 EQU   CVTRV438                                                 07551000
CVTRV444 EQU   CVTRV438                                                 07552000
CVTRV443 EQU   CVTRV438                                                 07553000
CVTRV442 EQU   CVTRV438                                                 07554000
CVTRV441 EQU   CVTRV438                                                 07555000
CVTRV440 EQU   CVTRV438                                                 07556000
CVTRV439 EQU   CVTRV438                                                 07557000
CVTRV437 EQU   CVTRV429                                                 07558000
CVTRV436 EQU   CVTRV429                                                 07559000
CVTRV435 EQU   CVTRV429                                                 07560000
CVTRV434 EQU   CVTRV429                                                 07561000
CVTRV433 EQU   CVTRV429                                                 07562000
CVTRV432 EQU   CVTRV429                                                 07563000
CVTRV431 EQU   CVTRV429                                                 07564000
CVTRV430 EQU   CVTRV429                                                 07565000
CVTRV428 EQU   CVTXTNT2+80                                              07566000
CVTRV427 EQU   CVTXTNT2+76                                              07567000
CVTRV426 EQU   CVTXTNT2+72                                              07568000
CVTRV425 EQU   CVTXTNT2+68                                              07569000
CVTATACT EQU   CVTATCVT                                                 07570000
CVTRV423 EQU   CVTXTNT2+62                                              07571000
CVTRV422 EQU   CVTXTNT2+60                                              07572000
CVTRV421 EQU   CVTXTNT2+58                                              07573000
CVTRV420 EQU   CVTXTNT2+56                                              07574000
CVTRV419 EQU   CVTXTNT2+55                                              07575000
CVTRV418 EQU   CVTXTNT2+54                                              07576000
CVTRV417 EQU   CVTRV409                                                 07577000
CVTRV416 EQU   CVTRV409                                                 07578000
CVTRV415 EQU   CVTRV409                                                 07579000
CVTRV414 EQU   CVTRV409                                                 07580000
CVTRV413 EQU   CVTRV409                                                 07581000
CVTRV412 EQU   CVTRV409                                                 07582000
CVTRV411 EQU   CVTRV409                                                 07583000
CVTRV410 EQU   CVTRV409                                                 07584000
CVTRV408 EQU   CVTRV400                                                 07585000
CVTRV407 EQU   CVTRV400                                                 07586000
CVTRV406 EQU   CVTRV400                                                 07587000
CVTRV405 EQU   CVTRV400                                                 07588000
CVTRV404 EQU   CVTRV400                                                 07589000
CVTRV403 EQU   CVTRV400                                                 07590000
CVTRV402 EQU   CVTRV400                                                 07591000
CVTRV401 EQU   CVTRV400                                                 07592000
CVTICB   EQU   CVTXTNT2+48                                              07593000
CVTSKTA  EQU   CVTXTNT2+44                                              07594000
CVTRSV99 EQU   CVTXTNT2+40                                              07595000
CVTRSV98 EQU   CVTXTNT2+36                                              07596000
CVTRSV97 EQU   CVTXTNT2+34                                              07597000
CVTRSV96 EQU   CVTXTNT2+32                                              07598000
CVTOLTEP EQU   CVTXTNT2+28                                              07599000
CVTQIDA  EQU   CVTQID+1                                                 07600000
CVTRSV95 EQU   CVTQID                                                   07601000
CVTRSV94 EQU   CVTXTNT2+20                                              07602000
CVTRSV93 EQU   CVTXTNT2+16                                              07603000
CVTRSV92 EQU   CVTXTNT2+12                                              07604000
CVTDEBVR EQU   CVTXTNT2+8                                               07605000
CVTRSV91 EQU   CVTXTNT2+6                                               07606000
CVTRSV9H EQU   CVTFLGBT                                                 07607000
CVTRSV9G EQU   CVTFLGBT                                                 07608000
CVTRSV9F EQU   CVTFLGBT                                                 07609000
CVTRSV9E EQU   CVTFLGBT                                                 07610000
CVTRSV9D EQU   CVTFLGBT                                                 07611000
CVTRSV9C EQU   CVTFLGBT                                                 07612000
CVTVME   EQU   CVTFLGBT                                                 07613000
CVTNPE   EQU   CVTFLGBT                                                 07614000
CVTNUCLS EQU   CVTXTNT2+4                                               07615000
CVTDSSVA EQU   CVTDSSV+1                                                07616000
CVTRSV89 EQU   CVTDSSV                                                  07617000
CVTRSV88 EQU   CVTXTNT1+8                                               07618000
CVTRSV87 EQU   CVTXTNT1+4                                               07619000
CVTFACHN EQU   CVTXTNT1                                                 07620000
CVTRV488 EQU   CVTMAP+412                                               07621000
CVTRV487 EQU   CVTMAP+408                                               07622000
CVTRV486 EQU   CVTMAP+404                                               07623000
CVTRV485 EQU   CVTMAP+400                                               07624000
CVTACTAP EQU   CVTMAP+396                                               07625000
CVTAUTH  EQU   CVTMAP+392                                               07626000
CVTATMCA EQU   CVTATMCT+1                                               07627000
CVTATMST EQU   CVTATMCT                                                 07628000
CVTRSV61 EQU   CVTMAP+384                                               07629000
CVTVOLT1 EQU   CVTVOLM1+1                                               07630000
CVTVOLI1 EQU   CVTVOLF1                                                 07631000
CVTSTOA  EQU   CVTMAP+376                                               07632000
CVTRSV58 EQU   CVTMAP+374                                               07633000
CVTRSV57 EQU   CVTMAP+372                                               07634000
CVTDDCE  EQU   CVTMAP+368                                               07635000
CVTPNWFR EQU   CVTMAP+364                                               07636000
CVTSMF   EQU   CVTMAP+360                                               07637000
CVTSULK  EQU   CVTMAP+358                                               07638000
CVTSLKO  EQU   CVTSYSK                                                  07639000
CVTSLKP  EQU   CVTSYSK                                                  07640000
CVTSLKQ  EQU   CVTSYSK                                                  07641000
CVTSLKR  EQU   CVTSYSK                                                  07642000
CVTRSV56 EQU   CVTSYSK                                                  07643000
CVTRSV55 EQU   CVTSYSK                                                  07644000
CVTRSV54 EQU   CVTSYSK                                                  07645000
CVTRSV53 EQU   CVTSYSK                                                  07646000
CVTRSV52 EQU   CVTA1F1                                                  07647000
CVTRSV51 EQU   CVTA1F1                                                  07648000
CVTRSV50 EQU   CVTA1F1                                                  07649000
CVTRSV49 EQU   CVTA1F1                                                  07650000
CVTRSV48 EQU   CVTA1F1                                                  07651000
CVTRSV47 EQU   CVTA1F1                                                  07652000
CVTSRSW  EQU   CVTA1F1                                                  07653000
CVTPFSW  EQU   CVTA1F1                                                  07654000
CVTPCVT  EQU   CVTMAP+352                                               07655000
CVTRSV46 EQU   CVTMAP+344                                               07656000
CVTRSV45 EQU   CVTMAP+340                                               07657000
CVTRSV44 EQU   CVTMAP+338                                               07658000
CVTRSV43 EQU   CVTMAP+336                                               07659000
CVTHJESA EQU   CVTHJES+1                                                07660000
CVTRSV42 EQU   CVTHJES                                                  07661000
CVTEXT2A EQU   CVTEXT2+1                                                07662000
CVTRSV41 EQU   CVTEXT2                                                  07663000
CVTAPFA  EQU   CVTAPF+1                                                 07664000
CVTRSV40 EQU   CVTAPF                                                   07665000
CVTRV518 EQU   CVTINTLA                                                 07666000
CVTRV517 EQU   CVTERPV                                                  07667000
CVTMCHPR EQU   CVTMAP+308                                               07668000
CVTTZ    EQU   CVTMAP+304                                               07669000
CVTJEPS  EQU   CVTMAP+300                                               07670000
CVTJESCT EQU   CVTMAP+296                                               07671000
CVTMODE  EQU   CVTMAP+292                                               07672000
CVTREAL  EQU   CVTMAP+284                                               07673000
CVTRSV39 EQU   CVTMAP+280                                               07674000
CVTRSV38 EQU   CVTMAP+276                                               07675000
CVTDMSRA EQU   CVTDMSR+1                                                07676000
CVTRV634 EQU   CVTDMSRF                                                 07677000
CVTRV633 EQU   CVTDMSRF                                                 07678000
CVTRV632 EQU   CVTDMSRF                                                 07679000
CVTRV631 EQU   CVTDMSRF                                                 07680000
CVTRV630 EQU   CVTDMSRF                                                 07681000
CVTRV629 EQU   CVTDMSRF                                                 07682000
CVTUDUMP EQU   CVTDMSRF                                                 07683000
CVTSDUMP EQU   CVTDMSRF                                                 07684000
CVTQMSGA EQU   CVTQMSG+1                                                07685000
CVTRSV36 EQU   CVTQMSG                                                  07686000
CVTAMFF  EQU   CVTMAP+264                                               07687000
CVTPURGA EQU   CVTPURG+1                                                07688000
CVTRSV35 EQU   CVTPURG                                                  07689000
CVTCBSP  EQU   CVTMAP+256                                               07690000
CVTATERA EQU   CVTATER+1                                                07691000
CVTSYST  EQU   CVTATER                                                  07692000
CVTVOLT2 EQU   CVTTAT                                                   07693000
CVTVOLI2 EQU   CVTVOLF2                                                 07694000
CVTAQAVB EQU   CVTAQAVT+1                                               07695000
CVTRSV34 EQU   CVTTCMFG                                                 07696000
CVTRSV33 EQU   CVTTCMFG                                                 07697000
CVTRSV32 EQU   CVTTCMFG                                                 07698000
CVTRSV31 EQU   CVTTCMFG                                                 07699000
CVTRSV30 EQU   CVTTCMFG                                                 07700000
CVTRSV29 EQU   CVTTCMFG                                                 07701000
CVTLDEV  EQU   CVTTCMFG                                                 07702000
CVTTCRDY EQU   CVTTCMFG                                                 07703000
CVTGTFA  EQU   CVTGTF+1                                                 07704000
CVTRSV27 EQU   CVTGTFST                                                 07705000
CVTRNIO  EQU   CVTGTFST                                                 07706000
CVTUSR   EQU   CVTGTFST                                                 07707000
CVTRV318 EQU   CVTFORM                                                  07708000
CVTRV317 EQU   CVTTMODE                                                 07709000
CVTRV316 EQU   CVTSTATE                                                 07710000
CVTRV315 EQU   CVTGTFS                                                  07711000
CVTGTFAV EQU   CVTGTFS                                                  07712000
CVT0SCR1 EQU   CVTMAP+232                                               07713000
CVTRV515 EQU   CVTMAP+228                                               07714000
CVTRMS   EQU   CVTMAP+224                                               07715000
CVTPATCH EQU   CVTMAP+220                                               07716000
CVTTSCE  EQU   CVTMAP+216                                               07717000
CVTLNKSC EQU   CVTMAP+214                                               07718000
CVTQABST EQU   CVTMAP+212                                               07719000
CVTMDLDS EQU   CVTMAP+208                                               07720000
CVTUSER  EQU   CVTMAP+204                                               07721000
CVTABEND EQU   CVTMAP+200                                               07722000
CVTSMCA  EQU   CVTMAP+196                                               07723000
CVTRSV18 EQU   CVTMAP+192                                               07724000
CVTQLPAQ EQU   CVTMAP+188                                               07725000
CVTQCDSR EQU   CVTMAP+184                                               07726000
CVTRSV17 EQU   CVTOPTB                                                  07727000
CVTRSV16 EQU   CVTOPTB                                                  07728000
CVTFP    EQU   CVTOPTB                                                  07729000
CVTAPTHR EQU   CVTOPTB                                                  07730000
CVTNLOG  EQU   CVTOPTB                                                  07731000
CVTTOD   EQU   CVTOPTB                                                  07732000
CVTCTIMS EQU   CVTOPTB                                                  07733000
CVTPROT  EQU   CVTOPTB                                                  07734000
CVTXPFP  EQU   CVTOPTA                                                  07735000
CVTASCII EQU   CVTOPTA                                                  07736000
CVTRSV13 EQU   CVTOPTA                                                  07737000
CVTRSV12 EQU   CVTOPTA                                                  07738000
CVTNIP   EQU   CVTOPTA                                                  07739000
CVTDDR   EQU   CVTOPTA                                                  07740000
CVTAPR   EQU   CVTOPTA                                                  07741000
CVTCCH   EQU   CVTOPTA                                                  07742000
CVTSNCTR EQU   CVTMAP+180                                               07743000
CVTQMWR  EQU   CVTMAP+176                                               07744000
CVTQOCR  EQU   CVTMAP+172                                               07745000
CVT1EF00 EQU   CVTMAP+168                                               07746000
CVTMZ00  EQU   CVTMAP+164                                               07747000
CVTHEAD  EQU   CVTMAP+160                                               07748000
CVTRSV11 EQU   CVTMAP+156                                               07749000
CVTMSER  EQU   CVTMAP+148                                               07750000
CVTRV516 EQU   CVTIERLC                                                 07751000
CVTILCH  EQU   CVTMAP+140                                               07752000
CVT0DS   EQU   CVTMAP+136                                               07753000
CVTFBOSV EQU   CVTMAP+132                                               07754000
CVTNUCB  EQU   CVTMAP+128                                               07755000
CVTIXAVL EQU   CVTMAP+124                                               07756000
CVTIOQET EQU   CVTMAP+120                                               07757000
CVTDCBA  EQU   CVTMAP+117                                               07758000
CVTMVS2  EQU   CVTDCB                                                   07759000
CVT6DAT  EQU   CVTDCB                                                   07760000
CVT4MPS  EQU   CVTDCB                                                   07761000
CVTRSV09 EQU   CVTDCB                                                   07762000
CVT4MS1  EQU   CVTDCB                                                   07763000
CVT2SPS  EQU   CVTDCB                                                   07764000
CVT1SSS  EQU   CVTDCB                                                   07765000
CVTRSV08 EQU   CVTDCB                                                   07766000
CVTSTB   EQU   CVTMAP+112                                               07767000
CVTQTD00 EQU   CVTMAP+108                                               07768000
CVTQTE00 EQU   CVTMAP+104                                               07769000
CVTSJQ   EQU   CVTMAP+96                                                07770000
CVTPBLDL EQU   CVTMAP+92                                                07771000
CVTTPC   EQU   CVTMAP+88                                                07772000
CVTSVDCB EQU   CVTMAP+84                                                07773000
CVTBRET  EQU   CVTMAP+82                                                07774000
CVTEXIT  EQU   CVTMAP+80                                                07775000
CVT0FN00 EQU   CVTMAP+76                                                07776000
CVTDARA  EQU   CVTDAR+1                                                 07777000
CVTRSV07 EQU   CVTFLGS1                                                 07778000
CVTRSV06 EQU   CVTFLGS1                                                 07779000
CVTRSV05 EQU   CVTFLGS1                                                 07780000
CVTRSV04 EQU   CVTFLGS1                                                 07781000
CVTRSV03 EQU   CVTFLGS1                                                 07782000
CVTRSV02 EQU   CVTFLGS1                                                 07783000
CVTRSV01 EQU   CVTFLGS1                                                 07784000
CVTDMPLK EQU   CVTFLGS1                                                 07785000
CVTXITP  EQU   CVTMAP+68                                                07786000
CVTZDTAB EQU   CVTMAP+64                                                07787000
CVTMSLT  EQU   CVTMAP+60                                                07788000
CVTDATE  EQU   CVTMAP+56                                                07789000
CVTBTERM EQU   CVTMAP+52                                                07790000
CVTSYSAD EQU   CVTMAP+48                                                07791000
CVTXTLER EQU   CVTMAP+44                                                07792000
CVTILK2  EQU   CVTMAP+40                                                07793000
CVTILK1  EQU   CVTMAP+36                                                07794000
CVTPRLTV EQU   CVTMAP+32                                                07795000
CVTPCNVT EQU   CVTMAP+28                                                07796000
CVT0VL00 EQU   CVTMAP+24                                                07797000
CVTXAPG  EQU   CVTMAP+20                                                07798000
CVTBUF   EQU   CVTMAP+16                                                07799000
CVTJOB   EQU   CVTMAP+12                                                07800000
CVTLINK  EQU   CVTMAP+8                                                 07801000
CVT0EF00 EQU   CVTMAP+4                                                 07802000
CVT      EQU   CVTMAP                                                   07803000
PFIXED   EQU   RSRSTAT2                                                 07804000
PINLSQA  EQU   RSRSTAT2                                                 07805000
PINSQA   EQU   RSRSTAT2                                                 07806000
@NM00010 EQU   RSRSTAT2                                                 07807000
RSRWAIT  EQU   RSRECBB                                                  07808000
@NM00009 EQU   RSRPARML+6                                               07809000
@NM00008 EQU   RSRPARML+5                                               07810000
@NM00007 EQU   RSROPTNS                                                 07811000
@NM00006 EQU   RSROPTNS                                                 07812000
@NM00005 EQU   RSROPTNS                                                 07813000
@NM00004 EQU   RSROPTNS                                                 07814000
@NM00104 EQU   PSA+3668                                                 07815000
PSASTAK  EQU   PSA+3072                                                 07816000
@NM00103 EQU   PSA+1048                                                 07817000
PSAUSEND EQU   PSA+1048                                                 07818000
PSARV062 EQU   PSA+1044                                                 07819000
PSACDAL  EQU   PSA+1040                                                 07820000
PSAWTCOD EQU   PSA+1036                                                 07821000
PSAATCVT EQU   PSA+1032                                                 07822000
PSAPCPSW EQU   PSA+1024                                                 07823000
PSAPIR2  EQU   PSA+1020                                                 07824000
PSARV059 EQU   PSA+1018                                                 07825000
PSASVC13 EQU   PSA+1016                                                 07826000
PSALSFCC EQU   PSA+1012                                                 07827000
PSASFACC EQU   PSA+1008                                                 07828000
PSASTOP  EQU   PSA+992                                                  07829000
PSASTART EQU   PSA+976                                                  07830000
PSARSPSW EQU   PSA+968                                                  07831000
PSASRPSW EQU   PSA+960                                                  07832000
PSARV045 EQU   PSA+892                                                  07833000
PSARV044 EQU   PSA+888                                                  07834000
PSARV043 EQU   PSA+884                                                  07835000
PSARV042 EQU   PSA+880                                                  07836000
PSARV041 EQU   PSA+876                                                  07837000
PSARV040 EQU   PSA+872                                                  07838000
PSARV025 EQU   PSA+868                                                  07839000
PSADSSED EQU   PSA+868                                                  07840000
PSADSSPR EQU   PSA+864                                                  07841000
PSADSSFW EQU   PSA+860                                                  07842000
PSADSS14 EQU   PSA+856                                                  07843000
PSADSSPP EQU   PSA+848                                                  07844000
PSADSSRP EQU   PSA+840                                                  07845000
PSADSS05 EQU   PSADSSF4                                                 07846000
PSADSS10 EQU   PSADSSF4                                                 07847000
PSADSSVE EQU   PSADSSF4                                                 07848000
PSADSSDE EQU   PSADSSF4                                                 07849000
PSADSSC0 EQU   PSADSSF4                                                 07850000
PSADSSIE EQU   PSADSSF4                                                 07851000
PSADSS12 EQU   PSADSSF4                                                 07852000
PSADSSRC EQU   PSADSSF4                                                 07853000
PSARV057 EQU   PSADSSF3                                                 07854000
PSARV056 EQU   PSADSSF3                                                 07855000
PSARV055 EQU   PSADSSF3                                                 07856000
PSADSSMC EQU   PSADSSF3                                                 07857000
PSADSSRW EQU   PSADSSF3                                                 07858000
PSADSSNM EQU   PSADSSF3                                                 07859000
PSADSSES EQU   PSADSSF3                                                 07860000
PSADSSGP EQU   PSADSSF3                                                 07861000
PSADSSF2 EQU   PSADSSFL+1                                               07862000
PSADSSPI EQU   PSADSSF1                                                 07863000
PSADSSOI EQU   PSADSSF1                                                 07864000
PSADSSSP EQU   PSADSSF1                                                 07865000
PSADSSTP EQU   PSADSSF1                                                 07866000
PSADSSDW EQU   PSADSSF1                                                 07867000
PSADSSDD EQU   PSADSSF1                                                 07868000
PSADSSDM EQU   PSADSSF1                                                 07869000
PSADSSMV EQU   PSADSSF1                                                 07870000
PSADSSTS EQU   PSA+816                                                  07871000
PSADSSWK EQU   PSA+812                                                  07872000
PSADSSR3 EQU   PSA+808                                                  07873000
PSADSSR2 EQU   PSA+804                                                  07874000
PSADSSRS EQU   PSA+800                                                  07875000
PSASTOR  EQU   PSA+796                                                  07876000
PSACPUSA EQU   PSA+794                                                  07877000
PSAVSTAP EQU   PSA+792                                                  07878000
PSAWKVAP EQU   PSA+788                                                  07879000
PSAWKRAP EQU   PSA+784                                                  07880000
PSAMCHIC EQU   PSA+783                                                  07881000
PSARV061 EQU   PSA+782                                                  07882000
PSASYMSK EQU   PSA+781                                                  07883000
PSAMCHFL EQU   PSA+780                                                  07884000
PSACR0   EQU   PSA+776                                                  07885000
PSAPSWSV EQU   PSA+768                                                  07886000
PSACLHS  EQU   PSAHLHI                                                  07887000
PSALKR15 EQU   PSALKSA+60                                               07888000
PSALKR14 EQU   PSALKSA+56                                               07889000
PSALKR13 EQU   PSALKSA+52                                               07890000
PSALKR12 EQU   PSALKSA+48                                               07891000
PSALKR11 EQU   PSALKSA+44                                               07892000
PSALKR10 EQU   PSALKSA+40                                               07893000
PSALKR9  EQU   PSALKSA+36                                               07894000
PSALKR8  EQU   PSALKSA+32                                               07895000
PSALKR7  EQU   PSALKSA+28                                               07896000
PSALKR6  EQU   PSALKSA+24                                               07897000
PSALKR5  EQU   PSALKSA+20                                               07898000
PSALKR4  EQU   PSALKSA+16                                               07899000
PSALKR3  EQU   PSALKSA+12                                               07900000
PSALKR2  EQU   PSALKSA+8                                                07901000
PSALKR1  EQU   PSALKSA+4                                                07902000
PSALKR0  EQU   PSALKSA                                                  07903000
PSARV023 EQU   PSACLHT+52                                               07904000
PSALOCAL EQU   PSACLHT+48                                               07905000
PSACMSL  EQU   PSACLHT+44                                               07906000
PSAOPTL  EQU   PSACLHT+40                                               07907000
PSATPACL EQU   PSACLHT+36                                               07908000
PSATPDNL EQU   PSACLHT+32                                               07909000
PSATPNCL EQU   PSACLHT+28                                               07910000
PSAIOSLL EQU   PSACLHT+24                                               07911000
PSAIOSUL EQU   PSACLHT+20                                               07912000
PSAIOSCL EQU   PSACLHT+16                                               07913000
PSAIOSSL EQU   PSACLHT+12                                               07914000
PSASALCL EQU   PSACLHT+8                                                07915000
PSAASML  EQU   PSACLHT+4                                                07916000
PSADISPL EQU   PSACLHT                                                  07917000
PSASRSA  EQU   PSA+636                                                  07918000
PSARV050 EQU   PSA+634                                                  07919000
PSADSSGO EQU   PSA+633                                                  07920000
PSARECUR EQU   PSA+632                                                  07921000
PSAHLHIS EQU   PSA+628                                                  07922000
PSAIPCSA EQU   PSA+624                                                  07923000
@NM00102 EQU   PSA+621                                                  07924000
PSAIPCDM EQU   PSA+620                                                  07925000
PSAIPCD  EQU   PSA+616                                                  07926000
@NM00101 EQU   PSA+613                                                  07927000
PSAIPCRM EQU   PSA+612                                                  07928000
PSAIPCR  EQU   PSA+608                                                  07929000
PSAMCHEX EQU   PSA+600                                                  07930000
PSAMPSW  EQU   PSA+592                                                  07931000
PSAEXPS2 EQU   PSA+584                                                  07932000
PSAEXPS1 EQU   PSA+576                                                  07933000
PSAPIREG EQU   PSA+572                                                  07934000
PSARSREG EQU   PSA+568                                                  07935000
PSAGPREG EQU   PSA+556                                                  07936000
PSARV022 EQU   PSASUP4                                                  07937000
PSARV021 EQU   PSASUP4                                                  07938000
PSARV020 EQU   PSASUP4                                                  07939000
PSARV019 EQU   PSASUP4                                                  07940000
PSARV018 EQU   PSASUP4                                                  07941000
PSARV017 EQU   PSASUP4                                                  07942000
PSARV016 EQU   PSASUP4                                                  07943000
PSARV015 EQU   PSASUP4                                                  07944000
PSARV014 EQU   PSASUP3                                                  07945000
PSARV013 EQU   PSASUP3                                                  07946000
PSARV012 EQU   PSASUP3                                                  07947000
PSAESTA  EQU   PSASUP3                                                  07948000
PSASPR   EQU   PSASUP3                                                  07949000
PSAPSREG EQU   PSASUP3                                                  07950000
PSAPI2   EQU   PSASUP3                                                  07951000
PSAIOSUP EQU   PSASUP3                                                  07952000
PSALCR   EQU   PSASUP2                                                  07953000
PSARTM   EQU   PSASUP2                                                  07954000
PSAACR   EQU   PSASUP2                                                  07955000
PSAIPCE2 EQU   PSASUP2                                                  07956000
PSAIPCES EQU   PSASUP2                                                  07957000
PSAIPCEC EQU   PSASUP2                                                  07958000
PSAGTF   EQU   PSASUP2                                                  07959000
PSAIPCRI EQU   PSASUP2                                                  07960000
PSATYPE6 EQU   PSASUP1                                                  07961000
PSATCTL  EQU   PSASUP1                                                  07962000
PSADISP  EQU   PSASUP1                                                  07963000
PSALOCK  EQU   PSASUP1                                                  07964000
PSAPI    EQU   PSASUP1                                                  07965000
PSAEXT   EQU   PSASUP1                                                  07966000
PSASVC   EQU   PSASUP1                                                  07967000
PSAIO    EQU   PSASUP1                                                  07968000
PSAAOLD  EQU   PSA+548                                                  07969000
PSAANEW  EQU   PSA+544                                                  07970000
PSATOLD  EQU   PSA+540                                                  07971000
PSATNEW  EQU   PSA+536                                                  07972000
PSALCCAR EQU   PSA+532                                                  07973000
PSALCCAV EQU   PSA+528                                                  07974000
PSAPCCAR EQU   PSA+524                                                  07975000
PSAPCCAV EQU   PSA+520                                                  07976000
PSACPULA EQU   PSA+518                                                  07977000
PSACPUPA EQU   PSA+516                                                  07978000
PSAPSA   EQU   PSA+512                                                  07979000
FLCHDEND EQU   PSA+512                                                  07980000
FLCCRSAV EQU   FLCMCLA+280                                              07981000
FLCGRSAV EQU   FLCMCLA+216                                              07982000
FLCFPSAV EQU   FLCMCLA+184                                              07983000
FLCFLA   EQU   FLCMCLA+88                                               07984000
FLCRGNCD EQU   FLCMCLA+84                                               07985000
FLCFSAA  EQU   FLCFSA+1                                                 07986000
@NM00100 EQU   FLCFSA                                                   07987000
@NM00099 EQU   FLCMCLA+72                                               07988000
FLCMCIC  EQU   FLCMCLA+64                                               07989000
@NM00098 EQU   FLCMCLA+20                                               07990000
FLCIOAA  EQU   FLCIOA+1                                                 07991000
@NM00097 EQU   FLCIOA                                                   07992000
@NM00096 EQU   FLCMCLA+15                                               07993000
@NM00095 EQU   FLCMCLA+14                                               07994000
@NM00094 EQU   FLCMCLA+12                                               07995000
FLCLCL   EQU   FLCMCLA+8                                                07996000
FLCIOELA EQU   FLCIOEL+1                                                07997000
@NM00093 EQU   FLCIOEL                                                  07998000
FLCCHNID EQU   FLCMCLA                                                  07999000
@NM00092 EQU   PSA+160                                                  08000000
FLCMTRCD EQU   PSA+157                                                  08001000
@NM00091 EQU   PSA+156                                                  08002000
FLCPERA  EQU   FLCPER+1                                                 08003000
@NM00090 EQU   FLCPER                                                   08004000
@NM00089 EQU   PSA+151                                                  08005000
FLCPERCD EQU   PSA+150                                                  08006000
FLCMCNUM EQU   PSA+149                                                  08007000
@NM00088 EQU   PSA+148                                                  08008000
FLCTEAA  EQU   FLCTEA+1                                                 08009000
@NM00087 EQU   FLCTEA                                                   08010000
PSAPIPC  EQU   PSAPICOD                                                 08011000
PSAPIMC  EQU   PSAPICOD                                                 08012000
PSAPIPER EQU   PSAPICOD                                                 08013000
PSARV049 EQU   FLCPICOD                                                 08014000
FLCPILCB EQU   FLCPIILC                                                 08015000
@NM00086 EQU   FLCPIILC                                                 08016000
@NM00085 EQU   PSAEPPSW                                                 08017000
FLCSVCN  EQU   PSAESPSW+2                                               08018000
FLCSILCB EQU   FLCSVILC                                                 08019000
@NM00084 EQU   FLCSVILC                                                 08020000
@NM00083 EQU   PSAESPSW                                                 08021000
FLCEICOD EQU   PSAEEPSW+2                                               08022000
PSASPAD  EQU   PSAEEPSW                                                 08023000
@NM00082 EQU   PSA+128                                                  08024000
FLCINPSW EQU   PSA+120                                                  08025000
FLCMNPSW EQU   PSA+112                                                  08026000
FLCPNPSW EQU   PSA+104                                                  08027000
FLCSNPSW EQU   PSA+96                                                   08028000
FLCENPSW EQU   PSA+88                                                   08029000
FLCTRACE EQU   PSA+84                                                   08030000
FLCTIMER EQU   PSA+80                                                   08031000
FLCCVT2  EQU   PSA+76                                                   08032000
FLCCAW   EQU   PSA+72                                                   08033000
FLCCSW   EQU   PSA+64                                                   08034000
FLCIOPSW EQU   PSA+56                                                   08035000
FLCMOPSW EQU   PSA+48                                                   08036000
FLCPOPSW EQU   PSA+40                                                   08037000
FLCSOPSW EQU   PSA+32                                                   08038000
FLCEOPSW EQU   PSA+24                                                   08039000
@NM00081 EQU   FLCICCW2+4                                               08040000
FLCCVT   EQU   FLCICCW2                                                 08041000
FLCICCW1 EQU   FLCROPSW                                                 08042000
FLCIPPSW EQU   FLCRNPSW                                                 08043000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      08044000
@RF00111 EQU   @RC00108                                                 08045000
@RF00116 EQU   @RC00108                                                 08046000
@RT00147 EQU   PARSECMD                                                 08047000
@RF00147 EQU   INVCALLR                                                 08048000
@RT00151 EQU   INVSYN                                                   08049000
@RT00163 EQU   INVADDR                                                  08050000
@RT00168 EQU   INVSYN                                                   08051000
@RT00177 EQU   INVADDR                                                  08052000
@RF00182 EQU   INVSYN                                                   08053000
@RT00185 EQU   INVADDR                                                  08054000
@RC00208 EQU   @EL00003                                                 08055000
@RC00227 EQU   @EL00004                                                 08056000
@RC00248 EQU   @EL00005                                                 08057000
@RF00291 EQU   TRYFORCE                                                 08058000
@RC00307 EQU   @EL00006                                                 08059000
@RC00305 EQU   @EL00006                                                 08060000
@RC00283 EQU   @EL00006                                                 08061000
@RC00281 EQU   @EL00006                                                 08062000
EXTVSOFF EQU   @EL00006                                                 08063000
@RT00351 EQU   FREESQA                                                  08064000
@RT00365 EQU   CANCLLT                                                  08065000
@RT00376 EQU   CANCLLT                                                  08066000
@RT00391 EQU   NEXTPAGE                                                 08067000
EXITFOFF EQU   @EL00007                                                 08068000
ENDFXCD  EQU   @EL00010                                                 08069000
@RC00598 EQU   @EL00010                                                 08070000
@RT00648 EQU   EXITVSON                                                 08071000
@RT00653 EQU   EXITVSON                                                 08072000
@RT00676 EQU   PRMPTOPR                                                 08073000
@RT00678 EQU   EXITVSON                                                 08074000
@RC00760 EQU   @EL00014                                                 08075000
@RC00755 EQU   @EL00014                                                 08076000
@RF00805 EQU   @EL00015                                                 08077000
@RT00860 EQU   RETRYOFF                                                 08078000
@RC00900 EQU   @EL00017                                                 08079000
@RC00953 EQU   @EL00017                                                 08080000
@RC01037 EQU   @EL00019                                                 08081000
@RT00261 EQU   EXTVSOFF                                                 08082000
@RC00299 EQU   @RC00283                                                 08083000
@RT00338 EQU   EXITFOFF                                                 08084000
@ENDDATA EQU   *                                                        08085000
         END   IEEMPVST,(C'PLS1046',0701,76182)                         08086000
