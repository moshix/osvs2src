         TITLE 'IEEVCPU VARY CPU MAINLINE                              *00001000
                        '                                               00002000
IEEVCPU  CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(22)                                             0001 00007000
         DC    C'IEEVCPU  UZ19134 78196'                           0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @05,0                                               0001 00010000
@PSTART  LA    @08,4095(,@05)                                      0001 00011000
         LA    @09,4095(,@08)                                      0001 00012000
         USING @PSTART,@05                                         0001 00013000
         USING @PSTART+4095,@08                                    0001 00014000
         USING @PSTART+8190,@09                                    0001 00015000
         LR    @06,@01                                             0001 00016000
         L     @00,@SIZDATD                                        0001 00017000
         GETMAIN  R,LV=(0)                                              00018000
         LR    @07,@01                                             0001 00019000
         USING @DATD,@07                                           0001 00020000
         LR    @01,@06                                             0001 00021000
         ST    @13,@SA00001+4                                      0001 00022000
         LR    @13,@07                                             0001 00023000
         MVC   @PC00001(4),0(@01)                                  0001 00024000
*                                      I = THE CPU #         @G47AN2O*/ 00025000
*                                                                  0108 00026000
*   /*****************************************************************/ 00027000
*   /*                                                               */ 00028000
*   /* BEGINNING OF MAINLINE PROCESSING. ZERO OUT NECESSARY FIELDS   */ 00029000
*   /*                                                               */ 00030000
*   /*****************************************************************/ 00031000
*                                                                  0109 00032000
*   WORKAREA=''B;                   /* ZERO OUT WORK AREA            */ 00033000
         XC    WORKAREA(116),WORKAREA                              0109 00034000
*   VMVPARMS=''B;                   /* ZERO OUT PARM LIST POINTERS   */ 00035000
         XC    VMVPARMS(52),VMVPARMS                               0110 00036000
*   PARMAREA=''B;                   /* ZERO OUT IEEVWKUP'S PARM    0111 00037000
*                                                            @G557P2L*/ 00038000
         XC    PARMAREA(109),PARMAREA                              0111 00039000
*   PSAPTR=0;                       /* POINT TO MY PSA       @YM08660*/ 00040000
         SLR   PSAPTR,PSAPTR                                       0112 00041000
*   RFY                                                            0113 00042000
*    (R1,                                                          0113 00043000
*     R5,                                                          0113 00044000
*     R7,                                                          0113 00045000
*     R8,                                                          0113 00046000
*     R9,                                                          0113 00047000
*     R10,                                                         0113 00048000
*     R14) RSTD;                    /* RESTRICT REGISTER             */ 00049000
*   CSCBPTR=R1;                     /* SAVE CSCB ADDRESS             */ 00050000
*                                                                  0114 00051000
         ST    R1,CSCBPTR                                          0114 00052000
*   /*****************************************************************/ 00053000
*   /*                                                               */ 00054000
*   /* SAVE REGISTERS IN WORK AREA FOR ADDRESSABILITY IN THE EVENT OF*/ 00055000
*   /* A FAILURE. ESTAE ROUTINE WILL RELOAD REGISTERS                */ 00056000
*   /*                                                               */ 00057000
*   /*****************************************************************/ 00058000
*                                                                  0115 00059000
*   CODEREG1=R5;                    /* SAVE BASE REGISTERS           */ 00060000
         ST    R5,CODEREG1                                         0115 00061000
*   CODEREG2=R8;                    /* SAVE SECOND BASE REG          */ 00062000
         ST    R8,CODEREG2                                         0116 00063000
*   CODEREG3=R9;                    /* SAVE THIRD BASE REG           */ 00064000
         ST    R9,CODEREG3                                         0117 00065000
*   DATAREG1=R7;                    /* SAVE DATA REGISTER            */ 00066000
         ST    R7,DATAREG1                                         0118 00067000
*   RETADD=R14;                     /* SAVE RETURN ADDRESS           */ 00068000
         ST    R14,RETADD                                          0119 00069000
*   R10=ADDR(ESTAPRM);              /* SETUP FOR ESTAE ROUTINE       */ 00070000
         LA    R10,ESTAPRM                                         0120 00071000
*   ESTLIST=''B;                    /* ZERO OUT ESTAE LIST           */ 00072000
         XC    ESTLIST(16),ESTLIST                                 0121 00073000
*   R1=ADDR(ESTLIST);               /* POINT TO ESTAE ENTERFACE      */ 00074000
         LA    R1,ESTLIST                                          0122 00075000
*   RFY                                                            0123 00076000
*    (R1,                                                          0123 00077000
*     R5,                                                          0123 00078000
*     R7,                                                          0123 00079000
*     R8,                                                          0123 00080000
*     R9,                                                          0123 00081000
*     R10,                                                         0123 00082000
*     R14) UNRSTD;                  /* RELEASE REGISTERS             */ 00083000
*   GEN(ESTAE ESTAERTN,PARAM=(10),PURGE=NONE,MF=(E,(1)));          0124 00084000
         ESTAE ESTAERTN,PARAM=(10),PURGE=NONE,MF=(E,(1))                00085000
*   RFY                                                            0125 00086000
*    (RETCODE) RSTD;                /* RESTRICT REG 15               */ 00087000
*                                                                  0125 00088000
*   /*****************************************************************/ 00089000
*   /*                                                               */ 00090000
*   /* CHECK IF ESATE HAS BEEN SET UP PROPERLY                       */ 00091000
*   /*                                                               */ 00092000
*   /*****************************************************************/ 00093000
*                                                                  0126 00094000
*   IF RETCODE^=0 THEN              /* ANY ERROR ?                   */ 00095000
         LTR   RETCODE,RETCODE                                     0126 00096000
         BNZ   @RT00126                                            0126 00097000
*     GOTO MAINEXT;                 /* GO CLEAN UP                   */ 00098000
*                                                                  0127 00099000
*   /*****************************************************************/ 00100000
*   /*                                                               */ 00101000
*   /* SERIALIZE VARY CPU AND VARY CHANNEL COMMANDS          @ZA24473*/ 00102000
*   /*                                                               */ 00103000
*   /*****************************************************************/ 00104000
*                                                                  0128 00105000
*   GEN(ENQ  (RCNENQQ,RCNENQR,E,3,SYSTEM));/* ENQ SYSZVARY   @ZA24473*/ 00106000
         ENQ  (RCNENQQ,RCNENQR,E,3,SYSTEM)                              00107000
*   RECONENQ='1'B;                  /* SET FOOTPRINT         @ZA24473*/ 00108000
         OI    RECONENQ,B'01000000'                                0129 00109000
*/**** SYNTXCHK **************************************************** */ 00110000
*/* SYNTXCHK WILL SCAN THE INPUT COMMAND AND SET UP NECESSARY FIELDS */ 00111000
*/* IN THE WORKAREA TO BE USED LATER. COMMAND AUTHORITY IS CHECKED   */ 00112000
*/* AND WILL TERMINATE SCAN IF ISSUING CONSOLE WAS NOT AUTHORIZED    */ 00113000
*/* POSSIBLE ERROR INDICATORS ARE: UNAUTH, INVLDSTX, UNIPROC,        */ 00114000
*/* CHCPUOFF                                                         */ 00115000
*/****************************************************************** */ 00116000
*                                                                  0130 00117000
*   DO;                                                            0130 00118000
*     CHARPTR=ADDR(CHBUF);          /* ADDRESSABILITY TO COMMAND TEXT*/ 00119000
         L     @14,CSCBPTR                                         0131 00120000
         LA    CHARPTR,CHBUF(,@14)                                 0131 00121000
*/******** AUTHCHK ************************************************* */ 00122000
*/* AUTHCHK WILL VERIFY THE AUTHORTY OF THE ISSUING CONSOLE. IF THE  */ 00123000
*/* ISSUING CONSOLE WAS NOT AUTHORIZED THEN UNAUTH ERROR FLAG WILL   */ 00124000
*/* BE SET. ROUTINE WILL ACCEPT INTERNALLY ISSUED COMMANDS, COMMANDS */ 00125000
*/* FROM READERS WITH ATHOURATION OF X'E00' AND COMMANDS ISSUED BY   */ 00126000
*/* THE MASTER CONSOLE.                                              */ 00127000
*/****************************************************************** */ 00128000
*                                                                  0132 00129000
*     DO;                                                          0132 00130000
*                                                                  0132 00131000
*       /*************************************************************/ 00132000
*       /*                                                           */ 00133000
*       /* ASSUME MASTER CONSOLE ISSUED COMMAND                      */ 00134000
*       /*                                                           */ 00135000
*       /*************************************************************/ 00136000
*                                                                  0133 00137000
*       CONSLID=UCMID;              /* SET MASTER CONSOLE ID         */ 00138000
*                                                                  0133 00139000
         L     @06,CVTPTR                                          0133 00140000
         L     @06,UCMBASPT(,@06)                                  0133 00141000
         AL    @06,@CF04020                                        0133 00142000
         L     @06,UCMMCSPT(,@06)                                  0133 00143000
         L     @06,UCMDVEPT(,@06)                                  0133 00144000
         MVC   CONSLID(1),UCMID(@06)                               0133 00145000
*       /*************************************************************/ 00146000
*       /*                                                           */ 00147000
*       /* CHECK IF COMMAND WAS A INTERNAL COMMAND                   */ 00148000
*       /*                                                           */ 00149000
*       /*************************************************************/ 00150000
*                                                                  0134 00151000
*       IF CHUCMP^=0 THEN           /* WAS IT INTERNAL?              */ 00152000
*                                                                  0134 00153000
         CLI   CHUCMP(@14),0                                       0134 00154000
         BE    @RF00134                                            0134 00155000
*         /***********************************************************/ 00156000
*         /*                                                         */ 00157000
*         /* COMMAND WAS NOT ISSUED INTERNALY CHECK FOR READER ISSUE */ 00158000
*         /*                                                         */ 00159000
*         /***********************************************************/ 00160000
*                                                                  0135 00161000
*         IF CHUCMP='80'X THEN      /* READER ISSUE COMMAND?         */ 00162000
         CLI   CHUCMP(@14),X'80'                                   0135 00163000
         BNE   @RF00135                                            0135 00164000
*           DO;                                                    0136 00165000
*                                                                  0136 00166000
*             /*******************************************************/ 00167000
*             /*                                                     */ 00168000
*             /* CHECK FOR PROPER AUTHORIZATION FROM READER          */ 00169000
*             /*                                                     */ 00170000
*             /*******************************************************/ 00171000
*                                                                  0137 00172000
*             IF CHINC^='E000'X THEN                               0137 00173000
         CLC   CHINC(2,@14),@CH03589                               0137 00174000
         BE    @RF00137                                            0137 00175000
*               UNAUTH='1'B;        /* SET UNAUTH ERROR FLAG         */ 00176000
         OI    UNAUTH,B'10000000'                                  0138 00177000
*           END;                                                   0139 00178000
*                                                                  0139 00179000
*       /*************************************************************/ 00180000
*       /*                                                           */ 00181000
*       /* COMMAND WAS NOT ISSUED INTERNALLY CHECK IF ISSUING CONSOLE*/ 00182000
*       /* WAS AUTHORIZED.                                           */ 00183000
*       /*                                                           */ 00184000
*       /*************************************************************/ 00185000
*                                                                  0140 00186000
*         ELSE                                                     0140 00187000
*                                                                  0140 00188000
*           /*********************************************************/ 00189000
*           /*                                                       */ 00190000
*           /* CHECK IF MASTER CONSOLE ISSUED COMMAND                */ 00191000
*           /*                                                       */ 00192000
*           /*********************************************************/ 00193000
*                                                                  0140 00194000
*           IF UCMID^=CHUCMP THEN   /* WAS IT MASTER                 */ 00195000
         B     @RC00135                                            0140 00196000
@RF00135 L     @14,CVTPTR                                          0140 00197000
         L     @14,UCMBASPT(,@14)                                  0140 00198000
         AL    @14,@CF04020                                        0140 00199000
         L     @14,UCMMCSPT(,@14)                                  0140 00200000
         L     @14,UCMDVEPT(,@14)                                  0140 00201000
         L     @06,CSCBPTR                                         0140 00202000
         CLC   UCMID(1,@14),CHUCMP(@06)                            0140 00203000
         BE    @RF00140                                            0140 00204000
*             DO;                                                  0141 00205000
*               CONSLID=CHUCMP;     /* SAVE ISSUING CONSOLE ID       */ 00206000
         MVC   CONSLID(1),CHUCMP(@06)                              0142 00207000
*               UNAUTH='1'B;        /* SET UNAUTH FLAG               */ 00208000
         OI    UNAUTH,B'10000000'                                  0143 00209000
*             END;                                                 0144 00210000
*     END;                          /* END OF AUTHCHECK ROUTINE      */ 00211000
@RF00140 DS    0H                                                  0145 00212000
@RC00135 DS    0H                                                  0145 00213000
@RF00134 DS    0H                                                  0146 00214000
*                                                                  0146 00215000
*     /***************************************************************/ 00216000
*     /*                                                             */ 00217000
*     /* VERIFY THAT NO ERROR INDICATORS WERE SET DURING AUTH CHECK  */ 00218000
*     /*                                                             */ 00219000
*     /***************************************************************/ 00220000
*                                                                  0146 00221000
*     IF ERRORIND^=0 THEN           /* ANY ERRORS                    */ 00222000
         ICM   @14,15,ERRORIND                                     0146 00223000
         BNZ   @RT00146                                            0146 00224000
*       GOTO SYNTEXIT;              /* SKIP PROCESSING               */ 00225000
*                                                                  0147 00226000
*     /***************************************************************/ 00227000
*     /*                                                             */ 00228000
*     /* CHECK FOR CHANNEL COMMAND AND SET UP WORKAREA IF FOUND      */ 00229000
*     /*                                                             */ 00230000
*     /***************************************************************/ 00231000
*                                                                  0148 00232000
*     IF COMBUF='CH(' THEN          /* CHECK FOR VARY CHANNEL COMMAND*/ 00233000
         CLC   COMBUF(3,CHARPTR),@CC03591                          0148 00234000
         BNE   @RF00148                                            0148 00235000
*       DO;                                                        0149 00236000
*         CHNIND='1'B;              /* SET CHANNEL INDICATOR         */ 00237000
         OI    CHNIND,B'10000000'                                  0150 00238000
*         CHARPTR=CHARPTR+3;        /* STEP POINTER TO CHANNEL NUMBER*/ 00239000
*                                                                  0151 00240000
         AH    CHARPTR,@CH00074                                    0151 00241000
*         /***********************************************************/ 00242000
*         /*                                                         */ 00243000
*         /* VERIFY THAT CHANNEL ADDRESS IS VALID HEX DIGIT AND CALL */ 00244000
*         /* CONVERT TO CONVERT VALUE AND BUILD BIT MASK             */ 00245000
*         /*                                                         */ 00246000
*         /***********************************************************/ 00247000
*                                                                  0152 00248000
*         IF(COMBUF=>'A'&COMBUF<='F')|(COMBUF>='0') THEN/* VALID   0152 00249000
*                                      DIGIT                         */ 00250000
         CLI   COMBUF(CHARPTR),C'A'                                0152 00251000
         BL    @GL00001                                            0152 00252000
         CLI   COMBUF(CHARPTR),C'F'                                0152 00253000
         BNH   @RT00152                                            0152 00254000
@GL00001 CLI   COMBUF(CHARPTR),C'0'                                0152 00255000
         BL    @RF00152                                            0152 00256000
@RT00152 DS    0H                                                  0153 00257000
*           CALL CONVERT(HEXCHNAD,CHNMASK);/* CONVERT CHARACTER      */ 00258000
         LA    @14,HEXCHNAD                                        0153 00259000
         ST    @14,@AL00001                                        0153 00260000
         LA    @14,CHNMASK                                         0153 00261000
         ST    @14,@AL00001+4                                      0153 00262000
         LA    @01,@AL00001                                        0153 00263000
         BAL   @14,CONVERT                                         0153 00264000
*         ELSE                                                     0154 00265000
*                                                                  0154 00266000
*           /*********************************************************/ 00267000
*           /*                                                       */ 00268000
*           /* CHARACTER WAS NOT A VALID CHARACTER SET SYNTAX ERROR  */ 00269000
*           /* AND RETURN                                            */ 00270000
*           /*                                                       */ 00271000
*           /*********************************************************/ 00272000
*                                                                  0154 00273000
*           GOTO SYNTERR;           /* GO SET SYNTAX ERROR FLAG      */ 00274000
*                                                                  0154 00275000
*         /***********************************************************/ 00276000
*         /*                                                         */ 00277000
*         /* CHARACTER WAS VALID. VERIFY THAT ADDRESS IS VALID FOR   */ 00278000
*         /* THIS SYSTEM                                             */ 00279000
*         /*                                                         */ 00280000
*         /***********************************************************/ 00281000
*                                                                  0155 00282000
*         IF HEXCHNAD>CSDCHAD THEN  /* CHANNEL INVALID ?             */ 00283000
         L     @14,CVTPTR                                          0155 00284000
         L     @14,CVTCSD(,@14)                                    0155 00285000
         SLR   @06,@06                                             0155 00286000
         ICM   @06,3,HEXCHNAD                                      0155 00287000
         CH    @06,CSDCHAD(,@14)                                   0155 00288000
         BNH   @RF00155                                            0155 00289000
*           DO;                                                    0156 00290000
*             CHINV='1'B;           /* SET INVALID CHANNEL FLAG      */ 00291000
         OI    CHINV,B'00000001'                                   0157 00292000
*             GOTO SYNTEXIT;        /* EXIT                          */ 00293000
         B     SYNTEXIT                                            0158 00294000
*           END;                                                   0159 00295000
*         CHARPTR=CHARPTR+1;        /* STEP PAST CHANNEL ADDRESS     */ 00296000
*                                                                  0160 00297000
@RF00155 LA    @14,1                                               0160 00298000
         ALR   CHARPTR,@14                                         0160 00299000
*         /***********************************************************/ 00300000
*         /*                                                         */ 00301000
*         /* CHECK IF CHANNEL ADDRESS WAS SPECIFIED IN COMMAND       */ 00302000
*         /*                                                         */ 00303000
*         /***********************************************************/ 00304000
*                                                                  0161 00305000
*         IF COMBUF^=',' THEN       /* NEXT CHARACTER A COMMA?       */ 00306000
*                                                                  0161 00307000
         CLI   COMBUF(CHARPTR),C','                                0161 00308000
         BE    @RF00161                                            0161 00309000
*           /*********************************************************/ 00310000
*           /*                                                       */ 00311000
*           /* CPU ADDRESS WAS NOT SPECIFIED. IF MORE THAN ONE CPU IS*/ 00312000
*           /* ONLINE THEN REJECT COMMAND. ELSE USE THIS CPU'S       */ 00313000
*           /* ADDRESS AND BITMASK AS DEFAULT                        */ 00314000
*           /*                                                       */ 00315000
*           /*********************************************************/ 00316000
*                                                                  0162 00317000
*           IF CSDCPUOL=1 THEN      /* IS ONLY ONE CPU ONLINE        */ 00318000
         L     @06,CVTPTR                                          0162 00319000
         L     @06,CVTCSD(,@06)                                    0162 00320000
         CH    @14,CSDCPUOL(,@06)                                  0162 00321000
         BNE   @RF00162                                            0162 00322000
*             DO;                                                  0163 00323000
*               HEXCPUAD=PSACPUPA;  /* USE THIS CPU'S ADDRESS AS   0164 00324000
*                                      DEFAULT                       */ 00325000
         MVC   HEXCPUAD(2),PSACPUPA(PSAPTR)                        0164 00326000
*               CPUMSK=CSDCPUAL;    /* USE DEFAULT BIT MASK          */ 00327000
         MVC   CPUMSK(2),CSDCPUAL(@06)                             0165 00328000
*               GOTO SYTXCMND;      /* GO SCAN REST OF COMMAND       */ 00329000
         B     SYTXCMND                                            0166 00330000
*             END;                                                 0167 00331000
*                                                                  0167 00332000
*         /***********************************************************/ 00333000
*         /*                                                         */ 00334000
*         /* CPU ADDRESS WAS NOT SPECIFIED AND MORE THAN ONE CPU IS  */ 00335000
*         /* ONLINE SET SYNTAX ERROR AND TERMINATE PROCESSING        */ 00336000
*         /*                                                         */ 00337000
*         /***********************************************************/ 00338000
*                                                                  0168 00339000
*           ELSE                                                   0168 00340000
*             GOTO SYNTERR;         /* SET ERROR FLAG AND EXIT       */ 00341000
*                                                                  0168 00342000
*         /***********************************************************/ 00343000
*         /*                                                         */ 00344000
*         /* CPU ADDRESS WAS SPECIFIED VERIFY CHARACTER AND CONVERT  */ 00345000
*         /*                                                         */ 00346000
*         /***********************************************************/ 00347000
*                                                                  0169 00348000
*         CHARPTR=CHARPTR+1;        /* STEP PAST COMMA               */ 00349000
@RF00161 AH    CHARPTR,@CH00067                                    0169 00350000
*STXCPUAD:                                                         0170 00351000
*         IF(COMBUF=>'A'&COMBUF<='F')/* VALID ALPHA CHARACTER? OR    */ 00352000
*             |(COMBUF=>'0')        /* VALID DECIMAL DIGIT?          */ 00353000
*           THEN                                                   0170 00354000
STXCPUAD CLI   COMBUF(CHARPTR),C'A'                                0170 00355000
         BL    @GL00003                                            0170 00356000
         CLI   COMBUF(CHARPTR),C'F'                                0170 00357000
         BNH   @RT00170                                            0170 00358000
@GL00003 CLI   COMBUF(CHARPTR),C'0'                                0170 00359000
         BL    @RF00170                                            0170 00360000
@RT00170 DS    0H                                                  0171 00361000
*           CALL CONVERT(HEXCPUAD,CPUMSK);/* CONVERT CHARACTER AND 0171 00362000
*                                      BUILD BIT MASK                */ 00363000
*                                                                  0171 00364000
         LA    @14,HEXCPUAD                                        0171 00365000
         ST    @14,@AL00001                                        0171 00366000
         LA    @14,CPUMSK                                          0171 00367000
         ST    @14,@AL00001+4                                      0171 00368000
         LA    @01,@AL00001                                        0171 00369000
         BAL   @14,CONVERT                                         0171 00370000
*         /***********************************************************/ 00371000
*         /*                                                         */ 00372000
*         /* WAS NOT A VALID HEX CHARACTER. SET SYNTAX ERROR FLAG    */ 00373000
*         /*                                                         */ 00374000
*         /***********************************************************/ 00375000
*                                                                  0172 00376000
*         ELSE                                                     0172 00377000
*           GOTO SYNTERR;           /* GO SET SYNTAX ERROR AND RETURN*/ 00378000
*         CHARPTR=CHARPTR+1;        /* STEP PAST CPU ADDRESS         */ 00379000
*                                                                  0173 00380000
         AH    CHARPTR,@CH00067                                    0173 00381000
*         /***********************************************************/ 00382000
*         /*                                                         */ 00383000
*         /* CHECK FOR TYPE OF COMMAND. I.E. ONLINE, OFFLINE,        */ 00384000
*         /* UNCONDITIONAL OFFLINE                                   */ 00385000
*         /*                                                         */ 00386000
*         /***********************************************************/ 00387000
*                                                                  0174 00388000
*SYTXCMND:                          /* VERIFY TYPE OF COMMAND AND SET   00389000
*                                      UP WORKAREA                   */ 00390000
*         IF COMBUF='),ONLINE ' THEN/* CHECK FOR ONLINE COMMAND      */ 00391000
SYTXCMND CLC   COMBUF(9,CHARPTR),@CC03601                          0174 00392000
         BNE   @RF00174                                            0174 00393000
*           DO;                                                    0175 00394000
*             ONLINE='1'B;          /* SET ONLINE INDICATOR          */ 00395000
         OI    ONLINE,B'00100000'                                  0176 00396000
*             GOTO SYTXCHCK;        /* GO VERIFY CPU ONLINE          */ 00397000
         B     SYTXCHCK                                            0177 00398000
*           END;                                                   0178 00399000
*                                                                  0178 00400000
*         /***********************************************************/ 00401000
*         /*                                                         */ 00402000
*         /* CHECK IF THIS IS A OFFLINE COMMAND                      */ 00403000
*         /*                                                         */ 00404000
*         /***********************************************************/ 00405000
*                                                                  0179 00406000
*         IF COMBUF='),OFFLINE ' THEN/* OFFLINE COMMAND?             */ 00407000
@RF00174 CLC   COMBUF(10,CHARPTR),@CC03605                         0179 00408000
         BE    @RT00179                                            0179 00409000
*           GOTO SYTXCHCK;          /* GO VERIFY CPU ONLINE          */ 00410000
*                                                                  0180 00411000
*         /***********************************************************/ 00412000
*         /*                                                         */ 00413000
*         /* IF OFFLINE WITH UNCONDITIONAL IS SPECIFIED THEN SET     */ 00414000
*         /* UNCOND INDICATOR IN WORK AREA                           */ 00415000
*         /*                                                         */ 00416000
*         /***********************************************************/ 00417000
*                                                                  0181 00418000
*         IF COMBUF='),OFFLINE,UNCOND '|COMBUF='),UNCOND,OFFLINE ' THEN 00419000
         CLC   COMBUF(17,CHARPTR),@CC03607                         0181 00420000
         BE    @RT00181                                            0181 00421000
         CLC   COMBUF(17,CHARPTR),@CC03609                         0181 00422000
         BNE   @RF00181                                            0181 00423000
@RT00181 DS    0H                                                  0182 00424000
*           DO;                     /* OFFLINE UNCONDITIONAL REQUEST */ 00425000
*             UNCOND='1'B;          /* SET UNCONDITIONAL INDICATOR   */ 00426000
         OI    UNCOND,B'00010000'                                  0183 00427000
*             GOTO SYTXCHCK;        /* GO VERIFY CPU ONLINE          */ 00428000
         B     SYTXCHCK                                            0184 00429000
*           END;                                                   0185 00430000
*                                                                  0185 00431000
*         /***********************************************************/ 00432000
*         /*                                                         */ 00433000
*         /* IF CPU OFFLINE WITH CRH OPTION, SET CPU CRH INDICATOR IN*/ 00434000
*         /* THE WORKAREA.                                   @G557P2L*/ 00435000
*         /*                                                         */ 00436000
*         /***********************************************************/ 00437000
*                                                                  0186 00438000
*         IF CHNIND='0'B&(COMBUF='),OFFLINE,KEEPCHAN '|/*    @G557P2L*/ 00439000
*             COMBUF='),KEEPCHAN,OFFLINE ')/*                @G557P2L*/ 00440000
*           THEN                                                   0186 00441000
@RF00181 TM    CHNIND,B'10000000'                                  0186 00442000
         BNZ   @RF00186                                            0186 00443000
         CLC   COMBUF(19,CHARPTR),@CC03611                         0186 00444000
         BE    @RT00186                                            0186 00445000
         CLC   COMBUF(19,CHARPTR),@CC03613                         0186 00446000
         BNE   @RF00186                                            0186 00447000
@RT00186 DS    0H                                                  0187 00448000
*           DO;                     /* VARY CPU OFFLINE WITH CRH?  0187 00449000
*                                                            @G557P2L*/ 00450000
*             KEEPCHAN='1'B;        /* SET KEEPCHAN INDICATOR      0188 00451000
*                                                            @G557P2L*/ 00452000
         OI    KEEPCHAN,B'10000000'                                0188 00453000
*             GOTO SYTXCHCK;        /* GO VERIFY CPU ONLINE  @G557P2L*/ 00454000
         B     SYTXCHCK                                            0189 00455000
*           END;                                                   0190 00456000
*                                                                  0190 00457000
*         /***********************************************************/ 00458000
*         /*                                                         */ 00459000
*         /* IF NONE OF THE ABOVE KEYWORDS WERE FOUND THEN SET SYNTAX*/ 00460000
*         /* ERROR                                                   */ 00461000
*         /*                                                         */ 00462000
*         /***********************************************************/ 00463000
*                                                                  0191 00464000
*SYNTERR:                                                          0191 00465000
*         INVLDSTX='1'B;            /* SET INVALID SYNTAX ERROR      */ 00466000
@RF00186 DS    0H                                                  0191 00467000
SYNTERR  OI    INVLDSTX,B'01000000'                                0191 00468000
*         GOTO SYNTEXIT;            /* RETURN TO CALLER              */ 00469000
         B     SYNTEXIT                                            0192 00470000
*       END;                        /* END OF CHANNEL COMMAND        */ 00471000
*                                                                  0193 00472000
*     /***************************************************************/ 00473000
*     /*                                                             */ 00474000
*     /* COMMAND WAS NOT VARY CHANNEL. VERIFY A VARY CPU COMMAND     */ 00475000
*     /*                                                             */ 00476000
*     /***************************************************************/ 00477000
*                                                                  0194 00478000
*     IF COMBUF^='CPU(' THEN        /* VARY CPU COMMAND ?            */ 00479000
@RF00148 CLC   COMBUF(4,CHARPTR),@CC03616                          0194 00480000
         BNE   @RT00194                                            0194 00481000
*       GOTO SYNTERR;               /* SYNTAX ERROR IF NOT           */ 00482000
*                                                                  0195 00483000
*     /***************************************************************/ 00484000
*     /*                                                             */ 00485000
*     /* VERIFY THAT WE ARE NOT RUNNING ON A UNIPROCESSOR            */ 00486000
*     /*                                                             */ 00487000
*     /***************************************************************/ 00488000
*                                                                  0196 00489000
*     IF CSDMP^='1'B THEN                                          0196 00490000
         L     @14,CVTPTR                                          0196 00491000
         L     @14,CVTCSD(,@14)                                    0196 00492000
         TM    CSDMP(@14),B'10000000'                              0196 00493000
         BO    @RF00196                                            0196 00494000
*       DO;                                                        0197 00495000
*         UNIPROC='1'B;             /* SET UNIPROCESSOR ERROR FLAG   */ 00496000
         OI    UNIPROC,B'01000000'                                 0198 00497000
*         GOTO SYNTEXIT;            /* RETURN TO CALLER              */ 00498000
         B     SYNTEXIT                                            0199 00499000
*       END;                                                       0200 00500000
*     CHARPTR=CHARPTR+4;            /* UPDATE POINTER TO CPU ADDRESS */ 00501000
@RF00196 AH    CHARPTR,@CH00076                                    0201 00502000
*     GOTO STXCPUAD;                /* GO VERIFY CPU ADDRESS         */ 00503000
*                                                                  0202 00504000
         B     STXCPUAD                                            0202 00505000
*     /***************************************************************/ 00506000
*     /*                                                             */ 00507000
*     /* VERIFY VALIDITY OF COMMAND BY CHECKING IF CPU IS ONLINE FOR */ 00508000
*     /* VARY CHANNEL COMMAND                                        */ 00509000
*     /*                                                             */ 00510000
*     /***************************************************************/ 00511000
*                                                                  0203 00512000
*SYTXCHCK:                                                         0203 00513000
*                                                                  0203 00514000
*     /***************************************************************/ 00515000
*     /*                                                             */ 00516000
*     /* TEST FOR KEEPCHAN SPECIFIED AND SUPPORTED. PRESENTLY ONLY   */ 00517000
*     /* THE 168MP PROVIDES THIS FUNCTION VIA CRH.           @G557P2L*/ 00518000
*     /*                                                             */ 00519000
*     /***************************************************************/ 00520000
*                                                                  0203 00521000
*     IF KEEPCHAN='1'B THEN                                        0203 00522000
SYTXCHCK TM    KEEPCHAN,B'10000000'                                0203 00523000
         BNO   @RF00203                                            0203 00524000
*       DO;                         /* CPU OFFLINE CRH ENTERED     0204 00525000
*                                                            @G557P2L*/ 00526000
*         PSAPTR=0;                 /* ADDRESS THIS CPU'S PSA      0205 00527000
*                                                            @G557P2L*/ 00528000
         SLR   PSAPTR,PSAPTR                                       0205 00529000
*         PCCAPTR=PSAPCCAV;         /* GET PCCA ADDRESS FOR CRH TEST    00530000
*                                                            @G557P2L*/ 00531000
         L     @14,PSAPCCAV(,PSAPTR)                               0206 00532000
         ST    @14,PCCAPTR                                         0206 00533000
*         IF IOXCRHA=0|PCCACPID(9:12)^='0168' THEN                 0207 00534000
         L     @06,CVTPTR                                          0207 00535000
         L     @06,IOCOMPTR(,@06)                                  0207 00536000
         L     @06,IOCXPTR(,@06)                                   0207 00537000
         ICM   @04,15,IOXCRHA(@06)                                 0207 00538000
         BZ    @RT00207                                            0207 00539000
         CLC   PCCACPID+8(4,@14),@CC03618                          0207 00540000
         BE    @RF00207                                            0207 00541000
@RT00207 DS    0H                                                  0208 00542000
*           NOKPCHAN='1'B;          /* SET KEEPCHAN NOT SUPPORTED. 0208 00543000
*                                                            @G557P2L*/ 00544000
         OI    NOKPCHAN,B'00010000'                                0208 00545000
*         ELSE                                                     0209 00546000
*           CPUCRH='1'B;            /* CPU OFFLINE TO ACTIVATE     0209 00547000
*                                      CRH.@G557P2L                  */ 00548000
         B     @RC00207                                            0209 00549000
@RF00207 OI    CPUCRH,B'00000001'                                  0209 00550000
*       END;                                                       0210 00551000
*                                                                  0210 00552000
@RC00207 DS    0H                                                  0211 00553000
*     /***************************************************************/ 00554000
*     /*                                                             */ 00555000
*     /* IF THIS WAS A VARY CHANNEL COMMAND VERIFY THAT THE SPECIFIED*/ 00556000
*     /* CPU IS ONLINE                                               */ 00557000
*     /*                                                             */ 00558000
*     /***************************************************************/ 00559000
*                                                                  0211 00560000
*     IF CHNIND='1'B&(CSDCPUAL&CPUMSK)=0 THEN/*              @Y30CQXA*/ 00561000
@RF00203 TM    CHNIND,B'10000000'                                  0211 00562000
         BNO   @RF00211                                            0211 00563000
         SLR   @14,@14                                             0211 00564000
         L     @06,CVTPTR                                          0211 00565000
         L     @04,CVTCSD(,@06)                                    0211 00566000
         SLR   @11,@11                                             0211 00567000
         ICM   @11,3,CPUMSK                                        0211 00568000
         SLR   @10,@10                                             0211 00569000
         ICM   @10,3,CSDCPUAL(@04)                                 0211 00570000
         NR    @11,@10                                             0211 00571000
         CR    @11,@14                                             0211 00572000
         BNE   @RF00211                                            0211 00573000
*       DO;                         /*                       @Y30CQXA*/ 00574000
*                                                                  0212 00575000
*         /***********************************************************/ 00576000
*         /*                                                         */ 00577000
*         /* SUBJECT CPU IS OFFLINE, CHECK IF SYSTEM IS GENED FOR    */ 00578000
*         /* CHANNEL RECONFIGURATION HARDWARE.                       */ 00579000
*         /*                                                         */ 00580000
*         /***********************************************************/ 00581000
*                                                                  0213 00582000
*         IF IOXCRHA=0 THEN         /* CRH GENED?            @Y30CQXA*/ 00583000
         L     @06,IOCOMPTR(,@06)                                  0213 00584000
         L     @06,IOCXPTR(,@06)                                   0213 00585000
         C     @14,IOXCRHA(,@06)                                   0213 00586000
         BE    @RT00213                                            0213 00587000
*           GOTO REJOFF;            /* GO REJECT COMMAND. CPU OFFLINE   00588000
*                                                            @Y30CQXA*/ 00589000
*                                                                  0214 00590000
*         /***********************************************************/ 00591000
*         /*                                                         */ 00592000
*         /* SET UP ADDRESSABILITY TO MY OWN PCCA TO DETERMINE SYSTEM*/ 00593000
*         /* TYPE.                                                   */ 00594000
*         /*                                                         */ 00595000
*         /***********************************************************/ 00596000
*                                                                  0215 00597000
*         PSAPTR=0;                 /* ADDRESSABILITY TO MY PSA    0215 00598000
*                                                            @Y30CQXA*/ 00599000
         SLR   PSAPTR,PSAPTR                                       0215 00600000
*         PCCAPTR=PSAPCCAV;         /* ADDRESS OF MY PCCA    @Y30CQXA*/ 00601000
*                                                                  0216 00602000
         L     @14,PSAPCCAV(,PSAPTR)                               0216 00603000
         ST    @14,PCCAPTR                                         0216 00604000
*         /***********************************************************/ 00605000
*         /*                                                         */ 00606000
*         /* CHECK IF THIS IS A 168 MP SYSTEM                        */ 00607000
*         /*                                                         */ 00608000
*         /***********************************************************/ 00609000
*                                                                  0217 00610000
*         IF CSDMP^='1'B|PCCACPID(9:12)^='0168' THEN/* 168 MP?     0217 00611000
*                                                            @Y30CQXA*/ 00612000
         TM    CSDMP(@04),B'10000000'                              0217 00613000
         BNO   @RT00217                                            0217 00614000
         CLC   PCCACPID+8(4,@14),@CC03618                          0217 00615000
         BNE   @RT00217                                            0217 00616000
*           GOTO REJOFF;            /* REJECT COMMAND. NOT 168 MP  0218 00617000
*                                                            @Y30CQXA*/ 00618000
*                                                                  0218 00619000
*         /***********************************************************/ 00620000
*         /*                                                         */ 00621000
*         /* VERIFY THAT SPECIFIED CPU IS CONFIGURED INTO THE SYSTEM */ 00622000
*         /* AND IS CAPABLE OF OPERATING THE CRH                     */ 00623000
*         /*                                                         */ 00624000
*         /***********************************************************/ 00625000
*                                                                  0219 00626000
*         RFY                                                      0219 00627000
*          (R14,                                                   0219 00628000
*           R15) RSTD;              /* RESTRICT REGS 14,15   @Y30CQXA*/ 00629000
*         R14=HEXCPUAD;             /* PICK UP CPU ADDRESS   @Y30CQXA*/ 00630000
*                                                                  0220 00631000
         SLR   R14,R14                                             0220 00632000
         ICM   R14,3,HEXCPUAD                                      0220 00633000
*         /***********************************************************/ 00634000
*         /*                                                         */ 00635000
*         /* ISSUE SIGP SENSE TO SUBJECT CPU                         */ 00636000
*         /*                                                         */ 00637000
*         /***********************************************************/ 00638000
*                                                                  0221 00639000
*         GEN(SIGP  R15,R14,1(0));  /* SIGP SENSE            @Y30CQXA*/ 00640000
*                                                                  0221 00641000
         SIGP  R15,R14,1(0)                                             00642000
*         /***********************************************************/ 00643000
*         /*                                                         */ 00644000
*         /* ERROR IF CONDITION CODE 3 IS RECEIVED                   */ 00645000
*         /*                                                         */ 00646000
*         /***********************************************************/ 00647000
*                                                                  0222 00648000
*         BC(1,REJCC3);             /* CONDITION CODE 3      @Y30CQXA*/ 00649000
*                                                                  0222 00650000
         BC    1,REJCC3                                            0222 00651000
*         /***********************************************************/ 00652000
*         /*                                                         */ 00653000
*         /* CHECK IF PCCA EXISTS FOR SUBJECT CPU                    */ 00654000
*         /*                                                         */ 00655000
*         /***********************************************************/ 00656000
*                                                                  0223 00657000
*         IF PCCAT00P(HEXCPUAD+1)=0 THEN/* PCCA EXIST?       @Y30CQXA*/ 00658000
         SLR   @06,@06                                             0223 00659000
         ICM   @06,3,HEXCPUAD                                      0223 00660000
         SLA   @06,2                                               0223 00661000
         L     @04,CVTPTR                                          0223 00662000
         L     @04,CVTPCCAT(,@04)                                  0223 00663000
         L     @06,PCCAT00P(@06,@04)                               0223 00664000
         LTR   @06,@06                                             0223 00665000
         BNZ   @RF00223                                            0223 00666000
*           DO;                     /*                       @Y30CQXA*/ 00667000
*                                                                  0224 00668000
*             /*******************************************************/ 00669000
*             /*                                                     */ 00670000
*             /* PCCA DOES NOT EXIST. IF THIS IS A OFFLINE COMMAND   */ 00671000
*             /* THEN SET CHANNEL OFFLINE ALREADY FLAG FOR CLEANUP   */ 00672000
*             /*                                                     */ 00673000
*             /*******************************************************/ 00674000
*                                                                  0225 00675000
*             IF ONLINE^='1'B THEN  /* OFFLINE COMMAND?      @Y30CQXA*/ 00676000
         TM    ONLINE,B'00100000'                                  0225 00677000
         BO    @RF00225                                            0225 00678000
*               DO;                 /*                       @Y30CQXA*/ 00679000
*                                                                  0226 00680000
*                 /***************************************************/ 00681000
*                 /*                                                 */ 00682000
*                 /* VARY OFFLINE COMMAND, AND A PCCA DOES NOT EXIST.*/ 00683000
*                 /* SET CHANNEL OFFLINE FLAG AND EXIT TO CLEANUP    */ 00684000
*                 /*                                                 */ 00685000
*                 /***************************************************/ 00686000
*                                                                  0227 00687000
*                 CRHNCHN='1'B;     /*                       @Y30CQXA*/ 00688000
         OI    CRHNCHN,B'00100000'                                 0227 00689000
*                 GOTO SYNTEXIT;    /* EXIT                  @Y30CQXA*/ 00690000
         B     SYNTEXIT                                            0228 00691000
*               END;                /* END OF NO PCCA OFFLINE      0229 00692000
*                                      PROCESSING            @Y30CQXA*/ 00693000
*                                                                  0229 00694000
*             /*******************************************************/ 00695000
*             /*                                                     */ 00696000
*             /* PCCA DOES NOT EXIST AND THIS IS A VARY ONLINE       */ 00697000
*             /* COMMAND SET FLAG THAT PCCA IS NEEDED                */ 00698000
*             /*                                                     */ 00699000
*             /*******************************************************/ 00700000
*                                                                  0230 00701000
*             NOPCCA='1'B;          /* SET NO PCCA FLAG      @Y30CQXA*/ 00702000
@RF00225 OI    NOPCCA,B'00100000'                                  0230 00703000
*           END;                    /* END OF NO PCCA PROCESSING   0231 00704000
*                                                            @Y30CQXA*/ 00705000
*                                                                  0231 00706000
*         /***********************************************************/ 00707000
*         /*                                                         */ 00708000
*         /* THIS IS A VARY CHANNEL COMMAND FOR A CHANNEL ON A       */ 00709000
*         /* OFFLINE 168 MP CPU WITH SYSTEM GENED FOR CHANNEL        */ 00710000
*         /* RECONFIGURATION HARDWARE SUPPORT. SET CRH FOOTPRINT     */ 00711000
*         /*                                                         */ 00712000
*         /***********************************************************/ 00713000
*                                                                  0232 00714000
*         CRH='1'B;                 /* SET CRH FLAG          @Y30CQXA*/ 00715000
@RF00223 OI    CRH,B'00000010'                                     0232 00716000
*         GOTO SYNTEXIT;            /* GO EXIT               @Y30CQXA*/ 00717000
*                                                                  0233 00718000
         B     SYNTEXIT                                            0233 00719000
*         /***********************************************************/ 00720000
*         /*                                                         */ 00721000
*         /* EXIT FOR REJECT COMMAND FOR OFFLINE CPU                 */ 00722000
*         /*                                                         */ 00723000
*         /***********************************************************/ 00724000
*                                                                  0234 00725000
*REJOFF:                            /*                       @Y30CQXA*/ 00726000
*                                                                  0234 00727000
*         /***********************************************************/ 00728000
*         /*                                                         */ 00729000
*         /* SET ERROR FLAG FOR COMMAND                              */ 00730000
*         /*                                                         */ 00731000
*         /***********************************************************/ 00732000
*                                                                  0234 00733000
*         CHCPUOFF='1'B;            /* SET ERROR FLAG        @Y30CQXA*/ 00734000
REJOFF   OI    CHCPUOFF,B'00001000'                                0234 00735000
*         GOTO SYNTEXIT;            /* GO EXIT               @Y30CQXA*/ 00736000
*                                                                  0235 00737000
         B     SYNTEXIT                                            0235 00738000
*         /***********************************************************/ 00739000
*         /*                                                         */ 00740000
*         /* EXIT FOR REJECT COMMAND FOR NONEXISTANT CPU             */ 00741000
*         /*                                                         */ 00742000
*         /***********************************************************/ 00743000
*                                                                  0236 00744000
*REJCC3:                            /*                       @Y30CQXA*/ 00745000
*         CRHNCPU='1'B;             /* SET UNRESPONSIVE FLAG @Y30CQXA*/ 00746000
REJCC3   OI    CRHNCPU,B'01000000'                                 0236 00747000
*         GOTO SYNTEXIT;            /* GO EXIT               @Y30CQXA*/ 00748000
         B     SYNTEXIT                                            0237 00749000
*       END;                        /* END OF OFFLINE CPU PROCESSING    00750000
*                                      FOR VARY CHANNEL              */ 00751000
*SYNTEXIT:                                                         0239 00752000
*   END;                            /* END OF SYNTAX CHECK           */ 00753000
@RF00211 DS    0H                                                  0239 00754000
SYNTEXIT DS    0H                                                  0240 00755000
*                                                                  0240 00756000
*   /*****************************************************************/ 00757000
*   /*                                                               */ 00758000
*   /* CHECK FOR ANY ERROR FROM SYNTAX CHECK ROUTINE                 */ 00759000
*   /*                                                               */ 00760000
*   /*****************************************************************/ 00761000
*                                                                  0240 00762000
*   IF ERRORIND^=0 THEN             /* ANY ERRORS?                   */ 00763000
         ICM   @06,15,ERRORIND                                     0240 00764000
         BNZ   @RT00240                                            0240 00765000
*     GOTO MAINEXIT;                /* GO CLEAN UP                   */ 00766000
*   RFY                                                            0242 00767000
*    (RETCODE) UNRSTD;              /* RELEASE REG 15                */ 00768000
*                                                                  0242 00769000
*   /*****************************************************************/ 00770000
*   /*                                                               */ 00771000
*   /* FIX PAGES OF PROCESSOR MODULE DURING ENTIRE PROCESSING PAGES  */ 00772000
*   /* MUST BE FIXED WHILE HOLDING DISPATCHER LOCK AND RESTART       */ 00773000
*   /* RESOURCE                                                      */ 00774000
*   /*                                                               */ 00775000
*   /*****************************************************************/ 00776000
*                                                                  0243 00777000
*   RFY                                                            0243 00778000
*    (R7,                                                          0243 00779000
*     R10,                                                         0243 00780000
*     R11) RSTD;                    /* RESTRICT REGS FOR PAGEFIX     */ 00781000
*   R10=ADDR(IEEVWKUP);             /* LOAD MODULE START ADDRESS FOR    00782000
*                                      FIX                           */ 00783000
         L     R10,@CV03520                                        0244 00784000
*   R11=ADDR(IEECLEAN);             /* CSECT END ADDRESS FOR FIX     */ 00785000
         L     R11,@CV03522                                        0245 00786000
*   CALL PAGEFIX;                   /* FIX MODULE PAGES              */ 00787000
*                                                                  0246 00788000
         BAL   @14,PAGEFIX                                         0246 00789000
*   /*****************************************************************/ 00790000
*   /*                                                               */ 00791000
*   /* CHECK FOR ANY ERROR FROM PAGEFIX ROUTINE                      */ 00792000
*   /*                                                               */ 00793000
*   /*****************************************************************/ 00794000
*                                                                  0247 00795000
*   IF ERRORIND^=0 THEN             /* ANY ERROR?                    */ 00796000
         ICM   @06,15,ERRORIND                                     0247 00797000
         BNZ   @RT00247                                            0247 00798000
*     GOTO MAINEXIT;                /* EXIT                          */ 00799000
*                                                                  0248 00800000
*   /*****************************************************************/ 00801000
*   /*                                                               */ 00802000
*   /* FIX DYNAMIC WORK AREA ALSO. REG 7 POINTS TO BEGINNING OF WORK */ 00803000
*   /* AREA                                                          */ 00804000
*   /*                                                               */ 00805000
*   /*****************************************************************/ 00806000
*                                                                  0249 00807000
*   R10=R7;                         /* COPY WORK AREA ADDRESS INTO 0249 00808000
*                                      PARM REG                      */ 00809000
         LR    R10,R7                                              0249 00810000
*   R11=R10+@SIZDATD;               /* ADD LENGTH OF WORK AREA       */ 00811000
         LR    R11,R10                                             0250 00812000
         AL    R11,@SIZDATD                                        0250 00813000
*   DATAEND=R11;                    /* SAVE ADDRESS FOR FREE         */ 00814000
         ST    R11,DATAEND                                         0251 00815000
*   CALL PAGEFIX;                   /* FIX PAGES                     */ 00816000
*                                                                  0252 00817000
         BAL   @14,PAGEFIX                                         0252 00818000
*   /*****************************************************************/ 00819000
*   /*                                                               */ 00820000
*   /* CHECK FOR ANY ERROR FROM PAGEFIX ROUTINE                      */ 00821000
*   /*                                                               */ 00822000
*   /*****************************************************************/ 00823000
*                                                                  0253 00824000
*   IF ERRORIND^=0 THEN             /* ANY ERROR?                    */ 00825000
         ICM   @06,15,ERRORIND                                     0253 00826000
         BNZ   @RT00253                                            0253 00827000
*     GOTO MAINEXIT;                /* EXIT                          */ 00828000
*                                                                  0254 00829000
*   /*****************************************************************/ 00830000
*   /*                                                               */ 00831000
*   /* SAVE STATUS OF SYSTEM AS IT NOW EXISTS. IF SYSTEM STATUS      */ 00832000
*   /* CHANGES DURING PROCESSING THEN BACK OUT                       */ 00833000
*   /*                                                               */ 00834000
*   /*****************************************************************/ 00835000
*                                                                  0255 00836000
*   RFY                                                            0255 00837000
*    (R7,                                                          0255 00838000
*     R10,                                                         0255 00839000
*     R11) UNRSTD;                  /* RELEASE REGISTERS FOR USE     */ 00840000
*   SYSSTAT=CSDCPUAL;               /* COPY ALIVE MASK               */ 00841000
         L     @06,CVTPTR                                          0256 00842000
         L     @06,CVTCSD(,@06)                                    0256 00843000
         MVC   SYSSTAT(2),CSDCPUAL(@06)                            0256 00844000
*   PROCSTRT='1'B;                  /* SET ONLINE/OFFLINE PROCESSING    00845000
*                                      STARTED               @ZA24473*/ 00846000
*                                                                  0257 00847000
         OI    PROCSTRT,B'00000010'                                0257 00848000
*   /*****************************************************************/ 00849000
*   /*                                                               */ 00850000
*   /* CHECK IF ONLINE OR OFFLINE COMMAND                            */ 00851000
*   /*                                                               */ 00852000
*   /*****************************************************************/ 00853000
*                                                                  0258 00854000
*   IF ONLINE^='1'B THEN            /* VARY OFFLINE ?                */ 00855000
         TM    ONLINE,B'00100000'                                  0258 00856000
         BO    @RF00258                                            0258 00857000
*     CALL OFFLINE;                 /* PERFORM OFFLINE PROCESSING    */ 00858000
*                                                                  0259 00859000
         BAL   @14,OFFLINE                                         0259 00860000
*   /*****************************************************************/ 00861000
*   /*                                                               */ 00862000
*   /* WAS NOT OFFLINE COMMAND. MUST THEN BE ONLINE                  */ 00863000
*   /*                                                               */ 00864000
*   /*****************************************************************/ 00865000
*                                                                  0260 00866000
*   ELSE                                                           0260 00867000
*     CALL ONLINEP;                 /* PERFORM ONLINE PROCESSING     */ 00868000
*                                                                  0260 00869000
         B     @RC00258                                            0260 00870000
@RF00258 BAL   @14,ONLINEP                                         0260 00871000
*   /*****************************************************************/ 00872000
*   /*                                                               */ 00873000
*   /* ALL PROCESSING HAS BEEN PERFORMED CALL CLEANUP                */ 00874000
*   /*                                                               */ 00875000
*   /*****************************************************************/ 00876000
*                                                                  0261 00877000
*MAINEXIT:                          /* TO BE USED AFTER ESTAE HAS  0261 00878000
*                                      BEEN ESTABLISHED              */ 00879000
*   GEN(ESTAE 0);                   /* DELETE ESTAE ENVIRONMENT      */ 00880000
@RC00258 DS    0H                                                  0261 00881000
MAINEXIT ESTAE 0                                                        00882000
*MAINEXT:                           /* TO BE USED BEFORE ESTAE HAS 0262 00883000
*                                      BEEN ESTABLISHED              */ 00884000
*   CALL IEECLEAN(ADDR(WORKAREA));                                 0262 00885000
*                                                                  0262 00886000
MAINEXT  LA    @12,WORKAREA                                        0262 00887000
         ST    @12,@TF00001                                        0262 00888000
         LA    @12,@TF00001                                        0262 00889000
         ST    @12,@AL00001                                        0262 00890000
         L     @15,@CV03522                                        0262 00891000
         LA    @01,@AL00001                                        0262 00892000
         BALR  @14,@15                                             0262 00893000
*   /*****************************************************************/ 00894000
*   /*                                                               */ 00895000
*   /* RESTORE REG 14 THAT WAS SAVED AT ENTRY AND RETURN             */ 00896000
*   /*                                                               */ 00897000
*   /*****************************************************************/ 00898000
*                                                                  0263 00899000
*   RFY                                                            0263 00900000
*    (R14) RSTD;                    /* RESTRICT REG                  */ 00901000
*   R14=RETADD;                     /* RELOAD SAVED REGISTER         */ 00902000
         L     R14,RETADD                                          0264 00903000
*   RETURN;                         /* RETURN TO MASTER SCHED.       */ 00904000
@EL00001 L     @13,4(,@13)                                         0265 00905000
@EF00001 L     @00,@SIZDATD                                        0265 00906000
         LR    @01,@07                                             0265 00907000
         FREEMAIN R,LV=(0),A=(1)                                        00908000
@ER00001 BR    @14                                                 0265 00909000
*OFFLINE:                                                          0266 00910000
*   PROC;                                                          0266 00911000
*                                                                  0266 00912000
OFFLINE  STM   @14,@12,@SA00002                                    0266 00913000
*/****** OFFLINE *************************************************** */ 00914000
*/* OFFLINE ROUTINE WILL ROUTE CONTROL TO ALL ROUTINES INVOLVED IN   */ 00915000
*/* OFFLINE PROCESSING. ANY ERROR INCURED BY LOWER LEVEL ROUTINES    */ 00916000
*/* WILL BE PERCOLATED UP TO OFFLINE WHICH WILL INTURN RETURN CONTROL*/ 00917000
*/* TO MAINLINE                                                      */ 00918000
*/********************************************************************/ 00919000
*                                                                  0267 00920000
*   DO;                                                            0267 00921000
*                                                                  0267 00922000
*     /***************************************************************/ 00923000
*     /*                                                             */ 00924000
*     /* CHECK FOR CHANNEL OR CPU COMMAND                            */ 00925000
*     /*                                                             */ 00926000
*     /***************************************************************/ 00927000
*                                                                  0268 00928000
*     IF CHNIND='1'B THEN           /* CHANNEL COMMAND?              */ 00929000
         TM    CHNIND,B'10000000'                                  0268 00930000
         BNO   @RF00268                                            0268 00931000
*       DO;                                                        0269 00932000
*                                                                  0269 00933000
*/******* CHKCHNL ************************************************** */ 00934000
*/* CHKCHNL WILL VERIFY ONLINE/OFFLINE STATUS OF A SPECIFIED CHANNEL */ 00935000
*/* ROUTINE WILL USE HEXCPUAD TO LOCATE THE PROPER CAT TABLE AND     */ 00936000
*/* WILL USE HEXCHNAD TO INDEX TO THE PROPER ENTRY WITHIN THE CAT    */ 00937000
*/* TABLE.                                                           */ 00938000
*/* POSSIBLE ERROR INDICATORS ARE: OFFALRDY                          */ 00939000
*/****************************************************************** */ 00940000
*                                                                  0270 00941000
*         DO;                                                      0270 00942000
*                                                                  0270 00943000
*           /*********************************************************/ 00944000
*           /*                                                       */ 00945000
*           /* INDEX INTO PCCA VECTOR TABLE TO LOCATE PCCA ADDRESS   */ 00946000
*           /*                                                       */ 00947000
*           /*********************************************************/ 00948000
*                                                                  0271 00949000
*           PCCAPTR=PCCAT00P(HEXCPUAD+1);/* GET PCCA ADDRESS FROM  0271 00950000
*                                      TABLE                         */ 00951000
*                                                                  0271 00952000
         SLR   @12,@12                                             0271 00953000
         ICM   @12,3,HEXCPUAD                                      0271 00954000
         SLA   @12,2                                               0271 00955000
         L     @11,CVTPTR                                          0271 00956000
         L     @11,CVTPCCAT(,@11)                                  0271 00957000
         L     @12,PCCAT00P(@12,@11)                               0271 00958000
         ST    @12,PCCAPTR                                         0271 00959000
*           /*********************************************************/ 00960000
*           /*                                                       */ 00961000
*           /* GET ADDRESSABILITY TO CAT TABLE ENTRY                 */ 00962000
*           /*                                                       */ 00963000
*           /*********************************************************/ 00964000
*                                                                  0272 00965000
*           CATPTR=ADDR(PCCACAT)+(8*HEXCHNAD);/* LOCATE CHANNEL ENTRY*/ 00966000
         LA    CATPTR,PCCACAT(,@12)                                0272 00967000
         SLR   @12,@12                                             0272 00968000
         ICM   @12,3,HEXCHNAD                                      0272 00969000
         SLA   @12,3                                               0272 00970000
         ALR   CATPTR,@12                                          0272 00971000
*           IF CATNOP='1'B THEN     /* IS CHANNEL OFFLINE            */ 00972000
         TM    CATNOP(CATPTR),B'01000000'                          0273 00973000
         BNO   @RF00273                                            0273 00974000
*             OFFALRDY='1'B;        /* IF YES SET INDICATOR          */ 00975000
         OI    OFFALRDY,B'00100000'                                0274 00976000
*         END;                      /* END OF CHKCHNL                */ 00977000
*                                                                  0275 00978000
@RF00273 DS    0H                                                  0276 00979000
*         /***********************************************************/ 00980000
*         /*                                                         */ 00981000
*         /* CHECK FOR ANY ERROR FROM CHKCHNL                        */ 00982000
*         /*                                                         */ 00983000
*         /***********************************************************/ 00984000
*                                                                  0276 00985000
*         IF ERRORIND^=0 THEN       /* ANY ERRORS                    */ 00986000
         ICM   @12,15,ERRORIND                                     0276 00987000
         BNZ   @RT00276                                            0276 00988000
*           GOTO OFFEXIT;           /* RETURN TO MAINLINE            */ 00989000
*       END;                                                       0278 00990000
*                                                                  0278 00991000
*     /***************************************************************/ 00992000
*     /*                                                             */ 00993000
*     /* WAS NOT A VARY CHANNEL COMMAND. MUST THEN BE A VARY CPU     */ 00994000
*     /* COMMAND                                                     */ 00995000
*     /*                                                             */ 00996000
*     /***************************************************************/ 00997000
*                                                                  0279 00998000
*     ELSE                                                         0279 00999000
*                                                                  0279 01000000
*       /*************************************************************/ 01001000
*       /*                                                           */ 01002000
*       /* WAS A VARY CPU COMMAND THEN                               */ 01003000
*       /*                                                           */ 01004000
*       /*************************************************************/ 01005000
*                                                                  0279 01006000
*       DO;                                                        0279 01007000
*                                                                  0279 01008000
         B     @RC00268                                            0279 01009000
@RF00268 DS    0H                                                  0280 01010000
*/******* CPUSRCH ****************************************************/ 01011000
*/* CPUSRCH WILL CHECK TO DETERMINE IF THE REQUESTED CPU IS ALREADY  */ 01012000
*/* OFFLINE AND VERIFY THAT AT LEAST ONE OTHER CPU EXISTS FOR JOB    */ 01013000
*/* SCHEDULING. THE CSDCPUAL MASK AND CSDCPUJS MASKS WILL BE COMPARED*/ 01014000
*/* WITH CPUMSK FOR THE TESTS.                                       */ 01015000
*/* POSSIBLE ERROR INDICATORS ARE: OFFALRDY AND LASTCPU              */ 01016000
*/********************************************************************/ 01017000
*                                                                  0280 01018000
*         DO;                                                      0280 01019000
*                                                                  0280 01020000
*           /*********************************************************/ 01021000
*           /*                                                       */ 01022000
*           /* CHECK IF THE CPU IS OFFLINE ALREADY                   */ 01023000
*           /*                                                       */ 01024000
*           /*********************************************************/ 01025000
*                                                                  0281 01026000
*           IF(CSDCPUAL&CPUMSK)=0 THEN/* IF BIT REPRESENTING THIS CPU   01027000
*                                      IS ZERO THEN RESULT WILL BE 0281 01028000
*                                      ZERO                          */ 01029000
         L     @12,CVTPTR                                          0281 01030000
         L     @12,CVTCSD(,@12)                                    0281 01031000
         SLR   @06,@06                                             0281 01032000
         ICM   @06,3,CPUMSK                                        0281 01033000
         SLR   @04,@04                                             0281 01034000
         ICM   @04,3,CSDCPUAL(@12)                                 0281 01035000
         NR    @06,@04                                             0281 01036000
         LTR   @06,@06                                             0281 01037000
         BNZ   @RF00281                                            0281 01038000
*             OFFALRDY='1'B;        /* SET OFFALREADY INDICATOR      */ 01039000
*                                                                  0282 01040000
         OI    OFFALRDY,B'00100000'                                0282 01041000
*           /*********************************************************/ 01042000
*           /*                                                       */ 01043000
*           /* CHECK IF OTHER CPU'S EXIST FOR SCHEDULING JOBS        */ 01044000
*           /*                                                       */ 01045000
*           /*********************************************************/ 01046000
*                                                                  0283 01047000
*           IF(CSDCPUJS&&CPUMSK)=0 THEN/* BITS OTHER THAN THE ONE  0283 01048000
*                                      REPRESENTING THIS CPU MUST BE    01049000
*                                      SET ELSE RESULT IS ZERO       */ 01050000
@RF00281 L     @12,CVTPTR                                          0283 01051000
         L     @12,CVTCSD(,@12)                                    0283 01052000
         SLR   @06,@06                                             0283 01053000
         ICM   @06,3,CPUMSK                                        0283 01054000
         SLR   @04,@04                                             0283 01055000
         ICM   @04,3,CSDCPUJS(@12)                                 0283 01056000
         XR    @06,@04                                             0283 01057000
         LTR   @06,@06                                             0283 01058000
         BNZ   @RF00283                                            0283 01059000
*             LASTCPU='1'B;         /* SET LAST CPU INDICATOR        */ 01060000
         OI    LASTCPU,B'00010000'                                 0284 01061000
*         END;                      /* END OF CPU SRCH               */ 01062000
*                                                                  0285 01063000
@RF00283 DS    0H                                                  0286 01064000
*         /***********************************************************/ 01065000
*         /*                                                         */ 01066000
*         /* CHECK FOR ANY ERRORS                                    */ 01067000
*         /*                                                         */ 01068000
*         /***********************************************************/ 01069000
*                                                                  0286 01070000
*         IF ERRORIND^=0 THEN       /* ANY ERRORS?                   */ 01071000
         ICM   @12,15,ERRORIND                                     0286 01072000
         BNZ   @RT00286                                            0286 01073000
*           GOTO OFFEXIT;           /* RETURN TO MAINLINE            */ 01074000
*/******* AFFINSRC ************************************************* */ 01075000
*/* AFFINSRC WILL SCAN THROUGH THE ADDRESS SPACE VECTOR TABLE SEARCH-*/ 01076000
*/* ING FOR ALL ACTIVE ASCBS. ALL ACTIVE ASCB'S WILL BE CHECKED FOR  */ 01077000
*/* AFFINITY TO THE CPU TO GO OFFLINE. A COUNT WILL BE KEPT OF ALL   */ 01078000
*/* JOBS FOUND WITH AFFINITY AND THE OPERATOR WILL BE GIVEN THE      */ 01079000
*/* OPPORTUNITY OF CANCELING THE OFFLINE COMMAND OR LEAVING THE CPU  */ 01080000
*/* UNAVAILABLE FOR SCHEDULING ANY NEW JOBS TO THE SPECIFIED CPU     */ 01081000
*/* POSSIBLE ERROR INDICATORS ARE: AFFINSW                           */ 01082000
*/****************************************************************   */ 01083000
*                                                                  0288 01084000
*         DO;                                                      0288 01085000
*                                                                  0288 01086000
*           /*********************************************************/ 01087000
*           /*                                                       */ 01088000
*           /* OBTAIN JOB SCHEDULING RESOURCE                        */ 01089000
*           /*                                                       */ 01090000
*           /*********************************************************/ 01091000
*                                                                  0289 01092000
*           GEN(ENQ (JOBSCDQ,JOBSCDR,E,8,SYSTEM));/* ENQ ON JOB SCHED   01093000
*                                      RESOURCE                      */ 01094000
         ENQ (JOBSCDQ,JOBSCDR,E,8,SYSTEM)                               01095000
*           CSDENQ='1'B;            /* SET ENQ FOOTPRINT             */ 01096000
         OI    CSDENQ,B'00001000'                                  0290 01097000
*           JOBSHED='1'B;           /* SET ENQ FOOTPRINT             */ 01098000
*                                                                  0291 01099000
         OI    JOBSHED,B'00000001'                                 0291 01100000
*           /*********************************************************/ 01101000
*           /*                                                       */ 01102000
*           /* RESET JOB SCHEDULER BIT REPRESENTING CPU TO BE REMOVED*/ 01103000
*           /*                                                       */ 01104000
*           /*********************************************************/ 01105000
*                                                                  0292 01106000
*           CSDCPUJS=CSDCPUJS&      /* CPUJS(I) = 0          @G47AN2O*/ 01107000
*               (CPUMSK&&FLIP);     /*                       @G47AN2O*/ 01108000
*                                                                  0292 01109000
         L     @12,CVTPTR                                          0292 01110000
         L     @12,CVTCSD(,@12)                                    0292 01111000
         SLR   @06,@06                                             0292 01112000
         ICM   @06,3,CPUMSK                                        0292 01113000
         X     @06,@CF03528                                        0292 01114000
         SLR   @04,@04                                             0292 01115000
         ICM   @04,3,CSDCPUJS(@12)                                 0292 01116000
         NR    @06,@04                                             0292 01117000
         STH   @06,CSDCPUJS(,@12)                                  0292 01118000
*           /*********************************************************/ 01119000
*           /*                                                       */ 01120000
*           /* GET DISPATCHER LOCK TO PREVENT ASCB'S FROM CHANGING   */ 01121000
*           /* DURING OUR SCAN                                       */ 01122000
*           /*                                                       */ 01123000
*           /*********************************************************/ 01124000
*                                                                  0293 01125000
*           GENERATE;                                              0293 01126000
*                                                                  0293 01127000
   SETLOCK    OBTAIN,TYPE=DISP,REGS=USE,MODE=UNCOND,RELATED=('IEEVCPU,XX01128000
               AFFINSRC, LOCK IS RELEASED IN THIS ROUTINE')             01129000
*           /*********************************************************/ 01130000
*           /*                                                       */ 01131000
*           /* SET UP DO LOOP TO SCAN THROUGH ASVT TABLE SEARCHING   */ 01132000
*           /* ALL ASCBS                                             */ 01133000
*           /*                                                       */ 01134000
*           /*********************************************************/ 01135000
*                                                                  0294 01136000
*           DO LOOPCNT=1 TO ASVTMAXU;/* SCAN THROUGH VECTOR TABLE    */ 01137000
         LA    @12,1                                               0294 01138000
         B     @DE00294                                            0294 01139000
@DL00294 DS    0H                                                  0295 01140000
*             ASCBPTR=ASVTENTY(LOOPCNT);/* ADDRESSABILITY TO ASCB    */ 01141000
*                                                                  0295 01142000
         SLA   @12,2                                               0295 01143000
         L     @06,CVTPTR                                          0295 01144000
         L     @04,ASVTPTR(,@06)                                   0295 01145000
         L     ASCBPTR,ASVTENTY-4(@12,@04)                         0295 01146000
*             /*******************************************************/ 01147000
*             /*                                                     */ 01148000
*             /* VERIFY THAT THIS ADDRESS SPACE EXISTS AND IS IN USE */ 01149000
*             /*                                                     */ 01150000
*             /*******************************************************/ 01151000
*                                                                  0296 01152000
*             IF ASVTAVAL(LOOPCNT)='0'B&ASCBPTR^=0 THEN/* VALID    0296 01153000
*                                      ENTRY?                        */ 01154000
*                                                                  0296 01155000
         ALR   @04,@12                                             0296 01156000
         TM    ASVTAVAL-4(@04),B'10000000'                         0296 01157000
         BNZ   @RF00296                                            0296 01158000
         SLR   @12,@12                                             0296 01159000
         CR    ASCBPTR,@12                                         0296 01160000
         BE    @RF00296                                            0296 01161000
*               /*****************************************************/ 01162000
*               /*                                                   */ 01163000
*               /* CHECK IF OTHER CPU'S EXIST THAT CAN PERFORM WORK  */ 01164000
*               /* IN THIS ADDRESS SPACE. IF NOT THEN INCREMENT      */ 01165000
*               /* AFFINJOB COUNT AND SET ERROR FLAG                 */ 01166000
*               /*                                                   */ 01167000
*               /*****************************************************/ 01168000
*                                                                  0297 01169000
*               IF(ASCBAFFN&CSDCPUJS)=0 THEN/* IS THIS THE ONLY CPU? */ 01170000
         L     @06,CVTCSD(,@06)                                    0297 01171000
         SLR   @04,@04                                             0297 01172000
         ICM   @04,3,CSDCPUJS(@06)                                 0297 01173000
         SLR   @06,@06                                             0297 01174000
         ICM   @06,3,ASCBAFFN(ASCBPTR)                             0297 01175000
         NR    @04,@06                                             0297 01176000
         CR    @04,@12                                             0297 01177000
         BNE   @RF00297                                            0297 01178000
*                 DO;                                              0298 01179000
*                   AFFINSWT='1'B;  /* SET AFFINITY SWITCH           */ 01180000
         OI    AFFINSWT,B'00001000'                                0299 01181000
*                   AFFINJOB=EVAL(AFFINJOB+1);/* INCR COUNT OF     0300 01182000
*                                      AFFINITY JOBS                 */ 01183000
         LA    @12,1                                               0300 01184000
         SLR   @06,@06                                             0300 01185000
         ICM   @06,3,AFFINJOB                                      0300 01186000
         ALR   @12,@06                                             0300 01187000
         STH   @12,AFFINJOB                                        0300 01188000
*                 END;                                             0301 01189000
*           END;                    /* END OF ASCB SCAN DO LOOP      */ 01190000
@RF00297 DS    0H                                                  0302 01191000
@RF00296 LA    @12,1                                               0302 01192000
         AL    @12,LOOPCNT                                         0302 01193000
@DE00294 ST    @12,LOOPCNT                                         0302 01194000
         L     @06,CVTPTR                                          0302 01195000
         L     @06,ASVTPTR(,@06)                                   0302 01196000
         C     @12,ASVTMAXU(,@06)                                  0302 01197000
         BNH   @DL00294                                            0302 01198000
*           GEN                                                    0303 01199000
*(SETLOCK  RELEASE,TYPE=DISP,REGS=USE,RELATED=(IEEVCPU,AFFIN));    0303 01200000
         SETLOCK  RELEASE,TYPE=DISP,REGS=USE,RELATED=(IEEVCPU,AFFIN)    01201000
*           IF AFFINSWT='1'B THEN   /* ANY JOBS FOUND WITH AFFINITY? */ 01202000
         TM    AFFINSWT,B'00001000'                                0304 01203000
         BNO   @RF00304                                            0304 01204000
*             DO;                                                  0305 01205000
*                                                                  0305 01206000
*               /*****************************************************/ 01207000
*               /*                                                   */ 01208000
*               /* JOBS HAVE BEEN FOUND WITH AFFINITY. ALLOW JOB     */ 01209000
*               /* SCHEDULING AND INFORM OPERATOR OF CONDITION.      */ 01210000
*               /* OPERATOR WILL BE GIVEN THE OPPORTUNITY TO EITHER  */ 01211000
*               /* TERMINATE THE COMMAND, OR MARK CPU UNAVAILABLE FOR*/ 01212000
*               /* FURTHER JOB SCHEDULING                            */ 01213000
*               /*                                                   */ 01214000
*               /*****************************************************/ 01215000
*                                                                  0306 01216000
*               CSDCPUJS=CSDCPUJS|CPUMSK;/* CPUJS(I) = 1     @G47AN2O*/ 01217000
         L     @12,CVTPTR                                          0306 01218000
         L     @12,CVTCSD(,@12)                                    0306 01219000
         SLR   @06,@06                                             0306 01220000
         ICM   @06,3,CPUMSK                                        0306 01221000
         SLR   @04,@04                                             0306 01222000
         ICM   @04,3,CSDCPUJS(@12)                                 0306 01223000
         OR    @06,@04                                             0306 01224000
         STH   @06,CSDCPUJS(,@12)                                  0306 01225000
*               GEN(DEQ  (JOBSCDQ,JOBSCDR,8,SYSTEM));/* RELEASE ENQ     01226000
*                                      TO ALLOW JOB SCHEDULING       */ 01227000
         DEQ  (JOBSCDQ,JOBSCDR,8,SYSTEM)                                01228000
*               CSDENQ='0'B;        /* RESET FOOTPRINT               */ 01229000
         NI    CSDENQ,B'11110111'                                  0308 01230000
*               RFY                                                0309 01231000
*                (R6) RSTD;         /* RESTRICT REG 6                */ 01232000
*               R6=ADDR(WORKAREA);  /* ADDRESSABILITY FOR COMMON WORK   01233000
*                                      AREA                          */ 01234000
         LA    R6,WORKAREA                                         0310 01235000
*               CALL WTORT(1);      /* WRITE AFFINITY FOUND MESSAGE  */ 01236000
         L     @15,@CV03525                                        0311 01237000
         LA    @01,@AL00311                                        0311 01238000
         BALR  @14,@15                                             0311 01239000
*               RFY                                                0312 01240000
*                (R6) UNRSTD;       /* RELEASE REG 6                 */ 01241000
*AFFREPLY:                          /* ISSUE WTOR FOR OPERATOR REPLY */ 01242000
*               WTOECB=0;           /* ZERO OUT ECB                  */ 01243000
AFFREPLY SLR   @12,@12                                             0313 01244000
         ST    @12,WTOECB                                          0313 01245000
*               REPLY='';           /* BLANK OUT REPLY BUFFER        */ 01246000
         MVI   REPLY,C' '                                          0314 01247000
         MVC   REPLY+1(7),REPLY                                    0314 01248000
*               WTORPL1=WTOR1;      /* COPY PARMS INTO PARM LIST     */ 01249000
         MVC   WTORPL1(85),WTOR1                                   0315 01250000
*               GEN(WTOR  ,REPLY,,WTOECB,MF=(E,WTORPL1));/* WTOR     */ 01251000
*                                                                  0316 01252000
         WTOR  ,REPLY,,WTOECB,MF=(E,WTORPL1)                            01253000
*               /*****************************************************/ 01254000
*               /*                                                   */ 01255000
*               /* WAIT ON REPLY FROM OPERATOR                       */ 01256000
*               /*                                                   */ 01257000
*               /*****************************************************/ 01258000
*                                                                  0317 01259000
*               GEN(WAIT  ECB=WTOECB);/* WAIT FOR REPLY              */ 01260000
*                                                                  0317 01261000
         WAIT  ECB=WTOECB                                               01262000
*               /*****************************************************/ 01263000
*               /*                                                   */ 01264000
*               /* CHECK OPERATORS RESPONSE. IF INVALID REISSUE WTOR,*/ 01265000
*               /* IF OPERATOR REPLY IS YES THEN MARK CPU UNAVAILABLE*/ 01266000
*               /* IN CSD, ELSE SET REPLY PROCESSED FLAG AND RETURN  */ 01267000
*               /* TO NEXT HIGHER LEVEL OF CONTROL                   */ 01268000
*               /*                                                   */ 01269000
*               /*****************************************************/ 01270000
*                                                                  0318 01271000
*               IF REPLY^='YES'&REPLY^='NO ' THEN/* VALID REPLY?     */ 01272000
         CLC   REPLY(3),@CC03639                                   0318 01273000
         BE    @RF00318                                            0318 01274000
         CLC   REPLY(3),@CC03640                                   0318 01275000
         BNE   @RT00318                                            0318 01276000
*                 GOTO AFFREPLY;    /* REISSUE WTOR                  */ 01277000
*                                                                  0319 01278000
*               /*****************************************************/ 01279000
*               /*                                                   */ 01280000
*               /* REPLY IS VALID CHECK FOR RESPONSE                 */ 01281000
*               /*                                                   */ 01282000
*               /*****************************************************/ 01283000
*                                                                  0320 01284000
*               IF REPLY='NO' THEN  /* CANCEL COMMAND                */ 01285000
@RF00318 CLC   REPLY(2),@CC03641                                   0320 01286000
         BNE   @RF00320                                            0320 01287000
*                 DO;                                              0321 01288000
*                   OPERCNCL='1'B;  /* SET OPERATOR CANCEL FLAG      */ 01289000
         OI    OPERCNCL,B'00100000'                                0322 01290000
*                   REPLYP='1'B;    /* SET REPLY PROCESSED FLAG      */ 01291000
         OI    REPLYP,B'00010000'                                  0323 01292000
*                 END;                                             0324 01293000
*                                                                  0324 01294000
*               /*****************************************************/ 01295000
*               /*                                                   */ 01296000
*               /* OPERATOR REPLY WAS NOT 'NO' MUST HAVE BEEN 'YES'  */ 01297000
*               /* THEN                                              */ 01298000
*               /*                                                   */ 01299000
*               /*****************************************************/ 01300000
*                                                                  0325 01301000
*               ELSE                                               0325 01302000
*                 DO;                                              0325 01303000
*                                                                  0325 01304000
         B     @RC00320                                            0325 01305000
@RF00320 DS    0H                                                  0326 01306000
*                   /*************************************************/ 01307000
*                   /*                                               */ 01308000
*                   /* SET CPU UNAVAILABLE FOR FURTHER JOB SCHEDULING*/ 01309000
*                   /*                                               */ 01310000
*                   /*************************************************/ 01311000
*                                                                  0326 01312000
*                   GEN(ENQ (JOBSCDQ,JOBSCDR,E,8,SYSTEM));/* ENQ ON     01313000
*                                      JOB SCHED                     */ 01314000
         ENQ (JOBSCDQ,JOBSCDR,E,8,SYSTEM)                               01315000
*                   CSDENQ='1'B;    /* SET FOOTPRINT                 */ 01316000
         OI    CSDENQ,B'00001000'                                  0327 01317000
*                   CSDCPUJS=CSDCPUJS&/* CPUJS(I) = 0        @G47AN2O*/ 01318000
*                       (CPUMSK&&FLIP);/*                    @G47AN2O*/ 01319000
         L     @12,CVTPTR                                          0328 01320000
         L     @12,CVTCSD(,@12)                                    0328 01321000
         SLR   @06,@06                                             0328 01322000
         ICM   @06,3,CPUMSK                                        0328 01323000
         X     @06,@CF03528                                        0328 01324000
         SLR   @04,@04                                             0328 01325000
         ICM   @04,3,CSDCPUJS(@12)                                 0328 01326000
         NR    @06,@04                                             0328 01327000
         STH   @06,CSDCPUJS(,@12)                                  0328 01328000
*                   GEN(DEQ (JOBSCDQ,JOBSCDR,8,SYSTEM));/* RELEASE 0329 01329000
*                                      RESOURCE                      */ 01330000
         DEQ (JOBSCDQ,JOBSCDR,8,SYSTEM)                                 01331000
*                   CSDENQ='0'B;    /* RESET FOOTPRINT               */ 01332000
         NI    CSDENQ,B'11110111'                                  0330 01333000
*                   REPLYP='1'B;    /* SET REPLY PROCESSED BIT       */ 01334000
         OI    REPLYP,B'00010000'                                  0331 01335000
*                 END;                                             0332 01336000
*             END;                  /* END OF OPERATOR REPLY ROUTINE */ 01337000
*                                                                  0333 01338000
*           /*********************************************************/ 01339000
*           /*                                                       */ 01340000
*           /* NO JOBS WERE FOUND WITH AFFINITY. RELEASE ENQ AND     */ 01341000
*           /* CONTINUE PROCESSING                                   */ 01342000
*           /*                                                       */ 01343000
*           /*********************************************************/ 01344000
*                                                                  0334 01345000
*           ELSE                                                   0334 01346000
*             GEN(DEQ  (JOBSCDQ,JOBSCDR,8,SYSTEM));/* RELEASE      0334 01347000
*                                      RESOURCE                      */ 01348000
         B     @RC00304                                            0334 01349000
@RF00304 DS    0H                                                  0334 01350000
         DEQ  (JOBSCDQ,JOBSCDR,8,SYSTEM)                                01351000
*           CSDENQ='0'B;            /* RESET FOOTPRINT               */ 01352000
@RC00304 NI    CSDENQ,B'11110111'                                  0335 01353000
*AFINEXIT:                                                         0336 01354000
*         END;                      /* END OF AFFINITY SCAN ROUTINE  */ 01355000
AFINEXIT DS    0H                                                  0337 01356000
*         IF ERRORIND^=0 THEN       /* ANY ERRORS?                   */ 01357000
         ICM   @12,15,ERRORIND                                     0337 01358000
         BNZ   @RT00337                                            0337 01359000
*           GOTO OFFEXIT;           /* RETURN TO MAINLINE            */ 01360000
*       END;                        /* END OF SPECIAL CPU PROCESSING */ 01361000
*     IF CPUCRH^='1'B THEN                                         0340 01362000
*                                                                  0340 01363000
@RC00268 TM    CPUCRH,B'00000001'                                  0340 01364000
         BO    @RF00340                                            0340 01365000
*       /*************************************************************/ 01366000
*       /*                                                           */ 01367000
*       /* SCAN SYSTEM DEVICES TO DETERMINE WHICH DEVICES SHOULD BE  */ 01368000
*       /* TAKEN OFFLINE WITH THE CPU OR CHANNEL                     */ 01369000
*       /*                                                           */ 01370000
*       /*************************************************************/ 01371000
*                                                                  0341 01372000
*       IF PCCAT00P(HEXCPUAD+1)->   /* PCCA FOR THIS CPU     @G47AN2O*/ 01373000
*           PCCAIO=HASIO            /* CPU HAS CHANNELS      @G47AN2O   01374000
*                                      ONLINE                @G47AN2O*/ 01375000
*         THEN                      /* PERFORM DEVPREP FCN   @G47AN2O*/ 01376000
         SLR   @12,@12                                             0341 01377000
         ICM   @12,3,HEXCPUAD                                      0341 01378000
         SLA   @12,2                                               0341 01379000
         L     @06,CVTPTR                                          0341 01380000
         L     @06,CVTPCCAT(,@06)                                  0341 01381000
         L     @12,PCCAT00P(@12,@06)                               0341 01382000
         TM    PCCAIO(@12),B'01000000'                             0341 01383000
         BNO   @RF00341                                            0341 01384000
*/**** DEVPREP ***************************************************** */ 01385000
*/* DEVPREP WILL SCAN ALL UCB'S IN THE SYSTEM TO DETERMINE WHICH     */ 01386000
*/* DEVICES WILL BE AFFECTED BY A CHANGE OF ONLINE TO OFFLINE STATUS */ 01387000
*/* OF A CHANNEL OR CPU. ANY DEVICES THAT WILL BE AFFECTED WILL BE   */ 01388000
*/* INTERROGATED FOR ONLINE/ALLOCATED/NALLOC/OR CONSOLE STATUS       */ 01389000
*/* A RECORDER BLOCK WILL BE BUILT FOR ANY DEVICE THAT MAY BE        */ 01390000
*/* AFFECTED. ANY ERRORS ENCOUNTERED WILL CAUSE THE SCAN TO BE       */ 01391000
*/* TERMINATED AND CONTROL RETURNED TO THE NEXT HIGHER LEVEL OF      */ 01392000
*/* CONTROL.                                                         */ 01393000
*/* POSSIBLE ERROR INDICATORS THAT MAY BE SET IN DEVPREP ARE:        */ 01394000
*/* LASTPATH, NOCORE                                                 */ 01395000
*/********************************************************************/ 01396000
*                                                                  0342 01397000
*         DO;                                                      0342 01398000
*ENQLOOP:                                                          0343 01399000
*                                                                  0343 01400000
*           /*********************************************************/ 01401000
*           /*                                                       */ 01402000
*           /* ENQ EXCLUSIVE WITH ECB. ATTEMPT ENQ AND IF            */ 01403000
*           /* UNSUCCESSFUL WAIT 5 SECONDS, IF RESOURCE HAS NOT BEEN */ 01404000
*           /* OBTAINED AFTER 5 SECONDS THEN RELEASE ENQ TO ALLOW    */ 01405000
*           /* SHARED REQUESTS TO BE SATISIFIED AND ATTEMPT ENQ AGAIN*/ 01406000
*           /*                                                       */ 01407000
*           /*********************************************************/ 01408000
*                                                                  0343 01409000
*           RFY                                                    0343 01410000
*            (R1,                                                  0343 01411000
*             RETCODE) RSTD;        /* RESTRICT REGISTERS            */ 01412000
ENQLOOP  DS    0H                                                  0344 01413000
*           ENQECB=0;               /* ZERO OUT ECB BEFORE ENQ       */ 01414000
         SLR   @12,@12                                             0344 01415000
         ST    @12,ENQECB                                          0344 01416000
*           DO;                     /* ENQ                         0345 01417000
*                                      (UCBENQQ,UCBENQR,E,2,SYSTEM)     01418000
*                                      ECB(ENQECB)                   */ 01419000
*             RESPECIFY                                            0346 01420000
*              (GPR01P) RESTRICTED;                                0346 01421000
*             I056(1:16)=I056(1:16)&&I056(1:16);/* ZERO OUT THE TABLE*/ 01422000
         XC    I056(16),I056                                       0347 01423000
*             I05604(1)=2;          /* LENGTH OF MINOR RESOURCE NAME */ 01424000
         MVI   I05604,X'02'                                        0348 01425000
*             I05606(1)=ADDR(UCBENQQ);/* ADDRESS OF MAJOR RESOURCE 0349 01426000
*                                      NAME                          */ 01427000
         LA    @12,UCBENQQ                                         0349 01428000
         ST    @12,I05606                                          0349 01429000
*             I05607(1)=ADDR(UCBENQR);/* ADDRESS OF MINOR RESOURCE 0350 01430000
*                                      NAME                          */ 01431000
         LA    @12,UCBENQR                                         0350 01432000
         ST    @12,I05607                                          0350 01433000
*             I05603(1)='01000000'B;/* SET BIT STRING 1 FOR RESOURCE    01434000
*                                      ELEMENT                       */ 01435000
         MVI   I05603,B'01000000'                                  0351 01436000
*             I05605(1)='01000100'B;/* SET BIT STRING 2 FOR RESOURCE    01437000
*                                      ELEMENT                       */ 01438000
         MVI   I05605,B'01000100'                                  0352 01439000
*             I05601=ADDR(ENQECB);  /* ECB ADDRESS                   */ 01440000
         LA    @12,ENQECB                                          0353 01441000
         ST    @12,I05601                                          0353 01442000
*             I05603(1,1)='1'B;     /* SET END OF LIST BIT           */ 01443000
         OI    I05603,B'10000000'                                  0354 01444000
*             GPR01P=ADDR(I05602);  /* LOAD LIST ADDRESS             */ 01445000
         LA    GPR01P,I05602                                       0355 01446000
*             SVC(56);              /* ISSUE ENQ SVC                 */ 01447000
         SVC   56                                                  0356 01448000
*             RESPECIFY                                            0357 01449000
*              (GPR01P) UNRESTRICTED;                              0357 01450000
*           END;                    /* ENQ                         0358 01451000
*                                      (UCBENQQ,UCBENQR,E,2,SYSTEM)     01452000
*                                      ECB(ENQECB) ECB ENQ           */ 01453000
*                                                                  0358 01454000
*           /*********************************************************/ 01455000
*           /*                                                       */ 01456000
*           /* CHECK RETURN CODE. IF RESOURCE HAS BEEN OBTAINED THEN */ 01457000
*           /* CONTINUE PROCESSING ELSE WAIT 5 SECONDS               */ 01458000
*           /*                                                       */ 01459000
*           /*********************************************************/ 01460000
*                                                                  0359 01461000
*           IF RETCODE^=0 THEN      /* DID WE GET RESOURCE?          */ 01462000
         LTR   RETCODE,RETCODE                                     0359 01463000
         BZ    @RF00359                                            0359 01464000
*             DO;                                                  0360 01465000
*               GEN(STIMER   WAIT,BINTVL=SEC5);/* WAIT 5 SECONDS     */ 01466000
*                                                                  0361 01467000
         STIMER   WAIT,BINTVL=SEC5                                      01468000
*               /*****************************************************/ 01469000
*               /*                                                   */ 01470000
*               /* IF RESOURCE HAS NOT BEEN OBTAINED AFTER 5 SECONDS */ 01471000
*               /* THEN DEQ TO ALLOW ANY SHARED REQUESTS TO BE       */ 01472000
*               /* PROCESSED AND ATTEMPT ENQ AGAIN                   */ 01473000
*               /*                                                   */ 01474000
*               /*****************************************************/ 01475000
*                                                                  0362 01476000
*               IF POSTBIT^='1'B THEN/* POST SUCCESSFUL?             */ 01477000
         TM    POSTBIT,B'01000000'                                 0362 01478000
         BO    @RF00362                                            0362 01479000
*                 DO;                                              0363 01480000
*                   GEN(DEQ  (UCBENQQ,UCBENQR,2,SYSTEM));/* RELEASE     01481000
*                                      SYSTEM RESOURCE               */ 01482000
         DEQ  (UCBENQQ,UCBENQR,2,SYSTEM)                                01483000
*                   GOTO ENQLOOP;   /* RETRY ENQ                     */ 01484000
         B     ENQLOOP                                             0365 01485000
*                 END;                                             0366 01486000
*               RFY                                                0367 01487000
*                (R1,                                              0367 01488000
*                 RETCODE) UNRSTD;                                 0367 01489000
@RF00362 DS    0H                                                  0368 01490000
*             END;                  /* END OF ENQ LOOP               */ 01491000
*           UCBENQ='1'B;            /* SET ENQ FOOTPRINT             */ 01492000
*                                                                  0369 01493000
@RF00359 OI    UCBENQ,B'00000010'                                  0369 01494000
*           /*********************************************************/ 01495000
*           /*                                                       */ 01496000
*           /* SET UP PARAMETERS FOR IEEVDEV THAT ARE COMMON FOR THIS*/ 01497000
*           /* ROUTINE                                               */ 01498000
*           /*                                                       */ 01499000
*           /*********************************************************/ 01500000
*                                                                  0370 01501000
*           DEVSUBCP=HEXCPU1;       /* CPU ADDRESS BEING REMOVED     */ 01502000
         MVC   DEVSUBCP(1),HEXCPU1                                 0370 01503000
*           DEVSUBCH=HEXCHN1;       /* CHANNEL ADDRESS BEING REMOVED */ 01504000
         MVC   DEVSUBCH(1),HEXCHN1                                 0371 01505000
*           LINKPTR=ADDR(DEVSUBP);  /* SET UP POINTER TO PARAMETERS  */ 01506000
*                                                                  0372 01507000
         LA    @12,DEVSUBP                                         0372 01508000
         ST    @12,LINKPTR                                         0372 01509000
*           /*********************************************************/ 01510000
*           /*                                                       */ 01511000
*           /* LOAD MODULE IEEVDEV AND SAVE ADDRESS FOR BRANCH ENTRY */ 01512000
*           /*                                                       */ 01513000
*           /*********************************************************/ 01514000
*                                                                  0373 01515000
*           GEN(LOAD  EP=IEEVDEV);  /* LOAD IEEVDEV                  */ 01516000
         LOAD  EP=IEEVDEV                                               01517000
*           RFY                                                    0374 01518000
*            (R0) RSTD;             /* RESTRICT REG 0                */ 01519000
*           DEVADDR=R0;             /* SAVE IEEVDEV ADDRESS          */ 01520000
         ST    R0,DEVADDR                                          0375 01521000
*           RFY                                                    0376 01522000
*            (R0) UNRSTD;           /* RELEASE REGISTER              */ 01523000
*                                                                  0376 01524000
*           /*********************************************************/ 01525000
*           /*                                                       */ 01526000
*           /* SET UP COMMON PARAMETER LIST FOR IECVIOPM     @ZA00078*/ 01527000
*           /*                                                       */ 01528000
*           /*********************************************************/ 01529000
*                                                                  0377 01530000
*           PATHFC=0;               /* SET FUNCTION CODE TO INDICATE    01531000
*                                      OPERATIONAL PATH TEST @ZA00078*/ 01532000
*                                                                  0377 01533000
         MVI   PATHFC,X'00'                                        0377 01534000
*           /*********************************************************/ 01535000
*           /*                                                       */ 01536000
*           /* LOAD IECVIOPM AND SAVE ENTRY POINT ADDRESS    @ZA00078*/ 01537000
*           /*                                                       */ 01538000
*           /*********************************************************/ 01539000
*                                                                  0378 01540000
*           GEN(LOAD  EP=IECVIOPM); /* LOAD IECVIOPM         @ZA00078*/ 01541000
         LOAD  EP=IECVIOPM                                              01542000
*           RFY                                                    0379 01543000
*             R0 RSTD;              /* RESTRICT REGISTER     @ZA00078*/ 01544000
*           PATHADDR=R0;            /* SAVE IECVIOPM ADDRESS @ZA00078*/ 01545000
         ST    R0,PATHADDR                                         0380 01546000
*           RFY                                                    0381 01547000
*             R0 UNRSTD;            /* RELEASE REGISTER      @ZA00078*/ 01548000
*                                                                  0381 01549000
*           /*********************************************************/ 01550000
*           /*                                                       */ 01551000
*           /* SET UP DOLOOP TO SCAN ALL UCB'S TILL END OF LOOKUP    */ 01552000
*           /* TABLE IS REACHED                                      */ 01553000
*           /*                                                       */ 01554000
*           /*********************************************************/ 01555000
*                                                                  0382 01556000
*           DO UCBLKPTR=CVTILK2 BY 2 WHILE(UCBTAB^='FFFF'X);       0382 01557000
*                                                                  0382 01558000
         L     @12,CVTPTR                                          0382 01559000
         L     @12,CVTILK2(,@12)                                   0382 01560000
         ST    @12,UCBLKPTR                                        0382 01561000
         B     @DE00382                                            0382 01562000
@DL00382 DS    0H                                                  0383 01563000
*             /*******************************************************/ 01564000
*             /*                                                     */ 01565000
*             /* CHECK FOR DUMMY TABLE ENTRY AND IF SO SKIP TO NEXT  */ 01566000
*             /* ENTRY                                               */ 01567000
*             /*                                                     */ 01568000
*             /*******************************************************/ 01569000
*                                                                  0383 01570000
*             IF UCBTAB='0000'X THEN/* CHECK FOR DUMMY TABLE ENTRY   */ 01571000
         L     @12,UCBLKPTR                                        0383 01572000
         SLR   @06,@06                                             0383 01573000
         ICM   @06,3,UCBTAB(@12)                                   0383 01574000
         LTR   @06,@06                                             0383 01575000
         BZ    @RT00383                                            0383 01576000
*               GOTO ENDLOOP;       /* SKIP PROCESSING STEP TO NEXT     01577000
*                                      ENTRY                         */ 01578000
*             UCBPTR=UCBTAB;        /* PICK UP ADDRESS OF UCB        */ 01579000
*                                                                  0385 01580000
         ST    @06,UCBPTR                                          0385 01581000
*             /*******************************************************/ 01582000
*             /*                                                     */ 01583000
*             /* IF THIS IS A 2305 AND NOT THE BASE UCB THEN SKIP TO */ 01584000
*             /* NEXT ENTRY                                          */ 01585000
*             /*                                                     */ 01586000
*             /*******************************************************/ 01587000
*                                                                  0386 01588000
*             IF(UCBMTPXP='1'B)&(UCBBASE^=UCBPTR-512) THEN/* NOT 2305*/ 01589000
         TM    UCBMTPXP(@06),B'00001000'                           0386 01590000
         BNO   @RF00386                                            0386 01591000
         LR    @12,@06                                             0386 01592000
         SH    @12,@CH01762                                        0386 01593000
         C     @12,UCBBASE(,@06)                                   0386 01594000
         BNE   @RT00386                                            0386 01595000
*               GOTO ENDLOOP;       /* SKIP TO NEXT UCB ENTRY        */ 01596000
*                                                                  0387 01597000
*             /*******************************************************/ 01598000
*             /*                                                     */ 01599000
*             /* CHECK IF DEVICE IS ALREADY OFFLINE FOR HIER REASONS */ 01600000
*             /* AND IF SO STEP TO NEXT UCB ENTRY                    */ 01601000
*             /*                                                     */ 01602000
*             /*******************************************************/ 01603000
*                                                                  0388 01604000
*             IF UCBVHRSN='1'B THEN /* DEVICE IS OFFLINE FOR HIERACHY*/ 01605000
@RF00386 L     @12,UCBPTR                                          0388 01606000
         TM    UCBVHRSN(@12),B'00000010'                           0388 01607000
         BO    @RT00388                                            0388 01608000
*               GOTO ENDLOOP;       /* SKIP TO NEXT ENTRY            */ 01609000
*                                                                  0389 01610000
*             /*******************************************************/ 01611000
*             /*                                                     */ 01612000
*             /* SET UP UCB ADDRESS IN IEEVDEV PARMS                 */ 01613000
*             /*                                                     */ 01614000
*             /*******************************************************/ 01615000
*                                                                  0390 01616000
*             DEVSUBUB=UCBPTR;      /* ADDRESS OF UCB COMMON SEGEMENT*/ 01617000
*                                                                  0390 01618000
         ST    @12,DEVSUBUB                                        0390 01619000
*             /*******************************************************/ 01620000
*             /*                                                     */ 01621000
*             /* SET UP FUNCTION CODE FOR CHANNEL OR CPU COMMAND     */ 01622000
*             /* DETERMINE IF THE SPECIFIED SYSTEM RESOURCE          */ 01623000
*             /* (CHANNEL/CPU) IS INVOLVED WITH THIS DEVICE.         */ 01624000
*             /*                                                     */ 01625000
*             /*******************************************************/ 01626000
*                                                                  0391 01627000
*             IF CHNIND='1'B THEN   /* CHANNEL COMMAND?              */ 01628000
         TM    CHNIND,B'10000000'                                  0391 01629000
         BNO   @RF00391                                            0391 01630000
*               DEVSUBFC=4;         /* SET FUNCTION CODE 4           */ 01631000
*                                                                  0392 01632000
         MVI   DEVSUBFC,X'04'                                      0392 01633000
*             /*******************************************************/ 01634000
*             /*                                                     */ 01635000
*             /* COMMAND WAS VARY CPU                                */ 01636000
*             /*                                                     */ 01637000
*             /*******************************************************/ 01638000
*                                                                  0393 01639000
*             ELSE                                                 0393 01640000
*               DEVSUBFC=3;         /* SET FUNCTION CODE 3           */ 01641000
         B     @RC00391                                            0393 01642000
@RF00391 MVI   DEVSUBFC,X'03'                                      0393 01643000
*             RFY                                                  0394 01644000
*              (R1,                                                0394 01645000
*               R14,                                               0394 01646000
*               R15,                                               0394 01647000
*               RETCODE) RSTD;      /* RESTRICT REGS                 */ 01648000
@RC00391 DS    0H                                                  0395 01649000
*             R1=ADDR(LINKPTR);     /* POINT TO PARMS                */ 01650000
         LA    R1,LINKPTR                                          0395 01651000
*             DEVSUBGO='1'B;        /* SET FOOTPRINT                 */ 01652000
         OI    DEVSUBGO,B'00010000'                                0396 01653000
*             R15=DEVADDR;          /* ADDRESS OF VDEV               */ 01654000
         L     R15,DEVADDR                                         0397 01655000
*             GEN(BALR R14,R15);    /* LINK TO VDEV                  */ 01656000
         BALR R14,R15                                                   01657000
*             DEVSUBGO='0'B;        /* RESET FOOTPRINT               */ 01658000
*                                                                  0399 01659000
         NI    DEVSUBGO,B'11101111'                                0399 01660000
*             /*******************************************************/ 01661000
*             /*                                                     */ 01662000
*             /* CHECK IF DEVICE UTILITIZES THIS SYSTEM RESOURCE     */ 01663000
*             /*                                                     */ 01664000
*             /*******************************************************/ 01665000
*                                                                  0400 01666000
*             IF RETCODE^=0 THEN    /* OK?                           */ 01667000
         LTR   RETCODE,RETCODE                                     0400 01668000
         BNZ   @RT00400                                            0400 01669000
*               GOTO ENDLOOP;       /* SKIP TO NEXT DEVICE           */ 01670000
*                                                                  0401 01671000
*             /*******************************************************/ 01672000
*             /*                                                     */ 01673000
*             /* DEVICE USES THE SPECIFIED CPU/CHANNEL, CHECK IF WE  */ 01674000
*             /* ARE REMOVING THE LAST PATH TO THE SPECIFIED DEVICE. */ 01675000
*             /* BEFORE CHECKING FOR THE LAST PATH, DETERMINE IF     */ 01676000
*             /* PATHS MUST BE VALIDATED.                    @ZA00078*/ 01677000
*             /*                                                     */ 01678000
*             /*******************************************************/ 01679000
*                                                                  0402 01680000
*             IF UCBVALPH='1'B THEN /* PATHS TO DEVICE MUST BE     0402 01681000
*                                      VALIDATED             @ZA00078*/ 01682000
         L     @12,UCBPTR                                          0402 01683000
         TM    UCBVALPH(@12),B'00000010'                           0402 01684000
         BNO   @RF00402                                            0402 01685000
*               IF UCBACTV='1'B THEN/* I/O ACTIVE ON DEVICE  @ZA00078*/ 01686000
         TM    UCBACTV(@12),B'00000010'                            0403 01687000
         BNO   @RF00403                                            0403 01688000
*                 IF(CHNIND='1'B&   /* VARY CHANNEL COMMAND  @ZA00078*/ 01689000
*                     UCBCHA=HEXCHN1&/* AND ACTIVE CHANNEL IS THE  0404 01690000
*                                      CHANNEL GOING OFFLINE @ZA00078*/ 01691000
*                     UCBCPU=HEXCPU1)|/* AND ACTIVE CPU IS THE     0404 01692000
*                                      SPECIFIED CPU         @ZA00078*/ 01693000
*                     (CHNIND='0'B& /* OR, VARY CPU COMMAND, @ZA00078*/ 01694000
*                     UCBCPU=HEXCPU1) THEN/* AND THE ACTIVE CPU IS 0404 01695000
*                                      THE CPU GOING OFFLINE @ZA00078*/ 01696000
         TM    CHNIND,B'10000000'                                  0404 01697000
         BNO   @GL00014                                            0404 01698000
         CLC   UCBCHA(1,@12),HEXCHN1                               0404 01699000
         BNE   @GL00014                                            0404 01700000
         CLC   UCBCPU(1,@12),HEXCPU1                               0404 01701000
         BE    @RT00404                                            0404 01702000
@GL00014 TM    CHNIND,B'10000000'                                  0404 01703000
         BNZ   @RF00404                                            0404 01704000
         L     @12,UCBPTR                                          0404 01705000
         CLC   UCBCPU(1,@12),HEXCPU1                               0404 01706000
         BNE   @RF00404                                            0404 01707000
@RT00404 DS    0H                                                  0405 01708000
*                   DO;             /*                       @ZA00078*/ 01709000
*                                                                  0405 01710000
*                     /***********************************************/ 01711000
*                     /*                                             */ 01712000
*                     /* DEVICE IS A TP DEVICE - ONLY WAY A DEVICE   */ 01713000
*                     /* CAN BE IN USE AND NOT HAVE BEEN VALIDATED - */ 01714000
*                     /* SO PATH IN USE IS THE LAST PATH TO THE      */ 01715000
*                     /* DEVICE.                             @ZA00078*/ 01716000
*                     /*                                             */ 01717000
*                     /***********************************************/ 01718000
*                                                                  0406 01719000
*                     DDD=UCBNAME;  /* COPY DEVICE NAME      @ZA00078*/ 01720000
         L     @12,UCBPTR                                          0406 01721000
         MVC   DDD(3),UCBNAME(@12)                                 0406 01722000
*                     LASTPATH='1'B;/* SET LAST PATH FLAG    @ZA00078*/ 01723000
         OI    LASTPATH,B'00000010'                                0407 01724000
*                     GOTO PATHEXIT;/* RETURN TO NEXT LEVEL  @ZA00078*/ 01725000
         B     PATHEXIT                                            0408 01726000
*                   END;            /*                       @ZA00078*/ 01727000
*                 ELSE              /* ACTIVE I/O NOT ON SPECIFIED 0410 01728000
*                                      CHANNEL OR CPU        @ZA00078*/ 01729000
*                   GOTO ENDLOOP;   /* SKIP TO NEXT DEVICE   @ZA00078*/ 01730000
*               ELSE                                               0411 01731000
*                 IF UCBNALOC='1'B THEN/* DEVICE BEING USED  @ZA14998*/ 01732000
@RF00403 L     @12,UCBPTR                                          0411 01733000
         TM    UCBNALOC(@12),B'00000100'                           0411 01734000
         BNO   @RF00411                                            0411 01735000
*                   DO;             /* GO TO IECVIOPM TO VALIDATE  0412 01736000
*                                      PATHS                 @ZA00078*/ 01737000
*                     PATHUCB=UCBPTR;/* SUPPLY UCB ADDRESS   @ZA00078*/ 01738000
         STCM  @12,7,PATHUCB                                       0413 01739000
*                     RFY                                          0414 01740000
*                      (R1,                                        0414 01741000
*                       R14,                                       0414 01742000
*                       R15) RSTD;  /* RESTRICT REGISTERS    @ZA00078*/ 01743000
*                     R1=ADDR(PATHPARM);/* POINT TO PARAMETERS     0415 01744000
*                                                            @ZA00078*/ 01745000
         LA    R1,PATHPARM                                         0415 01746000
*                     R15=PATHADDR; /* GET ADDRESS OF IOPM   @ZA00078*/ 01747000
         L     R15,PATHADDR                                        0416 01748000
*                     GEN(BALR  R14,R15);/* LINK TO IECVIOPM @ZA00078*/ 01749000
         BALR  R14,R15                                                  01750000
*                     RFY                                          0418 01751000
*                      (R1,                                        0418 01752000
*                       R14,                                       0418 01753000
*                       R15) UNRSTD;/* RELEASE REGISTERS     @ZA00078*/ 01754000
*                   END;            /* PATH VALIDATION DONE  @ZA00078*/ 01755000
*             IF CHNIND='1'B THEN   /* CHANNEL OR CPU COMMAND        */ 01756000
@RF00411 DS    0H                                                  0420 01757000
@RF00402 TM    CHNIND,B'10000000'                                  0420 01758000
         BNO   @RF00420                                            0420 01759000
*               DEVSUBFC=2;         /* CHANNEL LEVEL FUNCTION CODE   */ 01760000
*                                                                  0421 01761000
         MVI   DEVSUBFC,X'02'                                      0421 01762000
*             /*******************************************************/ 01763000
*             /*                                                     */ 01764000
*             /* IS A CPU COMMAND THEN, SET CPU FUNCTION CODE        */ 01765000
*             /*                                                     */ 01766000
*             /*******************************************************/ 01767000
*                                                                  0422 01768000
*             ELSE                                                 0422 01769000
*               DEVSUBFC=1;         /* CPU LEVEL FUNCTION CODE       */ 01770000
*                                                                  0422 01771000
         B     @RC00420                                            0422 01772000
@RF00420 MVI   DEVSUBFC,X'01'                                      0422 01773000
*             /*******************************************************/ 01774000
*             /*                                                     */ 01775000
*             /* SET UP LINKAGE TO PASS IEEVDEV NECESSARY PARMS FOR  */ 01776000
*             /* PATH DEPENDENCY TESTS THEN LINK                     */ 01777000
*             /*                                                     */ 01778000
*             /*******************************************************/ 01779000
*                                                                  0423 01780000
*             R1=ADDR(LINKPTR);     /* SET UP LINKAGE FOR IEEVDEV    */ 01781000
@RC00420 LA    R1,LINKPTR                                          0423 01782000
*             DEVSUBGO='1'B;        /* SET FOOTPRINT                 */ 01783000
         OI    DEVSUBGO,B'00010000'                                0424 01784000
*             R15=DEVADDR;          /* ADDRESS OF IEEVDEV FOR LINK   */ 01785000
         L     R15,DEVADDR                                         0425 01786000
*             GEN(BALR  R14,R15);   /* LINK TO IEEVDEV               */ 01787000
         BALR  R14,R15                                                  01788000
*             RFY                                                  0427 01789000
*              (R1,                                                0427 01790000
*               R14,                                               0427 01791000
*               R15) UNRSTD;        /* RELEASE REGISTERS             */ 01792000
*             DEVSUBGO='0'B;        /* RESET FOOTPRINT               */ 01793000
         NI    DEVSUBGO,B'11101111'                                0428 01794000
*             RFY                                                  0429 01795000
*              (RETCODE) RSTD;      /* RESTRICT REG                  */ 01796000
*                                                                  0429 01797000
*             /*******************************************************/ 01798000
*             /*                                                     */ 01799000
*             /* CHECK RETURN CODE FROM IEEVDEV, 00 = NOT LAST PATH  */ 01800000
*             /* 04 = LAST PATH. ANY THING ELSE IS INVALID. IF LAST  */ 01801000
*             /* PATH WAS NOT INDICATED RESET CONDITION CODE MASK TO */ 01802000
*             /* ALLOW MESSAGE INFORMING OPERATOR IF INOPERATIONAL   */ 01803000
*             /* PATHS EXIST TO THE DEVICE                           */ 01804000
*             /*                                                     */ 01805000
*             /*******************************************************/ 01806000
*                                                                  0430 01807000
*             IF RETCODE=0 THEN     /* NOT LAST PATH ?               */ 01808000
         LTR   RETCODE,RETCODE                                     0430 01809000
         BNZ   @RF00430                                            0430 01810000
*               DO;                                                0431 01811000
*                                                                  0431 01812000
*                 /***************************************************/ 01813000
*                 /*                                                 */ 01814000
*                 /* RESET CONDITION CODE 3 MASK IN UCB TO PERMIT    */ 01815000
*                 /* MESSAGES TO BE ISSUED IN THE EVENT OF A         */ 01816000
*                 /* INOPERATIONAL PATH                              */ 01817000
*                 /*                                                 */ 01818000
*                 /***************************************************/ 01819000
*                                                                  0432 01820000
*                 RFY                                              0432 01821000
*                  (R10,                                           0432 01822000
*                   R11,                                           0432 01823000
*                   R12) RSTD;      /* RESTRICT REGISTERS            */ 01824000
*                 R10=UCBPTR;       /* UCB ADDRESS                   */ 01825000
         L     R10,UCBPTR                                          0433 01826000
*                 GEN REFS(UCBCCWOF,UCBBGN)                        0434 01827000
*(IOSGEN  UCBFLG,UCB=(10),TABLE=UCBPMSK,REG=(11,12));              0434 01828000
         IOSGEN  UCBFLG,UCB=(10),TABLE=UCBPMSK,REG=(11,12)              01829000
*                 RFY                                              0435 01830000
*                  (R10,                                           0435 01831000
*                   R11,                                           0435 01832000
*                   R12) UNRSTD;    /* RELEASE REGISTERS             */ 01833000
*               END;                                               0436 01834000
*             ELSE                                                 0437 01835000
*               DO;                                                0437 01836000
*                                                                  0437 01837000
         B     @RC00430                                            0437 01838000
@RF00430 DS    0H                                                  0438 01839000
*                 /***************************************************/ 01840000
*                 /*                                                 */ 01841000
*                 /* CHECK FOR RETURN CODE 4 (LAST PATH ) AND CHECK  */ 01842000
*                 /* DEVICE STATUS                                   */ 01843000
*                 /*                                                 */ 01844000
*                 /***************************************************/ 01845000
*                                                                  0438 01846000
*                 IF RETCODE=4 THEN /* CHECK FOR LAST PATH CONDITION */ 01847000
         CH    RETCODE,@CH00076                                    0438 01848000
         BNE   @RF00438                                            0438 01849000
*                   DO;             /* INCLUDE PATHMAP ROUTINE       */ 01850000
*/****** PATHMAP *************************************************** */ 01851000
*/* PATHMAP WILL ANALYZE DEVICE STATUS WHEN A LAST PATH CONDITION    */ 01852000
*/* IS ENCOUNTERED. DEVICE WILL BE CHECKED FOR NALLOC, CONSOLE,      */ 01853000
*/* ALLOCATED, AND OFFLINE. IF DEVICE CAN BE TAKEN OFFLINE THEN A    */ 01854000
*/* RECORDER BLOCK WILL BE BUILT REPRESENTING THE DEVICE FOR LATER   */ 01855000
*/* USE. IF IT IS DETERMINED THAT THE DEVICE CANNOT BE REMOVED THE   */ 01856000
*/* LASTPATH BIT WILL BE SET IN THE ERROR INDICATOR AND CONTROL      */ 01857000
*/* RETURNED TO THE NEXT HIGHER LEVEL OF CONTROL                     */ 01858000
*/*****************************************************************  */ 01859000
*                                                                  0440 01860000
*                     DO;                                          0440 01861000
*                                                                  0440 01862000
*                       /*********************************************/ 01863000
*                       /*                                           */ 01864000
*                       /* CHECK IF DEVICE IS ALLOCATED OR IN USE BY */ 01865000
*                       /* SOME SYSTEM FUNCTION AND IF SO SET LAST   */ 01866000
*                       /* PATH ERROR FLAG AND RETURN TO NEXT HIGHER */ 01867000
*                       /* LEVEL OF CONTROL IGNORE NALLOC FLAG IF    */ 01868000
*                       /* DEVICE IS MSS                             */ 01869000
*                       /*                                           */ 01870000
*                       /*********************************************/ 01871000
*                                                                  0441 01872000
*                       IF UCBALOC='1'B|(UCBNALOC='1'B&UCBTBYT4^='42'X) 01873000
*                         THEN      /*                       @Y30LPXA*/ 01874000
         L     @14,UCBPTR                                          0441 01875000
         TM    UCBALOC(@14),B'00001000'                            0441 01876000
         BO    @RT00441                                            0441 01877000
         TM    UCBNALOC(@14),B'00000100'                           0441 01878000
         BNO   @RF00441                                            0441 01879000
         CLI   UCBTBYT4(@14),X'42'                                 0441 01880000
         BE    @RF00441                                            0441 01881000
@RT00441 DS    0H                                                  0442 01882000
*                         DO;                                      0442 01883000
*                                                                  0442 01884000
*                           /*****************************************/ 01885000
*                           /*                                       */ 01886000
*                           /* DEVICE IS IN USE, COPY DEVICE NAME AND*/ 01887000
*                           /* SET ERROR FLAGS                       */ 01888000
*                           /*                                       */ 01889000
*                           /*****************************************/ 01890000
*                                                                  0443 01891000
*                           DDD=UCBNAME;/* COPY DEVICE NAME          */ 01892000
         L     @14,UCBPTR                                          0443 01893000
         MVC   DDD(3),UCBNAME(@14)                                 0443 01894000
*                           LASTPATH='1'B;/* SET LAST PATH ERROR FLAG*/ 01895000
         OI    LASTPATH,B'00000010'                                0444 01896000
*                           GOTO PATHEXIT;/* RETURN TO NEXT HIGHER 0445 01897000
*                                      LEVEL                         */ 01898000
         B     PATHEXIT                                            0445 01899000
*                         END;                                     0446 01900000
*                                                                  0446 01901000
*                       /*********************************************/ 01902000
*                       /*                                           */ 01903000
*                       /* DEVICE IS NOT ALLOCATED NOR IN USE BY SOME*/ 01904000
*                       /* SYSTEM FUNCTION IF DEVICE IS ALREADY      */ 01905000
*                       /* OFFLINE THEN BUILD A RECORDER ENTRY FOR   */ 01906000
*                       /* HIER ONLY.                                */ 01907000
*                       /*                                           */ 01908000
*                       /*********************************************/ 01909000
*                                                                  0447 01910000
*                       IF UCBONLI^='1'B THEN/* UCB OFFLINE?         */ 01911000
@RF00441 L     @14,UCBPTR                                          0447 01912000
         TM    UCBONLI(@14),B'10000000'                            0447 01913000
         BO    @RF00447                                            0447 01914000
*                         DO;                                      0448 01915000
*                           HIER='1'B;/* SET HIER INDICATOR IN FLAG     01916000
*                                      BYTE                          */ 01917000
         OI    HIER,B'10000000'                                    0449 01918000
*                           GOTO UCBRCRD;/* GO BUILD RECORDER BLOCK  */ 01919000
         B     UCBRCRD                                             0450 01920000
*                         END;                                     0451 01921000
*                                                                  0451 01922000
*                       /*********************************************/ 01923000
*                       /*                                           */ 01924000
*                       /* DEVICE IS NOT ALLOCATED, NOT IN USE, AND  */ 01925000
*                       /* ONLINE, CHECK IF DEVICE REPRESENTS A      */ 01926000
*                       /* CONSOLE                                   */ 01927000
*                       /*                                           */ 01928000
*                       /*********************************************/ 01929000
*                                                                  0452 01930000
*                       IF UCBSYSR='1'B THEN/* DEVICE A CONSOLE?     */ 01931000
@RF00447 L     @14,UCBPTR                                          0452 01932000
         TM    UCBSYSR(@14),B'00000010'                            0452 01933000
         BNO   @RF00452                                            0452 01934000
*                         DO;                                      0453 01935000
*                           CNSLSW='1'B;/* INDICATOR FOR CONSOLE   0454 01936000
*                                      SWITCH                        */ 01937000
         OI    CNSLSW,B'00000001'                                  0454 01938000
*                           CONSLE='1'B;/* CONSOLE INDICATOR IN FLAG    01939000
*                                      BYTE                          */ 01940000
         OI    CONSLE,B'01000000'                                  0455 01941000
*                           GOTO UCBRCRD;/* GO BUILD RECORDER BLOCK  */ 01942000
         B     UCBRCRD                                             0456 01943000
*                         END;                                     0457 01944000
*                                                                  0457 01945000
*                       /*********************************************/ 01946000
*                       /*                                           */ 01947000
*                       /* DEVICE IS ONLINE, NOT IN USE, NOT A       */ 01948000
*                       /* CONSOLE, AND NOT ALLOCATED CHECK IF       */ 01949000
*                       /* OPERATOR HAS SPECIFIED UNCONDITIONAL AND  */ 01950000
*                       /* BUILD A RECORDER BLOCK, ELSE REJECT       */ 01951000
*                       /* COMMAND BECAUSE OF A LAST PATH CONDITION  */ 01952000
*                       /*                                           */ 01953000
*                       /*********************************************/ 01954000
*                                                                  0458 01955000
*                       IF UNCOND='1'B THEN/* UNCONDITIONAL        0458 01956000
*                                      SPECIFIED?                    */ 01957000
@RF00452 TM    UNCOND,B'00010000'                                  0458 01958000
         BNO   @RF00458                                            0458 01959000
*                         DO;                                      0459 01960000
*                           DEVOFF='1'B;/* SET FLAG FOR RECORDER     */ 01961000
         OI    DEVOFF,B'00010000'                                  0460 01962000
*                           GOTO UCBRCRD;/* GO BUILD RECORDER BLOCK  */ 01963000
         B     UCBRCRD                                             0461 01964000
*                         END;                                     0462 01965000
*                       ELSE                                       0463 01966000
*                         DO;                                      0463 01967000
*                                                                  0463 01968000
@RF00458 DS    0H                                                  0464 01969000
*                           /*****************************************/ 01970000
*                           /*                                       */ 01971000
*                           /* OPERATOR HAS NOT SPECIFIED            */ 01972000
*                           /* UNCONDITIONAL VARY AND THIS REPRESENTS*/ 01973000
*                           /* LAST PATH TO A ONLINE DEVICE. SET LAST*/ 01974000
*                           /* PATH ERROR FLAG AND TERMINATE COMMAND */ 01975000
*                           /*                                       */ 01976000
*                           /*****************************************/ 01977000
*                                                                  0464 01978000
*                           DDD=UCBNAME;/* COPY DEVICE NAME FOR    0464 01979000
*                                      MESSAGE TEXT                  */ 01980000
         L     @14,UCBPTR                                          0464 01981000
         MVC   DDD(3),UCBNAME(@14)                                 0464 01982000
*                           LASTPATH='1'B;/* SET ERROR FLAG          */ 01983000
         OI    LASTPATH,B'00000010'                                0465 01984000
*                           GOTO PATHEXIT;/* RETURN TO NEXT LEVEL    */ 01985000
         B     PATHEXIT                                            0466 01986000
*                         END;                                     0467 01987000
*                                                                  0467 01988000
*                       /*********************************************/ 01989000
*                       /*                                           */ 01990000
*                       /* COMMON CALL TO UCBRECORDER ROUTINE        */ 01991000
*                       /*                                           */ 01992000
*                       /*********************************************/ 01993000
*                                                                  0468 01994000
*UCBRCRD:                                                          0468 01995000
*                       CALL UCBRCRDR;/* BUILD RECORDER BLOCK        */ 01996000
*                                                                  0468 01997000
UCBRCRD  BAL   @14,UCBRCRDR                                        0468 01998000
*                       /*********************************************/ 01999000
*                       /*                                           */ 02000000
*                       /* END OF PATHMAP ROUTINE..                  */ 02001000
*                       /*                                           */ 02002000
*                       /*********************************************/ 02003000
*                                                                  0469 02004000
*PATHEXIT:                                                         0469 02005000
*                     END;          /* END OF PATHMAP ROUTINE        */ 02006000
PATHEXIT DS    0H                                                  0470 02007000
*                                                                  0470 02008000
*                     /***********************************************/ 02009000
*                     /*                                             */ 02010000
*                     /* CHECK FOR ANY ERROR CONDITIONS FROM PATHMAP */ 02011000
*                     /* ROUTINES AND IF FOUND RETURN TO NEXT HIGHER */ 02012000
*                     /* LEVEL                                       */ 02013000
*                     /*                                             */ 02014000
*                     /***********************************************/ 02015000
*                                                                  0470 02016000
*                     IF ERRORIND^=0 THEN/* CHECK FOR ANY ERRORS     */ 02017000
         ICM   @14,15,ERRORIND                                     0470 02018000
         BNZ   @RT00470                                            0470 02019000
*                       GOTO DEVPEXIT;/* RETURN TO NEXT HIGHER     0471 02020000
*                                      ROUTINE                       */ 02021000
*                   END;                                           0472 02022000
*                 ELSE                                             0473 02023000
*                   DO;                                            0473 02024000
*                                                                  0473 02025000
         B     @RC00438                                            0473 02026000
@RF00438 DS    0H                                                  0474 02027000
*                     /***********************************************/ 02028000
*                     /*                                             */ 02029000
*                     /* INVALID RETURN CODE RECEIVED FROM IEEVDEV.  */ 02030000
*                     /* SET CP FAILED INDICATOR AND RETURN TO NEXT  */ 02031000
*                     /* HIGHER LEVEL                                */ 02032000
*                     /*                                             */ 02033000
*                     /***********************************************/ 02034000
*                                                                  0474 02035000
*                     CPFAILED='1'B;/* SET ERROR FLAG                */ 02036000
         OI    CPFAILED,B'00000100'                                0474 02037000
*                     GOTO DEVPEXIT;/* RETURN TO NEXT HIGHER LEVEL   */ 02038000
         B     DEVPEXIT                                            0475 02039000
*                   END;                                           0476 02040000
*                 RFY                                              0477 02041000
*                  (RETCODE) UNRSTD;/* RELEASE REGISTER 15           */ 02042000
@RC00438 DS    0H                                                  0478 02043000
*               END;                                               0478 02044000
*ENDLOOP:                                                          0479 02045000
*           END;                    /* END OF DO LOOP                */ 02046000
@RC00430 DS    0H                                                  0479 02047000
ENDLOOP  LA    @12,2                                               0479 02048000
         AL    @12,UCBLKPTR                                        0479 02049000
         ST    @12,UCBLKPTR                                        0479 02050000
@DE00382 L     @12,UCBLKPTR                                        0479 02051000
         CLC   UCBTAB(2,@12),@CH03658                              0479 02052000
         BNE   @DL00382                                            0479 02053000
*DEVPEXIT:                                                         0480 02054000
*         END;                      /* END OF DEVPREP ROUTINE        */ 02055000
DEVPEXIT DS    0H                                                  0481 02056000
*     IF ERRORIND^=0 THEN           /* ANY ERRORS?                   */ 02057000
@RF00341 DS    0H                                                  0481 02058000
@RF00340 ICM   @12,15,ERRORIND                                     0481 02059000
         BNZ   @RT00481                                            0481 02060000
*       GOTO OFFEXIT;               /* RETURN TO MAINLINE            */ 02061000
*/***** TMRCNSL **************************************************** */ 02062000
*/* TMRCNSL ROUTINE WILL VERIFY THAT CLOCKS CAN BE SWITCHED FOR A    */ 02063000
*/* VARY CPU COMMAND, AND WILL CAUSE CONSOLES TO BE SWITCHED IF      */ 02064000
*/* NECESSARY.                                                       */ 02065000
*/* POSSIBLE ERROR INDICATORS ARE: NOCLOCK, NOCNSOLE, CPFAILED       */ 02066000
*/****************************************************************** */ 02067000
*                                                                  0483 02068000
*     DO;                                                          0483 02069000
*                                                                  0483 02070000
*       /*************************************************************/ 02071000
*       /*                                                           */ 02072000
*       /* DETERMINE IF THIS IS A VARY CPU COMMAND AND IF SO SWITCH  */ 02073000
*       /* CLOCKS                                                    */ 02074000
*       /*                                                           */ 02075000
*       /*************************************************************/ 02076000
*                                                                  0484 02077000
*       IF CHNIND^='1'B THEN        /* VARY CPU COMMAND              */ 02078000
         TM    CHNIND,B'10000000'                                  0484 02079000
         BO    @RF00484                                            0484 02080000
*         DO;                                                      0485 02081000
*           CLOCKSW='1'B;           /* SET FOOTPRINT FOR CLOCK SWITCH*/ 02082000
         OI    CLOCKSW,B'00000100'                                 0486 02083000
*           RFY                                                    0487 02084000
*            (R1,                                                  0487 02085000
*             RETCODE) RSTD;        /* RESTRICT REGISTERS FOR LINK   */ 02086000
*           R1=ADDR(PCCAT00P(HEXCPUAD+1));/* LOAD PCCA POINTER     0488 02087000
*                                      ADDRESS                       */ 02088000
         SLR   @14,@14                                             0488 02089000
         ICM   @14,3,HEXCPUAD                                      0488 02090000
         SLA   @14,2                                               0488 02091000
         L     @12,CVTPTR                                          0488 02092000
         L     R1,CVTPCCAT(,@12)                                   0488 02093000
         LA    R1,PCCAT00P(@14,R1)                                 0488 02094000
*           GEN(LINK EP=IEAVRNOT);  /* LINK TO TIMER SWITCH ROUTINE  */ 02095000
*                                                                  0489 02096000
         LINK EP=IEAVRNOT                                               02097000
*           /*********************************************************/ 02098000
*           /*                                                       */ 02099000
*           /* CHECK RETURN CODE TO DETERMINE IF CLOCKS CAN BE       */ 02100000
*           /* SWITCHED                                              */ 02101000
*           /*                                                       */ 02102000
*           /*********************************************************/ 02103000
*                                                                  0490 02104000
*           IF RETCODE^=0 THEN      /* CAN CLOCKS BE SWITCHED?       */ 02105000
         LTR   RETCODE,RETCODE                                     0490 02106000
         BZ    @RF00490                                            0490 02107000
*             DO;                                                  0491 02108000
*               NOCLOCK='1'B;       /* SET ERROR FLAG                */ 02109000
         OI    NOCLOCK,B'10000000'                                 0492 02110000
*               GOTO TMREXIT;       /* RETURN TO CALLER              */ 02111000
         B     TMREXIT                                             0493 02112000
*             END;                                                 0494 02113000
*         END;                      /* END OF CPU CLOCK SWITCH     0495 02114000
*                                      ROUTINE                       */ 02115000
*                                                                  0495 02116000
@RF00490 DS    0H                                                  0496 02117000
*       /*************************************************************/ 02118000
*       /*                                                           */ 02119000
*       /* CHECK IF CONSOLES NEED TO BE SWITCHED AND IF SO LINK TO   */ 02120000
*       /* CONSOLE SWITCH ROUTINE                                    */ 02121000
*       /*                                                           */ 02122000
*       /*************************************************************/ 02123000
*                                                                  0496 02124000
*       IF CNSLSW='1'B THEN         /* CONSOLES NEED TO BE SWITCHED? */ 02125000
@RF00484 TM    CNSLSW,B'00000001'                                  0496 02126000
         BNO   @RF00496                                            0496 02127000
*         DO;                                                      0497 02128000
*           CNSLEXIT='1'B;          /* SET CONSOLE EXIT FOOTPRINT    */ 02129000
*                                                                  0498 02130000
         OI    CNSLEXIT,B'00000001'                                0498 02131000
*           /*********************************************************/ 02132000
*           /*                                                       */ 02133000
*           /* INITIALIZE PARAMETER FOR CONSOLE SWITCH ROUTINE       */ 02134000
*           /*                                                       */ 02135000
*           /*********************************************************/ 02136000
*                                                                  0499 02137000
*           CSWTBLK=''B;            /* ZERO OUT PARAMETER AREA       */ 02138000
         XC    CSWTBLK(32),CSWTBLK                                 0499 02139000
*           CSWTID='IGC0407B';      /* FILL IN IDENTIFIER            */ 02140000
         MVC   CSWTID(8),@CC03671                                  0500 02141000
*           IF CHNIND='1'B THEN     /* CHANNEL OR CPU COMMAND        */ 02142000
         TM    CHNIND,B'10000000'                                  0501 02143000
         BNO   @RF00501                                            0501 02144000
*             CSWTFC='20'X;                                        0502 02145000
         MVI   CSWTFC,X'20'                                        0502 02146000
*           ELSE                                                   0503 02147000
*             CSWTFC='40'X;         /* VARY CPU IDENTIFIER           */ 02148000
         B     @RC00501                                            0503 02149000
@RF00501 MVI   CSWTFC,X'40'                                        0503 02150000
*           CSWTUC=CVTCUCB;         /* FIRST UCM                     */ 02151000
@RC00501 L     @14,CVTPTR                                          0504 02152000
         MVC   CSWTUC(4),CVTCUCB(@14)                              0504 02153000
*           R1=ADDR(CSWTBLK);       /* POINT TO CONTROL BLOCK        */ 02154000
         LA    R1,CSWTBLK                                          0505 02155000
*           SVC(72);                /* ISSUE SVC                     */ 02156000
*                                                                  0506 02157000
         SVC   72                                                  0506 02158000
*           /*********************************************************/ 02159000
*           /*                                                       */ 02160000
*           /* VERIFY THAT CONSOLES CAN BE SWITCHED AND IF NOT SET   */ 02161000
*           /* ERROR FLAG                                            */ 02162000
*           /*                                                       */ 02163000
*           /*********************************************************/ 02164000
*                                                                  0507 02165000
*           IF RETCODE^=0 THEN      /* CAN CONSOLES BE SWITCHED?     */ 02166000
         LTR   RETCODE,RETCODE                                     0507 02167000
         BZ    @RF00507                                            0507 02168000
*             DO;                                                  0508 02169000
*               NOCNSOLE='1'B;      /* SET ERROR FLAG                */ 02170000
         OI    NOCNSOLE,B'01000000'                                0509 02171000
*               GOTO TMREXIT;       /* RETURN CONTROL TO CALLER      */ 02172000
         B     TMREXIT                                             0510 02173000
*             END;                                                 0511 02174000
*           RFY                                                    0512 02175000
*            (R1,                                                  0512 02176000
*             RETCODE) UNRSTD;      /* RELEASE REGISTERS FOR USE     */ 02177000
@RF00507 DS    0H                                                  0513 02178000
*/******* CNSLWAIT ************************************************  */ 02179000
*/* CNSLWAIT WILL WAIT FOR ALL CONSOLES TO BE SWITCHED AND MARKED    */ 02180000
*/* OFFLINE. A CHECK WILL BE MADE TO DETERMINE IF SYSTEM STATUS      */ 02181000
*/* HAS CHANGED AND IF SO CPFAILED ERROR FLAG WILL BE SET AND        */ 02182000
*/* CONTROL RETURNED TO NEXT HIGHER LEVEL OF CONTROL                 */ 02183000
*/*****************************************************************  */ 02184000
*                                                                  0513 02185000
*CNSLWAIT:                                                         0513 02186000
*           LOOPCNT=0;              /* START WITH ZERO COUNT         */ 02187000
CNSLWAIT SLR   @12,@12                                             0513 02188000
         ST    @12,LOOPCNT                                         0513 02189000
*CNSLLOOP:                                                         0514 02190000
*           RCRDRPTR=ENTRYPTR;      /* ADDRESSABILITY TO RECORDER  0514 02191000
*                                      BLOCKS                        */ 02192000
*                                                                  0514 02193000
CNSLLOOP L     RCRDRPTR,ENTRYPTR                                   0514 02194000
*           /*********************************************************/ 02195000
*           /*                                                       */ 02196000
*           /* SET UP DO LOOP TO SCAN THROUGH ALL RECORDER BLOCKS AND*/ 02197000
*           /* VERIFY THAT CONSOLES HAVE BEEN MARKED OFFLINE         */ 02198000
*           /*                                                       */ 02199000
*           /*********************************************************/ 02200000
*                                                                  0515 02201000
*           DO WHILE(RCRDRPTR^=0);  /* SCAN ALL RECORDER BLOCKS      */ 02202000
*                                                                  0515 02203000
         B     @DE00515                                            0515 02204000
@DL00515 DS    0H                                                  0516 02205000
*             /*******************************************************/ 02206000
*             /*                                                     */ 02207000
*             /* CHECK IF THIS RECORDER BLOCK REPRESENTS A CONSOLE   */ 02208000
*             /*                                                     */ 02209000
*             /*******************************************************/ 02210000
*                                                                  0516 02211000
*             IF CONSLFLG='1'B THEN /* CONSOLE?                      */ 02212000
         TM    CONSLFLG(RCRDRPTR),B'01000000'                      0516 02213000
         BNO   @RF00516                                            0516 02214000
*               DO;                                                0517 02215000
*                 UCBPTR=UCBADDR;   /* ADDRESSABILITY TO UCB         */ 02216000
         SLR   @12,@12                                             0518 02217000
         ICM   @12,7,UCBADDR(RCRDRPTR)                             0518 02218000
         ST    @12,UCBPTR                                          0518 02219000
*                 IF UCBONLI='1'B THEN/* UCB STILL NOT OFFLINE       */ 02220000
*                                                                  0519 02221000
         TM    UCBONLI(@12),B'10000000'                            0519 02222000
         BNO   @RF00519                                            0519 02223000
*                   /*************************************************/ 02224000
*                   /*                                               */ 02225000
*                   /* UCB STILL NOT OFFLINE VERIFY THAT SYSTEM      */ 02226000
*                   /* STATUS HAS NOT CHANGED AND WAIT ONE SECOND.   */ 02227000
*                   /* THEN TRY CHECK AGAIN                          */ 02228000
*                   /*                                               */ 02229000
*                   /*************************************************/ 02230000
*                                                                  0520 02231000
*                   DO;                                            0520 02232000
*                     IF SYSSTAT^=CSDCPUAL THEN/* SYSTEM STATUS    0521 02233000
*                                      CHANGED?                      */ 02234000
         L     @12,CVTPTR                                          0521 02235000
         L     @12,CVTCSD(,@12)                                    0521 02236000
         CLC   SYSSTAT(2),CSDCPUAL(@12)                            0521 02237000
         BE    @RF00521                                            0521 02238000
*                       DO;                                        0522 02239000
*                         SYSFAIL='1'B;/* SET ERROR FLAG             */ 02240000
         OI    SYSFAIL,B'00000100'                                 0523 02241000
*                         GOTO CONSEXIT;/* RETURN TO HIGHER LEVEL OF    02242000
*                                      CONTROL                       */ 02243000
         B     CONSEXIT                                            0524 02244000
*                       END;                                       0525 02245000
*                                                                  0525 02246000
*                     /***********************************************/ 02247000
*                     /*                                             */ 02248000
*                     /* CHECK LOOP COUNT TO DETERMINE IF MESSAGE    */ 02249000
*                     /* SHOULD BE ISSUED                            */ 02250000
*                     /*                                             */ 02251000
*                     /***********************************************/ 02252000
*                                                                  0526 02253000
*                     IF LOOPCNT=15 THEN/* TIME FOR MESSAGE?         */ 02254000
@RF00521 CLC   LOOPCNT(4),@CF00344                                 0526 02255000
         BNE   @RF00526                                            0526 02256000
*                       DO;                                        0527 02257000
*                         RFY                                      0528 02258000
*                          (R6) RSTD;/* RESTRICT REG 6               */ 02259000
*                         R6=ADDR(WORKAREA);/* ADDRESS OF WORKAREA   */ 02260000
         LA    R6,WORKAREA                                         0529 02261000
*                         DDD=UCBNAME;/* DEVICE NAME FOR MESSAGE     */ 02262000
         L     @12,UCBPTR                                          0530 02263000
         MVC   DDD(3),UCBNAME(@12)                                 0530 02264000
*                         CALL WTORT(2);/* ISSUE DEVICE BUSY MESSAGE */ 02265000
         L     @15,@CV03525                                        0531 02266000
         LA    @01,@AL00531                                        0531 02267000
         BALR  @14,@15                                             0531 02268000
*                         RFY                                      0532 02269000
*                          (R6) UNRSTD;/* RELEASE REG                */ 02270000
*                       END;                                       0533 02271000
*                                                                  0533 02272000
*                     /***********************************************/ 02273000
*                     /*                                             */ 02274000
*                     /* CHECK LOOP COUNT TO DETERMINE IF OPERATOR   */ 02275000
*                     /* CAN CANCEL                                  */ 02276000
*                     /*                                             */ 02277000
*                     /***********************************************/ 02278000
*                                                                  0534 02279000
*                     IF LOOPCNT=150 THEN/* CANCEL TIME?             */ 02280000
@RF00526 CLC   LOOPCNT(4),@CF03679                                 0534 02281000
         BNE   @RF00534                                            0534 02282000
*                       DO;                                        0535 02283000
*                         LOOPCNT=0;/* ZERO LOOP COUNT FOR NEXT TIME */ 02284000
         SLR   @12,@12                                             0536 02285000
         ST    @12,LOOPCNT                                         0536 02286000
*CONWTOR:                                                          0537 02287000
*                         WTOECB=0; /* ZERO ECB                      */ 02288000
CONWTOR  SLR   @12,@12                                             0537 02289000
         ST    @12,WTOECB                                          0537 02290000
*                         REPLY=''; /* BLANK OUT REPLY BUFFER        */ 02291000
         MVI   REPLY,C' '                                          0538 02292000
         MVC   REPLY+1(7),REPLY                                    0538 02293000
*                         WTORPL2=WTOR2;/* MOVE WTOR TO PARM LIST    */ 02294000
         MVC   WTORPL2(55),WTOR2                                   0539 02295000
*                         WTORDDD=UCBNAME;/* FILL IN DYNAMIC TEXT    */ 02296000
         L     @12,UCBPTR                                          0540 02297000
         MVC   WTORDDD(3),UCBNAME(@12)                             0540 02298000
*                         GEN(WTOR  ,REPLY,,WTOECB,MF=(E,WTORPL2));/*   02299000
*                                      WTOR                          */ 02300000
*                                                                  0541 02301000
         WTOR  ,REPLY,,WTOECB,MF=(E,WTORPL2)                            02302000
*                         /*******************************************/ 02303000
*                         /*                                         */ 02304000
*                         /* WAIT FOR RESPONSE                       */ 02305000
*                         /*                                         */ 02306000
*                         /*******************************************/ 02307000
*                                                                  0542 02308000
*                         GEN(WAIT  ECB=WTOECB);/* WAIT FOR REPLY    */ 02309000
*                                                                  0542 02310000
         WAIT  ECB=WTOECB                                               02311000
*                         /*******************************************/ 02312000
*                         /*                                         */ 02313000
*                         /* CHECK OPERATORS RESPONSE                */ 02314000
*                         /*                                         */ 02315000
*                         /*******************************************/ 02316000
*                                                                  0543 02317000
*                         IF REPLY^='EXTEND'&REPLY^='CANCEL' THEN/*     02318000
*                                      VALID REPLY?                  */ 02319000
         CLC   REPLY(6),@CC03682                                   0543 02320000
         BE    @RF00543                                            0543 02321000
         CLC   REPLY(6),@CC03683                                   0543 02322000
         BNE   @RT00543                                            0543 02323000
*                           GOTO CONWTOR;/* RE ISSUE WTOR            */ 02324000
*                                                                  0544 02325000
*                         /*******************************************/ 02326000
*                         /*                                         */ 02327000
*                         /* REPLY IS VALID, CHECK IF CANCEL         */ 02328000
*                         /*                                         */ 02329000
*                         /*******************************************/ 02330000
*                                                                  0545 02331000
*                         IF REPLY='CANCEL' THEN/* CANCEL REPLY?     */ 02332000
@RF00543 CLC   REPLY(6),@CC03683                                   0545 02333000
         BNE   @RF00545                                            0545 02334000
*                           DO;                                    0546 02335000
*                             OPERCNCL='1'B;/* SET OPERATOR CANCEL 0547 02336000
*                                      FLAG                          */ 02337000
         OI    OPERCNCL,B'00100000'                                0547 02338000
*                             GOTO CONSEXIT;/* EXIT WITH ERROR FLAG  */ 02339000
         B     CONSEXIT                                            0548 02340000
*                           END;                                   0549 02341000
*                                                                  0549 02342000
*                         /*******************************************/ 02343000
*                         /*                                         */ 02344000
*                         /* REPLY MUST HAVE BEEN EXTEND THEN        */ 02345000
*                         /*                                         */ 02346000
*                         /*******************************************/ 02347000
*                                                                  0550 02348000
*                         ELSE                                     0550 02349000
*                           GOTO CNSLWAIT;/* LOOP AGAIN              */ 02350000
*                       END;        /* END OF LOOP COUNT 150       0551 02351000
*                                      PROCESSING                    */ 02352000
*                                                                  0551 02353000
*                     /***********************************************/ 02354000
*                     /*                                             */ 02355000
*                     /* WAIT ONE SECOND THEN TRY LOOP AGAIN         */ 02356000
*                     /*                                             */ 02357000
*                     /***********************************************/ 02358000
*                                                                  0552 02359000
*                     GEN(STIMER  WAIT,BINTVL=SEC1);/* WAIT ONE    0552 02360000
*                                      SECOND                        */ 02361000
@RF00534 DS    0H                                                  0552 02362000
         STIMER  WAIT,BINTVL=SEC1                                       02363000
*                     LOOPCNT=LOOPCNT+1;/* INCREMENT LOOP COUNT      */ 02364000
         LA    @12,1                                               0553 02365000
         AL    @12,LOOPCNT                                         0553 02366000
         ST    @12,LOOPCNT                                         0553 02367000
*                     GOTO CNSLLOOP;/* TRY SCAN OVER AGAIN           */ 02368000
         B     CNSLLOOP                                            0554 02369000
*                   END;                                           0555 02370000
*               END;                /* END OF CONSOLE PROCESSING     */ 02371000
*                                                                  0556 02372000
@RF00519 DS    0H                                                  0557 02373000
*             /*******************************************************/ 02374000
*             /*                                                     */ 02375000
*             /* STEP TO NEXT RECORDER BLOCK ENTRY                   */ 02376000
*             /*                                                     */ 02377000
*             /*******************************************************/ 02378000
*                                                                  0557 02379000
*             RCRDRPTR=NEXTPTR;     /* PICK UP NEXT ENTRY ADDRESS    */ 02380000
@RF00516 L     RCRDRPTR,NEXTPTR(,RCRDRPTR)                         0557 02381000
*           END;                    /* END OF DO LOOP                */ 02382000
*                                                                  0558 02383000
@DE00515 LTR   RCRDRPTR,RCRDRPTR                                   0558 02384000
         BNZ   @DL00515                                            0558 02385000
*           /*********************************************************/ 02386000
*           /*                                                       */ 02387000
*           /* ALL CONSOLES HAVE SUCCESSFULLY GONE OFFLINE. SET      */ 02388000
*           /* CNSLDONE FOOTPRINT                                    */ 02389000
*           /*                                                       */ 02390000
*           /*********************************************************/ 02391000
*                                                                  0559 02392000
*           CNSLDONE='1'B;          /* ALL CONSOLES HAVE GONE OFFLINE*/ 02393000
         OI    CNSLDONE,B'10000000'                                0559 02394000
*CONSEXIT:                                                         0560 02395000
*         END;                      /* END OF CONSOLE WAIT ROUTINE   */ 02396000
CONSEXIT DS    0H                                                  0561 02397000
*TMREXIT:                                                          0561 02398000
*     END;                          /* END OF TMRCNSL ROUTINE        */ 02399000
@RF00496 DS    0H                                                  0561 02400000
TMREXIT  DS    0H                                                  0562 02401000
*     IF ERRORIND^=0 THEN           /* ANY ERRORS?                   */ 02402000
         ICM   @12,15,ERRORIND                                     0562 02403000
         BNZ   @RT00562                                            0562 02404000
*       GOTO OFFEXIT;               /* RETURN TO MAINLINE            */ 02405000
*     IF CPUCRH='1'B THEN                                          0564 02406000
         TM    CPUCRH,B'00000001'                                  0564 02407000
         BO    @RT00564                                            0564 02408000
*       GOTO DSPTCHK;               /*                       @G557P2L*/ 02409000
*     IF PCCAT00P(HEXCPUAD+1)->     /* PCCA FOR THIS CPU     @G47AN2O*/ 02410000
*         PCCAIO=HASIO              /* CPU HAS CHANNELS      @G47AN2O*/ 02411000
*       THEN                                                       0566 02412000
         SLR   @12,@12                                             0566 02413000
         ICM   @12,3,HEXCPUAD                                      0566 02414000
         SLA   @12,2                                               0566 02415000
         L     @06,CVTPTR                                          0566 02416000
         L     @06,CVTPCCAT(,@06)                                  0566 02417000
         L     @12,PCCAT00P(@12,@06)                               0566 02418000
         TM    PCCAIO(@12),B'01000000'                             0566 02419000
         BNO   @RF00566                                            0566 02420000
*       DO;                         /* PERFORM UCBMARK AND   @G47AN2O   02421000
*                                      CHANNEL FUNCTIONS     @G47AN2O*/ 02422000
*                                                                  0567 02423000
*         /***********************************************************/ 02424000
*         /*                                                         */ 02425000
*         /* CALL UCB MARK ROUTINE TO MARK ALL NECESSARY DEVICES     */ 02426000
*         /* OFFLINE                                                 */ 02427000
*         /*                                                         */ 02428000
*         /***********************************************************/ 02429000
*                                                                  0568 02430000
*         CALL UCBMARK;                                            0568 02431000
*                                                                  0568 02432000
         BAL   @14,UCBMARK                                         0568 02433000
*         /***********************************************************/ 02434000
*         /*                                                         */ 02435000
*         /* PROCESS CHANNELS                                        */ 02436000
*         /*                                                         */ 02437000
*         /***********************************************************/ 02438000
*                                                                  0569 02439000
*/****** CHANNEL *************************************************** */ 02440000
*/* CHANNEL ROUTINE WILL MARK EITHER THE SPECIFIED CHANNEL OFFLINE   */ 02441000
*/* FOR A VARY CHANNEL COMMAND OR WILL MARK ALL CHANNELS OFFLINE     */ 02442000
*/* FOR A VARY CPU COMMAND. A COPY OF THE CHANNEL STATUS IS KEPT IN  */ 02443000
*/* THE WORKAREA FOR BACKOUT IN THE EVENT OF AN ERROR.               */ 02444000
*/* POSSIBLE ERROR INDICATORS ARE: PATHRSVD, OPERCNCL                */ 02445000
*/****************************************************************** */ 02446000
*                                                                  0569 02447000
*         DO;                                                      0569 02448000
*                                                                  0569 02449000
*           /*********************************************************/ 02450000
*           /*                                                       */ 02451000
*           /* ESTABLISH ADDRESSABILITY TO SPECIFIED CPU'S CAT TABLE */ 02452000
*           /* AND ESTABLISH ADDRESSABILITY TO SPECIFIED CPU'S LCCA  */ 02453000
*           /*                                                       */ 02454000
*           /*********************************************************/ 02455000
*                                                                  0570 02456000
*           PCCAPTR=PCCAT00P(HEXCPU1+1);/* PCCA FOR SPECIFIED CPU    */ 02457000
         SLR   @12,@12                                             0570 02458000
         IC    @12,HEXCPU1                                         0570 02459000
         SLA   @12,2                                               0570 02460000
         L     @11,CVTPTR                                          0570 02461000
         L     @06,CVTPCCAT(,@11)                                  0570 02462000
         L     @06,PCCAT00P(@12,@06)                               0570 02463000
         ST    @06,PCCAPTR                                         0570 02464000
*           CATPTR=ADDR(PCCACAT);   /* ADDRESSABILITY TO FIRST CAT 0571 02465000
*                                      ENTRY                         */ 02466000
         LA    CATPTR,PCCACAT(,@06)                                0571 02467000
*           LCCAPTR=LCCAT00P(HEXCPU1+1);/* SET UP ADDRESSABILITY FOR    02468000
*                                      LCCA                          */ 02469000
*                                                                  0572 02470000
         L     @11,CVTLCCAT(,@11)                                  0572 02471000
         L     @12,LCCAT00P(@12,@11)                               0572 02472000
         ST    @12,LCCAPTR                                         0572 02473000
*           /*********************************************************/ 02474000
*           /*                                                       */ 02475000
*           /* SET CHNLSMRK FOOTPRINT THEN COPY STATUS OF CHANNELS IF*/ 02476000
*           /* VARY CPU COMMAND AND MARK CHANNELS OFFLINE            */ 02477000
*           /*                                                       */ 02478000
*           /*********************************************************/ 02479000
*                                                                  0573 02480000
*           CHNLSMRK='1'B;          /* SET CHANNELS MARKED FOOTPRINT */ 02481000
*                                                                  0573 02482000
         OI    CHNLSMRK,B'00100000'                                0573 02483000
*           /*********************************************************/ 02484000
*           /*                                                       */ 02485000
*           /* CHECK FOR CHANNEL COMMAND                             */ 02486000
*           /*                                                       */ 02487000
*           /*********************************************************/ 02488000
*                                                                  0574 02489000
*           IF CHNIND='1'B THEN     /* VARY CHANNEL COMMAND?         */ 02490000
         TM    CHNIND,B'10000000'                                  0574 02491000
         BNO   @RF00574                                            0574 02492000
*             DO;                                                  0575 02493000
*                                                                  0575 02494000
*               /*****************************************************/ 02495000
*               /*                                                   */ 02496000
*               /* GET ADDRESS OF SPECIFIED CHANNEL CAT ENTRY        */ 02497000
*               /*                                                   */ 02498000
*               /*****************************************************/ 02499000
*                                                                  0576 02500000
*               CATPTR=CATPTR+(8*HEXCHN1);/* GET CAT ENTRY ADDRESS   */ 02501000
         SLR   @12,@12                                             0576 02502000
         IC    @12,HEXCHN1                                         0576 02503000
         SLA   @12,3                                               0576 02504000
         ALR   CATPTR,@12                                          0576 02505000
*               CATNOP='1'B;        /* MARK CHANNEL OFFLINE          */ 02506000
         OI    CATNOP(CATPTR),B'01000000'                          0577 02507000
*             END;                                                 0578 02508000
*                                                                  0578 02509000
*           /*********************************************************/ 02510000
*           /*                                                       */ 02511000
*           /* WAS NOT A VARY CHANNEL COMMAND. MUST THEN BE A VARY   */ 02512000
*           /* CPU COMMAND                                           */ 02513000
*           /*                                                       */ 02514000
*           /*********************************************************/ 02515000
*                                                                  0579 02516000
*           ELSE                                                   0579 02517000
*             DO;                                                  0579 02518000
*                                                                  0579 02519000
         B     @RC00574                                            0579 02520000
@RF00574 DS    0H                                                  0580 02521000
*               /*****************************************************/ 02522000
*               /*                                                   */ 02523000
*               /* VARY CPU COMMAND.. CREATE COPY OF CHANNEL STATUS  */ 02524000
*               /* IN COPYCAT THEN MARK CHANNELS OFFLINE             */ 02525000
*               /*                                                   */ 02526000
*               /*****************************************************/ 02527000
*                                                                  0580 02528000
*               DO LOOPCNT=1 TO 16; /* COPY CHANNEL STATUS           */ 02529000
         LA    @12,1                                               0580 02530000
         ST    @12,LOOPCNT                                         0580 02531000
@DL00580 DS    0H                                                  0581 02532000
*                 CATCOPY(LOOPCNT)=CATFLG;/* SAVE CAT FLAG IN      0581 02533000
*                                      WORKAREA                      */ 02534000
         LA    @11,CATCOPY-1(@12)                                  0581 02535000
         MVC   0(1,@11),CATFLG(CATPTR)                             0581 02536000
*                 CATPTR=CATPTR+8;  /* INCREMENT TO NEXT CAT ENTRY   */ 02537000
         AH    CATPTR,@CH00036                                     0582 02538000
*               END;                /* END OF COPYCAT LOOP           */ 02539000
         AL    @12,@CF00067                                        0583 02540000
         ST    @12,LOOPCNT                                         0583 02541000
         CH    @12,@CH00055                                        0583 02542000
         BNH   @DL00580                                            0583 02543000
*               COPYCAT='1'B;       /* SET FOOTPRINT INDICATING THAT    02544000
*                                      CAT HAS BEEN COPIED           */ 02545000
*                                                                  0584 02546000
         OI    COPYCAT,B'00000010'                                 0584 02547000
*               /*****************************************************/ 02548000
*               /*                                                   */ 02549000
*               /* SET POINTER TO ACR RECOVERY CODE IN IEEVWKUP IN   */ 02550000
*               /* CVT FOR USE BY ACR IN THE EVENT OF A SYSTEM       */ 02551000
*               /* FAILURE WHILE ALL CHANNELS ARE MARKED OFFLINE     */ 02552000
*               /*                                                   */ 02553000
*               /*****************************************************/ 02554000
*                                                                  0585 02555000
*               CVTVACR=ADDR(IEEVACR);/* ACR ENTRY POINT             */ 02556000
*                                                                  0585 02557000
         L     @12,@CV03524                                        0585 02558000
         L     @11,CVTPTR                                          0585 02559000
         ST    @12,CVTVACR(,@11)                                   0585 02560000
*               /*****************************************************/ 02561000
*               /*                                                   */ 02562000
*               /* SET INDICATOR FOR ACR INDICATING THAT ALL CHANNELS*/ 02563000
*               /* ON THIS CPU HAVE BEEN MARKED OFFLINE              */ 02564000
*               /*                                                   */ 02565000
*               /*****************************************************/ 02566000
*                                                                  0586 02567000
*               LCCAVARY='1'B;      /* SET ACR BIT                   */ 02568000
*                                                                  0586 02569000
         L     @12,LCCAPTR                                         0586 02570000
         OI    LCCAVARY(@12),B'00000001'                           0586 02571000
*               /*****************************************************/ 02572000
*               /*                                                   */ 02573000
*               /* SET CATPTR BACK TO BEGINNING OF CAT TABLE AND MARK*/ 02574000
*               /* ALL CHANNELS OFFLINE                              */ 02575000
*               /*                                                   */ 02576000
*               /*****************************************************/ 02577000
*                                                                  0587 02578000
*               CATPTR=ADDR(PCCACAT);/* BEGINNING OF CAT TABLE       */ 02579000
         L     CATPTR,PCCAPTR                                      0587 02580000
         LA    CATPTR,PCCACAT(,CATPTR)                             0587 02581000
*               DO LOOPCNT=1 TO 16; /* MARK ALL CHANNELS OFFLINE     */ 02582000
         LA    @12,1                                               0588 02583000
         ST    @12,LOOPCNT                                         0588 02584000
@DL00588 DS    0H                                                  0589 02585000
*                 CATNOP='1'B;      /* SET CHANNEL OFFLINE           */ 02586000
         OI    CATNOP(CATPTR),B'01000000'                          0589 02587000
*                 CATPTR=CATPTR+8;  /* INCREMENT TO NEXT CAT ENTRY   */ 02588000
         AH    CATPTR,@CH00036                                     0590 02589000
*               END;                /* END OF CHANNEL MARK ROUTINE   */ 02590000
         AL    @12,@CF00067                                        0591 02591000
         ST    @12,LOOPCNT                                         0591 02592000
         CH    @12,@CH00055                                        0591 02593000
         BNH   @DL00588                                            0591 02594000
*               PCCAIO=NOIO;        /* THE CPU HAS NO        @G47AN2O   02595000
*                                      CHANNELS ONLINE       @G47AN2O*/ 02596000
         L     @12,PCCAPTR                                         0592 02597000
         NI    PCCAIO(@12),B'10111111'                             0592 02598000
*             END;                  /* END OF VARY CPU CHANNEL MARK  */ 02599000
*                                                                  0593 02600000
*           /*********************************************************/ 02601000
*           /*                                                       */ 02602000
*           /* ALL CHANNELS HAVE BEEN MARKED OFFLINE. FREE UCB ENQ   */ 02603000
*           /* AND WAIT FOR ALL I/O TO QUIET ON SPECIFIED CPU        */ 02604000
*           /*                                                       */ 02605000
*           /*********************************************************/ 02606000
*                                                                  0594 02607000
*TIMELOOP:                          /* TIMER LOOP START              */ 02608000
*           LOOPCNT=0;              /* INITIALIZE LOOP COUNT TO ZERO */ 02609000
@RC00574 DS    0H                                                  0594 02610000
TIMELOOP SLR   @12,@12                                             0594 02611000
         ST    @12,LOOPCNT                                         0594 02612000
*QUITLOOP:                          /* QUIET LOOP                    */ 02613000
*           CALL IEEVIOQ;           /* LINK TO I/O QUIET ROUTINE     */ 02614000
*                                                                  0595 02615000
QUITLOOP BAL   @14,IEEVIOQ                                         0595 02616000
*           /*********************************************************/ 02617000
*           /*                                                       */ 02618000
*           /* CHECK IF ANY ERROR INDICATORS WERE SET DURING I/O     */ 02619000
*           /* QUIET PROCESSING IF SO THEN RETURN CONTROL TO NEXT    */ 02620000
*           /* HIGHER LEVEL OF CONTROL. ERROR INDICATORS THAT MAY    */ 02621000
*           /* HAVE BEEN SET ARE PATHRSVD, CPFAILED. IONOTQT IS NOT  */ 02622000
*           /* AN ERROR INDICATOR                                    */ 02623000
*           /*                                                       */ 02624000
*           /*********************************************************/ 02625000
*                                                                  0596 02626000
*           IF PATHRSVD='1'B&       /* IS RESERVED SWITCH ON @ZA00805*/ 02627000
*               LOOPCNT<10 THEN     /* AND STILL IN 10 SECOND RESERVE   02628000
*                                      WAIT                  @ZA00805*/ 02629000
         TM    PATHRSVD,B'00001000'                                0596 02630000
         BNO   @RF00596                                            0596 02631000
         L     @12,LOOPCNT                                         0596 02632000
         CH    @12,@CH01603                                        0596 02633000
         BNL   @RF00596                                            0596 02634000
*             DO;                   /* WAIT TO ALLOW I/O TIME TO   0597 02635000
*                                      COMPLETE              @ZA00805*/ 02636000
*               PATHRSVD='0'B;      /* RESET RESERVED SWITCH @ZA00805*/ 02637000
         NI    PATHRSVD,B'11110111'                                0598 02638000
*               CATPTR=ADDR(PCCACAT)+((UCBCHA)*LENGTH(CAT));/*     0599 02639000
*                                      CALCULATE PTR TO CAT ENTRY FOR   02640000
*                                      DEVICE WITH RESERVE   @ZA04821*/ 02641000
         L     @12,PCCAPTR                                         0599 02642000
         LA    CATPTR,PCCACAT(,@12)                                0599 02643000
         L     @06,UCBPTR                                          0599 02644000
         SLR   @04,@04                                             0599 02645000
         IC    @04,UCBCHA(,@06)                                    0599 02646000
         SLA   @04,3                                               0599 02647000
         ALR   CATPTR,@04                                          0599 02648000
*               CATNOP='0'B;        /* SET CHANNEL ONLINE    @ZA00805*/ 02649000
         NI    CATNOP(CATPTR),B'10111111'                          0600 02650000
*               PCCAIO=HASIO;       /* THE CPU HAS           @G47AN2O   02651000
*                                      CHANNELS ONLINE       @G47AN2O*/ 02652000
         OI    PCCAIO(@12),B'01000000'                             0601 02653000
*               GEN(STIMER WAIT,BINTVL=SEC1);/* WAIT 1 SECOND      0602 02654000
*                                                            @ZA00805*/ 02655000
         STIMER WAIT,BINTVL=SEC1                                        02656000
*               CATNOP='1'B;        /* SET CHANNEL OFFLINE   @ZA00805*/ 02657000
         OI    CATNOP(CATPTR),B'01000000'                          0603 02658000
*               CALL CHECKIO;       /* NOIO IMPLIES ALL      @G47AN2O   02659000
*                                      CHANNELS OFFLINE      @G47AN2O*/ 02660000
         BAL   @14,CHECKIO                                         0604 02661000
*               LOOPCNT=LOOPCNT+1;  /* INCREMENT LOOP COUNT  @ZA00805*/ 02662000
         LA    @12,1                                               0605 02663000
         AL    @12,LOOPCNT                                         0605 02664000
         ST    @12,LOOPCNT                                         0605 02665000
*               GOTO QUITLOOP;      /* RETRY QUIET ROUTINE   @ZA00805*/ 02666000
         B     QUITLOOP                                            0606 02667000
*             END;                  /* END OF RESERVE WAIT   @ZA00805*/ 02668000
*           IF UCBENQ='1'B THEN     /* CHANNELS WILL REMAIN OFFLINE,    02669000
*                                      SO RELE UCB RESOURCE  @ZA00805*/ 02670000
@RF00596 TM    UCBENQ,B'00000010'                                  0608 02671000
         BNO   @RF00608                                            0608 02672000
*             DO;                   /* RELEASE RESOURCE      @ZA00805*/ 02673000
*               GEN(DEQ  (UCBENQQ,UCBENQR,2,SYSTEM));/*      @ZA00805*/ 02674000
         DEQ  (UCBENQQ,UCBENQR,2,SYSTEM)                                02675000
*               UCBENQ='0'B;        /* RESET FOOTPRINT       @ZA00805*/ 02676000
         NI    UCBENQ,B'11111101'                                  0611 02677000
*             END;                  /*                       @ZA00805*/ 02678000
*           IF ERRORIND^=0 THEN     /* ANY ERROR'S ENCOUNTERED?      */ 02679000
@RF00608 ICM   @12,15,ERRORIND                                     0613 02680000
         BNZ   @RT00613                                            0613 02681000
*             GOTO CHANEXIT;        /* RETURN TO NEXT HIGHER LEVEL   */ 02682000
*                                                                  0614 02683000
*           /*********************************************************/ 02684000
*           /*                                                       */ 02685000
*           /* CHECK IF I/O HAS NOT BEEN QUIETED YET. IF SO WAIT ONE */ 02686000
*           /* SECOND AND TRY AGAIN.                                 */ 02687000
*           /*                                                       */ 02688000
*           /*********************************************************/ 02689000
*                                                                  0615 02690000
*           IF IONOTQT='1'B THEN    /* I/O NOT QUIET YET??           */ 02691000
         TM    IONOTQT,B'00001000'                                 0615 02692000
         BNO   @RF00615                                            0615 02693000
*             DO;                                                  0616 02694000
*               IF LOOPCNT=15 THEN  /* TIME TO ISSUE MESSAGE         */ 02695000
         CLC   LOOPCNT(4),@CF00344                                 0617 02696000
         BNE   @RF00617                                            0617 02697000
*                 DO;                                              0618 02698000
*                   RFY                                            0619 02699000
*                    (R6) RSTD;     /* RESTRICT REGISTER FOR       0619 02700000
*                                      INTERFACE                     */ 02701000
*                   R6=ADDR(WORKAREA);/* POINT TO COMMON WORK AREA   */ 02702000
         LA    R6,WORKAREA                                         0620 02703000
*                   CALL WTORT(2);  /* ISSUE DEVICE BUSY MESSAGE     */ 02704000
         L     @15,@CV03525                                        0621 02705000
         LA    @01,@AL00621                                        0621 02706000
         BALR  @14,@15                                             0621 02707000
*                   RFY                                            0622 02708000
*                    (R6) UNRSTD;   /* RELEASE REG                   */ 02709000
*                 END;                                             0623 02710000
*                                                                  0623 02711000
*               /*****************************************************/ 02712000
*               /*                                                   */ 02713000
*               /* WAS NOT ONE HUNDRED                               */ 02714000
*               /*                                                   */ 02715000
*               /*****************************************************/ 02716000
*                                                                  0624 02717000
*               ELSE                                               0624 02718000
*                                                                  0624 02719000
*                 /***************************************************/ 02720000
*                 /*                                                 */ 02721000
*                 /* GIVE OPERATOR OPPORTUNITY TO CANCEL COMMAND     */ 02722000
*                 /* AFTER 150 TIMES THROUGH LOOP                    */ 02723000
*                 /*                                                 */ 02724000
*                 /***************************************************/ 02725000
*                                                                  0624 02726000
*                 IF LOOPCNT=150 THEN/* TWO HUNDRED TIMES THROUGH  0624 02727000
*                                      LOOP YET?                     */ 02728000
         B     @RC00617                                            0624 02729000
@RF00617 CLC   LOOPCNT(4),@CF03679                                 0624 02730000
         BNE   @RF00624                                            0624 02731000
*                   DO;                                            0625 02732000
*CHNLWTOR:                          /* ISSUE WTOR                    */ 02733000
*                     WTOECB=0;     /* ZERO OUT ECB                  */ 02734000
CHNLWTOR SLR   @12,@12                                             0626 02735000
         ST    @12,WTOECB                                          0626 02736000
*                     REPLY='';     /* BLANK OUT REPLY BUFFER        */ 02737000
         MVI   REPLY,C' '                                          0627 02738000
         MVC   REPLY+1(7),REPLY                                    0627 02739000
*                     WTORPL2=WTOR2;/* COPY PARMS TO PARM LIST       */ 02740000
         MVC   WTORPL2(55),WTOR2                                   0628 02741000
*                     WTORDDD=DDD;  /* COPY DEVICE ADDRESS TO MESSAGE   02742000
*                                      TEXT                          */ 02743000
         MVC   WTORDDD(3),DDD                                      0629 02744000
*                     GEN(WTOR  ,REPLY,,WTOECB,MF=(E,WTORPL2));/*  0630 02745000
*                                      WTOR                          */ 02746000
*                                                                  0630 02747000
         WTOR  ,REPLY,,WTOECB,MF=(E,WTORPL2)                            02748000
*                     /***********************************************/ 02749000
*                     /*                                             */ 02750000
*                     /* WAIT ON REPLY TO WTOR                       */ 02751000
*                     /*                                             */ 02752000
*                     /***********************************************/ 02753000
*                                                                  0631 02754000
*                     GEN(WAIT  ECB=WTOECB);/* WAIT ON REPLY         */ 02755000
*                                                                  0631 02756000
         WAIT  ECB=WTOECB                                               02757000
*                     /***********************************************/ 02758000
*                     /*                                             */ 02759000
*                     /* CHECK FOR VALID REPLY TO WTOR. IF REPLY IS  */ 02760000
*                     /* INVALID REISSUE WTOR                        */ 02761000
*                     /*                                             */ 02762000
*                     /***********************************************/ 02763000
*                                                                  0632 02764000
*                     IF REPLY^='EXTEND'&REPLY^='CANCEL' THEN/* VALID   02765000
*                                      REPLY?                        */ 02766000
         CLC   REPLY(6),@CC03682                                   0632 02767000
         BE    @RF00632                                            0632 02768000
         CLC   REPLY(6),@CC03683                                   0632 02769000
         BNE   @RT00632                                            0632 02770000
*                       GOTO CHNLWTOR;/* REISSUE WTOR                */ 02771000
*                                                                  0633 02772000
*                     /***********************************************/ 02773000
*                     /*                                             */ 02774000
*                     /* OPERATOR ISSUED VALID REPLY EXTEND CHECK OR */ 02775000
*                     /* CANCEL COMMAND BASED ON OPERATOR RESPONSE   */ 02776000
*                     /*                                             */ 02777000
*                     /***********************************************/ 02778000
*                                                                  0634 02779000
*                     IF REPLY='CANCEL' THEN/* OPERATOR REQUEST    0634 02780000
*                                      CANCEL?                       */ 02781000
@RF00632 CLC   REPLY(6),@CC03683                                   0634 02782000
         BNE   @RF00634                                            0634 02783000
*                       DO;                                        0635 02784000
*                         OPERCNCL='1'B;/* SET CANCEL ERROR INDICATOR*/ 02785000
         OI    OPERCNCL,B'00100000'                                0636 02786000
*                         GOTO CHANEXIT;                           0637 02787000
         B     CHANEXIT                                            0637 02788000
*                       END;                                       0638 02789000
*                                                                  0638 02790000
*                     /***********************************************/ 02791000
*                     /*                                             */ 02792000
*                     /* OPERATOR MUST HAVE THEN REPLYED EXTEND.     */ 02793000
*                     /*                                             */ 02794000
*                     /***********************************************/ 02795000
*                                                                  0639 02796000
*                     ELSE          /* OTHERWISE REINITIALIZE LOOP   */ 02797000
*                       GOTO TIMELOOP;/* REINITIALIZE LOOP COUNT     */ 02798000
*                   END;            /* END OF OPERATOR RESPONSE      */ 02799000
*                                                                  0640 02800000
*               /*****************************************************/ 02801000
*               /*                                                   */ 02802000
*               /* LOOP COUNT WAS NOT 100 OR 200 WAIT ONE SECOND THEN*/ 02803000
*               /* TRY I/O QUIET ROUTINE AGAIN                       */ 02804000
*               /*                                                   */ 02805000
*               /*****************************************************/ 02806000
*                                                                  0641 02807000
*               GEN(STIMER  WAIT,BINTVL=SEC1);/* WAIT ONE SECOND     */ 02808000
*                                                                  0641 02809000
@RF00624 DS    0H                                                  0641 02810000
@RC00617 DS    0H                                                  0641 02811000
         STIMER  WAIT,BINTVL=SEC1                                       02812000
*               /*****************************************************/ 02813000
*               /*                                                   */ 02814000
*               /* CHECK FOR ACR CONDITION DURRING WAIT              */ 02815000
*               /*                                                   */ 02816000
*               /*****************************************************/ 02817000
*                                                                  0642 02818000
*               IF SYSSTAT^=CSDCPUAL THEN/* MASK CHANGE?             */ 02819000
         L     @12,CVTPTR                                          0642 02820000
         L     @12,CVTCSD(,@12)                                    0642 02821000
         CLC   SYSSTAT(2),CSDCPUAL(@12)                            0642 02822000
         BE    @RF00642                                            0642 02823000
*                 SYSFAIL='1'B;     /* SET SYSTEM FAILURE FLAG       */ 02824000
         OI    SYSFAIL,B'00000100'                                 0643 02825000
*               LOOPCNT=LOOPCNT+1;  /* INCREMENT LOOP COUNT BY ONE   */ 02826000
@RF00642 LA    @12,1                                               0644 02827000
         AL    @12,LOOPCNT                                         0644 02828000
         ST    @12,LOOPCNT                                         0644 02829000
*               GOTO QUITLOOP;      /* RETRY QUIET ROUTINE           */ 02830000
         B     QUITLOOP                                            0645 02831000
*             END;                  /* END OF I/O NOT QUIET        0646 02832000
*                                      PROCESSING                    */ 02833000
*CHANEXIT:                          /* END OF CHANNEL ROUTINE        */ 02834000
*         END;                      /* END OF QUIET ROUTINE LOOP     */ 02835000
@RF00615 DS    0H                                                  0647 02836000
CHANEXIT DS    0H                                                  0648 02837000
*       END;                                                       0648 02838000
*     IF ERRORIND^=0 THEN           /* ANY ERRORS?                   */ 02839000
@RF00566 ICM   @12,15,ERRORIND                                     0649 02840000
         BNZ   @RT00649                                            0649 02841000
*       GOTO OFFEXIT;               /* RETURN TO MAINLINE            */ 02842000
*                                                                  0650 02843000
*     /***************************************************************/ 02844000
*     /*                                                             */ 02845000
*     /* IF CHANNEL COMMAND THEN SET COMPLETE FLAG, IF CPU COMMAND   */ 02846000
*     /* THEN REMOVE CPU                                             */ 02847000
*     /*                                                             */ 02848000
*     /***************************************************************/ 02849000
*                                                                  0651 02850000
*     IF CHNIND='1'B THEN           /* CHANNEL COMMAND?              */ 02851000
         TM    CHNIND,B'10000000'                                  0651 02852000
         BNO   @RF00651                                            0651 02853000
*       DO;                                                        0652 02854000
*                                                                  0652 02855000
*         /***********************************************************/ 02856000
*         /*                                                         */ 02857000
*         /* CHANNEL IS SUCCESSFULLY OFFLINE.                        */ 02858000
*         /*                                                         */ 02859000
*         /***********************************************************/ 02860000
*                                                                  0653 02861000
*         CHOFFOK='1'B;             /* OFFLINE OK                    */ 02862000
*                                                                  0653 02863000
         OI    CHOFFOK,B'00000100'                                 0653 02864000
*         /***********************************************************/ 02865000
*         /*                                                         */ 02866000
*         /* SET UP LOOP TO SCAN THROUGH ALL CHANNELS ON SUBJECT CPU */ 02867000
*         /* IF ANY CHANNELS ARE STILL ONLINE THEN EXIT              */ 02868000
*         /*                                                         */ 02869000
*         /***********************************************************/ 02870000
*                                                                  0654 02871000
*         PCCAPTR=PCCAT00P(HEXCPUAD+1);/* PCCA POINTER       @Y30CQXA*/ 02872000
         SLR   @12,@12                                             0654 02873000
         ICM   @12,3,HEXCPUAD                                      0654 02874000
         SLA   @12,2                                               0654 02875000
         L     @11,CVTPTR                                          0654 02876000
         L     @11,CVTPCCAT(,@11)                                  0654 02877000
         L     @12,PCCAT00P(@12,@11)                               0654 02878000
         ST    @12,PCCAPTR                                         0654 02879000
*         CATPTR=ADDR(PCCACAT);     /* POINT TO FIRST CAT ENTRY    0655 02880000
*                                                            @Y30CQXA*/ 02881000
         LA    CATPTR,PCCACAT(,@12)                                0655 02882000
*         DO LOOPCNT=1 TO 16;       /* LOOP THROUGH ALL CHANNELS   0656 02883000
*                                                            @Y30CQXA*/ 02884000
         LA    @12,1                                               0656 02885000
         ST    @12,LOOPCNT                                         0656 02886000
@DL00656 DS    0H                                                  0657 02887000
*           IF CATNOP='0'B THEN     /* CHANNEL ONLINE?       @Y30CQXA*/ 02888000
         TM    CATNOP(CATPTR),B'01000000'                          0657 02889000
         BZ    @RT00657                                            0657 02890000
*             GOTO CHNSON;          /* EXIT                  @Y30CQXA*/ 02891000
*           CATPTR=CATPTR+8;        /* UPDATE TO NEXT CAT ENTRY    0659 02892000
*                                                            @Y30CQXA*/ 02893000
         AH    CATPTR,@CH00036                                     0659 02894000
*         END;                      /* END OF CAT TABLE SCAN @Y30CQXA*/ 02895000
         AL    @12,@CF00067                                        0660 02896000
         ST    @12,LOOPCNT                                         0660 02897000
         CH    @12,@CH00055                                        0660 02898000
         BNH   @DL00656                                            0660 02899000
*         PCCAIO=NOIO;              /* THE CPU HAS NO        @G47AN2O   02900000
*                                      CHANNELS ONLINE       @G47AN2O*/ 02901000
*                                                                  0661 02902000
         L     @12,PCCAPTR                                         0661 02903000
         NI    PCCAIO(@12),B'10111111'                             0661 02904000
*         /***********************************************************/ 02905000
*         /*                                                         */ 02906000
*         /* IF CONTROL REACHES THIS POINT ALL CHANNEL ARE OFFLINE.  */ 02907000
*         /* IF THIS WAS A CRH VARY ISSUE DISASSOCIATE/PURGE FOR SS1 */ 02908000
*         /* IF PRESENT                                              */ 02909000
*         /*                                                         */ 02910000
*         /***********************************************************/ 02911000
*                                                                  0662 02912000
*         IF CRH='1'B THEN          /* CRH VARY ?            @G47AN2O*/ 02913000
         TM    CRH,B'00000010'                                     0662 02914000
         BNO   @RF00662                                            0662 02915000
*           DO;                     /*                       @G47AN2O*/ 02916000
*             CALL DISASSOC;        /* GO ISSUE DISASSOCIATE @Y30LPXA*/ 02917000
*                                                                  0664 02918000
         BAL   @14,DISASSOC                                        0664 02919000
*             /*******************************************************/ 02920000
*             /*                                                     */ 02921000
*             /* GO DEACTIVATE THE CHANNEL RECONFIGURATION HARDWARE  */ 02922000
*             /*                                                     */ 02923000
*             /*******************************************************/ 02924000
*                                                                  0665 02925000
*             RFY                                                  0665 02926000
*              (R14,                                               0665 02927000
*               R15) RSTD;          /* RESTRICT REGS         @Y30CQXA*/ 02928000
*             R15=IOXCRHD;          /* ADDRESS OF DEACTIVATE ROUTINE    02929000
*                                                            @Y30CQXA*/ 02930000
         L     @12,CVTPTR                                          0666 02931000
         L     @12,IOCOMPTR(,@12)                                  0666 02932000
         L     @12,IOCXPTR(,@12)                                   0666 02933000
         L     R15,IOXCRHD(,@12)                                   0666 02934000
*             GEN(BALR R14,R15);    /* GO DEACTIVATE CRH     @Y30CQXA*/ 02935000
         BALR R14,R15                                                   02936000
*CHNSON:                            /* EXIT POINT FOR ONLINE CHANNELS   02937000
*                                                            @Y30CQXA*/ 02938000
*           END;                    /* END OF CRH PROCESSING FOR VARY   02939000
*                                      CHANNEL               @Y30CQXA*/ 02940000
*       END;                        /* END OF CHANNEL COMMAND      0669 02941000
*                                      PROCESSING                    */ 02942000
*                                                                  0669 02943000
*     /***************************************************************/ 02944000
*     /*                                                             */ 02945000
*     /* WAS NOT A VARY CHANNEL COMMAND. MUST THEN BE A VARY CPU     */ 02946000
*     /* COMMAND                                                     */ 02947000
*     /*                                                             */ 02948000
*     /***************************************************************/ 02949000
*                                                                  0670 02950000
*     ELSE                                                         0670 02951000
*       DO;                                                        0670 02952000
*                                                                  0670 02953000
         B     @RC00651                                            0670 02954000
@RF00651 DS    0H                                                  0671 02955000
*/****** DSPTCHK *************************************************   */ 02956000
*/* DSPTCHK ROUTINE WILL SET UP CONDITIONS FOR REMOVING CPU FROM     */ 02957000
*/* SYSTEM, PASS CONTROL TO QUIET CODE AND CLEAN UP SYSTEM AFTER     */ 02958000
*/* CPU HAS BEEN REMOVED. ANY ERRORS WILL BE RETURNED TO NEXT HIGHER */ 02959000
*/* LEVEL OF CONTROL.                                                */ 02960000
*/****************************************************************   */ 02961000
*                                                                  0671 02962000
*DSPTCHK:                                                          0671 02963000
*         ;                                                        0671 02964000
DSPTCHK  DS    0H                                                  0672 02965000
*         DO;                                                      0672 02966000
*                                                                  0672 02967000
*           /*********************************************************/ 02968000
*           /*                                                       */ 02969000
*           /* VERIFY THAT SYSTEM STATUS HAS NOT CHANGED SINCE       */ 02970000
*           /* PROCESSING STARTED.                                   */ 02971000
*           /*                                                       */ 02972000
*           /*********************************************************/ 02973000
*                                                                  0673 02974000
*           IF SYSSTAT^=CSDCPUAL THEN/* SYSTEM STATUS CHANGED?       */ 02975000
         L     @12,CVTPTR                                          0673 02976000
         L     @12,CVTCSD(,@12)                                    0673 02977000
         CLC   SYSSTAT(2),CSDCPUAL(@12)                            0673 02978000
         BE    @RF00673                                            0673 02979000
*             DO;                                                  0674 02980000
*               SYSFAIL='1'B;       /* SET SYSTEM STATUS ERROR       */ 02981000
         OI    SYSFAIL,B'00000100'                                 0675 02982000
*               GOTO DSPTEXIT;      /* RETURN TO MAINLINE            */ 02983000
         B     DSPTEXIT                                            0676 02984000
*             END;                                                 0677 02985000
*                                                                  0677 02986000
*           /*********************************************************/ 02987000
*           /*                                                       */ 02988000
*           /* INITIALIZE PARAMETERS FOR QUIET CODE                  */ 02989000
*           /*                                                       */ 02990000
*           /*********************************************************/ 02991000
*                                                                  0678 02992000
*           QUITPTR=ADDR(PARMAREA); /* ADDRESSABILITY FOR PARMS      */ 02993000
@RF00673 LA    @06,PARMAREA                                        0678 02994000
         ST    @06,QUITPTR                                         0678 02995000
*           QTCPUAD=HEXCPUAD;       /* CPU ADDRESS                   */ 02996000
         MVC   QTCPUAD(2,@06),HEXCPUAD                             0679 02997000
*           QTCPUMSK=CPUMSK;        /* CPU MASK                      */ 02998000
*                                                                  0680 02999000
         MVC   QTCPUMSK(2,@06),CPUMSK                              0680 03000000
*           /*********************************************************/ 03001000
*           /*                                                       */ 03002000
*           /* SET TIMER TO CAUSE A TIMER INTERUPT AFTER ONE SECOND  */ 03003000
*           /* TO CAUSE THE DISPATCHER TO RECEIVE CONTROL ON THE     */ 03004000
*           /* ACTIVE CPU AFTER THE SUBJECT CPU HAS GONE OFFLINE.    */ 03005000
*           /* THIS WILL CAUSE THE VALUE TO BE SET INTO THE ACTIVE   */ 03006000
*           /* CPU'S TIMER, SINCE THE CLOCKS OF THE SCHEDULED OFFLINE*/ 03007000
*           /* CPU HAVE BEEN MARKED BAD                              */ 03008000
*           /*                                                       */ 03009000
*           /*********************************************************/ 03010000
*                                                                  0681 03011000
*           GEN(STIMER  REAL,BINTVL=SEC1);/* CAUSE TIMER POP         */ 03012000
*                                                                  0681 03013000
         STIMER  REAL,BINTVL=SEC1                                       03014000
*           /*********************************************************/ 03015000
*           /*                                                       */ 03016000
*           /* PLACE ADDRESS OF QUIET PARMS IN PSA OF CPU GOING      */ 03017000
*           /* OFFLINE                                               */ 03018000
*           /*                                                       */ 03019000
*           /*********************************************************/ 03020000
*                                                                  0682 03021000
*           PCCAPTR=PCCAT00P(HEXCPUAD+1);/* ADDRESS OF SUBJECT CPU 0682 03022000
*                                      PCCA                          */ 03023000
*                                                                  0682 03024000
         SLR   @06,@06                                             0682 03025000
         ICM   @06,3,HEXCPUAD                                      0682 03026000
         LR    @04,@06                                             0682 03027000
         SLA   @04,2                                               0682 03028000
         L     @01,CVTPTR                                          0682 03029000
         L     @01,CVTPCCAT(,@01)                                  0682 03030000
         L     @04,PCCAT00P(@04,@01)                               0682 03031000
         ST    @04,PCCAPTR                                         0682 03032000
*           /*********************************************************/ 03033000
*           /*                                                       */ 03034000
*           /* ASSUME WE ARE RUNNING ON CPU TO BE REMOVED. SET PSA   */ 03035000
*           /* POINTER TO ZERO                                       */ 03036000
*           /*                                                       */ 03037000
*           /*********************************************************/ 03038000
*                                                                  0683 03039000
*           PSAPTR=0;               /* SET PSA POINTER TO ZERO       */ 03040000
*                                                                  0683 03041000
         SLR   PSAPTR,PSAPTR                                       0683 03042000
*           /*********************************************************/ 03043000
*           /*                                                       */ 03044000
*           /* CHECK IF WE ARE OPERATING ON CPU TO GO OFFLINE        */ 03045000
*           /*                                                       */ 03046000
*           /*********************************************************/ 03047000
*                                                                  0684 03048000
*           IF PSACPUPA^=HEXCPUAD THEN/* ON DIFFERENT CPU?           */ 03049000
         CH    @06,PSACPUPA(,PSAPTR)                               0684 03050000
         BE    @RF00684                                            0684 03051000
*             PSAPTR=PCCAPSAV;      /* ADDRESS OF SUBJECT CPU PSA    */ 03052000
         L     PSAPTR,PCCAPSAV(,@04)                               0685 03053000
*           PSAWKVAP=QUITPTR;       /* STORE PARM ADDRESS            */ 03054000
*                                                                  0686 03055000
@RF00684 MVC   PSAWKVAP(4,PSAPTR),QUITPTR                          0686 03056000
*           /*********************************************************/ 03057000
*           /*                                                       */ 03058000
*           /* PLACE POINTER TO QUIET CODE IN CVT FOR USE BY         */ 03059000
*           /* DISPATCHER DURING TASK SWITCH                         */ 03060000
*           /*                                                       */ 03061000
*           /*********************************************************/ 03062000
*                                                                  0687 03063000
*           CVTQUIT=ADDR(IEEVQUIT); /* UPDATE CVT POINTER            */ 03064000
*                                                                  0687 03065000
         L     @06,CVTPTR                                          0687 03066000
         L     @04,@CV03523                                        0687 03067000
         ST    @04,CVTQUIT(,@06)                                   0687 03068000
*           /*********************************************************/ 03069000
*           /*                                                       */ 03070000
*           /* SET DISPATCHER HOOK IN LCCA OF CPU TO GO OFFLINE      */ 03071000
*           /*                                                       */ 03072000
*           /*********************************************************/ 03073000
*                                                                  0688 03074000
*           LCCAPTR=LCCAT00P(HEXCPUAD+1);/* ADDRESSABILITY TO LCCA OF   03075000
*                                      SUBJECT CPU                   */ 03076000
         SLR   @04,@04                                             0688 03077000
         ICM   @04,3,HEXCPUAD                                      0688 03078000
         SLA   @04,2                                               0688 03079000
         L     @01,CVTLCCAT(,@06)                                  0688 03080000
         L     @11,LCCAT00P(@04,@01)                               0688 03081000
         ST    @11,LCCAPTR                                         0688 03082000
*           LCCAVCPU='1'B;          /* SET DISPATCHER HOOK           */ 03083000
*                                                                  0689 03084000
         OI    LCCAVCPU(@11),B'01000000'                           0689 03085000
*           /*********************************************************/ 03086000
*           /*                                                       */ 03087000
*           /* LOAD CPU ADDRESS AND CAUSE TASK SWITCH IN SUBJECT CPU */ 03088000
*           /*                                                       */ 03089000
*           /*********************************************************/ 03090000
*                                                                  0690 03091000
*           RFY                                                    0690 03092000
*            (R1) RSTD;             /* RESTRICT REG ONE              */ 03093000
*           R1=PCCAT00P(HEXCPUAD+1);/* GET PCCA ADDRESS              */ 03094000
         L     @06,CVTPCCAT(,@06)                                  0691 03095000
         L     R1,PCCAT00P(@04,@06)                                0691 03096000
*           GEN REFS(CVTIPCDS,CVTIPCRI,CVTIPCRP,CVT)               0692 03097000
*               ( RPSGNL  SWITCH,CPU=(1));/* CAUSE TASK SWITCH       */ 03098000
          RPSGNL  SWITCH,CPU=(1)                                        03099000
*           RFY                                                    0693 03100000
*            (R1) UNRSTD;           /* RELEASE REG ONE               */ 03101000
*                                                                  0693 03102000
*           /*********************************************************/ 03103000
*           /*                                                       */ 03104000
*           /* SET UP PSA POINTER TO POINT TO PSA OF CPU GOING       */ 03105000
*           /* OFFLINE                                               */ 03106000
*           /*                                                       */ 03107000
*           /*********************************************************/ 03108000
*                                                                  0694 03109000
*           PCCAPTR=PCCAT00P(HEXCPUAD+1);/* PCCA OF OFFLINE CPU    0694 03110000
*                                                            @YM06029*/ 03111000
         SLR   @06,@06                                             0694 03112000
         ICM   @06,3,HEXCPUAD                                      0694 03113000
         SLA   @06,2                                               0694 03114000
         L     @04,CVTPTR                                          0694 03115000
         L     @04,CVTPCCAT(,@04)                                  0694 03116000
         L     @06,PCCAT00P(@06,@04)                               0694 03117000
         ST    @06,PCCAPTR                                         0694 03118000
*           PSAPTR=PCCAPSAV;        /* VIRTUAL ADDRESS OF PSA      0695 03119000
*                                                            @YM06029*/ 03120000
*                                                                  0695 03121000
         L     PSAPTR,PCCAPSAV(,@06)                               0695 03122000
*           /*********************************************************/ 03123000
*           /*                                                       */ 03124000
*           /* CHECK TO SEE IF SUBJECT CPU HAS BEEN MARKED DEAD IN   */ 03125000
*           /* CSDCPUAL FIELD                                        */ 03126000
*           /*                                                       */ 03127000
*           /*********************************************************/ 03128000
*                                                                  0696 03129000
*           DO LOOPCNT=0 TO 20 WHILE((CSDCPUAL&CPUMSK)^=0);        0696 03130000
         SLR   @06,@06                                             0696 03131000
         ST    @06,LOOPCNT                                         0696 03132000
@DL00696 L     @06,CVTPTR                                          0696 03133000
         L     @06,CVTCSD(,@06)                                    0696 03134000
         SLR   @04,@04                                             0696 03135000
         ICM   @04,3,CPUMSK                                        0696 03136000
         SLR   @11,@11                                             0696 03137000
         ICM   @11,3,CSDCPUAL(@06)                                 0696 03138000
         NR    @04,@11                                             0696 03139000
         LTR   @04,@04                                             0696 03140000
         BZ    @DC00696                                            0696 03141000
*             GEN(STIMER  WAIT,BINTVL=SEC1);/* WAIT ONE SECOND       */ 03142000
*                                                                  0697 03143000
         STIMER  WAIT,BINTVL=SEC1                                       03144000
*             /*******************************************************/ 03145000
*             /*                                                     */ 03146000
*             /* CHECK FOR A MACHINE CHECK OF CPU TO BE REMOVED      */ 03147000
*             /*                                                     */ 03148000
*             /*******************************************************/ 03149000
*                                                                  0698 03150000
*             IF PCCACPUM^='0'B THEN/* MACHINE CHECK?                */ 03151000
         L     @06,PCCAPTR                                         0698 03152000
         TM    PCCACPUM(@06),B'10000000'                           0698 03153000
         BNZ   @RT00698                                            0698 03154000
*               GOTO DSPTMSG;       /* GO ISSUE MESSAGE              */ 03155000
*           END;                    /* END OF WAIT LOOP              */ 03156000
*                                                                  0700 03157000
         LA    @06,1                                               0700 03158000
         AL    @06,LOOPCNT                                         0700 03159000
         ST    @06,LOOPCNT                                         0700 03160000
         CH    @06,@CH00228                                        0700 03161000
         BNH   @DL00696                                            0700 03162000
@DC00696 DS    0H                                                  0701 03163000
*           /*********************************************************/ 03164000
*           /*                                                       */ 03165000
*           /* CPU HAS BEEN MARKED DEAD OR LOOP HAS GONE TO END CHECK*/ 03166000
*           /* IF CPU HAS BEEN MARKED DEAD                           */ 03167000
*           /*                                                       */ 03168000
*           /*********************************************************/ 03169000
*                                                                  0701 03170000
*           IF(CSDCPUAL&CPUMSK)^=0 THEN/* CPU DEAD??                 */ 03171000
         L     @06,CVTPTR                                          0701 03172000
         L     @06,CVTCSD(,@06)                                    0701 03173000
         SLR   @04,@04                                             0701 03174000
         ICM   @04,3,CPUMSK                                        0701 03175000
         SLR   @11,@11                                             0701 03176000
         ICM   @11,3,CSDCPUAL(@06)                                 0701 03177000
         NR    @04,@11                                             0701 03178000
         LTR   @04,@04                                             0701 03179000
         BZ    @RF00701                                            0701 03180000
*             DO;                                                  0702 03181000
*               LCCAVCPU='0'B;      /* RESET DISPATCHER HOOK         */ 03182000
         L     @12,LCCAPTR                                         0703 03183000
         NI    LCCAVCPU(@12),B'10111111'                           0703 03184000
*               CPUNRESP='1'B;      /* SET CPU UNRESPONSIVE ERROR FLG*/ 03185000
         OI    CPUNRESP,B'00010000'                                0704 03186000
*               GOTO DSPTEXIT;      /* RETURN TO HIGHER LEVEL        */ 03187000
         B     DSPTEXIT                                            0705 03188000
*             END;                                                 0706 03189000
*                                                                  0706 03190000
*           /*********************************************************/ 03191000
*           /*                                                       */ 03192000
*           /* CHECK IF COMPLETE BIT HAS BEEN SET BY QUIT CODE       */ 03193000
*           /*                                                       */ 03194000
*           /*********************************************************/ 03195000
*                                                                  0707 03196000
*           IF QTCOMP^='1'B THEN    /* COMPLETE BIT SET?             */ 03197000
@RF00701 L     @06,QUITPTR                                         0707 03198000
         TM    QTCOMP(@06),B'10000000'                             0707 03199000
         BO    @RF00707                                            0707 03200000
*             DO;                                                  0708 03201000
*                                                                  0708 03202000
*               /*****************************************************/ 03203000
*               /*                                                   */ 03204000
*               /* WAIT ONE SECOND FOR QUIET CODE TO COMPLETE AND SET*/ 03205000
*               /* ERROR FLAG IF NOT FINISHED                        */ 03206000
*               /*                                                   */ 03207000
*               /*****************************************************/ 03208000
*                                                                  0709 03209000
*               GEN(STIMER  WAIT,BINTVL=SEC1);/* WAIT ONE SECOND     */ 03210000
         STIMER  WAIT,BINTVL=SEC1                                       03211000
*               IF QTCOMP^='1'B THEN/* COMPLETE NOW?                 */ 03212000
         L     @06,QUITPTR                                         0710 03213000
         TM    QTCOMP(@06),B'10000000'                             0710 03214000
         BO    @RF00710                                            0710 03215000
*DSPTMSG:                                                          0711 03216000
*                 UNKNSTAT='1'B;    /* WRITE ERROR MESSAGE           */ 03217000
DSPTMSG  OI    UNKNSTAT,B'00000100'                                0711 03218000
*             END;                  /* END OF COMPLETE CHECK         */ 03219000
*                                                                  0712 03220000
*           /*********************************************************/ 03221000
*           /*                                                       */ 03222000
*           /* QUIET CODE HAS SET COMPLETE FLAG. CONTINUE PROCESSING */ 03223000
*           /*                                                       */ 03224000
*           /*********************************************************/ 03225000
*                                                                  0713 03226000
*           ELSE                                                   0713 03227000
*             CPUOFFOK='1'B;        /* SET OFFLINE OK FLAG           */ 03228000
*                                                                  0713 03229000
         B     @RC00707                                            0713 03230000
@RF00707 OI    CPUOFFOK,B'00001000'                                0713 03231000
*           /*********************************************************/ 03232000
*           /*                                                       */ 03233000
*           /* IF VARY CPU,OFFLINE,KEEPCHAN (168MP),ACTIVATE CRH.    */ 03234000
*           /* NOTE THAT THE CPU STATUS MAY BE UNKNOWN, BUT IN THAT  */ 03235000
*           /* CASE CRH IS STILL NEEDED AND IF CRH ACTIVATION FAILS, */ 03236000
*           /* AN ATTEMPT IS MADE TO BRING THE CPU BACK ONLINE.      */ 03237000
*           /*                                               @G557P2L*/ 03238000
*           /*                                                       */ 03239000
*           /*********************************************************/ 03240000
*                                                                  0714 03241000
*           IF CPUCRH='1'B THEN                                    0714 03242000
@RC00707 TM    CPUCRH,B'00000001'                                  0714 03243000
         BNO   @RF00714                                            0714 03244000
*             DO;                   /* ACTIVATE CRH          @G557P2L*/ 03245000
*               UNKNSTAT='0'B;      /* TURN OFF UNKNOWN STATUS. IF 0716 03246000
*                                      CRH FAILS AND UNABLE TO BRING    03247000
*                                      CPU BACK ON, ANOTHER MSG WILL    03248000
*                                      INDICATE UNKNOWN STATUS -   0716 03249000
*                                      RE-IPL.               @G557P2L*/ 03250000
         NI    UNKNSTAT,B'11111011'                                0716 03251000
*               KPCHANFL='1'B;      /* SET IN CASE UNEXPECTED HAPPENS   03252000
*                                                            @ZM45610*/ 03253000
         OI    KPCHANFL,B'01000000'                                0717 03254000
*               R15=IOXCRHA;        /* GET CRH ACTIVATION ADDRESS  0718 03255000
*                                                            @G557P2L*/ 03256000
         L     @06,CVTPTR                                          0718 03257000
         L     @06,IOCOMPTR(,@06)                                  0718 03258000
         L     @06,IOCXPTR(,@06)                                   0718 03259000
         L     R15,IOXCRHA(,@06)                                   0718 03260000
*               GEN( BALR R14,R15); /* LINK TO CRH ACTIVATION      0719 03261000
*                                                            @G557P2L*/ 03262000
          BALR R14,R15                                                  03263000
*               IF RETCODE^=0&RETCODE^=4 THEN                      0720 03264000
         LTR   RETCODE,RETCODE                                     0720 03265000
         BZ    @RF00720                                            0720 03266000
         CH    RETCODE,@CH00076                                    0720 03267000
         BE    @RF00720                                            0720 03268000
*                 DO;               /* CRH FAILED?           @G557P2L*/ 03269000
*                   PARMAREA=''B;   /* ZERO OUT IEEVWKUP'S PARMS   0722 03270000
*                                                            @ZM45610*/ 03271000
         XC    PARMAREA(109),PARMAREA                              0722 03272000
*                   CALL ONLINEP;   /* BRING CPU BACK ONLINE @G557P2L*/ 03273000
         BAL   @14,ONLINEP                                         0723 03274000
*                   CPUONOK='0'B;   /* RESET ONLINE OKAY FLAG @G5572L*/ 03275000
         NI    CPUONOK,B'10111111'                                 0724 03276000
*                   GOTO OFFEXIT;   /* GET OUT - UNSUCCESSFUL CRH  0725 03277000
*                                                            @G557P2L*/ 03278000
         B     OFFEXIT                                             0725 03279000
*                 END;              /* END CRH FAILED        @G557P2L*/ 03280000
*               ELSE                                               0727 03281000
*                 KPCHANFL='0'B;    /* CRH OKAY              @ZM45610*/ 03282000
@RF00720 NI    KPCHANFL,B'10111111'                                0727 03283000
*             END;                  /* END CPUCRH TEST       @G557P2L*/ 03284000
*                                                                  0728 03285000
*           /*********************************************************/ 03286000
*           /*                                                       */ 03287000
*           /* CLEAN UP REMAINING STORAGE AREAS                      */ 03288000
*           /*                                                       */ 03289000
*           /*********************************************************/ 03290000
*                                                                  0729 03291000
*           DO;                                                    0729 03292000
*                                                                  0729 03293000
@RF00714 DS    0H                                                  0730 03294000
*/******** GTFOFF ************************************************** */ 03295000
*/* GTFOFF EXIT WILL FREE ANY REMAINING GTF AREAS AFTER A CPU HAS    */ 03296000
*/* BEEN REMOVED FROM THE SYSTEM. INPUT TO ROUTINE IS CPU ADDRESS    */ 03297000
*/* IN REGISTER ONE AND SAVE AREA POINTED TO BY REG 13               */ 03298000
*/********************************************************************/ 03299000
*                                                                  0730 03300000
*             RFY                                                  0730 03301000
*              (R1) RSTD;           /* RELEASE REG ONE FOR INTERFACE */ 03302000
*             R1=HEXCPUAD;          /* LOAD CPU ADDRESS              */ 03303000
*                                                                  0731 03304000
         SLR   R1,R1                                               0731 03305000
         ICM   R1,3,HEXCPUAD                                       0731 03306000
*             /*******************************************************/ 03307000
*             /*                                                     */ 03308000
*             /* LINK TO GTF STORAGE FREE ROUTINE                    */ 03309000
*             /*                                                     */ 03310000
*             /*******************************************************/ 03311000
*                                                                  0732 03312000
*             GEN(LINK EP=AHLVCOFF);                               0732 03313000
         LINK EP=AHLVCOFF                                               03314000
*             RFY                                                  0733 03315000
*              (R1) UNRSTD;         /* RELEASE REG ONE               */ 03316000
*                                                                  0733 03317000
*             /*******************************************************/ 03318000
*             /*                                                     */ 03319000
*             /* NO RETURN CODES ARE RETURNED FROM GTF ROUTINE       */ 03320000
*             /*                                                     */ 03321000
*             /*******************************************************/ 03322000
*                                                                  0734 03323000
*           END;                    /* ** END OF GTF OFF ROUTINE     */ 03324000
*           DO;                                                    0735 03325000
*                                                                  0735 03326000
*/****** FREEMCEL ************************************************** */ 03327000
*/* FREEMCEL ROUTINE WILL FREE THE EXTENDED MACHINE CHECK LOGOUT     */ 03328000
*/* AREA OF THE CPU TO BE REMOVED FROM THE SYSTEM. ROUTINE IS LINKED */ 03329000
*/* TO FROM MAINLINE. ANY ERRORS ARE IGNORED                         */ 03330000
*/****************************************************************** */ 03331000
*                                                                  0736 03332000
*             RFY                                                  0736 03333000
*              (R0,                                                0736 03334000
*               R1,                                                0736 03335000
*               R14,                                               0736 03336000
*               R15) RSTD;          /* RESTRICT REGISTERS            */ 03337000
*                                                                  0736 03338000
*             /*******************************************************/ 03339000
*             /*                                                     */ 03340000
*             /* SET UP FUNCTION CODE AND CPU ADDRESS FOR RMS        */ 03341000
*             /* INTERFACE                                           */ 03342000
*             /*                                                     */ 03343000
*             /*******************************************************/ 03344000
*                                                                  0737 03345000
*             R0=4;                 /* LOAD FUNCTION CODE            */ 03346000
         LA    R0,4                                                0737 03347000
*             R1=HEXCPUAD;          /* LOAD CPU ADDRESS              */ 03348000
         SLR   R1,R1                                               0738 03349000
         ICM   R1,3,HEXCPUAD                                       0738 03350000
*             R15=RVTPBUCR;         /* LOAD ADDRESS OF RMS INTERFACE */ 03351000
*                                                                  0739 03352000
         L     @06,CVTPTR                                          0739 03353000
         L     @06,RVTPTR(,@06)                                    0739 03354000
         L     R15,RVTPBUCR(,@06)                                  0739 03355000
*             /*******************************************************/ 03356000
*             /*                                                     */ 03357000
*             /* LINK TO RMS ROUTINE                                 */ 03358000
*             /*                                                     */ 03359000
*             /*******************************************************/ 03360000
*                                                                  0740 03361000
*             GEN(BALR 14,15);      /* LINK TO RMS                   */ 03362000
         BALR 14,15                                                     03363000
*             RFY                                                  0741 03364000
*              (R0,                                                0741 03365000
*               R1,                                                0741 03366000
*               R14,                                               0741 03367000
*               R15) UNRSTD;        /* RELEASE REGISTERS             */ 03368000
*           END;                    /* ** END OF FREEMCEL ROUTINE    */ 03369000
*           CALL SAVARSUB;          /* FREE CPU RELATED SAVE AREAS   */ 03370000
         BAL   @14,SAVARSUB                                        0743 03371000
*           CPFAILED='0'B;          /* IGNORE ANY ERRORS FROM FREE   */ 03372000
*                                                                  0744 03373000
         NI    CPFAILED,B'11111011'                                0744 03374000
*           /*********************************************************/ 03375000
*           /*                                                       */ 03376000
*           /* FREE FRR STACKS RELATED TO THIS CPU. ROUND ADDRESS    */ 03377000
*           /* DOWN TO 8 BYTE MULTIPLE FOR FREE                      */ 03378000
*           /*                                                       */ 03379000
*           /*********************************************************/ 03380000
*                                                                  0745 03381000
*           COREPTR=(PSASSTK&'FFFFFFF8'X);/* ROUND DOWN              */ 03382000
         L     @06,PSASSTK(,PSAPTR)                                0745 03383000
         N     @06,@CF03706                                        0745 03384000
         ST    @06,COREPTR                                         0745 03385000
*           SUBPOOL=245;            /* SUBPOOL NUMBER TO FREE        */ 03386000
         MVI   SUBPOOL,X'F5'                                       0746 03387000
*           GETLENG=YSTAKLEN;       /* LENGTH TO FREE                */ 03388000
         MVC   GETLENG(2),@CH02073                                 0747 03389000
*           CALL FREECORE;          /* FREE OLD FRR STACKS           */ 03390000
*                                                                  0748 03391000
         BAL   @14,FREECORE                                        0748 03392000
*           /*********************************************************/ 03393000
*           /*                                                       */ 03394000
*           /* GO FREE CPU'S PSA                                     */ 03395000
*           /*                                                       */ 03396000
*           /*********************************************************/ 03397000
*                                                                  0749 03398000
*           CALL PSAFREE;           /* FREE PSA                      */ 03399000
         BAL   @14,PSAFREE                                         0749 03400000
*           IF CPUCRH^='1'B THEN    /* FREE PSA IF CPUCRH='1'B ALSO.    03401000
*                                                            @ZM45599*/ 03402000
*                                                                  0750 03403000
         TM    CPUCRH,B'00000001'                                  0750 03404000
         BO    @RF00750                                            0750 03405000
*             /*******************************************************/ 03406000
*             /*                                                     */ 03407000
*             /* IF LOST OF CPU CAUSED LOST OF PATHS INFORM MSS THAT */ 03408000
*             /* A CPU HAS BEEN REMOVED FROM SYSTEM          @G557P2L*/ 03409000
*             /*                                                     */ 03410000
*             /*******************************************************/ 03411000
*                                                                  0751 03412000
*             CALL DISASSOC;        /* GO DISASSOCIATE CPU'S @ZM30463*/ 03413000
         BAL   @14,DISASSOC                                        0751 03414000
*DSPTEXIT:                                                         0752 03415000
*         END;                      /* END OF DSPTCHK ROUTINE        */ 03416000
@RF00750 DS    0H                                                  0752 03417000
DSPTEXIT DS    0H                                                  0753 03418000
*       END;                                                       0753 03419000
*   END;                            /* ** END OF OFFLINE DO GROUP    */ 03420000
*OFFEXIT:                                                          0755 03421000
*   END;                            /* END OF OFFLINE PROC           */ 03422000
@EL00002 DS    0H                                                  0755 03423000
@EF00002 DS    0H                                                  0755 03424000
@ER00002 LM    @14,@12,@SA00002                                    0755 03425000
         BR    @14                                                 0755 03426000
*ONLINEP:                                                          0756 03427000
*   PROC;                                                          0756 03428000
*                                                                  0756 03429000
ONLINEP  STM   @14,@12,@SA00003                                    0756 03430000
*/****** ONLINE **************************************************** */ 03431000
*/* ONLINE ROUTINE WILL ROUTE CONTROL TO ROUTINES TO LOGICALLY ADD   */ 03432000
*/* EITHER A CHANNEL OR CPU TO THE SYSTEM. EACH ROUTINE WILL MONITOR */ 03433000
*/* ANY ROUTINE OPERATING BELOW IT AND ANY ERROR THAT IS FOUND WILL  */ 03434000
*/* BE PERCULATED TO THE NEXT HIGHER LEVEL OF CONTROL                */ 03435000
*/********************************************************************/ 03436000
*                                                                  0757 03437000
*   /*****************************************************************/ 03438000
*   /*                                                               */ 03439000
*   /* CHECK IF THIS IS A CHANNEL COMMAND                            */ 03440000
*   /*                                                               */ 03441000
*   /*****************************************************************/ 03442000
*                                                                  0757 03443000
*   IF CHNIND='1'B THEN             /* CHANNEL COMMAND?              */ 03444000
         TM    CHNIND,B'10000000'                                  0757 03445000
         BNO   @RF00757                                            0757 03446000
*/****** CHANON **************************************************** */ 03447000
*/* CHANON ROUTINE WILL PASS CONTROL TO THE CAT TABLE INITIALIZATION */ 03448000
*/* ROUTINE TO TEST A CHANNEL AND MARK IT ONLINE. POSSIBLE ERROR     */ 03449000
*/* INDICATORS ARE: CHNTOPER, CPFAILED,CHONLINE                      */ 03450000
*/****************************************************************** */ 03451000
*                                                                  0758 03452000
*     DO;                                                          0758 03453000
*                                                                  0758 03454000
*       /*************************************************************/ 03455000
*       /*                                                           */ 03456000
*       /* CHECK IF THIS IS A CRH VARY AND IF SO PERFORM SPECIAL     */ 03457000
*       /* PROCESSING REQUIRED FOR REMOTE CHANNELS                   */ 03458000
*       /*                                                           */ 03459000
*       /*************************************************************/ 03460000
*                                                                  0759 03461000
*       IF CRH='1'B THEN            /* CRH VARY?             @Y30CQXA*/ 03462000
         TM    CRH,B'00000010'                                     0759 03463000
         BNO   @RF00759                                            0759 03464000
*         DO;                       /*                       @Y30CQXA*/ 03465000
*                                                                  0760 03466000
*           /*********************************************************/ 03467000
*           /*                                                       */ 03468000
*           /* CHECK IF A PCCA EXISTS FOR THE SUBJECT CPU AND IF NOT */ 03469000
*           /* OBTAIN NEW PCCA WITH ALL CHANNELS MARKED OFFLINE      */ 03470000
*           /*                                                       */ 03471000
*           /*********************************************************/ 03472000
*                                                                  0761 03473000
*           IF NOPCCA='1'B THEN     /* PCCA EXIST?           @Y30CQXA*/ 03474000
         TM    NOPCCA,B'00100000'                                  0761 03475000
         BNO   @RF00761                                            0761 03476000
*             CALL PSACCA;          /* GO GET NEW PCCA       @Y30CQXA*/ 03477000
*                                                                  0762 03478000
         BAL   @14,PSACCA                                          0762 03479000
*           /*********************************************************/ 03480000
*           /*                                                       */ 03481000
*           /* CHECK IF SUBJECT CHANNEL IS ALREADY ONLINE            */ 03482000
*           /*                                                       */ 03483000
*           /*********************************************************/ 03484000
*                                                                  0763 03485000
*           PCCAPTR=PCCAT00P(HEXCPUAD+1);/* PCCA ADDRESS     @Y30CQXA*/ 03486000
@RF00761 SLR   @11,@11                                             0763 03487000
         ICM   @11,3,HEXCPUAD                                      0763 03488000
         SLA   @11,2                                               0763 03489000
         L     @06,CVTPTR                                          0763 03490000
         L     @06,CVTPCCAT(,@06)                                  0763 03491000
         L     @11,PCCAT00P(@11,@06)                               0763 03492000
         ST    @11,PCCAPTR                                         0763 03493000
*           CATPTR=ADDR(PCCACAT)+(8*HEXCHNAD);/* CAT ENTRY ADDRESS 0764 03494000
*                                                            @Y30CQXA*/ 03495000
*                                                                  0764 03496000
         LA    CATPTR,PCCACAT(,@11)                                0764 03497000
         SLR   @06,@06                                             0764 03498000
         ICM   @06,3,HEXCHNAD                                      0764 03499000
         SLA   @06,3                                               0764 03500000
         ALR   CATPTR,@06                                          0764 03501000
*           /*********************************************************/ 03502000
*           /*                                                       */ 03503000
*           /* CHECK IF CHANNEL IS ALREADY ONLINE                    */ 03504000
*           /*                                                       */ 03505000
*           /*********************************************************/ 03506000
*                                                                  0765 03507000
*           IF CATNOP='0'B THEN     /* CHANNEL ONLINE?       @Y30CQXA*/ 03508000
         TM    CATNOP(CATPTR),B'01000000'                          0765 03509000
         BNZ   @RF00765                                            0765 03510000
*             DO;                   /*                       @Y30CQXA*/ 03511000
*               CHISON='1'B;        /* SET ALREADY ONLINE FOOTPRINT     03512000
*                                                            @Y30CQXA*/ 03513000
         OI    CHISON,B'00001000'                                  0767 03514000
*               GOTO CHONEXIT;      /* EXIT                  @Y30CQXA*/ 03515000
         B     CHONEXIT                                            0768 03516000
*             END;                  /*                       @Y30CQXA*/ 03517000
*                                                                  0769 03518000
*           /*********************************************************/ 03519000
*           /*                                                       */ 03520000
*           /* CALL IOS ROUTINE TO ISSUE STIDC INSTRUCTION FOR       */ 03521000
*           /* CHANNEL ON OFFLINE CPU.                               */ 03522000
*           /*                                                       */ 03523000
*           /*********************************************************/ 03524000
*                                                                  0770 03525000
*           RFY                                                    0770 03526000
*            (R1,                                                  0770 03527000
*             R14,                                                 0770 03528000
*             R15) RSTD;            /* RESTRICT REGISTERS    @Y30CQXA*/ 03529000
@RF00765 DS    0H                                                  0771 03530000
*           R1=HEXCHNAD*256;        /* CHANNEL ADDRESS       @Y30CQXA*/ 03531000
         SLR   R1,R1                                               0771 03532000
         ICM   R1,3,HEXCHNAD                                       0771 03533000
         SLA   R1,8                                                0771 03534000
*           R15=IOXSTIDC;           /* ADDRESS OF STIDC ROUTINE    0772 03535000
*                                                            @Y30CQXA*/ 03536000
         L     @11,CVTPTR                                          0772 03537000
         L     @11,IOCOMPTR(,@11)                                  0772 03538000
         L     @11,IOCXPTR(,@11)                                   0772 03539000
         L     R15,IOXSTIDC(,@11)                                  0772 03540000
*           GEN(BALR R14,R15);      /* LINK TO IOS           @Y30CQXA*/ 03541000
*                                                                  0773 03542000
         BALR R14,R15                                                   03543000
*           /*********************************************************/ 03544000
*           /*                                                       */ 03545000
*           /* ON RETURN THE CONDITION CODE FROM THE STIDC           */ 03546000
*           /* INSTRUCTION WILL BE IN THE HIGH ORDER BYTE OF REGISTER*/ 03547000
*           /* 1                                                     */ 03548000
*           /*                                                       */ 03549000
*           /*********************************************************/ 03550000
*                                                                  0774 03551000
*           TEMPWORK=R1;            /* STORE R1 CONTENTS     @Y30CQXA*/ 03552000
         ST    R1,TEMPWORK                                         0774 03553000
*           RFY                                                    0775 03554000
*            (R1,                                                  0775 03555000
*             R14,                                                 0775 03556000
*             R15) UNRSTD;          /* RELEASE REGS          @Y30CQXA*/ 03557000
*                                                                  0775 03558000
*           /*********************************************************/ 03559000
*           /*                                                       */ 03560000
*           /* CHECK FOR CONDITION CODE 3 RETURN FROM STIDC          */ 03561000
*           /*                                                       */ 03562000
*           /*********************************************************/ 03563000
*                                                                  0776 03564000
*           IF CCBIT1='1'B&CCBIT2='1'B THEN/* CC = 3?        @Y30CQXA*/ 03565000
         TM    CCBIT1,B'00110000'                                  0776 03566000
         BNO   @RF00776                                            0776 03567000
*             DO;                   /*                       @Y30CQXA*/ 03568000
*               CHNTOPER='1'B;      /* SET ERROR FLAG        @Y30CQXA*/ 03569000
         OI    CHNTOPER,B'00000001'                                0778 03570000
*               GOTO CHONEXIT;      /* RETURN TO MAINLINE    @Y30CQXA*/ 03571000
         B     CHONEXIT                                            0779 03572000
*             END;                  /*                       @Y30CQXA*/ 03573000
*                                                                  0780 03574000
*           /*********************************************************/ 03575000
*           /*                                                       */ 03576000
*           /* CONDITION CODE WAS NOT 3, MARK CHANNEL ONLINE         */ 03577000
*           /*                                                       */ 03578000
*           /*********************************************************/ 03579000
*                                                                  0781 03580000
*           CATNOP='0'B;            /* MARK CHANNEL ONLINE   @Y30CQXA*/ 03581000
*                                                                  0781 03582000
@RF00776 NI    CATNOP(CATPTR),B'10111111'                          0781 03583000
*           /*********************************************************/ 03584000
*           /*                                                       */ 03585000
*           /* IF CONDITION CODE WAS ZERO, THEN MOVE CHANNEL ID      */ 03586000
*           /* INFORMATION INTO CAT AND RESET ID INVALID BIT         */ 03587000
*           /*                                                       */ 03588000
*           /*********************************************************/ 03589000
*                                                                  0782 03590000
*           IF CCBIT1^='1'B&CCBIT2^='1'B THEN/* CC=0?        @Y30CQXA*/ 03591000
         TM    CCBIT1,B'00110000'                                  0782 03592000
         BNZ   @RF00782                                            0782 03593000
*             DO;                   /*                       @Y30CQXA*/ 03594000
*                                                                  0783 03595000
*               /*****************************************************/ 03596000
*               /*                                                   */ 03597000
*               /* RESET INVALID BIT, AND MOVE ID INFORMATION IN     */ 03598000
*               /*                                                   */ 03599000
*               /*****************************************************/ 03600000
*                                                                  0784 03601000
*               CATCHID=FLCCHNID;   /* MOVE CHANNEL ID INFORMATION IN   03602000
*                                                            @Y30CQXA*/ 03603000
         MVC   CATCHID(4,CATPTR),FLCCHNID(PSAPTR)                  0784 03604000
*               CATNID='0'B;        /* MARK ID VALID         @Y30CQXA*/ 03605000
         NI    CATNID(CATPTR),B'11110111'                          0785 03606000
*             END;                  /*                       @Y30CQXA*/ 03607000
*                                                                  0786 03608000
*           /*********************************************************/ 03609000
*           /*                                                       */ 03610000
*           /* CHECK IF CRH IS ALREADY ACTIVE. AND IF NOT ACTIVATE   */ 03611000
*           /* CRH.                                                  */ 03612000
*           /*                                                       */ 03613000
*           /*********************************************************/ 03614000
*                                                                  0787 03615000
*           IF CVTCRCA=0 THEN       /* CRH ACTIVE?           @Y30CQXA*/ 03616000
@RF00782 L     @12,CVTPTR                                          0787 03617000
         ICM   @11,15,CVTCRCA(@12)                                 0787 03618000
         BNZ   @RF00787                                            0787 03619000
*             DO;                   /*                       @Y30CQXA*/ 03620000
*               CALL AINIT;         /* MSS ASSOCIATE ROUTINE @Y30LPXA*/ 03621000
         BAL   @14,AINIT                                           0789 03622000
*               RFY                                                0790 03623000
*                (R1,                                              0790 03624000
*                 R14,                                             0790 03625000
*                 R15) RSTD;        /* RESTRICT REGS         @Y30CQXA*/ 03626000
*               R1=PCCAT00P(HEXCPUAD+1);/* CPU ADDRESS       @Y30CQXA*/ 03627000
         SLR   @12,@12                                             0791 03628000
         ICM   @12,3,HEXCPUAD                                      0791 03629000
         SLA   @12,2                                               0791 03630000
         L     @11,CVTPTR                                          0791 03631000
         L     @11,CVTPCCAT(,@11)                                  0791 03632000
         L     R1,PCCAT00P(@12,@11)                                0791 03633000
*               GEN(DSGNL ICPUR,CPU=(1));/* RESET CPU        @Y30CQXA*/ 03634000
*                                                                  0792 03635000
         DSGNL ICPUR,CPU=(1)                                            03636000
*               /*****************************************************/ 03637000
*               /*                                                   */ 03638000
*               /* SET ACTIVATION FILED ERROR FLAG IN CASE OF ERROR  */ 03639000
*               /* DURING LINK                                       */ 03640000
*               /*                                                   */ 03641000
*               /*****************************************************/ 03642000
*                                                                  0793 03643000
*               CRHFAIL='1'B;       /* SET ERROR FLAG        @Y30CQXA*/ 03644000
*                                                                  0793 03645000
         OI    CRHFAIL,B'10000000'                                 0793 03646000
*               /*****************************************************/ 03647000
*               /*                                                   */ 03648000
*               /* CALL IOS ROUTINE TO ACTIVATE CRH.                 */ 03649000
*               /*                                                   */ 03650000
*               /*****************************************************/ 03651000
*                                                                  0794 03652000
*               R15=IOXCRHA;        /* ADDRESS OF ACTIVATE ROUTINE 0794 03653000
*                                                            @Y30CQXA*/ 03654000
         L     @12,CVTPTR                                          0794 03655000
         L     @12,IOCOMPTR(,@12)                                  0794 03656000
         L     @12,IOCXPTR(,@12)                                   0794 03657000
         L     R15,IOXCRHA(,@12)                                   0794 03658000
*               GEN(BALR R14,R15);  /* LINK TO IOS           @Y30CQXA*/ 03659000
*                                                                  0795 03660000
         BALR R14,R15                                                   03661000
*               /*****************************************************/ 03662000
*               /*                                                   */ 03663000
*               /* CHECK IF ACTIVATED OK.                            */ 03664000
*               /*                                                   */ 03665000
*               /*****************************************************/ 03666000
*                                                                  0796 03667000
*               IF RETCODE^=0&RETCODE^=4 THEN/* ERROR?       @Y30CQXA*/ 03668000
         LTR   RETCODE,RETCODE                                     0796 03669000
         BZ    @RF00796                                            0796 03670000
         CH    RETCODE,@CH00076                                    0796 03671000
         BE    @RF00796                                            0796 03672000
*                 DO;                                              0797 03673000
*                                                                  0797 03674000
*                   /*************************************************/ 03675000
*                   /*                                               */ 03676000
*                   /* CRH NOT ACTIVATED. CANCEL ASSOCIATE JUST DONE,*/ 03677000
*                   /* AND SET ERROR FLAG FOR CLEANUP ROUTINE        */ 03678000
*                   /*                                               */ 03679000
*                   /*************************************************/ 03680000
*                                                                  0798 03681000
*                   CALL DISASSOC;  /* CALL DISASSOC ROUTINE @Y30LPXA*/ 03682000
         BAL   @14,DISASSOC                                        0798 03683000
*                   CATNOP='1'B;    /* MARK CHANNEL OFFLINE  @Y30CQXA*/ 03684000
         OI    CATNOP(CATPTR),B'01000000'                          0799 03685000
*                   GOTO CHONEXIT;  /* EXIT                  @Y30CQXA*/ 03686000
         B     CHONEXIT                                            0800 03687000
*                 END;                                             0801 03688000
*                                                                  0801 03689000
*               /*****************************************************/ 03690000
*               /*                                                   */ 03691000
*               /* PROCESSING WAS SUCESSFUL RESET ERROR FLAG         */ 03692000
*               /*                                                   */ 03693000
*               /*****************************************************/ 03694000
*                                                                  0802 03695000
*               CRHFAIL='0'B;       /* RESET ERROR FLAG      @Y30CQXA*/ 03696000
@RF00796 NI    CRHFAIL,B'01111111'                                 0802 03697000
*             END;                  /* END OF CRH PROCESSING @Y30CQXA*/ 03698000
*         END;                      /* END OF CRH DO GROUP   @Y30CQXA*/ 03699000
*                                                                  0804 03700000
*       /*************************************************************/ 03701000
*       /*                                                           */ 03702000
*       /* WAS NOT A CRH VARY. MUST THEN BE A NORMAL CHANNEL VARY    */ 03703000
*       /*                                                           */ 03704000
*       /*************************************************************/ 03705000
*                                                                  0805 03706000
*       ELSE                        /*                       @Y30CQXA*/ 03707000
*         DO;                       /*                       @Y30CQXA*/ 03708000
*                                                                  0805 03709000
         B     @RC00759                                            0805 03710000
@RF00759 DS    0H                                                  0806 03711000
*           /*********************************************************/ 03712000
*           /*                                                       */ 03713000
*           /* SET UP ADDRESSABILITY TO CAT ENTRY FOR SPECIFIC       */ 03714000
*           /* CHANNEL AND DETERMINE IF CHANNEL IS ALREADY ONLINE    */ 03715000
*           /*                                                       */ 03716000
*           /*********************************************************/ 03717000
*                                                                  0806 03718000
*           PCCAPTR=PCCAT00P(HEXCPUAD+1);/* GET PCCA ADDRESS         */ 03719000
         SLR   @12,@12                                             0806 03720000
         ICM   @12,3,HEXCPUAD                                      0806 03721000
         SLA   @12,2                                               0806 03722000
         L     @11,CVTPTR                                          0806 03723000
         L     @11,CVTPCCAT(,@11)                                  0806 03724000
         L     @12,PCCAT00P(@12,@11)                               0806 03725000
         ST    @12,PCCAPTR                                         0806 03726000
*           CATPTR=ADDR(PCCACAT)+(8*HEXCHNAD);/* CAT ENTRY ADDRESS   */ 03727000
*                                                                  0807 03728000
         LA    CATPTR,PCCACAT(,@12)                                0807 03729000
         SLR   @12,@12                                             0807 03730000
         ICM   @12,3,HEXCHNAD                                      0807 03731000
         SLA   @12,3                                               0807 03732000
         ALR   CATPTR,@12                                          0807 03733000
*           /*********************************************************/ 03734000
*           /*                                                       */ 03735000
*           /* CHECK TO DETERMINE IF CHANNEL IS ALREADY ONLINE       */ 03736000
*           /*                                                       */ 03737000
*           /*********************************************************/ 03738000
*                                                                  0808 03739000
*           IF CATNOP='0'B THEN     /* CHANNEL ONLINE?               */ 03740000
         TM    CATNOP(CATPTR),B'01000000'                          0808 03741000
         BNZ   @RF00808                                            0808 03742000
*             CHISON='1'B;          /* SET ONLINE MESSAGE            */ 03743000
         OI    CHISON,B'00001000'                                  0809 03744000
*           ELSE                                                   0810 03745000
*             DO;                                                  0810 03746000
*                                                                  0810 03747000
         B     @RC00808                                            0810 03748000
@RF00808 DS    0H                                                  0811 03749000
*               /*****************************************************/ 03750000
*               /*                                                   */ 03751000
*               /* CHANNEL WAS NOT ALREADY ONLINE, INITIALIZE        */ 03752000
*               /* PARAMETERS TO PASS TO CAT TABLE INIT ROUTINE      */ 03753000
*               /*                                                   */ 03754000
*               /*****************************************************/ 03755000
*                                                                  0811 03756000
*               CHNADDR=(HEXCHNAD*256);/* PASS CHANNEL ADDRESS       */ 03757000
*                                                                  0811 03758000
         SLR   CHNADDR,CHNADDR                                     0811 03759000
         ICM   CHNADDR,3,HEXCHNAD                                  0811 03760000
         SLA   CHNADDR,8                                           0811 03761000
*               /*****************************************************/ 03762000
*               /*                                                   */ 03763000
*               /* PASS CONTROL TO WAKEUP ROUTINE TO TEST CHANNEL AND*/ 03764000
*               /* INIT CAT TABLE                                    */ 03765000
*               /*                                                   */ 03766000
*               /*****************************************************/ 03767000
*                                                                  0812 03768000
*               RFY                                                0812 03769000
*                (R1,                                              0812 03770000
*                 R11,                                             0812 03771000
*                 R12,                                             0812 03772000
*                 R14,                                             0812 03773000
*                 R15) RSTD;        /* RESTRICT REGISTERS FOR IPC    */ 03774000
*               R11=CHNADDR;        /* POINTER TO PARAMETERS @ZA05995*/ 03775000
         LR    R11,CHNADDR                                         0813 03776000
*               R12=ADDR(IEEVTCH);  /* ADDRESS OF WAKEUP CODE        */ 03777000
         L     R12,@CV03521                                        0814 03778000
*               R1=PCCAPTR;         /* PCCA ADDRESS OF SUBJECT CPU   */ 03779000
         L     R1,PCCAPTR                                          0815 03780000
*               GEN(RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11));/*    0816 03781000
*                                      ACTIVATE TCH ROUTINE          */ 03782000
*                                                                  0816 03783000
         RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11)                        03784000
*               /*****************************************************/ 03785000
*               /*                                                   */ 03786000
*               /* CONTROL WILL BE RETURNED EITHER AFTER COMPLETING  */ 03787000
*               /* TEST OR WITH A RETURN CODE INDICATING THAT THIS IS*/ 03788000
*               /* A UNIPROCESSOR IN WHICH CASE A DIRECT BRANCH TO   */ 03789000
*               /* THE ROUTINE WILL BE TAKEN                         */ 03790000
*               /*                                                   */ 03791000
*               /*****************************************************/ 03792000
*                                                                  0817 03793000
*               RFY                                                0817 03794000
*                (R1,                                              0817 03795000
*                 R11,                                             0817 03796000
*                 R12,                                             0817 03797000
*                 R14,                                             0817 03798000
*                 R15) UNRSTD;      /* RELEASE REGISTERS             */ 03799000
*               RFY                                                0818 03800000
*                (RETCODE) RSTD;    /* RESTRICT RETURN CODE REG      */ 03801000
*                                                                  0818 03802000
*               /*****************************************************/ 03803000
*               /*                                                   */ 03804000
*               /* CHECK FOR A UNIPROCESSOR                          */ 03805000
*               /*                                                   */ 03806000
*               /*****************************************************/ 03807000
*                                                                  0819 03808000
*               IF RETCODE=16 THEN  /* ONE CPU?                      */ 03809000
         CH    RETCODE,@CH00055                                    0819 03810000
         BNE   @RF00819                                            0819 03811000
*                 DO;                                              0820 03812000
*                                                                  0820 03813000
*                   /*************************************************/ 03814000
*                   /*                                               */ 03815000
*                   /* WE ARE RUNNING ON A UNIPROCESSOR. SAVE ALL    */ 03816000
*                   /* REGISTERS AND BRANCH TO WAKEUP CODE. ONLY     */ 03817000
*                   /* REGISTER SAVED IS REGISTER 13                 */ 03818000
*                   /*                                               */ 03819000
*                   /*************************************************/ 03820000
*                                                                  0821 03821000
*                   RFY                                            0821 03822000
*                    (R1,                                          0821 03823000
*                     R14,                                         0821 03824000
*                     R15) RSTD;    /* RESTRICT LINK REGISTERS       */ 03825000
*                   R1=CHNADDR;     /* POINT TO PARAMETERS FOR     0822 03826000
*                                      ROUTINE               @ZA05995*/ 03827000
         LR    R1,CHNADDR                                          0822 03828000
*                   R14=ADDR(REGSAVEA);/* ADDRESS OF SAVE AREA       */ 03829000
         LA    R14,REGSAVEA                                        0823 03830000
*                   R15=ADDR(IEEVTCH);/* ADDRESS OF TEST CHANNEL   0824 03831000
*                                      ENTRY POINT                   */ 03832000
*                                                                  0824 03833000
         L     R15,@CV03521                                        0824 03834000
*                   /*************************************************/ 03835000
*                   /*                                               */ 03836000
*                   /* SAVE ALL REGISTERS IN SAVE AREA, AND KEEP     */ 03837000
*                   /* ADDRESS OF SAVE AREA IN REGISTER 13 WHICH IS  */ 03838000
*                   /* NOT TOUCHED ACROSS CALL. RESTORE ALL REGISTERS*/ 03839000
*                   /* ON RETURN                                     */ 03840000
*                   /*                                               */ 03841000
*                   /*************************************************/ 03842000
*                                                                  0825 03843000
*                   GENERATE;                                      0825 03844000
        STM   R0,R15,0(R14)           SAVE ALL REGISTERS                03845000
        LR    R13,R14                 SAVE ADDRESS OF SAVE AREA         03846000
        BALR  R14,R15                 LINK TO ROUTINE                   03847000
        LM    R0,R15,0(R13)           RESTORE ALL REGISTERS             03848000
*                   RFY                                            0826 03849000
*                    (R1,                                          0826 03850000
*                     R14,                                         0826 03851000
*                     R15) UNRSTD;  /* RELEASE REGISTERS             */ 03852000
*                 END;              /* END OF UNIPROCESSOR PROCESSING*/ 03853000
*               ELSE                                               0828 03854000
*                                                                  0828 03855000
*                 /***************************************************/ 03856000
*                 /*                                                 */ 03857000
*                 /* WAS NOT UNIPROCESSOR. CHECK FOR SUCCESSFUL      */ 03858000
*                 /* EXECUTION                                       */ 03859000
*                 /*                                                 */ 03860000
*                 /***************************************************/ 03861000
*                                                                  0828 03862000
*                 IF RETCODE^=0 THEN/* SUCCESSFUL?                   */ 03863000
         B     @RC00819                                            0828 03864000
@RF00819 LTR   RETCODE,RETCODE                                     0828 03865000
         BZ    @RF00828                                            0828 03866000
*                   DO;                                            0829 03867000
*                     CPFAILED='1'B;/* SET ERROR FLAG                */ 03868000
         OI    CPFAILED,B'00000100'                                0830 03869000
*                     GOTO CHONEXIT;/* RETURN TO NEXT LEVEL          */ 03870000
         B     CHONEXIT                                            0831 03871000
*                   END;                                           0832 03872000
*                                                                  0832 03873000
*               /*****************************************************/ 03874000
*               /*                                                   */ 03875000
*               /* CONTROL HAS RETURNED FROM WAKEUP ROUTINE. VERIFY  */ 03876000
*               /* THAT CHANNEL HAS BEEN MARKED ONLINE               */ 03877000
*               /*                                                   */ 03878000
*               /*****************************************************/ 03879000
*                                                                  0833 03880000
*               IF CATNOP='1'B THEN /* CHANNEL OFFLINE               */ 03881000
@RF00828 DS    0H                                                  0833 03882000
@RC00819 TM    CATNOP(CATPTR),B'01000000'                          0833 03883000
         BNO   @RF00833                                            0833 03884000
*                 DO;                                              0834 03885000
*                   CHNTOPER='1'B;  /* SET CHANNEL NOT OPER MSG      */ 03886000
         OI    CHNTOPER,B'00000001'                                0835 03887000
*                   GOTO CHONEXIT;  /* RETURN TO NEXT LEVEL          */ 03888000
         B     CHONEXIT                                            0836 03889000
*                 END;                                             0837 03890000
*             END;                                                 0838 03891000
@RF00833 DS    0H                                                  0839 03892000
*         END;                      /*                       @Y30CQXA*/ 03893000
*                                                                  0839 03894000
@RC00808 DS    0H                                                  0840 03895000
*       /*************************************************************/ 03896000
*       /*                                                           */ 03897000
*       /* CHANNEL HAS BEEN MARKED ONLINE, PROCESS ANY DEVICES THAT  */ 03898000
*       /* SHOULD BE BROUGHT ONLINE                                  */ 03899000
*       /*                                                           */ 03900000
*       /*************************************************************/ 03901000
*                                                                  0840 03902000
*       CHONOK='1'B;                /* INDICATE CHANNEL ONLINE       */ 03903000
@RC00759 OI    CHONOK,B'00100000'                                  0840 03904000
*       CALL DEVCHK;                /* GO TO DEVCHECK ROUTINE        */ 03905000
         BAL   @14,DEVCHK                                          0841 03906000
*       CHONLINE='1'B;              /* SET ONLINE FOOTPRINT          */ 03907000
         OI    CHONLINE,B'00000010'                                0842 03908000
*CHONEXIT:                                                         0843 03909000
*     END;                                                         0843 03910000
*   ELSE                                                           0844 03911000
*                                                                  0844 03912000
*     /***************************************************************/ 03913000
*     /*                                                             */ 03914000
*     /* WAS NOT A CHANNEL COMMAND. MUST THEN BE A CPU COMMAND       */ 03915000
*     /*                                                             */ 03916000
*     /***************************************************************/ 03917000
*                                                                  0844 03918000
*     DO;                                                          0844 03919000
*                                                                  0844 03920000
         B     @RC00757                                            0844 03921000
@RF00757 DS    0H                                                  0845 03922000
*       /*************************************************************/ 03923000
*       /*                                                           */ 03924000
*       /* DETERMINE IF THE SUBJECT CPU IS ALREADY ONLINE            */ 03925000
*       /*                                                           */ 03926000
*       /*************************************************************/ 03927000
*                                                                  0845 03928000
*       IF(CSDCPUAL&CPUMSK)^=0 THEN /* CPU ONLINE ALREADY?           */ 03929000
         L     @14,CVTPTR                                          0845 03930000
         L     @14,CVTCSD(,@14)                                    0845 03931000
         SLR   @06,@06                                             0845 03932000
         ICM   @06,3,CPUMSK                                        0845 03933000
         SLR   @04,@04                                             0845 03934000
         ICM   @04,3,CSDCPUAL(@14)                                 0845 03935000
         NR    @06,@04                                             0845 03936000
         LTR   @06,@06                                             0845 03937000
         BZ    @RF00845                                            0845 03938000
*         CPUISON='1'B;             /* SET ONLINE FLAG               */ 03939000
*                                                                  0846 03940000
         OI    CPUISON,B'00010000'                                 0846 03941000
*       /*************************************************************/ 03942000
*       /*                                                           */ 03943000
*       /* CPU WAS NOT ONLINE. NEEDS TO BE BROUGHT ONLINE. SET UP TO */ 03944000
*       /* BRING CPU ONLINE                                          */ 03945000
*       /*                                                           */ 03946000
*       /*************************************************************/ 03947000
*                                                                  0847 03948000
*       ELSE                                                       0847 03949000
*         DO;                                                      0847 03950000
*                                                                  0847 03951000
         B     @RC00845                                            0847 03952000
@RF00845 DS    0H                                                  0848 03953000
*           /*********************************************************/ 03954000
*           /*                                                       */ 03955000
*           /* CPU WAS NOT ONLINE. NEEDS TO BE BROUGHT ONLINE        */ 03956000
*           /*                                                       */ 03957000
*           /*********************************************************/ 03958000
*                                                                  0848 03959000
*           DO;                                                    0848 03960000
*                                                                  0848 03961000
*/****** PREPARE *****************************************************/ 03962000
*/* PREPARE ROUTINE WILL OBTAIN AND INITIALIZE ALL NECESSARY STORAGE */ 03963000
*/* AREAS REQUIRED FOR A NEW CPU COMING ONLINE. ADDITIONALLY THE     */ 03964000
*/* RESTART RESOURCE WILL BE OBTAINED AND A RESTART PSW SET UP TO    */ 03965000
*/* POINT TO VARY CPU WAKE UP CODE RESIDENT IN THE SYSTEM NUCELUS    */ 03966000
*/********************************************************************/ 03967000
*                                                                  0849 03968000
*             /*******************************************************/ 03969000
*             /*                                                     */ 03970000
*             /* SET UP POINTERS FOR SUBJECT CPU IF THEY EXIST FROM  */ 03971000
*             /* BEFORE                                              */ 03972000
*             /*                                                     */ 03973000
*             /*******************************************************/ 03974000
*                                                                  0849 03975000
*             LCCAPTR=LCCAT00P(HEXCPUAD+1);/* SET LCCA POINTER       */ 03976000
         SLR   @14,@14                                             0849 03977000
         ICM   @14,3,HEXCPUAD                                      0849 03978000
         SLA   @14,2                                               0849 03979000
         L     @06,CVTPTR                                          0849 03980000
         L     @04,CVTLCCAT(,@06)                                  0849 03981000
         L     @04,LCCAT00P(@14,@04)                               0849 03982000
         ST    @04,LCCAPTR                                         0849 03983000
*             PCCAPTR=PCCAT00P(HEXCPUAD+1);/* SET PCCA POINTER       */ 03984000
*                                                                  0850 03985000
         L     @06,CVTPCCAT(,@06)                                  0850 03986000
         L     @14,PCCAT00P(@14,@06)                               0850 03987000
         ST    @14,PCCAPTR                                         0850 03988000
*             /*******************************************************/ 03989000
*             /*                                                     */ 03990000
*             /* CHECK IF POINTERS EXIST                             */ 03991000
*             /*                                                     */ 03992000
*             /*******************************************************/ 03993000
*                                                                  0851 03994000
*             IF PCCAPTR=0&LCCAPTR=0 THEN/* EXIST ?                  */ 03995000
*                                                                  0851 03996000
         SLR   @06,@06                                             0851 03997000
         CR    @14,@06                                             0851 03998000
         BNE   @RF00851                                            0851 03999000
         CR    @04,@06                                             0851 04000000
         BE    @RT00851                                            0851 04001000
*               /*****************************************************/ 04002000
*               /*                                                   */ 04003000
*               /* IF OLD CCA'S DO NOT EXIST THEN GO DIRECTLY TO     */ 04004000
*               /* OBTAIN NEW AREAS                                  */ 04005000
*               /*                                                   */ 04006000
*               /*****************************************************/ 04007000
*                                                                  0852 04008000
*               GOTO GETPSA;        /* GO OBTAIN NEW STORAGE AREAS   */ 04009000
*                                                                  0852 04010000
*             /*******************************************************/ 04011000
*             /*                                                     */ 04012000
*             /* CCA'S EXIST FOR CPU, CHECK IF PSA EXISTS AND IF SO  */ 04013000
*             /* FREE ANY STORAGE AREAS ASSOCIATED WITH IT.          */ 04014000
*             /*                                                     */ 04015000
*             /*******************************************************/ 04016000
*                                                                  0853 04017000
*             IF PCCAPSAV^=0 THEN   /* PSA EXIST?                    */ 04018000
@RF00851 L     @14,PCCAPTR                                         0853 04019000
         L     @14,PCCAPSAV(,@14)                                  0853 04020000
         LTR   @14,@14                                             0853 04021000
         BZ    @RF00853                                            0853 04022000
*               DO;                                                0854 04023000
*                 PSAPTR=PCCAPSAV;  /* POINT TO PSA TO BE FREED      */ 04024000
*                                                                  0855 04025000
         LR    PSAPTR,@14                                          0855 04026000
*                 /***************************************************/ 04027000
*                 /*                                                 */ 04028000
*                 /* FREE EXTENDED LOGOUT AREAS                      */ 04029000
*                 /*                                                 */ 04030000
*                 /***************************************************/ 04031000
*                                                                  0856 04032000
*                 DO;                                              0856 04033000
*                                                                  0856 04034000
*/****** FREEMCEL ************************************************** */ 04035000
*/* FREEMCEL ROUTINE WILL FREE THE EXTENDED MACHINE CHECK LOGOUT     */ 04036000
*/* AREA OF THE CPU TO BE REMOVED FROM THE SYSTEM. ROUTINE IS LINKED */ 04037000
*/* TO FROM MAINLINE. ANY ERRORS ARE IGNORED                         */ 04038000
*/****************************************************************** */ 04039000
*                                                                  0857 04040000
*                   RFY                                            0857 04041000
*                    (R0,                                          0857 04042000
*                     R1,                                          0857 04043000
*                     R14,                                         0857 04044000
*                     R15) RSTD;    /* RESTRICT REGISTERS            */ 04045000
*                                                                  0857 04046000
*                   /*************************************************/ 04047000
*                   /*                                               */ 04048000
*                   /* SET UP FUNCTION CODE AND CPU ADDRESS FOR RMS  */ 04049000
*                   /* INTERFACE                                     */ 04050000
*                   /*                                               */ 04051000
*                   /*************************************************/ 04052000
*                                                                  0858 04053000
*                   R0=4;           /* LOAD FUNCTION CODE            */ 04054000
         LA    R0,4                                                0858 04055000
*                   R1=HEXCPUAD;    /* LOAD CPU ADDRESS              */ 04056000
         SLR   R1,R1                                               0859 04057000
         ICM   R1,3,HEXCPUAD                                       0859 04058000
*                   R15=RVTPBUCR;   /* LOAD ADDRESS OF RMS INTERFACE */ 04059000
*                                                                  0860 04060000
         L     @06,CVTPTR                                          0860 04061000
         L     @06,RVTPTR(,@06)                                    0860 04062000
         L     R15,RVTPBUCR(,@06)                                  0860 04063000
*                   /*************************************************/ 04064000
*                   /*                                               */ 04065000
*                   /* LINK TO RMS ROUTINE                           */ 04066000
*                   /*                                               */ 04067000
*                   /*************************************************/ 04068000
*                                                                  0861 04069000
*                   GEN(BALR 14,15);/* LINK TO RMS                   */ 04070000
         BALR 14,15                                                     04071000
*                   RFY                                            0862 04072000
*                    (R0,                                          0862 04073000
*                     R1,                                          0862 04074000
*                     R14,                                         0862 04075000
*                     R15) UNRSTD;  /* RELEASE REGISTERS             */ 04076000
*                 END;              /* ** END OF FREEMCEL ROUTINE    */ 04077000
*                                                                  0864 04078000
*                 /***************************************************/ 04079000
*                 /*                                                 */ 04080000
*                 /* CHECK IF FRR STACKS EXIST FOR SUBJECT CPU AND IF*/ 04081000
*                 /* SO FREE STORAGE                                 */ 04082000
*                 /*                                                 */ 04083000
*                 /***************************************************/ 04084000
*                                                                  0864 04085000
*                 IF PSACSTK^=0 THEN/* FRR STACKS EXIST              */ 04086000
         ICM   @14,15,PSACSTK(PSAPTR)                              0864 04087000
         BZ    @RF00864                                            0864 04088000
*                   DO;                                            0865 04089000
*                                                                  0865 04090000
*                     /***********************************************/ 04091000
*                     /*                                             */ 04092000
*                     /* ROUND ADDRESS DOWN TO EIGHT BYTE MULTIPLE   */ 04093000
*                     /* FOR FREE                                    */ 04094000
*                     /*                                             */ 04095000
*                     /***********************************************/ 04096000
*                                                                  0866 04097000
*                     COREPTR=(PSASSTK&'FFFFFFF8'X);/* SET UP ADDRESS   04098000
*                                      TO FREE                       */ 04099000
         L     @14,PSASSTK(,PSAPTR)                                0866 04100000
         N     @14,@CF03706                                        0866 04101000
         ST    @14,COREPTR                                         0866 04102000
*                     GETLENG=YSTAKLEN;/* GET LENGTH OF FRR STACK    */ 04103000
         MVC   GETLENG(2),@CH02073                                 0867 04104000
*                     SUBPOOL=245;  /* SET UP STACK LENGTH           */ 04105000
         MVI   SUBPOOL,X'F5'                                       0868 04106000
*                     CALL FREECORE;/* FREE STORAGE                  */ 04107000
         BAL   @14,FREECORE                                        0869 04108000
*                   END;                                           0870 04109000
*                                                                  0870 04110000
*                 /***************************************************/ 04111000
*                 /*                                                 */ 04112000
*                 /* FREE CPU'S PSA STORAGE                          */ 04113000
*                 /*                                                 */ 04114000
*                 /***************************************************/ 04115000
*                                                                  0871 04116000
*                 CALL PSAFREE;                                    0871 04117000
*                                                                  0871 04118000
@RF00864 BAL   @14,PSAFREE                                         0871 04119000
*                 /***************************************************/ 04120000
*                 /*                                                 */ 04121000
*                 /* ALLOW GTF TO FREE ANY STORAGE AREAS THAT MAY BE */ 04122000
*                 /* REMAING FROM PREVIOUS TIMES.                    */ 04123000
*                 /*                                                 */ 04124000
*                 /***************************************************/ 04125000
*                                                                  0872 04126000
*                 DO;                                              0872 04127000
*                                                                  0872 04128000
*/******** GTFOFF ************************************************** */ 04129000
*/* GTFOFF EXIT WILL FREE ANY REMAINING GTF AREAS AFTER A CPU HAS    */ 04130000
*/* BEEN REMOVED FROM THE SYSTEM. INPUT TO ROUTINE IS CPU ADDRESS    */ 04131000
*/* IN REGISTER ONE AND SAVE AREA POINTED TO BY REG 13               */ 04132000
*/********************************************************************/ 04133000
*                                                                  0873 04134000
*                   RFY                                            0873 04135000
*                    (R1) RSTD;     /* RELEASE REG ONE FOR INTERFACE */ 04136000
*                   R1=HEXCPUAD;    /* LOAD CPU ADDRESS              */ 04137000
*                                                                  0874 04138000
         SLR   R1,R1                                               0874 04139000
         ICM   R1,3,HEXCPUAD                                       0874 04140000
*                   /*************************************************/ 04141000
*                   /*                                               */ 04142000
*                   /* LINK TO GTF STORAGE FREE ROUTINE              */ 04143000
*                   /*                                               */ 04144000
*                   /*************************************************/ 04145000
*                                                                  0875 04146000
*                   GEN(LINK EP=AHLVCOFF);                         0875 04147000
         LINK EP=AHLVCOFF                                               04148000
*                   RFY                                            0876 04149000
*                    (R1) UNRSTD;   /* RELEASE REG ONE               */ 04150000
*                                                                  0876 04151000
*                   /*************************************************/ 04152000
*                   /*                                               */ 04153000
*                   /* NO RETURN CODES ARE RETURNED FROM GTF ROUTINE */ 04154000
*                   /*                                               */ 04155000
*                   /*************************************************/ 04156000
*                                                                  0877 04157000
*                 END;              /* ** END OF GTF OFF ROUTINE     */ 04158000
*                                                                  0877 04159000
*                 /***************************************************/ 04160000
*                 /*                                                 */ 04161000
*                 /* CHECK IF CPU RELATED SAVE AREA IS PRESENT AND IF*/ 04162000
*                 /* SO FREE                                         */ 04163000
*                 /*                                                 */ 04164000
*                 /***************************************************/ 04165000
*                                                                  0878 04166000
*                 IF LCCAPTR^=0&LCCACPUS^=0 THEN/* CPU RELATED SAVE     04167000
*                                      AREA EXIST                    */ 04168000
         L     @14,LCCAPTR                                         0878 04169000
         SLR   @06,@06                                             0878 04170000
         CR    @14,@06                                             0878 04171000
         BE    @RF00878                                            0878 04172000
         C     @06,LCCACPUS(,@14)                                  0878 04173000
         BE    @RF00878                                            0878 04174000
*                   DO;                                            0879 04175000
*                     CALL SAVARSUB;/* CALL SAVE AREA SUBROUTINE     */ 04176000
         BAL   @14,SAVARSUB                                        0880 04177000
*                     CPFAILED='0'B;/* IGNORE POSSIBLE ERROR         */ 04178000
         NI    CPFAILED,B'11111011'                                0881 04179000
*                   END;                                           0882 04180000
*               END;                                               0883 04181000
@RF00878 DS    0H                                                  0884 04182000
*GETPSA:                                                           0884 04183000
*                                                                  0884 04184000
*             /*******************************************************/ 04185000
*             /*                                                     */ 04186000
*             /* OBTAIN STORAGE FOR CCA'S AND PSA                    */ 04187000
*             /*                                                     */ 04188000
*             /*******************************************************/ 04189000
*                                                                  0884 04190000
*             CALL PSACCA;                                         0884 04191000
*                                                                  0884 04192000
@RF00853 DS    0H                                                  0884 04193000
GETPSA   BAL   @14,PSACCA                                          0884 04194000
*             /*******************************************************/ 04195000
*             /*                                                     */ 04196000
*             /* CHECK FOR ANY ERRORS FROM LOWER LEVEL ROUTINE       */ 04197000
*             /*                                                     */ 04198000
*             /*******************************************************/ 04199000
*                                                                  0885 04200000
*             IF ERRORIND^=0 THEN   /* ANY ERRORS?                   */ 04201000
         ICM   @14,15,ERRORIND                                     0885 04202000
         BNZ   @RT00885                                            0885 04203000
*               GOTO PREPEXIT;      /* RETURN TO HIGHER LEVEL        */ 04204000
*             PSACCAOK='1'B;        /* SUCCESSFUL CPU AREAS SETUP  0887 04205000
*                                      FOOTPRT               @ZA05955*/ 04206000
         OI    PSACCAOK,B'00001000'                                0887 04207000
*/******* RMSEXIT ************************************************** */ 04208000
*/* RMSEXIT WILL ALLOCATE BUFFERS TO BE USED FOR MACHINE CHECK LOG-  */ 04209000
*/* OUT BUFFERS. INPUT NEEDED IS CPU ADDRESS, AND FUNCTION CODE.     */ 04210000
*/* POSSIBLE ERROR INDICATORS ARE: CPFAILED                          */ 04211000
*/****************************************************************** */ 04212000
*                                                                  0888 04213000
*             DO;                                                  0888 04214000
*                                                                  0888 04215000
*               /*****************************************************/ 04216000
*               /*                                                   */ 04217000
*               /* SET FUNCTION CODE INTO REGISTER 0 AND CPU ADDRESS */ 04218000
*               /* INTO REGISTER ONE                                 */ 04219000
*               /*                                                   */ 04220000
*               /*****************************************************/ 04221000
*                                                                  0889 04222000
*               RFY                                                0889 04223000
*                (R0,                                              0889 04224000
*                 R1,                                              0889 04225000
*                 R14,                                             0889 04226000
*                 R15) RSTD;        /* RESTRICT REGISTERS FOR      0889 04227000
*                                      INTERFACE                     */ 04228000
*               R1=HEXCPUAD;        /* LOAD CPU ADDRESS              */ 04229000
         SLR   R1,R1                                               0890 04230000
         ICM   R1,3,HEXCPUAD                                       0890 04231000
*               R0=0;               /* FUNCTION CODE TO ALLOCATE   0891 04232000
*                                      BUFFERS                       */ 04233000
         SLR   R0,R0                                               0891 04234000
*               R15=RVTPBUCR;       /* LOAD RMS ROUTINES ADDRESS FROM   04235000
*                                      VECTOR TABLE                  */ 04236000
         L     @06,CVTPTR                                          0892 04237000
         L     @06,RVTPTR(,@06)                                    0892 04238000
         L     R15,RVTPBUCR(,@06)                                  0892 04239000
*               GEN(BALR 14,15);    /* LINK TO ROUTINE               */ 04240000
*                                                                  0893 04241000
         BALR 14,15                                                     04242000
*               /*****************************************************/ 04243000
*               /*                                                   */ 04244000
*               /* CHECK RETURN CODE AND VERIFY SUCESSFUL OPERATION  */ 04245000
*               /* ANY ERROR SET CPFAILED INDICATOR                  */ 04246000
*               /*                                                   */ 04247000
*               /*****************************************************/ 04248000
*                                                                  0894 04249000
*               IF RETCODE^=0 THEN  /* ANY ERROR?                    */ 04250000
         LTR   RETCODE,RETCODE                                     0894 04251000
         BZ    @RF00894                                            0894 04252000
*                 CPFAILED='1'B;    /* SET CPFAILED INDICATOR        */ 04253000
         OI    CPFAILED,B'00000100'                                0895 04254000
*               RFY                                                0896 04255000
*                (R0,                                              0896 04256000
*                 R1,                                              0896 04257000
*                 R14,                                             0896 04258000
*                 R15) UNRSTD;      /* RELEASE REGISTERS             */ 04259000
@RF00894 DS    0H                                                  0897 04260000
*             END;                  /* END OF RMS INTERFACE          */ 04261000
*                                                                  0898 04262000
*             /*******************************************************/ 04263000
*             /*                                                     */ 04264000
*             /* CHECK FOR ANY ERROR FROM RMSEXIT AND RETURN TO NEXT */ 04265000
*             /* LEVEL OF CONTROL IF FOUND                           */ 04266000
*             /*                                                     */ 04267000
*             /*******************************************************/ 04268000
*                                                                  0898 04269000
*             IF ERRORIND^=0 THEN   /* ANY ERROR?                    */ 04270000
         ICM   @14,15,ERRORIND                                     0898 04271000
         BNZ   @RT00898                                            0898 04272000
*               GOTO PREPEXIT;      /* RETURN TO HIGHER LEVEL        */ 04273000
*/****** RTMEXIT *****************************************************/ 04274000
*/* RTMEXIT WILL OBTAIN STORAGE FOR SYSTEM FRR STACKS AND PLACE      */ 04275000
*/* ADDRESS OF STORAGE OBTAINED IN NEW PSA BEING BUILT. A ROUTINE IS */ 04276000
*/* INCLUDED WITH MAINLINE THAT WILL INITIALIZE FRR STACKS. ROUTINE  */ 04277000
*/* IS PROVIDED BY RTM AND IS INCLUDED FROM MACRO LIBRARY            */ 04278000
*/* POSSIBLE ERROR INDICATORS ARE: NOCORE                            */ 04279000
*/********************************************************************/ 04280000
*                                                                  0900 04281000
*             DO;                                                  0900 04282000
*                                                                  0900 04283000
*               /*****************************************************/ 04284000
*               /*                                                   */ 04285000
*               /* SET UP PARAMETERS FOR GETCORE ROUTINE TO OBTAIN   */ 04286000
*               /* STORAGE FOR FRR STACKS. SET NOCHAIN FLAG TO       */ 04287000
*               /* PREVENT FREEING STORAGE ON CLEANUP                */ 04288000
*               /*                                                   */ 04289000
*               /*****************************************************/ 04290000
*                                                                  0901 04291000
*               SUBPOOL=245;        /* SET SUBPOOL NUMBER            */ 04292000
         MVI   SUBPOOL,X'F5'                                       0901 04293000
*               GETLENG=YSTAKLEN;   /* LENGTH OF FRR STACKS          */ 04294000
         MVC   GETLENG(2),@CH02073                                 0902 04295000
*               NOCHAIN='1'B;       /* SET NOCHAIN FLAG              */ 04296000
*                                                                  0903 04297000
         OI    NOCHAIN,B'10000000'                                 0903 04298000
*               /*****************************************************/ 04299000
*               /*                                                   */ 04300000
*               /* CALL GETCORE ROUTINE TO OBTAIN STORAGE            */ 04301000
*               /*                                                   */ 04302000
*               /*****************************************************/ 04303000
*                                                                  0904 04304000
*               CALL GETCORE;       /* GET STORAGE                   */ 04305000
*                                                                  0904 04306000
         BAL   @14,GETCORE                                         0904 04307000
*               /*****************************************************/ 04308000
*               /*                                                   */ 04309000
*               /* VERIFY THAT NO ERROR OCCURED DURING GETMAIN AND   */ 04310000
*               /* UPDATE PSACSTK TO POINT TO STORAGE OBTAINED       */ 04311000
*               /*                                                   */ 04312000
*               /*****************************************************/ 04313000
*                                                                  0905 04314000
*               IF ERRORIND=0 THEN  /* ANY ERRORS?                   */ 04315000
         ICM   @14,15,ERRORIND                                     0905 04316000
         BNZ   @RF00905                                            0905 04317000
*                 DO;                                              0906 04318000
*                                                                  0906 04319000
*/******* NOTE: PSA MUST BE BASED ON PSAPTR AND PSAPTR MUST BE       */ 04320000
*/* POINTING TO NEW PSA BEING INITIALIZED                            */ 04321000
*                                                                  0907 04322000
*                   PSAPTR=CPUPSA;  /* POINT TO NEW PSA              */ 04323000
         L     @14,CPUPSA                                          0907 04324000
         LR    PSAPTR,@14                                          0907 04325000
*                   PSACSTK=COREPTR;/* STORAGE JUST OBTAINED         */ 04326000
         MVC   PSACSTK(4,PSAPTR),COREPTR                           0908 04327000
*                   RFY                                            0909 04328000
*                    (R1) RSTD;     /* RESTRICT REGISTER FOR       0909 04329000
*                                      INTERFACE                     */ 04330000
*                   R1=CPUPSA;      /* POINT TO NEW PSA              */ 04331000
         LR    R1,@14                                              0910 04332000
*                   CALL IEAVTSIN;  /* CALL INITIALIZATION ROUTINE   */ 04333000
         BAL   @14,IEAVTSIN                                        0911 04334000
*                   RFY                                            0912 04335000
*                    (R1) UNRSTD;   /* RELEASE REG 1                 */ 04336000
*                 END;                                             0913 04337000
*             END;                  /* END OF RTMEXIT ROUTINE        */ 04338000
@RF00905 DS    0H                                                  0915 04339000
*             IF ERRORIND^=0 THEN   /* ANY ERRORS ?                  */ 04340000
         ICM   @14,15,ERRORIND                                     0915 04341000
         BNZ   @RT00915                                            0915 04342000
*               GOTO PREPEXIT;      /* RETURN TO HIGHER LEVEL        */ 04343000
*/****** GTFEXIT *****************************************************/ 04344000
*/* GTFEXIT WILL INITIALIZE NECESSARY GTF RELEATED AREAS BY INFORMING*/ 04345000
*/* GTF THAT A CPU IS TO BE BROUGHT ONLINE. NO ERROR INDICATORS WILL */ 04346000
*/* BE SET IN THIS EXIT.                                             */ 04347000
*/********************************************************************/ 04348000
*                                                                  0917 04349000
*             DO;                                                  0917 04350000
*               RFY                                                0918 04351000
*                (R1) RSTD;         /* RESTRICT REGISTER ONE         */ 04352000
*                                                                  0918 04353000
*               /*****************************************************/ 04354000
*               /*                                                   */ 04355000
*               /* LOAD CPU ADDRESS OF CPU TO BE BROUGHT ONLINE      */ 04356000
*               /*                                                   */ 04357000
*               /*****************************************************/ 04358000
*                                                                  0919 04359000
*               R1=HEXCPUAD;        /* LOAD CPU ADDRESS              */ 04360000
*                                                                  0919 04361000
         SLR   R1,R1                                               0919 04362000
         ICM   R1,3,HEXCPUAD                                       0919 04363000
*               /*****************************************************/ 04364000
*               /*                                                   */ 04365000
*               /* LINK TO GTF ROUTINE                               */ 04366000
*               /*                                                   */ 04367000
*               /*****************************************************/ 04368000
*                                                                  0920 04369000
*               GEN(LINK EP=AHLVCON);/* LINK                         */ 04370000
         LINK EP=AHLVCON                                                04371000
*               RFY                                                0921 04372000
*                (R1) UNRSTD;       /* RELEASE REGISTER ONE          */ 04373000
*             END;                  /* *** GTFEXIT                   */ 04374000
*                                                                  0923 04375000
*             /*******************************************************/ 04376000
*             /*                                                     */ 04377000
*             /* SET UP ADDRESSABILITY TO PARAMETERS AND INITIALIZE  */ 04378000
*             /*                                                     */ 04379000
*             /*******************************************************/ 04380000
*                                                                  0923 04381000
*             PARMPTR=ADDR(PARMAREA);/* ADDRESSABILITY FOR WAKE UP 0923 04382000
*                                      PARMS                         */ 04383000
         LA    @14,PARMAREA                                        0923 04384000
         ST    @14,PARMPTR                                         0923 04385000
*             CPUMASK=CPUMSK;       /* PASS CPU MASK                 */ 04386000
         MVC   CPUMASK(2,@14),CPUMSK                               0924 04387000
*             CPUADD=HEXCPUAD;      /* SET UP CPU ADDRESS            */ 04388000
*                                                                  0925 04389000
         MVC   CPUADD(2,@14),HEXCPUAD                              0925 04390000
*             /*******************************************************/ 04391000
*             /*                                                     */ 04392000
*             /* SET UP WORK REG POINTING TO PARAMETER LIST TO STORE */ 04393000
*             /* CONTROL REGISTERS INTO                              */ 04394000
*             /*                                                     */ 04395000
*             /*******************************************************/ 04396000
*                                                                  0926 04397000
*             RFY                                                  0926 04398000
*              (R14) RSTD;          /* RESTRICT REGISTER             */ 04399000
*             R14=ADDR(XREGS);      /* LOAD ADDRESS FOR CONTROL    0927 04400000
*                                      REGISTERS                     */ 04401000
         L     @12,PARMPTR                                         0927 04402000
         LA    R14,XREGS(,@12)                                     0927 04403000
*             GEN(STCTL  0,1,0(14));/* STORE CONTROL REGS 0,1 INTO 0928 04404000
*                                      PARM LIST                     */ 04405000
*                                                                  0928 04406000
         STCTL  0,1,0(14)                                               04407000
*             /*******************************************************/ 04408000
*             /*                                                     */ 04409000
*             /* IF OLD CAT WAS COPIED TO NEW PCCA THEN SET FLAG     */ 04410000
*             /* INFORMING WAKEUP CODE NOT TO ATTEMPT TO FLUSH I/O   */ 04411000
*             /* INTERRUPTS                                          */ 04412000
*             /*                                                     */ 04413000
*             /*******************************************************/ 04414000
*                                                                  0929 04415000
*             IF OLDCAT='1'B THEN   /* OLD CAT EXIST?        @YM03538*/ 04416000
         TM    OLDCAT,B'00000100'                                  0929 04417000
         BNO   @RF00929                                            0929 04418000
*               CATCHK='1'B;        /* SET WAKEUP FLAG       @YM03538*/ 04419000
*                                                                  0930 04420000
         L     @12,PARMPTR                                         0930 04421000
         OI    CATCHK(@12),B'00100000'                             0930 04422000
*             /*******************************************************/ 04423000
*             /*                                                     */ 04424000
*             /* LET IEEVWKUP KNOW WE ARE BACKING OUT FROM AN OFFLINE*/ 04425000
*             /* CASE THAT HAD STOPPED CPU SUCESSFULLY BEFORE A      */ 04426000
*             /* FAILURE.                                    @G557P2L*/ 04427000
*             /*                                                     */ 04428000
*             /*******************************************************/ 04429000
*                                                                  0931 04430000
*             IF KPCHANFL='1'B THEN                                0931 04431000
@RF00929 TM    KPCHANFL,B'01000000'                                0931 04432000
         BNO   @RF00931                                            0931 04433000
*               BACKVOFF='1'B;      /* SET WAKEUP FLAG.      @ZM45610*/ 04434000
*                                                                  0932 04435000
         L     @12,PARMPTR                                         0932 04436000
         OI    BACKVOFF(@12),B'00010000'                           0932 04437000
*             /*******************************************************/ 04438000
*             /*                                                     */ 04439000
*             /* LOAD ADDRESS OF PSA AND CONVERT TO REAL ADDRESS     */ 04440000
*             /*                                                     */ 04441000
*             /*******************************************************/ 04442000
*                                                                  0933 04443000
*             R14=CPUPSA;           /* LOAD VIRTUAL ADDRESS OF PSA   */ 04444000
@RF00931 L     R14,CPUPSA                                          0933 04445000
*             GEN(LRA  14,0(14));   /* CONVERT TO REAL ADDRESS       */ 04446000
         LRA  14,0(14)                                                  04447000
*             PSAADDR=R14;          /* STORE ADDRESS OF PSA FOR    0935 04448000
*                                      PREFIX REG                    */ 04449000
         L     @12,PARMPTR                                         0935 04450000
         ST    R14,PSAADDR(,@12)                                   0935 04451000
*             VIRTADDR=PARMPTR;     /* SAVE VIRTUAL ADDRESS OF THESE    04452000
*                                      PARMS                         */ 04453000
*                                                                  0936 04454000
         ST    @12,VIRTADDR(,@12)                                  0936 04455000
*             /*******************************************************/ 04456000
*             /*                                                     */ 04457000
*             /* USE DISPATCHER LOCK TO DISABLE TO OBTAIN RESTART    */ 04458000
*             /* RESOURCE WORD                                       */ 04459000
*             /*                                                     */ 04460000
*             /*******************************************************/ 04461000
*                                                                  0937 04462000
*RESTLOOP:                                                         0937 04463000
*             GEN                                                  0937 04464000
*(SETLOCK OBTAIN,TYPE=DISP,REGS=USE,MODE=UNCOND,RELATED=(CPU,A));  0937 04465000
*                                                                  0937 04466000
RESTLOOP SETLOCK OBTAIN,TYPE=DISP,REGS=USE,MODE=UNCOND,RELATED=(CPU,A)  04467000
*             /*******************************************************/ 04468000
*             /*                                                     */ 04469000
*             /* SET UP FRR ENVIRONMENT TO PROTECT RESTART RESOURCE. */ 04470000
*             /* FRR ROUTINE WILL SIMPLY ZERO RESTART WORD AND PERK  */ 04471000
*             /* TO ESTAE RTN                                        */ 04472000
*             /*                                                     */ 04473000
*             /*******************************************************/ 04474000
*                                                                  0938 04475000
*             RFY                                                  0938 04476000
*              (R1,                                                0938 04477000
*               R10,                                               0938 04478000
*               R14,                                               0938 04479000
*               R15,                                               0938 04480000
*               RETCODE) RSTD;      /* RESTRECT REGISTERS            */ 04481000
*             R10=ADDR(FRRRTN);     /* LOAD ADDRESS OF FRR ROUTINE   */ 04482000
         LA    R10,FRRRTN                                          0939 04483000
*             GEN REFS(FRRSPARM,FRRSENTR,FRRSFRRA,FRRSCURR,FRRSELEN,    04484000
*                 PSALSFCC)(SETFRR A,FRRAD=(10),WRKREGS=(14,15));  0940 04485000
*                                                                  0940 04486000
         SETFRR A,FRRAD=(10),WRKREGS=(14,15)                            04487000
*             /*******************************************************/ 04488000
*             /*                                                     */ 04489000
*             /* COMPARE AND SWAP TO OBTAIN RESTART RESOURCE SET UP  */ 04490000
*             /* REGS FOR COMPARE AND SWAP. ESTABLISH ADDRESSABILITY */ 04491000
*             /* TO MY OWN PSA TEMPORALLY TO OBTAIN MY LOGICAL CPU   */ 04492000
*             /* ADDRESS FOR INCLUDING IN RESTART RESOURCE WORD      */ 04493000
*             /*                                                     */ 04494000
*             /*******************************************************/ 04495000
*                                                                  0941 04496000
*             PSAPTR=0;             /* ADDRESS MY OWN PSA            */ 04497000
         SLR   PSAPTR,PSAPTR                                       0941 04498000
*             RFY                                                  0942 04499000
*              (LCCA) BASED(PSALCCAV);/* VIRTUAL ADDRESS OF MY OWN 0942 04500000
*                                      LCCA                          */ 04501000
*             R14=0;                /* EXPECTED RESTART VALUE        */ 04502000
         SLR   R14,R14                                             0943 04503000
*             R15='0000E5C1'X+(LCCACPUA*65536);/* LOAD VARY CPU    0944 04504000
*                                      IDENTIFIER                    */ 04505000
         L     @11,PSALCCAV(,PSAPTR)                               0944 04506000
         LH    R15,LCCACPUA(,@11)                                  0944 04507000
         SLA   R15,16                                              0944 04508000
         AL    R15,@CF03729                                        0944 04509000
*             RFY                                                  0945 04510000
*              (LCCA) BASED(LCCAPTR);/* REVERT TO PREVIOUS         0945 04511000
*                                      ADDRESSABILITY                */ 04512000
*             CS(R14,R15,CVTRSTWD); /* ATTEMPT TO OBTAIN RESTART     */ 04513000
         L     @11,CVTPTR                                          0946 04514000
         CS    R14,@15,CVTRSTWD(@11)                               0946 04515000
*             BC(8,PREPCONT);       /* CONTINUE OF SUCCESSFUL        */ 04516000
*                                                                  0947 04517000
         BC    8,PREPCONT                                          0947 04518000
*             /*******************************************************/ 04519000
*             /*                                                     */ 04520000
*             /* IF UNSUCCESSFUL THEN FREE DISPATCHER LOCK FRR & WAIT*/ 04521000
*             /* ONE SECOND THEN TRY AGAIN                           */ 04522000
*             /*                                                     */ 04523000
*             /*******************************************************/ 04524000
*                                                                  0948 04525000
*             GEN(SETFRR  D,WRKREGS=(14,15));/* RELEASE FRR          */ 04526000
         SETFRR  D,WRKREGS=(14,15)                                      04527000
*             GEN(SETLOCK  RELEASE,TYPE=DISP,REGS=USE,RELATED=(CPU,A)); 04528000
*                                                                  0949 04529000
         SETLOCK  RELEASE,TYPE=DISP,REGS=USE,RELATED=(CPU,A)            04530000
*             /*******************************************************/ 04531000
*             /*                                                     */ 04532000
*             /* SET TIMER FOR ONE SECOND WAIT                       */ 04533000
*             /*                                                     */ 04534000
*             /*******************************************************/ 04535000
*                                                                  0950 04536000
*             GEN(STIMER  WAIT,BINTVL=SEC1);/* WAIT ONE SECOND       */ 04537000
         STIMER  WAIT,BINTVL=SEC1                                       04538000
*             RFY                                                  0951 04539000
*              (R1,                                                0951 04540000
*               R10,                                               0951 04541000
*               R14,                                               0951 04542000
*               R15,                                               0951 04543000
*               RETCODE) UNRSTD;    /* RELEASE REGS                  */ 04544000
*             GOTO RESTLOOP;        /* TRY RESTART RESOURCE AGAIN    */ 04545000
         B     RESTLOOP                                            0952 04546000
*PREPCONT:                                                         0953 04547000
*                                                                  0953 04548000
*             /*******************************************************/ 04549000
*             /*                                                     */ 04550000
*             /* RESTART RESOURCE HAS BEEN OBTAINED. CONTINUE        */ 04551000
*             /* PROCESSING SET UP TO REVERSE PREFIX TO ABSL. 0-4K   */ 04552000
*             /* PSA                                                 */ 04553000
*             /*                                                     */ 04554000
*             /*******************************************************/ 04555000
*                                                                  0953 04556000
*             PCCAPTR=PSAPCCAV;     /* ADDRESS OF MY PCCA            */ 04557000
PREPCONT L     @06,PSAPCCAV(,PSAPTR)                               0953 04558000
         ST    @06,PCCAPTR                                         0953 04559000
*             PSAPTR=PCCAPSAV;      /* VIRTUAL ADDRESS OF MY PSA FOR    04560000
*                                      REVERSE PREFIXING             */ 04561000
*                                                                  0954 04562000
         L     PSAPTR,PCCAPSAV(,@06)                               0954 04563000
*             /*******************************************************/ 04564000
*             /*                                                     */ 04565000
*             /* GET REAL ADDRESS OF WAKEUP PARMS AND PLACE IN PSA   */ 04566000
*             /*                                                     */ 04567000
*             /*******************************************************/ 04568000
*                                                                  0955 04569000
*             RFY                                                  0955 04570000
*              (R14) RSTD;          /* RESTRICT REG 14               */ 04571000
*             R14=PARMPTR;          /* WAKEUP PARM POINTER           */ 04572000
         L     R14,PARMPTR                                         0956 04573000
*             GEN(LRA  14,0(14));   /* LOAD REAL ADDRESS OF PARMS    */ 04574000
         LRA  14,0(14)                                                  04575000
*             PSAWKRAP=R14;         /* STORE REAL ADDRESS FOR WAKEUP    04576000
*                                      CODE                          */ 04577000
         ST    R14,PSAWKRAP(,PSAPTR)                               0958 04578000
*             SAVEPSW=FLCRNPSW;     /* SAVE ORIGINAL RESTART PSW     */ 04579000
*                                                                  0959 04580000
         MVC   SAVEPSW(8),FLCRNPSW(PSAPTR)                         0959 04581000
*             /*******************************************************/ 04582000
*             /*                                                     */ 04583000
*             /* SET UP NEW PSW TO POINT TO WAKEUP ROUTINE FIXED IN  */ 04584000
*             /* THIS MODULE                                         */ 04585000
*             /*                                                     */ 04586000
*             /*******************************************************/ 04587000
*                                                                  0960 04588000
*             RNPSW='00080000'X;    /* SET UP FIRST HALF OF NEW PSW  */ 04589000
         MVC   RNPSW(4,PSAPTR),@CB03735                            0960 04590000
*             R14=ADDR(IEEVWKUP);   /* ADDRESS OF WAKEUP ROUTINE     */ 04591000
         L     R14,@CV03520                                        0961 04592000
*             GEN(LRA  R14,0(R14)); /* LOAD REAL ADDRESS OF ROUTINE  */ 04593000
         LRA  R14,0(R14)                                                04594000
*             RNPSWAD=R14;          /* BUILD RESTART PSW             */ 04595000
         ST    R14,RNPSWAD(,PSAPTR)                                0963 04596000
*             RFY                                                  0964 04597000
*              (R14) UNRSTD;        /* RELEASE REG 14                */ 04598000
*PREPEXIT:                                                         0965 04599000
*           END;                    /* END OF PREPARE ROUTINE        */ 04600000
PREPEXIT DS    0H                                                  0966 04601000
*                                                                  0966 04602000
*           /*********************************************************/ 04603000
*           /*                                                       */ 04604000
*           /* CHECK FOR ANY ERRORS DURING PREPARE                   */ 04605000
*           /*                                                       */ 04606000
*           /*********************************************************/ 04607000
*                                                                  0966 04608000
*           IF(ERRORIND)^=0 THEN    /* ERRORS ?                      */ 04609000
         ICM   @06,15,ERRORIND                                     0966 04610000
         BNZ   @RT00966                                            0966 04611000
*             GOTO ONEXIT;          /* EXIT                          */ 04612000
*/******* TRCKRST ****************************************************/ 04613000
*/* TRCKRST ROUTINE WILL ISSUE A SIGP RESTART TO THE SUBJECT CPU TO  */ 04614000
*/* BE BROUGHT ONLINE AND MONITOR IT'S PROGRESS. WHEN CPU IS ONLINE  */ 04615000
*/* RESTART RESOURCE WILL BE FREED AND SUCCESSFUL INDICATORS WILL BE */ 04616000
*/* SET                                                              */ 04617000
*/********************************************************************/ 04618000
*                                                                  0968 04619000
*           DO;                                                    0968 04620000
*                                                                  0968 04621000
*             /*******************************************************/ 04622000
*             /*                                                     */ 04623000
*             /* ISSUE SIGP RESTART TO SUBJECT CPU TO ACTIVATE HIM   */ 04624000
*             /*                                                     */ 04625000
*             /*******************************************************/ 04626000
*                                                                  0969 04627000
*             RFY                                                  0969 04628000
*              (R1,                                                0969 04629000
*               RETCODE) RSTD;                                     0969 04630000
*             R1=PCCAT00P(HEXCPUAD+1);/* GET CPU PCCA ADDRESS FOR  0970 04631000
*                                      SIGP                          */ 04632000
         SLR   @14,@14                                             0970 04633000
         ICM   @14,3,HEXCPUAD                                      0970 04634000
         SLA   @14,2                                               0970 04635000
         L     @06,CVTPTR                                          0970 04636000
         L     @06,CVTPCCAT(,@06)                                  0970 04637000
         L     R1,PCCAT00P(@14,@06)                                0970 04638000
*             GEN(DSGNL  RESTART,CPU=(1));                         0971 04639000
*                                                                  0971 04640000
         DSGNL  RESTART,CPU=(1)                                         04641000
*             /*******************************************************/ 04642000
*             /*                                                     */ 04643000
*             /* CHECK FOR SUCCESSFUL RETURN CODE FROM IPC           */ 04644000
*             /*                                                     */ 04645000
*             /*******************************************************/ 04646000
*                                                                  0972 04647000
*             IF RETCODE^=0 THEN    /* SUCCESSFUL /?                 */ 04648000
         LTR   RETCODE,RETCODE                                     0972 04649000
         BZ    @RF00972                                            0972 04650000
*               DO;                                                0973 04651000
*                 CPUNRESP='1'B;    /* SET ERROR FLAG                */ 04652000
         OI    CPUNRESP,B'00010000'                                0974 04653000
*                 GOTO TRCKCONT;    /* EXIT                          */ 04654000
         B     TRCKCONT                                            0975 04655000
*               END;                                               0976 04656000
*                                                                  0976 04657000
*             /*******************************************************/ 04658000
*             /*                                                     */ 04659000
*             /* RESTART WAS ACCEPTED. ENTER SENSE LOOP TILL RESTART */ 04660000
*             /* HAS COMPLETED                                       */ 04661000
*             /*                                                     */ 04662000
*             /*******************************************************/ 04663000
*                                                                  0977 04664000
*             LOOPCNT=ONEMEG;       /* INIT CNTR FOR RETRIES IF CPU     04665000
*                                      BUSY                  @ZA10795*/ 04666000
@RF00972 MVC   LOOPCNT(4),ONEMEG                                   0977 04667000
*RESTRT:                                                           0978 04668000
*             R1=PCCAT00P(HEXCPUAD+1);/* PCCA OF SUBJECT CPU         */ 04669000
RESTRT   SLR   @14,@14                                             0978 04670000
         ICM   @14,3,HEXCPUAD                                      0978 04671000
         SLA   @14,2                                               0978 04672000
         L     @06,CVTPTR                                          0978 04673000
         L     @06,CVTPCCAT(,@06)                                  0978 04674000
         L     R1,PCCAT00P(@14,@06)                                0978 04675000
*             GEN(DSGNL SENSE,CPU=(1));/* ISSUE SENSE TO CPU         */ 04676000
*                                                                  0979 04677000
         DSGNL SENSE,CPU=(1)                                            04678000
*             /*******************************************************/ 04679000
*             /*                                                     */ 04680000
*             /* CHECK IF CPU IS BUSY DOING RESTART                  */ 04681000
*             /*                                                     */ 04682000
*             /*******************************************************/ 04683000
*                                                                  0980 04684000
*             IF RETCODE=4 THEN     /* BUSY?                         */ 04685000
         CH    RETCODE,@CH00076                                    0980 04686000
         BNE   @RF00980                                            0980 04687000
*               DO;                 /* YES-IEAVEDR RETRIED 1 MEG   0981 04688000
*                                      ALREADY               @ZA10795*/ 04689000
*                 CPUNRESP='1'B;    /* SET UNRESPONSIVE CPU ERR FLAG    04690000
*                                                            @ZA10795*/ 04691000
         OI    CPUNRESP,B'00010000'                                0982 04692000
*                 GOTO TRCKCONT;    /* BRANCH CONTINUE PROCESSING  0983 04693000
*                                                            @ZA10795*/ 04694000
         B     TRCKCONT                                            0983 04695000
*               END;                /* END OF RETURN CODE BUSY     0984 04696000
*                                      PROCESSING            @ZA10795*/ 04697000
*                                                                  0984 04698000
*             /*******************************************************/ 04699000
*             /*                                                     */ 04700000
*             /* CPU HAS STORED STATUS. INTERROGATE                  */ 04701000
*             /*                                                     */ 04702000
*             /*******************************************************/ 04703000
*                                                                  0985 04704000
*             IF RETCODE=8 THEN     /* ERROR??                       */ 04705000
@RF00980 CH    RETCODE,@CH00036                                    0985 04706000
         BNE   @RF00985                                            0985 04707000
*               DO;                                                0986 04708000
*                 RFY                                              0987 04709000
*                  (R0) RSTD;       /* RESTRICT REG                  */ 04710000
*                 TEMPWORK=R0;      /* STORE SENSE INFORMATION FOR 0988 04711000
*                                      CHECK                         */ 04712000
         ST    R0,TEMPWORK                                         0988 04713000
*                 RFY                                              0989 04714000
*                  (R0) UNRSTD;     /* RELEASE REG                   */ 04715000
*                                                                  0989 04716000
*                 /***************************************************/ 04717000
*                 /*                                                 */ 04718000
*                 /* INTERROGATE SENSE INFORMATION TO DETERMINE IF A */ 04719000
*                 /* ERROR HAS OCCURED DURING RESTART. IF A ERROR IS */ 04720000
*                 /* DETECTED THEN SET CPU UNRESPONSIVE FLAG AND EXIT*/ 04721000
*                 /*                                                 */ 04722000
*                 /***************************************************/ 04723000
*                                                                  0990 04724000
*                 IF CKSTOP='1'B|OPINT='1'B|RECCK='1'B|STOP='1'B|NTRDY= 04725000
*                     '1'B THEN     /* ANY ERROR?                    */ 04726000
         TM    CKSTOP,B'01111001'                                  0990 04727000
         BZ    @RF00990                                            0990 04728000
*                   DO;                                            0991 04729000
*                     CPUNRESP='1'B;/* SET UNRESPONSIVE FLAG         */ 04730000
         OI    CPUNRESP,B'00010000'                                0992 04731000
*                     GOTO TRCKCONT;/* RETURN TO NEXT LEVEL          */ 04732000
         B     TRCKCONT                                            0993 04733000
*                   END;                                           0994 04734000
*                                                                  0994 04735000
*                 /***************************************************/ 04736000
*                 /*                                                 */ 04737000
*                 /* RETURN CODE WAS EIGHT, BUT NO ERROR. LOOP WITH  */ 04738000
*                 /* SENSE TILL A ZERO RETURN CODE IS RECEIVED, OR   */ 04739000
*                 /* MACHINE ERROR OCCURES                           */ 04740000
*                 /*                                                 */ 04741000
*                 /***************************************************/ 04742000
*                                                                  0995 04743000
*                 ELSE                                             0995 04744000
*                   DO;             /* YES-CHECK HOW MANY RETRIES  0995 04745000
*                                      ALREADY               @ZA10795*/ 04746000
@RF00990 DS    0H                                                  0996 04747000
*                     IF LOOPCNT=0 THEN/* 1 MEG RETRIES?     @ZA10795*/ 04748000
         ICM   @14,15,LOOPCNT                                      0996 04749000
         BNZ   @RF00996                                            0996 04750000
*                       DO;         /* YES, THAT IS ENOUGH   @ZA10795*/ 04751000
*                         CPUNRESP='1'B;/* SET UNRESPONSIVE CPU ERR     04752000
*                                      FLAG                  @ZA10795*/ 04753000
         OI    CPUNRESP,B'00010000'                                0998 04754000
*                         GOTO TRCKCONT;/* BRACNH CONTINUE PROCESSING   04755000
*                                                            @ZA10795*/ 04756000
         B     TRCKCONT                                            0999 04757000
*                       END;                                       1000 04758000
*                     ELSE          /* NO, RETRY AGAIN       @ZA10795*/ 04759000
*                       DO;                                        1001 04760000
@RF00996 DS    0H                                                  1002 04761000
*                         LOOPCNT=LOOPCNT-1;/* DECR RETRY COUNTER  1002 04762000
*                                                            @ZA10795*/ 04763000
         L     @14,LOOPCNT                                         1002 04764000
         BCTR  @14,0                                               1002 04765000
         ST    @14,LOOPCNT                                         1002 04766000
*                         GOTO RESTRT;/* BRANCH ISSUE SIGP AGAIN   1003 04767000
*                                                            @ZA10795*/ 04768000
         B     RESTRT                                              1003 04769000
*                       END;                                       1004 04770000
*                   END;            /* END OF RETURN CODE BUSY     1005 04771000
*                                      PROCESSING            @ZA10795*/ 04772000
*               END;                                               1006 04773000
*             RFY                                                  1007 04774000
*              (R1,                                                1007 04775000
*               RETCODE) UNRSTD;    /* RELEASE REG ONE               */ 04776000
*                                                                  1007 04777000
@RF00985 DS    0H                                                  1008 04778000
*             /*******************************************************/ 04779000
*             /*                                                     */ 04780000
*             /* ENTER SPIN LOOP TO MONITOR PROGRESS OF SUBJECT CPU  */ 04781000
*             /*                                                     */ 04782000
*             /*******************************************************/ 04783000
*                                                                  1008 04784000
*             DO LOOPCNT=5000 TO 0 BY-1;                           1008 04785000
*                                                                  1008 04786000
         LH    @06,@CH03741                                        1008 04787000
         ST    @06,LOOPCNT                                         1008 04788000
@DL01008 DS    0H                                                  1009 04789000
*               /*****************************************************/ 04790000
*               /*                                                   */ 04791000
*               /* CHECK FOR INPROGRESS FLAG IN WAKEUP PARMS         */ 04792000
*               /*                                                   */ 04793000
*               /*****************************************************/ 04794000
*                                                                  1009 04795000
*               IF INPROC='1'B THEN /* BIT SET YET??                 */ 04796000
         L     @04,PARMPTR                                         1009 04797000
         TM    INPROC(@04),B'10000000'                             1009 04798000
         BO    @RT01009                                            1009 04799000
*                 GOTO CKCOMPLT;    /* GO CHECK FOR COMPLETE         */ 04800000
*             END;                  /* END OF INPROGRESS LOOP        */ 04801000
*                                                                  1011 04802000
         BCTR  @06,0                                               1011 04803000
         ST    @06,LOOPCNT                                         1011 04804000
         LTR   @06,@06                                             1011 04805000
         BNM   @DL01008                                            1011 04806000
*             /*******************************************************/ 04807000
*             /*                                                     */ 04808000
*             /* IF SPIN LOOP COMPLETES THEN CPU DID NOT RESPOND TO  */ 04809000
*             /* RESTART                                             */ 04810000
*             /*                                                     */ 04811000
*             /*******************************************************/ 04812000
*                                                                  1012 04813000
*             CPUNRESP='1'B;        /* SET UNRESPONSIVE FLAG         */ 04814000
         OI    CPUNRESP,B'00010000'                                1012 04815000
*             GOTO TRCKCONT;        /* RETURN TO NEXT LEVEL          */ 04816000
*                                                                  1013 04817000
         B     TRCKCONT                                            1013 04818000
*             /*******************************************************/ 04819000
*             /*                                                     */ 04820000
*             /* SET UP SPIN LOOP WAITING FOR COMPLETE INDICATOR FROM*/ 04821000
*             /* WAKEUP CODE                                         */ 04822000
*             /*                                                     */ 04823000
*             /*******************************************************/ 04824000
*                                                                  1014 04825000
*CKCOMPLT:                                                         1014 04826000
*             DO LOOPCNT=5000 TO 0 BY-1;/* LOOP FOR COMPLETE BIT     */ 04827000
*                                                                  1014 04828000
CKCOMPLT LH    @06,@CH03741                                        1014 04829000
         ST    @06,LOOPCNT                                         1014 04830000
@DL01014 DS    0H                                                  1015 04831000
*               /*****************************************************/ 04832000
*               /*                                                   */ 04833000
*               /* IF COMPLETE BIT HAS BEEN SET THEN CONTINUE        */ 04834000
*               /* PROCESSING                                        */ 04835000
*               /*                                                   */ 04836000
*               /*****************************************************/ 04837000
*                                                                  1015 04838000
*               IF COMPLT='1'B THEN /* COMPLETE BIT SET YET?         */ 04839000
         L     @04,PARMPTR                                         1015 04840000
         TM    COMPLT(@04),B'01000000'                             1015 04841000
         BO    @RT01015                                            1015 04842000
*                 GOTO TRCKCONT;    /* CONTINUE PROCESSING           */ 04843000
*             END;                  /* END OF SPIN LOOP              */ 04844000
*                                                                  1017 04845000
         BCTR  @06,0                                               1017 04846000
         ST    @06,LOOPCNT                                         1017 04847000
         LTR   @06,@06                                             1017 04848000
         BNM   @DL01014                                            1017 04849000
*             /*******************************************************/ 04850000
*             /*                                                     */ 04851000
*             /* IF SPIN LOOP COMPLETES THEN CPU HAS RESPONDED BUT   */ 04852000
*             /* NOT COMPLETED. CHECK TYPE OF ERROR ENCOUNTERED.     */ 04853000
*             /*                                                     */ 04854000
*             /*******************************************************/ 04855000
*                                                                  1018 04856000
*             IF PCCACPUM^='0'B THEN/* MFA ON OFFLINE CPU??          */ 04857000
         L     @06,PCCAPTR                                         1018 04858000
         TM    PCCACPUM(@06),B'10000000'                           1018 04859000
         BZ    @RF01018                                            1018 04860000
*               MCHECK='1'B;        /* SET MACHINE CHECK FLAG        */ 04861000
         OI    MCHECK,B'00000010'                                  1019 04862000
*             ELSE                                                 1020 04863000
*               CPUNRESP='1'B;      /* SET UNRESPONSIVE FLAG         */ 04864000
         B     @RC01018                                            1020 04865000
@RF01018 OI    CPUNRESP,B'00010000'                                1020 04866000
*TRCKCONT:                                                         1021 04867000
*                                                                  1021 04868000
*             /*******************************************************/ 04869000
*             /*                                                     */ 04870000
*             /* CPU HAS RESPONDED TO RESTART AND HAS COMPLETED      */ 04871000
*             /* INITIAL PROCESSING. FREE RESTART RESOURCE AND ENABLE*/ 04872000
*             /*                                                     */ 04873000
*             /*******************************************************/ 04874000
*                                                                  1021 04875000
*             FLCRNPSW=SAVEPSW;     /* REPLACE RESTART PSW IN 0-4K 1021 04876000
*                                      PSA                           */ 04877000
@RC01018 DS    0H                                                  1021 04878000
TRCKCONT MVC   FLCRNPSW(8,PSAPTR),SAVEPSW                          1021 04879000
*             CS(CVTRSTWD,0,CVTRSTWD);/* RELEASE RESTART RESOURCE    */ 04880000
*                                                                  1022 04881000
         L     @12,CVTPTR                                          1022 04882000
         L     @06,CVTRSTWD(,@12)                                  1022 04883000
         SLR   @04,@04                                             1022 04884000
         CS    @06,@04,CVTRSTWD(@12)                               1022 04885000
         BZ    @BC01022                                            1022 04886000
         ST    @06,CVTRSTWD(,@12)                                  1022 04887000
@BC01022 DS    0H                                                  1023 04888000
*             /*******************************************************/ 04889000
*             /*                                                     */ 04890000
*             /* RELEASE FRR RESOURCE AND DISPATCHER LOCK            */ 04891000
*             /*                                                     */ 04892000
*             /*******************************************************/ 04893000
*                                                                  1023 04894000
*             RFY                                                  1023 04895000
*              (R0,                                                1023 04896000
*               R1,                                                1023 04897000
*               R14,                                               1023 04898000
*               R15,                                               1023 04899000
*               RETCODE) RSTD;      /* RESTRICT REGISTERS            */ 04900000
*             GEN(SETFRR  D,WRKREGS=(14,15));/* RELEASE FRR          */ 04901000
         SETFRR  D,WRKREGS=(14,15)                                      04902000
*             GEN                                                  1025 04903000
*(SETLOCK  RELEASE,TYPE=DISP,REGS=USE,RELATED=(IEEVCPU,RESTART));  1025 04904000
         SETLOCK  RELEASE,TYPE=DISP,REGS=USE,RELATED=(IEEVCPU,RESTART)  04905000
*             IF(ERRORIND)^=0 THEN  /* ANY ERRORS?                   */ 04906000
         ICM   @12,15,ERRORIND                                     1026 04907000
         BNZ   @RT01026                                            1026 04908000
*               GOTO TRCKEXIT;      /* EXIT IF ERRORS ARE FOUND      */ 04909000
*                                                                  1027 04910000
*             /*******************************************************/ 04911000
*             /*                                                     */ 04912000
*             /* LINK TO TIMER ROUTINE TO SYNC CLOCKS WITH NEW CPU   */ 04913000
*             /* ASSUME CLOCKS ARE IN ERROR IN CASE LINK FAILS       */ 04914000
*             /*                                                     */ 04915000
*             /*******************************************************/ 04916000
*                                                                  1028 04917000
*             NOCLOCK='1'B;         /* SET ERROR FLAG                */ 04918000
         OI    NOCLOCK,B'10000000'                                 1028 04919000
*             R1=ADDR(PCCAT00P(HEXCPUAD+1));/* POINT TO PCCA ADDRESS */ 04920000
         SLR   @12,@12                                             1029 04921000
         ICM   @12,3,HEXCPUAD                                      1029 04922000
         SLA   @12,2                                               1029 04923000
         L     @06,CVTPTR                                          1029 04924000
         L     R1,CVTPCCAT(,@06)                                   1029 04925000
         LA    R1,PCCAT00P(@12,R1)                                 1029 04926000
*             R0=0;                 /* ZERO REG O FOR INTERFACE      */ 04927000
         SLR   R0,R0                                               1030 04928000
*             GEN(LINK EP=IEAVRSSC);/* SYNCHRONIZE CLOCKS            */ 04929000
*                                                                  1031 04930000
         LINK EP=IEAVRSSC                                               04931000
*             /*******************************************************/ 04932000
*             /*                                                     */ 04933000
*             /* VERIFY THAT CLOCKS HAVE BEEN SYNCHRONIZED PROPERLY  */ 04934000
*             /*                                                     */ 04935000
*             /*******************************************************/ 04936000
*                                                                  1032 04937000
*             IF RETCODE=0 THEN     /* SUCCESSFUL?                   */ 04938000
         SLR   @12,@12                                             1032 04939000
         CR    RETCODE,@12                                         1032 04940000
         BNE   @RF01032                                            1032 04941000
*               DO;                                                1033 04942000
*                 NOCLOCK='0'B;     /* RESET ERROR FLAG              */ 04943000
         NI    NOCLOCK,B'01111111'                                 1034 04944000
*                 CPUONOK='1'B;     /* SET CPU ONLINE OK FLAG        */ 04945000
*                                                                  1035 04946000
         OI    CPUONOK,B'01000000'                                 1035 04947000
*                 /***************************************************/ 04948000
*                 /*                                                 */ 04949000
*                 /* ZERO PSA PTR TO PREVENT CLEANUP FROM FREEING NEW*/ 04950000
*                 /* PSA AREA                                        */ 04951000
*                 /*                                                 */ 04952000
*                 /***************************************************/ 04953000
*                                                                  1036 04954000
*                 CPUPSA=0;         /* ZERO PSA POINTER      @ZA05955*/ 04955000
         ST    @12,CPUPSA                                          1036 04956000
*                 IF KPCHANFL^='1'B THEN                           1037 04957000
         TM    KPCHANFL,B'01000000'                                1037 04958000
         BO    @RF01037                                            1037 04959000
*                   DO;             /* OFFLINE BACKOUT?      @ZM45610*/ 04960000
*                                                                  1038 04961000
*                     /***********************************************/ 04962000
*                     /*                                             */ 04963000
*                     /* CPU IS ONLINE OK. IF CRH IS ACTIVE EXIT TO  */ 04964000
*                     /* IOS TO DEACTIVATE CRH. IF CRH IS NOT ACTIVE */ 04965000
*                     /* THEN ISSUE ASSOCIATE FOR MSS DEVICE.        */ 04966000
*                     /*                                             */ 04967000
*                     /***********************************************/ 04968000
*                                                                  1039 04969000
*                     IF CVTCRCA^=0 THEN/* CRH ACTIVE?       @Y30CQXA*/ 04970000
         L     @06,CVTPTR                                          1039 04971000
         C     @12,CVTCRCA(,@06)                                   1039 04972000
         BE    @RF01039                                            1039 04973000
*                       DO;         /*                       @Y30CQXA*/ 04974000
*                         R15=IOXCRHD;/* DEACTIVATE ADDRESS  @Y30CQXA*/ 04975000
         L     @12,IOCOMPTR(,@06)                                  1041 04976000
         L     @12,IOCXPTR(,@12)                                   1041 04977000
         L     R15,IOXCRHD(,@12)                                   1041 04978000
*                         GEN(BALR R14,R15);/* GO DEACTIVATE @Y30CQXA*/ 04979000
         BALR R14,R15                                                   04980000
*                       END;        /*                       @Y30CQXA*/ 04981000
*                     ELSE          /*                       @Y30LPXA*/ 04982000
*                                                                  1044 04983000
*                       /*********************************************/ 04984000
*                       /*                                           */ 04985000
*                       /* CRH WAS NOT ACTIVE. NOTIFY MSS OF NEW     */ 04986000
*                       /* PROCESSOR OPERATING IN MP MODE THROUGH    */ 04987000
*                       /* ASSOCIATE                                 */ 04988000
*                       /*                                           */ 04989000
*                       /*********************************************/ 04990000
*                                                                  1044 04991000
*                       CALL AINIT; /* GO ISSUE ASSOCIATE    @Y30LPXA*/ 04992000
         B     @RC01039                                            1044 04993000
@RF01039 BAL   @14,AINIT                                           1044 04994000
*                   END;            /* END NOT OFFLINE,CRH BACKOUT 1045 04995000
*                                                            @G557P2L*/ 04996000
*                                                                  1045 04997000
@RC01039 DS    0H                                                  1046 04998000
*                 /***************************************************/ 04999000
*                 /*                                                 */ 05000000
*                 /* CRH HAS BEEN DEACTIVATED IF ACTIVE, AND MSS HAS */ 05001000
*                 /* BEEN ASSOCIATED. RELEASE NEW CPU WHICH HAS BEEN */ 05002000
*                 /* SPINNING DISABLED SINCE SYNCRONIZING CLOCKS     */ 05003000
*                 /*                                                 */ 05004000
*                 /***************************************************/ 05005000
*                                                                  1046 05006000
*                 LCCAPTR=LCCAT00P(HEXCPUAD+1);/* POINT TO NEW LCCA     05007000
*                                                            @Y30CQXA*/ 05008000
@RF01037 SLR   @12,@12                                             1046 05009000
         ICM   @12,3,HEXCPUAD                                      1046 05010000
         SLA   @12,2                                               1046 05011000
         L     @06,CVTPTR                                          1046 05012000
         L     @06,CVTLCCAT(,@06)                                  1046 05013000
         L     @12,LCCAT00P(@12,@06)                               1046 05014000
         ST    @12,LCCAPTR                                         1046 05015000
*                 LCCATIMR='0'B;    /* RESET SPIN BIT        @Y30CQXA*/ 05016000
*                                                                  1047 05017000
         NI    LCCATIMR(@12),B'11101111'                           1047 05018000
*                 /***************************************************/ 05019000
*                 /*                                                 */ 05020000
*                 /* NEW CPU HAS NOW BEEN RELEASED TO THE SYSTEM FOR */ 05021000
*                 /* WORK                                            */ 05022000
*                 /*                                                 */ 05023000
*                 /***************************************************/ 05024000
*                                                                  1048 05025000
*               END;                                               1048 05026000
*             RFY                                                  1049 05027000
*              (R0,                                                1049 05028000
*               R1,                                                1049 05029000
*               R14,                                               1049 05030000
*               R15,                                               1049 05031000
*               RETCODE) UNRSTD;    /* RELEASE REGISTERS             */ 05032000
@RF01032 DS    0H                                                  1050 05033000
*TRCKEXIT:                                                         1050 05034000
*           END;                    /* END OF TRCKRST ROUTINE        */ 05035000
TRCKEXIT DS    0H                                                  1051 05036000
*           IF ERRORIND^=0 THEN     /* ANY ERRORS?                   */ 05037000
         ICM   @12,15,ERRORIND                                     1051 05038000
         BNZ   @RT01051                                            1051 05039000
*             GOTO ONEXIT;                                         1052 05040000
*                                                                  1052 05041000
*           /*********************************************************/ 05042000
*           /*                                                       */ 05043000
*           /* GO BRING ONLINE ANY OFFLINE DEVICES NOW ACCESSABLE. IF*/ 05044000
*           /* BACKING OUT FROM OFFLINE,KEEPCHAN PROCESSING DEVICE   */ 05045000
*           /* PROCESSING IS NOT REQUIRED BECAUSE NONE WERE TAKEN    */ 05046000
*           /* OFFLINE.                                      @G557P2L*/ 05047000
*           /*                                                       */ 05048000
*           /*********************************************************/ 05049000
*                                                                  1053 05050000
*           IF KPCHANFL^='1'B THEN  /* NOT OFFLINE BACKOUT CASE?   1053 05051000
*                                                            @ZM45610*/ 05052000
         TM    KPCHANFL,B'01000000'                                1053 05053000
         BO    @RF01053                                            1053 05054000
*             IF PCCAT00P(HEXCPUAD+1)->/* CPU# FROM VARY CMND      1054 05055000
*                                                            @G47AN2O*/ 05056000
*                 PCCAIO=HASIO      /* THE CPU HAS CHNLS     @G47AN2O*/ 05057000
*               THEN                /*                       @G47AN2O*/ 05058000
         SLR   @12,@12                                             1054 05059000
         ICM   @12,3,HEXCPUAD                                      1054 05060000
         SLA   @12,2                                               1054 05061000
         L     @06,CVTPTR                                          1054 05062000
         L     @06,CVTPCCAT(,@06)                                  1054 05063000
         L     @12,PCCAT00P(@12,@06)                               1054 05064000
         TM    PCCAIO(@12),B'01000000'                             1054 05065000
         BNO   @RF01054                                            1054 05066000
*               CALL DEVCHK;        /* CALL DEVICE CHECK ROUTINE     */ 05067000
         BAL   @14,DEVCHK                                          1055 05068000
*           ONLINMSG='1'B;          /* SET ONLINE FLAG               */ 05069000
@RF01054 DS    0H                                                  1056 05070000
@RF01053 OI    ONLINMSG,B'00100000'                                1056 05071000
*         END;                                                     1057 05072000
*     END;                                                         1058 05073000
@RC00845 DS    0H                                                  1059 05074000
*ONEXIT:                                                           1059 05075000
*                                                                  1059 05076000
*/*  CHECK IF OLD CCA AREAS NEED TO BE RESTORED DUE TO ERROR @ZA05955*/ 05077000
*                                                                  1059 05078000
*   IF(ERRORIND^=0)&(PSACCAOK='1'B) THEN/*                   @ZA05955*/ 05079000
@RC00757 DS    0H                                                  1059 05080000
ONEXIT   ICM   @12,15,ERRORIND                                     1059 05081000
         BZ    @RF01059                                            1059 05082000
         TM    PSACCAOK,B'00001000'                                1059 05083000
         BNO   @RF01059                                            1059 05084000
*     DO;                           /* CPU AREAS OBTAINED, THEN    1060 05085000
*                                      ERROR?                @ZA05955*/ 05086000
*       R10=OLDPCCA;                /* TEMP SAVE OLD PCCA ADDRESS  1061 05087000
*                                                            @ZA05955*/ 05088000
         L     R10,OLDPCCA                                         1061 05089000
*       R11=OLDLCCA;                /* TEMP SAVE OLD LCCA ADDRESS  1062 05090000
*                                                            @ZA05955*/ 05091000
         L     R11,OLDLCCA                                         1062 05092000
*       OLDPCCA=PCCAT00P(HEXCPUAD+1);/* SAVE NEW AREA ADDRS  @ZA05955*/ 05093000
         SLR   @12,@12                                             1063 05094000
         ICM   @12,3,HEXCPUAD                                      1063 05095000
         SLA   @12,2                                               1063 05096000
         L     @06,CVTPTR                                          1063 05097000
         L     @04,CVTPCCAT(,@06)                                  1063 05098000
         L     @15,PCCAT00P(@12,@04)                               1063 05099000
         ST    @15,OLDPCCA                                         1063 05100000
*       OLDLCCA=LCCAT00P(HEXCPUAD+1);/* FOR CLEANUP FREEING. @ZA05955*/ 05101000
         L     @06,CVTLCCAT(,@06)                                  1064 05102000
         L     @15,LCCAT00P(@12,@06)                               1064 05103000
         ST    @15,OLDLCCA                                         1064 05104000
*       PCCAT00P(HEXCPUAD+1)=R10;   /* RESTORE OLD CCA ADDRESSES   1065 05105000
*                                                            @ZA05955*/ 05106000
         ST    R10,PCCAT00P(@12,@04)                               1065 05107000
*       LCCAT00P(HEXCPUAD+1)=R11;   /* FOR FUTHER USING.     @ZA05955*/ 05108000
         ST    R11,LCCAT00P(@12,@06)                               1066 05109000
*     END;                                                         1067 05110000
*   END;                            /* END OF VARY ONLINE ROUTINE    */ 05111000
@EL00003 DS    0H                                                  1068 05112000
@EF00003 DS    0H                                                  1068 05113000
@ER00003 LM    @14,@12,@SA00003                                    1068 05114000
         BR    @14                                                 1068 05115000
*PAGEFIX:                                                          1069 05116000
*   PROC;                                                          1069 05117000
*                                                                  1069 05118000
PAGEFIX  STM   @14,@12,@SA00004                                    1069 05119000
*/****** PAGEFIX *****************************************************/ 05120000
*/* PAGEFIX ROUTINE WILL FIX STORAGE FOR CALLER TO RUN DISABLED      */ 05121000
*/* CALLER WILL SET UP REGS BEFORE CALLING ROUTINE. IF NECESSARY     */ 05122000
*/* CONTROL WILL NOT BE RETURNED TO CALLER UNTIL FUNCTION HAS BEEN   */ 05123000
*/* PERFORMED. POSSIBLE ERROR INDICATORS ARE CPFAILED.               */ 05124000
*/********************************************************************  05125000
*                                                                    */ 05126000
*                                                                  1070 05127000
*   /*****************************************************************/ 05128000
*   /*                                                               */ 05129000
*   /* REGISTERS HAVE BEEN SET UP BY CALLER                          */ 05130000
*   /*                                                               */ 05131000
*   /*****************************************************************/ 05132000
*                                                                  1070 05133000
*   RFY                                                            1070 05134000
*    (R10,                                                         1070 05135000
*     R11,                                                         1070 05136000
*     R12,                                                         1070 05137000
*     RETCODE) RSTD;                /* RESTRICT REGISTERS FOR MACRO  */ 05138000
*   R12=ADDR(PGFXECB);              /* LOAD ADDRESS OF PAGEFIX ECB   */ 05139000
         LA    R12,PGFXECB                                         1071 05140000
*   PGFXECB=0;                      /* ZERO OUT ECB                  */ 05141000
         SLR   @14,@14                                             1072 05142000
         ST    @14,PGFXECB                                         1072 05143000
*   GEN(PGFIX R,A=(10),EA=(11),ECB=(12),LONG=N);/* PAGEFIX           */ 05144000
*                                                                  1073 05145000
         PGFIX R,A=(10),EA=(11),ECB=(12),LONG=N                         05146000
*   /*****************************************************************/ 05147000
*   /*                                                               */ 05148000
*   /* CHECK IF WAIT SHOULD BE ISSUED.. CHECK POST BIT IN ECB        */ 05149000
*   /*                                                               */ 05150000
*   /*****************************************************************/ 05151000
*                                                                  1074 05152000
*   IF POSTED^='1'B THEN            /* ECB POSTED YET?               */ 05153000
         TM    POSTED,B'01000000'                                  1074 05154000
         BO    @RF01074                                            1074 05155000
*     GEN(WAIT  ECB=PGFXECB);       /* WAIT ON ECB                   */ 05156000
*                                                                  1075 05157000
         WAIT  ECB=PGFXECB                                              05158000
*   /*****************************************************************/ 05159000
*   /*                                                               */ 05160000
*   /* AFTER WE COME OUT OF WAIT CHECK POST CODE TO SEE IF FIX WAS   */ 05161000
*   /* SUCCESSFUL                                                    */ 05162000
*   /*                                                               */ 05163000
*   /*****************************************************************/ 05164000
*                                                                  1076 05165000
*   IF PGFXCODE^=0 THEN             /* POST SUCCESSFUL?              */ 05166000
@RF01074 ICM   @14,7,PGFXCODE                                      1076 05167000
         BZ    @RF01076                                            1076 05168000
*     CPFAILED='1'B;                /* SET ERROR FLAG                */ 05169000
         OI    CPFAILED,B'00000100'                                1077 05170000
*   RFY                                                            1078 05171000
*    (R10,                                                         1078 05172000
*     R11,                                                         1078 05173000
*     R12,                                                         1078 05174000
*     RETCODE) UNRSTD;              /* RELEASE REGISTERS FOR USE     */ 05175000
*   END;                            /* ** END OF PGFIX ROUTINE       */ 05176000
@EL00004 DS    0H                                                  1079 05177000
@EF00004 DS    0H                                                  1079 05178000
@ER00004 LM    @14,@12,@SA00004                                    1079 05179000
         BR    @14                                                 1079 05180000
*PATHVAL:                                                          1080 05181000
*   PROC;                           /* PATH VALIDATE ROUTINE         */ 05182000
PATHVAL  STM   @14,@12,@SA00005                                    1080 05183000
*/***** PATHVAL ******************************************************/ 05184000
*/* PATHVAL ROUTINE WILL LINK TO AN IOS MODULE (IECVIOPM) TO VALIDATE*/ 05185000
*/* ALL DEVICE PATHS FROM THE NEW CPU OR CHANNEL. THE UCBCHM FIELD   */ 05186000
*/* IN THE UCB WILL BE UPDATED TO REFELECT ALL OPERATIONAL PATHS AS  */ 05187000
*/* BEING ONLINE.                                                    */ 05188000
*/********************************************************************/ 05189000
*                                                                  1081 05190000
*   /*****************************************************************/ 05191000
*   /*                                                               */ 05192000
*   /* SET UP PARAMETER LIST FOR IECVIOPM THAT IS COMMON FOR THIS    */ 05193000
*   /* ROUTINE.                                                      */ 05194000
*   /*                                                               */ 05195000
*   /*****************************************************************/ 05196000
*                                                                  1081 05197000
*   IF CHNIND='1'B THEN             /* CHANNEL COMMAND?              */ 05198000
         TM    CHNIND,B'10000000'                                  1081 05199000
         BNO   @RF01081                                            1081 05200000
*     PATHFC=2;                     /* SET CHANNEL FUNCTION CODE     */ 05201000
*                                                                  1082 05202000
         MVI   PATHFC,X'02'                                        1082 05203000
*   /*****************************************************************/ 05204000
*   /*                                                               */ 05205000
*   /* WAS NOT CHANNEL COMMAND, MUST THEN BE CPU COMMAND             */ 05206000
*   /*                                                               */ 05207000
*   /*****************************************************************/ 05208000
*                                                                  1083 05209000
*   ELSE                                                           1083 05210000
*     PATHFC=1;                     /* SET CPU FUNCTION CODE         */ 05211000
*                                                                  1083 05212000
         B     @RC01081                                            1083 05213000
@RF01081 MVI   PATHFC,X'01'                                        1083 05214000
*   /*****************************************************************/ 05215000
*   /*                                                               */ 05216000
*   /* SET UP CPU AND CHANNEL BIT MASKS                              */ 05217000
*   /*                                                               */ 05218000
*   /*****************************************************************/ 05219000
*                                                                  1084 05220000
*   PATHCPU=CPUMSK;                 /* CPU BIT MASK                  */ 05221000
@RC01081 MVC   PATHCPU(2),CPUMSK                                   1084 05222000
*   PATHCHN=HEXCHNAD;               /* CHANNEL BIT MASK      @YM08136*/ 05223000
*                                                                  1085 05224000
         MVC   PATHCHN(2),HEXCHNAD                                 1085 05225000
*   /*****************************************************************/ 05226000
*   /*                                                               */ 05227000
*   /* LOAD IECVIOPM AND SAVE ENTRY POINT ADDRESS                    */ 05228000
*   /*                                                               */ 05229000
*   /*****************************************************************/ 05230000
*                                                                  1086 05231000
*   GEN(LOAD  EP=IECVIOPM);         /* LOAD IECVIOPM                 */ 05232000
         LOAD  EP=IECVIOPM                                              05233000
*   PATHADDR=R0;                    /* SAVE ENTRY POINT ADDRESS      */ 05234000
*                                                                  1087 05235000
         ST    R0,PATHADDR                                         1087 05236000
*   /*****************************************************************/ 05237000
*   /*                                                               */ 05238000
*   /* SET UP DO LOOP TO SCAN ALL UCBS IN SYSTEM AND VALIDATE PATHS  */ 05239000
*   /* TO DEVICES FROM NEW SYSTEM ELEMENT.                           */ 05240000
*   /*                                                               */ 05241000
*   /*****************************************************************/ 05242000
*                                                                  1088 05243000
*   DO UCBLKPTR=CVTILK2 BY 2 WHILE(UCBTAB^='FFFF'X);/* SCAN          */ 05244000
*                                                                  1088 05245000
         L     @12,CVTPTR                                          1088 05246000
         L     @12,CVTILK2(,@12)                                   1088 05247000
         ST    @12,UCBLKPTR                                        1088 05248000
         B     @DE01088                                            1088 05249000
@DL01088 DS    0H                                                  1089 05250000
*     /***************************************************************/ 05251000
*     /*                                                             */ 05252000
*     /* CHECK FOR DUMMY ENTRY IN LOOKUP TABLE AND SKIP IF SO        */ 05253000
*     /*                                                             */ 05254000
*     /***************************************************************/ 05255000
*                                                                  1089 05256000
*     IF UCBTAB='0000'X THEN        /* DUMMY ENTRY?                  */ 05257000
         L     @12,UCBLKPTR                                        1089 05258000
         SLR   @06,@06                                             1089 05259000
         ICM   @06,3,UCBTAB(@12)                                   1089 05260000
         LTR   @06,@06                                             1089 05261000
         BZ    @RT01089                                            1089 05262000
*       GOTO PATHSKIP;              /* SKIP PATH VALIDATE            */ 05263000
*     UCBPTR=UCBTAB;                /* PICK UP UCB ADDRESS           */ 05264000
*                                                                  1091 05265000
         ST    @06,UCBPTR                                          1091 05266000
*     /***************************************************************/ 05267000
*     /*                                                             */ 05268000
*     /* CHECK FOR EXPOSURE UCB AND SKIP IF SO                       */ 05269000
*     /*                                                             */ 05270000
*     /***************************************************************/ 05271000
*                                                                  1092 05272000
*     IF UCBMTPXP='1'B&(UCBBASE^=(UCBPTR-512)) THEN/*        @YM06930*/ 05273000
         TM    UCBMTPXP(@06),B'00001000'                           1092 05274000
         BNO   @RF01092                                            1092 05275000
         LR    @12,@06                                             1092 05276000
         SH    @12,@CH01762                                        1092 05277000
         C     @12,UCBBASE(,@06)                                   1092 05278000
         BNE   @RT01092                                            1092 05279000
*       GOTO PATHSKIP;              /* SKIP EXPOSURE UCB     @YM06930*/ 05280000
*                                                                  1093 05281000
*     /***************************************************************/ 05282000
*     /*                                                             */ 05283000
*     /* CHECK FOR COMMUNICATIONS UCB AND SKIP IF I/O IS ACTIVE ON   */ 05284000
*     /* DEVICE.                                             @ZA00078*/ 05285000
*     /*                                                             */ 05286000
*     /***************************************************************/ 05287000
*                                                                  1094 05288000
*     IF UCB3COMM='1'B&UCBACTV='1'B THEN/*                   @ZA00078*/ 05289000
@RF01092 L     @12,UCBPTR                                          1094 05290000
         TM    UCB3COMM(@12),B'01000000'                           1094 05291000
         BNO   @RF01094                                            1094 05292000
         TM    UCBACTV(@12),B'00000010'                            1094 05293000
         BO    @RT01094                                            1094 05294000
*       GOTO PATHSKIP;              /* SKIP ACTIVE COMMUNICATIONS UCB   05295000
*                                                            @ZA00078*/ 05296000
*                                                                  1095 05297000
*     /***************************************************************/ 05298000
*     /*                                                             */ 05299000
*     /* CHECK FOR DEVICE BEING OFFLINE FOR OPERATOR REASON AND SKIP */ 05300000
*     /* IF SO                                               @ZA29619*/ 05301000
*     /*                                                             */ 05302000
*     /***************************************************************/ 05303000
*                                                                  1096 05304000
*     IF UCBVORSN='1'B THEN         /* DEVICE OFFLINE FOR OPERATOR   */ 05305000
@RF01094 L     @12,UCBPTR                                          1096 05306000
         TM    UCBVORSN(@12),B'00000100'                           1096 05307000
         BO    @RT01096                                            1096 05308000
*       GOTO PATHSKIP;              /* REASON SKIP TO NEXT DEVICE  1097 05309000
*                                                            @ZA29619*/ 05310000
*                                                                  1097 05311000
*     /***************************************************************/ 05312000
*     /*                                                             */ 05313000
*     /* SET UP PARAMETER LIST FOR THIS UCB                          */ 05314000
*     /*                                                             */ 05315000
*     /***************************************************************/ 05316000
*                                                                  1098 05317000
*     PATHUCB=UCBTAB;               /* SET UP PARM LIST              */ 05318000
*                                                                  1098 05319000
         L     @12,UCBLKPTR                                        1098 05320000
         SLR   @06,@06                                             1098 05321000
         ICM   @06,3,UCBTAB(@12)                                   1098 05322000
         STCM  @06,7,PATHUCB                                       1098 05323000
*     /***************************************************************/ 05324000
*     /*                                                             */ 05325000
*     /* BALR TO IECVIOPM TO VALIDATE PATHS FROM DEVICE              */ 05326000
*     /*                                                             */ 05327000
*     /***************************************************************/ 05328000
*                                                                  1099 05329000
*     RFY                                                          1099 05330000
*      (R1,                                                        1099 05331000
*       R14,                                                       1099 05332000
*       R15) RSTD;                  /* RESTRICT REGISTERS            */ 05333000
*     R1=ADDR(PATHPARM);            /* POINT TO PARAMETERS           */ 05334000
         LA    R1,PATHPARM                                         1100 05335000
*     R15=PATHADDR;                 /* ADDRESS OF IECVIOPM           */ 05336000
         L     R15,PATHADDR                                        1101 05337000
*     GEN(BALR R14,R15);            /* LINK TO IECVIOPM              */ 05338000
         BALR R14,R15                                                   05339000
*     RFY                                                          1103 05340000
*      (R1,                                                        1103 05341000
*       R14,                                                       1103 05342000
*       R15) UNRSTD;                /* RELEASE REGISTERS             */ 05343000
*PATHSKIP:                                                         1104 05344000
*   END;                            /* END OF DO LOOP                */ 05345000
PATHSKIP LA    @12,2                                               1104 05346000
         AL    @12,UCBLKPTR                                        1104 05347000
         ST    @12,UCBLKPTR                                        1104 05348000
@DE01088 L     @12,UCBLKPTR                                        1104 05349000
         CLC   UCBTAB(2,@12),@CH03658                              1104 05350000
         BNE   @DL01088                                            1104 05351000
*   END;                            /* END OF PATH VALIDATE ROUTINE  */ 05352000
@EL00005 DS    0H                                                  1105 05353000
@EF00005 DS    0H                                                  1105 05354000
@ER00005 LM    @14,@12,@SA00005                                    1105 05355000
         BR    @14                                                 1105 05356000
*DEVCHK:                                                           1106 05357000
*   PROC;                           /* DEVICE CHECK ROUTINE          */ 05358000
DEVCHK   STM   @14,@12,@SA00006                                    1106 05359000
*/****** DEVCHK **************************************************** */ 05360000
*/* DEVCHK ROUTINE WILL SCAN THROUGH ALL DEVICES IN THE SYSTEM AND   */ 05361000
*/* DETERMINE WHICH DEVICES SHOULD BE BROUGHT ONLINE WITH A CHANNEL  */ 05362000
*/* OR CPU THAT IS BEING BROUGHT ONLINE. A RECORDER BLOCK WILL BE    */ 05363000
*/* BUILT FOR EACH DEVICE TO BE BROUGHT ONLINE THEN CONTROL WILL BE  */ 05364000
*/* GIVEN TO UCBMARK TO MARK THE DEVICES ONLINE.                     */ 05365000
*/* POSSIBLE ERROR INDICATORS ARE: DEVNOTON                          */ 05366000
*/****************************************************************** */ 05367000
*                                                                  1107 05368000
*   /*****************************************************************/ 05369000
*   /*                                                               */ 05370000
*   /* CALL PATH VALIDATE ROUTINE TO UPDATE ALL UCB PATHMASKS FOR THE*/ 05371000
*   /* NEW SYSTEM ELEMENT BROUGHT ONLINE.                            */ 05372000
*   /*                                                               */ 05373000
*   /*****************************************************************/ 05374000
*                                                                  1107 05375000
*   CALL PATHVAL;                   /* GO VALIDATE PATHS             */ 05376000
*                                                                  1107 05377000
         BAL   @14,PATHVAL                                         1107 05378000
*   /*****************************************************************/ 05379000
*   /*                                                               */ 05380000
*   /* DETERMINE IF ENQ RESOURCE NEEDS TO BE OBTAINED.               */ 05381000
*   /*                                                               */ 05382000
*   /*****************************************************************/ 05383000
*                                                                  1108 05384000
*   IF UCBENQ^='1'B THEN            /* IF RESOURCE IS NOT OWNED, ENQ */ 05385000
         TM    UCBENQ,B'00000010'                                  1108 05386000
         BO    @RF01108                                            1108 05387000
*     DO;                                                          1109 05388000
*       GEN(ENQ  (UCBENQQ,UCBENQR,S,2,SYSTEM));/* ENQ ON UCB RESOURCE*/ 05389000
         ENQ  (UCBENQQ,UCBENQR,S,2,SYSTEM)                              05390000
*       UCBENQ='1'B;                /* SET FOOTPRINT                 */ 05391000
         OI    UCBENQ,B'00000010'                                  1111 05392000
*     END;                                                         1112 05393000
*                                                                  1112 05394000
*   /*****************************************************************/ 05395000
*   /*                                                               */ 05396000
*   /* SET UP PARMS FOR IEEVDEV THAT ARE COMMON FOR THIS ROUTINE     */ 05397000
*   /*                                                               */ 05398000
*   /*****************************************************************/ 05399000
*                                                                  1113 05400000
*   LINKPTR=ADDR(DEVSUBP);          /* LINKAGE POINTER FOR LINK      */ 05401000
*                                                                  1113 05402000
@RF01108 LA    @12,DEVSUBP                                         1113 05403000
         ST    @12,LINKPTR                                         1113 05404000
*   /*****************************************************************/ 05405000
*   /*                                                               */ 05406000
*   /* LOAD MODULE IEEVDEV AND SAVE ADDRESS FOR LATER BALR LINK      */ 05407000
*   /*                                                               */ 05408000
*   /*****************************************************************/ 05409000
*                                                                  1114 05410000
*   GEN(LOAD  EP=IEEVDEV);          /* LOAD MODULE IEEVDEV           */ 05411000
         LOAD  EP=IEEVDEV                                               05412000
*   RFY                                                            1115 05413000
*    (R0) RSTD;                     /* RESTRICT REG                  */ 05414000
*   DEVADDR=R0;                     /* SAVE IEEVDEV ADDRESS          */ 05415000
         ST    R0,DEVADDR                                          1116 05416000
*   RFY                                                            1117 05417000
*    (R0) UNRSTD;                   /* RELEASE REG                   */ 05418000
*                                                                  1117 05419000
*   /*****************************************************************/ 05420000
*   /*                                                               */ 05421000
*   /* SET UP TO SCAN ALL DEVICES TO DECIDE WHICH ARE TO BE BROUGHT  */ 05422000
*   /* ONLINE                                                        */ 05423000
*   /*                                                               */ 05424000
*   /*****************************************************************/ 05425000
*                                                                  1118 05426000
*   DO UCBLKPTR=CVTILK2 BY 2 WHILE(UCBTAB^='FFFF'X);/* LOOP TO END OF   05427000
*                                      TABLE                         */ 05428000
*                                                                  1118 05429000
         L     @12,CVTPTR                                          1118 05430000
         L     @12,CVTILK2(,@12)                                   1118 05431000
         ST    @12,UCBLKPTR                                        1118 05432000
         B     @DE01118                                            1118 05433000
@DL01118 DS    0H                                                  1119 05434000
*     /***************************************************************/ 05435000
*     /*                                                             */ 05436000
*     /* CHECK FOR DUMMY ENTRY IN LOOKUP TABLE AND SKIP TO NEXT IF   */ 05437000
*     /* FOUND                                                       */ 05438000
*     /*                                                             */ 05439000
*     /***************************************************************/ 05440000
*                                                                  1119 05441000
*     IF UCBTAB='0000'X THEN        /* DUMMY ENTRY?                  */ 05442000
         L     @12,UCBLKPTR                                        1119 05443000
         SLR   @06,@06                                             1119 05444000
         ICM   @06,3,UCBTAB(@12)                                   1119 05445000
         LTR   @06,@06                                             1119 05446000
         BZ    @RT01119                                            1119 05447000
*       GOTO DEVLOOP;               /* STEP TO NEXT                  */ 05448000
*                                                                  1120 05449000
*     /***************************************************************/ 05450000
*     /*                                                             */ 05451000
*     /* SET UP ADDRESSABILITY TO THIS UCB                           */ 05452000
*     /*                                                             */ 05453000
*     /***************************************************************/ 05454000
*                                                                  1121 05455000
*     UCBPTR=UCBTAB;                /* SET UP UCB POINTER            */ 05456000
*                                                                  1121 05457000
         ST    @06,UCBPTR                                          1121 05458000
*     /***************************************************************/ 05459000
*     /*                                                             */ 05460000
*     /* DETERMINE IF UCB SHOULD BE BROUGHT ONLINE. SKIP ANY THAT    */ 05461000
*     /* WILL NOT BE AFFECTED. DEVICES TO SKIP ARE ANY THAT ARE      */ 05462000
*     /* ALREADY ONLINE, OFFLINE FOR OPERATOR REASONS, AND MULTIPLE  */ 05463000
*     /* EXPOSURE DEVICES SUB UCB'S                                  */ 05464000
*     /*                                                             */ 05465000
*     /***************************************************************/ 05466000
*                                                                  1122 05467000
*     IF(UCBMTPXP='1'B&UCBBASE^=(UCBPTR-512))|UCBONLI='1'B/* ONLINE? */ 05468000
*       THEN                        /*                       @ZA00856*/ 05469000
         TM    UCBMTPXP(@06),B'00001000'                           1122 05470000
         BNO   @GL00030                                            1122 05471000
         LR    @12,@06                                             1122 05472000
         SH    @12,@CH01762                                        1122 05473000
         C     @12,UCBBASE(,@06)                                   1122 05474000
         BNE   @RT01122                                            1122 05475000
@GL00030 L     @12,UCBPTR                                          1122 05476000
         TM    UCBONLI(@12),B'10000000'                            1122 05477000
         BO    @RT01122                                            1122 05478000
*       GOTO DEVLOOP;               /* SKIP TO NEXT DEVICE           */ 05479000
*     IF UCBVORSN='1'B THEN         /* OFFLINE FOR OPERATOR  @ZA29619*/ 05480000
         TM    UCBVORSN(@12),B'00000100'                           1124 05481000
         BO    @RT01124                                            1124 05482000
*       GOTO DEVLOOP;               /* REASON - SKIP DEVICE  @ZA29619*/ 05483000
*                                                                  1125 05484000
*     /***************************************************************/ 05485000
*     /*                                                             */ 05486000
*     /* SET UP REMAINING PARAMETERS TO LINK TO IEEVDEV TO CHECK PATH*/ 05487000
*     /* STATUS FOR DEVICE CHECK FOR COMMUNICATIONS UCB AND SKIP IF  */ 05488000
*     /* I/O IS ACTIVE ON DEVICE.                            @ZA00078*/ 05489000
*     /*                                                             */ 05490000
*     /***************************************************************/ 05491000
*                                                                  1126 05492000
*     IF UCB3COMM='1'B&UCBACTV='1'B THEN/*                   @ZA00078*/ 05493000
         TM    UCB3COMM(@12),B'01000000'                           1126 05494000
         BNO   @RF01126                                            1126 05495000
         TM    UCBACTV(@12),B'00000010'                            1126 05496000
         BO    @RT01126                                            1126 05497000
*       GOTO DEVLOOP;               /* SKIP ACTIVE COMMUNICATIONS UCB   05498000
*                                                            @ZA00078*/ 05499000
*/*  THE ONLINE/OFFLINE STATUS OF THE MSC MUST NOT CHANGE. @G24LP2L  */ 05500000
*                                                                  1128 05501000
*     IF UCBTBYT4='42'X THEN                                       1128 05502000
@RF01126 L     @12,UCBPTR                                          1128 05503000
         CLI   UCBTBYT4(@12),X'42'                                 1128 05504000
         BE    @RT01128                                            1128 05505000
*       GOTO DEVLOOP;               /* THE MSC STATUS CANNOT CHANGE     05506000
*                                      TO ONLINE.            @G24LP2L*/ 05507000
*     DEVSUBUB=UCBPTR;              /* ADDRESS OF UCB COMMON SEGEMENT*/ 05508000
         ST    @12,DEVSUBUB                                        1130 05509000
*     DEVSUBGO='1'B;                /* FOOTPRINT                     */ 05510000
         OI    DEVSUBGO,B'00010000'                                1131 05511000
*     RFY                                                          1132 05512000
*      (R1,                                                        1132 05513000
*       R14,                                                       1132 05514000
*       R15) RSTD;                  /* RESTRICT REGISTERS            */ 05515000
*     R1=ADDR(LINKPTR);             /* PARAMETER LIST TO BE PASSED   */ 05516000
         LA    R1,LINKPTR                                          1133 05517000
*     DEVSUBCP=HEXCPU1;             /* UPDATE THE PARM LIST  @ZA27917*/ 05518000
         MVC   DEVSUBCP(1),HEXCPU1                                 1134 05519000
*     DEVSUBCH=HEXCHN1;             /* WITH CPU & CHAN ID    @ZA27917*/ 05520000
*                                                                  1135 05521000
         MVC   DEVSUBCH(1),HEXCHN1                                 1135 05522000
*     /***************************************************************/ 05523000
*     /*                                                             */ 05524000
*     /* DETERMINE THE TYPE OF COMMAND AND SET IEEVDEV FUNCTION CODE */ 05525000
*     /* ACCORDING. BALR TO IEEVDEV TO TEST THE STATUS OF THE        */ 05526000
*     /* SPECIFIED DEVICE ASSOCIATED WITH THE CHANNEL OR CPU         */ 05527000
*     /* SPECIFIED                                           @ZA27917*/ 05528000
*     /*                                                             */ 05529000
*     /***************************************************************/ 05530000
*                                                                  1136 05531000
*     IF CHNIND='1'B THEN           /* CHANNEL COMMAND?      @ZA27917*/ 05532000
         TM    CHNIND,B'10000000'                                  1136 05533000
         BNO   @RF01136                                            1136 05534000
*       DEVSUBFC=4;                 /* SET FUNC CODE 4       @ZA27917*/ 05535000
         MVI   DEVSUBFC,X'04'                                      1137 05536000
*     ELSE                          /* NO - MUST BE CPU CMD  @ZA27917*/ 05537000
*       DEVSUBFC=3;                 /* SET FUNC CODE 3       @ZA27917*/ 05538000
         B     @RC01136                                            1138 05539000
@RF01136 MVI   DEVSUBFC,X'03'                                      1138 05540000
*     R15=DEVADDR;                  /* ADDR OF IEEVDEV       @ZA27917*/ 05541000
@RC01136 L     R15,DEVADDR                                         1139 05542000
*     GEN(BALR R14,R15);            /* LINK TO IEEVDEV       @ZA27917*/ 05543000
         BALR R14,R15                                                   05544000
*     RFY                                                          1141 05545000
*      (RETCODE) RSTD;              /* RESTRIC RETURN REG    @ZA27917*/ 05546000
*     IF RETCODE=4 THEN             /* PATH NOT AVAILABLE    @ZA27917*/ 05547000
         CH    RETCODE,@CH00076                                    1142 05548000
         BE    @RT01142                                            1142 05549000
*       GOTO DEVLOOP;               /* SKIP TO NEXT DEVICE   @ZA27917*/ 05550000
*     DEVSUBFC=0;                   /* FUNCTION CODE 0       @ZA27917*/ 05551000
         MVI   DEVSUBFC,X'00'                                      1144 05552000
*     R1=ADDR(LINKPTR);             /* PARM LIST TO BE PASSED      1145 05553000
*                                                            @ZA27917*/ 05554000
         LA    R1,LINKPTR                                          1145 05555000
*     GEN(BALR R14,R15);            /* LINK TO IEEVDEV       @ZA27917*/ 05556000
         BALR R14,R15                                                   05557000
*     RFY                                                          1147 05558000
*      (R1,                                                        1147 05559000
*       R14,                                                       1147 05560000
*       R15) UNRSTD;                /* RELEASE REGS          @ZA27917*/ 05561000
*     DEVSUBGO='0'B;                /* RESET FOOTPRINT               */ 05562000
*                                                                  1148 05563000
         NI    DEVSUBGO,B'11101111'                                1148 05564000
*     /***************************************************************/ 05565000
*     /*                                                             */ 05566000
*     /* CHECK RETURN CODE TO DETERMINE IF DEVICE CAN BE BROUGHT     */ 05567000
*     /* ONLINE                                                      */ 05568000
*     /*                                                             */ 05569000
*     /***************************************************************/ 05570000
*                                                                  1149 05571000
*     IF RETCODE=0 THEN             /* ZERO RETURN CODE ?            */ 05572000
         LTR   RETCODE,RETCODE                                     1149 05573000
         BNZ   @RF01149                                            1149 05574000
*       DO;                                                        1150 05575000
*                                                                  1150 05576000
*         /***********************************************************/ 05577000
*         /*                                                         */ 05578000
*         /* RETURN CODE WAS ZERO DEVICE CAN BE BROUGHT ONLINE SET UP*/ 05579000
*         /* TO BUILD A RECORDER BLOCK                               */ 05580000
*         /*                                                         */ 05581000
*         /***********************************************************/ 05582000
*                                                                  1151 05583000
*         DEVON='1'B;               /* DEVICE ON ENTRY               */ 05584000
         OI    DEVON,B'00100000'                                   1151 05585000
*         CALL UCBRCRDR;            /* BUILD RECORDER BLOCK          */ 05586000
*                                                                  1152 05587000
         BAL   @14,UCBRCRDR                                        1152 05588000
*         /***********************************************************/ 05589000
*         /*                                                         */ 05590000
*         /* CHECK FOR ERROR FROM BUILDING RECORDER BLOCK            */ 05591000
*         /*                                                         */ 05592000
*         /***********************************************************/ 05593000
*                                                                  1153 05594000
*         IF NOCORE='1'B THEN       /* NOCORE ERROR ?                */ 05595000
         TM    NOCORE,B'00000001'                                  1153 05596000
         BNO   @RF01153                                            1153 05597000
*           DO;                                                    1154 05598000
*             NOCORE='0'B;          /* RESET ERROR INDICATOR         */ 05599000
         NI    NOCORE,B'11111110'                                  1155 05600000
*             DEVNOTON='1'B;        /* SET DEVICE NOT ALL ON       1156 05601000
*                                      INDICATOR                     */ 05602000
         OI    DEVNOTON,B'01000000'                                1156 05603000
*           END;                                                   1157 05604000
*       END;                                                       1158 05605000
*                                                                  1158 05606000
*     /***************************************************************/ 05607000
*     /*                                                             */ 05608000
*     /* RETURN CODE WAS NOT ZERO. IF RETURN CODE IS OTHER THAN FOUR */ 05609000
*     /* THEN SET NOT ALL DEVICES BROUGHT ONLINE ERROR FLAG          */ 05610000
*     /*                                                             */ 05611000
*     /***************************************************************/ 05612000
*                                                                  1159 05613000
*     ELSE                                                         1159 05614000
*                                                                  1159 05615000
*       /*************************************************************/ 05616000
*       /*                                                           */ 05617000
*       /* CHECK FOR ANY ERROR RETURN CODE FROM IEEVDEV. RETURN CODE */ 05618000
*       /* FOUR INDICATES NO AVAILABLE PATHS, RETURN CODE SIXTEEN    */ 05619000
*       /* INDICATES DEVICE IN USE BY SYSTEM FUNCTION. ANY THING ELSE*/ 05620000
*       /* IS INVALID                                                */ 05621000
*       /*                                                           */ 05622000
*       /*************************************************************/ 05623000
*                                                                  1159 05624000
*       IF RETCODE^=4&RETCODE^=16 THEN/* INVALID RETURN CODE?        */ 05625000
         B     @RC01149                                            1159 05626000
@RF01149 CH    RETCODE,@CH00076                                    1159 05627000
         BE    @RF01159                                            1159 05628000
         CH    RETCODE,@CH00055                                    1159 05629000
         BE    @RF01159                                            1159 05630000
*         DEVNOTON='1'B;            /* SET ERROR FLAG                */ 05631000
         OI    DEVNOTON,B'01000000'                                1160 05632000
*     RFY                                                          1161 05633000
*      (RETCODE) UNRSTD;            /* RELEASE REGISTER 15 FOR USE   */ 05634000
@RF01159 DS    0H                                                  1161 05635000
@RC01149 DS    0H                                                  1162 05636000
*DEVLOOP:                                                          1162 05637000
*   END;                            /* END OF DOLOOP                 */ 05638000
*                                                                  1162 05639000
DEVLOOP  LA    @12,2                                               1162 05640000
         AL    @12,UCBLKPTR                                        1162 05641000
         ST    @12,UCBLKPTR                                        1162 05642000
@DE01118 L     @12,UCBLKPTR                                        1162 05643000
         CLC   UCBTAB(2,@12),@CH03658                              1162 05644000
         BNE   @DL01118                                            1162 05645000
*   /*****************************************************************/ 05646000
*   /*                                                               */ 05647000
*   /* ISSUE IOS CHANNEL RESTART TO INFORM IOS OF NEW CHANNELS       */ 05648000
*   /*                                                               */ 05649000
*   /*****************************************************************/ 05650000
*                                                                  1163 05651000
*   RFY                                                            1163 05652000
*    (R1,                                                          1163 05653000
*     R12,                                                         1163 05654000
*     R14,                                                         1163 05655000
*     R15) RSTD;                                                   1163 05656000
*   R12=HEXCPUAD;                   /* CPU TO RESTART CHANNELS FOR 1164 05657000
*                                                            @YM03483*/ 05658000
         SLR   R12,R12                                             1164 05659000
         ICM   R12,3,HEXCPUAD                                      1164 05660000
*   GEN REFS(CVTIXAVL,IOCOM,IOCOMEX,IOCCTBL,IOX,IOXCHMSK,IRTENTRY, 1165 05661000
*       IRTCHMSK,LCCAIRT)(IOSGEN  RESTART,REG=(R1,R12,R14,R15),VAR=ALL) 05662000
*       ;                                                          1165 05663000
         IOSGEN  RESTART,REG=(R1,R12,R14,R15),VAR=ALL                   05664000
*   RFY                                                            1166 05665000
*    (R1,                                                          1166 05666000
*     R12,                                                         1166 05667000
*     R14,                                                         1166 05668000
*     R15) UNRSTD;                  /* RELEASE REGISTERS             */ 05669000
*                                                                  1166 05670000
*   /*****************************************************************/ 05671000
*   /*                                                               */ 05672000
*   /* ALL RECORDER BLOCKS HAVE BEEN BUILT GO TO UCB MARK ROUTINE    */ 05673000
*   /*                                                               */ 05674000
*   /*****************************************************************/ 05675000
*                                                                  1167 05676000
*   CALL UCBMARK;                   /* GO MARK UCB'S                 */ 05677000
         BAL   @14,UCBMARK                                         1167 05678000
*   GEN(DEQ  (UCBENQQ,UCBENQR,2,SYSTEM));/* RELEASE UCB RESOURCE     */ 05679000
         DEQ  (UCBENQQ,UCBENQR,2,SYSTEM)                                05680000
*   UCBENQ='0'B;                    /* RESET FOOTPRINT               */ 05681000
         NI    UCBENQ,B'11111101'                                  1169 05682000
*   END;                            /* END OF DEVCHK                 */ 05683000
@EL00006 DS    0H                                                  1170 05684000
@EF00006 DS    0H                                                  1170 05685000
@ER00006 LM    @14,@12,@SA00006                                    1170 05686000
         BR    @14                                                 1170 05687000
*UCBMARK:                                                          1171 05688000
*   PROC OPTIONS(SAVE,SAVEAREA);                                   1171 05689000
*                                                                  1171 05690000
UCBMARK  STM   @14,@12,12(@13)                                     1171 05691000
         ST    @13,@SA00007+4                                      1171 05692000
         LA    @14,@SA00007                                        1171 05693000
         ST    @14,8(,@13)                                         1171 05694000
         LR    @13,@14                                             1171 05695000
*/***** UCBMARK ***************************************************  */ 05696000
*/* UCBMARK WILL STEP THROUGH  THE RECORDER BLOCK ENTRIES AND MARK   */ 05697000
*/* THE UCB REPRESENTED BY THAT BLOCK EITHER ONLINE, OFFLINE,OR      */ 05698000
*/* SET THE HIERARCHY REASON INDICATOR AS REQUIRED. IF A UCB IS TO   */ 05699000
*/* BE TAKEN OFFLINE THEN NORMAL UNLOAD PROCESSING WILL BE PER-      */ 05700000
*/* FORMED                                                           */ 05701000
*/*****************************************************************  */ 05702000
*                                                                  1172 05703000
*   RCRDRPTR=ENTRYPTR;              /* ADDRESSABILITY TO FIRST     1172 05704000
*                                      RECORDER BLOCK                */ 05705000
*                                                                  1172 05706000
         L     RCRDRPTR,ENTRYPTR                                   1172 05707000
*   /*****************************************************************/ 05708000
*   /*                                                               */ 05709000
*   /* SET UP DOLOOP TO SCAN THROUGH ALL RECORDER BLOCKS AND MARK    */ 05710000
*   /* UCB'S                                                         */ 05711000
*   /*                                                               */ 05712000
*   /*****************************************************************/ 05713000
*                                                                  1173 05714000
*   DO WHILE(RCRDRPTR^=0);          /* SCAN ALL RECORDER BLOCKS      */ 05715000
*                                                                  1173 05716000
         B     @DE01173                                            1173 05717000
@DL01173 DS    0H                                                  1174 05718000
*     /***************************************************************/ 05719000
*     /*                                                             */ 05720000
*     /* SET FLAG IN RECORDER BLOCK INDICATING THAT THIS ENTRY HAS   */ 05721000
*     /* BEEN PROCESSED AND SET UP ADDRESSABILITY TO UCB             */ 05722000
*     /*                                                             */ 05723000
*     /***************************************************************/ 05724000
*                                                                  1174 05725000
*     UCBPTR=UCBADDR;               /* ADDRESSABILITY TO UCB       1174 05726000
*                                      REPRESENTED                   */ 05727000
*                                                                  1174 05728000
         SLR   @12,@12                                             1174 05729000
         ICM   @12,7,UCBADDR(RCRDRPTR)                             1174 05730000
         ST    @12,UCBPTR                                          1174 05731000
*     /***************************************************************/ 05732000
*     /*                                                             */ 05733000
*     /* DETERMINE IF THIS IS A REQUEST TO MARK DEVICE ONLINE        */ 05734000
*     /*                                                             */ 05735000
*     /***************************************************************/ 05736000
*                                                                  1175 05737000
*     IF MKDEVON='1'B THEN          /* ONLINE REQUEST?               */ 05738000
         TM    MKDEVON(RCRDRPTR),B'00100000'                       1175 05739000
         BNO   @RF01175                                            1175 05740000
*       DO;                                                        1176 05741000
*         ALTERUCB='1'B;            /* THIS ENTRY PROCESSED          */ 05742000
         OI    ALTERUCB(RCRDRPTR),B'00001000'                      1177 05743000
*         UCBALTER='1'B;            /* A UCB HAS BEEN ALTERED        */ 05744000
         OI    UCBALTER,B'10000000'                                1178 05745000
*         UCBVHRSN='0'B;            /* RESET HIER REASON INDICATOR   */ 05746000
         NI    UCBVHRSN(@12),B'11111101'                           1179 05747000
*         UCBONLI='1'B;             /* MARK DEVICE ONLINE            */ 05748000
         OI    UCBONLI(@12),B'10000000'                            1180 05749000
*       END;                                                       1181 05750000
*                                                                  1181 05751000
*     /***************************************************************/ 05752000
*     /*                                                             */ 05753000
*     /* WAS NOT ONLINE REQUEST.. DETERMINE IF DEVICE IS TO BE MARKED*/ 05754000
*     /* OFFLINE OR SET HIERARCHY REASON INDICATOR                   */ 05755000
*     /*                                                             */ 05756000
*     /***************************************************************/ 05757000
*                                                                  1182 05758000
*     ELSE                                                         1182 05759000
*                                                                  1182 05760000
*       /*************************************************************/ 05761000
*       /*                                                           */ 05762000
*       /* WAS THIS A OFFLINE REQUEST ?                              */ 05763000
*       /*                                                           */ 05764000
*       /*************************************************************/ 05765000
*                                                                  1182 05766000
*       IF MKDEVOFF='1'B|HIERONLY='1'B THEN/* OFFLINE REQUEST        */ 05767000
         B     @RC01175                                            1182 05768000
@RF01175 TM    MKDEVOFF(RCRDRPTR),B'10010000'                      1182 05769000
         BZ    @RF01182                                            1182 05770000
*         DO;                                                      1183 05771000
*           UCBALTER='1'B;          /* A UCB HAS BEEN ALTERED        */ 05772000
         OI    UCBALTER,B'10000000'                                1184 05773000
*           ALTERUCB='1'B;          /* THIS ENTRY HAS BEEN PROCESSED */ 05774000
         OI    ALTERUCB(RCRDRPTR),B'00001000'                      1185 05775000
*           UCBVHRSN='1'B;          /* SET HIER REASON FLAG IN UCB   */ 05776000
         L     @12,UCBPTR                                          1186 05777000
         OI    UCBVHRSN(@12),B'00000010'                           1186 05778000
*           UCBONLI='0'B;           /* MARK DEVICE OFFLINE           */ 05779000
*                                                                  1187 05780000
         NI    UCBONLI(@12),B'01111111'                            1187 05781000
*           /*********************************************************/ 05782000
*           /*                                                       */ 05783000
*           /* DEVICE IS MARKED OFFLINE DETERMINE IF DEVICE SHOULD BE*/ 05784000
*           /* UNLOADED (TAPE OR DISK )                              */ 05785000
*           /*                                                       */ 05786000
*           /*********************************************************/ 05787000
*                                                                  1188 05788000
*           IF(UCB3TAPE='1'B|UCB3DACC='1'B)&HIERONLY^='1'B THEN    1188 05789000
*                                                                  1188 05790000
         TM    UCB3TAPE(@12),B'10100000'                           1188 05791000
         BZ    @RF01188                                            1188 05792000
         TM    HIERONLY(RCRDRPTR),B'10000000'                      1188 05793000
         BO    @RF01188                                            1188 05794000
*             /*******************************************************/ 05795000
*             /*                                                     */ 05796000
*             /* DEVICE IS TAPE OR DISK AND THIS WAS NOT A HIERARCHY */ 05797000
*             /* ONLY REQUEST SO PERFORM OFFLINE PROCESSING          */ 05798000
*             /*                                                     */ 05799000
*             /*******************************************************/ 05800000
*                                                                  1189 05801000
*             DO;                                                  1189 05802000
*               RFY                                                1190 05803000
*                (R1) RSTD;         /* RESTRICT REG ONE              */ 05804000
*               VMVREQBP=ADDR(VMVPARMS);/* SET UP PARM POINTER       */ 05805000
         LA    @12,VMVPARMS                                        1191 05806000
         ST    @12,VMVREQBP                                        1191 05807000
*               VMVUNLOD='1'B;      /* SET UNLOAD INDICATOR          */ 05808000
*               VMVUCB='1'B;        /* SET UCB INDICATOR             */ 05809000
         OI    VMVUNLOD(@12),B'11000000'                           1193 05810000
*               VMVUCBP=UCBADDR;    /* POINT TO UCB COMMON SEGEMENT  */ 05811000
         MVC   VMVUCBP(3,@12),UCBADDR(RCRDRPTR)                    1194 05812000
*               DO;                 /* LINK EP('IEFAB49C')         1195 05813000
*                                      PARAM(VMVREQBP,0,0)           */ 05814000
*                 I00601='00'X;     /* EP/DE FLAG                    */ 05815000
         MVI   I00601,X'00'                                        1196 05816000
*                 I00602=ADDR('IEFAB49C');/* ADDR OF EP/DE           */ 05817000
         LA    @12,@CC03768                                        1197 05818000
         STCM  @12,7,I00602                                        1197 05819000
*                 I00604=0;         /* DCB PTR                       */ 05820000
         SLR   @12,@12                                             1198 05821000
         STCM  @12,7,I00604                                        1198 05822000
*                 I00603='00'X;     /* ERRET FLAG                    */ 05823000
         MVI   I00603,X'00'                                        1199 05824000
*                 IOPTLIST(1)=ADDR(VMVREQBP);/* ADDR OF PROB PROG  1200 05825000
*                                      PARM                          */ 05826000
         LA    @12,VMVREQBP                                        1200 05827000
         ST    @12,IOPTLIST                                        1200 05828000
*                 IOPTLIST(2)=ADDR(0);/* ADDR OF PROB PROG PARM      */ 05829000
         LA    @12,@CF00275                                        1201 05830000
         ST    @12,IOPTLIST+4                                      1201 05831000
*                 IOPTLIST(3)=ADDR(0);/* ADDR OF PROB PROG PARM      */ 05832000
         ST    @12,IOPTLIST+8                                      1202 05833000
*                 IOPTLIST(3)=IOPTLIST(3)|'80000000'X;/* SET VL BIT  */ 05834000
         O     @12,@CF03772                                        1203 05835000
         ST    @12,IOPTLIST+8                                      1203 05836000
*                 RESPECIFY                                        1204 05837000
*                  (GPR01P) RESTRICTED;                            1204 05838000
*                 GPR01P=ADDR(IOPTLIST);/* ADDR OF OPTLIST           */ 05839000
         LA    GPR01P,IOPTLIST                                     1205 05840000
*                 RESPECIFY                                        1206 05841000
*                  (GPR15P) RESTRICTED;                            1206 05842000
*                 GPR15P=ADDR(I006);/* ADDR OF LINK LIST             */ 05843000
         LA    GPR15P,I006                                         1207 05844000
*                 SVC(6);           /* ISSUE LINK SVC                */ 05845000
         SVC   6                                                   1208 05846000
*                 RESPECIFY                                        1209 05847000
*                  (GPR01P) UNRESTRICTED;                          1209 05848000
*                 RESPECIFY                                        1210 05849000
*                  (GPR15P) UNRESTRICTED;                          1210 05850000
*               END;                /* LINK EP('IEFAB49C')         1211 05851000
*                                      PARAM(VMVREQBP,0,0) LINK TO 1211 05852000
*                                      ROUTINE                       */ 05853000
*               UCBRESV='0'B;       /* RESET RESERVED INDICATOR      */ 05854000
*               UCBCHGS='0'B;       /* RESET PENDING OFFLINE       1213 05855000
*                                      INDICATOR                     */ 05856000
         L     @12,UCBPTR                                          1213 05857000
         NI    UCBRESV(@12),B'10011111'                            1213 05858000
*               RFY                                                1214 05859000
*                (R1) UNRSTD;       /* RELEASE REG ONE               */ 05860000
*             END;                                                 1215 05861000
*                                                                  1215 05862000
*           /*********************************************************/ 05863000
*           /*                                                       */ 05864000
*           /* DEVICE WAS NOT A TAPE OR DASD. CHECK IF DEVICE HAS A  */ 05865000
*           /* ERROR BUFFER WHICH MUST BE RECORDED                   */ 05866000
*           /*                                                       */ 05867000
*           /*********************************************************/ 05868000
*                                                                  1216 05869000
*           ELSE                    /*                       @Z40MPXA*/ 05870000
*                                                                  1216 05871000
*             /*******************************************************/ 05872000
*             /*                                                     */ 05873000
*             /* CHECK FOR ERROR BUFFER                              */ 05874000
*             /*                                                     */ 05875000
*             /*******************************************************/ 05876000
*                                                                  1216 05877000
*             IF UCBERLOG='1'B&HIERONLY^='1'B THEN/* ERROR LOG?      */ 05878000
         B     @RC01188                                            1216 05879000
@RF01188 L     @12,UCBPTR                                          1216 05880000
         L     @11,UCBEXTPT(,@12)                                  1216 05881000
         TM    UCBERLOG(@11),B'00000100'                           1216 05882000
         BNO   @RF01216                                            1216 05883000
         TM    HIERONLY(RCRDRPTR),B'10000000'                      1216 05884000
         BO    @RF01216                                            1216 05885000
*               DO;                 /*                       @ZA15762*/ 05886000
*                                                                  1217 05887000
*                 /***************************************************/ 05888000
*                 /*                                                 */ 05889000
*                 /* SET UP TO RECORD BUFFER FOR DEVICE              */ 05890000
*                 /*                                                 */ 05891000
*                 /***************************************************/ 05892000
*                                                                  1218 05893000
*                 RFY                                              1218 05894000
*                  (R0,                                            1218 05895000
*                   R1) RSTD;       /* RESTRICT REGISTERS    @Z40MPXA*/ 05896000
*                 R0=-UCBPTR;       /* UCB ADDRESS COMPLEMENT      1219 05897000
*                                                            @Z40MPXA*/ 05898000
         LCR   @12,@12                                             1219 05899000
         LR    R0,@12                                              1219 05900000
*                 R1=0;             /* ZERO REGISTER FOR CALL      1220 05901000
*                                                            @Z40MPXA*/ 05902000
         SLR   R1,R1                                               1220 05903000
*                 SVC(91);          /* ISSUE SVC             @Z40MPXA*/ 05904000
         SVC   91                                                  1221 05905000
*                 RFY                                              1222 05906000
*                  (R0,                                            1222 05907000
*                   R1) UNRSTD;     /* RELEASE REGISTERS     @Z40MPXA*/ 05908000
*               END;                /*                       @Z40MPXA*/ 05909000
*         END;                      /* END OF DEVOFF PROCESSING      */ 05910000
@RF01216 DS    0H                                                  1224 05911000
@RC01188 DS    0H                                                  1225 05912000
*     RCRDRPTR=NEXTPTR;             /* ADDRESSABILITY FOR NEXT     1225 05913000
*                                      RECORDER BLOCK                */ 05914000
@RF01182 DS    0H                                                  1225 05915000
@RC01175 L     RCRDRPTR,NEXTPTR(,RCRDRPTR)                         1225 05916000
*   END;                            /* END OF DO LOOP                */ 05917000
@DE01173 LTR   RCRDRPTR,RCRDRPTR                                   1226 05918000
         BNZ   @DL01173                                            1226 05919000
*   UCBDONE='1'B;                   /* SET UCB COMPLETE FLAG         */ 05920000
         OI    UCBDONE,B'01000000'                                 1227 05921000
*   END;                            /* ******* END OF UCBMARK PROC   */ 05922000
@EL00007 L     @13,4(,@13)                                         1228 05923000
@EF00007 DS    0H                                                  1228 05924000
@ER00007 LM    @14,@12,12(@13)                                     1228 05925000
         BR    @14                                                 1228 05926000
*                                                                  1229 05927000
*/****** PSAFREE *****************************************************  05928000
*                                                                    */ 05929000
*/* ROUTINE WILL INSURE THAT ALL ONLINE CPU'S HAVE BEEN ENABLED AT   */ 05930000
*/* LEAST ONCE THEN WILL ZERO ALL PSA POINTERS TO THE SUBJECT CPU'S  */ 05931000
*/* PSA AND FREE THE 4K PSA. IF ANY ERRORS ARE ENCOUNTERED THE PSA   */ 05932000
*/* WILL NOT BE FREED                                                */ 05933000
*/********************************************************************/ 05934000
*                                                                  1229 05935000
*PSAFREE:                                                          1229 05936000
*   PROC;                                                          1229 05937000
*                                                                  1229 05938000
PSAFREE  STM   @14,@12,@SA00008                                    1229 05939000
*   /*****************************************************************/ 05940000
*   /*                                                               */ 05941000
*   /* SET UP LOOP TO SCAN ALL CPU'S POSSIBLE IN THE SYSTEM          */ 05942000
*   /*                                                               */ 05943000
*   /*****************************************************************/ 05944000
*                                                                  1230 05945000
*   DO LOOPCNT=0 TO 15;             /* LOOP CONTROL                  */ 05946000
*                                                                  1230 05947000
         SLR   @12,@12                                             1230 05948000
         ST    @12,LOOPCNT                                         1230 05949000
@DL01230 DS    0H                                                  1231 05950000
*     /***************************************************************/ 05951000
*     /*                                                             */ 05952000
*     /* BUILD BIT MASK REPRESENTING THIS CPU TO TEST ALIVE MASK     */ 05953000
*     /*                                                             */ 05954000
*     /***************************************************************/ 05955000
*                                                                  1231 05956000
*     TEMPMASK=CSDMASK(LOOPCNT+1);  /* PICK UP BIT MASK FROM CSD     */ 05957000
*                                                                  1231 05958000
         LR    @06,@12                                             1231 05959000
         ALR   @06,@06                                             1231 05960000
         L     @04,CVTPTR                                          1231 05961000
         L     @15,CVTCSD(,@04)                                    1231 05962000
         ALR   @06,@15                                             1231 05963000
         SLR   TEMPMASK,TEMPMASK                                   1231 05964000
         ICM   TEMPMASK,3,CSDMASK(@06)                             1231 05965000
*     /***************************************************************/ 05966000
*     /*                                                             */ 05967000
*     /* CHECK IF SUBJECT CPU IS ONLINE                              */ 05968000
*     /*                                                             */ 05969000
*     /***************************************************************/ 05970000
*                                                                  1232 05971000
*     IF(CSDCPUAL&TEMPMASK)^=0 THEN /* CPU OFFLINE                   */ 05972000
         LR    @06,TEMPMASK                                        1232 05973000
         SLR   @03,@03                                             1232 05974000
         ICM   @03,3,CSDCPUAL(@15)                                 1232 05975000
         NR    @06,@03                                             1232 05976000
         LTR   @06,@06                                             1232 05977000
         BZ    @RF01232                                            1232 05978000
*       DO;                                                        1233 05979000
*                                                                  1233 05980000
*         /***********************************************************/ 05981000
*         /*                                                         */ 05982000
*         /* CPU IS ALIVE WAIT TILL CPU HAS BEEN ENABLED AT LEAST    */ 05983000
*         /* ONCE                                                    */ 05984000
*         /*                                                         */ 05985000
*         /***********************************************************/ 05986000
*                                                                  1234 05987000
*         RFY                                                      1234 05988000
*          (R1,                                                    1234 05989000
*           R11,                                                   1234 05990000
*           R12,                                                   1234 05991000
*           RETCODE) RSTD;          /* RESTRICT REGS         @YM08660*/ 05992000
*         R1=PCCAT00P(LOOPCNT+1);   /* ADDRESS OF PCCA               */ 05993000
         L     @14,LOOPCNT                                         1235 05994000
         SLA   @14,2                                               1235 05995000
         L     @10,CVTPCCAT(,@04)                                  1235 05996000
         L     R1,PCCAT00P(@14,@10)                                1235 05997000
*         R12=ADDR(CVTBRET);        /* LOAD ADDRESS OF BR14          */ 05998000
         LA    R12,CVTBRET(,@04)                                   1236 05999000
*         GEN(RISGNL  SERIAL,CPU=(1),EP=(12));/* CAUSE TASK SWITCH   */ 06000000
*                                                                  1237 06001000
         RISGNL  SERIAL,CPU=(1),EP=(12)                                 06002000
*         /***********************************************************/ 06003000
*         /*                                                         */ 06004000
*         /* CHECK FOR ANY ERROR RETURN CODE. IF SO DO NOT FREE PSA  */ 06005000
*         /*                                                         */ 06006000
*         /***********************************************************/ 06007000
*                                                                  1238 06008000
*         IF RETCODE^=0&RETCODE^=4 THEN                            1238 06009000
         LTR   RETCODE,RETCODE                                     1238 06010000
         BZ    @RF01238                                            1238 06011000
         CH    RETCODE,@CH00076                                    1238 06012000
         BNE   @RT01238                                            1238 06013000
*           GOTO PSAFREXT;          /* RETURN TO CALLER              */ 06014000
*         RFY                                                      1240 06015000
*          (R1,                                                    1240 06016000
*           R11,                                                   1240 06017000
*           R12,                                                   1240 06018000
*           RETCODE) UNRSTD;        /* RELEASE REGS FOR USE  @YM08660*/ 06019000
@RF01238 DS    0H                                                  1241 06020000
*       END;                        /* END OF FREE ROUTINE           */ 06021000
*   END;                            /* END OF CPU SCAN ROUTINE       */ 06022000
*                                                                  1242 06023000
@RF01232 LA    @12,1                                               1242 06024000
         AL    @12,LOOPCNT                                         1242 06025000
         ST    @12,LOOPCNT                                         1242 06026000
         CH    @12,@CH00344                                        1242 06027000
         BNH   @DL01230                                            1242 06028000
*   /*****************************************************************/ 06029000
*   /*                                                               */ 06030000
*   /* SET UP CONDITIONS TO FREE PSA LOAD PCCA AND LCCA POINTERS FOR */ 06031000
*   /* SUBJECT CPU                                                   */ 06032000
*   /*                                                               */ 06033000
*   /*****************************************************************/ 06034000
*                                                                  1243 06035000
*   PCCAPTR=PCCAT00P(HEXCPUAD+1);   /* LOAD PCCA ADDRESS             */ 06036000
         SLR   @12,@12                                             1243 06037000
         ICM   @12,3,HEXCPUAD                                      1243 06038000
         SLA   @12,2                                               1243 06039000
         L     @06,CVTPTR                                          1243 06040000
         L     @06,CVTPCCAT(,@06)                                  1243 06041000
         L     @12,PCCAT00P(@12,@06)                               1243 06042000
         ST    @12,PCCAPTR                                         1243 06043000
*   COREPTR=PCCAPSAV;               /* ADDRESS OF PSA TO FREE        */ 06044000
         MVC   COREPTR(4),PCCAPSAV(@12)                            1244 06045000
*   GETLENG=LENGTH(PSA);            /* LENGTH TO FREE IS 4K          */ 06046000
         MVC   GETLENG(2),@CH03995                                 1245 06047000
*   SUBPOOL=245;                    /* SUBPOOL NUMBER TO FREE        */ 06048000
*                                                                  1246 06049000
         MVI   SUBPOOL,X'F5'                                       1246 06050000
*   /*****************************************************************/ 06051000
*   /*                                                               */ 06052000
*   /* ZERO ALL POINTERS TO THIS PSA                                 */ 06053000
*   /*                                                               */ 06054000
*   /*****************************************************************/ 06055000
*                                                                  1247 06056000
*   PCCAPSAV=0;                     /*                               */ 06057000
         SLR   @06,@06                                             1247 06058000
         ST    @06,PCCAPSAV(,@12)                                  1247 06059000
*   PCCAPSAR=0;                     /* ZERO POINTER                  */ 06060000
*                                                                  1248 06061000
         ST    @06,PCCAPSAR(,@12)                                  1248 06062000
*   /*****************************************************************/ 06063000
*   /*                                                               */ 06064000
*   /* CALL FREEMAIN ROUTINE TO FREE PSA                             */ 06065000
*   /*                                                               */ 06066000
*   /*****************************************************************/ 06067000
*                                                                  1249 06068000
*   CALL FREECORE;                                                 1249 06069000
         BAL   @14,FREECORE                                        1249 06070000
*PSAFREXT:                                                         1250 06071000
*   END;                            /* END OF PSAFREE ROUTINE        */ 06072000
@EL00008 DS    0H                                                  1250 06073000
@EF00008 DS    0H                                                  1250 06074000
@ER00008 LM    @14,@12,@SA00008                                    1250 06075000
         BR    @14                                                 1250 06076000
*CONVERT:                                                          1251 06077000
*   PROC(HEXRSLT,BITMASK) OPTIONS(NOSAVEAREA);                     1251 06078000
CONVERT  STM   @14,@12,12(@13)                                     1251 06079000
         MVC   @PC00009(8),0(@01)                                  1251 06080000
*   DCL                                                            1252 06081000
*     HEXRSLT FIXED(16),            /* RESULT FIELD PASSED BY CALLER */ 06082000
*     BITMASK FIXED(16),            /* BIT MASK FIELD PASSED BY    1252 06083000
*                                      CALLER                        */ 06084000
*     CONVCHAR BIT(8) BASED(CHARPTR);/* CHARACTER TO BE CONVERTED    */ 06085000
*/*** CONVERT ROUTINE ******************************************     */ 06086000
*/* CONVERT ROUTINE WILL CONVERT A EBDIC CHARACTER POINTED TO BY     */ 06087000
*/* CHARPTR INTO A HEX DIGIT AND BUILD A BIT BASK REPRESENTING       */ 06088000
*/* THE CONVERTED CHARACTER. TWO PARAMETERS ARE REQUIRED. HEXRSLT    */ 06089000
*/* LOCATION AND BITMASK LOCATION, CHARPTR WILL NOT BE MODIFIED      */ 06090000
*/****************************************************************   */ 06091000
*                                                                  1253 06092000
*   HEXRSLT=CONVCHAR;               /* MOVE CHARACTER TO BE CONVERTED*/ 06093000
*                                                                  1253 06094000
         L     @12,@PC00009                                        1253 06095000
         SLR   @06,@06                                             1253 06096000
         IC    @06,CONVCHAR(,CHARPTR)                              1253 06097000
         STH   @06,HEXRSLT(,@12)                                   1253 06098000
*   /*****************************************************************/ 06099000
*   /*                                                               */ 06100000
*   /* DETERMINE IF CHAR IS ALPHA OR NUMERIC. CONVERT TO HEX BY      */ 06101000
*   /* REMOVING ZONE FOR NUMERICS, OR REMOVING ZONE AND ADDING 9 FOR */ 06102000
*   /* ALPHA CHARACTERS                                              */ 06103000
*   /*                                                               */ 06104000
*   /*****************************************************************/ 06105000
*                                                                  1254 06106000
*   IF HEXRSLT<'0' THEN             /* CHECK FOR ALPHA               */ 06107000
         CH    @06,@CH03594                                        1254 06108000
         BNL   @RF01254                                            1254 06109000
*     HEXRSLT=HEXRSLT-183;          /* REMOVE ZONE AND ADJUST        */ 06110000
*                                                                  1255 06111000
         SH    @06,@CH03789                                        1255 06112000
         STH   @06,HEXRSLT(,@12)                                   1255 06113000
*   /*****************************************************************/ 06114000
*   /*                                                               */ 06115000
*   /* WAS NOT A ALPHA CHARACTER. MUST THEN BE A DECIMAL DIGIT       */ 06116000
*   /*                                                               */ 06117000
*   /*****************************************************************/ 06118000
*                                                                  1256 06119000
*   ELSE                                                           1256 06120000
*     HEXRSLT=HEXRSLT-240;          /* IS NUMERIC REMOVE ZONE        */ 06121000
*                                                                  1256 06122000
         B     @RC01254                                            1256 06123000
@RF01254 L     @12,@PC00009                                        1256 06124000
         SLR   @06,@06                                             1256 06125000
         ICM   @06,3,HEXRSLT(@12)                                  1256 06126000
         SH    @06,@CH03790                                        1256 06127000
         STH   @06,HEXRSLT(,@12)                                   1256 06128000
*   /*****************************************************************/ 06129000
*   /*                                                               */ 06130000
*   /* PICK UP BIT MASK FROM CSD REPRESENTING CPU SPECIFIED          */ 06131000
*   /*                                                               */ 06132000
*   /*****************************************************************/ 06133000
*                                                                  1257 06134000
*   BITMASK=CSDMASK(HEXRSLT+1);     /* PICK UP BIT MASK FROM CSD     */ 06135000
@RC01254 L     @12,@PC00009+4                                      1257 06136000
         L     @06,@PC00009                                        1257 06137000
         SLR   @04,@04                                             1257 06138000
         ICM   @04,3,HEXRSLT(@06)                                  1257 06139000
         ALR   @04,@04                                             1257 06140000
         L     @06,CVTPTR                                          1257 06141000
         L     @06,CVTCSD(,@06)                                    1257 06142000
         ALR   @06,@04                                             1257 06143000
         MVC   BITMASK(2,@12),CSDMASK(@06)                         1257 06144000
*   END;                            /* *** END OF CONVERT ROUTINE    */ 06145000
@EL00009 DS    0H                                                  1258 06146000
@EF00009 DS    0H                                                  1258 06147000
@ER00009 LM    @14,@12,12(@13)                                     1258 06148000
         BR    @14                                                 1258 06149000
*UCBRCRDR:                                                         1259 06150000
*   PROC;                                                          1259 06151000
*                                                                  1259 06152000
UCBRCRDR STM   @14,@12,@SA00010                                    1259 06153000
*/****** UCBRCRDR ************************************************** */ 06154000
*/* UCBRCRDR ROUTINE WILL BUILD AND CHAIN DEVICE RECORDER BLOCKS     */ 06155000
*/* BLOCKS CONSIST OF A CHAIN POINTER, UCB ADDRESS, AND FLAG FIELD   */ 06156000
*/* FLAG FIELD IS SET UP BY CALLING ROUTINE AND COPIED INTO RECORD-  */ 06157000
*/* ER BLOCK.                                                        */ 06158000
*/* POSSIBLE ERROR FLAGS ARE: NOCORE                                 */ 06159000
*/*****************************************************************  */ 06160000
*                                                                  1260 06161000
*   RCRDRPTR=ENTRYPTR;              /* SET UP ADDRESSABILITY TO FIRST   06162000
*                                      RECORDER BLOCK                */ 06163000
*                                                                  1260 06164000
         L     RCRDRPTR,ENTRYPTR                                   1260 06165000
*   /*****************************************************************/ 06166000
*   /*                                                               */ 06167000
*   /* CHECK FOR POSSIBLE DUPLICATE ENTRY. IF DUPLICATE IS FOUND DO  */ 06168000
*   /* NOT BUILD RECORDER BLOCK, RETURN CONRTOL TO CALLER SET UP     */ 06169000
*   /* DOLOOP TO SCAN THROUGH RECORDER BLOCKS                        */ 06170000
*   /*                                                               */ 06171000
*   /*****************************************************************/ 06172000
*                                                                  1261 06173000
*   DO WHILE(RCRDRPTR^=0);          /* SCAN ALL RECORDER BLOCKS      */ 06174000
         B     @DE01261                                            1261 06175000
@DL01261 DS    0H                                                  1262 06176000
*     IF UCBPTR=UCBADDR THEN        /* CHECK FOR DUPLICATE ENTRY     */ 06177000
         L     @12,UCBPTR                                          1262 06178000
         SLR   @11,@11                                             1262 06179000
         ICM   @11,7,UCBADDR(RCRDRPTR)                             1262 06180000
         CR    @12,@11                                             1262 06181000
         BE    @RT01262                                            1262 06182000
*       GOTO UCBRDEXT;              /* RETURN CONTROL TO CALLER IF 1263 06183000
*                                      DUPLICATE IS FOUND            */ 06184000
*                                                                  1263 06185000
*     /***************************************************************/ 06186000
*     /*                                                             */ 06187000
*     /* WAS NOT DUPLICATE.. KEEP ON SCANNING                        */ 06188000
*     /*                                                             */ 06189000
*     /***************************************************************/ 06190000
*                                                                  1264 06191000
*     ELSE                                                         1264 06192000
*       RCRDRPTR=NEXTPTR;           /* ADDRESSABILITY FOR NEXT BLOCK */ 06193000
         L     RCRDRPTR,NEXTPTR(,RCRDRPTR)                         1264 06194000
*   END;                            /* END OF DO LOOP                */ 06195000
*                                                                  1265 06196000
@DE01261 LTR   RCRDRPTR,RCRDRPTR                                   1265 06197000
         BNZ   @DL01261                                            1265 06198000
*   /*****************************************************************/ 06199000
*   /*                                                               */ 06200000
*   /* DUPLICATE DOES NOT EXIST.. SET UP PARAMETERS FOR GETCORE      */ 06201000
*   /* ROUTINE AND GET STORAGE FOR RECORDER BLOCK.. STORAGE IS FROM  */ 06202000
*   /* SUBPOOL ZERO                                                  */ 06203000
*   /*                                                               */ 06204000
*   /*****************************************************************/ 06205000
*                                                                  1266 06206000
*   SUBPOOL=0;                      /* SUBPOOL NUMBER                */ 06207000
         MVI   SUBPOOL,X'00'                                       1266 06208000
*   GETLENG=8;                      /* LENGTH OF RECORDER BLOCK      */ 06209000
         MVC   GETLENG(2),@CH00036                                 1267 06210000
*   CALL GETCORE;                   /* CALL GETCORE ROUTINE          */ 06211000
*                                                                  1268 06212000
         BAL   @14,GETCORE                                         1268 06213000
*   /*****************************************************************/ 06214000
*   /*                                                               */ 06215000
*   /* CHECK FOR ANY POSSIBLE ERROR FROM GETCORE                     */ 06216000
*   /*                                                               */ 06217000
*   /*****************************************************************/ 06218000
*                                                                  1269 06219000
*   IF ERRORIND^=0 THEN             /* ANY ERROR SET                 */ 06220000
         SLR   @12,@12                                             1269 06221000
         CL    @12,ERRORIND                                        1269 06222000
         BNE   @RT01269                                            1269 06223000
*     GOTO UCBRDEXT;                /* RETURN CONTROL TO NEXT HIGHER    06224000
*                                      LEVEL OF CONTROL              */ 06225000
*   RCRDRPTR=COREPTR;               /* ADDRESSABILITY FOR STORAGE  1271 06226000
*                                      JUST OBTAINED                 */ 06227000
*                                                                  1271 06228000
         L     RCRDRPTR,COREPTR                                    1271 06229000
*   /*****************************************************************/ 06230000
*   /*                                                               */ 06231000
*   /* CHECK IF THIS IS FIRST RECORDER BLOCK AND CHAIN BLOCKS        */ 06232000
*   /*                                                               */ 06233000
*   /*****************************************************************/ 06234000
*                                                                  1272 06235000
*   IF ENTRYPTR=0 THEN              /* IS THIS THE FIRST BLOCK?      */ 06236000
         C     @12,ENTRYPTR                                        1272 06237000
         BNE   @RF01272                                            1272 06238000
*     NEXTPTR=0;                    /* ZERO OUT CHAIN POINTER FOR  1273 06239000
*                                      LAST ENTRY                    */ 06240000
*                                                                  1273 06241000
         ST    @12,NEXTPTR(,RCRDRPTR)                              1273 06242000
*   /*****************************************************************/ 06243000
*   /*                                                               */ 06244000
*   /* WAS NOT FIRST BLOCK ON CHAIN. SO CHAIN BLOCKS TOGETHER        */ 06245000
*   /*                                                               */ 06246000
*   /*****************************************************************/ 06247000
*                                                                  1274 06248000
*   ELSE                                                           1274 06249000
*     NEXTPTR=ENTRYPTR;             /* CHAIN BLOCKS TOGETHER         */ 06250000
         B     @RC01272                                            1274 06251000
@RF01272 MVC   NEXTPTR(4,RCRDRPTR),ENTRYPTR                        1274 06252000
*   ENTRYPTR=RCRDRPTR;              /* ANCHOR THIS BLOCK OUT OF    1275 06253000
*                                      WORKAREA                      */ 06254000
*                                                                  1275 06255000
@RC01272 ST    RCRDRPTR,ENTRYPTR                                   1275 06256000
*   /*****************************************************************/ 06257000
*   /*                                                               */ 06258000
*   /* BLOCKS ARE CHAINED TOGETHER.. BUILD ENTRY BY SAVING UCB       */ 06259000
*   /* ADDRESS AND DEVICE STATUS FIELD OUT OF WORKAREA               */ 06260000
*   /*                                                               */ 06261000
*   /*****************************************************************/ 06262000
*                                                                  1276 06263000
*   CAUSEFLD=DEVSTAT;               /* FLAG FIELD FROM WORKAREA      */ 06264000
         MVC   CAUSEFLD(1,RCRDRPTR),DEVSTAT                        1276 06265000
*   UCBADDR=UCBPTR;                 /* UCB ADDRESS                   */ 06266000
*                                                                  1277 06267000
         L     @12,UCBPTR                                          1277 06268000
         STCM  @12,7,UCBADDR(RCRDRPTR)                             1277 06269000
*   /*****************************************************************/ 06270000
*   /*                                                               */ 06271000
*   /* IF THIS IS A CONSOLE ENTRY THEN SET FLAG IN UCB FOR CONSOLE   */ 06272000
*   /* SWITCH ROUTINE                                                */ 06273000
*   /*                                                               */ 06274000
*   /*****************************************************************/ 06275000
*                                                                  1278 06276000
*   IF CONSLFLG='1'B THEN           /* CONSOLE ENTRY?                */ 06277000
         TM    CONSLFLG(RCRDRPTR),B'01000000'                      1278 06278000
         BNO   @RF01278                                            1278 06279000
*     UCBVHRSN='1'B;                /* SET HIER REASON INDICATOR     */ 06280000
         OI    UCBVHRSN(@12),B'00000010'                           1279 06281000
*UCBRDEXT:                                                         1280 06282000
*   DEVSTAT=0;                      /* RESET FLAG FIELD IN WORKAREA  */ 06283000
@RF01278 DS    0H                                                  1280 06284000
UCBRDEXT MVI   DEVSTAT,X'00'                                       1280 06285000
*   END;                            /* END OF UCB RECORDER ROUTINE   */ 06286000
@EL00010 DS    0H                                                  1281 06287000
@EF00010 DS    0H                                                  1281 06288000
@ER00010 LM    @14,@12,@SA00010                                    1281 06289000
         BR    @14                                                 1281 06290000
*IEEVIOQ:                                                          1282 06291000
*   PROC;                           /*                               */ 06292000
IEEVIOQ  STM   @14,@12,@SA00011                                    1282 06293000
*/****** IEEVIOQ *****************************************************/ 06294000
*/* IEEVIOQ ROUTINE WILL SCAN THROUGH ALL DEVICES ON THE SYSTEM AND  */ 06295000
*/* VERIFY THAT ALL I/O ACTIVITY ON THE SPECIFIED CPU/CHANNEL HAS    */ 06296000
*/* COMPLETED. TESTS ARE MADE FOR OUTSTANDING DEVICE RESERVE         */ 06297000
*/* CONDITIONS. POSSIBLE ERROR FLAGS ARE: PATHRSVD                   */ 06298000
*/********************************************************************/ 06299000
*                                                                  1283 06300000
*   IONOTQT='0'B;                   /* RESET IO NOT QUIET FLAG       */ 06301000
*                                                                  1283 06302000
         NI    IONOTQT,B'11110111'                                 1283 06303000
*   /*****************************************************************/ 06304000
*   /*                                                               */ 06305000
*   /* SET UP DO LOOP TO SCAN THROUGH ALL SYSTEM DEVICES             */ 06306000
*   /*                                                               */ 06307000
*   /*****************************************************************/ 06308000
*                                                                  1284 06309000
*   DO UCBLKPTR=CVTILK2 BY 2 WHILE(UCBTAB^='FFFF'X);/* SCAN          */ 06310000
*                                                                  1284 06311000
         L     @12,CVTPTR                                          1284 06312000
         L     @12,CVTILK2(,@12)                                   1284 06313000
         ST    @12,UCBLKPTR                                        1284 06314000
         B     @DE01284                                            1284 06315000
@DL01284 DS    0H                                                  1285 06316000
*     /***************************************************************/ 06317000
*     /*                                                             */ 06318000
*     /* IF TABLE ENTRY IS ZERO THEN SKIP TO NEXT ENTRY              */ 06319000
*     /*                                                             */ 06320000
*     /***************************************************************/ 06321000
*                                                                  1285 06322000
*     IF UCBTAB='0000'X THEN        /* SKIP TO NEXT ENTRY IF DUMMY   */ 06323000
         L     @12,UCBLKPTR                                        1285 06324000
         SLR   @06,@06                                             1285 06325000
         ICM   @06,3,UCBTAB(@12)                                   1285 06326000
         LTR   @06,@06                                             1285 06327000
         BZ    @RT01285                                            1285 06328000
*       GOTO IOQLOOP;               /* STEP TO NEXT ENTRY            */ 06329000
*                                                                  1286 06330000
*     /***************************************************************/ 06331000
*     /*                                                             */ 06332000
*     /* ESTABLISH ADDRESSABILITY TO UCB                             */ 06333000
*     /*                                                             */ 06334000
*     /***************************************************************/ 06335000
*                                                                  1287 06336000
*     UCBPTR=UCBTAB;                /* POINT TO UCB                  */ 06337000
*                                                                  1287 06338000
         ST    @06,UCBPTR                                          1287 06339000
*     /***************************************************************/ 06340000
*     /*                                                             */ 06341000
*     /* CHECK IF THIS IS A CHANNEL RECONFIGURATION VARY. IF SO OTHER*/ 06342000
*     /* FLAGS IN THE UCB MUST BE CHECKED FOR OUTSTANDING I/O        */ 06343000
*     /*                                                             */ 06344000
*     /***************************************************************/ 06345000
*                                                                  1288 06346000
*     IF CRH='1'B THEN              /* CRH VARY?             @Y30CQXA*/ 06347000
         TM    CRH,B'00000010'                                     1288 06348000
         BNO   @RF01288                                            1288 06349000
*       DO;                         /*                       @Y30CQXA*/ 06350000
*                                                                  1289 06351000
*         /***********************************************************/ 06352000
*         /*                                                         */ 06353000
*         /* CHECK IF LAST SIO WAS ISSUED FROM SUBJECT CHANNEL       */ 06354000
*         /*                                                 @Y30CQXA*/ 06355000
*         /*                                                         */ 06356000
*         /***********************************************************/ 06357000
*                                                                  1290 06358000
*         IF UCBCHA^=HEXCHN1 THEN   /* FROM OUR CHANNEL      @Y30CQXA*/ 06359000
         CLC   UCBCHA(1,@06),HEXCHN1                               1290 06360000
         BNE   @RT01290                                            1290 06361000
*           GOTO IOQLOOP;           /* NO.. SKIP TO NEXT UCB @Y30CQXA*/ 06362000
*                                                                  1291 06363000
*         /***********************************************************/ 06364000
*         /*                                                         */ 06365000
*         /* LAST I/O OPERATION WAS FROM CORRECT CHANNEL NUMBER.     */ 06366000
*         /* CHECK IF A OUTSTANDING RESERVE EXISTS THAT WAS ISSUED BY*/ 06367000
*         /* THE REMOTE CHANNEL                                      */ 06368000
*         /*                                                         */ 06369000
*         /***********************************************************/ 06370000
*                                                                  1292 06371000
*         IF UCBCRHRV='1'B THEN     /* RESERVE?              @Y30CQXA*/ 06372000
         TM    UCBCRHRV(@06),B'00001000'                           1292 06373000
         BNO   @RF01292                                            1292 06374000
*           DO;                                                    1293 06375000
*                                                                  1293 06376000
*             /*******************************************************/ 06377000
*             /*                                                     */ 06378000
*             /* SET RESERVED PATH ERROR FLAG AND RETURN TO CALLER   */ 06379000
*             /*                                                     */ 06380000
*             /*******************************************************/ 06381000
*                                                                  1294 06382000
*             DDD=UCBNAME;          /* COPY UCB NAME FOR MESSAGE   1294 06383000
*                                                            @Y30CQXA*/ 06384000
         MVC   DDD(3),UCBNAME(@06)                                 1294 06385000
*             PATHRSVD='1'B;        /* SET RESERVED ERROR FLAG     1295 06386000
*                                                            @Y30CQXA*/ 06387000
         OI    PATHRSVD,B'00001000'                                1295 06388000
*             GOTO IOQEXIT;         /* RETURN TO CALLER      @Y30CQXA*/ 06389000
         B     IOQEXIT                                             1296 06390000
*           END;                    /* END OF RESERVE PROCESSING   1297 06391000
*                                                            @Y30CQXA*/ 06392000
*                                                                  1297 06393000
*         /***********************************************************/ 06394000
*         /*                                                         */ 06395000
*         /* CHECK IF THE LAST I/O OPERATION WAS ON A REMOTE CHANNEL */ 06396000
*         /* AND I/O HAS NOT YET COMPLETED.                          */ 06397000
*         /*                                                         */ 06398000
*         /***********************************************************/ 06399000
*                                                                  1298 06400000
*         IF UCBIORST='1'B&(UCBBSY='1'B|UCBPSNS='1'B) THEN/* BUSY? 1298 06401000
*                                                            @Y30CQXA*/ 06402000
@RF01292 L     @12,UCBPTR                                          1298 06403000
         TM    UCBIORST(@12),B'10000000'                           1298 06404000
         BNO   @RF01298                                            1298 06405000
         TM    UCBBSY(@12),B'10010000'                             1298 06406000
         BZ    @RF01298                                            1298 06407000
*           DO;                     /*                       @Y30CQXA*/ 06408000
*                                                                  1299 06409000
*             /*******************************************************/ 06410000
*             /*                                                     */ 06411000
*             /* I/O HAS NOT YET COMPLETED. SET BUSY FOOTPRINT AND   */ 06412000
*             /* CONTINUE                                            */ 06413000
*             /*                                                     */ 06414000
*             /*******************************************************/ 06415000
*                                                                  1300 06416000
*             DDD=UCBNAME;          /* DEVICE NAME FOR MESSAGE TEXT     06417000
*                                                            @Y30CQXA*/ 06418000
         MVC   DDD(3),UCBNAME(@12)                                 1300 06419000
*             IONOTQT='1'B;         /* SET BUSY FOOTPRINT    @Y30CQXA*/ 06420000
         OI    IONOTQT,B'00001000'                                 1301 06421000
*           END;                    /*                       @Y30CQXA*/ 06422000
*       END;                        /* END OF CRH PORTION    @Y30CQXA*/ 06423000
*                                                                  1303 06424000
*     /***************************************************************/ 06425000
*     /*                                                             */ 06426000
*     /* WAS NOT A CRH VARY. CONTINUE NORMAL PROCESSING      @Y30CQXA*/ 06427000
*     /*                                                             */ 06428000
*     /***************************************************************/ 06429000
*                                                                  1304 06430000
*     ELSE                          /*                       @Y30CQXA*/ 06431000
*                                                                  1304 06432000
*       /*************************************************************/ 06433000
*       /*                                                           */ 06434000
*       /* IF LAST I/O OPERATION WAS FROM SUBJECT CPU THEN CONTINUE  */ 06435000
*       /* CHECKING                                                  */ 06436000
*       /*                                                           */ 06437000
*       /*************************************************************/ 06438000
*                                                                  1304 06439000
*       IF UCBCPU=HEXCPU1 THEN      /* SHOULD WE CHECK THIS DEVICE?  */ 06440000
*                                                                  1304 06441000
         B     @RC01288                                            1304 06442000
@RF01288 L     @12,UCBPTR                                          1304 06443000
         CLC   UCBCPU(1,@12),HEXCPU1                               1304 06444000
         BNE   @RF01304                                            1304 06445000
*         /***********************************************************/ 06446000
*         /*                                                         */ 06447000
*         /* LAST I/O OPERATION WAS STARTED FROM SUBJECT CPU. IF THIS*/ 06448000
*         /* IS A VARY CHANNEL COMMAND THEN VERIFY THAT LAST I/O     */ 06449000
*         /* OPERATION ORIGINATED FROM SPECIFIED CHANNEL             */ 06450000
*         /*                                                         */ 06451000
*         /***********************************************************/ 06452000
*                                                                  1305 06453000
*         IF(CHNIND='1'B)&(UCBCHA^=HEXCHN1) THEN/* LAST I/O FROM OUR    06454000
*                                      CHANNEL                       */ 06455000
         TM    CHNIND,B'10000000'                                  1305 06456000
         BNO   @RF01305                                            1305 06457000
         CLC   UCBCHA(1,@12),HEXCHN1                               1305 06458000
         BNE   @RT01305                                            1305 06459000
*           GOTO IOQLOOP;           /* STEP TO NEXT DEVICE           */ 06460000
*                                                                  1306 06461000
*     /***************************************************************/ 06462000
*     /*                                                             */ 06463000
*     /* LAST I/O OPERATION WAS FROM OUR CHANNEL/CPU                 */ 06464000
*     /*                                                             */ 06465000
*     /***************************************************************/ 06466000
*                                                                  1307 06467000
*         ELSE                                                     1307 06468000
*           DO;                                                    1307 06469000
*                                                                  1307 06470000
@RF01305 DS    0H                                                  1308 06471000
*             /*******************************************************/ 06472000
*             /*                                                     */ 06473000
*             /* LAST IO OPERATION WAS FROM CHANNEL/CPU COMBINATION  */ 06474000
*             /* THAT IS TO GO OFFLINE. VERIFY THAT NO OUTSTANDING   */ 06475000
*             /* RESERVE CONDITIONS EXIST AND I/O HAS COMPLETED      */ 06476000
*             /*                                                     */ 06477000
*             /*******************************************************/ 06478000
*                                                                  1308 06479000
*             RFY                                                  1308 06480000
*              (R12) RSTD;          /* RESTRICT REGISTER 12          */ 06481000
*             R12=UCBPTR;           /* COPY UCB ADDRESS INTO REG 12  */ 06482000
         L     R12,UCBPTR                                          1309 06483000
*             GEN(IOSGEN DETECTOR,UCB=(12),VAR=1);/* CHECK FOR     1310 06484000
*                                      HARDWARE RESERVED             */ 06485000
         IOSGEN DETECTOR,UCB=(12),VAR=1                                 06486000
*             RFY                                                  1311 06487000
*              (R12) UNRSTD;        /* RELEASE REG 12                */ 06488000
*             BC(8,CONT);           /* CONDITION CODE NON ZERO     1312 06489000
*                                      INDICATES RESERVE OUTSTANDING */ 06490000
         BC    8,CONT                                              1312 06491000
*             DDD=UCBNAME;          /* COPY DEVICE NAME FOR MESSAGE     06492000
*                                      TEXT                          */ 06493000
         L     @12,UCBPTR                                          1313 06494000
         MVC   DDD(3),UCBNAME(@12)                                 1313 06495000
*             PATHRSVD='1'B;        /* SET RESERVED PATH ERROR FLAG  */ 06496000
         OI    PATHRSVD,B'00001000'                                1314 06497000
*             GOTO IOQEXIT;         /* RETURN TO NEXT HIGHER LEVEL OF   06498000
*                                      CONTROL                       */ 06499000
*                                                                  1315 06500000
         B     IOQEXIT                                             1315 06501000
*             /*******************************************************/ 06502000
*             /*                                                     */ 06503000
*             /* CONTINUE PROCESSING IF NO RESERVE OUTSTANDING       */ 06504000
*             /*                                                     */ 06505000
*             /*******************************************************/ 06506000
*                                                                  1316 06507000
*CONT:                                                             1316 06508000
*                                                                  1316 06509000
*             /*******************************************************/ 06510000
*             /*                                                     */ 06511000
*             /* CHECK FOR OUTSTANDING I/O ACTIVITY ON THIS UCB      */ 06512000
*             /*                                                     */ 06513000
*             /*******************************************************/ 06514000
*                                                                  1316 06515000
*             IF UCBBSY='1'B|UCBACTV='1'B|UCBPSNS='1'B THEN/* ANY I/O   06516000
*                                      OUTSTANDING?                  */ 06517000
CONT     L     @12,UCBPTR                                          1316 06518000
         TM    UCBBSY(@12),B'10010010'                             1316 06519000
         BZ    @RF01316                                            1316 06520000
*               DO;                                                1317 06521000
*                 DDD=UCBNAME;      /* MOVE NAME OF DEVICE TO WORK 1318 06522000
*                                      AREA                          */ 06523000
         MVC   DDD(3),UCBNAME(@12)                                 1318 06524000
*                 IONOTQT='1'B;     /* SET NOT QUIET FLAG            */ 06525000
         OI    IONOTQT,B'00001000'                                 1319 06526000
*               END;                                               1320 06527000
*           END;                                                   1321 06528000
*                                                                  1321 06529000
@RF01316 DS    0H                                                  1322 06530000
*     /***************************************************************/ 06531000
*     /*                                                             */ 06532000
*     /* END OF UCB SCAN LOOP                                        */ 06533000
*     /*                                                             */ 06534000
*     /***************************************************************/ 06535000
*                                                                  1322 06536000
*IOQLOOP:                                                          1322 06537000
*   END;                            /* ** END OF DO LOOP             */ 06538000
*                                                                  1322 06539000
@RF01304 DS    0H                                                  1322 06540000
@RC01288 DS    0H                                                  1322 06541000
IOQLOOP  LA    @12,2                                               1322 06542000
         AL    @12,UCBLKPTR                                        1322 06543000
         ST    @12,UCBLKPTR                                        1322 06544000
@DE01284 L     @12,UCBLKPTR                                        1322 06545000
         CLC   UCBTAB(2,@12),@CH03658                              1322 06546000
         BNE   @DL01284                                            1322 06547000
*   /*****************************************************************/ 06548000
*   /*                                                               */ 06549000
*   /* END OF I/O QUIET ROUTINE                                      */ 06550000
*   /*                                                               */ 06551000
*   /*****************************************************************/ 06552000
*                                                                  1323 06553000
*IOQEXIT:                                                          1323 06554000
*   END;                            /* END OF IOQUIET ROUTINE        */ 06555000
@EL00011 DS    0H                                                  1323 06556000
@EF00011 DS    0H                                                  1323 06557000
@ER00011 LM    @14,@12,@SA00011                                    1323 06558000
         BR    @14                                                 1323 06559000
*PSACCA:                                                           1324 06560000
*   PROC;                           /*                       @Y30CQXA*/ 06561000
PSACCA   STM   @14,@11,@SA00012                                    1324 06562000
*/******* PSACCA *****************************************************/ 06563000
*/* PSACCA ROUTINE WILL OBTAIN AND INITIALIZE A NEW PCCA, LCCA AND   */ 06564000
*/* PSA FOR A CPU COMING ONLINE. ADDITIONALLY ANY OLD CCA'S WILL BE  */ 06565000
*/* FREED.                                                           */ 06566000
*/********************************************************************/ 06567000
*                                                                  1325 06568000
*   /*****************************************************************/ 06569000
*   /*                                                               */ 06570000
*   /* SET UP TO OBTAIN STORAGE FOR CCA'S DO NOT CHAIN STORAGE       */ 06571000
*   /*                                                               */ 06572000
*   /*****************************************************************/ 06573000
*                                                                  1325 06574000
*   SUBPOOL=245;                    /* SPECIFY SUBPOOL NUMBER        */ 06575000
         MVI   SUBPOOL,X'F5'                                       1325 06576000
*   NOCHAIN='1'B;                   /* DO NOT CHAIN STORAGE          */ 06577000
         OI    NOCHAIN,B'10000000'                                 1326 06578000
*   GETLENG=(LENGTH(PCCA)+LENGTH(LCCA));/* STORAGE FOR CCA'S         */ 06579000
         MVC   GETLENG(2),@CH03997                                 1327 06580000
*   CALL GETCORE;                   /* LINK TO GET CORE ROUTINE      */ 06581000
*                                                                  1328 06582000
         BAL   @14,GETCORE                                         1328 06583000
*   /*****************************************************************/ 06584000
*   /*                                                               */ 06585000
*   /* CHECK FOR ANY ERRORS DURING GETMAIN                           */ 06586000
*   /*                                                               */ 06587000
*   /*****************************************************************/ 06588000
*                                                                  1329 06589000
*   IF ERRORIND^=0 THEN             /* ANY ERROR?                    */ 06590000
         ICM   @06,15,ERRORIND                                     1329 06591000
         BNZ   @RT01329                                            1329 06592000
*     GOTO PSAEXIT;                 /* RETURN TO CALLER              */ 06593000
*                                                                  1330 06594000
*   /*****************************************************************/ 06595000
*   /*                                                               */ 06596000
*   /* STORAGE HAS BEEN OBTAINED. SET UP POINTERS TO STORAGE         */ 06597000
*   /*                                                               */ 06598000
*   /*****************************************************************/ 06599000
*                                                                  1331 06600000
*   PCCAPTR=COREPTR;                /* ADDRESS OF PCCA               */ 06601000
         L     @06,COREPTR                                         1331 06602000
         ST    @06,PCCAPTR                                         1331 06603000
*   OLDPCCA=PCCAPTR;                /* SAVE ADDRESS FOR FREE INCASE     06604000
*                                      OF ERROR                      */ 06605000
         ST    @06,OLDPCCA                                         1332 06606000
*   LCCAPTR=COREPTR+LENGTH(PCCA);   /* LCCA ADDRESS FOLLOWS PCCA     */ 06607000
         AH    @06,@CH03961                                        1333 06608000
         ST    @06,LCCAPTR                                         1333 06609000
*   OLDLCCA=LCCAPTR;                /* SAVE ADDRESS FOR FREE INCASE     06610000
*                                      OF ERROR                      */ 06611000
*                                                                  1334 06612000
         ST    @06,OLDLCCA                                         1334 06613000
*   /*****************************************************************/ 06614000
*   /*                                                               */ 06615000
*   /* OBTAIN STORAGE FOR PSA. STORAGE MUST BE ON 4K BOUNDRY         */ 06616000
*   /*                                                               */ 06617000
*   /*****************************************************************/ 06618000
*                                                                  1335 06619000
*   NOCHAIN='1'B;                   /* SET NOCHAIN FLAG FOR GETCORE  */ 06620000
         OI    NOCHAIN,B'10000000'                                 1335 06621000
*   SUBPOOL=245;                    /* SUBPOOL NUMBER                */ 06622000
         MVI   SUBPOOL,X'F5'                                       1336 06623000
*   GETLENG=LENGTH(PSA);            /* LENGTH FOR GETMAIN            */ 06624000
         MVC   GETLENG(2),@CH03995                                 1337 06625000
*   CALL GETCORE;                   /* GO OBTAIN STORAGE FOR PSA     */ 06626000
*                                                                  1338 06627000
         BAL   @14,GETCORE                                         1338 06628000
*   /*****************************************************************/ 06629000
*   /*                                                               */ 06630000
*   /* IF GETMAIN WAS UNSUCCESSFUL THEN RETURN TO CLEANUP            */ 06631000
*   /*                                                               */ 06632000
*   /*****************************************************************/ 06633000
*                                                                  1339 06634000
*   IF ERRORIND^=0 THEN             /* ANY ERRORS                    */ 06635000
         ICM   @06,15,ERRORIND                                     1339 06636000
         BNZ   @RT01339                                            1339 06637000
*     GOTO PSAEXIT;                 /* RETURN TO NEXT HIGHER LEVEL   */ 06638000
*   CPUPSA=COREPTR;                 /* ADDRESS OF PSA STORAGE        */ 06639000
*                                                                  1341 06640000
         L     @12,COREPTR                                         1341 06641000
         ST    @12,CPUPSA                                          1341 06642000
*   /*****************************************************************/ 06643000
*   /*                                                               */ 06644000
*   /* STORAGE HAS BEEN OBTAINED FOR NECESSARY STORAGE AREAS         */ 06645000
*   /* INITIALIZE AREAS NOW                                          */ 06646000
*   /*                                                               */ 06647000
*   /*****************************************************************/ 06648000
*                                                                  1342 06649000
*   DO;                                                            1342 06650000
*                                                                  1342 06651000
*/********* PSASETUP *********************************************** */ 06652000
*/* PSASETUP ROUTINE WILL INITIALIZE ANY NECESSARY FIELDS WITHIN THE */ 06653000
*/* NEW PSA JUST BUILT. A SYSGENED COPY OF THE PSA HAS BEEN SAVED    */ 06654000
*/* BY NIP AND A POINTER TO IT IS SAVED IN THE CVT.                  */ 06655000
*/****************************************************************** */ 06656000
*                                                                  1343 06657000
*     /***************************************************************/ 06658000
*     /*                                                             */ 06659000
*     /* COPY SAVED PSA INTO STORAGE OBTAINED FOR NEW PSA            */ 06660000
*     /*                                                             */ 06661000
*     /***************************************************************/ 06662000
*                                                                  1343 06663000
*     RFY                                                          1343 06664000
*      (R10,                                                       1343 06665000
*       R11,                                                       1343 06666000
*       R14,                                                       1343 06667000
*       R15) RSTD;                  /* RESTRICT REGS FOR MVCL        */ 06668000
*     R10=CPUPSA;                   /* NEW PSA ADDRESS TO MOVE TO    */ 06669000
         L     @06,CPUPSA                                          1344 06670000
         LR    R10,@06                                             1344 06671000
*     R11=LENGTH(PSA);              /* LENGTH TO MOVE                */ 06672000
         LH    R11,@CH03995                                        1345 06673000
*     R14=CVTVPSA;                  /* ADDRESS OF SAVED PSA          */ 06674000
         L     @06,CVTPTR                                          1346 06675000
         L     R14,CVTVPSA(,@06)                                   1346 06676000
*     R15=R11;                      /* COPY LENGTH OF PSA            */ 06677000
         LR    R15,R11                                             1347 06678000
*     GEN(MVCL R10,R14);            /* MOVE SAVED PSA TO NEW PSA     */ 06679000
         MVCL R10,R14                                                   06680000
*     RFY                                                          1349 06681000
*      (R10,                                                       1349 06682000
*       R11,                                                       1349 06683000
*       R14,                                                       1349 06684000
*       R15) UNRSTD;                /* RELEASE REGISTERS FOR USE     */ 06685000
*                                                                  1349 06686000
*     /***************************************************************/ 06687000
*     /*                                                             */ 06688000
*     /* SET UP ADDRESSABILITY TO NEW PSA                            */ 06689000
*     /*                                                             */ 06690000
*     /***************************************************************/ 06691000
*                                                                  1350 06692000
*     PSAPTR=CPUPSA;                /* ADDRESSABILITY TO NEW PSA     */ 06693000
         L     PSAPTR,CPUPSA                                       1350 06694000
*     PSAPSA='PSA ';                /* SET ACRONYM IN CONTROL BLOCK  */ 06695000
         MVC   PSAPSA(4,PSAPTR),@CC03809                           1351 06696000
*     PSACPUSA=HEXCPUAD;            /* SET STATIC CPU ADDRESS      1352 06697000
*                                                            @YM03489*/ 06698000
         SLR   @06,@06                                             1352 06699000
         ICM   @06,3,HEXCPUAD                                      1352 06700000
         STH   @06,PSACPUSA(,PSAPTR)                               1352 06701000
*     PSACPUPA=HEXCPUAD;            /* SET CPU ADDRESS               */ 06702000
         STH   @06,PSACPUPA(,PSAPTR)                               1353 06703000
*     PSACPULA=HEXCPUAD+'0040'X;    /* SET LOGICAL ADDRESS           */ 06704000
         LA    @04,64                                              1354 06705000
         ALR   @04,@06                                             1354 06706000
         STH   @04,PSACPULA(,PSAPTR)                               1354 06707000
*     PSAPCCAV=PCCAPTR;             /* VIRTUAL ADDRESS OF PCCA       */ 06708000
         L     @04,PCCAPTR                                         1355 06709000
         ST    @04,PSAPCCAV(,PSAPTR)                               1355 06710000
*     PSACDAL=CVTCDAL+4*HEXCPUAD;   /* SUSPEND-RESUME SUPPORT      1356 06711000
*                                                            @Z40FPXM*/ 06712000
         SLA   @06,2                                               1356 06713000
         L     @01,CVTPTR                                          1356 06714000
         AL    @06,CVTCDAL(,@01)                                   1356 06715000
         ST    @06,PSACDAL(,PSAPTR)                                1356 06716000
*     RNWAIT='0'B;                  /* RESET WAIT BIT IN RESTART PSW */ 06717000
         NI    RNWAIT(PSAPTR),B'11111101'                          1357 06718000
*     RFY                                                          1358 06719000
*      (R14,                                                       1358 06720000
*       R15) RSTD;                  /* RESTRICT REGS FOR LRA         */ 06721000
*                                                                  1358 06722000
*     /***************************************************************/ 06723000
*     /*                                                             */ 06724000
*     /* GET REAL ADDRESS OF CCA'S FOR PSA                           */ 06725000
*     /*                                                             */ 06726000
*     /***************************************************************/ 06727000
*                                                                  1359 06728000
*     R15=PCCAPTR;                  /* LOAD ADDRESS OF PCCA          */ 06729000
         LR    R15,@04                                             1359 06730000
*     GEN(LRA 15,0(15));            /* LOAD REAL ADDRESS OF PCCA     */ 06731000
         LRA 15,0(15)                                                   06732000
*     PSAPCCAR=R15;                 /* STORE REAL ADDRESS OF PCCA    */ 06733000
         ST    R15,PSAPCCAR(,PSAPTR)                               1361 06734000
*     R15=LCCAPTR;                  /* LOAD VIRTUAL ADDRESS OF LCCA  */ 06735000
         L     R15,LCCAPTR                                         1362 06736000
*     GEN(LRA  15,0(15));           /* CONVERT TO REAL ADDRESS       */ 06737000
         LRA  15,0(15)                                                  06738000
*     PSALCCAR=R15;                 /* STORE REAL ADDRESS IN PSA     */ 06739000
         ST    R15,PSALCCAR(,PSAPTR)                               1364 06740000
*     PSALCCAV=LCCAPTR;             /* VIRTUAL LCCA ADDRESS          */ 06741000
         MVC   PSALCCAV(4,PSAPTR),LCCAPTR                          1365 06742000
*     R15=ADDR(PSASTOR);            /* LOAD ADDRESS OF STOR          */ 06743000
         LA    R15,PSASTOR(,PSAPTR)                                1366 06744000
*     GEN(STCTL 1,1,0(15));         /* STORE CONTROL REG ONE INTO PSA*/ 06745000
         STCTL 1,1,0(15)                                                06746000
*     PSAPTR=0;                     /* ADDRESS MY OWN PSA            */ 06747000
         SLR   PSAPTR,PSAPTR                                       1368 06748000
*     R15=PSAAOLD;                  /* PICK UP MASTERS ASCB ADDR     */ 06749000
         L     R15,PSAAOLD(,PSAPTR)                                1369 06750000
*     R14=FLCTRACE;                 /* GET POINTER TO TRACE TABLE    */ 06751000
         L     R14,FLCTRACE(,PSAPTR)                               1370 06752000
*     PSAPTR=CPUPSA;                /* POINT TO NEW PSA              */ 06753000
*                                                                  1371 06754000
         L     @06,CPUPSA                                          1371 06755000
         LR    PSAPTR,@06                                          1371 06756000
*     /***************************************************************/ 06757000
*     /*                                                             */ 06758000
*     /* COPY ASCB POINTER INTO NEW PSA. SINCE WE ARE CURRENTLY      */ 06759000
*     /* RUNNING UNDER THE MASTER ASCB, NEW MEMORY WILL ALSO BE      */ 06760000
*     /*                                                             */ 06761000
*     /***************************************************************/ 06762000
*                                                                  1372 06763000
*     PSAAOLD=R15;                  /* STORE MASTERS ASCB ADDR       */ 06764000
         ST    R15,PSAAOLD(,PSAPTR)                                1372 06765000
*     FLCTRACE=R14;                 /* STORE TRACE TABLE POINTER     */ 06766000
         ST    R14,FLCTRACE(,PSAPTR)                               1373 06767000
*     PSATOLD=0;                    /* ZERO TCB POINTERS             */ 06768000
         SLR   @04,@04                                             1374 06769000
         ST    @04,PSATOLD(,PSAPTR)                                1374 06770000
*     PSATNEW=0;                    /* ZERO TCB POINTERS             */ 06771000
         ST    @04,PSATNEW(,PSAPTR)                                1375 06772000
*     PSAANEW=0;                    /* ZERO ASCB POINTER             */ 06773000
         ST    @04,PSAANEW(,PSAPTR)                                1376 06774000
*     RFY                                                          1377 06775000
*      (R14,                                                       1377 06776000
*       R15) UNRSTD;                /* RELEASE REG 15 FOR USE        */ 06777000
*   END;                            /* ** END OF PSASETUP            */ 06778000
*                                                                  1379 06779000
*/****** CCASETUP ************************************************** */ 06780000
*/* CCASETUP ROUTINE WILL INITIALIZE NEW LCCA AND PCCA FOR CPU TO BE */ 06781000
*/* BROUGHT ONLINE. NO ERROR INDICATORS ARE SET BY THIS ROUTINE      */ 06782000
*/****************************************************************** */ 06783000
*                                                                  1379 06784000
*   DO;                                                            1379 06785000
*                                                                  1379 06786000
*     /***************************************************************/ 06787000
*     /*                                                             */ 06788000
*     /* INITIALIZE NEW CCA'S                                        */ 06789000
*     /*                                                             */ 06790000
*     /***************************************************************/ 06791000
*                                                                  1380 06792000
*     PCCAPCCA='PCCA';              /* CONTROL BLOCK HEADER          */ 06793000
         L     @12,PCCAPTR                                         1380 06794000
         MVC   PCCAPCCA(4,@12),@CC03811                            1380 06795000
*     PCCACPUA=HEXCPUAD;            /* PHYSICAL CPU ADDRESS          */ 06796000
         SLR   @15,@15                                             1381 06797000
         ICM   @15,3,HEXCPUAD                                      1381 06798000
         STH   @15,PCCACPUA(,@12)                                  1381 06799000
*     PCCACAFM=CPUMSK;              /* BIT MASK FOR THIS CPU         */ 06800000
         MVC   PCCACAFM(2,@12),CPUMSK                              1382 06801000
*     PCCAPSAV=CPUPSA;              /* PSA ADDRESS                   */ 06802000
*                                                                  1383 06803000
         ST    @06,PCCAPSAV(,@12)                                  1383 06804000
*     /***************************************************************/ 06805000
*     /*                                                             */ 06806000
*     /* IF OLD CAT TABLE EXISTS, THEN COPY OLD CAT INTO NEW PCCA.   */ 06807000
*     /* THIS IS TO PREVENT THE WAKEUP CODE FROM HAVING TO ENABLE FOR*/ 06808000
*     /* I/O INTERRUPTIONS TO INITIALIZE THE CAT TABLE ON THE NEW    */ 06809000
*     /* CPU.                                                @YM03538*/ 06810000
*     /*                                                             */ 06811000
*     /***************************************************************/ 06812000
*                                                                  1384 06813000
*     IF PCCAT00P(HEXCPUAD+1)^=0 THEN/* OLD PCCA EXIST?      @YM03538*/ 06814000
         SLA   @15,2                                               1384 06815000
         L     @06,CVTPTR                                          1384 06816000
         L     @06,CVTPCCAT(,@06)                                  1384 06817000
         L     @06,PCCAT00P(@15,@06)                               1384 06818000
         CR    @06,@04                                             1384 06819000
         BE    @RF01384                                            1384 06820000
*       DO;                                                        1385 06821000
*                                                                  1385 06822000
*         /***********************************************************/ 06823000
*         /*                                                         */ 06824000
*         /* COPY OLD CAT TO NEW PCCA                                */ 06825000
*         /*                                                         */ 06826000
*         /***********************************************************/ 06827000
*                                                                  1386 06828000
*         PCCACAT=PCCAT00P(HEXCPUAD+1)->PCCACAT;/* COPY      @YM03538*/ 06829000
         MVC   PCCACAT(128,@12),PCCACAT(@06)                       1386 06830000
*         OLDCAT='1'B;              /* SET FOOTPRINT         @YM03538*/ 06831000
         OI    OLDCAT,B'00000100'                                  1387 06832000
*         CATPTR=ADDR(PCCACAT);     /* POINT TO NEW CAT TABLE      1388 06833000
*                                                            @YM03538*/ 06834000
*                                                                  1388 06835000
         LA    CATPTR,PCCACAT(,@12)                                1388 06836000
*         /***********************************************************/ 06837000
*         /*                                                         */ 06838000
*         /* ZERO OUT ALL OLD INFORMATION                            */ 06839000
*         /*                                                         */ 06840000
*         /***********************************************************/ 06841000
*                                                                  1389 06842000
*         DO LOOPCNT=0 TO 15;       /* LOOP THROUGH ALL CHANNELS   1389 06843000
*                                                            @YM03538*/ 06844000
         ST    @04,LOOPCNT                                         1389 06845000
@DL01389 DS    0H                                                  1390 06846000
*           CATSIOCT=0;             /* ZERO SIO COUNT        @YM03538*/ 06847000
         SLR   @12,@12                                             1390 06848000
         STH   @12,CATSIOCT(,CATPTR)                               1390 06849000
*           CATFLA=0;               /* ZERO FLAG BYTE        @YM03538*/ 06850000
         MVI   CATFLA(CATPTR),X'00'                                1391 06851000
*           CATPTR=CATPTR+LENGTH(CAT);/* INCREMENT TO NEXT CAT     1392 06852000
*                                                            @YM03538*/ 06853000
         AH    CATPTR,@CH00036                                     1392 06854000
*         END;                      /* END OF LOOP                   */ 06855000
         AL    @04,@CF00067                                        1393 06856000
         ST    @04,LOOPCNT                                         1393 06857000
         CH    @04,@CH00344                                        1393 06858000
         BNH   @DL01389                                            1393 06859000
*       END;                        /* END OF CAT TABLE COPY ROUTINE */ 06860000
*                                                                  1394 06861000
*     /***************************************************************/ 06862000
*     /*                                                             */ 06863000
*     /* OLD CAT TABLE DID NOT EXIST. MARK ALL CHANNELS OFFLINE AND  */ 06864000
*     /* CHANNEL ID INFORMATION INVALID                              */ 06865000
*     /*                                                             */ 06866000
*     /***************************************************************/ 06867000
*                                                                  1395 06868000
*     ELSE                                                         1395 06869000
*       DO;                         /*                       @Y30CQXA*/ 06870000
         B     @RC01384                                            1395 06871000
@RF01384 DS    0H                                                  1396 06872000
*         CATPTR=ADDR(PCCACAT);     /* CAT TABLE ADDRESS     @Y30CQXA*/ 06873000
         L     CATPTR,PCCAPTR                                      1396 06874000
         LA    CATPTR,PCCACAT(,CATPTR)                             1396 06875000
*         DO LOOPCNT=0 TO 15;       /* LOOP CONTROL          @Y30CQXA*/ 06876000
         SLR   @12,@12                                             1397 06877000
         ST    @12,LOOPCNT                                         1397 06878000
@DL01397 DS    0H                                                  1398 06879000
*           CATNOP='1'B;            /* OFFLINE AND INVALID   @Y30CQXA*/ 06880000
*           CATNID='1'B;            /* ID INVALID            @Y30CQXA*/ 06881000
*                                                                  1399 06882000
         OI    CATNOP(CATPTR),B'01001000'                          1399 06883000
*           /*********************************************************/ 06884000
*           /*                                                       */ 06885000
*           /* IF CHANNEL IS NOT SYSGENED THEN MARK NOT SYSGENED     */ 06886000
*           /*                                                       */ 06887000
*           /*********************************************************/ 06888000
*                                                                  1400 06889000
*           IF LOOPCNT>CSDCHAD THEN /* ABOVE SYSGENED?       @Y30CQXA*/ 06890000
         L     @11,CVTPTR                                          1400 06891000
         L     @11,CVTCSD(,@11)                                    1400 06892000
         CH    @12,CSDCHAD(,@11)                                   1400 06893000
         BNH   @RF01400                                            1400 06894000
*             CATNGEN='1'B;         /* SET NOT GENED         @Y30CQXA*/ 06895000
         OI    CATNGEN(CATPTR),B'00100000'                         1401 06896000
*           CATPTR=CATPTR+8;        /* NEXT CAT ENTRY        @Y30CQXA*/ 06897000
@RF01400 AH    CATPTR,@CH00036                                     1402 06898000
*         END;                      /*                       @Y30CQXA*/ 06899000
         LA    @12,1                                               1403 06900000
         AL    @12,LOOPCNT                                         1403 06901000
         ST    @12,LOOPCNT                                         1403 06902000
         CH    @12,@CH00344                                        1403 06903000
         BNH   @DL01397                                            1403 06904000
*       END;                        /*                       @Y30CQXA*/ 06905000
*     RFY                                                          1405 06906000
*      (R15) RSTD;                  /* RESTRICT REGISTER 15          */ 06907000
@RC01384 DS    0H                                                  1406 06908000
*     R15=CPUPSA;                   /* LOAD VIRTUAL ADDRESS OF PSA   */ 06909000
         L     R15,CPUPSA                                          1406 06910000
*     GEN(LRA  15,0(15));           /* LOAD REAL ADDRESS             */ 06911000
         LRA  15,0(15)                                                  06912000
*     PCCAPSAR=R15;                 /* STORE REAL PSA ADDRESS        */ 06913000
         L     @14,PCCAPTR                                         1408 06914000
         ST    R15,PCCAPSAR(,@14)                                  1408 06915000
*     RFY                                                          1409 06916000
*      (R15) UNRSTD;                /* RELEASR REG 15                */ 06917000
*     PSAPTR=0;                     /* ADDRESSABILITY TO MY OWN PSA  */ 06918000
         SLR   PSAPTR,PSAPTR                                       1410 06919000
*     LCCAMCR1=PSASTOR;             /* COPY MY CONTROL REG 1 TO LCCA */ 06920000
         L     @06,LCCAPTR                                         1411 06921000
         MVC   LCCAMCR1(4,@06),PSASTOR(PSAPTR)                     1411 06922000
*     LCCACPUA=HEXCPUAD+'0040'X;    /* SET LOGICAL CPU ADDRESS       */ 06923000
         SLR   @04,@04                                             1412 06924000
         ICM   @04,3,HEXCPUAD                                      1412 06925000
         LA    @15,64                                              1412 06926000
         ALR   @15,@04                                             1412 06927000
         STH   @15,LCCACPUA(,@06)                                  1412 06928000
*     LCCALCCA='LCCA';              /* CONTROL BLOCK HEADER          */ 06929000
         MVC   LCCALCCA(4,@06),@CC03812                            1413 06930000
*   END;                            /* END OF INITIALIZATION ROUTINE */ 06931000
*                                                                  1415 06932000
*   /*****************************************************************/ 06933000
*   /*                                                               */ 06934000
*   /* PSA AND CCA'S FOR NEW CPU HAVE BEEN BUILT AND INITIALIZED     */ 06935000
*   /* UPDATE VECTOR TABLE ENTRIES FOR SUBJECT CPU AND RETURN TO     */ 06936000
*   /* CALLER IF ONLY A CRH VARY. OTHERWISE ISSUE A CPU RESET TO     */ 06937000
*   /* VERIFY THAT CPU DOES EXIST                                    */ 06938000
*   /*                                                               */ 06939000
*   /*****************************************************************/ 06940000
*                                                                  1415 06941000
*   RFY                                                            1415 06942000
*    (R10,                                                         1415 06943000
*     R11) RSTD;                    /* RESTRICT REGISTERS            */ 06944000
*   R10=PCCAT00P(HEXCPUAD+1);       /* SAVE OLD VECTOR TABLE POINTER */ 06945000
         SLA   @04,2                                               1416 06946000
         L     @06,CVTPTR                                          1416 06947000
         L     @15,CVTPCCAT(,@06)                                  1416 06948000
         L     R10,PCCAT00P(@04,@15)                               1416 06949000
*   R11=LCCAT00P(HEXCPUAD+1);       /* SAVE OLD VECTOR TABLE POINTER */ 06950000
*                                                                  1417 06951000
         L     @06,CVTLCCAT(,@06)                                  1417 06952000
         L     R11,LCCAT00P(@04,@06)                               1417 06953000
*   /*****************************************************************/ 06954000
*   /*                                                               */ 06955000
*   /* REPLACE POINTERS WITH NEW CCA'S ADDRESSES                     */ 06956000
*   /*                                                               */ 06957000
*   /*****************************************************************/ 06958000
*                                                                  1418 06959000
*   PCCAT00P(HEXCPUAD+1)=OLDPCCA;   /* REPLACE POINTER WITH NEW      */ 06960000
         L     @14,OLDPCCA                                         1418 06961000
         ST    @14,PCCAT00P(@04,@15)                               1418 06962000
*   LCCAT00P(HEXCPUAD+1)=OLDLCCA;   /* REPLACE POINTER WITH NEW      */ 06963000
         L     @15,OLDLCCA                                         1419 06964000
         ST    @15,LCCAT00P(@04,@06)                               1419 06965000
*   OLDPCCA=R10;                    /* SAVE ADDRESS FOR FREEING      */ 06966000
         ST    R10,OLDPCCA                                         1420 06967000
*   OLDLCCA=R11;                    /* SAVE ADDRESS FOR FREEING      */ 06968000
*                                                                  1421 06969000
         ST    R11,OLDLCCA                                         1421 06970000
*   /*****************************************************************/ 06971000
*   /*                                                               */ 06972000
*   /* IF CRH VARY THEN ZERO LCCA POINTER AND SET UP TO FREE LCCA IN */ 06973000
*   /* CLEANUP ROUTINE                                               */ 06974000
*   /*                                                               */ 06975000
*   /*****************************************************************/ 06976000
*                                                                  1422 06977000
*   IF CRH='1'B THEN                /* CRH VARY?             @Y30CQXA*/ 06978000
         TM    CRH,B'00000010'                                     1422 06979000
         BO    @RT01422                                            1422 06980000
*     GOTO PSAEXIT;                 /*                       @Y30CQXA*/ 06981000
*                                                                  1423 06982000
*   /*****************************************************************/ 06983000
*   /*                                                               */ 06984000
*   /* VECTOR TABLES ARE NOW POINTING TO NEW CCA'S. USE IPC TO RESET */ 06985000
*   /* SUBJECT CPU AND VERIFY IF CPU EXISTS                          */ 06986000
*   /*                                                               */ 06987000
*   /*****************************************************************/ 06988000
*                                                                  1424 06989000
*   RFY                                                            1424 06990000
*    (R1,                                                          1424 06991000
*     RETCODE) RSTD;                /* RESTRICT REGS                 */ 06992000
*RETRY:                                                            1425 06993000
*   R1=PCCAT00P(HEXCPUAD+1);        /* GET PCCA ADDR FOR IPC @ZA07523*/ 06994000
*                                                                  1425 06995000
RETRY    SLR   @14,@14                                             1425 06996000
         ICM   @14,3,HEXCPUAD                                      1425 06997000
         SLA   @14,2                                               1425 06998000
         L     @06,CVTPTR                                          1425 06999000
         L     @04,CVTPCCAT(,@06)                                  1425 07000000
         L     R1,PCCAT00P(@14,@04)                                1425 07001000
*   /*****************************************************************/ 07002000
*   /*                                                               */ 07003000
*   /* CHECK IF CRH IS ACTIVE, AND IF SO ISSUE A CPU RESET INSTEAD OF*/ 07004000
*   /* A PROGRAM RESET TO PREVENT ANY CRITICAL I/O INFORMATION IN    */ 07005000
*   /* CHANNELS FROM BEING RESET THIS SHOULD ALSO BE DONE IF BACKING */ 07006000
*   /* OUT FROM OFFLINE,KEEPCHAN PROCESSING FAILURE.         @G557P2L*/ 07007000
*   /*                                                               */ 07008000
*   /*****************************************************************/ 07009000
*                                                                  1426 07010000
*   IF CVTCRCA^=0|KPCHANFL='1'B THEN/* CRH ACTIVE?           @Y30CQXA*/ 07011000
         ICM   @14,15,CVTCRCA(@06)                                 1426 07012000
         BNZ   @RT01426                                            1426 07013000
         TM    KPCHANFL,B'01000000'                                1426 07014000
         BNO   @RF01426                                            1426 07015000
@RT01426 DS    0H                                                  1427 07016000
*/*                                           OR BACKOUT CASE @ZM45610  07017000
*                                                                    */ 07018000
*                                                                  1427 07019000
*     DO;                           /* CHECK TO SEE IF CPU IN CHECK     07020000
*                                      STOP STATE            @ZA07523*/ 07021000
*       GEN(DSGNL SENSE,CPU=(1));   /* ISSUE SENSE TO CPU    @ZA07523*/ 07022000
         DSGNL SENSE,CPU=(1)                                            07023000
*       IF RETCODE=8 THEN           /* STATUS STORED ?       @ZA07523*/ 07024000
         CH    RETCODE,@CH00036                                    1429 07025000
         BNE   @RF01429                                            1429 07026000
*         DO;                       /*                       @ZA07523*/ 07027000
*           TEMPWORK=R0;            /* STORE REG 0 STATUS WORD     1431 07028000
*                                                            @ZA07523*/ 07029000
         ST    R0,TEMPWORK                                         1431 07030000
*         END;                      /* END OF CHECK STOP TEST      1432 07031000
*                                                            @ZA07523*/ 07032000
*       ELSE                                                       1433 07033000
*         IF RETCODE^=0 THEN        /* CPU RESPONSIVE ?      @ZA07523*/ 07034000
         B     @RC01429                                            1433 07035000
@RF01429 LTR   RETCODE,RETCODE                                     1433 07036000
         BNZ   @RT01433                                            1433 07037000
*           GOTO CPUERROR;          /* NO, REJECT VARY CPU   @ZA07523*/ 07038000
*       R1=PCCAT00P(HEXCPUAD+1);    /* PCCA ADDR FOR IPC     @ZA07523*/ 07039000
@RC01429 SLR   @14,@14                                             1435 07040000
         ICM   @14,3,HEXCPUAD                                      1435 07041000
         SLA   @14,2                                               1435 07042000
         L     @06,CVTPTR                                          1435 07043000
         L     @06,CVTPCCAT(,@06)                                  1435 07044000
         L     R1,PCCAT00P(@14,@06)                                1435 07045000
*       GEN(DSGNL ICPUR,CPU=(1));   /* RESET CPU AND PREFIX REGISTER    07046000
*                                                            @Y30CQXA*/ 07047000
         DSGNL ICPUR,CPU=(1)                                            07048000
*     END;                          /* END OF CRH ACTIVE PROCESS   1437 07049000
*                                                            @ZA07523*/ 07050000
*   ELSE                            /*                       @Y30CQXA*/ 07051000
*     GEN(DSGNL IPR,CPU=(1));       /* RESET CPU AND PREFIX REGISTER */ 07052000
*                                                                  1438 07053000
         B     @RC01426                                            1438 07054000
@RF01426 DS    0H                                                  1438 07055000
         DSGNL IPR,CPU=(1)                                              07056000
*   /*****************************************************************/ 07057000
*   /*                                                               */ 07058000
*   /* CHECK RETURN CODE AND VERIFY THAT CPU EXISTS                  */ 07059000
*   /*                                                               */ 07060000
*   /*****************************************************************/ 07061000
*                                                                  1439 07062000
*   IF RETCODE^=0 THEN              /* SUCCESSFUL ?                  */ 07063000
@RC01426 LTR   RETCODE,RETCODE                                     1439 07064000
         BZ    @RF01439                                            1439 07065000
*CPUERROR:                                                         1440 07066000
*     DO;                                                          1440 07067000
*                                                                  1440 07068000
CPUERROR DS    0H                                                  1441 07069000
*       /*************************************************************/ 07070000
*       /*                                                           */ 07071000
*       /* REPLACE VECTOR TABLE ENTRIES AND SET UNRESPONSIVE FLAG    */ 07072000
*       /*                                                           */ 07073000
*       /*************************************************************/ 07074000
*                                                                  1441 07075000
*       R10=OLDPCCA;                /* PICK UP PCCA ADDRESS          */ 07076000
         L     R10,OLDPCCA                                         1441 07077000
*       R11=OLDLCCA;                /* PICK UP LCCA ADDRESS          */ 07078000
         L     R11,OLDLCCA                                         1442 07079000
*       OLDPCCA=PCCAT00P(HEXCPUAD+1);/* COPY OLD PCCA ADDRESS TO FREE*/ 07080000
         SLR   @14,@14                                             1443 07081000
         ICM   @14,3,HEXCPUAD                                      1443 07082000
         SLA   @14,2                                               1443 07083000
         L     @06,CVTPTR                                          1443 07084000
         L     @04,CVTPCCAT(,@06)                                  1443 07085000
         L     @00,PCCAT00P(@14,@04)                               1443 07086000
         ST    @00,OLDPCCA                                         1443 07087000
*       OLDLCCA=LCCAT00P(HEXCPUAD+1);/* COPY NEW LCCA ADDRESS TO FREE*/ 07088000
         L     @06,CVTLCCAT(,@06)                                  1444 07089000
         L     @00,LCCAT00P(@14,@06)                               1444 07090000
         ST    @00,OLDLCCA                                         1444 07091000
*       PCCAT00P(HEXCPUAD+1)=R10;   /* REPLACE OLD PCCA ADDRESS      */ 07092000
         ST    R10,PCCAT00P(@14,@04)                               1445 07093000
*       LCCAT00P(HEXCPUAD+1)=R11;   /* REPLACE OLD LCCA ADDRESS      */ 07094000
         ST    R11,LCCAT00P(@14,@06)                               1446 07095000
*       CPUNRESP='1'B;              /* SET ERROR FLAG                */ 07096000
         OI    CPUNRESP,B'00010000'                                1447 07097000
*       GOTO PSAEXIT;               /* RETURN TO NEXT LEVEL OF     1448 07098000
*                                      CONTROL                       */ 07099000
         B     PSAEXIT                                             1448 07100000
*     END;                                                         1449 07101000
*                                                                  1449 07102000
*   /*****************************************************************/ 07103000
*   /*                                                               */ 07104000
*   /* CPU HAS RESPONDED. LOOP TILL RESET HAS COMPLETED              */ 07105000
*   /*                                                               */ 07106000
*   /*****************************************************************/ 07107000
*                                                                  1450 07108000
*RESTLP1:                                                          1450 07109000
*   R1=PCCAT00P(HEXCPUAD+1);        /* PICK UP CPU ADDRESS           */ 07110000
@RF01439 DS    0H                                                  1450 07111000
RESTLP1  SLR   @14,@14                                             1450 07112000
         ICM   @14,3,HEXCPUAD                                      1450 07113000
         SLA   @14,2                                               1450 07114000
         L     @06,CVTPTR                                          1450 07115000
         L     @06,CVTPCCAT(,@06)                                  1450 07116000
         L     R1,PCCAT00P(@14,@06)                                1450 07117000
*   GEN(DSGNL SENSE,CPU=(1));       /* ISSUE SENSE TO CPU            */ 07118000
*                                                                  1451 07119000
         DSGNL SENSE,CPU=(1)                                            07120000
*   /*****************************************************************/ 07121000
*   /*                                                               */ 07122000
*   /* IF RETURN CODE IS 4 THEN CPU IS BUSY DOING RESET. LOOP        */ 07123000
*   /*                                                               */ 07124000
*   /*****************************************************************/ 07125000
*                                                                  1452 07126000
*   IF RETCODE=4 THEN               /* BUSY?                         */ 07127000
         CH    RETCODE,@CH00076                                    1452 07128000
         BNE   @RF01452                                            1452 07129000
*     DO;                           /* YES- IEAVEDR RETRIED 1 MEG  1453 07130000
*                                      ALREADY               @ZA10795*/ 07131000
*       CPUNRESP='1'B;              /* SET UNRESPONSIVE CPU ERR FLAG    07132000
*                                                            @ZA10795*/ 07133000
         OI    CPUNRESP,B'00010000'                                1454 07134000
*       GOTO CPUERROR;              /* BRACNH CONTINUE PROCESSING  1455 07135000
*                                                            @ZA10795*/ 07136000
         B     CPUERROR                                            1455 07137000
*     END;                          /* END OF RETURN CODE BUSY     1456 07138000
*                                      PROCESSING            @ZA10795*/ 07139000
*   IF RETCODE=8 THEN               /* ERROR DURRING SENSE?          */ 07140000
@RF01452 CH    RETCODE,@CH00036                                    1457 07141000
         BNE   @RF01457                                            1457 07142000
*     DO;                           /* CPU HAS STORED STATUS. CHECK     07143000
*                                      STATUS                        */ 07144000
*       RFY                                                        1459 07145000
*        (R0) RSTD;                 /* RESTRICT REG                  */ 07146000
*       TEMPWORK=R0;                /* STORE STATUS RETURNED         */ 07147000
*                                                                  1460 07148000
         ST    R0,TEMPWORK                                         1460 07149000
*       /*************************************************************/ 07150000
*       /*                                                           */ 07151000
*       /* CHECK STATUS TO INSURE NO ERROR HAS OCCURED               */ 07152000
*       /*                                                           */ 07153000
*       /*************************************************************/ 07154000
*                                                                  1461 07155000
*       RFY                                                        1461 07156000
*        (R0) UNRSTD;               /* RELEASE REG                   */ 07157000
*       IF CKSTOP='1'B|OPINT='1'B|RECCK='1'B|NTRDY='1'B THEN       1462 07158000
         TM    CKSTOP,B'00111001'                                  1462 07159000
         BZ    @RF01462                                            1462 07160000
*         DO;                                                      1463 07161000
*                                                                  1463 07162000
*           /*********************************************************/ 07163000
*           /*                                                       */ 07164000
*           /* ERROR HAS OCCURED DURING RESET                        */ 07165000
*           /*                                                       */ 07166000
*           /*********************************************************/ 07167000
*                                                                  1464 07168000
*           CPUNRESP='1'B;          /* SET ERROR FLAG                */ 07169000
         OI    CPUNRESP,B'00010000'                                1464 07170000
*           GOTO CPUERROR;          /* EXIT                          */ 07171000
         B     CPUERROR                                            1465 07172000
*         END;                                                     1466 07173000
*     END;                          /* END OF RESET WAIT LOOP        */ 07174000
@RF01462 DS    0H                                                  1468 07175000
*   RFY                                                            1468 07176000
*    (R1,                                                          1468 07177000
*     R10,                                                         1468 07178000
*     R11,                                                         1468 07179000
*     RETCODE) UNRSTD;              /* RELEASE REGISTERS             */ 07180000
*                                                                  1468 07181000
@RF01457 DS    0H                                                  1469 07182000
*   /*****************************************************************/ 07183000
*   /*                                                               */ 07184000
*   /* CPU HAS RESPONDED TO RESET. CONTINUE INITIALIZATION OBTAIN AND*/ 07185000
*   /* SETUP CPU RELATED SAVE AREAS                                  */ 07186000
*   /*                                                               */ 07187000
*   /*****************************************************************/ 07188000
*                                                                  1469 07189000
*   CALL SAVARSUB;                  /* GET CPU RELATED SAVE AREAS    */ 07190000
*                                                                  1469 07191000
         BAL   @14,SAVARSUB                                        1469 07192000
*   /*****************************************************************/ 07193000
*   /*                                                               */ 07194000
*   /* CHECK FOR ANY ERROR FROM ROUTINE                              */ 07195000
*   /*                                                               */ 07196000
*   /*****************************************************************/ 07197000
*                                                                  1470 07198000
*   IF ERRORIND^=0 THEN             /* ANY ERRORS ?                  */ 07199000
         ICM   @06,15,ERRORIND                                     1470 07200000
         BNZ   @RT01470                                            1470 07201000
*     GOTO PSAEXIT;                 /* RETURN TO CALLER              */ 07202000
*PSAEXIT:                                                          1472 07203000
*   END;                                                           1472 07204000
@EL00012 DS    0H                                                  1472 07205000
@EF00012 DS    0H                                                  1472 07206000
@ER00012 LM    @14,@11,@SA00012                                    1472 07207000
         BR    @14                                                 1472 07208000
*GETCORE:                                                          1473 07209000
*   PROC;                                                          1473 07210000
*                                                                  1473 07211000
GETCORE  STM   @14,@12,@SA00013                                    1473 07212000
*/********* GETCORE ************************************************ */ 07213000
*/* GETCORE ROUTINE WILL GET AND CHAIN STORAGE REQUESTED BY CALLER   */ 07214000
*/* INPUT TO ROUTINE IS LENGTH AND SUBPOOL SPECIFIED IN WORKAREA     */ 07215000
*/* STORAGE BLOCKS WILL BE CHAINED TOGETHER AND ANCHORED OUT OF      */ 07216000
*/* WORKAREA FIELD BEGINPTR. SUBPOOL AND LENGTH IS RECORDED IN       */ 07217000
*/* CHAIN BLOCKS FOR FREEING LATER.                                  */ 07218000
*/* POSSIBLE ERROR INDICATORS ARE: NOCORE                            */ 07219000
*/****************************************************************** */ 07220000
*                                                                  1474 07221000
*   IF NOCHAIN='0'B THEN            /* CHECK FOR NOCHAIN INDICATOR   */ 07222000
*                                                                  1474 07223000
         TM    NOCHAIN,B'10000000'                                 1474 07224000
         BNZ   @RF01474                                            1474 07225000
*     /***************************************************************/ 07226000
*     /*                                                             */ 07227000
*     /* IF CALLER HAS REQUESTED TO CHAIN THIS BLOCK WITH ALL OTHER  */ 07228000
*     /* GETMAINS THEN ADD EIGHT TO REQUESTED LENGTH FOR CHAINING    */ 07229000
*     /* BLOCKS                                                      */ 07230000
*     /*                                                             */ 07231000
*     /***************************************************************/ 07232000
*                                                                  1475 07233000
*     GETLENG=EVAL(GETLENG+8);      /* ADD EIGHT TO LENGTH           */ 07234000
         LA    @12,8                                               1475 07235000
         SLR   @06,@06                                             1475 07236000
         ICM   @06,3,GETLENG                                       1475 07237000
         ALR   @12,@06                                             1475 07238000
         STH   @12,GETLENG                                         1475 07239000
*   RFY                                                            1476 07240000
*    (RETCODE) RSTD;                /* RESTRICT RETURN CODE REG      */ 07241000
*                                                                  1476 07242000
@RF01474 DS    0H                                                  1477 07243000
*   /*****************************************************************/ 07244000
*   /*                                                               */ 07245000
*   /* ISSUE CONDITIONAL GETMAIN FOR STORAGE REQUESTED               */ 07246000
*   /*                                                               */ 07247000
*   /*****************************************************************/ 07248000
*                                                                  1477 07249000
*   DO;                             /* GETMAIN (EC) LV(GETLENG)    1477 07250000
*                                      A(COREPTR) SP(SUBPOOL)      1477 07251000
*                                      RTCD(RETCODE)                 */ 07252000
*     RESPECIFY                                                    1478 07253000
*      (GPR01P,                                                    1478 07254000
*       GPR15F) RESTRICTED;                                        1478 07255000
*     I004=I004&&I004;              /* INIT LIST                     */ 07256000
         XC    I004(10),I004                                       1479 07257000
*     I00404='20'X;                 /* TYPE                          */ 07258000
         MVI   I00404,X'20'                                        1480 07259000
*     I00401=GETLENG;               /* LENGTH                        */ 07260000
         SLR   @14,@14                                             1481 07261000
         ICM   @14,3,GETLENG                                       1481 07262000
         ST    @14,I00401                                          1481 07263000
*     I00403=ADDR(COREPTR);         /* ADDR OF ADDR LIST             */ 07264000
         LA    @14,COREPTR                                         1482 07265000
         STCM  @14,7,I00403                                        1482 07266000
*     I00405=SUBPOOL;               /* SUBPOOL VALUE                 */ 07267000
         MVC   I00405(1),SUBPOOL                                   1483 07268000
*     GPR01P=ADDR(I004);            /* REG1 POINTS TO LIST           */ 07269000
         LA    GPR01P,I004                                         1484 07270000
*     SVC(4);                       /* STANDARD-FORM OF GETMAIN      */ 07271000
         SVC   4                                                   1485 07272000
*     RETCODE=GPR15F;               /* SET RETURN CODE               */ 07273000
*     RESPECIFY                                                    1487 07274000
*      (GPR01P,                                                    1487 07275000
*       GPR15F) UNRESTRICTED;                                      1487 07276000
*   END;                            /* GETMAIN (EC) LV(GETLENG)    1488 07277000
*                                      A(COREPTR) SP(SUBPOOL)      1488 07278000
*                                      RTCD(RETCODE)                 */ 07279000
*                                                                  1488 07280000
*   /*****************************************************************/ 07281000
*   /*                                                               */ 07282000
*   /* CHECK RETURN CODE AND SET NOCORE ERROR FLAG IF ERROR          */ 07283000
*   /*                                                               */ 07284000
*   /*****************************************************************/ 07285000
*                                                                  1489 07286000
*   IF RETCODE^=0 THEN              /* WAS GETMAIN SUCCESSFUL        */ 07287000
         LTR   RETCODE,RETCODE                                     1489 07288000
         BZ    @RF01489                                            1489 07289000
*     DO;                                                          1490 07290000
*       NOCORE='1'B;                /* SET ERROR FLAG                */ 07291000
         OI    NOCORE,B'00000001'                                  1491 07292000
*       GOTO GETCOREX;              /* RETURN TO CALLER              */ 07293000
         B     GETCOREX                                            1492 07294000
*     END;                                                         1493 07295000
*   RFY                                                            1494 07296000
*    (RETCODE) UNRSTD;                                             1494 07297000
*                                                                  1494 07298000
@RF01489 DS    0H                                                  1495 07299000
*   /*****************************************************************/ 07300000
*   /*                                                               */ 07301000
*   /* ZERO OUT STORAGE OBTAINED                                     */ 07302000
*   /*                                                               */ 07303000
*   /*****************************************************************/ 07304000
*                                                                  1495 07305000
*   RFY                                                            1495 07306000
*    (R10,                                                         1495 07307000
*     R11,                                                         1495 07308000
*     R14,                                                         1495 07309000
*     R15) RSTD;                    /* RESTRICT REGISTERS            */ 07310000
*   R10=COREPTR;                    /* LOAD ADDRESS OF STORAGE     1496 07311000
*                                      OBTAINED                      */ 07312000
         L     R10,COREPTR                                         1496 07313000
*   R11=GETLENG;                    /* LOAD LENGTH OF STORAGE      1497 07314000
*                                      OBTAINED                      */ 07315000
         SLR   R11,R11                                             1497 07316000
         ICM   R11,3,GETLENG                                       1497 07317000
*   R14=0;                          /* ZERO PAD CHARACTER            */ 07318000
         SLR   R14,R14                                             1498 07319000
*   R15=0;                          /* ZERO LENGTH                   */ 07320000
         SLR   R15,R15                                             1499 07321000
*   GEN(MVCL R10,R14);              /* ZERO STORAGE JUST OBTAINED    */ 07322000
         MVCL R10,R14                                                   07323000
*   RFY                                                            1501 07324000
*    (R10,                                                         1501 07325000
*     R11,                                                         1501 07326000
*     R14,                                                         1501 07327000
*     R15) UNRSTD;                  /* RELEASE REGISTERS FOR USE     */ 07328000
*                                                                  1501 07329000
*   /*****************************************************************/ 07330000
*   /*                                                               */ 07331000
*   /* IF CHAINING WAS NOT REQUESTED THEN RETURN TO CALLER           */ 07332000
*   /*                                                               */ 07333000
*   /*****************************************************************/ 07334000
*                                                                  1502 07335000
*   IF NOCHAIN='1'B THEN            /* CHAINNING REQUESTED?          */ 07336000
         TM    NOCHAIN,B'10000000'                                 1502 07337000
         BO    @RT01502                                            1502 07338000
*     GOTO GETCOREX;                /* RETURN TO CALLER              */ 07339000
*                                                                  1503 07340000
*   /*****************************************************************/ 07341000
*   /*                                                               */ 07342000
*   /* CHAIN THIS BLOCK TO OTHER BLOCKS IN CHAIN AND UPDATE ANCHOR   */ 07343000
*   /* PTR TO POINT TO THIS BLOCK                                    */ 07344000
*   /*                                                               */ 07345000
*   /*****************************************************************/ 07346000
*                                                                  1504 07347000
*   IF BEGINPTR=0 THEN              /* FIRST ENTRY                   */ 07348000
         SLR   @12,@12                                             1504 07349000
         C     @12,BEGINPTR                                        1504 07350000
         BNE   @RF01504                                            1504 07351000
*     FRWRDPTR=0;                   /* ZERO OUT FOR LAST ENTRY       */ 07352000
*                                                                  1505 07353000
         L     @06,COREPTR                                         1505 07354000
         ST    @12,FRWRDPTR(,@06)                                  1505 07355000
*   /*****************************************************************/ 07356000
*   /*                                                               */ 07357000
*   /* WAS NOT FIRST ELEMENT ON CHAIN.. CHAIN BLOCKS TOGETHER        */ 07358000
*   /*                                                               */ 07359000
*   /*****************************************************************/ 07360000
*                                                                  1506 07361000
*   ELSE                                                           1506 07362000
*     FRWRDPTR=BEGINPTR;            /* POINT TO NEXT BLOCK           */ 07363000
         B     @RC01504                                            1506 07364000
@RF01504 L     @12,COREPTR                                         1506 07365000
         MVC   FRWRDPTR(4,@12),BEGINPTR                            1506 07366000
*   BEGINPTR=COREPTR;               /* ANCHOR THIS BLOCK             */ 07367000
*                                                                  1507 07368000
@RC01504 L     @12,COREPTR                                         1507 07369000
         ST    @12,BEGINPTR                                        1507 07370000
*   /*****************************************************************/ 07371000
*   /*                                                               */ 07372000
*   /* SAVE NECESSARY INFORMATION IN CHAIN BLOCKS FOR FREEMAIN       */ 07373000
*   /*                                                               */ 07374000
*   /*****************************************************************/ 07375000
*                                                                  1508 07376000
*   LNGTH=GETLENG;                  /* SAVE LENGTH OF REQUEST        */ 07377000
         MVC   LNGTH(2,@12),GETLENG                                1508 07378000
*   SPNUM=SUBPOOL;                  /* SAVE SUBPOOL NUMBER           */ 07379000
*                                                                  1509 07380000
         SLR   @06,@06                                             1509 07381000
         IC    @06,SUBPOOL                                         1509 07382000
         STH   @06,SPNUM(,@12)                                     1509 07383000
*   /*****************************************************************/ 07384000
*   /*                                                               */ 07385000
*   /* UPDATE COREPTR TO STORAGE FOR CALLER                          */ 07386000
*   /*                                                               */ 07387000
*   /*****************************************************************/ 07388000
*                                                                  1510 07389000
*   COREPTR=COREPTR+8;                                             1510 07390000
         AH    @12,@CH00036                                        1510 07391000
         ST    @12,COREPTR                                         1510 07392000
*GETCOREX:                                                         1511 07393000
*   NOCHAIN='0'B;                   /* RESET NOCHAIN FLAG            */ 07394000
GETCOREX NI    NOCHAIN,B'01111111'                                 1511 07395000
*   END;                            /* *** END OF GETCORE ROUTINE    */ 07396000
@EL00013 DS    0H                                                  1512 07397000
@EF00013 DS    0H                                                  1512 07398000
@ER00013 LM    @14,@12,@SA00013                                    1512 07399000
         BR    @14                                                 1512 07400000
*                                                                  1513 07401000
*/****** FREECORE ****************************************************/ 07402000
*/* FREECORE ROUTINE WILL FREE STORAGE POINTED TO BY COREPTR. INPUT  */ 07403000
*/* IS SUBPOOL AND GETLENG FIELDS IN WORKAREA. THESE FIELDS          */ 07404000
*/* ARE SHARED WITH GETCORE ROUTINE. NO ERROR INDICATORS WILL BE SET */ 07405000
*/* BY FREECORE ROUTINE.                                             */ 07406000
*/********************************************************************/ 07407000
*                                                                  1513 07408000
*FREECORE:                                                         1513 07409000
*   PROC;                                                          1513 07410000
*                                                                  1513 07411000
FREECORE STM   @14,@12,12(@13)                                     1513 07412000
*   /*****************************************************************/ 07413000
*   /*                                                               */ 07414000
*   /* ISSUE CONDITIONAL FREEMAIN                                    */ 07415000
*   /*                                                               */ 07416000
*   /*****************************************************************/ 07417000
*                                                                  1514 07418000
*   DO;                             /* FREEMAIN (E) LV(GETLENG)    1514 07419000
*                                      A(COREPTR) SP(SUBPOOL)        */ 07420000
*     RESPECIFY                                                    1515 07421000
*      (GPR01P) RESTRICTED;                                        1515 07422000
*     I005=I005&&I005;              /* INIT LIST                     */ 07423000
         XC    I005(10),I005                                       1516 07424000
*     I00505='00'X;                 /* SET TYPE                      */ 07425000
         MVI   I00505,X'00'                                        1517 07426000
*     I00502=GETLENG;               /* LENGTH                        */ 07427000
         SLR   @12,@12                                             1518 07428000
         ICM   @12,3,GETLENG                                       1518 07429000
         STCM  @12,7,I00502                                        1518 07430000
*     I00504=ADDR(COREPTR);         /* ADDR OF ADDR LIST             */ 07431000
         LA    @12,COREPTR                                         1519 07432000
         STCM  @12,7,I00504                                        1519 07433000
*     I00506=SUBPOOL;               /* SUBPOOL VALUE                 */ 07434000
         MVC   I00506(1),SUBPOOL                                   1520 07435000
*     GPR01P=ADDR(I005);            /* REG1 POINTS TO LIST           */ 07436000
         LA    GPR01P,I005                                         1521 07437000
*     SVC(5);                       /* STANDARD-FORM OF GETMAIN      */ 07438000
         SVC   5                                                   1522 07439000
*     RESPECIFY                                                    1523 07440000
*      (GPR01P) UNRESTRICTED;                                      1523 07441000
*   END;                            /* FREEMAIN (E) LV(GETLENG)    1524 07442000
*                                      A(COREPTR) SP(SUBPOOL)        */ 07443000
*   END;                            /* END OF FREEMAIN ROUTINE       */ 07444000
@EL00014 DS    0H                                                  1525 07445000
@EF00014 DS    0H                                                  1525 07446000
@ER00014 LM    @14,@12,12(@13)                                     1525 07447000
         BR    @14                                                 1525 07448000
*SAVARSUB:                                                         1526 07449000
*   PROC;                                                          1526 07450000
*                                                                  1526 07451000
SAVARSUB STM   @14,@12,@SA00015                                    1526 07452000
*/********* SAVARSUB *********************************************** */ 07453000
*/* SAVARSUB ROUTINE WILL OBTAIN OR FREE CPU RELATED SAVE AREAS FOR  */ 07454000
*/* A CPU TO BE BROUGHT ONLINE OR TAKEN OFFLINE. ROUTINE WILL FREE   */ 07455000
*/* STORAGE IF ADDRESS IS PASSED IN REGISTER ONE, OR WILL OBTAIN     */ 07456000
*/* STORAGE IF REGISTER ONE IS ZERO. ROUTINE IS INCLUDED FROM MACRO  */ 07457000
*/* LIBRARY POSSIBLE ERROR INDICATORS ARE: CPFAILED                  */ 07458000
*/****************************************************************** */ 07459000
*                                                                  1527 07460000
*   DO;                                                            1527 07461000
*                                                                  1527 07462000
*     /***************************************************************/ 07463000
*     /*                                                             */ 07464000
*     /* LOAD PARAMETER TO BE PASSED. NOTE. LCCAPTR MUST BE POINTING */ 07465000
*     /* TO LCCA OF SUBJECT CPU                                      */ 07466000
*     /*                                                             */ 07467000
*     /***************************************************************/ 07468000
*                                                                  1528 07469000
*     RFY                                                          1528 07470000
*      (R1,                                                        1528 07471000
*       RETCODE) RSTD;              /* RESTRICT REGISTER ONE         */ 07472000
*     R1=LCCACPUS;                  /* CPU RELATED SAVE AREA         */ 07473000
*                                                                  1529 07474000
         L     @14,LCCAPTR                                         1529 07475000
         L     R1,LCCACPUS(,@14)                                   1529 07476000
*     /***************************************************************/ 07477000
*     /*                                                             */ 07478000
*     /* LINK TO ROUTINE TO GET OR FREE SAVEAREA                     */ 07479000
*     /*                                                             */ 07480000
*     /***************************************************************/ 07481000
*                                                                  1530 07482000
*     CALL IEAVSPSA;                /* LINK TO ROUTINE               */ 07483000
*                                                                  1530 07484000
         BAL   @14,IEAVSPSA                                        1530 07485000
*     /***************************************************************/ 07486000
*     /*                                                             */ 07487000
*     /* CHECK IF ANY ERROR WAS ENCOUNTERED                          */ 07488000
*     /*                                                             */ 07489000
*     /***************************************************************/ 07490000
*                                                                  1531 07491000
*     IF RETCODE^=0 THEN            /* ANY ERROR ?                   */ 07492000
         LTR   RETCODE,RETCODE                                     1531 07493000
         BZ    @RF01531                                            1531 07494000
*       CPFAILED='1'B;              /* SET CPFAILED ERROR FLAG       */ 07495000
         OI    CPFAILED,B'00000100'                                1532 07496000
*     ELSE                                                         1533 07497000
*                                                                  1533 07498000
*       /*************************************************************/ 07499000
*       /*                                                           */ 07500000
*       /* REPLACE LCCA POINTER WITH ADDRESS OF STORAGE IF A GETMAIN */ 07501000
*       /* ZERO ENTRY IF A FREEMAIN                                  */ 07502000
*       /*                                                           */ 07503000
*       /*************************************************************/ 07504000
*                                                                  1533 07505000
*       LCCACPUS=R1;                /* SAVE RESULT                   */ 07506000
         B     @RC01531                                            1533 07507000
@RF01531 L     @14,LCCAPTR                                         1533 07508000
         ST    R1,LCCACPUS(,@14)                                   1533 07509000
*     RFY                                                          1534 07510000
*      (R1,                                                        1534 07511000
*       RETCODE) UNRSTD;            /* RELEASE REGISTER              */ 07512000
@RC01531 DS    0H                                                  1535 07513000
*   END;                                                           1535 07514000
*   END;                            /* ** END OF SAVARSUB ROUTINE    */ 07515000
@EL00015 DS    0H                                                  1536 07516000
@EF00015 DS    0H                                                  1536 07517000
@ER00015 LM    @14,@12,@SA00015                                    1536 07518000
         BR    @14                                                 1536 07519000
*AINIT:                                                            1537 07520000
*   PROC;                           /*                       @Y30LPXA*/ 07521000
AINIT    STM   @14,@12,@SA00016                                    1537 07522000
*/***** AINIT ********************************************************/ 07523000
*/* THE AINIT ROUTINE WILL VERIFY THAT MSS IS INCLUDED IN THE SYSTEM */ 07524000
*/* AND IF SO WILL NOTIFY THE DEVICE THAT A NEW CPU IS BEING BROUGHT */ 07525000
*/* INTO THE SYSTEM AND WILL BE OPERATING IN MP MODE. A INITIALIZE   */ 07526000
*/* WILL BE ISSUED TO ACTIVATE THE INTERFACE FOR THE NEW PROCESSOR.  */ 07527000
*/* ONLY THE ACTIVE PROCESSORS ID WILL BE PRESENTED TO THE DEVICE THE*/ 07528000
*/* NEW PROCESSORS ID WILL BE FOUND FROM THE DEVICES TABLES. IF THE  */ 07529000
*/* NEW PROCESSOR IS UNDEFINED TO THE DEVICE A ERROR MESSAGE WILL BE */ 07530000
*/* ISSUED INFORMING THE OPERATOR OF THE ERROR CONDITION. NORMAL     */ 07531000
*/* PROCESSING WILL CONTINUE.                                        */ 07532000
*/********************************************************   @Y30LPXA*/ 07533000
*                                                                  1538 07534000
*   /*****************************************************************/ 07535000
*   /*                                                               */ 07536000
*   /* DETERMINE IF MSS IS ACTIVE AND IF SVC 126 NEEDED      @G24LP2L*/ 07537000
*   /* ACTIVE                                                        */ 07538000
*   /*                                                               */ 07539000
*   /*****************************************************************/ 07540000
*                                                                  1538 07541000
*   IF(CVTICB^=0&ICBI='1'B)         /* MSS SYSGENED AND ACTIVE     1538 07542000
*                                                            @G24LP2L*/ 07543000
*       &ICBMSCA='0'B THEN          /* AND THE MSC IS NOT ASYMMETRIC    07544000
*                                                            @G24LP2L*/ 07545000
*                                                                  1538 07546000
         L     @12,CVTPTR                                          1538 07547000
         L     @12,CVTEXT2(,@12)                                   1538 07548000
         L     @12,CVTICB(,@12)                                    1538 07549000
         LTR   @12,@12                                             1538 07550000
         BZ    @RF01538                                            1538 07551000
         TM    ICBI(@12),B'10000000'                               1538 07552000
         BNO   @RF01538                                            1538 07553000
         TM    ICBMSCA(@12),B'00000010'                            1538 07554000
         BNZ   @RF01538                                            1538 07555000
*     /***************************************************************/ 07556000
*     /*                                                             */ 07557000
*     /* IF NON ZERO THEN MSS IS ACTIVE. ISSUE INITIALIZE AND        */ 07558000
*     /* ASSOCIATE                                                   */ 07559000
*     /*                                                             */ 07560000
*     /***************************************************************/ 07561000
*                                                                  1539 07562000
*     DO;                           /*                       @Y30LPXA*/ 07563000
*                                                                  1539 07564000
*       /*************************************************************/ 07565000
*       /*                                                           */ 07566000
*       /* SET UP HOST ID AND FLAGS FOR ASSOCIATE AND INIT.          */ 07567000
*       /*                                                           */ 07568000
*       /*************************************************************/ 07569000
*                                                                  1540 07570000
*       R15=ADDR(HOST);             /* POINT TO WORK AREA    @Y30LPXA*/ 07571000
         LA    R15,HOST                                            1540 07572000
*       GEN(STIDP 0(R15));          /* STORE PROCESSOR ID    @Y30LPXA*/ 07573000
*                                                                  1541 07574000
         STIDP 0(R15)                                                   07575000
*       /*************************************************************/ 07576000
*       /*                                                           */ 07577000
*       /* FLAGS SPECIFY THAT BOTH INTERFACES OF THIS MP PAIR ARE TO */ 07578000
*       /* BE INITIALIZED                                            */ 07579000
*       /*                                                           */ 07580000
*       /*************************************************************/ 07581000
*                                                                  1542 07582000
*       AFLAG='4000'X;              /* INITIALIZE FLAGS FOR MSS    1542 07583000
*                                                            @ZM30463*/ 07584000
         LH    AFLAG,@CH03846                                      1542 07585000
*/* ******************************************************* @Y30LB02 */ 07586000
*/* MACMEAN  PURGE/ASSIGN/INITIALIZE/READY    MACRO         @Y30LB02 */ 07587000
*/* VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00                 @Y30LB02 */ 07588000
*/* THIS IS THE OUTPUT FOR THE EXECUTE FORM.                @Y30LB02 */ 07589000
*/* THE LIST FORM OF THIS MACRO SHOULD BE                   @Y30LB02 */ 07590000
*/* INVOKED FIRST IN ORDER TO SET UP NECESSARY              @Y30LB02 */ 07591000
*/* DECLARES.  IF THE COMPLETE ARGUMENT IS                  @Y30LB02 */ 07592000
*/* SPECIFIED THE REQ BLOCK WILL BE ZEROED.                 @Y30LB02 */ 07593000
*/* ******************************************************* @Y30LB02 */ 07594000
*                                                                  1543 07595000
*       RFY                                                        1543 07596000
*        (PAIRR1) RSTD;             /* RESTRICT R1           @Y30LB02*/ 07597000
*       PAIRR1=ADDR(PURINIT);       /* SET PAIRR1 TO REQ BLOCK     1544 07598000
*                                                            @Y30LB02*/ 07599000
         LA    PAIRR1,PURINIT                                      1544 07600000
*       AIRLL='08'X;                /* SET LENGTH FIELD      @Y30LB02*/ 07601000
         LA    @12,8                                               1545 07602000
         ST    @12,AIRLL                                           1545 07603000
*       AIROP='10'X;                /* INITL OPCODE          @Y30LB02*/ 07604000
         MVI   AIROP,X'10'                                         1546 07605000
*       AIRFLAG=(AFLAG);            /* FILL IN FLAGS FIELD   @Y30LB02*/ 07606000
         STH   AFLAG,AIRFLAG                                       1547 07607000
*       SVC(126);                   /* ISSUE SVC INST.       @Y30LB02*/ 07608000
         SVC   126                                                 1548 07609000
*       RFY                                                        1549 07610000
*        (PAIRR1) UNRSTD;           /* UNRESTRICT R1         @Y30LB02   07611000
*                                      INITIALIZE DEVICE     @Y30LPXA*/ 07612000
*                                                                  1549 07613000
*       /*************************************************************/ 07614000
*       /*                                                           */ 07615000
*       /* INTERFACE HAS BEEN INITIALIZED, ISSUE ASSOCIATE FLAGS     */ 07616000
*       /* SPECIFY THAT BOTH PROCESSORS OF THIS MP PAIR ARE TO BE    */ 07617000
*       /* ASSOCIATED. ANY VOLUMES MOUNTED FOR THE ORGINATING CPU    */ 07618000
*       /* WILL BE MOUNTED FOR THE NEW CPU, ANY VOLUMES MOUNTED FOR  */ 07619000
*       /* NEW CPU, AND NOT MOUNTED FOR ORGINATING CPU WILL BE       */ 07620000
*       /* DEMOUNTED                                                 */ 07621000
*       /*                                                           */ 07622000
*       /*************************************************************/ 07623000
*                                                                  1550 07624000
*       AFLAG='8000'X;              /* SET UP FLAGS FOR ASSOCIATE  1550 07625000
*                                                            @Y30LPXA*/ 07626000
         L     AFLAG,@CF03850                                      1550 07627000
*/*  ******************************************************* @Y30LB02*/ 07628000
*/*       MACMEAN  MSSC ASSOCIATE MACRO                      @Y30LB02*/ 07629000
*/*  VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00                 @Y30LB02*/ 07630000
*/*  THIS IS THE OUTPUT FOR THE EXECUTE FORM.                @Y30LB02*/ 07631000
*/*  THE LIST FORM OF THIS MACRO SHOULD BE                   @Y30LB02*/ 07632000
*/*  INVOKED FIRST IN ORDER TO SET UP NECESSARY              @Y30LB02*/ 07633000
*/*  DECLARES.  IF THE COMPLETE ARGUMENT IS                  @Y30LB02*/ 07634000
*/*  SPECIFIED THE REQ BLOCK WILL BE ZEROED.                 @Y30LB02*/ 07635000
*/*  ******************************************************* @Y30LB02*/ 07636000
*                                                                  1551 07637000
*       RFY                                                        1551 07638000
*        (ASDAR1) RSTD;             /* RESTRICT REG 1        @Y30LB02*/ 07639000
*       ASDAR1=ADDR(DISCPU);        /* R1 POINTER TO REQUEST BLOCK 1552 07640000
*                                                            @Y30LB02*/ 07641000
         LA    ASDAR1,DISCPU                                       1552 07642000
*       ASDALEN='10'X;              /* LENGTH OF ASSOC REQUEST     1553 07643000
*                                                            @Y30LB02*/ 07644000
         LA    @12,16                                              1553 07645000
         ST    @12,ASDALEN                                         1553 07646000
*       ASDAOPC='2C'X;              /* ASSOCIATE OPCODE      @Y30LB02*/ 07647000
         MVI   ASDAOPC,X'2C'                                       1554 07648000
*       ASDAFLG=(AFLAG);            /* VALUE OF FLAGS PARAMETER    1555 07649000
*                                                            @Y30LB02*/ 07650000
         STH   AFLAG,ASDAFLG                                       1555 07651000
*       ASDACPU=(HOSTID);           /* HOSTID                @Y30LB02*/ 07652000
         MVC   ASDACPU(5),HOSTID                                   1556 07653000
*       SVC(126);                   /* INVOKE THE SVC        @Y30LB02*/ 07654000
         SVC   126                                                 1557 07655000
*       RFY                                                        1558 07656000
*         ASDAR1 UNRSTD;            /* UNRESTRICT REG 1      @Y30LB02   07657000
*                                                            @Y30LPXA*/ 07658000
*                                                                  1558 07659000
*       /*************************************************************/ 07660000
*       /*                                                           */ 07661000
*       /* CHECK FOR SUCESSFUL RETURN CODE, ELSE ISSUE MESSAGE       */ 07662000
*       /* INFORMING OPERATOR OF PROBLEM                             */ 07663000
*       /*                                                           */ 07664000
*       /*************************************************************/ 07665000
*                                                                  1559 07666000
*       IF RETCODE^=0 THEN          /* SUCESSFUL?            @Y30LPXA*/ 07667000
         LTR   RETCODE,RETCODE                                     1559 07668000
         BZ    @RF01559                                            1559 07669000
*         DO;                                                      1560 07670000
*           ERCODE=R0;              /* SAVE REASON CODE      @Y30LPXA*/ 07671000
         ST    R0,ERCODE                                           1561 07672000
*           SS1FAIL='1'B;           /* SET ERROR FLAG        @Y30LPXA*/ 07673000
         OI    SS1FAIL,B'00010000'                                 1562 07674000
*         END;                                                     1563 07675000
*       ELSE                                                       1564 07676000
*         DO;                                                      1564 07677000
*                                                                  1564 07678000
         B     @RC01559                                            1564 07679000
@RF01559 DS    0H                                                  1565 07680000
*           /*********************************************************/ 07681000
*           /*                                                       */ 07682000
*           /* ASSOCIATE WAS SUCESSFUL, INFORM MSS THAT NEW CPU IS   */ 07683000
*           /* READY TO ACCEPT MESSAGES FLAGS SPECIFY THAT BOTH      */ 07684000
*           /* INTERFACES OF THIS MP PAIR ARE READY TO ACCEPT        */ 07685000
*           /* MESSAGES FROM MSS                                     */ 07686000
*           /*                                                       */ 07687000
*           /*********************************************************/ 07688000
*                                                                  1565 07689000
*           AFLAG='0000'X;          /* SET FLAG BITS         @Y30LPXA*/ 07690000
         SLR   AFLAG,AFLAG                                         1565 07691000
*/* ******************************************************* @Y30LB02 */ 07692000
*/* MACMEAN  PURGE/ASSIGN/INITIALIZE/READY    MACRO         @Y30LB02 */ 07693000
*/* VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00                 @Y30LB02 */ 07694000
*/* THIS IS THE OUTPUT FOR THE EXECUTE FORM.                @Y30LB02 */ 07695000
*/* THE LIST FORM OF THIS MACRO SHOULD BE                   @Y30LB02 */ 07696000
*/* INVOKED FIRST IN ORDER TO SET UP NECESSARY              @Y30LB02 */ 07697000
*/* DECLARES.  IF THE COMPLETE ARGUMENT IS                  @Y30LB02 */ 07698000
*/* SPECIFIED THE REQ BLOCK WILL BE ZEROED.                 @Y30LB02 */ 07699000
*/* ******************************************************* @Y30LB02 */ 07700000
*                                                                  1566 07701000
*           RFY                                                    1566 07702000
*            (PAIRR1) RSTD;         /* RESTRICT R1           @Y30LB02*/ 07703000
*           PAIRR1=ADDR(PURINIT);   /* SET PAIRR1 TO REQ BLOCK     1567 07704000
*                                                            @Y30LB02*/ 07705000
         LA    PAIRR1,PURINIT                                      1567 07706000
*           AIRLL='08'X;            /* SET LENGTH FIELD      @Y30LB02*/ 07707000
         LA    @12,8                                               1568 07708000
         ST    @12,AIRLL                                           1568 07709000
*           AIROP='20'X;            /* RDY OPCODE            @Y30LB02*/ 07710000
         MVI   AIROP,X'20'                                         1569 07711000
*           SVC(126);               /* ISSUE SVC INST.       @Y30LB02*/ 07712000
         SVC   126                                                 1570 07713000
*           RFY                                                    1571 07714000
*            (PAIRR1) UNRSTD;       /* UNRESTRICT R1         @Y30LB02*/ 07715000
*           IF RETCODE^=0 THEN      /* SUCESSFUL?            @Y30LPXA*/ 07716000
         LTR   RETCODE,RETCODE                                     1572 07717000
         BZ    @RF01572                                            1572 07718000
*             DO;                   /*                       @Y30LPXA*/ 07719000
*               ERCODE=R0;          /* SAVE REASON CODE      @Y30LPXA*/ 07720000
         ST    R0,ERCODE                                           1574 07721000
*               SS1FAIL='1'B;       /* SET ERROR FLAG                */ 07722000
         OI    SS1FAIL,B'00010000'                                 1575 07723000
*             END;                                                 1576 07724000
*         END;                                                     1577 07725000
*     END;                                                         1578 07726000
*   END;                            /* END OF PROCESSING     @Y30LPXA*/ 07727000
@EL00016 DS    0H                                                  1579 07728000
@EF00016 DS    0H                                                  1579 07729000
@ER00016 LM    @14,@12,@SA00016                                    1579 07730000
         BR    @14                                                 1579 07731000
*DISASSOC:                                                         1580 07732000
*   PROC;                           /*                       @Y30LPXA*/ 07733000
DISASSOC STM   @14,@12,@SA00017                                    1580 07734000
*/*** DISASSOC ***************************************************** */ 07735000
*/* THE DISASSOC ROUTINE WILL VERIFY THAT MSS IS INCLUDED IN THE     */ 07736000
*/* SYSTEM AND IF SO WILL NOTIFY THE DEVICE THAT A PROCESSOR IS NO   */ 07737000
*/* LONGER OPERATING IN MP MODE. A PURGE WILL BE ISSUED FOR THE CPU  */ 07738000
*/* WHICH HAS JUST GONE OFFLINE TO FREE ANY VOLUMES WHICH MAY BE     */ 07739000
*/* MOUNTED AND RECORDED IN THE DEVICES TABLES. THE FUNCTION IS ALSO */ 07740000
*/* PERFORMED WHEN CHANNEL RECONFIGURATION HARDWARE IS DEACTIVATED   */ 07741000
*/*********************************************************  @Y30LPXA*/ 07742000
*                                                                  1581 07743000
*   /*****************************************************************/ 07744000
*   /*                                                               */ 07745000
*   /* CHECK IF MSS IS ACTIVE AND IF SO ISSUE DISASSOCIATE AND PURGE */ 07746000
*   /* FOR OFFLINE CPU                                               */ 07747000
*   /*                                                               */ 07748000
*   /*****************************************************************/ 07749000
*                                                                  1581 07750000
*   IF(CVTICB^=0&ICBI='1'B)         /* MSS SYSGENED AND ACTIVE     1581 07751000
*                                                            @G24LP2L*/ 07752000
*       &ICBMSCA='0'B THEN                                         1581 07753000
         L     @12,CVTPTR                                          1581 07754000
         L     @12,CVTEXT2(,@12)                                   1581 07755000
         L     @12,CVTICB(,@12)                                    1581 07756000
         LTR   @12,@12                                             1581 07757000
         BZ    @RF01581                                            1581 07758000
         TM    ICBI(@12),B'10000000'                               1581 07759000
         BNO   @RF01581                                            1581 07760000
         TM    ICBMSCA(@12),B'00000010'                            1581 07761000
         BNZ   @RF01581                                            1581 07762000
*     DO;                           /* AND THE MSC IS NOT ASYMMETRIC    07763000
*                                                            @G24LP2L*/ 07764000
*                                                                  1582 07765000
*       /*************************************************************/ 07766000
*       /*                                                           */ 07767000
*       /* MSS IS ACTIVE. ISSUE DISASSOCIATE AND PURGE FOR CPU THAT  */ 07768000
*       /* HAS JUST GONE OFFLINE.                                    */ 07769000
*       /*                                                           */ 07770000
*       /*************************************************************/ 07771000
*                                                                  1583 07772000
*       R15=ADDR(HOST);             /* POINT TO WORK AREA    @Y30LPXA*/ 07773000
         LA    R15,HOST                                            1583 07774000
*       GEN(STIDP  0(R15));         /* STORE PROCESSOR ID    @Y30LPXA*/ 07775000
*                                                                  1584 07776000
         STIDP  0(R15)                                                  07777000
*       /*************************************************************/ 07778000
*       /*                                                           */ 07779000
*       /* SET UP FLAG BYTE FOR INTERFACE. FLAGS SPECIFY THAT MSS IS */ 07780000
*       /* TO BE DISASSOCIATED, INTERFACE OF OFFLINE CPU WILL BE     */ 07781000
*       /* DEINITIALIZED, AND THE SPECIFIED CPU WILL BECOME PRIMARY  */ 07782000
*       /* HOST IF MP SYSTEM HAD RESPONSIBILITY                      */ 07783000
*       /*                                                           */ 07784000
*       /*************************************************************/ 07785000
*                                                                  1585 07786000
*       AFLAG='0400'X;              /* SET UP FLAGS FOR DISASSOC   1585 07787000
*                                                            @ZM30463*/ 07788000
*                                                                  1585 07789000
         LA    AFLAG,1024                                          1585 07790000
*       /*************************************************************/ 07791000
*       /*                                                           */ 07792000
*       /* ISSUE DISASSOCIATE FOR OFFLINE CPU                        */ 07793000
*       /*                                                           */ 07794000
*       /*************************************************************/ 07795000
*                                                                  1586 07796000
*/*  ******************************************************* @Y30LB02*/ 07797000
*/*       MACMEAN  MSSC ASSOCIATE MACRO                      @Y30LB02*/ 07798000
*/*  VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00                 @Y30LB02*/ 07799000
*/*  THIS IS THE OUTPUT FOR THE EXECUTE FORM.                @Y30LB02*/ 07800000
*/*  THE LIST FORM OF THIS MACRO SHOULD BE                   @Y30LB02*/ 07801000
*/*  INVOKED FIRST IN ORDER TO SET UP NECESSARY              @Y30LB02*/ 07802000
*/*  DECLARES.  IF THE COMPLETE ARGUMENT IS                  @Y30LB02*/ 07803000
*/*  SPECIFIED THE REQ BLOCK WILL BE ZEROED.                 @Y30LB02*/ 07804000
*/*  ******************************************************* @Y30LB02*/ 07805000
*                                                                  1586 07806000
*       RFY                                                        1586 07807000
*        (ASDAR1) RSTD;             /* RESTRICT REG 1        @Y30LB02*/ 07808000
*       ASDAR1=ADDR(DISCPU);        /* R1 POINTER TO REQUEST BLOCK 1587 07809000
*                                                            @Y30LB02*/ 07810000
         LA    ASDAR1,DISCPU                                       1587 07811000
*       ASDALEN='10'X;              /* LENGTH OF ASSOC REQUEST     1588 07812000
*                                                            @Y30LB02*/ 07813000
         LA    @12,16                                              1588 07814000
         ST    @12,ASDALEN                                         1588 07815000
*       ASDAOPC='2C'X;              /* ASSOCIATE OPCODE      @Y30LB02*/ 07816000
         MVI   ASDAOPC,X'2C'                                       1589 07817000
*       ASDAFLG=(AFLAG);            /* VALUE OF FLAGS PARAMETER    1590 07818000
*                                                            @Y30LB02*/ 07819000
         STH   AFLAG,ASDAFLG                                       1590 07820000
*       ASDACPU=(HOSTID);           /* HOSTID                @Y30LB02*/ 07821000
         MVC   ASDACPU(5),HOSTID                                   1591 07822000
*       SVC(126);                   /* INVOKE THE SVC        @Y30LB02*/ 07823000
         SVC   126                                                 1592 07824000
*       RFY                                                        1593 07825000
*         ASDAR1 UNRSTD;            /* UNRESTRICT REG 1      @Y30LB02   07826000
*                                                            @Y30LPXA*/ 07827000
*                                                                  1593 07828000
*       /*************************************************************/ 07829000
*       /*                                                           */ 07830000
*       /* CPU HAS BEEN DISASSOCIATED, ISSUE PURGE FOR ALL VOLUMES ON*/ 07831000
*       /* OFFLINE CPU FLAGS SPECIFY THAT ALL VOLUMES ARE TO BE      */ 07832000
*       /* DEMOUNTED FOR THE OTHER PROCESSOR OF THIS MP PAIR.        */ 07833000
*       /*                                                           */ 07834000
*       /*************************************************************/ 07835000
*                                                                  1594 07836000
*       AFLAG='8000'X;              /* SET FLAGS FOR MACRO CALL    1594 07837000
*                                                            @Y30LPXA*/ 07838000
         L     AFLAG,@CF03850                                      1594 07839000
*/*  ******************************************************* @Y30LB02*/ 07840000
*/*  MACMEAN  PURGE/ASSIGN/INITIALIZE/READY    MACRO         @Y30LB02*/ 07841000
*/*  VS1-4/VS2-3 VERSION-- 06/09/74 LEVEL 00                 @Y30LB02*/ 07842000
*/*  THIS IS THE OUTPUT FOR THE EXECUTE FORM.                @Y30LB02*/ 07843000
*/*  THE LIST FORM OF THIS MACRO SHOULD BE                   @Y30LB02*/ 07844000
*/*  INVOKED FIRST IN ORDER TO SET UP NECESSARY              @Y30LB02*/ 07845000
*/*  DECLARES.  IF THE COMPLETE ARGUMENT IS                  @Y30LB02*/ 07846000
*/*  SPECIFIED THE REQ BLOCK WILL BE ZEROED.                 @Y30LB02*/ 07847000
*/*  ******************************************************* @Y30LB02*/ 07848000
*                                                                  1595 07849000
*       RFY                                                        1595 07850000
*        (PAIRR1) RSTD;             /* RESTRICT R1           @Y30LB02*/ 07851000
*       PAIRR1=ADDR(PURCPU);        /* SET PAIRR1 TO REQ BLOCK     1596 07852000
*                                                            @Y30LB02*/ 07853000
         LA    PAIRR1,PURCPU                                       1596 07854000
*       PURGLL='0D'X;               /* SET LENGTH FIELD      @Y30LB02*/ 07855000
         LA    @12,13                                              1597 07856000
         ST    @12,PURGLL                                          1597 07857000
*       PURGOP='14'X;               /* PURG OPCODE           @Y30LB02*/ 07858000
         MVI   PURGOP,X'14'                                        1598 07859000
*       PURGFLG=(AFLAG);            /* FILL IN FLAGS FIELD   @Y30LB02*/ 07860000
         STH   AFLAG,PURGFLG                                       1599 07861000
*       PURGHOST=(HOSTID);          /* FILL IN HOSTID FIELD  @Y30LB02*/ 07862000
         MVC   PURGHOST(5),HOSTID                                  1600 07863000
*       SVC(126);                   /* ISSUE SVC INST.       @Y30LB02*/ 07864000
         SVC   126                                                 1601 07865000
*       RFY                                                        1602 07866000
*        (PAIRR1) UNRSTD;           /* UNRESTRICT R1         @Y30LB02*/ 07867000
*                                                                  1602 07868000
*       /*************************************************************/ 07869000
*       /*                                                           */ 07870000
*       /* ISSUE PURGE FOR OFFLINE CPU                       @ZM30463*/ 07871000
*       /*                                                           */ 07872000
*       /*************************************************************/ 07873000
*                                                                  1603 07874000
*     END;                                                         1603 07875000
*   END;                                                           1604 07876000
@EL00017 DS    0H                                                  1604 07877000
@EF00017 DS    0H                                                  1604 07878000
@ER00017 LM    @14,@12,@SA00017                                    1604 07879000
         BR    @14                                                 1604 07880000
*                                                                  1605 07881000
*/* ****** FRRRTN ************************************************   */ 07882000
*/* FRRRTN WILL GAIN CONTROL IN THE EVENT OF A SYSTEM FAILURE WHILE  */ 07883000
*/* HOLDING THE RESTART RESOURCE WORD.  ROUTINE WILL SIMPLY FREE     */ 07884000
*/* RESTART RESOURCE AND CONTINUE ABEND                              */ 07885000
*/*****************************************************************  */ 07886000
*                                                                  1605 07887000
*FRRRTN:                                                           1605 07888000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1605 07889000
*                                                                  1605 07890000
FRRRTN   DS    0H                                                  1606 07891000
*   /*****************************************************************/ 07892000
*   /*                                                               */ 07893000
*   /* ZERO RESTART RESOURCE                                         */ 07894000
*   /*                                                               */ 07895000
*   /*****************************************************************/ 07896000
*                                                                  1606 07897000
*   CVTRSTWD=0;                     /* ZERO RESTART WORD             */ 07898000
         L     @12,CVTPTR                                          1606 07899000
         SLR   @06,@06                                             1606 07900000
         ST    @06,CVTRSTWD(,@12)                                  1606 07901000
*   DO;                             /* SETRP RECORD(NO)RC(0)         */ 07902000
*     RESPECIFY                                                    1608 07903000
*      (GPR00P,                                                    1608 07904000
*       GPR01P,                                                    1608 07905000
*       GPR14P,                                                    1608 07906000
*       GPR15P) RSTD;                                              1608 07907000
*     GPR01P->SDWARCDE=0;           /* SAVE RC VALUE                 */ 07908000
         MVI   SDWARCDE(GPR01P),X'00'                              1609 07909000
*     GPR01P->SDWARCRD='0'B;        /* TURN OFF RECORD INDICATOR     */ 07910000
         NI    SDWARCRD(GPR01P),B'01111111'                        1610 07911000
*     RESPECIFY                                                    1611 07912000
*      (GPR00P,                                                    1611 07913000
*       GPR01P,                                                    1611 07914000
*       GPR14P,                                                    1611 07915000
*       GPR15P) UNRSTD;                                            1611 07916000
*   END;                            /* CONTINUE TERM                 */ 07917000
*   END;                            /* **** END OF FRR ROUTINE       */ 07918000
@EL00018 DS    0H                                                  1613 07919000
@EF00018 DS    0H                                                  1613 07920000
@ER00018 BR    @14                                                 1613 07921000
*ESTAERTN:                                                         1614 07922000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1614 07923000
*                                                                  1614 07924000
ESTAERTN DS    0H                                                  1615 07925000
*/******* ESTAERTN ************************************************  */ 07926000
*/* ESTAERTN ROUTINE WILL RECEIVE CONTROL IN THE EVENT OF A SYSTEM   */ 07927000
*/* ERROR OR HARDWARE ERROR. ROUTINE WILL RESTORE ADDRESSABILITY     */ 07928000
*/* FOR CODE BY RELOADING REGISTERS THAT WERE SAVED UPON INITIAL     */ 07929000
*/* ENTRY. A LINK WILL BE MADE TO CLEAN UP ROUTINE AND UPON RETURN   */ 07930000
*/* WILL RETURN TO RTM.                                              */ 07931000
*/*****************************************************************  */ 07932000
*                                                                  1615 07933000
*   /*****************************************************************/ 07934000
*   /*                                                               */ 07935000
*   /* ISSUE MACRO TO RESTABLISH ADDRESSABILITY                      */ 07936000
*   /*                                                               */ 07937000
*   /*****************************************************************/ 07938000
*                                                                  1615 07939000
*   DO;                             /* ENTESTAE (R5,R8,R9,R7)SAVEAREA   07940000
*                                      (REGSAVEA)ERREXIT(NORTCA)PARMR   07941000
*                                      EG(R15)                       */ 07942000
*                                                                  1615 07943000
*     /***************************************************************/ 07944000
*     /*                                                             */ 07945000
*     /* ENTRY CODE FOR ESTAE ROUTINE. IF RTCA ALLOCATED THEN RESTORE*/ 07946000
*     /* CODE AND DATA REGS FROM START OF USERS PARM LIST, AND       */ 07947000
*     /* ESTABLISH ADDR TO ESTAE SAVE AREA IF REQUIRED. IF NO RTCA   */ 07948000
*     /* AVAILABLE THEN BRANCH TO ERROR CODE AFTER ESTABLISHING      */ 07949000
*     /* ADDRESSABILITY                                              */ 07950000
*     /*                                                             */ 07951000
*     /***************************************************************/ 07952000
*                                                                  1616 07953000
*     GEN(USING *,GPR15P);                                         1616 07954000
         USING *,GPR15P                                                 07955000
*     GEN(CH    GPR00F,*+34);       /* CHECK IF RTCA ALLOC FAILED    */ 07956000
         CH    GPR00F,*+34                                              07957000
*     GEN(BNE   *+32);              /* NO,SAVE RTM REGS              */ 07958000
         BNE   *+32                                                     07959000
*     GEN(DROP  GPR15P);            /* DROP LOCAL ADDR               */ 07960000
         DROP  GPR15P                                                   07961000
*     GEN(LR    R15,GPR02P);        /* PTR TO USER PARM LIST         */ 07962000
         LR    R15,GPR02P                                               07963000
*     GEN(L     R5,00(R15));                                       1621 07964000
         L     R5,00(R15)                                               07965000
*     GEN(L     R8,04(R15));                                       1622 07966000
         L     R8,04(R15)                                               07967000
*     GEN(L     R9,08(R15));                                       1623 07968000
         L     R9,08(R15)                                               07969000
*     GEN(L     R7,12(R15));                                       1624 07970000
         L     R7,12(R15)                                               07971000
*     GEN(LA    GPR13P,REGSAVEA);   /* SET PTR TO ESTAE SA           */ 07972000
         LA    GPR13P,REGSAVEA                                          07973000
*     GEN(B     NORTCA);            /* BRANCH TO ERROR EXIT          */ 07974000
         B     NORTCA                                                   07975000
*     GEN(DC    H'12');             /* NO RTCA AVAIL RC              */ 07976000
         DC    H'12'                                                    07977000
*     GEN(STM   GPR14P,GPR12F,12(GPR13P));/* GOOD R13, SAVE RTM'S  1628 07978000
*                                      REGS                          */ 07979000
         STM   GPR14P,GPR12F,12(GPR13P)                                 07980000
*     GEN(L     R15,0(GPR01P));     /* PTR TO USER PARM LIST         */ 07981000
         L     R15,0(GPR01P)                                            07982000
*     GEN(L     R5,00(R15));                                       1630 07983000
         L     R5,00(R15)                                               07984000
*     GEN(L     R8,04(R15));                                       1631 07985000
         L     R8,04(R15)                                               07986000
*     GEN(L     R9,08(R15));                                       1632 07987000
         L     R9,08(R15)                                               07988000
*     GEN(L     R7,12(R15));                                       1633 07989000
         L     R7,12(R15)                                               07990000
*     GEN(ST    GPR13P,REGSAVEA+4); /* SET PTR TO RTM SA             */ 07991000
         ST    GPR13P,REGSAVEA+4                                        07992000
*     GEN(LA    GPR13P,REGSAVEA);   /* SET PTR TO ESTAE SA           */ 07993000
         LA    GPR13P,REGSAVEA                                          07994000
*   END;                            /* ENTESTAE (R5,R8,R9,R7)SAVEAREA   07995000
*                                      (REGSAVEA)ERREXIT(NORTCA)PARMR   07996000
*                                      EG(R15)                       */ 07997000
*                                                                  1636 07998000
*   /*****************************************************************/ 07999000
*   /*                                                               */ 08000000
*   /* ADDRESSABILITY HAS BEEN REESTABLISHED, LINK TO CLEANUP ROUTINE*/ 08001000
*   /* AND UPON RETURN RETURN TO RTM SAVE POINTER TO SDWA ACROSS CALL*/ 08002000
*   /*                                                               */ 08003000
*   /*****************************************************************/ 08004000
*                                                                  1637 08005000
*   RFY                                                            1637 08006000
*    (R1,                                                          1637 08007000
*     R2) RSTD;                     /* RESTRICT REG                  */ 08008000
*   R2=R1;                          /* COPY REGISTER ONE             */ 08009000
         LR    R2,R1                                               1638 08010000
*   CALL IEECLEAN(ADDR(WORKAREA));  /* LINK TO CLEANUP               */ 08011000
         LA    @12,WORKAREA                                        1639 08012000
         ST    @12,@TF00001                                        1639 08013000
         LA    @12,@TF00001                                        1639 08014000
         ST    @12,@AL00001                                        1639 08015000
         L     @15,@CV03522                                        1639 08016000
         LA    @01,@AL00001                                        1639 08017000
         BALR  @14,@15                                             1639 08018000
*   R1=R2;                          /* RESTORE REG ONE               */ 08019000
         LR    R1,R2                                               1640 08020000
*   RFY                                                            1641 08021000
*    (R1,                                                          1641 08022000
*     R2) UNRSTD;                   /* RELEASE REG                   */ 08023000
*                                                                  1641 08024000
*   /*****************************************************************/ 08025000
*   /*                                                               */ 08026000
*   /* PICK UP POINTER TO ESTAE SAVE AREA                            */ 08027000
*   /*                                                               */ 08028000
*   /*****************************************************************/ 08029000
*                                                                  1642 08030000
*   GEN(L R13,4(R13));              /* RESTORE SAVAREA POINTER       */ 08031000
*                                                                  1642 08032000
         L R13,4(R13)                                                   08033000
*   /*****************************************************************/ 08034000
*   /*                                                               */ 08035000
*   /* PLACE RECORDING INFORMATION IN SDWA FOR ID.                   */ 08036000
*   /*                                                               */ 08037000
*   /*****************************************************************/ 08038000
*                                                                  1643 08039000
*   RFY                                                            1643 08040000
*    (SDWAPTR) RSTD;                /* RESTRICT SDWA POINTER         */ 08041000
*   SDWAMODN='IEEVCPU';             /* MODULE NAME                   */ 08042000
         MVI   SDWAMODN+7(SDWAPTR),C' '                            1644 08043000
         MVC   SDWAMODN(7,SDWAPTR),@CC03867                        1644 08044000
*   SDWACSCT='IEEVCPU';             /* CSECT NAME                    */ 08045000
         MVI   SDWACSCT+7(SDWAPTR),C' '                            1645 08046000
         MVC   SDWACSCT(7,SDWAPTR),@CC03867                        1645 08047000
*   SDWAVRA=WORKAREA;               /* MOVE COMMON WORK AREA TO    1646 08048000
*                                      RECORD                        */ 08049000
         MVC   SDWAVRA(108,SDWAPTR),WORKAREA                       1646 08050000
*   SDWAURAL=LENGTH(WORKAREA);      /* LENGTH OF WORKAREA            */ 08051000
         MVI   SDWAURAL(SDWAPTR),X'74'                             1647 08052000
*   SDWAHEX='1'B;                   /* SET HEX FLAG                  */ 08053000
         OI    SDWAHEX(SDWAPTR),B'10000000'                        1648 08054000
*   RFY                                                            1649 08055000
*    (SDWAPTR) UNRSTD;              /* RELEASE REGISTER              */ 08056000
*   DO;                             /* SETRP DUMP(NO)RECORD(YES)RC(0)   08057000
*                                      REGS(14,12)                   */ 08058000
*     RESPECIFY                                                    1651 08059000
*      (GPR00P,                                                    1651 08060000
*       GPR01P,                                                    1651 08061000
*       GPR14P,                                                    1651 08062000
*       GPR15P) RSTD;                                              1651 08063000
*     GPR01P->SDWARCDE=0;           /* SAVE RC VALUE                 */ 08064000
         MVI   SDWARCDE(GPR01P),X'00'                              1652 08065000
*     GPR01P->SDWARCRD='1'B;        /* TURN ON RECORD INDICATOR      */ 08066000
         OI    SDWARCRD(GPR01P),B'10000000'                        1653 08067000
*     GPR01P->SDWAREQ='0'B;         /* TURN OFF DUMP INDICATOR       */ 08068000
         NI    SDWAREQ(GPR01P),B'01111111'                         1654 08069000
*     GEN(RETURN (14,12));                                         1655 08070000
         RETURN (14,12)                                                 08071000
*     RESPECIFY                                                    1656 08072000
*      (GPR00P,                                                    1656 08073000
*       GPR01P,                                                    1656 08074000
*       GPR14P,                                                    1656 08075000
*       GPR15P) UNRSTD;                                            1656 08076000
*   END;                                                           1657 08077000
*NORTCA:                                                           1658 08078000
*                                                                  1658 08079000
*   /*****************************************************************/ 08080000
*   /*                                                               */ 08081000
*   /* CALL MAY BE MADE TO CLEANUP ROUTINE EVEN WITHOUT SDWA         */ 08082000
*   /*                                                               */ 08083000
*   /*****************************************************************/ 08084000
*                                                                  1658 08085000
*   CALL IEECLEAN(ADDR(WORKAREA));  /* CALL CLEANUP ROUTINE          */ 08086000
NORTCA   LA    @12,WORKAREA                                        1658 08087000
         ST    @12,@TF00001                                        1658 08088000
         LA    @12,@TF00001                                        1658 08089000
         ST    @12,@AL00001                                        1658 08090000
         L     @15,@CV03522                                        1658 08091000
         LA    @01,@AL00001                                        1658 08092000
         BALR  @14,@15                                             1658 08093000
*   RFY                                                            1659 08094000
*    (R15) RSTD;                    /* RESTRICT REG 15               */ 08095000
*   R15=0;                          /* ZERO REG 15                   */ 08096000
         SLR   R15,R15                                             1660 08097000
*   RFY                                                            1661 08098000
*    (R15) UNRSTD;                  /* RELEASE REG 15                */ 08099000
*   END;                            /* *** END OF ESTAE ROUTINE      */ 08100000
@EL00019 DS    0H                                                  1662 08101000
@EF00019 DS    0H                                                  1662 08102000
@ER00019 BR    @14                                                 1662 08103000
*IEAVSPSA:                                                         1663 08104000
*   PROC(FREEPTR) OPTIONS(NOSAVE(1,15),NOSAVEAREA);                1663 08105000
*                                                                  1663 08106000
IEAVSPSA ST    @14,12(,@13)                                        1663 08107000
         ST    @00,20(,@13)                                        1663 08108000
         STM   @02,@12,28(@13)                                     1663 08109000
         MVC   @PC00020(4),0(@01)                                  1663 08110000
*/********************************************************************/ 08111000
*/*                                                                  */ 08112000
*/*                                                                  */ 08113000
*/********************************************************************/ 08114000
*/*                                                                  */ 08115000
*/* STATUS:   CHANGE LEVEL=001  12/12/74                             */ 08116000
*/*                                                                  */ 08117000
*/* FUNCTION:  1) FOR GETMAIN REQUESTS, TO GET A SA/WA AND VECTOR    */ 08118000
*/*               TABLE AND INITIALIZE IT                            */ 08119000
*/*            2) FOR FREEMAIN REQUESTS, TO FREE A SA/WA AND VECTOR  */ 08120000
*/*               TABLE                                              */ 08121000
*/*            3) FOR FORMAT REQUESTS, TO FORMAT THE SA/WA VECTOR    */ 08122000
*/*               TABLE                                              */ 08123000
*/*                                                                  */ 08124000
*/* ENTRY POINT: IEAVSPSA                                            */ 08125000
*/*                                                                  */ 08126000
*/* INPUT:    REGISTER 1  CONTAINS: 1)ADDRESS TO FREEMAIN, OR        */ 08127000
*/*                                 2)ZERO IF REQUEST FOR GETMAIN    */ 08128000
*/*                                 3)COMPLEMENT FOR FORMAT          */ 08129000
*/*           REGISTER 13 POINTS TO A REGISTER SAVEAREA              */ 08130000
*/*           REGISTER 14 CONTAINS THE RETURN ADDRESS                */ 08131000
*/*           REGISTER 15 CONTAINS THE ENTRY POINT ADDRESS           */ 08132000
*/*                                                                  */ 08133000
*/* OUTPUT:   REGISTER 1  CONTAINS 1)ADDRESS OF VECTOR TABLE         */ 08134000
*/*                                2)ZERO - ON RETURN FROM FREEMAIN  */ 08135000
*/*                                         REQUEST                  */ 08136000
*/*           REGISTER 15 CONTAINS 1)A RETURN CODE OF ZERO, IF NO    */ 08137000
*/*                                  ERROR                           */ 08138000
*/*                                2)A RETURN CODE OF FOUR FOR ERRORS*/ 08139000
*/*                                   FROM AT LEAST ONE OF THESE     */ 08140000
*/*                                   SOURCES:                       */ 08141000
*/*                                  - ISSUING A GETMAIN             */ 08142000
*/*                                  - ISSUING A FREEMAIN            */ 08143000
*/*                                  - ISSUING A SETLOCK TO OBTAIN OR*/ 08144000
*/*                                    FREE SALLOC                   */ 08145000
*/*           REGISTER 14 CONTAINS THE RETURN ADDRESS                */ 08146000
*/*           REGISTER 13 POINTS TO A REGISTER SAVEAREA              */ 08147000
*/*                                                                  */ 08148000
*/* EXTERNAL REFERENCES: NONE.                                       */ 08149000
*/*                                                                  */ 08150000
*/* EXITS:    RETURN TO CALLER VIA A BR 14                           */ 08151000
*/*                                                                  */ 08152000
*/* ERROR CODES:                                                     */ 08153000
*/*           REGISTER 15 CONTAINS THE RETURN CODE                   */ 08154000
*/*                                                                  */ 08155000
*/* TABLES/WORK AREAS: IHAWSAVT                                      */ 08156000
*/* NOTE: THE ROUTINE THAT INCLUDES THIS ROUTINE MUST CONTAIN        */ 08157000
*/*       MAPPING MACROS FOR THE CVT (MARCO: CVT) AND THE PSA        */ 08158000
*/*       (MACRO: IHAPSA).                                           */ 08159000
*/*                                                                  */ 08160000
*/* ATTRIBUTES: SERIALLY REUSABLE                                    */ 08161000
*/*                                                                  */ 08162000
*/* RESOURCES:                                                       */ 08163000
*/*           NONE.                                                  */ 08164000
*/*                                                                  */ 08165000
*/* SVCS:     NONE.  BRANCH ENTRIES TO GETMAIN,FREEMAIN              */ 08166000
*/*                                                                  */ 08167000
*/* MESSAGES: NONE.                                                  */ 08168000
*/*                                                                  */ 08169000
*/* NOTES:                                                           */ 08170000
*/*    THIS ROUTINE INCLUDES THE MAPPING MACRO 'IHAWSAVT' AND        */ 08171000
*/*    SPECIFIES THE MAPPING OF THE GLOBAL WORK/SAVE AREAS, EVEN     */ 08172000
*/*    THOUGH THIS ROUTINE BUILDS THE WORK/SAVE AREAS FOR A CPU.     */ 08173000
*/*    THIS IS BECAUSE THIS ROUTINE USES 'GETMAIN' TO OBTAIN THE     */ 08174000
*/*    SPACE FOR THE WORK/SAVE AREA IT IS BUILDING BUT 'GETMAIN'     */ 08175000
*/*    ITSELF USES THE GLOBAL WORK/SAVE AREAS.                       */ 08176000
*/*    THE MAPPING MACRO FOR THE CPU RELATED WORK/SAVE AREA IS NOT   */ 08177000
*/*    USED IN BUILDING OR INITIALIZING THAT WORK/SAVE AREA BY THIS  */ 08178000
*/*    THIS ROUTINE, THUS THE MAPPING OF THE CPU RELATED WORK/SAVE   */ 08179000
*/*    AREA IS NOT NEEDED BY THIS ROUTINE BUT THE MAPPING OF THE     */ 08180000
*/*    GLOBAL WORK/SAVE AREA IS NEEDED.                              */ 08181000
*/*                                                                  */ 08182000
*/********************************************************************/ 08183000
*                                                                  1664 08184000
*                                                                  1664 08185000
*/* **************************************************************** */ 08186000
*/*                                                                  */ 08187000
*/*            WORK/SAVE AREA VECTOR TABLES (WSAVT)                  */ 08188000
*/*                                                                  */ 08189000
*/*  OS/VS2 RELEASE 4, 07/22/75, LEVEL=2                             */ 08190000
*/*                                                                  */ 08191000
*/*  METHOD OF ACCESS                                                */ 08192000
*/*      PL/S - INCLUDE IHAASXB TO DEFINE ASXBSPSA FOR LOCAL WSAVT.  */ 08193000
*/*             INCLUDE CVT TO DEFINE CVTSPSA FOR GLOBAL WSAVT.      */ 08194000
*/*             INCLUDE IHALCCA TO DEFINE LCCACPUS FOR CPU WSAVT.    */ 08195000
*/*                                                                  */ 08196000
*/*             ALL 3 WSAVT'S ARE MAPPED UNLESS MACRO VARIABLE(S)    */ 08197000
*/*             ARE SET TO NO.  CODING %WSALOCAL='NO' BEFORE INCLUDE */ 08198000
*/*             MEANS THAT A MAPPING OF LOCAL WSAVT WILL NOT BE      */ 08199000
*/*             PRODUCED.  %WSAGLOBL='NO' SUPPRESSES GLOBAL WSAVT    */ 08200000
*/*             MAPPING.  %WSACPU='NO' SUPPRESSES CPU WSAVT MAPPING. */ 08201000
*/*                                                                  */ 08202000
*/*      BAL -  THERE ARE 4 KEYWORD PARAMETERS AS FOLLOWS -          */ 08203000
*/*                                                                  */ 08204000
*/*             1. CLASS=LOCAL/GLOBAL/CPU WITH A DEFAULT OF LOCAL.   */ 08205000
*/*                THIS PARAMETER DETERMINES WHICH WSAVT MAPPING IS  */ 08206000
*/*                PRODUCED.                                         */ 08207000
*/*                                                                  */ 08208000
*/*             2. DSECT=YES/NO WITH A DEFAULT OF YES.  IF YES, A    */ 08209000
*/*                DSECT IS PRODUCED FOR MAPPING REQUESTED BY CLASS  */ 08210000
*/*                PARAMETER.  THE DSECT NAMES ARE -                 */ 08211000
*/*                     WSAL - LOCAL WSAVT                           */ 08212000
*/*                     WSAG - GLOBAL WSAVT                          */ 08213000
*/*                     WSAC - CPU WSAVT                             */ 08214000
*/*                                                                  */ 08215000
*/*             3. FUNC=INIT.  IF THIS PARAMETER IS SPECIFIED, AN    */ 08216000
*/*                INITIALIZED TABLE OF HALF-WORD LENGTH VALUES      */ 08217000
*/*                DESCRIBING THE NUMBER OF ENTRIES AND LENGTH OF    */ 08218000
*/*                EACH ENTRY IN WSAVT SPECIFIED BY CLASS PARAMETER  */ 08219000
*/*                IS PRODUCED.                                      */ 08220000
*/*                                                                  */ 08221000
*/*             4. ACR=YES/NO WITH A DEFAULT OF YES.  IF CLASS=CPU   */ 08222000
*/*                AND DSECT=NO, ACR=YES CREATES A WORK/SAVE AREA    */ 08223000
*/*                FOR ACR, AND ACR=NO CREATES A RESERVED 8-BYTE     */ 08224000
*/*                AREA BECAUSE ACR IS NOT IN THE SYSTEM.            */ 08225000
*/*                                                                  */ 08226000
*/*             DSECT=NO MUST BE SPECIFIED IF FUNC=INIT IS SPECIFIED.*/ 08227000
*/*                                                                  */ 08228000
*/*             IF DSECT=NO IS SPECIFIED AND FUNC=INIT IS NOT        */ 08229000
*/*             SPECIFIED, THE MAPPING OF WSAVT WILL BE FOLLOWED BY  */ 08230000
*/*             MAPPING OF ACTUAL WORK/SAVE AREAS.                   */ 08231000
*/*                                                                  */ 08232000
*/* **************************************************************** */ 08233000
*                                                                  1664 08234000
*   DECLARE                                                        1664 08235000
*     1 WSAG BASED(CVTSPSA) BDY(DWORD),/* GLOBAL WORK/SAVE AREA    1664 08236000
*                                      VECTOR TABLE                  */ 08237000
*      2 WSAGPGIO PTR(31),          /* ADDRESS OF PAGE I/O ERROR SAVE   08238000
*                                      AREA (80 BYTES)               */ 08239000
*      2 WSAGGMFM PTR(31),          /* ADDRESS OF GETMAIN/ FREEMAIN     08240000
*                                      SAVE AREA (1168 BYTES)      1664 08241000
*                                      (MDC301)              @Z30EN9A*/ 08242000
*      2 WSAGRSM PTR(31),           /* ADDRESS OF REAL STORAGE     1664 08243000
*                                      MANAGEMENT (RSM) SAVE AREA  1664 08244000
*                                      (1024 BYTES)                  */ 08245000
*      2 WSAGSSRS PTR(31),          /* ADDRESS OF SUSPEND/RESET FOR     08246000
*                                      RSM SAVE AREA (80 BYTES)      */ 08247000
*      2 WSAGEMS0 PTR(31),          /* ADDRESS OF MEMORY SWITCH SAVE    08248000
*                                      AREA (56 BYTES)               */ 08249000
*      2 WSAGSTAT PTR(31),          /* ADDRESS OF STATUS SAVE AREA 1664 08250000
*                                      (72 BYTES)                    */ 08251000
*      2 WSAGOPTM PTR(31),          /* ADDRESS OF SYSTEM RESOURCES 1664 08252000
*                                      MANAGER (SRM) SAVE AREA (400     08253000
*                                      BYTES) MDC017                 */ 08254000
*      2 WSAGMEMT PTR(31),          /* ADDRESS OF MEMORY TERMINATION    08255000
*                                      SAVE AREA (80 BYTES)          */ 08256000
*      2 WSAGNQDQ PTR(31),          /* ADDRESS OF ENQ/DEQ SAVE AREA     08257000
*                                      (296 BYTES) MDC011            */ 08258000
*      2 WSAGREST PTR(31),          /* ADDRESS OF WORK/SAVE AREA FOR    08259000
*                                      STATUS SAVING BY STOP AND   1664 08260000
*                                      RESTART SUBROUTINE (168 BYTES)   08261000
*                                      MDC018                        */ 08262000
*      2 WSAGSCHE PTR(31);          /* ADDRESS OF SCHEDULE ROUTINE 1664 08263000
*                                      (IEAVESC0) SAVE AREA FOR    1664 08264000
*                                      SYSEVENT BRANCH ENTRY       1664 08265000
*                                      INTERFACE (72 BYTES) MDC014   */ 08266000
*   DCL                                                            1665 08267000
*     REGSAPTR PTR(31) REG(13);     /* PTR. TO REGISTER SAVE AREAS   */ 08268000
*   DCL                                                            1666 08269000
*     PARMX FIXED(31) REG(1);       /* INPUT PARM            @ZM30488*/ 08270000
*   DCL                                                            1667 08271000
*     PARM POINTER(31) REG(1);      /* INPUT AND OUTPUT PARM         */ 08272000
*   DCL                                                            1668 08273000
*     RTCODE FIXED(31) REG(15);     /* RETURN CODE                   */ 08274000
*   DCL                                                            1669 08275000
*     TBLPTR PTR(31) REG(1);        /* PTR TO VECTOR TABLE           */ 08276000
*   DCL                                                            1670 08277000
*     LNGREG FIXED(31) REG(0);      /* LENGTH TO GET OR FREE         */ 08278000
*   DCL                                                            1671 08279000
*     LOCKRC FIXED(31) REG(15);     /* RETURN CODE FROM SETLOCK      */ 08280000
*   DCL                                                            1672 08281000
*     GMREG FIXED(31) REG(3);       /* PARMS FOR GETMAIN             */ 08282000
*   DCL                                                            1673 08283000
*     1 LGTHTBL BASED(CVTWSAC),     /* CPU SA/WA SIZES               */ 08284000
*     (2 NUM,                       /* NUMBER OF ENTRIES             */ 08285000
*      2 LGTH,                      /* VECTOR TBL + SAVEAREAS        */ 08286000
*      2 FSIZE) FIXED(15);          /* SIZE OF FIRST SA/WA           */ 08287000
*   DCL                                                            1674 08288000
*     SVPTR BASED(P) PTR(31);       /* VECTOR TABLE                  */ 08289000
*   DCL                                                            1675 08290000
*     P PTR(31);                    /* POINT TO VECTOR ENTRIES       */ 08291000
*   DCL                                                            1676 08292000
*     SAPTR PTR(31);                /* PTR TO SAVEAREAS              */ 08293000
*   DCL                                                            1677 08294000
*     NSIZEPTR PTR(31);             /* POINTER TO SIZE ENTRIES       */ 08295000
*   DCL                                                            1678 08296000
*     1 GMTBL FIXED(31),            /* GET/FREEMAIN PARMS            */ 08297000
*     (2 RSVD,                      /* RESERVED BYTE                 */ 08298000
*      2 STKEY,                     /* STORAGE PROTECT KEY           */ 08299000
*      2 SBPOOL,                    /* SUBPOOL REQUESTED             */ 08300000
*      2 FLAGS) FIXED(8);           /* TYPE OF GET/FREEMAIN          */ 08301000
*   DCL                                                            1679 08302000
*     HOLDRC FIXED(31);             /* RETAINER OF RETURN CODE       */ 08303000
*   DCL                                                            1680 08304000
*     CDGM FIXED(8) CONSTANT(0);    /* X'00' INDICATOR OF CONDITIONAL   08305000
*                                      GETMAIN                       */ 08306000
*   DCL                                                            1681 08307000
*     CDFM FIXED(8) CONSTANT(1);    /* X'01' INDICATOR OF CONDITIONAL   08308000
*                                      FREEMAIN                      */ 08309000
*   DCL                                                            1682 08310000
*     LUPONE FIXED(8) CONSTANT(1);  /* LOOP CONTROL CONSTANT         */ 08311000
*   DCL                                                            1683 08312000
*     ZZERO FIXED(8) CONSTANT(0);   /* ZERO RETURN CODE              */ 08313000
*   DCL                                                            1684 08314000
*     FFOUR FIXED(8) CONSTANT(4);   /* RETURN CODE FOUR              */ 08315000
*   DCL                                                            1685 08316000
*     SQAPOOL FIXED(8) CONSTANT(245);/* SUBPOOL 245                  */ 08317000
*   DCL                                                            1686 08318000
*     KEYZERO FIXED(8) CONSTANT(0); /* KEY                           */ 08319000
*   DCL                                                            1687 08320000
*     INCSIZE FIXED(8) CONSTANT(2); /* INCREMENT VALUE               */ 08321000
*   DCL                                                            1688 08322000
*     GETID FIXED(8) CONSTANT(0);   /* R1=0 ON GETMAIN REQUEST       */ 08323000
*   DCL                                                            1689 08324000
*     LOOP FIXED(31);               /* LOOP INDEX                    */ 08325000
*   DCL                                                            1690 08326000
*     R3SAVAR PTR(31);              /* SAVE AREA FOR REG. 3 ACROSS 1690 08327000
*                                      GET/FREEMAIN'S                */ 08328000
*   DCL                                                            1691 08329000
*     SAVAREA PTR(31);              /* SAVE AREA FOR POINTER TO    1691 08330000
*                                      REGISTER SAVE AREAS           */ 08331000
*   DCL                                                            1692 08332000
*     1 SETLOKSA BDY(WORD),         /* SETLOCK REG. SAVE AREA        */ 08333000
*      2 * FIXED(31),               /* SAVE AREA FOR REG. 11         */ 08334000
*      2 * FIXED(31),               /* SAVE AREA FOR REG. 12         */ 08335000
*      2 * FIXED(31),               /* SAVE AREA FOR REG. 13         */ 08336000
*      2 * FIXED(31),               /* SAVE AREA FOR REG. 14         */ 08337000
*      2 * FIXED(31);               /* FIFTH WORD OF SAVE AREA       */ 08338000
*   DCL                                                            1693 08339000
*     NWSASIZE FIXED(15) BASED(NSIZEPTR);                          1693 08340000
*   DCL                                                            1694 08341000
*     1 NP0FMTWS FIXED(15),         /* FLAGS USED BY IEAVSPSA      1694 08342000
*                                                            @OZ05329*/ 08343000
*      2 FRMTONLY BIT(1);           /* FORMAT ONLY - NO GETMAIN    1694 08344000
*                                                            @OZ05329*/ 08345000
*   RFY                                                            1695 08346000
*    (PARM,                                                        1695 08347000
*     RTCODE) RSTD;                 /* THESE REG'S ARE RSTD THRUOUT     08348000
*                                      THIS MODULE                   */ 08349000
*                                                                  1695 08350000
*   /*****************************************************************/ 08351000
*   /*                                                               */ 08352000
*   /* CHECK FOR FORMAT REQUEST                              @OZ05329*/ 08353000
*   /*                                                               */ 08354000
*   /*****************************************************************/ 08355000
*                                                                  1696 08356000
*   IF PARMX<0 THEN                 /* REGISTER NEGATIVE     @ZM30488*/ 08357000
         LTR   PARMX,PARMX                                         1696 08358000
         BNM   @RF01696                                            1696 08359000
*     DO;                                                          1697 08360000
*       TBLPTR=-PARMX;              /* CORRECT ADDRESS       @ZM30488*/ 08361000
         LCR   @14,PARMX                                           1698 08362000
         LR    TBLPTR,@14                                          1698 08363000
*       FRMTONLY='1'B;              /* INDICATE FORMAT REQUEST     1699 08364000
*                                                            @OZ05329*/ 08365000
         OI    FRMTONLY,B'10000000'                                1699 08366000
*       GOTO WSTFORMT;              /* GO FORMAT TABLE       @ZM30488*/ 08367000
         B     WSTFORMT                                            1700 08368000
*     END;                                                         1701 08369000
*   RFY                                                            1702 08370000
*    (REGSAPTR,                                                    1702 08371000
*     LOCKRC) RSTD;                                                1702 08372000
@RF01696 DS    0H                                                  1703 08373000
*   SAVAREA=REGSAPTR;               /* PRESERVE REG. 13              */ 08374000
         LR    SAVAREA,REGSAPTR                                    1703 08375000
*   REGSAPTR=ADDR(SETLOKSA);        /* PUT ADDR. OF 5 WORD SAVE AREA    08376000
*                                      FOR SETLOCK IN REG. 13        */ 08377000
         LA    REGSAPTR,SETLOKSA                                   1704 08378000
*/* TRY TO GET SALLOC LOCK, MAKE SETLOCK SAVE REG'S 11-14 IN SAVE    */ 08379000
*/* AREA POINTED TO BY REG. 13,  RETURN CODE WILL BE IN REG. 15      */ 08380000
*                                                                  1705 08381000
*GLOCK:                                                            1705 08382000
*   GEN REFS(FLC,PSALITA);                                         1705 08383000
GLOCK    DS    0H                                                  1705 08384000
         SETLOCK   OBTAIN,TYPE=SALLOC,MODE=UNCOND,REGS=SAVE,          XX08385000
               RELATED=('SALLOC LOCK, THIS SETLOCK IS ISSUED IN THIS  XX08386000
               MACRO WHICH IS INCLUDED IN VARIOUS MODULES, THE LOCK   XX08387000
               IS RELEASED AT THE LABEL: FLOCK, IN THIS MACRO')         08388000
*   REGSAPTR=SAVAREA;               /* RESTORE REGISTER 13           */ 08389000
         LR    REGSAPTR,SAVAREA                                    1706 08390000
*   RFY                                                            1707 08391000
*    (REGSAPTR) UNRSTD;                                            1707 08392000
*   RFY                                                            1708 08393000
*    (LNGREG) RSTD;                                                1708 08394000
*   IF LOCKRC=ZZERO|LOCKRC=FFOUR THEN/* WAS LOCK SET?                */ 08395000
         LTR   LOCKRC,LOCKRC                                       1709 08396000
         BZ    @RT01709                                            1709 08397000
         CH    LOCKRC,@CH00076                                     1709 08398000
         BNE   @RF01709                                            1709 08399000
@RT01709 DS    0H                                                  1710 08400000
*LOCKSET:                                                          1710 08401000
*     DO;                           /* YES PROCEED FOR GM/FM         */ 08402000
LOCKSET  DS    0H                                                  1711 08403000
*       RFY                                                        1711 08404000
*        (LOCKRC) UNRSTD;                                          1711 08405000
*       LNGREG=LGTH                 /* LENGTH IN REGISTER 0          */ 08406000
*           *8;                     /* LENGTH IN TABLE IS NUMBER OF     08407000
*                                      DOUBLE WORDS                  */ 08408000
         L     @14,CVTPTR                                          1712 08409000
         L     @14,CVTWSAC(,@14)                                   1712 08410000
         LH    LNGREG,LGTH(,@14)                                   1712 08411000
         SLA   LNGREG,3                                            1712 08412000
*       SBPOOL=SQAPOOL;             /* PUT SUBPOOL IN TABLE          */ 08413000
         MVI   SBPOOL,X'F5'                                        1713 08414000
*       STKEY=KEYZERO;              /* PROTECT KEY REQUESTED         */ 08415000
         MVI   STKEY,X'00'                                         1714 08416000
*       IF PARM=GETID THEN          /* GETMAIN OR FREEMAIN           */ 08417000
         LTR   PARM,PARM                                           1715 08418000
         BNZ   @RF01715                                            1715 08419000
*/********************************************************************/ 08420000
*/*                                                                  */ 08421000
*/*                   GETMAIN PATH                                   */ 08422000
*/*  REGISTER ONE CONTAINS ZERO ON INPUT FOR A GETMAIN REQUEST.      */ 08423000
*/*  IF R1 IS ZERO, THEN SPACE IS OBTAINED FOR A SA/WA AND VECTOR    */ 08424000
*/*  TABLE.  AFTER A SUCCESSFUL RETURN FROM GETMAIN, THE TABLE       */ 08425000
*/*  IS INITIALIZED.                                                 */ 08426000
*/*                                                                  */ 08427000
*/********************************************************************/ 08428000
*                                                                  1716 08429000
*GMAIN:                                                            1716 08430000
*         DO;                       /* GETMAIN PATH                  */ 08431000
GMAIN    DS    0H                                                  1717 08432000
*           FLAGS=CDGM;             /* CONDITIONAL GETMAIN           */ 08433000
         MVI   FLAGS,X'00'                                         1717 08434000
*           RFY                                                    1718 08435000
*            (GMREG,                                               1718 08436000
*             TBLPTR) RSTD;                                        1718 08437000
*           R3SAVAR=GMREG;          /* SAVE CONTENTS OF REG. 3       */ 08438000
         LR    R3SAVAR,GMREG                                       1719 08439000
*           GMREG=GMTBL;            /* PARMS IN REG. 3               */ 08440000
         L     GMREG,GMTBL                                         1720 08441000
*/* GETMAIN VECTOR TABLE AND SAVEAREAS FROM SUBPOOL 245              */ 08442000
*                                                                  1721 08443000
*SGTWSA:                                                           1721 08444000
*           GEN REFS(CVTSPSA,CVTGLMN,CVTPTR,CVTMAP,WSAGGMFM,WSAG); 1721 08445000
SGTWSA   DS    0H                                                  1721 08446000
         GETMAIN RC,LV=(0),BRANCH=(YES,GLOBAL),KEY=(3),SP=(3),        XX08447000
               RELATED=('SUPERVISOR ROUTINE WORK/SAVE AREAS FOR A CPU.XX08448000
               THIS GETMAIN IS ISSUED IN THIS MACRO WHICH IS INCLUDED XX08449000
               IN VARIOUS MODULES.  THE CORRESPONDING FREEMAIN IS AT  XX08450000
               LABEL: SFRWSA, IN THIS MACRO')                           08451000
*           GMREG=R3SAVAR;          /* RESTORE REG. 3, BRANCH ENTRY     08452000
*                                      TO GETMAIN DESTROYS REG. 3    */ 08453000
         LR    GMREG,R3SAVAR                                       1722 08454000
*           IF RTCODE^=ZZERO        /* ERROR IN GETMAIN              */ 08455000
*             THEN                  /* YES                           */ 08456000
         LTR   RTCODE,RTCODE                                       1723 08457000
         BZ    @RF01723                                            1723 08458000
*             HOLDRC=FFOUR;         /* RETAIN RETURN CODE            */ 08459000
         LA    HOLDRC,4                                            1724 08460000
*           ELSE                                                   1725 08461000
*WSTFORMT:                                                         1725 08462000
*             DO;                   /* INITIALIZE VECTOR TABLE     1725 08463000
*                                                            @ZM30488*/ 08464000
         B     @RC01723                                            1725 08465000
@RF01723 DS    0H                                                  1725 08466000
WSTFORMT DS    0H                                                  1726 08467000
*               HOLDRC=ZZERO;       /* RETAIN RETURN CODE            */ 08468000
         SLR   HOLDRC,HOLDRC                                       1726 08469000
*               P=TBLPTR;           /* POINT TO START OF TABLE       */ 08470000
         LR    P,TBLPTR                                            1727 08471000
*               SAPTR=TBLPTR+(NUM*FFOUR);/* GET PTR TO SAVEAREAS     */ 08472000
         L     @14,CVTPTR                                          1728 08473000
         L     @14,CVTWSAC(,@14)                                   1728 08474000
         LH    SAPTR,NUM(,@14)                                     1728 08475000
         SLA   SAPTR,2                                             1728 08476000
         ALR   SAPTR,TBLPTR                                        1728 08477000
*/* ROUND ADDR. OF FIRST WORK/SAVE AREA UP TO AN 8-BYTE MULT.  ALL   */ 08478000
*/* WORK/SAVE AREAS MUST BEGIN ON DOUBLE WORD BOUNDARIES.  ALL WORK/ */ 08479000
*/* SAVE AREAS ARE MULTIPLES OF 8 BYTES IN SIZE.  THUS IF THE FIRST  */ 08480000
*/* WORK/SAVE AREA IS ON A DOUBLE WORD BOUNDARY, THEY ALL WILL BE.   */ 08481000
*                                                                  1729 08482000
*               SAPTR=((SAPTR+7)|7)&&7;                            1729 08483000
         LA    @06,7                                               1729 08484000
         LR    @04,SAPTR                                           1729 08485000
         ALR   @04,@06                                             1729 08486000
         OR    @04,@06                                             1729 08487000
         XR    @04,@06                                             1729 08488000
         LR    SAPTR,@04                                           1729 08489000
*               RFY                                                1730 08490000
*                (TBLPTR) UNRSTD;                                  1730 08491000
*               NSIZEPTR=ADDR(FSIZE);/* PICK UP ADDR. OF FIELD     1731 08492000
*                                      CONTAINING FIRST WORK/SAVE  1731 08493000
*                                      AREA SIZE                     */ 08494000
         LA    @14,FSIZE(,@14)                                     1731 08495000
         ST    @14,NSIZEPTR                                        1731 08496000
*INTZE:                                                            1732 08497000
*               DO LOOP=LUPONE TO NUM;/* DO FOR EACH ENTRY IN VECTOR    08498000
*                                      TABLE                         */ 08499000
INTZE    LA    @14,1                                               1732 08500000
         B     @DE01732                                            1732 08501000
@DL01732 DS    0H                                                  1733 08502000
*                 SVPTR=SAPTR;      /* SET PTR TO SAVEAREA           */ 08503000
         ST    SAPTR,SVPTR(,P)                                     1733 08504000
*                 SAPTR=SAPTR+NWSASIZE;/* INCREMENT PTR BY SIZE OF 1734 08505000
*                                      SAVEAREA                      */ 08506000
         L     @06,NSIZEPTR                                        1734 08507000
         AH    SAPTR,NWSASIZE(,@06)                                1734 08508000
*                 P=P+LENGTH(SVPTR);/* POINT TO NEXT VECTOR TABLE  1735 08509000
*                                      ENTRY                         */ 08510000
         AH    P,@CH00076                                          1735 08511000
*                 NSIZEPTR=NSIZEPTR /* POINT TO NEXT SIZE            */ 08512000
*                     +LENGTH(NWSASIZE);                           1736 08513000
         AL    @06,@CF00177                                        1736 08514000
         ST    @06,NSIZEPTR                                        1736 08515000
*               END INTZE;                                         1737 08516000
         AL    @14,@CF00067                                        1737 08517000
@DE01732 ST    @14,LOOP                                            1737 08518000
         L     @06,CVTPTR                                          1737 08519000
         L     @06,CVTWSAC(,@06)                                   1737 08520000
         CH    @14,NUM(,@06)                                       1737 08521000
         BNH   @DL01732                                            1737 08522000
*             END;                  /* END PROCESSING FROM SUCCESSFUL   08523000
*                                      GETMAIN                       */ 08524000
*         END GMAIN;                                               1739 08525000
*       ELSE                                                       1740 08526000
*                                                                  1740 08527000
*/********************************************************************/ 08528000
*/*                                                                  */ 08529000
*/*                  FREEMAIN PATH                                   */ 08530000
*/*  REGISTER ONE CONTAINS THE ADDRESS OF THE AREA TO BE FREE'D.     */ 08531000
*/*  THIS REQUEST IS ONLY FROM VARY CPU OFFLINE, OR IEAVNIP0         */ 08532000
*/*                                                                  */ 08533000
*/********************************************************************/ 08534000
*                                                                  1740 08535000
*FMAIN:                                                            1740 08536000
*         DO;                       /* FREEMAIN PATH                 */ 08537000
         B     @RC01715                                            1740 08538000
@RF01715 DS    0H                                                  1740 08539000
FMAIN    DS    0H                                                  1741 08540000
*           RFY                                                    1741 08541000
*            (GMREG,                                               1741 08542000
*             LNGREG) RSTD;                                        1741 08543000
*           FLAGS=CDFM;             /* CONDITIONAL FREEMAIN          */ 08544000
         MVI   FLAGS,X'01'                                         1742 08545000
*           R3SAVAR=GMREG;          /* PRESERVE CONTENTS OF REG. 3   */ 08546000
         LR    R3SAVAR,GMREG                                       1743 08547000
*           GMREG=GMTBL;            /* PARMS IN REG. 3               */ 08548000
*                                                                  1744 08549000
         L     GMREG,GMTBL                                         1744 08550000
*           /*********************************************************/ 08551000
*           /*                                                       */ 08552000
*           /* FREEMAIN AREA PROVIDED BY CALLER (VARY CPU OFFLINE OR */ 08553000
*           /* NIP)                                                  */ 08554000
*           /*                                                       */ 08555000
*           /*********************************************************/ 08556000
*                                                                  1745 08557000
*SFRWSA:                                                           1745 08558000
*           GEN REFS(CVTSPSA,CVTGLMN,CVTPTR,CVTMAP,WSAGGMFM,WSAG); 1745 08559000
SFRWSA   DS    0H                                                  1745 08560000
         FREEMAIN      RC,LV=(0),BRANCH=(YES,GLOBAL),                 XX08561000
               KEY=(3),A=(1),SP=(3),                                  XX08562000
               RELATED=('SUPERVISOR ROUTINE WORK/SAVE AREAS FOR A CPU.XX08563000
               THIS FREEMAIN IS ISSUED IN THIS MACRO WHICH IS INCLUDEDXX08564000
               IN VARIOUS MODULES.  THE CORRESPONDING GETMAIN IS AT   XX08565000
               LABEL: SGTWSA, IN THIS MACRO')                           08566000
*           GMREG=R3SAVAR;          /* RESTORE REG. 3, BRANCH ENTRY     08567000
*                                      TO FREEMAIN DESTROYS REG. 3   */ 08568000
         LR    GMREG,R3SAVAR                                       1746 08569000
*           IF RTCODE^=ZZERO        /* ERROR                         */ 08570000
*             THEN                  /* YES                           */ 08571000
         LTR   RTCODE,RTCODE                                       1747 08572000
         BZ    @RF01747                                            1747 08573000
*             HOLDRC=FFOUR;         /* SET RETURN CODE               */ 08574000
         LA    HOLDRC,4                                            1748 08575000
*           ELSE                                                   1749 08576000
*             HOLDRC=ZZERO;         /* SAVE 0 RETURN CODE            */ 08577000
         B     @RC01747                                            1749 08578000
@RF01747 SLR   HOLDRC,HOLDRC                                       1749 08579000
*           RFY                                                    1750 08580000
*            (LNGREG,                                              1750 08581000
*             TBLPTR) UNRSTD;                                      1750 08582000
@RC01747 DS    0H                                                  1751 08583000
*           PARM=ZZERO;             /* INDICATOR FOR FREEMAIN        */ 08584000
         SLR   PARM,PARM                                           1751 08585000
*         END FMAIN;                                               1752 08586000
*       IF FRMTONLY='0'B THEN       /* RELEASE LOCK IF NECESSARY   1753 08587000
*                                                            @OZ05329*/ 08588000
@RC01715 TM    FRMTONLY,B'10000000'                                1753 08589000
         BNZ   @RF01753                                            1753 08590000
*         DO;                                                      1754 08591000
*           RFY                                                    1755 08592000
*            (LOCKRC,                                              1755 08593000
*             REGSAPTR) RSTD;                                      1755 08594000
*           SAVAREA=REGSAPTR;       /* PRESERVE REGISTER 13          */ 08595000
         LR    SAVAREA,REGSAPTR                                    1756 08596000
*           REGSAPTR=ADDR(SETLOKSA);/* PUT ADDR. OF 5 WORD SAVE AREA    08597000
*                                      FOR SETLOCK IN REG. 13        */ 08598000
         LA    REGSAPTR,SETLOKSA                                   1757 08599000
*/* RELEASE SALLOC LOCK, MAKE SETLOCK SAVE REG'S 11-14 IN SAVE AREA  */ 08600000
*/* POINTED TO BY REG. 13, RETURN CODE WILL BE IN REG. 15            */ 08601000
*                                                                  1758 08602000
*FLOCK:                                                            1758 08603000
*           GEN REFS(FLC,PSALITA);                                 1758 08604000
FLOCK    DS    0H                                                  1758 08605000
         SETLOCK RELEASE,TYPE=SALLOC,REGS=SAVE,                       **08606000
               RELATED=('SALLOC LOCK, THIS SETLOCK IS ISSUED IN THIS  XX08607000
               MACRO WHICH IS INCLUDED IN VARIOUS MODULES, THE LOCK   XX08608000
               IS OBTAINED AT THE LABEL: GLOCK, IN THIS MACRO')         08609000
*           REGSAPTR=SAVAREA;       /* RESTORE REGISTER 13           */ 08610000
         LR    REGSAPTR,SAVAREA                                    1759 08611000
*           RFY                                                    1760 08612000
*            (REGSAPTR) UNRSTD;                                    1760 08613000
*           IF(LOCKRC=ZZERO)|(LOCKRC=FFOUR)/* LOCK NOT RELEASED?     */ 08614000
*             THEN                                                 1761 08615000
         LTR   LOCKRC,LOCKRC                                       1761 08616000
         BZ    @RT01761                                            1761 08617000
         CH    LOCKRC,@CH00076                                     1761 08618000
         BNE   @RF01761                                            1761 08619000
@RT01761 DS    0H                                                  1762 08620000
*             RTCODE=HOLDRC;        /* RETURN CODE INDICATOR         */ 08621000
         LR    RTCODE,HOLDRC                                       1762 08622000
*           ELSE                                                   1763 08623000
*             RTCODE=FFOUR;         /* 0 RETURN FROM SETLOCK SET   1763 08624000
*                                      RETURN CODE TO THAT FROM    1763 08625000
*                                      GET/FREEMAIN                  */ 08626000
         B     @RC01761                                            1763 08627000
@RF01761 LA    RTCODE,4                                            1763 08628000
*           RFY                                                    1764 08629000
*            (LOCKRC) UNRSTD;                                      1764 08630000
@RC01761 DS    0H                                                  1765 08631000
*         END;                                                     1765 08632000
*       ELSE                        /* TURN FORMAT INDICATOR OFF     */ 08633000
*         FRMTONLY='0'B;            /* CLEAR INDICATOR               */ 08634000
         B     @RC01753                                            1766 08635000
@RF01753 NI    FRMTONLY,B'01111111'                                1766 08636000
*     END LOCKSET;                                                 1767 08637000
*   ELSE                            /* SETLOCK ERROR                 */ 08638000
*     RTCODE=FFOUR;                 /* RETURN CODE INDICATOR         */ 08639000
         B     @RC01709                                            1768 08640000
@RF01709 LA    RTCODE,4                                            1768 08641000
*   RFY                                                            1769 08642000
*    (PARM,                                                        1769 08643000
*     RTCODE) UNRSTD;                                              1769 08644000
*                                                                  1770 08645000
*/*IEAVSPSA: CHART (AMODE,SEQ,IBM68,AREF)                            */ 08646000
*/*IEAVSPSA: E ENTER                                                 */ 08647000
*/* N ON ENTRY IF REG. 1 IS ZERO, THE REQUEST IS TO ALLOCATE         */ 08648000
*/* N A CPU RELATED WORK/SAVE AREA.  IF REG. 1 IS NON-ZERO,          */ 08649000
*/* N THE REQUEST IS TO FREE A CPU RELATED WORK/SAVE AREA AND THE    */ 08650000
*/* N VIRT. ADDRESS OF THE AREA TO BE FREED IS IN REG. 1             */ 08651000
*/* P SAVE REGS EXCEPT REG. 1 AND REG. 15                            */ 08652000
*/* P SAVE REGISTER 13                                               */ 08653000
*/* P PUT ADDR. OF 5 WORD SAVEAREA FOR SETLOCK IN REG. 13            */ 08654000
*/* L SETLOCK TO OBTAIN 'SALLOC' LOCK                                */ 08655000
*/* P RESTORE REG. 13                                                */ 08656000
*/* D (YES,,NO,P2A1) WAS LOCK OBTAINED ?                             */ 08657000
*/* P PUT SIZE OF AREA TO BE GOTTEN/FREED IN REG. 0                  */ 08658000
*/* P INDICATE SUBPOOL 245 AND KEY 0 IN GET/FREEMAIN WORKAREA        */ 08659000
*/* D (YES,,NO,FMAIN) IS THIS A GETMAIN REQUEST ?                    */ 08660000
*/*GMAIN: P SET FLAGS IN GETMAIN WORKAREA FOR CONDITIONAL GETMAIN    */ 08661000
*/* P SAVE CONTENTS OF REGISTER 3                                    */ 08662000
*/* N BRANCH ENTRY TO GET/FREEMAIN DESTROYS REG. 3                   */ 08663000
*/* P PUT GETMAIN PARAMETERS IN REG. 3                               */ 08664000
*/*SGTWSA: L BRANCH TO GETMAIN TO ALLOC. WORK/SAVE AREA              */ 08665000
*/* N VIRT. ADDR. OF GOTTEN AREA IS IN REG. 1                        */ 08666000
*/* P RESTORE CONTENTS OF REGISTER 3                                 */ 08667000
*/* D (YES,,NO,P2A2) GETMAIN SUCCESSFUL ?                            */ 08668000
*/* P SET UP A CODE OF ZERO, TO BE RETURNED BY THIS MODULE           */ 08669000
*/* P CALC. VIRT. ADDR. OF FIRST SAVEAREA IN THE GOTTEN SPACE        */ 08670000
*/* P ROUND THIS ADDR. UP TO A DOUBLE WORD BOUNDARY                  */ 08671000
*/* P PICK UP ADDR. OF FIELD CONTAINING FIRST WORK/SAVE AREA SIZE    */ 08672000
*/* P PICK UP NUMBER OF SAVE AREAS TO BE BUILT                       */ 08673000
*/* P INITIALIZE A COUNTER OF SAVE AREAS BUILT TO 1                  */ 08674000
*/*INTZE: D (YES,P2B1,NO,) ALL SAVE AREAS BUILT ?                    */ 08675000
*/* P SET CURR. VECTOR TABLE ENTRY TO POINT TO CURR. SAVE AREA       */ 08676000
*/* P UPDATE POINTER TO NEXT SAVE AREA                               */ 08677000
*/* P UPDATE POINTER TO NEXT VECTOR TABLE ENTRY                      */ 08678000
*/* P (,INTZE) INCREMENT COUNTER BY 1                                */ 08679000
*/*P2A1: P SET UP A CODE OF 4, TO BE RETURNED BY THIS MODULE         */ 08680000
*/* P (,P2J5) PUT RETURN CODE FOR THIS MODULE IN REG. 15             */ 08681000
*/*P2A2: P (,P2B1) SET UP A CODE OF 4, TO BE RETURNED BY THIS MODULE */ 08682000
*/*FMAIN: P SET FLAGS IN FREEMAIN WORKAREA FOR CONDITIONAL FREEMAIN  */ 08683000
*/* P SAVE CONTENTS OF REGISTER 3                                    */ 08684000
*/* N BRANCH ENTRY TO GET/FREEMAIN DESTROYS REG. 3                   */ 08685000
*/* P PUT FREEMAIN PARAMETERS IN REG. 3                              */ 08686000
*/* N REG. 1 ALREADY CONTAINS THE VIRT. ADDR. OF AREA TO BE FREED    */ 08687000
*/*SFRWSA: L BRANCH TO FREEMAIN TO FREE WORK/SAVE AREA               */ 08688000
*/* P RESTORE CONTENTS OF REGISTER 3                                 */ 08689000
*/* D (YES,,NO,P2A3) FREEMAIN SUCCESSFUL ?                           */ 08690000
*/* P SET UP A CODE OF 0, TO BE RETURNED BY THIS MODULE              */ 08691000
*/*P2B1: P SAVE REG. 13                                              */ 08692000
*/* P PUT ADDR. OF 5 WORD SAVEAREA FOR SETLOCK IN REG. 13            */ 08693000
*/*FLOCK: L SETLOCK TO RELEASE 'SALLOC' LOCK                         */ 08694000
*/* P RESTORE REG. 13                                                */ 08695000
*/* D (YES,,NO,P2A4) WAS LOCK RELEASED ?                             */ 08696000
*/* P PUT RETURN CODE FOR THIS MODULE IN REG. 15                     */ 08697000
*/*P2J5: P RESTORE REGS EXCEPT REG. 1 AND REG. 15                    */ 08698000
*/* R RETURN TO CALLER                                               */ 08699000
*/*P2A3: P (,P2B1) SET UP A CODE OF 4, TO BE RETURNED BY THIS MODULE */ 08700000
*/*P2A4: P (,P2J5) SET RETURN CODE FOR THIS MODULE (REG. 15) TO 4    */ 08701000
*/*IEAVSPSA: END                                                     */ 08702000
*                                                                  1770 08703000
*   END IEAVSPSA;                                                  1770 08704000
*                                                                  1770 08705000
@EL00020 DS    0H                                                  1770 08706000
@EF00020 DS    0H                                                  1770 08707000
@ER00020 L     @14,12(,@13)                                        1770 08708000
         L     @00,20(,@13)                                        1770 08709000
         LM    @02,@12,28(@13)                                     1770 08710000
         BR    @14                                                 1770 08711000
*/* ******************************************************************/ 08712000
*/*             IEAVTSIN-------PROLOGUE                              */ 08713000
*/*                                                                  */ 08714000
*/*  MODULE NAME-IEAVTSIN                                            */ 08715000
*/*  DESCRIPTIVE NAME-FRR STACK INITIALIZATION INTERNAL PROCEDURE    */ 08716000
*/*  LOAD MODULE NAME - IEAVNIP0                                     */ 08717000
*/*  COPYRIGHT - N/A                                                 */ 08718000
*/*  STATUS - NEW FOR OS/VS2 RELEASE 2                               */ 08719000
*/*                                                                  */ 08720000
*/*  FUNCTION - INITIALIZES THE FRR                                  */ 08721000
*/*             STACKS DURING SYSTEM INITIALIZATION(NIP) AND FOR     */ 08722000
*/*             VARY CPU(ONLINE), SO THAT SETFRR RECOVERY CAN BE     */ 08723000
*/*             DEFINED.  THE FRR STACK INITIALIZATION IS IN TWO     */ 08724000
*/*             PARTS:                                               */ 08725000
*/*             1. INSURING THAT THE FRR STACKS ARE ADDRESSABLE OUT  */ 08726000
*/*                OF THE PSA.                                       */ 08727000
*/*             2. INITIALIZING EACH FRR STACK SO THAT THE SETFRR    */ 08728000
*/*                MACRO WILL OPERATE PROPERLY.                      */ 08729000
*/*                                                                  */ 08730000
*/*       I. THE RECOVERY STACK VECTOR TABLE(RSVT) IN THE PSA        */ 08731000
*/*          IS  INITIALIZED TO POINT TO THE RESPECTIVE FRR STACKS   */ 08732000
*/*          PSACSTK - POINTS TO THE CURRENT FRR STACK AND IS        */ 08733000
*/*                    INITIALIZED TO POINT TO THE NORMAL            */ 08734000
*/*                    FRR STACK                                     */ 08735000
*/*          PSASSTK - INITIALIZED TO POINT TO THE SVC-I/O-DISPATCHER*/ 08736000
*/*                    FRR STACK                                     */ 08737000
*/*          PSANSTK - INITIALIZED TO POINT TO THE NORMAL FRR STACK  */ 08738000
*/*                                                                  */ 08739000
*/*          PSAMSTK - INITIALIZED TO POINT TO THE MACHINE           */ 08740000
*/*                     CHECK FRR STACK                              */ 08741000
*/*          PSAPSTK - INITIALIZED TO POINT TO THE PROGRAM  CHECK    */ 08742000
*/*                     FRR STACK                                    */ 08743000
*/*          PSAESTK1 - INITIALIZED TO POINT TO THE EXTERNAL FLIH    */ 08744000
*/*                     FRR STACK(NON-RECURSIVE ENTRIES)             */ 08745000
*/*          PSAESTK2 - INITIALIZED TO POINT TO THE EXTERNAL FLIH    */ 08746000
*/*                     FRR STACK(FIRST LEVEL RECURSIONS)            */ 08747000
*/*          PSAESTK3 - INITIALIZED TO POINT TO THE EXTERNAL FLIH    */ 08748000
*/*                     FRR STACK(SECOND LEVEL RECURSIONS)           */ 08749000
*/*          PSARSTK - INITIALIZED TO POINT TO THE RESTART FLIH      */ 08750000
*/*                    FRR STACK                                     */ 08751000
*/*       II. THE SUPERVISOR CONTROL FRR STACK(S) INITIALIZATION     */ 08752000
*/*           IS PERFORMED AS FOLLOWS:                               */ 08753000
*/*           A. THE ENTIRE STACK IS ZEROED                          */ 08754000
*/*           B. THE STACK HEADER(4 WORDS) IS INITIALIZED TO APPEAR  */ 08755000
*/*              AS FOLLOWS:                                         */ 08756000
*/*              1ST WORD -POINTS TO THE FIRST FRR ENTRY IN THE STACK*/ 08757000
*/*              2ND WORD-POINTS TO THE LAST FRR ENTRY IN THE STACK  */ 08758000
*/*              3RD WORD-CONTAINS THE LENGTH OF EACH FRR ENTRY      */ 08759000
*/*              4TH WORD-CONTAINS THE SAME POINTER AS THE 1ST WORD  */ 08760000
*/*           C. THE FIRST STACK ENTRY IS INITALIZED TO POINT TO THE */ 08761000
*/*              SUPERVISOR CONTROL FRR(IEAVSCRU)                    */ 08762000
*/*              CVTSPFRR FIELD OF THE CVT CONTAINS THE ADDRESS OF   */ 08763000
*/*              THE SUPER FRR                                       */ 08764000
*/*                                                                  */ 08765000
*/*       III. THE NORMAL FRR STACK INITIALIZATION IS PERFORMED AS   */ 08766000
*/*            FOLLOWS:                                              */ 08767000
*/*           A. THE ENTIRE FRR STACK IS ZEROED                      */ 08768000
*/*           B. THE STACK HEADER(4 WORDS) IS INITIALIZED AS FOLLOWS */ 08769000
*/*              1ST WORD-CONTAINS THE ADDRESS OF THE FIRST FRR ENTRY*/ 08770000
*/*                       MINUS 32 BYTES                             */ 08771000
*/*              2ND WORD-CONTAINS THE ADDRESS OF THE LAST FRR ENTRY */ 08772000
*/*                       IN THE STACK                               */ 08773000
*/*              3RD WORD-CONTAINS THE LENGTH VALUE OF AN FRR ENTRY  */ 08774000
*/*              4TH WORD-CONTAINS THE SAME POINTER AS THE 1ST WORD  */ 08775000
*/*                                                                  */ 08776000
*/*  NOTES                                                           */ 08777000
*/*    CHARACTER CODE DEPENDENCIES - N/A                             */ 08778000
*/*    RESTRICTIONS -1.CALLER MUST INCLUDE THE PSA,CVT,FRR STACK     */ 08779000
*/*                (IHAFRRS) MAPPINGS AND INCLUDE THE IHAYSTAK MACRO */ 08780000
*/*                      PRIOR TO CALLING IEAVTSIN                   */ 08781000
*/*                     PRIOR TO INCLUDING IHAYSTAK SET THE MACRO    */ 08782000
*/*                     TIME VARIABLE %STKLENS='YES'                 */ 08783000
*/*                     THE PSA MAPPING MUST BE BASED ON PSAPTR      */ 08784000
*/*                  2. IEAVTSIN IS AN INTERNAL PROCEDURE IN IEAVNIP0*/ 08785000
*/*                      AND VARY CPU(ONLINE)                        */ 08786000
*/*                    AS SUCH IEAVTSIN ASSUMES ITS CALLERS          */ 08787000
*/*                     ATTRIBUTES AND DECLARATIONS                  */ 08788000
*/*                  3. ON EXIT FROM IEAVTSIN THE PSA IS RESTORED TO */ 08789000
*/*                    BASING THAT EXISTED WHEN THE PSA WAS DECLARED */ 08790000
*/*                    IN THE CALLERS PROCEDURE                      */ 08791000
*/*                                                                  */ 08792000
*/*  MODULE TYPE                                                     */ 08793000
*/*    PROCESSOR   - PLS2                                            */ 08794000
*/*    MODULE SIZE   - 300 BYTES                                     */ 08795000
*/*    ATTRIBUTES -     REENTRANT,DISABLED WITH DAT ACTIVE,KEY0      */ 08796000
*/*                                                                  */ 08797000
*/*  ENTRY POINT - IEAVTSIN                                          */ 08798000
*/*    PURPOSE - ENTRY BY NIP0 AND VARY CPU(ONLINE) SO THAT THE FRR  */ 08799000
*/*              STACKS CAN BE INITIALIZED                           */ 08800000
*/*    LINKAGE - STANDARD REGISTER LINKAGE                           */ 08801000
*/*              CALLERS REGISTERS ARE SAVED ON ENTRY AND RESTORED   */ 08802000
*/*              ON EXIT FROM IEAVTSIN                               */ 08803000
*/*    INPUT DATA - REGISTER 1 POINTS TO THE PSA TO BE INITIALIZED   */ 08804000
*/*                 REGISTER 13 POINTS TO A 72 BYTE REGISTER SAVE    */ 08805000
*/*                 AREA                                             */ 08806000
*/*                 IT IS ASSUMED BY IEAVTSIN THAT PSACSTK IS        */ 08807000
*/*                 INITIALIZED TO POINT TO A PREVIOUSLY ALLOCATED   */ 08808000
*/*                 AREA                                             */ 08809000
*/*                 8300 BYTES IN LENGTH TO CONTAIN THE FRR          */ 08810000
*/*                 STACKS AND RTCAS                                 */ 08811000
*/*    ENQ/LOCK CONDITIONS - ASSUMES THAT OF CALLING ROUTINE         */ 08812000
*/*    REGISTERS SAVED - ALL                                         */ 08813000
*/*    STATIC REGS - REGISTER 1 WILL ALWAYS POINT TO THE PSA TO BE   */ 08814000
*/*                  INITIALIZED                                     */ 08815000
*/*    REGISTERS RESTORED - ALL                                      */ 08816000
*/*                                                                  */ 08817000
*/*  EXIT - NORMAL                                                   */ 08818000
*/*    CONDITIONS - STANDARD RETURN LINKAGE                          */ 08819000
*/*    OUTPUT DATA - RSVT,FRR STACKS AND GLOBAL RTCAS ARE INITIALIZED*/ 08820000
*/*    ENQ/LOCK CONDITIONS - SAME AS ON ENTRY                        */ 08821000
*/*    RETURN CODES - NONE                                           */ 08822000
*/*                                                                  */ 08823000
*/*  EXIT ERROR - NONE                                               */ 08824000
*/*                                                                  */ 08825000
*/*  EXTERNAL REFERENCES                                             */ 08826000
*/*    ROUTINES - NONE                                               */ 08827000
*/*    DATASETS - NONE                                               */ 08828000
*/*    DATA AREAS -PSA,CVT,FRR STACKS,VECTOR TABLE OF LENGTHS OF     */ 08829000
*/*               FRR STACKS(MAPPED BY IHAYSTAK)                     */ 08830000
*/*    CONTROL BLOCKS - NONE                                         */ 08831000
*/*    TABLES - NONE                                                 */ 08832000
*/*    MACROS - NONE                                                 */ 08833000
*/*                                                                  */ 08834000
*/*  MAPPING MACROS USED - NONE                                      */ 08835000
*/*                                                                  */ 08836000
*/*  MESSAGES - NONE                                                 */ 08837000
*/*                                                                  */ 08838000
*/* ******************************************************************/ 08839000
*/*                                                                  */ 08840000
*/*                                                                  */ 08841000
*                                                                  1771 08842000
*IEAVTSIN:                                                         1771 08843000
*   PROC OPTIONS(SAVE,NOSAVEAREA);                                 1771 08844000
*                                                                  1771 08845000
IEAVTSIN STM   @14,@12,12(@13)                                     1771 08846000
*/*                                                                  */ 08847000
*                                                                  1772 08848000
*   DECLARE                                                        1772 08849000
*     1 STKADDR CHAR(4) BDY(WORD) DEF(PSACSTK),/* THE ADDRESS OF THE    08850000
*                                      STACK TO BE INITIALIZED       */ 08851000
*      2 * BIT(29),                 /* RESERVED                      */ 08852000
*      2 STKLW3BT BIT(3);           /* LOW ORDER 3 BITS OF THE FRR 1772 08853000
*                                      ADDRESS                       */ 08854000
*   DECLARE                                                        1773 08855000
*     WORDLEN FIXED(31) CONSTANT(4);/* NUMBER OF BYTES IN A FULLWORD */ 08856000
*   DECLARE                                                        1774 08857000
*     LOW3BITS BIT(3) CONSTANT('000'B);/* LOW ORDER 3 BITS OF A    1774 08858000
*                                      DOUBLE WORD ADDRESS           */ 08859000
*   DECLARE                                                        1775 08860000
*     FRRWALEN PTR(8) CONSTANT(200);/* LENGTH OF FRR WORK AREA     1775 08861000
*                                      ASSOCIATED WITH EACH RTCA     */ 08862000
*/*                                                                  */ 08863000
*/*                                                                  */ 08864000
*/* ******************************************************************/ 08865000
*/*                                                                  */ 08866000
*/*       DEFINE THE RTCA PORTION OF THE RECOVERY STACK              */ 08867000
*/*       AREA                                                       */ 08868000
*/*                                                                  */ 08869000
*/* ******************************************************************/ 08870000
*/*                                                                  */ 08871000
*                                                                  1776 08872000
*   DCL                                                            1776 08873000
*     NGRTCA CHAR(584) BDY(DWORD)   /* THE GLOBAL RTCA               */ 08874000
*         BASED(PSARSTK+FRRSFENT+(YSTAK(RSVTINDX)/* ASSOCIATED       */ 08875000
*         *FRRSESZE)+LENGTH(GRTCA)+FRRWALEN);/* WITH THE NORMAL STACK*/ 08876000
*   DCL                                                            1777 08877000
*     GRTCA CHAR(584) BDY(DWORD) BASED(PSACSTK+FRRSFENT+(YSTAK(RSVTINDX 08878000
*         )*FRRSESZE));             /* THE RTCA PORTION OF THE     1777 08879000
*                                      RECOVERY FRR STACK AREA       */ 08880000
*/*                                                                  */ 08881000
*/*                                                                  */ 08882000
*                                                                  1778 08883000
*   DECLARE                                                        1778 08884000
*     RSVTINDX PTR(31) REG(2) RESTRICTED,/* INDEX USED WITH THE RSVT */ 08885000
*     FRREINDX PTR(31) REG(3) RESTRICTED,/* INDEX USED WITH THE FRR     08886000
*                                      ENTRY                         */ 08887000
*     PSAREG PTR(31) REG(1);        /* POINTER TO PSA TO BE        1778 08888000
*                                      INITIALIZED                   */ 08889000
*/*                                                                  */ 08890000
*/*                                                                  */ 08891000
*/* ******************************************************************/ 08892000
*/*                                                                  */ 08893000
*/*   HOOK UP CONTROL BLOCKS                                         */ 08894000
*/*                                                                  */ 08895000
*/* ******************************************************************/ 08896000
*/*                                                                  */ 08897000
*                                                                  1779 08898000
*   RESPECIFY                                                      1779 08899000
*    (PSAREG) RESTRICTED;           /* RESTRICT REGISTER 1           */ 08900000
*   RESPECIFY                                                      1780 08901000
*    (PSA) BASED(PSAREG);           /* PSA ORIGIN-REGISTER 1         */ 08902000
*   RESPECIFY                                                      1781 08903000
*    (CVTMAP) BASED(FLCCVT);        /* CVT ORIGIN IN PSA             */ 08904000
*   RESPECIFY                                                      1782 08905000
*    (FRRS) BASED(PSACSTK);         /* ORIGIN OF FRR STACKS IN PSA   */ 08906000
*   RESPECIFY                                                      1783 08907000
*    (FRRSENTR) BASED(PSACSTK+((FRREINDX-YSTAKBEG)*FRRSESZE)+FRRSFENT); 08908000
*                                   /* ORIGIN OF RESPECTIVE FRR    1784 08909000
*                                      STACKS IN PSA                 */ 08910000
*/*                                                                  */ 08911000
*/* ******************************************************************/ 08912000
*/*                                                                  */ 08913000
*/*     FRR STACK HEADER AND RSVT INITIALIZATION                     */ 08914000
*/*                                                                  */ 08915000
*/* ******************************************************************/ 08916000
*/*                                                                  */ 08917000
*                                                                  1784 08918000
*   DO RSVTINDX=YSTAKBEG TO DIM(YSTAK);/* BEGIN INITIALIZATION       */ 08919000
         LA    RSVTINDX,1                                          1784 08920000
@DL01784 DS    0H                                                  1785 08921000
*     IF RSVTINDX=DIM(YSTAK) THEN   /* CHECK FOR THE NORMAL STACK  1785 08922000
*                                      POINTS TO A NON DOUBLEWORD  1785 08923000
*                                      THEN LEAVE IT ALONE           */ 08924000
         CH    RSVTINDX,@CH00036                                   1785 08925000
         BNE   @RF01785                                            1785 08926000
*       DO;                                                        1786 08927000
*         PSANSTK=ADDR(PSASTAK);    /* POINT TO NORMAL STACK OUT OF     08928000
*                                      THE PSA RSVT                  */ 08929000
         LA    @12,PSASTAK(,PSAREG)                                1787 08930000
         ST    @12,PSANSTK(,PSAREG)                                1787 08931000
*         PSACSTK=PSANSTK;          /* MAKE NORMAL STAK CURRENT      */ 08932000
         ST    @12,PSACSTK(,PSAREG)                                1788 08933000
*         FRRSEMP=(PSACSTK+FRRSFENT)-FRRSESZE;/* INITIALIZE EMPTY  1789 08934000
*                                      POINTER IN HEADER             */ 08935000
         LR    @06,@12                                             1789 08936000
         SH    @06,@CH03999                                        1789 08937000
         ST    @06,FRRSEMP(,@12)                                   1789 08938000
*       END;                                                       1790 08939000
*     ELSE                          /* OTHERWISE DO THE FOLLOWING    */ 08940000
*       DO;                         /* FOR SUPER FRR STACKS          */ 08941000
         B     @RC01785                                            1791 08942000
@RF01785 DS    0H                                                  1792 08943000
*         IF STKLW3BT=LOW3BITS THEN /* IF THE FRR STACK ADDRESS    1792 08944000
*                                      POINTS TO A DOUBLE WORD THEN     08945000
*                                      IT MUST BE ALLIGNED TO A    1792 08946000
*                                      DOUBLE WORD                   */ 08947000
         TM    STKLW3BT(PSAREG),B'00000111'                        1792 08948000
         BNZ   @RF01792                                            1792 08949000
*           PSACSTK=PSACSTK+WORDLEN;/* THE FRR STACK ADDRESS TO A NON   08950000
*                                      DOUBLEWORD                    */ 08951000
         LA    @12,4                                               1793 08952000
         AL    @12,PSACSTK(,PSAREG)                                1793 08953000
         ST    @12,PSACSTK(,PSAREG)                                1793 08954000
*         ELSE                                                     1794 08955000
*           ;                       /* IF THE FRR STACK ADDRESS    1794 08956000
*                                      POINTS TO A NON DOUBLEWORD  1794 08957000
*                                      THEN LEAVE IT ALONE           */ 08958000
@RF01792 DS    0H                                                  1795 08959000
*         PSARSVT(2*RSVTINDX+1)=PSACSTK;/* SET POINTER TO SUPER STACK   08960000
*                                      IN PSA RSVT                   */ 08961000
         LR    @12,RSVTINDX                                        1795 08962000
         SLA   @12,3                                               1795 08963000
         L     @06,PSACSTK(,PSAREG)                                1795 08964000
         ST    @06,PSARSVT(@12,PSAREG)                             1795 08965000
*         PSARSVT(2*RSVTINDX+YSTAKTWO)=YSTAKZRO;/* ZERO THE POINTER     08966000
*                                      TO THE SAVED STACK IN PSA RSVT*/ 08967000
         SLR   @06,@06                                             1796 08968000
         ST    @06,PSARSVT+4(@12,PSAREG)                           1796 08969000
*         FRRSEMP=PSACSTK+FRRSFENT; /* SET EMPTY STACK POINTER IN  1797 08970000
*                                      HEADER OF STACK               */ 08971000
         L     @12,PSACSTK(,PSAREG)                                1797 08972000
         LA    @06,84                                              1797 08973000
         ALR   @06,@12                                             1797 08974000
         ST    @06,FRRSEMP(,@12)                                   1797 08975000
*       END;                                                       1798 08976000
*     FRRSCURR=FRRSEMP;             /* SET CURRENT STACK POINTER IN     08977000
*                                      STACK HEADER                  */ 08978000
@RC01785 L     @12,PSACSTK(,PSAREG)                                1799 08979000
         MVC   FRRSCURR(4,@12),FRRSEMP(@12)                        1799 08980000
*     FRRSLAST=PSACSTK+FRRSFENT+((YSTAK(RSVTINDX)*FRRSESZE)-FRRSESZE);  08981000
         LA    @06,84                                              1800 08982000
         ALR   @06,@12                                             1800 08983000
         LA    @04,32                                              1800 08984000
         LR    @15,RSVTINDX                                        1800 08985000
         SLA   @15,2                                               1800 08986000
         L     @00,YSTAK-4(@15)                                    1800 08987000
         SLA   @00,5                                               1800 08988000
         SLR   @00,@04                                             1800 08989000
         ALR   @06,@00                                             1800 08990000
         ST    @06,FRRSLAST(,@12)                                  1800 08991000
*                                   /* SET POINTER TO LAST ENTRY IN     08992000
*                                      STACK                         */ 08993000
*     FRRSELEN=FRRSESZE;            /* SET ENTRY LENGTH IN STACK   1801 08994000
*                                      HEADER                        */ 08995000
         ST    @04,FRRSELEN(,@12)                                  1801 08996000
*     FRRSRTMW=''B;                 /* ZERO RTM1WA                   */ 08997000
         XC    FRRSRTMW(68,@12),FRRSRTMW(@12)                      1802 08998000
*/*                                                                  */ 08999000
*/* ******************************************************************/ 09000000
*/*                                                                  */ 09001000
*/*       INDIVIDUAL ENTRY INITIALIZATION FOR THE FRR STACK          */ 09002000
*/*                                                                  */ 09003000
*/* ******************************************************************/ 09004000
*/*                                                                  */ 09005000
*                                                                  1803 09006000
*     DO FRREINDX=YSTAKBEG TO YSTAK(RSVTINDX);/* INITIALIZE FRR    1803 09007000
*                                      ENTRIES                       */ 09008000
         LA    FRREINDX,1                                          1803 09009000
         B     @DE01803                                            1803 09010000
@DL01803 DS    0H                                                  1804 09011000
*       FRRSENTR=''B;               /* ZERO THE ENTRY                */ 09012000
         LR    @12,FRREINDX                                        1804 09013000
         BCTR  @12,0                                               1804 09014000
         SLA   @12,5                                               1804 09015000
         AL    @12,PSACSTK(,PSAREG)                                1804 09016000
         AH    @12,@CH02097                                        1804 09017000
         XC    FRRSENTR(32,@12),FRRSENTR(@12)                      1804 09018000
*       IF(RSVTINDX<DIM(YSTAK))&(FRREINDX=YSTAKBEG) THEN/* IF THIS IS   09019000
*                                      THE FIRST ENTRY IN A SUPER  1805 09020000
*                                      STACK DO FOLLOWING            */ 09021000
         CH    RSVTINDX,@CH00036                                   1805 09022000
         BNL   @RF01805                                            1805 09023000
         CH    FRREINDX,@CH00067                                   1805 09024000
         BNE   @RF01805                                            1805 09025000
*         DO;                                                      1806 09026000
*           FRRSFRRA=CVTSPFRR;      /* INITIALIZE THE SUPER FRR    1807 09027000
*                                      ADDRESS                       */ 09028000
         L     @06,FLCCVT(,PSAREG)                                 1807 09029000
         MVC   FRRSFRRA(4,@12),CVTSPFRR(@06)                       1807 09030000
*         END;                                                     1808 09031000
*       ELSE                                                       1809 09032000
*         ;                         /* OTHERWISE CONTINUE            */ 09033000
@RF01805 DS    0H                                                  1810 09034000
*     END;                          /* CONTINUE IF MORE FRR ENTRIES     09035000
*                                      TO INITIALIZE                 */ 09036000
*                                                                  1810 09037000
         AL    FRREINDX,@CF00067                                   1810 09038000
@DE01803 LR    @12,RSVTINDX                                        1810 09039000
         SLA   @12,2                                               1810 09040000
         C     FRREINDX,YSTAK-4(@12)                               1810 09041000
         BNH   @DL01803                                            1810 09042000
*     /***************************************************************/ 09043000
*     /*                                                             */ 09044000
*     /* ZERO RTCA ASSOCIATED WITH FRR STACK                         */ 09045000
*     /*                                                             */ 09046000
*     /***************************************************************/ 09047000
*                                                                  1811 09048000
*     IF RSVTINDX<DIM(YSTAK) THEN   /* IF A SUPER STACK IS BEING   1811 09049000
*                                      INITIALIZED ZERO RTCA         */ 09050000
         CH    RSVTINDX,@CH00036                                   1811 09051000
         BNL   @RF01811                                            1811 09052000
*       DO;                                                        1812 09053000
*         GRTCA(1:256)=''B;                                        1813 09054000
         LA    @12,84                                              1813 09055000
         AL    @12,PSACSTK(,PSAREG)                                1813 09056000
         LR    @06,RSVTINDX                                        1813 09057000
         SLA   @06,2                                               1813 09058000
         L     @06,YSTAK-4(@06)                                    1813 09059000
         SLA   @06,5                                               1813 09060000
         ALR   @12,@06                                             1813 09061000
         XC    GRTCA(256,@12),GRTCA(@12)                           1813 09062000
*         GRTCA((256+1):(256+256))=''B;                            1814 09063000
         XC    GRTCA+256(256,@12),GRTCA+256(@12)                   1814 09064000
*         GRTCA((256+256+1):LENGTH(GRTCA))=''B;                    1815 09065000
         XC    GRTCA+512(72,@12),GRTCA+512(@12)                    1815 09066000
*       END;                                                       1816 09067000
*     ELSE                          /* IF THE NORMAL STACK IS BEING     09068000
*                                      INITIALIZED ZERO ITS RTCA     */ 09069000
*       DO;                                                        1817 09070000
         B     @RC01811                                            1817 09071000
@RF01811 DS    0H                                                  1818 09072000
*         NGRTCA(1:256)=''B;                                       1818 09073000
         LA    @12,84                                              1818 09074000
         AL    @12,PSARSTK(,PSAREG)                                1818 09075000
         LR    @06,RSVTINDX                                        1818 09076000
         SLA   @06,2                                               1818 09077000
         L     @06,YSTAK-4(@06)                                    1818 09078000
         SLA   @06,5                                               1818 09079000
         ALR   @12,@06                                             1818 09080000
         AH    @12,@CH04002                                        1818 09081000
         XC    NGRTCA(256,@12),NGRTCA(@12)                         1818 09082000
*         NGRTCA((256+1):(256+256))=''B;                           1819 09083000
         XC    NGRTCA+256(256,@12),NGRTCA+256(@12)                 1819 09084000
*         NGRTCA((256+256+1):LENGTH(GRTCA))=''B;                   1820 09085000
         XC    NGRTCA+512(72,@12),NGRTCA+512(@12)                  1820 09086000
*       END;                                                       1821 09087000
*                                                                  1821 09088000
*     /***************************************************************/ 09089000
*     /*                                                             */ 09090000
*     /*                                                             */ 09091000
*     /***************************************************************/ 09092000
*                                                                  1822 09093000
*     PSACSTK=ADDR(GRTCA)+LENGTH(GRTCA)+FRRWALEN;/* UPDATE FOR NEXT     09094000
*                                      STACK                         */ 09095000
@RC01811 LA    @12,84                                              1822 09096000
         AL    @12,PSACSTK(,PSAREG)                                1822 09097000
         LR    @06,RSVTINDX                                        1822 09098000
         SLA   @06,2                                               1822 09099000
         L     @06,YSTAK-4(@06)                                    1822 09100000
         SLA   @06,5                                               1822 09101000
         ALR   @12,@06                                             1822 09102000
         AH    @12,@CH04002                                        1822 09103000
         ST    @12,PSACSTK(,PSAREG)                                1822 09104000
*   END;                            /* CONTINUE IF MORE STACKS TO  1823 09105000
*                                      INITIALIZE                    */ 09106000
         AL    RSVTINDX,@CF00067                                   1823 09107000
         CH    RSVTINDX,@CH00036                                   1823 09108000
         BNH   @DL01784                                            1823 09109000
*   PSACSTK=PSANSTK;                /* SET CURRENT TO NORMAL         */ 09110000
         L     @12,PSANSTK(,PSAREG)                                1824 09111000
         ST    @12,PSACSTK(,PSAREG)                                1824 09112000
*   FRRSEMP=FRRSEMP-ADDR(PSA);      /*                       @YM02619*/ 09113000
         L     @06,FRRSEMP(,@12)                                   1825 09114000
         SLR   @06,PSAREG                                          1825 09115000
         ST    @06,FRRSEMP(,@12)                                   1825 09116000
*   FRRSLAST=FRRSLAST-ADDR(PSA);    /*                       @YM02619*/ 09117000
         L     @04,FRRSLAST(,@12)                                  1826 09118000
         SLR   @04,PSAREG                                          1826 09119000
         ST    @04,FRRSLAST(,@12)                                  1826 09120000
*   FRRSCURR=FRRSEMP;               /*                       @YM02619*/ 09121000
         ST    @06,FRRSCURR(,@12)                                  1827 09122000
*   PSACSTK=ADDR(PSASTAK)-ADDR(PSA);/*                       @YM02619*/ 09123000
         LA    @12,3072                                            1828 09124000
         ST    @12,PSACSTK(,PSAREG)                                1828 09125000
*   PSANSTK=PSACSTK;                /*                       @YM02619*/ 09126000
         ST    @12,PSANSTK(,PSAREG)                                1829 09127000
*   RESPECIFY                                                      1830 09128000
*    (PSAREG) UNRESTRICTED;         /* RELEASE REGISTER 1            */ 09129000
*   RESPECIFY                                                      1831 09130000
*     PSA;                          /* REESTABLISH ORIGINAL BASE FOR    09131000
*                                      THE PSA                       */ 09132000
*   END IEAVTSIN;                   /* END IEAVTSIN PROCEDURE        */ 09133000
@EL00021 DS    0H                                                  1832 09134000
@EF00021 DS    0H                                                  1832 09135000
@ER00021 LM    @14,@12,12(@13)                                     1832 09136000
         BR    @14                                                 1832 09137000
*                                                                  1833 09138000
*/********************************************************************/ 09139000
*/*                                                                  */ 09140000
*/*SEGMENT-                                                          */ 09141000
*/*          CHECKIO                                                 */ 09142000
*/*                                                                  */ 09143000
*/*FUNCTION-                                                         */ 09144000
*/*          IF THE PROCESSOR HAS NO CHANNELS ONLINE THEN INDICATE   */ 09145000
*/*          IT NOLONGER HAS I/O ABILITY.                            */ 09146000
*/*                                                                  */ 09147000
*/*OPERATION-                                                        */ 09148000
*/*          TENTATIVELY INDICATE THAT THE PROCESSOR NO LONGER HAS   */ 09149000
*/*          I/O ABILITY                                             */ 09150000
*/*                                                                  */ 09151000
*/*          SEARCH THRU ALL THE ENTRIES OF THE CHANNEL ACTIVITY     */ 09152000
*/*          TABLE AND IF A CHANNEL IS FOUND TO STILL BE ONLINE      */ 09153000
*/*          THEN INDICATE THAT THIS PROCESSOR HAS I/O ABILITY       */ 09154000
*/*                                                                  */ 09155000
*/*CHANGE ACTIVITY-                                                  */ 09156000
*/*      @G47AN2O-                                                   */ 09157000
*/*          158 ATTACHED PROCESSOR SUPPORT                          */ 09158000
*/*                                                                  */ 09159000
*/********************************************************************/ 09160000
*                                                                  1833 09161000
*CHECKIO:                                                          1833 09162000
*   PROCEDURE;                                                     1833 09163000
CHECKIO  STM   @14,@12,12(@13)                                     1833 09164000
*   PCCAIO=NOIO;                    /* TENTATIVELY: NO I/O ABILITY   */ 09165000
         L     @12,PCCAPTR                                         1834 09166000
         NI    PCCAIO(@12),B'10111111'                             1834 09167000
*   CATPTR=ADDR(PCCACAT);           /* ADDR OF FIRST CAT ENTRY       */ 09168000
         LA    CATPTR,PCCACAT(,@12)                                1835 09169000
*   DO I=0 TO 15                    /* CHECK ALL CATS                */ 09170000
*         WHILE(PCCAIO=NOIO);       /* NO I/O ABILITY                */ 09171000
         SLR   I,I                                                 1836 09172000
@DL01836 L     @12,PCCAPTR                                         1836 09173000
         TM    PCCAIO(@12),B'01000000'                             1836 09174000
         BNZ   @DC01836                                            1836 09175000
*     IF CATNOP='0'B                /* FOUND A CHANNEL ONLINE        */ 09176000
*       THEN                                                       1837 09177000
         TM    CATNOP(CATPTR),B'01000000'                          1837 09178000
         BNZ   @RF01837                                            1837 09179000
*       PCCAIO=HASIO;               /* PROCESSOR HAS I/O ABILITY     */ 09180000
         OI    PCCAIO(@12),B'01000000'                             1838 09181000
*     ELSE                                                         1839 09182000
*       CATPTR=CATPTR+              /* INCREMENT TO NEXT CAT         */ 09183000
*           LENGTH(CAT);                                           1839 09184000
         B     @RC01837                                            1839 09185000
@RF01837 AH    CATPTR,@CH00036                                     1839 09186000
*   END;                                                           1840 09187000
@RC01837 AL    I,@CF00067                                          1840 09188000
         CH    I,@CH00344                                          1840 09189000
         BNH   @DL01836                                            1840 09190000
@DC01836 DS    0H                                                  1841 09191000
*   END CHECKIO;                                                   1841 09192000
@EL00022 DS    0H                                                  1841 09193000
@EF00022 DS    0H                                                  1841 09194000
@ER00022 LM    @14,@12,12(@13)                                     1841 09195000
         BR    @14                                                 1841 09196000
*                                                                  1842 09197000
*/********************************************************************/ 09198000
*/*                                                                  */ 09199000
*/*DEFINE-                                                           */ 09200000
*/*          EPILOGUE                                                */ 09201000
*/*                                                                  */ 09202000
*/********************************************************************/ 09203000
*                                                                  1842 09204000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 09205000
*     GPR00F FIXED(31) REG(0),                                     1842 09206000
*     GPR12F FIXED(31) REG(12),                                    1842 09207000
*     GPR15F FIXED(31) REG(15),                                    1842 09208000
*     GPR00P PTR(31) REG(0),                                       1842 09209000
*     GPR01P PTR(31) REG(1),                                       1842 09210000
*     GPR02P PTR(31) REG(2),                                       1842 09211000
*     GPR13P PTR(31) REG(13),                                      1842 09212000
*     GPR14P PTR(31) REG(14),                                      1842 09213000
*     GPR15P PTR(31) REG(15);                                      1842 09214000
*   DCL                                                            1843 09215000
*     1 I004 DEF(ILIST) BDY(WORD),  /* LIST FOR GETMAIN              */ 09216000
*      2 I00401 PTR(31),            /* LENGTH                        */ 09217000
*      2 I00402 CHAR(1),            /* HIARCHY                       */ 09218000
*      2 I00403 PTR(24),            /* ADDR OF ADDR LIST             */ 09219000
*      2 I00404 CHAR(1),            /* TYPE OF REQUEST               */ 09220000
*      2 I00405 PTR(8);             /* SUBPOOL VALUE                 */ 09221000
*   DCL                                                            1844 09222000
*     1 I005 DEF(ILIST) BDY(WORD),  /* LIST FOR FREEMAIN             */ 09223000
*       3 I00501 PTR(8),            /* RESERVED                      */ 09224000
*       3 I00502 PTR(24),           /* LENGTH                        */ 09225000
*       3 I00503 PTR(8),            /* RESERVED                      */ 09226000
*       3 I00504 PTR(24),           /* ADDR OF ADDR LIST             */ 09227000
*       3 I00505 BIT(8),            /* TYPE OF FREEMAIN              */ 09228000
*       3 I00506 PTR(8);            /* SUBPOOL VALUE                 */ 09229000
*   DCL                                                            1845 09230000
*     1 I006 DEF(ILIST),            /* DEFINE LIST                   */ 09231000
*      2 I00601 CHAR(1),            /* EP/DE FLAG                    */ 09232000
*      2 I00602 PTR(24),            /* EP/DE PTR                     */ 09233000
*      2 I00603 CHAR(1),            /* ERRET FLAG                    */ 09234000
*      2 I00604 PTR(24),            /* DCB PTR                       */ 09235000
*      2 I00605 PTR(31);            /* ERRET PTR                     */ 09236000
*   DCL                                                            1846 09237000
*     1 I056 DEF(ILIST) BDY(WORD) CHAR(32767),/* LIST FOR ENQ        */ 09238000
*       3 I05601 PTR(31),           /* TCB OR ECB ADDRESS            */ 09239000
*       3 I05602(*) CHAR(12) BDY(WORD),/* ARRAY OF RESOURCE ELEMENTS */ 09240000
*         5 I05603 BIT(8),          /* BIT FLAGS 1                   */ 09241000
*         5 I05604 PTR(8),          /* MINOR RESOURCE NAME LENGTH    */ 09242000
*         5 I05605 BIT(8),          /* BIT FLAGS 2                   */ 09243000
*         5 I05655 CHAR(1),         /* CONTROL PGM USE               */ 09244000
*         5 I05606 PTR(31),         /* MAJOR RESOURCE NAME ADDR      */ 09245000
*         5 I05607 PTR(31);         /* MINOR RESOURCE NAME ADDR      */ 09246000
*   DECLARE                                                        1847 09247000
*     ILIST CHAR(16) BDY(DWORD);    /* STANDARD LIST                 */ 09248000
*   DECLARE                         /* COMMON VARIABLES              */ 09249000
*     I256C CHAR(256) BASED,                                       1848 09250000
*     I031F FIXED(31) BASED,                                       1848 09251000
*     I031P PTR(31) BASED,                                         1848 09252000
*     I015F FIXED(15) BASED,                                       1848 09253000
*     I015P PTR(15) BASED,                                         1848 09254000
*     I008P PTR(8) BASED,                                          1848 09255000
*     I001C CHAR(1) BASED;                                         1848 09256000
*   DECLARE                                                        1849 09257000
*     IOPTLIST(3) PTR(31) BDY(WORD);/* OPTION LIST ARRAY             */ 09258000
*   END IEEVCPU                                                    1850 09259000
*                                                                  1850 09260000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 09261000
*/*%INCLUDE SYSUT5  (FL1     )                                       */ 09262000
*/*%INCLUDE SYSUT5  (MAINLINE)                                       */ 09263000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 09264000
*/*%INCLUDE SYSLIB  (IEECHAIN)                                       */ 09265000
*/*%INCLUDE SYSLIB  (IHAPCCAT)                                       */ 09266000
*/*%INCLUDE SYSLIB  (IHAPCCA )                                       */ 09267000
*/*%INCLUDE SYSLIB  (IHALCCAT)                                       */ 09268000
*/*%INCLUDE SYSLIB  (IHALCCA )                                       */ 09269000
*/*%INCLUDE SYSLIB  (IECDCAT )                                       */ 09270000
*/*%INCLUDE SYSLIB  (IHARVT  )                                       */ 09271000
*/*%INCLUDE SYSLIB  (IHACSD  )                                       */ 09272000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 09273000
*/*%INCLUDE SYSLIB  (IHAASVT )                                       */ 09274000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 09275000
*/*%INCLUDE SYSLIB  (IHAYSTAK)                                       */ 09276000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 09277000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 09278000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 09279000
*/*%INCLUDE SYSLIB  (IEECUCM )                                       */ 09280000
*/*%INCLUDE SYSLIB  (IHAESTA )                                       */ 09281000
*/*%INCLUDE SYSLIB  (IEFZB431)                                       */ 09282000
*/*%INCLUDE SYSLIB  (IECDIRT )                                       */ 09283000
*/*%INCLUDE SYSLIB  (IECDIOCM)                                       */ 09284000
*/*%INCLUDE SYSLIB  (IECDIOCX)                                       */ 09285000
*/*%INCLUDE SYSLIB  (IEZSSC  )                                       */ 09286000
*/*%INCLUDE SYSUT5  (SYNTXCHK)                                       */ 09287000
*/*%INCLUDE SYSUT5  (AUTHCHK )                                       */ 09288000
*/*%INCLUDE SYSUT5  (OFFLINE )                                       */ 09289000
*/*%INCLUDE SYSUT5  (CHKCHNL )                                       */ 09290000
*/*%INCLUDE SYSUT5  (CPUSRCH )                                       */ 09291000
*/*%INCLUDE SYSUT5  (AFFINSRC)                                       */ 09292000
*/*%INCLUDE SYSUT5  (DEVPREP )                                       */ 09293000
*/*%INCLUDE SYSUT5  (PATHMAP )                                       */ 09294000
*/*%INCLUDE SYSUT5  (TMRCNSL )                                       */ 09295000
*/*%INCLUDE SYSUT5  (CHANNEL )                                       */ 09296000
*/*%INCLUDE SYSUT5  (DSPTCHK )                                       */ 09297000
*/*%INCLUDE SYSUT5  (GTFOFF  )                                       */ 09298000
*/*%INCLUDE SYSUT5  (GTFOFF  )                                       */ 09299000
*/*%INCLUDE SYSUT5  (FREEMCEL)                                       */ 09300000
*/*%INCLUDE SYSUT5  (FREEMCEL)                                       */ 09301000
*/*%INCLUDE SYSUT5  (ONLINE  )                                       */ 09302000
*/*%INCLUDE SYSUT5  (CHANON  )                                       */ 09303000
*/*%INCLUDE SYSUT5  (PREPARE )                                       */ 09304000
*/*%INCLUDE SYSUT5  (RMSEXIT )                                       */ 09305000
*/*%INCLUDE SYSUT5  (RTMEXIT )                                       */ 09306000
*/*%INCLUDE SYSUT5  (GTFEXIT )                                       */ 09307000
*/*%INCLUDE SYSUT5  (TRCKRST )                                       */ 09308000
*/*%INCLUDE SYSUT5  (PAGEFIX )                                       */ 09309000
*/*%INCLUDE SYSUT5  (PATHVAL )                                       */ 09310000
*/*%INCLUDE SYSUT5  (DEVCHK  )                                       */ 09311000
*/*%INCLUDE SYSUT5  (UCBMARK )                                       */ 09312000
*/*%INCLUDE SYSUT5  (PSAFREE )                                       */ 09313000
*/*%INCLUDE SYSUT5  (CONVERT )                                       */ 09314000
*/*%INCLUDE SYSUT5  (UCBRCRDR)                                       */ 09315000
*/*%INCLUDE SYSUT5  (IEEVIOQ )                                       */ 09316000
*/*%INCLUDE SYSUT5  (PSACCA  )                                       */ 09317000
*/*%INCLUDE SYSUT5  (PSASETUP)                                       */ 09318000
*/*%INCLUDE SYSUT5  (CCASETUP)                                       */ 09319000
*/*%INCLUDE SYSUT5  (GETCORE )                                       */ 09320000
*/*%INCLUDE SYSUT5  (FREECORE)                                       */ 09321000
*/*%INCLUDE SYSUT5  (SAVARSUB)                                       */ 09322000
*/*%INCLUDE SYSUT5  (AINIT   )                                       */ 09323000
*/*%INCLUDE SYSUT5  (DISASSOC)                                       */ 09324000
*/*%INCLUDE SYSUT5  (FRRRTN  )                                       */ 09325000
*/*%INCLUDE SYSUT5  (ESTAERTN)                                       */ 09326000
*/*%INCLUDE SYSLIB  (IEAVSPSA)                                       */ 09327000
*/*%INCLUDE SYSLIB  (IHAWSAVT)                                       */ 09328000
*/*%INCLUDE SYSLIB  (IEAVTSIN)                                       */ 09329000
*                                                                  1850 09330000
*       ;                                                          1850 09331000
@DATA    DS    0H                                                       09332000
@CH00074 DC    H'3'                                                     09333000
@CH00076 DC    H'4'                                                     09334000
@CH00036 DC    H'8'                                                     09335000
@CH01603 DC    H'10'                                                    09336000
@CH00055 DC    H'16'                                                    09337000
@CH00228 DC    H'20'                                                    09338000
@CH02097 DC    H'84'                                                    09339000
@CH03789 DC    H'183'                                                   09340000
@CH03790 DC    H'240'                                                   09341000
@CH01762 DC    H'512'                                                   09342000
@CH03961 DC    H'584'                                                   09343000
@CH04002 DC    H'784'                                                   09344000
@CH03997 DC    H'1552'                                                  09345000
@CH03995 DC    H'4096'                                                  09346000
@CH03741 DC    H'5000'                                                  09347000
@CH02073 DC    H'9324'                                                  09348000
@CH03999 DC    H'-52'                                                   09349000
@CH03589 DC    XL2'E000'                                                09350000
@CH03658 DC    XL2'FFFF'                                                09351000
@CH03846 DC    XL2'4000'                                                09352000
@CH03594 DC    XL1'0'                                                   09353000
         DC    C'0'                                                     09354000
         DS    0F                                                       09355000
@AL00311 DC    A(@CF00067)             LIST WITH   1 ARGUMENT(S)        09356000
@AL00531 EQU   *                       LIST WITH   1 ARGUMENT(S)        09357000
@AL00621 DC    A(@CF00177)             LIST WITH   1 ARGUMENT(S)        09358000
@DATD    DSECT                                                          09359000
         DS    0F                                                       09360000
@SA00001 DS    18F                                                      09361000
@PC00001 DS    1F                                                       09362000
@PC00009 DS    2F                                                       09363000
@SA00004 DS    15F                                                      09364000
@SA00002 DS    15F                                                      09365000
@SA00003 DS    15F                                                      09366000
@SA00010 DS    15F                                                      09367000
@SA00007 DS    18F                                                      09368000
@SA00011 DS    15F                                                      09369000
@SA00017 DS    15F                                                      09370000
@SA00015 DS    15F                                                      09371000
@SA00008 DS    15F                                                      09372000
@SA00012 DS    14F                                                      09373000
@SA00016 DS    15F                                                      09374000
@SA00006 DS    15F                                                      09375000
@SA00013 DS    15F                                                      09376000
@SA00005 DS    15F                                                      09377000
@PC00020 DS    1F                                                       09378000
@AL00001 DS    2A                                                       09379000
@TF00001 DS    F                                                        09380000
IEEVCPU  CSECT                                                          09381000
         DS    0F                                                       09382000
@CF00275 DC    F'0'                                                     09383000
@CF00067 DC    F'1'                                                     09384000
@CH00067 EQU   @CF00067+2                                               09385000
@CF00177 DC    F'2'                                                     09386000
@CF00344 DC    F'15'                                                    09387000
@CH00344 EQU   @CF00344+2                                               09388000
@CF03679 DC    F'150'                                                   09389000
@CF04020 DC    F'-4'                                                    09390000
@CF03528 DC    XL4'FFFFFFFF'                                            09391000
@CF03706 DC    XL4'FFFFFFF8'                                            09392000
@CF03729 DC    XL4'0000E5C1'                                            09393000
@CF03772 DC    XL4'80000000'                                            09394000
@CF03850 DC    XL4'8000'                                                09395000
@DATD    DSECT                                                          09396000
         DS    0D                                                       09397000
UCBLKPTR DS    A                                                        09398000
PCCAPTR  DS    A                                                        09399000
LCCAPTR  DS    A                                                        09400000
UCBPTR   DS    A                                                        09401000
LOOPCNT  DS    F                                                        09402000
RETADD   DS    A                                                        09403000
ESTAPTR  DS    A                                                        09404000
VMVREQBP DS    A                                                        09405000
PATHADDR DS    A                                                        09406000
ENQECB   DS    FL4                                                      09407000
         ORG   ENQECB                                                   09408000
WAITBIT  DS    BL1                                                      09409000
POSTBIT  EQU   ENQECB+0                                                 09410000
         ORG   ENQECB+4                                                 09411000
DEVADDR  DS    F                                                        09412000
TEMPWORK DS    FL4                                                      09413000
         ORG   TEMPWORK                                                 09414000
@NM00126 DS    BL4                                                      09415000
         ORG   @NM00126                                                 09416000
@NM00127 DS    BL1                                                      09417000
CCBIT1   EQU   @NM00126+0                                               09418000
CCBIT2   EQU   @NM00126+0                                               09419000
         ORG   TEMPWORK+3                                               09420000
STOP     EQU   TEMPWORK+3                                               09421000
OPINT    EQU   TEMPWORK+3                                               09422000
CKSTOP   EQU   TEMPWORK+3                                               09423000
NTRDY    EQU   TEMPWORK+3                                               09424000
@NM00128 EQU   TEMPWORK+3                                               09425000
RECCK    EQU   TEMPWORK+3                                               09426000
         ORG   TEMPWORK+4                                               09427000
NSIZEPTR DS    A                                                        09428000
GMTBL    DS    FL4                                                      09429000
         ORG   GMTBL                                                    09430000
RSVD     DS    FL1                                                      09431000
STKEY    DS    FL1                                                      09432000
SBPOOL   DS    FL1                                                      09433000
FLAGS    DS    FL1                                                      09434000
         ORG   GMTBL+4                                                  09435000
LOOP     DS    F                                                        09436000
CSDCNTL  DS    F                                                        09437000
CSDWORK  DS    F                                                        09438000
WRKMASK  DS    F                                                        09439000
SYSSTAT  DS    H                                                        09440000
NP0FMTWS DS    FL2                                                      09441000
         ORG   NP0FMTWS                                                 09442000
FRMTONLY DS    BL1                                                      09443000
         ORG   NP0FMTWS+2                                               09444000
WORKAREA DS    CL116                                                    09445000
         ORG   WORKAREA                                                 09446000
ESTAPRM  DS    CL20                                                     09447000
         ORG   ESTAPRM                                                  09448000
CODEREG1 DS    AL4                                                      09449000
CODEREG2 DS    AL4                                                      09450000
CODEREG3 DS    AL4                                                      09451000
DATAREG1 DS    AL4                                                      09452000
DATAEND  DS    AL4                                                      09453000
         ORG   WORKAREA+20                                              09454000
CSCBPTR  DS    AL4                                                      09455000
BEGINPTR DS    AL4                                                      09456000
ENTRYPTR DS    AL4                                                      09457000
PARMPTR  DS    AL4                                                      09458000
COREPTR  DS    AL4                                                      09459000
CPUPSA   DS    AL4                                                      09460000
HEXCHNAD DS    FL2                                                      09461000
         ORG   HEXCHNAD                                                 09462000
@NM00001 DS    BL1                                                      09463000
HEXCHN1  DS    BL1                                                      09464000
         ORG   WORKAREA+46                                              09465000
CHNMASK  DS    FL2                                                      09466000
HEXCPUAD DS    FL2                                                      09467000
         ORG   HEXCPUAD                                                 09468000
@NM00002 DS    BL1                                                      09469000
HEXCPU1  DS    BL1                                                      09470000
         ORG   WORKAREA+50                                              09471000
CPUMSK   DS    FL2                                                      09472000
GETLENG  DS    FL2                                                      09473000
SUBPOOL  DS    BL1                                                      09474000
DEVSTAT  DS    BL1                                                      09475000
         ORG   DEVSTAT                                                  09476000
HIER     DS    BL1                                                      09477000
CONSLE   EQU   DEVSTAT+0                                                09478000
DEVON    EQU   DEVSTAT+0                                                09479000
DEVOFF   EQU   DEVSTAT+0                                                09480000
CHNGEFLG EQU   DEVSTAT+0                                                09481000
         ORG   WORKAREA+56                                              09482000
CONSLID  DS    BL1                                                      09483000
DDD      DS    CL3                                                      09484000
ERCODE   DS    CL4                                                      09485000
CATCOPY  DS    BL1                                                      09486000
         ORG   CATCOPY+0                                                09487000
@NM00003 DS    BL1                                                      09488000
CHANBIT  EQU   CATCOPY+0                                                09489000
         ORG   WORKAREA+80                                              09490000
AFFINJOB DS    FL2                                                      09491000
         DS    CL2                                                      09492000
OLDPCCA  DS    AL4                                                      09493000
OLDLCCA  DS    AL4                                                      09494000
CHNPPTR  DS    AL4                                                      09495000
QUITPTR  DS    AL4                                                      09496000
PGFXECB  DS    FL4                                                      09497000
         ORG   PGFXECB                                                  09498000
@NM00004 DS    CL1                                                      09499000
         ORG   @NM00004                                                 09500000
@NM00005 DS    BL1                                                      09501000
POSTED   EQU   @NM00004+0                                               09502000
         ORG   PGFXECB+1                                                09503000
PGFXCODE DS    CL3                                                      09504000
         ORG   WORKAREA+104                                             09505000
FOOTPRNT DS    CL5                                                      09506000
         ORG   FOOTPRNT                                                 09507000
CHNIND   DS    BL1                                                      09508000
RECONENQ EQU   FOOTPRNT+0                                               09509000
ONLINE   EQU   FOOTPRNT+0                                               09510000
UNCOND   EQU   FOOTPRNT+0                                               09511000
CSDENQ   EQU   FOOTPRNT+0                                               09512000
CLOCKSW  EQU   FOOTPRNT+0                                               09513000
UCBENQ   EQU   FOOTPRNT+0                                               09514000
CNSLSW   EQU   FOOTPRNT+0                                               09515000
UCBALTER DS    BL1                                                      09516000
UCBDONE  EQU   FOOTPRNT+1                                               09517000
CHNLSMRK EQU   FOOTPRNT+1                                               09518000
DEVSUBGO EQU   FOOTPRNT+1                                               09519000
IONOTQT  EQU   FOOTPRNT+1                                               09520000
CHOFFOK  EQU   FOOTPRNT+1                                               09521000
CHONLINE EQU   FOOTPRNT+1                                               09522000
CNSLEXIT EQU   FOOTPRNT+1                                               09523000
CNSLDONE DS    BL1                                                      09524000
CPUONOK  EQU   FOOTPRNT+2                                               09525000
CHONOK   EQU   FOOTPRNT+2                                               09526000
REPLYP   EQU   FOOTPRNT+2                                               09527000
CPUOFFOK EQU   FOOTPRNT+2                                               09528000
UNKNSTAT EQU   FOOTPRNT+2                                               09529000
COPYCAT  EQU   FOOTPRNT+2                                               09530000
JOBSHED  EQU   FOOTPRNT+2                                               09531000
NOCHAIN  DS    BL1                                                      09532000
DEVNOTON EQU   FOOTPRNT+3                                               09533000
ONLINMSG EQU   FOOTPRNT+3                                               09534000
CPUISON  EQU   FOOTPRNT+3                                               09535000
CHISON   EQU   FOOTPRNT+3                                               09536000
OLDCAT   EQU   FOOTPRNT+3                                               09537000
CRH      EQU   FOOTPRNT+3                                               09538000
CPUCRH   EQU   FOOTPRNT+3                                               09539000
KEEPCHAN DS    BL1                                                      09540000
KPCHANFL EQU   FOOTPRNT+4                                               09541000
NOPCCA   EQU   FOOTPRNT+4                                               09542000
SS1FAIL  EQU   FOOTPRNT+4                                               09543000
PSACCAOK EQU   FOOTPRNT+4                                               09544000
SKIPWTO  EQU   FOOTPRNT+4                                               09545000
PROCSTRT EQU   FOOTPRNT+4                                               09546000
         ORG   WORKAREA+112                                             09547000
ERRORIND DS    FL4                                                      09548000
         ORG   ERRORIND                                                 09549000
UNAUTH   DS    BL1                                                      09550000
INVLDSTX EQU   ERRORIND+0                                               09551000
OFFALRDY EQU   ERRORIND+0                                               09552000
LASTCPU  EQU   ERRORIND+0                                               09553000
AFFINSWT EQU   ERRORIND+0                                               09554000
CPFAILED EQU   ERRORIND+0                                               09555000
LASTPATH EQU   ERRORIND+0                                               09556000
NOCORE   EQU   ERRORIND+0                                               09557000
NOCLOCK  DS    BL1                                                      09558000
NOCNSOLE EQU   ERRORIND+1                                               09559000
OPERCNCL EQU   ERRORIND+1                                               09560000
CPUNRESP EQU   ERRORIND+1                                               09561000
CHCPUOFF EQU   ERRORIND+1                                               09562000
SYSFAIL  EQU   ERRORIND+1                                               09563000
MCHECK   EQU   ERRORIND+1                                               09564000
CHNTOPER EQU   ERRORIND+1                                               09565000
ESTAERR  DS    BL1                                                      09566000
UNIPROC  EQU   ERRORIND+2                                               09567000
ERROR    EQU   ERRORIND+2                                               09568000
EXITERR  EQU   ERRORIND+2                                               09569000
PATHRSVD EQU   ERRORIND+2                                               09570000
SMFRCER  EQU   ERRORIND+2                                               09571000
ERRORFLG EQU   ERRORIND+2                                               09572000
CHINV    EQU   ERRORIND+2                                               09573000
CRHFAIL  DS    BL1                                                      09574000
CRHNCPU  EQU   ERRORIND+3                                               09575000
CRHNCHN  EQU   ERRORIND+3                                               09576000
NOKPCHAN EQU   ERRORIND+3                                               09577000
         ORG   WORKAREA+116                                             09578000
SAVEPSW  DS    CL8                                                      09579000
DEVSUBP  DS    CL12                                                     09580000
         ORG   DEVSUBP                                                  09581000
DEVSUBUB DS    FL4                                                      09582000
DEVSUBFC DS    BL1                                                      09583000
DEVSUBCP DS    BL1                                                      09584000
DEVSUBCH DS    BL1                                                      09585000
@NM00121 DS    BL1                                                      09586000
LINKPTR  DS    AL4                                                      09587000
         ORG   DEVSUBP+12                                               09588000
PATHPARM DS    CL8                                                      09589000
         ORG   PATHPARM                                                 09590000
PATHFC   DS    BL1                                                      09591000
PATHUCB  DS    AL3                                                      09592000
PATHCPU  DS    FL2                                                      09593000
PATHCHN  DS    FL2                                                      09594000
         ORG   PATHPARM+8                                               09595000
CSWTBLK  DS    CL32                                                     09596000
         ORG   CSWTBLK                                                  09597000
CSWTID   DS    CL8                                                      09598000
CSWTFC   DS    CL1                                                      09599000
@NM00122 DS    CL3                                                      09600000
CSWTUC   DS    CL4                                                      09601000
@NM00123 DS    CL16                                                     09602000
         ORG   CSWTBLK+32                                               09603000
WTORPL2  DS    CL55                                                     09604000
         DS    CL1                                                      09605000
WTORPL1  DS    CL85                                                     09606000
         DS    CL3                                                      09607000
WTOECB   DS    CL4                                                      09608000
REPLY    DS    CL8                                                      09609000
ESTLIST  DS    CL16                                                     09610000
PARMAREA DS    CL109                                                    09611000
VMVPARMS DS    CL52                                                     09612000
         DS    CL3                                                      09613000
DISCPU   DS    CL16                                                     09614000
         ORG   DISCPU                                                   09615000
ASDALEN  DS    FL4                                                      09616000
ASDAOPC  DS    CL1                                                      09617000
ASDA001  DS    CL1                                                      09618000
ASDAFLG  DS    BL2                                                      09619000
         ORG   ASDAFLG                                                  09620000
ASASSOC  DS    BL1                                                      09621000
ASDASSOC EQU   ASDAFLG+0                                                09622000
@NM00129 EQU   ASDAFLG+0                                                09623000
ASDEINT  EQU   ASDAFLG+0                                                09624000
ASDMNT   EQU   ASDAFLG+0                                                09625000
@NM00130 EQU   ASDAFLG+0                                                09626000
         ORG   DISCPU+8                                                 09627000
ASDACPU  DS    CL5                                                      09628000
ASDA002  DS    CL3                                                      09629000
         ORG   DISCPU+16                                                09630000
PURINIT  DS    CL8                                                      09631000
         ORG   PURINIT                                                  09632000
AIRLL    DS    FL4                                                      09633000
AIROP    DS    FL1                                                      09634000
@NM00131 DS    CL1                                                      09635000
AIRFLAG  DS    BL2                                                      09636000
         ORG   AIRFLAG                                                  09637000
AIRRESV  DS    BL1                                                      09638000
AIRCPUS  EQU   AIRFLAG+0                                                09639000
@NM00132 EQU   AIRFLAG+0                                                09640000
         ORG   PURINIT+8                                                09641000
PURCPU   DS    CL13                                                     09642000
         ORG   PURCPU                                                   09643000
PURGLL   DS    FL4                                                      09644000
PURGOP   DS    FL1                                                      09645000
@NM00133 DS    CL1                                                      09646000
PURGFLG  DS    BL2                                                      09647000
         ORG   PURGFLG                                                  09648000
PURGMPP  DS    BL1                                                      09649000
@NM00134 EQU   PURGFLG+0                                                09650000
         ORG   PURCPU+8                                                 09651000
PURGHOST DS    CL5                                                      09652000
         ORG   PURCPU+13                                                09653000
         DS    CL7                                                      09654000
HOST     DS    CL8                                                      09655000
         ORG   HOST                                                     09656000
@NM00135 DS    CL1                                                      09657000
HOSTID   DS    CL5                                                      09658000
         ORG   HOST+8                                                   09659000
SETLOKSA DS    CL20                                                     09660000
         ORG   SETLOKSA                                                 09661000
@NM00136 DS    FL4                                                      09662000
@NM00137 DS    FL4                                                      09663000
@NM00138 DS    FL4                                                      09664000
@NM00139 DS    FL4                                                      09665000
@NM00140 DS    FL4                                                      09666000
         ORG   SETLOKSA+20                                              09667000
         DS    CL4                                                      09668000
ILIST    DS    CL16                                                     09669000
REGSAVEA DS    18F                                                      09670000
IOPTLIST DS    3A                                                       09671000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                09672000
@ENDDATD EQU   *                                                        09673000
IEEVCPU  CSECT                                                          09674000
         DS    0F                                                       09675000
@SIZDATD DC    AL1(0)                                                   09676000
         DC    AL3(@ENDDATD-@DATD)                                      09677000
@CV03520 DC    V(IEEVWKUP)                                              09678000
@CV03521 DC    V(IEEVTCH)                                               09679000
@CV03522 DC    V(IEECLEAN)                                              09680000
@CV03523 DC    V(IEEVQUIT)                                              09681000
@CV03524 DC    V(IEEVACR)                                               09682000
@CV03525 DC    V(WTORT)                                                 09683000
         DS    0D                                                       09684000
SEC1     DC    XL4'00000064'                                            09685000
SEC5     DC    XL4'00000200'                                            09686000
ONEMEG   DC    XL4'00100000'                                            09687000
@CC03611 DC    C'),OFFLINE,KEEPCHAN '                                   09688000
@CC03613 DC    C'),KEEPCHAN,OFFLINE '                                   09689000
@CC03607 DC    C'),OFFLINE,UNCOND '                                     09690000
@CC03609 DC    C'),UNCOND,OFFLINE '                                     09691000
@CC03605 DC    C'),OFFLINE '                                            09692000
@CC03601 DC    C'),ONLINE '                                             09693000
@CC03671 DC    C'IGC0407B'                                              09694000
@CC03768 DC    C'IEFAB49C'                                              09695000
@CC03867 DC    C'IEEVCPU'                                               09696000
@CC03682 DC    C'EXTEND'                                                09697000
@CC03683 DC    C'CANCEL'                                                09698000
@CC03616 DC    C'CPU('                                                  09699000
@CC03618 DC    C'0168'                                                  09700000
@CC03809 DC    C'PSA '                                                  09701000
@CC03811 DC    C'PCCA'                                                  09702000
@CC03812 DC    C'LCCA'                                                  09703000
@CC03591 DC    C'CH('                                                   09704000
@CC03639 DC    C'YES'                                                   09705000
@CC03640 DC    C'NO '                                                   09706000
@CC03641 EQU   @CC03640                                                 09707000
@CB03735 DC    X'00080000'                                              09708000
RCNENQQ  DC    CL8'SYSZVARY'                                            09709000
RCNENQR  DC    CL3'CPU'                                                 09710000
UCBENQQ  DC    CL8'SYSIEFSD'                                            09711000
UCBENQR  DC    CL2'Q4'                                                  09712000
JOBSCDQ  DC    CL8'SYSZCSD '                                            09713000
JOBSCDR  DC    CL8'CSDCPUJS'                                            09714000
WTOR1    DS    CL85                                                     09715000
         ORG   WTOR1                                                    09716000
WTOR101  DC    AL1(4)                                                   09717000
WTOR102  DC    AL3(@CF00275)                                            09718000
WTOR103  DC    AL4(@CF00275)                                            09719000
WTOR104  DC    H'73'                                                    09720000
WTOR105  DC    B'1000000000000000'                                      09721000
WTOR106  DC    CL69'IEE718D SHOULD CPU BE UNAVAILABLE FOR JOB SCHEDULINC09722000
               G? REPLY YES OR NO'                                      09723000
WTOR107  DC    B'0100000000000000'                                      09724000
WTOR108  DC    B'1000000000000000'                                      09725000
         ORG   WTOR1+85                                                 09726000
         DS    CL3                                                      09727000
WTOR2    DS    CL55                                                     09728000
         ORG   WTOR2                                                    09729000
WTOR201  DC    AL1(6)                                                   09730000
WTOR202  DC    AL3(@CF00275)                                            09731000
WTOR203  DC    AL4(@CF00275)                                            09732000
WTOR204  DC    H'43'                                                    09733000
WTOR205  DC    B'1000000000000000'                                      09734000
WTOR206  DC    CL39'IEE717D DDD BUSY REPLY EXTEND OR CANCEL'            09735000
WTOR207  DC    B'0100000000000000'                                      09736000
WTOR208  DC    B'1000000000000000'                                      09737000
         ORG   WTOR2+55                                                 09738000
PATCH    DC    X'00'                                                    09739000
         DC    XL119'0'                                                 09740000
         DS    CL1                                                      09741000
YSTAK    DC    F'16'                                                    09742000
         DC    F'4'                                                     09743000
         DC    F'16'                                                    09744000
         DC    F'16'                                                    09745000
         DC    F'4'                                                     09746000
         DC    F'4'                                                     09747000
         DC    F'16'                                                    09748000
         DC    F'16'                                                    09749000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       09750000
@01      EQU   01                                                       09751000
@02      EQU   02                                                       09752000
@03      EQU   03                                                       09753000
@04      EQU   04                                                       09754000
@05      EQU   05                                                       09755000
@06      EQU   06                                                       09756000
@07      EQU   07                                                       09757000
@08      EQU   08                                                       09758000
@09      EQU   09                                                       09759000
@10      EQU   10                                                       09760000
@11      EQU   11                                                       09761000
@12      EQU   12                                                       09762000
@13      EQU   13                                                       09763000
@14      EQU   14                                                       09764000
@15      EQU   15                                                       09765000
SAVAREA  EQU   @10                                                      09766000
R3SAVAR  EQU   @10                                                      09767000
HOLDRC   EQU   @11                                                      09768000
SAPTR    EQU   @10                                                      09769000
P        EQU   @12                                                      09770000
AFLAG    EQU   @02                                                      09771000
TEMPMASK EQU   @02                                                      09772000
CHARPTR  EQU   @02                                                      09773000
I        EQU   @02                                                      09774000
PSAPTR   EQU   @12                                                      09775000
ASCBPTR  EQU   @02                                                      09776000
CATPTR   EQU   @10                                                      09777000
CHNADDR  EQU   @03                                                      09778000
RCRDRPTR EQU   @10                                                      09779000
R0       EQU   @00                                                      09780000
R1       EQU   @01                                                      09781000
R2       EQU   @02                                                      09782000
R5       EQU   @05                                                      09783000
R6       EQU   @06                                                      09784000
R7       EQU   @07                                                      09785000
R8       EQU   @08                                                      09786000
R9       EQU   @09                                                      09787000
R10      EQU   @10                                                      09788000
R11      EQU   @11                                                      09789000
R12      EQU   @12                                                      09790000
R14      EQU   @14                                                      09791000
R15      EQU   @15                                                      09792000
RETCODE  EQU   @15                                                      09793000
SDWAPTR  EQU   @01                                                      09794000
ASDAR1   EQU   @01                                                      09795000
PAIRR1   EQU   @01                                                      09796000
GPR01P   EQU   @01                                                      09797000
GPR15P   EQU   @15                                                      09798000
GPR15F   EQU   @15                                                      09799000
GPR00P   EQU   @00                                                      09800000
GPR14P   EQU   @14                                                      09801000
REGSAPTR EQU   @13                                                      09802000
PARMX    EQU   @01                                                      09803000
PARM     EQU   @01                                                      09804000
RTCODE   EQU   @15                                                      09805000
TBLPTR   EQU   @01                                                      09806000
LNGREG   EQU   @00                                                      09807000
LOCKRC   EQU   @15                                                      09808000
GMREG    EQU   @03                                                      09809000
RSVTINDX EQU   @02                                                      09810000
FRREINDX EQU   @03                                                      09811000
PSAREG   EQU   @01                                                      09812000
COMMPTR  EQU   @06                                                      09813000
GPR00F   EQU   @00                                                      09814000
GPR02P   EQU   @02                                                      09815000
GPR12F   EQU   @12                                                      09816000
GPR13P   EQU   @13                                                      09817000
R13      EQU   @13                                                      09818000
R3       EQU   @03                                                      09819000
R4       EQU   @04                                                      09820000
CVTPTR   EQU   16                                                       09821000
FRREPTR  EQU   16                                                       09822000
FRRSPTR  EQU   16                                                       09823000
IRTPTR   EQU   16                                                       09824000
UCMEILPT EQU   16                                                       09825000
UCMEXTPT EQU   16                                                       09826000
UCMUEWPT EQU   16                                                       09827000
UCBRECRD EQU   0                                                        09828000
NEXTPTR  EQU   UCBRECRD                                                 09829000
CAUSEFLD EQU   UCBRECRD+4                                               09830000
HIERONLY EQU   CAUSEFLD                                                 09831000
CONSLFLG EQU   CAUSEFLD                                                 09832000
MKDEVON  EQU   CAUSEFLD                                                 09833000
MKDEVOFF EQU   CAUSEFLD                                                 09834000
ALTERUCB EQU   CAUSEFLD                                                 09835000
UCBADDR  EQU   UCBRECRD+5                                               09836000
WKUPARMS EQU   0                                                        09837000
PSAADDR  EQU   WKUPARMS+72                                              09838000
XREGS    EQU   WKUPARMS+76                                              09839000
VIRTADDR EQU   WKUPARMS+84                                              09840000
CPUMASK  EQU   WKUPARMS+88                                              09841000
CPUADD   EQU   WKUPARMS+90                                              09842000
@NM00008 EQU   WKUPARMS+108                                             09843000
INPROC   EQU   @NM00008                                                 09844000
COMPLT   EQU   @NM00008                                                 09845000
CATCHK   EQU   @NM00008                                                 09846000
BACKVOFF EQU   @NM00008                                                 09847000
CORCHAIN EQU   0                                                        09848000
FRWRDPTR EQU   CORCHAIN                                                 09849000
SPNUM    EQU   CORCHAIN+4                                               09850000
LNGTH    EQU   CORCHAIN+6                                               09851000
QTPRMS   EQU   0                                                        09852000
QTCPUAD  EQU   QTPRMS+72                                                09853000
QTCPUMSK EQU   QTPRMS+74                                                09854000
QTFLGS   EQU   QTPRMS+76                                                09855000
QTCOMP   EQU   QTFLGS                                                   09856000
COMBUF   EQU   0                                                        09857000
UCBTAB   EQU   0                                                        09858000
UCMPRFXP EQU   0                                                        09859000
CVTMAP   EQU   0                                                        09860000
CVT      EQU   CVTMAP                                                   09861000
CVTILK2  EQU   CVTMAP+40                                                09862000
CVTDAR   EQU   CVTMAP+72                                                09863000
CVTFLGS1 EQU   CVTDAR                                                   09864000
CVTBRET  EQU   CVTMAP+82                                                09865000
CVTCUCB  EQU   CVTMAP+100                                               09866000
CVTDCB   EQU   CVTMAP+116                                               09867000
CVTIOQET EQU   CVTMAP+120                                               09868000
CVTIXAVL EQU   CVTMAP+124                                               09869000
CVTIERLC EQU   CVTMAP+144                                               09870000
CVTHEAD  EQU   CVTMAP+160                                               09871000
CVTSV76C EQU   CVTHEAD                                                  09872000
CVTOPTA  EQU   CVTMAP+182                                               09873000
CVTOPTB  EQU   CVTMAP+183                                               09874000
CVTRMS   EQU   CVTMAP+224                                               09875000
CVTGTF   EQU   CVTMAP+236                                               09876000
CVTGTFST EQU   CVTGTF                                                   09877000
CVTGTFS  EQU   CVTGTFST                                                 09878000
CVTSTATE EQU   CVTGTFST                                                 09879000
CVTTMODE EQU   CVTGTFST                                                 09880000
CVTFORM  EQU   CVTGTFST                                                 09881000
CVTAQAVT EQU   CVTMAP+240                                               09882000
CVTTCMFG EQU   CVTAQAVT                                                 09883000
CVTVOLM2 EQU   CVTMAP+244                                               09884000
CVTTATA  EQU   CVTVOLM2                                                 09885000
CVTTSKS  EQU   CVTTATA                                                  09886000
CVTVOLF2 EQU   CVTTSKS                                                  09887000
CVTTAT   EQU   CVTTATA+1                                                09888000
CVTATER  EQU   CVTMAP+248                                               09889000
CVTEXT1  EQU   CVTMAP+252                                               09890000
CVTPURG  EQU   CVTMAP+260                                               09891000
CVTQMSG  EQU   CVTMAP+268                                               09892000
CVTDMSR  EQU   CVTMAP+272                                               09893000
CVTRSV37 EQU   CVTDMSR                                                  09894000
CVTDMSRF EQU   CVTRSV37                                                 09895000
CVTERPV  EQU   CVTMAP+316                                               09896000
CVTINTLA EQU   CVTMAP+320                                               09897000
CVTAPF   EQU   CVTMAP+324                                               09898000
CVTEXT2  EQU   CVTMAP+328                                               09899000
CVTHJES  EQU   CVTMAP+332                                               09900000
CVTPGSIA EQU   CVTMAP+348                                               09901000
CVTA1F1  EQU   CVTMAP+356                                               09902000
CVTSYSK  EQU   CVTMAP+357                                               09903000
CVTVOLM1 EQU   CVTMAP+380                                               09904000
CVTVOLF1 EQU   CVTVOLM1                                                 09905000
CVTATMCT EQU   CVTMAP+388                                               09906000
CVTXTNT1 EQU   0                                                        09907000
CVTXTNT2 EQU   0                                                        09908000
CVTDSSV  EQU   CVTXTNT2                                                 09909000
CVTFLGBT EQU   CVTXTNT2+5                                               09910000
CVTQID   EQU   CVTXTNT2+24                                              09911000
CVTICB   EQU   CVTXTNT2+48                                              09912000
CVTRV400 EQU   CVTXTNT2+52                                              09913000
CVTRV409 EQU   CVTXTNT2+53                                              09914000
CVTATCVT EQU   CVTXTNT2+64                                              09915000
CVTRV429 EQU   CVTXTNT2+84                                              09916000
CVTRV438 EQU   CVTXTNT2+85                                              09917000
CVTRV457 EQU   CVTXTNT2+112                                             09918000
CVTRV466 EQU   CVTXTNT2+113                                             09919000
CVTFIX   EQU   0                                                        09920000
CVTRELNO EQU   CVTFIX+252                                               09921000
CHAIN    EQU   0                                                        09922000
CHFLG    EQU   CHAIN+4                                                  09923000
CHSTS    EQU   CHFLG+2                                                  09924000
CHACT    EQU   CHFLG+3                                                  09925000
CHIFY    EQU   CHACT                                                    09926000
CHKEY    EQU   CHAIN+8                                                  09927000
CHPARM   EQU   CHKEY                                                    09928000
CHPKE    EQU   CHAIN+28                                                 09929000
CHUCMP   EQU   CHAIN+29                                                 09930000
CHTJID   EQU   CHAIN+30                                                 09931000
CHPROCSN EQU   CHAIN+32                                                 09932000
CHACT1   EQU   CHPROCSN+3                                               09933000
CHASM    EQU   CHAIN+40                                                 09934000
CHCIBP   EQU   CHASM+4                                                  09935000
CHRGNSZ  EQU   CHASM+8                                                  09936000
CHSTEP   EQU   CHASM+24                                                 09937000
CHSWT    EQU   CHSTEP                                                   09938000
CHSHORT  EQU   CHASM+32                                                 09939000
PCCAVT   EQU   0                                                        09940000
PCCAT00P EQU   PCCAVT                                                   09941000
PCCA     EQU   0                                                        09942000
PCCAPCCA EQU   PCCA                                                     09943000
PCCACPID EQU   PCCA+4                                                   09944000
PCCACPUA EQU   PCCA+16                                                  09945000
PCCACAFM EQU   PCCA+18                                                  09946000
PCCAPSAV EQU   PCCA+24                                                  09947000
PCCAPSAR EQU   PCCA+28                                                  09948000
PCCATMST EQU   PCCA+128                                                 09949000
PCCATMFL EQU   PCCATMST                                                 09950000
PCCATODE EQU   PCCATMST+1                                               09951000
PCCACCE  EQU   PCCATMST+2                                               09952000
PCCAINTE EQU   PCCATMST+3                                               09953000
PCCAEMSB EQU   PCCA+136                                                 09954000
PCCAEMSI EQU   PCCAEMSB                                                 09955000
PCCARISP EQU   PCCAEMSI                                                 09956000
PCCAEMS2 EQU   PCCAEMSI+1                                               09957000
PCCAEMS3 EQU   PCCAEMSI+2                                               09958000
PCCARMSB EQU   PCCAEMSI+3                                               09959000
PCCACHAN EQU   PCCA+224                                                 09960000
PCCAWERP EQU   PCCA+280                                                 09961000
PCCACHPF EQU   PCCAWERP+4                                               09962000
PCCACHBL EQU   PCCAWERP+5                                               09963000
PCCACHVA EQU   PCCAWERP+6                                               09964000
PCCACHTS EQU   PCCAWERP+7                                               09965000
PCCACHS1 EQU   PCCA+288                                                 09966000
PCCACHS2 EQU   PCCA+289                                                 09967000
PCCACHRB EQU   PCCA+290                                                 09968000
PCCACHF1 EQU   PCCA+308                                                 09969000
PCCACHF2 EQU   PCCA+309                                                 09970000
PCCACHF3 EQU   PCCA+310                                                 09971000
PCCACHF4 EQU   PCCA+311                                                 09972000
PCCAATTR EQU   PCCA+376                                                 09973000
PCCACPUM EQU   PCCAATTR                                                 09974000
PCCAIO   EQU   PCCAATTR                                                 09975000
PCCACAT  EQU   PCCA+384                                                 09976000
LCCAVT   EQU   0                                                        09977000
LCCAT00P EQU   LCCAVT                                                   09978000
LCCA     EQU   0                                                        09979000
LCCALCCA EQU   LCCA                                                     09980000
LCCACPUA EQU   LCCA+4                                                   09981000
LCCAMCR1 EQU   LCCA+152                                                 09982000
LCCAIHRC EQU   LCCA+520                                                 09983000
LCCAIHR1 EQU   LCCAIHRC                                                 09984000
LCCAIHR2 EQU   LCCAIHRC+1                                               09985000
LCCAIHR3 EQU   LCCAIHRC+2                                               09986000
LCCAIHR4 EQU   LCCAIHRC+3                                               09987000
LCCASPIN EQU   LCCA+524                                                 09988000
LCCASPN1 EQU   LCCASPIN                                                 09989000
LCCASPN2 EQU   LCCASPIN+1                                               09990000
LCCASPN3 EQU   LCCASPIN+2                                               09991000
LCCASPN4 EQU   LCCASPIN+3                                               09992000
LCCACPUS EQU   LCCA+536                                                 09993000
LCCADSF1 EQU   LCCA+540                                                 09994000
LCCAVCPU EQU   LCCADSF1                                                 09995000
LCCATIMR EQU   LCCADSF1                                                 09996000
LCCADSF2 EQU   LCCA+541                                                 09997000
LCCASPSA EQU   LCCA+544                                                 09998000
LCCACRFL EQU   LCCA+692                                                 09999000
LCCAVARY EQU   LCCACRFL                                                 10000000
LCCACREX EQU   LCCA+693                                                 10001000
LCCALKFG EQU   LCCA+694                                                 10002000
LCCASRBF EQU   LCCA+720                                                 10003000
LCCAIRT  EQU   LCCA+736                                                 10004000
CAT      EQU   0                                                        10005000
CATENTRY EQU   CAT                                                      10006000
CATFLG   EQU   CATENTRY                                                 10007000
CATNOP   EQU   CATFLG                                                   10008000
CATNGEN  EQU   CATFLG                                                   10009000
CATNID   EQU   CATFLG                                                   10010000
CATFLA   EQU   CAT+1                                                    10011000
CATSIOCT EQU   CAT+2                                                    10012000
CATCHID  EQU   CAT+4                                                    10013000
RVT      EQU   0                                                        10014000
RVTPBUCR EQU   RVT+60                                                   10015000
CSD      EQU   0                                                        10016000
CSDCPUJS EQU   CSD+4                                                    10017000
CSDCHAD  EQU   CSD+6                                                    10018000
CSDCPUAL EQU   CSD+8                                                    10019000
CSDCPUOL EQU   CSD+10                                                   10020000
CSDSCWRD EQU   CSD+12                                                   10021000
CSDSCFL1 EQU   CSDSCWRD                                                 10022000
CSDSCFL2 EQU   CSDSCWRD+1                                               10023000
CSDSCFL3 EQU   CSDSCWRD+2                                               10024000
CSDSCFL4 EQU   CSDSCWRD+3                                               10025000
CSDFLAGS EQU   CSD+23                                                   10026000
CSDMP    EQU   CSDFLAGS                                                 10027000
CSDMASK  EQU   CSD+128                                                  10028000
ASCB     EQU   0                                                        10029000
ASCBSUPC EQU   ASCB+16                                                  10030000
ASCBRSM  EQU   ASCB+52                                                  10031000
ASCBRSMF EQU   ASCBRSM                                                  10032000
ASCBFW1  EQU   ASCB+100                                                 10033000
ASCBAFFN EQU   ASCBFW1                                                  10034000
ASCBRCTF EQU   ASCBFW1+2                                                10035000
ASCBFLG1 EQU   ASCBFW1+3                                                10036000
ASCBDSP1 EQU   ASCB+114                                                 10037000
ASCBFLG2 EQU   ASCB+115                                                 10038000
ASCBLKGP EQU   ASCB+128                                                 10039000
ASCBSRQ  EQU   ASCB+180                                                 10040000
ASCBSRQ1 EQU   ASCBSRQ                                                  10041000
ASCBSRQ2 EQU   ASCBSRQ+1                                                10042000
ASCBSRQ3 EQU   ASCBSRQ+2                                                10043000
ASCBSRQ4 EQU   ASCBSRQ+3                                                10044000
ASVT     EQU   0                                                        10045000
ASVTMAXU EQU   ASVT+516                                                 10046000
ASVTFRST EQU   ASVT+524                                                 10047000
ASVTENTY EQU   ASVT+528                                                 10048000
ASVTAVAL EQU   ASVTENTY                                                 10049000
PSA      EQU   0                                                        10050000
FLCRNPSW EQU   PSA                                                      10051000
FLCROPSW EQU   PSA+8                                                    10052000
FLCICCW2 EQU   PSA+16                                                   10053000
FLCCVT   EQU   FLCICCW2                                                 10054000
FLCTRACE EQU   PSA+84                                                   10055000
PSAEEPSW EQU   PSA+132                                                  10056000
PSAESPSW EQU   PSA+136                                                  10057000
FLCSVILC EQU   PSAESPSW+1                                               10058000
PSAEPPSW EQU   PSA+140                                                  10059000
FLCPIILC EQU   PSAEPPSW+1                                               10060000
FLCPICOD EQU   PSAEPPSW+2                                               10061000
PSAPICOD EQU   FLCPICOD+1                                               10062000
FLCTEA   EQU   PSAEPPSW+4                                               10063000
FLCPER   EQU   PSA+152                                                  10064000
FLCMCLA  EQU   PSA+168                                                  10065000
FLCCHNID EQU   FLCMCLA                                                  10066000
FLCCHTM  EQU   FLCCHNID                                                 10067000
FLCIOEL  EQU   FLCMCLA+4                                                10068000
FLCIOA   EQU   FLCMCLA+16                                               10069000
PSAMEDC  EQU   FLCMCLA+76                                               10070000
FLCFSA   EQU   FLCMCLA+80                                               10071000
PSAPSA   EQU   PSA+512                                                  10072000
PSACPUPA EQU   PSA+516                                                  10073000
PSACPULA EQU   PSA+518                                                  10074000
PSAPCCAV EQU   PSA+520                                                  10075000
PSAPCCAR EQU   PSA+524                                                  10076000
PSALCCAV EQU   PSA+528                                                  10077000
PSALCCAR EQU   PSA+532                                                  10078000
PSATNEW  EQU   PSA+536                                                  10079000
PSATOLD  EQU   PSA+540                                                  10080000
PSAANEW  EQU   PSA+544                                                  10081000
PSAAOLD  EQU   PSA+548                                                  10082000
PSASUPER EQU   PSA+552                                                  10083000
PSASUP1  EQU   PSASUPER                                                 10084000
PSASUP2  EQU   PSASUPER+1                                               10085000
PSASUP3  EQU   PSASUPER+2                                               10086000
PSASUP4  EQU   PSASUPER+3                                               10087000
PSACLHT  EQU   PSA+640                                                  10088000
PSALKSA  EQU   PSA+696                                                  10089000
PSAHLHI  EQU   PSA+760                                                  10090000
PSALITA  EQU   PSA+764                                                  10091000
PSAWKRAP EQU   PSA+784                                                  10092000
PSAWKVAP EQU   PSA+788                                                  10093000
PSACPUSA EQU   PSA+794                                                  10094000
PSASTOR  EQU   PSA+796                                                  10095000
PSADSSFL EQU   PSA+836                                                  10096000
PSADSSF1 EQU   PSADSSFL                                                 10097000
PSADSSF3 EQU   PSADSSFL+2                                               10098000
PSADSSF4 EQU   PSADSSFL+3                                               10099000
PSARSVT  EQU   PSA+896                                                  10100000
PSALSFCC EQU   PSA+1012                                                 10101000
PSACDAL  EQU   PSA+1040                                                 10102000
PSASTAK  EQU   PSA+3072                                                 10103000
FRRS     EQU   0                                                        10104000
FRRSHEAD EQU   FRRS                                                     10105000
FRRSEMP  EQU   FRRSHEAD                                                 10106000
FRRSLAST EQU   FRRSHEAD+4                                               10107000
FRRSELEN EQU   FRRSHEAD+8                                               10108000
FRRSCURR EQU   FRRSHEAD+12                                              10109000
FRRSRTMW EQU   FRRS+16                                                  10110000
FRRSENTR EQU   0                                                        10111000
FRRSFRRA EQU   FRRSENTR                                                 10112000
FRRSFLGS EQU   FRRSENTR+4                                               10113000
FRRSFLG1 EQU   FRRSFLGS                                                 10114000
FRRSPARM EQU   FRRSENTR+8                                               10115000
SDWA     EQU   0                                                        10116000
SDWAFIOB EQU   SDWA+4                                                   10117000
SDWAABCC EQU   SDWAFIOB                                                 10118000
SDWACMPF EQU   SDWAABCC                                                 10119000
SDWAREQ  EQU   SDWACMPF                                                 10120000
SDWACTL1 EQU   SDWA+8                                                   10121000
SDWACMKA EQU   SDWACTL1                                                 10122000
SDWAMWPA EQU   SDWACTL1+1                                               10123000
SDWAPMKA EQU   SDWACTL1+4                                               10124000
SDWACTL2 EQU   SDWA+16                                                  10125000
SDWACMKP EQU   SDWACTL2                                                 10126000
SDWAMWPP EQU   SDWACTL2+1                                               10127000
SDWAPMKP EQU   SDWACTL2+4                                               10128000
SDWAGRSV EQU   SDWA+24                                                  10129000
SDWANAME EQU   SDWA+88                                                  10130000
SDWAEC1  EQU   SDWA+104                                                 10131000
SDWAEMK1 EQU   SDWAEC1                                                  10132000
SDWAMWP1 EQU   SDWAEC1+1                                                10133000
SDWAINT1 EQU   SDWAEC1+2                                                10134000
SDWANXT1 EQU   SDWAEC1+4                                                10135000
SDWAAEC1 EQU   SDWA+112                                                 10136000
SDWAILC1 EQU   SDWAAEC1+1                                               10137000
SDWAINC1 EQU   SDWAAEC1+2                                               10138000
SDWAICD1 EQU   SDWAINC1+1                                               10139000
SDWAEC2  EQU   SDWA+120                                                 10140000
SDWAEMK2 EQU   SDWAEC2                                                  10141000
SDWAMWP2 EQU   SDWAEC2+1                                                10142000
SDWAINT2 EQU   SDWAEC2+2                                                10143000
SDWANXT2 EQU   SDWAEC2+4                                                10144000
SDWAAEC2 EQU   SDWA+128                                                 10145000
SDWAILC2 EQU   SDWAAEC2+1                                               10146000
SDWAINC2 EQU   SDWAAEC2+2                                               10147000
SDWAICD2 EQU   SDWAINC2+1                                               10148000
SDWASRSV EQU   SDWA+136                                                 10149000
SDWAIDNT EQU   SDWA+200                                                 10150000
SDWAMCH  EQU   SDWA+204                                                 10151000
SDWASTCK EQU   SDWAMCH                                                  10152000
SDWAMCHI EQU   SDWAMCH+8                                                10153000
SDWAMCHS EQU   SDWAMCHI                                                 10154000
SDWAMCHD EQU   SDWAMCHI+1                                               10155000
SDWARSR1 EQU   SDWAMCH+12                                               10156000
SDWARSR2 EQU   SDWAMCH+13                                               10157000
SDWAFLGS EQU   SDWA+232                                                 10158000
SDWAERRA EQU   SDWAFLGS                                                 10159000
SDWAERRB EQU   SDWAFLGS+1                                               10160000
SDWAERRC EQU   SDWAFLGS+2                                               10161000
SDWAERRD EQU   SDWAFLGS+3                                               10162000
SDWAIOFS EQU   SDWA+238                                                 10163000
SDWACPUA EQU   SDWA+248                                                 10164000
SDWAPARQ EQU   SDWA+252                                                 10165000
SDWARCDE EQU   SDWAPARQ                                                 10166000
SDWAACF2 EQU   SDWAPARQ+1                                               10167000
SDWARCRD EQU   SDWAACF2                                                 10168000
SDWAACF3 EQU   SDWAPARQ+2                                               10169000
SDWAACF4 EQU   SDWAPARQ+3                                               10170000
SDWALKWA EQU   SDWA+256                                                 10171000
SDWALKWS EQU   SDWALKWA                                                 10172000
SDWARECP EQU   SDWA+292                                                 10173000
SDWAMODN EQU   SDWARECP                                                 10174000
SDWACSCT EQU   SDWARECP+8                                               10175000
SDWASNPA EQU   SDWA+320                                                 10176000
SDWADUMP EQU   SDWASNPA                                                 10177000
SDWADPFS EQU   SDWADUMP+1                                               10178000
SDWADDAT EQU   SDWASNPA+4                                               10179000
SDWASDAT EQU   SDWADDAT                                                 10180000
SDWAPDAT EQU   SDWADDAT+2                                               10181000
SDWADPSA EQU   SDWA+328                                                 10182000
SDWADPSL EQU   SDWADPSA                                                 10183000
SDWARA   EQU   SDWA+400                                                 10184000
SDWADPVA EQU   SDWARA+2                                                 10185000
SDWAHEX  EQU   SDWADPVA                                                 10186000
SDWAURAL EQU   SDWARA+3                                                 10187000
SDWAVRA  EQU   SDWARA+4                                                 10188000
UCB      EQU   0                                                        10189000
UCBOB    EQU   0                                                        10190000
UCBJBNR  EQU   UCBOB                                                    10191000
UCBFL5   EQU   UCBOB+1                                                  10192000
UCBAF    EQU   UCBFL5                                                   10193000
UCBNALOC EQU   UCBFL5                                                   10194000
UCBSTAT  EQU   UCBOB+3                                                  10195000
UCBONLI  EQU   UCBSTAT                                                  10196000
UCBCHGS  EQU   UCBSTAT                                                  10197000
UCBRESV  EQU   UCBSTAT                                                  10198000
UCBALOC  EQU   UCBSTAT                                                  10199000
UCBSYSR  EQU   UCBSTAT                                                  10200000
UCBCHAN  EQU   UCBOB+4                                                  10201000
UCBCHA   EQU   UCBCHAN                                                  10202000
UCBSFLS  EQU   UCBOB+6                                                  10203000
UCBFLA   EQU   UCBSFLS                                                  10204000
UCBFL1   EQU   UCBFLA                                                   10205000
UCBBSY   EQU   UCBFL1                                                   10206000
UCBNRY   EQU   UCBFL1                                                   10207000
UCBPST   EQU   UCBFL1                                                   10208000
UCBPSNS  EQU   UCBFL1                                                   10209000
UCBCUB   EQU   UCBFL1                                                   10210000
UCBACTV  EQU   UCBFL1                                                   10211000
UCBFLB   EQU   UCBSFLS+1                                                10212000
UCBIORST EQU   UCBFLB                                                   10213000
UCBCRHRV EQU   UCBFLB                                                   10214000
UCBVALPH EQU   UCBFLB                                                   10215000
UCBCHM   EQU   UCBOB+8                                                  10216000
UCBCHM1  EQU   UCBCHM                                                   10217000
UCBPTH0  EQU   UCBCHM1                                                  10218000
UCBPTH1  EQU   UCBCHM1                                                  10219000
UCBCPU   EQU   UCBOB+11                                                 10220000
UCBWGT   EQU   UCBOB+12                                                 10221000
UCBMTPXP EQU   UCBWGT                                                   10222000
UCBVORSN EQU   UCBWGT                                                   10223000
UCBVHRSN EQU   UCBWGT                                                   10224000
UCBNAME  EQU   UCBOB+13                                                 10225000
UCBTYP   EQU   UCBOB+16                                                 10226000
UCBTBYT1 EQU   UCBTYP                                                   10227000
UCB1FEA5 EQU   UCBTBYT1                                                 10228000
UCB1FEA6 EQU   UCBTBYT1                                                 10229000
UCBTBYT2 EQU   UCBTYP+1                                                 10230000
UCB2OPT2 EQU   UCBTBYT2                                                 10231000
UCBDUDN1 EQU   UCB2OPT2                                                 10232000
UCB2OPT3 EQU   UCBTBYT2                                                 10233000
UCBDUDN2 EQU   UCB2OPT3                                                 10234000
UCB2OPT4 EQU   UCBTBYT2                                                 10235000
UCBRWTAU EQU   UCB2OPT4                                                 10236000
UCB2OPT6 EQU   UCBTBYT2                                                 10237000
UCB2OPT7 EQU   UCBTBYT2                                                 10238000
UCBTBYT3 EQU   UCBTYP+2                                                 10239000
UCBDVCLS EQU   UCBTBYT3                                                 10240000
UCB3TAPE EQU   UCBDVCLS                                                 10241000
UCB3COMM EQU   UCBDVCLS                                                 10242000
UCB3DACC EQU   UCBDVCLS                                                 10243000
UCBTBYT4 EQU   UCBTYP+3                                                 10244000
UCBEXTPT EQU   UCBOB+20                                                 10245000
UCBFLC   EQU   UCBEXTPT                                                 10246000
UCBDEV   EQU   UCBOB+24                                                 10247000
UCBCMEXT EQU   0                                                        10248000
UCBATI   EQU   UCBCMEXT+3                                               10249000
@NM00098 EQU   UCBATI                                                   10250000
UCBFLP1  EQU   UCBCMEXT+5                                               10251000
UCBERLOG EQU   UCBFLP1                                                  10252000
UCBCCWOF EQU   UCBCMEXT+8                                               10253000
UCBMIHBY EQU   UCBCMEXT+16                                              10254000
UCBMT    EQU   0                                                        10255000
UCBOCR   EQU   0                                                        10256000
UCB3540X EQU   0                                                        10257000
UCBDKBYT EQU   UCB3540X+6                                               10258000
UCB3800X EQU   0                                                        10259000
UCBOPTNS EQU   UCB3800X                                                 10260000
UCBACTIV EQU   UCB3800X+3                                               10261000
UCBMDRBF EQU   UCB3800X+36                                              10262000
UCBUCS   EQU   0                                                        10263000
UCBUCSOP EQU   UCBUCS+4                                                 10264000
UCBFCBOP EQU   UCBUCS+5                                                 10265000
UCBBGN   EQU   0                                                        10266000
UCM2EXT  EQU   0                                                        10267000
UCM2STA  EQU   UCM2EXT+8                                                10268000
UCM2SFLG EQU   UCM2STA                                                  10269000
UCM2FEXT EQU   UCM2EXT+12                                               10270000
UCMPRFX  EQU   0                                                        10271000
UCMMCENT EQU   UCMPRFX                                                  10272000
UCMSAVE0 EQU   UCMPRFX+4                                                10273000
UCMSFLGS EQU   UCMPRFX+84                                               10274000
UCMSFLG1 EQU   UCMSFLGS                                                 10275000
UCMSFLG2 EQU   UCMSFLGS+1                                               10276000
UCMXSA   EQU   UCMPRFX+104                                              10277000
UCMSDS1  EQU   UCMPRFX+156                                              10278000
UCM      EQU   0                                                        10279000
UCMDECB  EQU   UCM+12                                                   10280000
UCMRPYI  EQU   UCM+32                                                   10281000
UCMPXB   EQU   UCM+68                                                   10282000
UCMMODE  EQU   UCMPXB                                                   10283000
UCMVDATA EQU   UCM+72                                                   10284000
UCMRSV42 EQU   UCM+300                                                  10285000
UCMRSV51 EQU   UCM+301                                                  10286000
UCMEIL   EQU   0                                                        10287000
UCMRECBA EQU   UCMEIL+24                                                10288000
UCMLIST  EQU   0                                                        10289000
UCMSTS   EQU   UCMLIST+24                                               10290000
UCMATR   EQU   UCMLIST+25                                               10291000
UCMXA    EQU   UCMLIST+26                                               10292000
UCMID    EQU   UCMXA                                                    10293000
UCMAUTH  EQU   UCMLIST+40                                               10294000
UCMAUTHA EQU   UCMAUTH                                                  10295000
UCMDISP  EQU   UCMLIST+42                                               10296000
UCMDISP1 EQU   UCMDISP                                                  10297000
UCMDISP2 EQU   UCMDISP+1                                                10298000
UCMMSG   EQU   UCMLIST+60                                               10299000
UCMMSG1  EQU   UCMMSG                                                   10300000
UCMDEVC  EQU   UCMLIST+63                                               10301000
UCMRCT   EQU   UCMLIST+68                                               10302000
UCMSDS5  EQU   UCMRCT                                                   10303000
UCMFEXTP EQU   UCMLIST+72                                               10304000
UCMEXIT  EQU   0                                                        10305000
UCMFEXTA EQU   0                                                        10306000
UCMFPPTR EQU   UCMFEXTA+4                                               10307000
UCMFMGFS EQU   UCMFEXTA+8                                               10308000
UCMFFLG1 EQU   UCMFMGFS                                                 10309000
UCMFECBL EQU   UCMFEXTA+28                                              10310000
UCMFRECB EQU   UCMFECBL+4                                               10311000
UCMFRBYT EQU   UCMFRECB                                                 10312000
UCMPEXTA EQU   0                                                        10313000
UCMPDM1  EQU   UCMPEXTA+4                                               10314000
UCMEFEXT EQU   0                                                        10315000
UCMEFLG1 EQU   UCMEFEXT                                                 10316000
UCMEFPEX EQU   UCMEFEXT+4                                               10317000
ESTA     EQU   0                                                        10318000
ESTAEXT  EQU   ESTA                                                     10319000
ESTAFLG1 EQU   ESTAEXT                                                  10320000
ESTAIO   EQU   ESTAFLG1                                                 10321000
ESTAFGRS EQU   ESTA+12                                                  10322000
ESTAFLG2 EQU   ESTAFGRS                                                 10323000
VMVRQBLK EQU   0                                                        10324000
VMVFNMAP EQU   VMVRQBLK                                                 10325000
VMVOPTB1 EQU   VMVFNMAP                                                 10326000
VMVUNLOD EQU   VMVOPTB1                                                 10327000
VMVUCB   EQU   VMVOPTB1                                                 10328000
VMVOPTB2 EQU   VMVFNMAP+1                                               10329000
VMVOPTB3 EQU   VMVFNMAP+2                                               10330000
VMVUCBP  EQU   VMVRQBLK+9                                               10331000
VMVMINFO EQU   VMVRQBLK+40                                              10332000
VMVACTON EQU   VMVMINFO                                                 10333000
VMVUSER  EQU   VMVRQBLK+48                                              10334000
IRT      EQU   0                                                        10335000
IRTENTRY EQU   IRT                                                      10336000
IRTFLA   EQU   IRTENTRY                                                 10337000
IRTFLB   EQU   IRTENTRY+1                                               10338000
IRTENVR  EQU   IRTENTRY+2                                               10339000
IRTCHMSK EQU   IRT+32                                                   10340000
IOCOM    EQU   0                                                        10341000
IOCCTBL  EQU   IOCOM+12                                                 10342000
IOCOMEX  EQU   IOCOM+64                                                 10343000
IOCX     EQU   0                                                        10344000
IOX      EQU   IOCX                                                     10345000
IOXCHMSK EQU   IOCX+2                                                   10346000
IOXCRHA  EQU   IOCX+12                                                  10347000
IOXCRHD  EQU   IOCX+16                                                  10348000
IOXSTIDC EQU   IOCX+20                                                  10349000
ICB2SSCB EQU   0                                                        10350000
ICBOPT   EQU   ICB2SSCB+48                                              10351000
ICBFLG   EQU   ICB2SSCB+52                                              10352000
ICBFG1   EQU   ICBFLG                                                   10353000
ICBI     EQU   ICBFG1                                                   10354000
ICBMSCA  EQU   ICBFG1                                                   10355000
ICBTRACE EQU   ICB2SSCB+112                                             10356000
CONVCHAR EQU   0                                                        10357000
WSAG     EQU   0                                                        10358000
WSAGGMFM EQU   WSAG+4                                                   10359000
LGTHTBL  EQU   0                                                        10360000
NUM      EQU   LGTHTBL                                                  10361000
LGTH     EQU   LGTHTBL+2                                                10362000
FSIZE    EQU   LGTHTBL+4                                                10363000
SVPTR    EQU   0                                                        10364000
NWSASIZE EQU   0                                                        10365000
NGRTCA   EQU   0                                                        10366000
GRTCA    EQU   0                                                        10367000
I001C    EQU   0                                                        10368000
I008P    EQU   0                                                        10369000
I015F    EQU   0                                                        10370000
I015P    EQU   0                                                        10371000
I031F    EQU   0                                                        10372000
I031P    EQU   0                                                        10373000
I256C    EQU   0                                                        10374000
UCMEPEXT EQU   0                                                        10375000
UCM2PTR  EQU   0                                                        10376000
CSCB     EQU   0                                                        10377000
HEXRSLT  EQU   0                                                        10378000
BITMASK  EQU   0                                                        10379000
FREEPTR  EQU   0                                                        10380000
IOCOMPTR EQU   CVTIXAVL                                                 10381000
IOCXPTR  EQU   IOCOMEX                                                  10382000
RVTPTR   EQU   CVTRMS                                                   10383000
UCMBASPT EQU   CVTCUCB                                                  10384000
UCMMCSPT EQU   UCMPRFXP                                                 10385000
UCMDVEPT EQU   UCMMCENT                                                 10386000
CVTS01   EQU   CVTPGSIA                                                 10387000
CVTLPDIA EQU   CVTS01+12                                                10388000
CVTDIRST EQU   CVTLPDIA                                                 10389000
CVTSLIDA EQU   CVTS01+24                                                10390000
CVTCTLFG EQU   CVTS01+50                                                10391000
CVTASVT  EQU   CVTS01+208                                               10392000
CVTCSD   EQU   CVTS01+312                                               10393000
CVTGLMN  EQU   CVTS01+332                                               10394000
CVTSPSA  EQU   CVTS01+336                                               10395000
CVTWSAC  EQU   CVTS01+348                                               10396000
CVTRSTWD EQU   CVTS01+368                                               10397000
CVTIPCDS EQU   CVTS01+404                                               10398000
CVTIPCRI EQU   CVTS01+408                                               10399000
CVTIPCRP EQU   CVTS01+412                                               10400000
CVTPCCAT EQU   CVTS01+416                                               10401000
CVTLCCAT EQU   CVTS01+420                                               10402000
CVTRV210 EQU   CVTS01+424                                               10403000
CVTRV219 EQU   CVTS01+425                                               10404000
CVTRV228 EQU   CVTS01+426                                               10405000
CVTRV237 EQU   CVTS01+427                                               10406000
CVTMFRTR EQU   CVTS01+452                                               10407000
CVTRV262 EQU   CVTS01+468                                               10408000
CVTRV271 EQU   CVTS01+469                                               10409000
CVTRV280 EQU   CVTS01+470                                               10410000
CVTRV289 EQU   CVTS01+471                                               10411000
CVTSPFRR EQU   CVTS01+512                                               10412000
CVTVACR  EQU   CVTS01+544                                               10413000
CVTQUIT  EQU   CVTS01+548                                               10414000
CVTVPSA  EQU   CVTS01+560                                               10415000
CVTGSDA  EQU   CVTS01+600                                               10416000
CVTCRCA  EQU   CVTS01+612                                               10417000
CVTCDAL  EQU   CVTS01+684                                               10418000
ASVTPTR  EQU   CVTASVT                                                  10419000
CHAINS01 EQU   CHASM                                                    10420000
CHBUF    EQU   CHAINS01                                                 10421000
CHTYPE   EQU   CHAINS01+124                                             10422000
CHTRSTAT EQU   CHAINS01+125                                             10423000
CHINC    EQU   CHAINS01+132                                             10424000
CHCSYSO  EQU   CHAINS01+134                                             10425000
FLC      EQU   PSA                                                      10426000
PSARSVTE EQU   PSARSVT                                                  10427000
PSACSTK  EQU   PSARSVTE                                                 10428000
PSANSTK  EQU   PSARSVTE+4                                               10429000
PSASSTK  EQU   PSARSVTE+8                                               10430000
PSARSTK  EQU   PSARSVTE+56                                              10431000
UCBOBS01 EQU   UCBDEV                                                   10432000
UCBSTAB  EQU   UCBOBS01+10                                              10433000
UCBBSVL  EQU   UCBSTAB                                                  10434000
UCBPRSRS EQU   UCBSTAB                                                  10435000
UCBDMCT  EQU   UCBOBS01+11                                              10436000
UCBFL4   EQU   UCBOBS01+13                                              10437000
UCBBASE  EQU   UCBOBS01+16                                              10438000
UCBOBS02 EQU   UCBDEV                                                   10439000
UCBTFL1  EQU   UCBOBS02+19                                              10440000
UCBXTN   EQU   UCBOBS02+20                                              10441000
UCBVOPT  EQU   UCBXTN                                                   10442000
UCBOBS03 EQU   UCBDEV                                                   10443000
UCBXTADR EQU   UCBOBS03                                                 10444000
UCBOBS04 EQU   UCBDEV                                                   10445000
UCBBTA   EQU   UCBOBS04+12                                              10446000
UCBOBS06 EQU   UCBDEV                                                   10447000
UCBAOF   EQU   UCBOBS06                                                 10448000
UCBAOF1  EQU   UCBAOF                                                   10449000
UCBAOF2  EQU   UCBAOF+1                                                 10450000
@NM00097 EQU   UCBOBS06+3                                               10451000
UCBIRB   EQU   UCBOBS06+4                                               10452000
UCBGRAF  EQU   UCBIRB                                                   10453000
UCBLDNCA EQU   UCBOBS06+8                                               10454000
UCBRDYQ  EQU   UCBLDNCA                                                 10455000
UCBIRLN  EQU   UCBRDYQ                                                  10456000
UCBLDNCB EQU   UCBRDYQ+1                                                10457000
UCBCTLNK EQU   UCBOBS06+12                                              10458000
UCBOBS07 EQU   UCBDEV                                                   10459000
UCBOBS08 EQU   UCBDEV                                                   10460000
UCBCTCAD EQU   UCBOBS08                                                 10461000
UCBCTCF1 EQU   UCBOBS08+4                                               10462000
UCBOBS09 EQU   UCBDEV                                                   10463000
UCMIECBA EQU   UCMRECBA+4                                               10464000
@NM00117 EQU   FLCRNPSW                                                 10465000
RNPSW    EQU   @NM00117                                                 10466000
@NM00119 EQU   RNPSW+1                                                  10467000
RNWAIT   EQU   @NM00119                                                 10468000
RNPSWAD  EQU   @NM00117+4                                               10469000
@NM00124 EQU   WTORPL2+11                                               10470000
WTORDDD  EQU   @NM00124+9                                               10471000
I056     EQU   ILIST                                                    10472000
I05601   EQU   I056                                                     10473000
I05602   EQU   I056+4                                                   10474000
I05603   EQU   I05602                                                   10475000
I05604   EQU   I05602+1                                                 10476000
I05605   EQU   I05602+2                                                 10477000
I05606   EQU   I05602+4                                                 10478000
I05607   EQU   I05602+8                                                 10479000
I006     EQU   ILIST                                                    10480000
I00601   EQU   I006                                                     10481000
I00602   EQU   I006+1                                                   10482000
I00603   EQU   I006+4                                                   10483000
I00604   EQU   I006+5                                                   10484000
I004     EQU   ILIST                                                    10485000
I00401   EQU   I004                                                     10486000
I00403   EQU   I004+5                                                   10487000
I00404   EQU   I004+8                                                   10488000
I00405   EQU   I004+9                                                   10489000
I005     EQU   ILIST                                                    10490000
I00502   EQU   I005+1                                                   10491000
I00504   EQU   I005+5                                                   10492000
I00505   EQU   I005+8                                                   10493000
I00506   EQU   I005+9                                                   10494000
STKADDR  EQU   PSACSTK                                                  10495000
STKLW3BT EQU   STKADDR+3                                                10496000
CSDAL    EQU   CSDCPUAL                                                 10497000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    10498000
@NM00141 EQU   STKADDR                                                  10499000
I00503   EQU   I005+4                                                   10500000
I00501   EQU   I005                                                     10501000
I00402   EQU   I004+4                                                   10502000
I00605   EQU   I006+8                                                   10503000
I05655   EQU   I05602+3                                                 10504000
@NM00125 EQU   @NM00124                                                 10505000
@NM00120 EQU   @NM00119                                                 10506000
@NM00118 EQU   RNPSW                                                    10507000
UCMIECBP EQU   UCMIECBA+1                                               10508000
UCMIECBF EQU   UCMIECBA                                                 10509000
UCBRV066 EQU   UCBOBS09+4                                               10510000
UCBIOSBA EQU   UCBOBS09                                                 10511000
UCBRV042 EQU   UCBOBS08+5                                               10512000
UCBRV082 EQU   UCBCTCF1                                                 10513000
UCBRV081 EQU   UCBCTCF1                                                 10514000
UCBRV080 EQU   UCBCTCF1                                                 10515000
UCBRV079 EQU   UCBCTCF1                                                 10516000
UCBRV078 EQU   UCBCTCF1                                                 10517000
UCBRV077 EQU   UCBCTCF1                                                 10518000
UCBRV076 EQU   UCBCTCF1                                                 10519000
UCBCTC80 EQU   UCBCTCF1                                                 10520000
UCBCTCAL EQU   UCBCTCAD                                                 10521000
UCBICNCB EQU   UCBOBS07+4                                               10522000
UCBRV040 EQU   UCBOBS07                                                 10523000
UCBCTLNA EQU   UCBCTLNK+1                                               10524000
UCBRLN   EQU   UCBCTLNK                                                 10525000
UCBRDYQA EQU   UCBLDNCB                                                 10526000
UCBINRLN EQU   UCBIRLN                                                  10527000
UCBIRBA  EQU   UCBIRB+1                                                 10528000
UCBRV039 EQU   UCBGRAF                                                  10529000
UCBDWNR  EQU   UCBGRAF                                                  10530000
UCBRPND  EQU   UCBGRAF                                                  10531000
UCBUPM   EQU   UCBGRAF                                                  10532000
UCBBTAM  EQU   UCBGRAF                                                  10533000
UCBDRNO  EQU   UCBGRAF                                                  10534000
UCBDRO   EQU   UCBGRAF                                                  10535000
UCBOIP   EQU   UCBGRAF                                                  10536000
UCBATRCD EQU   @NM00097                                                 10537000
UCBSKPFG EQU   @NM00097                                                 10538000
UCBRIPND EQU   @NM00097                                                 10539000
UCBRTIAC EQU   @NM00097                                                 10540000
UCBRSV79 EQU   @NM00097                                                 10541000
UCBRSV78 EQU   @NM00097                                                 10542000
UCBRSV77 EQU   @NM00097                                                 10543000
UCBOLTEP EQU   @NM00097                                                 10544000
UCBATNCT EQU   UCBOBS06+2                                               10545000
UCBRSV76 EQU   UCBAOF2                                                  10546000
UCBRSV75 EQU   UCBAOF2                                                  10547000
UCBRSV74 EQU   UCBAOF2                                                  10548000
UCBRSV73 EQU   UCBAOF2                                                  10549000
UCBRSV72 EQU   UCBAOF2                                                  10550000
UCBRSV71 EQU   UCBAOF2                                                  10551000
UCBRSV70 EQU   UCBAOF2                                                  10552000
UCBRSV69 EQU   UCBAOF2                                                  10553000
UCBRSV68 EQU   UCBAOF1                                                  10554000
UCBRSV67 EQU   UCBAOF1                                                  10555000
UCBRSV66 EQU   UCBAOF1                                                  10556000
UCBRSV65 EQU   UCBAOF1                                                  10557000
UCBRSV64 EQU   UCBAOF1                                                  10558000
UCBOFNL  EQU   UCBAOF1                                                  10559000
UCBOFSP  EQU   UCBAOF1                                                  10560000
UCBOFMCR EQU   UCBAOF1                                                  10561000
UCBBTB   EQU   UCBBTA+1                                                 10562000
UCBDI    EQU   UCBBTA                                                   10563000
UCBSNS   EQU   UCBOBS04+8                                               10564000
UCBTEB   EQU   UCBOBS04+4                                               10565000
UCBGCB   EQU   UCBOBS04+3                                               10566000
UCBOPEN  EQU   UCBOBS04+2                                               10567000
UCBSTART EQU   UCBOBS04                                                 10568000
UCBXTNB  EQU   UCBXTN+1                                                 10569000
UCBRSV22 EQU   UCBVOPT                                                  10570000
UCBRSV21 EQU   UCBVOPT                                                  10571000
UCBRSV20 EQU   UCBVOPT                                                  10572000
UCBESVE  EQU   UCBVOPT                                                  10573000
UCBERPC  EQU   UCBVOPT                                                  10574000
UCBESVC  EQU   UCBVOPT                                                  10575000
UCBEVA   EQU   UCBVOPT                                                  10576000
UCBESV   EQU   UCBVOPT                                                  10577000
UCBRV009 EQU   UCBTFL1                                                  10578000
UCBRV008 EQU   UCBTFL1                                                  10579000
UCBRV007 EQU   UCBTFL1                                                  10580000
UCBRV006 EQU   UCBTFL1                                                  10581000
UCBRV005 EQU   UCBTFL1                                                  10582000
UCBDQDSP EQU   UCBTFL1                                                  10583000
UCBNSLTP EQU   UCBTFL1                                                  10584000
UCBNLTP  EQU   UCBTFL1                                                  10585000
UCBRES1B EQU   UCBOBS02+18                                              10586000
UCBFSER  EQU   UCBOBS02+12                                              10587000
@NM00096 EQU   UCBOBS02+4                                               10588000
UCBFSEQ  EQU   UCBOBS02+2                                               10589000
UCBFSCT  EQU   UCBOBS02                                                 10590000
UCBNEXP  EQU   UCBOBS01+20                                              10591000
UCBRES1A EQU   UCBOBS01+15                                              10592000
UCBUSER  EQU   UCBOBS01+14                                              10593000
UCBFL47  EQU   UCBFL4                                                   10594000
UCBMAT   EQU   UCBFL4                                                   10595000
UCBHOLD  EQU   UCBFL4                                                   10596000
UCBATTN  EQU   UCBFL4                                                   10597000
UCBDSS   EQU   UCBFL4                                                   10598000
UCBRESVP EQU   UCBFL4                                                   10599000
UCBWDAV  EQU   UCBFL4                                                   10600000
UCBDAVV  EQU   UCBFL4                                                   10601000
UCBSQC   EQU   UCBOBS01+12                                              10602000
UCBDATP  EQU   UCBOBS01+12                                              10603000
UCBDMC   EQU   UCBDMCT                                                  10604000
UCBMOUNT EQU   UCBDMCT                                                  10605000
UCBBNUL  EQU   UCBSTAB                                                  10606000
UCBSHAR  EQU   UCBSTAB                                                  10607000
UCBBSTR  EQU   UCBSTAB                                                  10608000
UCBBPUB  EQU   UCBSTAB                                                  10609000
UCBBPRV  EQU   UCBSTAB                                                  10610000
UCBBALB  EQU   UCBPRSRS                                                 10611000
UCBPGFL  EQU   UCBSTAB                                                  10612000
UCBDVSHR EQU   UCBBSVL                                                  10613000
UCBVOLI  EQU   UCBOBS01+4                                               10614000
UCBVTOC  EQU   UCBOBS01                                                 10615000
PSARSAV  EQU   PSARSVTE+60                                              10616000
PSAESAV3 EQU   PSARSVTE+52                                              10617000
PSAESTK3 EQU   PSARSVTE+48                                              10618000
PSAESAV2 EQU   PSARSVTE+44                                              10619000
PSAESTK2 EQU   PSARSVTE+40                                              10620000
PSAESAV1 EQU   PSARSVTE+36                                              10621000
PSAESTK1 EQU   PSARSVTE+32                                              10622000
PSAPSAV  EQU   PSARSVTE+28                                              10623000
PSAPSTK  EQU   PSARSVTE+24                                              10624000
PSAMSAV  EQU   PSARSVTE+20                                              10625000
PSAMSTK  EQU   PSARSVTE+16                                              10626000
PSASSAV  EQU   PSARSVTE+12                                              10627000
CHLAST   EQU   CHAINS01+136                                             10628000
CHSPA    EQU   CHAINS01+135                                             10629000
CHUSERID EQU   CHCSYSO                                                  10630000
CHJB     EQU   CHCSYSO                                                  10631000
CHDUMP   EQU   CHCSYSO                                                  10632000
CHQUE    EQU   CHCSYSO                                                  10633000
CHHOLD   EQU   CHCSYSO                                                  10634000
CHOUT    EQU   CHCSYSO                                                  10635000
CHINN    EQU   CHCSYSO                                                  10636000
CHALL    EQU   CHCSYSO                                                  10637000
CHPEND   EQU   CHAINS01+128                                             10638000
CHARID   EQU   CHAINS01+127                                             10639000
CHCNID   EQU   CHAINS01+126                                             10640000
@NM00015 EQU   CHTRSTAT                                                 10641000
CHTSL    EQU   CHTRSTAT                                                 10642000
CHTS     EQU   CHTRSTAT                                                 10643000
CHINITL  EQU   CHTRSTAT                                                 10644000
CHINIT   EQU   CHTRSTAT                                                 10645000
CHJOBSL  EQU   CHTRSTAT                                                 10646000
CHJOBS   EQU   CHTRSTAT                                                 10647000
CHDEF    EQU   CHTYPE                                                   10648000
CHHIAR   EQU   CHTYPE                                                   10649000
CHARSV29 EQU   CHTYPE                                                   10650000
CHARSV28 EQU   CHTYPE                                                   10651000
CHARSV27 EQU   CHTYPE                                                   10652000
CHARSV26 EQU   CHTYPE                                                   10653000
CHARSV25 EQU   CHTYPE                                                   10654000
CHDSTAT  EQU   CHTYPE                                                   10655000
CVTRV628 EQU   CVTS01+728                                               10656000
CVTRV627 EQU   CVTS01+724                                               10657000
CVTRV626 EQU   CVTS01+720                                               10658000
CVTRV625 EQU   CVTS01+716                                               10659000
CVTRV624 EQU   CVTS01+712                                               10660000
CVTRV623 EQU   CVTS01+708                                               10661000
CVTRV622 EQU   CVTS01+704                                               10662000
CVTRV621 EQU   CVTS01+700                                               10663000
CVTIHASU EQU   CVTS01+696                                               10664000
CVTSUSP  EQU   CVTS01+692                                               10665000
CVTT6SVC EQU   CVTS01+688                                               10666000
CVTTCTL  EQU   CVTS01+680                                               10667000
CVTRSUME EQU   CVTS01+676                                               10668000
CVTJTERM EQU   CVTS01+672                                               10669000
CVTASMRM EQU   CVTS01+668                                               10670000
CVTTCASP EQU   CVTS01+664                                               10671000
CVT0PT03 EQU   CVTS01+660                                               10672000
CVT0PT0E EQU   CVTS01+656                                               10673000
CVTRV609 EQU   CVTS01+652                                               10674000
CVTCGK   EQU   CVTS01+648                                               10675000
CVTRAC   EQU   CVTS01+644                                               10676000
CVTHSM   EQU   CVTS01+640                                               10677000
CVTRV605 EQU   CVTS01+636                                               10678000
CVTRV604 EQU   CVTS01+632                                               10679000
CVTEFF02 EQU   CVTS01+628                                               10680000
CVTCBBR  EQU   CVTS01+624                                               10681000
CVTSSCR  EQU   CVTS01+620                                               10682000
CVTEVENT EQU   CVTS01+616                                               10683000
CVTTPIO  EQU   CVTS01+608                                               10684000
CVTADV   EQU   CVTS01+604                                               10685000
CVTGSDAB EQU   CVTGSDA                                                  10686000
CVTQV3   EQU   CVTS01+596                                               10687000
CVTQV2   EQU   CVTS01+592                                               10688000
CVTQV1   EQU   CVTS01+588                                               10689000
CVTRPT   EQU   CVTS01+584                                               10690000
CVTSSRB  EQU   CVTS01+580                                               10691000
CVTCSDRL EQU   CVTS01+576                                               10692000
CVTEXP1  EQU   CVTS01+572                                               10693000
CVTRMPMT EQU   CVTS01+568                                               10694000
CVTRMPTT EQU   CVTS01+564                                               10695000
CVTVSTOP EQU   CVTS01+556                                               10696000
CVTGTFR8 EQU   CVTS01+552                                               10697000
CVTWTCB  EQU   CVTS01+540                                               10698000
CVTSTPRS EQU   CVTS01+536                                               10699000
CVT0PT02 EQU   CVTS01+532                                               10700000
CVTDARCM EQU   CVTS01+528                                               10701000
CVTIRECM EQU   CVTS01+524                                               10702000
CVTJRECM EQU   CVTS01+520                                               10703000
CVTVEMS0 EQU   CVTS01+516                                               10704000
CVTRLSTG EQU   CVTS01+508                                               10705000
CVT0TC0A EQU   CVTS01+504                                               10706000
CVTGMBR  EQU   CVTS01+500                                               10707000
CVTLFRM  EQU   CVTS01+496                                               10708000
CVTRMBR  EQU   CVTS01+492                                               10709000
CVTVIOP  EQU   CVTS01+488                                               10710000
CVTRV307 EQU   CVTS01+486                                               10711000
CVTRV306 EQU   CVTS01+484                                               10712000
CVTRV305 EQU   CVTS01+482                                               10713000
CVTRV304 EQU   CVTS01+480                                               10714000
CVTRV303 EQU   CVTS01+478                                               10715000
CVTRV302 EQU   CVTS01+476                                               10716000
CVTTRCA  EQU   CVTS01+472                                               10717000
CVTRV297 EQU   CVTRV289                                                 10718000
CVTRV296 EQU   CVTRV289                                                 10719000
CVTRV295 EQU   CVTRV289                                                 10720000
CVTRV294 EQU   CVTRV289                                                 10721000
CVTRV293 EQU   CVTRV289                                                 10722000
CVTRV292 EQU   CVTRV289                                                 10723000
CVTRV291 EQU   CVTRV289                                                 10724000
CVTRV290 EQU   CVTRV289                                                 10725000
CVTRV288 EQU   CVTRV280                                                 10726000
CVTRV287 EQU   CVTRV280                                                 10727000
CVTRV286 EQU   CVTRV280                                                 10728000
CVTRV285 EQU   CVTRV280                                                 10729000
CVTRV284 EQU   CVTRV280                                                 10730000
CVTRV283 EQU   CVTRV280                                                 10731000
CVTRV282 EQU   CVTRV280                                                 10732000
CVTRV281 EQU   CVTRV280                                                 10733000
CVTRV279 EQU   CVTRV271                                                 10734000
CVTRV278 EQU   CVTRV271                                                 10735000
CVTRV277 EQU   CVTRV271                                                 10736000
CVTRV276 EQU   CVTRV271                                                 10737000
CVTRV275 EQU   CVTRV271                                                 10738000
CVTRV274 EQU   CVTRV271                                                 10739000
CVTRV273 EQU   CVTRV271                                                 10740000
CVTRV272 EQU   CVTRV271                                                 10741000
CVTRV270 EQU   CVTRV262                                                 10742000
CVTRV269 EQU   CVTRV262                                                 10743000
CVTRV268 EQU   CVTRV262                                                 10744000
CVTRV267 EQU   CVTRV262                                                 10745000
CVTRV266 EQU   CVTRV262                                                 10746000
CVTRV265 EQU   CVTRV262                                                 10747000
CVTRV264 EQU   CVTRV262                                                 10748000
CVTRV263 EQU   CVTRV262                                                 10749000
CVTVFP   EQU   CVTS01+464                                               10750000
CVTVSI   EQU   CVTS01+460                                               10751000
CVTVPSIB EQU   CVTS01+456                                               10752000
CVTMFACT EQU   CVTMFRTR                                                 10753000
CVTMFCTL EQU   CVTS01+448                                               10754000
CVTPVBP  EQU   CVTS01+444                                               10755000
CVTPWI   EQU   CVTS01+440                                               10756000
CVTRV254 EQU   CVTS01+438                                               10757000
CVTRV253 EQU   CVTS01+436                                               10758000
CVTRV252 EQU   CVTS01+434                                               10759000
CVTRV251 EQU   CVTS01+433                                               10760000
CVTRV250 EQU   CVTS01+432                                               10761000
CVTRV249 EQU   CVTS01+431                                               10762000
CVTRV248 EQU   CVTS01+430                                               10763000
CVTRV247 EQU   CVTS01+429                                               10764000
CVTRV246 EQU   CVTS01+428                                               10765000
CVTRV245 EQU   CVTRV237                                                 10766000
CVTRV244 EQU   CVTRV237                                                 10767000
CVTRV243 EQU   CVTRV237                                                 10768000
CVTRV242 EQU   CVTRV237                                                 10769000
CVTRV241 EQU   CVTRV237                                                 10770000
CVTRV240 EQU   CVTRV237                                                 10771000
CVTRV239 EQU   CVTRV237                                                 10772000
CVTRV238 EQU   CVTRV237                                                 10773000
CVTRV236 EQU   CVTRV228                                                 10774000
CVTRV235 EQU   CVTRV228                                                 10775000
CVTRV234 EQU   CVTRV228                                                 10776000
CVTRV233 EQU   CVTRV228                                                 10777000
CVTRV232 EQU   CVTRV228                                                 10778000
CVTRV231 EQU   CVTRV228                                                 10779000
CVTRV230 EQU   CVTRV228                                                 10780000
CVTRV229 EQU   CVTRV228                                                 10781000
CVTRV227 EQU   CVTRV219                                                 10782000
CVTRV226 EQU   CVTRV219                                                 10783000
CVTRV225 EQU   CVTRV219                                                 10784000
CVTRV224 EQU   CVTRV219                                                 10785000
CVTRV223 EQU   CVTRV219                                                 10786000
CVTRV222 EQU   CVTRV219                                                 10787000
CVTRV221 EQU   CVTRV219                                                 10788000
CVTRV220 EQU   CVTRV219                                                 10789000
CVTRV218 EQU   CVTRV210                                                 10790000
CVTRV217 EQU   CVTRV210                                                 10791000
CVTRV216 EQU   CVTRV210                                                 10792000
CVTRV215 EQU   CVTRV210                                                 10793000
CVTRV214 EQU   CVTRV210                                                 10794000
CVTRV213 EQU   CVTRV210                                                 10795000
CVTRV212 EQU   CVTRV210                                                 10796000
CVTRV211 EQU   CVTRV210                                                 10797000
CVTAIDVT EQU   CVTS01+400                                               10798000
CVTSSAP  EQU   CVTS01+396                                               10799000
CVTEHCIR EQU   CVTS01+392                                               10800000
CVTEHDEF EQU   CVTS01+388                                               10801000
CVTDAIR  EQU   CVTS01+384                                               10802000
CVTPERFM EQU   CVTS01+380                                               10803000
CVT044R2 EQU   CVTS01+376                                               10804000
CVTFETCH EQU   CVTS01+372                                               10805000
CVTSPOST EQU   CVTS01+364                                               10806000
CVTIOBP  EQU   CVTS01+360                                               10807000
CVTASMVT EQU   CVTS01+356                                               10808000
CVTRECRQ EQU   CVTS01+352                                               10809000
CVTRV149 EQU   CVTS01+344                                               10810000
CVTWSAL  EQU   CVTS01+340                                               10811000
CVTVEAC0 EQU   CVTS01+328                                               10812000
CVT062R1 EQU   CVTS01+324                                               10813000
CVTRPOST EQU   CVTS01+320                                               10814000
CVTDQIQE EQU   CVTS01+316                                               10815000
CVTLKRMA EQU   CVTS01+308                                               10816000
CVTRSPIE EQU   CVTS01+304                                               10817000
CVTRENQ  EQU   CVTS01+300                                               10818000
CVTLQCB  EQU   CVTS01+296                                               10819000
CVTFQCB  EQU   CVTS01+292                                               10820000
CVTQCS01 EQU   CVTS01+288                                               10821000
CVTAPFT  EQU   CVTS01+284                                               10822000
CVTPARRL EQU   CVTS01+280                                               10823000
CVTVWAIT EQU   CVTS01+276                                               10824000
CVTGSPL  EQU   CVTS01+272                                               10825000
CVTLSMQ  EQU   CVTS01+268                                               10826000
CVTGSMQ  EQU   CVTS01+264                                               10827000
CVTEXPRO EQU   CVTS01+260                                               10828000
CVTOPCTP EQU   CVTS01+256                                               10829000
CVTSIC   EQU   CVTS01+252                                               10830000
CVTTPIOS EQU   CVTS01+248                                               10831000
CVTRTMS  EQU   CVTS01+244                                               10832000
CVTSDBF  EQU   CVTS01+240                                               10833000
CVTSCBP  EQU   CVTS01+236                                               10834000
CVTSDMP  EQU   CVTS01+232                                               10835000
CVTSV60  EQU   CVTS01+228                                               10836000
CVTRTMCT EQU   CVTS01+224                                               10837000
CVTASCBL EQU   CVTS01+220                                               10838000
CVTASCBH EQU   CVTS01+216                                               10839000
CVTGDA   EQU   CVTS01+212                                               10840000
CVTVVMDI EQU   CVTS01+204                                               10841000
CVTAQTOP EQU   CVTS01+200                                               10842000
CVTIOSCS EQU   CVTS01+196                                               10843000
CVTSDRM  EQU   CVTS01+192                                               10844000
CVTOPTE  EQU   CVTS01+188                                               10845000
CVTSTXU  EQU   CVTS01+184                                               10846000
CVTQUIS  EQU   CVTS01+180                                               10847000
CVTPARS  EQU   CVTS01+176                                               10848000
CVTS1EE  EQU   CVTS01+172                                               10849000
CVTFRAS  EQU   CVTS01+168                                               10850000
CVTQSAS  EQU   CVTS01+164                                               10851000
CVTCRAS  EQU   CVTS01+160                                               10852000
CVTCRMN  EQU   CVTS01+156                                               10853000
CVTDELCP EQU   CVTS01+152                                               10854000
CVTFRECL EQU   CVTS01+148                                               10855000
CVTGETCL EQU   CVTS01+144                                               10856000
CVTBLDCP EQU   CVTS01+140                                               10857000
CVTAUTHL EQU   CVTS01+136                                               10858000
CVTSCAN  EQU   CVTS01+132                                               10859000
CVTRV144 EQU   CVTS01+130                                               10860000
CVTMAXMP EQU   CVTS01+128                                               10861000
CVTSTCK  EQU   CVTS01+124                                               10862000
CVTRV139 EQU   CVTS01+123                                               10863000
CVTDSSAC EQU   CVTS01+122                                               10864000
CVTRV513 EQU   CVTS01+121                                               10865000
CVTIOSPL EQU   CVTS01+120                                               10866000
CVTPTGT  EQU   CVTS01+116                                               10867000
CVTCSPIE EQU   CVTS01+112                                               10868000
CVTSMFEX EQU   CVTS01+108                                               10869000
CVTOLT0A EQU   CVTS01+104                                               10870000
CVTSRBRT EQU   CVTS01+100                                               10871000
CVTPUTL  EQU   CVTS01+96                                                10872000
CVTASCRL EQU   CVTS01+92                                                10873000
CVTASCRF EQU   CVTS01+88                                                10874000
CVTRV326 EQU   CVTS01+84                                                10875000
CVTRV325 EQU   CVTS01+80                                                10876000
CVTRV324 EQU   CVTS01+76                                                10877000
CVT0VL01 EQU   CVTS01+72                                                10878000
CVTSHRVM EQU   CVTS01+68                                                10879000
CVTRV332 EQU   CVTS01+64                                                10880000
CVTTAS   EQU   CVTS01+60                                                10881000
CVTRSCN  EQU   CVTS01+56                                                10882000
CVTTRAC2 EQU   CVTS01+54                                                10883000
CVTTRACE EQU   CVTS01+52                                                10884000
CVTAPG   EQU   CVTS01+51                                                10885000
CVTSDTRC EQU   CVTCTLFG                                                 10886000
CVTGTRCE EQU   CVTCTLFG                                                 10887000
CVTNOMP  EQU   CVTCTLFG                                                 10888000
CVTRSV79 EQU   CVTCTLFG                                                 10889000
CVTDSTAT EQU   CVTCTLFG                                                 10890000
CVTRSV78 EQU   CVTCTLFG                                                 10891000
CVTRV333 EQU   CVTCTLFG                                                 10892000
CVTRV323 EQU   CVTCTLFG                                                 10893000
CVTSPVLK EQU   CVTS01+49                                                10894000
CVTRSV77 EQU   CVTS01+48                                                10895000
CVTRV331 EQU   CVTS01+44                                                10896000
CVTRV330 EQU   CVTS01+40                                                10897000
CVTRV329 EQU   CVTS01+36                                                10898000
CVTRV328 EQU   CVTS01+32                                                10899000
CVTRV322 EQU   CVTS01+28                                                10900000
CVTSLID  EQU   CVTSLIDA+1                                               10901000
CVTSYLK  EQU   CVTSLIDA                                                 10902000
CVTRV321 EQU   CVTS01+20                                                10903000
CVTRV320 EQU   CVTS01+16                                                10904000
CVTLPDIR EQU   CVTLPDIA+1                                               10905000
CVTRSV69 EQU   CVTDIRST                                                 10906000
CVTRSV68 EQU   CVTDIRST                                                 10907000
CVTRSV67 EQU   CVTDIRST                                                 10908000
CVTRSV66 EQU   CVTDIRST                                                 10909000
CVTRSV65 EQU   CVTDIRST                                                 10910000
CVTRSV64 EQU   CVTDIRST                                                 10911000
CVTRSV63 EQU   CVTDIRST                                                 10912000
CVTDICOM EQU   CVTDIRST                                                 10913000
CVTPVTP  EQU   CVTS01+8                                                 10914000
CVTLPDSR EQU   CVTS01+4                                                 10915000
CVTGETL  EQU   CVTS01                                                   10916000
WSAGSCHE EQU   WSAG+40                                                  10917000
WSAGREST EQU   WSAG+36                                                  10918000
WSAGNQDQ EQU   WSAG+32                                                  10919000
WSAGMEMT EQU   WSAG+28                                                  10920000
WSAGOPTM EQU   WSAG+24                                                  10921000
WSAGSTAT EQU   WSAG+20                                                  10922000
WSAGEMS0 EQU   WSAG+16                                                  10923000
WSAGSSRS EQU   WSAG+12                                                  10924000
WSAGRSM  EQU   WSAG+8                                                   10925000
WSAGPGIO EQU   WSAG                                                     10926000
ICBCPUID EQU   ICB2SSCB+496                                             10927000
ICBLORD  EQU   ICBTRACE+256                                             10928000
ICBOTRC  EQU   ICBTRACE                                                 10929000
ICBFAB   EQU   ICB2SSCB+108                                             10930000
ICBMSSC  EQU   ICB2SSCB+104                                             10931000
ICBRSVP  EQU   ICB2SSCB+100                                             10932000
ICBAEAP  EQU   ICB2SSCB+96                                              10933000
ICBSIOBP EQU   ICB2SSCB+92                                              10934000
ICBIATNA EQU   ICB2SSCB+88                                              10935000
ICBIPRGA EQU   ICB2SSCB+84                                              10936000
ICBSRBP  EQU   ICB2SSCB+80                                              10937000
ICBVVICB EQU   ICB2SSCB+76                                              10938000
ICBVVIC  EQU   ICB2SSCB+72                                              10939000
ICBSIOP  EQU   ICB2SSCB+68                                              10940000
ICBMEP   EQU   ICB2SSCB+64                                              10941000
ICBIORCI EQU   ICB2SSCB+60                                              10942000
ICB2ACTP EQU   ICB2SSCB+56                                              10943000
ICBSAMP  EQU   ICBFLG+2                                                 10944000
ICBFG2   EQU   ICBFLG+1                                                 10945000
@NM00116 EQU   ICBFG1                                                   10946000
ICBMSCMP EQU   ICBFG1                                                   10947000
ICBS     EQU   ICBFG1                                                   10948000
ICBB     EQU   ICBFG1                                                   10949000
ICBV     EQU   ICBFG1                                                   10950000
ICBR     EQU   ICBFG1                                                   10951000
ICBNVT   EQU   ICBOPT                                                   10952000
ICBVN02P EQU   ICB2SSCB+44                                              10953000
ICBTCB   EQU   ICB2SSCB+40                                              10954000
ICBQHEAD EQU   ICB2SSCB+36                                              10955000
ICBAUCB  EQU   ICB2SSCB+32                                              10956000
ICBPUCB  EQU   ICB2SSCB+28                                              10957000
ICBCOMQ  EQU   ICB2SSCB+24                                              10958000
ICBIOR   EQU   ICB2SSCB+20                                              10959000
ICBCOM   EQU   ICB2SSCB+16                                              10960000
ICBACTV  EQU   ICB2SSCB+12                                              10961000
ICBECB   EQU   ICB2SSCB+8                                               10962000
ICBSSNAM EQU   ICB2SSCB                                                 10963000
IOXEND   EQU   IOCX+32                                                  10964000
IOXPSIF  EQU   IOCX+28                                                  10965000
IOXPSIX  EQU   IOCX+24                                                  10966000
IOXTCQSC EQU   IOCX+8                                                   10967000
@NM00115 EQU   IOCX+6                                                   10968000
IOXLCHCT EQU   IOCX+5                                                   10969000
IOXHICH  EQU   IOCX+4                                                   10970000
IOXOFSET EQU   IOX                                                      10971000
IOCOEND  EQU   IOCOM+128                                                10972000
IOCPATCH EQU   IOCOM+124                                                10973000
IOCUCBBM EQU   IOCOM+120                                                10974000
IOCQCNT  EQU   IOCOM+116                                                10975000
IOCIOSDQ EQU   IOCOM+112                                                10976000
IOCIOSEQ EQU   IOCOM+108                                                10977000
IOCSVCF  EQU   IOCOM+104                                                10978000
IOCTCCW  EQU   IOCOM+100                                                10979000
IOCRSVTB EQU   IOCOM+96                                                 10980000
IOCMFCNT EQU   IOCOM+92                                                 10981000
IOCMFHK  EQU   IOCOM+88                                                 10982000
IOCGENA  EQU   IOCOM+84                                                 10983000
IOCCCH   EQU   IOCOM+80                                                 10984000
IOCASYNQ EQU   IOCOM+76                                                 10985000
IOCLCHTB EQU   IOCOM+72                                                 10986000
IOCATTBL EQU   IOCOM+68                                                 10987000
IOCSYNCH EQU   IOCOM+56                                                 10988000
IOCCATLK EQU   IOCOM+48                                                 10989000
IOCPRGID EQU   IOCOM+44                                                 10990000
IOCIOSCP EQU   IOCOM+40                                                 10991000
IOCORMGT EQU   IOCOM+36                                                 10992000
IOCVOID  EQU   IOCOM+32                                                 10993000
IOCSTIO  EQU   IOCOM+28                                                 10994000
IOCSCOMP EQU   IOCOM+24                                                 10995000
IOCHD160 EQU   IOCOM+20                                                 10996000
IOCINT   EQU   IOCOM+16                                                 10997000
IOCHIO   EQU   IOCOM+8                                                  10998000
IOCPST   EQU   IOCOM+4                                                  10999000
IOCPGCT  EQU   IOCOM+2                                                  11000000
IOCVOICT EQU   IOCOM                                                    11001000
IRTEND   EQU   IRT+128                                                  11002000
IRTRSV0B EQU   IRT+124                                                  11003000
IRTCHNSV EQU   IRT+120                                                  11004000
IRTSNSCT EQU   IRT+116                                                  11005000
IRTLCHAD EQU   IRT+112                                                  11006000
IRTSTSSV EQU   IRT+108                                                  11007000
IRTINTSV EQU   IRT+104                                                  11008000
IRTCCHSV EQU   IRT+100                                                  11009000
IRTATTSV EQU   IRT+96                                                   11010000
IRTFRRWA EQU   IRT+92                                                   11011000
IRTNSRB  EQU   IRT+88                                                   11012000
IRTCSME  EQU   IRT+84                                                   11013000
IRTPRGSV EQU   IRT+80                                                   11014000
IRTPCISV EQU   IRT+76                                                   11015000
IRTSENSV EQU   IRT+72                                                   11016000
IRTDIESV EQU   IRT+68                                                   11017000
IRTRSTSV EQU   IRT+64                                                   11018000
IRTSTASV EQU   IRT+60                                                   11019000
IRTSIOSV EQU   IRT+56                                                   11020000
IRTDDSV  EQU   IRT+52                                                   11021000
IRTTCHSV EQU   IRT+48                                                   11022000
IRTRTNSV EQU   IRT+40                                                   11023000
IRTRSV01 EQU   IRT+36                                                   11024000
IRTPSTSV EQU   IRT+28                                                   11025000
IRTNIOQ  EQU   IRT+24                                                   11026000
IRTCHNL  EQU   IRT+20                                                   11027000
IRTIOQ   EQU   IRT+16                                                   11028000
IRTLCH   EQU   IRT+12                                                   11029000
IRTUCB   EQU   IRT+8                                                    11030000
@NM00114 EQU   IRT+7                                                    11031000
IRTCMRST EQU   IRT+6                                                    11032000
IRTCCH   EQU   IRT+5                                                    11033000
IRTSYMSK EQU   IRT+4                                                    11034000
@NM00113 EQU   IRTENTRY+3                                               11035000
IRTCSINT EQU   IRTENVR                                                  11036000
IRTPINT  EQU   IRTENVR                                                  11037000
IRTHIO   EQU   IRTENVR                                                  11038000
IRTRSTI  EQU   IRTENVR                                                  11039000
IRTCRHIN EQU   IRTENVR                                                  11040000
IRTSHTP  EQU   IRTENVR                                                  11041000
IRTSLIHA EQU   IRTENVR                                                  11042000
IRTCHENT EQU   IRTENVR                                                  11043000
@NM00112 EQU   IRTFLB                                                   11044000
IRTCCHWA EQU   IRTFLB                                                   11045000
IRT12GT  EQU   IRTFLB                                                   11046000
IRTSMGR  EQU   IRTFLB                                                   11047000
IRTCHBSY EQU   IRTFLB                                                   11048000
IRTPCISW EQU   IRTFLB                                                   11049000
IRTSKRST EQU   IRTFLB                                                   11050000
IRTNRST  EQU   IRTFLB                                                   11051000
IRTSSIGP EQU   IRTFLA                                                   11052000
IRTSLISN EQU   IRTFLA                                                   11053000
IRTIOQA  EQU   IRTFLA                                                   11054000
IRTALCK  EQU   IRTFLA                                                   11055000
IRTCLCK  EQU   IRTFLA                                                   11056000
IRTSLCK  EQU   IRTFLA                                                   11057000
IRTLLCK  EQU   IRTFLA                                                   11058000
IRTULCK  EQU   IRTFLA                                                   11059000
@NM00111 EQU   VMVUSER                                                  11060000
VMVPROCD EQU   VMVUSER                                                  11061000
VMVVUNTP EQU   VMVRQBLK+44                                              11062000
@NM00110 EQU   VMVMINFO+1                                               11063000
@NM00109 EQU   VMVACTON                                                 11064000
VMVRTAIN EQU   VMVACTON                                                 11065000
VMVDSMT  EQU   VMVACTON                                                 11066000
VMVKEEP  EQU   VMVACTON                                                 11067000
VMVRETCD EQU   VMVRQBLK+36                                              11068000
VMVJSNMP EQU   VMVRQBLK+32                                              11069000
VMVDSNMP EQU   VMVRQBLK+28                                              11070000
VMVJBNMP EQU   VMVRQBLK+24                                              11071000
VMVMVLSR EQU   VMVRQBLK+18                                              11072000
VMVUVLSR EQU   VMVRQBLK+12                                              11073000
@NM00108 EQU   VMVRQBLK+8                                               11074000
VMVNREQP EQU   VMVRQBLK+4                                               11075000
VMVOPTB4 EQU   VMVFNMAP+3                                               11076000
@NM00107 EQU   VMVOPTB3                                                 11077000
VMVNUMSG EQU   VMVOPTB3                                                 11078000
VMVCUVOL EQU   VMVOPTB3                                                 11079000
VMVDUPVL EQU   VMVOPTB3                                                 11080000
VMVNSPVT EQU   VMVOPTB2                                                 11081000
VMVNSLTP EQU   VMVOPTB2                                                 11082000
VMVSLTAP EQU   VMVOPTB2                                                 11083000
VMVNLTAP EQU   VMVOPTB2                                                 11084000
VMVALTAP EQU   VMVOPTB2                                                 11085000
VMVSTRG  EQU   VMVOPTB2                                                 11086000
VMVPUBLC EQU   VMVOPTB2                                                 11087000
VMVPRIVT EQU   VMVOPTB2                                                 11088000
VMVVDEND EQU   VMVOPTB1                                                 11089000
VMVVRLBL EQU   VMVOPTB1                                                 11090000
VMVDWTOR EQU   VMVOPTB1                                                 11091000
VMVMTMSG EQU   VMVOPTB1                                                 11092000
VMVMOUNT EQU   VMVOPTB1                                                 11093000
VMVREWND EQU   VMVOPTB1                                                 11094000
ESTARSVI EQU   ESTAFGRS+1                                               11095000
@NM00106 EQU   ESTAFLG2                                                 11096000
ESTABRNT EQU   ESTAFLG2                                                 11097000
@NM00105 EQU   ESTAFLG2                                                 11098000
ESTAEREC EQU   ESTAFLG2                                                 11099000
ESTATERM EQU   ESTAFLG2                                                 11100000
@NM00104 EQU   ESTAFLG2                                                 11101000
ESTAOWNR EQU   ESTA+8                                                   11102000
ESTAPARM EQU   ESTA+4                                                   11103000
ESTAEXIT EQU   ESTAEXT+1                                                11104000
ESTAHALT EQU   ESTAIO                                                   11105000
ESTANOIO EQU   ESTAIO                                                   11106000
ESTASYNC EQU   ESTAFLG1                                                 11107000
@NM00103 EQU   ESTAFLG1                                                 11108000
ESTAESTA EQU   ESTAFLG1                                                 11109000
@NM00102 EQU   ESTAFLG1                                                 11110000
ESTASTAR EQU   ESTAFLG1                                                 11111000
ESTASTAI EQU   ESTAFLG1                                                 11112000
UCMEFRV1 EQU   UCMEFEXT+8                                               11113000
UCMEFSA1 EQU   UCMEFEXT+3                                               11114000
UCMEFATT EQU   UCMEFEXT+2                                               11115000
UCMEFLG2 EQU   UCMEFEXT+1                                               11116000
UCMEFLGH EQU   UCMEFLG1                                                 11117000
UCMEFLGG EQU   UCMEFLG1                                                 11118000
UCMEFLGF EQU   UCMEFLG1                                                 11119000
UCMEFLGE EQU   UCMEFLG1                                                 11120000
UCMEFLGD EQU   UCMEFLG1                                                 11121000
UCMEFLGC EQU   UCMEFLG1                                                 11122000
UCMEFLGB EQU   UCMEFLG1                                                 11123000
UCMEFLGA EQU   UCMEFLG1                                                 11124000
UCMPEDUM EQU   UCMPEXTA+60                                              11125000
UCMPELST EQU   UCMPEXTA+56                                              11126000
UCMPELEN EQU   UCMPEXTA+52                                              11127000
UCMPE1ST EQU   UCMPEXTA+48                                              11128000
UCMPRSV2 EQU   UCMPEXTA+20                                              11129000
UCMPRSV1 EQU   UCMPDM1+12                                               11130000
UCMPNCC  EQU   UCMPDM1+8                                                11131000
UCMPNMCC EQU   UCMPDM1+4                                                11132000
UCMPWQE  EQU   UCMPDM1                                                  11133000
UCMPUCMP EQU   UCMPEXTA                                                 11134000
UCMFELST EQU   UCMFEXTA+48                                              11135000
UCMFELEN EQU   UCMFEXTA+44                                              11136000
UCMFE1ST EQU   UCMFEXTA+40                                              11137000
UCMFATCN EQU   UCMFEXTA+36                                              11138000
UCMFRAD  EQU   UCMFRECB+1                                               11139000
UCMFRB0  EQU   UCMFRBYT                                                 11140000
UCMFXECB EQU   UCMFECBL                                                 11141000
UCMFRSV3 EQU   UCMFEXTA+20                                              11142000
UCMF80WQ EQU   UCMFEXTA+18                                              11143000
UCMF60WQ EQU   UCMFEXTA+16                                              11144000
UCMFRSV2 EQU   UCMFMGFS+4                                               11145000
UCMFRSV1 EQU   UCMFMGFS+2                                               11146000
UCMFFLG2 EQU   UCMFMGFS+1                                               11147000
UCMFBR07 EQU   UCMFFLG1                                                 11148000
UCMFBR06 EQU   UCMFFLG1                                                 11149000
UCMFBR05 EQU   UCMFFLG1                                                 11150000
UCMFBR04 EQU   UCMFFLG1                                                 11151000
UCMFBR03 EQU   UCMFFLG1                                                 11152000
UCMFMSGN EQU   UCMFFLG1                                                 11153000
UCMFMSGA EQU   UCMFFLG1                                                 11154000
UCMFMSGE EQU   UCMFFLG1                                                 11155000
UCMFUCMF EQU   UCMFEXTA                                                 11156000
UCMDESCD EQU   UCMEXIT+132                                              11157000
UCMROUTC EQU   UCMEXIT+128                                              11158000
UCMMSTXT EQU   UCMEXIT                                                  11159000
UCMRSV64 EQU   UCMLIST+76                                               11160000
UCMRCTA  EQU   UCMRCT+1                                                 11161000
UCMRSV31 EQU   UCMSDS5                                                  11162000
UCMSDS5G EQU   UCMSDS5                                                  11163000
UCMSDS5F EQU   UCMSDS5                                                  11164000
UCMRSV30 EQU   UCMSDS5                                                  11165000
UCMRSV29 EQU   UCMSDS5                                                  11166000
UCMSDS5C EQU   UCMSDS5                                                  11167000
UCMSDS5B EQU   UCMSDS5                                                  11168000
UCMSDS5A EQU   UCMSDS5                                                  11169000
UCMMLAST EQU   UCMLIST+64                                               11170000
UCMVHRSN EQU   UCMDEVC                                                  11171000
UCMDEVG  EQU   UCMDEVC                                                  11172000
UCMDEVF  EQU   UCMDEVC                                                  11173000
UCMDEVE  EQU   UCMDEVC                                                  11174000
UCMDEVD  EQU   UCMDEVC                                                  11175000
UCMDEVCC EQU   UCMDEVC                                                  11176000
UCMDEVB  EQU   UCMDEVC                                                  11177000
UCMDEVA  EQU   UCMDEVC                                                  11178000
UCMXOR   EQU   UCMLIST+62                                               11179000
UCMMSG2  EQU   UCMMSG+1                                                 11180000
UCMRSV27 EQU   UCMMSG1                                                  11181000
UCMRSV26 EQU   UCMMSG1                                                  11182000
UCMMSGF  EQU   UCMMSG1                                                  11183000
UCMRSV71 EQU   UCMMSG1                                                  11184000
UCMMSGD  EQU   UCMMSG1                                                  11185000
UCMRSV70 EQU   UCMMSG1                                                  11186000
UCMMSGB  EQU   UCMMSG1                                                  11187000
UCMMSGA  EQU   UCMMSG1                                                  11188000
UCMCOMPC EQU   UCMLIST+56                                               11189000
UCMWLAST EQU   UCMLIST+52                                               11190000
UCMOAOEN EQU   UCMLIST+48                                               11191000
UCMALTEN EQU   UCMLIST+44                                               11192000
UCMRV007 EQU   UCMDISP2                                                 11193000
UCMRV006 EQU   UCMDISP2                                                 11194000
UCMRV005 EQU   UCMDISP2                                                 11195000
UCMRV004 EQU   UCMDISP2                                                 11196000
UCMRV003 EQU   UCMDISP2                                                 11197000
UCMDISPK EQU   UCMDISP2                                                 11198000
UCMDISPJ EQU   UCMDISP2                                                 11199000
UCMDISPI EQU   UCMDISP2                                                 11200000
UCMDISPH EQU   UCMDISP1                                                 11201000
UCMDISPG EQU   UCMDISP1                                                 11202000
UCMDISPF EQU   UCMDISP1                                                 11203000
UCMDISPE EQU   UCMDISP1                                                 11204000
UCMDISPD EQU   UCMDISP1                                                 11205000
UCMDISPC EQU   UCMDISP1                                                 11206000
UCMDISPB EQU   UCMDISP1                                                 11207000
UCMDISPA EQU   UCMDISP1                                                 11208000
UCMAUTHB EQU   UCMAUTH+1                                                11209000
UCMRSV23 EQU   UCMAUTHA                                                 11210000
UCMRSV22 EQU   UCMAUTHA                                                 11211000
UCMRSV21 EQU   UCMAUTHA                                                 11212000
UCMRSV20 EQU   UCMAUTHA                                                 11213000
UCMRSV19 EQU   UCMAUTHA                                                 11214000
UCMAUTH3 EQU   UCMAUTHA                                                 11215000
UCMAUTH2 EQU   UCMAUTHA                                                 11216000
UCMAUTH1 EQU   UCMAUTHA                                                 11217000
UCMOUTQ  EQU   UCMLIST+36                                               11218000
UCMRSV18 EQU   UCMLIST+34                                               11219000
UCMRTCD  EQU   UCMLIST+32                                               11220000
UCMXB    EQU   UCMLIST+28                                               11221000
@NM00101 EQU   UCMXA+1                                                  11222000
UCMRSV17 EQU   UCMATR                                                   11223000
UCMRSV16 EQU   UCMATR                                                   11224000
UCMAT04  EQU   UCMATR                                                   11225000
UCMLF    EQU   UCMATR                                                   11226000
UCMUF    EQU   UCMATR                                                   11227000
UCMXF    EQU   UCMATR                                                   11228000
UCMIF    EQU   UCMATR                                                   11229000
UCMOF    EQU   UCMATR                                                   11230000
UCMTC    EQU   UCMSTS                                                   11231000
UCMTD    EQU   UCMSTS                                                   11232000
UCMTB    EQU   UCMSTS                                                   11233000
UCMTA    EQU   UCMSTS                                                   11234000
UCMCF    EQU   UCMSTS                                                   11235000
UCMBF    EQU   UCMSTS                                                   11236000
UCMPF    EQU   UCMSTS                                                   11237000
UCMAF    EQU   UCMSTS                                                   11238000
UCMNAME  EQU   UCMLIST+16                                               11239000
UCMUCB   EQU   UCMLIST+12                                               11240000
UCMDCB   EQU   UCMLIST+8                                                11241000
UCMSBR   EQU   UCMLIST+4                                                11242000
UCMECB   EQU   UCMLIST                                                  11243000
UCMDECBA EQU   UCMEIL+20                                                11244000
UCMOECBA EQU   UCMEIL+16                                                11245000
UCMAECBA EQU   UCMEIL+12                                                11246000
UCMXECBA EQU   UCMEIL+8                                                 11247000
UCMNIPTR EQU   UCMEIL+4                                                 11248000
UCMRSV15 EQU   UCMEIL+3                                                 11249000
UCMRTCT  EQU   UCMEIL+2                                                 11250000
UCMRPYL  EQU   UCMEIL+1                                                 11251000
@NM00100 EQU   UCMEIL                                                   11252000
UCMRSV62 EQU   UCM+304                                                  11253000
UCMRSV60 EQU   UCM+302                                                  11254000
UCMRSV59 EQU   UCMRSV51                                                 11255000
UCMRSV58 EQU   UCMRSV51                                                 11256000
UCMRSV57 EQU   UCMRSV51                                                 11257000
UCMRSV56 EQU   UCMRSV51                                                 11258000
UCMRSV55 EQU   UCMRSV51                                                 11259000
UCMRSV54 EQU   UCMRSV51                                                 11260000
UCMRSV53 EQU   UCMRSV51                                                 11261000
UCMRSV52 EQU   UCMRSV51                                                 11262000
UCMRSV50 EQU   UCMRSV42                                                 11263000
UCMRSV49 EQU   UCMRSV42                                                 11264000
UCMRSV48 EQU   UCMRSV42                                                 11265000
UCMRSV47 EQU   UCMRSV42                                                 11266000
UCMRSV46 EQU   UCMRSV42                                                 11267000
UCMRSV45 EQU   UCMRSV42                                                 11268000
UCMRSV44 EQU   UCMRSV42                                                 11269000
UCMRSV43 EQU   UCMRSV42                                                 11270000
UCMJES3T EQU   UCM+296                                                  11271000
UCMWAKUP EQU   UCM+292                                                  11272000
UCMFRRAD EQU   UCM+288                                                  11273000
UCMSWCH  EQU   UCM+284                                                  11274000
UCMASCB  EQU   UCM+280                                                  11275000
UCMWQECP EQU   UCM+276                                                  11276000
UCMORECP EQU   UCM+272                                                  11277000
UCMOECBT EQU   UCM+268                                                  11278000
UCMOECBH EQU   UCM+264                                                  11279000
UCMWECBT EQU   UCM+260                                                  11280000
UCMWECBH EQU   UCM+256                                                  11281000
UCMMBEND EQU   UCM+252                                                  11282000
UCMCTID  EQU   UCM+250                                                  11283000
UCMRSV61 EQU   UCM+248                                                  11284000
UCMRP2AD EQU   UCM+244                                                  11285000
UCMBFEXT EQU   UCM+240                                                  11286000
UCMWQLM1 EQU   UCM+238                                                  11287000
UCMRV001 EQU   UCM+237                                                  11288000
UCMRQLM1 EQU   UCM+236                                                  11289000
UCMMBPTR EQU   UCM+232                                                  11290000
UCMMQNXT EQU   UCM+228                                                  11291000
UCMMQEND EQU   UCM+224                                                  11292000
UCMMQPTR EQU   UCM+220                                                  11293000
UCMTRECB EQU   UCM+216                                                  11294000
UCMMNECB EQU   UCM+212                                                  11295000
UCMMNTR  EQU   UCM+208                                                  11296000
UCMR9SV  EQU   UCM+204                                                  11297000
UCMSAVE4 EQU   UCM+140                                                  11298000
UCMRSV77 EQU   UCM+84                                                   11299000
UCMVEL   EQU   UCMVDATA+8                                               11300000
UCMVEZ   EQU   UCMVDATA+4                                               11301000
UCMVEA   EQU   UCMVDATA                                                 11302000
UCMRSV76 EQU   UCM+71                                                   11303000
UCMRSV67 EQU   UCM+70                                                   11304000
UCMRSV75 EQU   UCM+69                                                   11305000
UCMFIX   EQU   UCMMODE                                                  11306000
UCMMCS   EQU   UCMMODE                                                  11307000
UCMOGCE  EQU   UCMMODE                                                  11308000
UCMAMFA  EQU   UCMMODE                                                  11309000
UCMRSV14 EQU   UCMMODE                                                  11310000
UCMTPUTA EQU   UCMMODE                                                  11311000
UCMRSV66 EQU   UCMMODE                                                  11312000
UCMRSV11 EQU   UCMMODE                                                  11313000
UCMPXA   EQU   UCM+64                                                   11314000
UCMWQEND EQU   UCM+60                                                   11315000
UCMWQNR  EQU   UCM+58                                                   11316000
UCMRQNR  EQU   UCM+56                                                   11317000
UCMWQECB EQU   UCM+52                                                   11318000
UCMRQECB EQU   UCM+48                                                   11319000
UCMWQLM  EQU   UCM+46                                                   11320000
UCMRQLM  EQU   UCM+45                                                   11321000
@NM00099 EQU   UCMRPYI                                                  11322000
UCMRPYQ  EQU   UCM+28                                                   11323000
UCMWTOQ  EQU   UCM+24                                                   11324000
UCMLSTP  EQU   UCM+20                                                   11325000
UCMARECB EQU   UCM+16                                                   11326000
UCMLECB  EQU   UCMDECB                                                  11327000
UCMOECB  EQU   UCM+8                                                    11328000
UCMAECB  EQU   UCM+4                                                    11329000
UCMXECB  EQU   UCM                                                      11330000
UCMRSV65 EQU   UCMPRFX+158                                              11331000
UCMSDS2  EQU   UCMPRFX+157                                              11332000
UCMRSV09 EQU   UCMSDS1                                                  11333000
UCMRSV08 EQU   UCMSDS1                                                  11334000
UCMRSV07 EQU   UCMSDS1                                                  11335000
UCMRSV06 EQU   UCMSDS1                                                  11336000
UCMRSV05 EQU   UCMSDS1                                                  11337000
UCMRSV04 EQU   UCMSDS1                                                  11338000
UCMSDS1B EQU   UCMSDS1                                                  11339000
UCMSDS1A EQU   UCMSDS1                                                  11340000
UCMRSV72 EQU   UCMPRFX+152                                              11341000
UCMLOGAD EQU   UCMPRFX+148                                              11342000
UCMNPECB EQU   UCMPRFX+144                                              11343000
UCMRSV69 EQU   UCMPRFX+140                                              11344000
UCMSWSA2 EQU   UCMPRFX+136                                              11345000
UCMSWSA1 EQU   UCMPRFX+132                                              11346000
UCMQRTN  EQU   UCMPRFX+128                                              11347000
UCM6WD   EQU   UCMXSA+20                                                11348000
UCM5WD   EQU   UCMXSA+16                                                11349000
UCM4WD   EQU   UCMXSA+12                                                11350000
UCM3WD   EQU   UCMXSA+8                                                 11351000
UCM2WD   EQU   UCMXSA+4                                                 11352000
UCM1WD   EQU   UCMXSA                                                   11353000
UCMRSV03 EQU   UCMPRFX+102                                              11354000
UCMHRDRT EQU   UCMPRFX+100                                              11355000
UCMUEXIT EQU   UCMPRFX+97                                               11356000
UCMXCT   EQU   UCMPRFX+96                                               11357000
UCMHCUCM EQU   UCMPRFX+92                                               11358000
UCMCMID  EQU   UCMPRFX+88                                               11359000
UCMOWTOR EQU   UCMPRFX+86                                               11360000
UCMSYSP  EQU   UCMSFLG2                                                 11361000
UCMSYSO  EQU   UCMSFLG2                                                 11362000
UCMSYSN  EQU   UCMSFLG2                                                 11363000
UCMSYSM  EQU   UCMSFLG2                                                 11364000
UCMSYSL  EQU   UCMSFLG2                                                 11365000
UCMSYSK  EQU   UCMSFLG2                                                 11366000
UCMSYSJ  EQU   UCMSFLG2                                                 11367000
UCMSYSI  EQU   UCMSFLG2                                                 11368000
UCMRSV35 EQU   UCMSFLG1                                                 11369000
UCMSYSG  EQU   UCMSFLG1                                                 11370000
UCMSYSF  EQU   UCMSFLG1                                                 11371000
UCMSYSE  EQU   UCMSFLG1                                                 11372000
UCMSYSD  EQU   UCMSFLG1                                                 11373000
UCMSYSC  EQU   UCMSFLG1                                                 11374000
UCMSYSB  EQU   UCMSFLG1                                                 11375000
UCMRSV01 EQU   UCMSFLG1                                                 11376000
UCMWTOX  EQU   UCMPRFX+80                                               11377000
UCMDOME  EQU   UCMPRFX+76                                               11378000
UCMSVR0  EQU   UCMSAVE0+68                                              11379000
UCMSVQ0  EQU   UCMSAVE0+64                                              11380000
UCMSVP0  EQU   UCMSAVE0+60                                              11381000
UCMSVO0  EQU   UCMSAVE0+56                                              11382000
UCMSVN0  EQU   UCMSAVE0+52                                              11383000
UCMSVM0  EQU   UCMSAVE0+48                                              11384000
UCMSVL0  EQU   UCMSAVE0+44                                              11385000
UCMSVK0  EQU   UCMSAVE0+40                                              11386000
UCMSVJ0  EQU   UCMSAVE0+36                                              11387000
UCMSVI0  EQU   UCMSAVE0+32                                              11388000
UCMSVH0  EQU   UCMSAVE0+28                                              11389000
UCMSVG0  EQU   UCMSAVE0+24                                              11390000
UCMSVF0  EQU   UCMSAVE0+20                                              11391000
UCMSVE0  EQU   UCMSAVE0+16                                              11392000
UCMSVD0  EQU   UCMSAVE0+12                                              11393000
UCMSVC0  EQU   UCMSAVE0+8                                               11394000
UCMSVB0  EQU   UCMSAVE0+4                                               11395000
UCMSVA0  EQU   UCMSAVE0                                                 11396000
UCMRSV74 EQU   UCM2EXT+20                                               11397000
UCMRSV73 EQU   UCM2EXT+16                                               11398000
UCM2STAA EQU   UCM2STA+1                                                11399000
UCMRV008 EQU   UCM2SFLG                                                 11400000
UCMRSV34 EQU   UCM2SFLG                                                 11401000
UCMRSV33 EQU   UCM2SFLG                                                 11402000
UCM2WTOI EQU   UCM2SFLG                                                 11403000
UCM2DSTR EQU   UCM2SFLG                                                 11404000
UCM2DTAK EQU   UCM2SFLG                                                 11405000
UCM2SENT EQU   UCM2SFLG                                                 11406000
UCM2SDWA EQU   UCM2SFLG                                                 11407000
UCM2PST  EQU   UCM2EXT+4                                                11408000
UCM2RID  EQU   UCM2EXT+2                                                11409000
UCM2WID  EQU   UCM2EXT                                                  11410000
UCBERADR EQU   UCBUCS+12                                                11411000
UCBFCBID EQU   UCBUCS+8                                                 11412000
UCBERCNT EQU   UCBUCS+7                                                 11413000
UCBRSV51 EQU   UCBUCS+6                                                 11414000
UCBFCBPE EQU   UCBFCBOP                                                 11415000
UCBRSV49 EQU   UCBFCBOP                                                 11416000
UCBRSV48 EQU   UCBFCBOP                                                 11417000
UCBRSV47 EQU   UCBFCBOP                                                 11418000
UCBRSV46 EQU   UCBFCBOP                                                 11419000
UCBRSV45 EQU   UCBFCBOP                                                 11420000
UCBRSV44 EQU   UCBFCBOP                                                 11421000
UCBFCBO1 EQU   UCBFCBOP                                                 11422000
UCBUCSPE EQU   UCBUCSOP                                                 11423000
UCBRSV43 EQU   UCBUCSOP                                                 11424000
UCBRSV42 EQU   UCBUCSOP                                                 11425000
UCBRSV41 EQU   UCBUCSOP                                                 11426000
UCBRSV40 EQU   UCBUCSOP                                                 11427000
UCBRSV39 EQU   UCBUCSOP                                                 11428000
UCBUCSO2 EQU   UCBUCSOP                                                 11429000
UCBUCSO1 EQU   UCBUCSOP                                                 11430000
UCBUCSID EQU   UCBUCS                                                   11431000
UCBMDRBA EQU   UCBMDRBF+1                                               11432000
UCBRV075 EQU   UCBMDRBF                                                 11433000
UCBRV074 EQU   UCB3800X+32                                              11434000
UCBIMAGE EQU   UCB3800X+28                                              11435000
UCBFCBNM EQU   UCB3800X+24                                              11436000
UCBCHAR4 EQU   UCB3800X+20                                              11437000
UCBCHAR3 EQU   UCB3800X+16                                              11438000
UCBCHAR2 EQU   UCB3800X+12                                              11439000
UCBCHAR1 EQU   UCB3800X+8                                               11440000
UCBCGMID EQU   UCB3800X+4                                               11441000
UCBBRSTA EQU   UCBACTIV                                                 11442000
UCBRV063 EQU   UCBACTIV                                                 11443000
UCBRV062 EQU   UCBACTIV                                                 11444000
UCBRV061 EQU   UCBACTIV                                                 11445000
UCBRV060 EQU   UCBACTIV                                                 11446000
UCBRV059 EQU   UCBACTIV                                                 11447000
UCBRV058 EQU   UCBACTIV                                                 11448000
UCBRV057 EQU   UCBACTIV                                                 11449000
UCBRV050 EQU   UCB3800X+2                                               11450000
UCBCGMNO EQU   UCB3800X+1                                               11451000
UCBRV083 EQU   UCBOPTNS                                                 11452000
UCBBRSTR EQU   UCBOPTNS                                                 11453000
UCBRV056 EQU   UCBOPTNS                                                 11454000
UCBRV055 EQU   UCBOPTNS                                                 11455000
UCBRV054 EQU   UCBOPTNS                                                 11456000
UCBRV053 EQU   UCBOPTNS                                                 11457000
UCBRV052 EQU   UCBOPTNS                                                 11458000
UCBRV051 EQU   UCBOPTNS                                                 11459000
UCBRV073 EQU   UCB3540X+7                                               11460000
UCBRV072 EQU   UCBDKBYT                                                 11461000
UCBRV071 EQU   UCBDKBYT                                                 11462000
UCBRV070 EQU   UCBDKBYT                                                 11463000
UCBRV069 EQU   UCBDKBYT                                                 11464000
UCBRV068 EQU   UCBDKBYT                                                 11465000
UCBRV067 EQU   UCBDKBYT                                                 11466000
UCBVLVER EQU   UCBDKBYT                                                 11467000
UCBDKAMX EQU   UCBDKBYT                                                 11468000
UCBVLSER EQU   UCB3540X                                                 11469000
UCBRDATA EQU   UCBOCR+4                                                 11470000
UCBFRID  EQU   UCBOCR                                                   11471000
UCBCLN   EQU   UCBMT+14                                                 11472000
UCBERG   EQU   UCBMT+12                                                 11473000
UCBMS    EQU   UCBMT+11                                                 11474000
UCBNB    EQU   UCBMT+10                                                 11475000
UCBPW    EQU   UCBMT+9                                                  11476000
UCBPR    EQU   UCBMT+8                                                  11477000
UCBSIO   EQU   UCBMT+6                                                  11478000
UCBTW    EQU   UCBMT+5                                                  11479000
UCBTR    EQU   UCBMT+4                                                  11480000
UCBTWT   EQU   UCBMT+3                                                  11481000
UCBTRT   EQU   UCBMT+2                                                  11482000
UCBCTD   EQU   UCBMT                                                    11483000
UCBWTOID EQU   UCBCMEXT+17                                              11484000
UCBMIHTI EQU   UCBMIHBY                                                 11485000
UCBMIHT2 EQU   UCBMIHBY                                                 11486000
UCBMIHT1 EQU   UCBMIHBY                                                 11487000
UCBMIHPB EQU   UCBMIHBY                                                 11488000
UCBMIHSF EQU   UCBMIHBY                                                 11489000
UCBASID  EQU   UCBCMEXT+14                                              11490000
UCBMFCNT EQU   UCBCMEXT+12                                              11491000
UCBPMSK  EQU   UCBCMEXT+10                                              11492000
UCBRV041 EQU   UCBCMEXT+6                                               11493000
UCBRV036 EQU   UCBFLP1                                                  11494000
UCBRV035 EQU   UCBFLP1                                                  11495000
UCBSWAPF EQU   UCBFLP1                                                  11496000
UCBINHIO EQU   UCBFLP1                                                  11497000
UCBNSWAP EQU   UCBFLP1                                                  11498000
UCBSHRUP EQU   UCBFLP1                                                  11499000
UCBNSRCH EQU   UCBFLP1                                                  11500000
UCBSNSCT EQU   UCBCMEXT+4                                               11501000
UCBHPDV  EQU   @NM00098                                                 11502000
UCBHALI  EQU   @NM00098                                                 11503000
UCBRSV09 EQU   @NM00098                                                 11504000
UCBRSV08 EQU   @NM00098                                                 11505000
UCBRSV07 EQU   @NM00098                                                 11506000
UCBRSV06 EQU   @NM00098                                                 11507000
UCBRSV05 EQU   @NM00098                                                 11508000
UCBRSV04 EQU   @NM00098                                                 11509000
UCBDTI   EQU   UCBCMEXT+2                                               11510000
UCBSTI   EQU   UCBCMEXT+1                                               11511000
UCBETI   EQU   UCBCMEXT                                                 11512000
UCBEXTP  EQU   UCBEXTPT+1                                               11513000
UCBDDRSW EQU   UCBFLC                                                   11514000
UCBTICBT EQU   UCBFLC                                                   11515000
UCBIVRR  EQU   UCBFLC                                                   11516000
UCBIVRS  EQU   UCBFLC                                                   11517000
UCBITF   EQU   UCBFLC                                                   11518000
UCBUDE   EQU   UCBFLC                                                   11519000
UCBWAA   EQU   UCBFLC                                                   11520000
UCBATTP  EQU   UCBFLC                                                   11521000
UCBUNTYP EQU   UCBTBYT4                                                 11522000
UCBRSV11 EQU   UCBDVCLS                                                 11523000
UCBRSV10 EQU   UCBDVCLS                                                 11524000
UCB3CHAR EQU   UCBDVCLS                                                 11525000
UCB3UREC EQU   UCBDVCLS                                                 11526000
UCB3DISP EQU   UCBDVCLS                                                 11527000
UCBDVPWR EQU   UCB2OPT7                                                 11528000
UCBVLPWR EQU   UCB2OPT6                                                 11529000
UCB2OPT5 EQU   UCBTBYT2                                                 11530000
UCBRVDEV EQU   UCBRWTAU                                                 11531000
UCBRPS   EQU   UCBDUDN2                                                 11532000
UCBRR    EQU   UCBDUDN1                                                 11533000
UCB2OPT1 EQU   UCBTBYT2                                                 11534000
UCB2OPT0 EQU   UCBTBYT2                                                 11535000
UCB1FEA7 EQU   UCBTBYT1                                                 11536000
UCBD6250 EQU   UCB1FEA6                                                 11537000
UCBD1600 EQU   UCB1FEA5                                                 11538000
UCB1FEA4 EQU   UCBTBYT1                                                 11539000
UCB1FEA3 EQU   UCBTBYT1                                                 11540000
UCB1FEA2 EQU   UCBTBYT1                                                 11541000
UCB1FEA1 EQU   UCBTBYT1                                                 11542000
UCB1FEA0 EQU   UCBTBYT1                                                 11543000
UCBRV029 EQU   UCBWGT                                                   11544000
UCBREW   EQU   UCBWGT                                                   11545000
UCBPUB   EQU   UCBWGT                                                   11546000
UCBOUT   EQU   UCBWGT                                                   11547000
UCBIN    EQU   UCBWGT                                                   11548000
UCBLCI   EQU   UCBOB+10                                                 11549000
UCBCNT   EQU   UCBOB+9                                                  11550000
UCBRV017 EQU   UCBCHM1                                                  11551000
UCBRV016 EQU   UCBCHM1                                                  11552000
UCBRV015 EQU   UCBCHM1                                                  11553000
UCBRV014 EQU   UCBCHM1                                                  11554000
UCBSPB   EQU   UCBPTH1                                                  11555000
UCBPPB   EQU   UCBPTH1                                                  11556000
UCBSPA   EQU   UCBPTH0                                                  11557000
UCBPPA   EQU   UCBPTH0                                                  11558000
UCBSIGP  EQU   UCBFLB                                                   11559000
UCBCRHSN EQU   UCBFLB                                                   11560000
UCBRESVH EQU   UCBFLB                                                   11561000
UCBSPST  EQU   UCBFLB                                                   11562000
UCBASNS  EQU   UCBFLB                                                   11563000
UCBQISCE EQU   UCBFL1                                                   11564000
UCBSAP   EQU   UCBFL1                                                   11565000
UCBNOTRC EQU   UCBCUB                                                   11566000
UCBUSING EQU   UCBPST                                                   11567000
UCBNOTRD EQU   UCBNRY                                                   11568000
UCBBUSYD EQU   UCBBSY                                                   11569000
UCBUA    EQU   UCBCHAN+1                                                11570000
UCBDADI  EQU   UCBSTAT                                                  11571000
UCBPRES  EQU   UCBSTAT                                                  11572000
UCBUNLD  EQU   UCBSTAT                                                  11573000
UCBID    EQU   UCBOB+2                                                  11574000
UCBALTPH EQU   UCBFL5                                                   11575000
UCBALTCU EQU   UCBFL5                                                   11576000
UCBENVRD EQU   UCBFL5                                                   11577000
UCBVSDR  EQU   UCBFL5                                                   11578000
UCBSASK  EQU   UCBFL5                                                   11579000
UCBAMV   EQU   UCBAF                                                    11580000
UCBDCC   EQU   UCBFL5                                                   11581000
UCBMONT  EQU   UCBJBNR                                                  11582000
UCBRV011 EQU   UCBJBNR                                                  11583000
UCBMMSGP EQU   UCBJBNR                                                  11584000
UCBOLDSM EQU   UCBJBNR                                                  11585000
UCBRV003 EQU   UCBJBNR                                                  11586000
UCBDUC   EQU   UCBJBNR                                                  11587000
UCBJES3  EQU   UCBJBNR                                                  11588000
UCBVRDEV EQU   UCBJBNR                                                  11589000
UCBCMSEG EQU   UCBOB                                                    11590000
UCBPFXND EQU   UCB+512                                                  11591000
UCBIOQ   EQU   UCB+508                                                  11592000
UCBLOCK  EQU   UCB+504                                                  11593000
UCBPXST  EQU   UCB+504                                                  11594000
@NM00095 EQU   UCB                                                      11595000
@NM00094 EQU   SDWA+512                                                 11596000
@NM00093 EQU   SDWADPVA                                                 11597000
SDWAEBC  EQU   SDWADPVA                                                 11598000
SDWAVRAL EQU   SDWARA                                                   11599000
@NM00092 EQU   SDWA+396                                                 11600000
SDWACOMP EQU   SDWA+392                                                 11601000
SDWARCPL EQU   SDWA+364                                                 11602000
@NM00091 EQU   SDWADPSA+32                                              11603000
SDWATO4  EQU   SDWADPSL+28                                              11604000
SDWAFRM4 EQU   SDWADPSL+24                                              11605000
SDWATO3  EQU   SDWADPSL+20                                              11606000
SDWAFRM3 EQU   SDWADPSL+16                                              11607000
SDWATO2  EQU   SDWADPSL+12                                              11608000
SDWAFRM2 EQU   SDWADPSL+8                                               11609000
SDWATO1  EQU   SDWADPSL+4                                               11610000
SDWAFRM1 EQU   SDWADPSL                                                 11611000
@NM00090 EQU   SDWADDAT+3                                               11612000
@NM00089 EQU   SDWAPDAT                                                 11613000
SDWAUSPL EQU   SDWAPDAT                                                 11614000
SDWADPSW EQU   SDWAPDAT                                                 11615000
SDWATJPA EQU   SDWAPDAT                                                 11616000
SDWATLPA EQU   SDWAPDAT                                                 11617000
SDWADREG EQU   SDWAPDAT                                                 11618000
SDWADSAH EQU   SDWAPDAT                                                 11619000
SDWADSAS EQU   SDWAPDAT                                                 11620000
@NM00088 EQU   SDWADDAT+1                                               11621000
@NM00087 EQU   SDWASDAT                                                 11622000
SDWAQQS  EQU   SDWASDAT                                                 11623000
SDWACBS  EQU   SDWASDAT                                                 11624000
SDWAGTF  EQU   SDWASDAT                                                 11625000
SDWASWA  EQU   SDWASDAT                                                 11626000
SDWALSQA EQU   SDWASDAT                                                 11627000
SDWASQA  EQU   SDWASDAT                                                 11628000
SDWANUC  EQU   SDWASDAT                                                 11629000
@NM00086 EQU   SDWADUMP+2                                               11630000
@NM00085 EQU   SDWADPFS                                                 11631000
SDWASLST EQU   SDWADPFS                                                 11632000
@NM00084 EQU   SDWADPFS                                                 11633000
SDWADLST EQU   SDWADPFS                                                 11634000
SDWADPT  EQU   SDWADPFS                                                 11635000
SDWADPID EQU   SDWADUMP                                                 11636000
SDWADPLA EQU   SDWA+316                                                 11637000
SDWAREXN EQU   SDWARECP+16                                              11638000
@NM00083 EQU   SDWA+290                                                 11639000
SDWAASID EQU   SDWA+288                                                 11640000
SDWATALW EQU   SDWALKWS+28                                              11641000
SDWATDLW EQU   SDWALKWS+24                                              11642000
SDWATNLW EQU   SDWALKWS+20                                              11643000
SDWAAPLW EQU   SDWALKWS+16                                              11644000
SDWAIPLW EQU   SDWALKWS+12                                              11645000
SDWAILLW EQU   SDWALKWS+8                                               11646000
SDWAIULW EQU   SDWALKWS+4                                               11647000
SDWAICLW EQU   SDWALKWS                                                 11648000
SDWAFLLK EQU   SDWAACF4                                                 11649000
SDWACMS  EQU   SDWAACF4                                                 11650000
SDWAOPTM EQU   SDWAACF4                                                 11651000
SDWATADB EQU   SDWAACF4                                                 11652000
SDWATDNB EQU   SDWAACF4                                                 11653000
SDWATNCB EQU   SDWAACF4                                                 11654000
SDWAILCH EQU   SDWAACF4                                                 11655000
SDWAIUCB EQU   SDWAACF4                                                 11656000
SDWAICAT EQU   SDWAACF3                                                 11657000
SDWAIPRG EQU   SDWAACF3                                                 11658000
SDWASALL EQU   SDWAACF3                                                 11659000
SDWAASMP EQU   SDWAACF3                                                 11660000
SDWADISP EQU   SDWAACF3                                                 11661000
@NM00082 EQU   SDWAACF3                                                 11662000
@NM00081 EQU   SDWAACF2                                                 11663000
SDWAFREE EQU   SDWAACF2                                                 11664000
SDWAUPRG EQU   SDWAACF2                                                 11665000
@NM00080 EQU   SDWAACF2                                                 11666000
SDWASPIN EQU   SDWAACF2                                                 11667000
@NM00079 EQU   SDWAACF2                                                 11668000
SDWALCPU EQU   SDWACPUA+2                                               11669000
@NM00078 EQU   SDWACPUA                                                 11670000
SDWARECA EQU   SDWA+244                                                 11671000
SDWARTYA EQU   SDWA+240                                                 11672000
@NM00077 EQU   SDWA+239                                                 11673000
@NM00076 EQU   SDWAIOFS                                                 11674000
SDWANIOP EQU   SDWAIOFS                                                 11675000
SDWANOIO EQU   SDWAIOFS                                                 11676000
SDWAIOHT EQU   SDWAIOFS                                                 11677000
SDWAIOQR EQU   SDWAIOFS                                                 11678000
SDWAFMID EQU   SDWA+236                                                 11679000
@NM00075 EQU   SDWAERRD                                                 11680000
SDWAMCIV EQU   SDWAERRD                                                 11681000
SDWARPIV EQU   SDWAERRD                                                 11682000
SDWAMABD EQU   SDWAERRD                                                 11683000
SDWACTS  EQU   SDWAERRD                                                 11684000
SDWASTAE EQU   SDWAERRD                                                 11685000
SDWANRBE EQU   SDWAERRD                                                 11686000
SDWACLUP EQU   SDWAERRD                                                 11687000
@NM00074 EQU   SDWAERRC                                                 11688000
SDWAEAS  EQU   SDWAERRC                                                 11689000
SDWAPERC EQU   SDWAERRC                                                 11690000
SDWAIRB  EQU   SDWAERRC                                                 11691000
SDWASTAI EQU   SDWAERRC                                                 11692000
SDWASTAF EQU   SDWAERRC                                                 11693000
SDWASRBM EQU   SDWAERRB                                                 11694000
SDWALDIS EQU   SDWAERRB                                                 11695000
SDWAENRB EQU   SDWAERRB                                                 11696000
SDWATYP1 EQU   SDWAERRB                                                 11697000
@NM00073 EQU   SDWAERRB                                                 11698000
SDWAPGIO EQU   SDWAERRA                                                 11699000
SDWATEXC EQU   SDWAERRA                                                 11700000
SDWASVCE EQU   SDWAERRA                                                 11701000
SDWAABTM EQU   SDWAERRA                                                 11702000
SDWASVCD EQU   SDWAERRA                                                 11703000
SDWARKEY EQU   SDWAERRA                                                 11704000
SDWAPCHK EQU   SDWAERRA                                                 11705000
SDWAMCHK EQU   SDWAERRA                                                 11706000
SDWATIME EQU   SDWAMCH+20                                               11707000
SDWARFSA EQU   SDWAMCH+16                                               11708000
@NM00072 EQU   SDWAMCH+14                                               11709000
SDWAVEQR EQU   SDWARSR2                                                 11710000
SDWAPGFX EQU   SDWARSR2                                                 11711000
SDWAFLSQ EQU   SDWARSR2                                                 11712000
SDWAFSQA EQU   SDWARSR2                                                 11713000
SDWANUCL EQU   SDWARSR2                                                 11714000
SDWASPER EQU   SDWARSR2                                                 11715000
SDWAINTC EQU   SDWARSR2                                                 11716000
SDWAOFLN EQU   SDWARSR2                                                 11717000
SDWACHNG EQU   SDWARSR1                                                 11718000
SDWAMSER EQU   SDWARSR1                                                 11719000
@NM00071 EQU   SDWARSR1                                                 11720000
SDWACPID EQU   SDWAMCH+10                                               11721000
SDWATERR EQU   SDWAMCHD                                                 11722000
SDWAFPRX EQU   SDWAMCHD                                                 11723000
SDWAINSF EQU   SDWAMCHD                                                 11724000
SDWAACR  EQU   SDWAMCHD                                                 11725000
SDWASCK  EQU   SDWAMCHD                                                 11726000
SDWAPSWU EQU   SDWAMCHD                                                 11727000
SDWAREGU EQU   SDWAMCHD                                                 11728000
SDWASKYF EQU   SDWAMCHD                                                 11729000
@NM00070 EQU   SDWAMCHS                                                 11730000
SDWARSRF EQU   SDWAMCHS                                                 11731000
SDWARSRC EQU   SDWAMCHS                                                 11732000
SDWAINVP EQU   SDWAMCHS                                                 11733000
SDWATSVL EQU   SDWAMCHS                                                 11734000
SDWARCDF EQU   SDWAMCHS                                                 11735000
SDWASRVL EQU   SDWAMCHS                                                 11736000
SDWASCKE EQU   SDWASTCK+4                                               11737000
SDWASCKB EQU   SDWASTCK                                                 11738000
SDWALNTH EQU   SDWAIDNT+1                                               11739000
SDWASPID EQU   SDWAIDNT                                                 11740000
SDWASR15 EQU   SDWASRSV+60                                              11741000
SDWASR14 EQU   SDWASRSV+56                                              11742000
SDWASR13 EQU   SDWASRSV+52                                              11743000
SDWASR12 EQU   SDWASRSV+48                                              11744000
SDWASR11 EQU   SDWASRSV+44                                              11745000
SDWASR10 EQU   SDWASRSV+40                                              11746000
SDWASR09 EQU   SDWASRSV+36                                              11747000
SDWASR08 EQU   SDWASRSV+32                                              11748000
SDWASR07 EQU   SDWASRSV+28                                              11749000
SDWASR06 EQU   SDWASRSV+24                                              11750000
SDWASR05 EQU   SDWASRSV+20                                              11751000
SDWASR04 EQU   SDWASRSV+16                                              11752000
SDWASR03 EQU   SDWASRSV+12                                              11753000
SDWASR02 EQU   SDWASRSV+8                                               11754000
SDWASR01 EQU   SDWASRSV+4                                               11755000
SDWASR00 EQU   SDWASRSV                                                 11756000
SDWATRN2 EQU   SDWAAEC2+4                                               11757000
SDWAIPC2 EQU   SDWAICD2                                                 11758000
SDWAIMC2 EQU   SDWAICD2                                                 11759000
SDWAIPR2 EQU   SDWAICD2                                                 11760000
@NM00069 EQU   SDWAINC2                                                 11761000
@NM00068 EQU   SDWAILC2                                                 11762000
SDWAIL2  EQU   SDWAILC2                                                 11763000
@NM00067 EQU   SDWAILC2                                                 11764000
@NM00066 EQU   SDWAAEC2                                                 11765000
SDWAADD2 EQU   SDWANXT2+1                                               11766000
@NM00065 EQU   SDWANXT2                                                 11767000
@NM00064 EQU   SDWAEC2+3                                                11768000
SDWASGN2 EQU   SDWAINT2                                                 11769000
SDWAEXP2 EQU   SDWAINT2                                                 11770000
SDWADEC2 EQU   SDWAINT2                                                 11771000
SDWAFPO2 EQU   SDWAINT2                                                 11772000
SDWACC2  EQU   SDWAINT2                                                 11773000
@NM00063 EQU   SDWAINT2                                                 11774000
SDWAPGM2 EQU   SDWAMWP2                                                 11775000
SDWAWAT2 EQU   SDWAMWP2                                                 11776000
SDWAMCK2 EQU   SDWAMWP2                                                 11777000
SDWAECT2 EQU   SDWAMWP2                                                 11778000
SDWAKEY2 EQU   SDWAMWP2                                                 11779000
SDWAEXT2 EQU   SDWAEMK2                                                 11780000
SDWAIO2  EQU   SDWAEMK2                                                 11781000
SDWATRM2 EQU   SDWAEMK2                                                 11782000
@NM00062 EQU   SDWAEMK2                                                 11783000
SDWAPER2 EQU   SDWAEMK2                                                 11784000
@NM00061 EQU   SDWAEMK2                                                 11785000
SDWATRAN EQU   SDWAAEC1+4                                               11786000
SDWAIPC1 EQU   SDWAICD1                                                 11787000
SDWAIMC1 EQU   SDWAICD1                                                 11788000
SDWAIPR1 EQU   SDWAICD1                                                 11789000
@NM00060 EQU   SDWAINC1                                                 11790000
@NM00059 EQU   SDWAILC1                                                 11791000
SDWAIL1  EQU   SDWAILC1                                                 11792000
@NM00058 EQU   SDWAILC1                                                 11793000
@NM00057 EQU   SDWAAEC1                                                 11794000
SDWAADD1 EQU   SDWANXT1+1                                               11795000
@NM00056 EQU   SDWANXT1                                                 11796000
@NM00055 EQU   SDWAEC1+3                                                11797000
SDWASGN1 EQU   SDWAINT1                                                 11798000
SDWAEXP1 EQU   SDWAINT1                                                 11799000
SDWADEC1 EQU   SDWAINT1                                                 11800000
SDWAFPO1 EQU   SDWAINT1                                                 11801000
SDWACC1  EQU   SDWAINT1                                                 11802000
@NM00054 EQU   SDWAINT1                                                 11803000
SDWAPGM1 EQU   SDWAMWP1                                                 11804000
SDWAWAT1 EQU   SDWAMWP1                                                 11805000
SDWAMCK1 EQU   SDWAMWP1                                                 11806000
SDWAECT1 EQU   SDWAMWP1                                                 11807000
SDWAKEY1 EQU   SDWAMWP1                                                 11808000
SDWAEXT1 EQU   SDWAEMK1                                                 11809000
SDWAIO1  EQU   SDWAEMK1                                                 11810000
SDWATRM1 EQU   SDWAEMK1                                                 11811000
@NM00053 EQU   SDWAEMK1                                                 11812000
SDWAPER1 EQU   SDWAEMK1                                                 11813000
@NM00052 EQU   SDWAEMK1                                                 11814000
SDWAIOBR EQU   SDWA+100                                                 11815000
SDWAEPA  EQU   SDWA+96                                                  11816000
@NM00051 EQU   SDWANAME+4                                               11817000
SDWARBAD EQU   SDWANAME                                                 11818000
SDWAGR15 EQU   SDWAGRSV+60                                              11819000
SDWAGR14 EQU   SDWAGRSV+56                                              11820000
SDWAGR13 EQU   SDWAGRSV+52                                              11821000
SDWAGR12 EQU   SDWAGRSV+48                                              11822000
SDWAGR11 EQU   SDWAGRSV+44                                              11823000
SDWAGR10 EQU   SDWAGRSV+40                                              11824000
SDWAGR09 EQU   SDWAGRSV+36                                              11825000
SDWAGR08 EQU   SDWAGRSV+32                                              11826000
SDWAGR07 EQU   SDWAGRSV+28                                              11827000
SDWAGR06 EQU   SDWAGRSV+24                                              11828000
SDWAGR05 EQU   SDWAGRSV+20                                              11829000
SDWAGR04 EQU   SDWAGRSV+16                                              11830000
SDWAGR03 EQU   SDWAGRSV+12                                              11831000
SDWAGR02 EQU   SDWAGRSV+8                                               11832000
SDWAGR01 EQU   SDWAGRSV+4                                               11833000
SDWAGR00 EQU   SDWAGRSV                                                 11834000
SDWANXTP EQU   SDWACTL2+5                                               11835000
SDWASGP  EQU   SDWAPMKP                                                 11836000
SDWAEUP  EQU   SDWAPMKP                                                 11837000
SDWADOP  EQU   SDWAPMKP                                                 11838000
SDWAFPP  EQU   SDWAPMKP                                                 11839000
SDWACCP  EQU   SDWAPMKP                                                 11840000
SDWAILP  EQU   SDWAPMKP                                                 11841000
SDWAINTP EQU   SDWACTL2+2                                               11842000
SDWASPVP EQU   SDWAMWPP                                                 11843000
SDWAWATP EQU   SDWAMWPP                                                 11844000
SDWAMCKP EQU   SDWAMWPP                                                 11845000
@NM00050 EQU   SDWAMWPP                                                 11846000
SDWAKEYP EQU   SDWAMWPP                                                 11847000
SDWAEXTP EQU   SDWACMKP                                                 11848000
SDWAIOP  EQU   SDWACMKP                                                 11849000
SDWANXTA EQU   SDWACTL1+5                                               11850000
SDWASGA  EQU   SDWAPMKA                                                 11851000
SDWAEUA  EQU   SDWAPMKA                                                 11852000
SDWADOA  EQU   SDWAPMKA                                                 11853000
SDWAFPA  EQU   SDWAPMKA                                                 11854000
SDWACCA  EQU   SDWAPMKA                                                 11855000
SDWAILA  EQU   SDWAPMKA                                                 11856000
SDWAINTA EQU   SDWACTL1+2                                               11857000
SDWASPVA EQU   SDWAMWPA                                                 11858000
SDWAWATA EQU   SDWAMWPA                                                 11859000
SDWAMCKA EQU   SDWAMWPA                                                 11860000
@NM00049 EQU   SDWAMWPA                                                 11861000
SDWAKEYA EQU   SDWAMWPA                                                 11862000
SDWAEXTA EQU   SDWACMKA                                                 11863000
SDWAIOA  EQU   SDWACMKA                                                 11864000
SDWACMPC EQU   SDWAABCC+1                                               11865000
@NM00048 EQU   SDWACMPF                                                 11866000
SDWASTCC EQU   SDWACMPF                                                 11867000
@NM00047 EQU   SDWACMPF                                                 11868000
SDWASTEP EQU   SDWACMPF                                                 11869000
SDWAPARM EQU   SDWA                                                     11870000
@NM00046 EQU   FRRSFLGS+1                                               11871000
@NM00045 EQU   FRRSFLG1                                                 11872000
FRRSNEST EQU   FRRSFLG1                                                 11873000
FRRSRCUR EQU   FRRSFLG1                                                 11874000
FRRSENTS EQU   FRRS+84                                                  11875000
@NM00044 EQU   PSA+3668                                                 11876000
@NM00043 EQU   PSA+1048                                                 11877000
PSAUSEND EQU   PSA+1048                                                 11878000
PSARV062 EQU   PSA+1044                                                 11879000
PSAWTCOD EQU   PSA+1036                                                 11880000
PSAATCVT EQU   PSA+1032                                                 11881000
PSAPCPSW EQU   PSA+1024                                                 11882000
PSAPIR2  EQU   PSA+1020                                                 11883000
PSARV059 EQU   PSA+1018                                                 11884000
PSASVC13 EQU   PSA+1016                                                 11885000
PSASFACC EQU   PSA+1008                                                 11886000
PSASTOP  EQU   PSA+992                                                  11887000
PSASTART EQU   PSA+976                                                  11888000
PSARSPSW EQU   PSA+968                                                  11889000
PSASRPSW EQU   PSA+960                                                  11890000
PSARV045 EQU   PSA+892                                                  11891000
PSARV044 EQU   PSA+888                                                  11892000
PSARV043 EQU   PSA+884                                                  11893000
PSARV042 EQU   PSA+880                                                  11894000
PSARV041 EQU   PSA+876                                                  11895000
PSARV040 EQU   PSA+872                                                  11896000
PSARV025 EQU   PSA+868                                                  11897000
PSADSSED EQU   PSA+868                                                  11898000
PSADSSPR EQU   PSA+864                                                  11899000
PSADSSFW EQU   PSA+860                                                  11900000
PSADSS14 EQU   PSA+856                                                  11901000
PSADSSPP EQU   PSA+848                                                  11902000
PSADSSRP EQU   PSA+840                                                  11903000
PSADSS05 EQU   PSADSSF4                                                 11904000
PSADSS10 EQU   PSADSSF4                                                 11905000
PSADSSVE EQU   PSADSSF4                                                 11906000
PSADSSDE EQU   PSADSSF4                                                 11907000
PSADSSC0 EQU   PSADSSF4                                                 11908000
PSADSSIE EQU   PSADSSF4                                                 11909000
PSADSS12 EQU   PSADSSF4                                                 11910000
PSADSSRC EQU   PSADSSF4                                                 11911000
PSARV057 EQU   PSADSSF3                                                 11912000
PSARV056 EQU   PSADSSF3                                                 11913000
PSARV055 EQU   PSADSSF3                                                 11914000
PSADSSMC EQU   PSADSSF3                                                 11915000
PSADSSRW EQU   PSADSSF3                                                 11916000
PSADSSNM EQU   PSADSSF3                                                 11917000
PSADSSES EQU   PSADSSF3                                                 11918000
PSADSSGP EQU   PSADSSF3                                                 11919000
PSADSSF2 EQU   PSADSSFL+1                                               11920000
PSADSSPI EQU   PSADSSF1                                                 11921000
PSADSSOI EQU   PSADSSF1                                                 11922000
PSADSSSP EQU   PSADSSF1                                                 11923000
PSADSSTP EQU   PSADSSF1                                                 11924000
PSADSSDW EQU   PSADSSF1                                                 11925000
PSADSSDD EQU   PSADSSF1                                                 11926000
PSADSSDM EQU   PSADSSF1                                                 11927000
PSADSSMV EQU   PSADSSF1                                                 11928000
PSADSSTS EQU   PSA+816                                                  11929000
PSADSSWK EQU   PSA+812                                                  11930000
PSADSSR3 EQU   PSA+808                                                  11931000
PSADSSR2 EQU   PSA+804                                                  11932000
PSADSSRS EQU   PSA+800                                                  11933000
PSAVSTAP EQU   PSA+792                                                  11934000
PSAMCHIC EQU   PSA+783                                                  11935000
PSAACTCD EQU   PSA+782                                                  11936000
PSASYMSK EQU   PSA+781                                                  11937000
PSAMCHFL EQU   PSA+780                                                  11938000
PSACR0   EQU   PSA+776                                                  11939000
PSAPSWSV EQU   PSA+768                                                  11940000
PSACLHS  EQU   PSAHLHI                                                  11941000
PSALKR15 EQU   PSALKSA+60                                               11942000
PSALKR14 EQU   PSALKSA+56                                               11943000
PSALKR13 EQU   PSALKSA+52                                               11944000
PSALKR12 EQU   PSALKSA+48                                               11945000
PSALKR11 EQU   PSALKSA+44                                               11946000
PSALKR10 EQU   PSALKSA+40                                               11947000
PSALKR9  EQU   PSALKSA+36                                               11948000
PSALKR8  EQU   PSALKSA+32                                               11949000
PSALKR7  EQU   PSALKSA+28                                               11950000
PSALKR6  EQU   PSALKSA+24                                               11951000
PSALKR5  EQU   PSALKSA+20                                               11952000
PSALKR4  EQU   PSALKSA+16                                               11953000
PSALKR3  EQU   PSALKSA+12                                               11954000
PSALKR2  EQU   PSALKSA+8                                                11955000
PSALKR1  EQU   PSALKSA+4                                                11956000
PSALKR0  EQU   PSALKSA                                                  11957000
PSARV023 EQU   PSACLHT+52                                               11958000
PSALOCAL EQU   PSACLHT+48                                               11959000
PSACMSL  EQU   PSACLHT+44                                               11960000
PSAOPTL  EQU   PSACLHT+40                                               11961000
PSATPACL EQU   PSACLHT+36                                               11962000
PSATPDNL EQU   PSACLHT+32                                               11963000
PSATPNCL EQU   PSACLHT+28                                               11964000
PSAIOSLL EQU   PSACLHT+24                                               11965000
PSAIOSUL EQU   PSACLHT+20                                               11966000
PSAIOSCL EQU   PSACLHT+16                                               11967000
PSAIOSSL EQU   PSACLHT+12                                               11968000
PSASALCL EQU   PSACLHT+8                                                11969000
PSAASML  EQU   PSACLHT+4                                                11970000
PSADISPL EQU   PSACLHT                                                  11971000
PSASRSA  EQU   PSA+636                                                  11972000
PSARV050 EQU   PSA+634                                                  11973000
PSADSSGO EQU   PSA+633                                                  11974000
PSARECUR EQU   PSA+632                                                  11975000
PSAHLHIS EQU   PSA+628                                                  11976000
PSAIPCSA EQU   PSA+624                                                  11977000
@NM00042 EQU   PSA+621                                                  11978000
PSAIPCDM EQU   PSA+620                                                  11979000
PSAIPCD  EQU   PSA+616                                                  11980000
@NM00041 EQU   PSA+613                                                  11981000
PSAIPCRM EQU   PSA+612                                                  11982000
PSAIPCR  EQU   PSA+608                                                  11983000
PSAMCHEX EQU   PSA+600                                                  11984000
PSAMPSW  EQU   PSA+592                                                  11985000
PSAEXPS2 EQU   PSA+584                                                  11986000
PSAEXPS1 EQU   PSA+576                                                  11987000
PSAPIREG EQU   PSA+572                                                  11988000
PSARSREG EQU   PSA+568                                                  11989000
PSAGPREG EQU   PSA+556                                                  11990000
PSARV022 EQU   PSASUP4                                                  11991000
PSARV021 EQU   PSASUP4                                                  11992000
PSARV020 EQU   PSASUP4                                                  11993000
PSARV019 EQU   PSASUP4                                                  11994000
PSARV018 EQU   PSASUP4                                                  11995000
PSARV017 EQU   PSASUP4                                                  11996000
PSARV016 EQU   PSASUP4                                                  11997000
PSARV015 EQU   PSASUP4                                                  11998000
PSARV014 EQU   PSASUP3                                                  11999000
PSAULCMS EQU   PSASUP3                                                  12000000
PSARV012 EQU   PSASUP3                                                  12001000
PSAESTA  EQU   PSASUP3                                                  12002000
PSASPR   EQU   PSASUP3                                                  12003000
PSAPSREG EQU   PSASUP3                                                  12004000
PSAPI2   EQU   PSASUP3                                                  12005000
PSAIOSUP EQU   PSASUP3                                                  12006000
PSALCR   EQU   PSASUP2                                                  12007000
PSARTM   EQU   PSASUP2                                                  12008000
PSAACR   EQU   PSASUP2                                                  12009000
PSAIPCE2 EQU   PSASUP2                                                  12010000
PSAIPCES EQU   PSASUP2                                                  12011000
PSAIPCEC EQU   PSASUP2                                                  12012000
PSAGTF   EQU   PSASUP2                                                  12013000
PSAIPCRI EQU   PSASUP2                                                  12014000
PSATYPE6 EQU   PSASUP1                                                  12015000
PSATCTL  EQU   PSASUP1                                                  12016000
PSADISP  EQU   PSASUP1                                                  12017000
PSALOCK  EQU   PSASUP1                                                  12018000
PSAPI    EQU   PSASUP1                                                  12019000
PSAEXT   EQU   PSASUP1                                                  12020000
PSASVC   EQU   PSASUP1                                                  12021000
PSAIO    EQU   PSASUP1                                                  12022000
FLCHDEND EQU   PSA+512                                                  12023000
FLCCRSAV EQU   FLCMCLA+280                                              12024000
FLCGRSAV EQU   FLCMCLA+216                                              12025000
FLCFPSAV EQU   FLCMCLA+184                                              12026000
FLCFLA   EQU   FLCMCLA+88                                               12027000
FLCRGNCD EQU   FLCMCLA+84                                               12028000
FLCFSAA  EQU   FLCFSA+1                                                 12029000
@NM00040 EQU   FLCFSA                                                   12030000
@NM00039 EQU   FLCMCLA+77                                               12031000
PSAMDISC EQU   PSAMEDC                                                  12032000
PSAMINTR EQU   PSAMEDC                                                  12033000
PSAMINST EQU   PSAMEDC                                                  12034000
PSAMCCF  EQU   PSAMEDC                                                  12035000
PSAMCNOP EQU   PSAMEDC                                                  12036000
PSAMEXSR EQU   PSAMEDC                                                  12037000
PSAMCOPR EQU   PSAMEDC                                                  12038000
@NM00038 EQU   PSAMEDC                                                  12039000
@NM00037 EQU   FLCMCLA+72                                               12040000
FLCMCIC  EQU   FLCMCLA+64                                               12041000
@NM00036 EQU   FLCMCLA+20                                               12042000
FLCIOAA  EQU   FLCIOA+1                                                 12043000
@NM00035 EQU   FLCIOA                                                   12044000
@NM00034 EQU   FLCMCLA+15                                               12045000
@NM00033 EQU   FLCMCLA+14                                               12046000
@NM00032 EQU   FLCMCLA+12                                               12047000
FLCLCL   EQU   FLCMCLA+8                                                12048000
FLCIOELA EQU   FLCIOEL+1                                                12049000
@NM00031 EQU   FLCIOEL                                                  12050000
FLCCHIL  EQU   FLCCHNID+2                                               12051000
FLCCHMOD EQU   FLCCHTM                                                  12052000
FLCCHTYP EQU   FLCCHTM                                                  12053000
@NM00030 EQU   PSA+160                                                  12054000
FLCMTRCD EQU   PSA+157                                                  12055000
@NM00029 EQU   PSA+156                                                  12056000
FLCPERA  EQU   FLCPER+1                                                 12057000
@NM00028 EQU   FLCPER                                                   12058000
@NM00027 EQU   PSA+151                                                  12059000
FLCPERCD EQU   PSA+150                                                  12060000
FLCMCNUM EQU   PSA+149                                                  12061000
@NM00026 EQU   PSA+148                                                  12062000
FLCTEAA  EQU   FLCTEA+1                                                 12063000
@NM00025 EQU   FLCTEA                                                   12064000
PSAPIPC  EQU   PSAPICOD                                                 12065000
PSAPIMC  EQU   PSAPICOD                                                 12066000
PSAPIPER EQU   PSAPICOD                                                 12067000
PSARV049 EQU   FLCPICOD                                                 12068000
FLCPILCB EQU   FLCPIILC                                                 12069000
@NM00024 EQU   FLCPIILC                                                 12070000
@NM00023 EQU   PSAEPPSW                                                 12071000
FLCSVCN  EQU   PSAESPSW+2                                               12072000
FLCSILCB EQU   FLCSVILC                                                 12073000
@NM00022 EQU   FLCSVILC                                                 12074000
@NM00021 EQU   PSAESPSW                                                 12075000
FLCEICOD EQU   PSAEEPSW+2                                               12076000
PSASPAD  EQU   PSAEEPSW                                                 12077000
@NM00020 EQU   PSA+128                                                  12078000
FLCINPSW EQU   PSA+120                                                  12079000
FLCMNPSW EQU   PSA+112                                                  12080000
FLCPNPSW EQU   PSA+104                                                  12081000
FLCSNPSW EQU   PSA+96                                                   12082000
FLCENPSW EQU   PSA+88                                                   12083000
FLCTIMER EQU   PSA+80                                                   12084000
FLCCVT2  EQU   PSA+76                                                   12085000
FLCCAW   EQU   PSA+72                                                   12086000
FLCCSW   EQU   PSA+64                                                   12087000
FLCIOPSW EQU   PSA+56                                                   12088000
FLCMOPSW EQU   PSA+48                                                   12089000
FLCPOPSW EQU   PSA+40                                                   12090000
FLCSOPSW EQU   PSA+32                                                   12091000
FLCEOPSW EQU   PSA+24                                                   12092000
@NM00019 EQU   FLCICCW2+4                                               12093000
FLCICCW1 EQU   FLCROPSW                                                 12094000
FLCIPPSW EQU   FLCRNPSW                                                 12095000
ASVTEND  EQU   ASVT+528                                                 12096000
ASVTAVAI EQU   ASVTFRST                                                 12097000
ASVTRS00 EQU   ASVT+520                                                 12098000
ASVTASVT EQU   ASVT+512                                                 12099000
ASVTBEGN EQU   ASVT+512                                                 12100000
@NM00018 EQU   ASVT                                                     12101000
ASCBEND  EQU   ASCB+208                                                 12102000
ASCBSRBT EQU   ASCB+200                                                 12103000
ASCBSWTL EQU   ASCB+196                                                 12104000
ASCBRS14 EQU   ASCB+195                                                 12105000
ASCBSMCT EQU   ASCB+194                                                 12106000
ASCBRS12 EQU   ASCB+192                                                 12107000
ASCBPCTT EQU   ASCB+188                                                 12108000
ASCBVGTT EQU   ASCB+184                                                 12109000
ASCBRV43 EQU   ASCBSRQ4                                                 12110000
ASCBRV42 EQU   ASCBSRQ4                                                 12111000
ASCBRV41 EQU   ASCBSRQ4                                                 12112000
ASCBRV40 EQU   ASCBSRQ4                                                 12113000
ASCBRV39 EQU   ASCBSRQ4                                                 12114000
ASCBRV38 EQU   ASCBSRQ4                                                 12115000
ASCBRV37 EQU   ASCBSRQ4                                                 12116000
ASCBRV36 EQU   ASCBSRQ4                                                 12117000
ASCBRV35 EQU   ASCBSRQ3                                                 12118000
ASCBRV34 EQU   ASCBSRQ3                                                 12119000
ASCBRV33 EQU   ASCBSRQ3                                                 12120000
ASCBRV32 EQU   ASCBSRQ3                                                 12121000
ASCBRV31 EQU   ASCBSRQ3                                                 12122000
ASCBRV30 EQU   ASCBSRQ3                                                 12123000
ASCBRV29 EQU   ASCBSRQ3                                                 12124000
ASCBRV28 EQU   ASCBSRQ3                                                 12125000
ASCBRV27 EQU   ASCBSRQ2                                                 12126000
ASCBRV26 EQU   ASCBSRQ2                                                 12127000
ASCBRV25 EQU   ASCBSRQ2                                                 12128000
ASCBRV24 EQU   ASCBSRQ2                                                 12129000
ASCBRV23 EQU   ASCBSRQ2                                                 12130000
ASCBRV22 EQU   ASCBSRQ2                                                 12131000
ASCBRV21 EQU   ASCBSRQ2                                                 12132000
ASCBRV20 EQU   ASCBSRQ2                                                 12133000
ASCBRV19 EQU   ASCBSRQ1                                                 12134000
ASCBRV18 EQU   ASCBSRQ1                                                 12135000
ASCBRV17 EQU   ASCBSRQ1                                                 12136000
ASCBRV16 EQU   ASCBSRQ1                                                 12137000
ASCBRV15 EQU   ASCBSRQ1                                                 12138000
ASCBRV14 EQU   ASCBSRQ1                                                 12139000
ASCBRV13 EQU   ASCBSRQ1                                                 12140000
ASCBSTA  EQU   ASCBSRQ1                                                 12141000
ASCBJBNS EQU   ASCB+176                                                 12142000
ASCBJBNI EQU   ASCB+172                                                 12143000
ASCBMCC  EQU   ASCB+168                                                 12144000
ASCBRTWA EQU   ASCB+164                                                 12145000
ASCBIQEA EQU   ASCB+160                                                 12146000
ASCBXMPQ EQU   ASCB+156                                                 12147000
ASCBRS01 EQU   ASCB+154                                                 12148000
ASCBFMCT EQU   ASCB+152                                                 12149000
ASCBOUXB EQU   ASCB+148                                                 12150000
ASCBOUCB EQU   ASCB+144                                                 12151000
ASCBMECB EQU   ASCB+140                                                 12152000
ASCBQECB EQU   ASCB+136                                                 12153000
ASCBLSQH EQU   ASCBLKGP+4                                               12154000
ASCBLOCK EQU   ASCBLKGP                                                 12155000
ASCBTCBS EQU   ASCB+124                                                 12156000
ASCBNVSC EQU   ASCB+122                                                 12157000
ASCBVSC  EQU   ASCB+120                                                 12158000
ASCBSRBS EQU   ASCB+118                                                 12159000
ASCBSSRB EQU   ASCB+116                                                 12160000
ASCBRV06 EQU   ASCBFLG2                                                 12161000
ASCBRV05 EQU   ASCBFLG2                                                 12162000
ASCBRV04 EQU   ASCBFLG2                                                 12163000
ASCBSNQS EQU   ASCBFLG2                                                 12164000
ASCBS2S  EQU   ASCBFLG2                                                 12165000
ASCBCEXT EQU   ASCBFLG2                                                 12166000
ASCBPXMT EQU   ASCBFLG2                                                 12167000
ASCBXMPT EQU   ASCBFLG2                                                 12168000
ASCBRF07 EQU   ASCBDSP1                                                 12169000
ASCBRF06 EQU   ASCBDSP1                                                 12170000
ASCBRF05 EQU   ASCBDSP1                                                 12171000
ASCBRF04 EQU   ASCBDSP1                                                 12172000
ASCBRF03 EQU   ASCBDSP1                                                 12173000
ASCBRF02 EQU   ASCBDSP1                                                 12174000
ASCBFAIL EQU   ASCBDSP1                                                 12175000
ASCBNOQ  EQU   ASCBDSP1                                                 12176000
ASCBSWCT EQU   ASCB+112                                                 12177000
ASCBASXB EQU   ASCB+108                                                 12178000
ASCBTMCH EQU   ASCB+104                                                 12179000
ASCBNSWP EQU   ASCBFLG1                                                 12180000
ASCBTYP1 EQU   ASCBFLG1                                                 12181000
ASCBSTND EQU   ASCBFLG1                                                 12182000
ASCBABNT EQU   ASCBFLG1                                                 12183000
ASCBTERM EQU   ASCBFLG1                                                 12184000
ASCBS3S  EQU   ASCBFLG1                                                 12185000
ASCBCMSH EQU   ASCBFLG1                                                 12186000
ASCBTOFF EQU   ASCBFLG1                                                 12187000
ASCBRF01 EQU   ASCBRCTF                                                 12188000
ASCBTMLW EQU   ASCBRCTF                                                 12189000
ASCBOUT  EQU   ASCBRCTF                                                 12190000
ASCBWAIT EQU   ASCBRCTF                                                 12191000
ASCBRV08 EQU   ASCBRCTF                                                 12192000
ASCBFQU  EQU   ASCBRCTF                                                 12193000
ASCBFRS  EQU   ASCBRCTF                                                 12194000
ASCBTMNO EQU   ASCBRCTF                                                 12195000
ASCBDUMP EQU   ASCB+96                                                  12196000
ASCBRV44 EQU   ASCB+92                                                  12197000
ASCBUBET EQU   ASCB+88                                                  12198000
ASCBECB  EQU   ASCB+84                                                  12199000
ASCBJSTL EQU   ASCB+80                                                  12200000
ASCBEWST EQU   ASCB+72                                                  12201000
ASCBEJST EQU   ASCB+64                                                  12202000
ASCBTSB  EQU   ASCB+60                                                  12203000
ASCBCSCB EQU   ASCB+56                                                  12204000
ASCBRSMA EQU   ASCBRSM+1                                                12205000
ASCBRV54 EQU   ASCBRSMF                                                 12206000
ASCBRV53 EQU   ASCBRSMF                                                 12207000
ASCBRV52 EQU   ASCBRSMF                                                 12208000
ASCBRV51 EQU   ASCBRSMF                                                 12209000
ASCBVEQR EQU   ASCBRSMF                                                 12210000
ASCBN2LP EQU   ASCBRSMF                                                 12211000
ASCB1LPU EQU   ASCBRSMF                                                 12212000
ASCB2LPU EQU   ASCBRSMF                                                 12213000
ASCBLDA  EQU   ASCB+48                                                  12214000
ASCBSTOR EQU   ASCB+44                                                  12215000
ASCBDP   EQU   ASCB+43                                                  12216000
ASCBRV07 EQU   ASCB+42                                                  12217000
ASCBIOSM EQU   ASCB+40                                                  12218000
ASCBSEQN EQU   ASCB+38                                                  12219000
ASCBASID EQU   ASCB+36                                                  12220000
ASCBCPUS EQU   ASCB+32                                                  12221000
ASCBSPL  EQU   ASCB+28                                                  12222000
ASCBIOSP EQU   ASCB+24                                                  12223000
ASCBSYNC EQU   ASCBSUPC+4                                               12224000
ASCBSVRB EQU   ASCBSUPC                                                 12225000
ASCBCMSF EQU   ASCB+12                                                  12226000
ASCBBWDP EQU   ASCB+8                                                   12227000
ASCBFWDP EQU   ASCB+4                                                   12228000
ASCBASCB EQU   ASCB                                                     12229000
ASCBEGIN EQU   ASCB                                                     12230000
@NM00017 EQU   CSD+160                                                  12231000
CSDUCNT  EQU   CSD+124                                                  12232000
CSDTCNT  EQU   CSD+120                                                  12233000
CSDGDTOD EQU   CSD+116                                                  12234000
CSDGDINT EQU   CSD+112                                                  12235000
CSDGDCC  EQU   CSD+108                                                  12236000
CSDDDRCT EQU   CSD+106                                                  12237000
CSDRV044 EQU   CSD+104                                                  12238000
CSDMAFF  EQU   CSD+24                                                   12239000
CSDRV038 EQU   CSDFLAGS                                                 12240000
CSDRV037 EQU   CSDFLAGS                                                 12241000
CSDRV036 EQU   CSDFLAGS                                                 12242000
CSDRV035 EQU   CSDFLAGS                                                 12243000
CSDRV034 EQU   CSDFLAGS                                                 12244000
CSDRV033 EQU   CSDFLAGS                                                 12245000
CSDRV032 EQU   CSDFLAGS                                                 12246000
CSDACR   EQU   CSD+22                                                   12247000
CSDMF1CP EQU   CSD+20                                                   12248000
CSDRV043 EQU   CSD+16                                                   12249000
CSDRV030 EQU   CSDSCFL4                                                 12250000
CSDRV029 EQU   CSDSCFL4                                                 12251000
CSDRV028 EQU   CSDSCFL4                                                 12252000
CSDRV027 EQU   CSDSCFL4                                                 12253000
CSDRV026 EQU   CSDSCFL4                                                 12254000
CSDRV025 EQU   CSDSCFL4                                                 12255000
CSDRV024 EQU   CSDSCFL4                                                 12256000
CSDRV023 EQU   CSDSCFL4                                                 12257000
CSDRV022 EQU   CSDSCFL3                                                 12258000
CSDRV021 EQU   CSDSCFL3                                                 12259000
CSDRV020 EQU   CSDSCFL3                                                 12260000
CSDRV019 EQU   CSDSCFL3                                                 12261000
CSDRV018 EQU   CSDSCFL3                                                 12262000
CSDRV017 EQU   CSDSCFL3                                                 12263000
CSDRV016 EQU   CSDSCFL3                                                 12264000
CSDRV015 EQU   CSDSCFL3                                                 12265000
CSDRV014 EQU   CSDSCFL2                                                 12266000
CSDRV013 EQU   CSDSCFL2                                                 12267000
CSDRV012 EQU   CSDSCFL2                                                 12268000
CSDRV011 EQU   CSDSCFL2                                                 12269000
CSDRV010 EQU   CSDSCFL2                                                 12270000
CSDRV009 EQU   CSDSCFL2                                                 12271000
CSDRV008 EQU   CSDSCFL2                                                 12272000
CSDRV007 EQU   CSDSCFL2                                                 12273000
CSDRV006 EQU   CSDSCFL1                                                 12274000
CSDRV005 EQU   CSDSCFL1                                                 12275000
CSDRV004 EQU   CSDSCFL1                                                 12276000
CSDRV003 EQU   CSDSCFL1                                                 12277000
CSDRV002 EQU   CSDSCFL1                                                 12278000
CSDRV001 EQU   CSDSCFL1                                                 12279000
CSDSYSND EQU   CSDSCFL1                                                 12280000
CSDRV042 EQU   CSDSCFL1                                                 12281000
CSDSAFF  EQU   CSDCPUAL                                                 12282000
CSDCSD   EQU   CSD                                                      12283000
RVTMIH2  EQU   RVT+108                                                  12284000
RVTMIH   EQU   RVT+104                                                  12285000
RVTCCHCR EQU   RVT+100                                                  12286000
RVTCCHDA EQU   RVT+96                                                   12287000
RVTMSGLN EQU   RVT+92                                                   12288000
RVTMSGPT EQU   RVT+88                                                   12289000
RVTLRBPT EQU   RVT+84                                                   12290000
RVTRWAPT EQU   RVT+80                                                   12291000
RVT01MMM EQU   RVT+76                                                   12292000
RVT00MMM EQU   RVT+72                                                   12293000
RVTPEXIT EQU   RVT+68                                                   12294000
RVTPKREF EQU   RVT+64                                                   12295000
RVTPXMFA EQU   RVT+56                                                   12296000
RVTPTAIM EQU   RVT+52                                                   12297000
RVTPTCON EQU   RVT+48                                                   12298000
RVTPTREC EQU   RVT+44                                                   12299000
RVTPTSIG EQU   RVT+40                                                   12300000
RVTPTERM EQU   RVT+36                                                   12301000
RVTPMKTA EQU   RVT+32                                                   12302000
RVTPMMSG EQU   RVT+28                                                   12303000
RVTPMTHA EQU   RVT+24                                                   12304000
RVTPMPFX EQU   RVT+20                                                   12305000
RVTPMSCA EQU   RVT+16                                                   12306000
RVTPMHCA EQU   RVT+12                                                   12307000
RVTPMFRS EQU   RVT+8                                                    12308000
RVTPMRTM EQU   RVT+4                                                    12309000
RVTPMCIH EQU   RVT                                                      12310000
CATEND   EQU   CAT+8                                                    12311000
CATFLARS EQU   CATFLA                                                   12312000
CATSOL   EQU   CATFLA                                                   12313000
CATMCRST EQU   CATFLA                                                   12314000
CATCCRST EQU   CATFLA                                                   12315000
CATIORST EQU   CATFLA                                                   12316000
CATBSY   EQU   CATFLA                                                   12317000
CATDSABL EQU   CATFLG                                                   12318000
CATFLG6  EQU   CATFLG                                                   12319000
CATFLG5  EQU   CATFLG                                                   12320000
CATNCPU  EQU   CATFLG                                                   12321000
CATRES1  EQU   CATFLG                                                   12322000
LCCAR125 EQU   LCCA+964                                                 12323000
LCCAR124 EQU   LCCA+960                                                 12324000
LCCASGPR EQU   LCCA+896                                                 12325000
LCCADRT2 EQU   LCCA+888                                                 12326000
LCCADRT1 EQU   LCCA+880                                                 12327000
LCCAR103 EQU   LCCA+876                                                 12328000
LCCAESS2 EQU   LCCA+872                                                 12329000
LCCASPLJ EQU   LCCA+868                                                 12330000
LCCASMQJ EQU   LCCA+864                                                 12331000
LCCAASID EQU   LCCA+732                                                 12332000
LCCARV89 EQU   LCCA+728                                                 12333000
LCCAPGTA EQU   LCCASRBF+2                                               12334000
LCCASAFN EQU   LCCASRBF                                                 12335000
LCCAECSA EQU   LCCA+716                                                 12336000
LCCAICR0 EQU   LCCA+712                                                 12337000
LCCALWTM EQU   LCCA+704                                                 12338000
LCCARV78 EQU   LCCA+700                                                 12339000
LCCAPINV EQU   LCCA+696                                                 12340000
LCCARV88 EQU   LCCA+695                                                 12341000
LCCARV87 EQU   LCCALKFG                                                 12342000
LCCARV86 EQU   LCCALKFG                                                 12343000
LCCARV85 EQU   LCCALKFG                                                 12344000
LCCARV84 EQU   LCCALKFG                                                 12345000
LCCALKRD EQU   LCCALKFG                                                 12346000
LCCALKAQ EQU   LCCALKFG                                                 12347000
LCCALKSA EQU   LCCALKFG                                                 12348000
LCCALKDP EQU   LCCALKFG                                                 12349000
LCCACRST EQU   LCCACREX                                                 12350000
LCCACRDP EQU   LCCACREX                                                 12351000
LCCACRLM EQU   LCCACREX                                                 12352000
LCCACRIN EQU   LCCACREX                                                 12353000
LCCACRRT EQU   LCCACREX                                                 12354000
LCCACRLE EQU   LCCACREX                                                 12355000
LCCACRRM EQU   LCCACREX                                                 12356000
LCCACREF EQU   LCCACREX                                                 12357000
LCCARV73 EQU   LCCACRFL                                                 12358000
LCCARV72 EQU   LCCACRFL                                                 12359000
LCCARV71 EQU   LCCACRFL                                                 12360000
LCCARV70 EQU   LCCACRFL                                                 12361000
LCCARV69 EQU   LCCACRFL                                                 12362000
LCCACLMS EQU   LCCACRFL                                                 12363000
LCCACRTM EQU   LCCACRFL                                                 12364000
LCCALCR0 EQU   LCCA+688                                                 12365000
LCCACRLC EQU   LCCA+684                                                 12366000
LCCARCPU EQU   LCCA+680                                                 12367000
LCCADCPU EQU   LCCA+676                                                 12368000
LCCASRBJ EQU   LCCA+672                                                 12369000
LCCADSSR EQU   LCCA+668                                                 12370000
LCCADSSC EQU   LCCA+660                                                 12371000
LCCADSS3 EQU   LCCA+648                                                 12372000
LCCADSS2 EQU   LCCA+636                                                 12373000
LCCADSS1 EQU   LCCA+624                                                 12374000
LCCAWTIM EQU   LCCA+616                                                 12375000
LCCAITOD EQU   LCCA+608                                                 12376000
LCCADTOD EQU   LCCA+600                                                 12377000
LCCASTOD EQU   LCCA+592                                                 12378000
LCCARIR5 EQU   LCCASPSA+44                                              12379000
LCCARIR4 EQU   LCCASPSA+40                                              12380000
LCCARIR3 EQU   LCCASPSA+36                                              12381000
LCCARIR2 EQU   LCCASPSA+32                                              12382000
LCCARPR5 EQU   LCCASPSA+28                                              12383000
LCCARPR4 EQU   LCCASPSA+24                                              12384000
LCCARPR3 EQU   LCCASPSA+20                                              12385000
LCCARPR2 EQU   LCCASPSA+16                                              12386000
LCCADSR5 EQU   LCCASPSA+12                                              12387000
LCCADSR4 EQU   LCCASPSA+8                                               12388000
LCCADSR3 EQU   LCCASPSA+4                                               12389000
LCCADSR2 EQU   LCCASPSA                                                 12390000
LCCARV68 EQU   LCCA+543                                                 12391000
LCCAPSMK EQU   LCCA+542                                                 12392000
LCCARV67 EQU   LCCADSF2                                                 12393000
LCCARV66 EQU   LCCADSF2                                                 12394000
LCCARV65 EQU   LCCADSF2                                                 12395000
LCCARV64 EQU   LCCADSF2                                                 12396000
LCCADSRW EQU   LCCADSF2                                                 12397000
LCCADSPL EQU   LCCADSF2                                                 12398000
LCCAGSRB EQU   LCCADSF2                                                 12399000
LCCASRBM EQU   LCCADSF2                                                 12400000
LCCARV61 EQU   LCCADSF1                                                 12401000
LCCARV60 EQU   LCCADSF1                                                 12402000
LCCARV59 EQU   LCCADSF1                                                 12403000
LCCARV58 EQU   LCCADSF1                                                 12404000
LCCADSS  EQU   LCCADSF1                                                 12405000
LCCAACR  EQU   LCCADSF1                                                 12406000
LCCAASCP EQU   LCCA+532                                                 12407000
LCCAESSA EQU   LCCA+528                                                 12408000
LCCARV55 EQU   LCCASPN4                                                 12409000
LCCARV54 EQU   LCCASPN4                                                 12410000
LCCARV53 EQU   LCCASPN4                                                 12411000
LCCARV52 EQU   LCCASPN4                                                 12412000
LCCARV51 EQU   LCCASPN4                                                 12413000
LCCARV50 EQU   LCCASPN4                                                 12414000
LCCARV49 EQU   LCCASPN4                                                 12415000
LCCARV48 EQU   LCCASPN4                                                 12416000
LCCARV47 EQU   LCCASPN3                                                 12417000
LCCARV46 EQU   LCCASPN3                                                 12418000
LCCARV45 EQU   LCCASPN3                                                 12419000
LCCARV44 EQU   LCCASPN3                                                 12420000
LCCARV43 EQU   LCCASPN3                                                 12421000
LCCARV42 EQU   LCCASPN3                                                 12422000
LCCARV41 EQU   LCCASPN3                                                 12423000
LCCARV40 EQU   LCCASPN3                                                 12424000
LCCARV39 EQU   LCCASPN2                                                 12425000
LCCARV38 EQU   LCCASPN2                                                 12426000
LCCARV37 EQU   LCCASPN2                                                 12427000
LCCARV36 EQU   LCCASPN2                                                 12428000
LCCARV35 EQU   LCCASPN2                                                 12429000
LCCARV34 EQU   LCCASPN2                                                 12430000
LCCARV33 EQU   LCCASPN2                                                 12431000
LCCARV32 EQU   LCCASPN2                                                 12432000
LCCARV31 EQU   LCCASPN1                                                 12433000
LCCARV30 EQU   LCCASPN1                                                 12434000
LCCAMFIO EQU   LCCASPN1                                                 12435000
LCCARSTR EQU   LCCASPN1                                                 12436000
LCCATSPN EQU   LCCASPN1                                                 12437000
LCCALOCK EQU   LCCASPN1                                                 12438000
LCCASIGP EQU   LCCASPN1                                                 12439000
LCCAPTLB EQU   LCCASPN1                                                 12440000
LCCARV27 EQU   LCCAIHR4                                                 12441000
LCCARV26 EQU   LCCAIHR4                                                 12442000
LCCARV25 EQU   LCCAIHR4                                                 12443000
LCCARV24 EQU   LCCAIHR4                                                 12444000
LCCARV23 EQU   LCCAIHR4                                                 12445000
LCCARV22 EQU   LCCAIHR4                                                 12446000
LCCARV21 EQU   LCCAIHR4                                                 12447000
LCCARV20 EQU   LCCAIHR4                                                 12448000
LCCARV19 EQU   LCCAIHR3                                                 12449000
LCCARV18 EQU   LCCAIHR3                                                 12450000
LCCARV17 EQU   LCCAIHR3                                                 12451000
LCCARV16 EQU   LCCAIHR3                                                 12452000
LCCARV15 EQU   LCCAIHR3                                                 12453000
LCCARV14 EQU   LCCAIHR3                                                 12454000
LCCARV13 EQU   LCCAIHR3                                                 12455000
LCCARV12 EQU   LCCAIHR3                                                 12456000
LCCARV11 EQU   LCCAIHR2                                                 12457000
LCCARV10 EQU   LCCAIHR2                                                 12458000
LCCARV09 EQU   LCCAIHR2                                                 12459000
LCCARV08 EQU   LCCAIHR2                                                 12460000
LCCARV07 EQU   LCCAIHR2                                                 12461000
LCCARV06 EQU   LCCAIHR2                                                 12462000
LCCARV05 EQU   LCCAIHR2                                                 12463000
LCCARV04 EQU   LCCAIHR2                                                 12464000
LCCARV03 EQU   LCCAIHR1                                                 12465000
LCCARV02 EQU   LCCAIHR1                                                 12466000
LCCARV01 EQU   LCCAIHR1                                                 12467000
LCCAPPIE EQU   LCCAIHR1                                                 12468000
LCCAPSG1 EQU   LCCAIHR1                                                 12469000
LCCAPDAT EQU   LCCAIHR1                                                 12470000
LCCAXRC2 EQU   LCCAIHR1                                                 12471000
LCCAXRC1 EQU   LCCAIHR1                                                 12472000
LCCAIOPS EQU   LCCA+512                                                 12473000
LCCAGPGR EQU   LCCA+448                                                 12474000
LCCAR133 EQU   LCCA+444                                                 12475000
LCCAR132 EQU   LCCA+440                                                 12476000
LCCAR131 EQU   LCCA+436                                                 12477000
LCCAR130 EQU   LCCA+432                                                 12478000
LCCAR129 EQU   LCCA+428                                                 12479000
LCCAR128 EQU   LCCA+424                                                 12480000
LCCAR127 EQU   LCCA+420                                                 12481000
LCCAR126 EQU   LCCA+416                                                 12482000
LCCARSGR EQU   LCCA+352                                                 12483000
LCCAXGR3 EQU   LCCA+288                                                 12484000
LCCAXGR2 EQU   LCCA+224                                                 12485000
LCCAXGR1 EQU   LCCA+160                                                 12486000
LCCACR0  EQU   LCCA+156                                                 12487000
LCCAPVAD EQU   LCCA+148                                                 12488000
LCCAPINT EQU   LCCA+144                                                 12489000
LCCAPPSW EQU   LCCA+136                                                 12490000
LCCAPGR2 EQU   LCCA+72                                                  12491000
LCCAPGR1 EQU   LCCA+8                                                   12492000
LCCARV77 EQU   LCCA+6                                                   12493000
@NM00016 EQU   PCCA+512                                                 12494000
PCCARV36 EQU   PCCA+380                                                 12495000
PCCARV35 EQU   PCCA+378                                                 12496000
PCCARV01 EQU   PCCA+377                                                 12497000
PCCAR105 EQU   PCCAATTR                                                 12498000
PCCAR104 EQU   PCCAATTR                                                 12499000
PCCAR103 EQU   PCCAATTR                                                 12500000
PCCAR102 EQU   PCCAATTR                                                 12501000
PCCAR101 EQU   PCCAATTR                                                 12502000
PCCAR100 EQU   PCCAATTR                                                 12503000
PCCARV63 EQU   PCCA+372                                                 12504000
PCCARV62 EQU   PCCA+368                                                 12505000
PCCARV61 EQU   PCCA+364                                                 12506000
PCCARV60 EQU   PCCA+360                                                 12507000
PCCARV59 EQU   PCCA+356                                                 12508000
PCCARV58 EQU   PCCA+352                                                 12509000
PCCARV57 EQU   PCCA+348                                                 12510000
PCCARV56 EQU   PCCA+344                                                 12511000
PCCARV55 EQU   PCCA+340                                                 12512000
PCCARV54 EQU   PCCA+336                                                 12513000
PCCALOGA EQU   PCCA+332                                                 12514000
PCCACHID EQU   PCCA+324                                                 12515000
PCCACHSV EQU   PCCA+312                                                 12516000
PCCARV79 EQU   PCCACHF4                                                 12517000
PCCARV78 EQU   PCCACHF4                                                 12518000
PCCARV77 EQU   PCCACHF4                                                 12519000
PCCARV76 EQU   PCCACHF4                                                 12520000
PCCARV75 EQU   PCCACHF4                                                 12521000
PCCARV74 EQU   PCCACHF4                                                 12522000
PCCARV73 EQU   PCCACHF4                                                 12523000
PCCARV72 EQU   PCCACHF4                                                 12524000
PCCARV71 EQU   PCCACHF3                                                 12525000
PCCARV70 EQU   PCCACHF3                                                 12526000
PCCARV69 EQU   PCCACHF3                                                 12527000
PCCARV68 EQU   PCCACHF3                                                 12528000
PCCARV67 EQU   PCCACHF3                                                 12529000
PCCARV66 EQU   PCCACHF3                                                 12530000
PCCASLCK EQU   PCCACHF3                                                 12531000
PCCAISRB EQU   PCCACHF3                                                 12532000
PCCACF28 EQU   PCCACHF2                                                 12533000
PCCACF27 EQU   PCCACHF2                                                 12534000
PCCACF26 EQU   PCCACHF2                                                 12535000
PCCACF25 EQU   PCCACHF2                                                 12536000
PCCACF24 EQU   PCCACHF2                                                 12537000
PCCACF23 EQU   PCCACHF2                                                 12538000
PCCACF22 EQU   PCCACHF2                                                 12539000
PCCACF21 EQU   PCCACHF2                                                 12540000
PCCACF18 EQU   PCCACHF1                                                 12541000
PCCACF17 EQU   PCCACHF1                                                 12542000
PCCACF16 EQU   PCCACHF1                                                 12543000
PCCACF15 EQU   PCCACHF1                                                 12544000
PCCACF14 EQU   PCCACHF1                                                 12545000
PCCACF13 EQU   PCCACHF1                                                 12546000
PCCACF12 EQU   PCCACHF1                                                 12547000
PCCACF11 EQU   PCCACHF1                                                 12548000
PCCARV05 EQU   PCCA+307                                                 12549000
PCCACHPB EQU   PCCA+306                                                 12550000
PCCALGP2 EQU   PCCA+305                                                 12551000
PCCALGP1 EQU   PCCA+304                                                 12552000
PCCACELL EQU   PCCA+302                                                 12553000
PCCALOGL EQU   PCCA+300                                                 12554000
PCCACHW2 EQU   PCCA+296                                                 12555000
PCCACHW1 EQU   PCCA+292                                                 12556000
PCCAIOSI EQU   PCCA+291                                                 12557000
PCCACNRB EQU   PCCACHRB                                                 12558000
PCCACCVB EQU   PCCACHRB                                                 12559000
PCCACSNB EQU   PCCACHRB                                                 12560000
PCCARV52 EQU   PCCACHRB                                                 12561000
PCCACHIB EQU   PCCACHRB                                                 12562000
PCCACTIB EQU   PCCACHRB                                                 12563000
PCCACINB EQU   PCCACHRB                                                 12564000
PCCACSIB EQU   PCCACHRB                                                 12565000
PCCARV51 EQU   PCCACHS2                                                 12566000
PCCARV50 EQU   PCCACHS2                                                 12567000
PCCACCRA EQU   PCCACHS2                                                 12568000
PCCACURC EQU   PCCACHS2                                                 12569000
PCCACNLG EQU   PCCACHS2                                                 12570000
PCCACMOD EQU   PCCACHS2                                                 12571000
PCCACALT EQU   PCCACHS2                                                 12572000
PCCACIOR EQU   PCCACHS2                                                 12573000
PCCARV47 EQU   PCCACHS1                                                 12574000
PCCACUCB EQU   PCCACHS1                                                 12575000
PCCACIBC EQU   PCCACHS1                                                 12576000
PCCACAND EQU   PCCACHS1                                                 12577000
PCCACNLS EQU   PCCACHS1                                                 12578000
PCCACFRR EQU   PCCACHS1                                                 12579000
PCCACNRE EQU   PCCACHS1                                                 12580000
PCCACCMP EQU   PCCACHS1                                                 12581000
PCCACSEQ EQU   PCCACHTS                                                 12582000
PCCACDIN EQU   PCCACHTS                                                 12583000
PCCARV44 EQU   PCCACHTS                                                 12584000
PCCARV43 EQU   PCCACHTS                                                 12585000
PCCACTEC EQU   PCCACHTS                                                 12586000
PCCACDAV EQU   PCCACHVA                                                 12587000
PCCACCHV EQU   PCCACHVA                                                 12588000
PCCACCMD EQU   PCCACHVA                                                 12589000
PCCACUNS EQU   PCCACHVA                                                 12590000
PCCACSQV EQU   PCCACHVA                                                 12591000
PCCARV42 EQU   PCCACHVA                                                 12592000
PCCARV41 EQU   PCCACHVA                                                 12593000
PCCACITF EQU   PCCACHVA                                                 12594000
PCCARV40 EQU   PCCACHBL                                                 12595000
PCCARV39 EQU   PCCACHBL                                                 12596000
PCCARV38 EQU   PCCACHBL                                                 12597000
PCCACCUE EQU   PCCACHBL                                                 12598000
PCCACSTG EQU   PCCACHBL                                                 12599000
PCCACSCU EQU   PCCACHBL                                                 12600000
PCCACCHA EQU   PCCACHBL                                                 12601000
PCCACCPU EQU   PCCACHBL                                                 12602000
PCCACNOR EQU   PCCACHPF                                                 12603000
PCCACCNT EQU   PCCACHPF                                                 12604000
PCCACSNS EQU   PCCACHPF                                                 12605000
PCCARV37 EQU   PCCACHPF                                                 12606000
PCCACHIO EQU   PCCACHPF                                                 12607000
PCCACTIO EQU   PCCACHPF                                                 12608000
PCCACINT EQU   PCCACHPF                                                 12609000
PCCACSIO EQU   PCCACHPF                                                 12610000
PCCACHUB EQU   PCCAWERP                                                 12611000
PCCAR106 EQU   PCCA+228                                                 12612000
PCCAR113 EQU   PCCA+226                                                 12613000
PCCASRBL EQU   PCCA+225                                                 12614000
PCCAR112 EQU   PCCACHAN                                                 12615000
PCCAR111 EQU   PCCACHAN                                                 12616000
PCCAR110 EQU   PCCACHAN                                                 12617000
PCCAR109 EQU   PCCACHAN                                                 12618000
PCCAR108 EQU   PCCACHAN                                                 12619000
PCCAR107 EQU   PCCACHAN                                                 12620000
PCCAEXDM EQU   PCCACHAN                                                 12621000
PCCAIRST EQU   PCCACHAN                                                 12622000
PCCASRB  EQU   PCCA+180                                                 12623000
PCCACCHM EQU   PCCA+176                                                 12624000
PCCAELBA EQU   PCCA+172                                                 12625000
PCCAELAD EQU   PCCA+168                                                 12626000
PCCALRBR EQU   PCCA+164                                                 12627000
PCCALRBV EQU   PCCA+160                                                 12628000
PCCAPWAR EQU   PCCA+156                                                 12629000
PCCAPWAV EQU   PCCA+152                                                 12630000
PCCAEMSA EQU   PCCAEMSB+12                                              12631000
PCCAEMSE EQU   PCCAEMSB+8                                               12632000
PCCAEMSP EQU   PCCAEMSB+4                                               12633000
PCCARMS  EQU   PCCARMSB                                                 12634000
PCCARV34 EQU   PCCARMSB                                                 12635000
PCCARV33 EQU   PCCARMSB                                                 12636000
PCCARV32 EQU   PCCARMSB                                                 12637000
PCCARV31 EQU   PCCARMSB                                                 12638000
PCCARV30 EQU   PCCARMSB                                                 12639000
PCCARV29 EQU   PCCARMSB                                                 12640000
PCCARV28 EQU   PCCARMSB                                                 12641000
PCCARV27 EQU   PCCAEMS3                                                 12642000
PCCARV26 EQU   PCCAEMS3                                                 12643000
PCCARV25 EQU   PCCAEMS3                                                 12644000
PCCARV24 EQU   PCCAEMS3                                                 12645000
PCCARV23 EQU   PCCAEMS3                                                 12646000
PCCARV22 EQU   PCCAEMS3                                                 12647000
PCCARV21 EQU   PCCAEMS3                                                 12648000
PCCARV20 EQU   PCCAEMS3                                                 12649000
PCCARV19 EQU   PCCAEMS2                                                 12650000
PCCARV18 EQU   PCCAEMS2                                                 12651000
PCCARV17 EQU   PCCAEMS2                                                 12652000
PCCARV16 EQU   PCCAEMS2                                                 12653000
PCCARV15 EQU   PCCAEMS2                                                 12654000
PCCARV14 EQU   PCCAEMS2                                                 12655000
PCCARV13 EQU   PCCAEMS2                                                 12656000
PCCARV12 EQU   PCCAEMS2                                                 12657000
PCCARV11 EQU   PCCARISP                                                 12658000
PCCARV10 EQU   PCCARISP                                                 12659000
PCCARV09 EQU   PCCARISP                                                 12660000
PCCARV08 EQU   PCCARISP                                                 12661000
PCCARV07 EQU   PCCARISP                                                 12662000
PCCARV06 EQU   PCCARISP                                                 12663000
PCCASERL EQU   PCCARISP                                                 12664000
PCCAPARL EQU   PCCARISP                                                 12665000
PCCARPB  EQU   PCCA+132                                                 12666000
PCCACTIN EQU   PCCAINTE                                                 12667000
PCCANFIN EQU   PCCAINTE                                                 12668000
PCCANUIN EQU   PCCAINTE                                                 12669000
PCCACTCC EQU   PCCACCE                                                  12670000
PCCANFCC EQU   PCCACCE                                                  12671000
PCCANUCC EQU   PCCACCE                                                  12672000
PCCACTTD EQU   PCCATODE                                                 12673000
PCCANFTD EQU   PCCATODE                                                 12674000
PCCANUTD EQU   PCCATODE                                                 12675000
PCCARV04 EQU   PCCATMFL                                                 12676000
PCCARV03 EQU   PCCATMFL                                                 12677000
PCCARV02 EQU   PCCATMFL                                                 12678000
PCCAMINT EQU   PCCATMFL                                                 12679000
PCCAMCC  EQU   PCCATMFL                                                 12680000
PCCAVKIL EQU   PCCATMFL                                                 12681000
PCCASYNC EQU   PCCATMFL                                                 12682000
PCCAINIT EQU   PCCATMFL                                                 12683000
PCCARV9E EQU   PCCA+124                                                 12684000
PCCARV9D EQU   PCCA+120                                                 12685000
PCCARV9C EQU   PCCA+116                                                 12686000
PCCARV9B EQU   PCCA+112                                                 12687000
PCCARV9A EQU   PCCA+108                                                 12688000
PCCARV99 EQU   PCCA+104                                                 12689000
PCCARV98 EQU   PCCA+100                                                 12690000
PCCARV97 EQU   PCCA+96                                                  12691000
PCCARV96 EQU   PCCA+92                                                  12692000
PCCARV95 EQU   PCCA+88                                                  12693000
PCCARV94 EQU   PCCA+84                                                  12694000
PCCARV93 EQU   PCCA+80                                                  12695000
PCCARV92 EQU   PCCA+76                                                  12696000
PCCARV91 EQU   PCCA+72                                                  12697000
PCCARV90 EQU   PCCA+68                                                  12698000
PCCARV89 EQU   PCCA+64                                                  12699000
PCCARV88 EQU   PCCA+60                                                  12700000
PCCARV87 EQU   PCCA+56                                                  12701000
PCCARV86 EQU   PCCA+52                                                  12702000
PCCARV85 EQU   PCCA+48                                                  12703000
PCCARV84 EQU   PCCA+44                                                  12704000
PCCARV83 EQU   PCCA+40                                                  12705000
PCCARV82 EQU   PCCA+36                                                  12706000
PCCARV81 EQU   PCCA+32                                                  12707000
PCCATQEP EQU   PCCA+20                                                  12708000
CHSAVWD2 EQU   CHSHORT+100                                              12709000
CHSAVWD1 EQU   CHSHORT+96                                               12710000
CHJSCBVS EQU   CHSHORT+92                                               12711000
CHUSCVS  EQU   CHSHORT+88                                               12712000
@NM00014 EQU   CHSHORT+84                                               12713000
@NM00013 EQU   CHSHORT+80                                               12714000
CHSQA    EQU   CHSHORT+44                                               12715000
CHQPA    EQU   CHSHORT+8                                                12716000
CHJCL    EQU   CHSHORT+4                                                12717000
CHSPC    EQU   CHSHORT                                                  12718000
CHSPB    EQU   CHSTEP+4                                                 12719000
CHTCB    EQU   CHSTEP+1                                                 12720000
CHARSV23 EQU   CHSWT                                                    12721000
CHARSV22 EQU   CHSWT                                                    12722000
CHARSV21 EQU   CHSWT                                                    12723000
CHAC     EQU   CHSWT                                                    12724000
CHPSF    EQU   CHSWT                                                    12725000
CHPSD    EQU   CHSWT                                                    12726000
CHJCT    EQU   CHSWT                                                    12727000
CHARSV20 EQU   CHSWT                                                    12728000
CHCECB   EQU   CHASM+20                                                 12729000
CHECB    EQU   CHASM+16                                                 12730000
CHRGNAD  EQU   CHASM+12                                                 12731000
CHARSV18 EQU   CHRGNSZ+1                                                12732000
CHRPRTY  EQU   CHRGNSZ                                                  12733000
@NM00012 EQU   CHCIBP                                                   12734000
CHEND    EQU   CHCIBP                                                   12735000
CHECBP   EQU   CHASM                                                    12736000
CHDER    EQU   CHPROCSN+4                                               12737000
CHARSV10 EQU   CHACT1                                                   12738000
CHARSV09 EQU   CHACT1                                                   12739000
CHARSV08 EQU   CHACT1                                                   12740000
CHARSV07 EQU   CHACT1                                                   12741000
CHARSV06 EQU   CHACT1                                                   12742000
CHARSV05 EQU   CHACT1                                                   12743000
CHARSV04 EQU   CHACT1                                                   12744000
CHRDWTR  EQU   CHACT1                                                   12745000
CHARSV30 EQU   CHPROCSN+2                                               12746000
CHQID    EQU   CHPROCSN                                                 12747000
CHASID   EQU   CHTJID                                                   12748000
CHTRKID  EQU   CHPKE                                                    12749000
CHCIBCTR EQU   CHAIN+27                                                 12750000
CHUNIT   EQU   CHAIN+24                                                 12751000
CHCLS    EQU   CHAIN+16                                                 12752000
CHPCOI   EQU   CHPARM                                                   12753000
CHAFORCE EQU   CHIFY                                                    12754000
CHAIFX   EQU   CHACT                                                    12755000
CHCLD    EQU   CHACT                                                    12756000
CHCL     EQU   CHACT                                                    12757000
CHDSI    EQU   CHACT                                                    12758000
CHDISC   EQU   CHACT                                                    12759000
CHTERM   EQU   CHACT                                                    12760000
CHSWAP   EQU   CHACT                                                    12761000
CHABTERM EQU   CHSTS                                                    12762000
CHFC     EQU   CHSTS                                                    12763000
CHDL     EQU   CHSTS                                                    12764000
CHAD     EQU   CHSTS                                                    12765000
CHQSPC   EQU   CHSTS                                                    12766000
CHSOUT   EQU   CHSTS                                                    12767000
CHSYS    EQU   CHSTS                                                    12768000
CHAP     EQU   CHSTS                                                    12769000
CHSZE    EQU   CHFLG+1                                                  12770000
CHVCD    EQU   CHFLG                                                    12771000
CHPTR    EQU   CHAIN                                                    12772000
CVTLEVL  EQU   CVTRELNO+2                                               12773000
CVTNUMB  EQU   CVTRELNO                                                 12774000
CVTMDL   EQU   CVTFIX+250                                               12775000
@NM00011 EQU   CVTFIX+248                                               12776000
@NM00010 EQU   CVTFIX                                                   12777000
CVTRV482 EQU   CVTXTNT2+128                                             12778000
CVTRV481 EQU   CVTXTNT2+124                                             12779000
CVTRV480 EQU   CVTXTNT2+120                                             12780000
CVTRV479 EQU   CVTXTNT2+118                                             12781000
CVTRV478 EQU   CVTXTNT2+117                                             12782000
CVTRV477 EQU   CVTXTNT2+116                                             12783000
CVTRV476 EQU   CVTXTNT2+115                                             12784000
CVTRV475 EQU   CVTXTNT2+114                                             12785000
CVTRV474 EQU   CVTRV466                                                 12786000
CVTRV473 EQU   CVTRV466                                                 12787000
CVTRV472 EQU   CVTRV466                                                 12788000
CVTRV471 EQU   CVTRV466                                                 12789000
CVTRV470 EQU   CVTRV466                                                 12790000
CVTRV469 EQU   CVTRV466                                                 12791000
CVTRV468 EQU   CVTRV466                                                 12792000
CVTRV467 EQU   CVTRV466                                                 12793000
CVTRV465 EQU   CVTRV457                                                 12794000
CVTRV464 EQU   CVTRV457                                                 12795000
CVTRV463 EQU   CVTRV457                                                 12796000
CVTRV462 EQU   CVTRV457                                                 12797000
CVTRV461 EQU   CVTRV457                                                 12798000
CVTRV460 EQU   CVTRV457                                                 12799000
CVTRV459 EQU   CVTRV457                                                 12800000
CVTRV458 EQU   CVTRV457                                                 12801000
CVTRV456 EQU   CVTXTNT2+108                                             12802000
CVTRV455 EQU   CVTXTNT2+104                                             12803000
CVTRV454 EQU   CVTXTNT2+100                                             12804000
CVTRV453 EQU   CVTXTNT2+96                                              12805000
CVTRV452 EQU   CVTXTNT2+94                                              12806000
CVTRV451 EQU   CVTXTNT2+92                                              12807000
CVTRV450 EQU   CVTXTNT2+90                                              12808000
CVTRV449 EQU   CVTXTNT2+88                                              12809000
CVTRV448 EQU   CVTXTNT2+87                                              12810000
CVTRV447 EQU   CVTXTNT2+86                                              12811000
CVTRV446 EQU   CVTRV438                                                 12812000
CVTRV445 EQU   CVTRV438                                                 12813000
CVTRV444 EQU   CVTRV438                                                 12814000
CVTRV443 EQU   CVTRV438                                                 12815000
CVTRV442 EQU   CVTRV438                                                 12816000
CVTRV441 EQU   CVTRV438                                                 12817000
CVTRV440 EQU   CVTRV438                                                 12818000
CVTRV439 EQU   CVTRV438                                                 12819000
CVTRV437 EQU   CVTRV429                                                 12820000
CVTRV436 EQU   CVTRV429                                                 12821000
CVTRV435 EQU   CVTRV429                                                 12822000
CVTRV434 EQU   CVTRV429                                                 12823000
CVTRV433 EQU   CVTRV429                                                 12824000
CVTRV432 EQU   CVTRV429                                                 12825000
CVTRV431 EQU   CVTRV429                                                 12826000
CVTRV430 EQU   CVTRV429                                                 12827000
CVTRV428 EQU   CVTXTNT2+80                                              12828000
CVTRV427 EQU   CVTXTNT2+76                                              12829000
CVTRV426 EQU   CVTXTNT2+72                                              12830000
CVTRV425 EQU   CVTXTNT2+68                                              12831000
CVTATACT EQU   CVTATCVT                                                 12832000
CVTRV423 EQU   CVTXTNT2+62                                              12833000
CVTRV422 EQU   CVTXTNT2+60                                              12834000
CVTRV421 EQU   CVTXTNT2+58                                              12835000
CVTRV420 EQU   CVTXTNT2+56                                              12836000
CVTRV419 EQU   CVTXTNT2+55                                              12837000
CVTRV418 EQU   CVTXTNT2+54                                              12838000
CVTRV417 EQU   CVTRV409                                                 12839000
CVTRV416 EQU   CVTRV409                                                 12840000
CVTRV415 EQU   CVTRV409                                                 12841000
CVTRV414 EQU   CVTRV409                                                 12842000
CVTRV413 EQU   CVTRV409                                                 12843000
CVTRV412 EQU   CVTRV409                                                 12844000
CVTRV411 EQU   CVTRV409                                                 12845000
CVTRV410 EQU   CVTRV409                                                 12846000
CVTRV408 EQU   CVTRV400                                                 12847000
CVTRV407 EQU   CVTRV400                                                 12848000
CVTRV406 EQU   CVTRV400                                                 12849000
CVTRV405 EQU   CVTRV400                                                 12850000
CVTRV404 EQU   CVTRV400                                                 12851000
CVTRV403 EQU   CVTRV400                                                 12852000
CVTRV402 EQU   CVTRV400                                                 12853000
CVTRV401 EQU   CVTRV400                                                 12854000
CVTSKTA  EQU   CVTXTNT2+44                                              12855000
CVTCCVT  EQU   CVTXTNT2+40                                              12856000
CVTRSV98 EQU   CVTXTNT2+36                                              12857000
CVTRSV97 EQU   CVTXTNT2+34                                              12858000
CVTRSV96 EQU   CVTXTNT2+32                                              12859000
CVTOLTEP EQU   CVTXTNT2+28                                              12860000
CVTQIDA  EQU   CVTQID+1                                                 12861000
CVTRSV95 EQU   CVTQID                                                   12862000
CVTRSV94 EQU   CVTXTNT2+20                                              12863000
CVTRSV93 EQU   CVTXTNT2+16                                              12864000
CVTRSV92 EQU   CVTXTNT2+12                                              12865000
CVTDEBVR EQU   CVTXTNT2+8                                               12866000
CVTRSV91 EQU   CVTXTNT2+6                                               12867000
CVTRSV9H EQU   CVTFLGBT                                                 12868000
CVTRSV9G EQU   CVTFLGBT                                                 12869000
CVTRSV9F EQU   CVTFLGBT                                                 12870000
CVTRSV9E EQU   CVTFLGBT                                                 12871000
CVTRSV9D EQU   CVTFLGBT                                                 12872000
CVTRSV9C EQU   CVTFLGBT                                                 12873000
CVTVME   EQU   CVTFLGBT                                                 12874000
CVTNPE   EQU   CVTFLGBT                                                 12875000
CVTNUCLS EQU   CVTXTNT2+4                                               12876000
CVTDSSVA EQU   CVTDSSV+1                                                12877000
CVTRSV89 EQU   CVTDSSV                                                  12878000
CVTRSV88 EQU   CVTXTNT1+8                                               12879000
CVTRSV87 EQU   CVTXTNT1+4                                               12880000
CVTFACHN EQU   CVTXTNT1                                                 12881000
CVTRV488 EQU   CVTMAP+412                                               12882000
CVTRV487 EQU   CVTMAP+408                                               12883000
CVTRV486 EQU   CVTMAP+404                                               12884000
CVTRV485 EQU   CVTMAP+400                                               12885000
CVTACTAP EQU   CVTMAP+396                                               12886000
CVTAUTH  EQU   CVTMAP+392                                               12887000
CVTATMCA EQU   CVTATMCT+1                                               12888000
CVTATMST EQU   CVTATMCT                                                 12889000
CVTRSV61 EQU   CVTMAP+384                                               12890000
CVTVOLT1 EQU   CVTVOLM1+1                                               12891000
CVTVOLI1 EQU   CVTVOLF1                                                 12892000
CVTSTOA  EQU   CVTMAP+376                                               12893000
CVTRSV58 EQU   CVTMAP+374                                               12894000
CVTRSV57 EQU   CVTMAP+372                                               12895000
CVTDDCE  EQU   CVTMAP+368                                               12896000
CVTPNWFR EQU   CVTMAP+364                                               12897000
CVTSMF   EQU   CVTMAP+360                                               12898000
CVTSULK  EQU   CVTMAP+358                                               12899000
CVTSLKO  EQU   CVTSYSK                                                  12900000
CVTSLKP  EQU   CVTSYSK                                                  12901000
CVTSLKQ  EQU   CVTSYSK                                                  12902000
CVTSLKR  EQU   CVTSYSK                                                  12903000
CVTRSV56 EQU   CVTSYSK                                                  12904000
CVTRSV55 EQU   CVTSYSK                                                  12905000
CVTRSV54 EQU   CVTSYSK                                                  12906000
CVTRSV53 EQU   CVTSYSK                                                  12907000
CVTRSV52 EQU   CVTA1F1                                                  12908000
CVTRSV51 EQU   CVTA1F1                                                  12909000
CVTRSV50 EQU   CVTA1F1                                                  12910000
CVTRSV49 EQU   CVTA1F1                                                  12911000
CVTRSV48 EQU   CVTA1F1                                                  12912000
CVTRSV47 EQU   CVTA1F1                                                  12913000
CVTSRSW  EQU   CVTA1F1                                                  12914000
CVTPFSW  EQU   CVTA1F1                                                  12915000
CVTPCVT  EQU   CVTMAP+352                                               12916000
CVTRSV46 EQU   CVTMAP+344                                               12917000
CVTRSV45 EQU   CVTMAP+340                                               12918000
CVTRSV44 EQU   CVTMAP+338                                               12919000
CVTRSV43 EQU   CVTMAP+336                                               12920000
CVTHJESA EQU   CVTHJES+1                                                12921000
CVTRSV42 EQU   CVTHJES                                                  12922000
CVTEXT2A EQU   CVTEXT2+1                                                12923000
CVTRSV41 EQU   CVTEXT2                                                  12924000
CVTAPFA  EQU   CVTAPF+1                                                 12925000
CVTRSV40 EQU   CVTAPF                                                   12926000
CVTRV518 EQU   CVTINTLA                                                 12927000
CVTRV517 EQU   CVTERPV                                                  12928000
CVTEORM  EQU   CVTMAP+312                                               12929000
CVTMCHPR EQU   CVTMAP+308                                               12930000
CVTTZ    EQU   CVTMAP+304                                               12931000
CVTJEPS  EQU   CVTMAP+300                                               12932000
CVTJESCT EQU   CVTMAP+296                                               12933000
CVTMODE  EQU   CVTMAP+292                                               12934000
CVTPTRV  EQU   CVTMAP+288                                               12935000
CVTREAL  EQU   CVTMAP+284                                               12936000
CVTRSV39 EQU   CVTMAP+280                                               12937000
CVTRSV38 EQU   CVTMAP+276                                               12938000
CVTDMSRA EQU   CVTDMSR+1                                                12939000
CVTRV634 EQU   CVTDMSRF                                                 12940000
CVTRV633 EQU   CVTDMSRF                                                 12941000
CVTRV632 EQU   CVTDMSRF                                                 12942000
CVTRV631 EQU   CVTDMSRF                                                 12943000
CVTRV630 EQU   CVTDMSRF                                                 12944000
CVTRV629 EQU   CVTDMSRF                                                 12945000
CVTUDUMP EQU   CVTDMSRF                                                 12946000
CVTSDUMP EQU   CVTDMSRF                                                 12947000
CVTQMSGA EQU   CVTQMSG+1                                                12948000
CVTRSV36 EQU   CVTQMSG                                                  12949000
CVTAMFF  EQU   CVTMAP+264                                               12950000
CVTPURGA EQU   CVTPURG+1                                                12951000
CVTRSV35 EQU   CVTPURG                                                  12952000
CVTCBSP  EQU   CVTMAP+256                                               12953000
CVTATERA EQU   CVTATER+1                                                12954000
CVTSYST  EQU   CVTATER                                                  12955000
CVTVOLT2 EQU   CVTTAT                                                   12956000
CVTVOLI2 EQU   CVTVOLF2                                                 12957000
CVTAQAVB EQU   CVTAQAVT+1                                               12958000
CVTRSV34 EQU   CVTTCMFG                                                 12959000
CVTRSV33 EQU   CVTTCMFG                                                 12960000
CVTRSV32 EQU   CVTTCMFG                                                 12961000
CVTRSV31 EQU   CVTTCMFG                                                 12962000
CVTRSV30 EQU   CVTTCMFG                                                 12963000
CVTRSV29 EQU   CVTTCMFG                                                 12964000
CVTLDEV  EQU   CVTTCMFG                                                 12965000
CVTTCRDY EQU   CVTTCMFG                                                 12966000
CVTGTFA  EQU   CVTGTF+1                                                 12967000
CVTRSV27 EQU   CVTGTFST                                                 12968000
CVTRNIO  EQU   CVTGTFST                                                 12969000
CVTUSR   EQU   CVTGTFST                                                 12970000
CVTRV318 EQU   CVTFORM                                                  12971000
CVTRV317 EQU   CVTTMODE                                                 12972000
CVTRV316 EQU   CVTSTATE                                                 12973000
CVTRV315 EQU   CVTGTFS                                                  12974000
CVTGTFAV EQU   CVTGTFS                                                  12975000
CVT0SCR1 EQU   CVTMAP+232                                               12976000
CVTRV515 EQU   CVTMAP+228                                               12977000
CVTPATCH EQU   CVTMAP+220                                               12978000
CVTTSCE  EQU   CVTMAP+216                                               12979000
CVTLNKSC EQU   CVTMAP+214                                               12980000
CVTQABST EQU   CVTMAP+212                                               12981000
CVTMDLDS EQU   CVTMAP+208                                               12982000
CVTUSER  EQU   CVTMAP+204                                               12983000
CVTABEND EQU   CVTMAP+200                                               12984000
CVTSMCA  EQU   CVTMAP+196                                               12985000
CVTRSV18 EQU   CVTMAP+192                                               12986000
CVTQLPAQ EQU   CVTMAP+188                                               12987000
CVTQCDSR EQU   CVTMAP+184                                               12988000
CVTRSV17 EQU   CVTOPTB                                                  12989000
CVTRSV16 EQU   CVTOPTB                                                  12990000
CVTFP    EQU   CVTOPTB                                                  12991000
CVTAPTHR EQU   CVTOPTB                                                  12992000
CVTNLOG  EQU   CVTOPTB                                                  12993000
CVTTOD   EQU   CVTOPTB                                                  12994000
CVTCTIMS EQU   CVTOPTB                                                  12995000
CVTPROT  EQU   CVTOPTB                                                  12996000
CVTXPFP  EQU   CVTOPTA                                                  12997000
CVTASCII EQU   CVTOPTA                                                  12998000
CVTRSV13 EQU   CVTOPTA                                                  12999000
CVTRSV12 EQU   CVTOPTA                                                  13000000
CVTNIP   EQU   CVTOPTA                                                  13001000
CVTDDR   EQU   CVTOPTA                                                  13002000
CVTAPR   EQU   CVTOPTA                                                  13003000
CVTCCH   EQU   CVTOPTA                                                  13004000
CVTSNCTR EQU   CVTMAP+180                                               13005000
CVTQMWR  EQU   CVTMAP+176                                               13006000
CVTQOCR  EQU   CVTMAP+172                                               13007000
CVT1EF00 EQU   CVTMAP+168                                               13008000
CVTMZ00  EQU   CVTMAP+164                                               13009000
CVTSV76Q EQU   CVTSV76C                                                 13010000
CVTRSV11 EQU   CVTMAP+156                                               13011000
CVT0PT01 EQU   CVTMAP+152                                               13012000
CVTMSER  EQU   CVTMAP+148                                               13013000
CVTRV516 EQU   CVTIERLC                                                 13014000
CVTILCH  EQU   CVTMAP+140                                               13015000
CVT0DS   EQU   CVTMAP+136                                               13016000
CVTFBOSV EQU   CVTMAP+132                                               13017000
CVTNUCB  EQU   CVTMAP+128                                               13018000
CVTSV76M EQU   CVTIOQET                                                 13019000
CVTDCBA  EQU   CVTMAP+117                                               13020000
CVTMVS2  EQU   CVTDCB                                                   13021000
CVT6DAT  EQU   CVTDCB                                                   13022000
CVT4MPS  EQU   CVTDCB                                                   13023000
CVTRSV09 EQU   CVTDCB                                                   13024000
CVT4MS1  EQU   CVTDCB                                                   13025000
CVT2SPS  EQU   CVTDCB                                                   13026000
CVT1SSS  EQU   CVTDCB                                                   13027000
CVTRSV08 EQU   CVTDCB                                                   13028000
CVTSTB   EQU   CVTMAP+112                                               13029000
CVTQTD00 EQU   CVTMAP+108                                               13030000
CVTQTE00 EQU   CVTMAP+104                                               13031000
CVTSJQ   EQU   CVTMAP+96                                                13032000
CVTPBLDL EQU   CVTMAP+92                                                13033000
CVTTPC   EQU   CVTMAP+88                                                13034000
CVTSVDCB EQU   CVTMAP+84                                                13035000
CVTEXIT  EQU   CVTMAP+80                                                13036000
CVT0FN00 EQU   CVTMAP+76                                                13037000
CVTDARA  EQU   CVTDAR+1                                                 13038000
CVTRSV07 EQU   CVTFLGS1                                                 13039000
CVTRSV06 EQU   CVTFLGS1                                                 13040000
CVTRSV05 EQU   CVTFLGS1                                                 13041000
CVTRSV04 EQU   CVTFLGS1                                                 13042000
CVTRSV03 EQU   CVTFLGS1                                                 13043000
CVTRSV02 EQU   CVTFLGS1                                                 13044000
CVTRSV01 EQU   CVTFLGS1                                                 13045000
CVTDMPLK EQU   CVTFLGS1                                                 13046000
CVTXITP  EQU   CVTMAP+68                                                13047000
CVTZDTAB EQU   CVTMAP+64                                                13048000
CVTMSLT  EQU   CVTMAP+60                                                13049000
CVTDATE  EQU   CVTMAP+56                                                13050000
CVTBTERM EQU   CVTMAP+52                                                13051000
CVTSYSAD EQU   CVTMAP+48                                                13052000
CVTXTLER EQU   CVTMAP+44                                                13053000
CVTILK1  EQU   CVTMAP+36                                                13054000
CVTPRLTV EQU   CVTMAP+32                                                13055000
CVTPCNVT EQU   CVTMAP+28                                                13056000
CVT0VL00 EQU   CVTMAP+24                                                13057000
CVTXAPG  EQU   CVTMAP+20                                                13058000
CVTBUF   EQU   CVTMAP+16                                                13059000
CVTJOB   EQU   CVTMAP+12                                                13060000
CVTLINK  EQU   CVTMAP+8                                                 13061000
CVT0EF00 EQU   CVTMAP+4                                                 13062000
CVTTCBP  EQU   CVTMAP                                                   13063000
@NM00009 EQU   QTPRMS                                                   13064000
@NM00007 EQU   WKUPARMS+92                                              13065000
@NM00006 EQU   WKUPARMS                                                 13066000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      13067000
@RT00126 EQU   MAINEXT                                                  13068000
@RF00137 EQU   @RC00135                                                 13069000
@RT00146 EQU   SYNTEXIT                                                 13070000
@RF00152 EQU   SYNTERR                                                  13071000
@RF00162 EQU   SYNTERR                                                  13072000
@RF00170 EQU   SYNTERR                                                  13073000
@RT00179 EQU   SYTXCHCK                                                 13074000
@RT00194 EQU   SYNTERR                                                  13075000
@RT00213 EQU   REJOFF                                                   13076000
@RT00217 EQU   REJOFF                                                   13077000
@RT00240 EQU   MAINEXIT                                                 13078000
@RT00247 EQU   MAINEXIT                                                 13079000
@RT00253 EQU   MAINEXIT                                                 13080000
@RT00318 EQU   AFFREPLY                                                 13081000
@RC00320 EQU   @RC00304                                                 13082000
@RT00383 EQU   ENDLOOP                                                  13083000
@RT00386 EQU   ENDLOOP                                                  13084000
@RT00388 EQU   ENDLOOP                                                  13085000
@RT00400 EQU   ENDLOOP                                                  13086000
@RF00404 EQU   ENDLOOP                                                  13087000
@RT00470 EQU   DEVPEXIT                                                 13088000
@RT00543 EQU   CONWTOR                                                  13089000
@RF00545 EQU   CNSLWAIT                                                 13090000
@RT00564 EQU   DSPTCHK                                                  13091000
@RT00613 EQU   CHANEXIT                                                 13092000
@RT00632 EQU   CHNLWTOR                                                 13093000
@RF00634 EQU   TIMELOOP                                                 13094000
@RT00698 EQU   DSPTMSG                                                  13095000
@RF00710 EQU   @RC00707                                                 13096000
OFFEXIT  EQU   @EL00002                                                 13097000
@RC00651 EQU   @EL00002                                                 13098000
@RF00787 EQU   @RC00759                                                 13099000
CHONEXIT EQU   @RC00757                                                 13100000
@RT00851 EQU   GETPSA                                                   13101000
@RT00885 EQU   PREPEXIT                                                 13102000
@RT00898 EQU   PREPEXIT                                                 13103000
@RT00915 EQU   PREPEXIT                                                 13104000
@RT00966 EQU   ONEXIT                                                   13105000
@RT01009 EQU   CKCOMPLT                                                 13106000
@RT01015 EQU   TRCKCONT                                                 13107000
@RT01026 EQU   TRCKEXIT                                                 13108000
@RT01051 EQU   ONEXIT                                                   13109000
@RF01059 EQU   @EL00003                                                 13110000
@RF01076 EQU   @EL00004                                                 13111000
@RT01089 EQU   PATHSKIP                                                 13112000
@RT01092 EQU   PATHSKIP                                                 13113000
@RT01094 EQU   PATHSKIP                                                 13114000
@RT01096 EQU   PATHSKIP                                                 13115000
@RT01119 EQU   DEVLOOP                                                  13116000
@RT01122 EQU   DEVLOOP                                                  13117000
@RT01124 EQU   DEVLOOP                                                  13118000
@RT01126 EQU   DEVLOOP                                                  13119000
@RT01128 EQU   DEVLOOP                                                  13120000
@RT01142 EQU   DEVLOOP                                                  13121000
@RF01153 EQU   @RC01149                                                 13122000
PSAFREXT EQU   @EL00008                                                 13123000
@RT01262 EQU   UCBRDEXT                                                 13124000
@RT01269 EQU   UCBRDEXT                                                 13125000
@RT01285 EQU   IOQLOOP                                                  13126000
@RT01290 EQU   IOQLOOP                                                  13127000
@RF01298 EQU   @RC01288                                                 13128000
@RT01305 EQU   IOQLOOP                                                  13129000
IOQEXIT  EQU   @EL00011                                                 13130000
@RT01433 EQU   CPUERROR                                                 13131000
PSAEXIT  EQU   @EL00012                                                 13132000
@RT01502 EQU   GETCOREX                                                 13133000
@RF01538 EQU   @EL00016                                                 13134000
@RC01559 EQU   @EL00016                                                 13135000
@RF01572 EQU   @EL00016                                                 13136000
@RF01581 EQU   @EL00017                                                 13137000
@RC01723 EQU   @RC01715                                                 13138000
@RC01709 EQU   @EL00020                                                 13139000
@RT00276 EQU   OFFEXIT                                                  13140000
@RT00286 EQU   OFFEXIT                                                  13141000
@RT00337 EQU   OFFEXIT                                                  13142000
@RT00481 EQU   OFFEXIT                                                  13143000
@RT00562 EQU   OFFEXIT                                                  13144000
@RT00649 EQU   OFFEXIT                                                  13145000
@RF00662 EQU   @RC00651                                                 13146000
CHNSON   EQU   @RC00651                                                 13147000
@RT01238 EQU   PSAFREXT                                                 13148000
@RT01329 EQU   PSAEXIT                                                  13149000
@RT01339 EQU   PSAEXIT                                                  13150000
@RT01422 EQU   PSAEXIT                                                  13151000
@RT01470 EQU   PSAEXIT                                                  13152000
@RC01753 EQU   @RC01709                                                 13153000
@RT00657 EQU   CHNSON                                                   13154000
@ENDDATA EQU   *                                                        13155000
         END   IEEVCPU,(C'PLS0959',0701,78196)                          13156000
