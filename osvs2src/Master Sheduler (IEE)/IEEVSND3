         TITLE 'IEEVSND3 - OPERATOR SEND COMMAND, LIST HANDLER         *00001000
                        '                                               00002000
IEEVSND3 CSECT ,                                                   0001 00003000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00004000
         BALR  @11,0                                               0001 00005000
@PSTART  DS    0H                                                  0001 00006000
         USING @PSTART,@11                                         0001 00007000
         L     @00,@SIZDATD                                        0001 00008000
         GETMAIN  R,LV=(0)                                              00009000
         LR    @12,@01                                             0001 00010000
         USING @DATD,@12                                           0001 00011000
         ST    @13,@SA00001+4                                      0001 00012000
         LM    @00,@01,20(@13)                                     0001 00013000
         ST    @12,8(,@13)                                         0001 00014000
         LR    @13,@12                                             0001 00015000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00016000
         MVC   @PC00001(4),0(@01)                                  0001 00017000
         MODID BRANCH=YES                                               00018000
REGS     DS    0H                                                  0034 00019000
*         COMPTR = R1;              /* SAVE ADDR COMMON DATA AREA    */ 00020000
         LR    COMPTR,R1                                           0040 00021000
*                                   /* MOVE LIST FORMS OF MACROS TO     00022000
*                                      AUTOMATIC STORAGE             */ 00023000
*         GEN  (MVC   AUTOLIST(LISTEND-LISTBEG),LISTBEG );         0041 00024000
         MVC   AUTOLIST(LISTEND-LISTBEG),LISTBEG                        00025000
*         R1PTR = PARMRCD1;         /* SET BASE FOR RECORD1    Y02676*/ 00026000
         L     @10,PARMRCD1(,COMPTR)                               0042 00027000
         ST    @10,@TF00001                                        0042 00028000
         MVC   R1PTR(3),@TF00001+1                                 0042 00029000
*         IF FLISTALL = '1'B        /* TEST IF HANDLING 'LIST', ALL  */ 00030000
*           THEN                    /* YES,                          */ 00031000
         TM    FLISTALL(COMPTR),B'01000000'                        0043 00032000
         BO    @RT00043                                            0043 00033000
*             GOTO RD1BKL;          /* GO AND  READ BRODCAST DIRECTORY* 00034000
*         MSGNO = CBCMSGNO;         /* SET NOTICES MSGNO SPEC'D ON 0045 00035000
*                                      SEND CMD FROM COMMON, WHERE IT   00036000
*                                      WAS SAVED BY IEEVSEND          * 00037000
         LH    @05,CBCMSGNO(,COMPTR)                               0045 00038000
         STH   @05,MSGNO                                           0045 00039000
*         IF MSGNO > R1BCMAX        /* MSG NUMBER SPEC'D       Y02676   00040000
*                                      EXCEEDS MAXIMUM BRODCAST NOTICES 00041000
*                                      MSG NO. SPECIFIED IN RECORD 1  * 00042000
*           THEN                    /* MSG NO. EXCEEDS MAXIMUM ALLOWED* 00043000
         CH    @05,R1BCMAX(,@10)                                   0046 00044000
         BH    @RT00046                                            0046 00045000
*             GOTO WMSG6;           /* GIVE WARNING MESSAGE           * 00046000
*         GEN(EJECT);                                              0048 00047000
         EJECT                                                          00048000
*RD1BKL:                            /* RECORD1 HAS BEEN READ          * 00049000
*         RNBCD = R1BCPTR;          /*SET RNAME FOR DIR RCD ENQY02676*/ 00050000
RD1BKL   L     @10,R1PTR-1                                         0049 00051000
         MVC   RNBCD(3),R1BCPTR(@10)                               0049 00052000
*ENQBCD:                            /* ENQUEUE ON BRODCAST DIRECTORY  * 00053000
*            GEN  (ENQ (QNAME,RNBCD,S,3,SYSTEM),RET=HAVE,MF=(E,ENQSL) ) 00054000
ENQBCD   ENQ (QNAME,RNBCD,S,3,SYSTEM),RET=HAVE,MF=(E,ENQSL)             00055000
*  /******************************************************************/ 00056000
*  /*                                                                */ 00057000
*  /*     READ A BROADCAST NOTICES DIRECTORY RECORD                  */ 00058000
*  /*                                                                */ 00059000
*  /******************************************************************/ 00060000
*READDIR:                           /* READ A DIRECTORY RECORD USING    00061000
*                                      RNAME AS RELATIVE BLOCK ADDR  */ 00062000
*         SDIOPARM = SDIOPARM && SDIOPARM;  /* CLEAR IO PARM AREA    */ 00063000
READDIR  XC    SDIOPARM(20,COMPTR),SDIOPARM(COMPTR)                0051 00064000
*         P1READ = '1'B;            /* SET PARM FLAG FOR READ        */ 00065000
         OI    P1READ(COMPTR),B'01000000'                          0052 00066000
*         PARMRBA = ADDR(RNBCD);    /* SET PARM RBA ADDRESS FOR READ */ 00067000
         LA    @10,RNBCD                                           0053 00068000
         ST    @10,PARMRBA(,COMPTR)                                0053 00069000
*         PARMIOAD = ADDR(DIRAREA); /* SET PARM AREA ADDRESS FOR READ * 00070000
         LA    @10,DIRAREA                                         0054 00071000
         ST    @10,PARMIOAD(,COMPTR)                               0054 00072000
*         R1 = ADDR(SDIOPARM);      /* SET SDIOPARM PTR        Y02676*/ 00073000
         LA    R1,SDIOPARM(,COMPTR)                                0055 00074000
*         CALL IEEVSND5;            /* CALL IO RTN */              0056 00075000
         L     @15,@CV00345                                        0056 00076000
         BALR  @14,@15                                             0056 00077000
*         RETC    = R15;            /* SAVE RETURN CODE FROM REG 15  */ 00078000
         STH   R15,RETC                                            0057 00079000
*         IF RETC > 0               /* TEST RETURN CODE FROM IO RTN   * 00080000
*           THEN                    /* IF UNSUCCESSFUL OPERATION      * 00081000
         LH    @10,RETC                                            0058 00082000
         LTR   @10,@10                                             0058 00083000
         BP    @RT00058                                            0058 00084000
*             GOTO BADIO;           /* GO TO PROCESS ERROR            * 00085000
*         BCDPTR = PARMIOAD;        /* SET BASE FOR NOTICE     Y02676   00086000
*                                      DIRECTORY RECORD STRUCTURE    */ 00087000
         MVC   BCDPTR(3),PARMIOAD+1(COMPTR)                        0060 00088000
* /*                                                                 */ 00089000
* /*      THIS CODE SCANS THE BROADCAST DIRECTORY RECORD FOR         */ 00090000
* /*      APPROPRIATE ENTRIES -- THE ENTRY REPRESENTING THE NOTICE   */ 00091000
* /*      MSGNO, IF SPECIFIED, OR ANY ACTIVE ENTRY.                  */ 00092000
* /*                                                                 */ 00093000
*         DO I = 1 TO DIM(BCDENTRY); /* SCAN DIR RCD ENTRIES   Y02676*/ 00094000
         LA    I,1                                                 0061 00095000
@DL00061 DS    0H                                                  0062 00096000
*         IF BCDMSGNO(I) = '0000'X  /* END OF DIRECTORY        Y02676*/ 00097000
*            THEN                   /* YES, NO MORE DIRECTRY ENTRIES  * 00098000
         L     @10,BCDPTR-1                                        0062 00099000
         LA    @10,0(,@10)                                         0062 00100000
         LR    @05,I                                               0062 00101000
         MH    @05,@CH00160                                        0062 00102000
         ST    @05,@TF00001                                        0062 00103000
         ALR   @05,@10                                             0062 00104000
         AL    @05,@CF00382                                        0062 00105000
         MVC   @ZT00002+2(2),BCDMSGNO(@05)                         0062 00106000
         L     @05,@ZT00002                                        0062 00107000
         LTR   @05,@05                                             0062 00108000
         BZ    @RT00062                                            0062 00109000
*              GOTO LMAX;           /* CHECK IF AN ERROR              * 00110000
*         IF BCDNOMSG(I) = '1'B     /* MSG NUMBER UNUSED             */ 00111000
*            THEN                   /* YES,NO MSG ASSIGNED TO THIS NO.* 00112000
         LR    @05,@10                                             0064 00113000
         AL    @05,@TF00001                                        0064 00114000
         AL    @05,@CF00382                                        0064 00115000
         TM    BCDNOMSG(@05),B'10000000'                           0064 00116000
         BO    @RT00064                                            0064 00117000
*              GOTO LSTMSGBK;       /* BYPASS TEST FOR MAXIMUM MSG NO.  00118000
*                                      BECAUSE HI ORDER BIT IS ON     * 00119000
*         IF FMN = '0'B             /* MSGNO SPECIFIED         Y02676*/ 00120000
*           THEN                    /* NO, LIST ALL            Y02676*/ 00121000
         TM    FMN(COMPTR),B'00010000'                             0066 00122000
         BZ    @RT00066                                            0066 00123000
*             GOTO LISTMSG;         /* LIST THIS NOTICE        Y02676*/ 00124000
*         IF BCDMSGNO(I) = MSGNO    /* THIS  IS REQUESTED ENTRYY02676*/ 00125000
*           THEN                    /* YES, NOTICE FOUND             */ 00126000
         LH    @05,MSGNO                                           0068 00127000
         AL    @10,@TF00001                                        0068 00128000
         AL    @10,@CF00382                                        0068 00129000
         MVC   @ZT00002+2(2),BCDMSGNO(@10)                         0068 00130000
         L     @10,@ZT00002                                        0068 00131000
         CR    @10,@05                                             0068 00132000
         BE    @RT00068                                            0068 00133000
*             GOTO LISTMSG;         /* LIST THIS NOTICE        Y02676*/ 00134000
*         IF BCDMSGNO(I) > MSGNO    /* SCANNED PAST MSGNO      Y02676*/ 00135000
*           THEN                    /* YES, NO NOTICE EXISTS   Y02676*/ 00136000
         CR    @10,@05                                             0070 00137000
         BH    @RT00070                                            0070 00138000
*             GOTO WMSG6;           /* TAKE ERROR EXIT         Y02676*/ 00139000
* LSTMSGBK:               /* A MSG HAS BEEN PROCESSED, LISTED        */ 00140000
*         END;                                                     0072 00141000
LSTMSGBK AH    I,@CH00047                                          0072 00142000
         CH    I,@CH00159                                          0072 00143000
         BNH   @DL00061                                            0072 00144000
*LRECEND: /* END OF DIRECTORY RECORD                                 */ 00145000
*         IF BCDNEXT = 0            /* ALL DIR RCDS HANDLED    Y02676*/ 00146000
*            THEN GOTO LMAX;        /*   YES, EXIT THIS SCAN ROUTINE */ 00147000
LRECEND  L     @10,BCDPTR-1                                        0073 00148000
         MVC   @ZT00001+1(3),BCDNEXT(@10)                          0073 00149000
         L     @10,@ZT00001                                        0073 00150000
         LTR   @10,@10                                             0073 00151000
         BZ    @RT00073                                            0073 00152000
*            ELSE;                                                 0075 00153000
*                                   /* DEQ ON PREVIOUS RECORD        */ 00154000
*         GEN  (DEQ   (QNAME,RNBCD,3,SYSTEM),RET=HAVE,MF=(E,DEQL));     00155000
         DEQ   (QNAME,RNBCD,3,SYSTEM),RET=HAVE,MF=(E,DEQL)              00156000
*         RNBCD = BCDNEXT;          /*SET RNAME FOR DIR RCD ENQY02676*/ 00157000
         L     @10,BCDPTR-1                                        0077 00158000
         MVC   RNBCD(3),BCDNEXT(@10)                               0077 00159000
*         GOTO  ENQBCD;             /* GOTO SCAN NEXT BC DIRECTRY REC*/ 00160000
*                                                                  0078 00161000
         B     ENQBCD                                              0078 00162000
*LMAX:    IF FYESBCM = '1'B         /* ANY NOTICES             Y02676*/ 00163000
*           THEN                    /* YES                           */ 00164000
LMAX     TM    FYESBCM(COMPTR),B'01000000'                         0079 00165000
         BO    @RT00079                                            0079 00166000
*             GOTO EXITCODE;        /* GO  CLEAN UP AND END PROCESSNG*/ 00167000
*           ELSE                    /* NO MESSAGES PUT OUT           */ 00168000
*             GOTO WMSG6;           /* ISSUE WARNING MESSAGE -     0081 00169000
*                                      'NO BROADCAST MESSAGES'       */ 00170000
         B     WMSG6                                               0081 00171000
* /*******************************************************************/ 00172000
* /*CALL IO RTN TO READ BRODCAST NOTICE MESSAGE RECORD FOR THIS MSGNO*/ 00173000
* /*******************************************************************/ 00174000
*LISTMSG:                                                          0082 00175000
*         FYESBCM = '1'B;           /* SET FLAG TO SAY THERE WAS A 0082 00176000
*                                      BRODCAST MSG IN DATA SET      */ 00177000
LISTMSG  OI    FYESBCM(COMPTR),B'01000000'                         0082 00178000
*         SDIOPARM = SDIOPARM && SDIOPARM;  /* CLEAR IO PARM AREA    */ 00179000
         XC    SDIOPARM(20,COMPTR),SDIOPARM(COMPTR)                0083 00180000
*         P1READ = '1'B;            /* SET PARM FLAG FOR READ        */ 00181000
         OI    P1READ(COMPTR),B'01000000'                          0084 00182000
*         PARMIOAD = ADDR(MSGAREA); /* SET PARM AREA ADDRESS FOR READ*/ 00183000
         LA    @10,MSGAREA                                         0085 00184000
         ST    @10,PARMIOAD(,COMPTR)                               0085 00185000
*         PARMRBA = ADDR(BCDMRBA(I)); /* SET PARM RBA ADDRESS  Y02676*/ 00186000
         LR    @10,I                                               0086 00187000
         MH    @10,@CH00160                                        0086 00188000
         L     @05,BCDPTR-1                                        0086 00189000
         LA    @05,0(,@05)                                         0086 00190000
         AL    @05,@CF00383                                        0086 00191000
         LA    @10,BCDMRBA-2(@10,@05)                              0086 00192000
         ST    @10,PARMRBA(,COMPTR)                                0086 00193000
*         R1 = ADDR(SDIOPARM);      /* SET SDIOPARM PTR        Y02676*/ 00194000
         LA    R1,SDIOPARM(,COMPTR)                                0087 00195000
*         CALL IEEVSND5;            /* CALL IO RTN                   */ 00196000
         L     @15,@CV00345                                        0088 00197000
         BALR  @14,@15                                             0088 00198000
*         RETC    = R15;            /* SAVE RETURN CODE FROM REG 15  */ 00199000
         STH   R15,RETC                                            0089 00200000
*         IF RETC > 0               /* TEST RETURN CODE FROM IO RTN  */ 00201000
*           THEN                    /* IF UNSUCCESSFUL OPERATION     */ 00202000
         LH    @10,RETC                                            0090 00203000
         LTR   @10,@10                                             0090 00204000
         BP    @RT00090                                            0090 00205000
*             GOTO BADIO;           /* GO TO PROCESS ERROR           */ 00206000
* /*******************************************************************/ 00207000
* /*      THIS CODE RECOVERS THE NOTICE TEXT FOR OTHER HANDLERS      */ 00208000
* /*      OR FORMATS THE TEXT FOR SENDER DISPLAY.                    */ 00209000
* /*******************************************************************/ 00210000
*         BCMPTR = PARMIOAD;        /* SET BASE FOR NOTICE RCD Y02676*/ 00211000
         L     @10,PARMIOAD(,COMPTR)                               0092 00212000
         ST    @10,@TF00001                                        0092 00213000
         MVC   BCMPTR(3),@TF00001+1                                0092 00214000
*         GMTEXT(1) = '40'X;        /* INSERT BLANK BEFORE MSG TEXT  */ 00215000
         MVI   GMTEXT,X'40'                                        0093 00216000
*         GMTEXT(2:BCMLNG+1) = BCMTEXT; /* SET TEXT OF MESSAGE       */ 00217000
         SLR   @05,@05                                             0094 00218000
         IC    @05,BCMLNG(,@10)                                    0094 00219000
         LR    @02,@05                                             0094 00220000
         BCTR  @02,0                                               0094 00221000
         EX    @02,@SM00384                                        0094 00222000
*         IF FLIST = '0'B           /* NO LISTING REQUESTED    Y02676*/ 00223000
*           THEN                    /* NO, RECOVER ONLY        Y02676*/ 00224000
         TM    FLIST(COMPTR),B'00100000'                           0095 00225000
         BNZ   @RF00095                                            0095 00226000
*             DO;                                                  0096 00227000
*               COMBUF(1:BCMLNG) = GMTEXT(2:BCMLNG+1);             0097 00228000
         EX    @02,@SM00386                                        0097 00229000
*                                   /* SAVE RECOVERED NOTICE   Y02676*/ 00230000
*               TBEG = 1;           /* OFFSET TO TEXT IN COMBUFY02676*/ 00231000
         MVI   TBEG(COMPTR),X'01'                                  0098 00232000
*               TEXTLENG = BCMLNG;  /* SET MESSAGE LENGTH      Y02676*/ 00233000
         STC   @05,TEXTLENG(,COMPTR)                               0099 00234000
*               FTEXT = '1'B;       /* INDICATE TEXT READY     Y02676*/ 00235000
         OI    FTEXT(COMPTR),B'00000010'                           0100 00236000
*               GOTO EXITCODE;      /* HANDLING DONE           Y02676*/ 00237000
         B     EXITCODE                                            0101 00238000
*             END;                                                 0102 00239000
*         WORK4 = 0;                /* CLEAR WORK AREA               */ 00240000
@RF00095 SLR   @10,@10                                             0103 00241000
         ST    @10,WORK4                                           0103 00242000
*         WORK8 = WORK8 && WORK8;   /* CLEAR WORK AREA               */ 00243000
         XC    WORK8(8),WORK8                                      0104 00244000
*         WORK4(3:4) = BCDMSGNO(I); /* COPY MSG NUMBER         Y02676   00245000
*                                      FROM NOTICES DIRECTORY        */ 00246000
         LR    @10,I                                               0105 00247000
         MH    @10,@CH00160                                        0105 00248000
         L     @05,BCDPTR-1                                        0105 00249000
         ALR   @05,@10                                             0105 00250000
         AL    @05,@CF00382                                        0105 00251000
         MVC   WORK4+2(2),BCDMSGNO(@05)                            0105 00252000
*         RESTRICT (R5);            /* RESTRICT REG 5 FOR 'GEN' USE  */ 00253000
*         R5 = WORK4;               /* SET REGISTER FOR CVD          */ 00254000
         L     R5,WORK4                                            0107 00255000
*         GEN;                                                     0108 00256000
          CVD   R5,WORK8            CONVERT BC MSG NO. TO DECIMAL       00257000
          UNPK  WORK4(4),WORK8+5(3) UNPACK INTO EBCDIC FORM             00258000
         MVZ   WORK4+3(1),WORK4+2   MAKE SIGN PRINTABLE                 00259000
*         RELEASE (R5);             /* RELEASE REG 5 FOR COMPILER USE*/ 00260000
*         MSGNOTXT = 'MSGNO ';      /* SET'MSGNO' IDENTIFIER         */ 00261000
         MVI   MSGNOTXT+6,C' '                                     0110 00262000
         MVC   MSGNOTXT+7(2),MSGNOTXT+6                            0110 00263000
         MVC   MSGNOTXT(6),@CC00360                                0110 00264000
*         MSGNODEC = WORK4(2:4);    /* SET MSG NO. FROM WORK AREA    */ 00265000
         MVC   MSGNODEC(3),WORK4+1                                 0111 00266000
*         GMNUM = MSGNOTXT;         /* SET BC MSG NO. FOR OUTPUT LIST*/ 00267000
         MVC   GMNUM(9),MSGNOTXT                                   0112 00268000
*         GENLNG = BCMLNG+10;       /* SET LENGTH OF MSG TEXT PLUS 0113 00269000
*                                      MSG NO.                       */ 00270000
         L     @10,BCMPTR-1                                        0113 00271000
         SLR   @05,@05                                             0113 00272000
         IC    @05,BCMLNG(,@10)                                    0113 00273000
         LA    @05,10(,@05)                                        0113 00274000
         STH   @05,GENLNG                                          0113 00275000
*         FLISTING = '1'B;          /* SET ROUTING FLAG              */ 00276000
         OI    FLISTING(COMPTR),B'00000001'                        0114 00277000
*         GOTO WARNMSG;             /* GO TO LIST THIS BC MESSAGE    */ 00278000
         B     WARNMSG                                             0115 00279000
*LIST3:                             /* MSG HAS BEEN LISTED OUT       */ 00280000
*         FLISTING = '0'B;          /* TURN OFF ROUTING FLAG         */ 00281000
LIST3    NI    FLISTING(COMPTR),B'11111110'                        0116 00282000
*         IF FMN = '1'B             /* IF MESSAGE NO. FORMAT         */ 00283000
*           THEN                    /* YES, MSG NO. FORMAT OF SEND   */ 00284000
         TM    FMN(COMPTR),B'00010000'                             0117 00285000
         BO    @RT00117                                            0117 00286000
*             GOTO EXITCODE;        /* LEAVE ROUTINE           Y02676*/ 00287000
*         GOTO  LSTMSGBK;           /* GO BACK TO SCAN RTNE TO SCAN  */ 00288000
         B     LSTMSGBK                                            0119 00289000
*WMSG6:   FMSG6 = '1'B;             /* SET INDICATOR FOR WARNING MSG-   00290000
*                                      'NO BROADCAST MSG'            */ 00291000
WMSG6    OI    FMSG6(COMPTR),B'00001000'                           0120 00292000
*         GOTO EXITCODE;            /* ISSUE WARNING MSG       Y02676*/ 00293000
*                                                                  0121 00294000
         B     EXITCODE                                            0121 00295000
*BADIO:   /* I/O ERROR IN IEEVSDIO PROCESSING                        */ 00296000
*         FBADIO = '1'B;            /* SET FLAG FOR WARNING MSG      */ 00297000
BADIO    OI    FBADIO(COMPTR),B'00000100'                          0122 00298000
*         SDIORC = RETC;            /* SAVE SDIO RETURN CODE IN COMMON  00299000
*                                      DATA AREA FOR USE BY IEEVSND4 */ 00300000
         MVC   SDIORC(1,COMPTR),RETC+1                             0123 00301000
*         GOTO EXITCODE;            /* ISSUE WARNING MSG       Y02676*/ 00302000
*                                                                  0124 00303000
         B     EXITCODE                                            0124 00304000
*BADTPUT:                 /* UNSUCCESSFUL TPUT RETURN CODE           */ 00305000
*         IF RETC = 8 |             /* SENDER HIT ATTN         Y02676*/ 00306000
*            RETC = 12              /* NO INTERCOM MODE        Y02676*/ 00307000
*           THEN                    /* NOT HARD ERROR          Y02676*/ 00308000
BADTPUT  LH    @10,RETC                                            0125 00309000
         CH    @10,@CH00042                                        0125 00310000
         BE    @RT00125                                            0125 00311000
         CH    @10,@CH00033                                        0125 00312000
         BE    @RT00125                                            0125 00313000
*             GOTO EXITCODE;        /* TERMINATE PROCESSING    Y02676*/ 00314000
*         FBADTPUT = '1'B;          /* SET ERROR INDICATOR IN COMMON */ 00315000
         OI    FBADTPUT(COMPTR),B'00000001'                        0127 00316000
*         GOTO EXITCODE;            /* ISSUE WARNING MSG       Y02676*/ 00317000
         B     EXITCODE                                            0128 00318000
* /*******************************************************************/ 00319000
* /*      ISSUE MESSAGE TO SENDER -- W T O  / T P U T                */ 00320000
* /*******************************************************************/ 00321000
* WARNMSG:/* GIVE WARNING MSG TO ISSUER OF 'SEND'                    */ 00322000
*         IF FSOURCE = '00'B        /* HAS SOURCE OF SEND COMMAND BEEN  00323000
*                                      DETERMINED?                   */ 00324000
*           THEN                    /* NO, CHECK THE CSCB            */ 00325000
WARNMSG  TM    FSOURCE(COMPTR),B'11000000'                         0129 00326000
         BNZ   @RF00129                                            0129 00327000
*             IF CHASID = 0         /* SEND COMMAND CAME       Y02676   00328000
*                                      FROM OPERATORS CONSOLE OR   0130 00329000
*                                      A TERMINAL IN OPERATOR MODE   */ 00330000
*               THEN                /* SEND COMMAND CAME FROM OPERATOR  00331000
*                                      CONSOLE                       */ 00332000
         L     @10,CSCBPTR-1(,COMPTR)                              0130 00333000
         LH    @10,CHASID(,@10)                                    0130 00334000
         LTR   @10,@10                                             0130 00335000
         BNZ   @RF00130                                            0130 00336000
*                 FCONSOL = '1'B;   /* SET INDICATOR FOR CONSOLE     */ 00337000
         OI    FCONSOL(COMPTR),B'01000000'                         0131 00338000
*               ELSE                /* SEND COMMAND CAME FROM TERMINAL  00339000
*                                      IN OPERATOR MODE              */ 00340000
*                 FTERM = '1'B;     /* SET INDICATOR FOR TERMINAL    */ 00341000
         B     @RC00130                                            0132 00342000
@RF00130 OI    FTERM(COMPTR),B'10000000'                           0132 00343000
* SRCBK:  /* SOURCE OF SEND CMD HAS BEEN FOUND                       */ 00344000
*         IF FCONSOL = '1'B         /* CHECK IF SENDER WAS OP.CONSOLE*/ 00345000
*           THEN                    /* CMD CAME FROM OPERATOR CONSOLE*/ 00346000
@RC00130 DS    0H                                                  0133 00347000
@RF00129 DS    0H                                                  0133 00348000
SRCBK    TM    FCONSOL(COMPTR),B'01000000'                         0133 00349000
         BNO   @RF00133                                            0133 00350000
*             DO;                   /* SET UP FOR WTO                */ 00351000
*             MSGAREA = GENTEXT;    /* SAVE MSG TEXT AND MSG ID      */ 00352000
         MVI   MSGAREA+124,C' '                                    0135 00353000
         MVC   MSGAREA+125(4),MSGAREA+124                          0135 00354000
         MVC   MSGAREA(124),GENTEXT                                0135 00355000
*             IF GENLNG > WTOMAX    /* IF WARN MSG LENGTH > 72       */ 00356000
*               THEN                /* YES, MSG LENGTH > 72          */ 00357000
         SLR   @10,@10                                             0136 00358000
         IC    @10,WTOMAX                                          0136 00359000
         CH    @10,GENLNG                                          0136 00360000
         BNL   @RF00136                                            0136 00361000
*                 WTOLNG = WTOMAX+4;/* SET WTO PARMLIST LENG TO MAX  */ 00362000
         LA    @10,4(,@10)                                         0137 00363000
         STH   @10,WTOLNG                                          0137 00364000
*               ELSE                                               0138 00365000
*                 WTOLNG = GENLNG+4;/* SET LENGTH OF WTO PARM LIST   */ 00366000
         B     @RC00136                                            0138 00367000
@RF00136 LH    @10,GENLNG                                          0138 00368000
         LA    @10,4(,@10)                                         0138 00369000
         STH   @10,WTOLNG                                          0138 00370000
*             GENTEXT(1:WTOLNG-4)=MSGAREA(1:WTOLNG-4); /* PUT TEXT   */ 00371000
@RC00136 LH    @10,WTOLNG                                          0139 00372000
         LR    @05,@10                                             0139 00373000
         SH    @05,@CH00160                                        0139 00374000
         EX    @05,@SM00394                                        0139 00375000
*                                          /* SET DESCRIPTOR CODE    */ 00376000
*             WTOLIST(WTOLNG+1:WTOLNG+5) = WTODESC(1:4);           0140 00377000
         LA    @05,WTOLIST(@10)                                    0140 00378000
         MVI   4(@05),C' '                                         0140 00379000
         MVC   0(4,@05),WTODESC                                    0140 00380000
*             WTOMCSFL = '11'B;    /* TURN ON HIGH ORDER BIT OF MCS     00381000
*                                      FLAG FIELD TO SAY REG 0     0141 00382000
*                                      CONTAINS CONSOLE ID           */ 00383000
         OI    WTOMCSFL,B'11000000'                                0141 00384000
*             WTOMCSF2 = '1'B;     /* SET MCS CMD RESP FLAG  @ZA13845*/ 00385000
         OI    WTOMCSF2,B'00100000'                                0142 00386000
*             R1 = ADDR(WTOLIST);  /* SET REG1 = ADDR WTO PARMLIST   */ 00387000
         LA    R1,WTOLIST                                          0143 00388000
*             R0 = CHUCMP;         /* PUT CONSOLE ID INTO REG 0 FOR     00389000
*                                     WTO TO CONSOLE ISSUING 'SEND'  */ 00390000
         L     @10,CSCBPTR-1(,COMPTR)                              0144 00391000
         SLR   R0,R0                                               0144 00392000
         IC    R0,CHUCMP(,@10)                                     0144 00393000
*             GEN  (WTO   ,MF=(E,(1))    ISSUE WTO TO SENDER    ); 0145 00394000
         WTO   ,MF=(E,(1))    ISSUE WTO TO SENDER                       00395000
*             GMBEG = WTOMAX+1;    /* SET BEGINNING FOR NEXT WTO     */ 00396000
         LA    @10,1                                               0146 00397000
         SLR   @05,@05                                             0146 00398000
         IC    @05,WTOMAX                                          0146 00399000
         ALR   @05,@10                                             0146 00400000
         STC   @05,GMBEG                                           0146 00401000
*             WTOCNT=(GENLNG-9)/WTOMAX2;/* CNT OF WTO'S NEEDED       */ 00402000
         SLR   @05,@05                                             0147 00403000
         IC    @05,WTOMAX2                                         0147 00404000
         LH    @02,GENLNG                                          0147 00405000
         SH    @02,@CH00183                                        0147 00406000
         LR    @00,@02                                             0147 00407000
         SRDA  @00,32                                              0147 00408000
         DR    @00,@05                                             0147 00409000
         STC   @01,WTOCNT                                          0147 00410000
*             WTOREM=(GENLNG-9)//WTOMAX2;/* WTOREM = REMAINDER       */ 00411000
         LR    @06,@02                                             0148 00412000
         SRDA  @06,32                                              0148 00413000
         DR    @06,@05                                             0148 00414000
         STC   @06,WTOREM                                          0148 00415000
*             IF WTOREM ^= 0       /* TEST IF REMAINDER IS NONZERO   */ 00416000
*               THEN               /* YES, THERE IS A REMAINDER      */ 00417000
         CLI   WTOREM,0                                            0149 00418000
         BE    @RF00149                                            0149 00419000
*                  WTOCNT=WTOCNT+1;/* ADD 1 TO CNT OF WTO'S NEEDED   */ 00420000
         ALR   @01,@10                                             0150 00421000
         STC   @01,WTOCNT                                          0150 00422000
*WTOLOOP2:                         /* ISSUE ANOTHER WTO              */ 00423000
*             WTOCNT = WTOCNT-1;   /* DECREMENT CNT OF WTO'S NEEDED  */ 00424000
@RF00149 DS    0H                                                  0151 00425000
WTOLOOP2 SLR   @10,@10                                             0151 00426000
         IC    @10,WTOCNT                                          0151 00427000
         BCTR  @10,0                                               0151 00428000
         STC   @10,WTOCNT                                          0151 00429000
*             IF WTOCNT = 0        /* HAVE ALL WTO'S BEEN ISSUED     */ 00430000
*               THEN               /* YES, ENTIRE MSG IS PUT OUT     */ 00431000
         CLI   WTOCNT,0                                            0152 00432000
         BE    @RT00152                                            0152 00433000
*                 GOTO ROUTER;     /* GOTO ROUTE  CONTROL            */ 00434000
*               ELSE;              /* ISSUE ANOTHER WTO              */ 00435000
*             GMNUM = ' ';         /* BLANK OUT FIRST 10 CHAR        */ 00436000
         MVI   GMNUM+1,C' '                                        0155 00437000
         MVC   GMNUM+2(7),GMNUM+1                                  0155 00438000
         MVI   GMNUM,C' '                                          0155 00439000
*             IF GENLNG > GMBEG+WTOMAX2/* IS MSG LNGTH MORE THAN CAN    00440000
*                                     BE PUT OUT IN 1 MORE WTO       */ 00441000
*               THEN               /* YES, 2 MORE WTO'S NEEDED       */ 00442000
         SLR   @10,@10                                             0156 00443000
         IC    @10,WTOMAX2                                         0156 00444000
         SLR   @05,@05                                             0156 00445000
         IC    @05,GMBEG                                           0156 00446000
         ALR   @05,@10                                             0156 00447000
         CH    @05,GENLNG                                          0156 00448000
         BNL   @RF00156                                            0156 00449000
*                 GMEND = WTOMAX2; /* SET END OF WTO MSG TO MAX      */ 00450000
         STC   @10,GMEND                                           0157 00451000
*               ELSE               /* NO, 1 MORE WTO WILL DO IT      */ 00452000
*                 GMEND=GENLNG-GMBEG+1;/*SET END OF MSG TO REMAINDER */ 00453000
         B     @RC00156                                            0158 00454000
@RF00156 LH    @10,GENLNG                                          0158 00455000
         MVC   @ZT00003+3(1),GMBEG                                 0158 00456000
         SL    @10,@ZT00003                                        0158 00457000
         LA    @10,1(,@10)                                         0158 00458000
         STC   @10,GMEND                                           0158 00459000
*                                  /* PUT MSG INTO WTO PARMLIST      */ 00460000
*             GMTEXT(1:GMEND) = MSGAREA(GMBEG:GMBEG + GMEND - 1 ); 0159 00461000
@RC00156 SLR   @10,@10                                             0159 00462000
         IC    @10,GMEND                                           0159 00463000
         LR    @05,@10                                             0159 00464000
         BCTR  @05,0                                               0159 00465000
         SLR   @02,@02                                             0159 00466000
         IC    @02,GMBEG                                           0159 00467000
         LA    @01,MSGAREA-1(@02)                                  0159 00468000
         EX    @05,@SM00398                                        0159 00469000
*             WTOLNG = GMEND+4+9;  /* SET WTO PARMLIST LENGTH        */ 00470000
         AH    @10,@CH00380                                        0160 00471000
         STH   @10,WTOLNG                                          0160 00472000
*             WTOLIST(WTOLNG+1:WTOLNG+5) = WTODESC(1:4);           0161 00473000
         LA    @05,WTOLIST(@10)                                    0161 00474000
         MVI   4(@05),C' '                                         0161 00475000
         MVC   0(4,@05),WTODESC                                    0161 00476000
*                 WTOMCSFL = '11'B; /* TURN ON 2 HIGH ORDER BITS OF MCS 00477000
*                                      FLAG FIELD TO SAY REG 0     0162 00478000
*                                      CONTAINS CONSOLE ID           */ 00479000
         OI    WTOMCSFL,B'11000000'                                0162 00480000
*                 WTOMCSF2 = '1'B;    /* SET MCS CMD RESP FLG@ZA13845*/ 00481000
         OI    WTOMCSF2,B'00100000'                                0163 00482000
*                 R1 = ADDR(WTOLIST); /* SET REG1 = ADDR WTO PARMLIST*/ 00483000
         LA    R1,WTOLIST                                          0164 00484000
*                 R0 = CHUCMP;      /* PUT CONSOLE ID INTO REG 0 FOR    00485000
*                                      WTO TO CONSOLE ISSUING 'SEND' */ 00486000
         L     @10,CSCBPTR-1(,COMPTR)                              0165 00487000
         SLR   R0,R0                                               0165 00488000
         IC    R0,CHUCMP(,@10)                                     0165 00489000
*                 GEN;                                             0166 00490000
                  WTO   ,MF=(E,(1))          ISSUE WTO TO SENDER        00491000
*        GMBEG = GMBEG + GMEND    ;  /* BUMP GMBEG FOR NEXT WTO      */ 00492000
         SLR   @10,@10                                             0167 00493000
         IC    @10,GMBEG                                           0167 00494000
         MVC   @ZT00003+3(1),GMEND                                 0167 00495000
         AL    @10,@ZT00003                                        0167 00496000
         STC   @10,GMBEG                                           0167 00497000
*        GOTO WTOLOOP2;            /* CHECK IF ANOTHER WTO NEEDED    */ 00498000
         B     WTOLOOP2                                            0168 00499000
*             END;                                                 0169 00500000
*           ELSE                    /* SOURCE OF SEND IS A TERMINAL  */ 00501000
*             DO;                   /* SET UP FOR TPUT               */ 00502000
@RF00133 DS    0H                                                  0171 00503000
*                RECTJID = CHASID;  /* SET ASID INTO HI        Y02676   00504000
*                                      ORDER HALF OF REG 0 FOR TPUT  */ 00505000
         L     @10,CSCBPTR-1(,COMPTR)                              0171 00506000
         MVC   RECTJID(2),CHASID(@10)                              0171 00507000
*               R1 = ADDR(GENTEXT); /* REG1 = MSGTEXT ADDR FOR TPUT  */ 00508000
         LA    R1,GENTEXT                                          0172 00509000
*               R0 = TPUTREG0;      /* REG0 = TJID - HI ORDER AND  0173 00510000
*                                             BUFFER SIZE - LO ORDER */ 00511000
         L     R0,TPUTREG0                                         0173 00512000
*               GEN;                                               0174 00513000
                TPUT  (1),(0),R     ISSUE TPUT TO OPERATOR TERMINAL     00514000
*             RETC = R15;           /* SAVE RETURN CODE FROM TPUT    */ 00515000
         STH   R15,RETC                                            0175 00516000
*             IF RETC ^= 0          /* CHECK RETURN CODE FROM TPUT   */ 00517000
*               THEN                /* IF UNSUCCESSFUL TPUT          */ 00518000
         LH    @10,RETC                                            0176 00519000
         LTR   @10,@10                                             0176 00520000
         BNZ   @RT00176                                            0176 00521000
*                 GOTO BADTPUT;     /* ANALYZE ERROR CONDITION       */ 00522000
*             END;                                                 0178 00523000
*ROUTER:                            /* ROUTE CONTROL TO PROPER RTN   */ 00524000
*         GOTO LIST3;               /* GO TO CONTINUE LISTING MSGS   */ 00525000
         B     LIST3                                               0179 00526000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00527000
* /*                                                                 */ 00528000
* /*         E     X     I     T     C     O     D     E             */ 00529000
* /*                                                                 */ 00530000
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00531000
* EXITCODE:               /* CLEANUP AND END PROCESSING              */ 00532000
*         GEN  (DEQ   (QNAME,RNBCD,3,SYSTEM),RET=HAVE,MF=(E,DEQL) );    00533000
EXITCODE DEQ   (QNAME,RNBCD,3,SYSTEM),RET=HAVE,MF=(E,DEQL)              00534000
*         RETURN;                   /* RETURN TO CALLER              */ 00535000
*                                                                  0181 00536000
*                                                                  0181 00537000
@EL00001 L     @13,4(,@13)                                         0181 00538000
@EF00001 L     @00,@SIZDATD                                        0181 00539000
         LR    @01,@12                                             0181 00540000
         FREEMAIN R,LV=(0),A=(1)                                        00541000
@ER00001 LM    @14,@12,12(@13)                                     0181 00542000
         BR    @14                                                 0181 00543000
*         GEN;                                                     0182 00544000
LISTBEG  ENQ   (QNAME,,S,3,SYSTEM),RET=HAVE,MF=L                        00545000
         DEQ   (QNAME,,3,SYSTEM),RET=HAVE,MF=L                          00546000
LISTEND  EQU   *                       END OF LIST FORMS                00547000
SPARE    DC    50X'00'              PATCH AREA                          00548000
*         END IEEVSND3                                             0183 00549000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00550000
*/*%INCLUDE SYSLIB  (IKJZT301)                                        * 00551000
*/*%INCLUDE SYSLIB  (IKJZT302)                                        * 00552000
*/*%INCLUDE SYSLIB  (IKJZT303)                                        * 00553000
*/*%INCLUDE SYSLIB  (IEECHAIN)                                        * 00554000
*;                                                                 0183 00555000
         B     @EL00001                                            0183 00556000
@DATA    DS    0H                                                       00557000
@CH00047 DC    H'1'                                                     00558000
@CH00160 DC    H'5'                                                     00559000
@CH00042 DC    H'8'                                                     00560000
@CH00183 DC    H'9'                                                     00561000
@CH00033 DC    H'12'                                                    00562000
@CH00380 DC    H'13'                                                    00563000
@CH00159 DC    H'25'                                                    00564000
@SM00384 MVC   GMTEXT+1(0),BCMTEXT(@10)                                 00565000
@SM00386 MVC   COMBUF(0,COMPTR),GMTEXT+1                                00566000
@SM00394 MVC   GENTEXT(0),MSGAREA                                       00567000
@SM00398 MVC   GMTEXT(0),0(@01)                                         00568000
@DATD    DSECT                                                          00569000
         DS    0F                                                       00570000
@SA00001 DS    18F                                                      00571000
@PC00001 DS    1F                                                       00572000
@SAV001  EQU   @SA00001                                                 00573000
@TF00001 DS    F                                                        00574000
@ZTEMPS  DS    0F                                                       00575000
@ZT00001 DC    F'0'                                                     00576000
@ZT00002 DC    F'0'                                                     00577000
@ZT00003 DC    F'0'                                                     00578000
@ZTEMPND EQU   *                                                        00579000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00580000
@TEMPS   EQU   @ZTEMPS                                                  00581000
@L       EQU   @ZLEN                                                    00582000
IEEVSND3 CSECT                                                          00583000
         DS    0F                                                       00584000
@CF00382 DC    F'-5'                                                    00585000
@CF00383 DC    F'-3'                                                    00586000
@DATD    DSECT                                                          00587000
         DS    0D                                                       00588000
TPUTREG0 DS    FL4                                                      00589000
         ORG   TPUTREG0                                                 00590000
RECTJID  DS    FL2                                                      00591000
GENLNG   DS    FL2                                                      00592000
         ORG   TPUTREG0+4                                               00593000
RETC     DS    H                                                        00594000
MSGNO    DS    H                                                        00595000
         DS    CL1                                                      00596000
R1PTR    DS    AL3                                                      00597000
         DS    CL1                                                      00598000
BCDPTR   DS    AL3                                                      00599000
         DS    CL1                                                      00600000
BCMPTR   DS    AL3                                                      00601000
WTOCNT   DS    AL1                                                      00602000
WTOREM   DS    AL1                                                      00603000
GMBEG    DS    AL1                                                      00604000
GMEND    DS    AL1                                                      00605000
DIRAREA  DS    CL129                                                    00606000
         DS    CL3                                                      00607000
MSGAREA  DS    CL129                                                    00608000
         DS    CL3                                                      00609000
WTOLIST  DS    CL128                                                    00610000
         ORG   WTOLIST                                                  00611000
WTOLNG   DS    FL2                                                      00612000
WTOMCS   DS    FL2                                                      00613000
         ORG   WTOMCS                                                   00614000
WTOMCSFL DS    BL1                                                      00615000
WTOMCSF2 EQU   WTOMCS+0                                                 00616000
         ORG   WTOLIST+4                                                00617000
GENTEXT  DS    CL124                                                    00618000
         ORG   GENTEXT                                                  00619000
GMNUM    DS    CL9                                                      00620000
GMTEXT   DS    CL115                                                    00621000
         ORG   WTOLIST+128                                              00622000
RNBCD    DS    CL3                                                      00623000
         DS    CL5                                                      00624000
WORK8    DS    CL8                                                      00625000
WORK4    DS    CL4                                                      00626000
MSGNOTXT DS    CL9                                                      00627000
         ORG   MSGNOTXT                                                 00628000
@NM00010 DS    CL6                                                      00629000
MSGNODEC DS    CL3                                                      00630000
         ORG   MSGNOTXT+9                                               00631000
         DS    CL3                                                      00632000
AUTOLIST DS    CL24                                                     00633000
         ORG   AUTOLIST                                                 00634000
ENQSL    DS    CL12                                                     00635000
DEQL     DS    CL12                                                     00636000
         ORG   AUTOLIST+24                                              00637000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00638000
@ENDDATD EQU   *                                                        00639000
@DATEND  EQU   *                                                        00640000
IEEVSND3 CSECT                                                          00641000
         DS    0F                                                       00642000
@SIZDATD DC    AL1(0)                                                   00643000
         DC    AL3(@ENDDATD-@DATD)                                      00644000
@SIZ001  EQU   @SIZDATD                                                 00645000
@CV00345 DC    V(IEEVSND5)                                              00646000
         DS    0D                                                       00647000
WTOMAX   DC    AL1(72)                                                  00648000
WTOMAX2  DC    AL1(63)                                                  00649000
WTNLNG   DC    AL1(9)                                                   00650000
@CC00360 DC    C'MSGNO '                                                00651000
WTODESC  DC    X'08000000'                                              00652000
QNAME    DC    CL8'SYSIKJBC'                                            00653000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00654000
@01      EQU   01                                                       00655000
@02      EQU   02                                                       00656000
@03      EQU   03                                                       00657000
@04      EQU   04                                                       00658000
@05      EQU   05                                                       00659000
@06      EQU   06                                                       00660000
@07      EQU   07                                                       00661000
@08      EQU   08                                                       00662000
@09      EQU   09                                                       00663000
@10      EQU   10                                                       00664000
@11      EQU   11                                                       00665000
@12      EQU   12                                                       00666000
@13      EQU   13                                                       00667000
@14      EQU   14                                                       00668000
@15      EQU   15                                                       00669000
@0       EQU   00                                                       00670000
@1       EQU   01                                                       00671000
@2       EQU   02                                                       00672000
@3       EQU   03                                                       00673000
@4       EQU   04                                                       00674000
@5       EQU   05                                                       00675000
@6       EQU   06                                                       00676000
@7       EQU   07                                                       00677000
@8       EQU   08                                                       00678000
@9       EQU   09                                                       00679000
@A       EQU   10                                                       00680000
@B       EQU   11                                                       00681000
@C       EQU   12                                                       00682000
@D       EQU   13                                                       00683000
@E       EQU   14                                                       00684000
@F       EQU   15                                                       00685000
COMPTR   EQU   @03                                                      00686000
R0       EQU   @00                                                      00687000
R1       EQU   @01                                                      00688000
I        EQU   @04                                                      00689000
R5       EQU   @05                                                      00690000
R15      EQU   @15                                                      00691000
COMMON   EQU   0                                                        00692000
COMMONA  EQU   COMMON                                                   00693000
MSGFLAGS EQU   COMMONA+3                                                00694000
FMSG6    EQU   MSGFLAGS                                                 00695000
FLAGS    EQU   COMMONA+4                                                00696000
FLISTING EQU   FLAGS                                                    00697000
@NM00002 EQU   FLAGS+1                                                  00698000
FYESBCM  EQU   @NM00002                                                 00699000
FMN      EQU   @NM00002                                                 00700000
@NM00003 EQU   FLAGS+2                                                  00701000
FLISTALL EQU   @NM00003                                                 00702000
FLIST    EQU   @NM00003                                                 00703000
FTEXT    EQU   @NM00003                                                 00704000
@NM00004 EQU   FLAGS+3                                                  00705000
FSOURCE  EQU   @NM00004                                                 00706000
FTERM    EQU   FSOURCE                                                  00707000
FCONSOL  EQU   FSOURCE                                                  00708000
FBADIO   EQU   @NM00004                                                 00709000
FBADTPUT EQU   @NM00004                                                 00710000
SDIORC   EQU   COMMONA+16                                               00711000
TBEG     EQU   COMMONA+20                                               00712000
CSCBPTR  EQU   COMMONA+21                                               00713000
TEXTLENG EQU   COMMONA+28                                               00714000
CBCMSGNO EQU   COMMONA+32                                               00715000
COMMONB  EQU   COMMON+160                                               00716000
COMBUF   EQU   COMMONB                                                  00717000
COMMONC  EQU   COMMON+284                                               00718000
SDIOPARM EQU   COMMONC+168                                              00719000
@NM00006 EQU   SDIOPARM                                                 00720000
P1READ   EQU   @NM00006                                                 00721000
@NM00007 EQU   SDIOPARM+1                                               00722000
PARMRBA  EQU   SDIOPARM+4                                               00723000
PARMIOAD EQU   SDIOPARM+8                                               00724000
PARMRCD1 EQU   COMMONC+196                                              00725000
R1BC     EQU   0                                                        00726000
R1BCPTRP EQU   R1BC                                                     00727000
R1BCPTR  EQU   R1BCPTRP+1                                               00728000
R1USPTRP EQU   R1BC+4                                                   00729000
R1BCMAX  EQU   R1BC+12                                                  00730000
BCDIR    EQU   0                                                        00731000
BCDENTRY EQU   BCDIR                                                    00732000
BCDMSGNO EQU   BCDENTRY                                                 00733000
BCDNOMSG EQU   BCDMSGNO                                                 00734000
BCDMRBA  EQU   BCDENTRY+2                                               00735000
BCDNEXT  EQU   BCDIR+126                                                00736000
BCMSG    EQU   0                                                        00737000
BCMLNG   EQU   BCMSG                                                    00738000
BCMTEXT  EQU   BCMSG+1                                                  00739000
CHAIN    EQU   0                                                        00740000
CHFLG    EQU   CHAIN+4                                                  00741000
CHSTS    EQU   CHFLG+2                                                  00742000
CHACT    EQU   CHFLG+3                                                  00743000
CHKEY    EQU   CHAIN+8                                                  00744000
CHPARM   EQU   CHKEY                                                    00745000
CHPKE    EQU   CHAIN+28                                                 00746000
CHUCMP   EQU   CHAIN+29                                                 00747000
CHTJID   EQU   CHAIN+30                                                 00748000
CHASID   EQU   CHTJID                                                   00749000
CHPROCSN EQU   CHAIN+32                                                 00750000
CHACT1   EQU   CHPROCSN+3                                               00751000
CHASM    EQU   CHAIN+40                                                 00752000
CHCIBP   EQU   CHASM+4                                                  00753000
CHRGNSZ  EQU   CHASM+8                                                  00754000
CHSTEP   EQU   CHASM+24                                                 00755000
CHSWT    EQU   CHSTEP                                                   00756000
CHSHORT  EQU   CHASM+32                                                 00757000
COMMONP  EQU   0                                                        00758000
CHAINS01 EQU   CHASM                                                    00759000
CHTYPE   EQU   CHAINS01+124                                             00760000
CHTRSTAT EQU   CHAINS01+125                                             00761000
CHCSYSO  EQU   CHAINS01+134                                             00762000
*                                      START UNREFERENCED COMPONENTS    00763000
CHLAST   EQU   CHAINS01+136                                             00764000
CHSPA    EQU   CHAINS01+135                                             00765000
CHUSERID EQU   CHCSYSO                                                  00766000
CHJB     EQU   CHCSYSO                                                  00767000
CHDUMP   EQU   CHCSYSO                                                  00768000
CHQUE    EQU   CHCSYSO                                                  00769000
CHHOLD   EQU   CHCSYSO                                                  00770000
CHOUT    EQU   CHCSYSO                                                  00771000
CHINN    EQU   CHCSYSO                                                  00772000
CHALL    EQU   CHCSYSO                                                  00773000
CHINC    EQU   CHAINS01+132                                             00774000
CHPEND   EQU   CHAINS01+128                                             00775000
CHARID   EQU   CHAINS01+127                                             00776000
CHCNID   EQU   CHAINS01+126                                             00777000
@NM00014 EQU   CHTRSTAT                                                 00778000
CHTSL    EQU   CHTRSTAT                                                 00779000
CHTS     EQU   CHTRSTAT                                                 00780000
CHINITL  EQU   CHTRSTAT                                                 00781000
CHINIT   EQU   CHTRSTAT                                                 00782000
CHJOBSL  EQU   CHTRSTAT                                                 00783000
CHJOBS   EQU   CHTRSTAT                                                 00784000
CHDEF    EQU   CHTYPE                                                   00785000
CHHIAR   EQU   CHTYPE                                                   00786000
CHARSV29 EQU   CHTYPE                                                   00787000
CHARSV28 EQU   CHTYPE                                                   00788000
CHARSV27 EQU   CHTYPE                                                   00789000
CHARSV26 EQU   CHTYPE                                                   00790000
CHARSV25 EQU   CHTYPE                                                   00791000
CHDSTAT  EQU   CHTYPE                                                   00792000
CHBUF    EQU   CHAINS01                                                 00793000
CHARSV16 EQU   CHSHORT+100                                              00794000
CHARSV15 EQU   CHSHORT+96                                               00795000
CHJSCBVS EQU   CHSHORT+92                                               00796000
CHUSCVS  EQU   CHSHORT+88                                               00797000
@NM00013 EQU   CHSHORT+84                                               00798000
@NM00012 EQU   CHSHORT+80                                               00799000
CHSQA    EQU   CHSHORT+44                                               00800000
CHQPA    EQU   CHSHORT+8                                                00801000
CHJCL    EQU   CHSHORT+4                                                00802000
CHSPC    EQU   CHSHORT                                                  00803000
CHSPB    EQU   CHSTEP+4                                                 00804000
CHTCB    EQU   CHSTEP+1                                                 00805000
CHARSV23 EQU   CHSWT                                                    00806000
CHARSV22 EQU   CHSWT                                                    00807000
CHARSV21 EQU   CHSWT                                                    00808000
CHAC     EQU   CHSWT                                                    00809000
CHPSF    EQU   CHSWT                                                    00810000
CHPSD    EQU   CHSWT                                                    00811000
CHJCT    EQU   CHSWT                                                    00812000
CHARSV20 EQU   CHSWT                                                    00813000
CHCECB   EQU   CHASM+20                                                 00814000
CHECB    EQU   CHASM+16                                                 00815000
CHRGNAD  EQU   CHASM+12                                                 00816000
CHARSV18 EQU   CHRGNSZ+1                                                00817000
CHRPRTY  EQU   CHRGNSZ                                                  00818000
@NM00011 EQU   CHCIBP                                                   00819000
CHEND    EQU   CHCIBP                                                   00820000
CHECBP   EQU   CHASM                                                    00821000
CHDER    EQU   CHPROCSN+4                                               00822000
CHARSV10 EQU   CHACT1                                                   00823000
CHARSV09 EQU   CHACT1                                                   00824000
CHARSV08 EQU   CHACT1                                                   00825000
CHARSV07 EQU   CHACT1                                                   00826000
CHARSV06 EQU   CHACT1                                                   00827000
CHARSV05 EQU   CHACT1                                                   00828000
CHARSV04 EQU   CHACT1                                                   00829000
CHRDWTR  EQU   CHACT1                                                   00830000
CHARSV30 EQU   CHPROCSN+2                                               00831000
CHQID    EQU   CHPROCSN                                                 00832000
CHTRKID  EQU   CHPKE                                                    00833000
CHCIBCTR EQU   CHAIN+27                                                 00834000
CHUNIT   EQU   CHAIN+24                                                 00835000
CHCLS    EQU   CHAIN+16                                                 00836000
CHPCOI   EQU   CHPARM                                                   00837000
CHIFY    EQU   CHACT                                                    00838000
CHAIFX   EQU   CHACT                                                    00839000
CHCLD    EQU   CHACT                                                    00840000
CHCL     EQU   CHACT                                                    00841000
CHDSI    EQU   CHACT                                                    00842000
CHDISC   EQU   CHACT                                                    00843000
CHTERM   EQU   CHACT                                                    00844000
CHSWAP   EQU   CHACT                                                    00845000
CHABTERM EQU   CHSTS                                                    00846000
CHFC     EQU   CHSTS                                                    00847000
CHDL     EQU   CHSTS                                                    00848000
CHAD     EQU   CHSTS                                                    00849000
CHQSPC   EQU   CHSTS                                                    00850000
CHSOUT   EQU   CHSTS                                                    00851000
CHSYS    EQU   CHSTS                                                    00852000
CHAP     EQU   CHSTS                                                    00853000
CHSZE    EQU   CHFLG+1                                                  00854000
CHVCD    EQU   CHFLG                                                    00855000
CHPTR    EQU   CHAIN                                                    00856000
@NM00009 EQU   BCMSG+126                                                00857000
BCDREND  EQU   BCDIR+125                                                00858000
@NM00008 EQU   R1BC+45                                                  00859000
R1LEVEL  EQU   R1BC+38                                                  00860000
R1DSN    EQU   R1BC+14                                                  00861000
R1RECNUM EQU   R1BC+8                                                   00862000
R1USPTR  EQU   R1USPTRP+1                                               00863000
R1USFLGS EQU   R1USPTRP                                                 00864000
R1BCFLGS EQU   R1BCPTRP                                                 00865000
PARMDCB  EQU   COMMONC+192                                              00866000
PARMLMCT EQU   COMMONC+188                                              00867000
PARMDDNM EQU   SDIOPARM+12                                              00868000
PARMFDBK EQU   SDIOPARM+3                                               00869000
PARMKEY  EQU   SDIOPARM+2                                               00870000
P2DEVAD  EQU   @NM00007                                                 00871000
P2DEL    EQU   @NM00007                                                 00872000
P2CLOSE  EQU   @NM00007                                                 00873000
P2WRDAF  EQU   @NM00007                                                 00874000
P2WRDI   EQU   @NM00007                                                 00875000
P1READ1  EQU   @NM00006                                                 00876000
P1CREATE EQU   @NM00006                                                 00877000
P1OPEN   EQU   @NM00006                                                 00878000
@NM00005 EQU   COMMONC+167                                              00879000
OPERID   EQU   COMMONC+160                                              00880000
IDUSRID  EQU   COMMONC                                                  00881000
MSG1EXT  EQU   COMMONA+36                                               00882000
CBCCONID EQU   COMMONA+34                                               00883000
ACCESSOR EQU   COMMONA+29                                               00884000
COMBUFP  EQU   COMMONA+25                                               00885000
COMI     EQU   COMMONA+24                                               00886000
RETVATT1 EQU   COMMONA+17                                               00887000
IDTBL    EQU   COMMONA+13                                               00888000
IDCNT    EQU   COMMONA+12                                               00889000
MSG1EXTP EQU   COMMONA+9                                                00890000
M1IND    EQU   COMMONA+8                                                00891000
FBADRITA EQU   @NM00004                                                 00892000
FMSG1    EQU   @NM00004                                                 00893000
FWTO2    EQU   @NM00004                                                 00894000
FERRSYN  EQU   @NM00004                                                 00895000
FERRID   EQU   @NM00003                                                 00896000
FALL     EQU   @NM00003                                                 00897000
FLOGON   EQU   @NM00003                                                 00898000
FNOW     EQU   @NM00003                                                 00899000
FDEL     EQU   @NM00003                                                 00900000
FCNS     EQU   @NM00002                                                 00901000
FMAILFL  EQU   @NM00002                                                 00902000
FUSER    EQU   @NM00002                                                 00903000
FBRDCST  EQU   @NM00002                                                 00904000
FADDBC   EQU   @NM00002                                                 00905000
FNOMSG   EQU   @NM00002                                                 00906000
FOVER20  EQU   FLAGS                                                    00907000
FENDUSL  EQU   FLAGS                                                    00908000
FUPUSD   EQU   FLAGS                                                    00909000
FCHNMSG  EQU   FLAGS                                                    00910000
FBADSEND EQU   FLAGS                                                    00911000
FANYINV  EQU   FLAGS                                                    00912000
FOPEN    EQU   FLAGS                                                    00913000
FMSGA    EQU   MSGFLAGS                                                 00914000
FMSG9    EQU   MSGFLAGS                                                 00915000
FMSG8    EQU   MSGFLAGS                                                 00916000
FMSG5    EQU   MSGFLAGS                                                 00917000
FMSG4    EQU   MSGFLAGS                                                 00918000
FMSG3    EQU   MSGFLAGS                                                 00919000
FMSG2    EQU   MSGFLAGS                                                 00920000
VALCNT   EQU   COMMONA+2                                                00921000
TPUTRC   EQU   COMMONA+1                                                00922000
@NM00001 EQU   COMMONA                                                  00923000
*                                      END UNREFERENCED COMPONENTS      00924000
@RT00043 EQU   RD1BKL                                                   00925000
@RT00046 EQU   WMSG6                                                    00926000
@RT00058 EQU   BADIO                                                    00927000
@RT00062 EQU   LMAX                                                     00928000
@RT00064 EQU   LSTMSGBK                                                 00929000
@RT00066 EQU   LISTMSG                                                  00930000
@RT00068 EQU   LISTMSG                                                  00931000
@RT00070 EQU   WMSG6                                                    00932000
@RT00073 EQU   LMAX                                                     00933000
@RT00079 EQU   EXITCODE                                                 00934000
@RF00079 EQU   WMSG6                                                    00935000
@RT00090 EQU   BADIO                                                    00936000
@RT00117 EQU   EXITCODE                                                 00937000
@RT00125 EQU   EXITCODE                                                 00938000
@RT00176 EQU   BADTPUT                                                  00939000
ROUTER   EQU   LIST3                                                    00940000
@RT00152 EQU   ROUTER                                                   00941000
@EL01    EQU   @EL00001                                                 00942000
@ENDDATA EQU   *                                                        00943000
         END   IEEVSND3,(C'PLS1318',0701,78173)                         00944000
