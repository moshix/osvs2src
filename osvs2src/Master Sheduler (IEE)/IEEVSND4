         TITLE 'IEEVSND4 - OPERATOR SEND COMMAND CLEANUP ROUTINE       *00001000
                        '                                               00002000
IEEVSND4 CSECT ,                                                   0001 00003000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00004000
         BALR  @11,0                                               0001 00005000
@PSTART  DS    0H                                                  0001 00006000
         USING @PSTART,@11                                         0001 00007000
         L     @00,@SIZDATD                                        0001 00008000
         GETMAIN R,LV=(0)                                               00009000
         LR    @12,@01                                             0001 00010000
         USING @DATD,@12                                           0001 00011000
         ST    @13,@SA00001+4                                      0001 00012000
         LM    @00,@01,20(@13)                                     0001 00013000
         ST    @12,8(,@13)                                         0001 00014000
         LR    @13,@12                                             0001 00015000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00016000
         MVC   @PC00001(4),0(@01)                                  0001 00017000
         MODID BRANCH=YES                                               00018000
REGS     DS    0H                                                  0062 00019000
         EJECT                                                          00020000
*   COMPTR=R1;                      /* SET BASE FOR COMMON DATA AREA */ 00021000
         LR    COMPTR,R1                                           0068 00022000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00023000
*/*                                                                  */ 00024000
*/*          E     X     I     T     C     O     D     E             */ 00025000
*/*                                                                  */ 00026000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00027000
*                                                                  0069 00028000
*EXITCODE:                          /* CLEANUP AND END PROCESSING    */ 00029000
*   IF FANYINV='1'B                 /* TEST ROUTING FLAG SET IN SND2 */ 00030000
*     THEN                          /* ON, ROUTE CONTROL TO ANYINV   */ 00031000
EXITCODE TM    FANYINV(COMPTR),B'01000000'                         0069 00032000
         BO    @RT00069                                            0069 00033000
*     GOTO ANYINV;                  /* SET UP FOR MSGF         Y02676*/ 00034000
*   IF FMSG1='1'B                   /* TEST IF MSG1 TO BE ISSUED     */ 00035000
*     THEN                          /* YES, SOME USERIDS INVALID     */ 00036000
         TM    FMSG1(COMPTR),B'00001000'                           0071 00037000
         BO    @RT00071                                            0071 00038000
*     GOTO MSG1OUT;                 /* GOTO ISSUE MSG 1              */ 00039000
*   IF FMSG2='1'B                   /* TEST IF MSG2 TO BE ISSUED     */ 00040000
*     THEN                          /* YES, SOME SPECIFIED USERIDS 0073 00041000
*                                      NOT LOGGED ON WITH 'NOW' PARM */ 00042000
         TM    FMSG2(COMPTR),B'10000000'                           0073 00043000
         BO    @RT00073                                            0073 00044000
*     GOTO INV2;                    /* GOTO ISSUE MSG 2              */ 00045000
*   IF FMSG3='1'B                   /* TEST IF MSG3 TO BE ISSUED     */ 00046000
*     THEN                          /* YES, SYNTAX ERROR IN CMD      */ 00047000
         TM    FMSG3(COMPTR),B'01000000'                           0075 00048000
         BO    @RT00075                                            0075 00049000
*     GOTO ERRSYN;                  /* GOTO ISSUE MSG 3              */ 00050000
*   IF FMSG4='1'B                   /* TEST IF MSG4 TO BE ISSUED     */ 00051000
*     THEN                          /* YES, BROADCAST DATA SET FULL  */ 00052000
         TM    FMSG4(COMPTR),B'00100000'                           0077 00053000
         BO    @RT00077                                            0077 00054000
*     GOTO ERR4;                    /* GOTO ISSUE MSG 4              */ 00055000
*   IF FMSG6='1'B                   /* TEST IF MSG6 TO BE ISSUED     */ 00056000
*     THEN                          /* YES, BROADCAST MSG NOT FOUND  */ 00057000
         TM    FMSG6(COMPTR),B'00001000'                           0079 00058000
         BO    @RT00079                                            0079 00059000
*     GOTO WMSG6;                   /* GOTO ISSUE MSG 6              */ 00060000
*   IF FMSG8='1'B                   /* TEST IF MSG8 TO BE ISSUED     */ 00061000
*     THEN                          /* YES, BROADCAST MSG ADDED TO DS*/ 00062000
         TM    FMSG8(COMPTR),B'00000100'                           0081 00063000
         BO    @RT00081                                            0081 00064000
*     GOTO MSG8OUT;                 /* GOTO ISSUE MSG 8              */ 00065000
*   IF FMSGA='1'B                   /* TEST IF MSGA TO BE ISSUED     */ 00066000
*     THEN                          /* YES, MSG TEXT TRUNCATED       */ 00067000
         TM    FMSGA(COMPTR),B'00000001'                           0083 00068000
         BO    @RT00083                                            0083 00069000
*     GOTO MSGAOUT;                 /* ISSUE WARNING MSG TO SENDER   */ 00070000
*   IF FOVER20='1'B                 /* TEST IF MSGF REQUIRED   Y02676*/ 00071000
*     THEN                          /* YES, OVER 20 USERIDS    Y02676*/ 00072000
         TM    FOVER20(COMPTR),B'00000010'                         0085 00073000
         BO    @RT00085                                            0085 00074000
*     GOTO MSGEOUT;                 /* ISSUE WARNING MSG       Y02676*/ 00075000
*   IF FBADTPUT='1'B                /* TEST IF TPUT ERROR FOUND      */ 00076000
*     THEN                          /* YES, TPUT ERROR FOUND         */ 00077000
         TM    FBADTPUT(COMPTR),B'00000001'                        0087 00078000
         BO    @RT00087                                            0087 00079000
*     GOTO BADTPUT;                 /* ISSUE WARNING MSG TO SENDER   */ 00080000
*   IF FBADIO='1'B                  /* TEST IF IO ERROR FOUND        */ 00081000
*     THEN                          /* YES, IO ERROR FOUND           */ 00082000
         TM    FBADIO(COMPTR),B'00000100'                          0089 00083000
         BO    @RT00089                                            0089 00084000
*     GOTO BADIO;                   /* ISSUE WARNING MSG TO SENDER   */ 00085000
*   IF FBADRITA='1'B                /* TEST IF BAD WRITE 'DA'        */ 00086000
*     THEN                          /* YES, BAD 'WRITE IN FREE SPACE'*/ 00087000
         TM    FBADRITA(COMPTR),B'00000010'                        0091 00088000
         BO    @RT00091                                            0091 00089000
*     GOTO BADRITA;                 /* ISSUE WARNING MSG TO SENDER   */ 00090000
*EXIT3:                                                            0093 00091000
*   RETURN;                                                        0093 00092000
@EL00001 L     @13,4(,@13)                                         0093 00093000
@EF00001 L     @00,@SIZDATD                                        0093 00094000
         LR    @01,@12                                             0093 00095000
         FREEMAIN R,LV=(0),A=(1)                                        00096000
@ER00001 LM    @14,@12,12(@13)                                     0093 00097000
         BR    @14                                                 0093 00098000
*                                                                  0094 00099000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00100000
*/*                                                                  */ 00101000
*/*                 SET UP MSG 'INVALID USERID(S) ---'               */ 00102000
*/*                                                                  */ 00103000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00104000
*                                                                  0094 00105000
*ANYINV:                            /* REJECT SYNTACTICALLY INVALID     00106000
*                                      USERIDS                 Y02676*/ 00107000
*   FANYINV='0'B;                   /* TURN OFF ROUTING FLAG         */ 00108000
ANYINV   NI    FANYINV(COMPTR),B'10111111'                         0094 00109000
*   GMTEXT(1:MSGFLNG)=MSGFTEXT;     /* COPY MSGF TEXT          Y02676*/ 00110000
         L     @10,@CA00171                                        0095 00111000
         L     @10,MSGFP-MSGTABLE(,@10)                            0095 00112000
         SLR   @02,@02                                             0095 00113000
         IC    @02,MSGFLNG(,@10)                                   0095 00114000
         LR    @15,@02                                             0095 00115000
         BCTR  @15,0                                               0095 00116000
         EX    @15,@SM00468                                        0095 00117000
*   GMTEXT(MSGFLNG+1:MSGFLNG+M1IND+1)=MSG1EXT(1:M1IND-1);/*    Y02676   00118000
*                                      APPEND INSERT           Y02676*/ 00119000
         LA    @01,GMTEXT(@02)                                     0096 00120000
         SLR   @15,@15                                             0096 00121000
         IC    @15,M1IND(,COMPTR)                                  0096 00122000
         EX    @15,@SM00470                                        0096 00123000
*   GMNUM=MSGFWTN;                  /* SET MSG ID              Y02676*/ 00124000
         MVI   GMNUM+7,C' '                                        0097 00125000
         MVI   GMNUM+8,C' '                                        0097 00126000
         MVC   GMNUM(7),MSGFWTN(@10)                               0097 00127000
*   GENLNG=MSGFLNG+WTNLNG+M1IND-1;  /*                         Y02676   00128000
*                                      COMPUTE MESSAGE LENGTH  Y02676*/ 00129000
         MVC   @ZT00003+3(1),WTNLNG                                0098 00130000
         AL    @02,@ZT00003                                        0098 00131000
         ALR   @02,@15                                             0098 00132000
         BCTR  @02,0                                               0098 00133000
         STH   @02,GENLNG                                          0098 00134000
*   GOTO WARNMSG;                   /* ISSUE WARNING MSG       Y02676*/ 00135000
         B     WARNMSG                                             0099 00136000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00137000
*/*                                                                  */ 00138000
*/*            SET UP MSG 'UNDEFINED USERID(S) ---'                  */ 00139000
*/*                                                                  */ 00140000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00141000
*                                                                  0100 00142000
*MSG1OUT:                           /* ISSUE 'UNDEFINED USERS' MSG   */ 00143000
*   M1IND=1;                        /* INITIALIZE INDEX TO INSERT  0100 00144000
*                                      AREA                    Y02676*/ 00145000
MSG1OUT  MVI   M1IND(COMPTR),X'01'                                 0100 00146000
*IDLP1:                                                            0101 00147000
*   DO J=1 TO IDCNT;                /* SCAN ENTIRE USERID TABLE TO 0101 00148000
*                                      CHK FOR ANY INVALID USERIDS 0101 00149000
*                                                              SPEC'D   00150000
*                                      CHECK FOR BLANK USERID ENTRY  */ 00151000
IDLP1    LA    @10,1                                               0101 00152000
         B     @DE00101                                            0101 00153000
@DL00101 DS    0H                                                  0102 00154000
*     IF IDUSRID(J,1:7)^=BLNKID(1:7)/* IS THIS ENTRY BLANK           */ 00155000
*       THEN                        /* NO, THIS ENTRY IS NOT BLANK   */ 00156000
         SLA   @10,3                                               0102 00157000
         ALR   @10,COMPTR                                          0102 00158000
         CLC   IDUSRID-8(7,@10),BLNKID                             0102 00159000
         BE    @RF00102                                            0102 00160000
*IDLP2:                                                            0103 00161000
*       DO;                         /* MOVE USERID INTO MSG AREA     */ 00162000
IDLP2    DS    0H                                                  0104 00163000
*IDLP3:                                                            0104 00164000
*         DO K=1 TO 7;              /* SCAN 1 ENTRY IN USERID TABLE  */ 00165000
IDLP3    LA    @10,1                                               0104 00166000
         STC   @10,K                                               0104 00167000
@DL00104 DS    0H                                                  0105 00168000
*           IF IDUSRID(J,K)=' '     /* IS THIS CHAR A BLANK          */ 00169000
*             THEN                  /* YES, END OF THIS USERID       */ 00170000
         SLR   @02,@02                                             0105 00171000
         IC    @02,J                                               0105 00172000
         SLA   @02,3                                               0105 00173000
         ALR   @02,@10                                             0105 00174000
         ST    @02,@TF00001                                        0105 00175000
         ALR   @02,COMPTR                                          0105 00176000
         CLI   IDUSRID-9(@02),C' '                                 0105 00177000
         BE    @RT00105                                            0105 00178000
*             GOTO IDLP4;           /* GO TO GET NEXT USERID ENTRY   */ 00179000
*           MSG1EXT(M1IND)=IDUSRID(J,K);/* MOVE THIS CHAR OF USERID     00180000
*                                      TO MSG AREA                   */ 00181000
         SLR   @02,@02                                             0107 00182000
         IC    @02,M1IND(,COMPTR)                                  0107 00183000
         ALR   @02,COMPTR                                          0107 00184000
         LR    @01,COMPTR                                          0107 00185000
         AL    @01,@TF00001                                        0107 00186000
         MVC   MSG1EXT-1(1,@02),IDUSRID-9(@01)                     0107 00187000
*           M1IND=M1IND+1;          /* BUMP INDEX TO MSG TEXT        */ 00188000
         SLR   @02,@02                                             0108 00189000
         IC    @02,M1IND(,COMPTR)                                  0108 00190000
         AH    @02,@CH00047                                        0108 00191000
         STC   @02,M1IND(,COMPTR)                                  0108 00192000
*         END IDLP3;                /* END OF MOVING 1 USERID        */ 00193000
         AH    @10,@CH00047                                        0109 00194000
         STC   @10,K                                               0109 00195000
         CH    @10,@CH00118                                        0109 00196000
         BNH   @DL00104                                            0109 00197000
*IDLP4:                                                            0110 00198000
*         MSG1EXT(M1IND)=' ';       /* INSERT BLANK BETWEEN ID'S     */ 00199000
IDLP4    SLR   @10,@10                                             0110 00200000
         IC    @10,M1IND(,COMPTR)                                  0110 00201000
         ALR   @10,COMPTR                                          0110 00202000
         MVI   MSG1EXT-1(@10),C' '                                 0110 00203000
*         M1IND=M1IND+1;            /* BUMP INDEX TO MSG TEXT        */ 00204000
         SLR   @10,@10                                             0111 00205000
         IC    @10,M1IND(,COMPTR)                                  0111 00206000
         AH    @10,@CH00047                                        0111 00207000
         STC   @10,M1IND(,COMPTR)                                  0111 00208000
*       END IDLP2;                  /* END OF 1 USERID ENTRY         */ 00209000
*   END IDLP1;                      /* END OF USERID TABLE SCAN      */ 00210000
@RF00102 LA    @10,1                                               0113 00211000
         MVC   @ZT00003+3(1),J                                     0113 00212000
         AL    @10,@ZT00003                                        0113 00213000
@DE00101 STC   @10,J                                               0113 00214000
         MVC   @ZT00003+3(1),IDCNT(COMPTR)                         0113 00215000
         C     @10,@ZT00003                                        0113 00216000
         BNH   @DL00101                                            0113 00217000
*   FMSG1='0'B;                     /* TURN OFF MSG 1 FLAG           */ 00218000
         NI    FMSG1(COMPTR),B'11110111'                           0114 00219000
*   GMTEXT(1:MSG1LNG)=MSG1TEXT;     /* BEGINNING MSG1 TEXT PUT     0115 00220000
*                                      INVALID USERIDS INTO MSG1     */ 00221000
         L     @10,@CA00171                                        0115 00222000
         L     @10,MSG1P-MSGTABLE(,@10)                            0115 00223000
         SLR   @02,@02                                             0115 00224000
         IC    @02,MSG1LNG(,@10)                                   0115 00225000
         LR    @15,@02                                             0115 00226000
         BCTR  @15,0                                               0115 00227000
         EX    @15,@SM00473                                        0115 00228000
*   GMTEXT(MSG1LNG+1:MSG1LNG+M1IND+1)=MSG1EXT(1:M1IND-1);          0116 00229000
         LA    @01,GMTEXT(@02)                                     0116 00230000
         SLR   @15,@15                                             0116 00231000
         IC    @15,M1IND(,COMPTR)                                  0116 00232000
         EX    @15,@SM00470                                        0116 00233000
*   GMNUM=MSG1WTN;                  /* SET MSG ID                    */ 00234000
         MVI   GMNUM+7,C' '                                        0117 00235000
         MVI   GMNUM+8,C' '                                        0117 00236000
         MVC   GMNUM(7),MSG1WTN(@10)                               0117 00237000
*   GENLNG=MSG1LNG+WTNLNG+M1IND-1;  /* SET LENGTH MSG TEXT PLUS MSG     00238000
*                                      ID PLUS USERIDS               */ 00239000
         MVC   @ZT00003+3(1),WTNLNG                                0118 00240000
         AL    @02,@ZT00003                                        0118 00241000
         ALR   @02,@15                                             0118 00242000
         BCTR  @02,0                                               0118 00243000
         STH   @02,GENLNG                                          0118 00244000
*   GOTO WARNMSG;                   /* ISSUE WARNING MSG           0119 00245000
*                                                                    */ 00246000
         B     WARNMSG                                             0119 00247000
*                                                                  0120 00248000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/ 00249000
*/*                                                                  */ 00250000
*/*               SET UP MSG 'USERS....NOT LOGGED ON'                */ 00251000
*/*                                                                  */ 00252000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/ 00253000
*                                                                  0120 00254000
*INV2:                              /* 'NOW' SPEC'D BUT NOT ALL USERS   00255000
*                                      SPECIFIED WERE LOGGED ON      */ 00256000
*   FMSG2='0'B;                     /* TURN OFF MSG 2 FLAG           */ 00257000
INV2     NI    FMSG2(COMPTR),B'01111111'                           0120 00258000
*   M=1;                            /* INIT INDEX TO MSG TEXT        */ 00259000
         LA    @10,1                                               0121 00260000
         STC   @10,M                                               0121 00261000
*   GMTEXT(M:MSG2BEGL)=MSG2BEG;     /* SET BEGINNING MSG2 TEXT       */ 00262000
         LA    @02,GMTEXT-1(@10)                                   0122 00263000
         L     @15,@CA00171                                        0122 00264000
         L     @15,MSG2P-MSGTABLE(,@15)                            0122 00265000
         SLR   @14,@14                                             0122 00266000
         IC    @14,MSG2BEGL(,@15)                                  0122 00267000
         LR    @09,@14                                             0122 00268000
         SLR   @09,@10                                             0122 00269000
         EX    @09,@SM00476                                        0122 00270000
*   GMTEXT(MSG2BEGL+1)=' ';         /* INSERT BLANK BEFORE USERIDS   */ 00271000
         LA    @02,GMTEXT(@14)                                     0123 00272000
         MVI   0(@02),C' '                                         0123 00273000
*   M=M+MSG2BEGL+1;                 /* BUMP INDEX PAST MSG2 BEGINNING*/ 00274000
         LA    @02,1                                               0124 00275000
         ALR   @10,@14                                             0124 00276000
         ALR   @10,@02                                             0124 00277000
         STC   @10,M                                               0124 00278000
*   DO J=1 TO IDCNT;                /* SCAN ENTIRE USRIDTAB          */ 00279000
         B     @DE00125                                            0125 00280000
@DL00125 DS    0H                                                  0126 00281000
*     IF IDUSRID(J)^=BLNKID         /* CHECK FOR NON-BLANK ENTRY   0126 00282000
*                                                              Y02676*/ 00283000
*       THEN                                                       0126 00284000
         SLA   @02,3                                               0126 00285000
         ST    @02,@TF00001                                        0126 00286000
         ALR   @02,COMPTR                                          0126 00287000
         CLC   IDUSRID-8(8,@02),BLNKID                             0126 00288000
         BE    @RF00126                                            0126 00289000
*       DO;                         /* MOVE USERID ENTRY TO MSG TEXT */ 00290000
*         GMTEXT(M:M+6)=IDUSRID(J); /* MOVE USERID FROM USRIDTAB TO     00291000
*                                      MSG2 TEXT                     */ 00292000
         SLR   @10,@10                                             0128 00293000
         IC    @10,M                                               0128 00294000
         LA    @02,GMTEXT-1(@10)                                   0128 00295000
         LR    @01,COMPTR                                          0128 00296000
         AL    @01,@TF00001                                        0128 00297000
         MVC   0(7,@02),IDUSRID-8(@01)                             0128 00298000
*         GMTEXT(M+7)=' ';          /* INSERT BLANK BETWEEN USERIDS  */ 00299000
         LA    @02,GMTEXT+6(@10)                                   0129 00300000
         MVI   0(@02),C' '                                         0129 00301000
*         M=M+8;                    /* BUMP INDEX TO MSG TEXT        */ 00302000
         AH    @10,@CH00042                                        0130 00303000
         STC   @10,M                                               0130 00304000
*       END;                                                       0131 00305000
*   END;                                                           0132 00306000
@RF00126 LA    @02,1                                               0132 00307000
         MVC   @ZT00003+3(1),J                                     0132 00308000
         AL    @02,@ZT00003                                        0132 00309000
@DE00125 STC   @02,J                                               0132 00310000
         MVC   @ZT00003+3(1),IDCNT(COMPTR)                         0132 00311000
         C     @02,@ZT00003                                        0132 00312000
         BNH   @DL00125                                            0132 00313000
*   GMTEXT(M:M+MSG2ENDL)=MSG2END;   /* SET MSG2 END TEXT             */ 00314000
         SLR   @10,@10                                             0133 00315000
         IC    @10,M                                               0133 00316000
         LA    @02,GMTEXT-1(@10)                                   0133 00317000
         L     @15,@CA00171                                        0133 00318000
         L     @15,MSG2P-MSGTABLE(,@15)                            0133 00319000
         SLR   @14,@14                                             0133 00320000
         IC    @14,MSG2ENDL(,@15)                                  0133 00321000
         EX    @14,@SM00478                                        0133 00322000
*   M=M+MSG2ENDL;                   /* SET M TO END OF MSG2          */ 00323000
         ALR   @10,@14                                             0134 00324000
         STC   @10,M                                               0134 00325000
*   GMNUM=MSG2WTN;                  /* SET MSG ID                    */ 00326000
         MVI   GMNUM+7,C' '                                        0135 00327000
         MVI   GMNUM+8,C' '                                        0135 00328000
         MVC   GMNUM(7),MSG2WTN(@15)                               0135 00329000
*   GENLNG=M+WTNLNG-1;              /* SET LENGTH MSG TEXT + MSG ID  */ 00330000
         MVC   @ZT00003+3(1),WTNLNG                                0136 00331000
         AL    @10,@ZT00003                                        0136 00332000
         BCTR  @10,0                                               0136 00333000
         STH   @10,GENLNG                                          0136 00334000
*   GOTO WARNMSG;                   /* GOTO GIVE WARNING MSG -     0137 00335000
*                                      'USERIDS ....... NOT LOGGED 0137 00336000
*                                      ON' AND END PROCESSING        */ 00337000
         B     WARNMSG                                             0137 00338000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/ 00339000
*/*                                                                  */ 00340000
*/*                SET UP MSG 'BROADCAST MSGNO = XXXX'               */ 00341000
*/*                                                                  */ 00342000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/ 00343000
*                                                                  0138 00344000
*MSG8OUT:                           /* GIVE CONFIRMATION MSG       0138 00345000
*                                      SPECIFYING THE BROADCAST MSGNO   00346000
*                                      OF MSG JUST ADDED TO NOTICES     00347000
*                                      SECTION WITH 'SEND' MSG TEXT  */ 00348000
*   FMSG8='0'B;                     /* TURN OFF MSG 8 FLAG           */ 00349000
MSG8OUT  NI    FMSG8(COMPTR),B'11111011'                           0138 00350000
*   GMTEXT(1:MSG8LNG)=MSG8TEXT;     /* SET MSG TEXT                  */ 00351000
         L     @10,@CA00171                                        0139 00352000
         L     @10,MSG8P-MSGTABLE(,@10)                            0139 00353000
         SLR   @02,@02                                             0139 00354000
         IC    @02,MSG8LNG(,@10)                                   0139 00355000
         BCTR  @02,0                                               0139 00356000
         EX    @02,@SM00481                                        0139 00357000
*   RESTRICT(R5);                   /* RESTRICT REG 5 FOR 'GEN' USE  */ 00358000
*   R5=CBCMSGNO;                    /* PUT BC MSG NO. INTO REGISTER  */ 00359000
         LH    R5,CBCMSGNO(,COMPTR)                                0141 00360000
*   GEN;                                                           0142 00361000
          CVD   R5,WORK8            CONVERT BC MSG NO. TO DECIMAL       00362000
          UNPK  WORK4(4),WORK8+4(4) UNPACK INTO EBCDIC FORM             00363000
          MVZ   WORK4+3,WORK4+2     SIGN BYTE PRINTABLE                 00364000
*   RELEASE(R5);                    /* RELEASE REG 5 FOR COMPILER USE*/ 00365000
*   MSG8INS=WORK4;                  /* PUT BC MSGNO INTO MSG TEXT    */ 00366000
         MVC   MSG8INS(4),WORK4                                    0144 00367000
*   GMNUM=MSG8WTN;                  /* SET MSG ID                    */ 00368000
         MVI   GMNUM+7,C' '                                        0145 00369000
         MVI   GMNUM+8,C' '                                        0145 00370000
         L     @10,@CA00171                                        0145 00371000
         L     @10,MSG8P-MSGTABLE(,@10)                            0145 00372000
         MVC   GMNUM(7),MSG8WTN(@10)                               0145 00373000
*   GENLNG=MSG8LNG+WTNLNG;          /* SET LENGTH MSG TEXT + MSG ID  */ 00374000
         SLR   @02,@02                                             0146 00375000
         IC    @02,MSG8LNG(,@10)                                   0146 00376000
         MVC   @ZT00003+3(1),WTNLNG                                0146 00377000
         AL    @02,@ZT00003                                        0146 00378000
         STH   @02,GENLNG                                          0146 00379000
*   GOTO WARNMSG;                   /* ISSUE CONFIRMATION MSG GIVING    00380000
*                                      BROADCAST MSGNO OF MSG JUST 0147 00381000
*                                      ADDED TO NOTICES SECTION      */ 00382000
         B     WARNMSG                                             0147 00383000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/ 00384000
*/*                                                                  */ 00385000
*/*      SET UP MSG  'MESSAGE TEXT TRUNCATED TO 115 CHARACTERS'      */ 00386000
*/*                                                                  */ 00387000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/ 00388000
*                                                                  0148 00389000
*MSGAOUT:                           /* ISSUE 'MSG TEXT TRUNCATED'  0148 00390000
*                                      MESSAGE                       */ 00391000
*   FMSGA='0'B;                     /* TURN OFF MSGA FLAG            */ 00392000
MSGAOUT  NI    FMSGA(COMPTR),B'11111110'                           0148 00393000
*   GENLNG=MSGALNG+WTNLNG;          /* SET LENGTH MSG TEXT + MSG ID  */ 00394000
         L     @10,@CA00171                                        0149 00395000
         L     @10,MSGAP-MSGTABLE(,@10)                            0149 00396000
         SLR   @02,@02                                             0149 00397000
         IC    @02,MSGALNG(,@10)                                   0149 00398000
         SLR   @15,@15                                             0149 00399000
         IC    @15,WTNLNG                                          0149 00400000
         ALR   @15,@02                                             0149 00401000
         STH   @15,GENLNG                                          0149 00402000
*   GMTEXT(1:MSGALNG)=MSGATEXT;     /* SET MSG TEXT                  */ 00403000
         BCTR  @02,0                                               0150 00404000
         EX    @02,@SM00484                                        0150 00405000
*   GMNUM=MSGAWTN;                  /* SET MSG ID FOR CONSOLE WTO    */ 00406000
         MVI   GMNUM+7,C' '                                        0151 00407000
         MVI   GMNUM+8,C' '                                        0151 00408000
         MVC   GMNUM(7),MSGAWTN(@10)                               0151 00409000
*   GOTO WARNMSG;                   /* ISSUE WARNING MSG TO SENDER   */ 00410000
         B     WARNMSG                                             0152 00411000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/ 00412000
*/*                                                                  */ 00413000
*/*      SET UP MSG 'NO SPACE IN BROADCAST DATA SET FOR NOTICES'     */ 00414000
*/*                                                     MAIL   '     */ 00415000
*/*                                                                  */ 00416000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/ 00417000
*                                                                  0153 00418000
*ERR4:                              /* SET UP WARNING MESSAGE - NO 0153 00419000
*                                      SPACE IN BROADCAST DATA SET 0153 00420000
*                                      FOR NOTICES / MAIL            */ 00421000
*   FMSG4='0'B;                     /* TURN OFF MSG 4 FLAG           */ 00422000
ERR4     NI    FMSG4(COMPTR),B'11011111'                           0153 00423000
*   GMNUM=MSG4WTN;                  /* SET MSG ID                    */ 00424000
         MVI   GMNUM+7,C' '                                        0154 00425000
         MVI   GMNUM+8,C' '                                        0154 00426000
         L     @10,@CA00171                                        0154 00427000
         L     @10,MSG4P-MSGTABLE(,@10)                            0154 00428000
         MVC   GMNUM(7),MSG4WTN(@10)                               0154 00429000
*   GENLNG=MSG4LNG+WTNLNG;          /* SET LENGTH MSG TEXT + MSG ID  */ 00430000
         SLR   @02,@02                                             0155 00431000
         IC    @02,MSG4LNG(,@10)                                   0155 00432000
         MVC   @ZT00003+3(1),WTNLNG                                0155 00433000
         AL    @02,@ZT00003                                        0155 00434000
         STH   @02,GENLNG                                          0155 00435000
*   GMTEXT=MSG4TEXT;                /* SET MESSAGE TEXT              */ 00436000
         MVI   GMTEXT+35,C' '                                      0156 00437000
         MVC   GMTEXT+36(173),GMTEXT+35                            0156 00438000
         MVC   GMTEXT(35),MSG4TEXT(@10)                            0156 00439000
*   IF FMAILFL='1'B                 /* CHK RETCODE FOR WRITE'DA' ERR */ 00440000
*     THEN                          /* USER MAIL SECTION IS FULL     */ 00441000
*                                                                  0157 00442000
         TM    FMAILFL(COMPTR),B'00000010'                         0157 00443000
         BNO   @RF00157                                            0157 00444000
*     /***************************************************************/ 00445000
*     /*                                                             */ 00446000
*     /* INSERT 'MAIL' IN WARNING MSG                                */ 00447000
*     /*                                                             */ 00448000
*     /***************************************************************/ 00449000
*                                                                  0158 00450000
*     GMTEXT(MSG4SECT:MSG4SECT+8)=MSG4MAIL;                        0158 00451000
         SLR   @02,@02                                             0158 00452000
         IC    @02,MSG4SECT(,@10)                                  0158 00453000
         LA    @01,GMTEXT-1(@02)                                   0158 00454000
         MVI   5(@01),C' '                                         0158 00455000
         MVC   6(3,@01),5(@01)                                     0158 00456000
         MVC   0(5,@01),MSG4MAIL(@10)                              0158 00457000
*   ELSE                            /* BROADCAST NOTICES SECTION FULL*/ 00458000
*                                                                  0159 00459000
*     /***************************************************************/ 00460000
*     /*                                                             */ 00461000
*     /* INSERT 'NOTICES' IN WARNING MSG                             */ 00462000
*     /*                                                             */ 00463000
*     /***************************************************************/ 00464000
*                                                                  0159 00465000
*     GMTEXT(MSG4SECT:MSG4SECT+8)=MSG4NOTI;                        0159 00466000
         B     @RC00157                                            0159 00467000
@RF00157 L     @10,@CA00171                                        0159 00468000
         L     @10,MSG4P-MSGTABLE(,@10)                            0159 00469000
         SLR   @02,@02                                             0159 00470000
         IC    @02,MSG4SECT(,@10)                                  0159 00471000
         LA    @01,GMTEXT-1(@02)                                   0159 00472000
         MVI   8(@01),C' '                                         0159 00473000
         MVC   0(8,@01),MSG4NOTI(@10)                              0159 00474000
*   GOTO WARNMSG;                   /* GIVE WARNING MESSAGE TO SENDER*/ 00475000
         B     WARNMSG                                             0160 00476000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/ 00477000
*/*                                                                  */ 00478000
*/*                SET UP MSG 'NO BROADCAST MESSAGE'                 */ 00479000
*/*                                                                  */ 00480000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/ 00481000
*                                                                  0161 00482000
*WMSG6:                             /* SET UP WARNING MESSAGE - NO 0161 00483000
*                                      BROADCAST MESSAGES            */ 00484000
*   FMSG6='0'B;                     /* TURN OFF MSG 6 FLAG           */ 00485000
WMSG6    NI    FMSG6(COMPTR),B'11110111'                           0161 00486000
*   GMNUM=MSG6WTN;                  /* SET MSG ID                    */ 00487000
         MVI   GMNUM+7,C' '                                        0162 00488000
         MVI   GMNUM+8,C' '                                        0162 00489000
         L     @10,@CA00171                                        0162 00490000
         L     @10,MSG6P-MSGTABLE(,@10)                            0162 00491000
         MVC   GMNUM(7),MSG6WTN(@10)                               0162 00492000
*   GMTEXT(1:MSG6LNG)=MSG6TEXT;     /* SET MSG TEXT                  */ 00493000
         SLR   @02,@02                                             0163 00494000
         IC    @02,MSG6LNG(,@10)                                   0163 00495000
         LR    @15,@02                                             0163 00496000
         BCTR  @15,0                                               0163 00497000
         EX    @15,@SM00487                                        0163 00498000
*   GENLNG=MSG6LNG+WTNLNG;          /* SET LENGTH MSG TEXT + MSG ID  */ 00499000
         MVC   @ZT00003+3(1),WTNLNG                                0164 00500000
         AL    @02,@ZT00003                                        0164 00501000
         STH   @02,GENLNG                                          0164 00502000
*   GOTO WARNMSG;                   /* GIVE WARNING MESSAGE TO SENDER*/ 00503000
*                                                                  0165 00504000
         B     WARNMSG                                             0165 00505000
*   /*****************************************************************/ 00506000
*   /*                                                               */ 00507000
*   /* ISSUE 'SYNTAX ERROR' MESSAGE TO SENDER.                       */ 00508000
*   /*                                                               */ 00509000
*   /*****************************************************************/ 00510000
*                                                                  0166 00511000
*ERRSYN:                            /* SET UP SYNTAX ERROR MSG       */ 00512000
*   FMSG3='0'B;                     /* TURN OFF MSG 3 FLAG           */ 00513000
ERRSYN   NI    FMSG3(COMPTR),B'10111111'                           0166 00514000
*   GMNUM=MSG3WTN;                  /* SET UP MSG ID                 */ 00515000
         MVI   GMNUM+7,C' '                                        0167 00516000
         MVI   GMNUM+8,C' '                                        0167 00517000
         L     @10,@CA00171                                        0167 00518000
         L     @10,MSG3P-MSGTABLE(,@10)                            0167 00519000
         MVC   GMNUM(7),MSG3WTN(@10)                               0167 00520000
*   GMTEXT(1:MSG3LNG)=MSG3TEXT;     /* SET MSG TEXT                  */ 00521000
         SLR   @02,@02                                             0168 00522000
         IC    @02,MSG3LNG(,@10)                                   0168 00523000
         LR    @15,@02                                             0168 00524000
         BCTR  @15,0                                               0168 00525000
         EX    @15,@SM00489                                        0168 00526000
*   GENLNG=MSG3LNG+WTNLNG;          /* SET LENGTH MSG TEXT + MSG ID  */ 00527000
         MVC   @ZT00003+3(1),WTNLNG                                0169 00528000
         AL    @02,@ZT00003                                        0169 00529000
         STH   @02,GENLNG                                          0169 00530000
*   GOTO WARNMSG;                   /* ISSUE WARNING MSG AND END     */ 00531000
         B     WARNMSG                                             0170 00532000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00533000
*/*                                                                  */ 00534000
*/*       SET UP MSG 'USERIDS AFTER 20TH IGNORED'                    */ 00535000
*/*                                                                  */ 00536000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00537000
*                                                                  0171 00538000
*MSGEOUT:                                                          0171 00539000
*   FOVER20='0'B;                   /* RESET ERROR MSG FLAG    Y02676*/ 00540000
MSGEOUT  NI    FOVER20(COMPTR),B'11111101'                         0171 00541000
*   GMNUM=MSGEWTN;                  /* COPY MSG NUMBER         Y02676*/ 00542000
         MVI   GMNUM+7,C' '                                        0172 00543000
         MVI   GMNUM+8,C' '                                        0172 00544000
         L     @10,@CA00171                                        0172 00545000
         L     @10,MSGEP-MSGTABLE(,@10)                            0172 00546000
         MVC   GMNUM(7),MSGEWTN(@10)                               0172 00547000
*   GENLNG=MSGELNG+WTNLNG;          /* CALC MSG LENGTH         Y02676*/ 00548000
         SLR   @02,@02                                             0173 00549000
         IC    @02,MSGELNG(,@10)                                   0173 00550000
         MVC   @ZT00003+3(1),WTNLNG                                0173 00551000
         AL    @02,@ZT00003                                        0173 00552000
         STH   @02,GENLNG                                          0173 00553000
*   GMTEXT=MSGETEXT;                /* COPY MESSAGE TEXT       Y02676*/ 00554000
         MVI   GMTEXT+1,C' '                                       0174 00555000
         MVC   GMTEXT+2(207),GMTEXT+1                              0174 00556000
         MVC   GMTEXT(1),MSGETEXT(@10)                             0174 00557000
*   GOTO WARNMSG;                   /* ISSUE ERROR MSG         Y02676*/ 00558000
         B     WARNMSG                                             0175 00559000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00560000
*/*                                                                  */ 00561000
*/*               SET UP MSG 'BROADCAST DATA SET NOT USABLE,         */ 00562000
*/*                       CANNOT OPEN DATA SET                       */ 00563000
*/*                          I/O SYNAD ERROR                         */ 00564000
*/*                        INSTALLATION MUST REFORMAT'               */ 00565000
*/*                                                                  */ 00566000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00567000
*                                                                  0176 00568000
*BADRITA:                           /* 'WRITE IN FREE SPACE' NOT   0176 00569000
*                                      SUCCESSFUL                    */ 00570000
*   FBADRITA='0'B;                  /* TURN OFF BAD WRITE FLAG       */ 00571000
BADRITA  NI    FBADRITA(COMPTR),B'11111101'                        0176 00572000
*   RETC=SDIORC;                    /* SET RETURN CODE FROM COMMON   */ 00573000
         SLR   @10,@10                                             0177 00574000
         IC    @10,SDIORC(,COMPTR)                                 0177 00575000
         ST    @10,RETC                                            0177 00576000
*   IF RETC=DSFULL                  /* TEST RETCODE FOR DATA SET FULL*/ 00577000
*     THEN                                                         0178 00578000
         MVC   @ZT00003+3(1),DSFULL                                0178 00579000
         C     @10,@ZT00003                                        0178 00580000
         BNE   @RF00178                                            0178 00581000
*     DO;                                                          0179 00582000
*       FMAILFL='1'B;               /* SET FLAG FOR MAIL SECTION FULL*/ 00583000
         OI    FMAILFL(COMPTR),B'00000010'                         0180 00584000
*       GOTO ERR4;                  /* GIVE WARNING MESSAGE - NO   0181 00585000
*                                      SPACE IN BROADCAST DATA SET 0181 00586000
*                                      FOR MAIL                      */ 00587000
         B     ERR4                                                0181 00588000
*     END;                                                         0182 00589000
*BADIO:                             /* TEST RETURN CODE FROM IO RTN  */ 00590000
*   RETC=SDIORC;                    /* SET RC FROM COMMON      YM4914*/ 00591000
@RF00178 DS    0H                                                  0183 00592000
BADIO    SLR   @10,@10                                             0183 00593000
         IC    @10,SDIORC(,COMPTR)                                 0183 00594000
         ST    @10,RETC                                            0183 00595000
*   FBADIO='0'B;                    /* TURN OFF FLAG FOR BAD IO      */ 00596000
         NI    FBADIO(COMPTR),B'11111011'                          0184 00597000
*NOTUSABL:                          /* SET UP WARNING MESSAGE -    0185 00598000
*                                      BROADCAST DATE SET NOT USABLE */ 00599000
*   FMSG5='0'B;                     /* TURN OFF MSG 5 FLAG           */ 00600000
NOTUSABL NI    FMSG5(COMPTR),B'11101111'                           0185 00601000
*   IF RETC=OPENERR                 /* OPEN ERROR              Y02676*/ 00602000
*     THEN                          /* YES, USE MSG10          Y02676*/ 00603000
         L     @10,RETC                                            0186 00604000
         MVC   @ZT00003+3(1),OPENERR                               0186 00605000
         C     @10,@ZT00003                                        0186 00606000
         BNE   @RF00186                                            0186 00607000
*     DO;                                                          0187 00608000
*       GMNUM=MSG10WTN;             /* SET MSG NUMBER          Y02676*/ 00609000
         MVI   GMNUM+7,C' '                                        0188 00610000
         MVI   GMNUM+8,C' '                                        0188 00611000
         L     @10,@CA00171                                        0188 00612000
         L     @10,MSG10P-MSGTABLE(,@10)                           0188 00613000
         MVC   GMNUM(7),MSG10WTN(@10)                              0188 00614000
*       GMTEXT(1:MSG10LNG)=MSG10TXT;/* COPY TEXT               Y02676*/ 00615000
         SLR   @02,@02                                             0189 00616000
         IC    @02,MSG10LNG(,@10)                                  0189 00617000
         LR    @15,@02                                             0189 00618000
         BCTR  @15,0                                               0189 00619000
         EX    @15,@SM00494                                        0189 00620000
*       GENLNG=MSG10LNG+WTNLNG;     /* SET MSG LENGTH          Y02676*/ 00621000
         MVC   @ZT00003+3(1),WTNLNG                                0190 00622000
         AL    @02,@ZT00003                                        0190 00623000
         STH   @02,GENLNG                                          0190 00624000
*       GOTO WARNMSG;               /* ISSUE ERROR MESSAGE     Y02676*/ 00625000
         B     WARNMSG                                             0191 00626000
*     END;                                                         0192 00627000
*   IF RETC=IOERR                   /* I/O ERROR               Y02676*/ 00628000
*     THEN                          /* YES, USE MSG11          Y02676*/ 00629000
@RF00186 L     @10,RETC                                            0193 00630000
         MVC   @ZT00003+3(1),IOERR                                 0193 00631000
         C     @10,@ZT00003                                        0193 00632000
         BNE   @RF00193                                            0193 00633000
*     DO;                           /*                         Y02676*/ 00634000
*       GMNUM=MSG11WTN;             /* COPY MSG NUMBER         Y02676*/ 00635000
         MVI   GMNUM+7,C' '                                        0195 00636000
         MVI   GMNUM+8,C' '                                        0195 00637000
         L     @10,@CA00171                                        0195 00638000
         L     @10,MSG11P-MSGTABLE(,@10)                           0195 00639000
         MVC   GMNUM(7),MSG11WTN(@10)                              0195 00640000
*       GMTEXT(1:MSG11LNG)=MSG11TXT;/* COPY TEXT               Y02676*/ 00641000
         SLR   @02,@02                                             0196 00642000
         IC    @02,MSG11LNG(,@10)                                  0196 00643000
         LR    @15,@02                                             0196 00644000
         BCTR  @15,0                                               0196 00645000
         EX    @15,@SM00496                                        0196 00646000
*       GENLNG=MSG11LNG+WTNLNG;     /* SET MSG LENGTH          Y02676*/ 00647000
         MVC   @ZT00003+3(1),WTNLNG                                0197 00648000
         AL    @02,@ZT00003                                        0197 00649000
         STH   @02,GENLNG                                          0197 00650000
*       GOTO WARNMSG;               /* ISSUE ERROR MSG         Y02676*/ 00651000
         B     WARNMSG                                             0198 00652000
*     END;                                                         0199 00653000
*   IF RETC=BADFMT                  /* BAD FORMAT              Y02676*/ 00654000
*     THEN                          /* YES, USE MSG12          Y02676*/ 00655000
@RF00193 L     @10,RETC                                            0200 00656000
         MVC   @ZT00003+3(1),BADFMT                                0200 00657000
         C     @10,@ZT00003                                        0200 00658000
         BNE   @RF00200                                            0200 00659000
*     DO;                                                          0201 00660000
*       GMNUM=MSG12WTN;             /* COPY MSG NUMBER         Y02676*/ 00661000
         MVI   GMNUM+7,C' '                                        0202 00662000
         MVI   GMNUM+8,C' '                                        0202 00663000
         L     @10,@CA00171                                        0202 00664000
         L     @10,MSG12P-MSGTABLE(,@10)                           0202 00665000
         MVC   GMNUM(7),MSG12WTN(@10)                              0202 00666000
*       GMTEXT(1:MSG12LNG)=MSG12TXT;/* COPY TEXT               Y02676*/ 00667000
         SLR   @02,@02                                             0203 00668000
         IC    @02,MSG12LNG(,@10)                                  0203 00669000
         LR    @15,@02                                             0203 00670000
         BCTR  @15,0                                               0203 00671000
         EX    @15,@SM00498                                        0203 00672000
*       GENLNG=MSG12LNG+WTNLNG;     /* SET MSG LENGTH          Y02676*/ 00673000
         MVC   @ZT00003+3(1),WTNLNG                                0204 00674000
         AL    @02,@ZT00003                                        0204 00675000
         STH   @02,GENLNG                                          0204 00676000
*       GOTO WARNMSG;               /* ISSUE ERROR MSG         Y02676*/ 00677000
         B     WARNMSG                                             0205 00678000
*     END;                                                         0206 00679000
*   ELSE                            /* SEND CANNOT EXECUTE     Y02676*/ 00680000
*     GOTO BADSEND;                 /* ISSUE ERROR MESSAGE     Y02676*/ 00681000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00682000
*/*                                                                  */ 00683000
*/*               SET UP MSG 'SEND CANNOT EXECUTE'                   */ 00684000
*/*                                                                  */ 00685000
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */ 00686000
*                                                                  0208 00687000
*BADTPUT:                                                          0208 00688000
*   IF RETC='08'X|RETC='0C'X        /* TERMINAL SENDER HIT ATTN OR IS   00689000
*                                      IN NO INTERCOM          Y02676*/ 00690000
*     THEN                          /* YES, NOT REAL ERROR     Y02676*/ 00691000
BADTPUT  L     @10,RETC                                            0208 00692000
         CH    @10,@CH00278                                        0208 00693000
         BE    @RT00208                                            0208 00694000
         CH    @10,@CH00451                                        0208 00695000
         BE    @RT00208                                            0208 00696000
*     GOTO EXITCODE;                /* IGNORE ERROR            Y02676*/ 00697000
*BADTPUT1:                                                         0210 00698000
*   FBADTPUT='0'B;                  /* TURN OFF BAD TPUT FLAG        */ 00699000
BADTPUT1 NI    FBADTPUT(COMPTR),B'11111110'                        0210 00700000
*BADSEND:                           /* SET UP MESSAGE 'SEND CANNOT 0211 00701000
*                                      EXECUTE'                      */ 00702000
*   IF FBADSEND='1'B                /* TEST IF PREVIOUS SEND ERROR   */ 00703000
*     THEN                          /* YES, TERMINATE FAST           */ 00704000
BADSEND  TM    FBADSEND(COMPTR),B'00100000'                        0211 00705000
         BO    @RT00211                                            0211 00706000
*     GOTO EXIT3;                                                  0212 00707000
*   ELSE                                                           0213 00708000
*     FBADSEND='1'B;                /* SET FLAG FOR SEND ERROR       */ 00709000
         OI    FBADSEND(COMPTR),B'00100000'                        0213 00710000
*   GMNUM=MSG9WTN;                  /* SET MSG ID                    */ 00711000
         MVI   GMNUM+7,C' '                                        0214 00712000
         MVI   GMNUM+8,C' '                                        0214 00713000
         L     @10,@CA00171                                        0214 00714000
         L     @10,MSG9P-MSGTABLE(,@10)                            0214 00715000
         MVC   GMNUM(7),MSG9WTN(@10)                               0214 00716000
*   GMTEXT(1:MSG9LNG)=MSG9TEXT;     /* SET MSG TEXT                  */ 00717000
         SLR   @02,@02                                             0215 00718000
         IC    @02,MSG9LNG(,@10)                                   0215 00719000
         LR    @15,@02                                             0215 00720000
         BCTR  @15,0                                               0215 00721000
         EX    @15,@SM00501                                        0215 00722000
*   GENLNG=MSG9LNG+WTNLNG;          /* SET LENGTH MSG TEXT + MSG ID  */ 00723000
         MVC   @ZT00003+3(1),WTNLNG                                0216 00724000
         AL    @02,@ZT00003                                        0216 00725000
         STH   @02,GENLNG                                          0216 00726000
*   GOTO WARNMSG;                   /* GIVE WARNING MESSAGE THAT SEND   00727000
*                                      CANNOT EXECUTE                */ 00728000
         B     WARNMSG                                             0217 00729000
*CHKSRC:                            /* CHECK CSCB TO LEARN IF SEND 0218 00730000
*                                      COM. CAME FROM CONSOLE OR   0218 00731000
*                                      TERMINAL IN OPERATOR MODE     */ 00732000
*   IF CHASID=0                     /* TEST ASID FIELD FOR 0, Y02676    00733000
*                                      INDICATING SEND FROM CONSOLE  */ 00734000
*     THEN                          /* SEND CAME FROM OPERATOR     0218 00735000
*                                      CONSOLE                       */ 00736000
CHKSRC   L     @10,CSCBPTR-1(,COMPTR)                              0218 00737000
         LA    @10,0(,@10)                                         0218 00738000
         LH    @10,CHASID(,@10)                                    0218 00739000
         LTR   @10,@10                                             0218 00740000
         BNZ   @RF00218                                            0218 00741000
*     FCONSOL='1'B;                 /* SET FLAG FOR CONSOLE          */ 00742000
         OI    FCONSOL(COMPTR),B'01000000'                         0219 00743000
*   ELSE                            /* SEND CAME FROM OPERATR      0220 00744000
*                                      TERMINAL                      */ 00745000
*     FTERM='1'B;                   /* SET FLAG FOR TERMINAL         */ 00746000
         B     @RC00218                                            0220 00747000
@RF00218 OI    FTERM(COMPTR),B'10000000'                           0220 00748000
*   GOTO SRCBK;                     /* CONTINUE                    0221 00749000
*                                                                    */ 00750000
         B     SRCBK                                               0221 00751000
*WARNMSG:                           /* GIVE WARNING MSG TO ISSUER OF    00752000
*                                      'SEND'                        */ 00753000
*   IF FSOURCE='00'B                /* HAS SOURCE OF SEND COMMAND  0222 00754000
*                                      BEEN DETERMINED               */ 00755000
*     THEN                                                         0222 00756000
WARNMSG  TM    FSOURCE(COMPTR),B'11000000'                         0222 00757000
         BZ    @RT00222                                            0222 00758000
*     GOTO CHKSRC;                  /* GO TO FIND SOURCE OF SEND COM.*/ 00759000
*SRCBK:                             /* SOURCE OF SEND CMD HAS BEEN 0224 00760000
*                                      FOUND                         */ 00761000
*   IF FCONSOL='1'B                 /* CHECK IF SENDER WAS OP.CONSOLE*/ 00762000
*     THEN                          /* CMD CAME FROM OPERATOR CONSOLE*/ 00763000
SRCBK    TM    FCONSOL(COMPTR),B'01000000'                         0224 00764000
         BNO   @RF00224                                            0224 00765000
*     DO;                           /* SET UP FOR WTO                */ 00766000
*       GMSAVE=GENTEXT;             /* SAVE MSG TEXT AND MSG ID      */ 00767000
         MVC   GMSAVE(210),GENTEXT                                 0226 00768000
*       IF GENLNG>WTOMAX            /* IF WARN MSG LENGTH > 72       */ 00769000
*         THEN                      /* YES, MSG LENGTH > 72          */ 00770000
         SLR   @10,@10                                             0227 00771000
         IC    @10,WTOMAX                                          0227 00772000
         CH    @10,GENLNG                                          0227 00773000
         BNL   @RF00227                                            0227 00774000
*         WTOLNG=WTOMAX+4;          /* SET WTO PARMLIST LENG TO MAX  */ 00775000
         AH    @10,@CH00135                                        0228 00776000
         STH   @10,WTOLNG                                          0228 00777000
*       ELSE                                                       0229 00778000
*         WTOLNG=GENLNG+4;          /* SET LENGTH OF WTO PARM LIST   */ 00779000
         B     @RC00227                                            0229 00780000
@RF00227 LA    @10,4                                               0229 00781000
         AH    @10,GENLNG                                          0229 00782000
         STH   @10,WTOLNG                                          0229 00783000
*       GENTEXT(1:WTOLNG-4)=GMSAVE(1:WTOLNG-4);/* MOVE TEXT          */ 00784000
@RC00227 LH    @10,WTOLNG                                          0230 00785000
         SH    @10,@CH00222                                        0230 00786000
         EX    @10,@SM00505                                        0230 00787000
*/*                                                                  */ 00788000
*/*   THE FOLLOWING CODE COPIES FIELDS FROM THE STATIC WTO PARMLIST  */ 00789000
*/*   TO THE DYNAMIC WTO LIST, 'WTOLIST'.  THIS CODE MUST CHANGE IF  */ 00790000
*/*   THE LIST FORM EXPANSION OF THE WTO MACRO CHANGES.              */ 00791000
*/*                                                                  */ 00792000
*                                                                  0231 00793000
*       GEN( MVC WTOMCSFL(2),WTOL+2 );/* SET MCS FLAGS TO INDIC    0231 00794000
*                                      CONSOLE ID IN REG 0           */ 00795000
          MVC WTOMCSFL(2),WTOL+2                                        00796000
*       RESTRICT(R5,R6);            /* RESTRICT COMPILER USE OF REGS */ 00797000
*       R5=WTOLNG;                  /* R5 = 1 BYTE PAST MSG TEXT IN     00798000
*                                      WTO LIST BUFFER AREA          */ 00799000
         LH    R5,WTOLNG                                           0233 00800000
*       R5=R5+ADDR(WTOLIST);        /* R5 = ADDR DESCRIPTOR CODE   0234 00801000
*                                      FIELD IN DYNAMIC WTO LIST     */ 00802000
         LA    @10,WTOLIST                                         0234 00803000
         ALR   R5,@10                                              0234 00804000
*       R6=ADDR(WTOL)+5;            /* R6 = ADDR DESCRIPTOR CODE IN     00805000
*                                      STATIC WTO PARM LIST          */ 00806000
         LA    R6,WTOL                                             0235 00807000
         AH    R6,@CH00222                                         0235 00808000
*       GEN( MVC 0(4,R5),0(R6) );   /* MOVE DESCRIPTOR CODES AND   0236 00809000
*                                      ROUTING CODES AFTER THE MSG 0236 00810000
*                                      TEXT IN WTO LIST              */ 00811000
          MVC 0(4,R5),0(R6)                                             00812000
*       RELEASE(R5,R6);             /* RELEASE COMPILER USE OF REGS  */ 00813000
*       R1=ADDR(WTOLIST);           /* SET REG1 = ADDR WTO PARMLIST  */ 00814000
         LA    R1,WTOLIST                                          0238 00815000
*       R0=CHUCMP;                  /* PUT CONSOLE ID INTO REG 0 FOR    00816000
*                                      WTO TO CONSOLE ISSUING 'SEND' */ 00817000
         L     @10,CSCBPTR-1(,COMPTR)                              0239 00818000
         LA    @10,0(,@10)                                         0239 00819000
         SLR   R0,R0                                               0239 00820000
         IC    R0,CHUCMP(,@10)                                     0239 00821000
*       GEN(WTO   ,MF=(E,(1))    ISSUE WTO TO SENDER    );         0240 00822000
         WTO   ,MF=(E,(1))    ISSUE WTO TO SENDER                       00823000
*       GMBEG=WTOMAX+1;             /* SET BEGINNING FOR NEXT WTO    */ 00824000
         LA    @10,1                                               0241 00825000
         SLR   @02,@02                                             0241 00826000
         IC    @02,WTOMAX                                          0241 00827000
         ALR   @02,@10                                             0241 00828000
         STC   @02,GMBEG                                           0241 00829000
*       WTOCNT=(GENLNG-9)/WTOMAX2;  /* COUNT OF WTO'S NEEDED         */ 00830000
         SLR   @02,@02                                             0242 00831000
         IC    @02,WTOMAX2                                         0242 00832000
         LH    @15,GENLNG                                          0242 00833000
         SH    @15,@CH00149                                        0242 00834000
         LR    @00,@15                                             0242 00835000
         SRDA  @00,32                                              0242 00836000
         DR    @00,@02                                             0242 00837000
         STC   @01,WTOCNT                                          0242 00838000
*       WTOREM=(GENLNG-9)//WTOMAX2; /* WTOREM = REMAINDER            */ 00839000
         LR    @04,@15                                             0243 00840000
         SRDA  @04,32                                              0243 00841000
         DR    @04,@02                                             0243 00842000
         STC   @04,WTOREM                                          0243 00843000
*       IF WTOREM^=0                /* TEST IF REMAINDER IS NONZERO  */ 00844000
*         THEN                      /* YES, THERE IS A REMAINDER     */ 00845000
         CLI   WTOREM,0                                            0244 00846000
         BE    @RF00244                                            0244 00847000
*         WTOCNT=WTOCNT+1;          /* ADD 1 TO CNT OF WTO'S NEEDED  */ 00848000
         ALR   @01,@10                                             0245 00849000
         STC   @01,WTOCNT                                          0245 00850000
*WTOLOOP2:                          /* ISSUE ANOTHER WTO             */ 00851000
*       WTOCNT=WTOCNT-1;            /* DECREMENT CNT OF WTO'S NEEDED */ 00852000
@RF00244 DS    0H                                                  0246 00853000
WTOLOOP2 SLR   @10,@10                                             0246 00854000
         IC    @10,WTOCNT                                          0246 00855000
         BCTR  @10,0                                               0246 00856000
         STC   @10,WTOCNT                                          0246 00857000
*       IF WTOCNT=0                 /* HAVE ALL WTO'S BEEN ISSUED    */ 00858000
*         THEN                      /* YES, ENTIRE MSG IS PUT OUT    */ 00859000
         CLI   WTOCNT,0                                            0247 00860000
         BE    @RT00247                                            0247 00861000
*         GOTO ROUTER;              /* GOTO ROUTE CONTROL            */ 00862000
*       ELSE                                                       0249 00863000
*         ;                         /* ISSUE ANOTHER WTO             */ 00864000
*       IF GENLNG>GMBEG+WTOMAX2     /* IS MSG LENGTH MORE THAN CAN BE   00865000
*                                      PUT OUT IN 1 MORE WTO         */ 00866000
*         THEN                      /* YES, 2 MORE WTO'S NEEDED      */ 00867000
         SLR   @10,@10                                             0250 00868000
         IC    @10,WTOMAX2                                         0250 00869000
         SLR   @02,@02                                             0250 00870000
         IC    @02,GMBEG                                           0250 00871000
         ALR   @02,@10                                             0250 00872000
         CH    @02,GENLNG                                          0250 00873000
         BNL   @RF00250                                            0250 00874000
*         GMEND=WTOMAX2;            /* SET END OF WTO MSG TO MAX     */ 00875000
         STC   @10,GMEND                                           0251 00876000
*       ELSE                        /* NO, 1 MORE WTO WILL DO IT     */ 00877000
*         GMEND=GENLNG-GMBEG+1;     /* SET END OF MSG TO REMAINDER   */ 00878000
*                                                                  0252 00879000
         B     @RC00250                                            0252 00880000
@RF00250 LH    @10,GENLNG                                          0252 00881000
         MVC   @ZT00003+3(1),GMBEG                                 0252 00882000
         SL    @10,@ZT00003                                        0252 00883000
         AH    @10,@CH00047                                        0252 00884000
         STC   @10,GMEND                                           0252 00885000
*       /*************************************************************/ 00886000
*       /*                                                           */ 00887000
*       /* PUT MSG INTO WTO PARMLIST                                 */ 00888000
*       /*                                                           */ 00889000
*       /*************************************************************/ 00890000
*                                                                  0253 00891000
*       GMTEXT(1:GMEND)=GMSAVE(GMBEG:GMBEG+GMEND-1);               0253 00892000
@RC00250 SLR   @10,@10                                             0253 00893000
         IC    @10,GMEND                                           0253 00894000
         LR    @02,@10                                             0253 00895000
         BCTR  @02,0                                               0253 00896000
         SLR   @01,@01                                             0253 00897000
         IC    @01,GMBEG                                           0253 00898000
         LA    @15,GMSAVE-1(@01)                                   0253 00899000
         EX    @02,@SM00507                                        0253 00900000
*       WTOLNG=GMEND+4+9;           /* SET WTO PARMLIST LENGTH       */ 00901000
         AH    @10,@CH00466                                        0254 00902000
         STH   @10,WTOLNG                                          0254 00903000
*/*                                                                  */ 00904000
*/*   THE FOLLOWING CODE COPIES FIELDS FROM THE STATIC WTO PARMLIST  */ 00905000
*/*   TO THE DYNAMIC WTO LIST, 'WTOLIST'.  THIS CODE MUST CHANGE IF  */ 00906000
*/*   THE LIST FORM EXPANSION OF THE WTO MACRO CHANGES.              */ 00907000
*/*                                                                  */ 00908000
*                                                                  0255 00909000
*       GEN( MVC WTOMCSFL(2),WTOL+2 );/* SET MCS FLAGS TO SAY CONSOLE   00910000
*                                      ID IN REG 0                   */ 00911000
          MVC WTOMCSFL(2),WTOL+2                                        00912000
*       RESTRICT(R5,R6);            /* RESTRICT COMPILER USE OF REGS */ 00913000
*       R5=WTOLNG;                  /* R5 = 1 BYTE PAST MSG TEXT IN     00914000
*                                      WTO LIST BUFFER AREA          */ 00915000
         LH    R5,WTOLNG                                           0257 00916000
*       R5=R5+ADDR(WTOLIST);        /* R5 = ADDR DESCRIPTOR CODE   0258 00917000
*                                      FIELD IN DYNAMIC WTO LIST     */ 00918000
         LA    @10,WTOLIST                                         0258 00919000
         ALR   R5,@10                                              0258 00920000
*       R6=ADDR(WTOL)+5;            /* R6 = ADDR DESCRIPTOR CODE IN     00921000
*                                      STATIC WTO PARM LIST          */ 00922000
         LA    R6,WTOL                                             0259 00923000
         AH    R6,@CH00222                                         0259 00924000
*       GEN( MVC 0(4,R5),0(R6) );   /* MOVE DESCRIPTOR CODES AND   0260 00925000
*                                      ROUTING CODES AFTER THE MSG 0260 00926000
*                                      TEXT IN WTO LIST              */ 00927000
          MVC 0(4,R5),0(R6)                                             00928000
*       RELEASE(R5,R6);             /* RELEASE COMPILER USE OF REGS  */ 00929000
*       R1=ADDR(WTOLIST);           /* SET REG1 = ADDR WTO PARMLIST  */ 00930000
         LA    R1,WTOLIST                                          0262 00931000
*       R0=CHUCMP;                  /* PUT CONSOLE ID INTO REG 0 FOR    00932000
*                                      WTO TO CONSOLE ISSUING 'SEND' */ 00933000
         L     @10,CSCBPTR-1(,COMPTR)                              0263 00934000
         LA    @10,0(,@10)                                         0263 00935000
         SLR   R0,R0                                               0263 00936000
         IC    R0,CHUCMP(,@10)                                     0263 00937000
*       GEN;                                                       0264 00938000
              WTO   ,MF=(E,(1))          ISSUE WTO TO SENDER            00939000
*       GMBEG=GMBEG+GMEND;          /* BUMP GMBEG FOR NEXT WTO       */ 00940000
         SLR   @10,@10                                             0265 00941000
         IC    @10,GMBEG                                           0265 00942000
         MVC   @ZT00003+3(1),GMEND                                 0265 00943000
         AL    @10,@ZT00003                                        0265 00944000
         STC   @10,GMBEG                                           0265 00945000
*       GOTO WTOLOOP2;              /* CHECK IF ANOTHER WTO NEEDED   */ 00946000
         B     WTOLOOP2                                            0266 00947000
*     END;                                                         0267 00948000
*   ELSE                            /* SOURCE OF SEND IS A TERMINAL  */ 00949000
*     DO;                           /* SET UP FOR TPUT               */ 00950000
@RF00224 DS    0H                                                  0269 00951000
*       RECTJID=CHASID;             /* SET ASID IN HI Y02676 ORDER 0269 00952000
*                                      HALF OF REG 0 FOR TPUT        */ 00953000
         L     @10,CSCBPTR-1(,COMPTR)                              0269 00954000
         LA    @10,0(,@10)                                         0269 00955000
         MVC   RECTJID(2),CHASID(@10)                              0269 00956000
*       R1=ADDR(GENTEXT);           /* REG1 = MSGTEXT ADDR FOR TPUT  */ 00957000
         LA    R1,GENTEXT                                          0270 00958000
*       R0=TPUTREG0;                /* REG0 = ASID - HI ORDER AND  0271 00959000
*                                      BUFFER SIZE - LO ORDER        */ 00960000
         L     R0,TPUTREG0                                         0271 00961000
*       GEN;                                                       0272 00962000
                TPUT  (1),(0),R     ISSUE TPUT TO OPERATOR TERMINAL     00963000
*       RETC=R15;                   /* SAVE RETURN CODE FROM TPUT    */ 00964000
         ST    R15,RETC                                            0273 00965000
*       IF RETC^=0                  /* CHECK RETURN CODE FROM TPUT   */ 00966000
*         THEN                      /* IF UNSUCCESSFUL TPUT          */ 00967000
         L     @10,RETC                                            0274 00968000
         LTR   @10,@10                                             0274 00969000
         BNZ   @RT00274                                            0274 00970000
*         GOTO BADTPUT;             /* ANALYZE ERROR CONDITION       */ 00971000
*     END;                                                         0276 00972000
*ROUTER:                            /* ROUTE CONTROL TO PROPER RTN   */ 00973000
*   GOTO EXITCODE;                  /* END PROCESSING              0277 00974000
*                                                                    */ 00975000
         B     EXITCODE                                            0277 00976000
*   GEN;                                                           0278 00977000
LISTBEG   DS    0F                     BEGINNING OF LIST FORMS          00978000
*  THE FOLLOWING WTO LIST FORM MUST NOT CHANGE WITHOUT CHANGING THE     00979000
*  CODE THAT MOVES THESE FIELDS INTO THE DYNAMIC 'WTOLIST' AREA         00980000
WTOL     WTO  'M',MF=L,DESC=5,MCSFLAG=(REG0)                            00981000
LISTEND  EQU   *                       END OF LIST FORMS                00982000
SPARE    DC    50X'00'              PATCH AREA                          00983000
*   END IEEVSND4                                                   0279 00984000
*                                                                  0279 00985000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00986000
*/*%INCLUDE SYSLIB  (IEECHAIN)                                       */ 00987000
*                                                                  0279 00988000
*       ;                                                          0279 00989000
         B     @EL00001                                            0279 00990000
@DATA    DS    0H                                                       00991000
@CH00047 DC    H'1'                                                     00992000
@CH00135 DC    H'4'                                                     00993000
@CH00222 DC    H'5'                                                     00994000
@CH00118 DC    H'7'                                                     00995000
@CH00042 DC    H'8'                                                     00996000
@CH00149 DC    H'9'                                                     00997000
@CH00466 DC    H'13'                                                    00998000
@CH00278 DC    XL2'08'                                                  00999000
@CH00451 DC    XL2'0C'                                                  01000000
@SM00468 MVC   GMTEXT(0),MSGFTEXT(@10)                                  01001000
@SM00470 MVC   0(0,@01),MSG1EXT(COMPTR)                                 01002000
@SM00473 MVC   GMTEXT(0),MSG1TEXT(@10)                                  01003000
@SM00476 MVC   0(0,@02),MSG2BEG(@15)                                    01004000
@SM00478 MVC   0(0,@02),MSG2END(@15)                                    01005000
@SM00481 MVC   GMTEXT(0),MSG8TEXT(@10)                                  01006000
@SM00484 MVC   GMTEXT(0),MSGATEXT(@10)                                  01007000
@SM00487 MVC   GMTEXT(0),MSG6TEXT(@10)                                  01008000
@SM00489 MVC   GMTEXT(0),MSG3TEXT(@10)                                  01009000
@SM00494 MVC   GMTEXT(0),MSG10TXT(@10)                                  01010000
@SM00496 MVC   GMTEXT(0),MSG11TXT(@10)                                  01011000
@SM00498 MVC   GMTEXT(0),MSG12TXT(@10)                                  01012000
@SM00501 MVC   GMTEXT(0),MSG9TEXT(@10)                                  01013000
@SM00505 MVC   GENTEXT(0),GMSAVE                                        01014000
@SM00507 MVC   GMTEXT(0),0(@15)                                         01015000
@DATD    DSECT                                                          01016000
         DS    0F                                                       01017000
@SA00001 DS    18F                                                      01018000
@PC00001 DS    1F                                                       01019000
@SAV001  EQU   @SA00001                                                 01020000
@TF00001 DS    F                                                        01021000
@ZTEMPS  DS    0F                                                       01022000
@ZT00003 DC    F'0'                                                     01023000
@ZTEMPND EQU   *                                                        01024000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         01025000
@TEMPS   EQU   @ZTEMPS                                                  01026000
@L       EQU   @ZLEN                                                    01027000
IEEVSND4 CSECT                                                          01028000
         DS    0F                                                       01029000
@DATD    DSECT                                                          01030000
         DS    0D                                                       01031000
TPUTREG0 DS    FL4                                                      01032000
         ORG   TPUTREG0                                                 01033000
RECTJID  DS    FL2                                                      01034000
GENLNG   DS    FL2                                                      01035000
         ORG   TPUTREG0+4                                               01036000
RETC     DS    A                                                        01037000
WTOCNT   DS    AL1                                                      01038000
WTOREM   DS    AL1                                                      01039000
GMBEG    DS    AL1                                                      01040000
GMEND    DS    AL1                                                      01041000
J        DS    AL1                                                      01042000
K        DS    AL1                                                      01043000
M        DS    AL1                                                      01044000
         DS    CL1                                                      01045000
WTOLIST  DS    CL223                                                    01046000
         ORG   WTOLIST                                                  01047000
WTOLNG   DS    FL2                                                      01048000
WTOMCS   DS    FL2                                                      01049000
         ORG   WTOMCS                                                   01050000
WTOMCSFL DS    BL1                                                      01051000
         ORG   WTOLIST+4                                                01052000
GENTEXT  DS    CL219                                                    01053000
         ORG   GENTEXT                                                  01054000
GMNUM    DS    CL9                                                      01055000
GMTEXT   DS    CL209                                                    01056000
         ORG   WTOLIST+223                                              01057000
GMSAVE   DS    CL210                                                    01058000
         DS    CL3                                                      01059000
WORK4    DS    CL4                                                      01060000
WORK8    DS    CL8                                                      01061000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01062000
@ENDDATD EQU   *                                                        01063000
@DATEND  EQU   *                                                        01064000
IEEVSND4 CSECT                                                          01065000
         DS    0F                                                       01066000
@SIZDATD DC    AL1(0)                                                   01067000
         DC    AL3(@ENDDATD-@DATD)                                      01068000
@SIZ001  EQU   @SIZDATD                                                 01069000
@CA00171 DC    A(MSGTABLE)                                              01070000
         DS    0D                                                       01071000
WTOMAX   DC    AL1(72)                                                  01072000
WTOMAX2  DC    AL1(63)                                                  01073000
WTNLNG   DC    AL1(9)                                                   01074000
WTODESC  DC    X'08000000'                                              01075000
BLNKID   DC    CL8'        '                                            01076000
SDERR    DC    X'80'                                                    01077000
NOCORE   DC    X'40'                                                    01078000
BADFMT   DC    X'10'                                                    01079000
IOERR    DC    X'08'                                                    01080000
OPENERR  DC    X'02'                                                    01081000
DSFULL   DC    X'01'                                                    01082000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01083000
@01      EQU   01                                                       01084000
@02      EQU   02                                                       01085000
@03      EQU   03                                                       01086000
@04      EQU   04                                                       01087000
@05      EQU   05                                                       01088000
@06      EQU   06                                                       01089000
@07      EQU   07                                                       01090000
@08      EQU   08                                                       01091000
@09      EQU   09                                                       01092000
@10      EQU   10                                                       01093000
@11      EQU   11                                                       01094000
@12      EQU   12                                                       01095000
@13      EQU   13                                                       01096000
@14      EQU   14                                                       01097000
@15      EQU   15                                                       01098000
@0       EQU   00                                                       01099000
@1       EQU   01                                                       01100000
@2       EQU   02                                                       01101000
@3       EQU   03                                                       01102000
@4       EQU   04                                                       01103000
@5       EQU   05                                                       01104000
@6       EQU   06                                                       01105000
@7       EQU   07                                                       01106000
@8       EQU   08                                                       01107000
@9       EQU   09                                                       01108000
@A       EQU   10                                                       01109000
@B       EQU   11                                                       01110000
@C       EQU   12                                                       01111000
@D       EQU   13                                                       01112000
@E       EQU   14                                                       01113000
@F       EQU   15                                                       01114000
COMPTR   EQU   @03                                                      01115000
R0       EQU   @00                                                      01116000
R1       EQU   @01                                                      01117000
R5       EQU   @05                                                      01118000
R6       EQU   @06                                                      01119000
R15      EQU   @15                                                      01120000
         EXTRN MSGTABLE                                                 01121000
COMMON   EQU   0                                                        01122000
COMMONA  EQU   COMMON                                                   01123000
MSGFLAGS EQU   COMMONA+3                                                01124000
FMSG2    EQU   MSGFLAGS                                                 01125000
FMSG3    EQU   MSGFLAGS                                                 01126000
FMSG4    EQU   MSGFLAGS                                                 01127000
FMSG5    EQU   MSGFLAGS                                                 01128000
FMSG6    EQU   MSGFLAGS                                                 01129000
FMSG8    EQU   MSGFLAGS                                                 01130000
FMSGA    EQU   MSGFLAGS                                                 01131000
FLAGS    EQU   COMMONA+4                                                01132000
FANYINV  EQU   FLAGS                                                    01133000
FBADSEND EQU   FLAGS                                                    01134000
FOVER20  EQU   FLAGS                                                    01135000
@NM00002 EQU   FLAGS+1                                                  01136000
FMAILFL  EQU   @NM00002                                                 01137000
@NM00003 EQU   FLAGS+2                                                  01138000
@NM00004 EQU   FLAGS+3                                                  01139000
FSOURCE  EQU   @NM00004                                                 01140000
FTERM    EQU   FSOURCE                                                  01141000
FCONSOL  EQU   FSOURCE                                                  01142000
FMSG1    EQU   @NM00004                                                 01143000
FBADIO   EQU   @NM00004                                                 01144000
FBADRITA EQU   @NM00004                                                 01145000
FBADTPUT EQU   @NM00004                                                 01146000
M1IND    EQU   COMMONA+8                                                01147000
IDCNT    EQU   COMMONA+12                                               01148000
SDIORC   EQU   COMMONA+16                                               01149000
CSCBPTR  EQU   COMMONA+21                                               01150000
CBCMSGNO EQU   COMMONA+32                                               01151000
MSG1EXT  EQU   COMMONA+36                                               01152000
COMMONB  EQU   COMMON+160                                               01153000
COMMONC  EQU   COMMON+284                                               01154000
IDUSRID  EQU   COMMONC                                                  01155000
SDIOPARM EQU   COMMON+452                                               01156000
@NM00006 EQU   SDIOPARM                                                 01157000
@NM00007 EQU   SDIOPARM+1                                               01158000
MSG1     EQU   0                                                        01159000
MSG1WTN  EQU   MSG1+9                                                   01160000
MSG1LNG  EQU   MSG1+20                                                  01161000
MSG1TEXT EQU   MSG1+21                                                  01162000
MSG2     EQU   0                                                        01163000
MSG2WTN  EQU   MSG2+9                                                   01164000
MSG2BEGL EQU   MSG2+16                                                  01165000
MSG2BEG  EQU   MSG2+17                                                  01166000
MSG2ENDL EQU   MSG2+25                                                  01167000
MSG2END  EQU   MSG2+26                                                  01168000
MSG3     EQU   0                                                        01169000
MSG3WTN  EQU   MSG3+9                                                   01170000
MSG3LNG  EQU   MSG3+16                                                  01171000
MSG3TEXT EQU   MSG3+17                                                  01172000
MSG4     EQU   0                                                        01173000
MSG4WTN  EQU   MSG4+9                                                   01174000
MSG4LNG  EQU   MSG4+16                                                  01175000
MSG4TEXT EQU   MSG4+17                                                  01176000
MSG4SECT EQU   MSG4+52                                                  01177000
MSG4MAIL EQU   MSG4+53                                                  01178000
MSG4NOTI EQU   MSG4+58                                                  01179000
MSGE     EQU   0                                                        01180000
MSGEWTN  EQU   MSGE+9                                                   01181000
MSGELNG  EQU   MSGE+16                                                  01182000
MSGETEXT EQU   MSGE+17                                                  01183000
MSGF     EQU   0                                                        01184000
MSGFWTN  EQU   MSGF+9                                                   01185000
MSGFLNG  EQU   MSGF+16                                                  01186000
MSGFTEXT EQU   MSGF+17                                                  01187000
MSG10    EQU   0                                                        01188000
MSG10WTN EQU   MSG10+9                                                  01189000
MSG10LNG EQU   MSG10+16                                                 01190000
MSG10TXT EQU   MSG10+17                                                 01191000
MSG11    EQU   0                                                        01192000
MSG11WTN EQU   MSG11+9                                                  01193000
MSG11LNG EQU   MSG11+16                                                 01194000
MSG11TXT EQU   MSG11+17                                                 01195000
MSG12    EQU   0                                                        01196000
MSG12WTN EQU   MSG12+9                                                  01197000
MSG12LNG EQU   MSG12+16                                                 01198000
MSG12TXT EQU   MSG12+17                                                 01199000
MSG6     EQU   0                                                        01200000
MSG6WTN  EQU   MSG6+9                                                   01201000
MSG6LNG  EQU   MSG6+16                                                  01202000
MSG6TEXT EQU   MSG6+17                                                  01203000
MSG8     EQU   0                                                        01204000
MSG8WTN  EQU   MSG8+9                                                   01205000
MSG8LNG  EQU   MSG8+16                                                  01206000
MSG8TEXT EQU   MSG8+17                                                  01207000
MSG9     EQU   0                                                        01208000
MSG9WTN  EQU   MSG9+9                                                   01209000
MSG9LNG  EQU   MSG9+16                                                  01210000
MSG9TEXT EQU   MSG9+17                                                  01211000
MSGA     EQU   0                                                        01212000
MSGAWTN  EQU   MSGA+9                                                   01213000
MSGALNG  EQU   MSGA+16                                                  01214000
MSGATEXT EQU   MSGA+17                                                  01215000
CHAIN    EQU   0                                                        01216000
CHFLG    EQU   CHAIN+4                                                  01217000
CHSTS    EQU   CHFLG+2                                                  01218000
CHACT    EQU   CHFLG+3                                                  01219000
CHKEY    EQU   CHAIN+8                                                  01220000
CHPKE    EQU   CHAIN+28                                                 01221000
CHUCMP   EQU   CHAIN+29                                                 01222000
CHTJID   EQU   CHAIN+30                                                 01223000
CHASID   EQU   CHTJID                                                   01224000
CHACT1   EQU   CHAIN+35                                                 01225000
CHASM    EQU   CHAIN+40                                                 01226000
CHCIBP   EQU   CHASM+4                                                  01227000
CHRGNSZ  EQU   CHASM+8                                                  01228000
CHSHORT  EQU   CHASM+24                                                 01229000
CHSWT    EQU   CHSHORT                                                  01230000
COMMONPT EQU   0                                                        01231000
MSG1P    EQU   MSGTABLE                                                 01232000
MSG2P    EQU   MSGTABLE+4                                               01233000
MSG3P    EQU   MSGTABLE+8                                               01234000
MSG4P    EQU   MSGTABLE+12                                              01235000
MSG6P    EQU   MSGTABLE+20                                              01236000
MSG8P    EQU   MSGTABLE+28                                              01237000
MSG9P    EQU   MSGTABLE+32                                              01238000
MSGAP    EQU   MSGTABLE+36                                              01239000
MSGEP    EQU   MSGTABLE+52                                              01240000
MSGFP    EQU   MSGTABLE+56                                              01241000
MSG10P   EQU   MSGTABLE+60                                              01242000
MSG11P   EQU   MSGTABLE+64                                              01243000
MSG12P   EQU   MSGTABLE+68                                              01244000
MSG8INS  EQU   GMTEXT+18                                                01245000
CHAINS01 EQU   CHASM                                                    01246000
CHTYPE   EQU   CHAINS01+124                                             01247000
CHTRSTAT EQU   CHAINS01+125                                             01248000
CHCSYSO  EQU   CHAINS01+134                                             01249000
MSG5P    EQU   MSGTABLE+16                                              01250000
*                                      START UNREFERENCED COMPONENTS    01251000
CHLAST   EQU   CHAINS01+136                                             01252000
CHSPA    EQU   CHAINS01+135                                             01253000
CHUSERID EQU   CHCSYSO                                                  01254000
CHJB     EQU   CHCSYSO                                                  01255000
CHDUMP   EQU   CHCSYSO                                                  01256000
CHQUE    EQU   CHCSYSO                                                  01257000
CHHOLD   EQU   CHCSYSO                                                  01258000
CHOUT    EQU   CHCSYSO                                                  01259000
CHINN    EQU   CHCSYSO                                                  01260000
CHALL    EQU   CHCSYSO                                                  01261000
CHINC    EQU   CHAINS01+132                                             01262000
CHPEND   EQU   CHAINS01+128                                             01263000
CHARID   EQU   CHAINS01+127                                             01264000
CHCNID   EQU   CHAINS01+126                                             01265000
@NM00026 EQU   CHTRSTAT                                                 01266000
CHTSL    EQU   CHTRSTAT                                                 01267000
CHTS     EQU   CHTRSTAT                                                 01268000
CHINITL  EQU   CHTRSTAT                                                 01269000
CHINIT   EQU   CHTRSTAT                                                 01270000
CHJOBSL  EQU   CHTRSTAT                                                 01271000
CHJOBS   EQU   CHTRSTAT                                                 01272000
CHDEF    EQU   CHTYPE                                                   01273000
CHHIAR   EQU   CHTYPE                                                   01274000
CHARSV29 EQU   CHTYPE                                                   01275000
CHARSV28 EQU   CHTYPE                                                   01276000
CHARSV27 EQU   CHTYPE                                                   01277000
CHARSV26 EQU   CHTYPE                                                   01278000
CHARSV25 EQU   CHTYPE                                                   01279000
CHDSTAT  EQU   CHTYPE                                                   01280000
CHBUF    EQU   CHAINS01                                                 01281000
CHARSV16 EQU   CHSHORT+108                                              01282000
CHARSV15 EQU   CHSHORT+104                                              01283000
CHJSCBVS EQU   CHSHORT+100                                              01284000
CHUSCVS  EQU   CHSHORT+96                                               01285000
@NM00025 EQU   CHSHORT+92                                               01286000
@NM00024 EQU   CHSHORT+88                                               01287000
CHSQA    EQU   CHSHORT+52                                               01288000
CHQPA    EQU   CHSHORT+16                                               01289000
CHJCL    EQU   CHSHORT+12                                               01290000
CHSPC    EQU   CHSHORT+8                                                01291000
CHSPB    EQU   CHSHORT+4                                                01292000
CHTCB    EQU   CHSHORT+1                                                01293000
CHARSV23 EQU   CHSWT                                                    01294000
CHARSV22 EQU   CHSWT                                                    01295000
CHARSV21 EQU   CHSWT                                                    01296000
CHAC     EQU   CHSWT                                                    01297000
CHPSF    EQU   CHSWT                                                    01298000
CHPSD    EQU   CHSWT                                                    01299000
CHJCT    EQU   CHSWT                                                    01300000
CHARSV20 EQU   CHSWT                                                    01301000
CHCECB   EQU   CHASM+20                                                 01302000
CHECB    EQU   CHASM+16                                                 01303000
CHRGNAD  EQU   CHASM+12                                                 01304000
CHARSV18 EQU   CHRGNSZ+1                                                01305000
CHRPRTY  EQU   CHRGNSZ                                                  01306000
@NM00023 EQU   CHCIBP                                                   01307000
CHEND    EQU   CHCIBP                                                   01308000
CHECBP   EQU   CHASM                                                    01309000
CHDER    EQU   CHAIN+36                                                 01310000
CHARSV10 EQU   CHACT1                                                   01311000
CHARSV09 EQU   CHACT1                                                   01312000
CHARSV08 EQU   CHACT1                                                   01313000
CHARSV07 EQU   CHACT1                                                   01314000
CHARSV06 EQU   CHACT1                                                   01315000
CHARSV05 EQU   CHACT1                                                   01316000
CHARSV04 EQU   CHACT1                                                   01317000
CHRDWTR  EQU   CHACT1                                                   01318000
CHARSV30 EQU   CHAIN+34                                                 01319000
CHQID    EQU   CHAIN+32                                                 01320000
CHTRKID  EQU   CHPKE                                                    01321000
CHCIBCTR EQU   CHAIN+27                                                 01322000
CHUNIT   EQU   CHAIN+24                                                 01323000
CHCLS    EQU   CHAIN+16                                                 01324000
CHPARM   EQU   CHKEY                                                    01325000
CHIFY    EQU   CHACT                                                    01326000
CHAIFX   EQU   CHACT                                                    01327000
CHCLD    EQU   CHACT                                                    01328000
CHCL     EQU   CHACT                                                    01329000
CHDSI    EQU   CHACT                                                    01330000
CHDISC   EQU   CHACT                                                    01331000
CHTERM   EQU   CHACT                                                    01332000
CHSWAP   EQU   CHACT                                                    01333000
CHABTERM EQU   CHSTS                                                    01334000
CHFC     EQU   CHSTS                                                    01335000
CHDL     EQU   CHSTS                                                    01336000
CHAD     EQU   CHSTS                                                    01337000
CHQSPC   EQU   CHSTS                                                    01338000
CHSOUT   EQU   CHSTS                                                    01339000
CHSYS    EQU   CHSTS                                                    01340000
CHAP     EQU   CHSTS                                                    01341000
CHSZE    EQU   CHFLG+1                                                  01342000
CHVCD    EQU   CHFLG                                                    01343000
CHPTR    EQU   CHAIN                                                    01344000
@NM00022 EQU   MSGA                                                     01345000
@NM00021 EQU   MSG9                                                     01346000
@NM00020 EQU   MSG8                                                     01347000
@NM00019 EQU   MSG6                                                     01348000
@NM00018 EQU   MSG12                                                    01349000
@NM00017 EQU   MSG11                                                    01350000
@NM00016 EQU   MSG10                                                    01351000
@NM00015 EQU   MSGF                                                     01352000
@NM00014 EQU   MSGE                                                     01353000
@NM00013 EQU   MSG4+66                                                  01354000
@NM00012 EQU   MSG4                                                     01355000
@NM00011 EQU   MSG3                                                     01356000
@NM00010 EQU   MSG2                                                     01357000
@NM00009 EQU   MSG1+16                                                  01358000
@NM00008 EQU   MSG1                                                     01359000
PARMRCD1 EQU   COMMON+480                                               01360000
PARMDCB  EQU   COMMON+476                                               01361000
PARMLMCT EQU   COMMON+472                                               01362000
PARMDDNM EQU   SDIOPARM+12                                              01363000
PARMIOAD EQU   SDIOPARM+8                                               01364000
PARMRBA  EQU   SDIOPARM+4                                               01365000
PARMFDBK EQU   SDIOPARM+3                                               01366000
PARMKEY  EQU   SDIOPARM+2                                               01367000
P2DEVAD  EQU   @NM00007                                                 01368000
P2DEL    EQU   @NM00007                                                 01369000
P2CLOSE  EQU   @NM00007                                                 01370000
P2WRDAF  EQU   @NM00007                                                 01371000
P2WRDI   EQU   @NM00007                                                 01372000
P1READ1  EQU   @NM00006                                                 01373000
P1CREATE EQU   @NM00006                                                 01374000
P1READ   EQU   @NM00006                                                 01375000
P1OPEN   EQU   @NM00006                                                 01376000
@NM00005 EQU   COMMONC+167                                              01377000
OPERID   EQU   COMMONC+160                                              01378000
COMBUF   EQU   COMMONB                                                  01379000
CBCCONID EQU   COMMONA+34                                               01380000
ACCESSOR EQU   COMMONA+29                                               01381000
TEXTLENG EQU   COMMONA+28                                               01382000
COMBUFP  EQU   COMMONA+25                                               01383000
COMI     EQU   COMMONA+24                                               01384000
TBEG     EQU   COMMONA+20                                               01385000
RETVATT1 EQU   COMMONA+17                                               01386000
IDTBL    EQU   COMMONA+13                                               01387000
MSG1EXTP EQU   COMMONA+9                                                01388000
FWTO2    EQU   @NM00004                                                 01389000
FERRSYN  EQU   @NM00004                                                 01390000
FERRID   EQU   @NM00003                                                 01391000
FTEXT    EQU   @NM00003                                                 01392000
FALL     EQU   @NM00003                                                 01393000
FLOGON   EQU   @NM00003                                                 01394000
FNOW     EQU   @NM00003                                                 01395000
FLIST    EQU   @NM00003                                                 01396000
FLISTALL EQU   @NM00003                                                 01397000
FDEL     EQU   @NM00003                                                 01398000
FCNS     EQU   @NM00002                                                 01399000
FUSER    EQU   @NM00002                                                 01400000
FBRDCST  EQU   @NM00002                                                 01401000
FMN      EQU   @NM00002                                                 01402000
FADDBC   EQU   @NM00002                                                 01403000
FYESBCM  EQU   @NM00002                                                 01404000
FNOMSG   EQU   @NM00002                                                 01405000
FLISTING EQU   FLAGS                                                    01406000
FENDUSL  EQU   FLAGS                                                    01407000
FUPUSD   EQU   FLAGS                                                    01408000
FCHNMSG  EQU   FLAGS                                                    01409000
FOPEN    EQU   FLAGS                                                    01410000
FMSG9    EQU   MSGFLAGS                                                 01411000
VALCNT   EQU   COMMONA+2                                                01412000
TPUTRC   EQU   COMMONA+1                                                01413000
@NM00001 EQU   COMMONA                                                  01414000
*                                      END UNREFERENCED COMPONENTS      01415000
@RT00069 EQU   ANYINV                                                   01416000
@RT00071 EQU   MSG1OUT                                                  01417000
@RT00073 EQU   INV2                                                     01418000
@RT00075 EQU   ERRSYN                                                   01419000
@RT00077 EQU   ERR4                                                     01420000
@RT00079 EQU   WMSG6                                                    01421000
@RT00081 EQU   MSG8OUT                                                  01422000
@RT00083 EQU   MSGAOUT                                                  01423000
@RT00085 EQU   MSGEOUT                                                  01424000
@RT00087 EQU   BADTPUT                                                  01425000
@RT00089 EQU   BADIO                                                    01426000
@RT00091 EQU   BADRITA                                                  01427000
EXIT3    EQU   @EL00001                                                 01428000
@RT00105 EQU   IDLP4                                                    01429000
@RC00157 EQU   WARNMSG                                                  01430000
@RF00200 EQU   BADSEND                                                  01431000
@RT00208 EQU   EXITCODE                                                 01432000
@RT00211 EQU   EXIT3                                                    01433000
@RC00218 EQU   SRCBK                                                    01434000
@RT00222 EQU   CHKSRC                                                   01435000
@RT00274 EQU   BADTPUT                                                  01436000
ROUTER   EQU   EXITCODE                                                 01437000
@RT00247 EQU   ROUTER                                                   01438000
@EL01    EQU   @EL00001                                                 01439000
@ENDDATA EQU   *                                                        01440000
         END   IEEVSND4                                                 01441000
