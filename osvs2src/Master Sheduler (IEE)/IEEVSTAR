         TITLE 'IEEVSTAR-- START SYNTAX CHECK'                          00062002
*********************************************************************** 00064002
*                                                                       00070002
*  MODULE NAME = IEEVSTAR                                               00080002
*                                                                       00090002
*  DESCRIPTIVE NAME = START COMMAND SYNTAX CHECK ROUTINE                00100002
*                                                                       00102002
*  COPYRIGHT = NONE                                                     00104002
*                                                                       00106002
*  STATUS = OS/VS2 RELEASE 037                                 @ZA30542 00108003
*           IN THIS MODULE, SU16 SUPPORTS                      @G16APPJ 00108203
*           VPSS SUPPORT (SU 29 - @G29AN2F) AND                @G16APPJ 00108303
*           RACF VERSION 2 (SU 32 - @G32MPPJ).                 @G16APPJ 00108403
*                                                                       00108503
*                                                                       00108603
*                                                                       00108703
*  FUNCTION = SYNTAX CHECK THE START COMMAND PARAMETERS AND BUILD       00108802
*             A START DESCRIPTOR TABLE (SDT) CONTAINING THE INTERNAL    00109202
*             JCL FOR THE TASK TO BE STARTED.                           00109602
*                                                                       00109702
*    OPERATION = GET CSCB POINTER FROM THE ASCB.                 Y02669 00109802
*                                                                       00109902
*              . ISSUE GETMAIN FOR THE SDT.                             00113202
*                                                                       00115202
*              . SET LENGTH FIELDS IN SDT TO ZERO; INITIALIZE REST      00117202
*                OF SDT WITH BLANKS.                                    00119202
*                                                                       00119602
*              . CHECK IF ANY START COMMAND PARAMETERS WERE SPECIFIED.  00119702
*                IF NO PARAMETERS, SET ERROR CODE AND GO TO ERROR       00119802
*                EXIT ROUTINE.                                          00119902
*                                                                       00123202
*              . SYNTAX CHECK START COMMAND PARAMETERS. (FOR ERROR      00125202
*                CONDITIONS, SET ERROR CODE AND ENTER THE ERROR         00127202
*                EXIT ROUTINE):                                         00129202
*                                                                       00129602
*                -BUILD THE JOB CARD JCL STATEMENT IN THE SDT.  IF      00129702
*                 THE PROCNAME SPECIFIED ON THE START COMMAND IS        00129802
*                 VALID, IT IS USED AS THE JOBNAME.  PROCNAME IS ALSO   00129902
*                 SAVED IN THE CSCB.                                    00133202
*                                                                       00135202
*                -SET POINTER TO THE CSCB JOBNAME FIELD(JOBNAME  Y02677 00137202
*                 IS THE START COMMAND PROCNAME) IN THE ASCB.    Y02677 00139202
*                                                                       00139602
*                -BUILD THE EXEC CARD JCL STATEMENT IN THE SDT.         00139702
*                 IF AN ID (TASKNAME) HAS BEEN SPECIFIED ON THE         00139802
*                 START COMMAND AND IS VALID, USE ID AS STEP NAME       00139902
*                 ON THE EXEC CARD.  SAVE ID IN THE CSCB.  IF NO        00143202
*                 TASKNAME IS SPECIFIED ON START COMMAND, USE           00145202
*                 'STARTING' AS STEPNAME ON EXEC CARD AND IN CSCB.      00147202
*                                                                       00149202
*                -IF UNIT PARAMETER HAS BEEN SPECIFIED ON START         00149602
*                 COMMAND AND IS VALID, BUILD '//IEFPROC.IEFDRER DD'    00149702
*                 CARD TO OVERIDE IEFRDER CARD IN THE STARTING          00149802
*                 PROCEDURE.                                            00149902
*                                                                       00153202
*                -IF VOLUME SERIAL HAS BEEN SPECIFIED AND IS VALID,     00155202
*                 MOVE IT TO SDT IEFRDER DD CARD.                       00157202
*                                                                       00159202
*                -SCAN FOR AND SYNTAX CHECK KEYWORD=OPTION              00159602
*                 PARAMETERS.  MAJOR DD KEYWORDS ON THE START           00159702
*                 COMMAND ARE MOVED TO THE SDT IEFRDER DD CARD.         00159802
*                 OTHER KEYWORDS ARE ASSUMED TO BE SYMBOLIC             00159902
*                 PARAMETERS AND ARE MOVED TO THE SDT EXEC CARD.        00163202
*                                                                       00165202
*              . A COMMAND INPUT BUFFER IS GOTTEN AND INITIALIZED       00167202
*                WITH 'PARMVALUE' IF SPECIFIED ON THE START             00169202
*                COMMAND.  ENQUEUE ON THE CSCB RESOURCE WHEN     Y02651 00169602
*                UPDATING THE POINTER TO THE CIB IN THE CSCB.    Y02651 00169702
*                                                                       00169802
*              . AT THE END OF THE PARAMETER SCAN:                      00169902
*                                                                       00173202
*                -SET SDT SIZE.                                         00175202
*                                                                       00177202
*                -UPDATE CSCB WITH START COMMAND RELATED INFORMATION.   00179202
*                                                                       00179602
*                -CLEAR CANCEL AND CHAIN ECBS IN CSCB; INITIALIZE       00179702
*                 CHAIN ECB POINTER.                                    00179802
*                                                                       00179902
*                -GET AND INITIALIZE IEEVJCL PARAMETER LIST.            00183202
*                                                                       00185202
*                -BRANCH TO IEEVJCL - THE JOB CONTROL LANGUAGE          00187202
*                 SET BUILD ROUTINE, WITH REGISTER 1 POINTING           00189202
*                 TO THE PARAMETER LIST.                                00189602
*                                                                       00189702
*              . IF AN ERROR HAS BEEN DETECTED WHILE SYNTAX CHECKING    00189802
*                START COMMAND PARAMETERS, THE ERROR EXIT ROUTINE:      00189902
*                                                                       00193202
*                -STORES THE ERROR CODE IN THE EXTENDED SAVE AREA       00195202
*                 (XSA), WHICH OVERLAYS THE CORE GOTTEN FOR THE SDT.    00197202
*                                                                       00199202
*                -MOVES THE VERB (START) INTO THE XSA FOR MESSAGE FILL. 00199602
*                                                                       00199702
*                -LINKS TO IEE0503D MESSAGE MODULE TO ISSUE MESSAGE.    00199802
*                                                                       00199902
*                -FREES THE START DESCRIPTOR TABLE.                     00203202
*                                                                       00205202
*                -XCTLS TO IEEPRTN2 FREE REGION ROUTINE TO CLEAN UP     00207202
*                 STARTED TASK CONTROL RESOURCES.  REGISTER 1    Y02669 00209202
*                 POINTS TO THE ASCB FOR THIS MEMORY.            Y02669 00209602
*                                                                       00209702
*  NOTES:                                                               00209802
*    DEPENDENCIES = CSCB ENQUEUE RESOURCE SYSIEFSD/Q10           Y02651 00209902
*      CHARACTER-CODE DEPENDENCIES = EBCDIC                             00213202
*    RESTRICTIONS = NONE                                                00215202
*    REGISTER CONVENTIONS = STANDARD (SEE CODE FOR REGISTER EQUATES)    00217202
*                           IEEVSTAR DOES NOT SAVE OR RESTORE REGISTERS 00219202
*    PATCH-LABEL = STCPATCH - RESERVED FOR FUTURE USE.                  00219602
*                                                                       00219702
*  MODULE TYPE = CSECT                                                  00219802
*    PROCESSOR = ASSEMBLER                                              00219902
*    MODULE SIZE = APPROXIMATELY D00 BYTES.                             00223202
*    ATTRIBUTES = PAGED LPA, KEY ZERO, SUPERVISOR STATE,                00225202
*                 REENTRANT, REFRESHABLE                                00227202
*                                                                       00229202
*  ENTRY POINT = IEEVSTAR                                               00229602
*    PURPOSE = SEE FUNCTION ABOVE                                       00229702
*    LINKAGE = XCTL FROM IEEPRWI2 - STC GET REGION ROUTINE              00229802
*    INPUT = REGISTER 1 POINTS TO ASCB FOR STC'S MEMORY          Y02669 00229902
*                                                                       00233202
*  EXIT-NORMAL = IEEVJCL, JCLS BUILD ROUTINE, VIA BRANCH                00235202
*    CONDITIONS = VALID START COMMAND WITH INTERNAL JCL BUILT           00237202
*                 IN SDT.                                               00239202
*    OUTPUT = REGISTER 1 POINTS TO PARAMETER LIST CONTAINING:    Y02669 00239602
*              WORD 1 - SUBPOOL NUMBER AND PARAMETER LIST LENGTH Y02669 00239702
*              WORD 2 - ASCB POINTER                             Y02669 00239802
*              WORD 3 - SDT POINTER                              Y02669 00239902
*              WORD 4 - RESERVED                                 Y02669 00243202
*    RETURN CODES = NONE                                                00245202
*                                                                       00247202
*  EXIT-ERROR = IEEPRTN2, STC FREE REGION ROUTINE, VIA XCTL             00249202
*    CONDITIONS = START COMMAND SYNTAX ERROR.  EXIT TO CLEAN            00249602
*                 UP STC RESOURCES.                                     00249702
*    OUTPUT = REGISTER 1 POINTS TO ASCB FOR STC'S MEMORY         Y02669 00249802
*    RETURN CODES = NONE                                                00249902
*                                                                       00253202
*  EXTERNAL REFERENCES:                                                 00255202
*    ROUTINES = IEE0503D, MESSAGE MODULE, VIA LINK                      00257202
*               ISSUE START COMMAND ERROR MESSAGES.                     00259202
*    DATA AREAS = PARAMETER LIST PASSED TO IEEVJCL (SUBPOOL 0)   Y02669 00259602
*    CONTROL BLOCKS = ASCB  - READ                               YO2669 00259702
*                     CSCB  - READ, WRITE                               00259902
*                     CIB   - CREATE(SUBPOOL 245),WRITE                 00263202
*                     CVT   - READ                             @G29AN2F 00265203
*                     SDT   - CREATE(SUBPOOL   0),WRITE                 00265703
*                     SUBIT - READ                             @G29AN2F 00266203
*                     XSA   - WRITE                                     00267202
*                                                                       00269202
*  TABLES = XSA MAPS SDT CORE AS WORK AREA FOR ERROR MESSAGE            00269602
*           PROCESSING.                                                 00269702
*                                                                       00269802
*  MACROS = GETMAIN, FREEMAIN, LINK, XCTL, ENQUEUE, DEQUEUE      Y02669 00269902
*    SERIALIZATION = SYSIEFSD/Q10 (CSCB ENQUEUE RESOURCE)        Y02651 00273202
*                                                                       00275202
*  CHANGE ACTIVITY = YO2669, Y02677, YO2651, Y30LPTV, Y30OPTV, Z40MPSS  00277203
*                    ZA03646, G29AN2E, G29AN2F, G32HPPJ        @G32HPPJ 00277803
*                    ZA17322, ZA28715, ZA30542                 @ZA30542 00278403
*  ABEND CODES = NONE                                                   00279003
*                                                                       00279603
*********************************************************************** 00280203
* A 12950904-12968004                                          @Z40MPSS 00280803
* C CHANGE HYPHEN TO VALID CHAR                                @ZA17322 00281403
* C - VST500 - EXTEND CSCB ENQ OVER FULL INITIALIZATION        @ZA28715 00281703
* THIS APAR SUPPORTS MERGE OF SU 10,16 CODE TO REL 037 BASE    @ZA30542 00282003
         EJECT                                                          00283202
IEEVSTAR CSECT                                                          03170320
*********************************************************************** 03240000
*  REGISTER ASSIGNMENTS                                                 03260000
*********************************************************************** 03280000
R0       EQU   0                  PARAMETER PASS REGISTER.              03300000
R1       EQU   1                  INPUT PTR TO CHAIN - USED IN TRT INST 03320000
R2       EQU   2                  FUNCTION BYTE RETURN FROM TRT.        03340000
R3       EQU   3                  WORK REGISTER.                        03360000
R4       EQU   4                  WORK REGISTER.                        03380000
R5       EQU   5                  WORK REGISTER.                        03400000
R6       EQU   6                  WORK REGISTER.                        03420000
R7       EQU   7                  WORK REGISTER.                        03440000
R8       EQU   8                  WORK REGISTER.                        03460000
R9       EQU   9                  WORK REGISTER.                        03480000
R10      EQU   10                 SDT BASE REGISTER.                    03500000
R11      EQU   11                 CHAIN BASE REGISTER.                  03520000
RBASE    EQU   12                 BASE REGISTER.                        03540000
R13      EQU   13                                                  I272 03560019
R14      EQU   14                 RETURN REGISTER.                      03580000
R15      EQU   15                 LINK REGISTER.                        03600000
D0       EQU   0                   USED FOR OFFSETS,LENGTHS,ETC.   I272 03601019
D1       EQU   1                                                   I272 03602019
D2       EQU   2                                                   I272 03603019
D3       EQU   3                                                   I272 03604019
D4       EQU   4                                                   I272 03605019
D5       EQU   5                                                   I272 03606019
D8       EQU   8                                                   I272 03607019
D23      EQU   23                                                  I272 03608019
D24      EQU   24                                                  I272 03609019
D128     EQU   128                                                 I272 03610019
D256     EQU   256                                                 I272 03611019
CBLANK   EQU   C' '                                                I272 03612019
POSTBIT  EQU   X'40'               POST ECB BIT                  A26309 03619219
         EJECT                                                          03620002
         BALR  RBASE,0            BASE                                  03640000
         USING *,RBASE                 REGISTER.                        03660000
         MODID BR=YES                                            Y01886 03670001
VSTAR00  DS    0H                                                Y01113 03676001
         SPACE                                                          03680000
         LR    R2,R1              SAVE ASCB POINTER              Y02669 03690002
         USING ASCB,R2                                           Y02669 03700002
         L     R11,ASCBCSCB       SET CSCB POINTER               Y02669 03710002
         DROP  R2                                                Y02669 03712002
         USING CHAIN,R11                                                03720002
         SPACE                                                          03740000
*********************************************************************** 03920000
*               GETMAIN FOR START DESCRIPTOR TABLE                      03950014
*********************************************************************** 03980014
         GETMAIN R,LV=SDTLN        GET CORE FOR SDT              Y02669 04010002
         SPACE                                                          04040000
         LR    R10,R1             START DESCRIPTER TABLE                04060000
         USING SDTSD,R10                BASE REGISTER                   04080014
*********************************************************************** 04120000
*  INITIALIZE START DESCRIPTOR TABLE (SDT)                              04140000
*     ZERO OUT ALL LENGTH SLOTS                                         04160014
*     BLANK OUT REST OF START DESCRIPTOR TABLE                          04180000
*********************************************************************** 04200000
         SPACE                                                          04210014
         MVI   SDTJCLS1,C' '      BLANK GOTTEN CORE                     04220014
         MVC   SDTJCLS1+1(221),SDTJCLS1                                 04230014
         MVI   SDTJCLS4,C' '                                            04240014
         MVC   SDTJCLS4+1(221),SDTJCLS4                                 04250014
         MVI   SDTJCLS7,C' '                                    OCIP39A 04253018
         MVC   SDTJCLS7+1(73),SDTJCLS7                          OCIP39A 04256018
         SR    R3,R3                                                    04260014
         STH   R3,SDTSIZE         *                                     04270014
         STH   R3,SDTJCLS1        *                                     04280014
         STH   R3,SDTJCLS2        * ZERO OUT ALL LENGTH SLOTS           04290014
         STH   R3,SDTJCLS3        *                                     04300014
         STH   R3,SDTJCLS4        *                                     04310014
         STH   R3,SDTJCLS5        *                                     04320014
         STH   R3,SDTJCLS6                                              04325014
         STH   R3,SDTJCLS7                                      OCIP39A 04327018
         SR    R0,R0               SET PARMVALUE INDICATOR TO 0    I272 04377019
         ST    R2,SDTWORK          SAVE ASCB ADDRESS             Y02669 04427002
         EJECT                                                          04440002
*********************************************************************** 04460000
*                                                                       04468014
*   CHECK CSCB BUFFER FOR NO PROCNAME,PROCNAME LONGER THAN 8       I272 04474019
*   CHARACTERS,1ST CHARACTER OF PROCNAME NON-ALPHABETIC. ANY       I272 04480019
*   OF THESE IS AN ERROR.                                          I272 04486019
*                                                                     * 04492014
*********************************************************************** 04500014
         SPACE                                                          04508014
         CLI   CHBUF,C' '         IS PROCNAME SPECIFIED ON COMMAND      04524014
         BE    VSTERR4            NO, PARAMETER MISSING                 04532014
         LA    R8,CHBUF           START OF SCAN OF PROCNAME             04540014
         LA    R2,9                MAX FIELD LENGTH + 1         YA00929 04542002
         LR    R1,R8              INIT R1 TO START OF PROCNAME  YA00929 04544002
         BAL   R15,VST070BA       SCAN THE PROCNAME             YA00929 04546002
         CR    R8,R1              IS FIRST CHARACTER NON-ALPHABETIC     04572014
         BNE   VST070AA           NO                            YA00929 04574002
         CH    R2,NAT9            IS IT A NATIONAL CHARACTER    YA00929 04576002
         BNE   VSTERR1            NO, SPELLING ERROR            YA00929 04578002
VST070AA TM    0(R8),C'0'         IS IT NUMERIC                 YA00929 04578402
         BO    VSTERR1            YES, ERROR                            04596014
         BALR  R15,R0             SET BASE FOR POSSIBLE RETURN  YA00929 04598002
         SR    R3,R3              CLEAR R3                      YA00929 04600002
         IC    R3,VSTBT6-1(R2)    GET BRANCH INDEX              YA00929 04602002
         LA    R2,9               MAX FIELD LENGTH + 1          YA00929 04602402
         B     *+4(R3)                                          YA00929 04602802
         B     VSTERR2            DELIMITER ERROR               YA00929 04603202
         B     VST070E            COMMA OR BLANK                YA00929 04603602
         B     VST070B            NATIONAL CHARACTER, RESCAN    YA00929 04603702
         CLI   0(R1),C'.'         WAS IT A PERIOD               YA00929 04603802
         BNE   VSTERR2            NO, DELIMITER ERROR           YA00929 04603902
VST070E  MVC   CHUNIT(D3),VBLANKS BLANK OUT UNITNAME            YA00929 04611202
*********************************************************************** 04626302
*                                                                     * 04633602
*   JOB STATEMENT SET UP IN START DESCRIPTOR TABLE -                  * 04640902
*      -SET JOB STATEMENT INDICATOR                                   * 04648202
*      -MOVE JOB JCL TO SDT                                           * 04655502
*      -MOVE PROCNAME TO JOB STATEMENT AS JOBNAME                     * 04662802
*                                                                     * 04670102
*********************************************************************** 04677402
         SPACE                                                          04684702
         OI    SDTJCLS1,SDTJOB1   SET JOB INDICATOR                     04692014
         MVC   SDTJCL1(L'VSTJOB),VSTJOB MOVE JOB JCL TO SDT             04700014
         LR    R7,R1              MOVE DELIMITER PTR TO REGISTER 7      04724014
         SR    R7,R8              MOVE LENGTH OF PROCNAME TO REG 7      04732014
         LA    R3,SDTJCL1                                               04740014
         BCTR  R7,0               MINUS FOR EX MOVE                     04748014
         EX    R7,VSTMOVE1        PROCNAME TO SDT AS JOBNAME            04756014
         LA    R7,1(R7)           RESTORE LENGTH                        04764014
         EJECT                                                          04772002
*********************************************************************** 04780014
*                                                                     * 04788014
*   TEST START COMMAND BUFFER FOR -                                     04796014
*              PERIOD (TASKNAME,OR ID,PRESENT)                     I272 04804019
*                                                                     * 04828014
*********************************************************************** 04836014
         SPACE                                                          04844014
         LR    R8,R7               PROCNAME LEN INTO R8            I272 04854019
         CLI   0(R1),C'.'        WAS DELIMITER A PERIOD         YA00929 04864002
         BNE   VST075            NO, SKIP TASKNAME              YA00929 04874002
         SPACE                                                          04916014
*********************************************************************** 04924014
*                                                                     * 04932014
*   SINCE TASKNAME IS PRESENT IN COMMAND BUFFER -                     * 04940014
*      -CHECK TASKNAME FOR EIGHT CHARACTERS OR LESS (IF GREATER THAN  * 04948014
*       EIGHT, TERM LENGTH ERROR)                                     * 04956014
*      -CHECK FOR NON-ALPHABETIC 1ST CHARACTER                     I272 04960019
*      -MOVE TASKNAME TO CHKEY IN CSCB                                * 04972014
*                                                                     * 04980014
*********************************************************************** 04988014
         SPACE                                                          04996014
         LA    R6,1(R1)           POINT R6 AT TASKNAME                  05004014
         LA    R2,9              MAX FIELD LENGTH + 1           YA00929 05006002
         LR    R1,R6             INIT R1 TO START OF TASKNAME   YA00929 05008002
         BAL   R15,VST070BA      SCAN THE TASKNAME              YA00929 05010002
         CR    R6,R1              IS FIRST CHARACTER NONALPHABETIC      05036014
         BE    VSTERR1            YES, TASKNAME MISPELLED               05044014
         TM    0(R6),C'0'         IS THE FIRST CHARACTER NUMERIC        05052014
         BO    VSTERR1            YES, ERROR                            05054001
         BALR  R15,R0            SET BASE FOR POSSIBLE RETURN   YA00929 05056002
VST070C  SR    R3,R3                                              M0090 05060001
         IC    R3,VSTBT1-1(R2)    PICK UP RETURN CODE FROM BRANCH TABLE 05076014
         LA    R2,9              MAX FIELD LENGTH + 1           YA00929 05078002
         B     *+4(R3)            COMMA/BLANK ONLY LEGAL           AAAA 05084015
         B     VSTERR2            ERROR, NO COMMA/BLANK            AAAA 05092015
         B     VST070B            BRANCH CHECK FOR POUND,DOLLAR   M0090 05094001
*                                 OR AT SIGN                      M0090 05096001
         LR    R5,R1               PTR TO DELIMITER INTO R5        I272 05100019
         SR    R5,R6              MOVE TASKNAME LENGTH TO R5            05108014
VST070A  LA    R8,D1(R5,R8)       TASKNAME LEN +PROCNAME LEN      M0090 05128001
*                                 + 1 FOR PERIOD                  M0090 05138001
         B     VST100           SET UP SDT EXEC STATEMENT       YA00929 05140002
         SPACE                                                          05142002
****************************************************************YA00929 05148002
*                                                               YA00929 05158002
*    COMMON TRANSLATE AND TEST ROUTINE TO ALLOW NATIONAL        YA00929 05168002
*    CHARACTERS (# @ $) IN PROCNAME, TASKNAME, AND VOLUME SERIALYA00929 05170002
*        ON ENTRY, R1 CONTAINE THE ARGUMENT ADDRESS             YA00929 05170402
*                  R2 CONTAINS THE MAXIMUM LENGTH + 1 OF THE    YA00929 05170802
*                     ARGUMENT FIELD                            YA00929 05171202
*        AT EXIT,  R1 CONTAINS THE ARGUMENT ADDRESS WHERE THE   YA00929 05171602
*                     TRANSLATE AND TEST STOPPED BECAUSE OF A   YA00929 05171702
*                     NON-ZERO FUNCTION BYTE                    YA00929 05171802
*                  R2 CONTAINS THE FUNCTION BYTE FROM THE       YA00929 05171902
*                     TRANSLATE TABLE                           YA00929 05174802
*                                                               YA00929 05178502
****************************************************************YA00929 05178602
         SPACE                                                          05188602
VST070BA LR    R5,R1              PICK UP CHAR ADDRESS            M0090 05201702
         B     VST070BB         AFTER INIT ENTRY, R5 POINTS     YA00929 05204402
*                               TO THE BEGINNING OF THE FIELD   YA00929 05204502
VST070B  EQU   *                ENTRY IF LAST CHARACTER         YA00929 05206002
*                               TRANSLATED WAS NATIONAL         YA00929 05208002
         LA    R1,1(R1)         GET PAST CHARACTER TO           YA00929 05208402
*                               CONTINUE SCAN                   YA00929 05208802
VST070BB SR    R1,R5            LENGTH PROCESSED                YA00929 05208902
         SR    R2,R1            LENGTH TO PROCESS               YA00929 05209402
         BZ    VSTERR3          ERROR, FIELD TO LONG            YA00929 05209802
         AR    R1,R5            POINT TO BEGINNING OF ARGUMENT  YA00929 05210202
         BCTR  R2,R0            DECREMENT R2 FOR EXECUTE        YA00929 05210302
         EX    R2,TRANS         SCAN THE FIELD                  YA00929 05211502
         BC    8,VSTERR3          FIELD LONGER THAN ALLOWED       M0090 05224902
         BR    R15              RETURN                          YA00929 05226902
TRANS    TRT   0(1,R1),VSTTRTAB                                   M0090 05239402
VSTMOVE1 MVC   2(1,R3),0(R8)                                            05242302
VSTMOVE2 MVC   0(1,R3),0(R6)                                            05245202
VSTMOVE3 MVC   0(1,R3),0(R2)                                            05248102
VSTMOVE4 MVC   0(1,R6),0(R4)                                            05251002
VSTMOVE5 MVC   0(1,R6),0(R5)                                            05253902
VSTMOVE6 MVC   CIBDATA-CIBNEXT(0,R1),0(R4)                              05256802
         EJECT                                                          05262602
*********************************************************************** 05265502
*                                                                     * 05268402
*   SINCE TASKNAME IS NOT PRESENT IN COMMAND BUFFER -                 * 05271302
*      -'STARTING' WILL BE STEPNAME ON SDT EXEC CARD               I272 05274202
*      -SCAN FOR UNIT NAME PRESENT                                    * 05277102
*      -IF FOUND,SYNTAX CHECK UNIT PARAM                           I272 05280019
*                                                                     * 05300014
*********************************************************************** 05308014
         SPACE                                                          05316014
VST075   EQU   *                                                        05324014
         CLI   0(R1),C' '         ARE ANY PARAMETERS PRESENT            05332014
         BE    VST087              NO. GO SET UP EXEC CARD         I272 05340019
         LA    R1,1(R1)           POINT REG 1 TO FIRST CHARACTER OF     05348014
*                                   UNIT                                05356014
         CLI   0(R1),C' '          DOES BLANK FOLLOW COMMA              05358000
         BE    VSTERR2            YES, DELIMITER ERROR                  05360000
         CLI   0(R1),C','         IS UNIT PRESENT IN COMMAND BUFFER     05364014
         BE    VST086              NO. GO SET UP EXEC STATEMENT    I272 05372019
         LR    R6,R1              POINT REG 6 AT BEGINNING OF UNIT      05380014
        LR    R9,R1              POINT REG 9 AT BEGINNING OF UNIT       05388014
         SR    R2,R2                                                    05396014
         TRT   0(9,R9),VSTTRTAB   SCAN UNIT                             05404014
         BC    8,VSTERR3          TERM LENGTH ERROR                     05412014
         SR    R3,R3                                                    05420014
         IC    R3,VSTBT2-1(R2)    PICK UP RETURN CODE FROM BRANCH TABLE 05428014
         B     *+4(R3)                                                  05436014
         B     VSTERR2                                                  05444014
         B     VST085              , - PROCESS KEYWORDS            I272 05452019
VST080   EQU  *                                                         05468014
         LR    R5,R1              POINT REG 5 AT DELIMITER              05476014
         LR    R1,R9              POINT REG 1 AT DELIMITER              05484014
         SR    R5,R6              LENGTH OF UNIT TO REG 5               05492014
         B     VST086             SET UP 'STARTING' FOR EXEC STMNT      05532014
         SPACE                                                          05540014
*********************************************************************** 05548014
*                                                                     * 05556014
*        MOVE 'STARTING' TO CSCB AND SET UP EXEC STATEMENT           *  05564014
*                                                                     * 05572014
*********************************************************************** 05580014
         SPACE                                                          05588014
VST085   EQU   *                                                   I272 05618019
         LR    R1,R9              =, POINT BACK TO DELIMITER            05656000
VST086   EQU   *                                                        05676014
         BCTR  R1,0               POINT REG 1 TO CHARACTER AFTER COMMA  05684014
VST087   LA    R6,VSTSTING         PTR TO 'STARTING' DC            I272 05692019
         LA    R5,L'VSTSTING       LEN OF 'STARTING'               I272 05700019
         EJECT                                                          05708002
*********************************************************************** 05716014
*                                                                     * 05724014
*   EXEC STATEMENT SETUP IN START DESCRIPTOR TABLE -                  * 05732014
*      -SET EXEC STATEMENT INDICATOR                                  * 05740014
*      -MOVE EXEC JCL TO SDT                                          * 05748014
*     -INSERT STEPNAME TO SDT EXEC STATEMENT                          * 05756014
*      -MOVE PROCNAME TO EXEC STATEMENT IN SDT                        * 05764014
*                                                                     * 05772014
*********************************************************************** 05780014
         SPACE                                                          05788014
VST100   EQU   *                                                        05796014
         OI    SDTJCLS2,SDTEXEC2  SET EXEC INDICATOR                    05804014
         MVC   SDTJCL2(L'VSTEXEC),VSTEXEC MOVE EXEC JCL TO SDT          05812014
         LA    R3,SDTJCL2+SIXTEEN  ADDRESS FOR PROCNAME MOVE    OCIP39A 05832018
         BCTR  R7,0                PROCNAME LEN LESS 1                  05842019
         LA    R2,SDTJCL1+2                                             05860014
         EX    R7,VSTMOVE3         PROCNAME TO SDT JOB CARD             05868019
         LA    R7,1(R7)            RESTORE PROCNAME LEN                 05876019
         BCTR  R5,0                TASKNAME OR STARTING LEN LESS 1      05884019
         LA    R3,SDTJCL2+2                                             05892014
         EX    R5,VSTMOVE2         TASKNAME OR STARTING TO SDT          05900019
         LA    R5,1(R5)            RESTORE TASKNAME LEN                 05908019
         CLI   0(R1),C' '         ANY PARAMETERS LEFT                   05916014
         BE    VST500A            NO, GET CIB CORE & EXIT               05924000
         LA    R1,1(R1)           POINT REG 1 TO DELIMITER              05932014
         SPACE                                                          05940014
*****                                                             ***** 05948014
*                 SCAN FOR ONLY PARMVALUE PRESENT                     * 05956014
*               IF FOUND, NO DD STATEMENT NECESSARY                   * 05964014
*****                                                             ***** 05972014
         SPACE                                                          05980014
         LA    R8,1(R8)           ADD ONE FOR COMMA AFTER PROC/TASK     05996014
         LR    R9,R8              LENGTH OF PROC /AND TASKNAME TO REG 9 06004014
         CLI   0(R1),C' '         DOES BLANK FOLLOW COMMA               06012014
         BE    VSTERR2            YES DELIMITER ERROR                   06020014
         CLI   0(R1),C','         IS UNIT PARAMETER SPECIFIED           06028014
         BNE   VST200             YES, BUILD DD STATEMENT IN SDT        06036014
         CLI   1(R1),C' '         DOES BLANK FOLLOW COMMA               06044014
         BE    VSTERR2            YES DELIMITER ERROR                   06052014
         CLI   1(R1),C','         IS VOL SER PARAMETER SPECIFIED        06060014
         BNE   VST200             YES, BUILD DD STATEMENT IN SDT        06068014
         CLI   2(R1),C' '         DOES BLANK FOLLOW COMMA               06076014
         BE    VSTERR2            YES DELIMITER ERROR                   06084014
         CLI   2(R1),C','         IS PARMVALUE SPECIFIED                06092014
         BE    VST200             NO, BUILD DD STATEMENT                06100014
         LA    R4,2(R1)           POINT REG 4 AT BEGINNING OF PARMVALUE 06108014
         LA    R8,2(R8)           ADD NUMBER OF COMMAS                  06116014
         SR    R5,R5              ZERO REG 5 FOR LENGTH OF PARMVALUE    06124014
         CLI   0(R4),C' '         IS PARMVALUE SPECIFIED                06132014
         BE    VSTERR2            DELIMITER ERROR                       06140014
         CLI   0(R4),C'('         IS PARMVALUE ENCLOSED IN PARENS       06156014
         BE    VST180             YES, SCAN FOR RIGHT PAREN NO EQUAL    06164014
VST170   LA    R4,D1(R4)           BUMP CM BUFFER PTR              I272 06172019
         LA    R5,1(R5)           INCREMENT PARMVALUE LENGTH BY ONE     06180014
         LA    R8,1(R8)           INCREMENT BUFFER LENGTH BY ONE        06188014
         CLI   0(R4),C' '         IS KEYWORD PRESENT                    06204014
         BE    VST425             NO, DON'T BOTHER BUILDING DD JCL      06212014
         CLI   0(R4),C'='         IS IT A KEYWORD                       06214000
        BE    VST200              YES, BUILD A  DD STATEMENT            06216000
         CLI   0(R4),C','         IS KEYWORD SPECIFIED                  06220014
         BE    VST200             YES, BUILD DD STATEMENT IN SDT        06228014
         CL    R8,VST124          HAS END OF BUFFER BEEN REACHED        06236014
         BH    VST425             YES, GET CORE FOR CIB                 06244014
         B     VST170              GO BACK TO BUMP PTRS AND CHECK  I272 06264019
VST180   EQU   *                                                        06284014
         LA    R3,1                INITIALIZE PAREN CNT REGISTER   I241 06288018
         LA    R4,1(R4)           INCREMENT COMMAND BUFFER PTR          06292014
         LA    R8,1(R8)           INCREMENT BUFFER LENGTH               06300014
         CLI   0(R4),C' '         IS PARMVALUE SPECIFIED                06308014
         BE    VSTERR2            NO, DELIMITER ERROR                   06316014
         CLI   0(R4),C')'         IS PARMVALUE SPECIFIED                06324014
         BE    VSTERR2            NO, DELIMITER ERROR                   06332014
VST185   EQU   *                                                        06340014
         LA    R8,1(R8)           POINT AT NEXT CHARACTER               06348014
         LA    R5,1(R5)           ADD ONE TO PARMVALUE LENGTH           06356014
         LA    R4,1(R4)           ADD ONE TO CHBUF LENGTH               06364014
         CLI   0(R4),C' '         IS KEYWORD PRESENT                    06372014
         BE    VSTERR2            ERROR, RIGHT PAREN NOT PRESENT        06380014
         CLI   0(R4),C'('          IS CHAR LEFT PAREN              I241 06381018
         BNE   VST185A             NO BRANCH AND CONTINUE          I241 06382018
         LA    R3,1(R3)            ADD ONE TO PAREN COUNT          I241 06383018
         B     VST185B                                             I241 06384018
VST185A  EQU   *                                                   I241 06385018
         CLI   0(R4),C')'         IS IT END OF PARMVALUE                06388014
         BNE   VST185B             NO BRANCH AND CONTINUE          I241 06390018
         BCTR  R3,0                SUBTRACT 1 FROM PAREN CNT       I241 06392018
         LTR   R3,R3               IS PAREN CNT ZERO               I241 06394018
         BZ    VST190              YES CHECK FOR KEYWORDS          I241 06396018
VST185B  EQU   *                                                   I241 06398018
         CL    R8,VST124          HAS END OF BUFFER BEEN REACHED        06404014
         BE    VSTERR2            YES, DELIMITER ERROR                  06412014
         B     VST185             GO TRY AGAIN                          06420014
VST190   EQU   *                                                        06428014
         LA    R4,1(R4)           POINT REG 4 TO CHARACTER AFTER )      06436014
         CLI   0(R4),C','         ARE KEYWORDS PRESENT                  06444014
         BE    VST200             YES BUILD DD STATEMENT                06452014
         CLI   0(R4),C' '         IS BLANK FOLLOWING                    06460014
         BE    VST420             YES, YOU ARE IN GOOD SHAPE            06468014
         B     VSTERR2            DELIMITER ERROR - BAD SHAPE           06476014
         EJECT                                                          06484002
*********************************************************************** 06492014
*                                                                     * 06500014
*   DD STATEMENT SET UP IN THE START DESCRIPTOR TABLE -               * 06508014
*      -SET DD STATEMENT INDICATOR                                    * 06516014
*      -MOVE DD NAME TO JCL IMAGE IN SDT                              * 06524014
*                                                                     * 06532014
*********************************************************************** 06540014
         SPACE                                                          06548014
VST200   EQU   *                                                        06556014
         LR    R8,R9                                                    06564014
         SR    R5,R5              ZERO SDT DD STATEMENT LENGTH REG      06572014
         OI    SDTJCLS3,SDTDD3    SET DD STATEMENT INDICATOR FLAG       06580014
         MVC   SDTJCL3(L'VSTDD),VSTDD MOVE DD JCL TO SDT                06588014
         LA    R5,L'VSTDD(0)      LENGTH TO REG 5                       06596014
         LA    R6,SDTJCL3                                               06604014
         AR    R6,R5              POSITION REG 6 FOR PARAMETER MOVE     06612014
         SPACE                                                          06620014
*********************************************************************** 06628014
*                                                                     * 06636014
*                         POSITIONAL PARAMETER SCAN                   * 06644014
*                                                                     * 06652014
*********************************************************************** 06660014
         SPACE                                                          06668014
         SR    R2,R2              SET REG2 TO ZERO FOR IC INSTRUCTION   06684014
         LR    R4,R1              POINT REG 4 AT CHARACTER AFTER COMMA  06692014
         TRT   0(9,R4),VSTTRTAB   SCAN POSITIONAL PARAMETERS            06700014
         BC    8,VSTERR3          TERM LENGTH ERROR                     06708014
         SR    R3,R3                                                    06716014
         IC    R3,VSTBT2-1(R2)    PICK UP INDEX CODE FROM TABLE 2       06724014
         B     *+4(R3)                                                  06732014
         B    VSTERR2             DELIMITER ERROR                       06740014
         B     VST345             EQUAL SIGN                            06748014
         EJECT                                                          06764002
*****                                                             ***** 06772014
*                                                                     * 06780014
*            THIS ROUTINE PROCESSES THE UNIT PARAMETER ON THE         * 06788014
*                              START COMMAND                          * 06796014
*                                                                     * 06804014
*****                                                             ***** 06812014
         SPACE                                                          06820014
         CLI   0(R1),C' '         IS IT A BLANK                         06828014
         BE    VST650             CHECK FOR BLANK RIGHT AFTER COMMA     06836014
VST250   EQU   *                                                        06844014
         CR    R4,R1              IS UNIT PARAMETER SPECIFIED           06852014
         BE    VST600             NO, CHECK VOLUME SERIAL NUMBER        06860014
         LR    R3,R1                                                    06868014
         SR    R3,R4              MOVE LENGTH OF UNIT TO REG3           06876014
         AR    R8,R3              INCREMENT BUFFER COUNT BY UNIT LENGTH 06884014
         MVC   0(L'VSTUNIT,R6),VSTUNIT MOVE UNIT= TO SDT                06892014
         LA    R5,L'VSTUNIT(0)    POINT REG 6 AT NEXT EMPTY SPACE       06900014
         AR    R6,R5                                                    06908014
         BCTR  R3,0                                                     06916014
         EX    R3,VSTMOVE4        MOVE UNIT TO SDT                      06924014
         LA    R3,1(R3)                                                 06932014
         LA    R1,1(R1)           POINT R1 TO POSITION AFTER COMMA      06940014
         AR    R6,R3              POSITION REG 6 AFTER UNIT             06948014
         LTR   R9,R9              ARE ANY PARAMETERS LEFT               06956014
         BZ    VST500A            NO, BUILD CIB AND EXIT                06964014
         EJECT                                                          06972002
*****                                                             ***** 06980014
*                                                                     * 06988014
*             THIS ROUTINE PROCESSES THE VOLUME SERIAL PARAMETER      * 06996014
*                     ON THE START COMMAND                            * 07004014
*                                                                     * 07012014
*****                                                             ***** 07020014
         SPACE                                                          07028014
VST275   EQU   *                                                        07036014
         LA    R8,1(R8)           INCREMENT BUFFER LENGTH CT FOR COMMA  07044014
         LA    R2,7             MAX FIELD LENGTH + 1            YA00929 07046002
         LR    R4,R1              POINT REG4 AT CHARACTER AFTER COMMA   07060014
         BAL   R15,VST070BA     GO SCAN THE SERIAL              YA00929 07062002
         SR    R3,R3                                                    07084014
         IC    R3,VSTBT3-1(R2)    PICK UP INDEX CODE FROM TABLE 3       07092014
         LA    R2,7             MAX FIELD LENGTH + 1            YA00929 07094002
         B     *+4(R3)                                                  07100014
         B     VSTERR2            NO, DELIMITER ERROR                   07108014
         B     VST345             EQUAL SIGN                            07116014
         B     VST070B          NATIONAL CHARACTER RESCAN       YA00929 07118002
         CLI   0(R1),C' '         IS DELIMITER A BLANK                  07124014
         BE    VST675             YES, CHECK FOR ERROR                  07132014
         SPACE                                                          07140014
VST300   EQU   *                                                        07148014
         CR    R4,R1              IS VOL SER PARAMETER SPECIFIED        07156014
         BE    VST625             NO, CHECK FOR PARM VALUE              07164014
         LR    R3,R1                                                    07172014
         SR    R3,R4              MOVE LENGTH OF VOL SER TO REG 3       07180014
         AR    R8,R3              ADD VOL SER LENGTH TO BUFFER COUNT    07188014
         BCTR  R6,0               SUBTRACT ONE FROM REG 6               07196014
         CLI   0(R6),C' '         WAS UNIT SPECIFIED                    07204014
         BE    VST301             NO, DON'T MOVE COMMA                  07212014
         LA    R6,1(R6)           RESTORE DD STATEMENT POINTER          07220014
         MVI   0(R6),C','         MOVE COMMA AFTER UNIT PARAMETER       07228014
VST301   EQU   *                                                        07236014
         LA    R6,1(R6)           POINT REG 6 AT CHARACTER AFTER COMMA  07244014
         MVC   0(L'VSTVOL,R6),VSTVOL  MOVE VOLUME=SER= TO SDT           07252014
         LA    R5,L'VSTVOL(0)                                           07260014
         AR    R6,R5              POINT REG 6 AT NEXT EMPTY SPACE       07268014
         BCTR  R3,0                                                     07276014
         EX    R3,VSTMOVE4        MOVE VOL SER TO SDT                   07284014
         LA    R3,1(R3)                                                 07292014
         LA    R1,1(R1)           POINT REG 1 TO CHARACTER AFTER COMMA  07300014
         AR    R6,R3              REG 6 TO CHARACTER AFTER VOL SER      07308014
         LTR   R9,R9              ARE ANY PARAMETERS LEFT               07316014
         BZ    VST500A            NO, BUILD CIB AND EXIT                07324014
         LA    R8,1(R8)           INCREMENT COUNT BY ONE                07332014
         EJECT                                                          07340002
*****                                                             ***** 07348014
*        SCAN  FOR  ONLY PARMVALUE PRESENT OR PARMVALUE AND           * 07356014
*                     KEYWORDS PRESENT                            ***** 07364014
*****                                                                   07372014
         SPACE                                                          07380014
VST325   EQU   *                                                        07388014
         CLI   0(R1),C' '          DOES BLANK FOLLOW COMMA              07390000
         BE    VSTERR2            YES, DELIMITER ERROR                  07392000
         CLI   0(R1),C','         IS PARMVALUE SPECIFIED                07396014
         BE    VST750             NO, SCAN KEYWORDS                     07404014
         LR    R9,R8              LENGTH TO REG 9                       07412000
         LA    R8,1(R8)           INCREMENT COUNT BY ONE                07420000
         SR    R5,R5                                                    07428000
         LR    R4,R1                                                    07436000
         CLI   0(R4),C'('                                               07438000
         BE    VST331                                                   07440000
VST330   EQU   *                                                        07444000
         LA    R5,1(R5)           ADD ONE FOR FIRST CHARACTER           07468000
         LA    R4,1(R4)                                                 07476000
         CLI   0(R4),C' '         IS ONLY PARMVALUE SPECIFIED           07484000
         BE    VST700             YES, GET CORE FOR CIB                 07492000
         CLI   0(R4),C','         ARE KEYWORDS SPECIFIED TOO            07500000
         BE    VST725             YES, GET CORE FOR CIB AND PROCESS     07508000
         CLI   0(R4),C'='       **Q. KEYWORD                            07510000
         BE    VST330A          ** BR - YES                             07512000
         LA    R8,1(R8)                                                 07516000
        CL    R8,VST124                                                 07524000
         BH    VST700                                                   07532000
         B     VST330                                                   07540000
VST330A  EQU   *                **                                      07541000
         LR    R8,R9            **RESTORE BUFFER COUNT                  07542000
         BCTR  R1,0             **                                      07543000
         B     VST750           **EXIT TO KEYWORD ROUTINE               07544000
VST331   EQU   *                                                        07548014
         LA    R3,1                INITIALIZE PAREN CNT REGISTER   I241 07552018
         LA    R1,1(R1)           POINT REG 1 TO FIRST CHARACTER        07556014
         LR    R4,R1              POINT REG 4                           07564014
         CLI   0(R4),C')'         IS PARMVALUE PRESENT                  07572014
         BE    VSTERR2            NO, YOU LOOSE - ERROR                 07580014
         CLI   0(R4),C' '         IS PARMVALUE PRESENT                  07588014
         BE    VSTERR2            (3, DELIMITER ERROR                   07596014
VST332   EQU   *                                                        07604014
         LA    R8,1(R8)           INCREMENT BUFFER LENGTH COUNT         07612014
         LA    R5,1(R5)           ADD ONE TO PARMVALUE COUNT            07620014
         LA    R4,1(R4)           POINT REG 4 TO NEXT CHARACTER         07628014
         CLI   0(R4),C' '         IS IT RIGHT PAREN                     07636014
         BE    VSTERR2            NO RIGHT PAREN - ERROR                07644014
         CLI   0(R4),C'('          IS CHAR LEFT PAREN              I241 07645018
         BNE   VST332A             NO BRANCH AND CONTINUE          I241 07646018
         LA    R3,1(R3)            ADD ONE TO PAREN CNT            I241 07647018
         B     VST332B                                             I241 07648018
VST332A  EQU   *                                                   I241 07649018
         CLI   0(R4),C')'         IS IT END OF PARMVALUE                07652014
         BNE   VST332B             NO BRANCH AND CONTINUE          I241 07654018
         BCTR  R3,0                SUBT 1 FROM PAREN CNT           I241 07656018
         LTR   R3,R3               IS PAREN CNT ZERO               I241 07658018
         BZ    VST333              YES, CHECK FOR KEYWORDS         I241 07660018
VST332B  EQU   *                                                   I241 07662018
         CL    R8,VST124          HAS END OF BUFFER BEEN REACHED        07668014
         BE    VSTERR2            YES, DELIMITER ERROR                  07676014
         B     VST332             TRY AGAIN                             07684014
VST333   EQU   *                                                        07692014
         LA    R4,1(R4)           POINT REG 4 AT CHARACTER AFTER )      07700014
         CLI   0(R4),C','         ARE KEYWORDS PRESENT                  07708014
         BE    VST725             YES, MOVE CIB AND PROCESS             07716014
         CLI   0(R4),C' '         IS IT BLANK                           07724014
         BE    VST700             YES, YOU ARE O K                      07732014
         B    VSTERR2             DELIMITER ERROR                       07740014
         EJECT                                                          07748002
*****                                                                   07756014
*                             KEYWORD  SCAN                             07764014
*****                                                                   07772014
         SPACE                                                          07780014
VST335   EQU   *                                                        07788014
         LR    R9,R7              POINT REG 9 TO KEYWORD                07796014
         LA    R8,1(R8)           INCREMENT COUNT BY ONE                07812014
         BCTR  R6,0               POINT REG 6 AT LAST CHARACTER         07820014
         CLI   0(R6),C' '         WAS THERE A LAST CHARACTER            07828014
         BE    VST341B             NO,SKIP THE COMMA MOVE       OCIP39A 07836018
         LA    R6,1(R6)           POINT REG 6 AT CURRENT SLOT           07844014
         MVI   0(R6),C','         MOVE COMMA TO DELIMIT KEYWORDS        07852014
VST341B  LA    R6,1(R6)             INCREMENT POINTER           OCIP39A 07854018
         BAL   R15,VSTINIT                                      OCIP39A 07856018
VST341A  EQU   *                                                OCIP39A 07866018
         SR    R2,R2                                                    07876014
         TRT    0(9,R9),VSTTRTAB   SCAN KEYWORD                         07884014
         BC    8,VSTERR3          TERM LENGTH ERROR                     07892014
         LA    R3,CHBUF+124       END OF BUFFER ADDRESS        @ZA03646 07893003
         CR    R1,R3              END OF BUFFER EXCEEDED?      @ZA03646 07894003
         BH    VSTERR3            YES, TERM LENGTH ERROR       @ZA03646 07895003
         SR    R3,R3                                                    07900014
         IC    R3,VSTBT4-1(R2)    PICK UP CODE INDEX FROM TABLE 4       07908014
         B     *+4(R3)                                                  07916014
         B     VSTERR2            NOT EQUAL SIGN - DELIMITER ERROR      07924014
         B     VST350             CONTINUE PROCESSING KEYWORDS          07932014
VST345   EQU   *                                                        07940014
         LR    R9,R4              POINT REG 9 TO FIRST KEYWORD          07948014
         BCTR  R6,0               SEE IF ANY OTHER PARAMETERS           07956014
         CLI   0(R6),C' '         WERE THEY                             07964014
         BE    VST346             NO, YOU ARE O K                       07972014
         LA    R8,1(R8)           ADD ONE FOR LEFT COMMA                07980014
         LA    R6,1(R6)                                                 07982000
         MVI   0(R6),C','                                               07984000
VST346   EQU   *                                                        07988014
         LA    R6,1(R6)           REPOSITION REG 6                      07996014
         BAL   R15,VSTINIT                                      OCIP39A 08000018
         EJECT                                                          08004002
*****                                                             ***** 08012014
*                                                                     * 08020014
*                   START OF GENERAL SCAN                             * 08028014
*                                                                     * 08036014
********                                              *****     OCIP39A 08038018
VST350   EQU   *                                                OCIP39A 08040018
         CR    R9,R1              IS = FIRST CHARACTER          OCIP39A 08042018
         SPACE                                                          08052014
         BE    VSTERR2            YES, DELIMITER ERROR                  08052418
         L     R7,SDTPAREN                                      OCIP39A 08052818
         LTR   R7,R7                                            OCIP39A 08053218
         BZ    VST350B        BR.IF VALUE NOT  ENCLOSED         OCIP39A 08053618
*                                   INPARENTHESES               OCIP39A 08054018
         SR    R7,R7               END OF MAJOR KEYWORD         OCIP39A 08055618
**                       ENCLOSED IN PARENTHESES REACHED        OCIP39A 08056018
         ST    R7,SDTPAREN         SET SDTPAREN = 0             OCIP39A 08056418
VST350B  EQU   *                   SEARCH TABLE OF DD KEYWORDS  OCIP39A 08056818
**                                                              OCIP39A 08057218
**  R1 PTS. TO = DELIMITER                                      OCIP39A 08057618
**  R9 PTS. TO FIRST CHAR.OF KEYWORD                            OCIP39A 08058018
         LA    R7,DDTAB            PTR TO LIST OF DD KEYWORDS   OCIP39A 08058418
         LR    R5,R1               PTR TO = DELIMITER           OCIP39A 08058818
         LR    R15,R1                                           OCIP39A 08059218
         SR    R15,R9              COMPUTE CHAR LENGTH          OCIP39A 08059618
**  R15 CONTAINS LENGTH OF KEYWORD(INCLUDING =                  OCIP39A 08060018
**             SIGN) MINUS 1(FOR CLC)                           OCIP39A 08060418
         SR    R4,R4               CLEAR REGISTER               OCIP39A 08060818
         B     EQRD3               TRANSFER                     OCIP39A 08061218
EQRD1    DS    0H                  ENTRY                        OCIP39A 08061618
         CLC   1(0,R7),0(R9)       IS KEYWORD IN TABLE          OCIP39A 08062018
EQRD2    DS    0H                                               OCIP39A 08062418
         AR    R7,R4               BUMP TO NEXT KEYWORD         OCIP39A 08062818
EQRD3    DS    0H                                               OCIP39A 08063218
         IC    R4,ZERO(R7)  GET KEYWORD LENGTH(INCL. = SIGN)    OCIP39A 08063618
         LTR   R4,R4               TABLE END                    OCIP39A 08064018
         BZ    EQRL                YES,TRANSFER                 OCIP39A 08064418
         EX    R15,EQRD1           EXECUTE KEYWORD COMPARE      OCIP39A 08064818
         BC    NOTEQU,EQRD2        TRANSFER BACK NOT FOUND      OCIP39A 08065218
         B     VST350A                                          OCIP39A 08066018
EQRL     SR    R2,R2               ENTRY NOT FOUND-KEYWORD IS A OCIP39A 08066418
         IC    R2,SDTJCLS7         SYMBOLIC PARAMETER           OCIP39A 08066818
         LTR   R2,R2                                            OCIP39A 08067218
         BZ    VT2E                                             OCIP39A 08067618
         IC    R2,SDTJCLS6                                      OCIP39A 08068418
         LTR   R2,R2                                            OCIP39A 08068818
         BZ    VT7E                                             OCIP39A 08069218
         IC    R2,SDTJCLS5                                      OCIP39A 08070018
         LTR   R2,R2                                            OCIP39A 08070418
         BZ    VT6E                                             OCIP39A 08070818
         LA    R4,SDTJCL5                                       OCIP39A 08071218
EXSCAN   EQU   *                                                OCIP39A 08071618
         L     R6,SDTEXPT          R6 PTS.TO NEXT SLOT          OCIP39A 08072018
**                                  IN SDT EXEC STMT            OCIP39A 08072418
         BAL   R15,VST351          STORE KEYWORD IN SDT         OCIP39A 08072818
         LA    R6,1(R6)                                         OCIP39A 08073218
         ST    R6,SDTEXPT          UPDATE POINTER               OCIP39A 08073618
         B     VST341A             CONTINUE SCAN                OCIP39A 08074018
VST350A  EQU   *                  DD KEYWORD PROCESSING         OCIP39A 08074418
**  FOR KEYWORDS WHICH ARE NEW FOR SU'S, CHECK TO SEE IF THE SU IS      08077003
**  INSTALLED. IF NOT THEN THIS KEYWORD IS ACTUALLY A SYMBOLIC @G32HPPJ 08077103
         L     R2,16              LOCATE CVT                   @G32HPPJ 08077203
         USING CVTMAP,R2          SET UP MAPPING               @G32HPPJ 08077303
         L     R2,CVTIHASU        GET SUBIT STRING ADDRESS     @G32HPPJ 08077403
         DROP  R2                 FREE CVT MAPPING             @G32HPPJ 08077503
         USING SUBITS,R2          SET UP SUBIT MAPPING         @G32HPPJ 08077603
         CLC   SUBSYS(6),0(R9)    IS THIS SUBSYS KEY?          @G32HPPJ 08077703
         BE    VST350C            YES, CHECK FOR SU29          @G32HPPJ 08077803
         CLC   PROTECT(7),0(R9)   NO, IS IT PROTECT KEY?       @G32HPPJ 08077903
         BE    VST350D            YES, CHECK FOR SU32          @G32HPPJ 08078003
         CLC   MODIFY(6),0(R9)    NO, IS IT MODIFY KEYWORD     @G16APPJ 08078103
         BE    VST350E            YES, CHECK FOR SU10          @G16APPJ 08078203
         CLC   FLASH(5),0(R9)     NO, IS IT FLASH KEYWORD      @G16APPJ 08078303
         BE    VST350E            YES, CHECK FOR SU10          @G16APPJ 08078403
         CLC   BURST(5),0(R9)     NO, IS IT BURST KEYWORD      @G16APPJ 08078503
         BE    VST350E            YES, CHECK FOR SU10          @G16APPJ 08078603
         CLC   CHARS(5),0(R9)     NO, IS IT CHARS, KEYWORD     @G16APPJ 08078703
         BE    VST350E            YES, CHECK FOR SU10          @G16APPJ 08078803
         B     VST350F            NO, CONTINUE                 @G16APPJ 08078903
VST350C  DS    0H                                              @G16APPJ 08079003
         TM    SUBYTE4,SU29BIT    IS SU29 INSTALLED?           @G16APPJ 08079103
         BNO   EQRL               NO, TREAT AS SYMBOLIC        @G16APPJ 08079203
         B     VST350F            YES, TREAT AS DD KEYWORD     @G16APPJ 08079303
VST350E  DS    0H                                              @G16APPJ 08079403
         TM    SUBYTE2,SU10BIT    IS SU10 INSTALLED            @G16APPJ 08079503
         BNO   EQRL               NO, TREAT AS SYMBOLIC        @G16APPJ 08079603
         B     VST350F            YES, TREAT AS DD KEYWORD     @G16APPJ 08079703
VST350D  DS    0H                                              @G32HPPJ 08079803
         TM    SUBYTE5,SU32BIT    IS SU32 INSTALLED?           @G32HPPJ 08079903
         BNO   EQRL               NO TREAT AS SYMBOLIC                  08080003
         DROP  R2                                              @G32HPPJ 08080103
VST350F  DS    0H                 PROCESS DD KEYWORDS          @G32HPPJ 08080203
         SR    R2,R2                                                    08080303
         IC    R2,SDTJCLS4                                              08080403
         LTR   R2,R2                                                    08080503
         BZ    VT3                                                      08080603
         IC    R2,SDTJCLS5                                              08082000
         LTR   R2,R2                                                    08083000
         BZ    VT4                                                      08084000
         IC    R2,SDTJCLS6                                              08086000
         LTR   R2,R2                                                    08087000
         BZ    VT5                                                      08088000
         LA    R4,SDTJCL6                                               08089000
DDSCAN   EQU   *                                                OCIP39A 08089118
         L     R6,SDTDDPT     R6 PTS.TO NEXT SLOT IN SDT DD STMTOCIP39A 08089218
         BAL   R15,VST351          STORE KEYWORD IN SDT         OCIP39A 08089318
RETDD    EQU   *                                                OCIP39A 08089418
         LA    R6,1(R6)                                         OCIP39A 08089518
         ST    R6,SDTDDPT          UPDATE POINTER               OCIP39A 08089618
         B     VST341A             CONTINUE SCAN                OCIP39A 08089718
         EJECT                                                          08091802
**                                                              OCIP39A 08115902
** * * * SUBROUTINE TO STORE KEYWORD IN SDT * * * * * * * *     OCIP39A 08118002
VST351  EQU   *                                                         08120102
         LR    R7,R6                                                    08122202
         SR    R7,R4  NUMBER OF CHARS.IN THIS SDT SO FAR        OCIP39A 08124302
         LR    R5,R9              SAVE START OF SCAN                    08126402
         LA    R9,1(R1)           POINT REG 9 TO 1ST CHARACTER AFTER =  08128502
         CLI   0(R9),FAPOST                                     OCIP39A 08130602
         BE    VSTQUO             BR.IF FIRST CHAR.IS A QUOTE   OCIP39A 08132702
         CLI   0(R9),LEFTPAR                                    OCIP39A 08134802
         BE    VSTLPAR             BRANCH IF FIRST CHAR.IS A    OCIP39A 08136902
**                                   LEFT PAREN                 OCIP39A 08139002
VST355   EQU   *                                                        08141102
         SR    R2,R2                                                    08143202
         TRT   0(45,R9),VSTTRTAB  SCAN CHARACTER AFTER KEYWORD          08145302
         BC    8,VSTERR3          TERM LENGTH ERROR                     08148014
         LA    R3,CHBUF+124       END OF BUFFER ADDRESS        @ZA03646 08149003
         CR    R1,R3              END OF BUFFER EXCEEDED?      @ZA03646 08150003
         BH    VSTERR3            YES, TERM LENGTH ERROR       @ZA03646 08151003
         BE    VST359             AT END OF BUFFER             @ZA03646 08152003
         SR    R3,R3                                                    08156014
         IC    R3,VSTBT5-1(R2)    PICK UP CODE INDEX FROM TABLE 5       08164014
         B     *+4(R3)                                                  08172014
         B     VST376             DELIMITER NOT SIGNIFICANT             08180014
         B     VST360             BLANK                                 08188014
         LA    R9,1(R1)                                                 08190003
         TRT   0(45,R9),VSTTRTAB LOOK FOR AN EQUAL SIGN                 08190803
         BC    8,VSTERR3          TERM LENGTH ERROR                     08191603
         LA    R3,CHBUF+124       END OF BUFFER ADDRESS        @ZA03646 08192403
         CR    R1,R3              END OF BUFFER EXCEEDED?      @ZA03646 08193203
         BH    VSTERR3            YES, TERM LENGTH ERROR       @ZA03646 08194003
         SR    R3,R3                                                    08196000
         IC    R3,VSTBT4-1(R2)    PICK UP CODE INDEX FROM TABLE 4       08198000
         B     *+4(R3)                                                  08200000
         B     VST376             NOT A DELIMITER COMMA                 08202000
         LA    R3,67              LENGTH CHECK FOR KEYWORD      YM06145 08204002
         LR    R1,R5              BEGINNING OF SCAN TO REG 1            08212014
         BCTR R9,0                                                      08216000
         SR    R9,R1              LENGTH OF THIS KEYWORD                08220014
         CR    R9,R3    KEYWORD LONGER THAN ALLOWED             OCIP39A 08222018
         BNL   VSTERR3       YES- TERM LENGTH ERROR             OCIP39A 08224018
         LA    R3,71          LENGTH FOR CHECK CURRENT SDT      YM06145 08226002
         AR    R7,R9              TOTAL NEW LENGTH                      08228014
         CR    R7,R3    IS IT TOO LONG FOR CURRENT SDT ENTRY    OCIP39A 08236018
         BNL   VST380        YES - GET NEW SLOT                         08244017
VST356   EQU   *                                                        08252014
         BCTR  R9,0                                                     08260014
         EX    R9,VSTMOVE5        NO, MOVE IN KEYWORD                   08268014
         LA    R9,1(R9)                                                 08276014
         AR    R6,R9              POINT REG 6 AT NEXT SLOT              08284014
         MVI   0(R6),C','                                               08292014
         AR    R8,R9              ADD KEYWORD LENGTH TO BUFFER LENGTH   08300014
         CL    R8,VST124          HAS END OF BUFFER BEEN REACHED        08308014
         BL    VST385                                                   08316014
         B     VST361A                                          OCIP39A 08316218
**   ***END OF SUBROUTINE TO STORE KEYWORD IN SDT* * * * * * *  OCIP39A 08316418
**                                                              OCIP39A 08316618
         EJECT                                                          08316702
** * * * * * *SUBROUTINE FOR PROCESSING VALUES IN APOSTROPHES   OCIP39A 08316818
VSTQUO   EQU   *    PROCESSING FOR VALUE IN APOSTROPHES         OCIP39A 08317018
         LA    R1,1(R9)   R1 PTS.TO CHAR AFTER FIRST QUOTE      OCIP39A 08317218
         LA    R2,CHBUF           BEGINNING OF BUFFER           OCIP39A 08317418
         A     R2,VST124                                        OCIP39A 08317618
         BCTR  R2,0               R2 PTS TO LAST CHAR IN BUF   @ZA03646 08318003
         SR    R9,R9              R9 IS TEST REGISTER           OCIP39A 08318218
NEXT     CLI   0(R1),FAPOST       IS NEXT CHAR. AN APOSTROPHE   OCIP39A 08318418
         BNE   CLEAR              NO- BRANCH                    OCIP39A 08318618
         X     R9,VSTONE          EX OR TEST REGISTER           OCIP39A 08318818
         BZ    BXLE               BRANCH IF EVEN NUMBER OF      OCIP39A 08319018
**                   SUCCESSIVE QUOTES(EXCLUDING INITIAL        OCIP39A 08319218
**                                      QUOTE) R9 NOW = 0       OCIP39A 08319418
**                                                              OCIP39A 08319618
**                                R9 NOW EQUALS 1               OCIP39A 08319818
         CLI   1(R1),FAPOST       IS THE NEXT CHAR IN THE       OCIP39A 08320018
**                              BUFFER ALSO AN APOSTROPHE       OCIP39A 08320218
         BNE   MOVE                 NO - END OF VALUE           OCIP39A 08320418
         B     BXLE                                             OCIP39A 08320618
CLEAR    SR    R9,R9               CLEAR TEST REGISTER          OCIP39A 08320818
BXLE     LA    R1,1(R1)              UPDATE CHAR.POINTER        OCIP39A 08321018
         CR    R1,R2   HAS END OF BUFFER BEEN REACHED           OCIP39A 08321218
         BL    NEXT                  NO-  BRANCH                OCIP39A 08321418
         CLI   0(R1),FAPOST                                     OCIP39A 08321618
         BNE   VSTERR2               DELIMITER ERROR            OCIP39A 08321818
MOVE     LA    R9,1(R1)                                         OCIP39A 08322018
         B     VST355                                           OCIP39A 08322218
** * * * * END SUBROUTINE FOR PROCESSING VALUES IN APOTROPHES*  OCIP39A 08322418
**                                                              OCIP39A 08322618
         EJECT                                                          08324602
VT3      EQU   *                                                        08324800
         LA    R4,SDTJCL3                                               08325600
         B     DDSCAN                                           OCIP39A 08326418
VT4      EQU   *                                                        08327200
         LA    R4,SDTJCL4                                               08328000
         B     DDSCAN                                           OCIP39A 08328818
VT5      EQU   *                                                        08329600
         LA    R4,SDTJCL5                                               08330400
         B     DDSCAN                                           OCIP39A 08330518
VT2E     EQU   *                                                OCIP39A 08330618
         LA    R4,SDTJCL2                                       OCIP39A 08330718
         B     EXSCAN                                           OCIP39A 08330818
VT7E     EQU   *                                                OCIP39A 08330918
         LA    R4,SDTJCL7                                       OCIP39A 08331018
         B     EXSCAN                                           OCIP39A 08331118
VT6E     EQU   *                                                OCIP39A 08331218
         LA    R4,SDTJCL6                                       OCIP39A 08331318
         B     EXSCAN                                           OCIP39A 08331418
VST359   EQU   *                                               @ZA03646 08331703
         LA    R1,CHBUF+124                                    @ZA03646 08331803
VST360   EQU   *                                                        08332014
         LA    R3,67              KEYWORD ALLOWABLE LENGTH      YM06145 08340002
         LR    R9,R1                                                    08348014
         LR    R1,R5              SET REG 9 TO LENGTH OF KEYWORD        08356014
         SR    R9,R1              LENGTH OF THIS KEYWORD                08364014
         CR    R9,R3    KEYWORD LONGER THAN ALLOWED             OCIP39A 08366018
         BNL   VSTERR3       YES- TERM LENGTH ERROR             OCIP39A 08368018
         LA    R3,71        TOTAL ALLOWABLE LENGTH              YM06145 08370002
         AR    R7,R9              TOTAL NEW LENGTH                      08372014
         CR    R7,R3    IS IT TOO LONG FOR CURRENT SDT ENTRY    OCIP39A 08380018
         BH    VST364             YES                                   08388014
VST361   EQU   *                                                        08396014
         BCTR  R9,0                                                     08404014
         EX    R9,VSTMOVE5                                              08412014
         LA    R9,1(R9)                                                 08420014
         B     VST361A             BRANCH TO SCAN CLEANUP AND   OCIP39A 08420118
**                         ,        TERMINATE                   OCIP39A 08420218
         EJECT                                                          08421301
*                                                               OCIP39A 08427501
*       SUBROUTINE FOR PROCESSING VALUES ENCLOSED IN PARENS     OCIP39A 08429701
*                                                                YM2369 08430401
*              -VALUE MAY BE EITHER A MAJOR DD KEYWORD           YM2369 08430501
*               OR A SYMBOLIC PARAMETER                          YM2369 08430601
*                                                                YM2369 08430701
VSTLPAR  EQU   *                                                OCIP39A 08430801
         LA    R2,RETDD            RETURN ADDRESS IF DD KEYWORD OCIP39A 08431901
         LA    R1,0(R15)                                        OCIP39A 08433001
         CR    R1,R2                                            OCIP39A 08434101
         BNE   VST355              BRANCH IF NOT A              OCIP39A 08435201
**   MAJOR DD KEYWORD-THIS IS AN ERROR WHICH WILL BE CAUGHT BY  OCIP39A 08436301
**                                  THE R/I                     OCIP39A 08437401
         L     R1,SDTPAREN         ARE MINOR KEYWORDS(IE.       OCIP39A 08438501
**  KEYWORDS ENCLOSED IN PARENTHESES) BEING                     OCIP39A 08439601
         LTR   R1,R1                 PROCESSED                  OCIP39A 08440701
         BNE   VST355              YES-SDTPAREN NOT ZERO - BR.  OCIP39A 08441801
**  * *  *  DD MAJOR KEYWORD VALUE IS ENCLOSED IN PARENTHESES-  OCIP39A 08442901
**   SCAN ENTIRE KEYWORD,CHECKING FOR BALANCED PARENS           OCIP39A 08444001
         LA    R1,1(R9)  R1 PTS.TO CHAR AFTER LEFT PAREN.       OCIP39A 08445101
         LA    R2,CHBUF            BEGINNING OF INPUT BUFFER    OCIP39A 08446201
         A     R2,VST124                                        OCIP39A 08447301
         BCTR  R2,0                R2 PTS.TO LAST CHAR.OF BUFFEROCIP39A 08448401
         LA    R9,1                R9 CONTAINS BALANCED         OCIP39A 08449501
**  PAREN.INDICATOR.SET TO 1 FOR FIRST LEFT PAREN.              OCIP39A 08450601
         B     VSTPAR5            START RIGHT PAREN SCAN         YM2369 08451001
VSTPAR2  CR    R1,R2               HAS END OF BUFFER BEEN REACH OCIP39A 08451701
         BNL   VSTERR2             YES-DELIMITER ERROR -         YM2369 08452801
*                                  UNBALANCED PARENTHESES        YM2369 08455601
         LA    R1,1(R1)            UPDATE CHARACTER POINTER     OCIP39A 08456101
VSTPAR5  EQU   *                                                 YM2369 08456501
         CLI   D0(R1),CBLANK      EMBEDDED BLANK WITHIN PARENS-  YM2369 08456901
         BE    VSTERR2            YES-DELIMITER ERROR            YM2369 08457001
         CLI   0(R1),RIGHTPAR                                   OCIP39A 08457201
         BE    VSTPAR3             BRANCH IF RIGHT PARENTHESIS  OCIP39A 08458301
         CLI   0(R1),LEFTPAR                                    OCIP39A 08459401
         BNE   VSTPAR2            BRANCH IF NOT LEFT PARENTHESISOCIP39A 08460501
         LA    R9,1(R9)            ADD 1 - LEFT PAREN.          OCIP39A 08461601
         B     VSTPAR2                                          OCIP39A 08462701
VSTPAR3  BCT   R9,VSTPAR2          SUBTRACT 1 - RIGHT PAREN.    OCIP39A 08463801
**                                  BRANCH IF NOT ZERO          OCIP39A 08464901
VSTPAR4  EQU   *                    BALANCED PARENTHESES         YM2369 08466001
         LA    R9,1(R1)            R9 PTS TO CHAR AFTER LAST    OCIP39A 08467101
**   RIGHT PAREN (SHOULD BE A COMMA DELIMITER)                  OCIP39A 08468201
         LA    R1,2(R1)                                         OCIP39A 08469301
         ST    R1,SDTPAREN         SDTPAREN PTS TO LAST         OCIP39A 08470401
**                                   RIGHT PAREN PLUS TWO       OCIP39A 08471501
**    (SHOULD BE BEGINNING OF NEXT MAJOR KEYWORD)               OCIP39A 08472601
         B     VST355              RETURN TO STORE FIRST        OCIP39A 08473701
**   SUB-PAREMETER INTO SDT                                     OCIP39A 08474801
** * * *END OF SUBR.TO PROCESS VALUES ENCLOSED IN PARENS.       OCIP39A 08475901
**                                                              OCIP39A 08477001
         EJECT                                                          08477401
** * * * **                                                     OCIP39A 08478101
** CLEANUP AND TERMINATION OF KEYWORD SCAN                      OCIP39A 08479201
VST361A  EQU   *                                                OCIP39A 08480301
         LA    R5,RETDD           RETURN ADDRESS IF DD KEYWORD  OCIP39A 08481401
         LA    R4,0(R15)                                        OCIP39A 08482501
         CR    R4,R5                                            OCIP39A 08483601
         BE    VST361B            BR.IF DD KEYWORD JUST SCANNED OCIP39A 08484701
         L     R5,SDTDDPT         FIX DD STMT.                  OCIP39A 08485801
         B     VST361C                                          OCIP39A 08486901
VST361B  L     R5,SDTEXPT         FIX EXEC CARD                 OCIP39A 08488001
VST361C  BCTR  R5,0                                             OCIP39A 08489101
         MVI   0(R5),C' '          MAKE LAST CHAR. A BLANK      OCIP39A 08490201
         LA    R4,L'VSTDD(0)       LENGTH TO REG 4              OCIP39A 08491802
         LA    R3,SDTJCL3                                       OCIP39A 08493902
         AR    R3,R4               POSITION R6 TO 1ST PARAMETER OCIP39A 08496002
**        ON IEFRDER OVERRIDE DD                                OCIP39A 08498102
         CLI   ZERO(R3),C' '       IS IT A BLANK                OCIP39A 08500202
         BNE   VST500              NO,FINISHED                  OCIP39A 08502302
         SR    R4,R4                                            OCIP39A 08504402
         IC    R4,SDTJCLS4                                      OCIP39A 08506502
         LTR   R4,R4              ARE THERE PARAMETERS          OCIP39A 08508602
**                                 ON THE DD CONT. STMT.        OCIP39A 08510702
         BNE   VST361D            YES, BRANCH                   OCIP39A 08512802
         SR    R3,R3              NO PARAMETERS ON THE DD STMT. OCIP39A 08514902
         STH   R3,SDTJCLS3         ZERO OUT LENGTH              OCIP39A 08517002
         B     VST500                                           OCIP39A 08519102
VST361D  MVI   ZERO(R3),C','                                    OCIP39A 08521202
         B     VST500             YOU ARE FINISHED                      08523302
** * * * ** END CLEANUP AND TERMINATION OF KEYWORDS  SCANNING   OCIP39A 08525402
**                                                              OCIP39A 08527502
         EJECT                                                          08529102
VST364   EQU   *                                                        08529602
         LR    R3,R4              R4 PTS.TO BEGINNING OF        OCIP39A 08531702
         BCTR  R3,ZERO    CURRENT STMT IN SDT                   OCIP39A 08533802
         BCTR  R3,ZERO            R3 PTS.TO BEG.OF CURRENT SDT  OCIP39A 08535902
         TM    ZERO(R3),SDTDD+SDTCONT                           OCIP39A 08538002
         BZ    VST364A             BR.IF NOT DD OR DD CONTIN.   OCIP39A 08540102
         LA    R3,VST361                                                08542202
         B     VST365             GET NEW SLOT FOR DD CONTIN.   OCIP39A 08544302
VST364A   LA   R3,VST361                                        OCIP39A 08546402
         B     VST356B                                          OCIP39A 08548502
VST365   EQU   *                                                        08550602
         SR    R2,R2                                                    08552702
         IC    R2,SDTJCLS4                                              08554802
         LTR    R2,R2             IS 4TH DD STATEMENT USED              08556902
         BZ    VST370             NO, USE IT                            08559002
         SR    R2,R2                                                    08561102
         IC    R2,SDTJCLS5        IS FIFTH DD STATEMENT USED            08563202
         LTR   R2,R2              NO, USE IT                            08565302
         BZ    VST375                                                   08567402
         OI    SDTJCLS6,SDTCONT6  SET DD CONTINUATION                   08569502
         MVC   SDTJCL6(2),VSTDD   MOVE // TO SDT                        08571602
         LA    R6,SDTJCL6+FOUR     POINT R6 AT COLUMN 4         OCIP39A 08573702
         BR    R3                                                       08575802
VST370   EQU   *                  FOURTH SDT SLOT                       08577902
         OI    SDTJCLS4,SDTCONT4  SET DD CONTINUATION FLAG              08580014
         MVC   SDTJCL4(2),VSTDD   MOVE // TO SDT                        08588014
         LA    R6,SDTJCL4+FOUR     POINT R6 AT COLUMN 4         OCIP39A 08596018
         BR    R3                                                       08604014
VST375   EQU   *                  FIFTH SDT SLOT                        08612014
         OI    SDTJCLS5,SDTCONT5   SET DD CONTINUATION FLAG             08628014
         MVC   SDTJCL5(2),VSTDD   MOVE // TO CONTINUATION SLOT          08636014
         LA    R6,SDTJCL5+FOUR     POINT R6 AT COLUMN 4         OCIP39A 08644018
         BR    R3                                                       08652014
VST376   EQU   *                                                        08660014
         LA    R9,1(R1)           POINT REG 9 AFTER DELIMITER           08668014
         B     VST355                                                   08676014
VST380   EQU   *                                                        08684014
         LR    R3,R4               R4 PTS.TO BEGINNING OF       OCIP39A 08684518
         BCTR  R3,ZERO         CURRENT STMT IN SDT              OCIP39A 08685018
         BCTR  R3,ZERO     R3 PTS.TO BEG.OF CURRNT SDT ENTRY    OCIP39A 08685518
         TM    ZERO(R3),SDTDD+SDTCONT                           OCIP39A 08686018
         BZ    VST356A             BR IF NOT DD OR DD CONT.     OCIP39A 08686518
         LA    R3,VST356                                        OCIP39A 08687018
         B     VST365              GET NEW SLOT FOR DD CONTIN.  OCIP39A 08687518
VST356A  LA    R3,VST356                                        OCIP39A 08688018
**                       GET SLOT FOR EXEC CONTINUATION STMT    OCIP39A 08688518
VST356B  SR    R2,R2                                            OCIP39A 08689018
         IC    R2,SDTJCLS7                                      OCIP39A 08689518
         LTR   R2,R2               IS STMT BEING USED           OCIP39A 08690018
         BZ    VST370A             NO,USE IT                    OCIP39A 08690518
         IC    R2,SDTJCLS6                                      OCIP39A 08691018
         LTR   R2,R2                                            OCIP39A 08691518
         BZ    VST375A             USE IT                       OCIP39A 08692018
         OI    SDTJCLS5,SDTEXCON   SET EXEC CONTINUATION        OCIP39A 08692518
         MVC   SDTJCL5(2),VSTDD    MOVE // TO SDT               OCIP39A 08693018
         LA    R6,SDTJCL5+FOUR     POINT 6 AT COLUMN 4          OCIP39A 08693518
         BR    R3                                               OCIP39A 08694018
VST370A  EQU   *                                                OCIP39A 08694518
         OI    SDTJCLS7,SDTEXCON   SET EXEC CONTINUATION STMT   OCIP39A 08695018
         MVC   SDTJCL7(2),VSTDD    MOVE // TO SDT               OCIP39A 08695518
         LA    R6,SDTJCL7+FOUR     POINT R6 AT 4TH COLUMN       OCIP39A 08696018
         BR    R3                                               OCIP39A 08696518
VST375A  EQU   *                                                OCIP39A 08697018
         OI    SDTJCLS6,SDTEXCON   SET EXEC CONT. STMT          OCIP39A 08697518
         MVC   SDTJCL6(2),VSTDD    MOVE // TO SDT               OCIP39A 08698018
         LA    R6,SDTJCL6+FOUR     POINT R6                     OCIP39A 08698518
         BR    R3                                               OCIP39A 08699018
VST385   EQU   *                                                        08708014
         AR    R5,R9              POINT REG 5 AT DELIMITER              08716014
         LA    R9,1(R5)          POINT REG 9 AT CHARACTER AFTER COMMA   08724014
         BR    R15                 RETURN                       OCIP39A 08724818
         EJECT                                                          08725202
**                                                              OCIP39A 08725618
** * * * * * * * INITIALIZATION FOR KEYWORD SCAN* * * * *       OCIP39A 08726418
VSTINIT  EQU   *                                                OCIP39A 08727218
         ST    R6,SDTDDPT          PT.TO NEXT SLOT IN DD STMT.  OCIP39A 08728018
         SR    R7,R7                                            OCIP39A 08728818
         ST    R7,SDTPAREN         STORE 0 TO INDICATE KEYWORD  OCIP39A 08729618
**  VALUE IS NOT ENCLOSED IN PARENTHESES                        OCIP39A 08730418
         LA    R5,L'VSTEXEC(0)                                  OCIP39A 08731218
         LA    R7,SDTJCL2                                       OCIP39A 08732018
         AR    R7,R5               PT.TO NEXT SLOT IN EXEC STMT.OCIP39A 08732818
VSTINIT2 CLI   0(R7),C' '                                       OCIP39A 08733618
         BE    VSTINIT3                                         OCIP39A 08734418
         LA    R7,1(R7)                                         OCIP39A 08735218
         B     VSTINIT2                                         OCIP39A 08736018
VSTINIT3 MVI   0(R7),C','          MOVE COMMA TO DELIMIT KEYWORDOCIP39A 08736818
         LA    R7,1(R7)                                         OCIP39A 08737618
         ST    R7,SDTEXPT                                       OCIP39A 08738418
         BR    R15                                              OCIP39A 08739218
         SPACE                                                          08740014
VST420   EQU   *                                                        08900014
         LA    R9,VST500          EXIT RTN ADDRESS TO REG 9             08908014
         LA    R4,3(R1)           POINT REG 4 TO BEGINNING OF BUFFER    08916014
         B     VST450                                                   08924014
         SPACE                                                          08932014
VST425   EQU   *                                                        08940014
         LA    R9,VST500          SET BRANCH REGISTER TO EXIT RTN       08948014
         LA    R4,2(R1)           POINT REG 4 AT BEGINNING OF BUFFER    08956014
         EJECT                                                          08964002
*********************************************************************** 08972014
*                                                                     * 08980014
*   THIS ROUTINE GETS CORE FOR THE COMMAND INPUT BUFFER FROM SUBPOOL    08988014
*   245. IT -                                                           08996002
*        -SAVES THE POINTER TO THIS CORE IN REG 0                       09004014
*        -MOVES THE LENGTH COUNT OF THE PARMVALUE INTO THE FIRST TWO    09012014
*         BYTES OF THE NEWLY ACQUIRED CORE                              09020014
*        -MOVES THE START VERB CODE INTO THE THIRD BYTE                 09028014
*        -MOVES THE PARMVALUE INTO THE REMAINING CORE                   09036014
*   IT THEN BRANCHES TO CONTINUE ITS PROCESSING                         09044014
*                                                                     * 09052014
*********************************************************************** 09060014
         SPACE                                                          09068014
VST450   EQU   *                                                        09076014
         LA    R0,CIBDATA-CIBNEXT(R5)  ADD LENGTH OF CIB CONTROL AREA   09084018
*                                  TO LENGTH OF DATA                    09092018
         O     R0,SUBPOOL              SET SUBPOOL ID TO 245      20030 09100020
         GETMAIN R,LV=(0)          GET OCRE FOR CIB                     09108018
         USING VSTARCIB,R1         ESTABLISH CIB ADDRESSIBILITY         09116018
         XC    CIBNEXT(CIBDATA-CIBNEXT),CIBNEXT  CLEAR CONTROL AREA     09124018
         LA    R0,CIBDATA-CIBNEXT+7(R5)  SET CIB LGTH IN DUBL WRDS 2336 09128018
         SRL   R0,3                DIVIDE LENGTH BY 8                   09132018
         STC   R0,CIBLEN           STORE NO. FO DOUBLE WORDS IN CIB     09140018
         LR    R0,R1               SAVE CIB ADDRESS                     09148018
         MVI   CIBVERB,CIBSTART    SET VERB CODE TO START               09156018
         MVC   CIBCONID,CHUCMP     MOVE CONSOLE ID TO C&B               09164018
         STH   R5,CIBDATLN         STORE EXACT DATA EENGTH              09172018
         LTR   R3,R5               WAS A PARMVALUE GIVEN                09180018
         BZ    VST475              NO                                   09188018
         BCTR  R3,0                REDUCE LENGTH FOR EXECUTE            09196018
         EX    R3,VSTMOVE6         MOVE DATA TO CIB                     09204018
VST475   EQU   *                                                        09212014
         BR    R9                 CONTINUE PROCESSING                   09220014
VST500A  EQU   *                                                        09250014
         LA    R9,VST500          EXIT ROUTINE                          09280014
         SR    R5,R5               ZERO PARMVALUE LEN REG          I272 09310019
         B     VST450             BUILD CIB                             09340014
         EJECT                                                          09400002
*********************************************************************** 09420000
*  SCAN CLEANUP ROUTINE - THIS ROUTINE IS USED WHEN THE SCAN PROCEDURE  09440000
*  IS COMPLETED - IT-                                                   09460019
*      .STORES RELEVANT INFORMATION IN THE START DESCRIPTOR TABLE       09480000
*      .SETS CHAIN ECB TO ZERO                                          09500000
*      .STORES RELEVANT INFORMATION IN THE CSCB                         09520000
*      .SETS UP IEEVJCL PARAMETER AREA                           Y02669 09570002
*      .ISSUES BRANCH TO IEEVJCL - JCL EDIT ROUTINE (WITH REGISTER 1    09620002
*       POINTING TO THE PARAMETER AREA)                          Y02669 09630002
*********************************************************************** 09640000
VST500   EQU   *                                                        09660014
         SPACE                                                          09680000
*                                                                       09685003
* ENQUEUE ON CSCB RESOURCE FOR FIELD INITIALIZATION            @ZA28715 09690003
*                                                                       09695003
         LR    R4,R0              SAVE CIB PTR.                @ZA28715 09700003
         LA    R0,ENQLNG          ENQ/DEQ LIST LENGTH          @ZA28715 09705003
         GETMAIN R,LV=(0)         GET LIST STORAGE             @ZA28715 09710003
         ST    R1,CHSAVWD1        SAVE GETMAIN ADDR.           @ZA28715 09715003
         MVC   D0(ENQLNG,R1),ENQLIST  INIT ENQ LIST            @ZA28715 09720003
         ENQ   ,MF=(E,(1))        ENQ ON CSCB CHAIN            @ZA28715 09725003
         LR    R0,R4              RESTORE CIB PTR.             @ZA28715 09730003
         LA    R4,SDTLN           SET LENGTH OF SDT              Y02669 09740002
         STH   R4,SDTSIZE         STORE SIZE IN SDT.                    09800000
         XC    CHSWT,CHSWT        CLEAR COMMUNICATIONS SWITCHES    I272 09812001
         NI    CHACT,CHAIFX+CHIFY LEAVE MFTII BITS ALONE           AAAA 09820015
         XC    CHSTS,CHSTS        CLEAR STATUS FLAGS             A40890 09862001
         XC    CHTYPE,CHTYPE      CLEAR STATUS FLAGS             Y01012 09865001
         XC    CHRPRTY(8),CHRPRTY ZERO OUT RESET PRTY & RESERVE  A48304 09867001
         XC    CHECB,CHECB              CLEAR COMMUNICATIONS ECB   I272 09870019
         XC    CHCECB,CHCECB            CLEAR CANCEL ECB           I272 09875019
         MVC   CHKEY,SDTJCL2+D2         TASKNAME OR 'STARTING'     I272 09880019
*                                       INTO CSCB ID FIELD         I272 09881002
         XC    CHRGNSZ,CHRGNSZ      CLEAR RGN FIELD             YM01581 09882002
         XC    CHRGNAD,CHRGNAD      CLEAR RGN FIELD             YM01581 09883002
         MVC   CHCLS,SDTJCL1+D2    PROCNAME INTO CSCB              I272 09884002
         LA    R14,CHECB          PTR TO COMMUNICATIONS ECB       20032 09890020
         ST    R14,CHECBP         MOVE INTO CSCB COMM. AREA       20032 09895020
         XC    CHJCL(4),CHJCL     ZERO OUT JCL PTR SLOT.                09900000
         LTR   R0,R0              WAS PARMVALUE SPECIFIED ON COMMAND    09936014
         BNZ   VST510             PARM VALUE SPECIFIED           Y02669 09942002
         LA    R9,VST510          SET BRANCH REGISTER                   09944002
         SR    R5,R5                                                    09946002
         B     VST450                                                   09946402
VST510   EQU   *                                                        09948014
         ST    R0,CHCIBP          CIB POINTER TO CSCB          @ZA28715 09998003
         L     R1,CHSAVWD1        ADDR. OF DEQ LIST STORAGE    @ZA28715 10008003
         MVC   D0(DEQLNG,R1),DEQLIST  INIT DEQ LIST            @ZA28715 10018003
         DEQ   ,MF=(E,(1))        DEQ FROM CSCB CHAIN          @ZA28715 10028003
         L     R1,CHSAVWD1        RESTORE ADDR FOR FREEMAIN    @ZA28715 10038003
         LA    R0,ENQLNG                                                10063402
         FREEMAIN R,LV=(0),A=(1)  FREE LIST                      Y02651 10113402
         SPACE                                                          10115402
         L     R4,SDTWORK         GET ASCB POINTER               Y02669 10117402
         USING ASCB,R4                                           Y02669 10117802
         LA    R5,CHCLS           SET POINTER TO START PROCNAME  Y02677 10127102
         ST    R5,ASCBJBNS        SAVE FOR GTF RECORD PROCESSING Y02677 10136302
         SPACE                                                          10145402
         TM    CHCECB,POSTBIT      IS CANCEL POSTED              A26309 10154402
         BO    VST527              YES, BRANCH AROUND            A26309 10163402
         XC    CHSPC,CHSPC         INITIALIZE COMP. CODE FIELD   A26309 10172702
         EJECT                                                          10182702
VST527   EQU   *                                                 A26309 10200002
*                                                                Y02669 10250002
*  GET (SUBPOOL 0) AND INITIALIZE IEEVJCL PARAMETER AREA.        Y02669 10300002
*  AREA WILL BE FREED BY IEEVJCL.                                Y02669 10350002
*                                                                Y02669 10400002
         LA    R0,STCSIZE         SET PARM AREA SUBPOOL (0)      Y02669 10450002
*                                 AND SIZE                       Y02669 10500002
         GETMAIN R,LV=(0)                                        Y02669 10510002
         SPACE                                                          10520002
         USING STCPARM,R1         SET ADDRESSABILITY             Y02669 10530002
         XC    STCBEGIN(STCSIZE),STCBEGIN CLEAR AREA             Y02669 10532002
         MVI   STCLEN+D2,STCSIZE  SET PARM AREA LENGTH           Y02669 10534002
         ST    R4,STCASCB         SET ASCB POINTER               Y02669 10536002
         ST    R10,STCSDT         SET SDT POINTER                Y02669 10538002
         DROP  R1                                                Y02669 10538402
         DROP  R4                                                Y02669 10538802
         SPACE                                                          10540000
         L     R15,VSTVJCL        BRANCH TO IEEVJCL              Y02669 10540502
         BR    R15                                               Y02669 10541002
         EJECT                                                          10548502
***                                                                 *** 10549014
*                                                                     * 10549514
*             NO UNIT PARAMETER SPECIFIED, SO INITIALIZE PTR          * 10550014
*                 AND SCAN FOR VOLUME SERIAL NUMBER                   * 10550514
*                                                                     * 10551014
***                                                                 *** 10551514
         SPACE                                                          10552014
VST600   EQU   *                                                        10552514
         LA    R1,1(R1)           POINT REG1 TO POSITION AFTER COMMA    10553014
         B     VST275             BRANCH TO VOL SER CHECKING RTN        10553514
*                                                                     * 10554014
*             NO VOLUME SERIAL PARAMETER SPECIFIED, SO INITIALIZE     * 10554514
*                 POINTER AND SCAN FOR PARMVALUE                      * 10555014
*                                                                     * 10555514
         SPACE                                                          10556014
VST625   EQU   *                                                        10556514
         LA    R8,1(R8)           INCREMENT BUFFER LENGTH COUNT         10557014
         LA    R1,1(R1)           POINT REG 1 TO CHARACTER AFTER COMMA  10557514
         B     VST325             BRANCH TO PARM VALUE SCAN             10558014
VST650   EQU   *                                                        10558514
         CR    R4,R1              IS BLANK RIGHT AFTER COMMA            10559014
         BE    VSTERR2            YES, DELIMITER ERROR                  10559514
         SR    R9,R9              ZERO REG 9, NO PARAMETERS LEFT        10560014
         B     VST250             OK, CONTINUE PROCESSING               10560514
VST675   EQU   *                                                        10561014
         CR    R4,R1              IS BLANK RIGHT AFTER COMMA            10561514
         BE    VSTERR2            YES, DELIMITER ERROR                  10562014
         SR    R9,R9              ZERO REG 9, NO PARAMETERS LEFT        10562514
         B     VST300             OK, CONTINUE PROCESSING               10563014
VST700   EQU   *                                                        10563514
         LA    R9,VST500          SET BRANCH REG TO EXIT ROUTINE        10564014
         LR    R4,R1              SET REG 4 TO BEGINNING OF PARMVALUE   10564514
         B     VST450             SET UP CIB                            10565014
VST725   EQU   *                                                        10565514
         LA    R9,VST335          SET REG 9 TO KEYWORD SCAN             10566014
         LA    R7,1(R4)           POINT REG 7 TO BEGINNING KEYWORD      10566514
         LR    R4,R1              SET REG 4 TO BEGINNING OF BUFFER      10567014
         B     VST450             GET CORE FOR CIB                      10567514
VST750   EQU   *                                                        10568014
         LA    R7,1(R1)           POINT REG 7 TO FIRST KEYWORD          10568500
         LA    R9,VST335                                                10569000
         SR    R5,R5              ZERO COUNT (NO PARMVALUE)             10569514
         B     VST450             PROCESS CIB                           10570014
         EJECT                                                          10760002
*********************************************************************** 11500000
*  ERROR MESSAGE ROUTINES                                               11520000
*********************************************************************** 11540000
VSTERR1  EQU   *                   KEYWORD MISPELLED.                   11560000
         LA    R4,9               ERROR CODE TO R4.                     11580000
         B     VSTERXT                                                  11600000
         SPACE                                                          11620000
VSTERR2  EQU   *                   DELIMITER ERROR.                     11640000
         LA    R4,7               ERROR CODE TO R4.                     11660000
         B     VSTERXT                                                  11680000
         SPACE                                                          11700000
VSTERR3  EQU   *                   TERM LENGTH ERROR.                   11720000
         LA    R4,8               ERROR CODE TO R4.                     11740000
         B     VSTERXT                                                  11760000
         SPACE                                                          11780000
VSTERR4  EQU   *                   PARAMETER MISSING.                   11800000
         LA    R4,11              ERROR CODE TO R4.                     11820000
         EJECT                                                          11940002
*********************************************************************** 11960000
*  ERROR EXIT ROUTINE - THIS ROUTINE-                                   11990019
*      .STORES THE ERROR CODE IN THE EXTENDED SAVE AREA                 12020000
*      .MOVES THE VERB INTO THE MESSAGE MODULE WORK SPACE               12040000
*      .LINKS TO IEE0503D (MESSAGE MODULE)                              12060000
*              -IEE0503D DESTROYS REGISTERS 0,1,3,4,5                   12070002
*              -INPUT = REGISTER 2 POINTS TO THE XSA                    12072002
*      .FREES THE START DESCRIPTOR TABLE                                12080000
*      .XCTLS TO IEEPRTN TO DELETE CSCB,FREE PARTITION             I272 12090019
*       AND RETURN TO THE REGION CONTROL TASK                    Y02669 12100002
*                                                                  I272 12110019
VSTERXT  EQU   *                  ERROR EXIT ROUTINE.                   12120000
         LR    R2,R10             USE SDT FOR MSG MOD WORK SPACE.       12140000
         USING VSTXSA,R2                                                12160000
         STC   R4,XAE             STORE ERROR CODE.                     12180000
         MVC   XAV(8),VSTVERB     STORE VERB INTO MESSAGE MODULE.       12200000
         XC    XAA(2),XAA         CLEAR ASCB FIELD               Y02669 12206002
         MVC   XAU(1),CHUCMP      SET UP CONSOLE ID FOR MSG MOD   M0243 12212020
         SPACE                                                          12220000
         LINK  EP=IEE0503D        LINK TO MESSAGE MODULE.               12240000
         SPACE                                                          12260000
         L     R4,SDTWORK         SAVE ASCB ADDRESS              Y02669 12270002
         LR    R1,R10             SDT ADDRESS.                          12280000
         FREEMAIN R,LV=SDTLN,A=(1)                               Y02669 12300002
         SPACE                                                          12320000
         LR    R1,R4              SET ASCB POINTER               Y02669 12400002
         DROP  R2                                                Y02669 12410002
         DROP  R10                                               Y02669 12420002
         SPACE                                                          12440000
         XCTL  EP=IEEPRTN          EXIT AND FREE PARTITION         565  12460000
         EJECT                                                          12462002
         DS    0D                                                       12470014
VSTVJCL  DC    V(IEEVJCL)                                               12480014
VSTSTING DC    C'STARTING'                                              12490014
VSTJOB   DC    C'//         JOB MSGLEVEL=1'                     OCIP39A 12510018
VSTEXEC  DC    C'//         EXEC '                              OCIP39A 12520018
VSTDD    DC    C'//IEFPROC.IEFRDER DD '                         OCIP39A 12530018
VSTUNIT  DC    C'UNIT='                                                 12550014
VSTVOL   DC    C'VOL=SER='                                      OCIP39A 12560018
VSTVERB  DC    CL8'START   '                                            12570014
VSTBT1   DC    XL9'000808000000000004' TASKNAME SCAN            YA00929 12610002
VSTBT2   DC    XL9'000808040000000800' POSITIONAL PARAMETER     YA00929 12620002
VSTBT3   DC    XL9'000C0C040000000008' VOLUME SERIAL SCAN       YA00929 12630002
VSTBT4   DC    XL9'000000040000000000'                          YA00929 12640002
VSTBT5   DC    XL9'000408000000000000'                          YA00929 12650002
VSTBT6   DC    XL9'0004040000000C0008' PROCNAME SCAN            YA00929 12656002
         SPACE                                                          12666002
VSTONE   DC    F'01'                                                    12670014
CF4      DC    F'4'                WORK CONSTANT                   I272 12673019
CF256    DC    F'256'              WORK CONSTANT                   I272 12676019
SUBPOOL  DC    XL1'F5'                 SUBPOOL 245 FOR CIB        20030 12686020
         DC    XL3'000000'                                              12710014
VBLANKS  DC    CL8' '              BLANKS FOR PADDING              I272 12715019
VST124   DC    F'124'                                                   12720014
NAT9     DC    H'9'            NATIONAL CHARACTER TRT VALUE     YA00929 12720402
ZERO     EQU   0                   CONSTANT ZERO                OCIP39A 12722018
FOUR     EQU   4                   CONSTANT FOUR                OCIP39A 12724018
NOTEQU   EQU   7                   NOT EQUAL                    OCIP39A 12726018
SIXTEEN  EQU   16                  CONSTANT SIXTEEN             OCIP39A 12728018
SDTEL    EQU   74                  LENGTH OF AN ENTRY IN SDT    OCIP39A 12730018
FAPOST   EQU   C''''               APOST                        OCIP39A 12734018
LEFTPAR  EQU   C'('                LEFT PARENTHESIS             OCIP39A 12736018
RIGHTPAR EQU   C')'                RIGHT PARENTHESIS            OCIP39A 12738018
         EJECT                                                          12740002
**************************************************              OCIP39A 12742018
*                                                               OCIP39A 12744018
**************************************************              OCIP39A 12746018
** NEW MAJOR DD KEYWORDS SHOULD BE ADDED TO THIS TABLE         OCIP39A  12748018
**  THE REASON FOR THIS IS THE FOLLOWING:                      OCIP39A  12750018
*        WHEN USING SYMBOLIC PARAMETERS ON THE START COMMAND,  OCIP39A  12752018
*        MAJOR DD KEYWORDS PARAMETERS CANNOT BE USED TO        OCIP39A  12754018
*        DEFINE SYMBOLIC PARAMETERS                            OCIP39A  12756018
*                                                               OCIP39A 12758018
DDTAB    DS    0C                  TABLE OF MAJOR DD KEYWORDS   OCIP39A 12760018
A0151    DS    0C                                               OCIP39A 12762018
         DC    AL1(B0151-A0151)                                 OCIP39A 12764018
         DC    C'AFF='                                          OCIP39A 12766018
B0151    DS    0C                                               OCIP39A 12768018
A0152    DS    0C                                               OCIP39A 12770018
         DC    AL1(B0152-A0152)                                 OCIP39A 12772018
         DC    C'SEP='                                          OCIP39A 12774018
B0152    DS    0C                                               OCIP39A 12776018
A0153    DS    0C                                               OCIP39A 12778018
         DC    AL1(B0153-A0153)                                 OCIP39A 12780018
         DC    C'DCB='                                          OCIP39A 12782018
B0153    DS    0C                                               OCIP39A 12784018
A0154    DS    0C                                               OCIP39A 12786018
         DC    AL1(B0154-A0154)                                 OCIP39A 12788018
         DC    C'DSN='                                          OCIP39A 12790018
B0154    DS    0C                                               OCIP39A 12792018
A0155    DS    0C                                               OCIP39A 12794018
         DC    AL1(B0155-A0155)                                 OCIP39A 12796018
         DC    C'VOL='                                          OCIP39A 12798018
B0155    DS    0C                                               OCIP39A 12800018
A0156    DS    0C                                               OCIP39A 12802018
         DC    AL1(B0156-A0156)                                 OCIP39A 12804018
         DC    C'UNIT='                                         OCIP39A 12806018
B0156    DS    0C                                               OCIP39A 12808018
A0157    DS    0C                                               OCIP39A 12810018
         DC    AL1(B0157-A0157)                                 OCIP39A 12812018
         DC    C'DISP='                                         OCIP39A 12814018
B0157    DS    0C                                               OCIP39A 12816018
A0158    DS    0C                                               OCIP39A 12818018
         DC    AL1(B0158-A0158)                                 OCIP39A 12820018
         DC    C'SPACE='                                        OCIP39A 12822018
B0158    DS    0C                                               OCIP39A 12824018
A0159    DS    0C                                               OCIP39A 12826018
         DC    AL1(B0159-A0159)                                 OCIP39A 12828018
         DC    C'LABEL='                                        OCIP39A 12830018
B0159    DS    0C                                               OCIP39A 12832018
A0160    DS    0C                                               OCIP39A 12834018
         DC    AL1(B0160-A0160)                                 OCIP39A 12836018
         DC    C'SPLIT='                                        OCIP39A 12838018
B0160    DS    0C                                               OCIP39A 12840018
A0161    DS    0C                                               OCIP39A 12842018
         DC    AL1(B0161-A0161)                                 OCIP39A 12844018
         DC    C'DSNAME='                                       OCIP39A 12846018
B0161    DS    0C                                               OCIP39A 12848018
A0163    DS    0C                                               OCIP39A 12850018
         DC    AL1(B0163-A0163)                                 OCIP39A 12852018
         DC    C'SYSOUT='                                       OCIP39A 12854018
B0163    DS    0C                                               OCIP39A 12856018
A0164    DS    0C                                               OCIP39A 12858018
         DC    AL1(B0164-A0164)                                 OCIP39A 12860018
         DC    C'VOLUME='                                       OCIP39A 12862018
B0164    DS    0C                                               OCIP39A 12864018
A0165    DS    0C                                               OCIP39A 12866018
         DC    AL1(B0165-A0165)                                 OCIP39A 12868018
         DC    C'DDNAME='                                       OCIP39A 12870018
B0165    DS    0C                                               OCIP39A 12872018
A0166    DS    0C                                               OCIP39A 12874018
         DC    AL1(B0166-A0166)                                 OCIP39A 12876018
         DC    C'UCS='                                          OCIP39A 12878018
B0166    DS    0C                                               OCIP39A 12880018
A0167    DS    0C                                               OCIP39A 12882018
         DC    AL1(B0167-A0167)                                 OCIP39A 12884018
         DC    C'SUBALLOC='                                     OCIP39A 12886018
B0167    DS    0C                                               OCIP39A 12888018
A0168    DS    0C                  BEGINNING OF ENTRY             19028 12888119
         DC    AL1(B0168-A0168)    LENGTH OF ENTRY                19028 12888219
         DC    C'OUTLIM='          OUTLIM KEYWORD                 19028 12888319
B0168    DS    0C                  END OF ENTRY                   19028 12888419
A0171    DS    0C                      BEGINNING OF QNAME ENTRY   20002 12889320
         DC    AL1(B0171-A0171)        LENGTH OF QNAME ENTRY      20002 12889420
         DC    C'QNAME='               QNAME= DD KEYWORD          20002 12889520
B0171    DS    0C                      END OF QNAME ENTRY         20002 12889620
A0172    DS    0C                 BEGINNING OF ENTRY              20E15 12890220
         DC    AL1(B0172-A0172)   LENGTH OF ENTRY                 20E15 12891220
         DC    C'FCB='            FCB KEYWORD                     20E15 12892401
B0172    DS    0C                 END OF ENTRY                    20E15 12893201
A0173    DS    0C                 BEGINNING OF ENTRY              21009 12893301
         DC    AL1(B0173-A0173)   LENGTH OF ENTRY                 21009 12893601
         DC    C'DLM='            DLM KEYWORD                     21009 12894001
B0173    DS    0C                 END OF ENTRY                    21009 12896001
A0174    DS    0C                 BEGINNING OF ENTRY             Y01113 12898001
         DC    AL1(B0174-A0174)   LENGTH OF ENTRY                Y01113 12898101
         DC    C'AMP='            AMP KEYWORD                    Y01113 12898201
B0174    DS    0C                 END OF ENTRY                   Y01113 12898301
A0175    DS    0C                 BEGINNING OF ENTRY             Y02670 12903702
         DC    AL1(B0175-A0175)   LENGTH OF ENTRY                Y02670 12905702
         DC    C'FREE='           FREE KEYWORD                   Y02670 12907702
B0175    DS    0C                 END OF ENTRY                   Y02670 12908102
A0176    DS    0C                                                Y02668 12915202
         DC    AL1(B0176-A0176)   LENGTH OF ENTRY                Y02668 12917202
         DC    C'DEST='           DEST KEYWORD                   Y02668 12919202
B0176    DS    0C                 END OF ENTRY                   Y02668 12921202
A0177    DS    0C                 START OF ENTRY                 Y02668 12923702
         DC    AL1(B0177-A0177)   LENGTH OF ENTRY                Y02668 12925702
         DC    C'COPIES='         COPIES KEYWORD                 Y02668 12927702
B0177    DS    0C                 END OF ENTRY                   Y02668 12934102
A0178    DS    0C                                                Y02668 12934502
         DC    AL1(B0178-A0178)                                  Y02668 12934902
         DC    C'HOLD='           'HOLD' KEYWORD                 Y02668 12935302
B0178    DS    0C                                                Y02668 12935702
A0179    DS    0C                                              @Y30OPTV 12935803
         DC    AL1(B0179-A0179)                                @Y30OPTV 12935903
         DC    C'DSID='           DSID KEYWORD FOR ERIC        @Y30OPTV 12936003
B0179    DS    0C                                              @Y30OPTV 12936103
A0180    DS    0C                                              @Y30LPTV 12939103
         DC    AL1(B0180-A0180)                                @Y30LPTV 12942103
         DC    C'MSVGP='          MSVGP KEYWORD FOR MSS SUPPORT@Y30LPTV 12947203
B0180    DS    0C                                              @Y30LPTV 12949203
A0181    DS    0C                                              @Z30JPSQ 12949603
         DC    AL1(B0181-A0181)                                @Z30JPSQ 12950003
         DC    C'CHKPT='          CHECKPOINT KEYWORD           @Z30JPSQ 12950403
B0181    DS    0C                                              @Z30JPSQ 12950803
A0182    DS    0C                                              @Z40MPSS 12951203
         DC    AL1(B0182-A0182)   LENGTH OF ENTRY              @Z40MPSS 12951503
BURST    DC    C'BURST='          BURST KEYWORD                @G16APPJ 12951803
B0182    DS    0C                                              @Z40MPSS 12952103
A0183    DS    0C                                              @Z40MPSS 12952403
         DC    AL1(B0183-A0183)   LENGTH OF ENTRY              @Z40MPSS 12952703
FLASH    DC    C'FLASH='          FLASH KEYWORD                @G16APPJ 12953003
B0183    DS    0C                                              @Z40MPSS 12953303
A0184    DS    0C                                              @Z40MPSS 12953603
         DC    AL1(B0184-A0184)   LENGTH OF ENTRY              @Z40MPSS 12953903
MODIFY   DC    C'MODIFY='         MODIFY KEYWORD               @G16APPJ 12954203
B0184    DS    0C                                              @Z40MPSS 12954503
A0185    DS    0C                                              @Z40MPSS 12954803
         DC    AL1(B0185-A0185)   LENGTH OF ENTRY              @Z40MPSS 12955103
CHARS    DC    C'CHARS='          CHARS KEYWORD                @G16APPJ 12955403
B0185    DS    0C                                              @Z40MPSS 12955703
A0186    DS    0C                                              @G29AN2E 12956003
         DC    AL1(B0186-A0186)   LENGTH OF ENTRY              @G29AN2E 12956303
SUBSYS   DC    C'SUBSYS='         SUBSYS KEYWORD               @G29AN2F 12956603
B0186    DS    0C                                              @G29AN2E 12956903
A0187    DS    0C                                              @G32HPPJ 12957203
         DC    AL1(B0187-A0187)   LENGTH OF ENTRY              @G32HPPJ 12957503
PROTECT  DC    C'PROTECT='        PROTECT KEYWORD              @G32HPPJ 12957803
B0187    DS    0C                                              @G32HPPJ 12958103
         DC    AL1(ZERO)          END OF TABLE INDICATOR        OCIP39A 12958403
         TITLE 'TRANSLATE AND TEST TABLE'                               12958703
VSTTRTAB DS    0F                                                       12960003
         DC    XL25'01010101010101010101010101010101010101010101010101' 12966003
         DC    XL25'01010101010101010101010101010101010101010101010101' 12972003
         DC    XL14'0101010101010101010101010101'                       12980000
         DC    XL1'02'                 BLANK                            13000000
         DC    XL10'01010101010101010101'                               13020000
         DC    XL1'07'                 PERIOD                           13040000
         DC    XL1'01'                                                  13060000
         DC    XL1'05'                 LEFT PAREN                       13080000
         DC    XL1'08'                 PLUS                             13100000
         DC    XL1'01'                                                  13120000
         DC    XL1'07'                 AMPERSAND                        13140000
         DC    XL10'01010101010101010101'                               13160000
         DC    XL1'09'                 DOLLAR SIGN              YA00929 13180002
         DC    XL1'07'                 ASTERISK                         13200000
         DC    XL1'06'                 RIGHT PAREN                      13220000
         DC    XL1'07'                 SEMICOLON                        13240000
         DC    XL1'01'                                                  13260000
         DC    XL1'00'                 HYPHEN                  @ZA17322 13280003
         DC    XL1'01'                 SLASH                            13300002
         DC    XL9'010101010101010101'                                  13320000
         DC    XL1'03'                 COMMA                            13340000
         DC    XL1'08'                 PERCENT                          13360000
         DC    XL14'0101010101010101010101010101'                       13380000
         DC    XL1'09'                 POUND SIGN               YA00929 13400002
         DC    XL1'09'                 AT SIGN                  YA00929 13420002
         DC    XL1'07'                 SINGLE QUOTE                     13440000
         DC    XL1'04'                 EQUAL SIGN                       13460000
         DC    XL25'01010101010101010101010101010101010101010101010101' 13480000
         DC    XL25'01010101010101010101010101010101010101010101010101' 13500000
         DC    XL16'01010101010101010101010101010101'                   13520000
         DC    XL9'00'                 A THRU I                         13540000
         DC    XL7'01010101010101'                                      13560000
         DC    XL9'00'                 J THRU R                         13580000
         DC    XL8'0101010101010101'                                    13600000
         DC    XL8'00'                 S THRU Z                         13620000
         DC    XL6'010101010101'                                        13640000
         DC    XL10'00'                0 THRU 9                         13660000
         DC    XL6'010101010101'                                        13680000
VSTABEND EQU   *                                                        13700000
VSTABLNG EQU   VSTABEND-VSTTRTAB                                        13720000
         EJECT                                                          13720402
*                                                                Y02651 13720802
*  ENQUEUE/DEQUEUE PARAMETER LISTS FOR UPDATING CIB POINTER IN   Y02651 13721202
*  THE CSCB.                                                     Y02651 13721602
*                                                                Y02651 13721702
         DS    0D                                                       13721802
ENQLIST  ENQ   (SYSNAME,RNAME,E,3,SYSTEM),RET=HAVE,MF=L          Y02651 13721902
ENQEND   EQU   *                                                 Y02651 13722602
         DS    0D                                                       13723002
DEQLIST  DEQ   (SYSNAME,RNAME,3,SYSTEM),RET=HAVE,MF=L            Y02651 13723402
DEQEND   EQU   *                                                 Y02651 13723802
         SPACE                                                          13723902
ENQLNG   EQU   ENQEND-ENQLIST     ENQUEUE LIST LENGTH            Y02651 13725202
DEQLNG   EQU   DEQEND-DEQLIST     DEQUEUE LIST LENGTH            Y02651 13727202
         SPACE                                                          13727602
SYSNAME  DC    C'SYSIEFSD'        MAJOR NAME                     Y02651 13727702
RNAME    DC    C'Q10'             MINOR NAME                     Y02651 13727802
         SPACE                                                          13727902
STCPATCH DC    CL190'* * * IEEVSTAR PATCH AREA'                @G29AN2F 13729903
         TITLE 'IEEVSTAR--ASCB MAP'                                     13736002
         IHAASCB                                                        13772002
         TITLE 'IEEVSTAR--CSCB MAP'                                     13829902
VSTRCHAN DSECT                                                          13831902
         IEECHAIN                                                       13833902
         TITLE 'IEEVSTAR--SDT MAP'                                      13838702
SDTSD    DSECT                                                          13839102
         IEESDT                                                         13839502
         TITLE 'COMMAND INPUT BUFFER'                                   13839702
VSTARCIB DSECT                                                          13839802
         IEZCIB                                                         13839902
         TITLE 'IEEVJCL PARAMETER AREA'                                 13843902
         IEEZB800                                                       13845902
         TITLE 'IEEVSTAR--XSA MAP'                                      13899902
VSTXSA   DSECT                                                          13909902
         IEEXSA                                                         13919902
         TITLE 'IEEVSTAR--CVT MAP'                             @G29AN2F 13939803
         CVT                                                   @G29AN2F 13989803
         TITLE 'IEEVSTAR--SU BITS MAP'                         @G29AN2F 14039803
         IHASUBIT                                              @G29AN2F 14089803
         END                                                            14139803
CLR8291 DUPLICATE ENTRY FOR SEQUENCE # 002808                           14189803
