         TITLE 'IFDOLT03 DATA PROTECT TAPE'                             00010000
         TITLE 'IFDOLT03  DATA PROTECT - TAPE AND UNIT RECORD' @ZA15468 00020000
         LCLA  &T,&SPN                                            0002  00030000
.@001    ANOP                                                     0002  00040000
IFDOLT03 CSECT ,                                                  0002  00050000
         BC    15,24(0,@F)                                              00060000
         DC    C'IFDOLT03 28 APR 78'                             0002  00070000
         STM   @E,@C,12(@D)                                       0002  00080000
         BALR  @B,0                                               0002  00090000
@PSTART  DS    0H                                                 0002  00100000
         USING @PSTART+00000,@B                                   0002  00110000
         ST    @D,@SAV001+4                                       0002  00120000
         LA    @F,@SAV001                                         0002  00130000
         ST    @F,8(0,@D)                                         0002  00140000
         LR    @D,@F                                              0002  00150000
*  GEN(USING CHASCT,2);                  /* COMMON AREA BASE REGISTER * 00160000
         USING CHASCT,2                                                 00170000
         DS    0H                                                       00180000
*  /******************************************************************* 00190000
*  /*                                                                 * 00200000
*  /*                CCW STRING FOR READING TAPE LABEL                * 00210000
*  /*                                                                 * 00220000
*  /******************************************************************* 00230000
*  GEN DATA;                                                            00240000
*                                                                       00250000
*                                                                       00260000
*  GEN DATA;                                                            00270000
*  GEN DATA;                                                            00280000
*         GEN DATA;                                                     00290000
*                                                                       00300000
* GENERATE DATA;                                                        00310000
*                                                                       00320000
*                                                                       00330000
*  /******************************************************************* 00340000
*  /*                                                                 * 00350000
*  /*                     DECLARED  REGISTERS                         * 00360000
*  /*                                                                 * 00370000
*  /******************************************************************* 00380000
*  DCL R0  REG(0)  PTR;                                                 00390000
*  DCL R1  REG(1)  PTR;                                                 00400000
*  DCL R2  REG(2)  PTR;                                                 00410000
*  DCL R3  REG(3)  PTR;                                                 00420000
*  DCL R4  REG(4)  PTR;                                                 00430000
*  DCL R5  REG(5)  PTR;                                                 00440000
*  DCL R6  REG(6)  PTR;                                                 00450000
*  DCL R7  REG(7)  PTR;                                                 00460000
*  DCL R8  REG(8)  PTR;                                                 00470000
*  DCL R9  REG(9)  PTR;                                                 00480000
*  DCL I REG(8);                         /* INDEX REGISTER      S21052* 00490000
*  DCL R10 REG(10) PTR;                                                 00500000
*  DCL R11 REG(11) PTR;                                                 00510000
*  DCL R12 REG(12) PTR;                                                 00520000
*  DCL R13 REG(13) PTR;                                                 00530000
*  DCL R14 REG(14) PTR;                                                 00540000
*  DCL R15 REG(15) PTR;                                                 00550000
*  RESTRICT(2,4,5,6,7,8);                                               00560000
*  DCL CESWT3 CHAR(1) GENERATED;         /* OLTEP SWITCHES       M4506* 00570000
*  DCL 1 * CHAR(1) BASED(ADDR(CESWT3)),  /* OLTEP SWITCHES       M4506* 00580000
*         2 * BIT(3),                    /* NA                   M4506* 00590000
*         2 GRBCTL BIT(1),               /* GRAB IN CONTROL      M4506* 00600000
*         2 SUSDEL BIT(1),               /* SUSPENDED DELETION   M4506* 00610000
*           3 * BIT(1);                  /* NA                   M4506* 00620000
*                                                                       00630000
*                                                                       00640000
*                                                                       00650000
*                                                                       00660000
*                                                                       00670000
*                                                                       00680000
*  /******************************************************************* 00690000
*  /*                                                                 * 00700000
*  /*                   SECTION CONTROL TABLE                         * 00710000
*  /*                                                                 * 00720000
*  /******************************************************************* 00730000
*  DCL CHASCT GENERATED;            /* SECTION CONTROL TABLE          * 00740000
*  DCL 1 * CHAR(1) BASED(ADDR(CHASCT)+10),  /* SCT STRUCTURE          * 00750000
*        3 * BIT(1),                /* NA                             * 00760000
*        3 FPM BIT(1);              /* FILE PROTECT MODE BIT          * 00770000
*                                                                       00780000
*  DCL MSSSTAT CHAR(1) GENERATED;       /* MSS STATUS BYTE    @ZA15468* 00790000
*  DCL 1 * BASED(ADDR(MSSSTAT)),        /*                    @ZA15468* 00800000
*        3 FINITSW BIT(1),              /* FUNCTIONALLY INIT  @ZA15468* 00810000
*        3 DINITSW BIT(1),              /* DIAGNOSTICALLY INIT@ZA15468* 00820000
*        3 INITSW  BIT(1),              /* INITIALIZED BIT    @ZA15468* 00830000
*        3   *     BIT(5);              /* SPARE BITS         @ZA15468* 00840000
*                                                                       00850000
*  /******************************************************************* 00860000
*  /*                                                                 * 00870000
*  /*           EXIO PARAMETER LIST                                   * 00880000
*  /*                                                                 * 00890000
*  /******************************************************************* 00900000
*                                                                       00910000
*                                       /* IO EFFECTOR CNTL BLK Y02906* 00920000
*                                       /* IN COMMON AREA       Y02906* 00930000
*  DCL EFCTRCB CHAR(20) GEND;           /* EFFECTOR CONTROL BLOCK     * 00940000
*  DCL CCWPTR PTR(31) GEND;             /* CCW LIST POINTER     Y02906* 00950000
*  DCL DVTPTR PTR(31) GEND;             /* DEVICE TABEL POINTER Y02906* 00960000
*  DCL FLGA   BIT(8)  GEND;             /* FLAG BYTE 1          Y02906* 00970000
*                                                                       00980000
*  DCL FLGB   BIT(8)  GEND;             /* FLAG BYTE 2          Y02906* 00990000
* DCL 1 FLG1A BIT(8) BASED(ADDR(FLGA)),                                 01000000
*       3 BYPASS BIT(1);                 /* BYPASS PREFIX       Y02906* 01010000
*                                                                       01020000
*                                                                       01030000
*  DCL 1 FLG2 BIT(8) BASED(ADDR(FLGB)),                       /*Y02906* 01040000
*        3 INTCALL BIT(1),              /* INTERNAL CALL FOR IO Y02906* 01050000
*        3 MODEREQ BIT(1);              /* IF ON MODE SET REQ   Y02906* 01060000
*  DCL FILEMSK CHAR(1) GEND;            /* FILE MSK FOR IOEFFEC Y02906* 01070000
* DCL SNSCNT CHAR(1) GEND;                                              01080000
* DCL TECBPTRX PTR(31) GEND;                                            01090000
*  DCL IORTNADR GEND;                   /* ADDR OF IO EFFECTOR  Y02906* 01100000
*         DCL 1 WAITLST CHAR(16) BDY(WORD), /* WAITIO LIST      Y02906* 01110000
*              3 XMGR CHAR(1) INIT('00'X), /* TRANS MGR STUFF   Y02906* 01120000
*              3 LVL CHAR(1) INIT('02'X),/* WAITIO LVL          Y02906* 01130000
*              3 MODID CHAR(2) INIT('36'), /* IFDOLT36 ID       Y02906* 01140000
*              3 TECBPTR PTR(31) INIT(ADDR(TECB)),/* TECB ADDR  Y02906* 01150000
*              3 CDSPTR PTR(31) INIT(0),  /*CDS = 0             Y02906* 01160000
*              3 FLG BIT(8) INIT('80'X), /* SET WAIT = YES      Y02906* 01170000
*               5 WAITYES BIT(1),        /* FLAG TO 1           Y02906* 01180000
*              3 TIME CHAR(2) INIT('001E'X); /* TIME IN SECONDS Y02906* 01190000
*                                                                       01200000
*                                                                       01210000
*                                                                       01220000
*  /******************************************************************* 01230000
*  /*                                                                 * 01240000
*  /*                COMMUNICATION SWITCH STRUCTURE                   * 01250000
*  /*                                                                 * 01260000
*  /******************************************************************* 01270000
*                                                                       01280000
*  DCL CESWT CHAR(5) GENERATED;     /* COMMUNICATION SWITCHES         * 01290000
*  DCL 1 * BASED(ADDR(CESWT)),      /*                                * 01300000
*        3 * BIT(8),                /* CESWT                          * 01310000
*          5 * BIT(1),              /* NA                             * 01320000
*          5 PROTECT BIT(1),        /* DP FOR PRIMARY OR SEC DEVICE   * 01330000
*          5 * BIT(6),              /* NA                             * 01340000
*        3 * BIT(8),                /* CESWT1                         * 01350000
*          5 * BIT(1),              /* NA                             * 01360000
*          5 SEEK2321 BIT(1),       /* SEEK ONLY COMMANDS ON 2321     * 01370000
*          5 SECONLOK BIT(1),       /* SEC DEV ONLINE OK              * 01380000
*          5 * BIT(1),              /* NA                             * 01390000
*          5 FILMSK BIT(1),         /* ALLOWS FILE MASK CHANGES       * 01400000
*          5 T2321 BIT(1),          /* T2321 IS DEV BEING TESTED      * 01410000
*          5 ONLINEOK BIT(1),       /* DEV IS ONLINE PROCEED          * 01420000
*          5 * BIT(1),              /* NA                             * 01430000
*        3 * BIT(8),                /* CESWT2                         * 01440000
*          5 NDCFO BIT(1),          /* PREV OCCUR OF DYN COMM INTERVAL* 01450000
*          5 DPONDEV BIT(1),        /* DP HAS BEEN DONE ON THIS DEV   * 01460000
*          5 * BIT(1),              /* NA                             * 01470000
*          5 CHANTEST BIT(1),       /* DATA PROT TO BE DONE ON CHAN   * 01480000
*          5 * BIT(1),              /* NA                             * 01490000
*          5 * BIT(1),              /* NA                             * 01500000
*          5 TAPEHDR BIT(1),        /* TAPE HEADER IS TO BE WRITTEN   * 01510000
*         5 AMERLDV BIT(1),              /* ASPEN DEVICE        S21052* 01520000
*        3 * BIT(8),                /* CESWT3                         * 01530000
*          5 * BIT(1),              /* NA                             * 01540000
*          5 BYPALDEV BIT(1),       /* BYPASS ALL TESTS AND DEVICES   * 01550000
*          5 BYPDEV BIT(1),         /* BYPASS TESTS ON THIS DEVICE    * 01560000
*          5 * BIT(1),              /* NA                             * 01570000
*          5 * BIT(1),              /* NA                             * 01580000
*          5 * BIT(1),              /* NA                             * 01590000
*          5 * BIT(1),              /* NA                             * 01600000
*          5 * BIT(1);              /* NA                             * 01610000
*                                                                       01620000
*                                                                       01630000
* /******************************************************************** 01640000
* /*                                                                  * 01650000
* /*                      DEVICE TABLE STRUCTURE                      * 01660000
* /*                                                                  * 01670000
* /******************************************************************** 01680000
*                                                                       01690000
*         DCL  1 * BASED(R7),          /*                       S21050* 01700000
*         3 DEVADEB CHAR(8),             /* DEV ADDR IN EBCDIC        * 01710000
*                3 UCBAD POINTER(31),  /* UCB ADDR (2BYTES)     S21050* 01720000
*                3 DEVFLG1 CHAR(1),    /* FLAG BYTE #1          S21050* 01730000
*                 5 STATUS BIT(1),     /* ON LINE VS. OFF-LINE  S21050* 01740000
*                 5 PRIMARY BIT(1),    /* PRIMARY BIT           S21050* 01750000
*                 5 DPDONE  BIT(1),    /* D.P. COMPLETE         S21050* 01760000
*                 5 *       BIT(3),    /* FILL                  S21050* 01770000
*                 5 FILEPROT BIT(1),   /* F.P. MODE OPERATION   S21050* 01780000
*                 5 *       BIT(1),    /* FILL                  S21050* 01790000
*                3 DEVFLG2 CHAR(1),    /* FLAG BYTE # 2         S21050* 01800000
*           5 * BIT(2),                  /* N/A                 S21050* 01810000
*           5 CEVOL BIT(1),              /* CE VOL ON DEVICE    S21050* 01820000
*                 5   STDLABL BIT(1),  /* STANDARD TAPE LABEL   S21050* 01830000
*                 5 * BIT(4),          /* FILL                  S21050* 01840000
*                3 DEVFLG3 CHAR(1),    /* FLAG BYTE # 3         S21050* 01850000
*                 5 * BIT(3),          /* N/A                         * 01860000
*                 5   TAPEBIT BIT(1),  /* NOTREADY RESTORE BIT  Y01906* 01870000
*                 5 * BIT(1),              /*                 @ZA06048* 01880000
*                 5 SYSALLOC BIT(1),       /* DEV ALLOC IN SYS        * 01890000
*                 5 * BIT(2),              /*                 @ZA06048* 01900000
*                3 DEVFLG4 CHAR(1),    /* FLAG BYTE # 3         S21050* 01910000
*                3 TAPELABL CHAR(16),  /* TAPE LABEL SAVE AREA  S21050* 01920000
*                 5 VOL CHAR(10),      /* VOL NAME              S21050* 01930000
*                 5 HDR CHAR (4),      /* HDR NAME              S21050* 01940000
*                 5 MODESV CHAR(1),    /* MODE SAVE AREA        S21050* 01950000
*                 5 * CHAR(1),         /* FILL                  S21050* 01960000
*                3 ADRHEX CHAR (4),    /* 4 BYTE HEX ADDRESS    S21050* 01970000
*                 5 * CHAR(2),         /* FILL                  S21050* 01980000
*                 5 HEXAD CHAR(2),      /* HEX ADDR (2 BYTES)   X02906* 01990000
*                3 CDSINFOR CHAR(16),    /* CDS INFORMATION     X02906* 02000000
*                  5 MODEL CHAR(1),      /* MODEL #             X02906* 02010000
*                  5 FEATURES CHAR(1),   /* FEATURES            X02906* 02020000
*                    7 STRACK BIT(1),    /* SEVEN TRACK TAPE    X02906* 02030000
*                    7 * BIT(7),         /* N/A                 X02906* 02040000
*                  5 CLASS CHAR(1),      /* CLASS               X02906* 02050000
*                  5 TYPE CHAR(1),       /* TYPE                X02906* 02060000
*                  5 * CHAR(12);         /* N/A                 X02906* 02070000
*                                                                       02080000
*                                                                       02090000
*  /******************************************************************* 02100000
*  /*                                                                 * 02110000
*  /*                  TEST EVENT CONTROL BLOCK FIELD                 * 02120000
*  /*                                                                 * 02130000
*  /******************************************************************* 02140000
*                                                                       02150000
*         DCL 1 TECB,                     /* EVENT BLOCK FOR IO Y02906* 02160000
*               2 FLDCNT CHAR(1) INIT('01'X),  /* NUMBER FDLS   Y02906* 02170000
*               2 FLDSIZE CHAR(1) INIT('0C'X), /* SIZE EACH FLD Y02906* 02180000
*               2 SOMETNG CHAR(1) INIT('00'X), /* N/A           Y02906* 02190000
*               2 SNSSIZE CHAR(1) INIT('18'X), /* SENSE EXPTD   Y02906* 02200000
*               2 FLG1 CHAR(1) INIT('00'X),    /* FLAGS         Y02906* 02210000
*               2 SNSCNTTB CHAR(1) INIT('01'X), /* XPECTED COUNTY02906* 02220000
*               2 CLRTECB CHAR(39),      /* LABEL TO CLEAR TECB YM3336* 02230000
*                 3 CNTSNS CHAR(1) INIT('00'X), /* NUMB OCCURED Y02906* 02240000
*                 3 CNTINT CHAR(1) INIT('00'X), /*NUMB INTERRUPTY02906* 02250000
*                 3 CCP CHAR(1),        /* SIO COND CODE        Y02906* 02260000
*                 3 * CHAR(3),          /* N/A                  YM3336* 02270000
*                 3 CSW1 CHAR(8),       /* CSW NO. ONE          Y02906* 02280000
*                   5 * CHAR(4),        /* N/A                  Y02906* 02290000
*                   5 STATUSX CHAR(2),  /* TWO STATUS BYTES     Y02906* 02300000
*                     7 EXIOK CHAR(1),  /* STATUS BYTE 1        Y02906* 02310000
*                       9 * BIT(6),     /* N/A                  Y02906* 02320000
*                       9 UNITCK BIT(1), /* UNIT CHECK          Y02906* 02330000
*                       9 UNITEXCP BIT(1), /* UNIT EXCEPTION BITY02906* 02340000
*                     7 BYTE2 CHAR(1),  /* STATUS BYTE 2        Y02906* 02350000
*                       9 * BIT(1),     /* N/A                  Y02906* 02360000
*                       9 INLENGTH  BIT(1), /* INCORR LNG IND   Y02906* 02370000
*                       9 * BIT(6),     /* N/A                  Y02906* 02380000
*                   5 * CHAR(2),        /* N/A                  Y02906* 02390000
*                 3 SENSE CHAR(24),     /* SENSE COUNT          Y02906* 02400000
*                   5 * CHAR(3),        /* N/A                  Y02906* 02410000
*                   5 SNS1 CHAR(7),     /* SENSE BYTES          Y02906* 02420000
*                     7 SNSFLD BIT(8),  /* BYTE0  SENSE         Y02906* 02430000
*                       9 * BIT(1),     /* N/A                  Y02906* 02440000
*                       9 SNS2 BIT(1),  /* BIT 1 SNS BYTE 0     Y02906* 02450000
*                     7 * CHAR(2),      /* SNS BYTES 1 & 2      Y02906* 02460000
*                     7 * BIT(8),       /* SNS BYTE 3           Y02906* 02470000
*                       9 * BIT(5),     /* FILL                 Y02906* 02480000
*                       9 PEIND BIT(1), /* BIT 5 BYTE3 OF SNS   Y02906* 02490000
*                     7 * CHAR(2),      /* SENCE BYTES 4 AND 5  Y02906* 02500000
*                     7 * CHAR(1),      /* SENCE BYTE 6         Y02906* 02510000
*                       9 * BIT(4),     /* NOT REFERENCED       Y02906* 02520000
*                       9 BIT4 BIT(1);  /* BIT FOUR FOR BIRTCH  Y03128* 02530000
*                                                                       02540000
*  DCL 1 LABEL1 CHAR(80),                                               02550000
*       2 TAPEVOL CHAR(10),                                             02560000
*        3 VOLAB CHAR(4),                                               02570000
*        3 VOLSERNO CHAR(6),                                            02580000
*       2 SECURE CHAR(1),              /* TAPE SECURITY BIT     Y01906* 02590000
*       2 * CHAR(69);                  /* N/A                   Y01906* 02600000
*  DCL 1 LABEL2 CHAR(80) BASED(ADDR(LABEL1)),                           02610000
*       3 HDRLAB CHAR(4),                                               02620000
*        3 * CHAR(43),                                                  02630000
*        3 * CHAR(7),                                                   02640000
*           5 * CHAR(1),                                                02650000
*           5 DATE1 CHAR(5),                                            02660000
*          5 * CHAR(1),                /* N/A                   Y01906* 02670000
*        3 * CHAR(26);                                                  02680000
*                                                                       02690000
*                                                                       02700000
*  /******************************************************************* 02710000
*  /*                                                                 * 02720000
*  /*                    MESSAGE STRUCTURES                           * 02730000
*  /*                                                                 * 02740000
*  /******************************************************************* 02750000
*                                                                       02760000
*  DCL IFDMSG03 EXT ENTRY;          /* MESSAGE MODULE                 * 02770000
*  DCL MSGPTR PTR INIT(ADDR(IFDMSG03)); /* POINTER TO MESSAGE MODULE  * 02780000
*  DCL 1 * BASED(R4),               /* MESSAGE ADDRESS                * 02790000
*        3 MSG1 PTR,                /* POINTER TO MESSAGE             * 02800000
*        3 MSG2 PTR,                /* POINTER TO MESSAGE             * 02810000
*        3 MSG3 PTR,                /* POINTER TO MESSAGE             * 02820000
*        3 MSG4 PTR,                /* POINTER TO MESSAGE             * 02830000
*        3 MSG5 PTR,                /* POINTER TO MESSAGE             * 02840000
*        3 MSG6 PTR,                /* POINTER TO MESSAGE             * 02850000
*        3 MSG7 PTR,                /* POINTER TO MESSAGE             * 02860000
*        3 MSG8 PTR,                     /* POINTER TO MESSAGE        * 02870000
*        3 MSG9 PTR,                     /* POINTER TO IFD130I  Y01906* 02880000
*        3 MSGA PTR,                     /* POINTER TO IFD138I  Y01906* 02890000
*        3 MSGB PTR,                     /* POINTER TO IFD139D  Y02008* 02900000
*        3 MSGC PTR,                    /* POINTER TO MSG C   @ZA15468* 02910000
*        3 MSGD PTR,                    /* POINTER TO MSG D   @ZA15468* 02920000
*        3 MSGE PTR,                    /* POINTER TO MSG E   @ZA15468* 02930000
*        3 MSGF PTR,                    /* POINTER TO MSG F   @ZA15468* 02940000
*'       3 MSGG PTR;                    /* POINTER TO MSG G   @ZA15468* 02950000
*'                                                                      02960000
*  DCL 1 MSG109 BASED(R1),                 /* FORMAT          @ZA06048* 02970000
*        3 * CHAR(12),                     /*                 @ZA06048* 02980000
*        3 MSGDVAD CHAR(8),                /* DEVICE ADDRESS  @ZA06048* 02990000
*        3 * CHAR(1),                      /*                 @ZA06048* 03000000
*        3 ONOROFF CHAR(8),                /* ON OR OFF LINE  @ZA06048* 03010000
*        3 ALORNOT CHAR(11);               /* ALLOCATED OR NOT        * 03020000
*  DCL MSGDVAD1 CHAR(8) BASED(R1+34);    /*DEV ADDR AREA IN MSG S21050* 03030000
*  DCL MSGDVAD2 CHAR(8) BASED(R1+36);    /*DEV ADDR AREA IN MSG S21050* 03040000
*  DCL MSGDVAD3 CHAR(8) BASED(R1+19);    /*DEV ADDR AREA IN MSG S21050* 03050000
*  DCL MSGDVAD4 CHAR(8) BASED(R1+19);    /*DEV ADDR AREA IN MSG S21050* 03060000
*  DCL MSGDVAD9 CHAR(8) BASED(R1+29);    /*DEV ADDR AREA IN MSG S21050* 03070000
*  DCL MSGDVADA CHAR(8) BASED(R1+16);    /*DEV ADDR AREA IN MSG S21050* 03080000
*  DCL MSGDVA39 CHAR(8) BASED(R1+39);    /*DEV ADDR AREA IN MSG Y02008* 03090000
*  DCL  MSGSNS CHAR(12) BASED (R1+37);   /* SENSE DATA IN 137I  Y01906* 03100000
*  DCL MSGCSW CHAR(14) BASED(R1+18);     /* CSW DATA AREA       S21050* 03110000
*  DCL MSGDVADD CHAR(8) BASED(R1+38);   /* DEVICE ADDRESS     @ZA15468* 03120000
*  DCL MSGDVADG CHAR(8) BASED(R1+22);   /* DEVICE ADDRESS     @ZA15468* 03130000
*  DCL MSGINIT CHAR(14) BASED(R1+43);   /* HOW INITIALIZED    @ZA15468* 03140000
*  DCL 1 MSGPARM BASED(R1),         /* NA                             * 03150000
*        3 LENGTH CHAR(1),          /* LENGTH OF RESPONSE             * 03160000
*        3 BUFAD PTR(24),           /* POINTER TO RESPONSE BUFFER     * 03170000
*        3 MSGECBAD FIXED;          /* ECB ADDRESS                    * 03180000
*  DCL DECB FIXED INIT(0);          /* EVENT CONTROL BLOCK            * 03190000
*   DCL INBUFR CHAR(72) GENERATED;                                      03200000
*    DCL BUFFER CHAR(1) BASED(ADDR(INBUFR));                            03210000
*                                                                       03220000
*                                                                       03230000
*  DCL SECDVPTR PTR(31) GENERATED;  /* DEVICE  TABLE POINTER          * 03240000
*  DCL 1 INBUF  CHAR(62),                /* INPUT BUFFER        S21052* 03250000
*         3 CSWIN CHAR(14),              /* CONVERTED CSW DATA  S21052* 03260000
*        3 * CHAR(6),                  /* CONVERTED DEV ADDR   Y02906*/ 03270000
*         3 SNSIN CHAR(48);              /* CONVERTED SNS DATA  S21052* 03280000
*  DCL AREA FIXED BDY(WORD) INIT(0);     /* AREA FOR PACKED DEC DATE  * 03290000
*  DCL AREA1 CHAR(6) INIT('000000000000'X); /* AREA FOR UNPACKED DATE * 03300000
*         DCL XAREA CHAR(5) BASED(ADDR(AREA1)+1);                       03310000
*  DCL RDLAB LABEL GENERATED;       /* CCW LABEL                      * 03320000
*  DCL RDLAB1 LABEL GENERATED;      /* CCW LABEL                      * 03330000
*  DCL URSNS LABEL GENERATED;            /* LABEL FOR CCW       Y01906* 03340000
*  DCL TAB28 PTR(31) GENERATED;     /* NEW MACRO ENTRY POINT          * 03350000
*  DCL CNVRT CHAR(14) GENERATED;    /* CONVERT PARAMETER LIST         * 03360000
*  /******************************************************************* 03370000
*  /*                                                                 * 03380000
*  /*                         ONLINE STATUS CHECK                     * 03390000
*  /*                                                                 * 03400000
*  /******************************************************************* 03410000
*  DPTAPE00:                                                            03420000
*         R4=MSGPTR;                     /*PUT PTR TO MESSAGE MODULE  * 03430000
DPTAPE00 L     @4,MSGPTR                                          0081  03440000
*  IF STATUS = '1'B THEN             /* IF DEVICE IS ONLINE   @ZA02796* 03450000
         TM    12(@7),B'10000000'                                 0082  03460000
         BC    12,@9FF                                            0082  03470000
*   DO;                              /*                       @ZA02796* 03480000
*    IF CLASS = '08'X &              /* IF DEVICE             @ZA02796* 03490000
*       TYPE = '42'X THEN            /* IS MSC                @ZA02796* 03500000
         CLI   38(@7),X'08'                                       0084  03510000
         BC    07,@9FE                                            0084  03520000
         CLI   39(@7),X'42'                                       0084  03530000
*       GOTO ONLINOK;                /* ONLINE IS OK          @ZA02796* 03540000
         BC    08,ONLINOK                                         0085  03550000
*     GOTO DPTAPE01;                 /* GO PRINT MESSAGE      @ZA02796* 03560000
         BC    15,DPTAPE01                                        0086  03570000
*   END;                                                    /*@ZA01047* 03580000
* ONLINOK:                           /*                       @ZA02796* 03590000
*         IF DPDONE='1'B THEN                                           03600000
@9FF     EQU   *                                                  0088  03610000
ONLINOK  TM    12(@7),B'00100000'                                 0088  03620000
*         RETURN;                                                       03630000
         BC    03,@EL01                                           0089  03640000
*         STDLABL='0'B;                  /* ZERO STANDARD LABEL BIT   * 03650000
@9FC     NI    13(@7),B'11101111'                                 0090  03660000
*  /******************************************************************* 03670000
*  /*                                                                 * 03680000
*  /*                          SET UP FOR EXIO                        * 03690000
*  /*                                                                 * 03700000
*  /******************************************************************* 03710000
*   PROTECT = '1'B;                      /*                     Y01906* 03720000
         OI    A00007,B'01000000'                                 0091  03730000
*   IF CLASS = '08'X THEN              /* IS IT UNIT RECORD DEV,Y01906* 03740000
         CLI   38(@7),X'08'                                       0092  03750000
*      GOTO URXIO;                     /* YES,GO CHECK FOR READYY01906* 03760000
         BC    08,URXIO                                           0093  03770000
*                                                                       03780000
*   MODEREQ = '1'B;                      /* REQUEST MODE SET    Y01906* 03790000
         OI    FLG2,B'01000000'                                   0094  03800000
*         CCWPTR = ADDR(RDLAB);         /* SET CCW PTR          Y02906* 03810000
         LA    @F,RDLAB                                           0095  03820000
         ST    @F,CCWPTR                                          0095  03830000
*         IF STRACK ='1'B THEN                                          03840000
         TM    37(@7),B'10000000'                                 0096  03850000
         BC    12,@9FB                                            0096  03860000
*           FILEMSK='AB'X;                                    /*Y02906* 03870000
         MVI   FILEMSK,X'AB'                                      0097  03880000
         BC    15,@9FA                                            0098  03890000
*         ELSE FILEMSK='03'X;                                 /*Y02906* 03900000
@9FB     MVI   FILEMSK,X'03'                                      0098  03910000
*  GEN(BAL   R5,IORTN);                  /* I/O ROUTINES         M4506* 03920000
@9FA     EQU   *                                                  0099  03930000
         BAL   R5,IORTN                                                 03940000
         DS    0H                                                       03950000
*  IF EXIOK = '0D'X THEN                 /* IF CE + DE + UE THENY01906* 03960000
         CLI   TECB+16,X'0D'                                      0100  03970000
*    GOTO DPTAPE03;                      /*                      M4506* 03980000
         BC    08,DPTAPE03                                        0101  03990000
*  IF EXIOK ^= '0C'X THEN                /* IF NOT CE + DE THEN Y01906* 04000000
         CLI   TECB+16,X'0C'                                      0102  04010000
         BC    08,@9F9                                            0102  04020000
*   DO;                                  /* UC AND OTHER ERRORS Y01906* 04030000
*     IF  STRACK='0'B THEN               /* CHECK FOR 7-TRK     S21052* 04040000
         TM    37(@7),B'10000000'                                 0104  04050000
*       GOTO DPTAPE02;                   /* 9-TRK BRANCH        S21052* 04060000
         BC    08,DPTAPE02                                        0105  04070000
*     FILEMSK='2B'X;                     /* SET 7-TRK 200 BPI   Y02906* 04080000
         MVI   FILEMSK,X'2B'                                      0106  04090000
*     GEN(BAL   R5,IORTN);               /* EXECUTE I/O         S21052* 04100000
         BAL   R5,IORTN                                                 04110000
         DS    0H                                                       04120000
*     IF EXIOK='0D'X THEN                /* UNIT EXCEPTION      S21052* 04130000
         CLI   TECB+16,X'0D'                                      0108  04140000
*       GOTO DPTAPE03;                   /* NON-STD LABEL       S21052* 04150000
         BC    08,DPTAPE03                                        0109  04160000
*     IF EXIOK ^='0C'X THEN              /* NOT OKAY            S21052* 04170000
         CLI   TECB+16,X'0C'                                      0110  04180000
         BC    08,@9F8                                            0110  04190000
*       DO;                              /*                     S21052* 04200000
*         FILEMSK='6B'X;                /* SET 7-TRK 556 BPI    Y02906* 04210000
         MVI   FILEMSK,X'6B'                                      0112  04220000
*         GEN(BAL   R5,IORTN);           /* EXECUTE I/O         S21052* 04230000
         BAL   R5,IORTN                                                 04240000
         DS    0H                                                       04250000
*         IF EXIOK='0D'X THEN            /* UNIT EXCEPTION      S21052* 04260000
         CLI   TECB+16,X'0D'                                      0114  04270000
*           GOTO DPTAPE03;               /* NON-STD LABEL       S21052* 04280000
         BC    08,DPTAPE03                                        0115  04290000
*         IF EXIOK ^='0C'X THEN          /* NOT OKAY            S21052* 04300000
         CLI   TECB+16,X'0C'                                      0116  04310000
*           GOTO DPTAPE02;               /* UNREADABLE LABEL    S21052* 04320000
         BC    07,DPTAPE02                                        0117  04330000
*       END;                             /*                     S21052* 04340000
*   END;                                 /*                     S21052* 04350000
@9F8     EQU   *                                                  0119  04360000
*   TAPEBIT = '0'B;                      /* DRIVE IS READY      Y01906* 04370000
@9F9     NI    14(@7),B'11101111'                                 0120  04380000
*  /******************************************************************* 04390000
*  /*                                                                 * 04400000
*  /*                CHECK FOR CORRECT LENGTH & VOL1 IN LABEL         * 04410000
*  /*                                                                 * 04420000
*  /******************************************************************* 04430000
*  IF INLENGTH ='1'B |              /* IF INCORRECT LENGTH IND OR     * 04440000
*     VOLAB ^= 'VOL1' THEN          /* IF VOL1 IS NOT IN THE LABEL    * 04450000
         TM    TECB+17,B'01000000'                                0121  04460000
         BC    01,@9F7                                            0121  04470000
         CLC   LABEL1(4),@C11                                     0121  04480000
         BC    08,@9F6                                            0121  04490000
*     GOTO DPTAPE03;                /* PRINT MESSAGE TO OPERATOR      * 04500000
         BC    07,DPTAPE03                                        0122  04510000
*  IF SECURE^='F0'X &                    /* CHECK FOR KNOWN NON-Y01906* 04520000
*     SECURE^='40'X &                    /* SECURITY CHARACTERS Y01906* 04530000
*     SECURE^='00'X THEN                 /* IF NOT SECURE       Y01906* 04540000
@9F6     CLI   LABEL1+10,X'F0'                                    0123  04550000
         BC    08,@9F5                                            0123  04560000
         CLI   LABEL1+10,X'40'                                    0123  04570000
         BC    08,@9F4                                            0123  04580000
         CLI   LABEL1+10,X'00'                                    0123  04590000
*     GO TO DPTAPE06;               /* GO PRINT MSG 122I        Y01906* 04600000
         BC    07,DPTAPE06                                        0124  04610000
*         VOL=TAPEVOL;                   /*SAVE VOL SER # IN DEVTAB */  04620000
@9F3     EQU   *                                                  0125  04630000
@9F4     EQU   *                                                  0125  04640000
@9F5     MVC   16(10,@7),LABEL1                                   0125  04650000
*         IF STRACK='0'B THEN                                           04660000
         TM    37(@7),B'10000000'                                 0126  04670000
         BC    05,@9F2                                            0126  04680000
*             DO;                                            /* Y02128* 04690000
*            IF PEIND='1'B THEN                             /* Y02128*/ 04700000
         TM    TECB+26,B'00000100'                                0128  04710000
         BC    12,@9F1                                            0128  04720000
*              DO;                                          /* Y02128*/ 04730000
*               FILEMSK = 'C3'X;                             /* YM3334* 04740000
         MVI   FILEMSK,X'C3'                                      0130  04750000
*               GOTO SETEXIO;                                /* Y02128* 04760000
         BC    15,SETEXIO                                         0131  04770000
*             END;                                           /* Y02128* 04780000
*             FILEMSK = 'CB'X;                               /* YM3334* 04790000
@9F1     MVI   FILEMSK,X'CB'                                      0133  04800000
*           IF BIT4 =  '1'B THEN       /* IS THIS A BIRCH       X03128* 04810000
         TM    TECB+29,B'00001000'                                0134  04820000
         BC    12,@9F0                                            0134  04830000
*              FILEMSK='D3'X;          /* IF YES SET FILE MSK   X03128* 04840000
         MVI   FILEMSK,X'D3'                                      0135  04850000
*               END;                                         /* Y02128* 04860000
@9F0     EQU   *                                                  0136  04870000
*  /******************************************************************* 04880000
*  /*                                                                 * 04890000
*  /*                          SET UP FOR EXIO                        * 04900000
*  /*                                                                 * 04910000
*  /******************************************************************* 04920000
* SETEXIO:                                                   /* Y02128* 04930000
*         CCWPTR = ADDR(RDLAB1);        /* SET CCW PTR          Y02906* 04940000
@9F2     EQU   *                                                  0137  04950000
SETEXIO  LA    @F,RDLAB1                                          0137  04960000
         ST    @F,CCWPTR                                          0137  04970000
*  GEN(BAL   R5,IORTN);                  /* I/O ROUTINES         M4506* 04980000
         BAL   R5,IORTN                                                 04990000
         DS    0H                                                       05000000
*  IF UNITEXCP='1'B THEN            /* INDICATES TAPE MARK            * 05010000
         TM    TECB+16,B'00000001'                                0139  05020000
         BC    12,@9EF                                            0139  05030000
*    DO;                                                                05040000
*    HDR=' ';                       /*PUT BLANKS IN HDR AREA OF DEVTAB* 05050000
         MVI   26(@7),C' '                                        0141  05060000
         MVC   27(3,@7),26(@7)                                    0141  05070000
*    GOTO SETBITS;                                                      05080000
         BC    15,SETBITS                                         0142  05090000
*    END;                                                               05100000
*         IF EXIOK='0E'X THEN            /* WAS EXIO SUCESSFUL   M4505* 05110000
@9EF     CLI   TECB+16,X'0E'                                      0144  05120000
*           GOTO DPTAPE02;               /* YES, GO PRINT MSG    M4505* 05130000
         BC    08,DPTAPE02                                        0145  05140000
*  IF INLENGTH = '1'B |             /* IF INCORRECT LENGTH BIT IS ON  * 05150000
*     HDRLAB ^= 'HDR1' THEN         /* OR HDR1 IS NOT ON TAPE         * 05160000
         TM    TECB+17,B'01000000'                                0146  05170000
         BC    01,@9EE                                            0146  05180000
         CLC   LABEL2(4),@C20                                     0146  05190000
         BC    08,@9ED                                            0146  05200000
*     GOTO DPTAPE03;                /* GO PRINT MESSAGE               * 05210000
         BC    07,DPTAPE03                                        0147  05220000
*  /******************************************************************* 05230000
*  /*                                                                 * 05240000
*  /*           HDR1, EXPIRATION DATE & DATA SECURITY CHECK           * 05250000
*  /*                                                                 * 05260000
*  /******************************************************************* 05270000
*                                        /* GET TODAY'S DATE    Y01906* 05280000
*  GEN;                                                                 05290000
@9ED     EQU   *                                                  0148  05300000
         TIME                                                           05310000
         DS    0H                                                       05320000
*  AREA = R1;                       /* PUT DATE TO BE UNPACKED IN AREA* 05330000
         ST    @1,AREA                                            0149  05340000
*  GEN;                                                                 05350000
         UNPK  AREA1(6),AREA+1(3)     UNPACK DATE                       05360000
         OI    AREA1+5,X'F0'          CHANGE LAST BYTE                  05370000
         DS    0H                                                       05380000
*         IF DATE1 > XAREA THEN    /*IF THE EXPIRATION DATE EXCEEDS*/   05390000
         CLC   LABEL2+48(5),XAREA                                 0151  05400000
         BC    12,@9EC                                            0151  05410000
*           DO;                                                         05420000
*           STDLABL='1'B;                /*SET STANDARD LABEL BIT     * 05430000
         OI    13(@7),B'00010000'                                 0153  05440000
*     GOTO DPTAPE08;                /* THE CURRENT DATE GO PRINT MSG. * 05450000
         BC    15,DPTAPE08                                        0154  05460000
*           END;                                                        05470000
*         HDR=HDRLAB;                    /*SAVE HDR1 IN DEVTAB  */      05480000
@9EC     MVC   26(4,@7),LABEL2                                    0156  05490000
*  SETBITS:                                                             05500000
*  STDLABL='1'B;                    /* SET STANDARD LABEL BIT         * 05510000
SETBITS  OI    13(@7),B'00010000'                                 0157  05520000
*       DPDONE='1'B;                                                    05530000
         OI    12(@7),B'00100000'                                 0158  05540000
*  GOTO DPTAPE10;                   /* AND RETRN TO CALLING MODULE    * 05550000
         BC    15,DPTAPE10                                        0159  05560000
*  /******************************************************************* 05570000
*  /*                                                                 * 05580000
*  /*                     PRINT MESSAGE IFD109I                       * 05590000
*  /*     XXXXXXXX NOT OFFLINE                                        * 05600000
*  /******************************************************************* 05610000
*  DPTAPE01:                                                            05620000
*  R1=MSG1;                         /* POINTER TO MESSAGE             * 05630000
DPTAPE01 L     @1,0(0,@4)                                         0160  05640000
*  MSGDVAD=DEVADEB;                 /* PUT DEVICE ADDRESS IN MSG1     * 05650000
         MVC   12(8,@1),0(@7)                                     0161  05660000
*  ONOROFF='ONLINE ,';                     /* SAY DEV ONLINE  @ZA06048* 05670000
         MVC   21(8,@1),@C21                                      0162  05680000
*  IF SYSALLOC='1'B                        /* CHECK ALLOCATION        * 05690000
*    THEN                                  /*                 @ZA06048* 05700000
         TM    14(@7),B'00000100'                                 0163  05710000
         BC    12,@9EB                                            0163  05720000
*      ALORNOT='ALLOCATED  ';              /* IF SO,SAY SO    @ZA06048* 05730000
         MVC   29(11,@1),@C22                                     0164  05740000
         BC    15,@9EA                                            0165  05750000
*    ELSE                                  /* IF NOT,         @ZA06048* 05760000
*      ALORNOT='UNALLOCATED';              /* AGAIN,SAY SO    @ZA06048* 05770000
@9EB     MVC   29(11,@1),@C23                                     0165  05780000
*  GEN(BAL   R5,DPTAPE13);               /* PRINT MESSAGE        M4506* 05790000
@9EA     EQU   *                                                  0166  05800000
         BAL   R5,DPTAPE13                                              05810000
         DS    0H                                                       05820000
*  BYPDEV='1'B;                     /* SET BYPASS BIT                 * 05830000
         OI    A00007+3,B'00100000'                               0167  05840000
*         RETURN;                                                       05850000
         BC    15,@EL01                                           0168  05860000
*  DPTAPE02:                                                            05870000
*  IF CCP='F3'X THEN                /* IF CC=3                  YM3332* 05880000
DPTAPE02 CLI   TECB+8,X'F3'                                       0169  05890000
*    GOTO DPTAPE12;                      /*GO PRINT MESSAGE           * 05900000
         BC    08,DPTAPE12                                        0170  05910000
*         IF SNS2='1'B THEN                                             05920000
         TM    TECB+23,B'01000000'                                0171  05930000
*    GOTO DPTAPE11;               /*PRINT INTERVENTION REQUIRED MSG   * 05940000
         BC    01,DPTAPE11                                        0172  05950000
*    IF CLASS = '08'X THEN               /* IF UNIT RECORD      Y02008* 05960000
         CLI   38(@7),X'08'                                       0173  05970000
         BC    07,@9E9                                            0173  05980000
*      DO;                               /* YES                 Y02008* 05990000
*        R1=MSGC;                        /* SET POINTER IFD212I Y02008* 06000000
         L     @1,44(0,@4)                                        0175  06010000
*        MSGDVA39 = DEVADEB;             /* DEVICE ADDR IN MSG  Y02008* 06020000
         MVC   39(8,@1),0(@7)                                     0176  06030000
*        GEN(BAL   R5,DPTAPE13);         /* GO PRINT            Y02008* 06040000
         BAL   R5,DPTAPE13                                              06050000
         DS    0H                                                       06060000
*        GOTO DPTAPE04;                  /* ISSUE NEXT          Y02008* 06070000
         BC    15,DPTAPE04                                        0178  06080000
*      END;                              /* NO                  Y02008* 06090000
*   TAPEBIT='0'B;                        /* NO RESTORE NTRDY BITY01906* 06100000
@9E9     NI    14(@7),B'11101111'                                 0180  06110000
*  /******************************************************************* 06120000
*  /*                                                                 * 06130000
*  /*                     PRINT MESSAGE IFD118I                       * 06140000
*  /*     UNREADABLE TAPE LABEL-XXXXXXXX                              * 06150000
*  /******************************************************************* 06160000
*  R1=MSG2;                         /* POINTER TO MESSAGE             * 06170000
         L     @1,4(0,@4)                                         0181  06180000
*  MSGDVAD1=DEVADEB;                /* PUT DEVICE ADDRESS IN MSG2     * 06190000
         MVC   34(8,@1),0(@7)                                     0182  06200000
*  GEN(BAL   R5,DPTAPE13);               /* PRINT MESSAGE        M4506* 06210000
         BAL   R5,DPTAPE13                                              06220000
         DS    0H                                                       06230000
*  GOTO DPTAPE04;                   /* GO PRINT SENSE/CSW DATA        * 06240000
         BC    15,DPTAPE04                                        0184  06250000
*  /******************************************************************* 06260000
*  /*                     PRINT MESSAGE IFD119I                       * 06270000
*  /*     NON-STANDARD TAPE LABEL-XXXXXXXX                            * 06280000
*  /*                                                                 * 06290000
*  /******************************************************************* 06300000
*  DPTAPE03:                                                            06310000
*  R1=MSG4;                         /* POINTER TO MESSAGE             * 06320000
DPTAPE03 L     @1,12(0,@4)                                        0185  06330000
*  MSGDVAD2=DEVADEB;                /* PUT DEVICE ADDRESS IN MSG4     * 06340000
         MVC   36(8,@1),0(@7)                                     0186  06350000
*  GEN(BAL   R5,DPTAPE13);               /* PRINT MESSAGE        M4506* 06360000
         BAL   R5,DPTAPE13                                              06370000
         DS    0H                                                       06380000
*  GOTO DPTAPE05;                   /* GO PRINT OPTION MESSAGE        * 06390000
         BC    15,DPTAPE05                                        0188  06400000
*  /******************************************************************* 06410000
*  /*                                                                 * 06420000
*  /*                     CONVERT SENSE/CSW DATA                      * 06430000
*  /*                                                                 * 06440000
*  /******************************************************************* 06450000
*  DPTAPE04:                                                            06460000
*  GEN(BAL   R14,NEWCONV);               /* CONVERT CALL         M4506* 06470000
DPTAPE04 BAL   R14,NEWCONV                                              06480000
         DS    0H                                                       06490000
*  SUSDEL='1'B;                          /* SUSPEND DELETION     M4506* 06500000
         OI    A00000,B'00001000'                                 0190  06510000
*  GEN(BAL   R14,NEWCONV);               /* CONVERT CALL         M4506* 06520000
         BAL   R14,NEWCONV                                              06530000
         DS    0H                                                       06540000
*  /******************************************************************* 06550000
*  /*                                                                 * 06560000
*  /*                     PRINT MESSAGE IFD137I                       * 06570000
*  /*           CSW-XXXXXXXXXXXXXXXX SNS-YYYYYYYYYYYY                 * 06580000
*  /******************************************************************* 06590000
*  R1=MSG3;                         /* POINTER TO MESSAGE             * 06600000
         L     @1,8(0,@4)                                         0192  06610000
*  MSGCSW=CSWIN;                    /* PUT CSW DATA IN MSG3           * 06620000
         MVC   18(14,@1),INBUF                                    0193  06630000
*         MSGSNS = SNSIN;                /* PUT SENSE IN MSG    X02906* 06640000
         MVC   37(12,@1),INBUF+20                                 0194  06650000
*         GEN(BAL  R5,DPTAPE13);         /* PRINT MSG           S21052* 06660000
         BAL  R5,DPTAPE13                                               06670000
         DS    0H                                                       06680000
*  /******************************************************************* 06690000
*  /*                                                                 * 06700000
*  /*                     PRINT MESSAGE IFD139D                       * 06710000
*  /* TAPE: REPLY B TO BYPASS,R TO RETRY,P TO PROCEED(MAY DESTROY DATA* 06720000
*  /*     UNIT RECORD:   REPLY B TO BYPASS, R TO RETRY,P TO PROCEED   * 06730000
*  /******************************************************************* 06740000
*  DPTAPE05:                                                            06750000
*  IF CLASS = '08'X THEN                 /* IF DEV IS UR,       Y01906* 06760000
DPTAPE05 CLI   38(@7),X'08'                                       0196  06770000
         BC    07,@9E8                                            0196  06780000
*    R1 = MSGB;                          /* PRINT SHORT FORM    Y01906* 06790000
         L     @1,40(0,@4)                                        0197  06800000
         BC    15,@9E7                                            0198  06810000
*    ELSE R1 = MSG6;                     /* PRT MAY DESTROY DATAX02906* 06820000
@9E8     L     @1,20(0,@4)                                        0198  06830000
*  BUFAD=ADDR(BUFFER);              /* SET UP BUFFER ADDRESS          * 06840000
@9E7     LA    @F,BUFFER                                          0199  06850000
         ST    @F,@TEMP4                                          0199  06860000
         MVC   1(3,@1),@TEMP4+1                                   0199  06870000
*  MSGECBAD=ADDR(DECB);             /* POINTER TO PWTO ECB            * 06880000
         LA    @F,DECB                                            0200  06890000
         ST    @F,4(0,@1)                                         0200  06900000
*     DECB=0;                       /* ZERO DECB                      * 06910000
         SR    @F,@F                                              0201  06920000
         ST    @F,DECB                                            0201  06930000
*  LENGTH='01'X;                    /* LENGTH OF RESPONSE             * 06940000
         MVI   0(@1),X'01'                                        0202  06950000
*  GEN(BAL   R5,DPTAPE14);               /* PRINT AND REPLY      M4506* 06960000
         BAL   R5,DPTAPE14                                              06970000
         DS    0H                                                       06980000
*  IF BUFFER='P' THEN DO;           /* IF REPLY IS PROCEED            * 06990000
         CLI   BUFFER,C'P'                                        0204  07000000
         BC    07,@9E6                                            0204  07010000
*         DPDONE='1'B;                                                  07020000
         OI    12(@7),B'00100000'                                 0206  07030000
*     GOTO DPTAPE10;                /* RETURN                         * 07040000
         BC    15,DPTAPE10                                        0207  07050000
*                    END;                                               07060000
*  IF BUFFER='B' THEN DO;           /* IF REPLY IS BYPASS             * 07070000
@9E6     CLI   BUFFER,C'B'                                        0209  07080000
         BC    07,@9E5                                            0209  07090000
*         IF PRIMARY ='1'B THEN                                         07100000
         TM    12(@7),B'01000000'                                 0211  07110000
         BC    12,@9E4                                            0211  07120000
*     BYPDEV='1'B;                  /* TURN ON BYPASS BIT             * 07130000
         OI    A00007+3,B'00100000'                               0212  07140000
*     GOTO DPTAPE10;                /* RETURN                         * 07150000
         BC    15,DPTAPE10                                        0213  07160000
*                    END;                                               07170000
*  IF BUFFER='R' THEN               /* IF REPLY IS RETRY              * 07180000
@9E5     CLI   BUFFER,C'R'                                        0215  07190000
*     GOTO DPTAPE00;                /* GOTO TO BEGINNING OF MODULE    * 07200000
         BC    08,DPTAPE00                                        0216  07210000
*  ELSE GOTO DPTAPE05;              /* TRY AGAIN REPLY NOT RECOGNIZED * 07220000
         BC    15,DPTAPE05                                        0217  07230000
*  /******************************************************************* 07240000
*  /*                                                                 * 07250000
*  /*        SET UP FOR SENSE FOR UNIT RECORD DEVICES                 * 07260000
*  /*                                                                 * 07270000
*  /******************************************************************* 07280000
*                                                                       07290000
* URXIO:                                                                07300000
*  IF TYPE='42'X THEN                   /* IF THE DEVICE IS   @ZA15468* 07310000
URXIO    CLI   39(@7),X'42'                                       0218  07320000
         BC    07,@9E3                                            0218  07330000
*    DO;                                /* AN MSS, CHECK TO   @ZA15468* 07340000
*      IF INITSW='1'B THEN              /* SEE IF IT IS       @ZA15468* 07350000
         TM    A00005,B'00100000'                                 0220  07360000
         BC    12,@9E2                                            0220  07370000
*        DO;                            /* INITIALIZED AND IF @ZA15468* 07380000
*          R1=MSGG;                     /* IT IS, TELL HOW    @ZA15468* 07390000
         L     @1,60(0,@4)                                        0222  07400000
*          MSGDVADG=DEVADEB;            /* EITHER FUNCTIONALLY@ZA15468* 07410000
         MVC   22(8,@1),0(@7)                                     0223  07420000
*          IF FINITSW='1'B THEN         /* OR DIAGNOSTICALLY  @ZA15468* 07430000
         TM    A00005,B'10000000'                                 0224  07440000
         BC    12,@9E1                                            0224  07450000
*            MSGINIT='FUNCTIONALLY  ';  /* WRITE THE MESSAGE  @ZA15468* 07460000
         MVC   43(14,@1),@C29                                     0225  07470000
         BC    15,@9E0                                            0226  07480000
*          ELSE                         /* TO THE USER.       @ZA15468* 07490000
*            MSGINIT='DIAGNOSTICALLY';  /*                    @ZA15468* 07500000
@9E1     MVC   43(14,@1),@C30                                     0226  07510000
*          GEN(BAL R5,DPTAPE13);        /*                    @ZA15468* 07520000
@9E0     EQU   *                                                  0227  07530000
         BAL R5,DPTAPE13                                                07540000
         DS    0H                                                       07550000
*          GO TO DPURMSC;               /* THEN CONTINUE WITH @ZA15468* 07560000
         BC    15,DPURMSC                                         0228  07570000
*        END;                           /* DATA PROTECTION.   @ZA15468* 07580000
*      R1=MSGD;                         /* IF THE INTERFACE   @ZA15468* 07590000
@9E2     L     @1,48(0,@4)                                        0230  07600000
*      MSGDVADD=DEVADEB;                /* IS NOT INITIALIZED @ZA15468* 07610000
         MVC   38(8,@1),0(@7)                                     0231  07620000
*      GEN(BAL R5,DPTAPE13);            /* TELL THE USER AND  @ZA15468* 07630000
         BAL R5,DPTAPE13                                                07640000
         DS    0H                                                       07650000
*      R1=MSGE;                         /* AND GIVE THE OPTION@ZA15468* 07660000
         L     @1,52(0,@4)                                        0233  07670000
*      GEN(BAL R5,DPTAPE13);            /* OF BYPASSING THE   @ZA15468* 07680000
         BAL R5,DPTAPE13                                                07690000
         DS    0H                                                       07700000
* DPMSGF:                               /* TEST OR TAKING A   @ZA15468* 07710000
*      R1=MSGF;                         /* CHANCE AND WIPING  @ZA15468* 07720000
DPMSGF   L     @1,56(0,@4)                                        0235  07730000
*      BUFAD=ADDR(BUFFER);              /* OUT A PACK.        @ZA15468* 07740000
         LA    @F,BUFFER                                          0236  07750000
         ST    @F,@TEMP4                                          0236  07760000
         MVC   1(3,@1),@TEMP4+1                                   0236  07770000
*      MSGECBAD=ADDR(DECB);             /* SET UP FOR A REPLY @ZA15468* 07780000
         LA    @F,DECB                                            0237  07790000
         ST    @F,4(0,@1)                                         0237  07800000
*      DECB=0;                          /* ZERO THE ECB       @ZA15468* 07810000
         SR    @F,@F                                              0238  07820000
         ST    @F,DECB                                            0238  07830000
*      LENGTH='01'X;                    /* SET MESSAGE LENGTH @ZA15468* 07840000
         MVI   0(@1),X'01'                                        0239  07850000
*      GEN(BAL R5,DPTAPE14);            /* GO WRITE MESSAGE   @ZA15468* 07860000
         BAL R5,DPTAPE14                                                07870000
         DS    0H                                                       07880000
*      IF BUFFER='P' THEN               /* IF USER REPLIED P  @ZA15468* 07890000
         CLI   BUFFER,C'P'                                        0241  07900000
*        GO TO DPURMSC;                 /* CONTINUE           @ZA15468* 07910000
         BC    08,DPURMSC                                         0242  07920000
*      IF BUFFER='B' THEN               /* IF USER REPLIED B  @ZA15468* 07930000
         CLI   BUFFER,C'B'                                        0243  07940000
         BC    07,@9DF                                            0243  07950000
*        DO;                            /* SET SWITCHES TO    @ZA15468* 07960000
*          IF PRIMARY='1'B THEN         /* BYPASS THE TEST    @ZA15468* 07970000
         TM    12(@7),B'01000000'                                 0245  07980000
         BC    12,@9DE                                            0245  07990000
*            BYPDEV='1'B;               /*                    @ZA15468* 08000000
         OI    A00007+3,B'00100000'                               0246  08010000
*          GO TO DPTAPE10;              /* RETURN TO IFDOLT52 @ZA15468* 08020000
         BC    15,DPTAPE10                                        0247  08030000
*        END;                           /*                    @ZA15468* 08040000
*      GO TO DPMSGF;                    /* REWRITE THE MESSAGE        * 08050000
*    END;                               /*                    @ZA15468* 08060000
* DPURMSC:                              /*                    @ZA15468* 08070000
*   MODEREQ = '0'B;                      /* NO MODE SET NEEDED  Y01906* 08080000
@9E3     EQU   *                                                  0251  08090000
DPURMSC  NI    FLG2,B'10111111'                                   0251  08100000
*         CCWPTR = ADDR(URSNS);         /* SET CCW PTR          Y02906* 08110000
         LA    @F,URSNS                                           0252  08120000
         ST    @F,CCWPTR                                          0252  08130000
*  IF TYPE='4C'X THEN                   /* IF DEVICE IS 3838  @G29AFAA* 08140000
         CLI   39(@7),X'4C'                                       0253  08150000
         BC    07,@9DD                                            0253  08160000
*    DO;                                /* ARRAY PROCESSOR    @G29AFAA* 08170000
*      DPDONE='1'B;                     /* SET DPDONE FLAG ON @G29AFAA* 08180000
         OI    12(@7),B'00100000'                                 0255  08190000
*      GO TO DPTAPE10;                  /* EXIT MODULE        @G29AFAA* 08200000
         BC    15,DPTAPE10                                        0256  08210000
*    END;                                                   /*@G29AFAA* 08220000
*  GEN(BAL   R5,IORTN);                  /* GO DO IO OP         Y01906* 08230000
@9DD     EQU   *                                                  0258  08240000
         BAL   R5,IORTN                                                 08250000
         DS    0H                                                       08260000
*  IF EXIOK='0C' THEN                    /* IS IO OP SUCCESSFUL Y01906* 08270000
         CLC   TECB+16(1),@C32                                    0259  08280000
         BC    07,@9DC                                            0259  08290000
*         DO;                           /*                      YM3384* 08300000
*         DPDONE='1'B;                  /* SET DPDONE FLG ON    YM3384* 08310000
         OI    12(@7),B'00100000'                                 0261  08320000
*          GO TO DPTAPE10;         /* EXIT MODULE               YM2271* 08330000
         BC    15,DPTAPE10                                        0262  08340000
*         END;                          /*                      YM3384* 08350000
*  IF SNS2='1'B THEN                     /* NO,IS INT, REQUIRED Y01906* 08360000
@9DC     TM    TECB+23,B'01000000'                                0264  08370000
*    GOTO DPTAPE11;                      /* YES,GO PUT OUT MSG. Y01906* 08380000
         BC    01,DPTAPE11                                        0265  08390000
*         DPDONE='1'B;                  /* SET DPDONE FLG ON    YM3384* 08400000
         OI    12(@7),B'00100000'                                 0266  08410000
*          GO TO DPTAPE10;         /* EXIT MODULE               YM2271* 08420000
         BC    15,DPTAPE10                                        0267  08430000
*  /******************************************************************* 08440000
*  /*                                                                 * 08450000
*  /*                          PRINT MESSAGE IFD122I                  * 08460000
*  /*     VOL ON XXXXXXXX SECURITY PROTECTED                          * 08470000
*  /******************************************************************* 08480000
*  DPTAPE06:                                                            08490000
*  R1=MSG5;                         /* POINTER TO MESSAGE             * 08500000
DPTAPE06 L     @1,16(0,@4)                                        0268  08510000
*  MSGDVAD3=DEVADEB;                /* PUT DEVICE ADDRESS IN MSG5     * 08520000
         MVC   19(8,@1),0(@7)                                     0269  08530000
*  GEN(BAL   R5,DPTAPE13);               /* PRINT MESSAGE        M4506* 08540000
         BAL   R5,DPTAPE13                                              08550000
         DS    0H                                                       08560000
*  /******************************************************************* 08570000
*  /*                                                                 * 08580000
*  /*                          PRINT MESSAGE IFD139D                  * 08590000
*  /*     REPLY B TO BYPASS, R TO RETRY                               * 08600000
*  /******************************************************************* 08610000
*  DPTAPE07:                                                            08620000
*  R1=MSG8;                         /* POINTER TO MESSAGE             * 08630000
DPTAPE07 L     @1,28(0,@4)                                        0271  08640000
*  BUFAD=ADDR(BUFFER);              /* SET UP BUFFER ADDRESS          * 08650000
         LA    @F,BUFFER                                          0272  08660000
         ST    @F,@TEMP4                                          0272  08670000
         MVC   1(3,@1),@TEMP4+1                                   0272  08680000
*  MSGECBAD=ADDR(DECB);             /* POINTER TO PWTOR ECB           * 08690000
         LA    @F,DECB                                            0273  08700000
         ST    @F,4(0,@1)                                         0273  08710000
*  LENGTH='01'X;                    /* LENGTH OF RESPONSE             * 08720000
         MVI   0(@1),X'01'                                        0274  08730000
*     DECB=0;                       /* ZERO DECB                      * 08740000
         SR    @F,@F                                              0275  08750000
         ST    @F,DECB                                            0275  08760000
*  GEN(BAL   R5,DPTAPE14);               /* PRINT AND REPLY      M4506* 08770000
         BAL   R5,DPTAPE14                                              08780000
         DS    0H                                                       08790000
*  IF BUFFER= 'B' THEN DO;          /* IF REPLY IS BYPASS             * 08800000
         CLI   BUFFER,C'B'                                        0277  08810000
         BC    07,@9DB                                            0277  08820000
*         IF PRIMARY ='1'B THEN                                         08830000
         TM    12(@7),B'01000000'                                 0279  08840000
         BC    12,@9DA                                            0279  08850000
*     BYPDEV='1'B;                  /* SET BYPASS BIT                 * 08860000
         OI    A00007+3,B'00100000'                               0280  08870000
*     GOTO DPTAPE10;                /* RETURN                         * 08880000
         BC    15,DPTAPE10                                        0281  08890000
*                     END;                                              08900000
*  IF BUFFER= 'R' THEN              /* IF REPLY IS RETRY              * 08910000
@9DB     CLI   BUFFER,C'R'                                        0283  08920000
*     GOTO DPTAPE00;                /* GOTO BEGINNING OF MODULE       * 08930000
         BC    08,DPTAPE00                                        0284  08940000
*  ELSE GOTO DPTAPE07;              /* TRY AGAIN REPY NOT RECOGNIZED  * 08950000
         BC    15,DPTAPE07                                        0285  08960000
*  /******************************************************************* 08970000
*  /*                                                                 * 08980000
*  /*     PRINT IFD122I VOL ON XXXXXXXX UNEXPIRED DATE                * 08990000
*  /*                                                                 * 09000000
*  /******************************************************************* 09010000
*  DPTAPE08:                                                            09020000
*  R1=MSG7;                         /* POINTER TO MESSAGE             * 09030000
DPTAPE08 L     @1,24(0,@4)                                        0286  09040000
*  MSGDVAD4=DEVADEB;                /* PUT DEVICE ADDRESS IN MSG7     * 09050000
         MVC   19(8,@1),0(@7)                                     0287  09060000
*  GEN(BAL   R5,DPTAPE13);               /* PRINT MESSAGE        M4506* 09070000
         BAL   R5,DPTAPE13                                              09080000
         DS    0H                                                       09090000
*  GOTO DPTAPE05;                   /* GO PRINT OPTION MESSAGE        * 09100000
         BC    15,DPTAPE05                                        0289  09110000
*                                                                       09120000
*  /******************************************************************* 09130000
*  /*                                                                 * 09140000
*  /*           PRINT IFD130I MESSAGE                                 * 09150000
*  /*     INTERVENTION REQ XXXXXXXX                                   * 09160000
*  /******************************************************************* 09170000
*  DPTAPE11:                                                            09180000
*         R1=MSG9;                       /* PUT PTR TO MSG IN R1      * 09190000
DPTAPE11 L     @1,32(0,@4)                                        0290  09200000
*         MSGDVAD9=DEVADEB;              /*PUT DEV ADDR IN MSG        * 09210000
         MVC   29(8,@1),0(@7)                                     0291  09220000
*  GEN(BAL   R5,DPTAPE13);               /* PRINT MESSAGE        M4506* 09230000
         BAL   R5,DPTAPE13                                              09240000
         DS    0H                                                       09250000
*     GO TO DPTAPE05;               /* GO GIVE OPTIONS B, R, P  Y01906* 09260000
         BC    15,DPTAPE05                                        0293  09270000
*  /******************************************************************* 09280000
*  /*                                                                 * 09290000
*  /*                          PRINT MESSAGE IFD138I                  * 09300000
*  /*     DEV XXXXXXXX NOT OPERATIONAL,CC=3                           * 09310000
*  /******************************************************************* 09320000
*  DPTAPE12:                                                            09330000
*         R1=MSGA;                       /* POINTER TO MESSAGE        * 09340000
DPTAPE12 L     @1,36(0,@4)                                        0294  09350000
*         MSGDVADA=DEVADEB;              /*PUT DEV ADDR IN MSG        * 09360000
         MVC   16(8,@1),0(@7)                                     0295  09370000
*  GEN(BAL   R5,DPTAPE13);               /* PRINT MESSAGE        M4506* 09380000
         BAL   R5,DPTAPE13                                              09390000
         DS    0H                                                       09400000
*         GOTO DPTAPE05;                 /*GO PRINT MSG IFD139D       * 09410000
         BC    15,DPTAPE05                                        0297  09420000
* DPTAPE13:                              /*                      M4506* 09430000
*  GEN(PWTO  REG=(1));                   /* PRINT MESSAGE        M4506* 09440000
DPTAPE13 PWTO  REG=(1)                                                  09450000
         DS    0H                                                       09460000
*  GOTO R5;                              /* RESUME PROGRAM       M4506* 09470000
         BCR   15,@5                                              0299  09480000
* DPTAPE14:                              /*                      M4506* 09490000
*  GEN(PWTOR REG=(1));                   /* PRINT AND REPLY      M4506* 09500000
DPTAPE14 PWTOR REG=(1)                                                  09510000
         DS    0H                                                       09520000
*  GOTO R5;                              /* RESUME PROGRAM       M4506* 09530000
         BCR   15,@5                                              0301  09540000
*  DPTAPE10:                                                            09550000
*         MODESV=FILEMSK;                                     /*Y02906* 09560000
DPTAPE10 MVC   30(1,@7),FILEMSK                                   0302  09570000
*         PROTECT='0'B;                                                 09580000
         NI    A00007,B'10111111'                                 0303  09590000
*  RETURN;                          /* RETURN TO CALLING MODULE       * 09600000
         BC    15,@EL01                                           0304  09610000
* IORTN:                                                                09620000
*         FLGB   = '00'X;               /* ZIP FLAGS            Y02906* 09630000
IORTN    MVI   FLGB,X'00'                                         0305  09640000
*         CLRTECB = CLRTECB && CLRTECB; /* CLEAR TECB           Y02906* 09650000
         XC    TECB+6(39),TECB+6                                  0306  09660000
*         DVTPTR = R7;                  /* SET DEVTAB ENTRY PTR Y02906* 09670000
         ST    @7,DVTPTR                                          0307  09680000
*         FLGA   = '00'X;               /* ZIP FLAGS            Y02906* 09690000
         MVI   FLGA,X'00'                                         0308  09700000
*         INTCALL = '1'B;               /* SET INTERNAL CALL SW Y02906* 09710000
         OI    FLG2,B'10000000'                                   0309  09720000
*         BYPASS = '1'B;                 /* SET BYPASS PREFIX SWY02906* 09730000
         OI    FLG1A,B'10000000'                                  0310  09740000
*         SNSCNT = '18'X;                /* SET SENSE COUNT     Y02906* 09750000
         MVI   SNSCNT,X'18'                                       0311  09760000
*         TECBPTRX = ADDR(TECB);         /* SET ADDR TECB       Y02906* 09770000
         LA    @F,TECB                                            0312  09780000
         ST    @F,TECBPTRX                                        0312  09790000
*         CDSPTR = ADDR(ADRHEX);        /* SET ADDR OF CDS DEV  Y02906* 09800000
         LA    @F,32(0,@7)                                        0313  09810000
         ST    @F,WAITLST+8                                       0313  09820000
*         R15  = IORTNADR;              /* GET EFFECTOR PTR     Y02906* 09830000
         L     @F,IORTNADR                                        0314  09840000
*         GEN(BALR R14,R15);            /* GO SIO               Y02906* 09850000
         BALR R14,R15                                                   09860000
         DS    0H                                                       09870000
*         R1 = ADDR(WAITLST);           /* GET POINTER FOR WAIT Y02906* 09880000
         LA    @1,WAITLST                                         0316  09890000
*         R15 = TAB28;                   /* GET TRANS MGR ENTRY Y02906* 09900000
         L     @F,TAB28                                           0317  09910000
*         GEN(BALR  14,15);             /* GO TO WAIT MODULE    Y02008* 09920000
         BALR  14,15                                                    09930000
         DS    0H                                                       09940000
*         GO TO R5;                     /* RETURN TO CALLER     Y02008* 09950000
         BCR   15,@5                                              0319  09960000
* NEWCONV:                                                              09970000
*  R1=ADDR(CNVRT);                       /* CONVERT PARAMETER    M4506* 09980000
NEWCONV  LA    @1,CNVRT                                           0320  09990000
*  R15=TAB28;                            /* TRANSIENT MANAGER    M4506* 10000000
         L     @F,TAB28                                           0321  10010000
*  GOTO R15;                             /* CALL CONVERT         M4506* 10020000
         BCR   15,@F                                              0322  10030000
*         END;                                                          10040000
@EL01    L     @D,4(0,@D)                                         0323  10050000
         LM    @E,@C,12(@D)                                       0323  10060000
         BCR   15,@E                                              0323  10070000
@DATA1   EQU   *                                                        10080000
@0       EQU   00                  EQUATES FOR REGISTERS 0-15           10090000
@1       EQU   01                                                       10100000
@2       EQU   02                                                       10110000
@3       EQU   03                                                       10120000
@4       EQU   04                                                       10130000
@5       EQU   05                                                       10140000
@6       EQU   06                                                       10150000
@7       EQU   07                                                       10160000
@8       EQU   08                                                       10170000
@9       EQU   09                                                       10180000
@A       EQU   10                                                       10190000
@B       EQU   11                                                       10200000
@C       EQU   12                                                       10210000
@D       EQU   13                                                       10220000
@E       EQU   14                                                       10230000
@F       EQU   15                                                       10240000
         DS    0F                                                       10250000
@C11     DC    C'VOL1'                                                  10260000
@C20     DC    C'HDR1'                                                  10270000
@C21     DC    C'ONLINE ,'                                              10280000
@C29     DC    C'FUNCTIONALLY  '                                        10290000
@C30     DC    C'DIAGNOSTICALLY'                                        10300000
@C32     DC    C'0C'                                                    10310000
@C22     DC    C'ALLOCATED  '                                           10320000
@C23     DC    C'UNALLOCATED'                                           10330000
         DS    0D                                                       10340000
@DATA    EQU   *                                                        10350000
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD                   10360000
X        EQU   00000000            FULLWORD INTEGER                     10370000
R0       EQU   00000000            FULLWORD POINTER REGISTER            10380000
R1       EQU   00000001            FULLWORD POINTER REGISTER            10390000
R2       EQU   00000002            FULLWORD POINTER REGISTER            10400000
R3       EQU   00000003            FULLWORD POINTER REGISTER            10410000
R4       EQU   00000004            FULLWORD POINTER REGISTER            10420000
R5       EQU   00000005            FULLWORD POINTER REGISTER            10430000
R6       EQU   00000006            FULLWORD POINTER REGISTER            10440000
R7       EQU   00000007            FULLWORD POINTER REGISTER            10450000
R8       EQU   00000008            FULLWORD POINTER REGISTER            10460000
R9       EQU   00000009            FULLWORD POINTER REGISTER            10470000
I        EQU   00000008            FULLWORD INTEGER REGISTER            10480000
R10      EQU   00000010            FULLWORD POINTER REGISTER            10490000
R11      EQU   00000011            FULLWORD POINTER REGISTER            10500000
R12      EQU   00000012            FULLWORD POINTER REGISTER            10510000
R13      EQU   00000013            FULLWORD POINTER REGISTER            10520000
R14      EQU   00000014            FULLWORD POINTER REGISTER            10530000
R15      EQU   00000015            FULLWORD POINTER REGISTER            10540000
WAITLST  EQU   @DATA+00000072      16 BYTE(S) ON WORD                   10550000
         ORG   WAITLST+00000000                                         10560000
XMGR     EQU   *                   1 BYTE(S)                            10570000
         DC    X'00'                                                    10580000
LVL      EQU   *                   1 BYTE(S)                            10590000
         DC    X'02'                                                    10600000
MODID    EQU   *                   2 BYTE(S)                            10610000
         DC    C'36'                                                    10620000
TECBPTR  EQU   *                   FULLWORD POINTER                     10630000
         DC    AL4(TECB)                                                10640000
CDSPTR   EQU   *                   FULLWORD POINTER                     10650000
         DC    AL4(0)                                                   10660000
FLG      EQU   *                   8 BIT(S) ON BYTE                     10670000
         DC    X'80'                                                    10680000
WAITYES  EQU   WAITLST+00000012    1 BIT(S)                             10690000
TIME     EQU   *                   2 BYTE(S)                            10700000
         DC    X'001E'                                                  10710000
A00026   EQU   00000000            52 BYTE(S) ON WORD                   10720000
DEVADEB  EQU   A00026+00000000     8 BYTE(S)                            10730000
UCBAD    EQU   A00026+00000008     FULLWORD POINTER                     10740000
DEVFLG1  EQU   A00026+00000012     1 BYTE(S)                            10750000
STATUS   EQU   A00026+00000012     1 BIT(S)                             10760000
PRIMARY  EQU   A00026+00000012     1 BIT(S)                             10770000
DPDONE   EQU   A00026+00000012     1 BIT(S)                             10780000
A00027   EQU   A00026+00000012     3 BIT(S)                             10790000
FILEPROT EQU   A00026+00000012     1 BIT(S)                             10800000
A00028   EQU   A00026+00000012     1 BIT(S)                             10810000
DEVFLG2  EQU   A00026+00000013     1 BYTE(S)                            10820000
A00029   EQU   A00026+00000013     2 BIT(S)                             10830000
CEVOL    EQU   A00026+00000013     1 BIT(S)                             10840000
STDLABL  EQU   A00026+00000013     1 BIT(S)                             10850000
A00030   EQU   A00026+00000013     4 BIT(S)                             10860000
DEVFLG3  EQU   A00026+00000014     1 BYTE(S)                            10870000
A00031   EQU   A00026+00000014     3 BIT(S)                             10880000
TAPEBIT  EQU   A00026+00000014     1 BIT(S)                             10890000
A00032   EQU   A00026+00000014     1 BIT(S)                             10900000
SYSALLOC EQU   A00026+00000014     1 BIT(S)                             10910000
A00033   EQU   A00026+00000014     2 BIT(S)                             10920000
DEVFLG4  EQU   A00026+00000015     1 BYTE(S)                            10930000
TAPELABL EQU   A00026+00000016     16 BYTE(S)                           10940000
VOL      EQU   A00026+00000016     10 BYTE(S)                           10950000
HDR      EQU   A00026+00000026     4 BYTE(S)                            10960000
MODESV   EQU   A00026+00000030     1 BYTE(S)                            10970000
A00034   EQU   A00026+00000031     1 BYTE(S)                            10980000
ADRHEX   EQU   A00026+00000032     4 BYTE(S)                            10990000
A00035   EQU   A00026+00000032     2 BYTE(S)                            11000000
HEXAD    EQU   A00026+00000034     2 BYTE(S)                            11010000
CDSINFOR EQU   A00026+00000036     16 BYTE(S)                           11020000
MODEL    EQU   A00026+00000036     1 BYTE(S)                            11030000
FEATURES EQU   A00026+00000037     1 BYTE(S)                            11040000
STRACK   EQU   A00026+00000037     1 BIT(S)                             11050000
A00036   EQU   A00026+00000037     7 BIT(S)                             11060000
CLASS    EQU   A00026+00000038     1 BYTE(S)                            11070000
TYPE     EQU   A00026+00000039     1 BYTE(S)                            11080000
A00037   EQU   A00026+00000040     12 BYTE(S)                           11090000
TECB     EQU   @DATA+00000088      45 BYTE(S) ON WORD                   11100000
         ORG   TECB+00000000                                            11110000
FLDCNT   EQU   *                   1 BYTE(S)                            11120000
         DC    X'01'                                                    11130000
FLDSIZE  EQU   *                   1 BYTE(S)                            11140000
         DC    X'0C'                                                    11150000
SOMETNG  EQU   *                   1 BYTE(S)                            11160000
         DC    X'00'                                                    11170000
SNSSIZE  EQU   *                   1 BYTE(S)                            11180000
         DC    X'18'                                                    11190000
FLG1     EQU   *                   1 BYTE(S)                            11200000
         DC    X'00'                                                    11210000
SNSCNTTB EQU   *                   1 BYTE(S)                            11220000
         DC    X'01'                                                    11230000
CLRTECB  EQU   TECB+00000006       39 BYTE(S)                           11240000
CNTSNS   EQU   *                   1 BYTE(S)                            11250000
         DC    X'00'                                                    11260000
CNTINT   EQU   *                   1 BYTE(S)                            11270000
         DC    X'00'                                                    11280000
CCP      EQU   TECB+00000008       1 BYTE(S)                            11290000
A00038   EQU   TECB+00000009       3 BYTE(S)                            11300000
CSW1     EQU   TECB+00000012       8 BYTE(S)                            11310000
A00039   EQU   TECB+00000012       4 BYTE(S)                            11320000
STATUSX  EQU   TECB+00000016       2 BYTE(S)                            11330000
EXIOK    EQU   TECB+00000016       1 BYTE(S)                            11340000
A00040   EQU   TECB+00000016       6 BIT(S)                             11350000
UNITCK   EQU   TECB+00000016       1 BIT(S)                             11360000
UNITEXCP EQU   TECB+00000016       1 BIT(S)                             11370000
BYTE2    EQU   TECB+00000017       1 BYTE(S)                            11380000
A00041   EQU   TECB+00000017       1 BIT(S)                             11390000
INLENGTH EQU   TECB+00000017       1 BIT(S)                             11400000
A00042   EQU   TECB+00000017       6 BIT(S)                             11410000
A00043   EQU   TECB+00000018       2 BYTE(S)                            11420000
SENSE    EQU   TECB+00000020       24 BYTE(S)                           11430000
A00044   EQU   TECB+00000020       3 BYTE(S)                            11440000
SNS1     EQU   TECB+00000023       7 BYTE(S)                            11450000
SNSFLD   EQU   TECB+00000023       8 BIT(S)                             11460000
A00045   EQU   TECB+00000023       1 BIT(S)                             11470000
SNS2     EQU   TECB+00000023       1 BIT(S)                             11480000
A00046   EQU   TECB+00000024       2 BYTE(S)                            11490000
A00047   EQU   TECB+00000026       8 BIT(S)                             11500000
A00048   EQU   TECB+00000026       5 BIT(S)                             11510000
PEIND    EQU   TECB+00000026       1 BIT(S)                             11520000
A00049   EQU   TECB+00000027       2 BYTE(S)                            11530000
A00050   EQU   TECB+00000029       1 BYTE(S)                            11540000
A00051   EQU   TECB+00000029       4 BIT(S)                             11550000
BIT4     EQU   TECB+00000029       1 BIT(S)                             11560000
LABEL1   EQU   @DATA+00000133      80 BYTE(S)                           11570000
TAPEVOL  EQU   LABEL1+00000000     10 BYTE(S)                           11580000
VOLAB    EQU   LABEL1+00000000     4 BYTE(S)                            11590000
VOLSERNO EQU   LABEL1+00000004     6 BYTE(S)                            11600000
SECURE   EQU   LABEL1+00000010     1 BYTE(S)                            11610000
A00052   EQU   LABEL1+00000011     69 BYTE(S)                           11620000
LABEL2   EQU   @DATA+00000133      80 BYTE(S)                           11630000
HDRLAB   EQU   LABEL2+00000000     4 BYTE(S)                            11640000
A00053   EQU   LABEL2+00000004     43 BYTE(S)                           11650000
A00054   EQU   LABEL2+00000047     7 BYTE(S)                            11660000
A00055   EQU   LABEL2+00000047     1 BYTE(S)                            11670000
DATE1    EQU   LABEL2+00000048     5 BYTE(S)                            11680000
A00056   EQU   LABEL2+00000053     1 BYTE(S)                            11690000
A00057   EQU   LABEL2+00000054     26 BYTE(S)                           11700000
         ORG   @DATA+00000216                                           11710000
MSGPTR   EQU   *                   FULLWORD POINTER                     11720000
         DC    VL4(IFDMSG03)                                            11730000
A00058   EQU   00000000            64 BYTE(S) ON WORD                   11740000
MSG1     EQU   A00058+00000000     FULLWORD POINTER                     11750000
MSG2     EQU   A00058+00000004     FULLWORD POINTER                     11760000
MSG3     EQU   A00058+00000008     FULLWORD POINTER                     11770000
MSG4     EQU   A00058+00000012     FULLWORD POINTER                     11780000
MSG5     EQU   A00058+00000016     FULLWORD POINTER                     11790000
MSG6     EQU   A00058+00000020     FULLWORD POINTER                     11800000
MSG7     EQU   A00058+00000024     FULLWORD POINTER                     11810000
MSG8     EQU   A00058+00000028     FULLWORD POINTER                     11820000
MSG9     EQU   A00058+00000032     FULLWORD POINTER                     11830000
MSGA     EQU   A00058+00000036     FULLWORD POINTER                     11840000
MSGB     EQU   A00058+00000040     FULLWORD POINTER                     11850000
MSGC     EQU   A00058+00000044     FULLWORD POINTER                     11860000
MSGD     EQU   A00058+00000048     FULLWORD POINTER                     11870000
MSGE     EQU   A00058+00000052     FULLWORD POINTER                     11880000
MSGF     EQU   A00058+00000056     FULLWORD POINTER                     11890000
MSGG     EQU   A00058+00000060     FULLWORD POINTER                     11900000
MSG109   EQU   00000000            40 BYTE(S) ON WORD                   11910000
A00059   EQU   MSG109+00000000     12 BYTE(S)                           11920000
MSGDVAD  EQU   MSG109+00000012     8 BYTE(S)                            11930000
A00060   EQU   MSG109+00000020     1 BYTE(S)                            11940000
ONOROFF  EQU   MSG109+00000021     8 BYTE(S)                            11950000
ALORNOT  EQU   MSG109+00000029     11 BYTE(S)                           11960000
MSGDVAD1 EQU   00000034            8 BYTE(S)                            11970000
MSGDVAD2 EQU   00000036            8 BYTE(S)                            11980000
MSGDVAD3 EQU   00000019            8 BYTE(S)                            11990000
MSGDVAD4 EQU   00000019            8 BYTE(S)                            12000000
MSGDVAD9 EQU   00000029            8 BYTE(S)                            12010000
MSGDVADA EQU   00000016            8 BYTE(S)                            12020000
MSGDVA39 EQU   00000039            8 BYTE(S)                            12030000
MSGSNS   EQU   00000037            12 BYTE(S)                           12040000
MSGCSW   EQU   00000018            14 BYTE(S)                           12050000
MSGDVADD EQU   00000038            8 BYTE(S)                            12060000
MSGDVADG EQU   00000022            8 BYTE(S)                            12070000
MSGINIT  EQU   00000043            14 BYTE(S)                           12080000
MSGPARM  EQU   00000000            8 BYTE(S) ON WORD                    12090000
LENGTH   EQU   MSGPARM+00000000    1 BYTE(S)                            12100000
BUFAD    EQU   MSGPARM+00000001    3  BYTE  POINTER ON WORD+1           12110000
MSGECBAD EQU   MSGPARM+00000004    FULLWORD INTEGER                     12120000
DECB     EQU   *                   FULLWORD INTEGER                     12130000
         DC    FL4'0'                                                   12140000
INBUF    EQU   @DATA+00000224      62 BYTE(S)                           12150000
CSWIN    EQU   INBUF+00000000      14 BYTE(S)                           12160000
A00061   EQU   INBUF+00000014      6 BYTE(S)                            12170000
SNSIN    EQU   INBUF+00000020      48 BYTE(S)                           12180000
         ORG   @DATA+00000292                                           12190000
AREA     EQU   *                   FULLWORD INTEGER                     12200000
         DC    FL4'0'                                                   12210000
AREA1    EQU   *                   6 BYTE(S)                            12220000
         DC    X'000000000000'                                          12230000
XAREA    EQU   @DATA+00000297      5 BYTE(S)                            12240000
         ORG   @DATA                                                    12250000
         DS    00000302C                                                12260000
@TEMPS   DS    0F                                                       12270000
@TEMP4   DC    F'0'                                                     12280000
RDLAB    CCW   7,*,X'60',1       REWIND                                 12290000
         CCW   4,SNS1,X'60',24          SENSE                    X02906 12300000
         CCW   2,LABEL1,X'40',80    READ VOL1 RECORD                    12310000
         CCW   04,*,X'30',1       FORCE CHAN END DEV END, NO DATA TRANS 12320000
URSNS    CCW   3,*,X'60',1              NO-OP FOR UR RDY CHK   Y01906   12330000
         CCW   04,*,X'30',1       FORCE CHAN END DEV END, NO DATA TRANS 12340000
RDLAB1   CCW   2,LABEL1,X'40',80      READ HDR1 RECORD                  12350000
         CCW   04,*,X'30',1       FORCE CHAN END DEV END, NO DATA TRANS 12360000
CNVRT    DC    B'00000000'         CONTROL PROGRAM FLAGS                12370000
         DC    AL1(2)              MACRO LEVEL                          12380000
         DC    CL2'41'             MACRO ID                             12390000
        DC    A(CSW1+1)                                                 12400000
         DC    A(INBUF)                                                 12410000
         DC    AL2(31+32768)            COUNT AND TYPE           S21052 12420000
DSECTAA  IFDCOM                                                         12430000
A00000   EQU   CESWT3+00000000     1 BYTE(S)                            12440000
A00001   EQU   A00000+00000000     3 BIT(S)                             12450000
GRBCTL   EQU   A00000+00000000     1 BIT(S)                             12460000
SUSDEL   EQU   A00000+00000000     1 BIT(S)                             12470000
A00002   EQU   A00000+00000000     1 BIT(S)                             12480000
A00003   EQU   CHASCT+00000010     1 BYTE(S)                            12490000
A00004   EQU   A00003+00000000     1 BIT(S)                             12500000
FPM      EQU   A00003+00000000     1 BIT(S)                             12510000
A00005   EQU   MSSSTAT+00000000    1 BYTE(S) ON WORD                    12520000
FINITSW  EQU   A00005+00000000     1 BIT(S)                             12530000
DINITSW  EQU   A00005+00000000     1 BIT(S)                             12540000
INITSW   EQU   A00005+00000000     1 BIT(S)                             12550000
A00006   EQU   A00005+00000000     5 BIT(S)                             12560000
FLG1A    EQU   FLGA+00000000       8 BIT(S) ON BYTE                     12570000
BYPASS   EQU   FLG1A+00000000      1 BIT(S)                             12580000
FLG2     EQU   FLGB+00000000       8 BIT(S) ON BYTE                     12590000
INTCALL  EQU   FLG2+00000000       1 BIT(S)                             12600000
MODEREQ  EQU   FLG2+00000000       1 BIT(S)                             12610000
A00007   EQU   CESWT+00000000      4 BYTE(S) ON WORD                    12620000
A00008   EQU   A00007+00000000     8 BIT(S)                             12630000
A00009   EQU   A00007+00000000     1 BIT(S)                             12640000
PROTECT  EQU   A00007+00000000     1 BIT(S)                             12650000
A00010   EQU   A00007+00000000     6 BIT(S)                             12660000
A00011   EQU   A00007+00000001     8 BIT(S)                             12670000
A00012   EQU   A00007+00000001     1 BIT(S)                             12680000
SEEK2321 EQU   A00007+00000001     1 BIT(S)                             12690000
SECONLOK EQU   A00007+00000001     1 BIT(S)                             12700000
A00013   EQU   A00007+00000001     1 BIT(S)                             12710000
FILMSK   EQU   A00007+00000001     1 BIT(S)                             12720000
T2321    EQU   A00007+00000001     1 BIT(S)                             12730000
ONLINEOK EQU   A00007+00000001     1 BIT(S)                             12740000
A00014   EQU   A00007+00000001     1 BIT(S)                             12750000
A00015   EQU   A00007+00000002     8 BIT(S)                             12760000
NDCFO    EQU   A00007+00000002     1 BIT(S)                             12770000
DPONDEV  EQU   A00007+00000002     1 BIT(S)                             12780000
A00016   EQU   A00007+00000002     1 BIT(S)                             12790000
CHANTEST EQU   A00007+00000002     1 BIT(S)                             12800000
A00017   EQU   A00007+00000002     1 BIT(S)                             12810000
A00018   EQU   A00007+00000002     1 BIT(S)                             12820000
TAPEHDR  EQU   A00007+00000002     1 BIT(S)                             12830000
AMERLDV  EQU   A00007+00000002     1 BIT(S)                             12840000
A00019   EQU   A00007+00000003     8 BIT(S)                             12850000
A00020   EQU   A00007+00000003     1 BIT(S)                             12860000
BYPALDEV EQU   A00007+00000003     1 BIT(S)                             12870000
BYPDEV   EQU   A00007+00000003     1 BIT(S)                             12880000
A00021   EQU   A00007+00000003     1 BIT(S)                             12890000
A00022   EQU   A00007+00000003     1 BIT(S)                             12900000
A00023   EQU   A00007+00000003     1 BIT(S)                             12910000
A00024   EQU   A00007+00000003     1 BIT(S)                             12920000
A00025   EQU   A00007+00000003     1 BIT(S)                             12930000
BUFFER   EQU   INBUFR+00000000     1 BYTE(S)                            12940000
@DATEND  EQU   *                                                        12950000
@9FE     EQU   DPTAPE01                                                 12960000
@9FD     EQU   DPTAPE01                                                 12970000
@9F7     EQU   DPTAPE03                                                 12980000
@9EE     EQU   DPTAPE03                                                 12990000
@9E4     EQU   DPTAPE10                                                 13000000
@9DE     EQU   DPTAPE10                                                 13010000
@9DF     EQU   DPMSGF                                                   13020000
@9DA     EQU   DPTAPE10                                                 13030000
         END    ,(C'PL/S',1400,78118)                                   13040000
