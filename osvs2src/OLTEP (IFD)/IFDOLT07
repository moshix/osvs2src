         TITLE 'IFDOLT07 DATA PROTECT PACK'                             00010000
         TITLE 'IFDOLT07 DATA PROTECT PACK'                             00020000
         LCLA  &T,&SPN                                            0002  00030000
.@001    ANOP                                                     0002  00040000
IFDOLT07 CSECT ,                                                  0002  00050000
         BC    15,24(0,@F)                                              00060000
         DC    C'IFDOLT07 16 NOV 73'                             0002  00070000
         STM   @E,@C,12(@D)                                       0002  00080000
         BALR  @B,0                                               0002  00090000
@PSTART  DS    0H                                                 0002  00100000
         USING @PSTART+00000,@B                                   0002  00110000
         ST    @D,@SAV001+4                                       0002  00120000
         LA    @F,@SAV001                                         0002  00130000
         ST    @F,8(0,@D)                                         0002  00140000
         LR    @D,@F                                              0002  00150000
*  GEN(USING CHASCT,2);                  /* COMMON AREA BASE REGISTER * 00160000
         USING CHASCT,2                                                 00170000
         DS    0H                                                       00180000
*         GEN DATA;                                                     00190000
* GENERATE DATA;                                                        00200000
*  /******************************************************************* 00210000
*  /*                                                                 * 00220000
*  /*                     DECLARED  REGISTERS                         * 00230000
*  /*                                                                 * 00240000
*  /******************************************************************* 00250000
*  DCL R0  REG(0)  PTR;                                                 00260000
*  DCL R1  REG(1)  PTR;                                                 00270000
*  DCL R2  REG(2)  PTR;                                                 00280000
*  DCL R3  REG(3)  PTR;                                                 00290000
*  DCL R4  REG(4)  PTR;                                                 00300000
*  DCL R5  REG(5)  PTR;                                                 00310000
*  DCL R6  REG(6)  PTR;                                                 00320000
*  DCL R7  REG(7)  PTR;                                                 00330000
*  DCL R8  REG(8)  PTR;                                                 00340000
*  DCL R9  REG(9)  PTR;                                                 00350000
*  DCL R10 REG(10) PTR;                                                 00360000
*  DCL R11 REG(11) PTR;                                                 00370000
*  DCL R12 REG(12) PTR;                                                 00380000
*  DCL R13 REG(13) PTR;                                                 00390000
*  DCL R14 REG(14) PTR;                                                 00400000
*  DCL R15 REG(15) PTR;                                                 00410000
*  RESTRICT(2,4,5,6,7,8);                                               00420000
*  DCL CESWT3 CHAR(1) GENERATED;         /* OLTEP SWITCHES       M4506* 00430000
*  DCL 1 * CHAR(1) BASED(ADDR(CESWT3)),  /* OLTEP SWITCHES       M4506* 00440000
*         2 * BIT(3),                    /* NA                   M4506* 00450000
*         2 GRBCTL BIT(1),               /* GRAB IN CONTROL      M4506* 00460000
*         2 SUSDEL BIT(1),               /* SUSPENDED DELETION   M4506* 00470000
*           3 * BIT(1);                  /* NA                   M4506* 00480000
*  DCL OLTTAB GENERATED;                 /* LINK TABLE           M4506* 00490000
*  DCL 1 * BDY(WORD) BASED(ADDR(OLTTAB)), /* LINK TABLE          M4506* 00500000
*         2 OLTTAB1 PTR,                 /* OLD EXIO             M4506* 00510000
*         2 OLTTAB2 PTR,                 /* OLD WAITIO           M4506* 00520000
*           3 * PTR;                     /* NA                   M4506* 00530000
*                                                                       00540000
*                                                                       00550000
*  /******************************************************************* 00560000
*  /*                                                                 * 00570000
*  /*                       SECTION CONTROL TABLE                     * 00580000
*  /*                                                                 * 00590000
*  /******************************************************************* 00600000
*                                                                       00610000
*  DCL CHASCT GENERATED;            /* SECTION CONTROL TABLE          * 00620000
*  DCL 1 * CHAR(1) BASED(ADDR(CHASCT)+10),  /* SCT STRUCTURE          * 00630000
*        3 * BIT(1),                /* NA                             * 00640000
*        3 FPM BIT(1);              /* FILE PROTECT MODE BIT          * 00650000
*  DCL 1 * CHAR(1) BASED(ADDR(CHASCT)+11),    /* SCT CDS FLAGS   M1006* 00660000
*        3 CDSFPM BIT(1),                /* FILE PROTECT MODE    M1006* 00670000
*        3 * BIT(1),                     /* NA                   M1006* 00680000
*        3 CDSCEVOL BIT(1),              /* CE VOLUME            M1006* 00690000
*        3 * BIT(5);                     /* NA                   M1006* 00700000
*                                                                       00710000
* /******************************************************************** 00720000
* /*                                                                  * 00730000
* /*                 COMMUNICATION SWITCHES STRUCTURE                 * 00740000
* /*                                                                  * 00750000
* /******************************************************************** 00760000
*                                                                       00770000
*                                                                       00780000
*  DCL CESWT CHAR(5) GENERATED;     /* COMMUNICATION SWITCHES         * 00790000
*  DCL 1 * BASED(ADDR(CESWT)),      /* CE SWITCHES                    * 00800000
*        3 * BIT(8),                /* CE SWITCH                      * 00810000
*          5 * BIT(1),              /* NA                             * 00820000
*          5 PROTECT BIT(1),        /* DATA PROT ON SEC DEV           * 00830000
*          5 * BIT(6),              /* NA                             * 00840000
*        3 * BIT(8),                /* CE SWITCH 1                    * 00850000
*          5 * BIT(4),              /* NA                             * 00860000
*          5 FILMSK BIT(1),         /* FILE MASK BIT                  * 00870000
*          5 * BIT(1),              /* NA                             * 00880000
*          5 ONLINEOK BIT(1),       /* ONLINE OK BIT                  * 00890000
*          5 * BIT(1),              /* NA                             * 00900000
*        3 * BIT(8),                /* CE SWITCH 2                    * 00910000
*          5 NDCFO BIT(1),          /* PREVENTS DYNAMIC COMM INTERVAL * 00920000
*          5 DPONDEV BIT(1),        /* DATA DONE ON THIS DEVICE       * 00930000
*          5 * BIT(1),              /* NA                             * 00940000
*          5 CHANTEST BIT(1),       /* INDICATES CHAN TEST ACTIVE     * 00950000
*          5 * BIT(1),              /* NA                             * 00960000
*          5 * BIT(1),              /* NA                             * 00970000
*          5 TAPEHDR BIT(1),        /* TAPE HEADER BIT                * 00980000
*          5 AMERLDV BIT(1),             /* MERLIN DEVICE        M4505* 00990000
*        3 * BIT(8),                /* CE SWITCH 3                    * 01000000
*          5 * BIT(1),              /* NA                             * 01010000
*          5 NURUN BIT(1),          /* BRING NEW TESTS                * 01020000
*          5 BYPDEV BIT(1),         /* BYPASS TESTS ON THIS DEVICE    * 01030000
*          5 * BIT(1),              /* NA                             * 01040000
*          5 * BIT(1),              /* NA                             * 01050000
*          5 * BIT(1),              /* NA                             * 01060000
*          5 * BIT(1),              /* NA                             * 01070000
*          5 STDLAB BIT(1);         /* STANDARD LABEL BIT             * 01080000
*                                                                       01090000
*  DCL I FIXED;                          /* WORK WORD           S20203* 01100000
*         DCL LABEL2 GENERATED;    /*                           S20203* 01110000
*                                                                       01120000
* /******************************************************************** 01130000
* /*                                                                  * 01140000
* /*                      DEVICE TABLE STRUCTURE                      * 01150000
* /*                                                                  * 01160000
* /******************************************************************** 01170000
*                                                                       01180000
*         DCL  1 * BASED(R7),          /*                       S21050* 01190000
*         3 DEVADEB CHAR(8),             /* DEV ADDR IN EBCDIC  S21050* 01200000
*                3 UCBAD POINTER(31),  /* UCB ADDR (2BYTES)     S21050* 01210000
*                3 DEVFLG1 CHAR(1),    /* FLAG BYTE #1          S21050* 01220000
*                 5 STATUS BIT(1),     /* ON LINE VS. OFF-LINE  S21050* 01230000
*                 5 PRIMARY BIT(1),    /* PRIMARY BIT           S21050* 01240000
*                 5 DPDONE  BIT(1),    /* D.P. COMPLETE         S21050* 01250000
*                 5 *       BIT(3),    /* FILL                  S21050* 01260000
*                 5 FILEPROT BIT(1),   /* F.P. MODE OPERATION   S21050* 01270000
*                 5 *       BIT(1),    /* FILL                  S21050* 01280000
*                3 DEVFLG2 CHAR(1),    /* FLAG BYTE # 2         S21050* 01290000
*           5 * BIT(2),                  /* N/A                 S21050* 01300000
*           5 CEVOL BIT(1),              /* CE VOL ON DEVICE    S21050* 01310000
*                 5   STDLABL BIT(1),  /* STANDARD TAPE LABEL   S21050* 01320000
*                 5 * BIT(4),          /* FILL                  S21050* 01330000
*                3 DEVFLG3 CHAR(1),    /* FLAG BYTE # 3         S21050* 01340000
*                3 DEVFLG4 CHAR(1),    /* FLAG BYTE # 3         S21050* 01350000
*                3 TAPELABL CHAR(16),  /* TAPE LABEL SAVE AREA  S21050* 01360000
*                 5 VOL CHAR(10),      /* VOL NAME              S21050* 01370000
*                 5 HDR CHAR (4),      /* HDR NAME              S21050* 01380000
*                 5 MODESV CHAR(1),    /* MODE SAVE AREA        S21050* 01390000
*                 5 * CHAR(1),         /* FILL                  S21050* 01400000
*                3 ADRHEX CHAR (4),    /* 4 BYTE HEX ADDRESS    S21050* 01410000
*                 5 * CHAR(2),         /* FILL                  S21050* 01420000
*               5 HEXAD CHAR(2),         /* 2 BYTE HEX ADDRESS  S21052* 01430000
*            3 CDSINFOR CHAR(16),        /* CDS INFORMATION     X02906* 01440000
*               5 FEATURES CHAR(1),      /* FEATURES            X02906* 01450000
*               5 MODEL CHAR(1),         /* MODEL #             X02906* 01460000
*               5 CLASS CHAR(1),         /* CLASS               X02906* 01470000
*               5 TYPE CHAR(1),          /* TYPE                X02906* 01480000
*               5 * CHAR(1),             /* N/A                 X02906* 01490000
*               5 CDSFLAGS CHAR(1),      /* CDS FLAGS           X02906* 01500000
*                 7 DVCDSFPM BIT(1),     /* FILE PROTECT MODE   X02906* 01510000
*                 7 * BIT(1),            /*                     X02906* 01520000
*                 7 DVCDSCEV BIT (1),    /* CE VOLUME MOUNTED   X02906* 01530000
*                 7 * BIT(5);            /*                     X02906* 01540000
*                                                                       01550000
*                                                                       01560000
*                                                                       01570000
*  /******************************************************************* 01580000
*  /*                                                                 * 01590000
*  /*           EXIO PARAMETER LIST                                   * 01600000
*  /*                                                                 * 01610000
*  /******************************************************************* 01620000
*                                                                       01630000
*                                       /* IO EFFECTOR CNTL BLK Y02906* 01640000
*                                       /* IN COMMON AREA       Y02906* 01650000
*  DCL EFCTRCB CHAR(20) GEND;           /* IO EFFECTOR CNTL BLK       * 01660000
*  DCL CCWPTR PTR(31) GEND;             /* CCW LIST POINTER     Y02906* 01670000
*  DCL DVTPTR PTR(31) GEND;             /* DEVICE TABEL POINTER Y02906* 01680000
*  DCL FLGA   BIT(8)  GEND;             /* FLAG BYTE 1          Y02906* 01690000
*                                                                       01700000
*  DCL FLGB   BIT(8)  GEND;             /* FLAG BYTE 2          Y02906* 01710000
*                                                                       01720000
* DCL 1 FLG1A BIT(8) BASED(ADDR(FLGA)),                                 01730000
*       3 BYPASS BIT(1);                 /* BYPASS PREFIX       Y02906* 01740000
*                                                                       01750000
*  DCL 1 FLG2 BIT(8) BASED(ADDR(FLGB)),                       /*Y02906* 01760000
*        3 INTCALL BIT(1),              /* INTERNAL CALL FOR IO Y02906* 01770000
*        3 MODEREQ BIT(1);              /* IF ON MODE SET REQ   Y02906* 01780000
*  DCL FILEMSK CHAR(1) GEND;            /* FILE MSK FOR IOEFFEC Y02906* 01790000
* DCL SNSCNT CHAR(1) GEND;                                              01800000
* DCL TECBPTRX PTR(31) GEND;                                            01810000
*  DCL IORTNADR GEND;                   /* ADDR OF IO EFFECTOR  Y02906* 01820000
*         DCL 1 WAITLST CHAR(16) BDY(WORD), /* WAITIO LIST      Y02906* 01830000
*              3 XMGR CHAR(1) INIT('00'X), /* TRANS MGR STUFF   Y02906* 01840000
*              3 LVL CHAR(1) INIT('02'X),/* WAITIO LVL          Y02906* 01850000
*              3 MODID CHAR(2) INIT('36'), /* IFDOLT36 ID       Y02906* 01860000
*              3 TECBPTR PTR(31) INIT(ADDR(TECB)),/* TECB ADDR  Y02906* 01870000
*              3 CDSPTR PTR(31) INIT(0),  /*CDS = 0             Y02906* 01880000
*              3 FLG BIT(8) INIT('80'X), /* SET WAIT = YES      Y02906* 01890000
*               5 WAITYES BIT(1),        /* FLAG TO 1           Y02906* 01900000
*              3 TIME CHAR(2) INIT('001E'X); /* TIME IN SECONDS Y02906* 01910000
*                                                                       01920000
*                                                                       01930000
*  /******************************************************************* 01940000
*  /*                                                                 * 01950000
*  /*                  TEST EVENT CONTROL BLOCK FIELD                 * 01960000
*  /*                                                                 * 01970000
*  /******************************************************************* 01980000
*                                                                       01990000
*         DCL 1 TECB,                     /* EVENT BLOCK FOR IO Y02906* 02000000
*               2 FLDCNT CHAR(1) INIT('01'X),  /* NUMBER FDLS   Y02906* 02010000
*               2 FLDSIZE CHAR(1) INIT('0C'X), /* SIZE EACH FLD Y02906* 02020000
*               2 SOMETNG CHAR(1) INIT('00'X), /* N/A           Y02906* 02030000
*               2 SNSSIZE CHAR(1) INIT('18'X), /* SENSE EXPTD   Y02906* 02040000
*               2 FLG1 CHAR(1) INIT('00'X),    /* FLAGS         Y02906* 02050000
*               2 SNSCNTTB CHAR(1) INIT('01'X), /* XPECTED COUNTY02906* 02060000
*               2 CLRTECB  CHAR(39),     /* LABEL TO CLEAR TECB YM3336* 02070000
*                 3 CNTSNS CHAR(1) INIT('00'X), /* NUMB OCCURED Y02906* 02080000
*                 3 CNTINT CHAR(1) INIT('00'X), /*NUMB INTERRUPTY02906* 02090000
*                 3 CCP CHAR(1),        /* SIO COND CODE        Y02906* 02100000
*                 3 * CHAR(3),          /* N/A                  YM3336* 02110000
*                 3 CSW1 CHAR(8),       /* CSW NO. ONE          Y02906* 02120000
*                   5 * CHAR(4),        /* N/A                  Y02906* 02130000
*                   5 STATUSX CHAR(2),  /* TWO STATUS BYTES     Y02906* 02140000
*                     7 EXIOK CHAR(1),  /* STATUS BYTE 1        Y02906* 02150000
*                       9 * BIT(6),     /* N/A                  Y02906* 02160000
*                       9 UNITCK BIT(1), /* UNIT CHECK          Y02906* 02170000
*                       9 UNITEXCP BIT(1), /* UNIT EXCEPTION BITY02906* 02180000
*                     7 BYTE2 CHAR(1),  /* STATUS BYTE 2        Y02906* 02190000
*                       9 * BIT(1),     /* N/A                  Y02906* 02200000
*                       9 INLENGTH  BIT(1), /* INCORR LNG IND   Y02906* 02210000
*                       9 * BIT(6),     /* N/A                  Y02906* 02220000
*                   5 * CHAR(2),        /* N/A                  Y02906* 02230000
*                 3 SENSE  CHAR(24),    /* SENSE COUNT          Y02906* 02240000
*                   5 * CHAR(3),        /* N/A                  Y02906* 02250000
*                   5 SNS1 CHAR(7),     /* SENSE BYTES          Y02906* 02260000
*                     7 SNSFLD BIT(8),  /* BYTE0  SENSE         Y02906* 02270000
*                       9 * BIT(1),     /* N/A                  Y02906* 02280000
*                       9 SNS2 BIT(1),  /* BIT 1 SNS BYTE 0     Y02906* 02290000
*                     7 * CHAR(2),      /* SNS BYTES 1 & 2      Y02906* 02300000
*                     7 * BIT(8),       /* SNS BYTE 3           Y02906* 02310000
*                       9 * BIT(5),     /* FILL                 Y02906* 02320000
*                       9 PEIND BIT(1), /* BIT 5 BYTE3 OF SNS   Y02906* 02330000
*                     7 * CHAR(2),      /* SENCE BYTES 4 AND 5  Y02906* 02340000
*                     7 * CHAR(1),      /* SENCE BYTE 6         Y02906* 02350000
*                       9 * BIT(4),     /* NOT REFERENCED       Y02906* 02360000
*                       9 BIT4 BIT(1);  /* BIT FOUR FOR BIRTCH  Y03128* 02370000
*  /******************************************************************* 02380000
*  /*                                                                 * 02390000
*  /*                         R0 DATA LENGTH FIELD                    * 02400000
*  /*                                                                 * 02410000
*  /******************************************************************* 02420000
*                                                                       02430000
*                                  /*                           S20203* 02440000
*         DCL 1 BUF CHAR(20),            /* LABEL BUFFER        S20203* 02450000
*               3 STLAB CHAR(4),         /* STAND LABEL         S20203* 02460000
*               3 CEVOL1 CHAR(6),        /* CE VOLUME           S20203* 02470000
*               3 SECBYT CHAR(1),        /* SECURITY BYTE       S20203* 02480000
*               3 * CHAR(9);             /* NA                  S20203* 02490000
*         DCL 1 BUF1 CHAR(5),            /* HA BUFFER           S20203* 02500000
*               3 * BIT(8),              /* NA                  S20203* 02510000
*                 5 * BIT(5),            /* NA                  S20203* 02520000
*                 5 MERLIN BIT(1),       /* 3330 CE BIT         S20203* 02530000
*                 5 * BIT(2),            /* NA                  S20203* 02540000
*               3 * CHAR(4);             /* NA                  S20203* 02550000
*         DCL 1 BUF2 CHAR(20),           /* F0FE BUFFER         S20203* 02560000
*               3 * CHAR(14),            /* NA                  S20203* 02570000
*               3 CEF0FE CHAR(5),        /* CE F0FE BIT         S20203* 02580000
*               3 * CHAR(1);             /* NA                  S20203* 02590000
*                                                                       02600000
*                                                                       02610000
*                                                                       02620000
*                                                                       02630000
*  DCL IFDMSG07 EXT ENTRY;          /* MESSAGE MODULE                 * 02640000
*  DCL MSGPTR PTR INIT(ADDR(IFDMSG07));   /* POINTER TO MESSAGE MODULE* 02650000
*  DCL 1 * BASED(R4),               /* MESSAGE ADDRESS                * 02660000
*        3 MSG1 PTR,                /* POINTER TO MESSAGE             * 02670000
*        3 MSG2 PTR,                /* POINTER TO MESSAGE             * 02680000
*        3 MSG2A PTR,                    /* PNTR TO IFD124I     Y01906* 02690000
*        3 MSG3 PTR,                /* POINTER TO MESSAGE             * 02700000
*        3 MSG4 PTR,                /* POINTER TO MESSAGE             * 02710000
*          3 MSG5 PTR,              /* POINTER TO MESSAGE             * 02720000
*         3 MSG6 PTR,                    /* POINTER TO MESSAGE  S20203* 02730000
*         3 MSG7 PTR,                    /* POINTER TO MESSAGE  S20203* 02740000
*         3 MSG8 PTR;               /* POINTER TO MESSAGE       S20203* 02750000
*   DCL MSGDVAD CHAR(8) BASED(R1+16);    /*DEV ADDR AREA IN MSG S21050* 02760000
*   DCL MSGDVAD1 CHAR(8) BASED(R1+26);   /* DEVAD IN IFD124I    Y01906* 02770000
*   DCL MSGVOLID CHAR(6) BASED(R1+42);   /* NON-CE VOLID IN 124IY01906* 02780000
*   DCL MSGDVAD2 CHAR(8) BASED(R1+32);   /*DEV ADDR AREA IN MSG S21050* 02790000
*   DCL MSGDVAD3 CHAR(8) BASED(R1+29);   /*DEV ADDR AREA IN MSG S21050* 02800000
*  DCL MSGDVAD4 CHAR(8) BASED(R1+19);    /*DEV ADDR AREA IN MSG S21050* 02810000
*  DCL MSGCSW CHAR(14) BASED(R1+18);     /* CSW DATA IN MESSAGE S20203* 02820000
* DCL MSGSNS CHAR(12) BASED(R1+37);      /* SNS DATA IN IFD137I Y01906* 02830000
*  DCL SIX CHAR(2) INIT('0006'X);   /* USED TO COMPARE R0 DATA LENGTH * 02840000
*  DCL 1 MSGPARM BASED(R1),         /* NA                             * 02850000
*        3 LENGTH CHAR(1),          /* LENGTH OF RESPONSE             * 02860000
*        3 BUFAD PTR(24),           /* POINTER TO RESPONSE BUFFER     * 02870000
*        3 MSGECBAD FIXED;          /* ECB ADDRESS                    * 02880000
*  DCL DECB FIXED INIT(0);          /* EVENT CONTROL BLOCK            * 02890000
*   DCL INBUFR CHAR(72) GENERATED;                                      02900000
*    DCL BUFFER CHAR(1) BASED(ADDR(INBUFR));                            02910000
*  DCL 1 INBUF CHAR(62),                 /* INPUT BUFFER        S20203* 02920000
*         3 CSWIN CHAR(14),              /* CONVERTED CSW DATA  S20203* 02930000
*         3 * CHAR(6),                  /* CONVERTED DEV ADDR   Y02906* 02940000
*         3 SNSIN CHAR(48);              /* CONVERTED SENSE DATAS20203* 02950000
*  DCL LABEL0 GENERATED;                 /*                     S20203* 02960000
*  DCL LABEL1 GENERATED;                 /*                     S20203* 02970000
*  DCL TAB28 PTR(31) GENERATED;     /* NEW MACRO ENTRY POINT          * 02980000
*  DCL CNVRT CHAR(14) GENERATED;    /* CONVERT PARAMETER LIST         * 02990000
*         DCL SEEKVOL CHAR(7) INIT('00000000000003'X);/* SEEK TO VOL1 * 03000000
*                                        /*                     S20203* 03010000
*         DCL SEEKF0FE CHAR(6) INIT('000000060000'X); /* SEEK TO F0FE * 03020000
*                                        /*                     S20203* 03030000
*  DCL SEEKMERL CHAR(6) INIT('000000000000'X);                /*S20203* 03040000
*  /******************************************************************* 03050000
*  /*                                                                 * 03060000
*  /*                  DETERMINE ONLINE OFFLINE STATUS                * 03070000
*  /*                                                                 * 03080000
*  /*                                                                 * 03090000
*         /************************************************************ 03100000
*                                                                       03110000
*         R4=MSGPTR;                     /* PUT PTR TO MSG MOD IN R4  * 03120000
         L     @4,MSGPTR                                          0075  03130000
*         IF STATUS  = '1'B THEN        /* IF DASD IS ONLINE    Y02906* 03140000
         TM    12(@7),B'10000000'                                 0076  03150000
         BC    12,@9FF                                            0076  03160000
*           DO;                         /* SET THE FOLLOWING    Y02906* 03170000
*           ONLINEOK  = '1'B;           /* ONLINE OK COMMO SW   Y02906* 03180000
         OI    A00010+1,B'00000010'                               0078  03190000
*           DPPACK01:                   /* AND                  Y02906* 03200000
*           FPM       = '1'B;           /* SCT F.P.MODE SW      Y02906* 03210000
DPPACK01 OI    A00005,B'01000000'                                 0079  03220000
*           FILEPROT  = '1'B;           /* DEVTAB F.P.MODE      Y02906* 03230000
         OI    12(@7),B'00000010'                                 0080  03240000
*           CDSFPM    = '1'B;           /* SCT F.P.M. IN CDS    Y02906* 03250000
         OI    A00007,B'10000000'                                 0081  03260000
*           DVCDSFPM  = '1'B;           /* DEVTAB CDS FPM       Y02906* 03270000
         OI    41(@7),B'10000000'                                 0082  03280000
*           DPDONE    = '1'B;           /* D.P. COMPLETE        Y02906* 03290000
         OI    12(@7),B'00100000'                                 0083  03300000
*           GO TO DPPACK08;             /* GO EXIT THIS         Y02906* 03310000
         BC    15,DPPACK08                                        0084  03320000
*           END;                        /* MODULE               Y02906* 03330000
*         IF DPDONE='1'B THEN                                           03340000
@9FF     TM    12(@7),B'00100000'                                 0086  03350000
*           GOTO DPPACK08;                                              03360000
         BC    01,DPPACK08                                        0087  03370000
*   DPPACK00:                            /*                     Y01906* 03380000
*         IF TYPE = '09'X |             /* IF THIS IS A 3330A   Y02906* 03390000
*            TYPE = '0D'X THEN          /* OR ICEBURG           Y02906* 03400000
DPPACK00 CLI   39(@7),X'09'                                       0088  03410000
         BC    08,@9FE                                            0088  03420000
         CLI   39(@7),X'0D'                                       0088  03430000
         BC    07,@9FD                                            0088  03440000
*           GO TO DPPACK14;             /* GO TO EXIO SETUP     Y02906* 03450000
         BC    08,DPPACK14                                        0089  03460000
*                                                                       03470000
*  /******************************************************************* 03480000
*  /*                                                                 * 03490000
*  /*                   SET UP PARAMETERS FOR EXIO                    * 03500000
*  /*                                                                 * 03510000
*  /******************************************************************* 03520000
*                                                                       03530000
*         CCWPTR = ADDR(LABEL1);        /* SET CCW POINTER      Y02906* 03540000
@9FD     LA    @F,LABEL1                                          0090  03550000
         ST    @F,CCWPTR                                          0090  03560000
*                                                                       03570000
*  GEN(BAL   R5,IORTN);                  /* I/O ROUTINES         M4506* 03580000
         BAL   R5,IORTN                                                 03590000
         DS    0H                                                       03600000
*  /******************************************************************* 03610000
*  /*                                                                 * 03620000
* /*                             CHECK FOR CE PACK              S20203* 03630000
*  /*                                                                 * 03640000
*  /******************************************************************* 03650000
*                                                                       03660000
*           IF CEF0FE='F0FE-' THEN       /* IS VOL F0FE PACK    S20203* 03670000
         CLC   BUF2+14(5),@C4                                     0092  03680000
*                 GOTO DPPACK09;         /* GO SET UP FOR EXIT  S20203* 03690000
         BC    08,DPPACK09                                        0093  03700000
*                                                                       03710000
*                                                                       03720000
*  /******************************************************************* 03730000
*  /*                                                                 * 03740000
*  /*                   SET UP PARAMETERS FOR EXIO              S20203* 03750000
*  /*                                                                 * 03760000
*  /******************************************************************* 03770000
*                                                                       03780000
*  DPPACK12:                             /*                     S20203* 03790000
*         CCWPTR = ADDR(LABEL0);        /* SET CCW POINTER      Y02906* 03800000
DPPACK12 LA    @F,LABEL0                                          0094  03810000
         ST    @F,CCWPTR                                          0094  03820000
*                                                                       03830000
*                                                                       03840000
*  GEN(BAL   R5,IORTN);                  /* I/O ROUTINES         M4506* 03850000
         BAL   R5,IORTN                                                 03860000
         DS    0H                                                       03870000
* /******************************************************************** 03880000
* /*                                                                  * 03890000
*  /*              CHECK LABEL AND SECURITY BIT                 S20203* 03900000
* /*                                                                  * 03910000
* /******************************************************************** 03920000
*                                                                       03930000
*         IF STLAB = 'VOL1' THEN         /* IF A STANDARD LABL, Y01906* 03940000
         CLC   BUF(4),@C5                                         0096  03950000
*            GOTO DPPAK12A;              /* CONTINUE CHECKING.  Y01906* 03960000
         BC    08,DPPAK12A                                        0097  03970000
*            ELSE DO;                    /*                     Y01906* 03980000
*               R1 = MSG2A;              /* IF NOT, PRINT -     Y01906* 03990000
         L     @1,8(0,@4)                                         0099  04000000
*               GO TO DPPACK13;          /* IFD124I SHORT FORM  Y01906* 04010000
         BC    15,DPPACK13                                        0100  04020000
*            END;                        /*                     Y01906* 04030000
*  DPPAK12A:                             /*                     Y01906* 04040000
*         IF SECBYT='F0'X|               /* NO SECURITY          M4506* 04050000
*           SECBYT='40'X |               /* NO SECURITY               * 04060000
*           SECBYT='00'X THEN            /* NO SECURITY          M4506* 04070000
DPPAK12A CLI   BUF+10,X'F0'                                       0102  04080000
         BC    08,@9FC                                            0102  04090000
         CLI   BUF+10,X'40'                                       0102  04100000
         BC    08,@9FB                                            0102  04110000
         CLI   BUF+10,X'00'                                       0102  04120000
         BC    07,@9FA                                            0102  04130000
*             IF CEVOL1='CEPACK' THEN    /* CE PACK IDENTITY     M4506* 04140000
@9FB     EQU   *                                                  0103  04150000
@9FC     CLC   BUF+4(6),@C9                                       0103  04160000
*               GOTO DPPACK09;           /* CE PACK FOUND        M4506* 04170000
         BC    08,DPPACK09                                        0104  04180000
*             ELSE DO;                   /* STD LABL, NOT CEPAK Y01906* 04190000
*                R1 = MSG2;              /* PRINT IFD124I(LONG) Y01906* 04200000
         L     @1,4(0,@4)                                         0106  04210000
*                MSGVOLID = CEVOL1;      /* PUT VOLID IN MSG    Y01906* 04220000
         MVC   42(6,@1),BUF+4                                     0107  04230000
*                GO TO DPPACK13;         /* GO PRINT IFD124I    Y01906* 04240000
         BC    15,DPPACK13                                        0108  04250000
*             END;                       /*                     Y01906* 04260000
*         ELSE GOTO DPPACK11;            /* SECURITY PROTECTED   M4506* 04270000
*  DPPACK14:                             /*                     S20203* 04280000
*                                                                       04290000
*                                                                       04300000
*  /******************************************************************* 04310000
*  /*                                                                 * 04320000
*  /*                   SET UP PARAMETERS FOR EXIO              S20203* 04330000
*  /*                                                                 * 04340000
*  /******************************************************************* 04350000
*                                                                       04360000
*         CCWPTR = ADDR(LABEL2);        /* SET CCW POINTER      Y02906* 04370000
@9F9     EQU   *                                                  0111  04380000
DPPACK14 LA    @F,LABEL2                                          0111  04390000
         ST    @F,CCWPTR                                          0111  04400000
*                                                                       04410000
*                                                                       04420000
*  GEN(BAL   R5,IORTN);                  /* I/O ROUTINES         M4506* 04430000
         BAL   R5,IORTN                                                 04440000
         DS    0H                                                       04450000
*  /******************************************************************* 04460000
*  /*                                                                 * 04470000
*  /*                   CHECK MERLIN CE BIT                     S20203* 04480000
*  /*                                                                 * 04490000
*  /******************************************************************* 04500000
*            IF MERLIN='1'B THEN         /* IS THE VOL A CE PACKS20203* 04510000
         TM    BUF1,B'00000100'                                   0113  04520000
*               GOTO DPPACK09;           /* GO SET UP FOR EXIT  S20203* 04530000
         BC    01,DPPACK09                                        0114  04540000
*                                        /*                     S20203* 04550000
*         GOTO DPPACK12;                 /* CHK FOR CEPACK LABL |01906* 04560000
         BC    15,DPPACK12                                        0115  04570000
*                                                                       04580000
*  /******************************************************************* 04590000
*  /*                                                                 * 04600000
*  /*                     PRINT IFD124I MESSAGE                       * 04610000
*  /*                                                                 * 04620000
*  /******************************************************************* 04630000
*  DPPACK13:                             /*                     S20203* 04640000
*         FILMSK='0'B;                   /*SET TO INHIBIT MODE SET CHG* 04650000
DPPACK13 NI    A00010+1,B'11110111'                               0116  04660000
*  MSGDVAD1=DEVADEB;                /* PUT DEV ADDR IN MSG2           * 04670000
         MVC   26(8,@1),0(@7)                                     0117  04680000
*  GEN(BAL   R5,DPPWTO);                 /* PRINT MESSAGE        M4506* 04690000
         BAL   R5,DPPWTO                                                04700000
         DS    0H                                                       04710000
*                                                                       04720000
*  GOTO DPPACK10;                        /*GO PRINT MSG IFD139D       * 04730000
         BC    15,DPPACK10                                        0119  04740000
*                                                                       04750000
*  DPPACK09:                             /*                     S20203* 04760000
*         DPDONE   ='1'B;               /* SET DP COMPLETE SW   Y02906* 04770000
DPPACK09 OI    12(@7),B'00100000'                                 0120  04780000
*         FILEPROT ='0'B;               /* OFF FPM  SW          Y02906* 04790000
         NI    12(@7),B'11111101'                                 0121  04800000
*         FPM      ='0'B;               /* OFF FPM  SW          Y02906* 04810000
         NI    A00005,B'10111111'                                 0122  04820000
*         DVCDSFPM ='0'B;               /* OFF FPM  SW          Y02906* 04830000
         NI    41(@7),B'01111111'                                 0123  04840000
*         DVCDSCEV ='1'B;               /* ON CE VOL SW         Y02906* 04850000
         OI    41(@7),B'00100000'                                 0124  04860000
*         CDSFPM   ='0'B;               /* OFF FPM SW           Y02906* 04870000
         NI    A00007,B'01111111'                                 0125  04880000
*         CDSCEVOL ='1'B;               /* ON CEVOL SW          Y02906* 04890000
         OI    A00007,B'00100000'                                 0126  04900000
*         CEVOL    ='1'B;               /* ON CEVOL SW          Y02906* 04910000
         OI    13(@7),B'00100000'                                 0127  04920000
*  GOTO DPPACK08;                        /*                     S20203* 04930000
         BC    15,DPPACK08                                        0128  04940000
*  DPPACK02:                                                            04950000
*  IF CCP='F3'X THEN                /* IF CC=3 GO PRINT          M1310* 04960000
DPPACK02 CLI   TECB+8,X'F3'                                       0129  04970000
*     GOTO DPPACK04;                /* MESSAGE                        * 04980000
         BC    08,DPPACK04                                        0130  04990000
*  IF SNS2='0'B THEN                /* IF INTERVENTION IS NOT REQUIRED* 05000000
         TM    TECB+23,B'01000000'                                0131  05010000
*     GOTO DPPACK05;                /* GO PRINT MESSAGE               * 05020000
         BC    08,DPPACK05                                        0132  05030000
*                                                                       05040000
*  R1=MSG4;                         /* POINTER TO MESSAGE             * 05050000
         L     @1,16(0,@4)                                        0133  05060000
*  MSGDVAD3=DEVADEB;                /* PUT DEV ADDR IN MSG4           * 05070000
         MVC   29(8,@1),0(@7)                                     0134  05080000
*  GEN(BAL   R5,DPPWTO);                 /* PRINT MESSAGE        M4506* 05090000
         BAL   R5,DPPWTO                                                05100000
         DS    0H                                                       05110000
*                                                                       05120000
*  GOTO DPPACK10;                        /* PRINT MSG IFD139D   Y01906* 05130000
         BC    15,DPPACK10                                        0136  05140000
*                                                                       05150000
*  DPPACK03:                                                            05160000
*  R1=MSG6;                         /* POINTER TO MESSAGE             * 05170000
DPPACK03 L     @1,24(0,@4)                                        0137  05180000
*  MSGCSW=CSWIN;                    /* PUT CONVERTED DATA IN MSG      * 05190000
         MVC   18(14,@1),INBUF                                    0138  05200000
*  MSGSNS = SNSIN;                       /* PUT SENSE IN IFD137IY01906* 05210000
         MVC   37(12,@1),INBUF+20                                 0139  05220000
*  GEN(BAL   R5,DPPWTO);                 /* PRINT MESSAGE        M4506* 05230000
         BAL   R5,DPPWTO                                                05240000
         DS    0H                                                       05250000
*  /******************************************************************* 05260000
*  /*                                                                 * 05270000
*  /*                          PRINT MESSAGE IFD139D                  * 05280000
*  /*                                                                 * 05290000
*  /******************************************************************* 05300000
*  DPPACK10:                                                            05310000
*  R1=MSG5;                         /* POINTER TO MESSAGE             * 05320000
DPPACK10 L     @1,20(0,@4)                                        0141  05330000
*  BUFAD=ADDR(BUFFER);              /* SET UP BUFFER ADDRESS          * 05340000
         LA    @F,BUFFER                                          0142  05350000
         ST    @F,@TEMP4                                          0142  05360000
         MVC   1(3,@1),@TEMP4+1                                   0142  05370000
*  MSGECBAD=ADDR(DECB);             /* PTR TO PWTOR ECB               * 05380000
         LA    @F,DECB                                            0143  05390000
         ST    @F,4(0,@1)                                         0143  05400000
*  LENGTH='01'X;                    /* LENGTH OF RESPONSE             * 05410000
         MVI   0(@1),X'01'                                        0144  05420000
*  DECB=0;                          /* CLEAR EVENT CONTROL BLOCK      * 05430000
         SR    @F,@F                                              0145  05440000
         ST    @F,DECB                                            0145  05450000
*  GEN(BAL   R5,DPPWTOR);                /* PRINT AND REPLY      M4506* 05460000
         BAL   R5,DPPWTOR                                               05470000
         DS    0H                                                       05480000
*  IF BUFFER='P' THEN               /* IF PROCEED GO SET UP FOR RETURN* 05490000
         CLI   BUFFER,C'P'                                        0147  05500000
*     GOTO DPPACK01;                /* TO CALLING MODULE              * 05510000
         BC    08,DPPACK01                                        0148  05520000
*  IF BUFFER='B' THEN DO;                                               05530000
         CLI   BUFFER,C'B'                                        0149  05540000
         BC    07,@9F8                                            0149  05550000
*  DPPACK07:                                                            05560000
*         IF PRIMARY ='1'B THEN                                         05570000
DPPACK07 TM    12(@7),B'01000000'                                 0151  05580000
         BC    12,@9F7                                            0151  05590000
*     BYPDEV='1'B;                                                      05600000
         OI    A00010+3,B'00100000'                               0152  05610000
*     GOTO DPPACK08;                                                    05620000
         BC    15,DPPACK08                                        0153  05630000
*                     END;                                              05640000
*  IF BUFFER='R' THEN               /* IF RETRY                       * 05650000
@9F8     CLI   BUFFER,C'R'                                        0155  05660000
*     GOTO DPPACK00;                /* GO READ R0 AGAIN               * 05670000
         BC    08,DPPACK00                                        0156  05680000
*  ELSE GOTO DPPACK10;              /* TRY AGAIN, DID NOT RECOGNIZE   * 05690000
         BC    15,DPPACK10                                        0157  05700000
*                                   /* REPLY                          * 05710000
*  /******************************************************************* 05720000
*  /*                                                                 * 05730000
*  /*                     PRINT MESSAGE IFD138I                       * 05740000
*  /*                                                                 * 05750000
*  /******************************************************************* 05760000
*  DPPACK04:                                                            05770000
*  R1=MSG1;                         /* POINTER TO MESSAGE             * 05780000
DPPACK04 L     @1,0(0,@4)                                         0158  05790000
*  MSGDVAD=DEVADEB;                 /* PUT DEV ADDR IN MSG1           * 05800000
         MVC   16(8,@1),0(@7)                                     0159  05810000
*  GEN(BAL   R5,DPPWTO);                 /* PRINT MESSAGE        M4506* 05820000
         BAL   R5,DPPWTO                                                05830000
         DS    0H                                                       05840000
*  GOTO DPPACK10;                                                       05850000
         BC    15,DPPACK10                                        0161  05860000
*                                                                       05870000
*  /******************************************************************* 05880000
*  /*                                                                 * 05890000
*  /*                     PRINT MESSAGE IFD125I                       * 05900000
*  /*                                                                 * 05910000
*  /******************************************************************* 05920000
*  DPPACK05:                                                            05930000
*  R1=MSG3;                         /* POINTER TO MESSAGE             * 05940000
DPPACK05 L     @1,12(0,@4)                                        0162  05950000
*  MSGDVAD2=DEVADEB;                /* PUT DEV ADDR IN MSG3           * 05960000
         MVC   32(8,@1),0(@7)                                     0163  05970000
*  GEN(BAL   R5,DPPWTO);                 /* PRINT MESSAGE        M4506* 05980000
         BAL   R5,DPPWTO                                                05990000
         DS    0H                                                       06000000
*  GOTO DPPACK06;                                                       06010000
         BC    15,DPPACK06                                        0165  06020000
*                                                                       06030000
*  /******************************************************************* 06040000
*  /*                                                                 * 06050000
*  /*                    CONVERT SENSE & CSW INFO                     * 06060000
*  /*                                                                 * 06070000
*  /******************************************************************* 06080000
*  DPPACK06:                                                            06090000
*  GEN(BAL   R14,NEWCONV);               /* CONVERT CALL         M4506* 06100000
DPPACK06 BAL   R14,NEWCONV                                              06110000
         DS    0H                                                       06120000
*  SUSDEL='1'B;                          /* SUSPEND DELETION     M4506* 06130000
         OI    A00000,B'00001000'                                 0167  06140000
*  GEN(BAL   R14,NEWCONV);               /* CONVERT CALL         M4506* 06150000
         BAL   R14,NEWCONV                                              06160000
         DS    0H                                                       06170000
*  GOTO DPPACK03;                   /* GO PRINT SNS/CSW INFO          * 06180000
         BC    15,DPPACK03                                        0169  06190000
*                                                                       06200000
*                                                                       06210000
* /******************************************************************** 06220000
* /*                                                                  * 06230000
* /*                       PRINT MESSAGE IFD122I                S20203* 06240000
* /*                                                                  * 06250000
* /******************************************************************** 06260000
*                                                                       06270000
* DPPACK11:                              /*                     S20203* 06280000
* R1=MSG8;                          /* PTR TO MSG               S20203* 06290000
DPPACK11 L     @1,32(0,@4)                                        0170  06300000
* MSGDVAD4=DEVADEB;                 /* PUT DEV ADDR IN MSG 8    S20203* 06310000
         MVC   19(8,@1),0(@7)                                     0171  06320000
*  GEN(BAL   R5,DPPWTO);                 /* PRINT MESSAGE        M4506* 06330000
         BAL   R5,DPPWTO                                                06340000
         DS    0H                                                       06350000
*                                                                       06360000
*                                                                       06370000
* /******************************************************************** 06380000
* /*                                                                  * 06390000
* /*                       PRINT MESSAGE IFD139D                S20203* 06400000
* /*                                                                  * 06410000
* /******************************************************************** 06420000
*                                                                       06430000
* R1=MSG7;                          /* POINTER TO MESSAGE       S20203* 06440000
         L     @1,28(0,@4)                                        0173  06450000
* BUFAD=ADDR(BUFFER);               /* SET UP BUFFER ADDR       S20203* 06460000
         LA    @F,BUFFER                                          0174  06470000
         ST    @F,@TEMP4                                          0174  06480000
         MVC   1(3,@1),@TEMP4+1                                   0174  06490000
* MSGECBAD=ADDR(DECB);                   /* POINTER TO PWTOR ECBS20203* 06500000
         LA    @F,DECB                                            0175  06510000
         ST    @F,4(0,@1)                                         0175  06520000
* LENGTH='01'X;                     /* LENGTH OF RESPONSE       S20203* 06530000
         MVI   0(@1),X'01'                                        0176  06540000
* DECB=0;                           /* CLEAR ECB                S20203* 06550000
         SR    @F,@F                                              0177  06560000
         ST    @F,DECB                                            0177  06570000
*  GEN(BAL   R5,DPPWTOR);                /* PRINT AND REPLY      M4506* 06580000
         BAL   R5,DPPWTOR                                               06590000
         DS    0H                                                       06600000
* IF BUFFER='B' THEN                /* BYPASS X                 S20203* 06610000
         CLI   BUFFER,C'B'                                        0179  06620000
*         GOTO DPPACK07;                 /*                     S20203* 06630000
         BC    08,DPPACK07                                        0180  06640000
* IF BUFFER='R' THEN                /* RETRY ?                  S20203* 06650000
         CLI   BUFFER,C'R'                                        0181  06660000
*         GOTO DPPACK00;                 /*                     S20203* 06670000
         BC    08,DPPACK00                                        0182  06680000
* ELSE    GOTO DPPACK11;            /* REPLY NOT RECOGNIZED  TRY AGAIN* 06690000
         BC    15,DPPACK11                                        0183  06700000
*                                        /*                     S20203* 06710000
*                                                                       06720000
* DPPWTO:                                                               06730000
*  GEN(PWTO  REG=(1));                   /* ISSUE WTO            M4506* 06740000
DPPWTO   PWTO  REG=(1)                                                  06750000
         DS    0H                                                       06760000
*  GOTO R5;                              /* RETURN               M4506* 06770000
         BCR   15,@5                                              0185  06780000
* DPPWTOR:                                                              06790000
*  GEN(PWTOR REG=(1));                   /* ISSUE WTOR           M4506* 06800000
DPPWTOR  PWTOR REG=(1)                                                  06810000
         DS    0H                                                       06820000
*  GOTO R5;                              /* RETURN               M4506* 06830000
         BCR   15,@5                                              0187  06840000
* IORTN:                                                                06850000
*  FILMSK='1'B;                          /* ALLOW MODE SET       M4506* 06860000
IORTN    OI    A00010+1,B'00001000'                               0188  06870000
*  PROTECT='1'B;                         /* FILE PROTECT MODE    M4506* 06880000
         OI    A00010,B'01000000'                                 0189  06890000
*         FLGB   = '00'X;               /* ZERO OUT FLGS        Y02906* 06900000
         MVI   FLGB,X'00'                                         0190  06910000
*         CLRTECB = CLRTECB && CLRTECB; /* CLEAR TECB           Y02906* 06920000
         XC    TECB+6(39),TECB+6                                  0191  06930000
*         DVTPTR = R7;                  /* SET DEVTAB ADDR      Y02906* 06940000
         ST    @7,DVTPTR                                          0192  06950000
*         FLGA   = '00'X;               /* ZERO OUT FLGS        Y02906* 06960000
         MVI   FLGA,X'00'                                         0193  06970000
*         INTCALL = '1'B;               /* SET INTERNAL CALL SW Y02906* 06980000
         OI    FLG2,B'10000000'                                   0194  06990000
*         BYPASS = '1'B;                 /* SET BYPASS PREFIX SWY02906* 07000000
         OI    FLG1A,B'10000000'                                  0195  07010000
*         SNSCNT = '18'X;                /* SET SENSE COUNT     Y02906* 07020000
         MVI   SNSCNT,X'18'                                       0196  07030000
*         TECBPTRX = ADDR(TECB);         /* SET ADDR TECB       Y02906* 07040000
         LA    @F,TECB                                            0197  07050000
         ST    @F,TECBPTRX                                        0197  07060000
*         CDSPTR = ADDR(ADRHEX);        /* SET ADDR OF CDS DEV  Y02906* 07070000
         LA    @F,32(0,@7)                                        0198  07080000
         ST    @F,WAITLST+8                                       0198  07090000
*         R15    = IORTNADR;            /* GET TO EFFECTOR ADDR Y02906* 07100000
         L     @F,IORTNADR                                        0199  07110000
*         GEN(BALR R14,R15);            /*                      Y02906* 07120000
         BALR R14,R15                                                   07130000
         DS    0H                                                       07140000
*         R1 = ADDR(WAITLST);           /* GET POINTER FOR WAIT Y02906* 07150000
         LA    @1,WAITLST                                         0201  07160000
*         R14 = ADDR(STATS);            /* GET WAIT RETURNADDR  Y02906* 07170000
         LA    @E,STATS                                           0202  07180000
*         R15 = TAB28;                   /* GET TRANS MGR ENTRY Y02906* 07190000
         L     @F,TAB28                                           0203  07200000
*         GO TO R15;                    /* GO TO THE WAIT MOD   Y02906* 07210000
         BCR   15,@F                                              0204  07220000
*       STATS:                          /* WAIT RETURN POINT    Y02906* 07230000
*  PROTECT='0'B;                         /* CLEAR BIT            M4506* 07240000
STATS    NI    A00010,B'10111111'                                 0205  07250000
*  IF EXIOK^='0C'X THEN                  /* CHECK EXIO           M4506* 07260000
         CLI   TECB+16,X'0C'                                      0206  07270000
*    GOTO DPPACK02;                                                     07280000
         BC    07,DPPACK02                                        0207  07290000
*  GOTO R5;                              /* RETURN FROM ROUTINE  M4506* 07300000
         BCR   15,@5                                              0208  07310000
* NEWCONV:                                                              07320000
*  R1=ADDR(CNVRT);                       /* CONVERT PARAMETER    M4506* 07330000
NEWCONV  LA    @1,CNVRT                                           0209  07340000
*  R15=TAB28;                            /* TRANSIENT MANAGER    M4506* 07350000
         L     @F,TAB28                                           0210  07360000
*  GOTO R15;                             /* CALL CONVERT         M4506* 07370000
         BCR   15,@F                                              0211  07380000
*                                                                       07390000
*  DPPACK08:                                                            07400000
*  RETURN;                          /* RETURN TO CALLING MODULE       * 07410000
*         END;                                                          07420000
@EL01    L     @D,4(0,@D)                                         0213  07430000
         LM    @E,@C,12(@D)                                       0213  07440000
         BCR   15,@E                                              0213  07450000
@DATA1   EQU   *                                                        07460000
@0       EQU   00                  EQUATES FOR REGISTERS 0-15           07470000
@1       EQU   01                                                       07480000
@2       EQU   02                                                       07490000
@3       EQU   03                                                       07500000
@4       EQU   04                                                       07510000
@5       EQU   05                                                       07520000
@6       EQU   06                                                       07530000
@7       EQU   07                                                       07540000
@8       EQU   08                                                       07550000
@9       EQU   09                                                       07560000
@A       EQU   10                                                       07570000
@B       EQU   11                                                       07580000
@C       EQU   12                                                       07590000
@D       EQU   13                                                       07600000
@E       EQU   14                                                       07610000
@F       EQU   15                                                       07620000
         DS    0F                                                       07630000
@C5      DC    C'VOL1'                                                  07640000
@C9      DC    C'CEPACK'                                                07650000
@C4      DC    C'F0FE-'                                                 07660000
         DS    0D                                                       07670000
@DATA    EQU   *                                                        07680000
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD                   07690000
Y        EQU   00000000            FULLWORD INTEGER                     07700000
R0       EQU   00000000            FULLWORD POINTER REGISTER            07710000
R1       EQU   00000001            FULLWORD POINTER REGISTER            07720000
R2       EQU   00000002            FULLWORD POINTER REGISTER            07730000
R3       EQU   00000003            FULLWORD POINTER REGISTER            07740000
R4       EQU   00000004            FULLWORD POINTER REGISTER            07750000
R5       EQU   00000005            FULLWORD POINTER REGISTER            07760000
R6       EQU   00000006            FULLWORD POINTER REGISTER            07770000
R7       EQU   00000007            FULLWORD POINTER REGISTER            07780000
R8       EQU   00000008            FULLWORD POINTER REGISTER            07790000
R9       EQU   00000009            FULLWORD POINTER REGISTER            07800000
R10      EQU   00000010            FULLWORD POINTER REGISTER            07810000
R11      EQU   00000011            FULLWORD POINTER REGISTER            07820000
R12      EQU   00000012            FULLWORD POINTER REGISTER            07830000
R13      EQU   00000013            FULLWORD POINTER REGISTER            07840000
R14      EQU   00000014            FULLWORD POINTER REGISTER            07850000
R15      EQU   00000015            FULLWORD POINTER REGISTER            07860000
I        EQU   @DATA+00000072      FULLWORD INTEGER                     07870000
A00028   EQU   00000000            52 BYTE(S) ON WORD                   07880000
DEVADEB  EQU   A00028+00000000     8 BYTE(S)                            07890000
UCBAD    EQU   A00028+00000008     FULLWORD POINTER                     07900000
DEVFLG1  EQU   A00028+00000012     1 BYTE(S)                            07910000
STATUS   EQU   A00028+00000012     1 BIT(S)                             07920000
PRIMARY  EQU   A00028+00000012     1 BIT(S)                             07930000
DPDONE   EQU   A00028+00000012     1 BIT(S)                             07940000
A00029   EQU   A00028+00000012     3 BIT(S)                             07950000
FILEPROT EQU   A00028+00000012     1 BIT(S)                             07960000
A00030   EQU   A00028+00000012     1 BIT(S)                             07970000
DEVFLG2  EQU   A00028+00000013     1 BYTE(S)                            07980000
A00031   EQU   A00028+00000013     2 BIT(S)                             07990000
CEVOL    EQU   A00028+00000013     1 BIT(S)                             08000000
STDLABL  EQU   A00028+00000013     1 BIT(S)                             08010000
A00032   EQU   A00028+00000013     4 BIT(S)                             08020000
DEVFLG3  EQU   A00028+00000014     1 BYTE(S)                            08030000
DEVFLG4  EQU   A00028+00000015     1 BYTE(S)                            08040000
TAPELABL EQU   A00028+00000016     16 BYTE(S)                           08050000
VOL      EQU   A00028+00000016     10 BYTE(S)                           08060000
HDR      EQU   A00028+00000026     4 BYTE(S)                            08070000
MODESV   EQU   A00028+00000030     1 BYTE(S)                            08080000
A00033   EQU   A00028+00000031     1 BYTE(S)                            08090000
ADRHEX   EQU   A00028+00000032     4 BYTE(S)                            08100000
A00034   EQU   A00028+00000032     2 BYTE(S)                            08110000
HEXAD    EQU   A00028+00000034     2 BYTE(S)                            08120000
CDSINFOR EQU   A00028+00000036     16 BYTE(S)                           08130000
FEATURES EQU   A00028+00000036     1 BYTE(S)                            08140000
MODEL    EQU   A00028+00000037     1 BYTE(S)                            08150000
CLASS    EQU   A00028+00000038     1 BYTE(S)                            08160000
TYPE     EQU   A00028+00000039     1 BYTE(S)                            08170000
A00035   EQU   A00028+00000040     1 BYTE(S)                            08180000
CDSFLAGS EQU   A00028+00000041     1 BYTE(S)                            08190000
DVCDSFPM EQU   A00028+00000041     1 BIT(S)                             08200000
A00036   EQU   A00028+00000041     1 BIT(S)                             08210000
DVCDSCEV EQU   A00028+00000041     1 BIT(S)                             08220000
A00037   EQU   A00028+00000041     5 BIT(S)                             08230000
WAITLST  EQU   @DATA+00000076      16 BYTE(S) ON WORD                   08240000
         ORG   WAITLST+00000000                                         08250000
XMGR     EQU   *                   1 BYTE(S)                            08260000
         DC    X'00'                                                    08270000
LVL      EQU   *                   1 BYTE(S)                            08280000
         DC    X'02'                                                    08290000
MODID    EQU   *                   2 BYTE(S)                            08300000
         DC    C'36'                                                    08310000
TECBPTR  EQU   *                   FULLWORD POINTER                     08320000
         DC    AL4(TECB)                                                08330000
CDSPTR   EQU   *                   FULLWORD POINTER                     08340000
         DC    AL4(0)                                                   08350000
FLG      EQU   *                   8 BIT(S) ON BYTE                     08360000
         DC    X'80'                                                    08370000
WAITYES  EQU   WAITLST+00000012    1 BIT(S)                             08380000
TIME     EQU   *                   2 BYTE(S)                            08390000
         DC    X'001E'                                                  08400000
TECB     EQU   @DATA+00000092      45 BYTE(S) ON WORD                   08410000
         ORG   TECB+00000000                                            08420000
FLDCNT   EQU   *                   1 BYTE(S)                            08430000
         DC    X'01'                                                    08440000
FLDSIZE  EQU   *                   1 BYTE(S)                            08450000
         DC    X'0C'                                                    08460000
SOMETNG  EQU   *                   1 BYTE(S)                            08470000
         DC    X'00'                                                    08480000
SNSSIZE  EQU   *                   1 BYTE(S)                            08490000
         DC    X'18'                                                    08500000
FLG1     EQU   *                   1 BYTE(S)                            08510000
         DC    X'00'                                                    08520000
SNSCNTTB EQU   *                   1 BYTE(S)                            08530000
         DC    X'01'                                                    08540000
CLRTECB  EQU   TECB+00000006       39 BYTE(S)                           08550000
CNTSNS   EQU   *                   1 BYTE(S)                            08560000
         DC    X'00'                                                    08570000
CNTINT   EQU   *                   1 BYTE(S)                            08580000
         DC    X'00'                                                    08590000
CCP      EQU   TECB+00000008       1 BYTE(S)                            08600000
A00038   EQU   TECB+00000009       3 BYTE(S)                            08610000
CSW1     EQU   TECB+00000012       8 BYTE(S)                            08620000
A00039   EQU   TECB+00000012       4 BYTE(S)                            08630000
STATUSX  EQU   TECB+00000016       2 BYTE(S)                            08640000
EXIOK    EQU   TECB+00000016       1 BYTE(S)                            08650000
A00040   EQU   TECB+00000016       6 BIT(S)                             08660000
UNITCK   EQU   TECB+00000016       1 BIT(S)                             08670000
UNITEXCP EQU   TECB+00000016       1 BIT(S)                             08680000
BYTE2    EQU   TECB+00000017       1 BYTE(S)                            08690000
A00041   EQU   TECB+00000017       1 BIT(S)                             08700000
INLENGTH EQU   TECB+00000017       1 BIT(S)                             08710000
A00042   EQU   TECB+00000017       6 BIT(S)                             08720000
A00043   EQU   TECB+00000018       2 BYTE(S)                            08730000
SENSE    EQU   TECB+00000020       24 BYTE(S)                           08740000
A00044   EQU   TECB+00000020       3 BYTE(S)                            08750000
SNS1     EQU   TECB+00000023       7 BYTE(S)                            08760000
SNSFLD   EQU   TECB+00000023       8 BIT(S)                             08770000
A00045   EQU   TECB+00000023       1 BIT(S)                             08780000
SNS2     EQU   TECB+00000023       1 BIT(S)                             08790000
A00046   EQU   TECB+00000024       2 BYTE(S)                            08800000
A00047   EQU   TECB+00000026       8 BIT(S)                             08810000
A00048   EQU   TECB+00000026       5 BIT(S)                             08820000
PEIND    EQU   TECB+00000026       1 BIT(S)                             08830000
A00049   EQU   TECB+00000027       2 BYTE(S)                            08840000
A00050   EQU   TECB+00000029       1 BYTE(S)                            08850000
A00051   EQU   TECB+00000029       4 BIT(S)                             08860000
BIT4     EQU   TECB+00000029       1 BIT(S)                             08870000
BUF      EQU   @DATA+00000137      20 BYTE(S)                           08880000
STLAB    EQU   BUF+00000000        4 BYTE(S)                            08890000
CEVOL1   EQU   BUF+00000004        6 BYTE(S)                            08900000
SECBYT   EQU   BUF+00000010        1 BYTE(S)                            08910000
A00052   EQU   BUF+00000011        9 BYTE(S)                            08920000
BUF1     EQU   @DATA+00000157      5 BYTE(S)                            08930000
A00053   EQU   BUF1+00000000       8 BIT(S)                             08940000
A00054   EQU   BUF1+00000000       5 BIT(S)                             08950000
MERLIN   EQU   BUF1+00000000       1 BIT(S)                             08960000
A00055   EQU   BUF1+00000000       2 BIT(S)                             08970000
A00056   EQU   BUF1+00000001       4 BYTE(S)                            08980000
BUF2     EQU   @DATA+00000162      20 BYTE(S)                           08990000
A00057   EQU   BUF2+00000000       14 BYTE(S)                           09000000
CEF0FE   EQU   BUF2+00000014       5 BYTE(S)                            09010000
A00058   EQU   BUF2+00000019       1 BYTE(S)                            09020000
         ORG   @DATA+00000184                                           09030000
MSGPTR   EQU   *                   FULLWORD POINTER                     09040000
         DC    VL4(IFDMSG07)                                            09050000
A00059   EQU   00000000            36 BYTE(S) ON WORD                   09060000
MSG1     EQU   A00059+00000000     FULLWORD POINTER                     09070000
MSG2     EQU   A00059+00000004     FULLWORD POINTER                     09080000
MSG2A    EQU   A00059+00000008     FULLWORD POINTER                     09090000
MSG3     EQU   A00059+00000012     FULLWORD POINTER                     09100000
MSG4     EQU   A00059+00000016     FULLWORD POINTER                     09110000
MSG5     EQU   A00059+00000020     FULLWORD POINTER                     09120000
MSG6     EQU   A00059+00000024     FULLWORD POINTER                     09130000
MSG7     EQU   A00059+00000028     FULLWORD POINTER                     09140000
MSG8     EQU   A00059+00000032     FULLWORD POINTER                     09150000
MSGDVAD  EQU   00000016            8 BYTE(S)                            09160000
MSGDVAD1 EQU   00000026            8 BYTE(S)                            09170000
MSGVOLID EQU   00000042            6 BYTE(S)                            09180000
MSGDVAD2 EQU   00000032            8 BYTE(S)                            09190000
MSGDVAD3 EQU   00000029            8 BYTE(S)                            09200000
MSGDVAD4 EQU   00000019            8 BYTE(S)                            09210000
MSGCSW   EQU   00000018            14 BYTE(S)                           09220000
MSGSNS   EQU   00000037            12 BYTE(S)                           09230000
SIX      EQU   *                   2 BYTE(S)                            09240000
         DC    X'0006'                                                  09250000
MSGPARM  EQU   00000000            8 BYTE(S) ON WORD                    09260000
LENGTH   EQU   MSGPARM+00000000    1 BYTE(S)                            09270000
BUFAD    EQU   MSGPARM+00000001    3  BYTE  POINTER ON WORD+1           09280000
MSGECBAD EQU   MSGPARM+00000004    FULLWORD INTEGER                     09290000
         ORG   @DATA+00000192                                           09300000
DECB     EQU   *                   FULLWORD INTEGER                     09310000
         DC    FL4'0'                                                   09320000
INBUF    EQU   @DATA+00000196      62 BYTE(S)                           09330000
CSWIN    EQU   INBUF+00000000      14 BYTE(S)                           09340000
A00060   EQU   INBUF+00000014      6 BYTE(S)                            09350000
SNSIN    EQU   INBUF+00000020      48 BYTE(S)                           09360000
         ORG   @DATA+00000264                                           09370000
SEEKVOL  EQU   *                   7 BYTE(S)                            09380000
         DC    X'00000000000003'                                        09390000
SEEKF0FE EQU   *                   6 BYTE(S)                            09400000
         DC    X'000000060000'                                          09410000
SEEKMERL EQU   *                   6 BYTE(S)                            09420000
         DC    X'000000000000'                                          09430000
         ORG   @DATA                                                    09440000
         DS    00000288C                                                09450000
@TEMPS   DS    0F                                                       09460000
@TEMP4   DC    F'0'                                                     09470000
*                                                                     * 09480000
*                                 CCW LIST                            * 09490000
*                                                                     * 09500000
*              SEEK LABEL  ON VOL1 PACK                               * 09510000
LABEL0   DS    0D                                                S20203 09520000
         CCW   07,SEEKVOL,X'60',6       SEEK LABEL               S20203 09530000
         CCW   49,SEEKVOL+2,X'60',5     SEARCH FOR VOL1 ON LABEL S20203 09540000
         CCW   08,*-8,X'60',1           TIC                      S20203 09550000
         CCW   06,BUF,X'60',20          GET VOL1&SEC DATA        S20203 09560000
         CCW   04,*,X'30',1      FORCE CHAN END DEV END, NO DATA TRANS  09570000
*                                                                     * 09580000
*              SEEK FOR DATA ON FOFE PACK                             * 09590000
LABEL1   DS    0D                                                S20203 09600000
         CCW   07,SEEKF0FE,X'60',6      SEEK FOR F0FE            S20203 09610000
         CCW   22,BUF2,X'60',20         GET F0FE DATA R0+14      S20203 09620000
         CCW   04,*,X'30',1      FORCE CHAN END DEV END, NO DATA TRANS  09630000
*                                                                     * 09640000
*              SEEK AND READ HOME ADDRESS  ON MERLIN DEVICE           * 09650000
LABEL2   DS    0D                                                S20203 09660000
         CCW   07,SEEKMERL,X'60',6   SEEK                        S20203 09670000
         CCW   26,BUF1,X'60',5      READ HOME ADDR               S20203 09680000
         CCW   04,*,X'30',1      FORCE CHAN END DEV END, NO DATA TRANS  09690000
*                                                                     * 09700000
*              PARAMETER LIST FOR CONVERT MODULE                      * 09710000
CNVRT    DC    B'00000000'         CONTROL PROGRAM FLAGS                09720000
         DC    AL1(2)              MACRO LEVEL                          09730000
         DC    CL2'41'             MACRO ID                             09740000
         DC    A(CSW1+1)                                                09750000
         DC    A(INBUF)                                                 09760000
         DC    AL2(31+32768)            COUNT AND TYPE           S20203 09770000
DSECTAA  IFDCOM                                                         09780000
A00000   EQU   CESWT3+00000000     1 BYTE(S)                            09790000
A00001   EQU   A00000+00000000     3 BIT(S)                             09800000
GRBCTL   EQU   A00000+00000000     1 BIT(S)                             09810000
SUSDEL   EQU   A00000+00000000     1 BIT(S)                             09820000
A00002   EQU   A00000+00000000     1 BIT(S)                             09830000
A00003   EQU   OLTTAB+00000000     8 BYTE(S) ON WORD                    09840000
OLTTAB1  EQU   A00003+00000000     FULLWORD POINTER                     09850000
OLTTAB2  EQU   A00003+00000004     FULLWORD POINTER                     09860000
A00004   EQU   A00003+00000004     FULLWORD POINTER                     09870000
A00005   EQU   CHASCT+00000010     1 BYTE(S)                            09880000
A00006   EQU   A00005+00000000     1 BIT(S)                             09890000
FPM      EQU   A00005+00000000     1 BIT(S)                             09900000
A00007   EQU   CHASCT+00000011     1 BYTE(S)                            09910000
CDSFPM   EQU   A00007+00000000     1 BIT(S)                             09920000
A00008   EQU   A00007+00000000     1 BIT(S)                             09930000
CDSCEVOL EQU   A00007+00000000     1 BIT(S)                             09940000
A00009   EQU   A00007+00000000     5 BIT(S)                             09950000
A00010   EQU   CESWT+00000000      4 BYTE(S) ON WORD                    09960000
A00011   EQU   A00010+00000000     8 BIT(S)                             09970000
A00012   EQU   A00010+00000000     1 BIT(S)                             09980000
PROTECT  EQU   A00010+00000000     1 BIT(S)                             09990000
A00013   EQU   A00010+00000000     6 BIT(S)                             10000000
A00014   EQU   A00010+00000001     8 BIT(S)                             10010000
A00015   EQU   A00010+00000001     4 BIT(S)                             10020000
FILMSK   EQU   A00010+00000001     1 BIT(S)                             10030000
A00016   EQU   A00010+00000001     1 BIT(S)                             10040000
ONLINEOK EQU   A00010+00000001     1 BIT(S)                             10050000
A00017   EQU   A00010+00000001     1 BIT(S)                             10060000
A00018   EQU   A00010+00000002     8 BIT(S)                             10070000
NDCFO    EQU   A00010+00000002     1 BIT(S)                             10080000
DPONDEV  EQU   A00010+00000002     1 BIT(S)                             10090000
A00019   EQU   A00010+00000002     1 BIT(S)                             10100000
CHANTEST EQU   A00010+00000002     1 BIT(S)                             10110000
A00020   EQU   A00010+00000002     1 BIT(S)                             10120000
A00021   EQU   A00010+00000002     1 BIT(S)                             10130000
TAPEHDR  EQU   A00010+00000002     1 BIT(S)                             10140000
AMERLDV  EQU   A00010+00000002     1 BIT(S)                             10150000
A00022   EQU   A00010+00000003     8 BIT(S)                             10160000
A00023   EQU   A00010+00000003     1 BIT(S)                             10170000
NURUN    EQU   A00010+00000003     1 BIT(S)                             10180000
BYPDEV   EQU   A00010+00000003     1 BIT(S)                             10190000
A00024   EQU   A00010+00000003     1 BIT(S)                             10200000
A00025   EQU   A00010+00000003     1 BIT(S)                             10210000
A00026   EQU   A00010+00000003     1 BIT(S)                             10220000
A00027   EQU   A00010+00000003     1 BIT(S)                             10230000
STDLAB   EQU   A00010+00000003     1 BIT(S)                             10240000
FLG1A    EQU   FLGA+00000000       8 BIT(S) ON BYTE                     10250000
BYPASS   EQU   FLG1A+00000000      1 BIT(S)                             10260000
FLG2     EQU   FLGB+00000000       8 BIT(S) ON BYTE                     10270000
INTCALL  EQU   FLG2+00000000       1 BIT(S)                             10280000
MODEREQ  EQU   FLG2+00000000       1 BIT(S)                             10290000
BUFFER   EQU   INBUFR+00000000     1 BYTE(S)                            10300000
@DATEND  EQU   *                                                        10310000
@9FE     EQU   DPPACK14                                                 10320000
@9FA     EQU   DPPACK11                                                 10330000
DPPACK08 EQU   @EL01                                                    10340000
@9F7     EQU   DPPACK08                                                 10350000
         END                                                            10360000
