         TITLE 'IFDOLT22 ALLOCATE MODULE'                               00010000
         TITLE 'IFDOLT22 ALLOCATE MODULE'                               00020000
         PRINT OFF                                                      00030000
         MACRO                                                          00040000
&NAME   ALOCAT &CDSADR=0,&TYPE=,&SCRATCH=,&MF=,&MAP=NO,&LSTNAME=        00050000
.*                                                                      00060000
         GBLB  &EXECUTV,&E536454                                        00070000
         LCLA  &A,&B,&COUNT                                             00080000
         LCLB  &SWITCH,&B1,&B2,&B3                                      00090000
         LCLC  &F,&Z,&CHAR                                              00100000
.*                                                                      00110000
         AIF   ('&MAP' EQ 'YES').MAP1                                   00120000
         AIF   (T'&MF EQ 'O').STD                                       00130000
         AIF   ('&MF' EQ 'L' OR '&MF' EQ 'S').STD                       00140000
         AIF   ('&MF'(1,3) NE '(E,').MFERROR                            00150000
&CHAR    SETC  '&NAME'                                                  00160000
         AIF   ('&MF'(4,3) EQ '(1)').RG1                                00170000
         AIF   ('&MF'(4,1) EQ '(').RG2                                  00180000
&CHAR    LA    R1,&MF(2) .         ADDRESS OF PARAMETER LIST            00190000
&CHAR    SETC  ' '                                                      00200000
         AGO   .RG1                                                     00210000
.RG2     ANOP                                                           00220000
&COUNT   SETA  K'&MF(2)-2                                               00230000
&F       SETC  '&MF(2)'(2,&COUNT)                                       00240000
         AIF   ('&F'(1,1) EQ 'R').C724                                  00250000
&CHAR    LR    R1,R&F .            ADDRESS OF PARAMETER LIST            00260000
&CHAR    SETC  ' '                                                      00270000
         AGO   .RG1                                                     00280000
.C724    ANOP                                                           00290000
&CHAR    LR    R1,&F .             ADDRESS OF PARAMETER LIST            00300000
&CHAR    SETC  ' '                                                      00310000
.RG1     ANOP                                                           00320000
&CHAR    BAL   R14,#EXIT .        BRANCH TO LINKAGE SUBROUTINE          00330000
         MEXIT                                                          00340000
.MFERROR MNOTE 8,'MF VALUE (&MF) INCORRECT, NO STATEMENTS GENERATED.'   00350000
         MEXIT                                                          00360000
.STD     ANOP                                                           00370000
&B1      SETB  (N'&TYPE GT 0)                                           00380000
&B2      SETB  (T'&SCRATCH NE 'O')                                      00390000
         AIF   (&B1+&B2 EQ 2).ERR                                       00400000
         AIF   (&B1).ALO                                                00410000
         AIF   (&B2).ALO2                                               00420000
         AGO   .ALO3                                                    00430000
.ALO     ANOP                                                           00440000
         AIF   (N'&TYPE NE 3).ERR1                                      00450000
&A       SETA  1                                                        00460000
.TST1    ANOP                                                           00470000
         AIF   (K'&TYPE(2) EQ 0).ERR2                                   00480000
.TST2    ANOP                                                           00490000
         AIF   (K'&TYPE(3) EQ 0).ERR3                                   00500000
         AIF   (&B3).EXIT                                               00510000
         AIF   ('&TYPE(1)' NE 'CYL').ALO1                               00520000
&B       SETA  200                                                      00530000
         AGO   .ALO3                                                    00540000
.ALO1    ANOP                                                           00550000
         AIF   (K'&TYPE(1) EQ 0 OR '&TYPE(1)' EQ 'TRK').ALO1A           00560000
         MNOTE 8,'TYPE= PARAMETER INCORRECTLY SPECIFIED.'               00570000
&B3      SETB  1                                                        00580000
.ALO1A   ANOP                                                           00590000
&B       SETA  136                                                      00600000
         AGO   .ALO3                                                    00610000
.ALO2    ANOP                                                           00620000
&A       SETA  2                                                        00630000
.ALO3    ANOP                                                           00640000
         AIF   ('&MF' EQ 'L').LIST                                      00650000
&NAME    LA    R14,R&SYSNDX .     RETURN ADDRESS                        00660000
         CNOP  0,4                                                      00670000
         BAL   R1,#EXIT .          BRANCH TO LINKAGE SUBROUTINE         00680000
&CHAR    SETC  '&LSTNAME'                                               00690000
         AGO   .STD1                                                    00700000
.LIST    ANOP                                                           00710000
&CHAR    SETC  '&NAME'                                                  00720000
.STD1    ANOP                                                           00730000
         AIF   (&EXECUTV).OLTSEP                                        00740000
&CHAR    DC    B'00000000' .       CONTROL PROGRAM FLAGS                00750000
         AGO   .OLTSEP1                                                 00760000
.OLTSEP  ANOP                                                           00770000
&CHAR    DC    B'00000001' .       CONTROL PROGRAM FLAGS                00780000
.OLTSEP1 ANOP                                                           00790000
         DC    AL1(2) .            MACRO LEVEL                          00800000
         DC    CL2'22' .           MACRO ID                             00810000
         DC    A(&CDSADR) .        ADDRESS OF CDS INFO                  00820000
         AIF   (&B1).ALO4                                               00830000
         DC    A(0) .              ADDRESS OF EXTENTS                   00840000
         AGO   .ALO5                                                    00850000
.ALO4    ANOP                                                           00860000
         DC    A(&TYPE(3)) .       ADDRESS OF EXTENTS                   00870000
.ALO5    ANOP                                                           00880000
         AIF   (&B1).ALO6                                               00890000
         DC    AL3(0)              AMOUNT OF SPACE REQUIRED             00900000
         AGO   .ALO7                                                    00910000
.ALO6    ANOP                                                           00920000
         DC    AL3(&TYPE(2)) .     AMOUNT OF SPACE REQUIRED             00930000
.ALO7    ANOP                                                           00940000
         DC    AL1(&B) .           TYPE                                 00950000
*                                                                       00960000
*                                  TYPE FLAGS DEFINITION:               00970000
*                                  200  CYL                             00980000
*                                  136  TRK                             00990000
*                                                                       01000000
         DC    AL1(&A) .           FUNCTION FLAGS                       01010000
*                                                                       01020000
*                                  FUNCTION FLAGS DEFINITION:           01030000
*                                  0  DEMOUNTABLE ALLOCATION            01040000
*                                  1  ALLOCATE                          01050000
*                                  2  SCRATCH                           01060000
         AIF   ('&MF' EQ 'L').EXIT                                      01070000
R&SYSNDX DS    0H .                RETURN ON HALFWORD BOUNDARY          01080000
         AGO   .EXIT                                                    01090000
.ERR     MNOTE 8,'TYPE= AND SCRATCH= MAY NOT BE USED TOGETHER.'         01100000
&B3      SETB  1                                                        01110000
         AGO   .ALO                                                     01120000
.ERR1    MNOTE 8,'TYPE= PARAMETER INCORRECTLY SPECIFIED.'               01130000
&B3      SETB  1                                                        01140000
         AGO   .TST1                                                    01150000
.ERR2    MNOTE 8,'AMOUNT MUST BE SPECIFIED WHEN USING TYPE=.'           01160000
&B3      SETB  1                                                        01170000
         AGO   .TST2                                                    01180000
.ERR3    MNOTE 8,'EXTENT ADDRESS MUST BE SPECIFIED WHEN USING TYPE=.'   01190000
         MEXIT                                                          01200000
.MAP1    ANOP                                                           01210000
ALOMAP   DSECT                                                          01220000
&Z       SETC  '$'                                                      01230000
         AIF   (&E536454).ZIPPER                                        01240000
         DC    XL1'0' .            CONTROL PROGRAM FLAGS                01250000
         DC    XL1'0' .            MACROL LEVEL                         01260000
         DC    XL2'0' .            MACROL ID                            01270000
         AGO   .ZIPPED                                                  01280000
.ZIPPER  ANOP                                                           01290000
&Z.ALTORMG DC  XL1'0' .            CONTROL PROGRAM FLAGS                01300000
&Z.ALOLEVL DC  XL1'0' .            MACRO LEVEL                          01310000
&Z.ALOIDNT DC  XL2'0' .            MACRO ID                             01320000
.ZIPPED  ANOP                                                           01330000
&Z.ALOCDSA DC  A(0) .              ADDRESS OF CDS INFO                  01340000
&Z.ALOCADR DC  A(0) .              ADDRESS OF EXTENTS                   01350000
&Z.ALOAMT  DC  XL3'0' .            AMOUNT OF SPACE REQUIRED             01360000
&Z.ALOFLGT DC  XL1'0' .            TYPE                                 01370000
&Z.ALOFLAG DC  XL1'0' .            FUNCTION FLAGS                       01380000
.EXIT    MEND                                                           01390000
         EJECT                                                          01400000
         PRINT ON                                                       01410000
         LCLA  &T,&SPN                                            0003  01420000
.@001    ANOP                                                     0003  01430000
IFDOLT22 CSECT ,                                                  0003  01440000
         BC    15,24(0,@F)                                              01450000
         DC    C'IFDOLT22 29 MAR 74'                             0003  01460000
         ST    @E,12(0,@D)                                        0003  01470000
         STM   @0,@C,20(@D)                                       0003  01480000
         BALR  @B,0                                               0003  01490000
@PSTART  DS    0H                                                 0003  01500000
         USING @PSTART+00000,@B                                   0003  01510000
         ST    @D,@SAV001+4                                       0003  01520000
         LA    @F,@SAV001                                         0003  01530000
         ST    @F,8(0,@D)                                         0003  01540000
         LR    @D,@F                                              0003  01550000
DIAG     EQU   59                                                       01560000
THREETWO EQU   32                                                       01570000
         USING ALOMAP,5                                                 01580000
         USING CHASCT,2                                                 01590000
         DS    0H                                                       01600000
*         R5=R1;                    /* SAVE REG. 1 IN REG. 5.         * 01610000
         LR    @5,@1                                              0073  01620000
*         R9=ADDR(IFDMSG22);        /* POINTER TO MESSAGE MODULE 21050* 01630000
         L     @C,@V1              ADDRESS OF IFDMSG22            0074  01640000
         LR    @9,@C                                              0074  01650000
*         R7=UNICTR;                /* GET NUMBER OF DEVICES UNDER TST* 01660000
         SR    @7,@7                                              0075  01670000
         IC    @7,UNICTR                                          0075  01680000
*         R3=DEVTBPTR;              /* INITIALIZE DEVTAB POINTER      * 01690000
         L     @3,DEVTBPTR                                        0076  01700000
*         ALOCATSW='00'X;           /* CLEAR IFDOLT22'S FLAGS AND     * 01710000
         MVI   ALOCATSW,X'00'                                     0077  01720000
*                                   /* DECODE PARAMETERS.             * 01730000
*         IF RETAINAC='1'B THEN          /* IS REI ACTIVE?      S20203* 01740000
         TM    A00019,B'10000000'                                 0078  01750000
         BC    12,@9FF                                            0078  01760000
*         DPMSGREI='1'B;                /* REM SITE GETS MSG    XM0097* 01770000
         OI    A00022,B'00000001'                                 0079  01780000
* ALOCAT05:                                                             01790000
*         IF STAEXIT='1'B THEN      /* IS STAE EXIT IN CONTROL.       * 01800000
@9FF     EQU   *                                                  0080  01810000
ALOCAT05 TM    OLTEPSW6,B'00000001'                               0080  01820000
         BC    12,@9FE                                            0080  01830000
*           DO;                     /* YES,                           * 01840000
*           IF NDR='1'B THEN        /* ARE THERE DEVICES ENTERED.     * 01850000
         TM    OLTEPSW2,B'00000100'                               0082  01860000
*             GO TO ALOCAT50;       /* NO, RETURN TO STAE EXIT ROUTINE* 01870000
         BC    01,ALOCAT50                                        0083  01880000
*           IF ALLOCATE='0'B THEN   /* WAS THIS DEVICE ALLOCATED.     * 01890000
         TM    12(@3),B'00001000'                                 0084  01900000
         BC    05,@9FD                                            0084  01910000
*             DO;                   /* NO,                            * 01920000
*             R7=R7-1;              /* DECREMENT NUMBER OF DEVICES.   * 01930000
         BCTR  @7,0                                               0086  01940000
*             R3=R3+56;             /* POINT TO NEXT DEVICE      21050* 01950000
         AH    @3,@D1                                             0087  01960000
*                                   /* IN TABLE.                 21050* 01970000
*             IF R7=0 THEN          /* ARE ALL DEVICES CHECKED.       * 01980000
         LTR   @7,@7                                              0088  01990000
*               GO TO ALOCAT50;     /* YES, RETURN TO STAE EXIT.      * 02000000
         BC    08,ALOCAT50                                        0089  02010000
*             GO TO ALOCAT05;       /* CHECK NEXT DEVICE.             * 02020000
         BC    15,ALOCAT05                                        0090  02030000
*             END;                                                      02040000
*             UNUNIT1(5:14)=DDNAME(ALCINDEX); /* PUT DDNAME     YM7637* 02050000
@9FD     SR    @C,@C                                              0092  02060000
         IC    @C,54(0,@3)                                        0092  02070000
         MH    @C,@D2                                             0092  02080000
         LA    @E,DDNAME-10(@C)                                   0092  02090000
         MVC   UNTUNIT+4(10),0(@E)                                0092  02100000
*                                        /* IN DYN UNALLOC PLISTYM7637* 02110000
*           GO TO ALOCAT10;         /* DEVICE WAS ALLOCATED.          * 02120000
         BC    15,ALOCAT10                                        0093  02130000
*           END;                                                        02140000
*         IF ALOLEVL^='02'X|        /* IS THIS MACRO LEVEL SUPPORTED. * 02150000
*           NDR='1'B THEN           /* NO, RETURN CODE 04. ARE DEVICES* 02160000
@9FE     CLI   ALOLEVL,X'02'                                      0095  02170000
         BC    07,@9FC                                            0095  02180000
         TM    OLTEPSW2,B'00000100'                               0095  02190000
         BC    12,@9FB                                            0095  02200000
*             GO TO ALOCAT52;       /* ENTERED. NO, RETURN CODE 04.   * 02210000
         BC    03,ALOCAT52                                        0096  02220000
*         IF ALOCDSA=0 THEN         /* FIND THE DEVICE ADDRESS THAT   * 02230000
@9FB     SR    @F,@F                                              0097  02240000
         C     @F,ALOCDSA                                         0097  02250000
         BC    07,@9FA                                            0097  02260000
*           DO;                     /* WANTS ALLOCATION.              * 02270000
*           R3=PRIDVPTR;            /* PRIMARY ALLOCATION, GET POINTER* 02280000
         L     @3,PRIDVPTR                                        0099  02290000
*           GO TO ALOCAT10;         /* FROM COMMON AREA.              * 02300000
         BC    15,ALOCAT10                                        0100  02310000
*           END;                                                        02320000
*         DO I=R7 TO 1 BY -1;       /* SECONDARY ALLOCATION, FIND21050* 02330000
@9FA     LR    @4,@7                                              0102  02340000
         LTR   @4,@4                                              0102  02350000
         BC    12,@DO9F8                                          0102  02360000
*         IF CDSDEVAD=DEVAD THEN    /* ENTRY IN DEVTABLE THAT MATCHES * 02370000
@DO9F9   L     @C,ALOCDSA                                         0103  02380000
         CLC   0(4,@C),32(@3)                                     0103  02390000
         BC    07,@9F5                                            0103  02400000
*           DO;                     /* DEVICE REQUESTING THE          * 02410000
*           IF GRABBED='1'B|        /* ALLOCATION. IS IT THE     21050* 02420000
*              PRIMARY='1'B THEN    /* RIGHT MATCH. YES,         21050* 02430000
         TM    12(@3),B'00000100'                                 0105  02440000
         BC    01,@9F4                                            0105  02450000
         TM    12(@3),B'01000000'                                 0105  02460000
         BC    12,@9F3                                            0105  02470000
*                GO TO ALOCAT10;    /* CONTINUE. NO, FIND RIGHT  21050* 02480000
         BC    03,ALOCAT10                                        0106  02490000
*           END;                    /* DEVICE.                   21050* 02500000
@9F3     EQU   *                                                  0107  02510000
*         R3=R3+56;                 /* CHECK NEXT DEVICE IN      21050* 02520000
@9F5     AH    @3,@D1                                             0108  02530000
*                                   /* DEVICE TABLE.             21050* 02540000
*         END;                                                          02550000
*         GO TO ALOCAT52;           /* RETURN CODE 04.                * 02560000
         BCT   @4,@DO9F9                                          0109  02570000
         BC    15,ALOCAT52                                        0110  02580000
* ALOCAT10:                                                             02590000
*         /************************************************************ 02600000
*         /*             ROUTINE TO CHECK DEVICE STATUS               * 02610000
*         /************************************************************ 02620000
*         R8=UCBPTR;                /* GET POINTER TO UCB.       21050* 02630000
ALOCAT10 L     @8,8(0,@3)                                         0111  02640000
*         ROPTMIN2='22';            /* SET UP TO PASS SVC SECURITY.   * 02650000
         MVC   ROPTMIN2(2),@C5                                    0112  02660000
*         UCBADDRS=UCBADDR;         /* PUT DEVICE REQUESTING          * 02670000
         MVC   SVCPLIST(4),8(@3)                                  0113  02680000
*                                   /* ALLOCATION UCB ADDRESS IN FIRST* 02690000
*                                   /* WORD OF SVC PARAMETER LIST.    * 02700000
*         R0=ADDR(ROPT);            /* INITIALIZE POINTER TO SVCPLIST.* 02710000
         LA    @0,ROPT                                            0114  02720000
*         R1='003C'X;               /* PUT PROPER CALL CODE IN  YM7282* 02730000
         L     @1,@X6                                             0115  02740000
*                                   /* REG. 1 FOR SVC CALL.           * 02750000
*         GEN(SVC   DIAG);          /* ISSUE SVC FOR DEVICE STATUS.   * 02760000
         SVC   DIAG                                                     02770000
         DS    0H                                                       02780000
*         IF STAEXIT='1'B THEN      /* IS STAE EXIT IN CONTROL.       * 02790000
         TM    OLTEPSW6,B'00000001'                               0117  02800000
*           GO TO ALOCAT42;         /* YES, PERFORM SCRATCH.          * 02810000
         BC    01,ALOCAT42                                        0118  02820000
*         IF STATUS='1'B&           /* CHECK TO MAKE SURE DEVICE 21050* 02830000
*           DEVSTAT='1'B THEN       /* STATUS HAS NOT CHANGED,   21050* 02840000
         TM    3(@8),B'10000000'                                  0119  02850000
         BC    12,@9F2                                            0119  02860000
         TM    12(@3),B'10000000'                                 0119  02870000
*             GO TO ALOCAT20;       /* SINCE TEST RUN DEFINITION 21050* 02880000
         BC    03,ALOCAT20                                        0120  02890000
*         IF STATUS='0'B&           /* TIME.                     21050* 02900000
*           DEVSTAT='0'B THEN       /*                           21050* 02910000
@9F1     EQU   *                                                  0121  02920000
@9F2     TM    3(@8),B'10000000'                                  0121  02930000
         BC    05,@9F0                                            0121  02940000
         TM    12(@3),B'10000000'                                 0121  02950000
*             GO TO ALOCAT20;       /*                           21050* 02960000
         BC    10,ALOCAT20                                        0122  02970000
*         /************************************************************ 02980000
*         /*     PWTO MESSAGE INDICATING DEVICE STATUS CHANGED.       * 02990000
*         /************************************************************ 03000000
*         R1=MSGPTR56;              /* GET POINTER TO MESSAGE IFD156I.* 03010000
@9EF     EQU   *                                                  0123  03020000
@9F0     L     @1,8(0,@9)                                         0123  03030000
*         MSG56I(16:23)=EBCDICAD;   /* PUT EBCDIC DEVICE ADDR IN 21050* 03040000
         MVC   19(8,@1),0(@3)                                     0124  03050000
*                                   /* MESSAGE.                       * 03060000
*         GEN(PWTO  REG=(1));       /* PRINT MESSAGE.                 * 03070000
         PWTO  REG=(1)                                                  03080000
         DS    0H                                                       03090000
*         BYPTST='1'B;              /* SET FLAG TO BYPASS TESTS.      * 03100000
         OI    OLTEPSW3,B'00100000'                               0126  03110000
*         SAVE4=SCHEDSA;            /* GET SET TO RETURN TO SCHEDULER.* 03120000
         MVC   4(4,@D),SCHEDSA                                    0127  03130000
*         GO TO ALOCAT60;           /* RETURN TO SCHEDULER.           * 03140000
         BC    15,ALOCAT60                                        0128  03150000
* ALOCAT20:                                                             03160000
*         /************************************************************ 03170000
*         /*            DETERMINE WHAT IS REQUESTED BY USER           * 03180000
*         /************************************************************ 03190000
*         IF CLASS^='20'X THEN      /* IS DEVICE DASD. NO, RETURN21050* 03200000
ALOCAT20 CLI   18(@8),X'20'                                       0129  03210000
*           GO TO ALOCAT52;         /* CODE 04.                  21050* 03220000
         BC    07,ALOCAT52                                        0130  03230000
*         IF TYPE>'05'X&            /* LEGAL DEVICE              01906* 03240000
*           TYPE<'10'X THEN         /*                           21050* 03250000
         CLI   19(@8),X'05'                                       0131  03260000
         BC    12,@9EE                                            0131  03270000
         CLI   19(@8),X'10'                                       0131  03280000
*             GO TO ALOCAT22;       /*                           21050* 03290000
         BC    05,ALOCAT22                                        0132  03300000
*         GO TO ALOCAT52;           /*                           21050* 03310000
         BC    15,ALOCAT52                                        0133  03320000
* ALOCAT22:                                                             03330000
*         IF ALCINDEX='00'X THEN    /* HAS THIS BEEN ALLOCATED  YM7282* 03340000
ALOCAT22 CLI   54(@3),X'00'                                       0134  03350000
*           GO TO ALOCAT34;         /* PREVIOUSLY. NO, CONTINUE YM7282* 03360000
         BC    08,ALOCAT34                                        0135  03370000
*                                   /* YES, PLACE DDNAME IN SVC YM7282* 03380000
*                                   /* 99 PLIST FOR UNALLOC     YM7282* 03390000
*         UNUNIT1(5:14)=DDNAME(ALCINDEX); /*                    YM7282* 03400000
         SR    @C,@C                                              0136  03410000
         IC    @C,54(0,@3)                                        0136  03420000
         MH    @C,@D2                                             0136  03430000
         LA    @E,DDNAME-10(@C)                                   0136  03440000
         MVC   UNTUNIT+4(10),0(@E)                                0136  03450000
* ALOCAT34:                         /*                          YM7282* 03460000
*         IF ALOFLAG='02'X THEN     /* IS A SCRATCH REQUESTED.        * 03470000
ALOCAT34 CLI   ALOFLAG,X'02'                                      0137  03480000
*           GO TO ALOCAT40;         /* YES, GO TO SCRATCH ROUTINE.    * 03490000
         BC    08,ALOCAT40                                        0138  03500000
*         IF ALOFLAG='01'X THEN     /* IS ALLOCATION FOR NON-DEMOUNT- * 03510000
         CLI   ALOFLAG,X'01'                                      0139  03520000
*           GO TO ALOCAT30;         /* ABLES. YES, GO TO ROUTINE FOR  * 03530000
         BC    08,ALOCAT30                                        0140  03540000
*                                   /* NON-DEMOUNTABLE ALLOCATION.    * 03550000
*         IF ALOFLAG^='00'X THEN    /* IS REQUEST FOR FULL EXTENTS    * 03560000
         CLI   ALOFLAG,X'00'                                      0141  03570000
*           GO TO ALOCAT52;         /* DEMOUNTABLE ALLOCATION. NO,    * 03580000
         BC    07,ALOCAT52                                        0142  03590000
*                                   /* RETURN CODE 04.                * 03600000
*         /************************************************************ 03610000
*         /*                                                          * 03620000
*         /*                 DEMOUNTABLE ALLOCATION                   * 03630000
*         /*                                                          * 03640000
*         /************************************************************ 03650000
* ALOCAT21:                                                             03660000
*         IF FPMODE='0'B THEN       /* IS FILE PROTECT MODE PRESENT.  * 03670000
ALOCAT21 TM    12(@3),B'00000010'                                 0143  03680000
*           GO TO ALOCAT50;         /* RETURN CODE 00 TO INDICATE ALL * 03690000
         BC    08,ALOCAT50                                        0144  03700000
*                                   /* OF VOLUME AVAILABLE AND NOT    * 03710000
*                                   /* FILE PROTECTED.                * 03720000
*         IF DEVSTAT='1'B THEN      /* IS VOLUME ON-LINE. YES, RETURN * 03730000
         TM    12(@3),B'10000000'                                 0145  03740000
*           GO TO ALOCAT58;         /* CODE 10 TO INDICATE SPACE NOT  * 03750000
         BC    01,ALOCAT58                                        0146  03760000
*                                   /* ALLOCATED AND VOLUME FILE      * 03770000
*                                   /* PROTECTED.                     * 03780000
* ALOCAT25:                                                             03790000
*         IF FEATURES(3)='1'B THEN  /* IS DEVICE BEING SHARED.   21050* 03800000
ALOCAT25 TM    17(@8),B'00100000'                                 0147  03810000
         BC    12,@9EC                                            0147  03820000
*                                   /* YES,                      21050* 03830000
*           DO;                     /* FIND OUT IF IT IS OFF-LINE IN  * 03840000
*           RESPAREA=RESPAREA&&RESPAREA; /* OTHER SYSTEMS. CLEAR 21050* 03850000
         XC    RESPAREA(7),RESPAREA                               0149  03860000
*                                        /* THE ECB AND REPBUF.  21050* 03870000
*           R1=MSGPTR45;            /* GET POINTER TO MESSAGE IFD145D.* 03880000
         L     @1,4(0,@9)                                         0150  03890000
*           WTORPRF2=WTORLIST;      /* PUT NECESSARY INFORMATION IN   * 03900000
         MVC   0(8,@1),WTORLIST                                   0151  03910000
*                                   /* WTOR EXPANSION.                * 03920000
*           MSG45D(12:19)=EBCDICAD; /* PUT EBCDIC DEVICE ADDR IN 21050* 03930000
         MVC   23(8,@1),0(@3)                                     0152  03940000
*                                   /* MESSAGE.                       * 03950000
*           GEN(PWTOR REG=(1),WAIT=YES);                                03960000
         PWTOR REG=(1),WAIT=YES                                         03970000
         DS    0H                                                       03980000
*           IF REPBUF(1)='N' THEN   /* WAS DEV OFFLINE EVERYWHERE21050* 03990000
         CLI   RESPAREA+4,C'N'                                    0154  04000000
*             GO TO ALOCAT58;       /* NO, RETURN CODE 10.            * 04010000
         BC    08,ALOCAT58                                        0155  04020000
*           IF REPBUF(1)^='Y' THEN  /* WAS REPLY YES. NO, REPEAT21050*/ 04030000
         CLI   RESPAREA+4,C'Y'                                    0156  04040000
*             GO TO ALOCAT25;       /* THE MESSAGE. YES, CONTINUE.    * 04050000
         BC    07,ALOCAT25                                        0157  04060000
*           END;                                                        04070000
*         /************************************************************ 04080000
*         /*         CAN DATA ON THIS DEVICE BE DESTROYED.            * 04090000
*         /************************************************************ 04100000
* ALOCAT28:                                                             04110000
*         RESPAREA=RESPAREA&&RESPAREA; /* CLEAR ECB AND REPBUF.  21050* 04120000
@9EC     EQU   *                                                  0159  04130000
ALOCAT28 XC    RESPAREA(7),RESPAREA                               0159  04140000
*         R1=MSGPTR20;              /* GET POINTER TO MESSAGE IFD120D.* 04150000
         L     @1,0(0,@9)                                         0160  04160000
*         WTORPRF1=WTORLIST;        /* PUT NECESSARY INFORMATION IN   * 04170000
         MVC   0(8,@1),WTORLIST                                   0161  04180000
*                                   /* WTOR EXPANSION.                * 04190000
*         MSG20D(25:32)=EBCDICAD;   /* PUT EBCDIC DEVICE ADDR IN 21050* 04200000
         MVC   36(8,@1),0(@3)                                     0162  04210000
*                                   /* MESSAGE.                       * 04220000
*         GEN(PWTOR REG=(1),WAIT=YES);                                  04230000
         PWTOR REG=(1),WAIT=YES                                         04240000
         DS    0H                                                       04250000
*         IF REPBUF(1)='N' THEN     /* CAN DATA BE DESTROYED. NO,21050* 04260000
         CLI   RESPAREA+4,C'N'                                    0164  04270000
*           GO TO ALOCAT58;         /* RETURN CODE 10.                * 04280000
         BC    08,ALOCAT58                                        0165  04290000
*         IF REPBUF(1)^='Y' THEN    /* WAS REPLY YES. NO,REPEAT  21050* 04300000
         CLI   RESPAREA+4,C'Y'                                    0166  04310000
*           GO TO ALOCAT28;         /* MESSAGE. YES, CONTINUE.        * 04320000
         BC    07,ALOCAT28                                        0167  04330000
*         FPMODE='0'B;              /* TURN OFF FILE-PROTECT FLAG IN  * 04340000
         NI    12(@3),B'11111101'                                 0168  04350000
*                                   /* DEVTABLE ENTRY.                * 04360000
*         CDSFPM='0'B;              /* TURN OFF FPM FLAG IN CDS. 21050* 04370000
         NI    41(@3),B'01111111'                                 0169  04380000
*         IF PRIMARY='1'B THEN      /* IS ALLOCATION FOR PRIMARY      * 04390000
         TM    12(@3),B'01000000'                                 0170  04400000
         BC    12,@9EB                                            0170  04410000
*           DO;                     /* DEVICE. YES, TURN FILE PROTECT * 04420000
*           FILEPROT='0'B;          /* FLAGS OFF IN THE SCT.          * 04430000
         NI    SCT+10,B'10111111'                                 0172  04440000
*           FPMODCDS='0'B;                                              04450000
         NI    SCT+11,B'01111111'                                 0173  04460000
*           END;                                                        04470000
*                                   /* FLAG OFF IN THE SCT.           * 04480000
*         GO TO ALOCAT50;           /* RETURN CODE 00 INDICATING ALL  * 04490000
         BC    15,ALOCAT50                                        0175  04500000
*                                   /* OF VOLUME AVAILABLE AND NOT    * 04510000
*                                   /* FILE PROTECTED.                * 04520000
* ALOCAT30:                                                             04530000
*         /************************************************************ 04540000
*         /*                                                          * 04550000
*         /*               NON-DEMOUNTABLE ALLOCATION                 * 04560000
*         /*                                                          * 04570000
*         /************************************************************ 04580000
*         IF TYPE='08'X  |          /* CAN ALLOCATE ON 2314 DEV X03008* 04590000
*            TYPE='09'X  |          /* ON A 3330 DEVICE         X30008* 04600000
*            TYPE='0A'X  |          /* ON A WINCHESTER DEV    XL030130* 04610000
*            TYPE='0D'X             /* ON AN ICEBERG DEVICE     X03008* 04620000
*             THEN                  /* NO, CANNOT ALLOCATE      X03008* 04630000
ALOCAT30 CLI   19(@8),X'08'                                       0176  04640000
         BC    08,@9EA                                            0176  04650000
         CLI   19(@8),X'09'                                       0176  04660000
         BC    08,@9E9                                            0176  04670000
         CLI   19(@8),X'0A'                                       0176  04680000
         BC    08,@9E8                                            0176  04690000
         CLI   19(@8),X'0D'                                       0176  04700000
         BC    07,@9E7                                            0176  04710000
*              GO TO ALOCAT52;      /* ON THIS DEVICE TYPE.     X03008* 04720000
         BC    08,ALOCAT52                                        0177  04730000
* ALOCAT32:                                                             04740000
*         IF DEVSTAT='0'B THEN      /* IS DEVICE OFFLINE        YM7282* 04750000
@9E7     EQU   *                                                  0178  04760000
ALOCAT32 TM    12(@3),B'10000000'                                 0178  04770000
*           GO TO ALOCAT58;         /* YES, SPACE NOT ALLOCATED YM7282* 04780000
         BC    08,ALOCAT58                                        0179  04790000
*         IF FPMODE='0'B THEN       /* IS DEVICE FILE PROTECTED. NO,  * 04800000
         TM    12(@3),B'00000010'                                 0180  04810000
         BC    05,@9E6                                            0180  04820000
*           DO;                     /* HAS IT ALREADY BEEN ALLOCATED. * 04830000
*           IF ALLOCATE='0'B THEN   /* NO, RETURN CODE 00. YES, SET   * 04840000
         TM    12(@3),B'00001000'                                 0182  04850000
*             GO TO ALOCAT50;       /* BIT IN ALLOCATE FLAGS TO SAY   * 04860000
         BC    08,ALOCAT50                                        0183  04870000
*           REALOCAT='1'B;          /* RE-ALLOCATION IS NECESSARY.    * 04880000
         OI    ALOCATSW,B'10000000'                               0184  04890000
*           END;                                                        04900000
*         /************************************************************ 04910000
*         /*               BUILD DYN ALLOC TEXT UNITS           YM7282* 04920000
*         /************************************************************ 04930000
*         IF ALOAMT=ZERO THEN       /* IS AMOUNT OF SPACE REQUIRED 0. * 04940000
@9E6     CLC   ALOAMT(3),FULL                                     0186  04950000
*           GO TO ALOCAT52;         /* YES, RETURN CODE 04. NO, BUILD * 04960000
         BC    08,ALOCAT52                                        0187  04970000
*                                   /* SVC 99 PARMLIST.         YM7282* 04980000
*         ALCU6PRM=ALOAMT;          /* PUT AMOUNT OF SPACE      YM7282* 04990000
         MVC   ALCTUNIT+81(3),ALOAMT                              0188  05000000
*                                   /* REQUESTED IN SVC 99 PLISTYM7282* 05010000
*         ALCU8PRM=EBCDICAD(6:8);   /* PLACE EBCDIC DEVICE ADDR YM7282* 05020000
         MVC   ALCTUNIT+97(3),5(@3)                               0189  05030000
*                                   /* IN SVC 99 PLIST          YM7282* 05040000
*         ALCU8PRM(3)=ALCU8PRM(3)&'F8'X; /* MAKE SURE EBCDIC    YM7282* 05050000
         NI    ALCTUNIT+99,X'F8'                                  0190  05060000
*                                   /* ADDR IS BASE ADDR        YM7282* 05070000
*         ALCTYPE(2)='07'X;         /* ASSUME TRK ALLOCATION    YM7282* 05080000
         MVI   ALCTUNIT+72,X'07'                                  0191  05090000
*         IF ALOFLGT^='88'X THEN    /* IS IT TRK REQUEST        YM7282* 05100000
         CLI   ALOFLGT,X'88'                                      0192  05110000
         BC    08,@9E5                                            0192  05120000
*           ALCTYPE(2)='08'X;       /* NO, INDICATE CYL ALLOC   YM7282* 05130000
         MVI   ALCTUNIT+72,X'08'                                  0193  05140000
*         ALCU9LNG(2)='08'X;        /* INSURE RETURN OF DDNAME  YM7282* 05150000
@9E5     MVI   ALCTUNIT+105,X'08'                                 0194  05160000
*         ALCU9PRM=ALCU9PRM&&ALCU9PRM; /* FROM SVC 99.          YM7282* 05170000
         XC    ALCTUNIT+106(8),ALCTUNIT+106                       0195  05180000
*         ALCU1PRM(8)='1';          /* DSNAME FOR THIS ALLOCATE YM7282* 05190000
         MVI   ALCTUNIT+13,C'1'                                   0196  05200000
*         IF REALOCAT='1'B&         /* IF THIS IS A REQUEST FOR RE-   * 05210000
*           DSNAMEFF='1'B THEN      /* ALLOCATION AND EXISTING DSNAME * 05220000
         TM    ALOCATSW,B'10000000'                               0197  05230000
         BC    12,@9E4                                            0197  05240000
         TM    13(@3),B'10000000'                                 0197  05250000
         BC    12,@9E3                                            0197  05260000
*             ALCU1PRM(8)='2';      /* WAS OSOLTEP1, USE DSN=   YM7282* 05270000
         MVI   ALCTUNIT+13,C'2'                                   0198  05280000
*                                   /* TO OSOLTEP2.                   * 05290000
* ALOCAT35:                                                             05300000
*         /************************************************************ 05310000
*         /*         ISSUE SVC 99 FOR DYNAMIC ALLOCATION        YM7282* 05320000
*         /************************************************************ 05330000
*         S99RBPTR=ADDR(S99RBALC);  /* SET UP S99RBPTR          YM7282* 05340000
@9E3     EQU   *                                                  0199  05350000
@9E4     EQU   *                                                  0199  05360000
ALOCAT35 LA    @F,S99RBALC                                        0199  05370000
         ST    @F,S99RB                                           0199  05380000
*         S99RB(1)='80'X;           /* INSURE HIGH ORDER BIT    YM7282* 05390000
         MVI   S99RB,X'80'                                        0200  05400000
*                                   /* OF S99RBPTR IS ON.       YM7282* 05410000
*         R1=ADDR(S99RB);           /* INITIALIZE R1 TO POINT TOYM7282* 05420000
         LA    @1,S99RB                                           0201  05430000
*                                   /* RB PTR WORD.             YM7282* 05440000
*         GEN(SVC   99);            /* ATTEMPT ALLOCATION       YM7282* 05450000
         SVC   99                                                       05460000
         DS    0H                                                       05470000
*         IF RC^=0 THEN             /* WAS ALLOC SUCCESSFUL     YM7282* 05480000
         LTR   @F,@F                                              0203  05490000
*           GO TO ALOCAT58;         /* NO, RETURN CODE 10, SPACEYM7282* 05500000
         BC    07,ALOCAT58                                        0204  05510000
*                                   /* REQUESTED NOT AVAILABLE  YM7282* 05520000
*         IF ALCINDEX^='00'X THEN   /* IS THERE AN ENTRY IN     YM7282* 05530000
         CLI   54(@3),X'00'                                       0205  05540000
         BC    08,@9E2                                            0205  05550000
*                                   /* INDEX FLD OF DEVTAB      YM7282* 05560000
*           DO;                     /* YES, USE IT AS INDEX     YM7282* 05570000
*           R6=ALCINDEX;            /* PREPARE TO USE INDEX     YM7282* 05580000
         SR    @6,@6                                              0207  05590000
         IC    @6,54(0,@3)                                        0207  05600000
*           GO TO ALOCAT36;         /* SAVE NEW DDNAME          YM7282* 05610000
         BC    15,ALOCAT36                                        0208  05620000
*           END;                    /*                          YM7282* 05630000
*         DO R6=1 TO 16 BY +1;      /* FIND AVAILABLE SLOT IN   YM7282* 05640000
@9E2     LA    @6,1                                               0210  05650000
*         IF DDNAME(R6,2)='00'X THEN /* DDNAME SAVE AREA        YM7282* 05660000
@DO9E1   LR    @C,@6                                              0211  05670000
         MH    @C,@D2                                             0211  05680000
         LA    @A,DDNAME-9(@C)                                    0211  05690000
         CLI   0(@A),X'00'                                        0211  05700000
*           GO TO ALOCAT36;         /* SLOT FOUND, USE IT       YM7282* 05710000
         BC    08,ALOCAT36                                        0212  05720000
*         END;                      /* TRY AGAIN                YM7282* 05730000
*         GO TO ALOCAT58;           /* EXIT NO SLOT AVAILABLE   YM7282* 05740000
         AH    @6,@D3                                             0213  05750000
@DO9E0   CH    @6,@D4                                             0213  05760000
         BC    12,@DO9E1                                          0213  05770000
         BC    15,ALOCAT58                                        0214  05780000
* ALOCAT36:                         /*                          YM7282* 05790000
*         DDNAME(R6)=ALCUNIT9(5:14);/* SAVE DDNAME              YM7282* 05800000
ALOCAT36 LR    @C,@6                                              0215  05810000
         MH    @C,@D2                                             0215  05820000
         LA    @A,DDNAME-10(@C)                                   0215  05830000
         MVC   0(10,@A),ALCTUNIT+104                              0215  05840000
*         ALCINDEX=R6;              /* SAVE INDEX               YM7282* 05850000
         STC   @6,54(0,@3)                                        0216  05860000
*         /************************************************************ 05870000
*         /*         READ DATA SET CONTROL BLOCK INTO CORE            * 05880000
*         /************************************************************ 05890000
*         GEN(OBTAIN ALOCDSCB);     /* ISSUE OBTAIN MACRO.            * 05900000
         OBTAIN ALOCDSCB                                                05910000
         DS    0H                                                       05920000
*         IF RC^=0 THEN             /* WAS OBTAIN SUCCESSFUL. NO,     * 05930000
         LTR   @F,@F                                              0218  05940000
*           GO TO ALOCAT58;         /* RETURN CODE 10.                * 05950000
         BC    07,ALOCAT58                                        0219  05960000
*         R4=ALOCADR;               /* PREPARE TO PUT EXTENTS IN U.T..* 05970000
         L     @4,ALOCADR                                         0220  05980000
*         BBSTRT=BBSTRT&&BBSTRT;    /* ZERO BIN ADDRESS, BOTH START   * 05990000
         XC    0(2,@4),0(@4)                                      0221  06000000
*         BBEND=BBSTRT;             /* AND END ADDRESS.               * 06010000
         MVC   8(2,@4),0(@4)                                      0222  06020000
*         CCHHSTRT=LOWLIMIT;        /* PUT START ADDRESS OF ALLOCATED * 06030000
         MVC   2(4,@4),WORKAREA+63                                0223  06040000
*                                   /* EXTENTS IN UNIT TEST AREA.     * 06050000
*         CCHHEND=UPLIMIT;          /* PUT END ADDRESS OF ALLOCATED   * 06060000
         MVC   10(4,@4),WORKAREA+67                               0224  06070000
*                                   /* EXTENTS IN UNIT TEST AREA.     * 06080000
*         STARTAD=STRTAD;           /* PUT START ADDRESS IN DEVTAB.   * 06090000
         MVC   16(6,@3),0(@4)                                     0225  06100000
*         ENDAD=CCHHEND;            /* PUT END ADDRESS IN DEVTAB.     * 06110000
         MVC   22(4,@3),10(@4)                                    0226  06120000
*         IF ALOFLGT='88'X THEN     /* WAS REQUEST FOR TRKS. YES, PUT * 06130000
         CLI   ALOFLGT,X'88'                                      0227  06140000
         BC    07,@9DD                                            0227  06150000
*           NOTRKS=ALOAMT(2:3);     /* AMOUNT IN DEVTAB. NO, REQUEST  * 06160000
         MVC   26(2,@3),ALOAMT+1                                  0228  06170000
         BC    15,@9DC                                            0229  06180000
*         ELSE                      /* WAS FOR CYLS. CALCULATE NUMBER * 06190000
*           DO;                     /* OF TRKS PER CYLINDER AND PUT   * 06200000
*           IF TYPE='02'X THEN      /* THAT IN DEVTAB.                * 06210000
@9DD     CLI   19(@8),X'02'                                       0230  06220000
         BC    07,@9DB                                            0230  06230000
*             DO;                   /*  2301 -- 1 CYL OF 200 TRKS.    * 06240000
*             NOTRKS='00C8'X;       /*  2303 -- 80 CYL OF 10 TRKS EACH* 06250000
         MVC   26(2,@3),@X22                                      0232  06260000
*             GO TO ALOCAT37;                                           06270000
         BC    15,ALOCAT37                                        0233  06280000
*             END;                                                      06290000
*           R4=ALOAMT(3)*10;        /* TAKE NUMBER OF CYL AND MULTIPLY* 06300000
@9DB     LA    @F,10                                              0235  06310000
         SR    @0,@0                                              0235  06320000
         IC    @0,ALOAMT+2                                        0235  06330000
         MR    @E,@0                                              0235  06340000
         LR    @4,@F                                              0235  06350000
*           NUMTRKS=R4;             /* BY TEN TO FIND NUMBER OF TRKS. * 06360000
         STH   @4,26(0,@3)                                        0236  06370000
*           END;                    /* PUT AMOUNT IN DEVTAB.          * 06380000
* ALOCAT37:                                                             06390000
*         IF REALOCAT='1'B THEN     /* IF THIS WAS REALLOCATION,      * 06400000
@9DC     EQU   *                                                  0238  06410000
ALOCAT37 TM    ALOCATSW,B'10000000'                               0238  06420000
*           GO TO ALOCAT40;         /* SCRATCH OTHER DSNAME.          * 06430000
         BC    01,ALOCAT40                                        0239  06440000
* ALOCAT38:                                                             06450000
*         DSNAMEFF='1'B;            /* FIRST ALLOCATE, TURN ON DSNAME * 06460000
ALOCAT38 OI    13(@3),B'10000000'                                 0240  06470000
*                                   /* ALLOCATE BIT IN DEVTAB.        * 06480000
*         FPMODE='0'B;              /* TURN OFF FILE PROTECT BITS.    * 06490000
         NI    12(@3),B'11111101'                                 0241  06500000
*         CDSFPM='0'B;              /*                           21050* 06510000
         NI    41(@3),B'01111111'                                 0242  06520000
*         IF PRIMARY='1'B THEN                                          06530000
         TM    12(@3),B'01000000'                                 0243  06540000
         BC    12,@9DA                                            0243  06550000
*           DO;                                                         06560000
*           FILEPROT='0'B;                                              06570000
         NI    SCT+10,B'10111111'                                 0245  06580000
*           FPMODCDS='0'B;                                              06590000
         NI    SCT+11,B'01111111'                                 0246  06600000
*           END;                                                        06610000
*         ALLOCATE='1'B;            /* TURN ALLOCATE BIT ON IN DEVTAB.* 06620000
@9DA     OI    12(@3),B'00001000'                                 0248  06630000
*         GO TO ALOCAT56;           /* RETURN CODE 0C.                * 06640000
         BC    15,ALOCAT56                                        0249  06650000
* ALOCAT40:                                                             06660000
*         /************************************************************ 06670000
*         /*                                                          * 06680000
*         /*                        SCRATCH                           * 06690000
*         /*                                                          * 06700000
*         /************************************************************ 06710000
*         IF TYPE='08'X  |          /* CAN ALLOCATE ON 2314 DEV X03008* 06720000
*            TYPE='09'X  |          /* ON A 3330 DEVICE         X30008* 06730000
*            TYPE='0A'X  |          /* ON A WINCHESTER DEV    XL030130* 06740000
*            TYPE='0D'X             /* ON AN ICEBERG DEVICE     X03008* 06750000
*             THEN                  /* NO, CANNOT ALLOCATE      X03008* 06760000
ALOCAT40 CLI   19(@8),X'08'                                       0250  06770000
         BC    08,@9D9                                            0250  06780000
         CLI   19(@8),X'09'                                       0250  06790000
         BC    08,@9D8                                            0250  06800000
         CLI   19(@8),X'0A'                                       0250  06810000
         BC    08,@9D7                                            0250  06820000
         CLI   19(@8),X'0D'                                       0250  06830000
         BC    07,@9D6                                            0250  06840000
*              GO TO ALOCAT51;      /* ON THIS DEVICE TYPE.     X03008* 06850000
         BC    08,ALOCAT51                                        0251  06860000
* ALOCAT42:                                                             06870000
*         IF ALLOCATE='0'B THEN     /* HAS DRUM BEEN ALLOCATED. NO,   * 06880000
@9D6     EQU   *                                                  0252  06890000
ALOCAT42 TM    12(@3),B'00001000'                                 0252  06900000
*  GO TO ALOCAT50;                 /* SET RETURN CODE = '00'          * 06910000
         BC    08,ALOCAT50                                        0253  06920000
* ALOCAT45:                                                             06930000
*         /************************************************************ 06940000
*         /*             ATTEMPT DYNAMIC UNALLOCATION           YM7282* 06950000
*         /************************************************************ 06960000
*         DO R6=3 TO 1 BY -1;       /* PERFORM SCRATCH.               * 06970000
ALOCAT45 LA    @6,3                                               0254  06980000
*         S99RBPTR=ADDR(S99RBUNA);  /* SET UP S99RBPTR          YM7282* 06990000
@DO9D5   LA    @F,S99RBUNA                                        0255  07000000
         ST    @F,S99RB                                           0255  07010000
*         S99RB(1)='80'X;           /* INSURE HIGH ORDER BIT    YM7282* 07020000
         MVI   S99RB,X'80'                                        0256  07030000
*                                   /* OF S99RBPTR IS ON.       YM7282* 07040000
*         R1=ADDR(S99RB);           /* INITIALIZE R1 TO POINT TOYM7282* 07050000
         LA    @1,S99RB                                           0257  07060000
*                                   /* RB PTR WORD.             YM7282* 07070000
*         GEN(SVC   99);            /* ATTEMPT UNALLOCATION     YM7282* 07080000
         SVC   99                                                       07090000
         DS    0H                                                       07100000
*         IF RC=0 THEN              /* WAS SCRATCH SUCCESSFUL. NO,    * 07110000
         LTR   @F,@F                                              0259  07120000
*           GO TO ALOCAT47;         /* REPEAT IT AT LEAST TWICE. IF   * 07130000
         BC    08,ALOCAT47                                        0260  07140000
*         END;                      /* IT CANNOT BE SCRATCHED, PRINT  * 07150000
*                                   /* ERROR MESSAGE.            21050* 07160000
*         R1=MSGPTR62;              /* GET POINTER TO MESSAGE IFD162I.* 07170000
         BCT   @6,@DO9D5                                          0261  07180000
         L     @1,12(0,@9)                                        0262  07190000
*         MSG62I(14:21)=EBCDICAD;   /* PUT DEVICE ADDR IN MESSAGE21050* 07200000
         MVC   17(8,@1),0(@3)                                     0263  07210000
*         MSG62I(31:37)=ALCU1PRM(1:7); /* DSN COMMON PART TO MSGYM7282* 07220000
         MVC   34(7,@1),ALCTUNIT+6                                0264  07230000
*         MSG62I(38)='1';           /* ASSUME OSOLTEP1          YM7282* 07240000
         MVI   41(@1),C'1'                                        0265  07250000
*         IF DSNAMEFF='0'B THEN     /* IS IT OSOLTEP1           YM7282* 07260000
         TM    13(@3),B'10000000'                                 0266  07270000
         BC    05,@9D1                                            0266  07280000
*           MSG62I(38)='2';         /* NO, SET UP OSOLTEP2      YM7282* 07290000
         MVI   41(@1),C'2'                                        0267  07300000
*         DPMSGREI='0'B;                /* TURN OFF REM MSG FLG XM0097* 07310000
@9D1     NI    A00022,B'11111110'                                 0268  07320000
*         GEN(PWTO  REG=(1));       /* PRINT MESSAGE.                 * 07330000
         PWTO  REG=(1)                                                  07340000
         DS    0H                                                       07350000
*         IF REALOCAT='1'B THEN     /* WAS THIS RE-ALLOCATION. YES,   * 07360000
         TM    ALOCATSW,B'10000000'                               0270  07370000
         BC    12,@9D0                                            0270  07380000
*           DO;                                                         07390000
*           MARK='1'B;              /* SET MARK ON WALL.              * 07400000
         OI    ALOCATSW,B'00100000'                               0272  07410000
*           IF DUPLICTE='1'B THEN   /* IS THIS A DUP REQUEST.         * 07420000
         TM    ALOCATSW,B'01000000'                               0273  07430000
*             GO TO ALOCAT49;       /* YES, PREPARE TO EXIT.          * 07440000
         BC    01,ALOCAT49                                        0274  07450000
*           GO TO ALOCAT48;         /* CHANGE STATUS OF DSNAME   21050* 07460000
         BC    15,ALOCAT48                                        0275  07470000
*                                   /* FLIP-FLOP AND RETURN CODE 21050* 07480000
*                                   /* 0C.                       21050* 07490000
*           END;                                                        07500000
*         IF STAEXIT='1'B THEN      /* IS STAE EXIT IN CONTROL.       * 07510000
@9D0     TM    OLTEPSW6,B'00000001'                               0277  07520000
*           GO TO ALOCAT05;         /* YES, CHECK NEXT DEVICE.        * 07530000
         BC    01,ALOCAT05                                        0278  07540000
*         GO TO ALOCAT54;           /* RETURN CODE 08.                * 07550000
         BC    15,ALOCAT54                                        0279  07560000
* ALOCAT47:                                                             07570000
*         IF DUPLICTE='1'B THEN     /* WAS SCRATCH DONE BECAUSE OF    * 07580000
ALOCAT47 TM    ALOCATSW,B'01000000'                               0280  07590000
*           GO TO ALOCAT35;         /* DUPLICATE DSNAME. YES, GO BACK * 07600000
         BC    01,ALOCAT35                                        0281  07610000
*                                   /* AND TRY NEW ALLOCATE.          * 07620000
*         IF REALOCAT='1'B THEN     /* WAS THIS SCRATCH CAUSED BY     * 07630000
         TM    ALOCATSW,B'10000000'                               0282  07640000
         BC    12,@9CF                                            0282  07650000
*           DO;                     /* REQUEST FOR REALLOCATION. YES, * 07660000
* ALOCAT48:                                                             07670000
*           FLAG2=FLAG2&&'80'X;     /* CHANGE STATUS OF DSNAME FLIP-  * 07680000
ALOCAT48 XI    13(@3),X'80'                                       0284  07690000
*           GO TO ALOCAT56;         /* FLOP AND RETURN CODE 0C.       * 07700000
         BC    15,ALOCAT56                                        0285  07710000
*           END;                                                        07720000
* ALOCAT49:                                                             07730000
*         ALLOCATE='0'B;            /* TURN ALLOCATE BIT OFF IN DEVTAB* 07740000
@9CF     EQU   *                                                  0287  07750000
ALOCAT49 NI    12(@3),B'11110111'                                 0287  07760000
*         EXTENTS=FULL;             /* MOVE FULL EXTENTS TO DEVTAB.   * 07770000
         MVC   16(12,@3),FULL                                     0288  07780000
*         FPMODE='1'B;              /* TURN FILE PROTECT BIT ON IN    * 07790000
         OI    12(@3),B'00000010'                                 0289  07800000
*                                   /* DEVTAB ENTRY.                  * 07810000
*         CDSFPM='1'B;              /* TURN FPM FLAG ON IN CDS   21050* 07820000
         OI    41(@3),B'10000000'                                 0290  07830000
*                                   /* FLAG BYTE.                21050* 07840000
*         DDNAME(ALCINDEX)=DDNAME(ALCINDEX)&&DDNAME(ALCINDEX);/*YM7282* 07850000
         SR    @C,@C                                              0291  07860000
         IC    @C,54(0,@3)                                        0291  07870000
         MH    @C,@D2                                             0291  07880000
         LA    @E,DDNAME-10(@C)                                   0291  07890000
         LA    @A,DDNAME-10(@C)                                   0291  07900000
         XC    0(10,@A),0(@E)                                     0291  07910000
*         ALCINDEX='00'X;           /* CLEAR INDEX IN DEVTAB    YM7282* 07920000
         MVI   54(@3),X'00'                                       0292  07930000
*         IF PRIMARY='1'B THEN      /* IF THIS IS PRIMARY DEVICE, TURN* 07940000
         TM    12(@3),B'01000000'                                 0293  07950000
         BC    12,@9CE                                            0293  07960000
*           DO;                     /* FILE PROTECT BITS ON IN SCT.   * 07970000
*           FILEPROT='1'B;                                              07980000
         OI    SCT+10,B'01000000'                                 0295  07990000
*           FPMODCDS='1'B;                                              08000000
         OI    SCT+11,B'10000000'                                 0296  08010000
*           END;                                                        08020000
*         IF MARK='1'B THEN         /* IS MARK ON WALL.               * 08030000
@9CE     TM    ALOCATSW,B'00100000'                               0298  08040000
*           GO TO ALOCAT54;         /* YES, RETURN 08.                * 08050000
         BC    01,ALOCAT54                                        0299  08060000
*         IF STAEXIT='1'B THEN      /* IS STAE EXIT IN CONTROL.       * 08070000
         TM    OLTEPSW6,B'00000001'                               0300  08080000
*           GO TO ALOCAT05;         /* YES, CHECK NEXT DEVICE.        * 08090000
         BC    01,ALOCAT05                                        0301  08100000
* ALOCAT50:                                                             08110000
*         /************************************************************ 08120000
*         /*                      RETURN CODES                        * 08130000
*         /************************************************************ 08140000
*         R15=0;                    /* SET RETURN CODE REGISTER TO 00 * 08150000
ALOCAT50 SR    @F,@F                                              0302  08160000
*                                   /* INDICATING ALL OF VOLUME       * 08170000
*                                   /* AVAILABLE AND NOT FILE PROT,   * 08180000
*                                   /* OR SCRATCH WAS SUCCESSFUL.     * 08190000
*         GO TO ALOCAT60;           /* RETURN.                        * 08200000
         BC    15,ALOCAT60                                        0303  08210000
* ALOCAT51:                                                             08220000
*         IF FPMODE='0'B THEN       /* WAS ALLOCATE DONE         01906* 08230000
ALOCAT51 TM    12(@3),B'00000010'                                 0304  08240000
*           GO TO ALOCAT50;         /* YES                       01906* 08250000
         BC    08,ALOCAT50                                        0305  08260000
* ALOCAT52:                                                             08270000
*         R15=4;                    /* SET RETURN CODE REGISTER TO 04 * 08280000
ALOCAT52 LA    @F,4                                               0306  08290000
*                                   /* INDICATING FACILITY NOT        * 08300000
*                                   /* AVAILABLE.                     * 08310000
*         GO TO ALOCAT60;           /* RETURN.                        * 08320000
         BC    15,ALOCAT60                                        0307  08330000
* ALOCAT54:                                                             08340000
*         R15=8;                    /* SET RETURN CODE REGISTER TO 08 * 08350000
ALOCAT54 LA    @F,8                                               0308  08360000
*                                   /* INDICATING SPACE NOT ALLOCATED * 08370000
*                                   /* AND VOLUME FILE PROTECTED, OR  * 08380000
*                                   /* SCRATCH NOT SUCCESSFUL.        * 08390000
*         GO TO ALOCAT60;           /* RETURN.                        * 08400000
         BC    15,ALOCAT60                                        0309  08410000
* ALOCAT56:                                                             08420000
*         R15=12;                   /* SET RETURN CODE REGISTER TO 0C * 08430000
ALOCAT56 LA    @F,12                                              0310  08440000
*                                   /* INDICATING REQUESTED SPACE     * 08450000
*                                   /* ALLOCATED,EXTENTS AT ADDRESS   * 08460000
*                                   /* PROVIDED,VOLUME NOT FILE       * 08470000
*                                   /* PROTECTED.                     * 08480000
*         GO TO ALOCAT60;           /* RETURN.                        * 08490000
         BC    15,ALOCAT60                                        0311  08500000
* ALOCAT58:                                                             08510000
*         R15=16;                   /* SET RETURN CODE REGISTER TO 10 * 08520000
ALOCAT58 LA    @F,16                                              0312  08530000
*                                   /* INDICATING AMOUNT OF SPACE     * 08540000
*                                   /* REQUESTED NOT AVAILABLE.       * 08550000
* ALOCAT60:                                                             08560000
*         DPMSGREI='0'B;                /* TURN OFF REM MSG FLG XM0097* 08570000
ALOCAT60 NI    A00022,B'11111110'                                 0313  08580000
*         RETURN;                   /* RETURN TO CALLER.              * 08590000
*         END;                                                          08600000
@EL01    L     @D,4(0,@D)                                         0315  08610000
         L     @E,12(0,@D)                                        0315  08620000
         LM    @0,@C,20(@D)                                       0315  08630000
         BCR   15,@E                                              0315  08640000
@DATA1   EQU   *                                                        08650000
@0       EQU   00                  EQUATES FOR REGISTERS 0-15           08660000
@1       EQU   01                                                       08670000
@2       EQU   02                                                       08680000
@3       EQU   03                                                       08690000
@4       EQU   04                                                       08700000
@5       EQU   05                                                       08710000
@6       EQU   06                                                       08720000
@7       EQU   07                                                       08730000
@8       EQU   08                                                       08740000
@9       EQU   09                                                       08750000
@A       EQU   10                                                       08760000
@B       EQU   11                                                       08770000
@C       EQU   12                                                       08780000
@D       EQU   13                                                       08790000
@E       EQU   14                                                       08800000
@F       EQU   15                                                       08810000
@D1      DC    H'56'                                                    08820000
@D2      DC    H'10'                                                    08830000
@D3      DC    H'1'                                                     08840000
@D4      DC    H'16'                                                    08850000
@V1      DC    V(IFDMSG22)                                              08860000
         DS    0F                                                       08870000
@X6      DC    X'0000003C'                                              08880000
@C5      DC    C'22'                                                    08890000
@X22     DC    X'00C8'                                                  08900000
         DS    0D                                                       08910000
@DATA    EQU   *                                                        08920000
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD                   08930000
R0       EQU   00000000            FULLWORD POINTER REGISTER            08940000
R1       EQU   00000001            FULLWORD POINTER REGISTER            08950000
R2       EQU   00000002            FULLWORD POINTER REGISTER            08960000
R3       EQU   00000003            FULLWORD POINTER REGISTER            08970000
I        EQU   00000004            3  BYTE  POINTER REGISTER            08980000
R4       EQU   00000004            FULLWORD POINTER REGISTER            08990000
RETCODE  EQU   00000004            FULLWORD POINTER REGISTER            09000000
R5       EQU   00000005            FULLWORD POINTER REGISTER            09010000
R6       EQU   00000006            FULLWORD POINTER REGISTER            09020000
R7       EQU   00000007            FULLWORD POINTER REGISTER            09030000
R8       EQU   00000008            FULLWORD POINTER REGISTER            09040000
R9       EQU   00000009            FULLWORD POINTER REGISTER            09050000
R13      EQU   00000013            FULLWORD POINTER REGISTER            09060000
R14      EQU   00000014            FULLWORD POINTER REGISTER            09070000
R15      EQU   00000015            FULLWORD POINTER REGISTER            09080000
RC       EQU   00000015            FULLWORD POINTER REGISTER            09090000
S99RBALC EQU   @DATA+00000072      20 BYTE(S) ON WORD                   09100000
         ORG   S99RBALC+00000000                                        09110000
ALCRBLN  EQU   *                   1 BYTE(S)                            09120000
         DC    X'14'                                                    09130000
ALCVERB  EQU   *                   1 BYTE(S)                            09140000
         DC    X'01'                                                    09150000
ALCFLAG1 EQU   *                   2 BYTE(S)                            09160000
         DC    X'0000'                                                  09170000
ALCERROR EQU   *                   2 BYTE(S)                            09180000
         DC    X'0000'                                                  09190000
ALCINFO  EQU   *                   2 BYTE(S)                            09200000
         DC    X'0000'                                                  09210000
ALCTXTPP EQU   *                   FULLWORD POINTER                     09220000
         DC    AL4(ALCTUPL)                                             09230000
A00003   EQU   *                   4 BYTE(S)                            09240000
         DC    X'00000000'                                              09250000
ALCFLAG2 EQU   *                   4 BYTE(S)                            09260000
         DC    X'00000000'                                              09270000
ALCTUPL  EQU   @DATA+00000092      40 BYTE(S) ON WORD                   09280000
ALCTXTP1 EQU   *                   FULLWORD POINTER                     09290000
         DC    AL4(ALCUNIT1)                                            09300000
ALCTXTP2 EQU   *                   FULLWORD POINTER                     09310000
         DC    AL4(ALCUNIT2)                                            09320000
ALCTXTP3 EQU   *                   FULLWORD POINTER                     09330000
         DC    AL4(ALCUNIT3)                                            09340000
ALCTXTP4 EQU   *                   FULLWORD POINTER                     09350000
         DC    AL4(ALCUNIT4)                                            09360000
ALCTXTP5 EQU   *                   FULLWORD POINTER                     09370000
         DC    AL4(ALCUNIT5)                                            09380000
ALCTXTP6 EQU   *                   FULLWORD POINTER                     09390000
         DC    AL4(ALCUNIT6)                                            09400000
ALCTXTP7 EQU   *                   FULLWORD POINTER                     09410000
         DC    AL4(ALCUNIT7)                                            09420000
ALCTXTP8 EQU   *                   FULLWORD POINTER                     09430000
         DC    AL4(ALCUNIT8)                                            09440000
ALCTXTP9 EQU   *                   FULLWORD POINTER                     09450000
         DC    AL4(ALCUNIT9)                                            09460000
ALCTXTPA EQU   ALCTUPL+00000036    4 BYTE(S)                            09470000
A00004   EQU   *                   1 BYTE(S)                            09480000
         DC    X'80'                                                    09490000
A00005   EQU   *                   3  BYTE  POINTER                     09500000
         DC    AL3(ALCUNITA)                                            09510000
ALCTUNIT EQU   @DATA+00000132      126 BYTE(S) ON WORD                  09520000
ALCUNIT1 EQU   ALCTUNIT+00000000   50 BYTE(S)                           09530000
DALDSNAM EQU   *                   2 BYTE(S)                            09540000
         DC    X'0002'                                                  09550000
ALCU1NUM EQU   *                   2 BYTE(S)                            09560000
         DC    X'0001'                                                  09570000
ALCU1LNG EQU   *                   2 BYTE(S)                            09580000
         DC    X'002C'                                                  09590000
ALCU1PRM EQU   ALCTUNIT+00000006   44 BYTE(S)                           09600000
A00006   EQU   *                   7 BYTE(S)                            09610000
         DC    C'OSOLTEP'                                               09620000
A00007   EQU   *                   37*1 BYTE(S)                         09630000
         DC    00037X'40'                                               09640000
ALCUNIT2 EQU   ALCTUNIT+00000050   7 BYTE(S)                            09650000
DALSTATS EQU   *                   2 BYTE(S)                            09660000
         DC    X'0004'                                                  09670000
ALCU2NUM EQU   *                   2 BYTE(S)                            09680000
         DC    X'0001'                                                  09690000
ALCU2LNG EQU   *                   2 BYTE(S)                            09700000
         DC    X'0001'                                                  09710000
ALCU2PRM EQU   *                   1 BYTE(S)                            09720000
         DC    X'04'                                                    09730000
ALCUNIT3 EQU   ALCTUNIT+00000057   7 BYTE(S)                            09740000
DALNDISP EQU   *                   2 BYTE(S)                            09750000
         DC    X'0005'                                                  09760000
ALCU3NUM EQU   *                   2 BYTE(S)                            09770000
         DC    X'0001'                                                  09780000
ALCU3LNG EQU   *                   2 BYTE(S)                            09790000
         DC    X'0001'                                                  09800000
ALCU3PRM EQU   *                   1 BYTE(S)                            09810000
         DC    X'04'                                                    09820000
ALCUNIT4 EQU   ALCTUNIT+00000064   7 BYTE(S)                            09830000
DALCDISP EQU   *                   2 BYTE(S)                            09840000
         DC    X'0006'                                                  09850000
ALCU4NUM EQU   *                   2 BYTE(S)                            09860000
         DC    X'0001'                                                  09870000
ALCU4LNG EQU   *                   2 BYTE(S)                            09880000
         DC    X'0001'                                                  09890000
ALCU4PRM EQU   *                   1 BYTE(S)                            09900000
         DC    X'04'                                                    09910000
ALCUNIT5 EQU   ALCTUNIT+00000071   4 BYTE(S)                            09920000
ALCTYPE  EQU   *                   2 BYTE(S)                            09930000
         DC    X'0000'                                                  09940000
ALCU5NUM EQU   *                   2 BYTE(S)                            09950000
         DC    X'0000'                                                  09960000
ALCUNIT6 EQU   ALCTUNIT+00000075   9 BYTE(S)                            09970000
DALPRIME EQU   *                   2 BYTE(S)                            09980000
         DC    X'000A'                                                  09990000
ALCU6NUM EQU   *                   2 BYTE(S)                            10000000
         DC    X'0001'                                                  10010000
ALCU6LNG EQU   *                   2 BYTE(S)                            10020000
         DC    X'0003'                                                  10030000
ALCU6PRM EQU   *                   3 BYTE(S)                            10040000
         DC    X'000000'                                                10050000
ALCUNIT7 EQU   ALCTUNIT+00000084   7 BYTE(S)                            10060000
DALSPFRM EQU   *                   2 BYTE(S)                            10070000
         DC    X'000E'                                                  10080000
ALCU7NUM EQU   *                   2 BYTE(S)                            10090000
         DC    X'0001'                                                  10100000
ALCU7LNG EQU   *                   2 BYTE(S)                            10110000
         DC    X'0001'                                                  10120000
ALCU7PRM EQU   *                   1 BYTE(S)                            10130000
         DC    X'08'                                                    10140000
ALCUNIT8 EQU   ALCTUNIT+00000091   9 BYTE(S)                            10150000
DALUNIT  EQU   *                   2 BYTE(S)                            10160000
         DC    X'0015'                                                  10170000
ALCU8NUM EQU   *                   2 BYTE(S)                            10180000
         DC    X'0001'                                                  10190000
ALCU8LNG EQU   *                   2 BYTE(S)                            10200000
         DC    X'0003'                                                  10210000
ALCU8PRM EQU   *                   3 BYTE(S)                            10220000
         DC    X'000000'                                                10230000
ALCUNIT9 EQU   ALCTUNIT+00000100   14 BYTE(S)                           10240000
DALRTDDN EQU   *                   2 BYTE(S)                            10250000
         DC    X'0055'                                                  10260000
ALCU9NUM EQU   *                   2 BYTE(S)                            10270000
         DC    X'0001'                                                  10280000
ALCU9LNG EQU   *                   2 BYTE(S)                            10290000
         DC    X'0008'                                                  10300000
ALCU9PRM EQU   *                   8 BYTE(S)                            10310000
         DC    X'0000000000000000'                                      10320000
ALCUNITA EQU   ALCTUNIT+00000114   12 BYTE(S)                           10330000
DALRTVOL EQU   *                   2 BYTE(S)                            10340000
         DC    X'005D'                                                  10350000
ALCUANUM EQU   *                   2 BYTE(S)                            10360000
         DC    X'0001'                                                  10370000
ALCUALNG EQU   *                   2 BYTE(S)                            10380000
         DC    X'0006'                                                  10390000
ALCUAPRM EQU   *                   6 BYTE(S)                            10400000
         DC    X'000000000000'                                          10410000
S99RBUNA EQU   @DATA+00000260      20 BYTE(S) ON WORD                   10420000
         ORG   S99RBUNA+00000000                                        10430000
UNRBLN   EQU   *                   1 BYTE(S)                            10440000
         DC    X'14'                                                    10450000
UNVERB   EQU   *                   1 BYTE(S)                            10460000
         DC    X'02'                                                    10470000
UNFLAG1  EQU   *                   2 BYTE(S)                            10480000
         DC    X'0000'                                                  10490000
UNERROR  EQU   *                   2 BYTE(S)                            10500000
         DC    X'0000'                                                  10510000
UNINFO   EQU   *                   2 BYTE(S)                            10520000
         DC    X'0000'                                                  10530000
UNTXTPP  EQU   *                   FULLWORD POINTER                     10540000
         DC    AL4(UNTUPL)                                              10550000
A00008   EQU   *                   4 BYTE(S)                            10560000
         DC    X'00000000'                                              10570000
UNFLAG2  EQU   *                   4 BYTE(S)                            10580000
         DC    X'00000000'                                              10590000
UNTUPL   EQU   @DATA+00000280      4 BYTE(S) ON WORD                    10600000
UNTXTP1  EQU   UNTUPL+00000000     4 BYTE(S)                            10610000
A00009   EQU   *                   1 BYTE(S)                            10620000
         DC    X'80'                                                    10630000
A00010   EQU   *                   3  BYTE  POINTER                     10640000
         DC    AL3(UNUNIT1)                                             10650000
UNTUNIT  EQU   @DATA+00000284      14 BYTE(S) ON WORD                   10660000
UNUNIT1  EQU   UNTUNIT+00000000    14 BYTE(S)                           10670000
DUNDDNAM EQU   *                   2 BYTE(S)                            10680000
         DC    X'0001'                                                  10690000
UNU1NUM  EQU   *                   2 BYTE(S)                            10700000
         DC    X'0001'                                                  10710000
UNU1LNG  EQU   *                   2 BYTE(S)                            10720000
         DC    X'0000'                                                  10730000
UNU1PRM  EQU   *                   8 BYTE(S)                            10740000
         DC    X'0000000000000000'                                      10750000
S99RB    EQU   @DATA+00000300      4 BYTE(S) ON WORD                    10760000
S99RBPTR EQU   S99RB+00000000      FULLWORD POINTER                     10770000
ALOCATSW EQU   @DATA+00000304      1 BYTE(S)                            10780000
REALOCAT EQU   ALOCATSW+00000000   1 BIT(S)                             10790000
DUPLICTE EQU   ALOCATSW+00000000   1 BIT(S)                             10800000
MARK     EQU   ALOCATSW+00000000   1 BIT(S)                             10810000
RESPAREA EQU   @DATA+00000308      7 BYTE(S) ON WORD                    10820000
ECB      EQU   RESPAREA+00000000   4 BYTE(S)                            10830000
REPBUF   EQU   RESPAREA+00000004   3 BYTE(S)                            10840000
SAVE4    EQU   00000004            FULLWORD POINTER                     10850000
         ORG   @DATA+00000315                                           10860000
FULL     EQU   *                   12 BYTE(S)                           10870000
         DC    X'000000000000FFFFFFFFFFFF'                              10880000
ZEROES   EQU   FULL+00000000       6 BYTE(S)                            10890000
ZERO     EQU   FULL+00000000       3 BYTE(S)                            10900000
MSGPTR   EQU   00000000            16 BYTE(S) ON WORD                   10910000
MSGPTR20 EQU   MSGPTR+00000000     FULLWORD POINTER                     10920000
MSGPTR45 EQU   MSGPTR+00000004     FULLWORD POINTER                     10930000
MSGPTR56 EQU   MSGPTR+00000008     FULLWORD POINTER                     10940000
MSGPTR62 EQU   MSGPTR+00000012     FULLWORD POINTER                     10950000
MSSGE20D EQU   00000000            70 BYTE(S) ON WORD                   10960000
WTORPRF1 EQU   MSSGE20D+00000000   8 BYTE(S)                            10970000
A00011   EQU   MSSGE20D+00000008   4 BYTE(S)                            10980000
MSG20D   EQU   MSSGE20D+00000012   58 BYTE(S)                           10990000
MSSGE45D EQU   00000000            76 BYTE(S) ON WORD                   11000000
WTORPRF2 EQU   MSSGE45D+00000000   8 BYTE(S)                            11010000
A00012   EQU   MSSGE45D+00000008   4 BYTE(S)                            11020000
MSG45D   EQU   MSSGE45D+00000012   64 BYTE(S)                           11030000
MSSGE56I EQU   00000000            51 BYTE(S) ON WORD                   11040000
A00013   EQU   MSSGE56I+00000000   4 BYTE(S)                            11050000
MSG56I   EQU   MSSGE56I+00000004   47 BYTE(S)                           11060000
MSSGE62I EQU   00000000            60 BYTE(S) ON WORD                   11070000
A00014   EQU   MSSGE62I+00000000   4 BYTE(S)                            11080000
MSG62I   EQU   MSSGE62I+00000004   56 BYTE(S)                           11090000
WTORLIST EQU   @DATA+00000328      8 BYTE(S) ON WORD                    11100000
         ORG   WTORLIST+00000000                                        11110000
REPLYLEN EQU   *                   1 BYTE(S)                            11120000
         DC    X'03'                                                    11130000
REPLYADR EQU   *                   3  BYTE  POINTER ON WORD+1           11140000
         DC    AL3(REPBUF)                                              11150000
ECBADDR  EQU   *                   FULLWORD POINTER                     11160000
         DC    AL4(ECB)                                                 11170000
DDNAME   EQU   *                   16*10 BYTE(S)                        11180000
         DC    00016X'00000000000000000000'                             11190000
WORKAREA EQU   @DATA+00000496      140 BYTE(S) ON DWORD                 11200000
DSCBDATA EQU   WORKAREA+00000000   96 BYTE(S)                           11210000
A00015   EQU   WORKAREA+00000000   63 BYTE(S)                           11220000
LOWLIMIT EQU   WORKAREA+00000063   4 BYTE(S)                            11230000
UPLIMIT  EQU   WORKAREA+00000067   4 BYTE(S)                            11240000
DEVENTRY EQU   00000000            56 BYTE(S) ON WORD                   11250000
EBCDICAD EQU   DEVENTRY+00000000   8 BYTE(S)                            11260000
UCBADDR  EQU   DEVENTRY+00000008   4 BYTE(S)                            11270000
UCBPTR   EQU   DEVENTRY+00000008   4  BYTE  POINTER                     11280000
FLAG1    EQU   DEVENTRY+00000012   1 BYTE(S)                            11290000
DEVSTAT  EQU   DEVENTRY+00000012   1 BIT(S)                             11300000
PRIMARY  EQU   DEVENTRY+00000012   1 BIT(S)                             11310000
DPDONE   EQU   DEVENTRY+00000012   1 BIT(S)                             11320000
EXIOACT  EQU   DEVENTRY+00000012   1 BIT(S)                             11330000
ALLOCATE EQU   DEVENTRY+00000012   1 BIT(S)                             11340000
GRABBED  EQU   DEVENTRY+00000012   1 BIT(S)                             11350000
FPMODE   EQU   DEVENTRY+00000012   1 BIT(S)                             11360000
LSTACSEC EQU   DEVENTRY+00000012   1 BIT(S)                             11370000
FLAG2    EQU   DEVENTRY+00000013   1 BYTE(S)                            11380000
DSNAMEFF EQU   DEVENTRY+00000013   1 BIT(S)                             11390000
SHARED   EQU   DEVENTRY+00000013   1 BIT(S)                             11400000
CEVOLUME EQU   DEVENTRY+00000013   1 BIT(S)                             11410000
STDLABEL EQU   DEVENTRY+00000013   1 BIT(S)                             11420000
A00024   EQU   DEVENTRY+00000013   1 BIT(S)                             11430000
BYPASSFI EQU   DEVENTRY+00000013   1 BIT(S)                             11440000
CEDEFI   EQU   DEVENTRY+00000013   1 BIT(S)                             11450000
ATTNINFI EQU   DEVENTRY+00000013   1 BIT(S)                             11460000
FLAG3    EQU   DEVENTRY+00000014   1 BYTE(S)                            11470000
FLAG4    EQU   DEVENTRY+00000015   1 BYTE(S)                            11480000
EXTENTS  EQU   DEVENTRY+00000016   12 BYTE(S)                           11490000
STARTAD  EQU   DEVENTRY+00000016   6 BYTE(S)                            11500000
ENDAD    EQU   DEVENTRY+00000022   4 BYTE(S)                            11510000
NOTRKS   EQU   DEVENTRY+00000026   2 BYTE(S)                            11520000
NUMTRKS  EQU   DEVENTRY+00000026   2  BYTE  INTEGER                     11530000
A00025   EQU   DEVENTRY+00000028   2 BYTE(S)                            11540000
MSSAVE   EQU   DEVENTRY+00000030   1 BYTE(S)                            11550000
EXPOSURE EQU   DEVENTRY+00000031   1 BYTE(S)                            11560000
DEVAD    EQU   DEVENTRY+00000032   4 BYTE(S)                            11570000
CDSDSCRP EQU   DEVENTRY+00000036   4 BYTE(S)                            11580000
CDSBYCNT EQU   DEVENTRY+00000040   1 BYTE(S)                            11590000
CDSFLAGS EQU   DEVENTRY+00000041   1 BYTE(S)                            11600000
CDSFPM   EQU   DEVENTRY+00000041   1 BIT(S)                             11610000
CDSEXTMK EQU   DEVENTRY+00000042   2 BYTE(S)                            11620000
SYMNAME  EQU   DEVENTRY+00000044   8 BYTE(S)                            11630000
A00026   EQU   DEVENTRY+00000052   2 BYTE(S)                            11640000
ALCINDEX EQU   DEVENTRY+00000054   1  BYTE  POINTER                     11650000
A00027   EQU   DEVENTRY+00000055   1 BYTE(S)                            11660000
CNFGDATA EQU   00000000            4 BYTE(S) ON WORD                    11670000
CDSDEVAD EQU   CNFGDATA+00000000   4 BYTE(S)                            11680000
EXTNTS   EQU   00000000            16 BYTE(S) ON WORD                   11690000
BEGINAD  EQU   EXTNTS+00000000     8 BYTE(S)                            11700000
STRTAD   EQU   EXTNTS+00000000     6 BYTE(S)                            11710000
BBSTRT   EQU   EXTNTS+00000000     2 BYTE(S)                            11720000
CCHHSTRT EQU   EXTNTS+00000002     4 BYTE(S)                            11730000
ENDADDR  EQU   EXTNTS+00000008     8 BYTE(S)                            11740000
BBEND    EQU   EXTNTS+00000008     2 BYTE(S)                            11750000
CCHHEND  EQU   EXTNTS+00000010     4 BYTE(S)                            11760000
UCBFRMAT EQU   00000000            34 BYTE(S) ON WORD                   11770000
A00028   EQU   UCBFRMAT+00000000   3 BYTE(S)                            11780000
UCBFLAGS EQU   UCBFRMAT+00000003   1 BYTE(S)                            11790000
STATUS   EQU   UCBFRMAT+00000003   1 BIT(S)                             11800000
A00029   EQU   UCBFRMAT+00000004   12 BYTE(S)                           11810000
DESCRPTR EQU   UCBFRMAT+00000016   4 BYTE(S)                            11820000
A00030   EQU   UCBFRMAT+00000016   1 BYTE(S)                            11830000
FEATURES EQU   UCBFRMAT+00000017   8 BIT(S)                             11840000
CLASTYPE EQU   UCBFRMAT+00000018   2 BYTE(S)                            11850000
CLASS    EQU   UCBFRMAT+00000018   1 BYTE(S)                            11860000
TYPE     EQU   UCBFRMAT+00000019   1 BYTE(S)                            11870000
A00031   EQU   UCBFRMAT+00000020   8 BYTE(S)                            11880000
UCBVSER  EQU   UCBFRMAT+00000028   6 BYTE(S)                            11890000
         ORG   @DATA                                                    11900000
         DS    00000636C                                                11910000
@TEMPS   DS    0F                                                       11920000
ALOCDSCB CAMLST SEARCH,ALCU1PRM,ALCUAPRM,WORKAREA                YM7282 11930000
ALOCAT   IFDCOM                                                         11940000
         GLOBAL                                                         11950000
         ALOCAT MAP=YES                                                 11960000
ALOLEVL  EQU   $ALOLEVL                                                 11970000
ALOCADR  EQU   $ALOCADR                                                 11980000
ALOCDSA  EQU   $ALOCDSA                                                 11990000
ALOAMT   EQU   $ALOAMT                                                  12000000
ALOFLGT  EQU   $ALOFLGT                                                 12010000
ALOFLAG  EQU   $ALOFLAG                                                 12020000
ROPTMIN2 EQU   ROPT-00000002       2 BYTE(S)                            12030000
SVCPLIST EQU   ROPT+00000000       8 BYTE(S) ON WORD                    12040000
UCBADDRS EQU   SVCPLIST+00000000   4 BYTE(S)                            12050000
VOLSERPT EQU   SVCPLIST+00000004   FULLWORD POINTER                     12060000
SCT      EQU   CHASCT+00000000     12 BYTE(S) ON WORD                   12070000
A00000   EQU   SCT+00000000        10 BYTE(S)                           12080000
FLAGS    EQU   SCT+00000010        1 BYTE(S)                            12090000
A00001   EQU   SCT+00000010        1 BIT(S)                             12100000
FILEPROT EQU   SCT+00000010        1 BIT(S)                             12110000
A00002   EQU   SCT+00000011        1 BYTE(S)                            12120000
FPMODCDS EQU   SCT+00000011        1 BIT(S)                             12130000
OLTEPSW2 EQU   CESWT2+00000000     1 BYTE(S)                            12140000
A00016   EQU   OLTEPSW2+00000000   5 BIT(S)                             12150000
NDR      EQU   OLTEPSW2+00000000   1 BIT(S)                             12160000
OLTEPSW3 EQU   CESWT3+00000000     1 BYTE(S)                            12170000
A00017   EQU   OLTEPSW3+00000000   2 BIT(S)                             12180000
BYPTST   EQU   OLTEPSW3+00000000   1 BIT(S)                             12190000
OLTEPSW6 EQU   CESWT6+00000000     1 BYTE(S)                            12200000
A00018   EQU   OLTEPSW6+00000000   7 BIT(S)                             12210000
STAEXIT  EQU   OLTEPSW6+00000000   1 BIT(S)                             12220000
A00019   EQU   CESWTR+00000000     1 BYTE(S)                            12230000
RETAINAC EQU   A00019+00000000     1 BIT(S)                             12240000
A00020   EQU   A00019+00000000     1 BIT(S)                             12250000
REMNOMSG EQU   A00019+00000000     1 BIT(S)                             12260000
A00021   EQU   A00019+00000000     5 BIT(S)                             12270000
A00022   EQU   CESWTR2+00000000    1 BYTE(S) ON WORD                    12280000
A00023   EQU   A00022+00000000     7 BIT(S)                             12290000
DPMSGREI EQU   A00022+00000000     1 BIT(S)                             12300000
@DATEND  EQU   *                                                        12310000
@9FC     EQU   ALOCAT52                                                 12320000
@9F4     EQU   ALOCAT10                                                 12330000
@DO9F8   EQU   ALOCAT52                                                 12340000
@9EE     EQU   ALOCAT52                                                 12350000
@9ED     EQU   ALOCAT52                                                 12360000
@9EB     EQU   ALOCAT50                                                 12370000
@9EA     EQU   ALOCAT52                                                 12380000
@9E9     EQU   ALOCAT52                                                 12390000
@9E8     EQU   ALOCAT52                                                 12400000
@9D9     EQU   ALOCAT51                                                 12410000
@9D8     EQU   ALOCAT51                                                 12420000
@9D7     EQU   ALOCAT51                                                 12430000
         END                                                            12440000
