         TITLE 'IFDOLT31 DEVICE DECODE'                                 00010000
         TITLE 'IFDOLT31 DEVICE DECODE'                                 00020000
         LCLA  &T,&SPN                                            0002  00030000
.@001    ANOP                                                     0002  00040000
IFDOLT31 CSECT ,                                                  0002  00050000
         BC    15,24(0,@F)                                              00060000
         DC    C'IFDOLT31 05 DEC 75'                             0002  00070000
         STM   @E,@C,12(@D)                                       0002  00080000
         BALR  @B,0                                               0002  00090000
@PSTART  DS    0H                                                 0002  00100000
         USING @PSTART+00000,@B                                   0002  00110000
         ST    @D,@SAV001+4                                       0002  00120000
         LA    @F,@SAV001                                         0002  00130000
         ST    @F,8(0,@D)                                         0002  00140000
         LR    @D,@F                                              0002  00150000
*         GEN(USING CHASCT,2);                                          00160000
         USING CHASCT,2                                                 00170000
         DS    0H                                                       00180000
*         GENERATE DATA;                                                00190000
*         /************************************************************ 00200000
*         /*                                                    X03906* 00210000
*         /*                        REGISTERS                         * 00220000
*         /*                                                    X03906* 00230000
*         /************************************************************ 00240000
*         DCL R0 REG(0) PTR(31);         /* REGISTER 0.               * 00250000
*         DCL R1 REG(1) PTR(24);         /* REGISTER 1.               * 00260000
*         DCL R2 REG(2) PTR(31);         /* REGISTER 2.               * 00270000
*         DCL R3 REG(3) PTR(31);         /* REGISTER 3.               * 00280000
*         DCL I REG(3) PTR(31);          /* REGISTER 3.               * 00290000
*         DCL R4 REG(4) PTR(31);         /* REGISTER 4.               * 00300000
*         DCL R5 REG(5) PTR(31);         /* REGISTER 5.               * 00310000
*         DCL R7 REG(7) PTR(31);         /*                     X03008* 00320000
*         DCL GOODENT REG(6) PTR(24);    /* GOOD DEV ADDRS ENTERED    * 00330000
*         DCL UCBLOOK REG(7) PTR(24);    /* DEVS NEEDING UCB LOOKUPS  * 00340000
*         DCL R8 REG(8) PTR(31);         /* REGISTER 8.         X03008* 00350000
*         DCL DEVTABPT REG(8) PTR(31);   /* REGISTER 8.               * 00360000
*         DCL R9 REG(9) PTR(24);         /* REGISTER 9.               * 00370000
*         DCL Z REG(10) PTR(24);         /*                     X03008* 00380000
*         DCL R13 REG(13) PTR(31);       /* REGISTER 13.              * 00390000
*         DCL R14 REG(14) PTR(31);       /* REGISTER 14.              * 00400000
*         DCL RC REG(15) PTR(31);        /* REGISTER 15.              * 00410000
*         DCL R15 REG(15) PTR(31);       /* REGISTER 15.              * 00420000
*         /************************************************************ 00430000
*         /*                                                    X03906* 00440000
*         /*                       SAVE AREAS                         * 00450000
*         /*                                                    X03906* 00460000
*         /************************************************************ 00470000
*         DCL 1 MYSAVE BASED(R13),       /*---MY SAVE AREA FORMAT-----* 00480000
*               3 * CHAR(4),             /* NOT LOOKED AT.            * 00490000
*               3 YOURR13 PTR(31);       /* CALLER SAVE AREA ADDRESS. * 00500000
*         DCL 1 YOURSAVE BASED(YOURR13), /* CALLERS SAVE AREA FORMAT. * 00510000
*               3 * CHAR(12),            /* NOT NEEDED.               * 00520000
*               3 YOURR14 PTR(31);       /* CALLERS RETURN POINT.     * 00530000
*         /************************************************************ 00540000
*         /*                                                    X03906* 00550000
*         /*                  SECTION CONTROL TABLE                   * 00560000
*         /*                                                    X03906* 00570000
*         /************************************************************ 00580000
*         DCL CHASCT CHAR(88) GENERATED;                                00590000
*         DCL 1 SCT BASED(ADDR(CHASCT)), /*--------SCT FORMAT---------* 00600000
*               3 HEADER CHAR(8),        /* HEADER.                   * 00610000
*               3 PRIDVSCT CHAR(12);     /* PRIMARY DEVICE ENTRY.     * 00620000
*         /************************************************************ 00630000
*         /*                                                    X03906* 00640000
*         /*                       INPUT BUFFER                       * 00650000
*         /*                                                    X03906* 00660000
*         /************************************************************ 00670000
*         DCL INBUFR CHAR(120) GENERATED;                               00680000
*         DCL INPUTBUF CHAR(10) BASED(R5); /* INPUT BUFFER      21050 * 00690000
*         DCL INBUFPTR PTR(31) GENERATED;/* POINTER TO SLASH DELIMITER* 00700000
*         /************************************************************ 00710000
*         /*                                                    X03906* 00720000
*         /*                        SWITCHES                          * 00730000
*         /*                                                    X03906* 00740000
*         /************************************************************ 00750000
*         DCL CESWT CHAR(1) GENERATED;                                  00760000
*         DCL 1 OLTEPSW BASED(ADDR(CESWT)),/*-----CESWT FORMAT--------* 00770000
*               3 * BIT(4),              /* NOT LOOKED AT.            * 00780000
*               3 LEGALDEV BIT(1),       /* LEGAL DEVICE FLAG.        * 00790000
*               3 REINT BIT(1);          /* RE-INITIALIZE FLAG.       * 00800000
*         DCL CESWT2 CHAR(1) GENERATED;                                 00810000
*         DCL 1 OLTEPSW2 BASED(ADDR(CESWT2)),/*---CESWT2 FORMAT-------* 00820000
*               3 * BIT(3),              /* NOT LOOKED AT.            * 00830000
*               3 CHANTEST BIT(1),       /* CHANNEL TEST FLAG.        * 00840000
*               3 * BIT(1),              /* NOT LOOKED AT.            * 00850000
*               3 NDR BIT(1);            /* NO DEVICE REQUIRED FLAG.  * 00860000
*         DCL CESWT7 CHAR(1) GENERATED;  /*---CESWT7 FORMAT------21050* 00870000
*         DCL  1 OLTEPSW7 BASED(ADDR(CESWT7)), /* C E SWT FORMAT.21050* 00880000
*                3 INCLST BIT(1), /* INCLUSIVE SERIES OF DEVICESX03906* 00890000
*                3 RETTO31 BIT(1), /* NEED TO RET TO IFDOLT31.  X03906* 00900000
*                3 REMOTE BIT(1),  /* REMOTE TERMINAL IN SYSTEM.X03906* 00910000
*                3 LOADCDS BIT(1); /* LOAD CDS FROM REM FILE    X03906* 00920000
*         DCL CESWT9 CHAR(1) GENERATED;  /* CESWT9 IN COMM AREA X03008* 00930000
*         DCL 1 OLTEPSW9 BASED(ADDR(CESWT9)), /* CESWT9 FORMAT  X03008* 00940000
*               3 * BIT(5),        /* NOT LOOKED AT             X03008* 00950000
*               3 MIXDEV BIT(1),   /* CHECK DEV ENTRY  SYM      X03008* 00960000
*               3 * BIT(2);        /* NOT LOOKED AT             X03008* 00970000
*         DCL CESWTR CHAR(1) GENERATED;  /*                      20203* 00980000
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR)),  /*               20203* 00990000
*               3 RETAINAC BIT(1),       /* REI ACTIVE FLAG      S20203 01000000
*               3 * BIT(1),              /*                      S20203 01010000
*               3 REMNOMSG BIT(1),       /* REMOTE NO MSG        S20203 01020000
*               3 * BIT(5);              /*                      S20203 01030000
*         DCL CESWTR1 CHAR(1) GENERATED; /*                      21050* 01040000
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR1)),  /*              21050* 01050000
*               3 * BIT(5),              /*                      21050* 01060000
*               3 REMANS BIT(1),         /* REMOTE ANSWERS       21050* 01070000
*               3 * BIT(2);              /*                      21050* 01080000
*         DCL CESWTR2 CHAR(1) GENERATED; /* REI SWITCHES         20203* 01090000
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR2)), /*               20203* 01100000
*               3 * BIT(2),              /*                      20203* 01110000
*               3 ONCOMM BIT(1),         /* ONSITE DYN COMM      S20203 01120000
*           3 * BIT(4),                                                 01130000
*           3 DPMSGREI BIT(1);          /* DATA PROT MSG        YM2273* 01140000
*         /************************************************************ 01150000
*         /*                                                    X03906* 01160000
*         /*                   SVC PARAMETER LIST                     * 01170000
*         /*                                                    X03906* 01180000
*         /************************************************************ 01190000
*         DCL ROPT CHAR(8) GENERATED;                                   01200000
*         DCL 1 SVCPLIST BASED(ADDR(ROPT)-4),/*--FORMAT-SVC PLIST-----* 01210000
*               3 * CHAR(2),             /* NOT USED.                 * 01220000
*               3 MODNUM CHAR(2),        /* NAME OF CALLING MODULE.   * 01230000
*               3 ADDRDEV PTR(31),       /* BEGIN ADDR FOR UCBLOOK UP.* 01240000
*               3 ENTRIES FIXED(31),     /* NUMBER OF LOOK UPS  X03008* 01250000
*               3 SVCSAPTR PTR(31);      /* ADDR OF S.A. FOR 59 X03008* 01260000
*         /************************************************************ 01270000
*         /*                                                    X03906* 01280000
*         /*                FORMAT OF DEVTABLE ENTRY                  * 01290000
*         /*                                                    X03906* 01300000
*         /************************************************************ 01310000
*         DCL DEVTBPTR PTR GEND;   /* POINTER TO DEVICE TABLES   21050* 01320000
*         DCL 1 DEVTABXX CHAR(56)  BASED(DEVTABPT), /*           21050* 01330000
*               3 DEVADDR CHAR(8),       /* EBCDIC DEVICE ADDR   21050* 01340000
*               3 UCBADDR PTR(31),       /* UCB ADDRESS.              * 01350000
*               3 FLG1 CHAR(1),          /* FIRST FLAG FIELD.         * 01360000
*                 5 ONOFF BIT(1),        /* DEVICE STATUS FLAG.       * 01370000
*                 5 PRIMARY BIT(1),      /* PRIMARY DEVICE FLAG.      * 01380000
*               3 * CHAR(1),             /* SECOND FLAG FIELD.  YM7253* 01390000
*               3 FLG3 CHAR(1),          /* 3RD FLAG FEILD      YM7253* 01400000
*                 5 * BIT(4),            /* NOT LOOKED AT       YM7253* 01410000
*                 5 NOGODEV BIT(1),      /* DEV INUSE OR NOTAVAIYM7253* 01420000
*                 5 SYSALLOC BIT(1),       /* DEV ALLOC       @ZA06048* 01430000
*                 5 * BIT(2),              /* NOT LOOKED AT   @ZA06048* 01440000
*               3 FLG4 CHAR(1),          /* 4TH FLAG FEILD      Y02008* 01450000
*                 5 *    BIT(4),         /* NOT LOOKED AT       Y02008* 01460000
*                 5 DEVVAR BIT(1),       /* OLTEP VARIED DEV OFFLINE  * 01470000
*                 5 DEVENQNG BIT(1),     /* OLTEP ENQ OF DEV FAILED   * 01480000
*                 5 *    BIT(2),         /* NOT LOOKED AT       Y02008* 01490000
*               3 * CHAR(16),            /* EXTENTS OR TAPE LABEL     * 01500000
*                                        /* SAVE AREA.                * 01510000
*               3 HEXADDR CHAR(4),       /* DEV ADDR IN HEX      21050* 01520000
*               3 CDSDVDSC CHAR(4),      /* CDS DEVICE DSCRPTRS  21050* 01530000
*                 5 MODEL CHAR(1), /* MODEL OF DEVICE.           21050* 01540000
*                 5 FEATURES CHAR(1), /* DEVICE FEATURES.        21050* 01550000
*                 5 CLASS CHAR(1), /* DEVICE CLASS.              21050* 01560000
*                 5 TYPE CHAR(1),  /* DEVICE TYPE.               21050* 01570000
*               3 BYTECNT CHAR(1), /* CDS BYTE COUNT.            21050* 01580000
*               3 CDSFLAGS CHAR(1), /* CDS FLAG BYTE             21050* 01590000
*                 5 * BIT(4),      /* NOT NEEDED HERE.           21050* 01600000
*                 5 SYMDEVIC BIT(1), /* SET IF SYMBOLIC DEVICE.  21050* 01610000
*                 5 * BIT(2),      /*                            21050* 01620000
*                 5 REMLINE BIT(1),/* SET IF REMOTE LINE NEEDS TO     * 01630000
*                             /*   BE ENABLED FOR REMOTE TESTING 21050* 01640000
*               3 EXTSGMSK CHAR(2),/* EXGERNAL SIGNAL MASK       21050* 01650000
*               3 SYMNAME CHAR(8); /* SYMBOLICALLY NAMED ENTRY.  21050* 01660000
*         /************************************************************ 01670000
*         /*                                                    X03906* 01680000
*         /*                        MESSAGES                          * 01690000
*         /*                                                    X03906* 01700000
*         /************************************************************ 01710000
*         DCL IFDMSG31 LABEL NONLOCAL EXTERNAL;                         01720000
*         DCL 1 MSGPTR BASED(R4),        /*-----MESSAGE POINTERS------* 01730000
*               3 MSGPTR08 PTR(31),      /* POINTER TO MESSAGE IFD108I* 01740000
*               3 MSGPTR11 PTR(31),      /* POINTER TO MESSAGE IFD111I* 01750000
*               3 MSGPTR79 PTR(31),      /* POINTER TO MESSAGE IFD127I* 01760000
*               3 MSGPTR61 PTR(31),      /* POINTER TO MESSAGE IFD161I* 01770000
*               3 MSGPTR27 PTR(31),      /* PTR TO MSG IFD127I  X03008* 01780000
*               3 MSGPTR65 PTR(31),      /* PTR TO MSG IFD165I  X03008* 01790000
*               3 MSGPTR51 PTR(31),      /* PTR TO MSG IFD251I  X03008* 01800000
*               3 MSGPTR52 PTR(31),      /* PTR TO MSG IFD252I  X03008* 01810000
*               3 MSGPTR14 PTR(31),      /* PTR TO MSG IFD140I  Y02008* 01820000
*               3 MSGPTR19 PTR(31),      /* PTR TO MSG IFD109I  Y02008* 01830000
*               3 MSGPTR67 PTR(31);      /* PTR TO MSG IFD467I  YM7253* 01840000
*         DCL 1 MSG108 BASED(R1),        /* MESSAGE IFD108I FORMAT.   * 01850000
*               3 * CHAR(12),            /* NOT LOOKED AT.            * 01860000
*               3 MSG108I CHAR(28);      /* MESSAGE TEXT.             * 01870000
*         DCL 1 MSG140 BASED(R1),        /* MESSAGE IFD140I FORMAT.   * 01880000
*               3 * CHAR(12),            /* NOT LOOKED AT.            * 01890000
*               3 MSG140DV CHAR(8);      /* MESSAGE TEXT.             * 01900000
*         DCL 1 MSG467 BASED(R1),        /* MESSAGE IFD467I FORMYM7253* 01910000
*               3 * CHAR(12),            /* NOT LOOKED AT.      YM7253* 01920000
*               3 MSG467DV CHAR(8);      /* MESSAGE TEXT.       YM7253* 01930000
*         DCL 1 MSG190 BASED(R1),        /* MESSAGE IFD109I FORMAT.   * 01940000
*               3 * CHAR(12),            /* NOT LOOKED AT.            * 01950000
*               3 MSG109DV CHAR(8),        /* FORMAT FOR 109  @ZA06048* 01960000
*               3 * CHAR(1),               /*                 @ZA06048* 01970000
*               3 ONOROFF CHAR(8),         /* ON OR OFF LINE  @ZA06048* 01980000
*               3 ALORNOT CHAR(11);        /* ALLOCATED?      @ZA06048* 01990000
*         DCL 1 MSG179 BASED(R1),        /* MESSAGE IFD127I FORMAT.   * 02000000
*               3 * CHAR(12),            /* NOT LOOKED AT.              02010000
*               3 MSG179I CHAR(27);      /* MESSAGE TEXT.        21050* 02020000
*         DCL 1 MSG127 BASED(R1),                                       02030000
*           3 * CHAR(12),                                               02040000
*           3 MSG127I CHAR(19);                                         02050000
*         /************************************************************ 02060000
*         /*                                                    X03906* 02070000
*         /*            OTHER COMMON AREA CONSTANTS USED              * 02080000
*         /*                                                    X03906* 02090000
*         /************************************************************ 02100000
*         DCL DIEPTR PTR(31) GENERATED;  /* POINTER TO DIE IN CAY02008* 02110000
*         DCL UNICTR CHAR(1) GENERATED;  /* UNIT COUNTER.             * 02120000
*         DCL REDEFINE PTR(31) GENERATED;/* RETURN POINT TO REDEFINE  * 02130000
*                                        /* TEST DEFINITION.          * 02140000
*         DCL UNITUSE CHAR(1) GENERATED; /* UNIT USED COUNTER.        * 02150000
*         DCL NEXTREC PTR(31) GENERATED; /* RETURN POINT TO READ NEXT * 02160000
*                                        /* RECORD.                   * 02170000
*         DCL TAB28 PTR(31) GENERATED;   /* NEW MACRO ENTRY POINT.    * 02180000
*         DCL TABLNGTH PTR(15) GENERATED;/* INDEX VALUE FOR TAB X03008* 02190000
*         /************************************************************ 02200000
*         /*                                                    X03906* 02210000
*         /*                   INTERNAL CONSTANTS                     * 02220000
*         /*                                                    X03906* 02230000
*         /************************************************************ 02240000
*         DCL 1 * BASED(R8),             /* DEVICE TABLE        X03008* 02250000
*                3 DVT CHAR(16),         /* TABLE AREA          X03008* 02260000
*                3 DVTN CHAR(16);        /* NEXT TABLE AREA     X03008* 02270000
*         DCL SUM PTR(24);               /*                     X03008* 02280000
*         DCL SAVLOOKT PTR(24);          /*                     X03008* 02290000
*         DCL 1 PARMLIST CHAR(16) BDY(WORD),                            02300000
*           3 MODNAME CHAR(8),                                          02310000
*             5 TCDSO CHAR(1) INIT('G'),                                02320000
*             5 CDSDEV CHAR(7),                                         02330000
*           3 TARGETAD PTR,                                             02340000
*           3 PARMFLGS CHAR(1),                                         02350000
*           3 * CHAR(1),                                                02360000
*           3 CDSLNGTH FIXED(15);                                       02370000
*         DCL COUNT REG(7) PTR(31);                                     02380000
*         DCL CNVRT1 CHAR(14) GENERATED; /* FIRST CONVERT PARMLIST.   * 02390000
*         DCL CNVRT2 CHAR(14) GENERATED; /* SECOND CONVERT PARMLIST.  * 02400000
*         DCL CNVRT3 CHAR(14) GENERATED; /* THIRD CONVERT PARMLIST.   * 02410000
*         DCL AVAILBLE PTR(31);          /* POINTER TO NEXT AVAILABLE * 02420000
*                                        /* ENTRY IN DEVTABLE.        * 02430000
*         DCL DEVTABLE CHAR(56) BASED(AVAILBLE); /*              21050* 02440000
*         DCL 1 DEVAREA CHAR(16),           /* DEVICE AREA      X03906* 02450000
*               3 FSTDEV FIXED(31),      /* FIRST DEVICE IN A SERIES. * 02460000
*                 5 FSTDEV2 CHAR(4), /* CONVERT AREA FOR EBCDIC  21050* 02470000
*                   7 HEX CHAR(4),       /* DEVICE ADDRESS.      21050* 02480000
*               3 FINDEV FIXED(31),      /* FINAL DEVICE IN A SERIES. * 02490000
*                 5 FINDEV2 CHAR(4); /* FINAL DEV ADDR IN HEX.   21050* 02500000
*         DCL LOOPPTR PTR(31);           /* INDEXED TABLE PTR   X03008* 02510000
*         DCL 1 * CHAR(56) BASED(LOOPPTR), /* DEVICE TBL OVERLAYX03008* 02520000
*               3 * CHAR(32),            /* NOT LOOKED AT       X03008* 02530000
*               3 HXADDR CHAR(4),        /* DEVICE ADDRESS      X03008* 02540000
*               3 * CHAR(8),             /* NOT LOOKED AT       X03008* 02550000
*               3 SYMBNM CHAR(8);        /* DEVICE SYMB NAME    X03008* 02560000
*         DCL  NEWADDR CHAR(4);          /* HOLD AREA FOR SCAN  X03008* 02570000
*         DCL LIMIT FIXED(15);           /* LIMIT OF UCB LOOK UPS     * 02580000
*                                        /* THAT CAN BE PERFORMED.    * 02590000
*         DCL 1 X FIXED(15),             /* COUNTER & WORK AREA.      * 02600000
*               3 UNITCTR FIXED(15),                                    02610000
*                 5 * CHAR(1),                                          02620000
*                 5 UNITCTR1 CHAR(1);                                   02630000
*         DCL ERRCODE CHAR(2);           /* ERROR CODE.               * 02640000
*         DCL NUMBERS CHAR(16)           /* VALID NUMBERS.            * 02650000
*              INITIAL('0123456789ABCDEF');                             02660000
*         DCL NUMBER CHAR(1) BASED(R9);                                 02670000
*         DCL 1 DEVAD CHAR(8) INIT('0000'),/* CONVERT FROM AREA. 21050* 02680000
*               3 DEVAD1 CHAR(8);                              /*21050* 02690000
*         DCL 1 SWITCHES CHAR(1),        /* FLAGS.                    * 02700000
*               3 FRSTPASS BIT(1);       /* FIRST PASS FLAG.          * 02710000
*                                        /* FLAG.                     * 02720000
*         DCL UCBDVDSC CHAR(4) BASED(UCBADDR+16); /* UCB DEV DSSC21050* 02730000
*      DCL 1  CDSENTRY CHAR(20) BASED(R1),  /* CDS ENTRY LOADED  21050* 02740000
*               3 * CHAR(4),             /* DEVICE ADDRESS.           * 02750000
*               3 DSCRPTRS CHAR(4);/* CDS DEV DSCRPTRS           21050* 02760000
*         DCL CHARCNTR FIXED(15);  /* COUNTS CHARS IN ADDRESS    21050* 02770000
*         DCL EIGHT FIXED(15) INIT(8);  /* CONSTANT USED IN BUFR 21050* 02780000
*         DCL BLANKFLD CHAR(8) INIT((8)' ');                            02790000
*         DCL SYMNAM   CHAR(8);    /* HOLDS SYMBOLIC NAME  ENTRY 21050* 02800000
*         DCL IGNORE FIXED(15);    /* ADDRESS FIELD NOT APPLICABLE21050 02810000
*         DCL SAVENT  FIXED(31) GEND;    /* SAV DEV IN INCLSV SER.21050 02820000
*         DCL OFLGS BIT(8) BASED(R9+48); /* CHECK FOR OPENED CDS 21051* 02830000
*                                                                       02840000
*         /*  BYTE IN DCB IS ZERO FOR DUMMY DD CARDS             01906* 02850000
*         DCL DDDUMMY CHAR(1) BASED(R9+17);                             02860000
*                                                                       02870000
*         DCL SYMPTR PTR GEND;                                          02880000
*         RESTRICT(1,2,3,4,5,6,7,8,9,10);                     /*X03008* 02890000
*         /************************************************************ 02900000
*         /*                                                          * 02910000
*         /*                   PERFORM INITIALIZATION                 * 02920000
*         /*                                                          * 02930000
*         /************************************************************ 02940000
*         R4=ADDR(IFDMSG31);        /* GET POINTER TO MESSAGE MODULE. * 02950000
         L     @C,@V1              ADDRESS OF IFDMSG31            0097  02960000
         LR    @4,@C                                              0097  02970000
*         R5=INBUFPTR;              /* GET POINTER TO INPUT BUFFER.   * 02980000
         L     @5,INBUFPTR                                        0098  02990000
*         /************************************************************ 03000000
*         /*                                                    X03906* 03010000
*         /*   IF RETAIN/370 INTERFACE IS ACTIVE, CHECK TO SEE WHO    * 03020000
*         /*   ANSWERED. ISSUE MSG IFD165I IF REMOTE SPECIALIST DID.  * 03030000
*         /*                                                    X03906* 03040000
*         /************************************************************ 03050000
*         IF RETAINAC='0'B THEN    /* IS RETAIN INACTIVE.        21050* 03060000
         TM    A00007,B'10000000'                                 0099  03070000
*           GO TO INITIAL;         /* YES, CONT INITIALIZATION.  21050* 03080000
         BC    08,INITIAL                                         0100  03090000
*         IF INPUTBUF(1:2)='.N' THEN /* REMOTE CAN ANS NDR OR '/'21050* 03100000
         CLC   0(2,@5),@C2                                        0101  03110000
*           GO TO INITIAL;         /* CONTINUE ONITIALIZATION.   21050* 03120000
         BC    08,INITIAL                                         0102  03130000
*         IF INPUTBUF(1)='/' THEN  /*       SLASH ENTERED        21050* 03140000
         CLI   0(@5),C'/'                                         0103  03150000
*           GO TO INITIAL;         /* CONTINUE ONITIALIZATION.   21050* 03160000
         BC    08,INITIAL                                         0104  03170000
*         IF ONCOMM='1'B THEN      /* ONSITE DYN COMM           X03906* 03180000
         TM    A00013,B'00100000'                                 0105  03190000
*           GO TO INITIAL;         /* BYPASS ERROR MSG           21050* 03200000
         BC    01,INITIAL                                         0106  03210000
*         R1=MSGPTR65;             /* MSG PTR FOR IFD165I       X03906* 03220000
         L     @1,20(0,@4)                                        0107  03230000
*         GEN(PWTO REG=(1));       /* PRINT ERROR MESSAGE       X03906* 03240000
         PWTO REG=(1)                                                   03250000
         DS    0H                                                       03260000
*         GO TO CECDEV47;          /* RETURN TO REDEFINE        X03906* 03270000
         BC    15,CECDEV47                                        0109  03280000
* INITIAL:                                                    /*X03906* 03290000
*         IF RETAINAC='1'B THEN    /* IS REI ACTIVE?            X03906* 03300000
INITIAL  TM    A00007,B'10000000'                                 0110  03310000
         BC    12,@9FF                                            0110  03320000
*           DPMSGREI='1'B;              /* NO REPLY FROM REI    XM9156* 03330000
         OI    A00013,B'00000001'                                 0111  03340000
*         DEVAREA=DEVAREA&&DEVAREA; /* CLEAR FSTDEV AND FINDEV.       * 03350000
@9FF     XC    DEVAREA(16),DEVAREA                                0112  03360000
*         UCBLOOK=0;                /* INITIALIZE UCB LOOK UP COUNTER * 03370000
         SR    @7,@7                                              0113  03380000
*                                   /* TO ZERO.                       * 03390000
*         CHARCNTR=0;              /* INITIALIZE CHAR COUNTER    21050* 03400000
         SR    @F,@F                                              0114  03410000
         STH   @F,CHARCNTR                                        0114  03420000
*         IF RETTO31='1'B THEN DO; /* IS THIS RETURN FROM SECOND 21050* 03430000
         TM    OLTEPSW7,B'01000000'                               0115  03440000
         BC    12,@9FE                                            0115  03450000
*           GOODENT=UNICTR;        /* HALF OF DEVICE DECODE MOD. 21050* 03460000
         SR    @6,@6                                              0117  03470000
         IC    @6,UNICTR                                          0117  03480000
*           DEVTABPT=DEVTBPTR+(UNICTR*TABLNGTH);                        03490000
         LH    @F,TABLNGTH                                        0118  03500000
         SR    @0,@0                                              0118  03510000
         IC    @0,UNICTR                                          0118  03520000
         MR    @E,@0                                              0118  03530000
         A     @F,DEVTBPTR                                        0118  03540000
         LR    @8,@F                                              0118  03550000
*                                        /* INIT PTRS AND CNTRS X03008* 03560000
*           FRSTPASS='1'B;         /* INIT FIRST PASS THRU COUNTER21050 03570000
         OI    SWITCHES,B'10000000'                               0119  03580000
*           AVAILBLE=DEVTABPT;     /* LOCATE NEXT AVAIL TABLE.   21050* 03590000
         ST    @8,AVAILBLE                                        0120  03600000
*           LIMIT=16-UNICTR;       /* REINIT AVAIL TABLE LIMIT.  21050* 03610000
         LA    @F,16                                              0121  03620000
         IC    @0,UNICTR                                          0121  03630000
         SR    @F,@0                                              0121  03640000
         STH   @F,LIMIT                                           0121  03650000
*         IF INCLST='1'B THEN DO;  /* IS INCLUSIVE SERIES OF     21050* 03660000
         TM    OLTEPSW7,B'10000000'                               0122  03670000
         BC    12,@9FD                                            0122  03680000
*           FSTDEV=SAVENT;         /* DEVICES ENTERED. YES% THEN 21050* 03690000
         MVC   DEVAREA(4),SAVENT                                  0124  03700000
*           GO TO CECDEV39;        /* REINIT LAST DEV USED, CONT. 21050 03710000
         BC    15,CECDEV39                                        0125  03720000
*           END;                   /* INCLUSIVE DEVICE SEARCH.   21050* 03730000
*         GO TO CECDEV19;          /* CHECK FOR DELIMETER.       21050* 03740000
*           END;                                                        03750000
*         GOODENT=0;                /* INITIALIZE VALID ENTRIES       * 03760000
@9FE     SR    @6,@6                                              0129  03770000
*                                   /* COUNTER TO ZERO.               * 03780000
*         DEVTABPT=DEVTBPTR;       /* INITIALIZE DEVICE TABLE PTR21050* 03790000
         L     @8,DEVTBPTR                                        0130  03800000
*         AVAILBLE=DEVTABPT;        /* GET POINTER TO NEXT AVAILABLE  * 03810000
         ST    @8,AVAILBLE                                        0131  03820000
*                                   /* ENTRY IN DEVTABLE.             * 03830000
*         INCLST='0'B;              /* SET INCLST FLAG OFF.           * 03840000
         NI    OLTEPSW7,B'01111111'                               0132  03850000
*         FRSTPASS='0'B;            /* INITIALIZE FIRST PASS FLAG.    * 03860000
         NI    SWITCHES,B'01111111'                               0133  03870000
*         NDR='0'B;                 /* SET NDR FLAG OFF.              * 03880000
         NI    OLTEPSW2,B'11111011'                               0134  03890000
*         LIMIT=16;                 /* INITIALIZE LIMIT TO 16.        * 03900000
         LA    @F,16                                              0135  03910000
         STH   @F,LIMIT                                           0135  03920000
*         REINT='1'B;               /* SET REINT FLAG ON.             * 03930000
         OI    OLTEPSW,B'00000100'                                0136  03940000
*                                                                       03950000
*         /************************************************************ 03960000
*         /*                                                          * 03970000
*         /*          IS ' .NDR ' ENTERED?                      X02906* 03980000
*         /*                                                          * 03990000
*         /************************************************************ 04000000
* CECDEV00:                                                             04010000
*         IF INPUTBUF(1)='.' THEN       /* IS .NDR SPECIFIED?   X02906* 04020000
CECDEV00 CLI   0(@5),C'.'                                         0137  04030000
         BC    07,@9FC                                            0137  04040000
*            DO;                   /* YES, THEN INCREMENT BUFFER 21050* 04050000
*            R5=R5+1;              /* TO NEXT CHAR.  ARE MORE    21050* 04060000
         AH    @5,@D1                                             0139  04070000
*            IF FRSTPASS='1'B THEN /* ENTRIES IN DEV FLD? CH,NDR 21050* 04080000
         TM    SWITCHES,B'10000000'                               0140  04090000
*              GO TO CECDEV41;     /*MUST BE ONLY ENTRIES.  MORE 21050* 04100000
         BC    01,CECDEV41                                        0141  04110000
*                                  /* ENTRIES INDICATE ERROR.    21050* 04120000
*            GO TO CECDEV27;       /* IF NOT, CHECK FOR CH,NDR   21050* 04130000
         BC    15,CECDEV27                                        0142  04140000
*            END;                  /*                            21050* 04150000
*                                                                       04160000
*         /************************************************************ 04170000
*         /*                                                          * 04180000
*         /*               SCAN ADDRESS CHARACTERS                    * 04190000
*         /*                                                          * 04200000
*         /************************************************************ 04210000
* CECDEV01:                        /*                            21050* 04220000
*         R3=ADDR(CECDEV05);       /* SAVE ADDR OF ALPHA CHECK   21050* 04230000
@9FC     EQU   *                                                  0144  04240000
CECDEV01 LA    @3,CECDEV05                                        0144  04250000
* CECDEV03:                        /*                            21050* 04260000
*         CHARCNTR=CHARCNTR+1;     /* NUM OF CHAR IN DEV ADDR.   21050* 04270000
CECDEV03 LA    @F,1                                               0145  04280000
         AH    @F,CHARCNTR                                        0145  04290000
         STH   @F,CHARCNTR                                        0145  04300000
*         R5=R5+1;                 /* MOVE TO NEXT ADDR CHAR.    21050* 04310000
         AH    @5,@D1                                             0146  04320000
*         IF CHARCNTR>8 THEN       /* ERROR IN DEV ENTRY IF MORE 21050* 04330000
         LA    @F,8                                               0147  04340000
         CH    @F,CHARCNTR                                        0147  04350000
*            GO TO CECDEV43;       /* THAN 8 CHARS ENTERED.      21050* 04360000
         BC    04,CECDEV43                                        0148  04370000
*         IF INPUTBUF(1)=','|      /* WHAT DELIMETER IS PRESENT? 21050* 04380000
*            INPUTBUF(1)='-'|      /*                            21050* 04390000
*            INPUTBUF(1)='/' THEN  /*                            21050* 04400000
         CLI   0(@5),C','                                         0149  04410000
         BC    08,@9FB                                            0149  04420000
         CLI   0(@5),C'-'                                         0149  04430000
         BC    08,@9FA                                            0149  04440000
         CLI   0(@5),C'/'                                         0149  04450000
         BC    07,@9F9                                            0149  04460000
*           DO;                    /* YES, RETURN TO FIRST CHAR  21050* 04470000
@9FA     EQU   *                                                  0150  04480000
*            R5=R5-CHARCNTR;       /* IN DEV ADDR AND GO TO POR- 21050* 04490000
@9FB     SH    @5,CHARCNTR                                        0151  04500000
*            GO TO R3;             /* TION OF CODE WHICH CHECKS  21050* 04510000
         BCR   15,@3                                              0152  04520000
*            END;                  /* FOR ALPHABETIC ENTRY.      21050* 04530000
*         GO TO CECDEV03;          /* NO DELIMITER. CHECK NEXT   21050* 04540000
*                                  /* DEVICE ADDRESS CHARACTER   21050* 04550000
* CECDEV05:                        /* HAS A SYMBOLIC NAME BEEN   21050* 04560000
*         IF INPUTBUF(1)<'A'|      /* ENTERED IN THE DEV FIELD?  21050* 04570000
*            INPUTBUF(1)>'Z'       /* CHECK FOR NON ALPHA CHARS. 21050* 04580000
*            THEN                  /* IF TRUE,                  X03008* 04590000
CECDEV05 CLI   0(@5),C'A'                                         0155  04600000
         BC    04,@9F8                                            0155  04610000
         CLI   0(@5),C'Z'                                         0155  04620000
         BC    12,@9F7                                            0155  04630000
*              DO;                                            /*X03008* 04640000
*                IF MIXDEV='1'B THEN /* CHECK IF SYMB NAME      X03008* 04650000
@9F8     TM    OLTEPSW9,B'00000100'                               0157  04660000
*                  GOTO CECDEV40;    /* MIXED ENTRY, YES ERROR  X03008* 04670000
         BC    01,CECDEV40                                        0158  04680000
*                GO TO CECDEV11;   /*CHECK FOR NUMERIC ADDRESS.  21050* 04690000
         BC    15,CECDEV11                                        0159  04700000
*              END;                                           /*X03008* 04710000
*        IF MIXDEV='0'B THEN       /* CHECK IF DEVICE ENTRY     X03008* 04720000
@9F7     TM    OLTEPSW9,B'00000100'                               0161  04730000
*          GOTO CECDEV40;          /* MIXED, YES ERROR          X03008* 04740000
         BC    08,CECDEV40                                        0162  04750000
*        REMOTE='1'B;              /* REMOTE TERMINAL IN SYSTEM. 21051* 04760000
         OI    OLTEPSW7,B'00100000'                               0163  04770000
*         SYMNAM=BLANKFLD;         /*SYMBOLIC ENTRY DETECTED.    21050* 04780000
         MVC   SYMNAM(8),BLANKFLD                                 0164  04790000
*         RELEASE(9);                                                   04800000
*         SYMNAM(1:CHARCNTR)=INPUTBUF(1:CHARCNTR); /* FILL SYMNAME21050 04810000
         LR    @E,@5                                              0166  04820000
         LH    @9,CHARCNTR                                        0166  04830000
         BCTR  @9,0                                               0166  04840000
         LA    @A,SYMNAM                                          0166  04850000
         EX    @9,@MVC                                            0166  04860000
*                                  /* SYMNAME IN BUFFER AND LOAD 21050* 04870000
*         MODNAME=SYMNAM;                                               04880000
         MVC   PARMLIST(8),SYMNAM                                 0167  04890000
*         TARGETAD=DEVTABPT+32;                                         04900000
         LA    @F,32                                              0168  04910000
         AR    @F,@8                                              0168  04920000
         ST    @F,PARMLIST+8                                      0168  04930000
*         PARMFLGS='68'X;               /* SYMBOLIC CDS,COMPUTE X02008* 04940000
         MVI   PARMLIST+12,X'68'                                  0169  04950000
*         CDSLNGTH='14'X;                                               04960000
         LA    @F,X'14'                                           0170  04970000
         STH   @F,PARMLIST+14                                     0170  04980000
*                                                                       04990000
*         GEN(IFDMOD CALL='12',LIST=PARMLIST);                          05000000
         IFDMOD CALL='12',LIST=PARMLIST                                 05010000
         DS    0H                                                       05020000
*                                                                       05030000
*         R1=RC;                                                        05040000
         LR    @1,@F                                              0172  05050000
*         IF R1>0 THEN                                                  05060000
         LTR   @1,@1                                              0173  05070000
         BC    12,@9F6                                            0173  05080000
*          DO;                                                          05090000
*           R5=R5+CHARCNTR;                                             05100000
         AH    @5,CHARCNTR                                        0175  05110000
*           RESTRICT(1);                                                05120000
*           R1=MSGPTR27;                                                05130000
         L     @1,16(0,@4)                                        0177  05140000
*           MSG127I(12:19)=SYMNAM;                                      05150000
         MVC   23(8,@1),SYMNAM                                    0178  05160000
*         GEN(PWTO REG=(1));                                            05170000
         PWTO REG=(1)                                                   05180000
         DS    0H                                                       05190000
*           RELEASE(1);                                                 05200000
*           GO TO CECDEV15;                                             05210000
         BC    15,CECDEV15                                        0181  05220000
*          END;                                                         05230000
*         FSTDEV2=HEXADDR;         /* PREPARE PARM LIST FOR CNVRT 21050 05240000
@9F6     MVC   DEVAREA(4),32(@8)                                  0183  05250000
*         R1=ADDR(CNVRT3);         /* MODULE. HEX TO EBCDIC .     21050 05260000
         LA    @1,CNVRT3                                          0184  05270000
*         R15=TAB28;               /* SET PTR TO TRANS MNGR       21050 05280000
         L     @F,TAB28                                           0185  05290000
*         GEN(BALR 14,15);                                              05300000
         BALR 14,15                                                     05310000
         DS    0H                                                       05320000
*         IF RC^=0 THEN            /* IF RETURN CODE NOT 0 GO AND 21051 05330000
         LTR   @F,@F                                              0187  05340000
*         GO TO CECDEV43;          /* PRINT ERROR MESSAGE.       21051* 05350000
         BC    07,CECDEV43                                        0188  05360000
*         SUM=GOODENT+UCBLOOK;     /* ADD TOLAL NO. DEVTAB ENTRYX03008* 05370000
         LR    @F,@7                                              0189  05380000
         AR    @F,@6                                              0189  05390000
         ST    @F,@TEMP4                                          0189  05400000
         MVC   SUM(3),@TEMP4+1                                    0189  05410000
*         IF SUM>'000000'X THEN    /* CHECK IF FIRST ENTRY      X03008* 05420000
         L     @F,@X11                                            0190  05430000
         MVC   @TEMP3+1(3),SUM                                    0190  05440000
         C     @F,@TEMP3                                          0190  05450000
*           GOTO CECDE39A;         /* NO, THEN CHECK FOR DUP    X03008* 05460000
         BC    04,CECDE39A                                        0191  05470000
* CECDEV06:                                                   /*X03008* 05480000
*         DEVADDR=DEVAD1;          /* PUT EBCDIC ADDR IN DEV TABLE21050 05490000
CECDEV06 MVC   0(8,@8),DEVAD                                      0192  05500000
*         FRSTPASS='1'B;           /* FLAG TO SHOW => 1 DEV ENTRD21050* 05510000
         OI    SWITCHES,B'10000000'                               0193  05520000
*         GO TO CECDEV13;          /* BOLIC NAME ENTRY.          21050* 05530000
         BC    15,CECDEV13                                        0194  05540000
* CECDEV11:                        /*                            21050* 05550000
*         IF CHARCNTR>4 THEN            /* OS ALLOWS 3 CHARS,         * 05560000
CECDEV11 LA    @F,4                                               0195  05570000
         CH    @F,CHARCNTR                                        0195  05580000
*          GO TO CECDEV43;              /* ANY OTHER LENGTH INVAL     * 05590000
         BC    04,CECDEV43                                        0196  05600000
*         IF CHARCNTR=4 THEN            /* FOUR CHAR DEV ADDR?        * 05610000
         CH    @F,CHARCNTR                                        0197  05620000
         BC    07,@9F5                                            0197  05630000
*          DO;                          /* YES,                       * 05640000
*           IF INPUTBUF(1:4)>'0999' THEN/* IS 4 CHAR ENTRY VALID      * 05650000
         CLC   0(4,@5),@C12                                       0199  05660000
*            GO TO CECDEV43;            /* NO, TOO LARGE DEV ADDR     * 05670000
         BC    02,CECDEV43                                        0200  05680000
*          END;                                                         05690000
*         FRSTPASS='1'B;           /* INDICATE => 1 DEV ENTERED  21050* 05700000
@9F5     OI    SWITCHES,B'10000000'                               0202  05710000
*         IGNORE=EIGHT-CHARCNTR+1; /* ZERO FIELD IN ADDRESS      21050* 05720000
         LA    @F,1                                               0203  05730000
         SH    @F,CHARCNTR                                        0203  05740000
         AH    @F,EIGHT                                           0203  05750000
         STH   @F,IGNORE                                          0203  05760000
*         RELEASE(9);                                                   05770000
*         DEVADDR='00000000';       /* CLEAR DEV ADDR FIELD.     21051* 05780000
         MVC   0(8,@8),@C13                                       0205  05790000
*         DEVADDR(IGNORE:8)=INPUTBUF(1:CHARCNTR);/* ADDR IN DEVTAB21050 05800000
         LR    @E,@5                                              0206  05810000
         LA    @1,8                                               0206  05820000
         LH    @9,IGNORE                                          0206  05830000
         SR    @1,@9                                              0206  05840000
         LA    @A,0(@9,@8)                                        0206  05850000
         BCTR  @A,0                                               0206  05860000
         EX    @1,@MVC                                            0206  05870000
*         RESTRICT(9);                                                  05880000
*         DEVAD1=DEVADDR;          /* TAB. CONVERT DEV ADDR IN   21050* 05890000
         MVC   DEVAD(8),0(@8)                                     0208  05900000
*         R1=ADDR(CNVRT1);         /* EBCDIC TO HEX.  GET ADDR OF21050* 05910000
         LA    @1,CNVRT1                                          0209  05920000
*         R15=TAB28;               /* CONVERT RTN PARM LIST. GET 21050* 05930000
         L     @F,TAB28                                           0210  05940000
*                                  /*ENTRY PT ADDR TO  NEW MACROS21050* 05950000
*         GEN(BALR R14,R15);       /* BRANCH TO CNVERT RTN(41).  21050* 05960000
         BALR R14,R15                                                   05970000
         DS    0H                                                       05980000
*         IF RC^=0 THEN            /* CHECK RETURN CODE. NOT=0   21050* 05990000
         LTR   @F,@F                                              0212  06000000
*            GO TO CECDEV43;       /* MEANS AN ERROR. GET NEW DTO21050* 06010000
         BC    07,CECDEV43                                        0213  06020000
*         SUM=GOODENT+UCBLOOK;     /* ADD TOTAL NO. DEVTAB ENTRYX03008* 06030000
         LR    @F,@7                                              0214  06040000
         AR    @F,@6                                              0214  06050000
         ST    @F,@TEMP4                                          0214  06060000
         MVC   SUM(3),@TEMP4+1                                    0214  06070000
*         IF SUM>'000000'X THEN    /* CHECK IF FIRST ENTRY      X03008* 06080000
         L     @F,@X11                                            0215  06090000
         MVC   @TEMP3+1(3),SUM                                    0215  06100000
         C     @F,@TEMP3                                          0215  06110000
         BC    10,@9F4                                            0215  06120000
*           DO;                    /* NO                        X03008* 06130000
*             NEWADDR=HEX;         /* PLACE ADDR IN SCAN HOLD   X03008* 06140000
         MVC   NEWADDR(4),DEVAREA                                 0217  06150000
*             SAVLOOKT=UCBLOOK;    /* SAVE REG BEFOR SCAN       X03008* 06160000
         ST    @7,@TEMP4                                          0218  06170000
         MVC   SAVLOOKT(3),@TEMP4+1                               0218  06180000
*             GEN(BAL   R7,CECDE39B); /* CHECK FOR DUP ADDR     X03008* 06190000
         BAL   R7,CECDE39B                                              06200000
         DS    0H                                                       06210000
*             UCBLOOK=SAVLOOKT;    /*RESTORE REG AFTER GOOD SCANX03008* 06220000
         MVC   @TEMP3+1(3),SAVLOOKT                               0220  06230000
         L     @7,@TEMP3                                          0220  06240000
*           END;                                              /*X03008* 06250000
*         HEXADDR=HEX;             /* PUT RETURNED HEX ADDR IN   21050* 06260000
@9F4     MVC   32(4,@8),DEVAREA                                   0222  06270000
*                                  /* DEV TAB ENTRY. ADD CHARCNTR21050* 06280000
* CECDEV13:                        /*                            21050* 06290000
*         R5=R5+CHARCNTR  ;        /* INCREMENT TO CHAR AFTER SYM21050* 06300000
CECDEV13 AH    @5,CHARCNTR                                        0223  06310000
*         DEVTABPT=DEVTABPT+TABLNGTH;/*INCREMENT DEVTAB POINTER X03008* 06320000
         AH    @8,TABLNGTH                                        0224  06330000
*         UCBLOOK=UCBLOOK+1;        /* INCREMENT UCB LOOK UP COUNTER  * 06340000
         LA    @7,1(0,@7)                                         0225  06350000
*                                   /* BY ONE.                        * 06360000
*         IF LIMIT=UCBLOOK THEN     /* IS LIMIT OF UCB LOOK UPS       * 06370000
         CH    @7,LIMIT                                           0226  06380000
         BC    07,@9F3                                            0226  06390000
*           DO;                     /* REACHED. YES, GO TO UCB LOOK UP* 06400000
*           R3=ADDR(CECDEV15);      /* FUNCTION. SET RETURN ADDRESS   * 06410000
         LA    @3,CECDEV15                                        0228  06420000
*                                  /*                            21050* 06430000
*           GO TO CECDEV31;         /* IN REGISTER 3.            21050* 06440000
         BC    15,CECDEV31                                        0229  06450000
*           END;                                                        06460000
* CECDEV15:                                                    /*21050* 06470000
*         /************************************************************ 06480000
*         /*                                                    X03906* 06490000
*         /*        IS AN INCLUSIVE SERIES OF DEVICES ENTERED         * 06500000
*         /*                                                    X03906* 06510000
*         /************************************************************ 06520000
*         IF INPUTBUF(1)='-' THEN  /* A '-' DELIMITER INDICATES  21050* 06530000
@9F3     EQU   *                                                  0231  06540000
CECDEV15 CLI   0(@5),C'-'                                         0231  06550000
         BC    07,@9F2                                            0231  06560000
*            DO;                   /* AN INCLUSIVE SERIES. IF    21050* 06570000
*            IF INPUTBUF(2)>='A' & /* IT IS, MUST HAVE NUMERIC   21050* 06580000
*              INPUTBUF(2)<='Z'    /* ENTRY. NO INCLUSIVE SYMBOL 21050* 06590000
*              THEN GO TO CECDEV43;/* ICS, HAVE ERROR CONDITION. 21050* 06600000
         CLI   1(@5),C'A'                                         0233  06610000
         BC    04,@9F1                                            0233  06620000
         CLI   1(@5),C'Z'                                         0233  06630000
         BC    13,CECDEV43                                        0234  06640000
*                                  /* ENTRY IS INCLUSIVE & NUMBER21050* 06650000
*         INCLST='1'B;             /* SET INCLUSIVE ENTRY FLG ON.21050* 06660000
@9F0     EQU   *                                                  0235  06670000
@9F1     OI    OLTEPSW7,B'10000000'                               0235  06680000
*         R5=R5+1;                 /* INCREMENT TO CHAR AFTER'-'.21050* 06690000
         AH    @5,@D1                                             0236  06700000
*         CHARCNTR=0;              /* RESET CHARACTER COUNTER    21050* 06710000
         SR    @F,@F                                              0237  06720000
         STH   @F,CHARCNTR                                        0237  06730000
*         R3=ADDR(CECDEV17);       /* RET PT AFTER CHAR SCAN.    21050* 06740000
         LA    @3,CECDEV17                                        0238  06750000
*         GO TO CECDEV03;          /* GO TO START OF SCAN CODE   21050* 06760000
         BC    15,CECDEV03                                        0239  06770000
* CECDEV17:                                                    /*21050* 06780000
*         DEVAD1='00000000';       /* CLEAR FIELD FOR CONVERT.   21051* 06790000
CECDEV17 MVC   DEVAD(8),@C13                                      0240  06800000
*         IGNORE=EIGHT-CHARCNTR+1; /* DETERMINE NON SIGNIFICANT  21050* 06810000
         LA    @F,1                                               0241  06820000
         SH    @F,CHARCNTR                                        0241  06830000
         AH    @F,EIGHT                                           0241  06840000
         STH   @F,IGNORE                                          0241  06850000
*                                  /* PART OF ADDRESS FIELD.     21050* 06860000
*         RELEASE(9);                                                   06870000
*         DEVAD1(IGNORE:8)=INPUTBUF(1:CHARCNTR); /*LOAD PARM FLD 21050* 06880000
         LR    @E,@5                                              0243  06890000
         LA    @1,8                                               0243  06900000
         LR    @9,@F                                              0243  06910000
         SR    @1,@9                                              0243  06920000
         LA    @A,DEVAD-1(@9)                                     0243  06930000
         EX    @1,@MVC                                            0243  06940000
*         RESTRICT(9);                                                  06950000
*         R1=ADDR(CNVRT2);         /* LST FOR CONVRT RTN. SET    21050* 06960000
         LA    @1,CNVRT2                                          0245  06970000
*         R15=TAB28;               /* PTRS TO RTN AND NEW MACROS 21050* 06980000
         L     @F,TAB28                                           0246  06990000
*         GEN(BALR R14,R15);       /* BRANCH TO CONVERSION MODULE21050* 07000000
         BALR R14,R15                                                   07010000
         DS    0H                                                       07020000
*         IF RC^=0 THEN            /* IF RETURN CODE NOT 0, THEN 21050* 07030000
         LTR   @F,@F                                              0248  07040000
*            GO TO CECDEV43;       /* PRNT MSG & REDEFINE TEST.  21050* 07050000
         BC    07,CECDEV43                                        0249  07060000
*         ERRCODE='60' ;           /* ERROR. SET INCLUSIVE VALID 21050* 07070000
         MVC   ERRCODE(2),@C14                                    0250  07080000
*                                  /* CODE AND CHECK FOR VALID EN21050* 07090000
*         IF FSTDEV>FINDEV THEN    /* CLUSIVE RANGE. 2F 1ST DEV  21050* 07100000
         L     @F,DEVAREA+4                                       0251  07110000
         C     @F,DEVAREA                                         0251  07120000
*            GO TO CECDEV45;       /* ADDR IS > LAST DEV ADDR,   21050* 07130000
         BC    04,CECDEV45                                        0252  07140000
*         R5=R5+CHARCNTR  ;        /* PRNT ERROR MSG. MOVE TO    21050* 07150000
         AH    @5,CHARCNTR                                        0253  07160000
*         GO TO CECDEV39;          /* NEXT DELIMITER.  GO TO CODE21050* 07170000
         BC    15,CECDEV39                                        0254  07180000
*         END;                     /* THAT HANDLES INCLSVE SERIES21050* 07190000
* CECDEV19:                                                    /*21050* 07200000
*         /************************************************************ 07210000
*         /*                   IS DELIMITER A COMMA                   * 07220000
*         /************************************************************ 07230000
*         IF INPUTBUF(1)=',' THEN   /* IS CHAR IN INBUFR A COMMA.     * 07240000
@9F2     EQU   *                                                  0256  07250000
CECDEV19 CLI   0(@5),C','                                         0256  07260000
         BC    07,@9EF                                            0256  07270000
*           DO;                     /* YES,                           * 07280000
*           R5=R5+1;                /* INCREMENT INBUFR POINTER TO    * 07290000
         AH    @5,@D1                                             0258  07300000
*                                   /* POINT TO NEXT DEVICE IN INBUFR.* 07310000
*         CHARCNTR=0;              /* RESET CHARACTER COUNTER    21050* 07320000
         SR    @F,@F                                              0259  07330000
         STH   @F,CHARCNTR                                        0259  07340000
*           GO TO CECDEV00;         /* GO TO ROUTINE THAT DECODES     * 07350000
         BC    15,CECDEV00                                        0260  07360000
*           END;                    /* THE DEVICES ENTERED.           * 07370000
*         /************************************************************ 07380000
*         /*                   IS DELIMITER A SLASH                   * 07390000
*         /************************************************************ 07400000
*         IF INPUTBUF(1)^='/' THEN  /* IS CHAR IN INBUFR A SLASH.     * 07410000
@9EF     CLI   0(@5),C'/'                                         0262  07420000
*           GO TO CECDEV41;         /* NO, ERROR - PRINT MESSAGE.21050* 07430000
         BC    07,CECDEV41                                        0263  07440000
*         IF UCBLOOK^=0 THEN        /* ARE MORE UCB LOOK UPS REQUIRED.* 07450000
         LTR   @7,@7                                              0264  07460000
         BC    08,@9EE                                            0264  07470000
*           DO;                     /* YES,                           * 07480000
*           R3=ADDR(CECDEV21);      /* SUPPLY UCB LOOK UP WITH RETURN * 07490000
         LA    @3,CECDEV21                                        0266  07500000
*                                  /*                            21050* 07510000
*           GO TO CECDEV31;         /* ADDRESS & GO TO UCB LOOK UP21050 07520000
         BC    15,CECDEV31                                        0267  07530000
*           END;                    /* ROUTINE.                       * 07540000
* CECDEV21:                                                    /*21050* 07550000
*         /************************************************************ 07560000
*         /*                ARE THERE ANY GOOD ENTRIES                * 07570000
*         /************************************************************ 07580000
*         IF GOODENT=0 THEN         /* ARE THERE ANY GOOD ENTRIES.    * 07590000
@9EE     EQU   *                                                  0269  07600000
CECDEV21 LTR   @6,@6                                              0269  07610000
         BC    07,@9ED                                            0269  07620000
*           DO;                     /* NO,                            * 07630000
* CECDEV23:                                                    /*21050* 07640000
*           R1=MSGPTR11;            /* PRINT ERROR MESSAGE.           * 07650000
CECDEV23 L     @1,4(0,@4)                                         0271  07660000
*           GEN(PWTO  REG=(1));     /* PRINT MESSAGE.                 * 07670000
         PWTO  REG=(1)                                                  07680000
         DS    0H                                                       07690000
*           GEN(BAL   R7,CECDE40B); /* CLEAR DEVICE TABLE       X03008* 07700000
         BAL   R7,CECDE40B                                              07710000
         DS    0H                                                       07720000
*           GO TO CECDEV47;         /* RETURN TO REDEFINE       X03008* 07730000
         BC    15,CECDEV47                                        0274  07740000
*           END;                                                        07750000
* CECDEV25:                                                    /*21050* 07760000
*         /************************************************************ 07770000
*         /*                                                          * 07780000
*         /*                      EXIT ROUTINE                        * 07790000
*         /*                                                          * 07800000
*         /************************************************************ 07810000
*         UNITCTR=GOODENT;          /* SAVE UNIT COUNTER. */            07820000
@9ED     EQU   *                                                  0276  07830000
CECDEV25 STH   @6,X                                               0276  07840000
*         UNICTR=UNITCTR1;                                              07850000
         MVC   UNICTR(1),X+1                                      0277  07860000
*         UNITUSE='00'X;            /* INITIALIZE UNIT USE COUNTER. */  07870000
         MVI   UNITUSE,X'00'                                      0278  07880000
*         INBUFPTR=R5;              /* SAVE INBUFR POINTER. */          07890000
         ST    @5,INBUFPTR                                        0279  07900000
*         GO TO CECDEV49;           /* SUCCESSFUL ENTRY IN DEV FIELD. * 07910000
         BC    15,CECDEV49                                        0280  07920000
*                                                              /*21050* 07930000
* CECDEV27:                                                    /*21050* 07940000
*         /************************************************************ 07950000
*         /*                                                          * 07960000
*         /*              ROUTINE FOR SPECIAL ENTRIES                 * 07970000
*         /*                                                          * 07980000
*         /************************************************************ 07990000
* CECDEV29:                                                    /*21050* 08000000
*         IF INPUTBUF(1:4)^='NDR/' THEN/* DOES INPUT BUFFER CONTAIN   * 08010000
CECDEV27 EQU   *                                                  0281  08020000
CECDEV29 CLC   0(4,@5),@C15                                       0281  08030000
*           GO TO CECDEV43;         /* NDR/. NO, PRINT ERROR MESSAGE. * 08040000
         BC    07,CECDEV43                                        0282  08050000
*                                                              /*21050* 08060000
*         R5=R5+3;                  /* YES, INCREMENT INBUFR POINTER. * 08070000
         AH    @5,@D2                                             0283  08080000
*         NDR='1'B;                 /* SET NDR FLAG ON.               * 08090000
         OI    OLTEPSW2,B'00000100'                               0284  08100000
*         PRIDVSCT=PRIDVSCT&&PRIDVSCT;/* CLEAR PRIMARY ENTRY IN SCT.  * 08110000
         XC    SCT+8(12),SCT+8                                    0285  08120000
*         LEGALDEV='1'B;            /* .NDR IS LEGAL DEVICE ENTRY 21051 08130000
         OI    OLTEPSW,B'00001000'                                0286  08140000
*         GO TO CECDEV25;           /* GO TO FINISH ROUTINE.     21050* 08150000
         BC    15,CECDEV25                                        0287  08160000
* CECDEV31:                                                    /*21050* 08170000
*         /************************************************************ 08180000
*         /*                                                          * 08190000
*         /*     UCB LOOK UP FUNCTION FOR VALID DEVICE ENTRIES        * 08200000
*         /*                                                          * 08210000
*         /************************************************************ 08220000
*         MODNUM='31';              /* PUT NAME OF CALLING MODULE IN  * 08230000
CECDEV31 MVC   SVCPLIST+2(2),@C16                                 0288  08240000
*                                   /* SVC PARAMETER LIST.            * 08250000
*         DEVTABPT=DEVTABPT-(UCBLOOK*TABLNGTH);                         08260000
         LH    @F,TABLNGTH                                        0289  08270000
         MR    @E,@7                                              0289  08280000
         LCR   @F,@F                                              0289  08290000
         AR    @8,@F                                              0289  08300000
*                                   /* GIVE SVC POINTER TO LIST X03008* 08310000
*         ADDRDEV=DEVTABPT;         /* THAT MUST BE CHECKED.     21050* 08320000
         ST    @8,SVCPLIST+4                                      0290  08330000
*         ENTRIES=UCBLOOK;          /* TELL SVC HOW MANY UCB LOOK UPS * 08340000
         ST    @7,SVCPLIST+8                                      0291  08350000
*                                   /* IT MUST PERFORM.               * 08360000
*         SVCSAPTR=DIEPTR+40; /* ADDR OF SA IN PARM LIST Y02008 */      08370000
         LA    @F,40                                              0292  08380000
         A     @F,DIEPTR                                          0292  08390000
         ST    @F,SVCPLIST+12                                     0292  08400000
*         RESTRICT(1);                                                  08410000
*         R1=64;                    /* SET SVC CALLING CODE PARAMETER * 08420000
         LA    @1,64                                              0294  08430000
*                                   /* IN REGISTER 1.                 * 08440000
*         R0=ADDR(ADDRDEV);         /* SET POINTER TO PARAMETER LIST. * 08450000
         LA    @0,SVCPLIST+4                                      0295  08460000
*         RELEASE(1);                                                   08470000
*         GEN(SVC   59);            /* ISSUE SVC 59 FOR UCB LOOK UP.  * 08480000
         SVC   59                                                       08490000
         DS    0H                                                       08500000
*         X=0;                      /* INITIALIZE COUNTER TO ZERO.    * 08510000
         SR    @F,@F                                              0298  08520000
         STH   @F,X                                               0298  08530000
* CECDEV33:                                                    /*21050* 08540000
*         /************************************************************ 08550000
*         /*           DO DEVICES ENTERED HAVE VALID UCBS             * 08560000
*         /************************************************************ 08570000
*         IF DEVENQNG = '1'B THEN   /*  IS THE DEV UCB NOT AVAILABLE  * 08580000
CECDEV33 TM    15(@8),B'00000100'                                 0299  08590000
         BC    12,@9EC                                            0299  08600000
*           DO;                     /* YES                            * 08610000
*             RESTRICT(1);                                              08620000
*             R1=MSGPTR19;          /* GET POINTER TO MESSAGE.        * 08630000
         L     @1,36(0,@4)                                        0302  08640000
*             MSG109DV(01:08)=DEVADDR;   /* PUT DEV ADDR IN MSG       * 08650000
         MVC   12(8,@1),0(@8)                                     0303  08660000
*             IF ONOFF='1'B                /* CHECK DEV STATUS        * 08670000
*               THEN                       /* IF ITS ONLINE,  @ZA06048* 08680000
         TM    12(@8),B'10000000'                                 0304  08690000
         BC    12,@9EB                                            0304  08700000
*                 ONOROFF='ONLINE ,';      /* SAY SO          @ZA06048* 08710000
         MVC   21(8,@1),@C17                                      0305  08720000
         BC    15,@9EA                                            0306  08730000
*               ELSE                       /* IF ITS NOT      @ZA06048* 08740000
*                 ONOROFF='OFFLINE,';      /* SAY SO          @ZA06048* 08750000
@9EB     MVC   21(8,@1),@C18                                      0306  08760000
*             IF SYSALLOC='1'B             /* CHECK ALLOC     @ZA06048* 08770000
*               THEN                       /* IF ITS ALLOCATED        * 08780000
@9EA     TM    14(@8),B'00000100'                                 0307  08790000
         BC    12,@9E9                                            0307  08800000
*                 ALORNOT='ALLOCATED  ';   /* SAY SO          @ZA06048* 08810000
         MVC   29(11,@1),@C19                                     0308  08820000
         BC    15,@9E8                                            0309  08830000
*               ELSE                       /* IF ITS NOT      @ZA06048* 08840000
*                 ALORNOT='UNALLOCATED';   /* SAY SO          @ZA06048* 08850000
@9E9     MVC   29(11,@1),@C20                                     0309  08860000
*             RELEASE(1);                                               08870000
@9E8     EQU   *                                                  0310  08880000
*             GEN(PWTO  REG=(1));   /* PRINT MESSAGE.                 * 08890000
         PWTO  REG=(1)                                                  08900000
         DS    0H                                                       08910000
*             DEVENQNG = '0'B;      /* ZERO BIT                       * 08920000
         NI    15(@8),B'11111011'                                 0312  08930000
*           END;                                                        08940000
*         IF NOGODEV = '1'B THEN   /*  IS THE DEV NOT AVAILABLE YM7253* 08950000
@9EC     TM    14(@8),B'00001000'                                 0314  08960000
         BC    12,@9E7                                            0314  08970000
*           DO;                     /* YES                      YM7253* 08980000
*             RESTRICT(1);                                    /*YM7253* 08990000
*             R1=MSGPTR67;          /* GET POINTER TO MESSAGE.  YM7253* 09000000
         L     @1,40(0,@4)                                        0317  09010000
*             MSG467DV(01:08)=DEVADDR;/* PUT DEV ADDR IN MSG    YM7253* 09020000
         MVC   12(8,@1),0(@8)                                     0318  09030000
*             RELEASE(1);                                     /*YM7253* 09040000
*             GEN(PWTO  REG=(1));   /* PRINT MESSAGE.           YM7253* 09050000
         PWTO  REG=(1)                                                  09060000
         DS    0H                                                       09070000
*             GOTO CECDEV37;        /* GOTO NEXT DEVICE         YM7253* 09080000
         BC    15,CECDEV37                                        0321  09090000
*           END;                                              /*YM7253* 09100000
*         IF UCBADDR=0 THEN         /* IS IT A VALID DEVICE.          * 09110000
@9E7     SR    @F,@F                                              0323  09120000
         MVC   @TEMP4(4),8(@8)                                    0323  09130000
         C     @F,@TEMP4                                          0323  09140000
         BC    07,@9E6                                            0323  09150000
*           DO;                     /* NO,                            * 09160000
*           RESTRICT(1);                                                09170000
*           R1=MSGPTR79;            /* GET POINTER TO MESSAGE.        * 09180000
         L     @1,8(0,@4)                                         0326  09190000
*           MSG179I(20:27)=DEVADDR;      /* PUT DEV ADDR IN MSG  21050* 09200000
         MVC   31(8,@1),0(@8)                                     0327  09210000
*           RELEASE(1);                                                 09220000
*           GEN(PWTO  REG=(1));     /* PRINT MESSAGE.                 * 09230000
         PWTO  REG=(1)                                                  09240000
         DS    0H                                                       09250000
*           GO TO CECDEV37;         /* SKIP ENTRY.               21050* 09260000
         BC    15,CECDEV37                                        0330  09270000
*           END;                                                        09280000
*         IF DEVVAR ='1'B THEN      /*  HAS THE DEVICE BEEN VARRIED OF* 09290000
@9E6     TM    15(@8),B'00001000'                                 0332  09300000
         BC    12,@9E5                                            0332  09310000
*           DO;                     /* YES                            * 09320000
*           RESTRICT(1);                                                09330000
*           R1=MSGPTR14;            /* GET POINTER TO MESSAGE.        * 09340000
         L     @1,32(0,@4)                                        0335  09350000
*           MSG140DV(01:08)=DEVADDR;     /* PUT DEV ADDR IN MSG       * 09360000
         MVC   12(8,@1),0(@8)                                     0336  09370000
*           RELEASE(1);                                                 09380000
*           GEN(PWTO  REG=(1));     /* PRINT MESSAGE.                 * 09390000
         PWTO  REG=(1)                                                  09400000
         DS    0H                                                       09410000
*           DEVVAR = '0'B;                                              09420000
         NI    15(@8),B'11110111'                                 0339  09430000
*           END;                                                        09440000
* CECDEV35:                                                    /*21050* 09450000
*         /************************************************************ 09460000
*         /*                UPDATE OR PUSH UP ROUTINE                 * 09470000
*         /************************************************************ 09480000
*         GOODENT=GOODENT+1;        /* INCREMENT GOOD ENTRIES COUNTER.* 09490000
@9E5     EQU   *                                                  0341  09500000
CECDEV35 LA    @6,1(0,@6)                                         0341  09510000
*         DEVTABLE=DEVTABXX;        /* PUSH UP INFORMATION IN DEVTAB. * 09520000
         L     @1,AVAILBLE                                        0342  09530000
         MVC   0(56,@1),0(@8)                                     0342  09540000
*         IF AVAILBLE^=DEVTABPT THEN/* IS THIS A PUSH UP.             * 09550000
         C     @8,AVAILBLE                                        0343  09560000
         BC    08,@9E4                                            0343  09570000
*         DEVTABXX=DEVTABXX&&DEVTABXX; /* ZERO DEVTABLE TO AVOID 21050* 09580000
         XC    0(56,@8),0(@8)                                     0344  09590000
*                                   /* ERROR IN OTHER POSSIBLE UCB    * 09600000
*                                   /* LOOK UPS.                      * 09610000
*         AVAILBLE=AVAILBLE+TABLNGTH;                                   09620000
@9E4     LH    @F,TABLNGTH                                        0345  09630000
         A     @F,AVAILBLE                                        0345  09640000
         ST    @F,AVAILBLE                                        0345  09650000
*                             /* INCREMENT AVAILABLE POINTER TO X03008* 09660000
*                                   /* NEXT AVAILABLE DEVTAB ENTRY21050 09670000
* CECDEV37:                                                    /*21050* 09680000
*         /************************************************************ 09690000
*         /*   ROUTINE THAT DETERMINES IF MORE UCBS ARE OUTSTANDING   * 09700000
*         /************************************************************ 09710000
*         X=X+1;                    /* INCREMENT COUNTER.             * 09720000
CECDEV37 LA    @F,1                                               0346  09730000
         AH    @F,X                                               0346  09740000
         STH   @F,X                                               0346  09750000
*         DEVTABPT=DEVTABPT+TABLNGTH;/*INCREMENT DEVTABLE POINTERX03008 09760000
         AH    @8,TABLNGTH                                        0347  09770000
*         IF X^=UCBLOOK THEN        /* ARE ALL UCBS CHECKED.          * 09780000
         CH    @7,X                                               0348  09790000
*           GO TO CECDEV33;         /* NO, LOOP.  YES, CONTINUE. 21050* 09800000
         BC    07,CECDEV33                                        0349  09810000
*         IF GOODENT=16 THEN        /* ARE THERE 16 GOOD ENTRIES.     * 09820000
         CH    @6,@D3                                             0350  09830000
*             GO TO CECDEV25;      /* YES, GO TO EXIT ROUTINE.   21050* 09840000
         BC    08,CECDEV25                                        0351  09850000
*         UCBLOOK=0;                /* SET UCBLOOK UP COUNTER TO 0.   * 09860000
         SR    @7,@7                                              0352  09870000
*         X=0;                      /* SET COUNTER TO 0.              * 09880000
         SR    @F,@F                                              0353  09890000
         STH   @F,X                                               0353  09900000
*         DEVTABPT=AVAILBLE;        /* SET DEVTAB POINTER TO NEXT     * 09910000
         L     @8,AVAILBLE                                        0354  09920000
*                                   /* AVAILABLE ENTRY IN DEVTAB.     * 09930000
*         LIMIT=16-GOODENT;         /* FIND NEW LIMIT.                * 09940000
         LA    @F,16                                              0355  09950000
         SR    @F,@6                                              0355  09960000
         STH   @F,LIMIT                                           0355  09970000
*         GO TO R3;                /* RET TO POINT IN REG 3.     21050* 09980000
         BCR   15,@3                                              0356  09990000
* CECDEV39:                                                    /*21050* 10000000
*         /************************************************************ 10010000
*         /*                                                          * 10020000
*         /*     ROUTINE THAT HANDLES INCLUSIVE SERIES OF DEVICES     * 10030000
*         /*                                                          * 10040000
*         /************************************************************ 10050000
*         FSTDEV=FSTDEV+1;          /* INCREMENT FSTDEV BY ONE.       * 10060000
CECDEV39 LA    @F,1                                               0357  10070000
         A     @F,DEVAREA                                         0357  10080000
         ST    @F,DEVAREA                                         0357  10090000
*         SAVENT=FSTDEV;           /* SAVE DEVICE FOR LATER USE. 21050* 10100000
         MVC   SAVENT(4),DEVAREA                                  0358  10110000
*         IF FSTDEV>FINDEV THEN     /* HAS INCLUSIVE SERIES BEEN FULLY* 10120000
         L     @F,DEVAREA+4                                       0359  10130000
         C     @F,DEVAREA                                         0359  10140000
         BC    10,@9E3                                            0359  10150000
*           DO;                     /* DECODED. YES, RESET INCLUSIVE  * 10160000
*           INCLST='0'B;            /* FLAG. MAKE SURE NEXT DELIMITER * 10170000
         NI    OLTEPSW7,B'01111111'                               0361  10180000
*           IF INPUTBUF(1)^='-' THEN/* IS NOT A HYPHEN.               * 10190000
         CLI   0(@5),C'-'                                         0362  10200000
*             GO TO CECDEV19;                                  /*21050* 10210000
         BC    07,CECDEV19                                        0363  10220000
*           GO TO CECDEV41;         /* ERROR, PRINT MESSAGE.     21050* 10230000
         BC    15,CECDEV41                                        0364  10240000
*           END;                                                        10250000
*         SUM=GOODENT+UCBLOOK;      /*ADD TOTAL NO. DEVTAB ENTRYX03008* 10260000
@9E3     LR    @F,@7                                              0366  10270000
         AR    @F,@6                                              0366  10280000
         ST    @F,@TEMP4                                          0366  10290000
         MVC   SUM(3),@TEMP4+1                                    0366  10300000
*         IF SUM>'000000'X THEN     /* CHECK IF THIS FIRST DEV  X03008* 10310000
         L     @F,@X11                                            0367  10320000
         MVC   @TEMP3+1(3),SUM                                    0367  10330000
         C     @F,@TEMP3                                          0367  10340000
         BC    10,@9E2                                            0367  10350000
*           DO;                     /* NO                       X03008* 10360000
*             NEWADDR=FSTDEV2;      /* ADDR OF DEV IN SCAN HOLD X03008* 10370000
         MVC   NEWADDR(4),DEVAREA                                 0369  10380000
*             SAVLOOKT=UCBLOOK;     /* SAVE REG BEFOR SCAN      X03008* 10390000
         ST    @7,@TEMP4                                          0370  10400000
         MVC   SAVLOOKT(3),@TEMP4+1                               0370  10410000
*             GEN(BAL   R7,CECDE39B); /* SCAN TABLE FOR DUP ADDRX03008* 10420000
         BAL   R7,CECDE39B                                              10430000
         DS    0H                                                       10440000
*             UCBLOOK=SAVLOOKT;     /* RESTORE REG AFTER SCAN   X03008* 10450000
         MVC   @TEMP3+1(3),SAVLOOKT                               0372  10460000
         L     @7,@TEMP3                                          0372  10470000
*           END;                                              /*X03008* 10480000
*         HEXADDR=FSTDEV2;          /* PUT HEX DEVICE ADDRESS IN      * 10490000
@9E2     MVC   32(4,@8),DEVAREA                                   0374  10500000
*                                   /* DEVTABLE ENTRY.                * 10510000
*         R1=ADDR(CNVRT3);          /* GET ADDRESS OF CONVERT PARMLIST* 10520000
         LA    @1,CNVRT3                                          0375  10530000
*         R15=TAB28;                /* GET ENTRY POINT ADDRESS.       * 10540000
         L     @F,TAB28                                           0376  10550000
*         GEN(BALR R14,R15);        /* EXECUTE CONVERT MODULE.        * 10560000
         BALR R14,R15                                                   10570000
         DS    0H                                                       10580000
*         IF RC^=0 THEN            /* IF RETURN CODE NOT 0 GO AND 21051 10590000
         LTR   @F,@F                                              0378  10600000
*         GO TO CECDEV43;          /* PRINT ERROR MESSAGE.       21051* 10610000
         BC    07,CECDEV43                                        0379  10620000
*         DEVADDR=DEVAD1;           /* PUT EBCDIC DEVICE ADDRESS IN   * 10630000
         MVC   0(8,@8),DEVAD                                      0380  10640000
*                                   /* DEVTABLE ENTRY.                * 10650000
*         UCBLOOK=UCBLOOK+1;        /* INCREMENT UCB LOOK UP COUNTER  * 10660000
         LA    @7,1(0,@7)                                         0381  10670000
*                                   /* BY ONE.                        * 10680000
*         DEVTABPT=DEVTABPT+TABLNGTH;/* INCREMENT DEVTABLE POINTER TO * 10690000
         AH    @8,TABLNGTH                                        0382  10700000
*                                   /* POINT TO NEXT ENTRY.     X03008* 10710000
*         IF UCBLOOK=LIMIT THEN     /* IS LIMIT OF UCB LOOK UPS       * 10720000
         CH    @7,LIMIT                                           0383  10730000
         BC    07,@9E1                                            0383  10740000
*           DO;                     /* REACHED. YES, GO TO UCB LOOK UP* 10750000
*                                   /* ROUTINE.                       * 10760000
*           R3=ADDR(CECDEV39);      /* GIVE UCB LOOK UP ROUTINE A 21050 10770000
         LA    @3,CECDEV39                                        0385  10780000
*                                   /* RETURN ADDRESS.                * 10790000
*           GO TO CECDEV31;         /* GO TO UCBLOOK UP ROUTINE. 21050* 10800000
         BC    15,CECDEV31                                        0386  10810000
*           END;                                                        10820000
*         GO TO CECDEV39;           /* CONTINUE WITH INCLUSIVE DEVICE * 10830000
*                                   /* HANDLING.                 21050* 10840000
* CECDE39A:                                                   /*X03008* 10850000
*        /******************************************************X03008* 10860000
*        /*                                                     X03008* 10870000
*        /* DUPLICATE DEVICE SYMBOLIC ENTRY CHECK               X03008* 10880000
*        /*                                                     X03008* 10890000
*        /******************************************************X03008* 10900000
*        LOOPPTR=DEVTBPTR;          /*SET SCAN BASE START OF TABX03008* 10910000
CECDE39A MVC   LOOPPTR(4),DEVTBPTR                                0389  10920000
*        SUM=GOODENT+UCBLOOK;       /*TOTAL NO. DEV IN TAB CNTL.X03008* 10930000
         LR    @F,@7                                              0390  10940000
         AR    @F,@6                                              0390  10950000
         ST    @F,@TEMP4                                          0390  10960000
         MVC   SUM(3),@TEMP4+1                                    0390  10970000
*          DO Z=1 TO SUM     BY +1; /* SCAN DEVICE TAB SYMBOLIC X03008* 10980000
         LA    @A,1                                               0391  10990000
         BC    15,@DO9DF                                          0391  11000000
*            IF SYMNAM=SYMBNM THEN  /* IS NEW ENTRY EQ OLD ENTRYX03008* 11010000
@DO9E0   L     @1,LOOPPTR                                         0392  11020000
         CLC   SYMNAM(8),44(@1)                                   0392  11030000
*              GOTO   CECDE40A;     /* YES, ERROR               X03008* 11040000
         BC    08,CECDE40A                                        0393  11050000
*            LOOPPTR=LOOPPTR+TABLNGTH; /* INDEX BASE CHECK NEXT X03008* 11060000
         LH    @F,TABLNGTH                                        0394  11070000
         A     @F,LOOPPTR                                         0394  11080000
         ST    @F,LOOPPTR                                         0394  11090000
*         END;                      /* NO DUP SYMB NAME FOUND   X03008* 11100000
*        GOTO CECDEV06;             /* RETURN TO PROCESSING     X03008* 11110000
         AH    @A,@D1                                             0395  11120000
@DO9DF   MVC   @TEMP3+1(3),SUM                                    0395  11130000
         C     @A,@TEMP3                                          0395  11140000
         BC    12,@DO9E0                                          0395  11150000
         BC    15,CECDEV06                                        0396  11160000
* CECDE39B:                                                   /*X03008* 11170000
*        /******************************************************X03008* 11180000
*        /*                                                     X03008* 11190000
*        /* DUPLICATE DEVICE ADDRESS ENTRY CHECK                X03008* 11200000
*        /*                                                     X03008* 11210000
*        /******************************************************X03008* 11220000
*        LOOPPTR=DEVTBPTR;          /*SET SCAN BASE START OF TABX03008* 11230000
CECDE39B MVC   LOOPPTR(4),DEVTBPTR                                0397  11240000
*        SUM=GOODENT+SAVLOOKT;      /*TOTAL NO. DEV IN TAB CNTL.X03008* 11250000
         MVC   @TEMP3+1(3),SAVLOOKT                               0398  11260000
         L     @F,@TEMP3                                          0398  11270000
         AR    @F,@6                                              0398  11280000
         ST    @F,@TEMP4                                          0398  11290000
         MVC   SUM(3),@TEMP4+1                                    0398  11300000
*          DO Z=1 TO SUM     BY +1; /* SCAN DEVICE TAB ADDRESS  X03008* 11310000
         LA    @A,1                                               0399  11320000
         BC    15,@DO9DB                                          0399  11330000
*            IF NEWADDR=HXADDR THEN /* IS NEW ENTRY EQ OLD ENTRYX03008* 11340000
@DO9DC   L     @1,LOOPPTR                                         0400  11350000
         CLC   NEWADDR(4),32(@1)                                  0400  11360000
*              GOTO CECDE40A;       /* YES, ERROR               X03008* 11370000
         BC    08,CECDE40A                                        0401  11380000
*            LOOPPTR=LOOPPTR+TABLNGTH; /* INDEX BASE CHECK NEXT X03008* 11390000
         LH    @F,TABLNGTH                                        0402  11400000
         A     @F,LOOPPTR                                         0402  11410000
         ST    @F,LOOPPTR                                         0402  11420000
*          END;                     /* NO DUP ADDR FOUND        X03008* 11430000
*        GEN(BR     R7);            /* RETURN TO PROCESSING     X03008* 11440000
         AH    @A,@D1                                             0403  11450000
@DO9DB   MVC   @TEMP3+1(3),SUM                                    0403  11460000
         C     @A,@TEMP3                                          0403  11470000
         BC    12,@DO9DC                                          0403  11480000
         BR     R7                                                      11490000
         DS    0H                                                       11500000
* CECDEV40:                                                   /*X03008* 11510000
*        /******************************************************X03008* 11520000
*        /*                                                     X03008* 11530000
*        /* OUTPUT IFD252I NO MIX OF ADDR AND SYMBOLIC IN DEV INPUT   * 11540000
*        /*                                                     X03008* 11550000
*        /******************************************************X03008* 11560000
*        R1=MSGPTR52;               /* SET MSG PTR TO IFD252I   X03008* 11570000
CECDEV40 L     @1,28(0,@4)                                        0405  11580000
*        GEN(PWTO  REG=(1));        /* ISSUE MESSAGE            X03008* 11590000
         PWTO  REG=(1)                                                  11600000
         DS    0H                                                       11610000
*        GEN(BAL   R7,CECDE40B);    /* CLEAR DEVICE TABLE       X03008* 11620000
         BAL   R7,CECDE40B                                              11630000
         DS    0H                                                       11640000
*        GOTO CECDEV46;             /* ISSUE PROMPTING          X03008* 11650000
         BC    15,CECDEV46                                        0408  11660000
* CECDE40A:                                                   /*X03008* 11670000
*        /******************************************************X03008* 11680000
*        /*                                                     X03008* 11690000
*        /* OUTPUT IFD251I DUPLICATE ENTRIES IN DEVICE FEILD    X03008* 11700000
*        /*                                                     X03008* 11710000
*        /******************************************************X03008* 11720000
*        R1=MSGPTR51;               /* SET MSG PTR TO IFD251I   X03008* 11730000
CECDE40A L     @1,24(0,@4)                                        0409  11740000
*        GEN(PWTO  REG=(1));        /* ISSUE MESSAGE            X03008* 11750000
         PWTO  REG=(1)                                                  11760000
         DS    0H                                                       11770000
*        GEN(BAL   R7,CECDE40B);    /* CLEAR DEVICE TABLE       X03008* 11780000
         BAL   R7,CECDE40B                                              11790000
         DS    0H                                                       11800000
*        GOTO CECDEV46;             /* ISSUE PROMPTING          X03008* 11810000
         BC    15,CECDEV46                                        0412  11820000
* CECDE40B:                                                   /*X03008* 11830000
*        /******************************************************X03008* 11840000
*        /*                                                     X03008* 11850000
*        /* CLEAR DEVICE TABLE ON ERROR                         X03008* 11860000
*        /*                                                     X03008* 11870000
*        /******************************************************X03008* 11880000
*         R8=DEVTBPTR;              /* DEVICE TABLES            X03008* 11890000
CECDE40B L     @8,DEVTBPTR                                        0413  11900000
*         DO R9=TABLNGTH BY -1 TO 1;/* TABLE LENGTH             X03008* 11910000
         LH    @9,TABLNGTH                                        0414  11920000
         LTR   @9,@9                                              0414  11930000
         BC    12,@DO9D7                                          0414  11940000
*           DVT=DVT&&DVT;           /* ZERO TABLE AREA          X03008* 11950000
@DO9D8   XC    0(16,@8),0(@8)                                     0415  11960000
*           R8=ADDR(DVTN);          /* NEXT TABLE AREA          X03008* 11970000
         LA    @8,16(0,@8)                                        0416  11980000
*         END;                      /* DEVICE TABLE CLEARED     X03008* 11990000
*         GEN(BR   R7);             /* RETURN                   X03008* 12000000
         BCT   @9,@DO9D8                                          0417  12010000
@DO9D7   EQU   *                                                  0417  12020000
         BR   R7                                                        12030000
         DS    0H                                                       12040000
* CECDEV41:                                                    /*21050* 12050000
*         /************************************************************ 12060000
*         /*                                                          * 12070000
*         /*  PARALLEL PRINT MESSAGE IFD108I AND RETURN TO REDEFINE   * 12080000
*         /*                                                          * 12090000
*         /************************************************************ 12100000
*         ERRCODE='01';             /* SET ERROR CODE TO 01.          * 12110000
CECDEV41 MVC   ERRCODE(2),@C21                                    0419  12120000
*         GO TO CECDEV45;           /* GO PRINT MESSAGE.         21050* 12130000
         BC    15,CECDEV45                                        0420  12140000
* CECDEV43:                                                    /*21050* 12150000
*         ERRCODE='02';             /* SET ERROR CODE TO 02.          * 12160000
CECDEV43 MVC   ERRCODE(2),@C22                                    0421  12170000
* CECDEV45:                                                    /*21050* 12180000
*         R1=MSGPTR08;              /* GET POINTER TO MESSAGE.        * 12190000
CECDEV45 L     @1,0(0,@4)                                         0422  12200000
*         MSG108I(26:27)=ERRCODE;       /* PUT ERROR CODE IN MSG.     * 12210000
         MVC   37(2,@1),ERRCODE                                   0423  12220000
*         GEN(PWTO  REG=(1));       /* PRINT MESSAGE.                 * 12230000
         PWTO  REG=(1)                                                  12240000
         DS    0H                                                       12250000
* CECDEV46:                                                   /*X03906* 12260000
*        /******************************************************X03906* 12270000
*        /*                                                     X03906* 12280000
*        /* OUTPUT IFD161I PROMPTING                            X03906* 12290000
*        /*                                                     X03906* 12300000
*        /******************************************************X03906* 12310000
*         R1=MSGPTR61;              /* GET POINTER TO MESSAGE.        * 12320000
CECDEV46 L     @1,12(0,@4)                                        0425  12330000
*         GEN(PWTO  REG=(1));       /* PRINT MESSAGE.                 * 12340000
         PWTO  REG=(1)                                                  12350000
         DS    0H                                                       12360000
* CECDEV47:                                                             12370000
*         /************************************************************ 12380000
*         /*    CHANGE RETURN POINT SO THAT TEST CAN BE REDEFINED     * 12390000
*         /************************************************************ 12400000
*         LEGALDEV='0'B;                /* INVALID D/T/O/ ENTRY.      * 12410000
CECDEV47 NI    OLTEPSW,B'11110111'                                0427  12420000
*         YOURR14=REDEFINE;         /* ALTER RETURN POINT TO IFDOLT30.* 12430000
         L     @1,4(0,@D)                                         0428  12440000
         MVC   12(4,@1),REDEFINE                                  0428  12450000
* CECDEV49:                                                    /*21050* 12460000
*         /************************************************************ 12470000
*         /*                    RETURN TO CALLER                      * 12480000
*         /************************************************************ 12490000
*         DPMSGREI='0'B;                /* TURN OFF DP MSG REI  XM9156* 12500000
CECDEV49 NI    A00013,B'11111110'                                 0429  12510000
*         RETURN;                                                       12520000
*         END;                                                          12530000
@EL01    L     @D,4(0,@D)                                         0431  12540000
         LM    @E,@C,12(@D)                                       0431  12550000
         BCR   15,@E                                              0431  12560000
@DATA1   EQU   *                                                        12570000
@0       EQU   00                  EQUATES FOR REGISTERS 0-15           12580000
@1       EQU   01                                                       12590000
@2       EQU   02                                                       12600000
@3       EQU   03                                                       12610000
@4       EQU   04                                                       12620000
@5       EQU   05                                                       12630000
@6       EQU   06                                                       12640000
@7       EQU   07                                                       12650000
@8       EQU   08                                                       12660000
@9       EQU   09                                                       12670000
@A       EQU   10                                                       12680000
@B       EQU   11                                                       12690000
@C       EQU   12                                                       12700000
@D       EQU   13                                                       12710000
@E       EQU   14                                                       12720000
@F       EQU   15                                                       12730000
@D1      DC    H'1'                                                     12740000
@D2      DC    H'3'                                                     12750000
@D3      DC    H'16'                                                    12760000
@MVC     MVC   0(1,@A),0(@E)                                            12770000
@V1      DC    V(IFDMSG31)                                              12780000
         DS    0F                                                       12790000
@X11     DC    X'00000000'                                              12800000
@C12     DC    C'0999'                                                  12810000
@C13     DC    C'00000000'                                              12820000
@C15     DC    C'NDR/'                                                  12830000
@C17     DC    C'ONLINE ,'                                              12840000
@C18     DC    C'OFFLINE,'                                              12850000
@C2      DC    C'.N'                                                    12860000
@C14     DC    C'60'                                                    12870000
@C16     DC    C'31'                                                    12880000
@C21     DC    C'01'                                                    12890000
@C22     DC    C'02'                                                    12900000
@C19     DC    C'ALLOCATED  '                                           12910000
@C20     DC    C'UNALLOCATED'                                           12920000
         DS    0D                                                       12930000
@DATA    EQU   *                                                        12940000
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD                   12950000
R0       EQU   00000000            FULLWORD POINTER REGISTER            12960000
R1       EQU   00000001            3  BYTE  POINTER REGISTER            12970000
R2       EQU   00000002            FULLWORD POINTER REGISTER            12980000
R3       EQU   00000003            FULLWORD POINTER REGISTER            12990000
I        EQU   00000003            FULLWORD POINTER REGISTER            13000000
R4       EQU   00000004            FULLWORD POINTER REGISTER            13010000
R5       EQU   00000005            FULLWORD POINTER REGISTER            13020000
R7       EQU   00000007            FULLWORD POINTER REGISTER            13030000
GOODENT  EQU   00000006            3  BYTE  POINTER REGISTER            13040000
UCBLOOK  EQU   00000007            3  BYTE  POINTER REGISTER            13050000
R8       EQU   00000008            FULLWORD POINTER REGISTER            13060000
DEVTABPT EQU   00000008            FULLWORD POINTER REGISTER            13070000
R9       EQU   00000009            3  BYTE  POINTER REGISTER            13080000
Z        EQU   00000010            3  BYTE  POINTER REGISTER            13090000
R13      EQU   00000013            FULLWORD POINTER REGISTER            13100000
R14      EQU   00000014            FULLWORD POINTER REGISTER            13110000
RC       EQU   00000015            FULLWORD POINTER REGISTER            13120000
R15      EQU   00000015            FULLWORD POINTER REGISTER            13130000
MYSAVE   EQU   00000000            8 BYTE(S) ON WORD                    13140000
A00000   EQU   MYSAVE+00000000     4 BYTE(S)                            13150000
YOURR13  EQU   MYSAVE+00000004     FULLWORD POINTER                     13160000
YOURSAVE EQU   00000000            16 BYTE(S) ON WORD                   13170000
A00001   EQU   YOURSAVE+00000000   12 BYTE(S)                           13180000
YOURR14  EQU   YOURSAVE+00000012   FULLWORD POINTER                     13190000
INPUTBUF EQU   00000000            10 BYTE(S)                           13200000
DEVTABXX EQU   00000000            56 BYTE(S)                           13210000
DEVADDR  EQU   DEVTABXX+00000000   8 BYTE(S)                            13220000
UCBADDR  EQU   DEVTABXX+00000008   4  BYTE  POINTER                     13230000
FLG1     EQU   DEVTABXX+00000012   1 BYTE(S)                            13240000
ONOFF    EQU   DEVTABXX+00000012   1 BIT(S)                             13250000
PRIMARY  EQU   DEVTABXX+00000012   1 BIT(S)                             13260000
A00017   EQU   DEVTABXX+00000013   1 BYTE(S)                            13270000
FLG3     EQU   DEVTABXX+00000014   1 BYTE(S)                            13280000
A00018   EQU   DEVTABXX+00000014   4 BIT(S)                             13290000
NOGODEV  EQU   DEVTABXX+00000014   1 BIT(S)                             13300000
SYSALLOC EQU   DEVTABXX+00000014   1 BIT(S)                             13310000
A00019   EQU   DEVTABXX+00000014   2 BIT(S)                             13320000
FLG4     EQU   DEVTABXX+00000015   1 BYTE(S)                            13330000
A00020   EQU   DEVTABXX+00000015   4 BIT(S)                             13340000
DEVVAR   EQU   DEVTABXX+00000015   1 BIT(S)                             13350000
DEVENQNG EQU   DEVTABXX+00000015   1 BIT(S)                             13360000
A00021   EQU   DEVTABXX+00000015   2 BIT(S)                             13370000
A00022   EQU   DEVTABXX+00000016   16 BYTE(S)                           13380000
HEXADDR  EQU   DEVTABXX+00000032   4 BYTE(S)                            13390000
CDSDVDSC EQU   DEVTABXX+00000036   4 BYTE(S)                            13400000
MODEL    EQU   DEVTABXX+00000036   1 BYTE(S)                            13410000
FEATURES EQU   DEVTABXX+00000037   1 BYTE(S)                            13420000
CLASS    EQU   DEVTABXX+00000038   1 BYTE(S)                            13430000
TYPE     EQU   DEVTABXX+00000039   1 BYTE(S)                            13440000
BYTECNT  EQU   DEVTABXX+00000040   1 BYTE(S)                            13450000
CDSFLAGS EQU   DEVTABXX+00000041   1 BYTE(S)                            13460000
A00023   EQU   DEVTABXX+00000041   4 BIT(S)                             13470000
SYMDEVIC EQU   DEVTABXX+00000041   1 BIT(S)                             13480000
A00024   EQU   DEVTABXX+00000041   2 BIT(S)                             13490000
REMLINE  EQU   DEVTABXX+00000041   1 BIT(S)                             13500000
EXTSGMSK EQU   DEVTABXX+00000042   2 BYTE(S)                            13510000
SYMNAME  EQU   DEVTABXX+00000044   8 BYTE(S)                            13520000
MSGPTR   EQU   00000000            44 BYTE(S) ON WORD                   13530000
MSGPTR08 EQU   MSGPTR+00000000     FULLWORD POINTER                     13540000
MSGPTR11 EQU   MSGPTR+00000004     FULLWORD POINTER                     13550000
MSGPTR79 EQU   MSGPTR+00000008     FULLWORD POINTER                     13560000
MSGPTR61 EQU   MSGPTR+00000012     FULLWORD POINTER                     13570000
MSGPTR27 EQU   MSGPTR+00000016     FULLWORD POINTER                     13580000
MSGPTR65 EQU   MSGPTR+00000020     FULLWORD POINTER                     13590000
MSGPTR51 EQU   MSGPTR+00000024     FULLWORD POINTER                     13600000
MSGPTR52 EQU   MSGPTR+00000028     FULLWORD POINTER                     13610000
MSGPTR14 EQU   MSGPTR+00000032     FULLWORD POINTER                     13620000
MSGPTR19 EQU   MSGPTR+00000036     FULLWORD POINTER                     13630000
MSGPTR67 EQU   MSGPTR+00000040     FULLWORD POINTER                     13640000
MSG108   EQU   00000000            40 BYTE(S) ON WORD                   13650000
A00025   EQU   MSG108+00000000     12 BYTE(S)                           13660000
MSG108I  EQU   MSG108+00000012     28 BYTE(S)                           13670000
MSG140   EQU   00000000            20 BYTE(S) ON WORD                   13680000
A00026   EQU   MSG140+00000000     12 BYTE(S)                           13690000
MSG140DV EQU   MSG140+00000012     8 BYTE(S)                            13700000
MSG467   EQU   00000000            20 BYTE(S) ON WORD                   13710000
A00027   EQU   MSG467+00000000     12 BYTE(S)                           13720000
MSG467DV EQU   MSG467+00000012     8 BYTE(S)                            13730000
MSG190   EQU   00000000            40 BYTE(S) ON WORD                   13740000
A00028   EQU   MSG190+00000000     12 BYTE(S)                           13750000
MSG109DV EQU   MSG190+00000012     8 BYTE(S)                            13760000
A00029   EQU   MSG190+00000020     1 BYTE(S)                            13770000
ONOROFF  EQU   MSG190+00000021     8 BYTE(S)                            13780000
ALORNOT  EQU   MSG190+00000029     11 BYTE(S)                           13790000
MSG179   EQU   00000000            39 BYTE(S) ON WORD                   13800000
A00030   EQU   MSG179+00000000     12 BYTE(S)                           13810000
MSG179I  EQU   MSG179+00000012     27 BYTE(S)                           13820000
MSG127   EQU   00000000            31 BYTE(S) ON WORD                   13830000
A00031   EQU   MSG127+00000000     12 BYTE(S)                           13840000
MSG127I  EQU   MSG127+00000012     19 BYTE(S)                           13850000
A00032   EQU   00000000            32 BYTE(S) ON WORD                   13860000
DVT      EQU   A00032+00000000     16 BYTE(S)                           13870000
DVTN     EQU   A00032+00000016     16 BYTE(S)                           13880000
SUM      EQU   @DATA+00000073      3  BYTE  POINTER ON WORD+1           13890000
SAVLOOKT EQU   @DATA+00000077      3  BYTE  POINTER ON WORD+1           13900000
PARMLIST EQU   @DATA+00000080      16 BYTE(S) ON WORD                   13910000
MODNAME  EQU   PARMLIST+00000000   8 BYTE(S)                            13920000
         ORG   PARMLIST+00000000                                        13930000
TCDSO    EQU   *                   1 BYTE(S)                            13940000
         DC    C'G'                                                     13950000
CDSDEV   EQU   PARMLIST+00000001   7 BYTE(S)                            13960000
TARGETAD EQU   PARMLIST+00000008   FULLWORD POINTER                     13970000
PARMFLGS EQU   PARMLIST+00000012   1 BYTE(S)                            13980000
A00033   EQU   PARMLIST+00000013   1 BYTE(S)                            13990000
CDSLNGTH EQU   PARMLIST+00000014   HALFWORD INTEGER                     14000000
COUNT    EQU   00000007            FULLWORD POINTER REGISTER            14010000
AVAILBLE EQU   @DATA+00000096      FULLWORD POINTER                     14020000
DEVTABLE EQU   00000000            56 BYTE(S)                           14030000
DEVAREA  EQU   @DATA+00000100      16 BYTE(S)                           14040000
FSTDEV   EQU   DEVAREA+00000000    4  BYTE  INTEGER                     14050000
FSTDEV2  EQU   DEVAREA+00000000    4 BYTE(S)                            14060000
HEX      EQU   DEVAREA+00000000    4 BYTE(S)                            14070000
FINDEV   EQU   DEVAREA+00000004    4  BYTE  INTEGER                     14080000
FINDEV2  EQU   DEVAREA+00000004    4 BYTE(S)                            14090000
LOOPPTR  EQU   @DATA+00000116      FULLWORD POINTER                     14100000
A00034   EQU   00000000            56 BYTE(S)                           14110000
A00035   EQU   A00034+00000000     32 BYTE(S)                           14120000
HXADDR   EQU   A00034+00000032     4 BYTE(S)                            14130000
A00036   EQU   A00034+00000036     8 BYTE(S)                            14140000
SYMBNM   EQU   A00034+00000044     8 BYTE(S)                            14150000
NEWADDR  EQU   @DATA+00000120      4 BYTE(S)                            14160000
LIMIT    EQU   @DATA+00000124      HALFWORD INTEGER                     14170000
X        EQU   @DATA+00000126      HALFWORD INTEGER                     14180000
UNITCTR  EQU   X+00000000          HALFWORD INTEGER                     14190000
A00037   EQU   X+00000000          1 BYTE(S)                            14200000
UNITCTR1 EQU   X+00000001          1 BYTE(S)                            14210000
ERRCODE  EQU   @DATA+00000128      2 BYTE(S)                            14220000
         ORG   @DATA+00000130                                           14230000
NUMBERS  EQU   *                   16 BYTE(S)                           14240000
         DC    C'0123456789ABCDEF'                                      14250000
NUMBER   EQU   00000000            1 BYTE(S)                            14260000
DEVAD    EQU   *                   8 BYTE(S)                            14270000
         DC    C'0000'                                                  14280000
         DC    00004C' '                                                14290000
DEVAD1   EQU   DEVAD+00000000      8 BYTE(S)                            14300000
SWITCHES EQU   @DATA+00000154      1 BYTE(S)                            14310000
FRSTPASS EQU   SWITCHES+00000000   1 BIT(S)                             14320000
UCBDVDSC EQU   00000016            4 BYTE(S)                            14330000
CDSENTRY EQU   00000000            20 BYTE(S)                           14340000
A00038   EQU   CDSENTRY+00000000   4 BYTE(S)                            14350000
DSCRPTRS EQU   CDSENTRY+00000004   4 BYTE(S)                            14360000
CHARCNTR EQU   @DATA+00000156      HALFWORD INTEGER                     14370000
         ORG   @DATA+00000158                                           14380000
EIGHT    EQU   *                   HALFWORD INTEGER                     14390000
         DC    FL2'8'                                                   14400000
BLANKFLD EQU   *                   8 BYTE(S)                            14410000
&T       SETA  00001                                                    14420000
.L099999 ANOP                                                           14430000
         DC    C' '                                                     14440000
         DC    00007C' '                                                14450000
SYMNAM   EQU   @DATA+00000168      8 BYTE(S)                            14460000
IGNORE   EQU   @DATA+00000176      HALFWORD INTEGER                     14470000
OFLGS    EQU   00000048            8 BIT(S) ON BYTE                     14480000
DDDUMMY  EQU   00000017            1 BYTE(S)                            14490000
         ORG   @DATA                                                    14500000
         DS    00000192C                                                14510000
@TEMPS   DS    0F                                                       14520000
@TEMP3   DC    F'0'                                                     14530000
@TEMP4   DC    F'0'                                                     14540000
         CNOP  0,4                                                      14550000
CNVRT1   DC    B'00000000'                                              14560000
         DC    AL1(2)                                                   14570000
         DC    CL2'41'                                                  14580000
         DC    A(DEVAD)                                                 14590000
         DC    A(HEX)                                                   14600000
C0021    DC    AL2(8+0)                                          21050  14610000
         CNOP  0,4                                                      14620000
CNVRT2   DC    B'00000000'                                              14630000
         DC    AL1(2)                                                   14640000
         DC    CL2'41'                                                  14650000
         DC    A(DEVAD)                                                 14660000
         DC    A(FINDEV2)                                               14670000
C0022    DC    AL2(8+0)                                          21050  14680000
         CNOP  0,4                                                      14690000
CNVRT3   DC    B'00000000'                                              14700000
         DC    AL1(2)                                                   14710000
         DC    CL2'41'                                                  14720000
         DC    A(FSTDEV2)                                               14730000
         DC    A(DEVAD)                                                 14740000
C0023    DC    AL2(4+32768)                                             14750000
DEVCOM   IFDCOM                                                         14760000
SCT      EQU   CHASCT+00000000     20 BYTE(S) ON WORD                   14770000
HEADER   EQU   SCT+00000000        8 BYTE(S)                            14780000
PRIDVSCT EQU   SCT+00000008        12 BYTE(S)                           14790000
OLTEPSW  EQU   CESWT+00000000      1 BYTE(S) ON WORD                    14800000
A00002   EQU   OLTEPSW+00000000    4 BIT(S)                             14810000
LEGALDEV EQU   OLTEPSW+00000000    1 BIT(S)                             14820000
REINT    EQU   OLTEPSW+00000000    1 BIT(S)                             14830000
OLTEPSW2 EQU   CESWT2+00000000     1 BYTE(S) ON WORD                    14840000
A00003   EQU   OLTEPSW2+00000000   3 BIT(S)                             14850000
CHANTEST EQU   OLTEPSW2+00000000   1 BIT(S)                             14860000
A00004   EQU   OLTEPSW2+00000000   1 BIT(S)                             14870000
NDR      EQU   OLTEPSW2+00000000   1 BIT(S)                             14880000
OLTEPSW7 EQU   CESWT7+00000000     1 BYTE(S) ON WORD                    14890000
INCLST   EQU   OLTEPSW7+00000000   1 BIT(S)                             14900000
RETTO31  EQU   OLTEPSW7+00000000   1 BIT(S)                             14910000
REMOTE   EQU   OLTEPSW7+00000000   1 BIT(S)                             14920000
LOADCDS  EQU   OLTEPSW7+00000000   1 BIT(S)                             14930000
OLTEPSW9 EQU   CESWT9+00000000     1 BYTE(S) ON WORD                    14940000
A00005   EQU   OLTEPSW9+00000000   5 BIT(S)                             14950000
MIXDEV   EQU   OLTEPSW9+00000000   1 BIT(S)                             14960000
A00006   EQU   OLTEPSW9+00000000   2 BIT(S)                             14970000
A00007   EQU   CESWTR+00000000     1 BYTE(S)                            14980000
RETAINAC EQU   A00007+00000000     1 BIT(S)                             14990000
A00008   EQU   A00007+00000000     1 BIT(S)                             15000000
REMNOMSG EQU   A00007+00000000     1 BIT(S)                             15010000
A00009   EQU   A00007+00000000     5 BIT(S)                             15020000
A00010   EQU   CESWTR1+00000000    1 BYTE(S)                            15030000
A00011   EQU   A00010+00000000     5 BIT(S)                             15040000
REMANS   EQU   A00010+00000000     1 BIT(S)                             15050000
A00012   EQU   A00010+00000000     2 BIT(S)                             15060000
A00013   EQU   CESWTR2+00000000    1 BYTE(S)                            15070000
A00014   EQU   A00013+00000000     2 BIT(S)                             15080000
ONCOMM   EQU   A00013+00000000     1 BIT(S)                             15090000
A00015   EQU   A00013+00000000     4 BIT(S)                             15100000
DPMSGREI EQU   A00013+00000000     1 BIT(S)                             15110000
SVCPLIST EQU   ROPT-00000004       16 BYTE(S) ON WORD                   15120000
A00016   EQU   SVCPLIST+00000000   2 BYTE(S)                            15130000
MODNUM   EQU   SVCPLIST+00000002   2 BYTE(S)                            15140000
ADDRDEV  EQU   SVCPLIST+00000004   FULLWORD POINTER                     15150000
ENTRIES  EQU   SVCPLIST+00000008   FULLWORD INTEGER                     15160000
SVCSAPTR EQU   SVCPLIST+00000012   FULLWORD POINTER                     15170000
@DATEND  EQU   *                                                        15180000
@9FD     EQU   CECDEV19                                                 15190000
@9F9     EQU   CECDEV03                                                 15200000
@9E1     EQU   CECDEV39                                                 15210000
         END    ,(C'PL/S',1400,75339)                                   15220000
