         TITLE 'IFDOLT33 OPTIONS DECODE'                                00010000
         TITLE 'IFDOLT33 OPTIONS DECODE'                                00020000
         LCLA  &T,&SPN                                            0002  00030000
.@001    ANOP                                                     0002  00040000
IFDOLT33 CSECT ,                                                  0002  00050000
         BC    15,24(0,@F)                                              00060000
         DC    C'IFDOLT33 14 FEB 78'                             0002  00070000
         STM   @E,@C,12(@D)                                       0002  00080000
         BALR  @B,0                                               0002  00090000
@PSTART  DS    0H                                                 0002  00100000
         USING @PSTART+00000,@B                                   0002  00110000
         ST    @D,@SAV001+4                                       0002  00120000
         LA    @F,@SAV001                                         0002  00130000
         ST    @F,8(0,@D)                                         0002  00140000
         LR    @D,@F                                              0002  00150000
*         GEN(USING CHASCT,2);                                          00160000
         USING CHASCT,2                                                 00170000
         DS    0H                                                       00180000
*         GENERATE DATA;                                                00190000
*         /************************************************************ 00200000
*         /*                        REGISTERS                         * 00210000
*         /************************************************************ 00220000
*         DCL R1 REG(1) PTR(31);         /* REGISTER 1.               * 00230000
*         DCL R2 REG(2) PTR(31);         /* REGISTER 2.               * 00240000
*         DCL R3 REG(3) PTR(31);         /* REGISTER 3.               * 00250000
*         DCL R4 REG(4) PTR(31);         /* REGISTER 4.               * 00260000
*         DCL R5 REG(5) PTR(31);         /* REGISTER 5.               * 00270000
*         DCL R6 REG(6) PTR(31);         /* REGISTER 6.               * 00280000
*         DCL I REG(7) PTR(24);          /* REGISTER 7.               * 00290000
*         DCL J REG(8) PTR(24);          /* REGISTER 8.               * 00300000
*         DCL R8 REG(8) PTR(31);         /* REGISTER 8.               * 00310000
*         DCL K REG(9) PTR(24);          /* REGISTER 9.               * 00320000
*         DCL R9 REG(9) PTR(24);         /* REGISTER 9.               * 00330000
*         DCL R13 REG(13) PTR(31);       /* REGISTER 13.              * 00340000
*         DCL R14 REG(14) PTR(31);       /* REGISTER 14.              * 00350000
*         DCL R15 REG(15) PTR(24);       /* REGISTER 15.              * 00360000
*         /************************************************************ 00370000
*         /*                       SAVE AREAS                         * 00380000
*         /************************************************************ 00390000
*         DCL 1 MYSAVE BASED(R13),                                      00400000
*               3 * CHAR(4),                                            00410000
*               3 YOURR13 PTR(31);                                      00420000
*         DCL 1 YOURSAVE BASED(YOURR13),                                00430000
*               3 * CHAR(12),                                           00440000
*               3 YOURR14 PTR(31);                                      00450000
*         /************************************************************ 00460000
*         /*                  SECTION CONTROL TABLE                   * 00470000
*         /************************************************************ 00480000
*         DCL CHASCT CHAR(88) GENERATED;                                00490000
*         DCL 1 SCT BASED(ADDR(CHASCT)), /*--------SCT FORMAT---------* 00500000
*               3 CELOOPCT FIXED(15),    /* ERROR LOOP COUNT.         * 00510000
*               3 TESTOPT CHAR(2),       /* OPTION FIELDS.            * 00520000
*                 5 OPTBYT CHAR(1),      /* FIRST OPTION FIELD.       * 00530000
*                   7 * BIT(5),          /* NOT LOOKED AT.            * 00540000
*                   7 NPR BIT(1),        /* PRINT FLAG.               * 00550000
*                   7 INDEFLP BIT(1),    /* NOT LOOKED AT.      Y02008* 00560000
*                   7 FRSTERR BIT(1),    /* FIRST ERROR COMM. FLAG.   * 00570000
*                 5 OPTBYTE CHAR(1),     /* SECOND OPTION FIELD.      * 00580000
*                   7 * BIT(2),          /* NOT LOOKED AT.            * 00590000
*                   7 UTCATAS BIT(1),    /* CATASTROPHIC ERROR FLAG.  * 00600000
*                   7 PP BIT(1),         /* PARALLEL PRINT FLAG  M1006* 00610000
*                   7 NCP BIT(1),        /* CONTROL PRINT FLAG.       * 00620000
*                   7 NEP BIT(1),        /* ERROR PRINT FLAG.         * 00630000
*                   7 EL BIT(1),         /* ERROR LOOP FLAG.          * 00640000
*                   7 TL BIT(1),         /* TEST LOOP FLAG.           * 00650000
*               3 * CHAR(29),            /* NOT LOOKED AT.            * 00660000
*               3 EXPGMFLG CHAR(1),      /* EXECUTIVE PROGRAM FLAGS.  * 00670000
*                 5 CECOMRPL BIT(1),     /* REPLY TO AN OUTSTANDING   * 00680000
*                                        /* OLT MESSAGE ISSUED BY     * 00690000
*                                        /* CECOM HAS BEEN MADE.      * 00700000
*                 5 MOREONE BIT(1),      /* MORE THAN 1 DEVICE TO BE  * 00710000
*                                        /* TESTED.                   * 00720000
*                 5 ROUTINES BIT(1),     /* OPERATOR HAS MADE ROUTINE * 00730000
*                                        /* SELECTION.                * 00740000
*                 5 ELCOUNT BIT(1),      /* OPERATOR HAS SPECIFIED A  * 00750000
*                                        /* COUNT FOR THE ERROR LOOP  * 00760000
*                                        /* OPTION.                   * 00770000
*                 5 FINAL BIT(1),        /* SET BY FINAL MACRO.       * 00780000
*                 5 CLEANUP BIT(1),      /* INDICATES CLEANUP ENTRY   * 00790000
*                                        /* FOR OLT.                  * 00800000
*               3 * CHAR(2),             /* NOT LOOKED AT.            * 00810000
*               3 FUNCFLGS CHAR(1),      /* OLT FUNCTIONAL FLAGS.     * 00820000
*                 5 MI BIT(1),           /* MANUAL INTERVENTION TESTS * 00830000
*                                        /* SELECTED BY THE OPERATOR. * 00840000
*             5 CLNUPPRV BIT(1),        /* INDICATES TO EXEC THAT     * 00850000
*                                       /* CLEANUP HAS BEEN PRO-      * 00860000
*                                       /* VIDED BY THE OLT.          * 00870000
*             5 * BIT(3),                                               00880000
*             5 TR BIT(1);              /* TRACE FUNCTION HAS   X02008* 00890000
*                                       /* BEEN REQSTD BY THE OLT     * 00900000
*         /************************************************************ 00910000
*         /*                        SWITCHES                          * 00920000
*         /************************************************************ 00930000
*         DCL CESWT CHAR(1) GENERATED;                                  00940000
*         DCL 1 OLTEPSW CHAR(1) BASED(ADDR(CESWT)),                     00950000
*               3 LEGALTST BIT(1),       /* LEGAL TEST FLAG.          * 00960000
*               3 * BIT(3),              /* NOT LOOKED AT.            * 00970000
*               3 LEGALDEV BIT(1),       /* LEGAL DEVICE FLAG.        * 00980000
*               3 REINT BIT(1),          /* RE-INITIALIZE FLAG.       * 00990000
*               3 FERINT BIT(1),         /* FIRST ERROR COMM. INTERVAL* 01000000
*               3 FERCOM BIT(1);         /* FIRST ERROR COMM. FLAG.   * 01010000
*         DCL CESWT1 CHAR(1) GENERATED;                                 01020000
*         DCL 1 OLTEPSW1 CHAR(1) BASED(ADDR(CESWT1)),                   01030000
*               3 * BIT(7),              /* NOT LOOKED AT.            * 01040000
*               3 TPFLAG BIT(1);         /* TP FLAG.                  * 01050000
*         DCL CESWT2 CHAR(1) GENERATED;                                 01060000
*         DCL 1 OLTEPSW2 CHAR(1) BASED(ADDR(CESWT2)),                   01070000
*               3 NDCFO BIT(1),                                         01080000
*               3 * BIT(3),                                             01090000
*               3 INITENT BIT(1);        /* INITIAL ENTRY FLAG.       * 01100000
*         DCL CESWT5 CHAR(1) GEND;                                      01110000
*         DCL 1 OLTEPSW5 CHAR(1) BASED(ADDR(CESWT5)),                   01120000
*              3 * BIT(7),                                              01130000
*               3 PRNTOPTN BIT(1);  /* PRINT OPTIONS FROM PREVIOUS21051 01140000
*                                   /* D/T/O/ ENTRY OR DEFAULT    21051 01150000
*                                   /* OPTNS ON FIRST ENTRY.      21051 01160000
*         DCL CESWT8 CHAR(1) GEND;      /* CESWT 8 IN COMM AREA X02008* 01170000
*         DCL 1 OLTEPSW8 CHAR(1) BASED(ADDR(CESWT8)),         /*X02008* 01180000
*           3 * BIT(7),                                                 01190000
*           3 TALKHERE BIT(1);          /* TALK VERB ENTERED IN X02008* 01200000
*                                       /* THIS COMM INTERVAL.  X02008* 01210000
*         DCL CESWTR CHAR(1) GENERATED;  /* RETAIN 370 SWITCHES S20203* 01220000
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR)),   /*             S20203* 01230000
*               3 RETAINAC BIT(1),       /* REI ACTIVE          S20203* 01240000
*               3 * BIT(1),              /*                     S20203* 01250000
*               3 REMNOMSG BIT(1),       /* REMOTE NO MSG       S20203* 01260000
*               3 * BIT(3),              /*                     S20203* 01270000
*               3 EXECOUT BIT(1),        /* MSG IFD104E ISSUED  S20203* 01280000
*               3 * BIT(1);              /*                     S20203* 01290000
*         DCL CESWTR1 CHAR(1) GENERATED; /*                     S20203* 01300000
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR1)),  /*             S20203* 01310000
*               3 * BIT(5),              /*                     S20203* 01320000
*               3 REMANS BIT(1),         /* REMOTE ANSWERS IM   S20203* 01330000
*               3 * BIT(2);              /*                     S20203* 01340000
*         DCL CESWTR2 CHAR(1) GENERATED;    /* REI SWITCHES     S20203* 01350000
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR2)),     /*          S20203* 01360000
*               2 REPLY00 BIT(1),        /* REPLY 00 TO MSG     S20203* 01370000
*               2 * BIT(1),              /*                     S20203* 01380000
*               2 ONCOMM BIT(1),         /* ONSITE ANSWERED FLG S20203* 01390000
*               2 * BIT(2),              /*                     S20203* 01400000
*               2 OPTERR BIT(1),         /*  ERROR IN OPT       S20203* 01410000
*               2 * BIT(1),                                             01420000
*               2 DPMSGREI BIT(1);      /* DP MODULE MSG BIT    YM2273* 01430000
*         DCL INBUFR CHAR(72) GENERATED;                                01440000
*         DCL INPUTBUF CHAR(7) BASED(R5);                               01450000
*         DCL PRTBUFR CHAR(1) GENERATED;                                01460000
*         DCL OPTSAVE CHAR(4);                                          01470000
*         DCL ELSAVE FIXED(15);                                         01480000
*         DCL TLSAVE FIXED(15);                                         01490000
*         DCL LVLSAVE CHAR(1);                                          01500000
*         DCL REISAVE CHAR(1);           /* CESWTR1 SAVEAREA    S20203* 01510000
*         DCL 1 SWITCHES CHAR(1),                                       01520000
*               3 FSTSCN BIT(1),         /*                     S20203* 01530000
*               3 TWOBYTE BIT(1),        /*                     S20203* 01540000
*               3 THREEB BIT(1),         /*                     S20203* 01550000
*               3 FOURBYTE BIT(1);       /*                     S20203* 01560000
*         DCL 1 OPTAB(10) CHAR(5)       /* OPTION TABLE         X02008* 01570000
*           INITIAL('D5C6C5FE01'X,                                      01580000
*                   'D5D4C97F80'X,                                      01590000
*                   'D5D7D9FB04'X,                                      01600000
*                   'D5D7D7EF10'X,       /*                      M1006* 01610000
*                   'D5E3D3FE01'X,                                      01620000
*                   'D5C5D3FD02'X,                                      01630000
*                   'D5C3D7F708'X,                                      01640000
*                   'D5C5D7FB04'X,       /*                     S20203* 01650000
*                   'D5D9C5FB04'X,                                      01660000
*                   'D5E3D9FB04'X),     /*    TRACE OPTION      X02008* 01670000
*                 5 OPTION CHAR(3),                                     01680000
*                   7 * CHAR(1),                                        01690000
*                   7 OPTION1 CHAR(2),                                  01700000
*                 5 AND CHAR(1),                                        01710000
*                 5 OR CHAR(1);                                         01720000
*         DCL NUMBERS CHAR(10) INIT('0123456789');                      01730000
*         DCL NUMBER CHAR(1) BASED(R6);                                 01740000
*         DCL 1 AREA CHAR(8) BDY(DWORD),                                01750000
*               3 DUMMY FIXED(31),                                      01760000
*                 5 * CHAR(3),                                          01770000
*                 5 I3 CHAR(1);                                         01780000
*         DCL CNVRT CHAR(5);                                            01790000
*         DCL INBUFPTR PTR(31) GENERATED;                               01800000
*         DCL DPLEVEL CHAR(1) GENERATED;                                01810000
*         DCL LEVELIND CHAR(1) BASED(ADDR(DPLEVEL));                    01820000
*         DCL DYNCOM CHAR(1) GENERATED;                                 01830000
*         DCL TLCOUNT FIXED(15) GENERATED;                              01840000
*         DCL TLRUN FIXED(15) BASED(ADDR(TLCOUNT)+6);                   01850000
*         DCL ECB3 CHAR(4) GENERATED;                                   01860000
*         DCL 1 ECB CHAR(4) BASED(ADDR(ECB3)),                          01870000
*               3 * CHAR(1),                                            01880000
*                 5 * BIT(1),                                           01890000
*                 5 ECB3POST BIT(1);                                    01900000
*         DCL DEVDEPAD PTR(31) GENERATED;                               01910000
*         DCL REGX PTR(31) GENERATED;                                   01920000
*         DCL PGMTAB CHAR(8) GENERATED;                                 01930000
*         DCL PGMTBL CHAR(8) BASED(ADDR(PGMTAB));                       01940000
*         DCL SECLST CHAR(10) GENERATED;                                01950000
*         DCL 1 SECLIST CHAR(10) BASED(ADDR(SECLST)),                   01960000
*               3 * CHAR(2),                                            01970000
*               3 SECLST2 CHAR(8);                                      01980000
*         DCL SECTUSE CHAR(1) GENERATED;                                01990000
*         DCL UNITUSE CHAR(1) GENERATED;                                02000000
*         DCL TUCBAD1 PTR(31) GENERATED;                                02010000
*         DCL TUCBAD2 PTR(31) GENERATED;                                02020000
*         DCL DEVTAB CHAR(896) GENERATED;                               02030000
*         DCL DEVTBPTR PTR GENERATED;                                   02040000
*         DCL 1 DEVTABLE BASED(DEVTBPTR),                               02050000
*               3 DEVICE(16) CHAR(56) BDY(WORD),                        02060000
*                 5 * CHAR(8),                                          02070000
*                 5 DVTABUCB PTR(31);                                   02080000
*         DCL REDEFINE PTR(31) GENERATED;                               02090000
*         DCL COMMINT PTR(31) GENERATED;                                02100000
*         DCL 1 MSGPTR BASED(R3),                                       02110000
*               3 MSGPTR04 PTR(31),                                     02120000
*               3 MSGPTR07 PTR(31),                                     02130000
*               3 MSGPTR15 PTR(31),                                     02140000
*               3 MSGPTR61 PTR(31),      /*                     S20203* 02150000
*           3 MSGPTXXX,                                                 02160000
*           3 MSGPTR27;                 /* MESSAGE IFD327I      X02008* 02170000
*         DCL 1 MSG327 BASED(R1),       /* EXT BUFFER MESSAGE.  X02008* 02180000
*           3 * CHAR(16),               /* FLAGS, MSG ID        X02008* 02190000
*           3 EXTMSG CHAR(55);          /* EXT MESSAGE BUFFER   X02008* 02200000
*         DCL 1 WTOR104D CHAR(8) BDY(WORD),                             02210000
*               3 REPLYAD PTR(31),                                      02220000
*                 5 REPLYLEN CHAR(1),                                   02230000
*               3 ECB3ADDR PTR(31);                                     02240000
*         DCL 1 MSG104 CHAR(79) BASED(R1),                              02250000
*               3 MSGPRFX CHAR(8),                                      02260000
*               3 * CHAR(4),                                            02270000
*               3 MSG104D CHAR(67);                                     02280000
*         DCL 1 MSG107 BASED(R1),                                       02290000
*               3 * CHAR(4),                                            02300000
*               3 MSG107I CHAR(51);                                     02310000
*         DCL 1 NEGMSG BASED(R8),                                       02320000
*               3 NOT CHAR(1);                                          02330000
*  DCL SAVR5 PTR;                        /*                      M4501* 02340000
*  DCL MSG115A CHAR(10) BASED(R1+38);    /*                      M4501* 02350000
*         DCL EXTBUF CHAR(56) GENERATED;                                02360000
*         DCL SATAB CHAR(12) GENERATED;                                 02370000
*         DCL OPSYS CHAR(1) BASED(ADDR(SATAB));                         02380000
*         DCL IFDMSG33 LABEL NONLOCAL EXTERNAL;                         02390000
*         RESTRICT(2,3,4,5,6,7,8,9);                                    02400000
*         /************************************************************ 02410000
*         /*                                                          * 02420000
*         /*               SETUP AND SAVE OLD OPTIONS                 * 02430000
*         /*                                                          * 02440000
*         /************************************************************ 02450000
*         IF INITENT='0'B THEN      /* IS THIS INITIAL CALL OF OPTION * 02460000
         TM    OLTEPSW2,B'00001000'                               0089  02470000
         BC    05,@9FF                                            0089  02480000
*           DO;                     /* DECODE MODULE. YES, SET THE    * 02490000
*           NCP='1'B;               /* DEFAULT OPTIONS INTO EFFECT.   * 02500000
         OI    SCT+3,B'00001000'                                  0091  02510000
*           FRSTERR='0'B;            /*     NFE DEFAULT       @ZA29758* 02520000
         NI    SCT+2,B'11111110'                                  0092  02530000
*           NPR='1'B;                                                   02540000
         OI    SCT+2,B'00000100'                                  0093  02550000
*           END;                    /* NO, CONTINUE.                  * 02560000
*         R3=ADDR(IFDMSG33);                                            02570000
@9FF     L     @1,@V1              ADDRESS OF IFDMSG33            0095  02580000
         LR    @3,@1                                              0095  02590000
*         IF TALKHERE='1'B THEN         /* IF TALK ENTERED THIS X02008* 02600000
         TM    OLTEPSW8,B'00000001'                               0096  02610000
*           GO TO CECNP46A;             /* COMM INTERVAL, GIVE  X02008* 02620000
         BC    01,CECNP46A                                        0097  02630000
*                                       /* OLT DYN COMM AGAIN.  X02008* 02640000
*         IF PRNTOPTN='1'B THEN     /* NEED OPTIONS PRINTED?      21051 02650000
         TM    OLTEPSW5,B'00000001'                               0098  02660000
*           GO TO CECOPT46;         /* YES, GO TO OPTN MSG.       21051 02670000
         BC    01,CECOPT46                                        0099  02680000
*         R5=INBUFPTR+1;            /* INCREMENT INBUFR POINTER.*/      02690000
         LA    @5,1                                               0100  02700000
         A     @5,INBUFPTR                                        0100  02710000
*         OPTSAVE(1:2)=TESTOPT;     /* SAVE OLD OPTIONS.            */  02720000
         MVC   OPTSAVE(2),SCT+2                                   0101  02730000
*         OPTSAVE(3)=EXPGMFLG;      /* SAVE EXECUTIVE PROGRAM FLAGS.*/  02740000
         MVC   OPTSAVE+2(1),SCT+33                                0102  02750000
*         OPTSAVE(4)=FUNCFLGS;      /* SAVE OLT FUNCTIONAL FLAGS.   */  02760000
         MVC   OPTSAVE+3(1),SCT+36                                0103  02770000
*         REISAVE=CESWTR1;               /* SAVE REI SWITCHES   S20203* 02780000
         MVC   REISAVE(1),CESWTR1                                 0104  02790000
*         LVLSAVE=LEVELIND;         /* SAVE LEVEL OF PRINTING. */       02800000
         MVC   LVLSAVE(1),LEVELIND                                0105  02810000
*         ELSAVE=CELOOPCT;          /* SAVE C.E. ERROR LOOP COUNT. */   02820000
         MVC   ELSAVE(2),SCT                                      0106  02830000
*         TLSAVE=TLCOUNT;           /* SAVE C.E. TEST LOOP COUNT. */    02840000
         MVC   TLSAVE(2),TLCOUNT                                  0107  02850000
*         LEGALTST='1'B;            /* SET LEGAL TEST INDICATOR TO ONE* 02860000
         OI    OLTEPSW,B'10000000'                                0108  02870000
*         IF INPUTBUF(1)='/' THEN   /* ARE DEFAULT OR EXISTING */       02880000
         CLI   0(@5),C'/'                                         0109  02890000
         BC    07,@9FE                                            0109  02900000
*           DO;                     /* OPTIONS DESIRED. YES,          * 02910000
*           R4=R5+1;                /* GO TO FINISH UP ROUTINE.       * 02920000
         LA    @4,1                                               0111  02930000
         AR    @4,@5                                              0111  02940000
*           GO TO CECOPT42;                                             02950000
         BC    15,CECOPT42                                        0112  02960000
*           END;                                                        02970000
* CECOPT01:                                                             02980000
*         /************************************************************ 02990000
*         /*          DETERMINE WHAT OPTIONS ARE SELECTED             * 03000000
*         /************************************************************ 03010000
*         FSTSCN='1'B;              /* SET FIRST SCAN */                03020000
@9FE     EQU   *                                                  0114  03030000
CECOPT01 OI    SWITCHES,B'10000000'                               0114  03040000
*                                   /* INDICATOR ON.  */                03050000
* CECOPT02:                                                             03060000
*  SAVR5=R5;                             /* SAVE ADDRESS         M4501* 03070000
CECOPT02 ST    @5,SAVR5                                           0115  03080000
*         /************************************************************ 03090000
*         /*                                                          * 03100000
*         /*       IS IT FIRST OR SECOND SCAN OF OPTION TABLE         * 03110000
*         /*                                                          * 03120000
*         /************************************************************ 03130000
*         IF FSTSCN^='1'B THEN      /* IS IT THE FIRST SCAN. NO, */     03140000
         TM    SWITCHES,B'10000000'                               0116  03150000
*           GO TO CECOPT10;         /* CHECK TWO BYTE OPTIONS.   */     03160000
         BC    12,CECOPT10                                        0117  03170000
*                                   /* YES, CHECK THREE BYTE OPTIONS.*/ 03180000
*         IF INPUTBUF(1:3)^=OPTION(1) THEN  /* IS NFE SPECIFIED. */     03190000
         CLC   0(3,@5),OPTAB                                      0118  03200000
*           GO TO CECOPT03;                 /* NO, CHECK NEXT    */     03210000
         BC    07,CECOPT03                                        0119  03220000
*                                           /* THREE BYTE OPTION.*/     03230000
*         OPTBYT=OPTBYT&AND(1);     /* YES, SET FIRST ERROR */          03240000
         NC    SCT+2(1),OPTAB+3                                   0120  03250000
*                                   /* COMM. INDICATOR OFF. */          03260000
*         GO TO CECOPT30;           /* GO TO ROUTINE THAT WILL */       03270000
         BC    15,CECOPT30                                        0121  03280000
*                                   /* DECODE DELIMITERS.      */       03290000
* CECOPT03:                                                             03300000
*         /************************************************************ 03310000
*         /*                                                          * 03320000
*         /*                 IS NMI OPTION SPECIFIED                  * 03330000
*         /*                                                          * 03340000
*         /************************************************************ 03350000
*         IF INPUTBUF(1:3)^=OPTION(2) THEN  /* IS NMI SPECIFIED. */     03360000
CECOPT03 CLC   0(3,@5),OPTAB+5                                    0122  03370000
*          GO TO CEOPT04A;              /* CHECK NTR OPTION.    X02008* 03380000
         BC    07,CEOPT04A                                        0123  03390000
*         FUNCFLGS=FUNCFLGS&AND(2); /* YES, SET MANUAL INT. */          03400000
         NC    SCT+36(1),OPTAB+8                                  0124  03410000
*                                   /* INDICATOR OFF.       */          03420000
*         GO TO CECOPT30;           /* GO TO ROUTINE THAT WILL */       03430000
         BC    15,CECOPT30                                        0125  03440000
*                                   /* DECODE DELIMITERS.      */       03450000
* CEOPT04A:                                                             03460000
*         /************************************************************ 03470000
*         /*                                                          * 03480000
*         /*          IS NTR OPTION SPECIFIED                   X02008* 03490000
*         /*                                                          * 03500000
*         /************************************************************ 03510000
*         IF INPUTBUF(1:3)^=OPTION(10) THEN                             03520000
CEOPT04A CLC   0(3,@5),OPTAB+45                                   0126  03530000
*          GO TO CECOPT04;              /* CHECK RE OPTION      X02008* 03540000
         BC    07,CECOPT04                                        0127  03550000
*          FUNCFLGS=FUNCFLGS&AND(10);   /* TURN OFF TR BIT IN SCT     * 03560000
         NC    SCT+36(1),OPTAB+48                                 0128  03570000
*          GO TO CECOPT30;              /* CHECK DELIMETER.     X02008* 03580000
         BC    15,CECOPT30                                        0129  03590000
*                                           /* THREE BYTE OPTION.*/     03600000
* CECOPT04:                                                             03610000
*         /************************************************************ 03620000
*         /*                                                          * 03630000
*         /*                 IS NPR OPTION SPECIFIED                  * 03640000
*         /*                                                          * 03650000
*         /************************************************************ 03660000
*         IF INPUTBUF(1:3)^=OPTION(3) THEN  /* IS NPR SPECIFIED. */     03670000
CECOPT04 CLC   0(3,@5),OPTAB+10                                   0130  03680000
*           GOTO CECOPT61;               /* NO, CHECK NEXT      S20203* 03690000
         BC    07,CECOPT61                                        0131  03700000
*                                           /* THREE BYTE OPTION.*/     03710000
*         OPTBYT=OPTBYT&AND(3);     /* YES, SET NO PRINT */             03720000
         NC    SCT+2(1),OPTAB+13                                  0132  03730000
*                                   /* INDICATOR OFF.    */             03740000
*         GO TO CECOPT30;           /* GO TO ROUTINE THAT WILL */       03750000
         BC    15,CECOPT30                                        0133  03760000
*                                   /* DECODE DELIMITERS.      */       03770000
* CECOPT61:                              /*                     S20203* 03780000
*         /************************************************************ 03790000
*         /*                                                          * 03800000
*         /*                  IS NRE OPTION SPECIFIED                 * 03810000
*         /*                                                          * 03820000
*         /************************************************************ 03830000
*         IF INPUTBUF(1:3)^=OPTION(9) THEN   /* IS NRE SPEC     S20203* 03840000
CECOPT61 CLC   0(3,@5),OPTAB+40                                   0134  03850000
*           GOTO CECOPT05;               /* NO. CHECK NEXT      S20203* 03860000
         BC    07,CECOPT05                                        0135  03870000
*                                        /* THREE BYTE OPTION   S20203* 03880000
*         REMANS='0'B;                   /* ZERO REMANS SWITCH  S20203* 03890000
         NI    A00016,B'11111011'                                 0136  03900000
*         GOTO CECOPT30;                 /* GOTO ROUTINE THAT   S20203* 03910000
         BC    15,CECOPT30                                        0137  03920000
*                                        /* WILL DECODE DELIM   S20203* 03930000
* CECOPT05:                                                             03940000
*         /************************************************************ 03950000
*         /*                                                          * 03960000
*         /*   IS SPECIFIED OPTION ONE OF THE OTHER 3 BYTE OPTIONS    * 03970000
*         /*                                                          * 03980000
*         /************************************************************ 03990000
*         DO I=8 TO 4 BY -1;              /* IS OPTION ANOTHER 3 */     04000000
CECOPT05 LA    @7,8                                               0138  04010000
*         IF INPUTBUF(1:3)=OPTION(I) THEN /* BYTE OPTION. YES,   */     04020000
@DO9FD   LR    @1,@7                                              0139  04030000
         MH    @1,@D1                                             0139  04040000
         LA    @E,OPTAB-5(@1)                                     0139  04050000
         CLC   0(3,@5),0(@E)                                      0139  04060000
*           GO TO CECOPT06;               /* CONTINUE PROCESSING.*/     04070000
         BC    08,CECOPT06                                        0140  04080000
*         END;                                                          04090000
*         FSTSCN='0'B;                    /* NO, SET FIRST SCAN  */     04100000
         BCTR  @7,0                                               0141  04110000
@DO9FC   CH    @7,@D2                                             0141  04120000
         BC    10,@DO9FD                                          0141  04130000
         NI    SWITCHES,B'01111111'                               0142  04140000
*         GO TO CECOPT10;                 /* INDICATOR OFF AND   */     04150000
         BC    15,CECOPT10                                        0143  04160000
*                                         /* CHECK IF OPTION     */     04170000
*                                         /* MIGHT BE A 2 BYTE   */     04180000
*                                         /* ONE.                */     04190000
* CECOPT06:                                                             04200000
*         /************************************************************ 04210000
*         /*                                                          * 04220000
*         /*                  IS NCP OR NEP SPECIFIED                 * 04230000
*         /*                                                          * 04240000
*         /************************************************************ 04250000
*         IF I=8 THEN               /* IS NEP SPECIFIED. YES, SET NEP * 04260000
CECOPT06 CH    @7,@D3                                             0144  04270000
         BC    07,@9F9                                            0144  04280000
*           OPTBYTE=OPTBYTE|OR(8);  /* INDICATOR ON AND CONTINUE      * 04290000
         OC    SCT+3(1),OPTAB+39                                  0145  04300000
         BC    15,@9F8                                            0146  04310000
*                                   /* DECODING.                      * 04320000
*         ELSE                                                          04330000
*         OPTBYTE=OPTBYTE&AND(I);   /* NO, SET NCP/NTL/NEL FLAG OFF.  * 04340000
@9F9     LR    @1,@7                                              0146  04350000
         MH    @1,@D1                                             0146  04360000
         LA    @E,OPTAB-2(@1)                                     0146  04370000
         NC    SCT+3(1),0(@E)                                     0146  04380000
*         IF I=5 THEN               /* IF NTL, ZERO TEST LOOP COUNT   * 04390000
@9F8     CH    @7,@D1                                             0147  04400000
         BC    07,@9F7                                            0147  04410000
*         DO;                                                           04420000
*          TLCOUNT=0;              /* CLEAR TL COUNT IN COMM AREA     * 04430000
         SR    @F,@F                                              0149  04440000
         STH   @F,TLCOUNT                                         0149  04450000
*          TLRUN =0;               /* CLEAR SCHEDULER COUNTER.  S21052* 04460000
         STH   @F,TLRUN                                           0150  04470000
*         END;                                                          04480000
*         IF I=6 THEN               /* IS NEL OPT SELECTED      Y02008* 04490000
@9F7     CH    @7,@D4                                             0152  04500000
         BC    07,@9F6                                            0152  04510000
*           DO;                     /* YES,                     Y02008* 04520000
*             INDEFLP = '0'B;       /* SET INFINITE LOOP OFF    Y02008* 04530000
         NI    SCT+2,B'11111101'                                  0154  04540000
*             ELCOUNT = '0'B;       /* SET COUNT LOOP OFF       Y02008* 04550000
         NI    SCT+33,B'11101111'                                 0155  04560000
*           END;                    /* NO, NEL NOT SELECTED     Y02008* 04570000
*         GO TO CECOPT30;           /* GO TO ROUTINE THAT */            04580000
         BC    15,CECOPT30                                        0157  04590000
*                                   /* DECODES DELIMITERS.*/            04600000
* CECOPT10:                                                             04610000
*         /************************************************************ 04620000
*         /*                                                          * 04630000
*         /*                   IS IT A 2 BYTE OPTION                  * 04640000
*         /*                                                          * 04650000
*         /************************************************************ 04660000
*         IF INPUTBUF(1:2)^=OPTION1(1) THEN /* IS FE SPECIFIED. */      04670000
CECOPT10 CLC   0(2,@5),OPTAB+1                                    0158  04680000
*           GO TO CECOPT11;                 /* NO, CHECK NEXT 2 */      04690000
         BC    07,CECOPT11                                        0159  04700000
*                                           /* BYTE OPTION.     */      04710000
*         OPTBYT=OPTBYT|OR(1);              /* YES, SET FIRST   */      04720000
         OC    SCT+2(1),OPTAB+4                                   0160  04730000
*                                           /* ERROR COMM.      */      04740000
*                                           /* INDICATOR ON.    */      04750000
*         GO TO CECOPT29;           /* GO TO ROUTINE THAT WILL */       04760000
         BC    15,CECOPT29                                        0161  04770000
*                                   /* DECODE DELIMITERS.      */       04780000
* CECOPT11:                                                             04790000
*         /************************************************************ 04800000
*         /*                                                          * 04810000
*         /*                     IS MI SPECIFIED                      * 04820000
*         /*                                                          * 04830000
*         /************************************************************ 04840000
*         IF INPUTBUF(1:2)^=OPTION1(2) THEN  /* IS MI SPECIFIED. */     04850000
CECOPT11 CLC   0(2,@5),OPTAB+6                                    0162  04860000
*           GO TO CECOPT12;                  /* NO, CHECK NEXT 2 */     04870000
         BC    07,CECOPT12                                        0163  04880000
*                                            /* BYTE OPTION.     */     04890000
*         FUNCFLGS=FUNCFLGS|OR(2);           /* YES, SET MANUAL  */     04900000
         OC    SCT+36(1),OPTAB+9                                  0164  04910000
*                                            /* INTERVENTION IND.*/     04920000
*                                            /* ON AND CONTINUE  */     04930000
*                                            /* DECODING.        */     04940000
*         GO TO CECOPT29;           /* GO TO ROUTINE THAT WILL */       04950000
         BC    15,CECOPT29                                        0165  04960000
*                                   /* DECODE DELIMITERS.      */       04970000
* CECOPT12:                                                             04980000
*         /************************************************************ 04990000
*         /*                                                          * 05000000
*         /*                     IS PR SPECIFIED                      * 05010000
*         /*                                                          * 05020000
*         /************************************************************ 05030000
*         IF INPUTBUF(1:2)^=OPTION1(3) THEN  /* IS PR SPECIFIED.  */    05040000
CECOPT12 CLC   0(2,@5),OPTAB+11                                   0166  05050000
*          GO TO CEOPT12A;              /* CHECK FOR TRACE FNCTNX02008* 05060000
         BC    07,CEOPT12A                                        0167  05070000
*         OPTBYT=OPTBYT|OR(3);      /* YES, SET PRINT FLAG ON.        * 05080000
         OC    SCT+2(1),OPTAB+14                                  0168  05090000
*                                            /* INDICATOR OFF.    */    05100000
*         GO TO CECOPT29;           /* GO TO ROUTINE THAT WILL */       05110000
         BC    15,CECOPT29                                        0169  05120000
*                                   /* DECODE DELIMITERS.      */       05130000
* CEOPT12A:                                                             05140000
*         /************************************************************ 05150000
*         /*                                                          * 05160000
*         /*          IS TR OPTION SPECIFIED                    X02008* 05170000
*         /*                                                          * 05180000
*         /************************************************************ 05190000
*         IF INPUTBUF(1:2)^=OPTION1(10) THEN                            05200000
CEOPT12A CLC   0(2,@5),OPTAB+46                                   0170  05210000
*          GO TO CECOPT60;              /* CHECK FOR RE OPTION. X02008* 05220000
         BC    07,CECOPT60                                        0171  05230000
*          FUNCFLGS=FUNCFLGS|OR(10);    /* TURN ON TR BIT IN SCTX02008* 05240000
         OC    SCT+36(1),OPTAB+49                                 0172  05250000
*          GOTO CECOPT29;               /* CHECK DELIMETER.     X02008* 05260000
         BC    15,CECOPT29                                        0173  05270000
*         /************************************************************ 05280000
*         /*                                                          * 05290000
*         /*                   IS RE SPECIFIED                        * 05300000
*         /*                                                          * 05310000
*         /************************************************************ 05320000
* CECOPT60:                              /*                     S20203* 05330000
*         IF INPUTBUF(1:2)^=OPTION1(9) THEN  /* IS RE SPECIFIED S20203* 05340000
CECOPT60 CLC   0(2,@5),OPTAB+41                                   0174  05350000
*           GOTO CECOPT13;                   /* NO.CHECK NEXT 2 S20203* 05360000
         BC    07,CECOPT13                                        0175  05370000
*         IF RETAINAC='1'B THEN              /* IS REI ACTIVE.  S20203* 05380000
         TM    A00012,B'10000000'                                 0176  05390000
         BC    12,@9F5                                            0176  05400000
*           DO;                              /*                 S20203* 05410000
*           REMANS='1'B;                 /* SET RE OPT FLAG     S20203* 05420000
         OI    A00016,B'00000100'                                 0178  05430000
*           GOTO CECOPT29;          /* GOTO ROUTINE THAT WILL   S20203* 05440000
         BC    15,CECOPT29                                        0179  05450000
*                                   /* DECODE DELIMITERS.       S20203* 05460000
*           END;                         /*                     S20203* 05470000
*         GOTO CECOPT33;                     /* NO.ERROR        S20203* 05480000
* CECOPT13:                                                             05490000
*         /************************************************************ 05500000
*         /*                                                          * 05510000
*         /*                     IS PP SPECIFIED                M1006*/ 05520000
*         /*                                                          * 05530000
*         /************************************************************ 05540000
*         IF INPUTBUF(1:2)^=OPTION1(4) THEN  /* IS PP SPECIFIED. M1006* 05550000
CECOPT13 CLC   0(2,@5),OPTAB+16                                   0182  05560000
*           GO TO CECOPT14;                  /* NO, CHECK NEXT 2  */    05570000
         BC    07,CECOPT14                                        0183  05580000
*                                            /* BYTE OPTION.      */    05590000
*         OPTBYTE=OPTBYTE|OR(4);             /* YES, SET ALTERNATE*/    05600000
         OC    SCT+3(1),OPTAB+19                                  0184  05610000
*                                            /* PRINTER IND. ON.  */    05620000
*         IF INPUTBUF(3)^='(' &        /* IS A LEVEL OF PRINTING */     05630000
*                                                                       05640000
*               INPUTBUF(5)^=')' THEN  /* SPECIFIED. NO, SET     */     05650000
         CLI   2(@5),C'('                                         0185  05660000
         BC    08,@9F4                                            0185  05670000
         CLI   4(@5),C')'                                         0185  05680000
         BC    08,@9F3                                            0185  05690000
*                 DO;                  /* DEFAULT AS LEVEL OF    */     05700000
*                 LEVELIND='2';                                         05710000
         MVI   LEVELIND,C'2'                                      0187  05720000
*                 GO TO CECOPT29;      /* PRINT AND GO DECODE    */     05730000
         BC    15,CECOPT29                                        0188  05740000
*                 END;                 /* DELIMITER.             */     05750000
*         IF INPUTBUF(4:5)='0)'|        /* CHECK DELIMITERS           * 05760000
*              INPUTBUF(4:5)='1)'|                                      05770000
*                INPUTBUF(4:5)='2)'|                                    05780000
*                  INPUTBUF(4:5)='3)' THEN                              05790000
@9F3     EQU   *                                                  0190  05800000
@9F4     CLC   3(2,@5),@C7                                        0190  05810000
         BC    08,@9F2                                            0190  05820000
         CLC   3(2,@5),@C8                                        0190  05830000
         BC    08,@9F1                                            0190  05840000
         CLC   3(2,@5),@C9                                        0190  05850000
         BC    08,@9F0                                            0190  05860000
         CLC   3(2,@5),@C10                                       0190  05870000
         BC    07,@9EF                                            0190  05880000
*               DO;                                                     05890000
@9F0     EQU   *                                                  0191  05900000
@9F1     EQU   *                                                  0191  05910000
*               LEVELIND=INPUTBUF(4); /* YES, PUT IT IN COMMON AREA */  05920000
@9F2     MVC   LEVELIND(1),3(@5)                                  0192  05930000
*               R5=R5+5;               /* INCREMENT INBUFR POINTER. */  05940000
         AH    @5,@D1                                             0193  05950000
*               GO TO CECOPT31;        /* DECODE DELIMITER FILLOWING */ 05960000
         BC    15,CECOPT31                                        0194  05970000
*               END;                   /* SPECIFIED OPTION.          */ 05980000
*         GO TO CECOPT33;              /* NO, ERROR IN OPTION FIELD  */ 05990000
* CECOPT14:                                                             06000000
*         /************************************************************ 06010000
*         /*                                                          * 06020000
*         /*   IS SPECIFIED OPTION ONE OF THE OTHER 2 BYTE OPTIONS    * 06030000
*         /*                                                          * 06040000
*         /************************************************************ 06050000
*         DO I=8 TO 5 BY -1;        /* IS OPTION ANOTHER 2 BYTE OPTION* 06060000
CECOPT14 LA    @7,8                                               0197  06070000
*         IF INPUTBUF(1:2)=OPTION1(I) THEN  /* YES, CONTINUE DECODING.* 06080000
@DO9EE   LR    @1,@7                                              0198  06090000
         MH    @1,@D1                                             0198  06100000
         LA    @E,OPTAB-4(@1)                                     0198  06110000
         CLC   0(2,@5),0(@E)                                      0198  06120000
*           GO TO CECOPT15;                                             06130000
         BC    08,CECOPT15                                        0199  06140000
*         END;                                                          06150000
*         GO TO CECOPT20;           /* NO, SEE IF EXT= IS SPECIFIED */  06160000
         BCTR  @7,0                                               0200  06170000
@DO9ED   CH    @7,@D1                                             0200  06180000
         BC    10,@DO9EE                                          0200  06190000
         BC    15,CECOPT20                                        0201  06200000
* CECOPT15:                                                             06210000
*         /************************************************************ 06220000
*         /*                                                          * 06230000
*         /*                    IS CP/EP SPECIFIED                    * 06240000
*         /*                                                          * 06250000
*         /************************************************************ 06260000
*         IF I=8 THEN               /* IS EP SPECIFIED. YES, SET EP   * 06270000
CECOPT15 CH    @7,@D3                                             0202  06280000
         BC    07,@9EA                                            0202  06290000
*           DO;                     /* INDICATOR OFF AND CONTINUE     * 06300000
*           OPTBYTE=OPTBYTE&AND(8); /* DECODING.                      * 06310000
         NC    SCT+3(1),OPTAB+38                                  0204  06320000
*           GO TO CECOPT29;         /* GO TO ROUTINE THAT WILL */       06330000
         BC    15,CECOPT29                                        0205  06340000
*           END;                    /* DECODE DELIMITERS.      */       06350000
*         OPTBYTE=OPTBYTE|OR(I);    /* SET TL/EL/CP INDICATOR ON.     * 06360000
@9EA     LR    @1,@7                                              0207  06370000
         MH    @1,@D1                                             0207  06380000
         LA    @E,OPTAB-1(@1)                                     0207  06390000
         OC    SCT+3(1),0(@E)                                     0207  06400000
*         IF I=7 THEN               /* IF CP IS SPECIFIED, CONTINUE   * 06410000
         CH    @7,@D5                                             0208  06420000
*           GO TO CECOPT29;         /* DECODING.                      * 06430000
         BC    08,CECOPT29                                        0209  06440000
*         R5=R5+2;                  /* INCREMENT INBUFR POINTER. */     06450000
         AH    @5,@D6                                             0210  06460000
*         IF INPUTBUF(1)='(' THEN   /* IS A COUNT SPECIFIED IN */       06470000
         CLI   0(@5),C'('                                         0211  06480000
*                                   /* THE TL/EL OPTION.       */       06490000
*           GO TO CECOPT23;         /* YES, DECODE IT. */               06500000
         BC    08,CECOPT23                                        0212  06510000
*         IF I=5 THEN               /* IF NO COUNT IS SPECIFIED FOR  */ 06520000
         CH    @7,@D1                                             0213  06530000
         BC    07,@9E9                                            0213  06540000
*         DO;                                                           06550000
*          TLCOUNT=10;             /* TL, ASSIGN DEFAULT OF 10. S21052* 06560000
         LA    @F,10                                              0215  06570000
         STH   @F,TLCOUNT                                         0215  06580000
*          TLRUN=0;                /* CLEAR SCHEDULER COUNTER.  S21052* 06590000
         SR    @F,@F                                              0216  06600000
         STH   @F,TLRUN                                           0216  06610000
         BC    15,@9E8                                            0218  06620000
*         END;                                                          06630000
*         ELSE                      /* SET ERROR LOOP INDICATOR */      06640000
*           ELCOUNT='0'B;           /* IN SCT TO INDICATE C.E.  */      06650000
@9E9     NI    SCT+33,B'11101111'                                 0218  06660000
*                                   /* DID NOT SPECIFY A COUNT. */      06670000
*         GO TO CECOPT31;           /* GO TO ROUTINE THAT WILL */       06680000
         BC    15,CECOPT31                                        0219  06690000
*                                   /* DECODE DELIMITERS.      */       06700000
* CECOPT20:                                                             06710000
*         /************************************************************ 06720000
*         /*                                                          * 06730000
*         /*                     IS EXT= SPECIFIED                    * 06740000
*         /*                                                          * 06750000
*         /************************************************************ 06760000
*         IF INPUTBUF(1:4)^='EXT=' THEN /* IS EXT= PRESENT IN THE  */   06770000
CECOPT20 CLC   0(4,@5),@C11                                       0220  06780000
*           GO TO CECOPT33;             /* OPTION FIELD. NO, ERROR.*/   06790000
         BC    07,CECOPT33                                        0221  06800000
*         R5=R5+4;                  /* INCREMENT INBUFR POINTER. */     06810000
         AH    @5,@D2                                             0222  06820000
*         FOURBYTE='1'B;                 /* FOUR BYTE OPTION    S20203* 06830000
         OI    SWITCHES,B'00010000'                               0223  06840000
*         DO I=1 TO 55;             /* FIND FINAL SLASH. */             06850000
         LA    @7,1                                               0224  06860000
*         IF INPUTBUF(I)='/' THEN                                       06870000
@DO9E7   LR    @1,@7                                              0225  06880000
         LA    @A,0(@1,@5)                                        0225  06890000
         BCTR  @A,0                                               0225  06900000
         CLI   0(@A),C'/'                                         0225  06910000
         BC    07,@9E3                                            0225  06920000
*           DO;                                                         06930000
*           R4=R5+I;                                                    06940000
         LR    @4,@7                                              0227  06950000
         AR    @4,@5                                              0227  06960000
*           GO TO CECOPT21;                                             06970000
         BC    15,CECOPT21                                        0228  06980000
*           END;                                                        06990000
*         END;                                                          07000000
*         GO TO CECOPT33;           /* SLASH NOT FOUND BEFORE LIMIT */  07010000
@9E3     AH    @7,@D7                                             0230  07020000
@DO9E6   CH    @7,@D8                                             0230  07030000
         BC    12,@DO9E7                                          0230  07040000
         BC    15,CECOPT33                                        0231  07050000
*                                   /* REACHED. ERROR.              */  07060000
* CECOPT21:                                                             07070000
*         /************************************************************ 07080000
*         /*                                                          * 07090000
*         /*             DECODE WHAT IS IN THE EXT= FIELD             * 07100000
*         /*                                                          * 07110000
*         /************************************************************ 07120000
*         EXTBUF=EXTBUF&&EXTBUF;    /* CLEAR EXT AREA. */               07130000
CECOPT21 XC    EXTBUF(56),EXTBUF                                  0232  07140000
*         IF I=1 THEN               /* DOES EXT AREA CONTAIN    */      07150000
         CH    @7,@D7                                             0233  07160000
*           GO TO CECOPT22;         /* NOTHING.YES LEAVE EXT    */      07170000
         BC    08,CECOPT22                                        0234  07180000
*                                   /* AREA CLEAR.              */      07190000
*         EXTBUF(2:I)=INPUTBUF(1:I-1); /* PUT INFORMATION IN */         07200000
         LR    @E,@5                                              0235  07210000
         LR    @1,@7                                              0235  07220000
         SH    @1,@D6                                             0235  07230000
         LA    @A,EXTBUF+1                                        0235  07240000
         EX    @1,@MVC                                            0235  07250000
*                                      /* EXT AREA.          */         07260000
* CECOPT22:                                                             07270000
*         /************************************************************ 07280000
*         /*                PUT COUNT IN EXT BUFFER                   * 07290000
*         /************************************************************ 07300000
*         DUMMY=I-1;                /* CALCULATE AMOUNT OF INFORMATION* 07310000
CECOPT22 LR    @F,@7                                              0236  07320000
         BCTR  @F,0                                               0236  07330000
         ST    @F,AREA                                            0236  07340000
*                                   /* IN EXT= OPTION.                * 07350000
*         EXTBUF(1)=I3;             /* PUT THIS COUNT IN FIRST BYTE */  07360000
         MVC   EXTBUF(1),AREA+3                                   0237  07370000
*                                   /* OF EXT AREA.                 */  07380000
*         GO TO CECOPT42;           /* GO TO FINISH UP ROUTINE. */      07390000
         BC    15,CECOPT42                                        0238  07400000
* CECOPT23:                                                             07410000
*         /************************************************************ 07420000
*         /*                                                          * 07430000
*         /*              DECODE COUNT THAT WAS SPECIFIED             * 07440000
*         /*                                                          * 07450000
*         /************************************************************ 07460000
*         TWOBYTE='1'B;                  /* TWO BYTE OPTION     S20203* 07470000
CECOPT23 OI    SWITCHES,B'01000000'                               0239  07480000
*         IF I=6 THEN               /* IF  EL OPTION            Y02008* 07490000
         CH    @7,@D4                                             0240  07500000
         BC    07,@9E2                                            0240  07510000
*           DO;                     /* YES,                     Y02008* 07520000
*             INDEFLP = '0'B;       /* RESET INFINITE LOOP      Y02008* 07530000
         NI    SCT+2,B'11111101'                                  0242  07540000
*             IF INPUTBUF(2:3) = 'I)' THEN /* IS INF LOOP SELECTY02008* 07550000
         CLC   1(2,@5),@C12                                       0243  07560000
         BC    07,@9E1                                            0243  07570000
*               DO;                 /* YES,                     Y02008* 07580000
*                 INDEFLP = '1'B;   /* SET INFINITE LOOP ON     Y02008* 07590000
         OI    SCT+2,B'00000010'                                  0245  07600000
*                 R5 = R5+3;        /* INDEX TO END THIS OPT    Y02008* 07610000
         AH    @5,@D9                                             0246  07620000
*                 GOTO CECOPT31;    /* GO CHECK DELIMITER       Y02008* 07630000
         BC    15,CECOPT31                                        0247  07640000
*               END;                /* NO, NOT INFINITE SELECTIOY02008* 07650000
*             ELCOUNT = '1'B;       /* SET COUNT SELECT ON      Y02008* 07660000
@9E1     OI    SCT+33,B'00010000'                                 0249  07670000
*           END;                    /* NO, EL OPTION            Y02008* 07680000
*         DO K=2 TO 7;              /* DECODE NUMBER. */                07690000
@9E2     LA    @9,2                                               0251  07700000
*         R6=ADDR(NUMBERS);         /* INITIALIZE POINTER TO NUM. TAB.* 07710000
@DO9E0   LA    @6,NUMBERS                                         0252  07720000
*           DO J=10 TO 1 BY -1;     /* FIND LENGTH. */                  07730000
         LA    @8,10                                              0253  07740000
*           IF INPUTBUF(K)=NUMBER THEN /* IS THIS A VALID NUMBER. */    07750000
@DO9DC   LR    @1,@9                                              0254  07760000
         LA    @A,0(@1,@5)                                        0254  07770000
         BCTR  @A,0                                               0254  07780000
         CLC   0(1,@A),0(@6)                                      0254  07790000
*             GO TO CECOPT24;          /* YES, CHECK NEXT CHAR.   */    07800000
         BC    08,CECOPT24                                        0255  07810000
*           R6=R6+1;                   /* NO, INCREMENT PTR TO NUM.TAB* 07820000
         AH    @6,@D7                                             0256  07830000
*           END;                                                        07840000
*         IF K=2|                   /* IS THE NUMBER OF LENGTH 0 OR IS* 07850000
*              INPUTBUF(K)^=')' THEN/* THE NUMBER NOT ENCLOSED IN A ) * 07860000
         BCT   @8,@DO9DC                                          0257  07870000
         CH    @9,@D6                                             0258  07880000
         BC    08,@9D8                                            0258  07890000
         LR    @1,@9                                              0258  07900000
         LA    @A,0(@1,@5)                                        0258  07910000
         BCTR  @A,0                                               0258  07920000
         CLI   0(@A),C')'                                         0258  07930000
         BC    08,@9D7                                            0258  07940000
*            GO TO CECOPT33;        /* PARENTHESIS. YES, ERROR.       * 07950000
         BC    07,CECOPT33                                        0259  07960000
*         GO TO CECOPT25;           /* CONVERT THIS NUMBER.           * 07970000
         BC    15,CECOPT25                                        0260  07980000
* CECOPT24:                                                             07990000
*         END;                                                          08000000
* CECOPT25:                                                             08010000
*         /************************************************************ 08020000
*         /*                                                          * 08030000
*         /*                  CONVERT COUNT SPECIFIED                 * 08040000
*         /*                                                          * 08050000
*         /************************************************************ 08060000
*         CNVRT=CNVRT&&CNVRT;       /* CLEAR CONVERSION AREA. */        08070000
CECOPT24 AH    @9,@D7                                             0261  08080000
@DO9DF   CH    @9,@D5                                             0261  08090000
         BC    12,@DO9E0                                          0261  08100000
CECOPT25 XC    CNVRT(5),CNVRT                                     0262  08110000
*         CNVRT(8-K:5)=INPUTBUF(2:K-1); /* PLACE COUNT IN  */           08120000
         LA    @E,1(0,@5)                                         0263  08130000
         LA    @1,5                                               0263  08140000
         LCR   @C,@9                                              0263  08150000
         AH    @C,@D3                                             0263  08160000
         SR    @1,@C                                              0263  08170000
         LA    @A,CNVRT-1(@C)                                     0263  08180000
         EX    @1,@MVC                                            0263  08190000
*                                       /* CONVERSION AREA.*/           08200000
*         GEN;                          /* CONVERT IT. */               08210000
         PACK  AREA(8),CNVRT(5)                                         08220000
         CVB   R6,AREA                                                  08230000
         DS    0H                                                       08240000
*         IF R6>0 &                 /* IS COUNT WITH-IN LIMITS */       08250000
*               R6<32768 THEN       /* YES, PLACE COUNT  */             08260000
         LTR   @6,@6                                              0265  08270000
         BC    12,@9D6                                            0265  08280000
         C     @6,@D10                                            0265  08290000
         BC    10,@9D5                                            0265  08300000
*            DO;                    /* WHERE IT BELONGS. */             08310000
*            R5=R5+K;               /* INCREMENT INBUFR POINTER. */     08320000
         AR    @5,@9                                              0267  08330000
*            IF I=5 THEN            /* PUT TL COUNT IN COMMON AREA. */  08340000
         CH    @7,@D1                                             0268  08350000
         BC    07,@9D4                                            0268  08360000
*         DO;                                                           08370000
*          TLRUN=0;                /* CLEAR SCHEDULER FLAG      S21052* 08380000
         SR    @F,@F                                              0270  08390000
         STH   @F,TLRUN                                           0270  08400000
*          TLCOUNT=R6;             /* PUT TL COUNT IN COMM AREA S21052* 08410000
         STH   @6,TLCOUNT                                         0271  08420000
         BC    15,@9D3                                            0273  08430000
*         END;                                                          08440000
*            ELSE                                                       08450000
*              CELOOPCT=R6;         /* PUT EL COUNT IN SCT. */          08460000
@9D4     STH   @6,SCT                                             0273  08470000
*            GO TO CECOPT31;                                            08480000
         BC    15,CECOPT31                                        0274  08490000
*            END;                                                       08500000
*         GO TO CECOPT33;           /* ERROR. */                        08510000
* CECOPT29:                                                             08520000
*         /************************************************************ 08530000
*         /*                                                          * 08540000
*         /*              ROUTINE THAT DECODES DELIMITERS             * 08550000
*         /*                                                          * 08560000
*         /************************************************************ 08570000
*         TWOBYTE='1'B;                  /* VALID 2-BYTE OPT    S20203* 08580000
CECOPT29 OI    SWITCHES,B'01000000'                               0277  08590000
*         R5=R5+2;                  /* INCREMENT INBUFR POINTER */      08600000
         AH    @5,@D6                                             0278  08610000
*         GO TO CECOPT31;           /* DECODE DELIMITER. */             08620000
         BC    15,CECOPT31                                        0279  08630000
* CECOPT30:                                                             08640000
*         THREEB='1'B;                   /* VALID 3-BYTE OPT    S20203* 08650000
CECOPT30 OI    SWITCHES,B'00100000'                               0280  08660000
*         R5=R5+3;                  /* INCREMENT INBUFR POINTER. */     08670000
         AH    @5,@D9                                             0281  08680000
* CECOPT31:                                                             08690000
*         /************************************************************ 08700000
*         /*                   IS DELIMITER A COMMA                   * 08710000
*         /************************************************************ 08720000
*         IF INPUTBUF(1)^=',' THEN  /* IS CHAR IN INBUFR A COMMA. */    08730000
CECOPT31 CLI   0(@5),C','                                         0282  08740000
*           GO TO CECOPT32;         /* NO, FIND OUT WHAT IT IS.   */    08750000
         BC    07,CECOPT32                                        0283  08760000
*         TWOBYTE='0'B;                  /* ZERO 2-BYTE SWITCH  S20203* 08770000
         NI    SWITCHES,B'10001111'                               0284  08780000
*         THREEB='0'B;                   /* ZERO 3-BYTE SWITCH  S20203* 08790000
*         FOURBYTE='0'B;                 /*                     S20203* 08800000
*         R5=R5+1;                  /* YES, INCREMENT INBUFR POINTER. * 08810000
         AH    @5,@D7                                             0287  08820000
*         GO TO CECOPT01;           /* DECODE NEXT OPTION. */           08830000
         BC    15,CECOPT01                                        0288  08840000
* CECOPT32:                                                             08850000
*         /************************************************************ 08860000
*         /*                   IS DELIMITER A SLASH                   * 08870000
*         /************************************************************ 08880000
*         IF INPUTBUF(1)='/' THEN   /* IS CHAR IN INBUFR A SLASH.   */  08890000
CECOPT32 CLI   0(@5),C'/'                                         0289  08900000
         BC    07,@9D2                                            0289  08910000
*           DO;                     /* YES, GO TO FINISH UP ROUTINE.  * 08920000
*         TWOBYTE='0'B;                  /* ZERO 2-BYTE SWITCH  S20203* 08930000
         NI    SWITCHES,B'10001111'                               0291  08940000
*         THREEB='0'B;                   /* ZERO 3-BYTE SWITCH  S20203* 08950000
*         FOURBYTE='0'B;                 /*                     S20203* 08960000
*           R4=R5+1;                                                    08970000
         LA    @4,1                                               0294  08980000
         AR    @4,@5                                              0294  08990000
*           GO TO CECOPT42;                                             09000000
         BC    15,CECOPT42                                        0295  09010000
*           END;                                                        09020000
* CECOPT33:                                                             09030000
*         /************************************************************ 09040000
*         /*                                                          * 09050000
*         /*       RESTORE OLD OPTIONS, PRINT MESSAGE IFD115I         * 09060000
*         /*              AND RETURN TO REDEFINE TEST                 * 09070000
*         /*                                                          * 09080000
*         /************************************************************ 09090000
*         CESWTR1=REISAVE;               /* RESTORE REI FLAGS   S20203* 09100000
@9D2     EQU   *                                                  0297  09110000
CECOPT33 MVC   CESWTR1(1),REISAVE                                 0297  09120000
*         TESTOPT=OPTSAVE(1:2);     /* RESTORE OLD OPTIONS. */          09130000
         MVC   SCT+2(2),OPTSAVE                                   0298  09140000
*         EXPGMFLG=OPTSAVE(3);      /* RESTORE EXEC. PROGRAM FLAGS. */  09150000
         MVC   SCT+33(1),OPTSAVE+2                                0299  09160000
*         FUNCFLGS=OPTSAVE(4);      /* RESTORE OLT FUNCTIONAL FLAGS. */ 09170000
         MVC   SCT+36(1),OPTSAVE+3                                0300  09180000
*         LEVELIND=LVLSAVE;         /* RESTORE LEVEL OF PRINTING. */    09190000
         MVC   LEVELIND(1),LVLSAVE                                0301  09200000
*         CELOOPCT=ELSAVE;          /* RESTORE C.E. ERROR LOOP COUNT. * 09210000
         MVC   SCT(2),ELSAVE                                      0302  09220000
*         TLCOUNT=TLSAVE;           /* RESTORE C.E. TEST LOOP COUNT. */ 09230000
         MVC   TLCOUNT(2),TLSAVE                                  0303  09240000
*         IF OPTERR='1'B THEN            /*  NO MESSAGE         S20203* 09250000
         TM    A00019,B'00000100'                                 0304  09260000
*           GOTO CECOPT62;               /* BRANCH AROUND MSG   S20203* 09270000
         BC    01,CECOPT62                                        0305  09280000
*  DO I=2 TO 10 BY 1;                    /* CHECK FOR UPTO 10 BY M4501* 09290000
         LA    @7,2                                               0306  09300000
*    IF INPUTBUF(2)='/'|                 /* CHECK FOR SLASH      M4501* 09310000
*         INPUTBUF(2)=','|               /* CHECK FOR COMMA      M4501* 09320000
*           INPUTBUF(2)=' ' THEN         /* CHECK FOR BLANK      M4501* 09330000
@DO9D1   CLI   1(@5),C'/'                                         0307  09340000
         BC    08,@9CD                                            0307  09350000
         CLI   1(@5),C','                                         0307  09360000
         BC    08,@9CC                                            0307  09370000
         CLI   1(@5),C' '                                         0307  09380000
         BC    07,@9CB                                            0307  09390000
*          DO;                           /* DELIMITER FOUND      M4501* 09400000
@9CC     EQU   *                                                  0308  09410000
*           INPUTBUF(2)=' ';             /* BLANK OUT DELIMITER  M4501* 09420000
@9CD     MVI   1(@5),C' '                                         0309  09430000
*         GOTO CECOPT38;                 /* GO SETUP MESSAGE     M4501* 09440000
         BC    15,CECOPT38                                        0310  09450000
*          END;                          /* SEARCH COMPLETE      M4501* 09460000
*    R5=R5+1;                            /* NEXT INPUT LOCATION  M4501* 09470000
@9CB     AH    @5,@D7                                             0312  09480000
*  END;                                  /* SEARCH COMPLETE      M4501* 09490000
* CECOPT38:                              /*                      M4501* 09500000
*  R5=SAVR5;                             /* RESTORE ADDRESS      M4501* 09510000
         AH    @7,@D7                                             0313  09520000
@DO9D0   CH    @7,@D11                                            0313  09530000
         BC    12,@DO9D1                                          0313  09540000
CECOPT38 L     @5,SAVR5                                           0314  09550000
*         RESTRICT(1);                                                  09560000
*         R1=MSGPTR15;              /* GET POINTER TO MESSAGE IFD115I.* 09570000
         L     @1,8(0,@3)                                         0316  09580000
*         RELEASE (9);                                                  09590000
*         IF TWOBYTE='1'B THEN           /* ADJUST FOR 2-BYTE   S20203* 09600000
         TM    SWITCHES,B'01000000'                               0318  09610000
         BC    12,@9CA                                            0318  09620000
*           I=I+2;                       /* OPT AT BEGINNING    S20203* 09630000
         LA    @7,2(0,@7)                                         0319  09640000
*         IF THREEB='1'B THEN            /* ADJUST FOR 3-BYTE   S20203* 09650000
@9CA     TM    SWITCHES,B'00100000'                               0320  09660000
         BC    12,@9C9                                            0320  09670000
*           I=I+3;                       /* OPT AT BEGINNING    S20203* 09680000
         LA    @7,3(0,@7)                                         0321  09690000
*         IF FOURBYTE='1'B THEN          /*                     S20203* 09700000
@9C9     TM    SWITCHES,B'00010000'                               0322  09710000
         BC    12,@9C8                                            0322  09720000
*           I=I+4;                       /*                     S20203* 09730000
         LA    @7,4(0,@7)                                         0323  09740000
*         IF I>10 THEN                   /* SET MAX VALUE FOR I S20203* 09750000
@9C8     CH    @7,@D11                                            0324  09760000
         BC    12,@9C7                                            0324  09770000
*           I=10;                        /* IF I > 10           S20203* 09780000
         LA    @7,10                                              0325  09790000
*  MSG115A(1)=' ';                       /* CLEAR BYT            M4501* 09800000
@9C7     MVI   38(@1),C' '                                        0326  09810000
*  MSG115A(2:10)=MSG115A(1:9);           /* CLEAR ARE            M4501* 09820000
         MVC   39(9,@1),38(@1)                                    0327  09830000
*  MSG115A(1:I)=INPUTBUF(1:I);           /* PUT ERROR INTO MESS  M4501* 09840000
         LR    @E,@5                                              0328  09850000
         LR    @9,@7                                              0328  09860000
         BCTR  @9,0                                               0328  09870000
         LA    @A,38(0,@1)                                        0328  09880000
         EX    @9,@MVC                                            0328  09890000
*         RESTRICT (9);                                                 09900000
*         RELEASE(1);                                                   09910000
*         GEN(PWTO  REG=(1));       /* PRINT MESSAGE.                 * 09920000
         PWTO  REG=(1)                                                  09930000
         DS    0H                                                       09940000
*  CECOPT62:                             /*                     S20203* 09950000
*         TWOBYTE='0'B;                  /* ZERO 2-BYTE SWITCH  S20203* 09960000
CECOPT62 NI    SWITCHES,B'10001111'                               0332  09970000
*         THREEB='0'B;                   /* ZERO 3-BYTE SWITCH  S20203* 09980000
*         FOURBYTE='0'B;                 /*                     S20203* 09990000
*         OPTERR='0'B;                   /* ZERO FLAG           S20203* 10000000
         NI    A00019,B'11111011'                                 0335  10010000
*         RESTRICT(1);                                                  10020000
*         IF RETAINAC='1'B THEN          /* IS REI ACTIVE?      S20203* 10030000
         TM    A00012,B'10000000'                                 0337  10040000
         BC    12,@9C6                                            0337  10050000
*           DPMSGREI='1'B;              /* REPLY TO NO DP MSGS  XM9156* 10060000
         OI    A00019,B'00000001'                                 0338  10070000
*         R1=MSGPTR61;              /* GET POINTER TO MESSAGE IFD161I.* 10080000
@9C6     L     @1,12(0,@3)                                        0339  10090000
*         RELEASE(1);                                                   10100000
*         GEN(PWTO  REG=(1));       /* PRINT MESSAGE.                 * 10110000
         PWTO  REG=(1)                                                  10120000
         DS    0H                                                       10130000
*         DPMSGREI='0'B;                /* TURN OFF DM MSG FLG  XM9156* 10140000
         NI    A00019,B'11111110'                                 0342  10150000
*         OPTERR='1'B;                   /* SET ERROR FLAG      S2020O* 10160000
         OI    A00019,B'00000100'                                 0343  10170000
*         GO TO CECOPT50;           /* GO TO ROUTINE THAT FORCES TEST*/ 10180000
         BC    15,CECOPT50                                        0344  10190000
*                                   /* DEFINITION TO BE REDEFINED.   */ 10200000
* CECOPT42:                                                             10210000
*         /************************************************************ 10220000
*         /*                                                          * 10230000
*         /*                    FINISH UP ROUTINE                     * 10240000
*         /*                                                          * 10250000
*         /************************************************************ 10260000
*         R5=R4;                    /* PREPARE TO SCAN BUFR FOR BLANKS* 10270000
CECOPT42 LR    @5,@4                                              0345  10280000
*         R4=ADDR(PRTBUFR);         /* GET ADDRESS OF INBUFR END.     * 10290000
         LA    @4,PRTBUFR                                         0346  10300000
*         DO I=1 TO 72;             /* SCAN BUFFER.                   * 10310000
         LA    @7,1                                               0347  10320000
*           IF R5=R4 THEN           /* IS WHOLE BUFFER SCANNED. YES,  * 10330000
@DO9C5   CR    @5,@4                                              0348  10340000
*             GO TO CECOPT46;       /* FINISH UP.                     * 10350000
         BC    08,CECOPT46                                        0349  10360000
*           IF INPUTBUF(1)^=' ' THEN/*ERROR, RESTORE ALL PREVIOUS     * 10370000
         CLI   0(@5),C' '                                         0350  10380000
         BC    08,@9C1                                            0350  10390000
*             DO;                        /*                     S20203* 10400000
*             SAVR5=R5;                  /*                     S20203* 10410000
         ST    @5,SAVR5                                           0352  10420000
*             GO TO CECOPT33;       /* OPTIONS.                       * 10430000
         BC    15,CECOPT33                                        0353  10440000
*             END;                       /*                     S20203* 10450000
*           R5=R5+1;                /* POINT TO NEXT CHAR. IN INBUFR. * 10460000
@9C1     AH    @5,@D7                                             0355  10470000
*         END;                                                          10480000
* CECOPT46:                                                             10490000
*         IF MI='1'B & REMANS='1'B THEN  /* MI & RE BOTH        S20203* 10500000
         AH    @7,@D7                                             0356  10510000
@DO9C4   CH    @7,@D12                                            0356  10520000
         BC    12,@DO9C5                                          0356  10530000
CECOPT46 TM    SCT+36,B'10000000'                                 0357  10540000
         BC    12,@9C0                                            0357  10550000
         TM    A00016,B'00000100'                                 0357  10560000
         BC    12,@9BF                                            0357  10570000
*           DO;                          /*                     S20203* 10580000
*           R1=MSGPTXXX;                 /* GET MSG PTR         S20203* 10590000
         L     @1,16(0,@3)                                        0359  10600000
*           GEN(PWTO REG=(1));           /* PRINT MESSAGE       S20203* 10610000
         PWTO REG=(1)                                                   10620000
         DS    0H                                                       10630000
*         OPTERR='1'B;                   /* SET FLAG            S20203* 10640000
         OI    A00019,B'00000100'                                 0361  10650000
*           GOTO CECOPT33;               /* GO TO REDEFINE TEST S20203* 10660000
         BC    15,CECOPT33                                        0362  10670000
*           END;                         /*                     S20203* 10680000
*         /************************************************************ 10690000
*         /*              PWTO OPTIONS THAT ARE SELECTED              * 10700000
*         /************************************************************ 10710000
*         RESTRICT(1);                                                  10720000
@9BF     EQU   *                                                  0364  10730000
*         R1=MSGPTR07;              /* GET POINTER TO MESSAGE IFD107I.* 10740000
@9C0     L     @1,4(0,@3)                                         0365  10750000
*         R8=R1+24;                 /* GET POINTER TO BEGINNING OF */   10760000
         LA    @8,24                                              0366  10770000
         AR    @8,@1                                              0366  10780000
*                                   /* OPTIONS IN MESSAGE IFD107I. */   10790000
*         DO R9=10 TO 1 BY -1;          /* CHECK FOR OPTIONS    X02008* 10800000
         LA    @9,10                                              0367  10810000
*         NOT='N';                                                      10820000
@DO9BE   MVI   0(@8),C'N'                                         0368  10830000
*         R8=R8+4;                  /* STEP POINTER AND LOOP. */        10840000
         AH    @8,@D2                                             0369  10850000
*         END;                                                          10860000
*         IF FRSTERR='1'B THEN      /* IS IT NFE.      */               10870000
         BCT   @9,@DO9BE                                          0370  10880000
         TM    SCT+2,B'00000001'                                  0371  10890000
         BC    12,@9BA                                            0371  10900000
*           MSG107I(21)=' ';        /* NO, BLANK OUT N.*/               10910000
         MVI   24(@1),C' '                                        0372  10920000
*         IF MI='1'B THEN           /* YES. IS IT NMI. */               10930000
@9BA     TM    SCT+36,B'10000000'                                 0373  10940000
         BC    12,@9B9                                            0373  10950000
*           MSG107I(25)=' ';        /* NO, BLANK OUT N.*/               10960000
         MVI   28(@1),C' '                                        0374  10970000
*         IF PP='1'B THEN           /* YES. IS IT NPP.          M1006*/ 10980000
@9B9     TM    SCT+3,B'00010000'                                  0375  10990000
         BC    12,@9B8                                            0375  11000000
*           MSG107I(29)=' ';        /* NO, BLANK OUT N.*/               11010000
         MVI   32(@1),C' '                                        0376  11020000
*         IF TL='1'B THEN           /* YES. IS IT NTL. */               11030000
@9B8     TM    SCT+3,B'00000001'                                  0377  11040000
         BC    12,@9B7                                            0377  11050000
*           MSG107I(33)=' ';        /* NO, BLANK OUT N.*/               11060000
         MVI   36(@1),C' '                                        0378  11070000
*         IF EL='1'B THEN           /* YES. IS IT NEL. */               11080000
@9B7     TM    SCT+3,B'00000010'                                  0379  11090000
         BC    12,@9B6                                            0379  11100000
*           MSG107I(37)=' ';        /* NO, BLANK OUT N.*/               11110000
         MVI   40(@1),C' '                                        0380  11120000
*         IF NCP='1'B THEN          /* YES, IS IT NCP. */               11130000
@9B6     TM    SCT+3,B'00001000'                                  0381  11140000
         BC    12,@9B5                                            0381  11150000
*           MSG107I(41)=' ';        /* NO, BLANK OUT N.*/               11160000
         MVI   44(@1),C' '                                        0382  11170000
*         IF NEP='0'B THEN          /* YES. IS IT NEP. */               11180000
@9B5     TM    SCT+3,B'00000100'                                  0383  11190000
         BC    05,@9B4                                            0383  11200000
*           MSG107I(45)=' ';        /* NO, BLANK OUT N.*/               11210000
         MVI   48(@1),C' '                                        0384  11220000
*         IF NPR='1'B THEN          /* YES, IS IT NPR. */               11230000
@9B4     TM    SCT+2,B'00000100'                                  0385  11240000
         BC    12,@9B3                                            0385  11250000
*           MSG107I(49)=' ';        /* NO, BLANK OUT N.*/               11260000
         MVI   52(@1),C' '                                        0386  11270000
*         IF REMANS='1'B THEN            /* YES, IS IT NRE?     S20203* 11280000
@9B3     TM    A00016,B'00000100'                                 0387  11290000
         BC    12,@9B2                                            0387  11300000
*           MSG107I(53)=' ';             /* NO, BLANK OUT N     S20203* 11310000
         MVI   56(@1),C' '                                        0388  11320000
*         IF TR='1'B THEN               /* TRACE BIT ON?        X02008* 11330000
@9B2     TM    SCT+36,B'00000100'                                 0389  11340000
         BC    12,@9B1                                            0389  11350000
*          MSG107I(57)=' ';             /* ALTER MSG FOR TR.    X02008* 11360000
         MVI   60(@1),C' '                                        0390  11370000
*         IF PRNTOPTN='1'B THEN         /* PRINT OPTIONS HERE?        * 11380000
@9B1     TM    OLTEPSW5,B'00000001'                               0391  11390000
         BC    12,@9B0                                            0391  11400000
*          DO;                          /* SET UP FOR OPTION MSG      * 11410000
*          RELEASE(1);                                                  11420000
*          GEN(PWTO REG=(1));           /* OUTPUT MESSAGE.            * 11430000
         PWTO REG=(1)                                                   11440000
         DS    0H                                                       11450000
*            IF EXTBUF(1)^='00'X THEN   /* IS BUFFER FILLED?    X02008* 11460000
         CLI   EXTBUF,X'00'                                       0395  11470000
         BC    08,@9AF                                            0395  11480000
*             DO;                       /* YES, CHECK NEXT CHAR.      * 11490000
*             RESTRICT(1);                                              11500000
*             R1=MSGPTR27;              /* ADDRESS EXT MSG.           * 11510000
         L     @1,20(0,@3)                                        0398  11520000
*             EXTMSG=EXTBUF(2:56);      /* SET UP MSG BUFFER    X02008* 11530000
         MVC   16(55,@1),EXTBUF+1                                 0399  11540000
*             GEN(PWTO REG=(1));        /* OUTPUT EXT BUFFER          * 11550000
         PWTO REG=(1)                                                   11560000
         DS    0H                                                       11570000
*             RETURN;                                                   11580000
         BC    15,@EL01                                           0401  11590000
*             END;                                                      11600000
*          RETURN;                                                      11610000
*         END;                                                          11620000
*         RELEASE(1);                                                   11630000
*         IF UTCATAS='1'B THEN      /* IS REDEFINITION CAUSED BY   */   11640000
@9B0     TM    SCT+3,B'00100000'                                  0406  11650000
         BC    12,@9AE                                            0406  11660000
*           DO;                     /* RECOGNIZING OF CATASTROPHIC */   11670000
*                                   /* FAILURE.                    */   11680000
*           IF REINT='0'B THEN      /* YES, DID DEVICES AND OR   */     11690000
         TM    OLTEPSW,B'00000100'                                0408  11700000
         BC    05,@9AD                                            0408  11710000
*             UTCATAS='0'B;         /* TESTS CHANGE. NO, RESET   */     11720000
         NI    SCT+3,B'11011111'                                  0409  11730000
*                                   /* CATASTROPHIC BIT TO TELL  */     11740000
*                                   /* SCHEDULER REDEFINITION OF */     11750000
*                                   /* DEVICES&|TESTS DID NOT    */     11760000
*                                   /* OCCUR.                    */     11770000
*           GO TO CECOPT55;         /* RETURN TO IFDOLT30 AT THE */     11780000
         BC    15,CECOPT55                                        0410  11790000
*           END;                    /* POINT FISTERR6.           */     11800000
*         ELSE                      /* NO, DID DEVICES AND OR TESTS */  11810000
*         IF REINT='1'B THEN        /* CHANGE. YES, GO TO ROUTINE THAT* 11820000
@9AE     TM    OLTEPSW,B'00000100'                                0412  11830000
*           GO TO CECOPT43;         /* WILL CONTINUE TO FINISH UP.    * 11840000
         BC    01,CECOPT43                                        0413  11850000
* CECNP46A:                                                             11860000
*                                                                       11870000
*                                                                       11880000
*         TALKHERE='0'B;                /* CLEAR CECOM TALK FLG X02008* 11890000
@9AC     EQU   *                                                  0414  11900000
CECNP46A NI    OLTEPSW8,B'11111110'                               0414  11910000
*                                       /* FOR USE NEXT COMM INTX02008* 11920000
*         IF FERINT^='1'B THEN      /* NO, IS REDEFINITION CAUSED BY */ 11930000
         TM    OLTEPSW,B'00000010'                                0415  11940000
*           GO TO CECOPT45;         /* FIRST ERROR COMMUNICATION     */ 11950000
         BC    12,CECOPT45                                        0416  11960000
*                                   /* INTERVAL. NO, CONTINUE.       */ 11970000
*         IF NDCFO='1'B THEN        /* REISSUE OUTSTANDING WTOR FOR UT* 11980000
         TM    OLTEPSW2,B'10000000'                               0417  11990000
*           GO TO CECOPT45;                                             12000000
         BC    01,CECOPT45                                        0418  12010000
*         GO TO CECOPT55;           /* RETURN TO IFDOLT30 AT THE */     12020000
         BC    15,CECOPT55                                        0419  12030000
*                                   /* POINT FISTERR6.           */     12040000
* CECOPT43:/* CONTINUE FINISH UP ROUTINE */                             12050000
*         SECTUSE='00'X;            /* CLEAR SECTIONS USED COUNTER. */  12060000
CECOPT43 MVI   SECTUSE,X'00'                                      0420  12070000
*         UNITUSE='00'X;            /* CLEAR UNITS USE COUNTER. */      12080000
         MVI   UNITUSE,X'00'                                      0421  12090000
*         TUCBAD1=DVTABUCB(1);      /* INITIALIZE UCB POINTER.*/        12100000
         L     @1,DEVTBPTR                                        0422  12110000
         MVC   TUCBAD1(4),8(@1)                                   0422  12120000
*         IF TPFLAG='1'B THEN       /* IS IT TPTEST.*/ /* FOR OLD */    12130000
         TM    OLTEPSW1,B'00000001'                               0423  12140000
*           GO TO CECOPT44;         /* YES, SET DEVDEPAD TO POINT */    12150000
         BC    01,CECOPT44                                        0424  12160000
*                                   /* TO CHASCT+20.              */    12170000
*         DEVDEPAD=ADDR(CHASCT)+8;  /* INITIALIZE  DEVDEPAD */          12180000
         LA    @F,CHASCT+8                                        0425  12190000
         ST    @F,DEVDEPAD                                        0425  12200000
*         REGX=ADDR(DVTABUCB(1));   /* AND REGX             */          12210000
         LA    @F,8(0,@1)                                         0426  12220000
         ST    @F,REGX                                            0426  12230000
*         GO TO CECOPT45;                                               12240000
         BC    15,CECOPT45                                        0427  12250000
* CECOPT44: /* FOR OLD TP */                                            12260000
*         DEVDEPAD=ADDR(CHASCT)+20;                                     12270000
CECOPT44 LA    @F,CHASCT+20                                       0428  12280000
         ST    @F,DEVDEPAD                                        0428  12290000
*         REGX=ADDR(DVTABUCB(2));                                       12300000
         L     @1,DEVTBPTR                                        0429  12310000
         LA    @F,64(0,@1)                                        0429  12320000
         ST    @F,REGX                                            0429  12330000
*         TUCBAD2=DVTABUCB(2);                                          12340000
         MVC   TUCBAD2(4),64(@1)                                  0430  12350000
* CECOPT45:                                                             12360000
*         /************************************************************ 12370000
*         /*                                                          * 12380000
*         /*      GIVE USER DYNAMIC COMMUNICATION POSSIBILITY         * 12390000
*         /*                                                          * 12400000
*         /************************************************************ 12410000
*         IF INITENT='0'B THEN      /* IS THIS THE INITIAL ENTRY.     * 12420000
CECOPT45 TM    OLTEPSW2,B'00001000'                               0431  12430000
         BC    05,@9AB                                            0431  12440000
*           DO;                     /* YES,                           * 12450000
*           ECB3POST='1'B;          /* FAKE POSTING ECB3.             * 12460000
         OI    ECB,B'01000000'                                    0433  12470000
*           INITENT='1'B;           /* INDICATE THAT FURTHER ENTRIES  * 12480000
         OI    OLTEPSW2,B'00001000'                               0434  12490000
*           END;                    /* WILL NOT BE INITIAL ENTRIES.   * 12500000
*         IF ECB3POST^='0'B THEN    /* HAS USER ABILITY TO FORCE */     12510000
@9AB     TM    ECB,B'01000000'                                    0436  12520000
         BC    08,@9AA                                            0436  12530000
*           DO;                     /* COMMUNICATION WITH OLTEP. NO */  12540000
*           ECB3=ECB3&&ECB3;        /* CLEAR ECB3 AND GIVE IT TO HIM*/  12550000
         XC    ECB3(4),ECB3                                       0438  12560000
*           REPLYAD=ADDR(DYNCOM);   /* GET NECESSARY INFORMATION */     12570000
         LA    @F,DYNCOM                                          0439  12580000
         ST    @F,WTOR104D                                        0439  12590000
*           REPLYLEN='01'X;         /* TO ISSUE WTOR.            */     12600000
         MVI   WTOR104D,X'01'                                     0440  12610000
*           ECB3ADDR=ADDR(ECB3);                                        12620000
         LA    @F,ECB3                                            0441  12630000
         ST    @F,WTOR104D+4                                      0441  12640000
*         IF RETAINAC='1'B               /* REI ACTIVE          S20203* 12650000
*           & REMANS='0'B                /* ONSITE IN CHARGE    S20203* 12660000
*               THEN DPMSGREI='1'B;     /* NO REPLY TO DP MSGS  XM9156* 12670000
         TM    A00012,B'10000000'                                 0442  12680000
         BC    12,@9A9                                            0442  12690000
         TM    A00016,B'00000100'                                 0442  12700000
         BC    05,@9A8                                            0442  12710000
         OI    A00019,B'00000001'                                 0443  12720000
*         EXECOUT='1'B;                  /* MSG 104E ISSUED     S20203* 12730000
@9A8     EQU   *                                                  0444  12740000
@9A9     OI    A00012,B'00000010'                                 0444  12750000
*         REPLY00='1'B;                  /* SET REPLY00 FLAG    S20203* 12760000
         OI    A00019,B'10000000'                                 0445  12770000
*           RESTRICT(1);                                                12780000
*           R1=MSGPTR04;            /* GET POINTER TO MESSAGE IFD104D.* 12790000
         L     @1,0(0,@3)                                         0447  12800000
*           MSGPRFX=WTOR104D;       /* PUT INFORMATION IN MESSAGE. */   12810000
         MVC   0(8,@1),WTOR104D                                   0448  12820000
*           RELEASE(1);                                                 12830000
*           GEN(PWTOR REG=(1),WAIT=NO);                                 12840000
         PWTOR REG=(1),WAIT=NO                                          12850000
         DS    0H                                                       12860000
*         REPLY00='0'B;                  /* ZERO REPLY00 FLAG   S20203* 12870000
         NI    A00019,B'01111110'                                 0451  12880000
*         DPMSGREI='0'B;                /* TURN OFF DPMSG FLAG  XM9156* 12890000
*           END;                                                        12900000
*         IF FERINT^='1'B THEN      /* IS THIS DYNAMIC COMMUNICATION. * 12910000
@9AA     TM    OLTEPSW,B'00000010'                                0454  12920000
*           GO TO CECOPT56;         /* NO, RETURN NORMALLY.           * 12930000
         BC    12,CECOPT56                                        0455  12940000
*         GO TO CECOPT55;           /* YES, RETURN TO OLTEP SCHEDULER.* 12950000
         BC    15,CECOPT55                                        0456  12960000
* CECOPT50:                                                             12970000
*         /************************************************************ 12980000
*         /*                                                          * 12990000
*         /*          RETURN AND REDEFINE TEST DEFINITION             * 13000000
*         /*                                                          * 13010000
*         /************************************************************ 13020000
*         YOURR14=REDEFINE;         /* PREPARE TO RETURN TO IFDOLT30 */ 13030000
CECOPT50 L     @1,4(0,@D)                                         0457  13040000
         MVC   12(4,@1),REDEFINE                                  0457  13050000
*                                   /* TO REDEFINE TEST.             */ 13060000
*         GO TO CECOPT56;           /* RETURN */                        13070000
         BC    15,CECOPT56                                        0458  13080000
* CECOPT55:                                                             13090000
*         /************************************************************ 13100000
*         /*                                                          * 13110000
*         /*         RETURN AFTER COMMUNICATION INTERVAL              * 13120000
*         /*                                                          * 13130000
*         /************************************************************ 13140000
*         IF REINT='1'B THEN        /* SHOULD CONTROL RETURN TO U.T.  * 13150000
CECOPT55 TM    OLTEPSW,B'00000100'                                0459  13160000
*           GO TO CECOPT56;         /* NO.                            * 13170000
         BC    01,CECOPT56                                        0460  13180000
*         YOURR14=COMMINT-4;        /* PREPARE TO RETURN.        21051* 13190000
         L     @F,COMMINT                                         0461  13200000
         SH    @F,@D2                                             0461  13210000
         L     @1,4(0,@D)                                         0461  13220000
         ST    @F,12(0,@1)                                        0461  13230000
*                                   /* AFTER COMMUNICATION INT  S20203* 13240000
* CECOPT56:                                                             13250000
*         /************************************************************ 13260000
*         /*                                                          * 13270000
*         /*                     RETURN TO CALLER                     * 13280000
*         /*                                                          * 13290000
*         /************************************************************ 13300000
*         ONCOMM='0'B;                   /* ZERO ONCOMM FLG     S20203* 13310000
CECOPT56 NI    A00019,B'11011111'                                 0462  13320000
*         IF FERINT='1'B &               /* DYN COMM            S2020O* 13330000
*           OPTERR='1'B THEN             /* OPT ERROR           S2020O* 13340000
         TM    OLTEPSW,B'00000010'                                0463  13350000
         BC    12,@9A7                                            0463  13360000
         TM    A00019,B'00000100'                                 0463  13370000
*           GOTO CECOPT63;               /*                     S20203* 13380000
         BC    03,CECOPT63                                        0464  13390000
*         REINT='0'B;               /* CLEAR REINT INDICATOR. */        13400000
@9A6     EQU   *                                                  0465  13410000
@9A7     NI    OLTEPSW,B'11111011'                                0465  13420000
*         NDCFO='0'B;               /* CLEAR DYN. COMM. BYPASS FLAG.  * 13430000
         NI    OLTEPSW2,B'01111111'                               0466  13440000
*         FERINT='0'B;              /* CLEAR FERINT INDICATOR.        * 13450000
         NI    OLTEPSW,B'11111101'                                0467  13460000
*    CECOPT63:                           /*                     S20203* 13470000
*         OPTERR='0'B;                   /* ZERO ERROR FLAG     S2020O* 13480000
CECOPT63 NI    A00019,B'11111011'                                 0468  13490000
*         RETURN;                                                       13500000
*         END;                                                          13510000
@EL01    L     @D,4(0,@D)                                         0470  13520000
         LM    @E,@C,12(@D)                                       0470  13530000
         BCR   15,@E                                              0470  13540000
@DATA1   EQU   *                                                        13550000
@0       EQU   00                  EQUATES FOR REGISTERS 0-15           13560000
@1       EQU   01                                                       13570000
@2       EQU   02                                                       13580000
@3       EQU   03                                                       13590000
@4       EQU   04                                                       13600000
@5       EQU   05                                                       13610000
@6       EQU   06                                                       13620000
@7       EQU   07                                                       13630000
@8       EQU   08                                                       13640000
@9       EQU   09                                                       13650000
@A       EQU   10                                                       13660000
@B       EQU   11                                                       13670000
@C       EQU   12                                                       13680000
@D       EQU   13                                                       13690000
@E       EQU   14                                                       13700000
@F       EQU   15                                                       13710000
@D10     DC    F'32768'                                                 13720000
@D1      DC    H'5'                                                     13730000
@D2      DC    H'4'                                                     13740000
@D3      DC    H'8'                                                     13750000
@D4      DC    H'6'                                                     13760000
@D5      DC    H'7'                                                     13770000
@D6      DC    H'2'                                                     13780000
@D7      DC    H'1'                                                     13790000
@D8      DC    H'55'                                                    13800000
@D9      DC    H'3'                                                     13810000
@D11     DC    H'10'                                                    13820000
@D12     DC    H'72'                                                    13830000
@MVC     MVC   0(1,@A),0(@E)                                            13840000
@V1      DC    V(IFDMSG33)                                              13850000
         DS    0F                                                       13860000
@C11     DC    C'EXT='                                                  13870000
@C7      DC    C'0)'                                                    13880000
@C8      DC    C'1)'                                                    13890000
@C9      DC    C'2)'                                                    13900000
@C10     DC    C'3)'                                                    13910000
@C12     DC    C'I)'                                                    13920000
         DS    0D                                                       13930000
@DATA    EQU   *                                                        13940000
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD                   13950000
R1       EQU   00000001            FULLWORD POINTER REGISTER            13960000
R2       EQU   00000002            FULLWORD POINTER REGISTER            13970000
R3       EQU   00000003            FULLWORD POINTER REGISTER            13980000
R4       EQU   00000004            FULLWORD POINTER REGISTER            13990000
R5       EQU   00000005            FULLWORD POINTER REGISTER            14000000
R6       EQU   00000006            FULLWORD POINTER REGISTER            14010000
I        EQU   00000007            3  BYTE  POINTER REGISTER            14020000
J        EQU   00000008            3  BYTE  POINTER REGISTER            14030000
R8       EQU   00000008            FULLWORD POINTER REGISTER            14040000
K        EQU   00000009            3  BYTE  POINTER REGISTER            14050000
R9       EQU   00000009            3  BYTE  POINTER REGISTER            14060000
R13      EQU   00000013            FULLWORD POINTER REGISTER            14070000
R14      EQU   00000014            FULLWORD POINTER REGISTER            14080000
R15      EQU   00000015            3  BYTE  POINTER REGISTER            14090000
MYSAVE   EQU   00000000            8 BYTE(S) ON WORD                    14100000
A00000   EQU   MYSAVE+00000000     4 BYTE(S)                            14110000
YOURR13  EQU   MYSAVE+00000004     FULLWORD POINTER                     14120000
YOURSAVE EQU   00000000            16 BYTE(S) ON WORD                   14130000
A00001   EQU   YOURSAVE+00000000   12 BYTE(S)                           14140000
YOURR14  EQU   YOURSAVE+00000012   FULLWORD POINTER                     14150000
INPUTBUF EQU   00000000            7 BYTE(S)                            14160000
OPTSAVE  EQU   @DATA+00000072      4 BYTE(S)                            14170000
ELSAVE   EQU   @DATA+00000076      HALFWORD INTEGER                     14180000
TLSAVE   EQU   @DATA+00000078      HALFWORD INTEGER                     14190000
LVLSAVE  EQU   @DATA+00000080      1 BYTE(S)                            14200000
REISAVE  EQU   @DATA+00000081      1 BYTE(S)                            14210000
SWITCHES EQU   @DATA+00000082      1 BYTE(S)                            14220000
FSTSCN   EQU   SWITCHES+00000000   1 BIT(S)                             14230000
TWOBYTE  EQU   SWITCHES+00000000   1 BIT(S)                             14240000
THREEB   EQU   SWITCHES+00000000   1 BIT(S)                             14250000
FOURBYTE EQU   SWITCHES+00000000   1 BIT(S)                             14260000
         ORG   @DATA+00000083                                           14270000
OPTAB    EQU   *                   10*5 BYTE(S)                         14280000
         DC    X'D5C6C5FE01'                                            14290000
         DC    X'D5D4C97F80'                                            14300000
         DC    X'D5D7D9FB04'                                            14310000
         DC    X'D5D7D7EF10'                                            14320000
         DC    X'D5E3D3FE01'                                            14330000
         DC    X'D5C5D3FD02'                                            14340000
         DC    X'D5C3D7F708'                                            14350000
         DC    X'D5C5D7FB04'                                            14360000
         DC    X'D5D9C5FB04'                                            14370000
         DC    X'D5E3D9FB04'                                            14380000
OPTION   EQU   OPTAB+00000000      3 BYTE(S)                            14390000
A00023   EQU   OPTAB+00000000      1 BYTE(S)                            14400000
OPTION1  EQU   OPTAB+00000001      2 BYTE(S)                            14410000
AND      EQU   OPTAB+00000003      1 BYTE(S)                            14420000
OR       EQU   OPTAB+00000004      1 BYTE(S)                            14430000
NUMBERS  EQU   *                   10 BYTE(S)                           14440000
         DC    C'0123456789'                                            14450000
NUMBER   EQU   00000000            1 BYTE(S)                            14460000
AREA     EQU   @DATA+00000144      8 BYTE(S) ON DWORD                   14470000
DUMMY    EQU   AREA+00000000       FULLWORD INTEGER                     14480000
A00024   EQU   AREA+00000000       3 BYTE(S)                            14490000
I3       EQU   AREA+00000003       1 BYTE(S)                            14500000
CNVRT    EQU   @DATA+00000152      5 BYTE(S)                            14510000
DEVTABLE EQU   00000000            896 BYTE(S) ON WORD                  14520000
DEVICE   EQU   DEVTABLE+00000000   16*56 BYTE(S) ON WORD                14530000
A00028   EQU   DEVTABLE+00000000   8 BYTE(S)                            14540000
DVTABUCB EQU   DEVTABLE+00000008   FULLWORD POINTER                     14550000
MSGPTR   EQU   00000000            24 BYTE(S) ON WORD                   14560000
MSGPTR04 EQU   MSGPTR+00000000     FULLWORD POINTER                     14570000
MSGPTR07 EQU   MSGPTR+00000004     FULLWORD POINTER                     14580000
MSGPTR15 EQU   MSGPTR+00000008     FULLWORD POINTER                     14590000
MSGPTR61 EQU   MSGPTR+00000012     FULLWORD POINTER                     14600000
MSGPTXXX EQU   MSGPTR+00000016     FULLWORD INTEGER                     14610000
MSGPTR27 EQU   MSGPTR+00000020     FULLWORD INTEGER                     14620000
MSG327   EQU   00000000            71 BYTE(S) ON WORD                   14630000
A00029   EQU   MSG327+00000000     16 BYTE(S)                           14640000
EXTMSG   EQU   MSG327+00000016     55 BYTE(S)                           14650000
WTOR104D EQU   @DATA+00000160      8 BYTE(S) ON WORD                    14660000
REPLYAD  EQU   WTOR104D+00000000   FULLWORD POINTER                     14670000
REPLYLEN EQU   WTOR104D+00000000   1 BYTE(S)                            14680000
ECB3ADDR EQU   WTOR104D+00000004   FULLWORD POINTER                     14690000
MSG104   EQU   00000000            79 BYTE(S)                           14700000
MSGPRFX  EQU   MSG104+00000000     8 BYTE(S)                            14710000
A00030   EQU   MSG104+00000008     4 BYTE(S)                            14720000
MSG104D  EQU   MSG104+00000012     67 BYTE(S)                           14730000
MSG107   EQU   00000000            55 BYTE(S) ON WORD                   14740000
A00031   EQU   MSG107+00000000     4 BYTE(S)                            14750000
MSG107I  EQU   MSG107+00000004     51 BYTE(S)                           14760000
NEGMSG   EQU   00000000            1 BYTE(S) ON WORD                    14770000
NOT      EQU   NEGMSG+00000000     1 BYTE(S)                            14780000
SAVR5    EQU   @DATA+00000168      FULLWORD POINTER                     14790000
MSG115A  EQU   00000038            10 BYTE(S)                           14800000
         ORG   @DATA                                                    14810000
         DS    00000172C                                                14820000
@TEMPS   DS    0F                                                       14830000
OPTCOMM  IFDCOM                                                         14840000
SCT      EQU   CHASCT+00000000     37 BYTE(S) ON WORD                   14850000
CELOOPCT EQU   SCT+00000000        HALFWORD INTEGER                     14860000
TESTOPT  EQU   SCT+00000002        2 BYTE(S)                            14870000
OPTBYT   EQU   SCT+00000002        1 BYTE(S)                            14880000
A00002   EQU   SCT+00000002        5 BIT(S)                             14890000
NPR      EQU   SCT+00000002        1 BIT(S)                             14900000
INDEFLP  EQU   SCT+00000002        1 BIT(S)                             14910000
FRSTERR  EQU   SCT+00000002        1 BIT(S)                             14920000
OPTBYTE  EQU   SCT+00000003        1 BYTE(S)                            14930000
A00003   EQU   SCT+00000003        2 BIT(S)                             14940000
UTCATAS  EQU   SCT+00000003        1 BIT(S)                             14950000
PP       EQU   SCT+00000003        1 BIT(S)                             14960000
NCP      EQU   SCT+00000003        1 BIT(S)                             14970000
NEP      EQU   SCT+00000003        1 BIT(S)                             14980000
EL       EQU   SCT+00000003        1 BIT(S)                             14990000
TL       EQU   SCT+00000003        1 BIT(S)                             15000000
A00004   EQU   SCT+00000004        29 BYTE(S)                           15010000
EXPGMFLG EQU   SCT+00000033        1 BYTE(S)                            15020000
CECOMRPL EQU   SCT+00000033        1 BIT(S)                             15030000
MOREONE  EQU   SCT+00000033        1 BIT(S)                             15040000
ROUTINES EQU   SCT+00000033        1 BIT(S)                             15050000
ELCOUNT  EQU   SCT+00000033        1 BIT(S)                             15060000
FINAL    EQU   SCT+00000033        1 BIT(S)                             15070000
CLEANUP  EQU   SCT+00000033        1 BIT(S)                             15080000
A00005   EQU   SCT+00000034        2 BYTE(S)                            15090000
FUNCFLGS EQU   SCT+00000036        1 BYTE(S)                            15100000
MI       EQU   SCT+00000036        1 BIT(S)                             15110000
CLNUPPRV EQU   SCT+00000036        1 BIT(S)                             15120000
A00006   EQU   SCT+00000036        3 BIT(S)                             15130000
TR       EQU   SCT+00000036        1 BIT(S)                             15140000
OLTEPSW  EQU   CESWT+00000000      1 BYTE(S)                            15150000
LEGALTST EQU   OLTEPSW+00000000    1 BIT(S)                             15160000
A00007   EQU   OLTEPSW+00000000    3 BIT(S)                             15170000
LEGALDEV EQU   OLTEPSW+00000000    1 BIT(S)                             15180000
REINT    EQU   OLTEPSW+00000000    1 BIT(S)                             15190000
FERINT   EQU   OLTEPSW+00000000    1 BIT(S)                             15200000
FERCOM   EQU   OLTEPSW+00000000    1 BIT(S)                             15210000
OLTEPSW1 EQU   CESWT1+00000000     1 BYTE(S)                            15220000
A00008   EQU   OLTEPSW1+00000000   7 BIT(S)                             15230000
TPFLAG   EQU   OLTEPSW1+00000000   1 BIT(S)                             15240000
OLTEPSW2 EQU   CESWT2+00000000     1 BYTE(S)                            15250000
NDCFO    EQU   OLTEPSW2+00000000   1 BIT(S)                             15260000
A00009   EQU   OLTEPSW2+00000000   3 BIT(S)                             15270000
INITENT  EQU   OLTEPSW2+00000000   1 BIT(S)                             15280000
OLTEPSW5 EQU   CESWT5+00000000     1 BYTE(S)                            15290000
A00010   EQU   OLTEPSW5+00000000   7 BIT(S)                             15300000
PRNTOPTN EQU   OLTEPSW5+00000000   1 BIT(S)                             15310000
OLTEPSW8 EQU   CESWT8+00000000     1 BYTE(S)                            15320000
A00011   EQU   OLTEPSW8+00000000   7 BIT(S)                             15330000
TALKHERE EQU   OLTEPSW8+00000000   1 BIT(S)                             15340000
A00012   EQU   CESWTR+00000000     1 BYTE(S)                            15350000
RETAINAC EQU   A00012+00000000     1 BIT(S)                             15360000
A00013   EQU   A00012+00000000     1 BIT(S)                             15370000
REMNOMSG EQU   A00012+00000000     1 BIT(S)                             15380000
A00014   EQU   A00012+00000000     3 BIT(S)                             15390000
EXECOUT  EQU   A00012+00000000     1 BIT(S)                             15400000
A00015   EQU   A00012+00000000     1 BIT(S)                             15410000
A00016   EQU   CESWTR1+00000000    1 BYTE(S)                            15420000
A00017   EQU   A00016+00000000     5 BIT(S)                             15430000
REMANS   EQU   A00016+00000000     1 BIT(S)                             15440000
A00018   EQU   A00016+00000000     2 BIT(S)                             15450000
A00019   EQU   CESWTR2+00000000    1 BYTE(S)                            15460000
REPLY00  EQU   A00019+00000000     1 BIT(S)                             15470000
A00020   EQU   A00019+00000000     1 BIT(S)                             15480000
ONCOMM   EQU   A00019+00000000     1 BIT(S)                             15490000
A00021   EQU   A00019+00000000     2 BIT(S)                             15500000
OPTERR   EQU   A00019+00000000     1 BIT(S)                             15510000
A00022   EQU   A00019+00000000     1 BIT(S)                             15520000
DPMSGREI EQU   A00019+00000000     1 BIT(S)                             15530000
LEVELIND EQU   DPLEVEL+00000000    1 BYTE(S)                            15540000
TLRUN    EQU   TLCOUNT+00000006    HALFWORD INTEGER                     15550000
ECB      EQU   ECB3+00000000       4 BYTE(S)                            15560000
A00025   EQU   ECB+00000000        1 BYTE(S)                            15570000
A00026   EQU   ECB+00000000        1 BIT(S)                             15580000
ECB3POST EQU   ECB+00000000        1 BIT(S)                             15590000
PGMTBL   EQU   PGMTAB+00000000     8 BYTE(S)                            15600000
SECLIST  EQU   SECLST+00000000     10 BYTE(S)                           15610000
A00027   EQU   SECLIST+00000000    2 BYTE(S)                            15620000
SECLST2  EQU   SECLIST+00000002    8 BYTE(S)                            15630000
OPSYS    EQU   SATAB+00000000      1 BYTE(S)                            15640000
@DATEND  EQU   *                                                        15650000
@9F6     EQU   CECOPT30                                                 15660000
@9F5     EQU   CECOPT33                                                 15670000
@9EF     EQU   CECOPT33                                                 15680000
@9E8     EQU   CECOPT31                                                 15690000
@9D8     EQU   CECOPT33                                                 15700000
@9D7     EQU   CECOPT25                                                 15710000
@9D3     EQU   CECOPT31                                                 15720000
@9D6     EQU   CECOPT33                                                 15730000
@9D5     EQU   CECOPT33                                                 15740000
@9AF     EQU   @EL01                                                    15750000
@9AD     EQU   CECOPT55                                                 15760000
         END    ,(C'PL/S',1400,78045)                                   15770000
