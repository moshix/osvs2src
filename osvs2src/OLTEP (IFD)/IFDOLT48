         TITLE ' RESIDENT DEVICE AND TEST SCHEDULER.  IFDOLT48'         00010000
         TITLE ' RESIDENT DEVICE AND TEST SCHEDULER.  IFDOLT48'         00020000
         LCLA  &T,&SPN                                            0002  00030000
.@001    ANOP                                                     0002  00040000
IFDOLT48 CSECT ,                                                  0002  00050000
         BC    15,24(0,@F)                                              00060000
         DC    C'IFDOLT48 01 JUN 76'                             0002  00070000
         STM   @E,@C,12(@D)                                       0002  00080000
         BALR  @B,0                                               0002  00090000
@PSTART  DS    0H                                                 0002  00100000
         USING @PSTART+00000,@B                                   0002  00110000
         ST    @D,@SAV001+4                                       0002  00120000
         LA    @F,@SAV001                                         0002  00130000
         ST    @F,8(0,@D)                                         0002  00140000
         LR    @D,@F                                              0002  00150000
*  GEN(USING CHASCT,2);                  /* COMMON AREA BASE REGISTER * 00160000
         USING CHASCT,2                                                 00170000
         DS    0H                                                       00180000
* GENERATE DATA;                                                        00190000
*  RESTRICT(2,3,4,5,6,7,8,9);             /* RESTRICT REG USAGE S21937* 00200000
*  DCL R0 REG(0) PTR;                                                   00210000
*  DCL R1 REG(1) PTR;                                                   00220000
*  DCL R2 REG(2) PTR;                                                   00230000
*  DCL R3 REG(3) PTR;                                                   00240000
*  DCL R4 REG(4) PTR;                                                   00250000
*  DCL R5 REG(5) PTR;                                                   00260000
*  DCL R6 REG(6) PTR;                                                   00270000
*  DCL R7 REG(7) PTR;                                                   00280000
*  DCL R8 REG(8) PTR;                                                   00290000
*  DCL R9 REG(9) PTR;                                                   00300000
*  DCL R10 REG(10) PTR;                                                 00310000
*  DCL R11 REG(11) PTR;                                                 00320000
*  DCL R12 REG(12) PTR;                                                 00330000
*  DCL R13 REG(13) PTR;                                                 00340000
*  DCL R14 REG(14) PTR;                                                 00350000
*  DCL R15 REG(15) PTR;                                                 00360000
*  DCL SECDVPTR PTR GENERATED;           /* LAST GRAB DEVICE */         00370000
*  DCL REPBUF EXT ENTRY;                 /* REPLY BUFFER */             00380000
*  DCL CESWT4 GENERATED;                 /* OLTEP SWITCHES */           00390000
*  DCL CE46 CHAR(3) BASED(ADDR(CESWT4)); /* OLTEP SWITCHES */           00400000
*  DCL MSGMOD PTR GENERATED;             /* MESSAGE MODULE */           00410000
*  DCL DATPTR PTR GENERATED;             /* DATA PROTECT ROOT MODULE */ 00420000
*  DCL CHASCT CHAR(88) GENERATED;        /* SECTION CONTROL TABLE */    00430000
*  DCL PRIDVPTR PTR GENERATED;           /* PRIME DEVICE TABLE */       00440000
*  DCL DEVDEPAD PTR GENERATED;           /* DEVICE ADDRESS */           00450000
*  DCL REGX PTR GENERATED;               /* POINTER TO UCB ADDRESS */   00460000
*  DCL UTCOM CHAR(64) GENERATED;         /* PASSON AREA */              00470000
*  DCL INBUFR CHAR(72) GENERATED;        /* INPUT OR OUTPUT BUFFER */   00480000
*  DCL PSCT GENERATED;                   /* SECTION CONTROL TABLE */    00490000
*  DCL SCHEDSA PTR GENERATED;            /* SAVE AREA ADDRESS */        00500000
*  DCL DEVTBPTR PTR GENERATED;           /* DEVICE TABLE ADDRESS      * 00510000
*  DCL TABLNGTH FIXED(15) GENERATED;     /* DEVICE TABLE LENGTH       * 00520000
*  DCL SECLST CHAR(10) GENERATED;        /* SECTION LIST */             00530000
*  DCL ECB37 FIXED GENERATED;            /* CECOM ECB */                00540000
*  DCL TAB28 PTR GENERATED;              /* NEW MACRO ENTRY POINT */    00550000
*  DCL OLTTAB PTR GENERATED;             /* LINK TABLE */               00560000
*  DCL LOGADR PTR GENERATED;             /* LOGSCAN MODULE ADDRESS */   00570000
*  DCL SECTUSE CHAR(1) GENERATED;        /* NUMBER OF SECTIONS RUN */   00580000
*  DCL UNICTR CHAR(1) GENERATED;         /* NUMBER OF DEVICES TO RUN */ 00590000
*  DCL UNITUSE CHAR(1) GENERATED;        /* NUMBER OF DEVICES RUN */    00600000
*  DCL PLKMOR PTR GENERATED;             /* FIRST PLINKED MODULE */     00610000
*  DCL DATIND GENERATED;                 /* PARAMETER LIST FOR OLTEP */ 00620000
*  DCL SECPTR PTR GENERATED;             /* ACTIVE SECTION ENTRY */     00630000
*  DCL UTENT PTR GENERATED;              /* FIRST UTS INSTRUCTION */    00640000
*  DCL CESWT CHAR(5) GENERATED;                                         00650000
*  DCL PRTBUFR CHAR(120) GENERATED;      /* PRINT BUFFER */             00660000
*  DCL TLCOUNT FIXED(15) GENERATED;      /* TEST LOOP COUNT */          00670000
*  DCL WKSVC GENERATED;                  /* SVC WORK AREA */            00680000
*  DCL MCT GENERATED;                    /* MODULE CONTROL TABLE */     00690000
*  DCL ROPT GENERATED;                   /* SVC AREA */                 00700000
*  DCL EXPAND1 GENERATED;                                               00710000
*  DCL PARTITEM CHAR(12) GENERATED;      /* PARTITION ITEMS     X02008* 00720000
*  DCL 1 * BDY(WORD) BASED(ADDR(PARTITEM)), /* PARTITION ITEMS  X02008* 00730000
*         2 PARADR PTR,                  /* OLTS AREA ADDRESS   X02008* 00740000
*         2 PARSZ FIXED,                 /* OLTS TOTAL WORK AREAX02008* 00750000
*         2 RTPLKSZ FIXED,               /* ROOT AND PLINK SIZE X02008* 00760000
*           3 DBLZ CHAR(2),              /* DOUBLE ZERO         X02008* 00770000
*           3 UTSIZ CHAR(2),             /* UTS SIZE            X02008* 00780000
*             5 * CHAR(1),               /* NA                  X02008* 00790000
*             5 * BIT(8),                /* NA                  X02008* 00800000
*              6 * BIT(5),               /* NA                  X02008* 00810000
*              6 TRPBITS BIT(3),         /* LAST THREE BITS     X02008* 00820000
*               7 * BIT(2),              /* NA                  X02008* 00830000
*               7 CLRBIT BIT(1),         /* OLD UTS INDICATOR   X02008* 00840000
*                 9 * BIT(1);            /* NA                  X02008* 00850000
*  DCL HRTSEL CHAR(2) GENERATED;         /* HIGHEST ROUTINE BYTES */    00860000
*  DCL 1 * BASED(ADDR(HRTSEL)),          /* HIGHEST ROUTINE BYTES */    00870000
*         2 TERTN CHAR(1),               /* LAST ROUTINE IN UTS */      00880000
*         2 HIRTN CHAR(1);               /* HIGHEST ROUTINE SELECTED */ 00890000
*  DCL VID CHAR(2) BASED(ADDR(WKSVC)+2); /* MODULE ID FOR SVC USE */    00900000
*  DCL MID1 CHAR(2) BASED(ADDR(MCT)+10); /* OLTEP MODULE ID */          00910000
*  DCL HCODE CHAR(1) BASED(132);         /* HCODE EQUATED */            00920000
*  DCL 1 * BDY(WORD) BASED(R5+16),       /* WORK AREA */                00930000
*         2 WKBY FIXED,                  /* WORK WORD */                00940000
*           3 * CHAR(2),                 /* BYTE ALIGNMENT */           00950000
*           3 WKBY34 CHAR(2);            /* WORK BYTES */               00960000
*  DCL 1 * BASED(MSGMOD),                /* MESSAGE MODULE */           00970000
*         2 IFD100 PTR,                  /* IFD100 MESSAGE PTR  S21937* 00980000
*         2 *(5) PTR,                    /* NA                  S21937* 00990000
*         2 IFD117 PTR,                  /* POINTER TO IFD117 MESSAGE * 01000000
*         2 IFD121 PTR,                  /* POINTER TO IFD121 MESSAGE * 01010000
*         2 * PTR,                       /* NA */                       01020000
*         2 IFD135 PTR,                  /* POINTER TO IFD135 MESSAGE * 01030000
*         2 IFD501 PTR,                  /* IFD501 MESSAGE PTR  S21937* 01040000
*         2 * PTR,                       /* NA */                       01050000
*         2 IFD158 PTR,                  /* POINTER TO IFD158 MESSAGE * 01060000
*         2 IFD201 PTR,                  /* PTR TO MESSAGE      X02008* 01070000
*         2 *(6) PTR,                    /* NA                  X02008* 01080000
*         2 IFD231 PTR,                  /* PTR TO MESSAGE      X02008* 01090000
*         2 IFD313 PTR,                  /* PTR TO MESSAGE      X02008* 01100000
*         2 IFD502 PTR,                  /* PTR TO MESSAGE      X02008* 01110000
*         2 IFD503 PTR,                  /* PTR TO MESSAGE      X02008* 01120000
*         2 IFD200 PTR,                  /* PTR TO MESSAGE      X02008* 01130000
*         2 *(10) PTR,                   /* NA                  Y02008* 01140000
*         2 IFD248 PTR,                  /* PTR TO MSG IFD248I  Y02008* 01150000
*           3 * PTR;                     /* LAST POINTER */             01160000
*  DCL IFD227 PTR BASED(MSGMOD+68);      /* IFD227 MSG PTR      X02008* 01170000
*  DCL 1 * BASED(IFD227),                /* IFD227 MESSAGE      X02008* 01180000
*         2 * CHAR(37),                  /* NA                  X02008* 01190000
*         2 UT227 CHAR(8);               /* UNIT TEST NAME      X02008* 01200000
*  DCL SECLEV CHAR(1) BASED(R3+11);      /* SCT LEVEL OF OLTS   X02008* 01210000
*  DCL 1 * BASED(IFD100),                /* IFD100 MESSAGE      S21937* 01220000
*         2 * CHAR(4),                   /* NA                  S21937* 01230000
*         2 MSG100A CHAR(78),            /* MESSAGE TEXT        S21937* 01240000
*           3 * CHAR(8),                 /* NA                  S21937* 01250000
*           3 MSG100 CHAR(70);           /* MESSAGE LESS ID     S21937* 01260000
*  DCL 1 SVR8 FIXED,                     /* SAVE AREA           X02008* 01270000
*         2 * CHAR(2),                   /* NA                  X02008* 01280000
*         2 SVR834 CHAR(2),              /* LAST HALF WORD      X02008* 01290000
*           3 * CHAR(1),                 /* NA                  X02008* 01300000
*           3 SVR84 CHAR(1);             /* LOW ORDER BYTE      X02008* 01310000
*  DCL RETCODE FIXED INIT(0);            /* RETURN CODE */              01320000
*  DCL TLRUN FIXED(15) BASED(ADDR(TLCOUNT)+6); /* TEST LOOP RUN S21937* 01330000
*  DCL INBF1 CHAR(1) BASED(ADDR(INBUFR)); /* FIRST BUFFER CHARACTER */  01340000
*  DCL 1 * BASED(ADDR(OLTTAB)),          /* LINK TABLE */               01350000
*         2 *(8) PTR,                    /* ENTRY POINTS FOR MACROS */  01360000
*         2 TMCOMAD PTR,                 /* TRANSIENT MANAGER AREA */   01370000
*         2 SECPRF PTR,                  /* SECTION PREFACE ADDRESS */  01380000
*           3 * PTR;                     /* LAST POINTER */             01390000
*  DCL 1 WK1TO8 CHAR(8) BASED(R5+4),     /* WORK AREA */                01400000
*         2 WK1TO4 CHAR(4),              /* FIRST WORD IN AREA */       01410000
*         2 WK5TO8 CHAR(4);              /* SECOND WORD IN AREA */      01420000
*  DCL 1 * BDY(WORD) BASED(R4),          /* MODULE ADDRESS */           01430000
*         2 INZNM CHAR(8),               /* MODULE NAME */              01440000
*         2 INZLV CHAR(2),               /* MACRO LEVEL */              01450000
*         2 INZRT FIXED(15),             /* DISPLACEMENT TO ROUTINE */  01460000
*         2 INZIN PTR,                   /* FIRST INSTRUCTION ADDRESS * 01470000
*           3 * CHAR(1);                 /* ITEM IN STRUCTURE */        01480000
*  DCL 1 WANTDONT CHAR(8) BASED(R3+1),   /* MASK FOR DESCRIPTS */       01490000
*         2 WANT CHAR(4),                /* BITS THAT MUST BE SET */    01500000
*         2 DONTWANT CHAR(4),            /* BITS THAT MUST NOT BE SET * 01510000
*             9 * CHAR(1);               /* NA                  X02008* 01520000
*  DCL 1 * BDY(WORD) BASED(R3+20),       /* NA                  X02008* 01530000
*         2 RTSIZ FIXED,                 /* ROOT AND PLINK SIZE X02008* 01540000
*         2 MOSIZ FIXED,                 /* MORECORE SIZE       X02008* 01550000
*           3 * CHAR(1);                 /* ITEM IN STRUCTURE */        01560000
*  DCL 1 * BDY(WORD) BASED(R4),          /* MODULE ADDRESS */           01570000
*         2 *(19) PTR,                   /* BRANCH AND SAVE AREA */     01580000
*         2 SECID CHAR(8),               /* OLD UTS NAME */             01590000
*         2 RTMSK CHAR(2);               /* ROUTINE */                  01600000
*  DCL 1 * BASED(R4),                    /* MESSAGE ADDRESS */          01610000
*         2 * CHAR(13),                  /* WTO MESSAGE */              01620000
*         2 WTO12 CHAR(2),               /* CHARACTERS TO MODIFY */     01630000
*           3 WTO1 CHAR(1),              /* CHARACTER TO MODIFY */      01640000
*         2 * CHAR(1),                   /* BLANK CHARACTER */          01650000
*         2 MSGTEST CHAR(8),             /* TEST SECTION */             01660000
*           3 * CHAR(7),                 /* NA                        * 01670000
*           3 OLDTEST CHAR(1),           /* OLD UTS                   * 01680000
*         2 BLKUNIT CHAR(26),            /* UNIT MESSAGE        Y02008* 01690000
*           3 * CHAR(1),                 /* BLANK CHARACTER */          01700000
*           3 MSGUNIT CHAR(22),          /* UNIT DEVICE AND SYM       * 01710000
*             4 KUNIT CHAR(4),           /* UNIT LABEL */               01720000
*             4 * CHAR(1),               /* BLANK CHARACTER */          01730000
*             4 MSGDEV CHAR(8),                                         01740000
*             4 * CHAR(1),               /* NA                        * 01750000
*             4 MSGSYB CHAR(8),          /* SYMBOLIC NAME             * 01760000
*           3 * CHAR(3),                 /* BLANK WITH V=       Y02008* 01770000
*           3 MSGVR CHAR(1),             /* V OR R - HOW OLT IS Y02008* 01780000
*                                        /* BEING RUN           Y02008* 01790000
*           3 MPCPUID CHAR(9),           /* BLANK FOLLOWED BY   Y02008* 01800000
*                                        /* CPUID=              Y02008* 01810000
*             5 * CHAR(7),               /* BLANK FOLLOWED BY   Y02008* 01820000
*                                        /* CPUID=              Y02008* 01830000
*             5 MSGCPUID CHAR(2),        /* CPU ID, EITHER 00   Y02008* 01840000
*                                        /* OR 01               Y02008* 01850000
*         2 * CHAR(1);                   /* LAST CHARACTER */           01860000
*  DCL 1 * BASED(ADDR(PLKMOR)),          /* PLINK AND MORECORE AREA */  01870000
*         2 ZIP16 CHAR(16),              /* PLINK MORECORE POINTER */   01880000
*           3 * CHAR(8),                 /* NA                  X02008* 01890000
*           3 ZIP8 CHAR(8);              /* PLINK POINTERS */           01900000
*  DCL 1 TMWK BASED(TMCOMAD),            /* TRANSIENT MGR WORK AREA */  01910000
*         2 * CHAR(36),                  /* NA */                       01920000
*         2 KNT CHAR(8),                 /* OLTEP MODULE NAME */        01930000
*           3 KNAME CHAR(6),             /* COMMON PART MODULE NAME */  01940000
*         2 MODNN CHAR(8),               /* NON OLTEP MODULE NAME */    01950000
*           3 MODNN6 CHAR(6),            /* FIRST SIX LETTERS OF NAME * 01960000
*         2 * CHAR(4),                   /* NA */                       01970000
*         2 GTCOR PTR;                   /* OBTAINED CORE ADDRESS */    01980000
*  DCL 1 * BASED(R8),                    /* DEVICES TO TEST */          01990000
*         2 * CHAR(56),                  /* ACTIVE DEVICE TABLE       * 02000000
*           3 DVEBC CHAR(8),                                            02010000
*           3 DVUCB PTR,                 /* UCB ADDRESS               * 02020000
*           3 * BIT(8),                  /* FLAGS */                    02030000
*             4 * BIT(1),                /* ALIGNMENT BIT */            02040000
*             4 PRIMBIT BIT(1),          /* PRIMARY DEVICE BIT */       02050000
*             4 * BIT(1),                /* NA                 SA51754* 02060000
*             4 EXIOACT BIT(1),          /* EXIO ACTIVE        SA51754* 02070000
*             4 * BIT(1),                /* NA                 SA51754* 02080000
*             4 GRABIT BIT(1),           /* GRAB BIT */                 02090000
*             4 * BIT(1),                /* NA                @Y30LPAW* 02100000
*             4 SYMBSSID BIT(1),         /* SSID IN SYMB FLD  @Y30LPAW* 02110000
*           3 * CHAR(19),                /* FLAGS AND DATA            * 02120000
*             4 * BIT(8),                /* NA                 SA51755* 02130000
*             5 * BIT(1),                /* NA                  X02008* 02140000
*             5 LETGOB BIT(1),           /* LETGO BIT           X02008* 02150000
*               5 CEVOL BIT(1),          /* CE PACK            SA51755* 02160000
*             3 DVTABCDS CHAR(20),                                      02170000
*               5 DVADR CHAR(4),                                        02180000
*               5 DVCDS CHAR(4),                                        02190000
*             5 * CHAR(1),                                              02200000
*             5 CDSFLAG CHAR(1),                                        02210000
*               7 * BIT(4),              /* NA                 SA51754* 02220000
*               7 SYMBIT BIT(1),         /* SYMBOLIC NAME      SA51754* 02230000
*             5 * BIT(8),                /* NA                  X02008* 02240000
*               7 * BIT(1),              /* NA                  X02008* 02250000
*               7 SKIPRIM BIT(1),        /* SKIP PRIMARY DEVICE X02008* 02260000
*             5 * CHAR(1),               /* NA                  X02008* 02270000
*               5 SYMNAME CHAR(8);                                      02280000
*  DCL 1 * BASED(DVUCB),                 /* UCB MAP                   * 02290000
*         2 *(4) FIXED,                  /* NA                        * 02300000
*         2 DVUDD CHAR(4);               /* DEVICE DESCRIPTORS        * 02310000
*  DCL DCNT1 CHAR(1) BASED(ADDR(UNITUSE)); /* DEVICES RUN */            02320000
*  DCL DCNT2 CHAR(1) BASED(ADDR(UNICTR)); /* DEVICES TO RUN */          02330000
*  DCL SCNT1 CHAR(1) BASED(ADDR(SECTUSE)); /* SECTIONS RUN */           02340000
*  DCL 1 PARM12 CHAR(12) BDY(WORD),      /* LIST FOR LOADER     X02008* 02350000
*         2 BNAME CHAR(8),               /* SECTION NAME        X02008* 02360000
*           3 BNAMCM CHAR(5),            /* SECTION TYPE        X02008* 02370000
*           3 BNAMVR CHAR(3),            /* SECTION VARIABLE    X02008* 02380000
*         2 TARGADR FIXED,               /* TARGET ADDRESS      X02008* 02390000
*         2 * FIXED INIT(0),             /* NA                  X02008* 02400000
*           3 FUNC12 CHAR(1),            /* LOADER FUNCTION     X02008* 02410000
*             5 * BIT(1),                /* NA                  X02008* 02420000
*             5 COMPUTB BIT(1),          /* COMPUTE SIZE        X02008* 02430000
*             5 * BIT(1),                /* NA                  X02008* 02440000
*             5 UTSENVL BIT(1),          /* UTS ENVOLVED        X02008* 02450000
*        9 * CHAR(1);                    /* NA                  X02008* 02460000
*  DCL 1 LDLIST BDY(WORD),                                              02470000
*         2 * FIXED(15) INIT(2),                                        02480000
*         2 * CHAR(2) INIT('12'),                                       02490000
*         2 * PTR INIT(ADDR(PARM12));    /* LOADER LIST         X02008* 02500000
*  DCL 1 UTSPL BASED(ADDR(PARM12)),      /* LIST FOR LOADER     X02008* 02510000
*         2 PLNAM CHAR(8),               /* SECTION NAME */             02520000
*           3 * CHAR(1),                 /* FIRST CHARACTER IN NAME */  02530000
*           4 PLNM15 CHAR(5),            /* FIRST PART OF NAME */       02540000
*           4 PLNM68 CHAR(3),            /* REST OF NAME */             02550000
*           3 PLSNM CHAR(6),             /* VARIABLE IN NAME */         02560000
*             4 PLTYPE CHAR(4),          /* DEVICE TYPE */              02570000
*             4 PLNAM6 CHAR(2),          /* SPECIAL TEST */             02580000
*           3 * CHAR(1);                 /* LAST CHARACTER */           02590000
*  DCL 1 * BASED(ADDR(SECLST)),          /* SECTION LIST */             02600000
*         2 * CHAR(1),                   /* FIRST CHARACTER IN LIST */  02610000
*         2 SCNT2 CHAR(1),               /* COUNT OF SECTIONS TO RUN */ 02620000
*         2 SNAM CHAR(5),                /* TYPE OF SECTION */          02630000
*           3 * CHAR(1),                 /* PREFIX LETTER */            02640000
*           3 STYPEN CHAR(4),            /* SECTION TYPE NUMBER */      02650000
*         2 SNAMST CHAR(5);              /* FIRST SECTION ENTRY */      02660000
*  DCL 1 * BASED(R9),                    /* SECTION TO RUN */           02670000
*         2 SNAM1 CHAR(3),               /* ACTIVE SECTION */           02680000
*         2 SLNG1 CHAR(2),               /* ACTIVE SECTION LENGTH */    02690000
*           3 * CHAR(1),                 /* BYTE ALIGNMENT */           02700000
*           3 * BIT(8),                  /* BYTE OF BITS */             02710000
*             4 * BIT(5),                /* NA                  X02008* 02720000
*             4 DBLBIT BIT(2),           /* BITS 5 AND 6        X02008* 02730000
*             4 OLDUT BIT(1),            /* OLD UTS */                  02740000
*         2 SNAM2 CHAR(3);               /* NEXT SECTION */             02750000
*  DCL 1 * BASED(ADDR(CHASCT)),          /* SECTION CONTROL TABLE */    02760000
*         2 * CHAR(8),                   /* TWO WORDS OF DATA */        02770000
*           3 ERRLPCT CHAR(2),           /* EL COUNT           SA51757* 02780000
*           3 * BIT(8),                  /* BYTE OF BITS */             02790000
*             4 * BIT(5),                /* NA */                       02800000
*             4 NPR BIT(1),              /* NO PRINT INDICATOR */       02810000
*             4 INDEFLP BIT(1),          /* INDEFINITE LOOP     X02008* 02820000
*             4 FECOM BIT(1),            /* 1ST ERROR COMMUNICATION */  02830000
*           3 * BIT(8),                  /* BYTE OF BITS */             02840000
*             4 SCTASTER BIT(2),         /* ERROR INDICATORS */         02850000
*               5 SCTERB BIT(1),         /* UNIT TEST IN ERROR */       02860000
*               5 ASTERB BIT(1),         /* ASTERISK INDICATES ERROR */ 02870000
*             4 CATB1 BIT(1),            /* CATASTROPHIC BIT */         02880000
*             4 AP BIT(1),               /* ALTERNATE PRINT */          02890000
*             4 NCP BIT(1),              /* NO CONTROL PRINT */         02900000
*             4 NEP BIT(1),              /* NO ERROR PRINT */           02910000
*             4 ERLOP BIT(1),            /* ERROR LOOP */               02920000
*             4 TSLOP BIT(1),            /* TEST LOOP */                02930000
*           3 * CHAR(3),                 /* NA                  X02008* 02940000
*           3 SCTLEV CHAR(1),            /* SCT LEVEL           X02008* 02950000
*         2 DVSEC1 CHAR(2),              /* PRIME DEVICE SECTION */     02960000
*         2 PDFLG CHAR(2),               /* PRIME DEVICE FLAGS */       02970000
*           3 * BIT(8),                  /* NA                 SA51755* 02980000
*           3 * BIT(8),                  /* NA                 SA51755* 02990000
*             4 * BIT(2),                /* NA                 SA51755* 03000000
*             4 CEVOLUM BIT(1),          /* CE VOLUME          SA51755* 03010000
*         2 PDPAD1 CHAR(8),                                             03020000
*           3 PDPA1 CHAR(4),                                            03030000
*           3 PDDD1 CHAR(4),             /* PRIME DEVICE DESCRIPTS */   03040000
*             4 * CHAR(2),               /* BYTE ALIGNMENT */           03050000
*             4 DCLAS CHAR(1),           /* DEVICE CLASS */             03060000
*         2 DVSEC2 CHAR(2),              /* SECONDARY DEVICE SECTION */ 03070000
*         2 * CHAR(2),                                                  03080000
*         2 PDPAD2 CHAR(8),                                             03090000
*           3 PDPA2 CHAR(4),                                            03100000
*           3 PDDD2 CHAR(4),             /* SEC DEVICE DESCRIPTS */     03110000
*         2 * CHAR(1),                   /* BYTE ALIGNMENT */           03120000
*         2 * BIT(8),                    /* BYTE OF BITS */             03130000
*           3 * BIT(3),                  /* NA                 SA51757* 03140000
*           3 ERRCNT BIT(1),             /* EL COUNT IN OPTION SA51757* 03150000
*           3 ONEPRIM BIT(1),            /* ONE PRIME DEVICE ONLY */    03160000
*           3 CLEANUP BIT(1),            /* UTS CLEANING UP           * 03170000
*         2 * CHAR(2),                   /* NA                        * 03180000
*         2 * BIT(8),                    /* NA                        * 03190000
*           3 * BIT(1),                  /* NA                        * 03200000
*           3 CLEANRT BIT(1),            /* UTS HAS CLEANUP           * 03210000
*           3 * BIT(4),                  /* NA                   M1463* 03220000
*           3 LASTSEC BIT(1),            /* LAST SECTION RUNNING M1463* 03230000
*          3 DYCOM BIT(1),               /* OLT CAN HANDLE DYN  X02008* 03240000
*        2 * BIT(8),                     /* FLAGS               X02008* 03250000
*          3 TALKFLAG BIT(1),            /* CE WANTS TALK       X02008* 03260000
*             9 * CHAR(1);                                              03270000
*  DCL CDS8TO19 CHAR(12) BASED(ADDR(CHASCT)+20); /* CDS ITEMS         * 03280000
*  DCL 1 * BASED(ADDR(CHASCT)+4),        /* SCT WORD 1 */               03290000
*         2 SCTWD17 CHAR(28),            /* SCT WORDS 1 THRU 7 */       03300000
*           3 RTNM1ST CHAR(2),           /* 1ST ROUTINES MASK */        03310000
*         2 * CHAR(1),                   /* NA */                       03320000
*         2 * BIT(8),                    /* FLAGS */                    03330000
*           3 * BIT(2),                  /* NA */                       03340000
*           3 CSELRTN BIT(1),            /* CONSOLE SELECTED ROUTINES * 03350000
*         2 * CHAR(6),                   /* NA */                       03360000
*         2 RTNMLST CHAR(30);            /* EXTENDED ROUTINES MASK */   03370000
*  DCL 1 * BASED(ADDR(CESWT)),           /* OLTEP SWITCHES GROUP */     03380000
*         2 * BIT(8),                    /* OLTEP SWITCHES */           03390000
*           3 * BIT(2),                  /* NA */                       03400000
*           3 OORN BIT(2),               /* OLD OR NEW UTS */           03410000
*             4 OUTS BIT(1),             /* OLD UNIT TEST SECTIONS */   03420000
*             4 NUTS BIT(1),             /* NEW UNIT TEST SECTIONS */   03430000
*         2 * BIT(8),                    /* OLTEP SWITCHES */           03440000
*           3 * BIT(1),                                                 03450000
*           3 SEEK2321 BIT(1),           /* 2321 SPECIAL SECTION */     03460000
*           3 T2321T BIT(1),             /* 2321T TEST */               03470000
*           3 * BIT(2),                  /* NA */                       03480000
*           3 T2321 BIT(1),              /* 2321 SECTION */             03490000
*           3 * BIT(1),                  /* NA */                       03500000
*           3 TPFLAG BIT(1),             /* TP TESTS */                 03510000
*         2 * BIT(8),                    /* OLTEP SWITCHES */           03520000
*           3 NDCFO BIT(1),              /* PREVENTS DYN COM */         03530000
*           3 DPONDEV BIT(1),            /* DATA PROTECT DONE */        03540000
*           3 * BIT(3),                  /* NA */                       03550000
*           3 NDR BIT(1),                /* NO DEVICE REQUIRED */       03560000
*           3 TAPEHDR BIT(1),            /* TAPE HEADER BIT */          03570000
*         2 * BIT(8),                    /* OLTEP SWITCHES */           03580000
*           3 OSTWTOR BIT(1),            /* OUTSTANDING WTOR */         03590000
*           3 BYPDEV BIT(2),             /* BYPASS ONE OR ALL DEVICES * 03600000
*             4 NURUN BIT(1),            /* BYPASS ALL DEVICE TESTS */  03610000
*             4 NUDEV BIT(1),            /* BYPASS THIS DEVICE */       03620000
*           3 * BIT(2),                                                 03630000
*           3 TP1419 BIT(1),             /* ACTIVE TP OR 1419 */        03640000
*         2 CE45 CHAR(2),                /* OLTEP SWITCHES      S21937* 03650000
*           3 CE4 BIT(8),                /* SWITCH 4            S21937* 03660000
*           3 CE5 BIT(8),                /* SWITCH 5            S21937* 03670000
*             4 * BIT(2),                /* NA                  S21937* 03680000
*             4 FEITEMS BIT(4),          /* FIRST ERROR ITEMS   S21937* 03690000
*               6 FFEFCE BIT(2),         /* 1ST ERROR BITS       M5851* 03700000
*         2 CE6 BIT(8),                  /* OLTEP SWITCHES      S21937* 03710000
*           3 UTSCAL BIT(1),             /* UTS CALLED INDICATION */    03720000
*           3 * BIT(1),                  /* ALIGNMENT BIT */            03730000
*           3 EOJLOG BIT(1),             /* EOJ LOGSCAN */              03740000
*           3 PFPMSG BIT(1),             /* PRINT FILE PROTECT */       03750000
*           3 CODE5 BIT(1),              /* CONDITION CODE 5 */         03760000
*           3 NORUN BIT(1),              /* DO NOT RUN SECTION */       03770000
*           3 SECRUN BIT(1),             /* SECTION RUN */              03780000
*           3 RTSTAE BIT(1),             /* STAE ROUTINE */             03790000
*         2 * BIT(8),                    /* OLTEP SWITCHES            * 03800000
*           3 * BIT(2),                                                 03810000
*           3 REMOTE BIT(1),                                            03820000
*           3 * BIT(3),                  /* NA                  Y02008* 03830000
*           3 VIRTUAL BIT(1),            /* OLTEP IN V=V OR V=R Y02008* 03840000
*         2 CE8 BIT(8),                  /* OLTEP SWITCHES     SA51756* 03850000
*         3 * BIT(3),                    /*   NA               SA54318* 03860000
*         3 READDCHK BIT(1),             /* READD FLAG         SA54318* 03870000
*         3 OLTINVV BIT(1),              /* OLT IS IN VIRTUAL   Y02008* 03880000
*           3 SUTMSG BIT(1),             /* START MSG ISSUED   SA51756* 03890000
*           3 SNEWRUN BIT(1),            /* START NEW RUN      SA51756* 03900000
*             4 * BIT(1);                /* LAST OLTEP SWITCH */        03910000
*         DCL CESWTR CHAR(1) GENERATED;  /* RETAIN 370 SWITCHES S20203* 03920000
*         DCL 1 * CHAR(1) BASED(ADDR(CESWTR)),  /*              S20203* 03930000
*               3 RETAINAC BIT(1),       /* REI ACTIVE          S20203* 03940000
*               3 REMERR BIT(1),         /* ERROR OCCURRED      S20203* 03950000
*               3 REMNOMSG BIT(1),       /* REMOTE NO MSG       S20203* 03960000
*               3 CENOMSG BIT(1),        /* ONSITE NO MSG       S20203* 03970000
*               3 PRTNOMSG BIT(1),       /* SYSOUT NO MSG       S20203* 03980000
*               3 IMRESP BIT(1),         /* IMMEDIATE RESP MSG  S20203* 03990000
*               3 EXECOUT BIT(1),        /* MSG IFD104E ISSUED  S20203* 04000000
*               3 CECOMOUT BIT(1);       /* MSG IFD154E ISSUED  S20203* 04010000
*  DCL CESWTR1 CHAR(1) GENERATED;        /* REI SWITCHES        S20203* 04020000
*  DCL 1 * CHAR(1) BASED(ADDR(CESWTR1)),  /*                    S20203* 04030000
*         3 * BIT(2),                    /*                     S20203* 04040000
*         3 CECOMANS BIT(1),             /*                     S20203* 04050000
*         3 * BIT(2),                    /*                     S20203* 04060000
*         3 REMANS BIT(1),               /*                     S20203* 04070000
*         3 * BIT(2);                    /*                     S20203* 04080000
*         DCL BNAMCMSV CHAR(5);          /*                     S20203* 04090000
*  DCL 1 * CHAR(4),                      /* MESSAGE MODIFIERS */        04100000
*         2 MSGSTR CHAR(2) INIT(' S'),   /* START MESSAGE */            04110000
*         2 MSGEND CHAR(2) INIT(' T');   /* TERMINATE MESSAGE */        04120000
*  DCL UTS201 CHAR(8) BASED(R1+43);      /* UTS NAME            X02008* 04130000
*  DCL 1 MSG231 BASED(R1),               /* IFD231 MESSAGE      X02008* 04140000
*         2 * CHAR(12),                  /* NA                  X02008* 04150000
*         2 WMSGTEST CHAR(8),            /* UNIT TEST NAME */           04160000
*         2 * CHAR(15),                  /* NA                  X02008* 04170000
*         2 WMSGDEV CHAR(8);                                            04180000
*  DCL RTMASK CHAR(1) BASED(R2+70);      /* RETURN CODE MASK    X02008* 04190000
*  DCL MSGUTS CHAR(8) BASED(R1+12);      /* SECTION NAME         M1463* 04200000
*  DCL 1 * BASED(R4),                    /* WTO MESSAGE */              04210000
*         2 * CHAR(20),                  /* ALIGNMENT BYTES */          04220000
*         2 WTO4NM CHAR(8);              /* SECTION NAME */             04230000
*  DCL 1 MSG200 BASED(R1),               /* IFD200 MESSAGE      X02008* 04240000
*         2 * CHAR(17),                  /* NA                  X02008* 04250000
*         2 NM200 CHAR(8);               /* SECTION NAME        X02008* 04260000
*  DCL IODEVTAB CHAR(36) GENERATED;      /* IO DEVICE TABLE     Y02008* 04270000
*  DCL 1 DEVTBENT CHAR(12) BASED(R5),    /* IO DEV TAB FORMAT   Y02008* 04280000
*        3 DEVPTR PTR(31),               /* DEVTAB PTR          Y02008* 04290000
*        3 IOSBPTR PTR(31),              /* IOSB PTR            Y02008* 04300000
*        3 * CHAR(4);                    /* NA                  Y02008* 04310000
*  DCL 1 IOSB CHAR(116) BDY(WORD) BASED(R1), /* IOSB FORMAT     Y02008* 04320000
*        3 * CHAR(112),                  /* NA                  Y02008* 04330000
*        3 PTRTECB PTR(31);              /* TECB PTR            Y02008* 04340000
*  DCL INDEX FIXED(15);                  /* INDEX FOR LOOP      Y02008* 04350000
*  DCL 1 DIOPARM BDY(WORD),              /* DIO PARM LIST      SA51754* 04360000
*         2 * FIXED(15) INIT(2),         /* NA                  X02008* 04370000
*         2 * CHAR(2) INIT('44'),        /* DIO ID             SA51754* 04380000
*         2 DIOCDSAD PTR,                /* CDS ADDRESS        SA51754* 04390000
*         2 DIOTECB PTR,                 /* TECB ADDRESS       SA51754* 04400000
*         2 * CHAR(1) INIT('01'X),       /* HIO REQUEST        SA51754* 04410000
*           3 * CHAR(1);                 /* NA                 SA51754* 04420000
*  DCL ACTSECT CHAR(8);                 /* ACTIVE SECTION NAME  Y02008* 04430000
*  DCL SPCOUNT CHAR(2) BASED(R3+18);     /* OLTS EL COUNT      SA51757* 04440000
*  DCL CESWT9 CHAR(1) GENERATED;         /* OLTEP FLAG FLD 9    Y02008* 04450000
*  DCL 1 * CHAR(1) BASED(ADDR(CESWT9)),  /* OLTEP FLAG FLD 9    Y02008* 04460000
*        3 * BIT(2),                     /* CDS EQUATE FLAGS    Y02008* 04470000
*        3 VRCAP BIT(1),                 /* VIRTUAL OR REAL OLT Y02008* 04480000
*        3 * BIT(4),                     /* NA                        * 04490000
*        3 OLTTERM BIT(1);               /* OLT FORCED TO TERM  Y02008* 04500000
*  DCL OLTADDR FIXED(31);                /* OLT AREA ADDRESS    Y02008* 04510000
*  DCL CHARAFFN CHAR(2) GENERATED;       /* SELECTED CPU AFFN   Y02008* 04520000
*  DCL CESWT10 CHAR(1) GENERATED;        /* INTERNAL FLAGS      Y02008* 04530000
*  DCL 1 * CHAR(1) BASED(ADDR(CESWT10)), /* INTERNAL FLAGS      Y02008* 04540000
*        3 MPSYS BIT(1);                 /* 1-MP   0-NOT MP     Y02008* 04550000
*  GEN(EJECT);                                                          04560000
         EJECT                                                          04570000
         DS    0H                                                       04580000
*  R5=TMCOMAD;                           /* BLDL LIST */                04590000
         L     @5,A00023+32                                       0123  04600000
* SCH001:                                                               04610000
*  SNEWRUN='0'B;                         /* CLEAR NEW RUN BIT  SA51756* 04620000
SCH001   NI    A00105+8,B'11111101'                               0124  04630000
*  TLRUN=1;                              /* INIT TEST LOOP RUN  Y02008* 04640000
         LA    @F,1                                               0125  04650000
         STH   @F,TLRUN                                           0125  04660000
*  SCHEDSA=R13;                          /* SAVE AREA ADDRESS */        04670000
         ST    @D,SCHEDSA                                         0126  04680000
*  IF RETCODE^=0 THEN                    /* TEST PREVIOUS RETURN CODE * 04690000
         SR    @F,@F                                              0127  04700000
         C     @F,RETCODE                                         0127  04710000
         BC    08,@9FF                                            0127  04720000
*    DO;                                 /* RETURN CODE HANDLED */      04730000
*      CODE5='1'B;                       /* INDICATE RETURN BACK HERE * 04740000
         OI    A00105+6,B'00001000'                               0129  04750000
*      RETCODE=0;                        /* ZERO RETURN CODE */         04760000
         SR    @F,@F                                              0130  04770000
         ST    @F,RETCODE                                         0130  04780000
*      GOTO SCH015;                      /* GO HANDLE PREVIOUS RETURN * 04790000
         BC    15,SCH015                                          0131  04800000
*    END;                                /* END RETURN CODE TESTING */  04810000
* SCH002:                                                               04820000
*  CODE5='0'B;                           /* INITIALIZE RETURN CODE */   04830000
@9FF     EQU   *                                                  0133  04840000
SCH002   NI    A00105+6,B'11110111'                               0133  04850000
*  R9=ADDR(SNAMST);                      /* FIRST SECTION */            04860000
         LA    @9,A00073+7                                        0134  04870000
*  BNAMCM=SNAM;                          /* SECTION TYPE */             04880000
         MVC   PARM12(5),A00073+2                                 0135  04890000
*  TARGADR=PARADR;                       /* TARGET ADDRESS      X02008* 04900000
         MVC   PARM12+8(4),A00000                                 0136  04910000
*  UTSENVL='1'B;                         /* UTS ENVOLVED        X02008* 04920000
         OI    PARM12+12,B'00010000'                              0137  04930000
*  SVR8=0;                               /* ZERO SAVE AREA      X02008* 04940000
         SR    @F,@F                                              0138  04950000
         ST    @F,SVR8                                            0138  04960000
*  DO R8=1 TO SCNT2 BY 1;                /* SECTION COUNT       X02008* 04970000
         LA    @F,1                                               0139  04980000
         LR    @8,@F                                              0139  04990000
@DO9FE   SR    @F,@F                                              0139  05000000
         IC    @F,A00073+1                                        0139  05010000
         CR    @F,@8                                              0139  05020000
         BC    04,@DO9FB                                          0139  05030000
         BC    15,@DO9FC                                          0139  05040000
@DO9FD   LA    @F,1                                               0139  05050000
         AR    @8,@F                                              0139  05060000
         BC    15,@DO9FE                                          0139  05070000
*    BNAMVR=SNAM1;                       /* SECTION NAME */             05080000
@DO9FC   MVC   PARM12+5(3),0(@9)                                  0140  05090000
*    RTPLKSZ=0;                          /* ZERO OUT AREA       X02008* 05100000
         SR    @F,@F                                              0141  05110000
         ST    @F,A00000+8                                        0141  05120000
*    IF SLNG1^=DBLZ THEN                 /* CHECK SIZE          X02008* 05130000
         CLC   3(2,@9),A00000+8                                   0142  05140000
*      GOTO SCH002M;                     /* SIZE GIVEN          X02008* 05150000
         BC    07,SCH002M                                         0143  05160000
*    GEN(BAL   R7,CALLCOMP);             /* CALL COMPUTE        X02008* 05170000
         BAL   R7,CALLCOMP                                              05180000
         DS    0H                                                       05190000
*    IF R15^=0 THEN                      /* CHECK RETURN        X02008* 05200000
         LTR   @F,@F                                              0145  05210000
         BC    08,@9FA                                            0145  05220000
*      DO;                               /* SECTION NOT FOUND */        05230000
*        R4=IFD117;                      /* MESSAGE ADDRESS */          05240000
         L     @C,MSGMOD                                          0147  05250000
         L     @4,24(0,@C)                                        0147  05260000
*        WTO4NM=BNAME;                   /* SECTION NAME */             05270000
         MVC   20(8,@4),PARM12                                    0148  05280000
*        GEN(BAL   R7,SCH026A);          /* WTO MESSAGE */              05290000
         BAL   R7,SCH026A                                               05300000
         DS    0H                                                       05310000
*        GOTO SCH002P;                   /* NEXT SECTION        X02008* 05320000
         BC    15,SCH002P                                         0150  05330000
*      END;                              /* END OF MESSAGE */           05340000
*    SVR8=R0;                            /* STORE LENGTH        X02008* 05350000
@9FA     ST    @0,SVR8                                            0152  05360000
*    SLNG1=SVR834;                       /* SAVE LENGTH         X02008* 05370000
         MVC   3(2,@9),SVR8+2                                     0153  05380000
* SCH002M:                                                              05390000
*    SVR8=R8;                            /* SAVE COUNT          X02008* 05400000
SCH002M  ST    @8,SVR8                                            0154  05410000
* SCH002P:                                                              05420000
*    R9=ADDR(SNAM2);                     /* NEXT SECTION */             05430000
SCH002P  LA    @9,5(0,@9)                                         0155  05440000
         BC    15,@DO9FD                                          0156  05450000
*  END;                                  /* CONTINUE SECTION TEST */    05460000
*  SCNT2=SVR84;                          /* LAST SECTION COUNT  X02008* 05470000
@DO9FB   MVC   A00073+1(1),SVR8+3                                 0157  05480000
*  GEN(EJECT);                                                          05490000
         EJECT                                                          05500000
         DS    0H                                                       05510000
* SCH003:                                                               05520000
*  CE46=CE46&&CE46;                      /* CLEAR SWITCHES      S21937* 05530000
SCH003   XC    CE46(3),CE46                                       0159  05540000
*  OORN='00'B;                           /* OLD OR NEW UTS INDICATOR */ 05550000
         NI    A00105,B'11001111'                                 0160  05560000
*  DCNT1='00'X;                          /* INITIAL DEVICE COUNT */     05570000
         MVI   DCNT1,X'00'                                        0161  05580000
*  R8=DEVTBPTR;                          /* FIRST DEVICE TABLE        * 05590000
         L     @8,DEVTBPTR                                        0162  05600000
*  IF NDR='1'B THEN                      /* CHECK INDICATOR     X02008* 05610000
         TM    A00105+2,B'00000100'                               0163  05620000
*    GOTO SCH006;                        /* NO DEVICE NEEDED    X02008* 05630000
         BC    01,SCH006                                          0164  05640000
*  DO R7=DCNT2 TO 1 BY -1;               /* CHECK DEVICE        X02008* 05650000
         SR    @F,@F                                              0165  05660000
         IC    @F,DCNT2                                           0165  05670000
         LTR   @7,@F                                              0165  05680000
         BC    12,@DO9F8                                          0165  05690000
*    IF SKIPRIM='0'B THEN                /* TEST SKIP PRIME BIT Y02008* 05700000
@DO9F9   TM    42(@8),B'01000000'                                 0166  05710000
*        GOTO SCH003M;                   /* USE DEVICE ENTRY    X02008* 05720000
         BC    08,SCH003M                                         0167  05730000
*    R8=R8+TABLNGTH;                     /* NEXT DEVICE ENTRY   X02008* 05740000
         AH    @8,TABLNGTH                                        0168  05750000
*    DCNT1=DCNT1+1;                      /* NEXT DEVICE         X02008* 05760000
         LA    @F,1                                               0169  05770000
         SR    @0,@0                                              0169  05780000
         IC    @0,DCNT1                                           0169  05790000
         AR    @F,@0                                              0169  05800000
         STC   @F,DCNT1                                           0169  05810000
*  END;                                  /* ALL DEVICES         X02008* 05820000
*  GOTO SCH024A;                         /* END TEST            X02008* 05830000
         BCT   @7,@DO9F9                                          0170  05840000
         BC    15,SCH024A                                         0171  05850000
* SCH003M:                                                              05860000
*  PRIDVPTR=R8;                          /* PRIME DEVICE TABLE */       05870000
SCH003M  ST    @8,PRIDVPTR                                        0172  05880000
*  DEVDEPAD=ADDR(DVSEC1);                /* PRIME DEVICE SCT SECTION */ 05890000
         LA    @F,A00080+8                                        0173  05900000
         ST    @F,DEVDEPAD                                        0173  05910000
*      REGX=ADDR(DVUCB);                 /* ACTIVE UCB ADDRESS */       05920000
         LA    @F,8(0,@8)                                         0174  05930000
         ST    @F,REGX                                            0174  05940000
*  IF TPFLAG='1'B THEN                   /* TEST TP FLAG */             05950000
         TM    A00105+1,B'00000001'                               0175  05960000
         BC    12,@9F5                                            0175  05970000
*    DO;                                 /* TP DEVICE */                05980000
*  GEN(BAL   R7,SCHA05);                 /* UPDATE SCT          S21937* 05990000
         BAL   R7,SCHA05                                                06000000
         DS    0H                                                       06010000
*      GEN(BAL   R7,SCH029);             /* LINK TO DATA PROTECT */     06020000
         BAL   R7,SCH029                                                06030000
         DS    0H                                                       06040000
*      DCNT1=DCNT1+1;                    /* NEXT DEVICE ENTRY   X02008* 06050000
         LA    @F,1                                               0179  06060000
         SR    @0,@0                                              0179  06070000
         IC    @0,DCNT1                                           0179  06080000
         AR    @F,@0                                              0179  06090000
         STC   @F,DCNT1                                           0179  06100000
*      R8=R8+TABLNGTH;                   /* NEXT DEVICE TABLE         * 06110000
         AH    @8,TABLNGTH                                        0180  06120000
*      IF DCNT1=DCNT2 THEN               /* CHECK DEVICE COUNT  X02008* 06130000
         CLC   DCNT1(1),DCNT2                                     0181  06140000
*        GOTO SCH024A;                   /* ALL DEVICES CHECKED X02008* 06150000
         BC    08,SCH024A                                         0182  06160000
*    END;                                /* END OF FIRST TP DEVICE */   06170000
*  GOTO SCH006;                          /* BYPASS NEXT DEVICE BYPASS * 06180000
         BC    15,SCH006                                          0184  06190000
* SCH004:                                                               06200000
*  DCNT1='00'X;                          /* NEW DEVICES TO RUN */       06210000
SCH004   MVI   DCNT1,X'00'                                        0185  06220000
* SCH005:                                                               06230000
*  R8=R8+TABLNGTH;                       /* NEXT DEVICE TABLE         * 06240000
SCH005   AH    @8,TABLNGTH                                        0186  06250000
* SCH006:                                                               06260000
*  CATB1='0'B;                           /* ZERO OUT CATASTRPHIC BIT */ 06270000
SCH006   NI    A00080+3,B'11011111'                               0187  06280000
*  CE6=CE6&'02'X;                        /* CLEAR SWITCHES      S21937* 06290000
         NI    A00105+6,X'02'                                     0188  06300000
*  CE45=CE45&&CE45;                      /* CLEAR SWITCHES      S21937* 06310000
         XC    A00105+4(2),A00105+4                               0189  06320000
*  BYPDEV='00'B;                         /* ZERO OUT BYPASS SWITCHES */ 06330000
         NI    A00105+3,B'10011111'                               0190  06340000
*  SCNT1='01'X;                          /* FIRST SECTION FOR DEVICE */ 06350000
         MVI   SCNT1,X'01'                                        0191  06360000
*  LASTSEC='0'B;                         /* LAST SECTION NOT RUN M1463* 06370000
         NI    A00080+36,B'11111101'                              0192  06380000
*  R9=ADDR(SNAMST);                      /* FIRST SECTION TO RUN */     06390000
         LA    @9,A00073+7                                        0193  06400000
*  IF NDR='1'B THEN                      /* TEST IF DEVICE REQUIRED */  06410000
         TM    A00105+2,B'00000100'                               0194  06420000
*    GOTO SCH007;                        /* TEST NOT REQUIRED */        06430000
         BC    01,SCH007                                          0195  06440000
*  DCNT1=DCNT1+1;                        /* NEXT DEVICE */              06450000
         LA    @F,1                                               0196  06460000
         SR    @0,@0                                              0196  06470000
         IC    @0,DCNT1                                           0196  06480000
         AR    @F,@0                                              0196  06490000
         STC   @F,DCNT1                                           0196  06500000
*  IF SKIPRIM='1'B THEN                  /* TEST SKIP PRIME BIT Y02008* 06510000
         TM    42(@8),B'01000000'                                 0197  06520000
*      GOTO SCH023L;                     /* NEXT DEVICE         X02008* 06530000
         BC    01,SCH023L                                         0198  06540000
*  GEN(BAL   R7,SCHA05);                 /* UPDATE SCT          S21937* 06550000
         BAL   R7,SCHA05                                                06560000
         DS    0H                                                       06570000
*  GEN(BAL   R7,SCH029);                 /* LINK TO DATA PROTECT */     06580000
         BAL   R7,SCH029                                                06590000
         DS    0H                                                       06600000
* SCH007:                                                               06610000
*  SECPTR=0;                             /* NO UTS LOADED */            06620000
SCH007   SR    @F,@F                                              0201  06630000
         ST    @F,SECPTR                                          0201  06640000
*  PLNM15=SNAM;                          /* TYPE OF SECTION */          06650000
         MVC   UTSPL(5),A00073+2                                  0202  06660000
*  PLNM68=SNAM1;                         /* COMPLETE THE SECTION NAME * 06670000
         MVC   UTSPL+5(3),0(@9)                                   0203  06680000
*  CLEANRT='0'B;                         /* ZERO SWITCH          M1390* 06690000
         NI    A00080+36,B'10111111'                              0204  06700000
*  IF LASTSEC='1'B THEN                  /* TEST LAST SECTION    M1463* 06710000
         TM    A00080+36,B'00000010'                              0205  06720000
*    GOTO SCH022;                        /* ALL SECTIONS RUN */         06730000
         BC    01,SCH022                                          0206  06740000
*  IF SCNT2^>SCNT1 THEN                  /* CHECK SECTION COUNT  M1463* 06750000
         CLC   A00073+1(1),SCNT1                                  0207  06760000
         BC    02,@9F4                                            0207  06770000
*    LASTSEC='1'B;                       /* LAST SECTION RUN     M1463* 06780000
         OI    A00080+36,B'00000010'                              0208  06790000
*  IF SLNG1='0000'X THEN                 /* TEST SECTION LENGTH */      06800000
@9F4     CLC   3(2,@9),@X7                                        0209  06810000
         BC    07,@9F3                                            0209  06820000
* SCH008:                                                               06830000
*    DO;                                 /* NO SIZE MEANS NO SECTION */ 06840000
*      R9=ADDR(SNAM2);                   /* NEXT SECTION ENTRY */       06850000
SCH008   LA    @9,5(0,@9)                                         0211  06860000
* SCH009:                                                               06870000
*      SCNT1=SCNT1+1;                    /* NEXT SECTIONS */            06880000
SCH009   LA    @F,1                                               0212  06890000
         SR    @0,@0                                              0212  06900000
         IC    @0,SCNT1                                           0212  06910000
         AR    @F,@0                                              0212  06920000
         STC   @F,SCNT1                                           0212  06930000
*      GOTO SCH007;                      /* TEST NEXT SECTION */        06940000
         BC    15,SCH007                                          0213  06950000
*    END;                                /* NO SECTION FOUND LOOP END * 06960000
*  IF TPFLAG='1'B&                       /* TEST TP FLAG */             06970000
*    SECRUN='1'B&                        /* SECTION RUN ALREADY */      06980000
*      OLDUT='0'B THEN                   /* NEW UTS */                  06990000
@9F3     TM    A00105+1,B'00000001'                               0215  07000000
         BC    12,@9F2                                            0215  07010000
         TM    A00105+6,B'00000010'                               0215  07020000
         BC    12,@9F1                                            0215  07030000
         TM    4(@9),B'00000001'                                  0215  07040000
*        GOTO SCH008;                    /* NEXT SECTION */             07050000
         BC    10,SCH008                                          0216  07060000
*  OORN='00'B;                                                          07070000
@9F0     EQU   *                                                  0217  07080000
@9F1     EQU   *                                                  0217  07090000
@9F2     NI    A00105,B'11001111'                                 0217  07100000
*  UTSIZ=SLNG1;                                                         07110000
         MVC   A00000+10(2),3(@9)                                 0218  07120000
*  IF CLRBIT='1'B THEN                                                  07130000
         TM    A00000+11,B'00000001'                              0219  07140000
         BC    12,@9EF                                            0219  07150000
*    OUTS='1'B;                                                         07160000
         OI    A00105,B'00100000'                                 0220  07170000
         BC    15,@9EE                                            0221  07180000
*  ELSE NUTS='1'B;                                                      07190000
@9EF     OI    A00105,B'00010000'                                 0221  07200000
*  CLRBIT='0'B;                                                         07210000
@9EE     NI    A00000+11,B'11111110'                              0222  07220000
*  IF RTPLKSZ>PARSZ THEN                 /* CHECK SIZE          X02008* 07230000
         L     @F,A00000+4                                        0223  07240000
         C     @F,A00000+8                                        0223  07250000
         BC    10,@9ED                                            0223  07260000
*    DO;                                 /* UTS TOO LARGE       X02008* 07270000
*      R1=IFD200;                        /* IFD200 MESSAGE      X02008* 07280000
         L     @C,MSGMOD                                          0225  07290000
         L     @1,96(0,@C)                                        0225  07300000
*      NM200=PLNAM;                      /* SECTION NAME        X02008* 07310000
         MVC   17(8,@1),UTSPL                                     0226  07320000
*      GOTO SCH025A;                     /* ISSUE WTO           X02008* 07330000
         BC    15,SCH025A                                         0227  07340000
*    END;                                /* END CORE CHECK      X02008* 07350000
*  IF PLSNM='2400W ' THEN                /* TAPE GAP TEST       S21937* 07360000
@9ED     CLC   UTSPL+1(6),@C8                                     0229  07370000
*    GOTO SCH025;                        /* BYPASS TEST         S21937* 07380000
         BC    08,SCH025                                          0230  07390000
* SCH010:                                                               07400000
*  UTSCAL='0'B;                          /* UTS NOT CALLED YET */       07410000
SCH010   NI    A00105+6,B'01111111'                               0231  07420000
*  NDCFO='1'B;                           /* NO DYN COMMUNICATION TEST * 07430000
         OI    A00105+2,B'10000000'                               0232  07440000
*  R7=DEVTBPTR;                          /* FIRST DEVICE TABLE        * 07450000
         L     @7,DEVTBPTR                                        0233  07460000
*  DO R4=16 TO 1 BY -1;                  /* COUNT OF DEVICES     M4507* 07470000
         LA    @4,16                                              0234  07480000
*    R7->GRABIT='0'B;                    /* CLEAR GRAB BIT       M4507* 07490000
@DO9EC   NI    12(@7),B'11111011'                                 0235  07500000
*    R7=R7+TABLNGTH;                     /* NEXT DEVICE TABLE         * 07510000
         AH    @7,TABLNGTH                                        0236  07520000
*  END;                                  /* LOOP FOR TABLE       M4507* 07530000
*  CLEANRT='0'B;                         /* NO CLEAN UP          M1390* 07540000
         BCT   @4,@DO9EC                                          0237  07550000
         NI    A00080+36,B'10111111'                              0238  07560000
*  IF PLNAM=ACTSECT THEN                /* IS THIS SAME SECTION Y02008* 07570000
         CLC   UTSPL(8),ACTSECT                                   0239  07580000
*    GO TO SCH010A;                     /* YES, NO NEED TO      Y02008* 07590000
         BC    08,SCH010A                                         0240  07600000
*                                       /* RE-LOAD..CONTINUE    Y02008* 07610000
*  GEN(BAL   R7,CALLCOMP);               /* CALL COMPUTE        X02008* 07620000
         BAL   R7,CALLCOMP                                              07630000
         DS    0H                                                       07640000
*  GEN(BAL   R7,CALLOAD);                /* CALL LOADER         X02008* 07650000
         BAL   R7,CALLOAD                                               07660000
         DS    0H                                                       07670000
*  IF R15^=0 THEN                       /* WAS LOAD OK          Y02008* 07680000
         LTR   @F,@F                                              0243  07690000
*    GO TO SCH008;                      /* NO, TRY NEXT SECTION Y02008* 07700000
         BC    07,SCH008                                          0244  07710000
*  ACTSECT=PLNAM;                       /* SAVE SECTION NAME    Y02008* 07720000
         MVC   ACTSECT(8),UTSPL                                   0245  07730000
*  OLTADDR=R1;                           /* SAVE OLT ADDRESS    Y02008* 07740000
         ST    @1,OLTADDR                                         0246  07750000
*  OLTINVV='0'B;                         /* OLT IS IN V=R       Y02008* 07760000
         NI    A00105+8,B'11110111'                               0247  07770000
*  IF VIRTUAL='1'B THEN                  /* IS OLTEP IN VIRTUAL Y02008* 07780000
         TM    A00105+7,B'00000010'                               0248  07790000
         BC    12,@9E8                                            0248  07800000
*    DO;                                 /* YES, THEN OLT WILL  Y02008* 07810000
*    OLTINVV='1'B;                       /* BE TOO              Y02008* 07820000
         OI    A00105+8,B'00001000'                               0250  07830000
*    IF VRCAP='0'B THEN                  /* DOES OLT HAVE V=V   Y02008* 07840000
         TM    A00140,B'00100000'                                 0251  07850000
         BC    05,@9E7                                            0251  07860000
*                                        /* CAPABILITY          Y02008* 07870000
*      DO;                               /* NO, PRINT MSGIFD248IY02008* 07880000
*      R4=IFD248;                        /* GET PTR TO MSG 248I Y02008* 07890000
         L     @C,MSGMOD                                          0253  07900000
         L     @4,140(0,@C)                                       0253  07910000
*      GEN(BAL   R7,SCH026A);            /* PRINT MESSAGE       Y02008* 07920000
         BAL   R7,SCH026A                                               07930000
         DS    0H                                                       07940000
*      END;                              /*                     Y02008* 07950000
*    END;                                /*                     Y02008* 07960000
@9E7     EQU   *                                                  0256  07970000
* SCH010A:                              /*                      Y02008* 07980000
*  R4=OLTADDR;                           /* RESTORE OLT ADDRESS Y02008* 07990000
@9E8     EQU   *                                                  0257  08000000
SCH010A  L     @4,OLTADDR                                         0257  08010000
*  NDCFO='0'B;                           /* TEST DYN COMMUNICATIONS */  08020000
         NI    A00105+2,B'01111111'                               0258  08030000
*  GO TO SCH011;                        /* PREPARE TO ENTER OLT Y02008* 08040000
         BC    15,SCH011                                          0259  08050000
* SCHA05:                                                               08060000
*  CDS8TO19=DVTABCDS(9:20);              /* CDS BYTES TO SCT    S21937* 08070000
SCHA05   MVC   CDS8TO19(12),40(@8)                                0260  08080000
* SCHA06:                                                               08090000
*  DEVDEPAD=ADDR(DVSEC1);                /* PRIMARY ENTRY       S21937* 08100000
SCHA06   LA    @F,A00080+8                                        0261  08110000
         ST    @F,DEVDEPAD                                        0261  08120000
*  IF DVCDS=0 THEN                       /* TEST DESCRIPTORS    S21937* 08130000
         CLC   36(4,@8),@D1                                       0262  08140000
         BC    07,@9E6                                            0262  08150000
*    PDDD1=DVUDD;                        /* USE UCB DESCRIPTORS S21937* 08160000
         L     @C,8(0,@8)                                         0263  08170000
         MVC   A00080+16(4),16(@C)                                0263  08180000
         BC    15,@9E5                                            0264  08190000
*  ELSE PDDD1=DVCDS;                     /* USE DEVICE CDS      S21937* 08200000
@9E6     MVC   A00080+16(4),36(@8)                                0264  08210000
*  PRIMBIT='1'B;                         /* PRIME BIT SET       S21937* 08220000
@9E5     OI    12(@8),B'01000000'                                 0265  08230000
*  PDPA1=DVADR;                          /* DEVICE ADDRESS      S21937* 08240000
         MVC   A00080+12(4),32(@8)                                0266  08250000
*  GOTO R7;                              /* RETURN TO MAIN FLOW S21937* 08260000
         BCR   15,@7                                              0267  08270000
* SCH011:                                                               08280000
*  SECPTR=R4;                            /* SAVE ENTRY POINT ADDRESS */ 08290000
SCH011   ST    @4,SECPTR                                          0268  08300000
*  GEN(EJECT);                                                          08310000
         EJECT                                                          08320000
         DS    0H                                                       08330000
*  IF NUTS='1'B THEN                     /* CHECK UTS           X02008* 08340000
         TM    A00105,B'00010000'                                 0270  08350000
         BC    12,@9E4                                            0270  08360000
*    DO;                                 /* NEW UTS             X02008* 08370000
*      R3=R4+INZRT;                      /* POINTER TO ROUTINE */       08380000
         LH    @3,10(0,@4)                                        0272  08390000
         AR    @3,@4                                              0272  08400000
*      IF RTPLKSZ<RTSIZ THEN             /* TEST UTS SIZE TO USEX02008* 08410000
         L     @F,20(0,@3)                                        0273  08420000
         C     @F,A00000+8                                        0273  08430000
         BC    12,@9E3                                            0273  08440000
*        RTPLKSZ=RTSIZ;                  /* USE UTS AND PLINK   X02008* 08450000
         MVC   A00000+8(4),20(@3)                                 0274  08460000
*      UTENT=INZIN;                      /* FIRST INSTRUCTION ADDRESS * 08470000
@9E3     MVC   UTENT(4),12(@4)                                    0275  08480000
*      IF ERLOP='1'B&                    /* EL OPTION ENTERED  SA51757* 08490000
*        ERRCNT='0'B THEN                /* NO EL COUNT ENTER  SA51757* 08500000
         TM    A00080+3,B'00000010'                               0276  08510000
         BC    12,@9E2                                            0276  08520000
         TM    A00080+33,B'00010000'                              0276  08530000
         BC    05,@9E1                                            0276  08540000
*          ERRLPCT=SPCOUNT;              /* USE OLTS EL COUNT  SA51757* 08550000
         MVC   A00080(2),18(@3)                                   0277  08560000
*      IF SECLEV^>SCTLEV THEN            /* CHECK SCT LEVEL     X02008* 08570000
@9E1     EQU   *                                                  0278  08580000
@9E2     CLC   11(1,@3),A00080+7                                  0278  08590000
*        GOTO SCH012;                    /* UTS SUPPORTED       X02008* 08600000
         BC    12,SCH012                                          0279  08610000
*      UT227=PLNAM;                      /* SECTION NAME        X02008* 08620000
         L     @C,MSGMOD                                          0280  08630000
         L     @C,68(0,@C)         IFD227                         0280  08640000
         MVC   37(8,@C),UTSPL                                     0280  08650000
*      R1=IFD227;                        /* IFD227 MESSAGE      X02008* 08660000
         L     @C,MSGMOD                                          0281  08670000
         L     @1,68(0,@C)                                        0281  08680000
*      GOTO SCH025A;                     /* WTO MESSAGE         X02008* 08690000
         BC    15,SCH025A                                         0282  08700000
*    END;                                /* END UTS INITIALIZATION */   08710000
*  R3=ADDR(RTMSK);                       /* POINTER TO ROUTINE */       08720000
@9E4     LA    @3,84(0,@4)                                        0284  08730000
*  UTENT=R4;                             /* FIRST INSTRUCTION ADDRESS * 08740000
         ST    @4,UTENT                                           0285  08750000
* SCH012:                                                               08760000
*  RTPLKSZ=RTPLKSZ+7;                    /* ROUND UP TO DWORD   X02008* 08770000
SCH012   LA    @F,7                                               0286  08780000
         A     @F,A00000+8                                        0286  08790000
         ST    @F,A00000+8                                        0286  08800000
*  TRPBITS='000'B;                       /* ZERO LOW ORDER BITS X02008* 08810000
         NI    A00000+11,B'11111000'                              0287  08820000
*  SECPRF=R3;                            /* ROUTINE ADDRESS */          08830000
         ST    @3,A00023+36                                       0288  08840000
*  UTSCAL='0'B;                          /* INDICATE GOING TO UTS */    08850000
         NI    A00105+6,B'01111111'                               0289  08860000
*  R4=IFD158;                            /* MESSAGE ADDRESS */          08870000
         L     @C,MSGMOD                                          0290  08880000
         L     @4,48(0,@C)                                        0290  08890000
*  MSGTEST=PLNAM;                        /* SECTION BEING RUN */        08900000
         MVC   16(8,@4),UTSPL                                     0291  08910000
*  IF OUTS='1'B THEN                     /* CHECK TEST                * 08920000
         TM    A00105,B'00100000'                                 0292  08930000
         BC    12,@9E0                                            0292  08940000
*    OLDTEST='$';                        /* INDICATE OLD TEST         * 08950000
         MVI   23(@4),C'$'                                        0293  08960000
*  MSGUNIT=BLKUNIT;                      /* CLEAR UNIT MESSAGE        * 08970000
@9E0     MVC   25(22,@4),24(@4)                                   0294  08980000
*  IF SYMBIT='1'B |                 /* CHECK IF SYMBOLIC OR   @Y30LPAW* 08990000
*     SYMBSSID='1'B THEN            /* SSID IN SYMB NAME FLD  @Y30LPAW* 09000000
         TM    41(@8),B'00001000'                                 0295  09010000
         BC    01,@9DF                                            0295  09020000
         TM    12(@8),B'00000001'                                 0295  09030000
         BC    12,@9DE                                            0295  09040000
*    MSGSYB=SYMNAME;                     /* SYMBOLIC NAME             * 09050000
@9DF     MVC   39(8,@4),44(@8)                                    0296  09060000
*  MSGVR='R';                            /* INDICATE OLT IS IN  Y02008* 09070000
@9DE     MVI   50(@4),C'R'                                        0297  09080000
*                                        /* REAL                Y02008* 09090000
*  IF OLTINVV='1'B THEN                  /* IS OLT IN VIRTUAL   Y02008* 09100000
         TM    A00105+8,B'00001000'                               0298  09110000
         BC    12,@9DD                                            0298  09120000
*    MSGVR='V';                          /* YES, PUT V IN START Y02008* 09130000
         MVI   50(@4),C'V'                                        0299  09140000
*                                        /* MESSAGE             Y02008* 09150000
*  MSGCPUID=CHARAFFN;                    /* PLACE SELECTED AFFN Y02008* 09160000
@9DD     MVC   58(2,@4),CHARAFFN                                  0300  09170000
*                                        /* IN START TERM MSG   Y02008* 09180000
*  IF MPSYS='0'B THEN                    /* IS IT AN MP SYSTEM  Y02008* 09190000
         TM    A00143,B'10000000'                                 0301  09200000
         BC    05,@9DC                                            0301  09210000
*    MPCPUID=MPCPUID&&MPCPUID;           /* NO, ELIMATE MP      Y02008* 09220000
         XC    51(9,@4),51(@4)                                    0302  09230000
*                                        /* PART OF MSG IFD158I Y02008* 09240000
*  KUNIT='UNIT';                         /* INSERT UNIT CONSTANTY02008* 09250000
@9DC     MVC   25(4,@4),@C13                                      0303  09260000
*  MSGDEV='NONE    ';                    /* PLACE UNIT EQUAL TO Y02008* 09270000
         MVC   30(8,@4),@C14                                      0304  09280000
*                                        /* IN ALL CASES.       Y02008* 09290000
*  IF NDR='1'B THEN                      /* TEST IF DEV ARE REQ Y02008* 09300000
         TM    A00105+2,B'00000100'                               0305  09310000
*    GO TO SCH013;                       /* NO DEVICES-UNIT=NONEY02008* 09320000
         BC    01,SCH013                                          0306  09330000
*                                        /* IS OK IN S T MSG    Y02008* 09340000
*  MSGDEV=DVEBC;                         /* DEVICE ADDRESS */           09350000
         MVC   30(8,@4),0(@8)                                     0307  09360000
*  SVR8=R8;                              /* SAVE REG            S21937* 09370000
         ST    @8,SVR8                                            0308  09380000
*  IF TPFLAG='0'B THEN                   /* TEST TP FLAG        S21937* 09390000
         TM    A00105+1,B'00000001'                               0309  09400000
*    GOTO SCHA04;                        /* NO TP DEVICE        S21937* 09410000
         BC    08,SCHA04                                          0310  09420000
*  IF NUTS='1'B THEN                     /* TEST UTS            S21937* 09430000
         TM    A00105,B'00010000'                                 0311  09440000
         BC    12,@9DB                                            0311  09450000
*    DO;                                 /* NEW UTS             S21937* 09460000
*      PRIMBIT='0'B;                     /* ZERO PRIME BIT      S21937* 09470000
         NI    12(@8),B'10111111'                                 0313  09480000
*      R8=DEVTBPTR;                      /* FIRST DEVICE TABLE  S21937* 09490000
         L     @8,DEVTBPTR                                        0314  09500000
*      GEN(BAL   R7,SCHA05);             /* LOAD SCT            S21937* 09510000
         BAL   R7,SCHA05                                                09520000
         DS    0H                                                       09530000
*      MSGDEV=DVEBC;                     /* DEVICE ADDRESS      S21937* 09540000
         MVC   30(8,@4),0(@8)                                     0316  09550000
*      GOTO SCHA04;                      /* RESUME PROGRAM      S21937* 09560000
         BC    15,SCHA04                                          0317  09570000
*    END;                                /* END NEW TP CHECK    S21937* 09580000
*  GEN(BAL   R7,SCHA06);                 /* UPDATE SCT          S21937* 09590000
@9DB     EQU   *                                                  0319  09600000
         BAL   R7,SCHA06                                                09610000
         DS    0H                                                       09620000
*  PRIMBIT='0'B;                         /* CLEAR PRIME BIT     S21937* 09630000
         NI    12(@8),B'10111111'                                 0320  09640000
*  PDPAD2=PDPAD1;                        /* SECONDARY IN SCT    S21937* 09650000
         MVC   A00080+24(8),A00080+12                             0321  09660000
*  R8=R8-TABLNGTH;                       /* PREVIOUS DEVICE     S21937* 09670000
         SH    @8,TABLNGTH                                        0322  09680000
*  GEN(BAL   R7,SCHA06);                 /* UPDATE SCT          S21937* 09690000
         BAL   R7,SCHA06                                                09700000
         DS    0H                                                       09710000
*  DEVDEPAD=ADDR(DVSEC2);                /* SECONDARY ENTRY     S21937* 09720000
         LA    @F,A00080+20                                       0324  09730000
         ST    @F,DEVDEPAD                                        0324  09740000
* SCHA04:                                                               09750000
* PRIDVPTR=R8;                           /* PRIME DEVICE TABLE   M1398* 09760000
SCHA04   ST    @8,PRIDVPTR                                        0325  09770000
*  R8=SVR8;                              /* RESTORE REG         S21937* 09780000
         L     @8,SVR8                                            0326  09790000
* SCH013:                                                               09800000
*  IF NUTS='0'B THEN                     /* TEST UTS */                 09810000
SCH013   TM    A00105,B'00010000'                                 0327  09820000
*    GOTO SCH014;                        /* NOT NEW UTS */              09830000
         BC    08,SCH014                                          0328  09840000
*  IF NDR='1'B THEN                      /* TEST IF DEVICE REQUIRED */  09850000
         TM    A00105+2,B'00000100'                               0329  09860000
         BC    12,@9DA                                            0329  09870000
*    DO;                                 /* CHECK OLTS          X02008* 09880000
*      IF WANT(3:4)='0000'X THEN         /* CHECK CLASS AND TYPEX02008* 09890000
         CLC   3(2,@3),@X7                                        0331  09900000
*        GOTO SCH014;                    /* NONE NEEDED         X02008* 09910000
         BC    08,SCH014                                          0332  09920000
*      R1=IFD201;                        /* IFD201 MESSAGE      X02008* 09930000
         L     @C,MSGMOD                                          0333  09940000
         L     @1,52(0,@C)                                        0333  09950000
*      UTS201=MSGTEST;                   /* SECTION NAME        X02008* 09960000
         MVC   43(8,@1),16(@4)                                    0334  09970000
*      GOTO SCH013D;                     /* ISSUE WTO           X02008* 09980000
         BC    15,SCH013D                                         0335  09990000
*    END;                                /* END OLTS CHECK      X02008* 10000000
*  IF DVCDS=0 THEN                       /* TEST DEVICE DESCRIPTORS */  10010000
@9DA     CLC   36(4,@8),@D1                                       0337  10020000
         BC    07,@9D9                                            0337  10030000
*        DO;                             /* SECTION CAN NOT BE RUN */   10040000
*         ASTERB='1'B;                   /* INDICATE ERROR */           10050000
         OI    A00080+3,B'01000000'                               0339  10060000
*         R1=IFD502;                     /* IFD502 MESSAGE      X02008* 10070000
         L     @C,MSGMOD                                          0340  10080000
         L     @1,88(0,@C)                                        0340  10090000
*         GOTO SCH013D;                  /* WTO MESSAGE         X02008* 10100000
         BC    15,SCH013D                                         0341  10110000
*        END;                            /* END OF SECTION CHECK */     10120000
*  RETCODE=2;                            /* INCORRECT DEVICE CODE */    10130000
@9D9     LA    @F,2                                               0343  10140000
         ST    @F,RETCODE                                         0343  10150000
*  WK1TO4=PDDD1;                         /* DESCRIPTS INTO WORK AREA */ 10160000
         MVC   4(4,@5),A00080+16                                  0344  10170000
*  WK5TO8=PDDD1;                         /* DESCRIPTS INTO WORK AREA */ 10180000
         MVC   8(4,@5),A00080+16                                  0345  10190000
*  WK1TO8=WK1TO8&WANTDONT;               /* SELECT BITS TO CHECK */     10200000
         NC    4(8,@5),1(@3)                                      0346  10210000
*  WK1TO4=WK1TO4&&WANT;                  /* REMOVE UNWANTED BITS */     10220000
         XC    4(4,@5),1(@3)                                      0347  10230000
*       IF PDDD1(4) ^= DONTWANT(4) THEN /* IF TYPE NOT WANTED @ZA09701* 10240000
         CLC   A00080+19(1),8(@3)                                 0348  10250000
         BC    08,@9D8                                            0348  10260000
*          DO;                          /* NOT EQUAL TYPE GIVEN */      10270000
*            WK5TO8(4) = '00'X;         /* ZERO OUT RESULT BYTE*/       10280000
         MVI   11(@5),X'00'                                       0350  10290000
*          END;                                             /*@ZA09701* 10300000
*  IF WK1TO8^=ZIP8 THEN                  /* TEST DESCRIPTS */           10310000
@9D8     CLC   4(8,@5),A00043+8                                   0352  10320000
         BC    08,@9D7                                            0352  10330000
*    DO;                                 /* DEV DESC DONT MATCH Y02008* 10340000
*    R1=IFD201;                          /* PRINT MSG INDICATINGY02008* 10350000
         L     @C,MSGMOD                                          0354  10360000
         L     @1,52(0,@C)                                        0354  10370000
*    UTS201=MSGTEST;                     /* DEVICE NO GOOD FOR  Y02008* 10380000
         MVC   43(8,@1),16(@4)                                    0355  10390000
*    GEN(BAL   R7,SCH027);               /* TEST EXECUTION      Y02008* 10400000
         BAL   R7,SCH027                                                10410000
         DS    0H                                                       10420000
*    GO TO SCH015;                       /*                     Y02008* 10430000
         BC    15,SCH015                                          0357  10440000
*    END;                                /*                     Y02008* 10450000
* SCH014:                                                               10460000
*  IF OUTS='1'B&                         /* OLD UTS */                  10470000
*    CSELRTN='1'B&                       /* CONSOLE SELECTED ROUTINES * 10480000
*      RTNM1ST='0000'X THEN             /* ROUTINES 1-16 MASK */        10490000
@9D7     EQU   *                                                  0359  10500000
SCH014   TM    A00105,B'00100000'                                 0359  10510000
         BC    12,@9D6                                            0359  10520000
         TM    A00100+29,B'00100000'                              0359  10530000
         BC    12,@9D5                                            0359  10540000
         CLC   A00100(2),@X7                                      0359  10550000
*        GOTO SCH014A;                   /* INCORRECT ROUTINES */       10560000
         BC    08,SCH014A                                         0360  10570000
*  WTO12=MSGSTR;                         /* START MESSAGE      SA51756* 10580000
@9D4     EQU   *                                                  0361  10590000
@9D5     EQU   *                                                  0361  10600000
@9D6     MVC   13(2,@4),A00128                                    0361  10610000
*  GEN(BAL   R7,SCH026);                 /* WTO MESSAGE        SA51756* 10620000
         BAL   R7,SCH026                                                10630000
         DS    0H                                                       10640000
*  WTO12=MSGEND;                         /* TERMINATE MESSAGE  SA51756* 10650000
         MVC   13(2,@4),A00128+2                                  0363  10660000
*  SUTMSG='1'B;                          /* START MSG ISSUED   SA51756* 10670000
         OI    A00105+8,B'00000100'                               0364  10680000
*  R7=ADDR(SCH014AB);                    /* RETURN ADDRESS            * 10690000
         LA    @7,SCH014AB                                        0365  10700000
*  READDCHK='1'B;                        /* TELL READD SECT ENTSA54318* 10710000
         OI    A00105+8,B'00010000'                               0366  10720000
* SCH014AA:                                                             10730000
*  R1=ADDR(PSCT);                        /* SECTION CONTROL TABLE */    10740000
SCH014AA LA    @1,PSCT                                            0367  10750000
*  R15=UTENT;                            /* ENTRY POINT TO UTS */       10760000
         L     @F,UTENT                                           0368  10770000
*  GEN(BALR  R14,R15);                   /* LINK TO SECTION */          10780000
         BALR  R14,R15                                                  10790000
         DS    0H                                                       10800000
*  RTMASK='00'X;                         /* RETURN CODE MASK    X02008* 10810000
         MVI   70(@2),X'00'                                       0370  10820000
*  UTSCAL='0'B;                          /* DELETE MODULES      XM5847* 10830000
         NI    A00105+6,B'01111111'                               0371  10840000
*  GOTO R7;                              /* RETURN FROM ROUTINE       * 10850000
         BCR   15,@7                                              0372  10860000
* SCH014AB:                                                             10870000
*  IF BYPDEV^='00'B&                     /* BYPASS TEST               * 10880000
*    CLEANRT='1'B THEN                   /* UTS HAS CLEANUP           * 10890000
SCH014AB TM    A00105+3,B'01100000'                               0373  10900000
         BC    08,@9D3                                            0373  10910000
         TM    A00080+36,B'01000000'                              0373  10920000
         BC    12,@9D2                                            0373  10930000
*      CLEANUP='1'B;                     /* CLEAN UP UTS              * 10940000
         OI    A00080+33,B'00000100'                              0374  10950000
*  RETCODE=R15;                          /* SAVE RETURN CODE */         10960000
@9D2     EQU   *                                                  0375  10970000
@9D3     ST    @F,RETCODE                                         0375  10980000
*  IF OLTTERM='1'B &                     /* WAS OLT FORCED TO   Y02008* 10990000
*    CLEANRT='1'B THEN                   /* TERM & IS CLEANUP   Y02008* 11000000
         TM    A00140,B'00000001'                                 0376  11010000
         BC    12,@9D1                                            0376  11020000
         TM    A00080+36,B'01000000'                              0376  11030000
         BC    12,@9D0                                            0376  11040000
*      CLEANUP='1'B;                     /* NEEDED. YES, CLEANUPY02008* 11050000
         OI    A00080+33,B'00000100'                              0377  11060000
* SCH014A:                                                              11070000
*  SECDVPTR=0;                           /* LAST GRAB DEVICE */         11080000
@9D0     EQU   *                                                  0378  11090000
@9D1     EQU   *                                                  0378  11100000
SCH014A  SR    @F,@F                                              0378  11110000
         ST    @F,SECDVPTR                                        0378  11120000
*  R0=ADDR(MODNN);                       /* ADDRESS OF MODULE NAME */   11130000
         L     @C,A00023+32        A00023                         0379  11140000
         LA    @0,44(0,@C)                                        0379  11150000
*  MODNN=KNT;                            /* OLTEP MODULE NAME */        11160000
         MVC   44(8,@C),36(@C)                                    0380  11170000
*  IF RTSTAE='1'B THEN                   /* STAE IN CONTROL           * 11180000
         TM    A00105+6,B'00000001'                               0381  11190000
*    GOTO SCH017;                        /* CHECK LOGSCAN             * 11200000
         BC    01,SCH017                                          0382  11210000
*  IF CSELRTN='0'B THEN                  /* TEST ROUTINES SELECTED */   11220000
         TM    A00100+29,B'00100000'                              0383  11230000
         BC    05,@9CF                                            0383  11240000
*    DO;                                 /* NOT SELECTED FROM CONSOLE * 11250000
*      RTNM1ST=RTNM1ST&&RTNM1ST;         /* ZERO FIRST ROUTINES MASK */ 11260000
         XC    A00100(2),A00100                                   0385  11270000
*      RTNMLST=RTNMLST&&RTNMLST;         /* ZERO LAST ROUTINES MASK */  11280000
         XC    A00100+36(30),A00100+36                            0386  11290000
*    END;                                /* ROUTINES MASKS ZEROED */    11300000
*  IF TERTN<HIRTN THEN                   /* TEST ROUTINES IN UTS */     11310000
@9CF     CLC   A00006(1),A00006+1                                 0388  11320000
         BC    10,@9CE                                            0388  11330000
*    DO;                                 /* SOME ROUTINES NOT PRESENT * 11340000
*      R1=IFD503;                        /* IFD503 MESSAGE      X02008* 11350000
         L     @C,MSGMOD                                          0390  11360000
         L     @1,92(0,@C)                                        0390  11370000
*      GEN(BAL   R7,SCH027);             /* ISSUE WTO           X02008* 11380000
         BAL   R7,SCH027                                                11390000
         DS    0H                                                       11400000
*                                        /*                     A45731* 11410000
*    END;                                /* END ROUTINE TEST */         11420000
* SCH015:                                                               11430000
*         DYCOM='0'B;                    /* ZERO DYN COMM FLAG  X02008* 11440000
@9CE     EQU   *                                                  0393  11450000
SCH015   NI    A00080+36,B'11111110'                              0393  11460000
*         TALKFLAG ='0'B;                /* ZERO TALK FLAG      X02008* 11470000
         NI    A00080+37,B'01111111'                              0394  11480000
* SCH016:                                                               11490000
*  IF RETCODE=2 THEN                     /* TEST RETURN CODE */         11500000
SCH016   LA    @F,2                                               0395  11510000
         C     @F,RETCODE                                         0395  11520000
         BC    07,@9CD                                            0395  11530000
*    DO;                                 /* INCORRECT DEVICE */         11540000
*      R1=IFD231;                        /* IFD231 MESSAGE      X02008* 11550000
         L     @C,MSGMOD                                          0397  11560000
         L     @1,80(0,@C)                                        0397  11570000
*      WMSGTEST=MSGTEST;                 /* SECTION NAME */             11580000
         MVC   12(8,@1),16(@4)                                    0398  11590000
*      WMSGDEV=MSGDEV;                   /* DEVICE ADDRESS */           11600000
         MVC   35(8,@1),30(@4)                                    0399  11610000
*      WTO1='*';                         /* TERMINATE WITH AN ERROR */  11620000
         MVI   13(@4),C'*'                                        0400  11630000
*       GOTO SCH013D;                    /* WTO MESSAGE         X02008* 11640000
         BC    15,SCH013D                                         0401  11650000
*    END;                                /* END MESSAGE OUTPUT */       11660000
*  IF PFPMSG='1'B THEN                   /* TEST FILE PROTECT BIT */    11670000
@9CD     TM    A00105+6,B'00010000'                               0403  11680000
         BC    12,@9CC                                            0403  11690000
*    DO;                                 /* TEST CANCELLED */           11700000
*      R1=IFD313;                        /* IFD313 MESSAGE      X02008* 11710000
         L     @C,MSGMOD                                          0405  11720000
         L     @1,84(0,@C)                                        0405  11730000
*      GEN(BAL   R7,SCH027);             /* ISSUE WTO           X02008* 11740000
         BAL   R7,SCH027                                                11750000
         DS    0H                                                       11760000
*      PFPMSG='0'B;                      /* CLEAR FILE PROTECT BIT */   11770000
         NI    A00105+6,B'11101111'                               0407  11780000
*      WTO1='*';                         /* TERMINATE WITH AN ERROR */  11790000
         MVI   13(@4),C'*'                                        0408  11800000
*    END;                                /* END OF FILE PROTECT LOOP */ 11810000
*  RESTRICT(6);                                                         11820000
@9CC     EQU   *                                                  0410  11830000
* SCH017:                                                               11840000
*  R6=LOGADR;                            /* LOGSCAN ADDRESS IF ANY */   11850000
SCH017   L     @6,LOGADR                                          0411  11860000
*  IF R6=0 THEN                          /* TEST IF LOGSCAN USED */     11870000
         LTR   @6,@6                                              0412  11880000
*    GOTO SCH018;                        /* NO LOGSCAN USED */          11890000
         BC    08,SCH018                                          0413  11900000
*  EOJLOG='1'B;                          /* INDICATE END OF LOGSCAN */  11910000
         OI    A00105+6,B'00100000'                               0414  11920000
*  R15=R6;                               /* ENTRY TO LOGSCAN */         11930000
         LR    @F,@6                                              0415  11940000
*  GEN(BALR  R14,R15);                   /* LINK TO LOGSCAN */          11950000
         BALR  R14,R15                                                  11960000
         DS    0H                                                       11970000
*  RELEASE(6);                                                          11980000
* SCH018:                                                               11990000
*  IF CLEANUP='1'B THEN                  /* CLEAN UP UTS              * 12000000
SCH018   TM    A00080+33,B'00000100'                              0418  12010000
         BC    12,@9CB                                            0418  12020000
*    DO;                                 /* CLEAN UP PRESENT   SA51756* 12030000
*    CLEANRT='0'B;                       /* ZERO OLT HAS CLEANUPX03008* 12040000
         NI    A00080+36,B'10111111'                              0420  12050000
*                                        /* FLAG                X03008* 12060000
*      FFEFCE='11'B;                     /* 1ST ERROR BITS     SA51756* 12070000
         OI    A00105+5,B'00110000'                               0421  12080000
*    GEN(BAL   R7,SCH014AA);             /* GO TO UTS                 * 12090000
         BAL   R7,SCH014AA                                              12100000
         DS    0H                                                       12110000
*    END;                                /* END CLEAN UP CHECK SA51756* 12120000
*  OLTTERM='0'B;                         /* CLEAR OLT FORCED TO Y02008* 12130000
@9CB     NI    A00140,B'11111110'                                 0424  12140000
*                                        /* TERMINATE FLAG      Y02008* 12150000
*  CLEANUP='0'B;                         /* NO CLEANUP                * 12160000
         NI    A00080+33,B'11111011'                              0425  12170000
*  R7=DEVTBPTR;                          /* DEVICE TABLE       SA51754* 12180000
         L     @7,DEVTBPTR                                        0426  12190000
*  DO R6=16 TO 1 BY -1;                  /* COUNT OF DEVICES   SA51754* 12200000
         LA    @6,16                                              0427  12210000
*    IF R7->EXIOACT='0'B THEN            /* CHECK DEVICE       SA51754* 12220000
@DO9CA   TM    12(@7),B'00010000'                                 0428  12230000
*      GOTO SCH018D;                     /* DEVICE NOT ACTIVE  SA51754* 12240000
         BC    08,SCH018D                                         0429  12250000
*    DIOCDSAD=R7+32;                     /* CDS ADDRESS         X02008* 12260000
         LA    @F,32                                              0430  12270000
         AR    @F,@7                                              0430  12280000
         ST    @F,DIOPARM+4                                       0430  12290000
*    R5=ADDR(IODEVTAB(13));              /* POINT TO 2ND        YM4758* 12300000
         LA    @5,IODEVTAB+12                                     0431  12310000
*                                        /* IODEVTAB            YM4758* 12320000
*    DO INDEX=2 TO 1 BY -1;              /* FIND RIGHT TECB PTR YM4758* 12330000
         LA    @F,2                                               0432  12340000
         STH   @F,INDEX                                           0432  12350000
*    IF R7=DEVPTR THEN                   /* DOES THIS IO DEVTAB Y02008* 12360000
@DO9C6   MVC   @TEMP4(4),0(@5)                                    0433  12370000
         L     @F,@TEMP4                                          0433  12380000
         CR    @F,@7                                              0433  12390000
         BC    07,@9C2                                            0433  12400000
*                                        /* ENTRY POINT TO      Y02008* 12410000
*                                        /* CORRECT DEVTAB ENTRYY02008* 12420000
*      DO;                               /* YES, DO DIO PREP    Y02008* 12430000
*      R1=IOSBPTR;                       /* REG 1 IS IOSB PTR   Y02008* 12440000
         MVC   @TEMP4(4),4(@5)                                    0435  12450000
         L     @1,@TEMP4                                          0435  12460000
*      DIOTECB=PTRTECB;                  /* PUT TECB PTR IN DIO Y02008* 12470000
         MVC   DIOPARM+8(4),112(@1)                               0436  12480000
*                                        /* PARMLIST            Y02008* 12490000
*      GO TO SCH018C;                    /* GO DO DIO           Y02008* 12500000
         BC    15,SCH018C                                         0437  12510000
*      END;                              /*                     Y02008* 12520000
*    R5=R5+12;                           /* POINT TO NEXT IO    Y02008* 12530000
@9C2     AH    @5,@D2                                             0439  12540000
*                                        /* DEVTAB              Y02008* 12550000
*    END;                                /*                     Y02008* 12560000
*  GO TO SCH018C1;                       /* CANNOT FIND CONTROL YM4758* 12570000
         LH    @F,INDEX                                           0440  12580000
         BCTR  @F,0                                               0440  12590000
@DO9C5   STH   @F,INDEX                                           0440  12600000
         CH    @F,@D3                                             0440  12610000
         BC    10,@DO9C6                                          0440  12620000
         BC    15,SCH018C1                                        0441  12630000
*                                        /* BLOCK MATCH, BYPASS YM4758* 12640000
*                                        /* DIO ATTEMPT         YM4758* 12650000
* SCH018C:                               /*                     Y02008* 12660000
*    R5=TMCOMAD;                         /* RESTORE REG 5       Y02008* 12670000
SCH018C  L     @5,A00023+32                                       0442  12680000
*    R1=ADDR(DIOPARM);                   /* DIO PARM LIST      SA51754* 12690000
         LA    @1,DIOPARM                                         0443  12700000
*    R15=TAB28;                          /* ENTRY POINT        SA51754* 12710000
         L     @F,TAB28                                           0444  12720000
*    GEN(BALR  R14,R15);                 /* LINK TO DIO        SA51754* 12730000
         BALR  R14,R15                                                  12740000
         DS    0H                                                       12750000
* SCH018C1:                              /*                     YM4758* 12760000
*    R7->EXIOACT='0'B;                   /* DEVICE NOT ACTIVE   X02008* 12770000
SCH018C1 NI    12(@7),B'11101111'                                 0446  12780000
* SCH018D:                                                              12790000
*    R7=R7+TABLNGTH;                     /* NEXT DEVICE ENTRY  SA51754* 12800000
SCH018D  AH    @7,TABLNGTH                                        0447  12810000
*    END;                                /* END DEVICE CHECK   SA51754* 12820000
*  IF RTSTAE='1'B THEN                   /* STAE IN CONTROL     X03008* 12830000
         BCT   @6,@DO9CA                                          0448  12840000
         TM    A00105+6,B'00000001'                               0449  12850000
*    GO TO SCH019;                       /* YES% CHECK PLINK    X03008* 12860000
         BC    01,SCH019                                          0450  12870000
* SCH018F:                                                              12880000
*  UTSCAL='0'B;                          /* DELETE MODULES      XM5847* 12890000
SCH018F  NI    A00105+6,B'01111111'                               0451  12900000
*  R4=IFD158;                            /* TERMINATE MESSAGE   X02008* 12910000
         L     @6,MSGMOD                                          0452  12920000
         L     @4,48(0,@6)                                        0452  12930000
*  IF SCTASTER^='00'B THEN               /* TEST ERROR INDICATORS */    12940000
         TM    A00080+3,B'11000000'                               0453  12950000
         BC    08,@9C1                                            0453  12960000
*    WTO1='*';                           /* TERMINATE ERROR MESSAGE */  12970000
         MVI   13(@4),C'*'                                        0454  12980000
*  SCTASTER='00'B;                       /* CLEAR ERROR BITS */         12990000
@9C1     NI    A00080+3,B'00011111'                               0455  13000000
*  CATB1='0'B;                           /* CLEAR CATASTROPHIC OY01377* 13010000
*                                        /* ERROR FLAG AT DTERMOY01377* 13020000
*                                        /* TIME.              OY01377* 13030000
*  IF SUTMSG='1'B THEN                   /* START MSG ISSUED   SA51756* 13040000
         TM    A00105+8,B'00000100'                               0457  13050000
         BC    12,@9C0                                            0457  13060000
*  GEN(BAL   R7,SCH026);                 /* WTO MESSAGE */              13070000
         BAL   R7,SCH026                                                13080000
         DS    0H                                                       13090000
*  SUTMSG='0'B;                          /* CLEAR BIT          SA51756* 13100000
@9C0     NI    A00105+8,B'11111011'                               0459  13110000
*  SECPTR=0;                             /* UTS DELETED               * 13120000
         SR    @F,@F                                              0460  13130000
         ST    @F,SECPTR                                          0460  13140000
*  RETCODE=0;                            /* RETURN CODE HANDLED */      13150000
         ST    @F,RETCODE                                         0461  13160000
*  TERTN='00'X;                          /* ZERO LAST ROUTINE NUMBER */ 13170000
         MVI   A00006,X'00'                                       0462  13180000
*  GEN(EJECT);                                                          13190000
         EJECT                                                          13200000
         DS    0H                                                       13210000
* SCH019:                                                               13220000
*  ZIP16=ZIP16&&ZIP16;                   /* ZERO PLINK MORECORE X02008* 13230000
SCH019   XC    A00043(16),A00043                                  0464  13240000
*  IF RTSTAE='1'B THEN                   /* STAE IN CONTROL           * 13250000
         TM    A00105+6,B'00000001'                               0465  13260000
*    RETURN;                             /* RETURN TO STAE            * 13270000
         BC    03,@EL01                                           0466  13280000
*  IF FECOM='0'B THEN                    /* TEST 1ST ERROR */           13290000
@9BF     TM    A00080+2,B'00000001'                               0467  13300000
         BC    05,@9BE                                            0467  13310000
*    CATB1='0'B;                         /* NO 1ST ERROR */             13320000
         NI    A00080+3,B'11011111'                               0468  13330000
*  IF NPR='0'B|                          /* TEST NO PRINT OPTION */     13340000
*    NEP='1'B THEN                       /* TEST NO ERROR PRINT */      13350000
@9BE     TM    A00080+2,B'00000100'                               0469  13360000
         BC    08,@9BD                                            0469  13370000
         TM    A00080+3,B'00000100'                               0469  13380000
         BC    12,@9BC                                            0469  13390000
*       CATB1='0'B;                      /* ZERO CAT BIT IF NO PRINT */ 13400000
@9BD     NI    A00080+3,B'11011111'                               0470  13410000
*  IF CODE5='1'B THEN                    /* TEST IF LOOP BACK */        13420000
@9BC     TM    A00105+6,B'00001000'                               0471  13430000
*    GOTO SCH002;                        /* RETURN TO START */          13440000
         BC    01,SCH002                                          0472  13450000
*  IF BYPDEV^='00'B THEN                 /* TEST BYPASS BITS */         13460000
         TM    A00105+3,B'01100000'                               0473  13470000
*    GOTO SCH022;                        /* BYPASS THIS DEVICE */       13480000
         BC    05,SCH022                                          0474  13490000
*  IF SNEWRUN='1'B THEN                  /* TEST BIT           SA51756* 13500000
         TM    A00105+8,B'00000010'                               0475  13510000
*    GOTO SCH001;                        /* NEW DEVICES AND TESTS */    13520000
         BC    01,SCH001                                          0476  13530000
*  IF LASTSEC='0'B THEN                  /* CHECK SECTION COUNT  M1463* 13540000
         TM    A00080+36,B'00000010'                              0477  13550000
*    GOTO SCH008;                        /* NEXT SECTION */             13560000
         BC    08,SCH008                                          0478  13570000
* SCH022:                                                               13580000
*  SECRUN='1'B;                          /* ALL SECTIONS RUN */         13590000
SCH022   OI    A00105+6,B'00000010'                               0479  13600000
* SCH023:                                                               13610000
*  UTCOM=UTCOM&&UTCOM;                   /* ZERO OUT PASSON AREA */     13620000
SCH023   XC    UTCOM(64),UTCOM                                    0480  13630000
*  PRIMBIT='0'B;                         /* CLEAR PRIMARY DEVICE BIT */ 13640000
         NI    12(@8),B'10111111'                                 0481  13650000
*  IF NURUN='1'B THEN                    /* TEST BYPASS ALL DEVICES */  13660000
         TM    A00105+3,B'01000000'                               0482  13670000
*    GOTO SCH024A;                       /* END TEST RUN */             13680000
         BC    01,SCH024A                                         0483  13690000
*  BYPDEV='00'B;                         /* ZERO OUT BYPASS SWITCHES */ 13700000
         NI    A00105+3,B'10011111'                               0484  13710000
*  IF NDR='1'B THEN                      /* TEST IF DEVICE REQUIRED */  13720000
         TM    A00105+2,B'00000100'                               0485  13730000
*    GOTO SCH024;                        /* DEVICE NOT REQUIRED */      13740000
         BC    01,SCH024                                          0486  13750000
*  IF ONEPRIM='1'B THEN                  /* TEST ONE PRIME DEVICE BIT * 13760000
         TM    A00080+33,B'00001000'                              0487  13770000
*    GOTO SCH024;                        /* END OF DEVICE TESTING */    13780000
         BC    01,SCH024                                          0488  13790000
* SCH023L:                                                              13800000
*  IF DCNT1^<DCNT2 THEN                  /* TEST DEVICE COUNT */        13810000
SCH023L  CLC   DCNT1(1),DCNT2                                     0489  13820000
         BC    04,@9BB                                            0489  13830000
*      DO;                               /* NO MORE DEVICES TO TEST */  13840000
* SCH024:                                                               13850000
*        ONEPRIM='0'B;                   /* ZERO ONE PRIME DEVICE BIT * 13860000
SCH024   NI    A00080+33,B'11110111'                              0491  13870000
*        DCNT1='00'X;                    /* ZERO DEVICE COUNT */        13880000
         MVI   DCNT1,X'00'                                        0492  13890000
*        IF TLCOUNT>'0000'X&             /* CHECK TEST LOOP COUNT */    13900000
*          TLRUN<TLCOUNT THEN            /* CHECK TEST LOOP RUN */      13910000
         L     @F,@X17                                            0493  13920000
         CH    @F,TLCOUNT                                         0493  13930000
         BC    10,@9BA                                            0493  13940000
         LH    @F,TLCOUNT                                         0493  13950000
         CH    @F,TLRUN                                           0493  13960000
         BC    12,@9B9                                            0493  13970000
*            DO;                         /* LOOP THRU TESTS AGAIN */    13980000
*              TLRUN=TLRUN+1;            /* COUNT TEST RUNS */          13990000
         LA    @F,1                                               0495  14000000
         AH    @F,TLRUN                                           0495  14010000
         STH   @F,TLRUN                                           0495  14020000
*              GOTO SCH003;              /* RERUN TESTS */              14030000
         BC    15,SCH003                                          0496  14040000
*            END;                        /* END OF LOOP CHECK */        14050000
* SCH024A:                                                              14060000
*        RETURN;                         /* NORMAL RETURN */            14070000
*      END;                              /* ALL ACTIONS COMPLETED */    14080000
*  GOTO SCH005;                          /* NEXT DEVICE */              14090000
* CALLCOMP:                                                             14100000
*  COMPUTB='1'B;                         /* COMPUTE ONLY        X02008* 14110000
CALLCOMP OI    PARM12+12,B'01000000'                              0501  14120000
*  GOTO CALL12;                          /* GO TO LOADER        X02008* 14130000
         BC    15,CALL12                                          0502  14140000
* CALLOAD:                                                              14150000
*  COMPUTB='0'B;                         /* LOAD MODULE         X02008* 14160000
CALLOAD  NI    PARM12+12,B'10111111'                              0503  14170000
* CALL12:                                                               14180000
*  R1=ADDR(LDLIST);                                                     14190000
CALL12   LA    @1,LDLIST                                          0504  14200000
*  R15=TAB28;                            /* ENTRY POINT         X02008* 14210000
         L     @F,TAB28                                           0505  14220000
*  GEN(BALR  R14,R15);                                                  14230000
         BALR  R14,R15                                                  14240000
         DS    0H                                                       14250000
*  GOTO R7;                                                             14260000
         BCR   15,@7                                              0507  14270000
* SCH025:                                                               14280000
*  R1=IFD501;                            /* MESSAGE ADDRESS      M1463* 14290000
SCH025   L     @6,MSGMOD                                          0508  14300000
         L     @1,40(0,@6)                                        0508  14310000
*  MSGUTS=PLNAM;                         /* SECTION NAME        S21937* 14320000
         MVC   12(8,@1),UTSPL                                     0509  14330000
* SCH025A:                                                              14340000
*  SLNG1='0000'X;                        /* ZERO SIZE VALUE     X02008* 14350000
SCH025A  MVC   3(2,@9),@X7                                        0510  14360000
* SCH013D:                                                              14370000
*  GEN(BAL   R7,SCH027);                 /* WTO MESSAGE */              14380000
SCH013D  BAL   R7,SCH027                                                14390000
         DS    0H                                                       14400000
*  GOTO SCH018F;                         /* NEXT TEST           X02008* 14410000
         BC    15,SCH018F                                         0512  14420000
*  RESTRICT(7);                                                         14430000
* SCH026:                                                               14440000
*  FEITEMS='0000'B;                      /* ZERO 1ST ERROR ITEM S21937* 14450000
SCH026   NI    A00105+5,B'11000011'                               0514  14460000
*  IF NCP='0'B THEN                      /* TEST NO CONTROL PRINT */    14470000
         TM    A00080+3,B'00001000'                               0515  14480000
*    GOTO R7;                            /* NO START OR TERMINATE */    14490000
         BCR   08,@7                                              0516  14500000
* SCH026A:                                                              14510000
*  R1=R4;                                /* MESSAGE ADDRESS */          14520000
SCH026A  LR    @1,@4                                              0517  14530000
*  GEN;                                                                 14540000
SCH027   PWTO  REG=(1)                  ISSUE A WTO                     14550000
         DS    0H                                                       14560000
*  GOTO R7;                              /* RETURN TO MAIN FLOW */      14570000
         BCR   15,@7                                              0519  14580000
* SCH029:                                                               14590000
*  PDFLG(2)=CDSFLAG;                                                    14600000
SCH029   MVC   A00080+11(1),41(@8)                                0520  14610000
*  NDCFO='1'B;                           /* NO DYN COMMUNICATION TEST * 14620000
         OI    A00105+2,B'10000000'                               0521  14630000
*  UTSCAL='0'B;                          /* UTS NOT CALLED YET */       14640000
         NI    A00105+6,B'01111111'                               0522  14650000
*  R15=DATPTR;                           /* DATA PROTECT ROOT MODULE */ 14660000
         L     @F,DATPTR                                          0523  14670000
*  GEN(BALR  R14,R15);                   /* GO TO DATA PROTECT */       14680000
         BALR  R14,R15                                                  14690000
         DS    0H                                                       14700000
*  IF CEVOL='1'B THEN                    /* CHECK FOR CE PACK  SA51755* 14710000
         TM    13(@8),B'00100000'                                 0525  14720000
         BC    12,@9B8                                            0525  14730000
*    CEVOLUM='1'B;                       /* CE VOLUME          SA51755* 14740000
         OI    A00080+11,B'00100000'                              0526  14750000
*  NDCFO='0'B;                           /* TEST DYN COMMUNICATIONS */  14760000
@9B8     NI    A00105+2,B'01111111'                               0527  14770000
*  IF BYPDEV^='00'B THEN                 /* TEST BYPASS BITS */         14780000
         TM    A00105+3,B'01100000'                               0528  14790000
*    GOTO SCH023;                        /* BYPASS ONE OR ALL TESTS */  14800000
         BC    05,SCH023                                          0529  14810000
*  GOTO R7;                              /* RETURN TO MAIN FLOW */      14820000
         BCR   15,@7                                              0530  14830000
* END;                                   /* END OF MAIN PROCEDURE */    14840000
@EL01    L     @D,4(0,@D)                                         0531  14850000
         LM    @E,@C,12(@D)                                       0531  14860000
         BCR   15,@E                                              0531  14870000
@DATA1   EQU   *                                                        14880000
@0       EQU   00                  EQUATES FOR REGISTERS 0-15           14890000
@1       EQU   01                                                       14900000
@2       EQU   02                                                       14910000
@3       EQU   03                                                       14920000
@4       EQU   04                                                       14930000
@5       EQU   05                                                       14940000
@6       EQU   06                                                       14950000
@7       EQU   07                                                       14960000
@8       EQU   08                                                       14970000
@9       EQU   09                                                       14980000
@A       EQU   10                                                       14990000
@B       EQU   11                                                       15000000
@C       EQU   12                                                       15010000
@D       EQU   13                                                       15020000
@E       EQU   14                                                       15030000
@F       EQU   15                                                       15040000
@D1      DC    F'0'                                                     15050000
@D2      DC    H'12'                                                    15060000
@D3      DC    H'1'                                                     15070000
         DS    0F                                                       15080000
@C13     DC    C'UNIT'                                                  15090000
@C14     DC    C'NONE    '                                              15100000
@X17     DC    X'00000000'                                              15110000
@X7      DC    X'0000'                                                  15120000
@C8      DC    C'2400W '                                                15130000
         DS    0D                                                       15140000
@DATA    EQU   *                                                        15150000
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD                   15160000
X        EQU   00000000            FULLWORD INTEGER                     15170000
R0       EQU   00000000            FULLWORD POINTER REGISTER            15180000
R1       EQU   00000001            FULLWORD POINTER REGISTER            15190000
R2       EQU   00000002            FULLWORD POINTER REGISTER            15200000
R3       EQU   00000003            FULLWORD POINTER REGISTER            15210000
R4       EQU   00000004            FULLWORD POINTER REGISTER            15220000
R5       EQU   00000005            FULLWORD POINTER REGISTER            15230000
R6       EQU   00000006            FULLWORD POINTER REGISTER            15240000
R7       EQU   00000007            FULLWORD POINTER REGISTER            15250000
R8       EQU   00000008            FULLWORD POINTER REGISTER            15260000
R9       EQU   00000009            FULLWORD POINTER REGISTER            15270000
R10      EQU   00000010            FULLWORD POINTER REGISTER            15280000
R11      EQU   00000011            FULLWORD POINTER REGISTER            15290000
R12      EQU   00000012            FULLWORD POINTER REGISTER            15300000
R13      EQU   00000013            FULLWORD POINTER REGISTER            15310000
R14      EQU   00000014            FULLWORD POINTER REGISTER            15320000
R15      EQU   00000015            FULLWORD POINTER REGISTER            15330000
HCODE    EQU   00000132            1 BYTE(S)                            15340000
A00007   EQU   00000016            4 BYTE(S) ON WORD                    15350000
WKBY     EQU   A00007+00000000     FULLWORD INTEGER                     15360000
A00008   EQU   A00007+00000000     2 BYTE(S)                            15370000
WKBY34   EQU   A00007+00000002     2 BYTE(S)                            15380000
A00009   EQU   00000000            144 BYTE(S) ON WORD                  15390000
IFD100   EQU   A00009+00000000     FULLWORD POINTER                     15400000
A00010   EQU   A00009+00000004     5*FULLWORD POINTER                   15410000
IFD117   EQU   A00009+00000024     FULLWORD POINTER                     15420000
IFD121   EQU   A00009+00000028     FULLWORD POINTER                     15430000
A00011   EQU   A00009+00000032     FULLWORD POINTER                     15440000
IFD135   EQU   A00009+00000036     FULLWORD POINTER                     15450000
IFD501   EQU   A00009+00000040     FULLWORD POINTER                     15460000
A00012   EQU   A00009+00000044     FULLWORD POINTER                     15470000
IFD158   EQU   A00009+00000048     FULLWORD POINTER                     15480000
IFD201   EQU   A00009+00000052     FULLWORD POINTER                     15490000
A00013   EQU   A00009+00000056     6*FULLWORD POINTER                   15500000
IFD231   EQU   A00009+00000080     FULLWORD POINTER                     15510000
IFD313   EQU   A00009+00000084     FULLWORD POINTER                     15520000
IFD502   EQU   A00009+00000088     FULLWORD POINTER                     15530000
IFD503   EQU   A00009+00000092     FULLWORD POINTER                     15540000
IFD200   EQU   A00009+00000096     FULLWORD POINTER                     15550000
A00014   EQU   A00009+00000100     10*FULLWORD POINTER                  15560000
IFD248   EQU   A00009+00000140     FULLWORD POINTER                     15570000
A00015   EQU   A00009+00000140     FULLWORD POINTER                     15580000
IFD227   EQU   00000068            FULLWORD POINTER                     15590000
A00016   EQU   00000000            45 BYTE(S) ON WORD                   15600000
A00017   EQU   A00016+00000000     37 BYTE(S)                           15610000
UT227    EQU   A00016+00000037     8 BYTE(S)                            15620000
SECLEV   EQU   00000011            1 BYTE(S)                            15630000
A00018   EQU   00000000            82 BYTE(S) ON WORD                   15640000
A00019   EQU   A00018+00000000     4 BYTE(S)                            15650000
MSG100A  EQU   A00018+00000004     78 BYTE(S)                           15660000
A00020   EQU   A00018+00000004     8 BYTE(S)                            15670000
MSG100   EQU   A00018+00000012     70 BYTE(S)                           15680000
SVR8     EQU   @DATA+00000072      FULLWORD INTEGER                     15690000
A00021   EQU   SVR8+00000000       2 BYTE(S)                            15700000
SVR834   EQU   SVR8+00000002       2 BYTE(S)                            15710000
A00022   EQU   SVR8+00000002       1 BYTE(S)                            15720000
SVR84    EQU   SVR8+00000003       1 BYTE(S)                            15730000
         ORG   @DATA+00000076                                           15740000
RETCODE  EQU   *                   FULLWORD INTEGER                     15750000
         DC    FL4'0'                                                   15760000
WK1TO8   EQU   00000004            8 BYTE(S)                            15770000
WK1TO4   EQU   WK1TO8+00000000     4 BYTE(S)                            15780000
WK5TO8   EQU   WK1TO8+00000004     4 BYTE(S)                            15790000
A00026   EQU   00000000            16 BYTE(S) ON WORD                   15800000
INZNM    EQU   A00026+00000000     8 BYTE(S)                            15810000
INZLV    EQU   A00026+00000008     2 BYTE(S)                            15820000
INZRT    EQU   A00026+00000010     HALFWORD INTEGER                     15830000
INZIN    EQU   A00026+00000012     FULLWORD POINTER                     15840000
A00027   EQU   A00026+00000012     1 BYTE(S)                            15850000
WANTDONT EQU   00000001            8 BYTE(S)                            15860000
WANT     EQU   WANTDONT+00000000   4 BYTE(S)                            15870000
DONTWANT EQU   WANTDONT+00000004   4 BYTE(S)                            15880000
A00028   EQU   WANTDONT+00000004   1 BYTE(S)                            15890000
A00029   EQU   00000020            8 BYTE(S) ON WORD                    15900000
RTSIZ    EQU   A00029+00000000     FULLWORD INTEGER                     15910000
MOSIZ    EQU   A00029+00000004     FULLWORD INTEGER                     15920000
A00030   EQU   A00029+00000004     1 BYTE(S)                            15930000
A00031   EQU   00000000            86 BYTE(S) ON WORD                   15940000
A00032   EQU   A00031+00000000     19*FULLWORD POINTER                  15950000
SECID    EQU   A00031+00000076     8 BYTE(S)                            15960000
RTMSK    EQU   A00031+00000084     2 BYTE(S)                            15970000
A00033   EQU   00000000            60 BYTE(S) ON WORD                   15980000
A00034   EQU   A00033+00000000     13 BYTE(S)                           15990000
WTO12    EQU   A00033+00000013     2 BYTE(S)                            16000000
WTO1     EQU   A00033+00000013     1 BYTE(S)                            16010000
A00035   EQU   A00033+00000015     1 BYTE(S)                            16020000
MSGTEST  EQU   A00033+00000016     8 BYTE(S)                            16030000
A00036   EQU   A00033+00000016     7 BYTE(S)                            16040000
OLDTEST  EQU   A00033+00000023     1 BYTE(S)                            16050000
BLKUNIT  EQU   A00033+00000024     26 BYTE(S)                           16060000
A00037   EQU   A00033+00000024     1 BYTE(S)                            16070000
MSGUNIT  EQU   A00033+00000025     22 BYTE(S)                           16080000
KUNIT    EQU   A00033+00000025     4 BYTE(S)                            16090000
A00038   EQU   A00033+00000029     1 BYTE(S)                            16100000
MSGDEV   EQU   A00033+00000030     8 BYTE(S)                            16110000
A00039   EQU   A00033+00000038     1 BYTE(S)                            16120000
MSGSYB   EQU   A00033+00000039     8 BYTE(S)                            16130000
A00040   EQU   A00033+00000047     3 BYTE(S)                            16140000
MSGVR    EQU   A00033+00000050     1 BYTE(S)                            16150000
MPCPUID  EQU   A00033+00000051     9 BYTE(S)                            16160000
A00041   EQU   A00033+00000051     7 BYTE(S)                            16170000
MSGCPUID EQU   A00033+00000058     2 BYTE(S)                            16180000
A00042   EQU   A00033+00000050     1 BYTE(S)                            16190000
TMWK     EQU   00000000            60 BYTE(S) ON WORD                   16200000
A00045   EQU   TMWK+00000000       36 BYTE(S)                           16210000
KNT      EQU   TMWK+00000036       8 BYTE(S)                            16220000
KNAME    EQU   TMWK+00000036       6 BYTE(S)                            16230000
MODNN    EQU   TMWK+00000044       8 BYTE(S)                            16240000
MODNN6   EQU   TMWK+00000044       6 BYTE(S)                            16250000
A00046   EQU   TMWK+00000052       4 BYTE(S)                            16260000
GTCOR    EQU   TMWK+00000056       FULLWORD POINTER                     16270000
A00047   EQU   00000000            56 BYTE(S) ON WORD                   16280000
A00048   EQU   A00047+00000000     56 BYTE(S)                           16290000
DVEBC    EQU   A00047+00000000     8 BYTE(S)                            16300000
DVUCB    EQU   A00047+00000008     4  BYTE  POINTER                     16310000
A00049   EQU   A00047+00000012     8 BIT(S)                             16320000
A00050   EQU   A00047+00000012     1 BIT(S)                             16330000
PRIMBIT  EQU   A00047+00000012     1 BIT(S)                             16340000
A00051   EQU   A00047+00000012     1 BIT(S)                             16350000
EXIOACT  EQU   A00047+00000012     1 BIT(S)                             16360000
A00052   EQU   A00047+00000012     1 BIT(S)                             16370000
GRABIT   EQU   A00047+00000012     1 BIT(S)                             16380000
A00053   EQU   A00047+00000012     1 BIT(S)                             16390000
SYMBSSID EQU   A00047+00000012     1 BIT(S)                             16400000
A00054   EQU   A00047+00000013     19 BYTE(S)                           16410000
A00055   EQU   A00047+00000013     8 BIT(S)                             16420000
A00056   EQU   A00047+00000013     1 BIT(S)                             16430000
LETGOB   EQU   A00047+00000013     1 BIT(S)                             16440000
CEVOL    EQU   A00047+00000013     1 BIT(S)                             16450000
DVTABCDS EQU   A00047+00000032     20 BYTE(S)                           16460000
DVADR    EQU   A00047+00000032     4 BYTE(S)                            16470000
DVCDS    EQU   A00047+00000036     4 BYTE(S)                            16480000
A00057   EQU   A00047+00000040     1 BYTE(S)                            16490000
CDSFLAG  EQU   A00047+00000041     1 BYTE(S)                            16500000
A00058   EQU   A00047+00000041     4 BIT(S)                             16510000
SYMBIT   EQU   A00047+00000041     1 BIT(S)                             16520000
A00059   EQU   A00047+00000042     8 BIT(S)                             16530000
A00060   EQU   A00047+00000042     1 BIT(S)                             16540000
SKIPRIM  EQU   A00047+00000042     1 BIT(S)                             16550000
A00061   EQU   A00047+00000043     1 BYTE(S)                            16560000
SYMNAME  EQU   A00047+00000044     8 BYTE(S)                            16570000
A00062   EQU   00000000            20 BYTE(S) ON WORD                   16580000
A00063   EQU   A00062+00000000     4*FULLWORD INTEGER                   16590000
DVUDD    EQU   A00062+00000016     4 BYTE(S)                            16600000
PARM12   EQU   @DATA+00000080      12 BYTE(S) ON WORD                   16610000
BNAME    EQU   PARM12+00000000     8 BYTE(S)                            16620000
BNAMCM   EQU   PARM12+00000000     5 BYTE(S)                            16630000
BNAMVR   EQU   PARM12+00000005     3 BYTE(S)                            16640000
TARGADR  EQU   PARM12+00000008     FULLWORD INTEGER                     16650000
         ORG   PARM12+00000012                                          16660000
A00064   EQU   *                   FULLWORD INTEGER                     16670000
         DC    FL4'0'                                                   16680000
FUNC12   EQU   PARM12+00000012     1 BYTE(S)                            16690000
A00065   EQU   PARM12+00000012     1 BIT(S)                             16700000
COMPUTB  EQU   PARM12+00000012     1 BIT(S)                             16710000
A00066   EQU   PARM12+00000012     1 BIT(S)                             16720000
UTSENVL  EQU   PARM12+00000012     1 BIT(S)                             16730000
A00067   EQU   PARM12+00000013     1 BYTE(S)                            16740000
LDLIST   EQU   @DATA+00000096      8 BYTE(S) ON WORD                    16750000
A00068   EQU   *                   HALFWORD INTEGER                     16760000
         DC    FL2'2'                                                   16770000
A00069   EQU   *                   2 BYTE(S)                            16780000
         DC    C'12'                                                    16790000
A00070   EQU   *                   FULLWORD POINTER                     16800000
         DC    AL4(PARM12)                                              16810000
UTSPL    EQU   @DATA+00000080      8 BYTE(S) ON WORD                    16820000
PLNAM    EQU   UTSPL+00000000      8 BYTE(S)                            16830000
A00071   EQU   UTSPL+00000000      1 BYTE(S)                            16840000
PLNM15   EQU   UTSPL+00000000      5 BYTE(S)                            16850000
PLNM68   EQU   UTSPL+00000005      3 BYTE(S)                            16860000
PLSNM    EQU   UTSPL+00000001      6 BYTE(S)                            16870000
PLTYPE   EQU   UTSPL+00000001      4 BYTE(S)                            16880000
PLNAM6   EQU   UTSPL+00000005      2 BYTE(S)                            16890000
A00072   EQU   UTSPL+00000007      1 BYTE(S)                            16900000
A00076   EQU   00000000            8 BYTE(S) ON WORD                    16910000
SNAM1    EQU   A00076+00000000     3 BYTE(S)                            16920000
SLNG1    EQU   A00076+00000003     2 BYTE(S)                            16930000
A00077   EQU   A00076+00000003     1 BYTE(S)                            16940000
A00078   EQU   A00076+00000004     8 BIT(S)                             16950000
A00079   EQU   A00076+00000004     5 BIT(S)                             16960000
DBLBIT   EQU   A00076+00000004     2 BIT(S)                             16970000
OLDUT    EQU   A00076+00000004     1 BIT(S)                             16980000
SNAM2    EQU   A00076+00000005     3 BYTE(S)                            16990000
BNAMCMSV EQU   @DATA+00000104      5 BYTE(S)                            17000000
A00128   EQU   @DATA+00000109      4 BYTE(S)                            17010000
         ORG   A00128+00000000                                          17020000
MSGSTR   EQU   *                   2 BYTE(S)                            17030000
         DC    C' S'                                                    17040000
MSGEND   EQU   *                   2 BYTE(S)                            17050000
         DC    C' T'                                                    17060000
UTS201   EQU   00000043            8 BYTE(S)                            17070000
MSG231   EQU   00000000            43 BYTE(S) ON WORD                   17080000
A00129   EQU   MSG231+00000000     12 BYTE(S)                           17090000
WMSGTEST EQU   MSG231+00000012     8 BYTE(S)                            17100000
A00130   EQU   MSG231+00000020     15 BYTE(S)                           17110000
WMSGDEV  EQU   MSG231+00000035     8 BYTE(S)                            17120000
RTMASK   EQU   00000070            1 BYTE(S)                            17130000
MSGUTS   EQU   00000012            8 BYTE(S)                            17140000
A00131   EQU   00000000            28 BYTE(S) ON WORD                   17150000
A00132   EQU   A00131+00000000     20 BYTE(S)                           17160000
WTO4NM   EQU   A00131+00000020     8 BYTE(S)                            17170000
MSG200   EQU   00000000            25 BYTE(S) ON WORD                   17180000
A00133   EQU   MSG200+00000000     17 BYTE(S)                           17190000
NM200    EQU   MSG200+00000017     8 BYTE(S)                            17200000
DEVTBENT EQU   00000000            12 BYTE(S)                           17210000
DEVPTR   EQU   DEVTBENT+00000000   4  BYTE  POINTER                     17220000
IOSBPTR  EQU   DEVTBENT+00000004   4  BYTE  POINTER                     17230000
A00134   EQU   DEVTBENT+00000008   4 BYTE(S)                            17240000
IOSB     EQU   00000000            116 BYTE(S) ON WORD                  17250000
A00135   EQU   IOSB+00000000       112 BYTE(S)                          17260000
PTRTECB  EQU   IOSB+00000112       FULLWORD POINTER                     17270000
INDEX    EQU   @DATA+00000114      HALFWORD INTEGER                     17280000
DIOPARM  EQU   @DATA+00000116      13 BYTE(S) ON WORD                   17290000
         ORG   DIOPARM+00000000                                         17300000
A00136   EQU   *                   HALFWORD INTEGER                     17310000
         DC    FL2'2'                                                   17320000
A00137   EQU   *                   2 BYTE(S)                            17330000
         DC    C'44'                                                    17340000
DIOCDSAD EQU   DIOPARM+00000004    FULLWORD POINTER                     17350000
DIOTECB  EQU   DIOPARM+00000008    FULLWORD POINTER                     17360000
         ORG   DIOPARM+00000012                                         17370000
A00138   EQU   *                   1 BYTE(S)                            17380000
         DC    X'01'                                                    17390000
A00139   EQU   DIOPARM+00000012    1 BYTE(S)                            17400000
ACTSECT  EQU   @DATA+00000129      8 BYTE(S)                            17410000
SPCOUNT  EQU   00000018            2 BYTE(S)                            17420000
OLTADDR  EQU   @DATA+00000140      FULLWORD INTEGER                     17430000
         ORG   @DATA                                                    17440000
         DS    00000148C                                                17450000
@TEMPS   DS    0F                                                       17460000
@TEMP4   DC    F'0'                                                     17470000
DSECT48  IFDCOM                                                         17480000
IFDOLT48 CSECT                                                          17490000
CE46     EQU   CESWT4+00000000     3 BYTE(S)                            17500000
A00000   EQU   PARTITEM+00000000   12 BYTE(S) ON WORD                   17510000
PARADR   EQU   A00000+00000000     FULLWORD POINTER                     17520000
PARSZ    EQU   A00000+00000004     FULLWORD INTEGER                     17530000
RTPLKSZ  EQU   A00000+00000008     FULLWORD INTEGER                     17540000
DBLZ     EQU   A00000+00000008     2 BYTE(S)                            17550000
UTSIZ    EQU   A00000+00000010     2 BYTE(S)                            17560000
A00001   EQU   A00000+00000010     1 BYTE(S)                            17570000
A00002   EQU   A00000+00000011     8 BIT(S)                             17580000
A00003   EQU   A00000+00000011     5 BIT(S)                             17590000
TRPBITS  EQU   A00000+00000011     3 BIT(S)                             17600000
A00004   EQU   A00000+00000011     2 BIT(S)                             17610000
CLRBIT   EQU   A00000+00000011     1 BIT(S)                             17620000
A00005   EQU   A00000+00000011     1 BIT(S)                             17630000
A00006   EQU   HRTSEL+00000000     2 BYTE(S) ON WORD                    17640000
TERTN    EQU   A00006+00000000     1 BYTE(S)                            17650000
HIRTN    EQU   A00006+00000001     1 BYTE(S)                            17660000
VID      EQU   WKSVC+00000002      2 BYTE(S)                            17670000
MID1     EQU   MCT+00000010        2 BYTE(S)                            17680000
TLRUN    EQU   TLCOUNT+00000006    HALFWORD INTEGER                     17690000
INBF1    EQU   INBUFR+00000000     1 BYTE(S)                            17700000
A00023   EQU   OLTTAB+00000000     40 BYTE(S) ON WORD                   17710000
A00024   EQU   A00023+00000000     8*FULLWORD POINTER                   17720000
TMCOMAD  EQU   A00023+00000032     FULLWORD POINTER                     17730000
SECPRF   EQU   A00023+00000036     FULLWORD POINTER                     17740000
A00025   EQU   A00023+00000036     FULLWORD POINTER                     17750000
A00043   EQU   PLKMOR+00000000     16 BYTE(S) ON WORD                   17760000
ZIP16    EQU   A00043+00000000     16 BYTE(S)                           17770000
A00044   EQU   A00043+00000000     8 BYTE(S)                            17780000
ZIP8     EQU   A00043+00000008     8 BYTE(S)                            17790000
DCNT1    EQU   UNITUSE+00000000    1 BYTE(S)                            17800000
DCNT2    EQU   UNICTR+00000000     1 BYTE(S)                            17810000
SCNT1    EQU   SECTUSE+00000000    1 BYTE(S)                            17820000
A00073   EQU   SECLST+00000000     12 BYTE(S) ON WORD                   17830000
A00074   EQU   A00073+00000000     1 BYTE(S)                            17840000
SCNT2    EQU   A00073+00000001     1 BYTE(S)                            17850000
SNAM     EQU   A00073+00000002     5 BYTE(S)                            17860000
A00075   EQU   A00073+00000002     1 BYTE(S)                            17870000
STYPEN   EQU   A00073+00000003     4 BYTE(S)                            17880000
SNAMST   EQU   A00073+00000007     5 BYTE(S)                            17890000
A00080   EQU   CHASCT+00000000     38 BYTE(S) ON WORD                   17900000
A00081   EQU   A00080+00000000     8 BYTE(S)                            17910000
ERRLPCT  EQU   A00080+00000000     2 BYTE(S)                            17920000
A00082   EQU   A00080+00000002     8 BIT(S)                             17930000
A00083   EQU   A00080+00000002     5 BIT(S)                             17940000
NPR      EQU   A00080+00000002     1 BIT(S)                             17950000
INDEFLP  EQU   A00080+00000002     1 BIT(S)                             17960000
FECOM    EQU   A00080+00000002     1 BIT(S)                             17970000
A00084   EQU   A00080+00000003     8 BIT(S)                             17980000
SCTASTER EQU   A00080+00000003     2 BIT(S)                             17990000
SCTERB   EQU   A00080+00000003     1 BIT(S)                             18000000
ASTERB   EQU   A00080+00000003     1 BIT(S)                             18010000
CATB1    EQU   A00080+00000003     1 BIT(S)                             18020000
AP       EQU   A00080+00000003     1 BIT(S)                             18030000
NCP      EQU   A00080+00000003     1 BIT(S)                             18040000
NEP      EQU   A00080+00000003     1 BIT(S)                             18050000
ERLOP    EQU   A00080+00000003     1 BIT(S)                             18060000
TSLOP    EQU   A00080+00000003     1 BIT(S)                             18070000
A00085   EQU   A00080+00000004     3 BYTE(S)                            18080000
SCTLEV   EQU   A00080+00000007     1 BYTE(S)                            18090000
DVSEC1   EQU   A00080+00000008     2 BYTE(S)                            18100000
PDFLG    EQU   A00080+00000010     2 BYTE(S)                            18110000
A00086   EQU   A00080+00000010     8 BIT(S)                             18120000
A00087   EQU   A00080+00000011     8 BIT(S)                             18130000
A00088   EQU   A00080+00000011     2 BIT(S)                             18140000
CEVOLUM  EQU   A00080+00000011     1 BIT(S)                             18150000
PDPAD1   EQU   A00080+00000012     8 BYTE(S)                            18160000
PDPA1    EQU   A00080+00000012     4 BYTE(S)                            18170000
PDDD1    EQU   A00080+00000016     4 BYTE(S)                            18180000
A00089   EQU   A00080+00000016     2 BYTE(S)                            18190000
DCLAS    EQU   A00080+00000018     1 BYTE(S)                            18200000
DVSEC2   EQU   A00080+00000020     2 BYTE(S)                            18210000
A00090   EQU   A00080+00000022     2 BYTE(S)                            18220000
PDPAD2   EQU   A00080+00000024     8 BYTE(S)                            18230000
PDPA2    EQU   A00080+00000024     4 BYTE(S)                            18240000
PDDD2    EQU   A00080+00000028     4 BYTE(S)                            18250000
A00091   EQU   A00080+00000032     1 BYTE(S)                            18260000
A00092   EQU   A00080+00000033     8 BIT(S)                             18270000
A00093   EQU   A00080+00000033     3 BIT(S)                             18280000
ERRCNT   EQU   A00080+00000033     1 BIT(S)                             18290000
ONEPRIM  EQU   A00080+00000033     1 BIT(S)                             18300000
CLEANUP  EQU   A00080+00000033     1 BIT(S)                             18310000
A00094   EQU   A00080+00000034     2 BYTE(S)                            18320000
A00095   EQU   A00080+00000036     8 BIT(S)                             18330000
A00096   EQU   A00080+00000036     1 BIT(S)                             18340000
CLEANRT  EQU   A00080+00000036     1 BIT(S)                             18350000
A00097   EQU   A00080+00000036     4 BIT(S)                             18360000
LASTSEC  EQU   A00080+00000036     1 BIT(S)                             18370000
DYCOM    EQU   A00080+00000036     1 BIT(S)                             18380000
A00098   EQU   A00080+00000037     8 BIT(S)                             18390000
TALKFLAG EQU   A00080+00000037     1 BIT(S)                             18400000
A00099   EQU   A00080+00000037     1 BYTE(S)                            18410000
CDS8TO19 EQU   CHASCT+00000020     12 BYTE(S)                           18420000
A00100   EQU   CHASCT+00000004     66 BYTE(S) ON WORD                   18430000
SCTWD17  EQU   A00100+00000000     28 BYTE(S)                           18440000
RTNM1ST  EQU   A00100+00000000     2 BYTE(S)                            18450000
A00101   EQU   A00100+00000028     1 BYTE(S)                            18460000
A00102   EQU   A00100+00000029     8 BIT(S)                             18470000
A00103   EQU   A00100+00000029     2 BIT(S)                             18480000
CSELRTN  EQU   A00100+00000029     1 BIT(S)                             18490000
A00104   EQU   A00100+00000030     6 BYTE(S)                            18500000
RTNMLST  EQU   A00100+00000036     30 BYTE(S)                           18510000
A00105   EQU   CESWT+00000000      9 BYTE(S) ON WORD                    18520000
A00106   EQU   A00105+00000000     8 BIT(S)                             18530000
A00107   EQU   A00105+00000000     2 BIT(S)                             18540000
OORN     EQU   A00105+00000000     2 BIT(S)                             18550000
OUTS     EQU   A00105+00000000     1 BIT(S)                             18560000
NUTS     EQU   A00105+00000000     1 BIT(S)                             18570000
A00108   EQU   A00105+00000001     8 BIT(S)                             18580000
A00109   EQU   A00105+00000001     1 BIT(S)                             18590000
SEEK2321 EQU   A00105+00000001     1 BIT(S)                             18600000
T2321T   EQU   A00105+00000001     1 BIT(S)                             18610000
A00110   EQU   A00105+00000001     2 BIT(S)                             18620000
T2321    EQU   A00105+00000001     1 BIT(S)                             18630000
A00111   EQU   A00105+00000001     1 BIT(S)                             18640000
TPFLAG   EQU   A00105+00000001     1 BIT(S)                             18650000
A00112   EQU   A00105+00000002     8 BIT(S)                             18660000
NDCFO    EQU   A00105+00000002     1 BIT(S)                             18670000
DPONDEV  EQU   A00105+00000002     1 BIT(S)                             18680000
A00113   EQU   A00105+00000002     3 BIT(S)                             18690000
NDR      EQU   A00105+00000002     1 BIT(S)                             18700000
TAPEHDR  EQU   A00105+00000002     1 BIT(S)                             18710000
A00114   EQU   A00105+00000003     8 BIT(S)                             18720000
OSTWTOR  EQU   A00105+00000003     1 BIT(S)                             18730000
BYPDEV   EQU   A00105+00000003     2 BIT(S)                             18740000
NURUN    EQU   A00105+00000003     1 BIT(S)                             18750000
NUDEV    EQU   A00105+00000003     1 BIT(S)                             18760000
A00115   EQU   A00105+00000003     2 BIT(S)                             18770000
TP1419   EQU   A00105+00000003     1 BIT(S)                             18780000
CE45     EQU   A00105+00000004     2 BYTE(S)                            18790000
CE4      EQU   A00105+00000004     8 BIT(S)                             18800000
CE5      EQU   A00105+00000005     8 BIT(S)                             18810000
A00116   EQU   A00105+00000005     2 BIT(S)                             18820000
FEITEMS  EQU   A00105+00000005     4 BIT(S)                             18830000
FFEFCE   EQU   A00105+00000005     2 BIT(S)                             18840000
CE6      EQU   A00105+00000006     8 BIT(S)                             18850000
UTSCAL   EQU   A00105+00000006     1 BIT(S)                             18860000
A00117   EQU   A00105+00000006     1 BIT(S)                             18870000
EOJLOG   EQU   A00105+00000006     1 BIT(S)                             18880000
PFPMSG   EQU   A00105+00000006     1 BIT(S)                             18890000
CODE5    EQU   A00105+00000006     1 BIT(S)                             18900000
NORUN    EQU   A00105+00000006     1 BIT(S)                             18910000
SECRUN   EQU   A00105+00000006     1 BIT(S)                             18920000
RTSTAE   EQU   A00105+00000006     1 BIT(S)                             18930000
A00118   EQU   A00105+00000007     8 BIT(S)                             18940000
A00119   EQU   A00105+00000007     2 BIT(S)                             18950000
REMOTE   EQU   A00105+00000007     1 BIT(S)                             18960000
A00120   EQU   A00105+00000007     3 BIT(S)                             18970000
VIRTUAL  EQU   A00105+00000007     1 BIT(S)                             18980000
CE8      EQU   A00105+00000008     8 BIT(S)                             18990000
A00121   EQU   A00105+00000008     3 BIT(S)                             19000000
READDCHK EQU   A00105+00000008     1 BIT(S)                             19010000
OLTINVV  EQU   A00105+00000008     1 BIT(S)                             19020000
SUTMSG   EQU   A00105+00000008     1 BIT(S)                             19030000
SNEWRUN  EQU   A00105+00000008     1 BIT(S)                             19040000
A00122   EQU   A00105+00000008     1 BIT(S)                             19050000
A00123   EQU   CESWTR+00000000     1 BYTE(S)                            19060000
RETAINAC EQU   A00123+00000000     1 BIT(S)                             19070000
REMERR   EQU   A00123+00000000     1 BIT(S)                             19080000
REMNOMSG EQU   A00123+00000000     1 BIT(S)                             19090000
CENOMSG  EQU   A00123+00000000     1 BIT(S)                             19100000
PRTNOMSG EQU   A00123+00000000     1 BIT(S)                             19110000
IMRESP   EQU   A00123+00000000     1 BIT(S)                             19120000
EXECOUT  EQU   A00123+00000000     1 BIT(S)                             19130000
CECOMOUT EQU   A00123+00000000     1 BIT(S)                             19140000
A00124   EQU   CESWTR1+00000000    1 BYTE(S)                            19150000
A00125   EQU   A00124+00000000     2 BIT(S)                             19160000
CECOMANS EQU   A00124+00000000     1 BIT(S)                             19170000
A00126   EQU   A00124+00000000     2 BIT(S)                             19180000
REMANS   EQU   A00124+00000000     1 BIT(S)                             19190000
A00127   EQU   A00124+00000000     2 BIT(S)                             19200000
A00140   EQU   CESWT9+00000000     1 BYTE(S)                            19210000
A00141   EQU   A00140+00000000     2 BIT(S)                             19220000
VRCAP    EQU   A00140+00000000     1 BIT(S)                             19230000
A00142   EQU   A00140+00000000     4 BIT(S)                             19240000
OLTTERM  EQU   A00140+00000000     1 BIT(S)                             19250000
A00143   EQU   CESWT10+00000000    1 BYTE(S)                            19260000
MPSYS    EQU   A00143+00000000     1 BIT(S)                             19270000
@DATEND  EQU   *                                                        19280000
@9F5     EQU   SCH006                                                   19290000
SCH024A  EQU   @EL01                                                    19300000
@9BA     EQU   @EL01                                                    19310000
@9B9     EQU   @EL01                                                    19320000
@9BB     EQU   SCH005                                                   19330000
@DO9F8   EQU   SCH024A                                                  19340000
         END    ,(C'PL/S',1400,76153)                                   19350000
