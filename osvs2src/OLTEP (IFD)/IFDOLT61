         TITLE 'IFDOLT61 DEVICE DECODE 2'                               00010000
         LCLA  &T,&SPN                                            0001  00020000
.@001    ANOP                                                     0001  00030000
IFDOLT61 CSECT ,                                                  0001  00040000
         BC    15,24(0,@F)                                              00050000
         DC    C'IFDOLT61 14 FEB 78'                             0001  00060000
         STM   @E,@C,12(@D)                                       0001  00070000
         BALR  @B,0                                               0001  00080000
@PSTART  DS    0H                                                 0001  00090000
         USING @PSTART+00000,@B                                   0001  00100000
         ST    @D,@SAV001+4                                       0001  00110000
         LA    @F,@SAV001                                         0001  00120000
         ST    @F,8(0,@D)                                         0001  00130000
         LR    @D,@F                                              0001  00140000
         TITLE 'IFDOLT61 DEVICE DECODE 2'                               00150000
         DS    0H                                                       00160000
*         GEN(USING CHASCT,2);     /* SECTION CONTROL TABLE.    S21052* 00170000
         USING CHASCT,2                                                 00180000
         DS    0H                                                       00190000
*         GENERATE DATA;           /* COMMON AREA DSECT.        S21052* 00200000
*         /************************************************************ 00210000
*         /*                        REGISTERS                   S21052* 00220000
*         /************************************************************ 00230000
*                                                                       00240000
*         DCL R0 REG(0) PTR(31);   /* REGISTER 0 NAME           S21052* 00250000
*         DCL R1 REG(1) PTR(24);   /* REGISTER 1 NAME           S21052* 00260000
*         DCL R2 REG(2) PTR(31);   /* REGISTER 2 NAME           S21052* 00270000
*         DCL R3 REG(3) PTR(31);   /* REGISTER 3 NAME           S21052* 00280000
*         DCL R4 REG(4) PTR(31);   /* REGISTER 4 NAME           S21052* 00290000
*         DCL R5 REG(5) PTR(31);   /* REGISTER 5 NAME           S21052* 00300000
*         DCL GOODENT REG(6) PTR;  /* VALID DEV TAB COUNTER.    S21052* 00310000
*         DCL UCBLOOK REG(7) PTR;  /* LOOK UP UCB'S, IN SVC 59. S21052* 00320000
*         DCL DEVTABPT REG(8) PTR; /* PTR TO CURRENT DEV TAB LOC.       00330000
*                                                               S21052* 00340000
*         DCL R8 REG(8) PTR(31);                              /*X03008* 00350000
*         DCL R9 REG(9) PTR(24);   /* REGISTER 9 NAME           S21052* 00360000
*         DCL R13 REG(13) PTR(31); /* REGISTER 13 NAME          S21052* 00370000
*         DCL R14 REG(14) PTR(31); /* REGISTER 14 NAME          S21052* 00380000
*         DCL RC REG(15) PTR(31);  /* RETURN CODE REGISTER      S21052* 00390000
*         DCL R15 REG(15) PTR(31); /* REGISTER 15 NAME          S21052* 00400000
*         /************************************************************ 00410000
*         /*                       SAVE AREAS                   S21052* 00420000
*         /************************************************************ 00430000
*                                                                       00440000
*         DCL 1 MYSAVE BASED(R13), /*  MY SAVE AREA FORMAT      S21052* 00450000
*           3 * CHAR(4),                                                00460000
*           3 YOURR13 PTR(31);     /* CALLERS SAVE AREA ADDRESS S21052* 00470000
*                                                                       00480000
*                                                                       00490000
*         /*           CALLERS SAVE AREA FORMAT                 S21052* 00500000
*         DCL 1 YOURSAVE BASED(YOURR13),                                00510000
*           3 * CHAR(12),                                               00520000
*           3 YOURR14 PTR(31);     /* CALLERS RETURN POINT      S21052* 00530000
*         /************************************************************ 00540000
*         /*                  SECTION CONTROL TABLE             S21052* 00550000
*         /************************************************************ 00560000
*                                                                       00570000
*         DCL CHASCT CHAR(88) GEND;                                     00580000
*                                                                       00590000
*                                                                       00600000
*         /*          FORMAT OF SCT                             S21052* 00610000
*         DCL 1 SCT BASED(ADDR(CHASCT)),                                00620000
*           3 HEADER CHAR(8),      /* HEADER, NOT REFERENCED HERE       00630000
*                                                               S21052* 00640000
*           3 PRIDVSCT CHAR(12),   /* PRIMARY DEVICE ENTRY .    S21052* 00650000
*             5 * CHAR(2),                                              00660000
*             5 PRIDVFLG CHAR(1),  /*PRIMARY DEVICE FLAGS.      S21052* 00670000
*             5 * CHAR(1),                                              00680000
*             5 PRIDVAD CHAR(4),   /* PRIMARY DEVICE ADDRESS.   S21052* 00690000
*               7 * CHAR(2),                                            00700000
*               7 PRIHEXAD CHAR(2),/* PRIM DEV ADDR IN HEX.     S21052* 00710000
*             5 PRIDVDSC CHAR(4),  /* PRIMARY DEVICE DESCRIPTORS.       00720000
*                                                               S21052* 00730000
*           3 SECDVSCT CHAR(12),   /* SECONDARY DEVICE ENTRY.   S21052* 00740000
*             5 * CHAR(2),                                              00750000
*             5 SECDVFLG CHAR(1),  /* SECONDARY DEVICE FLAGS.   S21052* 00760000
*             5 * CHAR(1),                                              00770000
*             5 SECDVAD CHAR(4),   /* SECONDARY DEVICE ADDRESS. S21052* 00780000
*               7 * CHAR(2),                                            00790000
*               7 SECHEXAD CHAR(2),/* SEC DEV ADDR IN HEX.      S21052* 00800000
*             5 SECDVDSC CHAR(4);  /* SEC DEV DESCRIPTORS.      S21052* 00810000
*         /************************************************************ 00820000
*         /*                       INPUT BUFFER                 S21052* 00830000
*         /************************************************************ 00840000
*                                                                       00850000
*                                                                       00860000
*         /*          OVERLAY OF INPUT BUFFER                   S21052* 00870000
*         DCL INBUFR CHAR(120) GEND;                                    00880000
*                                                                       00890000
*         /*          OVERLAY OF INPUT BUFFER                   S21052* 00900000
*         DCL INPUTBUF CHAR(10) BASED(R5);                              00910000
*                                                                       00920000
*         /*          POINTER TO INPUT BUFFER CHARACTER         S21052* 00930000
*         DCL INBUFPTR PTR(31) GEND;                                    00940000
*                                                                       00950000
*                                                                       00960000
*         /************************************************************ 00970000
*         /*                        SWITCHES                    S21052* 00980000
*         /************************************************************ 00990000
*                                                                       01000000
*         DCL CESWT CHAR(1) GENERATED;                                  01010000
*                                                                       01020000
*                                                                       01030000
*         /*          CE SWITCH FORMAT                          S21052* 01040000
*         DCL 1 OLTEPSW BASED(ADDR(CESWT)),                             01050000
*           3 * BIT(4),                                                 01060000
*           3 LEGALDEV BIT(1),     /* VALID DEVICE ENTRY MADE.  S21052* 01070000
*           3 REINT BIT(1);        /* REINITIALIZATION FLAG.    S21052* 01080000
*                                                                       01090000
*         DCL CESWT1 CHAR(1) GENERATED;                                 01100000
*                                                                       01110000
*                                                                       01120000
*         /*          CE SWITCH 1 FORMAT                        S21052* 01130000
*         DCL 1 OLTEPSW1 BASED(ADDR(CESWT1)),                           01140000
*           3 * BIT(6),                                                 01150000
*           3 ONLINETP BIT(2),     /* ONLINE OK AND TP FLAGS.   S21052* 01160000
*             5 ONLINEOK BIT(1),   /* TP CU ONLINE OK FLAG.     S21052* 01170000
*             5 TPFLAG BIT(1);     /* TP CU TEST FLAG.          S21052* 01180000
*                                                                       01190000
*         DCL CESWT2 CHAR(1) GENERATED;                                 01200000
*                                                                       01210000
*                                                                       01220000
*         /*          CE SWITCH 2 FORMAT                        S21052* 01230000
*         DCL 1 OLTEPSW2 BASED(ADDR(CESWT2)),                           01240000
*           3 * BIT(3),                                                 01250000
*           3 CHANTEST BIT(1),     /* CHANNEL TEST FLAG.        S21052* 01260000
*           3 * BIT(1),                                                 01270000
*           3 NDR BIT(1);          /* NO DEVICE REQUIRED FOR TEST       01280000
*                                                               S21052* 01290000
*                                                                       01300000
*         DCL CESWT7 CHAR(1) GEND;                                      01310000
*                                                                       01320000
*                                                                       01330000
*         /*          CE SWITCH 7 FORMAT                        S21052* 01340000
*         DCL 1 OLTEPSW7 BASED(ADDR(CESWT7)),                           01350000
*           3 INCLST BIT(1),       /* INCLUSIVE SERIES OF DEVICES       01360000
*                                                               S21052* 01370000
*           3 RETTO31 BIT(1);      /* RET TO IFDOLT31, MORE DECOD       01380000
*                                                               S21052* 01390000
*                                                                       01400000
*         DCL CESWTR CHAR(1) GEND;      /* RETAIN SWITCHES      S21052* 01410000
*                                                                       01420000
*                                                                       01430000
*         /*          RETAIN CESWITCH FORMAT                          * 01440000
*         DCL 1 * BASED(ADDR(CESWTR)),                                  01450000
*           3 RETAINAC BIT(1),          /* IS RETAIN ACTIVE?          * 01460000
*           3 * BIT(1),                                                 01470000
*           3 REMNOMSG BIT(1);          /* NO MSG FROM REMOTE         * 01480000
*         /************************************************************ 01490000
*         /*          RETAIN SWITCH FORMATS                           * 01500000
*         /************************************************************ 01510000
*                                                                       01520000
*         DCL CESWTR2 CHAR(1) GEND;     /* THIRD RETAIN FLAG          * 01530000
*                                                                       01540000
*         DCL 1 * BASED(ADDR(CESWTR2)), /* SWITCH STRUCTURE           * 01550000
*           3 * BIT(7),                                                 01560000
*           3 DPMSGREI BIT(1);          /* DATA PROT MSG TO REM XM0097* 01570000
*                                                                       01580000
*         /************************************************************ 01590000
*         /*                   SVC PARAMETER LIST               S21052* 01600000
*         /************************************************************ 01610000
*                                                                       01620000
*                                                                       01630000
*         DCL ROPT CHAR(8) GENERATED;                                   01640000
*                                                                       01650000
*                                                                       01660000
*         /*          PARAMETER LIST FORMAT                     S21052* 01670000
*         DCL 1 SVCPLIST BASED(ADDR(ROPT)-4),                           01680000
*           3 * CHAR(2),                                                01690000
*           3 MODNUM CHAR(2),      /* NAME OF CALLING MODULE.   S21052* 01700000
*           3 ADDRDEV PTR(31),     /* BEGIN ADDR FOR UCB LOOK-UP.       01710000
*                                                               S21052* 01720000
*           3 ENTRIES FIXED(31);   /* NUMBER OF LOOK-UPS TO DO. S21052* 01730000
*         DCL DEVTBPTR PTR GEND;   /* POINTER TO DEVICE TABLES. S21052* 01740000
*                                                                       01750000
*                                                                       01760000
*         /************************************************************ 01770000
*         /*                FORMAT OF DEVTABLE ENTRY            S21052* 01780000
*         /************************************************************ 01790000
*                                                                       01800000
*         /*          ANY DEVICE TABLE                          S21052* 01810000
*         DCL 1 DEVTABXX CHAR(56)  BASED(DEVTABPT),                     01820000
*           3 DEVADDR CHAR(8),     /* EBCDIC DEVICE ADDRESS.    S21052* 01830000
*           3 UCBADDR PTR(31),     /* UCB ADDRESS.              S21052* 01840000
*           3 FLG1 CHAR(1),        /* FIRST DEV TAB FLAG FIELD. S21052* 01850000
*             5 ONOFF BIT(1),      /* DEV ON/OFF LINE STATUS FLAG       01860000
*                                                               S21052* 01870000
*             5 PRIMARY BIT(1),    /* PRIMARY DEVICE FLAG.      S21052* 01880000
*           3 * CHAR(1),           /* SECOND FLAG FIELD.        S21052* 01890000
*           3 FLG3 CHAR(1),        /* THIRD FLAG FIELD.         S21052* 01900000
*             5 ANRNOTST BIT(1),   /* ANR DEVICE NOT TESTABLE.  S21052* 01910000
*             5 * BIT(3),                                               01920000
*             5 NOTEST BIT(1),     /* DEV NOT TESTABLE         XA00530* 01930000
*             5 SYSALLOC BIT(1),   /* DEV ALLOCATED IN SYS     XA00530* 01940000
*           3 * CHAR(1),           /* FOURTH FLAG FIELD.        S21052* 01950000
*           3 * CHAR(16),          /* TAPE LABEL, EXTENTS,MODE SAVE.    01960000
*                                                               S21052* 01970000
*           3 HEXADDR CHAR(4),     /* DEVICE ADDR IN HEX.       S21052* 01980000
*           3 CDSDVDSC CHAR(4),    /* CDS DEVICE DSCRPTRS.      S21052* 01990000
*             5 MODEL CHAR(1),     /* MODEL OF DEVICE.          S21052* 02000000
*             5 FEATURES CHAR(1),  /* DEVICE FEATURES.          S21052* 02010000
*             5 CLASS CHAR(1),     /* CLASS OF DEVICE.          S21052* 02020000
*             5 TYPE CHAR(1),      /* DEVICE TYPE.              S21052* 02030000
*           3 BYTECNT CHAR(1),     /* CDS BYTE COUNT.           S21052* 02040000
*           3 CDSFLAGS CHAR(1),    /* CDS FLAG BYTE.            S21052* 02050000
*             5 * BIT(4),                                               02060000
*             5 SYMDEVIC BIT(1),   /* DEV HAS SYMBOLIC NAME.    S21052* 02070000
*             5 * BIT(2),                                               02080000
*             5 REMLINE BIT(1),    /* REMOTE LINE TO ENABLE.    S21052* 02090000
*           3 EXTSGMSK CHAR(2),    /* EXTERNAL SIGNAL MASK.     S21052* 02100000
*           3 SYMNAME CHAR(8);     /* SYMBOLIC NAME OF DEVICE.  S21052* 02110000
*         /************************************************************ 02120000
*         /*                        MESSAGES                    S21052* 02130000
*         /************************************************************ 02140000
*                                                                       02150000
*                                                                       02160000
*         DCL IFDMSG61 LABEL NONLOCAL EXTERNAL;                         02170000
*                                                                       02180000
*                                                                       02190000
*         /*          POINTERS TO MESSAGES                      S21052* 02200000
*         DCL 1 MSGPTR BASED(R4),                                       02210000
*           3 MSGPTR09 PTR(31),    /* MESSAGE IFD109I.          S21052* 02220000
*           3 MSGPTR10 PTR(31),    /* MESSAGE IFD110I.          S21052* 02230000
*           3 MSGPTR11 PTR(31),    /* MESSAGE IFD111I.          S21052* 02240000
*           3 MSGPTR14 PTR(31),    /* MESSAGE IFD114I.          S21052* 02250000
*           3 MSGPTR27 PTR(31),                                         02260000
*           3 MSGPTR54 PTR(31);         /* MESSAGE IFD154I.     X02906* 02270000
*                                                                       02280000
*                                                                       02290000
*         /*          MESSAGE IFD109I FORMAT                    S21052* 02300000
*         DCL 1 MSG109 BASED(R1),                                       02310000
*           3 * CHAR(12),                                               02320000
*           3 MSG109I CHAR(28);   /* MSG IFD109I TEST                 * 02330000
*                                                                       02340000
*                                                                       02350000
*         DCL 1 MSG154 BASED(R1),       /* MESSAGE IFDOLT  154  X02906* 02360000
*           3 * CHAR(12),               /* FLAGS FOR ROUTING    X02906* 02370000
*           3 MSG154I CHAR(60);         /* MESSAGE TEXT.        X02906* 02380000
*                                                                       02390000
*         DCL 1 MSG127 BASED(R1),                                       02400000
*           3 * CHAR(12),                                               02410000
*           3 MSG127I CHAR(19);                                         02420000
*         /************************************************************ 02430000
*         /*            OTHER COMMON AREA CONSTANTS USED        S21052* 02440000
*         /************************************************************ 02450000
*                                                                       02460000
*         DCL UNICTR CHAR(1) GEND; /* GOOD DEV ENTRY COUNTER.   S21052* 02470000
*                                                                       02480000
*         DCL TPSAVE CHAR(4) GEND; /* TEST TYPE SAVE AREA.      S21052* 02490000
*                                                                       02500000
*                                                                       02510000
*         /*          TEST TYPE SAVE AREA STRUCTURE             S21052* 02520000
*         DCL 1 TPSAV CHAR(4) BASED(ADDR(TPSAVE)),                      02530000
*           3 * CHAR(3),                                                02540000
*           3 TPSAVE3 CHAR(1);     /* TP CU 2701,2,3 TEST TYPE. S21052* 02550000
*                                                                       02560000
*         /* POINTER TO ACTIVE SECTION ENTRY IN SECTION CONTROL TABLE   02570000
*                                                               S21052* 02580000
*         DCL DEVDEPAD PTR(31) GEND;                                    02590000
*                                                                       02600000
*         /* ENTRY IN IFDOLT30 TO REDEFINE TEST DEFINITION      S21052* 02610000
*         DCL REDEFINE PTR(31) GEND;                                    02620000
*                                                                       02630000
*         /* PTR TO PRIMARY DEV TABLE.  IN SCT.                 S21052* 02640000
*         DCL PRIDVPTR PTR(31) GEND;                                    02650000
*                                                                       02660000
*         /* PTR TO LAST GRABBED DEVICE TABLE. IN SCT.          S21052* 02670000
*         DCL SECDVPTR PTR(31) GEND;                                    02680000
*                                                                       02690000
*         /* LENGTH OF EACH DEVICE TABLE ENTRY                  S21052* 02700000
*         DCL TABLNGTH FIXED(15) GEND;                                  02710000
*                                                                       02720000
*         DCL PSCT PTR(31) GEND;   /* POINTER TO SCT.           S21052* 02730000
*         DCL UNITUSE CHAR(1) GEND;/* NUMBER OF DEVS TESTED CNTR.       02740000
*                                                               S21052* 02750000
*                                                                       02760000
*         /*          DEVICE TABLE AREA IN COMMON AREA          S21052* 02770000
*         DCL 1 * BASED(R8),       /* DEVICE TABLE              X03008* 02780000
*               3 DVT CHAR(16),    /* TABLE AREA                X03008* 02790000
*               3 DVTN CHAR(16);   /* NEXT TABLE AREA           X03008* 02800000
*         DCL TUCBAD1 PTR(31) GEND;/* PTR TO PRIM DEV UCB.      S21052* 02810000
*         DCL TUCBAD2 PTR(31) GEND;/* PTR TO SECONDARY DEV UCB. S21052* 02820000
*                                                                       02830000
*                                                                       02840000
*                                                                       02850000
*         /*          EXECUTIVE PROGRAM FLAGS IN SCT            S21052* 02860000
*         DCL 1 EXPGMFLG CHAR(1) BASED(ADDR(CHASCT)+33),                02870000
*           3 * BIT(1),                                                 02880000
*           3 MORETHN1 BIT(1);     /* MORE THAN ONE DEV ENTERED S21052* 02890000
*                                                                       02900000
*         DCL NEXTREC PTR(31) GEND;/* READ NEXT REC IN IFDOLT31 S21052* 02910000
*         DCL TAB28 PTR(31) GEND;  /* NEW MACRO ENTRY POINT.    S21052* 02920000
*         /************************************************************ 02930000
*         /*                   INTERNAL CONSTANTS               S21052* 02940000
*         /************************************************************ 02950000
*                                                                       02960000
*         DCL CECDEV04 LABEL;                                           02970000
*                                                                       02980000
*                                                                       02990000
*         /*          SAVE INCLUSIVE ENTRIES                    S21052* 03000000
*         DCL 1 SAVENT PTR(31) GEND,                                    03010000
*           3 FRSTINCL FIXED(15),  /* FIRST INCLUSIVE SERIES DEV.       03020000
*                                                               S21052* 03030000
*           3 LASTINCL FIXED(15);  /* LAST INCLUSIVE SERIES DEV.S21052* 03040000
*                                                                       03050000
*         DCL AVAILBLE PTR(31);    /* NEXT AVAILABLE DEVICE TABLE       03060000
*                                                               S21052* 03070000
*                                                                       03080000
*         /*          SAVE COUNTER FOR NUMBER OF VALID DEV TABS BUILT   03090000
*                                                               S21052* 03100000
*         DCL SAVECNT FIXED(15) GEND;                                   03110000
*                                                                       03120000
*         /*          DEVICE TABLE OVERLAY                      S21052* 03130000
*         DCL DEVTABLE CHAR(56) BASED(AVAILBLE);                        03140000
*         DCL LIMIT FIXED(15);     /* MAX NUMBER OF UCB LOOKUPS.S21052* 03150000
*                                                                       03160000
*                                                                       03170000
*         /*          NUMBER OF DEVICE TABLES COUNTER AND WORK AREA     03180000
*                                                               S21052* 03190000
*         DCL 1 X FIXED(15),                                            03200000
*           3 UNITCTR FIXED(15),   /* DEVTABLE COUNTER.         S21052* 03210000
*             5 * CHAR(1),                                              03220000
*             5 UNITCTR1 CHAR(1);  /* DEVTABLE COUNTER.         S21052* 03230000
*                                                                       03240000
*         DCL ERRORTAB FIXED(15);       /* ERROR DEV TABLES CNTRX02906* 03250000
*         DCL X1 FIXED(15);        /* LOOP COUNTER.             S21052* 03260000
*         DCL COUNT FIXED(15);          /* LOOP COUNTER.         M4833* 03270000
*         DCL I FIXED(15);              /* LOOP COUNTER.         M4833* 03280000
*         DCL ERRCODE CHAR(2);     /* ERROR CODE IN MESSAGE.    S21052* 03290000
*                                                                       03300000
*                                                                       03310000
*         /*          GRAPHICS CONTROL UNIT DEVICE TABLE STRUCTURE      03320000
*                                                               S21052* 03330000
*         DCL 1 GRAPHICS CHAR(56) BDY(WORD),                            03340000
*           3 EBADDR CHAR(8),      /* EBCDIC DEVICE ADDRESS.    S21052* 03350000
*             5 * CHAR(7),                                              03360000
*             5 DEVICE CHAR(1),    /* DEVICE NUMBER.            S21052* 03370000
*           3 * CHAR(4),                                                03380000
*           3 FLAG CHAR(1),        /* FLAG FIELD.               S21052* 03390000
*             5 OFF BIT(1);        /* DEVICE ON-OFF LINE STATUS.S21052* 03400000
*                                                                       03410000
*                                                                       03420000
*         /*          CHARACTER REPRESENTATION OF NUMBERS       S21052* 03430000
*         DCL NUMBERS CHAR(16) INIT('0123456789ABCDEF');                03440000
*                                                                       03450000
*         /*          LOOK AT ONE NUMBER                        S21052* 03460000
*         DCL NUMBER CHAR(1) BASED(R9);                                 03470000
*                                                                       03480000
*         /*          CONVERSION AREA HEX/DECIMAL               S21052* 03490000
*         DCL 1 DEVAD CHAR(8) INIT('00000000'),                         03500000
*           3 DEVAD1 CHAR(8);      /* DEVICE ADDRESS WORK AREA. S21052* 03510000
*                                                                       03520000
*                                                                       03530000
*         /*          DEVICE DECODE INTERNAL SWITCHES           S21052* 03540000
*         DCL 1 SWITCHES CHAR(1),                                       03550000
*           3 FRSTPASS BIT(1);     /* FIRST DEVICE TABLE BUILT. S21052* 03560000
*                                                                       03570000
*                                                                       03580000
*         /*          CDS NAME WORK AREA                        S21052* 03590000
*         DCL 1 PARMLIST CHAR(16) BDY(WORD),                            03600000
*           3 MODNAME CHAR(8),                                          03610000
*             5 TCDSO CHAR(1) INIT('G'),                                03620000
*             5 CDSDEV CHAR(7),                                         03630000
*           3 TARGETAD PTR,                                             03640000
*           3 PARMFLGS CHAR(1),                                         03650000
*           3 * CHAR(1),                                                03660000
*           3 CDSLNGTH FIXED(15);                                       03670000
*                                                                       03680000
*                                                                       03690000
*         /*          UNIT CONTROL BLOCK (UCB) STRUCTURE        S21052* 03700000
*         DCL 1 UCBDVDSC CHAR(4) BASED(UCBADDR+16),                     03710000
*           3 UCBMODEL CHAR(1),    /* DEVICE MODEL.             S21052* 03720000
*           3 UCBFEAT CHAR(1),     /* DEVICE FEATURES.          S21052* 03730000
*             5 * BIT(2),                                               03740000
*             5 SHAREDDV BIT(1),   /* DEV SHAREABLE >1 CPU            * 03750000
*             5 * BIT(5),                                               03760000
*           3 UCBCLASS CHAR(1),    /* DEVICE CLASS.             S21052* 03770000
*           3 UCBTYPE CHAR(1);     /* DEVICE TYPE.              S21052* 03780000
*                                                                       03790000
*                                                                       03800000
*         /*          LOADED CDS ENTRY FORMAT                   S21052* 03810000
*         DCL 1 CDSENTRY CHAR(20) BASED(R1),                            03820000
*           3 * CHAR(4),                                                03830000
*           3 DSCRPTRS CHAR(4);    /* CDS DEVICE DESCRIPTORS.   S21052* 03840000
*         RESTRICT(R1,R2,R3,R4,R5,GOODENT,UCBLOOK,DEVTABPT,R9);         03850000
*         /************************************************************ 03860000
*         /*                                                    S21052* 03870000
*         /*                   PERFORM INITIALIZATION           S21052* 03880000
*         /*                                                    S21052* 03890000
*         /************************************************************ 03900000
*                                                                       03910000
*         R4=ADDR(IFDMSG61);       /*POINTER TO MESSAGE MODULE. S21052* 03920000
         L     @C,@V1              ADDRESS OF IFDMSG61            0085  03930000
         LR    @4,@C                                              0085  03940000
*         R5=INBUFPTR;             /* POINTER TO INPUTBUFFER.   S21052* 03950000
         L     @5,INBUFPTR                                        0086  03960000
*         X=0;                     /* INIT DEVICE COUNTER.      S21052* 03970000
         SR    @F,@F                                              0087  03980000
         STH   @F,X                                               0087  03990000
*         SECDVPTR=0;              /* INIT LAST GRABBED DEVICE. S21052* 04000000
         ST    @F,SECDVPTR                                        0088  04010000
*         LEGALDEV='0'B;           /* TURN OFF VALID DEV ENTRY FLG      04020000
*                                                               S21052* 04030000
         NI    OLTEPSW,B'11110111'                                0089  04040000
*         ONLINETP='00'B;          /* ONLINEOK,TP FLAGS OFF.    S21052* 04050000
         NI    OLTEPSW1,B'11111100'                               0090  04060000
*         REINT='1'B;              /* TURN ON REINITIAL FLAG.   S21052* 04070000
         OI    OLTEPSW,B'00000100'                                0091  04080000
*         LIMIT=16-UNICTR;         /* CALC UNUSED DEVICE TABLES.S21052* 04090000
         LA    @F,16                                              0092  04100000
         SR    @0,@0                                              0092  04110000
         IC    @0,UNICTR                                          0092  04120000
         SR    @F,@0                                              0092  04130000
         STH   @F,LIMIT                                           0092  04140000
*                                                                       04150000
*         /*          IF RETAIN IS ACTIVE THEN SET NO REMOTE MSG FLAG * 04160000
*         IF RETAINAC='1'B THEN         /* IS  REI  ACTIVE?     S21052* 04170000
         TM    A00012,B'10000000'                                 0093  04180000
         BC    12,@9FF                                            0093  04190000
*         DPMSGREI='1'B;                /* REM SITE GETS MSG    XM0097* 04200000
         OI    A00014,B'00000001'                                 0094  04210000
*                                                                       04220000
*         /*          RETURN FROM IFDOLT31 INDICATED            S21052* 04230000
*         IF RETTO31='1'B THEN     /* SECOND TIME ENTERED.      S21052* 04240000
@9FF     TM    OLTEPSW7,B'01000000'                               0095  04250000
         BC    12,@9FE                                            0095  04260000
*          DO;                     /* YES, RESTORE OLD VALUES.  S21052* 04270000
*           DEVTABPT=DEVTBPTR+(SAVECNT*TABLNGTH);                       04280000
         LH    @E,TABLNGTH                                        0097  04290000
         MH    @E,SAVECNT                                         0097  04300000
         A     @E,DEVTBPTR                                        0097  04310000
         LR    @8,@E                                              0097  04320000
*           AVAILBLE=DEVTABPT;     /* LOCATE DEVICE TABLES.     S21052* 04330000
         ST    @8,AVAILBLE                                        0098  04340000
*           GOODENT=SAVECNT;       /* REINIT GOOD ENTRIES COUNTES21052* 04350000
         LH    @6,SAVECNT                                         0099  04360000
*           X=SAVECNT;             /* REINIT MISC COUNTER.      S21052* 04370000
         MVC   X(2),SAVECNT                                       0100  04380000
*           GO TO CECDEV00;        /* CHECK DE5ICE 23A342.      S21052* 04390000
         BC    15,CECDEV00                                        0101  04400000
*          END;                                                         04410000
*         GOODENT=0;               /* INIT VALID ENTRIES COUNTER.       04420000
*                                                               S21052* 04430000
@9FE     SR    @6,@6                                              0103  04440000
*         DEVTABPT=DEVTBPTR;       /* INITIALIZE DEVICE TABLE PTR       04450000
*                                                               S21052* 04460000
         L     @8,DEVTBPTR                                        0104  04470000
*         AVAILBLE=DEVTABPT;       /* NEXT AVAILABLE DEV TABLE. S21052* 04480000
         ST    @8,AVAILBLE                                        0105  04490000
*                                                                       04500000
*                                                                       04510000
* CECDEV00:                             /*                      S21052* 04520000
*                                                                       04530000
*         /************************************************************ 04540000
*         /*                                                    S21052* 04550000
*         /*                ON-LINE / OFF-LINE CHECK            S21052* 04560000
*         /*                                                    S21052* 04570000
*         /************************************************************ 04580000
*                                                                       04590000
*         /*          LOCAL OR REMOTE ANR DEVICE IN SYSTEM      S21052* 04600000
*         IF ANRNOTST='1'B |       /* ANR DEV OK TO TEST       XA00530* 04610000
*            NOTEST='1'B THEN      /* IS DEVICE TESTABLE?      XA00530* 04620000
CECDEV00 TM    14(@8),B'10000000'                                 0106  04630000
         BC    01,@9FD                                            0106  04640000
         TM    14(@8),B'00001000'                                 0106  04650000
         BC    12,@9FC                                            0106  04660000
*           GO TO CECDEV14;        /* NO, NOT A VALID ENTRY.   XA00530* 04670000
         BC    03,CECDEV14                                        0107  04680000
*                                                                       04690000
*         /*          CHECK DEVICE ON LINE STATUS               S21052* 04700000
*         IF ONOFF='1'B THEN       /* IS DEVICE ONLINE.         S21052* 04710000
@9FC     TM    12(@8),B'10000000'                                 0108  04720000
*           GO TO CECDEV04;        /* YES, CHECK DEVICE CLASS.  S21052* 04730000
         BC    01,CECDEV04                                        0109  04740000
*         IF SYSALLOC='1'B THEN    /* DEV ALLOCATED? CHK CLASS XA00530* 04750000
         TM    14(@8),B'00000100'                                 0110  04760000
*           GO TO CECDEV04;        /* GO DO IT.                XA00530* 04770000
         BC    01,CECDEV04                                        0111  04780000
*                                                                       04790000
*         /*          CHECK FOR GRAPHICS 2250 DEVICE--CLASS     S21052* 04800000
*         IF UCBCLASS^='10'X       /* NO, IS IT GRAPHICS.       S21052* 04810000
*           THEN                   /* YES                       S21052* 04820000
         MVC   @TEMP4(4),8(@8)                                    0112  04830000
         L     @C,@TEMP4                                          0112  04840000
         CLI   18(@C),X'10'                                       0112  04850000
*           GO TO CECDEV10;        /* GO TO PUSH UP ROUTINE.    S21052* 04860000
         BC    07,CECDEV10                                        0113  04870000
*                                                                       04880000
*         /*          CHECK FOR GRAPHICS 2250 DEVICE--TYPE      S21052* 04890000
*         IF UCBTYPE^='02'X        /* YES, IS IT A 2250.        S21052* 04900000
*           THEN                   /* YES                       S21052* 04910000
         CLI   19(@C),X'02'                                       0114  04920000
*           GO TO CECDEV10;        /* NO, CONTINUE CLASSIFICATION.      04930000
*                                                               S21052* 04940000
         BC    07,CECDEV10                                        0115  04950000
*                                                                       04960000
*         /*          CHECK FOR GRAPHICS 2250 DEVICE--MODEL     S21052* 04970000
*         IF UCBMODEL='31'X        /* YES, IT IS A MODEL 1.     S21052* 04980000
*           THEN                   /* YES                       S21052* 04990000
         CLI   16(@C),X'31'                                       0116  05000000
*           GO TO CECDEV10;        /* YES, TO TO PUSH UP ROUTINE.       05010000
*                                                               S21052* 05020000
         BC    08,CECDEV10                                        0117  05030000
*         GRAPHICS=GRAPHICS&&GRAPHICS;                                  05040000
         XC    GRAPHICS(56),GRAPHICS                              0118  05050000
*         EBADDR=DEVADDR;          /* SAVE GRAPHICS DEVICE ADDR.S21052* 05060000
         MVC   GRAPHICS(8),0(@8)                                  0119  05070000
*         ADDRDEV=ADDR(GRAPHICS);  /* FILL SVC 59 POINTER.      S21052* 05080000
         LA    @F,GRAPHICS                                        0120  05090000
         ST    @F,SVCPLIST+4                                      0120  05100000
*         ENTRIES=1;               /* CHECK ONE ENTRY AT A TIME.S21052* 05110000
         LA    @F,1                                               0121  05120000
         ST    @F,SVCPLIST+8                                      0121  05130000
*         R9=ADDR(NUMBERS);        /* GET PTR TO NUMBER TABLE.  S21052* 05140000
         LA    @9,NUMBERS                                         0122  05150000
*         /*          CHECK ALL DEVICES ON GRAPHICS CONTROL UNITS21052* 05160000
*         DO X1=16 TO 1                                                 05170000
*          BY -1;                  /* CHECK CU LINE STATUS.     S21052* 05180000
         LA    @F,16                                              0123  05190000
         STH   @F,X1                                              0123  05200000
*          DEVICE=NUMBER;          /* PUT NUMBER IN DEV ADDR.   S21052* 05210000
@DO9FB   MVC   GRAPHICS+7(1),0(@9)                                0124  05220000
*          RESTRICT(R1);           /* RESTRICT REG FOR COMPUTATION.     05230000
*                                                               S21052* 05240000
*          R1=64;                  /* SVC 59 CALLING CODE.      S21052* 05250000
         LA    @1,64                                              0126  05260000
*          R0=ADDR(ADDRDEV);       /* PARAMETER LIST IN REG 0.  S21052* 05270000
         LA    @0,SVCPLIST+4                                      0127  05280000
*          RELEASE(R1);            /* RELEASE REG FOR FURTHER USE       05290000
*                                                               S21052* 05300000
*          GEN(SVC  59);           /* SVC 59 FOR UCB LOOKUP.    S21052* 05310000
         SVC  59                                                        05320000
         DS    0H                                                       05330000
*                                                                       05340000
*          /*         IS GRAPHICS DEVICE ONLINE                 S21052* 05350000
*          IF OFF='1'B THEN        /* IS DEVICE OFFLINE.        S21052* 05360000
         TM    GRAPHICS+12,B'10000000'                            0130  05370000
         BC    12,@9F7                                            0130  05380000
*           DO;                    /* YES, CHECK NEXT DEVICE.   S21052* 05390000
*                                                                       05400000
*            /*       GRAPHICS DEVICE CHECK MADE HERE           S21052* 05410000
*            IF GRAPHICS(6)^='10'X                                      05420000
*             THEN                 /* CHECK FOR                 S21052* 05430000
         CLI   GRAPHICS+5,X'10'                                   0132  05440000
*             GO TO CECDEV02;      /* NOT GRAPHICS,CHECK NEXT DEV       05450000
*                                                               S21052* 05460000
         BC    07,CECDEV02                                        0133  05470000
*                                                                       05480000
*            /*       GRAPHICS DEVICE CHECK MADE HERE           S21052* 05490000
*            IF GRAPHICS(7)^='02'X                                      05500000
*             THEN                 /* CONTINUE,                 S21052* 05510000
         CLI   GRAPHICS+6,X'02'                                   0134  05520000
*             GO TO CECDEV02;      /* CHECK NEXT CU DEVICE.     S21052* 05530000
         BC    07,CECDEV02                                        0135  05540000
*                                                                       05550000
*            /*       GRAPHICS DEVICE CHECK MADE HERE           S21052* 05560000
*            IF GRAPHICS(5)='31'X                                       05570000
*             THEN                 /* CONTINUE,                 S21052* 05580000
         CLI   GRAPHICS+4,X'31'                                   0136  05590000
*             GO TO CECDEV02;      /* CHECK NEXT CU DEVICE.     S21052* 05600000
         BC    08,CECDEV02                                        0137  05610000
*            R1=MSGPTR14;          /* PRINT ERROR MESSAGE.      S21052* 05620000
         L     @1,12(0,@4)                                        0138  05630000
*            GEN(PWTO REG=(R1));                                        05640000
         PWTO REG=(R1)                                                  05650000
         DS    0H                                                       05660000
*            GO TO CECDEV26;       /* GO AND REDEFINE TEST.     S21052* 05670000
         BC    15,CECDEV26                                        0140  05680000
*           END;                                                        05690000
*                                                                       05700000
*                                                                       05710000
* CECDEV02:                        /*                           S21052* 05720000
*                                                                       05730000
*          GRAPHICS(4:16)=GRAPHICS(4:16)&&GRAPHICS                      05740000
*           (4:16);                /* CLEAR DEVICE TABLE AREA.  S21052* 05750000
@9F7     EQU   *                                                  0142  05760000
CECDEV02 XC    GRAPHICS+3(13),GRAPHICS+3                          0142  05770000
*          R9=R9+1;                /* POINT TO NEXT NUMBER.     S21052* 05780000
         LA    @9,1(0,@9)                                         0143  05790000
*         END;                     /* END GRAPHICS LOOP.        S21052* 05800000
*         GO TO CECDEV10;          /* GO TO DEV TAB PUSH UP ROUTN.      05810000
*                                                               S21052* 05820000
         LH    @F,X1                                              0144  05830000
         BCTR  @F,0                                               0144  05840000
@DO9FA   STH   @F,X1                                              0144  05850000
         CH    @F,@D1                                             0144  05860000
         BC    10,@DO9FB                                          0144  05870000
         BC    15,CECDEV10                                        0145  05880000
*                                                                       05890000
*                                                                       05900000
* CECDEV04:                             /*                      S21052* 05910000
*                                                                       05920000
*         /************************************************************ 05930000
*         /*          ONLINE ALLOCATION CHECKS                 XA00530* 05940000
*         /************************************************************ 05950000
*                                                                       05960000
*         /*          REMOTE TELEPROCESSING DEVICE ENTERED      S21052* 05970000
*         IF REMLINE='1'B THEN     /* IF REMOTE DEVICE IS NOT OFS21052* 05980000
CECDEV04 TM    41(@8),B'00000001'                                 0146  05990000
*           GO TO CECDEV06;        /* LINE, CAN'T TEST. PRINT MSG       06000000
*                                                               S21052* 06010000
         BC    01,CECDEV06                                        0147  06020000
*                                                                       06030000
*         /*          CHECK ANR DEVICE CLASS & TYPE             S21052* 06040000
*         IF UCBCLASS='10'X &      /* IF ANR DEVICE IS ONLINE,  S21052* 06050000
*            UCBTYPE>'08'X &               /* ANR DEVICE?      XA00530* 06060000
*            UCBTYPE<'0C'X THEN    /* WITHIN RANGE OF TYPES?   XA00530* 06070000
         MVC   @TEMP4(4),8(@8)                                    0148  06080000
         L     @1,@TEMP4                                          0148  06090000
         CLI   18(@1),X'10'                                       0148  06100000
         BC    07,@9F6                                            0148  06110000
         CLI   19(@1),X'08'                                       0148  06120000
         BC    12,@9F5                                            0148  06130000
         CLI   19(@1),X'0C'                                       0148  06140000
*              GO TO CECDEV10;     /* LOCAL 3270 DEVICE.       XA00530* 06150000
         BC    05,CECDEV10                                        0149  06160000
*         /*          CLASS 40 RESERVED FOR TELECOMMUNICATIONS DEVICES  06170000
*                                                               S21052* 06180000
*         IF UCBCLASS='40'X THEN   /* IS IT TELECOMMUNICATIONS. S21052* 06190000
@9F4     EQU   *                                                  0150  06200000
@9F5     EQU   *                                                  0150  06210000
@9F6     MVC   @TEMP4(4),8(@8)                                    0150  06220000
         L     @1,@TEMP4                                          0150  06230000
         CLI   18(@1),X'40'                                       0150  06240000
*           GO TO CECDEV06;        /* ONLINE ALLOCATED TP DEV           06250000
*                                                               S21052* 06260000
         BC    08,CECDEV06                                        0151  06270000
*                                                                       06280000
*         /*          CHECK FOR DASD DEVICES                    S21052* 06290000
*         IF UCBCLASS='20'X THEN    /* IS IT DASD?            @Y30LPAW* 06300000
         CLI   18(@1),X'20'                                       0152  06310000
*            GOTO CECDEV10;         /* YES,GO AROUND          @Y30LPAW* 06320000
         BC    08,CECDEV10                                        0153  06330000
*         IF UCBCLASS = '08'X &    /*  IS IT                  @ZA02796* 06340000
*             UCBTYPE = '42'X THEN /*        MSC?             @ZA02796* 06350000
         CLI   18(@1),X'08'                                       0154  06360000
         BC    07,@9F3                                            0154  06370000
         CLI   19(@1),X'42'                                       0154  06380000
*                 GOTO CECDEV10;    /* YES,GO AROUND          @Y30LPAW* 06390000
         BC    08,CECDEV10                                        0155  06400000
* CECDEV06:                             /*                      S21052* 06410000
*                                                                       06420000
*         /************************************************************ 06430000
*         /*                 PRINT MESSAGE IFD109I              S21052* 06440000
*         /************************************************************ 06450000
*                                                                       06460000
*                                                                       06470000
*         R1=MSGPTR09;             /* GET POINTER TO MESSAGE 109S21052* 06480000
@9F2     EQU   *                                                  0156  06490000
@9F3     EQU   *                                                  0156  06500000
CECDEV06 L     @1,0(0,@4)                                         0156  06510000
*         MSG109I(1:8)=DEVADDR;                                         06520000
         MVC   12(8,@1),0(@8)                                     0157  06530000
*         IF ONOFF='1'B             /* ONLINE DEVICE?          XA00530* 06540000
*          THEN                                                         06550000
         TM    12(@8),B'10000000'                                 0158  06560000
         BC    12,@9F1                                            0158  06570000
*            MSG109I(10:17)='ONLINE ,';  /* DEV ONLINE IN MSG  XA00530* 06580000
         MVC   21(8,@1),@C12                                      0159  06590000
         BC    15,@9F0                                            0160  06600000
*          ELSE                                                         06610000
*            MSG109I(10:17)='OFFLINE,';  /* DEV OFFLINE IN MSG XA00530* 06620000
@9F1     MVC   21(8,@1),@C13                                      0160  06630000
*         IF SYSALLOC='1'B         /*  IS DEV ALLOCATED?       XA00530* 06640000
*          THEN                                                         06650000
@9F0     TM    14(@8),B'00000100'                                 0161  06660000
         BC    12,@9EF                                            0161  06670000
*           MSG109I(18:28)='ALLOCATED  ';  /* ALLOCATED IN MSG.XA00530* 06680000
         MVC   29(11,@1),@C14                                     0162  06690000
         BC    15,@9EE                                            0163  06700000
*          ELSE                                                         06710000
*           MSG109I(18:28)='UNALLOCATED';  /* UNALLOCATED IN MSG.     * 06720000
@9EF     MVC   29(11,@1),@C15                                     0163  06730000
*         GEN( PWTO REG=(R1));          /* ISSUE MESSAGE 109I  XA00530* 06740000
@9EE     EQU   *                                                  0164  06750000
          PWTO REG=(R1)                                                 06760000
         DS    0H                                                       06770000
*         DEVTABXX=DEVTABXX                                             06780000
*          &&DEVTABXX;             /* CLEAR DEVICE TABLE.       S21052* 06790000
         XC    0(56,@8),0(@8)                                     0165  06800000
*         GO TO CECDEV14;          /* SKIP ENTRY.               S21052* 06810000
         BC    15,CECDEV14                                        0166  06820000
*                                                                       06830000
*                                                                       06840000
* CECDEV10:                             /*                      S21052* 06850000
*                                                                       06860000
*         /************************************************************ 06870000
*         /*                                                    S21052* 06880000
*         /*          FIND LOCAL DEVICE CDS INFORMATION         S21052* 06890000
*         /*                                                    S21052* 06900000
*         /************************************************************ 06910000
*                                                                       06920000
*         IF SYMDEVIC='1'B THEN    /* SYMBOLIC DEVS ALREADY HAVES21052* 06930000
CECDEV10 TM    41(@8),B'00001000'                                 0167  06940000
*            GO TO CECDEV12;       /* CDS LOADED. MAKE DEVTAB CHK       06950000
*                                                               S21052* 06960000
         BC    01,CECDEV12                                        0168  06970000
*                                                                       06980000
*         /*          CHECK IF .CHXXXXXX DEVICE  ENTERED        S21052* 06990000
*         IF CHANTEST='1'B THEN    /* CHANNEL TESTS ALREADY HAVES21052* 07000000
         TM    OLTEPSW2,B'00010000'                               0169  07010000
*           GO TO CECDEV12;        /* CDS INFORMATION LOADED.   S21052* 07020000
         BC    01,CECDEV12                                        0170  07030000
*         CDSDEV=DEVADDR(2:8);                                          07040000
         MVC   PARMLIST+1(7),1(@8)                                0171  07050000
*         TARGETAD=DEVTABPT+32;                                         07060000
         LA    @F,32                                              0172  07070000
         AR    @F,@8                                              0172  07080000
         ST    @F,PARMLIST+8                                      0172  07090000
*         PARMFLGS='60'X;                                               07100000
         MVI   PARMLIST+12,X'60'                                  0173  07110000
*         CDSLNGTH='14'X;                                               07120000
         LA    @F,X'14'                                           0174  07130000
         STH   @F,PARMLIST+14                                     0174  07140000
*         GEN(IFDMOD  CALL='12',LIST=PARMLIST);                         07150000
         IFDMOD  CALL='12',LIST=PARMLIST                                07160000
         DS    0H                                                       07170000
*         R1=RC;                                                        07180000
         LR    @1,@F                                              0176  07190000
*         IF R1>0 THEN                                                  07200000
         LTR   @1,@1                                              0177  07210000
         BC    12,@9ED                                            0177  07220000
*          DO;                                                          07230000
*           CDSDVDSC=CDSDVDSC&&CDSDVDSC;                                07240000
         XC    36(4,@8),36(@8)                                    0179  07250000
*           RESTRICT(1);                                                07260000
*           R1=MSGPTR27;                                                07270000
         L     @1,16(0,@4)                                        0181  07280000
*           MSG127I(12:19)=MODNAME;                                     07290000
         MVC   23(8,@1),PARMLIST                                  0182  07300000
*         MSG127I(12)='F0'X;            /* ZERO OUT 'G' FOR MSG X03008* 07310000
         MVI   23(@1),X'F0'                                       0183  07320000
*         GEN(PWTO REG=(1));                                            07330000
         PWTO REG=(1)                                                   07340000
         DS    0H                                                       07350000
*           RELEASE(1);                                                 07360000
*           COUNT=72;                                        /*XA00530* 07370000
         LA    @F,72                                              0186  07380000
         STH   @F,COUNT                                           0186  07390000
*           DO I=1 TO COUNT BY +1;                           /*XA00530* 07400000
         LA    @F,1                                               0187  07410000
         BC    15,@DO9EB                                          0187  07420000
*             IF INPUTBUF(I)='/' THEN                                   07430000
@DO9EC   LH    @1,I                                               0188  07440000
         LA    @A,0(@1,@5)                                        0188  07450000
         BCTR  @A,0                                               0188  07460000
         CLI   0(@A),C'/'                                         0188  07470000
*              GO TO CECDV10A;                                          07480000
         BC    08,CECDV10A                                        0189  07490000
*            END;                                                       07500000
* CECDV10A:                                                             07510000
*           I=I+1;                                                      07520000
         LH    @F,I                                               0190  07530000
         AH    @F,@D1                                             0190  07540000
@DO9EB   STH   @F,I                                               0190  07550000
         CH    @F,COUNT                                           0190  07560000
         BC    12,@DO9EC                                          0190  07570000
CECDV10A LA    @F,1                                               0191  07580000
         AH    @F,I                                               0191  07590000
         STH   @F,I                                               0191  07600000
*           IF INPUTBUF(I)='T' THEN                                     07610000
         LR    @1,@F                                              0192  07620000
         LA    @A,0(@1,@5)                                        0192  07630000
         BCTR  @A,0                                               0192  07640000
         CLI   0(@A),C'T'                                         0192  07650000
         BC    07,@9E8                                            0192  07660000
*            I=I+1;                                                     07670000
         LA    @F,1                                               0193  07680000
         AH    @F,I                                               0193  07690000
         STH   @F,I                                               0193  07700000
*           IF INPUTBUF(I:I+5)='SOSPC/'           /*          @ZA29758* 07710000
*             THEN                                                      07720000
@9E8     LH    @1,I                                               0194  07730000
         LA    @A,0(@1,@5)                                        0194  07740000
         BCTR  @A,0                                               0194  07750000
         CLC   0(6,@A),@C21                                       0194  07760000
         BC    07,@9E7                                            0194  07770000
*              DO;                      /* SOSP ENTERED        XA01010* 07780000
*               CDSDVDSC=UCBDVDSC;      /* INIT DV DSCRPT      XA01010* 07790000
         MVC   @TEMP4(4),8(@8)                                    0196  07800000
         L     @C,@TEMP4                                          0196  07810000
         MVC   36(4,@8),16(@C)                                    0196  07820000
*               IF SHAREDDV='1'B &      /* IF DASD SHAREABLE   XA01010* 07830000
*                UCBCLASS='20'X         /* DASD CLASS DEV      XA01010* 07840000
*                THEN                   /* THEN TURN ON        XA01010* 07850000
         MVC   @TEMP4(4),8(@8)                                    0197  07860000
         L     @C,@TEMP4                                          0197  07870000
         TM    17(@C),B'00100000'                                 0197  07880000
         BC    12,@9E6                                            0197  07890000
         CLI   18(@C),X'20'                                       0197  07900000
         BC    07,@9E5                                            0197  07910000
*                 CDSFLAGS=CDSFLAGS|'40'X; /* SHARED FLG IN CDSXA01010* 07920000
         OI    41(@8),X'40'                                       0198  07930000
*               GO TO CECDEV12;                                         07940000
         BC    15,CECDEV12                                        0199  07950000
*              END;                                                     07960000
*           GO TO CECDEV14;                                             07970000
*          END;                                                         07980000
* CECDEV12:                             /*                      S21052* 07990000
*                                                                       08000000
*         /************************************************************ 08010000
*         /*                                                    S21052* 08020000
*         /*          ROUTINE TO REMOVE INVALID DEVICE TABLES   S21052* 08030000
*         /*                                                    S21052* 08040000
*         /************************************************************ 08050000
*                                                                       08060000
*         GOODENT=GOODENT+1;       /* INCREMENT VALID EN3R8 CN3R.       08070000
*                                                               S21052* 08080000
@9ED     EQU   *                                                  0203  08090000
CECDEV12 AH    @6,@D1                                             0203  08100000
*         DEVTABLE=DEVTABXX;       /* ADDRESS AVAILABLE DEV TAB.S21052* 08110000
         L     @1,AVAILBLE                                        0204  08120000
         MVC   0(56,@1),0(@8)                                     0204  08130000
*                                                                       08140000
*         /*          CHECK IF LAST FILLED DEV TAB WAS PROPER ONE       08150000
*                                                               S21052* 08160000
*                                                                       08170000
*         IF AVAILBLE^=DEVTABPT    /* IS CORRECT DEV TAB FILLED S21052* 08180000
*           THEN                   /* NO, CLEAR INVALID DEVICE TABLE.   08190000
*                                                               S21052* 08200000
         C     @8,AVAILBLE                                        0205  08210000
         BC    08,@9E4                                            0205  08220000
*           DEVTABXX=DEVTABXX&&                                         08230000
*            DEVTABXX;             /* CLEAR OUT DEVICE TABLE.   S21052* 08240000
         XC    0(56,@8),0(@8)                                     0206  08250000
*         AVAILBLE=AVAILBLE+TABLNGTH;                                   08260000
@9E4     LH    @F,TABLNGTH                                        0207  08270000
         A     @F,AVAILBLE                                        0207  08280000
         ST    @F,AVAILBLE                                        0207  08290000
*                                                                       08300000
*                                                                       08310000
* CECDV12A:                        /*                           S21052* 08320000
*                                                                       08330000
*         /************************************************************ 08340000
*         /*                                                    S21052* 08350000
*         /*          CHECK CONTROL UNIT LINES                  S21052* 08360000
*         /*                                                    S21052* 08370000
*         /************************************************************ 08380000
*                                                                       08390000
*                                                                       08400000
*         /*          IS THIS A CONTROL UNIT TEST               S21052* 08410000
*         IF TPSAVE(1:3)^='270'                                         08420000
*           THEN                   /* 2701,2702,2703 C U TEST   S21052* 08430000
CECDV12A CLC   TPSAVE(3),@C22                                     0208  08440000
*           GO TO CECDEV14;        /* NOT A 2701,2702,2703 TEST.S21052* 08450000
         BC    07,CECDEV14                                        0209  08460000
*                                                                       08470000
*         /*          IS THIS A 2701 CONTROL UNIT TEST          S21052* 08480000
*         IF TPSAVE3='1' THEN      /* IS IT A 2701 TEST.        S21052* 08490000
         CLI   TPSAV+3,C'1'                                       0210  08500000
*           GO TO CECDEV14;        /* YES, CONTINUE CHECKS.     S21052* 08510000
         BC    08,CECDEV14                                        0211  08520000
*                                                                       08530000
*         /*          HAVE ANY VALID DEVICES BEEN DECODED YET   S21052* 08540000
*         IF GOODENT=0 THEN        /* NO VALID ENTRY MADE, END  S21052* 08550000
         LTR   @6,@6                                              0212  08560000
*           GO TO CECDEV20;        /* THIS D/T/O/ ENTRY.        S21052* 08570000
         BC    08,CECDEV20                                        0213  08580000
*                                                                       08590000
*                                                                       08600000
* CECDEV14:                        /*                           S21052* 08610000
*                                                                       08620000
*         /************************************************************ 08630000
*         /*                                                    S21052* 08640000
*         /*          CHECK FOR MORE OUTSTANDING DEVICES        S21052* 08650000
*         /************************************************************ 08660000
*                                                                       08670000
*         X=X+1;                   /* INCREMENT DEV TAB COUNTER.S21052* 08680000
CECDEV14 LA    @F,1                                               0214  08690000
         AH    @F,X                                               0214  08700000
         STH   @F,X                                               0214  08710000
*         DEVTABPT=DEVTABPT+TABLNGTH;                                   08720000
         AH    @8,TABLNGTH                                        0215  08730000
*                                                                       08740000
*         /*          CHECK DEVICE COUNTER IN COMMON AREA       S21052* 08750000
*         IF X^=UNICTR  THEN       /* ARE ALL DEVICES CHECKED.  S21052* 08760000
         SR    @F,@F                                              0216  08770000
         IC    @F,UNICTR                                          0216  08780000
         CH    @F,X                                               0216  08790000
*           GO TO CECDEV00;        /* NO, LOOP.  YES, CONTINUE. S21052* 08800000
         BC    07,CECDEV00                                        0217  08810000
*                                                                       08820000
*         /*          CHECK FOR ANY DEVS FOUND ONLINE & DEV TABS FULL   08830000
*                                                               S21052* 08840000
*         IF UNICTR=16 &           /* FORMER VALID ENTRY FOUND OS21052* 08850000
*           GOODENT<16 THEN        /* LINE, RESET VARIABLES AND S21052* 08860000
         CLI   UNICTR,16                                          0218  08870000
         BC    07,@9E3                                            0218  08880000
         CH    @6,@D2                                             0218  08890000
         BC    10,@9E2                                            0218  08900000
*          DO;                     /* CONTINUE B8               S21052* 08910000
*           SAVECNT=GOODENT;       /* RETURN TO IFDOLT31.       S21052* 08920000
         STH   @6,SAVECNT                                         0220  08930000
*           UNICTR=GOODENT;        /* SAVE GOOD ENTRIES  TO DATES21052* 08940000
         ST    @6,@TEMP4                                          0221  08950000
         MVC   UNICTR(1),@TEMP4                                   0221  08960000
*           RETTO31='1'B;          /* SET RETURN FLAG.          S21052* 08970000
         OI    OLTEPSW7,B'01000000'                               0222  08980000
*           GO TO CECDEV28;        /* RETURN POINT .            S21052* 08990000
         BC    15,CECDEV28                                        0223  09000000
*          END;                                                         09010000
*         RETTO31='0'B;            /* DON'T RETURN TO IFDOLT31. S21052* 09020000
@9E2     EQU   *                                                  0225  09030000
@9E3     NI    OLTEPSW7,B'00111111'                               0225  09040000
*         INCLST='0'B;             /* END OF INCLUSIVE SERIES.  S21052* 09050000
*                                                                       09060000
*         /*          ARE ALL DEV TABS FILLED WITH VALID DEVICESS21052* 09070000
*         IF GOODENT=16 THEN       /* ARE THERE 16 GOOD ENTRIES.S21052* 09080000
         CH    @6,@D2                                             0227  09090000
         BC    07,@9E1                                            0227  09100000
*          DO;                     /* YES,                      S21052* 09110000
*           R1=MSGPTR10;           /* GET POINTER TO MESSAGE.   S21052* 09120000
         L     @1,4(0,@4)                                         0229  09130000
*           GEN(PWTO  REG=(1));                                         09140000
         PWTO  REG=(1)                                                  09150000
         DS    0H                                                       09160000
*                                                                       09170000
*                                                                       09180000
* CECDEV16:                        /*                           S21052* 09190000
*                                                                       09200000
*         /************************************************************ 09210000
*         /*                                                    S21052* 09220000
*         /*                     FIND SLASH DELIMITER           S21052* 09230000
*         /*                                                    S21052* 09240000
*         /************************************************************ 09250000
*                                                                       09260000
*           /*        CHECK FOR END OF INPUT BUFFER             S21052* 09270000
*           IF INPUTBUF(1)='/'                                          09280000
*             THEN                 /* SLASH DELIMETER PRESENT.  S21052* 09290000
CECDEV16 CLI   0(@5),C'/'                                         0231  09300000
*             GO TO CECDEV22;      /* YES, A SLASH. GO TO EXIT. S21052* 09310000
         BC    08,CECDEV22                                        0232  09320000
*           R5=R5+1;               /* INCREMENT BUFFER POINTER. S21052* 09330000
         AH    @5,@D1                                             0233  09340000
*           GO TO CECDEV16;        /* LOOP UNTIL SLASH FOUND.   S21052* 09350000
         BC    15,CECDEV16                                        0234  09360000
*          END;                    /* END 16 GOOD ENTRIES LOOP. S21052* 09370000
*         X=0;                     /* SET DEV TAB CNTR TO ZERO. S21052* 09380000
@9E1     SR    @F,@F                                              0236  09390000
         STH   @F,X                                               0236  09400000
*         DEVTABPT=AVAILBLE;       /* PTR TO NEXT AVAILABLE DEV.S21052* 09410000
         L     @8,AVAILBLE                                        0237  09420000
*         LIMIT=16-GOODENT;        /* FIND NEW DEV TAB LIMIT.   S21052* 09430000
         LA    @F,16                                              0238  09440000
         SR    @F,@6                                              0238  09450000
         STH   @F,LIMIT                                           0238  09460000
*                                                                       09470000
*                                                                       09480000
*         /************************************************************ 09490000
*         /*                                                          * 09500000
*         /*          CHECK FOR DEV UCB/CDS CLASS & TYPE DIFFERENCES  * 09510000
*         /*                                                    X02906* 09520000
*         /************************************************************ 09530000
*                                                                       09540000
*         DEVTABPT=DEVTBPTR;            /* ADDRESS FIRST DEVTAB X02906* 09550000
         L     @8,DEVTBPTR                                        0239  09560000
*         ERRORTAB=0;                   /* CLEAR ERROR TABLE CTRX02906* 09570000
         SR    @F,@F                                              0240  09580000
         STH   @F,ERRORTAB                                        0240  09590000
*                                                                       09600000
*         DO I=1 TO GOODENT BY +1;      /* SEARCH ALL DEV TABLESX02906* 09610000
         LA    @F,1                                               0241  09620000
         BC    15,@DO9DF                                          0241  09630000
*                                                                       09640000
*          /*         ARE CDS/UCB CLASS VALUES EQUAL?           X02906* 09650000
*                                                                       09660000
*          IF UCBCLASS^=CLASS THEN      /* ARE CLASSES EQUAL?   X02906* 09670000
@DO9E0   MVC   @TEMP4(4),8(@8)                                    0242  09680000
         L     @1,@TEMP4                                          0242  09690000
         CLC   18(1,@1),38(@8)                                    0242  09700000
         BC    08,@9DC                                            0242  09710000
*                                                                       09720000
*           DO;                         /* NO, MAKE SPECIAL CHK X02906* 09730000
*                                                                       09740000
*            /*       CHECK FOR SYSTEM 7 DEVICE.                X02906* 09750000
*            IF CLASS='02'X &                                           09760000
*             TYPE='01'X THEN           /* SYS 7 CLASS/TYPE?    X02906* 09770000
         CLI   38(@8),X'02'                                       0244  09780000
         BC    07,@9DB                                            0244  09790000
         CLI   39(@8),X'01'                                       0244  09800000
*             GO TO CECDV18A;           /* OK, NOT IN ERROR     X02906* 09810000
         BC    08,CECDV18A                                        0245  09820000
*                                                                       09830000
*            /* IS THIS A TELECOMMUNICATIONS REMOTE DEVICE      X02906* 09840000
*                                                                       09850000
*          TPCLASS =CLASS & 'F0'X;      /* MASK FOR TP CLASS  @ZA09697* 09860000
@9DA     EQU   *                                                  0246  09870000
@9DB     LA    @F,X'F0'                                           0246  09880000
         SR    @0,@0                                              0246  09890000
         IC    @0,38(0,@8)                                        0246  09900000
         NR    @F,@0                                              0246  09910000
         ST    @F,TPCLASS                                         0246  09920000
*          IF TPCLASS = '40'X &         /* CDS CLASS TP &     @ZA09697* 09930000
*             UCBCLASS='40'X THEN       /* UCB CLASS FOR LINE   X02906* 09940000
         LA    @F,X'40'                                           0247  09950000
         C     @F,TPCLASS                                         0247  09960000
         BC    07,@9D9                                            0247  09970000
         MVC   @TEMP4(4),8(@8)                                    0247  09980000
         L     @1,@TEMP4                                          0247  09990000
         CLI   18(@1),X'40'                                       0247  10000000
*             GO TO CECDV18A;           /* OK, NOT IN ERROR     X02906* 10010000
         BC    08,CECDV18A                                        0248  10020000
*                                                                       10030000
*            /*       ERROR IN CLASS MATCHING, OUTPUT MSG IFD154I     * 10040000
*                                                                       10050000
*            RESTRICT(1);                                               10060000
@9D8     EQU   *                                                  0249  10070000
*            R1=MSGPTR54;               /* ADDRESS MESSAGE      X02906* 10080000
@9D9     L     @1,20(0,@4)                                        0250  10090000
*                                                                       10100000
*            /*       FILL MSG BUFFER WITH SYMBOLIC NAME OR UNIT ADDR * 10110000
*                                                                       10120000
*            IF SYMDEVIC='1'B                                           10130000
*             THEN                      /* PUT SYM NAME IN MSG  X02906* 10140000
         TM    41(@8),B'00001000'                                 0251  10150000
         BC    12,@9D7                                            0251  10160000
*              MSG154I(5:12)=DEVTABXX(45:52);                           10170000
         MVC   16(8,@1),44(@8)                                    0252  10180000
         BC    15,@9D6                                            0253  10190000
*             ELSE                      /* USE DEV ADDR IN MSG  X02906* 10200000
*              MSG154I(5:12)=DEVTABXX(1:8);                             10210000
@9D7     MVC   16(8,@1),0(@8)                                     0253  10220000
*                                                                       10230000
*            GEN(PWTO REG=(1));         /* OUTBUT MSG 154I      X02906* 10240000
@9D6     EQU   *                                                  0254  10250000
         PWTO REG=(1)                                                   10260000
         DS    0H                                                       10270000
*            DEVTABXX=DEVTABXX&&DEVTABXX;                               10280000
         XC    0(56,@8),0(@8)                                     0255  10290000
*                                       /* CLEAR DEV TAB IN ERR X02906* 10300000
*            ERRORTAB=ERRORTAB+1;       /* UPDATE ERROR TAB CNT X02906* 10310000
         LA    @F,1                                               0256  10320000
         AH    @F,ERRORTAB                                        0256  10330000
         STH   @F,ERRORTAB                                        0256  10340000
*                                                                       10350000
* CECDV18A:                             /*                      X02906* 10360000
*                                                                       10370000
*           END;                        /* END DEV CLASS MATCH  X02906* 10380000
CECDV18A EQU   *                                                  0257  10390000
*          DEVTABPT=DEVTABPT+TABLNGTH;  /* NEXT DEV TAB ADDRESS X02906* 10400000
@9DC     AH    @8,TABLNGTH                                        0258  10410000
*         END;                          /* END DEV TAB SEARCH   X02906* 10420000
*                                                                       10430000
*         /*          REMOVE ANY BAD DEVICE TABLES FROM LIST    X02906* 10440000
*         IF ERRORTAB=0 THEN            /* ANY BAD TABLES?      X02906* 10450000
         LH    @F,I                                               0259  10460000
         AH    @F,@D1                                             0259  10470000
@DO9DF   STH   @F,I                                               0259  10480000
         CR    @F,@6                                              0259  10490000
         BC    12,@DO9E0                                          0259  10500000
         SR    @F,@F                                              0260  10510000
         CH    @F,ERRORTAB                                        0260  10520000
*          GO TO CECDEV18;              /* NO, GO ON .          X02906* 10530000
         BC    08,CECDEV18                                        0261  10540000
*                                                                       10550000
*         DEVTABPT=DEVTBPTR;            /* INIT DEV TABLE PTR   X02906* 10560000
         L     @8,DEVTBPTR                                        0262  10570000
*         AVAILBLE=DEVTBPTR;            /* INIT DEV TABLE PTR   X02906* 10580000
         MVC   AVAILBLE(4),DEVTBPTR                               0263  10590000
*         DO I=1 TO GOODENT BY +1;      /* SEARCH ALL DEV TABLESX02906* 10600000
         LA    @F,1                                               0264  10610000
         BC    15,@DO9D4                                          0264  10620000
*                                                                       10630000
*          /*         HAS DEV TABLE BEEN CLEARED OUT?           X02906* 10640000
*                                                                       10650000
*          IF CDSDVDSC=0 THEN           /* IF DSCRPTRS FOR DEV=0X02906* 10660000
@DO9D5   CLC   36(4,@8),@D3                                       0265  10670000
*           GO TO CECDV18B;             /* UPDATE TABLE PTR     X02906* 10680000
         BC    08,CECDV18B                                        0266  10690000
*          DEVTABLE=DEVTABXX;           /* OVERLAY WITH GOOD TABX02906* 10700000
         L     @C,AVAILBLE                                        0267  10710000
         MVC   0(56,@C),0(@8)                                     0267  10720000
*          AVAILBLE=AVAILBLE+TABLNGTH;  /* NEXT AVAILABLE DEVTABX02906* 10730000
         LH    @F,TABLNGTH                                        0268  10740000
         A     @F,AVAILBLE                                        0268  10750000
         ST    @F,AVAILBLE                                        0268  10760000
*                                                                       10770000
* CECDV18B:                             /*                      X02906* 10780000
*                                                                       10790000
*          DEVTABPT=DEVTABPT+TABLNGTH;  /*NEXT DEV TABLE IN LISTX02906* 10800000
CECDV18B AH    @8,TABLNGTH                                        0269  10810000
*         END;                          /* END OF GOODENTRY LOOPX02906* 10820000
*                                                                       10830000
*         GOODENT=GOODENT-ERRORTAB;     /* COOD TABLES CTR UPDT X02906* 10840000
         LH    @F,I                                               0270  10850000
         AH    @F,@D1                                             0270  10860000
@DO9D4   STH   @F,I                                               0270  10870000
         CR    @F,@6                                              0270  10880000
         BC    12,@DO9D5                                          0270  10890000
         SH    @6,ERRORTAB                                        0271  10900000
*                                                                       10910000
* CECDEV18:                             /*                      S21052* 10920000
*                                                                       10930000
*         /************************************************************ 10940000
*         /*                                                    S21052* 10950000
*         /*          ARE THERE ANY VALID DEVICE TABLES         S21052* 10960000
*         /*                                                    S21052* 10970000
*         /************************************************************ 10980000
*                                                                       10990000
*         IF GOODENT=0 THEN        /* ANY GOOD DEV TABS BUILT.  S21052* 11000000
CECDEV18 LTR   @6,@6                                              0272  11010000
         BC    07,@9D1                                            0272  11020000
*          DO;                     /* NO,                       S21052* 11030000
*                                                                       11040000
*                                                                       11050000
* CECDEV20:                             /*                      S21052* 11060000
*                                                                       11070000
*           R1=MSGPTR11;           /* POINTER TO MESSAGE.       S21052* 11080000
CECDEV20 L     @1,8(0,@4)                                         0274  11090000
*           GEN(PWTO  REG=(1));                                         11100000
         PWTO  REG=(1)                                                  11110000
         DS    0H                                                       11120000
*           YOURR14=NEXTREC;       /* ALTER RET POINT IN IFDOLT30       11130000
*                                                               S21052* 11140000
         L     @C,4(0,@D)                                         0276  11150000
         MVC   12(4,@C),NEXTREC                                   0276  11160000
*                                                                       11170000
*           /*        CLEAR ALL DEVICE TABLES TO ZERO           S21052* 11180000
*                                                                       11190000
*           DEVTABPT=DEVTBPTR;     /* POINT TO FIRST DEV TABLE. S21052* 11200000
         L     @8,DEVTBPTR                                        0277  11210000
*           RESTRICT(R1);          /* RESTRICT REGISTER FOR MSG.S21052* 11220000
*                                                                       11230000
*           /*        DEV TAB CLEARING OUT PROCEEDURE           S21052* 11240000
*           DO R1 = 16 TO 1                                             11250000
*             BY -1;               /* CLEAR DEVICE TABLES.      S21052* 11260000
         LA    @1,16                                              0279  11270000
*             DEVTABXX=DEVTABXX&&                                       11280000
*              DEVTABXX;           /* CLEAR DEVICE TABLES.      S21052* 11290000
@DO9D0   XC    0(56,@8),0(@8)                                     0280  11300000
*             DEVTABPT=DEVTABPT+TABLNGTH;                               11310000
         AH    @8,TABLNGTH                                        0281  11320000
*           END;                   /* END DEV TABLE CLEARING.   S21052* 11330000
*           RELEASE(R1);           /* RELEASE REGISTER FOR SYSTEM.      11340000
*                                                               S21052* 11350000
         BCT   @1,@DO9D0                                          0282  11360000
*           GO TO CECDEV28;        /* RETURN TO CALLER.         S21052* 11370000
         BC    15,CECDEV28                                        0284  11380000
*          END;                    /* END ZERO VALID ENTRIES LOOP       11390000
*                                                               S21052* 11400000
* CECDEV22:                             /*                      S21052* 11410000
*                                                                       11420000
*         /************************************************************ 11430000
*         /*                                                    S21052* 11440000
*         /*          FILL SECTION CONTROL TABLE WITH DEV TAB DATA      11450000
*         /*                                                    S21052* 11460000
*         /************************************************************ 11470000
*                                                                       11480000
*         IF GOODENT>1                                                  11490000
*          THEN                    /* MORE THAN ONE DEVICE ENTRD.       11500000
*                                                               S21052* 11510000
@9D1     EQU   *                                                  0286  11520000
CECDEV22 CH    @6,@D1                                             0286  11530000
         BC    12,@9CC                                            0286  11540000
*           MORETHN1='1'B;         /* YES, SET FLAG IN COMM AREA.       11550000
*                                                               S21052* 11560000
         OI    EXPGMFLG,B'01000000'                               0287  11570000
         BC    15,@9CB                                            0288  11580000
*          ELSE                    /* ONLY ONE DEVICE ENTERED.  S21052* 11590000
*           MORETHN1='0'B;         /* SET FLAG IN COMM AREA.    S21052* 11600000
@9CC     NI    EXPGMFLG,B'10111111'                               0288  11610000
*         DEVTABPT=DEVTBPTR;       /* REINIT DEVICE TABLE POINTES21052* 11620000
@9CB     L     @8,DEVTBPTR                                        0289  11630000
*         PRIMARY='1'B;            /* SET PRIM FLAG IN DEV TAB. S21052* 11640000
         OI    12(@8),B'01000000'                                 0290  11650000
*         TUCBAD1=UCBADDR;         /* SAVE PRIM DEV UCB ADDR.   S21052* 11660000
         MVC   TUCBAD1(4),8(@8)                                   0291  11670000
*         PRIDVAD=HEXADDR;         /* SAVE PRIM DEV HEX DEV ADDR.       11680000
*                                                               S21052* 11690000
         MVC   SCT+12(4),32(@8)                                   0292  11700000
*         PRIDVFLG=PRIDVFLG|'11'X; /* SET LAST DEV FLGS IN SCT. S21052* 11710000
         OI    SCT+10,X'11'                                       0293  11720000
*                                                                       11730000
*         /*          CHECK DEVICE DESCRIPTORS IN DEVICE TABLE. S21052* 11740000
*         IF CDSDVDSC=0            /* DEV DSCRPTRS = 0. YES,    S21052* 11750000
*          THEN                    /* SET UP TO USE             S21052* 11760000
         CLC   36(4,@8),@D3                                       0294  11770000
         BC    07,@9CA                                            0294  11780000
*           PRIDVDSC=UCBDVDSC;     /* USE UCB DV DSCRPTRS.      S21052* 11790000
         MVC   @TEMP4(4),8(@8)                                    0295  11800000
         L     @1,@TEMP4                                          0295  11810000
         MVC   SCT+16(4),16(@1)                                   0295  11820000
         BC    15,@9C9                                            0296  11830000
*          ELSE                    /* NO,                       S21052* 11840000
*           PRIDVDSC=CDSDVDSC;     /* USE CDS DEVICE DSCRPTRS.  S21052* 11850000
@9CA     MVC   SCT+16(4),36(@8)                                   0296  11860000
*         PRIDVPTR=DEVTABPT;       /* SAVE PRIM DEV PTR.        S21052* 11870000
@9C9     ST    @8,PRIDVPTR                                        0297  11880000
*         DEVDEPAD=ADDR(PRIDVSCT); /* SAVE PRIM SCT DEV ADDR.   S21052* 11890000
         LA    @F,SCT+8                                           0298  11900000
         ST    @F,DEVDEPAD                                        0298  11910000
*                                                                       11920000
*         /*          WAS A REMOTE TERMINAL DEVICE ENTERED      S21052* 11930000
*         IF REMLINE='1'B THEN     /* REMOTE DEV ENTERED. YES,  S21052* 11940000
         TM    41(@8),B'00000001'                                 0299  11950000
         BC    12,@9C8                                            0299  11960000
*          DO;                     /*SET FLAGS TO INDICATE THIS.S21052* 11970000
*           TPFLAG='0'B;           /* NOT A 2702 OR 2703 TCU TEST       11980000
*                                                               S21052* 11990000
         NI    OLTEPSW1,B'11111110'                               0301  12000000
*           GO TO CECDEV24;        /* GO ON TO EXIT ROUTINE.    S21052* 12010000
         BC    15,CECDEV24                                        0302  12020000
*          END;                    /* END REMOTE DEV SET UP.    S21052* 12030000
*                                                                       12040000
*         /*          CHECK COMMON AREA TEST NAME SAVE AREA     S21052* 12050000
*                                                                       12060000
*                                                                       12070000
*                                                                       12080000
*         /* GO TO CECDEV24,SKIP 2702,3 TESTS,NO SET TPFLAG.    X03008* 12090000
*                                                                       12100000
*                                                                       12110000
*                                                                       12120000
*          GO TO CECDEV24;         /* IS IT A 2701,2702, OR 2703.       12130000
*                                                               S21052* 12140000
         BC    15,CECDEV24                                        0304  12150000
*                                                                       12160000
*         /*          2701 CONTROL UNIT TEST CHECK              S21052* 12170000
*         IF TPSAVE3='1' THEN      /* YES, A 2701 TEST.         S21052* 12180000
         CLI   TPSAV+3,C'1'                                       0305  12190000
*           GO TO CECDEV24;        /* NO, IT IS A 2702,2703 TEST.       12200000
*                                                               S21052* 12210000
         BC    08,CECDEV24                                        0306  12220000
*                                                                       12230000
*         /*          2702, 2703 C U TESTS REQUIRE ATLEAST 2 LINES      12240000
*                                                               S21052* 12250000
*         IF GOODENT^>1 THEN       /* ATLEAST 2 LINES ENTERED.  S21052* 12260000
         CH    @6,@D1                                             0307  12270000
         BC    02,@9C7                                            0307  12280000
*          DO;                     /* NO, AN ERROR CONDITION.   S21052* 12290000
*           DEVTABXX=DEVTABXX&&DEVTABXX;                                12300000
         XC    0(56,@8),0(@8)                                     0309  12310000
*           GO TO CECDEV20;        /* CLEAR DEV TAB AND AND EXIT.       12320000
*                                                               S21052* 12330000
         BC    15,CECDEV20                                        0310  12340000
*          END;                    /* END INVALID ENTRY LOOP.   S21052* 12350000
*         TPFLAG='1'B;             /* SET FLAG, VALID TCU TEST. S21052* 12360000
@9C7     OI    OLTEPSW1,B'00000001'                               0312  12370000
*                                                                       12380000
*         /*          UPDATE DEVICE TABLE POINTER.              S21052* 12390000
*         DEVTABPT=DEVTBPTR+TABLNGTH;                                   12400000
         LH    @8,TABLNGTH                                        0313  12410000
         A     @8,DEVTBPTR                                        0313  12420000
*         SECDVAD=HEXADDR;         /* SAVE SECOND DEV ADDR IN C A       12430000
*                                                               S21052* 12440000
         MVC   SCT+24(4),32(@8)                                   0314  12450000
*         TUCBAD2=UCBADDR;         /* SAVE SECOND DEV UCB ADDR .S21052* 12460000
         MVC   TUCBAD2(4),8(@8)                                   0315  12470000
*         SECDVFLG=SECDVFLG|'11'X; /* SET LAST DEV FLAGS IN SCT.S21052* 12480000
         OI    SCT+22,X'11'                                       0316  12490000
*                                                                       12500000
*         /*          USE CDS OR UCB DEVICE DESCRIPTORS         S21052* 12510000
*         IF CDSDVDSC=0            /* DEV DSCRPTRS = 0. YES,    S21052* 12520000
*          THEN                    /* SET UP TO USE             S21052* 12530000
         CLC   36(4,@8),@D3                                       0317  12540000
         BC    07,@9C6                                            0317  12550000
*           SECDVDSC=UCBDVDSC;     /* USE UCB DV DSCRPTRS.      S21052* 12560000
         MVC   @TEMP4(4),8(@8)                                    0318  12570000
         L     @1,@TEMP4                                          0318  12580000
         MVC   SCT+28(4),16(@1)                                   0318  12590000
         BC    15,@9C5                                            0319  12600000
*          ELSE                    /* NO,                       S21052* 12610000
*           SECDVDSC=CDSDVDSC;     /* USE CDS DEVICE DSCRPTRS.  S21052* 12620000
@9C6     MVC   SCT+28(4),36(@8)                                   0319  12630000
*         DEVDEPAD=ADDR(SECDVSCT); /* SAVE SECOND SCT DEV ADDR. S21052* 12640000
@9C5     LA    @F,SCT+20                                          0320  12650000
         ST    @F,DEVDEPAD                                        0320  12660000
*         PRIDVFLG=PRIDVFLG&'EE'X; /* CLEAR PRIM LAST DEV FLAGS.S21052* 12670000
         NI    SCT+10,X'EE'                                       0321  12680000
* CECDEV24:                             /*                      S21052* 12690000
*                                                                       12700000
*         /************************************************************ 12710000
*         /*                                                    S21052* 12720000
*         /*                      EXIT ROUTINE                  S21052* 12730000
*         /*                                                    S21052* 12740000
*         /************************************************************ 12750000
*                                                                       12760000
*         UNITCTR=GOODENT;         /* SAVE UNIT COUNTER.        S21052* 12770000
CECDEV24 STH   @6,X                                               0322  12780000
*         UNICTR=UNITCTR1;         /* SAVE VALUE IN COMMON AREA.S21052* 12790000
         MVC   UNICTR(1),X+1                                      0323  12800000
*         UNITUSE='00'X;           /* INIT UNITS TESTED COUNTER.S21052* 12810000
         MVI   UNITUSE,X'00'                                      0324  12820000
*         LEGALDEV='1'B;           /* VALID DEVICE(S) ENTERED FLAG      12830000
*                                                               S21052* 12840000
         OI    OLTEPSW,B'00001000'                                0325  12850000
*         INBUFPTR=R5;             /* SAVE INPUT BUFFER POINTER.S21052* 12860000
         ST    @5,INBUFPTR                                        0326  12870000
*         GO TO CECDEV28;          /* VALID DEVICE DECODE.      S21052* 12880000
         BC    15,CECDEV28                                        0327  12890000
*                                                                       12900000
*                                                                       12910000
* CECDEV26:                             /*                      S21052* 12920000
*                                                                       12930000
*         /************************************************************ 12940000
*         /*                                                    S21052* 12950000
*         /*          CHANGE RETURN POINT, REDEFINE TEST        S21052* 12960000
*         /*                                                    S21052* 12970000
*         /************************************************************ 12980000
*                                                                       12990000
*         YOURR14=REDEFINE;        /* ALTER RET POINT IN IFDOLT30       13000000
*                                                               S21052* 13010000
CECDEV26 L     @1,4(0,@D)                                         0328  13020000
         MVC   12(4,@1),REDEFINE                                  0328  13030000
*         R8=DEVTBPTR;             /* DEVICE TABLES             X03008* 13040000
         L     @8,DEVTBPTR                                        0329  13050000
*         DO R9=TABLNGTH BY -1 TO 1; /* TABLE LENGTH            X03008* 13060000
         LH    @9,TABLNGTH                                        0330  13070000
         LTR   @9,@9                                              0330  13080000
         BC    12,@DO9C3                                          0330  13090000
*           DVT=DVT&&DVT;          /* ZERO TABLE AREA           X03008* 13100000
@DO9C4   XC    0(16,@8),0(@8)                                     0331  13110000
*           R8=ADDR(DVTN);         /* NEXT TABLE AREA           X03008* 13120000
         LA    @8,16(0,@8)                                        0332  13130000
*         END;                     /* ZERO TOTAL TABLE          X03008* 13140000
*         LEGALDEV='0'B;           /* NO LEGAL DEVICES          X03008* 13150000
         BCT   @9,@DO9C4                                          0333  13160000
@DO9C3   NI    OLTEPSW,B'11110111'                                0334  13170000
*                                                                       13180000
*                                                                       13190000
* CECDEV28:                             /*                      S21052* 13200000
*                                                                       13210000
*         /************************************************************ 13220000
*         /*                                                    S21052* 13230000
*         /*          RETURN TO CALLER                          S21052* 13240000
*         /*                                                    S21052* 13250000
*         /************************************************************ 13260000
*                                                                       13270000
*         DPMSGREI='0'B;                /* TURN OFF REM MSG FLG XM0097* 13280000
CECDEV28 NI    A00014,B'11111110'                                 0335  13290000
*         RETURN;                  /* RETURN TO CALLER          S21052* 13300000
*         END;                     /* END IFDOLT61.             S21052* 13310000
@EL01    L     @D,4(0,@D)                                         0337  13320000
         LM    @E,@C,12(@D)                                       0337  13330000
         BCR   15,@E                                              0337  13340000
@DATA1   EQU   *                                                        13350000
@0       EQU   00                  EQUATES FOR REGISTERS 0-15           13360000
@1       EQU   01                                                       13370000
@2       EQU   02                                                       13380000
@3       EQU   03                                                       13390000
@4       EQU   04                                                       13400000
@5       EQU   05                                                       13410000
@6       EQU   06                                                       13420000
@7       EQU   07                                                       13430000
@8       EQU   08                                                       13440000
@9       EQU   09                                                       13450000
@A       EQU   10                                                       13460000
@B       EQU   11                                                       13470000
@C       EQU   12                                                       13480000
@D       EQU   13                                                       13490000
@E       EQU   14                                                       13500000
@F       EQU   15                                                       13510000
@D3      DC    F'0'                                                     13520000
@D1      DC    H'1'                                                     13530000
@D2      DC    H'16'                                                    13540000
@V1      DC    V(IFDMSG61)                                              13550000
         DS    0F                                                       13560000
@C12     DC    C'ONLINE ,'                                              13570000
@C13     DC    C'OFFLINE,'                                              13580000
@C21     DC    C'SOSPC/'                                                13590000
@C14     DC    C'ALLOCATED  '                                           13600000
@C15     DC    C'UNALLOCATED'                                           13610000
@C22     DC    C'270'                                                   13620000
         DS    0D                                                       13630000
@DATA    EQU   *                                                        13640000
@SAV001  EQU   @DATA+00000000      72 BYTE(S) ON WORD                   13650000
R0       EQU   00000000            FULLWORD POINTER REGISTER            13660000
R1       EQU   00000001            3  BYTE  POINTER REGISTER            13670000
R2       EQU   00000002            FULLWORD POINTER REGISTER            13680000
R3       EQU   00000003            FULLWORD POINTER REGISTER            13690000
R4       EQU   00000004            FULLWORD POINTER REGISTER            13700000
R5       EQU   00000005            FULLWORD POINTER REGISTER            13710000
GOODENT  EQU   00000006            FULLWORD POINTER REGISTER            13720000
UCBLOOK  EQU   00000007            FULLWORD POINTER REGISTER            13730000
DEVTABPT EQU   00000008            FULLWORD POINTER REGISTER            13740000
R8       EQU   00000008            FULLWORD POINTER REGISTER            13750000
R9       EQU   00000009            3  BYTE  POINTER REGISTER            13760000
R13      EQU   00000013            FULLWORD POINTER REGISTER            13770000
R14      EQU   00000014            FULLWORD POINTER REGISTER            13780000
RC       EQU   00000015            FULLWORD POINTER REGISTER            13790000
R15      EQU   00000015            FULLWORD POINTER REGISTER            13800000
MYSAVE   EQU   00000000            8 BYTE(S) ON WORD                    13810000
A00000   EQU   MYSAVE+00000000     4 BYTE(S)                            13820000
YOURR13  EQU   MYSAVE+00000004     FULLWORD POINTER                     13830000
YOURSAVE EQU   00000000            16 BYTE(S) ON WORD                   13840000
A00001   EQU   YOURSAVE+00000000   12 BYTE(S)                           13850000
YOURR14  EQU   YOURSAVE+00000012   FULLWORD POINTER                     13860000
INPUTBUF EQU   00000000            10 BYTE(S)                           13870000
DEVTABXX EQU   00000000            56 BYTE(S)                           13880000
DEVADDR  EQU   DEVTABXX+00000000   8 BYTE(S)                            13890000
UCBADDR  EQU   DEVTABXX+00000008   4  BYTE  POINTER                     13900000
FLG1     EQU   DEVTABXX+00000012   1 BYTE(S)                            13910000
ONOFF    EQU   DEVTABXX+00000012   1 BIT(S)                             13920000
PRIMARY  EQU   DEVTABXX+00000012   1 BIT(S)                             13930000
A00017   EQU   DEVTABXX+00000013   1 BYTE(S)                            13940000
FLG3     EQU   DEVTABXX+00000014   1 BYTE(S)                            13950000
ANRNOTST EQU   DEVTABXX+00000014   1 BIT(S)                             13960000
A00018   EQU   DEVTABXX+00000014   3 BIT(S)                             13970000
NOTEST   EQU   DEVTABXX+00000014   1 BIT(S)                             13980000
SYSALLOC EQU   DEVTABXX+00000014   1 BIT(S)                             13990000
A00019   EQU   DEVTABXX+00000015   1 BYTE(S)                            14000000
A00020   EQU   DEVTABXX+00000016   16 BYTE(S)                           14010000
HEXADDR  EQU   DEVTABXX+00000032   4 BYTE(S)                            14020000
CDSDVDSC EQU   DEVTABXX+00000036   4 BYTE(S)                            14030000
MODEL    EQU   DEVTABXX+00000036   1 BYTE(S)                            14040000
FEATURES EQU   DEVTABXX+00000037   1 BYTE(S)                            14050000
CLASS    EQU   DEVTABXX+00000038   1 BYTE(S)                            14060000
TYPE     EQU   DEVTABXX+00000039   1 BYTE(S)                            14070000
BYTECNT  EQU   DEVTABXX+00000040   1 BYTE(S)                            14080000
CDSFLAGS EQU   DEVTABXX+00000041   1 BYTE(S)                            14090000
A00021   EQU   DEVTABXX+00000041   4 BIT(S)                             14100000
SYMDEVIC EQU   DEVTABXX+00000041   1 BIT(S)                             14110000
A00022   EQU   DEVTABXX+00000041   2 BIT(S)                             14120000
REMLINE  EQU   DEVTABXX+00000041   1 BIT(S)                             14130000
EXTSGMSK EQU   DEVTABXX+00000042   2 BYTE(S)                            14140000
SYMNAME  EQU   DEVTABXX+00000044   8 BYTE(S)                            14150000
MSGPTR   EQU   00000000            24 BYTE(S) ON WORD                   14160000
MSGPTR09 EQU   MSGPTR+00000000     FULLWORD POINTER                     14170000
MSGPTR10 EQU   MSGPTR+00000004     FULLWORD POINTER                     14180000
MSGPTR11 EQU   MSGPTR+00000008     FULLWORD POINTER                     14190000
MSGPTR14 EQU   MSGPTR+00000012     FULLWORD POINTER                     14200000
MSGPTR27 EQU   MSGPTR+00000016     FULLWORD POINTER                     14210000
MSGPTR54 EQU   MSGPTR+00000020     FULLWORD POINTER                     14220000
MSG109   EQU   00000000            40 BYTE(S) ON WORD                   14230000
A00023   EQU   MSG109+00000000     12 BYTE(S)                           14240000
MSG109I  EQU   MSG109+00000012     28 BYTE(S)                           14250000
MSG154   EQU   00000000            72 BYTE(S) ON WORD                   14260000
A00024   EQU   MSG154+00000000     12 BYTE(S)                           14270000
MSG154I  EQU   MSG154+00000012     60 BYTE(S)                           14280000
MSG127   EQU   00000000            31 BYTE(S) ON WORD                   14290000
A00025   EQU   MSG127+00000000     12 BYTE(S)                           14300000
MSG127I  EQU   MSG127+00000012     19 BYTE(S)                           14310000
A00027   EQU   00000000            32 BYTE(S) ON WORD                   14320000
DVT      EQU   A00027+00000000     16 BYTE(S)                           14330000
DVTN     EQU   A00027+00000016     16 BYTE(S)                           14340000
AVAILBLE EQU   @DATA+00000072      FULLWORD POINTER                     14350000
DEVTABLE EQU   00000000            56 BYTE(S)                           14360000
LIMIT    EQU   @DATA+00000076      HALFWORD INTEGER                     14370000
X        EQU   @DATA+00000078      HALFWORD INTEGER                     14380000
UNITCTR  EQU   X+00000000          HALFWORD INTEGER                     14390000
A00029   EQU   X+00000000          1 BYTE(S)                            14400000
UNITCTR1 EQU   X+00000001          1 BYTE(S)                            14410000
ERRORTAB EQU   @DATA+00000080      HALFWORD INTEGER                     14420000
X1       EQU   @DATA+00000082      HALFWORD INTEGER                     14430000
COUNT    EQU   @DATA+00000084      HALFWORD INTEGER                     14440000
I        EQU   @DATA+00000086      HALFWORD INTEGER                     14450000
ERRCODE  EQU   @DATA+00000088      2 BYTE(S)                            14460000
GRAPHICS EQU   @DATA+00000092      56 BYTE(S) ON WORD                   14470000
EBADDR   EQU   GRAPHICS+00000000   8 BYTE(S)                            14480000
A00030   EQU   GRAPHICS+00000000   7 BYTE(S)                            14490000
DEVICE   EQU   GRAPHICS+00000007   1 BYTE(S)                            14500000
A00031   EQU   GRAPHICS+00000008   4 BYTE(S)                            14510000
FLAG     EQU   GRAPHICS+00000012   1 BYTE(S)                            14520000
OFF      EQU   GRAPHICS+00000012   1 BIT(S)                             14530000
         ORG   @DATA+00000148                                           14540000
NUMBERS  EQU   *                   16 BYTE(S)                           14550000
         DC    C'0123456789ABCDEF'                                      14560000
NUMBER   EQU   00000000            1 BYTE(S)                            14570000
DEVAD    EQU   *                   8 BYTE(S)                            14580000
         DC    C'00000000'                                              14590000
DEVAD1   EQU   DEVAD+00000000      8 BYTE(S)                            14600000
SWITCHES EQU   @DATA+00000172      1 BYTE(S)                            14610000
FRSTPASS EQU   SWITCHES+00000000   1 BIT(S)                             14620000
PARMLIST EQU   @DATA+00000176      16 BYTE(S) ON WORD                   14630000
MODNAME  EQU   PARMLIST+00000000   8 BYTE(S)                            14640000
         ORG   PARMLIST+00000000                                        14650000
TCDSO    EQU   *                   1 BYTE(S)                            14660000
         DC    C'G'                                                     14670000
CDSDEV   EQU   PARMLIST+00000001   7 BYTE(S)                            14680000
TARGETAD EQU   PARMLIST+00000008   FULLWORD POINTER                     14690000
PARMFLGS EQU   PARMLIST+00000012   1 BYTE(S)                            14700000
A00032   EQU   PARMLIST+00000013   1 BYTE(S)                            14710000
CDSLNGTH EQU   PARMLIST+00000014   HALFWORD INTEGER                     14720000
UCBDVDSC EQU   00000016            4 BYTE(S)                            14730000
UCBMODEL EQU   UCBDVDSC+00000000   1 BYTE(S)                            14740000
UCBFEAT  EQU   UCBDVDSC+00000001   1 BYTE(S)                            14750000
A00033   EQU   UCBDVDSC+00000001   2 BIT(S)                             14760000
SHAREDDV EQU   UCBDVDSC+00000001   1 BIT(S)                             14770000
A00034   EQU   UCBDVDSC+00000001   5 BIT(S)                             14780000
UCBCLASS EQU   UCBDVDSC+00000002   1 BYTE(S)                            14790000
UCBTYPE  EQU   UCBDVDSC+00000003   1 BYTE(S)                            14800000
CDSENTRY EQU   00000000            20 BYTE(S)                           14810000
A00035   EQU   CDSENTRY+00000000   4 BYTE(S)                            14820000
DSCRPTRS EQU   CDSENTRY+00000004   4 BYTE(S)                            14830000
TPCLASS  EQU   @DATA+00000192      FULLWORD INTEGER                     14840000
         ORG   @DATA                                                    14850000
         DS    00000196C                                                14860000
@TEMPS   DS    0F                                                       14870000
@TEMP4   DC    F'0'                                                     14880000
DEVCOMM  IFDCOM                   COMMON AREA DSECT                     14890000
SCT      EQU   CHASCT+00000000     32 BYTE(S) ON WORD                   14900000
HEADER   EQU   SCT+00000000        8 BYTE(S)                            14910000
PRIDVSCT EQU   SCT+00000008        12 BYTE(S)                           14920000
A00002   EQU   SCT+00000008        2 BYTE(S)                            14930000
PRIDVFLG EQU   SCT+00000010        1 BYTE(S)                            14940000
A00003   EQU   SCT+00000011        1 BYTE(S)                            14950000
PRIDVAD  EQU   SCT+00000012        4 BYTE(S)                            14960000
A00004   EQU   SCT+00000012        2 BYTE(S)                            14970000
PRIHEXAD EQU   SCT+00000014        2 BYTE(S)                            14980000
PRIDVDSC EQU   SCT+00000016        4 BYTE(S)                            14990000
SECDVSCT EQU   SCT+00000020        12 BYTE(S)                           15000000
A00005   EQU   SCT+00000020        2 BYTE(S)                            15010000
SECDVFLG EQU   SCT+00000022        1 BYTE(S)                            15020000
A00006   EQU   SCT+00000023        1 BYTE(S)                            15030000
SECDVAD  EQU   SCT+00000024        4 BYTE(S)                            15040000
A00007   EQU   SCT+00000024        2 BYTE(S)                            15050000
SECHEXAD EQU   SCT+00000026        2 BYTE(S)                            15060000
SECDVDSC EQU   SCT+00000028        4 BYTE(S)                            15070000
OLTEPSW  EQU   CESWT+00000000      1 BYTE(S) ON WORD                    15080000
A00008   EQU   OLTEPSW+00000000    4 BIT(S)                             15090000
LEGALDEV EQU   OLTEPSW+00000000    1 BIT(S)                             15100000
REINT    EQU   OLTEPSW+00000000    1 BIT(S)                             15110000
OLTEPSW1 EQU   CESWT1+00000000     1 BYTE(S) ON WORD                    15120000
A00009   EQU   OLTEPSW1+00000000   6 BIT(S)                             15130000
ONLINETP EQU   OLTEPSW1+00000000   2 BIT(S)                             15140000
ONLINEOK EQU   OLTEPSW1+00000000   1 BIT(S)                             15150000
TPFLAG   EQU   OLTEPSW1+00000000   1 BIT(S)                             15160000
OLTEPSW2 EQU   CESWT2+00000000     1 BYTE(S) ON WORD                    15170000
A00010   EQU   OLTEPSW2+00000000   3 BIT(S)                             15180000
CHANTEST EQU   OLTEPSW2+00000000   1 BIT(S)                             15190000
A00011   EQU   OLTEPSW2+00000000   1 BIT(S)                             15200000
NDR      EQU   OLTEPSW2+00000000   1 BIT(S)                             15210000
OLTEPSW7 EQU   CESWT7+00000000     1 BYTE(S) ON WORD                    15220000
INCLST   EQU   OLTEPSW7+00000000   1 BIT(S)                             15230000
RETTO31  EQU   OLTEPSW7+00000000   1 BIT(S)                             15240000
A00012   EQU   CESWTR+00000000     1 BYTE(S) ON WORD                    15250000
RETAINAC EQU   A00012+00000000     1 BIT(S)                             15260000
A00013   EQU   A00012+00000000     1 BIT(S)                             15270000
REMNOMSG EQU   A00012+00000000     1 BIT(S)                             15280000
A00014   EQU   CESWTR2+00000000    1 BYTE(S) ON WORD                    15290000
A00015   EQU   A00014+00000000     7 BIT(S)                             15300000
DPMSGREI EQU   A00014+00000000     1 BIT(S)                             15310000
SVCPLIST EQU   ROPT-00000004       12 BYTE(S) ON WORD                   15320000
A00016   EQU   SVCPLIST+00000000   2 BYTE(S)                            15330000
MODNUM   EQU   SVCPLIST+00000002   2 BYTE(S)                            15340000
ADDRDEV  EQU   SVCPLIST+00000004   FULLWORD POINTER                     15350000
ENTRIES  EQU   SVCPLIST+00000008   FULLWORD INTEGER                     15360000
TPSAV    EQU   TPSAVE+00000000     4 BYTE(S)                            15370000
A00026   EQU   TPSAV+00000000      3 BYTE(S)                            15380000
TPSAVE3  EQU   TPSAV+00000003      1 BYTE(S)                            15390000
EXPGMFLG EQU   CHASCT+00000033     1 BYTE(S)                            15400000
A00028   EQU   EXPGMFLG+00000000   1 BIT(S)                             15410000
MORETHN1 EQU   EXPGMFLG+00000000   1 BIT(S)                             15420000
FRSTINCL EQU   SAVENT+00000000     HALFWORD INTEGER                     15430000
LASTINCL EQU   SAVENT+00000002     HALFWORD INTEGER                     15440000
@DATEND  EQU   *                                                        15450000
@9FD     EQU   CECDEV14                                                 15460000
@9E6     EQU   CECDEV12                                                 15470000
@9E5     EQU   CECDEV12                                                 15480000
@9E7     EQU   CECDEV14                                                 15490000
@9C8     EQU   CECDEV24                                                 15500000
         END    ,(C'PL/S',1400,78045)                                   15510000
