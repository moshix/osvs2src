         TITLE 'IFDOLT62 CPU AFFINITY                                  *00001000
                        '                                               00002000
IFDOLT62 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IFDOLT62  74.033'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @05,@SA00001                                        0001 00015000
         ST    @05,8(,@13)                                         0001 00016000
         LR    @13,@05                                             0001 00017000
*                                                                    */ 00018000
*                                                                  0020 00019000
*   /*****************************************************************/ 00020000
*   /*                                                               */ 00021000
*   /* INITIALIZATION                                                */ 00022000
*   /*                                                               */ 00023000
*   /*****************************************************************/ 00024000
*                                                                  0020 00025000
*   INTAL='00'X;                    /* CLEAR INTERNAL SWITHES        */ 00026000
         MVI   INTAL,X'00'                                         0020 00027000
*   LOOPCNT='00'X;                  /* SET LOOP CONTROL TO ZERO      */ 00028000
         SLR   LOOPCNT,LOOPCNT                                     0021 00029000
*   SELDEFLP='0'B;                  /* SET DEFAULT CPU 0 LOOP        */ 00030000
         NI    SELDEFLP,B'01111111'                                0022 00031000
*   IF VERBCALL='1'B THEN           /* IS THIS A VERB FROM 105D      */ 00032000
         TM    VERBCALL(COMMAPT),B'00100000'                       0023 00033000
         BO    @RT00023                                            0023 00034000
*     GOTO CPUAFN5A;                /* YES, PROCESS IFD105D REPLY    */ 00035000
*CPUAFN01:                          /* NO.                           */ 00036000
*                                                                  0025 00037000
*   /*****************************************************************/ 00038000
*   /*                                                               */ 00039000
*   /* SETUP SELECT CPU 0 AFN                                        */ 00040000
*   /*                                                               */ 00041000
*   /*****************************************************************/ 00042000
*                                                                  0025 00043000
*   SELAFFN='8000'X;                /* SET AFFINITY TO MASK CPU'S    */ 00044000
CPUAFN01 MVC   SELAFFN(2,COMMAPT),@CB00361                         0025 00045000
*   CHARAFFN='00';                  /* SET CHARACTER FOR PRINT       */ 00046000
         MVC   CHARAFFN(2,COMMAPT),@CC00363                        0026 00047000
*   LOOPCNT=LOOPCNT+'01'X;          /* ADD ONE TO LOOP CONTROL       */ 00048000
         AH    LOOPCNT,@CH00364                                    0027 00049000
*CPUAFN02:                                                         0028 00050000
*                                                                  0028 00051000
*   /*****************************************************************/ 00052000
*   /*                                                               */ 00053000
*   /* SET UP SVC 59 CALL AFFNITY                                    */ 00054000
*   /*                                                               */ 00055000
*   /*****************************************************************/ 00056000
*                                                                  0028 00057000
*   R0=ADDR(ROPT);                  /* SET POINTER TO PARM LIST      */ 00058000
CPUAFN02 LA    R0,ROPT(,COMMAPT)                                   0028 00059000
*   R1='60'X;                       /* SET FUNCTION CALL CODE        */ 00060000
         LA    R1,96                                               0029 00061000
*   ROPT=ADDR(SELAFFN);             /* SET POINTER TO CPU IN LIST    */ 00062000
         LA    @05,SELAFFN(,COMMAPT)                               0030 00063000
         ST    @05,ROPT(,COMMAPT)                                  0030 00064000
*   GEN(SVC   59);                  /* ISSUE SVC 59                  */ 00065000
         SVC   59                                                       00066000
*   IF RETCODE='00'X THEN           /* HAS CPU AFFINITY BEEN SET     */ 00067000
         LTR   RETCODE,RETCODE                                     0032 00068000
         BZ    @RT00032                                            0032 00069000
*     GOTO CPUAFN09;                /* YES, READY TO EXIT            */ 00070000
*   IF RETCODE='04'X THEN           /* NO, WAS CPU NOT AVAILABLE     */ 00071000
         CH    RETCODE,@CH00369                                    0034 00072000
         BE    @RT00034                                            0034 00073000
*     GOTO CPUAFN03;                /* YES,PROCESS FOR MSG           */ 00074000
*   IF RETCODE='08'X THEN           /* NO, WAS VARY CPU/CHAN IN      */ 00075000
         CH    RETCODE,@CH00371                                    0036 00076000
         BE    @RT00036                                            0036 00077000
*     GOTO CPUAFN05;                /* YES, PROCESS SYS RES MSG      */ 00078000
*   GOTO CPUAFN05;                  /* NO, PROCESS OTHER RETURN    0038 00079000
*                                                                    */ 00080000
         B     CPUAFN05                                            0038 00081000
*CPUAFN03:                                                         0039 00082000
*                                                                  0039 00083000
*   /*****************************************************************/ 00084000
*   /*                                                               */ 00085000
*   /* CPU SELECTED NOT AVAILABLE                                    */ 00086000
*   /*                                                               */ 00087000
*   /*****************************************************************/ 00088000
*                                                                  0039 00089000
*   IF VERBCALL='1'B THEN           /* WAS THIS A SELECTED AFFN      */ 00090000
CPUAFN03 TM    VERBCALL(COMMAPT),B'00100000'                       0039 00091000
         BNO   @RF00039                                            0039 00092000
*     DO;                           /* YES, ISSUE CPU NOT AVAIL      */ 00093000
*       R1=IFD262I;                 /* GET ADDR MSG IFD262I          */ 00094000
         LA    @05,IFDMSG62                                        0041 00095000
         L     R1,IFD262I(,@05)                                    0041 00096000
*       R15=PARPRADR;               /* GET PARALLEL PRINT ADDR       */ 00097000
         L     R15,PARPRADR(,COMMAPT)                              0042 00098000
*       R15=6+R15;                  /* ENTRY POINT TO DPRINT         */ 00099000
         AH    R15,@CH00112                                        0043 00100000
*       GEN(BALR  14,15);           /* LINK TO MODULE                */ 00101000
         BALR  14,15                                                    00102000
*       GOTO CPUAFN08;              /* NOW ISSUE REQUEST FOR AFFN    */ 00103000
         B     CPUAFN08                                            0045 00104000
*     END;                          /* OR DEFAULT                    */ 00105000
*   IF SELDEFLP='1'B THEN           /* IS THIS DEFAULT LOOP CPU1     */ 00106000
@RF00039 TM    SELDEFLP,B'10000000'                                0047 00107000
         BNO   @RF00047                                            0047 00108000
*     DO;                           /* YES                           */ 00109000
*       IF LOOPCNT>'0020'X THEN     /* HAS LOOP COUNT REACHED MAX    */ 00110000
         CL    LOOPCNT,@CF00375                                    0049 00111000
         BNH   @RF00049                                            0049 00112000
*         DO;                       /* YES                           */ 00113000
*           R1=IFD899I;             /* GET ADDR MSG IFD262I          */ 00114000
         LA    @03,IFDMSG62                                        0051 00115000
         L     R1,IFD899I(,@03)                                    0051 00116000
*           MSGRETCD='05';          /* SET RETURN CODE FOR MSG       */ 00117000
         MVC   MSGRETCD(2,R1),@CC00376                             0052 00118000
*           R15=PARPRADR;           /* GET PARALLEL PRINT ADDR       */ 00119000
         L     R15,PARPRADR(,COMMAPT)                              0053 00120000
*           R15=6+R15;              /* ENTRY POINT TO DPRINT         */ 00121000
         AH    R15,@CH00112                                        0054 00122000
*           GEN(BALR  14,15);       /* LINK TO MODULE                */ 00123000
         BALR  14,15                                                    00124000
*           R0=ADDR(ROPT);          /* SET POINTER TO PARMLIST       */ 00125000
         LA    R0,ROPT(,COMMAPT)                                   0056 00126000
*           R1='14'X;               /* SET SVC CALL FUNCTION         */ 00127000
         LA    R1,20                                               0057 00128000
*           GEN(SVC 59);            /* ISSUE SVC 59 FOR CLEAN-UP     */ 00129000
         SVC 59                                                         00130000
*           AFFNSET='0'B;           /* INDICATE NO AFFINITY SET      */ 00131000
         NI    AFFNSET(COMMAPT),B'10111111'                        0059 00132000
*           GOTO CPUAFN10;          /* EXIT THIS FUNCTION            */ 00133000
         B     CPUAFN10                                            0060 00134000
*         END;                      /* YES                           */ 00135000
*       SELDEFLP='0'B;              /* SET DEFAULT LOOP CPU 0        */ 00136000
@RF00049 NI    SELDEFLP,B'01111111'                                0062 00137000
*       GOTO CPUAFN01;              /* SET UP FOR AFFINITY CPU 0     */ 00138000
         B     CPUAFN01                                            0063 00139000
*     END;                          /* NO                            */ 00140000
*CPUAFN04:                                                         0065 00141000
*                                                                  0065 00142000
*   /*****************************************************************/ 00143000
*   /*                                                               */ 00144000
*   /* SETUP FOR CPU 1 AFFINITY                                      */ 00145000
*   /*                                                               */ 00146000
*   /*****************************************************************/ 00147000
*                                                                  0065 00148000
*   SELAFFN='4000'X;                /* SET CPU AFFN MASK CPU 1       */ 00149000
@RF00047 DS    0H                                                  0065 00150000
CPUAFN04 MVC   SELAFFN(2,COMMAPT),@CB00380                         0065 00151000
*   CHARAFFN='01';                  /* SET CHARACTER FOR PRINT       */ 00152000
         MVC   CHARAFFN(2,COMMAPT),@CC00382                        0066 00153000
*   SELDEFLP='1'B;                  /* SET DEFAULT LOOP CPU 1        */ 00154000
         OI    SELDEFLP,B'10000000'                                0067 00155000
*   LOOPCNT=LOOPCNT+'01'X;          /* ADD ONE TO LOOP CONTROL       */ 00156000
         AH    LOOPCNT,@CH00364                                    0068 00157000
*   GOTO CPUAFN02;                  /* ISSUE SVC 59 TO SET AFFN    0069 00158000
*                                                                    */ 00159000
         B     CPUAFN02                                            0069 00160000
*CPUAFN05:                                                         0070 00161000
*                                                                  0070 00162000
*   /*****************************************************************/ 00163000
*   /*                                                               */ 00164000
*   /* SYSTEM RESOURCE IN USE                                        */ 00165000
*   /*                                                               */ 00166000
*   /*****************************************************************/ 00167000
*                                                                  0070 00168000
*   ECB=ECB&&ECB;                   /* CLEAR ECB FOR WTOR            */ 00169000
CPUAFN05 XC    ECB(4),ECB                                          0070 00170000
*   RPLYBUF(1)=' ';                 /* CLEAR INPUT MSG AREA WITH     */ 00171000
         MVI   RPLYBUF,C' '                                        0071 00172000
*   RPLYBUF(2:12)=RPLYBUF(1);       /* THIS CODE               YM7207*/ 00173000
         MVI   RPLYBUF+2,C' '                                      0072 00174000
         MVC   RPLYBUF+3(9),RPLYBUF+2                              0072 00175000
         MVC   RPLYBUF+1(1),RPLYBUF                                0072 00176000
*   R1=IFD264D;                     /* SET PTR TO MSG IFD264D        */ 00177000
         LA    @05,IFDMSG62                                        0073 00178000
         L     R1,IFD264D(,@05)                                    0073 00179000
*   IF RETAINAC='1'B THEN           /* IF REI IS ACTIVE              */ 00180000
         TM    RETAINAC(COMMAPT),B'10000000'                       0074 00181000
         BNO   @RF00074                                            0074 00182000
*     DPMSGREI='1'B;                /* NO REI REPLY ALLOWED          */ 00183000
         OI    DPMSGREI(COMMAPT),B'00000001'                       0075 00184000
*   R15=PARPRADR;                   /* GET PP ADDRESS                */ 00185000
@RF00074 L     R15,PARPRADR(,COMMAPT)                              0076 00186000
*   R15=24+R15;                     /* ENTRY POINT TO DPRINT         */ 00187000
         AH    R15,@CH00068                                        0077 00188000
*   GEN(BALR  14,15);               /* LINK TO MODULE                */ 00189000
         BALR  14,15                                                    00190000
*   RBUFPTR=BUFPTR62;               /* SET MAP BASE POINTER          */ 00191000
         L     RBUFPTR,BUFPTR62                                    0079 00192000
*   IF VERBS(1:3)='CAN' THEN        /* IS THE REPLY CAN              */ 00193000
         CLC   VERBS(3,RBUFPTR),@CC00385                           0080 00194000
         BNE   @RF00080                                            0080 00195000
*     DO;                           /* YES,SET UP TO CLEAN UP        */ 00196000
*       R0=ADDR(ROPT);              /* SET POINTER TO PARMLIST       */ 00197000
         LA    R0,ROPT(,COMMAPT)                                   0082 00198000
*       R1='14'X;                   /* SET SVC CALL FUNCTION         */ 00199000
         LA    R1,20                                               0083 00200000
*       GEN(SVC 59);                /* ISSUE SVC 59 FOR CLEAN-UP     */ 00201000
         SVC 59                                                         00202000
*       AFFNSET='0'B;               /* INDICATE NO AFFINITY SET      */ 00203000
         NI    AFFNSET(COMMAPT),B'10111111'                        0085 00204000
*       GOTO CPUAFN10;              /* EXIT THIS FUNCTION            */ 00205000
         B     CPUAFN10                                            0086 00206000
*     END;                          /* NO                            */ 00207000
*   IF VERBS='CPUAFFN=' THEN        /* WAS THE REPLY AN AFFN RE-     */ 00208000
@RF00080 CLC   VERBS(8,RBUFPTR),@CC00386                           0088 00209000
         BNE   @RF00088                                            0088 00210000
*     DO;                           /* QUEST, YES                    */ 00211000
*       VERBCALL='1'B;              /* INDICATE THIS AFFN REQUEST    */ 00212000
         OI    VERBCALL(COMMAPT),B'00100000'                       0090 00213000
*       GOTO CPUAFN06;              /* GO TEST WHAT CPUID            */ 00214000
         B     CPUAFN06                                            0091 00215000
*     END;                          /* NO                            */ 00216000
*   IF VERBS(1:4)='NONE' THEN       /* WAS THE REPLY NONE FOR DE-    */ 00217000
@RF00088 CLC   VERBS(4,RBUFPTR),@CC00388                           0093 00218000
         BNE   @RF00093                                            0093 00219000
*     DO;                           /* FAULT, YES                    */ 00220000
*       VERBCALL='0'B;              /* SET FOR DEFAULT PROCESS       */ 00221000
         NI    VERBCALL(COMMAPT),B'11011111'                       0095 00222000
*       SELDEFLP='0'B;              /* SET DEFAULT LOOP CPU 0        */ 00223000
         NI    SELDEFLP,B'01111111'                                0096 00224000
*       GOTO CPUAFN01;              /* SET CPU AFFN FOR CPU 0        */ 00225000
         B     CPUAFN01                                            0097 00226000
*     END;                          /* NO                            */ 00227000
*   GOTO CPUAFN05;                  /* INPUT NO GOOD REISSUE MSG   0099 00228000
*                                                                    */ 00229000
         B     CPUAFN05                                            0099 00230000
*CPUAFN5A:                                                         0100 00231000
*                                                                  0100 00232000
*   /*****************************************************************/ 00233000
*   /*                                                               */ 00234000
*   /* PROCESS IFD105D REPLY                                         */ 00235000
*   /*                                                               */ 00236000
*   /*****************************************************************/ 00237000
*                                                                  0100 00238000
*   RBUFPTR=INBUFPTR;               /* OVERLAY MAP INPUT AREA        */ 00239000
CPUAFN5A L     RBUFPTR,INBUFPTR(,COMMAPT)                          0100 00240000
*CPUAFN5B:                                                         0101 00241000
*                                                                  0101 00242000
*   /*****************************************************************/ 00243000
*   /*                                                               */ 00244000
*   /* TEST CPUID IN MSG REPLY                                       */ 00245000
*   /*                                                               */ 00246000
*   /*****************************************************************/ 00247000
*                                                                  0101 00248000
*   IF CPUID='NONE' THEN            /* WAS THE ID EQ TO NONE         */ 00249000
CPUAFN5B CLC   CPUID(4,RBUFPTR),@CC00388                           0101 00250000
         BNE   @RF00101                                            0101 00251000
*     DO;                           /* YES                           */ 00252000
*       SELDEFLP='0'B;              /* SET DEFAULT LOOP CPU 0        */ 00253000
         NI    SELDEFLP,B'01111111'                                0103 00254000
*       VERBCALL='0'B;              /* INDICATE THIS DEFAULT         */ 00255000
         NI    VERBCALL(COMMAPT),B'11011111'                       0104 00256000
*       GOTO CPUAFN01;              /* SET UP CPU AFFN CPU 0         */ 00257000
         B     CPUAFN01                                            0105 00258000
*     END;                          /* NO                          0106 00259000
*                                                                    */ 00260000
*CPUAFN06:                                                         0107 00261000
*                                                                  0107 00262000
*   /*****************************************************************/ 00263000
*   /*                                                               */ 00264000
*   /* CPU ID PROCESS                                                */ 00265000
*   /*                                                               */ 00266000
*   /*****************************************************************/ 00267000
*                                                                  0107 00268000
*   IF CPUID(2)=' ' THEN            /* IS THIS A 1 CHAR CPUID        */ 00269000
@RF00101 DS    0H                                                  0107 00270000
CPUAFN06 CLI   CPUID+1(RBUFPTR),C' '                               0107 00271000
         BNE   @RF00107                                            0107 00272000
*     DO;                           /* YES                           */ 00273000
*       IF CPUID(1)='0' THEN        /* IS THIS REQUEST FOR CPU 0     */ 00274000
         CLI   CPUID(RBUFPTR),C'0'                                 0109 00275000
         BE    @RT00109                                            0109 00276000
*         GOTO CPUAFN01;            /* YES, GO PROCESS               */ 00277000
*       IF CPUID(1)='1' THEN        /* IS THIS REQUEST FOR CPU 1     */ 00278000
         CLI   CPUID(RBUFPTR),C'1'                                 0111 00279000
         BE    @RT00111                                            0111 00280000
*         GOTO CPUAFN04;            /* YES, GO PROCESS               */ 00281000
*CPUAFN07:                          /* NO.                           */ 00282000
*                                                                  0113 00283000
*       /*************************************************************/ 00284000
*       /*                                                           */ 00285000
*       /* ERROR IN CPUID                                            */ 00286000
*       /*                                                           */ 00287000
*       /*************************************************************/ 00288000
*                                                                  0113 00289000
*       R1=IFD261I;                 /* GET PTR TO IFD261I MSG        */ 00290000
CPUAFN07 LA    @05,IFDMSG62                                        0113 00291000
         L     R1,IFD261I(,@05)                                    0113 00292000
*       R15=PARPRADR;               /* GET PARALLEL PRINT ADDR       */ 00293000
         L     R15,PARPRADR(,COMMAPT)                              0114 00294000
*       R15=6+R15;                  /* ENTRY POINT TO DPRINT         */ 00295000
         AH    R15,@CH00112                                        0115 00296000
*       GEN(BALR  14,15);           /* LINK TO MODULE                */ 00297000
         BALR  14,15                                                    00298000
*CPUAFN08:                                                         0117 00299000
*                                                                  0117 00300000
*       /*************************************************************/ 00301000
*       /*                                                           */ 00302000
*       /* REQUEST WITH IFD263D                                      */ 00303000
*       /*                                                           */ 00304000
*       /*************************************************************/ 00305000
*                                                                  0117 00306000
*       ECB=ECB&&ECB;               /* CLEAR ECB TO ZERO             */ 00307000
CPUAFN08 XC    ECB(4),ECB                                          0117 00308000
*       RPLYBUF(1)=' ';             /* CLEAR INPUT AREA WITH THIS    */ 00309000
         MVI   RPLYBUF,C' '                                        0118 00310000
*       RPLYBUF(2:12)=RPLYBUF(1);   /* CODE                    YM7207*/ 00311000
         MVI   RPLYBUF+2,C' '                                      0119 00312000
         MVC   RPLYBUF+3(9),RPLYBUF+2                              0119 00313000
         MVC   RPLYBUF+1(1),RPLYBUF                                0119 00314000
*       R1=IFD263D;                 /* GET PTR TO MSG IFD263D        */ 00315000
         LA    @05,IFDMSG62                                        0120 00316000
         L     R1,IFD263D(,@05)                                    0120 00317000
*       IF RETAINAC='1'B THEN       /* IF REI IS ACTIVE              */ 00318000
         TM    RETAINAC(COMMAPT),B'10000000'                       0121 00319000
         BNO   @RF00121                                            0121 00320000
*         DPMSGREI='1'B;            /* NO REI REPLY ALLOWED          */ 00321000
         OI    DPMSGREI(COMMAPT),B'00000001'                       0122 00322000
*       R15=PARPRADR;               /* GET PP ADDRESS          YM7207*/ 00323000
@RF00121 L     R15,PARPRADR(,COMMAPT)                              0123 00324000
*       R15=24+R15;                 /* ENTRY POINT TO DPRT     YM7207*/ 00325000
         AH    R15,@CH00068                                        0124 00326000
*       GEN(BALR  14,15);           /* LINK TO MODULE          YM7207*/ 00327000
         BALR  14,15                                                    00328000
*       RBUFPTR=BUFPTR62;           /* SET OVERLAY AREA MAP BASE     */ 00329000
         L     RBUFPTR,BUFPTR62                                    0126 00330000
*       IF VERBS='CPUAFFN=' THEN    /* WAS THE REPLY FOR AFFINITY    */ 00331000
         CLC   VERBS(8,RBUFPTR),@CC00386                           0127 00332000
         BE    @RT00127                                            0127 00333000
*         GOTO CPUAFN5B;            /* YES, GO PROCESS CPU ID        */ 00334000
*       GOTO CPUAFN08;              /* NO ERROR ON INPUT REQUEST     */ 00335000
         B     CPUAFN08                                            0129 00336000
*     END;                          /* NO                            */ 00337000
*   IF CPUID(3)^=' ' THEN           /* IS THIS ERROR RPLY      YM7207*/ 00338000
@RF00107 CLI   CPUID+2(RBUFPTR),C' '                               0131 00339000
         BNE   @RT00131                                            0131 00340000
*     GOTO CPUAFN07;                /* YES,OUTPUT ERROR MSGYM7207    */ 00341000
*   IF CPUID(1:2)='00' THEN         /* IS THIS 2 CHAR CPU 00         */ 00342000
         CLC   CPUID(2,RBUFPTR),@CC00363                           0133 00343000
         BE    @RT00133                                            0133 00344000
*     GOTO CPUAFN01;                /* YES GO PROCESS                */ 00345000
*   IF CPUID(1:2)='01' THEN         /* NO,IS THIS 2 CHAR CPU 01      */ 00346000
         CLC   CPUID(2,RBUFPTR),@CC00382                           0135 00347000
         BE    @RT00135                                            0135 00348000
*     GOTO CPUAFN04;                /* YES, GO PROCESS               */ 00349000
*   GOTO CPUAFN07;                  /* NO, INVALID CPUID ERRMSG    0137 00350000
*                                                                    */ 00351000
         B     CPUAFN07                                            0137 00352000
*CPUAFN09:                                                         0138 00353000
*                                                                  0138 00354000
*   /*****************************************************************/ 00355000
*   /*                                                               */ 00356000
*   /* SET CPU AFFINITY INDICATOR AND EXIT                           */ 00357000
*   /*                                                               */ 00358000
*   /*****************************************************************/ 00359000
*                                                                  0138 00360000
*   AFFNSET='1'B;                   /* INDICATE SETTING TO CALLER    */ 00361000
CPUAFN09 OI    AFFNSET(COMMAPT),B'01000000'                        0138 00362000
*CPUAFN10:                                                         0139 00363000
*                                                                  0139 00364000
*   /*****************************************************************/ 00365000
*   /*                                                               */ 00366000
*   /* ERROR EXIT LABEL EXIT FUNCTION CPU AFFINITY                   */ 00367000
*   /*                                                               */ 00368000
*   /*****************************************************************/ 00369000
*                                                                  0139 00370000
*   RETURN;                                                        0139 00371000
@EL00001 L     @13,4(,@13)                                         0139 00372000
@EF00001 DS    0H                                                  0139 00373000
@ER00001 LM    @14,@12,12(@13)                                     0139 00374000
         BR    @14                                                 0139 00375000
*   END                             /* END SECTION                 0140 00376000
*                                                                    */ 00377000
*                                                                  0140 00378000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00379000
*/*%INCLUDE SYSLIB  (IFDPF1  )                                       */ 00380000
*                                                                  0140 00381000
*       ;                                                          0140 00382000
         B     @EL00001                                            0140 00383000
@DATA    DS    0H                                                       00384000
@CH00112 DC    H'6'                                                     00385000
@CH00068 DC    H'24'                                                    00386000
@CH00364 DC    XL2'01'                                                  00387000
@CH00369 DC    XL2'04'                                                  00388000
@CH00371 DC    XL2'08'                                                  00389000
         DS    0F                                                       00390000
@SA00001 DS    18F                                                      00391000
         DS    0F                                                       00392000
@CF00375 DC    XL4'0020'                                                00393000
         DS    0D                                                       00394000
BUFPTR62 DC    AL4(RPLYBUF)                                             00395000
@CC00363 DC    C'00'                                                    00396000
@CC00376 DC    C'05'                                                    00397000
@CC00382 DC    C'01'                                                    00398000
@CC00385 DC    C'CAN'                                                   00399000
@CC00388 DC    C'NONE'                                                  00400000
@CC00386 DC    C'CPUAFFN='                                              00401000
@CB00361 DC    X'8000'                                                  00402000
@CB00380 DC    X'4000'                                                  00403000
RPLYBUF  DS    CL12                                                     00404000
INTAL    DS    CL1                                                      00405000
         ORG   INTAL                                                    00406000
SELDEFLP DS    BL1                                                      00407000
@NM00038 EQU   INTAL+0                                                  00408000
         ORG   INTAL+1                                                  00409000
         DS    CL2                                                      00410000
ECB      DS    CL4                                                      00411000
IFDOLT62 CSECT                                                          00412000
*                                       /* CPU AFFINITY MESSAGES     */ 00413000
IFDMSG62 DS    0F                                                       00414000
         DC    A(MSG261I)                * MESSAGE ADDRESS  MSG261I   * 00415000
         DC    A(MSG262I)                * MESSAGE ADDRESS  MSG262I   * 00416000
         DC    A(MSG263D)                * MESSAGE ADDRESS  MSG263D   * 00417000
         DC    A(MSG264D)                * MESSAGE ADDRESS  MSG264D   * 00418000
         DC    A(MSG899I)                * MESSAGE ADDRESS  MSG899I   * 00419000
MSG261I  WTO   'IFD261I INVALID CPU ID ENTERED',ROUTCDE=10,DESC=7,MF=L  00420000
MSG262I  WTO   'IFD262I SELECTED CPU NOT AVAILABLE',ROUTCDE=10,DESC=7,MX00421000
               F=L                                                      00422000
MSG263D  DS    0F                                                       00423000
         DC    X'0C'                                           *YM05405 00424000
         DC    AL3(RPLYBUF)                                             00425000
         DC    AL4(ECB)                                                 00426000
         WTO   'IFD263D REPLY CPUAFFN=X OR NONE, X=CPUID, NONE FOR DEFAX00427000
               ULT',ROUTCDE=10,DESC=7,MF=L                              00428000
MSG264D  DS    0F                                                       00429000
         DC    X'0A'                                                    00430000
         DC    AL3(RPLYBUF)                                             00431000
         DC    AL4(ECB)                                                 00432000
         WTO   'IFD264D SYSTEM RESOURCE NOT AVAILABLE,REPLY CPUAFFN=/CAX00433000
               N/NONE',ROUTCDE=10,DESC=7,MF=L                           00434000
MSG899I  WTO   'IFD899I OLTEP INITIALIZATION CONFLICTS, OLTEP MUST TERMX00435000
               INATE-05',MF=L,ROUTCDE=10,DESC=7                         00436000
         IFDPATCH                                              *YM03337 00437000
IFDOLT62 CSECT                                                          00438000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00439000
@01      EQU   01                                                       00440000
@02      EQU   02                                                       00441000
@03      EQU   03                                                       00442000
@04      EQU   04                                                       00443000
@05      EQU   05                                                       00444000
@06      EQU   06                                                       00445000
@07      EQU   07                                                       00446000
@08      EQU   08                                                       00447000
@09      EQU   09                                                       00448000
@10      EQU   10                                                       00449000
@11      EQU   11                                                       00450000
@12      EQU   12                                                       00451000
@13      EQU   13                                                       00452000
@14      EQU   14                                                       00453000
@15      EQU   15                                                       00454000
LOOPCNT  EQU   @04                                                      00455000
RBUFPTR  EQU   @03                                                      00456000
COMMAPT  EQU   @02                                                      00457000
RETCODE  EQU   @15                                                      00458000
R0       EQU   @00                                                      00459000
R1       EQU   @01                                                      00460000
R14      EQU   @14                                                      00461000
R15      EQU   @15                                                      00462000
COMMAP   EQU   0                                                        00463000
INBUFPTR EQU   COMMAP+136                                               00464000
IOSCB    EQU   COMMAP+512                                               00465000
OECBWRD1 EQU   IOSCB+132                                                00466000
EFCTRCB  EQU   COMMAP+648                                               00467000
FLGA     EQU   EFCTRCB+8                                                00468000
FLGB     EQU   EFCTRCB+9                                                00469000
IODEVTAB EQU   COMMAP+672                                               00470000
IOECB1   EQU   IODEVTAB+8                                               00471000
CMPLT    EQU   IOECB1                                                   00472000
@NM00010 EQU   IOECB1+2                                                 00473000
SELAFFN  EQU   COMMAP+708                                               00474000
CHARAFFN EQU   COMMAP+710                                               00475000
CESWT9   EQU   COMMAP+862                                               00476000
CESWT10  EQU   COMMAP+863                                               00477000
AFFNSET  EQU   CESWT10                                                  00478000
VERBCALL EQU   CESWT10                                                  00479000
MCT      EQU   COMMAP+888                                               00480000
PARPRADR EQU   MCT+164                                                  00481000
WKSVC    EQU   COMMAP+1100                                              00482000
ROPT     EQU   WKSVC+4                                                  00483000
OLTTAB   EQU   COMMAP+1116                                              00484000
CESWITCH EQU   COMMAP+1456                                              00485000
CESWT    EQU   CESWITCH                                                 00486000
CESWT1   EQU   CESWITCH+1                                               00487000
CESWT2   EQU   CESWITCH+2                                               00488000
CESWT3   EQU   CESWITCH+3                                               00489000
CESWT4   EQU   CESWITCH+4                                               00490000
CESWT5   EQU   CESWITCH+5                                               00491000
CESWT6   EQU   CESWITCH+6                                               00492000
CESWT7   EQU   CESWITCH+7                                               00493000
CESWT8   EQU   CESWITCH+8                                               00494000
CESWTR   EQU   COMMAP+1532                                              00495000
RETAINAC EQU   CESWTR                                                   00496000
CESWTR1  EQU   COMMAP+1533                                              00497000
CESWTR2  EQU   COMMAP+1534                                              00498000
DPMSGREI EQU   CESWTR2                                                  00499000
REPLYMAP EQU   0                                                        00500000
VERBS    EQU   REPLYMAP                                                 00501000
CPUID    EQU   REPLYMAP+8                                               00502000
@NM00039 EQU   0                                                        00503000
IFD261I  EQU   @NM00039                                                 00504000
IFD262I  EQU   @NM00039+4                                               00505000
IFD263D  EQU   @NM00039+8                                               00506000
IFD264D  EQU   @NM00039+12                                              00507000
IFD899I  EQU   @NM00039+16                                              00508000
@NM00040 EQU   0                                                        00509000
MSGRETCD EQU   @NM00040+65                                              00510000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00511000
@NM00041 EQU   @NM00040                                                 00512000
DEVTAB   EQU   COMMAP+2020                                              00513000
THIRDMCT EQU   COMMAP+1812                                              00514000
NEXTMCT  EQU   COMMAP+1604                                              00515000
@NM00037 EQU   COMMAP+1596                                              00516000
VRSIZE   EQU   COMMAP+1592                                              00517000
CORERSLT EQU   COMMAP+1584                                              00518000
PGFXOLT  EQU   COMMAP+1576                                              00519000
PARTITEM EQU   COMMAP+1564                                              00520000
PGFXLIST EQU   COMMAP+1548                                              00521000
SYMPTR   EQU   COMMAP+1544                                              00522000
EXPAND1  EQU   COMMAP+1540                                              00523000
@NM00036 EQU   COMMAP+1538                                              00524000
ZUESUCB  EQU   COMMAP+1536                                              00525000
CESWTR3  EQU   COMMAP+1535                                              00526000
@NM00035 EQU   CESWTR2                                                  00527000
OPTERR   EQU   CESWTR2                                                  00528000
WAIT     EQU   CESWTR2                                                  00529000
COMLOOP  EQU   CESWTR2                                                  00530000
ONCOMM   EQU   CESWTR2                                                  00531000
@NM00034 EQU   CESWTR2                                                  00532000
REPLY00  EQU   CESWTR2                                                  00533000
REIENTRY EQU   CESWTR1                                                  00534000
EDOTMSG  EQU   CESWTR1                                                  00535000
REMANS   EQU   CESWTR1                                                  00536000
RETRIEVE EQU   CESWTR1                                                  00537000
INFOMSG  EQU   CESWTR1                                                  00538000
CECOMANS EQU   CESWTR1                                                  00539000
EXECANS  EQU   CESWTR1                                                  00540000
ILLRESP  EQU   CESWTR1                                                  00541000
@NM00033 EQU   CESWTR                                                   00542000
EXECOUT  EQU   CESWTR                                                   00543000
IMRESP   EQU   CESWTR                                                   00544000
TRANSMSG EQU   CESWTR                                                   00545000
CENOMSG  EQU   CESWTR                                                   00546000
REMONMSG EQU   CESWTR                                                   00547000
REMERR   EQU   CESWTR                                                   00548000
REIUCB   EQU   COMMAP+1528                                              00549000
RESPBUF  EQU   COMMAP+1524                                              00550000
TALKECB  EQU   COMMAP+1520                                              00551000
REIECB   EQU   COMMAP+1516                                              00552000
REIOBPTR EQU   COMMAP+1512                                              00553000
REIDCBPT EQU   COMMAP+1508                                              00554000
RINBUF   EQU   COMMAP+1504                                              00555000
RTALKBUF EQU   COMMAP+1500                                              00556000
MHRPTR   EQU   COMMAP+1496                                              00557000
ENDJOB   EQU   COMMAP+1492                                              00558000
MSGMOD   EQU   COMMAP+1488                                              00559000
RDCBPTR  EQU   COMMAP+1484                                              00560000
READDMOD EQU   COMMAP+1480                                              00561000
@NM00032 EQU   COMMAP+1477                                              00562000
READDSV  EQU   COMMAP+1471                                              00563000
CNT37    EQU   COMMAP+1470                                              00564000
DPLEVEL  EQU   COMMAP+1469                                              00565000
UNITUSE  EQU   COMMAP+1468                                              00566000
UNICTR   EQU   COMMAP+1467                                              00567000
SECTUSE  EQU   COMMAP+1466                                              00568000
DYNCOM   EQU   COMMAP+1465                                              00569000
TALKHERE EQU   CESWT8                                                   00570000
SNEWRUN  EQU   CESWT8                                                   00571000
SUTMSG   EQU   CESWT8                                                   00572000
OLTINVV  EQU   CESWT8                                                   00573000
READDCHK EQU   CESWT8                                                   00574000
@NM00031 EQU   CESWT8                                                   00575000
@NM00030 EQU   CESWT8                                                   00576000
LISTFIX  EQU   CESWT8                                                   00577000
GOTINPUT EQU   CESWT7                                                   00578000
VIRTUAL  EQU   CESWT7                                                   00579000
@NM00029 EQU   CESWT7                                                   00580000
@NM00028 EQU   CESWT7                                                   00581000
@NM00027 EQU   CESWT7                                                   00582000
REMOTE   EQU   CESWT7                                                   00583000
RETTO31  EQU   CESWT7                                                   00584000
INCLST   EQU   CESWT7                                                   00585000
RTSTAE   EQU   CESWT6                                                   00586000
SECRUN   EQU   CESWT6                                                   00587000
NORUN    EQU   CESWT6                                                   00588000
CODE5    EQU   CESWT6                                                   00589000
PFPMSG   EQU   CESWT6                                                   00590000
EOFBIT   EQU   CESWT6                                                   00591000
ATM      EQU   CESWT6                                                   00592000
UTSCAL   EQU   CESWT6                                                   00593000
PRNTOPTN EQU   CESWT5                                                   00594000
SYMBFLG  EQU   CESWT5                                                   00595000
PCEMSG   EQU   CESWT5                                                   00596000
PFEMSG   EQU   CESWT5                                                   00597000
FCEFLG   EQU   CESWT5                                                   00598000
FFEFLG   EQU   CESWT5                                                   00599000
RSLTFLG  EQU   CESWT5                                                   00600000
HDRFLG   EQU   CESWT5                                                   00601000
WTOFLG   EQU   CESWT4                                                   00602000
RPLYFLG  EQU   CESWT4                                                   00603000
WTORFLG  EQU   CESWT4                                                   00604000
@NM00026 EQU   CESWT4                                                   00605000
WRTFLG   EQU   CESWT4                                                   00606000
WAITFLG  EQU   CESWT4                                                   00607000
DPRFLG   EQU   CESWT4                                                   00608000
RSTRFLG  EQU   CESWT4                                                   00609000
NODP     EQU   CESWT3                                                   00610000
CDEXIST  EQU   CESWT3                                                   00611000
TP1419   EQU   CESWT3                                                   00612000
SUSDEL   EQU   CESWT3                                                   00613000
GRBCNTL  EQU   CESWT3                                                   00614000
BYPDEV   EQU   CESWT3                                                   00615000
BYPALDEV EQU   CESWT3                                                   00616000
TALKVERB EQU   CESWT3                                                   00617000
@NM00025 EQU   CESWT2                                                   00618000
TAPEHDR  EQU   CESWT2                                                   00619000
NDR      EQU   CESWT2                                                   00620000
INITENT  EQU   CESWT2                                                   00621000
@NM00024 EQU   CESWT2                                                   00622000
FECOND   EQU   CESWT2                                                   00623000
@NM00023 EQU   CESWT2                                                   00624000
NDCFO    EQU   CESWT2                                                   00625000
TPFLAG   EQU   CESWT1                                                   00626000
ONLINEOK EQU   CESWT1                                                   00627000
@NM00022 EQU   CESWT1                                                   00628000
FILMSK   EQU   CESWT1                                                   00629000
WAITFG   EQU   CESWT1                                                   00630000
@NM00021 EQU   CESWT1                                                   00631000
SKTST    EQU   CESWT1                                                   00632000
RTNFLD   EQU   CESWT1                                                   00633000
@NM00020 EQU   CESWT                                                    00634000
FERINT   EQU   CESWT                                                    00635000
REINT    EQU   CESWT                                                    00636000
LEGALDEV EQU   CESWT                                                    00637000
NUTS     EQU   CESWT                                                    00638000
OUTS     EQU   CESWT                                                    00639000
SECDEV   EQU   CESWT                                                    00640000
LEGALTST EQU   CESWT                                                    00641000
SAVENT   EQU   COMMAP+1452                                              00642000
@NM00019 EQU   COMMAP+1450                                              00643000
SAVECNT  EQU   COMMAP+1448                                              00644000
HRTSEL   EQU   COMMAP+1446                                              00645000
TLCOUNT  EQU   COMMAP+1444                                              00646000
TPSAVE   EQU   COMMAP+1440                                              00647000
MSGAD37  EQU   COMMAP+1436                                              00648000
REPLY37  EQU   COMMAP+1364                                              00649000
ECB37    EQU   COMMAP+1360                                              00650000
ADSVAREA EQU   COMMAP+1356                                              00651000
NEXTREC  EQU   COMMAP+1352                                              00652000
COMMINT  EQU   COMMAP+1348                                              00653000
REDEFINE EQU   COMMAP+1344                                              00654000
SECDVPTR EQU   COMMAP+1340                                              00655000
PRIDVPTR EQU   COMMAP+1336                                              00656000
DPRDEBAD EQU   COMMAP+1332                                              00657000
EXTBUF   EQU   COMMAP+1276                                              00658000
UTCOM    EQU   COMMAP+1212                                              00659000
ECB3     EQU   COMMAP+1208                                              00660000
TSTDEBAD EQU   COMMAP+1204                                              00661000
TUCBAD2  EQU   COMMAP+1200                                              00662000
TUCBAD1  EQU   COMMAP+1196                                              00663000
REGX     EQU   COMMAP+1192                                              00664000
PLKMOR   EQU   COMMAP+1176                                              00665000
SATAB    EQU   COMMAP+1164                                              00666000
SCHEDSA  EQU   COMMAP+1160                                              00667000
LOGADR   EQU   COMMAP+1156                                              00668000
@NM00018 EQU   OLTTAB+32                                                00669000
TAB28    EQU   OLTTAB+28                                                00670000
@NM00017 EQU   OLTTAB                                                   00671000
@NM00016 EQU   WKSVC+8                                                  00672000
@NM00015 EQU   WKSVC                                                    00673000
MCT1ADR  EQU   COMMAP+1096                                              00674000
@NM00014 EQU   MCT+168                                                  00675000
@NM00013 EQU   MCT                                                      00676000
UTCOMAD  EQU   COMMAP+884                                               00677000
TABAD    EQU   COMMAP+880                                               00678000
DEVDEPAD EQU   COMMAP+876                                               00679000
PSCT     EQU   COMMAP+872                                               00680000
OPEN3    EQU   COMMAP+868                                               00681000
OPEN2    EQU   COMMAP+864                                               00682000
MPSYS    EQU   CESWT10                                                  00683000
@NM00012 EQU   CESWT9                                                   00684000
VRCAP    EQU   CESWT9                                                   00685000
RESTBENT EQU   CESWT9                                                   00686000
CDSEQU   EQU   CESWT9                                                   00687000
TABLNGTH EQU   COMMAP+860                                               00688000
DEVTBPTR EQU   COMMAP+856                                               00689000
XXXXXXXX EQU   COMMAP+712                                               00690000
WTCMPCD  EQU   @NM00010                                                 00691000
@NM00011 EQU   @NM00010                                                 00692000
PSUDPOST EQU   @NM00010                                                 00693000
@NM00009 EQU   IOECB1+1                                                 00694000
CMPLCODE EQU   CMPLT                                                    00695000
POSTBIT  EQU   CMPLT                                                    00696000
WAITBIT  EQU   CMPLT                                                    00697000
IOSBPTR1 EQU   IODEVTAB+4                                               00698000
IODEV1   EQU   IODEVTAB                                                 00699000
IOEFTRAD EQU   COMMAP+668                                               00700000
SEEKPTR  EQU   EFCTRCB+16                                               00701000
TECBPTRX EQU   EFCTRCB+12                                               00702000
SNSCNT   EQU   EFCTRCB+11                                               00703000
FILEMSK  EQU   EFCTRCB+10                                               00704000
@NM00008 EQU   FLGB                                                     00705000
@NM00007 EQU   FLGB                                                     00706000
@NM00006 EQU   FLGB                                                     00707000
@NM00005 EQU   FLGB                                                     00708000
OLDTECBX EQU   FLGB                                                     00709000
VIRTCCWS EQU   FLGB                                                     00710000
ATTNIN   EQU   FLGB                                                     00711000
INTIRNAL EQU   FLGB                                                     00712000
@NM00004 EQU   FLGA                                                     00713000
@NM00003 EQU   FLGA                                                     00714000
@NM00002 EQU   FLGA                                                     00715000
@NM00001 EQU   FLGA                                                     00716000
SPEXPOS  EQU   FLGA                                                     00717000
GDP      EQU   FLGA                                                     00718000
CEDEPOST EQU   FLGA                                                     00719000
BYPASPFX EQU   FLGA                                                     00720000
DVTPTR   EQU   EFCTRCB+4                                                00721000
CCWPTR   EQU   EFCTRCB                                                  00722000
OECBX    EQU   OECBWRD1+2                                               00723000
OECBINCT EQU   OECBWRD1+1                                               00724000
OECBSNSC EQU   OECBWRD1                                                 00725000
MODUSECB EQU   IOSCB+108                                                00726000
MODIOSB  EQU   IOSCB                                                    00727000
DIEPTR   EQU   COMMAP+508                                               00728000
ABNMEXIT EQU   COMMAP+504                                               00729000
NORMEXIT EQU   COMMAP+500                                               00730000
PCIEXIT  EQU   COMMAP+496                                               00731000
SECLST   EQU   COMMAP+358                                               00732000
PGMTAB   EQU   COMMAP+350                                               00733000
DATIND   EQU   COMMAP+348                                               00734000
DATPTR   EQU   COMMAP+344                                               00735000
UTENT    EQU   COMMAP+340                                               00736000
SECPTR   EQU   COMMAP+336                                               00737000
PRTBUFR  EQU   COMMAP+212                                               00738000
INBUFR   EQU   COMMAP+140                                               00739000
LGWRTCT  EQU   COMMAP+96                                                00740000
DOLT00PT EQU   COMMAP+92                                                00741000
CHASCT   EQU   COMMAP                                                   00742000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00743000
@RT00023 EQU   CPUAFN5A                                                 00744000
@RT00032 EQU   CPUAFN09                                                 00745000
@RT00034 EQU   CPUAFN03                                                 00746000
@RT00036 EQU   CPUAFN05                                                 00747000
@RF00093 EQU   CPUAFN05                                                 00748000
@RT00109 EQU   CPUAFN01                                                 00749000
@RT00111 EQU   CPUAFN04                                                 00750000
@RT00127 EQU   CPUAFN5B                                                 00751000
@RT00131 EQU   CPUAFN07                                                 00752000
@RT00133 EQU   CPUAFN01                                                 00753000
@RT00135 EQU   CPUAFN04                                                 00754000
CPUAFN10 EQU   @EL00001                                                 00755000
@ENDDATA EQU   *                                                        00756000
         END   IFDOLT62                                                 00757000
