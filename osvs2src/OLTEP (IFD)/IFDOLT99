         TITLE ' IFDOLT99  OLTEP''S EDITOR MODULE'                      00050002
IFDOLT99 CSECT                                                          00100002
*********************************************************************** 00150002
*                                                                     * 00200002
*                                 PROLOGUE                            * 00250002
*                                                                     * 00300002
*                                                                     * 00350002
*  STATUS:                                                            * 00400002
*          THIS IS THE FIRST VERSION OF THIS MODULE         NOV 4 1971* 00450002
*                                                                     * 00500002
*                                                                     * 00550002
*  FUNCTION:                                                          * 00600002
*          THE PURPOSE OF THIS MODULE IS TO CREATE A PARTITIONED      * 00650002
*          DATA SET (IF JOB DD CARD LABELS SET AS NEW), OR ADD        * 00700002
*          ENTRIES TO AN ALREADY CREATED PDS, (IF DDCARE LABELS       * 00750002
*          SET AS OLD). INPUT TO THIS MODULE MAY BE TAPE OR CARDS,    * 00800002
*          IN EITHER CASE THE 'OBJECT' DECK MODULES WILL BE LINK-     * 00850002
*          EDITED TO THE DATA SET IN A FORMAT REQUIRE BY OLTEPS       * 00900002
*          LOADER MODULE (IFDOLT12). THIS MODULE WILL NOT ALTER       * 00950002
*          THE FOLLOWING INPUT CARDS:                                 * 01000002
*                             1. ESD   FIRST CARD OF OBJ DECK         * 01050002
*                             2. RLD   RELOCATION DICTIONARY          * 01100002
*                             3. REP   REPAIR CARD                    * 01150002
*                             4. END   END OF MODULE INDICATOR        * 01200002
*                             5. CONTROL CARDS (NAME, SETSSI, SYMBOLIC* 01250002
*                                CDS)                                 * 01300002
*           HOWEVER, TEXT (TXT) CARDS WILL BE CHANGED BY THIS MODULE. * 01350002
*           WHEN A TEXT CARD IS READ BY IFDOLT99, THE TXT INFOR-      * 01400002
*           MATION WILL BE BLOCKED INTO SEGMENTS FROM 1 TO 3600 BYTES.* 01450002
*           ALSO, A TEXT HEADER CARD WILL BE GENERATED WHICH WILL     * 01500002
*           REPRESENT THE BLOCKED DATA (TXT). ALL  RECORDS WRITTEN    * 01550002
*           BY THIS MODULE WILL BE 80 BYTES IN LENGTH WITH EXCEPTION  * 01600002
*           TO THE BLOCK TEXT RECORDS.                                * 01650002
*                                                                     * 01700002
*                                                                     * 01750002
*  ENTRY POINTS:                                                      * 01800002
*           THE MAIN AND ONLY ENTRY POINT TO THIS MODULE IS IFDOLT99. * 01850002
*                                                                     * 01900002
*                                                                     * 01950002
*  INPUT:                                                             * 02000002
*           AS INPUT THIS MODULE WILL ACCEPT OBJECT DECKS ON A        * 02050002
*           CARD IMAGE  TAPE OR OBJECT DECKS ON CARDS. IF INPUT       * 02100002
*           IS FROM A CARD IMAGE TAPE GENERATED BY THE STAND-ALONE    * 02150002
*           SUPPORT PROCESSOR, TWO FILES WILL EXIST. THE FIRST        * 02200002
*           FILE WILL CONSIST OF THE ONLINE TESTS AND THE LOCAL       * 02250002
*           CONFIGURATION DATA SETS,(CDS) LOAD MODULES. THE           * 02300002
*           SECOND FILE MAY BE A NULL FILE OR ANOTHER CDS FILE        * 02350002
*           FOR THE REMOTE DEVICES CONFIGURATION.  THESE OBJECT       * 02410002
*           MODULES WILL BE WRITTEN ON TO THE DATA SET DESCRIBED      * 02470002
*           IN THE SYMSYM DD CARD. IF INPUT IS FROM                   * 02530002
*           THE CARD READER, THE SYMBOLIC CDS CONTROL CARD MUST BE    * 02600002
*           MANUALLY INSERTED BEFORE THE SYMBOLIC CDS LOAD MODULES    * 02650002
*           AND FOLLOWING THE OLT-LOCAL CDS LOAD MODULES. THIS        * 02700002
*           MODULE WILL ACCEPT LOAD MODULES INDIVIDUALLY OR IN        * 02750002
*           MULTIPLES. INPUT DATA WILL BE READ FROM THE DEVICE        * 02800002
*           SPECIFIED IN THE CNTRLIN DD CARD.                         * 02850002
*                                                                     * 02900002
*  OUTPUT:  THIS MODULE WILL OUTPUT MESSAGES TO THE OPERATOR CONSOLE  * 02950002
*           AND TO THE SYSTEM PRINTER (DEVICE ON DIAGMSG DD CARD).    * 03000002
*           OLTS AND CDS (LOCAL) MODULES WILL BE OUTPUTTED TO         * 03050002
*           THE DATA SET SPECIFIED ON THE OLTCDSDD DD CARD.           * 03100002
*           SYMBOLIC NAMED CONF DATA SETS WILL BE OUT-PUTTED          * 03110002
*           TO THE DATA SET SPECIFIED IN THE SYMCDSDD DD              * 03150002
*           CARD.                                                     * 03200002
*                                                                     * 03250002
*           THE FOLLOWING MESSAGES WILL BE PRINTED TO THE PRINTER     * 03300002
*           SPECIFIED ON THE DIAGMSG DD CARD.                         * 03350002
*                                                                     * 03400002
*           1.  IFD900I:  THIS MESSAGE WILL INDICATE A RECORD         * 03450002
*                         READ FROM THE INPUT DEVICE WAS NOT          * 03500002
*                         EXPECTED, AND THAT THE CARD WAS             * 03550002
*                         REJECTED.                                   * 03600002
*                                                                     * 03650002
*           2.  IFD901I:  THIS MESSAGE IS PRINTED WHEN A OPEN         * 03700002
*                         TO A DCB FAILS. THE MESSAGE WILL CONTAIN    * 03750002
*                         THE DD NAME FOR THE FAILING DCB.            * 03800002
*                                                                     * 03850002
*           3.  IFD902I:  THIS MESSAGE INDICATES THE MODULE           * 03900002
*                         WAS CORRECTLY ADDED/REPLACED IN THE         * 03950002
*                         DATA SET SPECIFIED.                         * 04000002
*                                                                     * 04050002
*           4.  IFD903I:  THIS MESSAGE IS OUTPUTTED WHEN A MODULE     * 04100002
*                         COULD NOT BE ADDED OR REPLACE ON THE        * 04150002
*                         DATA SET.  THE MESSAGE TEXT WILL INDICATE   * 04200002
*                         THE CAUSE OF THE ERROR                      * 04250002
*                         IN ALL CASES THE JOB WILL BE TERMINATED.    * 04300002
*                                                                     * 04350002
*                                                                     * 04400002
*           5.  IFD904I  THIS MESSAGE INDICATES AN ERROR IN THE       * 04402002
*                        OBJECT DECK SEQUENCE NUMBERS WAS FOUND.      * 04404002
*                        THE MODULE CONTAINING THE ERROR WILL         * 04406002
*                        NOT BE STOWED INTO THE DIRECTORY. THE        * 04408002
*                        MESSAGE WILL SHOW THE EXPECTED AND RECIEVED  * 04410002
*                        SEQUENCE NUMBERS; AND THE MODULES NAME WHICH * 04412002
*                        WAS NOT STORED.                              * 04414002
*                                                                     * 04416002
*                                                                     * 04418002
*           6.  IFD906I  THIS MESSAGE IS OUTPUT WHEN AN ERROR         * 04420002
*                        IN A REP CARD WAS DETECTED. THE CARD IS      * 04422002
*                        OUTPUTTED IN THE MESSAGE TEXT. ALSO,         * 04424002
*                        THE MODULE IS BYPASSED.                      * 04426002
*           7. IFD907I  THIS MESSAGE IS OUTPUTTED TO INDICATE         * 04428002
*                        THE DATA SET TO WHICH MODULES ARE TO BE      * 04430002
*                        ADDED.                                       * 04432002
*                                                                     * 04434002
*           8.  IFD908I  THIS MESSAGE IS OUTPUTTED TO INDICATE        * 04436002
*                        INPUT WAS NOT IN THE CORRECT ORDER.          * 04438002
*           THE FOLLOWING MESSAGE WILL BE OUTPUTTED TO THE OPERATOR   * 04450002
*           CONSOLE IF THE PRINTER DCB COULD NOT BE OPENED:           * 04500002
*                                                                     * 04550002
*           1.  IFD901I:  THIS MESSAGE WILL HAVE THE DD NAME          * 04600002
*                         OLTEP REQUIRES WHEN OPEN FAILED FOR         * 04650002
*                         THE PRINTER.                                * 04700002
*                                                                     * 04750002
*                                                                     * 05050002
*           THIS MODULE WILL RETURN A CODE IN REGISTER  R15           * 05100002
*                                                                     * 05150002
*                                                                     * 05200002
*  EXTERNAL ROUTINES:                                                 * 05250002
*           THIS MODULE WILL ISSUE THE FOLLOWING SYSTEM MACROS,       * 05300002
*                                                                     * 05350002
*           1.  OPEN    TO ALL DCBS DD CARDS REQUIRED                 * 05400002
*           2.  CLOSE   TO ALL DCBS OPENED                            * 05450002
*           3.  WRITE   TO DATA SET WHERE MODULES WILL RESIDE         * 05500002
*           4.  STOW    FOR EACH MODULE                               * 05550002
*           5.  PUT     TO PRINTER FOR MESSAGE OUTPUT                 * 05600002
*           6.  GET     TO RETRIEVE A RECORD                          * 05650002
*           7.  CHECK   FOR WRITE COMMAND                             * 05700002
*           8.  RDJFCB  TO INPUT DCB                                  * 05750002
*           9.  DCB     FOR ALL FILES                                 * 05800002
*          10.  DCBD    DSECT                                         * 05850002
*          11.  WTO     WHEN PRINTER DCB FAILS TO OPEN                * 05900002
*                                                                     * 05950002
*  EXITS NORMAL:                                                      * 06000002
*            ALL EXITS FROM THIS MODULE ARE MADE AT THE LABEL         * 06050002
*            GEN05000                                                 * 06100002
*                                                                     * 06150002
*  EXITS ERROR:                                                       * 06200002
*            ERROR EXITS FROM THIS MODULE ARE MADE AT THE LABEL       * 06250002
*            GEN05000                                                 * 06300002
*                                                                     * 06350002
*                                                                     * 06400002
*  TABLES AND WORKAREAS:                                              * 06450002
*            ALL TABLES AND WORKAREAS ARE INTERNAL TO THIS MODULE.    * 06500002
*            THESE AREAES ARE NOT REFERENCED BY ANY SYSTEM OR         * 06550002
*            OLTEP MODULE OTHER THAN IFDOLT99.                        * 06600002
*  FIX TO MSG SIZE AND FIX COMMENTS                             XM1330* 06650002
* PTM  3316 ADD V IF NECESSARY TO MSG IFD902I                   XM3316* 06660002
* APAR OX01911 RECOGNIZE 3420 TAPES AS VALID INPUT DEVICE      OX01911* 06670002
*********************************************************************** 06700002
         EJECT                                                          06750002
         SPACE 5                  SAVE G.P. REGS IN CALLER              06800002
*                                 ************************************* 06850002
*                                 *   REGISTER EQUATES DISPLACEMENTS  * 06900002
*                                 *   LOAD ADDRESS CONSTANTS AND MASKS* 06950002
*                                 ************************************* 07000002
HEX00    EQU   X'00'              USED TO RESET SWITCHS                 07050002
L0       EQU   0                                                        07100002
D0       EQU   0                  DISPLACEMENT OF ZERO                  07150002
ZERO     EQU   0                  REGISTER ZERO                         07200002
TTREG1   EQU   1                  SAVE TTR REGISTER                     07250002
D1       EQU   1                  DISPLACEMENT                          07300002
VIRTUAL  EQU   X'01'                   CAN OLT RUN IN VIRT       XM3316 07303002
LETTERV  EQU   C'V'                    LETTER V                  XM3316 07306002
POINTOK  EQU   X'01'              IF ON A POINT CAN BE ISSUED           07310002
*                                 WITHOUT HITTING THE DITECTORY         07320002
REPREAD  EQU   X'01'              WHEN ON A REP HAS BEEN READ           07323002
RLDREAD  EQU   X'02'              WHEN ON A RLD HAS BEEN READ           07326002
SCANREG  EQU   8                  USED IN CARD IDENTIFYING              07330002
HEX02    EQU   X'02'              USED TO FINF CTL CARDS                07340002
BCTREG   EQU   2                  USED IN SEQUENSE CHECKING             07350002
COMMON   EQU   2                  POINTER TO OLTEPS COMMON AREA         07400002
FIRSTCD  EQU   X'04'              IF ON FIRST CARD BEEN READ IN         07410002
D20      EQU   20                 DISPLACEMENT FIELD                    07420002
ENDJOB   EQU   X'02'              SWITCH FOR TOTAL END OF JOB           07450002
D2       EQU   2                                                        07500002
L2       EQU   2                  LENTH FIELD                           07550002
TWO      EQU   2                  BYTE COUNT                            07600002
THREE    EQU   3                  NUMBER OF DCB TO OPEN                 07650002
HEX03    EQU   X'03'                                                    07700002
LINECNT  EQU   3                  PAGE AND LIVE COUNT WORK REG          07750002
D4       EQU   4                  LNKAGE CONST                          07800002
FOUR     EQU   4                  DISP AND NO. BYTES                    07850002
TXTPTR   EQU   4                  POINTER TO TXT BUFFER AREA            07900002
WRTLINK  EQU   5                  BALR REGISTER                         07950002
D5       EQU   5                  DISPL FIELD                           08000002
SIX      EQU   6                  USED TO SC AN REP CARD                08050002
D6       EQU   6                                                        08100002
LINK     EQU   6                  BR REGISTER                           08150002
L7       EQU   7                                                        08200002
WORKREG1 EQU   7                  WORK REGISTER                         08250002
WORKRG1  EQU   WORKREG1                                                 08300002
MSGSIZRG EQU   7                  USED IN MSG EX INST                   08350002
L8       EQU   8                  LNGTH FIELD CONST                     08400002
DCBREG   EQU   8                  REGISTER FOR DCB WORK                 08450002
JFCBREG  EQU   WORKREG1           USED TO REF JFCB VIA DSECT            08470002
ADDER    EQU   8                  USED IN SEQUENSE CHECKING             08500002
L3       EQU   3                  LNGTH FIELD                           08550002
MSGADDR  EQU   8                  USED FOR MESSAGES ONLY                08600002
SLOT     EQU   9                  REG TO POINT DURING SCANN OF REP CD   08650002
ACCUMRG  EQU   9                  NUMBER OF BYTES IN TXTAREA REGISTER   08700002
WRTSP1   EQU   9                  CODE TO WRITE AND SPACE ONE LINE      08750002
SCANCNT  EQU   10                 WILL CONTAIN COUNT OF CHARS TO SCAN   08800002
D10      EQU   10                 DISPL FIELD                           08850002
BASEREG  EQU   11                 BASE REGISTER                         08900002
D12      EQU   12                 DISP LENFTH                           08950002
SAVEREG  EQU   13                 SAVE AREA POINTER                     09000002
D14      EQU   14                 DISPL FIELD                           09050002
EP       EQU   15                 WORKREGISTER                          09100002
STOWRC   EQU   15                 STOW RETURN CODE                      09150002
D17      EQU   17                                                       09200002
D16      EQU    16                                                      09250002
OPEN     EQU   X'10'                                                    09300002
D24      EQU   24                                                       09350002
D21      EQU   21                 DISPLACEMENT OF 21                    09370002
D25      EQU   25                 DISPLAC FOR TEXTID                    09400002
LASTPASS EQU   32                 MASK FOR LAST PASS SWITCH             09450002
D32      EQU   32                 CONSTANT OF 32                        09460002
D33      EQU   33                 CONSTANT OF 32                        09470002
D34      EQU   34                 USED TO MOVE MOD NAME                 09500002
D36      EQU   36                 USED IN MESSAGE MOVE                  09550002
HEX38    EQU   X'38'              NUMBER LINES PER PAGE                 09600002
D39      EQU   39                 DISPLACEMENT FIELD                    09620002
BLANK    EQU   X'40'              BLACK CHARACTER                       09650002
D46      EQU   46                 USED TO MOVE SEQ NO.                  09700002
HEX50    EQU   X'50'                                                    09750002
SAVETTRZ EQU   64                 MASK FOR SAVE TTR TEST                09800002
D68      EQU   68                 USED IN THEJFCB WORK RTN              09850002
D73      EQU   73                 DISPLACEMENT                          09900002
D76      EQU   76                                                       09950002
HEX80    EQU   X'80'              DISPLACEMENT CONST                    10000002
L118     EQU   118                                                      10050002
NEEDNAME EQU   128                MASK FOR NAME CARD REQUIREMENT        10100002
RESTORE  EQU   X'8B'              RESTORE CMD CODE                      10150002
ALL      EQU   255                MASK FOR SWITCH RESET                 10200002
C1       EQU   X'C1'              USED IN SCAN SUBROUTINE               10250002
C6       EQU   X'C6'              USED IN SCAN SUBROUTINE               10300002
F0       EQU   X'F0'              USED IN SCAN SUBROUTINE               10350002
HEXF0    EQU   X'F0'              CONSTANT OF HEX F0                    10370002
F9       EQU   X'F9'              USED IN SCAN SUBROUTINE               10400002
COMMA    EQU   C','                   USED IN SCAN SUBROUTINE           10450002
POUND    EQU   C'#'               ID S OF NEW OLTS                      10470002
         EJECT                                                          10500002
GEN00000 SAVE  (14,12),,IFDOLT99&SYSDATE SAVE MOD NAME AND DATE.        10550002
         BALR  BASEREG,ZERO       ESTABLISH ADDRESSABILITY              10600002
         USING *,BASEREG                                                10650002
         USING IHADCB,DCBREG      SET REG FOR DCB REFERENCES            10700002
         USING INFMJFCB,JFCBREG   USED TO FIND JFCB STUFF               10720002
         ST    SAVEREG,SAVEAREA+4 SAVE ADDRESS OF CALLERS SAVE AREA     10750002
*                                 IN MY SAVE AREA                       10800002
         LA    EP,SAVEAREA        GET ADDRESS OF MY SAVE AREA AND       10850002
         ST    EP,8(0,SAVEREG)    STORE IN CALLERS SAVE AREA            10900002
         LR    SAVEREG,EP         LOAD MY SAVE REG WITH ADDRESS         10950002
*                                 OF MY SAVE AREA                       11000002
         EJECT                                                          11001002
GEN00100 EQU   *                  DATA SET VERIFICATION SECTION         11002002
         LA    JFCBREG,JFCBAREA   SET PTR TO JFCB AREA                  11003002
         LA    BCTREG,2           SET BCT LOOP COUNT TO TWO             11004002
         SPACE 2                                                        11005002
GEN00110 EQU   *                  READ THE JFCB INTO WORKAREA           11006002
         RDJFCB  (OUTDASD,(OUTPUT))   READ THE JFCB                     11007002
         SPACE 2                                                        11008002
         CLC   JFCBDSNM(13),LINKLIB    IS THIS AN INVALID DATA SET      11009002
         BE    GEN00120           YES, GO END THE JOB WITH MSG 909I     11010002
         CLC   JFCBDSNM(12),SVCLIB     IS THIS AN INVALID DATA SET      11011002
         BE    GEN00120           YES, GO END THE JOB WITH MSG 909I     11012002
         CLC   JFCBDSNM(12),LPALIB     IS THIS AN INVALID DATA SET      11013002
         BE    GEN00120           YES, GO END THE JOB WITH MSG 909I     11014002
         LA    DCBREG,OUTDASD     SET PTR TO DATA SET CB                11015002
         MVC   DCBDDNAM,SYMCDSDD  MOVE IN DD NAME FOR SECOND PASS       11016002
         BCT   BCTREG,GEN00110    FALL THRU OR GO TO NEXT PASS          11017002
         MVC   DCBDDNAM,OUTDADID  MOVE IN DD NAME FOR OPEN              11018002
         B     GEN00130           GO OPEN THE DATA SETS                 11019002
         SPACE  3                                                       11020002
GEN00120 EQU   *                  ENTER HERE IF DATA SET IS INVALID     11021002
         SPACE 2                                                        11022002
         OPEN  (PRINTER,(OUTPUT)) OPEN PRINT DCB                        11023002
         SPACE 2                                                        11024002
         LA    DCBREG,PRINTER     GET THE DCB ADDR FOR OPEN CHECK       11025002
         BAL   LINK,ABORTCK       GO CHECK IF DCB OPENED SUCCESSFULLY   11026002
         MVC   BADLIB+D10(12),JFCBDSNM MOVE IN DS NAME                  11027002
         LA    MSGADDR,BADLIB     GET MESSAGE POINTER                   11028002
         LA    LINK,GEN05000      GET END OF JOB RTN ADDRESS            11029002
         LA    LINECNT,1          SET COUNT TO SKIP A PAGE              11030002
         B     GEN04000           GO ISSUE MESSAGE AND END THE JOB      11031002
GEN00130 EQU   *                  GO OPEN THE DCBS                      11032002
         EJECT                                                          11050002
         OPEN  (INCARD,INPUT,OUTDASD,(OUTPUT),PRINTER,(OUTPUT))         11100002
         SPACE 3                                                        11150002
GEN00200 EQU   *                  START LOOP THRU DCBS                  11200002
         MVI   SWITCHS,HEX00      RESET ALL SWITCHES BEFORE INITIAL     11250002
         MVI   SWITCH2,X'00'      ZERO OUT SWITCH                       11300002
         MVI   SWITCH3,HEX00      ZERO OUT ALL SWITCHES                 11320002
         LA    DCBREG,PRINTER     GET ADDRESS OF DCB TO BE CHECKED      11350002
         BAL   LINK,ABORTCK       GO CHECK DCB OPEN FLAGS AND RETURN    11400002
         LA    DCBREG,INCARD      GET ADDRESS OF DCB TO BE TESTED       11450002
         BAL   LINK,ABORTCK       GO CHECK DCB OPEN FLAGS AND RETURN    11500002
         LA    DCBREG,OUTDASD     GET ADDRESS OF DCB TO BE TESTED       11550002
         BAL   LINK,ABORTCK       GO CHECK DCB OPEN FLAGS AND RETURN    11600002
*                                 SCAN UNTIL FALL THRU.                 11650002
*                                 READ                                  11700002
         B     GEN00300           BRANCH TO GET A CARD ROUTINE          11750002
         SPACE 5                                                        11800002
ABORTCK  TM    DCBOFLGS,OPEN      DID THIS DCB OPEN SUCCESSFULLY        11850002
         BNO   GEN99990           GO TO ABORT ROUTINE                   11900002
         BR    LINK               RETURN TO NEXT DCB ADDRESS CHK        11950002
          EJECT                                                         12000002
GEN00300 EQU   *                  BEGIN INITAL PROCESSING               12050002
         NI    SWITCHS,LASTPASS   RESET ALL SWITCHES OTHER THAN         12150002
*                                 LAST PASS INDICATOR                   12200002
         XC    TXTADR,TXTADR      RESET TXT AREA PTR TO ZEROS           12250002
         LA    TXTPTR,TXTAREA     GET POINTER TO TXT BUFFER             12300002
         MVC   SEQSAVE,EBCD0001   SET SEQ CTR TO ONE                    12350002
         SPACE 5                                                        12550002
GEN00400 EQU   *                  GET A RECORD FROM THE INPUT (80 BYTE) 12600002
*                                 FILE AND HAVE PUT INTO OLTEP          12650002
         GET   INCARD,READAREA    WORKAREA FOR EXPLINATION.             12700002
         TM    SWITCH3,FIRSTCD    IS THIS THE FIRST CARD                12750002
         BO    GEN00410           NO, BRANCH AROUND MESSAGE             12755002
         OI    SWITCH3,FIRSTCD    TURN ON FIRST CARD READ SWITCH        12760002
         CLC   READAREA(12),SYMCDSID IS THIS A CONTROL CARD             12765002
         BE    GEN00410           SECOND FILE. YES SKIP MESSAGE         12770002
         LA    LINECNT,1          SET CNT TO SKIP A PAGE                12775002
         LA    MSGADDR,LOCALOLT   GET MESSAGE POINTER                   12780002
         BAL   LINK,GEN04000      GO ISSUE MESSAGE AND RETURN           12785002
         SPACE 1                                                        12790002
GEN00410 EQU   *                  CONTINUE PROCESSING                   12795002
         BAL   LINK,GEN00420      GO CHECK THE SEQUENSE NUMBERS         12800002
         B     GEN00450           GO CONTINUE PROCESSING IN FILE        12850002
         EJECT                                                          12900002
GEN00420 EQU   *                  THIS ROUTINE EXAMINES THE ORDER OF    12950002
*                                 THINGS.  THE SEQ NO. ARE CHECKED      13000002
*                                 TO INSURE STRICT ASCENDING ORDER MIT  13050002
*                                 OUT NO GAPS...                        13100002
*                                 THE FOLLOWING CARDS ARE NOT CHECKED   13150002
*                                    1. SETSSI CARDS                    13200002
*                                    2. NAME CARDS                      13250002
*                                    3. REP CARDS                       13300002
*                                    4. SYMBOLIC CDS CONTROL CARDS      13350002
*                                                                       13400002
         SPACE 5                                                        13450002
         CLC   READAREA(4),REPID  IS THIS A REP CARD                    13500002
         BE    GEN00440           YES, GO HANDLE REP CARD               13530002
         CLI   READAREA,HEX02     IS THIS AN ASSEMBLER OUTPUT CARD      13560002
         BE    GEN00422            YES, GO CHECK SEQ NUMBER             13590002
         LA    BCTREG,72          NO, SCAN CARD FOR CONTROL CARD IDS    13620002
         LA    SCANREG,READAREA   SET UP POINTER TO CARD AREA           13650002
         SPACE  2                                                       13680002
GEN00421 EQU   *                  SCAN RECORD FOR CONTROL CARD ISD      13710002
         CLC   D0(12,SCANREG),SYMCDSID IS THIS A SYMBOLIC CDS           13740002
         BE    GEN02030           CONTROL CARD.  YES, GO HANDLE         13770002
         CLC   D0(L7,SCANREG),SETSSI IS THIS A SETSSI CONTROL CARD      13800002
         BE    GEN00400           YES, GO GET NEXT CARD                 13830002
         CLC   D0(5,SCANREG),NAMEID IS THIS A NAME CARD                 13860002
         BE    GEN00400           YES, GO GET NEXT CARD                 13890002
         LA    SCANREG,D1(SCANREG) BUMP READ AREA POINTER               13920002
         BCT   BCTREG,GEN00421    CONTINUE SCANNING TIL ZERO            13950002
         B     GEN00500             BRANCH OUT IF RECORD IS NEITHER     13980002
*                                 A CONTROL CARD  NOR A ASSEMBLER       14010002
*                                 OUTPUT RECORD                         14040002
GEN00422 CLC   READAREA+D76(4),SEQSAVE DOES RECVD EQUAL EXPECTED        14070002
         BNE   GEN00430           NO, GO TO ERROR ROUTINE               14100002
         LA    BCTREG,FOUR        SET LOOP CNT TO FOUR                  14130002
GEN00423 LA    ADDER,SEQSAVE-1(BCTREG) SET TARGET  ADDRESS              14160002
         TR    D0(1,ADDER),TRTAB-240 TRNASLATE IT                       14190002
         CLI   D0(ADDER),C'0'     DID IT GO TO ZERO                     14220002
         BNE   GEN00424           NO, EXIT SUBROUTINE                   14250002
         BCT   BCTREG,GEN00423    YES, CONTINUE LOOP                    14280002
GEN00424 BR    LINK               EXIT SRQUENSE CHECKER                 14310002
         EJECT                                                          14400002
GEN00430 EQU   *                  THIS ROUTINE PUTS OUT MESSAGE         14450002
*                                 IFD904I TO IDENTIFY AN ERROR OCCURED  14500002
*                                 THE MESSAGE WILL CONTAIN BOTH THE     14550002
*                                 EXPECTED AND RECIEVED SEQUENSE NO.    14600002
*                                 THIS ROUTINE WILL ALSO SKIP THE REM   14650002
*                                 AINDER OF THE MODULE CONTAINING       14700002
*                                 THE SEQUENSE ERROR                    14750002
         LA    MSGADDR,SEQERROR   GET ADDRESS OF MESSAGE TO BE PRINTED  14800002
         MVC   SEQERROR+D24(4),SEQSAVE MOVE IN EXPECTED SEQ NO.         14850002
         MVC   SEQERROR+D34(4),READAREA+D76 MOVE IN RECD SEQ NUMBER     14900002
         MVC   SEQERROR+D46(8),NAMESAVE MOVE IN MODULE NAME             14950002
         XC    NAMESAVE,NAMESAVE  ZAP NAME FIELD CLEAN                  15000002
         BAL   LINK,GEN04000      GO PUT OUT THE MESSAGE AND RTN        15050002
         TM    SWITCH2,POINTOK    IS IT OK TO ISSUE A POINT MACRO       15060002
         BNO   GEN00432           NO, BYPASS ISSUING POINT MACRO        15070002
         POINT OUTDASD,TTSAVE     ISSUE POINT TO SAVE DASD SPACE        15090002
         B     GEN00432           GO CK CARD IN BUFFER                  15110002
         EJECT                                                          15150002
GEN00431 EQU   *                  LOOP THRU MODULE                      15200002
         GET   INCARD,READAREA    LOOP TO END OF THIS MODULE            15250002
GEN00432 EQU   *         CHECK CARD JUST READ IN BUFFER                 15270002
         CLC   READAREA(4),ESDID  IS THIS AN ESD CARD                   15300002
         BNE   GEN00431           NO GO GET NEXT CARD                   15350002
         CLC   READAREA+D14(2),HEX0001 IS THIS THE FIRST ESD OF NEXT    15400002
*                                 MODULE                                15450002
         BNE   GEN00431           NO, SKIP CARD                         15500002
         MVC   SEQSAVE,EBCD0002   YES PRIME SEQ CKR                     15550002
         B     GEN00700           GO PROCESS ESD CARD                   15600002
         EJECT                                                          15650002
GEN00440 EQU   *                  REP CARD SCANNER                      15700002
         TM    SWITCH3,RLDREAD    HAS AN RLD BEEN READ YET.             15710002
         BO    GEN01500           YES, GO HANDLE ORDER ERROR            15720002
         OI    SWITCH3,REPREAD    SET SWITCH INDICATING REP CARD READ   15730002
         SPACE 1                                                        15750002
         LA    SLOT,READAREA+D6   GET ADDRESS OF FIELD IN REP CARD      15800002
         LA    SCANCNT,SIX        SET COUNT TO NO. OF BYTES TO BE CHKED 15850002
         BAL   LINK,GEN00442      GO SCAN ADDR PORTION OF REP CARD      15900002
         SPACE 1                                                        15950002
         CLC   READAREA+D4(2),BLANKCOL CHECK FIELD FO TWO BLANKS        16000002
         BNE   GEN00446           IF NON-BLANK, TAKE BRANCH             16050002
         CLC   READAREA+D12(4),BLANKCOL   CHECK FOR FOUR BLKS           16100002
         BNE   GEN00446           IF NON-BLANK, TAKE BRANCH             16150002
         SPACE 1                                                        16200002
         LA    SLOT,READAREA+D16  SET PTR TO FIRST REP CHARACTER        16250002
GEN00441 LA    SCANCNT,FOUR       SET LOOP COUNT TO NO. OF BYTES        16300002
         BAL   LINK,GEN00442      GO SCAN FIELD AND RETURN IF OK        16350002
         B     GEN00444           GO CHECK FOR ENDING CONDITIONS        16400002
         SPACE 3                                                        16450002
GEN00442 EQU   *                  SCANNER PORTION OF RTN                16500002
         CLI   D0(SLOT),F9        IS CHAR POINTED TO BY SLOT G.T. A     16550002
         BH    GEN00446           HEX F9.  BRANCH IF YES                16600002
         SPACE 1                                                        16650002
         CLI   D0(SLOT),C1        IS CHAR LESS THAN A HEX C1            16700002
         BL    GEN00446           IF SO BRANCH OUT                      16750002
         SPACE 1                                                        16800002
         CLI   D0(SLOT),C6        IS CHAR BETWEEW A C1 AND C6           16850002
         BNH   GEN00443           IF LESS OR EQUAL ALL IS OK            16900002
         SPACE 1                                                        16950002
         CLI   D0(SLOT),F0        IF CHAR IS G. T. C6 THEN IS IT        17000002
*                                 BETWEEN F0 AND F9                     17050002
         BL    GEN00446           BRANCH IS ILLEGAL                     17100002
         SPACE 1                                                        17150002
GEN00443 EQU   *                                                        17200002
         LA    SLOT,D1(SLOT)      BUMP COUNT TO NEXT CHAR               17250002
         BCT   SCANCNT,GEN00442   GO CHECK NEXT CHAR OR FALL THRU       17300002
         BR    LINK               BRANCH IS CHARACTER IS AOK            17350002
         EJECT                                                          17400002
GEN00444 EQU   *                 END CONITION CHKER                     17450002
*                                 ON ENTRY, SLOT WILL POINT TO NEXT     17500002
*                                 CHARACTER TO BE CHECKED, THAT IS ,    17550002
*                                 A RUDDY BLANK, OR A COMMA.  A COMMA   17600002
*                                 WILL CAUSE THE SCAN TO CONTINUE       17650002
*                                 A BLANK WILL TERMINATE THE SCAN.      17700002
*                                 ANYTHING ELSE IS CONSIDERED AN ERROR  17750002
         CLI   D0(SLOT),COMMA     IS THIS A COMA                        17800002
         BE    GEN00445           BRANCH IF YES                         17850002
         CLI   D0(SLOT),BLANK     IS THIS A BLANK COL INDIC. END        17900002
         BE    GEN01000           IF YES BRANCH OUT OF SCANNER          17950002
         B     GEN00446           NO, ERROR EXIT FROM SCANNER           18000002
         SPACE 1                                                        18050002
GEN00445 EQU   *                  BUMP AND GO                           18100002
         LA    SLOT,D1(SLOT)      ADD ONE TO POINTER AND                18150002
         B     GEN00441           GO HANDLE NEXT REP AREA               18200002
         SPACE 1                                                        18250002
GEN00446 EQU   *                  ENTER HERE ON A REP CARD ERROR        18300002
         TM    SWITCH2,POINTOK    IS IT OK TO ISSUE POINT MACRO         18310002
         BNO   GEN00447           NO, BYPASS POINT MACRO                18320002
         SPACE  3                                                       18330002
         POINT OUTDASD,TTSAVE     SST TTRZ BACK TO ESD 0001 TIME        18350002
         SPACE   3                                                      18360002
GEN00447 EQU   *                  ENTER HERE ON NO POINT SITUATIONS     18370002
         LA    MSGADDR,IGNORECD   SET ADDRESS OF MESSAGE                18400002
         MVC   IGNORECD+D17(8),NAMESAVE GET MOD NAME BEING JUNKED       18450002
         MVC   IGNORECD+D36(80),READAREA MOVE IN ERRORED CARD FOR MSG   18500002
         XC    NAMESAVE,NAMESAVE  ZAP NAME TO NON PRINTABLES            18550002
         BAL   LINK,GEN04000      GO PRINT OUT ERROR MESSAGE            18600002
         B     GEN00431           GO SCAN TO NEXT VALID ENTRY           18650002
*                                 POINT, THAT IS, AN ESD CARD WITH A    18700002
*                                 001 IN COLUMNS                        18750002
         EJECT                                                          18800002
GEN00450 EQU   *                  CONTINUE PROCESSING INFILE            18850002
         CLC   READAREA(FOUR),ESDID IS THIS AN ESD CARD                 18900002
         BE    GEN00700           YES,GO CHECK FOR FIRST ESD READ       18950002
         SPACE 3                                                        19000002
         CLC   READAREA(FOUR),TXTID IS THIS A TEXT CARD                 19050002
         BE    GEN00800           YES, GO TO TXT CARD HANDLER           19100002
         SPACE 3                                                        19150002
         CLC   READAREA(FOUR),RLDID IS THIS AN RLD CARD                 19200002
         BNE   GEN00455           NO, CONTINUE PROCESSING.              19250002
         OI    SWITCH3,RLDREAD    SET RLDREAD INDICATOR                 19260002
         B     GEN01000           GO WRITE RECORD                       19270002
         SPACE 3                                                        19300002
GEN00455 EQU   *                  IS THIS AN END STOW SITUATION         19350002
         CLC   READAREA(FOUR),ENDID END CARD IN BUFFER.                 19370002
         BNE   GEN00500           NO, CHECK FOR SYMBOLIC CDS CARD       19400002
         SPACE 3                                                        19450002
         OI    SWITCHS,NEEDNAME   SET SWITCH FORCEING NEXT CARD         19500002
*                                 TO BE A NAME CARD                     19550002
         B     GEN01000           GO PROCESS THIS END CARD              19600002
         SPACE 3                                                        19650002
         EJECT                                                          19700002
GEN00500 EQU   *                  ENTER HERE WHEN AN UNEXPECTED         19750002
*                                 CARD WAS RECIEVED. THIS ROUTINE       19780002
*                                 WILL OUTPUT MSG IFD900I, FLUSH        19810002
*                                 THE CARD AND CONTINUE PROCESSING.     19840002
         LA    MSGADDR,BADCARD    GET ADDRESS OF MESSAGE                19870002
         MVC   D34(80,MSGADDR),READAREA MOVE CARD TO MESSAGE            19900002
         BAL   LINK,GEN04000      GO PRINT MESSAGE AND RETURN           19930002
         B     GEN00400           GO GET NEXT CARD                      19960002
         EJECT                                                          20050002
         SPACE 5                                                        20100002
GEN00700 EQU   *                  ESD CHECK RTN.                        20150002
         CLC   READAREA+D14(TWO),HEX0001 IS THIS THE                    20200002
*                                 FIRST ESD CARD                        20250002
         BNE   GEN01000           NO, GO HANDLE NORMALLY, WRITE CD.     20300002
GEN00710 EQU   *                  ENTER HERE WHEN NO STOW REQUIRED      20350002
         NI    SWITCH2,ALL-POINTOK          MODULES SWITCHS             20360002
         NI    SWITCH3,ALL-REPREAD-RLDREAD FOR THIS MODULE              20370002
         OI    SWITCHS,SAVETTRZ   YES, SET SW TO SAVE TTRZ              20400002
         MVI   STOWOK+45,BLANK         OLT RUNS IN REAL          XM3316 20405002
         CLI   READAREA+D32,POUND IS THIS A NEW OLT                     20410002
         BE    GEN00720           YES, GO GET NAME TO STOW              20420002
         CLI   READAREA+D21,HEXF0 IS THIS A NO. (NEWOLT)                20430002
         BL    GEN00720           YES, GO GET NAME TO BE STOWED         20440002
         MVC   NAMESAVE,READAREA+D32 MOVE NAME TO BE STOWED             20450002
         B     GEN00730           GO CHECK FOR INVALID NAME             20460002
         SPACE   3                                                      20470002
GEN00720 EQU   *                  ENTER HERE FOR NEW OLTS ONLY          20480002
         MVC   NAMESAVE,READAREA+D16 MOVE NAME TO BE STOWED             20490002
         MVC   USERINFO(1),READAREA+38  MOVE INTO DIRECTORY THE         20492002
*                                 INFO USED AT LOAD TIME TO DETERMINE   20494002
*                                 THE V=V OR V=R CAPABILITY             20496002
         TM    USERINFO,VIRTUAL        CAN OLT RUN IN VIRTUAL    XM3316 20496802
         BNO   GEN00730                NO, CONTINUE              XM3316 20497602
         MVI   STOWOK+45,LETTERV       YES, INDICATE IN MSG THAT XM3316 20498402
*                                      OLT CAN RUN IN VIRTUAL    XM3316 20499202
GEN00730 EQU   *                  OK NAME TO BE STORED.                 20500002
         CLI   NAMESAVE,BLANK     IS THIS A BLANK                       20507002
         BNE   GEN01000  CONTINUE PROCESSING - WRITE RECORD             20514002
         LA    MSGADDR,BADCARD   GET MSG POINTER                        20521002
         MVC   D34(80,MSGADDR),READAREA MOVE CARD TO BUFFER             20528002
         BAL   LINK,GEN04000      ISSUE MESSAGE                         20535002
         B     GEN00431           GO SCAN TO NEXT ESD CARD.             20542002
         EJECT                                                          20550002
GEN00800 EQU   *                  TEXT CARD ROUTINE                     20600002
         TM    SWITCH3,REPREAD+RLDREAD    HAS A REP OR RLD BEEN READ    20610002
         BNZ   GEN01500           IF EITHER IS ON AN ERROR IS HERE      20620002
         CLC   READAREA+D10(L2),HEX0000 IS THE COUNT OF TXT BYTES       20650002
*                                 ZERO                                  20700002
         BE    GEN00400           YES, GO GET NEXT CARD                 20750002
*                                 THE DATA (TXT) COUNT IS NOT ZERO      20800002
         CL    TXTPTR,TXTADSV     IS THIS FIRST TXT CARD                20850002
         BE    GEN00820           YES, GO SETUP TXT HEADER              20900002
         CLC   TXTADR+D1(THREE),READAREA+D5 SHOULD THIS CARD GO         20950002
*                                 INTO OUTDASD BUFFER                   21000002
         BNE   GEN00830           IF A HOLE OR NEG REF, GO WRITE REVORD 21050002
         SPACE 2                                                        21100002
         CLC   TEXTID(2),READAREA+D14 ARE THE TEXT ID S THE SAME        21150002
         BNE   GEN00830           NO, GO WRITE TEXT HRD AND BUFFER      21200002
         SPACE 2                                                        21250002
GEN00810 EQU   *                  TEXT BUFFER MANIPULATOR SECTION       21300002
         MVC   TEXTID(2),READAREA+D14  SAVE THE TEXT ID FIELD   XM1330  21350002
         LH    ACCUMRG,READAREA+D10  GET DATA CNT                       21400002
         LR    WORKRG1,ACCUMRG    SAVE IT                               21450002
         AH    ACCUMRG,DATACNT+1                                        21500002
         CL    ACCUMRG,SIZETXT     SHOULD I WRITE IT                    21550002
         BH    GEN00830           YES, GO WRITE                         21600002
GEN00815 EQU   *                  ENTER HERE FROM HOLE FILLER           21650002
         STH   ACCUMRG,DATACNT+1  GET ACCUMULATED USED BUFFER COUNT     21700002
         BCTR  WORKREG1,ZERO      SUBTRACT ONE FOR EX MOVE              21750002
         EX    WORKREG1,DATAMVC   EX MVC DATA INTO BUFFER               21800002
         LA    TXTPTR,D1(WORKREG1,TXTPTR) BUMP BUFFER POINTER           21850002
*                                 TO NEXT AVAILABLE POINTER             21900002
         MVC   TXTADR+D1(L3),READAREA+D5  GET RELATIVE ASSEMBLED        21950002
*                                 ADDRESS FOR THIS CARD.                22000002
         L     ACCUMRG,TXTADR     OBTAIN BEGINNING REL. TXT ASSMBLED    22050002
*                                 ADDRESS                               22100002
         LA    ACCUMRG,D1(ACCUMRG,WORKREG1) BUMP ASSM ADDR TO WHERE     22150002
*                                 THE NEXT TXT BYTE SHOULD OCCUR        22200002
         ST    ACCUMRG,TXTADR     SAVE THIS FOR NEXT RECORD PLACEMENT   22250002
         B     GEN00400           GO GET NEXT RECORD                    22300002
         SPACE 5                                                        22350002
GEN00820 EQU   *                  CLEAN-UP COUNTS FIRST TXT CD RTN      22400002
         XC    DATACNT,DATACNT    RESET THE COUNT                       22450002
         MVC   DATAADRS,READAREA+D5 SET ADDR OF FIRST BYTE OF TXT       22500002
*                                 DATA IN TXT HEADER CARD               22550002
         B     GEN00810           GO PROCESS CARD                       22600002
         SPACE 5                                                        22650002
GEN00830 EQU   *                  HEADER WRITE RTN                      22700002
         BAL   LINK,GEN00900      GO WRITE BOTH TXT HEADER              22750002
*                                 AND TXT INFORMATION BECAUSE CARD      22800002
         XC    DATACNT,DATACNT     SET DATA COUNT IN TXTHDR REC TO ZIP  22850002
         MVC   DATAADRS,READAREA+D5 SET NEW ADDRESS             XM1330  22900002
         B     GEN00810           AND THEN GO HANDLE CARD               22950002
         EJECT                                                          23000002
GEN00900 EQU   *                  PREPARE TO WRITE A TXT HDR RECORD     23050002
         LA    WORKRG1,HEX50      GET REC SIZE FOR WRITE                23100002
         STH WORKRG1,GENDECB+D6   PUT SIZE INTO MACRO                   23150002
         LA    WORKRG1,TXTHDR     GET ADDRESS OF AREA TOBE WRITTEN      23200002
         MVC   TXTHDR+D25(2),TEXTID PLACE TEXT ID  INTO TXTHRD          23250002
         ST    WORKRG1,GENDECB+D12 STORE ADDRESS INTO WRITE MACRO       23300002
         BAL   WRTLINK,GEN00920   GO WRITE TEXT HEADER RECORD ON DASD   23350002
         SPACE 5                                                        23400002
         MVC   GENDECB+D6(2),DATACNT+1  GET SIZE OF TXT REC TO BE       23450002
*                                 WRITTEN                               23500002
         MVC   GENDECB+D12(4),TXTADSV MOVE ADDRESS TO MACRO             23550002
GEN00910 EQU   *                  RESET POINTER                         23600002
         LA    TXTPTR,TXTAREA     SET POINTER TO BEGINNING OF TEXT      23650002
*                                 OUTPUT BUFFER.                        23700002
         XC    TXTADR,TXTADR      ZERO OUT ADDR OF NEXT AVAIL           23750002
*                                 BYTE IN BUFFER AREA                   23800002
         BAL   WRTLINK,GEN00920   GO WRITE RECORD ON DASD               23850002
         BR    LINK               CONTINUE PROCESSING RECORD            23900002
         SPACE  5                                                       23950002
GEN00920 EQU   *                  IO ROUTINE                            24000002
         WRITE GENDECB,SF,OUTDASD,0,0  CAUSE CD TO WRITE RECORD         24050002
*                                 ONTO OUTPUT DADS FILE.                24100002
         CHECK GENDECB            WAIT FOR COMPLETION OF I/O OPERATION  24150002
         OI    SWITCH2,POINTOK    SET SW TO ALLOW A POINT               24170002
         BR    WRTLINK            RETURN ON BALR TO CALLER              24200002
         SPACE 5                                                        24250002
GEN01000 EQU   *                  HANDLE ESD CARD OTH THAN FIRST       24300002
*                                 HANDLE END CARD                       24350002
*                                 HANDLE RLD CARD                       24400002
*                                 HANDLE REP CARD                       24450002
         CL    TXTPTR,TXTADSV     WAS THERE ANY INFORMATION TO BE       24500002
*                                 WRITTEN BEFORE THIS CARD.             24550002
         BE    GEN01010           NO, BYPASS WRITE                      24600002
         BAL   LINK,GEN00900      YES, GO WRITE OUT TXT ACCUMULATED     24650002
         SPACE 3                                                        24700002
         SPACE 2                                                        24750002
GEN01010 EQU   *                  PREPARE TO WRITE RECORD OTHER         24800002
*                                 THEN TXT RECORD                       24850002
         LA    WORKRG1,READAREA   GET ADDRESS OF AREA TO BE WRITTEN     24900002
         ST    WORKREG1,GENDECB+D12    MOVE ADDRESS TO MACRO            24950002
         LA    WORKRG1,HEX50      GET COUNT OF DATA TO BE WRITTEN       25000002
         STH   WORKRG1,GENDECB+D6 MOVE COUNT TO MACRO                   25050002
         BAL   LINK,GEN00910      GO WRITE RECORD                       25100002
         TM    SWITCHS,NEEDNAME   CAN A STOW BE DONE                    25150002
         BO    GEN03000           YES GO STOW MODULE TO DIRECTORY       25200002
         TM    SWITCHS,SAVETTRZ   SHOULD A NOTE BE ISSUED               25250002
         BNO   GEN01011           NOT A ESD 001 NO NOTE NEEDED          25300002
         NOTE  OUTDASD            SET FOR POINT IF ERROR SHOWS          25350002
         ST    TTREG1,TTSAVE      SAVE TTRZ OF NEXT WRITE               25400002
         NI    SWITCHS,ALL-SAVETTRZ  SET SW OFF FOR NEXT READ           25450002
GEN01011 EQU   *                  ENTER HERE IF NO NOTE REQ.            25500002
         B     GEN00400           GO GET NEXT INPUT RECORD              25550002
         SPACE 2                                                        25555002
GEN01500 EQU   *                  THIS ROUTINE IS ENTERED WHEN A        25560002
*                                 CARD WAS OUT OF ORDER.                25565002
         LA    MSGADDR,ORDERERR   GET MSG POINTER                       25570002
         MVC   ORDERERR+D21(8),NAMESAVE MOVE NAME TO MESSAGE            25575002
         MVC   ORDERERR+D39(80),READAREA MOVE BAD CARD TO MESSAGE .     25580002
         BAL   LINK,GEN04000      GO ISSUE MESSAGE AND RETURN           25585002
         B     GEN00431           GO TO NEXT MODULE FINDER              25590002
         EJECT                                                          25600002
GEN02030 EQU   *                  START CDS FILE PROCESSING             25650002
GEN02031 EQU   *                                                        25700002
         CLOSE OUTDASD            CLOSE OLT FILE                        25750002
         SPACE   2                                                      25800002
         LA    DCBREG,OUTDASD     GET ADDR OF DCB FOR OPEN CHK AND      25850002
         MVC   DCBDDNAM,SYMCDSDD  MOVE IN DD NAME FOR SECOND FILE       25900002
*                                 PRIOR TO OPENING                      25950002
         OI    SWITCHS,LASTPASS        SET LAST PASS SW          X03008 25970002
         OPEN  (OUTDASD,(OUTPUT)) OPEN NEW DATA SET FOR ODS             26000002
         TM    DCBOFLGS,OPEN      DID NEW DATA SET OPEN                 26050002
         BNO   GEN99990           GO TO ABORT ROUTINE                   26100002
         OI    SWITCHS,LASTPASS   SET LAST PASS SWITCH                  26150002
         LA    MSGADDR,SYMDATAS   GET MESSAGE ADDRESS                   26200002
         LA    LINECNT,1          SET NEW PAGE INDICATOR                26300002
         BAL   LINK,GEN04000      GO PRINT OUT THE MESSAGE              26350002
         MVI   PRTBUFF,HEX03      SET MACHINE CODE TO SKIP A LINE       26400002
         XC    PRTBUFF+D1(L'PRTBUFF-1),PRTBUFF+D1 CLEAR OUT BUFFER      26450002
         PUT   PRINTER,PRTBUFF                                          26500002
         MVC   SEQSAVE,EBCD0001   RESET SEQ COUNTER TO FIRST CARD       26510002
         NI    SWITCH2,POINTOK    TURN OFF POINT OK SW                  26520002
         NI    SWITCHS,ALL-SAVETTRZ-NEEDNAME TURN OFF TTRZ AND STOW SW  26530002
         B     GEN00400           GO PROCESS THE RUDDY FILE             26550002
         SPACE 2                                                        26600002
         SPACE 3                                                        26650002
         EJECT                                                          26700002
GEN03000 EQU   *                  UPDATE DIRECTORY                      26750002
         MVC   STOWNAME,NAMESAVE                         STOW  NAME     26800002
         NI    SWITCHS,ALL-NEEDNAME  TURN OFF NAME REQUIREMENT          26850002
         STOW  OUTDASD,STOWCON,R  STOW NAME INTO DIRECTORY ON DASD      26900002
         LTR   STOWRC,STOWRC      DID STOW TAKE                         26950002
         LA    MSGADDR,STOWOK     GET MSG ADDRESS FOR SUCCESS           27000002
         MVC   STOWOK+36(9),REPCON   MOVE IN REPLACED CONSTANT          27050002
         BZ    GEN03010           YES, PRINT OUT MSG.                   27100002
         LA    WORKRG1,8          GET POSSIBLE RETURN CODE              27150002
         CR    WORKRG1,STOWRC       WAS MODULE REPLACED                 27200002
         BNE   GEN03005           ERROR MSG                             27250002
         MVC   STOWOK+36(9),ADDCON   MOVE IN ADDED CONSTANT             27300002
         LA    MSGADDR,STOWOK     GET MSG ADDRESS FOR SUCCESS           27350002
         B     GEN03010           YES, PRINT OUT MSG.                   27400002
GEN03005 EQU   *                  ERROR                                 27450002
         OI    SWITCH2,ENDJOB     SET BAIL OUT SWITCH                   27500002
         LA    WORKRG1,D4(WORKRG1)  BUMP REG TO X'0C'                   27550002
         CR    WORKREG1,STOWRC    IS RETURN CODE A X'0C'                27600002
         BE    GEN03006           YES GO HANDLE FULL DIRECTORY COND     27650002
         LA    MSGADDR,PERMIOER   GET MESSAGE ADDRESS                   27700002
         B     GEN03010           GO OUT THE MSG NAME                   27750002
GEN03006 EQU   *                  HANDLE STOW ERRORS                    27800002
         LA    MSGADDR,DIRTFULL   SET UP MESSAGE INDICATING ERROR       27850002
         SPACE   2                                                      27900002
GEN03010 EQU   *                  FAILURE                               27950002
         MVC   D12(L8,MSGADDR),STOWNAME MOVE NAME OF MODULE             28000002
         XC    NAMESAVE,NAMESAVE  CLEAR NAME TO ZEROS                   28010002
         NI    SWITCH2,ALL-POINTOK  TURN OFF SWITCH ALLOWING POINT      28020002
         BAL   LINK,GEN04000      INTO OUT-PUT MSG AND GO               28050002
*                                 PRINT IT OUT                          28100002
         TM    SWITCH2,ENDJOB     IS THIS JOB DONE                      28150002
         BO    GEN05000           YES, PACK IT IN                       28200002
         MVC   SEQSAVE,EBCD0001   RESET THE SEQ COUNT TO ONE            28250002
         B     GEN00400           GO GET NEXT RECORD                    28300002
         EJECT                                                          28350002
GEN04000 EQU   *                  SET UP FOR LINE PRINTING              28400002
         MVI   PRTBUFF+D1,BLANK   BEGIN CLEARING BUFFER TO BLANKS       28450002
         MVC   PRTBUFF+D2(L118),PRTBUFF+D1 CLEAR REMAINDER OF BUFFER    28500002
         MVI   PRTBUFF,RESTORE    SET BYTE FOR NEW PAGE                 28550002
         BCT   LINECNT,GEN04010   DECREMENT UNTIL ZIP, THEN             28600002
         PUT   PRINTER,PRTBUFF    SKIP TO NEXT PAGE                     28650002
*                                 GET NEW PAGE                          28700002
         LA    LINECNT,HEX38      SET COUNT TO 56 LINES PER             28750002
*                                 PAGE                                  28800002
GEN04010 EQU   *                  SET CARRIAGE CONTROL                  28850002
         MVI   PRTBUFF,WRTSP1     TO WRITE AND SKIP ONE LINE            28900002
GEN04020 EQU   *                  SET UP MSG TO BE PRINTED              28950002
         IC    MSGSIZRG,D0(MSGADDR)  GET SIZE OF MESSAGE                29000002
         BCTR  MSGSIZRG,ZERO        DECREMENT OF MSG BY  1              29050002
*                                 FOR EX MVC                            29100002
         EX    MSGSIZRG,MVCPRTBF  MOVE MSG INTO PRINT BUFFER VIA EX     29150002
         XR    MSGSIZRG,MSGSIZRG  ZERO OUT MSG LNG REG                  29200002
         PUT   PRINTER,PRTBUFF    WRITE A LINE                          29250002
         BR    LINK               RETURN ON BALR                        29300002
         SPACE 3                                                        29350002
         EJECT                                                          29400002
GEN05000 EQU   *                  EODAD ROUTINE                         29450002
         CLOSE (OUTDASD,,PRINTER,,INCARD) PACK IT IN                    29500002
         L     SAVEREG,D4(SAVEREG) EXIT LINKAGE                         29550002
         SPACE 3                                                        29600002
         RETURN (14,12),T,RC=0    EXIT MODULE                           29650002
         EJECT                                                          29700002
GEN06000 EQU   *                  END OF FILE ROUTINE                   29750002
*                                 THIS ROUTINE GET CTL ON END OF DATA   29800002
*                                 FOR CARD INPUT ONCE AND TWICE FOR     29850002
*                                 TAPE INPUT. FOR CARD INPUT THE RUN    29900002
*                                 IS COMPLETE                           29950002
*                                 FOR TAPE A READ JFCB IS ISSUED TO     30000002
*                                 BUMP THE FILE SEQ NO. AND AN OPEN     30050002
*                                 TYPE=J IS ISSUES TO THE TAPE.         30100002
*                                 TE                                    30150002
*                                 THE TAPE WAS 'CLOSED' VIA CLOSE WITH  30200002
*                                 A LEAVE PARAMETER                     30250002
*                                 AFTER THE SECOND EOD RTN IS ENTERED   30300002
*                                 THE RUN IS COMPLETE                   30350002
         TM    SWITCHS,LASTPASS   IF THE SWITCH IS ON                   30450002
         BO    GEN05000           GO TO END THE JOB AS FILE IS EMPTY    30500002
         LA    WORKRG1,INCARD     GET ADDRESS IF DCB FOR INPUT FILE     30550002
         MVC   ANSWER(1),D17(WORKRG1) GET DEV TYPE                      30600002
         NI    ANSWER,ALL-3       ZAP OUT UNUSED BITS           OX01911 30650002
         CLI   ANSWER,HEX80       IS INPUT DEVICE A TAPE                30700002
         BNE   GEN05000           NO, GO TO END THE JOB                 30750002
         SPACE  4                                                       30800002
         CLOSE  (INCARD,LEAVE)    CLOSE THE RUDDY FILE                  30900002
         SPACE 2                                                        30950002
         RDJFCB (INCARD,INPUT)    READ JOB FILE CTL BLK AND ALTER IT    31000002
         SPACE 2                                                        31050002
         LA    JFCBREG,JFCBAREA   GET POINTER TO JFCB                   31070002
         LH    COMMON,JFCBFLSQ    PICK UP THE FILE SEQUENSE NUMBER      31090002
         LA    COMMON,D1(COMMON)  AND ADD ONE TO IT FOR                 31110002
         STH   COMMON,JFCBFLSQ    THE SECOND FILE PROCESS               31130002
         MVI    EOV,HEX00         TURN OFF TAPE CTR ROUTINE    @ZA08990 31135037
         L      COMMON,#TAPES     GET NUMBER OF TAPES IN FILE  @ZA08990 31140037
         STH    COMMON,JFCBVLSQ   PUT IT INTO JFCB             @ZA08990 31145037
         SPACE 1                                                        31150002
         SPACE  4                                                       31200002
         OPEN  (INCARD,INPUT),TYPE=J    OPEN SECOND FILE                31250002
         OI    SWITCHS,LASTPASS   SET END INDICATOR FOR NEXT PASS       31300002
         SPACE 4                                                        31350002
         LA    DCBREG,INCARD      GET PTR TO DCB                        31400002
         TM    DCBOFLGS,OPEN      DID THE FILE OPEN                     31450002
         BNO   GEN99990           NO, PACK IN THE JOB                   31500002
         B     GEN02031           GO, PROCESS SECOND FILE               31550002
GEN07000  EQU    *                                             @ZA08990 31553037
*                                 THIS ROUTINE GETS CONTROL    @ZA08990 31556037
*                                 AT EACH END OF VOLUME IN     @ZA08990 31559037
*                                 FILE 1 OF AN INPUT TAPE. IT  @ZA08990 31562037
*                                 COUNTS THE NUMBER OF TAPES IN         31565037
*                                 FILE 1. THIS COUNT IS USED BY         31568037
*                                 THE END OF FILE ROUTINE TO   @ZA08990 31571037
*                                 UPDATE THE JFCB SO THAT THE  @ZA08990 31574037
*                                 CORRECT TAPE IS USED TO      @ZA08990 31577037
*                                 OPEN FILE 2.                 @ZA08990 31580037
         L     COMMON,#TAPES      GET # OF TAPES SO FAR        @ZA08990 31583037
         LA    COMMON,D1(,COMMON) INCREMENT IT                 @ZA08990 31586037
         ST    COMMON,#TAPES      SAVE FOR EOF ROUTINE         @ZA08990 31589037
         BR    14                 TO PROCESS NEXT TAPE         @ZA08990 31592037
         EJECT                                                          31600002
GEN99990 EQU   *                  THIS ROUTINE GETS CONTROL WHEN        31650002
*                                 A DCB FAILS TO OPEN, IF THE DCB       31700002
*                                 WHICH FAILS TO OPEN IS THE PTINT      31750002
*                                 DCB, A 'WTO' MACR IS ISSUED TO        31800002
*                                 THE OPERATORS CONSOLE. IF THE         31850002
*                                 DCB IS OTHER THAN TO PRINT DCB        31900002
*                                 MESSAGE 'IFD901I' IS ISSUED           31950002
*                                 TO THE PRINTER WITH THE DD NAME       32000002
*                                 CORRESPONDING TO THE FAILED DCB       32050002
*                                 IN THE MESSAGE.                       32100002
         LA    LINK,GEN05000      SET RETURN REGISTER                   32150002
         LA    COMMON,PRINTER     GET ADDRESS OF PRINTDD DCB            32200002
         CR    DCBREG,COMMON      IS THIS FAILING DCB                   32250002
         BNE   GEN99991           DCB.  NO, GO CHK INPUT DCB            32300002
         SPACE  2                                                       32350002
         WTO   ' IFD901I    DIAGMSG DDCARD FAILED TO OPEN' ISSUE MSG    32400002
         B     GEN05000           GO END THE JOB                        32450002
         SPACE   2                                                      32500002
GEN99991 EQU   *                  CHECK INPUT DD DCB                    32550002
         LA    COMMON,INCARD      GET ADDR OF INCARD DCB                32650002
         CR    DCBREG,COMMON      IS THIS FAILING DCB                   32700002
         LA    MSGADDR,FAILDCB    GET ADDRESS OF MESSADGE       X03008  32760002
         BNE   GEN99992           NO, GO CHECK OUTDASD DCB              32770002
         MVC   D12(L8,MSGADDR),INPUTID MOVE IN DD NAME                  32800002
         B     GEN04000           GO ISSUE MESSAGE                      32850002
         SPACE   2                                                      32900002
GEN99992 EQU   *                  CHECK FOR CORRECT DD NAME             32950002
         TM    SWITCHS,LASTPASS   IS THIS THE SYMBOLIC DCB              33000002
         BNO   GEN99993           NO, USE OUTDADA1 AS DDNAME            33050002
         MVC   D12(L8,MSGADDR),SYMCDSDD MOCE IN DDNAME                  33100002
         B     GEN04000           GO PUT OUT MESSAGE                    33150002
         SPACE  2                                                       33200002
GEN99993 EQU   *                  MOVE IN DD NAME                       33250002
         MVC   D12(L8,MSGADDR),OUTDADID MOVE DD NAME TO MSG             33300002
         B     GEN04000           GO ISSUE MESSAGE                      33350002
         SPACE  3                                                       33400002
MVCPRTBF MVC   PRTBUFF+D1(ZERO),D1(MSGADDR) MOVE MSG INTO BUFFER        33450002
DATAMVC   MVC  D0(L0,TXTPTR),READAREA+16  MOVE DATA TO BUFFER           33500002
         SPACE 3                                                        33550002
ANSWER   DC    CL1' '             WORK AREA IN JFCB RTN                 33600002
         DS    0F                 FORCE BOUNDARY                        33650002
SWITCH2  DC    C' SWITCH2'                                              33700002
SWITCHS  DC    C' SWITCHS'        SWITCHS FOR MODULE                    33750002
SWITCH3  DC    C' SWITCH3'        INTERNAL SWITCHS                      33770002
HEX0001  DC    H'0001'                                                  33800002
HEX0000  DC    XL2'0000'                                                33850002
ESDID    DS    0CL4               SET SYMBOLIC FOR ADDR                 33900002
         DC    X'02'              SET 0-9-12                            33950002
         DC    C'ESD'             SET ESD FOR COMPARE                   34000002
TXTID    DS    0CL4               SET SYMBOLIC FOR ADDR                 34050002
         DC    X'02'              SET 0-9-12                            34100002
         DC    C'TXT'             SET TXT FOR COMPARE                   34150002
REPID    DS    0CL4               SET SYMBOLIC FOR ADDR                 34200002
         DC    X'02'              SET CODE                              34250002
         DC    C'REP'             SET REP FOR COMPARE                   34300002
RLDID    DS    0CL4               SET SYMBOLIC FOR ADDR                 34350002
         DC    X'02'              SET CODE                              34400002
         DC    C'RLD'             SET RLD FOR COMPARE                   34450002
ENDID    DS    0CL4               SET SYMBOLIC FOR ADDR                 34500002
         DC    X'02'              SET CODE                              34550002
         DC    C'END'             SET END FOR COMPARE                   34600002
NAMEID   DC    C' NAME'           SET NAME FOR COMPARE                  34650002
         DS    0F                                                       34700002
         SPACE 2                                                        34750002
TTSAVE   DC    F'0'               SAVE THE TTRZ HERE                    34800002
SEQSAVE  DC    F'0'               SAVE THE SEQUENCE NO. HERE            34850002
TRTAB    DC    C'1234567890'      TRANSLATE TABLE FOR A SEQ CHECKER     34900002
         SPACE 2                                                        34950002
         DS    0F                 FORCE BOUNDARY                        35000002
TXTADR   DC    F'0'               ADDRESS OF NEXT BYTE IN BUFFER        35050002
TXTADSV  DC    AL4(TXTAREA)                                             35100002
SIZETXT  DC    AL4(3600)                                                35150002
TXTHDR   DS    0CL80              SET SYMBOLIC FOR ADDRESSING           35200002
         DC    X'02'              CODE                                  35250002
         DC    C'TXTHDR'          SET NAME/TYPE OF RECORD               35300002
         DC    CL9' VS OLTEP'     THIS CON WILL BE 'VS TOLTEP' -        35350002
         DC    X'02'              IF TOLTEP UPDATE THE MOD              35400002
DATAADRS DC    AL3(0)             SET HDR NAMES FOR                     35450002
         DC    AL1(32)                                                  35500002
DATACNT  DC    AL3(0)             REQUIRE SYMBOLIC ADDRESSING           35550002
         ORG   TXTHDR+L'TXTHDR    SET LOCATION CNT TO END OF MSG        35600002
         DS    0F                                                       35650002
STOWCON  DS    0CL32              SET ASIDE 32 BYTE DIRECTORY SIZE      35700002
STOWNAME DC    CL8'        '      EIGHT BYTES FOR NAME FIELD            35730002
TTRCONST DC    XL3'00'            THREE BYTES FOR STOW DIRT'RY TTR      35760002
DIRTORSZ DC    XL1'0A'            SET INDICATOR FOR TEN HALFWORDS       35790002
USERINFO DC    XL20'00'           OF USER DIRECTORY INFORMATION         35820002
         SPACE  3                                                       35850002
NAMESAVE DC    CL8' '             SAVE AREA FOR NAME                    35900002
PRTBUFF  DS    0CL121             SET SYMBOLIC FOR ADDRESS              35950002
         DC    X'8B'              SET CMND CODE                         36000002
         DC    CL120' '           SET BUFFER TO BLANKS                  36050002
         SPACE 2                                                        36100002
IGNORECD DC    C' IFD906I REP ERR XXXXXXXX BYPASSED -                  *36150002
                                                                       *36200002
                    '                                                   36250002
         ORG   IGNORECD           PUT MESSAGE SIZE AT MSG HEAD          36300002
IGNORSIZ DC    AL1(L'IGNORECD-1)  MESSAGESIZE                           36350002
         ORG   IGNORECD+L'IGNORECD     SET ADDRESS COUNTED              36400002
         SPACE 2                                                        36450002
FAILDCB  DC    C' IFD901I    XXXXXXXX  DDCARD FAILED TO OPEN ****ERROR**36500002
               ***'                                                     36520002
         ORG   FAILDCB                                                  36550002
FAILSIZE DC    AL1(L'FAILDCB-1)     FORCE MSG SIZE TO MSG HEAD          36600002
         ORG   FAILDCB+L'FAILDCB                                        36650002
STOWOK   DC    C' IFD902I    XXXXXXXX  WAS CORRECTLY           ' XM3316 36700002
         ORG   STOWOK             PUT MESSAGE SIZE AT MSG HEAD          36750002
OKSTRSIZ DC    AL1(L'STOWOK-1)    MESSAGES SIZE                         36800002
         ORG   STOWOK+L'STOWOK         SET ADDRESS COUNTED              36850002
         SPACE  2                                                       36900002
DIRTFULL DC    C' IFD903I    XXXXXXXX  WAS NOT STORED *ERROR* NO SPACE *36950002
               LEFT IN DIRECTORY'                                       37000002
         ORG   DIRTFULL                                                 37050002
         DC    AL1(L'DIRTFULL-1)                                        37100002
         ORG   DIRTFULL+L'DIRTFULL REESTABLISH ADDRESSABILITY           37150002
         SPACE  2                                                       37200002
PERMIOER DC    C' IFD903I    XXXXXXXX  WAS NOT STORED *ERROR* PERMANENT*37250002
                I/O ERROR'                                       XM1330 37300002
         ORG   PERMIOER                                                 37350002
         DC    AL1(L'PERMIOER-1)                                        37400002
         ORG   PERMIOER+L'PERMIOER                                      37450002
         SPACE 2                                                        37500002
SEQERROR DC    C' IFD904I    SEQ ERR EXP=XXXX RECD=XXXX MODULE XXXXXXXX*37550002
                NOT STORED'                                             37600002
         ORG   SEQERROR                                                 37650002
MSSIZE   DC    AL1(L'SEQERROR-1)         GET MESSAGE SIZE               37700002
         ORG   SEQERROR+L'SEQERROR                                      37750002
         SPACE 3                                                        37800002
LOCALOLT DC    C' IFD907I THE FOLLOWING MODULES WERE DIRECTED TO THE OL*37850002
               T AND LOCAL CDS DATA SET.'                               37900002
         ORG   LOCALOLT                                                 37950002
         DC    AL1(L'LOCALOLT-1)        SET MSG SIZ AT MSG HEAD         38000002
         ORG   LOCALOLT+L'LOCALOLT    REST IC                           38050002
SYMDATAS DC    C' IFD907I THE FOLLOWING MODULES WERE DIRECTED TO THE SM*38100002
               MBOLIC (REMOTE) CDS DATA SET.'                           38150002
         ORG   SYMDATAS                                                 38200002
         DC    AL1(L'SYMDATAS-1)   STE MSG SIZ AT MSG HEAD              38250002
         ORG   SYMDATAS+L'SYMDATAS   RESET IC                           38300002
BADCARD  DC    C' IFD900I INVALID INPUT, REJECTED -                    *38306002
                                                                       *38312002
                  '                                                     38318002
         ORG   BADCARD                                                  38324002
         DC    AL1(L'BADCARD-1)        SET MEAASGE SIZE                 38330002
         ORG   BADCARD+L'BADCARD                                        38336002
ORDERERR DC    C' IFD908I ORDER ERROR XXXXXXXX BYPASSED -              *38336402
                                                                       *38336802
                         '                                              38337202
         ORG   ORDERERR                                                 38337602
         DC    AL1(L'ORDERERR-1)  GET MESSAGE SIZE                      38338002
         ORG   ORDERERR+L'ORDERERR RESET IC                             38338402
         SPACE 3                                                        38338802
BADLIB   DC    C' IFD909I  XXXX.XXXXXXX  CAN NOT BE USED FOR ONLINE TES*38339202
               T LOAD MODULES, JOB TERMINATED'                          38339602
         ORG   BADLIB             RESET IC                              38340002
         DC    AL1(L'BADLIB-1)                                          38340402
         ORG   BADLIB+L'BADLIB    RESET THE IC                          38340802
         SPACE  3                                                       38341202
         SPACE  3                                                       38342002
         SPACE 5                                                        38350002
JFCBPTR  DS    0F                 SET PTR TO JFCB AREA                  38400002
EOV      DC    X'06'              END OF VOLUME ID             @ZA08990 38410037
         DC    AL3(GEN07000)      ROUTINE TO COUNT TAPES       @ZA08990 38420037
         DC    X'87'              SET ID FOR SOME GUY                   38450002
         DC    AL3(JFCBAREA)      SET THE RUDDY PTR                     38500002
JFCBAREA DC    CL176'JFCB'                                              38550002
EBCD0001 DC    C'0001'            USED IN SEQUENCE CHECKING             38600002
EBCD0002 DC    C'0002'            USED IN SEQUENCE CHECKING             38650002
ADDCON   DC    CL9'ADDED'         USED WHEN MODULE WAS ADDED            38700002
REPCON   DC    CL9'REPLACED'                                            38750002
TEXTID   DC    XL2'0000'          SAVE AREA FOR CURRENT TEXT ID         38800002
READAREA DS    0D                 FORCE BOUNDARY                        38850002
         DC    CL80' '            SET AREA TO BLANKS                    38900002
BLANKCOL DC    CL4' '             USED IN SCANNER, DO NOT MOVE ....     38950002
*                                 THIS CARD MUST FOLLOW THW READAREA    39000002
*                                 SO IF YOU MAINTAIN THIS MODULE        39050002
*                                 LEAVE THE ORDER OF THESE TWO CARDS    39100002
*                                                  ** ALONE**           39150002
SETSSI   DC    CL7' SETSSI'                                             39200002
         DS    0H                                                       39300002
SYMCDSID DC    C'SYMBOLIC CDS'    SET ID FOR CDS FILE BEGINNING         39400002
SYMCDSDD DC    CL8'SYMSYM  '      DD NAME FOR SYMBOLIC CDS FILE         39450002
OUTDADID DC    CL8'OLTCDSDD'      DD NAME FOR OLT CDS FILE              39500002
INPUTID  DC    CL8'CNTRLIN '      DD NAME FOR OUT PUT DC CARD           39550002
LINKLIB  DC    C'SYS1.LINKLIB '   NAME OF LIBRARY NOT AVAIL TO EDITOR   39560002
SVCLIB   DC    C'SYS1.SVCLIB '    NAME OF LIBRARY NOT AVAIL TO EDITOR   39570002
LPALIB   DC    C'SYS1.LPALIB '    NAME OF LIBRARY NOT AVAIL TO EDITOR   39580002
#TAPES   DC    F'1'               # OF TAPES IN INPUT FILE 1   @ZA08990 39590037
*                                 INCREMENTED BY END OF VOLUME @ZA08990 39600037
*                                 ROUTINE. USED BY END OF FILE @ZA08990 39610037
*                                 ROUTINE TO UPDATE JFCB       @ZA08990 39620037
         SPACE  3                                                       39650002
INCARD   DCB   DDNAME=CNTRLIN,DSORG=PS,MACRF=GM,LRECL=80,BLKSIZE=80,   *39700002
               EODAD=GEN06000,RECFM=F,EXLST=JFCBPTR                     39750002
         EJECT                                                          39800002
OUTDASD  DCB   BLKSIZE=3600,LRECL=80,DDNAME=OLTCDSDD,DSORG=PO,         *39850002
               MACRF=W,RECFM=UT,OPTCD=W,EXLST=JFCBPTR                   39900002
         EJECT                                                          39950002
PRINTER  DCB   BLKSIZE=121,LRECL=121,DDNAME=DIAGMSG,DSORG=PS,          *40000002
               MACRF=PM,RECFM=FBM                                       40050002
         EJECT                                                          40100002
SAVEAREA  DC   18F'0'             SAVE AREA FOR TESTING AND DEBUGGING   40150002
         IFDPATCH                                                       40170002
TXTAREA  DS    450D               SET TEXT AREA TO 3600 BYTES           40200002
DCBNAME  DCBD                                                           40250002
         IEFJFCBN                                                       40270002
         END                                                            40300002
