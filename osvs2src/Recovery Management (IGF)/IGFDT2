         TITLE 'IGFDT2 - TAPE POSITIONING MODULE                       *00001000
                        '                                               00002000
IGFDT2   CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IGFDT2    77.109'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @08,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@08                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @09,@01                                             0001 00016000
         USING @DATD,@09                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @09,8(,@13)                                         0001 00020000
         LR    @13,@09                                             0001 00021000
*                                      VERSION                       */ 00022000
*   DO;                             /* ?IGFDERR INIT                 */ 00023000
*                                                                  0116 00024000
*     /***************************************************************/ 00025000
*     /*                                                             */ 00026000
*     /* IGFDERR - INITIALIZE RECOVERY ENVIRONMENT                   */ 00027000
*     /*                                                             */ 00028000
*     /***************************************************************/ 00029000
*                                                                  0117 00030000
*     DERPLIST=DERPLIST&&DERPLIST;  /* CLEAR PARAMETER LIST          */ 00031000
         XC    DERPLIST(48),DERPLIST                               0117 00032000
*     DERFUNK=DERINIT;              /* INDICATE INIT FUNCTION        */ 00033000
         MVI   DERFUNK,X'01'                                       0118 00034000
*     DERREC=ADDR(DERRECPM);        /* POINT TO REC PARMS            */ 00035000
         LA    @14,DERRECPM                                        0119 00036000
         ST    @14,DERREC                                          0119 00037000
*     DERSPEC=ADDR(IGFDT2S);        /* POINT TO SPECIAL EXIT         */ 00038000
         LA    @14,IGFDT2S                                         0120 00039000
         ST    @14,DERSPEC                                         0120 00040000
*     DERRETRY=ADDR(IGFDT2R);       /* POINT TO RETRY ROUTINE        */ 00041000
         LA    @14,IGFDT2R                                         0121 00042000
         ST    @14,DERRETRY                                        0121 00043000
*     GEN SETS(DERDATD)(MVC DERDATD,@SIZDATD);/* SET UP SPN, SIZE    */ 00044000
         MVC DERDATD,@SIZDATD                                           00045000
*     DERTAPE='1'B;                 /* INDICATE RESOURCE HELD        */ 00046000
         OI    DERTAPE,B'10000000'                                 0123 00047000
*     DERPFX=DERRMASK;              /* SET UP RUB MASK               */ 00048000
         MVC   DERPFX(2),@CB00670                                  0124 00049000
*     DERRCODE=CODEBASE;            /* SAVE CODEREG                  */ 00050000
         ST    CODEBASE,DERRCODE                                   0125 00051000
*     DERRDATA=DATABASE;            /* SAVE DATAREG                  */ 00052000
         ST    DATABASE,DERRDATA                                   0126 00053000
*     DERRDDR=DDRPTR;               /* SAVE DDRCOM POINTER           */ 00054000
         ST    DDRPTR,DERRDDR                                      0127 00055000
*     DERRSAVE=SAVEPTR;             /* SAVE REGISTER 13              */ 00056000
         ST    SAVEPTR,DERRSAVE                                    0128 00057000
*     CALL IGFDE0(DERPLIST);        /* ISSUE ESTAE                   */ 00058000
         LA    @14,DERPLIST                                        0129 00059000
         ST    @14,@AL00001                                        0129 00060000
         L     @15,@CV00605                                        0129 00061000
         LA    @01,@AL00001                                        0129 00062000
         BALR  @14,@15                                             0129 00063000
*   END;                            /* ?IGFDERR INIT ESTAE         0130 00064000
*                                      ESTABLISHED                   */ 00065000
*   DERLRC=0;                       /* SET LOCAL RETURN CODE TO 0    */ 00066000
         MVI   DERLRC,X'00'                                        0131 00067000
*   MOUNTSWH='1'B;                  /* SET MOUNT REQUIRED            */ 00068000
*   VERIFSWH='1'B;                  /* SET VERIFY LOOP CONTROL       */ 00069000
         OI    MOUNTSWH,B'11000000'                                0133 00070000
*   LABLKCNT=0;                     /* ZERO LABEL BLOCK COUNT        */ 00071000
         SLR   LABLKCNT,LABLKCNT                                   0134 00072000
*   WRVOLCNT=0;                     /* ZERO WRONG VOLUME COUNT       */ 00073000
         SLR   WRVOLCNT,WRVOLCNT                                   0135 00074000
*   BLOCKCNT=DDRUBCNT;              /* USER BLOCK COUNT      @YM04069*/ 00075000
         L     BLOCKCNT,DDRUBCNT(,DDRPTR)                          0136 00076000
*   FILECNT=UCBFSCT;                /* PHYSICAL FILE COUNT   @ZA18577*/ 00077000
         L     @14,UCBPTR(,DDRPTR)                                 0137 00078000
         LH    FILECNT,UCBFSCT(,@14)                               0137 00079000
*   IOBUFFER=IOBUFFER&&IOBUFFER;    /* ZERO BUFFER                   */ 00080000
         L     @14,DDRIBUF(,DDRPTR)                                0138 00081000
         XC    IOBUFFER(80,@14),IOBUFFER(@14)                      0138 00082000
*   IF DDRLNOP='0'B THEN            /* NOP LABEL?                    */ 00083000
         TM    DDRLNOP(DDRPTR),B'00000001'                         0139 00084000
         BNZ   @RF00139                                            0139 00085000
*     DO;                           /* NO- CONTINIE PROCESSING       */ 00086000
*       IF DDRLNL='1'B THEN         /* NO LABEL?                     */ 00087000
         TM    DDRLNL(DDRPTR),B'00100000'                          0141 00088000
         BNO   @RF00141                                            0141 00089000
*         CALL DT2NL;               /* YES-CALL NO LABEL ROUTINE     */ 00090000
         BAL   @14,DT2NL                                           0142 00091000
*       ELSE                        /* NOT NO LABEL                  */ 00092000
*         IF DDRLSD='1'B|DDRLAL='1'B THEN/* STANDARD OR ANSI LABEL?  */ 00093000
         B     @RC00141                                            0143 00094000
@RF00141 TM    DDRLSD(DDRPTR),B'10001000'                          0143 00095000
         BZ    @RF00143                                            0143 00096000
*           CALL DT2SLAL;           /* YES- CALL SL AND AL ROUTINE   */ 00097000
         BAL   @14,DT2SLAL                                         0144 00098000
*         ELSE                      /* NOT STANDARD OR ANSI LABEL    */ 00099000
*           CALL DT2NSL;            /* NSL ROUTINE                   */ 00100000
         B     @RC00143                                            0145 00101000
@RF00143 BAL   @14,DT2NSL                                          0145 00102000
*     END;                                                         0146 00103000
*   ELSE                                                           0147 00104000
*     ;                             /* YES - A NOP LABEL             */ 00105000
*                                                                  0147 00106000
@RF00139 DS    0H                                                  0148 00107000
*   /*****************************************************************/ 00108000
*   /*                                                               */ 00109000
*   /* THIS IS THE COMMON EXIT ROUTINE FOR THIS MODULE               */ 00110000
*   /*                                                               */ 00111000
*   /*****************************************************************/ 00112000
*                                                                  0148 00113000
*IGFDT2R:                                                          0148 00114000
*   ;                                                              0148 00115000
@RC00139 DS    0H                                                  0148 00116000
IGFDT2R  DS    0H                                                  0149 00117000
*   DO;                             /* ?IGFDERR CANCEL               */ 00118000
*                                                                  0149 00119000
*     /***************************************************************/ 00120000
*     /*                                                             */ 00121000
*     /* IGFDERR - CANCEL RECOVERY ENVIRONMENT                       */ 00122000
*     /*                                                             */ 00123000
*     /***************************************************************/ 00124000
*                                                                  0150 00125000
*     DERFUNK=DERCANC;              /* INDICATE CANCEL               */ 00126000
         MVI   DERFUNK,X'02'                                       0150 00127000
*     CALL IGFDE0(DERPLIST);        /* CANCEL ESTAE                  */ 00128000
         LA    @14,DERPLIST                                        0151 00129000
         ST    @14,@AL00001                                        0151 00130000
         L     @15,@CV00605                                        0151 00131000
         LA    @01,@AL00001                                        0151 00132000
         BALR  @14,@15                                             0151 00133000
*   END;                            /* ?IGFDERR CANCEL ESTAE CANCEL  */ 00134000
*   RETURN CODE(DERLRC);            /* RETURN TO CALLER              */ 00135000
         SLR   @12,@12                                             0153 00136000
         IC    @12,DERLRC                                          0153 00137000
         L     @13,4(,@13)                                         0153 00138000
         L     @00,@SIZDATD                                        0153 00139000
         LR    @01,@09                                             0153 00140000
         FREEMAIN R,LV=(0),A=(1)                                        00141000
         LR    @15,@12                                             0153 00142000
         L     @14,12(,@13)                                        0153 00143000
         LM    @00,@12,20(@13)                                     0153 00144000
         BR    @14                                                 0153 00145000
*                                                                  0154 00146000
*   /*****************************************************************/ 00147000
*   /*                                                               */ 00148000
*   /* NO LABEL SUBROUTINE                                           */ 00149000
*   /*                                                               */ 00150000
*   /*****************************************************************/ 00151000
*                                                                  0154 00152000
*DT2NL:                                                            0154 00153000
*   PROC;                           /* THIS SUBROUTINE MOUNTS AND  0154 00154000
*                                      POSITIONS THE TAPE AND NO   0154 00155000
*                                      VOLUME VERIFICATION IS      0154 00156000
*                                      NECESSARY                     */ 00157000
DT2NL    STM   @14,@12,@SA00002                                    0154 00158000
*   DDRIOF1=DDRNOP;                 /* SET NOP COMMAND FLAG  @YM04069*/ 00159000
         MVI   DDRIOF1(DDRPTR),X'03'                               0155 00160000
*   CALL DT2MOUNT;                  /* MOUNT TAPE            @YM04069*/ 00161000
         BAL   @14,DT2MOUNT                                        0156 00162000
*   IF DERLRC=0 THEN                /* RETURN CODE ZERO ?    @YM04069*/ 00163000
         CLI   DERLRC,0                                            0157 00164000
         BNE   @RF00157                                            0157 00165000
*     CALL DT2DATA;                 /* YES- POSITION TAPE    @YM04069*/ 00166000
         BAL   @14,DT2DATA                                         0158 00167000
*   RETURN;                         /* RETURN TO CALLER              */ 00168000
@EL00002 DS    0H                                                  0159 00169000
@EF00002 DS    0H                                                  0159 00170000
@ER00002 LM    @14,@12,@SA00002                                    0159 00171000
         BR    @14                                                 0159 00172000
*   END DT2NL;                                                     0160 00173000
         B     @EL00002                                            0160 00174000
*                                                                  0161 00175000
*   /*****************************************************************/ 00176000
*   /*                                                               */ 00177000
*   /* STANDARD AND ANSI LABEL SUBROUTINE                            */ 00178000
*   /*                                                               */ 00179000
*   /*****************************************************************/ 00180000
*                                                                  0161 00181000
*DT2SLAL:                                                          0161 00182000
*   PROC;                           /* ENTRY POINT                   */ 00183000
DT2SLAL  STM   @14,@12,@SA00003                                    0161 00184000
*   DO WHILE(VERIFSWH='1'B);        /* IS LABEL VERIFICATION       0162 00185000
*                                      COMPLETE?                     */ 00186000
         B     @DE00162                                            0162 00187000
@DL00162 DS    0H                                                  0163 00188000
*/*   NO - SWITCH IS ON                                              */ 00189000
*                                                                  0163 00190000
*     DDRIOF1=DDRREAD;              /* SET READ OPERATION FLAG       */ 00191000
         MVI   DDRIOF1(DDRPTR),X'02'                               0163 00192000
*     DDRIBUFL=LENGTH(IOBUFFER);    /* BUFFER LENGTH OF 80           */ 00193000
         MVC   DDRIBUFL(2,DDRPTR),@CH00599                         0164 00194000
*     CALL DT2MOUNT;                /* MOUNT TAPE                    */ 00195000
         BAL   @14,DT2MOUNT                                        0165 00196000
*     IF DERLRC^=0 THEN             /* NON-ZERO RETURN CODE ?        */ 00197000
         CLI   DERLRC,0                                            0166 00198000
         BE    @RF00166                                            0166 00199000
*       VERIFSWH='0'B;              /* YES - ERROR CONDITION         */ 00200000
         NI    VERIFSWH,B'10111111'                                0167 00201000
*     ELSE                          /* NO -ZERO RETURN CODE          */ 00202000
*       DO;                                                        0168 00203000
         B     @RC00166                                            0168 00204000
@RF00166 DS    0H                                                  0169 00205000
*         IF DDRLAL='1'B THEN       /* ANSI LABEL ?                  */ 00206000
         TM    DDRLAL(DDRPTR),B'10000000'                          0169 00207000
         BNO   @RF00169                                            0169 00208000
*           DO;                     /* YES - AN ANSI LABEL           */ 00209000
*             XLATEADD=ADDR(IOBUFFER);/* LABEL BUFFER ADDRESS        */ 00210000
         L     @14,DDRIBUF(,DDRPTR)                                0171 00211000
         ST    @14,XLATEADD                                        0171 00212000
*             GEN REFS(XLATEADD);                                  0172 00213000
             XLATE XLATEADD,10,TO=E                                     00214000
*             YES-THE LABEL IS ANSI.  THE FIRST 10 BYTES OF THE         00215000
*             LABEL ARE TRANSLATED TO EBCDIC.                           00216000
*           END;                                                   0173 00217000
*         ELSE                                                     0174 00218000
*           ;                       /* NO - NOT AN ANSI LABEL        */ 00219000
@RF00169 DS    0H                                                  0175 00220000
*         IF VOLLABIN='VOL1'&VOLSERNO=DDRTOUCB->UCBVOLI THEN/* VOL 0175 00221000
*                                      LABEL CORRECT ?               */ 00222000
         L     @14,DDRIBUF(,DDRPTR)                                0175 00223000
         CLC   VOLLABIN(4,@14),@CC00688                            0175 00224000
         BNE   @RF00175                                            0175 00225000
         L     @12,DDRTOUCB(,DDRPTR)                               0175 00226000
         CLC   VOLSERNO(6,@14),UCBVOLI(@12)                        0175 00227000
         BNE   @RF00175                                            0175 00228000
*           VERIFSWH='0'B;          /* YES - LABEL IS CORRECT        */ 00229000
         NI    VERIFSWH,B'10111111'                                0176 00230000
*         ELSE                      /* NO - LABEL IS INCORRECT       */ 00231000
*           CALL DT2WRONG;          /* REWIND THE TAPE AND ISSUE THE    00232000
*                                      WRONG VOLUME MESSAGE          */ 00233000
         B     @RC00175                                            0177 00234000
@RF00175 BAL   @14,DT2WRONG                                        0177 00235000
*       END;                                                       0178 00236000
@RC00175 DS    0H                                                  0179 00237000
*   END;                            /* END OF DO LOOP                */ 00238000
@RC00166 DS    0H                                                  0179 00239000
@DE00162 TM    VERIFSWH,B'01000000'                                0179 00240000
         BO    @DL00162                                            0179 00241000
*/*   LABEL VERIFICATION IS COMPLETE                                 */ 00242000
*                                                                  0180 00243000
*   IF DERLRC=0 THEN                /* IS LOCAL RETURN CODE ZERO ?   */ 00244000
         CLI   DERLRC,0                                            0180 00245000
         BNE   @RF00180                                            0180 00246000
*     CALL DT2DATA;                 /* YES- POSITION DATA AND FILE   */ 00247000
         BAL   @14,DT2DATA                                         0181 00248000
*   ELSE                                                           0182 00249000
*     ;                             /* NON-ZERO RETURN CODE          */ 00250000
@RF00180 DS    0H                                                  0183 00251000
*   RETURN;                         /* RETURN TO CALLER              */ 00252000
@EL00003 DS    0H                                                  0183 00253000
@EF00003 DS    0H                                                  0183 00254000
@ER00003 LM    @14,@12,@SA00003                                    0183 00255000
         BR    @14                                                 0183 00256000
*   END DT2SLAL;                                                   0184 00257000
*                                                                  0185 00258000
*   /*****************************************************************/ 00259000
*   /*                                                               */ 00260000
*   /* NON-STANDARD LABEL SUBROUTINE                                 */ 00261000
*   /*                                                               */ 00262000
*   /*****************************************************************/ 00263000
*                                                                  0185 00264000
*DT2NSL:                                                           0185 00265000
*   PROC;                           /* ENTRY POINT                   */ 00266000
DT2NSL   STM   @14,@12,@SA00004                                    0185 00267000
*   DERLRC=0;                       /* SET LOCAL RETURN CODE TO ZERO */ 00268000
         MVI   DERLRC,X'00'                                        0186 00269000
*   DO WHILE(VERIFSWH='1'B);        /* IS VOL VERIFICATION COMPLETE ?*/ 00270000
         B     @DE00187                                            0187 00271000
@DL00187 DS    0H                                                  0188 00272000
*/*   VOL VERIFY NOT COMPLETE - SWITCH IS ON                         */ 00273000
*                                                                  0188 00274000
*     IF MOUNTSWH='1'B THEN         /* IS MOUNT SWITCH ON ?          */ 00275000
         TM    MOUNTSWH,B'10000000'                                0188 00276000
         BNO   @RF00188                                            0188 00277000
*       DO;                         /* YES                           */ 00278000
*         MOUNTSWH='0'B;            /* CLEAR MOUNT SWITCH            */ 00279000
         NI    MOUNTSWH,B'01111111'                                0190 00280000
*         DDRIOF1=DDRREAD;          /* SET READ OPERATION FLAG       */ 00281000
         MVI   DDRIOF1(DDRPTR),X'02'                               0191 00282000
*         DDRIBUFL=LENGTH(IOBUFFER);/* BUFFER LENGTH IS 80 BYTES     */ 00283000
         MVC   DDRIBUFL(2,DDRPTR),@CH00599                         0192 00284000
*         CALL DT2MOUNT;            /* MOUNT TAPE                    */ 00285000
         BAL   @14,DT2MOUNT                                        0193 00286000
*       END;                                                       0194 00287000
*     ELSE                                                         0195 00288000
*       ;                           /* NO - MOUNT NOT REQUIRED       */ 00289000
@RF00188 DS    0H                                                  0196 00290000
*     IF DERLRC^=0 THEN             /* LOCAL RETURN CODE IS ZERO ?   */ 00291000
         CLI   DERLRC,0                                            0196 00292000
         BE    @RF00196                                            0196 00293000
*       VERIFSWH='0'B;              /* NO - CLEAR VERIFY SWITCH      */ 00294000
         NI    VERIFSWH,B'10111111'                                0197 00295000
*     ELSE                          /* YES - ZERO RETURN CODE        */ 00296000
*       DO;                                                        0198 00297000
         B     @RC00196                                            0198 00298000
@RF00196 DS    0H                                                  0199 00299000
*         SVC85SWH='1'B;            /* SET SVC 85 SWITCH             */ 00300000
         OI    SVC85SWH,B'00100000'                                0199 00301000
*         R1=DDRPTR;                /* DDRCOM ADDRESS IN REG 1       */ 00302000
         LR    R1,DDRPTR                                           0200 00303000
*         SVC(85);                  /* USER EXIT TO NSLREPOS         */ 00304000
         SVC   85                                                  0201 00305000
*         SVC85SWH='0'B;            /* CLEAR SVC 85 SWITCH           */ 00306000
         NI    SVC85SWH,B'11011111'                                0202 00307000
*         IF RTNCODE//4=0&RTNCODE>=0&RTNCODE<=20 THEN/* VALID RETURN    00308000
*                                      CODE ?                        */ 00309000
         SLR   @14,@14                                             0203 00310000
         LR    @02,RTNCODE                                         0203 00311000
         SRDA  @02,32                                              0203 00312000
         D     @02,@CF00134                                        0203 00313000
         CR    @02,@14                                             0203 00314000
         BNE   @RF00203                                            0203 00315000
         CR    RTNCODE,@14                                         0203 00316000
         BL    @RF00203                                            0203 00317000
         C     RTNCODE,@CF00694                                    0203 00318000
         BH    @RF00203                                            0203 00319000
*           DO;                     /* YES - (0,4,8,12,16,20)        */ 00320000
*             SUBPTR=DT2SUBS(RTNCODE/4+1);/* SELECT SUBROUTINE       */ 00321000
         LR    @02,RTNCODE                                         0205 00322000
         SRDA  @02,32                                              0205 00323000
         D     @02,@CF00134                                        0205 00324000
         SLA   @03,2                                               0205 00325000
         L     SUBPTR,DT2SUBS(@03)                                 0205 00326000
*             CALL DT2SUB;          /* ENTER CORRECT SUBROUTINE      */ 00327000
         LR    @15,SUBPTR                                          0206 00328000
         BALR  @14,@15                                             0206 00329000
*           END;                                                   0207 00330000
*         ELSE                                                     0208 00331000
*           DO;                     /* INVALID RETURN CODE           */ 00332000
         B     @RC00203                                            0208 00333000
@RF00203 DS    0H                                                  0209 00334000
*             CALL DT2UNLD;         /* REWIND AND UNLOAD TAPE        */ 00335000
         BAL   @14,DT2UNLD                                         0209 00336000
*             DDRTER1=DDRTIU;       /* INVALID USER EXIT             */ 00337000
         MVI   DDRTER1(DDRPTR),X'06'                               0210 00338000
*             DERLRC=12;            /* SET LOCAL RETURN CODE         */ 00339000
         MVI   DERLRC,X'0C'                                        0211 00340000
*             VERIFSWH='0'B;        /* CLEAR VERIFY SWITCH           */ 00341000
         NI    VERIFSWH,B'10111111'                                0212 00342000
*           END;                                                   0213 00343000
*       END;                                                       0214 00344000
@RC00203 DS    0H                                                  0215 00345000
*   END;                            /* END OF DO LOOP                */ 00346000
@RC00196 DS    0H                                                  0215 00347000
@DE00187 TM    VERIFSWH,B'01000000'                                0215 00348000
         BO    @DL00187                                            0215 00349000
*   IF DERLRC=0 THEN                /* IS RETURN CODE ZERO ?         */ 00350000
         CLI   DERLRC,0                                            0216 00351000
         BNE   @RF00216                                            0216 00352000
*     DO;                           /* YES - ZERO RETURN CODE        */ 00353000
*       IF BLOCKCNT>0&FILECNT^>0 THEN/* RECALCULATE TAPE POSITION ?  */ 00354000
         SLR   @14,@14                                             0218 00355000
         CR    BLOCKCNT,@14                                        0218 00356000
         BNH   @RF00218                                            0218 00357000
         CR    FILECNT,@14                                         0218 00358000
         BH    @RF00218                                            0218 00359000
*         BLOCKCNT=MAX(BLOCKCNT-LABLKCNT,0);/* YES-CHANGE BLOCKCNT   */ 00360000
         LR    @12,BLOCKCNT                                        0219 00361000
         SLR   @12,LABLKCNT                                        0219 00362000
         CR    @12,@14                                             0219 00363000
         BNL   *+6                                                      00364000
         LR    @12,@14                                             0219 00365000
         LR    BLOCKCNT,@12                                        0219 00366000
*       ELSE                                                       0220 00367000
*         ;                         /* NO - DO NOT CHANGE BLOCKCOUNT */ 00368000
@RF00218 DS    0H                                                  0221 00369000
*       CALL DT2DATA;               /* POSITION DATA AND FILE        */ 00370000
         BAL   @14,DT2DATA                                         0221 00371000
*     END;                                                         0222 00372000
*   ELSE                                                           0223 00373000
*     ;                             /* RETURN CODE IS NON-ZERO, THE     00374000
*                                      TAPE POSITION IS NOT CHANGED  */ 00375000
@RF00216 DS    0H                                                  0224 00376000
*   RETURN;                         /* RETURN TO CALLER              */ 00377000
@EL00004 DS    0H                                                  0224 00378000
@EF00004 DS    0H                                                  0224 00379000
@ER00004 LM    @14,@12,@SA00004                                    0224 00380000
         BR    @14                                                 0224 00381000
*   END DT2NSL;                                                    0225 00382000
*                                                                  0226 00383000
*   /*****************************************************************/ 00384000
*   /*                                                               */ 00385000
*   /* I/O ERROR SUBROUTINE                                          */ 00386000
*   /*                                                               */ 00387000
*   /*****************************************************************/ 00388000
*                                                                  0226 00389000
*DT2IOERR:                                                         0226 00390000
*   PROC;                           /* THIS SUBROUTINE IS ENTERED  0226 00391000
*                                      WHEN AN I/O ERROR OCCURS    0226 00392000
*                                      DURING THE TAPE POSITIONING   */ 00393000
DT2IOERR STM   @14,@05,@SA00005                                    0226 00394000
         STM   @07,@12,@SA00005+32                                 0226 00395000
*   VERIFSWH='0'B;                  /* CLEAR VERIFY SWITCH           */ 00396000
         NI    VERIFSWH,B'10111111'                                0227 00397000
*   CALL DT2UNLD;                   /* REWIND AND UNLOAD TAPE        */ 00398000
         BAL   @14,DT2UNLD                                         0228 00399000
*   DERLRC=4;                       /* SET LOCAL RETURN CODE         */ 00400000
         MVI   DERLRC,X'04'                                        0229 00401000
*   RETURN;                         /* RETURN TO CALLER              */ 00402000
@EL00005 DS    0H                                                  0230 00403000
@EF00005 DS    0H                                                  0230 00404000
@ER00005 LM    @14,@05,@SA00005                                    0230 00405000
         LM    @07,@12,@SA00005+32                                 0230 00406000
         BR    @14                                                 0230 00407000
*   END DT2IOERR;                                                  0231 00408000
*                                                                  0232 00409000
*   /*****************************************************************/ 00410000
*   /*                                                               */ 00411000
*   /* DATA AND FILE POSITIONING SUBROUTINE                          */ 00412000
*   /*                                                               */ 00413000
*   /*****************************************************************/ 00414000
*                                                                  0232 00415000
*DT2DATA:                                                          0232 00416000
*   PROC;                           /* THIS SUBROUTINE RECEIVES    0232 00417000
*                                      CONTROL FROM DT2NL- AFTER TAPE   00418000
*                                      HAS BEEN MOUNTED AND FROM   0232 00419000
*                                      DT2SLAL OR DT2NSL - AFTER   0232 00420000
*                                      LABEL HAS BEEN VERIFIED. THIS    00421000
*                                      ROUTINE WILL FORWARD SPACE THE   00422000
*                                      TAPE USING SKIP FILE COMMANDS    00423000
*                                      AND THEN READ THRU THE RECORDS   00424000
*                                      IN THE FILE UP TO THE FAILING    00425000
*                                      OR LAST RECORD.               */ 00426000
DT2DATA  STM   @14,@12,@SA00006                                    0232 00427000
*   IF FILECNT^=0 THEN              /* IS FILE POSITIONING NECESSARY    00428000
*                                      ?                             */ 00429000
         LTR   FILECNT,FILECNT                                     0233 00430000
         BZ    @RF00233                                            0233 00431000
*     DO;                           /* YES                           */ 00432000
*       DDRIOF1=DDRFSF;             /* SET FORWARD SPACE FILE COMMAND   00433000
*                                      FLAG                          */ 00434000
         MVI   DDRIOF1(DDRPTR),X'3F'                               0235 00435000
*       DDRIOF2=0;                  /* CLEAR BYTE                    */ 00436000
         MVI   DDRIOF2(DDRPTR),X'00'                               0236 00437000
*       DDRICNT='1'B;               /* SET MULTIPLE COUNT INDICATOR  */ 00438000
*       DDRITAKE='1'B;              /* SET CONTROL INDICATOR         */ 00439000
         OI    DDRICNT(DDRPTR),B'01001000'                         0238 00440000
*       DDRCOUNT=FILECNT;           /* I/O REPEAT COUNT              */ 00441000
         ST    FILECNT,DDRCOUNT(,DDRPTR)                           0239 00442000
*       CALL IGFDM1;                /* SKIP FILES                    */ 00443000
         L     @15,@CV00608                                        0240 00444000
         BALR  @14,@15                                             0240 00445000
*       DERLRC=RTNCODE;             /* SET LOCAL RETURN CODE         */ 00446000
         STC   RTNCODE,DERLRC                                      0241 00447000
*     END;                                                         0242 00448000
*   ELSE                                                           0243 00449000
*     ;                                                            0243 00450000
@RF00233 DS    0H                                                  0244 00451000
*   IF DERLRC=0 THEN                /* IS RETURN CODE ZERO ?         */ 00452000
         CLI   DERLRC,0                                            0244 00453000
         BNE   @RF00244                                            0244 00454000
*     IF BLOCKCNT^=0 THEN           /* YES - IS BLOCKCOUNT ZERO ?    */ 00455000
         SLR   @14,@14                                             0245 00456000
         CR    BLOCKCNT,@14                                        0245 00457000
         BE    @RF00245                                            0245 00458000
*       DO;                         /* NO - BLOCKCOUNT IS NON-ZERO   */ 00459000
*         IF BLOCKCNT<0 THEN        /* YES - IS BLOCKCOUNT NEGATIVE ?*/ 00460000
         CR    BLOCKCNT,@14                                        0247 00461000
         BNL   @RF00247                                            0247 00462000
*           DO;                     /* YES - WITH A NEGATIVE       0248 00463000
*                                      BLOCKCOUNT, THE TAPE HAS BEEN    00464000
*                                      SPACED ONE FILE BEYOND THE  0248 00465000
*                                      REQUIRED POINT                */ 00466000
*             DDRIOF1=DDRBSF;       /* SET BACKSPACE FILE COMMAND  0249 00467000
*                                      FLAG                          */ 00468000
         MVI   DDRIOF1(DDRPTR),X'2F'                               0249 00469000
*             DDRIOF2=0;            /* CLEAR BYTE                    */ 00470000
         MVI   DDRIOF2(DDRPTR),X'00'                               0250 00471000
*             DDRITAKE='1'B;        /* SET CONTROL INDICATOR         */ 00472000
         OI    DDRITAKE(DDRPTR),B'01000000'                        0251 00473000
*             CALL IGFDM1;          /* BACKSPACE FILE                */ 00474000
         L     @15,@CV00608                                        0252 00475000
         BALR  @14,@15                                             0252 00476000
*             DERLRC=RTNCODE;       /* SET LOCAL RETURN CODE         */ 00477000
         STC   RTNCODE,DERLRC                                      0253 00478000
*             DDRIOF1=DDRRDBK;      /* SET READ BACKWARDS COMMAND  0254 00479000
*                                      FLAG                          */ 00480000
         MVI   DDRIOF1(DDRPTR),X'0C'                               0254 00481000
*           END;                                                   0255 00482000
*         ELSE                      /* NO - POSITIVE BLOCKCOUNT      */ 00483000
*           DDRIOF1=DDRREAD;        /* SET READ COMMAND FLAG         */ 00484000
         B     @RC00247                                            0256 00485000
@RF00247 MVI   DDRIOF1(DDRPTR),X'02'                               0256 00486000
*         IF DERLRC=0 THEN          /* IS RETURN CODE ZERO ?         */ 00487000
@RC00247 CLI   DERLRC,0                                            0257 00488000
         BNE   @RF00257                                            0257 00489000
*           DO;                     /* YES                           */ 00490000
*             DDRIOF2=0;            /* CLEAR BYTE                    */ 00491000
         MVI   DDRIOF2(DDRPTR),X'00'                               0259 00492000
*             DDRITAKE='1'B;        /* SET CONTROL INDICATOR         */ 00493000
*             DDRICNT='1'B;         /* SET MULTIPLE COUNT INDICATOR  */ 00494000
         OI    DDRITAKE(DDRPTR),B'01001000'                        0261 00495000
*             DDRIBUFL=NOTNOISE;    /* SET BUFFER LENGTH             */ 00496000
         MVC   DDRIBUFL(2,DDRPTR),@CH00621                         0262 00497000
*             DDRCOUNT=BLOCKCNT;    /* I/O REPEAT COUNT              */ 00498000
         ST    BLOCKCNT,DDRCOUNT(,DDRPTR)                          0263 00499000
*             CALL IGFDM1;          /* READ OR READ BACKWARDS        */ 00500000
         L     @15,@CV00608                                        0264 00501000
         BALR  @14,@15                                             0264 00502000
*             DERLRC=RTNCODE;       /* SET LOCAL RETURN CODE         */ 00503000
         STC   RTNCODE,DERLRC                                      0265 00504000
*           END;                                                   0266 00505000
*         ELSE                                                     0267 00506000
*           ;                       /* NO - RETURN CODE IS NON-ZERO  */ 00507000
@RF00257 DS    0H                                                  0268 00508000
*       END;                                                       0268 00509000
*     ELSE                                                         0269 00510000
*       ;                           /* YES - BLOCKCOUNT IS ZERO      */ 00511000
@RF00245 DS    0H                                                  0270 00512000
*   ELSE                                                           0270 00513000
*     ;                             /* NO - RETURN CODE IS NON-ZERO  */ 00514000
@RF00244 DS    0H                                                  0271 00515000
*   IF DERLRC^=0 THEN               /* IS RETURN CODE ZERO ?         */ 00516000
         CLI   DERLRC,0                                            0271 00517000
         BE    @RF00271                                            0271 00518000
*     CALL DT2IOERR;                /* NO - I/O ERROR                */ 00519000
         BAL   @14,DT2IOERR                                        0272 00520000
*   ELSE                                                           0273 00521000
*     ;                             /* YES-RETURN CODE IS ZERO       */ 00522000
@RF00271 DS    0H                                                  0274 00523000
*   RETURN;                         /* RETURN TO CALLER              */ 00524000
@EL00006 DS    0H                                                  0274 00525000
@EF00006 DS    0H                                                  0274 00526000
@ER00006 LM    @14,@12,@SA00006                                    0274 00527000
         BR    @14                                                 0274 00528000
*   END DT2DATA;                                                   0275 00529000
*                                                                  0276 00530000
*   /*****************************************************************/ 00531000
*   /*                                                               */ 00532000
*   /* MOUNT SUBROUTINE                                              */ 00533000
*   /*                                                               */ 00534000
*   /*****************************************************************/ 00535000
*                                                                  0276 00536000
*DT2MOUNT:                                                         0276 00537000
*   PROC;                           /* THIS SUBROUTINE IS CALLED VIA    00538000
*                                      DT2NL,DT2SLAL, AND DT2NSL WHEN   00539000
*                                      A TAPE MOUNT IS REQUIRED      */ 00540000
DT2MOUNT STM   @14,@03,@SA00007                                    0276 00541000
         STM   @07,@12,@SA00007+24                                 0276 00542000
*   DDRIOF2=0;                      /* CLEAR BYTE                    */ 00543000
         MVI   DDRIOF2(DDRPTR),X'00'                               0277 00544000
*   DDRITAKE='1'B;                  /* SET CONTROL INDICATOR         */ 00545000
*   DDRIMNT='1'B;                   /* SET MOUNT INDICATOR           */ 00546000
         OI    DDRITAKE(DDRPTR),B'01010000'                        0279 00547000
*   CALL IGFDM1;                    /* ISSUE I/O COMMAND             */ 00548000
         L     @15,@CV00608                                        0280 00549000
         BALR  @14,@15                                             0280 00550000
*   IF RTNCODE=0 THEN               /* IS RETURN CODE ZERO ?         */ 00551000
         LTR   RTNCODE,RTNCODE                                     0281 00552000
         BNZ   @RF00281                                            0281 00553000
*     DO;                           /* YES - RETURN IS ZERO          */ 00554000
*       DDRINV2=DDRVUS;             /* VALIDATE USER                 */ 00555000
         MVI   DDRINV2(DDRPTR),X'03'                               0283 00556000
*       CALL IGFDT1;                /* CHECK USER STILL ACTIVE       */ 00557000
         L     @15,@CV00607                                        0284 00558000
         BALR  @14,@15                                             0284 00559000
*       IF^(RTNCODE=0&DDRTOUCB->UCBVOLI^=ZERO6) THEN               0285 00560000
         LTR   RTNCODE,RTNCODE                                     0285 00561000
         BNZ   @RT00285                                            0285 00562000
         L     @14,DDRTOUCB(,DDRPTR)                               0285 00563000
         CLC   UCBVOLI(6,@14),@CB00624                             0285 00564000
         BNE   @RF00285                                            0285 00565000
@RT00285 DS    0H                                                  0286 00566000
*         DO;                       /* RETURN CODE IS NON-ZERO AND/OR   00567000
*                                      THE VOLUME SERIAL NUMBER IS 0286 00568000
*                                      ZERO                          */ 00569000
*           CALL DT2UNLD;           /* REWIND AND UNLOAD             */ 00570000
         BAL   @14,DT2UNLD                                         0287 00571000
*           DDRTER1=DDRTNF;         /* NO USER FOUND                 */ 00572000
         MVI   DDRTER1(DDRPTR),X'01'                               0288 00573000
*           DERLRC=12;              /* SET LOCAL RETURN CODE         */ 00574000
         MVI   DERLRC,X'0C'                                        0289 00575000
*         END;                                                     0290 00576000
*       ELSE                        /* RETURN CODE IS ZERO AND VOLUME   00577000
*                                      SERIAL NUMBER IS NON-ZERO     */ 00578000
*         DO;                       /*                       @YM04069*/ 00579000
         B     @RC00285                                            0291 00580000
@RF00285 DS    0H                                                  0292 00581000
*           BLOCKCNT=DDRUBCNT;      /* RE-INIT BLOCK COUNT FOR USER     00582000
*                                      OPERATOR SWAP BECAUSE T1 CAN     00583000
*                                      CHANGE THE COUNT      @YM04069*/ 00584000
         L     BLOCKCNT,DDRUBCNT(,DDRPTR)                          0292 00585000
*           IF DDRLNL='1'B THEN     /* NO LABEL ?            @YM04069*/ 00586000
         TM    DDRLNL(DDRPTR),B'00100000'                          0293 00587000
         BNO   @RF00293                                            0293 00588000
*             IF BLOCKCNT<0 THEN    /* NEGATIVE BLOCKCOUNT ? --    0294 00589000
*                                                            @YM04069   00590000
*                                      OCCURS DURING A READ BACKWARDS   00591000
*                                      OPERATION                     */ 00592000
         SLR   @14,@14                                             0294 00593000
         CR    BLOCKCNT,@14                                        0294 00594000
         BNL   @RF00294                                            0294 00595000
*               FILECNT=MAX(FILECNT-1,0)+1;/* YES- CALCULATE THE   0295 00596000
*                                      FILECOUNT WHICH MUST BE     0295 00597000
*                                      POSITIVE              @YM04069*/ 00598000
         LR    @12,FILECNT                                         0295 00599000
         BCTR  @12,0                                               0295 00600000
         CR    @12,@14                                             0295 00601000
         BNL   *+6                                                      00602000
         LR    @12,@14                                             0295 00603000
         AL    @12,@CF00051                                        0295 00604000
         LR    FILECNT,@12                                         0295 00605000
*             ELSE                                                 0296 00606000
*               FILECNT=MAX(FILECNT-1,0);/* POSITIVE BLOCKCOUNT    0296 00607000
*                                                            @YM04069*/ 00608000
         B     @RC00294                                            0296 00609000
@RF00294 LR    @14,FILECNT                                         0296 00610000
         BCTR  @14,0                                               0296 00611000
         SLR   @12,@12                                             0296 00612000
         CR    @14,@12                                             0296 00613000
         BNL   *+6                                                      00614000
         LR    @14,@12                                             0296 00615000
         LR    FILECNT,@14                                         0296 00616000
*           ELSE                    /* NOT NO LABEL          @YM04069*/ 00617000
*             IF DDRLSD='1'B|DDRLAL='1'B THEN/* STANDARD OR ANSI   0297 00618000
*                                      LABEL ?               @YM04069*/ 00619000
         B     @RC00293                                            0297 00620000
@RF00293 TM    DDRLSD(DDRPTR),B'10001000'                          0297 00621000
         BZ    @RF00297                                            0297 00622000
*               IF BLOCKCNT<0 THEN  /* NEGATIVE BLOCKCOUNT ? @YM04069*/ 00623000
         LTR   BLOCKCNT,BLOCKCNT                                   0298 00624000
         BNM   @RF00298                                            0298 00625000
*                 FILECNT=3*MAX(FILECNT,1)-1;/* YES - CALCULATE    0299 00626000
*                                      FILECOUNT                     */ 00627000
         LA    @14,1                                               0299 00628000
         CR    @14,FILECNT                                         0299 00629000
         BNL   *+6                                                      00630000
         LR    @14,FILECNT                                         0299 00631000
         MH    @14,@CH00132                                        0299 00632000
         BCTR  @14,0                                               0299 00633000
         LR    FILECNT,@14                                         0299 00634000
*               ELSE                                               0300 00635000
*                 FILECNT=3*MAX(FILECNT,1)-2;/* POSITIVE BLOCKCNT  0300 00636000
*                                                            @YM04069*/ 00637000
         B     @RC00298                                            0300 00638000
@RF00298 LA    @14,1                                               0300 00639000
         CR    @14,FILECNT                                         0300 00640000
         BNL   *+6                                                      00641000
         LR    @14,FILECNT                                         0300 00642000
         MH    @14,@CH00132                                        0300 00643000
         BCTR  @14,0                                               0300 00644000
         BCTR  @14,0                                               0300 00645000
         LR    FILECNT,@14                                         0300 00646000
*             ELSE                  /* NOT STANDARD OR ANSI LABEL  0301 00647000
*                                                            @YM04069*/ 00648000
*               IF DDRLNSL='1'B THEN/* NSL LABEL ?           @YM04069*/ 00649000
         B     @RC00297                                            0301 00650000
@RF00297 TM    DDRLNSL(DDRPTR),B'00010000'                         0301 00651000
         BNO   @RF00301                                            0301 00652000
*                 IF BLOCKCNT<0 THEN/* NEGATIVE BLOCKCOUNT ? --    0302 00653000
*                                                            @YM04069   00654000
*                                      OCCURS DURING A READ BACKWARDS   00655000
*                                      OPERATION                     */ 00656000
         SLR   @14,@14                                             0302 00657000
         CR    BLOCKCNT,@14                                        0302 00658000
         BNL   @RF00302                                            0302 00659000
*                   FILECNT=MAX(FILECNT-1,0)+1;/* YES- CALCULATE THE    00660000
*                                      FILECOUNT WHICH MUST BE     0303 00661000
*                                      POSITIVE              @YM04069*/ 00662000
         LR    @12,FILECNT                                         0303 00663000
         BCTR  @12,0                                               0303 00664000
         CR    @12,@14                                             0303 00665000
         BNL   *+6                                                      00666000
         LR    @12,@14                                             0303 00667000
         AL    @12,@CF00051                                        0303 00668000
         LR    FILECNT,@12                                         0303 00669000
*                 ELSE                                             0304 00670000
*                   FILECNT=MAX(FILECNT-1,0);/* POSITIVE BLOCKCOUNT     00671000
*                                                            @YM04069*/ 00672000
         B     @RC00302                                            0304 00673000
@RF00302 LR    @14,FILECNT                                         0304 00674000
         BCTR  @14,0                                               0304 00675000
         SLR   @12,@12                                             0304 00676000
         CR    @14,@12                                             0304 00677000
         BNL   *+6                                                      00678000
         LR    @14,@12                                             0304 00679000
         LR    FILECNT,@14                                         0304 00680000
*         END;                      /*                       @YM04069*/ 00681000
*     END;                          /*                       @YM04069*/ 00682000
*   ELSE                            /* NO - RETURN CODE IS NON-ZERO  */ 00683000
*     CALL DT2IOERR;                /* I/O ERROR                     */ 00684000
         B     @RC00281                                            0307 00685000
@RF00281 BAL   @14,DT2IOERR                                        0307 00686000
*   RETURN;                         /* RETURN TO CALLER              */ 00687000
@EL00007 DS    0H                                                  0308 00688000
@EF00007 DS    0H                                                  0308 00689000
@ER00007 LM    @14,@03,@SA00007                                    0308 00690000
         LM    @07,@12,@SA00007+24                                 0308 00691000
         BR    @14                                                 0308 00692000
*   END DT2MOUNT;                                                  0309 00693000
         B     @EL00007                                            0309 00694000
*                                                                  0310 00695000
*   /*****************************************************************/ 00696000
*   /*                                                               */ 00697000
*   /* WRONG VOLUME SUBROUTINE                                       */ 00698000
*   /*                                                               */ 00699000
*   /*****************************************************************/ 00700000
*                                                                  0310 00701000
*DT2WRONG:                                                         0310 00702000
*   PROC;                           /* THIS SUBROUTINE REWINDS AND 0310 00703000
*                                      UNLOADS THE WRONG VOLUME AND     00704000
*                                      ISSUES IGF511A MESSAGE. THIS     00705000
*                                      ROUTINE IS CALLED BY DT2SLAL     00706000
*                                      AND DT2NSL.                   */ 00707000
DT2WRONG STM   @14,@05,@SA00008                                    0310 00708000
         STM   @08,@12,@SA00008+32                                 0310 00709000
*   WRVOLCNT=WRVOLCNT+1;            /* INCREMENT COUNT               */ 00710000
         LA    WRVOLCNT,1(,WRVOLCNT)                               0311 00711000
*   LABLKCNT=0;                     /* CLEAR LABEL BLOCKCOUNT        */ 00712000
         SLR   LABLKCNT,LABLKCNT                                   0312 00713000
*   CALL DT2UNLD;                   /* REWIND AND UNLOAD             */ 00714000
         BAL   @14,DT2UNLD                                         0313 00715000
*   DO;                             /* ?IGFDMSG MSG(IGF511A)CODE(TO-C   00716000
*                                      UA,VOL-SER,LABEL-TYPE,VOL-SEQ)   00717000
*                                      RETRY(2)                      */ 00718000
*                                                                  0314 00719000
*     /***************************************************************/ 00720000
*     /*                                                             */ 00721000
*     /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE WRITER                 */ 00722000
*     /*                                                             */ 00723000
*     /***************************************************************/ 00724000
*                                                                  0315 00725000
*     DDRMSGCD=DDRM511A;            /* SET UP MSG CODE               */ 00726000
         MVI   DDRMSGCD(DDRPTR),X'08'                              0315 00727000
*     DDRMSGPN=4;                   /* SET UP NO. OF SUBST. CODES    */ 00728000
         MVI   DDRMSGPN(DDRPTR),X'04'                              0316 00729000
*     DDRMSGPC(1)=DDRPTO;           /* SET SUBSTITUTION CODE 1       */ 00730000
         MVI   DDRMSGPC(DDRPTR),X'03'                              0317 00731000
*     DDRMSGPC(2)=DDRPVL;           /* SET SUBSTITUTION CODE 2       */ 00732000
         MVI   DDRMSGPC+1(DDRPTR),X'04'                            0318 00733000
*     DDRMSGPC(3)=DDRPLT;           /* SET SUBSTITUTION CODE 3       */ 00734000
         MVI   DDRMSGPC+2(DDRPTR),X'05'                            0319 00735000
*     DDRMSGPC(4)=DDRPSN;           /* SET SUBSTITUTION CODE 4       */ 00736000
         MVI   DDRMSGPC+3(DDRPTR),X'06'                            0320 00737000
*     RTNCODE=12;                   /* INDICATE MESSAGE NOT DONE YET */ 00738000
         LA    RTNCODE,12                                          0321 00739000
*     DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP UNTIL MSG DONE    */ 00740000
         LA    @14,1                                               0322 00741000
         STC   @14,DDRRETRY(,DDRPTR)                               0322 00742000
@DL00322 C     RTNCODE,@CF00621                                    0322 00743000
         BNE   @DC00322                                            0322 00744000
*       CALL IGFDM0;                /* OUTPUT MESSAGE                */ 00745000
         L     @15,@CV00609                                        0323 00746000
         BALR  @14,@15                                             0323 00747000
*     END;                          /* END OF RETRY LOOP             */ 00748000
         LA    @14,1                                               0324 00749000
         SLR   @12,@12                                             0324 00750000
         IC    @12,DDRRETRY(,DDRPTR)                               0324 00751000
         ALR   @14,@12                                             0324 00752000
         STC   @14,DDRRETRY(,DDRPTR)                               0324 00753000
         C     @14,@CF00080                                        0324 00754000
         BNH   @DL00322                                            0324 00755000
@DC00322 DS    0H                                                  0325 00756000
*   END;                            /* ?IGFDMSG MSG(IGF511A)CODE(TO-C   00757000
*                                      UA,VOL-SER,LABEL-TYPE,VOL-SEQ)   00758000
*                                      RETRY(2) WRONG VOLUME MESSAGE */ 00759000
*   DDRTER1=0;                      /* IGNORE ALL ERRORS             */ 00760000
         MVI   DDRTER1(DDRPTR),X'00'                               0326 00761000
*   IF WRVOLCNT<5 THEN              /* WRONG VOLUME LOOP ?           */ 00762000
         C     WRVOLCNT,@CF00417                                   0327 00763000
         BNL   @RF00327                                            0327 00764000
*     MOUNTSWH='1'B;                /* NO - MOUNT SEQUENCE IS TO BE     00765000
*                                      RE-ISSUED                     */ 00766000
         OI    MOUNTSWH,B'10000000'                                0328 00767000
*   ELSE                            /* YES - THE VOL VERIFICATION  0329 00768000
*                                      PROCESS IS IN A LOOP          */ 00769000
*     DO;                                                          0329 00770000
         B     @RC00327                                            0329 00771000
@RF00327 DS    0H                                                  0330 00772000
*       VERIFSWH='0'B;              /* TERMINATE LABEL PROCESSING    */ 00773000
         NI    VERIFSWH,B'10111111'                                0330 00774000
*       DERLRC=8;                   /* SET LOCAL RETURN CODE TO CAUSE   00775000
*                                      IGFDT0 TO RECYCLE THE SWAP    */ 00776000
         MVI   DERLRC,X'08'                                        0331 00777000
*     END;                                                         0332 00778000
*   RETURN;                         /* RETURN TO CALLER              */ 00779000
@EL00008 DS    0H                                                  0333 00780000
@EF00008 DS    0H                                                  0333 00781000
@ER00008 LM    @14,@05,@SA00008                                    0333 00782000
         LM    @08,@12,@SA00008+32                                 0333 00783000
         BR    @14                                                 0333 00784000
*   END DT2WRONG;                                                  0334 00785000
         B     @EL00008                                            0334 00786000
*                                                                  0335 00787000
*   /*****************************************************************/ 00788000
*   /*                                                               */ 00789000
*   /* REWIND AND UNLOAD SUBROUTINE                                  */ 00790000
*   /*                                                               */ 00791000
*   /*****************************************************************/ 00792000
*                                                                  0335 00793000
*DT2UNLD:                                                          0335 00794000
*   PROC;                           /* THIS SUBROUTINE IS CALLED WHEN   00795000
*                                      THE TAPE IS TO BE REWOUND AND    00796000
*                                      UNLOADED FOR AN ERROR, WRONG     00797000
*                                      VOLUME, OR UNEXPECTED       0335 00798000
*                                      TERMINATION .                 */ 00799000
DT2UNLD  STM   @14,@05,@SA00009                                    0335 00800000
         STM   @07,@12,@SA00009+32                                 0335 00801000
*   LABLKCNT=0;                     /* ZERO LABEL BLOCKCOUNT         */ 00802000
         SLR   LABLKCNT,LABLKCNT                                   0336 00803000
*   DDRIOF1=DDRRUN;                 /* SET REWIND AND UNLOAD FLAG    */ 00804000
         MVI   DDRIOF1(DDRPTR),X'0F'                               0337 00805000
*   DDRIOF2=0;                      /* CLEAR BYTE                    */ 00806000
         MVI   DDRIOF2(DDRPTR),X'00'                               0338 00807000
*   DDRWHICH='1'B;                  /* I/O TO BE PERFORMED           */ 00808000
*   DDRITAKE='1'B;                  /* SET CONTROL INDICATOR         */ 00809000
         OI    DDRWHICH(DDRPTR),B'11000000'                        0340 00810000
*   CALL IGFDM1;                    /* REWIND AND UNLOAD             */ 00811000
         L     @15,@CV00608                                        0341 00812000
         BALR  @14,@15                                             0341 00813000
*   DDRTER1=0;                      /* IGNORE ERRORS                 */ 00814000
         MVI   DDRTER1(DDRPTR),X'00'                               0342 00815000
*   RETURN;                         /* RETURN TO CALLER              */ 00816000
@EL00009 DS    0H                                                  0343 00817000
@EF00009 DS    0H                                                  0343 00818000
@ER00009 LM    @14,@05,@SA00009                                    0343 00819000
         LM    @07,@12,@SA00009+32                                 0343 00820000
         BR    @14                                                 0343 00821000
*   END DT2UNLD;                                                   0344 00822000
*                                                                  0345 00823000
*   /*****************************************************************/ 00824000
*   /*                                                               */ 00825000
*   /* NSL CODE 0 POSITIONING SUBROUTINE                             */ 00826000
*   /*                                                               */ 00827000
*   /*****************************************************************/ 00828000
*                                                                  0345 00829000
*DT2NSL0:                                                          0345 00830000
*   PROC;                           /* THIS SUBROUTINE IS ENTERED  0345 00831000
*                                      WHEN THE USER HAS A LABEL IN     00832000
*                                      THE FORMAT -                0345 00833000
*                                      L1|L2|...|LN|TM|D1|D2|...|DM|    00834000
*                                      WITH A RETURN CODE=0 FROM   0345 00835000
*                                      NSLREPOS, DDR IS TO ISSUE A 0345 00836000
*                                      SKIP FILE COMMAND PRIOR TO  0345 00837000
*                                      POSITIONING THE TAPE.         */ 00838000
DT2NSL0  STM   @14,@03,12(@13)                                     0345 00839000
         ST    @05,40(,@13)                                        0345 00840000
         STM   @07,@12,48(@13)                                     0345 00841000
*   VERIFSWH='0'B;                  /* CLEAR LABEL VERIFICATION      */ 00842000
         NI    VERIFSWH,B'10111111'                                0346 00843000
*   LABLKCNT='0'B;                  /* CLEAR LABEL BLOCKCOUNT        */ 00844000
         SLR   LABLKCNT,LABLKCNT                                   0347 00845000
*   FILECNT=FILECNT+1;              /* INCREMENT COUNT               */ 00846000
         AL    FILECNT,@CF00051                                    0348 00847000
*   RETURN;                         /* RETURN TO CALLER              */ 00848000
@EL00010 DS    0H                                                  0349 00849000
@EF00010 DS    0H                                                  0349 00850000
@ER00010 LM    @14,@03,12(@13)                                     0349 00851000
         L     @05,40(,@13)                                        0349 00852000
         LM    @07,@12,48(@13)                                     0349 00853000
         BR    @14                                                 0349 00854000
*   END DT2NSL0;                                                   0350 00855000
*                                                                  0351 00856000
*   /*****************************************************************/ 00857000
*   /*                                                               */ 00858000
*   /* NSL CODE 4 POSITIONING SUBROUTINE                             */ 00859000
*   /*                                                               */ 00860000
*   /*****************************************************************/ 00861000
*                                                                  0351 00862000
*DT2NSL4:                                                          0351 00863000
*   PROC;                           /* THIS SUBROUTINE IS ENTERED  0351 00864000
*                                      WHEN A FURTHER LABEL IS NEEDED   00865000
*                                      BY NSLREPOS IN THE FORMAT - 0351 00866000
*                                      L1|L2|L3|...|LN| THIS MEANS 0351 00867000
*                                      THAT THE LOGICAL LABEL IS   0351 00868000
*                                      SPREAD OVER MORE THAN THE   0351 00869000
*                                      PHYSICAL LABEL                */ 00870000
DT2NSL4  STM   @14,@05,@SA00011                                    0351 00871000
         STM   @07,@12,@SA00011+32                                 0351 00872000
*   LABLKCNT=LABLKCNT+1;            /* INCREMENT COUNT               */ 00873000
         AL    LABLKCNT,@CF00051                                   0352 00874000
*   DDRIOF1=DDRREAD;                /* SET READ FLAG                 */ 00875000
         MVI   DDRIOF1(DDRPTR),X'02'                               0353 00876000
*   DDRIOF2=0;                      /* CLEAR BYTE                    */ 00877000
         MVI   DDRIOF2(DDRPTR),X'00'                               0354 00878000
*   DDRITAKE='1'B;                  /* SET CONTROL INDICATOR         */ 00879000
*   DDRILAB='1'B;                   /* SET LABEL PROCESSING FLAG     */ 00880000
         OI    DDRITAKE(DDRPTR),B'01100000'                        0356 00881000
*   DDRIBUFL=LENGTH(IOBUFFER);      /* BUFFER LENGTH                 */ 00882000
         MVC   DDRIBUFL(2,DDRPTR),@CH00599                         0357 00883000
*   IOBUFFER=IOBUFFER&&IOBUFFER;    /* ZERO BUFFER                   */ 00884000
         L     @14,DDRIBUF(,DDRPTR)                                0358 00885000
         XC    IOBUFFER(80,@14),IOBUFFER(@14)                      0358 00886000
*   CALL IGFDM1;                    /* READ ANOTHER LABEL            */ 00887000
         L     @15,@CV00608                                        0359 00888000
         BALR  @14,@15                                             0359 00889000
*   IF RTNCODE^=0 THEN              /* IS RETURN CODE ZERO ?         */ 00890000
         LTR   RTNCODE,RTNCODE                                     0360 00891000
         BZ    @RF00360                                            0360 00892000
*     CALL DT2IOERR;                /* NO - I/O ERROR                */ 00893000
         BAL   @14,DT2IOERR                                        0361 00894000
*   ELSE                                                           0362 00895000
*     ;                             /* YES - RETURN CODE IS ZERO     */ 00896000
@RF00360 DS    0H                                                  0363 00897000
*   RETURN;                         /* RETURN TO CALLER              */ 00898000
@EL00011 DS    0H                                                  0363 00899000
@EF00011 DS    0H                                                  0363 00900000
@ER00011 LM    @14,@05,@SA00011                                    0363 00901000
         LM    @07,@12,@SA00011+32                                 0363 00902000
         BR    @14                                                 0363 00903000
*   END DT2NSL4;                                                   0364 00904000
*                                                                  0365 00905000
*   /*****************************************************************/ 00906000
*   /*                                                               */ 00907000
*   /* NSL CODE 12 POSITIONING SUBROUTINE                            */ 00908000
*   /*                                                               */ 00909000
*   /*****************************************************************/ 00910000
*                                                                  0365 00911000
*DT2NSL12:                                                         0365 00912000
*   PROC;                           /* THIS SUBROUTINE IS ENTERED  0365 00913000
*                                      WHEN LABEL POSITIONING IS   0365 00914000
*                                      COMPLETE WITH THE FOLLOWING 0365 00915000
*                                      FORMAT -                    0365 00916000
*                                      L1|L2|L3|...|LN|D1|D2|...|DM|    00917000
*                                      NO TAPEMARK BETWEEN LABELS AND   00918000
*                                      DATA RECORDS AND THE        0365 00919000
*                                      BLOCKCOUNT FOR THE DATA     0365 00920000
*                                      RECORDS INCLUDES THE LABEL  0365 00921000
*                                      COUNT.                        */ 00922000
DT2NSL12 STM   @14,@05,12(@13)                                     0365 00923000
         STM   @07,@12,48(@13)                                     0365 00924000
*   LABLKCNT=0;                     /* ZERO LABEL COUNT      @YM07700*/ 00925000
         SLR   LABLKCNT,LABLKCNT                                   0366 00926000
*   VERIFSWH='0'B;                  /* GOOD LABEL-VERIFY COMPLETE    */ 00927000
         NI    VERIFSWH,B'10111111'                                0367 00928000
*   RETURN;                         /* RETURN TO CALLER              */ 00929000
@EL00012 DS    0H                                                  0368 00930000
@EF00012 DS    0H                                                  0368 00931000
@ER00012 LM    @14,@05,12(@13)                                     0368 00932000
         LM    @07,@12,48(@13)                                     0368 00933000
         BR    @14                                                 0368 00934000
*   END DT2NSL12;                                                  0369 00935000
*                                                                  0370 00936000
*   /*****************************************************************/ 00937000
*   /*                                                               */ 00938000
*   /* NSL CODE 16 POSITIONING SUBROUTINE                            */ 00939000
*   /*                                                               */ 00940000
*   /*****************************************************************/ 00941000
*                                                                  0370 00942000
*DT2NSL16:                                                         0370 00943000
*   PROC;                           /* THIS SUBROUTINE IS ENTERED  0370 00944000
*                                      WHEN LABEL VERIFICATION IS  0370 00945000
*                                      COMPLETE AND THE TAPE HAS ONE    00946000
*                                      OF THE FOLLOWING THREE FORMATS   00947000
*                                      -                           0370 00948000
*                                      L1|L2|L3|...|LN|D1|D2|...|DM|    00949000
*                                      (BLOCKCOUNT DOES NOT INCLUDE     00950000
*                                      LABEL COUNT), L1|L2|L3|...|LN|   00951000
*                                      TM|D1|D2|...|DM|, OR        0370 00952000
*                                      TM|D1|D2|...|DM|              */ 00953000
DT2NSL16 STM   @14,@05,12(@13)                                     0370 00954000
         STM   @07,@12,48(@13)                                     0370 00955000
*   LABLKCNT=0;                     /* ZERO LABEL BLOCKCOUNT         */ 00956000
         SLR   LABLKCNT,LABLKCNT                                   0371 00957000
*   VERIFSWH='0'B;                  /* VERIFY COMPLETE               */ 00958000
         NI    VERIFSWH,B'10111111'                                0372 00959000
*   RETURN;                         /* RETURN TO CALLER              */ 00960000
@EL00013 DS    0H                                                  0373 00961000
@EF00013 DS    0H                                                  0373 00962000
@ER00013 LM    @14,@05,12(@13)                                     0373 00963000
         LM    @07,@12,48(@13)                                     0373 00964000
         BR    @14                                                 0373 00965000
*   END DT2NSL16;                                                  0374 00966000
*                                                                  0375 00967000
*   /*****************************************************************/ 00968000
*   /*                                                               */ 00969000
*   /* NSL CODE 20 POSITIONING SUBROUTINE                            */ 00970000
*   /*                                                               */ 00971000
*   /*****************************************************************/ 00972000
*                                                                  0375 00973000
*DT2NSL20:                                                         0375 00974000
*   PROC;                           /* THIS SUBROUTINE IS ENTERED  0375 00975000
*                                      WHEN THE NSLREPOS ROUTINE   0375 00976000
*                                      ELECTS TO CANCEL THE SWAP     */ 00977000
DT2NSL20 STM   @14,@05,@SA00014                                    0375 00978000
         STM   @07,@12,@SA00014+32                                 0375 00979000
*   CALL DT2UNLD;                   /* REWIND AND UNLOAD             */ 00980000
         BAL   @14,DT2UNLD                                         0376 00981000
*   DDRTER1=DDRTCU;                 /* CANCELLED BY USER             */ 00982000
         MVI   DDRTER1(DDRPTR),X'09'                               0377 00983000
*   DERLRC=12;                      /* ABORT SWAP                    */ 00984000
         MVI   DERLRC,X'0C'                                        0378 00985000
*   VERIFSWH='0'B;                  /* TERMINATE DT2NSL              */ 00986000
         NI    VERIFSWH,B'10111111'                                0379 00987000
*   RETURN;                         /* RETURN TO CALLER              */ 00988000
@EL00014 DS    0H                                                  0380 00989000
@EF00014 DS    0H                                                  0380 00990000
@ER00014 LM    @14,@05,@SA00014                                    0380 00991000
         LM    @07,@12,@SA00014+32                                 0380 00992000
         BR    @14                                                 0380 00993000
*   END DT2NSL20;                                                  0381 00994000
*                                                                  0382 00995000
*   /*****************************************************************/ 00996000
*   /*                                                               */ 00997000
*   /* ESOTERIC ESTAE SUBROUTINE                                     */ 00998000
*   /*                                                               */ 00999000
*   /*****************************************************************/ 01000000
*                                                                  0382 01001000
*IGFDT2S:                                                          0382 01002000
*   PROC;                           /* THIS SUBROUTINE IS ENTERED  0382 01003000
*                                      FROM IGFDE0 DURING ESTAE    0382 01004000
*                                      PROCESSING                    */ 01005000
IGFDT2S  STM   @14,@12,12(@13)                                     0382 01006000
*   IF DDRPTR^=0 THEN               /* IS DDRCOM BASE REG ZERO ?     */ 01007000
         LTR   DDRPTR,DDRPTR                                       0383 01008000
         BZ    @RF00383                                            0383 01009000
*     DO;                           /* NO - DDRCOM BASE REG IS     0384 01010000
*                                      NON-ZERO                      */ 01011000
*       IF SVC85SWH='1'B THEN       /* IS SVC 85 IN PROCESS ?        */ 01012000
         TM    SVC85SWH,B'00100000'                                0385 01013000
         BNO   @RF00385                                            0385 01014000
*         DDRTER1=DDRTIU;           /* YES - INVALID USER EXIT       */ 01015000
         MVI   DDRTER1(DDRPTR),X'06'                               0386 01016000
*       ELSE                                                       0387 01017000
*         ;                         /* NO                            */ 01018000
@RF00385 DS    0H                                                  0388 01019000
*     END;                                                         0388 01020000
*   ELSE                                                           0389 01021000
*     ;                             /* YES -DDRCOM BASE REG IS ZERO  */ 01022000
@RF00383 DS    0H                                                  0390 01023000
*   RETURN;                         /* RETURN TO CALLER              */ 01024000
@EL00015 DS    0H                                                  0390 01025000
@EF00015 DS    0H                                                  0390 01026000
@ER00015 LM    @14,@12,12(@13)                                     0390 01027000
         BR    @14                                                 0390 01028000
*   END IGFDT2S;                                                   0391 01029000
*   END IGFDT2                                                     0392 01030000
*                                                                  0392 01031000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01032000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 01033000
*/*%INCLUDE SYSLIB  (IHADDR  )                                       */ 01034000
*                                                                  0392 01035000
*       ;                                                          0392 01036000
@DATA    DS    0H                                                       01037000
@CH00132 DC    H'3'                                                     01038000
@CH00599 DC    H'80'                                                    01039000
@DATD    DSECT                                                          01040000
         DS    0F                                                       01041000
@SA00001 DS    18F                                                      01042000
@SA00011 DS    14F                                                      01043000
@SA00008 DS    13F                                                      01044000
@SA00014 DS    14F                                                      01045000
@SA00002 DS    15F                                                      01046000
@SA00003 DS    15F                                                      01047000
@SA00004 DS    15F                                                      01048000
@SA00007 DS    12F                                                      01049000
@SA00006 DS    15F                                                      01050000
@SA00005 DS    14F                                                      01051000
@SA00009 DS    0F                                                       01052000
         DS    14F                                                      01053000
@AL00001 DS    1A                                                       01054000
IGFDT2   CSECT                                                          01055000
         DS    0F                                                       01056000
@CF00051 DC    F'1'                                                     01057000
@CF00080 DC    F'2'                                                     01058000
@CF00134 DC    F'4'                                                     01059000
@CF00417 DC    F'5'                                                     01060000
@CF00621 DC    F'12'                                                    01061000
@CH00621 EQU   @CF00621+2                                               01062000
@CF00694 DC    F'20'                                                    01063000
@DATD    DSECT                                                          01064000
         DS    0D                                                       01065000
XLATEADD DS    A                                                        01066000
SWITCHES DS    BL1                                                      01067000
         ORG   SWITCHES                                                 01068000
MOUNTSWH DS    BL1                                                      01069000
VERIFSWH EQU   SWITCHES+0                                               01070000
SVC85SWH EQU   SWITCHES+0                                               01071000
@NM00013 EQU   SWITCHES+0                                               01072000
         ORG   SWITCHES+1                                               01073000
         DS    CL3                                                      01074000
DERPLIST DS    CL48                                                     01075000
         ORG   DERPLIST                                                 01076000
DERFUNK  DS    AL1                                                      01077000
DERSWCHS DS    BL1                                                      01078000
         ORG   DERSWCHS                                                 01079000
DERCRASH DS    BL1                                                      01080000
DERPERK  EQU   DERSWCHS+0                                               01081000
DERECALL EQU   DERSWCHS+0                                               01082000
DERESTAE EQU   DERSWCHS+0                                               01083000
@NM00015 EQU   DERSWCHS+0                                               01084000
         ORG   DERPLIST+2                                               01085000
@NM00016 DS    CL2                                                      01086000
DERREC   DS    AL4                                                      01087000
DERSPEC  DS    AL4                                                      01088000
DERRETRY DS    AL4                                                      01089000
DERDATD  DS    CL4                                                      01090000
         ORG   DERDATD                                                  01091000
DERDASPN DS    FL1                                                      01092000
DERDALNG DS    FL3                                                      01093000
         ORG   DERPLIST+20                                              01094000
DERRSRC  DS    BL1                                                      01095000
         ORG   DERRSRC                                                  01096000
DERTAPE  DS    BL1                                                      01097000
DERUREC  EQU   DERRSRC+0                                                01098000
DERDISK  EQU   DERRSRC+0                                                01099000
@NM00017 EQU   DERRSRC+0                                                01100000
         ORG   DERPLIST+21                                              01101000
DERLRC   DS    AL1                                                      01102000
DERRUB   DS    CL18                                                     01103000
         ORG   DERRUB                                                   01104000
DERPFX   DS    BL2                                                      01105000
DERRCODE DS    AL4                                                      01106000
DERRDATA DS    AL4                                                      01107000
DERRDDR  DS    AL4                                                      01108000
DERRSAVE DS    AL4                                                      01109000
         ORG   DERPLIST+40                                              01110000
DERGMSPL DS    CL4                                                      01111000
         ORG   DERGMSPL                                                 01112000
DERGMSPN DS    FL1                                                      01113000
DERGMLNG DS    FL3                                                      01114000
         ORG   DERPLIST+44                                              01115000
DERGMADR DS    AL4                                                      01116000
         ORG   DERPLIST+48                                              01117000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01118000
@ENDDATD EQU   *                                                        01119000
IGFDT2   CSECT                                                          01120000
         DS    0F                                                       01121000
@SIZDATD DC    AL1(245)                                                 01122000
         DC    AL3(@ENDDATD-@DATD)                                      01123000
@CV00605 DC    V(IGFDE0)                                                01124000
@CV00607 DC    V(IGFDT1)                                                01125000
@CV00608 DC    V(IGFDM1)                                                01126000
@CV00609 DC    V(IGFDM0)                                                01127000
         DS    0D                                                       01128000
@CC00688 DC    C'VOL1'                                                  01129000
@CB00624 DC    X'000000000000'                                          01130000
@CB00670 DC    B'0000000011100100'                                      01131000
DERRECPM DS    CL24                                                     01132000
         ORG   DERRECPM                                                 01133000
@NM00018 DC    CL8'IGFDI0'                                              01134000
@NM00019 DC    CL8'IGFDT2'                                              01135000
@NM00020 DC    CL8'77109'                                               01136000
         ORG   DERRECPM+24                                              01137000
DT2SUBS  DC    AL4(DT2NSL0)                                             01138000
         DC    AL4(DT2NSL4)                                             01139000
         DC    AL4(DT2WRONG)                                            01140000
         DC    AL4(DT2NSL12)                                            01141000
         DC    AL4(DT2NSL16)                                            01142000
         DC    AL4(DT2NSL20)                                            01143000
IGFDT2P  DC    13F'0'                                                   01144000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01145000
@01      EQU   01                                                       01146000
@02      EQU   02                                                       01147000
@03      EQU   03                                                       01148000
@04      EQU   04                                                       01149000
@05      EQU   05                                                       01150000
@06      EQU   06                                                       01151000
@07      EQU   07                                                       01152000
@08      EQU   08                                                       01153000
@09      EQU   09                                                       01154000
@10      EQU   10                                                       01155000
@11      EQU   11                                                       01156000
@12      EQU   12                                                       01157000
@13      EQU   13                                                       01158000
@14      EQU   14                                                       01159000
@15      EQU   15                                                       01160000
SUBPTR   EQU   @11                                                      01161000
WRVOLCNT EQU   @07                                                      01162000
FILECNT  EQU   @04                                                      01163000
LABLKCNT EQU   @06                                                      01164000
BLOCKCNT EQU   @05                                                      01165000
CODEBASE EQU   @08                                                      01166000
DATABASE EQU   @09                                                      01167000
DDRPTR   EQU   @10                                                      01168000
R1       EQU   @01                                                      01169000
SAVEPTR  EQU   @13                                                      01170000
RTNCODE  EQU   @15                                                      01171000
UCB      EQU   0                                                        01172000
UCBOB    EQU   0                                                        01173000
UCBJBNR  EQU   UCBOB                                                    01174000
UCBFL5   EQU   UCBOB+1                                                  01175000
UCBAF    EQU   UCBFL5                                                   01176000
UCBSTAT  EQU   UCBOB+3                                                  01177000
UCBCHAN  EQU   UCBOB+4                                                  01178000
UCBSFLS  EQU   UCBOB+6                                                  01179000
UCBFLA   EQU   UCBSFLS                                                  01180000
UCBFL1   EQU   UCBFLA                                                   01181000
UCBBSY   EQU   UCBFL1                                                   01182000
UCBNRY   EQU   UCBFL1                                                   01183000
UCBPST   EQU   UCBFL1                                                   01184000
UCBCUB   EQU   UCBFL1                                                   01185000
UCBFLB   EQU   UCBSFLS+1                                                01186000
UCBCHM   EQU   UCBOB+8                                                  01187000
UCBCHM1  EQU   UCBCHM                                                   01188000
UCBPTH0  EQU   UCBCHM1                                                  01189000
UCBPTH1  EQU   UCBCHM1                                                  01190000
UCBWGT   EQU   UCBOB+12                                                 01191000
UCBTYP   EQU   UCBOB+16                                                 01192000
UCBTBYT1 EQU   UCBTYP                                                   01193000
UCB1FEA5 EQU   UCBTBYT1                                                 01194000
UCB1FEA6 EQU   UCBTBYT1                                                 01195000
UCBTBYT2 EQU   UCBTYP+1                                                 01196000
UCB2OPT2 EQU   UCBTBYT2                                                 01197000
UCBDUDN1 EQU   UCB2OPT2                                                 01198000
UCB2OPT3 EQU   UCBTBYT2                                                 01199000
UCBDUDN2 EQU   UCB2OPT3                                                 01200000
UCB2OPT4 EQU   UCBTBYT2                                                 01201000
UCBRWTAU EQU   UCB2OPT4                                                 01202000
UCB2OPT6 EQU   UCBTBYT2                                                 01203000
UCB2OPT7 EQU   UCBTBYT2                                                 01204000
UCBTBYT3 EQU   UCBTYP+2                                                 01205000
UCBDVCLS EQU   UCBTBYT3                                                 01206000
UCBTBYT4 EQU   UCBTYP+3                                                 01207000
UCBEXTPT EQU   UCBOB+20                                                 01208000
UCBFLC   EQU   UCBEXTPT                                                 01209000
UCBDEV   EQU   UCBOB+24                                                 01210000
UCBCMEXT EQU   0                                                        01211000
UCBATI   EQU   UCBCMEXT+3                                               01212000
@NM00004 EQU   UCBATI                                                   01213000
UCBFLP1  EQU   UCBCMEXT+5                                               01214000
UCBMT    EQU   0                                                        01215000
UCBOCR   EQU   0                                                        01216000
UCB3540X EQU   0                                                        01217000
UCBDKBYT EQU   UCB3540X+6                                               01218000
UCBUCS   EQU   0                                                        01219000
UCBUCSOP EQU   UCBUCS+4                                                 01220000
UCBFCBOP EQU   UCBUCS+5                                                 01221000
DDRCOM   EQU   0                                                        01222000
DDRSHORT EQU   DDRCOM                                                   01223000
DDRCNTRL EQU   DDRSHORT+8                                               01224000
DDRSRC   EQU   DDRCNTRL                                                 01225000
DDRSTAT  EQU   DDRCNTRL+1                                               01226000
DDRDCHAR EQU   DDRCNTRL+2                                               01227000
DDRDSTAT EQU   DDRDCHAR+1                                               01228000
DDRLONG  EQU   DDRCOM+24                                                01229000
DDRTOUCB EQU   DDRLONG                                                  01230000
DDRROWN  EQU   DDRLONG+8                                                01231000
DDRMIHT  EQU   DDRLONG+12                                               01232000
DDRTER   EQU   DDRLONG+36                                               01233000
DDRTER1  EQU   DDRTER                                                   01234000
DDRINV   EQU   DDRLONG+38                                               01235000
DDRINV2  EQU   DDRINV+1                                                 01236000
DDRAPP   EQU   DDRLONG+40                                               01237000
DDRIBUFL EQU   DDRLONG+42                                               01238000
DDRIBUF  EQU   DDRLONG+44                                               01239000
DDRCOUNT EQU   DDRLONG+48                                               01240000
DDRIOF   EQU   DDRLONG+52                                               01241000
DDRIOF1  EQU   DDRIOF                                                   01242000
DDRIOF2  EQU   DDRIOF+1                                                 01243000
DDRWHICH EQU   DDRIOF2                                                  01244000
DDRITAKE EQU   DDRIOF2                                                  01245000
DDRILAB  EQU   DDRIOF2                                                  01246000
DDRIMNT  EQU   DDRIOF2                                                  01247000
DDRICNT  EQU   DDRIOF2                                                  01248000
DDRMSG   EQU   DDRLONG+54                                               01249000
DDRMSGCD EQU   DDRMSG+1                                                 01250000
DDRMSGP  EQU   DDRLONG+56                                               01251000
DDRMSGPN EQU   DDRMSGP                                                  01252000
DDRMSGPC EQU   DDRMSGP+1                                                01253000
DDRLABEL EQU   DDRLONG+64                                               01254000
DDRLAL   EQU   DDRLABEL                                                 01255000
DDRLNL   EQU   DDRLABEL                                                 01256000
DDRLNSL  EQU   DDRLABEL                                                 01257000
DDRLSD   EQU   DDRLABEL                                                 01258000
DDRLNOP  EQU   DDRLABEL                                                 01259000
DDRRETRY EQU   DDRLONG+65                                               01260000
DDRREC   EQU   DDRLONG+66                                               01261000
DDRREC2  EQU   DDRREC+1                                                 01262000
DDRUSER  EQU   DDRLONG+68                                               01263000
DDRUBCNT EQU   DDRLONG+72                                               01264000
IOBUFFER EQU   0                                                        01265000
VOLLABIN EQU   IOBUFFER                                                 01266000
VOLSERNO EQU   IOBUFFER+4                                               01267000
DT2SUB   EQU   0                                                        01268000
UCBBGN   EQU   0                                                        01269000
UCBPTR   EQU   DDRTOUCB                                                 01270000
UCBOBS01 EQU   UCBDEV                                                   01271000
UCBVOLI  EQU   UCBOBS01+4                                               01272000
UCBSTAB  EQU   UCBOBS01+10                                              01273000
UCBBSVL  EQU   UCBSTAB                                                  01274000
UCBPRSRS EQU   UCBSTAB                                                  01275000
UCBDMCT  EQU   UCBOBS01+11                                              01276000
UCBFL4   EQU   UCBOBS01+13                                              01277000
UCBOBS02 EQU   UCBDEV                                                   01278000
UCBFSCT  EQU   UCBOBS02                                                 01279000
UCBTFL1  EQU   UCBOBS02+19                                              01280000
UCBXTN   EQU   UCBOBS02+20                                              01281000
UCBVOPT  EQU   UCBXTN                                                   01282000
UCBOBS03 EQU   UCBDEV                                                   01283000
UCBXTADR EQU   UCBOBS03                                                 01284000
UCBOBS04 EQU   UCBDEV                                                   01285000
UCBBTA   EQU   UCBOBS04+12                                              01286000
UCBOBS06 EQU   UCBDEV                                                   01287000
UCBAOF   EQU   UCBOBS06                                                 01288000
UCBAOF1  EQU   UCBAOF                                                   01289000
UCBAOF2  EQU   UCBAOF+1                                                 01290000
@NM00003 EQU   UCBOBS06+3                                               01291000
UCBIRB   EQU   UCBOBS06+4                                               01292000
UCBGRAF  EQU   UCBIRB                                                   01293000
UCBLDNCA EQU   UCBOBS06+8                                               01294000
UCBRDYQ  EQU   UCBLDNCA                                                 01295000
UCBIRLN  EQU   UCBRDYQ                                                  01296000
UCBLDNCB EQU   UCBRDYQ+1                                                01297000
UCBCTLNK EQU   UCBOBS06+12                                              01298000
UCBOBS07 EQU   UCBDEV                                                   01299000
UCBOBS08 EQU   UCBDEV                                                   01300000
UCBOBS09 EQU   UCBDEV                                                   01301000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01302000
UCBRV066 EQU   UCBOBS09+4                                               01303000
UCBIOSBA EQU   UCBOBS09                                                 01304000
UCBRV042 EQU   UCBOBS08+5                                               01305000
UCBCTCF1 EQU   UCBOBS08+4                                               01306000
UCBCTCAD EQU   UCBOBS08                                                 01307000
UCBICNCB EQU   UCBOBS07+4                                               01308000
UCBRV040 EQU   UCBOBS07                                                 01309000
UCBCTLNA EQU   UCBCTLNK+1                                               01310000
UCBRLN   EQU   UCBCTLNK                                                 01311000
UCBRDYQA EQU   UCBLDNCB                                                 01312000
UCBINRLN EQU   UCBIRLN                                                  01313000
UCBIRBA  EQU   UCBIRB+1                                                 01314000
UCBRV039 EQU   UCBGRAF                                                  01315000
UCBDWNR  EQU   UCBGRAF                                                  01316000
UCBRPND  EQU   UCBGRAF                                                  01317000
UCBUPM   EQU   UCBGRAF                                                  01318000
UCBBTAM  EQU   UCBGRAF                                                  01319000
UCBDRNO  EQU   UCBGRAF                                                  01320000
UCBDRO   EQU   UCBGRAF                                                  01321000
UCBOIP   EQU   UCBGRAF                                                  01322000
UCBATRCD EQU   @NM00003                                                 01323000
UCBSKPFG EQU   @NM00003                                                 01324000
UCBRIPND EQU   @NM00003                                                 01325000
UCBRTIAC EQU   @NM00003                                                 01326000
UCBRSV79 EQU   @NM00003                                                 01327000
UCBRSV78 EQU   @NM00003                                                 01328000
UCBRSV77 EQU   @NM00003                                                 01329000
UCBOLTEP EQU   @NM00003                                                 01330000
UCBATNCT EQU   UCBOBS06+2                                               01331000
UCBRSV76 EQU   UCBAOF2                                                  01332000
UCBRSV75 EQU   UCBAOF2                                                  01333000
UCBRSV74 EQU   UCBAOF2                                                  01334000
UCBRSV73 EQU   UCBAOF2                                                  01335000
UCBRSV72 EQU   UCBAOF2                                                  01336000
UCBRSV71 EQU   UCBAOF2                                                  01337000
UCBRSV70 EQU   UCBAOF2                                                  01338000
UCBRSV69 EQU   UCBAOF2                                                  01339000
UCBRSV68 EQU   UCBAOF1                                                  01340000
UCBRSV67 EQU   UCBAOF1                                                  01341000
UCBRSV66 EQU   UCBAOF1                                                  01342000
UCBRSV65 EQU   UCBAOF1                                                  01343000
UCBRSV64 EQU   UCBAOF1                                                  01344000
UCBOFNL  EQU   UCBAOF1                                                  01345000
UCBOFSP  EQU   UCBAOF1                                                  01346000
UCBOFMCR EQU   UCBAOF1                                                  01347000
UCBBTB   EQU   UCBBTA+1                                                 01348000
UCBDI    EQU   UCBBTA                                                   01349000
UCBSNS   EQU   UCBOBS04+8                                               01350000
UCBTEB   EQU   UCBOBS04+4                                               01351000
UCBGCB   EQU   UCBOBS04+3                                               01352000
UCBOPEN  EQU   UCBOBS04+2                                               01353000
UCBSTART EQU   UCBOBS04                                                 01354000
UCBXTNB  EQU   UCBXTN+1                                                 01355000
UCBRSV22 EQU   UCBVOPT                                                  01356000
UCBRSV21 EQU   UCBVOPT                                                  01357000
UCBRSV20 EQU   UCBVOPT                                                  01358000
UCBESVE  EQU   UCBVOPT                                                  01359000
UCBERPC  EQU   UCBVOPT                                                  01360000
UCBESVC  EQU   UCBVOPT                                                  01361000
UCBEVA   EQU   UCBVOPT                                                  01362000
UCBESV   EQU   UCBVOPT                                                  01363000
UCBRV009 EQU   UCBTFL1                                                  01364000
UCBRV008 EQU   UCBTFL1                                                  01365000
UCBRV007 EQU   UCBTFL1                                                  01366000
UCBRV006 EQU   UCBTFL1                                                  01367000
UCBRV005 EQU   UCBTFL1                                                  01368000
UCBRV038 EQU   UCBTFL1                                                  01369000
UCBNSLTP EQU   UCBTFL1                                                  01370000
UCBNLTP  EQU   UCBTFL1                                                  01371000
UCBRES1B EQU   UCBOBS02+18                                              01372000
UCBFSER  EQU   UCBOBS02+12                                              01373000
@NM00002 EQU   UCBOBS02+4                                               01374000
UCBFSEQ  EQU   UCBOBS02+2                                               01375000
UCBNEXP  EQU   UCBOBS01+20                                              01376000
UCBBASE  EQU   UCBOBS01+16                                              01377000
UCBRES1A EQU   UCBOBS01+15                                              01378000
UCBUSER  EQU   UCBOBS01+14                                              01379000
UCBFL47  EQU   UCBFL4                                                   01380000
UCBFL46  EQU   UCBFL4                                                   01381000
UCBFL45  EQU   UCBFL4                                                   01382000
UCBRV065 EQU   UCBFL4                                                   01383000
UCBDSS   EQU   UCBFL4                                                   01384000
UCBRV028 EQU   UCBFL4                                                   01385000
UCBWDAV  EQU   UCBFL4                                                   01386000
UCBDAVV  EQU   UCBFL4                                                   01387000
UCBSQC   EQU   UCBOBS01+12                                              01388000
UCBDATP  EQU   UCBOBS01+12                                              01389000
UCBDMC   EQU   UCBDMCT                                                  01390000
UCBMOUNT EQU   UCBDMCT                                                  01391000
UCBBNUL  EQU   UCBSTAB                                                  01392000
UCBSHAR  EQU   UCBSTAB                                                  01393000
UCBBSTR  EQU   UCBSTAB                                                  01394000
UCBBPUB  EQU   UCBSTAB                                                  01395000
UCBBPRV  EQU   UCBSTAB                                                  01396000
UCBBALB  EQU   UCBPRSRS                                                 01397000
UCBPGFL  EQU   UCBSTAB                                                  01398000
UCBDVSHR EQU   UCBBSVL                                                  01399000
UCBVTOC  EQU   UCBOBS01                                                 01400000
@NM00014 EQU   IOBUFFER+10                                              01401000
DDRSSOB  EQU   DDRLONG+76                                               01402000
@NM00012 EQU   DDRUSER+1                                                01403000
DDRUMODE EQU   DDRUSER                                                  01404000
@NM00011 EQU   DDRREC2                                                  01405000
DDRRFMTO EQU   DDRREC2                                                  01406000
DDRREC1  EQU   DDRREC                                                   01407000
@NM00010 EQU   DDRLABEL                                                 01408000
DDRLBLP  EQU   DDRLABEL                                                 01409000
DDRMSGOP EQU   DDRMSG                                                   01410000
@NM00009 EQU   DDRIOF2                                                  01411000
DDRAPP2  EQU   DDRAPP+1                                                 01412000
DDRAPP1  EQU   DDRAPP                                                   01413000
DDRINV1  EQU   DDRINV                                                   01414000
DDRTER2  EQU   DDRTER+1                                                 01415000
DDRTEST  EQU   DDRLONG+32                                               01416000
DDRUASCB EQU   DDRLONG+28                                               01417000
DDRUTCB  EQU   DDRLONG+24                                               01418000
DDRUIOB  EQU   DDRLONG+20                                               01419000
DDRUDEB  EQU   DDRMIHT+4                                                01420000
DDRUDCB  EQU   DDRMIHT                                                  01421000
DDRASID  EQU   DDRLONG+10                                               01422000
DDRMIH   EQU   DDRLONG+9                                                01423000
DDRFIRST EQU   DDRROWN                                                  01424000
DDRJES3L EQU   DDRROWN                                                  01425000
@NM00008 EQU   DDRROWN                                                  01426000
DDRRDENQ EQU   DDRROWN                                                  01427000
DDRRUENQ EQU   DDRROWN                                                  01428000
DDRRTENQ EQU   DDRROWN                                                  01429000
DDRFMUCB EQU   DDRLONG+4                                                01430000
DDRTOCUA EQU   DDRSHORT+21                                              01431000
DDRFMCUA EQU   DDRSHORT+18                                              01432000
DDRUASID EQU   DDRSHORT+16                                              01433000
DDRUIOSB EQU   DDRSHORT+12                                              01434000
@NM00007 EQU   DDRDSTAT                                                 01435000
DDRUR    EQU   DDRDSTAT                                                 01436000
DDRMT    EQU   DDRDSTAT                                                 01437000
DDRDA    EQU   DDRDSTAT                                                 01438000
DDRBUFL  EQU   DDRDSTAT                                                 01439000
DDRMDR   EQU   DDRDCHAR                                                 01440000
@NM00006 EQU   DDRSTAT                                                  01441000
DDRSIRB  EQU   DDRSTAT                                                  01442000
DDRPRG   EQU   DDRSTAT                                                  01443000
DDRRMV   EQU   DDRSTAT                                                  01444000
DDRHAMA  EQU   DDRSTAT                                                  01445000
DDRQUE   EQU   DDRSTAT                                                  01446000
DDRACTV  EQU   DDRSTAT                                                  01447000
@NM00005 EQU   DDRSRC                                                   01448000
DDRPAGE  EQU   DDRSRC                                                   01449000
DDRSYS   EQU   DDRSRC                                                   01450000
DDROPER  EQU   DDRSRC                                                   01451000
DDRNXT   EQU   DDRSHORT+4                                               01452000
DDRID    EQU   DDRSHORT                                                 01453000
UCBERADR EQU   UCBUCS+12                                                01454000
UCBFCBID EQU   UCBUCS+8                                                 01455000
UCBERCNT EQU   UCBUCS+7                                                 01456000
UCBRSV51 EQU   UCBUCS+6                                                 01457000
UCBRSV50 EQU   UCBFCBOP                                                 01458000
UCBRSV49 EQU   UCBFCBOP                                                 01459000
UCBRSV48 EQU   UCBFCBOP                                                 01460000
UCBRSV47 EQU   UCBFCBOP                                                 01461000
UCBRSV46 EQU   UCBFCBOP                                                 01462000
UCBRSV45 EQU   UCBFCBOP                                                 01463000
UCBRSV44 EQU   UCBFCBOP                                                 01464000
UCBFCBO1 EQU   UCBFCBOP                                                 01465000
UCBUCSPE EQU   UCBUCSOP                                                 01466000
UCBRSV43 EQU   UCBUCSOP                                                 01467000
UCBRSV42 EQU   UCBUCSOP                                                 01468000
UCBRSV41 EQU   UCBUCSOP                                                 01469000
UCBRSV40 EQU   UCBUCSOP                                                 01470000
UCBRSV39 EQU   UCBUCSOP                                                 01471000
UCBUCSO2 EQU   UCBUCSOP                                                 01472000
UCBUCSO1 EQU   UCBUCSOP                                                 01473000
UCBUCSID EQU   UCBUCS                                                   01474000
UCBRV073 EQU   UCB3540X+7                                               01475000
UCBRV072 EQU   UCBDKBYT                                                 01476000
UCBRV071 EQU   UCBDKBYT                                                 01477000
UCBRV070 EQU   UCBDKBYT                                                 01478000
UCBRV069 EQU   UCBDKBYT                                                 01479000
UCBRV068 EQU   UCBDKBYT                                                 01480000
UCBRV067 EQU   UCBDKBYT                                                 01481000
UCBVLVER EQU   UCBDKBYT                                                 01482000
UCBDKAMX EQU   UCBDKBYT                                                 01483000
UCBVLSER EQU   UCB3540X                                                 01484000
UCBRDATA EQU   UCBOCR+4                                                 01485000
UCBFRID  EQU   UCBOCR                                                   01486000
UCBCLN   EQU   UCBMT+14                                                 01487000
UCBERG   EQU   UCBMT+12                                                 01488000
UCBMS    EQU   UCBMT+11                                                 01489000
UCBNB    EQU   UCBMT+10                                                 01490000
UCBPW    EQU   UCBMT+9                                                  01491000
UCBPR    EQU   UCBMT+8                                                  01492000
UCBSIO   EQU   UCBMT+6                                                  01493000
UCBTW    EQU   UCBMT+5                                                  01494000
UCBTR    EQU   UCBMT+4                                                  01495000
UCBTWT   EQU   UCBMT+3                                                  01496000
UCBTRT   EQU   UCBMT+2                                                  01497000
UCBCTD   EQU   UCBMT                                                    01498000
UCBWTOID EQU   UCBCMEXT+17                                              01499000
UCBRV043 EQU   UCBCMEXT+16                                              01500000
UCBASID  EQU   UCBCMEXT+14                                              01501000
UCBMFCNT EQU   UCBCMEXT+12                                              01502000
UCBPMSK  EQU   UCBCMEXT+10                                              01503000
UCBCCWOF EQU   UCBCMEXT+8                                               01504000
UCBRV041 EQU   UCBCMEXT+6                                               01505000
UCBRV036 EQU   UCBFLP1                                                  01506000
UCBRV035 EQU   UCBFLP1                                                  01507000
UCBRV034 EQU   UCBFLP1                                                  01508000
UCBRV033 EQU   UCBFLP1                                                  01509000
UCBRV032 EQU   UCBFLP1                                                  01510000
UCBRV031 EQU   UCBFLP1                                                  01511000
UCBSHRUP EQU   UCBFLP1                                                  01512000
UCBNSRCH EQU   UCBFLP1                                                  01513000
UCBSNSCT EQU   UCBCMEXT+4                                               01514000
UCBHPDV  EQU   @NM00004                                                 01515000
UCBHALI  EQU   @NM00004                                                 01516000
UCBRSV09 EQU   @NM00004                                                 01517000
UCBRSV08 EQU   @NM00004                                                 01518000
UCBRSV07 EQU   @NM00004                                                 01519000
UCBRSV06 EQU   @NM00004                                                 01520000
UCBRSV05 EQU   @NM00004                                                 01521000
UCBRSV04 EQU   @NM00004                                                 01522000
UCBDTI   EQU   UCBCMEXT+2                                               01523000
UCBSTI   EQU   UCBCMEXT+1                                               01524000
UCBETI   EQU   UCBCMEXT                                                 01525000
UCBEXTP  EQU   UCBEXTPT+1                                               01526000
UCBDDRSW EQU   UCBFLC                                                   01527000
UCBTICBT EQU   UCBFLC                                                   01528000
UCBIVRR  EQU   UCBFLC                                                   01529000
UCBIVRS  EQU   UCBFLC                                                   01530000
UCBITF   EQU   UCBFLC                                                   01531000
UCBUDE   EQU   UCBFLC                                                   01532000
UCBWAA   EQU   UCBFLC                                                   01533000
UCBATTP  EQU   UCBFLC                                                   01534000
UCBUNTYP EQU   UCBTBYT4                                                 01535000
UCBRSV11 EQU   UCBDVCLS                                                 01536000
UCBRSV10 EQU   UCBDVCLS                                                 01537000
UCB3CHAR EQU   UCBDVCLS                                                 01538000
UCB3UREC EQU   UCBDVCLS                                                 01539000
UCB3DISP EQU   UCBDVCLS                                                 01540000
UCB3DACC EQU   UCBDVCLS                                                 01541000
UCB3COMM EQU   UCBDVCLS                                                 01542000
UCB3TAPE EQU   UCBDVCLS                                                 01543000
UCBDVPWR EQU   UCB2OPT7                                                 01544000
UCBVLPWR EQU   UCB2OPT6                                                 01545000
UCB2OPT5 EQU   UCBTBYT2                                                 01546000
UCBRVDEV EQU   UCBRWTAU                                                 01547000
UCBRPS   EQU   UCBDUDN2                                                 01548000
UCBRR    EQU   UCBDUDN1                                                 01549000
UCB2OPT1 EQU   UCBTBYT2                                                 01550000
UCB2OPT0 EQU   UCBTBYT2                                                 01551000
UCB1FEA7 EQU   UCBTBYT1                                                 01552000
UCBD6250 EQU   UCB1FEA6                                                 01553000
UCBD1600 EQU   UCB1FEA5                                                 01554000
UCB1FEA4 EQU   UCBTBYT1                                                 01555000
UCB1FEA3 EQU   UCBTBYT1                                                 01556000
UCB1FEA2 EQU   UCBTBYT1                                                 01557000
UCB1FEA1 EQU   UCBTBYT1                                                 01558000
UCB1FEA0 EQU   UCBTBYT1                                                 01559000
UCBNAME  EQU   UCBOB+13                                                 01560000
UCBRV029 EQU   UCBWGT                                                   01561000
UCBVHRSN EQU   UCBWGT                                                   01562000
UCBVORSN EQU   UCBWGT                                                   01563000
UCBMTPXP EQU   UCBWGT                                                   01564000
UCBREW   EQU   UCBWGT                                                   01565000
UCBPUB   EQU   UCBWGT                                                   01566000
UCBOUT   EQU   UCBWGT                                                   01567000
UCBIN    EQU   UCBWGT                                                   01568000
UCBCPU   EQU   UCBOB+11                                                 01569000
UCBLCI   EQU   UCBOB+10                                                 01570000
UCBCNT   EQU   UCBOB+9                                                  01571000
UCBRV017 EQU   UCBCHM1                                                  01572000
UCBRV016 EQU   UCBCHM1                                                  01573000
UCBRV015 EQU   UCBCHM1                                                  01574000
UCBRV014 EQU   UCBCHM1                                                  01575000
UCBSPB   EQU   UCBPTH1                                                  01576000
UCBPPB   EQU   UCBPTH1                                                  01577000
UCBSPA   EQU   UCBPTH0                                                  01578000
UCBPPA   EQU   UCBPTH0                                                  01579000
UCBFLB7  EQU   UCBFLB                                                   01580000
UCBVALPH EQU   UCBFLB                                                   01581000
UCBCRHSN EQU   UCBFLB                                                   01582000
UCBCRHRV EQU   UCBFLB                                                   01583000
UCBRESVH EQU   UCBFLB                                                   01584000
UCBSPST  EQU   UCBFLB                                                   01585000
UCBASNS  EQU   UCBFLB                                                   01586000
UCBIORST EQU   UCBFLB                                                   01587000
UCBQISCE EQU   UCBFL1                                                   01588000
UCBACTV  EQU   UCBFL1                                                   01589000
UCBSAP   EQU   UCBFL1                                                   01590000
UCBNOTRC EQU   UCBCUB                                                   01591000
UCBPSNS  EQU   UCBFL1                                                   01592000
UCBUSING EQU   UCBPST                                                   01593000
UCBNOTRD EQU   UCBNRY                                                   01594000
UCBBUSYD EQU   UCBBSY                                                   01595000
UCBUA    EQU   UCBCHAN+1                                                01596000
UCBCHA   EQU   UCBCHAN                                                  01597000
UCBDADI  EQU   UCBSTAT                                                  01598000
UCBSYSR  EQU   UCBSTAT                                                  01599000
UCBPRES  EQU   UCBSTAT                                                  01600000
UCBALOC  EQU   UCBSTAT                                                  01601000
UCBUNLD  EQU   UCBSTAT                                                  01602000
UCBRESV  EQU   UCBSTAT                                                  01603000
UCBCHGS  EQU   UCBSTAT                                                  01604000
UCBONLI  EQU   UCBSTAT                                                  01605000
UCBID    EQU   UCBOB+2                                                  01606000
UCBALTPH EQU   UCBFL5                                                   01607000
UCBALTCU EQU   UCBFL5                                                   01608000
UCBNALOC EQU   UCBFL5                                                   01609000
UCBENVRD EQU   UCBFL5                                                   01610000
UCBVSDR  EQU   UCBFL5                                                   01611000
UCBSASK  EQU   UCBFL5                                                   01612000
UCBAMV   EQU   UCBAF                                                    01613000
UCBDCC   EQU   UCBFL5                                                   01614000
UCBMONT  EQU   UCBJBNR                                                  01615000
UCBRV011 EQU   UCBJBNR                                                  01616000
UCBRSV02 EQU   UCBJBNR                                                  01617000
UCBOLDSM EQU   UCBJBNR                                                  01618000
UCBRV003 EQU   UCBJBNR                                                  01619000
UCBRV002 EQU   UCBJBNR                                                  01620000
UCBJES3  EQU   UCBJBNR                                                  01621000
UCBVRDEV EQU   UCBJBNR                                                  01622000
UCBCMSEG EQU   UCBOB                                                    01623000
UCBPFXND EQU   UCB+512                                                  01624000
UCBIOQ   EQU   UCB+508                                                  01625000
UCBLOCK  EQU   UCB+504                                                  01626000
UCBPXST  EQU   UCB+504                                                  01627000
@NM00001 EQU   UCB                                                      01628000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01629000
@RC00143 EQU   @RC00139                                                 01630000
@RC00141 EQU   @RC00139                                                 01631000
@RF00157 EQU   @EL00002                                                 01632000
@RC00281 EQU   @EL00007                                                 01633000
@RC00327 EQU   @EL00008                                                 01634000
@RC00285 EQU   @RC00281                                                 01635000
@RC00302 EQU   @RC00281                                                 01636000
@RF00301 EQU   @RC00281                                                 01637000
@RC00297 EQU   @RC00281                                                 01638000
@RC00293 EQU   @RC00281                                                 01639000
@RC00294 EQU   @RC00293                                                 01640000
@RC00298 EQU   @RC00297                                                 01641000
@ENDDATA EQU   *                                                        01642000
         END   IGFDT2,(C'PLS1639',0701,77109)                           01643000
