         TITLE 'IGFDV0, DDR - COMMON SELECT ROUTINE                    *00001000
                        '                                               00002000
IGFDV0   CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IGFDV0    76.246'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @08,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@08                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @09,@01                                             0001 00016000
         USING @DATD,@09                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @09,8(,@13)                                         0001 00020000
         LR    @13,@09                                             0001 00021000
*   DO;                             /* ?IGFDERR INIT                 */ 00022000
*                                                                  0110 00023000
*     /***************************************************************/ 00024000
*     /*                                                             */ 00025000
*     /* IGFDERR - INITIALIZE RECOVERY ENVIRONMENT                   */ 00026000
*     /*                                                             */ 00027000
*     /***************************************************************/ 00028000
*                                                                  0111 00029000
*     DERPLIST=DERPLIST&&DERPLIST;  /* CLEAR PARAMETER LIST          */ 00030000
         XC    DERPLIST(48),DERPLIST                               0111 00031000
*     DERFUNK=DERINIT;              /* INDICATE INIT FUNCTION        */ 00032000
         MVI   DERFUNK,X'01'                                       0112 00033000
*     DERREC=ADDR(DERRECPM);        /* POINT TO REC PARMS            */ 00034000
         LA    @14,DERRECPM                                        0113 00035000
         ST    @14,DERREC                                          0113 00036000
*     DERRETRY=ADDR(IGFDV0R);       /* POINT TO RETRY ROUTINE        */ 00037000
         LA    @14,IGFDV0R                                         0114 00038000
         ST    @14,DERRETRY                                        0114 00039000
*     GEN SETS(DERDATD)(MVC DERDATD,@SIZDATD);/* SET UP SPN, SIZE    */ 00040000
         MVC DERDATD,@SIZDATD                                           00041000
*     DERPFX=DERRMASK;              /* SET UP RUB MASK               */ 00042000
         MVC   DERPFX(2),@CB00288                                  0116 00043000
*     DERRCODE=CODEBASE;            /* SAVE CODEREG                  */ 00044000
         ST    CODEBASE,DERRCODE                                   0117 00045000
*     DERRDATA=DATABASE;            /* SAVE DATAREG                  */ 00046000
         ST    DATABASE,DERRDATA                                   0118 00047000
*     DERRDDR=DDRPTR;               /* SAVE DDRCOM POINTER           */ 00048000
         ST    DDRPTR,DERRDDR                                      0119 00049000
*     DERRSAVE=SAVEPTR;             /* SAVE REGISTER 13              */ 00050000
         ST    SAVEPTR,DERRSAVE                                    0120 00051000
*     CALL IGFDE0(DERPLIST);        /* ISSUE ESTAE                   */ 00052000
         LA    @14,DERPLIST                                        0121 00053000
         ST    @14,@AL00001                                        0121 00054000
         L     @15,@CV00050                                        0121 00055000
         LA    @01,@AL00001                                        0121 00056000
         BALR  @14,@15                                             0121 00057000
*   END;                            /* ?IGFDERR INIT                 */ 00058000
*                                                                  0122 00059000
*   /*****************************************************************/ 00060000
*   /*                                                               */ 00061000
*   /* VALIDATE THE 'FROM' DEVICE                                    */ 00062000
*   /*                                                               */ 00063000
*   /*****************************************************************/ 00064000
*                                                                  0123 00065000
*   DDRINV2=DDRVFM;                 /* INDICATE 'FROM' VALIDATION    */ 00066000
         MVI   DDRINV2(DDRPTR),X'01'                               0123 00067000
*   CALL IGFDV0V;                   /* CALL PROPER VALIDATION ROUTINE*/ 00068000
         BAL   @14,IGFDV0V                                         0124 00069000
*   IF DERLRC^=VALID                /* IS 'FROM' VALID               */ 00070000
*     THEN                          /* NO, CANNOT SWAP THIS DEVICE   */ 00071000
         CLI   DERLRC,0                                            0125 00072000
         BE    @RF00125                                            0125 00073000
*     IF DERLRC=INVALID             /* IS DEVICE INVALID OR WAS THERE   00074000
*                                      A CATASTROPHIC ERROR          */ 00075000
*       THEN                        /* DEVICE IS INVALID             */ 00076000
*                                                                  0126 00077000
         CLI   DERLRC,4                                            0126 00078000
         BNE   @RF00126                                            0126 00079000
*       /*************************************************************/ 00080000
*       /*                                                           */ 00081000
*       /* IGF513I DEVICE DDD INVALID FOR SWAP - INVALID-CODE        */ 00082000
*       /*                                                           */ 00083000
*       /*************************************************************/ 00084000
*                                                                  0127 00085000
*       DO;                         /* ?IGFDMSG MSG(IGF513I)CODE(FROM   00086000
*                                      -CUA,INVALID-CODE)RETRY(2)    */ 00087000
*                                                                  0127 00088000
*         /***********************************************************/ 00089000
*         /*                                                         */ 00090000
*         /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE WRITER             */ 00091000
*         /*                                                         */ 00092000
*         /***********************************************************/ 00093000
*                                                                  0128 00094000
*         DDRMSGCD=DDRM513I;        /* SET UP MSG CODE               */ 00095000
         MVI   DDRMSGCD(DDRPTR),X'0A'                              0128 00096000
*         DDRMSGPN=2;               /* SET UP NO. OF SUBST. CODES    */ 00097000
         MVI   DDRMSGPN(DDRPTR),X'02'                              0129 00098000
*         DDRMSGPC(1)=DDRPFM;       /* SET SUBSTITUTION CODE 1       */ 00099000
         MVI   DDRMSGPC(DDRPTR),X'02'                              0130 00100000
*         DDRMSGPC(2)=DDRPIC;       /* SET SUBSTITUTION CODE 2       */ 00101000
         MVI   DDRMSGPC+1(DDRPTR),X'09'                            0131 00102000
*         RTNCODE=12;               /* INDICATE MESSAGE NOT DONE YET */ 00103000
         LA    RTNCODE,12                                          0132 00104000
*         DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP UNTIL MSG DONE*/ 00105000
         LA    @14,1                                               0133 00106000
         STC   @14,DDRRETRY(,DDRPTR)                               0133 00107000
@DL00133 C     RTNCODE,@CF00042                                    0133 00108000
         BNE   @DC00133                                            0133 00109000
*           CALL IGFDM0;            /* OUTPUT MESSAGE                */ 00110000
         L     @15,@CV00052                                        0134 00111000
         BALR  @14,@15                                             0134 00112000
*         END;                      /* END OF RETRY LOOP             */ 00113000
         LA    @14,1                                               0135 00114000
         SLR   @12,@12                                             0135 00115000
         IC    @12,DDRRETRY(,DDRPTR)                               0135 00116000
         ALR   @14,@12                                             0135 00117000
         STC   @14,DDRRETRY(,DDRPTR)                               0135 00118000
         C     @14,@CF00082                                        0135 00119000
         BNH   @DL00133                                            0135 00120000
@DC00133 DS    0H                                                  0136 00121000
*       END;                        /* ?IGFDMSG MSG(IGF513I)CODE(FROM   00122000
*                                      -CUA,INVALID-CODE)RETRY(2)    */ 00123000
*     ELSE                                                         0137 00124000
*       ;                           /* CATASTROPHIC ERROR - NO MSG   */ 00125000
@RF00126 DS    0H                                                  0138 00126000
*   ELSE                            /* 'FROM' DEVICE IS VALID        */ 00127000
*     DO;                           /* CONTINUE PROCESSING           */ 00128000
         B     @RC00125                                            0138 00129000
@RF00125 DS    0H                                                  0139 00130000
*       IF DDRFIRST='0'B THEN       /* IS THIS THE FIRST PASS FOR  0139 00131000
*                                      THIS SWAP REQUEST             */ 00132000
         TM    DDRFIRST(DDRPTR),B'00000001'                        0139 00133000
         BNZ   @RF00139                                            0139 00134000
*         DO;                       /* YES, MAY HAVE A 'TO' DEVICE   */ 00135000
*           DDRFIRST='1'B;          /* INDICATE NOT FIRST PASS       */ 00136000
         OI    DDRFIRST(DDRPTR),B'00000001'                        0141 00137000
*           IF DDRSYS='1'B THEN     /* IS THIS A SYSTEM SWAP         */ 00138000
         TM    DDRSYS(DDRPTR),B'01000000'                          0142 00139000
         BNO   @RF00142                                            0142 00140000
*             DO;                   /* YES,MUST LOOK UP A SUITABLE 0143 00141000
*                                      'TO' DEVICE                   */ 00142000
*               CALL IGFDL1;        /* TRY TO FIND A COMPATIBLE    0144 00143000
*                                      DEVICE TO SWAP TO             */ 00144000
         L     @15,@CV00051                                        0144 00145000
         BALR  @14,@15                                             0144 00146000
*               IF RTNCODE^=VALID THEN/* WAS A SUITABLE DEVICE FOUND */ 00147000
         SLR   @14,@14                                             0145 00148000
         CR    RTNCODE,@14                                         0145 00149000
         BE    @RF00145                                            0145 00150000
*                 DO;               /* NO, MUST REQUEST DEVICE       */ 00151000
*                   DDRTOUCB=0;     /* INDICATE NO 'TO' UCB FOUND    */ 00152000
         ST    @14,DDRTOUCB(,DDRPTR)                               0147 00153000
*                   DDRTOCUA=0;     /* INDICATE NO 'TO' DEVICE FOUND */ 00154000
         STCM  @14,7,DDRTOCUA(DDRPTR)                              0148 00155000
*                 END;                                             0149 00156000
*               DDRTER1=0;          /* IGNORE ERRORS IN IGFDL1       */ 00157000
@RF00145 MVI   DDRTER1(DDRPTR),X'00'                               0150 00158000
*             END;                                                 0151 00159000
*           ELSE                    /* FIRST PASS OPERATOR SWAP      */ 00160000
*             DO;                   /* YES, MUST VALIDATE THE      0152 00161000
*                                      SPECIFIED 'TO' DEVICE         */ 00162000
         B     @RC00142                                            0152 00163000
@RF00142 DS    0H                                                  0153 00164000
*               DDRINV2=DDRVCM;     /* INDICATE 'TO' VALIDATION      */ 00165000
         MVI   DDRINV2(DDRPTR),X'02'                               0153 00166000
*               CALL IGFDV0V;       /* CALL THE PROPER VALIDATION RTN*/ 00167000
         BAL   @14,IGFDV0V                                         0154 00168000
*               IF DERLRC^=VALID THEN/* IS 'TO' DEVICE VALID         */ 00169000
         CLI   DERLRC,0                                            0155 00170000
         BE    @RF00155                                            0155 00171000
*                 DO;               /* NO, CANNOT USE IT             */ 00172000
*                   IF DERLRC=INVALID/* IS THE DEVICE INVALID        */ 00173000
*                     THEN          /* YES, DIAGNOSE THE PROBLEM     */ 00174000
*                                                                  0157 00175000
         CLI   DERLRC,4                                            0157 00176000
         BNE   @RF00157                                            0157 00177000
*                     /***********************************************/ 00178000
*                     /*                                             */ 00179000
*                     /* IGF513I DEVICE DDD INVALID FOR SWAP -       */ 00180000
*                     /* INV-CODE                                    */ 00181000
*                     /*                                             */ 00182000
*                     /***********************************************/ 00183000
*                                                                  0158 00184000
*                     DO;           /* ?IGFDMSG MSG(IGF513I)CODE(TO-C   00185000
*                                      UA,INVALID-CODE)RETRY(2)      */ 00186000
*                                                                  0158 00187000
*                       /*********************************************/ 00188000
*                       /*                                           */ 00189000
*                       /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE      */ 00190000
*                       /* WRITER                                    */ 00191000
*                       /*                                           */ 00192000
*                       /*********************************************/ 00193000
*                                                                  0159 00194000
*                       DDRMSGCD=DDRM513I;/* SET UP MSG CODE         */ 00195000
         MVI   DDRMSGCD(DDRPTR),X'0A'                              0159 00196000
*                       DDRMSGPN=2; /* SET UP NO. OF SUBST. CODES    */ 00197000
         MVI   DDRMSGPN(DDRPTR),X'02'                              0160 00198000
*                       DDRMSGPC(1)=DDRPTO;/* SET SUBSTITUTION CODE 1*/ 00199000
         MVI   DDRMSGPC(DDRPTR),X'03'                              0161 00200000
*                       DDRMSGPC(2)=DDRPIC;/* SET SUBSTITUTION CODE 2*/ 00201000
         MVI   DDRMSGPC+1(DDRPTR),X'09'                            0162 00202000
*                       RTNCODE=12; /* INDICATE MESSAGE NOT DONE YET */ 00203000
         LA    RTNCODE,12                                          0163 00204000
*                       DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP    00205000
*                                      UNTIL MSG DONE                */ 00206000
         LA    @14,1                                               0164 00207000
         STC   @14,DDRRETRY(,DDRPTR)                               0164 00208000
@DL00164 C     RTNCODE,@CF00042                                    0164 00209000
         BNE   @DC00164                                            0164 00210000
*                         CALL IGFDM0;/* OUTPUT MESSAGE              */ 00211000
         L     @15,@CV00052                                        0165 00212000
         BALR  @14,@15                                             0165 00213000
*                       END;        /* END OF RETRY LOOP             */ 00214000
         LA    @14,1                                               0166 00215000
         SLR   @12,@12                                             0166 00216000
         IC    @12,DDRRETRY(,DDRPTR)                               0166 00217000
         ALR   @14,@12                                             0166 00218000
         STC   @14,DDRRETRY(,DDRPTR)                               0166 00219000
         C     @14,@CF00082                                        0166 00220000
         BNH   @DL00164                                            0166 00221000
@DC00164 DS    0H                                                  0167 00222000
*                     END;          /* ?IGFDMSG MSG(IGF513I)CODE(TO-C   00223000
*                                      UA,INVALID-CODE)RETRY(2)      */ 00224000
*                   DDRTER1=0;      /* IGNORE ERROR CODE             */ 00225000
@RF00157 MVI   DDRTER1(DDRPTR),X'00'                               0168 00226000
*                   DDRTOUCB=0;     /* INDICATE NO 'TO' DEVICE FOUND */ 00227000
         SLR   @14,@14                                             0169 00228000
         ST    @14,DDRTOUCB(,DDRPTR)                               0169 00229000
*                 END;                                             0170 00230000
*             END;                                                 0171 00231000
@RF00155 DS    0H                                                  0172 00232000
*         END;                                                     0172 00233000
*                                                                  0172 00234000
@RC00142 DS    0H                                                  0173 00235000
*       /*************************************************************/ 00236000
*       /*                                                           */ 00237000
*       /* ISSUE THE PROPER SWAP MESSAGE AND ANALYZE OPERATOR REPLY  */ 00238000
*       /*                                                           */ 00239000
*       /*************************************************************/ 00240000
*                                                                  0173 00241000
*       CALL IGFDV03;               /* ISSUE MESSAGE                 */ 00242000
@RF00139 BAL   @14,IGFDV03                                         0173 00243000
*       IF DERLRC=VALID THEN        /* DID OPERATOR CANCEL SWAP      */ 00244000
         CLI   DERLRC,0                                            0174 00245000
         BNE   @RF00174                                            0174 00246000
*         DO;                       /* NO, CONTINUE SWAP             */ 00247000
*                                                                  0175 00248000
*           /*********************************************************/ 00249000
*           /*                                                       */ 00250000
*           /* RECORD THE CONTENTS OF THE BUFFERED LOGS IF APPLICABLE*/ 00251000
*           /*                                                       */ 00252000
*           /*********************************************************/ 00253000
*                                                                  0176 00254000
*           IF DDRDA='1'B&DDRBUFL='1'B THEN/* DOES THE SWAP INVOLVE     00255000
*                                      DIRECT ACCESS DEVICES WITH  0176 00256000
*                                      BUFFERED LOGS                 */ 00257000
         TM    DDRDA(DDRPTR),B'11000000'                           0176 00258000
         BNO   @RF00176                                            0176 00259000
*             DO;                   /* YES, RECORD LOGS              */ 00260000
*               DDRREC1=DDRRBLF;    /* INDICATE RECORD BUFFERED LOG  */ 00261000
         MVI   DDRREC1(DDRPTR),X'03'                               0178 00262000
*               DDRRFMTO='1'B;      /* INDICATE 'FROM' DEVICE        */ 00263000
         OI    DDRRFMTO(DDRPTR),B'10000000'                        0179 00264000
*               CALL IGFDR0;        /* RECORD LOG OF 'FROM' DEVICE   */ 00265000
         L     @15,@CV00054                                        0180 00266000
         BALR  @14,@15                                             0180 00267000
*               DDRRFMTO='0'B;      /* INDICATE 'TO' DEVICE          */ 00268000
         NI    DDRRFMTO(DDRPTR),B'01111111'                        0181 00269000
*               IF DDRFMUCB^=DDRTOUCB/* IS ONLY ONE DEVICE INVOLVED     00270000
*                                      IN THE SWAP                   */ 00271000
*                 THEN              /* NO, RECORD BOTH LOGS          */ 00272000
         CLC   DDRFMUCB(4,DDRPTR),DDRTOUCB(DDRPTR)                 0182 00273000
         BE    @RF00182                                            0182 00274000
*                 CALL IGFDR0;      /* RECORD LOG OF 'TO' DEVICE     */ 00275000
         L     @15,@CV00054                                        0183 00276000
         BALR  @14,@15                                             0183 00277000
*               DDRTER1=0;          /* IGNORE RECORDING ERRORS       */ 00278000
@RF00182 MVI   DDRTER1(DDRPTR),X'00'                               0184 00279000
*             END;                                                 0185 00280000
*                                                                  0185 00281000
*           /*********************************************************/ 00282000
*           /*                                                       */ 00283000
*           /* GAIN CONTROL OF THE 'FROM' AND 'TO' DEVICES           */ 00284000
*           /*                                                       */ 00285000
*           /*********************************************************/ 00286000
*                                                                  0186 00287000
*           IF DDRMT='1'B THEN      /* IS THIS A TAPE DEVICE         */ 00288000
@RF00176 TM    DDRMT(DDRPTR),B'00100000'                           0186 00289000
         BNO   @RF00186                                            0186 00290000
*             DDRIOF1=DDRRUN;       /* YES, INDICATE REWIND/UNLOAD   */ 00291000
         MVI   DDRIOF1(DDRPTR),X'0F'                               0187 00292000
*           ELSE                    /* NO, NOT TAPE SWAP             */ 00293000
*             DDRIOF1=DDRNOP;       /* INDICATE NOP TO DEVICE        */ 00294000
         B     @RC00186                                            0188 00295000
@RF00186 MVI   DDRIOF1(DDRPTR),X'03'                               0188 00296000
*           DDRIOF2=0;              /* CLEAR FLAG BYTE               */ 00297000
@RC00186 MVI   DDRIOF2(DDRPTR),X'00'                               0189 00298000
*           DDRITAKE='1'B;          /* INDICATE TAKE CONTROL OF DEVC */ 00299000
*           DDRWHICH='1'B;          /* INDICATE 'FROM' DEVICE        */ 00300000
         OI    DDRITAKE(DDRPTR),B'11000000'                        0191 00301000
*           CALL IGFDM1;            /* CONTROL THE 'FROM' DEVICE     */ 00302000
         L     @15,@CV00053                                        0192 00303000
         BALR  @14,@15                                             0192 00304000
*           IF RTNCODE^=VALID THEN  /* WAS DEVICE CONTROLLED OK      */ 00305000
         LTR   RTNCODE,RTNCODE                                     0193 00306000
         BZ    @RF00193                                            0193 00307000
*             DERLRC=RTNCODE;       /* NO, INDICATE ERROR CODE       */ 00308000
         STC   RTNCODE,DERLRC                                      0194 00309000
*           ELSE                    /* YES, CONTINUE WITH SWAP       */ 00310000
*             DO;                                                  0195 00311000
         B     @RC00193                                            0195 00312000
@RF00193 DS    0H                                                  0196 00313000
*               DDRWHICH='0'B;      /* INDICATE 'TO' DEVICE          */ 00314000
         NI    DDRWHICH(DDRPTR),B'01111111'                        0196 00315000
*               CALL IGFDM1;        /* CONTROL THE 'TO' DEVICE       */ 00316000
         L     @15,@CV00053                                        0197 00317000
         BALR  @14,@15                                             0197 00318000
*               IF RTNCODE^=VALID THEN/* WAS DEVICE CONTROLLED OK    */ 00319000
         LTR   RTNCODE,RTNCODE                                     0198 00320000
         BZ    @RF00198                                            0198 00321000
*                 DERLRC=RTNCODE;   /* NO, INDICATE ERROR CODE       */ 00322000
         STC   RTNCODE,DERLRC                                      0199 00323000
*               ELSE                /* YES, CONTINUE WITH SWAP       */ 00324000
*                 DO;                                              0200 00325000
*                                                                  0200 00326000
         B     @RC00198                                            0200 00327000
@RF00198 DS    0H                                                  0201 00328000
*                   /*************************************************/ 00329000
*                   /*                                               */ 00330000
*                   /* RECORD THE VOLUME DISMOUNT RECORD IF THIS IS A*/ 00331000
*                   /* TAPE SWAP                                     */ 00332000
*                   /*                                               */ 00333000
*                   /*************************************************/ 00334000
*                                                                  0201 00335000
*                   IF DDRMT='1'B THEN/* IS THIS A TAPE SWAP         */ 00336000
         TM    DDRMT(DDRPTR),B'00100000'                           0201 00337000
         BNO   @RF00201                                            0201 00338000
*                     DO;           /* YES, RECORD DISMOUNT          */ 00339000
*                       DDRREC1=DDRR91;/* INDICATE VOLUME DISMOUNT 0203 00340000
*                                      RECORD REQUEST                */ 00341000
         MVI   DDRREC1(DDRPTR),X'02'                               0203 00342000
*                       CALL IGFDR0;/* PERFORM RECORDING             */ 00343000
         L     @15,@CV00054                                        0204 00344000
         BALR  @14,@15                                             0204 00345000
*                       DDRTER1=0;  /* IGNORE RECORDING ERRORS       */ 00346000
         MVI   DDRTER1(DDRPTR),X'00'                               0205 00347000
*                     END;                                         0206 00348000
*                                                                  0206 00349000
*                   /*************************************************/ 00350000
*                   /*                                               */ 00351000
*                   /* SWAP THE UCBS FOR THE 'FROM' AND 'TO' DEVICES */ 00352000
*                   /*                                               */ 00353000
*                   /*************************************************/ 00354000
*                                                                  0207 00355000
*                   CALL IGFDW0;    /* SWAP THE UCBS                 */ 00356000
@RF00201 L     @15,@CV00057                                        0207 00357000
         BALR  @14,@15                                             0207 00358000
*                   DERLRC=RTNCODE; /* COPY RETURN CODE              */ 00359000
         STC   RTNCODE,DERLRC                                      0208 00360000
*                 END;                                             0209 00361000
*             END;                                                 0210 00362000
@RC00198 DS    0H                                                  0211 00363000
*         END;                                                     0211 00364000
@RC00193 DS    0H                                                  0212 00365000
*     END;                                                         0212 00366000
@RF00174 DS    0H                                                  0213 00367000
*IGFDV0R:                           /* ESTAE RETRY ENTRY POINT       */ 00368000
*   DO;                             /* ?IGFDERR CANCEL               */ 00369000
*                                                                  0213 00370000
@RC00125 DS    0H                                                  0213 00371000
IGFDV0R  DS    0H                                                  0214 00372000
*     /***************************************************************/ 00373000
*     /*                                                             */ 00374000
*     /* IGFDERR - CANCEL RECOVERY ENVIRONMENT                       */ 00375000
*     /*                                                             */ 00376000
*     /***************************************************************/ 00377000
*                                                                  0214 00378000
*     DERFUNK=DERCANC;              /* INDICATE CANCEL               */ 00379000
         MVI   DERFUNK,X'02'                                       0214 00380000
*     CALL IGFDE0(DERPLIST);        /* CANCEL ESTAE                  */ 00381000
         LA    @14,DERPLIST                                        0215 00382000
         ST    @14,@AL00001                                        0215 00383000
         L     @15,@CV00050                                        0215 00384000
         LA    @01,@AL00001                                        0215 00385000
         BALR  @14,@15                                             0215 00386000
*   END;                            /* ?IGFDERR CANCEL               */ 00387000
*   RETURN CODE(DERLRC);            /* RETURN TO CALLER              */ 00388000
         SLR   @12,@12                                             0217 00389000
         IC    @12,DERLRC                                          0217 00390000
         L     @13,4(,@13)                                         0217 00391000
         L     @00,@SIZDATD                                        0217 00392000
         LR    @01,@09                                             0217 00393000
         FREEMAIN R,LV=(0),A=(1)                                        00394000
         LR    @15,@12                                             0217 00395000
         L     @14,12(,@13)                                        0217 00396000
         LM    @00,@12,20(@13)                                     0217 00397000
         BR    @14                                                 0217 00398000
*   GENERATE NOREFS NOSETS(EJECT);                                 0218 00399000
*                                                                  0218 00400000
         EJECT                                                          00401000
*   /*****************************************************************/ 00402000
*   /*                                                               */ 00403000
*   /* SUBROUTINE IGFDV03 - REPEATEDLY ASK THE OPERATOR FOR A 'TO'   */ 00404000
*   /* DEVICE UNTIL HE CANCELS THE SWAP REQUEST OR REPLIES WITH THE  */ 00405000
*   /* ADDRESS OF AN ACCEPTABLE DEVICE                               */ 00406000
*   /*                                                               */ 00407000
*   /*****************************************************************/ 00408000
*                                                                  0219 00409000
*IGFDV03:                           /* SUBROUTINE ENTRY POINT        */ 00410000
*   PROCEDURE;                                                     0219 00411000
         B     @PB00002                                            0219 00412000
IGFDV03  STM   @14,@12,@SA00002                                    0219 00413000
*   CONTROL='1'B;                   /* INDICATE DEVICE NOT ACCEPTED     00414000
*                                      YET                           */ 00415000
*                                                                  0220 00416000
         OI    CONTROL,B'10000000'                                 0220 00417000
*   /*****************************************************************/ 00418000
*   /*                                                               */ 00419000
*   /* LOOP UNTIL A DEVICE IS ACCEPTED OR THE SWAP IS CANCELLED      */ 00420000
*   /*                                                               */ 00421000
*   /*****************************************************************/ 00422000
*                                                                  0221 00423000
*   DO WHILE(CONTROL='1'B);                                        0221 00424000
         B     @DE00221                                            0221 00425000
@DL00221 DS    0H                                                  0222 00426000
*     CALL IGFDV02;                 /* ISSUE SWAP MESSAGE AND ANALYZE   00427000
*                                      REPLY                         */ 00428000
         BAL   @14,IGFDV02                                         0222 00429000
*     IF DERLRC^=VALID THEN         /* SHOULD SWAP BE TERMINATED     */ 00430000
         CLI   DERLRC,0                                            0223 00431000
         BE    @RF00223                                            0223 00432000
*       CONTROL='0'B;               /* YES, TERMINATE LOOP           */ 00433000
         NI    CONTROL,B'01111111'                                 0224 00434000
*     ELSE                          /* NO, CONTINUE PROCESSING       */ 00435000
*       DO;                                                        0225 00436000
         B     @RC00223                                            0225 00437000
@RF00223 DS    0H                                                  0226 00438000
*         DDRINV2=DDRVUS;           /* INDICATE USER VALIDATION      */ 00439000
         MVI   DDRINV2(DDRPTR),X'03'                               0226 00440000
*         CALL IGFDV0V;             /* INSURE THAT THE USER IS STILL    00441000
*                                      IN THE SYSTEM                 */ 00442000
         BAL   @14,IGFDV0V                                         0227 00443000
*         IF DERLRC^=VALID THEN     /* HAS USER GONE AWAY            */ 00444000
         CLI   DERLRC,0                                            0228 00445000
         BE    @RF00228                                            0228 00446000
*           DO;                     /* YES, TERMINATE SWAP           */ 00447000
*             DDRTER1=DDRTNF;       /* INDICATE NO USER FOUND        */ 00448000
         MVI   DDRTER1(DDRPTR),X'01'                               0230 00449000
*             CONTROL='0'B;         /* TERMINATE LOOP                */ 00450000
         NI    CONTROL,B'01111111'                                 0231 00451000
*           END;                                                   0232 00452000
*         ELSE                      /* NO, CONTINUE SWAP             */ 00453000
*           DO;                                                    0233 00454000
*                                                                  0233 00455000
         B     @RC00228                                            0233 00456000
@RF00228 DS    0H                                                  0234 00457000
*             /*******************************************************/ 00458000
*             /*                                                     */ 00459000
*             /* VALIDATE THE 'TO' DEVICE AND ITS COMPATIBILITY WITH */ 00460000
*             /* THE 'FROM' DEVICE                                   */ 00461000
*             /*                                                     */ 00462000
*             /*******************************************************/ 00463000
*                                                                  0234 00464000
*             DDRINV2=DDRVCM;       /* INDICATE 'TO' VALIDATION      */ 00465000
         MVI   DDRINV2(DDRPTR),X'02'                               0234 00466000
*             CALL IGFDV0V;         /* VALIDATE 'TO' DEVICE          */ 00467000
         BAL   @14,IGFDV0V                                         0235 00468000
*             IF DERLRC=VALID THEN  /* IS 'TO' DEVICE VALID          */ 00469000
         CLI   DERLRC,0                                            0236 00470000
         BNE   @RF00236                                            0236 00471000
*               CONTROL='0'B;       /* YES, TERMINATE LOOP WITH VALID   00472000
*                                      DEVICE SPECIFIED              */ 00473000
         NI    CONTROL,B'01111111'                                 0237 00474000
*             ELSE                  /* NO, DIAGNOSE THE PROBLEM      */ 00475000
*               DO;                                                0238 00476000
         B     @RC00236                                            0238 00477000
@RF00236 DS    0H                                                  0239 00478000
*                 DDRTOUCB=0;       /* INDICATE NO 'TO' DEVICE FOUND    00479000
*                                      YET                           */ 00480000
         SLR   @14,@14                                             0239 00481000
         ST    @14,DDRTOUCB(,DDRPTR)                               0239 00482000
*                 IF DERLRC^=INVALID THEN/* WAS IT A DEVICE ERROR    */ 00483000
         CLI   DERLRC,4                                            0240 00484000
         BE    @RF00240                                            0240 00485000
*                   CONTROL='0'B;   /* NO, TERMINATE SWAP            */ 00486000
         NI    CONTROL,B'01111111'                                 0241 00487000
*                 ELSE              /* YES, CONTINUE                 */ 00488000
*                   DO;             /* REPORT DEVICE ERROR           */ 00489000
*                                                                  0242 00490000
         B     @RC00240                                            0242 00491000
@RF00240 DS    0H                                                  0243 00492000
*                     /***********************************************/ 00493000
*                     /*                                             */ 00494000
*                     /* IGF513I DEVICE DDD INVALID FOR SWAP -       */ 00495000
*                     /* INVALID-CODE                                */ 00496000
*                     /*                                             */ 00497000
*                     /***********************************************/ 00498000
*                                                                  0243 00499000
*                     DO;           /* ?IGFDMSG MSG(IGF513I)CODE(TO-C   00500000
*                                      UA,INVALID-CODE)RETRY(2)      */ 00501000
*                                                                  0243 00502000
*                       /*********************************************/ 00503000
*                       /*                                           */ 00504000
*                       /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE      */ 00505000
*                       /* WRITER                                    */ 00506000
*                       /*                                           */ 00507000
*                       /*********************************************/ 00508000
*                                                                  0244 00509000
*                       DDRMSGCD=DDRM513I;/* SET UP MSG CODE         */ 00510000
         MVI   DDRMSGCD(DDRPTR),X'0A'                              0244 00511000
*                       DDRMSGPN=2; /* SET UP NO. OF SUBST. CODES    */ 00512000
         MVI   DDRMSGPN(DDRPTR),X'02'                              0245 00513000
*                       DDRMSGPC(1)=DDRPTO;/* SET SUBSTITUTION CODE 1*/ 00514000
         MVI   DDRMSGPC(DDRPTR),X'03'                              0246 00515000
*                       DDRMSGPC(2)=DDRPIC;/* SET SUBSTITUTION CODE 2*/ 00516000
         MVI   DDRMSGPC+1(DDRPTR),X'09'                            0247 00517000
*                       RTNCODE=12; /* INDICATE MESSAGE NOT DONE YET */ 00518000
         LA    RTNCODE,12                                          0248 00519000
*                       DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP    00520000
*                                      UNTIL MSG DONE                */ 00521000
         LA    @14,1                                               0249 00522000
         STC   @14,DDRRETRY(,DDRPTR)                               0249 00523000
@DL00249 C     RTNCODE,@CF00042                                    0249 00524000
         BNE   @DC00249                                            0249 00525000
*                         CALL IGFDM0;/* OUTPUT MESSAGE              */ 00526000
         L     @15,@CV00052                                        0250 00527000
         BALR  @14,@15                                             0250 00528000
*                       END;        /* END OF RETRY LOOP             */ 00529000
         LA    @14,1                                               0251 00530000
         SLR   @12,@12                                             0251 00531000
         IC    @12,DDRRETRY(,DDRPTR)                               0251 00532000
         ALR   @14,@12                                             0251 00533000
         STC   @14,DDRRETRY(,DDRPTR)                               0251 00534000
         C     @14,@CF00082                                        0251 00535000
         BNH   @DL00249                                            0251 00536000
@DC00249 DS    0H                                                  0252 00537000
*                     END;          /* ?IGFDMSG MSG(IGF513I)CODE(TO-C   00538000
*                                      UA,INVALID-CODE)RETRY(2)      */ 00539000
*                     DDRTER1=0;    /* IGNORE ERRORS IN IGFDM0       */ 00540000
         MVI   DDRTER1(DDRPTR),X'00'                               0253 00541000
*                   END;                                           0254 00542000
*               END;                                               0255 00543000
@RC00240 DS    0H                                                  0256 00544000
*           END;                                                   0256 00545000
@RC00236 DS    0H                                                  0257 00546000
*       END;                                                       0257 00547000
@RC00228 DS    0H                                                  0258 00548000
*   END;                            /* END OF PROMPTING LOOP         */ 00549000
@RC00223 DS    0H                                                  0258 00550000
@DE00221 TM    CONTROL,B'10000000'                                 0258 00551000
         BO    @DL00221                                            0258 00552000
*   RETURN;                         /* RETURN TO CALLER              */ 00553000
@EL00002 DS    0H                                                  0259 00554000
@EF00002 DS    0H                                                  0259 00555000
@ER00002 LM    @14,@12,@SA00002                                    0259 00556000
         BR    @14                                                 0259 00557000
*   END IGFDV03;                    /* END OF INTERNAL PROCEDURE     */ 00558000
@PB00002 DS    0H                                                  0261 00559000
*   GENERATE NOREFS NOSETS(EJECT);                                 0261 00560000
*                                                                  0261 00561000
         EJECT                                                          00562000
*   /*****************************************************************/ 00563000
*   /*                                                               */ 00564000
*   /* SUBROUTINE IGFDV02 - OUTPUT THE PROPER SWAP MESSAGES AND      */ 00565000
*   /* ANALYZE THE REPLY FROM THE OPERATOR                           */ 00566000
*   /*                                                               */ 00567000
*   /*****************************************************************/ 00568000
*                                                                  0262 00569000
*IGFDV02:                           /* SUBROUTINE ENTRY POINT        */ 00570000
*   PROCEDURE;                                                     0262 00571000
*                                                                  0262 00572000
         B     @PB00003                                            0262 00573000
IGFDV02  STM   @14,@12,@SA00003                                    0262 00574000
*   /*****************************************************************/ 00575000
*   /*                                                               */ 00576000
*   /* IF THE 'FROM' DEVICE IS A SHARED DASD DEVICE, THE 'TO' DEVICE */ 00577000
*   /* MUST BE THE SAME AS THE 'FROM' DEVICE                         */ 00578000
*   /*                                                               */ 00579000
*   /*****************************************************************/ 00580000
*                                                                  0263 00581000
*   IF DDRDA='1'B&UCBRR='1'B THEN   /* IS THE 'FROM' SHARED DASD   0263 00582000
*                                      YM02576                       */ 00583000
         TM    DDRDA(DDRPTR),B'01000000'                           0263 00584000
         BNO   @RF00263                                            0263 00585000
         L     @14,UCBPTR(,DDRPTR)                                 0263 00586000
         TM    UCBRR(@14),B'00100000'                              0263 00587000
         BNO   @RF00263                                            0263 00588000
*     DO;                           /* YES, FORCE SWAP TO ITSELF     */ 00589000
*       DDRTOCUA=DDRFMCUA;          /* SET CUAS EQUAL                */ 00590000
         MVC   DDRTOCUA(3,DDRPTR),DDRFMCUA(DDRPTR)                 0265 00591000
*       DDRTOUCB=DDRFMUCB;          /* POINT TO SAME UCB             */ 00592000
         L     @14,DDRFMUCB(,DDRPTR)                               0266 00593000
         ST    @14,DDRTOUCB(,DDRPTR)                               0266 00594000
*     END;                                                         0267 00595000
*                                                                  0267 00596000
*   /*****************************************************************/ 00597000
*   /*                                                               */ 00598000
*   /* OUTPUT THE FIRST OF THE PROPER PAIR OF MESSAGES               */ 00599000
*   /*                                                               */ 00600000
*   /*****************************************************************/ 00601000
*                                                                  0268 00602000
*   IF DDRTOUCB=0                   /* IS THERE A 'TO' DEVICE        */ 00603000
*     THEN                          /* NO, ASK FOR 'TO' DEVICE       */ 00604000
*                                                                  0268 00605000
@RF00263 L     @14,DDRTOUCB(,DDRPTR)                               0268 00606000
         LTR   @14,@14                                             0268 00607000
         BNZ   @RF00268                                            0268 00608000
*     /***************************************************************/ 00609000
*     /*                                                             */ 00610000
*     /* IGF509I SWAP XXX - REASON-CODE                              */ 00611000
*     /*                                                             */ 00612000
*     /***************************************************************/ 00613000
*                                                                  0269 00614000
*     DO;                           /* ?IGFDMSG MSG(IGF509I)CODE(FROM   00615000
*                                      -CUA,REASON)RETRY(2)          */ 00616000
*                                                                  0269 00617000
*       /*************************************************************/ 00618000
*       /*                                                           */ 00619000
*       /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE WRITER               */ 00620000
*       /*                                                           */ 00621000
*       /*************************************************************/ 00622000
*                                                                  0270 00623000
*       DDRMSGCD=DDRM509I;          /* SET UP MSG CODE               */ 00624000
         MVI   DDRMSGCD(DDRPTR),X'06'                              0270 00625000
*       DDRMSGPN=2;                 /* SET UP NO. OF SUBST. CODES    */ 00626000
         MVI   DDRMSGPN(DDRPTR),X'02'                              0271 00627000
*       DDRMSGPC(1)=DDRPFM;         /* SET SUBSTITUTION CODE 1       */ 00628000
         MVI   DDRMSGPC(DDRPTR),X'02'                              0272 00629000
*       DDRMSGPC(2)=DDRPRC;         /* SET SUBSTITUTION CODE 2       */ 00630000
         MVI   DDRMSGPC+1(DDRPTR),X'0B'                            0273 00631000
*       RTNCODE=12;                 /* INDICATE MESSAGE NOT DONE YET */ 00632000
         LA    RTNCODE,12                                          0274 00633000
*       DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP UNTIL MSG DONE  */ 00634000
         LA    @14,1                                               0275 00635000
         STC   @14,DDRRETRY(,DDRPTR)                               0275 00636000
@DL00275 C     RTNCODE,@CF00042                                    0275 00637000
         BNE   @DC00275                                            0275 00638000
*         CALL IGFDM0;              /* OUTPUT MESSAGE                */ 00639000
         L     @15,@CV00052                                        0276 00640000
         BALR  @14,@15                                             0276 00641000
*       END;                        /* END OF RETRY LOOP             */ 00642000
         LA    @14,1                                               0277 00643000
         SLR   @12,@12                                             0277 00644000
         IC    @12,DDRRETRY(,DDRPTR)                               0277 00645000
         ALR   @14,@12                                             0277 00646000
         STC   @14,DDRRETRY(,DDRPTR)                               0277 00647000
         C     @14,@CF00082                                        0277 00648000
         BNH   @DL00275                                            0277 00649000
@DC00275 DS    0H                                                  0278 00650000
*     END;                          /* ?IGFDMSG MSG(IGF509I)CODE(FROM   00651000
*                                      -CUA,REASON)RETRY(2)          */ 00652000
*   ELSE                            /* YES, MAY HAVE GOOD DEVICE     */ 00653000
*                                                                  0279 00654000
*     /***************************************************************/ 00655000
*     /*                                                             */ 00656000
*     /* IGF500I SWAP XXX TO YYY - REASON-CODE                       */ 00657000
*     /*                                                             */ 00658000
*     /***************************************************************/ 00659000
*                                                                  0279 00660000
*     DO;                           /* ?IGFDMSG MSG(IGF500I)CODE(FROM   00661000
*                                      -CUA,TO-CUA,REASON)RETRY(2)   */ 00662000
*                                                                  0279 00663000
         B     @RC00268                                            0279 00664000
@RF00268 DS    0H                                                  0280 00665000
*       /*************************************************************/ 00666000
*       /*                                                           */ 00667000
*       /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE WRITER               */ 00668000
*       /*                                                           */ 00669000
*       /*************************************************************/ 00670000
*                                                                  0280 00671000
*       DDRMSGCD=DDRM500I;          /* SET UP MSG CODE               */ 00672000
         MVI   DDRMSGCD(DDRPTR),X'01'                              0280 00673000
*       DDRMSGPN=3;                 /* SET UP NO. OF SUBST. CODES    */ 00674000
         MVI   DDRMSGPN(DDRPTR),X'03'                              0281 00675000
*       DDRMSGPC(1)=DDRPFM;         /* SET SUBSTITUTION CODE 1       */ 00676000
         MVI   DDRMSGPC(DDRPTR),X'02'                              0282 00677000
*       DDRMSGPC(2)=DDRPTO;         /* SET SUBSTITUTION CODE 2       */ 00678000
         MVI   DDRMSGPC+1(DDRPTR),X'03'                            0283 00679000
*       DDRMSGPC(3)=DDRPRC;         /* SET SUBSTITUTION CODE 3       */ 00680000
         MVI   DDRMSGPC+2(DDRPTR),X'0B'                            0284 00681000
*       RTNCODE=12;                 /* INDICATE MESSAGE NOT DONE YET */ 00682000
         LA    RTNCODE,12                                          0285 00683000
*       DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP UNTIL MSG DONE  */ 00684000
         LA    @14,1                                               0286 00685000
         STC   @14,DDRRETRY(,DDRPTR)                               0286 00686000
@DL00286 C     RTNCODE,@CF00042                                    0286 00687000
         BNE   @DC00286                                            0286 00688000
*         CALL IGFDM0;              /* OUTPUT MESSAGE                */ 00689000
         L     @15,@CV00052                                        0287 00690000
         BALR  @14,@15                                             0287 00691000
*       END;                        /* END OF RETRY LOOP             */ 00692000
         LA    @14,1                                               0288 00693000
         SLR   @12,@12                                             0288 00694000
         IC    @12,DDRRETRY(,DDRPTR)                               0288 00695000
         ALR   @14,@12                                             0288 00696000
         STC   @14,DDRRETRY(,DDRPTR)                               0288 00697000
         C     @14,@CF00082                                        0288 00698000
         BNH   @DL00286                                            0288 00699000
@DC00286 DS    0H                                                  0289 00700000
*     END;                          /* ?IGFDMSG MSG(IGF500I)CODE(FROM   00701000
*                                      -CUA,TO-CUA,REASON)RETRY(2)   */ 00702000
*   IF RTNCODE^=VALID THEN          /* WAS MESSAGE WRITTEN           */ 00703000
@RC00268 LTR   RTNCODE,RTNCODE                                     0290 00704000
         BZ    @RF00290                                            0290 00705000
*     DERLRC=RTNCODE;               /* NO, COPY ERROR CODE           */ 00706000
         STC   RTNCODE,DERLRC                                      0291 00707000
*   ELSE                            /* YES, CONTINUE PROCESSING      */ 00708000
*     DO;                                                          0292 00709000
*                                                                  0292 00710000
         B     @RC00290                                            0292 00711000
@RF00290 DS    0H                                                  0293 00712000
*       /*************************************************************/ 00713000
*       /*                                                           */ 00714000
*       /* IF DASD CAUTION OPERATOR ABOUT HEAD CRASHES       @OZ12139*/ 00715000
*       /*                                                           */ 00716000
*       /*************************************************************/ 00717000
*                                                                  0293 00718000
*       IF DDRDA='1'B&              /* IF DASD AND           @OZ12139*/ 00719000
*           (DDRPAGE='1'B|DDRSYS='1'B)&/* I/O ERROR &        @OZ12139*/ 00720000
*           (UCBTBYT4='08'X|        /* 2314 OR               @OZ12139*/ 00721000
*           UCBTBYT4='09'X|         /* 3330 OR               @OZ12139*/ 00722000
*           UCBTBYT4='0D'X) THEN    /* 3330-2                @OZ12139*/ 00723000
         TM    DDRDA(DDRPTR),B'01000000'                           0293 00724000
         BNO   @RF00293                                            0293 00725000
         TM    DDRPAGE(DDRPTR),B'01100000'                         0293 00726000
         BZ    @RF00293                                            0293 00727000
         L     @14,UCBPTR(,DDRPTR)                                 0293 00728000
         CLI   UCBTBYT4(@14),X'08'                                 0293 00729000
         BE    @RT00293                                            0293 00730000
         CLI   UCBTBYT4(@14),X'09'                                 0293 00731000
         BE    @RT00293                                            0293 00732000
         CLI   UCBTBYT4(@14),X'0D'                                 0293 00733000
         BNE   @RF00293                                            0293 00734000
@RT00293 DS    0H                                                  0294 00735000
*         DO;                       /* ?IGFDMSG MSG(IGF514I)RETRY(2) */ 00736000
*                                                                  0294 00737000
*           /*********************************************************/ 00738000
*           /*                                                       */ 00739000
*           /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE WRITER           */ 00740000
*           /*                                                       */ 00741000
*           /*********************************************************/ 00742000
*                                                                  0295 00743000
*           DDRMSGCD=DDRM514I;      /* SET UP MSG CODE               */ 00744000
         MVI   DDRMSGCD(DDRPTR),X'0C'                              0295 00745000
*           DDRMSGPN=0;             /* SET UP NO. OF SUBST. CODES    */ 00746000
         MVI   DDRMSGPN(DDRPTR),X'00'                              0296 00747000
*           RTNCODE=12;             /* INDICATE MESSAGE NOT DONE YET */ 00748000
         LA    RTNCODE,12                                          0297 00749000
*           DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP UNTIL MSG 0298 00750000
*                                      DONE                          */ 00751000
         LA    @14,1                                               0298 00752000
         STC   @14,DDRRETRY(,DDRPTR)                               0298 00753000
@DL00298 C     RTNCODE,@CF00042                                    0298 00754000
         BNE   @DC00298                                            0298 00755000
*             CALL IGFDM0;          /* OUTPUT MESSAGE                */ 00756000
         L     @15,@CV00052                                        0299 00757000
         BALR  @14,@15                                             0299 00758000
*           END;                    /* END OF RETRY LOOP             */ 00759000
         LA    @14,1                                               0300 00760000
         SLR   @12,@12                                             0300 00761000
         IC    @12,DDRRETRY(,DDRPTR)                               0300 00762000
         ALR   @14,@12                                             0300 00763000
         STC   @14,DDRRETRY(,DDRPTR)                               0300 00764000
         C     @14,@CF00082                                        0300 00765000
         BNH   @DL00298                                            0300 00766000
@DC00298 DS    0H                                                  0301 00767000
*         END;                      /* ?IGFDMSG MSG(IGF514I)RETRY(2)    00768000
*                                      WARN OPERATOR         @OZ12139*/ 00769000
*       ELSE                                                       0302 00770000
*         ;                         /*                       @OZ12139*/ 00771000
*                                                                  0302 00772000
@RF00293 DS    0H                                                  0303 00773000
*       /*************************************************************/ 00774000
*       /*                                                           */ 00775000
*       /* OUTPUT THE SECOND OF THE PROPER PAIR OF MESSAGES          */ 00776000
*       /*                                                           */ 00777000
*       /*************************************************************/ 00778000
*                                                                  0303 00779000
*       IF DDRTOUCB=0               /* IS THERE A 'TO' DEVICE        */ 00780000
*         THEN                      /* NO, ASK FOR ONE               */ 00781000
*                                                                  0303 00782000
         L     @14,DDRTOUCB(,DDRPTR)                               0303 00783000
         LTR   @14,@14                                             0303 00784000
         BNZ   @RF00303                                            0303 00785000
*         /***********************************************************/ 00786000
*         /*                                                         */ 00787000
*         /* IGF509D REPLY DEVICE, OR 'NO'                           */ 00788000
*         /*                                                         */ 00789000
*         /***********************************************************/ 00790000
*                                                                  0304 00791000
*         DO;                       /* ?IGFDMSG MSG(IGF509D)RETRY(2) */ 00792000
*                                                                  0304 00793000
*           /*********************************************************/ 00794000
*           /*                                                       */ 00795000
*           /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE WRITER           */ 00796000
*           /*                                                       */ 00797000
*           /*********************************************************/ 00798000
*                                                                  0305 00799000
*           DDRMSGCD=DDRM509D;      /* SET UP MSG CODE               */ 00800000
         MVI   DDRMSGCD(DDRPTR),X'07'                              0305 00801000
*           DDRMSGPN=0;             /* SET UP NO. OF SUBST. CODES    */ 00802000
         MVI   DDRMSGPN(DDRPTR),X'00'                              0306 00803000
*           DDRMSGOP=DDRWTOR;       /* INDICATE WTOR REQUEST         */ 00804000
         MVI   DDRMSGOP(DDRPTR),X'01'                              0307 00805000
*           RTNCODE=12;             /* INDICATE MESSAGE NOT DONE YET */ 00806000
         LA    RTNCODE,12                                          0308 00807000
*           DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP UNTIL MSG 0309 00808000
*                                      DONE                          */ 00809000
         LA    @14,1                                               0309 00810000
         STC   @14,DDRRETRY(,DDRPTR)                               0309 00811000
@DL00309 C     RTNCODE,@CF00042                                    0309 00812000
         BNE   @DC00309                                            0309 00813000
*             CALL IGFDM0;          /* OUTPUT MESSAGE                */ 00814000
         L     @15,@CV00052                                        0310 00815000
         BALR  @14,@15                                             0310 00816000
*           END;                    /* END OF RETRY LOOP             */ 00817000
         LA    @14,1                                               0311 00818000
         SLR   @12,@12                                             0311 00819000
         IC    @12,DDRRETRY(,DDRPTR)                               0311 00820000
         ALR   @14,@12                                             0311 00821000
         STC   @14,DDRRETRY(,DDRPTR)                               0311 00822000
         C     @14,@CF00082                                        0311 00823000
         BNH   @DL00309                                            0311 00824000
@DC00309 DS    0H                                                  0312 00825000
*         END;                      /* ?IGFDMSG MSG(IGF509D)RETRY(2) */ 00826000
*       ELSE                        /* YES, A TO DEVICE YM02576      */ 00827000
*                                                                  0313 00828000
*         /***********************************************************/ 00829000
*         /*                                                         */ 00830000
*         /* IGF500D REPLY 'YES', DEVICE, OR 'NO'                    */ 00831000
*         /*                                                         */ 00832000
*         /***********************************************************/ 00833000
*                                                                  0313 00834000
*         DO;                       /* ?IGFDMSG MSG(IGF500D)CODE(DEVI   00835000
*                                      CE)RETRY(2)                   */ 00836000
*                                                                  0313 00837000
         B     @RC00303                                            0313 00838000
@RF00303 DS    0H                                                  0314 00839000
*           /*********************************************************/ 00840000
*           /*                                                       */ 00841000
*           /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE WRITER           */ 00842000
*           /*                                                       */ 00843000
*           /*********************************************************/ 00844000
*                                                                  0314 00845000
*           DDRMSGCD=DDRM500D;      /* SET UP MSG CODE               */ 00846000
         MVI   DDRMSGCD(DDRPTR),X'02'                              0314 00847000
*           DDRMSGPN=1;             /* SET UP NO. OF SUBST. CODES    */ 00848000
         MVI   DDRMSGPN(DDRPTR),X'01'                              0315 00849000
*           DDRMSGPC(1)=DDRPDV;     /* SET SUBSTITUTION CODE 1       */ 00850000
         MVI   DDRMSGPC(DDRPTR),X'0A'                              0316 00851000
*           DDRMSGOP=DDRWTOR;       /* INDICATE WTOR REQUEST         */ 00852000
         MVI   DDRMSGOP(DDRPTR),X'01'                              0317 00853000
*           RTNCODE=12;             /* INDICATE MESSAGE NOT DONE YET */ 00854000
         LA    RTNCODE,12                                          0318 00855000
*           DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP UNTIL MSG 0319 00856000
*                                      DONE                          */ 00857000
         LA    @14,1                                               0319 00858000
         STC   @14,DDRRETRY(,DDRPTR)                               0319 00859000
@DL00319 C     RTNCODE,@CF00042                                    0319 00860000
         BNE   @DC00319                                            0319 00861000
*             CALL IGFDM0;          /* OUTPUT MESSAGE                */ 00862000
         L     @15,@CV00052                                        0320 00863000
         BALR  @14,@15                                             0320 00864000
*           END;                    /* END OF RETRY LOOP             */ 00865000
         LA    @14,1                                               0321 00866000
         SLR   @12,@12                                             0321 00867000
         IC    @12,DDRRETRY(,DDRPTR)                               0321 00868000
         ALR   @14,@12                                             0321 00869000
         STC   @14,DDRRETRY(,DDRPTR)                               0321 00870000
         C     @14,@CF00082                                        0321 00871000
         BNH   @DL00319                                            0321 00872000
@DC00319 DS    0H                                                  0322 00873000
*         END;                      /* ?IGFDMSG MSG(IGF500D)CODE(DEVI   00874000
*                                      CE)RETRY(2)                   */ 00875000
*       IF RTNCODE^=VALID THEN      /* WAS MESSAGE WRITTEN           */ 00876000
@RC00303 LTR   RTNCODE,RTNCODE                                     0323 00877000
         BZ    @RF00323                                            0323 00878000
*         DERLRC=RTNCODE;           /* NO, COPY ERROR CODE           */ 00879000
         STC   RTNCODE,DERLRC                                      0324 00880000
*       ELSE                        /* YES, ANALYZE REPLY            */ 00881000
*         IF DDRMSGOP=DDRNO THEN    /* DID OPERATOR REPLY 'NO'       */ 00882000
         B     @RC00323                                            0325 00883000
@RF00323 CLI   DDRMSGOP(DDRPTR),X'03'                              0325 00884000
         BNE   @RF00325                                            0325 00885000
*           DO;                     /* YES, CANCEL SWAP              */ 00886000
*             DDRTER1=DDRTCO;       /* INDICATE CANCELLED BY OPERATOR*/ 00887000
         MVI   DDRTER1(DDRPTR),X'05'                               0327 00888000
*             DERLRC=INVALID;       /* INDICATE CANCEL SWAP          */ 00889000
         MVI   DERLRC,X'04'                                        0328 00890000
*           END;                                                   0329 00891000
*         ELSE                      /* NO, CAN PROCESS 'TO' DEVICE   */ 00892000
*           DERLRC=VALID;           /* INDICATE SWAP CAN PROCEED     */ 00893000
         B     @RC00325                                            0330 00894000
@RF00325 MVI   DERLRC,X'00'                                        0330 00895000
*     END;                                                         0331 00896000
*   RETURN;                         /* RETURN TO CALLER              */ 00897000
@EL00003 DS    0H                                                  0332 00898000
@EF00003 DS    0H                                                  0332 00899000
@ER00003 LM    @14,@12,@SA00003                                    0332 00900000
         BR    @14                                                 0332 00901000
*   GENERATE NOREFS NOSETS(EJECT);                                 0333 00902000
*                                                                  0333 00903000
         EJECT                                                          00904000
*   /*****************************************************************/ 00905000
*   /*                                                               */ 00906000
*   /* SUBROUTINE IGFDV0V - CALLS THE PROPER VALIDATION MODULE       */ 00907000
*   /* DEPENDING ON THE DEVICE CLASS OF THE 'FROM' DEVICE            */ 00908000
*   /*                                                               */ 00909000
*   /*****************************************************************/ 00910000
*                                                                  0334 00911000
*IGFDV0V:                           /* SUBROUTINE ENTRY POINT        */ 00912000
*   ENTRY;                                                         0334 00913000
         B     @EC00334                                            0334 00914000
IGFDV0V  STM   @14,@12,@SA00003                                    0334 00915000
@EC00334 DS    0H                                                  0335 00916000
*   IF DDRDA='1'B THEN              /* IS IT A DIRECT ACCESS DEVICE  */ 00917000
         TM    DDRDA(DDRPTR),B'01000000'                           0335 00918000
         BNO   @RF00335                                            0335 00919000
*     CALL IGFDD1;                  /* YES, CALL DASD VALIDATION     */ 00920000
         L     @15,@CV00049                                        0336 00921000
         BALR  @14,@15                                             0336 00922000
*   ELSE                                                           0337 00923000
*     IF DDRMT='1'B THEN            /* IS IT A MAGNETIC TAPE DEVICE  */ 00924000
         B     @RC00335                                            0337 00925000
@RF00335 TM    DDRMT(DDRPTR),B'00100000'                           0337 00926000
         BNO   @RF00337                                            0337 00927000
*       CALL IGFDT1;                /* YES, CALL TAPE VALIDATION     */ 00928000
         L     @15,@CV00055                                        0338 00929000
         BALR  @14,@15                                             0338 00930000
*     ELSE                                                         0339 00931000
*       IF DDRUR='1'B THEN          /* IS IT A UNIT RECORD DEVICE    */ 00932000
         B     @RC00337                                            0339 00933000
@RF00337 TM    DDRUR(DDRPTR),B'00010000'                           0339 00934000
         BNO   @RF00339                                            0339 00935000
*         CALL IGFDU1;              /* YES, CALL UNIT REC VALIDATE   */ 00936000
         L     @15,@CV00056                                        0340 00937000
         BALR  @14,@15                                             0340 00938000
*       ELSE                        /* NO, INVALID DEVICE CLASS      */ 00939000
*         DO;                                                      0341 00940000
         B     @RC00339                                            0341 00941000
@RF00339 DS    0H                                                  0342 00942000
*           DDRTER1=DDRTCE;         /* INDICATE CATASTROPHIC ERROR   */ 00943000
         MVI   DDRTER1(DDRPTR),X'07'                               0342 00944000
*           RTNCODE=CATERR;         /* SET RETURN CODE TO 12         */ 00945000
         LA    RTNCODE,12                                          0343 00946000
*         END;                                                     0344 00947000
*   DERLRC=RTNCODE;                 /* COPY RETURN CODE FOR CALLER   */ 00948000
@RC00339 DS    0H                                                  0345 00949000
@RC00337 DS    0H                                                  0345 00950000
@RC00335 STC   RTNCODE,DERLRC                                      0345 00951000
*   RETURN;                         /* RETURN TO CALLER              */ 00952000
         B     @EL00003                                            0346 00953000
*   END IGFDV02;                    /* END OF INTERNAL PROCEDURE     */ 00954000
         B     @EL00003                                            0347 00955000
*   END IGFDV0                      /* END OF MODULE                 */ 00956000
*                                                                  0348 00957000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00958000
*/*%INCLUDE SYSLIB  (IHADDR  )                                       */ 00959000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 00960000
*                                                                  0348 00961000
*       ;                                                          0348 00962000
@EL00001 L     @13,4(,@13)                                         0348 00963000
@EF00001 L     @00,@SIZDATD                                        0348 00964000
         LR    @01,@09                                             0348 00965000
         FREEMAIN R,LV=(0),A=(1)                                        00966000
@ER00001 LM    @14,@12,12(@13)                                     0348 00967000
         BR    @14                                                 0348 00968000
@DATA    DS    0H                                                       00969000
@DATD    DSECT                                                          00970000
         DS    0F                                                       00971000
@SA00001 DS    18F                                                      00972000
@SA00002 DS    15F                                                      00973000
@SA00003 DS    15F                                                      00974000
@AL00001 DS    1A                                                       00975000
IGFDV0   CSECT                                                          00976000
         DS    0F                                                       00977000
@CF00082 DC    F'2'                                                     00978000
@CF00042 DC    F'12'                                                    00979000
@DATD    DSECT                                                          00980000
         DS    0D                                                       00981000
CONTROL  DS    BL1                                                      00982000
         DS    CL3                                                      00983000
DERPLIST DS    CL48                                                     00984000
         ORG   DERPLIST                                                 00985000
DERFUNK  DS    AL1                                                      00986000
DERSWCHS DS    BL1                                                      00987000
         ORG   DERSWCHS                                                 00988000
DERCRASH DS    BL1                                                      00989000
DERPERK  EQU   DERSWCHS+0                                               00990000
DERECALL EQU   DERSWCHS+0                                               00991000
DERESTAE EQU   DERSWCHS+0                                               00992000
@NM00009 EQU   DERSWCHS+0                                               00993000
         ORG   DERPLIST+2                                               00994000
@NM00010 DS    CL2                                                      00995000
DERREC   DS    AL4                                                      00996000
DERSPEC  DS    AL4                                                      00997000
DERRETRY DS    AL4                                                      00998000
DERDATD  DS    CL4                                                      00999000
         ORG   DERDATD                                                  01000000
DERDASPN DS    FL1                                                      01001000
DERDALNG DS    FL3                                                      01002000
         ORG   DERPLIST+20                                              01003000
DERRSRC  DS    BL1                                                      01004000
         ORG   DERRSRC                                                  01005000
DERTAPE  DS    BL1                                                      01006000
DERUREC  EQU   DERRSRC+0                                                01007000
DERDISK  EQU   DERRSRC+0                                                01008000
@NM00011 EQU   DERRSRC+0                                                01009000
         ORG   DERPLIST+21                                              01010000
DERLRC   DS    AL1                                                      01011000
DERRUB   DS    CL18                                                     01012000
         ORG   DERRUB                                                   01013000
DERPFX   DS    BL2                                                      01014000
DERRCODE DS    AL4                                                      01015000
DERRDATA DS    AL4                                                      01016000
DERRDDR  DS    AL4                                                      01017000
DERRSAVE DS    AL4                                                      01018000
         ORG   DERPLIST+40                                              01019000
DERGMSPL DS    CL4                                                      01020000
         ORG   DERGMSPL                                                 01021000
DERGMSPN DS    FL1                                                      01022000
DERGMLNG DS    FL3                                                      01023000
         ORG   DERPLIST+44                                              01024000
DERGMADR DS    AL4                                                      01025000
         ORG   DERPLIST+48                                              01026000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01027000
@ENDDATD EQU   *                                                        01028000
IGFDV0   CSECT                                                          01029000
         DS    0F                                                       01030000
@SIZDATD DC    AL1(245)                                                 01031000
         DC    AL3(@ENDDATD-@DATD)                                      01032000
@CV00049 DC    V(IGFDD1)                                                01033000
@CV00050 DC    V(IGFDE0)                                                01034000
@CV00051 DC    V(IGFDL1)                                                01035000
@CV00052 DC    V(IGFDM0)                                                01036000
@CV00053 DC    V(IGFDM1)                                                01037000
@CV00054 DC    V(IGFDR0)                                                01038000
@CV00055 DC    V(IGFDT1)                                                01039000
@CV00056 DC    V(IGFDU1)                                                01040000
@CV00057 DC    V(IGFDW0)                                                01041000
         DS    0D                                                       01042000
@CB00288 DC    B'0000000011100100'                                      01043000
DERRECPM DS    CL24                                                     01044000
         ORG   DERRECPM                                                 01045000
@NM00012 DC    CL8'IGFDI0'                                              01046000
@NM00013 DC    CL8'IGFDV0'                                              01047000
@NM00014 DC    CL8'76246'                                               01048000
         ORG   DERRECPM+24                                              01049000
         DS    CL2                                                      01050000
IGFDV0P  DC    13F'0'                                                   01051000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01052000
@01      EQU   01                                                       01053000
@02      EQU   02                                                       01054000
@03      EQU   03                                                       01055000
@04      EQU   04                                                       01056000
@05      EQU   05                                                       01057000
@06      EQU   06                                                       01058000
@07      EQU   07                                                       01059000
@08      EQU   08                                                       01060000
@09      EQU   09                                                       01061000
@10      EQU   10                                                       01062000
@11      EQU   11                                                       01063000
@12      EQU   12                                                       01064000
@13      EQU   13                                                       01065000
@14      EQU   14                                                       01066000
@15      EQU   15                                                       01067000
CODEBASE EQU   @08                                                      01068000
DATABASE EQU   @09                                                      01069000
DDRPTR   EQU   @10                                                      01070000
SAVEPTR  EQU   @13                                                      01071000
RTNCODE  EQU   @15                                                      01072000
DDRCOM   EQU   0                                                        01073000
DDRSHORT EQU   DDRCOM                                                   01074000
DDRCNTRL EQU   DDRSHORT+8                                               01075000
DDRSRC   EQU   DDRCNTRL                                                 01076000
DDRSYS   EQU   DDRSRC                                                   01077000
DDRPAGE  EQU   DDRSRC                                                   01078000
DDRSTAT  EQU   DDRCNTRL+1                                               01079000
DDRDCHAR EQU   DDRCNTRL+2                                               01080000
DDRDSTAT EQU   DDRDCHAR+1                                               01081000
DDRBUFL  EQU   DDRDSTAT                                                 01082000
DDRDA    EQU   DDRDSTAT                                                 01083000
DDRMT    EQU   DDRDSTAT                                                 01084000
DDRUR    EQU   DDRDSTAT                                                 01085000
DDRFMCUA EQU   DDRSHORT+18                                              01086000
DDRTOCUA EQU   DDRSHORT+21                                              01087000
DDRLONG  EQU   DDRCOM+24                                                01088000
DDRTOUCB EQU   DDRLONG                                                  01089000
DDRFMUCB EQU   DDRLONG+4                                                01090000
DDRROWN  EQU   DDRLONG+8                                                01091000
DDRFIRST EQU   DDRROWN                                                  01092000
DDRMIHT  EQU   DDRLONG+12                                               01093000
DDRTER   EQU   DDRLONG+36                                               01094000
DDRTER1  EQU   DDRTER                                                   01095000
DDRINV   EQU   DDRLONG+38                                               01096000
DDRINV2  EQU   DDRINV+1                                                 01097000
DDRAPP   EQU   DDRLONG+40                                               01098000
DDRIOF   EQU   DDRLONG+52                                               01099000
DDRIOF1  EQU   DDRIOF                                                   01100000
DDRIOF2  EQU   DDRIOF+1                                                 01101000
DDRWHICH EQU   DDRIOF2                                                  01102000
DDRITAKE EQU   DDRIOF2                                                  01103000
DDRMSG   EQU   DDRLONG+54                                               01104000
DDRMSGOP EQU   DDRMSG                                                   01105000
DDRMSGCD EQU   DDRMSG+1                                                 01106000
DDRMSGP  EQU   DDRLONG+56                                               01107000
DDRMSGPN EQU   DDRMSGP                                                  01108000
DDRMSGPC EQU   DDRMSGP+1                                                01109000
DDRLABEL EQU   DDRLONG+64                                               01110000
DDRRETRY EQU   DDRLONG+65                                               01111000
DDRREC   EQU   DDRLONG+66                                               01112000
DDRREC1  EQU   DDRREC                                                   01113000
DDRREC2  EQU   DDRREC+1                                                 01114000
DDRRFMTO EQU   DDRREC2                                                  01115000
DDRUSER  EQU   DDRLONG+68                                               01116000
UCB      EQU   0                                                        01117000
UCBOB    EQU   0                                                        01118000
UCBJBNR  EQU   UCBOB                                                    01119000
UCBFL5   EQU   UCBOB+1                                                  01120000
UCBAF    EQU   UCBFL5                                                   01121000
UCBSTAT  EQU   UCBOB+3                                                  01122000
UCBCHAN  EQU   UCBOB+4                                                  01123000
UCBSFLS  EQU   UCBOB+6                                                  01124000
UCBFLA   EQU   UCBSFLS                                                  01125000
UCBFL1   EQU   UCBFLA                                                   01126000
UCBBSY   EQU   UCBFL1                                                   01127000
UCBNRY   EQU   UCBFL1                                                   01128000
UCBPST   EQU   UCBFL1                                                   01129000
UCBCUB   EQU   UCBFL1                                                   01130000
UCBFLB   EQU   UCBSFLS+1                                                01131000
UCBCHM   EQU   UCBOB+8                                                  01132000
UCBCHM1  EQU   UCBCHM                                                   01133000
UCBPTH0  EQU   UCBCHM1                                                  01134000
UCBPTH1  EQU   UCBCHM1                                                  01135000
UCBWGT   EQU   UCBOB+12                                                 01136000
UCBTYP   EQU   UCBOB+16                                                 01137000
UCBTBYT1 EQU   UCBTYP                                                   01138000
UCB1FEA5 EQU   UCBTBYT1                                                 01139000
UCB1FEA6 EQU   UCBTBYT1                                                 01140000
UCBTBYT2 EQU   UCBTYP+1                                                 01141000
UCB2OPT2 EQU   UCBTBYT2                                                 01142000
UCBDUDN1 EQU   UCB2OPT2                                                 01143000
UCBRR    EQU   UCBDUDN1                                                 01144000
UCB2OPT3 EQU   UCBTBYT2                                                 01145000
UCBDUDN2 EQU   UCB2OPT3                                                 01146000
UCB2OPT4 EQU   UCBTBYT2                                                 01147000
UCB2OPT6 EQU   UCBTBYT2                                                 01148000
UCB2OPT7 EQU   UCBTBYT2                                                 01149000
UCBTBYT3 EQU   UCBTYP+2                                                 01150000
UCBDVCLS EQU   UCBTBYT3                                                 01151000
UCBTBYT4 EQU   UCBTYP+3                                                 01152000
UCBEXTPT EQU   UCBOB+20                                                 01153000
UCBFLC   EQU   UCBEXTPT                                                 01154000
UCBDEV   EQU   UCBOB+24                                                 01155000
UCBCMEXT EQU   0                                                        01156000
UCBATI   EQU   UCBCMEXT+3                                               01157000
@NM00018 EQU   UCBATI                                                   01158000
UCBFLP1  EQU   UCBCMEXT+5                                               01159000
UCBMT    EQU   0                                                        01160000
UCBOCR   EQU   0                                                        01161000
UCBUCS   EQU   0                                                        01162000
UCBUCSOP EQU   UCBUCS+4                                                 01163000
UCBFCBOP EQU   UCBUCS+5                                                 01164000
UCBBGN   EQU   0                                                        01165000
UCBPTR   EQU   DDRFMUCB                                                 01166000
UCBOBS01 EQU   UCBDEV                                                   01167000
UCBSTAB  EQU   UCBOBS01+10                                              01168000
UCBBSVL  EQU   UCBSTAB                                                  01169000
UCBPRSRS EQU   UCBSTAB                                                  01170000
UCBDMCT  EQU   UCBOBS01+11                                              01171000
UCBFL4   EQU   UCBOBS01+13                                              01172000
UCBOBS02 EQU   UCBDEV                                                   01173000
UCBTFL1  EQU   UCBOBS02+19                                              01174000
UCBXTN   EQU   UCBOBS02+20                                              01175000
UCBVOPT  EQU   UCBXTN                                                   01176000
UCBOBS03 EQU   UCBDEV                                                   01177000
UCBXTADR EQU   UCBOBS03                                                 01178000
UCBOBS04 EQU   UCBDEV                                                   01179000
UCBBTA   EQU   UCBOBS04+12                                              01180000
UCBOBS06 EQU   UCBDEV                                                   01181000
UCBAOF   EQU   UCBOBS06                                                 01182000
UCBAOF1  EQU   UCBAOF                                                   01183000
UCBAOF2  EQU   UCBAOF+1                                                 01184000
@NM00017 EQU   UCBOBS06+3                                               01185000
UCBIRB   EQU   UCBOBS06+4                                               01186000
UCBGRAF  EQU   UCBIRB                                                   01187000
UCBLDNCA EQU   UCBOBS06+8                                               01188000
UCBRDYQ  EQU   UCBLDNCA                                                 01189000
UCBIRLN  EQU   UCBRDYQ                                                  01190000
UCBLDNCB EQU   UCBRDYQ+1                                                01191000
UCBCTLNK EQU   UCBOBS06+12                                              01192000
UCBOBS07 EQU   UCBDEV                                                   01193000
UCBOBS08 EQU   UCBDEV                                                   01194000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01195000
UCBRV042 EQU   UCBOBS08+5                                               01196000
UCBCTCF1 EQU   UCBOBS08+4                                               01197000
UCBCTCAD EQU   UCBOBS08                                                 01198000
UCBICNCB EQU   UCBOBS07+4                                               01199000
UCBRV040 EQU   UCBOBS07                                                 01200000
UCBCTLNA EQU   UCBCTLNK+1                                               01201000
UCBRLN   EQU   UCBCTLNK                                                 01202000
UCBRDYQA EQU   UCBLDNCB                                                 01203000
UCBINRLN EQU   UCBIRLN                                                  01204000
UCBIRBA  EQU   UCBIRB+1                                                 01205000
UCBRV039 EQU   UCBGRAF                                                  01206000
UCBDWNR  EQU   UCBGRAF                                                  01207000
UCBRPND  EQU   UCBGRAF                                                  01208000
UCBUPM   EQU   UCBGRAF                                                  01209000
UCBBTAM  EQU   UCBGRAF                                                  01210000
UCBDRNO  EQU   UCBGRAF                                                  01211000
UCBDRO   EQU   UCBGRAF                                                  01212000
UCBOIP   EQU   UCBGRAF                                                  01213000
UCBATRCD EQU   @NM00017                                                 01214000
UCBSKPFG EQU   @NM00017                                                 01215000
UCBRIPND EQU   @NM00017                                                 01216000
UCBRTIAC EQU   @NM00017                                                 01217000
UCBRSV79 EQU   @NM00017                                                 01218000
UCBRSV78 EQU   @NM00017                                                 01219000
UCBRSV77 EQU   @NM00017                                                 01220000
UCBOLTEP EQU   @NM00017                                                 01221000
UCBATNCT EQU   UCBOBS06+2                                               01222000
UCBRSV76 EQU   UCBAOF2                                                  01223000
UCBRSV75 EQU   UCBAOF2                                                  01224000
UCBRSV74 EQU   UCBAOF2                                                  01225000
UCBRSV73 EQU   UCBAOF2                                                  01226000
UCBRSV72 EQU   UCBAOF2                                                  01227000
UCBRSV71 EQU   UCBAOF2                                                  01228000
UCBRSV70 EQU   UCBAOF2                                                  01229000
UCBRSV69 EQU   UCBAOF2                                                  01230000
UCBRSV68 EQU   UCBAOF1                                                  01231000
UCBRSV67 EQU   UCBAOF1                                                  01232000
UCBRSV66 EQU   UCBAOF1                                                  01233000
UCBRSV65 EQU   UCBAOF1                                                  01234000
UCBRSV64 EQU   UCBAOF1                                                  01235000
UCBOFNL  EQU   UCBAOF1                                                  01236000
UCBOFSP  EQU   UCBAOF1                                                  01237000
UCBOFMCR EQU   UCBAOF1                                                  01238000
UCBBTB   EQU   UCBBTA+1                                                 01239000
UCBDI    EQU   UCBBTA                                                   01240000
UCBSNS   EQU   UCBOBS04+8                                               01241000
UCBTEB   EQU   UCBOBS04+4                                               01242000
UCBGCB   EQU   UCBOBS04+3                                               01243000
UCBOPEN  EQU   UCBOBS04+2                                               01244000
UCBSTART EQU   UCBOBS04                                                 01245000
UCBXTNB  EQU   UCBXTN+1                                                 01246000
UCBRSV22 EQU   UCBVOPT                                                  01247000
UCBRSV21 EQU   UCBVOPT                                                  01248000
UCBRSV20 EQU   UCBVOPT                                                  01249000
UCBESVE  EQU   UCBVOPT                                                  01250000
UCBERPC  EQU   UCBVOPT                                                  01251000
UCBESVC  EQU   UCBVOPT                                                  01252000
UCBEVA   EQU   UCBVOPT                                                  01253000
UCBESV   EQU   UCBVOPT                                                  01254000
UCBRV009 EQU   UCBTFL1                                                  01255000
UCBRV008 EQU   UCBTFL1                                                  01256000
UCBRV007 EQU   UCBTFL1                                                  01257000
UCBRV006 EQU   UCBTFL1                                                  01258000
UCBRV005 EQU   UCBTFL1                                                  01259000
UCBRV038 EQU   UCBTFL1                                                  01260000
UCBNSLTP EQU   UCBTFL1                                                  01261000
UCBNLTP  EQU   UCBTFL1                                                  01262000
UCBRES1B EQU   UCBOBS02+18                                              01263000
UCBFSER  EQU   UCBOBS02+12                                              01264000
@NM00016 EQU   UCBOBS02+4                                               01265000
UCBFSEQ  EQU   UCBOBS02+2                                               01266000
UCBFSCT  EQU   UCBOBS02                                                 01267000
UCBNEXP  EQU   UCBOBS01+20                                              01268000
UCBBASE  EQU   UCBOBS01+16                                              01269000
UCBRES1A EQU   UCBOBS01+15                                              01270000
UCBUSER  EQU   UCBOBS01+14                                              01271000
UCBFL47  EQU   UCBFL4                                                   01272000
UCBFL46  EQU   UCBFL4                                                   01273000
UCBFL45  EQU   UCBFL4                                                   01274000
UCBFL44  EQU   UCBFL4                                                   01275000
UCBDSS   EQU   UCBFL4                                                   01276000
UCBRV028 EQU   UCBFL4                                                   01277000
UCBWDAV  EQU   UCBFL4                                                   01278000
UCBDAVV  EQU   UCBFL4                                                   01279000
UCBSQC   EQU   UCBOBS01+12                                              01280000
UCBDATP  EQU   UCBOBS01+12                                              01281000
UCBDMC   EQU   UCBDMCT                                                  01282000
UCBMOUNT EQU   UCBDMCT                                                  01283000
UCBBNUL  EQU   UCBSTAB                                                  01284000
UCBSHAR  EQU   UCBSTAB                                                  01285000
UCBBSTR  EQU   UCBSTAB                                                  01286000
UCBBPUB  EQU   UCBSTAB                                                  01287000
UCBBPRV  EQU   UCBSTAB                                                  01288000
UCBBALB  EQU   UCBPRSRS                                                 01289000
UCBPGFL  EQU   UCBSTAB                                                  01290000
UCBDVSHR EQU   UCBBSVL                                                  01291000
UCBVOLI  EQU   UCBOBS01+4                                               01292000
UCBVTOC  EQU   UCBOBS01                                                 01293000
UCBERADR EQU   UCBUCS+12                                                01294000
UCBFCBID EQU   UCBUCS+8                                                 01295000
UCBERCNT EQU   UCBUCS+7                                                 01296000
UCBRSV51 EQU   UCBUCS+6                                                 01297000
UCBRSV50 EQU   UCBFCBOP                                                 01298000
UCBRSV49 EQU   UCBFCBOP                                                 01299000
UCBRSV48 EQU   UCBFCBOP                                                 01300000
UCBRSV47 EQU   UCBFCBOP                                                 01301000
UCBRSV46 EQU   UCBFCBOP                                                 01302000
UCBRSV45 EQU   UCBFCBOP                                                 01303000
UCBRSV44 EQU   UCBFCBOP                                                 01304000
UCBFCBO1 EQU   UCBFCBOP                                                 01305000
UCBUCSPE EQU   UCBUCSOP                                                 01306000
UCBRSV43 EQU   UCBUCSOP                                                 01307000
UCBRSV42 EQU   UCBUCSOP                                                 01308000
UCBRSV41 EQU   UCBUCSOP                                                 01309000
UCBRSV40 EQU   UCBUCSOP                                                 01310000
UCBRSV39 EQU   UCBUCSOP                                                 01311000
UCBUCSO2 EQU   UCBUCSOP                                                 01312000
UCBUCSO1 EQU   UCBUCSOP                                                 01313000
UCBUCSID EQU   UCBUCS                                                   01314000
UCBRDATA EQU   UCBOCR+4                                                 01315000
UCBFRID  EQU   UCBOCR                                                   01316000
UCBCLN   EQU   UCBMT+14                                                 01317000
UCBERG   EQU   UCBMT+12                                                 01318000
UCBMS    EQU   UCBMT+11                                                 01319000
UCBNB    EQU   UCBMT+10                                                 01320000
UCBPW    EQU   UCBMT+9                                                  01321000
UCBPR    EQU   UCBMT+8                                                  01322000
UCBSIO   EQU   UCBMT+6                                                  01323000
UCBTW    EQU   UCBMT+5                                                  01324000
UCBTR    EQU   UCBMT+4                                                  01325000
UCBTWT   EQU   UCBMT+3                                                  01326000
UCBTRT   EQU   UCBMT+2                                                  01327000
UCBCTD   EQU   UCBMT                                                    01328000
UCBWTOID EQU   UCBCMEXT+17                                              01329000
UCBRV043 EQU   UCBCMEXT+16                                              01330000
UCBASID  EQU   UCBCMEXT+14                                              01331000
UCBMFCNT EQU   UCBCMEXT+12                                              01332000
UCBPMSK  EQU   UCBCMEXT+10                                              01333000
UCBCCWOF EQU   UCBCMEXT+8                                               01334000
UCBRV041 EQU   UCBCMEXT+6                                               01335000
UCBRV036 EQU   UCBFLP1                                                  01336000
UCBRV035 EQU   UCBFLP1                                                  01337000
UCBRV034 EQU   UCBFLP1                                                  01338000
UCBRV033 EQU   UCBFLP1                                                  01339000
UCBRV032 EQU   UCBFLP1                                                  01340000
UCBRV031 EQU   UCBFLP1                                                  01341000
UCBRV030 EQU   UCBFLP1                                                  01342000
UCBNSRCH EQU   UCBFLP1                                                  01343000
UCBSNSCT EQU   UCBCMEXT+4                                               01344000
UCBHPDV  EQU   @NM00018                                                 01345000
UCBHALI  EQU   @NM00018                                                 01346000
UCBRSV09 EQU   @NM00018                                                 01347000
UCBRSV08 EQU   @NM00018                                                 01348000
UCBRSV07 EQU   @NM00018                                                 01349000
UCBRSV06 EQU   @NM00018                                                 01350000
UCBRSV05 EQU   @NM00018                                                 01351000
UCBRSV04 EQU   @NM00018                                                 01352000
UCBDTI   EQU   UCBCMEXT+2                                               01353000
UCBSTI   EQU   UCBCMEXT+1                                               01354000
UCBETI   EQU   UCBCMEXT                                                 01355000
UCBEXTP  EQU   UCBEXTPT+1                                               01356000
UCBDDRSW EQU   UCBFLC                                                   01357000
UCBTICBT EQU   UCBFLC                                                   01358000
UCBIVRR  EQU   UCBFLC                                                   01359000
UCBIVRS  EQU   UCBFLC                                                   01360000
UCBITF   EQU   UCBFLC                                                   01361000
UCBUDE   EQU   UCBFLC                                                   01362000
UCBWAA   EQU   UCBFLC                                                   01363000
UCBATTP  EQU   UCBFLC                                                   01364000
UCBUNTYP EQU   UCBTBYT4                                                 01365000
UCBRSV11 EQU   UCBDVCLS                                                 01366000
UCBRSV10 EQU   UCBDVCLS                                                 01367000
UCB3CHAR EQU   UCBDVCLS                                                 01368000
UCB3UREC EQU   UCBDVCLS                                                 01369000
UCB3DISP EQU   UCBDVCLS                                                 01370000
UCB3DACC EQU   UCBDVCLS                                                 01371000
UCB3COMM EQU   UCBDVCLS                                                 01372000
UCB3TAPE EQU   UCBDVCLS                                                 01373000
UCBDVPWR EQU   UCB2OPT7                                                 01374000
UCBVLPWR EQU   UCB2OPT6                                                 01375000
UCB2OPT5 EQU   UCBTBYT2                                                 01376000
UCBRWTAU EQU   UCB2OPT4                                                 01377000
UCBRPS   EQU   UCBDUDN2                                                 01378000
UCB2OPT1 EQU   UCBTBYT2                                                 01379000
UCB2OPT0 EQU   UCBTBYT2                                                 01380000
UCB1FEA7 EQU   UCBTBYT1                                                 01381000
UCBD6250 EQU   UCB1FEA6                                                 01382000
UCBD1600 EQU   UCB1FEA5                                                 01383000
UCB1FEA4 EQU   UCBTBYT1                                                 01384000
UCB1FEA3 EQU   UCBTBYT1                                                 01385000
UCB1FEA2 EQU   UCBTBYT1                                                 01386000
UCB1FEA1 EQU   UCBTBYT1                                                 01387000
UCB1FEA0 EQU   UCBTBYT1                                                 01388000
UCBNAME  EQU   UCBOB+13                                                 01389000
UCBRV029 EQU   UCBWGT                                                   01390000
UCBVHRSN EQU   UCBWGT                                                   01391000
UCBVORSN EQU   UCBWGT                                                   01392000
UCBMTPXP EQU   UCBWGT                                                   01393000
UCBREW   EQU   UCBWGT                                                   01394000
UCBPUB   EQU   UCBWGT                                                   01395000
UCBOUT   EQU   UCBWGT                                                   01396000
UCBIN    EQU   UCBWGT                                                   01397000
UCBCPU   EQU   UCBOB+11                                                 01398000
UCBLCI   EQU   UCBOB+10                                                 01399000
UCBCNT   EQU   UCBOB+9                                                  01400000
UCBRV017 EQU   UCBCHM1                                                  01401000
UCBRV016 EQU   UCBCHM1                                                  01402000
UCBRV015 EQU   UCBCHM1                                                  01403000
UCBRV014 EQU   UCBCHM1                                                  01404000
UCBSPB   EQU   UCBPTH1                                                  01405000
UCBPPB   EQU   UCBPTH1                                                  01406000
UCBSPA   EQU   UCBPTH0                                                  01407000
UCBPPA   EQU   UCBPTH0                                                  01408000
UCBFLB7  EQU   UCBFLB                                                   01409000
UCBFLB6  EQU   UCBFLB                                                   01410000
UCBFLB5  EQU   UCBFLB                                                   01411000
UCBFLB4  EQU   UCBFLB                                                   01412000
UCBRESVH EQU   UCBFLB                                                   01413000
UCBSPST  EQU   UCBFLB                                                   01414000
UCBASNS  EQU   UCBFLB                                                   01415000
UCBIORST EQU   UCBFLB                                                   01416000
UCBQISCE EQU   UCBFL1                                                   01417000
UCBACTV  EQU   UCBFL1                                                   01418000
UCBSAP   EQU   UCBFL1                                                   01419000
UCBNOTRC EQU   UCBCUB                                                   01420000
UCBPSNS  EQU   UCBFL1                                                   01421000
UCBUSING EQU   UCBPST                                                   01422000
UCBNOTRD EQU   UCBNRY                                                   01423000
UCBBUSYD EQU   UCBBSY                                                   01424000
UCBUA    EQU   UCBCHAN+1                                                01425000
UCBCHA   EQU   UCBCHAN                                                  01426000
UCBDADI  EQU   UCBSTAT                                                  01427000
UCBSYSR  EQU   UCBSTAT                                                  01428000
UCBPRES  EQU   UCBSTAT                                                  01429000
UCBALOC  EQU   UCBSTAT                                                  01430000
UCBUNLD  EQU   UCBSTAT                                                  01431000
UCBRESV  EQU   UCBSTAT                                                  01432000
UCBCHGS  EQU   UCBSTAT                                                  01433000
UCBONLI  EQU   UCBSTAT                                                  01434000
UCBID    EQU   UCBOB+2                                                  01435000
UCBALTPH EQU   UCBFL5                                                   01436000
UCBALTCU EQU   UCBFL5                                                   01437000
UCBNALOC EQU   UCBFL5                                                   01438000
UCBENVRD EQU   UCBFL5                                                   01439000
UCBVSDR  EQU   UCBFL5                                                   01440000
UCBSASK  EQU   UCBFL5                                                   01441000
UCBAMV   EQU   UCBAF                                                    01442000
UCBDCC   EQU   UCBFL5                                                   01443000
UCBMONT  EQU   UCBJBNR                                                  01444000
UCBRV011 EQU   UCBJBNR                                                  01445000
UCBRSV02 EQU   UCBJBNR                                                  01446000
UCBRSV01 EQU   UCBJBNR                                                  01447000
UCBRV003 EQU   UCBJBNR                                                  01448000
UCBRV002 EQU   UCBJBNR                                                  01449000
UCBJES3  EQU   UCBJBNR                                                  01450000
UCBVRDEV EQU   UCBJBNR                                                  01451000
UCBCMSEG EQU   UCBOB                                                    01452000
UCBPFXND EQU   UCB+512                                                  01453000
UCBIOQ   EQU   UCB+508                                                  01454000
UCBLOCK  EQU   UCB+504                                                  01455000
UCBPXST  EQU   UCB+504                                                  01456000
@NM00015 EQU   UCB                                                      01457000
DDRSSOB  EQU   DDRLONG+76                                               01458000
DDRUBCNT EQU   DDRLONG+72                                               01459000
@NM00008 EQU   DDRUSER+1                                                01460000
DDRUMODE EQU   DDRUSER                                                  01461000
@NM00007 EQU   DDRREC2                                                  01462000
DDRLNOP  EQU   DDRLABEL                                                 01463000
@NM00006 EQU   DDRLABEL                                                 01464000
DDRLSD   EQU   DDRLABEL                                                 01465000
DDRLNSL  EQU   DDRLABEL                                                 01466000
DDRLNL   EQU   DDRLABEL                                                 01467000
DDRLBLP  EQU   DDRLABEL                                                 01468000
DDRLAL   EQU   DDRLABEL                                                 01469000
@NM00005 EQU   DDRIOF2                                                  01470000
DDRICNT  EQU   DDRIOF2                                                  01471000
DDRIMNT  EQU   DDRIOF2                                                  01472000
DDRILAB  EQU   DDRIOF2                                                  01473000
DDRCOUNT EQU   DDRLONG+48                                               01474000
DDRIBUF  EQU   DDRLONG+44                                               01475000
DDRIBUFL EQU   DDRLONG+42                                               01476000
DDRAPP2  EQU   DDRAPP+1                                                 01477000
DDRAPP1  EQU   DDRAPP                                                   01478000
DDRINV1  EQU   DDRINV                                                   01479000
DDRTER2  EQU   DDRTER+1                                                 01480000
DDRTEST  EQU   DDRLONG+32                                               01481000
DDRUASCB EQU   DDRLONG+28                                               01482000
DDRUTCB  EQU   DDRLONG+24                                               01483000
DDRUIOB  EQU   DDRLONG+20                                               01484000
DDRUDEB  EQU   DDRMIHT+4                                                01485000
DDRUDCB  EQU   DDRMIHT                                                  01486000
DDRASID  EQU   DDRLONG+10                                               01487000
DDRMIH   EQU   DDRLONG+9                                                01488000
DDRJES3L EQU   DDRROWN                                                  01489000
@NM00004 EQU   DDRROWN                                                  01490000
DDRRDENQ EQU   DDRROWN                                                  01491000
DDRRUENQ EQU   DDRROWN                                                  01492000
DDRRTENQ EQU   DDRROWN                                                  01493000
DDRUASID EQU   DDRSHORT+16                                              01494000
DDRUIOSB EQU   DDRSHORT+12                                              01495000
@NM00003 EQU   DDRDSTAT                                                 01496000
DDRMDR   EQU   DDRDCHAR                                                 01497000
@NM00002 EQU   DDRSTAT                                                  01498000
DDRSIRB  EQU   DDRSTAT                                                  01499000
DDRPRG   EQU   DDRSTAT                                                  01500000
DDRRMV   EQU   DDRSTAT                                                  01501000
DDRHAMA  EQU   DDRSTAT                                                  01502000
DDRQUE   EQU   DDRSTAT                                                  01503000
DDRACTV  EQU   DDRSTAT                                                  01504000
@NM00001 EQU   DDRSRC                                                   01505000
DDROPER  EQU   DDRSRC                                                   01506000
DDRNXT   EQU   DDRSHORT+4                                               01507000
DDRID    EQU   DDRSHORT                                                 01508000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01509000
@RC00290 EQU   @EL00003                                                 01510000
@RC00325 EQU   @EL00003                                                 01511000
@RC00323 EQU   @EL00003                                                 01512000
@PB00003 EQU   @EL00001                                                 01513000
@ENDDATA EQU   *                                                        01514000
         END   IGFDV0,(C'PLS1817',0701,76246)                           01515000
