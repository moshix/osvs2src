         TITLE 'IGC0002B                      OPEN TYPE=J - INITIAL MODU00200002
               ULE, MOVE JFCB'                                          00202002
IGC0002B CSECT                                                          00800021
*********************************************************************** 00900002
*                                                                     * 01000002
*        VS 2 RELEASE 030 DELETIONS/CHANGES                           * 01000137
*0000276070-276140,284600-285000,664548-666018,784300-784600   @ZA00118 01009137
*814500,828001-828002,834800,835300,836000                     @ZA00118 01018137
*0000                                                          @ZA08282 01027137
*0000                                                          @ZA09633 01036137
*0000826350,829365                                             @ZA09969 01037137
*0000664816-664828                                             @ZA10275 01038137
*0000664799,664805,664808                                      @ZA10558 01039137
*0000666454                                                    @ZA15088 01040137
*                                                                     * 01041137
*        VS 2 RELEASE 020 DELETIONS/CHANGES                           * 01046137
*0000333904                                                     ZA01282 01051137
*0000                                                          @ZA08282 01056137
*0000                                                          @ZA09633 01061137
*0000826350,829365                                             @ZA09969 01063137
*0000664816-664828                                             @ZA10275 01065137
*0000664799,664805,664808                                      @ZA10558 01067137
*                                                                     * 01070002
* MODULE NAME = IGC0002B (OS/VS2)                                     * 01100002
*                                                                     * 01200002
* DESCRIPTIVE NAME = OPEN TYPE = J INITIAL MODULE, MOVE JFCB          * 01300002
*                                                                     * 01400002
* COPYRIGHT = NONE                                                    * 01500002
*                                                                     * 01600002
* STATUS = RELEASE 2, LEVEL 0                                         * 01700002
*                                                                     * 01800002
* FUNCTION =                                                          * 01900002
*        1. SAVE REGISTERS 2-12 IN SVRB EXTENDED SAVE AREA, AND GET   * 02000002
*        MAIN STORAGE (VIA RESIDENT ROUTINE) FOR:                     * 02100002
*           A. WHERE-TO-GO TABLE.                                     * 02200002
*                                                                     * 02300002
*        2. OBTAIN COPIED PARAMETER LIST IN DATA MANAGEMENT KEY.      * 02400002
*                                                                     * 02500002
*        3. INITIALIZE EACH WHERE-TO-GO ENTRY EXCEPT FOR VTAM         * 02600002
*        REQUESTS.                                                    * 02700002
*                                                                     * 02800002
*        4. GET WORK AREA FOR A COPY OF EACH DCB/ACB; INITIALIZE IT,  * 02900002
*        AND COPY DCB/ACB.  IF DDNAME IS NOT IN TIOT, FREE WORK AREA  * 03000002
*        AFTER ISSUING THE WTO MESSAGE "IEC130I DDNAMEXX DD STATEMENT * 03100002
*        MISSING".                                                    * 03200002
*                                                                     * 03300002
*        5. MOVE THE JFCB FROM THE SCHEDULER WORK AREA INTO THE OPEN  * 03400002
*        WORK AREA. CHECK TO SEE IF THE TRACE ROUTINE HAS BEEN        * 03500002
*        REQUESTED.  IF IT HAS, THEN TURN ON THE TRACE ROUTINE        * 03600002
*        INDICATOR AT WTGPATHS+K1.                                    * 03700002
*                                                                     * 03800002
*        6. LOCATE X'07' ENTRY IN DCB EXIT LIST AND MOVE THE JFCB     * 03900002
*        INTO THE MAIN DCB WORK AREA.                                 * 04000002
*                                                                     * 04100002
* NOTES = SEE BELOW                                                   * 04200002
*                                                                     * 04300002
*    DEPENDENCIES =                                                   * 04400002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 04500002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 04600002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 04700002
*                                                                     * 04800002
*    RESTRICTIONS = NONE                                              * 04900002
*                                                                     * 05000002
*    REGISTER CONVENTIONS =                                           * 05100002
*            R2 POINTS TO DCB                                         * 05200002
*            R4 POINTS TO OPEN WORK AREA                              * 05300002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 05400002
*            R6 POINTS TO THE WTG TABLE                               * 05500002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 05600002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 05700002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 05800002
*            R10 POINTS TO THE UCB                                    * 05900002
*                                                                     * 06000002
*    PATCH LABEL = SEE THIRD LABEL BEFORE ORG STATEMENT AT END        * 06100002
*                  OF LISTING.                                        * 06200002
*                                                                     * 06300002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 06400002
*                                                                     * 06500002
*    PROCESSOR = ASSEMBLER XF                                         * 06600002
*                                                                     * 06700002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 06800002
*                  ORG STATEMENT AT END OF LISTING                    * 06900002
*                                                                     * 07000002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 07100002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 07200002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 07300002
*                                                                     * 07400002
* ENTRY POINT = OPEN TYPE = J OR SVC 22                               * 07500002
*                                                                     * 07600002
*    PURPOSE = INITIALIZE WORK AREAS FOR OPEN PROCESSING WITH CALLER  * 07700002
*              SUPPLIED JFCB.                                         * 07800002
*                                                                     * 07900002
*    LINKAGE = REGISTER 1 POINTING TO VARIABLE PARAMETER LIST         * 08000002
*                                                                     * 08100002
* INPUT = REGISTER 1 POINTING TO THE PARAMETER LIST                   * 08200002
*                                                                     * 08300002
* OUTPUT = WORK AREAS AND REGISTERS INITIALIZED FOR OPEN PROCESSING   * 08400002
*                                                                     * 08500002
* EXIT-NORMAL = IFG0193A NORMAL OPEN PROCESSING                       * 08600002
*                                                                     * 08700002
* EXIT-ERROR = CALLER IF NO DCB CAN BE OPENED                         * 08800002
*                                                                     * 08900002
* EXTERNAL REFERENCES = SEE BELOW                                     * 09000002
*                                                                     * 09100002
*    ROUTINES = IFG0193A,IFG019RA.                                    * 09200002
*                                                                     * 09300002
*    DATA AREAS = SEE PARAMETERS OF IECDSECS MACRO.                   * 09400002
*                                                                     * 09500002
*    CONTROL BLOCK = SEE PARAMETERS OF IECDSECS MACRO.                * 09600002
*                                                                     * 09700002
* TABLES = SEE XCTLTABL MACRO AT END OF LISTING.                      * 09800002
*                                                                     * 09900002
* MACROS = IECDSECS,IECEQU,IECRES,WTO,ENQ,XCTLTABL.                   * 10000002
*                                                                     * 10100002
* CHANGE ACTIVITY = NEW RELEASE (LEVEL 0)                             * 10200002
*                                                                     * 10300002
*********************************************************************** 10400002
         EJECT                                                          27600021
*                                                                       28600021
         USING IHADCB,RDCB              DEFINE BASE TO USER'S DCB       28800021
         USING FORCORE,RCORE            DEFINE BASE TO MAIN WORK AREA   29000021
         USING TIOENTRY,RTIOT           DEFINE BASE TO TIOT DD ENTRY    29200021
*                                                                       29600021
         BALR  RBASE,R0                 ESTABLISH BASE REGISTER         29800002
         USING *,RBASE                  DEFINE BASE REGISTER            30000021
*                                                                       30200021
         LR    RF,R5                    POINTER TO SVRB          YM1363 30210002
         LR    RPAR,R1                  SAVE DCB PARAM LIST ADDR Y02080 30250002
         USING RBBASIC,RF                                        Y02080 30292002
*                                                                       32236021
*********************************************************************** 32242021
*                                                                       32248021
*  GETMAIN THE WHERE-TO-GO TABLE                                        32254021
*                                                                       32260021
*                                                                Y02080 32294002
* SAVE REGISTERS 2-12 IN SVRB EXTENDED SAVE AREA                 Y02080 32294402
*                                                                Y02080 32294802
*                                                                Y02080 32302002
         IECRES GET,PREFIX=WTG,         GETMAIN FOR WTG TABLE    Y02080*32303902
               STM=(2,12,RBEXSAVE),A=(RPAR)                      Y02080 32305902
*                                                                       32307902
*        REGISTER 0 CONTAINS RETURN CODE FROM SYSZTIOT ENQ       YM2869 32309902
*                                                                       32312002
         DROP  RF                                                Y02080 32316002
         LA    RWTG,DXDCBLST-DXDCBLST(,R1) WTG ADDR TO RWTG REG  A39979 32320002
         USING WTG,RWTG                 DEFINE BASE TO WTG TABLE A39979 32328002
         IECRES LOAD,MODNM=OPENJ,BRANCH=NO,PREFIX=WTGPREFX       Y02080*32338002
                                        GIVE OPT TRACE A SHOT    Y02080 32348002
*                                                                       32360002
*        OBTAIN COPIED PARAMETER LIST IN DATA MANAGEMENT KEY     Y02082 32368002
*                                                                       32376002
         L     RPAR,WTGPREFX            WTG PREFIX ADDRESS       Y02082 32378002
         L     RC,IECRRPRM-IECPREFX(,RPAR) GET RRPLIST ADDRESS   Y02144 32378402
         MVI   RRFUNCTN-RRPLIST(RC),RRFOPENJ IND OPENJ FUNCTION  Y02144 32378802
         L     RPAR,IECUPRML-IECPREFX(,RPAR) COPY PARM LIST ADDR Y02082 32380002
*                                                                       32384002
*  INITIALIZE EACH WHERE-TO-GO TABLE ENTRY                              32544002
*                                                                       32552002
         SR    RD,RD                    SET GO SWITCH OFF        A39979 32560002
         LR    RPARC,RPAR               ADDR FIRST ENT PARM LIST A39979 32568002
         LA    RWTGC,WTGENTRY           ADDR FIRST ENT WTG TABLE A39979 32576002
         USING WTGENTRY,RWTGC           BASE TO CURRENT WTG ENT  A39979 32584002
*                                                                       32584502
*        TEST RESULT OF SYSZTIOT ENQ                             YM2869 32585002
*              REGISTER 0 NONZERO INDICATES CALLER OF OPENJ      YM2869 32585502
*              OBTAINED SYSZTIOT RESOURCE EXCLUSIVELY.           YM2869 32586002
*        THIS SHOULD NEVER OCCUR AND WILL NOT BE TOLERATED.      YM2869 32586502
*                                                                       32587002
         LTR   R0,R0                    IS RETURN CODE 0         YM2869 32587502
         BNZ   OIN23250                 BRANCH IF NOT            YM2869 32588002
*                                                                       32592002
OIN20200 EQU   *                        PROCESS PARM LIST LOOP          32600002
         L     RDCB,PLISTDCB(,RPARC)    LOAD CURRENT DCB ADDR           32800021
*                                                                       32810002
*        MAKE SURE THIS DCB IS NOT PREVIOUSLY DUPLICATED IN      YM2869 32820002
*        THE PARAMETER LIST                                      YM2869 32830002
*                                                                       32840002
         DROP  RWTGC                                             YM2869 32850002
         LA    R1,WTGENTRY              FIRST DCB'S WTG ENTRY    YM2869 32860002
         USING WTGENTRY,R1                                       YM2869 32870002
OIN20220 EQU   *                        PROCESS EACH DCB         YM2869 32880002
         CR    R1,RWTGC                 AT CURRENT ENTRY YET     YM2869 32890002
         BE    OIN20260                 BR IF YES-NO DUPLICATE   YM2869 32900002
         L     RCORE,WTGCORE-K1         GET WORKAREA             YM2869 32910002
         LA    RCORE,K0(,RCORE)         CLEAR HIGH BYTE FOR LTR  YM2869 32920002
         LTR   RCORE,RCORE              IS WORKAREA PRESENT      YM2869 32930002
         BZ    OIN20240                 BR IF NO-GET NEXT DCB    YM2869 32940002
         CLM   RDCB,B'0111',DXUDCBAD+K1 IS CURRENT DCB BEING     YM2869 32950002
*                                       PROCESSED ALREADY        YM2869 32960002
         BE    OIN20400                 BR IF YES-DON'T PROCESS  YM2869 32970002
OIN20240 EQU   *                        GET NEXT DCB'S ENTRY     YM2869 32980002
         LA    R1,WTGENTRY+L'WTGENTRY   INCREMENT TO NEXT WTG    YM2869 32990002
         B     OIN20220                 CHECK NEXT ENTRY         YM2869 33000002
         DROP  R1                                                YM2869 33010002
         USING WTGENTRY,RWTGC                                    YM2869 33020002
OIN20260 EQU   *                        ON DUPLICATE             YM2869 33030002
*                                                                       33200021
         L     RA,CVTPTR                GET CVT ADDRESS          Y02082 33200102
         L     RA,CVTTCBP-CVT(,RA)      ADDR OF TCB POINTERS     Y02082 33200202
         L     RA,K4(,RA)               GET CURRENT TCB ADDR     Y02082 33200302
         USING TCB,RA                   PROVIDE ADDRESSABILITY   Y02082 33216802
         MODESET EXTKEY=RBT234,WORKREG=15 ASSUME USER KEY        Y02082 33233502
         TM    DCBOFLGS,DCBOFOPN+DCBOFIOF OPEN OR BUSY BITS ON   YM2869 33250002
         BNZ   OIN20400                 BR IF YES-GET NEXT DCB   Y02134 33300002
*                                                                Y02004 33310002
* DO NOT PROCESS VTAM REQUESTS                                   Y02004 33320002
*                                                                Y02004 33330002
         TM    DCBMACR,DCBMEXCP         TEST FOR EXCP            Y02004 33332002
         BO    OIN20300                 YES, CANNOT BE ACB       Y02004 33334002
         TM    DCBDSRG2,ACBDORGA        IS THIS AN ACB?          Y02004 33340002
         BZ    OIN20300                 BR IF NO                 Y02004 33342002
         USING IFGACB,RACB              ADDRESS ACB              Y02004 33344002
         CLC   ACBDDNM,=X'FF00000000000000' IS THIS A VTAM ACB?  Y02004 33346002
         BNE   OIN20300                 NO, OK TO OPEN           Y02004 33348002
         MVI   ACBERFLG,VSCACBCL        SET ACB ERROR FLAG       Y02004 33348402
         USING IHADCB,RDCB              RESTORE BASE FOR DCB     Y02004 33348802
         B     OIN20400                 GET NEXT DCB/ACB         Y02004 33349202
*        DETERMINE SIZE OF DCB/ACB FOR COPYING IT INTO WORKAREA  Y02134 33350002
OIN20300 EQU   *                        GET OPEN J WORK AREA            33352002
         MODESET EXTKEY=DATAMGT         DM KEY                   Y02082 33354002
         LA    R0,OPENSIZE              SIZE OF OPEN WORKAREA    Y02134 33360002
         IECRES GET,LV=(0),PREFIX=YES,STM=(2,14,WTGPREFX),       Y02134*33370002
               ID=OJWA                                           Y02144 33372002
         LR    RCORE,R1                 ESTABLISH WORKAREA BASE  Y02134 33380002
         ST    RCORE,WTGCORE-K1         SAVE IN WTG TABLE ENTRY  Y02134 33390002
         L     RF,WTGPREFX              GET PREFIX POINTER      ZA01282 33390202
         MVC   DXATCOM3,IECRRPRM-IECPREFX(RF) SAVE RRPLIST PTR  ZA01282 33390402
*        INITIALIZE WORKAREA WITH CONTROL BLOCK POINTERS AND     Y02134 33392002
*        COPY DCB/ACB INTO WORKAREA                              Y02134 33394002
         IECRES INIT,DCBCOPY=TOWKAR,DEB=NO,STM=(3,14,WTGPREFX),  Y02134*33396002
               PREFIX=WTGPREFX                                   Y02082 33398002
         CLI   DXWCOPYE,K0              WAS COPY/INIT OK         Y02082 33448002
         BE    OIN20325                 BRANCH IF YES            Y02082 33498002
         CLI   DXWCOPYE,K2              WAS DDNAME MISSING       Y02082 33548002
         BNE   OIN20350                 NO-SOME OTHER REASON     Y02082 33598002
*                                                                       33648002
*********************************************************************** 33698002
*                                                                       33748002
*  WRITE  'IEC130I DDNAMEXX DD STATEMENT MISSING'  ERROR MESSAGE        33748402
*                                                                       33748802
OIN20310 EQU   *                        DDNAME MISSING FROM JCL         33749202
         MVC   DXLBL(OIN2500L),OIN2500K MOVE MSG TO WORKAREA     Y02134 33749602
         MVC   K12(L'DCBDDNAM,RCORE),DCBDDNAM MOVE DDNAME TO MSG Y02134 33749702
         LA    R1,DXLBL                 LOAD FOR WTO             Y02134 33749802
         WTO   MF=(E,(1))               WRITE MESSAGE TO PROGRAMMER     33749902
*                                                                       33753202
         B     OIN20350                 BR TO PROCESS NEXT DCB   Y02134 33755202
*                                                                       33755602
*********************************************************************** 33756002
OIN20325 EQU   *                        ASYNCHRONOUS PROCESSING? Y02082 33756402
         TM    DCBOFLGS,DCBOPEN         CHECK FOR OPENED DCB            33756702
         BO    OIN20350                 BR IF YES                Y02082 33760002
         TM    DCBOFLGS,DCBOLOCK        IS DCB NOT-LOCKED BIT ON        33800021
         BZ    OIN20350                 BR IF NO                 Y02134 34000002
         TM    DCBOFLGS,DCBOBUSY        IS DCB BUSY BIT ON              34200021
         BO    OIN20600                 BR IF YES TO OPEN DCB    Y02134 34400002
*                                                                       34600021
OIN20350 EQU   *                        FREE WORKAREA            Y02134 34650002
         NI    DCBOFLGS,X'FF'-DCBOBUSY  TURN OFF BUSY BIT        Y02082 34652002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(2,14,WTGPREFX)          Y02082 34654002
         XC    WTGENTRY,WTGENTRY        INVALIDATE THIS DCB      Y02134 34660002
OIN20400 EQU   *                        GET NEXT DCB IN PARM LIST       34800002
         MODESET EXTKEY=DATAMGT         DM KEY                   Y02082 34850002
         TM    PLISTOPT(RPARC),LASTNTRY  CHECK FOR LAST ENTRY           35000021
         LA    RPARC,K4(,RPARC)         INCR TO NEXT DCB IN PARM LIST   35400021
         LA    RWTGC,L'WTGENTRY(,RWTGC) ADVANCE WTG ENTRY        A39979 35600021
         BZ    OIN20200                 BR IF NOT LAST ENTRY     A39979 35660021
         B     OIN23000                 BR TO EXIT OR XCTL       A39979 35720021
*                                                                       35800021
*********************************************************************** 36000021
*                                                                       36200021
*  DCB NEEDS TO BE OPENED.                                              36400021
*                                                                       36800021
OIN20600 EQU   *                        DCB PROCESSING LOOP             37000002
         L     R9,DXDSAB                FETCH DSAB ADDRESS       YM6510 37010002
         USING DSAB,R9                  DSAB ADDRESSABILITY      YM6510 37020002
         TM    DSABFLG4,DSABCKDS+DSABCKVL ARE DSAB CHKPT BITS ON YM6510 37020402
         BZ    OIN20700                 IF NOT, SKIP RESET TEST  YM6510 37020802
         TESTAUTH FCTN=1,KEY=YES,STATE=YES TEST CALLER STATE     YM6510 37021202
         LTR   RF,RF                    IS CALLER AUTHORIZED     YM6510 37021602
         BZ    OIN20700                 IF YES, SKIP RESET       YM6510 37021702
         MODESET EXTKEY=SCHED           DSAB KEY                 Y02083 37022002
         NI    DSABFLG4,ALLBITS-DSABCKDS-DSABCKVL RESET CHKPT FLGY02083 37030002
         MODESET EXTKEY=DATAMGT         BACK TO D/M KEY          Y02083 37032002
         DROP  R9                                                YM6510 37034002
         USING TIOENTRY,RTIOT           TIOT ADDRESSABILITY      YM6510 37036002
OIN20700 EQU   *                        DCB PROCESSING LOOP CONT YM6510 37042002
         MVC   WTGIDTTR-WTGENTRY(L'WTGIDTTR,RWTGC),OPENNEXT 193A Y02080 37050002
         XC    DXREGE,DXREGE            IND FIRST ENTRY TO 193A  Y02080 37100002
         XC    DXREG0,DXREG0            CLEAR DMABCOND INDR      Y02080 37150002
         L     RTIOT,DXTIOTAD           GET TIOT ENTRY ADDRESS   Y02134 37200002
         L     RET,DXTCBADR             GET TCB ADDRESS          Y02134 37250002
         L     RET,TCBTIO-TCB(RET)      LOAD TIOT ADDRESS        Y02134 37300002
*                                                                       38050000
         TM    DCBOFLGS,DCBOCON         CHECK FOR EOV CONCATENATION     38100000
         BZ    OIN20800                 BR IF NO TO CHK DDNAME   Y02082 38150002
         TM    DCBDSRG2,ACBDORGA        IS CONTROL BLOCK AN ACB  Y02082 38160002
         BZ    OIN20350                 BR NO, EOVC BIT CANNOT=1 Y02082 38170002
         LTR   RTIOT,RTIOT              TIOT ENTRY FOUND         Y02082 38180002
         BZ    OIN20350                 NO, BR TO FREE WORK AREA Y02082 38180102
         TM    TIOELINK,TIOESSDS        TEST IF SPOOLED INPUT    YM5126 38180202
         BZ    OIN20350                 BR NO, EOVC BIT CANNOT=1 Y02082 38180302
         CLI   TIOEDDNM,BLANK           BLANK DDNAME FOR CONCAT  Y02082 38184202
         BNE   OIN20350                 BR NO, ERROR             Y02082 38186202
*                                                                Y02082 38186602
         L     RF,WTGPREFX              GET PREFIX ADDR          Y02082 38187002
         LA    RF,IECREGSV-IECPREFX(RF) GET REG SAVE ADDR        Y02082 38187402
         LR    RC,RF                    SAVE REGSAVE POINTER     Y02082 38187802
         STM   RET,R3,IECREGSV-IECREGSV(RF) SAVE REGS            Y02082 38187902
*                                                                Y02082 38283002
         TESTAUTH STATE=YES,FCTN=1      TEST STATE, APF          Y02082 38330002
*                                                                Y02082 38377002
         LTR   RF,RF                    IS CALLER AUTHORIZED TO  Y02082 38424002
*                                       HAVE EOVC BIT = 1        Y02082 38471002
         LM    RET,R3,IECREGSV-IECREGSV(RC) RESTORE REGS         Y02082 38518002
         BZ    OIN21300                 IF YES, BR TO CONTINUE   Y02082 38565002
         B     OIN20350                 IF NO, GO FREE WORK AREA Y02082 38612002
*                                                                       38659002
OIN20800 EQU *                          CONTINUE                        38706002
*                                                                       38753002
*                                                                       38800021
OIN21300 EQU   *                        CHECK FOR SPOOLED ACB           45216002
*                                                                       45224000
*        TEST FOR A NON-SUBSYSTEM ACB                            YM1363 45232002
*        - IF FOUND THE ACB WILL BE BYPASSED                     YM1363 45234002
*          WORKAREA WILL NOT BE GOTTEN AND                       YM1363 45240002
*          THE BUSY BIT WILL NOT BE TURNED ON                    YM1363 45242002
*                                                                       45248000
         TM    DCBMACR,DCBMEXCP         IS ACCESS METHOD EXCP           45256000
         BO    OIN21350                 YES, CANNOT BE AN ACB    YM3073 45264002
*                                                                       45272000
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB         45280000
         BZ    OIN21400                 NO, TAKE NORMAL DCB PATH        45288000
*                                                                       45296000
         TM    DCBMACR,ACBMJEP          IS THIS A SUBSYSTEM ACB  YM1363 45304002
         BO    OIN21400                 YES, VALID ACB                  45312000
*                                                                       45320000
         TM    TIOELINK,TIOTSPOL        IS THIS A SPOOLED ACB           45328000
         BM    OIN21400                 YES, VALID ACB                  45336000
*                                                                       45344000
         B     OIN20350                 BYPASS INVALID ACB, BUSY Y02134 45352002
*                                       BIT OFF - NO WORK AREA          45360000
*                                                                YM3073 45362002
OIN21350 EQU   *                        TEST FOR EXCP & SPOOL    YM3073 45364002
*                                                                YM3073 45366002
         TM    TIOELINK,TIOTSPOL        IS THIS A SPOOLED DCB    YM3073 45366402
         BNM   OIN21400                 NO, OPENJ EXCP DCB       YM3073 45366802
*                                                                YM3073 45367202
*****************************************************************YM3073 45367402
*                                                                YM3073 45367502
*   WRITE  'IEC132I DDNAMEXX, MACRF=E WAS SPECIFIED FOR          YM3073 45369502
*   A SYSIN OR SYSOUT DATA SET' ERROR MESSAGE                    YM3073 45369902
*                                                                YM3073 45370002
*****************************************************************YM3073 45370102
*                                                                YM3073 45370302
         LR    R1,RCORE                 MSG ADDR FOR WTO         YM3073 45370702
         MVC   0(OIN2500N,R1),OIN2500M  MOVE MSG TO WORKAREA     YM3073 45371102
         MVC   K12(L'DCBDDNAM,R1),DCBDDNAM MOVE DDNAME TO MSG    YM3073 45371202
         WTO   MF=(E,(1))               WRITE MSG TO PROGRAMMER  YM3073 45371302
         B     OIN20350                 BYPASS OPEN              YM3073 45372802
*                                                                       45373502
*                                                                       45400021
*  THIS DCB IS OPENABLE                                          Y02082 45400402
*  INITIALIZE CONTROL BLOCKS IN MAIN WORK AREA.                         45800021
*                                                                       46000021
OIN21400 EQU   *                        INITIALIZE TO PROCESS OPEN      46200002
         LR    RF,RTIOT                 CALC TIOT DD ENTRY OFFSET FROM  46400021
         SR    RF,RET                   START OF TIOT                   46600021
         STH   RF,DCBTIOT               STORE TIOT OFFSET IN DCB        46800021
         MVC   DCBMACRF,DCBMACR         MOVE MACRF                      47000021
         OI    DCBOFLGS,DCBOBUSY        SET DCB BUSY BIT ON             47600021
         LR    RD,RCORE                 SET OPEN GO SWITCH ON    Y02080 47800002
*                                                                       48000021
         ST    RCORE,DCBDEBAD           SAVE CORE ADDR IN DCB DEB SLOT  48800021
         MVC   DCBIFLGS,DCBIFLG         MOVE IN IOS FLAGS               49000021
         IECRES INIT,DCBCOPY=FRWKAR,STM=(0,14,WTGPREFX) UPDATE   YM5702*49050002
                                        THE USER'S DCB           YM5702 49100002
*                                                                       49600021
*        CONSTRUCT CONTROL BLOCKS TO READ JFCB                          49800021
*                                                                       50000021
*        DEB, FIRST 36-BYTE                                             50200021
*                                                                       50400021
         L     RB,CVTPTR                LOAD ADDR OF CVT         Y02134 50450002
         L     R1,CVTSVDCB-CVT(,RB)     ADDRESS OF SVCLIB DCB    Y02080 50600002
         L     R1,DCBDEBAD-IHADCB(,R1)  ADDR OF TASK SCHEDULER DEB      50800021
         MVC   DXDEB(K48),K0(R1)        COPY TASK SCHEDULER DEB         51000002
         MVI   DXDEB+(DEBNMEXT-DEBBASIC),K1 SET NO. EXTENT TO 1 YA03003 51010002
         MVC   DXDEBAPP,CVTXAPG-CVT(RB) SET DUMMY APP VEC TBL    Y02080 51050002
         MVI   DXDEBMOD,K0              SET FILE MASK TO ZERO    YM6841 51060002
         XC    DXDEBECB+K1(K3),DXDEBECB+K1  ZERO PURGE ECB ADDR  M0032  51100021
         LA    RF,DXDCB                 STORE ADDR OF WORK DCB IN WORK  51200021
         ST    RF,DXDCBAD               DEB FOR EXCP VALIDITY CHECK     51400021
         ST    RF,IOBWGHT               STORE WORK DCB ADDR IN IOB      51600021
         MVI   DXDEBID,DEBIDENT         DEB ID                          51800021
*                                                                       52000021
*        ECB, NEXT 4-BYTE                                               52200021
*                                                                       52400021
         MVI   DXECB,K32                POST JFCB MOVE                  52720000
*                                                                       52800021
*        DCB, NEXT 8-BYTE                                               53000021
*                                                                       53200021
         LA    RF,DXDEB                 STORE ADDR OF WORK DEB IN WORK  53400021
         ST    RF,DXDCBDEB              DCB FOR EXCP VALIDITY CHECK     53600021
*                                                                       53800021
*        IOB, NEXT 32-BYTE                                              54000021
*                                                                       54200021
         MVI   IOBFLAG1,IOBUNREL        MAKE I/O REQUESTS UNRELATED     54400021
         LA    RF,DXECB                 STORE ADDR OF WORK ECB IN       54600021
         ST    RF,IOBECBPT              WORK IOB                        54800021
         LA    RF,DXCCW1                STORE START CCW ADDR IN         55000021
         ST    RF,IOBSTART-K1           WORK IOB                        55200021
*                                                                       55400021
         TM    DCBMACR,DCBMEXCP         IS ACCESS METHOD EXCP           60024000
         BO    OIN21450                 YES  NORMAL PROCESSING          60032000
*                                                                       60040000
         TM    DCBDSORG+K1,ACBDORGA     IS CONTROL BLOCK AN ACB         60048000
         BZ    OIN21450                 NO  NORMAL PROCESSING           60056000
*                                                                       60064000
         TM    TIOELINK,TIOTSPOL        IS THIS A SPOOLED ACB           60072000
         BZ    OIN21450                 NO  NORMAL PROCESSING           60080000
         USING IFGACB,RACB              DEFINE BASE FOR ACB             60088000
*                                                                       60096000
         L     RF,ACBUJFCB              LOAD ADDRESS OF JFCB     X02050 60104000
         LTR   RF,RF                    VALID ADDRESS                   60120000
         BZ    OIN22400                 NO  POST JFCB ERROR             60128000
         LA    RC,OIN21447              BR                       Y02082 60128402
*  OBTAIN LOCAL LOCK TO LOCK OUT GET/FREEMAINS; ENSURE JFCB IS INY02082 60128802
*  USER KEY, AND DO MOVE IN KEY ZERO.                            Y02082 60129202
OIN21435 EQU   *                        COPY JFCB                Y02082 60129602
         LR    RET,RF                   SAVE USER JFCB ADDR      Y02082 60130002
         L     RF,WTGPREFX              GET WTG PREFIX ADDR      Y02082 60130402
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS            Y02082 60130802
         MODESET EXTKEY=ZERO            SETLOCK KEY              Y02082 60131202
OIN21440 EQU   *                        SETLOCK                  Y02082 60131602
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND, GET LOCK         Y02082*60132002
               RELATED=(FREEMAIN,IGC0002B(OIN21445))             Y02082 60132402
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 60132802
         MODESET KEYADDR=DXUKEY,WORKREG=11 ASSUME USER KEY       Y02082 60133202
         OC    K0(L'DXJBF,RET),K0(RET)  TOUCH USER'S JFCB        Y02082 60133602
         MODESET EXTKEY=ZERO            ASSUME KEY O             Y02082 60134002
         MVC   DXJBF,K0(RET)            MOVE USER JFCB           Y02082 60134402
OIN21445 EQU   *                        RELEASE SETLOCK          Y02082 60135202
         SETLOCK RELEASE,TYPE=LOCAL,    RELEASE LOCK             Y02082*60135602
               RELATED=(FREEMAIN,IGC0002B(OIN21140))             Y02082 60136002
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS         Y02082 60136402
         MODESET EXTKEY=DATAMGT         RESTORE DM KEY           Y02082 60136802
         TM    JFCBMASK+K6,JFCTRACE     IS TRACE ROUTINE DESIRED?       60136902
         BZR   RC                       NO, RETURN TO COMPLETE PROCESS  60137102
         OI    WTGPATHS+K1,WTGTRACE     YES, SET TRACE INDR ON          60142802
         BR    RC                       RETURN                   Y02082 60144602
OIN21447 EQU   *                        ERROR                    Y02082 60148302
         B     OIN22780                 BYPASS NORMAL PROCESSING        60152002
*                                                                       60160000
         USING IHADCB,RDCB              DEFINE BASE TO USER'S DCB       60168000
OIN21450 EQU   *                        COPY JFCB FROM USER             60176002
*                                                                       60200021
*********************************************************************** 60400021
*                                                                       60600021
*  LOCATE AND MOVE THE JFCB FROM THE AREA POINTED TO BY THE DCB         60800021
*  EXIT LIST X'07' ENTRY TO THE DCB MAIN WORK AREA.                     61000021
*                                                                       61200021
         TM    DCBMACRF,DCBMEXCP        CHECK FOR EXCP                  61400021
         BNO   OIN22000                 BR IF NO                        61600021
         TM    DCBMACRF,DCBMFOUN        CHECK FOR FOUNDATION ENTENSION  61800021
         BNO   OIN22400                 BR IF NO                        62000021
*                                                                       62200021
OIN22000 EQU   *                        VALIDITY CHECK EXIT LIST        62400002
         CLC   DCBEXLST+K1(K3),OIN2570K  IS EXIT LIST ADDR 0 OR 1       62600021
         BNH   OIN22400                 BR IF NO EXIT LIST              62800021
         L     RF,DCBEXLST              PICK UP ADDR OF EXIT LIST       63000021
         MODESET KEYADDR=DXUKEY,WORKREG=1 USER KEY FOR EXITLIST  Y02082 63000402
*                                                                       63200021
OIN22200 EQU   *                        CHECK FOR OPEN J ENTRY          63400002
         CLI   0(RF),XLRDJFCB           CHECK FOR JFCB ADDR ENTRY       63600021
         BE    OIN22600                 BR IF FOUND                     63800021
         CLI   0(RF),XLRDJFCB+LASTNTRY  CHECK FOR JFCB ADDR ENTRY       64000021
         BE    OIN22600                 BR IF FOUND                     64200021
*                                                                       64400021
         TM    K0(RF),LASTNTRY          CHECK FOR LAST ENTRY            64600002
         LA    RF,K4(RF)                ADVANCE TO NEXT ENTRY           64800021
         BNO   OIN22200                 BR IF MORE ENTRIES       Y02080 65000002
*                                                                       65200021
OIN22400 EQU   *                        SET OFF JFCB ERROR              65400002
         MODESET EXTKEY=DATAMGT         DM KEY                   Y02082 65400402
         MVI   DXECB,ECBCOD7F-ECBNOERR  'POST' ECB WITH 'ERROR' CODE    65600021
         B     OIN22780                 BR TO ABEND IN NEXT MODULE      65800002
*                                                                       66000021
OIN22600 EQU   *                        CONTINUE                        66200002
         L     RF,0(RF)                 GET JFCB ADDR FROM EXIT LIST    66400021
         MODESET EXTKEY=DATAMGT         RET TO OPEN KEY FOR SWAP Y02082 66400102
         BAL   RC,OIN21435              MOVE USER JFCB           Y02082 66400402
         EJECT                                                          66403402
*                                                                       66403837
*********************************************************************** 66403937
*                                                                       66404137
*        IN ORDER TO AVOID ALLOWING THE DATA SET                        66404237
*        TO BE SCRATCHED WHILE IT IS OPEN                               66404337
*        ENQ ON DATA SET NAME BEING OPENED IF 1) - 4) ARE TRUE   YM5388 66404437
*        1) SYSTEM JFCB EXISTS                                   YM5388 66404602
*        2) DATA SET NAME DIFFERENT THAN SYSTEM JFCB'S           YM5388 66405202
*        3) DIRECT ACCESS DEVICE                                 YM5388 66405802
*        4) NOT ACB OPEN                                         YM5388 66406402
*                                                                       66407002
*********************************************************************** 66407437
*                                                                Y02082 66407537
         L     RF,DXUCBADR              GET UCB ADDRESS          Y02082 66418402
         LTR   RF,RF                    IS THERE ONE             Y02082 66421402
         BZ    OIN22700                 BR IF NO                 Y02082 66424402
         TM    UCBTBYT3-UCBOB(RF),UCB3DACC  IS IT DIRECT ACCESS  Y02082 66427402
         BZ    OIN22700                 BR IF NO                 Y02082 66430402
         TM    DCBMACRF,DCBMEXCP        CHECK FOR EXCP           Y02082 66433402
         BO    OIN22605                 BRANCH IF YES            Y02082 66436402
         TM    DCBDSRG2,ACBDORGA        IS IT ACB                Y02082 66439402
         BO    OIN22700                 BRANCH IF YES            Y02082 66442202
OIN22605 EQU   *                        ENQ DSNAME               Y02082 66452602
         XR    RB,RB                    ZERO FOR ICM             YM5388 66455537
         ICM   RB,B'0111',TIOEJFCB      GET SYSTEM JFCB ADDRESS  YM5388 66455637
         BZ    OIN22780                 BRANCH IF ZERO - SKIP    YM5388X66455737
                                        JFCB PROCESSING          YM5388 66455837
         LA    RB,TIOEJFCB              LOAD ADDR OF JFCB ADDR   YM5388 66455937
         IECRES LOCJFCB,(RB)            LOCATE SYSTEM JFCB       YM5388 66456037
         CLC   JFCBDSNM,JFCBDSNM-INFMJFCB(RB) ARE DSNAMES EQUAL  YM5388 66456137
         BE    OIN22700                 SKIP ENQ IF YES          YM5388 66456237
         CLC   JFCBDSNM,VTOCNAME        TEST IF F4 DSCB NAME     YM6549 66456337
         BE    OIN22700                 SKIP ENQ IF YES          YM6549 66456437
         L     RF,WTGPREFX              POINT TO SAVE AREA     @ZA10275 66456537
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS          @ZA10275 66456637
         TESTAUTH FCTN=1,KEY=YES,BRANCH=YES AUTHORIZED CALLER  @ZA10275 66456737
         LTR   RF,RF                    TEST FOR AUTHORZTN     @ZA10275 66456837
         L     RF,WTGPREFX              LOAD SAVE AREA POINTER @ZA10275 66456937
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS       @ZA10275 66457037
         BZ    OIN22700                 BYPASS ENQ             @ZA10275 66457137
*                                                                       66457237
*********************************************************************** 66457337
*                                                                       66457437
*        IF UPDATING DSNAME, ISSUE ENQ IF                               66457537
*        1) NEW DATA SET NAME WILL REPLACE OLD DSNAME                   66457637
*        2) OLD DATA SET IS NOT CURRENTLY OPEN                          66457737
*                                                                       66457837
*        IF NOT UPDATING DSNAME DYNAMICALLY                             66457937
*        ALLOCATE THE DATA SET                                          66458037
*                                                                       66458137
*********************************************************************** 66458237
*                                                                       66458337
         TM    JFCBTSDM,JFCNWRIT        INHIBIT JFCB UPDATE    @ZA02193 66458437
         BO    OIN22650                 BRANCH TO ALLOCATE     @ZA02193 66458537
         EJECT                                                          66458637
*                                                                       66458737
*********************************************************************** 66458837
*                                                                Y02082 66458937
*        ENQ SHARED IF DISP=SHR                                  YM5388 66459337
*        ENQ EXCLUSIVE OTHERWISE                                 YM5388 66459737
*                                                                       66459837
*        ENQ IS DONE BY DYNAMIC ALLOCATION                              66459937
*                                                                       66460037
*        MAJOR NAME - SYSDSN                                     YM5388 66460137
*        MINOR NAME - DATASET NAME WITH TRAILING BLANKS STRIPPED YM5388 66460237
*                                                                       66460637
*********************************************************************** 66461337
*                                                                       66461837
*        GET NUMBER OF NON-BLANK CHARACTERS IN DATASET NAME      YM2881 66461937
*                                                                       66462037
         LA    RB,JFCBDSNM+L'JFCBDSNM-K1 LAST BYTE OF DSNAME     YM2881 66462137
OIN22607 EQU   *                        SEARCH FOR NON-BLANK     YM2881 66462237
         CLI   K0(RB),C' '              IS THIS ONE BLANK        YM2881 66462337
         BNE   OIN22608                 BR IF NO TO COMPUTE      YM2881 66462437
*                                       LENGTH OF NAME           YM2881 66462537
         BCT   RB,OIN22607              TRY NEXT BYTE            YM2881 66462637
OIN22608 EQU   *                        CALCULATE LENGTH         YM2881 66462737
         LA    RC,JFCBDSNM-K1           BYTE PRECEDING DSNAME    YM2881 66462837
         SR    RB,RC                    RB HAS LENGTH FOR ENQ    YM2881 66462937
         EJECT                                                          66463037
*                                                                       66463137
*********************************************************************** 66463237
*                                                                       66463337
*        SETUP PARMLIST FOR IEFAB4DC                                    66463437
*                                                                       66463537
*********************************************************************** 66463637
*                                                                       66463737
SCHED    EQU   X'01'                    KEY 1 FOR IEFAB4DC     @ZA00118 66463837
         IECRES GET,LV=QLENGTH,KEY=SCHED, GET IEFAB4DC PRMLST  @OZ00118X66463937
               PREFIX=YES,ID=DSN,                              @OZ00118X66464037
               STM=(R2,RET,WTGPREFX)                           @OZ00118 66464137
         USING QSYSDSN,R1               PARMLIST BASE          @ZA00118 66464237
         LA    RF,JCTPTR                GET JCT POINTER        @ZA08282 66464337
         ST    RF,QMPARMS               SAVE IN PARM LIST      @ZA08282 66464437
         LA    RF,JCTADDR               GET JCT ADDRESS        @ZA08282 66464537
         ST    RF,JCTPTR                SAVE IN JCT POINTER    @ZA08282 66464637
         ST    RF,QJCT                  SAVE IN PARM LIST      @ZA08282 66464737
         LA    RF,RLCONST               GET POINTER TO RL      @ZA08282 66464837
         ST    RF,RLPTR                 SAVE IN RL POINTER     @ZA08282 66464937
         L     RF,DXJSCBAD              LOAD JSCB POINTER      @ZA08282 66465037
         L     R0,JSCBJCT-IEZJSCB(,RF)  POINT TO JCT PTR       @ZA08282 66465137
         SLL   R0,K8(0)                 SHIFT TO HI ORDER BYTE @ZA08282 66465237
         ST    R0,JCTPFIX               SAVE IN PARM LIST      @ZA08282 66465337
         MVC   RLCONST,RL               LOAD RL CONSTANT       @ZA08282 66465437
         MVC   B0CONST,B0               LOAD B0 CONSTANT       @ZA08282 66465537
         LR    R0,R1                    SAVE WORK AREA PTR     @ZA08282 66465637
         ST    RD,SAVEAREA+K4           SAVE SWITCH            @ZA08282 66465737
         LA    RD,SAVEAREA              LOAD SAVE AREA         @ZA08282 66465837
         LA    R1,QMPARMS               LOAD PTR FOR Q MNGR    @ZA08282 66465937
         L     RF,CVTPTR(,0)            GET CVT ADDRESS        @ZA08282 66466037
         L     RF,CVTJESCT-CVT(,RF)     GET JESCT ADDRESS      @ZA08282 66466137
         L     RF,K8(,RF)               GET QMNGIO ADDRESS     @ZA08282 66466237
         MODESET EXTKEY=ZERO            KEY ZERO FOR Q MANAGER @ZA08282 66466337
         BALR  RET,RF                                          @ZA08282 66466437
         LR    R1,R0                    RESTORE REQ 1          @ZA08282 66466537
         STH   RB,DSNLEN                SAVE LENGTH            @ZA00118 66466637
         L     RD,SAVEAREA+K4           RESTORE SAVE AREA PTR  @ZA08282 66466737
         MVC   DSNAME,JFCBDSNM          SET UP DSN FOR ENQ     @ZA00118 66466837
         LA    RF,DSRRFMAP              GET POINTER            @ZA00118 66466937
         ST    RF,QDSRRF                SAVE IN PARM LIST      @ZA00118 66467037
         MVC   DSRRFMAP,DSRRFBIT        INIT DSRRFMAP          @ZA00118 66467137
         L     RF,DXJSCBAD              LOAD JSCB POINTER      @ZA00118 66467237
         LA    R0,JSCBTCBP-IEZJSCB(,RF) INITIATOR TCB POINTER  @ZA00118 66467337
         LA    RF,JSCBSTEP-IEZJSCB(,RF) GET STEP POINTER       @ZA08282 66467437
         ST    RF,QSTEPNUM              SAVE IN PARM LIST      @ZA08282 66467537
         LA    RF,DSNLEN                POINT TO DSNAME        @ZA00118 66467637
         ST    RF,QDSNP                 SAVE IN PARMLIST       @ZA00118 66467737
         ST    R0,QTCB                  SAVE IN PARM LIST      @ZA00118 66467837
         LA    RF,ALFNCMAP              POINT AT ALFNCMAP      @ZA00118 66467937
         ST    RF,QALFNC                SAVE IN PARM LIST      @ZA00118 66468037
         MVC   ALFNCMAP,ALFNCBIT        INIT ALFNCMAP          @ZA00118 66468137
         LA    RF,QRETCODE              POINT TO RET CODE      @ZA00118 66468237
         ST    RF,QRET                  SAVE IN PARM LIST      @ZA00118 66468337
         L     RF,DXTCBADR              LOAD TCB ADDRESS       @ZA00118 66468437
         LA    RF,TCBTIO-TCB(,RF)       POINT TO TIOT PTR      @ZA00118 66468537
         ST    RF,QMSGPARM              SAVE IN PARM LIST      @ZA00118 66468637
         EJECT                                                          66468737
*                                                                       66468837
*********************************************************************** 66468937
*                                                                       66469037
*        CHECK FOR SHARE ENQ OR EXCLUSIVE                               66469137
*                                                                       66469237
*********************************************************************** 66469337
*                                                                       66469437
         TM    JFCBIND2,JFCSHARE        IS DISP SHR              YM5388 66469537
         BO    OIN22610                 ENQ SHR IF YES         @ZA00118 66469637
*                                                                       66469737
*********************************************************************** 66469837
*                                                                       66469937
         OI    DSRRFMAP,ENQEXCL         INDICATE EXCLUSIVE ENQ @ZA00118 66470137
         OI    ALFNCMAP+K6,NQEXCLSW     INDICATE EXCLUSIVE ENQ @ZA00118 66470337
         B     OIN22615                 GOTO IEFAB4DC          @ZA00118 66470537
*                                                                       66470937
OIN22610 EQU   *                        SETUP FOR ENQ SHR      @ZA00118 66471137
*                                                                       66471337
         OI    DSRRFMAP,ENQSHR          INDICATE SHARED ENQ    @ZA00118 66471437
*                                                                       66471737
OIN22615 EQU   *                        GOTO IEFAB4DC          @ZA00118 66471937
*                                                                       66472637
         ST    RD,SAVEAREA+K4           SAVE SWITCH            @ZA00118 66473637
         MODESET EXTKEY=ZERO            KEY ZERO FOR IFG019RA  @ZA00118 66474437
         LA    RD,SAVEAREA              LOAD SAVE AREA         @ZA00118 66474537
         IECRES LOAD,MODNM=IEFAB4DC,BRCODE=OIN22620, IEFAB4DC  @ZA00118X66474637
               PREFIX=WTGPREFX,BRANCH=DIRECT                            66474737
         EJECT                                                          66476337
*                                                                       66476537
*********************************************************************** 66476937
*                                                                       66477937
*        RETURN FROM IEFAB4DC                                           66478037
*                                                                       66478137
*********************************************************************** 66478437
*                                                                       66478737
OIN22620 EQU   *                        RETURN FROM IEFAB4DC   @ZA00118 66479037
*                                                                       66479337
         MODESET EXTKEY=DATAMGT         OPEN KEY               @ZA00118 66479637
         IECRES LOAD,MODNM=OPENJ,BRANCH=NO,PREFIX=WTGPREFX     @ZA00118 66479937
         XC    WTGMODEP,WTGMODEP        CLEAR ADDRESS          @ZA00118 66480137
         L     RD,SAVEAREA+K4           RESTORE RD             @ZA00118 66480337
         CLC   QRETCODE,ZEROS           CHECK RETURN CODE      @ZA10558 66480537
         BNE   OIN22630                 BRANCH IF ERROR        @ZA10558 66480737
*                                                                       66481137
         LH    RB,DSNLEN                LOAD DSN LENGTH (ENQ)  @ZA00118 66481237
         LA    RC,JFCBDSNM              RCORE DSN FOR ENQ      @ZA00118 66481337
         DROP  R1                                                       66481437
         IECRES FREE,PREFIX=YES,A=(1),STM=(R0,RET,WTGPREFX)    @ZA00118 66481537
*                                                                       66481637
         EJECT                                                          66483237
*                                                                       66483337
*********************************************************************** 66483437
*                                                                       66483537
*        SYSZOPEN ENQ FOR SCRATCH PROTECTION                            66483737
*                                                                       66483837
*********************************************************************** 66483937
*                                                                       66484237
         LA    RB,TIOEJFCB              LOAD ADDR OF JFCB ADDR @ZA00118 66485337
         IECRES LOCJFCB,(RB)            LOCATE SYSTEM JFCB     @ZA00118 66485437
*                                                                       66485537
*        GET NUMBER OF NON-BLANK CHARACTERS IN DATASET NAME             66485637
*                                                                       66485737
         LA    RC,JFCBDSNM-INFMJFCB(,RB) SAVE DSN POINTER      @ZA00118 66485837
         BCTR  RC,K0                    BYTE PRECEDING DSN     @ZA00118 66485937
         LA    RB,JFCBDSNM-INFMJFCB+L'JFCBDSNM-K1(,RB) END DSN @ZA00118 66486037
*                                                                       66486137
OIN22622 EQU   *                        SEARCH FOR NON-BLANK   @ZA00118 66486237
*                                                                       66486337
         CLI   K0(RB),C' '              IS THIS ONE BLANK      @ZA00118 66486437
         BNE   OIN22623                 BR IF NO TO COMPUTE    @ZA00118 66486537
*                                       LENGTH OF NAME         @ZA00118 66486637
         BCT   RB,OIN22622              TRY NEXT BYTE          @ZA00118 66486737
*                                                                       66486837
OIN22623 EQU   *                        CALCULATE LENGTH       @ZA00118 66486937
*                                                                       66487037
         SR    RB,RC                    RB HAS LENGTH FOR ENQ  @ZA00118 66487137
         LA    RC,JFCBDSNM-INFMJFCB+K1(,RC) DSNAME FOR ENQ     @ZA00118 66487237
*                                                                       66487737
OIN22625 EQU   *                        ENQ ON SYSZOPEN        @ZA00118 66487837
*                                                                       66488037
* SYSZOPEN PREVENTS UNALLOCATION OF OPEN DATA SETS                      66488237
*                                                                       66488337
         MVC   DXWORK(L'ENQLIST),ENQLIST INIT ENQ LIST         @ZA00118 66488437
         L     RF,DXJSCBAD              LOAD JSCB ADDRESS      @ZA00118 66489037
         L     R0,JSCBTCBP-IEZJSCB(,RF) INITIATOR TCB POINTER  @ZA00118 66490737
         ENQ   (SYSZOPEN,(RC),,(RB)),   TCB ENQ EXCLUSIVE      @ZA00118X66495737
               TCB=(R0),RET=USE,MF=(E,DXWORK1),                @ZA00118X66496737
               RELATED=(SYSZOPEN,IFG0202K(SYSZOPEN))           @ZA00118 66500737
*                                                                       66505737
         LTR   RF,RF                    DSNAME ALREADY IN USE  @ZA00118 66510737
         BZ    OIN22640                 BRANCH IF NO ERROR     @ZA02193 66515737
*                                                                       66520737
         CLI   K3(RF),K8                TASK ALREADY ENQD      @ZA00118 66525737
         BE    OIN22640                 BRANCH TO CONTINUE     @ZA02193 66530737
*                                                                       66531737
OIN22630 EQU   *                        ISSUE 913 ABEND        @ZA00118 66532737
*                                                                       66533737
OABD140  EQU   140                      PD INTERNAL ABEND CODE @ZA00118 66534737
         LA    R0,OABD140               913 ABEND INDICATOR    @ZA00118 66535737
         ST    R0,DXREG0                SAVE ERROR CODE        @ZA00118 66540737
         B     OIN20400                 BRANCH, PROCESS ERROR  @ZA00118 66545737
         EJECT                                                          66547737
*                                                                       66549737
OIN22640 EQU   *                        UPDATE JFCB WITH DSN   @ZA02193 66551737
*                                                                       66553737
*        SAVE FIRST 100 BYTES PASSED DSNAME                    @ZA02193 66554137
         MVC   FORCORE(INFMJFCB-FORCORE),INFMJFCB+L'JFCBDSNM 1 @ZA02193 66555737
*        SAVE LAST 32 BYTES IN CCWS 1-4                        @ZA02193 66559737
         MVC   DXCCW1(K32),INFMJFCB+L'JFCBDSNM+INFMJFCB-FORCORE         66561737
*                                                                       66563737
*        MOVE SYSTEM JFCB TO WORK AREA                         @ZA02193 66565737
         MVC   INFMJFCB+L'JFCBDSNM(JFCBLGTH-L'JFCBDSNM),L'JFCBDSNM(RC)  66567737
*                                                                       66569737
*        UPDATE SYSTEM JFCB WITH NEW DATA SET NAME             @ZA02193 66571737
         LA    R1,TIOEJFCB              POINT TO SYS JFCB      @ZA02193 66573737
         LA    R0,INFMJFCB              POINT TO NEW JFCB      @ZA02193 66575737
         IECRES WRJFCB,(R1),(R0)        UPDATE DSNAME          @ZA02193 66577737
*                                                                       66579737
*        RESTORE JFCB                                          @ZA02193 66581737
         MVC   INFMJFCB+L'JFCBDSNM(INFMJFCB-FORCORE),FORCORE 1 @ZA02193 66583737
         MVC   INFMJFCB+L'JFCBDSNM+INFMJFCB-FORCORE(K32),DXCCW1 2       66585737
         XC    FORCORE(INFMJFCB-FORCORE),FORCORE CLEAR 1       @ZA02193 66587737
         XC    DXCCW1(K32),DXCCW1       CLEAR 2                @ZA02193 66589737
         B     OIN22700                 CONTINUE OPEN          @ZA02193 66591737
         EJECT                                                          66603802
*                                                                       66605837
OIN22650 EQU   *                        DYNAMIC ALLOCATION     @ZA02193 66607237
*                                                                       66607637
*********************************************************************** 66608037
*                                                                       66608437
*        DYNAMICALLY ALLOCATE                                           66608537
*                                                                       66609037
* //SYSDDN DD DSN=JFCBDSNM,DISP=OLD/SHR,UNIT=UCBNAME,VOL=SER=UCBVOLI    66609437
*                                                                       66609637
*********************************************************************** 66609737
*                                                                       66611737
         L     RF,WTGPREFX              POINT TO SAVE AREA     @ZA02193 66612137
         STM   R0,RET,IECREGSV-IECPREFX(RF) SAVE REGS          @ZA02193 66612537
         TESTAUTH FCTN=1,KEY=YES,BRANCH=YES AUTHORIZED CALLER  @ZA02193 66612937
         LTR   RF,RF                    TEST FOR AUTHORZTN     @ZA02193 66613337
         L     RF,WTGPREFX              LOAD SAVE AREA POINTER @ZA02193 66613437
         LM    R0,RET,IECREGSV-IECPREFX(RF) RESTORE REGS       @ZA02193 66613537
         BZ    OIN22700                 BYPASS ALLOC           @ZA02193 66613637
*                                                                       66614337
*        SET UP PARMLIST FOR SVC 99 DYNAMIC ALLOCATION                  66614737
*                                                                       66614837
         XC    DXXCTL(OPNJDLEN),DXXCTL  CLEAR PARM LIST        @ZA02193 66614937
         XC    FORCORE(JFCBDSNM-FORCORE),FORCORE CLEAR TEXT    @ZA02193 66615037
         LA    R1,DXXCTL                PARM LIST              @ZA02193 66615137
         USING OPNJDYNA,R1              R1 PTR TO PARM WORD    @ZA02193 66615237
         LA    RF,PARMS                 POINT TO PARM LIST     @ZA02193 66615337
         ST    RF,DAPTR                 R1 -> DAPTR -> PARMS   @ZA02193 66615437
         OI    DAPTR,LASTNTRY           SET LAST IN LIST       @ZA02193 66615837
         MVC   PARMS(L'DYNPRM1),DYNPRM1 SET UP LIST            @ZA02193 66617437
         LA    RF,FORCORE               POINT TO TEXT UNITS    @ZA02193 66617837
         ST    RF,TXTPP                 TXTPP -> TEXT UNITS    @ZA02193 66618237
         MVI   FLAGS21,DYNEQU           SET FLAGS              @ZA02193 66618637
*                                                                       66618737
         LA    R1,FORCORE               POINT TO TEXT UNITS    @ZA02193 66619437
         USING TEXTUNIT,R1              TEXT UNIT POINTER      @ZA02193 66619537
         LA    RF,UNIT1                 POINT TO DDNAME UNIT   @ZA02193 66619637
         ST    RF,TEXTU1                UNIT 1 POINTER         @ZA02193 66619737
         LA    RF,UNIT2                 POINT TO FREE=CLOSE    @ZA02193 66619837
         ST    RF,TEXTU2                UNIT 2 POINTER         @ZA02193 66619937
         LA    RF,UNIT3                 POINT TO DISP UNIT     @ZA02193 66620037
         ST    RF,TEXTU3                UNIT 3 POINTER         @ZA02193 66620437
         LA    RF,UNIT4                 POINT TO VOL=SER UNIT  @ZA02193 66620537
         ST    RF,TEXTU4                UNIT 4 POINTER         @ZA02193 66620637
         LA    RF,UNIT5                 POINT TO UNIT= UNIT    @ZA02193 66620837
         ST    RF,TEXTU5                UNIT 5 POINTER         @ZA02193 66620937
         LA    RF,UNIT6                 POINT TO DSNAME UNIT   @ZA02193 66621037
         ST    RF,TEXTU6                UNIT 6 POINTER         @ZA02193 66621137
         OI    TEXTU6,LASTNTRY          IND LAST IN LIST       @ZA02193 66623137
*                                                                       66623537
*        SET UP TEXT UNITS                                              66623937
*                                                                       66624337
         MVC   UNIT1(L'DYNU1),DYNU1     DDNAME RETURN PARMS    @ZA02193 66624737
         MVC   UNIT2(L'DYNU2),DYNU2     FREE=CLOSE PARMS       @ZA02193 66624837
         MVC   UNIT3(L'DYNU3),DYNU3     DISP= PARMS            @ZA02193 66624937
         MVC   UNIT4(L'DYNU4),DYNU4     VOL=SER PARMS          @ZA02193 66625037
         MVC   UNIT5(L'DYNU5),DYNU5     UNIT= PARMS            @ZA02193 66625737
         MVC   UNIT6(L'DYNU6),DYNU6     DSNAME PARMS           @ZA02193 66626137
*                                                                       66626237
         MVI   U3PRM,U3SHR              SET TO DISP=SHR        @ZA02193 66626337
         TM    JFCBIND2,JFCSHARE        TEST FOR DISP=SHR      @ZA02193 66626537
         BO    OIN22665                 BRANCH IF DISP=SHR     @ZA02193 66626637
         MVI   U3PRM,U3OLD              SET TO DISP=OLD        @ZA02193 66626737
*                                                                       66626837
OIN22665 EQU   *                        SET UP VOL=SER         @ZA02193 66628837
*                                                                       66629237
         L     RF,DXUCBADR              LOAD UCB ADDRESS       @ZA02193 66629337
         MVC   U4PRM(L'UCBVOLI),UCBVOLI-UCBOB(RF) VOL=UCBVOLI  @ZA02193 66629637
         MVC   U5PRM(L'UCBNAME),UCBNAME-UCBOB(RF) UNIT=UCBNAME @ZA02193 66630037
*                                                                       66630437
*        GET NUMBER OF NON-BLANK CHARACTERS IN DATASET NAME             66630537
*                                                                       66630637
         LA    RB,JFCBDSNM+L'JFCBDSNM-K1 LAST BYTE OF DSNAME   @ZA02193 66630737
OIN22655 EQU   *                        SEARCH FOR NON-BLANK   @ZA02193 66631437
         CLI   K0(RB),C' '              IS THIS ONE BLANK      @ZA02193 66631837
         BNE   OIN22657                 BR IF NO TO COMPUTE    @ZA02193 66631937
*                                       LENGTH OF NAME         @ZA02193 66632037
         BCT   RB,OIN22655              TRY NEXT BYTE          @ZA02193 66632237
OIN22657 EQU   *                        CALCULATE LENGTH       @ZA02193 66632337
         LA    RC,JFCBDSNM-K1           BYTE PRECEDING DSNAME  @ZA02193 66632437
         SR    RB,RC                    RB HAS LENGTH FOR ENQ  @ZA02193 66632537
         STH   RB,U6LEN                 STORE DSNAME LENGTH    @ZA02193 66634937
*                                                                       66635037
         DROP  R1                                                       66635237
         LA    R1,DXXCTL                DYN ALLOC PRM LIST     @ZA02193 66636837
         DYNALLOC                       CALL DYNAMIC ALLOC     @ZA02193 66637037
         LTR   RF,RF                    TEST IF SUCCESS ALLOC  @ZA02193 66637237
         BNZ   OIN22695                 BRANCH IF NOT          @ZA02193 66637437
*                                                                       66637637
*        FIND ALLOCATED ENTRY                                           66637837
*                                                                       66638037
         LA    R1,FORCORE               POINT TO TEXT UNITS    @ZA02193 66638237
         USING TEXTUNIT,R1              TEXT UNITS             @ZA02193 66638437
         OC    U1PRM(L'TIOEDDNM),BLANKS FOLD ZEROS             @ZA02193 66638637
         L     RF,DXDSABQD              LOAD QDB ADDR          @ZA02193 66638837
         L     RF,QDBFELMP-QDB(,RF)     FIRST DSAB             @ZA02193 66639037
OIN22670 EQU   *                        FIND TIOT ENTRY        @ZA02193 66639237
         LTR   RF,RF                    TEST FOR LAST          @ZA02193 66639437
         BZ    OIN22695                 BRANCH IF NOT FOUND    @ZA02193 66639637
         L     RB,DSABTIOT-DSAB(,RF)    POINT AT TIOENTRY      @ZA02193 66639837
         CLC   TIOEDDNM-TIOENTRY(L'TIOEDDNM,RB),U1PRM DDNAMES  @ZA02193 66640037
         BE    OIN22675                 BRANCH IF FOUND        @ZA02193 66640237
         L     RF,DSABFCHN-DSAB(,RF)    LOAD NEXT DSAB         @ZA02193 66640637
         B     OIN22670                 LOOP TO CHECK NEXT     @ZA02193 66641037
*                                                                       66641437
OIN22675 EQU   *                        FOUND TIOENTRY         @ZA02193 66641837
*                                                                       66641937
         ST    RF,DXDSAB                SAVE DSAB PTR          @ZA02193 66642037
         XC    DXXCTL(OPNJDLEN),DXXCTL  CLEAR PARM LIST        @ZA02193 66642137
         XC    FORCORE(JFCBDSNM-FORCORE),FORCORE CLEAR TEXT    @ZA02193 66642237
         DROP  R1                                                       66642337
         B     OIN22701                 CONTINUE OPEN          @ZA15088 66645437
*                                                                       66645637
OIN22695 EQU   *                        ISSUE 913 ABEND        @ZA02193 66645837
*                                                                       66646037
         LA    R0,OABD140               913 ABEND INDICATOR    @ZA02193 66646237
         ST    R0,DXREG0                SAVE ERROR CODE        @ZA02193 66646437
         B     OIN20400                 BRANCH, PROCESS ERROR  @ZA02193 66646637
         EJECT                                                          66646837
OIN22700 EQU   *                        PASSWORD/DISP=NEW        Y02082 66647037
*****************************************************************Y02082 66648537
*                                                                Y02082 66650002
* THE FOLLOWING CODE TO LABEL ENDPSWD WAS INSERTED               Y02082 66700002
* TO SUPPORT THE OPENJ/PASSWORD BYPASS PROBLEM                   Y02082 66750002
*                                                                Y02082 66760002
*****************************************************************Y02082 66762002
         SR    R5,R5                    ZERO REGISTER            YM5358 66770002
         ICM   R5,B'0111',TIOEJFCB      GET SYSTEM JFCB ADDR     YM5358 66770402
         BZ    OIN22780                 IF ZERO,BYPASS JFCB PROC Y02082 66770502
*        LOCATE ACTUAL SYSTEM JFCB ADDRESS                       Y02082 66770602
         LA    R1,TIOEJFCB              POINT TO JFCB ADDR       Y02082 66770702
         IECRES LOCJFCB,(R1)                                     Y02082 66770802
         LR    R5,R1                    SAVE SYS JFCB ADDR       YM5358 66798002
         MVC   JFCBEXAD(L'JFCBEXAD),JFCBEXAD-DXJBF(R5) ENSURE    YM5358X66798102
                                        SYSTEM JFCB EXT USED     Y02082 66798202
*                                                                Y02134 66798602
*****************************************************************Y02134 66798702
*                                                                Y02134 66798802
*        VERIFY VOLUME SERIAL NUMBERS                            YM1363 66799002
*                                                                Y02134 66799702
*****************************************************************Y02134 66799902
*                                                                Y02134 66800102
OIN22701 EQU   *                                               @ZA15088 66800337
*                                                              @ZA15088 66800437
         L     RUCB,TIOESTTB            GET UCB ADDR           @ZA09633 66800537
         LA    RUCB,K0(,RUCB)           CLEAR HIGH ORDER BYTE  @ZA09633 66800637
         TM    UCBTBYT3-UCBOB(RUCB),UCB3DACC  CHK FOR DA       @ZA09633 66800737
         BO    OIN22710                 BR IF DA               @ZA09633 66800837
         CLC   JFCBVOLS,JFCBVOLS-INFMJFCB(R5) CHK VOLSERS        YM5358 66800937
         BE    OIN22710                 BRANCH IF SAME           Y02134 66801037
*                                                                Y02134 66801137
         MVI   JFCBNVOL,K0              INITIALIZE VOL COUNTER   YM1363 66801237
         LA    RB,JFCBVOLS-INFMJFCB(,R5) LOAD SYSTEM JFCB VOLS   YM5358 66801337
         LA    RC,JFCBVOLS              POINT TO FIRST VOL SER   Y02134 66801437
*                                                                Y02134 66801537
OIN22702 EQU   *                        LOOP FOR MORE VOL SERS   Y02134 66801637
*                                                                Y02134 66801702
         LA    RF,JFCBVOLS+L'UCBVOLI*K5 END OF VOL LIST          YM1363 66801902
         CR    RC,RF                    CHECK FOR END            YM1363 66802102
         BNL   OIN22710                 BRANCH IF MORE VOLS      YM1363 66802202
         CLI   JFCBVOLS-JFCBVOLS(RC),BLANK CHECK FOR NO VOL SER  YM1363 66802302
         BE    OIN22703                 BRANCH OUT IF BLANK      YM1363 66808302
         CLI   JFCBVOLS-JFCBVOLS(RC),CHAR00 CHECK FOR NO VOL SER YM1363 66808702
         BE    OIN22703                 BRANCH OUT IF BLANK      YM1363 66809902
         CLC   JFCBVOLS-JFCBVOLS(L'UCBVOLI,RC),JFCBVOLS-JFCBVOLS(RB)    66810002
         BE    OIN22708                 BRANCH IF OK             YM1363 66810102
         CLI   JFCBVOLS-JFCBVOLS(RC),VIRTUAL VIRTUAL VOLSER      YM1363 66810302
         BNE   OIN22704                 BRANCH IF NOT VIRTUAL    YM1363 66811502
*                                                                Y02134 66815502
OIN22703 EQU   *                        SET VOL SER TO BLANKS    Y02134 66816302
*                                                                Y02134 66817102
         MVC   JFCBVOLS-JFCBVOLS(L'UCBVOLI,RC),BLANKS SCRTCH REQ YM1363 66819502
         LA    R0,L'UCBVOLI(,RC)        POINT TO NEXT            YM1363 66820302
         CR    R0,RF                    CHECK FOR END            YM1363 66821102
         BE    OIN22710                 BRANCH OUT IF AT END     YM1363 66821602
         MVI   L'UCBVOLI(RC),BLANK      SET ALL VOLS TO SCRTCH   YM1363 66821702
         B     OIN22709                 PROCESS FURTHER          YM1373 66821902
*                                                                Y02134 66822702
OIN22704 EQU   *                        ENQ VOL SER              Y02134 66823502
*                                                                Y02134 66824302
         MVC   DXWORK1(K16),ENQLIST     INIT ENQ LIST            Y02134 66825102
         L     RF,DXJSCBAD              LOAD JSCB ADDRESS        Y02134 66825902
         L     R0,JSCBTCBP-IEZJSCB(,RF) INITIATOR TCB POINTER    Y02134 66826702
         ENQ   (,(RC)),TCB=(0),RET=USE,MF=(E,DXWORK2),           Y02134X66827502
               RELATED=(SYSZVOLS,IFG0194A(VUS02450))             Y02134 66828302
*                                                                Y02134 66829102
         LTR   RF,RF                    VOLUME ALREADY IN USE    Y02134 66829902
         BZ    OIN22708                 BRANCH IF NO ERROR       Y02134 66830702
*                                                                Y02134 66831502
         CLI   K3(RF),K8                SEE IF TASK HAS RESOURCE Y02134 66832302
         BE    OIN22708                 BRANCH IF ALREADY HELD   Y02134 66833102
         LA    R0,K1                    413-04 ABEND             YM1363 66833902
         ST    R0,DXREG0                SAVE ERROR CODE          Y02134 66834702
         B     OIN22780                 BRANCH TO PROCESS ERROR  Y02134 66835502
*                                                                Y02134 66836302
OIN22708 EQU   *                        INCREMENT VOL COUNT      YM1363 66837102
*                                                                Y02134 66837902
         XR    RF,RF                    CLEAR FOR IC INST        YM1363 66838202
         IC    RF,JFCBNVOL              GET VOL COUNT            YM1363 66838302
         LA    RF,K1(,RF)               INCREMENT COUNT BY 1     YM1363 66838402
         STC   RF,JFCBNVOL              SAVE COUNT               YM1363 66838502
*                                                                YM1363 66838602
OIN22709 EQU   *                        LOOP IF MORE VOLS        YM1363 66838902
*                                                                YM1363 66839002
         LA    RB,L'UCBVOLI(RB)         POINT TO NEXT VOL SER    YM1363 66839202
         LA    RC,L'UCBVOLI(RC)         POINT TO NEXT VOL SER    YM1363 66839302
         B     OIN22702                 LOOP FOR MORE VOLS       YM1363 66839502
         EJECT                                                          66840302
*                                                                Y02134 66841102
OIN22710 EQU   *                        VALIDITY CHECK JFCB      Y02134 66841902
*                                                                Y02134 66842702
         L     RUCB,TIOESTTB            GET UCB ADDR             Y02082 66843502
         LA    RUCB,K0(,RUCB)           CLEAR FOR LTR            Y02082 66844302
         LTR   RUCB,RUCB                IS THERE A UCB           Y02082 66845102
         BZ    OIN22780                 BRANCH IF NO             Y02082 66845902
         TM    UCBTBYT3-UCBOB(RUCB),UCB3DACC  CHK FOR DA         Y02082 66846702
         BNO   OIN22740                 BR IF NOT, CHK FOR TAPE  Y02082 66847502
         TM    JFCBIND2,JFCNEW          CHK USER JFCB FOR NEW    Y02082 66848302
         BNO   OIN22780                 BRANCH IF NO             Y02082 66849102
*        SET JFCBPWBP BIT IF USER MODIFIED DISPOSITION,          Y02082 66849902
*        DSNAME OR VOLSERS IN JFCB                               Y02082 66859902
         TM    JFCBIND2-INFMJFCB(R5),JFCNEW SYS JFCB DISP NEW    YM5358 66869902
         BNO   OIN22720                 NO, SET JFCBPWBP BIT     Y02082 66879902
         CLC   JFCBVOLS,JFCBVOLS-INFMJFCB(R5) CHK VOLSERS        YM5358 66889902
         BNE   OIN22720                 IF NOT SAME GO SET BIT   Y02082 66891902
         CLC   JFCBDSNM,JFCBDSNM-INFMJFCB(R5) CHK DSNAME         YM5358 66893902
         BE    OIN22780                 IF EQUAL, BRANCH OUT     Y02082 66895902
OIN22720 EQU   *                        PASSWORD BYPASS INDICATORY02082 66896002
         OI    JFCBFLG1,JFCBPWBP        INDICATE JFCB MODIFD     Y02082 66898302
         B     OIN22780                 BR TO RESUME PROC        Y02082 66898402
*                                                                Y02082 66898702
*        ROUTINE TO DO BLP CHECKING                              Y02082 66899102
*                                                                Y02082 66899502
OIN22740 EQU   *                        AUTHORIZE USE OF BLP     Y02082 66899602
         TM    UCBTBYT3-UCBOB(RUCB),UCB3TAPE CHK FOR MAG TAPE    Y02082 66908302
         BNO   OIN22780                 BR IF NOT                Y02082 66910302
         TM    JFCBLTYP,JFCBLP          BLP SPEC IN USER JFCB    Y02082 66917102
         BZ    OIN22780                 NO, BYPASS BLP CHECK     Y02082 66925802
OIN22760 EQU   *                        CHECK IF BLP SPECIFIED   Y02082 66934502
         TM    JFCBLTYP-INFMJFCB(R5),JFCBLP BLP SPEC SYS JFCB    YM5358 66943202
         BO    OIN22780                 YES, BYPASS TESTAUTH     Y02082 66943302
         L     RF,WTGPREFX              GET PREFIX ADDR          Y02082 66963202
         LA    RF,IECREGSV-IECPREFX(RF) GET REG SAVE ADDR        Y02082 66965202
         LR    R5,RF                    SAVE REGSAVE PTR         YM5358 66965602
         STM   RET,R3,K0(RF)            SAVE REGS                Y02082 66966002
*                                                                Y02082 66966402
         TESTAUTH FCTN=1,KEY=YES                                 Y02082 66966502
*                                                                Y02082 66977602
         LTR   RF,RF                    AUTHORIZED TASK          Y02082 66987602
         LM    RET,R3,K0(R5)            RESTORE REGISTERS        YM5358 66987702
         BZ    OIN22780                 YES, DO NOT ABEND        Y02082 66988002
OIN7700A EQU   139                      INTERNAL ABEND CODE      Y02082 66988102
         LA    R0,OIN7700A              IND 913 ABEND            Y02082 66988502
         ST    R0,DXREG0                193A WILL DO DMABCOND    Y02082 66988602
*                                                                Y02082 66988802
OIN22780 EQU   *                        CONTINUE PROCESSING             66988902
*                                                                       66996302
         ST    RTIOT,DXREG9             SAVE RTIOT ACROSS XCTL   A39979 67200021
         B     OIN20400                 BR TO PROCESS NEXT DCB          67400021
*                                                                       67600021
*********************************************************************** 67800021
*                                                                       68000021
OIN23000 EQU   *                        EXIT IF ALL DCBS IN ERROR       68200002
*  IF NO DCB CAN BE OPENED, FREEMAIN WHERE-TO-GO TABLE                  68250021
*  AND EXIT TO CALLER OF OPEN                                           68300021
*                                                                       68350021
         LTR   RD,RD                    CHECK THE GO SWITCH             68400021
         BNZ   OIN23200                 BR IF ON                        68600021
*                                                                       68813300
*                                                                       68880021
         IECRES FREE,PREFIX=WTG,A=(RWTG) FREMAIN WTG TABLE       Y02080 68910002
*                                                                       68920021
         LA    RF,K4                    SET OPEN RETURN CODE TO 4       69000021
*                                                                       69200021
*        RETURN TO CALLER                                        Y02080 69300002
*                                                                Y02080 69350002
         IECRES EXIT                    RETURN                   Y02080 69400002
*                                                                Y02080 69550002
*                                                                       69600021
*********************************************************************** 69800021
*                                                                       70000021
*  INITIALIZE WHERE-TO-GO TABLE BASE FOR XCTL                           70200021
*                                                                       71200021
OIN23200 EQU   *                        GO TO SECOND LOAD        A39979 72200002
         MVC   WTGMODNM,OIN2710A        SET MODULE NAME TO 193A  Y02080 75400002
*                                                                       76000021
*  XCTL TO SECOND LOAD OF OPEN                                          76200021
*                                                                       76400021
         L     RC,WTGPREFX              GET PTR TO WTG PREFIX    Y02144 76610002
         L     RC,IECRRPRM-IECPREFX(,RC) GET RRPLIST ADDRESS     Y02144 76620002
         OI    RRFLAGS2-RRPLIST(RC),RRFFIN1 1ST LOAD COMPLETED   Y02144 76650002
         LR    RCORE,RD                 GET LAST VALID WORK AREA Y02134 76750002
         LM    RTIOT,RET,DXREG9         GET REGS THIS DCB        Y02134 76760002
         LM    R0,R1,DXREG0             FOR QUEUED PROCESSING    Y02134 76770002
         L     R5,CVTPTR                PTR CVT                  Y02134 76780002
         L     R5,CVTDMSR-CVT(,R5)      ADDRESS OF RESIDENT RTN  Y02134 76790002
         IECRES XCTL                    BR QUEUED TO NEXT MOD    Y02134 76792002
*                                                                       77200021
         DROP  RWTG                                                     77400021
*                                                                       77600021
OIN23250 EQU   *                        SYSZTIOT ENQ ERROR       YM2869 77600502
         DMABCOND PCK,CALLER-HOLDS-TIOT-RESOURCE-EXCLUSIVELY     YM2869 77601002
         EJECT                                                          77603037
*********************************************************************** 77800021
*                                                                       78000021
*        CONSTANTS                                                      78200021
*                                                                       78400021
OIN2710A DC    CL8'IFG0190 '            LOWEST OPEN NAME         Y02134 78410002
OIN2500K WTO   'IEC130I DDNAMEXX DD STATEMENT MISSING',MF=L,           X78600021
               DESC=6,                  JOB STATUS                     X78800021
               ROUTCDE=(11)             PROGRAMMER INFORMATION          79000021
OIN2500L EQU   *-OIN2500K               LENGTH OF ERROR MESSAGE         79200021
VTOCNAME DC    44X'04'                  FORMAT 4 DSCB KEY        YM6549 79210002
*                                                                       79400021
OIN2500M WTO   'IEC132I DDNAMEXX, MACRF=E SPECIFIED FOR A SYSIN OR SYSOX79402002
               UT DATA SET',MF=L,                                YM3073X79404002
               DESC=6,                  JOB STATUS               YM3073X79406002
               ROUTCDE=(11)             PROGRAMMER INFORMATION   YM3073 79408002
OIN2500N EQU   *-OIN2500M               LENGTH OF MESSAGE        YM3073 79410002
*                                                                       81000021
         DS    0F,XL1                   PAD TO WORD BDY        @ZA00118 81005037
OIN2570K DC    AL3(1)                   ADDR IF NO DCB EXIT LIST        81200021
*                                                                       81400021
         DS    0F                       ALIGN BDY FOR ENQ      @ZA00118 81405037
ENQLIST  DC    0XL16'00',A(0)           ENQ LIST               @ZA00118 81450037
         ENQ   (SYSZVOLS,,E,6,SYSTEM),TCB=,RET=USE,MF=L          Y02134 81500002
SYSZVOLS DC    CL8'SYSZVOLS'            ENQ VOL SER MAJOR NAME   Y02134 81550002
SYSZOPEN DC    CL8'SYSZOPEN'            ENQ DSN MAJOR NAME     @ZA00118 81555037
BLANKS   DC    CL8' '                   BLANKS                 @ZA02193 81650037
ZEROS    DC    XL6'00'                  ZERO VOLUME SERIAL NO.   Y02134 81700002
RL       DC    X'D9D30000'              CONSTANT OF RL         @ZA08282 81700637
B0       DC    X'000000B0'              CONSTANT OF B0         @ZA08282 81701237
         EJECT                                                          81702037
*                                                                       82600021
*********************************************************************** 82602037
*                                                                       82604037
*        IEF4B4DC PARAMETERS                                            82604437
*                                                                       82604837
*********************************************************************** 82604937
*                                                                       82606637
DSRRFBIT DC    0XL2'00'                 DSRRFMAP BITS          @ZA00118 82608337
         DC    AL1(ADCHENQ)             DSRRFMAP BYTE 1        @ZA00118 82610037
         DC    AL1(SRCHDSNM+1)          DSRRFMAP BYTE 2        @ZA00118 82616037
ALFNCBIT DC    0XL8'00'                 ALFNCMAP BITS          @ZA00118 82620037
         DC    AL1(ONCNVTSW+NOCNVTSW+NOMONTSW) ALFNCMAP BYTE 1 @ZA00118 82625037
         DC    AL1(0)                   ALFNCMAP BYTE 2        @ZA00118 82630037
         DC    AL1(TIOTNQSW)            ALFNCMAP BYTE 3        @ZA09969 82635037
         DC    AL1(0)                   ALFNCMAP BYTE 4        @ZA00118 82640037
         DC    AL1(0)                   ALFNCMAP BYTE 5        @ZA00118 82645037
         DC    AL1(0)                   ALFNCMAP BYTE 6        @ZA00118 82650037
         DC    AL1(0)                   ALFNCMAP BYTE 7        @ZA00118 82655037
         DC    AL1(0)                   ALFNCMAP BYTE 8        @ZA00118 82660037
         EJECT                                                          82660137
*                                                                       82660437
*********************************************************************** 82660837
*                                                                       82661237
*        DYNAMIC ALLOCATION PARAMETERS                                  82661637
*                                                                       82661737
*********************************************************************** 82661837
*                                                                       82661937
DYNPRM1  DS    0CL3                     SVC 99 PARMS           @ZA02193 82662037
         DC    AL1(S99RBEND-S99RB)      LENGTH OF PARMS        @ZA02193 82664037
         DC    AL1(S99VRBAL)            ALLOCATE DSNAME        @ZA02193 82666037
         DC    AL1(S99NOCNV+S99NOMNT)   NEW ENTRY NO MOUNT     @ZA02193 82668037
         DS    0F                       ALIGN BOUNDRY          @ZA02193 82684037
DYNU1    DS    0CL6                     RETURN TIOT NAME       @ZA02193 82686037
         DC    AL2(DALRTDDN)            RETURN DDNAME FUNCTION @ZA02193 82688037
         DC    AL2(K1)                  1 PARM                 @ZA02193 82690037
         DC    AL2(L'TIOEDDNM)          LENGTH OF DDNAME       @ZA02193 82692037
DYNU2    DS    0CL2                     FREE=CLOSE             @ZA02193 82694037
         DC    AL2(DALCLOSE)            FREE=CLOSE FUNCTION    @ZA02193 82696037
DYNU3    DS    0CL6                     DISP=                  @ZA02193 82704037
         DC    AL2(DALSTATS)            DISP= FUNCTION         @ZA02193 82706037
         DC    AL2(K1)                  1 PARM                 @ZA02193 82708037
         DC    AL2(K1)                  LENGTH OF DISP         @ZA02193 82710037
DYNU4    DS    0CL6                     VOL=SER=               @ZA02193 82712037
         DC    AL2(DALVLSER)            VOL=SER= FUNCTION      @ZA02193 82714037
         DC    AL2(K1)                  1 PARM                 @ZA02193 82716037
         DC    AL2(L'UCBVOLI)           LENGTH OF VOLSERS      @ZA02193 82718037
DYNU5    DS    0CL6                     UNIT=                  @ZA02193 82720037
         DC    AL2(DALUNIT)             UNIT= FUNCTION         @ZA02193 82722037
         DC    AL2(K1)                  1 PARM                 @ZA02193 82724037
         DC    AL2(L'UCBNAME)           LENGTH OF CUU          @ZA02193 82726037
DYNU6    DS    0CL4                     DSNAME=                @ZA02193 82726437
         DC    AL2(DALDSNAM)            DSNAME= FUNCTION       @ZA02193 82726837
         DC    AL2(K1)                  1 PARM                 @ZA02193 82727237
         EJECT                                                          82728037
*                                                                       82800021
         XCTLTABL ID=(OPENJ,IGC0002B,OPENNEXT,3A,,IEFAB4DC),   @ZA00118X82800137
               SVC=019,BRT=YES,LENGTH=                         @ZA00118 82800237
         EJECT                                                          82805237
*                                                                       82806237
*********************************************************************** 82807237
*                                                                       82808237
*        PARMLIST FOR IEFAB4DC                                          82809237
*                                                                       82809437
*********************************************************************** 82809637
*                                                                       82809837
QSYSDSN  DSECT                          SYSDSN ENQ INTERFACE   @ZA00118 82810237
QDSRRF   DS    A                        POINTER TO DSRRFMAP    @ZA00118 82815237
QJCT     DS    A                        JSCBJCT POINTER        @ZA00118 82825237
QDSNP    DS    A                        POINTER TO DSNAME      @ZA00118 82826237
QEPADDR  DS    A                        EPA ADDRESS            @ZA00118 82830237
QTCB     DS    A                        POINTER TO DXTCBADR    @ZA00118 82835237
QSTEPNUM DS    A                        POINTER TO STEP NUMBER @ZA00118 82840237
QDSENQ   DS    A                        PTR TO DSENQ RECORD    @ZA00118 82845237
QALFNC   DS    A                        POINTER TO ALFNCMAP    @ZA00118 82855237
QRET     DS    A                        POINTER TO RET CODE    @ZA00118 82860237
QRECORD  DS    A                        PTR TO FIRST RECORD    @ZA00118 82865237
QMSGPARM DS    A                        POINTER TO TCBTIOT     @ZA00118 82875237
QENDP    EQU   *                        END OF PARM LIST       @ZA00118 82875437
QRETCODE DS    F                        RETURN CODE            @ZA00118 82876237
*                                                                       82881237
         EJECT                                                          82882237
*********************************************************************** 82886237
*                                                                       82887237
*        ALFNCMAP FROM IEFAB4DC                                         82887437
*                                                                       82887537
*********************************************************************** 82887637
*                                                                       82887737
ALFNCMAP DS    0XL8                     SEE PLS DSECT IEFAB4DC @ZA00118 82887837
INPUTSW  DS    XL6                      INPUT SWITCHES         @ZA00118 82887937
ONCNVTSW EQU   X'80'                    DON'T USE AN EXISTING           82888337
*                                       ALLOCATION THAT DOES            82888537
*                                       NOT HAVE THE CONVERTIBLE        82888937
*                                       ATTRIBUTE TO SATISFY            82889037
*                                       THE REQUEST                     82889237
NOCNVTSW EQU   X'40'                    DON'T USE AN EXISTING           82889537
*                                       ALLOCATION TO SATISFY           82889637
*                                       THE REQUEST                     82889737
NOMONTSW EQU   X'20'                    DON'T MOUNT VOLUMES OR          82889937
*                                       CONSIDER OFFLINE DEVICES        82890137
JOBRLSYS EQU   X'10'                    JOB RELATED SYSOUT              82890337
******** EQU   X'0F'                    RESERVED                        82890737
******** EQU   X'FF'                    RESERVED                        82891737
WTVOLSW  EQU   X'80'                    WAIT FOR VOLUMES                82892737
WTDSNSW  EQU   X'40'                    WAIT FOR DSNAME                 82892937
NORESSW  EQU   X'20'                    DON'T DO DSNAME RESERVATION     82893037
WTUNTSW  EQU   X'10'                    WAIT FOR UNITS                  82893137
OFFLINSW EQU   X'08'                    CONSIDER OFFLINE UNITS          82893237
TIOTNQSW EQU   X'04'                    TIOT ENQ DONE-ONLY USED         82893537
*                                       BY SVC 99 CONTROL               82893737
CATLOGSW EQU   X'02'                    SET SPECIAL CATALOG             82893837
*                                       DATA SET INDICATORS             82894037
MOUNTSW  EQU   X'01'                    ALLOW VOLUME MOUNTING           82894137
UNITDEVT EQU   X'80'                    UNIT NAME IS A DEVICE TYPE      82894437
******** EQU   X'7F'                    RESERVED                        82894637
******** EQU   X'FF'                    RESERVED                        82895137
******** EQU   X'FF'                    RESERVED                        82895637
PROCESSW DS    XL2                      INTERNAL PROCESSING SWITCHES    82895737
******** EQU   X'80'                    RESERVED                        82895937
COPYSW   EQU   X'40'                    COPY MODE DSAB AVAILABLE        82896137
ERRPROSW EQU   X'30'                    SWITCHES TO CONTROL ERROR       82896337
*                                       RECOVERY PROCESSING             82896437
DEQDSNSW EQU   X'20'                    DEQ DSNAME DSNAME ON ERROR      82896637
UNALOCSW EQU   X'10'                    UNALLOCATE ON ERROR             82896737
NQEXCLSW EQU   X'08'                    DO DSNAME ENQ FROM              82896837
*                                       SHR TO EXCLUSIVE                82897037
DCBSPCSW EQU   X'04'                    DCB PARM(S) SPECIFIED           82897137
FRRPERSW EQU   X'02'                    ESTAE PERCOLATED TO BY FRR      82897337
EPAJCTSW EQU   X'01'                    EPA FOR JCT ALREADY ON CHAIN    82897437
EPASCTSW EQU   X'80'                    EPA FOR SCT ALREADY ON CHAIN    82897637
EPALSISW EQU   X'40'                    EPA FOR LAST SIOT ALREADY       82897837
*                                       ON CHAIN                        82898037
USERERSW EQU   X'20'                    EXECUTING CODE WHICH SHOULD     82898137
*                                       ABEND ONLY IF USER ERROR        82898337
DISMSGSW EQU   X'10'                    ISSUE DISP MSGS IF ERROR        82898437
*                                       FORCES UNALLOCATION             82898637
HSKPDQSW EQU   X'08'                    IF ERROR OCCURES, DEQ DSN       82898737
*                                       WHICH WAS ENQ BY HOUSEKPG       82898937
******** EQU   X'07'                    RESERVED                        82903937
         EJECT                                                          82905337
*                                                                       82905437
*********************************************************************** 82905637
*                                                                       82905737
*        DSRRFMAP FROM IEFAB4DC                                         82905837
*                                                                       82906037
*********************************************************************** 82906137
*                                                                       82906237
DSRRFMAP DS    XL2                      SEE PLS DSECT IEFAB4DC @ZA00118 82907437
ADDRPASS EQU   X'80'                    USE PASSED ADDRESS OF ENTRY     82907737
ADCHONLY EQU   X'40'                    ADD/CHANGE ENTRY ONLY           82908237
ADCHENQ  EQU   X'20'                    ADD/CHANGE ENTRY AND ENQ        82908437
DELEONLY EQU   X'10'                    DELETE ENTRY ONLY               82908637
DELEDEQ  EQU   X'08'                    DELETE ENTRY AND DEQ            82908937
NOSHRXCL EQU   X'04'                    DON'T DO SHR TO EXCLUSIVE       82910537
*                                       CHANGE OF ENTRY NOR ENQ         82911537
ENQSHR   EQU   X'02'                    ENQ SHARE                       82911737
ENQEXCL  EQU   X'01'                    ENQ EXCLUSIVE                   82911937
ENQWAIT  EQU   X'80'                    DO UNCONDITIONAL ENQ            82912137
RETADDR  EQU   X'40'                    RETURN ADDRESS OF DSENQ         82912737
*                                       ENTRY AND DSENQ RECORD          82912937
RETINDIC EQU   X'20'                    RETURN INDICATION OF NAME       82913137
*                                       ADDED TO TABLE OR SHR TO        82913237
*                                       EXCLUSIVE CHANGE NECESSARY      82914637
READALL  EQU   X'10'                    READ AND CHAIN ALL DSENQ        82915637
*                                       RECORDS IN CORE AND RETURN      82915837
*                                       THE ADDRESS OF THE 1ST RECORD   82916037
INCORREC EQU   X'08'                    RECORDS ARE IN CORE AND         82916537
*                                       ADDRESS OF THE 1ST IS INPUT     82916737
EPAJCTEX EQU   X'04'                    AN EPA FOR THE JCT IS ALREADY   82916937
*                                       ON THE EPA CHAIN-ON ENTRY, IF   82917437
*                                       THIS BIT IS OFF ON ENTRY AND    82917637
*                                       THE JCT IS UPDATED, THIS BIT    82917837
*                                       IS SET ON ON EXIT.              82919037
SRCHDSNM EQU   X'02'                    SEARCH DSENQ TABLE FOR DSNAME   82920037
******** EQU   X'01'                    DON'T RETURN EPA                82920237
         EJECT                                                          82920537
*                                                                       82920637
*********************************************************************** 82920837
*                                                                       82921037
*        DSNAME PARAMETER FOR IEFAB4DC                                  82921437
*                                                                       82921637
*********************************************************************** 82921837
*                                                                       82922237
DSNLEN   DS    H                        LENGTH OF DSNAME                82922537
DSNAME   DS    CL44                     DATA SET NAME FOR ENQ           82922637
SAVEAREA DS    18F                      IEFAB4DC SAVE AREA     @ZA00118 82923537
*                                                                       82923737
*********************************************************************** 82923837
*                                                                       82923937
*               PARAMETER FOR Q MANAGER TO LOCATE JCT                   82924037
*                                                                       82924137
*********************************************************************** 82924237
*                                                                       82924337
QMPARMS  DS    F                        QMANAGER WORK AREA     @ZA08282 82924437
RLPTR    DS    F                        PTR TO CONSTANT OF RL  @ZA08282 82924537
JCTPTR   DS    F                        PRT TO REAL JCT        @ZA08282 82924637
RLCONST  DS    F                        CONSTANT OF RL         @ZA08282 82924737
JCTADDR  DS    F                        POINTER TO JCT         @ZA08282 82924837
JCTPFIX  DS    F                        POINTER TO JCT PREFIX  @ZA08282 82924937
B0CONST  DS    F                        CONSTANT OF B0         @ZA08282 82925037
         DS    0D                       END OF PARMLIST        @ZA00118 82925337
QLENGTH  EQU   *-QSYSDSN                LENGTH OF LIST         @ZA00118 82925437
         EJECT                                                          82926437
*                                                                       82926837
*********************************************************************** 82927237
*                                                                       82927637
*        DYNAMIC ALLOCATION MACROS AND WORKAREAS               @ZA02193 82927737
*                                                                       82927837
*********************************************************************** 82928237
*                                                                       82928637
         IEFZB4D0                       DYNAMIC ALLOC PARM LIST@ZA02193 82929037
         EJECT                                                          82929437
         IEFZB4D2                       DYNAMIC ALLOC KEYS     @ZA02193 82929837
         EJECT                                                          82930237
*                                                                       82930637
***************************************************************@ZA02193 82931037
*                                                              @ZA02193 82931437
*        DYNAMIC ALLOCATE PARMLIST FOR OPEN TYPE=J             @ZA02193 82931837
*                                                              @ZA02193 82932637
***************************************************************@ZA02193 82933037
*                                                              @ZA02193 82933437
OPNJDYNA DSECT                          ALLOCATION PARMS       @ZA02193 82933837
DAPTR    DS    A                        POINTER TO PARMS       @ZA02193 82933937
PARMS    DS    0A                       PARM LIST              @ZA02193 82934037
LENGTH   DC    AL1(S99RBEND-S99RB)      LENGTH OF LIST         @ZA02193 82934337
VERB     DC    AL1(S99VRBAL)            ALLOCATE DSNAME        @ZA02193 82934437
FLAGS1   DS    0AL2                     FLAG BYTES 1           @ZA02193 82934537
FLAGS11  DC    AL1(S99NOCNV+S99NOMNT)   NEW REQ-NO MOUNT       @ZA02193 82934837
FLAGS12  DC    AL1(0)                   RESERVED               @ZA02193 82934937
ERRCODE  DS    AL2                      ERROR RETURN CODE      @ZA02193 82935037
INFOCODE DS    AL2                      INFORMATION CODE       @ZA02193 82935337
TXTPP    DS    A                        TEXT POINTER           @ZA02193 82935437
         DS    F                        RESERVED FIELD         @ZA02193 82935537
FLAGS2   DS    0A                       FLAG BYTES 2           @ZA02193 82935637
DYNEQU1  EQU   S99WTVOL                 WAIT FOR VOLUMES       @ZA02193 82935837
DYNEQU2  EQU   S99WTDSN                 WAIT FOR DATA SETS     @ZA02193 82935937
DYNEQU3  EQU   S99WTUNT                 WAIT FOR UNITS         @ZA02193 82936037
DYNEQU4  EQU   S99OFFLN                 CONSIDER OFFLINE UNITS @ZA02193 82936137
DYNEQU5  EQU   S99TIONQ                 TIOT ENQD              @ZA02193 82936237
DYNEQU6  EQU   S99MOUNT                 MOUNTING PERMITED      @ZA02193 82936337
DYNEQU   EQU   DYNEQU3+DYNEQU4+DYNEQU5+DYNEQU6                 @ZA09969 82936537
FLAGS21  DC    AL1(DYNEQU)              ALLOCATION REQUEST     @ZA02193 82936637
FLAGS22  DS    AL1                      RESERVED               @ZA02193 82937637
FLAGS23  DS    AL1                      RESERVED               @ZA02193 82938337
FLAGS24  DS    AL1                      RESERVED               @ZA02193 82938737
OPNJDEND DS    0F                       END OF PARM LIST       @ZA02193 82938837
OPNJDLEN EQU   OPNJDEND-OPNJDYNA        LENGTH OF ALLOC PARMS  @ZA02193 82938937
*                                                                       82939037
TEXTUNIT DSECT                          TEXT UNITS             @ZA02193 82939137
TEXTU1   DC    A(UNIT1)                 PTR TEXT UNIT 1        @ZA02193 82939237
TEXTU2   DC    A(UNIT2)                 PTR TEXT UNIT 2        @ZA02193 82939337
TEXTU3   DC    A(UNIT3)                 PTR TEXT UNIT 3        @ZA02193 82939437
TEXTU4   DC    A(UNIT4)                 PTR TEXT UNIT 4        @ZA02193 82939537
TEXTU5   DC    A(UNIT5)                 PTR TEXT UNIT 5        @ZA02193 82939637
TEXTU6   DC    AL1(LASTNTRY),AL3(UNIT6) PTR TEXT UNIT 6        @ZA02193 82939737
UNIT1    DS    0CL14                    DDNAME RETURN UNIT     @ZA02193 82939837
U1KEY    DC    AL2(DALRTDDN)            DDNAME RETURN FUNCTION @ZA02193 82939937
U1NUM    DC    AL2(K1)                  NUMBER OF PARMS        @ZA02193 82940037
U1LEN    DC    AL2(L'TIOEDDNM)          LENGTH OF DDNAME       @ZA02193 82940137
U1PRM    DS    CL8                      PARM                   @ZA02193 82940237
UNIT2    DS    0CL4                     FREE=CLOSE UNIT        @ZA02193 82940337
U2KEY    DC    AL2(DALCLOSE)            FREE=CLOSE FUNCTION    @ZA02193 82940437
U2NUM    DC    AL2(K0)                  NUMBER OF PARMS        @ZA02193 82940537
UNIT3    DS    0CL8                     DISPOSITION UNIT       @ZA02193 82941237
U3KEY    DC    AL2(DALSTATS)            DISP FUNCTION          @ZA02193 82941337
U3NUM    DC    AL2(K1)                  NUMBER OF PARMS        @ZA02193 82941437
U3LEN    DC    AL2(K1)                  LENGTH OF PARM         @ZA02193 82941537
U3PRM    DC    X'00'                    DISP=SHR-08 DISP=OLD-01@ZA02193 82941637
U3SHR    EQU   X'08'                    DISP=SHR FLAG          @ZA02193 82941837
U3OLD    EQU   X'01'                    DISP=OLD FLAG          @ZA02193 82941937
         DS    X                        FILL                   @ZA02193 82942037
UNIT4    DS    0CL12                    VOL SER UNIT           @ZA02193 82942137
U4KEY    DC    AL2(DALVLSER)            VOL=SER FUNCTION       @ZA02193 82942237
U4NUM    DC    AL2(K1)                  1 VOL SER              @ZA02193 82942337
U4LEN    DC    AL2(L'UCBVOLI)           VOL SER LEN            @ZA02193 82942437
U4PRM    DS    CL6                      VOL=SER=PARM           @ZA02193 82942537
UNIT5    DS    0CL10                    UNIT= UNIT             @ZA02193 82942737
U5KEY    DC    AL2(DALUNIT)             UNIT= FUNCTION         @ZA02193 82943137
U5NUM    DC    AL2(K1)                  1 UNIT                 @ZA02193 82943637
U5LEN    DC    AL2(L'UCBNAME)           LENGTH OF UNIT PARM    @ZA02193 82944037
U5PRM    DS    CL3                      PARM                   @ZA02193 82944437
         DS    X                        FILL                   @ZA02193 82944837
         ORG   TEXTUNIT+100-6           ORG IN FRONT OF DSNAME @ZA02193 82945037
UNIT6    DS    0CL50                    DSNAME UNIT            @ZA02193 82945237
U6KEY    DC    AL2(DALDSNAM)            DSNAME FUNCTION        @ZA02193 82945437
U6NUM    DC    AL2(K1)                  NUMBER OF PARMS        @ZA02193 82945537
U6LEN    DC    AL2(L'JFCBDSNM)          LENGTH OF DSNAME       @ZA02193 82945637
U6PRM    DS    CL44                     JFCBDSNM FIELD         @ZA02193 82945737
         EJECT                                                          82946137
         IECDSECS PSA,                                         @ZA00118X82946237
               CVT,                                            @ZA00118X82946337
               TCB,                                            @ZA00118X82946437
               JSCB,                                           @ZA00118X82946937
               RB,                                             @ZA00118X82947437
               QDB,                                            @ZA02193X82947837
               DSAB,                                           @ZA00118X82947937
               TIOT,                                           @ZA00118X82948437
               UCB,                                            @ZA00118X82948937
               IEZDEB,                                         @ZA00118X82953937
               DCB,                                            @ZA00118X82958937
               ACB,                                            @ZA00118X82963937
               WTG,                                            @ZA00118X82968937
               MAIN,                                           @ZA00118X82973937
               PREFX,                                          @ZA00118X82978937
               RRPL,                                           @ZA00118X82983937
               EXPAND=YES               EXPAND DESIRED DSECTS  @ZA00118 82988937
ACBMJEP  EQU  X'40'                     ACB CREATED BY JEPS    @ZA00118 82993937
TIOTSPOL EQU   X'06'                    SPOOL DATA SET INDICTR @ZA00118 82998937
         IECEQU AOS=YES,IEZDEB=YES                             @ZA00118 83003937
         END                                                            83800021
