         TITLE 'IGC0005E BASIC EOV RTN'                          S21940 00100002
IGC0005E CSECT                                                          00400002
*********************************************************************** 00450002
*                                                                     * 00500002
*                  VS2-037 ADD/DEL/CH                                 * 00503037
*A486050-486750,A487930-487960                                 @ZA29752 00506037
*                                                                     * 00510002
*        VS2 RELEASE 02 DELETIONS                                     * 00520002
*        VS2 RELEASE 03 DELETIONS                                     * 00522102
*0000                                                           ZA00004 00524002
*0000359135,359583                                              ZA00113 00524102
*0000213920-213940                                              ZA00621 00526102
*0000211500,398020-399420                                       ZA02545 00526902
*0000393600                                                    @ZM33366 00528903
*        VS2 RELEASE 04 DELETIONS                                     * 00529337
*0000502000                                                    @ZA02977 00529737
*0000265000-267000                                             @ZA03655 00529837
*                                                                     * 00530002
*                                                                     * 00540002
*********************************************************************** 00542002
*                                                                     * 00544002
* MODULE NAME = IGC0005E (OS/VS2)                                     * 00550002
*                                                                     * 00600002
* DESCRIPTIVE NAME = BASIC EOV ROUTINE                                * 00650002
*                                                                     * 00700002
* COPYRIGHT = NONE                                                    * 00750002
*                                                                     * 00800002
* STATUS = RELEASE 2, LEVEL 0                                         * 00850002
*                                                                     * 00860002
* FUNCTION =                                                          * 00860402
*        THIS MODULE WILL BE THE FIRST LOAD OF THE EOV ROUTINES       * 00860502
*        WHEN THE EOV (SVC 55) MACRO IS ISSUED.                       * 00877202
*                                                                     * 00887202
*        1) IF REGISTER 0 CONTAINS X'1000' IN ITS LOW ORDER TWO BYTES * 00889202
*        A DCB ADDRESS IS PASSED IN REGISTER 1. AN EOV WORKAREA IS    * 00891202
*        OBTAINED AND INITIALIZED, AND 1A OR 1B BELOW IS PERFORMED.   * 00893202
*        1A) IF THE DSORG IS ISAM OR BDAM, MESSAGE 'IEC020I NO ERROR  * 00893602
*        HANDLING, (SYNAD), EXIT SPECIFIED' IS MOVED TO THE WORKAREA  * 00893702
*        AND MODULE IFG0551D IS GIVEN CONTROL TO WRITE THE MESSAGE    * 00893802
*        AND ISSUE A SYSTEM 001 ABEND.                                * 00899402
*        1B) IF DSORG IS NOT ISAM OR BDAM, MODULE IFG0551B IS GIVEN   * 00901402
*        CONTROL WITH REGISTER 7 SET TO AN ENTRY CODE OF 20. IT WILL  * 00903402
*        MOVE MESSAGE 'IEC020I DCB EROPT=ABE OR AN INVALID CODE       * 00903802
*        AND/OR NO SYNAD EXIT SPECIFIED' IN THE EOV WORKAREA AND      * 00904202
*        GIVE CONTROL TO IFG0551D WHICH WILL WRITE THE MESSAGE        * 00904602
*        AND ISSUE A SYSTEM 001 ABEND.                                * 00904702
*                                                                     * 00904802
*        2) IF REGISTER 1 IS NEGATIVE, IT WILL CONTAIN A NEGATED DCB  * 00904902
*        ADDRESS AND AN INTERNAL ABEND CODE WILL BE IN REGISTER 0.    * 00918802
*        AN EOV WORKAREA WILL BE OBTAINED AND INITIALIZED, A DCB      * 00928802
*        COPY WILL BE OBTAINED, AND PROBLEM DETERMINATION MODULE      * 00930802
*        IFG0550P WILL BE GIVEN CONTROL PASSING IT THE INTERNAL       * 00931202
*        ABEND CODE FROM REGISTER 0.                                  * 00931602
         EJECT                                                          00932002
*        3) IF NEITHER CONDITION 1 NOR 2 IS TRUE AND REGISTER 1       * 00932402
*        POINTS TO AN AMB, THEN VSAM EOV PROCESSING IS INDICATED. THE * 00932502
*        AMB IS IN PROTECT KEY ZERO CORE AND FETCH PROTECTED, EVEN    * 00932602
*        THOUGH THE PROTECT KEY OF THE CALLER OF SVC 55 IS NOT IN KEY * 00932702
*        ZERO. AN EOV WORKAREA IS OBTAINED AND INITIALIZED, AND MODULE* 00937302
*        IFG0551F IS GIVEN CONTROL WITH REGISTER 14 CONTAINING AN     * 00939302
*        ENTRY CODE OF 12. ACBS ARE NOT PROCESSED BY EOV.             * 00941302
*                                                                     * 00941702
*        IF CONDITIONS 1, 2, OR 3, ARE NOT THE CASE, THEN REGISTER 1  * 00941802
*        CONTAINS A DCB ADDRESS. THE DCB IS CHECKED TO ENSURE IT IS   * 00941902
*        OPEN AND THE DEB IS VERIFIED TO POINT BACK TO THE DCB.       * 00942002
*                                                                     * 00946602
*        4) IF REGISTER ONE POINTS TO A DCB FOR A SUBSYSTEM DATA SET  * 00948602
*        AS INDICATED BY THE ACCESS METHOD TYPE IN THE DEB, AN EOV    * 00950602
*        WORKAREA IS OBTAINED AND INITIALIZED, A DCB COPY IS          * 00951002
*        OBTAINED, THE DEB IS DEB VALIDITY CHECKED USING THE DEBCHK   * 00951102
*        MACRO, AND MODULE IFG0551F IS GIVEN CONTROL TO PROCESS END   * 00951202
*        OF DATA OR CONCATENATION FOR THE SEQUENTIAL ACCESS METHOD-   * 00951302
*        SUBSYSTEM INTERFACE.                                         * 00963102
         EJECT                                                          00973102
*        5) IF 1-4 ABOVE IS NOT TRUE, REGISTER 1 POINTS TO AN EXCP,   * 00975102
*        BSAM, QSAM, OR BPAM DCB, AND REGISTER 0 CONTAINS AN          * 00979002
*        IOB ADDRESS IF NOT EXCP. ONE OF THREE CONDITIONS WILL BE     * 00981002
*        DETERMINED BY THIS MODULE.                                   * 00983002
*                                                                     * 00986902
*        5A) AN END OF VOLUME CONDITION IS INDICATED IN THE IOB       * 00988902
*        PASSED IN REGISTER 0 OR ASSUMED IF AN EXCP DCB. THIS WILL    * 00990902
*        RESULT IN TAKING THE END OF DATA EXIT (EITHER IN THIS MODULE * 00994802
*        FOR BPAM OR IN A SUBSEQUENT EOV MODULE), SWITCHING TAPE OR   * 00996802
*        DIRECT ACCESS VOLUMES, OBTAINING MORE DIRECT ACCESS SPACE ON * 00998802
*        THE CURRENT OR NEXT VOLUME, OR PROCESSING                    * 01009102
*        CONCATENATION OF TWO DATA SETS. AN EOV                       * 01019102
*        WORKAREA IS OBTAINED AND INITIALIZED, A DCB COPY             * 01019202
*        IS OBTAINED, THE DEB IS DEB VALIDITY CHECKED USING THE DEBCHK* 01019302
*        MACRO, AND MODULE IFG0551F IS GIVEN CONTROL.                 * 01022702
*                                                                     * 01024702
*        5B) A PERMANENT I/O ERROR IS INDICATED IN THE IOB PASSED IN  * 01025102
*        REGISTER 0. THIS WILL RESULT IN EXITING TO THE SYNAD ERROR   * 01025502
*        ANALYSIS ROUTINE POINTED TO BY DCBSYNAD (BY WAY OF THE       * 01025902
*        ACCESS METHOD, THE CALLER OF SVC 55) EITHER FROM THIS MODULE * 01026002
*        (FOR BSAM AND BPAM) OR IN IFG0551B (FOR QSAM). IF NO SYNAD   * 01026102
*        ROUTINE IS DEFINED FOR BSAM A SYSTEM 001 ABEND WILL BE       * 01026202
*        ISSUED BY GIVING IFG0551D CONTROL. IF NO SYNAD ROUTINE IS    * 01029602
*        PRESENT FOR QSAM, MODULE IFG0551B IS GIVEN CONTROL TO        * 01031602
*        IMPLEMENT THE ERROR OPTIONS.                                 * 01032002
*        IF A SYNAD ROUTINE IS PRESENT, THE PERMANENT I/O ERROR BIT   * 01032402
*        (DCBC2PIO, BIT 3, IN DCBCIND2) IS SET TO 1 TO SERVE AS A     * 01032802
*        SECOND ENTRY SWITCH IF THE USER RETURNS FROM HIS SYNAD       * 01032902
*        ROUTINE, IN WHICH CASE THE ACCESS METHOD WILL RE-ISSUE SVC 55* 01033002
*        TO ATTEMPT TO BYPASS THE I/O ERROR AS THE USER INDICATED.    * 01033102
         EJECT                                                          01036502
*        5C) A RETURN FROM THE SYNAD ROUTINE IS INDICATED BY BIT 3,   * 01038502
*        DCBC2PIO, IN DCBCIND2 BEING SET TO ONE. MODULE IFG0551B WILL * 01038902
*        BE GIVEN CONTROL -                                           * 01039302
*        1) IF QSAM TO IMPLEMENT THE ERROR OPTION                     * 01039702
*        INDICATED IN DCBEROPT. THIS MAY RESULT IN THE I/O ERROR      * 01039802
*        BEING ACCEPTED OR SKIPPED AND THE QSAM CHANNEL PROGRAMS      * 01039902
*        BEING RESTARTED.                                             * 01040002
*        2) IF BSAM AND A CHANNEL PROGRAM NEEDS TO BE RESTARTED.      * 01043402
*        IF BSAM AND THE IOB IN ERROR (PASSED IN REGISTER 0) IS THE   * 01045402
*        CURRENT IOB (POINTED TO BY DCBIOBA), THE ACCESS METHOD       * 01045802
*        IS RETURNED CONTROL FROM THIS MODULE.                        * 01046202
*                                                                     * 01048202
*        THE EOV WORKAREA IS OBTAINED THROUGH THE IECRES-GET MACRO    * 01052502
*        WHICH CAUSES A SHARED ENQ ON THE TIOT. IF THE CALLER OF EOV  * 01054502
*        IS ENQUEUED ON THE TIOT EXCLUSIVELY, EOV PROCESSING WILL     * 01054702
*        NOT PROCEED, BUT THE RECOVERY ROUTINES WILL BE GIVEN CONTROL.* 01054902
*        THE EOV WORKAREA IS INITITIALIZED THROUGH THE IECRES-INIT    * 01055502
*        MACRO WHICH FILLS IN CONTROL BLOCK POINTERS IN THE WORKAREA. * 01056502
*                                                                     * 01058502
         EJECT                                                          01060902
* NOTES =                                                             * 01072602
*        WHEN THE BSAM/QSAM ACCESS METHOD ISSUES EOV, IT HAS SAVED    * 01077302
*        REGISTERS 14-8 IN THE SAVE AREA OF THE CALLER OF THE GET/PUT/* 01082002
*        CHECK MACRO INSTRUCTION POINTED TO BY REGISTER 13. THESE     * 01086702
*        REGISTERS ARE NOT SAVED ACCORDING TO STANDARD LINKAGE        * 01091402
*        CONVENTIONS, BUT ARE SAVED AT OFFSET 20 DECIMAL INTO THE     * 01096102
*        SAVE AREA. THE ACCESS METHOD CALLER OF EOV HAS PRESERVED     * 01100802
*        REGISTER 13. CONSEQUENTLY, THE REGISTERS SAVED IN THE SVRB   * 01105502
*        ARE THOSE OF THE ACCESS METHOD (14-8) AND OF THE CALLER OF   * 01110202
*        THE ACCESS METHOD (9-13).                                    * 01120202
*                                                                     * 01130202
*        ANTICIPATING TAKING THE EODAD OR SYNAD EXIT, EOV SWAPS       * 01140202
*        THE REGISTERS 0-8 BETWEEN THE USER SAVE AREA (POINTED TO BY  * 01142202
*        REGISTER 13 IN THE SVRB SAVE AREA) AND THE SVRB SAVE AREA.   * 01144202
*        THIS IS DONE BECAUSE OF THE METHOD OF TAKING THE SYNAD       * 01146202
*        OR EODAD EXIT.                                               * 01148202
*                                                                     * 01148602
*        THE SYNAD EXIT IS TAKEN BY EXITING FROM EOV WITH             * 01149002
*        REGISTER 15 CONTAINING THE SYNAD ADDRESS. THE ACCESS         * 01149402
*        METHOD GAINS CONTROL AT THE NSI AFTER THE SVC 55, TESTS      * 01149802
*        REGISTER 15, AND, IF NONZERO, ASSUMES REGISTER 15 POINTS TO  * 01149902
*        THE SYNAD ADDRESS AND ISSUES A BALR 14,15 INSTRUCTION. SINCE * 01150002
*        THE SVRB FOR EOV HAD BEEN MADE TO CONTAIN THE REGISTERS OF   * 01150102
*        THE CALLER OF THE ACCESS METHOD, THOSE REGISTERS ARE         * 01166802
*        RETURNED TO THE ACCESS METHOD AND WILL BE PRESENTED TO THE   * 01176802
*        SYNAD ROUTINE. FOR THIS REASON THE SYNAD ROUTINE MUST NOT    * 01178802
*        SAVE REGISTERS IN ITS SAVE AREA AS IT THEN CONTAINS THE      * 01180802
*        ACCESS METHOD REGISTERS WHICH WILL BE NEEDED IF A RETURN IS  * 01182802
*        MADE FROM THE SYNAD ROUTINE TO IGNORE THE I/O ERROR OR       * 01183202
*        IMPLEMENT THE DCB ERROR OPTIONS.                             * 01183302
*                                                                     * 01183402
*        SIMILARLY, THE EODAD EXIT IS TAKEN BY ALTERING THE RESUME    * 01189002
*        PSW IN THE EOV SVRB TO NOT CONTAIN THE ADDRESS OF THE NSI    * 01191002
*        AFTER THE SVC 55 IN THE ACCESS METHOD ROUTINE, BUT THE       * 01193002
*        ADDRESS OF THE EODAD EXIT. WHEN EOV EXITS, THE EODAD EXIT    * 01193402
*        WILL BE GIVEN CONTROL DIRECTLY AND THE REGISTERS WILL BE     * 01193802
*        LOADED FROM THE SVRB AND WILL BE THOSE OF THE CALLER OF THE  * 01194202
*        ACCESS METHOD.                                               * 01194302
*                                                                     * 01194402
*        WHEN EOV SUCCESSFULLY SWITCHES VOLUMES OR OBTAINS ADDITIONAL * 01194502
*        DIRECT ACCESS SPACE ON THE CURRENT OR A NEW VOLUME OR AFFECTS* 01208402
*        A CONCATENATION, EOV EXITS TO THE ACCESS METHOD WITH         * 01218402
*        15 SET TO ZERO INDICATING THAT ACCESS METHOD PROCESSING MAY  * 01220402
*        CONTINUE. IN THIS CASE THE REGISTERS THAT HAD BEEN SWAPPED   * 01220802
*        ANTICIPATING AN EODAD OR SYNAD EXIT MUST BE UN-SWAPPED SO    * 01221202
*        THE ACCESS METHOD WILL BE RETURNED ITS OWN REGISTERS.        * 01221602
         EJECT                                                          01222002
*    DEPENDENCIES =                                                   * 01222102
*        THE ACCESS METHOD REGISTER SAVING CONVENTIONS STATED ABOVE   * 01222202
*        UNDER NOTES.                                                 * 01222302
*        CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE         * 01226902
*        WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED       * 01228902
*        IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.          * 01230902
*                                                                     * 01231302
*    RESTRICTIONS = NONE                                              * 01231402
*                                                                     * 01231502
*    REGISTER CONVENTIONS =                                           * 01231602
*            R2 POINTS TO DCB                                         * 01236202
*            R4 POINTS TO OPEN WORK AREA                              * 01238202
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 01240202
*            R6 POINTS TO THE WTG TABLE                               * 01240602
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 01240702
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 01240802
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 01240902
*            R10 POINTS TO THE UCB                                    * 01252702
*                                                                     * 01262702
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 01264702
*                  END OF LISTING.                                    * 01268602
*                                                                     * 01270602
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 01272602
*                                                                     * 01276502
*    PROCESSOR = ASSEMBLER XF                                         * 01278502
*                                                                     * 01280502
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 01284402
*                  ORG STATEMENT AT END OF LISTING                    * 01286402
*                                                                     * 01288402
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 01298702
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 01308702
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 01308802
*                                                                     * 01308902
* ENTRY POINT = IGC0005E                                              * 01312302
*                                                                     * 01314302
*    PURPOSE = SEE FUNCTION                                           * 01314702
*                                                                     * 01315102
*    LINKAGE = EOV MACRO (SVC 55)                                     * 01315502
         EJECT                                                          01315602
* INPUT =                                                             * 01320802
*        THERE ARE FOUR DIFFERENT INPUT CONDITIONS -                  * 01323102
*                                                                     * 01325402
*        1) REGISTER 0 CONTAINS AN IOB ADDRESS.                       * 01327702
*        REGISTER 1 CONTAINS A DCB ADDRESS.                           * 01330002
*        IN THIS CASE IF THE DCBC2PIO BIT (BIT 3) IN DCBCIND2 IS SET, * 01332302
*        IT INDICATES A SECOND ENTRY INTO EOV UPON RETURN FROM THE    * 01334602
*        SYNAD ROUTINE.                                               * 01336902
*                                                                     * 01339202
*        2) REGISTER 1 CONTAINS A DCB/AMB ADDRESS.                    * 01341502
*                                                                     * 01343802
*        3) REGISTER 0 CONTAINS X'1000' IN THE LOW ORDER TWO BYTES.   * 01346102
*        REGISTER 1 CONTAINS A DCB ADDRESS.                           * 01348402
*                                                                     * 01350702
*        4) REGISTER 0 CONTAINS AN INTERNAL ABEND CODE TO BE PASSED   * 01353002
*        TO EOV PROBLEM DETERMINATION.                                * 01355302
*        REGISTER 1 CONTAINS A NEGATED DCB ADDRESS.                   * 01357602
*                                                                     * 01359902
* OUTPUT =                                                            * 01362202
*        1) EOV WORKAREA OBTAINED AND INITIALIZED AND TIOT ENQED UPON * 01364202
*        VIA THE IECRES MACRO (EXIT TO IFG0550P, IFG0551D, IFG0551F). * 01364402
*                                                                     * 01369102
*        2) DCB COPY (IFG0550P, AND IFG0551F IF NOT AMB).             * 01371402
*                                                                     * 01373702
*        3) DCBC2PIO BIT IN DCBCIND2 SET TO 1 (PERMANENT I/O ERROR).  * 01376002
*                                                                     * 01378302
*        4) ERROR MESSAGE PLACED AT OFFSET 8 IN EOV WORKAREA (EXIT TO * 01380602
*        IFG0551D).                                                   * 01382902
*                                                                     * 01385202
*        5) REGISTER 7 CONTAINING ENTRY CODE TO IFG0551B -            * 01387502
*        0 - QSAM I/O ERROR, SYNAD ADDRESS PRESENT.                   * 01389802
*        4 - QSAM I/O ERROR AND SYNAD ADDRESS ABSENT, OR SECOND       * 01399802
*        ENTRY FOR QSAM.                                              * 01409802
*        8 - BSAM SECOND ENTRY WITH CHANNEL PROGRAMS TO RESCHEDULE.   * 01419802
*        12 - BSAM SECOND ENTRY AND CHAINED SCHEDULING.               * 01429802
*        16 - BSAM SECOND ENTRY, PRINTER DEVICE AND IOBS PURGED.      * 01431802
*        20 - REGISTER 0 = X'1000' IN LOW ORDER 2 BYTES ON ENTRY TO   * 01433802
*        EOV AND NOT ISAM/BDAM.                                       * 01435802
*                                                                     * 01437802
*        6) REGISTER 0 CONTAINING INTERNAL ABEND CODE (IFG0550P).     * 01438202
*                                                                     * 01438602
*        7) REGISTER 14 CONTAINING ENTRY CODE TO IFG0551F -           * 01439002
*        0 - NOT AMB.                                                 * 01439402
*        12 - (VSAM) AMB.                                             * 01439502
*                                                                     * 01439602
*        8) RESUME PSW SET TO POINT TO EODAD EXIT (BPAM END OF DATA). * 01439702
*                                                                     * 01456402
*        9) REGISTER 15 CONTAINING SYNAD ADDRESS OR ZERO (EXIT        * 01466402
*        TO BSAM ACCESS METHOD CALLER FROM FIRST OR SECOND ENTRY      * 01468402
*        WHEN PROCESSING A PERMANENT I/O ERROR).                      * 01470402
*                                                                     * 01472402
*        10) REGISTERS 0-8 AT OFFSET 28 IN USER SAVE AREA, OFF        * 01472802
*        REGISTER 13 IN SVRB, SWAPPED WITH REGISTERS 0-8 IN SVRB      * 01472902
*        SAVE AREA (IF EXITING TO BSAM ACCESS METHOD CALLER WITH      * 01473002
*        SYNAD ADDRESS OR ZERO IN REGISTER 15, OR WHEN TAKING EODAD   * 01478602
*        EXIT FOR BPAM MEMBER, OR GIVING CONTROL TO IFG0551F EXCEPT   * 01480602
*        FOR VSAM AMB).                                               * 01482602
*                                                                     * 01482702
*        11) WHEN GOING TO IFG0551B WITH REGISTER 7 CONTAINING   YM4610 01482802
*        4 OR 12 - REGISTER 12 CONTAINS THE ADDRESS OF THE IOB   YM4610 01484302
*        IN ERROR.                                               YM4610 01484702
*                                                                       01485102
*        12) WHEN GOING TO IFG0551B WITH REGISTER 7 CONTAINING   YM4610 01485502
*        8 OR 16 - REGISTER 6 CONTAINS THE ADDRESS OF THE IOB    YM4610 01485602
*        IN ERROR AND REGISTER 12 CONTAINS THE ADDRESS OF THE    YM4610 01487602
*        LAST SCHEDULED IOB                                      YM4610 01489602
*                                                                     * 01490002
*        REGISTERS IF TRANSFERRING TO ANOTHER MODULE                  * 01492002
*        R2 POINTS TO USER'S DCB EXCEPT UNDER 2) ABOVE                * 01494002
*        R4 POINTS TO EOV WORKAREA                                    * 01496002
*        R6 POINTS TO THE WTG TABLE IN THE EOV WORKAREA EXCEPT   YM4610 01498002
*              FOR 11) AND 12) ABOVE                             YM4610 01498402
*        R8 POINTS TO THE CURRENT (AND ONLY) WTG TABLE ENTRY          * 01500002
*                                                                     * 01502002
*        CONTROL PASSED TO NEXT MODULE IN PROTECT KEY 5               * 01504002
         EJECT                                                          01506002
* EXIT-NORMAL =                                                       * 01508002
*        IFG0551F                                                     * 01510002
*        IFG0550P                                                     * 01510402
*        IFG0551B                                                     * 01510802
*        IFG0551D                                                     * 01511202
*        EXIT TO ACCESS METHOD CALLER VIA IECRES-EXIT MACRO           * 01511602
*        EXIT TO EODAD ROUTINE (ADDRESS PLACED IN RESUME PSW) VIA     * 01511702
*        IECRES-EXIT MACRO.                                           * 01511802
*                                                                     * 01511902
* EXIT-ERROR =                                                        * 01516502
*        IFG0550P VIA DMABCOND AND IECRES-BRANCH MACRO WITH INTERNAL  * 01518502
*        ABEND CODE IN REGISTER 0 -                                   * 01520502
*        1) INTERNAL ABEND CODE 219 CAUSING                           * 01520902
*        A37-08 SYSTEM ABEND - DEB DOES NOT POINT TO DCB,             * 01521002
*        BAD CONTROL BLOCK STRUCTURE (ERROR FROM IECRES INIT).   YM7883 01521202
*        2) INTERNAL ABEND CODE 174 CAUSING                           * 01521402
*        337-04 SYSTEM ABEND - NO EODAD ADDRESS AT END OF DATA.       * 01521602
*        3) INTERNAL ABEND CODE 198 CAUSING                           * 01525802
*        A37-04 SYSTEM ABEND - DCB NOT OPEN.                          * 01527802
*                                                                     * 01528802
*        DMABCOND PCK IF RETURN CODE FROM IECRES-GET,PREFIX=EOV       * 01529002
*        INDICATES THAT THE CALLER OF EOV ENQUEUED ON THE TIOT        * 01529202
*        RESOURCE EXCLUSIVELY. THIS WILL NOT BE TOLERATED,            * 01529402
*        UNLESS FOR AN AMB CATALOG REQUEST, AND THE CALLER IS IN YM7883 01529602
*        A SYSTEM KEY.                                           YM7883 01529702
*                                                                     * 01529802
*        EXIT TO CALLER VIA IECRES-EXIT MACRO IF                      * 01530202
*        1) VTAM ACB - ACBERFLG SET TO 4.                             * 01530302
*        2) ACB ADDRESS PASSED IN REGISTER 1.                         * 01530402
*        3) LOCK BIT NOT ON IN DCB.                                   * 01530502
*        4) DEB CHAINED ON ANOTHER TCB AND IT IS BEING CLOSED BY      * 01552802
*        THE TASK CLOSE ROUTINE FOR THAT TCB.                         * 01553302
*        5) IECRES INIT ERROR FOR AMB CONTROL BLOCK              YM7883 01553502
*                                                                     * 01554302
*        IFG0551D WITH MESSAGE 'IEC020I ERROR OCCURRED WHILE CLOSING  * 01558202
*        DATA SET' AT LOCATION 8 IN THE EOV WORKAREA IF A PERMANENT   * 01560202
*        I/O ERROR OCCURRED AND THE DCB INDICATED THAT CLOSE'S        * 01562202
*        FLUSHING OF BURRERS DETECTED THE I/O ERROR AND CALLED EOV.   * 01566102
*                                                                     * 01568102
*        IFG0551D WITH MESSAGE 'IEC020I NO ERROR HANDLING, (SYNAD),   * 01570102
*        EXIT SPECIFIED' AT LOCATION 8 IN THE EOV WORKAREA IF         * 01574002
*        PERMANENT I/O ERROR ON BSAM/BPAM DCB AND NO SYNAD ADDRESS    * 01576002
*        WAS PRESENT IN THE DCB.                                      * 01578002
*                                                                     * 01588302
*        IFG0551D WITH MESSAGE 'IEC020I GET OR READ ISSUED AFTER END  * 01598302
*        OF FILE' AT OFFSET 8 IN EOV WORKAREA IF SECOND ENTRY AND     * 01598402
*        DEBF1EOF (BIT 1) IN DEBFLGS1 SET TO 1 INDICATING GET/READ    * 01598502
*        ISSUED FROM EODAD ROUTINE.                                   * 01601902
         EJECT                                                          01603902
* EXTERNAL REFERENCES = SEE BELOW                                     * 01604302
*                                                                     * 01604702
*    ROUTINES =                                                       * 01605102
*                                                                     * 01605202
*    DATA AREAS =                                                     * 01605302
*                                                                     * 01605402
*    CONTROL BLOCK =                                                  * 01608802
*        TCB                                                          * 01610802
*        SVRB                                                         * 01611202
*        DEB                                                          * 01611602
*        CVT                                                          * 01612002
*        SEQUENTIAL ACCESS METHOD IOBS                                * 01612102
*                                                                     * 01612202
* TABLES =                                                            * 01612302
*        EOV WORKAREA MAPPED BY FORCORE DSECT.                        * 01615702
*                                                                     * 01617702
* MACROS =                                                            * 01618102
*        MODESET                                                      * 01618502
*        DMABCOND                                                     * 01618902
*        ICREST INIT                                                  * 01619002
*        IECRES EXIT                                                  * 01619102
*        IECRES GET                                                   * 01619202
*        IECRES LOAD                                                  * 01622602
*        IECRES FREE                                                  * 01624602
*        DEBCHK MF=L                                                  * 01625002
*        XCTLTABL                                                     * 01625402
*        IDAAMB                                                       * 01625802
*        IECEQU                                                       * 01625902
*        IECDSECS                                                     * 01626002
*                                                                     * 01626102
* CHANGE ACTIVITY =                                                   * 01627202
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD          * 01627602
*                                                                     * 01629202
*********************************************************************** 01629302
         EJECT                                                          01629502
EABD174  EQU   174                      CODE FOR ABEND 337              01633002
EABD198  EQU   198                      CODE FOR ABEND A37      SA52379 01636402
EABD219  EQU   219                      CODE FOR ABEND A37      SA59307 01639802
         BALR  RBASE,0                  ESTABLISH BASE                  16666702
         USING EIN00200,RBASE           BASE REGISTER USING             16700002
         USING IHADCB,RDCB              DCB ADDRESS USING               16800002
         USING SAVEAREA,RD              USER'S SAVE AREA DSECT   Y02082 16850002
*                                                                       16900021
EIN00200 EQU   *                        BASE UNTIL FOLLOWING BAL        17000002
*                                                                       17100021
         BAL   RBASE,EIN00500           BRANCH AROUND ABEND CODE        17200021
         USING EIN00300,RBASE           ESTABLISH NEW ADDRESABILITY     17300021
*        RBASE IS USED FOR BASE REGISTER AND ABEND ENTRY POINT          17400021
EIN00300 EQU   *                        PROBLEM DETERMINATION FUNCTION  17500002
*                                                                       17510002
*        REGISTER 7 POINTS TO ERROR MESSAGE OR CONTAINS A NEGATED       17550002
*        INTERNAL ABEND CODE TO BE PASSED TO PROBLEM DETERMINATION      17560002
*                                                                       17560202
         USING FORCORE,RCORE            EOV WORKAREA USING              17600002
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 17650002
*                                                                       17650202
         BAL   R8,EIN01800              GET CORE FOR EOV RTNS    A44814 17700021
*                                                                       17700202
         LTR   R7,R7                    001 ABEND OR OTHER              17800021
         BM    EIN00450                 OTHER, CALL PROB DET.           17900021
         LA    R1,DXCCW11+K4            MESSAGE AREA                    18000002
         XC    K0(K12,R1),K0(R1)        ZERO AREA TO HOLD MESSAGE       18100002
         MVI   K1(R1),K16               ABEND CODE                      18200021
         LH    RF,K0(R7)                MESSAGE LENGTH                  18300002
         BCTR  RF,K0                    DECREMENT BY ONE                18400021
         EX    RF,EIN00400              MOVE MSG TO WKAREA              18500021
         LA    R7,K4                    INDICATE MESSAGE IS IN  SA53086 18550002
*                                       THE WORKAREA            SA53086 18600002
         MVC   DXXMODID,MOD2E5E         PUT ID IN NAME                  19000021
         MVC   DXXMODEP+K1(K3),MOD2E5E+K2 MOVE IN EP ADDRESS     Y02080 19100002
         B     EIN02100                 BR TO SETUP FOR XCTL            19200021
EIN00400 MVC   MSGLSTSZ(K0),K0(R7)      GET LENGTH OF MSG               19300021
         EJECT                                                          19300202
EIN00450 EQU   *                        NOT AN 001 ABEND                19400002
         MODESET EXTKEY=DATAMGT         GET IN D. M. KEY         YM7883 19400202
         LA    RWTG,DXXAREA             WTG REG POINTS TO DUMMY WTG TBL 19600021
         LA    RWTGC,DXXENTRY           CURRENT PTR POINTS TO DUMMY     19700021
*                                       ENTRY                           19800021
         DMABCOND (0),RES=NO,REGSAVE=YES SETUP FOR 550P          M0067  20720002
         MVC   DXXMODNM+K6(K2),MODPD5E  MOVE ID OF IFG0550P, TO  M0067  20740002
*                                       NAME FIELD OF WTG TABLE  M0067  20800021
         MVC   DXXMODEP+K1(K3),MODPD5E+K2 IFG0550P EP            Y02080 20820002
         IECRES INIT,DCBCOPY=TOWKAR,PREFIX=DXXPREFX, COPY DCB TO Y02082*20830002
               STM=(3,14,DXXPREFX)      PROTECTED CORE           Y02082 20840002
         LPR   R0,R7                    PUT POS INTERNAL CODE IN REG 0  20850002
         B     EIN02100                 GO XCTL                  M0067  20860021
         EJECT                                                          20870002
EIN00500 EQU   *                        CHECK FOR ABEND/PROBELM DET     20900002
*                                                                       20902002
*        DETERMINE FUNCTION REQUESTED BY SVC 55 CALL                    20904002
*                                                                       20906002
         DROP  RCORE                    DROP EOV WORKAREA USING  Y02082 20906802
         USING TCB,R4                   TCB PASSED IN R4 TO SVC  Y02082 20907602
         USING RBBASIC,R5               RB PASSED IN R5        @ZA02545 20908402
         LA    RDCB,K0(R1)              GET DCB ADDRESS                 20910002
         CH    R0,ABCOD                 ABEND REQUESTED                 20950002
         BE    EIN00550                 YES, 001 IS COMP CODE           21000002
         LTR   R1,R1                    ABEND OTHER THAN 001            21050002
         BNM   EIN00600                 NO, ABEND NOT REQUESTED         21100002
         TM    RBGRS1,ALLBITS           VALIDITY CHECK ABEND   @ZA02545 21150002
         BNO   EIN00600                 BRANCH IF NOT ABEND      Y02134 21160002
         LPR   RDCB,R1                  LOAD DCB ADDR INTO RDCB  Y02082 21350002
         LNR   R7,R0                    PUT NEGATIVE INTERNAL CODE      21360002
*                                       IN REG 7                        21370002
         BAL   R8,EIN03010              LINK TO SWAP REGS      @ZA02545 21374002
         BR    RBASE                    ISSUE MESSAGE & ABEND           21380002
         SPACE 2                                                        21382002
EIN00550 EQU   *                        001 ABEND REQUEST               21390002
         LA    R7,K20                   BRANCH OFFSET INTO       YM1197 21390402
*                                       IFG0551B IF NOT IS/DA    YM1197 21390802
         TM    DCBDSORG-IHADCB(RDCB),DCBORGPS PS PROCESSING     ZA00621 21392002
         BZ    EIN00575                 NO - GO TO IFG0551D     ZA00621 21394002
         TM    DCBCIND2,DCBC2QSM        QSAM PROCESSING         ZA00621 21394402
         BO    EIN02000                 YES - GO TO IFG0551B    ZA00621 21394802
EIN00575 EQU   *                                                ZA00621 21395202
         LA    R7,MSG1                  GET ADDR MSG NO SYNAD SPECIFIED 21396002
         BR    RBASE                    ISSUE MESSAGE & ABEND           21398002
         EJECT                                                          21399802
EIN00600 EQU   *                        NOT SPECIAL PROBLEM             21400402
*                                       DETERMINATION USE OF SVC55      21402402
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          YM1391 21460002
         LA    R7,K20                   PUT ENTRY CODE IN REG           21500021
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP    X02989 21560002
         BO    EIN00700                 BR IF YES, NOT ACB/AMB   XM1037 21570002
         TM    DCBDSORG+K1,ACBDORGA     IS CNTRL BLK AN ACB/AMB  X02989 21580002
         BNO   EIN00700                 BR IF NO                 X02989 21590002
         USING IDAAMB,RDCB                                       YM3843 21590102
         TM    AMBID,AMBIDENT           IS CNTRL BLK AN AMB      YM3843 21590202
         LA    R8,EIN02150              SKIP DCB COPY IF YES     YM3843 21590302
         BO    EIN01800                 BR IF YES - VSAM AMB     YM3843 21590402
         SPACE 2                                                        21590502
*                                                                Y02004 21590602
*        ACB PASSED TO EOV IN REGISTER 1                                21590702
*        DO NOT PROCESS VTAM ACB REQUESTS                        Y02004 21590802
*                                                                Y02004 21591202
         USING IFGACB,RACB              ADDRESS ACB              Y02004 21591802
         MODESET EXTKEY=RBT234,WORKREG=7 ASSUME CALLER'S KEY     YM3843 21592802
         CLI   ACBAMETH,ACBVTAM         IS THIS ACB FOR VTAM?    YM3011 21593802
         BNE   EIN01100                 NO, EXIT                 YM3843 21607302
         MVI   ACBERFLG,VSCACBCL        SET ACB ERROR FLAG       Y02004 21617302
         B     EIN01100                 RETURN TO USER           Y02004 21619302
*                                                                       21620302
         USING IHADCB,RDCB              RESTORE BASE FOR DCB     Y02004 21663802
         EJECT                                                          21664202
EIN00700 EQU   *                        DCB PASSED IN REGISTER 1 X02989 21665802
         MODESET EXTKEY=RBT234,WORKREG=7 ASSUME CALLER'S KEY     YM1391 21715802
*                                                                       23500021
         LR    RET,RPAR                 GET SVRB PASSED BY MONITOR      23600021
         USING RBBASIC,RET              USING ON SVRB            Y02082 23650002
         DROP  R4                                                YM1391 23660002
         DROP  R5                                              @ZA02545 23664002
         USING FORCORE,RCORE                                     YM1391 23670002
*                                                                       23700021
*                                                                       23800021
         TM    DCBOFLGS,DCBOPEN+DCBOLOCK IS DCB OPEN + UNLOCKED SA52379 23900002
         BNO   EIN01150                 NO, STOP PROCESSING     SA52379 24000002
         USING DEBBASIC,RDEB            ADDRESSABILITY           YM2869 24050002
         L     RDEB,DCBDEBAD            GET DEB ADDRESS         SA59307 24060002
         L     RC,DEBDCBAD              GET DCB FROM DEB        SA59307 24070002
         LA    R7,K3                    NEG OFFSET TO AMTYP      YM1310 24070402
         SR    RDEB,R7                  PT TO DEBAMTYP           YM1310 24070802
         CLC   K0(K1,RDEB),DEBCKSS      TEST FOR SUBSYS DEB      YM1310 24072002
         L     RDEB,DCBDEBAD            RESTORE DEB ADDRESS      YM1310 24072402
         BNE   EIN00730                 BR IF NOT                YM1310 24074002
         L     RC,DEBECBAD              DCB ADDR FOR SUBSYS DEB  YM1310 24076002
EIN00730 EQU   *                        SEE IF DEB POINTS TO DCB YM1310 24078002
         LA    RC,0(RC)                 CLEAR HIGH ORDER BYTE   SA59307 24080002
         CR    RC,RDCB                  IS THIS A VALID DCB     SA59307 24090002
         BE    EIN00750                 YES                     SA59307 24092002
         LA    R7,EABD219               NO, BAD DCB PTR         SA59307 24094002
         LNR   R7,R7                    NOT 001 ABEND           SA59307 24096002
         BAL   R8,EIN03015              LINK TO SWAP REGS      @ZA02545 24097602
         BR    RBASE                    BRANCH TO ABEND         SA59307 24098002
         EJECT                                                          24098102
EIN00750 EQU   *                        VALID DEB, CONTINUE     SA59307 24098402
         TM    DCBMACRF,DCBMEXCP        DCB USING EXCP MACRO            24100021
         BO    EIN01750                 YES XCTL TO EOV ROUTINE  YM2869 24200002
         NI    DCBCIND2,ALLBITS-DCBC2FEO    TURN OFF FEOV BIT   SA58624 24250002
         LA    RC,K3                    GET OFFSET TO DEBAMTYP   Y02120 24276002
         SR    RDEB,RC                  RDEB POINTS TO DEBAMTYP  Y02120 24278002
         CLC   DEBCKSS,K0(RDEB)         DEBAMTYP FOR SUBSYSTEM   Y02120 24278402
         LA    RDEB,K3(,RDEB)           RESTORE DEB ADDRESS      YM1119 24278502
         BE    EIN01700                 BRANCH IF SUBSYSTEM      YM2869 24278802
*                                                                       24300021
*        NOT SUBSYSTEM DCB, MUST BE NORMAL BSAM/QSAM                    24350002
*                                                                       24360002
         LR    RC,R0                    GET IOB ADDRESS                 24400021
         TM    DCBCIND2,DCBC2QSM        QSAM BEING USED                 24500021
         BO    EIN00800                 YES BRANCH                      24600021
         CLI   DCBDEVT,K80              PAPER TAPE BEING USED           24700021
         BE    EIN01750                 YES BRANCH               YM2869 24800002
         B     EIN00900                 NO, BRANCH              SA59307 24850002
EIN00800 EQU   *                        TEST FOR QSAM GET FROM EODAD    25000002
*                                                                       25100021
         LA    R7,MSG3                  GET ADDR MSG ISSUED BY EODAD    25200021
         TM    DEBFLGS1,DEBF1EOF        WAS EOD TAKEN           SA50649 25300002
         BCR   1,RBASE                  ISSUE MESSAGE AND ABEND SA50649 25400002
EIN00900 EQU   *                        BSAM/QSAM EOV                   25500002
         L     RPAR,K12(RC)             GET ECB ADDR                    25600021
         TM    DCBCIND2,DCBC2PIO        SECOND ENTRY INTO ROUTINE       25700021
         BZ    EIN01200                 NO CONTINUE                     25800021
         EJECT                                                          25850002
*                                                                       25900021
*        SECOND ENTRY INTO EOV - RETURN FROM SYNAD ROUTINE              25950002
*                                                                       25960002
         NI    DCBCIND2,ALLBITS-X10     TURN OFF PERM ERROR FLAGS       26000021
         TM    DCBCIND2,DCBC2QSM        QSAM BEING USED                 26100021
         LA    R7,K4                    PUT 551B ENTRY CODE IN REG      26200002
         BO    EIN02000                 YES BRANCH TO QSAM ERROR        26300002
*                                       OPTIONS TEST                    26400002
*                                                                       26410002
*        BSAM SECOND ENTRY TO EOV                                       26420002
*                                                                       26430002
         NI    DCBIFLGS,X'FF'-DCBIFPIO  TURN OFF ERROR FLAGS     A49379 26450021
*                                                                       26710037
         TM    DCBCIND2,DCBC2CHN        TEST FOR CHAINED SCHED @ZA03655 26720037
         BNO   EIN00950                 BRANCH NOT PCI         @ZA03655 26730037
*                                                                       26740037
         LA    R7,K12                   551B ENTRY CODE        @ZA03655 26742037
         L     RWTG,DCBIOBA             LOAD CURRENT ICB       @ZA03655 26750037
         LA    RWTG,K0(,RWTG)           CLEAR FOR COMPARE      @ZA03655 26760037
         CR    RC,RWTG                  ERROR ICB = CURRENT    @ZA03655 26770037
         BNE   EIN02000                 BRANCH TO RESCHED I/O  @ZA03655 26780037
         TM    K0(RC),X08               OUTPUT WITH READ       @ZA03655 26782037
         BNO   EIN02000                 BRANCH INVALID REQUEST @ZA03655 26784037
         B     EIN01050                 RETURN TO CALLER       @ZA03655 26786037
*                                                                       26790037
EIN00950 EQU   *                        NORMAL SCREDULING      @ZA03655 26792037
*                                                                       26800021
         LR    RWTG,RC                  GET CURRENT IOB                 26900021
         L     RC,DCBIOBA               GET LAST IOB USED               27000021
         LA    RC,K0(RC)                CLEAR                           27100021
         TM    DCBDEVT,DCBDVPR1         TEST IF DCB USING PRINTER       27300002
         BNO   EIN01000                 NO BRANCH                       27400021
         TM    K12(RWTG),DEPEND         IOB INTERCEPTED OR PURGED       27500021
         LA    R7,K16                   PUT 551B ENTRY CODE IN REG      27600002
         BM    EIN02000                 YES, BRANCH                     27700021
EIN01000 EQU   *                        WERE IOBS PURGED                27900002
         CR    RC,RWTG                  IS ERROR IOB CURRENT IOB        28000002
         LA    R7,K8                    PUT 551B ENTRY CODE IN REG      28300002
         BNE   EIN02000                 YES, BRANCH                     28400021
         EJECT                                                          28450002
*                                                                       28460002
*        BSAM - NO IOBS TO BE RESTARTED - RETURN TO CALLER              28470002
*                                                                       28480002
EIN01050 EQU   *                        TEST FOR PRESENCE OF SYNAD      28490002
         TM    DCBSYNAD+K3,K1           IS SYNAD PRESENT                28600021
         BO    EIN01100                 NO, BRANCH - NO REG UNSWAP      28700002
         LM    R0,R8,SAVREG0            GET ERR REGS 0-8         Y02082 28800002
*                                       PRE-SAVED IN SAVE AREA   Y02082 28900002
         MVC   SAVREG2(SAVREG9-SAVREG2),RBGRS2 MOVE REGS 2-8 IN  Y02082 29000002
*                                       SVRB TO SAVE AREA        Y02082 29010002
         MODESET EXTKEY=SUPR            SVRB KEY                 Y02082 29050002
         STM   R0,R8,RBGRS0             USER REGS TO SVRB        Y02082 29100002
EIN01100 EQU   *                        RETURN TO GERR/PERR             29200002
*                                                                Y02080 29250002
*        RETURN TO CALLER                                        Y02080 29300002
*                                                                Y02080 29350002
         SR    RF,RF                    ZERO RETURN CODE         YM7883 29350202
*                                                                       29350402
         IECRES EXIT                    RETURN                   Y02080 29352002
         SPACE 2                                                        29362002
*                                                                Y02080 29390002
*        OPEN AND LOCK BIT NOT BOTH ON                                  29390402
*                                                                       29390802
EIN01150 EQU   *                        ABEND OR RETURN TO USER SA52379 29392002
         TM    DCBOFLGS,DCBOPEN         IS THE OPEN BIT ON      SA52379 29394002
         BO    EIN01100                 BR IF YES-EXIT           YM7883 29396002
         LA    R7,EABD198               GET CODE FOR A37 ABEND  SA52379 29399202
         LNR   R7,R7                    INDICATE NON 001 ABEND  SA52379 29399602
         BAL   R8,EIN03010              LINK TO SWAP REGS      @ZA02545 29423602
         BR    RBASE                    GO TO ABEND CODE        SA52379 29439602
         EJECT                                                          29459602
EIN01200 EQU   *                        TEST FOR I/O ERROR              29500002
*                                                                       29600021
*        FIRST ENTRY TO EOV                                             29650002
*                                                                       29660002
         TM    K20(RC),CSWUNITX         UNIT EXCEPTION ON IN CSW        29700021
         BZ    EIN01500                 NO BRANCH                       29800021
*                                                                       29900021
         TM    K0(RC),IOBWRITE          WAS IOB USED FOR OUTPUT         30000021
         BO    EIN01300                 YES BRANCH                      30100021
*                                                                       30200021
         TM    DCBDSORG,DCBORGPO        PAM DCB FOR INPUT               30300021
         BO    EIN02200                 YES BRANCH                      30400021
*                                                                       30500021
EIN01300 EQU   *                        UNIT EXCEPTION - NOT PAM INPUT  30600002
*                                                                       30700021
         TM    DCBDEVT,DCBDEVDA         DA USED                         30800021
         BO    EIN01400                 YES, BRANCH                     30900021
         TM    K20(RC),K2               UNIT CHECK ON IN CSW            31000021
         BO    EIN02500                 YES,BRANCH                      31100021
EIN01400 EQU   *                        END OF FILE INDICATION          31150002
         OI    DCBOFLGS,DCBOEOF         SET FILE IND-I/O SUPPORT        31200002
         B     EIN01600                 BR TO GET IOB                   31300021
EIN01500 EQU   *                        NOT UNIT EXCEPTION              31350002
*                                                                       31400021
*        I/O ERROR UNLESS READ BACKWARDS INTO LOAD POINT                31450002
*                                                                       31500021
         TM    DCBDEVT,DCBDEVTP         DCB USING TAPE FOR INPUT        31800021
         BZ    EIN02500                 NO BRANCH - UNIT CHECK          31900021
*                                                                       32000021
         TM    K11(RC),UCBLDPT          READ LOAD POINT ON TAPE         32100021
         BZ    EIN02500                 NO BRANCH - UNIT CHECK          32200021
*                                                                       32300021
         TM    DCBOFLGS,DCBORDBK        IS IT READ BACK AT THE   M0180  32320021
*                                       LOAD POINT                      32340021
         BZ    EIN02500                 NO, BRANCH - UNIT CHECK  M0180  32360021
*                                                                       32400021
EIN01600 EQU   *                        NOT I/O ERROR                   32500002
*                                                                       32600021
         L     RPAR,K12(RC)             GET ECB ADDRESS                 32700021
         MVI   K0(RPAR),ECBCOD7F        POST COMPLETE NO ERROR          32800021
         L     RWTG,DCBIOBA             GET CURR IOB FROM DCB           32900021
         STCM  RC,B'0111',K5(RWTG)      STORE ERROR IOB IN IT    Y02082 32950002
         NI    DCBCIND1,ALLBITS-K48     TURN OFF VOLUME FULL BITS       33100021
         EJECT                                                          33200002
EIN01700 EQU   *                        NORMAL END OF VOLUME     YM2869 33350002
*                                                                Y02082 33400002
*        SWAP REGS 0-8 - THOSE IN THE SVRB AND THOSE IN THE      Y02082 33450002
*        CALLER'S SAVE AREA                                      Y02082 33500002
*                                                                       33550002
         LM    RCORE,RC,SAVREG0         LOAD REGS 0-8 IN SAVAREA Y02082 33600002
         MVC   SAVREG0(SAVREG9-SAVREG0),RBGRS0  MOVE REGS 0-8 IN Y02082 33650002
*                                       SVRB INTO THE SAVE AREA  Y02082 33700002
         MODESET EXTKEY=SUPR            SVRB KEY                 Y02082 33750002
         STM   RCORE,RC,RBGRS0          STORE REGS 0-8 FROM SAVE Y02082 33800002
*                                       AREA INTO SVRB           Y02082 33850002
*                                                                       34200021
EIN01750 EQU   *                        TEST TASK CLOSE BIT      YM2869 34300002
*                                                                       35880000
*        DON'T CONTINUE WITH EOV IF DEB IS CHAINED ON ANOTHER    YM2869 35880502
*        TCB'S DEB CHAIN AND IS BEING PROCESSED BY TASK CLOSE    YM2869 35881002
*                                                                       35881502
         L     R8,CVTPTR                CVT                      YM2869 35882102
         L     R8,CVTTCBP-CVT(,R8)      TCB POINTERS             YM2869 35882202
         L     R8,K4(,R8)               CURRENT TCB ADDR         YM2869 35882502
         USING TCB,R8                                            YM2869 35882802
         MODESET EXTKEY=RBT234,WORKREG=15 USER KEY               YM2869 35883102
         L     RDEB,DCBDEBAD            DEB ADDRESS              YM2869 35883402
         CLM   R8,B'0111',DEBTCBAD+K1   DEB ON CURRENT TCB       YM2869 35883702
         BE    EIN01760                 BRANCH IF YES            YM2869 35884002
         DROP  R8                                                YM2869 35884302
         LA    RF,DEBBASIC-DEBXTNP      OFFSET TO DEBX           YM2869 35884502
         LA    R8,DEBBASIC              CLEAR HIGH BYTE FOR LTR  YM2869 35885002
         SR    R8,RF                    R8 POINTS TO DEBX ADDR   YM2869 35885502
         USING DEBXTNP,R8                                        YM2869 35886002
         L     R8,DEBXTNP               R8 POINTS TO DEBX        YM2869 35886502
         USING DEBXTN,R8                                         YM2869 35887002
         TM    DEBXFLG1,DEBXTSK         IS TASK CLOSE ON DEB     YM2869 35887502
         BO    EIN01100                 BRANCH IF YES            YM2869 35888002
         DROP  R8                                                YM2869 35888502
DEBXTSK  EQU   X'40'                    TASK CLOSE PROCESSING    YM2869 35889002
         EJECT                                                          35889102
EIN01760 EQU   *                        GET CORE FOR EOV         YM2869 35889502
         LA    R8,EIN01900              LOAD ADDR FOR RETURN     A44814 35894000
*                                       FROM GETMAIN             A44814 35896000
EIN01800 EQU   *                        GET EOV WORKAREA                35898002
*                                                                Y02080 35898402
* SAVE REGISTERS 2-12 IN SVRB EXTENDED SAVE AREA                 Y02080 35898502
*                                                                Y02080 35898602
         L     RF,CVTPTR                GET POINTER TO CVT       Y02080 35898702
         L     RF,CVTTCBP-CVT(,RF)      GET TCB WORDS            Y02080 35903002
         L     RF,K4(,RF)               TCB ADDRESS              Y02080 35905002
         L     RF,K0(,RF)               POINTER TO SVRB          Y02080 35907002
*                                                                Y02080 35907102
         MODESET EXTKEY=SUPR            SVRB KEY TO STM          Y02082 35909102
         IECRES GET,PREFIX=EOV,LV=EOVSIZE,STM=(2,13,96(15)),A=(RDCB)    35909302
*                                                                       35910302
         LR    RCORE,R1                 SET UP ADDRESS FOR EV RTS.      35910402
         STCM  RCORE,B'0111',DXXCORE    PUT WORKAREA ADDR IN     YM3843 35910502
*                                       EOV'S WTG TABLE ENTRY    YM3843 35910602
         LTR   R0,R0                    IS R0 ZERO               YM3185 35910702
         BZ    EIN01850                 BRANCH IF OK             YM7883 35910802
         EJECT                                                          35910902
*        IF REG 0 IS NONZERO, IT IS BECAUSE THE CALLER HAS       YM3185 35911302
*        ENQUEUED EXCLUSIVELY ON THE TIOT. THIS MUST NOT BE      YM3185 35911402
*        ALLOWED TO GO UNNOTICED UNLESS FOR A CATALOG AMB.       YM7883 35911502
*                                                                       35912702
         MODESET EXTKEY=ZERO            AMB IN KEY 0             YM7883 35913202
         TM    DCBMACRF,DCBMEXCP        EXCP DCB                 YM7883 35913302
         BO    EIN03005                 BRANCH IF YES            YM7883 35913402
         TM    DCBDSRG2,ACBDORGA        ACB/AMB                 ZA00113 35913502
         BZ    EIN03005                 BRANCH IF NO             YM7883 35913702
         USING IDAAMB,RDCB              AMB USING                YM7883 35913802
         TM    AMBID,AMBIDENT           TEST FOR AMB             YM7883 35914002
         BZ    EIN03005                 BRANCH IF NOT            YM7883 35914202
         TM    AMBINFL,AMBCAT+AMBSCRA   CATALOG AMB?            Z30SSRL 35914337
         BZ    EIN03005                 BRANCH IF NOT            YM7883 35914402
         USING IHADCB,RDCB              RESUME DCB USING         YM7883 35914502
         TESTAUTH KEY=YES               IS CALLER IN SYSTEM KEY  YM7883 35914602
         LTR   RF,RF                    CALLER IN SYSTEM KEY     YM7883 35914702
         BNZ   EIN03005                 BRANCH IF NOT SYSTEM KEY YM7883 35914802
         EJECT                                                          35915002
EIN01850 EQU   *                        PROCEED                  YM7883 35915102
         L     RF,DXXPREFX              GET PREFIX PTR           Y02144 35915502
         L     RF,IECRRPRM-IECPREFX(,RF) GET RRPLIST PTR         Y02144 35915602
         USING RRPLIST,RF                                        Y02144 35915702
         MVI   RRFUNCTN,RRFEOV          INDICATE EOV FUNCTION    Y02144 35915802
         ST    RF,DXATCOM3              SAVE RRPLIST PTR IN W/A  Y02144 35916002
         DROP  RF                                                Y02144 35916202
         IECRES LOAD,PREFIX=DXXPREFX,MODNM=EOV,BRANCH=NO         Y02080X35916402
                                        GIVE OPT TRACE A SHOT    Y02080 35924602
*                                                                       35924802
         IECRES INIT,DEB=YES,STM=(2,14,DXXPREFX),PREFIX=DXXPREFX Y02082 35934202
*                                                                       35934402
         LR    R1,RDCB                  SET DCB ADDRESS IN REG 1        35953200
         CLI   DXWCOPYE,K0              WAS INIT SUCCESSFUL      YM4610 35955202
         BER   R8                       RETURN TO CALLER         A44814 35955402
*                                       OF SUBROUTINE                   35955602
         LA    R7,EABD219               INTERNAL ABEND CODE      YM7883 35957202
         LNR   R7,R7                    NEGATE CODE              YM7883 35957602
         MODESET EXTKEY=ZERO            AMB IN KEY 0             YM7883 35957702
         TM    DCBMACRF,DCBMEXCP        EXCP DCB                 YM7883 35957902
         BO    EIN00450                 BRANCH IF YES            YM7883 35958002
         TM    DCBDSRG2,ACBDORGA        ACB/AMB                 ZA00113 35958202
         BZ    EIN00450                 BRANCH IF NO             YM7883 35958302
*        MUST BE AMB CONTROL BLOCK - ACB ALREADY SCREENED OUT    YM7883 35958502
         B     EIN01100                 EXIT                     YM7883 35959002
         EJECT                                                          35965602
EIN01900 EQU   *                        COPY DCB                        35966702
*                                                                       36000002
*        DCB COPY LEAVES BUSY BIT ALONE WHEN DEB= NOT CODED      YM7883 36000202
*                                                                       36008002
         IECRES INIT,DCBCOPY=TOWKAR,PREFIX=DXXPREFX, COPY DCB    Y02082*36010002
               STM=(3,14,DXXPREFX)      BUT NOT AMB              Y02082 36020002
         EJECT                                                          36020202
EIN01950 EQU   *                        DCB COPY SUCCESSFUL      Y02134 36190002
         SR    RET,RET                  ZERO BRANCH REG          YM1391 36192402
EIN01960 EQU   *                        GO TO IFG0551F           Y02082 36194002
         MVC   DXXMODID,MOD0Z5E         MOVE ID TO NAME                 36200021
         MVC   DXXMODEP+K1(K3),MOD0Z5E+K2 MODULE EP ADDRESS      Y02080 36300002
         B     EIN02100                 BR TO XCTL                      36400021
         SPACE 2                                                        36400202
EIN02000 EQU   *                        GO TO IFG0551B                  36500002
         BAL   R8,EIN01800              GETMAIN FOR EOV ROUTINES A44814 36600021
         MVC   DXXMODID,MOD2F5E         MOVE ID TO NAME                 36700021
         MVC   DXXMODEP+K1(K3),MOD2F5E+K2 MODULE EP ADDRESS      Y02080 36800002
         SR    RET,RET                  ZERO BRANCH REG          YM1391 36850002
EIN02100 EQU   *                        SET AUDIT TRAIL          Y02080 36900002
         CLC   DXXMODID,MOD0Z5E         GOING TO IFG0551F        Y02144 36950002
         BNE   EIN02110                 BR IF NO                 Y02144 36960002
         L     RF,DXATCOM3              GET RRPLIST PTR          Y02144 36962002
         USING RRPLIST,RF                                        Y02144 36964002
         OI    RRFLAGS2,RRFFIN1         SET 1ST LOAD COMPLETED   Y02144 36966002
         DROP  RF                                                Y02144 36968002
EIN02110 EQU   *                        GO TO NEXT MODULE        Y02080 36970002
         MVC   DXXMODNM(K6),IGG5E       MOVE IN NAME                    37000021
         CLC   DXXMODID,MOD2F5E         GOING TO IFG0551B        YM4610 37050002
         BE    EIN02120                 BRANCH IF YES, R6 HAS    YM4610 37060002
*                                       IOB ADDRESS              YM4610 37080002
         LA    R6,DXXMODNM              POINT TO NAME            Y02080 37100002
EIN02120 EQU   *                        GO TO NEXT MOD           YM4610 37150002
         IECRES LOAD,PREFIX=DXXPREFX,MODNM=DXXMODNM,             YM4610*37350002
               BRANCH=DIRECT            USE IFG019RA TO XCTL     YM4610 37352002
EIN02150 EQU   *                        VSAM                     YM1391 37360002
         LA    RET,K12                  BRANCH CODE FOR 551F     YM1391 37370002
         B     EIN01960                 GO TO IFG0551F           YM1391 37380002
         EJECT                                                          37390002
EIN02200 EQU   *                        BPAM EODAD                      38000002
*                                                                       38050002
*        END OF DATA READING A BPAM MEMBER                              38060002
*                                                                       38100021
         LA    R7,EABD174               ABEND 337 FOR PROB       M0067  38200021
*                                       DETER.                   M0067  38300021
         LNR   R7,R7                    INDICATE ABEND OTHER     M0067  38400021
*                                       THAN 001                 M0067  38500021
         BAL   R8,EIN03015              LINK TO SWAP REGS      @ZA02545 38540002
         TM    DCBEODAD+K3,K1           EODAD PRESENT            M0067  38600021
         BCR   1,RBASE                  YES - BRANCH TO ABEND    M0067  38700021
         NI    DCBIFLGS,X'FF'-DCBIFPIO  OFF WITH ERR FLAGS              39200002
         NI    DCBCIND1,ALLBITS-K48     TURN OFF VOLUME FULL BITS       39300021
         TM    DCBCIND2,DCBC2CHN       CHAINED SCHEDULING      @ZA02545 39320002
         BZ    EIN02300                NO                      @ZA02545 39340002
         L     RA,DCBIOBAD             YES - MUST TURN ON      @ZM33366 39360003
*                                      EXCP NEEDED FLAG        @ZA02545 39380002
         OI    K12(RA),K80             TURN ON FLAG            @ZA02545 39400002
EIN02300 EQU   *                       NO CHAINNED SCHEDULING  @ZA02545 39420002
*                                                                       39550002
         L     R9,SAVREG14              USERS REG 14           @ZA02545 39570002
         MODESET EXTKEY=SUPR            SVRB KEY               @ZA02545 39590002
*                                       INTO THE SVRB          @ZA02545 39610002
         ST    R9,RBGRS14               STORE USERS RET ADDR   @ZA02545 39630002
         L     RA,DCBEODAD              USER'S EODAD ADDRESS     Y02082 39800402
         L     RET,RBLINK               ADDR OF USERS RB         Y02082 39992002
         STCM  RA,B'0111',RBOPSW+K5     SET EODAD ADDR IN THE    Y02082 39994002
*                                       RESUME PSW               Y02082 39996002
*                                                                Y02080 40050002
*        RETURN TO CALLER                                        Y02080 40100002
*                                                                Y02080 40150002
         IECRES EXIT                    RETURN                   Y02080 40160002
         EJECT                                                          40170002
EIN02500 EQU   *                        BSAM/QSAM ERROR ANALYSIS        40600002
*                                                                       40650002
*        PERMANENT I/O ERROR DETECTED                                   40660002
*                                                                       40700021
         OI    DCBCIND2,DCBC2PIO        SET PERMANENT ERROR INDICATOR   40800021
         TM    DCBCIND2,DCBC2QSM        DCB USING QSAM                  40900021
         BO    EIN03000                 YES BRANCH                      41000021
*                                                                       41100021
*        BSAM ONLY PROCESSING                                           41110002
*                                                                       41150002
         TM    DCBSYNAD+K3,K1           SYNAD PRESENT                   41200021
         LA    R7,MSG1                  GET ADDR OF MSG -NO SYNAD EXIT- 41300021
         BCR   1,RBASE                  NO - BRANCH TO ABEND            41400021
         CLI   K4(RC),ALLBITS           ECB FLAGGED IN ERROR            41500021
         BNE   EIN02600                 NO BRANCH                       41600021
         OI    K0(RC),BIT2+BIT4         TURN ON N/P ILLOGICAL REQUEST   41700002
         NI    K4(RC),K0                TURN OFF ECB ERROR INDICATOR    41800021
*                                                                       41900021
EIN02600 EQU   *                        COLLECT SYNAD INFORMATION       42000002
*                                       FOR BOTH BSAM AND QSAM          42100002
*                                                                       42150002
         TM    K0(RC),IOBWRITE          LAST USED FOR WRITING           42200021
         BO    EIN02900                 YES, BRANCH                     42300021
         NI    K0(RC),ALLBITS-DCBMREAD  TURN OFF OLD READ BIT           42500021
         OI    K0(RC),UCBMOUNT          TURN ON NEW READ INDICATOR      42600021
         SR    RWTG,RWTG                CLEAR REG                       42700021
         IC    RWTG,DCBOFFSR            GET READ CCW OFFSET             42800021
         LA    RWTG,K8(RWTG,RC)         GET READ CCW OFFSET PLUS A48213 43000021
*                                       EIGHT IN IOB             A48213 43050021
         TM    DCBCIND1,K1              QSAM EXCHANGE                   43700021
         BZ    EIN02800                 NO, BRANCH                      43800021
         LH    R0,DCBEROPT+K4           GET BLOCK FACTOR                43900021
         BCTR  R0,K0                    REDUCE COUNT BY ONE             44000021
         SLL   R0,K3                    MULTIPLY BY EIGHT               44100021
         AR    RWTG,R0                  DETERMINE OFFSET                44200021
EIN02800 EQU   *                        SEE IF BLOCK IS IN CORE         44300002
*                                                                       44400021
         L     R7,K16(RC)               GET ADDR OF CSW                 44500021
         LA    R7,K0(R7)                CLEAR HIGH ORDER BIT            44600021
         CR    RWTG,R7                  COMPARE COMPUTED ADDR TO CSW    44700021
         BH    EIN02900                 BRANCH IF THE COMPUTED   A48213 44800021
*                                       ADDRESS IS HIGHER THAN   A48213 44850021
*                                       THAT IN THE CSW          A48213 44860021
         BL    EIN02850                 BR IF AHEAD OF THE      ZA00004 44870002
*                                       READ CSW                ZA00004 44880002
         LA    R1,K8                    GET BACKUP VALUE        ZA00004 44890002
         SR    R7,R1                    DECREMENT R7 BY 8       ZA00004 44892002
         CLC   K22(K2,RC),K6(R7)        COMPARE THE CCW COUNT   ZA00004 44894002
*                                       FIELD WITH THE CSW      ZA00004 44896002
*                                       COUNT FIELD AND BR IF   ZA00004 44898002
*                                       EQUAL - HAVE NOT READ   ZA00004 44898402
*                                       ANY DATA INTO CORE      ZA00004 44898802
         BE    EIN02900                 BR IF EQUAL -NO READ    ZA00004 44899202
*                                       DATA IN CORE - DO NOT   ZA00004 44899602
*                                       SET THE BLOCK IN CORE   ZA00004 44899702
*                                       INDICATOR               ZA00004 44899802
EIN02850 EQU   *                                                ZA00004 44899902
*                                                                       44900021
         OI    K0(RC),K16               SET BLOCK IN CORE INDICATOR     45000021
         EJECT                                                          45100002
EIN02900 EQU   *                        PLACE SYNAD INFO IN R1/R2       45200002
*                                       TAKE SYNAD EXIT IF BSAM         45300002
*                                                                       45350002
         IC    R1,K0(RC)                GET ERROR INDICATORS            45400021
         SLL   R1,K24                   SHIFT TO HIGH BYTE              45500021
         OR    R1,RDCB                  PUT DCBAD IN SAME REG           45600021
         LR    RDCB,R1                  SAVE DCB AND RETURN CODE        45700021
         L     RF,DCBSYNAD              GET SYNAD ADDRESS               45800021
         XR    R7,R7                    PUT ENTRY CODE INTO REG  A44814 45850021
         TM    DCBCIND2,DCBC2QSM        DCB USING QSAM                  45900021
         BO    EIN02000                 YES, BRANCH                     46100021
         LR    R0,RPAR                  GET DECB ADDRESS FOR USER       46200021
*                                                                Y02082 46300002
*        MOVE REGS 0-6 IN SVRB INTO CALLER'S SAVE AREA           Y02082 46350002
*        MOVE REGS 2-8 IN CALLER'S SAVE AREA INTO SVRB           Y02082 46400002
*                                                                       46450002
*        CONTROL SHOULD NOW BE IN THE CALLER'S PROTECT KEY       Y02082 46500002
         LM    RDCB,R8,SAVREG2          GET SAVE AREA REGS 2-8   Y02082 46550002
         MVC   SAVREG0(SAVREG7-SAVREG0),RBGRS0    MOVE SVRB      Y02082 46600002
*                                       REGS 0-6 INTO SAVE AREA  Y02082 46650002
         MODESET EXTKEY=SUPR            SVRB KEY                 Y02082 46700002
         STM   RDCB,R8,RBGRS2           PUT SAVE AREA REGS 2-8   Y02082 46750002
*                                       INTO SVRB                Y02082 46760002
*                                                                       46800021
*               RETURN TO CHECK                                         46900002
*                                                                Y02080 46950002
*        RETURN TO CALLER                                        Y02080 46960002
*                                                                Y02080 46970002
         IECRES EXIT                    RETURN                   Y02080 46980002
         EJECT                                                          46990002
EIN03000 EQU   *                        QSAM I/O ERROR ANALYSIS         47300002
*                                                                       47500021
         TM    DCBSYNAD+K3,K1           SYNAD PRESENT IN DCB            47600021
         LA    R7,K4                    PUT ENTRY CODE IN REG           47700021
         BO    EIN02000                 NO, BRANCH                      47800021
*                                                                       47900021
         TM    DCBCIND2,DCBC2PUT        DID THE ERROR OCCUR WHILE       48000021
*                                       WE WERE CLOSING THE DATA SET    48100021
         LA    R7,MSG2                  GET ADDR OF MSG -ERR CLOSE DS-  48200021
         BCR   1,RBASE                  YES - BRANCH CANNOT GO TO       48300021
*                                         SYNAD FROM CLOSE NOW          48400021
*                                                                       48500021
         B     EIN02600                 BR TO CHK IF READ OR WRITE      48600021
         SPACE 2                                                        48601002
EIN03005 EQU   *                        CALLER HOLDS TIOT EXC    YM3185 48602002
*                                                                       48604002
*   THE CALLER OF EOV HOLDS THE TIOT RESOURSE EXCLUSIVELY.     @ZA29752 48605037
*   THIS SHOULD NEVER VALIDLY HAPPEN AND CANNOT BE ALLOWED.    @ZA29752 48615037
*                                                                       48625037
         SR    RF,RF                    ZERO REG               @ZA29752 48635037
         SR    RC,RC                    ZERO REG               @ZA29752 48645037
         LA    RF,K16                   RETURN CODE            @ZA29752 48655037
         L     RC,ABND50D               ABEND CODE             @ZA29752 48665037
         ABEND (RC),DUMP                                       @ZA29752 48675037
         EJECT                                                          48700002
*                                                                       48700802
EIN03010 EQU   *                        SWAP REGS              @ZA02545 48704002
*                                                                       48704802
*********************************************************************** 48705602
*                                                                       48706402
*        PREPARE TO SWAP SVRB REGS WITH USER REGS IN SAVE AREA          48708002
*        R13 = USER SAVE AREA                                           48712002
*        R5 = SVRB WITH CALLERS REGS                                    48716002
*        IT IS NECESSARY TO SWAP REGS IF CALLER                         48716802
*        IS AN ACCESS METHOD ROUTINE BECAUSE ACCESS                     48717602
*        METHODS CALL EOV WITH ITS REGS INSTEAD OF                      48718402
*        PROBLEM PROGRAM REGS WHICH HAVE BEEN SAVED                     48719202
*        IN THE PROBLEM PROGRAM SAVE AREA:                              48719302
*        USER SAVE AREA WORD 8 - WORD 16 = USER REGS 0 - 8              48719402
*        SVRB REG0 - 8 = ACCESS METHOD REG 0 - 8                        48719502
*        NOTE1- THE SWAP IS NECESSARY FOR TAKING USER EXITS.            48719602
*        NOTE2- THE REGS ARE SWAPPED BACK BEFORE EOV EXIT.              48719702
*        NOTE3- UNLESS DCBMACRF = EXCP THE CALLER IS ASSUMED            48719802
*               TO BE AN ACCESS METHOD.                                 48719902
*                                                                       48724002
*********************************************************************** 48728002
*                                                                       48732002
         L     RF,CVTPTR                LOAD CVT PTR           @ZA02545 48732802
         L     RF,CVTTCBP-CVT(,RF)      LOAD TCB PTRS          @ZA02545 48733602
         L     RF,K4(,RF)               LOAD CURRENT TCB       @ZA02545 48734402
         USING TCB,RF                   TCB ADDRESSABILITY     @ZA02545 48735202
         MODESET EXTKEY=RBT234,WORKREG=15 CALLER KEY           @ZA02545 48736002
         TM    DCBMACRF,DCBMEXCP        IF EXCP - NOSWAP       @ZA02545 48743902
         BO    EIN03020                 RETURN IF EXCP         @ZA02545 48747902
*                                                                       48748702
EIN03015 EQU   *                        SWAP REGS              @ZA02545 48751902
*                                                                       48755902
         L     RF,CVTPTR                LOAD CVT PTR           @ZA02545 48756102
         L     RF,CVTTCBP-CVT(,RF)      LOAD TCB PTRS          @ZA02545 48756202
         L     RF,K4(,RF)               LOAD CURRENT TCB       @ZA02545 48756302
         L     RET,TCBRBP               LOAD RB POINTER        @ZA02545 48756402
         USING RBBASIC,RET              RB ADDRESSABILITY      @ZA02545 48756502
         MODESET EXTKEY=ZERO            RB KEY                 @ZA02545 48756602
         STM   R0,R8,RBEXSAVE           SAVE REGS 0-8          @ZA02545 48756902
         MODESET EXTKEY=RBT234,WORKREG=15 CALLER KEY           @ZA02545 48757502
         LM    R0,R8,SAVREG0            LOAD USERS 0-8         @ZA02545 48758302
         MVC   SAVREG0(K9*K4),RBGRS0    SAVE CALLER REGS       @ZA02545 48759102
         MODESET EXTKEY=ZERO            RB KEY                 @ZA02545 48759202
         STM   R0,R8,RBGRS0             SAVE USERS REGS        @ZA02545 48759302
         LM    R0,R8,RBEXSAVE           LOAD EOV REGS          @ZA02545 48759402
         XC    RBEXSAVE(K9*K4),RBEXSAVE CLEAR SAVE AREA        @ZA02545 48759502
*                                                                       48759602
EIN03020 EQU   *                        SWAP REGS              @ZA02545 48759702
*                                                                       48759802
         L     RF,CVTPTR                LOAD CVT PTR           @ZA02545 48763902
         L     RF,CVTTCBP-CVT(,RF)      LOAD TCB PTRS          @ZA02545 48767902
         L     RF,K4(,RF)               LOAD CURRENT TCB       @ZA02545 48768702
         MODESET EXTKEY=RBT234,WORKREG=15 CALLER KEY           @ZA02545 48769702
         BR    R8                       RETURN                 @ZA02545 48780002
         DROP  RET                                             @ZA02545 48784002
         DROP  RF                                              @ZA02545 48788002
         EJECT                                                          48790002
         DS    0F                                              @ZA29752 48793037
ABND50D  DC    XL4'0000050D'            ABEND 50D CODE         @ZA29752 48796037
         DS    0H                                                       48800021
ABCOD    DC    X'1000'                  HWD OF 1000 FOR ABEND REQUEST   48900021
MSG1     DC    AL2(ENDMSG1-*)           MSG LINE FOR NO SYNAD EXIT      49000021
         DC    AL2(1)                   MSG                             49100021
         DC    C'IEC020I NO ERROR HANDLING, ' MSG TEXT PART 1    A39511 49160002
         DC    C'(SYNAD), EXIT SPECIFIED' MSG TEXT PART 2        A39511 49220002
ENDMSG1  EQU   *                        END OF MSG1                     49300002
         SPACE 2                                                        49350002
         DS    0H                                                       49400021
MSG2     DC    AL2(ENDMSG2-*)           MSG FOR ERROR CLOSING DATA SET  49500021
         DC    AL2(2)                   MSG                             49600021
         DC    C'IEC020I ERROR OCCURRED ' MSG TEXT PART 1               49700002
         DC    C'WHILE CLOSING DATA SET' MSG TEXT PART 2                49750002
ENDMSG2  EQU   *                        END OF MSG 2                    49800002
         SPACE 2                                                        49850002
         DS    0H                                                       49900021
MSG3     DC    AL2(ENDMSG3-*)           MSG TO GET ISSUED FROM EODAD    50000021
         DC    AL2(5)                   RETURN CODE              A39511 50100002
         DC    C'IEC020I GET '          MSG TEXT PART 1        @ZA02977 50200037
         DC    C'ISSUED AFTER END-OF-FILE' MSG TEXT PART 2       A39511 50250002
ENDMSG3  EQU   *                        END OF MSG3                     50300002
         SPACE 2                                                        50350002
IGG5E    DC    C'IFG055'                IST 6 CHARA OF EOV MOD NAME     50500021
DEBCKSS  DEBCHK AM=SUBSYS,MF=L          DEBAMTYP FOR SUBSYSTEM   Y02120 50550002
         EJECT                                                          50600002
XCTLTA5E XCTLTABL ID=(MOD0Z5E,1F,MOD2E5E,1D,MOD2F5E,1B,          X02989X51852002
               EOV,IGC0005E,                                     Y02080X51852402
               MODPD5E,0P),SVC=055,BRT=YES,LENGTH=               Y02080 51854002
         EJECT                                                          51858002
         IECEQU AOS=YES,IEZDEB=YES                               YM2869 51870002
         IECDSECS DCB,ACB,UCB,MAIN,CVT,TCB,WTG,TIOT,PREFX,       YM2869*51910002
               RB,RRPL,IEZDEB,EXPAND=YES                         YM2869 51920002
         IDAAMB                                                  X02989 51940002
         EJECT                                                          51960002
SAVEAREA DSECT                                                   Y02082 51970002
*        THIS DSECT MAPS THE SAVE AREA OF THE CALLER OF THE      Y02082 51972002
*        ACCESS METHOD (BSAM/QSAM).                              Y02082 51974002
*        THE ACCESS METHOD  SAVES REGISTERS 14-8 IN              Y02082 51980002
*        THE CALLER'S SAVE AREA STARTING WITH THE SIXTH WORD     Y02082 51990002
*        OF THE SAVE AREA - OFFSET 20 (X'14').                   Y02082 51992002
*        THE ACCESS METHOD DOES NOT ALTER REGS 9-13. HENCE,      Y02082 52042002
*        THESE REGISTERS ARE IN THE CURRENT SVRB.                Y02082 52092002
         DS    F                                                 Y02082 52150002
         DS    F                                                 Y02082 52200002
SAVREG11 DS    F                                                 Y02082 52250002
SAVREG12 DS    F                                                 Y02082 52300002
SAVREG13 DS    F                                                 Y02082 52350002
SAVREG14 DS    F                                                 Y02082 52400002
SAVREG15 DS    F                                                 Y02082 52450002
SAVREG0  DS    F                                                 Y02082 52500002
SAVREG1  DS    F                                                 Y02082 52550002
SAVREG2  DS    F                                                 Y02082 52600002
SAVREG3  DS    F                                                 Y02082 52650002
SAVREG4  DS    F                                                 Y02082 52700002
SAVREG5  DS    F                                                 Y02082 52750002
SAVREG6  DS    F                                                 Y02082 52800002
SAVREG7  DS    F                                                 Y02082 52850002
SAVREG8  DS    F                                                 Y02082 52900002
SAVREG9  DS    F                                                 Y02082 52950002
SAVREG10 DS    F                                                 Y02082 53000002
         END   ,                                                 Y02082 53100002
