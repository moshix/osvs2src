         TITLE 'IGC0010D - OPERATOR CONTROL INPUT HANDLER'              00050000
IGC0010D CSECT                                                          00052000
         SPACE 3                                                        00054000
*C000000-999999                                                  S99240 00056000
*A112500,128000,396000,402080,402280,427000,431000,456000,535000 S22024 00058000
*A555030                                                         S22024 00060000
*C006000,402320                                                  S22024 00062000
*C008000,015000,020000,023000,027000,029000,030000,049500        X02004 00064000
*C527000                                                         X02004 00066000
*A008200-008800,015000-015600,020300-020600,023300-023600,       X02004 00068000
*A030030-030900,032500,056500,057500,058300-058600,062500,063500 X02004 00070000
*A125200,125800,527027-527037,527061,527065,527070-527074        Y05330 00072000
*A527401-527402,527480,527497,                                   Y05330 00074000
*A125400-125600,527000-527025,527038-527060,527063-527064,       X02004 00076000
*A527066-527069,527075-527097,527099-527107-527112-527132,       X02004 00078000
*A527134-527176,527178-527363,527365-527368,527371-527400,       X02004 00080000
*A527403-527479,527481-527494,527498-527503,568050-568950        X02004 00082000
*C527098,527108-527110,527133,527177,527496                     SA60320 00084000
*C527364,527369-527370,527495                                   SA58435 00086000
*D368000-374000,377400                                          SA60006 00088000
*C527218                                                        SA61819 00090000
*A259000,261100,375400-376600                                   OY00466 00092000
*C375000                                                        OY00466 00094000
*A435000                                                        SA67769 00096000
*D451000                                                        SA67769 00098000
*C527566,527568                                                @SA70211 00100000
*D527234-527236                                                @SA71116 00102000
*A527244                                                       @SA71116 00104000
*C343000-348000                                                @YA04391 00106000
*C534200                                                       @YA07487 00108000
*C527142,527148                                                @XA06556 00110000
*A058300,102000,112500,527134,555270                           @XA06556 00112000
* A089200,402080                                               @SA74249 00114000
*A527994                                                       @YA10702 00116000
*C527118-527132,527138-527140,527160,527298-527310             @YA10702 00118000
*D527162-527190,527194-527266,527356                           @YA10702 00120000
*A280000,555600                                                @OZ09959 00120500
*C530000                                                       @OZ09959 00121000
*A186000                                                       @OY14481 00121500
*A016000,029000,058400,058600,398000,405000,422000,567000      @Y17XARX 00122000
*C006000,006006,388000                                         @Y17XARX 00124000
*D035000-037000,046000-048000,385000,399600-402520,550000,     @Y17XARX 00126000
*D551000,555260,555030,555150                                  @Y17XARX 00128000
*RESULT OF IGC0010D-IGC0J10D SPLIT                             @Y17XART 00130000
*A526000                                                       @Y17XART 00132000
*C125600                                                       @Y17XART 00134000
*D527002-527936  THIS CODE IS IN IGC0J10D                      @Y17XART 00136000
*D555277,527000-527998                                         @Y17XART 00138000
*A548310,548930,548962                                         @Y17XARW 00138600
*D402680-402800,548210                                         @Y17XARW 00139200
*A406780,555240                                                @Y17XARW 00139300
*A548931                                                       @Y17XARS 00139400
*C406240                                                       @Y17XARW 00139500
*D402840-406000,548180                                         @Y17XARW 00139600
*A184000,188000,376600,555000,568100                           @G36XRRU 00139700
*C377600,427500-429000,432000,438000,448000-453000             @G36XRRU 00139800
*D125400-125420,126100,259500,261100,448000-453000,525270-527997G36XRRU 00139900
*C548300                                                       @OX21052 00140082
*C280140,529000                                                @OZ30378 00140182
*********************************************************************** 00142082
*                                                                     * 00144000
* MODULE NAME = IGC0010D (TCAM,OPERATOR CONTROL)               @Y17XARX 00146000
*                                                                     * 00148000
* DESCRIPTIVE-NAME=OPERATOR CONTROL INPUT HANDLER - PART I     @Y17XART 00150000
*                                                                     * 00152000
* COPYRIGHT='NONE'                                                    * 00154000
*                                                                     * 00156000
* STATUS = VERSION 10.0                                        @Y17XARX 00158000
*                                                                     * 00700022
*FUNCTION - THIS MODULE IS CALLED FROM THE MESSAGE CONTROL PROG- X02004 00800005
*        RAM FOR PROCESSING OPERATOR CONTROL COMMANDS AND THE    X02004 00820005
*        APPLICATION PROGRAM FOR PROCESSING APPLICATION PROGRAM  X02004 00840005
*        MACROS. PROCESSING FROM THE MCP IS AS FOLLOWS: CALLING  X02004 00860005
*        IS FROM IEDQCA VIA SVC 104 WHEN INPUT IS POSTED TO      X02004 00880005
*        OPERATOR CONTROL OR FROM OTHER TRANSIENTS WHEN PROCESSING OF * 00900022
*        A PREVIOUS COMMAND IS ENDED.  WHEN CONTROL IS PASSED FROM    * 01000022
*        IEDQCA, GENERAL REGISTERS 14 AND 15 ARE SAVED.  WHEN ALL     * 01100022
*        COMMANDS HAVE BEEN PROCESSED, THESE REGISTERS ARE RESTORED   * 01200022
*        AND A BR 14 RETURNS TO IEDQCA.  PROCESSING OF INPUT IS       * 01300022
*        DOCUMENTED BELOW PRIOR TO THE ACTUAL CODE THAT DOES THE      * 01400022
*        PROCESSING. PROCESSING FROM MPP IS AS FOLLOWS:          X02004 01500005
*        THIS MODULE IS ENTERED FROM APPLICATION PROGRAM MACRO   X02004 01520005
*        FUNCTION MODULES VIA SVC 104. SOME MACRO FUNCTION ARE   X02004 01540005
*        PROCESSED HERE, THE REMAINDER PROCESSED IN IGC0A10D.    X02004 01560005
*        WHEN ENTRY FROM AN APPLICATION IS DETECTED, CONTROL   @Y17XART 01560200
*        IS TRANSFERED TO IGC0J10D VIA XCTL. IGC0J10D CONTAINS @Y17XART 01560400
*        ALL THE APPLICATION PROCESSING THAT PREVIOUSLY WAS IN @Y17XART 01560600
*        THIS MODULE.                                          @Y17XART 01560800
*                                                                     * 01600022
* NOTES = COMMUNICATIONS BETWEEN THE VARIOUS TRANSIENT MODULES @Y17XARX 01607000
* IS PRIMARILY THROUGH THE OPERATOR CONTROL AVT.               @Y17XARX 01614000
*   DEPENDENCIES = NONE                                        @Y17XARX 01621000
*   RESTRICTIONS = NONE                                        @Y17XARX 01628000
*   REGISTER CONVENTIONS = OPERATOR CONTROL                    @Y17XARX 01635000
*   PATCH LABEL = ZAPAREA                                      @Y17XART 01635500
*                                                              @Y17XARX 01649000
* MODULE TYPE = PROCEDURE                                      @Y17XARX 01656000
*   PROCESSOR = ASSEMBLER                                      @Y17XARX 01663000
*   MODULE SIZE = 2 K MAXIMUM                                  @Y17XARX 01666000
*   ATTRIBUTES = REUSABLE, REFRESHABLE, DISABLED,              @Y17XARX 01677000
*   TRANSIENT(TYPE 4), SUPERVISOR MODE                         @Y17XARX 01684000
*ENTRY POINTS - IGC0010D IS THE ONLY ENTRY POINT FOR THE MODULE.      * 01700022
*                                                                     * 01800022
*INPUT - THE ONLY INPUT REQUIRED FOR THIS MODULE IS THE ADDRESS OF    * 01900022
*        THE OPERATOR CONTROL AVT IN REGISTER 1 WHEN ENTRY IS    X02004 02000005
*        FROM MCP AND APPLICATION PROG PARAMETE LIST WHEN ENTRY  X02004 02030005
*        FROM MPP.                                               X02004 02060005
*                                                                     * 02100022
*OUTPUT - INFORMATION SET UP IN THE RESIDENT WORKAREA OR THE OPCE TO  * 02200022
*        BEPROCESSED BY OTHER SVC LOADS WHEN ENTRY FROM MCP.     X02004 02300005
*        WHEN ENTRY FROM MPP,FUNCTION IS PERFORMED WHICH RESULTS X02004 02330005
*        IN SOME CASES OF DATA BEING PASSED FROM MPP TO MCP.     X02004 02360005
*                                                                     * 02400022
*EXTERNAL REFERENCES --  SVC 102(AQCTL, SVC 34(QEDIT), SVC 7(XCTL)    * 02500022
*                                                                     * 02600022
*EXITS,NORMAL --XCTL TO SVC LOADS LISTED OR RETURN TO CALLER.    X02004 02700005
*              IGCM010D,IGCZ010D,IGCD010D,IGC0210D,IGC0310D,IGCR010D  * 02800022
*            IGC0110D,IGCV010D,IGCI010D,IGCH010D,IGC0A10D        X02004 02900005
*            IGCXX10D: 06,A0,N4,FC,FG,VI,VE,VA,VF,V8,0J,FK     @Y17XART 02905000
*EXITS,ERROR -- WHEN ENTRY FROM MCP - NONE                       X02004 03000005
*               WHEN ENTRY FROM FROM MPP AS FOLLOWS:             X02004 03003005
*        COMPLETION CODE - 4-INVALID TERMINAL NAME (QCOPY)       X02004 03006005
*                           -MCP NOT ACTIVE ( MCOUNT,TPDATE,CKREQX02004 03009005
*                           -CHECK POINT NOT VALID  (CKREQ)      X02004 03012005
*                           -QRESET UNABLE TO FIND ONE ONE OR    X02004 03015005
*                            MORE OF THE REQUESTED SEQUENCE NO.  X02004 03018005
*                            REG 2 WILL CONTAIN COUNT OF MSG PROCX02004 03021005
*        COMPLETION CODE - 8-MCP NOT ACTIVE CTCOPY,QCOPY,ICOPY,  X02004 03024005
*                              TCHNG)                            X02004 03027005
*                           -TCAM DEB NOT FOUND ( MCOUNT,TPDATE) X02004 03030005
*                           -REUSABLE DISK REORGANIZATION IN PROGX02004 03033005
*                            REG 2 WILL CONTAIN COUNT OF MESSAGESX02004 03036005
*                            PROCESS  BEFORE START OF REORGANIZATX02004 03039005
*                             ION.                               X02004 03042005
*                        -12-MCP NOT ACTIVE (MCPCLOSE,MRELEASE,  X02004 03045005
*                             ICHNG)                             X02004 03048005
*                           -NO TCAM DEB FOUND (QCOPY)           X02004 03051005
*                          -SEQUENCE NUMBER ERROR (QRESET)       X02004 03054005
*                        -16-QREST NOT ALLOWED FOR THIS MPP      X02004 03057005
*                        -20-INVALID TERMINAL TYPE (QCOPY)       X02004 03060005
*                           -MCP NOT ACTIVE (CQTAM RETRIEVE)     X02004 03063005
*                           -INVALID TERMINAL NAME OR TERM HELD  X02004 03066005
*                        -24-AN ERROR EXISTS REGARDING THE       X02004 03069005
*                            TYPE OF QUEUING OR THERE ARE NO     X02004 03072005
*                            MESSAGE QUEUED FOR THIS TERM (QRESETX02004 03075005
*                        -28-TERMINATE FUNCTION TO AVOID POSSIBLEX02004 03078005
*                            LOGICAL READ ERROR. REG 2 WILL CON- X02004 03081005
*                            TAIN COUNT OF MESSAGES MARKED UNSERVX02004 03084005
*                            ICED. NO MESSAGES ALE SCHEDULED TOBEX02004 03087005
*                            RESENT.                                    03090005
*                                                                     * 03100022
*TABLES/WORK AREAS - EXTERNAL--TCAM AVT AND OP CONTROL AVT            * 03200022
*                       TNT,QCB,DEB,DCB,PEWA                     X02004 03220000
*                   INTERNAL--CIBTBL,MPPTBL, AND XCTLTBL              * 03300022
*                                                                     * 03400022
*CHARACTER CODE DEPENDENCY --                                         * 03800022
*        THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL        * 03900022
*        REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS        * 04000022
*        EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME.  THE CODING     * 04100022
*        HAS BEEN ARRANGED SO THAT REDEFINITION OF CHARACTER          * 04200022
*        CONSTANTS, BY REASSEMBLY WILL RESULT IN A CORRECT MODULE     * 04300022
*        FOR THE NEW DEFINITION.                                      * 04400022
*                                                                     * 04480000
*        THIS IS A MODULE REWRITE AS OF OS/VS/TCAM LEVEL 2       X02004 04560000
*                                                                       04640000
*        THIS MODULE WAS SPLIT WITH THE APPLICATION PROCESSING @Y17XART 04720000
*        PROCESSING IN IGC0J10D AS OF TCAM 10.                 @Y17XART 04800000
*********************************************************************** 05000022
         EJECT                                                          05100022
*                           E Q U A T E S                               05200022
         SPACE                                                          05300022
RZERO    EQU   0                       PARAMETER REGISTER               05400022
RPARM    EQU   1                       PARAMETER REGISTER               05500022
ROPCAVT  EQU   2                       POINTER TO OPC AVT               05600022
RPARMA   EQU   2                        PROCESS PROG PARM LIST   X02004 05650005
ROPCE    EQU   3                       POINTER TO OPCE                  05700022
RCVT     EQU   3                        OS/VS COM VECTOR TABLE   X02004 05750005
RAVT     EQU   4                       POINTER TO TCAM AVT              05800022
RDEB     EQU   5                        DATA EXTENT BLOCK        X02004 05830005
RWORKAD  EQU   5                        XCTL AREA ADDRESS      @XA06556 05840058
RPRITABL EQU   5                        TOP OF PRIORITY TABLE  @Y17XARX 05850000
RTCB     EQU   6                        TASK CONTROL BLOCK       X02004 05860005
RPRITEND EQU   6                        END OF PRIORITY TABLE  @Y17XARX 05880000
RWORKA   EQU   7                       POINTER TO RESIDENT WORKAREA     05900022
RWORK    EQU   8                       WORK REGISTER                    06000022
RWORK1   EQU   9                       WORK REGISTER                    06100022
RPREFIX  EQU   10                      POINTER TO BUFFER                06200022
RQCB     EQU   10                       QUEUE CONTROL BLOCK      X02004 06250005
RCIB     EQU   11                      POINTER TO INPUT CIB             06300022
RCOUNT   EQU   11                       COUNT REGISTER           X02004 06350005
RBASE    EQU   12                      BASE REGISTER                    06400022
R13      EQU   13                       BASE FOR REG SAVEAREA           06500022
RRET     EQU   14                      RETURN REGISTER                  06600022
RBRNCH   EQU   15                      BRANCH REGISTER                  06700022
         SPACE 2                                                        06800022
AL0      EQU   0                       ZERO LENGTH - EXECUTED INSTRUCT  06900022
AL1      EQU   1                       MOVE LENGTH OF 1                 07000022
AL2      EQU   2                       MOVE LENGTH OF TWO               07100022
AL3      EQU   3                       LENGTH 3                         07200022
AL4      EQU   4                       MOVE LENGTH OF FOUR              07300022
AL7      EQU   7                   BLANK EIGHT BYTES                    07400022
AL8      EQU   8                       MOVE, COMPARE LENGTH OF 8        07500022
APPLICAT EQU   X'20'                   INDICATES APPLICATION PROG IN    07600022
APPBTU   EQU   X'D3'                    BTU FOR APPLICATION      S22024 07750022
CVTPTR   EQU   16                       LOW CORE ADDRESS OF CVT         08400022
EQUAL    EQU   8                       BRANCH EQUAL                     08500022
FFBYTE   EQU   255                     BYTE OF ALL ONE'S                08600022
FOUR     EQU   4                        VALUE FOUR                      08700022
LCBS     EQU   1                        INDICATES STOPPED LCB TO 210D   08800022
LCBSTOP  EQU   X'E8'                   PRIORITY OF STOPPED LCB          08900022
MSG18    EQU   18                       MESSAGE NUMBER 18               09000022
OFF00    EQU   0                       LOAD OFFSET OF ZERO              09300022
OFF01    EQU   1                       MOVE OFFSET                      09400022
OFF02    EQU   2                       MOVE OFFSET                      09500022
OFF03    EQU   3                       MOVE OFFSET                      09600022
OFF04    EQU   4                       LOAD OFFSET                      09700022
OFF05    EQU   5                       MOVE OFFSET                      09800022
OFF08    EQU   8                       LOAD OFFSET                      09900022
OFF09    EQU   9                       MOVE OFFSET                      10000022
OFF0A    EQU   10                       OFFSET 10                       10200022
OFF0B    EQU   11                       MOVE OFFSET            @XA06556 10250058
OFF0C    EQU   12                       OFFSET 12              @G36XRRU 10270000
OFF10    EQU   16                      LOAD OFFSET                      10300022
OFF18    EQU   X'18'                   BRANCH OFFSET                    10400022
ONE      EQU   1                        VALUE ONE                       10500022
QUOTE    EQU   X'7D'                   QUOTE IN HEX                     10600022
QUOTSW   EQU   X'20'                   INDICATE QUOTE IN DATA           10700022
THRCLOSE EQU   12                      THRESHOLD CLOSEDOWN              10800022
THREE    EQU   3                        VALUE THREE                     10900022
TIC02    EQU   2                       TIC OF LAST UNIT        @YM08147 10950000
TOTE     EQU   X'40'                   TOTE INPUT                       11000022
ZERO     EQU   0                       CLEAR HIGH BYTE                  11100022
NOTCA2   EQU   2                        TWO                      S22024 11200022
THIRTY4  EQU   34                       SVC NUMBER                      11250022
XFF      EQU   X'FF'                    MASK VALUE               S22024 11270022
         EJECT                                                          11300022
         USING IEDQAVTD,RAVT           TCAM AVT ADDRESSABILITY          11400022
         USING IEDQCIB,RCIB        CIB ADDRESSABILITY                   11500022
         USING IEDQOPCE,ROPCE          OPCE ADDRESSABILITY              11600022
         USING IEDQOPCD,ROPCAVT    ADDRESSABILITY FOR OPC AVT           11700022
         BALR  RBASE,ZERO               SET BASE                        11800022
         USING *,RBASE             ADDRESSABILITY                       11900022
IGC0010D IEDHJN SKIPID                                                  12000022
         LR    ROPCAVT,RPARM       PICK UP OPC AVT ADDRESS              12500022
*                                       OR APPLICATION PROG PARM Y05330 12520005
OPCENTRY EQU   *                                                 Y05330 12580005
         L     RAVT,OPCAVTPT       POINT TO TCAM AVT                    12600022
         LA    R13,OPCSAVE              GET ADDRESS OF REG SAVEAREA     12700022
         L     RWORKA,OPCWORK      GET ADDRESS OF WORKAREA              12800022
         TM    OPCSPEC,OPCFRMCA         ENTRY FROM IEDQCA        S22024 12900022
         BZ    NOTCA                    BRANCH IF NO             S22024 12960022
         NI    OPCSPEC,XFF-OPCFRMCA     TURN OFF ENTRY-FROM-CA   S22024 13020022
         STM   RRET,RBRNCH,OPCRSAVE SAVE CA REGISTERS                   13100022
         XC    OPCNEXT(AL4),OPCNEXT CLEAR NEW POINTER                   13300022
NOTCA    EQU   *                                                        13400022
         TITLE 'IGC0010D - TEST FOR COMMAND FREED FOR RESOURCES'        13500022
*********************************************************************** 13600022
*                                                                     * 13700022
*        THE FIRST CHECK PERFORMED HERE IS TO SEE IF THE PREVIOUS     * 13800022
*        COMMAND FREED RESOURCES NEEDED BY A WAITING COMMAND.         * 13900022
*        THIS IS ACCOMPLISHED BY CHECKING OPCNEXT IN THE AVT TO SEE IF* 14000022
*        IT IS ZERO.  THIS FIELD IS SET ONLY BY IGC0710D WHEN A       * 14100022
*        COMMAND COMPLETES AND HAS ANOTHER COMMAND (ELEMENT)          * 14200022
*        ATTACHED (OCATTACH SET IN OCFLAG).  THE WAITING ELEMENT      * 14300022
*        POINTED TO BY OPCNEXT NOW BECOMES THE CURRENT COMMAND        * 14400022
*        (ELEMENT).  THE OCWTG FIELDS ARE USED TO RESTART ELEMENT     * 14500022
*        PROCESSING WHERE WAS INTERRUPTED BECAUSE OF RESOURCE         * 14600022
*        CONFLICT.  IF OPCNEXT IS ZERO, THE NEXT CHECK IS FOR RESTART.* 14700022
*                                                                     * 14800022
*********************************************************************** 14900022
         SPACE                                                          15000022
         L     ROPCE,OPCNEXT       GET ADDRESS OF NEXT COMMAND          15100022
         LA    ROPCE,AVTEZERO(ROPCE) CLEAR HIGH BYTE                    15200022
         LTR   ROPCE,ROPCE         ANY?                                 15300022
         BZ    CHEKINPT            NO, CHECK OTHER INPUT                15400022
         SPACE                                                          15500022
         ST    ROPCE,OPCCOPCE      SAVE ELEMENT POINTER                 15600022
         MVC   OPCLDNME+OFF03(AL2),OCWTG PICK UP WHERE TO GO NAME       15700022
         XC    OCWTG(AL2),OCWTG         CLEAR OUT WTG FIELD             15750022
         LH    RZERO,OCPARM        SET PARAMETER                        15800022
         XC    OPCNEXT(AL4),OPCNEXT CLEAR NEW POINTER                   15900022
         B     XCTLTBL1            CALL INDICATED MODULE                16000022
         TITLE 'IGC0010D - CHECKPOINT RESTART CODE'                     16100022
*********************************************************************** 16200022
*                                                                     * 16300022
*        A CHECK IS MADE FOR RESTART AT THIS POINT.  IF RESTART IS    * 16400022
*        IN PROGRESS, THE RESTART ELEMENT IS OBTAINED FROM OPCCOPCE   * 16500022
*        WHERE IT WAS SAVED BY IEDQND. THE VERB FIELD IN THE ELEMENT IS 16600022
*        USED TO LOCATE THE CORRECT MODULE TO WHICH THE INPUT SHOULD  * 16700022
*        BE PASSED.  AN XCTL TO THE CORRECT MODULE STARTS REPROCESSING* 16800022
*        OF THE CHECKPOINTED ELEMENT.                                 * 16900022
*                                                                     * 17000022
*********************************************************************** 17100022
         SPACE                                                          17200022
CHEKINPT EQU   *                                                        17300022
         TM    OPCSPEC,OPCRSTRT    RESTART IN PROGRESS?                 17400022
         BNO   NORMAL                   NO, CHECK FOR CLOSEDOWN         17500022
         SPACE                                                          17600022
         L     ROPCE,OPCCOPCE           GET RESTART RECORD INSERTED     17700022
*                                       HERE BY IEDQND                  17800022
         LA    RWORK,OCOPTCDE      POINT TO COMMAND CODE                17900022
         LA    RWORK1,CIBTBL       POINT TO CONSOLE TABLE               18000022
         TM    OCFLAG,TOTE+APPLICAT INPUT FROM TOTE OR MPP?             18100022
         BZ    RECHECK             NO, SKIP NEXT LOAD                   18200022
         SPACE                                                          18300022
         LA    RWORK1,MPPTBL       POINT TO OTHER TABLE                 18400022
         TM    OCFLAG,APPLICAT     INPUT FROM MPP              @G36XRRU 18420000
         BZ    RECHECK             NO, BRANCH                  @G36XRRU 18440000
         MVC   OPCLDNME+OFF03(AL2),XCTL0A SET FOR XCTL TO 0A   @G36XRRU 18460000
         B     RECHECK1            PREPARE TO XCTL             @G36XRRU 18480000
RECHECK  EQU   *                                                        18500022
         BAL   RRET,CHKVERB        CHECK INPUT VERB                     18600022
         B     RSTRTOK                  VALID VERB             @OY14481 18610000
         B     RETURN                   RETURN IF ERROR FOR    @OY14481 18620000
*                                       PERMANENT WAIT-THIS IS @OY14481 18630000
*                                       A SHOULD NOT OCCUR     @OY14481 18640000
*                                       CONDITION                       18650000
RSTRTOK  EQU   *                                                        18660000
         SPACE                                                          18700022
         MVC   OPCLDNME+OFF03(AL2),OFF01(RWORK1) SET UP XCTL NAME       18800022
RECHECK1 EQU   *                                               @G36XRRU 18850000
         NI    OCFLAG,FFBYTE-OCATTACH CUT OFF ATTACHED FLAG             18900022
         SPACE                                                          19000022
         B     XCTLTBL1            XCTL TO NEXT LOAD                    19100022
         TITLE 'IGC0010D - CONSOLE INPUT PROCESSOR'                     21000022
*********************************************************************** 21100022
*                                                                     * 21200022
*        THIS ROUTINE CHECKS FOR CONSOLE INPUT AND PROCESSES IT.      * 21300022
*        IF CLOSEDOWN IS IN PROGRESS, ALL CONSOLE INPUT IS DEQUEUED   * 21400022
*        AND A XCTL IS DONE TO PUT OUT AN ERROR MESSAGE INDICATING    * 21500022
*        THE INPUT WAS FLUSHED.  OTHERWISE,  THE VERB IN THE INPUT CIB* 21600022
*        IS MATCHED WITH ONE IN THE TABLE CIBTBL IN THIS MODULE.  IF  * 21700022
*        NO MATCH IS FOUND, THE CIB IS FREED AND A CHECK FOR MORE     * 21800022
*        INPUT IS MADE.  FOR VALID VERBS, A BUFFER UNIT IS GOTTEN     * 21900022
*        TO BE USED AS THE OPCE (CURRENT ELEMENT).  THE VERB IS THEN  * 22000022
*        MOVED TO THE ELEMENT ALONG WITH THE CONSOLE ID.  THE OCCONSOL* 22100022
*        FLAG IS SET IN THE OCFLAG FIELD TO INDICATE CONSOLE INPUT.   * 22200022
*        A SCAN OF THE INPUT IS NOW DONE TO CHECK FOR QUOTES AND THE  * 22300022
*        LENGTH OF THE DATA.  THE DATA IS THEN MOVED TO THE RESIDENT  * 22400022
*        WORKAREA ALONG WITH THE INPUT LENGTH FOR LATER MODULE PROCESS* 22500022
*        ING.  THE CIB IS THEN FREED AND A XCTL TO THE CORRECT        * 22600022
*        SCANNING MODULE IS EFFECTED.                                 * 22700022
*                                                                     * 22800022
*********************************************************************** 22900022
         SPACE                                                          23000022
NORMAL   EQU   *                                                        23100022
         L     RWORK,AVTCOMPT      GET CSCB ADDRESS                     23200022
         LA    RZERO,FOUR(RWORK)   POINT TO HEAD OF CIB QUEUE           23300022
         L     RCIB,OFF04(RWORK)   PICK UP ADDRESS OF FIRST CIB         23400022
         TM    AVTBIT1,AVTCLOSN    CLOSEDOWN IN PROGRESS?               23500022
         BNO   CONINPUT            NO, CHECK SOURCE OF INPUT            23600022
         SPACE                                                          23700022
         TM    AVTCKELF,AVTCMCPN        CLOSEDOWN COMPLETE              24100022
         BO    RETURN                   RETURN TO IEDQCA                24200022
         SR    RPARM,RPARM         CLEAR REG 1 FOR QEDIT                24600022
         LCR   RZERO,RZERO         INDICATE FREE ALL                    24700022
         SPACE                                                          24800022
         SVC   THIRTY4                  QEDIT                           24900022
         SPACE                                                          25000022
         SPACE                                                          25700022
CONINPUT EQU   *                                                        25800022
         LA    RCIB,ZERO(RCIB)     PICK OFF HIGH BITS                   25900022
         LTR   RCIB,RCIB           CONSOLE INPUT                        26000022
         BZ    BUFFINPT            NO, INPUT FROM TCAM                  26100022
         TM    AVTBIT1,AVTCLOSN         CLOSEDOWN IN PROGRESS           26130022
         BO    CLOSEMSG                 YES                             26160022
         SPACE                                                          26200022
         SR    RWORK,RWORK         CLEAR FOR VERB INSERT                26300022
         LA    RWORK,CIBVERB       POINT TO VERB CODE                   26400022
         LA    RWORK1,CIBTBL       POINT TO CORRECT VERB TABLE          26500022
         BAL   RRET,CHKVERB        VERIFY GOOD VERB                     26600022
         SPACE                                                          26700022
         B     GOODVERB            GOOD RETURN, VERB IS CORRECT         26800022
NXTCIB   EQU   *                                                        26850022
         SPACE                                                          26900022
         LR    RPARM,RCIB          POINT TO CIB TO BE REMOVED           27000022
         L     RCIB,CIBNEXT        GET NEXT CIB ADDRESS                 27100022
         L     RWORK,AVTCOMPT      GET CSCB ADDRESS                     27200022
         LA    RZERO,FOUR(RWORK)   POINT TO HEAD OF CIB QUEUE           27300022
         SPACE 2                                                        27400022
****    REMOVE CIB FROM QUEUE    ****                                   27500022
         QEDIT BLOCK=(1),ORIGIN=(0) REMOVE CIB FROM QUEUE               27600022
         SPACE                                                          27700022
         B     CONINPUT            CHECK FOR ANOTHER COMMAND            27800022
CLOSEMSG EQU   *                                                        27820022
         LA    RPARM,CLSMSG             ADDRESS OF MSG                  27840022
         WTO   MF=(E,(1))               WRITE TO OPERATOR               27860022
         B     NXTCIB                   GET NEXT CIB                    27880022
         SPACE                                                          27900022
GOODVERB EQU   *                                                        28000022
         CLC   CIBVERB(AL1),MODIFY      MODIFY REQUEST         @OZ09959 28007000
         BE    CKREADY                  YES, CHECK FOR READY   @OZ30378 28014082
         CLC   CIBVERB(AL1),VARY        VARY REQUESTED         @OZ30378 28015082
         BNE   NRESTART                 NO, CONTINUE           @OZ30378 28016082
CKREADY  EQU   *                                               @OZ30378 28017082
         TM    AVTBIT1,AVTREADN         READY EXECUTED         @OZ09959 28021000
         BO    NRESTART                 YES,CONTINUE           @OZ09959 28028000
         TM    AVTBIT2,AVTSTRTN         RESTARTING TCAM        @OZ09959 28035000
         BNO   NRESTART                 NO, CONTINUE           @OZ09959 28042000
         LA    RPARM,NREADYM            PREVENT PROCESSING     @OZ09959 28049000
         SR    RZERO,RZERO              CLEAR FOR CONSOLE ID   @OZ09959 28056000
         IC    RZERO,CIBCONID           GET ID FOR RESPONSE    @OZ09959 28063000
         WTO   MF=(E,(1))               INFORM OPERATOR        @OZ09959 28070000
         B     NXTCIB                   GET NEXT REQUEST       @OZ09959 28077000
NRESTART EQU   *                                               @OZ09959 28084000
         BAL   RWORK,GETBUFF            GET OPCE UNIT                   28100022
         SPACE                                                          28200022
         MVC   OCOPTCDE(AL1),CIBVERB    MOVE VERB TO OPCE               28300022
         MVI   OCSWITCH,AVTEZERO        INIT FIELD               S22024 28400022
         OI    OCFLAG,OCCONSOL          INDICATE SYSCON INPUT           28500022
         MVC   OCCONID(AL1),CIBCONID    SAVE CONSOLE ID                 28600022
         MVC   OPCLDNME+OFF03(AL2),OFF01(RWORK1) SET XCTL MODULE NAME   28700022
         LA    RPREFIX,CIBDATA     POINT TO DATA FIELD                  28800022
         LH    RWORKA,CIBDATLN     GET LENGTH OF DATA                   28900022
         N     RWORKA,AVTCLRHI     CLEAR LEFT BYTES OF REG              29000022
         LR    RWORK,RWORKA        SAVE BEGINNING COUNT                 29100022
LOCATEND EQU   *                                                        29200022
         LA    RPREFIX,ONE(RPREFIX) POINT TO NEXT INPUT BYTE            29300022
         BCT   RWORKA,CONTSCAN     BRANCH IF REMAINING LENGTH NOT ZERO  29400022
         SPACE                                                          29500022
         B     ENDINPUT            BRANCH, END OF COMMAND FOUND         29600022
         SPACE                                                          29700022
CONTSCAN EQU   *                                                        29800022
         TM    OPCFLAG1,QUOTSW     PREVIOUS QUOTE FOUND?                29900022
         BO    SKIPBLNK            YES, DO NOT CHECK BLANKS IN DATA     30000022
         SPACE                                                          30100022
         CLI   OFF00(RPREFIX),AVTEBLNK CHARACTER A BLANK?               30200022
         BE    ENDINPUT            YES, END OF INPUT, CALCULATE LENGTH  30300022
         SPACE                                                          30400022
SKIPBLNK EQU   *                                                        30500022
         CLI   OFF00(RPREFIX),QUOTE QUOTE IN DATA                       30600022
         BNE   LOCATEND            NO, CONTINUE SEARCH FOR END          30700022
         SPACE                                                          30800022
         TM    OPCFLAG1,QUOTSW     PREVIOUS QUOTE IN THIS DATA          30900022
         BO    PREVQUOT            YES, CHECK DOUBLE QUOTES HERE        31000022
         SPACE                                                          31100022
         OI    OPCFLAG1,QUOTSW     INDICATE QUOTE FOUND DATA            31200022
         B     LOCATEND            SCAN REMAINING INPUT                 31300022
         SPACE                                                          31400022
PREVQUOT EQU   *                                                        31500022
         BCTR  RWORKA,RZERO        INCLUDE QUOTE IN COMMAND LENGTH      31600022
         LTR   RWORKA,RWORKA       END OF DATA?                         31700022
         BZ    ENDSCAN             YES, CLEAR FLAG FOR QUOTE            31800022
         CLI   OFF01(RPREFIX),QUOTE NEXT CHARACTER A QUOTE?             31900022
         BNE   ENDDATA             NO, END OF COMMAND FOUND             32000022
         SPACE                                                          32100022
         LA    RPREFIX,ONE(RPREFIX) POINT TO NEXT BYTE                  32200022
         SPACE                                                          32300022
         B     LOCATEND                 SCAN REMAINING INPUT            32400022
         SPACE                                                          32500022
ENDDATA  EQU   *                                                        32600022
         SPACE                                                          32700022
         CLI   OFF01(RPREFIX),AVTEBLNK BLANK AFTER QUOTE?               32800022
         BNE   ENDINPUT            NO, PROBABLE ERROR                   32900022
         SPACE                                                          33000022
ENDSCAN  EQU   *                                                        33100022
         NI    OPCFLAG1,FFBYTE-QUOTSW CLEAR PREVIOUS QUOTE FLAG         33200022
ENDINPUT EQU   *                                                        33300022
         SPACE                                                          33400022
         SR    RWORK,RWORKA        CALCULATE ACTUAL LENGTH              33500022
         L     RWORKA,OPCWORK      PICK UP WORKAREA ADDRESS             33600022
         STH   RWORK,OFF02(RWORKA) PLACE LENGTH IN WORKAREA             33700022
         MVI   OFF08(RWORKA),AVTEBLNK SET FIRST BLANK                   33800022
         MVC   OFF09(AL7,RWORKA),OFF08(RWORKA) CLEAR FIELD              33900022
         BCTR  RWORK,RZERO         DECREMENT FOR EXECUTE                34000022
         EX    RWORK,DATAMOVE      PLACE DATA IN WORKAREA               34100022
         SPACE                                                          34200022
         L     RBRNCH,OPCCKCIB                     ADDR OF RTN @YA04391 34300056
         BALR  RRET,RBRNCH              BRANCH TO SUBROUTINE   @YA04391 34500056
         B     CLOSEMSG                 NOT STOP TCAM          @YA04391 34700056
         SPACE                                                          34900022
         TM    OPCFLAG1,QUOTSW     ONLY ONE QUOTE FOUND?                35000022
         BNO   XCTLTBL1            NO, CALL NEXT MODULE                 35100022
         SPACE                                                          35200022
         LA    RZERO,MSG18              GET ERROR NUMBER                35300022
         MVC   OPCLDNME+OFF03(AL2),ERRXCTL SET XCTL NAME                35400022
         B     XCTLTBL1                 CALL NEXT MODULE                35500022
         SPACE                                                          35600022
DATAMOVE MVC   OFF08(AL0,RWORKA),CIBDATA MOVE DATA TO WORKAREA          35700022
         SPACE                                                          35800022
         TITLE 'IGC0010D - TCAM INPUT PROCESSOR'                        35900022
*********************************************************************** 36000022
*                                                                     * 36100022
*        THIS ROUTINE HANDLES ALL OTHER INPUT TO OPERATOR CONTROL     * 36200022
*        AND CALLS THE CORRECT SVC LOAD TO HANDLE IT.  TOTE OR MPP    * 36300022
*        INPUT IS HANDLED IN THIS MODULE IN CODE BELOW.  COMMANDS FROM* 36400022
*        OPERATOR CONTROL TERMINALS ARE DEQUEUED FROM THE INPUT QUEUE * 36500022
*        AND A XCTL TO IGC0110D IS EFFECTED FOR FURTHER PROCESSING.   * 36600022
*        STOPPED LCBS, ARE SENT TO IGCZ110D, MCPCLOSE PROCESSING      * 36700022
*        ROUTINE IF THE CLOSEDOWN BIT IN THE AVT IS ON, OR TO         * 36710022
*        IGCV110D, STOPLINE ROUTINE, IF IT IS NOT ON. RPL RESPONSES ARE 36720022
*        DEQUEUED AND SENT TO IGC0210D FOR PROCESSING VIA XCTL.  IF   * 36730022
*        THERE IS NO INPUT ON THE QUEUE AT THIS POINT, CONTROL IS     * 36740022
*        RETURNED TO IEDQCA.                                          * 36750022
*                                                                     * 36760022
*********************************************************************** 36770022
         SPACE                                                          36780022
BUFFINPT EQU   *                                                        36790022
         L     RWORK,AVTCOMPT           GET CSCB ADDRESS        OY00466 37500005
         ICM   RWORK,ADDRESS,ONE(RWORK) CIB'S SPECIFIED         OY00466 37540005
         BZ    NOCIBS                   NO, BRANCH              OY00466 37580005
         MVI   ZERO(RWORK),AVTEZERO     CIB QUEUE IS EMPTY,     OY00466 37620005
NOCIBS   EQU   *                        ENSURE ECB IS NOT POSTEDOY00466 37660005
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,               *37670000
               RELATED=ATTACHED-TACKS-IGG019RO(SETATSK)        @G36XRRU 37680000
         L     RWORK,AVTOPCOB      PICK UP FIRST ELEMENT ON QUEUE       37700022
         MVC   AVTOPCOB+OFF01(AL3),OFF05(RWORK) DEQUEUE THIS INPUT      37720022
         SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                          *37730000
               RELATED=IGC0010D(SETATSK)                       @G36XRRU 37740000
         LA    RWORK,ZERO(RWORK)   CLEAR HIGH BYTE                      37800022
         C     RWORK,AVTDELAD      DUMMY LAST ELEMENT?                  37900022
         BE    RETURN              YES, NOTHING TO PROCESS              38000022
         SPACE                                                          38100022
         ST    RWORK,OPCCOPCE      CURRENT ELEMENT POINTER              38200022
         SPACE                                                          38400022
         LA    RZERO,LCBS          INDICATE TO 210D A STOPPED LCB       38600022
         LA    RWORK1,XCTLTBL1          SET REG FOR BRANCH       S22024 38650022
         CLI   OFF04(RWORK),LCBSTOP STOPPED LCB?                        38700022
         BNE   CKBCH                    IF NOT, CHECK PRIORITY @Y17XARX 38800000
         SPACE                                                          38900022
         MVC   OPCLDNME+OFF03(AL2),RNSTOPLN STOPLINE FOR 3705    S22024 38950022
         LA    RZERO,NOTCA2                                             39600022
PLCBFLG1 EQU   X'20'                    OFFSET INTO PLCB         S22024 39620022
         CLI   PLCBFLG1(RWORK),ZERO     3705 PLCB ?              S22024 39630022
         BCR   E,RWORK1                 YES, BRANCH              S22024 39640022
         SPACE                                                          39660022
         MVC   OPCLDNME+OFF03(AL2),XCTLZ1 SET FOR CLOSEDOWN      S22024 39680022
         TM    AVTBIT1,AVTCLOSN         CLOSEDOWN IN PROGRESS    S22024 39700022
         BCR   NZ,RWORK1                YES, GO TO Z1            S22024 39720022
         MVC   OPCLDNME+OFF03(AL2),XCTLV1 GO PROCESS LCB         S22024 39740022
         BR    RWORK1                   XCTL TO V1               S22024 39760022
         SPACE                                                          39800022
         EJECT                                                 @Y17XARX 39809000
         TITLE 'IGC0010D- TCAM INPUT PROCESSOR'                @Y17XARX 39818000
***************************************************************@Y17XARX 39827000
*        AT THIS POINT A SERIES OF CHECKS IS MADE TO ROUTE     @Y17XARX 39836000
*        ELEMENTS BASED ON INPUT PRIORITIES.  TWO INTERNAL     @Y17XARX 39845000
*        IGC0010D TABLES ARE USED.  'PRINOFLG' IS USED TO      @Y17XARX 39854000
*        ESTABLISH ROUTINGS FOR PRIORITIES WITH NO FLAG BYTE   @Y17XARX 39863000
*        ENTRIES.  'PRIFLAGS' IS THE TABLE USED TO DETERMINE   @Y17XARX 39872000
*        ROUTINGS FOR INPUT WITH FLAG-KEYED ENTRIES.           @Y17XARX 39881000
***************************************************************@Y17XARX 39890000
CKBCH    EQU   *                                                        39900022
         USING IEDOPRED,RWORK           ESTAB ADDR TO OPRE     @Y17XARX 40603000
         LA    RPRITABL,PRINOFLG        ESTAB ADDR TABLE TOP   @Y17XARX 40606000
         LA    RPRITEND,PRINOEND        ESTAB ADDR TABLE END   @Y17XARX 40609000
NOFLAG   EQU   *                                               @Y17XARX 40612000
         CR    RPRITABL,RPRITEND        END OF TABLE ?         @Y17XARX 40615000
         BE    CKWTHFLG                 YES,GO CHK PRIOR & FLAG@Y17XARX 40618000
         CLC   OPREPRI,ZERO(RPRITABL)   INPUT = TABLE ?        @Y17XARX 40621000
         BE    CHKCLOSE                 CHECK FOR CLOSEDOWN    @Y17XARW 40624000
         LA    RPRITABL,PRINFLG1(RPRITABL)   BUMP BY TABLEWIDTH@Y17XARX 40627000
         B     NOFLAG                   START LOOP AGAIN       @Y17XARX 40630000
CKWTHFLG EQU   *                                               @Y17XARX 40633000
         LA    RPRITABL,PRIFLAGS        ESTAB ADDR TABLE TOP   @Y17XARX 40636000
         LA    RPRITEND,PRIWEND         ESTAB ADDR TABLE END   @Y17XARX 40639000
CKWTHFL2 EQU   *                                               @Y17XARX 40642000
         CR    RPRITABL,RPRITEND        END OF TABLE ?         @Y17XARX 40645000
         BE    TOTEMPP                  CONTINE TO TOTE/MPP    @Y17XARX 40648000
         CLC   OPREPRI,ZERO(RPRITABL)   INPUT = TABLE ?        @Y17XARX 40651000
         BE    CKFLGBYT                 GO MATCH FLAG BYTE     @Y17XARX 40654000
         LA    RPRITABL,PRIFLGS1(RPRITABL)  BUMP BY TABLEWIDTH @Y17XARX 40657000
         B     CKWTHFL2                 START LOOP AGAIN       @Y17XARX 40660000
CKFLGBYT EQU   *                                               @Y17XARX 40663000
         LA    RPRITABL,ONE(RPRITABL)   INCREMENT REG BY ONE   @Y17XARX 40666000
         CLC   OPREFLG1,ZERO(RPRITABL)  FLAG IN TABLE ?        @Y17XARX 40669000
         BE    MOVETOID                 GO PROCESS ROUTING     @Y17XARX 40672000
         LA    RPRITABL,PRIFLGS1-ONE(RPRITABL)  BUMP BY WIDTH  @Y17XARX 40675000
         B     CKWTHFL2                 LOOP & REFIND PRIOR    @Y17XARX 40678000
CHKCLOSE EQU   *                                               @Y17XARW 40678400
         CLC   ONE(AL2,RPRITABL),XCTL01 NEW TERMINAL INPUT?    @Y17XARW 40678800
         BNE   MOVETOID                 NO, PREPARE TO XCTL    @Y17XARW 40679200
         TM    AVTBIT1,AVTCLOSN         CLOSEDOWN IN PROGRESS? @Y17XARW 40679600
         BO    FREE                     YES, FREE BUFFER AND   @Y17XARW 40680000
*                                       RETURN TO IEDQCA       @Y17XARW 40680400
MOVETOID EQU   *                                               @Y17XARX 40681000
         MVC   OPCMODID-IEDQOPCD(AL2,ROPCAVT),ONE(RPRITABL)    @Y17XARX 40684000
*                        SET UP ROUTE CODE IN XCTL NAME 'MODID'@Y17XARX 40687000
         DROP  RWORK                                           @Y17XARX 40690000
         B     XCTLTBL1                 XCTL TO CORRECT MODULE @Y17XARX 40693000
         TITLE 'IGC0010D - TOTE AND MPP INPUT HANDLER'                  41000022
*********************************************************************** 41100022
*                                                                     * 41200022
*        AT THIS POINT THE INPUT HAS BEEN DEQUEUED AND A DETERMINATION* 41300022
*        MADE THAT IT IS FROM TOTE OR A MESSAGE PROCESSING PROGRAM.   * 41400022
*        A BUFFER UNIT IS GOTTEN TO SERVE AS THE OPCE AND AFTER THE   * 41500022
*        VERB IS VERIFIED ALL INPUT DATA IS MOVED FROM THE CIB TO THE * 41600022
*        OPCE FOR PROCESSING.  AN XCTL IS EXECUTED TO START COMMAND   * 41700022
*        PROCESSING.  IF THE CIB WAS FOR THRESHOLD CLOSEDOWN, THE UNIT* 41800022
*        IS FREED BY GOING TO IGC0710D AND A CHECK FOR MORE INPUT     * 41900022
*        WILL BE DONE.                                                * 42000022
*                                                                     * 42100022
*********************************************************************** 42200022
         SPACE                                                          42300022
TOTEMPP  EQU   *                                               @Y17XARX 42350000
         LR    RCIB,RWORK          SAVE REQUEST ADDRESS                 42400022
         BAL   RWORK,GETBUFF            GET OPCE UNIT                   42500022
         SPACE                                                          42600022
         MVI   OCFLAG,OCMPP             INDICATE APPL                   42700022
         MVC   OPCLDNME+OFF03(AL2),XCTL0A SET XCTL MODULE ID   @G36XRRU 42706000
         MVC   OCBACKUP(AL8),OFF0C(RCIB) MOVE DD/TERM NAME     @G36XRRU 42712000
         TM    ZERO(RCIB),AIBAPKEY APPL PROGRAM INPUT          @G36XRRU 42718000
         BO    PROCMPP             YES, BRANCH                 @G36XRRU 42724000
         LA    RWORK1,MPPTBL       PICK UP VERB TABLE ADDR     @G36XRRU 42730000
         TM    OFF08(RCIB),APPLICAT SPECIAL NON-TOTE INPUT     @G36XRRU 42736000
         BO    CHECK               YES, BRANCH                 @G36XRRU 42742000
         SPACE                                                          43000022
         MVI   OCFLAG,OCTOTE            INDICATE TOTE INPUT             43100022
         LA    RWORK1,TOTETBL           PICK UP VERB TBL ADDR    S22024 43150022
CHECK    EQU   *                                               @G36XRRU 43200000
         NI    OFF08(RCIB),FFBYTE-APPLICAT CLEAR MPP INDICATOR          43300022
         LA    RWORK,OFF08(RCIB)        POINT TO VERB                   43400022
         ST    RCIB,OCCIB               SAVE CIB ADDR FOR POST  SA67769 43500005
         BAL   RRET,CHKVERB        VALIDITY CHECK THE VERB              43600022
         SPACE                                                          43700022
         B     GOODTOTE            GOOD RETURN, CONTINUE       @G36XRRU 43800000
         SPACE                                                          43900022
         LA    RZERO,FFBYTE             SET RETURN                      44000022
         MVC   OPCLDNME+OFF03(AL2),WRTXCTL MSG ROUTER                   44100022
         CLI   OFF09(RCIB),THRCLOSE THRESHOLD CLOSEDOWN?                44200022
         BNE   XCTLTBL1            NO, SET BAD RETURN                   44300022
         SPACE                                                          44400022
         NI    OCFLAG,FFBYTE-(OCMPP+OCTOTE) CUT OFF INPUT FLAGS         44500022
         B     XCTLTBL1            CALL 710D                            44600022
         SPACE                                                          44700022
GOODTOTE EQU   *                                               @G36XRRU 44800000
         MVC   OCBACKUP(AL8),OFF10(RCIB) MOVE DD/TERM NAME     @G36XRRU 44810000
         MVC   OPCLDNME+OFF03(AL2),OFF01(RWORK1) SET XCTL MOD  @G36XRRU 44820000
PROCMPP  EQU   *                                               @G36XRRU 44830000
         MVC   OCOPTCDE(AL1),OFF08(RCIB) SAVE VERB CODE        @G36XRRU 44840000
         ST    RCIB,OCCIB          SAVE AIB/CIB ADDRESS        @G36XRRU 44850000
         MVC   OCRLN(AL1),OFF0A(RCIB) SAVE RELATIVE LINE NO.   @G36XRRU 44860000
         MVC   OCMODNME(AL4),OFF18(RCIB) SAVE ICHNG ACT CODE            45400022
XCTLTBL1 EQU   *                                                        45500022
         LR    RPARM,ROPCAVT       PASS AVT ADDRESS                     45600022
XCTLTBL2 EQU   *                                                 S22024 45650022
         SPACE                                                          45700022
         XCTL  SF=(E,OPCXCTL)          XCTL TO CORRECT MODULE           45800022
         TITLE 'IGC0010D - SPECIAL ROUTINES USED MORE THAN ONCE'        45900022
*********************************************************************** 48200022
*                                                                     * 48300022
*        RETURN CONTROL TO IEDQCA FOR CLOSEDOWN OR NO INPUT           * 48400022
*                                                                     * 48500022
*********************************************************************** 48600022
         SPACE                                                          48700022
FREE     EQU   *                                               @Y17XARW 48710000
         L     RPARM,OPCCOPCE           PREPARE TO FREE BUFFER @Y17XARW 48720000
         USING IEDQPRF,RPARM                                   @YM08147 48721000
         SR    RRET,RRET                CLEAR FOR IC           @YM08147 48722000
         IC    RRET,PRFNBUNT            GET NUMBER OF UNITS    @YM08147 48723000
COUNT    EQU   *                                               @YM08147 48724000
         LR    RBRNCH,RPARM             SAVE LAST UNIT         @YM08147 48725000
         L     RPARM,PRFTIC             GET NEXT UNIT          @YM08147 48726000
         BCT   RRET,COUNT               LOOP TO GET LAST UNIT  @YM08147 48727000
         MVI   PRFTIC+THREE-IEDQPRF(RBRNCH),TIC02 SET AS LAST  @YM08147 48728000
         L     RPARM,OPCCOPCE           SET TO FREE BUFFER     @YM08147 48729000
         LA    R13,OPCSAVE              SETUP SAVE AREA        @Y17XARW 48730000
         L     RBRNCH,OPCFREBF          SETUP FREEBUF RTN ADDR @Y17XARW 48740000
         BALR  RRET,RBRNCH              CALL FREE BUFF ROUTINE @Y17XARW 48750000
RETURN   EQU   *                                                        48800022
         LM    RRET,RBRNCH,OPCRSAVE PICK UP RETURN ADDRESS              48900022
         BR    RRET                RETURN TO CA                         49000022
         SPACE 5                                                        49100022
*********************************************************************** 49200022
*                                                                     * 49300022
*        THIS CODE VERIFIES ALL INPUT VERBS FROM THE CONSOLE,         * 49400022
*        AN MPP, OR TOTE.                                             * 49500022
*                                                                     * 49600022
*********************************************************************** 49700022
         SPACE                                                          49800022
CHKVERB  EQU   *                                                        49900022
         CLI   OFF00(RWORK1),FFBYTE END OF TABLE                        50000022
         BE    OFF04(RRET)         YES, RETURN ERROR                    50100022
         SPACE                                                          50200022
         CLC   OFF00(AL1,RWORK1),OFF00(RWORK) CHECK VERB FOR MATCH      50300022
         BCR   EQUAL,RRET          YES, RETURN GOOD VERB INDICATION     50400022
         SPACE                                                          50500022
         LA    RWORK1,THREE(RWORK1) POINT TO NEXT VERB CODE             50600022
         B     CHKVERB             CONTINUE CHECKING                    50700022
         SPACE 5                                                        50800022
*********************************************************************** 50900022
         SPACE                                                          51000022
*                                                                     * 51100022
*        THIS CODE INTERFACES WITH THE IEDQCA SUBROUTINE TO REQUEST   * 51200022
*        A BUFFER UNIT TO SERVE AS THE OPCE FOR CONSOLE, TOTE, OR MPP * 51300022
*        INPUT.                                                       * 51400022
*                                                                     * 51500022
*********************************************************************** 51600022
GETBUFF  EQU   *                                                        51700022
         MVC   OPCCOPCE(AL4),AVTFZERO CLEAR CURRENT BUFFER POINTER      51800022
         XC    OFF00(AL8,RWORKA),OFF00(RWORKA) CLEAR FIRST EIGHT BYTES  51900022
         LA    RPARM,ONE           SET REQUEST COUNT AT ONE             52000022
         L     RBRNCH,OPCGETBF     GET ALLOCATION ADDRESS               52100022
         BALR  RRET,RBRNCH         REQUEST UNIT                         52200022
         SPACE                                                          52300022
         LR    ROPCE,RPARM              SAVE NEW UNIT POINTER           52400022
         ST    ROPCE,OPCCOPCE           PLACE CURRENT UNIT IN OPCE      52500022
         BR    RWORK                    RETURN TO ROUTINE               52509000
         EJECT                                                   X02004 52518000
CIBTBL   EQU   *                                               @OZ30378 52900082
VARY     DC    X'28',C'V0'              VARY COMMAND           @OZ30378 52930082
MODIFY   DC    X'44',C'M0'         MODIFY                      @OZ09959 53000000
         DC    X'68',C'D0'         DISPLAY                              53100022
         DC    X'6C',C'H0'         HOLD                                 53200022
         DC    X'70',C'R0'         RELEASE                              53300022
XCTLZ0   DC    X'3C',C'Z0'         HALT                          S22024 53400022
         DC    X'40',C'00'              STOPTCAM               @YA07487 53420058
RETREVFF EQU   *                        FLAG FOR CQTAM RETRIEVE  Y05330 53450005
         DC    X'FF'               END OF TABLE                         53500022
         SPACE 2                                                        53600022
TOTETBL  EQU   *                        START OF TOTE VERB TBL   S22024 53610022
         DC    X'50',C'M0'              SWDEVICE TO PRIMARY      S22024 53620022
         DC    X'51',C'M0'              SWDEVICE TO BACKUP       S22024 53630022
         DC    X'52',C'M0'              3705 IPL                 S22024 53640022
         DC    X'53',C'M0'              3705 ACTIVATE            S22024 53650022
         DC    X'54',C'M0'              3705 DEACTIVATE          S22024 53660022
         DC    X'55',C'V0'              START TERM E (TOTE)      S22024 53670022
*                                       IT LEAVES THE TRM ALLOC  S22024 53680022
*                                       TO TOTE, 3705 ONLY       S22024 53690022
MPPTBL   DC    X'41',C'V0'         STOP LINE                            53700022
         DC    X'87',C'R0'         RELEASE                              53800022
         DC    X'88',C'H0'         HOLD (TOTE)                          53900022
         DC    X'49',C'I0'         ICHNG                                54000022
         DC    X'40',C'V0'         START LINE                           54100022
         DC    X'10',C'Z0'         CLOSEDOWN-QUICK                      54200022
         DC    X'11',C'Z0'         CLOSEDOWN-FLUSH                      54300022
         DC    X'45',C'V0'         START TERMINAL B                     54400022
         DC    X'46',C'V0'              START TERMINAL E (TOTE)         54500022
         DC    X'48',C'V0'              STOP TERMINAL E (TOTE)          54600022
         DC    X'47',C'V0'         STOP TERMINAL B                      54700022
XCTLT0   DC    X'00',C'T0'              3705 TCOPY,ICOPY,TCHNG   S22024 54750022
         DC    X'FF'               END OF TABLE                         54800022
*                                                              @Y17XARX 54803000
*                                                              @Y17XARX 54806000
PRINOFLG EQU   *                TABLE: PRIORITIES WITH NO FLAGS@Y17XARX 54809000
         DC    X'EC',C'06'                                     @Y17XARX 54812000
PRINFLG1 EQU   *-PRINOFLG               TABLEWIDTH             @Y17XARX 54815000
         DC    X'E5',C'A0'                                     @Y17XARX 54824000
         DC    X'E4',C'01'                                     @Y17XARX 54827000
         DC    X'EA',C'02'                                              54830082
         DC    X'E2',C'A0'                                     @YM03742 54831000
         DC    X'DE',C'MH'                                     @Y17XARX 54833000
         DC    X'46',C'MF'                                     @Y17XARX 54836000
PRINOEND EQU   *                        END TABLE PRINOFLG     @Y17XARX 54839000
*                                                              @Y17XARX 54842000
*                                                              @Y17XARX 54845000
PRIFLAGS EQU   *                TABLE: PRIORITIES WITH FLAGS   @Y17XARX 54848000
         DC    X'E9',X'01',C'A0'                               @Y17XARX 54851000
PRIFLGS1 EQU   *-PRIFLAGS                                      @Y17XARX 54854000
         DC    X'E9',X'02',C'N4'                               @Y17XARX 54857000
         DC    X'E9',X'07',C'VF'                               @Y17XAR4 54858000
         DC    X'E9',X'09',C'FC'                               @Y17XARX 54860000
         DC    X'E9',X'12',C'MP'                               @Y17XARX 54863000
         DC    X'E9',X'14',C'MF'                               @Y17XARX 54866000
         DC    X'DF',X'03',C'FG'                               @Y17XARX 54869000
         DC    X'DF',X'04',C'VI'                               @Y17XARX 54872000
         DC    X'DF',X'05',C'VE'                               @Y17XARX 54875000
         DC    X'DF',X'06',C'VA'                               @Y17XARX 54878000
         DC    X'DF',X'07',C'VF'                               @Y17XARX 54881000
         DC    X'DF',X'08',C'02'                               @Y17XARX 54884000
         DC    X'DF',X'10',C'VI'                               @Y17XARX 54887000
         DC    X'DF',X'11',C'V8'                               @Y17XARX 54890000
         DC    X'DF',X'13',C'FA'                               @Y17XARX 54891000
         DC    X'DF',X'15',C'VA'                               @Y17XART 54892000
         DC    X'DF',X'16',C'0N'                               @Y17XARR 54892500
         DC    X'D0',X'0A',C'FK'                               @Y17XART 54893000
         DC    X'D0',X'0D',C'C1'                               @Y17XARS 54893100
         DC    X'D0',X'0E',C'FG'                               @Y17XARS 54893200
PRIWEND  EQU   *                                               @Y17XARX 54893300
* PRIORITIES USED BUT NOT POSTED TO OPCOB                      @Y17XART 54894300
*        X'DD' - VA TO IEDNSL                                  @Y17XART 54896000
*        X'DF',X'0B' -V9 TO VA OR VF                           @Y17XART 54896200
*        X'DF',X'0C' -VE TO IEDNSL                             @Y17XARW 54897200
* PRIORITIES USED AND POSTED TO OPCOB NOT REFRENCED BY TABLE   @Y17XARR 54898100
*        X'DC',X'00' _ TCOPY,TCHNG,ICOPY,ICHNG  TO OPCOB       @Y17XARR 54899000
         SPACE 2                                                        54900022
ERRXCTL  DC    C'03'                    ERROR MODULE                    55200022
WRTXCTL  DC    C'07'                    OUTPUT                          55300022
XCTLV1   DC    C'V1'                    TO RETURN STOPPED LCB           55400022
XCTLZ1   DC    C'Z1'                    ID OF IGCZ110D                  55500022
XCTL0A   DC    C'0A'                    IGC0A10D MOD ID        @G36XRRU 55502000
ADDRESS  EQU   7                        ADDRESS MASK           @G36XRRU 55504000
AIBAPKEY EQU   X'18'                    APPL PROG INPUT FLAG   @G36XRRU 55506000
RNSTOPLN DC    C'VE'                    3705 STOPLINE LOAD 2     S22024 55509022
GENPOLL  EQU   X'E0'                    3705 GENERAL POLL PRIORTYS22024 55518022
XCTLVA   DC    C'VA'                    3705 GENERAL POLL MODULE S22024 55524022
XCTL01   DC    C'01'                    NEW TERM INPUT MODULE  @Y17XARW 55526000
E        EQU   8                        EQUAL                    S22024 55528422
NZ       EQU   7                        NOT ZERO                 S22024 55529222
CLSMSG   WTO   'IED063I CLOSEDOWN IN PROGRESS - COMMAND REJECTED',     X55530022
               MF=L,DESC=5,MCSFLAG=(REG0,RESP)                          55560022
NREADYM  WTO   'IED101I RESTART IN PROGRESS',MF=L,DESC=5,              *55561000
               MCSFLAG=(REG0,RESP)                             @OZ09959 55562000
ZAPAREA  DC    50F'0'                   PATCH AREA             @Y17XART 55565000
         TITLE 'IGC0010D - DSECTS USED BY THIS MODULE'                  55600022
         TAVTD                                                          55700022
         EJECT                                                          55800022
          SPACE 1                                                       55900056
         EJECT                                                          56000022
IEDQCIB  DSECT                                                          56100022
         IEZCIB                                                         56200022
         EJECT                                                          56300022
         TOPCAVTD                                                       56400022
         EJECT                                                          56500022
         TOPCED                                                         56600022
         EJECT                                                          56700022
         TOPRED                                                @Y17XARX 56750000
         TPCBD                                                          56800022
         DCBD  DSORG=TX                                                 56805005
         TDEBAPD                                                        56810005
         EJECT                                                          56813000
         IHAPSA                                                @G36XRRU 56816000
         EJECT                                                          56819000
         TPEWAD                                                         56825005
         TQCBD                                                          56830005
         TTNTD                                                          56835005
         TPRFD                                                          56840005
         TCKPD 3330                                                     56845005
         TPRIOR                                                         56850005
APLCOPYD DSECT                          USER PARM LIST           X02004 56855000
APLCODE  DS    FL1                      ENTRY CODE              X02004  56860000
APLTERM  DS    AL3                      TERMINAL ADDRESS         X02004 56862000
APLUSEWK DS    F                        USER WORK AREA           X02004 56870000
APLLIMIT DS    F                        LIMIT OPERAND            X02004 56875000
APLTPDTE DSECT                          TPDATE PARM LIST         X02004 56880000
APLOPTN  DS    FL1                      OPTIONS BYTE             X02004 56885000
APLDCBAD DS    AL3                      DCB ADDR                 X02004 56890000
APLDTSAR DS    F                        DTSAREA ADDRES           X02004 56895000
         END                                                            56900022
