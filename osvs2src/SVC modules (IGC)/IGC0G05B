         TITLE 'IGC0G05B  JFCB PROCESSOR - TABLE BUILD MODULE          *00090018
                      REPOSITION I/O  RESTART-SVC 52  OS/360'           00180018
IGC0G05B CSECT                                                          00270018
*          RELEASE 18 DELETIONS                                         00360018
*          RELEASE 19 DELETIONS                                         00450018
*0512390600,524700,540000,558000,564300-565200,586800,633600-    A26097 00460019
*0512635400,639000-639900,643100,649800,655200,657900-658800,    A26097 00470019
*0512662400,665100                                               A26097 00480019
*0512175500,242100                                               A28676 00490019
*          RELEASE 20 DELETIONS                                         00540018
*0931285240,307200-307500                                        A33998 00550020
*0931252900,256500                                               S20038 00560020
*0931514200,514500                                               A33084 00580020
*0931526500,623700,633700                                        A33983 00600020
*0931019800-035100,045900,047700,051300,147700-147760,147800-    M3408  00605020
*0931148060,148100-148420,148460,151200-152100,152300-152800,    M3408  00610020
*0931153100-153350,153400,153600,284790,285210,344700,353700,    M3408  00615020
*0931362700-630900,633700,636300-638100,643700,644100,656100,    M3408  00620020
*0931657000,659700-666400                                        M3408  00625020
*0931252000-253800                                               A38124 00627020
*          RELEASE 21 DELETIONS                                         00630018
*          RELEASE 22 DELETIONS                                         00720018
*          RELEASE 23 DELETIONS                                         00810018
*          RELEASE 24 DELETIONS                                         00900018
*          RELEASE 25 DELETIONS                                         00990018
*          RELEASE 26 DELETIONS                                         01080018
*      MVS RELEASE 3.7 CHANGES ADDITIONS DELETIONS                      01110037
*A186242-186252,A311577-311635                                 @ZA12948 01130037
*C230400,C321900,A321900                                       @ZA24633 01150037
* APAR OZ31483 HAS BEEN FLAGGED AS @ZSUT222                    @ZSUT222 01160037
*C148440,153888,302400,309920                                  @ZSUT222 01162037
*A634200-635200,655800                                         @ZSUT222 01164037
*STATUS CHANGE LEVEL 003                                                01170020
*                                                                       01260018
*TITLE -       TABLE BUILD MODULE                                       01350018
*                                                                       01440018
*STATUS -      INITIAL CODE                                             01530018
*                                                                       01620018
*FUNCTION -    THIS MODULE COUNTS THE DATA SETS ASSOCIATED WITH THE     01710018
*              TASK TO BE RESTARTED AND CONSTRUCTS A TABLE ENTRY FOR    01800018
*              FOR EVERY ONE EXCEPT THE VSAM DATA SETS. THE TIOT        01850002
*              OFFSETS ARE UPDATED. THE DSAB POINTERS TO THE DEB AND    01900002
*              VICE VERSA ARE UPDATED. TCAM DATA SETS ARE FLAGGED.      01950002
*              THE RESTART DATA SET IS FLAGGED. THE SSOB,DEB AND SSIB   02000002
*              POINTERS ARE UPDATED. ALL CHECKPOINT DATA SETS ARE       02050002
*              CHECKED TO MAKE SURE THEY ARE SECURE. THE PORTION        02100002
*              OF THE WORK AREA NOT USED FOR 48 BYTE ENTRIES IS USED    02150002
*              FOR I/O BUFFERS AND IS SPLIT INTO AS MANY 304 BYTE       02200002
*              BUFFERS AS POSSIBLE.                                     02250002
*                                                                       02490020
*              THIS MODULE WAS SPLIT FOR RELEASE 20.  THE REMAINDER     02790020
*              OF THE TABLE BUILD ROUTINE IS NOW MODULE IGC0G95B.       03090020
*                                                                       03600018
*ENTRYPOINT -  IGC0G05B  CSECT                                          03690018
*                                                                       03780018
*INPUT -       REGISTER 1 - POINTER TO THE RESTART WORKAREA (RSTWA)     03870018
*                           SEE DSECT AT END OF MODULE                  03960018
*                                                                       04050018
*OUTPUT -      REGISTER 8 - POINTER TO BEGINNING OF DATA SET INFO TABLE 04140018
*                                                                       04230018
*              REGISTER 1 - POINTER TO BEGINNING OF RSTWA WORKAREA      04320018
*                           (SEE DSECT AT END OF TABLE)                 04410018
*                                                                       04500018
*ENTERNAL RTN- NONE                                                     04590020
*                                                                       04680018
*EXITS -       NORMAL TO IGC0G95B VIA XCTL                              04770020
*                                                                       04860018
*              ON ERROR CONDITION TO IGC0V05B VIA XCTL                  04950018
*                   RET CODE =  33 - DD CARD MISSING IN TIOT   @ZSUT222 05040037
*                   RET CODE =  99 - DSAB MISSING              @ZSUT222 05050037
*                                                                       05090002
*                                                                       05220018
*TABLES/WORKAREAS                                                       05310018
*                                                                       05400018
*********************************************************************** 05490018
*                                                                     * 05580018
*    THE FOLLOWING IS A DESCRIPTION OF THE 48 BYTE TABLE ENTRY THAT   * 05670018
*    IS USED IN THE RESTART PORTION OF CHECKPOINT/RESTART.  EACH      * 05760018
*    ENTRY IN THE TABLE (ONE FOR EACH OPEN DATA SET AT CHECKPOINT)    * 05850018
*    IS 48 BYTES LONG.                                                * 05940018
*                                                                     * 06030018
*********************************************************************** 06120018
*                                                                       06210018
*        ------------------- 4 BYTES -----------------                  06300018
*                                                                       06390018
*      0 +++++++++++++++++++++++++++++++++++++++++++++                  06480018
*        +DATA SET  +           DCB                  +                  06570018
*        + ORGN.    +         ADDRESS                +                  06660018
*        +++++++++++++++++++++++++++++++++++++++++++++ 4                06750018
*        +FLAG BYTE +    WORKAREA SEGMENT            +                  06840018
*        + NO. 1    +         ADDRESS                +                  06930018
*      8 +++++++++++++++++++++++++++++++++++++++++++++                  07020018
*        +NUMBER    +         JFCB TTR               +                  07110018
*        + OF VOLS  +         ADDRESS                +                  07200018
*        +++++++++++++++++++++++++++++++++++++++++++++ 12               07290018
*                                                                       07380018
*     12 +++++++++++++++++++++++                                        07470018
*        +TAPE LABL + FILE SEQ +        DEVICE = TAPE                   07560018
*        +INFO BYTE + NUMBER   +                                        07650018
*        +++++++++++++++++++++++                                        07740018
*                                                                       07830018
*     12 +++++++++++++++++++++++                                        07920018
*        +    OLD   TIOT       +        DA AND UNIT RECORD              08010018
*        +      OFFSET         +                                        08100018
*        +++++++++++++++++++++++                                        08190018
*                                                                       08280018
*                              +++++++++++++++++++++++                  08370018
*                              +FLAG BYTE +FLAG BYTE +                  08460018
*                              +  NO. 2   +  NO. 3   +                  08550018
*     16 +++++++++++++++++++++++++++++++++++++++++++++                  08640018
*        +FLAG BYTE +FLAG BYTE +                     +                  08730018
*        + NO. 4    + NO. 5    +   VOLUME ID NO. 1   +                  08820018
*        +++++++++++++++++++++++                     + 20               08910018
*        +                                           +                  09000018
*        +                                           +                  09090018
*     24 +++++++++++++++++++++++++++++++++++++++++++++                  09180018
*        +                                           +                  09270018
*        +   VOLUME ID NO. 2                         +                  09360018
*        +                     +++++++++++++++++++++++ 28               09450018
*        +                     +                     +                  09540018
*        +                     +   VOLUME ID NO. 3   +                  09630018
*     32 +++++++++++++++++++++++                     +                  09720018
*        +                                           +                  09810018
*        +                                           +                  09900018
*        +++++++++++++++++++++++++++++++++++++++++++++ 36               09990018
*        +                                           +                  10080018
*        +   VOLUME ID NO. 4                         +                  10170018
*     40 +                     +++++++++++++++++++++++                  10260018
*        +                     +                     +                  10350018
*        +                     +                     +                  10440018
*        +++++++++++++++++++++++   VOLUME ID NO. 5   + 44               10530018
*        +                                           +                  10620018
*        +                                           +                  10710018
*        +++++++++++++++++++++++++++++++++++++++++++++ 48               10800018
*                                                                       10890018
*                                                                       10980018
*           A  DCBTABLE,                                                11070018
*                                                                       11160018
*           B  BUFFER AREA,                                             11250018
*                                                                       11340018
*           C  SEE DSECTS AT END OF LISTING.                            11430018
*                                                                       11520018
*ATTRIBUTES                                                             11610018
*                                                                       11700018
*          A RE-ENTRANT                                                 11790018
*          B RE-USABLE                                                  11880018
*          C ENABLED                                                    11970018
*          D PRIVIALEGED                                                12060018
*                                                                       12150018
*********************************************************************   12240018
*                                                                       12330018
*    REGISTER CONVENTION TO BE USED THRU-OUT REPI/O PHASE               12420018
*                                                                       12510018
*********************************************************************** 12600018
*                                                                       12690018
WRKR1    EQU   0                        WDRK/PARAMETER REGISTER         12780018
WRKR2    EQU   1                        WDRK/PARAMETER REGISTER         12870018
DCBR     EQU   2                        CURRENT DCB REGISTER            12960018
BASER    EQU   3                        BASE REGISTER                   13050018
DEBR     EQU   4                        CURRENT DEB REGISTER            13140018
UCBR     EQU   5                        CURRENT UCB REGISTER            13230018
TIOTR    EQU   6                        NEW TIOT REGISTER               13320018
TCBR     EQU   7                        TCB REGISTER                    13410018
TABLR    EQU   8                        BEGINNING TO DCB TABLE REG      13500018
CTABLR   EQU   9                        CURRENT ENTRY IN DCB TABLE      13590018
BUFR     EQU   10                       USER BUFFER AREA                13680018
DSCNTR   EQU   11                       WORK REGISTER                   13770018
WRKR3    EQU   12                       WORK/DEB PREFIX REGISTER Y02076 13820002
WRKR4    EQU   13                       WORK/CURRNT DSAB REGISTERY02076 13870002
WRKR5    EQU   14                       WORK/PARAMETER REGISTER         14040018
WRKR6    EQU   15                       WORK/PARAMETER REGISTER         14130018
*                                                                       14220018
*********************************************************************** 14310018
*                                                                       14400018
*    OFFSETS TO BE USED IN REPI/O PHASE                                 14490018
*                                                                       14580018
*********************************************************************** 14670018
*                                                                       14760018
IS       EQU   X'80'                    INDEXED SEQUENCIAL              14762018
PS       EQU   X'40'                    PHYSICAL SEQUENCIAL             14764018
DA       EQU   X'20'                    DIRECT ACCESS                   14766018
PO       EQU   X'02'                    PARTITIONED ORGANIZATION        14768018
VS       EQU   X'01'                    VIRTUAL SEQUENTIAL       Y02076 14770002
TABENT   EQU   48                       TABLE ENTRY LENGTH              14808018
ERR033   EQU   33                       MISSING DD CARD        @ZSUT222 14844037
BUFSEG   EQU   304                                                      14850018
TIOTBASE EQU   24                                                       15030018
BLANK    EQU   C' '                     BLANK CHARACTER                 15220018
NODDENT  EQU   X'00'                    NO DD ENTRY                     15290018
DEBID    EQU   X'0F'                    DEB IDENTIFICATION              15300018
TCAMID1  EQU   X'C0'                    UNIQUE TCAM DEB CODE     M3408  15302020
TCAMID2  EQU   X'CF'                    UNIQUE TCAM DEB CODE     M3408  15304020
RSTCAM   EQU   X'04'                    MASTER TCAM FLAG         M3408  15308020
ERR099   EQU   99                       NO DSAB FOUND ERROR    @ZSUT222 15388837
SUBSYSDS EQU   X'80'                    SUBSYSTEM INDICATOR      Y02076 15389602
D0       EQU   0                   ZERO                          Y02076 15389702
D1       EQU   1                   ONE                           Y02076 15389802
D2       EQU   2                   TWO                           Y02076 15389902
D3       EQU   3                   THREE                         Y02076 15419902
D4       EQU   4                   FOUR                          Y02076 15429902
D5       EQU   5                   FIVE                          Y02076 15439902
D6       EQU   6                   SIX                           Y02076 15449902
D7       EQU   7                   SEVEN                         Y02076 15459902
D8       EQU   8                   EIGHT                         Y02076 15469902
D9       EQU   9                   NINE                          Y02076 15473202
D16      EQU   16                  SIXTEEN                       YM5360 15475202
*                                                                       15476702
*********************************************************************** 15480018
*                                                                       15570018
         BALR  BASER,0                  ESTABLISH ADDRESSABILITY        15660018
         USING *,BASER                  ESTABLISH BASE REGISTER         15750018
         B     BEGIN               BRANCH AROUND EYE CATCHER     Y01909 15800000
         CNOP  0,8                 ALIGN TO A DBL WORD BOUNDARY  Y01909 15810000
         DC    CL8'IGC0G05B'       MODULE NAME                 @ZSUT222 15820037
         DC    CL8'&SYSDATE'       LAST DATE SHIPPED           @ZSUT222 15822037
         DC    CL8'@ZSUT222'       LAST CODE SHIPPED           @ZSUT222 15824037
BEGIN    EQU   *                                                 Y01909 15830000
*                                                                       15840018
         USING IHADCB,DCBR                                              15930018
         USING UCBOB,UCBR                                               16020018
         USING TIOENTRY,WRKR5                                           16200018
         USING DEBBASIC,DEBR                                     Y02076 16380002
         USING TCB,TCBR                                                 16430002
         USING TABL,CTABLR                                              16480002
         USING RSTWA,BUFR                                               16650018
*                                                                       16740018
         LR    BUFR,WRKR2               GET WORK AREA (RESTART) ADDR    16830018
*                                                                       16920018
         L     WRKR2,RSWAOFST           OFFSET TO REPI/O AREA           17010018
         LA    TABLR,0(WRKR2,BUFR)      POINT TO REPI/O AREA            17100018
*                                                                       17190018
         SR    DSCNTR,DSCNTR            INITIALIZE REGISTER             17280018
         L     TCBR,RSTCBAD             GET USER TCB                    17370018
*                                                                       17460018
         L     DEBR,RSINT               GET 1ST DEB ADDR         A28676 17550019
         LA    DEBR,D0(DEBR)            ADR ONLY                 Y02076 17560002
         MVC   RSPPM(8),NORMALXT        SET UP XCTL LIST         A26097 17590019
*                                                                       17640018
*********************************************************************** 17730018
*                                                                       17820018
*    THE FOLLOWING SECTION OF CODE WILL COMPUTE NO. OF DATA SETS IN USE 17910018
*                                                                       18000018
*********************************************************************** 18090018
*                                                                       18180018
REPDCB00 EQU   *                                                        18270018
*                                                                       18360018
         LA    DSCNTR,1(DSCNTR)         INCREMENT DEB COUNT BY ONE      18450018
         USING DEBPREFX,WRKR3                                    Y02076 18500002
         LR    WRKR3,DEBR               LOAD BASE REGISTER       Y02076 18590002
         SH    WRKR3,DEBPROFF           OFFSET BACK TO DEB PREF  Y02076 18600002
         CLI   DEBAMTYP,VS              VSAM DATA SET            Y02076 18610002
         BNE   REPDCBX0                 NO  NEXT DEB             Y02076 18620002
         BCTR  DSCNTR,D0                DONT COUNT VSAM DATA SET Y02076 18622002
REPDCBX0 EQU   *                        INSTR MUST FOLLOW        Y02076 18624002
         CLI   DEBAMTYP,IS              IS IT AN ISAM DEB      @ZA12948 18624237
         BNE   REPDCBY0                 NO - NEXT DEB          @ZA12948 18624437
         TM    DEBFLGS1,DEBCINDI        COMPT INTF PROCESSING  @ZA12948 18624637
         BNO   REPDCBY0                 NO - NEXT DEB          @ZA12948 18624837
         BCTR  DSCNTR,D0                DONT COUNT ISAM CI DEB @ZA12948 18625037
REPDCBY0 EQU   *                                               @ZA12948 18625237
         L     DEBR,DEBDEBAD            LINK TO NEXT POSSIBLE DED       18626002
         LA    DEBR,0(DEBR)             CLEAR HIGH ORDER BYTE           18630002
         LTR   DEBR,DEBR                WAS THERE ANOTHER DEB IN CHAIN  18720018
         BNZ   REPDCB00                 YES BRANCH TO COUNT DEB         18810018
         DROP  WRKR3                                             Y02076 18860002
*                                                                       18900018
*********************************************************************** 18990018
*                                                                       19080018
*    ALL DEBS HAVE BEEN COUNTED, AT THIS POINT COMPUTE AMOUNT OF SPACE  19170018
*    REQUIRED FOR THE DCB TABLE. EACH DCB ENTRY IS 48 BYTES LONG....    19260018
*                                                                       19350018
*********************************************************************** 19440018
*                                                                       19530018
         SR    WRKR3,WRKR3              ZERO OUT WRKR3                  19620018
         LA    WRKR4,TABENT             SIZE OF TABLE ENTRY             19710018
         MR    WRKR3,DSCNTR             CALCULATE TABLSIZE IN WRKR6     19800018
*                                                                       19890018
         L     WRKR2,RSDCBFLG           GET LEN. OF ENTIRE WORK AREA    19980018
         SH    WRKR2,SSCRLNGT           SUBTR SSCR LENGTH        Y02076 20030002
         ST    WRKR2,RSDCBFLG           SAVE FOR CLEARING        Y02076 20040002
         SR    WRKR2,WRKR4              BUFFER LEN. MINUS TABLE SIZE    20070018
         LA    UCBR,0(WRKR4,TABLR)      ADDRESS OF BUFFER AREA          20160018
*                                                                       20250018
*   THE BUFFER MUST BE ON A DOUBLE WORD BOUNDARY                        20340018
*                                                                       20430018
         LA    UCBR,4(UCBR)             ADD FOUR TO ADDRESS             20520018
         SRL   UCBR,3                   CLEAR RIGHTMOST 3 BITS          20610018
         SLL   UCBR,3                   RESTORE DOUBLE WORD BOUNDARY    20700018
         L     WRKR4,RSDCBFLG           SETUP PARM TO CLEAR CORE -SIZE  20790018
         LR    WRKR3,TABLR              SETUP PARM TO CLEAR CORE -ADDR  20880018
*                                                                       20970018
         BCTR  WRKR4,0                  REDUCE AMOUNT TO CLEAR BY ONE   21060018
         LA    WRKR5,255                LOAD MAX TO CLEAR PER ONE SHOT  21150018
*                                                                       21240018
COMPARE  CR    WRKR4,WRKR5              IS AMOUNT TO CLEAR GREATER 255  21330018
         BC    12,ONECLEAR              BR IF NOT GREATER TO 'ONECLEAR' 21420018
*                                                                       21510018
*   THE FOLLOWING IS PERFORMED EACH TIME AMOUNT LEFT TO BE CLEARED (IN  21600018
*   WRKR6 ) IS GREATER THAN 256 BYTES                                   21690018
*                                                                       21780018
         EX    WRKR5,CLEAR              CLEAR 256 BYTES VIA 'CLEAR'     21870018
         SR    WRKR4,WRKR5              SUB. 255 FROM AMOUNT TO BE CLRD 21960018
         BCTR  WRKR4,0                  SUB. ONE MORE BYTE              22050018
         LA    WRKR3,256(WRKR3)         BUMP ADDR COUNTER BY 256        22140018
         B     COMPARE                  CYCLE THRU ONCE MORE            22230018
*                                                                       22320018
CLEAR    XC    0(1,WRKR3),0(WRKR3)      THE ACTUAL CLEAR INSTRUCTION    22410018
*                                                                       22500018
ONECLEAR EX    WRKR4,CLEAR              CLEARS LESS THAN 256 BYTES      22590018
*                                                                       22680018
         L     WRKR6,RSTIOTAD           GET TASKS OLD TIOT              22770018
         LR    CTABLR,TABLR             INIT. CURR. ENTRY REG.          22860018
*                                                                       22950018
         ST    WRKR2,RSSSCR             SAVE LENGTH IN BUF SEG @ZA24633 23040037
*                                                                       23130018
*********************************************************************** 23220018
*                                                                       23310018
*    THIS IS THE TIOT THAT WAS IN USE AT CHKPT TIME AND IS PASSED BY    23400018
*    RESTART ROUTINES TO REPI/O. IT IS REQUIRED TO FIND THE DDNAMES     23490018
*    ASSOCIATED WITH THE OPENED DATA SETS AT RESTART TIME...........    23580018
*                                                                       23670018
*********************************************************************** 23760018
*                                                                       23850018
         L     TIOTR,TCBTIO             GET CURRENT TIOT FROM TCB       23900002
         LA    TIOTR,D0(TIOTR)          ADR ONLY                 Y02076 23950002
         L     DEBR,RSINT               GET 1ST DEB ADDR         A28676 24210019
         LA    DEBR,D0(DEBR)            ADR ONLY                 Y02076 24260002
*                                                                       24300018
*********************************************************************** 24390018
*                                                                       24480018
*        PLACE THE ADDRESS OF THE DCB IN THE DCB TABLE           YM7053 24530002
*        IN PREPARATION FOR THE JFCB READ                        YM7053 24580002
*                                                                       24750018
*********************************************************************** 24840018
*                                                                       24930018
REPDCB01 EQU   *                                                 YM7053 24980002
         LR    WRKR5,TIOTR              SAVE TIOT ADDRESS        YM7053 25030002
         MVC   TABDCBAD(3),DEBDCBAD+1   MOVE THIS DEB'S DCB ADDR A38124 25210020
*                                       TO TABLE ENTRY                  25310020
         ST    DEBR,TABVLID4            SAVE CURRENT DEB POINTER YM7053 25360002
*                                                                       25470018
REPDCBB1 EQU   *                        INSTR MUST FOLLOW        Y02076 25472002
         CLI   DEBNMSUB,TCAMID1         Q - TCAM DEB (1ST        M3408  25476020
*                                       CHANCE)                  M3408  25482020
         BE    REPDCB20                 YES, SET TCAM FLAGS      M3408  25488020
         CLI   DEBNMSUB,TCAMID2         Q - TCAM DEB (2ND        M3408  25494020
*                                       CHANCE)                  M3408  25500020
         BNE   REPDCB40                 NO, BYPASS SETTING FLAGS M3408  25506020
REPDCB20 EQU   *                                                 M3408  25512020
         OI    RSFLAG2,RSTCAM           SET MASTER TCAM          M3408  25518020
*                                       INDICATOR                M3408  25524020
         OI    TABFLG1,TABTCAM          SET TCAM TABLE ENTRY     M3408  25530002
*                                       FLAG                     M3408  25536020
REPDCB40 EQU   *                                                 M3408  25542020
         SR    WRKR2,WRKR2              INITIALIZE REGISTER             26640018
*                                                                       26910018
*********************************************************************** 27000018
*                                                                       27090018
*    THE TIOT OFFSETS WILL BE CORRECTED TO POINT TO THE NEW TIOT IN     27180018
*    THE NEXT SECTION OF CODE. IF A DDNAME CANNOT BE FOUND IN TIOT      27270018
*    THE REPI/O WILL RETURN TO RESTART WITH ERROR CODE.                 27360018
*                                                                       27450018
*********************************************************************** 27540018
*                                                                       27630018
REPDCB02 EQU   *                                                        27720018
*                                                                       27810018
         LA    WRKR3,TIOTBASE           OFFSET FOR FIRST DDNAME         27990018
         LA    WRKR5,0(WRKR3,WRKR5)     BYPASS BASIC SECTION OF TIOT    28080018
*                                                                       28170018
         L     DCBR,TABDCBAD-1          GET DCB TO PROCESS              28260018
         LH    WRKR4,DCBTIOT            GET OFFSET FOR DDNAME IN TIOT   28350018
         AR    WRKR4,WRKR6              POINT TO DDNAME IN OLD TIOT     28440018
         TM    TIOELINK-TIOENTRY(WRKR4),TIOESSDS WAS DS A        YM7399 28442002
*                                       SUBSYSTEM DS AT CHKPT    YM7399 28442402
*                                       TIME                     YM7399 28442802
         BZ    REPDCX15                 IF NOT, BRANCH           YM7399 28442902
         OI    TABFLG2,TABOSSDS         SET OLD-SUBSYSTEM FLAG   YM7399 28447902
REPDCX15 EQU   *                        NON-SUBSYSTEM ENTRY      YM7399 28449902
*                                                                       28455002
*                                                                       28460002
* IF A CONCATNATED DATA SET IS BEING PROCESSED THE POINTER IN           28465002
* THE OLD TIOT MUST POINT TO THE NON-BLANK DDNAME AND THE               28470002
* DISPLACEMENT SAVED. AFTER THE SEARCH IS SATISFIED THE                 28475002
* DISPLACEMENT WILL BE ADDED TO THE NEW TIOT DISPLACEMENT.              28480002
*                                                                       28485002
         LA    DEBR,D1                  ONE TO DEBR, REQUIRED IF YM7053 28490002
*                                       DDNAME NON BLANK         YM7053 28495002
         CLI   D4(WRKR4),BLANK          IS THIS DDNAME BLANK?    YM7053 28500002
         BNE   REPDCB03                 NO, CONTINUE PROCESSING  YM7053 28505002
         LA    WRKR6,TIOTBASE(WRKR6)    POINT TO 1ST DDNAME IN OLD TIOT 28510002
*                                                                       28515002
REPDCBX1 EQU   *                                                        28520002
*                                                                       28525002
         ST    WRKR6,20(CTABLR)         SAVE NON-BLANK DD ADDR   M3408  28530002
         SR    DEBR,DEBR                INIT DD ENTRY COUNTER    A33998 28535002
*                                                                       28540002
REPDCBX2 EQU   *                                                        28545002
*                                                                       28550002
         LA    DEBR,1(,DEBR)            BUMP DD ENTRY COUNTER    A33998 28555002
         CR    WRKR6,WRKR4              ARE POINTERS EQUAL              28560002
         BE    REPDCBX4                 BRANCH IF EQUAL                 28565002
         IC    WRKR2,0(WRKR6)           INSERT LENGTH                   28570002
         AR    WRKR6,WRKR2              INCREMENT TO NEXT POINTER       28575002
         CLI   4(WRKR6),BLANK           BLANK DDNAME                    28580002
         BE    REPDCBX2                 BRANCH IF YES                   28585002
         B     REPDCBX1                 CHECK NEXT ENTRY                28590002
*                                                                       28595002
REPDCBX4 EQU   *                                                        28600002
*                                                                       28605002
         L     WRKR4,20(CTABLR)         GET NON-BLANK DD ADDR    M3408  28610002
*                                                                       28615002
REPDCB03 EQU   *                                                        28620018
*                                                                       28710018
         CLC   4(8,WRKR4),TIOEDDNM      LOOK FOR DDNAME IN NEW TIOT     28800018
         BE    REPDCB04                 IF FOUND BRANCH                 28890018
*                                                                       28980018
         IC    WRKR2,TIOELNGH           GET CURRENT ENTRY LNGH IN TIOT  29070018
         AR    WRKR5,WRKR2              INCREMENT TO NEXT DDNAME        29160018
         AR    WRKR3,WRKR2              INCREMENT OFFSET BEING GENRTED  29250018
*                                                                       29340018
         CLI   TIOELNGH,NODDENT         DOES ANOTHER DD ENTRY EXIST     29430018
         BNE   REPDCB03                 YES BRANCH TO LOOK AT NAME      29520018
*                                                                       29610018
*********************************************************************** 29700018
*                                                                       29790018
*    DDNAME MISSING FROM NEW TIOT - CANNOT RESTART PROPERLY             29880018
*                                                                       29970018
*********************************************************************** 30060018
*                                                                       30150018
         MVI   RSRETCOD+1,ERR033        MISSING DD CARD ERROR  @ZSUT222 30240037
         B     REPDCBER                 BRANCH TO ERROR EXIT            30330018
*                                                                       30420018
REPDCB04 EQU   *                                                        30510018
*                                                                       30600018
         MVC   TABTPLBL(2),DCBTIOT      SAVE OLD OFFSET IN TABTPLBL     30690018
         B     REPDC04B                                          A33998 30700020
REPDC04A EQU   *                                                 A33998 30710020
         IC    WRKR2,TIOELNGH           GET THIS ENTRY'S LNGTH   A33998 30720020
         AR    WRKR5,WRKR2              POINT TO NEXT ENTRY      A33998 30730020
         AR    WRKR3,WRKR2              UPDATE ENTRY OFFSET      A33998 30740020
REPDC04B EQU   *                                                 A33998 30750020
         BCT   DEBR,REPDC04A            LOOP BACK TO PROCESS     A33998 30760020
*                                       CONCAT. ENTRIES          A33998 30770020
         STH   WRKR3,DCBTIOT            SAVE NEW OFFSET IN DCB          30780018
         MVC   TABJFCB(3),TIOEJFCB      SAVE JFCB(S) TTR IN TABLE       30870018
**********************************************************************  30920002
*                                                                    *  30930002
*              RESOLVE ALL DSAB POINTER ADDRESSES IN ALL DEB         *  30940002
*              EXTENTIONS AND THE SSOB'S FOR SUBSYSTEM DATA SETS     *  30950002
*              DUE TO RELOCATION AT RESTART TIME.   THE SUBSYSTEM    *  30952002
*              INDICATOR IN THE 48 BYTE OPEN DATA SET ENTRIES WILL   *  30954002
*              BE SET FOR ALL SYSIN/SYSOUT DATA SETS.                *  30956002
*                                                                    *  30958002
**********************************************************************  30958402
         AR    WRKR3,TIOTR              CALC ABS DD ENTRY OFFSET Y02076 30958802
         L     WRKR4,TCBJSCB            ADDRESSABILITY FOR JSCB  Y02076 30959202
         USING IEZJSCB,WRKR4                                     Y02076 30959602
         L     WRKR4,JSCDSABQ           ADDRESSABILITY FOR QDB   Y02076 30959702
         USING QDB,WRKR4                                         Y02076 30959802
         L     WRKR4,QDBFELMP           ADDRESSABILITY FOR DSAB  Y02076 30959902
         USING DSAB,WRKR4                                        Y02076 30973202
REPDC04C EQU   *                        INSTR MUST FOLLOW        Y02076 30975202
         CLM   WRKR3,D7,DSABTIOT+D1     CORRECT DSAB             Y02076 30983202
         BE    REPDC04E                 YES  DO DEB WORK         Y02076 30985202
         CLC   DSABFCHN+D1(D3),DSABCHNE END OF DSAB CHAIN        Y02076 30985602
         BE    REPDC04D                 YES ERROR DSAB NOT FOUND Y02076 30986002
         L     WRKR4,DSABFCHN           STEP TO NEXT DSAB ADDRESSY02076 30986402
         B     REPDC04C                 TEST NEXT DSAB           Y02076 30986502
REPDC04D EQU   *                        INSTR MUST FOLLOW        Y02076 30988102
         MVI   RSRETCOD+D1,ERR099       NO DSAB FOUND ERROR    @ZSUT222 30992037
         B     REPDCBER                 BRANCH TO ERROR EXIT     Y02076 30993602
REPDC04E EQU   *                        INSTR MUST FOLLOW        Y02076 30995102
         L     WRKR5,TABVLID4           ADDRESSABILITY FOR DEB   YM7053 30995202
         LA    WRKR5,D0(WRKR5)          ADR ONLY                 Y02076 30995902
         SH    WRKR5,DEBPROFF           OFFSET BACK TO DEB PREFIXY02076 30996802
         USING DEBPREFX,WRKR5                                    Y02076 30998402
         L     WRKR5,DEBXTNP            ADDRESSABILITY FOR DEB EXY02076 31000002
         USING DEBXTN,WRKR5                                      Y02076 31009102
         STCM  WRKR4,D7,DEBXDSAB+D1     STORE CORRECT DSAB ADR   Y02076 31019102
         LR    WRKR5,WRKR4              SAVE DSAB ADR            Y02076 31019502
         LH    WRKR4,DCBTIOT            ADDRESSABILITY FOR TIOT DY02076 31021102
         AR    WRKR4,TIOTR              ADR IN TIOT              Y02076 31021202
         USING TIOENTRY,WRKR4                                    Y02076 31021602
         TM    TIOELINK,TIOESSDS        IS IT A SUBSYS DATA SET  YM7399 31021902
         BZ    REPDCBC1                 TEST FOR CHKPT DATA SET  Y02076 31022302
         OI    TABFLG1,TABSYS           IND SUB SYS DATA SET     Y02076 31022402
**********************************************************************  31022702
*                                                                    *  31027202
*              UPDATE SUBSYSTEM SSOB/SSIB                            *  31029202
*                                                                    *  31031202
**********************************************************************  31031602
         L     DEBR,TABVLID4            SET UP DEB ADDRESSABILITYYM7053 31031702
         LA    DEBR,D0(DEBR)            ADR ONLY                 Y02076 31033702
         L     WRKR6,DEBECBAD           GET ADR OF DCB SINCE     YM5313 31035702
         USING IHADCB,WRKR6               DEBDCBAD PTS TO ACB    YM5313 31037702
         STCM  DEBR,D7,DCBDEBAD+D1      DEB ADR INTO DCB         YM5313 31037802
         L     DCBR,TABDCBAD-D1         GET ACB ADDRESS          YM7337 31039302
         MVC   DCBTIOT,DCBTIOT-IHADCB(DCBR) UPDATE TIOT OFFSET   YM7337 31041302
         DROP  WRKR6                                             YM5313 31042002
         SR    WRKR4,WRKR4                                       Y02076 31043502
         LA    WRKR4,DEBBASND           GET END BASIC SECT       Y02076 31045002
         LA    WRKR4,D4(WRKR4)          ADR START OF SSIB        Y02076 31046502
         ST    WRKR4,RSERAS00           SAVE SSIB ADR            Y02076 31048002
         USING SSIB,WRKR4                                        Y02076 31049502
         AH    WRKR4,SSIBLEN            POINT TO SSOB            Y02076 31051002
         DROP  WRKR4                                             Y02076 31052502
         USING SSOB,WRKR4                                        Y02076 31054002
         LH    WRKR6,SSOBLEN            SSOB LENGTH=FUN SEC SSOB Y02076 31055502
         AR    WRKR6,WRKR4              BEGINNING ADDRESS        Y02076 31057002
         STCM  WRKR6,D7,SSOBINDV+D1                              Y02076 31058502
         L     WRKR6,RSERAS00           GET ADR OF SSIB          Y02076 31060002
         STCM  WRKR6,D7,SSOBSSIB+D1     SSIB STORE IT IN SSOBSSIBY02076 31070702
         USING DSAB,WRKR5                                        Y02076 31072702
         USING SSIB,WRKR6                                        Y02076 31074702
         MVC   SSIBSSNM(D4),DSABSSNM    SUB SYSTEM NAME TO SSIB  Y02076 31076702
         L     WRKR4,SSOBINDV                                    Y02076 31079102
         USING SSDABGN,WRKR4                                     Y02076 31079502
         STCM  DEBR,D7,SSDADEBP+D1      ADDRESS OF DEB TO SSOB   Y02076 31079902
         MVC   SSDASSCM(D4),DSABSSCM    SDB PTR INTO SSOB EXT.   YM5360 31089902
         DROP  WRKR5                                             YM5360 31091902
         L     WRKR5,TABJFCB-D1         GET JFCB ADDRESS         YM5360 31093902
         LA    WRKR5,D16(,WRKR5)        POSITION OVER SWA PREFIX YM5360 31095902
         ST    WRKR5,SSDAJFCB           STORE IN SSOB EXT.       YM5360 31097902
*********************************************************************** 31098402
*              FOR ALL SECURE CHECKPOINT DATA SET'S AT RESTART TIME   * 31100402
*              UPDATE THE REAL USER'S DCB WITH THE NEW DEB ADDRESS    * 31102402
*              AND TIOT OFFSET.  IF THE RESTART DATA SET IS FOUND     * 31102802
*              INDICATE SUCH IN ITS 48 BYTE ENTRY.                    * 31103202
*********************************************************************** 31103602
REPDCBC1 EQU   *                        INSTR MUST FOLLOW        Y02076 31103702
         L     DCBR,TABDCBAD-D1         CURRENT DCB ADR          Y02076 31104002
         L     DEBR,TABVLID4            CURRENT DEB ADR          YM7053 31104102
         LA    DEBR,D0(DEBR)            ADR ONLY                 Y02076 31104502
         LR    WRKR4,DEBR                                        Y02076 31106102
         SH    WRKR4,DEBPROFF           ADR DEB PREFIX           Y02076 31108102
         USING DEBPREFX,WRKR4                                    Y02076 31108202
         L     WRKR4,DEBXTNP            DEB EXTENTION ADR        Y02076 31108502
         USING DEBXTN,WRKR4                                      Y02076 31108902
         L     WRKR4,DEBXDSAB           DSAB ADDRESS TO BASE REG Y02076 31110502
         USING DSAB,WRKR4                                        Y02076 31112502
         TM    DSABFLG4,DSABCKDS        CHECK POINT DATA SET     Y02076 31112902
         BNO   REPDC04F                 NO  NEXT DCB             Y02076 31113502
         CLC   TABDCBAD(D3),RSCKDCB+D1        RS CK PT DATA SET  Y02076 31113902
         BNE   REPDCB4X                 NO TEST SECURITY FLAG    Y02076 31114702
         OI    TABFLG2,TABRSDS          INDICATE RESTART DATA ST Y02076 31114802
REPDCB4X EQU   *                        INSTR MUST FOLLOW        Y02076 31116102
         TM    DSABFLG4,DSABCKSI        SEC INTERFACE IN EFFECT  Y02076 31118102
         BNO   REPDC04F                 IF NOT, BRANCH           YM7337 31118502
         DROP  DCBR                                              YM5313 31118602
         USING IHADCB,WRKR2                                      Y02076 31118702
         L     WRKR2,TABDCBAD-D1        PROTECTED DCB ADR        Y02076 31118802
         AH    WRKR2,USCKPDSA           USERS REAL DCB ADR       Y02076 31120702
         L     WRKR2,D0(WRKR2)          DCB ADR                  Y02076 31122702
         STCM  DEBR,D7,DCBDEBAD+D1      STORE CURRENT DEB ADR    YM5313 31123102
         MVC   DCBTIOT,DCBTIOT-IHADCB(DCBR) UPDATE TIOT OFFSET   YM7337 31123202
         SR    WRKR2,WRKR2                                       Y02076 31123502
REPDC04F EQU   *                        NEXT DCB                 YM7337 31125902
         L     WRKR6,RSTIOTAD           GET TASKS OLD TIOT              31128402
         USING DEBPREFX,WRKR3                                    Y02076 31130702
         LR    WRKR3,DEBR               LOAD BASE REGISTER       Y02076 31131502
         SH    WRKR3,DEBPROFF           OFFSET BACK TO DEB PREFIXY02076 31131902
         CLI   DEBAMTYP,VS              VSAM DATA SET            Y02076 31132002
         BNE   REPDCBA1                 NEXT DEB & TABL ENT      YM7053 31132102
         XC    TABDSORG(TABENT),TABDSORG  ZERO OUT VSAM ENTRY    YM7053 31150002
         B     REPDCB4A                 GO GET NEXT DEB          YM7053 31154002
REPDCBA1 EQU   *                        INSTR MUST FOLLOW        Y02076 31156502
         CLI   DEBAMTYP,IS              IS IT ISAM             @ZA12948 31157537
         BNE   REPDCBA5                 NO -NEXT ENTRY         @ZA12948 31158537
         TM    DEBFLGS1,DEBCINDI        ISAM CI PROCESSING     @ZA12948 31159537
         BNO   REPDCBA5                 NO - NEXT ENTRY        @ZA12948 31160537
         XC    TABDSORG(TABENT),TABDSORG XERO ISAM CI ENTRY    @ZA12948 31161537
         B     REPDCB4A                 PROCESS NEXT DEB       @ZA12948 31162537
REPDCBA5 EQU   *                                               @ZA12948 31163537
         LA    CTABLR,TABENT(CTABLR)    INCREMENT TO NXT NTRY    Y02076 31166502
REPDCB4A L     DEBR,DEBDEBAD            GET NEXT POSSIBLE DEB ADDR      31176502
         LA    DEBR,D0(DEBR)            ADR ONLY                 Y02076 31178502
         LTR   DEBR,DEBR                IS IT END OF DEB CHAIN   Y02076 31180502
         BNZ   REPDCB01                 BRANCH IF NO             YM7053 31180902
         DROP  WRKR2,WRKR4,WRKR6                                 Y02076 31181202
*                                                                       31205602
*********************************************************************** 31230018
*                                                                       31320018
*    ALL OPENED DATA SETS HAVE BEEN LOCATED WITHIN NEW TIOT             31410018
*                                                                       31500018
*    THE NEXT SECTION OF CODE WILL ESTABLISH THE WORK AREA WITHIN THE   31590018
*    USERS BUFFER THAT WILL BE USED TO PROCESS JFCB(S)                  31680018
*                                                                       31770018
*    REGISTERS STILL IN USE AT THIS TIME ARE -                          31860018
*    TCBR,BUFR,TIOTR,TABLR,DSCNTR,AND BASER. ALL OTHERS MAY BE RESET    31950018
*                                                                       32040018
*********************************************************************** 32130018
*                                                                       32220018
         SR    WRKR5,WRKR5              INITIALIZE REGISTER             32310018
*                                                                       32400018
         L     WRKR6,RSSSCR             GET LENGTH OF BUFFER   @ZA24633 32490037
         ST    WRKR5,RSSSCR             ZERO SSCR FIELD        @ZA24633 32520037
         LA    WRKR3,BUFSEG             SIZE OF A BUFFER SEGMENT        32580018
         LR    CTABLR,TABLR             INIT. CURR. ENTRY REG.          32670018
*                                                                       32760018
         DR    WRKR5,WRKR3              COMPUTE NO. SEGMENTS IN BUFFER  32850018
*                                                                       32940018
*********************************************************************** 33030018
*                                                                       33120018
*    AT THIS POINT WRKR6 HAS NUMBER OF BUFFER SEGMENTS AVAILABLE TO     33210018
*    OVERLAP I/O WITH, WRKR5 HAS REMAINDER OF BUFFER THAT CANT BE USED  33300018
*                                                                       33390018
*********************************************************************** 33480018
*                                                                       33570018
         LR    WRKR1,DSCNTR             TOTAL NO. DATA SETS TO PROCESS  33660018
         LR    WRKR2,WRKR6              NO. SEGMENTS AVAILABLE TO USE   33750018
*                                                                       33840018
REPDCB05 EQU   *                                                        33930018
*                                                                       34020018
         LR    WRKR4,UCBR               INITIALIZE BEGINNING OF BUFFER  34110018
*                                                                       34200018
REPDCB06 EQU   *                                                        34290018
*                                                                       34380018
         ST    WRKR4,0(,WRKR4)          DUMP AND MOVE SEGMENT    M3408  34440020
         MVC   TABSEGAD(3),1(WRKR4)     ADDR TO PRESERVE TABFLG1 M3408  34500020
         LA    CTABLR,TABENT(CTABLR)    INCREMENT TO NEXT ENTRY         34560018
*                                                                       34650018
         BCT   WRKR1,REPDCB07           PROCESS ALL DATA SETS           34740018
*                                                                       34830018
*    THIS RTN WILL FLAG THE LAST TABL ENTRY WITH A X'08' IN TABFLG1   * 34920018
*                                                                       35010018
         LA    WRKR2,TABENT                                             35100018
         SR    CTABLR,WRKR2                                             35190018
         OI    TABFLG1,TABLAST          FLAG LAST ENTRY                 35280002
         LR    WRKR3,WRKR6              LOAD NO. OF SEGMENTS     M34083 35310020
*                                       INTO WRKR                M3408  35340020
         B     REPDCBEX                 FINISH PROCESSING        M3408  35400020
*                                                                       35460018
REPDCB07 EQU   *                                                        35550018
*                                                                       35640018
         LA    WRKR4,0(WRKR4,WRKR3)     INCREMENT TO NEXT SEGMENT       35730018
         BCT   WRKR2,REPDCB06           BUFFER SEGMENT AVAILABLE BRANCH 35820018
*                                                                       35910018
         LR    WRKR2,WRKR6              INITIALIZES NO. BUFFER SEGMENTS 36000018
         B     REPDCB05                 CONTINUE TO SET UP TABLE        36090018
*                                                                       36180018
REPDCBER EQU   *                                                        63180018
*                                                                       63270018
         MVC   RSPPM+4(2),ERREXIT       SET RESTART EXIT LOAD ID M3408  63370020
         MVC   RSREGSAV(8),MODID        SAVE NAME OF MOD. THAT @ZSUT222 63420037
*                                       DETECTED THE ERROR     @ZSUT222 63450037
         STM   0,15,RSREGSAV+8          SAVE CURRENT REGISTERS @ZSUT222 63520037
*                                                                       64080018
REPDCBEX EQU   *                                                        64170018
*                                                                       64260018
         LA    WRKR6,RSPPM+8            SET UP FOR XCTL          A26097 64310019
         LR    WRKR2,BUFR               POINT REG 1 TO THE RESTART W/A  64390018
*                                                                       64440018
*********************************************************************** 64530018
*                                                                       64620018
         XCTL  EPLOC=RSPPM,SF=(E,(15))                           A26097 64820019
*                                                                       65070018
*********************************************************************   65160018
*                                                                       65250018
*     CONSTANTS USED IN REPI/O                                          65340018
*                                                                       65430018
NORMALXT DC    C'IGC0G95B'              TABLE COMPLETION LOAD ID M3408  65530020
MODID    DC    CL8'IGC0G05B'            MODULE ID              @ZSUT222 65580037
ERREXIT  DC    C'V0'                    RESTART EXIT LOAD ID     M3408  65630020
SSCRLNGT DC    H'4096'                  SSCR BUFR LNGTH          Y02076 65632002
DEBPROFF DC    H'16'                    OFFSET FOR DEB PREFIX    Y02076 65640002
USCKPDSA DC    H'-4'                    OFFSET FOR USER CKP D SETY02076 65650002
DSABCHNE DC    X'000000'                DSAB END OF CHAIN MASK   Y02076 65670002
*                                                                     * 65680000
*        MAINTENANCE SPACE                                       Y01909 65730000
*                                                                     * 65780000
PATCH    DC    XL((*-IGC0G05B)/20)'00'   FIVE PERCENT SPACE      Y01909 65830000
*                                                                     * 65880000
         EJECT                                                          66690018
         IEZJSCB                                                        66740002
         EJECT                                                          66790002
         IEEVRSWA VER=3                 USE AOS2 VERSION OF WA          66830000
         EJECT                                                          66870018
RSDSECT  DSECT                                                          66960018
*                                                                       67050018
*    DATA EXTENT BLOCK                                                  67140018
*                                                                       67230018
RSDEB    DS    0CL48                                                    67320018
RSDEBTCB DC    X'00000000'              TCB ADDRESS                     67410018
RSDEBDEB DC    X'00000000'              DEB ADDRESS                     67500018
*                                                                       67590018
*    DATA CONTROL BLOCK                                                 67680018
*                                                                       67770018
RSDEBOFL DS    0CL1                                                     67860018
RSDEBIRB DC    X'00000000'              IRB ADDRESS                     67950018
RSDEBSYS DC    X'00000000'              1ST IOB ADDR IN SYS.PURGE CHAIN 68040018
RSDEBUSR DC    X'00000000'              1ST IOB ADDR IN USER PRGE CHAIN 68130018
RSDEBECB DC    X'00000000'              PARM.LIST ADDR TO PURGE ECB     68220018
RSDEBID  DS    0CL1                                                     68310018
RSDEBDCB DC    AL4(RSDCBREP)            DCB ADDR                        68400018
RSDEBAPP DS    CL4                      I/O APPENDAGE VECTOR TABLE      68490018
RSDEBMOD DS    0CL1                                                     68580018
RSDEBUCB DS    F                        UCB ADDRESS                     68670018
RSDEBBIN DS    H                        BIN NUMBER                      68760018
RSDEBSCC DS    H                        CYLINDER START ADDRESS          68850018
RSDEBSHH DS    H                        TRACK START ADDRESS             68940018
RSDEBECC DS    H                        CYLINDER END ADDRESS            69030018
RSDEBEHH DS    H                        TRACK END ADDRESS               69120018
RSDEBNTR DS    H                        NO. OF TRACKS IN THIS EXTENT    69210018
*                                                                       69300018
*    EVENT CONTROL BLOCK                                                69390018
*                                                                       69480018
RSECBAD  DS    CL4                      ECB ADDRESS                     69570018
RSDCBDEB DC    AL4(RSDEB)               DEB ADDRESS                     69660018
*                                                                       69750018
RSDCBREP EQU   RSDEB+8                  POINT TO RELATIVE BEGINNING DCB 69840018
*                                                                       69930018
*    INPUT OUTPUT BLOCK                                                 70020018
*                                                                       70110018
RSIOB    DS    0CL40                                                    70200018
RSIOBFG1 DC    X'00'                    I/O FLAGS BYTE 1                70290018
RSIOBFG2 DC    X'00'                    I/O FLAGS BYTE 2                70380018
RSIOBSN1 DS    CL1                      FIRST SENSE BYTE                70470018
RSIOBSN2 DS    CL1                      SECOND SENSE BYTE               70560018
RSIOBECB DC    AL4(RSECBAD)             ECB ADDRESS                     70650018
RSIOBCSW DS    D                        LAST CSW                        70740018
RSIOBCPA DS    AL4(RSCCW1)              CHANNEL PROGRAM ADDRESS         70830018
RSIOBDCB DS    AL4(RSDCBREP)            DCB ADDRESS                     70920018
RSIOBRCP DS    CL4                      RESTART ADDRESS FOR IOS         71010018
RSIOBINC DS    H                        INCREMENT BLOCK COUNT           71100018
RSIOBECT DS    H                        NO. OF ERROR ENTRIES            71190018
RSIOBDAD DS    D                        SEEK ADDRESS FOR DA             71280018
*                                                                       71370018
*    CHANNEL PROGRAM                                                    71460018
*                                                                       71550018
RSCCWLST DS    0CL24                                                    71640018
RSCCW1   DS    D                        CCW1                            71730018
RSCCW2   DS    D                        CCW2                            71820018
RSCCW3   DS    D                        CCW3                            71910018
*                                                                       72000018
*    BUFFER SEGMENT FOR EXTERNAL BLOCKS                                 72090018
*                                                                       72180018
RSBUFSEG DS    0CL176                                                   72270018
RSJFCB   EQU   RSBUFSEG                                                 72360018
*                                                                       72450018
*********************************************************************** 72540018
*                                                                       72630018
*                  JFCB                                                 72720018
*                                                                       72810018
*********************************************************************** 72900018
*                                                                       72990018
JFCBDSNM DS    CL44                         DATA SET NAME               73080018
JFCBELNM DS    CL8                          ELEMENT NAME OR VERSION     73170018
JFCBTSDM DS    CL1                          TASK SCHEDULER - DATA       73260018
*                                            MANAGEMENT INTERFACE BYTE  73350018
JFCBSYSC DS    CL13                         SYSTEM CODE                 73440018
JFCBLTYP DS    CL1                          LABEL TYPE AND USER'S-LABEL 73530018
*                                            INDICATOR                  73620018
         DS    CL1                          NOT USED                    73710018
JFCBFLSQ DS    CL2                          FILE SEQUENCE NUMBER        73800018
JFCBVLSQ DS    CL2                          VOLUME SEQUENCE NUMBER      73890018
JFCBMASK DS    CL8                          DATA MANAGEMENT MASK        73980018
JFCBCRDT DS    CL3                          DATA SET CREATION DATE      74070018
JFCBXPDT DS    CL3                          DATA SET EXPIRATION DATE    74160018
JFCBIND1 DS    CL1                          INDICATOR BYTE 1            74250018
JFCBRLSE EQU   64                            BITS 0 AND 1 - EXTERNAL    74340018
*                                            STORAGE RELEASE INDICATOR  74430018
JFCBLOCT EQU   16                            BITS 2 AND 3 - DATA SET    74520018
*                                            HAS BEEN LOCATED           74610018
JFCBNEWV EQU   4                             BITS 4 AND 5 - NEW VOLUME  74700018
*                                            ADDED TO DATA SET          74790018
JFCBPMEM EQU   1                             BITS 6 AND 7 - DATA SET IS 74880018
*                                            A MEMBER OF A PODS OR GDG  74970018
JFCBIND2 DS    CL1                          INDICATOR BYTE 2            75060018
JFCBSTAT EQU   64                            BITS 0 AND 1 - DATA SET    75150018
*                                            STATUS (NEW, OLD, OR MOD)  75240018
JFCBSCTY EQU   16                            BITS 2 AND 3 - DATA SET    75330018
*                                            SECURITY INDICATOR         75420018
JFCBUFNO DS    0AL1                                                     75510018
JFCBUFRQ DS    AL1                      BUFFER REQUESTED                75600018
JFCBFTEK DS    0BL1                                                     75690018
JFCBFALN DS    BL1                      BUFFER ALIGNMENT                75780018
JFCBUFL  DS    AL2                      BUFFER LENGTH                   75870018
JFCEROPT DS    BL1                      ERROR ROUTINE                   75960018
JFCTRTCH DS    0BL1                                                     76050018
JFCKEYLE DS    0AL1                                                     76140018
JFCMODE  DS    0BL1                                                     76230018
JFCCODE  DS    0BL1                                                     76320018
JFCSTACK DS    0BL1                                                     76410018
JFCPRTSP DS    BL1                      PRINTER SPACING                 76500018
JFCDEN   DS    BL1                      TAPE DENSITY                    76590018
JFCLIMCT DS    AL3                      NO. OF TRKS.TO BE SEARCHED      76680018
JFCDSORG DS    BL2                      DATA SET ORGANIZATION           76770018
JFCRECFM DS    BL1                      RECORD FORMAT                   76860018
JFCOPTCD DS    BL1                      OPTION CODES                    76950018
JFCBLKSI DS    AL2                      BLOCK SIZE                      77040018
JFCLRECL DS    AL2                      LOGICAL RECORD LENGTH           77130018
JFCNCP   DS    AL1                      NO. OF CHANNEL PROGRAM          77220018
JFCNTM   DS    AL1                      NO. OF TRKS. FOR MASTER INDEX   77310018
JFCRKP   DS    AL2                      RELATIVE POSITION OF KEY        77400018
JFCCYLOF DS    AL1                      NO. OF TRKS FOR OVERFLOW        77490018
JFCDBUFN DS    AL1                      RESERVED                        77580018
JFCINTVL DS    AL1                      INTENTIONAL INTERVAL            77670018
JFCCPRI  DS    BL1                      PRIORITY                        77760018
JFCSOWA  DS    AL2                      SIZE OF WORKAREA                77850018
JFCBNTCS DS    CL1                          NUMBER OF OVERFLOW TRACKS   77940018
JFCBNVOL DS    CL1                          NUMBER OF VOLUME SERIAL     78030018
*                                            NUMBERS                    78120018
JFCBVOLS DS    CL30                         VOLUME SERIAL NUMBERS (THE  78210018
*                                            FIRST FIVE)                78300018
JFCBEXTL DS    CL1                          LENGTH OF BLOCK OF EXTRA    78390018
*                                            VOLUME SERIAL NUMBERS      78480018
*                                            (BEYOND FIVE)              78570018
JFCBEXAD DS    CL3                          TRACK ADDRESS OF BLOCK OF   78660018
*                                            EXTRA VOL SERIAL NUMBERS   78750018
JFCBPQTY DS    CL3                          PRIMARY QUANTITY OF D.A.    78840018
*                                            STORAGE REQUIRED           78930018
JFCBCTRI DS    CL1                          INDICATES WHETHER CYLINDERS 79020018
*                                            TRACKS, OR RECORDS ARE     79110018
*                                            SPECIFIED IN JFCBPQTY AND  79200018
*                                            JFCBSQTY                   79290018
JFCBSQTY DS    CL3                          SECONDARY QUANTITY OF D.A.  79380018
*                                            STORAGE REQUIRED           79470018
JFCBIND3 DS    CL1                          INDICATOR BYTE 3            79560018
JFCBCNTG EQU   64                            BITS 0 AND 1 - CONTIGUOUS  79650018
*                                            STORAGE INDICATOR          79740018
JFCBMXIG EQU   16                            BITS 2 AND 3 - MAXIMUM     79830018
*                                            AVAILABLE EXTENT INDICATOR 79920018
JFCBALXI EQU   4                             BITS 4 AND 5 - ALL EXTENTS 80010018
*                                            INDICATOR                  80100018
JFCBRNDC EQU   1                             BITS 6 AND 7 - ROUND       80190018
*                                            CYLINDER INDICATOR         80280018
JFCBDQTY DS    CL3                          QUANTITY OF D.A. STORAGE    80370018
*                                            REQUIRED FOR A DIRECTORY   80460018
JFCBSPNM DS    CL3                          CORE ADDRESS OF THE JFCB    80550018
*                                            WITH WHICH CYLINDERS ARE   80640018
*                                            SPLIT                      80730018
JFCBABST DS    CL2                          RELATIVE ADDRESS OF FIRST   80820018
*                                            TRACK TO BE ALLOCATED      80910018
JFCBSBNM DS    CL3                          CORE ADDRESS OF THE JFCB    81000018
*                                            FROM WHICH SPACE IS TO BE  81090018
*                                            SUBALLOCATED               81180018
JFCBDRLH DS    CL3                          AVERAGE DATA RECORD LENGTH  81270018
JFCBVLCT DS    CL1                          VOLUME COUNT                81360018
JFCBSPTN DS    CL1                          NUMBER OF TRACKS PER        81450018
*                                            CYLINDER TO BE USED BY     81540018
*                                            THIS DATA SET WHEN SPLIT   81630018
*                                            CYLINDER IS INDICATED      81720018
JFCBLGTH EQU   176                          LENGTH OF JFCB              81810018
JFCBEND  EQU   *                                                        81900018
*                                                                       81990018
         ORG   RSBUFSEG+176             ORG BACK TO BUFFER SEGMENT      82080018
RSSTATUS DS    0CL8                                                     82170018
RSSTAT1  DS    CL1                      STATUS BYTE 1                   82260018
RSSTAT2  DS    CL1                      STATUS BYTE 2                   82350018
RSSTAT3  DS    CL1                      STATUS BYTE 3                   82440018
RSSTAT4  DS    CL1                      STATUS BYTE 4                   82530018
         DS    F                        RESERVED FOR FUTURE USE         82620018
         EJECT                                                          82710018
CVT      DSECT                                                          82800018
         CVT                                                            82890018
         EJECT                                                          82900002
         IHAQDB                                                  Y02076 82940002
         EJECT                                                          82980018
*                                                                       83070018
*                                                                       83160018
*   TASK CONTROL BLOCK                                                  83250018
*                                                                       83300002
*                                                                       83350002
         IKJTCB                                                  Y02076 83400002
         EJECT                                                          85410018
         DCBD  DSORG=PS                                                 85500018
         EJECT                                                          85590018
         IEZDEB                                                  Y02076 86090002
         EJECT                                                          86100002
         IHADSAB                                                 Y02076 86140002
         EJECT                                                          86150002
         IEFJSSOB (DA),CONTIG=YES                                Y02076 86190002
         EJECT                                                          86200002
         IEFJSSIB                                                Y02076 86240002
         EJECT                                                          89190018
         IHJDSTAB                                                Y02076 89240002
         EJECT                                                          92880018
TIOT     DSECT                                                          92970018
         IEFTIOT1                                                       93060018
         EJECT                                                          93150018
SRT      DSECT                                                          93240018
         IEFUCBOB                                                       93330018
*                                                                       93420018
*                                                                       93510018
*                                                                       93600018
         END                                                            93690018
