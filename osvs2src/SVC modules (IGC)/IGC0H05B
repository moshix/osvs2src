         TITLE 'IGC0H05B - DUMMY DATA SET PROCESSOR'                    00007002
IGC0H05B CSECT                                                          00021019
*********************************************************************** 00022019
*                                                                       00023019
*                                                                       00024019
*          RELEASE 22 DELETIONS/CHANGES                                 00025019
*          RELEASE 21 DELETIONS/CHANGES                                 00026019
*          RELEASE 20 DELETIONS/CHANGES                                 00027019
*0930                                                            A38814 00027220
*0930                                                            20201  00027520
*                                                                       00028019
*                                                                A28676 00029019
*          RELEASE 3.7 CHANGES ADDITIONS DELETIONS                      00029337
*C224000,A225100-225200                                        @ZA17960 00029637
* APAR OZ31485 HAS BEEN FLAGGED AS @ZSUT222                    @ZSUT222 00029737
*C188000,188300,308000,308010,308040                           @ZSUT222 00030737
*A308116-308124,440200                                         @ZSUT222 00033037
*                                                                       00034037
*TITLE         IGC0H05B----DUMMY DATA SET PROCESSOR                     00035019
*                                                                       00042019
*STATUS CHANGE LEVEL 002                                                00049020
*                                                                       00056019
*FUNCTION/OPERATION- IGC0H05B RECEIVES CONTROL FROM IGC0I05B WHEN       00063019
*              AN ENTRY IN THE REPIO TABLE CORRESPONDS TO A DUMMY       00070019
*              DATA SET.                                                00077019
*                                                                       00084019
*              IGC0H05B EXAMINES EACH ENTRY IN THE REPIO TABLE.         00091019
*              IF AN ENTRY CORRESPONDS TO A NON-DUMMY DATA SET          00098019
*              OR TO A DATA SET THAT WAS DUMMY AT RESTART IT IS         00105019
*              IGNORED.                                                 00112019
*                                                                       00119019
*              IF AN ENTRY CORRESPONDS TO A DUMMY DATA SET THAT         00126019
*              WAS NOT DUMMY AT RESTART TIME, THE DATA SET              00133019
*              ORGANIZATION AT CHECKPOINT TIME IS CHECKED.  IF          00140019
*              THE DATA SET WAS NOT EITHER A BSAM OR QSAM DATA          00147019
*              SET, THE ACCESS METHODS LOADED BY OPEN ARE DELETED,      00152019
*              THE DEB IS UNCHAINED AND FREED AND AN ERROR CODE OF      00157019
*              79 IS PLACED IN THE RESTART WORK AREA.                   00162019
*              THIS SAME ERROR PROCEDURE IS FOLLOWED IF THE CHECKPOINT  00163019
*              AT WHICH RESTART IS OCCURRING WAS TAKEN IN AN            00164019
*              END OF VOLUME EXIT FOR A DATA SET THAT HAS BEEN          00165019
*              MADE DUMMY                                               00166019
*                                                                       00168019
*              IF A QSAM OR BSAM DATA SET HAS BEEN MADE DUMMY           00175019
*              IGC0H05B DOES THE FOLLOWING:                             00182019
*               1. DELETES ACCESS METHODS LOADED BY OPEN                00189019
*                  (EXCEPT FOR SUBSYSTEM DATA SETS).                    00191002
*                                                                       00196019
*               2. UNCHAINS AND FREES THE DEB                           00203019
*                                                                       00210019
*               3. FREES IOBS CREATED BY OPEN (SEE NOTES)               00217019
*                  (EXCEPT FOR SUBSYSTEM DATA SETS).                    00219002
*               4. GETMAIN FOR A DUMMY DEB, STORES ITS ADDRESS IN       00224019
*                  THE DCB AND ADDS THE DEB TO THE DEB CHAIN            00231019
*                  (SEE NOTES)                                          00238019
*                                                                       00245019
*               5. LOADS DUMMY ACCESS METHOD IGG019AV AND SETS          00252019
*                  APPROPRIATE POINTERS TO IT IN THE DCB (SEE NOTES)    00259019
*                                                                       00266019
*ENTRY POINTS  IGC0H05B VIA XCTL FROM IGC0I05B                          00273019
*                                                                       00280019
*INPUT-        REGISTER 1   ADDRESS OF RESTART WORK AREA (TSTWA DSECT)  00287019
*              REGISTER 8   ADDRESS OF THE FIRST TABLE ENTRY            00294019
*                                                                       00301019
*OUTPUT-       SAME AS REGISTER 1 AND 8 ABOVE                           00308019
*                                                                       00315019
*EXITS-NORMAL- IGC0K05B IF A NON-DA DATA SET IS PRESENT                 00322019
*              IGC0M05B IF ALL DATA SETS ARE DA RESIDENT                00329019
*                                                                       00336019
*      ERROR-  IGC0V05B                                                 00343037
*                 079 - IF A DATA SET THAT WAS NOT A QSAM OR BSAM       00343637
*                       DATA SET HAS BEEN MADE DUMMY OR IF THE          00345019
*                       CHECKPOINT AT WHICH RESTART IS OCCURRING        00347019
*                       WAS TAKEN IN AN END OF VOLUME EXIT FOR A        00349019
*                       DATA SET THAT HAS BEEN MADE DUMMY.              00351019
*                 080 - IF AN ISAM/VSAM CI DATA SET HAS BEEN            00353037
*                       MADE DUMMY AT RESTART TIME.                     00355037
*                                                                       00357019
*SVCS USED: GETMAIN,FREEMAIN,DELETE,LOAD,XCTL                           00364019
*                                                                       00371019
*CONTROL BLOCKS REFERENCED- DCB,DEB,TCB,TIOT,CVT                        00378019
*                                                                       00385019
*TABLES/WORK AREAS                                                      00392019
*********************************************************************** 00400019
*                                                                     * 00500019
*    THE FOLLOWING IS A DESCRIPTION OF THE 48 BYTE TABLE ENTRY THAT   * 00600019
*    IS USED IN THE RESTART PORTION OF CHECKPOINT/RESTART.  EACH      * 00700019
*    ENTRY IN THE TABLE (ONE FOR EACH OPEN DATA SET AT CHECKPOINT)    * 00800019
*    IS 48 BYTES LONG.                                                * 00900019
*                                                                     * 01000019
*********************************************************************** 01100019
*                                                                       01200019
*        ------------------- 4 BYTES -----------------                  01300019
*                                                                       01400019
*      0 +++++++++++++++++++++++++++++++++++++++++++++                  01500019
*        +DATA SET  +           DCB                  +                  01600019
*        + ORGN.    +         ADDRESS                +                  01700019
*        +++++++++++++++++++++++++++++++++++++++++++++ 4                01800019
*        +FLAG BYTE +    WORKAREA SEGMENT            +                  01900019
*        + NO. 1    +         ADDRESS                +                  02000019
*      8 +++++++++++++++++++++++++++++++++++++++++++++                  02100019
*        +NUMBER    +         JFCB TTR               +                  02200019
*        + OF VOLS  +         ADDRESS                +                  02300019
*        +++++++++++++++++++++++++++++++++++++++++++++ 12               02400019
*                                                                       02500019
*     12 +++++++++++++++++++++++                                        02600019
*        +TAPE LABL + FILE SEQ +        DEVICE = TAPE                   02700019
*        +INFO BYTE + NUMBER   +                                        02800019
*        +++++++++++++++++++++++                                        02900019
*                                                                       03000019
*     12 +++++++++++++++++++++++                                        03100019
*        +    OLD   TIOT       +        DA AND UNIT RECORD              03200019
*        +      OFFSET         +                                        03300019
*        +++++++++++++++++++++++                                        03400019
*                                                                       03500019
*                              +++++++++++++++++++++++                  03600019
*                              +FLAG BYTE +FLAG BYTE +                  03700019
*                              +  NO. 2   +  NO. 3   +                  03800019
*     16 +++++++++++++++++++++++++++++++++++++++++++++                  03900019
*        +FLAG BYTE +FLAG BYTE +                     +                  04000019
*        + NO. 4    + NO. 5    +   VOLUME ID NO. 1   +                  04100019
*        +++++++++++++++++++++++                     + 20               04200019
*        +                                           +                  04300019
*        +                                           +                  04400019
*     24 +++++++++++++++++++++++++++++++++++++++++++++                  04500019
*        +                                           +                  04600019
*        +   VOLUME ID NO. 2                         +                  04700019
*        +                     +++++++++++++++++++++++ 28               04800019
*        +                     +                     +                  04900019
*        +                     +   VOLUME ID NO. 3   +                  05000019
*     32 +++++++++++++++++++++++                     +                  05100019
*        +                                           +                  05200019
*        +                                           +                  05300019
*        +++++++++++++++++++++++++++++++++++++++++++++ 36               05400019
*        +                                           +                  05500019
*        +   VOLUME ID NO. 4                         +                  05600019
*     40 +                     +++++++++++++++++++++++                  05700019
*        +                     +                     +                  05800019
*        +                     +                     +                  05900019
*        +++++++++++++++++++++++   VOLUME ID NO. 5   + 44               06000019
*        +                                           +                  06100019
*        +                                           +                  06200019
*        +++++++++++++++++++++++++++++++++++++++++++++ 48               06300019
*                                                                       06400019
*                                                                       06500019
*           A  DCBTABLE,                                                06600019
*                                                                       06700019
*           B  BUFFER AREA,                                             06800019
*                                                                       06900019
*           C  SEE DSECTS AT END OF LISTING.                            07000019
*                                                                       07100019
*ATTRIBUTES                                                             07200019
*                                                                       07300019
*          A RE-ENTRANT                                                 07400019
*          B RE-USABLE                                                  07500019
*          C ENABLED                                                    07600019
*          D PRIVILEGED                                                 07700002
*                                                                       07800019
*NOTES         THE CODE THAT FREES THE IOBS IS TAKEN FROM CLOSE         07810019
*              MODULE IGG0201B                                          07820019
*                                                                       07830019
*              THE CODE THAT CREATES THE DUMMY DEB AND SETS POINTERS    07840019
*              TO IGG019AV IS TAKEN FROM OPEN MODULE IGG0191C           07850019
*                                                                       07860019
*********************************************************************   07900019
         EJECT                                                          07930019
*********************************************************************** 07960019
*                                                                       08000019
*    REGISTER CONVENTION TO BE USED THRU-OUT REPI/O PHASE               08100019
*                                                                       08200019
*********************************************************************** 08300019
*                                                                       08400019
WRKR1    EQU   0                        WDRK/PARAMETER REGISTER         08500019
WRKR2    EQU   1                        WDRK/PARAMETER REGISTER         08600019
DCBR     EQU   2                        CURRENT DCB REGISTER            08700019
BASER    EQU   3                        BASE REGISTER                   08800019
DEBR     EQU   4                        CURRENT DEB REGISTER            08900019
UCBR     EQU   5                        CURRENT UCB REGISTER            09000019
TIOTR    EQU   6                        NEW TIOT REGISTER               09100019
TCBR     EQU   7                        TCB REGISTER                    09200019
TABLR    EQU   8                        BEGINNING TO DCB TABLE REG      09300019
CTABLR   EQU   9                        CURRENT ENTRY IN DCB TABLE      09400019
BUFR     EQU   10                       USER BUFFER AREA                09500019
DSCNTR   EQU   11                       WORK REGISTER                   09600019
WRKR3    EQU   12                       WORK REGISTER                   09700019
WRKR4    EQU   13                       WORK REGISTER                   09800019
WRKR5    EQU   14                       WORK/PARAMETER REGISTER         09900019
WRKR6    EQU   15                       WORK/PARAMETER REGISTER         10000019
         EJECT                                                          10100019
*********************************************************************** 10200019
*                                                                       10300019
*    OFFSETS TO BE USED IN REPI/O PHASE                                 10400019
*                                                                       10500019
*********************************************************************** 10600019
*                                                                       10700019
IS       EQU   X'80'                    INDEXED SEQUENCIAL              10800019
PS       EQU   X'40'                    PHYSICAL SEQUENCIAL             10900019
DA       EQU   X'20'                    DIRECT ACCESS                   11000019
PO       EQU   X'02'                    PARTITIONED ORGANIZATION        11100019
INOROUT  EQU   X'40'                    SYSIN OR SYSOUT DATA SET        11300019
DADEV    EQU   X'20'                    DA DEVICE                       11400019
TPDEV    EQU   X'10'                    TAPE DEVICE                     11500019
UNITREC  EQU   X'04'                    UNIT RECORD EQUIPMENT           11700019
ERRINNSL EQU   X'80'                    ERROR IN NSL ROUTINE            11800019
NSLMTSW  EQU   X'40'                    NSL MOUNT SWITCH                11900019
NSLCOMU  EQU   X'20'                    NSL COMMUNICATION BIT           12000019
BYPASS   EQU   X'10'                    BYPASS LABEL PROCESSING         12100019
NSL      EQU   X'04'                    NON-STANDARD LABEL              12200019
SL       EQU   X'02'                    STANDARD LABEL                  12300019
NL       EQU   X'01'                    NO LABEL                        12400019
GTR5VOL  EQU   X'80'                    GREATER THAN 5 VOLUMES          12500019
POCONCAT EQU   X'40'                    P.O. CONCATENATED               12600019
DAFLAG   EQU   X'80'                    DA DATA SET FLAG                12700019
NONDAFLG EQU   X'40'                    NON-DA DATA SET FLAG            12800019
NSLFLAG  EQU   X'10'                    NSL ROUTINE FLAG                12900019
TYPERST  EQU   X'80'                    IMMEDIATE RESTART               13000019
TABENT   EQU   48                       TABLE ENTRY LENGTH              13100019
WRITE    EQU   X'01'                    WRITE ON TAPE                   13200019
READ     EQU   X'02'                    READ FOR TAPE                   13300019
NOPOP    EQU   X'03'                    NOP                             13400019
SENSE    EQU   X'04'                    SENSE                           13500019
REWIND   EQU   X'07'                    REWIND                          13600019
READBACK EQU   X'0C'                    READBACK                        13700019
UNLOAD   EQU   X'0F'                    REWIND AND UNLOAD               13800019
WTM      EQU   X'1F'                    WRITE TAPE MARK                 13900019
BSFOP    EQU   X'2F'                    BACKWARD SPACE FILE             14000019
FSFOP    EQU   X'3F'                    FORWARD SPACE FILE              14100019
SEARCH   EQU   X'31'                    SEARCH                          14200019
SRCHCNT  EQU   X'05'                    COUNT FOR SEARCH ID             14300019
TIC      EQU   X'08'                    TIC                             14400019
READDA   EQU   X'06'                    READ FOR DA                     14500019
LENJFCB  EQU   X'B0'                    LENGTH OF JFCB                  14600019
LBLLEN   EQU   X'50'                    LENGTH OF LABEL                 14700019
PERMERR  EQU   X'7F'                    PERMANENT ERROR                 14800019
ERR24    EQU   24                       I/O ERROR IN READING IN JFCB    14900019
BUFSEG   EQU   304                                                      15000019
TIOTBASE EQU   24                                                       15100019
TTROFFST EQU   12                                                       15200019
BUSY     EQU   X'80'                                                    15300019
ISORDA   EQU   IS+DA                    IS OR DA                        15400019
IOERROR  EQU   X'20'                    PERMANENT I/O ERROR             15500019
NODIOERR EQU   X'3F'                                                    15600019
TIMES16  EQU   4                                                        15700019
DADEVICE EQU   4                                                        15800019
BASICLN  EQU   32                                                       15900019
ISAM     EQU   X'80'                                                    16000019
QSAMBSAM EQU   X'40'                                                    16100019
EXCP     EQU   X'80'                                                    16150019
BUFAD    EQU   0                   BCB 1ST BUFFER ADDR OFFSET    A38814 16160020
BUFLG    EQU   4                   BCB FLAG OFFSET               A38814 16170020
SPANFLAG EQU   X'80'               SPAN RECORD FLAG              A38814 16180020
K1       EQU   1                                                        16200019
K2       EQU   2                                                        16300019
K3       EQU   3                                                        16400019
K4       EQU   4                                                        16500019
K5       EQU   5                                                        16600019
K6       EQU   6                                                        16700019
K7       EQU   7                   CONSTANT OF 7                 YM7303 16710002
K8       EQU   8                                                        16750000
K9       EQU   9                   CONSTANT OF 9                 YM7303 16760002
K10      EQU   10                                                       16800019
K12      EQU   12                                                       16900019
K13      EQU   13                  CONSTANT OF 13                YM7303 16950002
K16      EQU   16                                                       17000019
K20      EQU   20                                                       17050000
K21      EQU   21                  CONSTANT OF 21                YM7303 17052002
K24      EQU   24                  CONSTANT OF 24                YM7828 17054002
K25      EQU   25                  CONSTANT OF 25                YM7828 17056002
K28      EQU   28                                                       17060000
K30      EQU   30                                                       17100019
K32      EQU   32                                                       17200019
K36      EQU   36                                                       17300019
K46      EQU   46                                                       17400019
K48      EQU   48                                                       17500019
K60      EQU   60                                                       17600019
K61      EQU   61                                                       17700019
K70      EQU   70                                                       17800019
QSAMB    EQU   1                                                        17900019
FIRSTIOB EQU   1                                                        18000019
PCIB     EQU   X'04'                                                    18100019
DUMYDBLN EQU   56                  CONSTANT FOR DUMMY DEB SIZE   YM7341 18300002
READB    EQU   X'20'                                                    18400019
WRITEB   EQU   X'20'                                                    18500019
QOUT     EQU   X'40'                                                    18600019
LOCATEB  EQU   8                                                        18700019
ERR079   EQU   79                       DUMMY D/S ERROR        @ZSUT222 18800037
ERR080   EQU   80                       ISAM/VSAM CI ERROR     @ZSUT222 18830037
TIMES2   EQU   1                                                        18900019
TIMES4   EQU   2                                                        18950019
TIMES8   EQU   3                                                        19000019
BDAMDS   EQU   X'20'                                                    19050019
EOVEXIT  EQU   X'02'                                                    19070019
*                                                                       19100019
*                                       RECORD READY CONSTANTS          19106020
*                                                                       19112020
CPSTART EQU 48                          OFFSET OF BEGIN OF CP    20201  19118020
ONECCW   EQU   8                        LENGTH OF ONE CCW        20201  19124020
TWOCCWS  EQU   16                       LENGTH OF TWO CCW'S      20201  19130020
SETSECTR EQU   X'23'                    COMMAND CODE FOR SET     20201  19136020
*                                       SECTOR                   20201  19142020
NOTUPDTE EQU   X'0B'                    MASK FOR NON UPDATE      20201  19148020
UPDMASK  EQU X'04'                      MASK FOR UPDATE          20201  19154020
NINE     EQU   9                        CONSTANT OF 9            20201  19160020
THREE    EQU   3                        CONSTANT OF 3            20201  19166020
PCISTART EQU   56                       BEGIN OF PCI CP          20201  19172020
*                                                                       19178020
*                                                                       19184020
*********************************************************************** 19200019
         EJECT                                                          19300019
         BALR  BASER,0             ESTABLISH ADDRESSABILITY             19400002
         USING *,BASER             ESTABLISH BASE REGISTER              19500002
         B     BEGIN               BRANCH AROUND EYE CATCHER     Y01909 19550000
         CNOP  0,8                 ALIGN TO A DBL WORD BOUNDARY  Y01909 19560000
         DC    CL8'IGC0H05B'       MODULE NAME                 @ZSUT222 19570037
         DC    CL8'&SYSDATE'       LAST DATE SHIPPED           @ZSUT222 19572037
         DC    CL8'@ZSUT222'       LAST CODE SHIPPED           @ZSUT222 19574037
BEGIN    EQU   *                                                 Y01909 19580000
*                                                                       19600019
         USING IHADCB,DCBR                                              19700019
         USING UCBOB,UCBR                                               19800019
         USING RSDSECT,WRKR4                                            19900019
         USING TIOENTRY,WRKR5                                           20000019
         USING DEBBASIC,DEBR                                            20200002
         USING TCB,TCBR                                                 20300019
         USING TABL,CTABLR                                              20400019
         USING RSTWA,BUFR                                               20500019
*                                                                       20600019
         LR    CTABLR,TABLR        POINT TO START OF TABLE              20700019
         XC    RSRETCOD,RSRETCOD   CLEAR ERROR INDICATORS               20750019
REPDCB10 EQU   *                                                        20800019
         TM    TABFLG1,TABNULL     IS THIS A DUMMY DATA SET      Y02076 20900002
         BO    REPDCB25            BRANCH IF YES                        21000019
REPDCB20 EQU   *                                                        21100019
         TM    TABFLG1,TABLAST     LAST ENTRY                    Y02076 21200002
         BO    REPDCB80            BRANCH IF YES                        21300019
         LA    CTABLR,TABENT(CTABLR)   NEXT ENTRY                       21400019
         B     REPDCB10            GO PROCESS IT                        21500019
REPDCB25 EQU   *                                                        21600019
         L     DCBR,TABDCBAD-1     LOAD DCB ADDRESS                     21700019
         L     DEBR,DCBDEBAD       LOAD DEB ADDRESS                     21800019
         SPACE 4                                                        21850019
****                                                                    21900019
*        CHECK TO SEE IF THE DATA SET WAS DUMMY AT CHKPT TIME.          22000019
*        IF IT WAS, GET NEXT TABLE ENTRY.                               22100019
****                                                                    22260019
         SPACE 2                                                        22320019
         TM    TABFLG2,TABOSSDS    WAS DS SUBSYS AT CHKPT TIME   YM7399 22370002
         BZ    REPDCB28            IF NOT, BRANCH                YM7399 22380002
         L     WRKR2,DEBECBAD      GET USER'S DCB ADDRESS        YM7399 22390002
         MVC   DCBTIOT-IHADCB(2,WRKR2),DCBTIOT UPDATE USER'S DCB YM7399 22392002
         MVC   DCBDEBAD+1-IHADCB(3,WRKR2),DCBDEBAD+1 TIOT OFFSET YM7399 22392402
*                                  AND DEB ADDR FROM SUBSYS ACB  YM7399 22394002
         LR    DCBR,WRKR2          UPDATE THE WORKING DCB ADDR   YM7399 22398002
         B     REPDCB40            GO PROCESS SUBSYSTEM DUMMY    YM7828 22398402
REPDCB28 EQU   *                   NON-SUBSYSTEM ENTRY           YM7399 22398802
         CLC   DEBDEVED(2),LOADNAME+6  WAS OLD DS DUMMY ?      @ZA17960 22400037
         BE    REPDCB20            BRANCH IF YES                        22500019
         CLI   DEBEXSCL,0          DUMMY DATASET ?             @ZA17960 22550037
         BE    REPDCB20            BRANCH IF YES               @ZA17960 22600037
         TM    TABFLG2,TABCIDS     IS IT ISAM/VSAM(CI)           Y02076 22650002
         BO    REPDCB49            TO ERROR IF YES               Y02076 22700002
         LA    WRKR2,DEBBASIC-DEBPREFX NEG OFFSET TO DEB PREFIX  YM7828 22750002
         LNR   WRKR2,WRKR2         SET IT NEG FOR ADD            YM7828 22760002
         AR    WRKR2,DEBR          GET DEB PREFIX ADDR           YM7828 22770002
         USING DEBPREFX,WRKR2      ADDRESS DEB PREFIX            YM7828 22780002
         L     WRKR2,DEBXTNP       GET DEB EXTENSION ADDR        YM7828 22790002
         USING DEBXTN,WRKR2        ADDRESS DEB EXTENSION         YM7828 22792002
         L     WRKR2,DEBXDSAB      GET DSAB ADDRESS              YM7828 22794002
         USING DSAB,WRKR2          ADDRESS DSAB                  YM7828 22796002
         MVC   RSERAS01(K1),DSABFLG4 SAVE CHKPT DS FLAGS         YM7828 22798002
         NI    DSABFLG4,X'FF'-DSABCKDS-DSABCKSI RESET CHKPT FLGS YM7828 22798802
         DROP  WRKR2               DSAB                          YM7828 22799202
         CLI   DEBNMSUB,0          ANY SUBROUTINES LOADED               22800019
         BE    REPDCB39            BRANCH IF NO                         22900019
         SPACE 4                                                        22950019
****                                                                    23000019
*        THE NEXT SECTION OF CODE LOCATES THE SUBROUTINE NAME           23100019
*        SECTION OF THE DEB.                                            23200019
****                                                                    23300019
         LA    WRKR2,BASICLN       LENGTH OF BASIC SECTION              23400019
         CLI   DEBEXSCL,DADEVICE   DIRECT ACCESS DEVICE                 23500019
         BNE   REPDCB32            BRANCH IF NO                         23600019
         OI    TABFLG1,TABDA       SET TEMPORARY DA SW           YM7550 23650002
         SR    WRKR1,WRKR1         CLEAR WRKR1                          23700019
         IC    WRKR1,DEBNMEXT      GET NUMBER OF EXTENTS                23800019
         SLL   WRKR1,TIMES16       MULTIPLY BY 16 TO GET NUMBER         23900019
*                                  OF BYTES                             24000019
         AR    WRKR2,WRKR1         POINT TO ACCESS METHOD SECTION       24100019
         B     REPDCB34            SKIP TAPE-UNIT RECORD CODE           24200019
REPDCB32 EQU   *                                                        24300019
         LA    WRKR2,K4(WRKR2)     POINT TO ACCESS METHOD SECTION       24400019
*                                  (TAPE-UNIT RECORD DEVICE             24500019
*                                  DEPENDANT SECTION IF FOUR            24600019
*                                  BYTES IN LENGTH)                     24700019
REPDCB34 EQU   *                                                        24800019
         SR    WRKR1,WRKR1         CLEAR WRKR1                          24900019
         IC    WRKR1,DEBAMLNG      GET LENGTH OF ACCESS METHOD          25000019
*                                  SECTION OF DEB                       25100019
         TM    TABDSORG,DCBDSGDA   BDAM DATA SET                 Y02049 25120002
         BZ    REPDCB36            BRANCH IF NO                         25140019
         SLL   WRKR1,TIMES4        MULTIPLY BY 4 TO GET LENGTH IN BYTES 25160019
REPDCB36 EQU   *                                                        25180019
         AR    WRKR2,WRKR1         GET OFFSET TO BEGINNING              25200019
*                                  OF ACCESS METHOD NAMES               25300019
         SPACE 4                                                        25310019
****                                                                    25320019
*        THIS SECTION OF CODE DELETES SUBROUTINES LOADED BY OPEN        25330019
****                                                                    25340019
         SPACE 2                                                        25350019
         LA    DEBR,0(DEBR)        CLEAR HIGH ORDER BYTE OF DEBR        25400019
         LA    WRKR3,0(WRKR2,DEBR) POINT TO BEGINNING OF ACCESS         25500019
*                                  METHOD SECTION                       25600019
         SR    WRKR5,WRKR5         CLEAR WRKR5                          25700019
         IC    WRKR5,DEBNMSUB      GET NUMBER OF SUBROUTINES            25800019
         SLL   WRKR5,TIMES2        MULTIPLY BY TWO                      25900019
         AR    WRKR5,WRKR2         GET OFFSET TO END OF DEB             26000019
         LA    DSCNTR,0(DEBR,WRKR5) POINT TO END OF DEB                 26100002
         LR    UCBR,BUFR           SAVE RSWA ADDR                       26200019
         LA    BUFR,K2             CONSTANT 2                           26300019
         SR    DSCNTR,BUFR         POINT TO LAST SUBROUTINE NAME        26400019
         MVC   TABVLID1(K6),LOADNAME   MOVE IGG019 TO W.A.              26500019
REPDCB38 EQU   *                                                        26600019
         MVC   TABVLID2(K2),0(WRKR3)   SET LAST TWO BYTES OF            26700019
*                                  SUBROUTINE NAME FROM DEB             26800019
         DELETE    EPLOC=TABVLID1  DELETE SUBROUTINE                    26900019
         BXLE  WRKR3,BUFR,REPDCB38 DELETE REST OF MODULES               27000019
         LR    BUFR,UCBR           RESTORE RSWA ADDR                    27100019
REPDCB39 EQU   *                                                        27200019
         TM    RSERAS01,DSABCKDS+DSABCKSI CHKPT S/I EXIST        YM7828 27250002
         BNO   REPDCB40            IF NOT, SKIP S/I DELETION     YM7828 27300002
         MVC   TABVLID1(K6),LOADNAME SETUP TO DELETE S/I ERROR   YM7828 27350002
         MVC   TABVLID2(K2),IGG019SI ROUTINE (IGG019SI)          YM7828 27400002
         DELETE EPLOC=TABVLID1     DELETE IT                     YM7828 27410002
*                                                                YM7828 27420002
*        FREEMAIN THE CHECKPOINT PROTECTED DCB                   YM7828 27430002
*                                                                YM7828 27440002
         LA    DCBR,0(,DCBR)       CLEAR BYTE 0 OF DCB ADDR      YM7828 27442002
         LA    WRKR2,K28           GET NEG OFFSET TO START OF    YM7828 27444002
         LNR   WRKR2,WRKR2         PROTECTED DCB PREFIX          YM7828 27446002
         AR    WRKR2,DCBR          GET ADDR OF DCB PREFIX        YM7828 27448002
         ICM   DCBR,B'0111',K25(WRKR2) GET USER'S DCB ADDR       YM7828 27448102
         STCM  DCBR,B'0111',TABDCBAD UPDATE TABLE ENTRY          YM7828 27448202
         SR    WRKR1,WRKR1         CLEAR FREEMAIN PARM REG       YM7828 27448402
         ICM   WRKR1,B'0001',K24(WRKR2) GET FREEMAIN LENGTH      YM7828 27448802
         ICM   WRKR1,B'1000',SP252 GET SUBPOOL 252 ID            YM7828 27449202
         FREEMAIN R,LV=(0),A=(1)   FREE IT                       YM7828 27449602
         EJECT                                                          27450019
****                                                                    27500019
*        THE FOLLOWING SECTION OF CODE UNCHAINS AND DELETES             27600019
*        THE DEB                                                        27700019
****                                                                    27800019
         SPACE 2                                                        27850019
REPDCB40 EQU   *                                                        27900019
         L     TCBR,RSTCBAD        LOAD TCB ADDRESS                     28000019
         LA    DEBR,0(DEBR)        CLEAR HIGH BYTE OF DEBR              28100019
         L     WRKR2,RSINT         LOAD ADDR OF 1ST DEB                 28200002
         LA    WRKR2,0(WRKR2)      CLEAR HIGH ORDER BYTE                28300019
         CR    WRKR2,DEBR          IS THIS THE FIRST DEB                28400019
         BNE   REPDCB42            BRANCH IF NO                         28500019
         MVC   RSINT+1(K3),DEBDEBAD+1   DELETE DEB FROM CHAIN           28600019
         B     REPDCB46            GO FREE DEB CORE                     28700019
REPDCB42 EQU   *                                                        28800019
         CLC   K5(K3,WRKR2),DCBDEBAD+1 DOES THIS DEB POINT TO DEB       28900019
*                                      THAT IS TO BE FREED              29000019
         BE    REPDCB44            BRANCH IF YES                        29100019
         L     WRKR2,K4(WRKR2)     GET ADDRESS OF NEXT DEB              29200019
         B     REPDCB42            GO CHECK NEXT DEB                    29300019
REPDCB44 EQU   *                                                        29400019
         MVC   K5(K3,WRKR2),DEBDEBAD+1 UNCHAIN DEB BY RESETTING         29500019
*                                  DEB POINTER IN PREVIOUS DEB          29600019
REPDCB46 EQU   *                   INSTR MUST FOLLOW             Y02076 29700002
         LR    WRKR5,DEBR          GET DEB ADDR                  Y02076 29702002
         LA    WRKR6,DEBPRFLN      GET PREFIX LENGTH             Y02076 29704002
         SR    WRKR5,WRKR6         CALC ADDR OF DEB PREFIX       Y02076 29706002
         USING DEBPREFX,WRKR5                                    Y02076 29708002
         MVC   RSERAS00(1),DEBPROTG SAVE KEY AND ID              YM7879 29708102
         MVC   RSERAS00+1(1),DEBOPATB SAVE OPEN ATTRIBUTES       YM7879 29708202
         L     WRKR6,DEBXTNP       GET DEB EXTENTION PTR         Y02076 29708402
         ST    WRKR6,TABVLID5+K2   SAVE FOR LATER RESTORE        Y02076 29708802
         DROP  WRKR5                                             Y02076 29709202
         SR    WRKR6,WRKR6         CLEAR REG                     20201  29710002
         TM    DEBOPATB,UPDMASK    UPDATE BIT ON                 20201  29720002
         BNO   REPDC603            BRANCH IF NO                  20201  29730002
         TM    DEBOPATB,NOTUPDTE   ANY BITS OTHER THAN           20201  29740002
*                                  UPDATE                        20201  29750002
         BNZ   REPDC603            BRANCH IF YES                 20201  29760002
         LA    WRKR6,K1            SET THE INDICATOR REG         YM7341 29770002
REPDC603 EQU   *                   INSTR MUST FOLLOW             20201  29780002
         LA    WRKR2,K36           LENGTH OF DEB PREFIX                 29800019
         SR    DEBR,WRKR2          POINT TO BEGINNING OF DEB            29900019
         SR    WRKR1,WRKR1         CLEAR R0                             30000019
         IC    WRKR1,K32(DEBR)     GET LENGTH OF DEB IN DOUBLE          30100019
*                                  WORDS                                30200019
         SLL   WRKR1,TIMES8        MULTIPLY BY EIGHT TO GET             30300019
*                                  LENGTH IN BYTES                      30400019
         O     WRKR1,SP230         SET SUBPOOL                   YM6586 30500002
         LR    WRKR2,DEBR          SET R1 WITH ADDR OF DEB              30600019
         TM    TABFLG2,TABOSSDS    IS THIS A SUBSYSTEM D/S       YM7399 30650002
         BZ    REPDC613            IF NOT, BRANCH                YM5720 30660002
         LA    WRKR2,K28(,WRKR2)   ADJUST TO SUBSYSTEM DEB       YM5720 30670002
*                                  PREFIX ADDR (PREFIX=8 BYTES)  YM5720 30680002
REPDC613 EQU   *                   FREEMAIN THE DEB              YM5720 30690002
         MODESET EXTKEY=DATAMGT    ASSUME DEB KEY                YM6586 30692002
         FREEMAIN  R,LV=(0),A=(1)  FREE THE DEB                         30700019
         MODESET EXTKEY=ZERO       RESUME SUPERVISOR KEY         YM6586 30702002
         SPACE 4                                                        30710019
****                                                                    30720019
*        SEE IF DATA SET MADE DUMMY WAS A QSAM OR BSAM DATA SET         30730019
*        AT CHECKPOINT TIME.  IF IT WAS NOT  PUT ERROR CODE 79 IN       30740019
*        WORK AREA AND GO GET NEXT TABLE ENTRY.                         30750019
****                                                                    30760019
         SPACE 2                                                        30770019
         TM    TABFLG2,TABOSSDS    IS THIS SUBSYS MADE DUMMY     YM7528 30772002
         BO    REPDCB48            IF YES, DSORG IS GOOD         YM7528 30772402
         L     WRKR5,TABVLID5+K2   GET DEB EXTENSION POINTER     Y02049 30773002
         USING DEBXTN,WRKR5                                      Y02049 30775002
         TM    DEBXMCF1,DCBMRECP   IS THIS AN EXCP DATA SET?     Y02049 30775402
         BO    REPDCB47            BRANCH IF YES                        30776019
         TM    DEBXDSO1,DCBDSGPS   QSAM OR BSAM DATA SET         Y02049 30780002
         DROP  WRKR5                                             Y02049 30782002
         BO    REPDCB48            BRANCH IF YES                        30790019
REPDCB47 EQU   *                                                        30795019
         MVI   RSRETCOD+1,ERR079   SET DUMMY DATA SET ERROR    @ZSUT222 30800037
         B     REPDCBER            SAVE THE CURR. ENVIRONMENT  @ZSUT222 30801037
         SPACE 4                                                        30802037
REPDCB49 EQU   *                   INSTR MUST FOLLOW             Y02076 30803037
         MVI   RSRETCOD+K1,ERR080  SET ISAM/VSAM(CI) ERROR     @ZSUT222 30804037
REPDCBER MVC   RSREGSAV(8),MODID   SAVE NAME OF MODULE THAT    @ZSUT222 30811637
*                                  HAS DETECTED THE ERROR.     @ZSUT222 30812037
         STM   0,15,RSREGSAV+8     SAVE CURRENT REGISTERS      @ZSUT222 30812437
         B     REPDCB20            GO GET NEXT ENTRY             Y02076 30813202
****                                                                    30814019
*        CHECK TO SEE IF THE CHECKPOINT AT WHICH RESTART IS OCCURRING   30816019
*        WAS TAKEN IN AND OF VOLUME EXIT FOR THE DATA SET THAT HAS BEEN 30818019
*        MADE DUMMY.  IF IT WAS, AN ERROR CONDITION EXISTS.             30820019
****                                                                    30822019
         SPACE 2                                                        30824019
REPDCB48 EQU   *                                                        30826019
         TM    DCBOFLGS,EOVEXIT    CHKPT TAKEN IN EOV FOR THIS DATA SET 30828019
         BZ    REPDCB47            BRANCH IF YES---ERROR                30830019
         SPACE 4                                                        30832019
****                                                                    30834019
*        CHECK TO SEE IF AN ERROR HAS BEEN PREVIOUSLY DETECTED.         30836019
*        IF ONE HAS BEEN DETECTED, SKIP FURTHER PROCESSING OF THIS      30838019
*        ENTRY.                                                         30840019
****                                                                    30842019
         SPACE 2                                                        30844019
         OC    RSRETCOD,RSRETCOD   ANY PREVIOUS ERRORS                  30846019
         BNZ   REPDCB20            BRANCH IF YES                        30848019
         EJECT                                                          30850019
****                                                                    30900019
*        THIS SECTION OF CODE FREES IOBS CREATED BY OPEN                31000019
****                                                                    31100019
         SPACE 2                                                        31150019
REPDCB50 EQU   *                                                        31220019
         TM    TABFLG2,TABOSSDS    TEST IF SUBSYSTEM D/S         YM7399 31270002
         BO    REPDCB64            YES-BYPASS FREEING IOBS       Y02076 31280002
         XR    WRKR5,WRKR5         CLEAR WRKR5                          31300019
         XR    WRKR1,WRKR1         CLEAR WRKR1                          31400019
         XR    WRKR2,WRKR2         CLEAR WRKR2                          31500019
         IC    WRKR1,DCBIOBL       GET LENGTH OF IOB IN DOUBLE WORDS    31600019
         SLL   WRKR1,TIMES8        LENGTH IN BYTES                      31700019
         IC    WRKR2,DCBNCP        NUMBER OF BSAM CPS                   31800019
         TM    DCBCIND2,QSAMB      QSAM DATA SET                        31900019
         BZ    REPDCB52            BRANCH IF NO                         32000019
         IC    WRKR2,DCBBUFNO      GET NUMBER OF QSAM CPS               32100019
REPDCB52 EQU   *                                                        32200019
         TM    DCBCIND2,PCIB       CHAINED SCHEDULING                   32300019
         BO    REPDCB58            BRANCH IF YES                        32400019
         L     WRKR3,DCBIOBA       LOAD IOB ADDRESS                     32500019
REPDCB54 EQU   *                                                        32600019
         TM    0(WRKR3),FIRSTIOB   IS THIS THE FIRST IOB                32700019
         BO    REPDCB60            BRANCH IF YES                        32800019
         L     WRKR3,0(WRKR3)      GET NEXT IOB                         32900019
         B     REPDCB54            CONTINUE SEARCH FOR FIRST IOB        33000019
REPDCB58 EQU   *                                                        33100019
         L     WRKR3,DCBIOBAD      GET MAIN IOB ADDR                    33200019
         LA    WRKR3,0(WRKR3)      CLEAR HIGH BYTE                      33300019
         LA    WRKR5,K48           CNST OF 48 FOR MAIN IOB              33400019
         TM    TABFLG1,TABDA       USING DA DEVICE               Y02049 33500002
         BZ    REPDCB60            BRANCH IF NO                         33600019
         LA    WRKR5,K32(WRKR5)    ADD 32 FOR D.A.                      33700019
         CLI   PCISTART(WRKR3),SETSECTR IS IT RPS                20201  33720020
         BNE   REPDCB60            BRANCH IF NO                  20201  33740002
         LA    WRKR5,TWOCCWS(WRKR5) ADD ON LENGTH OF TWO         20201  33760002
*                                  CCWS                          20201  33780002
REPDCB60 EQU   *                                                        33800019
         LTR   WRKR2,WRKR2         WERE NUM OF CP'S SPECIFIED           33900019
         BH    REPDCB62            BRANCH IF YES                        34000019
         LA    WRKR2,K1            NO,PROVIDE ONE                       34100019
         TM    TABFLG1,TABDA       IS DIRECT ACCESS USED         Y02049 34106002
         BNO   REPDCB62            BRANCH IF NO                  20201  34112002
         CLI   CPSTART(WRKR3),SETSECTR  IS IT RPS                20201  34118020
         BNE   REPDCB62            BRANCH IF NO                  20201  34124002
         LTR   WRKR6,WRKR6         UPDATE USED                   20201  34130002
         BZ    REPDC604            BRANCH NO                     20201  34136002
         LA    WRKR6,NINE(WRKR2)   THESE 3 INSTRUCTIONS ARE      20201  34142002
         SRL   WRKR6,THREE         NUM OF CHPS + 2               20201  34148002
         SLL   WRKR6,THREE         ROUNDED UP TO NEAREST DW      20201  34154002
         B     REPDC605            BRANCH                        20201  34160002
REPDC604 EQU   *                                                 20201  34166020
         LA    WRKR6,ONECCW        EIGHT FOR ONE CCW             20201  34172002
REPDC605 EQU   *                                                 20201  34178020
         AR    WRKR5,WRKR6         INCREMENT TO ADD SECTOR       20201  34184002
*                                  BYTES TO FREEMAIN SIZE               34190002
REPDCB62 EQU   *                                                        34200019
         MR    WRKR1,WRKR1         NO. OF CP'S * IOB SIZE               34300019
         LA    WRKR2,0(WRKR2,WRKR5)    ADD PCI CONSTANTS IF ANY         34400019
         LR    WRKR1,WRKR2         LENGTH OF REG 0                      34500019
         O     WRKR1,SP0           SET SUBPOOL EQUAL TO 0        YM6586 34600002
         LR    WRKR2,WRKR3         ADDR TO REG1                         34700019
         MODESET KEYADDR=RSERAS00,WORKREG=15 ASSUME IOB/CP KEY   YM6586 34750002
         FREEMAIN  R,LV=(0),A=(1)                                       34800019
         MODESET EXTKEY=ZERO       RESUME SUPERVISOR KEY         YM6586 34810002
         EJECT                                                          34850019
****                                                                    34900019
*        THIS SECTION OF CODE CREATES A DUMMY DEB,                      35000019
*        LOADS DUMMY MODULE IGG019AV,                                   35100019
*        AND SETS POINTERS TO IT IN THE DCB.                            35200019
****                                                                    35300019
         SPACE 2                                                        35320019
****                  GET CORE FOR DUMMY DEB                            35340019
         SPACE 1                                                        35360019
REPDCB64 EQU   *                                                        35400019
         NI    TABFLG1,X'FF'-TABDA RESET POSSIBLE TEMP DA SW     YM7550 35450002
         LA    WRKR1,DUMYDBLN      GET LENGTH OF DUMMY DEB              35500019
         O     WRKR1,SP230         SET SUBPOOL                   YM6586 35600002
         MODESET EXTKEY=DATAMGT    ASSUME DEB KEY                YM6586 35650002
         GETMAIN   R,LV=(0)        GET CORE FOR DUMMY DEB               35700019
         MODESET EXTKEY=ZERO       RESUME SUPERVISOR KEY         YM6586 35750002
         ST    WRKR2,TABVLID2      STORE ADDR OF GOTTEN CORE            35800019
         SPACE 1                                                        35820019
****                  FORMAT DUMMY DEB AND STORE ADDR IN DCB            35840019
         SPACE 1                                                        35860019
         XC    0(DUMYDBLN,WRKR2),0(WRKR2)  CLEAR DUMMY DEB              35900019
         USING DEBPREFX,WRKR2                                    Y02076 35950002
         MVC   DEBXTNP,TABVLID5+K2 ADR ORIG EXT IN DUMMYDEB      Y02076 35960002
         L     WRKR5,DEBXTNP       DEB EXT ADR IN WRKR5          Y02076 35970002
         DROP  WRKR2                                             Y02076 35980002
         LA    DEBR,K16(WRKR2)     POINT TO ACTUAL DEB                  36000019
         ST    DEBR,TABVLID2       TEMP SAVE                            36100019
         MVC   DCBDEBAD+1(K3),TABVLID2+1   MOVE DEB ADDR TO DCB         36200019
         LA    DCBR,0(DCBR)        CLEAR HIGH ORDER BYTE OF DCBR        36230019
         ST    DCBR,DEBDCBAD       STORE DCB ADDR IN DEB                36260019
         MVI   K12(WRKR2),K7       SET DOUBLE WORD CNT IN DEB    YM7341 36300002
         MVI   DEBNMSUB,X'01'      SET ACC METH CNT TO 1         YM7879 36310002
         MVC   DEBPROTG,RSERAS00   PROT KEY & ID FROM OLD DEB    YM7879 36311202
         MVC   DEBOPATB,RSERAS00+1 OPEN ATTRIBUTES FROM OLD DEB  YM7879 36311602
         MVC   X'24'(2,DEBR),LOADNAME+6 19AV'S ID TO END OF DEB  YM7879 36311702
         USING DEBXTN,WRKR5                                      Y02076 36312002
         ST    DEBR,DEBXDBPR       ST DUMMY DEB ADR IN EXT       Y02076 36314002
         DROP  WRKR5                                             Y02076 36316002
         SPACE 1                                                        36320019
****                  ADD DUMMY DEB TO THE DEB CHAIN                    36340019
         SPACE 1                                                        36360019
         L     TCBR,RSTCBAD        LOAD TCB ADDRESS                     36400019
         MVC   DEBDEBB(3),RSINT+1  CHAIN NEW DEB                 YM7879 36470002
         ST    DEBR,RSINT          TO DEB CHAIN                         36540002
         STCM  TCBR,B'0111',DEBTCBB TCB ADDRESS TO DEB           YM7879 36610002
         SPACE                                                          36610520
****                  INSURE VALID FIRST-BUFFER-PTR FOR QSAM     A38814 36611020
         SPACE                                                          36611520
         TM    DCBCIND2,QSAMB      QSAM DATA SET                 A38814 36612020
         BZ    REPDC647            BRANCH IF NOT                 A38814 36612520
         L     WRKR2,DCBBUFCB      FETCH BUFFER CNTRL BLK PTR    A38814 36613020
         LA    WRKR2,0(,WRKR2)     CLEAR HI BYTE                 A38814 36613520
         LTR   WRKR2,WRKR2         BUFFER CNTRL BLK PRESENT      A38814 36614020
         BZ    REPDC647            BRANCH IF NOT                 A38814 36614520
         LA    WRKR3,8(,WRKR2)     GET PTR TO 1ST BUFFER         A38814 36615020
         TM    BUFLG(WRKR2),SPANFLAG USING SPAN RECORDS          A38814 36615520
         BZ    REPDC643            BRANCH IF NOT                 A38814 36616020
         LA    WRKR3,4(,WRKR3)     BUMP 1ST BUFFER PTR BY 4      A38814 36616520
REPDC643 EQU   *                                                 A38814 36617020
         ST    WRKR3,BUFAD(,WRKR2) 1ST BUFFER PTR TO BCB         A38814 36617520
REPDC647 EQU   *                                                 A38814 36618020
         SPACE 1                                                        36620019
****                  LOAD IGG019AV                                     36640019
         SPACE 1                                                        36660019
         MVC   TABVLID1(8),LOADNAME    MODULE NAME OF DUMMY MODULE      36700019
         USING CVTMAP,WRKR2                                      Y02076 36750002
         L     WRKR2,CVTPTR        LOAD ADDRESS OF CVT                  36800019
         L     WRKR2,CVTSVDCB      LOAD ADDRESS OF SVCLIB DCB           36900019
         DROP  WRKR2                                             Y02076 36950002
         LOAD  EPLOC=TABVLID1,DCB=(1)  LOAD IGG019AV                    37000019
         LR    WRKR3,WRKR1         SAVE ADDR OF MODULE                  37100019
         EJECT                                                          37210019
****                                                                    37220019
*        THE FOLLOWING CODE SETS THE APPROPRIATE POINTERS IN THE        37230019
*        DCB TO DUMMY ACCESS METHOD IGG019AV                            37240019
****                                                                    37250019
         SPACE 2                                                        37260019
REPDCB65 EQU   *                                                        37270019
         MVC   DCBCNTRL+1(K3),K1(WRKR3) SET ADDR OF CNTRL/NOTE/  YM7303 37300002
*                                  POINT                                37400002
         MVC   DCBREAD+1(K3),K1(WRKR3) SET ADDR OF READ/WRITE    YM7303 37500002
*                                  /GET/PUT                             37600002
         MVC   DCBCHECK+1(K3),K13(WRKR3) SET ADDR OF CHECK       YM7303 37900002
         MVC   DCBIOBA(K4),K16(WRKR3) MOVE DUMMY IOB ADDR TO DCB YM7303 37950002
         TM    DCBMACF1,DCBMRRD    IS THIS BSAM INPUT            YM7528 38500002
         BO    REPDCB70            BRANCH IF YES                        38600019
         TM    DCBMACF2,DCBMRWRT   IS THIS BSAM OUTPUT           YM7528 38700002
         BO    REPDCB70            BRANCH IF YES                        38800019
         TM    DCBMACF2,DCBMRPUT   QSAM OUTPUT                   YM7528 38900002
         BZ    REPDCB66            BRANCH IF NO                         39000019
         TM    DCBMACF2,DCBMRLCP   PUT--LOCATE                   YM7528 39100002
         BZ    REPDCB20            BRANCH IF NO--GET NEXT TABLE ENTRY   39200019
         MVC   DCBPUT+1(K3),K5(WRKR3) SET ADDR OF DUMMY PUT      YM7303 39500002
         B     REPDCB20            GO PROCESS NEXT ENTRY                39600019
REPDCB66 EQU   *                                                        39700019
         MVC   DCBGET+1(K3),K9(WRKR3) SET ADDR OF DUMMY GET      YM7303 40000002
         B     REPDCB20            GO PROCESS NEXT ENTRY                40100019
REPDCB70 EQU   *                                                        40200019
         MVC   DCBREAD+1(K3),K21(WRKR3) SET READ ADDR IN DCB     YM7303 40500002
         B     REPDCB20            GO PROCESS NEXT ENTRY                40600019
         EJECT                                                          40650019
****                                                                    40700019
*        THIS SECTION OF CODE XCTLS TO THE NEXT LOAD OF RESTART IF      40720019
*        NO ERROR HAS BEEN DETECTED.  THE NEXT LOAD IS DETERMINED       40740019
*        BY AN INDICATOR SET IN THE RESTART WORK AREA. THIS INDICATOR   40760019
*        IS SET BY IGC0I05B.  IF ALL DATA SETS ARE ON DIRECT ACCESS     40780019
*        DEVICES, XCTL IS TO IGC0M05B.  IF ALL DATA SETS ARE NOT ON     40800019
*        DIRECT ACCESS DEVICES, XCTL IS TO IGC0K05B.                    40820019
*                                                                       40840019
*        IF AN ERROR HAS BEEN ENCOUNTERED IN THIS MODULE, XCTL IS TO    40860019
*        IGC0V05B.                                                      40880019
*****                                                                   40900019
         SPACE 2                                                        40920019
REPDCB80 EQU   *                                                        41000019
         L     WRKR4,K4(TABLR)     INITIALIZE TO FIRST W.A.             41100019
         OC    RSRETCOD,RSRETCOD   ANY ERRORS DETECTED                  41110019
         BZ    REPDCB81            BRANCH IF NO                         41120019
         MVC   RSJFCB(8),ERORLOAD  SET UP TO XCTL TO IGC0V05B           41130019
         B     REPDCB82            GO XCTL                              41140019
REPDCB81 EQU   *                                                        41150019
         MVC   RSJFCB(8),TAPELOAD  MOVE IN TAPE LOAD ID                 41200019
         TM    RSDCBFLG,NONDAFLG   IS NON DA FLAG ON                    41300019
         BO    REPDCB82            BRANCH IF YES                        41400019
         MVC   RSJFCB(8),DALOAD    MOVE IN DA LOAD ID                   41500019
REPDCB82 EQU   *                                                        41600019
         LA    WRKR6,RSJFCB+8      SET UP FOR XCTL                      41700019
         LR    WRKR2,BUFR          POINT REG 1 TO RESTART WORK AREA     41800019
         XCTL  EPLOC=RSJFCB,SF=(E,(15))                                 41900019
         EJECT                                                          41950019
*                                                                       43300019
*     CONSTANTS USED IN REPI/O                                          43400019
*                                                                       43500019
SIX      DC    H'6'                     OFFSET FOR VOL SEQ NO           43600019
ERORLOAD DC    CL8'IGC0V05B'            RESTART EXIT MODULE             43700019
TAPELOAD DC    CL8'IGC0K05B'            NON-DA MOUNT/VERIFICATION LOAD  43800019
DALOAD   DC    CL8'IGC0M05B'            DA MOUNT/VERIFICATION LOAD      43900019
LOADNAME DC    CL8'IGG019AV'                                            44000019
MODID    DC    CL8'IGC0H05B'            MODULE IDENT.          @ZSUT222 44020037
IGG019SI DC    CL2'SI'                  LAST 2 CHAR OF S/I MOD   YM7828 44050002
         DS    0F                                                       44100019
SP0      DC    AL1(0)                                            YM6586 44200002
         DC    AL3(0)                                                   44300019
SP230    DC    AL1(230)                                          YM6586 44400002
         DC    AL3(0)                                                   44500019
SP252    DC    AL1(252)                 SUBPOOL 252 ID           YM7828 44510002
DEBPRFLN EQU   16                       LENGTH OF DEB PREFIX     Y02076 44530002
*                                                                     * 44550000
*        MAINTENANCE SPACE                                       Y01909 44600000
*                                                                     * 44650000
PATCH    EQU   (*-IGC0H05B)/10          LENGTH OF PATCH AREA     Y01909 44660002
         DC    XL(PATCH)'00'            TEN PERCENT PATCH AREA   Y01909 44670002
*                                                                     * 44680000
         EJECT                                                          44700019
         IEEVRSWA VER=3                 USE OS/VS2 VERSION OF WA        44800000
         EJECT                                                          44900019
RSDSECT  DSECT                                                          45000019
*                                                                       45100019
*    DATA EXTENT BLOCK                                                  45200019
*                                                                       45300019
RSDEB    DS    0CL48                                                    45400019
RSDEBTCB DC    X'00000000'              TCB ADDRESS                     45500019
RSDEBDEB DC    X'00000000'              DEB ADDRESS                     45600019
*                                                                       45700019
*    DATA CONTROL BLOCK                                                 45800019
*                                                                       45900019
RSDEBOFL DS    0CL1                                                     46000019
RSDEBIRB DC    X'00000000'              IRB ADDRESS                     46100019
RSDEBSYS DC    X'00000000'              1ST IOB ADDR IN SYS.PURGE CHAIN 46200019
RSDEBUSR DC    X'00000000'              1ST IOB ADDR IN USER PRGE CHAIN 46300019
RSDEBECB DC    X'00000000'              PARM.LIST ADDR TO PURGE ECB     46400019
RSDEBID  DS    0CL1                                                     46500019
RSDEBDCB DC    AL4(RSDCBREP)            DCB ADDR                        46600019
RSDEBAPP DS    CL4                      I/O APPENDAGE VECTOR TABLE      46700019
RSDEBMOD DS    0CL1                                                     46800019
RSDEBUCB DS    F                        UCB ADDRESS                     46900019
RSDEBBIN DS    H                        BIN NUMBER                      47000019
RSDEBSCC DS    H                        CYLINDER START ADDRESS          47100019
RSDEBSHH DS    H                        TRACK START ADDRESS             47200019
RSDEBECC DS    H                        CYLINDER END ADDRESS            47300019
RSDEBEHH DS    H                        TRACK END ADDRESS               47400019
RSDEBNTR DS    H                        NO. OF TRACKS IN THIS EXTENT    47500019
*                                                                       47600019
*    EVENT CONTROL BLOCK                                                47700019
*                                                                       47800019
RSECBAD  DS    CL4                      ECB ADDRESS                     47900019
RSDCBDEB DC    AL4(RSDEB)               DEB ADDRESS                     48000019
*                                                                       48100019
RSDCBREP EQU   RSDEB+8                  POINT TO RELATIVE BEGINNING DCB 48200019
*                                                                       48300019
*    INPUT OUTPUT BLOCK                                                 48400019
*                                                                       48500019
RSIOB    DS    0CL40                                                    48600019
RSIOBFG1 DC    X'00'                    I/O FLAGS BYTE 1                48700019
RSIOBFG2 DC    X'00'                    I/O FLAGS BYTE 2                48800019
RSIOBSN1 DS    CL1                      FIRST SENSE BYTE                48900019
RSIOBSN2 DS    CL1                      SECOND SENSE BYTE               49000019
RSIOBECB DC    AL4(RSECBAD)             ECB ADDRESS                     49100019
RSIOBCSW DS    D                        LAST CSW                        49200019
RSIOBCPA DS    AL4(RSCCW1)              CHANNEL PROGRAM ADDRESS         49300019
RSIOBDCB DS    AL4(RSDCBREP)            DCB ADDRESS                     49400019
RSIOBRCP DS    CL4                      RESTART ADDRESS FOR IOS         49500019
RSIOBINC DS    H                        INCREMENT BLOCK COUNT           49600019
RSIOBECT DS    H                        NO. OF ERROR ENTRIES            49700019
RSIOBDAD DS    D                        SEEK ADDRESS FOR DA             49800019
*                                                                       49900019
*    CHANNEL PROGRAM                                                    50000019
*                                                                       50100019
RSCCWLST DS    0CL24                                                    50200019
RSCCW1   DS    D                        CCW1                            50300019
RSCCW2   DS    D                        CCW2                            50400019
RSCCW3   DS    D                        CCW3                            50500019
*                                                                       50600019
*    BUFFER SEGMENT FOR EXTERNAL BLOCKS                                 50700019
*                                                                       50800019
RSBUFSEG DS    0CL176                                                   50900019
RSJFCB   EQU   RSBUFSEG                                                 51000019
*                                                                       51100019
*********************************************************************** 51200019
*                                                                       51300019
*                  JFCB                                                 51400019
*                                                                       51500019
*********************************************************************** 51600019
*                                                                       51700019
JFCBDSNM DS    CL44                         DATA SET NAME               51800019
JFCBELNM DS    CL8                          ELEMENT NAME OR VERSION     51900019
JFCBTSDM DS    CL1                          TASK SCHEDULER - DATA       52000019
*                                            MANAGEMENT INTERFACE BYTE  52100019
JFCBSYSC DS    CL13                         SYSTEM CODE                 52200019
JFCBLTYP DS    CL1                          LABEL TYPE AND USER'S-LABEL 52300019
*                                            INDICATOR                  52400019
         DS    CL1                          NOT USED                    52500019
JFCBFLSQ DS    CL2                          FILE SEQUENCE NUMBER        52600019
JFCBVLSQ DS    CL2                          VOLUME SEQUENCE NUMBER      52700019
JFCBMASK DS    CL8                          DATA MANAGEMENT MASK        52800019
JFCBCRDT DS    CL3                          DATA SET CREATION DATE      52900019
JFCBXPDT DS    CL3                          DATA SET EXPIRATION DATE    53000019
JFCBIND1 DS    CL1                          INDICATOR BYTE 1            53100019
JFCBRLSE EQU   64                            BITS 0 AND 1 - EXTERNAL    53200019
*                                            STORAGE RELEASE INDICATOR  53300019
JFCBLOCT EQU   16                            BITS 2 AND 3 - DATA SET    53400019
*                                            HAS BEEN LOCATED           53500019
JFCBNEWV EQU   4                             BITS 4 AND 5 - NEW VOLUME  53600019
*                                            ADDED TO DATA SET          53700019
JFCBPMEM EQU   1                             BITS 6 AND 7 - DATA SET IS 53800019
*                                            A MEMBER OF A PODS OR GDG  53900019
JFCBIND2 DS    CL1                          INDICATOR BYTE 2            54000019
JFCBSTAT EQU   64                            BITS 0 AND 1 - DATA SET    54100019
*                                            STATUS (NEW, OLD, OR MOD)  54200019
JFCBSCTY EQU   16                            BITS 2 AND 3 - DATA SET    54300019
*                                            SECURITY INDICATOR         54400019
JFCBUFNO DS    0AL1                                                     54500019
JFCBUFRQ DS    AL1                      BUFFER REQUESTED                54600019
JFCBFTEK DS    0BL1                                                     54700019
JFCBFALN DS    BL1                      BUFFER ALIGNMENT                54800019
JFCBUFL  DS    AL2                      BUFFER LENGTH                   54900019
JFCEROPT DS    BL1                      ERROR ROUTINE                   55000019
JFCTRTCH DS    0BL1                                                     55100019
JFCKEYLE DS    0AL1                                                     55200019
JFCMODE  DS    0BL1                                                     55300019
JFCCODE  DS    0BL1                                                     55400019
JFCSTACK DS    0BL1                                                     55500019
JFCPRTSP DS    BL1                      PRINTER SPACING                 55600019
JFCDEN   DS    BL1                      TAPE DENSITY                    55700019
JFCLIMCT DS    AL3                      NO. OF TRKS.TO BE SEARCHED      55800019
JFCDSORG DS    BL2                      DATA SET ORGANIZATION           55900019
JFCRECFM DS    BL1                      RECORD FORMAT                   56000019
JFCOPTCD DS    BL1                      OPTION CODES                    56100019
JFCBLKSI DS    AL2                      BLOCK SIZE                      56200019
JFCLRECL DS    AL2                      LOGICAL RECORD LENGTH           56300019
JFCNCP   DS    AL1                      NO. OF CHANNEL PROGRAM          56400019
JFCNTM   DS    AL1                      NO. OF TRKS. FOR MASTER INDEX   56500019
JFCRKP   DS    AL2                      RELATIVE POSITION OF KEY        56600019
JFCCYLOF DS    AL1                      NO. OF TRKS FOR OVERFLOW        56700019
JFCDBUFN DS    AL1                      RESERVED                        56800019
JFCINTVL DS    AL1                      INTENTIONAL INTERVAL            56900019
JFCCPRI  DS    BL1                      PRIORITY                        57000019
JFCSOWA  DS    AL2                      SIZE OF WORKAREA                57100019
JFCBNTCS DS    CL1                          NUMBER OF OVERFLOW TRACKS   57200019
JFCBNVOL DS    CL1                          NUMBER OF VOLUME SERIAL     57300019
*                                            NUMBERS                    57400019
*                                            NUMBERS                    57600019
JFCBVOLS DS    CL30                         VOLUME SERIAL NUMBERS (THE  57700019
*                                            FIRST FIVE)                57800019
JFCBEXTL DS    CL1                          LENGTH OF BLOCK OF EXTRA    57900019
*                                            VOLUME SERIAL NUMBERS      58000019
*                                            (BEYOND FIVE)              58100019
JFCBEXAD DS    CL3                          TRACK ADDRESS OF BLOCK OF   58200019
*                                            EXTRA VOL SERIAL NUMBERS   58300019
JFCBPQTY DS    CL3                          PRIMARY QUANTITY OF D.A.    58400019
*                                            STORAGE REQUIRED           58500019
JFCBCTRI DS    CL1                          INDICATES WHETHER CYLINDERS 58600019
*                                            TRACKS, OR RECORDS ARE     58700019
*                                            SPECIFIED IN JFCBPQTY AND  58800019
*                                            JFCBSQTY                   58900019
JFCBSQTY DS    CL3                          SECONDARY QUANTITY OF D.A.  59000019
*                                            STORAGE REQUIRED           59100019
JFCBIND3 DS    CL1                          INDICATOR BYTE 3            59200019
JFCBCNTG EQU   64                            BITS 0 AND 1 - CONTIGUOUS  59300019
*                                            STORAGE INDICATOR          59400019
JFCBMXIG EQU   16                            BITS 2 AND 3 - MAXIMUM     59500019
*                                            AVAILABLE EXTENT INDICATOR 59600019
JFCBALXI EQU   4                             BITS 4 AND 5 - ALL EXTENTS 59700019
*                                            INDICATOR                  59800019
JFCBRNDC EQU   1                             BITS 6 AND 7 - ROUND       59900019
*                                            CYLINDER INDICATOR         60000019
JFCBDQTY DS    CL3                          QUANTITY OF D.A. STORAGE    60100019
*                                            REQUIRED FOR A DIRECTORY   60200019
JFCBSPNM DS    CL3                          CORE ADDRESS OF THE JFCB    60300019
*                                            WITH WHICH CYLINDERS ARE   60400019
*                                            SPLIT                      60500019
JFCBABST DS    CL2                          RELATIVE ADDRESS OF FIRST   60600019
*                                            TRACK TO BE ALLOCATED      60700019
JFCBSBNM DS    CL3                          CORE ADDRESS OF THE JFCB    60800019
*                                            FROM WHICH SPACE IS TO BE  60900019
*                                            SUBALLOCATED               61000019
JFCBDRLH DS    CL3                          AVERAGE DATA RECORD LENGTH  61100019
JFCBVLCT DS    CL1                          VOLUME COUNT                61200019
JFCBSPTN DS    CL1                          NUMBER OF TRACKS PER        61300019
*                                            CYLINDER TO BE USED BY     61400019
*                                            THIS DATA SET WHEN SPLIT   61500019
*                                            CYLINDER IS INDICATED      61600019
JFCBLGTH EQU   176                          LENGTH OF JFCB              61700019
JFCBEND  EQU   *                                                        61800019
*                                                                       61900019
         ORG   RSBUFSEG+176             ORG BACK TO BUFFER SEGMENT      62000019
RSSTATUS DS    0CL8                                                     62100019
RSSTAT1  DS    CL1                      STATUS BYTE 1                   62200019
RSSTAT2  DS    CL1                      STATUS BYTE 2                   62300019
RSSTAT3  DS    CL1                      STATUS BYTE 3                   62400019
RSSTAT4  DS    CL1                      STATUS BYTE 4                   62500019
         DS    F                        RESERVED FOR FUTURE USE         62600019
         EJECT                                                          62700019
         CVT   DSECT=YES,PREFIX=YES,LIST=YES                     Y02076 62750002
         EJECT                                                          63000019
*                                                                       63100019
*                                                                       63200019
*   TASK CONTROL BLOCK                                                  63300019
*                                                                       63400019
*                                                                       63500019
         CNOP  0,4                                                      63600019
TCB      DSECT                                                          63700019
TCBRBP   DS    F                       POINTER TO EXECUTING RB          63800019
TCBPIE   DS    F                       POINTER TO PROG. INTERRUPT EL.   63900019
TCBDEB   DS    F                       POINTER TO DEB QUEUE             64000019
TCBTIO   DS    F                       POINTER TO TIOT                  64100019
TCBCMP   DS    F                       TASK COMPLETION CODE             64200019
TCBTRN   DS    F                       TESTRAN FIELD                    64300019
TCBMSS   DS    F                       DATA BLOCK QUEUE ELEMENT POINTER 64400019
TCBPRTK  DS    CL1                     PROTECTION TAG                   64500019
TCBFLGS  DS    FL5                     FLAG BYTES                       64600019
TCBLMP   DS    CL1                     LIMIT PRIORITY                   64700019
TCBDSP   DS    CL1                     DISPATCHING PRIORITY             64800019
TCBLLS   DS    F                       POINTER TO LOAD LIST             64900019
TCBJLB   DS    F                       POINTER TO JOBLIB DCB            65000019
TCBJSE   DS    F                       LIST OF INACTIVE PROGRAMS ADDR.  65100019
TCBGRS   DS    CL64                    GENERAL REGISTER SAVE AREA       65200019
TCBIDF   DS    CL1                     TCB IDENTIFIER FIELD             65300019
TCBFSA   DS    CL3                     POINTER TO 1ST PROB.PROG.SAVEAR  65400019
TCBTCB   DS    F                       NEXT TCB ON READY QUEUE POINTER  65500019
TCBTME   DS    F                       POINTER TO TIMER ELEMENT         65600019
         EJECT                                                          65700019
         DCBD  DSORG=PS                                                 65800019
         EJECT                                                          65900019
*                                                                       66000019
*                                                                       66100019
*   DATA EXTENT BLOCK                                                   66200002
*                                                                       66300019
         IEZDEB                                                  Y02076 66350002
         EJECT                                                          70300019
         IHJDSTAB                                                Y02076 70350002
         EJECT                                                          74400019
TIOT     DSECT                                                          74500019
         IEFTIOT1                                                       74600019
         EJECT                                                          74700019
SRT      DSECT                                                          74800019
         IEFUCBOB                                                       74900019
         IHADSAB                                                        74950002
*                                                                       75000019
*                                                                       75100019
*                                                                       75200019
         END                                                            75300019
