         TITLE 'IGC0I05B  JFCB PROCESSOR - TABLE COMPLETION MODULE     *00100018
                      REPOSITION I/O  RESTART-SVC 52  OS/360'           00200018
IGC0I05B CSECT                                                          00300018
*              OS                                                       00350002
*          RELEASE 18 DELETIONS                                         00400018
*          RELEASE 19 DELETIONS                                         00500018
*                                                                  O100 00530019
* 173000                                                         A27816 00560019
*          RELEASE 20 DELETIONS                                         00600018
*          RELEASE 21 DELETIONS                                         00700018
*0790                                                            A44121 00750021
*                                                                       00800002
*              OS/VS2                                                   00850002
*                                                                       00900002
*          RELEASE 2 DELETIONS                                          01050002
*0000203000                                                     YA03686 01100002
* APAR OZ31486 HAS BEEN FLAGGED AS @ZSUT222                    @ZSUT222 01150037
*C150840,269000                                                @ZSUT222 01180037
*A269200-269600,337530                                         @ZSUT222 01210037
* STATUS CHANGE LEVEL 004                                               01300021
*                                                                       01400018
*TITLE -       TABLE COMPLETION MODULE                                  01500018
*                                                                       01600018
*STATUS -      INITIAL CODE                                             01700018
*                                                                       01800018
*FUNCTION -    CONTROL IS PASSED FROM IGC0G05B IN ORDER TO COMPLETE THE 01900018
*              TABLE ENTRIES FOR ALL DATA SETS WITH PHYSICAL SEQUENTIAL 02000018
*              ORGANIZATION WHICH ARE COMPOSED OF MORE THAN 5 VOLS.     02100018
*                                                                       02200018
*              TESTS ARE MADE ON EACH TABLE ENTRY FOR DSORG = PS WITH   02300018
*              VOL SEQ NO GREATER THAN 5.  IF THESE CONDITIONS EXIST    02400018
*              ONE OR MORE JFCB EXTENSIONS ARE READ AND THE CORRECT     02500018
*              VOLID IS MOVED TO THE APPROPRIATE POSITION IN THE TABLE  02600018
*              ENTRY.  TABLE ENTRIES SPECIFYING DSORG OTHER THAN PS,    02700002
*              GREATER THAN 5 VOLS ARE SKIPPED.                         02800018
*                                                                       02900018
*              IF AN ERROR CONDITION IS ENCOUNTERED AN ERROR CODE IS    03000018
*              SET IN THE RESTART WORKAREA AND CONTROL IS PASSED TO     03100018
*              IGC0V05B, OTHERWISE CONTROL IS PASSED TO IGC0K05B OR TO  03200018
*              IGC0H05B, DEPENDING UPON THE DEVICE TYPES OF THE DATA    03300002
*              SETS ENCOUNTERED IN THE TABLE.                           03400018
*                                                                       03500018
*ENTRY POINTS- THIS MODULE IS ENTERED BY IGC0G05B.                      03550002
*                                                                       03560002
*INPUT -       REGISTER  1    ADDR OF RESTART WORKAREA (RSTWA DSECT)    03600018
*              REGISTER  8    ADDR OF FIRST TABLE ENTRY                 03700018
*                                                                       03800018
*OUTPUT -      SAME AS REGISTER 1 AND 8 ABOVE                           03900018
*                                                                       04000018
*EXIT -        TO IGC0K05B IF A NON-DA DATA SET IS ENCOUNTERED          04100018
*              TO IGC0H05B IF ALL DATA SETS ARE DA RESIDENT             04200002
*              TO IGC0V05B IF AN ERROR CONDITION IS ENCOUNTERED:        04300037
*              025 - ERROR DURING READ JFCB                             04330037
*                                                                       04400018
*TABLES/WORKAREAS                                                       04500018
*                                                                       04600018
*********************************************************************** 04700018
*                                                                     * 04800018
*    THE FOLLOWING IS A DESCRIPTION OF THE 48 BYTE TABLE ENTRY THAT   * 04900018
*    IS USED IN THE RESTART PORTION OF CHECKPOINT/RESTART.  EACH      * 05000018
*    ENTRY IN THE TABLE (ONE FOR EACH OPEN DATA SET AT CHECKPOINT)    * 05100018
*    IS 48 BYTES LONG.                                                * 05200018
*                                                                     * 05300018
*********************************************************************** 05400018
*                                                                       05500018
*        ------------------- 4 BYTES -----------------                  05600018
*                                                                       05700018
*      0 +++++++++++++++++++++++++++++++++++++++++++++                  05800018
*        +DATA SET  +           DCB                  +                  05900018
*        + ORGN.    +         ADDRESS                +                  06000018
*        +++++++++++++++++++++++++++++++++++++++++++++ 4                06100018
*        +FLAG BYTE +    WORKAREA SEGMENT            +                  06200018
*        + NO. 1    +         ADDRESS                +                  06300018
*      8 +++++++++++++++++++++++++++++++++++++++++++++                  06400018
*        +NUMBER    +         JFCB TTR               +                  06500018
*        + OF VOLS  +         ADDRESS                +                  06600018
*        +++++++++++++++++++++++++++++++++++++++++++++ 12               06700018
*                                                                       06800018
*     12 +++++++++++++++++++++++                                        06900018
*        +TAPE LABL + FILE SEQ +        DEVICE = TAPE                   07000018
*        +INFO BYTE + NUMBER   +                                        07100018
*        +++++++++++++++++++++++                                        07200018
*                                                                       07300018
*     12 +++++++++++++++++++++++                                        07400018
*        +    OLD   TIOT       +        DA AND UNIT RECORD              07500018
*        +      OFFSET         +                                        07600018
*        +++++++++++++++++++++++                                        07700018
*                                                                       07800018
*                              +++++++++++++++++++++++                  07900018
*                              +FLAG BYTE +FLAG BYTE +                  08000018
*                              +  NO. 2   +  NO. 3   +                  08100018
*     16 +++++++++++++++++++++++++++++++++++++++++++++                  08200018
*        +FLAG BYTE +FLAG BYTE +                     +                  08300018
*        + NO. 4    + NO. 5    +   VOLUME ID NO. 1   +                  08400018
*        +++++++++++++++++++++++                     + 20               08500018
*        +                                           +                  08600018
*        +                                           +                  08700018
*     24 +++++++++++++++++++++++++++++++++++++++++++++                  08800018
*        +                                           +                  08900018
*        +   VOLUME ID NO. 2                         +                  09000018
*        +                     +++++++++++++++++++++++ 28               09100018
*        +                     +                     +                  09200018
*        +                     +   VOLUME ID NO. 3   +                  09300018
*     32 +++++++++++++++++++++++                     +                  09400018
*        +                                           +                  09500018
*        +                                           +                  09600018
*        +++++++++++++++++++++++++++++++++++++++++++++ 36               09700018
*        +                                           +                  09800018
*        +   VOLUME ID NO. 4                         +                  09900018
*     40 +                     +++++++++++++++++++++++                  10000018
*        +                     +                     +                  10100018
*        +                     +                     +                  10200018
*        +++++++++++++++++++++++   VOLUME ID NO. 5   + 44               10300018
*        +                                           +                  10400018
*        +                                           +                  10500018
*        +++++++++++++++++++++++++++++++++++++++++++++ 48               10600018
*                                                                       10700018
*                                                                       10800018
*           A  DCBTABLE,                                                10900018
*                                                                       11000018
*           B  BUFFER AREA,                                             11100018
*                                                                       11200018
*           C  SEE DSECTS AT END OF LISTING.                            11300018
*                                                                       11400018
*ATTRIBUTES                                                             11500018
*                                                                       11600018
*          A RE-ENTRANT                                                 11700018
*          B RE-USABLE                                                  11800018
*          C ENABLED                                                    11900018
*          D PRIVILEGED                                                 12000002
*                                                                       12100018
*********************************************************************   12200018
*                                                                       12300018
*    REGISTER CONVENTION TO BE USED THRU-OUT REPI/O PHASE               12400018
*                                                                       12500018
*********************************************************************** 12600018
*                                                                       12700018
WRKR1    EQU   0                        WDRK/PARAMETER REGISTER         12800018
WRKR2    EQU   1                        WDRK/PARAMETER REGISTER         12900018
DCBR     EQU   2                        CURRENT DCB REGISTER            13000018
BASER    EQU   3                        BASE REGISTER                   13100018
DEBR     EQU   4                        CURRENT DEB REGISTER            13200018
UCBR     EQU   5                        CURRENT UCB REGISTER            13300018
TIOTR    EQU   6                        NEW TIOT REGISTER               13400018
TCBR     EQU   7                        TCB REGISTER                    13500018
TABLR    EQU   8                        BEGINNING TO DCB TABLE REG      13600018
CTABLR   EQU   9                        CURRENT ENTRY IN DCB TABLE      13700018
BUFR     EQU   10                       USER BUFFER AREA                13800018
DSCNTR   EQU   11                       WORK REGISTER                   13900018
WRKR3    EQU   12                       WORK REGISTER                   14000018
WRKR4    EQU   13                       WORK REGISTER                   14100018
WRKR5    EQU   14                       WORK/PARAMETER REGISTER         14200018
WRKR6    EQU   15                       WORK/PARAMETER REGISTER         14300018
*                                                                       14400018
*********************************************************************** 14500018
*                                                                       14600018
*    OFFSETS TO BE USED IN REPI/O PHASE                                 14700018
*                                                                       14800018
*********************************************************************** 14900018
*                                                                       15000018
IS       EQU   X'80'                    INDEXED SEQUENCIAL              15002018
PS       EQU   X'40'                    PHYSICAL SEQUENCIAL             15004018
DA       EQU   X'20'                    DIRECT ACCESS                   15006018
PO       EQU   X'02'                    PARTITIONED ORGANIZATION        15008018
INOROUT  EQU   X'40'                    SYSIN OR SYSOUT DATA SET        15012018
TPDEV    EQU   X'10'                    TAPE DEVICE                     15016018
UNITREC  EQU   X'04'                    UNIT RECORD EQUIPMENT           15020018
ERRINNSL EQU   X'80'                    ERROR IN NSL ROUTINE            15022018
NSLMTSW  EQU   X'40'                    NSL MOUNT SWITCH                15024018
NSLCOMU  EQU   X'20'                    NSL COMMUNICATION BIT           15026018
BYPASS   EQU   X'10'                    BYPASS LABEL PROCESSING         15028018
NSL      EQU   X'04'                    NON-STANDARD LABEL              15030018
SL       EQU   X'02'                    STANDARD LABEL                  15032018
NL       EQU   X'01'                    NO LABEL                        15034018
POCONCAT EQU   X'40'                    P.O. CONCATENATED               15038018
DAFLAG   EQU   X'80'                    DA DATA SET FLAG                15040018
NONDAFLG EQU   X'40'                    NON-DA DATA SET FLAG            15042018
NSLFLAG  EQU   X'10'                    NSL ROUTINE FLAG                15044018
TYPERST  EQU   X'80'                    IMMEDIATE RESTART               15046018
TABENT   EQU   48                       TABLE ENTRY LENGTH              15048018
WRITE    EQU   X'01'                    WRITE ON TAPE                   15050018
READ     EQU   X'02'                    READ FOR TAPE                   15052018
NOPOP    EQU   X'03'                    NOP                             15054018
SENSE    EQU   X'04'                    SENSE                           15056018
REWIND   EQU   X'07'                    REWIND                          15058018
READBACK EQU   X'0C'                    READBACK                        15060018
UNLOAD   EQU   X'0F'                    REWIND AND UNLOAD               15062018
WTM      EQU   X'1F'                    WRITE TAPE MARK                 15064018
BSFOP    EQU   X'2F'                    BACKWARD SPACE FILE             15066018
FSFOP    EQU   X'3F'                    FORWARD SPACE FILE              15068018
SEARCH   EQU   X'31'                    SEARCH                          15070018
SRCHCNT  EQU   X'05'                    COUNT FOR SEARCH ID             15072018
TIC      EQU   X'08'                    TIC                             15074018
READDA   EQU   X'06'                    READ FOR DA                     15076018
LENJFCB  EQU   X'B0'                    LENGTH OF JFCB                  15078018
LBLLEN   EQU   X'50'                    LENGTH OF LABEL                 15080018
PERMERR  EQU   X'7F'                    PERMANENT ERROR                 15082018
ERR025   EQU   25                       ERROR IN READING JFCB  @ZSUT222 15084037
BUFSEG   EQU   304                                                      15100018
TIOTBASE EQU   24                                                       15300018
TTROFFST EQU   12                                                       15400018
BUSY     EQU   X'80'                                                    15500018
ISORDA   EQU   IS+DA                    IS OR DA                        15560018
IOERROR  EQU   X'20'                    PERMANENT I/O ERROR             15620018
NODIOERR EQU   X'3F'                                                    15660018
PCI      EQU   X'04'                    CHAINED SCHEDULING       A27816 15666019
COMPWOE  EQU   X'7F'                    COMPLETE NO ERROR        A27816 15672019
NULLDFLG EQU   X'20'                                               O100 15680019
D24      EQU   24                       CONSTANT TWENTY FOUR     Y02076 15690002
DEBPAGFX EQU   X'10'                    DEB PAGE FIXED INDR      YM7340 15692002
*                                                                       15700018
*********************************************************************** 15800018
*                                                                       15900018
         BALR  BASER,0                  ESTABLISH ADDRESSABILITY        16000018
         USING *,BASER                  ESTABLISH BASE REGISTER         16100018
         B     BEGIN               BRANCH AROUND EYE CATCHER     Y01909 16150000
         CNOP  0,8                 ALIGN TO A DBL WORD BOUNDARY  Y01909 16160000
         DC    CL8'IGC0I05B'       MODULE NAME                 @ZSUT222 16170037
         DC    CL8'&SYSDATE'       LAST DATE SHIPPED           @ZSUT222 16172037
         DC    CL8'@ZSUT222'       LAST CODE SHIPPED           @ZSUT222 16174037
BEGIN    EQU   *                                                 Y01909 16180000
*                                                                       16200018
         USING IHADCB,DCBR                                              16300018
         USING UCBOB,UCBR                                               16400018
         USING RSDSECT,WRKR4                                            16500018
         USING TIOENTRY,WRKR5                                           16600018
         USING CVT,WRKR2                                                16700018
         USING DEBBASIC,DEBR                                     Y02076 16750002
         USING TCB,TCBR                                                 16900018
         USING TABL,CTABLR                                              17000018
         USING RSTWA,BUFR                                               17100018
*                                                                       17200018
         L     DCBR,RSCKDCB        LOAD ADDR OF CHKPT DCB               17230018
         NI    DCBIFLGS,NODIOERR   TURN OFF POSSIBLE ERROR FLAGS        17260018
         TM    DCBCIND2,PCI             CHAINED SCHEDULING       A27816 17268019
         BNO   REPTAB                   NO, BRANCH               A27816 17276019
         L     WRKR4,DCBIOBAD           GET IOB PREFIX ADDR      A27816 17284019
         MVI   4(WRKR4),COMPWOE         POST MAIN IOB COMPLETE   A27816 17292019
REPTAB   LR    CTABLR,TABLR             INITIALIZE CTABLR        A27816 17342019
*********************************************************************** 17392002
*   GET SPACE FOR QMNGRIO PARAMETER LIST AND WORK AREA THEN INITIALIZE  17394002
*   IT.  QMNGRIO IS USED FOR READING IN THE JFCB EXTENTION FROM THE   * 17396002
*   SCHEDULER WORK AREA (SWA) FOR DATA SETS HAVING GREATER THAN 5 VOL * 17398002
*********************************************************************** 17398402
         ICM   WRKR1,ADDRBYTS,QMNGWALN  LENGTH OF QMNGR P.L.+WA  Y02076 17398802
         ICM   WRKR1,HIORDER,SP253      SUBPOOL 253              Y02076 17399202
         GETMAIN  R,LV=(0)              ISSUE GETMAIN            Y02076 17399602
         USING QMIOP,WRKR2              REG 1 PTS TO QMNGR P.L.  Y02076 17399702
         XC    QMITCBAD(D24),QMITCBAD   CLEAR PARM LIST          Y02076 17399902
         LA    WRKR1,QMWAOFST           GET OFFSET TO WA         Y02076 17433202
         AR    WRKR1,WRKR2              CALC ADR OF WORK AREA    Y02076 17443202
         ST    WRKR1,QMIWRKAD           STORE IN PARM LIST       Y02076 17453202
         L     TCBR,RSTCBAD             GET TCB ADR              Y02076 17463202
         ST    TCBR,QMITCBAD            STORE TCB AD IN P.L.     Y02076 17465202
         LA    WRKR1,JFCBXLNT           GET JFCB XTN LENGTH      Y02076 17465602
         STH   WRKR1,QMIRECL            STORE RECORD LNGTH IN PL.Y02076 17466002
         MVI   QMIFLAGS,QMIOREAD        SET READ FUNCTION        Y02076 17466502
         ST    WRKR2,QMNPRMWA           SAVE QMNGRIO P.L. ADR    Y02076 17466602
         B     REPDCB22                 BRANCH TO INITIALIZE PTRS       17466702
*                                                                       17500018
REPDCB20 EQU   *                                                        17600018
*                                                                       17700018
         LA    CTABLR,TABENT(CTABLR)    TO NEXT ENTRY                   17800018
*                                                                       17900018
REPDCB22 EQU   *                                                        18000018
*                                                                       18100018
         L     DCBR,TABDCBAD-1          GET DCB ADDR                    18200018
         L     DEBR,DCBDEBAD            GET DEB ADDR                    18300018
*****************************************************************YM7003 18350002
*        RESET THE DEBRRQ FIELD FOR ALL DATA SETS EXCEPT         YM7003 18360002
*        VSAM, TCAM, AND SUBSYSTEM.  THIS IS NECESSARY SINCE     YM7003 18370002
*        THE RELATED REQUEST QUEUE ADDRESS WILL BE INVALID       YM7003 18380002
*        AFTER A RESTART.  NOTE- VSAM DATA SETS DO NOT HAVE      YM7003 18390002
*        A TABLE ENTRY AND, THEREFORE, WILL BE AUTOMATICALLY     YM7003 18392002
*        EXCLUDED.                                               YM7003 18394002
*****************************************************************YM7003 18398002
         TM    TABFLG1,TABTCAM+TABSYS   D/S TCAM OR SUBSYSTEM    YM7003 18398402
         BNZ   REPDCB23                 IF YES, SKIP DEBRRQ ZERO YM7003 18398802
         TM    TABFLG2,TABOSSDS         WAS IT AN OLD SUBSYS     YM7399 18399202
         BO    REPDCB23                 IF YES, SKIP DEBRRQ ZERO YM7399 18399302
         XC    DEBRRQ+1(3),DEBRRQ+1     ZERO DEBRRQ              YM7003 18399602
REPDCB23 EQU   *                        SKIP DEBRRQ ZERO ENTRY   YM7003 18399702
         LR    WRKR4,DEBR               GET DEB ADDRESS          YM7340 18399802
         SH    WRKR4,AVTOFSET           PT AVT IF PART OF DEB    YM7340 18399902
         CLM   WRKR4,B'0111',DEBAPPB    IS AVT IN DEB PREFIX     YM7340 18433202
         BNE   NOAVT                    BR IF AVT NOT IN DEB     YM7340 18443202
         NI    DEBSIOAB-DEBAVT(WRKR4),X'FF'-DEBPAGFX RESET DEB   YM7340*18453202
                                        PAGE FIXED - EXCP WILL   YM7340*18463202
                                        RE-FIX ON 1ST EXCP       YM7340 18465202
NOAVT    EQU   *                        AVT NOT PART OF DEB      YM7340 18465602
         L     WRKR4,TABSEGAD-1         GET CURRENT WORK SEG            18466702
         SR    UCBR,UCBR                CLEAR UCBR                      18500018
*                                                                       18600018
         TM    TABFLG2,TABG5V           NO. VOLS. GREATER THAN 5        18700002
         BZ    REPDCB24                 NO - BRANCH                     18800018
*                                                                       18900018
******** THE NUMBER OF VOLS IS GREATER THAN 5                           19000018
*                                                                       19100018
         TM    TABDSORG,ISORDA          DSORG SET FOR IS OR DA          19200018
         BZ    REPDCB30                 NO BRANCH                       19300018
*                                                                       19400018
REPDCB24 EQU   *                                                        19500018
*                                                                       19600018
         TM    TABFLG1,TABLAST          LAST ENTRY IN TABLE             19700002
         BO    ENDUP                    YES BRANCH                      19800018
         B     REPDCB20                 RE LOOP                         19900018
*                                                                     * 20000018
REPDCB30 EQU   *                                                        20100018
*                                                                     * 20200018
         SR    WRKR6,WRKR6              ZERO WORK REG           SA65157 20250002
         IC    WRKR6,DEBNMEXT           GET NO. OF EXTENTS      SA65157 20260002
         SLL   WRKR6,4                  MULTIPLY BY 16          SA65157 20270002
         LA    WRKR6,DEBBASND(WRKR6)    GET ADR ACC METH SECT   SA65157 20280002
         USING DEBACSMD,WRKR6                                   SA65157 20290002
         SR    WRKR5,WRKR5              ZERO OUT REGISTER       YA03686 20292002
         IC    WRKR5,DEBVOLSQ+1         GET CURR VOL. SEQ. NO.  YA03686 20300002
         L     DEBR,DCBDEBAD            GET DEB BASIC ADR        Y02076 20350002
         USING DEBBASIC,DEBR                                     Y02076 20360002
         TM    TABFLG1,TABDA            DA DEVICE                       20400002
         BO    REPDCB32                 YES BRANCH                      20500018
*                                                                       20600018
         LH    WRKR5,TABVLID5           GET CURR VOL. SEQ. NO.          20700018
*                                                                       20800018
REPDCB32 EQU   *                                                        20900018
*                                                                       21000018
         BCTR  WRKR5,0                  SUB 1 FROM VOLUME SEQ NUMBER    21100018
*                                                                       21200018
REPDCB34 EQU   *                                                        21300018
*                                                                     * 21400018
         LA    WRKR1,5                  LOAD WITH FIVE                  21500018
         LA    WRKR2,15                 LOAD WITH FIFTEEN               21600018
*                                                                     * 21700018
         LA    UCBR,1(UCBR)             BUMP XTN COUNTER BY ONE         21800018
         SR    WRKR5,WRKR1              SUB 5 FROM VOLSEQNO(OR DIFF)    21900018
         LTR   WRKR5,WRKR5              TEST WRKR5                      22000018
         BC    12,REPDCB38              BRANCH LOW OR EQUAL  TO ZERO    22100018
*                                                                     * 22200018
REPDCB36 EQU   *                                                        22300018
*                                                                       22400018
         CR    WRKR5,WRKR2              COMPARE RESULT TO 15            22500018
         BL    REPDCB38                 LOW BRANCH SERIAL IN THIS EXT   22600018
*                                                                       22700018
         SR    WRKR5,WRKR2              SUB 15 FROM VOLSEQNO(OR DIFF)   22800018
         LA    UCBR,1(UCBR)             BUMP EXTENSION COUNTER BY ONE   22900018
         B     REPDCB36                 BRANCH TO COUNT NO. OF EXT.     23000018
*                                                                       23100018
REPDCB38 EQU   *                                                        23200018
*                                                                       23300018
         LPR   WRKR5,WRKR5              GET A POSITIVE VALUE IN WRKR5   23400018
         MH    WRKR5,SIX                MULTIPLY RESULT VOLSEQNO BY 6   23500018
*                                                                     * 23600018
*    *** NOW READ THE REQUIRED XTN'S AND MOVE PROPER VOL ID TO TABL   * 23700018
*                                                                     * 23800018
         L     WRKR1,TABNVOLS           LOAD 1ST XTN TTR                23900018
         SLL   WRKR1,8                  SHIFT TTR LEFT 8 BITS           24000018
*                                                                       24100018
REPDCB40 EQU   *                                                        24200018
*                                                                       24300018
         L     WRKR2,QMNPRMWA           GET ADR OF QMNGR P.L.    Y02076 24350002
         ST    WRKR1,QMIDSKAD           STORE TTR IN P.L.        Y02076 24400002
         LA    WRKR1,RSJFCB             GET JFCBX READ IN ADR    Y02076 24450002
         ST    WRKR1,QMIRECAD           ADR TO READ IN JFCBX     Y02076 24500002
         STM   WRKR4,WRKR5,RSERAS01     SAVE REGS ACROSS QMNGRIO YM6508 24510002
         LA    WRKR4,RSREGSAV           POINT TO SAVE AREA       YM6508 24520002
         QMNGRIO                        READ JFCBX               Y02076 24550002
         LM    WRKR4,WRKR5,RSERAS01     RESTORE REGISTERS        YM6508 24560002
         LTR   WRKR6,WRKR6              TEST RETURN CODE         Y02076 24600002
         BZ    REPDCB42                 BRANCH IF NO ERROR       Y02076 24650002
         MVI   RSRETCOD+1,ERR025        SET JFCB READ ERROR    @ZSUT222 26900037
         MVC   RSREGSAV(8),MODID        SAVE NAME OF MODULE    @ZSUT222 26920037
*                                       THAT DETECTED ERROR    @ZSUT222 26940037
         STM   0,15,RSREGSAV+8          SAVE CURRENT REGISTERS @ZSUT222 26960037
         B     ERRORRTN                 BRANCH TO ERROR ROUTINE         27000018
*                                                                       27100018
REPDCB42 EQU   *                                                        27200018
*                                                                     * 27300018
*    *** GET THE CORRECT VOLID FROM JFCB XTN AND PLACE IT IN TABLE    * 27400018
*                                                                     * 27500018
         L     WRKR1,RSJFCB             PICK UP NEXT XTN TTR            27600018
         IC    WRKR1,ZERO     CLEAR LOW BYTE OF TTR              A44121 27650021
         BCT   UCBR,REPDCB40            BR IF MORE XTN'S TO BE READ     27700018
*                                                                       27800018
         LA    WRKR5,RSJFCB+4(WRKR5)    LOAD ADDR OF VOLID              27900018
         MVC   TABVLID1(6),0(WRKR5)     MOVE VOLID TO TABL ENTRY        28000018
*                                                                     * 28100018
         B     REPDCB24                 BRANCH TO TEST FOR LAST ENTRY   28200018
*                                                                       28300018
ENDUP    EQU   *                                                        28400018
*                                                                       28500018
         LR    CTABLR,TABLR             INIT REG                        28600018
*                                                                       28700018
ENDUP0   EQU   *                                                        28800018
*                                                                       28900018
         TM    TABFLG1,TABNULL     DUMMY DATA SET                  O100 28920002
         BZ    ENDUP0A             BRANCH IF NO                    O100 28940019
         OI    RSDCBFLG,NULLDFLG   INDICATE GO TO DUMJY ROUTINE    O100 28960019
ENDUP0A  EQU   *                                                   O100 28980019
         TM    TABFLG1,TABDA            DA DEVICE                       29000002
         BO    ENDUP1                   YES BRANCH                      29100018
*                                                                       29200018
         OI    RSDCBFLG,NONDAFLG        SET NON DA FLAG                 29300018
         B     ENDUP2                   BRANCH TO TEST FOR LAST ENTRY   29400018
*                                                                       29500018
ENDUP1   EQU   *                                                        29600018
*                                                                       29700018
         OI    RSDCBFLG,DAFLAG          SET DA FLAG                     29800018
*                                                                       29900018
ENDUP2   EQU   *                                                        30000018
*                                                                       30100018
         TM    TABFLG1,TABLAST          LAST ENTRY                      30200002
         BO    ENDUP3                   YES BRANCH                      30300018
*                                                                       30400018
         LA    CTABLR,TABENT(CTABLR)    TO NEXT ENTRY                   30500018
*                                                                       30600018
         B     ENDUP0                   BRANCH TO CHECK IF DA EXISTS    30700018
*                                                                       30800018
ERRORRTN EQU   *                                                        30900018
*                                                                       31000018
         L     WRKR4,4(TABLR)           INITIALIZE TO 1ST WORKAREA      31100018
         MVC   RSJFCB(8),ERORLOAD       MOVE IN ERROR MOD ID            31200018
         B     ENDUP4                   BRANCH TO GET FLSQ FOR SYSOUT   31300018
*                                                                     * 31400018
ENDUP3   EQU   *                                                        31500018
*                                                                       31600018
         TM    RSDCBFLG,NULLDFLG   WAS DUMMY DATA SET FOUND        O100 31610019
         BZ    ENDUP3A             BRANCH IF NO                    O100 31620019
         MVC   RSJFCB(8),DUMYLOAD  SET DUMMY MODULE ID             O100 31630019
         B     ENDUP4              DONT SET TAPE ID                O100 31640019
ENDUP3A  EQU   *                                                   O100 31650019
         L     WRKR4,4(TABLR)           INITIALIZE TO 1ST WORK AREA     31700018
         MVC   RSJFCB(8),TAPELOAD       MOVE IN TAPE LOAD ID            31800018
         TM    RSDCBFLG,NONDAFLG        IS NON DA FLAG ON               31900018
         BO    ENDUP4                   YES BRANCH                      32000018
*                                                                       32100018
         MVC   RSJFCB(8),DALOAD         MOVE IN DA LOAD ID              32200018
*                                                                       32300018
ENDUP4   EQU   *                                                        32400018
         ICM   WRKR1,ADDRBYTS,QMNGWALN  FREE THE QMNGRIO         Y02076 32450002
         ICM   WRKR1,HIORDER,SP253         PARM LIST + WORK AREA Y02076 32500002
         L     WRKR2,QMNPRMWA           GET ADR OF PARM LIST     Y02076 32550002
         FREEMAIN  R,LV=(0),A=(1)       ISSUE FREEMAIN           Y02076 32560002
         LA    WRKR6,RSJFCB+8           SETUP FOR XCTL                  32600018
*********************************************************************   32700018
         LR    WRKR2,BUFR               POINT REG 1 TO THE RESTART W/A  32800018
         XC    RSERAS00,RSERAS00        CLEAR SCRATCH AREA       Y02076 32850002
*********************************************************************   32900018
         XCTL  EPLOC=RSJFCB,SF=(E,(15))                                 33000018
*                                                                       33100018
*     CONSTANTS USED IN REPI/O                                          33200018
*                                                                       33300018
AVTOFSET DC    H'36'                    OFFSET FROM DEB TO AVT   YM7340 33350002
SIX      DC    H'6'                     OFFSET FOR VOL SEQ NO           33400018
ERORLOAD DC    CL8'IGC0V05B'            RESTART EXIT MODULE             33500018
TAPELOAD DC    CL8'IGC0K05B'            NON-DA MOUNT/VERIFICATION LOAD  33600018
DALOAD   DC    CL8'IGC0M05B'            DA MOUNT/VERIFICATION LOAD      33700018
DUMYLOAD DC    CL8'IGC0H05B'            DUMMY PROCESSOR            O100 33750037
MODID    DC    CL8'IGC0I05B'            MODULE IDENT.          @ZSUT222 33753037
QMNGWALN DC    AL3(280)                 24(P.L.) + 256(W.A.)     Y02076 33760002
SP253    DC    AL1(253)                 SUBPOOL 253              Y02076 33770002
ADDRBYTS EQU   7                        GETMAIN PARAMETERS       Y02076 33780002
HIORDER  EQU   8                        HIGH ORDER BYTE          Y02076 33790002
QMWAOFST EQU   24                       OFFSET TO QMNGR WA       Y02076 33792002
JFCBXLNT EQU   176                      LENGTH OF JFCB XTN       Y02076 33794002
*                                                                       33800018
*     CHANNEL PROGRAM USED BY REPI/O                                    33900018
*                                                                       34000018
         DS    0D                                                       34100018
CCWLIST  DC    X'3100000040000005'      SEARCH                          34200018
         DC    X'08'                    TIC                             34300018
ZERO     DC    X'00000000000000'        ZEROS                           34400018
         DC    X'06000000000000B0'      READ                            34500018
*                                                                     * 34550000
*        MAINTENANCE SPACE                                       Y01909 34560000
*                                                                     * 34570000
PATCH    DC    XL((*-IGC0I05B)/20)'00'   FIVE PERCENT SPACE      Y01909 34580000
*                                                                     * 34590000
         IEFQMIOP                                                Y02076 34592002
         IEFJESCT                                                Y02076 34594002
         EJECT                                                          34600018
         IEEVRSWA VER=3                 USE AOS2 VERSION OF WA          34750000
QMNPRMWA EQU   RSERAS00                 ADR QMNGRIO PARMS        Y02076 34760002
         EJECT                                                          34800018
RSDSECT  DSECT                                                          34900018
*                                                                       35000018
*    DATA EXTENT BLOCK                                                  35100018
*                                                                       35200018
RSDEB    DS    0CL48                                                    35300018
RSDEBTCB DC    X'00000000'              TCB ADDRESS                     35400018
RSDEBDEB DC    X'00000000'              DEB ADDRESS                     35500018
*                                                                       35600018
*    DATA CONTROL BLOCK                                                 35700018
*                                                                       35800018
RSDEBOFL DS    0CL1                                                     35900018
RSDEBIRB DC    X'00000000'              IRB ADDRESS                     36000018
RSDEBSYS DC    X'00000000'              1ST IOB ADDR IN SYS.PURGE CHAIN 36100018
RSDEBUSR DC    X'00000000'              1ST IOB ADDR IN USER PRGE CHAIN 36200018
RSDEBECB DC    X'00000000'              PARM.LIST ADDR TO PURGE ECB     36300018
RSDEBID  DS    0CL1                                                     36400018
RSDEBDCB DC    AL4(RSDCBREP)            DCB ADDR                        36500018
RSDEBAPP DS    CL4                      I/O APPENDAGE VECTOR TABLE      36600018
RSDEBMOD DS    0CL1                                                     36700018
RSDEBUCB DS    F                        UCB ADDRESS                     36800018
RSDEBBIN DS    H                        BIN NUMBER                      36900018
RSDEBSCC DS    H                        CYLINDER START ADDRESS          37000018
RSDEBSHH DS    H                        TRACK START ADDRESS             37100018
RSDEBECC DS    H                        CYLINDER END ADDRESS            37200018
RSDEBEHH DS    H                        TRACK END ADDRESS               37300018
RSDEBNTR DS    H                        NO. OF TRACKS IN THIS EXTENT    37400018
*                                                                       37500018
*    EVENT CONTROL BLOCK                                                37600018
*                                                                       37700018
RSECBAD  DS    CL4                      ECB ADDRESS                     37800018
RSDCBDEB DC    AL4(RSDEB)               DEB ADDRESS                     37900018
*                                                                       38000018
RSDCBREP EQU   RSDEB+8                  POINT TO RELATIVE BEGINNING DCB 38100018
*                                                                       38200018
*    INPUT OUTPUT BLOCK                                                 38300018
*                                                                       38400018
RSIOB    DS    0CL40                                                    38500018
RSIOBFG1 DC    X'00'                    I/O FLAGS BYTE 1                38600018
RSIOBFG2 DC    X'00'                    I/O FLAGS BYTE 2                38700018
RSIOBSN1 DS    CL1                      FIRST SENSE BYTE                38800018
RSIOBSN2 DS    CL1                      SECOND SENSE BYTE               38900018
RSIOBECB DC    AL4(RSECBAD)             ECB ADDRESS                     39000018
RSIOBCSW DS    D                        LAST CSW                        39100018
RSIOBCPA DS    AL4(RSCCW1)              CHANNEL PROGRAM ADDRESS         39200018
RSIOBDCB DS    AL4(RSDCBREP)            DCB ADDRESS                     39300018
RSIOBRCP DS    CL4                      RESTART ADDRESS FOR IOS         39400018
RSIOBINC DS    H                        INCREMENT BLOCK COUNT           39500018
RSIOBECT DS    H                        NO. OF ERROR ENTRIES            39600018
RSIOBDAD DS    D                        SEEK ADDRESS FOR DA             39700018
*                                                                       39800018
*    CHANNEL PROGRAM                                                    39900018
*                                                                       40000018
RSCCWLST DS    0CL24                                                    40100018
RSCCW1   DS    D                        CCW1                            40200018
RSCCW2   DS    D                        CCW2                            40300018
RSCCW3   DS    D                        CCW3                            40400018
*                                                                       40500018
*    BUFFER SEGMENT FOR EXTERNAL BLOCKS                                 40600018
*                                                                       40700018
RSBUFSEG DS    0CL176                                                   40800018
RSJFCB   EQU   RSBUFSEG                                                 40900018
         IEFJFCBN                                                Y02076 40950002
         EJECT                                                          52400018
CVT      DSECT                                                          52500018
         CVT                                                            52600018
         EJECT                                                          52700018
*                                                                       52800018
*                                                                       52900018
*   TASK CONTROL BLOCK                                                  53000018
*                                                                       53100018
*                                                                       53200018
         CNOP  0,4                                                      53300018
TCB      DSECT                                                          53400018
TCBRBP   DS    F                       POINTER TO EXECUTING RB          53500018
TCBPIE   DS    F                       POINTER TO PROG. INTERRUPT EL.   53600018
TCBDEB   DS    F                       POINTER TO DEB QUEUE             53700018
TCBTIO   DS    F                       POINTER TO TIOT                  53800018
TCBCMP   DS    F                       TASK COMPLETION CODE             53900018
TCBTRN   DS    F                       TESTRAN FIELD                    54000018
TCBMSS   DS    F                       DATA BLOCK QUEUE ELEMENT POINTER 54100018
TCBPRTK  DS    CL1                     PROTECTION TAG                   54200018
TCBFLGS  DS    FL5                     FLAG BYTES                       54300018
TCBLMP   DS    CL1                     LIMIT PRIORITY                   54400018
TCBDSP   DS    CL1                     DISPATCHING PRIORITY             54500018
TCBLLS   DS    F                       POINTER TO LOAD LIST             54600018
TCBJLB   DS    F                       POINTER TO JOBLIB DCB            54700018
TCBJSE   DS    F                       LIST OF INACTIVE PROGRAMS ADDR.  54800018
TCBGRS   DS    CL64                    GENERAL REGISTER SAVE AREA       54900018
TCBIDF   DS    CL1                     TCB IDENTIFIER FIELD             55000018
TCBFSA   DS    CL3                     POINTER TO 1ST PROB.PROG.SAVEAR  55100018
TCBTCB   DS    F                       NEXT TCB ON READY QUEUE POINTER  55200018
TCBTME   DS    F                       POINTER TO TIMER ELEMENT         55300018
         EJECT                                                          55400018
         DCBD  DSORG=PS                                                 55500018
         EJECT                                                          55600018
         IEZDEB                                                  Y02076 55650002
         EJECT                                                          59600018
         IHJDSTAB                                                Y02076 59650002
         EJECT                                                          63700018
TIOT     DSECT                                                          63800018
         IEFTIOT1                                                       63900018
         EJECT                                                          64000018
SRT      DSECT                                                          64100018
         IEFUCBOB                                                       64200018
*                                                                       64300018
*                                                                       64400018
*                                                                       64500018
         END                                                            64600018
