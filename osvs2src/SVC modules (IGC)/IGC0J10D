         TITLE 'OP CTL INPUT HANDLER-II'                                00050010
IGC0J10D CSECT                                                          00100010
*C000000-999999                                                @Y17XAR0 00200010
*A331000                                                       @Y17XARX 00230010
*C330000                                                       @Y17XARX 00260010
*A131000,597000                                                @OY14521 00270010
*C514000                                                       @OY14521 00280010
*********************************************************************** 00300010
*                                                                     * 00400010
*                                                                     * 00500010
* MODULE NAME = IGC0J10D (TCAM,OPERATOR CONTROL)                        00600010
*                                                                     * 00700010
* DESCRIPTIVE-NAME=OPERATOR CONTROL INPUT HANDLER - PART II           * 00800010
*                                                                     * 00900010
* COPYRIGHT='NONE'                                                    * 01000010
*                                                                     * 01100010
* STATUS = VERSION 10.0                                                 01200010
*                                                                     * 01300010
*FUNCTION - THIS MODULE IS THE 2ND LOAD OF THE OPERATOR                 01400010
*           CONTROL INPUT HANDLER (IGC0010D).  THIS MODULE              01500010
*            PROCESSES ALL APPLICATION INPUT TO OPERATOR CONTROL.       01600010
*                                                                     * 01700010
* NOTES = COMMUNICATIONS BETWEEN THE VARIOUS TRANSIENT MODULES @Y17XARX 01800010
* IS PRIMARILY THROUGH THE OPERATOR CONTROL AVT.               @Y17XARX 01900010
*   DEPENDENCIES = NONE                                        @Y17XARX 02000010
*   RESTRICTIONS = NONE                                        @Y17XARX 02100010
*   REGISTER CONVENTIONS = OPERATOR CONTROL                    @Y17XARX 02200010
*   PATCH LABEL = ZAPAREA                                               02300010
*                                                              @Y17XARX 02400010
* MODULE TYPE = PROCEDURE                                      @Y17XARX 02500010
*   PROCESSOR = ASSEMBLER                                      @Y17XARX 02600010
*   MODULE SIZE = 2 K MAXIMUM                                  @Y17XARX 02650010
*   ATTRIBUTES = REUSABLE, REFRESHABLE, DISABLED,              @Y17XARX 02800010
*   TRANSIENT(TYPE 4), SUPERVISOR MODE                         @Y17XARX 02900010
*ENTRY POINTS - IGC0J10D IS THE ONLY ENTRY POINT FOR THE MODULE.      * 03000010
*                                                                     * 03100010
*INPUT - THE ONLY INPUT REQUIRED FOR THIS MODULE IS APPLICATION         03200010
*        PARAMETER LIST.                                                03300010
*                                                                     * 03400010
*OUTPUT - FUNCTION IS PERFORMED WHICH RESULTS IN SOME CASES             03500010
*      OF DATA BEING PASSED FROM MPP TO MCP.                            03600010
*                                                                     * 03700010
*EXTERNAL REFERENCES --  SVC 102(AQCTL), SVC 7(XCTL)                  * 03750010
*                                                                     * 03900010
*EXITS,NORMAL --XCTL TO SVC LOADS LISTED OR RETURN TO CALLER.    X02004 04000010
*                 IGCR010D,IGC0010D,IGC0A10D.                           04100010
*EXITS,ERROR --                                                         04200010
*        COMPLETION CODE - 4-INVALID TERMINAL NAME (QCOPY)       X02004 04300010
*                           -MCP NOT ACTIVE ( MCOUNT,TPDATE,CKREQX02004 04400010
*                           -CHECK POINT NOT VALID  (CKREQ)      X02004 04500010
*                           -QRESET UNABLE TO FIND ONE ONE OR    X02004 04600010
*                            MORE OF THE REQUESTED SEQUENCE NO.  X02004 04700010
*                            REG 2 WILL CONTAIN COUNT OF MSG PROCX02004 04800010
*        COMPLETION CODE - 8-MCP NOT ACTIVE CTCOPY,QCOPY,ICOPY,  X02004 04900010
*                              TCHNG)                            X02004 05000010
*                           -TCAM DEB NOT FOUND ( MCOUNT,TPDATE) X02004 05100010
*                           -REUSABLE DISK REORGANIZATION IN PROGX02004 05200010
*                            REG 2 WILL CONTAIN COUNT OF MESSAGESX02004 05300010
*                            PROCESS  BEFORE START OF REORGANIZATX02004 05400010
*                             ION.                               X02004 05500010
*                        -12-MCP NOT ACTIVE (MCPCLOSE,MRELEASE,  X02004 05600010
*                             ICHNG)                             X02004 05700010
*                           -NO TCAM DEB FOUND (QCOPY)           X02004 05800010
*                          -SEQUENCE NUMBER ERROR (QRESET)       X02004 05900010
*                        -16-QREST NOT ALLOWED FOR THIS MPP      X02004 06000010
*                        -20-INVALID TERMINAL TYPE (QCOPY)       X02004 06100010
*                           -MCP NOT ACTIVE (CQTAM RETRIEVE)     X02004 06200010
*                           -INVALID TERMINAL NAME OR TERM HELD  X02004 06300010
*                        -24-AN ERROR EXISTS REGARDING THE       X02004 06400010
*                            TYPE OF QUEUING OR THERE ARE NO     X02004 06500010
*                            MESSAGE QUEUED FOR THIS TERM (QRESETX02004 06600010
*                        -28-TERMINATE FUNCTION TO AVOID POSSIBLEX02004 06700010
*                            LOGICAL READ ERROR. REG 2 WILL CON- X02004 06800010
*                            TAIN COUNT OF MESSAGES MARKED UNSERVX02004 06900010
*                            ICED. NO MESSAGES ALE SCHEDULED TOBEX02004 07000010
*                            RESENT.                                    07100010
*                                                                     * 07200010
*TABLES/WORK AREAS - EXTERNAL--TCAM AVT AND OP CONTROL AVT            * 07300010
*                       TNT,QCB,TRM,TCB,DEB,DCB,PEWA,AMWA        X02004 07400010
*                   INTERNAL--CIBTBL,MPPTBL, AND XCTLTBL              * 07500010
*                                                                     * 07600010
*CHARACTER CODE DEPENDENCY --                                         * 07700010
*        THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL        * 07800010
*        REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS        * 07900010
*        EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME.  THE CODING     * 08000010
*        HAS BEEN ARRANGED SO THAT REDEFINITION OF CHARACTER          * 08100010
*        CONSTANTS, BY REASSEMBLY WILL RESULT IN A CORRECT MODULE     * 08200010
*        FOR THE NEW DEFINITION.                                      * 08300010
*                                                                     * 08400010
*        THIS IS A MODULE REWRITE AS OF OS/VS/TCAM LEVEL 2       X02004 08500010
*        THIS A MODULE SPLIT OF IGC0010D.                               08600010
*********************************************************************** 08700010
RZERO    EQU   0                       PARAMETER REGISTER               08800010
RPARM    EQU   1                       PARAMETER REGISTER               08900010
ROPCAVT  EQU   2                       POINTER TO OPC AVT               09000010
RPARMA   EQU   2                        PROCESS PROG PARM LIST   X02004 09100010
ROPCE    EQU   3                       POINTER TO OPCE                  09200010
RCVT     EQU   3                        OS/VS COM VECTOR TABLE   X02004 09300010
RAVT     EQU   4                       POINTER TO TCAM AVT              09400010
RDEB     EQU   5                        DATA EXTENT BLOCK        X02004 09500010
RWORKAD  EQU   5                        XCTL AREA ADDRESS      @XA06556 09600010
RPRITABL EQU   5                        TOP OF PRIORITY TABLE  @Y17XARX 09700010
RTCB     EQU   6                        TASK CONTROL BLOCK       X02004 09800010
RPRITEND EQU   6                        END OF PRIORITY TABLE  @Y17XARX 09900010
RWORKA   EQU   7                       POINTER TO RESIDENT WORKAREA     10000010
RWORK    EQU   8                       WORK REGISTER                    10100010
RWORK1   EQU   9                       WORK REGISTER                    10200010
RPREFIX  EQU   10                      POINTER TO BUFFER                10300010
RQCB     EQU   10                       QUEUE CONTROL BLOCK      X02004 10400010
RCIB     EQU   11                      POINTER TO INPUT CIB             10500010
RCOUNT   EQU   11                       COUNT REGISTER           X02004 10600010
RBASE    EQU   12                      BASE REGISTER                    10700010
R13      EQU   13                       BASE FOR REG SAVEAREA           10800010
RRET     EQU   14                      RETURN REGISTER                  10900010
RBRNCH   EQU   15                      BRANCH REGISTER                  11000010
         SPACE 2                                                        11100010
AL2      EQU   2                       MOVE LENGTH OF TWO               11400010
APPLICAT EQU   X'20'                   INDICATES APPLICATION PROG IN    11900010
APPBTU   EQU   X'D3'                    BTU FOR APPLICATION      S22024 12100010
CVTPTR   EQU   16                       LOW CORE ADDRESS OF CVT         12800010
FOUR     EQU   4                        VALUE FOUR                      13100010
EIGHT    EQU   8                        VALUE EIGHT            @OY14521 14100010
OFF0B    EQU   11                       MOVE OFFSET            @XA06556 15100010
ONE      EQU   1                        VALUE ONE                       15400010
THREE    EQU   3                        VALUE THREE                     15800010
ZERO     EQU   0                       CLEAR HIGH BYTE                  16000010
XCTLOFF  EQU   560                      OFFSET TO XCTL AREA    @XA06556 16300010
         EJECT                                                          16500010
         USING IEDQAVTD,RAVT           TCAM AVT ADDRESSABILITY          16600010
         USING IEDQOPCE,ROPCE          OPCE ADDRESSABILITY              16700010
         BALR  RBASE,ZERO               SET BASE                        16900010
         USING *,RBASE             ADDRESSABILITY                       17000010
IGC0J10D IEDHJN SKIPID                                                  17100010
APPLPROC EQU   *                                                 X02004 17300010
         SPACE 2                                                        17400010
*****************************************************************X02004 17500010
*****************************************************************X02004 17600010
*                                                                X02004 17700010
*        APPLICATION PROGRAM MACRO PROCESSING ROUTINES           X02004 17800010
*                                                                X02004 17900010
*        THIS ROUTINE VALIDATES USERS REQUEST AND GIVES  CONTROL X02004 18000010
*        TO THE APPROPRIATE  PROCESSING ROUTINES. THE FOLLOWING  X02004 18100010
*        MACROS ARE PROCESSED BY IGC0A10D VIA XCTL.              X02004 18200010
*              TCOPY   MCPCLOSE                                  X02004 18300010
*              ICOPY   MRELEASE                                  X02004 18400010
*              TCHNG                                             X02004 18430010
*              ICHNG                                             X02004 18460010
*        THE REMAINDER ARE PROCESSED HERE                        X02004 18900010
*              QCOPY   QRESET                                    X02004 19000010
*              MCOUNT  TPDATE                                    X02004 19100010
*              CKREQ                                             X02004 19200010
*                                                                X02004 19300010
*****************************************************************X02004 19400010
         SPACE 3                                                        19500010
         LR    RRET,RWORK               APPL EXIT ADDR         @Y17XART 19520010
         LR    RPARMA,RPARM             SET R2 WITH PRM LIST   @Y17XART 19550010
         USING APLCOPYD,RPARMA          USER PARM LIST                  19600010
         SR    RBRNCH,RBRNCH            CLEAR COMPLETION REG     X02004 19700010
         L     RCVT,CVTPTR              GET CVT POINTER          Y05330 19800010
         ICM   RTCB,ADDRESS,ONE(RCVT)   NEW-OLD POINTER          Y05330 19900010
         ICM   RTCB,ADDRESS,OCX05(RTCB) CURRENT TCB POINTER      Y05330 20000010
         ICM   RWORKA,ADDRESS,AVTCVTPT+ONE(RCVT) TCAM IN SYSTEM  Y05330 20100010
         L     RAVT,ZERO(,RWORKA)       GET TCAM AVT             Y05330 20300010
         CLM   RTCB,ADDRESS,AVTOCTCB+ONE OPERATOR CONTROL TASK   Y05330 20400010
         BNE   APPLGO                   NO, BRANCH- APPLICATION  Y05330 20500010
*                                       PROGRAM                  Y05330 20600010
         SR    RZERO,RZERO              CLEAR FOR REENTRY TO   @Y17XART 20700010
*                                       IGC0010D               @Y17XART 20800010
         L     RPARM,AVTOCGET           OP CTL AVT             @Y17XART 20800610
         L     RBRNCH,OPCAPXTL-IEDQOPCD(RPARM) APPL XCTL LIST  @Y17XART 20801210
         MVC   ELEVEN(2,RBRNCH),LOADI   ENTRY TO 00            @Y17XART 20852010
         XCTL  SF=(E,(15))              XCTL                   @Y17XART 20853010
         SPACE 2                                                 X02004 23400010
APPLGO   EQU   *                                                 X02004 23500010
         CLM   RZERO,BYTE3,NINER        ENTRY FROM QRESET        Y05330 23600010
         BE    QRESET                   YES, BRANCH                     23700010
         CLM   RZERO,BYTE3,FIVE         ENTRY FROM ICOPY,QCOPY,  X02004 23800010
*                                       TCHNG,ICHNG,MCPCLOSE,    X02004 23900010
*                                       MRELEASE OR TOTE         Y05330 24000010
         BNE   CONTTEST                 NO, BRANCH               X02004 24100010
         TM    APLCODE,QCOPYCD          ENTRY FROM QCOPY         X02004 24200010
         BO    QCOPY                    YES,BRANCH               X02004 24300010
SAVEREGS EQU   *                                               @YA10702 24400010
         SAVE  (14,12)                                           X02004 24500010
         L     RWORKAD,AVTOCGET         OPERATOR CONTROL AVT   @XA06556 24600010
         L     RWORKAD,OPCWORK-IEDQOPCD(RWORKAD)               @XA06556 24700010
*                                       ADDR OF OPC WORKAREA   @XA06556 24800010
         LA    RWORKAD,XCTLOFF(RWORKAD) XCTL AREA              @XA06556 24900010
         CLM   RZERO,BYTE3,SIX          MCOUNT                 @YA10702 25000010
         BE    XCTLA10D                 YES, BRANCH            @YA10702 25100010
         TM    APLCODE,RETRVECD         RETRIEVE               @YA10702 25200010
         BZ    XCTLA10D                 NO, BRANCH             @YA10702 25300010
         MVC   OFF0B(AL2,RWORKAD),RELEASE RELEASE MOD          @XA06556 25400010
         B     GOXCTL                   GO XCTL                @XA06556 25500010
XCTLA10D EQU    *                                                Y05330 25600010
          MVC    OFF0B(AL2,RWORKAD),APPLINT APPL PGM CMD INT   @XA06556 25700010
GOXCTL   EQU    *                                              @XA06556 25800010
         LR    RBRNCH,RWORKAD           SET UP TO XCTL         @XA06556 25900010
         XCTL  SF=(E,(15))              XCTL                   @Y17XART 25920010
         SPACE 2                                                 X02004 26100010
CONTTEST EQU   *                                                 X02004 26200010
         CLM   RZERO,BYTE3,SEVEN        ENTRY CODE               X02004 26300010
         BH    CKREQ                    8 = CKREQ                X02004 26400010
         BE    TPDATE                   7 = TPDATE               X02004 26500010
         LR    RPARM,RZERO              SET UP PARAMETER VALUE @YA10702 26600010
         B     SAVEREGS                 MCOUNT,GO TO IGC0A10D  @YA10702 26700010
         USING IEDQDEB,RDEB             DEB                      X02004 26800010
         EJECT                                                          26900010
TPDATE   EQU   *                                                 X02004 27000010
         SPACE 2                                                 X02004 27100010
*****************************************************************X02004 27200010
*                                                                X02004 27300010
*        THIS SUBROUTINE PROCESS THE TPDATE MACRO WHEN ISSUED IN X02004 27400010
*        THE APPLICATION PROGRAM. IF DELETE=YES WAS SPECIFIED,   X02004 27500010
*        BIT 1 OF GWAOPT2 IS TURNED ON. IF DELETE=NO WAS         X02004 27600010
*        SPECIFIED BIT1 OF GWAOPT2 IS TURNED OFF. IF DISAREA WAS X02004 27700010
*        SPECIFIED, THE ADDRESS IS SAVED IN GWADTSA. IF RECDEL=  X02004 27800010
*        YES WAS SPECIFIED, THE RECORD DELIMITER IS RETURNED TO  X02004 27900010
*        THE APPLICATION PROGRAM.                                X02004 28000010
*                                                                X02004 28100010
*****************************************************************X02004 28200010
         SPACE 2                                                        28300010
         USING APLTPDTE,RPARM           TPDATE PARM LIST         X02004 28400010
         USING IHADCB,RWORK1            DCB                      X02004 28500010
         USING IEDQWRKA,RWORKA          ACCESS METHOD WORKAREA @YA10702 28600010
         USING IEDQPEWA,RWORK           PEWA                   @YA10702 28700010
         USING IEDQQCB,RQCB             QCB                    @YA10702 28800010
         ICM   RWORK1,ADDRESS,APLDCBAD  GET DCB ADDRESS          X02004 28900010
         L     RDEB,DCBDEBAD            GET DEB ADDRESS          X02004 29000010
         TM    DEBTAMID,ID1             TCAM DEB                 X02004 29100010
         BNO   ERROR8                   NO, BRANCH               X02004 29200010
         ICM   RWORKA,ADDRESS,DEBTAMWA  GET ACCESS METHOD WORKA  X02004 29300010
         TM    APLOPTN,DTS              DTSAREA SPECIFIED        X02004 29400010
         BZ    NODTS                    NO, BRANCH               X02004 29500010
         L     RWORK,APLDTSAR           GET DISAREA ADDRESS      X02004 29600010
         STCM  RWORK,ADDRESS,GWADTSA    PUT IN AMWA              X02004 29700010
NODTS    EQU   *                                                 X02004 29800010
         NI    GWAOPT2,X'FF'-GWADLTE    RESET DELETE             X02004 29900010
         TM    APLOPTN,GWADLTE          DELETE=YES SPECIFIED     X02004 30000010
         BZ    NODELETE                 NO, BRANCH               X02004 30100010
         OI    GWAOPT2,GWADLTE          INDICATE DELETE          X02004 30200010
NODELETE EQU   *                                                 X02004 30300010
         TM    APLOPTN,RECDEL           DELIMITER SPECIFIED      X02004 30400010
         BO    DELIMITR                 YES, BRANCH              X02004 30500010
         SR    RPARM,RPARM              CLEAR DELIMITER REG      X02004 30600010
         BR    RRET                     RETURN                   X02004 30700010
DELIMITR EQU   *                                                 X02004 30800010
         L     RWORK,PWAPEWA            PROCESS ENTRY WORK AREA  X02004 30900010
         L     RWORK,PEWAPROC           PROCESS ENTRY            X02004 31000010
         SR    RPARM,RPARM              CLEAR DELIMITER REG      X02004 31100010
         IC    RPARM,TRMCHCIN-IEDQTRM(,RWORK) GET DELIMITER      X02004 31200010
         BR    RRET                     RETURN                   X02004 31300010
         DROP  RPARM                                            SA60320 31400010
         DROP  RWORK1                                            X02004 31500010
         EJECT                                                          31600010
CKREQ    EQU   *                                                 X02004 31700010
*****************************************************************X02004 31800010
*        THIS SUBROUTINE BUILDS A PARAMETER LIST FOR IEDQNB WHEN X02004 31900010
*        PROCESSING THE CKREQ MACRO FROM THE APPLICATION PROGRAM.X02004 32000010
*        THE ADDRESS OF THE ACCESS METHOD WORK AREA IS PASSED TO X02004 32100010
*        IEDQNB FOR FURTHER PROCESSING.                          X02004 32200010
*                                                                X02004 32300010
*****************************************************************X02004 32400010
         SPACE 2                                                 X02004 32500010
         USING IEDQPCB,RTCB             PCB                      X02004 32600010
         USING IEDQCKPD,RWORK           CHECKPOINT WORK AREA     X02004 32700010
         USING IEDQCRED,RWORK1          CKPT REQUEST ELEMENT     X02004 32800010
         SPACE 1                                                 X02004 32900010
         TM    AVTCKFLG,AVTCKTAC        IS TCAM CKPT ACTIVE    @Y17XARX 33000010
         BZ    ERROR4                   NO, BRANCH               X02004 33100010
         L     RWORK,AVTCKAVT-1         GET CHKPT AVT PTR      @Y17XARX 33120010
         L     RWORK,CAVTTCWA-IEDQCKAD(,RWORK)                 @Y17XARX 33140010
*                                       GET CHKPT WORK AREA    @Y17XARX 33160010
         ICM   RDEB,ADDRESS,NINE(RTCB)  ADDRESS OF DEB FROM TCB  X02004 33200010
         SPACE 1                                                 X02004 33300010
DEBLOOP  EQU   *                                                 X02004 33400010
         BZ    ERROR4                   IF ZERO - ERROR          X02004 33500010
         CLI   DEBTAMID,ID1             TCAM DEB                 X02004 33600010
         BE    TCAMDEB                  YES, BRANCH              X02004 33700010
         ICM   RDEB,ADDRESS,DEBDEBAD    GET NEXT DEB             X02004 33800010
         B     DEBLOOP                  CHECK IT                 X02004 33900010
         SPACE 2                                                        34000010
TCAMDEB  EQU   *                                                 X02004 34100010
         ICM   RTCB,ADDRESS,DEBPCBAD    ADDRESS OF PCB           X02004 34200010
         ICM   RWORKA,ADDRESS,DEBTAMWA  ACCESS METHOD WORK AREA  X02004 34300010
         XC    GWAELEM(ELEMLNG),GWAELEM CLEAR ECB,REQUEST ELEMENTX02004 34400010
         CLI   CKPCKRQS,ZERO            CKREQ=0 ON INTRO         X02004 34500010
         BE    ERROR4                   BRANCH IF NO CKREQ       X02004 34600010
         LA    RWORK1,PWAELEM           TEMP REQ ELEMENT         X02004 34700010
         MVI   CREKEY,CRECKREQ          KEY FOR CKREQ            X02004 34800010
         ST    RDEB,CREDEB              ADDR OF DEB IN REQ ELE   X02004 34900010
         LA    RDEB,AVTCKPTB            ADDR OF CHPT QCB         X02004 35000010
         STCM  RDEB,ADDRESS,CREQCBAD    TO ELEMENT               X02004 35100010
         MVI   CRELINK,PRIAPCKP         SET PRIORITY             X02004 35200010
         LA    RQCB,PCBWRKA             ADDRESS OF REQ ELEM      X02004 35300010
         STM   RWORK1,RQCB,PWALIST      PUT IN PARM LIST         X02004 35400010
         MVI   PWALIST,OCX0C            MOVE + POST CODE         X02004 35500010
         LA    RDEB,PWAELEM+OCX10       ADDRESS OF ECB           X02004 35600010
         ST    RDEB,CREECB              TO REQ ELEM              X02004 35700010
         LR    RPARM,RWORKA             RETURN AMWA TO IEDQNB    X02004 35800010
         BR    RRET                     RETURN                   X02004 35900010
         DROP  RWORK1                   DROP WORK REGS           X02004 36000010
         DROP  RTCB                     *                        X02004 36100010
         DROP  RWORK                    *                        X02004 36200010
         EJECT                                                          36300010
QRESET   EQU   *                                                        36400010
*****************************************************************X02004 36500010
*                                                                X02004 36600010
*        THIS SUBROUTINE BUILDS A PARAMETER LIST IN THE ACCESS   X02004 36700010
*        METHOD WORK AREA FOR IEDQGR WHILE PROCESSING THE        X02004 36800010
*        QRESET MACRO FROM THE APPLICATION PROG. THE ADDRESS OF  X02004 36900010
*        THE ACCESS METHOD WORK AREA IS PASSED BACK TO IEDQGR FORX02004 37000010
*        FURTHER PROCESSING.                                     X02004 37100010
*                                                                X02004 37200010
*****************************************************************X02004 37300010
         SPACE 2                                                        37400010
         USING IEDQTRM,RTCB             TERM TABLE               X02004 37500010
         USING IEDQPEWA,RWORK           PROCESS ENTRY WORK AREA  X02004 37600010
         USING IHADCB,RWORK1            DCB                      X02004 37700010
         SPACE 2                                                 X02004 37800010
         L     RWORK1,ZERO(,RPARMA)     GET DCB ADDRESS          X02004 37900010
         TM    DCBOFLGS,OPEN            DCB OPEN                 X02004 38000010
         BNO   ERROR16                  NO, BRANCH               X02004 38100010
         SPACE 1                                                 X02004 38200010
         L     RTCB,QE8DISP(,RWORKA)    POINTER TO BINARY SRCH   X02004 38300010
         L     RDEB,DCBDEBAD            GET THE DEB              X02004 38400010
         ICM   RWORKA,ADDRESS,DEBTAMWA  GET ACCESS METHOD WORK ARX02004 38500010
         L     RWORK,PWAPEWA            PROCESS ENTRY WORK AREA  X02004 38600010
         ICM   RDEB,ALLBYTES,PEGQWKAR   IEDQGQ'S WORK AREA       X02004 38700010
         BZ    ERROR16                  QRESET ALLOWED, NO -ERRORX02004 38800010
         SPACE 1                                                 X02004 38900010
         TM    ZERO(RDEB),AVTE80        QRSET ACTIVE FOR THIS MPPX02004 39000010
         BO    ERROR16                  YES, BRANCH              X02004 39100010
         SPACE 1                                                 X02004 39200010
         L     RCVT,FOUR(,R13)          GET USER'S REG 2         X02004 39300010
         LR    RBRNCH,RTCB              GET ADDRESS OF BINARY    X02004 39400010
*                                       SEARCH ROUTINE           X02004 39500010
         L     RZERO,SAVEREG2(,RCVT)    REG 2                    X02004 39600010
         LR    RCVT,RZERO               SAVE USER'S REG 2        X02004 39700010
         LR    RTCB,RRET                SAVE REG 14              X02004 39800010
         BALR  RRET,RBRNCH              GO TO SEARCH ROUTINE     X02004 39900010
         LR    RRET,RTCB                RESTORE REG 14           X02004 40000010
         LTR   RBRNCH,RBRNCH            TERM FOUND               X02004 40100010
         BZ    ERROR20                  NO, BRANCH               X02004 40200010
         SPACE 1                                                 X02004 40300010
         STH   RBRNCH,GWAELEM+ELETRM    PUT IN SPECIAL ELEMENT   X02004 40400010
         LR    RPARM,RBRNCH             GET TERMTBL OFFSET       X02004 40500010
         L     RBRNCH,AVTRNMPT          GET TERM LOGIC ROUTINE   X02004 40600010
         BALR  RRET,RBRNCH              GET ENTRY ADDRESS        X02004 40700010
         ST    RPARM,GWAELEM+OCX0C      ENTRY ADDR TO SPEC ELEM  X02004 40800010
         LR    RRET,RTCB                RESTORE REG 14           X02004 40900010
         LR    RTCB,RPARM               TERM ENTRY ADDRESS       X02004 41000010
         L     RQCB,ZERO(,RTCB)         GET QCB ADDRESS          X02004 41100010
         SR    RBRNCH,RBRNCH            CLEAR COMPLETION REG     X02004 41200010
         TM    TRMSTATE,ID1             TERM ENTRY FOR LOG LINE  X02004 41300010
*                                       OR LIST TYPE ENTRY       X02004 41400010
         BNZ   ERROR20                  YES, BRANCH              X02004 41500010
         SPACE 1                                                 X02004 41600010
         TM    TRMSTATE,TRMPROC         IS THIS A PROCESS ENTRY  X02004 41700010
         BNO   CHKHELD                  NO, BRANCH               X02004 41800010
         ICM   RWORK1,ADDRESS,QCBDCBAD  GET DCB ADDRESS          X02004 41900010
         CLI   TRMSTAT+1,AVTEZERO       IS DCB OPEN?           @SA70211 42000010
         BNE   ERROR16                  BR YES, DCB MUST       @SA70211 42100010
*                                       BE CLOSED FOR PROCESS    X02004 42200010
         B     CHKQTYPE                 GO CHECK TYPE            X02004 42300010
         SPACE 1                                                 X02004 42400010
CHKHELD  EQU   *                                                 X02004 42500010
         TM    TRMSTATE,TRMHELDN        IS TERMINAL HELD         X02004 42600010
         BO    ERROR20                  YES, BRANCH              X02004 42700010
         SPACE 1                                                 X02004 42800010
CHKQTYPE EQU   *                                                 X02004 42900010
         TM    QCBFLAG,QCBPROC+QCBTERMQ CHECK FOR Q BY TERMINAL  X02004 43000010
*                                       OR PROCESS ENTRY         X02004 43100010
         BZ    ERROR24                  BRANCH IF NEITHER        X02004 43200010
         SPACE 1                                                 X02004 43300010
         TM    QCBPRIPQ,AVTEFF          PRIORITY LEVEL QEEUING   X02004 43400010
         BNZ   ERROR24                  YES, BRANCH              X02004 43500010
         SPACE 1                                                 X02004 43600010
         TM    QCBDSFLG,QCBDISK         DISK QUEUES              X02004 43700010
         BZ    ERROR24                  NO, BRANCH               X02004 43800010
         TM    QCBDSFLG,QCBDRQQ         CONC DATA READY QUEUE    X02004 43900010
         BO    ERROR24                  YES, BRANCH              X02004 44000010
         SPACE 1                                                 X02004 44100010
         SR    RPARM,RPARM              CLEAR REG                X02004 44200010
         ICM   RPARM,ADDRESS,QCBQBACK   QUEUE EMPTY              X02004 44300010
         BZ    ERROR24                  YES, BRANCH              X02004 44400010
         SPACE 1                                                 X02004 44500010
         LH    RPARM,OCX08(,RCVT)       GET SEQ NO. FROM USER    X02004 44600010
         LTR   RPARM,RPARM              SEQ NO. = 0              X02004 44700010
         BZ    ERROR12                  YES, BRANCH              X02004 44800010
         SPACE 1                                                 X02004 44900010
         STH   RPARM,GWAELEM+OCX0A      PUT IN SPECIAL ELEMENT   X02004 45000010
         LH    RCVT,TRMOUTSQ            GET NEXT SEQ NO.         X02004 45100010
         BCTR  RCVT,RZERO               DECREMENT BY ONE         X02004 45200010
         CR    RPARM,RCVT               IS REQUESTED SEQUENCE    X02004 45300010
*                                       NUMBER LESS THAN LAST    X02004 45400010
*                                       OUTPUT SEQ NO. RECEIVED  X02004 45500010
*                                       AT THIS TERMINAL         X02004 45600010
         BH    ERROR12                  NO, BRANCH               X02004 45700010
         SPACE 1                                                 X02004 45800010
         LA    RCVT,ONE(,RCVT)          INCREMENT BY ONE         X02004 45900010
         L     RCOUNT,FOUR(,RPARMA)     GET MAX FROM USER        X02004 46000010
         SR    RCVT,RPARM               FIND DIFFERENCE BETWEEN  X02004 46100010
*                                       LAST OUT SEQ NUMBER AND  X02004 46200010
*                                       THE REQUESTED NUMBER     X02004 46300010
         CR    RCVT,RCOUNT              GREATER THAN MAX         X02004 46400010
         BH    ERROR12                  YES, BRANCH              X02004 46500010
         SPACE 1                                                 X02004 46600010
         L     RPARM,ZERO(,RDEB)        ADDRESS OF IEDQGQ        X02004 46700010
         ST    RPARM,GWAELEM            STORE IN SPECIAL ELEMENT X02004 46800010
         MVI   GWAELEM+FOUR,PRIRTBFR    SET PRIORITY             X02004 46900010
         STCM  RBRNCH,ADDRESS,GWAELEM+OCX05 CLEAR LINK FIELD     X02004 47000010
         SPACE 1                                                 X02004 47100010
         LA    RQCB,GWAELEM             GET ELEMENT ADDRESS      X02004 47200010
         LA    RCOUNT,FOUR(,RDEB)       GET ADDRESS OF TARGET    X02004 47300010
*                                       FIELD IN IEDQGQ WORK AREAX02004 47400010
         STM   RQCB,RCOUNT,GWALIST      PUT IN PARAMETER LIST    X02004 47500010
         MVI   GWALIST,OCX0C            MOVE & POST CODE         X02004 47600010
         LR    RPARM,RWORKA             PASS ADDRESS OF ACCESS   X02004 47700010
*                                       METHOD WORK AREA TO QGR  X02004 47800010
         BR    RRET                     RETURN TO USER           X02004 47900010
         DROP  RTCB                     DROP WORK REGS           X02004 48000010
         DROP  RWORK                    *                        X02004 48100010
         DROP  RWORK1                   *                        X02004 48200010
         EJECT                                                          48300010
QCOPY    EQU   *                                                 X02004 48400010
*****************************************************************X02004 48500010
*                                                                X02004 48600010
*        THIS SUBROUTINE COPIES A QUEUE CONTROL BLOCB (QCB) INTO X02004 48700010
*        A USER WORK AREA. IT USES THE BINARY SEARCH ROUTINE TO  X02004 48800010
*        FIND THE TERM TABLE. FOR A COMPLETE DESCRIPTION OF      X02004 48900010
*        THE FUNCTIONSEE THE PROLOG FOR THE QCOPY FUNCTION       X02004 49000010
*        MODULE, IEDQE2.                                         X02004 49100010
*                                                                X02004 49200010
*****************************************************************X02004 49300010
         SPACE 2                                                 X02004 49400010
         USING IEDQTNTD,RWORK           TERNNAME TABLE           X02004 49500010
         USING IEDQTRM,RWORK1           TERMNAME TABLE ENTRY     X02004 49600010
         USING APLCOPYD,RPARMA          USER PARAMETER LIST      X02004 49700010
         SPACE 1                                                 X02004 49800010
         L     RWORK,AVTRNMPT           TERMNAME TABLE           X02004 49900010
         LR    RCOUNT,RRET              SAVE REG 14             SA58435 50000010
         CLC   APLLIMIT,AVTFZERO        LIMIT SPECIFIED          X02004 50100010
         BE    REGULAR                  NO, BRANCH               X02004 50200010
         SPACE 1                                                 X02004 50300010
         L     RTCB,ZERO(,RPARMA)       TERMINAL NAME            X02004 50400010
         CLI   ZERO(RTCB),BLANK           FIRST TIME THROUGH    SA58435 50500010
         BE    NAMEOK3                  YES, BRANCH             SA58435 50600010
REGULAR  EQU   *                                                 X02004 50700010
         L     RBRNCH,QE8DISP(,RWORKA)  ADDR OF BINARY SEARCH    X02004 50800010
*                                       ROUTINE                  X02004 50900010
         L     RZERO,ZERO(,RPARMA)      GET TERMNAME FOR SEARCH  X02004 51000010
         BALR  RRET,RBRNCH              GO TO SEARCH ROUTINE     X02004 51100010
         LR    RRET,RCOUNT              RESTORE REG 14           X02004 51200010
         LTR   RBRNCH,RBRNCH            TERM NAME VALID          X02004 51300010
         BZ    ERROR32                  NO, BRANCH             @OY14521 51400010
         SPACE 1                                                 X02004 51500010
NAMEOK1  EQU   *                                                 X02004 51600010
         CLC   APLLIMIT,AVTFZERO        ITERATIVE PROCESS        X02004 51700010
         BE    NAMEOK                   YES PROCESS NORMALLY     X02004 51800010
         SPACE 1                                                 X02004 51900010
NAMEOK3  EQU   *                                                 X02004 52000010
         LA    RBRNCH,ONE(,RBRNCH)      ICR ENTRY BY ONE         X02004 52100010
         CH    RBRNCH,TNTLEN            LAST ENTRY               X02004 52200010
         BNH   NAMEOK4                  NO, BRANCH               X02004 52300010
         LA    RBRNCH,LAST              GET LAST COMP CODE       X02004 52400010
         BR    RRET                     RETURN TO USER           X02004 52500010
         SPACE 1                                                 X02004 52600010
NAMEOK4  EQU   *                                                 X02004 52700010
         LR    RCVT,RBRNCH              SAVE TNT OFFSET          X02004 52800010
         LR    RPARM,RBRNCH             PUT IN R1 FOR SRCH LOGIG X02004 52900010
         L     RBRNCH,AVTRNMPT          ADR OF CONVER LOGIC      X02004 53000010
         BALR  RRET,RBRNCH              GET ENTRY ADDRESS        X02004 53100010
         LR    RRET,RCOUNT              RESTORE REG 14           X02004 53200010
         LR    RWORK1,RPARM             ADDRESSIBILITY FOR TERM  X02004 53300010
         LR    RBRNCH,RCVT              RESTORE OFFSET           X02004 53400010
         TM    TRMSTATE,TRMLIST         LIST ENTRY               X02004 53500010
         BO    NAMEOK3                  YES, BRANCH GET NEXT     X02004 53600010
         TM    TRMDSORG,TRMLGB          LINE GROUP BLOCK         Y05330 53700010
         BO    NAMEOK3                  YES, GET NEXT ENTRY      Y05330 53800010
         CLC   TRMDESTQ(THREE),AVTFZERO DEST. QCB FOR THIS TYPE  X02004 53900010
*                                       TERMINAL ENTRY           X02004 54000010
         BZ    NAMEOK3                  NO, BRANCH               X02004 54100010
         ICM   RQCB,ADDRESS,TRMDESTQ    GET QCB ADDRESS          X02004 54200010
         TM    QCBDSFLG,QCBDRQQ         CONC DATA READY QUEUE    X02004 54300010
         BO    NAMEOK3                  YES, BRANCH GET NEXT     X02004 54400010
         CLC   APLLIMIT+TWO(TWO),QCBMSGCT THIS QCB HAVE THE      X02004 54500010
*                                       LIMIT                    X02004 54600010
         BH    NAMEOK3                  NO, BRANCH               X02004 54700010
NAMEOK5  EQU   *                                                 X02004 54800010
         LR    RZERO,RQCB               SAVE QCB ADDRESS         X02004 54900010
         SR    RCOUNT,RCOUNT            CLEAR COUNT REG          X02004 55000010
         IC    RCOUNT,TNTENLEN          GET MAX LENGTH OF ENTRY  X02004 55100010
         LA    RCOUNT,THREE(,RCOUNT)    INCREMENT FOR ADDRESS    X02004 55200010
         LR    RQCB,RBRNCH              GET OFFSET               X02004 55300010
         BCTR  RQCB,RZERO               DECREMENT                X02004 55400010
         MR    RQCB,RQCB                MULTIPLY OFFSET BY LENGTHX02004 55500010
         LA    RQCB,TNTFIRST            GET FIRST ADDRESS        X02004 55600010
         LA    RQCB,ZERO(RCOUNT,RQCB)   INCR TO BEGIN OF ENTRY   X02004 55700010
         SR    RCOUNT,RCOUNT            CLEAR LENGTH REG         X02004 55800010
         IC    RCOUNT,TNTENLEN          GET MAX LENGTH           X02004 55900010
         BCTR  RCOUNT,RZERO             DECREMENT FOR EXECUTE    X02004 56000010
         LR    RDEB,RQCB                SET SOURCE REG           X02004 56100010
         EX    RCOUNT,MOVE              MOVE NAME TO USR'S AREA  X02004 56200010
         LR    RQCB,RZERO               RESTORE QCB ADDR.        X02004 56300010
         B     COMP1                    PROCESS REMAINDER        X02004 56400010
         EJECT                                                   X02004 56500010
NAMEOK   EQU   *                                                 X02004 56600010
         LR    RPARM,RBRNCH             TERMNME TABLE OFFSET     X02004 56700010
         L     RBRNCH,AVTRNMPT          ADDR OF CONV. LOGIC      X02004 56800010
         BALR  RRET,RBRNCH              GET ENTRY ADDRESS        X02004 56900010
         LR    RRET,RCOUNT              RESTORE R14              X02004 57000010
         LR    RWORK1,RPARM             ADDRESS OF TERM ENTRY    X02004 57100010
         SR    RBRNCH,RBRNCH            CLEAR COMPLETION REG     X02004 57200010
         TM    TRMSTATE,TRMLIST         VALID TERMINAL           X02004 57300010
         BO    ERROR4                   NO, BRANCH               X02004 57400010
         TM    TRMDSORG,TRMLGB          LINE GROUP ENTRY         Y05330 57500010
         BO    ERROR4                   YES, BRANCH              Y05330 57600010
         SPACE 1                                                 X02004 57700010
COMPSIZE EQU   *                                                 X02004 57800010
         CLC   TRMDESTQ(THREE),AVTFZERO DEST QCB FOR THIS        X02004 57900010
*                                       TYPE OF TERMINAL ENTRY   X02004 58000010
         BZ    ERROR4                   NO, BRANCH               X02004 58100010
COMP1    EQU   *                                                 X02004 58200010
         SPACE 1                                                  02004 58300010
         LA    RDEB,QCBMSIZE            INIT COUNT TO SIZE OF    X02004 58400010
*                                       MASTER QCB               X02004 58500010
         ICM   RQCB,ADDRESS,TRMDESTQ    ADDRESS OF MASTER QCB    X02004 58600010
         LR    RAVT,RQCB                SAVE QCB ADDR FOR MOVE   X02004 58700010
         LA    RQCB,QCBMEND             ADDRESS OF FIRST PRIORITYX02004 58800010
*                                       LEVEL QCB                X02004 58900010
LOOPX    EQU   *                                                 X02004 59000010
         LA    RDEB,QCBPSIZE(,RDEB)     INCR BY SIZE OF ONE      X02004 59100010
*                                       PRIORITY QCB             X02004 59200010
         CLI   QCBPRIPQ-IEDQPQCB(RQCB),ZERO ANOTHER PRIORITY QCB X02004 59300010
         BZ    MVCL                     NO, BRANCH               X02004 59400010
         LA    RQCB,QCBPSIZE(,RQCB)     NEXT PRIORITY QCB        X02004 59500010
         B     LOOPX                    GET NEXT QCB             X02004 59600010
         SPACE 2                                                 X02004 59700010
ERROR32  LA    RBRNCH,EIGHT(RBRNCH)     CC=32                  @OY14521 59705010
ERROR24  LA    RBRNCH,FOUR(RBRNCH)      CC = 24                  X02004 59710010
ERROR20  LA    RBRNCH,FOUR(RBRNCH)      CC = 20                  X02004 59720010
ERROR16  LA    RBRNCH,FOUR(RBRNCH)      CC = 16                  X02004 59730010
ERROR12  LA    RBRNCH,FOUR(RBRNCH)      CC = 12                  X02004 59740010
ERROR8   LA    RBRNCH,FOUR(RBRNCH)      CC = 8                   X02004 59750010
ERROR4   LA    RBRNCH,FOUR(RBRNCH)      CC = 4                   X02004 59760010
         BR    RRET                     RETURN TO USER           X02004 59770010
         SPACE 2                                                        59780010
MVCL     EQU   *                                                 X02004 59800010
         L     RPARMA,APLUSEWK          ADDRESS OF USER'S WORKA  X02004 59900010
         LR    RCVT,RDEB                SET OPERAND 1 LENGTH     X02004 60000010
         MVCL  RPARMA,RAVT              MOVE QCB TO USER WORK ARAX02004 60100010
         SR    RBRNCH,RBRNCH            CLEAR COPMLRTION REG     X02004 60200010
         BR    RRET                     RETURN TO USER           X02004 60300010
MOVE     MVC   ZERO(ONE,RTCB),ZERO(RDEB) MOVE FROM QCB TO USER   X02004 60400010
*                                       WORK AREA                X02004 60500010
TWO      EQU   2                        HALFWORD DISPLACEMENT    X02004 60600010
LAST     EQU   X'80'                    CC FOR LAST              X02004 60700010
DTS      EQU   X'20'                    DTSAREA=YES              X02004 60800010
RECDEL   EQU   X'80'                    RECDEL=YES               X02004 60900010
TCOPYCD  EQU   X'80'                    ENTRY FROM TCOPY         X02004 61000010
QCOPYCD  EQU   X'40'                    ENTRY FROM QCOPY         X02004 61100010
TCHNGCD  EQU   X'20'                    ENTRY FROM TCHNG         X02004 61200010
ICOPYCD  EQU   X'10'                    ENTRY FROM ICOPY         X02004 61300010
APLQETCD EQU   X'08'                    ENTRY FROM IEDQET        X02004 61400010
RETRVECD EQU   X'04'                    ENTRY FROM RETRIEVE      Y05330 61500010
ID1      EQU   X'C0'                    TCAM DEB                 X02004 61600010
ADDRESS  EQU   7                        ADDRESS MASK             X02004 61700010
ALLBYTES EQU   15                       ALLBYTES MASK            X02004 61800010
HALFWORD EQU   3                        HALFWORD MASK            X02004 61900010
PARTBUF  EQU   X'02'                    PARTIAL DATA FLAG        X02004 62000010
BYTE3    EQU   1                        REG LOWORDER BYTE        X02004 62200010
ELEMLNG  EQU   20                       ELEMENT LENGTH           X02004 62300010
ELETRM   EQU   8                        DISP FOR TERM ADDR.      X02004 62400010
NINE     EQU   9                        DISPLACEMENT             X02004 62500010
OPEN     EQU   X'10'                    OPEN FLAG                X02004 62600010
SAVEREG2 EQU   28                       OFFSET TO REG 2 IN SAVARAX02004 62700010
QE8DISP  EQU   48                       ADDR OF THE BINARY SEARCHX02004 62800010
*                                       IN DISPATCHER WORK AREA  X02004 62900010
BLANK    EQU   X'40'                    FIRST TIME THROUGH      SA58435 63000010
PUT      EQU   X'40'                    OUTPUT DCB              SA60320 63100010
PRIRTBFR EQU   X'D4'                    QRESET PRIORITY          X02004 63200010
FIVE     DC    X'05'                    RZERO ENTRY CODES        X02004 63300010
SIX      DC    X'06'                                           @YA10702 63400010
SEVEN    DC    X'07'                    *                        X02004 63500010
NINER    DC    X'09'                                             X02004 63520010
LOADI    DC    C'00'                    ENTRY TO IGC0010D      @Y17XART 63700010
ELEVEN   EQU  11                        DISP INTO XCTL LIST    @Y17XART 63720010
         SPACE 2                                                        63800010
APPLINT  DC    C'0A'                  APPL PROG PROC           @XA06556 63900010
RELEASE DC     C'R0'                                           @XA06556 64000010
CLSMSG   WTO   'IED063I CLOSEDOWN IN PROGRESS - COMMAND REJECTED',     X64500010
               MF=L,DESC=5,MCSFLAG=(REG0,RESP)                          64600010
ZAPAREA  DC    50F'0'                   PATCH AREA                      64700010
         TITLE 'IGC0010D - DSECTS USED BY THIS MODULE'                  64800010
         TAVTD                                                          64900010
         EJECT                                                          65000010
         TCAVTD                                                @Y17XARX 65100010
         EJECT                                                          65200010
         TOPCAVTD                                                       65300010
         EJECT                                                          65400010
         TOPCED                                                         65500010
         EJECT                                                          65600010
         TOPRED                                                @Y17XARX 65700010
         TPCBD                                                          65800010
         DCBD  DSORG=TX                                                 65900010
         TDEBAPD                                                        66000010
         TACSMD                                                         66100010
         TTRMD                                                          66200010
         TPEWAD                                                         66300010
         TQCBD                                                          66400010
         TTNTD                                                          66500010
         TPRFD                                                          66600010
         TCKPD 3330                                                     66700010
         TPRIOR                                                         66800010
APLCOPYD DSECT                          USER PARM LIST           X02004 66900010
APLCODE  DS    FL1                      ENTRY CODE               X02004 67000010
APLTERM  DS    AL3                      TERMINAL ADDRESS         X02004 67100010
APLUSEWK DS    F                        USER WORK AREA           X02004 67200010
APLLIMIT DS    F                        LIMIT OPERAND            X02004 67300010
APLTPDTE DSECT                          TPDATE PARM LIST         X02004 67400010
APLOPTN  DS    FL1                      OPTION BYTE              X02004 67500010
APLDCBAD DS    AL3                      DCB ADDRESS              X02004 67600010
APLDTSAR DS    F                        DTSAREA ADDRESS          X02004 67700010
      END                                                               67800010
