         TITLE 'IGC0K05B  MOUNT/VERIFICATION PROCESSOR - NON-DIRECT ACC*00090018
               ESS    REPOSITION I/O  RESTART-SVC 52  OS/360'           00180018
IGC0K05B START                                                          00270018
*              OS                                                       00280002
*                                                                A48235 00320000
*                                                                A50338 00330000
*          RELEASE 18 DELETIONS                                         00360018
*          RELEASE 19 DELETIONS                                         00450018
*0522225900,238500,557100                                        A25775 00490019
*0522415800                                                      A25997 00510019
*0522277200,329400-330300                                        A25937 00520019
*0522510300                                                      M3946  00530019
*          RELEASE 20 DELETIONS                                         00540018
*1380279000,313200,371700,385200,459900,490500,529200,617400,    S20038 00570020
*1380650700,652500,656100,666900                                 S20038 00600020
*1380208800                                                      M3408  00610020
*1380438600-438900                                               A35767 00615020
*1380261400,372100,631500                                        A36340 00620020
*          RELEASE 21 DELETIONS                                         00630018
*0987390600,438600                                               A46376 00640021
*0987                                                            A41442 00650021
*0987591300,666000                                               A40520 00670021
*              OS/VS2                                                   00680002
*          RELEASE 2 CHANGES/DELETIONS                                  00720000
*                                                               YA03211 00770002
*          RELEASE 3 DELETIONS                                          00772002
*0000579600                                                     ZA01325 00774002
*336939-337259                                                 @Z30AAHP 00820003
*D56730018,D56750018                                           @ZA02206 00870037
*C263300,372100,391000,631200,631500,645300                    @ZA07612 00970037
*C334800                                                       @ZA09631 01070037
*A23221018,C28730019,A31501018-31509018                        @ZA11144 01120037
*C22230018-22234018                                            @ZA11641 01140037
*C147640                                                       @ZA19100 01145032
*C147640                                                       @ZA19100 01147032
*D870300-890100                                                @ZA18506 01149032
*C440100,507600                                                @ZA18506 01151032
* APAR OZ31487 HAS BEEN FLAGGED AS @ZSUT222                    @ZSUT222 01151532
*C147540-147580,148639,603000,605000,607000,609000,611000      @ZSUT222 01152032
*C621040                                                       @ZSUT222 01152232
*A612500-613500,657500                                         @ZSUT222 01152432
*                                                              @G32DSMI 01153032
*           VS2 SU32 DELETIONS                                 @G32DSFS 01155032
*                                                              @G32DSFS 01157032
*                                                              @ZM45144 01159032
*A120033                                                       @ZA29067 01164032
*C279840                                                       @ZA30100 01166032
*A280040-280240,282100,315906                                  @ZA30100 01168032
* STATUS CHANGE LEVEL 004                                               01170021
*                                                                       01260018
*TITLE                                                                  01350018
*                                                                       01440018
*     NON-DIRECT ACCESS MOUNT/VERIFICATION PROCESSOR                    01530018
*                                                                       01620018
*STATUS                                                                 01710018
*                                                                       01800018
*FUNCTION/OPERATION                                                     01890018
*                                                                       01980018
*        CHECK VOLUME SERIAL IN TABLE AGAINST VOLUME SERIAL IN THE      02070018
*        SRTUCB INDICATED BY THE DATA SET'S TIOT ENTRY.                 02160018
*                                                                       02250018
*        IF THE CORRECT VOLUME IS NOT MOUNTED, CHECK ALL THE SECONDARY  02340018
*        STRUCB'S INDICATED AND IF THE VOLUME IS FOUND TO BE MOUNTED    02430018
*        ON ONE OF THEM, EXCHANGE IT WITH THE PRIMARY SRTUCB.           02520018
*                                                                       02610018
*        IF THE CORRECT VOLUME IS NOT MOUNTED ANYWHERE FIND A USEABLE   02700018
*        UCB & ISSUE A MOUNT MESSAGE - ERROR IF NO AVAILABLE UCB.       02790018
*                                                                       02880018
*        AS SOON AS THE VOLUME IS READY, READ THE VOLUME LABEL AND      02970018
*        VERIFY THAT THE CORRECT VOLUME WAS MOUNTED - IF NOT, REPEAT    03060018
*        THE MOUNTING PROCEDURE.                                        03150018
*                                                                       03240018
*        REPEAT THE ABOVE FOR EACH VOLUME SERIAL IN EACH ENTRY OF THE   03330018
*        TABLE(EXCEPT THE RESTART DATA SET) - TAPE ONLY. FOR SYSIN,     03380002
*        SYSOUT,UNIT RECORD, OR GRAPHIC DATA SETS UPDATE THE DEB.       03430002
*        DIRECT ACCESS IS PROCESSED IN THE NEXT LOAD. NO PROCESSING     03480002
*        IS PERFORMED FOR A NULLFILE.                                   03530002
*        FOR RACF DEFINED DATA SETS THE USERS AUTHORIZATION    @G32DSMI 03534032
*        IF THE DEQ-AT-DISMOUNT FACILITY WERE ACTIVE, IT IS    @ZA18506 03580037
*        IS CHECK USING A RACHECK.                             @G32DSMI 03604032
*        REESTABLISHED AND ALL PRECEEDING VOLUMES ARE DEQED.   @ZA18506 03630037
*                                                                       03690018
*ENTRY POINTS -                                                         03780018
*                                                                       03870018
*              IGC0K05B  INITIAL ENTRY VIA XCTL FROM IGC0I05B           03960018
*                        ALSO ENTRY VIA RETURN FROM NSLRHRDI            04050018
*                        (NONSTANDARD LABEL ROUTINE)                    04140018
*                                                                       04230018
*INPUT                                                                  04320018
*                                                                       04410018
*    REGISTER 8 - START OF DATA SET TABLE                               04500018
*    REGISTER 1 - RESTART WORKAREA                                      04590018
*                                                                       04680018
*OUTPUT                                                                 04770018
*                                                                       04860018
*     NOT APPLICABLE                                                    04950018
*                                                                       05040018
*EXTERNAL ROUTINES                                                      05130018
*                                                                       05220018
*              NONE                                                     05310018
*                                                                       05400018
*EXITS                                                                  05490018
*                                                                       05580018
*        (1) TO NONSTANDARD LABEL PROCESSING ROUTINE - NSLRHDRI         05670018
*        (2) D.A. MOUNT ROUTINE - IGC0M05B                              05760018
*        (3) NON-DA SYSIN/SYSOUT ROUTINE - IGC0L05B                     05850018
*        (4) ERROR EXIT TO IGC0V05B WITH ONE OF THE FOLLOWING ERROR     05860032
*            CODES SET IN THE RESTART WORK AREA:                        05870032
*            26 - ERROR IN READ JFCB                                    05880032
*            30 - I/O ERROR IN NSL ROUTINE                              05890032
*            40 - I/O ERROR READING VOLUME LABEL                        05900032
*            44 - NO UCB AVAILABLE                                      05910032
*            46 - NO SCU FOR 1275 1419                                  05920032
*           255 - RACF ERROR                                            05930032
*                                                                       05940018
*TABLES/WORKAREAS-                                                      06030018
*                                                                       06120018
*********************************************************************** 06210018
*                                                                     * 06300018
*    THE FOLLOWING IS A DESCRIPTION OF THE 48 BYTE TABLE ENTRY THAT   * 06390018
*    IS USED IN THE RESTART PORTION OF CHECKPOINT/RESTART.  EACH      * 06480018
*    ENTRY IN THE TABLE (ONE FOR EACH OPEN DATA SET AT CHECKPOINT)    * 06570018
*    IS 48 BYTES LONG.                                                * 06660018
*                                                                     * 06750018
*********************************************************************** 06840018
*                                                                       06930018
*        ------------------- 4 BYTES -----------------                  07020018
*                                                                       07110018
*      0 +++++++++++++++++++++++++++++++++++++++++++++                  07200018
*        +DATA SET  +           DCB                  +                  07290018
*        + ORGN.    +         ADDRESS                +                  07380018
*        +++++++++++++++++++++++++++++++++++++++++++++ 4                07470018
*        +FLAG BYTE +    WORKAREA SEGMENT            +                  07560018
*        + NO. 1    +         ADDRESS                +                  07650018
*      8 +++++++++++++++++++++++++++++++++++++++++++++                  07740018
*        +NUMBER    +         JFCB TTR               +                  07830018
*        + OF VOLS  +         ADDRESS                +                  07920018
*        +++++++++++++++++++++++++++++++++++++++++++++ 12               08010018
*                                                                       08100018
*     12 +++++++++++++++++++++++                                        08190018
*        +TAPE LABL + FILE SEQ +        DEVICE = TAPE                   08280018
*        +INFO BYTE + NUMBER   +                                        08370018
*        +++++++++++++++++++++++                                        08460018
*                                                                       08550018
*     12 +++++++++++++++++++++++                                        08640018
*        +    OLD   TIOT       +        DA AND UNIT RECORD              08730018
*        +      OFFSET         +                                        08820018
*        +++++++++++++++++++++++                                        08910018
*                                                                       09000018
*                              +++++++++++++++++++++++                  09090018
*                              +FLAG BYTE +FLAG BYTE +                  09180018
*                              +  NO. 2   +  NO. 3   +                  09270018
*     16 +++++++++++++++++++++++++++++++++++++++++++++                  09360018
*        +FLAG BYTE +FLAG BYTE +                     +                  09450018
*        + NO. 4    + NO. 5    +   VOLUME ID NO. 1   +                  09540018
*        +++++++++++++++++++++++                     + 20               09630018
*        +                                           +                  09720018
*        +                                           +                  09810018
*     24 +++++++++++++++++++++++++++++++++++++++++++++                  09900018
*        +                                           +                  09990018
*        +   VOLUME ID NO. 2                         +                  10080018
*        +                     +++++++++++++++++++++++ 28               10170018
*        +                     +                     +                  10260018
*        +                     +   VOLUME ID NO. 3   +                  10350018
*     32 +++++++++++++++++++++++                     +                  10440018
*        +                                           +                  10530018
*        +                                           +                  10620018
*        +++++++++++++++++++++++++++++++++++++++++++++ 36               10710018
*        +                                           +                  10800018
*        +   VOLUME ID NO. 4                         +                  10890018
*     40 +                     +++++++++++++++++++++++                  10980018
*        +                     +                     +                  11070018
*        +                     +                     +                  11160018
*        +++++++++++++++++++++++   VOLUME ID NO. 5   + 44               11250018
*        +                                           +                  11340018
*        +                                           +                  11430018
*        +++++++++++++++++++++++++++++++++++++++++++++ 48               11520018
*                                                                       11610018
*                                                                       11700018
*ATTRIBUTES -                                                           11790018
*                                                                       11880018
*       REENTRANT, ENABLED, PRIVILEGED.                                 11970018
*                                                                       12060018
*********************************************************************** 12150018
*                                                                       12240018
*    REGISTER CONVENTION TO BE USED THRU-OUT REPI/O PHASE               12330018
*                                                                       12420018
*********************************************************************** 12510018
*                                                                       12600018
WRKR1    EQU   0         WORK/PARM REGISTER                             12690018
WRKR2    EQU   1         WORK/PARM REGISTER                             12780018
DCBR     EQU   2         CURRENT DCB REGISTER                           12870018
BASER    EQU   3         BASE REGISTER                                  12960018
DEBR     EQU   4         CURRENT DEB REGISTER                           13050018
UCBR     EQU   5         CURRENT UCB REGISTER                           13140018
TIOTR    EQU   6         NEW TIOT REGISTER                              13230018
TCBR     EQU   7         TCB REGISTER                                   13320018
TABLR    EQU   8         START OF DCB TABL REG                          13410018
CTABLR   EQU   9         CURRENT DCB IN TABL REG                        13500018
BUFR     EQU   10        USER BUFFER AREA                               13590018
DSCNTR   EQU   11        NUMBER OF DATA SETS                            13680018
WRKR3    EQU   12        WORK REGISTER                                  13770018
WRKR4    EQU   13        WORK REGISTER                                  13860018
WRKR5    EQU   14        WORK/PARM REGISTER                             13950018
WRKR6    EQU   15        WORK/PARM REGISTER                             14040018
*                                                                       14130018
*********************************************************************** 14220018
*                                                                       14310018
*    OFFSETS TO BE USED IN REPI/O PHASE                                 14400018
*                                                                       14490018
*********************************************************************** 14580018
*                                                                       14670018
IS       EQU   X'80'                    INDEXED SEQUENCIAL              14672018
PS       EQU   X'40'                    PHYSICAL SEQUENCIAL             14674018
DA       EQU   X'20'                    DIRECT ACCESS                   14676018
PO       EQU   X'02'                    PARTITIONED ORGANIZATION        14678018
INOROUT  EQU   X'40'                    SYSIN OR SYSOUT DATA SET        14682018
DADEV    EQU   X'20'                    DA DEVICE                       14684018
TPDEV    EQU   X'10'                    TAPE DEVICE                     14686018
DEV1275  EQU   X'1F'                    1275 OPT CHR RDR        YM05550 14688002
DEV1419  EQU   X'1D'                    1419 MAG INK CHR RDR    YM05550 14688402
UNITREC  EQU   X'04'                    UNIT RECORD EQUIPMENT           14690018
ERRINNSL EQU   X'80'                    ERROR IN NSL ROUTINE            14692018
NSLMTSW  EQU   X'40'                    NSL MOUNT SWITCH                14694018
NSLCOMU  EQU   X'20'                    NSL COMMUNICATION BIT           14696018
BYPASS   EQU   X'10'                    BYPASS LABEL PROCESSING         14698018
AL       EQU   X'08'                    ASCII LABEL              S20038 14699020
NSL      EQU   X'04'                    NON-STANDARD LABEL              14700018
SL       EQU   X'02'                    STANDARD LABEL                  14702018
NL       EQU   X'01'                    NO LABEL                        14704018
POCONCAT EQU   X'40'                    P.O. CONCATENATED               14708018
DAFLAG   EQU   X'80'                    DA DATA SET FLAG                14710018
NONDAFLG EQU   X'40'                    NON-DA DATA SET FLAG            14712018
NSLFLAG  EQU   X'10'                    NSL ROUTINE FLAG                14714018
TYPERST  EQU   X'80'                    IMMEDIATE RESTART               14716018
TABENT   EQU   48                       TABLE ENTRY LENGTH              14718018
WRITE    EQU   X'01'                    WRITE ON TAPE                   14720018
READ     EQU   X'02'                    READ FOR TAPE                   14722018
NOPOP    EQU   X'03'                    NOP                             14724018
SENSE    EQU   X'04'                    SENSE                           14726018
REWIND   EQU   X'07'                    REWIND                          14728018
READBACK EQU   X'0C'                    READBACK                        14730018
UNLOAD   EQU   X'0F'                    REWIND AND UNLOAD               14732018
WTM      EQU   X'1F'                    WRITE TAPE MARK                 14734018
BSFOP    EQU   X'2F'                    BACKWARD SPACE FILE             14736018
FSFOP    EQU   X'3F'                    FORWARD SPACE FILE              14738018
CCWFSR   EQU   X'37'                    FORWARD SPACE RECORD CMD  99223 14738402
SEARCH   EQU   X'31'                    SEARCH                          14740018
SRCHCNT  EQU   X'05'                    COUNT FOR SEARCH ID             14742018
TIC      EQU   X'08'                    TIC                             14744018
READDA   EQU   X'06'                    READ FOR DA                     14746018
LENJFCB  EQU   X'B0'                    LENGTH OF JFCB                  14748018
LBLLEN   EQU   X'50'                    LENGTH OF LABEL                 14750018
PERMERR  EQU   X'7F'                    PERMANENT ERROR                 14752018
ERR026   EQU   26                       ERROR READING IN JFCB  @ZSUT222 14754032
ERR030   EQU   30                       I/O ERROR IN NSL RTN   @ZSUT222 14755032
ERR040   EQU   40                       ERROR IN READ VOL LABEL@ZSUT222 14756032
ERR044   EQU   44                       NO UCB AVAILABLE       @ZSUT222 14757032
ERR046   EQU   46                       NO SCU FOR 1275 1419   @ZSUT222 14758032
INTECEPT EQU   X'44'                    INTERCEPT CMND CODE     YM05549 14762402
TCAM     EQU   X'02'                    TABFLG1 TCAM FLAG        M3408  14763020
DMCOUNT0 EQU   X'7F'                    DATA MANAGEMENT COUNT  @ZA19100 14764037
PERMRES  EQU   X'24'                    PERMANENT RESIDENT OR RESERVED  14766018
NOTREADY EQU   X'40'                    NOT READY SWITCH                14768018
OUTP     EQU   X'03'                    OUTPUT (DEBOPATB)               14772018
SLIFLAG  EQU   X'20'                    SLI FLAG                        14774018
FILEPROT EQU   X'02'                    FILE PROTECTED                  14776018
FSROP    EQU   X'37'                    FORWARD SPACE RECORD    99223   14777002
INOUT    EQU   X'0C'                    INOUT (DEBOPATB)                14778018
ONE      EQU   X'01'                    CONSTANT ONE                    14780018
COMPCODE EQU   X'00'                    COMPLETION CODE                 14782018
RINGIN   EQU   C'F'                     INSERT FILE PROTECT RING        14784018
USED     EQU   C'U'                     VOLUME CAN BE USED              14786018
MOUNTON  EQU   X'80'                    MOUNT SWITCH ON                 14788018
MOUNTOFF EQU   X'00'                    MOUNT SWITCH OFF                14790018
UNITCHK  EQU   X'02'                    UNIT CHECK                      14792018
UNITEXP  EQU   X'01'                    TAPE MARK INDCIATOR     ZA01325 14792402
WRONGLEN EQU   X'40'                    WRONG LENGTH RECORD             14794018
MODECLR  EQU   X'C0'                    DENSITY SET                     14796018
SETMODE  EQU   X'2B'                    EVEN PAR. TRANS MODE. CNVT OFF  14798018
SLASH    EQU   C'/'                     SLASH                           14800018
TWO      EQU   2                        CONSTANT OF TWO          S20038 14810020
FOUR     EQU   4                        CONSTANT OF FOUR         S20038 14820020
SIX      EQU   6                        CONSTANT OF SIX          S20038 14830020
NINE     EQU   9                        CONSTANT OF NINE         S20038 14840020
D0       EQU   0                        ZERO                     Y02076 14842002
D1       EQU   1                        ONE                      Y02076 14844002
D2       EQU   2                        TWO                      Y02076 14846002
D3       EQU   3                        THREE                    Y02076 14848002
D4       EQU   4                        FOUR                     Y02076 14848402
D5       EQU   5                        FIVE                     Y02076 14848802
D6       EQU   6                        SIX                      Y02076 14849202
D7       EQU   7                        SEVEN                    Y02076 14849602
D8       EQU   8                        EIGHT                    Y02076 14849702
D9       EQU   9                        NINE                     Y02076 14849802
D15      EQU   15                       NO. OF VOLS IN JFCBX   @ZA18506 14849937
D24      EQU   24                       TWENTY FOUR              Y02076 14853932
ERR255   EQU   255                      RACF RELATED ERROR     @ZSUT222 14863932
*                                                                       14909937
*********************************************************************** 14940018
*                                                                       15030018
         USING TABL,WRKR4          CURRENT TABLE ENTRY                  15120018
         USING MNTTIOT,TIOTR       NEW TIOT                             15210018
         USING MNTUCB,UCBR         UCB                                  15300018
         USING DEBBASIC,DEBR       DEB                           Y02076 15390002
         USING RSDSECT,WRKR3       WORK AREA                            15570018
         USING IHADCB,CTABLR       DCB                                  15660018
         USING RSTWA,BUFR         RESTART WORK AREA                     15750018
*                                                                       15840018
         BALR  BASER,0             SET UP BASE REGISTER                 15930018
         USING *,BASER                                                  16020018
         B     BEGIN               BRANCH AROUND EYE CATCHER     Y01909 16070000
         CNOP  0,8                 ALIGN TO A DBL WORD BOUNDARY  Y01909 16080000
         DC    CL8'IGC0K05B'       MODULE NAME                 @ZSUT222 16090032
         DC    CL8'&SYSDATE'       LAST DATE SHIPPED           @ZSUT222 16092032
         DC    CL8'@ZSUT222'       LAST CODE SHIPPED           @ZSUT222 16094032
         DC    CL8'@SU83200'       SELECTABLE UNIT ID          @ZSUT222 16096032
BEGIN    EQU   *                                                 Y01909 16100000
*                                                                       16110018
         XC    RSMWOFST(4),RSMWOFST     ZERO FOR DOMING         ZA02206 16160037
         TM   RSDCBFLG,NSLFLAG    ARE WE COMING FROM NSL RTN            16200037
         BO    MNTTP085           BRANCH IF YES                         16290018
*                                                                       16380018
************  ********** ***************  ************  *************** 16470018
*                                                                     * 16560018
*               INITIALIZE REGISTERS                                  * 16650018
*                                                                     * 16740018
************  ********** ***************  ************  *************** 16830018
*                                                                       16920018
*        IN ORDER TO PREVENT A NON-CANCELABLE SITUATION IN THE   YM7890 16922002
*        EVENT THE MEMORY IS SWAPPED OUT WITH AN OUTSTANDING     YM7890 16924002
*        MOUNT, ISSUE A SYSEVENT TO INHIBIT SWAP-OUT.            YM7890 16926002
*                                                                YM7890 16928002
         SYSEVENT DONTSWAP         INHIBIT SWAP-OUT              YM7890 16928402
*                                                                YM7890 16928802
         XC    QMNPRMWA,QMNPRMWA   ZERO OUT QMNGR PARM LIST      YM5965 16930002
*                                  POINTER AREA                  YM5965 16940002
         MVC   RSPPM(8),NAMEDA     SET UP XCTL                      MCS 16960018
         L     TCBR,RSTCBAD        PICK UP TCB ADDR                     17010002
         USING TCB,TCBR            TCB                         @ZM45144 17100032
         L     TIOTR,TCBTIO        LOAD TIOT ADDR.                      17500032
         DROP  TCBR                                            @ZM45144 17900032
         LR    WRKR4,TABLR         TABLE ADDRESS TO WRKR4               18540018
*                                                                       18630018
MNTTP005 EQU   *                                                        18720018
         L     CTABLR,TABDCBAD-1   PICK UP DCB ADDRESS                  18810018
         LH    WRKR5,DCBTIOT       PICK UP TIOT OFFSET (TIOTR + WRKR5   18900018
*                                  POINTS TO DDNAME                     18990018
         L     DEBR,DCBDEBAD       PICK UP DEB ADDRESS                  19080018
         LA    WRKR5,16(WRKR5)    DISPLACEMENT TO 1ST UCB               19170018
         L     UCBR,0(TIOTR,WRKR5) PICK UP UCB ADDRESS                  19260018
         LA    WRKR6,0(TIOTR,WRKR5)    ADDR OF 1ST UCB                  19350018
*                                                                       19440018
         L     WRKR3,TABFLG1      PICK UP WORKAREA ADDRESS              19530018
*                                                                       19710018
************       ***********         ***********         ************ 19800018
*                                                                       19890018
*        CHECK FOR- (1) D.A. - TO BE MOUNTED IN NEXT MODULE             19980018
*                       NULLFILE - NO MOUNTING REQUIRED                 20070018
*                                                                       20160018
*                   (2) SYSIN/SYSOUT(TAPE/UNIT RECORD) - UPDATE UCB IN  20250018
*                                                        DEB            20340018
*                                                                       20430018
*                   (3) UNIT RECORD OR GRAPHIC - UPDATE UCB IN DEB      20520018
*                                                                       20610018
************       ***********         ***********         ************ 20700018
*                                                                       20790018
         TM    TABFLG1,TABDA+TABNULL+TABTCAM   DA,NULL,TCAM      Y02076 20840002
         BC    5,MNTTP070          BRANCH IF YES                        20970018
*                                                                       21060018
         ST    WRKR6,TABVLID2      STORE ADDR OF 1ST UCB                21100018
         TM    TABFLG1,TABSYS+TABUR SYSIN,SYSOUT, UR,GRAPHIC     Y02076 21150002
         BC    5,MNTTP055          BRANCH IF YES                        21240018
         TM    TABFLG2,TABRSDS     CHPT DS USED FOR RSTRT        Y02076 21290002
         BNO   MNTTP010            IF NOT, CONT WITH MOUNTING    YM7579 21300002
         L     CTABLR,RSDCB        GET RESTART'S DCB ADDR        YM7579 21310002
         L     CTABLR,DCBDEBAD     GET RESTART'S DEB ADDR        YM7579 21320002
         MVC   DEBSUCBB(D3),DEBSUCBB-DEBBASIC(CTABLR) UPDATE     YM7579 21322002
*                                  USER'S DEB UCB ADDR           YM7579 21324402
         B     MNTTP070            BYPASS MOUNT PROCESSING       YM7579 21326002
*                                                                       21330018
************   ************   ************   ************   *********** 21420018
*                                                                       21510018
*              CHECK TO SEE IF THIS VOLUME IS MOUNTED ON ANY ONE        21600018
*              OF THE ALLOCATED UCB'S IN THE NEW TIOT                   21690018
*                                                                       21780018
************   ************   ************   ************   *********** 21870018
*                                                                       21960018
MNTTP010 EQU   *                                                        22050018
         TM    SRTEDMCT,MOUNTON    IS MOUNT SW ON                       22140018
         BNO   MNTTP998            NO BRANCH                   @ZA11641 22230037
         TM    UCBFL2,NOTREADY     IS UCB NOT READY BIT ON ?   @ZA11641 22250037
         BO    MNTTP150            YES FORM CHANNEL PROGRAM    @ZA11641 22270037
MNTTP998 EQU   *                                               @ZA11641 22290037
         CLC   TABVLID1,SRTEVOLI   IS THE CORRECT VOLUME MOUNTED        22320018
         BE    MNTTP150            BRANCH TO FORM CHANNEL PROGRAM       22410018
*                                                                       22500018
         BAL   DSCNTR,MNTTP105     GO TO 'GET NEXT UCB' ROUTINE  A25775 22590019
*                                                                       22680018
         BNE   MNTTP010            NOT LAST UCB - CONDITION CODE SET    22770018
*                                  IN 'GET NEXT UCB' ROUTINE            22860018
*                                                                       22950018
*  THE VOLUME WAS NOT MOUNTED - FIND AN AVAILABLE UCB AND MOUNT THE     23040018
*  VOLUME.                                                              23130018
*                                                                       23220018
MNTTP999 EQU   *                                               @ZA11144 23260037
         LH    WRKR5,DCBTIOT       PICK UP TIOT OFFSET                  23310018
         LA    WRKR5,16(WRKR5)    DISPLACEMENT TO 1ST UCB               23400018
         L     UCBR,0(TIOTR,WRKR5) PICK UP UCB ADDRESS                  23490018
         B     MNTTP020            BRANCH TO SEE IF VOLUME MOUNTED      23580018
*                                                                       23670018
MNTTP015 EQU   *                                                        23760018
         BAL   DSCNTR,MNTTP105     GO TO 'GET NEXT UCB' ROUTINE  A25775 23850019
         BE    MNTTP135            ERROR IF LAST UCB                    23940018
*                                                                       24030018
MNTTP020 EQU   *                                                        24120018
         TM    SRTEDMCT,DMCOUNT0   DATA MANAGEMENT COUNT=0              24210018
         BC    5,MNTTP015         BRANCH IF NOT ZERO                    24300018
*                                                                       24390018
************   ************   ************   ************   *********** 24480018
*                                                                       24570018
*  DATA MANAGEMENT COUNT EQUAL ZERO REQUEST OPERATOR TO MOUNT VOLUME    24660018
*  ON THIS UCB IF UCB IS AVAILABLE. I.E. NOT PERM. RESIDENT OR RESERVED 24750018
*                                                                       24840018
************   ************   ************   ************   *********** 24930018
*                                                                       25020018
MNTTP025 EQU   *                                                        25110018
         TM    SRTESTAT,PERMRES    IS THIS DEVICE RESERVED OR           25200018
*                                  PERMANENTLY RESIDENT.                25290018
         BC    5,MNTTP015          BRANCH IF ANSWER IS YES              25380018
*                                                                       25470018
************   ************   ************   ************   *********** 25560018
*                                                                       25650018
*    VOLUME CAN BE MOUNTED ON THIS UCB PREPARE TO ISSUE MOUNT MESSAGE   25740018
*    TO OPERATOR                                                        25830018
*                                                                       25920018
************   ************   ************   ************   *********** 26010018
*                                                                       26100018
MNTTP030 EQU   *                                                        26190018
         BAL   DSCNTR,MNTTP145    FORM MOUNT MESSAGE                    26280018
         MVI   MSGID+53,RTCD28     MOVE ROUTE CODE TO MSG      @ZA07612 26330037
*                                                                       26370018
MNTTP035 EQU   *                                                        26460018
         OI    SRTEDMCT,MOUNTON    SET MOUNT SW ON                      26550018
         OI    UCBSTAB,UCBBNUL          SET DOM FLAG            ZA02205 26600037
         LA    WRKR2,MSGAREA      MESSAGE AREA ADDR IN REG. 1           26640018
*                                                                       26730018
         WTO   MF=(E,(1))          WRITE TO OPERATOR                    26820018
         ST    WRKR2,RSMWOFST      SAVE MSGID FOR DOM               MCS 26860018
         OC    UCBFSER(3),UCBFSER       ANY DOM MSGID HERE      ZA02205 26870037
         BNZ   MNTTP036                 YES MSGID HERE          ZA02205 26880037
         MVC   UCBFSER(3),RSMWOFST+1    MOVE MSGID IN           ZA02205 26890037
         XC    RSMWOFST(4),RSMWOFST     ZERO MSGID FIELD        ZA02205 26900037
         B     MNTTP037                 BRANCH AROUND           ZA02205 26902037
MNTTP036 EQU   *                                                ZA02205 26904037
         OC    UCBFSER+3(3),UCBFSER+3   ANY MSGID HERE          ZA02205 26906037
         BNZ   MNTTP037                 YES MSGID HERE          ZA02205 26908037
         MVC   UCBFSER+3(3),RSMWOFST+1  MOVE MSGID IN           ZA02205 26908437
         XC    RSMWOFST(4),RSMWOFST     ZERO MSGID FIELD        ZA02205 26908837
MNTTP037 EQU   *                                                ZA02205 26909237
*                                                                       26910018
************   ************   ************   ************   *********** 27000018
*                                                                       27090018
*        REWIND AND UNLOAD AND PREPARE TO CHECK VOLUME LABEL AFTER      27180018
*        OPERATOR MOUNTS NEW TAPE.                                      27270018
*                                                                       27360018
************   ************   ************   ************   *********** 27450018
*                                                                       27540018
MNTTP040 EQU   *                                                        27630018
         BAL   DSCNTR,MNTTP115    BUILD CCW                             27810018
         TM    UCBFL2,NOTREADY    DEVICE READY                          27930018
         BO    MNTTP045           BRANCH IF NO                          27960018
*        AFTER IPL, THE UCB NOT-READY BIT CAN BE FALSELY OFF.           27964019
*        DO NOT SET NOT-READY BIT IN THIS CASE, BECAUSE THE TAPE WILL   27968019
*        NOT GIVE A READY INTERRUPT UNTIL ENABLED BY A SIO AFTER IPL.   27972019
*        AN UNKNOWN TAPE MAY BE PHYSICALLY MOUNTED AND READY, HOWEVER.  27976019
         CLI   SRTEVOLI,X'00'      IS A VOLUME MOUNTED           A25937 27980019
         BNE   AHEAD               BR IF YES                   @ZA30100 27984032
*                                                                       27994032
         TM    TABFLG2,X'01'       FIRST PASS MOUNT SW ON ?    @ZA30100 28004032
         BNO   MNTTP045            NO BRANCH                   @ZA30100 28014032
         NI    TABFLG2,X'FE'       TURN OFF BIT                @ZA30100 28024032
*        ISSUE EXCP TO REWIND AND UNLOAD TAPE                           28080018
*                                                                       28170018
AHEAD    EQU   *                                               @ZA30100 28210032
         BAL   DSCNTR,MNTTP110     EXCP/WAIT ROUTINE                    28260018
*                                                                       28350018
         OI    UCBFL2,NOTREADY     SET UCB NOT READY BIT ON             28440018
*                                                                       28530018
MNTTP045 EQU   *                                                        28620018
         MVI   RSCCW1,REWIND       MAKE CHN PROG. OP CODE 'REWIND'      28710018
*                                                              @ZA11144 28730037
         OI    RSMWOFST,X'80'      INDICATE THAT DOM MUST BE ISSUED MCS 28750018
         BAL   DSCNTR,MNTTP110    REWIND TAPE                           28800018
*                                                                       28890018
         TM    TABTPLBL,BYPASS     BYPASS LABEL PROCESSING              28980018
         BO    MNTTP055            BRANCH IF YES                        29070018
*                                                                       29160018
************   ************   ************   ************   *********** 29250018
*                                                                       29340018
*      PREPARE TO READ IN VOLUME LABEL                                  29430018
*                                                                       29520018
************   ************   ************   ************   *********** 29610018
*                                                                       29700018
         MVI   RSCCW1,READ         MAKE CHANNEL COMMAND OP CODE READ    29790018
         MVI   RSCCW1+7,LBLLEN     MAKE LENGTH DECIMAL 80               29880018
*                                                                       29970018
************   ************   ************   ************   *********** 30060018
*                                                                       30150018
*    ISSUE EXCP TO READ IN VOLUME ID                                    30240018
*                                                                       30330018
************   ************   ************   ************   *********** 30420018
*                                                                       30510018
         OI    RSDEBOFL,RSDEBRER        SET REDUCED ERR RECOV   YA00628 30560002
         BAL   DSCNTR,MNTTP110     EXCP/WAIT ROUTINE                    30600018
         NI    RSDEBOFL,X'FF'-RSDEBRER  RESET ERR RECOV         YA00628 30650002
*                                                                       30690018
* REWIND TAPE                                                           30780018
*                                                                       30870018
         MVI   RSCCW1,REWIND       MAKE CHN PROG. OP CODE REW           30960018
         BAL   DSCNTR,MNTTP110    REWIND TAPE                           31050018
*                                                                       31140018
         TM    TABTPLBL,SL+AL           IS SL OR AL USED         S20038 31160020
         BZ    MNTTP050                 BRANCH IF NO             S20038 31180020
*                                                                       31200020
         TM    TABTPLBL,SL         STANDARD LABELS SPECIFIED            31230018
         BO    MNTTP052                 BRANCH IF YES TO COMPARE S20038 31240020
*                                       VOLID                    S20038 31250020
*                                                                       31260020
* MUST BE ASCII LABEL, SET UP TO TRANSLATE LABEL BEFORE PROCESSING      31270020
*                                                                       31280020
         LA    WRKR1,SIX                LENGTH OF VOLID          S20038 31290020
         LA    WRKR2,RSJFCB+FOUR        ADDRESS OF VOLID         S20038 31300020
*                                                                       31310020
         XLATE (1),(0),TO=E             TRANSLATE LABEL TO       S20038 31320020
*                                       EBCIDIC                  S20038 31330020
*                                                                       31340020
MNTTP052 EQU   *                                                 S20038 31350020
*                                                                       31360020
*                                                                       31410018
         CLC   TABVLID1,RSJFCB+4   IS CORRECT VOLUME MOUNTED            31500018
         BE    GOODVOL             YES COMPLETE PROCESSING     @ZA11144 31590037
*                                  FOR THE LABEL JUST READ     @ZA11144 31590137
         BAL   DSCNTR,MNTTP105     GET THE NEXT UCB FOR THIS   @ZA11144 31590237
*                                  TIOT ENTRY                  @ZA11144 31590337
         BNE   MNTTP010            BRANCH IF THERE IS ANOTHER  @ZA11144 31590437
*                                  UCB WITHIN THE TIOT         @ZA11144 31590537
         OI    TABFLG2,X'01'       SET FIRST PASS SWITCH       @ZA30100 31590632
         B     MNTTP999            VOLUME WAS NOT MOUNTED      @ZA11144 31590832
*                                  BRANCH TO FIND A UCB IN THE @ZA11144 31591032
*                                  TIOT WE CAN ISSUE MOUNT TO  @ZA11144 31591232
GOODVOL  EQU   *                                               @ZA11144 31591432
         TM    TABTPLBL,SL              STANDARD LABEL           99223  31591632
         BNO   MNTTP055                 NO.  BRANCH              99223  31592002
         CLI   UCBTBYT4,X'03'           3400 TAPE                99223  31593002
         BNE   MNTTP055                 NO.  BRANCH              99223  31594002
         L     DSCNTR,UCBEXTPT          GET UCB COMMON EXT ADDR  YM5965 31594402
         USING UCBCMEXT,DSCNTR          ADDRESS UCB COMMOM EXT   YM5965 31594902
         CLI   UCBSNSCT,24              TAPE HAVE 24 SENSE BYTS  99223  31595002
         DROP  DSCNTR                   UCB COMMON EXT           YM5965 31595402
         BNE   MNTTP055                 NO.  BRANCH              99223  31596002
*                                                                99223  31597002
         BAL   DSCNTR,MNTTP115          YES. BUILD CCW           99223  31598002
*                                                                99223  31599002
         TM    DEBOPATB,OUTP            OUTPUT FILE              99223  31600002
         BNO   MNTTP047                 NO.  PROCESS INPUT       99223  31601002
         MVI   RSCCW1,SENSE             YES. SETCCW TO OBTAIN    99223  31602002
         MVI   RSCCW1+4,SLIFLAG         SENSE BYTES  CONTAINING  99223  31603002
         MVI   RSCCW1+7,24              UNIT SERIAL NUMBER       99223  31604002
*                                                                99223  31605002
         BAL   DSCNTR,MNTTP110          EXCP/WAIT ROUTINE        99223  31606002
*                                                                99223  31607002
         L     DSCNTR,UCBXTN            GET UCB EXTENTION ADDRS  99223  31608002
         USING UCBMT,DSCNTR                                      99223  31609002
         MVC   UCBCTD,RSJFCB+15         UNIT SERIAL              99223  31610002
*                                       TO UCB EXTENTION         99223  31611002
         B     MNTTP055                 RETURN TO MAIN LINE      99223  31612002
         DROP  DSCNTR                                            99223  31613002
*                                                                99223  31614002
MNTTP047 EQU   *                                                 99223  31615002
         MVC   RSCCW3,RSCCW1            INPUT. SET CCWS          99223  31616002
         MVI   RSCCW3,READ              TO READ HDR2 WHICH       99223  31617002
         MVI   RSCCW1+4,X'40'           CONTAINS UNIT SERIAL     99223  31618002
         MVI   RSCCW1,FSROP             NUMBER OF CREATING UNIT  99223  31619002
         MVC   RSCCW2,RSCCW1            *                        99223  31620002
         BAL   DSCNTR,MNTTP110          EXCP/WAIT ROUTINE        99223  31621002
*                                                                99223  31622002
         MVI   RSCCW1,REWIND            REWIND TAPE              99223  31623002
         MVI   RSCCW1+4,X'00'           ONLY ONE CCW             99223  31624002
         BAL   DSCNTR,MNTTP110          EXCP/WAIT ROUTINE        99223  31625002
*                                                                99223  31626002
         CLC   HDR2,RSJFCB              HDR2 RECPRD OBTAINED     99223  31627002
         BNE   MNTTP055                 NO.  CONTINUE            99223  31628002
*        IF A TAPE ON A BIRCH DRIVE WAS CREATED ON A NON BIRCH  YA03211 31628102
*        DRIVE, THE UNIT SERIAL NUMBER WILL NOT BE PRESENT.     YA03211 31628202
         TM    RSJFCB+46,X'F0'          IS A SERIAL NO. PRESENT YA03211 31628402
         BNO   MNTTP055                 NO, CONTINUE            YA03211 31628802
         PACK  RSCCW3,RSJFCB+42(5)      CONVERT EBCDIC TO        99223  31629002
         CVB   WRKR6,RSCCW3             BINARY                   99223  31630002
         L     DSCNTR,UCBXTN            GET UCB EXTENTION ADDR   99223  31631002
         USING UCBMT,DSCNTR                                      99223  31632002
         STH   WRKR6,UCBCTD             STORE SERIAL NUMBER      99223  31633002
         DROP  DSCNTR                                            99223  31634002
         B     MNTTP055                 GO TO MAIN LINE          99223  31635002
MNTTP050 EQU   *                                                        31860018
         CLC   RSJFCB(4),VOL1      IS A VOLUME LABEL PRESENT            31950018
         BE    MNTTP030           BRANCH TO RE-ISSUE MOUNT MESSAGE      32040018
*                                  YES                                  32130018
         CLC   RSJFCB(FOUR),ASCIVOL     ASCII VOLUME LABEL       S20038 32140020
*                                       PRESENT                  S20038 32150020
         BE    MNTTP030                 BRANCH YES TO RE-ISSUE   S20038 32160020
*                                       MOUNT                    S20038 32170020
*                                                                       32180020
************   ************   ************   ************   *********** 32220018
*                                                                       32310018
*   UPDATE UCB - (VOL SER & DATA MANAGEMENT COUNT)                      32400018
*   MAKE THE CURRENT UCB THE 1ST UCB IN THE NEW TIOT                    32490018
*                                                                       32580018
************   ************   ************   ************   *********** 32670018
*                                                                       32760018
MNTTP055 EQU   *                                                        32850018
         LA    WRKR6,0(WRKR5,TIOTR)  ADDR OF CURRENT UCB POINTER A25937 32950019
         L     DSCNTR,TABVLID2     ADDR OF 1ST UCB IN TIOT              33120018
         MVC   0(4,WRKR6),0(DSCNTR)     1ST TO CURRENT                  33210018
         ST    UCBR,0(DSCNTR)           CURRENT TO 1ST                  33300018
         MVC   DEBSUCBB(D3),D1(DSCNTR)  UCB ADR TO DEB           Y02076 33350002
         TM    TABFLG1,TABSYS+TABUR SYSIN,SYSOUT,UR,OR GRAPHIC @ZA09631 33480037
         BZ    MNTTP060                 BR IF NOT               YM05550 33530002
         CLI   UCBTBYT4,DEV1275         IS IT 1275 OPCHRDR      YA03685 33580002
         BE    MNTTP056                 BR IF YES               YM05550 33630002
         CLI   UCBTBYT4,DEV1419         IS IT 1419 MAG CHR RDR  YA03685 33640002
         BNE   MNTTP070                 BR IF NOT               YM05550 33650002
*   1275 OPT CHAR READER AND 1419 MAG INK CHAR RDR PROCESSING   YM05550 33652002
*   UPDATE DEB TO REFLECT NEW SECONDARY CONTROL UNIT (SCU) ADR          33654002
*   DETERMINE ADR FROM UCB LOOK UP TABLE                        YM05550 33656002
MNTTP056 EQU   *                                                YM05550 33658002
         LH    WRKR2,UCBCHA             LD CHAN & DEV ADR       YM05550 33658402
         SLL   WRKR2,21                 CLEAR INDICATORS        YM05550 33658802
         SRL   WRKR2,21                 REPOS CHAN & DEV ADR    YM05550 33659202
         LA    WRKR2,1(,WRKR2)          INCR TO SCR ADR         YM05550 33659602
         L     DSCNTR,CVTPTR            LOAD CVT ADDR           YM05550 33659702
         USING CVT,DSCNTR               CVT ADDRESSABILITY      YM05550 33665702
         L     DSCNTR,CVTILK2           GET ADR UCB LU TBL      YM05550 33671902
         DROP  DSCNTR                                           YM05550 33677902
MNTTP057 EQU   *                                                YM05550 33683902
         SLR   WRKR5,WRKR5              CLEAR REG              @Z30AAHP 33693903
         ICM   WRKR5,3,0(DSCNTR)        INSERT UCB-TEST 0      @Z30AAHP 33703903
         BZ    MNTTP058                 IF FILLER BRANCH       @Z30AAHP 33713903
         CLM   WRKR5,3,=X'FFFF'         END OF TABLE?          @Z30AAHP 33723903
         BE    MNTTP131                 YES - BRANCH           @Z30AAHP 33725903
         LH    WRKR6,4(WRKR5)           LD CHAN & DEV ADR       YM05550 33729902
*                                       FROM UCB POINTED TO     YM05550 33739902
*                                       BY LOOK-UP TBL ENTRY    YM05550 33743202
         SLL   WRKR6,21                 CLEAR INDICATORS        YM05550 33745202
         SRL   WRKR6,21                 REPOS CHAN & DEV ADR    YM05550 33745602
         CR    WRKR6,WRKR2              ARE CHAN&DEV ADRS=      YM05550 33746002
         BE    MNTTP059                 BR IF YES TO UPDATE DEB YM05550 33746402
*                                       WRKR5 CONTAINS SCU ADR  YM05550 33746502
MNTTP058 EQU   *                                                YM05550 33746602
         LA    DSCNTR,2(,DSCNTR)        GET NXT LU TBL NTRY     YA03685 33754902
         B     MNTTP057                 BR TO REPEAT TESTS      YM05550 33756902
MNTTP059 EQU   *                                                YM05550 33758902
         STH   WRKR5,DEBSUCBB+5         ST SCU ADR IN           YM05550 33760902
*                                       SECOND DEB EXTENT       YM05550 33762902
         B     MNTTP070                 BR CONT PROCESSING      YM05550 33763302
*                                                                       33763402
MNTTP060 EQU   *                                                YM05550 33765402
         MVC   SRTEVOLI,TABVLID1        VOL SER TO UCB                  33771702
         MVC   UCBFSER(6),TABVLID3      1ST VOLSER OF D.S. TO    A41442 33780021
*                                       UCB                      A41442 33810021
         MVI   SRTEDMCT,ONE          SET DMCT TO ONE             Y02076 33840002
         MVC   UCBFSCT(D2),CONSTONE     SET FSCT TO 1            Y02076 33890002
         MVC   UCBFSEQ(D2),CONSTONE     SET FSEQ = 1             Y02076 33900002
*                                                                       33930018
************   ************   ************   ************   *********** 34020018
*                                                                       34110018
*         CHECK TO SEE IF AN OUTPUT FILE IS FILE PROTECTED              34200018
*         OR IF RAC PROTECTED TAPES EXIST CHECK FOR A VOLUME   @G32DSMI 34250032
*         AUTHORIZED FOR INPUT THAT WAS MOUNTED WITH THE RING. @G32DSMI 34270032
*                                                                       34290018
************   ************   ************   ************   *********** 34380018
*                                                                       34470018
         BAL   DSCNTR,MNTTP115    BUILD CCW                             34560018
         L     WRKR2,CVTPTR             CVT ADDRESSABILITY     @G32DSMI 34610032
         USING CVT,WRKR2                                       @G32DSMI 34615032
         L     WRKR2,CVTRAC             RACF CVT ADDRESSABILITY@G32DSMI 34620032
         LTR   WRKR2,WRKR2              RACF ACTIVE            @G32DSMI 34621032
         BZ    MNTRAC00                 BYPASS RACF TAPE TEST  @G32DSMI 34622032
         USING RCVT,WRKR2                                      @G32DSMI 34625032
         TM    RCVTSTA1,RCVTTAPE        TAPE PROTECTION ACTIVE @G32DSMI 34630032
         BO    MNTRAC01                 YES - RACHECK NEEDED   @G32DSMI 34635032
         DROP  WRKR2                                           @G32DSMI 34640032
MNTRAC00 EQU   *                                               @G32DSMI 34645032
*                                                                       34650018
         TM    DEBOPATB,OUTP       OUTPUT PROCESSING                    34740018
         BC    12,MNTTP070        BRANCH IF NO                          34830018
*                                                                       34920018
MNTRAC01 EQU   *                        CHECK FILE PROTECTION  @G32DSMI 34970032
         MVI   RSCCW1,SENSE        MAKE CHANNEL PROGRAM A SENSE OP      35010018
         MVI   RSCCW1+7,SRCHCNT    MAKE LENGTH 5                        35100018
         MVI   RSCCW1+4,SLIFLAG    SUPPRESS WRONG LENGTH RECORD         35190018
*                                                                       35280018
************   ************   ************   ************   *********** 35370018
*                                                                       35460018
*                   ISSUE EXCP TO SENSE FOR FILE PROTECT                35550018
*                                                                       35640018
************   ************   ************   ************   *********** 35730018
*                                                                       35820018
         BAL   DSCNTR,MNTTP110     EXCP/WAIT ROUTINE                    35910018
*                                                                       36000018
         TM    RSJFCB+1,FILEPROT   IS VOLUME FILE PROTECTED             36090018
         BZ    MNTRAC10                 NOT FILE PROTECTED     @G32DSMI 36180032
         TM    DEBOPATB,OUTP            OPEN FOR OUTPUT        @G32DSMI 36184032
         BO    MNTRAC20                 YES-PERFORM MOUNT WITH @G32DSMI 36188032
*                                       RING                   @G32DSMI 36192032
         BAL   DSCNTR,RACINPUT          NO-INPUT CHECK RAC     @G32DSMI 36196032
*                                       AUTHORIZATION          @G32DSMI 36200032
         B     MNTTP070                 AUTHORIZED-CONTINUE    @G32DSMI 36204032
MNTRAC10 EQU   *                        NOT FILE PROTECTED     @G32DSMI 36208032
         BAL   DSCNTR,RACOUTPT          CHECK OUTPUT           @G32DSMI 36212032
*                                       AUTHORIZATION          @G32DSMI 36216032
         B     MNTTP070                 AUTHORIZED CONTINUE    @G32DSMI 36220032
MNTRAC20 EQU   *                        MOUNT WITH RING        @G32DSMI 36260032
*                                                                       36270018
************   ************   ************   ************   *********** 36360018
*                                                                       36450018
*   OUTPUT VOLUME IS FILE PROTECT DETERMINE WHAT ACTION TO TAKE         36540018
*                                                                       36630018
************   ************   ************   ************   *********** 36720018
*                                                                       36810018
         BAL   DSCNTR,MNTTP145    FORMAT MOUNT MESSAGE                  36900018
*                                                                       36990018
         TM    DEBOPATB,INOUT      IS DATA SET OPEN FOR 'INOUT'         37080018
         MVC   MSGAREA+NINE(FOUR),FPMSG1 FILE PROTECT MSG TO     S20038 37120020
*                                       WRITE ARE                S20038 37160020
         MVI   MSGID+53,RTCD20     MOVE ROUTE CODE TO MSG      @ZA07612 37210037
         BC    5,MNTTP035         BRANCH NOT INOUT - WRITE MESSAGE TO   37260018
*                                  OPERATOR INFORMING HIM THAT VOLUME   37350018
*                                  IS FILE PROTECTED, AND REISSUE       37440018
*                                  MOUNT MESSAGE.                       37530018
*                                                                       37620018
************   ************   ************   ************   *********** 37710018
*                                                                       37800018
*   A DATA SET OPENED FOR 'INOUT' IS ON A FILE PROTECTED VOLUME, CHECK  37890018
*   TO SEE IF VOLUME SHOULD BE USED - THAT IS - WRITE TO OPERATOR WITH  37980018
*   A REPLY                                                             38070018
*                                                                       38160018
************   ************   ************   ************   *********** 38250018
*                                                                       38340018
         MVC   MSGAREA+NINE(TWO),FPMSG2 FILE PROTECT MSG2 TO     S20038 38490020
*                                       WRITE ARE                S20038 38550020
         LA    WRKR6,REPLY              PICK UP REPLY ADDRESS           38610018
         ST    WRKR6,REPLYLTH           STORE REPLY ADDRESS             38700018
         MVI   REPLYLTH,ONE        REPLY LENGTH                         38790018
         LA    WRKR6,RSECBAD       PICK UP ECB ADDRESS                  38880018
         ST    WRKR6,REPLYECB           STORE ECB ADDRESS               38970018
         MVI   MSGID+53,RTCDA0     MOVE ROUTE CODE TO MESSAGE  @ZA07612 39100037
*                                                                       39150018
MNTTP065 EQU   *                                                        39240018
         MVI   RSECBAD,COMPCODE    RESET COMPLETION FLAG IN ECB         39330018
         LA    WRKR2,REPLYLTH           MESSAGE BUFFER AREA             39420018
*                                                                       39510018
         WTOR  MF=(E,(1))               WRITE TO OPERATOR               39600018
*                                                                       39690018
*                   WAIT FOR OPERATOR'S REPLY                           39780018
*                                                                       39870018
         WAIT  ,ECB=RSECBAD        WAIT                         YM05548 39960002
*                                                                       40050018
         CLI   REPLY,RINGIN        OPERATOR WILL INSERT FILE PROT RING  40140018
         BE    MNTTP040            BRANCH IF YES                        40230018
*                                                                       40320018
         CLI   REPLY,USED          SHOULD VOLUME BE USED                40410018
         BNE   MNTTP065            NO, REISSUE MOUNT MESSAGE            40500018
*                                  USE VOLUME - CONTINUE                40590018
*                                                                       40680018
*   CHECK IF USER AUTHORIZED FOR INPUT                         @G32DSMI 40680832
         L     DSCNTR,CVTPTR            CVT                    @G32DSMI 40690832
         L     DSCNTR,CVTRAC-CVT(DSCNTR) RAC CVT               @G32DSMI 40700832
         TM    RCVTSTA1-RCVT(DSCNTR),RCVTTAPE IS TAPE          @G32DSMI 40710832
*                                       PROTECTION ACTIVE      @G32DSMI 40720832
         BZ    MNTTP070                 NO-CONTINUE            @G32DSMI 40730832
         BAL   DSCNTR,RACINPUT          CHECK AUTHORIZATION    @G32DSMI 40740832
************   ************   ************   ************   *********** 40770018
*                                                                       40860018
*              DETERMINE IF WE ARE COMING FROM THE NONSTANDARD LABEL    40950018
*              ROUTINE.                                                 41040018
*                                                                       41130018
************   ************   ************   ************   *********** 41220018
*                                                                       41310018
MNTTP070 EQU   *                                                        41400018
         TM    RSDCBFLG,NSLFLAG    ARE WE COMING FROM NSL RTN           41490018
         BO    MNTTP077            BRANCH IF YES                 A25997 41580019
*                                                                       41670018
* INCREMENT TO NEXT TABLE ENTRY-IF NOT LAST CONTINUE PROCESSING-IF LAST 41760018
* ENTRY GO TO  -  NSL PROCESSING -                                      41850018
*                                                                       41940018
         TM    TABFLG1,TABLAST     IS THIS THE LAST ENTRY               42030002
         LA    WRKR4,TABENT(WRKR4) INCREMENT TO NEXT ENTRY              42120018
         BZ    MNTTP005            BRANCH IF NOT LAST ENTRY             42210018
*                                                                       42300018
************   ************   ************   ************   *********** 42390018
*                                                                       42480018
*  AT THIS POINT ALL TAPE ENTRIES IN THE TABLE HAVE BEEN PROCESSED.     42570018
*  WE WILL NOW SPIN THRU THE TABLE TO SEE IF THERE ARE ANY NSL TAPE     42660018
*  ENTRIES. IF THERE ARE WE WILL EXIT TO THE USER'S NONSTANDARD         42750018
*  LABEL PROCESSING ROUTINE FOR EACH NONSTANDARD LABEL ENTRY.           42840018
*                                                                       42930018
*  THE USER IS PASSED A POINTER TO THE TABLE. EACH ENTRY IN THE TABLE   43020018
*  CONTAINS A POINTER TO A DCB AND ALSO TO A CONTROL BLOCK AREA.        43110018
*  THE FORMAT OF THE TABLE ENTRIES AND THE CONTROL BLOCK AREA ARE       43200018
*  CONTAINED IN A DSECT AT THE END OF THIS PROGRAM.                     43290018
*                                                                       43380018
************   ************   ************   ************   *********** 43470018
*                                                                       43560018
         LR    WRKR4,TABLR         TABLE ADDRESS TO WRKR4               43650018
MNTTP072 EQU   *                                                        43830018
         TM    TABFLG1,TABTAPE          IS THIS A TAPE DEVICE    A46376 43860002
         BZ    MNTTP090           IF NOT, BRANCH                 A35767 43890020
         TM    TABTPLBL,NSL        NONSTANDARD LABEL SPECIFIED          43920018
         BZ    MNTTP087            BRANCH IF NO                @ZA18506 44010037
         B     MNTTP077            BRANCH TO READ JFCB                  44050018
*                                                                       44100018
************   ************   ************   ************   *********** 44190018
*                                                                       44280018
*  PREPARE TO READ IN THE JFCB FOR THIS NONSTANDARD TAPE LABEL ENTRY    44370018
*                                                                       44460018
* WHEN THIS MODULE RECEIVED CONTROL THE CONTROL BLOCKS IN THE WORKAREA  44550018
* WERE SET UP TO READ IN A JFCB. HOWEVER IN ORDER TO READ IN THE TAPE   44640018
* LABEL AND REWIND THE TAPE IT WAS NECESSARY TO ALTER THE FIELDS IN THE 44730018
*WORKAREA. NOW THAT WE WANT TO READ IN THE JFCB WE MUST RESTORE THE     44820018
*FIELDS.                                                                44910018
*                                                                       45000018
************   ************   ************   ************   *********** 45090018
*                                                                       45180018
MNTTP075 EQU   *                                                        45270018
         L     WRKR3,TABFLG1       LOAD WORK AREA ADDRESS-POINTS TO DEB 45360018
         LA    DEBR,RSBUFSEG        SAVE DATA ADDRESS                   45450018
         ICM   WRKR2,ALLBYTS,QMNPRMWA   GET QMNGR PARM LIST ADDR YM5965 45500002
         BNZ   MNTTP073            BRANCH IF PARM ADDR NON-ZERO  YM5965 45501202
*********************************************************************** 45502002
*   GET SPACE FOR QMNGRIO PARAMETER LIST AND WORK AREA THE INITIALIZE * 45504002
*   IT.  QMNGRIO IS USED TO READ IN THE JFCB FROM SCHEDULER WORK      * 45506002
*   AREA (SWA) FOR EACH NON STANDARD LABEL (NSL) DATA SET ENTRY.      * 45508002
*********************************************************************** 45508402
         ICM   WRKR1,ADDRBYTS,QMNGWALN  SET QMNGR P.L.+W.A.LGTH  YM5965 45508802
         ICM   WRKR1,HIORDER,SP253      SUBPOOL 253              YM5965 45509202
         GETMAIN  R,LV=(0)              ISSUE GETMAIN            YM5965 45509602
         USING QMIOP,WRKR2                                       YM5965 45509702
         XC    QMITCBAD(D24),QMITCBAD   CLEAR PARM LIST          YM5965 45509802
         LA    WRKR1,QMWAOFST           GET WORK AREA OFFSET     YM5965 45509902
         AR    WRKR1,WRKR2              CALC ADDR OF WORK AREA   YM5965 45559902
         ST    WRKR1,QMIWRKAD           STORE IN PARM LIST       YM5965 45569902
         L     WRKR1,RSTCBAD            GET TCB ADDR             YM5965 45579902
         ST    WRKR1,QMITCBAD           STORE TCB ADR IN PRM LST YM5965 45589902
         LA    WRKR1,JFCBLNGH           GET LENGTH OF JFCB       YM5965 45599902
         STH   WRKR1,QMIRECL            STORE REC LNGTH IN P.L.  YM5965 45601902
         MVI   QMIFLAGS,QMIOREAD        SET READ FUNCTION        YM5965 45603902
         ST    WRKR2,QMNPRMWA           SAVE PARM LIST ADDR      YM5965 45605902
*                                                                       45607902
MNTTP073 EQU   *                                                 YM5965 45608302
         ST    DEBR,QMIRECAD            STORE JFCB READ IN ADR   Y02076 45609902
         L     WRKR1,TABVLID5+2   LOAD TTR INTO REG. 0                  46460018
         TM    TABFLG2,TABG5V      MORE THAN 5 VOLUMES                  46480002
         BO    MNTTP076           BRANCH IF YES                         46500018
*                                                                       46520018
         L     WRKR1,TABNVOLS     JFCB TTR-LOAD                         46540018
*                                                                       46560018
MNTTP076 EQU   *                                                        46580018
*                                                                       46600018
         SLL   WRKR1,8             LEFT JUSTIFY TTR                     46620018
         ST    WRKR1,QMIDSKAD           STORE TTR IN PARM LST    Y02076 46670002
         STM   WRKR4,WRKR5,RSERAS01     SAVE REGS ACROSS QMNGRIO YM5965 46672002
         LA    WRKR4,RSREGSAV           POINT TO SAVE AREA       YM5965 46674002
*                                       FOR QMNGRIO              YM5965 46676002
         QMNGRIO                        READ IN JFCB             Y02076 46680002
         LM    WRKR4,WRKR5,RSERAS01     RESTORE REGISTERS        YM5965 46682002
         LTR   WRKR6,WRKR6              TEST QMNGRIO RET. CODE   Y02076 46690002
         BNZ   MNTTP120                 ERR-BR TO SET CODE-EXIT  Y02076 46700002
         L     CTABLR,TABDCBAD-1   LOAD DCB ADDRESS                     47970018
         L     DEBR,DCBDEBAD      LOAD DEB ADDRESS                      48060018
         BR    TCBR                RETURN                               48070018
*                                                                       48080018
*********      **********     **********     **********     *********** 48090018
*                                                                       48100018
MNTTP077 EQU   *                                                        48110018
*                                                                       48120018
         BAL   TCBR,MNTTP075       READ IN JFCB                         48130018
*                                                                       48140018
         L     UCBR,DEBSUCBA            LOAD UCB ADDRESS         Y02076 48190002
         MVC   RSDEBUCB(D4),DEBSUCBA    UCB ADR TO WORKAREA(DEB) Y02076 48240002
*                                                                       48330018
************   ************   ************   ************   *********** 48420018
*                                                                       48510018
*               TRANSFER CONTROL TO USER'S NONSTANDARD LABEL ROUTINE    48600018
*                                                                       48690018
************   ************   ************   ************   *********** 48780018
*                                                                       48870018
MNTTP080 EQU   *                                                        48960018
         OI    RSDCBFLG,NSLFLAG    TURN ON NSL ENTRY INDICATOR          49140018
         LR    CTABLR,WRKR4        TABLE ADDRESS TO REG. 9              49230018
         MVC   TABVLID1+10(8),NAMENSL                                   49320018
         LA    WRKR6,TABVLID1+18                                        49410018
*                                                                       49500018
         XCTL  EPLOC=TABVLID1+10,SF=(E,(15))                            49590018
*                                                                       49680018
************   ************   ************   ************   *********** 49770018
*                                                                       49860018
*                   NONSTANDARD LABEL PROCESSING ROUTINE.               49950018
*                                                                       50040018
************   ************   ************   ************   *********** 50130018
*                                                                       50220018
MNTTP085 EQU   *                                                        50310018
         TM    TABTPLBL,ERRINNSL   DID AN ERROR OCCUR IN NSL ROUTINE    50400018
         BO    MNTTP125       BRANCH IF YES                             50490018
*                                                                       50580018
         TM    SRTEDMCT,MOUNTON    WAS CORRECT VOLUME MOUNTED           50670018
         BZ    MNTTP087           BRANCH IF CORRECT VOL        @ZA18506 50760037
*                                                                       50810037
         NI    SRTEDMCT,MOUNTOFF   MOUNT SW OFF - DATA MANG. COUNT TO 0 50860037
         XC    SRTEVOLI+1(5),SRTEVOLI+1 CLEAR 5 BYTES OF VOL SER M3946  50910037
         B     MNTTP005           BRANCH - INCORRECT VOLUME MOUNTED     50960037
*                                                              @ZA18506 51010037
MNTTP087 EQU   *                  TEST DEQ-AT-DISMOUNT         @ZA18506 51060037
*                                                              @ZA18506 51110037
         BAL   DSCNTR,MNTTP118    TEST DEQ STATUS              @ZA18506 51160037
*                                                              @ZA18506 51210037
************   ************   ************   ************   *********** 51300018
*                                                                       51390018
*              CHECK FOR LAST ENTRY DOING NONSTANDARD LABEL PROCESSING  51480018
*                                                                       51570018
************   ************   ************   ************   *********** 51660018
*                                                                       51750018
MNTTP090 EQU   *                                                        51840018
         TM    TABFLG1,TABLAST     LAST TABLE ENTRY                     51930002
         LA    WRKR4,TABENT(WRKR4) INCREMENT TO NEXT ENTRY              52020018
         BZ    MNTTP072            BRANCH IF NOT LAST ENTRY             52110018
*                                                                       52200018
************   ************   ************   ************   *********** 52290018
*                                                                       52380018
*                   PREPARE TO EXIT TO NEXT MOD                         52470018
*                                                                       52560018
************   ************   ************   ************   *********** 52650018
*                                                                       52740018
MNTTP095 EQU   *                                                        52830018
         ICM   WRKR1,ADDRBYTS,QMNGWALN  SET UP FREEMAIN PARMS    Y02076 52880002
         ICM   WRKR1,HIORDER,SP253      SUBPOOL 253              Y02076 52930002
         ICM   WRKR2,ALLBYTS,QMNPRMWA   GET ADR OF QMNGRIO P.L.  YM5965 52980002
         BZ    MNTTP096                 BRANCH IF ADDR IS ZERO   YM5965 52990002
         FREEMAIN  R,LV=(0),A=(1)       ISSUE FREEMAIN           Y02076 53030002
MNTTP096 EQU   *                                                 YM5965 53080002
         TM    RSDCBFLG,DAFLAG     WAS A DA DATA SET PROCESSED          53100018
         BO    MNTTP100            BRANCH TO GET WORKAREA FOR XCTL      53190018
*                                                                       53280018
         MVI   RSPPM+4,C'L'        XCTL TO IGC0L05B                 MCS 53370018
*                                                                       53460018
MNTTP100 EQU   *                                                        53550018
*                                                                YM7890 53600002
*        AT THIS POINT, WITH ALL MOUNT REQUESTS SATISFIED, THE   YM7890 53610002
*        MEMORY CAN AGAIN BE ENABLED FOR SWAP-OUT.               YM7890 53620002
*                                                                YM7890 53630002
         SYSEVENT OKSWAP           ENABLE SWAP-OUT               YM7890 53632002
*                                                                YM7890 53634002
         LA    WRKR6,RSPPM+8                                        MCS 53640018
*******************   **************   ***********   *********   ****   53730018
         LR    WRKR2,BUFR         POINT REG. 1 TO THE RESTART W/A       53820018
*******************   **************   ***********   *********   ****   53910018
*                                                                       54000018
         NI    RSDCBFLG,X'FF'-NSLFLAG                            A50338 54050000
*                                 TURN OFF NSL RETURN IND.       A50338 54060000
         XCTL  EPLOC=RSPPM,SF=(E,(15))                              MCS 54090018
*                                                                       54180018
************   ************   ************   ************   *********** 54270018
*                                                                       54360018
* INCREMENTS POINTER TO NEXT UCB IN TIOT & CHECKS FOR LAST ENTRY        54450018
*                                                                       54540018
************   ************   ************   ************   *********** 54630018
*                                                                       54720018
MNTTP105 EQU   *                                                        54810018
         LA    WRKR5,4(WRKR5)      INCREMENT TO NEXT DDNAME             54900018
         LH    DCBR,DCBTIOT       LOAD TIOT OFFSET                      54990018
         SR    WRKR6,WRKR6        CLEAR REGISTER                        55080018
         IC    WRKR6,0(TIOTR,DCBR) PICK UP LENGTH OF DD ENTRY           55170018
         AR    DCBR,TIOTR                                               55260018
         AR    DCBR,WRKR6         DCBR POINTS TO END OF DD ENTRY        55350018
         LA    WRKR6,0(TIOTR,WRKR5)  CURRENT UCB ADDRESS PLUS 4         55440018
         CR    DCBR,WRKR6         END OF DD ENTRY                       55530018
         L     UCBR,0(TIOTR,WRKR5) PICK UP UCB ADDRESS                  55620018
         BR    DSCNTR              RETURN                        A25775 55710019
*                                                                       55800018
************   ************   ************   ************   *********** 55890018
*                                                                       55980018
*                EXCP ROUTINE - RETURN ON REGISTER 15                   56070018
*                                                                       56160018
************   ************   ************   ************   *********** 56250018
*                                                                       56340018
MNTTP110 EQU   *                                                        56430018
         EXCP  RSIOB               EXCP CHANNEL PROGRAM                 56520018
*                                                                       56610018
         WAIT  ,ECB=RSECBAD       WAIT                                  56700018
         TM    RSMWOFST,X'80'      MUST A DOM BE ISSUED             MCS 56710018
         BZ    TESTERR                  BRANCH IF NO                MCS 56720037
         LA    WRKR2,RSREGSAV+12        GET ADDRESS OF DOM LIST ZA02206 56730037
         XC    RSREGSAV+12(12),RSREGSAV+12  ZERO 3 WORDS        ZA02206 56734037
         OC    RSREGSAV+13(3),UCBFSER   MOVE MSGID              ZA02206 56736037
         BZ    MNTTP900                 NO MAGID                ZA02206 56738837
         LA    WRKR2,4(WRKR2)           NEXT MSGID FIELD        ZA02206 56739237
MNTTP900 EQU   *                                                ZA02206 56739637
         OC    1(3,WRKR2),UCBFSER+3      MOVE SECOND MSGID      ZA02206 56739737
         BZ    MNTTP901                 NO MSID                 ZA02206 56739837
         LA    WRKR2,4(WRKR2)           NEXT MSGID FIELD        ZA02206 56739937
MNTTP901 EQU   *                                                ZA02206 56743237
         OC    1(3,WRKR2),RSMWOFST+1      MOVE IN ID            ZA02206 56745237
         BZ    MNTTP902                 NO MSGID                ZA02206 56747237
         LA    WRKR2,4(WRKR2)           NEXT MSGID              ZA02206 56747637
MNTTP902 EQU   *                                                ZA02206 56749237
         LA    WRKR1,4                                          ZA0206  56749637
         SR    WRKR2,WRKR1              MOVE BACK 4 BYTES       ZA02206 56749737
         MVI   0(WRKR2),X'80'           END OF DOM LIST FLAG    ZA02206 56749837
         LA    WRKR2,RSREGSAV+12        ADDR OF FIRST MSGID     ZA02206 56749937
         DOM   MSGLIST=(1)                                          MCS 56750037
         XC    RSMWOFST(4),RSMWOFST      ZERO MSGID DOM         ZA02206 56752037
         XC    UCBFSER(6),UCBFSER       ZERO MSGID              ZA02206 56754037
         NI    UCBSTAB,X'FF'-UCBBNUL    ZERO MSGID BIT          ZA02206 56756037
TESTERR  EQU   *                                                    MCS 56760018
*                                                                       56790018
         TM    RSECBAD,PERMERR     I/O ERROR                            56880018
         BCR   1,DSCNTR                 NO BRANCH                       56970018
         CLI   RSCCW1,SEARCH       READING IN JFCB                      57000018
         BE    MNTTP120       BRANCH IF YES                             57030018
         CLI   RSECBAD,INTECEPT         TST FOR INTERCEPT       YM05549 57040002
         BNE   MNTTP112                 BR IF NOT               YM05549 57050002
         CLI   RSCCW1,REWIND            REWIND COMMAND          YM05549 57052002
         BE    MNTTP110                 YES-REISSUE REWIND      YM05549 57054002
         B     MNTTP130                 NO-BR TO ERR RTN        YM05549 57056002
MNTTP112 EQU   *                                                YM05549 57058002
*                                                                       57060018
         TM    TABTPLBL,SL         STANDARD LABELS                      57150018
         BCR   8,DSCNTR                 NO  BRANCH                      57240018
*                                                                       57330018
         TM    RSIOBCSW+4,UNITCHK  UNIT CHECK                           57420018
         BO    MNTTP130            YES BRANCH PERM I/O ERROR            57510018
*                                                                       57600018
         TM    RSIOBCSW+5,WRONGLEN WRONG LENGTH RECORD                  57690018
         BZ    MNTTP130            NO BRANCH PERM I/O ERROR             57780018
*                                                                       57870018
         TM    RSIOBCSW+4,UNITEXP       TAPE MARK FOUND?        ZA01325 57870502
         BNO   MNTTP130                 NO BRANCH               ZA01325 57871002
         CLI   RSCCW1,CCWFSR            FORWARD SPACE CMD?      ZA01325 57871502
         BNE   MNTTP130                 NO BRANCH               ZA01325 57872002
         MVI   RSCCW1,REWIND            REWIND TAPE CMD         ZA01325 57872502
         MVI   RSCCW1+4,X'00'           ONLY ONE CCW            ZA01325 57873002
         LA    DSCNTR,MNTTP055          RETURN ADDR FROM REWIND ZA01325 57873502
         B     MNTTP110                 GO REWIND THE TAPE      ZA01325 57874002
*                                                                       58050018
************   ************   ************   ************   *********** 58140018
*                                                                       58230018
*      FORM CCW & PLACE UNIT ADDRESS IN DEB                             58320018
*                                                                       58410018
************   ************   ************   ************   *********** 58500018
*                                                                       58590018
MNTTP115 EQU   *                                                        58680018
         ST    UCBR,RSDEBUCB  PLACE UCB ADDRESS IN DEB                  58770018
         MVC   RSDEBUCB(D1),DEBSDVM     SET MODE CODE            Y02076 58820002
         TM    RSDEBUCB,MODECLR         IS THIS NINE TRACK       99223  58821002
         BO    MNTTP116                 YES. BRANCH              99223  58822002
         NI    RSDEBUCB,MODECLR    CLEAR ALL BUT DENSITY                58950018
         OI    RSDEBUCB,SETMODE    SET EVEN PAR.,TRANS MODE,CONVERT OFF 59040018
MNTTP116 EQU   *                                                  99223 59041002
         LA    TCBR,X'50'              SET CCW BYTE COUNT        A40520 59070021
         ST    TCBR,RSCCW1+4                                     A40520 59100021
         LA    TCBR,RSJFCB        LOAD DATA AREA ADDRESS                59220018
         ST    TCBR,RSCCW1        DATA AREA ADDRESS TO CHANNEL PROGRAM  59310018
         MVI   RSCCW1,X'0F'            SET REWIND - UNLOAD       A40520 59340021
*                                       COMMAND                  A40520 59370021
         BR    DSCNTR             RETURN                                59400018
         EJECT                                                          59401037
*                                                                       59402037
************   ************   ************   ************   *********** 59403037
*  TEST IF DEQ AT DISMOUNT FACILITY WERE ACTIVE AND CAN BE     @ZA18506 59404037
*  REESTABLISHED. IF SO, DEQ ALL VOLUME SERIALS UP TO BUT NOT  @ZA18506 59405037
*  INCLUDING THE ONE TO WHICH THE DCB IS NOW OPEN.             @ZA18506 59406037
************   ************   ************   ************   *********** 59407037
*                                                              @ZA18506 59408037
MNTTP118 EQU   *                  CHECK FOR DEQ                @ZA18506 59409037
*                                                              @ZA18506 59410037
         TM    TABFLG1,TABTAPE    IS THIS A TAPE               @ZA18506 59411037
         BZR   DSCNTR             RETURN IF NO                 @ZA18506 59412037
         LA    TCBR,TABJFCB       JFCB TTR IF LESS THAN OR     @ZA18506*59413037
                                  EQUAL TO 5 VOLUMES           @ZA18506 59414037
         TM    TABFLG2,TABG5V     ARE THERE 5 VOLUMES          @ZA18506 59415037
         BZ    MNTTP12A           BRANCH IF NOT 5              @ZA18506 59416037
         LA    TCBR,TABVLID5+D3   JFCBTTR IF 5 VOLUMES         @ZA18506 59417037
*                                                              @ZA18506 59418037
MNTTP12A EQU   *                  LOCATE JFCB                  @ZA18506 59419037
*                                                              @ZA18506 59420037
         IECRES LOCJFCB,(TCBR)    GET JFCB ADDR IN TCBR        @ZA18506 59421037
         TM    JFCBFLG3-INFMJFCB(TCBR),JFCDQDSP WAS THE DEQ    @ZA18506*59422037
                                  FACILITY IN USE              @ZA18506 59423037
         BZR   DSCNTR             RETURN IF NOT                @ZA18506 59424037
         L     CTABLR,TABDCBAD-D1 DCB                          @ZA18506 59425037
         L     DEBR,DCBDEBAD      DEB                          @ZA18506 59426037
         TM    DEBOPATB,OUTP      OUTPUT TAPE                  @ZA18506 59427037
         BNOR  DSCNTR             RETURN IF INPUT/RDBACK       @ZA18506 59428037
*                                                              @ZA18506 59429037
         TESTAUTH FCTN=1          APF AUTHORIZED               @ZA18506 59430037
*                                                              @ZA18506 59431037
         LTR   WRKR6,WRKR6        ZERO IF AUTHORIZED           @ZA18506 59432037
         BNZR  DSCNTR             RETURN IF NOT AUTHORIZED     @ZA18506 59433037
*                                                              @ZA18506 59434037
*  RESTORE DEQ AT DISMOUNT FACILITY ENVIRONMENT.               @ZA18506 59435037
*  SET UCBDQDSP IN CURRENT VOLUME AND DEQ ALL VOLUME SERIALS   @ZA18506 59436037
*  IN THE JFCB AND JFCBX'S UP TO DEBVOLSQ'S VOLUME.            @ZA18506 59437037
*                                                              @ZA18506 59438037
         L     UCBR,DEBSUCBA      UCB OF CURRENT VOLUME        @ZA18506 59439037
         OI    UCBTFL1,UCBDQDSP   RESET DEQ STATUS             @ZA18506 59440037
*                                                              @ZA18506 59441037
*  SET UP FOR DOUBLE LOOP                                      @ZA18506 59442037
*    DEBR - NUMBER OF VOLUMES TO BE DEQED                      @ZA18506 59443037
*    WRKR3 - NUMBER OF VOLUMES IN JFCB(5) OR JFCBX(15)         @ZA18506 59444037
*    DCBR - ADDRESS OF NEXT JFCBX'S TTR                        @ZA18506 59445037
*    UCBR - ADDRESS OF VOLUME TO DEQ                           @ZA18506 59446037
*    TCBR - ADDRESS OF INITIATOR TCB                           @ZA18506 59447037
*                                                              @ZA18506 59448037
         LA    UCBR,DEBSUCBA+L'DEBSUCBA ACCESS METHOD SECTION  @ZA18506 59449037
         SR    DEBR,DEBR          ZERO FOR IC                  @ZA18506 59450037
         IC    DEBR,DEBVOLSQ-DEBACSMD+D1(UCBR) VOLUME SEQUENCE @ZA18506 59451037
         CH    DEBR,CONSTONE      RESTART ON FIRST VOLUME      @ZA18506 59452037
         BER   DSCNTR             RETURN IF NONE TO DEQ        @ZA18506 59453037
         BCTR  DEBR,0             NUMBER OF VOLUMES TO DEQ     @ZA18506 59454037
         LA    DCBR,JFCBEXAD-INFMJFCB(TCBR) ADDR OF JFCBX TTR  @ZA18506 59455037
         LA    WRKR3,L'JFCBVOLS/L'UCBVOLI NUMBER OF JFCB VOLS  @ZA18506 59456037
         LA    UCBR,JFCBVOLS-INFMJFCB(TCBR) FIRST VOLUME       @ZA18506 59457037
         L     TCBR,RSTCBAD       TCB                          @ZA18506 59458037
         USING TCB,TCBR                                        @ZA18506 59459032
         L     TCBR,TCBJSCB       JSCB                         @ZA18506 59459232
         DROP  TCBR                                            @ZA18506 59459432
         L     TCBR,JSCBTCBP-IEZJSCB(TCBR) INITIATOR TCB       @ZA18506 59460037
         MVC   DEQPLIST,DEQLIST   MOVE LIST FOR DEQ            @ZA18506 59461037
*                                                              @ZA18506 59462037
MNTTP12C EQU   *                  LOOP FOR JFCB AND EACH JFCBX @ZA18506 59463037
*                                                              @ZA18506 59464037
MNTTP12E EQU   *                  LOOP FOR EACH VOLUME         @ZA18506 59465037
*                                                              @ZA18506 59466037
         DEQ   (,(UCBR)),TCB=(TCBR),RET=HAVE,MF=(E,DEQ) DEQ    @ZA18506 59467037
         BCT   DEBR,MNTTP12G      BRANCH IF MORE VOLUMES LEFT  @ZA18506 59468037
*                                                              @ZA18506 59469037
         BR    DSCNTR             RETURN IF NO MORE VOLUMES    @ZA18506 59470037
*                                                              @ZA18506 59471037
MNTTP12G EQU   *                  MORE VOLUMES LEFT TO DEQ     @ZA18506 59472037
*                                                              @ZA18506 59473037
         LA    UCBR,L'UCBVOLI(,UCBR) INCREMENT TO NEXT VOLSER  @ZA18506 59474037
         BCT   WRKR3,MNTTP12E     BR IF MORE VOLS IN JFCB(X)   @ZA18506 59475037
         IECRES LOCJFCB,(DCBR)    GET NEXT JFCBX               @ZA18506 59476037
         LA    UCBR,JFCBXVOL-JFCBX(,DCBR) ADDR OF FIRST VOLSER @ZA18506 59477037
         LA    DCBR,JFCBXTTR-JFCBX(,DCBR) NEXT JFCBX TTR ADDR  @ZA18506 59478037
         LA    WRKR3,D15          NUMBER OF VOLSERS IN JFCBX   @ZA18506 59479037
         B     MNTTP12C           BR TO DEQ VOLS IN JFCBX      @ZA18506 59480037
         EJECT                                                          59481037
*                                                                       59490018
************   ************   ************   ************   *********** 59580018
*                                                                       59670018
*                   ERROR RETURN CODES                                  59760018
*                                                                       59850018
************   ************   ************   ************   *********** 59940018
*                                                                       60030018
MNTTP120 EQU   *                                                        60120018
*                                                                       60210018
         MVI   RSRETCOD+1,ERR026   26 ERROR READING IN JFCB    @ZSUT222 60300032
         B     MNTTP140            BRANCH TO XCTL                       60350032
*                                                                       60400032
MNTTP125 EQU   *                                                        60450032
         MVI   RSRETCOD+1,ERR030   30 I/O ERROR IN NSL ROUTINE @ZSUT222 60500032
         B     MNTTP140            BRANCH TO XCTL                       60550032
*                                                                       60600032
MNTTP130 EQU   *                                                        60650032
         MVI   RSRETCOD+1,ERR040   40 ERROR IN READ VOL LABEL  @ZSUT222 60700032
         B     MNTTP140            BRANCH TO XCTL                       60750032
*                                                                       60800032
MNTTP131 EQU   *                                                YM05550 60850032
         MVI   RSRETCOD+1,ERR046        NO SCU ERROR           @ZSUT222 60900032
         B     MNTTP140                 BR TO XCTL              YM05550 60950032
*                                                                       61000032
MNTTP135 EQU   *                                                        61050032
         MVI   RSRETCOD+1,ERR044   44 NO UCB AVAILABLE         @ZSUT222 61100032
*                                                                       61150032
MNTTP140 EQU   *                                                        61200032
         MVC   RSREGSAV(8),MODID   SAVE NAME OF MODULE THAT    @ZSUT222 61250032
*                                  HAS DETECTED THE ERROR.     @ZSUT222 61300032
         STM   0,15,RSREGSAV+8     SAVE CURRENT REGISTERS.     @ZSUT222 61350032
         MVI   RSPPM+4,C'V'        XCTL TO IGC0V05B                 MCS 61830018
*                                                                       61920018
         B     MNTTP100            BRANCH TO GET WORKAREA FOR XCTL      62010018
         EJECT                                                 @G32DSMI 62014032
***************************************************************@G32DSMI 62016032
*   RAC INPUT AUTHORIZATION CHECK                             *@G32DSMI 62018032
***************************************************************@G32DSMI 62020032
RACINPUT TM    TABFLG4,TABRCINP         PREVIOUSLY CHECKED OK  @G32DSMI 62022032
         BOR   DSCNTR                   YES-BYPASS CHECK       @G32DSMI 62024032
         L     WRKR2,CVTPTR             ADDRESS OF CVT         @G32DSMI 62024232
         USING CVT,WRKR2                                       @G32DSMI 62024432
         L     WRKR2,CVTRAC             ADDRESS OF RACV CVT    @G32DSMI 62024632
         LTR   WRKR2,WRKR2              RACF ACTIVE            @G32DSMI 62024832
         BZR   DSCNTR                   RACF NOT ACTIVE RETURN @G32DSMI 62025032
         USING RCVT,WRKR2                                      @G32DSMI 62025232
         TM    RCVTSTA1,RCVTTAPE        TAPE OPTION SET        @G32DSMI 62025432
         BZR   DSCNTR                   NOT SET - RETURN       @G32DSMI 62025632
         DROP  WRKR2                                           @G32DSMI 62025832
**  BYPASS RACF CHECKING IF JSCBPASS IS SET                    @G32DSPD 62026032
         USING PSA,0                    ADDRESS THE PSA        @G32DSPD 62026132
         L     WRKR2,PSATOLD            GET CURRENT TCB ADDR   @G32DSPD 62026232
         USING TCB,WRKR2                ADDRESS THE TCB        @G32DSPD 62026332
         L     WRKR2,TCBJSCB            GET THE JSCB           @G32DSPD 62026432
         USING IEZJSCB,WRKR2            ADDRESS THE JSCB       @G32DSPD 62026532
         L     WRKR2,JSCBACT            GET ACTIVE JSCB        @G32DSPD 62026632
         TM    JSCBSWT1,JSCBPASS        BYPASS RACF SET ?      @G32DSPD 62026732
         BOR   DSCNTR                   YES,RETURN             @G32DSPD 62026832
         DROP  WRKR2                                           @G32DSPD 62026932
         MVC   RACHECK(LRACHECK),MRACHECK INITLZE PARM LIST    @G32DSMI 62027032
         RACHECK ENTITY=UCBVOLI,        ISSUE RACHECK          @G32DSMIX62028032
               ATTR=READ,                                      @G32DSMIX62030032
               MF=(E,RACHECK)                                  @G32DSMI 62032032
         B     RACITAB(WRKR6)           CHECK RETURN CODE      @G32DSMI 62034032
RACITAB  EQU   *                        BRANCH TABLE RACHECK   @G32DSMI 62036032
         OI    TABFLG4,TABBYPSW         AUTHORIZED-NO PASSWORD @G32DSMI 62038032
         B     RACINP10                 AUTHORIZED OR NOT DEF  @G32DSMI 62040032
         B     RACERR00                 NOT AUTHORIZED-ERROR   @G32DSMI 62042032
RACINP10 EQU   *                        AUTHORIZED OR NOT DEF  @G32DSMI 62044032
         OI    TABFLG4,TABRCINP         AUTHORIZED INPUT       @G32DSMI 62045032
         BR    DSCNTR                   RETURN                 @G32DSMI 62046032
***************************************************************@G32DSMI 62048032
*   RAC OUTPUT AUTHORIZATION CHECK                            *@G32DSMI 62050032
***************************************************************@G32DSMI 62052032
RACOUTPT EQU   *                                               @G32DSMI 62054032
         L     WRKR2,CVTPTR             CVT ADDRESSABILITY     @G32DSMI 62055032
         USING CVT,WRKR2                                       @G32DSMI 62056032
         L     WRKR2,CVTRAC             RACF CVT ADDRESSABILITY@G32DSMI 62057032
         LTR   WRKR2,WRKR2              RACF ACTIVE            @G32DSMI 62058032
         BZR   DSCNTR                   NO - RETURN            @G32DSMI 62059032
         USING RCVT,WRKR2                                      @G32DSMI 62062032
         TM    RCVTSTA1,RCVTTAPE        TAPE PROTECTION ACTIVE @G32DSMI 62064032
         BZR   DSCNTR                   NO-AUTHORIZED RETURN   @G32DSMI 62066032
         DROP  WRKR2                                           @G32DSMI 62068032
**  BYPASS RACF CHECKING IF JSCBPASS IS SET                    @G32DSPD 62068132
         USING PSA,0                    ADDRESS THE PSA        @G32DSPD 62068232
         L     WRKR2,PSATOLD            GET CURRENT TCB ADDR   @G32DSPD 62068332
         USING TCB,WRKR2                ADDRESS THE TCB        @G32DSPD 62068432
         L     WRKR2,TCBJSCB            GET THE JSCB           @G32DSPD 62068532
         USING IEZJSCB,WRKR2            ADDRESS THE JSCB       @G32DSPD 62068632
         L     WRKR2,JSCBACT            GET ACTIVE JSCB        @G32DSPD 62068732
         TM    JSCBSWT1,JSCBPASS        BYPASS RACF SET ?      @G32DSPD 62068832
         BOR   DSCNTR                   YES,RETURN             @G32DSPD 62068932
         DROP  WRKR2                                           @G32DSPD 62069032
         MVC   RACHECK(LRACHECK),MRACHECK INITLZE PARM LIST    @G32DSMI 62070032
         RACHECK ENTITY=UCBVOLI,        ISSUE RACHECK          @G32DSMIX62072032
               ATTR=UPDATE,                                    @G32DSMIX62074032
               MF=(E,RACHECK)                                  @G32DSMI 62076032
         B     RACOTAB(WRKR6)           CHECK RETURN CODE      @G32DSMI 62078032
RACOTAB  EQU   *                        BRANCH TABLE RACHECK   @G32DSMI 62080032
         OI    TABFLG4,TABBYPSW         AUTHORIZED NO PASSWORD @G32DSMI 62082032
         B     RACOUT10                 AUTHORIZED OR NOT DEF  @G32DSMI 62084032
         TM    DEBOPATB,OUTP            OPEN FOR INPUT         @G32DSMI 62086032
         BO    RACERR00                 NO-OUTPUT ERROR        @G32DSMI 62086232
         BAL   DSCNTR,RACINPUT          INPUT AUTHORIZED       @G32DSMI 62086432
*   FORMAT MESSAGE IEC068A AND ISSUE.                          @G32DSMI 62086632
         BAL   DSCNTR,MNTTP145          FORMAT MOUNT MESSAGE   @G32DSMI 62086832
         MVC   MSGAREA+7(L'FPMSG068),FPMSG068 FORMAT MESSAGE   @G32DSMI 62087032
         WTO   MF=(E,MSGAREA)           WTO PARM LIST          @G32DSMI 62087232
         B     MNTTP040                 UNLOAD TAPE            @G32DSMI 62087432
RACOUT10 EQU   *                        AUTHORIZED FOR OUTPUT  @G32DSMI 62088032
         OI    TABFLG4,TABRCOUT         SET FLAG FOR TRACE     @G32DSMI 62090032
         BR    DSCNTR                   RETURN TO CALLER       @G32DSMI 62092032
         EJECT                                                 @G32DSMI 62096032
***************************************************************@G32DSMI 62098032
*   USER NOT AUTHORIZED TO RAC VOLUME SEND MESSAGE            *@G32DSMI 62100032
***************************************************************@G32DSMI 62102032
RACERR00 MVI   RSRETCOD+1,ERR255        RAC TYPE ERROR         @ZSUT222 62104032
*   SET UP PARAMETER LIST FOR IGCMSG6C.                        @G32DSMI 62106032
         MVC   OPID,K05BID              CALL ER=K05B           @G32DSMI 62108032
         MVC   OPRETCOD,K05BID          RETURN FOR IHJ102I     @G32DSMI 62110032
         LA    WRKR6,UCBVOLI            VOLSER                 @G32DSMI 62112032
         ST    WRKR6,OPADDVOL                                  @G32DSMI 62114032
         LA    WRKR2,OPID                                      @G32DSMI 62116032
         ST    WRKR2,OPPARM                                    @G32DSMI 62118032
         LA    WRKR2,OPPARM                                    @G32DSMI 62120032
         LA    WRKR4,RSREGSAV     SET UP SAME AREA FOR MSG6C   @ZA29067 62121032
         LINK  EP=IGCMSG6C              SEND MESSAGE           @G32DSMI 62122032
         B     MNTTP140                                        @G32DSMI 62124032
*                                                                       62139532
************   ************   ************   ************   *********** 62190018
*                                                                       62280018
*                   FORMAT MOUNT MESSAGE                                62370018
*                                                                       62460018
************   ************   ************   ************   *********** 62550018
*                                                                       62640018
MNTTP145 EQU   *                                                        62730018
*                                                                       62760018
         BAL   TCBR,MNTTP075       READ IN JFCB                         62790018
*                                                                       62820018
         MVC   MSGID+7(44),JFCBDSNM     D.S. NAME TO MOUNT MSG          62850018
         MVI   MSGID+6,SLASH                                            62880018
         MVC   MSGAREA(19),MOUNTMS MOUNT INFO TO MESSAGE AREA           62910018
         MVC   MSGUCB(3),UCBNAME    UNIT NAME                           63000018
         MVC   MSGID(6),TABVLID1   VOL ID TO MESSAGE AREA               63090018
         XC    MSGID+51(4),MSGID+51 CLEAR ROUTE AND DESC CODES @ZA07612 63120037
         MVI   MSGID+51,DESCODE    MOVE DESCRIPTOR CODE TO MSG @ZA07612 63150037
         BR    DSCNTR             RETURN                                63180018
*                                                                       63270018
MNTTP150 EQU   *                                                        63360018
         BAL   DSCNTR,MNTTP115    FORM CHANNEL PROGRAM                  63450018
*                                                                       63540018
         B     MNTTP045            BRANCH TO SET CCW OP CODES           63630018
*                                                                       63720018
*********************************************************************** 63810018
*                                                                       63900018
*     CONSTANTS USED IN REPI/O                                          63990018
*                                                                       64080018
*********************************************************************** 64170018
*                                                                       64260018
CONSTONE DC    X'0001'               DMCT                        Y02076 64350002
*                                                                       64440018
MOUNTMS  DC    X'00458000'         LENGTH OF MESSAGE           @ZA07612 64530037
         DC    C'IEC400A M YYY,'  MOUNT MESSAGE                         64620018
*                                                                       64710018
VOL1     DC    C'VOL1'             COMPARE AGAINST 1ST FOUR CHARACTERS  64800018
*                                  OF TAPE LABEL                        64890018
ASCIVOL  DC    X'564F4C31'              ASCII CODE FOR 'VOL1'    S20038 64930020
*                                                                       64980018
HDR2     DC    C'HDR2'                  CONSTANT FOR HDR2 LABEL   99223 64981002
FPMSG1   DC    C'1A F'                  FILE PROTECT MESSAGE 1   S20038 65070020
*                                                                       65160018
FPMSG2   DC    C'2D'                    FILE PROTECT MESSAGE 2   S20038 65250020
FPMSG068 DC    C'068A U'                                       @G32DSMI 65254032
*                NAMES OF MODULES THAT CONTROL MAY BE PASSED TO       * 65340018
*                FROM THIS MODULE.                                    * 65430018
*                                                                       65520018
NAMENSL  DC    C'NSLRHDR'               NONSTANDARD LABEL        S20038 65580020
*                                       ROUTINE NAME             S20038 65640020
NAMEDA   DC    C'IGC0M05B'          D.A. MOUNT                          65700018
MODID    DC    CL8'IGC0K05B'        MODULE ID                  @ZSUT222 65750032
*                                                                       65970018
DEQLIST  DS    0F                   START OF VOLUME DEQ LIST   @ZA18506 65974032
         DEQ   (SYSZVOLS,,6,SYSTEM),TCB=0,MF=L DEQ PARMLIST    @ZA18506 65979032
DEQLNGTH EQU   *-DEQLIST            LENGTH OF LIST TO MOVE     @ZA18506 65984032
SYSZVOLS DC    C'SYSZVOLS'          MAJOR NAME                 @ZA18506 65989032
HW8      DC    H'8'                     LENGTH DEB PREFIX      @G32DSMI 65994032
K05BID   DC    H'4'                     D05B ID IGCMSG6C       @G32DSMI 65999032
DUMYPFX  DS    0CL6                     DUMMY PREFIX           @G32DSMI 66014032
*********************************************************************** 66060018
*                                                                       66150018
*     CHANNEL PROGRAM USED BY REPI/O                                    66240018
*                                                                       66330018
*********************************************************************** 66420018
*                                                                       66510018
CCWSCR   DC    X'40000005'              SEARCH CCW               S20038 66650020
QMNGWALN DC    AL3(280)                 24(P.L.)+256(W.A.)       Y02076 66660002
SP253    DC    AL1(253)                 SUBPOOL 253              Y02076 66670002
ADDRBYTS EQU   7                        GETMAIN/FREEMAIN PARMS   Y02076 66680002
HIORDER  EQU   8                        HIGH ORDER BYTE          Y02076 66690002
ALLBYTS  EQU   15                       FOUR BYTE ICM MASK       YM5965 66690402
QMWAOFST EQU   24                       QMNGR WA OFSET FRM P.L.  Y02076 66692002
JFCBLNGH EQU   176                      JFCB LENGTH              Y02076 66694002
RTCD20   EQU   X'20'                                                MCS 66700018
RTCD28   EQU   X'28'                                                MCS 66710018
RTCDA0   EQU   X'A0'                                                MCS 66720018
DESCODE  EQU   X'40'                                                MCS 66730018
CPDSURST EQU   X'40'                    CHKPT DS USED FOR RSTRT  Y02076 66732002
*                                                                       66732832
*   RACHECK PARAMETER LIST                                     @G32DSMI 66736032
*                                                                       66736832
MRACHECK RACHECK CLASS='TAPEVOL',       RACHECK PARM LIST      @G32DSMIX66737632
               MF=L                                            @G32DSMI 66738432
LRACHECK EQU   *-MRACHECK               LENGTH PARM LIST       @G32DSMI 66739232
*                                                                     * 66740000
*        MAINTENANCE SPACE                                       Y01909 66750000
*                                                                     * 66760000
PATCH    DC    XL((*-IGC0K05B)/20)'00'   FIVE PERCENT SPACE      Y01909 66770000
*                                                                     * 66772000
         IEFQMIOP                                                Y02076 66774002
*        ICHPRCVT                                              @G32DSMI 66775932
         ICHPRCVT                                                       66776332
         EJECT                                                          66777332
         IEFJESCT                                                Y02076 66778732
         EJECT                                                          66780018
MNTTIOT  DSECT                                                          66870018
         IEFTIOT1                                                       66960018
         EJECT                                                          67050018
MNTUCB   DSECT                                                          67140018
         IEFUCBOB                                                       67230018
         EJECT                                                          67320018
         IHJDSTAB                                                Y02076 67370002
         EJECT                                                          71010018
RSDSECT  DSECT                                                          71100018
*                                                                       71190018
*    DATA EXTENT BLOCK                                                  71280018
*                                                                       71370018
RSDEB    DS    0CL48                                                    71460018
RSDEBTCB DC    X'00000000'              TCB ADDRESS                     71550018
RSDEBDEB DC    X'00000000'              DEB ADDRESS                     71640018
*                                                                       71730018
*    DATA CONTROL BLOCK                                                 71820018
*                                                                       71910018
RSDEBOFL DS    0CL1                                                     72000018
RSDEBRER EQU   X'01'                    REDUCED ERROR RECOVERY  YA00628 72050002
RSDEBIRB DC    X'00000000'              IRB ADDRESS                     72090018
RSDEBSYS DC    X'00000000'              1ST IOB ADDR IN SYS.PURGE CHAIN 72180018
RSDEBUSR DC    X'00000000'              1ST IOB ADDR IN USER PRGE CHAIN 72270018
RSDEBECB DC    X'00000000'              PARM.LIST ADDR TO PURGE ECB     72360018
RSDEBID  DS    0CL1                                                     72450018
RSDEBDCB DC    AL4(RSDCBREP)            DCB ADDR                        72540018
RSDEBAPP DS    CL4                      I/O APPENDAGE VECTOR TABLE      72630018
RSDEBMOD DS    0CL1                                                     72720018
RSDEBUCB DS    F                        UCB ADDRESS                     72810018
RSDEBBIN DS    H                        BIN NUMBER                      72900018
RSDEBSCC DS    H                        CYLINDER START ADDRESS          72990018
RSDEBSHH DS    H                        TRACK START ADDRESS             73080018
RSDEBECC DS    H                        CYLINDER END ADDRESS            73170018
RSDEBEHH DS    H                        TRACK END ADDRESS               73260018
RSDEBNTR DS    H                        NO. OF TRACKS IN THIS EXTENT    73350018
*                                                                       73440018
*    EVENT CONTROL BLOCK                                                73530018
*                                                                       73620018
RSECBAD  DS    CL4                      ECB ADDRESS                     73710018
RSDCBDEB DC    AL4(RSDEB)               DEB ADDRESS                     73800018
*                                                                       73890018
RSDCBREP EQU   RSDEB+8                  POINT TO RELATIVE BEGINNING DCB 73980018
*                                                                       74070018
*    INPUT OUTPUT BLOCK                                                 74160018
*                                                                       74250018
RSIOB    DS    0CL40                                                    74340018
RSIOBFG1 DC    X'00'                    I/O FLAGS BYTE 1                74430018
RSIOBFG2 DC    X'00'                    I/O FLAGS BYTE 2                74520018
RSIOBSN1 DS    CL1                      FIRST SENSE BYTE                74610018
RSIOBSN2 DS    CL1                      SECOND SENSE BYTE               74700018
RSIOBECB DC    AL4(RSECBAD)             ECB ADDRESS                     74790018
RSIOBCSW DS    D                        LAST CSW                        74880018
RSIOBCPA DS    AL4(RSCCW1)              CHANNEL PROGRAM ADDRESS         74970018
RSIOBDCB DS    AL4(RSDCBREP)            DCB ADDRESS                     75060018
RSIOBRCP DS    CL4                      RESTART ADDRESS FOR IOS         75150018
RSIOBINC DS    H                        INCREMENT BLOCK COUNT           75240018
RSIOBECT DS    H                        NO. OF ERROR ENTRIES            75330018
RSIOBDAD DS    D                        SEEK ADDRESS FOR DA             75420018
*                                                                       75510018
*    CHANNEL PROGRAM                                                    75600018
*                                                                       75690018
RSCCWLST DS    0CL24                                                    75780018
RSCCW1   DS    D                        CCW1                            75870018
RSCCW2   DS    D                        CCW2                            75960018
RSCCW3   DS    D                        CCW3                            76050018
*                                                                       76140018
*    BUFFER SEGMENT FOR EXTERNAL BLOCKS                                 76230018
*                                                                       76320018
RSBUFSEG DS    0CL176                                                   76410018
RSJFCB   EQU   RSBUFSEG                                                 76500018
*                                                                       76590018
*********************************************************************** 76620018
*                                                                       76650018
*                  JFCB                                                 76680018
*                                                                       76710018
*********************************************************************** 76740018
         IEFJFCBN                                                Y02076 76750002
         EJECT                                                          86400018
CVT      DSECT                                                          86490018
         CVT                                                            86580018
         EJECT                                                          86670018
         IKJTCB                                                @G32DSPD 86760032
         EJECT                                                 @G32DSPD 86810032
         DCBD  DSORG=PS                                                 86860032
         EJECT                                                 @G32DSPD 86910032
JFCBX    DSECT                                                 @ZA18506 86960032
         IEFJFCBX                                              @ZA18506 87010032
         EJECT                                                 @G32DSPD 87060032
         IHAPSA                                                @G32DSPD 87110032
         EJECT                                                 @G32DSPD 87160032
         IEZJSCB                                               @G32DSPD 88410032
         EJECT                                                 @G32DSPD 88610032
*                                                                       89370018
*                                                                       89460018
         IEZDEB                                                  Y02076 89510002
         EJECT                                                          92880018
         IEEVRSWA VER=3            AOS2 VERSION OF WORK AREA     Y01909 92970000
*                                                                       93060018
*        THE MESSAGE AREA USED TO WRITE-TO-OPERATOR IS IN THE WORKAREA* 93150018
*        THE FOLLOWING EQUATES DEFINE THE MESSAGE AREA                * 93240018
*                                                                     * 93330018
*                   IGGXXXXX M YYY,XXXXXX                             * 93420018
*                                                                       93510018
MSGAREA  EQU   RSJFCB+92           LL00   LENGTH                        93600018
MSGUCB   EQU   RSJFCB+106          UNIT                                 93690018
MSGID    EQU   RSJFCB+110          VOL ID                               93780018
*                                                                       93870018
*              OPERATOR'S REPLY READ IN AND MESSAGE AREA AND ECB.     * 93960018
*                                                                       94050018
REPLY    EQU   RSJFCB+142          READ IN AREA                         94140018
REPLYLTH EQU   RSJFCB+84          MESSAGE TO OPERATOR                   94230018
REPLYECB EQU   RSJFCB+88          ECB                                   94320018
*                                                                       94410018
BLKCT    EQU   DCBBLKCT-IHADCB      DISPL TO BLOCK COUNT IN DCB         94500018
QMNPRMWA EQU   RSERAS00           SAVE QMNGRIO PARM LST ADR      Y02076 94550002
*                                                                       94590018
         ORG   RSREGSAV           VOLUME DEQ PARAMETER LIST    @ZA18506 94680037
DEQPLIST DS    0CL(DEQLNGTH)      START OF PARMLIST-TCB ADDR   @ZA18506 94684032
         DS    F                  TCB ADDRESS                  @ZA18506 94734032
DEQ      EQU   *                  MACRO CALL PARM LIST         @ZA18506 94784032
*                                                                       94834032
         ORG   RSREGSAV                                        @G32DSMI 94884032
*   PARAMETER LIST FOR IGCMSG6C                                @G32DSMI 94934032
OPPARM   DS    A                        PARAMETER LIST         @G32DSMI 94984032
OPID     DS    H                        MODULE IDENTIFIER      @G32DSMI 95034032
OPRETCOD DS    H                        RETURN CODE            @G32DSMI 95084032
OPADDVOL DS    A                        ADDRESS VOLSER         @G32DSMI 95134032
         ORG   RSREGSAV                                        @G32DSMI 95184032
RACHECK  EQU   *                                               @G32DSMI 95234032
         END                                                            98684032
