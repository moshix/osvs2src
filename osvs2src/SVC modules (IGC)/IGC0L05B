         GBLC  &LIB                                                     00030020
&LIB     SETC  'LIB1'                   SET VARIABLE TO LIB1            00060020
         TITLE 'IGC0L05B  SYSIN/SYSOUT NON-DA DATA SET PROCESSOR     RE*00100018
               POSITION I/O  RESTART-SVC 52  OS/360'                    00200018
IGC0L05B CSECT                                                          00300018
*                                                                A46670 00302000
*                                                                       00305019
*          RELEASE 21 DELETIONS/CHANGES                                 00310019
*0794229300                                                      M0187  00312021
*          RELEASE 20 DELETIONS/CHANGES                                 00315019
*0960171000,174200,198000,201500,539000,541200,542200,574000-    A30921 00315620
*0960576000                                                      A30921 00316220
*0960262300,395000,504000,514100-514500                          S20038 00317020
*          RELEASE 19 DELETIONS/CHANGES                                 00320019
*3252099000,174000,201000                                        M4873  00325019
*3252003100-003200,003300-003900,395000,411000,449000,453000,    A28296 00326019
*3252483000,489000,504000                                        A28296 00327019
*          VS2/RELEASE 3 DELETIONS/CHANGES                              00377000
*539682                                                        @ZA03651 00387000
*                                                                       00400018
* STATUS CHANGE LEVEL 004                                               00500021
*                                                                       00600018
*********************************************************************** 00700018
*                                                                       00800018
*TITLE - NON-DA SYSIN/SYSOUT DATA SET POSITIONING                       00900018
*                                                                       01000018
*STATUS - CHANGE LEVEL 0                                                01100018
*                                                                       01200018
*FUNCTION/OPERATION - PRIME BUFFERS FOR CARD READER                     01250002
*                                                                       01500018
*                                                                       01700018
*ENTRY POINTS - IGC0L05B - INITIAL ENTRY TO THIS MODULE BY MEANS OF AN  01800018
*                          XCTL FROM IGC0K05B OR IGC0M05B               01900018
*                                                                       02000018
*INPUT - REGISTER 8   BEGINNING OF DCB TABLE                            02100018
*        REGISTER 1   USER BUFFER AREA                                  02200018
*        ALL OPENED DCB (S) WITH THEIR ASSOCIATED CONTROL BLOCKS        02300018
*        THE 48 BYTE TABLE ENTRY (IES) THAT IS (ARE) USED IN RESTART    02400018
*        RESTART WORKAREA                                               02500018
*                                                                       02600018
*OUTPUT - REGISTER 8   BEGINNING OF DCB TABLE                           02700018
*         REGISTER 1   USER BUFFER AREA                                 02800018
*         BUFFERS ARE PRIMED FOR CARD READER                            03000018
*                                                                       03100018
*EXTERNAL ROUTINE - NONE                                                03200018
*                                                                       03300018
*EXITS - NORMAL - FINAL EXIT IS MADE VIA XCTL TO THE NEXT MODULE OF     03400018
*                 REPI/O. THIS MAY BE IGC0N05B (IF  DATA SETS EXIST     03500002
*                 ON DA) OR IGC0P05B.                                   03600002
*                                                                       03700018
*                                                                       04200018
*                                                                       04300018
*TABLES/WORKAREAS - THE WORKAREA USED IS DESCRIBED BY THE DSECTS AT THE 04400018
*                   END OF THE LISTING.                                 04500018
*                                                                       04600018
*********************************************************************** 04700018
*                                                                     * 04800018
*    THE FOLLOWING IS A DESCRIPTION OF THE 48 BYTE TABLE ENTRY THAT   * 04900018
*    IS USED IN THE RESTART PORTION OF CHECKPOINT/RESTART.  EACH      * 05000018
*    ENTRY IN THE TABLE (ONE FOR EACH OPEN DATA SET AT CHECKPOINT)    * 05100018
*    IS 48 BYTES LONG.                                                * 05200018
*                                                                     * 05300018
*********************************************************************** 05400018
*                                                                       05500018
*        ------------------- 4 BYTES -----------------                  05600018
*                                                                       05700018
*      0 +++++++++++++++++++++++++++++++++++++++++++++                  05800018
*        +DATA SET  +           DCB                  +                  05900018
*        + ORGN.    +         ADDRESS                +                  06000018
*        +++++++++++++++++++++++++++++++++++++++++++++ 4                06100018
*        +FLAG BYTE +    WORKAREA SEGMENT            +                  06200018
*        + NO. 1    +         ADDRESS                +                  06300018
*      8 +++++++++++++++++++++++++++++++++++++++++++++                  06400018
*        +NUMBER    +         JFCB TTR               +                  06500018
*        + OF VOLS  +         ADDRESS                +                  06600018
*        +++++++++++++++++++++++++++++++++++++++++++++ 12               06700018
*                                                                       06800018
*     12 +++++++++++++++++++++++                                        06900018
*        +TAPE LABL + FILE SEQ +        DEVICE = TAPE                   07000018
*        +INFO BYTE + NUMBER   +                                        07100018
*        +++++++++++++++++++++++                                        07200018
*                                                                       07300018
*     12 +++++++++++++++++++++++                                        07400018
*        +    OLD   TIOT       +        DA AND UNIT RECORD              07500018
*        +      OFFSET         +                                        07600018
*        +++++++++++++++++++++++                                        07700018
*                                                                       07800018
*                              +++++++++++++++++++++++                  07900018
*                              +FLAG BYTE +FLAG BYTE +                  08000018
*                              +  NO. 2   +  NO. 3   +                  08100018
*     16 +++++++++++++++++++++++++++++++++++++++++++++                  08200018
*        +FLAG BYTE +FLAG BYTE +                     +                  08300018
*        + NO. 4    + NO. 5    +   VOLUME ID NO. 1   +                  08400018
*        +++++++++++++++++++++++                     + 20               08500018
*        +                                           +                  08600018
*        +                                           +                  08700018
*     24 +++++++++++++++++++++++++++++++++++++++++++++                  08800018
*        +                                           +                  08900018
*        +   VOLUME ID NO. 2                         +                  09000018
*        +                     +++++++++++++++++++++++ 28               09100018
*        +                     +                     +                  09200018
*        +                     +   VOLUME ID NO. 3   +                  09300018
*     32 +++++++++++++++++++++++                     +                  09400018
*        +                                           +                  09500018
*        +                                           +                  09600018
*        +++++++++++++++++++++++++++++++++++++++++++++ 36               09700018
*        +                                           +                  09800018
*        +   VOLUME ID NO. 4                         +                  09900019
*     40 +                     +++++++++++++++++++++++                  10000018
*        +                     +                     +                  10100018
*        +                     +                     +                  10200018
*        +++++++++++++++++++++++   VOLUME ID NO. 5   + 44               10300018
*        +                                           +                  10400018
*        +                                           +                  10500018
*        +++++++++++++++++++++++++++++++++++++++++++++ 48               10600018
*                                                                       10700018
*                                                                       10800018
*ATTRIBUTES - REENTRANT                                                 10900018
*             REUSABLE                                                  11000018
*             ENABLED                                                   11100018
*             PRIVILEGED                                                11200018
*                                                                       11300018
*********************************************************************** 11400018
*                                                                       11500018
*    REGISTER CONVENTION TO BE USED THRU-OUT REPI/O PHASE               11600018
*                                                                       11700018
*********************************************************************** 11800018
*                                                                       11900018
WRKR1    EQU   0                        WORK/PARAMETER REGISTER         12000018
WRKR2    EQU   1                        WORK/PARAMETER REGISTER         12100018
R1       EQU   1                        REG 1                    YM7873 12150002
DCBR     EQU   2                        CURRENT DCB REGISTER            12200018
BASER    EQU   3                        BASE RIGISTER                   12300018
DEBR     EQU   4                        CURRENT DEB REGISTER            12400018
UCBR     EQU   5                        CURRENT UCB REGISTER            12500018
TIOTR    EQU   6                        NEW TIOT RESISTER               12600018
TCBR     EQU   7                        TCB REGISTER                    12700018
TABLR    EQU   8                        BEGINNING TO DCB TABLE REGISTER 12800018
CTABLR   EQU   9                        CURRENT ENTRY IN DCB TABLE      12900018
R9       EQU   9                        REG 9                    YM7873 12950002
BUFR     EQU   10                       USER BUFFER AREA                13000018
RA       EQU   10                       REG 10                   YM7873 13050002
DSCNTR   EQU   11                       NUMBER OF DATA SETS             13100018
WRKR3    EQU   12                       WORK REGISTER                   13200018
WRKR4    EQU   13                       WORK REGISTER                   13300018
WRKR5    EQU   14                       WORK/PARAMETER REGISTER         13400018
RE       EQU   14                       REG 14                   YM7873 13450002
WRKR6    EQU   15                       WORK/PARAMETER REGISTER         13500018
RF       EQU   15                       REG 15                   YM7873 13550002
*                                                                       13600018
*********************************************************************** 13700018
*                                                                       13800018
*    OFFSETS TO BE USED IN REPI/O PHASE                                 13900018
*                                                                       14000018
*********************************************************************** 14100018
*                                                                       14200018
IS       EQU   X'80'                    INDEXED SEQUENCIAL              14204018
PS       EQU   X'40'                    PHYSICAL SEQUENCIAL             14208018
DA       EQU   X'20'                    DIRECT ACCESS                   14212018
PO       EQU   X'02'                    PARTITIONED ORGANIZATION        14216018
INOROUT  EQU   X'40'                    SYSIN OR SYSOUT DATA SET        14224018
UNITREC  EQU   X'04'                    UNIT RECORD EQUIPMENT           14240018
ERRINNSL EQU   X'80'                    ERROR IN NSL ROUTINE            14244018
NSLMTSW  EQU   X'40'                    NSL MOUNT SWITCH                14248018
NSLCOMU  EQU   X'20'                    NSL COMMUNICATION BIT           14252018
BYPASS   EQU   X'10'                    BYPASS LABEL PROCESSING         14256018
AL       EQU   X'08'                    ASCII LABEL              S20038 14258020
NSL      EQU   X'04'                    NON-STANDARD LABEL              14260018
SL       EQU   X'02'                    STANDARD LABEL                  14264018
NL       EQU   X'01'                    NO LABEL                        14268018
GTR5VOL  EQU   X'80'                    GREATER THAN 5 VOLUMES          14272018
POCONCAT EQU   X'40'                    P.O. CONCATENATED               14276018
DAFLAG   EQU   X'80'                    DA DATA SET FLAG                14280018
NONDAFLG EQU   X'40'                    NON-DA DATA SET FLAG            14284018
NSLFLAG  EQU   X'10'                    NSL ROUTINE FLAG                14288018
TYPERST  EQU   X'80'                    IMMEDIATE RESTART               14292018
TABENT   EQU   48                       TABLE ENTRY LENGTH              14296018
WRITE    EQU   X'01'                    WRITE ON TAPE                   14300018
READ     EQU   X'02'                    READ FOR TAPE                   14304018
NOPOP    EQU   X'03'                    NOP                             14308018
SENSE    EQU   X'04'                    SENSE                           14312018
REWIND   EQU   X'07'                    REWIND                          14316018
READBACK EQU   X'0C'                    READBACK                        14320018
UNLOAD   EQU   X'0F'                    REWIND AND UNLOAD               14324018
WTM      EQU   X'1F'                    WRITE TAPE MARK                 14328018
BSFOP    EQU   X'2F'                    BACKWARD SPACE FILE             14332018
FSFOP    EQU   X'3F'                    FORWARD SPACE FILE              14336018
SEARCH   EQU   X'31'                    SEARCH                          14340018
SRCHCNT  EQU   X'05'                    COUNT FOR SEARCH ID             14344018
TIC      EQU   X'08'                    TIC                             14348018
READDA   EQU   X'06'                    READ FOR DA                     14352018
LENJFCB  EQU   X'B0'                    LENGTH OF JFCB                  14356018
LBLLEN   EQU   X'50'                    LENGTH OF LABEL                 14360018
LBLOFST  EQU   96                       OFFSET FROM RSJFCB TO    S20038 14361020
*                                       AREA FOR                 S20038 14362020
*                                            LABEL CONSTRUCTION         14363020
PERMERR  EQU   X'7F'                    PERMANENT ERROR                 14364018
ERR24    EQU   24                       ERROR IN READING IN JFCB        14368018
ERR50    EQU   50                       ERROR IN WRITING LABELS         14372018
ERR54    EQU   54                       ERROR - ASCII LABEL FOR  S20038 14373020
*                                       SYSIN                    S20038 14374020
*                                            OR SYSOUT TAPE             14375020
ONE      EQU   X'01'                    CONSTANT ONE                    14376018
OUT      EQU   X'40'                    SYSOUT DATA SET (UCBWGT)        14380018
CHAIN    EQU   X'40'                    CHAINING FLAG                   14384018
BLANK    EQU   C' '                     BLANK CHARACTER                 14388018
SIGNOFF  EQU   X'F0'                    REMOVE SIGN BIT                 14392018
ZERO     EQU   C'0'                     ZERO CONSTANT                   14396018
SECIND   EQU   C'1'                     SECURITY INDICATOR              14400018
SLIFLAG  EQU   X'20'                    SLI FLAG                        14404018
HDR2ID   EQU   C'2'                     HDR2 IDENTIFIER                 14408018
MASK     EQU   X'03'                    MASK USED FOR ZEROING BLKA      14412018
TRANS    EQU   C'T'                     TRANSLATE IN TRTCH              14416018
GTR32K   EQU   X'F9'                    GREATER THAN 32K INDICATOR      14420018
SLASH    EQU   C'/'                     SLASH                           14424018
MACHCNTL EQU   C'M'                     MACHINE CODE CONTROL            14428018
ASACNTL  EQU   C'A'                     ASA CNTRL CHAR                  14432018
CHSLI    EQU   CHAIN+SLIFLAG            CHAINING AND SLI FLAG           14436018
IOERROR  EQU   X'20'                    PERMANENT I/O ERROR             14440018
UNITEX   EQU   X'01'                    UNIT EXCEPTION                  14444018
IN       EQU   X'80'                    SYSIN DATA SET (UCBWGT)         14448018
RDR2501  EQU   X'01'                    2501 CARD READER         A46670 14450000
RDR2540  EQU   X'04'                    2540 CARD READER         A46670 14450400
CARDRDR  EQU   X'05'                    CARD READER                     14452018
P3211    EQU   X'09'                    3211 PRINTER             YM7873 14454002
WALNTH   EQU   X'23A'                   LENGTH OF 3211 ERP WA    YM7873 14454402
MOVE     EQU   X'14'                    MOVE OR SUBSTITUTE MODE         14456018
NTPRGD   EQU   X'FF'                    NO PURGED                       14460018
AET      EQU   X'2B'                    EVEN PARITY AND TRANSLATION IN  14500018
*                                            TRTCH                      14600018
AMCODE   EQU   X'02'                    MACHINE CODE                    14670018
ASA      EQU   X'04'                    ASA CONTROL CHARACTER           14740018
QSAMDCB  EQU   X'01'                    QSAM DCB INDICATOR              14810018
DAFLG    EQU   X'80'               DIRECT ACCESS FLAG            M4873  14850019
IOBSTAT0 EQU   20                       BYTE 12 OF AN IOB        A30921 14870020
DEBPRFLN EQU   16                  LENGTH OF DEB PREFIX          Y02049 14880002
K1       EQU   1                        CONST 1                  YM7873 14890002
K4       EQU   4                        CONST 4                  YM7873 14892002
*                                                                       14900018
*********************************************************************** 15000018
*                                                                       15100018
         BALR  BASER,0                  ESTABLISH ADDRESSIBILITY        15200018
         USING *,BASER                  ESTABLISH BASE REG              15300018
         B     BEGIN               BRANCH AROUND EYE CATCHER     Y01909 15350000
         CNOP  0,8                 ALIGN TO A DBL WORD BOUNDARY  Y01909 15360000
         DC    C'IGC0L05B'         CSECT NAME                    Y01909 15370000
BEGIN    EQU   *                                                 Y01909 15380000
*                                                                       15400018
         USING IHADCB,DCBR                                              15500018
         USING DEBBASIC,DEBR                                     Y02049 15600002
         USING UCBOB,UCBR                                               15700018
         USING TABL,CTABLR                                              15800018
         USING RSTWA,BUFR                                               15900018
         USING RSDSECT,WRKR4                                            16000018
         USING CVT,WRKR2                                                16100018
         USING FILELAB,TIOTR                                            16200018
         USING TCB,TCBR                                                 16300018
         USING TIOT1,WRKR5                                              16400018
*                                                                       16500018
         LR    CTABLR,TABLR             INITIALIZE TABL PTR             16600018
*                                                                       16700018
REPIO002 EQU   *                                                        16800018
*                                                                       16900018
         L     WRKR4,TABSEGAD-1         WORKAREA SEGMENT ADDRESS        16910000
         LA    WRKR6,REPIO100           LOAD REG WITH BRANCH     A46670 16950000
*                                       ADDRESS                  A46670 17000000
         TM    TABFLG1,TABDA+TABNULL+TABTCAM SKIP IF DA          Y02076 17050002
         BCR   7,WRKR6                  TCAM DS OR NULL          A46670 17070000
*                                                                       17120000
REPIO003 EQU   *                                                 M4873  17450019
*                                                                       17500018
*    ****************************************************************** 17600018
*                                                                       17700018
*     QSAM CARD READER BUFFERS ARE PROCESSED BY THIS MODULE             17750002
*                                                                       18000018
*    ****************************************************************** 18100018
*                                                                       18200018
*    *** PICK UP NECESSARY ADDRESSES ***                                18300018
*                                                                       18400018
         LA    WRKR4,0(WRKR4)           CLEAR HIGH ORDER BYTE           18600018
         L     DCBR,TABDCBAD-1          DCB ADDR IN THIS ENTRY          18700018
         LA    DCBR,0(DCBR)             CLEAR HIGH ORDER BYTE           18800018
         L     DEBR,DCBDEBAD            DEB ADDR ASSOC WITH THIS DCB    18900018
         L     UCBR,DEBSUCBA            UCB ADDR ASSOC WITH DEB  Y02049 19000002
*                                                                       19100018
         TM    TABFLG1,TABTAPE          IS IT ON TAPE DEVICE            19300002
         BO    REPIO100                 BRANCH TO GET NXT ENTRY  Y02076 19350002
*                                                                       53300018
REPIO050 EQU   *                                                        53400018
*                                                                       53500018
*    *** UNIT RECORD DEVICE PROCESS - CARD READER ONLY ***              53600018
*                                                                       53700018
         CLI   UCBTBYT3,UCB3UREC        TEST UNIT RECORD         A46670 53800000
         BCR   7,WRKR6                  SKIP IF NOT              A46670 53850000
         CLI   UCBTBYT4,P3211           IS IT A 3211 PRINTER     YM7873 53860002
         BNE   REPIO05K                 BRANCH IF NO             YM7873 53870002
         STM   R9,RF,RSREGSAV+R9*K4     SAVE REGS                YM7873 53880002
         LA    R9,RSREGSAV+R9*K4        GET ADDR REG SAVE AREA   YM7873 53890002
         L     RE,UCBXTADR              PRINTER EXTENSION        YM7873 53899202
         USING UCBUCS,RE                                         YM7873 53899602
         SR    RF,RF                    ZERO RF FOR IC, LTR      YM7873 53899702
         IC    RF,UCBERADR              GET USE COUNT            YM7873 53899802
         LTR   RF,RF                    IS IT NOW ZERO           YM7873 53899902
         LA    RF,K1(,RF)               INCREMENT BY ONE         YM7873 53916602
         STC   RF,UCBERADR              STORE UPDATED COUNT      YM7873 53926602
         BNZ   REPIO05D                 BRANCH IF COUNT WASN'T 0 YM7873 53928602
*                                                                YM7873 53930602
*        GET ERP WORKAREA                                        YM7873 53932602
         GETMAIN R,SP=255,LV=WALNTH     GET ERP WORK AREA        YM7873 53932702
         STCM  R1,B'0111',UCBERADR+K1   STORE WORKAREA ADDR      YM7873 53933202
*                                                                YM7873 53938802
REPIO05D EQU   *                        EXIT THIS TAB ENTRY      YM7873 53940802
         LM    R9,RF,0(R9)              RESTORE REGS           @ZA03651 53968200
         BR    WRKR6                    GET OUT                  YM7873 53971002
*                                                                YM7873 53971102
REPIO05K EQU   *                        CHK FOR CARD READER      YM7873 53971402
         CLI   UCBTBYT4,RDR2501         TEST 2501                A46670 53972202
         BE    REPIO051                 PROCESS IF 2501          A46670 53986102
         CLI   UCBTBYT4,RDR2540         TEST 2540R               A46670 54000000
         BCR   7,WRKR6                  SKIP IF NEITHER          A46670 54050000
*                                                                       54100000
REPIO051 EQU   *                        PROCESS 2501 OR 2540R    A46670 54110000
*                                                                       54140018
         TM    DCBCIND2,QSAMDCB         IS IT QSAM DCB                  54160018
         BCR   8,WRKR6                  NO - GO GET NEXT ENTRY   A30921 54230020
*                                                                       54300018
*    *** PICK UP USER IOB ADDRESS ***                                   54400018
*                                                                       54500018
         L     WRKR3,DCBIOBA            GET FIRST IOB ADDRESS           54600018
         LR    DSCNTR,WRKR3             SAVE FOR WORK REGISTER          54700018
*                                                                       54800018
         XC    DCBEOBAD(8),DCBEOBAD     FORCE END OF BUFFER CONDITION   54900018
*                                                                       55000018
         SR    TIOTR,TIOTR              CLEAR WORK REGISTER             55100018
         IC    TIOTR,DCBBUFNO           GET NUMBER OF BUFFERS TO PRIME  55200018
*                                                                       55300018
         LR    WRKR5,DEBR          GET DEB ADDR FOR CALC         Y02049 55350002
         LA    WRKR2,DEBPRFLN      GET LENGTH OF DEB PREFIX      Y02049 55360002
         SR    WRKR5,WRKR2         POINT TO DEB PREFIX           Y02049 55370002
         USING DEBPREFX,WRKR5                                    Y02049 55380002
         L     WRKR5,DEBXTNP       GET POINTER TO DEB EXTENSION  Y02049 55390002
         USING DEBXTN,WRKR5                                      Y02049 55392002
         TM    DEBXMCF1,DCBMRMVG+DCBMRSBG                        Y02049 55442002
*                                  IS IT MOVE OR SUBSTITUTE MODE Y02049 55492002
         DROP  WRKR5                                             Y02049 55494002
         BC    5,REPIO060               BRANCH IF YES TO GET NEXT IOB   55500018
*                                            FOR PRIMING                55600018
         BCTR  TIOTR,0                  REDUCE BY ONE                   55700018
         LTR   TIOTR,TIOTR              MORE THAN ONE IOB               55800018
         BZ    REPIO080                 BRANCH IF NOT TO FINISH THIS    55900018
*                                            ENTRY                      56000018
REPIO060 EQU   *                                                        56100018
*                                                                       56200018
*    *** PRIMING BUFFERS - WILL BRANCH AND LINK TO EOB ROUTINE ***      56300018
*                                                                       56400018
         L     WRKR3,0(WRKR3)           GET NEXT IOB                    56500018
*                                                                       56600018
         LA    WRKR4,RSJFCB             GET REGISTER SAVE AREA          56700018
*                                                                       56800018
REPIO070 EQU   *                                                        56900018
*                                                                       57000018
         STM   WRKR1,WRKR6,0(WRKR4)     SAVE REGISTERS                  57100018
*                                                                       57200018
         L     WRKR6,DCBEOB             GET READ EOB ADDRESS            57300018
         ST    WRKR3,DCBIOBA            MAKE DCB POINT TO IOB    A30921 57380020
         TM    IOBSTAT0(WRKR3),UNITEX   CHECK FOR UNIT EXCEPTION A30921 57460020
         BNZ   REPIO075                 YES, DON'T PRIME BUFFERS A30921 57540020
         LR    BASER,WRKR3              PUT IOB IN PROPER REG    A30921 57620020
         BALR  WRKR5,WRKR6              TO EOB ROUTINE TO PRIME BUFFERS 57700018
*                                                                       57800018
REPIO075 EQU   *                                                 A30921 57830020
*                                                                       57860020
         LM    WRKR1,WRKR6,0(WRKR4)     RESTORE REGISTERS               57900018
*                                                                       58000018
         L     WRKR3,0(WRKR3)           GET NEXT IOB                    58100018
         BCT   TIOTR,REPIO070           BRANCH IF MORE BUFFERS TO PRIME 58200018
*                                                                       58300018
         ST    DSCNTR,DCBIOBA           RESET DCB TO ORIGINAL IOB       58400018
*                                                                       58500018
REPIO080 EQU   *                                                        58600018
*                                                                       58700018
         NI    DCBIOBA,X'FE'            TURN OFF FIRST IOB BIT IN DCB   58800018
         MVI   DEBUSRPG+3,NTPRGD        SET NO PURGED BYTE IN DEB TO    58830018
*                                           SKIP RESTORING              58860018
         B     REPIO100                 BRANCH TO GET NEXT ENTRY        58900018
*                                                                       59000018
REPIO100 EQU   *                                                        59700018
*                                                                       59800018
         TM    TABFLG1,TABLAST          IS THIS LAST ENTRY              59900002
         BO    REPIO160                 BRANCH IF YES TO XCTL NEXT LOAD 60000018
*                                                                       60100018
         LA    CTABLR,TABENT(CTABLR)    INCREMENT TABL PTR              60200018
         B     REPIO002                 BRANCH TO PICK UP NEXT ENTRY    60300018
*                                                                       60400018
REPIO160 EQU   *                                                        60500018
         LA    WRKR6,RSJFCB             SET UP WORKAREA FOR XCTL YM7577 60650002
         MVC   0(8,WRKR6),DALOADNM      GO TO N05B               YM7577 60700002
*                                                                       61700018
         LA    WRKR6,8(0,WRKR6)         SET UP FOR XCTL                 61800002
         LR    WRKR2,BUFR               POINT REG 1 TO THE RESTART W/A  61900018
         LA    WRKR5,RSJFCB             REG14 PTS TO XCTL LIST   YM7582 61950002
         LR    WRKR3,BUFR               POINT REG12 TO RSTRT WA  YM5319 61960002
*                                                                       62000018
         XCTL  EPLOC=(WRKR5),SF=(E,(15))                                62100002
*                                                                       62120018
*********************************************************************** 62140018
*                                                                       62160018
*     CONSTANTS USED IN REPI/O                                          62180018
*                                                                       62200018
*********************************************************************** 62220018
*                                                                       62240018
         DS    0H                                                       62300018
AGRTR32K DC    X'8000'                  VALUE IN LABEL WHEN LRECL GTR   62400018
*                                            32K                        62500018
ARECFM   EQU   *-1                      RECFM TRANSLATE TABEL (NO ZERO  62600018
         DC    C'VFU'                        VALUE VARIABLE, FIXED,     62700018
*                                            UNDEFINED)                 62800018
ATRTCH   DC    C' CET'                  BLANK, CONVERSION, EVEN PARITY, 62900018
*                                            TRANSLATE                  63000018
ABLKA    DC    C' SBR'                  BLOCK ATTRIBUTE TRANSLATE TABLE 63100018
ABFALN   DC    C'0C8C'                  TRANSLATE TABLE FOR BFALN       63200018
AHDR1    DC    C'HDR1'                  HEADER 1                        63300018
DALOADNM DC    CL8'IGC0N05B'            DA LOAD                         63400018
RSTMODNM DC    CL8'IGC0V05B'            RESTART EXIT                    63600018
*                                                                     * 63650000
*        MAINTENANCE SPACE                                       Y01909 63660000
*                                                                     * 63670000
PATCH    DC    XL((*-IGC0L05B)/20)'00'   FIVE PERCENT SPACE      Y01909 63680000
*                                                                     * 63690000
         EJECT                                                          63700018
         IEEVRSWA VER=3                 AOS2 VERSION OF WA              63850000
         EJECT                                                          63900018
RSDSECT  DSECT                                                          64000018
*                                                                       64100018
*    DATA EXTENT BLOCK                                                  64200018
*                                                                       64300018
RSDEB    DS    0CL48                                                    64400018
RSDEBTCB DC    X'00000000'              TCB ADDRESS                     64500018
RSDEBDEB DC    X'00000000'              DEB ADDRESS                     64600018
*                                                                       64700018
*    DATA CONTROL BLOCK                                                 64800018
*                                                                       64900018
RSDEBOFL DS    0CL1                                                     65000018
RSDEBIRB DC    X'00000000'              IRB ADDRESS                     65100018
RSDEBSYS DC    X'00000000'              1ST IOB ADDR IN SYS.PURGE CHAIN 65200018
RSDEBUSR DC    X'00000000'              1ST IOB ADDR IN USER PRGE CHAIN 65300018
RSDEBECB DC    X'00000000'              PARM.LIST ADDR TO PURGE ECB     65400018
RSDEBID  DS    0CL1                                                     65500018
RSDEBDCB DC    AL4(RSDCBREP)            DCB ADDR                        65600018
RSDEBAPP DS    CL4                      I/O APPENDAGE VECTOR TABLE      65700018
RSDEBMOD DS    0CL1                                                     65800018
RSDEBUCB DS    F                        UCB ADDRESS                     65900018
RSDEBBIN DS    H                        BIN NUMBER                      66000018
RSDEBSCC DS    H                        CYLINDER START ADDRESS          66100018
RSDEBSHH DS    H                        TRACK START ADDRESS             66200018
RSDEBECC DS    H                        CYLINDER END ADDRESS            66300018
RSDEBEHH DS    H                        TRACK END ADDRESS               66400018
RSDEBNTR DS    H                        NO. OF TRACKS IN THIS EXTENT    66500018
*                                                                       66600018
*    EVENT CONTROL BLOCK                                                66700018
*                                                                       66800018
RSECBAD  DS    CL4                      ECB ADDRESS                     66900018
RSDCBDEB DC    AL4(RSDEB)               DEB ADDRESS                     67000018
*                                                                       67100018
RSDCBREP EQU   RSDEB+8                  POINT TO RELATIVE BEGINNING DCB 67200018
*                                                                       67300018
*    INPUT OUTPUT BLOCK                                                 67400018
*                                                                       67500018
RSIOB    DS    0CL40                                                    67600018
RSIOBFG1 DC    X'00'                    I/O FLAGS BYTE 1                67700018
RSIOBFG2 DC    X'00'                    I/O FLAGS BYTE 2                67800018
RSIOBSN1 DS    CL1                      FIRST SENSE BYTE                67900018
RSIOBSN2 DS    CL1                      SECOND SENSE BYTE               68000018
RSIOBECB DC    AL4(RSECBAD)             ECB ADDRESS                     68100018
RSIOBCSW DS    D                        LAST CSW                        68200018
RSIOBCPA DS    AL4(RSCCW1)              CHANNEL PROGRAM ADDRESS         68300018
RSIOBDCB DS    AL4(RSDCBREP)            DCB ADDRESS                     68400018
RSIOBRCP DS    CL4                      RESTART ADDRESS FOR IOS         68500018
RSIOBINC DS    H                        INCREMENT BLOCK COUNT           68600018
RSIOBECT DS    H                        NO. OF ERROR ENTRIES            68700018
RSIOBDAD DS    D                        SEEK ADDRESS FOR DA             68800018
*                                                                       68900018
*    CHANNEL PROGRAM                                                    69000018
*                                                                       69100018
RSCCWLST DS    0CL24                                                    69200018
RSCCW1   DS    D                        CCW1                            69300018
RSCCW2   DS    D                        CCW2                            69400018
RSCCW3   DS    D                        CCW3                            69500018
*                                                                       69600018
*    BUFFER SEGMENT FOR EXTERNAL BLOCKS                                 69700018
*                                                                       69800018
RSBUFSEG DS    0CL176                                                   69900018
RSJFCB   EQU   RSBUFSEG                                                 70000018
*                                                                       70100018
*********************************************************************** 70200018
*                                                                       70300018
*                  JFCB                                                 70400018
*                                                                       70500018
*********************************************************************** 70600018
*                                                                       70700018
JFCBDSNM DS    CL44                         DATA SET NAME               70800018
JFCBELNM DS    CL8                          ELEMENT NAME OR VERSION     70900018
JFCBTSDM DS    CL1                          TASK SCHEDULER - DATA       71000018
*                                            MANAGEMENT INTERFACE BYTE  71100018
JFCBSYSC DS    CL13                         SYSTEM CODE                 71200018
JFCBLTYP DS    CL1                          LABEL TYPE AND USER'S-LABEL 71300018
*                                            INDICATOR                  71400018
         DS    CL1                          NOT USED                    71500018
JFCBFLSQ DS    CL2                          FILE SEQUENCE NUMBER        71600018
JFCBVLSQ DS    CL2                          VOLUME SEQUENCE NUMBER      71700018
JFCBMASK DS    CL8                          DATA MANAGEMENT MASK        71800018
JFCBCRDT DS    CL3                          DATA SET CREATION DATE      71900018
JFCBXPDT DS    CL3                          DATA SET EXPIRATION DATE    72000018
JFCBIND1 DS    CL1                          INDICATOR BYTE 1            72100018
JFCBRLSE EQU   64                            BITS 0 AND 1 - EXTERNAL    72200018
*                                            STORAGE RELEASE INDICATOR  72300018
JFCBLOCT EQU   16                            BITS 2 AND 3 - DATA SET    72400018
*                                            HAS BEEN LOCATED           72500018
JFCBNEWV EQU   4                             BITS 4 AND 5 - NEW VOLUME  72600018
*                                            ADDED TO DATA SET          72700018
JFCBPMEM EQU   1                             BITS 6 AND 7 - DATA SET IS 72800018
*                                            A MEMBER OF A PODS OR GDG  72900018
JFCBIND2 DS    CL1                          INDICATOR BYTE 2            73000018
JFCBSTAT EQU   64                            BITS 0 AND 1 - DATA SET    73100018
*                                            STATUS (NEW, OLD, OR MOD)  73200018
JFCBSCTY EQU   16                            BITS 2 AND 3 - DATA SET    73300018
*                                            SECURITY INDICATOR         73400018
JFCBUFNO DS    0AL1                                                     73500018
JFCBUFRQ DS    AL1                      BUFFER REQUESTED                73600018
JFCBFTEK DS    0BL1                                                     73700018
JFCBFALN DS    BL1                      BUFFER ALIGNMENT                73800018
JFCBUFL  DS    AL2                      BUFFER LENGTH                   73900018
JFCEROPT DS    BL1                      ERROR ROUTINE                   74000018
JFCTRTCH DS    0BL1                                                     74100018
JFCKEYLE DS    0AL1                                                     74200018
JFCMODE  DS    0BL1                                                     74300018
JFCCODE  DS    0BL1                                                     74400018
JFCSTACK DS    0BL1                                                     74500018
JFCPRTSP DS    BL1                      PRINTER SPACING                 74600018
JFCDEN   DS    BL1                      TAPE DENSITY                    74700018
JFCLIMCT DS    AL3                      NO. OF TRKS.TO BE SEARCHED      74800018
JFCDSORG DS    BL2                      DATA SET ORGANIZATION           74900018
JFCRECFM DS    BL1                      RECORD FORMAT                   75000018
JFCOPTCD DS    BL1                      OPTION CODES                    75100018
JFCBLKSI DS    AL2                      BLOCK SIZE                      75200018
JFCLRECL DS    AL2                      LOGICAL RECORD LENGTH           75300018
JFCNCP   DS    AL1                      NO. OF CHANNEL PROGRAM          75400018
JFCNTM   DS    AL1                      NO. OF TRKS. FOR MASTER INDEX   75500018
JFCRKP   DS    AL2                      RELATIVE POSITION OF KEY        75600018
JFCCYLOF DS    AL1                      NO. OF TRKS FOR OVERFLOW        75700018
JFCDBUFN DS    AL1                      RESERVED                        75800018
JFCINTVL DS    AL1                      INTENTIONAL INTERVAL            75900018
JFCCPRI  DS    BL1                      PRIORITY                        76000018
JFCSOWA  DS    AL2                      SIZE OF WORKAREA                76100018
JFCBNTCS DS    CL1                          NUMBER OF OVERFLOW TRACKS   76200018
JFCBNVOL DS    CL1                          NUMBER OF VOLUME SERIAL     76300018
*                                            NUMBERS                    76400018
JFCBVOLS DS    CL30                         VOLUME SERIAL NUMBERS (THE  76500018
*                                            FIRST FIVE)                76600018
JFCBEXTL DS    CL1                          LENGTH OF BLOCK OF EXTRA    76700018
*                                            VOLUME SERIAL NUMBERS      76800018
*                                            (BEYOND FIVE)              76900018
JFCBEXAD DS    CL3                          TRACK ADDRESS OF BLOCK OF   77000018
*                                            EXTRA VOL SERIAL NUMBERS   77100018
JFCBPQTY DS    CL3                          PRIMARY QUANTITY OF D.A.    77200018
*                                            STORAGE REQUIRED           77300018
JFCBCTRI DS    CL1                          INDICATES WHETHER CYLINDERS 77400018
*                                            TRACKS, OR RECORDS ARE     77500018
*                                            SPECIFIED IN JFCBPQTY AND  77600018
*                                            JFCBSQTY                   77700018
JFCBSQTY DS    CL3                          SECONDARY QUANTITY OF D.A.  77800018
*                                            STORAGE REQUIRED           77900018
JFCBIND3 DS    CL1                          INDICATOR BYTE 3            78000018
JFCBCNTG EQU   64                            BITS 0 AND 1 - CONTIGUOUS  78100018
*                                            STORAGE INDICATOR          78200018
JFCBMXIG EQU   16                            BITS 2 AND 3 - MAXIMUM     78300018
*                                            AVAILABLE EXTENT INDICATOR 78400018
JFCBALXI EQU   4                             BITS 4 AND 5 - ALL EXTENTS 78500018
*                                            INDICATOR                  78600018
JFCBRNDC EQU   1                             BITS 6 AND 7 - ROUND       78700018
*                                            CYLINDER INDICATOR         78800018
JFCBDQTY DS    CL3                          QUANTITY OF D.A. STORAGE    78900018
*                                            REQUIRED FOR A DIRECTORY   79000018
JFCBSPNM DS    CL3                          CORE ADDRESS OF THE JFCB    79100018
*                                            WITH WHICH CYLINDERS ARE   79200018
*                                            SPLIT                      79300018
JFCBABST DS    CL2                          RELATIVE ADDRESS OF FIRST   79400018
*                                            TRACK TO BE ALLOCATED      79500018
JFCBSBNM DS    CL3                          CORE ADDRESS OF THE JFCB    79600018
*                                            FROM WHICH SPACE IS TO BE  79700018
*                                            SUBALLOCATED               79800018
JFCBDRLH DS    CL3                          AVERAGE DATA RECORD LENGTH  79900018
JFCBVLCT DS    CL1                          VOLUME COUNT                80000018
JFCBSPTN DS    CL1                          NUMBER OF TRACKS PER        80100018
*                                            CYLINDER TO BE USED BY     80200018
*                                            THIS DATA SET WHEN SPLIT   80300018
*                                            CYLINDER IS INDICATED      80400018
JFCBLGTH EQU   176                          LENGTH OF JFCB              80500018
JFCBEND  EQU   *                                                        80600018
         ORG   RSBUFSEG+176             ORG BACK TO BUFFER SEGMENT      80700018
RSSTATUS DS    0CL8                                                     80800018
RSSTAT1  DS    CL1                      STATUS BYTE 1                   80900018
RSSTAT2  DS    CL1                      STATUS BYTE 2                   81000018
RSSTAT3  DS    CL1                      STATUS BYTE 3                   81100018
RSSTAT4  DS    CL1                      STATUS BYTE 4                   81200018
         DS    F                        RESERVED FOR FUTURE USE         81300018
         EJECT                                                          81400018
CVT      DSECT                                                          81500018
         CVT                                                            81600018
         EJECT                                                          81700018
*                                                                       81800018
*                                                                       81900018
*   TASK CONTROL BLOCK                                                  82000018
*                                                                       82100018
*                                                                       82200018
         CNOP  0,4                                                      82300018
TCB      DSECT                                                          82400018
TCBRBP   DS    F                       POINTER TO EXECUTING RB          82500018
TCBPIE   DS    F                       POINTER TO PROG. INTERRUPT EL.   82600018
TCBDEB   DS    F                       POINTER TO DEB QUEUE             82700018
TCBTIO   DS    F                       POINTER TO TIOT                  82800018
TCBCMP   DS    F                       TASK COMPLETION CODE             82900018
TCBTRN   DS    F                       TESTRAN FIELD                    83000018
TCBMSS   DS    F                       DATA BLOCK QUEUE ELEMENT POINTER 83100018
TCBPRTK  DS    CL1                     PROTECTION TAG                   83200018
TCBFLGS  DS    FL5                     FLAG BYTES                       83300018
TCBLMP   DS    CL1                     LIMIT PRIORITY                   83400018
TCBDSP   DS    CL1                     DISPATCHING PRIORITY             83500018
TCBLLS   DS    F                       POINTER TO LOAD LIST             83600018
TCBJLB   DS    F                       POINTER TO JOBLIB DCB            83700018
TCBJSE   DS    F                       LIST OF INACTIVE PROGRAMS ADDR.  83800018
TCBGRS   DS    CL64                    GENERAL REGISTER SAVE AREA       83900018
TCBIDF   DS    CL1                     TCB IDENTIFIER FIELD             84000018
TCBFSA   DS    CL3                     POINTER TO 1ST PROB.PROG.SAVEAR  84100018
TCBTCB   DS    F                       NEXT TCB ON READY QUEUE POINTER  84200018
TCBTME   DS    F                       POINTER TO TIMER ELEMENT         84300018
         EJECT                                                          84400018
         DCBD  DSORG=PS                                                 84500018
         EJECT                                                          84600018
*                                                                       84700018
*                                                                       84800018
*   DATA EXTENT BLOCK                                                   84900002
*                                                                       85000018
*                                                                       85100018
         IEZDEB                                                  Y02049 85150002
         EJECT                                                          88600018
         IHJDSTAB                                                Y02076 88650002
         EJECT                                                          92700018
TIOT     DSECT                                                          92800018
         IEFTIOT1                                                       92900018
         EJECT                                                          93000018
SRT      DSECT                                                          93100018
         IEFUCBOB                                                       93200018
         EJECT                                                          93300018
*********************************************************************** 93400018
*                                                                       93500018
*        FILE LABELS                                                    93600018
*                                                                       93700018
*********************************************************************** 93800018
*                                                                       93900018
*        FILE LABEL 1                                                   94000018
*                                                                       94100018
         CNOP  0,4                                                      94200018
FILELAB  DSECT                                                          94300018
FL1LABI  DS    CL3                      LABEL IDENTIFIER                94400018
FL1NO    DS    CL1                      FILE LABEL NUMBER               94500018
FL1ID    DS    CL17                     FILE IDENTIFIER                 94600018
FL1FILSR DS    CL6                      FILE SERIAL NUMBER              94700018
FL1VOLSQ DS    CL4                      VOLUME SEQUENCE NUMBER          94800018
FL1FILSQ DS    CL4                      FILE SEQUENCE NUMBER            94900018
FL1GNO   DS    CL4                      GENERATION NUMBER               95000018
FL1VNG   DS    CL2                      VERSION NUMBER OF GENERATION    95100018
FL1CREDT DS    CL6                      CREATION DATE                   95200018
FL1EXPDT DS    CL6                      EXPIRATION DATE                 95300018
FL1FSEC  DC    C'0'                     FILE SECURITY INDICATOR         95400018
FL1BLKCT DS    CL6                      BLOCK COUNT                     95500018
FL1SYSCD DS    CL13                     SYSTEM CODE                     95600018
FL1RES   DS    0CL7                     RESERVED FOR FUTURE USE         95700018
         DS    CL1                      RESERVED                        95800018
FL1RES1  DS    CL6                      RESERVED                        95900018
*                                                                       96000018
*        FILE LABEL 2                                                   96100018
*                                                                       96200018
         ORG   FL1ID                    ORG BACK TO FILE LABEL 1        96300018
FL2RECFM DS    CL1                      RECORD FORMAT                   96400018
FL2BLKL  DS    CL5                      BLOCK LENGTH                    96500018
FL2LRECL DS    CL5                      BLOCKING FACTOR/RECORD LENGTH   96600018
FL2DEN   DS    CL1                      DENSITY                         96700018
FL2FILP  DS    CL1                      FILE POSITION                   96800018
FL2JSID  DS    0CL17                    JOB/STEP IDENTIFICATION         96900018
FL2JOBD  DS    CL8                      JOB IDENTIFICATION              97000018
FL2JSSP  DC    C'/'                     SLASH                           97100018
FL2STEPD DS    CL8                      STEP IDENTIFICATION             97200018
FL2TRTCH DS    CL2                      TAPE RECORDING TECHNIQUE        97300018
FL2CNTRL DS    CL1                      CARRIAGE CONTROL CHARACTER      97400018
FL2RES   DS    CL43                     RESERVED FOR FUTURE USE         97500018
FL2BFALN EQU   FL2RES                   BUFFER ALIGNMENT                97530018
FL2BLKA  EQU   FL2RES+1                 BLOCK ATTRIBUTE                 97560018
*                                                                       97600018
*                                                                       97700018
*                                                                       97800018
         END                                                            97900018
