         TITLE 'IGC0M05B - DIRECT ACCESS MOUNT/VERIFICATION PROCESSOR'  00100002
IGC0M05B START                                                          00300018
*                                                                       00306018
*    VS2   SU24   DELETIONS/CHANGES                            @G24LSFS 00306624
*249240                                                        @G24LSFS 00307224
*                                                              @ZM44640 00307624
*    VS/2  RELEASE  3 DELETIONS                                         00308003
*0000                                                          @Y30LSRA 00310003
* RELEASE 037 CHANGES ADDITIONS DELETIONS                               00311037
*A412160                                                       @ZA18267 00311537
*A157270,A401700,A412001-412008                                @ZA18335 00311724
*C157440                                                       @ZA24910 00311837
*A24918237-24918837,D24914203-24914403                         @ZA27287 00311924
*C15783037,C15789037                                           @ZA27488 00312524
* APAR OZ31488 HAS BEEN FLAGGED AS @ZSUT222                    @ZSUT222 00312824
*C157260-157290,237400,250381,412004,412005,608000             @ZSUT222 00313124
*A237800-238200,652164                                         @ZSUT222 00313324
*A400000-400270,400630-400720,400990-401080,483100-483600      @ZA31668 00313424
*D401700,412001-412008                                         @ZA31668 00313524
*C400810,410100                                                @ZA31668 00313624
*          RELEASE 18 DELETIONS                                         00313937
*          RELEASE 19 DELETIONS                                         00318018
*0521185500                                                      A27516 00321019
*0521158000,292000-293000,349000-351000,598000-599000            A27515 00322019
*0521158250,291700-292400,298000,571000,958500-959000            M4597  00323019
*0521345000-353000,359000                                        M2763  00323519
*          RELEASE 20 DELETIONS                                         00324018
*1560533000                                                      A36914 00325020
*1560158350,228000-241000,315000,422600,427000,429000,453000,    A30003 00326020
*1560455000,610000-619000                                        A30003 00328020
*1560182500,217000,235800,531000,575000,652000                   A33983 00329020
*1560271000                                                      A36176 00329520
*          RELEASE 21 DELETIONS                                         00330018
*0970273000,426000-427600,465000,550000-552000,572000-573000,    M0187  00330321
*0970575000,579000                                               M0187  00330621
*0970229400-230200                                               A42435 00331021
*0970                                                            A42221 00333021
*          RELEASE 22 DELETIONS                                         00336018
*          RELEASE 23 DELETIONS                                         00342018
*          RELEASE 24 DELETIONS                                         00348018
*          RELEASE 25 DELETIONS                                         00354018
*          RELEASE 26 DELETIONS                                         00360018
*                                                                       00366018
* STATUS CHANGE LEVEL 004                                               00372021
*                                                                       00378018
*********************************************************************** 00384018
*                                                                       00400018
*TITLE                                                                  00500018
*                                                                       00600018
*     DIRECT ACCESS MOUNT/VERIFICATION PROCESSOR                        00700018
*                                                                       00800018
*STATUS                                                                 00900018
*                                                                       01000018
*FUNCTION/OPERATION                                                     01100018
*                                                                       01200018
*        SEQ. & P.O. - CHECK VOLUME SERIAL IN TABLE AGAINST VOLUME      01300018
*        SERIAL IN THE SRTUCB INDICATED BY THE DATA SET'S TIOT ENTRY.   01400018
*                                                                       01500018
*        IF THE CORRECT VOLUME IS NOT MOUNTED, CHECK ALL THE SECONDARY  01600018
*        STRUCB'S INDICATED AND IF THE VOLUME IS FOUND TO BE MOUNTED    01700018
*        ON ONE OF THEM, EXCHANGE IT WITH THE PRIMARY SRTUCB.           01800018
*                                                                       01900018
*        IF THE CORRECT VOLUME IS NOT MOUNTED ANYWHERE FIND A USEABLE   02000018
*        UCB & ISSUE A MOUNT MESSAGE - ERROR IF NO AVAILABLE UCB.       02100018
*                                                              @Y30LSRA 02110003
*        IF THE UCB INDICATES A VIRTUAL DASD, THE MOUNT MESSAGE@Y30LSRA 02120003
*        IS INTERCEPTED AND A MESSAGE IS SENT TO  MSS TO MOUNT @Y30LSRA 02130003
*        A VIRTUAL VOLUME ON THE MSS  SYSTEM.  A DEMOUNT       @Y30LSRA 02140003
*        MESSAGE WILL PRECEDE THE MOUNT MESSAGE, BUT ONLY FOR  @Y30LSRA 02150003
*        MSS  DEVICES AND ONLY FOR NON SHARED AND ONLINE       @Y30LSRA 02160003
*        PACKS.                                                @Y30LSRA 02170003
*        FOR AN UNSUCCESSFUL MOUNT/DEMOUNT ACQUIRE/RELINQUISH  @Y30LSRA 02180003
*        A MESSAGE IS ISSUED. AN ERROR CODE OF 49 PLUS A BRANCH@Y30LSRA 02190003
*        TO THE MODULES'S EXIT ROUTINE IS ALSO ISSUED.         @Y30LSRA 02192003
*                                                                       02200018
*        BDAM, ISAM, P.O. CONCAT. & SEQ. CONCAT. - CHECK VOLUME SERIAL  02300018
*        IN TABLE (OR JFCB EXTENSION) AGAINST VOLUME SERIAL IN THE      02400018
*        UCB'S INDICATED BY THE DATA SET'S TIOT ENTRY. IF THE CORRECT   02500018
*        VOLUME IS NOT MOUNTED FIND THE 1ST AVAILABLE UCB AND ISSUE A   02600018
*        MOUNT MESSAGE. PLACE THE UCB ON WHICH IT IS MOUNTED IN THE     02700018
*        SAME RELATIVE ORDER AS THE VOLUME SERIAL NUMBER IN THE JFCB.   02800018
*                                                                       02900018
*        THE RESTART DATA SET IS BYPASSED AS MOUNTING HAS ALREADY       02950002
*        TAKEN PLACE.                                                   02960002
*                                                                       02970002
*        VAM DATA SETS - MOVE UCB ADDRESS FROM TIOT TO DEB AND          02980002
*        BYPASS THE REST OF DA MOUNTING PROCESSING.                     02990002
*                                                                       02992002
*        EACH TIME A VOLUME IS MOUNTED IT'S VOLUME SERIAL NUMBER IS     03000018
*        CHECKED. IF THE CORRECT VOLUME IS NOT MOUNTED,  MOUNT MESSAGE  03100018
*        IS RE-ISSUED.                                                  03200018
*                                                                       03300018
*        IF THE VOLUME SERIAL NUMBER FOR A VIRTUAL VOLUME IS   @Y30LSRA 03310003
*        INCORRECT, THE MESSAGE IS NOT RE-ISSUED.              @Y30LSRA 03320003
*                                                              @Y30LSRA 03330003
*        WHENEVER A VIRTUAL VOLUME IS MOUNTED, SPACE MUST BE   @Y30LSRA 03340003
*        GOTTEN ON A REAL DEVICE FOR STAGING IN THE VIRTUAL    @Y30LSRA 03350003
*        VOLUME.  THIS IS NOT DONE FOR VSAM OR ISAM DATA SETS. @Y30LSRA 03360003
*        VSAM WILL GET THEIR OWN SPACE, AND ISAM IS UNSUPPORTED@Y30LSRA 03370003
*                                                              @Y30LSRA 03380003
*ENTRY POINTS                                                           03400018
*                                                                       03500018
*                  IGC0M05B VIA XCTL FROM IGC0K05B                      03600018
*                                 OR FROM IGC0I05B                      03700018
*                                                                       03800018
*INPUT                                                                  03900018
*                                                                       04000018
*        REGISTER 8 - START OF DATA SET TABLE                           04100018
*        REGISTER 1 - RESTART WORKAREA                                  04200018
*        REGISTER 10 - RESTART WORKAREA                                 04250002
*                                                                       04300018
*OUTPUT                                                                 04400018
*                                                                       04500018
*        NOT APPLICABLE                                                 04600018
*                                                                       04700018
*EXTERNAL ROUTINES                                                      04800018
*                                                                       04900018
*                  NONE                                                 05000018
*                                                                       05100018
*EXITS                                                                  05200018
*                                                                       05300018
*      (1) TO IGC0L05B                                                  05400018
*               OR                                                      05500018
*      (2) TO IGC0N05B                                                  05600018
*               OR                                                      05700018
*      (3) TO IGC0V05B WITH ONE OF THE FOLLOWING ERROR CODES SET IN     05800024
*          THE RESTART WORK AREA:                                       05810024
*          45 - NO UCB AVAILABLE                                        05820024
*          48 - ERROR IN READ JFCB                                      05830024
*          49 - MSS ERROR                                               05840024
*          50 - VOLSER CHANGED BETWEEN CHECKPOINT AND RESTART           05850024
*                                                                       05900018
*TABLES/WORKAREAS -                                                     06000018
*                                                                       06100018
*********************************************************************** 06200018
*                                                                     * 06300018
*    THE FOLLOWING IS A DESCRIPTION OF THE 48 BYTE TABLE ENTRY THAT   * 06400018
*    IS USED IN THE RESTART PORTION OF CHECKPOINT/RESTART.  EACH      * 06500018
*    ENTRY IN THE TABLE (ONE FOR EACH OPEN DATA SET AT CHECKPOINT)    * 06600018
*    IS 48 BYTES LONG.                                                * 06700018
*                                                                     * 06800018
*********************************************************************** 06900018
*                                                                       07000018
*        ------------------- 4 BYTES -----------------                  07100018
*                                                                       07200018
*      0 +++++++++++++++++++++++++++++++++++++++++++++                  07300018
*        +DATA SET  +           DCB                  +                  07400018
*        + O-GN.    +         ADDRESS                +                  07500018
*        +++++++++++++++++++++++++++++++++++++++++++++ 4                07600018
*        +FLAG BYTE +    WORKAREA SEGMENT            +                  07700018
*        + NO. 1    +         ADDRESS                +                  07800018
*      8 +++++++++++++++++++++++++++++++++++++++++++++                  07900018
*        +NUMBER    +         JFCB TTR               +                  08000018
*        + OF VOLS  +         ADDRESS                +                  08100018
*        +++++++++++++++++++++++++++++++++++++++++++++ 12               08200018
*                                                                       08300018
*     12 +++++++++++++++++++++++                                        08400018
*        +TAPE LABL + FILE SEQ +        DEVICE = TAPE                   08500018
*        +INFO BYTE + NUMBER   +                                        08600018
*        +++++++++++++++++++++++                                        08700018
*                                                                       08800018
*     12 +++++++++++++++++++++++                                        08900018
*        +    OLD   TIOT       +        DA AND UNIT RECORD              09000018
*        +      OFFSET         +                                        09100018
*        +++++++++++++++++++++++                                        09200018
*                                                                       09300018
*                              +++++++++++++++++++++++                  09400018
*                              +FLAG BYTE +FLAG BYTE +                  09500018
*                              +  NO. 2   +  NO. 3   +                  09600018
*     16 +++++++++++++++++++++++++++++++++++++++++++++                  09700018
*        +FLAG BYTE +FLAG BYTE +                     +                  09800018
*        + NO. 4    + NO. 5    +   VOLUME ID NO. 1   +                  09900018
*        +++++++++++++++++++++++                     + 20               10000018
*        +                                           +                  10100018
*        +                                           +                  10200018
*     24 +++++++++++++++++++++++++++++++++++++++++++++                  10300018
*        +                                           +                  10400018
*        +   VOLUME ID NO. 2                         +                  10500018
*        +                     +++++++++++++++++++++++ 28               10600018
*        +                     +                     +                  10700018
*        +                     +   VOLUME ID NO. 3   +                  10800018
*     32 +++++++++++++++++++++++                     +                  10900018
*        +                                           +                  11000018
*        +                                           +                  11100018
*        +++++++++++++++++++++++++++++++++++++++++++++ 36               11200018
*        +                                           +                  11300018
*        +   VOLUME ID NO. 4                         +                  11400018
*     40 +                     +++++++++++++++++++++++                  11500018
*        +                     +                     +                  11600018
*        +                     +                     +                  11700018
*        +++++++++++++++++++++++   VOLUME ID NO. 5   + 44               11800018
*        +                                           +                  11900018
*        +                                           +                  12000018
*        +++++++++++++++++++++++++++++++++++++++++++++ 48               12100018
*                                                                       12200018
*                                                                       12300018
*ATTRIBUTES -                                                           12400018
*                                                                       12500018
*              RE-ENTRANT, ENABLED, PRIVILEGED                          12600018
*                                                                       12700018
*********************************************************************** 12800018
*                                                                       12900018
*    REGISTER CONVENTION TO BE USED THRU-OUT REPI/O PHASE               13000018
*                                                                       13100018
*********************************************************************** 13200018
*                                                                       13300018
WRKR1    EQU   0                   WORK/PARM REGISTER                   13400002
WRKR2    EQU   1                   WORK/PARM REGISTER                   13500002
DCBR     EQU   2                   CURRENT DCB REGISTER                 13600002
BASER    EQU   3                   BASE REGISTER                        13700002
DEBR     EQU   4                   CURRENT DEB REGISTER                 13800002
UCBR     EQU   5                   CURRENT UCB REGISTER                 13900002
TIOTR    EQU   6                   NEW TIOT REGISTER                    14000002
TCBR     EQU   7                   TCB REGISTER                         14100002
TABLR    EQU   8                   START OF DCB TABL REG                14200002
CTABLR   EQU   9                   CURRENT DCB IN TABL REG              14300002
BUFR     EQU   10                  USER BUFFER AREA                     14400002
DSCNTR   EQU   11                  NUMBER OF DATA SETS                  14500002
WRKR3    EQU   12                  WORK REGISTER                        14600002
WRKR4    EQU   13                  WORK REGISTER                        14700002
WRKR5    EQU   14                  WORK/PARM REGISTER                   14800002
WRKR6    EQU   15                  WORK/PARM REGISTER                   14900002
*                                                                       15000018
*********************************************************************** 15100018
*                                                                       15200018
*    OFFSETS TO BE USED IN REPI/O PHASE                                 15300018
*                                                                       15400018
*********************************************************************** 15500018
*                                                                       15600018
IS       EQU   X'80'               INDEXED SEQUENCIAL                   15603002
PS       EQU   X'40'               PHYSICAL SEQUENCIAL                  15606002
DA       EQU   X'20'               DIRECT ACCESS                        15609002
PO       EQU   X'02'               PARTITIONED ORGANIZATION             15612002
NULL     EQU   X'80'               NULLFILE OR SYSCHECK                 15615002
INOROUT  EQU   X'40'               SYSIN OR SYSOUT DATA SET             15618002
DADEV    EQU   X'20'               DA DEVICE                            15621002
UNITREC  EQU   X'04'               UNIT RECORD EQUIPMENT                15630002
ERRINNSL EQU   X'80'               ERROR IN NSL ROUTINE                 15633002
NSLMTSW  EQU   X'40'               NSL MOUNT SWITCH                     15636002
NSLCOMU  EQU   X'20'               NSL COMMUNICATION BIT                15639002
BYPASS   EQU   X'10'               BYPASS LABEL PROCESSING              15642002
NSL      EQU   X'04'               NON-STANDARD LABEL                   15645002
SL       EQU   X'02'               STANDARD LABEL                       15648002
NL       EQU   X'01'               NO LABEL                             15651002
FIVE     EQU   5                   CONSTANT 5                    YM5513 15655402
POCONCAT EQU   X'40'               P.O. CONCATENATED                    15657002
DAFLAG   EQU   X'80'               DA DATA SET FLAG                     15660002
NONDAFLG EQU   X'40'               NON-DA DATA SET FLAG                 15663002
NSLFLAG  EQU   X'10'               NSL ROUTINE FLAG                     15666002
TYPERST  EQU   X'80'               IMMEDIATE RESTART                    15669002
TABENT   EQU   48                  TABLE ENTRY LENGTH                   15672002
WRITE    EQU   X'01'               WRITE ON TAPE                        15675002
READ     EQU   X'02'               READ FOR TAPE                        15678002
NOPOP    EQU   X'03'               NOP                                  15681002
SENSE    EQU   X'04'               SENSE                                15684002
REWIND   EQU   X'07'               REWIND                               15687002
READBACK EQU   X'0C'               READBACK                             15690002
UNLOAD   EQU   X'0F'               REWIND AND UNLOAD                    15693002
WTM      EQU   X'1F'               WRITE TAPE MARK                      15696002
BSFOP    EQU   X'2F'               BACKWARD SPACE FILE                  15699002
FSFOP    EQU   X'3F'               FORWARD SPACE FILE                   15702002
SEARCH   EQU   X'31'               SEARCH                               15705002
SRCHCNT  EQU   X'05'               COUNT FOR SEARCH ID                  15708002
TIC      EQU   X'08'               TIC                                  15711002
READDA   EQU   X'06'               READ FOR DA                          15714002
LENJFCB  EQU   X'B0'               LENGTH OF JFCB                       15717002
LBLLEN   EQU   X'50'               LENGTH OF LABEL                      15720002
PERMERR  EQU   X'7F'               PERMANENT ERROR                      15723002
ERR045   EQU   45                  NO UCB AVAILABLE            @ZSUT222 15726024
ERR050   EQU   50                  VOLSER NOT EQUAL            @ZSUT222 15727024
ERR048   EQU   48                  ERROR IN READ JFCB          @ZSUT222 15728024
ERR049   EQU   49                  MSS ERROR CODE              @ZSUT222 15729024
EOVOLSER EQU   X'40'               END OF VOL SER LIST                  15732002
MOUNTON  EQU   X'80'               MOUNT SWITCH ON                      15735002
ONE      EQU   X'01'               CONSTANT ONE                         15738002
PERMRES  EQU   X'26'               PERMANENT RESIDENT OR SYSTEM         15741002
DMCOUNT0 EQU   X'7F'               DATA MANAGEMENT COUNT 0     @ZA24910 15744037
MSGLEN   EQU   X'1A'               MSG LENGTH                           15750002
SLASH    EQU   C'/'                SLASH                                15753002
COMMA    EQU   C','                COMMA                                15756002
SIGNOFF  EQU   X'F0'               REMOVE SIGN BIT                      15759002
NOTREADY EQU   X'40'               NOT READY SWITCH                     15762002
REC3     EQU   X'03'               CYL 0 - TRK 0 - REC 3                15765002
FILEMASK EQU   X'18'               FILE MASK                            15768002
CHAIN    EQU   X'40'               CHAINING FLAG                        15771002
MOUNTOFF EQU   X'7F'               MOUNT SWITCH OFF                     15774002
DSONDEV  EQU   X'80'               DATA SET ON DEVICE                   15777002
SWON     EQU   X'20'               PROCESSING SWITCH ON        @ZA27488 15783037
BLANK    EQU   C' '                BLANK CHARACTER                      15785037
POORIS   EQU   PO+IS               P.O. OR I.S.                         15787037
SWOFF    EQU   X'DF'               PROCESSING SWITCH OFF       @ZA27488 15789037
ZERO     EQU   X'00'               ZERO CONSTANT                        15795002
SCRATCHV EQU   X'10'               SCRTCH PACK INDICATOR       @Y30LSRA 15796003
VIRTDASD EQU   X'08'               VIRT DASD MASK              @Y30LSRA 15797003
SHARED   EQU   X'80'               SHARED DEVICE               @Y30LSRA 15797603
ONLINE   EQU   X'80'               ONLINE DEVICE               @Y30LSRA 15797803
ACQ      EQU   X'02'               ACQUIRE OP CODE             @Y30LSRA 15798203
AROP     EQU   4                   DISP. OPCODE IN PARM LIST   @ZM44640 15798424
REL      EQU   X'04'               RELINQUISH OP CODE          @Y30LSRA 15798603
MNT      EQU   X'08'               MOUNT OP CODE               @Y30LSRA 15798703
DMNT     EQU   X'06'               DEMOUNT OP CODE             @Y30LSRA 15798803
R15      EQU   15                  REGISTER 15                 @Y30LSRA 15798903
DECZRO   EQU   X'F0'               DECIMAL ZERO                @Y30LSRA 15802903
ACQPLN   EQU   96                  ACQ PARM LST LENGTH         @Y30LSRA 15807003
K3       EQU   3                   CONSTANT OF 3                 A27515 15811003
K4       EQU   4                   CONSTANT OF 4                 A27515 15815002
NOMIX    EQU   11                  MASK FOR NOT MIXED            A27515 15845002
D0       EQU   0                   ZERO                          Y02076 15847002
D1       EQU   1                   ONE                           Y02076 15849002
D2       EQU   2                   TWO                           Y02076 15851002
D3       EQU   3                   THREE                         Y02076 15853002
D4       EQU   4                   FOUR                          Y02076 15853402
D5       EQU   5                   FIVE                          Y02076 15853802
D6       EQU   6                   SIX                           Y02076 15854202
D7       EQU   7                   SEVEN                         Y02076 15854602
D8       EQU   8                   EIGHT                         Y02076 15854702
D9       EQU   9                   NINE                          Y02076 15854802
D10      EQU   10                  TEN                         @Y30LSRA 15855803
D12      EQU   12                  TWELVE                      @Y30LSRA 15856203
D21      EQU   21                  TWENTY-ONE                  @Y30LSRA 15856803
D23      EQU   23                  TWENTY-THREE                @Y30LSRA 15866803
D24      EQU   24                  TWENTY FOUR                   Y02076 15869902
D27      EQU   27                  TWENTY-SEVEN                @Y30LSRA 15870003
D26      EQU   26                  TWENTY SIX                  @Y30LSRA 15870303
D28      EQU   28                  TWENTY EIGHT                @Y30LSRA 15870903
D33      EQU   33                  THIRTY THREE                @Y30LSRA 15871903
D40      EQU   40                  FORTY                         Y02076 15879902
D51      EQU   51                  FIFTY-ONE                   @Y30LSRA 15880003
D67      EQU   67                  SIXTY-SEVEN                 @Y30LSRA 15881503
D69      EQU   69                  SIXTY-NINE                  @Y30LSRA 15882303
D92      EQU   92                  NINETY-TWO                  @Y30LSRA 15882703
L2       EQU   2                   LENGTH OF TWO               @Y30LSRA 15883503
L3       EQU   3                   3                           @Y30LSRA 15885003
L4       EQU   4                   LENGTH OF FOUR              @Y30LSRA 15886503
L6       EQU   6                   LENGTH OF SIX               @Y30LSRA 15888003
L8       EQU   8                   LENGTH OF EIGHT             @Y30SLRS 15889503
L11      EQU   11                  LENGTH OF ELEVEN            @Y30LSRA 15891003
L28      EQU   28                  LENGTH OF TWENTY-EIGHT      @ZM33364 15892503
L80      EQU   80                  LENGTH OF EIGHTY            @Y30LSRA 15894003
L100     EQU   100                 LENGTH OF ONE HUNDRED       @Y30LSRA 15895503
EXCHPGM  EQU   X'80'               EXCP INDICATOR IN MACRF       YM5512 15897003
*                                                                       15898503
*********************************************************************** 15900018
*                                                                       16000018
         USING TABL,WRKR4          CURRENT TABLE ENTRY                  16100018
         USING MNTTIOT,TIOTR       NEW TIOT                             16200018
         USING UCBOB,UCBR          UCB                           YM7868 16300002
         USING MNTTCB,TCBR         TCB                                  16400018
         USING RSDSECT,DEBR        WORK AREA                            16500018
         USING IHADCB,CTABLR       DCB                                  16600018
         USING RSTWA,BUFR          RESTART WORK AREA                    16700002
*                                                                       16800018
*********************************************************************** 16900018
*                                                                       17000018
*                                  INITIALIZE REGISTERS                 17100018
*                                                                       17200018
*********************************************************************** 17300018
*                                                                       17400018
         BALR  BASER,0             SET UP BASE REGISTER                 17500018
         USING *,BASER                                                  17600018
         B     BEGIN               BRANCH AROUND EYE CATCHER     Y01909 17650000
         CNOP  0,8                 ALIGN TO A DBL WORD BOUNDARY  Y01909 17660000
         DC    CL8'IGC0M05B'       MODULE NAME                 @ZSUT222 17670024
         DC    CL8'&SYSDATE'       LAST DATE SHIPPED           @ZSUT222 17672024
         DC    CL8'@ZA31668'       LAST CODE SHIPPED           @ZSUT222 17674024
         DC    CL8'@SU82400'       SELECTABLE UNIT IDENT.      @ZSUT222 17676024
BEGIN    EQU   *                                                 Y01909 17680000
*                                                                       17700018
*        INITIALIZE PERTINENT REGISTERS                                 17800018
*                                                                       17900018
         L     TCBR,RSTCBAD        PICK UP TCB ADDRESS                  18000002
         L     TIOTR,TCBTIO        PICK UP TIOT ADDRESS                 18100002
         LA    TIOTR,D0(TIOTR)     ADR ONLY                      Y02076 18150002
         LR    WRKR4,TABLR         TABLE ADDRESS TO WRKR4               18200018
         L     DEBR,TABSEGAD-1     PICK UP WORKAREA ADDRESS      A27516 18220019
         MVI   RSPPM+4,C'L'        SET UP XCTL LIST              A33983 18260020
*********************************************************************** 18270002
*   GET SPACE FOR QMNGRIO PARAMETER LIST AND WORKAREA THEN INITIALIZE * 18280002
*   IT.  QMNGRIO IS USED FOR READING IN THE JFCB FROM THE SCHEDULER   * 18290002
*   WORK AREA (SWA).                                                  * 18292002
*********************************************************************** 18294002
         ICM   WRKR1,ADDRBYTS,QMNPRMLN  LENGTH OF PARM LIST+WA   Y02076 18296002
         ICM   WRKR1,HIORDER,SP253 SUBPOOL 253                   Y02076 18298002
         GETMAIN  R,LV=(D0)        ISSUE GETMAIN FOR SPACE       Y02076 18298402
         USING QMIOP,WRKR2                                       Y02076 18298802
         XC    QMITCBAD(D24),QMITCBAD CLEAR PARM LIST            Y02076 18299202
         ST    TCBR,QMITCBAD       STORE TCB ADR IN PRM L.       Y02076 18299602
         LA    WRKR1,QMWRKOFT      GET WORK AREA OFFSET          Y02076 18299802
         AR    WRKR1,WRKR2         CALC ADR OF WORK AREA         Y02076 18299902
         ST    WRKR1,QMIWRKAD      STORE IN PARM LIST            Y02076 18300002
         LA    WRKR1,JFCBLNGH      GET LENGTH OF JFCB            Y02076 18333202
         STH   WRKR1,QMIRECL       STORE RECORD LENGTH           Y02076 18343202
         MVI   QMIFLAGS,QMIOREAD   SET READ FUNCTION             Y02076 18353202
         ST    WRKR2,QMNPRMWA      SAVE ADR OF PARM LIST         Y02076 18363202
         DROP  WRKR2                                             Y02076 18365202
*                                                                       18365302
*        IN ORDER TO PREVENT A NON-CANCELABLE SITUATION IN THE   YM7890 18365602
*        EVENT THE MEMORY IS SWAPPED OUT WITH AN OUTSTANDING     YM7890 18366002
*        MOUNT, ISSUE A SYSEVENT TO INHIBIT SWAP-OUT.            YM7890 18366402
*                                                                YM7890 18366502
         SYSEVENT DONTSWAP         INHIBIT SWAP-OUT              YM7890 18366602
*                                                                YM7890 18377702
MNTDA005 EQU   *                                                        18400018
         L     CTABLR,TABDCBAD-1   PICK UP DCB ADDRESS                  18470018
         MVC   RSJFCB+164(3),TABJFCB SAVE TTR OF JFCB.                  18580002
         TM    TABFLG1,TABDA       D.A.                                 18620002
         BZ    MNTDA105            BRANCH IF NOT D.A.                   18700018
*                                                                       18800018
         TM    TABFLG1,TABSYS      IS IT SUBSYS DATA SET         Y02076 18870002
         BO    MNTDA105            YES-BR OVER MOUNT             Y02076 18880002
         MVC   RSJFCB1+4(30),TABVLID1 MOVE VOL SER NO TO WORK AREA      18900018
         MVI   RSJFCB1+34,EOVOLSER FLAG END OF VOL SER LIST             19000018
         LA    DSCNTR,RSJFCB1+4    SET VOL SER NO POINTER               19100018
         LH    WRKR5,DCBTIOT       PICK UP TIOT OFFSET                  19300018
         SR    WRKR6,WRKR6         CLEAR                                19400002
         IC    WRKR6,0(TIOTR,WRKR5) LENGTH OF DD ENTRY                  19500018
         AR    WRKR6,TIOTR         TIOTR ADDRESS                        19600002
         AR    WRKR6,WRKR5         ADD OFFSET                           19700002
         ST    WRKR6,RSJFCB+160    SAVE 'END OF DD ENTRY' POINTER       19800002
*                                                                       19900018
*                                  POINTS TO DDNAME                     20000018
*                                                                       20100018
         LA    WRKR5,16(WRKR5)     DISPLACEMENT TO 1ST UCB              20200018
         LR    TCBR,WRKR5          POINT TO BEGINNING OF UCB'S TO BE    20300018
*                                  CHECKED                              20400018
         BAL   WRKR2,MNTDA116      GET 1ST AVAIL UCB ADDR        YM7868 20500002
*                                                                       20600018
MNTDA010 EQU   *                                                        20700018
*                                                                YM7550 20750002
*        VIO DATA SETS ARE ALLOCATED WITH ONLY ONE PSEUDO        YM7550 20760002
*        DEVICE WHICH DOES NOT REQUIRE VOLUME MOUNTING.          YM7550 20770002
*                                                                YM7550 20780002
         TM    UCBJBNR,UCBVRDEV    VIO PSEUDO DEVICE             YM7550 20790002
         BNO   MNTDA013            IF NOT, CONTINUE              YM7550 20792002
         TM    TABFLG2,TABRSDS     IS THIS THE RESTART D/S       YM7579 20792402
         BO    MNTDA070            IF SO, LEAVE D/M COUNT ALONE  YM7579 20792802
         IC    DCBR,UCBDMCT        UPDATE THE DATA               YM7550 20794002
         LA    DCBR,D1(,DCBR)        MANAGEMENT COUNT            YM7550 20796002
         STC   DCBR,UCBDMCT            BY ONE                    YM7550 20798002
         B     MNTDA070            SKIP VOLUME MOUNTING          YM7550 20798402
*                                                                       20800018
MNTDA013 EQU   *                   NON-VIO ENTRY                 YM7550 20850002
         TM    UCBDMCT,MOUNTON     IS MOUNT SWITCH ON            YM7868 20900002
         BO    MNTDA040            BRANCH IF YES                        21000018
         CLC   0(6,DSCNTR),UCBVOLI CORRECT VOLUME MOUNTED        YM7868 21100002
         BE    MNTDA040            BRANCH IF YES                        21200018
*                                                                       21300018
MNTDA015 EQU   *                                                        21400018
         BAL   WRKR2,MNTDA115      GO TO 'GET NEXT UCB' ROUTINE         21500018
*                                                                       21600018
         BC    3,MNTDA010          BR IF NOT LAST UCB - COND     A33983 21700020
*                                  CODE SET IN 'GET NEXT UCB' ROUTINE   21800018
*                                                                       21900018
*********************************************************************** 22000018
*                                                                       22100018
* THE VOLUME WAS NOT MOUNTED - FIND AN AVAILABLE UCB AND MOUNT THE      22200018
* VOLUME.                                                               22300018
*                                                                       22400018
*********************************************************************** 22500018
*                                                                       22600018
         LR    WRKR5,TCBR          1ST AVAILABLE UCB POINTER     YM7868 22700002
         BAL   WRKR2,MNTDA116      GET 1ST AVAIL UCB ADDR        YM7868 22780002
MNTDA020 EQU   *                                                 A30003 22860020
         TM    UCBSTAT,PERMRES     IS DEVICE PERM RES OR SYS     YM7868 23100002
         BNE   MNTDA025            BR IF YES                     A30003 23180020
         TM    UCBDMCT,DMCOUNT0    DATA MANAGEMENT COUNT=0       YM7868 23260002
         BZ    MNTDA028            BR IF 0                       A30003 23340020
MNTDA025 EQU   *                                                 A30003 23420020
         BAL   WRKR2,MNTDA115      GO TO 'GET NEXT UCB' ROUTINE  A30003 23500020
         BC    3,MNTDA020          BR IF NOT LAST UCB            A33983 23580020
MNTDA026 EQU   *                                                 A30003 23660020
         MVI   RSRETCOD+1,ERR045   NO UCB AVAIL,RETURN CODE 45 @ZSUT222 23740024
MNTDA027 EQU   *                                                 A30003 23760024
         MVC   RSREGSAV(8),MODID   SAVE NAME OF MODULE THAT    @ZSUT222 23780024
*                                  HAS DETECTED THE ERROR.     @ZSUT222 23800024
         STM   0,15,RSREGSAV+8     SAVE CURRENT REGISTERS      @ZSUT222 23820024
         MVI   RSPPM+4,C'V'        XCTL TO IGC0V05B              A30003 23900020
         B     MNTDA160                                          A30003 23980020
*                                                                       24200018
*********************************************************************** 24300018
*                                                                       24400018
* VOLUME CAN BE MOUNTED- PREPARE TO ISSUE MOUNT MESSAGE                 24500018
*                                                                       24600018
*********************************************************************** 24700018
*                                                                       24800018
MNTDA028 EQU   *                                                        24900018
*                                                              @Y30LSRA 24901003
         USING UCBOB,UCBR          ADDRESSING MAIN UCB         @Y30LSRA 24902003
         L     UCBR,RSDEBUCB       PICK UP MAIN UCB ADDRESS    @Y30LSRA 24903003
         OI    UCBFL2,NOTREADY     SET NOT READY SWITCH ON     @Y30LSRA 24904003
***************************************************************@Y30LSRA 24906003
*        IF THE DASD TO BE MOUNTED IS VIRTUAL, THE WTO MUST BE @Y30LSRA 24907003
*        INTERCEPTED AND A MESSAGE SENT TO MSS  INSTEAD.       @Y30LSRA 24908003
*        FOR MSS ONLY,IF A  VOLUME EXISTS ON THE VIRTUAL DRIV  @Y30LSRA 24909003
*        AND IS DEMOUNTABLE, A DEMOUNT MESSAGE IS SENT TO MSS  @Y30LSRA 24910003
*        BEFORE THE MOUNT MESSAGE IS SENT.                     @Y30LSRA 24911003
***************************************************************@Y30LSRA 24912003
         TM    UCBTBYT2,VIRTDASD   IS VIRTUAL DEVICE INDICATED @Y30LSRA 24913003
         BNO   MNTDA02D            NO, FORGET MSS  PROCESSING  @Y30LSRA 24914003
         TM    UCBSTAT,ONLINE      IS DRIVE ONLINE             @Y30LSRA 24914603
         BZ    MNTDA026            NO, CANNOT DEMOUNT          @ZM30037 24914803
         CLC   UCBVOLI(L6),ZEROS   ANY PACK MOUNTED            @Y30LSRA 24915003
         BE    MNTDA029            NO, FORGET DEMOUNT          @Y30LSRA 24916003
         CLC   UCBVOLI(L6),BLANKS  IS ANYTHING MOUNTED         @ZM30037 24917003
         BE    MNTDA029            NO, NOTHING MOUNTED         @ZM30037 24918003
* CHECK IF THE CURRENT VOLUME MOUNTED HAS UNIT=AFF,            @ZA27287 24918237
* MORE VOL SERIALS THAN UNITS OR DEFER MOUNTING.               @ZA27287 24918437
         TM    UCBSTAB,SHARED      IS DRIVE SHAREABLE ?        @ZA27287 24918637
         BO    MNTDA026            YES, CANT MOUNT ON UCB      @ZA27287 24918837
         LA    WRKR2,RSJFCB        DEMOUNT, GET WORK AREA      @ZM30037 24919003
         XC    D0(L28,WRKR2),D0(WRKR2) ZERO OUT THE WORK AREA  @ZM33364 24920003
         MVC   RSJFCB+D8(L6),UCBVOLI  MOVE IN VOLID - DEMOUNT  @Y30LSRA 24921003
         ICBMNTDE TYPE=DMNT,VUA=UCBCHA,                        @G24LSFS*24924024
               MF=(E,(1))                                               24924524
         LTR   WRKR6,WRKR6         ANY ERRORS                  @Y30LSRA 24925003
         BNZ   MNTDA02C            YES, DO NOTHING             @ZM30037 24926003
MNTDA029 EQU   *                                               @Y30LSRA 24927003
         OI    SRTEDMCT,MOUNTON    SET MOUNT SW ON             @Y30LSRA 24928003
         LA    WRKR2,RSJFCB        GET READ IN AREA            @Y30LSRA 24931003
         XC    D0(L28,WRKR2),D0(WRKR2) CLEAR IT OUT FOR LIST   @ZM33364 24932003
         CLC   SCRTCH,D0(DSCNTR)   MOUNTING SCRATCH            @Y30LSRA 24933003
         BNE   MNTDA02A            NO, DON'T SET SCRTCH BIT    @Y30LSRA 24934003
         OI    D6(WRKR2),SCRATCHV  YES, MOUNT SCRATCH          @Y30LSRA 24935003
         B     MNTDA02B            FORGET VOLID FOR SCRTCH     @Y30LSRA 24935203
MNTDA02A EQU   *                                               @Y30LSRA 24935403
         MVC   RSJFCB+D8(L6),D0(DSCNTR) MOVE IN VOLID          @Y30LSRA 24935603
MNTDA02B EQU   *                                               @Y30LSRA 24935803
         ICBMNTDE TYPE=MNT,VUA=UCBCHA,MF=(E,(1))               @Y30LSRA 24939003
         LTR   WRKR6,WRKR6         ANY ERRORS OCCUR            @Y30LSRA 24940003
         BZ    MNTDA040            NO, ALL OK - CONTINUE       @Y30LSRA 24941003
MNTDA02C EQU   *                                               @Y30LSRA 24942003
         STH   WRKR1,D0(WRKR2)     SAVE  DATA IN REGISTER 0    @Y30LSRA 24942403
         MVC   MSGAREA(MSGLENTH-MSSMSG),MSSMSG  SET UP MSG     @Y30LSRA 24942803
         L     R15,CVTPTR          GET CVT ADDR                @Y30LSRA 24942903
         L     R15,D0(,R15)         GET ADDR OF TCB  WORDS     @Y30LSRA 24954303
         L     R15,D4(,R15)         GET CURRENT TCB PTR        @Y30LSRA 24964303
         L     R15,D12(,R15)       GET TIOT PTR                @Y30LSRA 24964703
         MVC   MSGAREA+D12(L8),D0(R15) GET JOBNME              @Y30LSRA 24965103
         MVC   MSGAREA+D21(L6),D8(WRKR2) GET VOLSER IN MSG     @Y30LSRA 24965503
         CLI   D4(WRKR2),ACQ       TEST FOR ACQUIRE            @Y30LSRA 24965603
         BE    MNTDA03D            YES--NO DDD                 @Y30LSRA 24965703
         CLI   D4(WRKR2),REL       TEST FOR RELINQUISH         @Y30LSRA 24969503
         BE    MNTDA03D            YES--NO DDD                 @Y30LSRA 24971503
         MVC   MSGAREA+D28(L3),UCBNAME  INSERT UNIT ID         @Y30LSRA 24971903
         B     MNTDA03E            CONTINUE PROCESSING MSG     @Y30LSRA 24972303
MNTDA03D MVI   MSGAREA+D27,BLANK   INSERT BLANK IN MSG         @Y30LSRA 24972703
         MVC   MSGAREA+D28(L3),MSGAREA+D27  BLANK DDD          @Y30LSRA 24973103
MNTDA03E CLI   D4(WRKR2),MNT       TEST FOR MOUNT              @Y30LSRA 24973203
         BNE   MNTDA03F            NO                          @Y30LSRA 24973303
         MVC   MSGAREA+D51(L11),KMNT   INSERT MOUNT IN MSG     @Y30LSRA 24977103
         B     MNTDA03K            CONTINUE PROCESSING MSG     @Y30LSRA 24979103
MNTDA03F CLI   D4(WRKR2),DMNT      TEST DEMOUNT                @Y30LSRA 24979503
         BNE   MNTDA03G            NO                          @Y30LSRA 24979903
         MVC   MSGAREA+D51(L11),KDMNT INSERT DEMOUNT IN MSG    @Y30LSRA 24980303
         B     MNTDA03K            CONTINUE PROCESSING MSG     @Y30LSRA 24980703
MNTDA03G CLI   D4(WRKR2),ACQ       TEST FOR ACQUIRE            @Y30LSRA 24980803
         BNE   MNTDA03H            NO--RELINQUIST              @Y30LSRA 24980903
         MVC   MSGAREA+D51(L11),KACQ INSERT ACQUIRE            @Y30LSRA 24984703
MNTDA03H LH    WRKR6,D26(,WRKR2)   GET REASON CODE             @ZM30037 24987103
         LTR   WRKR6,WRKR6         TEST FOR NON-ZERO           @Y30LSRA 24987503
         BNZ   MNTDA03J            YES,USE CODE IN MSG         @Y30LSRA 24987903
         L     WRKR3,D92(,WRKR2)   GET NEST LIST PTR           @Y30LSRA 24988303
         LTR   WRKR3,WRKR3         TEST FOR ZERO               @Y30LSRA 24988403
         BZ    MNTDA03J            YES,USE CODE ONLIST         @Y30LSRA 24988503
         LR    WRKR2,WRKR3         SET NEW LIST PTR            @Y30LSRA 25007003
         B     MNTDA03H            EXAMINE RESSON CODE         @Y30LSRA 25017003
MNTDA03K LH    WRKR6,D0(WRKR2)     GET REASON CODE             @Y30LSRA 25021003
MNTDA03J SLL   WRKR6,D4            SHIFT FOUR BITS             @ZM30037 25023003
         STH   WRKR6,D0(WRKR2)     RESET REASON CODE           @Y30LSRA 25025003
         UNPK  MSGAREA+D67(L3),D0(L2,WRKR2)  UNPACK CODE       @Y30LSRA 25025403
         OI    MSGAREA+D69,DECZRO  INSURE VALID DIGIT          @Y30LSRA 25025803
         TR    MSGAREA+D67(L3),ABTABLE  MAKE PRINTABLE         @Y30LSRA 25025903
         LR    WRKR3,WRKR2         SAVE PTR TO WORKAREA        @Y30LSRA 25032103
         LA    WRKR2,MSGAREA       GET ADDR OF MSGAREA         @Y30LSRA 25032503
         WTO   MF=(E,(1))          ISSUE WTO,WTP               @Y30LSRA 25034103
         LR    WRKR2,WRKR3         RESTORE PTR TO WORKAREA     @Y30LSRA 25036103
         MVI   RSRETCOD+D1,ERR049  SET MSS ERROR CODE          @ZSUT222 25038124
         B     MNTDA027            BRANCH TO EXIT ROUTINE      @Y30LSRA 25055024
MNTDA02D EQU   *                                               @Y30LSRA 25063003
         MVC   MSGAREA(19),MOUNTMS MOUNT INFO TO MESSAGE AREA.          25081503
         MVC   MSGID(6),0(DSCNTR)  VOL ID TO MESSAGE AREA.              25100018
         MVC   MSGID+6(4),RTDESC   MOVE ROUTE AND DESCRIPTOR        MCS 25130018
*                                  CODES TO MESSAGE                 MCS 25160018
*                                                                       25500018
         MVI   MSGAREA+1,MSGLEN    INSERT MSG LENGTH FOR 2321           25600018
         MVI   MSGID-1,SLASH       MOVE SLASH TO MESSAGE                25700018
         MVI   MSGID+1,COMMA       MOVE COMMA TO MESSAGE                25800018
         MVC   MSGID(1),RSIOBDAD+2 MOVE IN BINARY NUMBER                25900018
         OI    MSGID,SIGNOFF       CONVERT TO DECIMAL NUMBER            25970018
         MVC   MSGID+2(6),0(DSCNTR) VOL ID TO MESSAGE AREA              26050002
         MVC   MSGID+8(4),RTDESC   MOVE ROUTE AND DESCRIPTOR        MCS 26060018
*                                  CODES TO MESSAGE                 MCS 26070018
*                                                                       26300018
MNTDA030 EQU   *                                                        26400018
*                                                                       26500018
         OI    SRTEDMCT,MOUNTON         SET MOUNT SW ON          A42221 26501003
         MVC   MSGUCB(3),UCBNAME   UNIT NAME                            26800018
*                                                                       27000018
*                                                                       27200018
         LA    WRKR2,MSGAREA       MESSAGE AREA ADDRESS IN REG. 1       27400018
*                                                                       27500018
         WTO   MF=(E,(1))          WRITE TO OPERATOR                    27600018
         ST    WRKR2,RSMWOFST      SAVE MSGID FOR DOM               MCS 27630018
         OI    RSMWOFST,X'80'      INDICATE DOM MUST BE ISSUED      MCS 27660018
*                                                                       27700018
*********************************************************************** 27800018
*                                                                       27900018
* PREPARE TO READ IN VOLUME SERIAL NUMBER                               28000018
*                                                                       28100018
*********************************************************************** 28200018
*                                                                       28300018
MNTDA040 EQU   *                                                        28400018
*                                                                       28500018
         MVI   RSIOBDAD+7,REC3     CYL 0 - TRK 0 - REC 3                28600018
         MVI   RSDEBUCB,FILEMASK   SET FILE MASK                        28700018
*                                                                       28705021
* TO READ VOLUME LABEL AND CONVERT VTOC ADDRESS TO TTR, DEB EXTENTS     28710021
* MUST BE SET TO COVER ENTIRE VOLUME.  LOW CCHH IS ZERO, AND HIGH       28715021
* CC + 1 IS OBTAINED FROM SYSTEM DEVICE CHARACTERISTICS TABLE.          28720021
*                                                                       28725021
         L     WRKR2,CVTPTR        LOAD CVT POINTER              M0187  28730021
         USING CVT,WRKR2                                         M0187  28735021
         L     WRKR2,CVTZDTAB      LOAD DEVTAB POINTER           M0187  28740021
         DROP  WRKR2                                             M0187  28745021
         IC    WRKR6,UCBTBYT4      GET DEVICE TYPE BYTE          M0187  28750021
         LA    WRKR1,X'0F'         GENERATE MASK                 M0187  28755021
         NR    WRKR6,WRKR1         USE LO-ORDER BITS FOR INDEX   M0187  28760021
         AR    WRKR2,WRKR6         POINT TO DEVTAB ENTRY         M0187  28765021
         IC    WRKR6,0(WRKR6,WRKR2) PICK UP NEXT INDEX           M0187  28770021
         XC    RSDEBSCC(8),RSDEBSCC CLEAR DEB EXTENTS            M0187  28775021
         MVC   RSDEBECC,0(WRKR2)   SET HIGH CYLINDER ADDR.       M0187  28780021
*                                                                       28800018
*        SEARCH ID                                                      28820019
*        TIC                                                            28840019
*        READ                                                           28860019
*                                                                       28880019
         LA    WRKR2,RSIOBDAD+3    DISK ADDR OF VOL LAB                 28900002
         ST    WRKR2,RSCCW1        PLACE IN CHANNEL PROGRAM             29000002
         MVI   RSCCW1,SEARCH       COMMAND CODE TO CCW1 (SEARCH ID EQ)  29100018
         MVC   RSCCW1+4(4),CHAIN5  RESTORE FLAG AND COUNT FIELDS M4597  29150019
*                                                                       29200019
         MVI   RSCCW2,TIC          RESTORE TIC COMMAND           M4597  29250019
         MVC   RSCCW2+1(K3),RSIOBCPA+1 NEXT CCW ADDR TO TIC CCW  A27515 29310019
*                                                                       29400018
         LA    WRKR1,RSJFCB        JFCB AREA ADDRESS                    29500002
         ST    WRKR1,RSCCW3        ADDRESS TO CCW                       29600002
         MVI   RSCCW3,READDA       RESTORE OP CODE (READ)               29700018
         LA    WRKR1,LBLLEN        FLAGS AND DATA LENGTH         M4597  29760019
         ST    WRKR1,RSCCW3+4      RESTORE FLAG AND DATA LENGTH  M4597  29820019
*                                                                       29900018
*        READ IN VOLUME LABEL                                           30000018
*                                                                       30100018
         BAL   DCBR,MNTDA135       EXCP/WAIT ROUTINE                    30200018
*                                                                       30300018
         CLC   0(6,DSCNTR),RSJFCB+4 WAS CORRECT VOLUME MOUNTED          30400018
         BE    MNTDA045            YES, CONTINUE AS USUAL      @Y30LSRA 30500003
         TM    UCBTBYT2,VIRTDASD   VIRT VOL MOUNT              @Y30LSRA 30510003
         BZ    MNTDA028            NO, GO REQUEST REMOUNT      @Y30LSRA 30520003
         B     MNTDA026            YES, ERROR -ABEND JOB       @ZM30037 30530003
MNTDA045 EQU   *                                               @Y30LSRA 30540003
*                                                                       30600018
         MVC   UCBVOLI(6),RSJFCB+4 MOVE VOL SER NO. TO UCB       YM7868 30700002
         NI    UCBDMCT,MOUNTOFF    RESET MOUNT SW                YM7868 30770002
         LA    CTABLR,0(CTABLR)    CLEAR HIGH ORDER BYTE                30850018
         CL    CTABLR,RSCKDCB      IS THIS THE CHECKPOINT DCB           30900002
         BE    MNTDA042            BRANCH IF YES                        31000002
         L     WRKR1,UCBDMCT-3     GET WORD WITH D/M COUNT       YM7868 31050002
MNTDA041 EQU   *                   RETRY ENTRY                   YM7868 31100002
         LR    WRKR2,WRKR1         GET CURRENT VALUE FOR UPDATE  YM7868 31150002
         A     WRKR2,F1            BUMP D/M COUNT BY 1           YM7868 31200002
         CS    WRKR1,WRKR2,UCBDMCT-3 ATTEMPT TO UPDATE UCB       YM7868 31250002
         BNE   MNTDA041            TRY AGAIN IF UPDATE FAILED    YM7868 31300002
MNTDA042 EQU    *                                                       31400018
*                                                                       31600018
* CONVERT VTOC ADDR TO TTR FORM AND PLACE IN UCB                        31700018
*                                                                       31800018
         MVC   RSIOBDAD+3(5),RSJFCB+11 GET CCHHR VTOC ADDR FROM LABEL   31900018
         ST    TCBR,RSSTAT1        SAVE REGISTER                        32000002
         LA    TCBR,RSJFCB+88      REG. SAVE AREA                       32100002
         STM   BASER,WRKR5,0(TCBR) STORE REGISTERS                      32200002
         LA    WRKR2,RSDEB         DEB ADDRESS TO WRKR2                 32300018
         L     WRKR6,CVTPTR        GET CVT ADDRESS                      32400018
         L     WRKR6,CVTPRLTV-CVT(WRKR6) PICK UP CONVERT RTN ADDRESS    32500018
         LA    DCBR,RSIOBDAD       MBBCCHHR ADDRESS                     32600002
         BALR  WRKR5,WRKR6         GO TO CONVERT (MBBCCHHR TO TTR)      32700018
*                                                                       32800018
         LM    BASER,WRKR5,0(TCBR) RESTORE REGS.                        32900002
         L     TCBR,RSSTAT1        RESTORE TABLE POINTER                33000002
*                                                                       33100018
* PLACE VTOC TTR ADDRESS INTO UCB                                       33200018
*                                                                       33300018
         ST    WRKR1,RSJFCB+80     TTR IN REG. 0 ON RETURN              33400002
         MVC   UCBVTOC(3),RSJFCB+80 PLACE VTOC TTR IN UCB        YM7868 33500002
*                                                                       33600018
*********************************************************************** 33700018
*                                                                       33800018
* SWAP UCB'S I.E. THE POSITION OF VOL SER IN THE JFCB SHOULD            33900018
* CORRESPOND TO THE POSITION OF UCB (IN THE TIOT) ON WHICH THAT         34000018
* VOLUME IS MOUNTED.                                                    34100018
*                                                                       34200018
*********************************************************************** 34300018
*                                                                       34400018
         L     DCBR,0(TIOTR,WRKR5) UCB ON WHICH VOL IS MOUNTED   M2763  34600019
         L     WRKR2,0(TIOTR,TCBR) UCB IN 1ST AVAIL SLOT         M2763  34800019
         ST    WRKR2,0(TIOTR,WRKR5) SAVE UCB IN 1ST AVAIL SLOT   M2763  35000019
         ST    DCBR,0(TIOTR,TCBR)  MOUNTED UCB TO 1ST AVAIL SLOT M2763  35200019
*                                                                       35250020
         LA    WRKR2,0(TIOTR,TCBR) ADDR OF 1ST UCB ADDR POSITION A30003 35300020
         OI    0(WRKR2),DSONDEV    SET 'DATA SET IS ON DEVICE'   A30003 35350020
*                                                                YM7807 37200002
*****************************************************************YM7807 37300002
*                                                                YM7807 37400002
*        THE VOLUME SERIAL NUMBER IN EACH EXTENT (PLACED THERE   YM7807 37450002
*        BY IHJQCP32) WILL BE COMPARED WITH THE VOLUME SERIAL    YM7807 37500002
*        NUMBER IN THE UCB.  IF EQUAL, THE UCB ADDRESS WILL      YM7807 37550002
*        BE PLACED IN THE EXTENT.  THE EXTENT SECTION IN EACH    YM7807 37600002
*        DA DEB (EXCLUDING DUMMY, SUBSYSTEM, AND VSAM) HAS THE   YM7807 37650002
*        FOLLOWING FORMAT:                                       YM7807 37660002
*                                                                YM7807 37670002
*      0 +++++++++++                                             YM7807 37680002
*        + VOL SER +      VOL SER NO.= VOLUME SERIAL NUMBER      YM7807 37690002
*      4 +++++++++++                                             YM7807 37692002
*        + NO.+ CC +      CCHH = EXTENT INFORMATION IN DEB       YM7807 37694002
*      8 +++++++++++                                             YM7807 37696002
*        + *H + CC +      * = SAVE AREA FOR OVERLAYED FILE MASK  YM7807 37698002
*     12 +++++++++++                                             YM7807 37698402
*        + HH + TT +      TT = NUMBER OF TRACKS IN EXTENT        YM7807 37698802
*     16 +++++++++++                                             YM7807 37699202
*                                                                YM7807 37700002
*****************************************************************YM7807 37800002
*                                                                YM7807 37900002
MNTDA070 EQU   *                                                        38000018
         BAL   WRKR3,MNTDA110      SET UP TO SPIN THRU DEB              39600002
         LTR   WRKR6,WRKR6         ANY DEB EXTENTS               YM7550 39650002
         BZ    MNTDAZIP            IF NOT, SKIP DEB UPDATE       YM7550 39660002
*                                                                       39700018
         USING DEBDASD,DCBR        DEB EXTENT ADDRESSABILITY     YM7807 39750002
***************************************************************@Y30LSRA 39751003
*        FOR VIRTUAL DASD, SPACE MUST BE ACQUIRED ON A REAL    @Y30LSRA 39751203
*        PACK FOR STAGING THE VIRTUAL PACK.  THE QUEUE MGR     @Y30LSRA 39751403
*        WORK AREA IS USED FOR A PARM LIST TO PASS TO MSS.     @ZM30037 39751603
***************************************************************@Y30LSRA 39751803
         L     WRKR5,QMNPRMWA      GET JES Q-MGR WK AREA       @Y30LSRA 39751903
         LA    WRKR5,QMWRKOFT(,WRKR5) POINT TO ACTUAL WRK AREA @Y30LSRA 39752903
         SR    WRKR1,WRKR1         ASSUME ZERO ENTRYS          @Y30LSRA 39753103
         XC    D0(L100,WRKR5),D0(WRKR5) ZERO OUT SOME SPACE    @Y30LSRA 39753303
         TM    UCBTBYT2,VIRTDASD   IS UCB FOR VIRT DEVICE      @Y30LSRA 39753903
         BNO   MNTDA075            NO, EX - OR WAS WASTED      @Y30LSRA 39755003
         TM    TABDSORG,DA+PO+PS   NON VSAM OR NON ISAM        @Y30LSRA 39760003
         BZ    MNTDA075            NO, FORGET PARM LIST        @Y30LSRA 39765003
         MVI   D3(WRKR5),ACQPLN    MOVE HEADER LENGTH          @Y30LSRA 39770003
         MVC   D8(L6,WRKR5),UCBVOLI MOVE IN THE VOLID          @Y30LSRA 39771003
         LA    WRKR3,D28(,WRKR5)   SKIP NUM OF ENTRYS BYTE     @Y30LSRA 39785003
*                                                              @Y30LSRA 39790003
MNTDA075 EQU   *                                                 YM7807 39800002
*                                                                YM7807 39950002
         NI    TABFLG3,X'FE'       RESET VOLSER MISMATCH FLAG  @ZA31668 40000024
*                                                              @ZA31668 40009024
MNTDA076 EQU   *                                               @ZA31668 40018024
*                                                              @ZA31668 40027024
         TM    DEBENDHH,SWON       HAS EXTENT BEEN PROCESSED?    YM7807 40036024
         BO    MNTDA080            YES, CHECK NEXT EXTENT        YM7807 40045024
         CLC   DEBUCBAD(D6),UCBVOLI  ARE THE VOL SERS EQUAL?     YM7807 40054024
         BE    MNTDA077            YES, CONTINUE               @ZA31668 40063024
         OI    TABFLG3,X'01'       SET VOLSER MISMATCH FLAG    @ZA31668 40072024
         B     MNTDA080            CHECK NEXT EXTENT           @ZA31668 40081024
*                                                                YM7807 40090024
MNTDA077 EQU   *                                               @ZA31668 40099024
*                                                              @ZA31668 40108024
         ST    UCBR,DEBUCBAD       PUT UCB POINTER IN EXTENT     YM7807 40130024
         MVC   DEBDVMOD(D1),DEBSTRHH  RESTORE FILE MASK          YM7807 40200002
         XC    DEBBINUM(D2),DEBBINUM  ZERO OUT BIN NUMBER        YM7807 40250002
         MVI   DEBSTRHH,D0         ZERO OUT FILE MASK TEMP HOLD  YM7807 40300002
*                                  AREA.                         YM7807 40350002
         OI    DEBENDHH,SWON       TURN ON 'PROCESSED' SWITCH    YM7807 40400002
*                                                                YM7807 40410002
*****************************************************************YM7807 40412002
*                                                                YM7807 40420002
*        SINCE ALL VIO DATA SETS HAVE THE SAME VOLUME ID         YM7807 40450002
*        (BLANKS), ONLY ONE EXTENT (EXCLUDING USER LABELS),      YM7807 40500002
*        AND THE DEB EXTENTS ARE IN DD CARD SEQUENCE FOR PO      YM7807 40550002
*        CONCATENATION, UPDATE ONLY ONE DEB EXTENT PER VIO       YM7807 40600002
*        DD ENTRY.  NOTE - PO CONCATENATION IS THE ONLY MULTI-   YM7807 40650002
*        DD, PARALLEL MOUNT SITUATION THAT CAN EXIST FOR VIO.    YM7807 40700002
*        ISAM IS NOT AN ALLOWABLE ACCESS METHOD TYPE FOR VIO.    YM7807 40750002
*                                                                YM7807 40760002
*****************************************************************YM7807 40770002
*                                                                YM7807 40780002
         TM    UCBJBNR,UCBVRDEV    IS THIS A VIO UCB             YM7807 40790002
         BO    MNTDAZIP            IF YES, SKIP RECURSION        YM7807 40792002
         TM    D3(WRKR5),ACQPLN    WAS A HEADER BUILT          @Y30LSRA 40793003
         BZ    MNTDA080            NO, THEN NO VIRT VOL        @Y30LSRA 40794003
         CLC   D6(L4,DCBR),BUNCHFFS VALID EXTENT               @Y30LSRA 40795003
         BE    MNTDA080            NO, DONT ACQ THIS EXT       @Y30LSRA 40796003
         MVC   D0(L2,WRKR3),D6(DCBR) MOVE LO CC TO ENTRY       @Y30LSRA 40797003
         MVC   D2(L2,WRKR3),D10(DCBR) MOVE HI CC TO ENTRY      @Y30LSRA 40798003
         AH    WRKR1,ONEMOR        INCR NUM OF ENTRYS          @Y30LSRA 40799003
         LA    WRKR3,D4(,WRKR3)    POINT TO NEXT ENTRY         @Y30LSRA 40799203
*                                                                       40800018
MNTDA080 EQU   *                                                        40900018
         LA    DCBR,16(DCBR)       INCREMENT TO NEXT XTENT              41000018
         BCT   WRKR6,MNTDA076      PROCESS NEXT EXTENT IF ANY  @ZA31668 41010024
         DROP  DCBR                                              YM7807 41050024
*                                                                       41090024
************************************************************** @Y30LSRA 41201003
*        IF ANY EXTENTS WERE FOUND, GO GET SPACE FOR THEM.     @Y30LSRA 41202003
************************************************************** @Y30LSRA 41203003
         LTR   WRKR1,WRKR1         NO VIR DASD OR NO ENTRY     @Y30LSRA 41205003
         BZ    MNTDA08A            NONE, SO SKIP ACQUIRE       @Y30LSRA 41210003
         STC   WRKR1,D7(,WRKR5)    STORE NUM OF ENTRYS         @Y30LSRA 41215003
         MVI   4(WRKR5),X'02'      SET COMMAND CODE FOR MACRO  @ZA18267 41216037
         LR    WRKR3,WRKR2         SAVE CONTENTS OF REG 1      @Y30LSRA 41217003
         MVI   AROP(WRKR5),ACQ     ACQUIRE OPCODE              @ZM44640 41218024
         ICBACREL TYPE=ACQ,MF=(E,(14))                         @Y30LSRA 41220003
         LTR   WRKR6,WRKR6         ANY ERRORS                  @Y30LSRA 41225003
         BNZ   MNTDA02C            YES, GO ABEND THE JOB       @Y30LSRA 41230003
         LR    WRKR2,WRKR3         RESTORE REG 1               @Y30LSRA 41231003
         SR    WRKR1,WRKR1         ZERO OUT NUM OF EXTENTS     @Y30LSRA 41232003
MNTDA08A EQU   *                                               @Y30LSRA 41235003
*                                                              @Y30LSRA 41240003
*********************************************************************** 41300018
*                                                                       41400018
*        CHECK TO SEE IF THERE IS ANOTHER VOLUME SERIAL NUMBER          41500002
*        FOR THIS TABLE ENTRY.                                          41600002
*                                                                       41700018
*********************************************************************** 41800018
*                                                                       41900018
MNTDAZIP EQU   *                   ENTRY IF NO DEB EXTENTS       YM7550 41950002
         LR    WRKR5,TCBR          AVAILABLE UCB'S ADDRESS-4            42000002
         LA    TCBR,4(TCBR)        INCREMENT PTR TO 1ST AVAILABLE UCB   42100002
         LA    DSCNTR,6(DSCNTR)    INCREMENT VOL SER POINTER            42200018
         LA    WRKR6,MNTDA085      ESTABLISH BR ADDRESS          A30003 42210020
         TM    TABDSORG,PS         IS DATA SET P.S.                     42230018
         BCR   1,WRKR6             BR IF YES TO 'MNTDA085'       A30003 42260020
*                                                                       42300018
*   IF THE USER IS PROCESSSING ISAM OR BDAM DATA SETS            YM5512 42350002
*   USING EXCP, TREAT IT THE SAME AS A PS DATA SET               YM5512 42360002
         TM    TABDSORG,DA+IS      IS IT ISAM OR BDAM            YM5512 42370002
         BZ    MNTDA081            NO,CHECK FOR MORE VOLS        YM5512 42380002
         TM    DCBMACRF,EXCHPGM    IS THIS EXCP -IS OR DA        YM5512 42390002
         BCR   1,WRKR6             YES,TREAT AS PS FOR           YM5512 42392002
MNTDA081 EQU   *                   VOL MOUNTING PURPOSES         YM5512 42394002
         CLI   0(DSCNTR),EOVOLSER  IS THERE ANOTHER VOL SER IN TABLE    42400018
         BNE   MNTDA015            BRANCH TO GET NEXT UCB               42500018
         TM    TABFLG2,TABG5V      JFCB EXTENSION TO BE READ IN         42800002
         BCR   8,WRKR6             BR IF NO TO 'MNTDA085'        A30003 42900020
         OC    TABJFCB(3),TABJFCB  TEST IF JFCBX EXISTS                 42910000
         BCR   8,WRKR6             BR IF NO TO 'MNTDA085'               42920000
MNTDA083 EQU   *                                                 A33983 42950020
*                                                                       43000018
         BAL   DCBR,MNTDA130       READ IN JFCB EXTENTSION              43100002
*                                                                       43200018
         MVC   TABJFCB(3),RSJFCB1  TTR OF NEXT JFCB EXTENSION           43300018
         MVI   RSJFCB1+94,EOVOLSER FLAG END OF VOL SER LIST             43400018
*                                                                       43500018
         B     MNTDA015            GO TO MOUNT THIS VOL SER             43600018
*                                                                       43700018
MNTDA085 EQU   *                                                        43800018
*                                                                       43900018
         L     DCBR,RSJFCB+160     SET UP TO CHECK END OF DD ENTRY      44000002
*                                                                       44100018
*********************************************************************** 44200018
*                                                                     * 44300018
*        IF P. O. DATA SET IS CONCATENATED READ IN JFCB, IF NOT       * 44400018
*        GO TO NEXT TABLE ENTRY.                                      * 44500018
*                                                                     * 44600018
*********************************************************************** 44700018
*                                                                       44800018
* IS NEXT DD ENTRY BLANK                                                44900018
*                                                                       45000018
MNTDA090 EQU   *                                                        45100018
         LA    WRKR6,MNTDA095      ESTABLISH BR ADDRESS          A30003 45120020
         CLI   0(DCBR),ZERO        IS THIS END OF TIOT           A30003 45140020
         BCR   8,WRKR6             BR IF YES TO 'MNTDA095'       A30003 45160020
*                                                                       45180020
         CLI   4(DCBR),BLANK       IS DDNAME BLANK                      45200018
         BCR   7,WRKR6             BR IF NEXT ENTRY IS NOT       A30003 45260020
*                                  BLANK TO 'MNTDA095'                  45320020
*                                                                       45600018
*   IF THE USER IS PROCESSING AN ISAM DATA SET                   YM5512 45650002
*   USING EXCP, ONLY ONE VOLUME SHOULD BE MOUNTED                YM5512 45660002
         TM    TABDSORG,PO         IS THIS A PART D.S.           YM5512 45670002
         BO    MNTDA092            YES, GO ON                    YM5512 45680002
         TM    TABDSORG,IS         IS THIS AN ISAM D/S           YM5512 45690002
         BCR   8,WRKR6             BR IF NO TO MNTDA095          YM5512 45692002
         TM    DCBMACRF,EXCHPGM    IS THIS AN EXCP DCB           YM5512 45694002
         BCR   1,WRKR6             BR IF YES TO MNTDA095         YM5512 45696002
*********************************************************************** 45700018
*                                                                       45800018
*                RESET END OF DD ENTRY POINTER                          45900018
*                                                                       46000018
*********************************************************************** 46100018
*                                                                       46200018
MNTDA092 EQU   *                                                 YM5512 46250002
         SR    WRKR6,WRKR6         CLEAR REG                            46300002
         IC    WRKR6,0(DCBR)       LOAD LENGTH OF DD ENTRY              46400002
         AR    WRKR6,DCBR          TRUE CORE POSITION            M0187  46500021
         ST    WRKR6,RSJFCB+160    SAVE END OF DD ENTRY POINTER         46600002
*                                                                       46700018
* READ IN JFCB FOR THIS DD ENTRY                                        46800018
*                                                                       46900018
         LA    WRKR5,12(TCBR)      ADDR-4 OF 1ST UCB OF BLANK DDNAME    47000002
         MVC   TABJFCB(3),12(DCBR) TTR OF JFCB TO TABLE                 47100002
         LA    TCBR,4(WRKR5)       PNT TO BEGIN'G OF UCB'S TO BE CHECK  47200002
         BAL   DCBR,MNTDA130       READ IN JFCB                         47300002
*                                                                       47400018
         MVC   TABJFCB(3),RSJFCB1+JFCBEXAD-JFCBDSNM TTR OF XT TO TABLE  47500002
         MVC   RSJFCB1+4(30),RSJFCB1+JFCBVOLS-JFCBDSNM VOL SER NO       47600002
         MVI   RSJFCB1+34,EOVOLSER FLAG END OF VOL SER LIST             47700018
*                                                                       47800018
*   DETERMINE IF JFCB EXTENSION IS REQUIRED BEFORE               YM5513 47850002
*   ATTEMPTING TO READ IT                                        YM5513 47860002
         NI    TABFLG2,X'FF'-TABG5V TURN OFF JFCB EXT SW         YM7550 47870002
         CLI   RSJFCB1+JFCBNVOL-JFCBDSNM,FIVE                    YM5513 47880002
*                                  IS JFCBNVOL GR THAN 5         YM5513 47890002
         BNH   MNTDA093            NO,JFCB EXT NOT REQRD         YM5513 47892002
         OI    TABFLG2,TABG5V      YES, TURN ON JFCB EXT SW      YM7550 47894002
MNTDA093 EQU   *                                                 YM5513 47898002
         TM    TABDSORG,PO         P.O. CONCAT.                         47900018
         BZ    MNTDA015            BRANCH IF NO                         48000002
         OI    TABFLG2,TABPOCAT    SET P.O. CONCAT. SW                  48100002
         B     MNTDA015            BRANCH TO GET NEXT UCB               48200018
*                                                                       48210020
*********************************************************************** 48220020
*                                                                       48230020
* CLEAR UCB ADDRESS MODIFIED BIT FROM ALL EXTENTS IN DEB                48240020
*                                                                       48250020
*********************************************************************** 48260020
*                                                                       48270020
MNTDA095 EQU   *                                                        48300018
         TM    TABFLG3,X'01'   ANY VOLSER MISMATCHES ??        @ZA31668 48310024
         BZ    MNTDA097        NO, BRANCH                      @ZA31668 48320024
* ABEND JOB VOLSER NOT SAME AT RESTART AS WAS AT CHECKPOINT    @ZA31668 48330024
         MVI   RSRETCOD+1,ERR050   SET ERROR CODE 50           @ZA31668 48340024
         B     MNTDA027            GO TO XCTL                  @ZA31668 48350024
MNTDA097 EQU   *                                               @ZA31668 48360024
         BAL   WRKR3,MNTDA110      SET UP TO SPIN THRU DEB              48400002
         LTR   WRKR6,WRKR6         ANY DEB EXTENTS               YM7550 48450002
         BZ    MNTDA105            IF NOT, SKIP DEB UPDATE       YM7550 48460002
*                                                                       48500018
MNTDA100 EQU   *                                                        48600018
         USING DEBDASD,DCBR        DEB EXTENT ADDRESSABILITY     YM7807 48650002
         NI    DEBENDHH,SWOFF      TURN OFF 'PROCESSED' SWITCH   YM7807 48700002
         LA    DCBR,16(DCBR)       GO TO NEXT XTENT                     48800002
         BCT   WRKR6,MNTDA100      BRANCH IF NOT LAST XTENT             48900002
         DROP  DCBR                                              YM7807 48950002
*                                                                       49000018
MNTDA105 EQU   *                                                        49100018
*                                                                       49200018
         MVC   TABJFCB(3),RSJFCB+164 RESTORE JFCB TTR.                  49250002
MNTDA106 EQU   *                   INSTR MUST FOLLOW             Y02076 49260002
         TM    TABFLG1,TABLAST     HAS THE LAST ENTRY BEEN PROCESSED    49300002
         BO    MNTDA155            YES,BRANCH TO ENDMOD                 49400018
*                                                                       49500018
         LA    WRKR4,TABENT(WRKR4) INCREMENT TO NEXT ENTRY              49600018
         B     MNTDA005            BRANCH TO INITIALIZE PTRS            49700018
*                                                                     * 49800018
*********************************************************************** 49900018
*                                                                     * 50000018
*      SET UP REGISTERS NECESSARY TO SPIN THRU DEB                      50100018
*                                                                     * 50200018
*********************************************************************** 50300018
*                                                                     * 50400018
         USING DEBBASIC,DCBR       DEB                           YM7837 50500002
*                                                                       50600018
MNTDA110 EQU   *                                                        50700018
         SR    WRKR6,WRKR6         CLEAR REG.                           50800002
         LR    WRKR1,TABLR         SAVE REG                      Y02076 50850002
         L     DCBR,DCBDEBAD       PICK UP DEB ADDRESS           YM7837 50900002
         ICM   WRKR6,D1,DEBNMEXT   FETCH/TEST EXTENT COUNT       YM7550 51000002
         BZR   WRKR3               RETURN IF NO EXTENTS          YM7550 51010002
         LA    TABLR,DEBBASND      GET ADR-END BASIC SECT.       Y02076 51050002
         USING DEBDASD,TABLR                                     Y02076 51060002
         LA    DCBR,DEBDVMOD       LOAD ADDRESS OF 1ST XTENT            51100002
         DROP  DCBR,TABLR          DEB AND DEB EXTENT            YM7837 51150002
         LR    TABLR,WRKR1         RESTORE REG                   Y02076 51160002
         TM    TABDSORG,IS         ISAM DATA SET                        51200002
         BCR   8,WRKR3             BRANCH IF NO                         51300002
         LA    DCBR,16(DCBR)       ISAM DATA SET INCREMENT POINTER      51400018
         BCTR  WRKR6,0             ADJUST EXTENT COUNT BY -1     YM7550 51450002
         BR    WRKR3               RETURN                               51500002
*                                                                       51800018
*********************************************************************** 51900018
*                                                                       52000018
*    INCREMENT TO THE NEXT UCB ADDRESS IN THE NEW TIOT AND CHECK TO     52100018
*    SEE IF IT IS THE LAST UCB.                                         52200018
*                                                                       52300018
*********************************************************************** 52400018
*                                                                       52500018
MNTDA115 EQU   *                                                        52600018
         LA    WRKR5,4(WRKR5)      INCREMENT TO NEXT UCB                52700002
         LA    WRKR6,0(TIOTR,WRKR5) CURRENT UCB ADDRESS PLUS 4.         52800002
         L     DCBR,RSJFCB+160     LOAD 'END OF DD ENTRY' POINTER       52900002
         CR    DCBR,WRKR6          END OF DD ENTRY                      53000018
         BCR   13,WRKR2            BR IF YES (EQU OR LOW)        A33983 53100020
MNTDA116 EQU   *                                                        53200018
         L     UCBR,0(TIOTR,WRKR5) GET UCB ADDRESS               YM7359 53250002
         LA    UCBR,0(,UCBR)       CLEAR HI-BYTE                 YM7359 53300002
         XC    RSIOBDAD(8),RSIOBDAD CLEAR MBBCCHHR                      53400002
         ST    UCBR,RSDEBUCB       UNIT ADDRESS TO DEB                  54200018
         MVI   RSDEBBIN+1,ZERO     CLEAR BIN NUMBER FROM DEB IN WK AREA 54300018
         CR    DCBR,WRKR6          RESTORE CONDITION CODE        YM7331 54350002
         BR    WRKR2               RETURN                               55700018
*                                                                       55800018
*********************************************************************** 55900018
*                                                                       56000018
*  COMPLETE QMNGRIO PARM LIST THEN ISSUE QMNGRIO TO READ JFCB         * 56050002
*                                                                       56300018
*********************************************************************** 56400018
*                                                                       56500018
MNTDA130 EQU   *                                                        56600018
*                                                                       56700018
         LA    WRKR1,RSJFCB1       GET JFCB BUFFER ADDRESS       YM7868 56800002
         L     WRKR2,QMNPRMWA      GET ADR OF QMNGR P.L.         Y02076 56850002
         USING QMIOP,WRKR2         ADDRESS QMNGR PARAMETERS      Y02076 56852002
         ST    WRKR1,QMIRECAD      STORE JFCB READ IN ADR        YM7868 56860002
         L     WRKR1,TABNVOLS      LOAD TTR INTO REG. 0                 57600018
         SLL   WRKR1,8             LEFT JUSTIFY TTR                     57700018
         ST    WRKR1,QMIDSKAD      STORE TTR IN PARM LIST        Y02076 57750002
         DROP  WRKR2                                             Y02076 57800002
*                                                                       58500018
         LA    DSCNTR,RSJFCB1+4    SET VOL SER NO POINTER               58600018
         STM   WRKR4,WRKR5,RSERAS02 SAVE REG 13 & 14             YM7359 58650002
         LA    WRKR4,RSREGSAV      GET REG SAVEAREA ADDR         YM7359 58660002
*                                                                       58700018
*  READ IN JFCB                                                         58800018
*                                                                       58900018
         QMNGRIO                   READ IN JFCB                  Y02076 58950002
         LM    WRKR4,WRKR5,RSERAS02 RESTORE REG 13 & 14          YM7359 58960002
         LTR   WRKR6,WRKR6         TEST QMNGRIO RET. CODE        Y02076 59000002
         BNZ   MNTDA140            BR IF JFCB READ ERROR         Y02076 59050002
         BR    DCBR                RETURN IF NO ERROR            Y02076 59060002
*                                                                       59100018
*             EXCP ROUTINE                                            * 59150002
*                                                                     * 59160002
MNTDA135 EQU   *                                                        59200018
         EXCP  RSIOB               EXCP CHANNEL PROGRAM . CHANNEL       59300018
*                                                                       59400018
         WAIT  ,ECB=RSECBAD        WAIT                                 59500002
         TM    RSMWOFST,X'80'      MUST A DOM BE ISSUED             MCS 59510018
         BZ    TESTERR             BRANCH IF NO                     MCS 59520018
         LA    WRKR2,RSMWOFST      LOAD ADDR OF MSGID               MCS 59530018
         DOM   MSGLIST=(1)         ISSUE DOM                        MCS 59540018
         NI    RSMWOFST,X'7F'      TURN OFF DOM INDICATOR           MCS 59550018
TESTERR  EQU   *                                                    MCS 59560018
*                                                                       59600018
         TM    RSECBAD,PERMERR     I/O ERROR                            59700018
         BCR   NOMIX,DCBR          RETURN IF NO ERROR            A27515 59800019
*                                                                     * 60000018
*********************************************************************** 60100018
*                                                                     * 60200018
*                     ERROR RETURN CODES                              * 60300018
*                                                                     * 60400018
*********************************************************************** 60500018
*                                                                     * 60600018
MNTDA140 EQU   *                                                        60700018
         MVI   RSRETCOD+1,ERR048   UNRECOVERABLE I/O ERROR     @ZSUT222 60800024
*                                  RETURN CODE 48                       60900018
         B     MNTDA027            BR TO SET UP FOR XCTL         A30003 61400020
*                                                                       62000018
*********************************************************************** 62100018
*                                                                       62200018
*              TRANSFER TO NEXT MODULE                                  62300018
*                                                                       62400018
*********************************************************************** 62500018
*                                                                       62600018
MNTDA155 EQU   *                                                        62700018
*                                                                       62800018
         TM    RSDCBFLG,NONDAFLG   ANY TAPE DATA SETS                   63000018
         BO    MNTDA160            BRANCH IF YES                        63100002
*                                                                       63200018
         MVI   RSPPM+4,C'N'        XCTL TO IGC0N05B                 MCS 63300018
MNTDA160 EQU   *                                                        63350002
*                                                                YM7890 63450002
*        AT THIS POINT, WITH ALL MOUNT REQUESTS SATISFIED, THE   YM7890 63460002
*        MEMORY CAN AGAIN BE ENABLED FOR SWAP-OUT.               YM7890 63470002
*                                                                YM7890 63480002
         SYSEVENT OKSWAP           ENABLE SWAP-OUT               YM7890 63490002
*                                                                YM7890 63492002
         ICM   WRKR1,ADDRBYTS,QMNPRMLN LENGTH OF PRM LIST + WA   Y02076 63550002
         ICM   WRKR1,HIORDER,SP253 SUBPOOL 253                   Y02076 63560002
         L     WRKR2,QMNPRMWA      GET ADR OF PARM LIST          Y02076 63570002
         FREEMAIN  R,LV=(0),A=(1)  ISSUE FREEMAIN                Y02076 63580002
         LA    WRKR6,RSPPM+8                                        MCS 63600018
         XC    RSERAS00(D40),RSERAS00 CLEAR SCRATCH SPACE        Y02076 63650002
*******************   **************   ***********   *********   ****   63700018
         LR    WRKR2,BUFR          POINT REG. 1 TO THE RESTART W/A      63800002
         LR    CTABLR,TABLR        PASS TBL ADR TO NXT LOAD      Y02049 63810002
         LR    WRKR3,BUFR          POINT REG 12 TO RS W/A        Y02049 63850002
*******************   **************   ***********   *********   ****   63900018
*                                                                       64000018
         XCTL  EPLOC=RSPPM,SF=(E,(15))                              MCS 64100018
*                                                                       64200018
         EJECT                                                          64250002
*********************************************************************** 64300018
*                                                                       64400018
*     CONSTANTS USED IN REPI/O                                          64500018
*                                                                       64600018
*********************************************************************** 64700018
*                                                                       64800018
MOUNTMS  DC    X'00188000'         LENGTH OF MESSAGE                MCS 64900018
         DC    C'IEC403A M YYY,'   MOUNT MESSAGE                        65000018
RTDESC   DC    X'14004000'         ROUTE AND DESCRIPTOR CODES       MCS 65050018
CHAIN5   DC    X'40000005'         1ST CCW FLAG AND COUNT FIELDS M4597  65070019
QMNPRMLN DC    AL3(280)                 QMNGRIO PARM LST + WA    Y02076 65080002
SP253    DC    AL1(253)                 SUBPOOL 253              Y02076 65090002
F1       DC    F'1'                     FULLWORD CONSTANT OF 1   YM7868 65090402
         DS    0F                  FULL WORD ALIGNMENT         @Y30LSRA 65091003
SCRTCH   DC    CL6'SCRTCH'         SCRATCH PACK COMPARATOR     @Y30LSRA 65091403
KMNT     DC    CL11'  MOUNT '      MOUNT                       @Y30SLRS 65091503
KDMNT    DC    CL11' DEMOUNT '     DEMOUNT                     @Y30LSRA 65091603
KACQ     DC    CL11' ACQUIRE '          ACQUIRE                @Y30LSRA 65100703
ZEROS    DC    XL6'000000000000'   NOT MOUNTED COMPARATOR      @Y30LSRA 65110003
BLANKS   DC    XL6'404040404040'   NOT MOUNTED COMPARATOR      @Y30LSRA 65119003
BUNCHFFS DC    X'FFFFFFFF'         INVALID EXT COMPARATOR      @Y30LSRA 65121003
ONEMOR   DC    H'1'                ONE                         @Y30LSRA 65128003
SIXTEEN  DC    H'16'               MAX NUMB OF EXTENTS         @Y30LSRA 65137003
ABTABLE  EQU   *-240                    BEGIN TR TABLE         @Y30LSRA 65143703
         DC    C'0123456789ABCDEF'      TRANSLATE TABLE        @Y30LSRA 65145703
MSSMSG   WTO   'IEC466I JOBNAMED,VOLSER,DDD MSS FAILURE DURING RELINQUIX65145803
               SH CODE=NNN',DESC=4,ROUTCDE=(2,11),MF=L                  65165403
MSGLENTH EQU   *                                               @Y30LSRA 65174803
ADDRBYTS EQU   7                        GETMAIN/FREEMAIN PARMS   Y02076 65184203
HIORDER  EQU   8                        HIGH ORDER BYTE          Y02076 65193603
QMWRKOFT EQU   24                       WORK AREA OFFSET         Y02076 65203003
JFCBLNGH EQU   176                      JFCB LENGTH              Y02076 65212403
MODID    DC    CL8'IGC0M05B'            MODULE IDENT.          @ZSUT222 65216424
*                                                                       65221803
*                                                                     * 65231203
*        MAINTENANCE SPACE                                       Y01909 65240603
*                                                                     * 65250000
PATCH    DC    XL((*-IGC0M05B)/20)'00'   FIVE PERCENT SPACE      Y01909 65300000
*                                                                     * 65350000
         EJECT                                                          65360002
         IEFQMIOP                                                Y02076 65400002
         EJECT                                                          65410002
         IEFJESCT                                                Y02076 65450002
         EJECT                                                          65500018
MNTTIOT  DSECT                                                          65600018
         IEFTIOT1                                                       65700018
         EJECT                                                          65800018
         IEFUCBOB                                                       66000018
         EJECT                                                          66100018
         IHJDSTAB                                                Y02076 66150002
         EJECT                                                          70200018
RSDSECT  DSECT                                                          70300018
*                                                                       70400018
*    DATA EXTENT BLOCK                                                  70500018
*                                                                       70600018
RSDEB    DS    0CL48                                                    70700018
RSDEBTCB DC    X'00000000'              TCB ADDRESS                     70800018
RSDEBDEB DC    X'00000000'              DEB ADDRESS                     70900018
*                                                                       71000018
*    DATA CONTROL BLOCK                                                 71100018
*                                                                       71200018
RSDEBOFL DS    0CL1                                                     71300018
RSDEBIRB DC    X'00000000'              IRB ADDRESS                     71400018
RSDEBSYS DC    X'00000000'              1ST IOB ADDR IN SYS.PURGE CHAIN 71500018
RSDEBUSR DC    X'00000000'              1ST IOB ADDR IN USER PRGE CHAIN 71600018
RSDEBECB DC    X'00000000'              PARM.LIST ADDR TO PURGE ECB     71700018
RSDEBID  DS    0CL1                                                     71800018
RSDEBDCB DC    AL4(RSDCBREP)            DCB ADDR                        71900018
RSDEBAPP DS    CL4                      I/O APPENDAGE VECTOR TABLE      72000018
RSDEBMOD DS    0CL1                                                     72100018
RSDEBUCB DS    F                        UCB ADDRESS                     72200018
RSDEBBIN DS    H                        BIN NUMBER                      72300018
RSDEBSCC DS    H                        CYLINDER START ADDRESS          72400018
RSDEBSHH DS    H                        TRACK START ADDRESS             72500018
RSDEBECC DS    H                        CYLINDER END ADDRESS            72600018
RSDEBEHH DS    H                        TRACK END ADDRESS               72700018
RSDEBNTR DS    H                        NO. OF TRACKS IN THIS EXTENT    72800018
*                                                                       72900018
*    EVENT CONTROL BLOCK                                                73000018
*                                                                       73100018
RSECBAD  DS    CL4                      ECB ADDRESS                     73200018
RSDCBDEB DC    AL4(RSDEB)               DEB ADDRESS                     73300018
*                                                                       73400018
RSDCBREP EQU   RSDEB+8                  POINT TO RELATIVE BEGINNING DCB 73500018
*                                                                       73600018
*    INPUT OUTPUT BLOCK                                                 73700018
*                                                                       73800018
RSIOB    DS    0CL40                                                    73900018
RSIOBFG1 DC    X'00'                    I/O FLAGS BYTE 1                74000018
RSIOBFG2 DC    X'00'                    I/O FLAGS BYTE 2                74100018
RSIOBSN1 DS    CL1                      FIRST SENSE BYTE                74200018
RSIOBSN2 DS    CL1                      SECOND SENSE BYTE               74300018
RSIOBECB DC    AL4(RSECBAD)             ECB ADDRESS                     74400018
RSIOBCSW DS    D                        LAST CSW                        74500018
RSIOBCPA DS    AL4(RSCCW1)              CHANNEL PROGRAM ADDRESS         74600018
RSIOBDCB DS    AL4(RSDCBREP)            DCB ADDRESS                     74700018
RSIOBRCP DS    CL4                      RESTART ADDRESS FOR IOS         74800018
RSIOBINC DS    H                        INCREMENT BLOCK COUNT           74900018
RSIOBECT DS    H                        NO. OF ERROR ENTRIES            75000018
RSIOBDAD DS    D                        SEEK ADDRESS FOR DA             75100018
*                                                                       75200018
*    CHANNEL PROGRAM                                                    75300018
*                                                                       75400018
RSCCWLST DS    0CL24                                                    75500018
RSCCW1   DS    D                        CCW1                            75600018
RSCCW2   DS    D                        CCW2                            75700018
RSCCW3   DS    D                        CCW3                            75800018
*                                                                       75900018
*    BUFFER SEGMENT FOR EXTERNAL BLOCKS                                 76000018
*                                                                       76100018
RSBUFSEG DS    0CL176                                                   76200018
RSJFCB   EQU   RSBUFSEG                                                 76300018
*                                                                       76400018
*********************************************************************** 76430018
*                                                                       76460018
*                  JFCB                                                 76500018
*                                                                       76530018
*********************************************************************** 76560018
*                                                                       76600018
         IEFJFCBN                                                Y02076 76650002
         EJECT                                                          87300018
CVT      DSECT                                                          87400018
         CVT                                                            87500018
         EJECT                                                          87600018
*                                                                       87700018
*                                                                       87800018
*   TASK CONTROL BLOCK                                                  87900018
*                                                                       88000018
*                                                                       88100018
         CNOP  0,4                                                      88200018
MNTTCB   DSECT                                                          88300018
TCBRBP   DS    F                       POINTER TO EXECUTING RB          88400018
TCBPIE   DS    F                       POINTER TO PROG. INTERRUPT EL.   88500018
TCBDEB   DS    F                       POINTER TO DEB QUEUE             88600018
TCBTIO   DS    F                       POINTER TO TIOT                  88700018
TCBCMP   DS    F                       TASK COMPLETION CODE             88800018
TCBTRN   DS    F                       TESTRAN FIELD                    88900018
TCBMSS   DS    F                       DATA BLOCK QUEUE ELEMENT POINTER 89000018
TCBPRTK  DS    CL1                     PROTECTION TAG                   89100018
TCBFLGS  DS    FL5                     FLAG BYTES                       89200018
TCBLMP   DS    CL1                     LIMIT PRIORITY                   89300018
TCBDSP   DS    CL1                     DISPATCHING PRIORITY             89400018
TCBLLS   DS    F                       POINTER TO LOAD LIST             89500018
TCBJLB   DS    F                       POINTER TO JOBLIB DCB            89600018
TCBJSE   DS    F                       LIST OF INACTIVE PROGRAMS ADDR.  89700018
TCBGRS   DS    CL64                    GENERAL REGISTER SAVE AREA       89800018
TCBIDF   DS    CL1                     TCB IDENTIFIER FIELD             89900018
TCBFSA   DS    CL3                     POINTER TO 1ST PROB.PROG.SAVEAR  90000018
TCBTCB   DS    F                       NEXT TCB ON READY QUEUE POINTER  90100018
TCBTME   DS    F                       POINTER TO TIMER ELEMENT         90200018
         EJECT                                                          90300018
         DCBD  DSORG=PS                                                 90400018
         EJECT                                                          90500018
*                                                                       90600018
*                                                                       90700018
*   DATA EXTENT BLOCK                                                   90800002
*                                                                       90900018
         IEZDEB                                                  Y02076 90950002
*                                                                       91000018
         EJECT                                                          94500018
         IEEVRSWA   VER=3     AOS2 VERSION OF WA                        94600000
*                                                                       94700018
*    THE MESSAGE AREA USED TO WRITE-TO-OPERATOR IS IN THE WORKAREA      94800018
*    THE FOLLOWING EQUATES DEFINE THE MESSAGE AREA.                     94900018
*                                                                       95000018
*                   IGGXXXXX M YYY,XXXXXX                             * 95100018
*                                                                       95200018
MSGLN    EQU   RSJFCB+90      MESSAGE LENGTH                            95300018
MSGAREA  EQU   RSJFCB+94      MESSAGE NUMBER                            95400018
MSGUCB   EQU   RSJFCB+108     UNIT                                      95500018
MSGID    EQU   RSJFCB+112     VOLUME SERIAL                             95600018
*                                                                       95700018
RSJFCB1  EQU   RSJFCB+304                                               95800018
QMNPRMWA EQU   RSERAS00                 LOC FOR SAVE OF QMNG PL  Y02076 97550002
RSSTAT1  EQU   RSERAS01                 SAVE LOCATION            Y02076 97560002
*                                                                       97600018
*                                                                       97700018
*                                                                       97800018
         END                                                            97900018
