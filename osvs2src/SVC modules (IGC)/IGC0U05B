         TITLE 'IGC0U05B DATA SET PROCESSOR, DOS TAPE DATA SET POSITION*00110021
               ING   REPOSITION I/O  RESTART-SVC 52  OS/360'            00160021
IGC0U05B CSECT                                                          00210021
*                                                                       00260021
*     VS2 RELEASE 037 DELETIONS/CHANGES                                 00310037
* APAR OZ31494 HAS BEEN FLAGGED AS @ZSUT222                    @ZSUT222 00320037
*C173000-174200,183000,707000,709000,713000                    @ZSUT222 00326037
*A714200-714800,816500                                         @ZSUT222 00340037
*         RELEASE 23 DELETIONS/CHANGES                                  00360021
*         RELEASE 22 DELETIONS/CHANGES                                  00410021
*         RELEASE 21 NEW MODULE                                         00460021
*                                                                       00510021
*                                                                       00560021
* STATUS CHANGE LEVEL 000                                               00610021
*                                                                       00660021
*********************************************************************** 00710021
*                                                                       00760021
*                                                                       00810021
* FUNCTION - POSITIONS TAPES WHICH HAD BYPASS EMBEDDED DOS CHKPT RCDS   00860021
*    AND/OR BYPASS OPTIONAL LEADING TAPE MARK OPTION(S) SPECIFIED. TO   00910021
*    POSITION A TAPE WHICH MAY HAVE A LEADING TAPE MARK IT IS NECESSARY 00960021
*    TO ISSUE A READ AND TEST THE STATUS INFORMATION.  IF THE STATUS    01010021
*    INDICATES THAT A TAPE MARK WAS SENSED, THE LEADING TAPE MARK HAS   01060021
*    BEEN BYPASSED.  OTHERWISE THE TAPE MUST BE BACKSPACED ONE BLOCK    01110021
*    SUCH THAT CORRECT POSITIONING MAY BE PERFORMED.                    01160021
*                                                                       01210021
*    TO CORRECTLY POSITION A TAPE TO THE CORRECT RECORD WITHIN A DATA   01260021
*    SET CONTAINING EMBEDDED DOS CHKPT RCDS, IT IS NECESSARY TO READ    01310021
*    AND TEST EACH BLOCK FOR THE CHKPT HDR AND TRLR RCDS.  WHEN A CHKPT 01360021
*    HDR RCD IS ENCOUNTERED, TABFLG2 BIT 2 WILL BE SET AND THE BLOCK    01410021
*    COUNT FIELD (TABBLK2) WILL NOT BE INCREMENTED.  IT WILL THEN       01460021
*    CONTINUE READING AND NOT UPDATING TABBLK2 UNTIL THE CHKPT TRLR     01510021
*    RCD IS ENCOUNTERED, AT WHICH TIME TABFLG2 BIT 2 IS TURNED OFF TO   01560021
*    INDICATE EMBEDDED CHKPT RCDS ARE NOT BEING PASSED.  IF NEXT RCD    01610021
*    READ IS NOT A CHKPT HDR RCD, TABBLK2 WILL BE INCREMENTED TO IND.   01660021
*    THAT IT WAS A USER'S RCD AND WAS SPACED OVER.                      01710021
*                                                                       01760021
*    POSITIONING - A. POSITIONS TAPE TO CORRECT DATA SET USING FILE     01810021
*                     SEQUENCE NUMBER IN JFCB WHICH CAN BE OBTAINED     01860021
*                     FROM THE 48 BYTES TABLE ENTRY WHICH IS USED IN    01910021
*                     THE RESTART PORTION OF CHECKPOINT/RESTART.        01960021
*                                                                       02010021
*                  B. POSITIONS TAPE TO CORRECT RECORD WITHIN A DATA    02060021
*                     SET USING DCB POSITIONING INFORMATION             02110021
*                                                                       02160021
*********************************************************************** 02210021
*                                                                       02260021
* ENTRY POINTS -                                                        02310021
*                                                                       02360021
*         IGC0U05B FROM IGC0S05B                                        02410021
*                                                                       02460021
*********************************************************************** 02510021
*                                                                       02560021
* INPUT -                                                               02610021
*                                                                       02660021
*    REGISTER 8   BEGINNING OF DCB TABLE                                02710021
*    REGISTER 1   USER BUFFER AREA                                      02760021
*                                                                       02810021
*    ALL OPENED DCB(S) WITH THEIR ASSOCIATED CONTROL BLOCKS             02860021
*    THE 48 BYTE TABLE ENTRY (IES) THAT IS (ARE) USED IN RESTART        02910021
*    RESTART WORKAREA                                                   02960021
*                                                                       03010021
*********************************************************************** 03060021
*                                                                       03110021
* OUTPUT -                                                              03160021
*                                                                       03210021
*    REGISTER 8   BEGINNING OF DCB TABLE                                03260021
*    REGISTER 1   USERS BUFFER AREA                                     03310021
*    DOS TAPE POSITIONED AT CORRECT RECORD WITHIN DATA SET              03360021
*                                                                       03410021
*********************************************************************** 03460021
*                                                                       03510021
* EXTERNAL REFERENCES -                                                 03560021
*                                                                       03610021
*         USERS PROGRAM DCB                                             03660021
*                                                                       03710021
*********************************************************************** 03760021
*                                                                       03810021
* EXITS,NORMAL -                                                        03860021
*                                                                       03910021
*         FINAL EXIT IS MADE VIA XCTL TO THE NEXT MODULE OF REPI/O.     03960021
*         THIS MAY BE IGC0R05B OR IGC0T05B.                             04010021
*                                                                       04060021
*********************************************************************** 04110021
*                                                                       04160021
* EXITS,ERROR -                                                         04210021
*                                                                       04260021
*         ERROR EXITS ARE MADE VIA XCTL TO RESTART EXIT IGC0V05B        04310021
*         WITH RETURN CODES IN 'RSRETCOD' FIELD -                       04360021
*                                                                       04410021
*         65 - ERRORS IN TRYING TO POSITION TO CORRECT DAT SET          04460037
*                                                                       04510021
*         64 - ERRORS IN TRYING TO POSITION TO CORRECT RECORD           04560021
*              WITHIN THE DATA SET                                      04610021
*                                                                       04660021
*********************************************************************** 04710021
*                                                                       04760021
* TABLES/WORKAREAS - THE WORKAREA USED IS DESCRIBED BY THE DSECTS AT    04810021
*                    THE END OF THE LISTING.                            04860021
*                                                                       04910021
*    THE WORKAREAS AND TABLE ENTRIES HAVE BEEN COMPLETED IN             04960021
*    IGC0P05B AND IGC0S05B WITH THE EXCEPTION OF THE CHANNEL            05010021
*    PROGRAM REQUIRED TO BYPASS THE EMBEDDED CHKPT RCDS.  THE           05060021
*    FOURTH WORKAREA SEGMENT WILL BE USED AS BUFFER SEGMENTS.           05110021
*                                                                       05160021
*                                                                       05800021
*********************************************************************** 05900021
*                                                                     * 06000021
*    THE FOLLOWING IS A DESCRIPTION OF THE 48 BYTE TABLE ENTRY THAT   * 06100021
*    IS USED IN THE RESTART PORTION OF CHECKPOINT/RESTART.  EACH      * 06200021
*    ENTRY IN THE TABLE (ONE FOR EACH OPEN DATA SET AT CHECKPOINT)    * 06300021
*    IS 48 BYTES LONG.                                                * 06400021
*                                                                     * 06500021
*********************************************************************** 06600021
*                                                                       06700021
*        ------------------- 4 BYTES -----------------                  06800021
*                                                                       06900021
*      0 +++++++++++++++++++++++++++++++++++++++++++++                  07000021
*        +DATA SET  +           DCB                  +                  07100021
*        + ORGN.    +         ADDRESS                +                  07200021
*        +++++++++++++++++++++++++++++++++++++++++++++ 4                07300021
*        +FLAG BYTE +    WORKAREA SEGMENT            +                  07400021
*        + NO. 1    +         ADDRESS                +                  07500021
*      8 +++++++++++++++++++++++++++++++++++++++++++++                  07600021
*        +NUMBER    +         JFCB TTR               +                  07700021
*        + OF VOLS  +         ADDRESS                +                  07800021
*        +++++++++++++++++++++++++++++++++++++++++++++ 12               07900021
*                                                                       08000021
*     12 +++++++++++++++++++++++                                        08100021
*        +TAPE LABL + FILE SEQ +        DEVICE = TAPE                   08200021
*        +INFO BYTE + NUMBER   +                                        08300021
*        +++++++++++++++++++++++                                        08400021
*                                                                       08500021
*     12 +++++++++++++++++++++++                                        08600021
*        +    OLD   TIOT       +        DA AND UNIT RECORD              08700021
*        +      OFFSET         +                                        08800021
*        +++++++++++++++++++++++                                        08900021
*                                                                       09000021
*                              +++++++++++++++++++++++                  09100021
*                              +FLAG BYTE +FLAG BYTE +                  09200021
*                              +  NO. 2   +  NO. 3   +                  09300021
*     16 +++++++++++++++++++++++++++++++++++++++++++++                  09400021
*        +FLAG BYTE +FLAG BYTE +                     +                  09500021
*        + NO. 4    + NO. 5    +   VOLUME ID NO. 1   +                  09600021
*        +++++++++++++++++++++++                     + 20               09700021
*        +                                           +                  09800021
*        +                                           +                  09900021
*     24 +++++++++++++++++++++++++++++++++++++++++++++                  10000021
*        +                                           +                  10100021
*        +   VOLUME ID NO. 2                         +                  10200021
*        +                     +++++++++++++++++++++++ 28               10300021
*        +                     +                     +                  10400021
*        +                     +   VOLUME ID NO. 3   +                  10500021
*     32 +++++++++++++++++++++++                     +                  10600021
*        +                                           +                  10700021
*        +                                           +                  10800021
*        +++++++++++++++++++++++++++++++++++++++++++++ 36               10900021
*        +                                           +                  11000021
*        +   VOLUME ID NO. 4                         +                  11100021
*     40 +                     +++++++++++++++++++++++                  11200021
*        +                     +                     +                  11300021
*        +                     +                     +                  11400021
*        +++++++++++++++++++++++   VOLUME ID NO. 5   + 44               11500021
*        +                                           +                  11600021
*        +                                           +                  11700021
*        +++++++++++++++++++++++++++++++++++++++++++++ 48               11800021
*                                                                       11900021
*                                                                       12000021
*                                                                       12020021
*********************************************************************** 12040021
* ATTRIBUTES -                                                          12060021
*                                                                       12080021
*    REENTRANT                                                          12100021
*    REUSABLE                                                           12120021
*    ENABLED                                                            12140021
*    PRIVILEGED                                                         12160021
*                                                                       12180021
*********************************************************************** 12200021
*                                                                       12220021
* CHARACTER CODE DEPENDENCY -                                           12240021
*                                                                       12260021
*     OPERATION OF THIS MODULE IS NOT DEPENDENT UPON A PARTICULAR       12280021
*     INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER SET.            12300021
*                                                                       12320021
*********************************************************************** 12340021
*                                                                       12360021
* NOTES -                                                               12380021
*                                                                       12500021
*********************************************************************** 12600021
         EJECT ,                                                 A27694 12620021
*                                                                       12640021
*********************************************************************** 12660021
*                                                                       12700021
*    REGISTER CONVENTION TO BE USED THRU-OUT REPI/O PHASE               12800021
*                                                                       12900021
*********************************************************************** 13000021
*                                                                       13100021
WRKR1    EQU   0                        WORK/PARAMETER REGISTER         13200021
WRKR2    EQU   1                        WORK/PARAMETER REGISTER         13300021
DCBR     EQU   2                        CURRENT DCB REGISTER            13500021
BASER    EQU   3                        BASE RIGISTER                   13600021
DEBR     EQU   4                        CURRENT DEB REGISTER            13700021
UCBR     EQU   5                        CURRENT UCB REGISTER            13800021
TIOTR    EQU   6                        NEW TIOT RESISTER               13900021
TCBR     EQU   7                        TCB REGISTER                    14000021
TABLR    EQU   8                        BEGINNING TO DCB TABLE REGISTER 14100021
CTABLR   EQU   9                        CURRENT ENTRY IN DCB TABLE      14200021
BUFR     EQU   10                       USER BUFFER AREA                14300021
DSCNTR   EQU   11                       NUMBER OF DATA SETS             14400021
WRKR3    EQU   12                       WORK REGISTER                   14500021
WRKR4    EQU   13                       WORK REGISTER                   14600021
WRKR5    EQU   14                       WORK/PARAMETER REGISTER         14800021
WRKR6    EQU   15                       WORK/PARAMETER REGISTER         14900021
*                                                                       15000021
*********************************************************************** 15100021
*                                                                       15200021
*    OFFSETS TO BE USED IN REPI/O PHASE                                 15300021
*                                                                       15400021
*********************************************************************** 15500021
*                                                                       15600021
TPDEV    EQU   X'10'                    TAPE DEVICE                     15800021
LASTENT  EQU   X'08'                    LAST ENTRY                      15900021
TABENT   EQU   48                       TABLE ENTRY LENGTH              16400021
READ     EQU   X'02'                    READ FOR TAPE                   16500021
NOPOP    EQU   X'03'                    NOP                             16600021
REWIND   EQU   X'07'                    REWIND                          16700021
READBACK EQU   X'0C'                    READBACK                        16800021
BSFOP    EQU   X'2F'                    BACKWARD SPACE FILE             16900021
FSFOP    EQU   X'3F'                    FORWARD SPACE FILE              17000021
TIC      EQU   X'08'                    TIC                             17100021
PERMERR  EQU   X'7F'                    PERMANENT ERROR                 17200021
ERR065   EQU   65                       ERROR IN DATA SET      @ZSUT222 17300037
*                                       POSITIONING.           @ZSUT222 17340037
ERR064   EQU   64                       ERROR IN RECORD        @ZSUT222 17380037
*                                       POSITIONING.           @ZSUT222 17420037
FLAGS    EQU   X'30'                                                    17500021
DAFLAG   EQU   X'80'                    DA DATA SET FLAG                17560021
COUNT    EQU   X'14'                    CCW BYTE COUNT                  17620021
ONE      EQU   X'01'                    CONSTANT ONE                    17700021
DOSTAPE  EQU   X'11'                    DOS TAPE TABLE ENTRY            17730021
CKPTRCDS EQU   X'10'                    TEST FOR CHKPT RCDS IND.        17760021
CHKPT    EQU   X'02'                    PERFORM CHKPT RCD BYPASS        17790021
CHKOFF   EQU   X'FD'                    TURN OFF DOS CHKPT MASK         17820021
RCDPOS   EQU   X'18'                    TEST FOR RCD POSITIONING        17850021
TAPEMARK EQU   X'21'                    TEST FOR LEADING TM IND.        17880021
LTM      EQU   X'01'                    PERFORM BYPASS OF TM            17910021
SLI      EQU   X'20'                    SET SLI FLAG ON IN CCW          17940021
BYPASS   EQU   X'20'                    BYPASS CHKPT RCDS FLAG          17970021
READOP   EQU   X'F1'                    READ OR READ BACK CCW           18000021
DAMOD    EQU   X'D9'                    DA MODULE - IGC0R05B            18030021
AMMOD    EQU   X'E3'                    ACCESS METHOD - IGC0T05B        18060021
UE       EQU   X'01'                                                    18090021
RDBACK   EQU   X'03'                    READ BACKWARDS (DEBOPATB)       18200021
ERRORS   EQU   ERR065+ERR064            ERROR CODES            @ZSUT222 18300037
ERRCHKPT EQU   X'C0'                    PERMANENT ERROR AT CHECKPOINT   18400021
NOOPS    EQU   X'FF'                                                    18500021
RESET    EQU   X'FE'                    RESET SL FLAG            A32901 18550021
REW      EQU   X'80'                    REWIND MASK FOR TABOPS          18600021
FSF      EQU   X'40'                    FORWARD SPACE FILE MASK         18700021
BSF      EQU   X'20'                    BACK SPACE FILE MASK            18800021
RDOP     EQU   X'10'                    READ FORWARD MASK               18900021
RDBK     EQU   X'08'                    READ BACKWARD MASK              19000021
BUSY     EQU   X'80'                                                    19100021
NOTBUSY  EQU   X'00'                                                    19200021
BLANK    EQU   X'40'                                                    19300021
IBITS    EQU   X'0C'                    UNIQUE DEB INPUT BITS    A33655 19330021
EOFRST   EQU   X'DF'                    DEB EOF RESET MASK       A33655 19360021
BYPSSOFF EQU   X'7F'                    TURN OFF BYPASS FLAG            19370021
ZERO     EQU   0                                                        19400021
WAIT     EQU   7                                                        19500021
EQUAL    EQU   8                                                        19600021
NOTMIX   EQU   9                                                        19700021
ENDBUFF  EQU   19                       POINT TO END OF BUFFER          19750021
D0       EQU   0                                                        19800021
D1       EQU   1                                                        19900021
D3       EQU   3                                                        19950021
D4       EQU   4                                                        20000021
D7       EQU   7                                                        20100021
D8       EQU   8                                                        20200021
L1       EQU   1                                                        20300021
L4       EQU   4                                                        20400021
L8       EQU   8                                                        20500021
L18      EQU   18                                                       20600021
L23      EQU   23                                                       20700021
L24      EQU   24                                                       20800021
L26      EQU   26                                                       20830021
L384     EQU   384                                                      20860021
*                                                                       20900021
*********************************************************************** 21000021
*                                                                       21100021
         EJECT ,                                                 A27694 21150021
         BALR  BASER,ZERO               ESTABLISH ADDRESSABILITY        21450021
         USING *,BASER                  ESTABLISH BASE REG              21750021
         B     BEGIN               BRANCH AROUND EYE CATCHER     Y01909 21800000
         CNOP  0,8                 ALIGN TO A DBL WORD BOUNDARY  Y01909 21850000
         DC    CL8'IGC0U05B'       MODULE NAME                 @ZSUT222 21900037
         DC    CL8'&SYSDATE'       LAST DATE SHIPPED           @ZSUT222 21910037
         DC    CL8'@ZSUT222'       LAST CODE SHIPPED           @ZSUT222 21920037
BEGIN    EQU   *                                                 Y01909 21950000
*                                                                       22050021
         USING IHADCB,DCBR                                              22350021
         USING TABL,CTABLR                                              22650021
         USING RSTWA,BUFR                                               22950021
         USING RSDSECT,WRKR4                                            23250021
         USING DEBBASIC,DEBR                                            23300002
*                                                                       23550021
*                                                                       23850021
         LR    CTABLR,TABLR             INITIALIZE TABL POINTER         24150021
         LR    BUFR,WRKR2               SAVE POINTER TO RSWA            24450021
         L     WRKR4,TABSEGAD-D1        WORKAREA SEGMENT ADDRESS        24750021
         LA    WRKR5,D3                                                 25050021
         LA    WRKR3,L384(WRKR4)        POINT TO FOURTH                 25350021
*                                       WORKAREA SEGMENT                25650021
         SR    WRKR6,WRKR6              DOS TAPE COUNTER - NEED TO      25950021
*                                       BUILD ONLY THREE CCWS           26250021
REPDCB00 EQU   *                                                        26550021
*                                                                       26850021
         TM    TABFLG1,TABDOSTP         DOS TAPE ENTRY                  27150002
         BNO   REPDCB15                 BRANCH IF NO TO GET NEXT ENTRY  27450021
*                                                                       27750021
*   *** LOAD NECESSARY ADDRESSES ***                                    28050021
*                                                                       28350021
         L     WRKR4,TABSEGAD-D1        WORKAREA SEGMENT ADDRESS        28650021
         L     DCBR,TABDCBAD-D1         DCB ADDRESS FOR THIS ENTRY      28950021
*                                                                       29250021
*   *** DETERMINE WHICH BYPASS OPTION WAS SPECIFIED ***                 29550021
*                                                                       29850021
         TM    DCBMACRF,X'80'           IS THIS EXCP            SA64062 29900002
         BO    REPDCB05                 YES-BYPASS CHKPT TEST   SA64062 29950002
         TM    DCBOPTCD,CKPTRCDS        BYPASS EMBEDDED CHKPT RCDS      30150021
         BZ    REPDCB05                 BRANCH NO - BYPASS LEADING TM   30450021
*                                                                       30750021
         OI    TABOPS,CHKPT             SET CODE FOR BYPASS CHKPT RCDS  31050021
***                                                                     31100021
*        IF A CHECKPOINT WAS TAKEN WHILE THE ACCESS METHOD ROUTINES     31150021
*        WERE SKIPPING OVER AN EMBEDDED CHECKPOINT, THE DEB BYPASS      31200021
*        FLAG WILL STILL BE ON, CAUSING INCORRECT POSITIONING           31250021
***                                                                     31300021
         L     DEBR,DCBDEBAD            LOAD ADDRESS OF DEB             31310021
         LA    DEBR,DEBBASND            DEPEND SEC ADR           Y02076 31312002
         USING DEBDASD,DEBR                                      Y02076 31314002
         NI    DEBBYPAS,BYPSSOFF        TURN OFF BYPASS BIT             31320021
         L     DEBR,DCBDEBAD            LOAD ADR OF DEB          Y02076 31330002
         USING DEBBASIC,DEBR                                     Y02076 31340002
*                                                                       31350021
         TM    TABTPLBL,TAPEMARK        BYPASS LEADING TAPE MARK        31650021
         BNO   REPDCB10                 BRANCH ON NO                    31950021
*                                                                       32250021
REPDCB05 EQU   *                                                        32550021
*                                                                       32850021
         OI    TABOPS,LTM               SET CODE FOR BYPASS LEADING TM  33150021
*                                                                       33450021
REPDCB10 EQU   *                                                        33750021
*                                                                       34050021
         LA    WRKR6,D1(WRKR6)          INCR DOS TAPE ENTRY COUNTER     34350021
         CR    WRKR6,WRKR5              HAVE THREE CCWS BEEN BUILT      34650021
         BH    REPDCB15                 BRANCH YES                      34950021
*                                                                       35250021
*   *** INITIALIZE CHANNEL PROGRAM ***                                  35550021
*                                                                       35850021
         XC    RSCCW1(L26),RSCCW1       CLEAR CCW AND END OF            36150021
*                                       WORK SPACE                      36450021
*                                                                       36750021
         MVI   RSCCW1+D4,SLI            SET SLI BIT ON                  37050021
         MVI   RSCCW1+D7,COUNT          SET BYTE COUNT TO TWENTY        37350021
         ST    WRKR3,RSCCW1             SET DATA ADDRESS TO SEGMENT     37650021
*                                         OF FOURTH WORKAREA            37950021
         LA    WRKR3,COUNT(WRKR3)       INCREMENT BUFFER POINTER        38250021
*                                                                       38550021
REPDCB15 EQU   *                                                        38850021
*                                                                       39150021
         TM    TABFLG1,TABLAST          IS THIS THE LAST ENTRY          39450002
         BO    REPDCB20                 BRANCH YES TO INIT I/O          39750021
*                                                                       40050021
         LA    CTABLR,TABENT(CTABLR)    INCREMENT TABLE POINTER         40350021
         B     REPDCB00                 BRANCH TO TEST NEXT ENTRY       40650021
*                                                                       40950021
REPDCB20 EQU   *                                                        41250021
*                                                                       41550021
*********************************************************************** 41850021
*                                                                       42150021
*        THIS ROUTINE WILL PERFORM ALL THE NECESSARY I/O OPERATIONS     42450021
*        ACCORDING TO THE TABLE BUILT IN THE END OF EACH TABLE ELEMENT. 42750021
*                                                                       43050021
*********************************************************************** 43350021
*                                                                       43650021
         LR    CTABLR,TABLR             INITIALIZE TABL POINTER         48400021
         SR    WRKR3,WRKR3              TURN OFF SPIN SWITCH            48500021
         SR    WAIT,WAIT                TURN ON DO NOT WAIT SWITCH      48600021
*                                                                       48650021
REPDCB22 EQU   *                                                        48700021
*                                                                       48750021
         L     WRKR4,TABSEGAD-D1        WORK AREA SEGMENT ADDRESS       48800021
         TM    TABFLG1,TABDOSTP         IS IT DOS TAPE                  48900002
         BNO   REPDCB52                 BRANCH NO TO GET NEXT ELT       49000021
*                                                                       49100021
         TM    TABOPS,NOOPS             ANY I/O NEEDED FOR THIS ELT     49200021
         BZ    REPDCB52                 BRANCH NO TO GET NEXT ELT       49300021
         LA    WRKR3,ONE                TURN ON SPIN SWITCH             49400021
         TM    RSSTAT1,BUSY             IS WORK AREA BUSY               49500021
         BZ    REPDCB24                 BRANCH NO TO CONTINUE           49600021
         BAL   WRKR5,REPDCB56           GO TO WAIT ROUTINE              49700021
*                                                                       49709021
REPDCB24 EQU   *                                                        49718021
*                                                                       49727021
         TM    TABOPS,LTM               IS OPTIONAL TM INDICATED        49736021
         BZ    REPDCB32                 BRANCH NO TO CONTINUE           49745021
*                                                                       49754021
*        SET READ FORWARD TO TEST FOR TAPE MARK (UNIT EXCEPTION)        49763021
*                                                                       49772021
         MVI   RSCCW1,READ              SET OP CODE TO READ FWD         49781021
         B     REPDCB48                 GO TO EXCP                      49790021
*                                                                       49800021
REPDCB32 EQU   *                                                        49900021
*                                                                       50000021
         TM    TABOPS,REW               IS REWIND NECESSARY             50100021
         BZ    REPDCB34                 BRANCH NO REWIND                50200021
*                                                                       50300021
*        REWIND ROUTINE                                                 50400021
*                                                                       50500021
         XI    TABOPS,REW               PEEL OFF REWIND MASK            50600021
*                                                                       50700021
         MVI   RSCCW1,REWIND            SET CCW OP CODE TO REWIND       50800021
         B     REPDCB48                 GO TO EXCP                      50900021
*                                                                       51000021
REPDCB34 EQU   *                                                        51100021
*                                                                       51200021
*        FORWARD SPACE FILE ROUTINE                                     51300021
*                                                                       51400021
         TM    TABOPS,FSF               IS FSF NECESSARY                51500021
         BZ    REPDCB38                 BRANCH NO TO CHECK BSF          51600021
*                                                                       51700021
*        FSF                                                            51800021
*                                                                       51900021
         SR    WRKR6,WRKR6                                              52000021
         IC    WRKR6,TABFSFN2           GET NUMBER OF FSF ALREADY DONE  52100021
         LA    WRKR6,D1(WRKR6)          ADD ONE                         52200021
         STC   WRKR6,TABFSFN2           SAVE NUMBER OF FSF'S            52300021
         CLC   TABFSFN1(L1),TABFSFN2    WILL THIS BE ENOUGH             52400021
         BNE   REPDCB36                 BRANCH NO NOT ENOUGH            52500021
*                                                                       52600021
         XI    TABOPS,FSF               PEEL OFF FSF MASK               52700021
*                                                                       52710021
*        TURN OFF BYPASS DOS CHKPT RCD MASK IF NO RECORD                52720021
*        POSITIONING IS INDICATED                                       52730021
*                                                                       52740021
         TM    TABOPS,RCDPOS            RCD POSIT. INDICATED            52750021
         BNZ   REPDCB36                 BR IF YES                       52760021
*                                                                       52770021
         NI    TABOPS,CHKOFF            TURN OFF DOS CHKPT MASK         52780021
*                                                                       52790021
*                                                                       52800021
REPDCB36 EQU   *                                                        52900021
*                                                                       53000021
*                                                                       53100021
         MVI   RSCCW1,FSFOP             SET FSF OP CODE IN CCW          53200021
         B     REPDCB48                 GO TO EXCP                      53300021
*                                                                       53400021
*                                                                       53500021
*                                                                       53600021
REPDCB38 EQU   *                                                        53700021
*                                                                       53800021
*        BACK SPACE FILE ROUTINE                                        53900021
*                                                                       54000021
         TM    TABOPS,BSF               IS BACK SPACE FILE NECESSARY    54100021
         BZ    REPDCB40                 BRANCH NO TO CHECK READ FWD     54200021
*                                                                       54300021
*BSF                                                                    54400021
*                                                                       54500021
         XI    TABOPS,BSF               PEEL OFF BSF MASK               54600021
*                                                                       54700021
*                                                                       54800021
         MVI   RSCCW1,BSFOP             SET BSF OP CODE IN CCW          54900021
         B     REPDCB48                 GO TO EXCP                      55000021
*                                                                       55100021
*                                                                       55200021
*                                                                       55300021
REPDCB40 EQU   *                                                        55400021
*                                                                       55500021
*        READ FORWARD ROUTINE                                           55600021
*                                                                       55700021
         TM    TABOPS,RDOP              IS READ FWD NECESSARY           55800021
         BZ    REPDCB44                 BRANCH NO TO CHECK READ BACK    55900021
*                                                                       56000021
*        TEST FOR BYPASS FLAG ON - NO BLOCK COUNT INCR IF SET           56010021
*                                                                       56020021
         TM    TABFLG2,TABSW            BYPASSING CHKPT RCDS            56030002
         BO    REPDCB42                 BRANCH YES - SET OP CODE        56040021
*                                                                       56050021
*                                                                       56100021
         L     WRKR6,TABBLK2            GET BLK CT                      56200021
         LA    WRKR6,D1(WRKR6)          INCREMENT BY ONE                56300021
         ST    WRKR6,TABBLK2            SAVE BLK CT                     56400021
         CLC   TABBLK1(L4),TABBLK2      COMPARE BLOCK COUNTS            56500021
         BNL   REPDCB42                 BR NOT LOW TO CONTINUE          56560021
*                                                                       56620021
         NI    TABOPS,X'FF'-RDOP-CHKPT  PEEL OFF READ FWD AND    YM5600 56670002
*                                       DOS CHKPT MASKS                 56740021
         B     REPDCB52                 GET NEXT ELEMENT                56800021
*                                                                       56900021
REPDCB42 EQU   *                                                        57000021
*                                                                       57100021
         MVI   RSCCW1,READ              SET OP CODE TO READ FWD         57200021
         B     REPDCB48                 GO TO EXCP                      57300021
*                                                                       57400021
*                                                                       57500021
*                                                                       57600021
REPDCB44 EQU   *                                                        57700021
*                                                                       57800021
*        READ BACKWARD ROUTINE                                          57900021
*                                                                       58000021
         TM    TABOPS,RDBK              IS READ BACKWARD NECESSARY      58100021
         BZ    REPDCB52                 BRANCH NO MORE OPS FOR THIS ELT 58200021
*                                                                       58300021
*        TEST FOR BYPASS FLAG ON - NO BLOCK COUNT INCREMENT IF SET      58310021
*                                                                       58320021
         TM    TABFLG2,TABSW            BYPASS CHKPT RCDS IND.          58330002
         BO    REPDCB46                 BRANCH YES - SET OP CODE        58340021
*                                                                       58350021
*        RDBK                                                           58400021
*                                                                       58500021
         L     WRKR6,TABBLK2            GET BLOCK COUNT                 58600021
         LA    WRKR6,D1(WRKR6)          ADD ONE                         58700021
         ST    WRKR6,TABBLK2            SAVE NLOCK COUNT                58800021
         CLC   TABBLK1(L4),TABBLK2      COMPARE BLOCK COUNTS            58900021
         BNL   REPDCB46                 BR NOT LOW TO CONTINUE          58960021
*                                                                       59020021
         NI    TABOPS,X'FF'-RDBK-CHKPT  PEEL OFF READ BACKWRD    YM5600 59070002
*                                       AND DOS CHKPT RCD MASKS         59140021
         B     REPDCB52                 GET NEXT ELEMENT                59200021
*                                                                       59300021
REPDCB46 EQU   *                                                        59400021
*                                                                       59500021
         LA    WRKR6,ENDBUFF            ADD NINETEEN TO CCW DATA        59520021
         A     WRKR6,RSCCW1              ADDRESS TO POINT TO END        59540021
         ST    WRKR6,RSCCW1              OF BUFFER FOR READBACK         59560021
*                                                                       59580021
         MVI   RSCCW1,READBACK          SET OP CODE TO READ BACKWARD    59600021
*                                                                       59700021
*                                                                       59800021
REPDCB48 EQU   *                                                        59900021
*                                                                       60000021
         MVC   RSDEBUCB(L4),TABUCB      ADJUST UCB POINTER IN WORK AREA 60100021
REPDCB49 EQU   *                                                        60200021
         MVI   RSSTAT1,BUSY             TURN ON WORK AREA BUSY SWITCH   60300021
*                                                                       60400021
REPDCB50 EQU   *                                                        60500021
*                                                                       60600021
*        EXCP  ROUTINE                                                  60700021
*                                                                       60800021
*                                                                       60900021
*                                                                       61000021
         XC    RSECBAD(L4),RSECBAD      INITIALIZE ECB                  61100021
*                                                                       61200021
*                                                                       61300021
         EXCP  RSIOB                                                    61400021
*                                                                       61500021
*                                                                       61600021
         LTR   WAIT,WAIT                SHOULD WE WAIT                  61700021
         BNZ   REPDCB56                 BRANCH YES TO WAIT              61800021
*                                                                       62000021
REPDCB52 EQU   *                                                        62100021
*                                                                       62200021
         TM    TABFLG1,TABLAST          IS THIS THE LAST ENTRY          62300002
         BO    REPDCB54                 BRANCH YES TO CHECK IF DONE     62400021
         LA    CTABLR,TABENT(CTABLR)    INCREMENT TABL POINTER          62500021
         B     REPDCB22                 CONTINUE PROCESSING             62600021
*                                                                       62700021
REPDCB54 EQU   *                                                        62800021
*                                                                       62900021
*        LAST ENTRY HAS BEEN PROCESSED, ARE ALL ELTS COMPLETE           63000021
*                                                                       63100021
         LTR   WRKR3,WRKR3              TEST SPIN SWITCH                63200021
         BZ    REPDCB58                 SWITCH OFF - STOP SPINNING      63300021
         B     REPDCB20                 SPIN THRU TABLE ELEMENTS        63400021
*                                                                       63500021
*                                                                       63600021
*        WAIT ROUTINE                                                   63700021
*                                                                       63800021
REPDCB56 EQU   *                                                        63900021
*        WAIT FOR CE FOR CONTROL OPERATIONS, WAIT FOR CE AND DE FOR ALL 64000021
*        OTHERS,  NOP BRINGS IN CE AND DE SO CHECKING CAN BE DONE       64100021
*        FOR ERRORS BEFORE THE NEXT OPERATION IS STARTED.               64200021
*                                                                       64300021
*                                                                       64400021
         WAIT  ECB=RSECBAD                                              64500021
*                                                                       64600021
         MVI   RSSTAT1,NOTBUSY          TURN OFF WORK AREA              64609021
*                                       BUSY SWITCH                     64618021
*                                                                       64627021
         TM    TABOPS,LTM               LEADING TAPEMARK IND.           64636021
         BZ    REPDCB57                 BRANCH NO                       64645021
*                                                                       64654021
         TM    RSIOBCSW+4,UE            UNIT EXCEPTION INDICATED        64663021
         BO    REPDCB80                 BRANCH YES                      64672021
*                                                                       64681021
REPDCB57 EQU   *                                                        64690021
*                                                                       64700021
         TM    RSECBAD,PERMERR          CHECK FOR PERMANENT I/O ERRORS  64800021
         BM    REPDCB76                 BRANCH YES TO CHECK ERRORS      64900021
*                                                                       65000021
*                                                                       65200021
         CLI   RSCCW1,NOPOP             HAS NOP BEEN ISSUED             65300021
         BCR   EQUAL,WRKR5              BR YES TO CONTINUE PROCESSING   65400021
*                                                                       65500021
*        IF READ OR READ BACK GO TEST FOR CHKPT RCDS/LEADING TM         65600021
*                                                                       65700021
         TM    RSCCW1,READOP            OP CODE READ OR READBACK        65800021
         BZ    REPDCB80                 BRANCH YES TO TEST RCD          65900021
*                                                                       66100021
         MVI   RSCCW1,NOPOP             CHANGE OP CODE TO NOP           66200021
         B     REPDCB49                 GO TO EXCP                      66300021
*                                                                       66400021
*                                                                       66500021
*                                                                       66600021
*                                                                       66700021
REPDCB58 EQU   *                                                        66800021
*        WAIT ON ALL WORK AREAS TO BE SURE ALL HAVE BEEN CHECKED        66900021
*        FOR I/O ERRORS                                                 67000021
*                                                                       67100021
         LR    CTABLR,TABLR             INIT TABL POINTER               67200021
*                                                                       67300021
REPDCB60 EQU   *                                                        67400021
*                                                                       67500021
         TM    TABFLG1,TABDOSTP         IS IT DOS TAPE                  67600002
         BNO   REPDCB62                 BRANCH NO TO CONTINUE           67700021
*                                                                       67800021
         L     WRKR4,TABSEGAD-D1        WORK AREA SEGMENT ADDRESS       67900021
         TM    RSSTAT1,BUSY             IS WORK AREA BUSY               68000021
         BZ    REPDCB62                 BRANCH NO TO CONTINUE           68100021
*                                                                       68200021
         LA    WAIT,ONE                 TURN ON WAIT SWITCH             68300021
         BAL WRKR5,REPDCB56             GO TO WAIT ROUTINE              68400021
*                                                                       68500021
         MVI   TABVLID2,BLANK           RESTORE BLANKS                  68600021
         MVC   TABVLID2+D1(L23),TABVLID2     TO TABL AREA               68700021
*                                                                       68800021
REPDCB62 EQU   *                                                        68900021
*                                                                       69000021
         TM    TABFLG1,TABLAST          IS THIS THE LAST ENTRY          69100002
         BO    REPDCB68                 BRANCH YES TO EXIT              69200021
*                                                                       69300021
         LA    CTABLR,TABENT(CTABLR)    INCREMENT TABL POINTER          69400021
         B     REPDCB60                 CONTINUE WAIT PROCESSING        69500021
*                                                                       69600021
*    ****************************************************************** 69700021
*                                                                       69800021
REPDCB64 EQU   *                                                        69900021
*                                                                       70000021
*    ****************************************************************** 70100021
*                                                                       70200021
*    *** SET ERROR CODES ***                                            70300021
*                                                                       70400021
*    ****************************************************************** 70500021
*                                                                       70600021
         MVI   RSRETCOD+D1,ERR065       SET ERR CODE FOR D.S.  @ZSUT222 70700037
*                                            POSITIONING IN RSTWA       70800021
         B     REPDCBER                 BRANCH TO XCTL RESTART @ZSUT222 70900037
*                                                                       71000021
REPDCB66 EQU   *                                                        71100021
*                                                                       71200021
         MVI   RSRETCOD+D1,ERR064       SET ERR CODE FOR RECORD@ZSUT222 71300037
*                                            POSITIONING IN RSTWA       71400021
REPDCBER EQU   *                                               @ZSUT222 71420037
         MVC   RSREGSAV(8),MODID        SAVE NAME OF MODULE    @ZSUT222 71440037
*                                       DETECTING THE ERROR    @ZSUT222 71460037
         STM   0,15,RSREGSAV+8          SAVE CURRENT REGISTERS @ZSUT222 71480037
REPDCB68 EQU   *                                                        71500021
*                                                                       71600021
         L     UCBR,TABUCB              POINT TO UCB             A37817 71650021
         LR    CTABLR,TABLR             REINITIALIZE TABL POINTER       71700021
         L     WRKR4,TABSEGAD-D1        POINTER TO FIRST WORK AREA      71800021
*                                                                       71900021
         LA    WRKR3,RSCCW2             SET UP WORK AREA FOR XCTL       72000021
*                                                                       72100021
*                                                                       73600021
*    ****************************************************************** 73700021
*                                                                       73800021
*    *** DETERMINE WHICH EXIT MODULE TO TAKE ***                        73900021
*                                                                       74000021
*    ****************************************************************** 74100021
*                                                                       74200021
         MVC   D0(L8,WRKR3),RSTMODNM    NAME OF RESTART MODULE          74300021
*                                                                       74400021
         TM    RSRETCOD+D1,ERRORS       IS ERROR CODE SET               74500021
         BNE   REPDCB72                 BRANCH YES TO XCTL TO           74600021
*                                        IGC0V05B                       74700021
         TM    RSDCBFLG,DAFLAG          DA DEVICE INDICATED             74800021
         BNO   REPDCB70                 BRANCH NO                       74900021
*                                                                       75000021
         MVI   D4(WRKR3),DAMOD          SET MODULE NAME TO DA           75100021
         B     REPDCB72                  MODULE IGC0R05B - XCTL         75200021
*                                                                       75300021
REPDCB70 EQU   *                                                        75400021
*                                                                       75500021
         MVI   D4(WRKR3),AMMOD          SET NEW MODULE ID TO            75600021
*                                       ACCESS METHOD DISP.             75700021
REPDCB72 EQU   *                        MODULE IGC0T05B                 75800021
*                                                                       75900021
         LA    WRKR6,D8(WRKR3)          SET UP FOR XCTL                 76000021
         LR    WRKR2,BUFR               POINT REG 1 TO RESTART          76100021
*                                        WORK AREA                      76200021
         XCTL  EPLOC=(WRKR3),SF=(E,(15))                                76300021
*                                                                       77500021
REPDCB76 EQU   *                                                        77600021
*                                                                       77700021
*    ****************************************************************** 77800021
*                                                                       77900021
*    *** ERROR FOUND ***                                                78000021
*                                                                       78100021
*        THIS PORTION OF CODE MAY BE TAKEN OUT WHEN I/O SUPERVISOR HAS  78200021
*        PUT THE FIXES IN                                               78300021
*                                                                       78400021
*        THIS IS THE CURRENT THOUGHT PERSISTING TO THE HANDLING OF I/O  78500021
*        ERRORS                                                         78600021
*                                                                       78700021
*        ERRORS THAT HAVE OCCURRED AT CHECKPOINT TIME IS ACCEPTED       78800021
*                                                                       78900021
*    ****************************************************************** 79000021
*                                                                       79100021
         CLI   RSCCW1,READ              IS ERROR IN READ FORWARD        79200021
         BE    REPDCB78                 BRANCH YES                      79300021
*                                                                       79400021
         CLI   RSCCW1,READBACK          IS ERROR IN READ BACKWARD       79500021
         BNE   REPDCB64                 BR NO TO SET D.S. POSITIONING   79600021
*                                            ERROR CODE                 79700021
*                                                                       79800021
*                                                                       79900021
REPDCB78 EQU   *                                                        80000021
*                                                                       80100021
         CLC   TABBLK1(L4),TABBLK2      HAS POSITIONING BEEN COMPLETED  80200021
         BNE   REPDCB66                 BRANCH NO TO SET ERROR CODE     80300021
*                                                                       80400021
         TM    DCBIFLGS,ERRCHKPT        IS THERE PERMANENT ERR AT CHKPT 80500021
         BNO   REPDCB66                 BRANCH IF NOT TO SET ERROR CODE 80600021
*                                                                       80700021
         B     REPDCB52                 GO TO CONTINUE PROCESSING       80800021
*                                                                       80900021
REPDCB80 EQU   *                                                        80901021
*                                                                       80902021
*********************************************************************** 80903021
*                                                                       80904021
*    THIS SECTION OF CODE TESTS FOR THE LEADING TAPE MARK AND EMBEDDED  80905021
*    CHKPT RCDS.  FOR THE OPTIONAL LEADING TM IT SETS TABOPS FOR REWIND 80906021
*    IF THE TM IS NOT PRESENT AND PEELS THE TM TABOPS MASK OFF.  SETS   80907021
*    THE BYPASS FLAG WHEN ENCOUNTERING THE CHKPT HDR RCD - TURNS IT OFF 80908021
*    WHEN ENCOUNTERING THE CHKPT TRLR RCD.                              80909021
*                                                                       80910021
*********************************************************************** 80911021
*                                                                       80912021
         TM    TABOPS,LTM               LEADING TAPE MARK IND.          80913021
         BZ    REPDCB82                 BRANCH NO                       80914021
*                                                                       80915021
         XI    TABOPS,LTM               PEEL OFF LEADING TM MASK        80916021
*                                                                       80917021
         TM    RSIOBCSW+4,UE            UNIT EXCEPTION INDICATED        80918021
         BO    ZERO(WRKR5)              BRANCH YES TO CONTINUE          80919021
*                                                                       80920021
         OI    TABOPS,REW               SET CODE FOR REWIND             80921021
         BR    WRKR5                    CONTINUE PROCESSING             80922021
*                                                                       80923021
REPDCB82 EQU   *                                                        80924021
*                                                                       80925021
         TM    TABOPS,CHKPT             BYPASS CHKPT RCDS IND.          80926021
         BZ    ZERO(WRKR5)              BRANCH NO                       80927021
*                                                                       80928021
         CLI   RSCCW1,READBACK          IS OP CODE READBACK             80929021
         BNE   REPDCB84                 BRANCH NO                       80930021
*                                                                       80931021
         LA    WRKR6,ENDBUFF            NINETEEN                        80932021
         L     WRKR2,RSCCW1             CCW DATA ADDRESS LESS           80933021
         SR    WRKR2,WRKR6               NINETEEN TO POINT TO           80934021
         ST    WRKR2,RSCCW1              START OF 20 BYTE BUFFER        80935021
*                                                                       80936021
REPDCB84 EQU   *                                                        80937021
*                                                                       80938021
         L     WRKR6,RSCCW1             CCW DATA ADDRESS                80939021
*                                                                       80940021
         TM    TABFLG2,TABSW            BYPASS CHKPT RCD FLAG ON        80941002
         BO    REPDCB86                 BRANCH YES                      80942021
*                                                                       80943021
         CLC   CHKPTID,ZERO(WRKR6)      CHKPT HDR RCD                   80944021
         BNE   ZERO(WRKR5)              BRANCH NO TO CONTINUE           80945021
*                                                                       80946021
         OI    TABFLG2,TABSW            TURN ON BYPASS FLAG             80947002
*                                                                       80948021
         L     WRKR6,TABBLK2            GET BLOCK COUNT                 80949021
         BCTR  WRKR6,ZERO               SUBTRACT ONE                    80950021
         ST    WRKR6,TABBLK2            STORE UPDATED BLOCK CNT         80951021
         BR    WRKR5                    CONTINUE PROCESSING             80952021
*                                                                       80953021
REPDCB86 EQU   *                                                        80954021
*                                                                       80955021
         CLC   CHKPTID,ZERO(WRKR6)      CHKPT TRLR RCD                  80956021
         BNE   ZERO(WRKR5)              BRANCH NO                       80957021
*                                                                       80958021
         NI    TABFLG2,X'FF'-TABSW      TURN OFF BYPASS FLAG     Y02076 80958402
         BR    WRKR5                    CONTINUE PROCESSING             80960021
*********************************************************************** 81000021
*                                                                       81100021
*     CONSTANTS USED IN REPI/O                                          81200021
*                                                                       81300021
*********************************************************************** 81400021
*                                                                       81500021
RSTMODNM DC    CL8'IGC0V05B'            RESTART EXIT MOD                81600021
MODID    DC    CL8'IGC0U05B'            MODULE ID              @ZSUT222 81650037
CHKPTID  DC    CL12'/// CHKPT //'       CHKPT HDR/TRLR ID               81700021
*                                                                     * 81750000
*        MAINTENANCE SPACE                                       Y01909 81800000
*                                                                     * 81850000
PATCH    DC    XL((*-IGC0U05B)/20)'00'   FIVE PERCENT SPACE      Y01909 81860000
*                                                                     * 81870000
         EJECT                                                          81900021
         IEEVRSWA  VER=3                AOS2 VERSION OF WA              82000000
         EJECT                                                          82100021
RSDSECT  DSECT                                                          82200021
*                                                                       82300021
*    DATA EXTENT BLOCK                                                  82400021
*                                                                       82500021
RSDEB    DS    0CL48                                                    82600021
GETSAVE  EQU   RSDEB                                                    82700021
GOTLOC   EQU   GETSAVE+72                                               82800021
FREELIST EQU   GOTLOC+8                                                 82900021
         ORG   FREELIST                 ORG TO DEFINE FREEMAIN LIST     83000021
         FREEMAIN  V,A=GOTLOC,MF=L                                      83100021
         ORG   RSDEB                    RESET I.C.                      83200021
RSDEBTCB DC    X'00000000'              TCB ADDRESS                     83300021
RSDEBDEB DC    X'00000000'              DEB ADDRESS                     83400021
*                                                                       83500021
*    DATA CONTROL BLOCK                                                 83600021
*                                                                       83700021
RSDEBOFL DS    0CL1                                                     83800021
RSDEBIRB DC    X'00000000'              IRB ADDRESS                     83900021
RSDEBSYS DC    X'00000000'              1ST IOB ADDR IN SYS.PURGE CHAIN 84000021
RSDEBUSR DC    X'00000000'              1ST IOB ADDR IN USER PRGE CHAIN 84100021
RSDEBECB DC    X'00000000'              PARM.LIST ADDR TO PURGE ECB     84200021
RSDEBID  DS    0CL1                                                     84300021
RSDEBDCB DC    AL4(RSDCBREP)            DCB ADDR                        84400021
RSDEBAPP DS    CL4                      I/O APPENDAGE VECTOR TABLE      84500021
RSDEBMOD DS    0CL1                                                     84600021
RSDEBUCB DS    F                        UCB ADDRESS                     84700021
RSDEBBIN DS    H                        BIN NUMBER                      84800021
RSDEBSCC DS    H                        CYLINDER START ADDRESS          84900021
RSDEBSHH DS    H                        TRACK START ADDRESS             85000021
RSDEBECC DS    H                        CYLINDER END ADDRESS            85100021
RSDEBEHH DS    H                        TRACK END ADDRESS               85200021
RSDEBNTR DS    H                        NO. OF TRACKS IN THIS EXTENT    85300021
*                                                                       85400021
*    EVENT CONTROL BLOCK                                                85500021
*                                                                       85600021
RSECBAD  DS    CL4                      ECB ADDRESS                     85700021
RSDCBDEB DC    AL4(RSDEB)               DEB ADDRESS                     85800021
*                                                                       85900021
RSDCBREP EQU   RSDEB+8                  POINT TO RELATIVE BEGINNING DCB 86000021
*                                                                       86100021
*    INPUT OUTPUT BLOCK                                                 86200021
*                                                                       86300021
RSIOB    DS    0CL40                                                    86400021
RSIOBFG1 DC    X'00'                    I/O FLAGS BYTE 1                86500021
RSIOBFG2 DC    X'00'                    I/O FLAGS BYTE 2                86600021
RSIOBSN1 DS    CL1                      FIRST SENSE BYTE                86700021
RSIOBSN2 DS    CL1                      SECOND SENSE BYTE               86800021
RSIOBECB DC    AL4(RSECBAD)             ECB ADDRESS                     86900021
RSIOBCSW DS    D                        LAST CSW                        87000021
RSIOBCPA DS    AL4(RSCCW1)              CHANNEL PROGRAM ADDRESS         87100021
RSIOBDCB DS    AL4(RSDCBREP)            DCB ADDRESS                     87200021
RSIOBRCP DS    CL4                      RESTART ADDRESS FOR IOS         87300021
RSIOBINC DS    H                        INCREMENT BLOCK COUNT           87400021
RSIOBECT DS    H                        NO. OF ERROR ENTRIES            87500021
RSIOBDAD DS    D                        SEEK ADDRESS FOR DA             87600021
*                                                                       87700021
*    CHANNEL PROGRAM                                                    87800021
*                                                                       87900021
RSCCWLST DS    0CL24                                                    88000021
RSCCW1   DS    D                        CCW1                            88100021
RSCCW2   DS    D                        CCW2                            88200021
RSCCW3   DS    D                        CCW3                            88300021
*                                                                       88400021
*    BUFFER SEGMENT FOR EXTERNAL BLOCKS                                 88500021
*                                                                       88600021
RSSTATUS DS    0CL8                                                     88700021
RSSTAT1  DS    CL1                      STATUS BYTE 1                   88800021
RSSTAT2  DS    CL1                      STATUS BYTE 2                   88900021
RSSTAT3  DS    CL1                      STATUS BYTE 3                   89000021
RSSTAT4  DS    CL1                      STATUS BYTE 4                   89100021
         DS    F                        RESERVED FOR FUTURE USE         89200021
         EJECT                                                          89300021
         DCBD  DSORG=PS                                                 89400021
         EJECT                                                          89500021
         IEZDEB                                                  Y02076 89550002
DEBBYPAS EQU   DEBSTRHH                 EQUATE FOR BYPASS FLG           89600002
         EJECT                                                          93900021
         IHJDSTAB                                                Y02076 93950002
TABPOS   EQU   TABVLID2                                                 94000002
TABOPS   EQU   TABPOS                                                   94050002
TABFSFN1 EQU   TABPOS+1                                                 94100002
TABFSFN2 EQU   TABPOS+2                                                 94150002
TABBLK1  EQU   TABPOS+4                                                 94160002
TABBLK2  EQU   TABPOS+8                                                 94170002
TABUCB   EQU   TABPOS+12                                                94180002
         EJECT                                                          94200002
SRT      DSECT                                                          98900021
         IEFUCBOB                                                       99000021
         END                                                            99100021
