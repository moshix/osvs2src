         TITLE 'IGCD010D - DISPLAY SCAN/MAP/DISPATCH ROUTINE'           00200022
IGCD010D CSECT                                                          00400022
*A000000-999999                                                  S99240 00500022
*A325000,409000,443000,445000,537000,542300-543500,756100-757000 S22024 00600022
*A778200-779950,871500,872800-873900,906000-909000               S22024 00660022
*C018000,292000,338000-374000,386000-390000,394000,398000-400000,S22024 00720022
*C406000-408000,442000,444000,536000,702000,756000,768000-774000,S22024 00780022
*C778000                                                         S22024 00840022
*D476000-496000,512000-518000,758000                             S22024 00900022
*A854000                                                       @OY12425 00904000
*C506000,684000-694000,700000-820000,826000                    @OY12425 00908000
*D592000,871000,872800-873900,884000,912000,932000             @OY12425 00912000
*A378000,409500                                                @OY12649 00916000
*A014000,070000,854000,892000,933000                           @Y17XARX 00920000
*C018000,740000                                                @Y17XARX 00940000
*D014000,374000,409000                                         @Y17XARX 00960000
*A855200                                                       @PI06869 00980000
*A371000,408000                                                @G36XRRU 00990010
*C855500                                                       @OZ26490 00990182
*A826400,930000                                                @OY20827 00990282
*********************************************************************** 01000022
*                                                                     * 01200022
* MODULE NAME = IGCD010D (TCAM, OPERATOR CONTROL)              @Y17XARX 01230000
*                                                              @Y17XARX 01260000
* DESCRIPTIVE NAME = DISPLAY SCAN/MAP/DISPATCH ROUTINE         @Y17XARX 01290000
*                                                              @Y17XARX 01320000
* COPYRIGHT = NONE                                             @Y17XARX 01350000
*                                                                     * 01600022
* STATUS = VERSION 10.0                                        @Y17XARX 01800000
*                                                                     * 02000022
*                                                                     * 02200022
*FUNCTION--THIS MODULE GAINS CONTROL FROM IGC0110D WHEN THE COMMAND IS* 02400022
*   FOUND TO BE A 'DISPLAY'. THIS ROUTINE WILL PERFORM VALIDITY       * 02600022
*   CHECKING OF OPERANDS, MAP NEEDED INFORMATION USED BY THE DISPLAY  * 02800022
*   FUNCTIONAL ROUTINES INTO THE OPERATOR CONTROL ELEMENT (OPCE), AND * 03000022
*   TRANSFER CONTROL TO THE APPROPRIATE FUNCTIONAL ROUTINE VIA AN XCTL* 03200022
*                                                                     * 03400022
*   IF DURING ITS VALIDITY CHECKING IT FINDS THE COMMAND TO BE INVALID* 03600022
*   IT XCTLS TO THE ERROR WRITER ROUTINE IGC0310D TO WRITE OUT AN     * 03800022
*   ERROR MESSAGE.                                                    * 04000022
*                                                                     * 04200022
*   IT DETERMINES WHAT PARTICULAR DISPLAY COMMAND IS REQUESTED AND    * 04400022
*   BALRS TO SUBROUTINES IN IEDQCA TO DO THE ACTUAL VALIDITY CHECKING * 04600022
*   OF STATION NAMES, GROUPNAMES, RELATIVE LINE NUMBER, AND LINE      * 04800022
*   ADDRESS. IEDQCA WILL, BY ITS RETURN POINT, INDICATE WHETHER THE   * 05000022
*   REQUESTED VALIDITY CHECK WAS SUCCESSFUL OR NOT. IF UNSUCCESSFUL   * 05200022
*   AN XCTL TO IGC0310D WILL BE TAKEN TO HAVE AN APPROPRIATE ERROR    * 05400022
*   MESSAGE WRITTEN. IF SUCCESSFUL IGCD010D INSERTS INTO THE OPCE     * 05600022
*   INFORMATION THAT THE VARIOUS FUNCTIONAL ROUTINES WILL NEED TO     * 05800022
*   PROCESS THE COMMAND.                                              * 06000022
*                                                                     * 06200022
*   IT CAN INSERT INTO THE OPCE DEPENDING ON THE COMMAND THE TERMINAL * 06400022
*   NAME, TERMINAL ENTRY ADDRESS, GROUPNAME OF A LINE, A RELATIVE LINE* 06600022
*   NUMBER, A HARDWARE LINE ADDRESS, AS WELL AS SETTING BITS IN       * 06800022
*   OCSWITCH TO IDENTIFY THE COMMAND                                  * 07000022
*   D TP,ACT & D TP,INACT CAN ACCEPT ANY NAME OF A TTE AS      @Y17XARX 07020000
*   INPUT.   THEREFORE, A SUBROUTINE WAS ADDED (CKTTE) TO      @Y17XARX 07040000
*   DETERMINE IF THE NAME IN OPCDOUBL COULD BE MAPPED TO A     @Y17XARX 07060000
*   VALID TTE.  IF SO, THE TTE ADDR IS STORED IN OCELEM AND    @Y17XARX 07080000
*   OCLINK IS CLEAR AS AN INDICATOR.                           @Y17XARX 07100000
*                                                              @Y17XARX 07120000
*    D TP,PEND SUPPORT HAS BEEN ADDED TO DISPLAY HUNG SNA      @Y17XART 07123000
*    RESOURCES.  INPUT TO THIS COMMAND IS AN NCPNAME,          @Y17XART 07126000
*    SNA LINENAME, PUNAME,OR LUNAME.  CKTTE SUBROUTINE         @Y17XART 07129000
*    WILL BE USED TO VALIDITY CHECK THE INPUT.                 @Y17XART 07132000
*                                                              @Y17XART 07135000
*ENTRY POINTS--                                                       * 07400022
*   'IGCD010D TO SCAN,VALIDITY CHECK,MAP,AND DISPATCH.                * 07600022
*                                                                     * 07800022
*INPUT-- REGISTER 1- ADDRESS OF OPERATOR CONTROL AVT                  * 08000022
*   OPERATOR CONTROL RESIDENT WORKAREA - CONTAINS COMMAND TO VERIFY   * 08200022
*   STARTING WITH 'TP'                                                * 08400022
*                                                                     * 08600022
*OUTPUT-- REGISTER 1- ADDRESS OF OPERATOR CONTROL AVT                 * 08800022
*                                                                     * 09000022
*EXTERNAL REFERENCES--                                                * 09200022
*   IEDQCA'S SUBROUTINES                                              * 09400022
*        TRMOFLOC--VALIDITY CHECKS TERMINAL NAME PASSED TO IT. RETURNS* 09600022
*                  ADDRESS OF TERMINAL ENTRY IF VALID. IF NOT VALID   * 09800022
*                  RETURNS PLUS 4 PAST ADDRESS IN REGISTER 14.        * 10000022
*                                                                     * 10200022
*        DCBLOCAT--VALIDITY CHECKS HARDWARE LINE ADDRESSES,GROUPNAMES * 10400022
*                  RELATIVE LINE NUMBERS.ALSO INSURES LINE DCBS ARE   * 10600022
*                  OPEN,RLN IS NOT MORE THAN NUMBER OF EXTENTS,AND    * 10800022
*                  LINE WAS NOT OPENED DUMMY. FOR ANY OF THESE ERRORS * 11000022
*                  IT RETURNS TO ADDRESS PLUS 4 PAST ADDRESS IN       * 11200022
*                  REGISTER 14. IF VALID IT RETURNS ON R14            * 11400022
*                               REGISTER 0 - HAS UCB ADDRESS          * 11600022
*                               REGISTER 1 - HAS DCB ADDRESS          * 11800022
*                                                                     * 12000022
*EXITS,NORMAL--COMMAND IS SYNTAX CHECKED, AND OPERANDS ARE VERIFIED   * 12200022
*   AND CONTROL PASSES TO DISPLAY FUNCTIONAL ROUTINE VIA AN XCTL      * 12400022
*   THE OPERATOR CONTROL AVT ADDRESS IS PASSED IN REGISTER 1          * 12600022
*                                                                     * 12800022
*EXITS,ERROR--                                                        * 13000022
*   CONTROL PASSES TO THE ERROR WRITER IGC0310D TO WRITE OUT AN ERROR * 13200022
*   MESSAGE.                                                          * 13400022
*   ERROR MESSAGES ARE-                                               * 13600022
*   IED016I STATION NOT FOUND                                         * 13800022
*   IED017I LINE 'GRPNAME/RLN' NOT OPEN                               * 14000022
*   IED018I 'OPERATION' COMMAND INVALID                               * 14200022
*                                                                     * 14400022
*TABLES/WORK AREAS-- OPERATOR CONTROL AVT,TCAM AVT,OPCE,OPERATOR      * 14600022
*   CONTROL RESIDENT WORK AREA.                                       * 14800022
*                                                                     * 15000022
*ATTRIBUTES--SUPERVISOR MODE,DISABLED,TRANSIENT(TYPE 4),NON-REENTRANT * 15200022
*   SERIALLY REUSABLE,REFRESHABLE                                     * 15400022
*                                                                     * 15600022
*CHARACTER CODE DEPENDENCY                                            * 15800022
*        THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL        * 16000022
*        REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS        * 16200022
*        EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME.  THE CODING     * 16400022
*        HAS BEEN ARRANGED SO THAT REDEFINITION OF CHARACTER          * 16600022
*        CONSTANTS, BY REASSEMBLY WILL RESULT IN A CORRECT MODULE     * 16800022
*        FOR THE NEW DEFINITION.                                      * 17000022
*                                                                     * 17200022
*NOTES                                                                * 17400022
*        COMMUNICATIONS BETWEEN THE VARIOUS TRANSIENT MODULES IS      * 17600022
*        PRIMARILY THROUGH THE OPERATOR CONTROL AVT.                  * 17800022
*                                                                     * 18000022
*********************************************************************** 18200022
         EJECT                                                          18400022
*        REGISTER EQUATES                                               18600022
RZERO    EQU   0                   REGISTER 0 - BRANCH PARAMETER        18800022
REG1     EQU   1                   WORK REGISTER                        19000022
RPARM    EQU   1                   OPC AVT ADDRESS                      19200022
ROPCAVT  EQU   2                   POINTER TO OPC AVT                   19400022
ROPCE    EQU   3                   POINTER TO CURRENT OPCE              19600022
RAVT     EQU   4                   POINTER TO TCAM AVT                  19800022
RWORKA   EQU   5                   POINTER TO RESIDENT WORKAREA         20000022
RWORK6   EQU   6                   WORK REGISTER                        20200022
RTERM    EQU   6                   POINTER TO TERMINAL ENTRY            20400022
RWORK7   EQU   7                        WORK REG                 S22024 20600000
RTNT     EQU   7                   POINTER TO TERMNAME TABLE            20800022
RUCB     EQU   7                   POINTER TO UCB                       21000022
RWORK8   EQU   8                   WORK REGISTER                        21200022
RTABLE   EQU   9                   WORK REGISTER                        21400022
RWORK9   EQU   9                   WORK REGISTER                        21600022
RWORK10  EQU   10                  WORK REGISTER                        21800022
RWORK11  EQU   11                  WORK REGISTER                        22000022
RBASE    EQU   12                  BASE REGISTER                        22200022
RSAVE    EQU   13                  POINTER TO SAVEAREA                  22400022
RRETURN  EQU   14                  RETURN REGISTER                      22600022
RLINK    EQU   15                  BRANCHING REGISTER                   22800022
*                                                                       23000022
         SPACE 3                                                        23200022
         USING IEDQOPCD,ROPCAVT    OPC AVT ADDRESSABILITY               23400022
         USING IEDQOPCE,ROPCE      OPC ELEMENT ADDRESSABILITY           23600022
         USING IEDQAVTD,RAVT       AVT ADDRESSABILITY                   23800022
         BALR  RBASE,0             SET BASE REGISTER                    24000022
         USING *,RBASE             ADDRESSABILITY                       24200022
*                                       BASE REENTRANT OPERATOR CONTROL 24300022
IGCD010D IEDHJN SKIPID                                                  24800022
         LR    ROPCAVT,RPARM       SET BASE FOR OPC AVT                 25400022
         L     RAVT,OPCAVTPT       SET BASE FOR TCAM AVT                25600022
         L     RWORKA,OPCWORK      GET ADDRESS OF WORKAREA              25800022
         L     ROPCE,OPCCOPCE      GET ADDR OF CURRENT OPC ELEMENT      26000022
         LA    RSAVE,OPCSAVE            GET ADDR OF OPC SAVE AREA       26200022
         XC    OCSWITCH,OCSWITCH   CLEAR FOR POSSIBLE SETTING FOR RTNS  26400022
         MVI   OPCDOUBL,AVTEBLNK   MOVE A BLANK INTO 1ST BYTE           26600022
*                                  OF OPCDOUBL FOR MVC                  26800022
         MVC   OPCDOUBL+ONE(SEVEN),OPCDOUBL PROPAGATE BLANKS            27000022
         LH    RWORK7,TWO(RWORKA)   GET LENGHT OF DATA FIELD            27200022
         LA    RWORK7,DATAOFF(RWORKA,RWORK7) GET ADDR OF WHERE TO PUT   27400022
*                                  PUT BLANK                            27600022
         MVI   ZERO(RWORK7),AVTEBLNK  INSERT A BLANK AT END OF DATA     27800022
         LA    RWORK8,DATAOFF(RWORKA) BUMP ADDR TO START OF DATA FIELD  28000022
         CLC   ZERO(THREE,RWORK8),TP VALIDITY CHECK FOR 'TP'            28200022
         BNE   CMDINVAL            COMMAND NOT VALID                    28400022
         LA    RWORK8,THREE(RWORK8) BUMP PTR TO AFTER COMMA             28600022
         LA    RTABLE,TABLE        GET ADDR OF TABLE OF POSSIBLE CMNDS  28800022
         CLI   ZERO(RWORK8),AVTEBLNK IS THERE A BLANK AFTER'TP,'        29000022
         BE    CMDINVAL                 YES - COMMAND INVALID    S22024 29200022
         SR    REG1,REG1           CLEAR REGISTER 1                     29400022
         SR    RWORK10,RWORK10     CLEAR REGISTER 10                    29600022
         LR    RWORK11,RWORK8      SAVE PTR TO 1ST CHAR                 29800022
TABLOOP  IC    REG1,0(RTABLE)      GET 1 BYTE LENGTH OFF NAME INDICATOR 30000022
         LTR   REG1,REG1           END OF TABLE                         30200022
         BZ    CMDINVAL            YES, MATCH NOT FOUND                 30400022
         EX    REG1,COMP           NO- COMPARE TAB NAME AGAINST WORK    30600022
*                                  AREA NAME                            30800022
         LA    RTABLE,FOUR(REG1,RTABLE) BUMP TABLE TO NEXT ENTRY S22024 30900022
         LA    RWORK10,FOUR(RWORK10)    OFFSET IN BRANCHING TABLE TO    31200022
*                                       TAKE WHEN MATCH FOUND SO CAN    31400022
*                                       PROCESS REST OF OPERANDS        31600022
         BNE   TABLOOP             TABLE ENTRY DIDN'T MATCH WORKAREA    31800022
*                                  ENTRY                                32000022
         AR    RWORK8,REG1         BUMP PAST 1ST OPERAND                32200022
         LA    RWORK11,ONE(RWORK8) UP PAST DELIMITER                    32400022
         ST    RWORK11,OCELEM           POINTER TO ADDRESS              32500022
         SH    RTABLE,AVTHA2       BACK UP TO MODULE ID          S22024 32530022
         MVC   OPCLDNME+OFF03(AL2),0(RTABLE) SET MODULE ID XCTL  S22024 32560022
         LA    RWORK6,BRNCHTAB-FOUR     BRANCH TABLE BASE ADDR   S22024 32600022
         BC    15,0(RWORK10,RWORK6) BRANCH TO PROPER BRNCH PT           32800022
COMP     CLC   ONE(ZERO,RTABLE),ZERO(RWORK8) WORKAREA AND TABLE ENTRY   32900022
*                                       MATCH                           33000022
         EJECT                                                          33200022
TABLE    EQU   *                   TABLE OF POSSIBLE VALID DISPLAY      33400022
*                                  COMMANDS                             33600022
         DC    X'03',C'ACT,',C'D3' ACTIVE ENTRIES                S22024 33800022
         DC    X'04',C'LIST,',C'D7' AUTOPOLL                     S22024 34100022
         DC    X'04',C'ADDR,',C'D6' STATION RLN                  S22024 34400022
         DC    X'04',C'TERM,',C'D5' STATION STATUS               S22024 34700022
         DC    X'04',C'LINE,',C'D9' LINE STATUS                  S22024 35000022
         DC    X'05',C'INACT,',C'D3' INACTIVE ENTRIES            S22024 35300022
         DC    X'05',C'QUEUE,',C'D2' QUEUEING STATUS             S22024 35600022
         DC    X'06',C'OPTION,',C'D8' OPTION STATUS              S22024 35900022
         DC    X'07',C'PRITERM ',C'D1' PRIMARY TERMINAL          S22024 36200022
         DC    X'07',C'SECTERM ',C'D1' SECONDARY TERMINAL        S22024 36500022
         DC    X'05',C'INTER ',C'D4' INTERCEPTED STATIONS        S22024 36800022
         DC    X'06',C'STATUS,',C'DB' SWITCH STATUS              S22024 37100022
         DC    X'05',C'STORE,',C'DC' 3705 STORAGE              @G36XRRU 37150010
         DC    X'04',C'POLL,',C'M4'     POLL                   @OY12649 37600000
         DC    X'04',C'PEND,',C'DL' PENDING STATIONS           @YM07028 37700000
         DC    X'00'               END OF TABLE                         38200022
         EJECT                                                          38400022
BRNCHTAB B     INACTACT                 ACTIVE ENTRIES           S22024 38600022
         B     GRPADDR             AUTOPOLL                      S22024 39000022
         B     ADDRB               RELATIVE LINE NUMBER                 39200022
         B     ADDRB               STATION STATUS                S22024 39400022
         B     LINE                LINE AND ERROR STATUS                39600022
         B     GRPADDR             INACT COMMAND                 S22024 39800022
         B     ADDRB               QUEUEING STATUS               S22024 40000022
         B     OPTIONB             OPTION STATUS                        40200022
         B     PRISEC              PRIMARY TERMINAL                     40400022
         B     XCTLA               SECONDARY TERMINAL REQUEST    S22024 40600022
         B     XCTLA               INTERCEPTED STATIONS          S22024 40700022
         B     XCTLA               STATUS COMMAND                S22024 40800022
         B     XCTLA               STORAGE COMMAND             @G36XRRU 40850010
         B     ADDRB                    POLL COMMAND           @OY12649 40900000
         B     PEND                     PENDING STATIONS       @Y17XART 40950000
         EJECT                                                          41000022
PRISEC   EQU   *                   THIS COMMAND REQUESTS THE NAME OF    41200022
*                                  THE CURRENT PRIMARY OR SECONDARY     41400022
*                                  OPERATOR CONTROL TERMINAL            41600022
         OI    OCSWITCH,XEIGHTY         PRIMARY REQUEST                 41800022
         B     XCTLA               BRANCH TO XCTL                       42200022
         SPACE 3                                                        43600022
LINE     EQU   *                   THIS CMD REQUESTS DISPLAY OF THE     43800022
*                                  STATUS FIELD FOR SPECIFIED LINES     44000022
         CLC   ZERO(NINE,RWORK11),INACTVE IS THIS LINE INACTIVE  S22024 44200022
         BNE   GRPADDR             BRANCH ON NO                  S22024 44300022
         MVC   OPCLDNME+OFF03(AL2),INACTV SET MODULE ID          S22024 44400022
         B     XCTLA               TRANSFER CONTROL              S22024 44500022
         SPACE 3                                                        44800022
INACTACT EQU   *                   RWORK8 POINTS TO 1ST CHAR AFTER(,)   45000022
*                                       AFTER 'ACT'. XCTL TO IGCD310D   45200022
*                                  VALIDITY CHECK OPERANDS AFTER 'ACT,' 45400022
         OI    OCSWITCH,XEIGHTY         ACT COMMAND                     45600022
         B     GRPADDR             BRANCH TO GROUP NAME CHECK           46000022
         SPACE 3                                                        46200022
OPTIONB  EQU   *                   REQUESTS DISPLAY OF TERMINAL OPTION  46400022
*                                  FIELDS                               46600022
         LA    RWORK6,ZERO              BRANCHING INDEX                 47000022
         B     ADTERMQU            VALIDITY CHECK                       47200022
         SPACE 3                                                        49800022
ADDRB    EQU   *                   REQUESTS DISPLAY OF THE LINE ADDRESS 50000022
*                                  AND RLN FOR A SPECIFIED TERMINAL     50200022
         LA    RWORK6,FOUR         SETUP FOR PROPER BRANCH     @OY12425 50600000
         B     ADTERMQU            VALIDITY CHECK                       50800022
         SPACE 3                                                        52000022
PEND     EQU   *                        DISPLAY OF HUNG STAT   @Y17XART 52050000
         OI    OCSWITCH,XTWENTY         SET UNIQUE VALUE       @Y17XART 52100000
         B     GRPADDR                  PROCESS STATIONS NAME  @Y17XART 52150000
OPTIONME EQU   *                   ENTERED BY OPTION CMD 1ST CHECK      52200022
*                                  IF STATNAME IS VALID                 52400022
         CLI   ZERO(RWORK8),COMMA   COMMA PRESENT                       52600022
         BNE   CMDINVAL            YES ERROR                            52800022
         LA    RWORK10,NINE             PREPARE FOR COMPARE             53000022
         SR    RWORK10,RWORK9      NUM OF DIGITS IN CMD                 53200022
         BZ    CMDINVAL            COMMAND INVALID WRITE ERR MSG        53400022
         LA    RWORK6,FOURTEEN          SET UP TO BRANCH TO      S22024 53600022
*                                       OPTION COMMAND CODE      S22024 53700022
         B     TERMVALD            GO FIND TERMINAL ENTRY               53800022
         SPACE 5                                                        54000022
XCTLA    EQU   *                                                        54200022
         CLC   OPCLDNME+OFF03(AL2),LINEID  LINE COMMAND          S22024 54230022
         BNE   CLEARALL                 NO CLEAR AS USUAL        S22024 54260022
         MVI   FOUR(RWORKA),AVTEBLNK    INSERT A BLANK           S22024 54290022
         MVC   FIVE(WKSIZE,RWORKA),FOUR(RWORKA) PROPAGATE BLANKS S22024 54320022
CLEARALL EQU   *                                                 S22024 54350022
         MVI   FOURTY(RWORKA),AVTEBLNK  INSERT BLANK IN WORKAREA        54400022
         MVC   FOURTY1(WKSIZE,RWORKA),FOURTY(RWORKA) PROPAGATE BLANKS   54600022
         LA    RWORKA,WKSIZE-ONE(RWORKA) BUMP WORKAREA ADDR             54800022
         MVC   ONE(WKSIZE,RWORKA),ZERO(RWORKA) MOVE MORE BLANKS         55000022
         LR    RPARM,ROPCAVT       PUT ADDR OPC AVT IN REG 1            55200022
         XCTL  SF=(E,OPCXCTL)      CALL PROPER SVC LOAD MODULE          55400022
         EJECT                                                          55600022
ADTERMQU EQU   *                                                        55800022
         CLI   ZERO(RWORK11),AVTEBLNK A BLANK PRESENT                   56000022
         BE    CMDINVAL            YES COMMAND IS INVALID               56200022
         CLI   ZERO(RWORK11),COMMA  COMMA PRESENT                       56400022
         BE    CMDINVAL            YES THE CMD IS INVALID               56600022
OPT      LA    RWORK7,FOUND        SET BRANCHING REGISTER               56800022
OPFIELD  LA    RWORK9,TEN               SET COUNTER                     57000022
SCAN     LA    RWORK8,ONE(RWORK8)  BUMP TO NXT VALUE                    57200022
GROUP    BCT   RWORK9,COMPARE      HAVE WE EXCEEDED OUR LIMIT BRANCH NO 57400022
         B     CMDINVAL            SEND ERROR MESSAGE                   57600022
COMPARE  CLI   ZERO(RWORK8),AVTEBLNK   FOUND A BLANK                    57800022
         BE    0(RWORK6,RWORK7)      YES                                58000022
         CLI   ZERO(RWORK8),COMMA       FOUND A COMMA?                  58200022
         BE    0(RWORK6,RWORK7)         YES                             58400022
         B     SCAN                     NO- KEEP SEARCHING              58600022
FOUND    DS    0H                                                       58800022
         B     OPTIONME                 COMMAND IS FOR OPTION           59000022
         CLI   ZERO(RWORK8),AVTEBLNK  BLANK PRSENT                      59400022
         BNE   CMDINVAL            YES                                  59600022
         LA    RWORK10,NINE             PREPARE FOR COMPARE             59800022
         SR    RWORK10,RWORK9      NUM OF DIGITS IN CMD                 60000022
         BZ    CMDINVAL            INVALID OPERAND                      60200022
         LA    RWORK6,ZERO              SET BRANCHING REGISTER          60400022
TERMVALD BCTR  RWORK10,ZERO             DECREMENT FOR EXECUTE           60600022
         EX    RWORK10,MOVENAME    MOVE NAME INTO OPCDOUBL              60800022
GETTERM  L     RLINK,OPCTOFLK      GET TERM LOOKUP RTN                  61000022
         LA    RWORK9,BRANCHTA          ADDRESS OF BRANCHING TABLE      61200022
         BALR  RRETURN,RLINK       BRANCH TO IT                         61400022
         BC    15,0(RWORK6,RWORK9) TERMINAL NAME IS VALID               61600022
         B     TERMERR             COMMAND IS INVALID                   61800022
BRANCHTA EQU   *                                                        62000022
         MVC   OCBACKUP(OPCEIGHT),OPCDOUBL  SAVE TERMINAL NAME          62100022
         ST    REG1,OCELEM         SAVE TERM  ENTRY ADDRESS             62200022
         B     XCTLA                    XCTL TO PROCESSING RTN          62400022
         EJECT                                                          62600022
         LA    RWORK11,TWO(RWORK10,RWORK11) BUMP PTR PAST COMMA         62800022
*                                       AFTER TERM NAME                 63000022
         MVC   OCBACKUP(OPCEIGHT),OPCDOUBL SAVE TERMINAL NAME           63200022
         SR    RWORK6,RWORK6       CLEAR REGISTER FOR BRANCH DISP       63400022
         BAL   RWORK7,OPFIELD      BRANCH TO CHECK OPFIELD              63600022
FNDBLNK  EQU   *                                                        63800022
         CLI   ZERO(RWORK8),AVTEBLNK  BLANK PRESENT                     64000022
         BE    CMDINVAL                 YES, SO CMD IS INVAL FOR OPT    64200022
         LA    RWORK10,NINE             PREPARE FOR COMPARE             64400022
         SR    RWORK10,RWORK9      NUM OF DIGITS IN CMD                 64600022
         BNP   CMDINVAL            ERROR                                64800022
         MVI   OPCDOUBL,AVTEBLNK   MOVE A BLANK INTO 1ST BYTE           65000022
*                                  OF OPCDOUBL FOR MVC                  65200022
         MVC   OPCDOUBL+ONE(SEVEN),OPCDOUBL PROPAGATE BLANKS            65400022
         BCTR  RWORK10,ZERO             DECREMENT FOR EXECUTE           65600022
         EX    RWORK10,MOVENAME    MOVE NAME INTO OPCDOUBL              65800022
         ST    RPARM,OCELEM             SAVE TERM ENTRY ADDRESS         66000022
         ST    RWORK8,OCLINK            SAVE ADDROOF COMMA AFTER OPTNME 66400022
         B     XCTLA               BRANCH TO XCTL                       66800022
         SPACE 3                                                        67000022
GRPADDR  EQU   *                   CODE WHICK IS ENTERED IF COMMAND IS  67200022
*                                  ANY OF THE FOLLOWING:                67400022
*                                           ACT                         67600022
*                                           INACT                       67800022
*                                           LINE                        68000022
*                                           LIST                        68200022
*                                           PEND               @Y17XART 68300000
*                                  THIS SECTION OF CODE WILL   @OY12425 68400000
*                                  BRANCH TO OPCSCAN RTN IN QCA@OY12425 68600000
*                                  WHERE CMD WILL BE VALIDITY  @OY12425 68800000
*                                  CHECKED. DCBLOOKUP WILL THEN@OY12425 69000000
*                                  VERIFY NAME AND RETURN TO   @OY12425 69200000
*                                  D010D.                      @OY12425 69400000
         CLI   ZERO(RWORK11),AVTEBLNK  A BLANK PRESENT                  69600022
         BE    CMDINVAL            YES                                  69800022
         MVI   OCSCAN,OCADDR+OCDDNRLN  ITS AN ADDR OR DDN,RLN  @OY12425 70000000
         L     RLINK,OPCDCBLK                                  @OY12425 70200000
         BAL   RRETURN,FOUR(RLINK) BRANCH TO OPCSCAN RTN       @OY12425 72200000
         B     SET4ADDR            NAME WAS FOUND              @OY12425 74200000
         B     CKTTE2              MAYBE SNA NAME              @Y17XART 74800000
         B     CKTTE               CHECK SNA NAME              @Y17XART 75400000
         EJECT                                                          82200022
SET4ADDR EQU   *                                                        82400022
         CLC   OPCMODID,MODDL           EXIT TO DL             @YM07027 82460000
         BE    CMDINVAL                 GRP,RLN INVALID FOR DL @YM07027 82520000
         MVC   OCBACKUP(OPCEIGHT),OPCDOUBL  SAVE GRPNME        @OY12425 82600000
         CLI   ZERO(RWORK11),AVTEBLNK  FLD COMPLETELY SCANNED? @OY12425 82620000
         BNE   CMDINVAL            NO, ERROR                   @OY12425 82640000
         BCTR  RWORK11,ZERO        CHECK IF DELIMITER AFTER    @OY20827 82642082
*                                  RLN                         @OY20827 82644082
         CLI   ZERO(RWORK11),COMMA IS THERE A COMMA DELIMITER? @OY20827 82646082
         BE    CMDINVAL            YES, ERROR                  @OY20827 82648082
         CLI   ZERO(RWORK11),PARENR IS THERE A RIGHT PAREN?    @OY20827 82650082
         BE    CMDINVAL            YES, ERROR                  @OY20827 82652082
         CLI   ZERO(RWORK11),SLASH IS THERE A SLASH DELIMITER? @OY20827 82654082
         BE    CMDINVAL            YES, ERROR                  @OY20827 82656082
         LA    RWORK11,ONE(0,RWORK11) POINT BACK TO BLANK      @OY20827 82658082
         TM    OCSCAN,OCNOTUCB     DOES HI-ORDER BYTE          @OY12425 82660000
*                                  SPECIFY AN RLN?             @OY12425 82680000
         BZ    GOXCTL              NO, CONTINUE                @OY12425 82700000
         OI    OCSWITCH,XFOURTY    INDICATE NOT LINE @         @OY12425 82720000
GOXCTL   EQU   *                                               @YM07340 82740000
         ST    RZERO,OCLINK        SAVE UCB ADDR                        82800022
         ST    REG1,OCELEM         SAVE DCB ADDR                        83200022
         B     XCTLA               BRANCH TO XCTL                       83400022
         EJECT                                                          83600022
CMDINVAL EQU   *                   ENTERED BY VARIOUS SUBRTNS WHEN AN   83800022
*                                  A PART OF A CMD IS INVALID           84000022
         LA    RZERO,EIGHT10            MSG NO. 18                      84200022
MOVEID03 MVC   OPCLDNME+OFF03(AL2),ERRMSG MOVE IGC0310D ID              84400022
         B     XCTLA               BRANCH TO XCTL                       84600022
         SPACE 3                                                        84800022
TERMERR  EQU   *                   INVALID COMMAND                      85000022
         LA    RZERO,SIXTEEN            STATION FOUND                   85200022
         B     MOVEID03            CMD INVALID BRANCH TO ERROR WTR      85400022
NOTFOUND EQU   *                                               @OY12425 85410000
         LA    RZERO,SEVEN10       GET MSG # IN REGISTER       @OY12425 85450000
         B     MOVEID03            REG0 HAS PROPER ERROR MSG # @OY12425 85490000
*                                  INSERT ID OF IGC0310D       @OY12425 85522000
CKTTE    EQU   *                                               @Y17XARX 85526000
         CLC   OPCMODID,MODDL           IF XCTL TO DL          @Y17XART 85527000
         BE    OK                       THEN PROCESS           @Y17XART 85528000
         CLC   OPCMODID,MODD3           CHK XCTL NAME FOR 'D3' @Y17XARX 85530000
         BNE   CMDINVAL       EXIT BECAUSE PART OF CMD INVALID @Y17XARX 85534000
OK       EQU   *                                               @Y17XART 85536000
         L     RLINK,OPCTOFLK       ADDR TERM LOOKUP ROUTINE   @Y17XARX 85538000
         BALR  RRETURN,RLINK        BRANCH TO LOOKUP ROUTINE   @Y17XARX 85542000
         B     TTESETUP                 TERM NAME IS VALID     @Y17XARX 85546000
         LA    RPARM,ONE                SET RLN TO ONE         @YM07289 85546600
         L     RLINK,OPCDCBLK           DCB LOOKUP ADDRESS     @YM07289 85547200
         BALR  RRETURN,RLINK            LINK TO DDNAME LOOKUP  @YM07289 85547800
         B     CK3705                   VALID DDNAME, CHECK    @YM07289 85548400
*                                        FOR 3705 DCB          @YM07289 85549000
         B     TERMERR                  TERM NAME IS INVALID   @OZ26490 85550082
TTESETUP EQU   *                                               @Y17XARX 85554000
         ST    REG1,OCELEM         STORE ADDRESS OF VALID TTE  @Y17XARX 85558000
         SR    REG1,REG1                CLEAR REGISTER         @Y17XARX 85562000
         ST    REG1,OCLINK         INDICATOR TO NEXT MODULE,   @Y17XARX 85566000
*                                       OCELEM HAS THE ADDRESS.@Y17XARX 85570000
         NI    OCSWITCH,OCFOXES-XFOURTY  INDICATE INPUT TO     @PI06869 85574000
*                                       IGCD310D IS A TTE, NOT @PI06869 85578000
*                                       A GROUPNAME, RLN       @PI06869 85582000
         MVC   OCBACKUP(OPCEIGHT),OPCDOUBL SET TRM NAME IN OPCE@YM07289 85584000
         B     XCTLA                    NORMAL EXIT            @Y17XARX 85586000
CKTTE2   EQU   *                                               @Y17XART 85587000
         CLC   OPCMODID,MODDL           IF XCTL TO DL          @Y17XART 85588000
         BE    OK2                      THEN CHECK SNA NAME    @Y17XART 85589000
         CLC   OPCMODID,MODD3           IF XCTL TO D3          @Y17XART 85590000
         BNE   NOTFOUND                 NO, PROCESS AS OLD     @Y17XART 85591000
OK2      EQU   *                                                        85592000
         L     RLINK,OPCTOFLK           ADDR OF TERM LOOKUP    @Y17XART 85593000
         BALR  RRETURN,RLINK            BRNCH TO RTN           @Y17XART 85594000
         B     TTESETUP                 TERM NAME IS VALID     @Y17XART 85595000
         B     NOTFOUND                 PROCESS AS OLD         @Y17XART 85596000
CK3705   EQU   *                                                        85596600
         USING IHADCB,REG1              DCB ADDRESSABILITY     @YM07289 85597200
         TM    DCBDSRG2,DCBDSGTR        3705 DCB               @YM07289 85597800
         BNO   CMDINVAL                 NO,INVALID COMMAND     @YM07289 85598400
         B     SET4ADDR                 VALID FOR 3705         @YM07289 85599000
         EJECT                                                          85600022
*        EQUATES                                                        85800022
AL1      EQU   1                        OFFSET                          86000022
OFF03    EQU   3                   OFFSET 3                             86200022
OFF05    EQU   5                        OFFSET FOR ID                   86400022
OFF07    EQU   7                   OFFSET 7                             86600022
AL2      EQU   2                   LENGTH OF 2                          86800022
DATAOFF  EQU   8                        OFFSET OF DATA IN WORKAREA      87000022
TWO      EQU   2                        VALUE TWO                       87020022
FOUR     EQU   4                        VALUE FOUR                      87040022
FIVE     EQU   5                        VALUE FIVE                      87060022
SEVEN    EQU   7                        VALUE SEVEN                     87080022
NINE     EQU   9                        VALUE NINE                      87120022
TEN      EQU   10                       VALUE TEN                       87140022
FOURTEEN EQU   14                       CODE OFFSET              S22024 87150022
SIXTEEN  EQU   16                       VALUE SIXTEEN                   87160022
SEVEN10  EQU   17                       VALUE SEVEN10                   87180022
EIGHT10  EQU   18                       VALUE EIGHT10                   87200022
XFOURTY  EQU   X'40'                    HEX '40'                        87220022
XEIGHTY  EQU   X'80'                    HEX '80'                        87240022
XTWENTY  EQU   X'20'                    HEX '20'               @Y17XART 87250000
XFC      EQU   X'FC'                    HEX 'FC'                        87260022
*                                                                       87600022
*                                                                       87800022
*                                                                       88000022
MOVENAME MVC   OPCDOUBL(ZERO),ZERO(RWORK11) MOVE NAME TO OPCDOUBL       88200022
MOVERLN  PACK  OPCDOUBL,ONE(ZERO,RWORK11) PACK NUM IN A DOUBLE WRD      88400022
         SPACE 3                                                        88600022
*        CONSTANTS                                                      88800022
TP       DC    C'TP,'                   FIRST THREE CHAR IN CMD         89000022
ERRMSG   DC    C'03'               BUILD ICC0310D MODULE                89200022
MODD3    DC    C'D3'                    CHECK FOR MOD 'D3'     @Y17XARX 89800000
MODDL    DC    C'DL'                    MODULE IGCDL10D        @Y17XART 90100000
LINEID   DC    C'D9'                    DISPLAY LINE RTN ID             90400022
INACTV   DC    C'DD'               LINE INACTIVE IDENTIFIER      S22024 90600022
INACTVE  DC    C'INACTIVE '             INACTIVE                 S22024 90900022
FOURTY   EQU   40                       OFFWET FOR BLANK                91400022
FOURTY1  EQU   41                       OFFSET TO START PROPAGATING BLK 91600022
WKSIZE   EQU   250                      SIZE OF AREA TO BLANK OUT       91800022
*        EQUATES                                                        92000022
ZERO     EQU   0                        OFFSET                          92200022
ONE      EQU   1                        OFFSET                          92400022
THREE    EQU   3                        OFFSET                          92600022
OPCEIGHT EQU   8                   NUM OF CHAR TO MOVE                  92800022
COMMA    EQU   X'6B'               EBCDIC COMMA                         93000022
PARENR   EQU   C')'                                            @OY20827 93050082
SLASH    EQU   C'/'                                            @OY20827 93100082
COMMAL   DC    C',L '                   COMMA L AND BLANK               93300022
         DC    25X'FF'                  PATCH AREA             @Y17XARX 93350000
         EJECT                                                          93400022
*        MACROS                                                         93600022
         TOPCED                                                         93800022
         EJECT                                                          94000022
         TOPCAVTD                                                       94200022
         EJECT                                                          94400022
         TAVTD                                                          94600022
         EJECT                                                          94660000
         DCBD  DSORG=TX                                        @YM07289 94720000
         END                                                            94800022
