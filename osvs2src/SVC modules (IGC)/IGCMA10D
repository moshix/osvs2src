         TITLE 'IGCMA10D - MODIFY FUNCTION SCAN/MAP/DISPATCHER II'      00200022
IGCMA10D CSECT                                                          00400022
         SPACE 3                                                        00420010
* CHANGE ACTIVITY AS FOLLOWS                                            00440010
******************** MICROFICHE FLAGS *********************** SUPT CODE 00460010
*000000-999999                                                 @Y16X5R0 00465010
*A499000                                                         S05331 00470010
* A250000,656000,657200                                         SA69086 00480010
*A000000-999999                                                  S99240 00500022
*A174000                                                       @OY12425 00500210
*C596000,626000,680000-698000,806000,814000                    @OY12425 00500410
*D706000-746000,750000,752000                                  @OY12425 00500610
*D476000,320000,5860000                                        @Y17XART 00501010
*C008200,012400,512800                                         @Y17XART 00502010
*A046000,148000,856000                                         @Y17XART 00515010
*A386000                                                       @OS77841 00525010
         SPACE 3                                                        00550010
*********************************************************************** 00600022
*                                                                     * 00800022
*  MODULE NAME = IGCMA10D (TCAM,OP CTL)                        @Y17XART 00810010
*                                                                     * 00840010
*  DESCRIPTIVE NAME = MODIFY FUNCTION SCAN/MAP/DISPATCHER II          * 00860010
*                                                                     * 00880010
*  COPYRIGHT = 'NONE'                                                 * 00900010
*                                                                     * 00920010
*                                                                     * 01000022
* STATUS -                                                            * 01200022
*    CHANGE LEVEL 10                                           @Y17XART 01250010
*                                                                     * 01600022
* FUNCTION--THIS MODULE RECEIVES CONTROL FROM IGCM010D TO COMPLETE    * 01800022
*   SCAN/MAP/DISPATCH FUNCTION STARTED BY IGCM010D. THIS ROUTINE MAPS * 02000022
*   NEEDED INFORMATION USED BY THE MODIFY FUNCTIONAL ROUTINES INTO THE* 02200022
*   OPERATOR CONTROL ELEMENT (OPCE), AND TRANSFERS CONTROL TO THE     * 02400022
*   APPROPRIATE FUNCTIONAL ROUTINE VIA AN XCTL.                       * 02600022
*                                                                     * 02800022
*   IF DURING VALIDITY CHECKING THE COMMAND IS FOUND TO BE INVALID,   * 03000022
*   XCTL TO IGC0310D,THE ERROR WRITER ROUTINE, IS MADE TO INDICATE AN * 03200022
*   ERROR.                                                            * 03400022
*                                                                     * 03600022
*   SUBROUTINES IN IEDQCA ARE USED TO VALIDITY CHECK STATION NAMES,   * 03800022
*   GROUPNAMES,RELATIVE LINE NUMBERS,AND LINE ADDRESSES               * 04000022
*                                                                     * 04200022
* ENTRY POINTS -                                                      * 04400022
*         IGCMA10D IS THE ONLY ENTRY POINT FOR THIS MODULE            * 04600022
*    PURPOSE - SEE FUNCTION                                    @Y17XART 04660010
*    LINKAGE - XCTL SF=(E,OPCXCTL)                             @Y17XART 04720010
*                                                                     * 04800022
* INPUT - REG 1 CONTAINES A POINTER TO THE OPERATOR CONTROL AVT.      * 05000022
*                                                                     * 05200022
* OUTPUT - PASSES OP CTL AVT ADDRESS IN REG 1.                        * 05400022
*                                                                     * 05600022
* EXTERNAL REFERENCES --                                              * 05800022
*         SVC 7(XCTL)                                                 * 06000022
*   IEDQCA'S SUBROUTINES                                              * 06200022
*        TRMOFLOC--VALIDITY CHECKS TERMINAL NAME PASSED TO IT. RETURNS* 06400022
*                  ADDRESS OF TERMINAL ENTRY IF VALID. IF NOT VALID   * 06600022
*                  RETURNS PLUS 4 OF RETURN ADDRESS IN REGISTER 14.   * 06800022
*                                                                     * 07000022
*        DCBLOCAT--VALIDITY CHECKS HARDWARE LINE ADDRESSES, GROUPNAMES* 07200022
*                  AND RELATIVE LINE NUMBERS. ALSO INSURES LINE DCBS  * 07400022
*                  ARE OPEN, RLN IS NOT MORE THAN NUMBER OF EXTENTS,  * 07600022
*                  AND LINE WAS NOT OPENED DUMMY. FOR ANY OF THESE    * 07800022
*                  ERRORS RETURNS PLUS 4 OF RETURN ADDRESS IN R14.    * 08000022
*                             GOOD RETURN- R0= UCB ADDRESS            * 08200022
*                                          R1= DCB ADDRESS            * 08400022
*                                                                     * 08600022
*EXITS,NORMAL--EXITS VIA XCTL TO MODIFY FUNCTIONAL ROUTINES.          * 08800022
*              IGCM410D - MODIFY INTERVAL FUNCTIONAL ROUTINE          * 09000022
*              IGCM510D - MODIFY INTENSE FUNCTIONAL ROUTINE           * 09200022
*              IGCM710D - MODIFY OPERATOR FUNCTIONAL ROUTINE          * 09400022
*              IGCM810D - MODIFY OPTION FUNCTIONAL ROUTINE            * 09600022
*              IGCM910D - MODIFY DEBUG FUNCTIONAL ROUTINE             * 09800022
*                                                                     * 10000022
*EXITS,ERROR -- THE ERROR MESSAGE NUMBER IS PLACED IN REGISTER 0,     * 10200022
*   THE OP CTL AVT ADDRESS IN REG 1 AND XCTL IS TO THE OP CTL ERROR   * 10400022
*   MESSAGE MODULE (IGC0310D).                                        * 10600022
*              IED016I STATION XXXXXXXX NOT FOUND                     * 10800022
*                   IED017I LINE XXXXXXXX  NOT OPEN                   * 11000022
*                   IED018I XXXXXXXX COMMAND INVALID                  * 11200022
*                                                                     * 11400022
* TABLES/WORK AREAS - OPERATOR CONTROL AVT, TCAM AVT, OPCE, OPERATOR  * 11600022
*                    CONTROL RESIDENT WORK AREA.                      * 11800022
*                                                                     * 12000022
* ATTRIBUTES - SUPERVISOR MODE, DISABLED, TRANSIENT(TYPE 4 SVC), NON- * 12200022
*             REENTRANT, SERIALLY REUSABLE, REFRESHABLE.              * 12400022
*                                                                     * 12600022
*                                                                     * 12800022
*CHARACTER CODE DEPENDENCY                                            * 13000022
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL            * 13200022
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT * 13400022
*    TO THAT USED AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED SO  * 13600022
*    THAT REDEFINITION OF CHARACTER CONSTANTS, BY REASSEMBLY, WILL    * 13800022
*    RESULT IN A CORRECT MODULE FOR THE NEW DEFINITION.               * 14000022
*                                                                     * 14200022
* NOTES -                                                             * 14400022
*    COMMUNICATIONS BETWEEN THE VARIOUS MODULES/TRANSIENTS IS         * 14600022
*    PRIMARILY THROUGH THE OPERATOR CONTROL ADDRESS VECTOR TABLE (AVT)* 14800022
*    RESTRICTIONS - NONE                                       @Y17XART 14820010
*    REGISTER CONVENTIONS - STANDARD OP CTL                    @Y17XART 14840010
*    PATCH LABEL - ZAPAREA                                     @Y17XART 14860010
* MODULE TYPE - PROCEEDURE                                     @Y17XART 14870010
*    PROCESSOR - ASSEMBLER                                     @Y17XART 14900010
*    MODULE SIZE - 3F3                                         @Y17XART 14910010
*                                                                     * 15000022
*********************************************************************** 15200022
         EJECT                                                          15400022
         SPACE                                                          15600022
RZERO    EQU   0                        PARM REG 0                      15800022
RPARM    EQU   1                        PARM REG 1                      16000022
ROPCAVT  EQU   2                        OP CONTROL AVT POINTER          16200022
ROPCE    EQU   3                        CURRENT ELEMENT ADDRESS         16400022
RAVT     EQU   4                        TCAM AVT ADDRESS                16600022
RWORKA   EQU   5                        WORK REGISTER                   16800022
RLEN     EQU   6                        DATA LENGTH                     17000022
RAPTR    EQU   7                        ADVANCE SCAN PTR                17200022
RRPTR    EQU   8                        REAR SCAN PTR                   17400022
RTEMP    EQU   8                        TEMP REG               @OY12425 17500010
RBYSCN   EQU   9                        NUMBER OF BYTES SCANNED         17600022
RSCNRTN  EQU   10                       SCAN ROUTINE RETURN REG         17800022
RWRK11   EQU   11                       WORK REGISTER                   18000022
RBASE    EQU   12                       MODULE BASE                     18200022
RSAVE    EQU   13                       REG SAVE PTR                    18400022
RRET     EQU   14                       SUBROUTINE RETURN ADDRESS       18600022
RLINK    EQU   15                       LINK REG                        18800022
         SPACE                                                          19000022
         SPACE                                                          19200022
ZERO     EQU   0                        ZERO VALUE                      19400022
ONE      EQU   1                        VALUE ONE                       19600022
TWO      EQU   2                        VALUE TWO                       19800022
NAMELEN  EQU   2                        NAME LENGTH                     20000022
THREE    EQU   3                        VALUE THREE                     20200022
VARINAME EQU   3                        OFFSET TO CHANGE XCTL NAME      20400022
FOUR     EQU   4                        VALUE FOUR                      20600022
FIVE     EQU   5                        VALUE FIVE                      20800022
SIX      EQU   6                        VALUE SIX                       21000022
SEVEN    EQU   7                        VALUE SEVEN                     21200022
EIGHT    EQU   8                        VALUE EIGHT                     21400022
TWELVE   EQU   12                       VALUE TWELVE                    21600022
SIXTEEN  EQU   16                       VALUE SIXTEEN                   21800022
NFNDCD   EQU   16                       NOT FOUND ERROR CODE            22000022
SEVNTEEN EQU   17                       VALUE SEVENTEEN                 22200022
NOPNCD   EQU   17                       NOT OPERATIONAL ERROR CODE      22400022
EIGHTEEN EQU   18                       VALUE EIGHTEEN                  22600022
THIRTY2  EQU   32                       VALUE THIRTY TWO                22800022
THIRTY4  EQU   34                       VALUE THIRTY FOUR               23000022
NINTY5   EQU   95                       VALUE 95                        23200022
ONEOTWO  EQU   102                      VALUE ONE HUNDRED TWO           23400022
ONE28    EQU   128                      VALUE 128                       23600022
BLANK    EQU   C' '                     BLANK CHAR                      23800022
COMMA    EQU   C','                     COMMA                           24000022
ALPHAA   EQU   C'A'                     CHAR 'A'                 S22024 24100022
LGB3705  EQU   X'80'                    3705 LINE GROUP BLOCK    S22024 24120022
TERM3705 EQU   X'10'                    TERM IN 3705 MODE        S22024 24140022
MSG201   EQU   201                      INVALID FOR 3705 MSG     S22024 24160022
EQUAL    EQU   C'='                     EQUAL                           24200022
X80      EQU   X'80'                    HEX 80                          24400022
X0E      EQU   X'0E'                    HEX 0E                          24600022
XF0      EQU   X'F0'                    HEX F0                          24800022
FOXFOX   EQU   X'FF'                    HEX FF                          25000022
DOLLAR   EQU   C'$'                     DOLLAR SIGN             SA69086 25050010
POUND    EQU   C'#'                     POUND SIGN              SA69086 25100010
AT       EQU   C'@'                     AT SIGN                 SA69086 25150010
         EJECT                                                          25200022
         USING IEDQAVTD,RAVT            TCAM AVT ADDRESSABILITY         25400022
         USING IEDQOPCD,ROPCAVT         OP CONTROL AVT ADDRESSABILITY   25600022
         USING IEDQOPCE,ROPCE           ELEMENT ADDRESSABILITY          25800022
         SPACE                                                          26000022
         BALR  RBASE,0                  SET BASE REGISTER               26200022
         USING *,RBASE                  MODULE ADDRESSABILITY           26400022
IGCMA10D IEDHJN SKIPID                                                  27100022
         LR    ROPCAVT,RPARM            GET OP CTL AVT ADDR             27800022
         LM    ROPCE,RBYSCN,OPCSAVE     RESTORE REGS STORED IN M0       28000022
         LR    RWRK11,RZERO             SET UP OFFSET FOR               28200022
         LA    RSAVE,OPCSAVE            SET R13 FOR SERVICE MODULE      28400022
         B     BRTBL(RWRK11)              BRANCH INTO OP BR TBL         28600022
         SPACE                                                          28800022
****        THIS IS AN OPERAND BRANCH TABLE        ****                 29000022
BRTBL    EQU   *                        OPERAND BRANCH TABLE            29200022
         B     TIMEDAT                  BRANCH TIMEDAT  OPERAND         29400022
         B     SWITCH                   BRANCH SWITCH   OPERAND         29600022
         B     SWBACK                   BRANCH SWBACK   OPERAND         29800022
         B     OPT                      BRANCH OPT      OPERAND         30000022
         B     OLT                      BRANCH OLT      OPERAND         30200022
         B     IPL                      BRANCH IPL      OPERAND         30400022
         B     INTENSEL                 BRANCH INTENSEL OPERAND         30600022
         B     INTENSET                 BRANCH INTENSET OPERAND         30800022
         B     ID                       BRANCH ID       OPERAND         31000022
         B     DUMP                     BRANCH DUMP     OPERAND         31200022
         B     DEBUGL                   BRANCH DEBUGL   OPERAND         31400022
         B     DEBUGD                   BRANCH DEBUGD   OPERAND         31600022
         B     CHNGLOAD                 BRANCH CHNGLOAD OPERAND         31800022
         B     BTRACE                   BRANCH BTRACE   OPERAND         32200022
         B     BACKUP                   BRANCH BACKUP   OPERAND         32400022
         B     INTERVAL                 BRANCH INTERVAL OPERAND         32600022
AUTOPOLL EQU   *                                                        32800022
         CLC   OPCDOUBL(EIGHT),SYSCON   EQUAL SYSCON                    33000022
         BE    SWUPONE                  YES, BR TO SET SYSCON SW        33200022
         B     OPSTAT                   OPERATOR = STATNAME             33400022
INTERVAL EQU   *                                                        33600022
         CLC   OPCDOUBL(EIGHT),SYSTEM   EQUAL SYSTEM                    33800022
         BNE   NOSYSCON                 NOT SYSTEM, GO CK POLL          34000022
         LTR   RLEN,RLEN                YES, CHECK FOR DATA ALSO        34200022
         BNP   SWUPONE                  NO, SET OP SWITCH NO DATA       34400022
         LA    RZERO,FIVE               LOAD FIVE TO REG FOR COMP       34600022
         CR    RLEN,RZERO               COMPARE DATA LEN TO FIVE        34800022
         BH    NOMATCH                  GREATER THAN FIVE - NG          35000022
         EX    RLEN,MVDATA                    FOR MOVE TO OPCE          35200022
         STH   RLEN,OCBACKUP            SAVE LENGTH                     35400022
         SR    RWRK11,RWRK11            UP SWITCH                       35600022
         IC    RWRK11,OCSWITCH            COUNT BY TWO                  35800022
         LA    RWRK11,ONE(RWRK11)           FOR SYSTEM                  36000022
         B     SWTWO                           PLUS DATA                36200022
MVDATA   MVC   OCBACKUP+TWO(ZERO),ZERO(RAPTR) MOVE DATA          S22024 36400000
NOSYSCON EQU   *                                                        36600022
         CLC   OPCDOUBL(EIGHT),POLL      TEST FOR POLL                  36800022
         BNE   NOMATCH                  INTVL NOT SYS/POLL - REJECT     37000022
         CLI   OCSWITCH,X0E             YES, CHECK OP SWITCH FOR )      37200022
         BNE   NOMATCH                  NOT E - ERROR                   37400022
         LR    RRPTR,RAPTR              SET UP FOR SCAN                 37600022
         BAL   RSCNRTN,SCNTODEL         SCAN TO NEXT DELIMITER          37800022
         LTR   RBYSCN,RBYSCN            CHECK FOR ZERO BYTES            38000022
         BNP   NOMATCH                     SCANNED                      38200022
         MVI   OPCDOUBL,BLANK           SET DOUBLE WORD WORK AREA       38400022
         MVC   OPCDOUBL+ONE(SEVEN),OPCDOUBL TO BLANKS                   38600022
         LA    RZERO,EIGHT              PREPARE COMPARE REG    @OS77841 38640010
         CR    RBYSCN,RZERO             CHAR LENGTH GREATER    @OS77841 38680010
*                                       EIGHT                  @OS77841 38720010
         BH    NOMATCH                  YES,BRANCH             @OS77841 38760010
         BCTR  RBYSCN,RZERO             REDUCE COUNT FOR EXECUTE        38800022
         EX    RBYSCN,MVADDR            MOVE SCANNED FIELD TO WORK      39000022
OPSTAT   EQU   *                                                        39200022
         L     RLINK,OPCTOFLK           GET ADDR OF TERM ENTRY RTN      39400022
         BALR  RRET,RLINK               LINK TO TERM ENTRY RTN          39600022
         B     STAT                     GOOD RETURN - GO PROCESS        39800022
         LA    RZERO,SIXTEEN            SET STA NOT FOUND               40000022
         B     XCTLERR                  GO OUTPUT MESSAGE               40200022
STAT     EQU   *                                                        40400022
         ST    RPARM,OCMODNME           SAVE TERM ADDR                  40600022
         LR    RRPTR,RAPTR              SET UP FOR SCAN          S22024 40800022
         BAL   RSCNRTN,SCNTODEL         SCAN TO NEXT DEL.        S22024 40890022
         LTR   RBYSCN,RBYSCN            ZERO BYTES SCANNED?      S22024 40980022
         BNP   XCTLMOD                  YES - TO FUNCTION MODULE S22024 41070022
         LA    RWRK11,FIVE              SET UP TO CHECK DATA     S22024 41160022
         CR    RBYSCN,RWRK11             LENGTH                  S22024 41250022
         BH    NOMATCH                  OVER 5 - INDICATE INVALIDS22024 41340022
         EX    RBYSCN,MOVEDATA          MOVE INTERVAL TO ELEMENT S22024 41430022
         STH   RBYSCN,OCBACKUP          SET LENGTH OF DATA       S22024 41520022
         MVI   OCBACKUP+SEVEN,ZERO      CLEAR 3705 INDO          S22024 41610022
         LTR   RLEN,RLEN                ANYTHING LEFT AFTER DATA S22024 41700022
         BNP   XCTLMOD                  NO, TO FUNCTION MOD      S22024 41790022
         MVC   OCBACKUP+SEVEN(ONE),ZERO(RAPTR) SET TO ELEMENT    S22024 41880022
         LA    RWRK11,ONE               SET UP TO CHECK FOR ONLY S22024 41970022
         CR    RLEN,RWRK11              ONE BYTE INDICATED       S22024 42060022
         BH    NOMATCH                  NO, ERROR - GO INDICATE  S22024 42150022
         B     XCTLMOD                  GO TO FUNCTION MODULE    S22024 42240022
BACKUP   EQU   *                                                        42400022
TIMEDAT  EQU   *                                                        42600022
SWITCH   EQU   *                                                        42800022
SWBACK   EQU   *                                                        43000022
OPT      EQU   *                                                        43200022
         SPACE                                                          43400022
****     MODIFY OPTION       ******                                     43600022
         BAL   RRET,STATNME             GO PROCESS STATNAME             43800022
         LR    RRPTR,RAPTR              UPDATE DATA POINTER             44000022
         BAL   RSCNRTN,SCNTODEL         SCAN TO NEXT DELIMITER          44200022
         LTR   RBYSCN,RBYSCN            TEST NUMBER BYTES SCANNED       44400022
         BNP   NOMATCH                   ZERO - INVALID CMD             44600022
         LA    RZERO,EIGHT              SET UP TO TEST                  44800022
         CLR   RBYSCN,RZERO              BYTES SCANNED FOR EIGHT        45000022
         BH    NOMATCH                  GR THAN 8 - INVALID CMD         45200022
         MVI   OPCDOUBL,BLANK           BLANK OUT OPCDOUBL FIELD        45400022
         MVC   OPCDOUBL+ONE(SEVEN),OPCDOUBL FOR SUBROUTINE USE          45600022
         BCTR  RBYSCN,RZERO             REDUCE BYSCND CNT FOR EXECUTE   45800022
         EX    RBYSCN,MVADDR            MOVE SCANNED DATA TO OPCDOUBL   46000022
         LA    RBYSCN,ONE(RBYSCN)       RESTORE BYTES SCANNED COUNT     46200022
BFRDATA  EQU   *                                                        46400022
         STM   ROPCE,RBYSCN,OPCSAVE     SAVE REGS FOR FUNCTION MODULE   46600022
         B     XCTLMOD                  XCTL TO FUNCTION MODULE         46800022
OLT      EQU   *                                                        47000022
         CLI   AVTOLTST,ZERO            OLT IN SYSTEM                   47200022
         BZ    NOOLT                    NO, PREPARE TO EXIT - ERROR     47400022
         MVC   ZERO(TWO,RWORKA),TWO(RWORKA) SHIFT COUNT                 48000022
         LA    RWRK11,ONE28             SET LOOP FACTOR                 48200022
MVELP    EQU   *                                                        48400022
         L     RPARM,EIGHT(RWORKA)      PICK UP FOUR BYTES OF DATA      48600022
         ST    RPARM,FOUR(RWORKA)       STORE DATA                      48800022
         LA    RWORKA,FOUR(RWORKA)      BUMP DATA PTR BY FOUR           49000022
         BCT   RWRK11,MVELP             LOOP UNTIL ALL DATA IS MOVED    49200022
         B     XCTLMOD                  GO TO FUNCTION MODULE           49400022
NOOLT    EQU   *                                                        49600022
         LA    RZERO,NINTY5             SET MSG NUMBER                  49800022
         MVI   OCSWITCH,ZERO            CLEAR OLT INDICATION     S05331 49900052
         B     XCTLERR                  GO OUTPUT ERROR MSG             50000022
IPL      EQU   *                                                        50200022
INTENSEL EQU   *                                                        50400022
         BAL   RRET,GPNRLADR            LINK TO GET RLN ADDRESS         50600022
         USING IHADCB,RPARM                                      S22024 50640022
         TM    DCBDSORG,LGB3705         IS THIS A 3705 LGB ?     S22024 50680022
         BO    INV3705                  YES, CMD INVALID FOR 3705S22024 50720022
         DROP  RPARM                                             S22024 50760022
         B     SNSENCNT                 GO GET SENSE AND COUNT          50800022
INTENSET EQU   *                                                        51000022
         BAL   RRET,STATNME             GO PROCESS STATNAME             51200022
         USING IEDQTRM,RPARM                                     S22024 51240022
         TM    TRMSTATE,TRMPREF         TERMINAL NOT 270X MDE  @Y17XART 51250010
         BO    INV3705                  YES, CMD INVALID FOR 3705S22024 51320022
         DROP  RPARM                                             S22024 51360022
         SPACE                                                          51400022
SNSENCNT EQU   *                                                        51600022
         LR    RRPTR,RAPTR              SET UP FOR SCAN RTN             51800022
         BAL   RSCNRTN,SCNTODEL         SCAN TO NEXT DELIMITER          52000022
         LA    RWRK11,TWO               CHECK BYTES SCALLED             52200022
         CR    RBYSCN,RWRK11              EQUAL TWO                     52400022
         BNE   NOMATCH                  INVALID SENSE INDICATION        52600022
         MVC   OCMODNME(TWO),ZERO(RRPTR) MOVE SENSE TO OPCE             52800022
         LTR   RLEN,RLEN                TEST FOR COUNT                  53000022
         BZ    COUNT                    NO COUNT - BR TO STORE ZERO     53200022
         CR    RLEN,RWRK11              TEST FOR 2 BYTES OF COUNT       53400022
         BH    NOMATCH                  MORE THAN TWO - INVALID         53600022
         BE    TWOCNT                   TWO - BR TO MOVE COUNT          53800022
         LA    RLEN,XF0                 SET 1ST DIGIT TO ZERO           54000022
         SLL   RLEN,EIGHT               SHIFT TO PICK NEXT CHAR         54200022
         IC    RLEN,ZERO(RAPTR)         MUST BE ONE BYTE                54400022
         STH   RLEN,OCMODNME+TWO        COUNT TO OPCE                   54600022
         B     XCTLMOD                  TO FUNCTION ROUTINE             54800022
         SPACE                                                          55000022
COUNT    EQU   *                                                        55200022
         MVC   OCMODNME+TWO(TWO),CHAR15 DEFAULT TO FIFTEEN              55400022
         B     XCTLMOD                  TO FUNCTION ROUTINE             55600022
         SPACE                                                          55800022
TWOCNT   EQU   *                                                        56000022
         MVC   OCMODNME+TWO(TWO),ZERO(RAPTR)  SET COUNT INTO ELEMENT    56200022
         B     XCTLMOD                  XCTL TO FUNCTION MOD            56400022
ID       EQU   *                        ****                            56600022
DUMP     EQU   *                        ****                            56800022
DEBUGL   EQU   *                        ****                            57000022
DEBUGD   EQU   *                        ****                            57200022
         MVC   OCMODNME(EIGHT),OPCDOUBL MOVE PGMNAME TO ELEMENT         57400022
         CLC   OCMODNME(SIX),FENAME     CHECK FOR VALID NAME            57600022
         BE    XCTLMOD                  YES-XCTL TO FUNCTION MOD        57800022
         LA    RZERO,ONEOTWO            NO-SET ERROR MSG CODE           58000022
         B     XCTLERR                  OUTPUT ERROR MSG                58200022
CHNGLOAD EQU   *                        ****                            58400022
BTRACE   EQU   *                        ****                            58800022
         SPACE                                                          59000022
* DCB LOOKUP ROUTINE *                                                  59200022
GRPNAME  EQU   *                                                        59400022
         ST    RRET,OCPARM              SAVE RETURN ADDRESS    @OY12425 59600010
         LA    RPARM,ONE                SET A ONE VALUE IN PARM REG     59800022
         L     RLINK,OPCDCBLK           GET ADDR OF DCB LOOKUP RTN      60000022
         LA    RSAVE,OPCSAVE            SET PTR TO OP CTL SAVE AREA     60200022
         BALR  RRET,RLINK               BRANCH TO LOCATE DCB            60400022
         B     GOODDCB                  DCB LOCATED - BR TO PROCESS     60600022
         LA    RWRK11,TWO               SET VALUE FOR REG COMP          60800022
         CLR   RZERO,RWRK11             CHECK RETURN CODE               61000022
         BH    NOTOPN                   GT TWO - NOT OPEN               61200022
         LA    RZERO,NFNDCD             OTHERWISE NOT FOUND             61400022
         B     XCTLERR                  GO INDICATE NOT FOUND           61600022
NOTOPN   EQU   *                                                        61800022
         LA    RZERO,NOPNCD             SET UP NOT OPEN ERROR           62000022
         B     XCTLERR                  GO INDICATE NOT OPEN            62200022
GOODDCB  EQU   *                                                        62400022
         L     RRET,OCPARM              LOAD RETURN ADDRESS    @OY12425 62600010
         BR    RRET                     RETURN TO CALLER                62800022
         SPACE                                                          63000022
         SPACE                                                          63200022
****      SCAN TO DELIMETER ROUTINE      ******                         63400022
SCNTODEL EQU   *                                                        63600022
         SR    RBYSCN,RBYSCN            INITIALIZE BYTES SCANNED REG    63800022
LOOPSCN  EQU   *                                                        64000022
         LTR   RLEN,RLEN                TEST FOR END OF DATA            64200022
         BNP   ENDSCN                   YES, END SCAN                   64400022
         CLI   ZERO(RAPTR),COMMA        CHECK COMMA DELIMITER           64600022
         BE    SETRTN                   YES, SET UP RETURN              64800022
         CLI   ZERO(RAPTR),EQUAL        CHECK FOR EQUAL DELIMITER       65000022
         BE    SETRTN                   YES, SET UP RETURN              65200022
         CLI   ZERO(RAPTR),BLANK        CHECK BLANK DELIMITER           65400022
         BE    SETRTN                   YES, SET UP RETURN              65600022
         CLI   ZERO(RAPTR),DOLLAR       DOLLAR SIGN ?           SA69086 65608010
         BE    BUMPIT                   YES, BRANCH             SA69086 65616010
         CLI   ZERO(RAPTR),POUND        POUND SIGN ?            SA69086 65624010
         BE    BUMPIT                   YES, BRANCH             SA69086 65632010
         CLI   ZERO(RAPTR),AT           AT SIGN ?               SA69086 65640010
         BE    BUMPIT                   YES, BRANCH             SA69086 65648010
         CLI   ZERO(RAPTR),ALPHAA       LESS THAN A              S22024 65660022
         BL    NOMATCH                  YES - INVALID            S22024 65720022
BUMPIT   EQU   *                                                SA69086 65760010
         LA    RBYSCN,ONE(RBYSCN)       BUMP BYTES SCANNED BY ONE       65800022
         LA    RAPTR,ONE(RAPTR)         BUMP ADVANCE SCAN PTR BY ONE    66000022
         BCTR  RLEN,RZERO               REDUCE DATA LENGTH BY ONE       66200022
         B     LOOPSCN                  LOOP TO SCAN NEXT POSITION      66400022
SETRTN   EQU   *                                                        66600022
         BCTR  RLEN,RZERO               REDUCE DATA LENGTH BY ONE       66800022
         LA    RAPTR,ONE(RAPTR)         BUMP ADVANCE PTR PAST DELIMITER 67000022
ENDSCN   EQU   *                                                        67200022
         BR    RSCNRTN                  RETURN TO CALLING RTN           67400022
         SPACE                                                          67600022
GPNRLADR EQU   *                                                        67800022
         ST    RRET,OCPARM              SAVE RETURN ADDRESS    @OY12525 67900010
         MVI   OCSCAN,OCADDR+OCDDNRLN   GRPNME,RLN OR ADDR     @OY12425 68000010
         LR    RWRK11,RRPTR             SETUP SCAN PTR         @OY12425 68100010
         L     RLINK,OPCDCBLK           PREPARE TO GO          @OY12425 68200010
         BAL   RRET,FOUR(RLINK)          OPSCAN RTN IN CA      @OY12425 68300010
         B     SETPTR                   NAME FOUND             @OY12425 68400010
         B     NOTFOUND                 NAME NOT FOUND         @OY12425 68500010
         B     NOMATCH                  SYNTAX ERROR           @OY12425 68600010
SETPTR   EQU   *                                               @OY12425 68700010
         LR    RTEMP,RWRK11             ADJUST NUMBER OF BYTES @OY12425 68800010
         SR    RTEMP,RAPTR                 LEFT TO SCAN        @OY12425 68900010
         SR    RLEN,RTEMP               STORE IN LENGTH REG    @OY12425 69000010
         LR    RAPTR,RWRK11             RESET SCAN PTR FOR MA  @OY12425 69100010
         B     GOODRTRN                 CONTINUE WITH GOOD CDE @OY12425 69200010
NOTFOUND EQU   *                                               @OY12425 69300010
         LA    RZERO,SEVNTEEN           SET ERR MSG CODE       @OY12425 69400010
         B     XCTLERR                  BR TO CALL ERR MSG MOD @OY12425 69500010
         SPACE                                                          70000022
MVADDR   MVC   OPCDOUBL(ZERO),ZERO(RRPTR) MOVE ADDRESS FOR DCB ROUTINE  70200022
MOVEDATA MVC   OCBACKUP+TWO(ZERO),ZERO(RRPTR) MOVE DATA          S22024 70300000
         SPACE                                                          70400022
         SPACE                                                          74800022
         SPACE                                                          75400022
CKOFFON  EQU   *                                                        75600022
         LR    RRPTR,RAPTR              SET UP FOR SCAN ROUTINE         75800022
         BAL   RSCNRTN,SCNTODEL         GO SCAN                         76000022
         LA    RWRK11,THREE             SET UP TO                       76200022
         CR    RBYSCN,RWRK11              CHECK BYTES SCANNED           76400022
         BE    CKOFF                    THREE - CHECK OFF               76600022
         BH    NOMATCH                  MORE THAN THREE - INVALID       76800022
         CLC   ZERO(TWO,RRPTR),ON       CHECK ON                        77000022
         BNE   NOMATCH                  NO - INVALID COMMAND            77200022
SWUPONE  EQU   *                                                        77400022
         SR    RWRK11,RWRK11            YES -                           77600022
         IC    RWRK11,OCSWITCH            INCREMENT                     77800022
SWTWO    EQU   *                                                        78000022
         LA    RWRK11,ONE(RWRK11)           SWITCH                      78200022
         STC   RWRK11,OCSWITCH                  BY ONE                  78400022
         B     XCTLMOD                  GO TO FUNCTION MODULE           78600022
CKOFF    CLC   ZERO(THREE,RRPTR),OFF    CHECK OFF                       78800022
         BE    XCTLMOD                  YES - TO FUNCTION MODULE        79000022
         SPACE                                                          79200022
* SET COMMAND INVALID MESSAGE                                           79400022
NOMATCH  EQU   *                                                        79600022
         LA    RZERO,EIGHTEEN           SET MSG NUM FOR MOD 03          79800022
         B     XCTLERR                  GO OUTPUT MESSAGE               80000022
         SPACE 2                                                 S22024 80040022
INV3705  EQU   *                                                 S22024 80080022
         LA    RZERO,MSG201             SET EEROR MSG 201        S22024 80120022
         B     XCTLERR                  GO TO MSG MODULE         S22024 80160022
         SPACE                                                          80200022
GOODRTRN EQU   *                                                        80400022
         L     RRET,OCPARM              LOAD RETURN ADDRESS    @OY12425 80600010
         XC    OCPARM(4),OCPARM         CLEAR OCPARM FIELD     @OY12425 80700010
         BR    RRET                     RETURN TO CALLING ROUTINE       80800022
         SPACE                                                          81000022
STATNME  EQU   *                                                        81200022
         ST    RRET,OCPARM              SAVE RETURN ADDRESS    @OY12425 81400010
         L     RLINK,OPCTOFLK           GET ADDR OF TERM ENTRY RTN      81600022
         BALR  RRET,RLINK               LINK TO TERM ENTRY RTN          81800022
         B     GOODRTRN                 GOOD ENTRY - BR TO PROCESS      82000022
         LA    RZERO,SIXTEEN            SET STA NOT FOUND               82200022
         SPACE                                                          82400022
XCTLERR  EQU   *                                                        82600022
         MVC   OPCLDNME+VARINAME(NAMELEN),ERRWRT SET UP FOR XCTL        82800022
XCTLMOD  EQU   *                                                        83000022
         LR    RPARM,ROPCAVT            PASS OP CTL AVT PTR             83200022
         XCTL  SF=(E,OPCXCTL)           CALL FUNCTION MODULE            83400022
         SPACE                                                          83600022
         SPACE                                                          83800022
MAXVAL   DC    H'255'                   MAXIMUM VALUE FOR RLN IS 255    84000022
ON       DC    C'ON'                    CHARACTERS 'ON'                 84200022
OFF      DC    C'OFF'                   CHARACTERS 'OFF'                84400022
ERRWRT   DC    C'03'                    WRITE ERROR MESSAGE MOD         84600022
CHAR15   DC    C'15'                    MAXIMUM INTENSE VALUE           84800022
POLL     DC    C'POLL    '              CHARACTERS 'POLL'               85000022
SYSTEM   DC    C'SYSTEM  '              CHACACTERS 'SYSTEM'             85200022
SYSCON   DC    C'SYSCON  '              CHARACTERS 'SYSCON'             85400022
FENAME   DC    C'IEDQFE'                F E ROUTER MOD NAME             85600022
ZAPAREA  DC    50X'FF'                  PATCH AREA             @Y17XART 85700010
         EJECT                                                          85800022
         TAVTD                                                          86000022
         EJECT                                                          86200022
         TOPCAVTD                                                       86400022
         EJECT                                                          86600022
         TOPCED                                                         86800022
         EJECT                                                          86840022
         DCBD  DSORG=TX                 S22024                          86880022
         EJECT                                                          86920022
         TTRMD                                                   S22024 86960022
         END                                                            87000022
