         TITLE ' IGCME10D - 3705 IPL - INPUT LOAD MODULE'               00050022
IGCME10D CSECT                                                          00100022
         SPACE                                                          00300022
************************START OF SPECFICATIONS************************* 00400000
*                                                                     * 00800000
* $MOD(IGCME10D) COMP(R@) PROD(TCAM):                              @01C 01200025
*                                                                     * 01600000
* DESCRIPTIVE NAME = 3705 IPL READ RECORD MODULE                      * 02000000
*                                                                     * 02400000
* COPYRIGHT = NONE                                                    * 02800000
*                                                                     * 03200000
* STATUS = VERSION 10.0                                               * 03600000
*    FUNCTION = THIS MODULE READS LOAD MODULE RECORDS OFF THE DATA    * 04000000
*    SET AND THE INPUT RECORD IS SEARCHED FOR A CONTROL RECORD. THE     06000022
*    COUNT AND RELATIVE ADDRESS IN THE CCW FIELD OF THE RECORD ARE      06100022
*    PLACED IN 'TXTLNGTH' AND 'TXTADDR'. THE FOLLOWING TEXT RECORD      06200022
*    IS PASSED TO IGCMG10D. IF A CONTROL RECORD INDICATES THAT          06300000
*    THE FOLLOWING TEXT RECORD IS THE LAST THEN 'LASTSW' IS SET IN      06400022
*    THE WORKAREA. IF AN RLD RECORD COMES AS THE LAST RECORD THEN       06500022
*    'TXTLNGTH' IS ZEROED AND 'LASTSW' IS TURNED ON. CONTROL IS THEN    06600022
*    PASSED TO IGCMG10D.                                                06700022
*    THIS ROUTINE RECEIVES CONTROL INITIALLY FROM EITHER IGCMD10D OR    06800022
*    IGCMG10D. IF INITIAL TEST WAS SELECTED IT RECEIVES CONTROL FIRST   06900022
*    FROM IGCMD10D, IF NOT FROM IGCMF10D. UPON BEING ENTERED IT SETS    07000022
*    UP ADDRESSABILITY FOR THE WORKAREA USED BY THE VARIOUS LOADS OF    07100022
*    IPL THEN DETERMINES WHO PASSED CONTROL. IF REGISTER 0              07200000
*    EQUALS 1 CONTROL WAS PASSED FROM IGCMD10D OR IGCMF10D, REG0 = 2    07300000
*    CONTROL CAME FROM IGCMG10D TO GET MORE DATA. IF REG0 = 3           07400000
*    CONTROL CAME FROM CESD CODE IN IGCMG10D, AND IF NOT 3 CONTROL      07500022
*    CAME FROM RLD CODE IN IGCMG10D.                                    07600022
*    IF ENTERED FROM IGCMD10D INPUT SWITCHES ARE CLEARED.               07700000
*    IF INITIAL TEST IS SELECTED, BITS CALLING FOR                      07900000
*    RELOCATE ARE TURNED OFF AND THE ADDRESS OF DCB FOR INITIAL TEST    08000022
*    IS OBTAINED FROM THE WORKAREA. THE DECB IS INITIALIZED WITH THE    08100000
*    DCB ADDRESS AND THE ADDRESS OF THE INPUT BUFFER.  READ AND         08200000
*    CHECK ARE USED TO OBTAIN THE NEXT INPUT RECORDS.                   08300000
*    A CHECK IS MADE TO SEE IF IT IS A TEXT RECORD. THE LOAD MODULE     08600022
*    IS ARRANGED SUCH THAT CESD RECORDS ARE FIRST, FOLLOWED BY          08700022
*    CONTROL AND TEXT RECORDS. A TEXT RECORD FOLLOWS A CONTROL          08800022
*    RECORD. IF NOT A TEXT RECORD A CHECK IS MADE TO SEE IF RELOCATE    08900000
*    HAS BEEN CANCELLED. IF NO EITHER THE CESD OR RLD CODE IN           09000022
*    IGCMG10D IS XCTLED TO. OTHERWISE THE RECORD IS CHECKED TO SEE IF   09100022
*    IT IS A CONTROL RECORD. IF YES THE BIT IN THE WORKAREA IS SET TO   09200022
*    INDICATE A TEXT RECORD IS TO FOLLOW. THE BUFFER SIZE IS CHECKED    09300022
*    AND IF GREATER THAN 1024 ERROR MESSAGE 167 RECORD TOO LARGE IS     09400000
*    WRITTEN OUT AND IPL TERMINATES. OTHERWISE A CHECK IS MADE TO       09500022
*    SEE IF THIS IS THE FIRST  TEXT RECORD. IF NO AND NO RELOCATE       09600000
*    AND NO INITIAL TEST AN XCTL TO IGCMG10D IS DONE IN ORDER TO SET    09700022
*    UP THE OUTPUT BUFFER FOR THE WRITE OPERATION. IF NOT 1ST TEXT      09800022
*    RECORD AND RELOCATE IS IN EFFECT THE TEXT POINTER IS CALCULATED    09900022
*    AND A CHECK IS MADE FOR LAST TEXT COMING, IF YES SET LAST TEXT     10000022
*    INDICATOR IN WORKAREA AND BRANCH BACK TO CODE TO READ ANOTHER      10100022
*    RECORD. IF NOT LAST TEXT COMING BRANCH TO READ ANOTHER RECORD.     10200022
*    IF RECORD IN THE INPUT BUFFER IS A TEXT RECORD, THE RECORD IS      10300022
*    MOVED TO THE WORK BUFFER AND IF THE LAST TEXT FLAG IS ON IT IS     10400022
*    PASSED TO IGCMG10D. IF NOT THE TEXT FLAG IS TURNED OFF AND         10500022
*    A READ FOR ANOTHER RECORD IS DONE.                                 10600022
*    IF RECORD READ IN IS TEXT AND INITIAL TEST FLAG IS ON A BRANCH     10700022
*    TO THE CODE WHICH SKIPS OVER THE FIRST X'700' BYTES IS DONE        10800022
*    AND THE INITIAL TEST FLAG IS TURNED OFF.                           10900022
*    AS EACH CONTROL RECORD IS FOUND THE COUNT AND RELATIVE             11000022
*    ADDRESS IN THE CCW FIELD OF THE CONTROL RECORD ARE PLACED IN       11100022
*    'TXTLNGTH' AND 'TXTADDR' IN THE WORKAREA. THESE TWO VALUES         11200022
*    ARE USED WHEN PROCESSING THE NEXT RECORD READ WHICH WILL BE A      11300022
*    TEXT RECORD.                                                       11400022
*                                                                     * 11401000
* NOTES = SEE BELOW                                                   * 11402000
*                                                                     * 11403000
*    DEPENDENCIES = EBCDIC CHARACTER CODE DEPENDENCIES - CORRECTABLE  * 11404000
*                   BY REASSEMBLY                                     * 11405000
*                                                                     * 11406000
*    RESTRICTIONS = NONE                                              * 11407000
*                                                                     * 11408000
*    REGISTER CONVENTIONS = R1 OPCAVT                                 * 11409000
*                           R2 OPCAVT                                 * 11410000
*                           R4 OPCE                                   * 11411027
*                           R7 = IPL/DUMP COMMON WORKAREA             * 11412000
*                           R4 = IPL WORKAREA 1                       * 11412300
*                           RB = IPL WORKAREA 2                       * 11412600
*                                                                     * 11413000
*    PATCH LABEL = NONE                                               * 11414000
*                                                                     * 11415000
* MODULE TYPE =                                                       * 11416000
*                                                                     * 11417000
*    PROCESSOR = ASSEMBLER XF                                         * 11418000
*                                                                     * 11419000
*    ATTRIBUTES = REFRESHABLE,SERIALLY REUSABLE,TRANSIENT(TYPE 4),    * 11420000
*                 SUPERVISOR MODE,REENTRANT                           * 11421000
*                                                                     * 11422000
* ENTRY POINT = IGCME10D                                              * 11423000
*                                                                     * 11424000
*    PURPOSE = SEE FUNCTION                                           * 11425000
*                                                                     * 11426000
*    LINKAGE = XCTL SF=(E,OPCXCTL)                                    * 11427000
*                                                                     * 11428000
* INPUT = R0=1 ENTRY FROM IGCMD10D                                    * 11429000
*         R0=2 ENTRY FROM IGCMF10D                                    * 11430000
*         R0=3 ENTRY FOR CESD PROCESSING                              * 11431000
*         R0=4 ENTRY FOR RLD PROCESSING                               * 11432000
*                                                                     * 11433000
* OUTPUT =R0=1 EXIT TO IGCMG10D                                       * 11434000
*         OPCCOPCE CURRENT ELEMENT                                    * 11435000
*         R0=2 IGCMG10D FOR CESD PROCESSING                           * 11436000
*         R0=3 IGCMG10D FOR RLD PROCESSING                            * 11437000
*                                                                     * 11438000
* EXIT-NORMAL = IGCMF10D IGCMG10D                                     * 11439000
*                                                                     * 11440000
* EXIT-ERROR = IGCMI10D                                               * 11441000
*                                                                     * 11442000
* EXTERNAL REFERENCES = SEE BELOW                                     * 11443000
*                                                                     * 11444000
*    ROUTINES = NONE                                                  * 11445000
*                                                                     * 11446000
*    DATA AREAS = COMMON DUMP/IPL WORKAREA                            * 11447000
*                 1ST IPL WORKAREA                                    * 11448000
*                 2ND IPL WORKAREA                                    * 11449000
*                 DECB                                                * 11450000
*                 LOCAL DATA AREA                                     * 11451000
*                                                                     * 11452000
*    CONTROL BLOCKS = AVT                                             * 11453000
*                     DCB                                             * 11453200
*                     OPCAVT                                          * 11454000
*                     OPCE                                            * 11455000
*                                                                     * 11456000
* TABLES = NONE                                                       * 11457000
*                                                                     * 11458000
* MACROS = READ CHECK XCTL                                            * 11459000
*                                                                     * 11460000
*  CHANGE ACTIVITY                                                    * 11461027
*A000000-999999                                                @X26X5R0 11461212
*C244000,267000                                                @OY12420 11462212
*A467000                                                       @OY12420 11462312
*C388000                                                       @ZA01100 11462412
*C120000,A120000,A129000,D144000,D174000,D182000,D190000,      @Y17XARS 11462512
*D266000,C310000,D402000-403000,C404000,C442000,A748000,       @Y17XARS 11462612
*D749000-757000,A380000,A765000                                @Y17XARS 11462712
*A287000,288000,338000,340000,350000,439000                    @OZ31840 11462812
*C341000,342000                                                @OZ31840 11462912
*A114620                                                       @OZ35627 11463027
*C114612,313000                                                @OZ35627 11463127
* $01=OZ41261 ETC2202 79.11.07 098061:                             @01A 11463227
* $21=OZ50665 ETC2402 81.04.14 162624:                             @21A 11463527
*************************END OF SPECIFICATIONS************************* 11463912
         EJECT                                                          11464000
         SPACE  3                                                       11500022
         SPACE  3                                                       11600022
         USING IEDQOPCD,R2              ADDRESSABILITY FOR OPCAVT       11700022
         USING IEDQOPCE,R4              ADDRESSABILITY FOR OPCE         11800022
         USING DATADS,RB                ADDRESSABILITY FOR C-WKAREA     11900022
         USING IEDCOM,R7                ADDRESSABILITY FOR     @Y17XARS 12000000
*                                       COMMON WORKAREA        @Y17XARS 12050000
         BALR  RC,0                     ESTABLISH                       12100022
         USING *,RC                     ADDRESSABILITY                  12200022
IGCME10D IEDHJN SKIPID                                                  12300000
         LR    R2,R1                    BASE FOR OPCAVT                 12700022
         L     R4,OPCCOPCE              GET ELEMJ. OPCE OR L-WKAREA     12800022
         L     R7,OCMODNME              SET BASE FOR COMMON AREA        12900022
         DROP  R4                                              @Y17XARS 12950000
         LA    R4,COMCCWS               SET BASE FOR LWKAREA            13000022
         LA    RB,DATAOFF(R4)           ADDR OF C-WKAREA                13100022
         USING LDATA,R3                 ADDRESSABILITY FOR LOCAL DATA   13200022
         LA    R3,EIGHTY4(R4)           SET BASE FOR LOCAL DATA AREA    13300022
         USING CESDD,RD                 ADDRESSABILITY FOR CESD TABLE   13400022
         LA    RD,CESDOFF(R4)           BASE FOR CESD                   13500022
         BCT   R0,TRYOUT                CONTROL FROM 1ST LOAD ?         13600022
         B     LOADRN                   YES                             13700022
TRYOUT   EQU   *                                                        13800022
         BCT   R0,TRYCESD               CONTROL FROM CESD CODE IN OUT   13900022
*                                       PUT MODULE                      14000022
         B     INPUT190                 CONTROL IS FROM OUTPUT RTN      14100022
TRYCESD  EQU   *                                                        14200022
         BCTR  R0,ZERO                  SUBTRACT ONE                    14300022
*                                       EITHER RETURN FROM CESD OR      14400000
*                                       RLD PROCESSING IN OUTPUT MOD.   14500022
         L     R6,INBUFF(R4)            PICK UP ADDR OF BUFFER          14600022
         LTR   R0,R0                    IF 0 CSD PROCESSING             14700022
         BZ    INPUT02                  CESD PROCESSING WAS DONE        14800022
         B     INPUT18A                 CONTINUE RLD CHECKING           14900022
LOADRN   EQU   *                                                        15000022
         MVI   INPUTSW,ZERO             INITIALIZE INPUT SWITCHES       15100022
         OI    ZERO(R4),RELOC           INDICATE TO TRY RELOCATE        15200022
         OI    ZERO(R4),CXTENDBT        IF 'CXTEND' PRESENT             15300022
         OI    ZERO(R4),NOOP            ASSUME NO BRING-UP              15400022
         XC    TOTLNGTW(EIGHT),TOTLNGTW  ZERO DATA PTRS.                15500022
         L     R1,FIRSTBLK              GET CESD TABLE QUEUE            15600022
         SPACE  3                                                       15700022
         SPACE  3                                                       16600022
****************  TEST FOR BRING-UP CONDITION ******************    BUP 16700022
INPUT02  EQU   *                                                        16800022
         L     R5,TWENFOUR(,R4)         GET ADDR OF DCB OPENED    @01C  16900025
         TM    ZERO(R4),BRNGUP          BRING-UP SPECIFIED ?            17000022
         BNO   INPUT04A                 NO                              17100022
         NI    ZERO(R4),SQUELCH         NO RELOCATE PROCESSING          17200022
         NI    ZERO(R4),DOBRUP          DO BRING-UP PROCESSING          17300022
INPUT04A EQU   *                                                        17500022
         USING DECBIN1,R9               ADDRESSABILITY FOR DECB         17600022
         LA    R9,DECBOFF(R4)           PUT DECB ADDR IN REG9           17700022
         L     R8,INBUFF(R4)            GET ADDR INPUT BUFFER L-WKAREA  17800022
         ST    R8,DECBIN1+TWELVE        INSERT IT IN THE DECB           17900022
         ST    R5,DECBIN1+EIGHT         STORE DCB ADDRESS          @01C 18000025
         SPACE                                                          18100022
READ     EQU   *                                                        18300022
         LA    R8,DECBOFF(R4)           PUT DECB ADR IN REG 8  @YM04661 18400000
         SPACE                                                          18500022
***************  READ RECORDS FROM LOAD MODULE  ****************        18600022
         LA    RD,REGSAVE(R4)           REG SAVEAREA IN L-WK            18700022
         SPACE 5                                                        18800022
         DROP  R7                                              @YM04692 18810000
         USING IEDQOPCE,R6                                     @YM04692 18820000
         L     R6,OPCCOPCE              OPCE ADDRESSABILITY    @YM04692 18830000
         L     R6,OCMODNME              WA ADDRESSABILITY      @YM04692 18840000
         DROP  R6                                              @YM04692 18850000
         USING IEDCOM,R6                                       @YM04692 18860000
         L     R5,DCBAD                 GET DCB ADDRESS            @01C 18870025
         MVC   THREE(ONE,R5),RALTTRK+THREE  RESTORE CORRECT        @21A 18871227
*                                       CONCATENATION NUMBER SO    @21A 18872427
*                                       POINT WILL ADDRESS         @21A 18873627
*                                       CORRECT DATASET. THIS      @21A 18874827
*                                       IS ONLY A PROBLEM WHEN     @21A 18876027
*                                       CONCATENATED DATASETS      @21A 18877227
*                                       ARE USED.                  @21A 18878427
         LA    R6,COMTTRZ               TTRZ SAVE AREA ADDR    @YM04692 18880000
         POINT (R5),(R6)                SET READ-WRITE HEAD        @01C 18890025
         READ  (R8),SF,MF=E                                             18900022
         SPACE 5                                                        19100022
         CHECK (R8)                                                     19200022
         NOTE  (R5)                     GET TTR                    @01C 19210025
         AL    R1,FULONE                UPDATE TO NEXT RCD     @YM04692 19220000
         ST    R1,ZERO(R6)              SAVE FOR NEXT RECORD   @YM07698 19230000
         DROP  R6                                              @YM04692 19240000
         USING IEDCOM,R7                                       @YM04692 19250000
****************************************************************        19300022
         SPACE                                                          19400022
** A LOAD MODULE RECORD IS IN THE BUFFER POINTED TO BY REG 8. **        19500022
         USING CESDD,RD                 ADDRESSABILITY FOR CESD TABL    19600022
         LA    RD,CESDOFF(R4)           BASE FOR CESD                   19700022
         USING INPUTDS,R6                                               19800022
         L     R6,ARADDR(R8)       S    SET UP ADDRESSABILITY ON BUF    19900022
         TM    TXTSW,ONTXT              IS THIS A TEXT RECORD ?         20000022
         BO    INPUT29                  YES SEND BUF TO OUTPUT          20100022
         SPACE                                                          20200022
*        BYPASSX ARE BRANCHES TO BYPASS SPECIAL LOAD           *        20300022
*        MODULE PROCESSING THAT IS REQUIRED ONLY FOR           *        20400022
*        NCP'S REQUIRING THE STORAGE PROTECT SUPPORT           *        20500022
*        OF THE 3705 HARDWARE.  WHEN PROCESSING THE            *        20600022
*        TARGETTED LOAD THESE BRANCHES ARE NOP'D               *        20700022
*        CAUSING ALL CODE FOLLOWING THE ENTRY 'CXTEND'         *        20800022
*        TO BE MOVED TO THE NEXT 2K BOUNDARY AND THE           *        20900022
*        ENTIRE LOAD IS RELOCATED AS NECESSRY.                 *        21000022
         SPACE                                                          21100022
BYPASS1  EQU   *                        BYPASS CESD AND RLD HANDLING    21200022
         TM    ZERO(R4),RELOC           RELOCATE CANCELLED?             21300022
         BNO   INPUT18A                 YES                             21400022
         SPACE                                                          21500022
         TM    LMTYPE,CESD              IS THIS A CESD RECORD ?         21600022
         BO    CESD00                   YES - GO PROCESS IT             21700022
         TM    INPUTSW,RELON            RELOCATE IN PROGRESS ?          21800022
         BO    INPUT17                  YES - CHECK RLD'S               21900022
         NI    ZERO(R4),NORELOC         TURN OFF RELOCATE FLAG          22000022
         B     INPUT18A                 CONTINUE                        22100022
INPUT17  EQU   *                                                        22200022
         TM    LMTYPE,RLD               IS THIS AN RLD RECORD ?         22300022
         BNO   INPUT18A                 BRANCH                   S22024 22400000
         ST    R6,REGSAVE(R4)           SAVE ADDR OF BUFFER FOR WHEN    22500022
*                                       REENTERED AFTER RLD PROCESS.    22600022
         B     RLD00                    GO PATCH ADCONS                 22700022
         SPACE                                                          22800022
INPUT18A EQU   *                                                        22900022
         TM    LMTYPE,CONTROL           DOES TEXT FOLLOW THIS RECORD ?  23000022
         BNO   INPUT20                  NO- CHECK FOR THE END           23100022
         OI    TXTSW,ONTXT              INDICATE TEXT IS TO FOLLOW      23200022
         CLC   COUNT(TWO),INBUFSZ       IS THE BUFFER TOO LARGE ?       23300022
         BNH   INPUT18                  NO - CONTINUE                   23400022
         LA    R0,MSG167                SET ERROR MSG NUMBER            23500022
         B     ERROR                    BRANCH TO ERROR CODE            23600022
INPUT18  EQU   *                                                        23700022
         TM    INPUTSW,FIRST            THIS FIRST TEXT ?               23800022
         BO    BYPASS2                  NO - CONTINUE                   23900022
         OI    INPUTSW,FIRST            INDICATE THE FIRST              24000022
         B     INPUT191                 SKIP SENDING                    24100022
         SPACE                                                          24200022
BYPASS2  EQU   *                                                        24300022
         TM    ZERO(R4),CARRYCDE        ENDREC PROCESSING      @OY12420 24400000
*                                       TO BE BYPASSED         @OY12420 24450000
         BNO   INPUT18B                 YES; BYPASS ENDREC PROCESSING   24500022
         SPACE                                                          24600022
         L     RE,TXTADDRW              CALCULATE ENDING ADDRESS        24700022
         AH    RE,TXTLNGTH              OF PREVIOUS TEXT                24800022
         L     R5,INADDR-ONE            MATCH BEGINNING OF THIS         24900022
         LA    R5,ZERO(R5)              TEXT. RECORD OR IS              25000022
         CR    RE,R5                    THERE A GAP                     25100022
         BNE   NOCARRY                  NO-- NO CARRY OVER              25200022
         OI    INPUTSW,CARRY            INDICATE THE CARRY              25300022
         LH    R5,TXTLNGTH              DECREMENT COUNT OF              25400022
         SH    R5,N4H                   OUTGOING TEXT BY                25500022
         STH   R5,TXTLNGTH              FOUR FOR CARRY                  25600022
         B     INPUT18B                 GO SEND IT                      25700022
         SPACE                                                          25800022
NOCARRY  NI    INPUTSW,ONES-CARRY       TURN OFF CARRY                  25900022
INPUT18B EQU   *                                                        26000022
         SPACE                                                          26100022
BYPASS3  EQU   *                                                        26200022
         TM    ZERO(R4),NOOP            BRING-UP SPECIFIED              26300022
         BNO   BRINGUP                  YES- GOTO BRING-UP DISGUARD     26400022
         SPACE                                                          26500022
         TM    ZERO(R4),STRETCH         STRETCH PROCESSING     @OY12420 26700000
         BNO   SEND                     NO                              26800022
*                                       FALL THRU DURING RELOCATE       26900022
         TM    INPUTSW,BYFOCUS          BEYOND FOCUS POINT              27000022
         BO    INPUT18G                 YES - GO ADJUST                 27100022
         L     R5,TXTADDRW              NO FOCUS IN THIS BUFFER         27200022
         AH    R5,TXTLNGTH              GET ENDING ADDR OF BUFFER       27300022
         C     R5,FOCUSPT               TO THE FOCUS YES ?              27400022
         BL    SEND                     NO SEND IT                      27500022
         OI    INPUTSW,BYFOCUS          INDICATE BEYOND FOCUS           27600022
         C     R5,FOCUSPT               RE-ESTABLISH COND. CODE         27700022
         BE    SEND                     YES - NO EXCESS                 27800022
         L     R5,FOCUSPT               SEND REMAINING NON-SHIFT        27900022
         S     R5,TXTADDRW              DATA                            28000022
         MVC   SAVEIT(TWO),TXTLNGTH     SAVE OLD LENGTH                 28100022
         STH   R5,TXTLNGTH                                              28200022
         OI    EIGHT(R4),SECOND         TURN BIT ONE                    28300022
         B     SENDIT                   PREPARE TO EXIT                 28400022
         SPACE 3                                                        28500022
ADJUST   EQU   *                                                        28600022
         NI    EIGHT(R4),OFF            TURN BIT OFF                    28700022
         L     R7,WKBUFSAV(R4)          RELOAD START OF WKBUF  @OZ31840 28750086
         AR    R7,R5                    ADJUST BUFFER POINTER           28800022
         ST    R7,WKBUFSAV(R4)          SAVE START OF WKBUF    @OZ31840 28850086
         MVC   TXTADDR(THREE),FOCUSPT+ONE SET NEW TXTADDRW              28900022
         SH    R5,SAVEIT                COMPUTE NEW LENGTH              29000022
         LCR   R5,R5                                                    29100022
         STH   R5,TXTLNGTH              SAVE NEW LENGTH AND             29200022
INPUT18G EQU   *                                                        29300022
         L     R5,TXTADDRW              BUMP TXT ADDRESS                29400022
         AH    R5,GAPSIZE               BY GAP SIZE                     29500022
         ST    R5,TXTADDRW                                              29600022
         SPACE  3                                                       29700022
*    IGCME10D HAS SET UP A BUFFER'S WORTH OF TEXT IN THE WORK BUFFER  * 29800000
*    WHOSE ADDR IS IN THE L-WKAREA. REG 7 HAS ADDR OF A BLOCK OF TEXT * 29900022
*    OPCCOPCE CONTAINGS AN OPCE OR A L-WKAREA ADDRESS. INPUT BUFFER   * 30000022
*    AND WORK BUFFER ARE IN L-WKAREA; DATA IS IN WORK BUFFER.         * 30100022
         SPACE  3                                                       30200022
SEND     EQU   *                                                        30300022
         OI    EIGHT(R4),FIRSTONE       FIRST ENTRY                     30400022
SENDIT   EQU   *                                                        30500022
         LA    R0,ONE                   INDICATES CONTROL CAME FROM IN  30600022
*                                       INPUT RTN                       30700022
         STM   R3,RB,MESAVE(R4)         SAVE REGISTERS                  30800022
OUT      EQU   *                                                        30900022
         MVC   OPCMODID,XCTLOUT         XCTL TO IFLOUPUT RTN   @Y17XARS 31000000
EXIT     EQU   *                                                        31100022
         LR    R1,R2                    SET PARAMETER REG               31200022
         IEDXCTL                                               @OZ35627 31300012
         SPACE                                                          31400022
INPUT190 EQU   *                                                        31500022
         LM    R3,RB,MESAVE(R4)         RESTORE REGISTERS               31600022
         SPACE 3                                                        31700022
         TM    EIGHT(R4),SECOND           RE-ENTERED FROM ADJUST        31800022
         BO    ADJUST                   YES                             31900022
         NI    EIGHT(R4),OFF            TURN BIT OFF                    32000022
*    SUBSEQUENT ENTRY FROM IGCMG10D. SET UP AS THOUGH IT WERE AN      * 32100000
*    INITIAL ENTRY.                                                   * 32200022
*    CHECK TO SEE IF THERE IS A CARRY OVER. IF YES SET UP WORKBUFFER  * 32300022
*    WITH VALUE PASSED FROM IGCMG10D. REG 6 THE INPUT BUFFER PTR; CON * 32400000
*    TAINS BUFFER OF DATA JUST SENT. IF THERE IS NO CARRY OVER SET    * 32500022
*    UP INPUT BUFFER REG AND WORK BUFFER REG                          * 32600022
         SPACE 3                                                        32700022
INPUT191 EQU   *                                                        32800022
         USING DECBIN1,R9               ESTABLISH ADDRESSABILITY FOR    32900022
*                                       DECB USED IN READ AND CHECK   * 33000022
         LA    R9,DECBOFF(R4)           ADDR OF DECB IN L-WKAREA        33100022
         LA    R8,DECBIN1               DECB                            33200022
         USING BUFFERWK,RA              ADDRESSABILITY FOR WORK BUFF    33300022
         L     RA,WORKBUF(R4)           BASE FOR WORK BUFFER            33400022
         USING INPUTDS,R6               ADDRESS FOR BUFFER              33500022
         L     R6,TWELVE(R8)            BASE FOR INPUT BUFFER           33600022
         TM    INPUTSW,CARRY            CARR OVER VALUE                 33700022
         BO    CARRYMV                  YES                             33800022
         LA    R7,BUFFER                SET WKBUF @ - NOCARRY  @OZ31840 33830086
         ST    R7,WKBUFSAV(R4)          SAVE WKBUF @ - NOCARRY @OZ31840 33860086
         B     INPUT19                  BRANCH                   S22024 33900000
CARRYMV  EQU   *                        ADJUST POINTERS ETC...          34000022
         L     R7,WKBUFSAV(R4)          RELOAD START OF WKBUF  @OZ31840 34100086
         AH    R7,TXTLNGTH              POSITION PAST TXTLNGTH @OZ31840 34150086
         MVC   BUFFER-FOUR(FOUR),ZERO(R7)   CARRY 4 BYTES OVER @OZ31840 34200086
         LH    R5,COUNT                 ADJUST COUNT                    34300022
         AH    R5,N4H                   BY ADDING 4 FOR                 34400022
         STH   R5,TXTLNGTH              THE CARRY                       34500022
         L     R5,INADDR-ONE            BACK UP TXTADDR                 34600022
         LA    R5,ZERO(R5)              FIELD BY FOUR FOR               34700022
         SH    R5,N4H                   THE CARRY BYTES                 34800022
         ST    R5,TXTADDRW                                  R           34900022
         LA    R7,BUFFER-FOUR           SET TEXT POINTER                35000022
         ST    R7,WKBUFSAV(R4)          SAVE WKBUF @ - CARRY   @OZ31840 35050086
         B     INPUT19A                 CONTINUE                        35100022
         SPACE                                                          35200022
INPUT19  EQU   *                        NO CARRY THIS TIME              35300022
         MVC   TXTLNGTH(TWO),COUNT      SAVE CONUT FOR OUTPUT           35400022
         MVC   TXTADDR(THREE),INADDR    SAVE REL ADDR FOR OUTPUT        35500022
INPUT19A EQU   *                                                        35600022
         TM    LMTYPE,ENDOF             IS THIS THE LAST TEXT COMING ?  35700022
         BNO   READ                     NO-- CONTINUE READING           35800022
         OI    LASTSW,ONLAST            YES - INDICATE LAST TEXT        35900022
         B     READ                     READ ANOTHER RECORD             36000022
         SPACE                                                          36100022
INPUT20  EQU   *                        THIS IS NOT A CONTROL RECORD    36200022
         TM    LMTYPE,ENDOF             IS THIS THE FINAL RECORD ?      36300022
         BNO   READ                     NO GO GET NEXT RECORD           36400022
         OI    LASTSW,ONLAST            YES SET LAST TEXT INDICATOR     36500022
         B     BYPASS3                  PREPARE TO SEND                 36600022
***      CONTINUE                       PASS NULL BUFFER TO OUTPUT      36700022
         SPACE                                                          36800022
*******  A TEXT RECORD IS IN THE BUFFER  ***********************        36900022
         SPACE                                                          37000022
INPUT29  EQU   *                        TEXT JUST RECEIVED              37100022
         USING BUFFERWK,RA              ADDRESSABILITY FOR WORK BUFFER  37200022
         L     RA,WORKBUF(R4)           SET UP BASE                     37300022
         MVC   BUFFER(TWO56),ZERO(R6)   MOVE IT TO                      37400022
         MVC   BUFFER+TWO56(TWO56),TWO56(R6) BUFFER                     37500022
         MVC   BUFFER+FIVE12(TWO56),FIVE12(R6)                          37600022
         MVC   BUFFER+SEVEN68(TWO56),SEVEN68(R6)                        37700022
         NI    SWITCH,ONES-ONTXT        TURN OFF TXT INDICATOR          37750022
         TM    SWITCH,ONLAST            THIS THE END ?                  37800022
         BO    INPUT18B                 YES GO SEND IT                  37900022
         B     READ                     NO - GO READ                    38000022
         SPACE                                                          38100022
BRINGUP  EQU   *                        BRING-UP DISGUARD RTN           38200022
         L     R5,TXTADDRW              GET TEXT ADDRESS                38300022
         C     R5,BUSTART               PASSED GARBAGE YES ?            38400022
         BNL   SEND                     YES CONTINUE                    38500022
         AH    R5,TXTLNGTH              GO TO END OF BUFFER             38600022
         C     R5,BUSTART               HIT SIGNIFICANT CODE ?          38700022
         BNH   INPUT19                  GO SET UP LENGTH       @ZA01100 38800056
         LA    RA,FOUR(RA)              SKIP OVER PREFIX WORD           38900022
         AH    RA,TXTLNGTH              YES ADJUST BUFFER POINTERS      39000022
         S     R5,BUSTART                 ACCORDINGLY.                  39100022
         SR    RA,R5                    POINTS AT BRUP START POINT      39200022
         MVC   TOTLNGTH,BUSTART+ONE     SET PROPER TOTAL                39300022
         MVC   TXTADDR,BUSTART+ONE      SET RELATIVE ADDRESS            39400022
         STH   R5,TXTLNGTH              SET NEW TEXT LENGTH             39500022
         OI    ZERO(R4),NOOP            NO BRING-UP                     39600022
         OI    ZERO(R4),LOADBRUP        INDICATE 1ST BRUP RECORD        39700022
         ST    RA,REGSAVE(R4)           SAVE ADDR OF BRUP START POINT   39800022
        B      SEND                     GO SEND IT                      39900022
         SPACE                                                          40000022
ERROR    EQU   *                                                        40100022
         MVC   OPCMODID,XCTLMI          INSERT ID OF IGCMI10D  @Y17XARS 40400000
         USING IEDQOPCE,R4              OPCE BASE              @Y17XARS 40410000
         L     R4,OPCCOPCE              OPCE ADDRESSABILITY    @Y17XARS 40420000
         USING IEDOCTR,R3               TRAILER BASE           @Y17XARS 40430000
         L     R3,OCTRUNIT              TRAILER ADDRESSABILITY @Y17XARS 40440000
         OI    OCTRRTN,OCTRERI          SET IPL ERROR FLAG     @Y17XARS 40450000
         MVI   OCSWITCH,OCIPLC          SET OCSWITCH=IPL CMD   @Y17XARS 40460000
         B     EXIT                     PREPARE TO EXIT                 40500022
         SPACE  5                                                       40600022
CESD00   EQU   *                        THE CESD PROCESSOR IS A PART    40700022
*                                       OF THE MODULE IGCMG10D. XCTL    40800022
*                                       TO IT. THE VALUE 2 IS IN REG0   40900022
         LA    R0,TWO                   UNIQUE VALUE TO IDENTIFY TO     41000022
*                                       IGCMG10D WHY IT IS BEING ENTER  41100022
         B     OUT                      PREPARE TO EXIT                 41200022
         SPACE  5                                                       41300022
RLD00    EQU   *                        THE RLD PROCESSOR IS A PART OF  41400022
*                                       THE MODULE IGCMG10D. XCTL TO IT 41500022
*                                       WITH THE VALUE 3 IN REG 0       41600022
         LA    R0,THREE                 UNIQUE VALUE TO IDENTIFY THAT   41700022
*                                       CONTROL CAME FROM INPUT AND     41800022
*                                       RLD PROCESSING IS NEEDED.       41900022
         B     OUT                      PREPARE TO EXIT                 42000022
         EJECT                                                          42100022
         SPACE                                                          42200022
***************  LOCAL DATA (I.E. INPUT'S USE ONLY)  ***********        42300022
         SPACE                                                          42400022
FULONE   DC    F'1'                     FULLWORD CONSTANT      @YM07643 42450000
BUSTART  DC    F'1792'                  BRING-UP START PT. IN L.M.      42500022
TWO56    EQU   256                      LENGTH IN MOVE INSTRUCTION      42600022
FIVE12   EQU   512                      LENGTH IN MOVE INSTRUCTION      42700022
SEVEN68  EQU   768                      OFFSET IN MOVE INSTRUCTION      42800022
LOADBRUP EQU   X'10'                    MASK TO INDICATE 1ST BRUP REC   42900022
BRNGUP   EQU   X'05'                    MASK TO CHECK FOR BRING-UP      43000022
NORELOC  EQU   X'BF'                    MASK TO TURN OFF RELOCATE       43100022
         SPACE 5                                                        43200022
         SPACE 5                                                        43300022
OFF      EQU   X'FC'                    MASK TO TURN OFF BITS           43400022
FIRSTONE EQU   X'02'                    FIRESTONE                S22024 43500000
MESAVE   EQU   128                      REG SAVE AREA IN L-WK           43600022
SECOND   EQU   X'03'                    SECOND                   S22024 43700000
INBUFF   EQU   32                       OFFSET TO ADDR INPUT BUFFER     43800022
WORKBUF  EQU   36                       OFFSET TO WORK BUFFER L-WKAREA  43900022
WKBUFSAV EQU   168                      OFFSET-WKBUF@ SAVEAREA @OZ31840 43950086
MSG167   EQU   167                      ERROR MSG NUMBER                44000022
CLNUPPRI EQU   X'88'                    CLEAN UP INDICATOR TO MH        44100022
AUTOIPL  EQU   X'DF'                    PRIORITY OF AUTO-IPL ELEMENT    44150022
XCTLMI   DC    C'MI'                    ID OF COMMON IPL-DUMP RTN       44200000
EIGHTY4  EQU   84                       EIGHTY4                  S22024 44300000
TWENFOUR EQU   24                       OFFSET IN L-WKAREA TO ADDR OF   44400022
*                                       DCB FOR L.M. OR BRING-UP        44500022
XCTLOUT  DC    C'MG'                    ID OF IFLOUPUT RTN              44600022
DATAOFF  EQU   184                      START OF C-WKAREA               44700022
SIXTY    EQU   60                       NEXT BLOCK ADDRESS              44800022
REGSAVE  EQU   96                       OFFSET TO SAVE AREA FOR BUFFER  44900022
         SPACE 2                                                        45100022
         SPACE 5                                                        45200022
         SPACE 5                                                        45300022
******************** CESD TABLE QUEUE AND ASSOCIATED VALUES ****        45400022
CESDD    DSECT                                                          45500022
****************************************************************        45600022
FIRSTBLK DS    AL4                      FIRST BLOCK PTR                 45700022
LASTBLK  DS    AL4                      LAST BLOCK PTR                  45800022
CURENTRY DS    AL4                      CURRENT ENTRY PTR               45900022
INUSE    EQU   X'01'                    THIS ENTRY IS IN USE            46000022
STOPPER  EQU   X'80'                    THIS IS THE END OF THE BLOCK    46100022
BLOCKADR DS    AL4                      ADDR OF BLOCK FROM GETMAIN      46200022
CESDOFF  EQU   40                       OFFSET IN L-WKAREA TO CESD 3ABL 46300022
DECBOFF  EQU   56                       OFFSET TO DECB IN L-WKAREA      46400022
CXTENDBT EQU   X'20'                    CXTEND PRESENT                  46500022
RELOC    EQU   X'40'                    INDIATES TO TRY RELOCATE        46600022
NOOP     EQU   X'80'                    INDICATES NO BRING-UP           46700022
CARRYCDE EQU   X'02'                    INDICATES CARRY PROCESS@OY12420 46730000
STRETCH  EQU   X'08'                    INDICATES STRETCH      @OY12420 46760000
SQUELCH  EQU   X'BF'                    NO RELOCATE BUT DO BRING-UP     46800022
DOBRUP   EQU   X'7F'                    INDICATE TO DO BRING-UP         46900022
         SPACE  3                                                       47000022
LDATA    DSECT                                                          47100022
INPUTSW  DS    X                        INPUT SWITCH             S22024 47200000
FIRST    EQU   X'80'               THIS IS THE FIRST TEXT.              47300022
CARRY    EQU   X'40'               A CARRY CONDITION EXISTS             47400022
BYFOCUS  EQU   X'20'               BEYOND FOCUS POINT.                  47500022
RELON    EQU   X'10'               RELOCATE IS REQUIRED.                47600022
RELGRP   EQU   X'04'               NO RELOCATE ON THIS GROUP.           47700022
FOUND     EQU   X'08'               CXTEND HAS BEEN FOUND.              47800022
         SPACE                                                          47900022
NOP      EQU   X'00'               NOP FOR BYPASSX SWITCHES.            48000022
BRANCH   EQU   X'F0'               BRANCH FOR BYPASSX SWITCHES.         48100022
         SPACE                                                          48200022
         DS    AL3                      ******                          48300000
FOCUSPT  DS    AL4                      FOCUSPT                  S22024 48400000
GAPSIZE  DS    AL2                      GAPSIZE                  S22024 48500000
SAVEIT   DS    AL2                      SAVE IT                  S22024 48600000
         SPACE  3                                                       48700022
INPUTDS  DSECT                                                          48800022
LMTYPE   DC    AL1(0)              TYPE INDICATOR FOR LOAD              48900022
*                                  MODULE RECORD.                       49000022
CONTROL  EQU   X'01'               INDICATOR FOR A CONTROL RECORD       49100022
ENDOF    EQU   X'0C'               INDICATOR FOR END OF THE L.M.        49200022
CESD     EQU   X'20'               INDICATOR CESD RECORD.               49300022
RLD      EQU   X'02'               INDICATOR FOR RLD RECORD.            49400022
         ORG   *+8                 N/A                                  49500022
INADDR   DC    AL3(0)              RELATIVE ADDR OF FOLLOWING           49600022
*                                  TEXT RECORD.                         49700022
         ORG   *+2                 N/A                                  49800022
COUNT    DC    AL2(0)              NUMBER OF BYTES IN THE               49900022
*                                  FOLLOWING TEXT RECORD.               50000022
         SPACE                                                          50100022
BUFFERWK DSECT                                                          50200022
PREFIX   DS    AL4                      PREFIX                   S22024 50300000
BUFFER   DS    256F                     BUFFER                   S22024 50400000
         SPACE  3                                                       50500022
INBUF1   DSECT                                                          50600022
         DS    257F                     INBUF1                   S22024 50700000
         SPACE  3                                                       50800022
OUTBUF1  DSECT                                                          50900022
         DS    256H                     OUTBUF1                  S22024 51000000
         SPACE  3                                                       51100022
DECBIN1  DSECT                                                          51200022
         DS    F                        DCBIN1                   S22024 51300000
         DS    X                        DCBIN1                   S22024 51400000
         DS    X                        DCBIN1                   S22024 51500000
         DS    AL2                      DCBIN1                   S22024 51600000
DCBAD    DS    AL4                      DCBIN1                 @YM04692 51700000
         DS    AL4                      DCBIN1                   S22024 51800000
         DS    AL4                      DCBIN1                   S22024 51900000
         EJECT                                                          52000022
DATADS   DSECT                                                          52100022
****************************************************************        52200022
***        REGISTER,RETURNCODE AND NUMBER EQUATES                       52300022
R0       EQU   0                                                        52400022
R1       EQU   1                                                        52500022
R2       EQU   2                                                        52600022
R3       EQU   3                                                        52700022
R4       EQU   4                                                        52800022
R5       EQU   5                                                        52900022
R6       EQU   6                                                        53000022
R7       EQU   7                                                        53100022
R8       EQU   8                                                        53200022
R9       EQU   9                                                        53300022
RA       EQU   10                                                       53400022
RB       EQU   11                                                       53500022
RC       EQU   12                                                       53600022
RD       EQU   13                                                       53700022
RE       EQU   14                                                       53800022
RF       EQU   15                                                       53900022
         SPACE                                                          54000022
RC00     EQU   0                                                        54100022
RC04     EQU   4                                                        54200022
RC08     EQU   8                                                        54300022
RC12     EQU   12                                                       54400022
RC16     EQU   16                                                       54500022
RC20     EQU   20                                                       54600022
RC24     EQU   24                                                       54700022
RC28     EQU   28                                                       54800022
RC32     EQU   32                                                       54900022
RC36     EQU   36                                                       55000022
RC40     EQU   40                                                       55100022
RC44     EQU   44                                                   BUP 55200022
RC48     EQU   48                                                       55300022
RC52     EQU   52                                                       55400022
RC56     EQU   56                                                       55500022
         SPACE                                                          55600022
ZERO     EQU   0                                                        55700022
ONE      EQU   1                                                        55800022
TWO      EQU   2                                                        55900022
THREE    EQU   3                                                        56000022
FOUR     EQU   4                                                        56100022
FIVE     EQU   5                                                        56200022
SIX      EQU   6                                                        56300022
SEVEN    EQU   7                                                        56400022
EIGHT    EQU   8                                                        56500022
NINE     EQU   9                                                        56600022
TEN      EQU   10                                                       56700022
ELEVEN   EQU   11                                                       56800022
TWELVE   EQU   12                                                       56900022
         SPACE 2                                                        57000022
****************************************************************        57100022
**    MISCELLANEOUS  EQUATES  AND CONSTANTS                   **        57200022
         SPACE                                                          57300022
BIT10    EQU   X'10'          TEST FOR OPEN IN DCB                      57400022
IFLGSD   EQU   49             DCB IFLGS DISPLACEMENT                    57500022
NOERRTN  EQU   X'0C'          INDICATE NO SYS ERROR RTNS.               57600022
UCBCA    EQU   19             UCB DISP OF CA INDICATOR.                 57700022
MINICA   EQU   X'15'          MINI CA INDICATOR IN UCB.                 57800022
         SPACE                                                          57900022
ABORTVAL EQU   12             ABORT RET CODE THRESHOLD.                 58000022
RETCODE  DC    H'0'                RETURN CODE.                         58100022
MAXRC    DC    H'0'          MAXIMUM RETURN CODE SET.                   58200022
RNDDN    DC    C'        '    RN DDNAME                                 58300022
RNADR    DC    C'   '              UNIT ADDRESS AREA.                   58400022
ENTRYPT  DC    F'0'           ENTRY POINT FOR LOAD.                     58500022
ARADDR   EQU   12             DECB AREA ADDR. DISP.                     58600022
RNSWITCH EQU   X'14'         DISP OF SWITCH IN DIAG PHASE 1.            58700022
SIXTBIT  EQU   X'01'         SIXTEEN BIT INDICATOR.                     58800022
ALIASIND EQU   X'80'          THIS IS AN ALIAS-INDICATOR.  BLDL         58900022
RENREUS  EQU   X'C0'          REENTRANT & REUSABLE         BLDL         59000022
ABORT    EQU   X'03'          ABORT SENSE INDICATORS.                   59100022
         DS    0H                                                       59200022
TXTLNGTH DC    H'0'           LENGTH OF TEXT RECORD                     59300022
         DS    0F                                                       59400022
TOTLNGTW DC    AL1(0)         TOTAL LENGTH OF DATA                      59500022
TOTLNGTH DC    AL3(0)         TRANSFERRED                               59600022
         DS    0F                                                       59700022
TXTADDRW DC    AL1(0)         ADDRESS (REL TO ZERO) OF                  59800022
TXTADDR  DC    AL3(0)         THIS TEXT RECORD.                         59900022
         SPACE                                                          60000022
N256HW   DC    H'256'         MAXIMUM MVC COUNT                         60100022
INBUFSZ  DC    H'1024'        SIZE OF INPUT BUFFER                      60200022
OUTBFSZ  DC    H'512'         SIZE OF OUTPUT BUFFER.                    60300022
DOUBLE   DC    D'0'           DOUBLE WORD WORK AREA                     60400022
LINECNT  DC    H'0'           LINE COUNT FOR OUTPUT                     60500022
MAXLIN   DC    H'52'          MAXIMUM LINES PER PAGE.                   60600022
N4H      DC    H'4'           FOUR CONSTANT                             60700022
         SPACE                                                          60800022
**   BLDL  LIST  FOR  LOAD  MODULE  DATA  SET                 **        60900022
         DS    0H                                                       61000022
BLDLIST  DC    H'1'           ONE ENTRY IN THIS LIST.                   61100022
         DC    H'58'          EACH ENTRY IS 58 BYTES LONG               61200022
MEMBER   EQU   *              MEMBER NAME PLACE HERE.                   61300022
         DS    CL8                      EIGHT BYTS               S22024 61400000
RALTTRK  DC    4X'00'              USED IN FIND                         61500022
*                                                                       61600022
Z        DC    X'00'          FLAG BYTE                                 61700022
C        DC    X'00'          FLAG BYTE                                 61800022
         ORG   MEMBER+22                                                61900022
ATTRIB   EQU   *              ATTRIBUTE FIELD                           62000022
         ORG   MEMBER+29                                                62100022
EPAMEM   EQU   *              ENTRY PT IF MEMBER DIR.ENTRY.             62200022
         ORG   MEMBER+43                                                62300022
EPAALS   EQU   *              ENTRY PT IF ALIAS DIR.ENTRY.              62400022
         ORG   MEMBER+58                                                62500022
         SPACE                                                          62600022
MAXIVT   EQU   *                                                        62700022
         DC    V(CXWMAXI1)         ADDRESS OF MAXI PHASE 1              62800022
         DC    V(CXWMAXI2)         ADDRESS OF MAXI PHASE 2..            62900022
         SPACE                                                          63000022
MINIVT   EQU   *                                                        63100022
         DC    V(CXWMINI1)         ADDRESS OF MINI PHASE 1              63200022
         DC    V(CXWMINI2)         ADDRESS OF MINI PHASE 2..            63300022
         SPACE                                                          63400022
PHASPTR  DC    A(MAXIVT)           PHASE VECTOR TABLE PTR..             63500022
PHASCNT  DC    H'8'                NUMBER OF PHASES TIMES FOUR..        63600022
MAXIPH1  DC    V(CXWMAXI1)         ADDRESS OF MAXI PHASE 1.             63700022
MINIPH1  DC    V(CXWMINI1)         ADDRESS OF MINI PHASE 1.             63800022
MAXIBUPH DC    CL8'IFL3705B'       NAME OF DIAG MAXI PHASE 1.           63900022
MINIBUPH DC    CL8'IFL3705A'       NAME OF DIAG MINI PHASE 1.           64000022
         SPACE                                                          64100022
*                               *                              *        64200022
****************************************************************        64300022
***      SWITCHES AND TEST EQUATES                            **        64400022
         SPACE                                                          64500022
SWITCH   EQU   *         * SWITCH BYTE *                                64600022
         SPACE                                                          64700022
SW1      EQU   *          INDICATES ONE PARM PROCESSED                  64800022
ON1      EQU   X'80'          TURN ON SW1                               64900022
OFF1     EQU   X'7F'          TURN OFF SW1                              65000022
         SPACE                                                          65100022
TXTSW    EQU   *            INDICATES TEXT RECORD IN NEXT BUFFER        65200022
ONTXT    EQU   X'40'          TURN ON TXTSW                             65300022
OFFTXT   EQU   X'BF'          TURN OFF TXTSW                            65400022
         SPACE                                                          65500022
LASTSW   EQU   *            INDICATES LAST TEXT RECORD                  65600022
ONLAST   EQU   X'20'          TURN ON LASTSW                            65700022
         SPACE                                                          65800022
ENDIN    EQU   *            INDICATES INPUT BUFFER IS EMPTY.            65900022
ONEND    EQU   X'10'          TURN ON ENDIN.                            66000022
OFFEND   EQU   X'EF'          TURN OFF ENDIN.                           66100022
         SPACE                                                          66200022
IPLSW    EQU   *            INDICATES BOOTSTRAP IS TO BE SENT           66300022
ONIPL    EQU   X'08'          TURN ON IPLSW.                            66400022
OFFIPL   EQU   X'F7'          TURN OFF IPLSW.                           66500022
         SPACE                                                          66600022
IOPEND   EQU   *            INDICATES AN EXCP IS OUTSTANDING.           66700022
ONIO     EQU   X'04'          TURN ON IOPEND                            66800022
OFFIO    EQU   X'FB'          TURN OFF IOPEND                           66900022
         SPACE                                                          67000022
ERRENT   EQU   *            INDICATES ERROR RTN HAS BEEN ENTERED        67100022
ONENT    EQU   X'02'          TURN ON ERRENT.                           67200022
         SPACE                                                          67300022
BUFFERSW EQU   *                 INDICATES PRIMING OF BUFFERS..         67400022
BUFSW    EQU   X'01'                    BUFF SWITCH              S22024 67500000
         SPACE                                                          67600022
ONES     EQU   X'FF'          USED IN SWITCH MANIPULATIONS.             67700022
         SPACE                                                          67800022
         DC    AL1(0)      * ACTUAL SWITCH BYTE *                       67900022
         SPACE 2                                                        68000022
SWITCH2  EQU   *                                                        68100022
CASW     EQU   *                                                        68200022
         SPACE                                                          68300022
LOADFLG  EQU   X'80'          LOADMOD KEYWORD PROCESSED.                68400022
UNITFLG  EQU   X'40'          UNIT    KEYWORD PROCESSED.                68500022
DIAGFLG  EQU   X'20'          DIAG    KEYWORD PROCESSED.            BUP 68600022
DIAGOK   EQU   X'10'          BRING-UP COMPLETED INDICATOR.         BUP 68700022
ONCA     EQU   X'01'               ON INDICATING MINI CA.               68800022
COMPLETE EQU   X'02'          LAST WRITE JUST ISSUED.                   68900022
NXTPHS   EQU   X'04'          NEXT PHASE REQUEST.                       69000022
         SPACE                                                          69100022
         DC    AL1(0)          * ACTUAL SWITCH2 BYTE *                  69200022
         SPACE                                                          69300022
DIAGIND  DC    C'Y6'              INITIAL-TEST INDICATOR.               69400022
DIAGDEF  DC    C'Y6'               DEFAULT DIAG VALUE.                  69500022
CHARN    EQU   C'N'           NO BRING-UP INDICATOR.                BUP 69600022
         SPACE 2                                                        69700022
WARN     DC    AL1(0)        BYTE USED FOR WARNING INDICATORS           69800022
RNFULL   EQU   X'80'            RN IS FULL WARNING                      69900022
         SPACE                                                          70000022
GOODCODE EQU   X'7F'          NORMAL ECB COMPLETION CODE.               70100022
PERMERR  EQU   X'41'          PERMANENT ERROR ECB CODE.                 70200022
         SPACE 2                                                        70300022
*****************  CCW'S AND RELATED EQUATES  ******************        70400022
RNCCW    DS    0D             CHANNEL COMMAND WORDS                     70500022
         DC    AL1(0)           COMMAND CODE                            70600022
RNCCWAD  DC    AL3(0)           DATA ADDRESS                            70700022
         DC    X'60'            FLAGS                                   70800022
         DC    AL1(0)             --                                    70900022
RNCCWLN  DC    AL2(1025)        COUNT FOR WRITE                         71000022
         SPACE                                                          71100022
NOPCCW   DS    0D             NOP CHANNEL COMMAND IS                    71200022
         DC    AL1(3)           CHAINED TO THE NORMAL                   71300022
         DC    AL3(*)           COMMANDS TO ENSURE                      71400022
         DC    X'20'            DEVICE END IS RETURNED                  71500022
         DC    AL3(1)           BEFORE ECB POSTED.                      71600022
         SPACE                                                          71700022
****************************************************************        72000022
         SPACE                                                          72100022
**********  CONTROL BLOCKS FOR ASSOCIATED DATA SETS  ***********        72200022
         SPACE                                                          72300022
ECBRN    DC    F'0'       **  ECB FOR EXCP'S TO 27RN.                   72400022
         SPACE                                                          72500022
IOBRN    DS    0F         **  IOB FOR EXCP'S TO 27RN.                   72600022
         DC    X'42'         -COMMAND CHAINING & NOT RELATED.           72700022
         DC    AL1(0)        -FLAGS                                     72800022
IOBSENSE DC    AL2(0)        -SENSE BYTES                               72900022
         DC    AL1(0)        -ECB CODE                                  73000022
         DC    AL3(ECBRN)    -ECB ADDRESS                               73100022
         DC    AL1(0)        -FLAGS                                     73200022
         DC    AL3(0)        -CSW COMMAND ADDRESS.                      73300022
IOBCSWS  DC    AL2(0)        -CSW STATUS BYTES                          73400022
IOBCSWC  DC    AL2(0)        -CSW BYTE COUNT.                           73500022
         DC    AL1(0)        -SIO CODE                                  73600022
         DC    AL3(RNCCW)    -CHANNEL PROGRAM ADDRESS.                  73700022
         DC    AL1(0)        -RESERVED                                  73800022
         DC    AL3(0)                   DCB ADDRESS                     73900022
         DC    AL1(0)        -REPOSITION MODIFIER                       74000022
         DC    AL3(0)        -RESTART ADDRESS.                          74100022
         DC    AL2(0)        -BLOCK COUNT INCREMENT N/A.                74200022
         DC    AL2(0)        -ERROR COUNTS.                             74300022
         DC    AL1(0)        -EXTENT 0 OF DEB.                          74400022
         DC    AL3(0)        -BBCCHHR                                   74500022
         DC    AL4(0)        -(SAME)                                    74600022
* END OF IOB DEFINITION  ***************************************        74700022
         EJECT                                                          74800022
         TCOMD                                                 @Y17XARS 74830000
         TCOMIPLD                                              @Y17XARS 74860000
         EJECT                                                          75800022
         TAVTD                                                          75900022
         EJECT                                                          76000022
         TOPCAVTD                                                       76100022
         EJECT                                                          76200022
         TOPCED                                                         76300022
         EJECT                                                          76400022
         DCBD  DSORG=TX                                                 76500022
         EJECT                                                          76530000
         TOCTRD                                                @Y17XARS 76560000
   END                                                                  76600022
