         TITLE ' IGCMF10D - 3705 IPL - OUTPUT LOAD MODULE'              00050022
IGCMF10D CSECT                                                          00100022
         SPACE                                                          00200022
         SPACE                                                          00300022
************************START OF SPECFICATIONS************************* 00400022
*                                                                     * 00420022
*-000000-999999                                                @X26X5R0 00422000
*C278600                                                       @YA10666 00425058
*A277200                                                       @YA10666 00430058
*D756600                                                       @YA10666 00435058
*A053000,C056000,A066000,D069000,C076000,                      @Y17XARS 00435400
*D077000-078000,A076000,D079000,A079000,C088000                @Y17XARS 00435800
*C095000,C097000,D100000-101000,C111000,C123000-125000         @Y17XARS 00436200
*C132000,C134000,C136000,D140000-168000,D177000-178000,        @Y17XARS 00436600
*C197000,C209000-210000,C222000,A223000,C232000-233000         @Y17XARS 00437000
*C243000,C249000,C259000-260000,C262000,D276500,               @Y17XARS 00437400
*277500,278200-278400,A278500,D278600-278640,A284000           @Y17XARS 00437800
*D285000-285700,D287000,D288000,A289000,A289200,               @Y17XARS 00438200
*D290000,D320200-320600,A400000,C355000,                       @Y17XARS 00438600
*A373000,D375500,A292000,D394000-397000,A744000,               @Y17XARS 00439000
*A746000,A758000                                               @Y17XARS 00439400
*C066700,C339000,A086200,A278500,A278700,A434000@Y17XARS                00439700
* MODULE NAME = IGCMF10D (TCAM,OPERATOR CONTROL)                      * 00440000
*                                                                     * 00460022
* DESCRIPTIVE NAME = 3705 IPL I/O MODULE                              * 00480022
*                                                                     * 00500022
* COPYRIGHT = NONE                                                    * 00520022
*                                                                     * 00540022
* STATUS = VERSION 10.0                                               * 00560000
*                                                                     * 00580000
* FUNCTION = THIS ROUTINE HANDLES ALL I/O TO THE 3705 VIA EXCP.       * 00800000
*    IT RECEIVES CONTROL FROM IGCMD10D OR IGCMG10D OR FROM IGC0010D   * 00900022
*    WHEN ENTERED IT SETS UP THE BASE FOR THE                         * 01100000
*    COMMON WORKAREA USED BY THE IPL LOADS AND CHECKS TO SEE IF AN    * 01200022
*    IPL IS REQUIRED. IT WILL BE REQUIRED ON THE 1ST ENTRY FROM       * 01300022
*    IGCMD10D. IF YES PHASE 1 IS SENT ACROSS TO THE 3705.             * 01400000
*    OTHERWISE THE CORE CONTAINING THE                                * 01900000
*    PHASE 1 ROUTINE IS USED AS THE OUTPUT BUFFER AND GETMAINS ARE    * 02000022
*    DONE FOR AN INPUT BUFFER AND A WORK BUFFER. NEXT A CHECK IS      * 02100022
*    MADE TO SEE IF INITIAL TEST WAS SELECTED. THIS OPTION IS         * 02200022
*    SPECIFIED ON THE 3705 TTE. INITIAL TEST IS A HARDWARE EXERCISOR  * 02300000
*    WHICH WILL CHECK OUT THE 3705. IT RESIDES ON LINKLIB, AND IS     * 02400022
*    NAMED IFL3705D. THE RECORDS ARE 1024 BYTES OR LESS.              * 02500022
*                                                                     * 02600022
*                                                                     * 02700022
*    IGCMF10D NOW XCTLS TO IGCME10D TO BEGIN READING INITIAL TEST     * 02800022
*    LOAD MODULE RECORDS AND THEY ARE SENT TO THE 3705. WHEN IGCME10D * 02900022
*    DETECTS THE LAST RECORD IT SETS LASTTX SWITCH IN THE WORKAREA.   * 03000022
*    IGCMF10D DETECTS THAT THIS SWITCH IS SET AND SENDS THE LAST TEXT * 03100022
*    RECORD. INITIAL TEST IS THEN GIVEN 22 SECONDS TO PROCESS.        * 03200022
*    IGCMF10D TPOSTS A SPECIAL TIME DELAY REQUEST ELEMENT TO THE TCAM * 03300022
*    TIME DELAY QCB. WHEN THE INTERVAL EXPIRES A WRITE BREAK IS SENT  * 03400022
*    TO THE 3705 AND IGCMF10D XCTLS BACK TO IGCMD10D TO DO A BLDL AND * 03500022
*    A 'FIND' FOR THE 3705 NCP LOAD MODULE SPECIFIED IN THE 3705 DCB. * 03600022
*    THE NEXT TIME IGCMF10D IS ENTERED IT IS FROM IGCMG10D AND        * 03700022
*    REGISTER 0 CONTAINS THE ADDRESS OF THE END OF THE OUTPUT BUFFER  * 03800022
*    THIS ADDRESS IS INSERTED INTO THE CCW IN THE LCB, THE LENGTH IS  * 03900000
*    SET TO X'200' AND AN EXCP IS ISSUED. BY XCTLING FROM IGCMF10D,   * 04000022
*    TO IGCME10D, TO IGCMG10D, AND BACK TO IGCMF10D, THE RECORDS ARE  * 04100022
*    SENT TO THE 3705 512 BYTES AT A TIME.                            * 04200022
*    AGAIN,AS WITH INITIAL TEST PROCESSING, IGCME10D WILL DETECT THE  * 04300022
*    LAST RECORD AND WILL SET LASTTX BIT. WHEN IGCMF10D FINDS IT SET  * 04400022
*    IT WILL SEND OVER THE ENTRY POINT, WHICH WAS OBTAINED DURING THE * 04500022
*    BLDL DONE BY IGCMD10D AND SAVED IN THE WORKAREA.                 * 04600022
*    AN XCTL WILL BE DONE TO IGCMI10D TO SCHEDULE                     * 04800000
*    WRITTING OF THE IPL COMPLETED MESSAGE AND WHO WILL DO CLEANUP    * 04830000
*    PROCESSING                                                       * 04860000
*                                                                     * 04901022
*                                                                     * 04902022
* NOTES = SEE BELOW                                                   * 04903022
*                                                                     * 04904022
*    DEPENDENCIES = EBCDIC CHARACTER CODE DEPENDENCIES - CORRECTABLE  * 04905022
*                   BY REASSEMBLY                                     * 04906022
*                                                                     * 04907022
*    RESTRICTIONS = NONE                                              * 04908022
*                                                                     * 04909022
*    REGISTER CONVENTIONS = REGISTER 1 OPCAVT                         * 04910022
*                           REGISTER 2 OPCAVT                         * 04911022
*                           REGISTER 3 OPCE                           * 04912022
*                           REGISTER 4 TCAM AVT                       * 04913022
*                           REGISTER 5 IPL COMMON AREA 1              * 04914022
*                           REGISTER 6 IPL COMMON AREA 6              * 04915022
*                           REGISTER 7 IPL/DUMP COMMON AREA           * 04916022
*                           REGISTER 11 TCAM DISPATCHER               * 04917022
*                           REGISTER 13 OPERATOR CONTROL REG SAVEARE  * 04918022
*                           REGISTER 14 RETURN REGISTER               * 04919022
*                           REGISTER 15 BRANCHING REGISTER            * 04920022
*                                                                     * 04921022
*    PATCH LABEL = NONE                                               * 04922022
*                                                                     * 04923022
* MODULE TYPE = PROCEDURE                                             * 04924000
*                                                                     * 04925022
*    PROCESSOR = ASSEMBLER XF                                         * 04926022
*                                                                     * 04927022
*    ATTRIBUTES = REFRESHABLE,SERIALLY REUSABLE,TRANSIENT(TYPE 4),    * 04928022
*                 SUPERVISOR MODE,REENTRANT                           * 04929022
*                                                                     * 04930022
* ENTRY POINT = IGCMF10D                                              * 04931022
*                                                                     * 04932022
*    PURPOSE = SEE FUNCTION                                           * 04933022
*                                                                     * 04934022
*    LINKAGE = XCTL SF=(E,OPCXCTL)                                    * 04935022
*                                                                     * 04936022
* INPUT = REGISTER 1 OPCAVT                                           * 04937022
*         OPCCOPCE POINTS TO THE CURRENT ELEMENT                      * 04938000
*             OPCE FROM IGCMH10D                                      * 04938600
*             TIME DELAY ELEMENT                                      * 04939200
*             IPL/DUMP COMMON WORK AREA                               * 04939800
*             OUTPUT BUFFER FROM IGCMG10D                             * 04940400
*                                                                     * 04941022
* OUTPUT = REGISTER 1 = OPCAVT                                        * 04942022
*          REGISTER0 =1 TO GO TO IGCME10D TO READ NEXT LOAD MODULE RCD* 04943000
*          REGISTER0 = ADDRESS OF OUTPUT BUFFER FOR IGCMG10D          * 04944000
*          REGISTER3 = ADDRESS OF OPCE AND OCTRINMF SET TO IGCMD10D   * 04946000
*          OPCCOPCE = 0 TO GO TO IGC0010D TO PREFORM NEXT FUNCTION    * 04947000
*          OPCCOPCE = ADDRESS OF CURRENT ELEMENT (R0 = MSG NO.)       * 04948000
*          TO GO TO IGCMI10D TO WRITE OUT ERROR MESSAGE               * 04949000
*                                                                     * 04955022
* EXIT-NORMAL = IGCMG10D, IGCMD10D, IGC0010D, IGCMI10D                * 04956000
*                                                                     * 04957022
* EXIT-ERROR = IGCMI10D                                               * 04958000
*                                                                     * 04959022
* EXTERNAL REFERENCES = SEE BELOW                                     * 04960022
*                                                                     * 04961022
*    ROUTINES = NONE                                                  * 04962022
*                                                                     * 04963022
*    DATA AREAS = DUMP/IPL COMMON AREA                                * 04964022
*                 IPL 1ST WORK AREA                                   * 04965022
*                 IPL 2ND WORK AREA                                   * 04966022
*                 PHASE 1 AREA - OUTPUT BUFFER                        * 04967022
*                 1K INPUT BUFFER                                     * 04968022
*                 1K WORK BUFFER                                      * 04969022
*                                                                     * 04970022
*    CONTROL BLOCKS = AVT                                             * 04971022
*                     DCB                                             * 04972022
*                     LCB                                             * 04973022
*                     OPCAVT                                          * 04974022
*                     OPCE                                            * 04975022
*                     QCB                                             * 04976022
*                                                                     * 04977022
* TABLES = NONE                                                       * 04978022
*                                                                     * 04979022
* MACROS = XCTL GETMAIN FREEMAIN AQCTL EXCP                           * 04980000
*                                                                     * 04981022
* CHANGE ACTIVITY = NONE                                              * 04982022
*                                                                     * 04983022
*************************END OF SPECIFICATIONS************************* 04984022
         EJECT                                                          05000022
         EJECT                                                          05100022
         USING DATADS,R6                ADDRESSABILITY FOR C-WKAREA     05200022
         USING IEDQLCB,RA               LCB ADDRESSABILITY              05300022
         USING IEDQCCW,RB               ADDRESSABILITY TO      @Y17XARS 05330000
*                                       BUILD CCWS                      05360000
         USING IEDQOPCD,R2              ADDRESSABILITY FOR OPCAVT       05400022
         USING IEDQOPCE,R3              ADDRESSABILITY FOR OPCE         05500022
         USING IEDCOM,R7                COMMON AREA ADDRESS    @Y17XARS 05600000
         BALR  RC,0                     ESTABLISH ADDRESSABILITY        05700022
         USING *,RC                                                     05800022
IGCMF10D IEDHJN  SKIPID                                                 05900022
         LR    R2,R1                    SET BASE FOR OPCAVT             06300022
         L     R3,OPCCOPCE              SET BASE FOR PASSED ELEMENT     06400022
         CLI   FOUR(R3),TIMELEM         TIME DELAY ELEMENT?             06500022
         BE    TIMESUP                  YES                             06600022
         CLI   OCELMPRI,PRIHIFLG        RETURN FROM DLC        @YM03676 06610000
         BE    RETURNIO                 YES                    @Y17XARS 06620000
         USING IEDOCTR,R1                                      @Y17XARS 06630000
         L     R1,OCTRUNIT              LOAD TRAILER BASE      @Y17XARS 06640000
         L     RA,OCTRLCB               LOAD LCB BASE          @Y17XARS 06650000
         DROP  R1                                              @Y17XARS 06660000
         LA    RB,LCBCCW3               CHANNEL PROG CCWS      @Y17XARS 06670000
         L     R7,OCMODNME              SET BASE FOR COMMON AREA        06700022
         LA    R5,COMCCWS               SET BASE FOR LWKAREA            06800022
         LA    R6,DATAOFF(R5)           SET BASE FOR C-WKAREA           07000022
         TM    SWITCH,ONIPL             TEST FOR IPL                    07100022
         BO    WRTIPLA                  YES                             07200022
         TM    SWITCH,ONIO              I/O OUTSTANDING ?               07300022
         BNO   WRT026                   NO--ENTERED FROM 'OUTPUT'       07400022
         SPACE 2                                                        07500022
*        SET UP TO RETURN FROM DLC                             @Y17XARS 07550000
EXCPRTN  EQU   *                                               @YM02941 07600000
         USING IEDQAVTD,R4                                     @Y17XARS 07609000
         L     R4,OPCAVTPT              AVT ADDRESSABILITY     @Y17XARS 07627000
         LA    RF,AVTOPCOB              QCB POST               @YM02935 07636000
         STCM  RF,SEVEN,COMQCB          PUT IT IN ELEMENT      @YM02935 07640000
         MVI   COMPRI,PRIHIFLG          PRIORITY               @Y17XARS 07645000
         MVI   COMFLAGS,COMDLCMF        RETURN FLAG            @Y17XARS 07654000
         ST    R3,COMOPCE               SAVE OPCE ADDRESS      @YM02941 07663000
         XC    LCBCCW1(4),LCBCCW1       ZERO ECB               @Y17XARS 07672000
         MVC   LCBCCW1+4(4),OCMODNME    POINTS TO IPL/DUMP WA  @Y17XARS 07681000
         MVC   OPCMODID,XCTL00          XCTL DESTINATION       @Y17XARS 07690000
         OI    SWITCH,ONIO              I/O IN PROGRESS        @YM02941 07710000
         MVI   LCBSIO,SIOCODE           REQ I/O IN PARM        @ZM46810 07730010
         MVC   LCBCP+1(3),LCBSTART      SET UP CH PGM START    @ZM46810 07733010
         XC    LCBCP(1),LCBCP           CLEAR HIGH BYTE        @ZM46810 07736010
         LA    R1,LCBQEBPL              POINT TO PARM LIST     @ZM46810 07739010
         AQCTL                          DO STARTIO             @ZM46810 07742010
         BR    RE                       RETURN TO CALLER       @YM02941 07750000
         SPACE                                                          08000022
RETURNIO EQU   *                                               @Y17XARS 08080000
         LR    R7,R3                    COMMON WKAREA BASE     @YM02941 08120000
         L     R3,COMOPCE               OPCE BASE              @Y17XARS 08160000
         ST    R3,OPCCOPCE              MAKE OPCE CURRENT ELE  @Y17XARS 08240000
         USING IEDOCTR,R1                                      @Y17XARS 08320000
         L     R1,OCTRUNIT              LOAD TRAILER BASE      @Y17XARS 08400000
         L     RA,OCTRLCB               LOAD LCB BASE          @Y17XARS 08480000
         DROP  R1                                              @Y17XARS 08560000
         LA    RB,LCBCCW3               CHANNEL PROG CCWS      @YM02941 08580000
         LA    R5,COMCCWS               BASE FOR L-WKAREA      @YM02941 08600000
         LA    R6,DATAOFF(R5)           BASE FOR C-WKAREA      @YM02941 08620000
*                                                              @Y17XARS 08630000
*        CHECK CONDITION CODE 3 AND UNIT EXCEPTION ERRORS      @Y17XARS 08640000
*                                                              @Y17XARS 08650000
         TM    LCBSIOCC,LCBSIOC1+LCBSIOC2 IS THIS CC3          @Y17XARS 08660000
         BO    CC3ERR                   YES, ERR MSG AND EXIT  @Y17XARS 08670000
         TM    LCBCSWUS,LCBUSUE         IS THIS UNIT EXCEPTION @Y17XARS 08680000
         BO    UEERR                    YES, ERR MSG AND EXIT  @Y17XARS 08690000
         SPACE 2                                               @Y17XARS 08700000
         LA    R1,LCBCCW3               CHAN PROG AREA         @Y17XARS 08710000
         STCM  R1,SEVEN,LCBSTART        START CHANNEL PROGRAM  @Y17XARS 08720000
*                                       ADDRESS FOR ALL EXCEPT @Y17XARS 08730000
*                                       FIRST                  @Y17XARS 08740000
         CLI   LCBECBCC,LCBECB7F        WAS THE I/O GOOD ?     @YM02950 08800000
         BNE   SETERROR                 N/ - GET ERROR MSG NUMBER       08900022
         NI    SWITCH,ONES-ONIO         TURN OFF I/O PENDING            09200022
         SPACE                                                          09300022
         SPACE                                                          09400022
         CLI   CCWOPCDE,CCWIPL          IPL CMD ?              @Y17XARS 09500000
         BE    WRTIPL2                  YES GO HANDLE                   09600022
         CLI   CCWOPCDE,CCWBRK          WRITE BREAK CMD ?      @Y17XARS 09700000
         BE    WRTBRK                   YES GO HANDLE                   09800000
         SPACE                                                          09900022
         TM    SWITCH2,COMPLETE         WAS THIS THE ENTRY PT.          10300022
         BO    ENDIPL                   YES ITS OVER          @XM05712  10400010
         SPACE                                                          10500022
         TM    SWITCH,ONLAST+ONEND      IS THIS THE END                 10600022
         BO    LASTTXT                  YES                             10700022
         SPACE                                                          10800022
         SPACE                                                          10900022
         MVC   OPCMODID,XCTLOUT         XCTL TO IGCMG10D       @Y17XARS 11100000
         LR    R0,R3                    ADDR OF OUTPUT BUFFER           11200022
         B     EXIT                     PREPARE T O EXIT                11300022
         SPACE  5                                                       11400022
WRT026   EQU   *                                                        11500022
         LR    RE,R0                    RE CONTAINS END OF O/P @YM02949 11600000
*                                       PUT BUFFER                      11700022
         TM    SWITCH2,COMPLETE         WAS THIS THE ENTRY POINT ?      11800022
         BO    ENDOF                    YES ITS OVER                    11900022
         TM    SWITCH,ONLAST+ONEND      IS THIS THE END ?               12000000
         BO    LASTTXT                  YES                             12100022
         SH    RE,OUTBFSZ               ADJ TO START OF BUFFR  @YM02949 12200000
         STCM  RE,SEVEN,CCWADDR         SAVE THE BUFFER ADDR   @YM02949 12300000
         MVI   CCWOPCDE,CCWWRITE        SET WRITE CMD CODE     @Y17XARS 12400000
         MVC   CCWCOUNT,OUTBFSZ         SET THE COUNT          @Y17XARS 12500000
         B     SENDITW                  GO ISSUE AN EXCP                12600022
         SPACE                                                          12700022
         SPACE 4                                                        12800022
WRTIPLA  EQU   *                                                        12900022
         L     RF,PHASPTR               GET PHASE POINTER      @YM02941 13000000
         L     RF,ZERO(RF)              GET PHASE 1 ADDRESS    @YM02941 13100000
         STCM  RF,SEVEN,CCWADDR         BUILD THE CCW          @YM02941 13200000
*                                       OF THE PHASE                    13300022
         MVI   CCWOPCDE,CCWIPL          SET CMD CODE           @Y17XARS 13400000
WRTPHAS  EQU   *                                                        13500022
         MVC   CCWCOUNT,TWO(RF)         LNGTH FROM 2ND HALFWRD @YM02941 13600000
SENDITW  BAL   RE,EXCPRTN               SEND IT                         13700022
         XR    R0,R0                    CLEAR FOR IGC0010D     @YM02941 13750000
         B     EXIT                     GET OUT                @YM02941 13800000
         SPACE 2                                                        13900022
WRTIPL2  EQU   *                                                        17000022
         SPACE 3                                                        17100022
*    PHASE 1 JUST SENT; TURN OFF IPL BIT. REG 7 POINTS TO PHASE 1     * 17200022
*    1ST HALF WORD OF PHASE 1 HAS IT'S LENGTH. USE 1ST 512 BYTES FOR  * 17300022
*    OUTPUT BUFFER. ISSUE GETMAIN FOR 1028 BYTES FOR AN INPUT AND A   * 17400022
*    WORK BUFFER.                                                     * 17450022
         SPACE 3                                                        17500022
         NI    SWITCH,ONES-ONIPL                                        17600022
         LA    RF,BUFFOFF(R7)           POINT TO TEXT BUFFER   @XM05687 18000010
         ST    RF,OUTBUF(R5)            SAVE ADDR OF OUTPUT    @YM02941 18200000
*                                       BUFFER IN L-WKAREA              18300000
         SPACE  3                                                       18400022
         BAL   RE,GETCORE               GET 1028 BYTES FOR AN INPUT     18500022
*                                       BUFFER                          18550022
         ST    R8,INBUF(R5)             SAVE ADDR OF INPUT BUFFER       18600022
*                                       IN L-WKAREA                     18700022
         BAL   RE,GETCORE               GET 1028 BYTES FOR A WORK       18800022
*                                       BUFFER                          18850022
         ST    R8,WORKBUF(R5)           SAVE ADDR OF WORK BUFFER        18900022
*                                       FOR RELOCATE                    19000022
         SPACE  3                                                       19100022
         TM    ZERO(R5),BRNGUP          BRING-UP SELECTED               19200022
         BNO   WRTIPL3                  NO                              19300022
         SPACE  3                                                       19400022
XCTLME   EQU   *                        PREPARE TO XCTL TO IGCME10D     19500022
         SPACE 3                                                        19600022
         MVC   OPCMODID,XCTLINPT        XCTL TO IFLINPUT TO    @Y17XARS 19700000
*                                       GET 1ST RECORD FOR BRING-UP     19800000
*                                       BLDL AND FIND HAVE ALREADY BEEN 19900022
*                                       DONE. BUT WILL HAVE TO XCTL     20000022
*                                       BACK TO 1ST LOAD TO DO BLDLAND  20100022
*                                       FIND FOR THE L.M.               20200022
         LA    R0,ONE                   INSERT 1 FOR IGCME10D           20300022
         B     EXIT                     PREPARE TO XCTL                 20400022
         SPACE  3                                                       20500022
WRTIPL3  EQU   *                        NO - SEND PHASE 2               20600022
         L     RF,PHASPTR                                      @YM02941 20700000
         L     RF,FOUR(RF)              SET UP TO SEND         @YM02941 20800000
         STCM  RF,SEVEN,CCWADDR         PHASE 2                @YM02941 20900000
         MVI   CCWOPCDE,CCWBRK          WRITE BREAK PHASE 2    @Y17XARS 21000000
         B     WRTPHAS                  GO SET LENGTH AND SEND IT       21100022
         SPACE                                                          21200022
         SPACE                                                          21300022
WRTIPL4  EQU   *                                                        21400022
         NI    ZERO(R5),XFA             TURN OFF INITIAL TEST REQ.      21430022
WRITIPL5 EQU   *                                                        21460022
         SPACE 5                                                        21500022
         SPACE 5                                                        21900022
         MVI   SWITCH,ZERO              CLEAR SWITCHES                  22000022
         NI    SWITCH2,ONES-DIAGOK-COMPLETE                             22100022
         MVC   OPCMODID,XCTLMD10        XCTL TO 1ST LOAD       @Y17XARS 22200000
*                                       AND DO A BLDL AND FIND FOR L.M. 22300022
         L     R3,OPCCOPCE              GET OPCE OR L-WKAREA            22400022
         L     R1,OCTRUNIT              TRAILER ADDRESSABILITY @Y17XARS 22430000
         OI    OCTRSW-IEDOCTR(R1),OCTRINMF SET MD INPUT FLAG   @Y17XARS 22460000
         B     EXIT                     PREPARE TO EXIT                 22700022
         SPACE 4                                                        22800022
LASTTXT  EQU   *                                                        22900022
         L     RE,REGSAVE(R5)           OUTPUT BUFFER END ADDR @YM03680 23000000
         SH    RE,OUTBFSZ               ADJUST TO BEGINNING    @YM03680 23100000
         STCM  RE,SEVEN,CCWADDR         SET UP CMD ADDRESS     @YM03680 23200000
         MVI   CCWOPCDE,CCWBRK          SET WRITE BREAK CMD    @Y17XARS 23300000
         SR    R4,R4                    CLEAR IT                        23400022
         L     R4,LENSAVE(R5)           GET TEXT LEN SAVED BY           23500000
*                                       IGCMG10D                        23600022
         SH    R4,OUTBFSZ               COUNT.                          23700000
         LCR   R4,R4                                                    23800022
         CH    R4,N4H                   LESS THAN 4 BYTES LEFT ?        23900022
         BNL   LASTTXT2                 NO - CONTINUE                   24000022
         LA    R4,FOUR                  YES - SET 4 AS A COUNTER        24100022
LASTTXT2 EQU   *                                                        24200022
         STH   R4,CCWCOUNT                                     @Y17XARS 24300000
         B     SENDITW                  GO SEND IT                      24400022
         SPACE 2                                                        24500022
WRTBRK   EQU   *                                                        24600022
         SPACE 4                                                        24700022
         L     RF,PHASPTR                                      @YM02941 24800000
         CLC   CCWADDR,FIVE(RF)         PHASE 2 WRITE BREAK ?  @YM02941 24900000
         BNE   WRTBRK2                  NO - TEST FOR B.U.              25000022
         TM    SWITCH2,DIAGOK           AFTER BRING-UP "                25100022
         BO    WRTIPL4                  YES                             25200022
         B     XCTLME                   PREPARE TO EXIT                 25300022
         SPACE                                                          25400022
WRTBRK2  EQU   *                                                        25500022
         CLI   DIAGIND,CHARN            BRING-UP JUST LOADED ?          25600022
         BNE   SETTIM                   YES - GO TO TIME DELAY          25700022
         LA    R9,ENTRYPT               SET UP CCW                      25800022
         STCM  R9,SEVEN,CCWADDR         FOR SENDING            @Y17XARS 25900000
         MVI   CCWOPCDE,CCWWRITE        SENDING THE ENTRY      @Y17XARS 26000000
         MVI   CCWFLAGS,AVTEZERO        NO CHAINING            @XM05712 26050010
         LA    R9,FOUR                  LENGTH OF 4                     26100022
         STH   R9,CCWCOUNT              INSERT IN CCW          @Y17XARS 26200000
         OI    SWITCH2,COMPLETE         INDICATE THE END                26300022
         B     SENDITW                  GO SEND IT                      26400022
GETCORE  EQU   *                                                        26500022
         L     R8,OPCOPTLK              ADDR OF GETMAIN LIST IN CA      26600022
         MVC   ONE(THREE,R8),INBUFSZE   SIZE OF INPUT BUFFER            26700022
         LA    R1,OPCDOUBL              PLACE TO PUT ADDR. CORE         26800022
         ST    R1,FOUR(R8)              PUT THIS ADDR IN PARALIST       26900022
         LR    R1,R8                    ADDR OF PARALIST IN REG 1       27000022
         GETMAIN   ,MF=(E,(1))                                          27100022
         L     R8,OPCDOUBL              ADDRESS OF GETMAIN AREA         27200022
         LTR   RF,RF                    WAS GETMAIN SUCCESSFUL          27250022
         BCR   8,RE                     YES, RETURN TO CALLER           27300022
         SPACE 2                                                        27350022
         LA    R0,MSG164                ERROR MESSAGE NUMBER            27400022
         L     R3,OPCCOPCE              GET ELEMENT                     27500022
TOTE     EQU   *                                                        27700022
         XC    OCWTG,OCWTG              CLEAR WTG FIELD                 27720022
         B     CLEANUP                  CLEANUP PROCESSING              27800022
SETERROR EQU   *                                                        27810022
         LA    R0,IOERRMSG              I/O ERROR MSG NUMBER            27850022
SETEXIT  EQU   *                                               @Y17XARS 27851000
         L     R3,OPCCOPCE              OPCE ADDRESSABILITY    @Y17XARS 27852000
         USING IEDOCTR,R9                                      @Y17XARS 27854000
         L     R9,OCTRUNIT              TRAILER ADDRESSABILITY @Y17XARS 27856000
         OI    OCTRRTN,OCTRERI          IPL ERROR FLAG         @Y17XARS 27858000
         B     CLEANUP                  SET NEXT XCTL MOD ID   @YM03684 27865000
         DROP  R9                                                       27870022
CC3ERR   EQU   *                                               @Y17XARS 27890000
         LA    R0,MSG534                CONDITION CODE 3 ERROR @Y17XARS 27910000
         B     SETEXIT                  EXIT TO IGCMI10D       @Y17XARS 27930000
UEERR    EQU   *                                               @Y17XARS 27950000
         LA    R0,MSG536                ASSUME ERROR ON SENSE  @Y17XARS 27970000
         ICM   RB,7,LCBCSWCA            CCW ENDING ADDRESS     @Y17XARS 27990000
         SH    RB,LENCCW                CCW BEGINNING ADDRESS  @Y17XARS 28000000
         CLI   CCWOPCDE,CCWSENSE        IS THIS UE ON SENSE    @Y17XARS 28010000
         BE    SETEXIT                  YES, ISSUE MSG 536     @Y17XARS 28030000
         LA    R0,MSG535                NO,ISSUE MSG 535       @Y17XARS 28050000
         B     SETEXIT                                         @Y17XARS 28070000
         SPACE 5                                                        28100022
ENDIPL   EQU   *                                               @XM05712 28110010
         L     R9,LCBCSWCA-1           INTERRUPT CCW ADDR+8    @XM05712 28120010
         SH    R9,LENCCW                INTERRUPT CCW ADDRESS  @XM05712 28130010
         CLI   CCWOPCDE-IEDQCCW(R9),CCWNOP THIS NOP CCW        @XM05712 28140010
         BE    ENDOF                    BR YES,ALL DONE        @XM05712 28150010
         AH    R9,LENCCW                POINT TO NOP CCW       @XM05712 28160010
         ST    R9,LCBSTART-1            SET TO RESTART         @XM05712 28170010
         B     SENDITW                  RESTART                @XM05712 28180010
ENDOF    EQU   *                        IPL IS COMPLETE PREPARE TO      28200022
*                                       WRITE OUT MSG. AND INITIATE     28300022
*                                       3705 ACTIVITY                   28400022
         L     R3,OPCCOPCE              OPCE ADDRESSABILITY    @Y17XARS 28420000
         MVI   OCSWITCH,OCIPLC          SAYS IPL COMMAND       @Y17XARS 28440000
         LA    R0,MSG194                MSG NUMBER FOR TOTE    @Y17XARS 28460000
         TM    OCFLAG,OCTOTE            TOTE REQUEST                    28910022
         BO    TOTE                     SET UP TO GO TO IGCMI10D        28920022
         SR    R0,R0                    ZERO R0 FOR INDICATOR  @Y17XARS 28930000
         STH   R0,OCPARM                SAVE MESSAGE NUMBER             28950022
         EJECT                                                          29050022
*********************************************************************** 29051022
*                                                                     * 29052022
*    THIS SECTION OF CODE, AFTER AN IPL                               * 29053022
*    FREEMAINS THE TWO WORKAREA THAT WERE GETMAINED FOR BY IGCMF10D   * 29054022
*                                                                     * 29055022
*********************************************************************** 29056022
*                                                                     * 29057022
CLEANUP  EQU   *                                                        29058022
         MVC   OPCMODID,XCTLMI          INSERT ID OF IGCMI10D  @YM03684 29058500
         LR    RA,R0                    SAVE THE MESSAGE NUMBER         29059022
         SPACE 3                                                        29064022
         LA    R1,INBUF(R5)             ADDR OF ADDR TO FREE            29065022
         ICM   R7,7,ZERO(R1)            AN AREA TO FREE                 29065422
         BZ    TRYNEXT                  NO - GET NEXT ONE               29065822
         BAL   RE,FREECORE              BRANCH TO FREE IT               29066222
TRYNEXT  EQU   *                                                        29066622
         LA    RE,EXIT                  LOAD RETURN POINT               29067022
         LA    R1,WORKBUF(R5)           ADDR OF ADDR TO FREE            29067422
         ICM   R7,7,ZERO(R1)            AN AREA TO FREE                 29067822
         BCR   8,RE                     NO                              29068222
         SPACE 3                                                        29069022
FREECORE EQU   *                                                        29070022
         L     R8,OPCOPTLK              GET FREEMAIN LIST IN IEDQCA     29071022
         MVC   ONE(THREE,R8),INBUFSZE   SIZE OF AREA TO FREE            29072022
         ST    R1,FOUR(R8)              PUT THIS ADDR IN PARALIST       29073022
         LR    R1,R8                    ADDRESS OF PARALIST IN REG1     29074022
         FREEMAIN  ,MF=(E,(1))                                          29075022
         LR    R0,RA                    PUT MSG NUM BACK IN REG0        29076022
         BR    RE                       RETURN TO CALLER                29077022
         SPACE 3                                                        29078022
         EJECT                                                          29082022
         SPACE 4                                                        29100022
SETTIM   EQU   *                                                        29200022
         SPACE  3                                                       29300022
*    TPOST SPECIAL TIME DELAY ELEMENT FOR 30 SECONDS TO TIME          * 29400022
*    DELAY QCB WHOSE ADDR IS IN THE AVT                               * 29500022
         SPACE  3                                                       29600022
*    WAIT ON BRING-UP TO COMPLETE PROCESSING. GET A BUFFER UNIT       * 29700022
*    FROM IEDQCA; BUILD A TIME DELAY REQUEST ELEMENT AND TPOST IT     * 29800022
*    TO THE TIME DELAY QCB REQUESTING A 30 SEC. DELAY RELINQUISH CTRL * 29900022
         SPACE  3                                                       30100022
         USING IEDQAVTD,R4              ADDRESSABILITY FOR AVT          30200022
         L     R4,OPCAVTPT              BASE FOR AVT                    30300022
         LA    R1,ONE                   GET 1 UNIT                      30400022
         LA    RD,OPCSAVE               ADDR OF REGISTER SAVEAREA       30500022
         L     RF,OPCGETBF              ADDR BUFFER REQUEST RTN         30600022
         BALR  RE,RF                    BRANCH TO IT                    30700022
         LA    R7,AVTDELYB              ADDR TIME DELAY QCB             30800022
         USING IEDQQCB,R1               ADDRESSABILITY FOR QCB          30900022
         ST    R7,QCBELCHN-ONE          INSERT TIME DELAY QCB ADDR      31000022
         MVI   QCBPRI,TIMELEM           PRIORITY IS 70                  31100022
         SPACE 5                                                        31200022
         MVC   QCBEOLDT,TIME2           TIME TO DELAY FOR PART 1        31300022
*                                       AND PART 2  INITIAL TEST        31500022
         LA    R7,AVTOPCOB              OPC QCB ADDR                    31800022
         ST    R7,OFFSET(R1)            STORE IN TIME DELAY ELEMENT     31900022
         L     R3,OPCCOPCE              GET ADDR OF PASSED ELEMENT      32000022
         ST    R3,ELEMSAVE(R1)          SAVE IT IN TIME DELAY ELEM      32100022
         MVI   QCBRETCT,OFFSET          PUT OFFSET TO OPC QCB           32200022
         MVI   QCBTSOF1,ZEROS           ZERO OUT RECYCLE FLAG BYTE      32300022
*                                       INITIAL TEST                    32400022
         LA    R8,POSTWAIT                                              32500022
         SPACE 3                                                        32600022
*        TPOST ELEMENT TO THE DISABLED READY QUEUE                    * 32700022
         SPACE 3                                                        32800022
POSTIT   EQU   *                                                        32900022
         LA    RB,OPCAQCTL              SVC 102 POST LIST               33000022
         ST    R1,ZERO(RB)              INIT LIST                       33100022
         ST    R1,FOUR(RB)              INIT LIST                       33200022
         MVI   ZERO(RB),X0C             INDICATE POST OF ELEM           33300022
         MVI   FOUR(RB),X80             INDICATE LAST ENTRY             33400022
         LR    R1,RB                    ADDR OF POST LIST               33500022
         AQCTL                          POST ELEMENT                    33600022
         LA    RB,LCBCCW3               RESTORE CCW POINTER    @Y17XARS 33900000
         BR    R8                       BRANCH TO PREDETERMINED CODE    34200022
         SPACE 3                                                        34300022
*    SET UP TO RELINQUISH CONTROL BACK TO IGC0010D             @YM02941 34400000
         SPACE 3                                                        34500022
POSTWAIT EQU   *                                                        34600022
         MVC   OPCMODID,XCTL00          INSERT ID OF IGC0010D  @Y17XARS 35500000
         XR    R0,R0                    CLEAR FOR 0010D        @YM02941 35550000
         SPACE 5                                                        35600022
EXIT     EQU   *                                                        35700022
         LR    R1,R2                    SET PARAMETER REGISTER          35800022
         XCTL  SF=(E,OPCXCTL)                                           35900022
         SPACE 2                                                        36000022
         SPACE                                                          36100022
         SPACE  3                                                       36200022
*    THIS SECTION OF CODE RE-INITIALIZES REGISTER 5 AND 6  AFTER      * 36300022
*    THE 30 SEC TIME DELAY FOR INITIAL TEST PROCESSING HAS EXPIRED    * 36400022
         SPACE  3                                                       36500022
TIMESUP  EQU   *                                                        36600022
         USING IEDQOPCE,R3              ADDRESSABILITY FOR OPCE OR      36700022
         LR    R1,R3                    SAVE BUFR POINTER      @YM02941 36750000
         L     R3,ELEMSAVE(R3)          GET ADDR OF SAVED ELEMENT       37000022
         ST    R3,OPCCOPCE              RE-INITIALIZE CURRENT ELEMENT   37100022
         OI    QCAFLAG(R1),ENDCHN       LAST BUFFR TO FREE     @YM02941 37120000
         L     RF,OPCFREBF              ADDR OF FREEBUF RTNE   @YM02941 37140000
         BALR  RE,RF                    GO FREE THE BUFFER     @YM02941 37160000
         USING IEDCOM,R7                COMMON AREA ADDRESSABILITY      37200000
         L     R7,OCMODNME              GET COMMON AREA ADDRESS         37300022
         USING IEDOCTR,R6                                      @Y17XARS 37310000
         L     R6,OCTRUNIT              TRAILER ADDRESSABILITY @Y17XARS 37320000
         L     RA,OCTRLCB               LCB ADDRESSABILITY     @Y17XARS 37330000
         DROP  R6                                              @Y17XARS 37340000
         USING DATADS,R6                ADDRESSABILITY FOR COM @Y17XARS 37350000
*                                       WORKAREA               @Y17XARS 37360000
         LA    R5,COMCCWS               GET ADDRESS OF LWKAREA          37400022
         LA    R6,DATAOFF(R5)           SET BASE FOR C-WKAREA           37500022
         LA    RB,LCBCCW2               CHAN PROG CCWS         @YM04661 37550000
         SPACE 5                                                        37600022
         CLC   MEMBER(EIGHT),DIAGMEM+EIGHT SENT PART 2 OF INITIAL TEST  37700022
         BNE   SENT1ST                  NO SENT PART 1                  37800022
         OI    SWITCH2,DIAGOK           PART 2 JUST LOADED SWITCH       37900022
         MVI   DIAGIND,AVTEZERO         CLEAR INITIAL TEST REQUEST      38000022
         NI    ZERO(R5),XFA             TURN OFF INITIAL TEST REQ.      38100022
         B     WRTIPL3                  PREPARE TO SEND PHASE 2         38200022
SENT1ST  EQU   *                                                        38300022
*                                       PART OF INITIAL TEST TO RUN     38400022
         MVI   DIAGIND,CHARN            INDICATE TO KEEP LOADING        38500022
*                                       INITIAL TEST                    38600022
         B     WRITIPL5                 CONTINUE                        38700022
         SPACE 5                                                        38800022
         SPACE 3                                                        38900022
         SPACE 4                                                        39100022
         EJECT                                                          40100022
***************************** LOCAL DATA & DSECTS **************        40200022
         SPACE                                                          40300022
BUFFOFF  EQU   1536                     OFFSET IN WKARE TO BUF @XM05687 40350010
WRTCC    EQU   X'01'                    CCW COMMAND CODES               40400022
IPLCC    EQU   X'05'                                                    40500022
WRTBRKCC EQU   X'09'                                                    40600022
SENCC    EQU   X'04'                                                    40700022
         SPACE                                                          40800022
IPLREQ   EQU   X'02'                    IPL REQ. SENSE BIT              40900022
XCTLMH   DC    C'MH'                    ID OG IGCMH10D RTN              41800022
INBUFSZE DC    X'000408'                BYTES TO GETMAIN FOR            42100022
POSTED   EQU   X'40'                    ECB POSTED INDICATOR            42200022
BRNGUP   EQU   X'05'                    BRING-UP REQUESTED              42300022
DIAGMEM  DC    C'IFL3705D'              INITIAL TEST PART 1             42330022
         DC    C'IFL3705E'              INITIAL TEST PART 2             42360022
         SPACE 5                                                        42400022
TIME2    DC    H'0030'                  TIME TO WAIT FOR INITIAL TEST   42500022
*                                       TO RUN                          42700022
         SPACE 5                                                        42800022
LENSAVE  EQU   100                      OFFSET IN L-WK TO LENGTH OF     43000022
*                                       TEXT SAVED BY IGCMG10D          43100022
REGSAVE  EQU   X'60'                                                    43200022
MSG164   EQU   164                      CORE NOT AVAIL. FOR IPL         43400022
MSG534   EQU   534                      3705 DISABLED          @Y17XARS 43450000
MSG535   EQU   535                      NCP TOO LARGE          @Y17XARS 43500000
MSG536   EQU   536                      IN PROGRESS ON OTHER CA@Y17XARS 43550000
IOERRMSG EQU   168                      I/O ERROR ENCOUNTERED           43600022
ELEMSAVE EQU   24                       OFFSET IN TIME DELAY ELEMENT TO 43900022
*                                       WHERE ADDR OF OUR PASSED ELEM   44000022
X0C      EQU   X'0C'                    TO SET SVC 102 LIST             44030022
X80      EQU   X'80'                    TO SET SVC 102 LIST             44060022
*                                       OPCE OR L-WKAREA RESIDES.       44100022
LCBSAVE  EQU   X'58'                    OFFSET IN L-WK TO SAVEAREA      44400022
*                                       FOR 3705 LCB                    44500022
WAITING  EQU   X'40'                    WAIT STATE BIT                  45100022
ZEROS    EQU   X'00'                    ZERO OUT RECYCLE FLAG BYTE      45200022
DELAY    EQU   X'32'                    OFFSET IN WKAREA FOR            45300022
*                                       TIME TO WAIT                    45350022
XCTL00   DC    C'00'                    ID OF IGC0010D RTN.             45400022
XFE      EQU   X'FE'                    MASK TO TURN OFF READ REQ.      45500022
X10      EQU   X'10'                    OFFSET TO DATA                  45600022
XFA      EQU   X'FA'                    MASK TO TURN OFF                45650022
X08      EQU   X'08'                    OFFSET TO READ DATA FROM        45800022
*                                       PRFBTUA                         45900022
LENCCW   DC    AL2(CCWLEN)              CCW LENGTH             @Y17XARS 45950000
READSZE  DC    H'32'                    NUM OF BYTES TO READ            46000022
MSG194   EQU   194                      IPL SUCCESS MSG                 46100022
CLNUPPRI EQU   X'88'                    CLEAN UP INDICATOR TO MH        46200022
AUTOIPL  EQU   X'DF'                    PRIORITY OF AUTO-IPL ELEMENT    46230022
XCTLMY   DC    C'MY'                    ID OF 3705 ACTIVATE             46260022
XCTLMI   DC    C'MI'                    ID OF IGCMI10D ROUTINE          46280022
READCC   EQU   X'02'                    READ COMMAND CODE               46300022
IPLED    EQU   X'08'                    BIT IN 3705 DCB TO INDICATE     46330022
*                                       THAT THIS 3705 IS IPLED         46360022
IPLPRIO  EQU   X'DD'                    OBR DATA FROM A READ IN IPL     46400022
TIMELEM  EQU   70                       PRIORITY OF TIME DELAY ELEM.    46500022
OFFSET   EQU   X'08'                    OFFSET IN TIME DELAY REQ. ELEM  46600022
*                                       TO OPC QCB ADDR                 46700022
***************************************************************         46900022
         SPACE 2                                                        47000022
OUTBUF   EQU   28                       ADDR OF OUTBUF IN L-WKAREA      47100022
INBUF    EQU   32                       ADDR OF INPUT BUFFER IN L-WKAR  47200022
WORKBUF  EQU   36                       ADDR OF WORK BUFFER IN L-WKAREA 47300022
FOURTY   EQU   40                                                       47500022
DATAOFF  EQU   184                      OFFSET TO START OF C-WKAREA     47800022
IGC06    DC    C'06'                    CHKPT MODULE ID                 47900022
NOTFIRST EQU   X'80'                    INDICATES TO MD THIS IS A       47950022
*                                       SUBSEQUENT ENTRY AND BLDL       48000022
*                                       AND FIND FOR L.M. IN NEEDED     48100022
XCTLINPT DC    C'ME'                                                    48200022
XCTLMD10 DC    C'MD'                    MODULE ID FOR IGCMD10D          48300022
XCTLOUT  DC    C'MG'                    ID OF OUTPUT RTN.               48400022
         EJECT                                                          48500022
*****************  I/O BUFFERS AND WORK AREAS  *****************        48600022
         SPACE  3                                                       48700022
BUFFER   DSECT                                                          48800022
         DS    257F                     TEXT AREA                       48900022
INBUF1   DSECT                                                          49000022
         DS    257F                     INPUT BUFFER                    49100022
OUTBUF1  DSECT                                                          49200022
         DS    256H                     TEXT AREA                       49300022
         SPACE                                                          49400022
REPLYD   DSECT                                                          49500022
REPLY    DS    X                                                        49600022
         DS    AL3                                                      49700022
ECBRR    DS    AL4                                                      49800022
         SPACE 4                                                        49900022
         SPACE 2                                                        50000022
         EJECT                                                          50100022
DATADS   DSECT                                                          50200022
****************************************************************        50300022
*        REGISTER AND NUMBER EQUATES                                    50400022
R0       EQU   0                                                        50500022
R1       EQU   1                                                        50600022
R2       EQU   2                                                        50700022
R3       EQU   3                                                        50800022
R4       EQU   4                                                        50900022
R5       EQU   5                                                        51000022
R6       EQU   6                                                        51100022
R7       EQU   7                                                        51200022
R8       EQU   8                                                        51300022
R9       EQU   9                                                        51400022
RA       EQU   10                                                       51500022
RB       EQU   11                                                       51600022
RC       EQU   12                                                       51700022
RD       EQU   13                                                       51800022
RE       EQU   14                                                       51900022
RF       EQU   15                                                       52000022
         SPACE                                                          52100022
         SPACE                                                          53700022
ZERO     EQU   0                                                        53800022
ONE      EQU   1                                                        53900022
TWO      EQU   2                                                        54000022
THREE    EQU   3                                                        54100022
FOUR     EQU   4                                                        54200022
FIVE     EQU   5                                                        54300022
SIX      EQU   6                                                        54400022
SEVEN    EQU   7                                                        54500022
EIGHT    EQU   8                                                        54600022
NINE     EQU   9                                                        54700022
TEN      EQU   10                                                       54800022
ELEVEN   EQU   11                                                       54900022
TWELVE   EQU   12                                                       55000022
         SPACE 2                                                        55100022
****************************************************************        55200022
**    MISCELLANEOUS  EQUATES  AND CONSTANTS                   **        55300022
         SPACE                                                          55400022
BIT10    EQU   X'10'          TEST FOR OPEN IN DCB                      55500022
SIOCODE  EQU   X'30'          SIO ENTRY FOR 3705 STARTIO       @ZM46810 55510010
QCAFLAG  EQU   11                                              @YM02941 55530000
ENDCHN   EQU   3                                               @YM02941 55560000
IFLGSD   EQU   49             DCB IFLGS DISPLACEMENT                    55600022
NOERRTN  EQU   X'0C'          INDICATE NO SYS ERROR RTNS.               55700022
UCBCA    EQU   19             UCB DISP OF CA INDICATOR.                 55800022
MINICA   EQU   X'15'          MINI CA INDICATOR IN UCB.                 55900022
         SPACE                                                          56000022
ABORTVAL EQU   12             ABORT RET CODE THRESHOLD.                 56100022
RETCODE  DC    H'0'           RETURN CODE.                              56200000
MAXRC    DC    H'0'           MAXIMUM RETURN CODE SET.                  56300000
RNDDN    DC    C'        '    RN DDNAME                                 56400022
RNADR    DC    C'   '         UNIT ADDRESS AREA.                        56500000
ENTRYPT  DC    F'0'           ENTRY POINT FOR LOAD.                     56600022
ARADDR   EQU   12             DECB AREA ADDR. DISP.                     56700022
RNSWITCH EQU   X'14'          DISP OF SWITCH IN DIAG PHASE 1.           56800000
SIXTBIT  EQU   X'01'          SIXTEEN BIT INDICATOR.                    56900000
ALIASIND EQU   X'80'          THIS IS AN ALIAS-INDICATOR.  BLDL         57000022
RENREUS  EQU   X'C0'          REENTRANT & REUSABLE         BLDL         57100022
ABORT    EQU   X'03'          ABORT SENSE INDICATORS.                   57200022
         DS    0H                                                       57300022
TXTLNGTH DC    H'0'           LENGTH OF TEXT RECORD                     57400022
         DS    0F                                                       57500022
TOTLNGTW DC    AL1(0)         TOTAL LENGTH OF DATA                      57600022
TOTLNGTH DC    AL3(0)         TRANSFERRED                               57700022
         DS    0F                                                       57800022
TXTADDRW DC    AL1(0)         ADDRESS (REL TO ZERO) OF                  57900022
TXTADDR  DC    AL3(0)         THIS TEXT RECORD.                         58000022
         SPACE                                                          58100022
N256HW   DC    H'256'         MAXIMUM MVC COUNT                         58200022
INBUFSZ  DC    H'1024'        SIZE OF INPUT BUFFER                      58300022
OUTBFSZ  DC    H'512'         SIZE OF OUTPUT BUFFER.                    58400022
DOUBLE   DC    D'0'           DOUBLE WORD WORK AREA                     58500022
LINECNT  DC    H'0'           LINE COUNT FOR OUTPUT                     58600022
MAXLIN   DC    H'52'          MAXIMUM LINES PER PAGE.                   58700022
N4H      DC    H'4'           FOUR CONSTANT                             58800022
         SPACE                                                          58900022
**   BLDL  LIST  FOR  LOAD  MODULE  DATA  SET                 **        59000022
         DS    0H                                                       59100022
BLDLIST  DC    H'1'           ONE ENTRY IN THIS LIST.                   59200022
         DC    H'58'          EACH ENTRY IS 58 BYTES LONG               59300022
MEMBER   EQU   *              MEMBER NAME PLACE HERE.                   59400022
         DS    CL8                                                      59500022
RALTTRK  DC    4X'00'         USED IN FIND                              59600000
*                                                                       59700022
Z        DC    X'00'          FLAG BYTE                                 59800022
C        DC    X'00'          FLAG BYTE                                 59900022
         ORG   MEMBER+22                                                60000022
ATTRIB   EQU   *              ATTRIBUTE FIELD                           60100022
         ORG   MEMBER+29                                                60200022
EPAMEM   EQU   *              ENTRY PT IF MEMBER DIR.ENTRY.             60300022
         ORG   MEMBER+43                                                60400022
EPAALS   EQU   *              ENTRY PT IF ALIAS DIR.ENTRY.              60500022
         ORG   MEMBER+58                                                60600022
         SPACE                                                          60700022
MAXIVT   EQU   *                                                        60800022
         DC    V(CXWMAXI1)         ADDRESS OF MAXI PHASE 1              60900022
         DC    V(CXWMAXI2)         ADDRESS OF MAXI PHASE 2..            61000022
         SPACE                                                          61100022
MINIVT   EQU   *                                                        61200022
         DC    V(CXWMINI1)         ADDRESS OF MINI PHASE 1              61300022
         DC    V(CXWMINI2)         ADDRESS OF MINI PHASE 2..            61400022
         SPACE                                                          61500022
PHASPTR  DC    A(MAXIVT)           PHASE VECTOR TABLE PTR..             61600022
PHASCNT  DC    H'8'                NUMBER OF PHASES TIMES FOUR..        61700022
MAXIPH1  DC    V(CXWMAXI1)         ADDRESS OF MAXI PHASE 1.             61800022
MINIPH1  DC    V(CXWMINI1)         ADDRESS OF MINI PHASE 1.             61900022
MAXIBUPH DC    CL8'IFL3705B'       NAME OF DIAG MAXI PHASE 1.           62000022
MINIBUPH DC    CL8'IFL3705A'       NAME OF DIAG MINI PHASE 1.           62100022
         SPACE                                                          62200022
*                               *                              *        62300022
****************************************************************        62400022
***      SWITCHES AND TEST EQUATES                            **        62500022
         SPACE                                                          62600022
SWITCH   EQU   *         * SWITCH BYTE *                                62700022
         SPACE                                                          62800022
SW1      EQU   *          INDICATES ONE PARM PROCESSED                  62900022
ON1      EQU   X'80'          TURN ON SW1                               63000022
OFF1     EQU   X'7F'          TURN OFF SW1                              63100022
         SPACE                                                          63200022
TXTSW    EQU   *            INDICATES TEXT RECORD IN NEXT BUFFER        63300022
ONTXT    EQU   X'40'          TURN ON TXTSW                             63400022
OFFTXT   EQU   X'BF'          TURN OFF TXTSW                            63500022
         SPACE                                                          63600022
LASTSW   EQU   *            INDICATES LAST TEXT RECORD                  63700022
ONLAST   EQU   X'20'          TURN ON LASTSW                            63800022
         SPACE                                                          63900022
ENDIN    EQU   *            INDICATES INPUT BUFFER IS EMPTY.            64000022
ONEND    EQU   X'10'          TURN ON ENDIN.                            64100022
OFFEND   EQU   X'EF'          TURN OFF ENDIN.                           64200022
         SPACE                                                          64300022
IPLSW    EQU   *            INDICATES BOOTSTRAP IS TO BE SENT           64400022
ONIPL    EQU   X'08'          TURN ON IPLSW.                            64500022
OFFIPL   EQU   X'F7'          TURN OFF IPLSW.                           64600022
         SPACE                                                          64700022
IOPEND   EQU   *            INDICATES AN EXCP IS OUTSTANDING.           64800022
ONIO     EQU   X'04'          TURN ON IOPEND                            64900022
OFFIO    EQU   X'FB'          TURN OFF IOPEND                           65000022
         SPACE                                                          65100022
ERRENT   EQU   *            INDICATES ERROR RTN HAS BEEN ENTERED        65200022
ONENT    EQU   X'02'          TURN ON ERRENT.                           65300022
         SPACE                                                          65400022
BUFFERSW EQU   *                 INDICATES PRIMING OF BUFFERS..         65500022
BUFSW    EQU   X'01'                                                    65600022
         SPACE                                                          65700022
ONES     EQU   X'FF'          USED IN SWITCH MANIPULATIONS.             65800022
         SPACE                                                          65900022
         DC    AL1(0)      * ACTUAL SWITCH BYTE *                       66000022
         SPACE 2                                                        66100022
SWITCH2  EQU   *                                                        66200022
CASW     EQU   *                                                        66300022
         SPACE                                                          66400022
LOADFLG  EQU   X'80'          LOADMOD KEYWORD PROCESSED.                66500022
UNITFLG  EQU   X'40'          UNIT    KEYWORD PROCESSED.                66600022
DIAGFLG  EQU   X'20'          DIAG    KEYWORD PROCESSED.            BUP 66700022
DIAGOK   EQU   X'10'          BRING-UP COMPLETED INDICATOR.         BUP 66800022
ONCA     EQU   X'01'               ON INDICATING MINI CA.               66900022
COMPLETE EQU   X'02'          LAST WRITE JUST ISSUED.                   67000022
NXTPHS   EQU   X'04'          NEXT PHASE REQUEST.                       67100022
         SPACE                                                          67200022
         DC    AL1(0)          * ACTUAL SWITCH2 BYTE *                  67300022
         SPACE                                                          67400022
DIAGIND  DC    C'Y6'              INITIAL-TEST INDICATOR.               67500022
DIAGDEF  DC    C'Y6'               DEFAULT DIAG VALUE.                  67600022
CHARN    EQU   C'N'           NO BRING-UP INDICATOR.                BUP 67700022
         SPACE 2                                                        67800022
WARN     DC    AL1(0)        BYTE USED FOR WARNING INDICATORS           67900022
RNFULL   EQU   X'80'            RN IS FULL WARNING                      68000022
         SPACE                                                          68100022
GOODCODE EQU   X'7F'          NORMAL ECB COMPLETION CODE.               68200022
PERMERR  EQU   X'41'          PERMANENT ERROR ECB CODE.                 68300022
         SPACE 2                                                        68400022
*****************  CCW'S AND RELATED EQUATES  ******************        68500022
RNCCW    DS    0D             CHANNEL COMMAND WORDS                     68600022
         DC    AL1(0)           COMMAND CODE                            68700022
RNCCWAD  DC    AL3(0)           DATA ADDRESS                            68800022
         DC    X'60'            FLAGS                                   68900022
         DC    AL1(0)             --                                    69000022
RNCCWLN  DC    AL2(1025)        COUNT FOR WRITE                         69100022
         SPACE                                                          69200022
NOPCCW   DS    0D             NOP CHANNEL COMMAND IS                    69300022
         DC    AL1(3)           CHAINED TO THE NORMAL                   69400022
         DC    AL3(*)           COMMANDS TO ENSURE                      69500022
         DC    X'20'            DEVICE END IS RETURNED                  69600022
         DC    AL3(1)           BEFORE ECB POSTED.                      69700022
         SPACE                                                          69800022
RNEND    EQU   X'C0'        * TEMPORARY - WILL NEED TO BE *             69900022
*                               MORE EXTENSIVE.                         70000022
****************************************************************        70100022
         SPACE                                                          70200022
**********  CONTROL BLOCKS FOR ASSOCIATED DATA SETS  ***********        70300022
         SPACE                                                          70400022
ECBRN    DC    F'0'       **  ECB FOR EXCP'S TO 27RN.                   70500022
         SPACE                                                          70600022
IOBRN    DS    0F         **  IOB FOR EXCP'S TO 27RN.                   70700022
         DC    X'42'         -COMMAND CHAINING & NOT RELATED.           70800022
         DC    AL1(0)        -FLAGS                                     70900022
IOBSENSE DC    AL2(0)        -SENSE BYTES                               71000022
         DC    AL1(0)        -ECB CODE                                  71100022
         DC    AL3(ECBRN)    -ECB ADDRESS                               71200022
         DC    AL1(0)        -FLAGS                                     71300022
         DC    AL3(0)        -CSW COMMAND ADDRESS.                      71400022
IOBCSWS  DC    AL2(0)        -CSW STATUS BYTES                          71500022
IOBCSWC  DC    AL2(0)        -CSW BYTE COUNT.                           71600022
         DC    AL1(0)        -SIO CODE                                  71700022
         DC    AL3(RNCCW)    -CHANNEL PROGRAM ADDRESS.                  71800022
         DC    AL1(0)        -RESERVED                                  71900022
         DC    AL3(0)                   DCB ADDRESS                     72000022
         DC    AL1(0)        -REPOSITION MODIFIER                       72100022
         DC    AL3(0)        -RESTART ADDRESS.                          72200022
         DC    AL2(0)        -BLOCK COUNT INCREMENT N/A.                72300022
         DC    AL2(0)        -ERROR COUNTS.                             72400022
         DC    AL1(0)        -EXTENT 0 OF DEB.                          72500022
         DC    AL3(0)        -BBCCHHR                                   72600022
         DC    AL4(0)        -(SAME)                                    72700022
* END OF IOB DEFINITION  ***************************************        72800022
         EJECT                                                          72900022
         TCOMD                                                 @Y17XARS 72930000
         TCOMIPLD                                              @Y17XARS 72960000
         EJECT                                                          74500022
         TCCWD                                                          74520000
         EJECT                                                          74540000
         TOCTRD                                                         74560000
         EJECT                                                          74580000
         TAVTD                                                          74600022
         EJECT                                                          74700022
         TOPCAVTD                                                       74800022
         EJECT                                                          74900022
         TOPCED                                                         75000022
         EJECT                                                          75100022
         TPRIOR                                                @Y17XARS 75130000
         EJECT                                                 @Y17XARS 75160000
         TQCBD                                                          75200022
          EJECT                                                         75300022
         TDISPD                                                         75400022
         EJECT                                                          75500022
         TLCBD                                                          75600022
         EJECT                                                          75620022
         DCBD  DSORG=(TR)                                               75640022
         EJECT                                                          75700022
         TPRFD                                                          75800022
         END                                                            75900022
