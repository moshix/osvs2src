         TITLE ' IGCMG10D - 3705 IPL - BUILD LOAD RECORD'               00050022
IGCMG10D CSECT                                                          00100022
************************START OF SPECFICATIONS************************* 00200000
*                                                                     * 00700000
* MODULE NAME = IGCMG10D (TCAM,OPERATOR CONTROL)                      * 01200000
*                                                                     * 01700000
* DESCRIPTIVE NAME = IPL BUILD LOAD RECORD MODULE                     * 02200000
*                                                                     * 02700000
* COPYRIGHT = NONE                                                    * 03200000
*                                                                     * 03700000
* STATUS = VERSION 10.0                                               * 04200000
*                                                                     * 04700000
*    FUNCTION = THIS MODULE CONTAINS   THREE ROUTINES. IN ADDITION TO * 05200000
*    ITS BASIC FUNCTION OF SETTING UP THE OUTPUT BUFFER WITH DATA TO  * 06000022
*    BE SENT TO THE 3705, IT ALSO PERFORMS CESD AND RLD PROCESSING.   * 06100022
*    THE CESD CODE IS ENTERED FROM IGCME10D. AS CONTROL RECORDS ARE   * 06200022
*    READ OFF DISK IGCME10D CHECKS TO SEE IF THE RELOCATE FUNCTION    * 06300022
*    IS IN EFFECT. IT WILL BE IN EFFECT EXCEPT WHEN PROCESSING        * 06400022
*    INITIAL TEST RECORDS, OR WHEN IGCME10D DETECTS                     06500000
*    A CESD CONTROL RECORD AND COMES TO IGCMG10D, IGCMG10D            * 06600000
*    WILL SEARCH CESD RECORDS FOR 'CXTEND' ENTRY. IF DETECTED, FOCUS  * 06700000
*    POINT IS SET AND GAPSIZE IS CALCULATED. FOR RLD RECORDS IT       * 06800022
*    PATCHES ALL RLD ITEMS OF AN RLD RECORD THAT HAVE VALUES GREATER  * 06900022
*    THAN FOCUS POINT.                                                * 07000022
*    IN THE CASE OF CESD PROCESSING IT FIRST GETS THE ID NUMBER FROM  * 07100022
*    THE RECORD POINTED TO BY REGISTER 6. IT THEN CALCULATES ENTRY    * 07200000
*    POINT OF THE MODULE AND SAVES IT IN THE WORKAREA. IT THEN CHECKS * 07300022
*    FOR 'CXTEND' IF NOT EQUAL IT LOOPS LOOKING FOR IT. WHEN FOUND IT * 07400022
*    SETS A FLAG IN INPUTSW TO X'08' AND CHECKS TO SEE IF STORAGE     * 07500000
*    PROTECTION IS REQUIRED. IF NO THE STORAGE PROTECT INDICATOR IS   * 07600022
*    TURNED OFF IN THE WORKAREA AND XCTLS BACK TO IGCME10D.  IF       * 07700022
*    STORAGE PROTECT IS REQUIRED ROUND UP ADDRESS TO 2K BOUNDARY, AND * 07800022
*    SET FLAG IN WORKAREA TO SAY RELOCATE IS REQUIRED.                * 07900022
*    AS IGCME10D READS LOAD MODULE RECORDS AND IT FINDS THAT THE      * 08000000
*    RECORD IS AN RLD RECORD IT XCTLS TO IGCMG10D TO GET THE ADCONS   * 08100022
*    PATCHED. EACH RECORD IS CHECKED TO SEE IF RELOCATE IS REQUIRED   * 08200022
*    IF NOT REQUIRED, THE ENTRY ADDRESS IS LESS THAN THE FOCUS POINT  * 08300022
*    INPUTSW IN THE WORKAREA IS SET TO INDICATE THAT RELOCATE IS NOT  * 08400022
*    REQUIRED ON THIS GROUP OF RLD'S. IF REQUIRED,HOWEVER, INPUTSW IS * 08500022
*    SET TO INDICATE THIS AND THE RELATIVE ADDRESS OF THIS ADCON IS   * 08600022
*    CHANGED TO THE ACTUAL CORE ADDRESS.                              * 08700022
*    IF IGCMG10D IS ENTERED FOR NORMAL OUTPUT PROCESSING, (REGISTER 0 * 08800000
*    EQUAL TO 1) A CHECK IS MADE TO SEE IF INITIAL TEST IS BEING      * 08900000
*    LOADED. IF YES,TURN OFF BRING-UP FLAG, GET BRING-UP START ADDRESS* 09000022
*    THEN SET REG 3 TO POINT TO THE END OF THE OUTPUT BUFFER. NEXT    * 09100022
*    GET SAVED RECORD LENGTH FROM THE WORKAREA AND IF NOT 0 SET REG 7 * 09200022
*    TO POINT TO END OF THE DATA. THE RELATIVE ADDRESS FOR AND THE    * 09300022
*    LENGTH OF THE TEXT ARE IN 'TXTADOR' AND 'TXTLNGTH' WHICH ARE IN  * 09400022
*    THE WORKAREA.                                                    * 09500022
*    THE RECEIVED TEXT IS MOVED TO THE OUTPUT BUFFER AND AS IT IS     * 09600022
*    BUFFER IT IS PASSED VIA XCTL TO IGCMF10D. WHEN THE TEXT RECEIVED * 09700022
*    FROM IGCME10D IS SO HANDLED AN XCTL TO IGCME10D IS MADE FOR THE  * 09800022
*    NEXT INPUT RECORD UNLESS LASTSW HAS BEEN SET BY IGCME10D WHICH   * 09900022
*    INDICATES THAT THIS WAS THE LAST RECORD. IN THIS CASE THE        * 10000022
*    PARTIALLY FILLED BUFFER ( IF ONE) IS PASSED TO IGCMF10D.WHO SENDS* 10100022
*    IT TO THE 3705. IGCMG10D MAINTAINS A COUNT OF THE NUMBER OF BYTES* 10200022
*    RECEIVED FROM IGCME10D. UPON BEGINNING TO PROCESS AN INPUT BLOCK * 10300022
*    THE ASSOCIATED 'TXTADDR' SHOULD EQUAL THIS COUNT. IF NOT THEN    * 10400022
*    THERE WAS A COMPRESSED DATA SET ON THE END OF THE LAST RECORD.   * 10500022
*    THE SIZE OF THE COMPRESSION IS CALCULATED AND THE OUTPUT BUFFER  * 10600022
*    POINTERS ARE ADJUSTED ACCORDINGLY. THEN THE BYTE COUNT IS SET    * 10700022
*    EQUAL TO 'TXTADOR' AND THE PROCESS OF MOVING THE TEXT TO THE     * 10800022
*    OUTPUT BUFFER RESUMES AS NORMAL. IF TXTLNGTH IS ZERO UPON ENTRY  * 10900022
*    THEN THIS INDICATES NO MORE INPUT TO BE PROCESSED. THIS CAUSES   * 11000022
*    THE ENDIN SWITCH TO BE SET. CONTROL IS PASSED TO IGCMF10D TO     * 11100022
*    FLUSH THE FINAL WRITES.                                          * 11200022
*                                                                     * 11201000
* NOTES = SEE BELOW                                                   * 11202000
*                                                                     * 11203000
*    DEPENDENCIES = EBCDIC CHARACTER CODE DEPENDENCIES - CORRECTABLE  * 11204000
*                   BY REASSEMBLY                                     * 11205000
*                                                                     * 11206000
*    RESTRICTIONS = NONE                                              * 11207000
*                                                                     * 11208000
*    REGISTER CONVENTIONS = R1 OPCAVT                                 * 11209000
*                           R2 OPCAVT                                 * 11210000
*                           R7 COMMON WORKAREA                        * 11211000
*                           RB 2ND WORKAREA                           * 11212000
*                           RE OPCE                                   * 11213000
*                                                                     * 11214000
*    PATCH LABEL = NONE                                               * 11215000
*                                                                     * 11216000
* MODULE TYPE =                                                       * 11217000
*                                                                     * 11218000
*    PROCESSOR = ASSEMBLER XF                                         * 11219000
*                                                                     * 11220000
*    ATTRIBUTES = REFRESHABLE,SERIALLY REUSABLE,TRANSIENT (TYPE 4),   * 11221000
*                 SUPERVISOR MODE,REENTRANT                           * 11222000
*                                                                     * 11223000
* ENTRY POINT = IGCMG10D                                              * 11224000
*                                                                     * 11225000
*    PURPOSE = SEE FUNCTION                                           * 11226000
*                                                                     * 11227000
*    LINKAGE = XCTL SF=(E,OPCXCTL)                                    * 11228000
*                                                                     * 11229000
* INPUT = R1 OPCAVT                                                   * 11230000
*           OPCCOPCE- CURRENT ELEMENT                                 * 11231000
*                                                                     * 11232000
* OUTPUT =R1 OPCAVT                                                   * 11233000
*           RD PTR TO END OF OUTPUT BUFFER                            * 11234000
*                                                                     * 11235000
* EXIT-NORMAL = IGCMF10D, IGCME10D                                    * 11236000
*                                                                     * 11237000
* EXIT-ERROR = IGCMI10D                                               * 11238000
*                                                                     * 11239000
* EXTERNAL REFERENCES = SEE BELOW                                     * 11240000
*                                                                     * 11241000
*    ROUTINES = NONE                                                  * 11242000
*                                                                     * 11243000
*    DATA AREAS = COMMON DUMP/IPL WORKAREA                            * 11244000
*                 1ST WORKAREA IPL                                    * 11245000
*                 2ND WORKAREA IPL                                    * 11246000
*                 LOCAL DATA AREA                                     * 11247000
*                                                                     * 11248000
*    CONTROL BLOCKS = AVT                                             * 11249000
*                     OPCAVT                                          * 11250000
*                     OPCE                                            * 11251000
*                                                                     * 11252000
* TABLES = CESD TABLE                                                 * 11253000
*                                                                     * 11254000
* MACROS = XCTL GETMAIN                                               * 11255000
*                                                                     * 11256000
* CHANGE ACTIVITY = AS FOLLOWS :                               @ZA03054 11257058
*-000000-999999                                                @Y17XARS 11257100
*D295500                                                       @ZA03054 11257358
*C505000                                                       @YA06868 11257658
*C118000,C257000,A353000,D354000-355500,C356000,C498000,       @Y17XARS 11257700
*A510000,A836000,D838000-846000,A852000                        @Y17XARS 11257800
*C512000                                                       @OY12420 11258000
*A428000,506000                                                @OZ31840 11258182
*C343000,363000,142000                                         @OZ31840 11258282
*D143000                                                       @OZ31840 11258382
*                                                                     * 11258500
*************************END OF SPECIFICATIONS************************* 11259000
         EJECT                                                          11260000
         SPACE                                                          11300022
         USING DATADS,RB                ADDRESSABILITY FOR C-WKAREA     11400022
         USING IEDQOPCE,RE              ADDRESSABILITY FOR OPCE         11500022
         USING IEDQOPCD,R2              ADDRESSABILITY FOR OPCAVT       11600022
         USING OUTBUF1,R3               ADDRESSABILITY FOR OUTPUT BUFF  11700022
         USING IEDCOM,R7                ADDRESSABILITY FOR     @Y17XARS 11800000
*                                       COMMON AREA                     11850000
         SPACE                                                          11900022
         BALR  RC,0                     ESTABLISH ADDRESSABILITY        12000022
         USING *,RC                                                     12100022
IGCMG10D IEDHJN SKIPID                                                  12200000
         LR    R2,R1                    BASE FOR OPVT                   12600022
         L     RE,OPCCOPCE              GET OPCE OR L-WKAREA            12700022
         L     R7,OCMODNME              SET BASE FOR COMMON AREA        12800022
         LA    RE,COMCCWS               SET BASE FOR LWKAREA            12900022
         LA    RB,DATAOFF(RE)           BASE FOR C-WKAREA               13000022
         TM    EIGHT(RE),REENTRY         REENTERRED FROM IGCMF10D       13100022
         BO    REENTER                  YES                             13200022
         BCT   R0,RLDCESD               EITHER CESD OR RLD PROCESSING   13300022
*                                       IS DESIRED                      13400022
         TM    ZERO(RE),LOADBRUP        1ST BRING-UP RECORD ?           13600022
         BNO   NOTBRUP                  NO                              13700022
         NI    ZERO(RE),BRUPOFF         TURN OFF FLAG                   13800022
         L     R7,REGSAVE(RE)           GET BRUP START ADDR             13900022
         B     AROUND                   SKIP SIMILIAR CODE              14000022
NOTBRUP  EQU   *                                                        14100022
         L     R7,WKBUFSAV(RE)          RELOAD START OF WKBUF  @OZ31840 14200082
AROUND   EQU   *                                                        14400022
         L     R3,OUTBUF(RE)            ADDR OF OUTPUT BUFFER           14500022
         AH    R3,OUTBFSZ               GET END OF OUTPUT BUFFER        14600022
         TM    EIGHT(RE),BRUPFRST       PROCESSING RECORD               14700022
*                                       OUTPUT BUFFER NOT FULL          14800022
         BNO   NOTFIRST                 NO                              14900022
         L     R4,LENSAVE(RE)           PICK UP SAVED LENGTH            15000022
         LA    R4,ZERO(R4)              CLEAR HI-ORDER BYTE             15100022
         NI    EIGHT(RE),OFFBRUP        TURN OFF 1ST TIME SWITCH        15200022
         B     BEGIN                    CONTINUE PROCESSING             15300022
NOTFIRST EQU   *                                                        15400022
         LH    R4,OUTBFSZ               REGS FOR PROCESSING             15500022
         SPACE                                                          15600022
BEGIN    EQU   *                                                        15700022
         LH    R6,TXTLNGTH              GET LENGTH OF THIS TEXT         15800022
         LTR   R6,R6                    IS THE LENGTH ZERO ?            15900022
         BNP   NOINPUT                  YES - NO INPUT                  16000022
         AR    R7,R6                    R7 POINTS TO END OF DATA        16100022
*                                       SET PTRS. TO PROCESS THIS       16200022
*                                       BUFFER ALLOWING                 16300022
         NI    ENDIN,OFFEND             TURN OFF ENDIN SWITCH           16400022
         CLC   TOTLNGTH(THREE),TXTADDR  DO THE LENGTH P ADDR MATCH ?    16500022
         BE    NODS                     YES PROCESS NORMALLY            16600022
         L     R5,TXTADDRW              MUST HAVE A DS. FIND DIFF.      16700022
         LA    R5,ZERO(R5)              AND USE THIS DIFF. TO ADJUST    16800022
         S     R5,TOTLNGTW              OUTPUT BUFFER INDEX             16900022
         SR    R4,R5                    R4 IS NOW ADJUSTED              17000022
         BP    NOTFUL                   DID NOT FILL THE OUTPUT BUFF.   17100022
SENDBUF  EQU   *                        PASS BUFFER TO 3705             17200022
         OI    EIGHT(RE),FIRSTONE       INDICATES RE-ENTERED            17300022
         BAL   R5,PASS                  OUTPUT BUFFER FULL OF DS        17400022
SENDBUF1 EQU   *                                                        17500022
         NI    EIGHT(RE),OFF            TURN OFF BIT INDICATORS         17600022
         LTR   R4,R4                    STILL MORE DS. ?                17700022
         BNP   SENDBUF                  YES SEND THIS BUFFER            17800022
*                                       PASS WILL PROPERLY ADJUST R4    17900022
*                                       BY ADJUSTING BUFFER SIZE        18000022
NOTFUL   EQU   *                                                        18100022
         MVC   TOTLNGTH(THREE),TXTADDR  CORRECT LENGTH DISCREPANCY      18200022
         SPACE                                                          18300022
NODS     EQU   *                                                        18400022
         L     R5,TOTLNGTW              UPDATE TOTAL LENGTH COUNTER     18500022
         AR    R5,R6                    BY THE LENGTH OF THIS           18600022
         ST    R5,TOTLNGTW              TEXT RECORD                     18700022
         SPACE 2                                                        18800022
*  AT THIS POINT THE BUFFERS ARE READY TO PROCESS. R7 POINTS TO *       18900022
*  THE END OF THE WORK  BUFFER. R3 POINTS TO THE END OF THE     *       19000022
*  CURRENT OUTPUT BUFFER.  R4 CONTAINS THE NUMBER OF BYTES      *       19100022
*  REMAINING IN THE OUTPUT BUFFER. R5 WILL BE USED AS THE EX    *       19200022
*  REGISTER FOR THE MVC FROM THE INPUT BUFFER TO THE OUTPUT     *       19300022
*  BUFFER. R6 WILL CONTAIN THE NUMBER OF BYTES REMAINING IN     *       19400022
*  THE INPUT BUFFER TO BE MOVED.                                *       19500022
         SPACE                                                          19600022
GETMORE  EQU   *                                                        19700022
         CH    R6,N256HW                DOES 256 BYTES REMAIN ?         19800022
         BH    STMORE                   YES MORE THAN 256               19900022
         LR    R5,R6                    SET TO MOVE REMAINDER           20000022
         OI    ENDIN,ONEND              INDICATE INPUT EMPTY            20100022
         B     MOVEIT                   GO TO MOVE IT                   20200022
STMORE   EQU   *                                                        20300022
         LH    R5,N256HW                SET TO MOVE 256 BYTES           20400022
         SPACE                                                          20500022
MOVEIT   EQU   *                                                        20600022
         CR    R4,R5                    IS THERE ENOUGH ROOM ?          20700022
         BNL   MOVE                     YES CONTINUE                    20800022
         LR    R5,R4                    NO FILL REMAINDER               20900022
         NI    ENDIN,OFFEND             AND TURN OFF END INDICATOR      21000022
MOVE     EQU   *                                                        21100022
         LR    R8,R7                    SET FROM ADDR OF MVC BY         21200022
         SR    R8,R6                    SUBTRACTING R  6 FROM R8        21300022
         LR    R9,R3                    SET TO ADDR FOR MVC BY          21400022
         SR    R9,R4                    SUBTRACTING R4 FROM R9          21500022
         BCTR  R5,ZERO                  DECREMENT COUNT FOR EXECUTE     21600022
         EX    R5,MVC                   EXECUTE MOVE                    21700022
* DATA HAS BEEN MOVED TO THE OUTPUT BUFFER. THE AMOUNT MOVED    *       21800022
* IS IN R5. NOW THE POINTERS ARE UPDATED TO REFLECT MOVE.       *       21900022
         LA    R5,ONE(ZERO,R5)          ADJUST TO ACTUAL VALUE          22000022
         SR    R6,R5                    ADJUST R6 TO REFLECT MOVE       22100022
         SR    R4,R5                    ADJUST R4 TO REFLECT MOVE       22200022
         BP    NTFULL                   OUTPUT BUFFER NOTFUL            22300022
         OI    EIGHT(RE),SECOND         INDICATES RE-ENTERED            22400022
         BAL   R5,PASS                  PASS FULL BUFFER TO MF          22500022
TSTINBUF EQU   *                                                        22600022
         NI    EIGHT(RE),OFF            TURN OFF BIT INDICATORS         22700022
*                                       RETURN WITH NEW BUFFER          22800022
         TM    ENDIN,ONEND              INPUT BUFFER EMPTY ?            22900022
         BNO   GETMORE                  NO -- GET MORE DATE             23000022
BACK     EQU   *                        INPUT BUFFER IS EMPTY XCTL TO   23100022
*                                       IGCME10D TO GET MORE DATA       23200022
         ST    R4,LENSAVE(RE)           SAVE IT                         23300022
         OI    EIGHT(RE),LENFRST        INDICATE LEN IS SAVED AND       23400022
*                                       PROCESSING 1ST BRING-UP REC     23500022
         LA    R0,TWO                   CONTROL CAME FROM IGCMG10D      23700022
         B     MOVEINPT                 PREPARE TO EXIT                 23800022
         SPACE                                                          23900022
NTFULL   EQU   *                                                        24000022
         TM    ENDIN,ONEND              IS THERE MORE TO GET "          24100022
         BNO   GETMORE                  YES THEN GET IT                 24200022
         TM    LASTSW,ONLAST            WAS THIS THE LAST ?             24300022
         BNO   BACK                     NO RETURN TO IGCME10D           24400022
*                                       PARTIAL BUFFER                  24500022
         B     DONE                     FINISHED                        24600022
         SPACE 2                                                        24700022
NOINPUT  EQU   *                        ZERO LENGTH INDICATING          24800022
         OI    ENDIN,ONEND              NO INPUT (LASTSW IS ALSO ON )   24900022
DONE     EQU   *                        PASS LAST BUFFER TO MF TO       25000022
*                                       FALL THRU TO PASS LAST BUFFER   25100022
         EJECT                                                          25200022
PASS     EQU   *                                                        25300022
         SPACE                                                          25400022
         STM   R3,R9,REGSAVE(RE)        SAVE REGISTERS                  25500022
         LR    R0,R3                    PTR TO END OF OUTPUT BUFFER     25600022
         MVC   OPCMODID,XCTLWRTE        INSERT MOD ID          @Y17XARS 25700000
EXIT     EQU   *                                                        25800022
         LR    R1,R2                    PARAMETER REGISTER              25900022
         XCTL  SF=(E,OPCXCTL)                                           26000022
         SPACE 5                                                        26100022
REENTER  EQU   *                                                        26200022
         LM    R3,R9,REGSAVE(RE)        RESTORE REGISTERS               26300022
         AH    R4,OUTBFSZ               END OF BUFFER                   26400022
         TM    EIGHT(RE),SECOND         FIRST BRANCH POINT              26500022
         BO    TSTINBUF                 NO                              26600022
         B     SENDBUF1                 YES                             26700022
****************************************************************        26800022
         EJECT                                                          26900022
RLDCESD  EQU   *                                                        27000022
*                                       SET UP FOR EITHER CESD OR RLD   27100022
*                                       PROCESSOR                       27200022
         USING INPUTDS,R6               ADDRESSABILITY FOR BUFFER       27300022
         L     R6,INBUFF(RE)            GET ADDR OF BUFFER              27400022
         USING LDATA,RA                 ADDRESSABILITY FOR DATA AREA    27500022
         LA    RA,EIGHTY4(RE)           SET BASE FOR LOCAL DATA AREA    27600022
         USING CESDD,RD                 ADDRESSABILITY FOR CESD TABLE   27700022
         LA    RD,CESDOFF(RE)           SET BASE FOR CESD               27800022
         BCTR  R0,0                     DECREMENT FOR COMPARE           27900022
         LTR   R0,R0                    IF = / CESD PROCESSING          28000022
         BNZ   RLD00                    RLD PROCESSING                  28100022
         SPACE  3                                                       28200022
         LR    R0,R2                    SAVE ADDRESS OF OPCAVT          28300022
*********************************** CESD PROCESSOR *************        28400022
CESD00   EQU   *                                                        28500022
*              THIS ROUTINE SEARCHES A CESD RECORD             *        28600022
*              FOR 'CXTEND' ENTRY.  IF IT FINDS IT             *        28700022
*              THE RELON INDICATOR IS DET AND FOCUSPT          *        28800022
*              IS SET AND GAPSIZE IS CALCULATED.               *        28900022
         SPACE                                                          29000022
         LH    R2,CESDID(R6)            GET FIRST ID NUMBER             29100022
         LA    R7,CESDSTRT(R6)          CALCULATE END POINT             29200022
         AH    R7,CESDCNT(R6)           OF THE DATA                     29300022
         ST    R7,ENDPT(RE)             AND SAVE IT                     29400022
         LA    R7,CESDSTRT(R6)          SET TO BEGINNING                29500000
         SPACE                                                          29600022
CESD10   EQU   *                        PROCESS NEXT ITEM               29700022
         TM    INPUTSW,FOUND            FOUND CXTEND YET ?              29800022
         BO    CESDNXT                  YES                             29900022
         CLC   ZERO(EIGHT,R7),CXTEND    THIS IT ?                       30000022
         BNE   CESDNXT                  NO GET NEXT                     30100022
         OI    INPUTSW,FOUND            INDICATE FOUND                  30200022
         L     R5,CESDAD(R7)            YES                             30300022
         LA    R5,ZERO(R5)              SET FOCUS POINT                 30400022
         C     R5,ENTRYPT               IS STORAGE PROTECT REQUIRED ?   30500022
         BE    CESD30                   NO TURN IT OFF                  30600022
         ST    R5,FOCUSPT               VALUE                           30700022
         CLI   CESDAD+THREE(R7),ZERO    IS A STRETCH REQUIRED ?         30800022
         BNE   CESD20                   YES                             30900022
         TM    CESDAD+TWO(R7),X07       MAYBE NOT                       31000022
         BE    CESD30                   NO TURN IT OFF                  31100022
CESD20   EQU   *                        ROUND UP TO 2K BOUNDARY         31200022
         SRL   R5,ELEVEN                CLEAR RIGHT BITS                31300022
         LA    R5,ONE(R5)               ADD 2K TO GET                   31400022
         SLL   R5,ELEVEN                START OF SECOND PART            31500022
         S     R5,FOCUSPT               CALCULATE GAPSIZE               31600022
         STH   R5,GAPSIZE               AND SAVE IT                     31700022
         CLC   ENTRYPT,FOCUSPT          ENTRY POINT NEED ADJUSTMENT ?   31800022
         BL    CESD22                   NO                              31900022
         A     R5,ENTRYPT               YES - AND GAPSIZE               32000022
         ST    R5,ENTRYPT                                               32100022
CESD22   EQU   *                                                        32200022
         OI   INPUTSW,RELON             INDICATE RELOCATE IN PROGRESS   32300022
         OI    ZERO(RE),CARRYCDE        CARRY OVER                      32400022
         OI    ZERO(RE),STRETCH         STRETCH INDICATED               32500022
         SPACE 4                                                        32600022
CESDNXT  EQU   *                                                        32700022
         NI    CESDTYP(R7),X0F          CLEAR INSIGNIFICANT FLAGS       32800022
         CLI   CESDTYP(R7),X06          IS IT PR OR NULL ?              32900022
         BNL   CESD50                   YES NO ENTRY REQUIRED           33000022
         CLI   CESDTYP(R7),X02          IS IT AN ER ?                   33100022
         BE    CESD50                   YES NO ENTRY REQUIRED           33200022
         L     R3,CURENTRY              GET ADDRESS OF CURRENT ENTRY    33300022
         LTR   R3,R3                    FIRST TIME ?                    33400022
         BZ    GETBLOCK                 YES GO GET A BLOCK              33500022
         CLI   ZERO(R3),ZERO            END OF A BLOCK ?                33600022
         BE    CESDNXT2                 NO CONTINUE                     33700022
         SPACE 2                                                        33800022
GETBLOCK EQU   *                                                        33900022
*            GET A NEW CESD TABLE BLOCK AND PLACE              *        34000022
*            ITBON THE TABLE QUEUE.  UPDATE THE CURRENT        *        34100022
*            ENTRY POINTER...                                  *        34200022
         LR    R9,R2                    SAVE ID ACROSS GETMAIN @OZ31840 34300082
         LR    R2,R0                    RE-ESTABLISH BASE FOR OPCAVT    34400022
         L     R3,OPCOPTLK              GETMAIN LIST IN CA              34500022
         MVC   ONE(THREE,R3),SIZE       LENGTH OF AREA NEEDED           34600022
         LA    R1,OPCDOUBL              PLACE TO PUT ADDR OF AREA       34700022
         ST    R1,FOUR(R3)              PUT IN PARALIST                 34800022
         LR    R1,R3                                                    34900022
         GETMAIN   SP=250,MF=(E,(1))                                    35000000
         LTR   RF,RF                    CORE OBTAINED                   35100022
         BZ    GOTCORE                  YES                             35200022
         LA    R0,MSG164                ERROR MSG NUMBER                35300022
         L     R3,OCTRUNIT              TRAILER ADDRESSABILITY @Y17XARS 35330000
         OI    OCTRRTN-IEDOCTR(R3),OCTRERI SET IPL ERROR FLAG  @Y17XARS 35360000
         MVC   OPCMODID,XCTLMI          ID OF IGCMI10D         @Y17XARS 35600000
         B     EXIT                     XCTL TO IT                      35700022
GOTCORE  EQU   *                                                        35800022
         L     R1,OPCDOUBL              GET CORE ADDR                   35900022
         ST    R1,BLOCKADR              STORE IN BLOCK PTR              36000022
         LR    R0,R2                    SAVE ADDR OF OPCAVT             36200022
         LR    R2,R9                    RESTORE CESD ID        @OZ31840 36300082
         L     R3,BLOCKADR              GET BLOCK ADDRESS               36400022
         XC    ZERO(SIXTY4,R3),ZERO(R3)  CLEAR THE BLOCK                36500022
         MVI   SIXTY(R3),STOPPER        SET THE END-OF-BLOCK FLAG       36600022
         ST    R3,CURENTRY              SET CURRENT ENTRY PTR           36700022
         L     R4,LASTBLK               GET POINTER TO LAST BLOCK       36800022
         LTR   R4,R4                    IS THIS THE FIRST TIME ?        36900022
         BNZ   GETBLK2                  NO CHAIN IT                     37000022
         ST    R3,FIRSTBLK              YES SET FIRST BLOCK PTR         37100022
         ST    R3,BLKSAVE(RE)           SAVE 1ST BLOCK ADDRESS          37150000
         B     GETBLK3                  CONTINUE                        37200022
GETBLK2  EQU   *                                                        37300022
         ST    R3,SIXTY(R4)             CHAIN IT                        37400022
         MVI   SIXTY(R4),STOPPER                                        37500022
GETBLK3  EQU   *                                                        37600022
         ST    R3,LASTBLK               SET NEW LAST BLOCK PTR          37700022
****************************************************************        37800022
         SPACE 2                                                        37900022
CESDNXT2 EQU   *                        PLACE THE DATA IN THE ENTRY     38000022
         STH   R2,FOUR(R3)              PUT ID IN ENTRY                 38100022
         MVC   ONE(THREE,R3),NINE(R7)      MOVE ADDRESS TO ENTRY        38200022
         MVI   ZERO(R3),INUSE           INDICATE ENTRY IN USE           38300022
         LA    R3,SIX(R3)               INCREMENT TO  THE NXT ENTRY     38400022
         ST    R3,CURENTRY              SAVE NEXT ENTRY POINTER         38500022
CESD50   EQU   *                                                        38600022
         LA    R2,ONE(R2)               INCREMENT ID COUNTER            38700022
         LA    R7,SIXTEEN(R7)           GO TO NEXT ITEM                 38800022
         C     R7,ENDPT(RE)             DONE YET ?                      38900022
         BL    CESD10                   NO                              39000022
         B     CESD28                   YES RETURN                      39100022
CESD30   EQU   *                        NO RELOCATE REQUIRED            39200022
         NI    ZERO(RE),SQUELCH         NO RELOCATE PROCESSING          39300022
         SPACE 4                                                        39400022
CESD28   EQU   *                        RETURN                          39500022
         LR    R2,R0                    OPCAVT BASE                     39600022
         LA    R0,THREE                 INDICATES CONTROL CAME FROM     39700022
*                                       CESD PROCESSOR IN OUTPUT RTN    39800022
         SPACE 3                                                        39900022
MOVEINPT EQU   *                                                        40000022
         SPACE 3                                                        40100022
         MVC   OPCMODID,XCTLIPUT                               @Y17XARS 40200000
         B     EXIT                     PREPARE TO EXIT TO INPUT RTN    40300022
         SPACE                                                          40400022
CESDSTRT EQU   8                        START OF CESD DATA              40500022
CESDCNT  EQU   6                        COUNT OF CESD DATA              40600022
CESDAD   EQU   8                        ADDRESS OF CESD ITEM            40700022
CESDID   EQU   4                        ESDID OF FIRST ITEM             40800022
CESDTYP  EQU   8                        CESD TYPE FIELD                 40900022
         SPACE                                                          41000022
         SPACE                                                          41100022
CXTEND   DC    CL8'CXTEND'              UNIQUE RELOCATE ENTRY           41200022
*********************************** END OF CESD PROCESSOR ******        41300022
         EJECT                                                          41400022
*********************************** RLD PROCESSOR **************        41500022
RLD00    EQU   *                                                        41600022
*              THIS ROUTINE PATCHES ALL RLD ITEMS              *        41700022
*               OF AN RLD RECORD THAT HAVE VALUES               *       41800022
*              GREATER THAN FOCUS POINT.  THE ADDRESS          *        41900022
*              OF THE RLD RECORD IS IN R7 WITH THE             *        42000022
*               APPROPRIATE SETTING IN TXTADDRW.                *       42100022
         SPACE                                                          42200022
         LR    RF,R2                    SAVE VALUE OF OPCAVT            42300022
         SR    R2,R2                    CLEAR A WORK REG                42400022
         LA    R1,RLDSTRT(R6)           CALCULATE THE END               42500022
         AH    R1,RLDCNT(R6)            OF THE RLD DATA                 42600022
         ST    R1,ENDPT(RE)             AND SAVE IT                     42700022
         LA    R1,RLDSTRT(R6)           POINT TO FIRST ITEM             42800022
         L     R7,WKBUFSAV(RE)          RELOAD START OF WKBUF  @OZ31840 42850082
         B     RLD18                    GO CHECK FOR RELOCATE           42900022
         SPACE                                                          43000022
RLD10    EQU   *                                                        43100022
         TM    INPUTSW,RELGRP           THIS GROUP NEED RELOCATED       43200022
         BO    RLDNXT                   NO CONTINUE                     43300022
         TM    ZERO(R1),NOREL           THIS ONE TO BE PROCESSED ?      43400022
         BO    RLDNXT                   NO GO TO NEXT                   43500022
         L     R5,ZERO(R1)              GET RELATIVE ADDRESS            43600022
         LA    R5,ZERO(R5)              OF THIS ADCON                   43700022
         S     R5,TXTADDRW              CALCULATE ACTUAL                43800022
         AR    R5,R7                    CORE ADDRESS                    43900022
         NI    ZERO(R1),CLEAR           CLEAR XXXX BITS                 44000022
         IC    R2,ZERO(R1)              AND GET ADCON SIZE MINUS 1      44100022
         SRL   R2,TWO                   IN RIGHT BYTE                   44200022
         LA    R4,WORD+THREE(RE)        CALCULATE MOVE                  44300022
         SR    R4,R2                    TO ADDRESS                      44400022
         XC    WORD(FOUR,RE),WORD(RE)            CLEAR PATCH WORD       44500022
         EX    R2,GETCON                GET THE ADCON                   44600022
         L     R6,WORD(RE)              GET VALUE                       44700022
         TM    ZERO(R1),NEGATIVE        IS IT NEGATIVE                  44800022
         BNO   RLD15                    ADD......                       44900022
         SH    R6,GAPSIZE               YES SUBTRACT                    45000022
         B     RLD16                    CONTINUE                        45100022
RLD15    EQU   *                                                        45200022
         AH    R6,GAPSIZE               YES ADD GAPSIZE                 45300022
RLD16    EQU   *                                                        45400022
         ST    R6,WORD(RE)              SET TO RETURN IT                45500022
         EX    R2,PUTCON           PUT NES VALUE IN TEXT.               45600022
         SPACE                                                          45700022
RLDNXT   EQU   *                        GET THE NEXT ONE                45800022
         TM    ZERO(R1),RLDTYP          NEXT RLD HAVE R/P FIELD ?       45900022
         BO    RLD20                    NO UPDATE ONLY 4                46000022
         LA    R1,FOUR(R1)              YES UPDATE 8 BYTES              46100022
RLD18    EQU   *                        BEGINNING OF A NEW GROUP        46200022
         L     R3,FIRSTBLK              GET POINTER TO 1ST ENTRY        46300022
RLD18A   EQU   *                                                        46400022
         CLI   ZERO(R3),INUSE           THIS A VALID ENTRY ?            46500022
         BNE   RLD18B                   NO                              46600022
         CLC   ZERO(TWO,R1),FOUR(R3)    YES DO ID'S MATCH ?             46700022
         BE    RLD19                    YES GO TEST FOR RELOCATE        46800022
         LA    R3,SIX(R3)               GO TO NEXT ENTRY                46900022
         B     RLD18A                   AND CONTINUE THE SEARCH         47000022
         SPACE                                                          47100022
RLD18B   EQU   *                                                        47200022
         CLI   ZERO(R3),STOPPER         IS THIS THE END OF A BLOCK ?    47300022
         BNE   RLD19A                   NO END OF TABLE - NO MATCH      47400022
         L     R3,ZERO(R3)              GET ADDRESS OF NEXT BLOCK       47500022
         LA    R3,ZERO(R3)              CLEAR HI-ORDER BYTE             47600022
         LTR   R3,R3                    IS THERE ANYMORE                47700022
         BZ    RLD19A                   NO END OF TABLE - NO MATCH      47800022
         B     RLD18A                    YES CONTINUE SEARCH            47900022
         SPACE                                                          48000022
RLD19    EQU   *                                                        48100022
         CLC   ONE(THREE,R3),FOCUSPT+ONE RELOCATE FOR THIS GROUP REQ?   48200022
         BL    RLD19A                   NO                              48300022
         NI    INPUTSW,ONES-RELGRP      YES - INDICATE THAT             48400022
         B     RLD20                    CONTINUE                        48500022
         SPACE                                                          48600022
RLD19A   EQU   *                                                        48700022
         OI    INPUTSW,RELGRP           INDICATE REL. NOT REQ. ON THIS  48800022
*                                       PARTICULAR GROUP OF RLDS        48900022
         SPACE                                                          49000022
RLD20    EQU   *                                                        49100022
         LA    R1,FOUR(R1)                                              49200022
         C     R1,ENDPT(RE)             IS THIS THE END ?               49300022
         BL    RLD10                    NO - GO PROCESS THE NEXT        49400022
         LR    R2,RF                    OPCAVT BASE                     49500022
         LA    R0,FOUR                  INDICATES CONTROL CAME FROM     49600022
*                                       RLD PROCESSOR IN OUTPUT         49700022
         MVC   OPCMODID,XCTLIPUT                               @Y17XARS 49800000
         B     EXIT                     PREPARE TO EXIT TO INPUT RTN    49900022
         SPACE                                                          50000022
GETCON   EQU   *                                                        50100022
         MVC   ZERO(ZERO,R4),ZERO(R5)         GET ADCON INSTRUCTION     50200022
PUTCON   EQU   *                                                        50300022
         MVC   ZERO(ZERO,R5),ZERO(R4)   PUT ADCON INSTR.                50400022
LENSAVE  EQU   100                      PLACE TO SAVE LENGTH   @YA06868 50500058
WORKBUF  EQU   36                       OFFSET TO ADDR OF WORK BUFFER   50600022
WKBUFSAV EQU   168                      OFFSET-WKBUF@ SAVEAREA @OZ31840 50650082
OFF      EQU   X'3F'                          MASK TO TURN OFF BITS     50700022
REENTRY  EQU   X'80'                    1ST BRANCH POINT                50800022
MSG164   EQU   164                      NOT ENOUGH CORE AVAIL ERR MSG   50900022
XCTLMI   DC    C'MI'                    COMMON EXIT ROUTINE    @Y17XARS 50950000
WORD     EQU   104                      PATCH WORD                      51100022
ENDPT    EQU   108                      END POINT OF RECORD    @OY12420 51200000
BRUPFRST EQU   X'20'                    UST BRING-UP RECORD             51300022
OFFBRUP  EQU   X'DF'                    TURN OFF 1ST BRUP INDICATOR     51400022
LENFRST  EQU   X'20'                    LEN OF RECORD MASK              51500022
RLDSTRT  EQU   16                       START OF RLD DATA               51600000
RLDCNT   EQU   6                        COUNT OF RLD DATA               51700000
NOREL    EQU   X'80'                    DON'T RELOCATE INDICATOR        51800022
NEGATIVE EQU   X'02'                    NEGATIVE RELOCATE FLAG          51900022
CLEAR    EQU   X'0F'                    CLEAR XXXX MASK                 52000022
RLDTYP   EQU   X'01'                    TYPE INDICATOR IN RLD ITEM      52100022
         SPACE                                                          52200022
*********************************** END OF RLD PROCESSOR *******        52300022
         SPACE                                                          52400022
         SPACE                                                          52500022
******************* END OF EXECUTABLE CODE *********************        52600022
         EJECT                                                          52700022
******************* LOCAL DATA AND DSECTS **********************        52800022
         SPACE                                                          52900022
MVC      MVC   ZERO(ZERO,R9),ZERO(R8)  MOVE FOR EXECUTE..               53000022
         SPACE                                                          53100022
         SPACE                                                          53200022
XCTLWRTE DC    C'MF'                    IF OF IFLWRITE MOD              53300022
SIZE     DC    X'000040'                SIZE OF AREA NEEDED             53400022
CARRYCDE EQU   X'02'                    HEX 02                   S22024 53500000
STRETCH  EQU   X'08'                    HEX 08                   S22024 53600000
XCTLIPUT DC    C'ME'                    ID OF 'INPUT' RTN               53700022
EIGHTY4  EQU   84                       EIGHTY4                  S22024 53800000
SECOND   EQU   X'C0'                    SECOND ENTRY POINT              53900022
FIRSTONE EQU   X'80'                    FIRST ENTRY POINT               54000022
X07      EQU   X'07'                    HEX 07                   S22024 54100000
X0F      EQU   X'0F'                    HEX 0F                   S22024 54200000
X06      EQU   X'06'                    HEX 06                   S22024 54300000
X02      EQU   X'02'                    HEX 02                   S22024 54400000
SIXTY4   EQU   64                       LENGTH TO CLEAR                 54500022
SIXTY    EQU   60                       OFFSET                          54600022
SIXTEEN  EQU   16                       SIXTEEN                  S22024 54700000
INBUFF   EQU   32                       OFFSET IN L-WK TO INPUT BUFF    54800022
LOADBRUP EQU   X'10'                    MASK FOR 1ST BRUP RECORD        54900022
BRUPOFF  EQU   X'EF'                    MASK TO TURN OFF 1ST BRUP REC   55000022
REGSAVE  EQU   96                       REGISTER SAVEAREA IN L-WKAREA   55100022
CLNUPPRI EQU   X'88'                    CLEAN UP INDICATOR TO MH        55200022
AUTOIPL  EQU   X'DF'                    PRIORITY OF AUTO-IPL ELEMENT    55250022
DATAOFF  EQU   184                      START OF C-WKAREA               55300022
OUTBUF   EQU   28                       OFFSET IN L-WKAREA TO ADDR      55400022
*                                       OF OUTPUT BUFFER                55500022
OUTBUF1  DSECT                                                          55600022
         DS    256H                     TEXT AREA                       55700022
         SPACE                                                          55800022
         SPACE                                                          55900022
******************** CESD TABLE QUEUE AND ASSOCIATED VALUES ****        56000022
CESDD    DSECT                                                          56100022
****************************************************************        56200022
FIRSTBLK DS    AL4                      FIRST BLOCK PTR                 56300022
LASTBLK  DS    AL4                      LAST BLOCK PTR                  56400022
CURENTRY DS    AL4                      CURRENT ENTRY PTR               56500022
INUSE    EQU   X'01'                    THIS ENTRY IS IN USE            56600022
STOPPER  EQU   X'80'                    THIS IS THE END OF THE BLOCK    56700022
BLKSAVE  EQU   X'160'                   SAVEAREA IN COMMON AREA         56720000
*                                       FOR 1ST BLOCK IN CESD           56740000
*                                       PROCESSING                      56760000
BLOCKADR DS    AL4                      ADDR OF BLOCK FROM GETMAIN      56800022
CESDOFF  EQU   40                       OFFSET IN L-WKAREA TO CESD TABL 56900022
DECBOFF  EQU   56                       OFFSET TO DECB IN L-WKAREA      57000022
CESDRLD  EQU   X'10'                    CESD AND RLD HANDLING           57100022
CXTENDBT EQU   X'20'                    CXTEND PRESENT                  57200022
RELOC    EQU   X'40'                    INDIATES TO TRY RELOCATE        57300022
NOOP     EQU   X'80'                    INDICATES NO BRING-UP           57400022
SQUELCH  EQU   X'BF'                    NO RELOCATE BUT DO BRING-UP     57500022
DOBRUP   EQU   X'EF'                    INDICATE TO DO BRING-UP         57600022
         SPACE  3                                                       57700022
LDATA    DSECT                                                          57800022
INPUTSW  DS    X                        INPUT SWITCH             S22024 57900000
FIRST    EQU   X'80'                    THIS IS THE 1ST TEXT            58000000
CARRY    EQU   X'40'                    A CORRY CONDITION EXISTS        58100000
BYFOCUS  EQU   X'20'                    BEYOND THE FOCUS POINT          58200000
RELON    EQU   X'10'                    RELOCATE IS REQUIRED            58300000
RELGRP   EQU   X'04'                    NO RELOCATE ON THIS GROUP       58400000
FOUND    EQU   X'08'                    CXTEND HAS BEEN FOUND           58500000
NOP      EQU   X'00'                    NOP FOR BYPASSX SWITCHES        58600000
BRANCH   EQU   X'F0'                    BRANCH FOR BYPASSX SWITCHES     58700000
         SPACE                                                          58900022
         DS    AL3                      THREE BYTS               S22024 59000000
FOCUSPT  DS    AL4                      FOUR BYTS                S22024 59100000
GAPSIZE  DS    AL2                      GAP SIZE                 S22024 59200000
SAVEIT   DS    AL2                      SAVE IT                  S22024 59300000
         SPACE  3                                                       59400022
INPUTDS  DSECT                                                          59500022
LMTYPE   DC    AL1(0)                   TYPE INDICATOR FOR LOAD         59600000
*                                       MODULE RECORD                   59700000
CONTROL  EQU   X'01'                    INDICATOR FOR CONTROL REC.      59800000
ENDOF    EQU   X'0C'                    INDICATOR FOR END OF L.M.       59900000
CESD     EQU   X'20'                    INDICATOR FOR CESD RECORD       60000000
RLD      EQU   X'02'                    INDICATOR FOR RLD RECORD        60100000
         ORG   *+8                      N/A                             60200000
INADDR   DC    AL3(0)                   RELATIVE ADDR. FO FOLLOWING     60300000
*                                       TEXT RECORD                     60400000
         ORG   *+12                     N/A                             60500000
COUNT    DC    AL2(0)                   NUMBER OF BYTES IN THE          60600000
*                                       FOLLOWING TEXT RECORD           60700000
         SPACE                                                          60800022
         EJECT                                                          60900022
DATADS   DSECT                                                          61000022
****************************************************************        61100022
*        REGISTER AND NUMBER EQUATES                                    61200000
R0       EQU   0                                                        61300022
R1       EQU   1                                                        61400022
R2       EQU   2                                                        61500022
R3       EQU   3                                                        61600022
R4       EQU   4                                                        61700022
R5       EQU   5                                                        61800022
R6       EQU   6                                                        61900022
R7       EQU   7                                                        62000022
R8       EQU   8                                                        62100022
R9       EQU   9                                                        62200022
RA       EQU   10                                                       62300022
RB       EQU   11                                                       62400022
RC       EQU   12                                                       62500022
RD       EQU   13                                                       62600022
RE       EQU   14                                                       62700022
RF       EQU   15                                                       62800022
         SPACE                                                          62900022
         SPACE                                                          64500022
ZERO     EQU   0                                                        64600022
ONE      EQU   1                                                        64700022
TWO      EQU   2                                                        64800022
THREE    EQU   3                                                        64900022
FOUR     EQU   4                                                        65000022
FIVE     EQU   5                                                        65100022
SIX      EQU   6                                                        65200022
SEVEN    EQU   7                                                        65300022
EIGHT    EQU   8                                                        65400022
NINE     EQU   9                                                        65500022
TEN      EQU   10                                                       65600022
ELEVEN   EQU   11                                                       65700022
TWELVE   EQU   12                                                       65800022
         SPACE 2                                                        65900022
****************************************************************        66000022
**    MISCELLANEOUS  EQUATES  AND CONSTANTS                   **        66100022
         SPACE                                                          66200022
BIT10    EQU   X'10'          TEST FOR OPEN IN DCB                      66300022
IFLGSD   EQU   49             DCB IFLGS DISPLACEMENT                    66400022
NOERRTN  EQU   X'0C'          INDICATE NO SYS ERROR RTNS.               66500022
UCBCA    EQU   19             UCB DISP OF CA INDICATOR.                 66600022
MINICA   EQU   X'15'          MINI CA INDICATOR IN UCB.                 66700022
         SPACE                                                          66800022
ABORTVAL EQU   12             ABORT RET CODE THRESHOLD.                 66900022
RETCODE  DC    H'0'                RETURN CODE.                         67000022
MAXRC    DC    H'0'          MAXIMUM RETURN CODE SET.                   67100022
RNDDN    DC    C'        '    RN DDNAME                                 67200022
RNADR    DC    C'   '              UNIT ADDRESS AREA.                   67300022
ENTRYPT  DC    F'0'           ENTRY POINT FOR LOAD.                     67400022
ARADDR   EQU   12             DECB AREA ADDR. DISP.                     67500022
RNSWITCH EQU   X'14'         DISP OF SWITCH IN DIAG PHASE 1.            67600022
SIXTBIT  EQU   X'01'         SIXTEEN BIT INDICATOR.                     67700022
ALIASIND EQU   X'80'          THIS IS AN ALIAS-INDICATOR.  BLDL         67800022
RENREUS  EQU   X'C0'          REENTRANT & REUSABLE         BLDL         67900022
ABORT    EQU   X'03'          ABORT SENSE INDICATORS.                   68000022
         DS    0H                                                       68100022
TXTLNGTH DC    H'0'           LENGTH OF TEXT RECORD                     68200022
         DS    0F                                                       68300022
TOTLNGTW DC    AL1(0)         TOTAL LENGTH OF DATA                      68400022
TOTLNGTH DC    AL3(0)         TRANSFERRED                               68500022
         DS    0F                                                       68600022
TXTADDRW DC    AL1(0)         ADDRESS (REL TO ZERO) OF                  68700022
TXTADDR  DC    AL3(0)         THIS TEXT RECORD.                         68800022
         SPACE                                                          68900022
N256HW   DC    H'256'         MAXIMUM MVC COUNT                         69000022
INBUFSZ  DC    H'1024'        SIZE OF INPUT BUFFER                      69100022
OUTBFSZ  DC    H'512'         SIZE OF OUTPUT BUFFER.                    69200022
DOUBLE   DC    D'0'           DOUBLE WORD WORK AREA                     69300022
LINECNT  DC    H'0'           LINE COUNT FOR OUTPUT                     69400022
MAXLIN   DC    H'52'          MAXIMUM LINES PER PAGE.                   69500022
N4H      DC    H'4'           FOUR CONSTANT                             69600022
         SPACE                                                          69700022
**   BLDL  LIST  FOR  LOAD  MODULE  DATA  SET                 **        69800022
         DS    0H                                                       69900022
BLDLIST  DC    H'1'           ONE ENTRY IN THIS LIST.                   70000022
         DC    H'58'          EACH ENTRY IS 58 BYTES LONG               70100022
MEMBER   EQU   *              MEMBER NAME PLACE HERE.                   70200022
         DS    CL8                      EIGHT BYTS               S22024 70300000
RALTTRK  DC    4X'00'              USED IN FIND                         70400022
*                                                                       70500022
Z        DC    X'00'          FLAG BYTE                                 70600022
C        DC    X'00'          FLAG BYTE                                 70700022
         ORG   MEMBER+22                                                70800022
ATTRIB   EQU   *              ATTRIBUTE FIELD                           70900022
         ORG   MEMBER+29                                                71000022
EPAMEM   EQU   *              ENTRY PT IF MEMBER DIR.ENTRY.             71100022
         ORG   MEMBER+43                                                71200022
EPAALS   EQU   *              ENTRY PT IF ALIAS DIR.ENTRY.              71300022
         ORG   MEMBER+58                                                71400022
         SPACE                                                          71500022
MAXIVT   EQU   *                                                        71600022
         DC    V(CXWMAXI1)         ADDRESS OF MAXI PHASE 1              71700022
         DC    V(CXWMAXI2)         ADDRESS OF MAXI PHASE 2..            71800022
         SPACE                                                          71900022
MINIVT   EQU   *                                                        72000022
         DC    V(CXWMINI1)         ADDRESS OF MINI PHASE 1              72100022
         DC    V(CXWMINI2)         ADDRESS OF MINI PHASE 2..            72200022
         SPACE                                                          72300022
PHASPTR  DC    A(MAXIVT)           PHASE VECTOR TABLE PTR..             72400022
PHASCNT  DC    H'8'                NUMBER OF PHASES TIMES FOUR..        72500022
MAXIPH1  DC    V(CXWMAXI1)         ADDRESS OF MAXI PHASE 1.             72600022
MINIPH1  DC    V(CXWMINI1)         ADDRESS OF MINI PHASE 1.             72700022
MAXIBUPH DC    CL8'IFL3705B'       NAME OF DIAG MAXI PHASE 1.           72800022
MINIBUPH DC    CL8'IFL3705A'       NAME OF DIAG MINI PHASE 1.           72900022
         SPACE                                                          73000022
*                               *                              *        73100022
****************************************************************        73200022
***      SWITCHES AND TEST EQUATES                            **        73300022
         SPACE                                                          73400022
SWITCH   EQU   *         * SWITCH BYTE *                                73500022
         SPACE                                                          73600022
SW1      EQU   *          INDICATES ONE PARM PROCESSED                  73700022
ON1      EQU   X'80'          TURN ON SW1                               73800022
OFF1     EQU   X'7F'          TURN OFF SW1                              73900022
         SPACE                                                          74000022
TXTSW    EQU   *            INDICATES TEXT RECORD IN NEXT BUFFER        74100022
ONTXT    EQU   X'40'          TURN ON TXTSW                             74200022
OFFTXT   EQU   X'BF'          TURN OFF TXTSW                            74300022
         SPACE                                                          74400022
LASTSW   EQU   *            INDICATES LAST TEXT RECORD                  74500022
ONLAST   EQU   X'20'          TURN ON LASTSW                            74600022
         SPACE                                                          74700022
ENDIN    EQU   *            INDICATES INPUT BUFFER IS EMPTY.            74800022
ONEND    EQU   X'10'          TURN ON ENDIN.                            74900022
OFFEND   EQU   X'EF'          TURN OFF ENDIN.                           75000022
         SPACE                                                          75100022
IPLSW    EQU   *            INDICATES BOOTSTRAP IS TO BE SENT           75200022
ONIPL    EQU   X'08'          TURN ON IPLSW.                            75300022
OFFIPL   EQU   X'F7'          TURN OFF IPLSW.                           75400022
         SPACE                                                          75500022
IOPEND   EQU   *            INDICATES AN EXCP IS OUTSTANDING.           75600022
ONIO     EQU   X'04'          TURN ON IOPEND                            75700022
OFFIO    EQU   X'FB'          TURN OFF IOPEND                           75800022
         SPACE                                                          75900022
ERRENT   EQU   *            INDICATES ERROR RTN HAS BEEN ENTERED        76000022
ONENT    EQU   X'02'          TURN ON ERRENT.                           76100022
         SPACE                                                          76200022
BUFFERSW EQU   *                 INDICATES PRIMING OF BUFFERS..         76300022
BUFSW    EQU   X'01'                    BUFF SWITCH              S22024 76400000
         SPACE                                                          76500022
ONES     EQU   X'FF'          USED IN SWITCH MANIPULATIONS.             76600022
         SPACE                                                          76700022
         DC    AL1(0)      * ACTUAL SWITCH BYTE *                       76800022
         SPACE 2                                                        76900022
SWITCH2  EQU   *                                                        77000022
CASW     EQU   *                                                        77100022
         SPACE                                                          77200022
LOADFLG  EQU   X'80'          LOADMOD KEYWORD PROCESSED.                77300022
UNITFLG  EQU   X'40'          UNIT    KEYWORD PROCESSED.                77400022
DIAGFLG  EQU   X'20'          DIAG    KEYWORD PROCESSED.            BUP 77500022
DIAGOK   EQU   X'10'          BRING-UP COMPLETED INDICATOR.         BUP 77600022
ONCA     EQU   X'01'               ON INDICATING MINI CA.               77700022
COMPLETE EQU   X'02'          LAST WRITE JUST ISSUED.                   77800022
NXTPHS   EQU   X'04'          NEXT PHASE REQUEST.                       77900022
         SPACE                                                          78000022
         DC    AL1(0)          * ACTUAL SWITCH2 BYTE *                  78100022
         SPACE                                                          78200022
DIAGIND  DC    C'Y6'              INITIAL-TEST INDICATOR.               78300022
DIAGDEF  DC    C'Y6'               DEFAULT DIAG VALUE.                  78400022
CHARN    EQU   C'N'           NO BRING-UP INDICATOR.                BUP 78500022
         SPACE 2                                                        78600022
WARN     DC    AL1(0)        BYTE USED FOR WARNING INDICATORS           78700022
RNFULL   EQU   X'80'            RN IS FULL WARNING                      78800022
         SPACE                                                          78900022
GOODCODE EQU   X'7F'          NORMAL ECB COMPLETION CODE.               79000022
PERMERR  EQU   X'41'          PERMANENT ERROR ECB CODE.                 79100022
         SPACE 2                                                        79200022
*****************  CCW'S AND RELATED EQUATES  ******************        79300022
RNCCW    DS    0D             CHANNEL COMMAND WORDS                     79400022
         DC    AL1(0)           COMMAND CODE                            79500022
RNCCWAD  DC    AL3(0)           DATA ADDRESS                            79600022
         DC    X'60'            FLAGS                                   79700022
         DC    AL1(0)             --                                    79800022
RNCCWLN  DC    AL2(1025)        COUNT FOR WRITE                         79900022
         SPACE                                                          80000022
NOPCCW   DS    0D             NOP CHANNEL COMMAND IS                    80100022
         DC    AL1(3)           CHAINED TO THE NORMAL                   80200022
         DC    AL3(*)           COMMANDS TO ENSURE                      80300022
         DC    X'20'            DEVICE END IS RETURNED                  80400022
         DC    AL3(1)           BEFORE ECB POSTED.                      80500022
         SPACE                                                          80600022
RNEND    EQU   X'C0'        * TEMPORARY - WILL NEED TO BE *             80700022
*                               MORE EXTENSIVE.                         80800022
****************************************************************        80900022
         SPACE                                                          81000022
**********  CONTROL BLOCKS FOR ASSOCIATED DATA SETS  ***********        81100022
         SPACE                                                          81200022
ECBRN    DC    F'0'       **  ECB FOR EXCP'S TO 27RN.                   81300022
         SPACE                                                          81400022
IOBRN    DS    0F         **  IOB FOR EXCP'S TO 27RN.                   81500022
         DC    X'42'         -COMMAND CHAINING & NOT RELATED.           81600022
         DC    AL1(0)        -FLAGS                                     81700022
IOBSENSE DC    AL2(0)        -SENSE BYTES                               81800022
         DC    AL1(0)        -ECB CODE                                  81900022
         DC    AL3(ECBRN)    -ECB ADDRESS                               82000022
         DC    AL1(0)        -FLAGS                                     82100022
         DC    AL3(0)        -CSW COMMAND ADDRESS.                      82200022
IOBCSWS  DC    AL2(0)        -CSW STATUS BYTES                          82300022
IOBCSWC  DC    AL2(0)        -CSW BYTE COUNT.                           82400022
         DC    AL1(0)        -SIO CODE                                  82500022
         DC    AL3(RNCCW)    -CHANNEL PROGRAM ADDRESS.                  82600022
         DC    AL1(0)        -RESERVED                                  82700022
         DC    AL3(0)                   DCB ADDRESS                     82800022
         DC    AL1(0)        -REPOSITION MODIFIER                       82900022
         DC    AL3(0)        -RESTART ADDRESS.                          83000022
         DC    AL2(0)        -BLOCK COUNT INCREMENT N/A.                83100022
         DC    AL2(0)        -ERROR COUNTS.                             83200022
         DC    AL1(0)        -EXTENT 0 OF DEB.                          83300022
         DC    AL3(0)        -BBCCHHR                                   83400022
         DC    AL4(0)        -(SAME)                                    83500022
* END OF IOB DEFINITION  ***************************************        83600022
         EJECT                                                          83700022
         TCOMD                                                 @Y17XARS 83730000
         TCOMIPLD                                              @Y17XARS 83760000
         EJECT                                                          84700022
         TOPCED                                                         84800022
         EJECT                                                          84900022
         TOPCAVTD                                                       85000022
         EJECT                                                          85100022
         TAVTD                                                          85200022
         EJECT                                                 @Y17XARS 85230000
         TOCTRD                                                @Y17XARS 85260000
         END                                                            85300022
