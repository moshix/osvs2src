         TITLE 'IGCR010D - OPERATOR CONTROL RELEASE TERMINAL MODULE'    00300022
IGCR010D CSECT                                                          00600022
*A000000-999999                                                @Y16X5RR 00610000
         SPACE 3                                                        00620000
* CHANGE ACTIVITY=AS FOLLOWS:                                           00640000
******************* MICROFICHE FLAGS ************************ SPT CODE  00660000
*A081200-083800,262000,417600-425400,876007-878933               Y05330 00680005
*A000000-999999                                                  S99240 00700022
*A781401                                                        SA61821 00700100
*A380000,006000                                                 SA58991 00700200
*C007000-008200,015000,159000,168000,549000,580000              SA58991 00700300
*A 327000                                                       OX02177 00700452
*C 636000                                                       OX02177 00700552
*A380600-380700,581060-581420                                    Y06330 00700605
*C877197,877204,877232,877239                                   SA66358 00740654
*C576000                                                        SA66617 00780654
*D360000                                                        SA66617 00820654
*A570000                                                        OX03970 00840605
*D576000-581000                                                 OX03970 00860605
*A591000                                                       @SA70887 00870656
*A159000,177000,276000,285000,288000,291000,297000,438000      @Y17XARR 00873600
*A447000,477000,504000,513000,571800,852000,861000,921000      @Y17XARR 00876600
*A006000                                                       @Y17XARR 00879600
*C012000,017000,021000,078000,096000,183000,534000,558000      @Y71XARR 00882600
*C570800,573000,581120,581160,581240,602000,780300,780200      @Y17XARR 00885600
*C781500,787000,846000                                         @Y17XARR 00888600
*D417600-425400,876637,878870,878884,878891,878926,878933      @Y17XARR 00891600
*D903000,909000                                                @Y17XARR 00894600
*A508300                                                       @OY19901 00894782
*A526320,527120,289000                                         @OZ27690 00894882
*********************************************************************** 00900022
*                                                                     * 01200022
* MODULE-NAME=IGCR010D(TCAM, OPERATOR CONTROL)                @Y17XARR* 01300000
*                                                                     * 01540000
* DESCRIPTIVE-NAME=OPERATOR CONTROL RELEASE TERMINAL MODULE           * 01580000
*                                                                     * 01620000
* COPYRIGHT='NONE'                                                    * 01660000
*                                                                     * 01700000
* STATUS= VERSION 10.0                                        @Y17XARR* 01720000
*                                                                     * 01800022
*    FUNCTION -- THE PURPOSE OF THIS ROUTINE IS TO PROCESS OPERATOR   * 02100022
*    CONTROL COMMANDS WHICH REQUEST THAT A SPECIFIED TERMINAL @Y17XARR* 02170000
*    OR LU OR LUS UNDER A PU OR PUS UNDER A SDLC LINE BE      @Y17XARR* 02240000
*    RELEASED FROM ITS INTERCEPTED STATUS.  THE TERMNAME TABLE IS     * 02310000
*    ACCESSED AND IS SERIALLY SEARCHED FOR AN ENTRY MATCHING THAT IN  * 03000022
*    THE COMMAND.  IF THE END OF THE TABLE IS REACHED BEFORE A MATCH  * 03300022
*    IS FOUND, AN ERROR MESSAGE NUMBER IS SET UP AND CONTROL IS       * 03900022
*    TRANSFERRED TO THE ERROR MODULE.  IF THE REQUEST IS FOR A GENERAL* 04000022
*    POLL ENTRY, AN ERROR MESSAGE IS SET UP AND CONTROL IS            * 04100022
*    TRANSFERRED TO THE ERROR MODULE.  WHEN THE ENTRY IS FOUND, ITS   * 04200022
*    ADDRESS IS OBTAINED.  THE INTERCEPT BIT IN THE TERMINAL ENTRY IS * 04500022
*    TESTED.  IF IT IS OFF, AN ERROR MESSAGE NUMBER IS SET UP AND     * 04800022
*    CONTROL IS TRANSFERRED TO THE ERROR MODULE.  OTHERWISE, A BUFFER * 05100022
*    REQUEST IS MADE BY BRANCHING TO A SUBROUTINE OF CA.  THE TERMINAL* 05400022
*    OFFSET OF THE TERMINAL TO BE RELEASED IS PLACED IN THE NEW BUFFER* 05700022
*    AND IT IS QUEUED TO IEDQAS01 (THE RELEASE MODULE).  AQCTL (SVC   * 06000022
*    102) IS ISSUED TO GIVE THE NEW BUFFER TO RELEASE.  THE FIELD     * 06300022
*    OCWTG IS CHECKED TO SEE IF THIS IS A RELEASE COMMAND ONLY OR AN  * 06600022
*    ENTRY FOR VARY TERMINAL.  IF THIS FIELD IS NOT BLANK, CONTROL    * 06900022
*    IS PASSED BACK TO START TERMINAL.  OTHERWISE, A MESSAGE RESPONSE * 07200022
*    NUMBER IS SET UP AND CONTROL IS TRANSFERRED TO THE VARY, HOLD,   * 07500022
*    RELEASE MESSAGE MODULE.                                          * 07800022
*    FOR THE CASCADE FUNCTION (GROUPNAME OR LINENAME OR PU    @Y17XARR* 07830000
*   SPECIFIED AS THE INPUT) ---- IF GRPNAME,RLN IS THE INPUT  @Y17XARR* 07860000
*    THEN THE INPUT IS VALIDATED BY CALLING DCBLOCAT.   IF THE@Y17XARR* 07890000
*   INPUT REPRESENT A SDLC LINE, THEN EVERY RESOURCE UNDER    @Y17XARR* 07920000
*   THAT LINE IS RELEASED; OTHERWISE, ANY OTHER LINE IS AN    @Y17XARR* 07950000
*    ERROR .   IF SDLC LINENAME, PUNAME IS THE INPUT THEN THE @Y17XARR* 07980000
*    INPUT IS VALIDATED BY CALLING TERMFLOC.   IF THE INPUT   @Y17XARR* 08010000
*    IS VALID, THEN EVERY RESOURCE UNDER THAT SPECIFIC        @Y17XARR* 08040000
*    RESOURCE IS RELEASED.                                    @Y17XARR* 08070000
*                                                                     * 08400022
* ENTRY POINTS --                                                     * 08700022
*    IGCR010D TO PROCESS RELEASE COMMANDS.                            * 09000022
*                                                                     * 09300022
* INPUT --                                                            * 09600022
*    REGISTER 1 - ADDRESS OF OPERATOR CONTROL AVT.            @Y17XARR* 09630000
*                 OPCCOPCE CONTAINS THE ADDRESS OF THE        @Y17XARR* 09660000
*                 OPERATOR CONTROL ELEMENT.   OCBACKUP        @Y17XARR* 09690000
*                 CONTAINS GROUPNAME, DDNAME,LINENAME,LUNAME  @Y17XARR* 09720000
*                 PUNAME,BSC/SS TERMINAL.   OCWTG IS CHECKED  @Y17XARR* 09750000
*                 TO SEE IF THIS IS A RELEASE COMMAND ONLY    @Y17XARR* 09780000
*                 OR FROM VARY.     IF OCWTG IS NOT ZEROS     @Y17XARR* 09810000
*                 THEN CONTROL IS PASSED BACK TO MOD ID IN    @Y17XARR* 09840000
*                  OCWTG.                                     @Y17XARR* 09870000
*                                                                     * 12300022
* OUTPUT --                                                           * 12600022
*    REGISTER 0 - NUMBER OF APPROPRIATE ERROR MESSAGE.                  12900022
*    REGISTER 1 - RETURN CODE VALUES.                                 * 13200022
*                                                                     * 13500022
* EXTERNAL REFERENCES --                                              * 13800022
*         OPCDCBLK,OPCTOFLK,OPCGETBF                          @Y17XARR* 13900000
*                                                                     * 14400022
* EXITS,NORMAL --                                                     * 14700022
*         RELEASE DONE.  RESPONSE MESSAGE NUMBER SET UP, X'00' RETURN * 15000022
*    CODE SET.                                                        * 15300022
*         TERMINAL ALREADY RELEASED.  RESPONSE MESSAGE NUMBER SET UP, * 15600022
*         X'04' RETURN CODE SET                                 SA58991 15900000
*         ALL RELEASED -- MSG 522--RETURN CODE -- 00          @Y17XARR* 16000000
*          SOME RELEASED--MSG 521--RETURN CODE-- 28           @Y17XARR* 16100000
*                                                                     * 16200022
* EXITS,ERROR --                                                      * 16500022
*         TERMINAL NOT FOUND, ERROR MESSAGE SET UP,             SA58991 16800000
*         X'20' RETURN CODE SET                                 SA58991 17100000
*         TERMINAL IS NOT A SINGLE ENTRY OR IT IS A GENERAL POLL ENTRY* 17400022
*         ERROR MESSAGE NUMBER IS SET AND X'04' RETURN CODE IS SET    * 17700022
*         NONE RELEASED--MSG 523--RETURN CODE-- 24            @Y17XARR* 17760000
*         RLN INVALID -- MSG 524--RETURN CODE-- 8             @Y17XARR* 17820000
*         NCP INACTIVE -- MSG 400-- RETURN CODE-- 1C          @Y17XARR* 17880000
* MACROS = AQCTL,XCTL                                         @Y17XARR* 17940000
*                                                                     * 18000022
* TABLES/WORK AREAS --                                                * 18300022
*    OPERATOR CONTROL AVT, OPERATOR CONTROL ELEMENT, AVT      @Y17XARR* 18330000
*    DCB, TERMINAL ENTRY, QCB.                                @Y17XARR* 18360000
* PATCH LABEL = ZAPAREA                                       @Y17XARR* 18390000
* MODULE TYPE = PROCEDURE                                     @Y17XARR* 18420000
* PROCESSOR = ASSEMBLER                                       @Y17XARR* 18450000
* MODULE SIZE =                                               @Y17XARR* 18480000
* PURPOSE = SEE FUNCTION                                      @Y17XARR* 18510000
* LINKAGE = XCTL SF=(E,OPXCTL)                                @Y17XARR* 18540000
*                                                                     * 19200022
* ATTRIBUTES --                                                       * 19500022
*    SERIALLY REUSABLE,REENTERANT,ENABLED,TRANSIENT,                  * 19800052
*    SUPERVISOR MODE.                                                 * 20100022
*                                                                     * 20400022
* CHARACTER CODE DEPENDENCY --                                        * 20700022
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL            * 21000022
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS            * 21300022
*    EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME.  THE CODING         * 21600022
*    HAS BEEN ARRANGED SO THAT REDEFINITION OF CHARACTER              * 21900022
*    CONSTANTS, BY REASSEMBLY WILL RESULT IN A CORRECT MODULE         * 22200022
*    FOR THE NEW DEFINITION.                                          * 22500022
*                                                                     * 22800022
* NOTES --                                                            * 23100022
*    COMMUNICATIONS BETWEEN THE VARIOUS TRANSIENT MODULES IS          * 23400022
*    PRIMARILY THROUGH THE OPERATOR CONTROL AVT.                      * 23700022
*                                                                     * 24000022
*    THIS IS A MODULE RE-WRITE OF IEDQCQ AS OF OS/TCAM LEVEL II       * 24100022
*********************************************************************** 24300022
         EJECT                                                          24600022
         SPACE                                                          24900022
*                                 E Q U A T E S                         25200022
         SPACE                                                          25500022
RZERO    EQU   0                        PARAMETER REGISTER              25800022
RPARM    EQU   1                        PARAMETER REGISTER              26100022
REG2     EQU   2                        PARM REG                 Y05330 26200005
ROPCAVT  EQU   2                        POINTER TO OP CONTROL AVT       26400022
ROPCE    EQU   3                        CURRENT ELEMENT POINTER         26700022
RAVT     EQU   4                        TCAM AVT                        27000022
RWORKA   EQU   5                        RESIDENT WORKAREA POINTER       27300022
RLEN     EQU   6                        LENGTH OF INPUT COMMAND         27600022
RDCTINDX EQU   6                        STATION DCT ADDRESS    @Y17XARR 27700000
RQCB     EQU   6                        QCB BASE               @Y17XARR 27800000
RTERM    EQU   7                        TERM ENTRY POINTER              28200022
RWORK    EQU   8                        ROWKREGISTER                    28500022
RSCANLEN EQU   8                        NUMBER OF BYTES SCANNED@Y17XARR 28600000
REND     EQU   9                        POINTER TO END OF INPUT         28800022
RSAVER14 EQU   9                        SAVE RETURN ADDRESS    @Y17XARR 28900000
RALSTAT  EQU   9                        REGISTER FOR SAVING 'ALL        28950082
*                                       OPTION' STATUS FLAG    @OZ27690 29000082
RSCAN    EQU   10                       DATA SCAN POINTER               29100022
RPREFIX  EQU   11                       POINTER TO UNIT        @Y17XARR 29200000
RSCANWRK EQU   11                       SCAN WORK REGISTER     @Y17XARR 29300000
RBASE    EQU   12                       MODULE BASE REGISTER            29700022
ROPCSAVE EQU   13                       OPCSAVE PTR            @Y17XARR 29800000
RRET     EQU   14                       SUBROUTINE RETURN ADDRESS       30000022
RBRNCH   EQU   15                       SUBROUTINE ENTRY REGISTER       30300022
         SPACE 2                                                        30600022
ALL      EQU   255                      ALL ONE BITS                    30900022
BADTERM  EQU   16                       ERROR FOR BAD TERMNAME          31200022
BYTE     EQU   1                        OFFSET OF ONE                   31500022
ZERO     EQU   0                        ZERO                            31570022
X01      EQU   X'01'                    HEX ONE                         31640022
GENPOLMG EQU   147                      MESSAGE NUMBER                  31710022
EIGHT    EQU   8                        LONGEST TERMINAL NAME           31800022
END      EQU   X'80'                    SET LIST END                    32100022
FIVE     EQU   5                        LENGTH OF FIVE                  32400022
FOUR     EQU   4                        LENGTH OF 4                     32700022
THREE    EQU   3                        LENGTH OF 3             OX02177 32800052
GOODREL  EQU   54                       TERM RELEASED                   33000022
INVALCMD EQU   18                       INVALID INPUT COMMAND           33300022
LENOFF   EQU   2                        OFFSET TO LENGTH IN WORKAREA    33600022
MSGOFF   EQU   8                        OFFSET TO INPUT DATA            33900022
NAMELEN  EQU   2                        LENGTH OF NAME CHANGE           34200022
NEXT     EQU   1                        OFFSET OF ONE                   34500022
ONE      EQU   1                        LENGTH OF ONE                   34800022
POST     EQU   X'0C'                    POST TO AQCTL                   35100022
RELEASED EQU   53                       TERM ALREADY RELEASED           35400022
SEVEN    EQU   7                        LENGTH FOR MOVE                 35700022
SIX      EQU   6                        OFFSET OF SIX                   36300022
TPLEN    EQU   3                        LENGTH OF TP= FOR INPUT         36600022
TWO      EQU   2                        LENGTH OF 2                     36900022
VARINAME EQU   3                        OFFSET TO CHANGE NEXT MODULE ID 37200022
ZONE     EQU   X'F0'                    COVER ISGN AFTER UNPACK         37500022
X40      EQU   X'40'                    INDICATE ENTRY FROM START TERM  37800022
ALRSTRT  EQU   19                       ALREADY STARTED MESSAGE NO      37900022
STARTED  EQU   20                       STARTED MESSAGE NO              38000022
THRTYTWO EQU   32                       INVALID TERMNAME        SA58991 38020000
NOHOLD   EQU   60                       FLAG                     S22024 38050000
OLTRES   EQU   49                       OLT CONTROLS RESOURCE    Y06330 38060005
*                                         ERROR MESSAGE NUMBER   Y06330 38070005
         EJECT                                                          38100022
         USING IEDQAVTD,RAVT            TCAM AVT ADDRESSABILITY         38400022
         USING IEDQOPCE,ROPCE           ELEMENT ADDRESSABILITY          38700022
         USING IEDQOPCD,ROPCAVT         OP CONTROL AVT ADDRESSABILITY   39000022
         USING IEDQPRF,RPREFIX          UNIT ADDRESSABILITY             39300022
         USING IEDNTRM,RTERM            TERM ENTRY ADDRESS     @Y17XARR 39400000
         SPACE                                                          40200022
         BALR  RBASE,RZERO              SET MODULE BASE                 40500022
         USING *,RBASE                  SET MODULE ADDRESSABILITY       40800022
IGCR010D IEDHJN  SKIPID                                                 41700022
*              INITIAL SETUP                                          * 42600022
         LR    ROPCAVT,RPARM             GET PASSED AVT ADDRESS         42900022
         L     ROPCE,OPCCOPCE           GET CURRENT ELEMENT ADDRESS     43200022
         L     RAVT,OPCAVTPT            GET TCAM AVT ADDRESS            43500022
         L     RWORKA,OPCWORK           GET WORKAREA ADDRESS            43800022
         LA    ROPCSAVE,OPCSAVE         GET SAVEAREA ADDRESS   @Y17XARR 43900000
         MVC   OPCDOUBL(EIGHT),OCBACKUP YES, MOVE TERM NAME FOR VERIFY  44100022
         MVC   OPCLDNME+VARINAME(NAMELEN),XCTL03 SET ERROR MODULE NAME  44400022
         TM    OPCSPEC,OPCRSTRT         RESTART IN PROGRESS             44700022
         BZ    NORMINPT                 NORMAL PROCESSING OF   @Y17XARR 44730000
*                                       A RELEASE COMMAND      @Y17XARR 44760000
         TM    OCALSTAT,OCALLFLG        RESTART A CASCADE REQ? @Y17XARR 44790000
         BZ    NORMIN                   CONTINUE ^CASCADE RST  @Y17XARR 44820000
         SR    RPARM,RPARM              CLEAR TO PICKUP T-INDX @Y17XARR 44850000
         ICM   RPARM,HALFWORD,OCTRMTBL  GET HGHST RES TNTINDEX @Y17XARR 44880000
         LA    RRET,RESTART             GET RETURN ADDRESS     @Y17XARR 44910000
         B     GETTTE                   GET STATION ADDRESS    @Y17XARR 44940000
NORMINPT EQU   *                                               @Y17XARR 44970000
         SPACE                                                          45300022
         TM    OCFLAG,OCMPP+OCTOTE      TOTE OR MPP INPUT?              45600022
         BM    NORMIN                   YES, VERIFY INPUT               45900022
         SPACE                                                          46200022
         CLI   OCOPTCDE,OCVARY          REQUEST FROM ACTIVATE TERM      46500022
         BE    NORMIN                   YES                             46800022
         SPACE                                                          47100022
         LA    RSCAN,MSGOFF(RWORKA)     SET BEGINNING SCAN POINTER      47400022
         LH    RLEN,LENOFF(RWORKA)      PICK UP INPUT LENGTH            47700022
         LA    REND,DATAINDX(RWORKA,RLEN) GET ADDRESS OF END OF@Y17XARR 47750000
*                                       DATA IN THE WORKAREA   @Y17XARR 47800000
         MVI   ZERO(REND),AVTEBLNK      INSERT A BLANK TO      @Y17XARR 47850000
*                                       INDICATOR END OF DATA  @Y17XARR 47900000
*                                       IN WORKAREA            @Y17XARR 47950000
         MVI   OPCDOUBL,AVTEBLNK        SET FIRST BLANK                 48000022
         MVC   OPCDOUBL+NEXT(SEVEN),OPCDOUBL BLANK ALL WORKAREA         48300022
         LA    RZERO,INVALCMD           SET INVALID COMMAND ERROR       48600022
         CLC   AVTEZERO(TPLEN,RSCAN),TPID TP= FOR FIRST THREE CHARACTER 48900022
         BNE   XCTL                     NOT TP=, INVALID INPUT          49200022
         SPACE                                                          49500022
         LA    RSCAN,TPLEN(RSCAN)       POINT BEYOND EQUALS             49800022
         LR    RSCANWRK,RSCAN           GET WORK REGISTERS FOR @Y17XARR 49850000
         LR    RSCANLEN,RSCAN           SCAN PTR,LENGTH TO BE  @Y17XARR 49900000
*                                       SCANNED AND KEEP ONE   @Y17XARR 49950000
*                                       REG TO POINT TO BEGIN  @Y17XARR 50000000
*                                       OF THE DATA            @Y17XARR 50050000
         SH    RLEN,LENTP               TAKE THREE FROM LENGTH          50100022
         BZ    XCTL                     NO MORE INPUT, ERROR            50400022
         SPACE                                                          50700022
SCANINPT EQU   *                                               @Y17XARR 50710000
         CLI   ZERO(RSCANWRK),COMMA     DELIMITER FOUND?       @Y17XARR 50720000
         BE    GETLEN                   DETERMINE NO FO BYTES  @Y17XARR 50730000
*                                       SCANNED                @Y17XARR 50740000
         CLI   ZERO(RSCANWRK),AVTEBLNK  DELIMITER FOUND?       @Y17XARR 50750000
         BE    GETLEN                   DETERMINE NO OF BYTES  @Y17XARR 50760000
*                                       SCANNED                @Y17XARR 50770000
         LA    RSCANWRK,INDEX(,RSCANWRK) BUMP INPUT SCAN PTR   @Y17XARR 50780000
         LR    RSCANLEN,RSCANWRK        BUMP LEN SCAN PTR      @Y17XARR 50790000
         B     SCANINPT                 TEST NEXT BYTE OF      @Y17XARR 50800000
*                                       DATA                   @Y17XARR 50810000
GETLEN   EQU   *                                               @Y17XARR 50820000
         SR    RSCANLEN,RSCAN           GET TOTAL LEN SCANNED  @Y17XARR 50830000
         BZ    XCTL                     ZERO BYTES FOUND       @OY19901 50835082
         CH    RSCANLEN,NAME            IS LEN SCANNED >LEN    @Y17XARR 50840000
*                                       OF VALID NAME          @Y17XARR 50850000
         BH    XCTL                      YES, INVALID COMMAND           51300022
         SPACE                                                          51600022
         BCTR  RSCANLEN,RZERO           DECREMENT FOR MOVE     @Y17XARR 51610000
         EX    RSCANLEN,MOVENAME        MOVE NAME TO VERIFY    @Y17XARR 51620000
         MVC   OCBACKUP,OPCDOUBL        SAVE THE NAME          @Y17XARR 51630000
         LA    RSCANLEN,INDEX(,RSCANLEN) ADJUST COUNTER TO ORIG@Y17XARR 51640000
         SR    RLEN,RSCANLEN            SUBSTRACT LEN SCANNED  @Y17XARR 51650000
         BZ    NORMINA                  TERMNAME TO VALIDATE   @YM07016 51660000
         LA    RSCANWRK,INDEX(RSCANLEN,RSCAN) PT PASSED COMMA  @Y17XARR 51670000
         LR    RSCAN,RSCANWRK           ADJUST POINTERS TO     @Y17XARR 51680000
         LR    RSCANLEN,RSCAN           POINT TO DATA LEFT     @Y17XARR 51690000
*                                       TO SCANNED             @Y17XARR 51700000
         CR    REND,RSCANWRK            REACHED END OF DATA?   @Y17XARR 51710000
         BE    XCTL                     REACHED END OF DATA    @Y17XARR 51720000
*                                       BEFORE FINDING VALID   @Y17XARR 51730000
*                                       INPUT                  @Y17XARR 51740000
CHKRLN   EQU   *                                               @Y17XARR 51750000
         SPACE                                                          52500022
         CR    REND,RSCANWRK            SCANNED TO THE END?    @Y17XARR 52504000
         BE    CONVERT                  YES, TRY TO CONVERT    @Y17XARR 52508000
         CLI   ZERO(RSCANWRK),LOWEST    IS RLN < ZERO?         @Y17XARR 52512000
         BL    XCTL                     YES,INVALID RLN        @Y17XARR 52516000
         CLI   ZERO(RSCANWRK),HIGHEST   IS RLN > NINE?         @Y17XARR 52520000
         BH    XCTL                     YES,INVALID RLN        @Y17XARR 52524000
         LA    RSCANWRK,INDEX(,RSCANWRK) BUMP THE SCAN PTR BY 1@Y17XARR 52528000
         LR    RSCANLEN,RSCANWRK        BUMP LENGTH PTR        @Y17XARR 52532000
         B     CHKRLN                   CONTINUE TO SCAN TO    @Y17XARR 52536000
*                                       A MATCH IS FOUND       @Y17XARR 52540000
CONVERT  EQU   *                                               @Y17XARR 52544000
         SR    RSCANLEN,RSCAN           GET TOTAL LEN SCANNED  @Y17XARR 52548000
         CH    RSCANLEN,RLNLEN          IS SCANNED LEN > THREE @Y17XARR 52552000
         BH    XCTL                     YES, INVALID RLN       @Y17XARR 52556000
         XC    OPCDOUBL,OPCDOUBL        CLEAR TO MOVE RLN      @Y17XARR 52560000
         BCTR  RSCANLEN,RZERO           DECREMENT LEN FOR MOVE @Y17XARR 52564000
         EX    RSCANLEN,MOVERLN         MOVE RLN AND PACK RLN  @Y17XARR 52568000
         EX    RSCANLEN,PACKRLN         TO CONVERT TO A MORE   @Y17XARR 52572000
*                                       WORKABLE FORM          @Y17XARR 52576000
         XC    OPCDOUBL(UNUSED),OPCDOUBL CLEAR FOR CVB         @Y17XARR 52580000
         CVB   RWORK,OPCDOUBL           CONVERT TO BINARY NUM  @Y17XARR 52584000
         LTR   RWORK,RWORK              IS RLN EQUAL TO ZERO?  @Y17XARR 52588000
         BZ    INVALRLN                 YES, INVALID RLN SPEC  @Y17XARR 52592000
         CH    RWORK,MAXRLN                 RLN>255?           @Y17XARR 52596000
         BNH   VALIDATE                 NO,VALIDATE GROUPNAME  @Y17XARR 52600000
INVALRLN EQU   *                                               @Y17XARR 52604000
         LA    RPARM,NVALDRLN            SETUP RETURN CODE     @Y17XARR 52608000
*                                       FOR TOTE OR MPP        @Y17XARR 52612000
         LA    RZERO,RLNERR             SETUP MSG APPROPRIATE  @Y17XARR 52616000
*                                       FOR INVALID RLN        @Y17XARR 52620000
         B     ALREADY                  EXIT ACCORDING TO      @Y17XARR 52624000
*                                       THE REQUESTOR          @Y17XARR 52628000
VALIDATE EQU   *                                               @Y17XARR 52632000
         IC    RALSTAT,OCALSTAT         SAVE 'ALL OPTION' STATUS        52633082
*                                       FLAG                   @OZ27690 52634082
         LR    RPARM,RWORK              SETUP INTERFACE TO     @Y17XARR 52636000
         MVC   OPCDOUBL,OCBACKUP        DCBLOCAT REG1=RLN AND  @Y17XARR 52640000
*                                       OPCDOUBL CONTAINS GRP  @Y17XARR 52644000
         L     RBRNCH,OPCDCBLK          GET ADDRESS OF DCBLOCAT@Y17XARR 52648000
         BALR  RRET,RBRNCH              CALL DCBLOCAT          @Y17XARR 52652000
         B     VALIDGRP                 GOOD RETURN,BRANCH     @Y17XARR 52656000
         CH    RZERO,INACTNCP           NCP ACTIVE?            @Y17XARR 52660000
         BE    INACTIVE                 PUT OUT MSG            @Y17XARR 52664000
         CH    RZERO,RLNRETCD             RLN INVALID?         @Y17XARR 52668000
         BNE   BADNAME                  NO, GRPNAME INVALID    @Y17XARR 52672000
         LA    RPARM,NVALDRLN           SETUP INVALID RLN MSG  @Y17XARR 52676000
         LA    RZERO,RLNERR             SETUP RLN ^ IN GRP     @Y17XARR 52680000
         B     ALREADY                  EXIT ACCORDING TO REQ  @Y17XARR 52684000
BADNAME  EQU   *                                               @Y17XARR 52688000
         LA    RZERO,BADGRP             NON-EXISTING NAME      @Y17XARR 52692000
         LA    RPARM,BADGRPRC           RETURN CODE INVALID    @Y17XARR 52696000
*                                       NAME                   @Y17XARR 52700000
         B     ALREADY                  EXIT ACCORDINGLY       @Y17XARR 52704000
VALIDGRP EQU   *                                               @Y17XARR 52708000
         USING IHADCB,RPARM             EST. ADDRESSABILITY    @Y17XARR 52712000
         STC   RALSTAT,OCALSTAT         RESTORE 'ALL OPTION'FLG@OZ27690 52714082
         TM    DCBDSORG,DSLGB           LGB?                   @Y17XARR 52716000
         BO    NON270X                  VALID MODE             @Y17XARR 52720000
         DROP  RPARM                    ADDRESSABILTY FOR TEST @Y17XARR 52724000
         LA    RZERO,INVALID            270X LINE INVALID      @Y17XARR 52728000
         LA    RPARM,BADREQST           RETURN CODE FOR TOTE   @Y17XARR 52732000
*                                       OR MPP                 @Y17XARR 52736000
         B     ALREADY                  GIVE CONTROL TO REQ    @Y17XARR 52740000
NON270X  EQU   *                                               @Y17XARR 52744000
         LR    RPARM,RZERO              USE LINE TTE TO CON'T  @Y17XARR 52748000
         B     RELEASE1                 PERFORM FUNCTION       @Y17XARR 52752000
NORMINA  EQU   *                                               @YM07016 52762000
         MVI   OCRLN,X'00'              SET NO RLN             @YM07016 52772000
NORMIN   EQU   *                                                        52800022
         L     RBRNCH,OPCTOFLK          GET LOOK UP ADDRESS             53100022
         BALR  RRET,RBRNCH              CHECK TERMINAL NAME             53400022
         SPACE                                                          53700022
         B     RELEASE1                 GOOD, RELEASE TERMINAL @Y17XARR 53800000
         SPACE                                                          54300022
         LA    RZERO,BADTERM            SET BAD TERM ERROR              54600022
         LA    RPARM,THRTYTWO           SET MPP RETURN CODE     SA58991 54900000
         B     ALREADY                  PUT OUT ERROR                   55200022
         SPACE                                                          55500022
*              PERFORM RELEASE FUNCTION                               * 55800022
RELEASE1 EQU   *                                               @Y17XARR 55900000
         LR    RTERM,RPARM              SAVE TERM ENTRY ADDRESS         56700022
         LA    RWORK,TRMPRFSZ            GET PRFEFIX LENGTH    @Y17XARR 56770000
         SR    RTERM,RWORK              BACKUP TO THE PREFIX   @Y17XARR 56840000
RESTART  EQU   *                                               @Y17XARR 56910000
         LA    RPARM,FOUR               SET MPP RETURN CODE             57000022
         LA    RZERO,NOHOLD             SET CANNOT BE HELD      OX03970 57020005
         TM    TRMDSORG,TRMLGB          IS THIS AN LGB          OX03970 57040005
         BO    ALREADY                  YES, PRINT ERROR MSG    OX03970 57060005
         TM    TRMSTATE,TRMLIST+TRMPROC LIST OR PROCESS ENTRY   OX03970 57080005
         BZ    FINDTERM                 NO, SINGLE ENTRY       @Y17XARR 57090000
         LA    RZERO,RELEASED           SET ALREADY RELEASED    OX03970 57160005
         B     ALREADY                  WRITE OUT ERROR MSG     OX03970 57180005
FINDTERM EQU   *                                               @Y17XARR 57180400
         TM    TRMSTATE,TRMPREF         3705 RESOURCE?         @Y17XARR 57180800
         BZ    SINGL                    NO, CONTINUE RELEASE   @Y17XARR 57181200
         TM    TRMSTATE,TRMLINE         LINE?                  @Y17XARR 57181600
         BO    CASCADE                  PERFORM RELEASE        @Y17XARR 57182000
         CLI   TRMTYPE,TRMPUNT          PU?                    @Y17XARR 57182400
         BNE   CHKNCP                   VERIFY INPUT           @Y17XARR 57182800
CASCADE  EQU   *                                               @Y17XARR 57183200
         STCM  RTERM,FULLWORD,OPCTRMWA  SAVE HGHST RES TTE ADDR@Y17XARR 57183600
         MVC   OCSEQ,OCTRMTBL           SAVE IT'S TNT INDEX    @Y17XARR 57184000
         NI    OCALSTAT,AVTEFF-OCALL    INDICATE ORIG STATUS   @Y17XARR 57184400
         OI    OCALSTAT,OCALLFLG        INDICATE CASCADE FUNCT @Y17XARR 57184800
         CLI   TRMTYPE,TRMPUNT          PU?                    @Y17XARR 57185200
         BE    SUBSTRUC                 CONTINUE,CASCADE FUNC  @Y17XARR 57185600
         CLI   TRMTYPE,TRMSDLC          SDLC LINE?             @Y17XARR 57186000
         BNE   NEXTCHK                  INVALID TYPEBSC/SS     @Y17XARR 57186400
GETSUBST EQU   *                                               @Y17XARR 57186800
         SR    RPARM,RPARM              CLEAR TO GET SUBENTRY  @Y17XARR 57187200
         ICM   RPARM,HALFWORD,TRMSUBST  GET SUBENTRY TNTINDEX  @Y17XARR 57187600
         BZ    INACTIVE                 INACTIVE 3705          @Y17XARR 57188000
         BAL   RRET,GETTTE              GET STATION ADDRESS    @Y17XARR 57188400
SUBENTRY EQU   *                                               @Y17XARR 57188800
         STCM  RTERM,FULLWORD,OCMODNME+FRSTWORD  SAVE PU @     @Y17XARR 57189200
         SR    RPARM,RPARM              CLEAR TO GET SUBENTRY  @Y17XARR 57189600
         ICM   RPARM,HALFWORD,TRMSUBST  SUBSTRUCTURE EXIST?    @Y17XARR 57190000
         BZ    ADJSUBST                 TRY NEXT PU'S SUBENTRY @Y17XARR 57190400
         STCM  RPARM,HALFWORD,OCTRMTBL  INTERFACE FOR IEDQAS   @Y17XARR 57190800
         LA    RRET,SINGL               SETUP RETURN ADDRESS   @Y17XARR 57191200
         B     GETTTE                   GET STATION ADDRESS    @Y17XARR 57191600
SUBSTRUC EQU   *                                               @Y17XARR 57192000
         SR    RPARM,RPARM              CLEAR TO GET SUBENTRY  @Y17XARR 57192400
         ICM   RPARM,HALFWORD,TRMSUBST  SUBSTRUCTURE EXIST?    @Y17XARR 57192800
         BZ    INACTIVE                 INACTIVE 3705          @Y17XARR 57193200
         STCM  RPARM,HALFWORD,OCTRMTBL  INTERFACE FOR IEDQAS   @Y17XARR 57193600
         LA    RRET,SINGL               SETUP RETURN ADDRESS   @Y17XARR 57194000
         B     GETTTE                   GET STATION ADDRESS    @Y17XARR 57194400
INACTIVE EQU   *                                               @Y17XARR 57194800
         LA    RZERO,NOSUBSTR           3705 INACTIVE MSG NUM  @Y17XARR 57195200
         LA    RPARM,INACTRCD           TOTE OR MPP INACT RC   @Y17XARR 57195600
         MVC   OPCMODID,XCTL03          MSG MOD ID             @Y17XARR 57196000
         B     NEXTCHK                  GIVE CONTROL TO MSG MOD@Y17XARR 57196400
CHKNCP   EQU   *                                               @Y17XARR 57196800
         CLI   TRMTYPE,TRMLNCP          NCP?                   @Y17XARR 57197200
         BE    ALREADY                  INVALID ENTRY          @Y17XARR 57197600
         CLI   TRMTYPE,TRMSSCP          SSCP?                  @Y17XARR 57198000
         BE    ALREADY                  INVALID ENTRY          @Y17XARR 57198400
SINGL    EQU   *                                                OX03970 57200005
         LA    RZERO,RELEASED           SET MESSAGE NUMBER              57300022
         LA    RPARM,ASUMEBAD           ASSUME AN ERROR        @Y17XARR 57301000
         SR    RDCTINDX,RDCTINDX        CLEAR FOR DCT INDEX    @Y17XARR 57302000
         IC    RDCTINDX,TRMCHCIN        GET DCT INDEX          @Y17XARR 57303000
         BCTR  RDCTINDX,RZERO           GET CORRECT INDEX      @Y17XARR 57304000
         MH    RDCTINDX,AVTDCTLN        GET ACTUAL INDEX TO ADD@Y17XARR 57305000
*                                       TO DCT ADDRESS         @Y17XARR 57306000
         A     RDCTINDX,AVTCSTCS        PT TO STATION DEVICE   @Y17XARR 57307000
*                                       CHARACTERISTICS        @Y17XARR 57308000
         USING IEDDCT,RDCTINDX          EST. ADDRESSABILITY    @Y17XARR 57309000
         TM    DCTBYTE1,DCTUMASK        IS THIS GENERAL POLL   @Y17XARR 57310000
         BZ    ALRDYCHK                 NO, BRANCH             @Y17XARR 57311000
         DROP  RDCTINDX                 DROP ADDRESS.          @Y17XARR 57312000
         LA    RZERO,GENPOLMG           SET INVALID COMMAND MSG         57460022
         MVC   OPCLDNME+VARINAME(NAMELEN),WRTMSG SET ERROR MOD          57480022
         B     NEXTCHK                  GO SEND OUT MESSAGE             57500022
ALRDYCHK EQU   *                                                        57520022
         SPACE  1                                                       58000005
         TM    OCFLAG,OCTOTE            TOTE REQUEST?            Y06330 58106005
         BO    CONTINUE                 YES, CONTINUE PROCESSING Y06330 58112005
         TM    TRMSTATE,TRMPREF         IS TERMINAL ON 3705    @Y17XARR 58113000
         BNO   CONTINUE                 NO, CONTINUE            OY01948 58116054
         TM    TRMBYTE1,TRMSTOTE                OLT OWNS?      @Y17XARR 58117000
         BNO   CONTINUE                 NO, CONTINUE PROCESSING  Y06330 58124005
         TM    OCALSTAT,OCALLFLG        CASCADE RELEASE FUNC?  @Y17XARR 58126000
         BO    ALREADY                  YES,GETNEXT SUBSTRUCT  @Y17XARR 58128000
         LA    RZERO,OLTRES             GET ERROR MESSAGE NUMBER Y06330 58130005
         B     ALREADY                  PUT OUT ERROR            Y06330 58136005
CONTINUE EQU   *                                                 Y06330 58142005
         SPACE 1                                                 S22024 58150022
         SPACE                                                          58200022
         TM    TRMSTATE,TRMHELDN        TERMINAL INTERCEPTED?           58500022
         BNO   ALREADY                  NO, ALREADY RELEASED            58800022
         SPACE                                                          59100022
         CLC   AVTAS,AVTFZERO           IS RELEASE IN SYSTEM   @SA70887 59140056
         BNE  CHKRESRT                  CHECK FOR RESTART      @SA70887 59180056
         LA    RZERO,NOHOLD             SET MESSAGE            @SA70887 59220056
         B     ALREADY                                         @SA70887 59260056
         SPACE 2                                               @SA70887 59300056
CHKRESRT EQU   *                                               @SA70887 59340056
         TM    OPCSPEC,OPCRSTRT         RESTART IN PROGRESS?            59400022
         BNO   LETGO                    NO, RELEASE NORMALLY            59700022
         SPACE                                                          60000022
         NI    TRMSTATE,AVTEFF-TRMHELDN TURN OFF INTER FLAG    @Y17XARR 60100000
         USING IEDQQCB,RQCB             EST. ADDRESSABILITY    @Y17XARR 60200000
         L     RQCB,TRMDESTQ-BYTE       GET QCB ADDRESS                 60600022
         TM    QCBFLAG,QCBTERMQ         QUEUING BY TERMINAL?            60900022
         BZ    ALREADY                  NO, ALREADY RELEASED            61200022
         SPACE                                                          61500022
         NI    QCBSTAT,AVTEFF-QCBTRMHO  TURN OFF QCB HOLD BIT  @Y17XARR 61600000
         B     ALREADY                  ALREADY RELEASED                62100022
         SPACE                                                          62400022
LETGO    EQU   *                                                        62700022
         LH    RWORK,TRMOUTSQ           PICK UP OUTPUT SEQUENCE NUMBER  63000022
         CVD   RWORK,OPCDOUBL           CONVERT TO PACKED DECIMAL       63300022
         UNPK  OPCDOUBL(FIVE),OPCDOUBL+FIVE(THREE) UNPACK NO.   OX02177 63600052
         OI    OPCDOUBL+FOUR,ZONE       MAKE SIGN PRINTABLE             63900022
         MVC   OCMODNME(FOUR),OPCDOUBL+NEXT PLACE SEQUENCE IN ELEMENT   64200022
         LA    RPARM,ONE                SET UNIT REQUEST                65100022
         L     RBRNCH,OPCGETBF          GET ALLOCATION ROUTINE ADDRESS  65400022
         BALR  RRET,RBRNCH              GET UNIT FOR POST               65700022
         SPACE                                                          66000022
         LR    RPREFIX,RPARM            SAVE UNIT ADDRESS               67800022
         MVC   PRFDEST(TWO),OCTRMTBL    SET DESTINATION OFFSET          68100022
         MVI   PRFNBUNT,ONE             SET NO. OF BUFFERS TO ONE       68400022
         XC    PRFPRI(FOUR),PRFPRI      CLEAR UNIT LINK FIELD           68700022
         MVI   PRFPRI,PRIRELSE          SET RELEASE PRIORITY            69000022
         L     RWORK,AVTAS              GET RELEASE QCB ADDRESS         69300022
         ST    RWORK,PRFQCBA-BYTE       PLACE QCB ADDRESS IN UNIT       69600022
         ST    RPREFIX,OPCAQCTL         PLACE UNIT ADDRESS FOR POST     69900022
         ST    RPREFIX,OPCAQCTL+FOUR    PLACE UNIT ADDRESS FOR POST     70200022
         MVI   OPCAQCTL,POST            SET POST INDICATION             70500022
         MVI   OPCAQCTL+FOUR,END        SET END                         70800022
         LA    RPARM,OPCAQCTL           POINT TO AQCTL LIST             71100022
         SPACE                                                          71400022
         AQCTL                          POST UNIT TO IEDQAS FOR RELEASE 71700022
         SPACE 2                                                        72000022
*              CHECK ALL EXIT SITUATIONS                              * 72300022
         SR    RPARM,RPARM              CLEAR TEST REGISTER             72600022
         TM    OPCSPEC,OPCRSTRT         RESTART IN PROGRESS             72900022
         BZ    ALREADY                  NO                              73200022
         MVC   OPCLDNME+VARINAME(NAMELEN),CHECKPT SET UP FOR CHECKPOINT 73500022
         B     ALREADY                  GO TO CHECKPOINT                73800022
         SPACE                                                          74100022
NORESTRT EQU   *                                                        74400022
         MVC   OPCLDNME+VARINAME(NAMELEN),OCWTG  SET RETURN NAME        74700022
         OC    OCWTG(NAMELEN),OCWTG     IS RETURN REQUESTED             75000022
         MVC   OCWTG(NAMELEN),WRTMSG    SET FOR START TERMINAL          75300022
         BNZ   NEXTCHK                  YES                             75600022
GOODRLSE EQU   *                                                        75700022
         SPACE                                                          75900022
         MVI   OCPARM,AVTEZERO          CLEAR HIGH BYTE                 76200022
         MVI   OCPARM+BYTE,GOODREL      SET MESSAGE NUMBER              76500022
         MVC   OCWTG(NAMELEN),WRTMSG    SET FOR MESSAGE MODULE          76800022
         MVC   OPCLDNME+VARINAME(NAMELEN),CHECKPT SET FOR CHECKPOINT    77100022
         B     NEXTCHK                  GO MAKE FURTHER CHECKS          77400022
         SPACE                                                          77700022
ALREADY  EQU   *                                                        78000022
         CLI   OCOPTCDE,OCVARY          VARY COMMAND                    78030022
         BNE   CASCADNG                 RELEASE COMMAND        @Y17XARR 78032000
         LTR   RPARM,RPARM              ERROR                           78034000
         BZ    RELESED                  NO                              78036000
POSSERR  EQU   *                                               @Y17XARR 78038000
         LH    RWORK,OCPARM             GET MESSAGE NUMBER              78090022
         LA    REND,STARTED             TO CHECK FOR GOOD MESSAGE       78100022
         CR    RWORK,REND               CHECK FOR GOOD MSG NO           78110022
         BE    NORESTRT                 GOOD MSG NO                     78120022
         SPACE                                                          78130022
         LR    RZERO,RWORK              SET UP VARY ERROR MESSAGE       78135022
         MVC   OPCLDNME+VARINAME(NAMELEN),XCTL03 SET TO GO TO ERROR MOD 78140022
         XC    OCWTG(NAMELEN),OCWTG     CLEAR NAME FIELD        SA61821 78145000
         B     NEXTCHK                  EXIT TO MODULE                  78150022
         SPACE                                                          78160022
CASCADNG EQU   *                                               @Y17XARR 78161000
         TM    OCALSTAT,OCALLFLG        CASCADE FUNCTION REQ   @Y17XARR 78162000
         BO    CHKRETCD                 CHECK STAUS            @Y17XARR 78163000
         LTR   RPARM,RPARM              ERROR?                 @Y17XARR 78164000
         BNZ   NEXTCHK                  TO GET OUT             @Y17XARR 78165000
RELESED  EQU   *                                                        78170022
         CLI   OCOPTCDE,OCVARY          REQUEST FROM ACTIVATE TERMINAL  78300022
         BNE   GOODRLSE                 NO                              78320022
         SPACE                                                          78340022
         TM    OCFLAG,OCTOTE            TOTE INPUT                      78360022
         BO    TOTEINPT                 YES                             78380022
         LH    RWORK,OCPARM             MSG NO                          78420022
         LA    REND,STARTED             SET UP STARTED MESSAGE          78430022
COMPARE  EQU   *                                                        78440022
         CR    RWORK,REND               ALREADY STARTED                 78460022
         BNE   GOODRLSE                 NO                              78470022
         TM    OCFLAG,OCTOTE            TOTE INPUT                      78520022
         BZ    NOTTOTE                  NO                              78540022
         SPACE                                                          78560022
         MVI   OCPARM+ONE,AVTEZERO      SET GOOD RETURN CODE            78580022
NOTTOTE  EQU   *                                                        78600022
         B     NORESTRT                 BRANCH TO NORESTRT              78620022
         SPACE                                                          78640022
TOTEINPT EQU   *                                                        78660022
         LA    REND,AVTEZERO            SET TO COMPARE FOR SUCCESSFUL   78680022
         B     COMPARE                  CHECK FOR ALREADY DONE RET CODE 78700022
         SPACE                                                          78720022
CHKRETCD EQU   *                                               @Y17XARR 78722000
         LTR   RPARM,RPARM              ERROR?                 @Y17XARR 78724000
         BZ    CHKSTAT                  NO ERROR CONDITION     @Y17XARR 78726000
         TM    OCALSTAT,OCALL           ORIG STATUS?           @Y17XARR 78728000
         BNZ   ERRSTAT                  FIND ERROR STATUS      @Y17XARR 78730000
         OI    OCALSTAT,OCNONE          SET NONE WERE RELEASED @Y17XARR 78732000
         B     ADJSUBST                 GET NEXT SUBENTRY      @Y17XARR 78734000
ERRSTAT  EQU   *                                               @Y17XARR 78736000
         TM    OCALSTAT,OCALL           ALL RELEASED?          @Y17XARR 78738000
         BNO   ADJSUBST                 NO,SOME RELEASED       @Y17XARR 78740000
         NI    OCALSTAT,AVTEFF-OCALL    CHANGE TO NEW STATUS   @Y17XARR 78742000
         OI    OCALSTAT,OCSOME          SET SOME RELEASE       @Y17XARR 78744000
         B     ADJSUBST                 GET ADJACENT ENTRY     @Y17XARR 78746000
CHKSTAT  EQU   *                                               @Y17XARR 78748000
         TM    OCALSTAT,OCALL           ORIG STATUS IN AFFECT? @Y17XARR 78750000
         BNZ   CHKSTAT1                 NO CHECK OTHER STATUS  @Y17XARR 78752000
         OI    OCALSTAT,OCALL           TO ALL RELEASED        @Y17XARR 78754000
         B     ADJSUBST                 GET ADJACENT ENTRY     @Y17XARR 78756000
CHKSTAT1 EQU   *                                               @Y17XARR 78758000
         TM    OCALSTAT,OCALL           ALL RELEASED?          @Y17XARR 78760000
         BO    ADJSUBST                 LEAVE STATUS AS IS     @Y17XARR 78762000
         TM    OCALSTAT,OCSOME          SOME RELEASED?         @Y17XARR 78764000
         BO    ADJSUBST                 LEAVE STATUS AS IS     @Y17XARR 78766000
         NI    OCALSTAT,AVTEFF-OCNONE   CHANGE STATUS          @Y17XARR 78768000
         OI    OCALSTAT,OCSOME          TO SOME RELEASED       @Y17XARR 78770000
ADJSUBST EQU   *                                               @Y17XARR 78772000
         SR    RPARM,RPARM              CLEAR TO GET TNTINDEX  @Y17XARR 78774000
         ICM   RPARM,HALFWORD,TRMCOHRT  GET TNTINDEX           @Y17XARR 78776000
         BZ    SETMSGID                 HERIARCHY GONE         @Y17XARR 78777000
         STCM  RPARM,HALFWORD,OCTRMTBL  SAVE TNT INDEX         @Y17XARR 78778000
         CLC   OCSEQ,OCTRMTBL           SAME TNT INDEX?        @Y17XARR 78780000
         BE    SETMSGID                 YES,SETUP MSG          @Y17XARR 78782000
         BAL   RRET,GETTTE              GET TTE ADDRESS        @Y17XARR 78784000
         ICM   RPARM,FULLWORD,OPCTRMWA  GET ORIG TTE           @Y17XARR 78786000
         CLI   TRMTYPE-IEDNTRM(RPARM),TRMSDLC    ORIG LINE?    @Y17XARR 78788000
         BNE   SINGL                    CURRENT ENTRY IS LU    @Y17XARR 78790000
         CLI   TRMTYPE,TRMLUNT          CURRENT ENTRY LU?      @Y17XARR 78792000
         BE    SINGL                    CURRENT ENTRY IS LU    @Y17XARR 78794000
         C     RTERM,OCMODNME+FRSTWORD  IS THIS PU THE ORIG?   @Y17XARR 78796000
         BNE   SUBENTRY                 GET NEXT SUBSTRUCTURE  @Y17XARR 78798000
         SR    RPARM,RPARM              CLEAR TO GET TNT INDEX @Y17XARR 78800000
         ICM   RPARM,HALFWORD,TRMCOHRT  GET NEXT PU            @Y17XARR 78802000
         BZ    SETMSGID                 HEIRARCHY GONE         @Y17XARR 78803000
         BAL   RRET,GETTTE              GET STATION ADDRESS    @Y17XARR 78804000
         C     RTERM,OPCTRMWA           IS THIS ORIG?          @Y17XARR 78806000
         BNE   SUBENTRY                 NO, A PU SUBSTRUCT     @Y17XARR 78808000
         MVC   OCTRMTBL,OCSEQ           RESTORE ORIG TNT INDEX @Y17XARR 78810000
SETMSGID EQU   *                                               @Y17XARR 78812000
         TM    OCALSTAT,OCALL           ALL RELEASED?          @Y17XARR 78814000
         BO    ALLSET                   PUT OUT ALL MSG        @Y17XARR 78816000
         TM    OCALSTAT,OCSOME          SOME RELEASED?         @Y17XARR 78818000
         BZ    NONESET                  PUT OUT NONE MSG       @Y17XARR 78820000
         LA    RPARM,SOMERELS           SOME RC FOR TOTE/MPP   @Y17XARR 78822000
         LA    RZERO,SOMEMSG            SOME RELEASED MSG NO   @Y17XARR 78824000
         B     SETEXTID                 SETUP MODS TO GET CNTRL@Y17XARR 78826000
NONESET  EQU   *                                               @Y17XARR 78828000
         LA    RPARM,NONERELS           NONE RELSE RC TOTE/MPP @Y17XARR 78830000
         LA    RZERO,NONEMSG            NONE RELSE MSG NUM     @Y17XARR 78832000
         MVC   OPCMODID,MOVEMSG         MOD TO GET CONTROL NEXT@Y17XARR 78834000
         XC    OCWTG,OCWTG              00 TO GET AFTERWARDS   @Y17XARR 78836000
         B     NEXTCHK                  GIVE CONTROL TO MSG MOD@Y17XARR 78838000
ALLSET   EQU   *                                               @Y17XARR 78840000
         LA    RPARM,ALLRELSE           ALL RC FOR TOTE/MPP    @Y17XARR 78842000
         LA    RZERO,ALLMSG             ALL MSG NUMBER         @Y17XARR 78844000
SETEXTID EQU   *                                               @Y17XARR 78846000
         STH   RZERO,OCPARM             SETUP MSG FOR CHKPT    @Y71XARR 78848000
         MVC   OPCMODID,CHECKPT         CHECKPOINT NEEDED      @Y17XARR 78850000
         MVC   OCWTG,MOVEMSG            MSG MOD TO GET CNTRL   @Y17XARR 78852000
         SPACE                                                          78900022
NEXTCHK  EQU   *                                                        79200022
         TM    OPCSPEC,OPCRSTRT         RESTART IN PROGRESS             79500022
         BO    XCTL                     YES                             79800022
         SPACE                                                          80100022
         TM    OCFLAG,OCTOTE+OCMPP      TOTE OR MPP?                    80400022
         BZ    XCTL                     NO, GO TO NEXT MODULE           80700022
         SPACE                                                          81000022
         MVC   OCWTG(NAMELEN),WRTXCTL   SET TO GO DIRECTLY TO WRITER    81300022
         STH   RPARM,OCPARM             SET RETURN CODE                 81600022
         LR    RZERO,RPARM              SET RETURN CODE                 81900022
         LTR   RPARM,RPARM              ERROR SET?                      82200022
         BZ    XCTL                     NO, CALL CHECKPOINT             82500022
         SPACE                                                          82800022
         MVC   OPCLDNME+VARINAME(NAMELEN),WRTXCTL GO DIRECTLY TO WRTIE  83100022
XCTL     EQU   *                                                        83400022
         NI    OPCFLAG1,AVTEZERO        CLEAR ALL FLAGS                 83700022
         LR    RPARM,ROPCAVT            SET AVT POINTER FOR XCTL        84000022
         SPACE                                                          84300022
         XCTL  SF=(E,OPCXCTL)           CALL FOR NEXT MODULE            84600022
         SPACE 2                                                        84900022
GETTTE   EQU   *                                               @Y17XARR 84920000
         LR    RSAVER14,RRET            SAVE RETURN ADDRESS    @Y17XARR 84940000
         L     RBRNCH,AVTRNMPT          GET TNT BASE           @Y17XARR 84960000
         BALR  RRET,RBRNCH              CALL TO GET TTE ADDR   @Y17XARR 84980000
         LR    RTERM,RPARM              GET TTE ADDRESS        @Y17XARR 85000000
         LA    RPARM,TRMPRFSZ           GET PREFIX LENGTH      @Y17XARR 85020000
         SR    RTERM,RPARM              BACKUP TO PREFIX       @Y17XARR 85040000
         LR    RRET,RSAVER14            RESTORE RETURN ADDRESS @Y17XARR 85060000
         BR    RRET                     RETURN TO THE CALLER   @Y17XARR 85080000
         SPACE 2                                                        85100000
MOVENAME MVC   OPCDOUBL(AVTEZERO),AVTEZERO(RSCAN) PLACE NAME            85200022
MOVERLN  MVC   OPCDOUBL(ZERO),ZERO(RSCAN)  MOVE RLN            @Y17XARR 85300000
PACKRLN  PACK  OPCDOUBL+UNUSED(PACKLEN),OPCDOUBL(ZERO) PACK    @Y17XARR 85400000
         SPACE 2                                                        85500022
ZAPAREA  DC    100X'FF'                 ZAPAREA                @Y17XARR 85600000
         SPACE 3                                                        85700000
LENTP    DC    H'03'                    LENGTH OF TP=                   86100022
RLNLEN   DC    H'3'                     LEN OF POSSIBLE RLN    @Y17XARR 86130000
MAXRLN   DC    H'255'                   MAXIMUM RLN            @Y17XARR 86160000
RLNRETCD DC    H'8'                     R  C   FROM DCBLOCAT   @Y17XARR 86190000
NAME     DC    H'8'                     LENGTH OF ENTRY        @Y17XARR 86220000
INACTNCP DC    H'2'                     R C NCP INACTIVE       @Y17XARR 86250000
MOVEMSG  DC    C'0H'                    MSG MOD FOR ALL,SOME,  @Y17XARR 86280000
*                                       NONE MSGS              @Y17XARR 86310000
TPID     DC    C'TP='                   COMMAND ID                      86400022
XCTL03   DC    C'03'                    ERROR MODULE NAME               86700022
CHECKPT  DC    C'06'                    CHECKPOINT MODULE NAME          87000022
WRTXCTL  DC    C'07'                    OUTPUT MODULE                   87300022
WRTMSG   DC    C'09'                    HOLD, RELEASE, AND VARY MESSAGE 87310000
COMMA    EQU   X'6B'                    COMMA                  @Y17XARR 87320000
LOWEST   EQU   X'F0'                    ZERO INVALID RLN       @Y17XARR 87330000
HIGHEST  EQU   X'F9'                    NINE VALID RLN         @Y17XARR 87340000
UNUSED   EQU   6                        BYTES NOT USED  - PACK @1Y7XARR 87350000
PACKLEN  EQU   2                        BYTES USED IN THE PACK @Y17XARR 87360000
HALFWORD EQU   3                        LENGTH OF TNT INDEX    @Y17XARR 87370000
FULLWORD EQU   15                       GET FOUR BYTESOF DATA  @Y17XARR 87380000
DATAINDX EQU   8                        WHERE THE DATA IS IN   @Y17XARR 87390000
*                                       THE WORKAREA           @Y17XARR 87400000
INDEX    EQU   1                        TO POINT TO NEXT BYTE  @Y17XARR 87410000
NVALDRLN EQU   8                        R C FOR INVALID RLN    @Y17XARR 87420000
RLNERR   EQU   524                      RLN INCORRECTLY SPEC   @Y17XARR 87430000
NOSUBSTR EQU   561                      GEN'D INCORRECTLY      @Y17XARR 87440000
BADGRP   EQU   16                       BADNAME                @Y17XARR 87450000
BADGRPRC EQU   X'20'                    R C BADNAME            @Y17XARR 87460000
DSLGB    EQU   X'80'                    LGB INDICATOR          @Y17XARR 87470000
INVALID  EQU   18                       INVALID COMMAND MSG    @Y17XARR 87480000
BADREQST EQU   4                        TYPICAL ERROR          @Y17XARR 87490000
ALLMSG   EQU   522                      ALL RELEASED MSG NUM   @Y17XARR 87500000
SOMERELS EQU   X'28'                    RC FOR SOME RELEASED   @Y17XARR 87510000
ALLRELSE EQU   0                        GOOD R C ALL RELEASED  @Y17XARR 87520000
SOMEMSG  EQU   521                      SOME RELEASED          @Y17XARR 87530000
NONEMSG  EQU   523                      NONE RELEASED MSG      @Y17XARR 87540000
NONERELS EQU   X'24'                    R C NONE WERE RELEASED @Y17XARR 87550000
INACTRCD EQU   X'1C'                    R C 3705 DOWN          @Y17XARR 87560000
FRSTWORD EQU   4                        PT TO 2ND WORD OF DWORD@Y17XARR 87570000
ASUMEBAD EQU   4                        INDICATE AN ERROR      @Y17XARR 87580000
         SPACE 3                                                 Y05330 87600705
         EJECT                                                   Y05330 87859705
***                 DSECTS                             ***       Y05330 87860405
         TDCTD                                                          87860600
         EJECT                                                          87860800
         DCBD  DSORG=TX                                          Y05330 87889805
         EJECT                                                          87890100
         TITLE 'IGCR010D - DSECTS REFERENCED BY THIS MODULE'            88200022
         TAVTD                                                          88500022
         EJECT                                                          88800022
         TOPCAVTD                                                       89100022
         EJECT                                                          89400022
         TOPCED                                                         89700022
         EJECT                                                          90000022
         TPRFD                                                          90300022
         EJECT                                                          90600022
         TPRIOR                                                         90900022
         EJECT                                                          91200022
         TTRMD                                                          92100022
         EJECT                                                          92200000
         TQCBD                                                          92300000
         END                                                            92400022
