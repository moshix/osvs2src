         TITLE 'IGCV010D - VARY SCAN MODULE'                            00100022
IGCV010D CSECT                                                          00200022
         SPACE 3                                                 S21903 00205005
*CHANGE ACTIVITY=AS FOLLOWS:                                            00210022
******************** MICROFICHE FLAGS *********************** SUPT CODE 00220022
*A000000-999999                                                  S99240 00250022
*C479000-485000                                                 SA56606 00250122
*D449100-449800                                                 SA61099 00250204
*C 377000-380000                                                SA63002 00250305
*A379360                                                       @SA73342 00260358
*A379970                                                        OY03916 00270305
*A191000,331500,378600                                         @OY12425 00270500
*C090000,097000,161000,185000,193000,197000-211800,            @OY12425 00270700
*C280000-281000,333000,379002,500000                           @OY12425 00270900
*D123000,129000,131000,142300,212600-266000,267000-274000,     @OY12425 00271100
*D316000-316300,325050-325750,327000-328000,348000-358000,     @OY12425 00271300
*D455000,458000-475000,475500                                  @OY12425 00271500
*A098000                                                       @Y17XART 00272300
*A379174                                                       @Y17XART 00274300
*A379300                                                       @Y17XART 00276300
*A379540,388000                                                @Y17XART 00278300
*A381500                                                       @Y17XART 00280300
*A456500                                                       @Y17XART 00282300
*A500000                                                       @Y17XART 00284300
*D389000-389400                                                @Y17XART 00286300
*C443000                                                       @Y17XART 00288300
*A142800,387000,390000,426000,442200,498000                    @OY14092 00293300
*A360400                                                       @OY15465 00296300
*C456818-456824                                                @OY18838 00297300
*C185500                                                       @OZ27693 00297482
*********************************************************************** 00300022
*                                                                     * 00400022
* MODULE NAME=IGCV010D (TCAM,OP CTL)                           @Y17XART 00405000
*                                                                     * 00420022
* DESCRIPTIVE NAME=VARY SCAN MODULE                                   * 00430022
*                                                                     * 00440022
* COPYRIGHT='NONE'                                                    * 00450022
*                                                                     * 00460022
*  STATUS:  CHANGE LEVEL 10                                    @Y17XART 00480000
*                                                                     * 00600022
* FUNCTION -- THIS ROUTINE CHECKS VARY COMMANDS FOR SYNTAX ERRORS AND * 00700022
*    OTHER ROUTINE ERRORS COMMON TO DIFFERENT TYPES OF VARY COMMANDS. * 00800022
*    THE WORKAREA IS CHECKED TO DETERMINE THE TYPE OF INPUT.  IF IT IS* 00900022
*    DCB ADDRESS, THE DEB ADDRESS IS OBTAINED FROM DCBDEBAD.  IF IT IS* 01000022
*    TERMINAL NAME INPUT, THE TERMINAL NAME TABLE IS SEARCHED FOR A   * 01100022
*    MATCHING ENTRY.  IF NONE IS FOUND THE ERROR REGISTER IS SET UP   * 01200022
*    WITH APPROPRIATE NUMBER AND CONTROL IS TRANSFERRED TO AN ERROR   * 01300022
*    MODULE.  IF INPUT IS DDNAME/RLN FORMAT AND STILL IN CHARACTER    * 01400022
*    FORMAT, IT IS CONVERTED TO HEXADECIMAL AND TESTED FOR ZERO OR    * 01500022
*    GREATER THAN 255.  IF EITHER, AN ERROR EXIT IS TAKEN.  THE DDNAME* 01600022
*    IS VERIFIED THROUGH A DCB LOOKUP ROUTINE IN THE CONTROL MODULE.  * 01700022
*    IF IT IS NOT A VALID DDNAME, AN ERROR EXIT IS TAKEN.  IF INPUT   * 01800022
*    IS IN LINE ADDRESS FORMAT, THE SAME DCB LOOKUP ROUTINE IS USED   * 01900022
*    TO TEST EACH UCB ASSOCIATED WITH A DEB FOR AN ID MATCHING THE    * 02000022
*    ADDRESS SPECIFIED.  IF A MATCH IS NOT FOUND, AN ERROR EXIT IS    * 02100022
*    TAKEN.  AFTER THE INPUT IS COMPLETELY VERIFIED, CONTROL IS PASSED* 02200022
*    TO THE APPROPRIATE FUNCTION MODULE AS DETERMINED BY THE COMMAND. * 02300022
*    VARY COMMANDS FOR DEVICES OFF AN RN ARE ALSO SCANNED BY THISS22024 02320022
*    MODULE.  VARY COMMANDS FOR THE RN ITSELF ARE TREATED AS AN  S22024 02340022
*    ERROR SITUATION.                                            S22024 02360022
*    VARY COMMANDS FOR THE SSCP ARE TREATED AS AN ERROR.       @Y17XART 02368000
*    IN A RESTART SITUATION THE NCP WILL NOT BE CHECKED FOR    @Y17XART 02376000
*    ACTIVE. THE COMMAND WILL BE PASSED ON TO THE FUNCTION     @Y17XART 02384000
*    MODULE.                                                   @Y17XART 02392000
*                                                                     * 02400022
* ENTRY POINTS --                                                     * 02500022
*    IGCV010D TO SCAN VARY COMMANDS.                                  * 02600022
*                                                                     * 02700022
* INPUT --                                                            * 02800022
*    REGISTER 1 - ADDRESS OF OPERATOR CONTROL AVT.  RELEVANT FIELDS   * 02900022
*    ARE OPCDOUBL.  IT CONTAINS EITHER THE DDNAME OR UCB ADDRESS LEFT * 03000022
*    JUSTIFIED.  OPCFLAG1 IS USED TO INDICATE THAT CERTAIN PUNCTUATION* 03100022
*    IN THE COMMAND HAS BEEN FOUND.  OPCCOPCE IS THE ADDRESS OF THE   * 03200022
*    CURRENT ELEMENT.  RELEVANT FIELDS ARE OCOPTCDE.  THIS HAS THE    * 03300022
*    VERB CODE.  OCRLN CONTAINS THE RLN.  OCFLAG INDICATES THE SOURCE * 03400022
*    OF THE INPUT.  OCSWITCH CONTAINS THE SUBOPERATION CODE.          * 03500022
*                                                                     * 03600022
* OUTPUT --                                                           * 03700022
*    REGISTER 0 - NUMBER OF AN ERROR MESSAGE.                         * 03800022
*    REGISTER 1 - RETURN CODE SET.                                    * 03900022
*    THE FOLLOWING MODULES ARE GIVEN CONTROL (BY XCTL) FROM THIS      * 04000022
*    MODULE DEPENDING ON THE FUNCTION TO BE PERFORMED.                * 04100022
*         IGCV110D STOPLINE                                           * 04200022
*         IGCV210D STOP TERMINAL                                      * 04300022
*         IGCV310D START LINE                                         * 04400022
*    FOR RN DEVICES MODULE IGCV810D IS XCTLED TO FROM IGCV110D   S22024 04500022
*    FOR STOPLINE COMMANDS.  MODULE IGCV910D IS XCTLED TO FROM   S22024 04520022
*    IGCV210D FOR START/STOP TERMINAL COMMANDS.  IGCV310D DOES   S22024 04540022
*    THE RN STARTLINE.                                           S22024 04560022
*                                                                     * 04600022
* EXTERNAL REFERENCES --                                              * 04700022
*         NONE.                                                       * 04800022
*                                                                     * 04900022
* EXITS,NORMAL --                                                     * 05000022
*         COMMAND COMPLETELY VERIFIED.  XCTL TO APPROPRIATE FUNCTION  * 05100022
*         MODULE WITH OCSWITCH SET UP.                                * 05200022
*                                                                     * 05300022
* EXITS,ERROR --                                                      * 05400022
*    COMMAND INVALID FOR 3705 ITSELF.                            S22024 05450022
*         INVALID STATION NAME, LINE NOT OPEN, INVALID FORMAT, INVALID* 05500022
*         VERB, OR INVALID RLN.  ERROR REGISTER SET UP, X'04' RETURN  * 05600022
*         CODE SET.                                                   * 05700022
*                                                                     * 05800022
* TABLES/WORK AREAS --                                                * 05900022
*    OPERATOR CONTROL AVT, OPERATOR CONTROL ELEMENT, DEB, DCB, LCB,   * 06000022
*    QCB,TERMNAME TABLE, TERMINAL ENTRY, AVT, AND RSIDT.         S22024 06100022
*                                                                     * 06200022
* ATTRIBUTES --                                                       * 06300022
*    SERIALLY REUSABLE, REFRESHABLE, ENABLED, TRANSIENT,              * 06400022
*    SUPERVISOR MODE.                                                 * 06500022
*                                                                     * 06600022
* CHARACTER CODE DEPENDENCY --                                        * 06700022
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL            * 06800022
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS            * 06900022
*    EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME.  THE CODING         * 07000022
*    HAS BEEN ARRANGED SO THAT REDEFINITION OF CHARACTER              * 07100022
*    CONSTANTS, BY REASSEMBLY WILL RESULT IN A CORRECT MODULE         * 07200022
*    FOR THE NEW DEFINITION.                                          * 07300022
*                                                                     * 07400022
* NOTES --                                                            * 07500022
*    COMMUNICATIONS BETWEEN THE VARIOUS TRANSIENT MODULES IS          * 07600022
*    PRIMARILY THROUGH THE OPERATOR CONTROL AVT.                      * 07700022
*                                                                     * 07800022
*********************************************************************** 07900022
         EJECT                                                          08000022
         SPACE                                                          08100022
*                                 E Q U A T E S                         08200022
         SPACE                                                          08300022
RZERO    EQU   0                        PARAMETER REGISTER              08400022
RPARM    EQU   1                        PARAMETER REGISTER              08500022
ROPCAVT  EQU   2                        POINTER TO OP CONTROL AVT       08600022
ROPCE    EQU   3                        POINTER TO CURRENT ELEMENT      08700022
RAVT     EQU   4                        POINTER TO TCAM AVT             08800022
RWORKA   EQU   5                        POINTER TO RESIDENT WORKAREA    08900022
RLCB     EQU   6                        LCB ADDRESS              S22024 08950022
REND     EQU   6                        END ADDR OF DATA RECVD @OY12425 09000000
RDCB     EQU   7                        POINTER TO DCB                  09100022
RSTART   EQU   7                        START ADDR OF CURRENT SCAN      09200022
RWORK    EQU   8                        WORK REGISTER                   09300022
RLEN     EQU   9                        LENGTH OF PARAMETER             09500022
RHOLD    EQU   10                       REGISTER TO SAVE VALUE          09600022
RSCAN    EQU   11                       SCAN PTR TO DATA       @OY12425 09700000
RBASE    EQU   12                       MODULE BASE REGISTER            09800022
RSAVE    EQU   13                       SAVE AREA REG          @Y17XART 09850000
RRET     EQU   14                       SUBROUTINE RETURN ADDRESS       09900022
RBRNCH   EQU   15                       SUBROUTINE BASE REGISTER        10000022
         SPACE 2                                                        10100022
ALLRLN   EQU   X'20'                    ALL WAS SPECIFIED AS RLN        10300022
BADCMND  EQU   18                       ERROR FOR INVALID COMMAND       10400022
CLEAR    EQU   7                        PROPAGATE BLANKS                10500022
COMMA    EQU   C','                     COMMA IN DATA                   10600022
CMNDOFF  EQU   4                        OFFSET IN TABLE TO COMMAND      10700022
CURRENT  EQU   0                        CURRENT SCANNED BYTE            10800022
DDSWIT   EQU   X'10'                    PROCESSING LINE NO. OR DDNAME   10900022
DIALERR  EQU   88                       DIAL VARY ERROR MSG    @YM08035 10950000
DOUBLWD  EQU   8                        SAVE ENTIRE EIGHT BYTES         11000022
ENDTABLE EQU   X'FF'                    END OF TABLE INDICATOR          11100022
ENTRYLEN EQU   13                       LNG OF VERIFY TBL ENTRY SA56606 11200022
EQUAL    EQU   8                        EQUAL COMPARE                   11300022
FOUR     EQU   4                        LENGTH OF FOUR                  11400022
INVSTAT  EQU   16                       ERROR IN STATION NAME           11500022
LENOFF   EQU   2                        OFFSET TO COMMAND LENGTH IN WA  11600022
LPAREN   EQU   128                      INDICATE L PAREN FOUND          11700022
MODOFF   EQU   2                        OFFSET TO MODULE NAME           11800022
MSGOFF   EQU   8                        OFFSET TO START OF MSG          11900022
NAMELEN  EQU   2                        LENGTH OF MOD NAME CHANGE       12000022
NEXT     EQU   1                        NEXT BYTE TO BE SCANNED         12100022
NORLN    EQU   X'40'                    FLAG FOR NO RLN IN MSG @YM08035 12150000
NOTOPEN  EQU   17                       BAD DD ERROR                    12200022
OFFON    EQU   C'O'                     O FOR ONTP OR OFFTP             12400022
ONE      EQU   1                        VALUE OF ONE                    12500022
OPEN     EQU   X'10'                    DCB OPEN FLAG                   12600022
PARENL   EQU   C'('                     LEFT PARENTHESIS                12700022
PARENR   EQU   C')'                     RIGHT PARENTHESIS               12800022
RPAREN   EQU   64                       FLAG FOR RIGHT PAREN FOUND      13000022
SIZEOFF  EQU   0                        OFFSET IN TABLE TO COMMAND SIZE 13200022
SWITOFF  EQU   1                        OFFSET TO COMMAND SWITCH VALUE  13300022
TIOT     EQU   12                       OFFSET TO TIOT IN TCB           13400022
TWO      EQU   2                        LENGTH OF 2                     13500022
VARINAME EQU   3                        OFFSET TO CHANGE MODULE NAME    13600022
VERBOFF  EQU   0                        OFFSET TO VERB IN TABLE ENTRY   13700022
ZERO     EQU   0                        NULL VALUE                      13800022
NOTCA    EQU   2                        INDICATES ENTRY NOT FROM CA     14000022
TIOTDDNM EQU   4                        DDNAME OFFSET IN TIOT           14100022
MODUL    EQU   1                        MODULE OFFSET IN RESTART TABLE  14200022
NOPEN05  EQU   161                      3705 DCB NOT OPEN MSG    S22024 14210022
RNDSORG  EQU   X'04'                    DSORG VALUE              S22024 14220022
OPENLGB  EQU   X'10'                    OPEN FLAG                S22024 14250022
THREE    EQU   3                        CONSTANT FOR INDEXING    S22024 14263022
FIVE     EQU   5                        CONSTANT FOR INDEXING    S22024 14266022
NOTSINGL EQU   90                       'NOT SINGLE ENTRY' CODE  S22024 14267000
SINGLE   EQU   X'E0'                    SINGLE ENTRY             S22024 14268000
DSLGB    EQU   X'80'                    LINE GROUP BLOCK ID      S22024 14270022
ADDRESS  EQU   7                        LOW ORDER 3 BYTES      @Y17XARR 14275000
NACTIV05 EQU   400                      3705 NOT ACTIVE MESSAGE  Y06330 14280005
NOSTART  EQU   X'BF'                    FLAG TO RESET START    @OY14092 14282000
*                                       LINE SWITCH            @OY14092 14284000
IPLDMP   EQU   210                      IPL/DUMP-ACT/DEACT IN  @Y17XART 14286000
*                                       PROGRESS MSG NUMBER    @Y17XART 14292000
         EJECT                                                          14300022
         USING IEDQAVTD,RAVT            TCAM AVT ADDRESSABILITY         14400022
         USING IEDQOPCE,ROPCE           ELEMENT DSECT ADDRESSABILITY    14500022
         USING IEDQOPCD,ROPCAVT         ADDRESSABILITY FOR OPC AVT      14600022
         USING IHADCB,RDCB              ADDRESSABILITY FOR DCB   S22024 14630022
         SPACE                                                          14700022
         BALR  RBASE,RZERO              SET BASE REGISTER               14800022
         USING *,RBASE                  MODULE ADDRESSABILITY           14900022
*              INITIAL SETUP                                          * 15500022
         L     RWORKA,OPCWORK           WORKAREA ADDRESS                15900022
         TM    OPCSPEC,OPCRSTRT         RESTART IN PROGRESS             16000022
         BO    NOTMPP                   YES, SAVE NAME         @OY12425 16100000
         SPACE                                                          16200022
         MVI   OPCDOUBL,AVTEBLNK        CLEAR FIRST BYTE                16300022
         MVC   OPCDOUBL+ONE(CLEAR),OPCDOUBL CLEAR DOUBLE WORD           16400022
         TM    OCFLAG,OCMPP+OCTOTE      TOTE OR MPP INPUT               16500022
         BZ    TERMIN                   NO, TERMINAL INPUT              16600022
         SPACE                                                          17000022
         CLI   OCBACKUP,AVTEZERO        DCB ADDRESS? (QTAM)             17100022
         BNE   NOTMPP                   NO, DATA IS GOOD                17200022
         SR    RZERO,RZERO              CLEAR REG 0            @YM08560 17250000
         SPACE                                                          17300022
         L     RDCB,OCBACKUP            GET DCB ADDRESS                 17400022
         USING IHADCB,RDCB              DCB ADDRESSABILITY              17500022
         TM    DCBOFLGS,OPEN             DCB OPEN?                      17600022
         BNO   ERROR17                  NO, ERROR                       17700022
         LA    RWORK,LGBNAME-IEDNLGB-TIOTDDNM(RDCB) SET IN CASE  S22024 17720000
*                                        DCB IS LGB              S22024 17740000
         TM    DCBDSORG,TRMLGB          IS THIS AN LGB           S22024 17760000
         BO    SETBCKUP                 YES, BRANCH              S22024 17780000
         SPACE                                                          17800022
         L     RWORK,AVTTCB             GET TCAM TCB ADDRESS            17900022
         L     RWORK,TIOT(RWORK)        GET TIOT ADDRESS                18000022
         AH    RWORK,DCBDDNAM           ADD TIOT OFFSET FROM DCB        18100022
SETBCKUP EQU   *                                                 S22024 18150000
         MVC   OCBACKUP(DOUBLWD),TIOTDDNM(RWORK) SAVE DDNAME            18200022
NOTMPP   EQU   *                                                        18300022
SETDOUBL MVC   OPCDOUBL(DOUBLWD),OCBACKUP DDNAME FOR VERIFY      S22024 18400000
         B     LASTCHEK                 END OF INPUT CHECK     @OY12425 18500000
IGCV010D IEDHJN AFTERHJN,HJN            INCLUDE NAME IN HJN    @OZ27693 18550082
         SPACE                                                          18600022
TERMIN   EQU   *                                                        18700022
         LH    REND,LENOFF(RWORKA)      GET COMMAND LENGTH              18800022
         LA    REND,MSGOFF(RWORKA,REND) SET END OF MESSAGE POINTER      18900022
         MVI   AVTEZERO(REND),AVTEBLNK  SET ENDING BLANK                19000022
         LA    RSCAN,MSGOFF(RWORKA)     GET SCAN STARTING ADDRESS       19100022
         LR    RSTART,RSCAN             LOAD START ADDR        @OY12425 19120000
         OI    OCSCAN,OCADDR+OCDDNRLN+OCDDNAME+OCALLRLN        @OY12425 19140000
*    FIELD CAN BE ADDR, DDN,RLN, OR DDNAME, AND RLN CAN BE ALL @OY12425 19160000
         CLI   CURRENT(RSCAN),PARENL    LEFT PAREN FOUND?               19200022
         BNE   CKOFFON                  NO PARENS              @OY12425 19300000
         SPACE                                                          19400022
         OI    OPCFLAG1,LPAREN          INDICATE PAREN FOUND            19500022
         LA    RSCAN,NEXT(RSCAN)        POINT TO NEXT BYTE              19600022
         NI    OCSCAN,AVTEFF-OCADDR     NOT A UCB ADDRESS      @OY12425 19700000
         LR    RSTART,RSCAN             LOAD START ADDR        @OY12425 19710000
CKOFFON  EQU   *                                               @OY12425 19720000
*   THIS CODE FINDS FIRST DELIMITER IN COMMAND AND SAVES       @OY12425 19730000
*        FIELD IN OPCDOUBL                                     @OY12425 19740000
         CLI   ZERO(RSCAN),COMMA        IS IT A COMMA?         @OY12425 19750000
         BE    MOVENAME                 YES, SAVE NAME         @OY12425 19760000
         CLI   ZERO(RSCAN),PARENR       IS IT A RIGHT PAREN?   @OY12425 19770000
         BE    SETPAREN                 NO, GO CHK NEXT BYTE   @OY12425 19780000
         CR    RSCAN,REND               HAVE WE REACHED EOM?   @OY12425 19790000
         LA    RSCAN,ONE(RSCAN)         INCR PTR BY ONE        @OY12425 19800000
         BL    CKOFFON                  CHECK NEXT BYTE        @OY12425 19810000
         B     ERROR18                  ELSE, ERROR            @OY12425 19820000
SETPAREN EQU   *                                               @OY12425 19830000
         OI    OPCFLAG1,RPAREN          INDICATE PAREN FOUND   @OY12425 19840000
MOVENAME EQU   *                                               @OY12425 19850000
*********************************************************************** 19860000
*                                                                     * 19870000
*   THE ADDRESS OF FIRST DELIM IS SAVED SO THAT A CHECK CAN BE @OY12425 19880000
*   MADE AT A LATER POINT FOR EXTRA FIELDS BETWEEN THE FIRST   @OY12425 19890000
*   DELIM AND 'OFFTP' OR 'ONTP'                                @OY12425 19900000
*                                                                     * 19908000
*********************************************************************** 19916000
         ST    RSCAN,OCLINK             SAVE ADDR OF 1RST DELIM@OY12425 19924000
         LR    RLEN,RSCAN               GET SCAN PTR           @OY12425 19932000
         SR    RLEN,RSTART              GET LENGTH OF DATA     @OY12425 19940000
         BZ    ERROR18                  IF LENGTH ZERO, ERROR  @OY12425 19948000
         CH    RLEN,MAX                 IS LENGTH > MAX?       @OY12425 19956000
         BH    ERROR18                  YES,ERROR              @OY12425 19964000
         BCTR  RLEN,RZERO               PREPARE FOR EXECUTE    @OY12425 19972000
         EX    RLEN,PLACNAME            SAVE NAME IN OPCDOUBL  @OY12425 19980000
CKOH     EQU   *                                               @OY12425 19988000
         CLC   ZERO(TWO,RSCAN),OH       SEARCH FOR ',O'        @OY12425 20000000
         BE    TSTINPUT                 SCAN FOR TYPE OF CMD   @OY12425 20010000
         CR    RSCAN,REND               HAVE WE REACHED EOM?   @OY12425 20020000
         LA    RSCAN,ONE(RSCAN)         INCR TO NXT BYTE       @OY12425 20030000
         BL    CKOH                     CHECK NEXT BYTE        @OY12425 20040000
         B     ERROR18                  REACHED EOM-BAD CMD    @OY12425 20050000
         SPACE                                                          20060000
*              CHECK TO SEE IF VALID COMMAND                          * 20070000
TSTINPUT EQU   *                                                        20080000
         LA    RSCAN,ONE(RSCAN)         SET PTR PAST DELIM     @OY12425 20090000
         LA    RWORK,CMNDTBL-FIVE       POINT IN FRONT OF        S22024 20100000
*                                       CMD TABLE                S22024 20110000
         MVC   OCBACKUP(DOUBLWD),OPCDOUBL  SAVE INPUT                   20120000
         SR    RLEN,RLEN                CLEAR LENGTH REGISTER    S22024 20130000
         SPACE                                                          20140000
*              TERMINAL OR CONSOLE INPUT                              * 20150000
FINDCMND EQU   *                                                        20160000
         LA    RWORK,FIVE(RLEN,RWORK)   POINT TO NEXT ENTRY      S22024 20170000
         CLI   SIZEOFF(RWORK),ENDTABLE  END OF TABLE?                   20180000
         BE    ERROR18                  YES,INVALID CMD                 20190000
         IC    RLEN,SIZEOFF(RWORK)      GET COMMAND LENGTH              20200000
         EX    RLEN,CMNDCHEK            VERIFY REMANINING CMD           20210000
         BNE   FINDCMND                 IF NOT THIS CMD,         S22024 20220000
*                                       CHECK NEXT CMD           S22024 20230000
         MVC   OCSWITCH(ONE),SWITOFF(RWORK)  SAVE SWITCH VALUE @OY12425 20240000
         MVC   OPCLDNME+VARINAME(NAMELEN),MODOFF(RWORK) SET NXT MODULE  20250000
*                                                              @OY12425 20260000
         TM    OCSWITCH,DDSWIT          CMD FOR DCB OR LINE NO?@OY12425 20270000
         BNO   CKPAREN                  NO, GO CHK FOR PARENS  @OY12425 20280000
*********************************************************************** 20290000
*                                                                     * 20300000
*   ADDR OF LAST DELIM FOUND IS SAVED IN OCLINK. A CHECK WILL  @OY12425 20310000
*   LATER BE MADE FOR EXTRA COMMAS BY COMPARING THE ADDRESS IN @OY12425 20320000
*   OCLINK TO ADDR RETURNED BY OPCSCAN                         @OY12425 20330000
*                                                                     * 20340000
*********************************************************************** 20350000
         BCTR  RSCAN,RZERO              SETUP SCAN PTR         @OY12425 20360000
         ST    RSCAN,OCLINK             SAVE ADDR OF ',O'      @OY12425 20370000
         LR    RSCAN,RSTART             SETUP START ADDR       @OY12425 20380000
         L     RBRNCH,OPCDCBLK          PREPARE TO             @OY12425 20390000
         BAL   RRET,FOUR(RBRNCH)        BRANCH TO OPCSCAN      @OY12425 20400000
         B     CKCOMMA                  NAME WAS FOUND         @OY12425 20410000
         B     ERROR17                  NAME NOT FOUND         @OY12425 20420000
         B     ERROR18                  INVALID SYNTAX         @OY12425 20430000
CKCOMMA  EQU   *                                               @OY12425 20440000
         CLI   ZERO(RSCAN),COMMA        IS IT A COMMA?         @OY12425 20450000
         BE    LEFTPAR                  YES, CHK PARENS        @OY12425 20460000
         TM    OPCFLAG1,LPAREN+RPAREN   LEFT OR RIGHT PAREN?   @OY12425 20470000
         BNZ   ERROR18                  YES, ERROR             @OY12425 20480000
         CLI   ZERO(RSCAN),OFFON        IS IT AN 'O'?          @OY12425 20490000
         BE    RESOURCE                 YES, CONTINUE          @OY12425 20500000
         B     ERROR18                  BAD COMMAND            @OY12425 20510000
LEFTPAR  EQU   *                                               @OY12425 20520000
*   A CHECK IS MADE FOR TOO MANY COMMAS INSERTED BETWEEN FIRST @OY12425 20530000
*   DELIMITER AND 'OFFTP' OR 'ONTP'                                   * 20540000
         C     RSCAN,OCLINK             LAST BYTE SCANNED?     @OY12425 20550000
         BNE   ERROR18                  NO, ERROR              @OY12425 20560000
         LA    RSCAN,ONE(RSCAN)         INCR PTR BY ONE        @OY12425 20570000
         TM    OPCFLAG1,LPAREN+RPAREN   BOTH PARENS THERE?     @OY12425 20580000
         BO    RESOURCE                 YES, CONTINUE          @OY12425 20590000
ERROR18  EQU   *                                                        21180122
         LA    RZERO,BADCMND            SET ERROR NUMBER                21180222
ERRXCTL  EQU   *                                                        21180322
         MVC   OPCLDNME+VARINAME(NAMELEN),XCTL03 SET MODULE NAME        21180422
XCTL     EQU   *                                                        21180522
         NI    OPCFLAG1,AVTEZERO        CLEAR FLAGS                     21181422
         LR    RPARM,ROPCAVT            PASS AVT ADDRESS                21181522
         SPACE                                                          21181622
         XCTL  SF=(E,OPCXCTL)           CALL NEXT MODULE                21181722
         SPACE                                                          21240022
LASTCHEK EQU   *                                                        27500022
         LA    RWORK,CIBTABLE           POINT TO MPP, TOTE VERB TABLE   27600022
         TM    OCFLAG,OCMPP+OCTOTE      TOTE OR MPP INPUT               27700022
         BM    FINDMACH                 YES, USE LOOK-UP TABLE          27800022
         SPACE                                                          27900022
*   AT THIS POINT, WE HAVE DETERMINED RESTART IS IN PROGRESS   @OY12425 28000000
         SPACE                                                          28200022
         LA    RWORK,ONE(RWORK)         POINT TO SWITCH VALUE           28300022
FINDMACH EQU   *                                                        30500022
         CLI   VERBOFF(RWORK),ENDTABLE  END OF TABLE?                   30600022
         BE    ERROR18                  YES, BAD INPUT                  30700022
         SPACE                                                          30800022
         TM    OPCSPEC,OPCRSTRT         RESTART IN PROGRESS             30900022
         BZ    CKVERB                   NO                              31000022
         SPACE                                                          31100022
         CLC   OCSWITCH(ONE),VERBOFF(RWORK)  IS THIS COMMAND THE ONE    31200022
         BNE   INCENTRY                 NO GO TO NEXT ENTRY             31300022
         SPACE                                                          31400022
         MVC   OPCLDNME+VARINAME(NAMELEN),MODUL(RWORK) PICK UP MODULE   31500022
         B     CKSWITCH                 GO VALIDATE NAME         S22024 31660000
         SPACE                                                          31700022
CKVERB   EQU   *                                                        31800022
         CLC   OCOPTCDE(ONE),VERBOFF(RWORK) CORRECT VERB?               31900022
         BE    SETDATA                  YES, SAVE PERTINENT DATA        32000022
         SPACE                                                          32100022
INCENTRY EQU   *                                                        32200022
         LA    RWORK,FOUR(RWORK)        POINT TO NEXT ENTRY             32300022
         B     FINDMACH                  CONTINUE SEARCH                32400022
         SPACE                                                          32500022
         SPACE                                                          32595000
SETDATA  EQU   *                                                        32600022
         SPACE                                                          32900022
         MVC   OCSWITCH(ONE),SWITOFF(RWORK) SAVE SWITCH VALUE           33000022
         MVC   OPCLDNME+VARINAME(NAMELEN),MODOFF(RWORK) SET NEXT MODULE 33100022
CKSWITCH EQU   *                                                 S22024 33150000
         TM    OPCSPEC,OPCRSTRT         RESTART IN PROGRESS?   @OY12425 33160000
         BO    RESTART                  YES, CHECK TERMNAME    @OY12425 33170000
         TM    OCSWITCH,DDSWIT          COMMAND FOR DCB OR LINE NUMBER  33200022
         BNO   RESTART                  NO - TERMINATE         @OY12425 33210000
         TM    OCFLAG,OCMPP+OCTOTE      TOTE OR MPP INPUT      @OY12425 33220000
         BZ    ERROR18                  NO, ERROR              @OY12425 33230000
         SR    RPARM,RPARM              CLEAR RLN              @OY12425 33240000
         IC    RPARM,OCRLN              NO, MPP - SETUP RLN REG@OY12425 33250000
         L     RBRNCH,OPCDCBLK          GET VALIDATE ROUTINE ADDRESS    33260000
         LR    RDCB,RBRNCH              SET TO CALL DCBLKUP    @OY12425 33300000
         TM    OCFLAG,OCTOTE            TOTE INPUT?            @OY12425 33500000
         BZ    GOSCAN                   NO, GO TO DCBLOOKUP    @OY12425 33700000
         CLI   OCBACKUP+THREE,AVTEBLNK  POSSIBLE UCB?          @OY12425 33900000
         BNE   GOSCAN                   NO, GOTO DCBLKUP       @OY12425 34100000
         CLI   OCBACKUP+TWO,AVTEBLNK    POSSIBLE TWO CHAR DDN  @OY15465 34300000
         BE    GOSCAN                   YES, BRANCH            @OY15465 34500000
         LA    RDCB,FOUR(,RDCB)         SET TO CALL OPCSCAN    @OY12425 34700000
         LA    RSCAN,OCBACKUP           GET DATA ADDRESS       @OY12425 34900000
         MVI   OCSCAN,OCADDR+OCDDNAME  INDICATE UCB OR GRPNME  @OY12425 35100000
GOSCAN   EQU   *                                               @OY12425 35300000
         BALR  RRET,RDCB                GO FIND RESOURCE       @OY12425 35500000
         SPACE                                                          36100022
         B     RESOURCE                 GOOD RETURN, CHECK RESOURCES    36200022
         SPACE                                                          36300022
ERROR17  EQU   *                                                        36700022
         TM    OPCFLAG1,ALLRLN          WAS RLN=ALL?                    36800022
         BNO   NORESET                  NO, LEAVE RLN                   36900022
         SPACE                                                          37000022
         MVI   OCRLN,AVTEZERO           RESET RLN TO ALL                37100022
         BCT   RZERO,NORESET            BR IF NOT DD DUMMY     @YM08560 37130000
         B     CKCOMMA                  CONTINUE PROCESSING    @YM08560 37160000
NORESET  EQU   *                                                        37200022
         LA    RZERO,NOTOPEN            SET ERROR NUMBER                37300022
SETXCTL  EQU   *                                                        37400022
         MVC   OPCLDNME+VARINAME(NAMELEN),WRTXCTL SET WRITER NAME       37500022
         TM    OCFLAG,OCMPP+OCTOTE      MPP OR TOTE INPUT?              37600022
         BZ    ERRXCTL                  BRANCH IF NO            SA63002 37700005
         LA    RZERO,FOUR               SET ERROR RETURN CODE   SA63002 37740005
         B     XCTL                     GO CALL NEXT MODULE     SA63002 37780005
         SPACE 1                                                SA63002 37820005
CKPAREN  EQU   *                                                 S22024 37860000
*   A CHECK IS MADE FOR TOO MANY FIELDS INSERTED BETWEEN FIRST @OY12425 37865000
*   DELIM AND 'OFFTP' OR 'ONTP'                                @OY12425 37870000
         BCTR  RSCAN,RZERO              SET SCAN PTR TO COMMA  @OY12425 37875000
         C     RSCAN,OCLINK             FIRST COMMA FOUND?     @OY12425 37880000
         BNE   ERROR18                  NO,ERROR               @OY12425 37885000
         LA    RSCAN,ONE(RSCAN)         RESET SCAN PTR         @OY12425 37890000
         TM    OPCFLAG1,LPAREN+RPAREN   EITHER PAREN IN DATA            37900000
         BNZ   ERROR18                  YES, ERROR FOR STATNAME@OY12425 37900200
RESTART  EQU  *                                                @OY12425 37900300
         SPACE                                                          37900400
         L     RBRNCH,OPCTOFLK          GET TNT SEARCH ADDRESS          37900600
         BALR  RRET,RBRNCH              VALIDATE STATION NAME           37900800
         SPACE                                                          37901000
         B     RSOURC1                  GOOD RETRN CHECK RESOURCES22024 37901200
         SPACE                                                          37901400
ERROR16  EQU   *                                                        37901600
         LA    RZERO,INVSTAT            BAD STATION ERROR               37901800
         B     SETXCTL                  SET UP NEXT MODULE              37902000
RSOURC1  EQU   *                                                 S22024 37903022
*****************************************************************S22024 37906022
*  FOR TERMINAL COMMANDS THE 3705 LGB ADDRESS IS OBTAINED AND    S22024 37909022
*  THE OTHER RN PROCESSING IS DONE.                              S22024 37912022
*****************************************************************S22024 37915022
         LA    RZERO,NOTSINGL           SET 'NOT SINGLE' CODE    S22024 37915300
         TM    TRMSTATE-IEDQTRM(RPARM),SINGLE IS THIS A SINGLE   S22024 37915600
*                                       ENTRY                    S22024 37915900
         BNZ   SETXCTL                  NO, GO SET UP FOR NEXT   S22024 37916200
*                                       MODULE                   S22024 37916500
         TM    TRMDSORG-IEDQTRM(RPARM),TRMLGB IS THIS AN LGB     S22024 37916800
         BO    SETXCTL                  YES, GO SET UP FOR NEXT  S22024 37917100
*                                       MODULE                   S22024 37917400
         TM    TRMSTATE-IEDQTRM(RPARM),TRMPREF 3705 DEVICE?    @Y17XART 37917700
         LR    RZERO,RPARM              SAVE TERMINAL ENTRY ADDR S22024 37924022
         L     RPARM,TRMDESTQ-1-IEDQTRM(RPARM) QCB ADDRESS       S22024 37927022
         L     RPARM,QCBLGBAD-ONE-IEDQQCB(RPARM) LGB ADDRESS     S22024 37930022
         BNO   NOT3705                  BRANCH NO              @Y17XART 37930100
         LR    RWORK,RZERO              GET TTE ADDR           @Y17XART 37930200
         SH    RWORK,NEGPRFSZ           BACKUP TO NEG PREFIX   @Y17XART 37930300
         CLI   TRMTYPE-IEDNTRM(RWORK),TRMSSCP TTE FOR SSCP?    @Y17XART 37930400
         BE    ERROR16                  YES,INVALID STAT NAME  @Y17XART 37930500
         TM    TRMBYTE0-IEDNTRM(RWORK),TRMDIAL DIAL TERMINAL   @YM08035 37930600
         BO    ERROR88                  YES, INVALID VARY      @YM08035 37930800
         CLC   TRMCOHRT-IEDNTRM(2,RWORK),HALFZERO CHRT EXISTS? @Y17XART 37931000
         BE    ERR3705                  NO,ERROR EXIT          @Y17XART 37931200
         TM    OPCSPEC,OPCRSTRT         RESTART IN PROGRESS      S22024 37931600
         BO    RESOURCE                 YES, SKIP OPEN TEST      S22024 37932200
         TM    LGBOFLGS-IEDNLGB(RPARM),OPENLGB IS LGB OPEN       S22024 37933022
         BZ    ERROR17                  BRANCH NO                S22024 37936022
         TM    OCSWITCH,DDSWIT          COMMD FOR DCB OR LINE  @SA73342 37936558
         BO    RESOURCE                 YES, BRANCH            @SA73342 37937058
         L     RDCB,OPCTRMWA            PICK UP TERM ENTRY     @SA73342 37937558
         TM    TRMSTATE-IEDQTRM(RDCB),TRMLINE  LINE ENTRY      @SA73342 37938058
         BO    ERROR16                  INVALID TERMINAL NAME  @SA73342 37938558
RESOURCE EQU   *                                                 S22024 37939022
         TM    DCBDSORG+ONE-IHADCB(RPARM),RNDSORG IS IT THE CCU  S22024 37942022
         BO    ERROR18                  BRANCH YES-NOT VALID     S22024 37945022
         TM    DCBDSORG-IHADCB(RPARM),DSLGB IS THIS AN LGB?      S22024 37948022
         BZ    NOT3705                  BRANCH NOT 3705          S22024 37951022
         ST    RZERO,OCMODNME           SAVE TE ADDR             S22024 37951600
         ST    RPARM,OCMODNME+4         SAVE DCB ADDR          @Y17XART 37952200
         LTR   RZERO,RZERO              TRM ADDR RETURNED      @YM08560 37952800
         BZ    NOT3705                  BRANCH NO              @YM08560 37953400
         TM    OPCSPEC,OPCRSTRT         RESTART IN PROG        @Y17XART 37954200
         BO    XCTL                     YES, EXIT              @Y17XART 37954300
LOOP     EQU   *                                               @Y17XART 37954400
         LR    RPARM,RZERO              GET TTE ADDR           @Y17XART 37954500
         LA    RSAVE,OPCSAVE            GET SAVE AREA ADDR     @Y17XART 37954600
         L     RBRNCH,OPCHORT           ADDR OF COHORT SEARCH  @Y17XART 37954700
         BALR  RRET,RBRNCH              FIND POTENTIAL NCP     @Y17XART 37954800
         LTR   RZERO,RZERO              VALID TTE FOUND?       @Y17XART 37954900
         BZ    ERR3705                  NO,ERROR EXIT          @Y17XART 37955000
         LR    RZERO,RPARM              SAVE TTE BASE ADDR     @Y17XART 37955200
         SH    RPARM,NEGPRFSZ           PT TO NEGATIVE PREFIX  @Y17XART 37955400
         CLI   TRMTYPE-IEDNTRM(RPARM),TRMLNCP  NCP TTE ?       @Y17XART 37955600
         BNE   LOOP                     SEARCH UNTIL NCP FOUND @Y17XART 37955800
         TM    TRMBYTE2-IEDNTRM(RPARM),TRMINPG  IPL/DUMP INPRG @Y17XART 37955900
         BO    ERR37051                 YES,ERROR EXIT SETUP   @Y17XART 37961900
         TM    TRMBYTE2-IEDNTRM(RPARM),TRMRSACT NCP ACTIVE?    @Y17XART 37967900
         BNO   ERR3705                  NO, ERROR EXIT         @Y17XART 37973900
         L     RPARM,OCMODNME+FOUR      ESTABLISH LGB ADDR     @Y17XARR 37979900
         B     PARMSTOR                 CONTINUE               @Y17XART 37985900
         SPACE                                                          37991900
NOT3705  EQU   *                                                 S22024 38100022
         ST    RPARM,OCMODNME+FOUR      SET UP DCB ADDRESS       S22024 38150022
PARMSTOR EQU   *                        RPARM ALREADY STORED   @Y17XART 38155000
         TM    OPCSPEC,OPCRSTRT         RESTART IN PROGRESS      S22024 38160000
         BO    XCTL                     YES, EXIT                S22024 38170000
         TM    OPCFLAG1,ALLRLN          WAS RLN=ALL?                    38200022
         BNO   GOODRLN                  NO, DO NOT RESET RLN            38300022
         SPACE                                                          38400022
         MVI   OCRLN,AVTEZERO           RESET RLN TO ALL                38500022
GOODRLN  EQU   *                                                        38600022
         LA    RZERO,ONE                SET PARAMETER                   38700022
         TM    DCBDSORG-IHADCB(RPARM),DSLGB IS THIS AN LGB     @OY14092 38710000
         BZ    NOTLGB                   BRANCH                 @OY14092 38720000
         CLI   OCSWITCH,OCX12           OFFTP,I                @OY14092 38730000
         BE    XCTL                     YES, GO PROCESS        @OY14092 38740000
NOTLGB   EQU   *                                               @OY14092 38750000
         LA    RWORK,OPCWAITL           GET FIRST ELEMENT OFF WAIT QUE  38800022
         LA    RRET,XCTL                RETURN ADDRESS         @Y17XARR 38806000
         TM    DCBDSORG-IHADCB(RPARM),DSLGB LGB?               @Y17XARR 38824000
         BZ    GETEND                   SEARCH THE CHAIN       @Y17XARR 38830000
         LA    RWORK,OPCWAITV            GET ADDR OF 3705 VARY WAIT     38833000
*                                        CHAIN                 @Y17XARR 38836000
LOOKMORE L     RWORK,ZERO(RWORK)        GET FIRST ELEMENT      @Y17XART 38848000
         LA    RWORK,ZERO(RWORK)        CLEAR HIGH ORDER BYTE  @Y17XART 38854000
         LTR   RWORK,RWORK              IS THIS A VALID ELEM   @Y17XART 38860000
         BZ    XCTL                     EXIT AT END OF CHAIN   @Y17XART 38866000
         CLC   OCBACKUP-IEDQOPCE(8,ROPCE),OCBACKUP-IEDQOPCE(RWORK)      38872000
*                                       GROUP NAME MATCH       @Y17XART 38878000
         BNE   LOOKMORE                 KEEP LOOKING           @Y17XART 38884000
         B     ENQUEUE                  PROCESS WHEN FOUND     @Y17XART 38890000
GETEND   EQU   *                                                        39000022
         LR    RHOLD,RWORK              SAVE PREVIOUS          @OY14092 39050000
         L     RWORK,ZERO(RWORK)        FIRST ELEMENT                   39100022
         LA    RWORK,ZERO(RWORK)        CLEAR HIGH BYTE                 39200022
         LTR   RWORK,RWORK              IS THERE AN ELEMENT             39300022
         BCR   EQUAL,RRET               RETURN                   S22024 39400022
         CLC   GRPNAME(THREE,ROPCE),GRPNAME(RWORK)  DO ID'S MATCHS22024 40000022
         BNE   GETEND                   NO                              40600022
         SPACE                                                          42500022
ENQUEUE  EQU   *                                                        42600022
         CLI   OCSWITCH,OCX12           OFFTP,I                @OY14092 42630000
         BE    DETACH                   YES, DETACH IT         @OY14092 42660000
         TM    OCFLAG-IEDQOPCE(RWORK),OCATTACH IS THIS ATTACHED ELEM?   42700022
         BNO   ATTACH                   NO                              42800022
         SPACE                                                          42900022
         L     RWORK,FOUR(RWORK)        NO PICK UP NEXT ELEMENT         43000022
         B     ENQUEUE                  CHECK TO SEE IF ATTACHED        43100022
         SPACE                                                          43200022
*              ATTACH NEW REQUEST FOR RESOURCE                        * 43300022
ATTACH   EQU   *                                                        43400022
         ST    ROPCE,FOUR(RWORK)        QUEUE UP NEW ELEMENT            43500022
         OI    OCFLAG-IEDQOPCE(RWORK),OCATTACH UNIT IS ATTACHED         43600022
         MVC   OCWTG(NAMELEN),OPCLDNME+VARINAME  SET UP FUNCTION MOD NM 43700022
         STH   RZERO,OCPARM             SET FOR NEXT ENTRY TO STOPLINE  43900022
         MVC   OPCLDNME+VARINAME(NAMELEN),FIRSTLD SET TO GO TO 00       44100022
         XC    OCLINK+ONE(VARINAME),OCLINK+ONE ZERO LINK FIELD          44150022
         B     XCTL                     RETURN                 @Y17XART 44220000
DETACH   EQU   *                                               @OY14092 44230000
         ST    RWORK,OCELEM             CHAIN NEW TO NEXT      @OY14092 44240000
         MVC   OCLINK-IEDQOPCE(FOUR,RHOLD),OCLINK-IEDQOPCE(RWORK)       44250000
         XC    OCLINK-IEDQOPCE(FOUR,RWORK),OCLINK-IEDQOPCE(RWORK)       44260000
         OI    OCFLAG,OCATTACH          SET ATTACH FLAG        @OY14092 44270000
         NI    OCSWITCH-IEDQOPCE(RWORK),NOSTART RESET SWITCH TO@OY14092 44280000
*                                       RESTART THE LINE       @OY14092 44290000
         NC    OCWTG-IEDQOPCE(TWO,RWORK),OCWTG-IEDQOPCE(RWORK) @OY14092 44300000
         BNZ   XCTL                     WTG IS ALREADY SET     @OY14092 44310000
         MVC   OCWTG-IEDQOPCE(TWO,RWORK),THISMOD SET TO V0     @OY14092 44320000
         B     XCTL                     CALL NEXT MODULE       @OY14092 44330000
         SPACE                                                          44400022
         SPACE 2                                                        45400022
PLACNAME MVC   OPCDOUBL(AVTEZERO),AVTEZERO(RSTART) SAVE PROCESSED NAME  45600022
CMNDCHEK CLC   CMNDOFF(AVTEZERO,RWORK),AVTEZERO(RSCAN) CHECK CMD S22024 45650000
         SPACE 2                                                        45656000
ERROR88  EQU   *                                               @YM08035 45657000
         LA    RZERO,DIALERR            DIAL VARY ERROR        @YM08035 45658000
         B     SETXCTL                  EXIT TO MSG MODULE     @YM08035 45659000
ERR3705  EQU   *                        3705 ERROR CODE        @Y17XART 45662000
         LA    RZERO,NACTIV05           PUT OUT 3705 NOT ACTIV @Y17XART 45668000
         OI    OCSWITCH,NORLN           DON'T INSERT RLN       @YM08035 45671000
         B     SETXCTL                  GOTO ERROR EXIT        @Y17XART 45674000
ERR37051 EQU   *                        MORE 3705 ERROR CODE   @Y17XART 45680000
         ICM   RPARM,ADDRESS,TRMDESTQ-IEDNTRM(RPARM) QCB ADDR  @Y17XARR 45680600
         ICM   RPARM,ADDRESS,QCBDCBAD-IEDQQCB(RPARM) DCB ADDR  @Y17XARR 45681200
         ICM   RPARM,ADDRESS,DCBDEBA-IHADCB(RPARM) DEB ADDR    @OY18838 45681800
         ICM   RPARM,ADDRESS,DEBUCBAD+1-DEBNMSUB(RPARM) UCB ADR@OY18838 45682000
         LA    RPARM,AVTEZERO(,RPARM) CLEAR HIGH ORDER BYTE    @Y17XARR 45683000
         ICM   RPARM,ADDRESS,UCBNAME-UCB(RPARM) GET EBCIDIC    @Y17XARR 45683600
         XC    OCBACKUP(8),OCBACKUP     CLEAR FOR INSERT       @Y17XARR 45684200
         ST    RPARM,OCBACKUP           INSERT UCB ADDR FOR MSG@Y17XARR 45684800
         LA    RZERO,IPLDMP             IPLDUMP IN PROG MSG    @Y17XART 45686000
         B     SETXCTL                  GOTO ERROR CODE        @Y17XART 45692000
         EJECT                                                          45700022
         SPACE 2                                                        47700022
CMNDTBL  EQU   *                                                        47800022
         DC    X'07',X'05',C'V2',CL8'OFFTP,E' STOP TERM(ENTER)   S22024 47900000
         DC    X'07',X'06',C'V2',CL8'OFFTP,B' STOP TERM(BOTH)    S22024 47970000
         DC    X'06',X'0A',C'V2',CL7'ONTP,E'  START TERM(ENTER)  S22024 48040000
         DC    X'06',X'0B',C'V2',CL7'ONTP,B'  START TERM(BOTH)   S22024 48110000
         DC    X'07',X'11',C'V1',CL8'OFFTP,C' STOP LINE(CONT)    S22024 48180000
         DC    X'07',X'12',C'V1',CL8'OFFTP,I' STOP LINE(IMMED)   S22024 48250000
         DC    X'04',X'18',C'V3',CL5'ONTP'    START LINE         S22024 48320000
         DC    X'08',X'25',C'V2',CL9'OFFTP,EM' STOP TERM(MIDMSG)SA56606 48390022
         DC    X'08',X'26',C'V2',CL9'OFFTP,BM' STOP TERM(MIDMSG)SA56606 48460022
         DC    X'FF'                    END OF TABLE                    48600022
         SPACE 2                                                        48700022
CIBTABLE EQU   *                                                        48800022
         DC    X'4018',C'V3'            START LINE                      48900022
         DC    X'4118',C'V1'            STOP LINE                       49000022
         DC    X'450B',C'V2'            START TERM (B)           S22024 49100022
         DC    X'460A',C'V2'            START TERM (E) TOTE      S22024 49200022
         DC    X'4706',C'V2'            STOP TERM (B)                   49300022
         DC    X'4805',C'V2'            STOP TERM (E)  TOTE             49400022
         DC    X'550A',C'V2'            SPECIAL VERB CODE TO     S22024 49420000
*                                       VARY ONTP,E AND LEAVE    S22024 49440000
*                                       TRM ALLOC TO TOTE        S22024 49460000
         DC    X'FF'                    END OF TABLE                    49500022
         SPACE 2                                                        49600022
FIRSTLD  DC    C'0'                     FIRST LOAD - IGC0010D    S22024 49650000
XCTL03   DC    C'03'                    ERROR MODULE NAME               49700022
WRTXCTL  DC    C'07'                    OUTPUT MODULE                   49800022
THISMOD  DC    C'V0'                    ID FOR RETURN          @OY14092 49900000
OH       DC    C',O'                    SCAN FOR OFF OR ON     @OY12425 50000000
MAX      DC    H'8'                                            @OY12425 50060000
HALFZERO DC    H'0'                     HALF WORD OF ZERO      @Y17XART 50090000
NEGPRFSZ DC    AL2(TRMPRFSZ)            TTE NEG PREFIX SIZE    @Y17XART 50120000
         TITLE 'IGCV010D - DSECTS REFERENCED BY THIS MODULE'            50200022
         TAVTD                                                          50300022
         EJECT                                                          50400022
         DCBD  DSORG=TR                                          Y06330 50500005
         EJECT                                                          50600022
         TDEBD                                                          50630000
         EJECT                                                          50660000
         TOPCAVTD                                                       50700022
         EJECT                                                          50800022
         TOPCED                                                         50900022
GRPNAME  EQU   OCMODNME+5-IEDQOPCE      OFFSET TO GROUP ID       S22024 50905022
         TLCBD                                                   S22024 50910022
         EJECT                                                          50920022
         TTRMD                                                   S22024 50930022
         EJECT                                                          50940022
         TQCBD                                                   S22024 50950022
         EJECT                                                          50960022
         TLGBD                                                   S22024 50970022
         EJECT                                                          50980022
UCB      DSECT                                                          50985000
         IEFUCBOB                                                       50990000
         EJECT                                                          50995000
         END                                                            51000022
