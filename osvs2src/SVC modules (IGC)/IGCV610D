         TITLE 'IGCV610D- OPERATOR CONTROL START GENERAL POLL MODULE'   00200022
IGCV610D CSECT                          ENTRY POINT                     00400022
         EJECT                                                          00430000
         SPACE 3                                                        00460000
**CHANGE-ACTIVITY = AS FOLLOWS:                                         00500000
*D530000                                                       @OX16689 00510000
*A532000,846000                                                @OX16689 00520000
********************* MICROFICHE FLAGS **********************SUPPT CODE 00530000
*000000-999999                                                 @Y16X5R0 00560000
*D710000-722000,730000,704000                                   SA60006 00600405
*C 698000                                                       SA60309 00600505
*A 778000                                                       SA60309 00600605
*D 916000                                                      @Y17XARZ 00690600
*A222000,734000,872000                                         @Y17XARP 00695600
*D736000-756000                                                @Y17XARP 00730600
*C012006                                                       @Y17XARP 00750600
*C010200                                                       @Y17XART 00760600
*A040000,054000,164000,866000                                  @Y17XART 00770600
*D706000,758000                                                @Y17XART 00775600
*********************************************************************** 00800022
**                                                                    * 01000000
**MODULE-NAME=IGCV610D (TCAM, OP CTL)                          @Y17XART 01010000
**                                                                    * 01040000
**DESCRIPTIVE-NAME=OPERATOR CONTROL START GENERAL POLL MODULE         * 01060000
**                                                                    * 01080000
**COPYRIGHT='NONE'                                                    * 01100000
**                                                                    * 01120000
** STATUS:  CHANGE LEVEL 10                                    @Y17XART 01140000
**                                                                    * 01600000
* FUNCTION --                                                         * 01800022
*    THIS ROUTINE RECEIVES CONTROL WHEN IT IS DETERMINED IN           * 02000022
*    MODULE IGCV410D THAT THE START TERMINAL REQUEST IS FOR A GENERAL * 02200022
*    POLL ENTRY. THE ROUTINE FIRST ACTIVATES THE GENERAL POLL ENTRY   * 02400022
*    JUST AS A NORMAL START TERMINAL REQUEST. AFTER THE GENERAL POLL  * 02600022
*    ENTRY IS ACTIVATED ALL OF THE OTHER ACTIVE ENTRIES ARE SCANNED   * 02800022
*    TO LOCATE ALL SPECIFIC POLL ENTRIES WHOSE CONTROL UNIT ADDRESSES * 03000022
*    ARE EQUAL TO THAT OF THE GENERAL POLL ENTRY BEING STARTED. ALL OF* 03200022
*    THESE SPECIFIC POLL ENTRIES ARE THEN DEACTIVATED                 * 03400022
*    SINCE THIS ROUTINE PROCESSES ONLY GENERAL POLL ENTRIES, 'B' AND  * 03600022
*    'E' REQUESTS WILL BE HANDLED THE SAME. IN OTHER WORDS NO RELEASE * 03800022
*    FUNCTION WILL BE PERFORMED ON A 'B' TYPE REQUEST.                * 04000022
*    THIS MODULE WAS UPDATED TO POST TO THE ASYNCRONOUS READY  @Y17XART 04060000
*    Q INSTEAD OF THE DISABLED READY Q.                        @Y17XART 04120000
*                                                                     * 04200022
* ENTRY POINTS --                                                     * 04400022
*         'IGCV610D' TO PROCESS VARY GENERAL POLL,ONTP OPERATOR       * 04600022
*    CONTROL COMMANDS.  CALLING SEQUENCE IS:                          * 04800022
*    MVC OPCLDNME+VARINAME(NAMELEN)=C'V6'                             * 05000022
*    LR RPARM,ROPCAVT                                                 * 05200022
*    XCTL SF=(E,OPCXCTL)                                              * 05400022
*    PURPOSE - SEE FUNCTION                                    @Y17XART 05500000
*                                                                     * 05600022
* INPUT --                                                            * 05800022
*    REGISTER 2 - ADDRESS OF OPERATOR CONTROL AVT                     * 06000022
*    REGISTER 3 - ADDRESS OF OPERATOR CONTROL ELEMENT                 * 06200022
*    REGISTER 4 - ADDRESS OF TCAM AVT                                 * 06400022
*    REGISTER 5 - ADDRESS OF LINE CONTROL BLOCK                       * 06600022
*    REGISTER 6 - ADDRESS OF GENERAL POLL INVITATION CHARACTERS       * 06800022
*    REGISTER A - LENGTH OF EACH INVITATION ENTRY                     * 07000022
*    REGISTER B - ADDRESS OF INVITATION LIST                          * 07200022
*                                                                     * 07400022
* OUTPUT --                                                           * 07600022
*    REGISTER 0 - NUMBER OF APPROPRIATE OPERATOR AWARENESS MESSAGE    * 07800022
*                                                                     * 08000022
*    RETURN CODES:                                                    * 08200022
*    0 - GENERAL POLL WAS STARTED                                     * 08400022
*    8 - GENERAL POLL WAS ALREADY STARTED                             * 08600022
*                                                                     * 08800022
* EXTERNAL REFERENCES --                                              * 09000022
*         'XCTL' (SVC 7) TO TRANSFER CONTROL TO ANOTHER MODULE        * 09200022
*                                                                     * 09400022
* EXITS,NORMAL --                                                     * 09600022
*         GENERAL POLL WAS STARTED                                    * 09800022
*         RESPONSE MESSAGE NUMBER WAS SET UP                          * 10000022
*         X'00' RETURN CODE WAS SET UP                                * 10200022
*         XCTL TO CHECKPOINT MODULE IGC0610D                          * 10400022
*                                                                     * 10600022
*         GENERAL POLL WAS ALREADY STARTED                            * 10800022
*         RESPONSE MESSAGE NUMBER WAS SET UP                          * 11000022
*         X'08' RETURN CODE WAS SET UP                                * 11200022
*         XCTL TO ERROR MODULE IGC0910D                               * 11400022
*                                                                     * 11600022
* EXITS,ERROR --                                                      * 11800022
*         NONE                                                        * 12000022
*                                                                     * 12200022
* TABLES/WORK AREAS --                                                * 12400022
*    OPERATOR CONTROL AVT                                             * 12600022
*    OPERATOR CONTROL ELEMENT                                         * 12800022
*    LINE CONTROL BLOCK                                               * 13000022
*    INVITATION LIST                                                  * 13200022
*                                                                     * 13400022
* ATTRIBUTES --                                                       * 13600022
*    SERIALLY REUSABLE, REFRESHABLE, DISABLED, TRANSIENT,             * 13800022
*    SUPERVISOR MODE.                                                 * 14000022
*                                                                     * 14200022
* CHARACTER CODE DEPENDENCY --                                        * 14400022
*    SEE NOTES BELOW.                                                 * 14600022
*                                                                     * 14800022
* NOTES --                                                            * 15000022
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL            * 15200022
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT * 15400022
*    TO THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO* 15600022
*    THAT REDEFINITION OF ''CHARACTER'' CONSTANTS, BY REASSEMBLY, WILL* 15800022
*    RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.              * 16000022
*    COMMUNICATIONS BETWEEN THE VARIOUS TRANSIENT MODULES IS PRIMARILY* 16200022
*    THROUGH THE OPERATOR CONTROL AVT.                                * 16400022
*    RESTRICTIONS - NONE                                       @Y17XART 16420000
*    REGISTER CONVENTIONS - STANDARD OP CTL                    @Y17XART 16440000
*    PATCH LABEL - ZAPAREA                                     @Y17XART 16460000
* MODULE TYPE - CSECT                                          @Y17XART 16480000
*    PROCESSOR - ASSEMBLER                                     @Y17XART 16500000
*    MODULE SIZE -                                             @Y17XART 16520000
*                                                                     * 16600022
*********************************************************************** 16800022
         EJECT                                                          17000022
*                            R E G I S T E R  E Q U A T E S             17200022
RZERO    EQU   0                        PARAMETER REGISTER              17400022
RPARM    EQU   1                        PARAMETER REGISTER              17600022
ROPCAVT  EQU   2                        POINTER TO OP CONTROL AVT       17800022
ROPCE    EQU   3                        POINTER TO CURRENT OPCE         18000022
RAVT     EQU   4                        TCAM AVT ADDRESS                18200022
RWORKA   EQU   5                        POINTER TO RESIDENT WORKAREA    18400022
RRLNKA   EQU   5                        RELATIVE LINE NUMBER            18600022
RLCB     EQU   5                        LCB BASE                        18800022
RLCB1    EQU   6                        LCB BASE                        19000022
RENTRY   EQU   6                        G.P. ENTRY ADDRESS              19200022
RTERM    EQU   6                        TERM ENTRY BASE                 19400022
RSCB     EQU   6                        SCB ADDRESS                     19600022
RTNT     EQU   6                        TERM NAME TABLE ADDRESS         19800022
RUCN     EQU   6                        UCB ADDRESS                     20000022
RDCB     EQU   7                        DCB ADDRESS                     20200022
ROFF     EQU   7                        OFFSET TO DDNAME, ADDR, RLN     20400022
RWORK    EQU   8                        WORK REGISTER                   20600022
RWORK1   EQU   9                        WORK REGISTER                   20800022
RPREFIX  EQU   9                        BUFFER ADDRESS                  21000022
RLENGTH  EQU   10                       LENGTH OF INVLIST ENTRY         21200022
RDEB     EQU   10                       DEB BASE                        21400022
RLIST    EQU   11                       ADDRESS OF INVLIST ENTRIES      21600022
RQCB     EQU   11                       QCB ADDRESS                     21800022
RBASE    EQU   12                       BASE FOR MODULE                 22000022
RRET     EQU   14                       SUBROUTINE RETURN ADDRESS       22200022
CURR     EQU   14                       REGISTER 14            @Y17XARP 22250000
RBRNCH   EQU   15                       SUBROUTINE BRANCH ENTRY POINT   22400022
         SPACE 2                                                        22600022
*                            M I S C E L L A N E O U S  E Q U A T E S   22800022
ZERO     EQU   0                        ZERO                            23000022
ONE      EQU   1                        ONE                             23200022
TWO      EQU   2                        TWO                             23400022
THREE    EQU   3                        THREE                           23600022
FOUR     EQU   4                        FOUR                            23800022
FIVE     EQU   5                        FIVE                            24000022
SIX      EQU   6                        SIX                             24200022
SEVEN    EQU   7                        SEVEN                           24400022
EIGHT    EQU   8                        EIGHT                           24600022
X80      EQU   X'80'                    HEX80                           24800022
X40      EQU   X'40'                    HEX40                           25000022
X20      EQU   X'20'                    HEX20                           25200022
X10      EQU   X'10'                    HEX10                           25400022
X08      EQU   X'08'                    HEX08                           25600022
X04      EQU   X'04'                    HEX04                           25800022
X02      EQU   X'02'                    HEX02                           26000022
X01      EQU   X'01'                    HEX01                           26200022
ANYMOVED EQU   X'01'                    ANY ENTRIES MOVED BIT           26400022
BUSY     EQU   4                        C.P.U. BUSY                     26600022
CCODE    EQU   11                       CONDITION CODE                  26800022
CVTPTR   EQU   16                       ADDRESS OF C.V.T.               27000022
DIST     EQU   X'40'                    DISTRIBUTION LIST               27200022
ENDACT   EQU   X'FE'                    END OF ACTIVE ENTRIES INDICATOR 27400022
EOT      EQU   X'80'                    EOT CHARACTER PRESENT           27600022
ERROR13  EQU   13                       ERROR MESSAGE                   27800022
ERROR16  EQU   16                       ERROR MESSAGE                   28000022
ERROR19  EQU   19                       ERROR MESSAGE                   28200022
ERROR25  EQU   25                       ERROR MESSAGE                   28400022
ERROR46  EQU   46                       ERROR MESSAGE                   28600022
ERROR47  EQU   47                       ERROR MESSAGE                   28800022
ERROR88  EQU   88                       ERROR MESSAGE                   29000022
ERROR90  EQU   90                       ERROR MESSAGE                   29200022
ERROR91  EQU   91                       ERROR MESSAGE                   29400022
ERROR145 EQU   145                      ERROR MESSAGE                   29600022
GOODHOLD EQU   51                       SUCCESSFUL HOLD                 29800022
GPSTRT   EQU   143                      G.P. STARTED MESSAGE            30000022
HKOFF    EQU   0                        OFFSET FOR IEDQHK               30200022
LCBPRIOR EQU   X'E0'                    PRIORITY FOR LCB                30400022
LINOPN   EQU   X'C1'                    OPEN INDICATOR                  30600022
MVLEN    EQU   36                       MOVE LENGTH                     30800022
NAMELEN  EQU   2                        MOVE LENGTH                     31000022
ON       EQU   1                        BIT SETTING                     31200022
STRTBOTH EQU   X'08'                    START WITH RELEASE              31400022
STRTSNGL EQU   X'46'                    START WITHOUT RELEASE           31600022
TR       EQU   3                        LENGTH OF THREE                 31800022
VARINAME EQU   3                        OFFSET TO VARIABLE PART OF NAME 32000022
         EJECT                                                          32200022
         USING IEDQAVTD,RAVT            TCAM AVT ADDRESSABILITY         32400022
         USING IEDQOPCD,ROPCAVT         OP CONTROL AVT ADDRESSABILITY   32600022
         USING IEDQOPCE,ROPCE           ELEMENT ADDRESSABILITY          32800022
         USING DEBNMSUB,RDEB            DEB ADDRESSABILITY              33000022
         USING IHADCB,RDCB              DCB ADDRESSABILITY              33200022
         USING IEDQQCB,RQCB             QCB ADDRESSABILITY              33400022
         USING IEDQTNTD,RTNT            TNT ADDRESSABILITY              33600022
         USING IEDQSCB,RSCB             SCB ADDRESSABILITY              33800022
         USING IEDQPRF,RPREFIX          BUFFER ADDRESSABILITY           34000022
         USING IEDQTRM,RTERM            TERM ENTRY ADDRESSABILITY       34200022
         SPACE 2                        SPACE 2                         34400022
         BALR  RBASE,0                  SET BASE REGISTER               34600022
         USING *,RBASE                  MODULE ADDRESSABILITY           34800022
BASE     EQU   *                        BASE                            35000022
IGCV610D IEDHJN  V610D000                                               35200022
         LR    ROPCAVT,RPARM            SET UP AVT ADDRESSING           35400022
         L     RAVT,OPCAVTPT            TCAM AVT ADDRESSING             35600022
         L     ROPCE,OPCCOPCE           GET CURRENT ELEMENT POINTER     35800022
         LA    RENTRY,SEVEN(RLIST)      POINTER TO FIRST ENTRY INDEX    36000022
         SR    RRET,RRET                CLEAR REGISTER                  36200022
         IC    RRET,ONE(RLIST)          GET NUMBER OF ACTIVE ENTRIES    36400022
         SR    RLENGTH,RLENGTH          CLEAR REGISTER                  36460022
         IC    RLENGTH,TWO(RLIST)       GET LENGTH OF EACH ENTRY        36520022
         LTR   RRET,RRET                ARE THERE ANY ACTIVE ENTRIES    36600022
         BZ    V610D002                 IF NO, CHECK INACTIVE ENTRIES   36800022
         SPACE 2                        SPACE 2                         37000022
V610D001 EQU   *                                                        37200022
         AR    RENTRY,RLENGTH           GO TO NEXT ENTRY'S INDEX        37400022
         CLC   ZERO(ONE,RENTRY),OCMODNME+THREE IS THIS AN ACTIVE ENTRY  37600022
         BE    V610D020                 YES, BRANCH                     37800022
         BCT   RRET,V610D001            NOT END OF ACTIVE               38000022
         SPACE 2                        SPACE 2                         38200022
*THE FOLLOWING CODE CHECKS TO SEE IF THE G.P. ENTRY IS THE FIRST IN-    38400022
*ACTIVE ENTRY.  IF IT IS, THE END OF ACTIVE INDICATOR IS MOVED PAST IT. 38600022
         SPACE 2                        SPACE 2                         38800022
V610D002 EQU   *                                                        39000022
         LA    RENTRY,ONE(RENTRY)       SKIP ACTIVE FLAG                39200022
         TM    THREE(RLIST),EOT         IS EOT ENTRY PRESENT            39400022
         BZ    V610D003                 NO, BRANCH                      39600022
         LA    RENTRY,ONE(RENTRY)       SKIP PAST EOT                   39800022
         SPACE 2                        SPACE 2                         40000022
V610D003 EQU   *                                                        40200022
         AR    RENTRY,RLENGTH           GET TO NEXT INDEX               40400022
         CLC   ZERO(ONE,RENTRY),OCMODNME+THREE IS THIS AN ENTRY         40600022
         BNE   V610D003                 NO GET ANOTHER                  40800022
         OI    OPCFLAG1,ANYMOVED        SET MOVED INDICATOR             41000022
         SR    RENTRY,RLENGTH           POINT TO PREVIOUS ENTRY         41200022
         LR    RWORK,RENTRY                                             41400022
         SR    RWORK,RLENGTH            POINT TO PREVIOUS ENTRY         41600022
         SPACE 2                        SPACE 2                         41800022
V610D004 EQU   *                                                        42000022
         CLI   ZERO(RENTRY),ENDACT      FIRST INACTIVE ENTRY            42200022
         BE    V610D006                 YES, GO MAKE IT ACTIVE          42400022
         SPACE 2                        SPACE 2                         42600022
V610D005 EQU   *                                                        42800022
         LR    RWORK1,RLENGTH           GET LENGTH                      43000022
         BCTR  RWORK1,ZERO              DECREMENT FOR EXECUTE           43200022
         EX    RWORK1,V610D098          SWAP                            43400022
         EX    RWORK1,V610D099           ADJACENT                       43600022
         EX    RWORK1,V610D100            ENTRIES                       43800022
         SR    RENTRY,RLENGTH           BACK POINTERS                   44000022
         SR    RWORK,RLENGTH            UP ONE ENTRY                    44200022
         B     V610D004                  KEEP PROCESSING                44400022
         SPACE 2                        SPACE 2                         44600022
V610D006 EQU   *                                                        44800022
         TM    THREE(RLIST),EOT         EOT ENTRY PRESENT               45000022
         BZ    V610D007                 NO, BRANCH                      45200022
         LA    RRET,TWO                 SET FOR DECREMENT BY TWO        45400022
         SR    RENTRY,RRET              BACK UP TWO FOR EOT-X'FE'       45600022
         SR    RWORK,RRET               BACK UP TWO FOR EOT-X'FE'       45800022
         MVC   OCMODNME+FOUR(TWO),ONE(RENTRY) SAVE EOT-X'FE'            46000022
         LR    RWORK1,RLENGTH           PICK UP LENGTH OF ENTRY         46200022
         BCTR  RWORK1,ZERO              DECREMENT FOR EXECUTE           46400022
         EX    RWORK1,V610D093          MAKE ENTRY ACTIVE               46600022
         LA    RRET,ONE(RLENGTH,RENTRY) SET ADDRESSING FOR EOT-X'FE'    46800022
         MVC   ZERO(TWO,RRET),OCMODNME+FOUR RESET EOT-X'FE'             47000022
         B     V610D008                 CONTINUE PROCESSING             47200022
         SPACE 2                        SPACE 2                         47400022
V610D007 EQU   *                                                        47600022
         BCTR  RENTRY,ZERO              BACK UP TO INDEX                47800022
         EX    RWORK1,V610D097          PLACE ENTRY ON ACTIVE SIDE      48000022
         LA    RRET,ONE(RLENGTH,RENTRY) POINT TO NEW END OF ACTIVE      48200022
         MVI   ZERO(RRET),ENDACT        RESET END-OF-ACTIVE INDICATOR   48400022
         SPACE 2                        SPACE 2                         48600022
V610D008 EQU *                                                          48800022
         SR    RRET,RRET                CLEAR REGISTER                  49000022
         IC    RRET,ONE(RLIST)          GET NUMBER OF ACTIVE ENTRIES    49200022
         LA    RRET,ONE(RRET)           INCREMENT BY ONE                49400022
         STC   RRET,ONE(RLIST)          STORE BACK NEW COUNT            49600022
         SPACE 2                        SPACE 2                         49800022
V610D009 EQU   *                                                        50000022
         BCTR  RRET,ZERO                DECREMENT BACK TO OLD COUNT     50200022
         LTR   RRET,RRET                WERE THERE ANY ACTIVE ENTRIES   50400022
         BZ    V610D020                 NO, NO NEED TO GO ON            50600022
         SR    RRET,RRET                CLEAR REGISTER                  50800022
         SPACE 2                        SPACE 2                         51000022
V610D010 EQU   *                                                        51200022
         LA    RENTRY,ONE(RENTRY)       SKIP PAST INDEX BYTE            51400022
         LR    RWORK,RENTRY             SET UP FOR COMPARE              51600022
         SR    RWORK,RLENGTH            POINT TO ENTRY BEFORE G.P. ENT  51800022
         LA    RWORK1,EIGHT(RLIST)      POINT TO FIRST ACTIVE ENTRY     52000022
         SPACE 2                        SPACE 2                         52200022
V610D011 EQU   *                                                        52400022
         CLC   ZERO(ONE,RWORK),ZERO(RENTRY) SAME CONTROL UNIT ADDRESS   52600022
         BNE   V610D013                 NO, BRANCH                      52800022
         BCTR  RLENGTH,ZERO             SET UP LENGTH FOR EXECUTE       53200022
         BCTR  RLENGTH,ZERO             SET UP LENGTH FOR EXEC @OX16689 53220000
         EX    RLENGTH,V610D105         SAME CONTROL UNIT      @OX16689 53240000
         LA    RLENGTH,ONE(,RLENGTH)    RESTORE ENTRY LENGTH   @OX16689 53260000
         BNE   SWAP                     NO, MUST BE TERMINAL GO@OX16689 53280000
*                                        MOVE TO ACTIVE SIDE   @OX16689 53300000
         LA    RLENGTH,ONE(,RLENGTH)    RESTORE ENTRY LENGTH   @OX16689 53320000
         B     V610D013                 CONTINUE CKNG ENTRIES  @OX16689 53340000
SWAP     EQU   *                                               @OX16689 53360000
         LA    RRET,ONE(,RRET)          INCREMENT MOVE COUNTER @OX16689 53380000
         EX    RLENGTH,V610D090         SWAP                            53400022
         EX    RLENGTH,V610D091          ADJACENT                       53600022
         EX    RLENGTH,V610D092           ENTRIES                       53800022
         LA    RLENGTH,ONE(RLENGTH)     RESTORE LENGTH                  54000022
         SPACE 2                        SPACE 2                         54200022
V610D012 EQU   *                                                        54400022
         LR    RENTRY,RWORK             ADJUST POINTER TO G.P. ENTRY    54600022
         CR    RWORK,RWORK1             FINISHED MOVING ENTRIES         54800022
         BE    V610D014                 YES, GO ADJUST END OF ACTIVE    55000022
         SR    RWORK,RLENGTH            SET POINTER TO ADJACENT ENTRY   55200022
         B     V610D011                 NO, CONTINUE CHECKING           55400022
         SPACE 2                        SPACE 2                         55600022
*AT THIS POINT A CHECK IS MADE TO SEE IF ALL SPECIFIC POLL ENTRIES      55800022
*HAVE BEEN EXAMINED. IF THEY HAVE THEN THE ACTIVE COUNT IS UPDATED      56000022
*TO REFLECT ANY CHANGES. IF THEY HAVENT THEN ANOTHER IS EXAMINED        56200022
V610D013 EQU   *                                                        56400022
         CR    RWORK,RWORK1             ALL ENTRIES MOVED               56600022
         BE    V610D014                 YES, BRANCH                     56800022
         BCTR  RLENGTH,ZERO             SET UP LENGTH FOR EXECUTE       57000022
         EX    RLENGTH,V610D094         MOVE ENTRY                      57200022
         EX    RLENGTH,V610D095          TO THE END                     57400022
         EX    RLENGTH,V610D096           OF THE LIST                   57600022
         LA    RLENGTH,ONE(RLENGTH)     RESTORE LENGTH                  57800022
         AR    RWORK1,RLENGTH           MOVE TO NEXT ENTRY              58000022
         B     V610D011                 CONTINUE PROCESSING             58200022
         SPACE 2                        SPACE 2                         58400022
*AT THIS POINT THE G.P. ENTRY HAS BEEN ACTIVATED AND ALL THE S.P.       58600022
*ENTRIES WITH THE SAME CONTROL UNIT ADDRESS HAVE BEEN                   58800022
*DEACTIVATED.                                                           59000022
         SPACE 2                        SPACE 2                         59200022
V610D014 EQU   *                                                        59400022
         SR    RLENGTH,RLENGTH          CLEAR REGISTER                  59600022
         IC    RLENGTH,ONE(RLIST)       GET NUMBER OF ACTIVE ENTRIES    59800022
         SR    RLENGTH,RRET             SUBTRACT NO. OF ENTRIES MOVED   60000022
         STC   RLENGTH,ONE(RLIST)       STORE BACK NEW COUNT            60200022
         SR    RLENGTH,RLENGTH          CLEAR REGISTER                  60400022
         IC    RLENGTH,TWO(RLIST)       RESTORE LENGTH                  60600022
         SPACE 2                        SPACE 2                         60800022
V610D015 EQU   *                                                        61000022
         LTR   RRET,RRET                ANY ENTRIES MOVED               61200022
         BZ    V610D020                 NO, BRANCH                      61400022
         LA    RRET,ONE(RRET)           INCREMENT BY ONE                61600022
         SR    RBRNCH,RBRNCH            CLEAR REGISTER                  61800022
         SPACE 2                        SPACE 2                         62000022
V610D016 EQU   *                                                        62200022
         AR    RBRNCH,RLENGTH           INCREMENT LENGTH BY             62400022
         BCT   RRET,V610D016            NUMBER OF ENTRIES MOVED         62600022
         LA    RRET,ONE                 SET UP AS A DECREMENT           62800022
         AR    RENTRY,RBRNCH            POINT TO END OF ENTRIES         63000022
         BCTR  RENTRY,ZERO              BACK UP ONE                     63200022
         SR    RBRNCH,RLENGTH           SUBTRACT OUT G.P. ENTRY         63400022
         TM    THREE(RLIST),EOT         IS THIS EOT-X'FE'(BSC)          63600022
         BO    V610D018                 YES, BRANCH                     63800022
         SPACE 2                        SPACE 2                         64000022
V610D017 EQU   *                                                        64200022
         MVC   ONE(ONE,RENTRY),ZERO(RENTRY) MOVE ONE CHARACTER          64400022
         SR    RENTRY,RRET              AT A TIME, STARTING             64600022
         BCT   RBRNCH,V610D017          WITH THE LAST CHARACTER         64800022
         MVI   ONE(RENTRY),ENDACT       RESET END OF ACTIVE INDICATOR   65000022
         B     V610D020                 CONTINUE PROCESSING             65200022
         SPACE 2                        SPACE 2                         65400022
V610D018 EQU   *                                                        65600022
         MVC   OCMODNME+FOUR(TWO),ONE(RENTRY)  SAVE EOT-X'FE'           65800022
         SPACE 2                        SPACE 2                         66000022
V610D019 EQU   *                                                        66200022
         MVC   TWO(ONE,RENTRY),ZERO(RENTRY) MOVE ONE CHARACTER          66400022
         SR    RENTRY,RRET              AT A TIME, STARTING             66600022
         BCT   RBRNCH,V610D019          WITH THE LAST CHARACTER         66800022
         MVC   ONE(TWO,RENTRY),OCMODNME+FOUR RESET EOT-XHFE'            67000022
         SPACE 2                        SPACE 2                         67200022
V610D020 EQU   *                                                        67400022
         TM    OPCFLAG1,ANYMOVED        WAS G.P. ENTRY ALREADY STARTED  67600022
         BO    V610D021                 NO, SET GOOD RETURN CODE        67800022
         LA    RPARM,EIGHT              SET BAD RETURN CODE             68000022
         LA    RZERO,ERROR145           ALREADY STARTED MESSAGE         68200022
         B     V610D022                 CONTINUE PROCESSING             68400022
         SPACE 2                        SPACE 2                         68600022
V610D021 EQU   *                                                        68800022
         SR    RPARM,RPARM              CLEAR REGISTER                  69000022
         SPACE 2                        SPACE 2                         69200022
V610D022 EQU   *                                                        69400022
         TM    OPCSPEC,OPCRSTRT         RESTART SITUATION               69600022
         BO    V610D126                 YES BRANCH              SA60309 69800005
         TM    OCSWITCH,X40             SHOULD LINE BE RESTARTED        70000022
         BZ    V610D026                 NO, BRANCH                      70200022
         SPACE 2                        SPACE 2                         70800022
         SPACE 2                        SPACE 2                         72400022
V610D024 EQU   *                                                        72600022
         MVI   LCBPRI-IEDQLCB(RLCB),LCBPRIOR SET E0 PRIORITY IN BUFFER  72800022
         OI    LCBSTAT1-IEDQLCB(RLCB),LCBRECVN SET STATUS FOR START     73200022
         ST    RLCB,ZERO(RLCB)          MAKE LCB POINT TO ITSELF        73400022
         L     RWORK,CVTPTR             GET CVT ADDR           @Y17XARP 73410000
         L     RWORK,AVTCVTPT(RWORK)    GET ADDR OF TCX        @Y17XARP 73510000
         USING IEDQTCX,RWORK            ESTABLISH ADDR         @Y17XARP 73610000
         L     CURR,TCXREADY            GET ADDR OF CURRENT    @Y17XARP 73710000
*                                       ENTRY ON ASYN READY Q  @Y17XARP 73810000
NEWCURR  STCM  CURR,SEVEN,LCBLINK-IEDQLCB(RLCB)                @Y17XARP 73910000
*                                       LINK NEW ELEM TO CURR  @Y17XARP 74010000
         CS    CURR,RLCB,TCXREADY       WAS CURR ELEM UPDATED  @Y17XARP 74110000
*                                       ASYNCHRONOUSLY         @Y17XARP 74210000
         BNE   NEWCURR                  YES,LINK NEW ELEM TO   @Y17XARP 74310000
*                                       CURR ELEM. NO, ASYN    @Y17XARP 74410000
*                                       READY QUEUE NOW HAS    @Y17XARP 74510000
*                                       NEW ELEM               @Y17XARP 74610000
         CLI   OCOPTCDE,STRTSNGL        TOTE ACTIVATE ONLY              76000022
         BE    V610D026                 YES, BRANCH                     76200022
         LTR   RPARM,RPARM              ERROR OR GOOD                   76400022
         BNZ   V610D029                 BRANCH ON ERROR                 76600022
         SPACE 2                        SPACE 2                         76800022
V610D026 EQU   *                                                        77000022
         NI    OCFLAG,OCFOXES-OCLINE    TURN OFF BIT                    77200022
         OI    OCSWITCH,X40             TERMINAL INDICATOR TO MSG. MOD  77400022
         LTR   RPARM,RPARM              IS IT A GOOD RETURN             77600022
         BNZ   V610D029                 NO, BRANCH TO PROCESS ERROR     77800022
V610D126 EQU   *                                                SA60309 77900005
         MVC   OPCLDNME+VARINAME(NAMELEN),CHECKPT SET CHECKPOINT NAME   78000022
         MVC   OCWTG(NAMELEN),WRTMSG    SET WTG TO MESSAGE MODULE       78200022
         MVI   OCPARM,ZERO              CLEAR FIRST BYTE                78400022
         MVI   OCPARM+ONE,GPSTRT        GENERAL POLL STARTED MESSAGE    78600022
         SPACE 2                        SPACE 2                         78800022
V610D027 EQU   *                                                        79000022
         TM    OCFLAG,OCTOTE+OCMPP      TOTE OR MPP                     79200022
         BZ    V610D028                 NO, BRANCH                      79400022
         MVC   OCWTG(NAMELEN),WRITE     SET MESSAGE MODULE FOR CHECKPT  79600022
         STH   RPARM,OCPARM             SET PARAMETER FIELD             79800022
         LR    RZERO,RPARM              SET RETURN CODE IN REG 0        80000022
         MVC   OPCLDNME+VARINAME(NAMELEN),WRITE GO TO WRITER            80200022
         SPACE 2                        SPACE 2                         80400022
V610D028 EQU   *                                                        80600022
         NI    OPCFLAG1,ZERO            CLEAR FLAGS                     80800022
         LR    RPARM,ROPCAVT            PICK UP OPERATOR CONTROL AVT    81000022
         XCTL  SF=(E,OPCXCTL)           TRANSFER TO NEXT MODULE         81200022
         SPACE 2                        SPACE 2                         81400022
V610D029 EQU   *                                                        81600022
         LA    RPARM,EIGHT              SET BAD RETURN CODE             81800022
         MVC   OPCLDNME+VARINAME(NAMELEN),WRTMSG SET TO GO TO ERR MOD   82000022
         MVC   OCWTG(NAMELEN),AVTFZERO  INDICATE NO CONTINUE            82100022
         B     V610D027                 GO PROCESS ERROR MESSAGE        82200022
         SPACE 2                        SPACE 2                         82400022
V610D090 XC    ZERO(ZERO,RWORK),ZERO(RENTRY) SWAP TWO ADJACENT ENTRIES  82600022
V610D091 XC    ZERO(ZERO,RENTRY),ZERO(RWORK) SWAP TWO ADJACENT ENTRIES  82800022
V610D092 XC    ZERO(ZERO,RWORK),ZERO(RENTRY) SWAP TWO ADJACENT ENTRIES  83000022
V610D093 MVC   ONE(ZERO,RENTRY),THREE(RENTRY) MOVE ENTRY OVER TWO BYTES 83200022
V610D094 XC    ZERO(ZERO,RWORK1),ZERO(RWORK) MOVE ENTRY TO END OF LIST  83400022
V610D095 XC    ZERO(ZERO,RWORK),ZERO(RWORK1) MOVE ENTRY TO END OF LIST  83600022
V610D096 XC    ZERO(ZERO,RWORK1),ZERO(RWORK) MOVE ENTRY TO END OF LIST  83800022
V610D097 MVC   ONE(ZERO,RENTRY),TWO(RENTRY)   MOVE ENTRY DOWN ONE BYTE  84000022
V610D098 XC    ONE(ZERO,RWORK),ONE(RENTRY) SWAP TWO ADJACENT ENTRIES    84200022
V610D099 XC    ONE(ZERO,RENTRY),ONE(RWORK) SWAP TWO ADJACENT ENTRIES    84400022
V610D100 XC    ONE(ZERO,RWORK),ONE(RENTRY) SWAP TWO ADJACENT ENTRIES    84600022
V610D105 CLC   ZERO(ZERO,RWORK),ZERO(RENTRY) COMPARE POLL CHARS@OX16689 84650000
         SPACE 2                        SPACE 2                         84800022
ERRORTAB DS    0F                       ERROR TABLE                     85000022
XCTL03   DC    C'03'                    ERROR MODULE NAME               85200022
CHECKPT  DC    C'06'                    CHECKPOINT MODULE NAME          85400022
WRITE    DC    C'07'                    OUTPUT WRITER NAME              85600022
WRTMSG   DC    C'09'                    HOLD, RELEASE, AND VARY MESSAGE 85800022
STOPLN   DC    C'V1'                    STOP LINE MODULE                86000022
FIRSTLD  DC    C'00'                    FIRST LOAD                      86200022
RELEASE  DC    C'R0'                    RELEASE MODULE                  86400022
STRTERM  DC    C'V4'                    START TERMINAL MODULE           86600022
ZAPAREA  DC    50X'FF'                  PATCH AREA             @Y17XART 86700000
         ORG   IGCV610D+1024            PATCH AREA                      86800022
         EJECT                                                          87000022
         TAVTD                                                          87200022
         EJECT                                                          87260000
         TTCXD SVS                                                      87320000
         EJECT                                                          87400022
         DCBD  DSORG=TX                                                 87600022
         EJECT                                                          87800022
         TDEBD                                                          88000022
         EJECT                                                          88200022
         TOPCAVTD                                                       88400022
         EJECT                                                          88600022
         TOPCED                                                         88800022
         EJECT                                                          89000022
         TQCBD                                                          89200022
         EJECT                                                          89400022
         TLCBD                                                          89600022
         EJECT                                                          89800022
         TTNTD                                                          90000022
         EJECT                                                          90200022
         TSCBD                                                          90400022
         EJECT                                                          90600022
         TPRFD                                                          90800022
         EJECT                                                          91000022
         TTRMD                                                          91200022
         EJECT                                                          91400022
         END                                                            91800022
