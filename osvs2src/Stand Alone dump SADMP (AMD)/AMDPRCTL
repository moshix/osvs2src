         TITLE   'AMDPRCTL - CONTROL/SCAN AND TERMINATION MODULE'       00030002
AMDPRCTL CSECT                                                          00060002
*********************************************************************** 00076502
*                                                                     * 00076602
* A 790000,816400-817120,823000                                 YA01752 00078602
* C 817200                                                      YA01752 00079302
* C 302400,310800                                                Y02006 00088202
* C 344700,349500,371700,372900,374100,403800-404100,404400      Y02006 00088902
* C 405900,408300,410700,411000,412200,413900,416400,416800      Y02006 00089602
* C 416900,417000,417300,417600,417900,420600,420900,422400      Y02006 00090302
* C 422400,423600,424200-424500,424800,426300,427500             Y02006 00091002
* C 428100-428400,437700,469500,483600,484200                    Y02006 00091702
* C 487800,491700,496800,497100,508800,517800,524100             Y02006 00092402
* C 540300,586800,589401,591900,598200,610800                    Y02006 00093102
* C 538800,560100,571800,588292,590700,601200                    Y02006 00093802
* C 587700,589636,591000,605400,608700,609600,625500,635400      Y02006 00094502
* C 639300,645285,668400,695100                                  Y02006 00095202
* C 671700,679800,684900,689100,691200,708600-708900             Y02006 00095902
* C 714000-714300,722400,741300,750000,804300,805200             Y02006 00096602
* A 305200,343400-344952,350200-350320,369400-369500             Y02006 00097302
* A 396400-396584                                                Y02006 00098002
* A 372100-372240,391600,399400,399700-399820,403600-403720      Y02006 00098702
* A 404200-404340,407720-407900,412300-412400,414400-414500      Y02006 00099402
* A 415600-415700,416200-416340,416820-416880,417400-417580      Y02006 00100102
* A 417700-417840,420700-420840,423400-423540,424600-424740      Y02006 00100802
* A 427300-427440,428500-428660,490900-491040,491500-491660      Y02006 00101502
* A 448400-448420,458900-458920,508600-508700,523900-524000      Y02006 00102202
* A 496900-497040,497420-498580,461600-468860,517600-517700      Y02006 00102902
* A 587300-587500,589501-589621                                  Y02006 00103602
* A 577000,580300,588713,589036,598200-598420,608000-608020      Y02006 00104302
* A 608500-608640,609300-609540,610800-611020,628600-628700      Y02006 00105002
* A 658300-658420,661004-661140,689020-689084,690700-691100      Y02006 00105702
* A 713200,714400,718300-718420,732400-732500                    Y02006 00106402
* A 735700-735800,745900-746020,789500,806300-807300             Y02006 00107102
* D 429000-437400,438900-444900,448200,451500,455100-458100      Y02006 00107802
* D 322500-326100,343200-344100,345600,346800-377400,368700      Y02006 00108502
* D 383100-389100,393900-394200,418500-419100,427900-428020      Y02006 00109202
* D 429000-437400,438900-444900,448200,451500,455100-458100      Y02006 00109902
* D 458700,459000,461400-468600,469200,483300,493200-493800      Y02006 00110602
* D 497700-498300,503400-503700,504600-508200,509100-509400      Y02006 00111302
* D 511500-511800,512400-515100,586500,586900-587100,589392      Y02006 00112002
* D 538500,559800,571500,587400,588288,589578,594000             Y02006 00112702
* D 589400,589459-589520,642000-642300,643600-644100             Y02006 00113402
* D 639500-644600,644964-645159,645329,645446-649800             Y02006 00114102
* D 659100-660000,660300,660600,661000-661200,665400-665700      Y02006 00114802
* D 672000-674100,676200-679200,680400-680700,681600-684600      Y02006 00115502
* D 686400,688800                                                Y02006 00116202
* D 689400-694800,708300,709500-710100,711300-712200,713400      Y02006 00116902
* D 714900-716100,726300,726900-727200,728700-729300,731100      Y02006 00117602
* D 732000,734100-734400,736200-738600,749400,802800-804000      Y02006 00118302
* D 812700,813300,815100-815400                                  Y02006 00119002
* A 304000,304100,391900,815900,824500                          SA54065 00119702
* D 815700,816900                                               SA54065 00120402
* C 563100,563400,564600                                         XM5890 00121102
* A 707800                                                       XM5890 00121802
* A 507400-507520                                                YM1462 00122502
* A 315500                                                       XM5100 00123202
* C 314700                                                       XM5100 00123902
* D 314400,315300-316500                                         XM5100 00124602
* A 463900-464000,466000-466197                                  YM1461 00125302
* C 468300,465300                                                YM1461 00126002
* A 698800,700600                                                YM1454 00126702
* A 427900-428020,638300-638620,643100-644600,645119-645527      Y01980 00127402
* A 661000-661120,709900,639500,644964,589392,589459,586900      Y01980 00128102
* A 645387-645440,645930                                         Y01980 00128802
* D 495000-495600,520200-523500,618300-620100,638100-638400      Y01980 00129502
* D 640500-640800,642900-644400,644992-644996,645900,717600      Y01980 00130202
* D 645600-655500,728100,806100-808500,312000,326400-328200      Y01980 00130902
* D 333000-334500,599100,611700                                  Y01980 00131602
* C 642000,644998,678000-678300,302400,397200,359100-359400      Y01980 00132302
* C 640200,64498,728700,592800,635400                            Y01980 00133002
* C 267300,690700                                               @YM3679 00133202
* A 267380-267700,690702-690718,691780-692020                   @YM3679 00133402
*                                                                       00133702
*********************************************************************** 00134402
* /* START OF SPECIFICATIONS ****                                       00135102
*                                                                       00135802
*01*  MODULE-NAME = AMDPRCTL                                            00136502
*                                                                       00137202
*02*     CSECT-NAME = AMDPRCTL,AMDPRMSC,AMDPREND,AMDPRXIT               00137902
*                                                                       00138602
*01*  DESCRIPTIVE-NAME = MAIN AMDPRDMP CONTROL/SCAN MODULE              00139302
*                                                                       00140002
*01*  COPYRIGHT = NONE                                                  00140702
*                                                                       00141402
*01*  STATUS - OS/VS2 RELEASE 03.7                             @ZA27117 00142100
*                                                                       00142802
*01*  FUNCTION = AMDPRCTL IS THE MAIN CONTROL MODULE FOR AMDPRDMP. IT   00143502
*     CONTAINS FOUR CSECTS WHOSE FUNCTIONS AND BASIC OPERATIONS ARE     00144202
*     LISTED UNDER THE OPERATION SECTION.                               00144902
*                                                                       00145602
*02*     OPERATION = SEE COMMENTS THAT FOLLOW                           00146302
*                                                                       00147002
*    AMDPRCTL:                                                          00147702
*                                                                       00148402
*    THIS CSECT ANALYZES THE VALUE OF THE PARM FIELD AND STORES THE     00149102
*    PARAMETERS FOUND IN THE COMMON CSECT AMDPRCOM.  IT CALLS           00149802
*    THE OUTPUT DATA SET WRITE ROUTINE, AMDPRWTR, TO OPEN THE PRINTER   00151802
*    DATA SET AND IT BRANCHES TO THE USER INTERFACE MODULE,AMDPRUIM,TO  00153802
*    PERFORM INITIALIZATION.  IF THE TITLE OPTION IS BEING USED,        00155502
*    AMDPRCTL OBTAINS THE PAGE TITLE FROM THE OPERATOR.                 00155602
*                                                                       00156202
*    THIS CSECT ALSO DETERMINES THE SOURCE OF CONTROL                   00156602
*    STATEMENTS AS EITHER THE SYSIN DATA SET OR THE OPERATOR'S          00156702
*    CONSOLE AND READS IN THESE STATEMENTS.  AS EACH CONTROL            00157202
*    STATEMENT IS OBTAINED, THE AMDPRMSC CSECT IS CALLED TO INTERPRET   00157602
*    THE STATEMENTS AND CAUSE THE REQUESTED FUNCTION TO BE PERFORMED.   00158002
*    WHEN AN END CONTROL STATEMENT IS ENCOUNTERED IN THE INPUT STREAM   00158302
*    OR ENTERED BY THE OPERATOR, CONTROL IS PASSED TO AMDPREND TO PRINT 00158402
*    AMDPRDMP EXECUTION STATISTICS PRIOR TO TERMINATING THE PROGRAM.    00158502
*                                                                       00158802
*    AMDPRMSC:                                                          00158902
*                                                                       00159002
*    THIS CSECT IS THE MAIN SCAN ROUTINE.  EACH CONTROL STATEMENT       00159102
*    IS SCANNED TO DETERMINE IT'S VERB.  WHEN THE VERBS LPAMAP,         00159202
*    SUMMARY, FORMAT, EDIT, CPUDATA AND PRINT ARE ENCOUNTERED AMDPRMSC  00159302
*    CALLS AMDPRSEG WHICH IN TURN LOADS THE                             00159402
*    CORRESPONDING PATH SEGMENTS.  FOR THE PRINT VERB AMDPRMSC ALSO     00159502
*    SCANS THE PARAMETERS TO DETERMINE THE APPROPRIATE PATH.            00159602
*    CONTROL IS THEN PASSED TO THE LOADED EXECUTOR AND THE APPROPRIATE  00160002
*    FUNCTION IS PERFORMED. THE EXECUTORS FOR THE CVT=,NEWDUMP,NEWTAPE, 00160402
*    GO,ONGO,SEGTAB=, AND TITLE ARE CONTAINED IN AMDPRMSC ITSELF AND    00160502
*    ARE EXECUTED DIRECTLY WHEN THE ASSOCIATED CONTROL STATEMENTS ARE   00160602
*    ENCOUNTERED.  IF ANY OTHER CONTROL STATEMENTS ARE ENCOUNTERED,     00160702
*    CONTROL IS PASSED TO THE USER INTERFACE MODULE AMDPRUIM FOR SYNTAX 00160802
*    CHECKING AND PROCESSING.                                           00160902
*                                                                       00161002
*    THIS CSECT ALSO CONTAINS THE PRIMARY ERROR HANDLER, BEGINNING      00161102
*    AT LABEL ERRMSG.                                                   00161202
*                                                                       00161302
*    AMDPREND:                                                          00161602
*                                                                       00161702
*    THIS ROUTINE PERFORMS ONE OF TWO FUNCTIONS.  IF IT IS CALLED       00161902
*    AFTER A DUMP DATA SET HAS BEEN PROCESSED IT PRINTS THE EXECUTION   00162302
*    STATISTICS ON SYSPRINT.  HOWEVER, IF IT CALLED WHEN END WAS        00162702
*    THE ONLY CONTROL STATEMENT FOR THE DUMPED DATA SET, SO THAT NO     00163102
*    INITIALIZATION HAS BEEN PERFORMED, IT MERELY ISSUES THE BRREAD     00163202
*    MACRO FOR INIT TO CAUSE THE INPUT DUMP DATA SET TO BE TRANSFERRED  00163602
*    TO THE SYSUT2 DATA SET IF IT IS PRESENT.  IN                       00163702
*    EITHER CASE AMDPREND EXITS TO AMDPRXIT WITH A CODE OF 4 IN         00163802
*    REGISTER 1 TO TERMINATE AMDPRDMP PROCESSING.                       00163902
*                                                                       00164002
*    AMDPRXIT:                                                          00164302
*                                                                       00164702
*    THIS CSECT IS ENTERED WHEN A CONDITION WHICH MAKES FURTHER         00164802
*    EXECUTION IMPOSSIBLE IS ENCOUNTERED.  DEPENDING UPON THE VALUE     00164902
*    OF THE CODE PASSED IN REGISTER 1, AMDPRXIT ISSUES EITHER MESSAGE   00165302
*    AMD150I OR MESSAGE AMD153I BEFORE TERMINATION OR IT TERMINATES     00165402
*    WITHOUT ISSUING ANY MESSAGE.  IN ANY CASE ITS TERMINATION          00165802
*    PROCESSING INCLUDES-- CLOSING ALL OPEN DATA SETS AND FREEING       00165902
*    THE ASSOCIATED BUFFERS, FREEING THE OUTPUT BUFFERS, CALLING        00166302
*    AMDPRRDC TO FREE THE INPUT BUFFERS, FREEING THE STORAGE OF         00166702
*    THE ONGO BUFFER, RESTORING THE TOP-OF-REAL VALUE AND THE           00166802
*    DEFAULT LINE COUNT, ZEROING THE PAGE NUMBER , CALLING AMDPRUIM     00166902
*    TO DELETE USER INTERFACE MODULES,                                  00167002
*    AND THEN RESETTING ALL SWITCHES.  FINALLY AMDPRXIT RESTORES        00167102
*    THE HIGHEST LEVEL SAVE AREA AND RETURNS CONTROL TO THE OPERATING   00167402
*    SYSTEM.                                                            00167502
*                                                                       00168002
*01*   NOTES = SEE COMMENTS THAT FOLLOW                                 00168502
*                                                                       00168602
*02*     DEPENDENCIES = THE NEWDUMP PROCESSOR IS DEPENDENT ON THE ORDER 00168702
*        OF THE DCB ADDRESSES AT DCBADDRS IN THE AMDPRDMP COMMON CSECT. 00168802
*                                                                       00168902
*03*        CHARACTER-CODE-DEPENDENCIES = EBCDIC                        00169002
*                                                                       00169102
*02*     RESTRICTIONS = NONE                                            00169202
*                                                                       00169302
*02*     REGISTER-CONVENTIONS = REGISTERS ARE DEFINED BY THE EQUATES    00169402
*        MACRO.                                                         00169502
*                                                                       00169602
*02*     PATCH-LABEL =PTCHAREA - RESERVED FOR FUTURE USE                00169702
*                                                                       00169802
*01*  MODULE-TYPE = PROCEDURE                                           00169902
*                                                                       00170002
*02*     PROCESSOR = ASSEMBLER                                          00170102
*                                                                       00170202
*02*     MODULE SIZE - 7,073 BYTES                             @OZ24196 00170300
*                                                                       00170402
*02*     ATTRIBUTES = PROBLEM PROGRAM REGION,REUSABLE                   00170802
*                                                                       00171502
*01*  ENTRY-POINT = AMDPRDMP                                            00172202
*                                                                       00176402
*02*     PURPOSE = MAIN ENTRY POINT TO AMDPRDMP                         00177102
*                                                                       00177802
*02*     LINKAGE = ENTRY FROM THE OPERATING SYSTEM                      00178502
*                                                                       00180602
*02*     INPUT = REGISTER 1 POINTS TO THE PARAMETER LIST THAT           00181302
*        REPRESENTS THE PARM FIELD OF THE EXEC STATEMENT THAT INITIATED 00183302
*        THE PRDMP JOB.  OTHER INPUT INCLUDES SYSIN CONTROL STATEMENTS  00183702
*        AND/OR OPERATOR REPLIES.                                       00184102
*                                                                       00184802
*02*     OUTPUT = SEE EXIT OUTPUT SECTIONS BELOW                        00185502
*                                                                       00186202
*02*     REGISTERS-SAVED = ALL                                          00186902
*                                                                       00188302
*02*     REGISTER-USAGE = REGISTER 1, ON ENTRY,POINTS TO THE ADDRESS OF 00189002
*        THE PARAMETER LIST REPRESENTING THE PARM FIELD OF THE EXEC     00189402
*        STATEMENT THAT INITIATED THE PRDMP JOB.                        00189802
*        REGISTER 12 IS INITIALIZED IN AMDPRCTL TO POINT TO THE COMMON  00190202
*        CSECT,AMDPRCOM.                                                00190302
*                                                                       00190802
*        ON RETURN FROM AMDPRMSC,REGISTER 15 CONTAINS A CODE WHICH      00200802
*        DETERMINES WHERE AMDPRCTL SHOULD RESUME PROCESSING, NAMELY:    00200902
*           0 - WRTMSG - ISSUE MESSAGE AMD154I TO SYSTEM OPERATOR TO    00201002
*              OBTAIN DUMP TITLE                                        00201402
*           4 - TRDRSW - IMMEDIATELY OBTAIN NEXT CONTROL STATEMENT      00201502
*              FROM SYSIN OR SYSTEM OPERATOR                            00201602
*                                                                       00201802
*02*     REGISTERS-RESTORED = NONE - REGISTERS 0-14 ARE RESTORED BY THE 00201902
*        AMDPRXIT CSECT PRIOR TO RETURNING CONTROL TO THE OPERATING     00202302
*        SYSTEM.                                                        00202702
*                                                                       00203102
*01*  ENTRY-POINT = AMDPRMSC                                            00203202
*                                                                       00206202
*02*     PURPOSE = SCAN EACH CONTROL STATEMENT AND EITHER PROCESS IT OR 00206702
*        PASS CONTROL TO OTHER ROUTINES FOR PROCESSING.                 00207102
*                                                                       00207202
*02*     LINKAGE = BALR FROM AMDPRCTL CSECT                             00207702
*                                                                       00209202
*02*     INPUT = REGISTER 12 POINTS TO THE COMMON CSECT.  THE CONTROL   00209702
*        STATEMENT LOCATED AT WTORMSG IN COMMON IS THE BASIC INPUT FOR  00211702
*        AMDPRMSC PROCESSING.                                           00212102
*                                                                       00212202
*02*     OUTPUT = SEE EXIT OUTPUT SECTIONS BELOW                        00212702
*                                                                       00213202
*02*     REGISTERS-SAVED = ALL                                          00213702
*                                                                       00214702
*02*     REGISTER-USAGE = REGISTER 12 POINTS TO THE COMMON CSECT.       00215202
*        REGISTER 3 IS USED AS A LINK REGISTER TO SUBROUTINES IN THE    00215602
*        NEWDUMP PROCESSOR.                                             00216002
*        REGISTER 9 IS USED AS A LINK REGISTER TO THE OPRFREE           00216102
*        SUBROUTINES IN THE ONGO PROCESSOR.                             00216202
*        REGISTER 14 IS SET UP TO CONTAIN THE ADDRESS OF THE RETURN     00216302
*        POINT FROM THE SYNTAX MESSAGE WRITER ROUTINE.                  00216402
*        REGISTER 15 IS INITIALIZED WITH THE ADDRESS OF THE SYNTAX      00216502
*        MESSAGE ROUTINE.                                               00216602
*                                                                       00216702
*02*     REGISTERS-RESTORED = NONE                                      00216802
*                                                                       00217202
*01*  ENTRY-POINT = AMDPREND                                            00218202
*                                                                       00221202
*02*     PURPOSE = (1) TO PRINT EXECUTION STATISTICS ON SYSPRINT IF A   00221702
*        DUMP DATA SET HAS BEEN PROCESSED.                              00222102
*        (2) TO CAUSE THE DUMP DATA SET TO BE TRANSFERRED TO THE DATA   00222202
*        SET DESCRIBED BY THE SYSUT2 DD STATEMENT IF END WAS THE ONLY   00222302
*        CONTROL STATEMENT FOR THE DUMP DATA SET.                       00222402
*                                                                       00222602
*02*     LINKAGE = BCR FROM AMDPRCTL CSECT;  BALR FROM AMDPRMSC CSECT   00222702
*        (NO RETURN EXPECTED)                                           00223102
*                                                                       00224202
*02*     INPUT = REGISTER 12 POINTS TO THE COMMON CSECT.  THE FOLLOWING 00224702
*        FIELDS IN COMMON CONTAIN THE INFORMATION NEEDED TO OUTPUT THE  00226702
*        EXECUTION STATISTICS:  READNO,RDERCNT,BUFREINT,BUFSUM,RDENTRY, 00227102
*        READTM.                                                        00227202
*                                                                       00227502
*02*     OUTPUT = SEE EXIT OUTPUT SECTIONS BELOW                        00227702
*                                                                       00228202
*02*     REGISTERS-SAVED = ALL                                          00228702
*                                                                       00229702
*02*     REGISTER-USAGE = REGISTER 12 POINTS TO THE COMMON CSECT.       00230202
*                                                                       00231202
*02*     REGISTERS-RESTORED = NONE                                      00231702
*                                                                       00232102
*01*  ENTRY-POINT = AMDPRXIT                                            00233202
*                                                                       00236202
*02*     PURPOSE = TO TERMINATE AMDPRDMP PROCESSING                     00236702
*                                                                       00237202
*02*     LINKAGE = BR FROM CSECT AMDPRCTL                               00237702
*        BALR FROM CSECT AMDPRMSC (NO RETURN EXPECTED)                  00238102
*        BALR FROM CSECT AMDPREND (NO RETURN EXPECTED)                  00238502
*                                                                       00239202
*02*     INPUT = REGISTER 0 CONTAINS A CODE INDICATING THE DDNAME TO BE 00239702
*        USED IN MESSAGES AMD150I OR AMD153I SHOULD THE CODE IN         00241702
*        REGISTER 1 REQUEST THAT ONE OF THESE MESSAGES BE ISSUED.  THE  00242102
*        CODES AND THEIR CORRESPONDING DDNAMES ARE:                     00242302
*        0 - PRINTER                                                    00242402
*        4 - SYSUT1                                                     00242502
*        8 - SYSIN                                                      00242602
*        12 - DDNAME OBTAINABLE FROM COMMON                             00242802
*        16 - SYSUT2                                                    00242902
*        REGISTER 1 CONTAINS A CODE INDICATING THE MESSAGE TO BE        00243002
*        PRINTED BEFORE TERMINATION PROCESSING:                         00243102
*        0 - AMD150I                                                    00243202
*        4 - NO MESSAGE                                                 00243602
*        8 - NO MESSAGE                                                 00243702
*        12 - AMD153I                                                   00243802
*        REGISTER 12 POINTS TO THE COMMON CSECT                         00243902
*                                                                       00244502
*02*     OUTPUT = SEE EXIT OUTPUT SECTIONS BELOW                        00244602
*                                                                       00244702
*02*     REGISTERS-SAVED = ALL                                          00244802
*                                                                       00245002
*02*     REGISTER-USAGE = REGISTER 12 POINTS TO THE COMMON CSECT        00245202
*                                                                       00246202
*02*     REGISTERS-RESTORED = 0-14; REGISTER 15 IS SET TO 0 PRIOR TO    00246702
*        RETURNING CONTROL TO THE OPERATING SYSTEM                      00248702
*                                                                       00251202
*01*  EXIT-NORMAL = TITLMSG                                             00251302
*                                                                       00251702
*02*     CONDITIONS = WHEN THE TITLE PARAMETER IS USED ON THE EXEC CARD 00251802
*        AND THE OPERATOR REPLIES END IN RESPONSE TO THE REQUEST FOR A  00251902
*        TITLE, AMDPRCTL PASSES CONTROL TO AMDPREND.                    00252102
*                                                                       00252802
*02*     OUTPUT = TITLESW IN SWE IN COMMON IS SET ON TO INDICATE THAT   00253002
*        THE TITLE OPTION WAS REQUESTED IN THE PARM FIELD OF THE EXEC   00253402
*        STATEMENT.                                                     00253802
*        TITLEMSG IN COMMON IS FILLED IN WITH THE TITLE SUPPLIED BY THE 00253902
*        OPERATOR.                                                      00254002
*                                                                       00254202
*02*     RETURN-CODES = NONE                                            00254702
*                                                                       00256702
*01*  EXIT-NORMAL = CALLSCAN                                            00257002
*                                                                       00257402
*02*     CONDITIONS = FOR EACH CONTROL STATEMENT AMDPRCTL READS, IT     00257502
*        CALLS AMDPRMSC TO INTERPRET THE STATEMENT AND CONTROL ITS      00257902
*        PROCESSING.  EXCEPT FOR END STATEMENTS AMDPRMSC RETURNS TO     00258002
*        AMDPRCTL AFTER PROCESSING TO READ ANOTHER CONTROL STATEMENT.   00258102
*        WHEN AMDPRMSC ENCOUNTERS AND END STATEMENT IT INITIATES        00258202
*        TERMINATION PROCESSING WHICH RESULTS IN CONTROL BEING RETURNED 00258302
*        TO THE OPERATING SYSTEM WITH OUT RETURNING CONTROL TO          00258402
*        AMDPRCTL.  IN THIS CONTEXT, AMDPRMSC'S ENCOUNTERING AN END     00258502
*        STATEMENT RESULTS IN AN EXIT FROM AMDPRCTL.                    00258602
*                                                                       00258702
*02*     OUTPUT = THE FOLLOWING FIELDS MAY BE MODIFIED BY AMDPRCTL'S    00258802
*        PROCESSING:                                                    00258902
*        RDRSW IN SWA IS SET IF CONTROL STATEMENTS ARE COMING FROM      00259002
*        SYSIN AND , IF SO, TURNED OFF WHEN SYSIN EOF OCCURS.           00259102
*        POSITSW IN SWC IS SET TO INDICATE DUMP DATA SET POSITIONING IS 00259202
*        REQUIRED.                                                      00259302
*        BUILDMAP IN SWE IS SET ON FOR A NEW DUMP (NEWDUMP,NEWTAPE) TO  00259402
*        INDICATE THAT THE DUMP DATA SET MUST BE SCANNED AND MAPPED.    00259502
*        STOPSW IN SWE IS SET TO 1 TO INDICATE THAT THE STOP OPTION WAS 00259602
*        REQUESTED IN THE PARM FIELD OF THE EXEC STATEMENT.             00259702
*        WTORMSG IS BLANKED PRIOR TO READING CARDS OR ISSUING A WTOR    00259802
*        FOR CONTROL INFORMATION.                                       00259902
*        LINENUMB IS SET TO THE NUMBER OF LINES PER OUTPUT PAGE FOR     00260002
*        PRINTER OUTPUT CORRESPONDING TO THE VALUE ENTERED IN THE PARM  00260102
*        FIELD OF THE EXEC STATEMENT.  IF NO LINECOUNT WAS SPECIFIED,   00260202
*        58 IS USED AS A DEFAULT.                                       00260302
*        LINENUM IS SET TO LINENUMB-2.  THIS CORRESPONDS TO THE NUMBER  00260402
*        OF LINES THAT ARE TO BE PRINTED FOR EACH OUTPUT PAGE EXCLUDING 00260502
*        TWO LINES FOR THE TITLE.                                       00260602
*        ARDRDCB IS SET TO CONTAIN THE ADDRESS OF THE SYSIN DCB         00260702
*        PROVIDED THE DATA SET OPENS SUCCESSFULLY.                      00260802
*        EDITER IS FILLED IN WITH THE VALUE OF THE EDIT ERROR PARAMETER 00260902
*        IF IT APPEARS IN THE PARM FIELD OF THE EXEC STATEMENT.         00261002
*        ERRADDR IS SET TO ZERO.                                        00261102
*        CVTADDR IS SET TO ZERO.                                        00261202
*        ONGOPTR IS INITIALIZED TO POINT TO THE DEFAULT PARAMETERS      00261302
*        SUMMARY, EDIT, PRINT CURRENT.                                  00261402
*                                                                       00261502
*02*     RETURN-CODES = NONE                                            00261602
*                                                                       00262002
*01*  EXIT-NORMAL = MAP5                                                00262102
*                                                                       00262502
*02*     CONDITIONS = UPON NORMAL COMPLETION OF ANY CONTROL STATEMENT   00262602
*        PROCESSING OTHER THAN AN END STATEMENT AMDPRMSC RETURNS        00262702
*        CONTROL TO AMDPRCTL WITH A CODE OF 0 IN REGISTER 15 IF THE     00262802
*        OPERATOR SHOULD BE ASKED FOR A DUMP TITLE AND WITH A CODE OF 4 00264802
*        OTHERWISE.                                                     00264902
*                                                                       00265102
*02*     OUTPUT = INITIALLY ALL THE BITS OF SWA EXCEPT FOR RDRSW AND    00265202
*        SETCVTSW ARE RESET TO ZERO.                                    00265302
*        SETCVTSW IS SET IF A CVT CONTROL STATEMENT IS ENCOUNTERED TO   00265402
*        INDICATE THAT THE CVT ADDRESS HAS BEEN SET BY A CONTROL        00265502
*        STATEMENT.  IT IS RESET TO ZERO IF A NEWTAPE OR NEWDUMP        00265602
*        CONTROL STATEMENT IS USED FOR NEW DUMP DATA SET PROCESSING.    00265702
*        GOSW IS SET WHEN PROCESSING A GO CONTROL STATEMENT BEFORE ANY  00265802
*        ONGO PARAMETERS ARE FETCHED AND PROCESSED.  IT IS USED TO      00265902
*        PREVENT THE ONGO PARAMETER FORM CONTAINING A GO VERB.  IF THIS 00266002
*        EXTRA GO WERE TO BE PROCESSED IT WOULD HAVE THE ONGO           00266102
*        PARAMETERS FETCHED AGAIN AND THEN BEGIN PROCESSING TO THE GO   00266202
*        PARAMETER AGAIN CAUSING AN INFINITE LOOP.                      00266302
*        FMTERR AND IOERR SWITCHES IN SWB ARE SET TO ZERO UPON ENTERING 00266402
*        AMDPRMSC.                                                      00266502
*        POSITSW IN SWC IS SET TO INDICATE THAT INPUT POSITIONING IS    00266602
*        REQUIRED (NEWDUMP PROCESSOR).                                  00266702
*        EDITSW IS SET ON TO INDICATE THAT THE EDIT SECTION HAS CONTROL 00266802
*        AND RESET TO 0 WHEN THE EDIT SECTION RELINQUISHES CONTROL.     00266902
*        MSTRSW IN SWC IS RESET TO 0 WHEN THE CVT OR SEGTAB CONTROL     00267002
*        STATEMENTS ARE PROCESSED TO ALLOW AMDPRRDC TO ATTEMPT          00267102
*        INITIALIZATION AGAIN BY INVOKING THE GET MASTER ROUTINE        00267202
*        AMDPRMST.                                                      00267302
*        SETFLSH IN SWC IS SET FOR NEWDUMP AND NEWTAPE PROCESSING TO    00267402
*        INDICATE TO THE SYNTAX WRITER TO SET FLUSHMODE IF AN ERROR     00267502
*        OCCURS.  IT IS RESET WHEN PROCESSING IS COMPLETED.             00267602
*        CONTSW IN SWD IS RESET WHEN PROCESSING A STATEMENT             00267702
*        CONTINUATION.                                                  00267802
*        FLSHMODE IN SWD IS RESET TO 0 BY SUCCESSFUL COMPLETION ON THE  00267902
*        NEWDUMP PROCESSOR.                                             00268002
*        NOLOADSW IS SET TO INDICATE THAT A CONTROL STATEMENT OTHER     00268102
*        THAN END HAS BEEN PROCESSED.                                   00268202
*        FMTDSW IN SWE IS INITIALLY SET TO ZERO.                        00268302
*        RESPC IN SWE IS RESET WHEN AN EDIT CONTINUATION STATEMENT IS   00268402
*        READ.                                                          00268502
*        BUILDMAP IN SWE IS SET DURING NEWDUMP PROCESSING WHEN THE DUMP 00268902
*        DATA SET MUST BE SCANNED AND MAPPED.                           00269002
*        PRNTRL IN PRSW IS SET TO 1 FOR A PRINT REAL REQUEST AND IS     00269402
*        RESET TO 0 AFTER THE REQUEST IS PROCESSED.                     00269502
*        QSEGTBSW IN PRSW IS SET TO 1 TO INDICATE THAT THE ADDRESS OF   00269902
*        SEGTAB WAS SET BY A CONTROL STATEMENT.                         00270002
*        ERRADDR IS SET TO ERRMSG, THE ADDRESS OF AMDPRCTL'S MAIN ERROR 00270402
*        HANDLER.                                                       00270502
*        STOPEXIT IS SET TO STOPCMP, THE ADDRESS OF THE FINAL STOP EXIT 00270902
*        ROUTINE.                                                       00271002
*        INDD IS USED TO SAVE THE DDNAME OF A NEW DUMP DATA SET WHEN A  00271402
*        NEWDUMP OR NEWTAPE (DEFAULT OF TAPE) CONTROL STATEMENT IS      00271502
*        PROCESSED.                                                     00271902
*        FILESEQ IS FILLED IN WITH THE FILE SEQUENCE NUMBER OF A        00272002
*        NEWDUMP DATA SET DURING NEWDUMP PROCESSING AND IS RESET TO     00272402
*        THE DEFAULT OF 1 DURING NEWTAPE PROCESSING.                    00272502
*        CVTADDR IS ZEROED AFTER PROCESSING FOR NEWDUMP OR NEWTAPE      00272902
*        CONTROL STATEMENTS AND SET BY CVT CONTROL STATEMENTS.          00273002
*        REALMAX IS RESTORED WITH THE TOP-OF-REAL VALUE THAT IS FOUND   00273402
*        IN REALMAX1 WHEN PROCESSING A NEWDUMP OR NEWTAPE CONTROL       00273502
*        STATEMENT.                                                     00273902
*        VERBGN IS FILLED IN WITH THE BEGINNING ADDRESS OF THE VERB     00274002
*        THAT IS BEING SCANNED.                                         00274402
*        SYNMSGA IS SET UP TO POINT TO THE APPROPRIATE TABLE OF SYNTAX  00274502
*        ERROR MESSAGE ADDRESSES.                                       00274902
*        DELIMCD IS USED TO SAVE THE CODE FOR THE MOST RECENTLY         00275002
*        ENCOUNTERED DELIMITER ON THE CURRENT CONTROL STATEMENT.        00275402
*        VERBEND IS FILLED IN WITH THE ADDRESS OF THE END OF THE VERB   00275502
*        THAT WAS JUST SCANNED.                                         00275602
*        KYWDBGN IS FILLED IN WITH THE ADDRESS OF THE BEGINNING OF THE  00275702
*        KEYWORD THAT IS BEING SCANNED.                                 00275802
*        ONGOPTR IS FILLED IN WITH A POINTER TO THE ONGO OPERANDS AND   00275902
*        IS ZEROED WHEN THE STORAGE FOR THE OPERANDS IS FREED.          00276002
*        KYWDEND IS FILLED IN WITH THE ADDRESS OF THE END OF THE        00276102
*        KEYWORD THAT WAS JUST SCANNED.                                 00276202
*        WORK1 IS USED AS A WORK AREA FOR DATA CONVERSION.              00276302
*        SEGTABOR IS FILLED IN WITH THE SEGMENT TABLE ADDRESS THAT WAS  00276402
*        GIVEN ON THE SEGTAB= CONTROL STATEMENT.                        00276502
*        TITLEMSG IS BLANKED OUT AND FILLED IN WITH THE TITLE FROM A    00276602
*        TITLE CONTROL STATEMENT.                                       00276702
*                                                                       00277002
*02*     RETURN-CODES = 0 OR 4 IN REGISTER 15 TO INDICATE WHERE TO      00277102
*        RESUME PROCESSING (VIA BRANCH TABLE IN AMDPRCTL): EITHER TEST  00277202
*        FOR NEW TITLE AND GET NEXT CONTROL STATEMENT, OR IMMEDIATELY   00277302
*        GET NEXT CONTROL STATEMENT.                                    00277402
*                                                                       00277502
*01*  EXIT-NORMAL = VERBSCN4                                            00277602
*                                                                       00278002
*02*     CONDITIONS = WHEN AMDPRMSC ENCOUNTERS AN END STATEMENT IT      00278102
*        CALLS AMDPREND TO INITIATE TERMINAL PROCESSING.  CONTROL IS    00278202
*        EVENTUALLY RETURNED TO THE OPERATING SYSTEM WITHOUT RETURNING  00278302
*        TO AMDPRMSC.  IN THIS CONTEXT, ENCOUNTERING AN END STATEMENT   00278402
*        RESULTS IN EXIT FROM AMDPRMSC.                                 00278502
*                                                                       00278702
*02*     OUTPUT = NONE                                                  00278802
*                                                                       00279202
*02*     RETURN-CODES = NONE                                            00279302
*                                                                       00279702
*01*  EXIT-NORMAL = EXITOUT                                             00279802
*                                                                       00280202
*02*     CONDITIONS = COMPLETION OF AMDPREND PROCESSING                 00280302
*                                                                       00280502
*02*     OUTPUT = WHEN AMDPREND IS ENTERED TO TRANSFER THE DUMP DATA    00280602
*        SET TO THE SYSUT2 DATA SET, ENDSW IN SWB IS SET TO 1 TO        00280702
*        INDICATE THAT AN END CONTROL STATEMENT IS BEING PROCESSED.     00280802
*        WHEN AMDPREND IS ENTERED TO PRINT THE EXECUTION STATISTICS,    00280902
*        THE MESSAGES THAT ARE LISTED UNDER THE AMDPREND PORTION OF     00281002
*        THE MESSAGES SECTION ARE OUTPUT TO THE SYSPRINT DATA SET.      00281102
*                                                                       00281402
*02*     RETURN-CODES = REGISTER 1 IS SET TO CONTAIN A TERMINATION CODE 00281502
*        OF 4 WHEN AMDPREND CALLS AMDPRXIT FOR TERMINAL PROCESSING.     00281602
*                                                                       00281902
*01*  EXIT-NORMAL = EXIT                                                00282002
*                                                                       00282402
*02*     CONDITIONS = COMPLETION OF PRDMP PROCESSING                    00282502
*                                                                       00282702
*02*     OUTPUT = ALL THE SWITCHES IN SWA, SWB, SWC, SWD, SWE,AND PRSW  00282802
*        ARE TURNED OFF PRIOR TO TERMINATION.                           00282902
*        PAGENUMB IS ZEROED.                                            00283002
*        CURBUF, THE ADDRESS OF THE CURRENT OUTPUT BUFFER, IS ZEROED.   00283102
*        ONGOPTR IS ZEROED.                                             00283202
*        REALMAX IS RESTORED WITH THE MAXIMUM REAL ADDRESS THAT WAS     00283302
*        STORED IN REALMAX1.                                            00283402
*        LINENUMB IS RESTORED TO CONTAIN THE DEFAULT NUMBER OF LINES    00283502
*        PER PAGE.                                                      00283602
*        LINENUM, THE NUMBER OF LINES PER PAGE EXCLUDING THE TWO LINES  00283702
*        USED FOR THE TITLE, IS RESTORED TO THE DEFAULT.                00283802
*                                                                       00284002
*02*     RETURN-CODES = 0 IN REGISTER 15                                00284102
*                                                                       00284502
*01*  EXIT-ERROR = STORERR                                              00322802
*02*     CONDITIONS = IF UPON ENTERING AMDPRCTL THERE IS LESS THAN 64K  00332802
*        OF STORAGE AVAILABLE FOR USE (WHICH IS THE MINIMUM AMOUNT IN   00342802
*        WHICH PRDMP CAN EXECUTE) THIS EXIT IS TAKEN.                   00352802
*                                                                       00362802
*02*     OUTPUT = MESSAGE AMD151I IS OUTPUT.                            00364802
*                                                                       00366802
*02*     RETURN-CODES = REGISTER 1 IS SET TO CONTAIN A VALUE OF 4.      00368802
*                                                                       00370402
*01*  EXIT-ERROR = RDRERR                                               00370602
*                                                                       00408902
*02*     CONDITIONS = IF CONTROL STATEMENTS ARE COMING FROM SYSIN AND   00447202
*        AN I/O ERROR OCCURS THE SYNAD ROUTINE CAUSES AMDPRCTL TO EXIT  00485502
*        TO AMDPRXIT.                                                   00523802
*                                                                       00562102
*02*     OUTPUT = NONE                                                  00600402
*                                                                       00638702
*02*     RETURN-CODES = REGISTER 0 CONTAINS A CODE OF 8 INDICATING THAT 00677002
*        AN ERROR OCCURRED IN THE SYSIN FILE.                           00715302
*        REGISTER 1 CONTAINS A CODE OF 12 INDICATING THAT AN I/O ERROR  00753602
*        OCCURRED.                                                      00791902
*                                                                       00830202
*01*  EXIT-ERROR = MAP4                                                 00868502
*                                                                       00906802
*02*     CONDITIONS = IF AMDPRMSC IS ASKED TO PROCESS A BLANK INPUT     00945102
*        STATEMENT, AMDPRMSC RETURNS CONTROL TO AMDPRCTL TO READ        00983402
*        ANOTHER CONTROL STATEMENT.                                     01021702
*                                                                       01060002
*02*     OUTPUT = NONE                                                  01098302
*                                                                       01136602
*02*     RETURN-CODES = A CODE OF 4 IN REGISTER 15 WHICH INDICATES THAT 01174902
*        ANOTHER CONTROL STATEMENT SHOULD BE READ.                      01213202
*                                                                       01251502
*01*  EXTERNAL-REFERENCES = SEE COMMENTS THAT FOLLOW                    01289802
*                                                                       01328102
*02*     ROUTINES = AMDPRSYN IS USED TO WRITE SYNTAX ERROR MESSAGES TO  01366402
*        THE SYSPRINT DATA SET AND ALSO THE CONSOLE IF CONTROL          01404702
*        STATEMENTS ARE BEING ENTERED FROM THE CONSOLE.                 01443002
*        AMDPRSEG IS USED TO LOAD VARIOUS AMDPRDMP SERVICE ROUTINES.    01481302
*        AMDPRUIM IS USED TO PROCESS VERBS ON PRDMP CONTROL STATEMENTS  01519602
*        THAT ARE NOT RECOGNIZED AS ORDINARY PRDMP VERBS.               01557902
*        THE FOLLOWING EXECUTOR MODULES OF AMDPRDMP ARE LOADED AND      01596202
*        CALLED BY AMDPRMSC:                                            01634502
*        AMDPRLPA - LPA VERB PROCESSING                                 01672802
*        AMDPRFXT - FORMAT                                              01711102
*        AMDPRSCN - GTF/EDIT (CONTROL STATEMENT SCAN PHASE)             01749402
*        AMDPRXED - GTF/EDIT (EXECUTION PHASE)                          01787702
*        AMDPRPMS - PRINT STORAGE,REAL                                  01826002
*        AMDPRNUC - PRINT NUCLEUS,SQA,CSA                               01864302
*        AMDPRPJB - PRINT JOBNAME                                       01902602
*        AMDPRPCR - PRINT CURRENT                                       01940902
*        AMDPRSUM - SUMMARY                                             01979202
*        AMDPRGCD - CPUDATA                                             02017502
*                                                                       02055802
*02*     DATA-AREAS = COMMON AREAS REFERENCED BY AMDPRCTL, BUT NOT      02094102
*        MODIFIED ARE:  ONEA,EIGHT, FOUR, TITLE, STOP, HTEN, TWO,       02132402
*        CAPTABL, RESPC SWITCH IN SWE, AND CONTSW SWITCH IN SWD.        02170702
*                                                                       02209002
*        AREAS REFERENCED BY AMDPRMSC ARE: ASYNTAX, BLNK, ONEA, EIGHT,  02247302
*        TITLE, RDRSW SWITCH IN SWA, FOUR, TWELVE, SIX, BLANKS, AINDCB, 02285602
*        MSG2, MSG1,MSG3,ATCBREMV.                                      02323902
*                                                                       02362202
*        AREAS REFERENCED BY AMDPREND ARE: NOLOADSW SWITCH IN SWD,      02400502
*        RDENTRY, READTM, READNO, RDERCNT, BUFREINT, BUFSUM, AND HTEN.  02438802
*                                                                       02477102
*        AREAS REFERENCED BY AMDPRXIT ARE: DCBADDRS, TWO.               02515402
*                                                                       02553702
*02*     CONTROL-BLOCKS = AMDPRCTL:  DCB-(R),ECB FOR WTOR - (C,W)       02592002
*        AMDPRMSC: UCB-(R) - (DEVTYPE MACRO INSTRUCTION); DCB -(R)      02630302
*        AMDPRXIT: DCB-(R)                                              02668602
*                                                                       02706902
*01*  TABLES = ERBRTAB - BRANCH ENTRY TABLE IN AMDPRXIT                 02745202
*     ERNMTAB - NAME TABLE IN AMDPRXIT                                  02783502
*                                                                       02821802
*01*  MACROS = OPEN,WTOR,WAIT,GET,SAVE,GETMAIN,FREEMAIN,WTO,DEVTYPE,    02860102
*     CLOSE,FREEPOOL,RETURN,BRREAD,BRWRITE,BRPRTMSG                     02898402
*                                                                       02936702
*02*     SERIALIZATION = NONE                                           02975002
*                                                                       03013302
*01*  CHANGE-ACTIVITY = SEE MICROFICHE FLAGGING ABOVE                   03051602
*                                                              @UZ81000 03053600
* UZ81000 - SU 10 SUPPORT                                      @UZ81000 03055600
*         - SUPPORT FOR CONDENSED DUMP                         @UZ81000 03057600
*                                                              @OZ09686 03059600
* OZ09686 - 0C1 ABEND AFTER AMD154                             @OZ09686 03061600
*         - INITIALIZE BEFORE TERMINATING IF END IS ENTERED    @OZ09686 03063600
*                                                              @OZ12030 03065600
* OZ12030 - PROVIDE RETURN CODE OF 4 IF DUMP D/S IS EMPTY      @OZ12030 03067600
*         - CHECK FOR EMPTY D/S BEFORE ENDING                  @OZ12030 03069600
*                                                              @OZ19024 03071600
* OZ19024 - REPLY 'SAME' TO AMD154 IS TREATED AS TITLE         @OZ19024 03073600
*         - START CHECK FOR TITLE AFTER 'SAME'                 @OZ19024 03075600
*                                                              @OZ24196 03075700
* OZ24196 - TITLE FOR OLD DUMP IN HEADER FOR NEWDUMP           @OZ24196 03075800
*         - CLEAR OLD TITLE IN THE HEADER FOR NEWDUMP ENTRY    @OZ24196 03075900
* OZ27117 - INAPPROPRIATE MAXIMUM LINE COUNT VALUE             @ZA27117 03076000
*         - RESET MAXIMUM LINE COUNT LINE VALUE  11/10/77      @ZA27117 03076100
*                                                                       03089902
*01*  MESSAGES = THE FOLLOWING MESSAGES AND OUTPUT COMMENTS ARE ISSUED  03128202
*     FROM THE VARIOUS CSECTS IN THIS MODULE:                           03166502
*                                                                       03204802
*     AMDPRCTL:                                                         03243102
*     AMD151I INSUFFICIENT STORAGE - EXECUTION TERMINATED               03253102
*     AMD187I INVALID EXEC CARD PARAMETER - SYSPRINT DATA SET           03281402
*     AMD154D REPLY TITLE, 'SAME', OR 'END' - CONSOLE                   03319702
*     AMD155D REPLY WITH GO, DESIRED FUNCTION OR END - CONSOLE          03358002
*     AMD199D CONTINUE DEFINITION - CONSOLE                             03396302
*     AMD210D RESPECIFY EDIT KEYWORDS OR REPLY 'RUNEDIT'                03434602
*     AMD170I END OF FILE ON SYSIN - CONTROL PASSED TO OPERATOR -       03472902
*     SYSPRINT DATA SET                                                 03511202
*     AMD283D REPLY WITH NEWDUMP OR END - CONSOLE                       03549502
*     THE REPLIES TO MESSAGES AMD155D,AMD199D,AMD210D,AND AMD283D MADE  03587802
*     BY THE OPERATOR ARE PRINTED ON SYSPRINT.                          03626102
*                                                                       03664402
*     AMDPRMSC:                                                         03702702
*     AMD162I GO FUNCTIONS TO BE PERFORMED - SYSPRINT AND/OR CONSOLE    03741002
*     THIS MESSAGE IS FOLLOWED BY A LINE LISTING THE GO FUNCTIONS.      03779302
*     AMD164I TAPE IS PREFORMATTED DUMP - REMAINING PARAMETERS IGNORED  03817602
*     - SYSPRINT                                                        03855902
*     AMD168I DUMP DATA SET EMPTY - DD XXXXXXXX - SYSPRINT              03894202
*                                                                       03932502
*     AMDPREND:                                                         03970802
*     1   NO OF ENTRIES TO READ ROUTINE 0000000000 - SYSPRINT           04009102
*     2   NO OR TIMES REQ ADDR WAS NOT IN A BUFFER - 0000000000 -       04047402
*     SYSPRINT                                                          04085702
*     3   NO OF BLOCKS READ - 0000000000 - SYSPRINT                     04124002
*     4   NO OF PERMANENT I/O ERRORS - 0000000000 - SYSPRINT            04162302
*     RATIO OF ITEM 1 TO ITEM 2 - XXX TO 1 - SYSPRINT                   04200602
*     5   AVERAGE NO OF BUFFERS PER FUNCTION - XXXX.XX - SYSPRINT       04238902
*     6   NUMBER OF TRACE RECORDS PROCESSED  - 0000000000 - SYSPRINT    04277202
*                                                                       04315502
*     AMDPRXIT:                                                         04353802
*                  PRINTER                                              04392102
*                  SYSUT1                                               04430402
*     AMD150I FILE SYSIN   CANNOT BE OPENED                             04468702
*                  XXXXXX                                               04507002
*                  SYSUT2                                               04545302
*                            PRINTER                                    04583602
*                            SYSUT1                                     04621902
*     PERMANENT I/O ERROR ON SYSIN     - EXECUTION TERMINATED           04660202
*                            XXXXXXX                                    04698502
*                            SYSUT2                                     04736802
*                                                                       04775102
*01*  ABEND-CODES = NONE                                                04813402
**** END OF SPECIFICATIONS ***/                                         04851702
*                                                                     * 04890002
*********************************************************************** 10200002
*/*AMDPRCTL: CHART (SEQ) */                                             10230002
*/* HEADER                                                              10260002
*/*AMDPRCTL - SCANS CONTROL STATEMENTS & LOADS CORRESPONDING MODULES    10290002
*/*                                                       PAGE #    */  10320002
*/*SYNTAX: N SYNTAX IS EP (VIA DSECT) IN AMDPRSYN MODULE */             10350002
*/* P (,SYNTAX4) INDICATE STANDARD ERROR MSG */                         10380002
*/*SYNTAXA: N SYNTAXA IS EP (VIA DSECT) IN AMDPRSYN MODULE */           10410002
*/* P (,SYNTAX4) LOAD @ OF 1ST ERROR MSG */                             10440002
*/*SYNTAXB: N SYNTAXB IS EP (VIA DSECT) IN AMDPRSYN MODULE */           10470002
*/* P (,SYNTAX4) LOAD @ OF 2ND ERROR MSG */                             10500002
*/*SYNTAXC: N SYNTAXC IS EP (VIA DSECT) IN AMDPRSYN MODULE */           10530002
*/* P (,SYNTAX4) LOAD @ OF 3RD ERROR MSG */                             10560002
*/*SYNTAXD: N SYNTAXD IS EP (VIA DSECT) IN AMDPRSYN MODULE */           10590002
*/* P (,SYNTAX4) LOAD @ OF 4TH ERROR MSG */                             10620002
*/*SYNTAXE: N SYNTAXE IS EP (VIA DSECT) IN AMDPRSYN MODULE */           10650002
*/* P (,SYNTAX4) LOAD @ OF 5TH ERROR MSG */                             10680002
*/*SYNTAX4: P SAVE CALLER'S REG */                                      10710002
*/* I WRITE MSG ON SYSPRINT (AMDPRSYN) */                               10740002
*/* P RESTORE CALLER'S REG. (AMDPRSYN) */                               10770002
*/* R RETURN FROM AMDPRSYN */                                           10800002
*/*AMDPRCTL: E START */                                                 10830002
*/* P SET ERROR ROUTINE @ TO ZERO */                                    10860002
*/* P SET CVT @ IN COM TO ZERO */                                       10890002
*/* P GET LENGTH OF EXEC CARD PARM. */                                  10920002
*/* D (NO,BEGIN6,YES,) IS LENGTH POSITIVE */                            10950002
*/* P SET COUNT TO ZERO */                                              10980002
*/* P SET PARM. POINTER TO BEGIN. OF PARM STRING */                     11010002
*/* P SET DELIMITER POINTER TO BEGIN. OF STRING  */                     11040002
*/*BGNLOOP: D (YES,BEGIN1,NO,) IS DELIMITER A COMMA */                  11070002
*/* P INCREMENT COUNT BY 1   */                                         11100002
*/*BEGIN2: P INCREMENT DELIMITER POINTER BY 1 */                        11130002
*/* P DECREASE LENGTH BY 1 */                                           11160002
*/* D (YES,BEGIN1,NO,BGNLOOP) LENGTH ZERO */                            11190002
*/*BEGIN1: D (YES,BEGINER,NO,) COUNT LESS THAN 1 */                     11220002
*/* D (YES,BEGLNCT,NO,) COUNT GREATER 8 */                              11280002
*/* D (YES,BEGER,NO,) COUNT = 4 */                                      11340002
*/*BEGIN5: P DECREMENT COUNT BY 1 FOR EXECUTE INSTR. */                 11370002
*/* P POINT TO "TITLE" */                                               11400002
*/* D (EQ,BEGTITLE,NE,) EXECUTE COMPARE OF PARM TO T OF "TITLE" */      11430002
*/* P POINT TO "STOP" */                                                11460002
*/* D (EQ,%BEGSTOP,NE,BEGINER) EXECUTE COMPARE PARM TO "STOP" */        11490002
*/*BEGINER: D (YES,BEGIN3,NO,) HAS ERROR MSG BEEN GIVEN */              11520002
*/* M INDICATE MESSAGE ISSUED */                                        11550002
*/* L BRPRTMSG: ISSUE MESSAGE AMD186I TO SYSPRINT */                    11580002
*/*BEGIN3: D (YES,BEGIN6,NO,) LENGTH EQUAL TO ZERO */                   11610002
*/* P SET COUNT TO ZERO */                                              11640002
*/* P (,BEGIN2) UPDATE START @ FOR PARM. TO BE SEARCHED */              11670002
*/*BEGLNCT: N LENGTH GREATER THAN 8 - TEST FOR LINECNT */               11850002
*/* D (NO,BEGINER,YES,) PARM "LINECNT" */                               11880002
*/* P SUB. 8 FROM COUNT - LENGTH OF VALUE */                            11910002
*/* P POINT TO VALUE */                                                 11940002
*/* S BEGFREE2: CONVERT VALUE TO BINARY */                              11970002
*/* D (NO,BEGINER,YES,) VALUE GREATER THAN 10 */                        12000002
*/* P STORE VALUE IN COMMON (LINENUMB) */                               12030002
*/* P SUB. 2 TO ACCOUNT FOR TITLE */                                    12060002
*/* P (,BEGIN3) STORE AS CURRENT LINE NUMBER (LINENUM) */               12090002
*/*BEGFREE2: P SET VALUE COUNT TO LENGTH */                             12270002
*/* P SAVE DELIMITER POINTER */                                         12300002
*/*BEGFREE1: D (NO,BEGINER,YES,) VALUE HAS ZONE OF F */                 12330002
*/* P INCREMENT DELIMITER POINTER */                                    12360002
*/* P DECREMENT VALUE COUNT BY 1 */                                     12390002
*/* D (NO,BEGFREE1,YES,) VALUE COUNT 0 */                               12420002
*/* P DECREMENT LENGTH FOR EX INSTR. */                                 12450002
*/* P RESTORE DELIMITER POINTER */                                      12480002
*/* P EXECUTE PACK - PACK VALUE */                                      12510002
*/* P CONVERT VALUE TO BINARY */                                        12540002
*/* R RETURN */                                                         12570002
*/*BEGTITLE: M (,BEGIN3) SET TITLE SWITCH */                            12690002
*/*%BEGSTOP: M (,BEGIN3) SET STOP SWITCH */                             12720002
*/*BEGIN6: N SCAN OF EXEC PARM. COMPLETE */                             12810002
*/* P SET UP DEFAULT ONGO VALUE */                                      12820002
*/* L GETMAIN FOR ALL CONTIGUOUS STORAGE */                             12860002
*/* D (YES,,NO,STOROKAY) IS SIZE < 64K */                               12910002
*/* P SET UP TO PRINT STORAGE ERROR MSG */                              12920002
*/* L CALL SYNTAX RTN TO PRINT ERROR MSG */                             12922002
*/* P SET NO MSG RETURN CODE */                                         12924002
*/* R RETURN TO AMDPRXIT */                                             12926002
*/*STOROKAY: P SAVE THE SIZE OF STORAGE GOTTEN IN COMMON */             12928002
*/* L FREE THE STORAGE */                                               12928402
*/* M INDICATE DUMP DS MUST BE SCANNED & MAPPED */                      12930002
*/* M SET POSITIONING REQUIRED SWITCH */                                12960002
*/* L BRWRITE: OPEN PRINTER DATA SET */                                 13020002
*/* L OPEN: SYSIN DCB */                                                13110002
*/* D (NO,BEGIN7,YES,) OPEN OK */                                       13140002
*/* P STORE SYSIN DCB @ IN COMMON */                                    13170002
*/* M (,CALLUIMI) SET RDR SWITCH - SYSIN CONTROL */                     13200002
*/*BEGIN7: M  TURN OFF RDR SWITCH - CONSOLE CONTROL */                  13230002
*/*CALLUIMI: L AMDPRUIM: INITIALIZE USER INTERFACE MODULE */            13240002
*/*WRTMSG: D (OFF,TRDRSW,ON,) TITLE SWITCH */                           13260002
*/*DUMPMSG: P CLEAR BUFFER AREA */                                      13290002
*/*TITLMSG: I WTOR: GET TITLE */                                        13320002
*/* W WAIT FOR WTO REPLY */                                             13350002
*/* P TRANSLATE REPLY TO CAPS. */                                       13380002
*/* P CLEAR WTOR ECB */                                                 13410002
*/* D (YES,TRDRSW,NO,) IS REPLY "SAME" */                               13440002
*/* D (YES,%2,NO,) IS REPLY "END" */                                    13470002
*/* P (,TRDRSW) MOVE TITLE TO COMMON */                                 13500002
*/*%2: P (,AMDPREND) POINT TO AMDPREND */                               13530002
*/*TRDRSW: D (YES,RDCARD,NO,) CONTROL STMT'S FROM READER */             13560002
*/*WRTMSG1: P CLEAR INPUT BUFFER */                                     13590002
*/* D (ON,NEWDMSG,OFF,) TEST FLUSHMODE SWITCH */                        13640002
*/* D (OFF,,ON,RESPMSG) TEST RESPECIFY SWITCH */                        13650002
*/* D (ON,CONTMSG,OFF,) TEST CONTINUATION SWITCH */                     13680002
*/* I (,WTORWAIT) WTOR: ISSUE AMD155D "REPLY WITH GO,..." */            13710002
*/*NEWDMSG: I (,WTORWAIT) WTOR: ISSUE MESSAGE FOR NEWDUMP OR END */     13720002
*/*RESPMSG: I (,WTORWAIT) WTOR: ISSUE AMD210D */                        13740002
*/*CONTMSG: I (,WTORWAIT) WTOR: ISSUE MESSAGE AMD199D "CONTINUE" */     13770002
*/*WTORWAIT: W WAIT FOR REPLY */                                        13800002
*/* P CLEAR WTOR ECB */                                                 13830002
*/*CALLSCAN: P TRANSLATE REPLY TO CAPS. */                              13860002
*/* L BRPRTMSG: PRINT REPLY ON SYSPRINT */                              13890002
*/* L AMDPRMSC: ISOLATE CONTROL STATEMENT PARM */                       13920002
*/* D (4,TRDRSW,0,WRTMSG) TEST RETURN CODE */                           13950002
*/*RDCARD: I (EOF,,SYND,RDRERR,,CALLSCAN) GET CONTROL CARD */           13980002
*/*RDREOF: L BRPRTMSG: PRINT EOF MESSAGE (AMD170I) */                   14010002
*/* M (,WRTMSG1) TURN OFF RDR SWITCH */                                 14040002
*/*RDRERR: P SET SYSIN DDNAME CODE (R0 = 8) */                          14070002
*/* P (,AMDPRXIT) SET I/O ERROR MSG. CODE (R1 = 12) */                  14100002
*/*BEGER: D (NO,BEGIN5,YES,) PARM = "ED" EDIT ERROR */                  14340002
*/* P POINT TO VALUE */                                                 14370002
*/* D (NO,BEGINER,YES,) VALUE HAVE F ZONE */                            14400002
*/* D (YES,BEGINER,NO,) VALUE GT MAX OF 3 */                            14430002
*/* P (,BEGIN3) STORE VALUE IN COMMON IN HEX */                         14460002
*/*AMDPRMSC: E ENTER */                                                 14490002
*/* P SAVE CALLER'S REG. & CHAIN SAVE AREAS */                          14520002
*/* P SET @ OF ERROR ROUTINE */                                         14550002
*/* P STORE POINTER TO LIST OF SYNTAX ERROR MSG @'S */                  14560002
*/* P POINT TO AMDPRSYN SYNTAX MSG ROUTINE */                           14570002
*/* M RESET SWA EXCEPT FOR RDR & CVT @ SWITCHES */                      14580002
*/*VERBSCN5: D (YES,VERBSCN6,NO,) COLUMN 72 BLANK */                    14590002
*/* P MAKE COLUMN 72 BLANK */                                           14600002
*/* L AMDPRSYN: EP=SYNTAXE - COL 72 NOT BLANK */                        14602002
*/*VERBSCN6: D (YES,MAP4,NO,) INPUT BUFFER BLANK */                     14610002
*/*VERBSCN3: M RESET I/O & FORMAT ERROR SWITCHES */                     14640002
*/* M RESET PRE-FORMATTED SWITCH */                                     14670002
*/* P STORE @ OF CONTROL STATEMENT VERB */                              14700002
*/*CK4PRST: P SET @ OF STOP ROUTINE */                                  14730002
*/* P POINT RETURN FROM AMDPRSYN TO MAP4 */                             14820002
*/* D (YES,EDITCONT,NO,) PROCESSING A CONTINUATION CARD */              14830002
*/*SETDELCD: P SET DELIMITER TO ZERO FOR TRT INSTR. */                  14850002
*/* D (YES,SYNTAXA,NO,) VERB LONGER THAN 8 CHAR. */                     14880002
*/* D                                                                   14910002
*/*(COMA,VERBSCN4,EQSN,VERBSCN4,BLK,VERBSCN4,LPRN,SYNTAXB,RPRN,         14940002
*/*SYNTAXB) TEST DELIMITER */                                           14970002
*/*VERBSCN4: P SAVE DELIMITER */                                        15000002
*/* P SAVE @ OF DELIMITER */                                            15030002
*/* P CALC. LENGTH OF VERB */                                           15060002
*/* D (NO,SYNTAX,YES,) LENGTH POSITIVE */                               15090002
*/* P LOAD @ OF VERB FOR COMPARES */                                    15092002
*/* P DECREMENT LENGTH BY 1 FOR EX INSTR. */                            15150002
*/* D (YES,%5,NO,) VERB IS "END" */                                     15180002
*/*CVTTEST: M INDICATE END NOT ONLY CONTROL STATEMENT */                15210002
*/* D (YES,CVTSET,NO,) VERB IS "CVT" */                                 15240002
*/* D (YES,SEGTBSET,NO,) VERB IS 'SEGTAB' */                            15250002
*/* D (YES,SYNTAXB,NO,) DELIMITER AN EQUAL SIGN */                      15270002
*/* D (NO,CKOTHR,YES,) VERB LENGTH = 6 */                               15272002
*/* D (YES,SUMMARY,NO,) VERB IS 'SUMMARY' */                            15280002
*/* D (YES,CPUDATA,NO,) VERB IS 'CPUDATA' */                            15290002
*/*CKOTHR: D (LPA,MAP,FMT,PRNTFMT,TITL,TITLEVRB,PRNT,                   15300002
*/*PRINT,GO,GO,ONGO,ONGO,NTPE,NEWTDUMP,NDMP,NEWDUMP,ND,NEWDUMP,EDIT,    15330002
*/*EDIT,,CALLUIM) TEST VERB VIA EX */                                   15360002
*/*%5: D (NO,SYNTAXB,YES,) DELIMITER A BLANK */                         15370002
*/* S AMDPREND: END */                                                  15390002
*/* N (,CVTTEST) NO RETURN FROM AMDPREND EXPECTED */                    15420002
*/*CALLUIM: M INDICATE CTL IS CALLER */                                 15620002
*/* L (,MAP2) AMDPRUIM: TEST FOR USER VERBS AND INVALID VERBS */        15670002
*/*TITLEVRB: D (NO,SYNTAX,YES,) BLANK DELIMITER */                      15960002
*/* P POINT TO TITLE TO BE PRINTED */                                   15990002
*/* D (NP,SYNTAX,POS,) CALC. LENGTH OF TITLE */                         16020002
*/* D (YES,TITLMOVE,NO,) LENGTH OF TITLE & BLANK DELIMITER LT 64 */     16050002
*/* P SET LENGTH OF TITLE TO MAX OF 64 */                               16080002
*/*TITLMOVE: P BLANK TITLE MSG AREA */                                  16110002
*/* P DECREASE LENGTH BY 1 FOR EX INSTR. */                             16140002
*/* P (,MAP4) MOVE TITLE TO MSG AREA VIA EX */                          16170002
*/*NEWDUMP: P POINT RETURN FROM AMDPRSYN TO MAP4 */                     16230002
*/* M INDICATE FLSHMODE SHOULD BE SET IF ERROR OCCURS */                16240002
*/* P SET DDNAME TO DEFAULT "TAPE" */                                   16260002
*/* P SET FILE SEQ. TO DEFAULT 1 */                                     16290002
*/* D (YES,NEWDPGO1,NO,) COMMA DELIMITER */                             16350002
*/* D (NO,SYNTAXB,YES,) BLANK DELIMITER */                              16380002
*/* P STORE LIST SYNTAX ERROR MSG. @'S IN COMMON */                     16410002
*/* D (NEG,SYNTAX,ZERO,NEWDPGO2,POS,) CALC LENGTH OF REMAINDER OF       16440002
*/*BUFFER */                                                            16470002
*/* P DECREASE LENGTH BY 1 FOR EX INSTR. */                             16500002
*/* P POINT TO REMAINDER OF BUFFER */                                   16530002
*/* P CLEAR DELIMITER */                                                16560002
*/* P SEARCH REMAINDER OF BUFFER FOR CHAR OR NUMERIC */                 16590002
*/* D (YES,NEWDPGO2,NO,) REMAINDER ALL BLANK */                         16620002
*/* P SAVE @ OF KEYWORD */                                              16650002
*/*NEWDUMP1: D (NO,SYNTAXA,YES,) A DELIMITER IN NEXT 9 CHAR */          16680002
*/* P SAVE @ OF KEYWORD DELIMITER */                                    16710002
*/* P SAVE KEYWORD DELIMITER CODE */                                    16740002
*/* D (NO,SYNTAXB,YES,) DELIMITER EQUAL SIGN */                         16770002
*/* P CALC. LENGTH OF KEYWORD */                                        16800002
*/* D (YES,SYNTAX,NO,) LENGTH NOT POSITIVE */                           16830002
*/* P DECREMENT LENGTH BY 1 FOR EX INSTR. */                            16860002
*/* D (FSEQ,NEWFILE,DDN,NEWDD,,SYNTAXC) TEST                            16890002
*/*KEYWORD VIA EX INSTR */                                              16920002
*/*NEWTDUMP: P POINT RETURN FROM AMDPRSYN TO MAP4 */                    16950002
*/* M INDICATE FLSHMODE SHOULD BE SET IF ERROR OCCURS */                16960002
*/* P SET DDNAME TO "TAPE" (DEFAULT) */                                 16980002
*/* P SET FILE SEQ TO 1 (DEFAULT) */                                    17010002
*/* D (YES,NEWDPGO1,NO,) IS DELIMITER A COMMA */                        17070002
*/* D (NO,SYNTAXB,YES,NEWDPGO2) IS DELIMITER A BLANK */                 17100002
*/*NEWISOLT: P POINT TO PARAMETER VALUE */                              17130002
*/* P CLEAR DELIMITER */                                                17160002
*/* D (NO,SYNTAXD,YES,) A DELIMITER IN NEXT 9 CHAR */                   17190002
*/* P SAVE @ OF VALUE DELIMITER */                                      17220002
*/* P SAVE DELIMITER CODE */                                            17250002
*/* D (YES,NEWDUMP3,NO,) IS DELIMITER A COMMA */                        17280002
*/* D (NO,SYNTAXB,YES,) IS DELIMITER A BLANK */                         17310002
*/*NEWDUMP3: P COMPUTE LENGTH OF VALUE */                               17340002
*/* D (YES,NEWMORE,NO,) LENGTH ZERO */                                  17370002
*/* P POINT TO VALUE */                                                 17400002
*/* R RETURN VIA R3 */                                                  17430002
*/*NEWDD: S NEWISOLT: ISOLATE @ & LENGTH OF DDNAME */                   17460002
*/* P CLEAR DDNAME */                                                   17490002
*/* P DECREMENT LENGTH BY 1 FOR EX INSTR. */                            17520002
*/* P (,NEWMORE) SET DDNAME TO PARM. VALUE */                           17550002
*/*NEWFILE: S NEWISOLT: ISOLATE @ & LENGTH OF FILE SEQ # */             17580002
*/* S NEWCONV: CONVERT VALUE TO BINARY */                               17610002
*/* P (,NEWMORE) SET FILE SEQ # TO PARM. VALUE */                       17640002
*/*NEWCONV: P MOVE @ & LENGTH OF VALUE TO WORK AREA */                  17670002
*/*NEWCONV1: D (NO,SYNTAXD,YES,) DIGIT OF VALUE HAVE "F" ZONE */        17700002
*/* P POINT TO NEXT DIGIT OF VALUE */                                   17730002
*/* D (NO,NEWCONV1,YES,) ALL DIGITS OF VALUE TESTED */                  17760002
*/* P POINT TO BEGINNING OF VALUE */                                    17790002
*/* P DECREMENT VALUE BY 1 FOR EX INSTR */                              17820002
*/* P CONVERT VALUE TO BINARY */                                        17850002
*/* D (YES,SYNTAXD,NO,) VALUE LESS THAN 1 */                            17880002
*/* R RETURN VIA R3 */                                                  17910002
*/*NEWMORE: D (YES,NEWDPGO2,NO,) DELIMITER A BLANK */                   17940002
*/* P POINT TO NEXT KEYWORD */                                          17970002
*/* P (,NEWDUMP1) UPDATE @ OF KEYWORD TO BE PROCESSED */                18000002
*/*NEWDPGO1: M (,NEWDPGO) INDICATE DELIMITER WAS COMMA */               18030002
*/*NEWDPGO2: M INDICATE DELIMITER WAS NOT COMMA (BLANK) */              18060002
*/*NEWDPGO: M INDICATE NEW DUMP */                                      18090002
*/*NEWTSTMS: L DEVTYPE: OBTAIN DEVICE ATTRIBUTES FOR DDNAME */          18150002
*/* D (YES,DDPRES,NO,) DEVTYPE SUCCESSFUL */                            18180002
*/* P STORE "NO DD" MESSAGE IN COMMON */                                18210002
*/* D (YES,ITSMAP2,NO,) NEWDUMP CONTINUATION? */                        18220002
*/* P (,SYNTAXA) POINT RETURN FROM AMDPRSYN TO MAP4 */                  18230002
*/*ITSMAP2: P (,SYNTAXA) POINT RETURN FROM AMDPRSYN TO MAP2 */          18240002
*/*DDPRES: D (NO,,YES,CLOSESEQ) TAPE DEVICE */                          18270002
*/*DAINPUT: P GET @ OF SYNTAX WRITER */                                 18466002
*/* D (YES,,NO,SYNTAXE) FILE SEQ # 1 */                                 18474002
*/*CLOSESEQ: P GET @ OF AINDCB */                                       18494002
*/*SEQLOOP1: P LOAD DCB ADDRESS */                                      18504002
*/* P CLEAR POSSIBLE HI ORDER BYTE */                                   18506002
*/* D (YES,,NO,SEQLOOP2) HAD DCB BEEN STORED? */                        18508002
*/* D (YES,,NO,SEQLOOP2) IS THIS DCB OPEN? */                           18510002
*/* L CLOSE THIS DCB */                                                 18512002
*/*SEQLOOP2: D (YES,SEQEND,NO,) LAST ENTRY IN DCB LIST? */              18512102
*/* P (,SEQLOOP1) STEP TO NEXT DCB ADDRESS */                           18512202
*/*SEQEND: M INDICATE INPUT POSITIONING REQUIRED */                     18529102
*/* M INDICATE DUMP DS MUST BE SCANNED & MAPPED */                      18539102
*/* M TURN OFF QUT1PRE & QUT1LOD SWITCHES */                            18579602
*/*NEWRESET: M INDICATE GET MASTER ROUTINE REQUIRED */                  18772002
*/* M RESET FLUSH MODE */                                               18774002
*/* M RESET CVT CONTROLLED SWITCH */                                    18776002
*/* M RESET READ INIT. SUPPRESSION SWITCH */                            18778002
*/* P RESTORE MAX @ ALLOWABLE */                                        18778402
*/* P RESTORE TOP-OF-REAL VALUE */                                      18778802
*/* P ZERO CVT @ */                                                     18779602
*/* M RESET SWF */                                                      18789202
*/* P ZERO QASID */                                                     18793202
*/* P ZERO IPLCPU */                                                    18793302
*/* M RESET SEGTAB SWITCH */                                            18793602
*/*NEWDONE: M RESET NEW DUMP PROCESSING SWITCH */                       18795602
*/* D (YES,,NO,MAP4) NEWDUMP CONTINUATION */                            18797602
*/*MAP2: D (YES,MAP3,NO,) DELIMITER A COMMA */                          18802402
*/*MAP1: P SET R15 TO ZERO - NEED NEW TITLE */                          18810002
*/*MAP5: P RESTORE CALLER'S REG. */                                     18870002
*/* R RETURN */                                                         18900002
*/*MAP3: P (,VERBSCN3) POINT TO FIRST LOCATION FOR NEXT VERB */         18930002
*/*MAP4: P (,MAP5) SET R15 TO 4 - DO NOT NEED NEW TITLE */              18960002
*/*SUMMARY: D (YES,MAP2,NO,) IN FLUSH MODE */                           19010002
*/* P POINT TO SUM PATH DESCRIPTOR */                                   19040002
*/* L AMDPRSEG: LOAD AMDPRSUM PATH */                                   19090002
*/* L (,MAP2) AMDPRSUM: SUMMARIZE DUMP DATA SET INFORMATION */          19140002
*/*CPUDATA: D (YES,MAP2,NO,) IN FLUSH MODE */                           19142002
*/* P POINT TO GCD PATH DESCRIPTION */                                  19150002
*/* L AMDPRSEG: LOAD AMDPRGCD PATH DESCRIPTOR */                        19160002
*/* L (,MAP2) AMDPRGCD: GET CPUDATA INFORMATION FROM DUMP */            19162002
*/*PRNTFMT: D (YES,MAP2,NO,) IN FLUSH MODE */                           19164002
*/* M RESET FORMATTED TCB LIST SWITCH */                                19170002
*/* P POINT TO FSR PATH DESCRIPTOR */                                   19200002
*/* L AMDPRSEG: LOAD AMDPRFSR PATH */                                   19230002
*/* L (,MAP2) AMDPRFSR: BUILD LIST OF TCB @'S ON TREE */                19260002
*/*MAP: D (YES,MAP2,NO,) IN FLUSH MODE */                               19310002
*/* P POINT TO LPA PATH DESCRIPTOR */                                   19320002
*/* L AMDPRSEG: LOAD AMDPRLPA PATH */                                   19350002
*/* L (,MAP2) AMDPRLPA: MAP LINK PACK AREA */                           19380002
*/*EDITCONT: M INDICATE RESPCIFY PROCESSED */                           19720002
*/* M (,EDITSCN) INDICATE CONTINUATION PROCESSED */                     19730002
*/*EDIT: P STORE DELIMITER CODE */                                      19740002
*/* P INDICATE EDIT IN PROGRESS */                                      19770002
*/*EDITSCN: P POINT TO PATH DESCRIPTOR FOR SCAN PHASE OF EDIT */        19800002
*/* L AMDPRSEG: LOAD AMDPRSCN PATH */                                   19830002
*/* L AMDPRSCN: EXECUTE EDIT SCAN */                                    19840002
*/* D (0,TEST4CT,1,) TEST CONTINUATION INVALID SWITCH */                19850002
*/* M ZERO CONTINV SWITCH */                                            19852002
*/* D (NO,MAP4,YES,) CONTROL STMT'S FROM READER */                      19854002
*/* M (,SETDELCD) ZERO CONTSW,RESPC,EDITSW SWITCHES */                  19856002
*/*TEST4CT: D (YES,MAP4,NO,) EDIT STATEMENT CONTINUATION */             19860002
*/* P RESTORE DELIMITER CODE */                                         19890002
*/*EDITCODE: D (YES,LODEXPHZ,NO,) SCAN PORTION OF EDIT SUCCEED */       19920002
*/* P (,MAP1) INDICATE EDIT CONTROL COMPLETED */                        19950002
*/*LODEXPHZ: P POINT TO PATH DESCRIPTOR FOR EXECUTE PHASE OF EDIT */    19980002
*/* L AMDPRSEG: LOAD AMDPRXED */                                        20010002
*/* L AMDPRXED: EXECUTE PORTION OF EDIT */                              20040002
*/* M (,MAP1) INDICATE EDIT CONTROL COMPLETED */                        20070002
*/*PRINT: D (NO,SYNTAXB,YES,) DELIMITER A BLANK */                      20130002
*/* P CALC SIZE OF REMAINDER OF BUFFER */                               20160002
*/* D (YES,SYNTAX,NO,) SIZE NOT POSITIVE */                             20190002
*/* P DECREMENT SIZE BY 1 FOR EX INSTR */                               20220002
*/* P POINT TO END OF VERB */                                           20250002
*/* P ZERO DELIMITER */                                                 20280002
*/* D (NO,SYNTAXD,YES,) SOME PARAMETER IN REMAINDER OF BUFFER */        20310002
*/* P SAVE @ OF PARAMETER */                                            20340002
*/* P STORE @ OF LIST OF SYNTAX ERROR MSG. */                           20370002
*/*PRINT1: D (NO,SYNTAXA,YES,) DELIMITER IN NEXT 9 CHAR */              20400002
*/* P SET RETURN TO MAP4 */                                             20430002
*/* P LOAD ADDRESS OF SYNTAX MSG RTN. */                                20460002
*/* P SAVE @ OF DELIMITER */                                            20490002
*/* P SAVE DELIMITER CODE */                                            20520002
*/* D (NO,SYNTAXB,YES,) DELIMITER BLANK */                              20550002
*/* P CALC LENGTH OF KEYWORD */                                         20580002
*/* D (YES,SYNTAX,NO,) LENGTH NOT POSITIVE */                           20610002
*/* P DECREMENT LENGTH BY 1 FOR EX INSTR */                             20640002
*/* D (STOR,STORAGE,NUC,NUCLEUS,JOBN,JOBNAME,CURR,CURNT,                20670002
*/*REAL,REAL,SQA,NUCLEUS,CSA,NUCLEUS,,SYNTAXC) CHECK KEYWORD VIA EX     20700002
*/*INSTR */                                                             20730002
*/*REAL: M (,REALSTOR) INDICATE PRINT REAL REQUEST */                   20760002
*/*STORAGE: M INDICATE ABSOLUTE STORAGE REQUEST */                      20790002
*/*REALSTOR: P SET PATH DESCRIPTOR FOR PMS MODULE */                    20820002
*/* P POINT TO PATH DESCRIPTOR */                                       20850002
*/* L AMDPRSEG: LOAD AMDPRPMS PATH */                                   20880002
*/* L AMDPRPMS: ENQ REQUESTED STORAGE ON PCB QUEUE */                   20910002
*/* D (NO,MORETEST,YES,MAP1) ERROR OCCURRED */                          20940002
*/*NUCLEUS: D (YES,MORETEST,NO,) IN FLUSH MODE */                       20990002
*/* P SET PATH DESCRIPTOR FOR NUC MODULE */                             21210002
*/* D (NO,,YES,NUCPATH) ERROR OCCURRED */                               21240002
*/* S DELTEST: CHECK FOR VALID DELIMITER */                             21270002
*/* P POINT TO PATH DESCRIPTOR */                                       21300002
*/*NUCPATH: L AMDPRSEG: LOAD AMDPRNUC PATH */                           21330002
*/* L AMDPRNUC: ENQUEUE NUCLEUS & HIGH PREFIX FOR PRINTING */           21360002
*/* D (NO,MORETEST,YES,MAP1) ERROR OCCURRED */                          21390002
*/*JOBNAME: P POINT TO PJB PATH DESCRIPTOR */                           21540002
*/* L AMDPRSEG: LOAD AMDPRPJB PATH */                                   21570002
*/* L (,MORETEST) AMDPRPJB: BUILD TABLE FOR JOBNAMES */                 21600002
*/*CURNT: D (YES,MORETEST,NO,) IN FLUSH MODE */                         21650002
*/* P SET PATH DESCRIPTOR FOR PCR MODULE */                             21780002
*/* S DELTEST: CHECK FOR VALID DELIMITER */                             21810002
*/* P POINT TO PCR PATH DESCRIPTOR */                                   21840002
*/* L AMDPRSEG: LOAD AMDPRPCR PATH */                                   21870002
*/*  L AMDPRPCR: PLACE @ OF CURRENT TCB IN TCBLIST */                   21900002
*/*MORETEST: P SET UP FOR SYNTAX WRITER */                              21930002
*/* D (NO,MAP1,YES,) DELIMITER A COMMA */                               21960002
*/* P (,PRINT1) STORE @ OF BEGINNING OF NEXT PARM */                    21990002
*/*DELTEST: E DELIMITER CHECK */                                        22020002
*/* D (NO,,YES,%DELRET) DELIMITER A COMMA */                            22050002
*/* D (NO,SYNTAXB,YES,) DELIMITER A BLANK */                            22080002
*/*%DELRET: R RETURN TO CALLER */                                       22110002
*/*ONGO: D (NO,SYNTAXB,YES,) DELIMITER A BLANK */                       22170002
*/* P SET INCREMENTAL VALUE TO -1 */                                    22200002
*/* P POINT TO CHAR AFTER VERB */                                       22230002
*/* P POINT TO SCAN CHAR AT END OF BUFFER */                            22260002
*/*ONGOLP1: D (NO,ONGO1,YES,) SCAN CHAR A BLANK */                      22290002
*/* D (NO,ONGOLP1,YES,ONGORST) ENTIRE BUFFER TESTED */                  22320002
*/*ONGORST: D (NO,MAP4,YES,) WAS THERE PREVIOUS ONGO VERB */            22350002
*/* S OPRFREE: FREE STORAGE USED */                                     22380002
*/* P (,MAP4) SET DEFAULT ONGO VALUES */                                22410002
*/*ONGO1: P CALC LENGTH OF OPERAND */                                   22440002
*/* P INCREASE LENGTH BY 16 FOR WTO */                                  22470002
*/* P SAVE LENGTH FOR WTO (R3) */                                       22500002
*/* D (NO,ONGO2,YES,) WAS THERE PREV. ONGO OPERAND */                   22530002
*/* S OPRFREE: FREE STORAGE OF PREV. OPERAND */                         22560002
*/*ONGO2: L GETMAIN: GET STORAGE AREA FOR OPERAND */                    22590002
*/* P SAVE @ OF THIS AREA (R1) */                                       22620002
*/* P DECREMENT LENGTH OF AREA BY 4 */                                  22650002
*/* P STORE LENGTH OF AREA IN AREA */                                   22680002
*/* P ZERO 2ND HALFWORD OF AREA */                                      22710002
*/* M INDICATE MULTIPLE CONSOLE SUPPORT */                              22740002
*/* P BLANK OUT MESSAGE ID */                                           22770002
*/* P POINT TO OPERAND */                                               22800002
*/* P DECREMENT LENGTH BY 8 TO LENGTH OF OPERAND */                     22830002
*/* P DECREMENT LENGTH BY 1 FOR EX INSTR */                             22860002
*/* P MOVE OPERAND TO BUFFER VIA EX INSTR */                            22890002
*/* P POINT TO END OF OPERAND */                                        22920002
*/* P (,MAP4) PUT DESCRIPTOR CODE & ROUTING CODE AT END OF OPERAND */   22950002
*/*OPRFREE: P CALC LENGTH OF OPERAND INCLUDING DESC & ROUTCDE */        22980002
*/* S FREEMAIN: FREE THAT STORAGE */                                    23010002
*/* P ZERO @ OF ONGO VERB */                                            23040002
*/* R RETURN VIA R9 */                                                  23070002
*/*GO: D (NO,SYNTAXB,YES,) DELIMITER A BLANK */                         23130002
*/* D (YES,GOONGOS,NO,) GO ALREADY SPECIFIED */                         23160002
*/* M INDICATE GO SPECIFIED */                                          23190002
*/* P POINT TO ONGO OPERAND */                                          23220002
*/*GOONGO: P BLANK WTOR BUFFER */                                       23250002
*/* P LOAD LENGTH OF OPERAND AREA */                                    23280002
*/* P DECREMENT LENGTH BY 13 FOR EX & TO INCLUDE ID & OPERAND ONLY */   23310002
*/* P POINT TO ID & OPERAND */                                          23340002
*/* P MOVE ID & OPERAND TO WTOR BUFFER VIA EX INSTR */                  23370002
*/* L BRPRTMSG: PRINT MSG LABELING GO FUNCTIONS */                      23400002
*/* P LOAD LENGTH OF ONGO OPERANDS */                                   23430002
*/* P POINT TO ONGO OPERANDS */                                         23460002
*/* L BRPRTMSG: PRINT ONGO OPERANDS */                                  23490002
*/* D (YES,VERBSCN5,NO,) CONTROL CARDS OFF SYSIN */                     23520002
*/*GOONGOWT: I WTO: "AMD163I GO FUNCTIONS TO BE PERFORMED" */           23550002
*/*  I (,VERBSCN5) WTO: WRITE ONGO OPERANDS */                          23580002
*/*GOONGOS: P (,SYNTAXA) STORE @ OF GO SYNTAX ERROR POINTER */          23610002
*/*CVTSET: D (NO,SYNTAXB,YES,) DELIMITER AN EQUAL SIGN */               23670002
*/* P SET CVT ERROR MSG. @ */                                           23700002
*/* P POINT TO BEGINNING OF CVT PARAMETER VALUE */                      23730002
*/* P STORE @ OF BEGINNING CVT PARAMETER VALUE */                       23760002
*/* P CLEAR DELIMITER */                                                23790002
*/* P SCAN NEXT 9 CHAR FOR DELIMITER */                                 23820002
*/* P POINT TO CVT DELIMITER */                                         23850002
*/* D (COMA,CVTSET0,BLNK,CVTSET0,OTHR,SYNTAXB) TEST DELIMITER */        23880002
*/*CVTSET0: P SAVE DELIMITER CODE */                                    23910002
*/* P CALC LENGTH OF VALUE */                                           23940002
*/* D (YES,SYNTAXA,NO,) LENGTH ZERO */                                  23970002
*/* D (YES,SYNTAXA,NO,) LENGTH GT 6 */                                  24000002
*/* D (NO,CVTSET1,YES,) LENGTH = 1 */                                   24030002
*/*CVTSETA: D (NO,CVTSET1,YES,) VALUE = "P" */                          24060002
*/* P (,CVTSET2) LOAD @ CVT OF PRESENT SYSTEM */                        24090002
*/*CVTSET1: P SAVE LENGTH OF VALUE (R2) */                              24120002
*/*CHECKCVT: D (YES,CVTOK,NO,) DIGIT OF VALUE HAVE F ZONE */            24150002
*/* D (NO,SYNTAXA,YES,) DIGIT OF VALUE A THRU F */                      24180002
*/*CVTOK: P POINT TO NEXT DIGIT OF VALUE */                             24210002
*/* P DECREMENT LENGTH BY 1 */                                          24240002
*/* D (NO,CHECKCVT,YES,) ENTIRE LENGTH CHECKED */                       24270002
*/* P POINT TO VALUE */                                                 24300002
*/* P RESTORE LENGTH OF VALUE */                                        24330002
*/* P TRANSLATE VALUE TO HEX WITH "F" ZONES */                          24360002
*/* P PACK VALUE INTO WORK AREA */                                      24390002
*/* P ELIMINATE SIGN IN PACKED VALUE */                                 24420002
*/* P LOAD @ OF PACKED VALUE OF CVT */                                  24450002
*/*CVTSET2: P STORE @ OF CVT */                                         24480002
*/* M INDICATE CVT @ SET CVT CONTROL STATEMENT */                       24510002
*/*CVTSET3: M RESET MASTER SWITCH FOR MST RE-INIT */                    24570002
*/* P (,MAP2) LOAD DELIMITER CODE */                                    24630002
*/*SEGTBSET: D (NO,SYNTAXB,YES,) DELIMITER AN EQUAL SIGN */             24730002
*/* P SET SEGTAB ERROR MSG. @ */                                        24780002
*/* P POINT TO BEGINNING OF SEGTAB PARAMETER VALUE */                   24830002
*/* P STORE @ OF BEGINNING SEGTAB PARAMETER VALUE */                    24880002
*/* P CLEAR DELIMITER */                                                24930002
*/* P SCAN NEXT 9 CHAR FOR DELIMITER */                                 24980002
*/* P POINT TO SEGTAB DELIMITER */                                      25030002
*/* D (COMA,SEGSET0,BLNK,SEGSET0,OTHR,SYNTAXB) TEST DELIMITER */        25080002
*/*SEGSET0: P SAVE DELIMITER CODE */                                    25130002
*/* P CALC LENGTH OF VALUE */                                           25180002
*/* D (YES,SYNTAXA,NO,) LENGTH ZERO */                                  25190002
*/* D (YES,SYNTAXA,NO,) LENGTH GT 6 */                                  25200002
*/*SEGSET1: P SAVE LENGTH OF VALUE (R2) */                              25210002
*/*CHECKSEG: D (YES,SEGOK,NO,) DIGIT OF VALUE HAVE F ZONE */            25220002
*/* D (NO,SYNTAXA,YES,) DIGIT OF VALUE A THRU F */                      25222002
*/*SEGOK: P POINT TO NEXT DIGIT OF VALUE */                             25224002
*/* P DECREMENT LENGTH BY 1 */                                          25226002
*/* D (NO,CHECKSEG,YES,) ENTIRE LENGTH CHECKED */                       25228002
*/* P POINT TO VALUE */                                                 25228402
*/* P RESTORE LENGTH OF VALUE */                                        25228802
*/* P TRANSLATE VALUE TO HEX WITH "F" ZONES */                          25229202
*/* P PACK VALUE INTO WORK AREA */                                      25229602
*/* P ELIMINATE SIGN IN PACKED VALUE */                                 25229702
*/* P LOAD @ OF PACKED VALUE OF SEGTAB */                               25229802
*/*SEGSET2: P STORE @ OF SEGTAB */                                      25229902
*/* P INDICATE PAGE SIZE */                                             25239902
*/* M INDICATE SEGTAB @ SET BY CONTROL STATEMENT */                     25249902
*/*SEGSET3: M RESET MASTER SWITCH FOR MST RE-INIT */                    25255202
*/* P (,MAP2) LOAD DELIMITER CODE */                                    25256002
*/*ERRMSG: P RESTORE CALLER'S REG. */                                   25256702
*/*NOT2: D (NO,NOPREFMT,YES,) IS DUMP PRE-FORMATTED */                  25290002
*/* M RESET DUMP PRE-FORMATTED SWITCH */                                25320002
*/* L BRPRTMSG: AMD164I TAPE IS PRE-FORMATTED DUMP MSG */               25350002
*/*TSTRDR: D (YES,ERRMSGC3,NO,) CONTROL CARDS FROM READER */            25410002
*/* I (,ERRMSGC3) WTO: AMD164I TAPE IS PRE-FORMATTED DUMP MSG */        25440002
*/*NOPREFMT: D (NO,NOPOSIT,YES,) I/O ERROR */                           25470002
*/* P (,ERRMSGC) MOVE I/O ERROR MSG TO WTO AREA */                      25500002
*/*NOPOSIT: D (NO,ERRMSGA,YES,) DATA POSITIONING IN PROGRESS */         25530002
*/*ORIGTAPE: P MOVE DDNAME INTO AMD168I MSG */                          25680002
*/* L BRPRTMSG: WRITE AMD168I "DUMP DS EMPTY" MSG */                    25710002
*/* P (,TSTRDR) POINT TO WTO MSG LIST */                                25740002
*/*ERRMSGA: D (NO,ERRMSGC3,YES,) FORMATTING ERROR */                    25950002
*/* P (,ERRMSGC) MOVE FORMAT ERROR MSG TO WTO LIST */                   25980002
*/*ERRMSGC: L BRPRTMSG: PRINT MESSAGE */                                26250002
*/*ERRMSGC3: D (NO,ERRSELEC,YES,) PROCESSING END CARD */                26370002
*/* P POINT TO EXIT ROUTINE (AMDPRXIT) */                               26400002
*/* P SET TERMINATION CODE TO 4 FOR EXIT ROUTINE */                     26430002
*/* L AMDPRXIT: TERMINATION - EXECUTION IMPOSSIBLE */                   26460002
*/* N (,AMDPRXIT) NO RETURN FROM AMDPRXIT EXPECTED */                   26490002
*/*ERRSELEC: M RESET I/O & FORMAT ERROR SWITCHES */                     26550002
*/* D (NO,INITOK,YES,) BLOW-UP IN GET MASTER */                         26580002
*/* M INDICATE READ INIT. TO BE SUPPRESSED */                           26610002
*/* P RESTORE MAX @ */                                                  26640002
*/* P RESTORE TOP-OF-REAL VALUE */                                      26670002
*/*INITOK: P LOAD R1 WITH VERBGN */                                     26730002
*/* D (YES,MAP3,NO,) IS VERB = E, */                                    26738002
*/* D (YES,MAP3,NO,) IS VERB = EDIT, */                                 26746002
*/* D (YES,MAP4,NO,) IS VERB = E */                                     26754002
*/* D (YES,MAP4,NO,) IS VERB = EDIT */                                  26762002
*/* P LOAD R1 WITH KYWDBGN */                                           26770002
*/* D (YES,PRINT1,NO,) IS KYWDBGN = 0 */                                26780002
*/* P (,CK4PRST) LOAD R1 WITH VERBGN */                                 26782002
*/*STOPCMP: P RESTORE MSC'S REG. */                                     26790002
*/* P INDICATE ALL TCB'S REMOVED */                                     26820002
*/* L AMDPRTSV: REMOVE TCB'S */                                         26850002
*/* N (,MAP2) CONTINUE SCAN */                                          26880002
*/*AMDPRXIT: E ENTER */                                                 26910002
*/*EREXIT: P SAVE CALLER'S REG. & CHAIN SAVE AREAS */                   26940002
*/* P SAVE DDNAME CODE (R7) */                                          26970002
*/* D (0,EROPN,4,TERM,8,TERM,12,ERIO) BRANCH ON ACTION REQUIRED CODE */ 27000002
*/*EROPN: P POINT TO "FILE CAN NOT BE OPENED" MSG */                    27030002
*/* P POINT TO DDNAME */                                                27060002
*/* P (,ERWTO) MOVE DDNAME TO MSG */                                    27090002
*/*ERIO: P POINT TO PERMANENT I/O ERROR MSG */                          27120002
*/* D (YES,ERIOTAPE,NO,) VAR. INPUT DDNAME (CODE = 12) */               27150002
*/* P LOCATE DDNAME IN TABLE */                                         27180002
*/* P (,ERWTO) MOVE DDNAME TO MSG */                                    27210002
*/*ERIOTAPE: P MOVE DDNAME FROM COMMON TO MSG */                        27240002
*/*ERWTO: I WTO: WRITE ERROR MESSAGE */                                 27270002
*/*TERM: P LOAD @ OF DCB POINTERS LIST */                               27300002
*/*ENDLOOP2: P POINT TO DCB @ */                                        27330002
*/* D (YES,ENDLOOP1,NO,) @ ZERO */                                      27360002
*/* D (NO,ENDLOOP3,YES,) DCB OPEN */                                    27390002
*/* L CLOSE: CLOSE DCB */                                               27420002
*/*ENDLOOP3: D (NO,ENDLOOP1,YES,) BUFFER POOL CONTROL BLOCK */          27450002
*/* L FREEPOOL: FREE BUFFER POOL */                                     27480002
*/*ENDLOOP1: D (YES,END1,NO,) LAST DCB */                               27510002
*/* P (,ENDLOOP2) STEP TO NEXT DCB */                                   27540002
*/*END1: P LOAD OUTPUT BUFFER @ */                                      27570002
*/* D (YES,END2,NO,) @ ZERO */                                          27600002
*/* L FREEMAIN: FREE BUFFER */                                          27630002
*/* P ZERO BUFFER POINTER */                                            27660002
*/*END2: L BRREAD: RELEASE BUFFER SPACE */                              27690002
*/* L AMDPRUIM: PERFORM USER INTERFACE CLEAN-UP */                      27740002
*/*END3: P POINT TO ONGO OPERAND */                                     27870002
*/* D (NO,END7A,YES,) ANY OPERANDS */                                   27900002
*/* P LOAD LENGTH OF ONGO AREA */                                       27930002
*/* L FREEMAIN: FREE ONGO AREA */                                       27960002
*/*END7A: P ZERO ONGO OPERAND POINTER */                                27990002
*/*END5: M RESET SWA, SWB, SWC, SWD, SWE, PRSW, LOADSW */               28020002
*/* P RESTORE MAX @ */                                                  28050002
*/* P ZERO PAGE NUMBER */                                               28080002
*/* P RESTORE TOP-OF-REAL VALUE */                                      28110002
*/* P RESTORE DEFAULT LINE COUNT */                                     28170002
*/* P STORE LINE COUNT DEFAULT -2 */                                    28200002
*/*ENDALL: P RESTORE CALLER'S SAVE AREA PTR */                          28290002
*/*EXIT: P RESTORE REG. FROM LAST SAVE AREA */                          28350002
*/* R RETURN */                                                         28380002
*/*AMDPREND: E ENTER */                                                 28410002
*/* P SAVE CALLER'S REG. & CHAIN SAVE AREAS */                          28440002
*/*END: M INDICATE END */                                               28470002
*/* D (NO,ENDSTATO,YES,) SYSUT2 LOAD REQUIRED */                        28500002
*/* M SET SWITCH TO BYPASS AMDPRMST */                                  28530002
*/* L BRREAD: LOAD DUMP DS INTO WORK FILE */                            28560002
*/*ENDSTATO: L BRPRTMSG: SPACE 2 LINES */                               28590002
*/* P CONVERT TO DEC. VALUE GIVING # OF REQ. READS */                   28620002
*/* P MOVE # OF REQ. READS TO MSG. 1 AREA */                            28650002
*/* L BRPRTMSG: PRINT MSG 1 GIVING # READ RTN ENTRIES */                28680002
*/* P CONVERT TO DEC VALUE GIVING # OF TIMES REQ. @ NOT IN BUFFER */    28710002
*/* P MOVE VALUE TO MSG 2 AREA */                                       28740002
*/* L BRPRTMSG: PRINT MSG 2 - # OF TIMES REQ @ NOT IN BUFFER */         28770002
*/* D (NO,ENDSTAT1,YES,) NO OF ENTRIES TO READ ROUTINE ZERO */          28800002
*/*ENDSTAT3: P (,ENDSTAT2) ZERO DIVIDEND FOR RATIO */                   28830002
*/*ENDSTAT4: P (,ENDSTAT2) SET DIVIDEND TO 1 FOR RATIO */               28860002
*/*ENDSTAT5: P (,ENDSTAT2) SET DIVIDEND TO 999 FOR RATIO */             28890002
*/*ENDSTAT1: D (EQ,ENDSTAT4,LOW,ENDSTAT3,HIGH,) COMPARE # OF READS      28920002
*/*TO # OF TIMES @ NOT IN BUF */                                        28950002
*/* D (ZERO,ENDSTAT5,NZ,) NO. OF TIMES @ NOT IN BUFFER */               28980002
*/* P DIVIDE # OF ENTRIES BY # OF REQ. READS */                         29010002
*/* P SAVE RESULTING RATIO (R5) */                                      29040002
*/*ENDSTAT2: P CONVERT # OF BLOCKS READ TO DEC. */                      29070002
*/* P MOVE # OF BLOCKS READ TO MSG 3 */                                 29100002
*/* L BRPRTMSG: PRINT MSG 3 GIVING # OF BLOCKS READ */                  29130002
*/* P CONVERT # OF PERM. I/O ERRORS TO DEC. */                          29160002
*/* P MOVE VALUE GIVING # OF PERM. I/O ERRORS TO MSG 4 */               29190002
*/* L BRPRTMSG: WRITE MSG 4 GIVING # OF PERM. I/O ERRORS */             29220002
*/* D (ZERO,ENDSTAT6,NZ,) COUNT OF BUFFER INIT'S */                     29250002
*/* P DIVIDE TOTAL # OF BUFFERS BY COUNT OF INITIALIZATIONS */          29280002
*/*ENDSTAT6: P CONVERT RESUTLING QUOTIENT TO DEC. */                    29310002
*/* P MOVE RATIO TO MSG 6 */                                            29340002
*/* D (YES,ENDSTAT7,NO,) REMAINDER OF DIVIDE ZERO */                    29370002
*/* P MULTIPLY REMAINDER BY 100 */                                      29400002
*/* P DIVIDE TO OBTAIN FRACTIONAL PART */                               29430002
*/*ENDSTAT7: P CONVERT FRACTION TO TWO DECIMAL DIGITS */                29460002
*/* P MOVE CONBINED RATIO TO MSG 6 */                                   29490002
*/* L BRPRTMSG: WRITE MSG 6 GIVING AVG # OF BUFFERS PER FN */           29520002
*/* L BRPRTMSG: SPACE A LINE */                                         29550002
*/* P CONVERT RATIO OF # OF ENTRIES TO # OF REQ. READS TO DEC */        29580002
*/* P MOVE RATIO TO MSG 5 */                                            29610002
*/* L BRPRTMSG: PRINT MSG 5 OF RATIO OF ITEM 1 TO ITEM 2 */             29640002
*/* P CONVERT # OF TRACE RECORDS PROCESSED TO DEC */                    29670002
*/* L BRPRTMSG: SPACE A LINE */                                         29700002
*/* L BRPRTMSG: PRINT MSG 7 GIVING # OF TRACE RECORDS */                29730002
*/*EXITOUT: P LOAD TERMINATION CODE OF 4 */                             29760002
*/* L () AMDPRXIT: TERMINATE */                                         29790002
*/*AMDPRCTL: END */                                                     29820002
*********************************************************************** 29850002
*                                                                     * 29880002
**                      ****   B E G I N   ****                      ** 29910002
*                                                                     * 29940002
*********************************************************************** 29970002
         SPACE                                                          30000002
         EQUATES                                                        30030002
         COMMON                                                         30060002
DCBOFLGS EQU   48                                                       30090002
CVTPTR   EQU   76                                                       30120002
PARMER   EQU   128                 INVALID EXEC CARD PARM               30150002
AMDPRCTL CSECT                                                  X01980  30180002
         ENTRY AMDPRDMP                                                 30210002
AMDPRDMP SAVE  (14,12),T,AMDPRDMP-OS/VS2-02.0                    Y02006 30240002
         BALR  BASE1,0             SET UP REG 11 AS BASE                30270002
         USING *,BASE1                                                  30300002
CTLBASE  LA    R2,CTLSAVE          SAVE AREA CHAINING           X01980  30330002
         ST    R13,CTLSAVE+4                                            30360002
         ST    R2,8(R13)                                                30390002
         L     R3,SAVEPTR          STORE R13 IN XIT'S           SA54065 30400002
         ST    R13,0(R3)           SAVE AREA                    SA54065 30410002
         LR    R13,R2                                                   30420002
         SPACE                                                          30450002
         L     COMBASE,COMMADDR    LOAD BASE FOR COMMON                 30480002
         USING COMMON,COMBASE                                           30510002
         USING SYNEPS,R15                                        Y02006 30520002
         SPACE                                                          30540002
         XC    ERRADDR,ERRADDR     ZERO ERROR ROUTINE ADDRESS           30570002
         XC    CVTADDR,CVTADDR     ZERO SET CVT ADDR                    30600002
         NI    I3800SW,XFF-I3800ULN ZERO USER-SPEC-LEN FLAG    @Z40MI3F 30610000
         L     R4,0(R1)            PARAMETER ADDR                       30630002
         LH    R2,0(R4)            PARAMETER LENGTH                     30660002
         LTR   R2,R2               TEST LENGTH                          30690002
         BNP   BEGIN6              ZERO OR NEG BR                       30720002
         SR    R5,R5               ZERO CNT REG                         30750002
         LA    R4,2(R4)            ADDR OF BEGINNING OF PARM            30780002
         LR    R6,R4               PLACE ADDR IN R6                     30810002
BGNLOOP  CLI   0(R6),C','          LOOK FOR COMMA                       30840002
         BE    BEGIN1              FOUND ONE                            30870002
         AH    R5,ONEA             INCREMENT COUNT                      30900002
BEGIN2   AH    R6,ONEA             INCREMENT ADDRESS                    30930002
         BCT   R2,BGNLOOP          LOOP FOR ORIGINAL CNT IN R2          30960002
         SPACE                                                          30990002
BEGIN1   CH    R5,ONEA             COMPARE LENGTH TO ONE                31020002
         BL    BEGINER             BR IF LT ONE                         31050002
         BE    BEGIN5              BR IF EQ--DEFAULT PARAMETER   Y02006 31080002
         CH    R5,EIGHT            COMPARE LN TO 8               S21014 31110002
         BH    BEGLCNT             GT 8--PROBABLY LINE COUNT            31140002
         CH    R5,FOUR             COMPARE TO FOUR               S21014 31170002
         BE    BEGER               GO TEST FOR EDIT ER= PARM     S21014 31230002
BEGIN5   BCTR  R5,0                DECR CNT FOR EXECUTE                 31260002
         LA    R3,TITLE                                                 31290002
         EX    R5,COMPARE1         DOES PARM EQ 'TITLE'                 31320002
         BE    BEGTITLE            YES--SET TITLESW                     31350002
         LA    R3,STOP                                                  31380002
         EX    R5,COMPARE1         DOES PARM EQ 'STOP'                  31410002
         BNE   BEGINER             NO--LOOK AT NEXT PARM         XM5100 31470002
         SPACE                                                          31500002
*** STOP OPTION WAS REQUESTED ***                                XM5100 31550002
         OI    SWE,STOPSW          SET SW TO ALLOW OPERATOR TO STOP     31680002
*                                  DUMP                                 31710002
         B     BEGIN3              CONTINUE                             31740002
BEGTITLE OI    SWE,TITLESW         SET SW TO FORCE OPERATOR TO ENTER    31770002
*                                  DUMP NUMBER FOR TITLE                31800002
         B     BEGIN3              CONTINUE                             31830002
         SPACE                                                          31860002
BEGLCNT  CLC   LNCNTP(8),0(R4)     TEST FOR 'LINECNT'            S21014 31890002
         BNE   BEGINER             NO--LOOK AT NEXT PARM                31920002
         SH    R5,EIGHT            GET LN OF LINECNT VAL                31950002
         LA    R8,8(R4)            ADDR OF LINE CNT NO                  31980002
         BAL   R9,BEGFREE2         GO GET LINE COUNT VALUE IN HEX       32010002
         CH    R8,HTEN             COMPARE SPECIFIED LINECNT TO 10      32040002
         BNH   BEGINER             DON'T SET LINECNT IF IT IS LT 10     32070002
         CH    R8,LNCNTMAX         COMPARE LINECNT TO MAXIMUM  @ZA27117 32080000
         BH    BEGINER             DONT SET LINECNT IF > MAX   @ZA27117 32090000
         STH   R8,LINENUMB         STORE NUMBER OF LINES PER PAGE       32100002
 ST R8,LINECNT RESET LINE COUNT                                         32110000
         SH    R8,TWO              SUBTRACT 2 FOR LINECNT-2             32130002
         STH   R8,LINENUM          STORE LINECNT-2 VALUE                32160002
         OI    I3800SW,I3800ULN    SET USER-SPEC-LEN FLAG      @Z40MI3F 32170000
         B     BEGIN3              CONTINUE WITH NEXT PARM              32190002
LNCNTMAX DC    H'32767'            LINE COUNT MAXIMUM VALUE    @ZA27117 32200000
         SPACE                                                          32220002
***  CONVERT VALUE TO BINARY  ***                                S21014 32850002
BEGFREE2 LR    R0,R8               SAVE R8 IN R0  (ADDR OF VALUE)       32880002
         LR    R7,R5               LOAD LENGTH TO R7 AND TEST IT S21014 32910002
*                                  LENGTH MUST BE POITIVE TO     S21014 32940002
*                                  GET THIS FAR                  S21014 32970002
BEGFREE1 TM    0(R8),X'F0'         TEST ZONE FOR 'F'                    33000002
         BNO   BEGINER             IGNORE IF NOT                        33030002
         LA    R8,1(R8)            STEP TO NEXT                         33060002
         BCT   R7,BEGFREE1         LOOP FOR LENGTH                      33090002
         BCTR  R5,0                DECR FOR EXECUTE                     33120002
         LR    R8,R0               RESTORE ADDR OF VALUE TO R8 FOR PACK 33150002
         EX    R5,BUFPACK          PACK BUFNO TO WORK1                  33180002
         CVB   R8,WORK1            CONVERT TO BINARY INTO R8            33210002
         BR    R9                  BR ON PRE-LOADED R9 - RETURN TO      33240002
*                                  CALLER                               33270002
BEGER    CLC   EDITPARM(3),0(R4)   TEST FOR EDIT ERROR PARM      S21014 33480002
         BNE   BEGIN5              BRANCH IF NOT TO CONTINUE     S21014 33510002
*                                  TESTING FOR ADDITIONAL PARMS  S21014 33540002
         LA    R4,3(R4)            POINT TO PARM VALUE           S21014 33570002
         TM    0(R4),X'F0'         TEST FOR NUMERIC VALUE        S21014 33600002
         BNO   BEGINER             IF NOT, BRANCH TO GIVE ERROR  S21014 33630002
*                                  MESSAGE                       S21014 33660002
         CLI   0(R4),C'3'          COMPARE TO MAXIMUM VALUE      S21014 33690002
         BH    BEGINER             VALUE TO BIG - GIVE ERROR MSG S21014 33720002
         MVC   EDITER(1),0(R4)     MOVE TO COMMON FOR LATTER USE S21014 33750002
*                                  BY EDIT                       S21014 33780002
         NI    EDITER,X'0F'        CLEAR ZONE                    S21014 33810002
         SPACE                                                          33840002
***  CONTINUE SCAN  ***                                                 33870002
BEGIN3   LTR   R2,R2               IS ORIGINAL COUNT ZERO               33900002
         BZ    BEGIN6              YES--DONE                            33930002
         SR    R5,R5               ZERO COUNT                           33960002
         LA    R4,1(R6)            NEW STARTING ADDR TO R4              33990002
         B     BEGIN2              LOOK FOR NEXT PARM                   34020002
         SPACE                                                          34050002
BEGINER  TM    CTLSW,PARMER        HAS MESSAGE BEEN GIVEN               34080002
         BO    BEGIN3              BRANCH AROUND MESSAGE IF YES  X01980 34110002
         OI    CTLSW,PARMER        INDICATE MESSAGE ISSUED       X01980 34140002
         LR    R5,R2               SAVE REG 2 VALUE AROUND MACRO        34170002
         BRPRTMSG  INVPARM,L'INVPARM                                    34200002
         LR    R2,R5               RESTORE REG 2                        34230002
         B     BEGIN3              LOOK AT NEXT PARM                    34260002
          SPACE                                                         34290002
BEGIN6   EQU   *                                                 Y02006 34340002
         MVC   ONGOPTR,AUTONGO1    MOVE IN AUTO ONGO PTR         Y02006 34350002
         GETMAIN  VC,LA=REQUEST,A=GETSTG  GET ALL AVAILABLE STORAGE     34390002
*                                                                Y02006 34440002
         LTR   R15,R15             WAS AT LEAST 64K THERE        Y02006 34450002
         BZ    STOROKAY            YES, GO FREE IT               Y02006 34460002
*   THE STORAGE AREA FOR THE AMDPRDMP PROGRAM IS LESS THAN 128K.        34462002
*   PRINT MESSAGE AND TERMINATE PRDMP.                                  34464002
STORERR  L     R15,STORMSG         ADDRESS OF ERROR MESSAGE      Y02006 34466002
         ST    R15,SYNMSGA         STORE IN COMMON               Y02006 34468002
         OI    SWD,NOSTDMG         INDICATE MSG 165I NOT NEEDED  Y02006 34468402
         L     R15,ASYNTAX         POINT TO MSG WRITER           Y02006 34468802
         BAL   R14,SYNTAXA         WRITE MESSAGE AMD151I         Y02006 34469202
         LA    R1,4                LOAD TERMINATION CODE         Y02006 34469602
         L     R15,AEREXIT         POINT TO TERMINATION ROUTINE  Y02006 34469702
         BALR  R14,R15             LINK TO IT(NO RETURN EXPECTED)Y02006 34469802
         SPACE 1                                                        34469902
*   THERE IS ENOUGH STORAGE AVAILABLE FOR PRDMP TO PROCESS, SO CONTINUE 34479902
STOROKAY MVC   STORSIZE,AVAILSTG   SAVE STORAGE SIZE IN COMMON   Y02006 34489902
         FREEMAIN  V,A=GETSTG      FREE ALL GOTTEN STORAGE       Y02006 34493202
         SPACE 1                                                        34495202
         OI    SWE,BUILDMAP        DUMP DS MUST BE SCANNED       Y02006 34496702
*                                  AND MAPPED                    X01980 34500002
         OI    SWC,POSITSW         INPUT DATA POSITIONING IS REQUIRED   34530002
         BRWRITE 0                 OPEN OUTDCB FIRST THING TO PREVENT   34590002
*                                  AN 80A ABEND AFTER CORE IS GOTTEN    34620002
*                                  FOR INPUT BUFFERS                    34650002
         OPEN  RDRDCB              TRY TO OPEN RDRDCB                   34770002
         TM    RDRDCB+DCBOFLGS,DCBOPEN DID IT OPEN                      34800002
         BZ    BEGIN7              NO--SYSIN DD CARD NOT THERE          34830002
         LA    R2,RDRDCB           GET ADDR READER DCB            M0732 34860002
         ST    R2,ARDRDCB          STORE IN COMMON CSECT          M0732 34890002
         OI    SWA,RDRSW           YES - INDICATE READING CONTROL CARDS 34920002
         B     CALLUIMI            CONTINUE                      Y02006 34950002
BEGIN7   NI    SWA,XFF-RDRSW       RESET READER SWITCH - NOT READING    34980002
*                                  SYSIN                                35010002
CALLUIMI L     R15,AUSRINIT        GET ADDR OF USER INTERFACE    Y02006 35020002
*                                  INITIALIZATION ROUTINE        Y02006 35030002
         BALR  RETREG,R15          LINK TO IT                    Y02006 35032002
         EJECT                                                          35040002
*********************************************************************** 35070002
*                                                                     * 35100002
**                     ***  GET DUMP NUMBER  ***                     ** 35130002
*                                                                     * 35160002
*                                                                     * 35190002
*   IF THE TITLESW IS SET (TITLE CODED AS AN EXEC CARD PARM) THIS     * 35220002
*   ROUTINE WILL ISSUE A WTOR TO ALLOW THE OPERATOR TO ENTER A        * 35250002
*   TITLE WHICH WILL BE PRINTED AS PART OF THE TITLE ON EACH PAGE OF  * 35280002
*   THE OUTPUT LISTING.  THERE ARE ONLY 3 VALID REPLIES....           * 35310002
*                                                                     * 35340002
*        1  A CHARACTER STRING OF UP TO 64 CHARACTERS, WHICH     S21014 35370002
*           WILL BECOME THE DUMP TITLE                           S21014 35400002
*                                                                     * 35430002
*        2  'SAME' - ENTERED EXACTLY AS SHOWN WILL LEAVE THE TITLE    * 35460002
*           AS IS.                                                    * 35490002
*                                                                     * 35520002
*        3  'END' - ENTERED EXACTLY AS SHOWN WILL CAUSE THE PROGRAM   * 35550002
*           TO TERMINATE.                                             * 35580002
*                                                                     * 35610002
*********************************************************************** 35640002
         SPACE                                                          35670002
WRTMSG   DS    0H                                                       35700002
         TM    SWE,TITLESW         IS TITLESW ON                        35730002
         BZ    TRDRSW              NO - DON'T REQUEST TITLE             35760002
DUMPMSG  MVI   WTORMSG,X'40'                                            35790002
         MVC   WTORMSG+1(79),WTORMSG CLEAR BUFFER                       35820002
         LA    R2,WTORMSG          GET ADDR'S OF WTOR REPLY AREA        35850002
         LA    R3,WTORECB          AND WTOR ECB                         35880002
TITLMSG  WTOR  'AMD154D REPLY TITLE , ''SAME'', OR ''END''',     Y01980X35910002
               (R2),64,(R3),ROUTCDE=(1),DESC=2                          35940002
         WAIT  ECB=WTORECB         WAIT FOR REPLY                       35970002
         TR    WTORMSG(80),CAPTABL TRANSLATE TO CAPITALS                36000002
         MVI   WTORECB,0           CLEAR COMPLETION CODE                36030002
         LA    R2,WTORMSG         SET BEGINNING OF INPUT BUFFER OZ09686 36032000
FSTCHR   CLC   0(3,R2),ENDVERB1   END ENTERED                   OZ09686 36034000
         BNE   CHKSAME            NO - LOOK FOR SAME            OZ09686 36036000
         LA    R2,3(R2)           STEP AROUND END FIELD         OZ09686 36038000
         B     CONT               CHECK FOR ADDITIONAL FIELDS   OZ09686 36040000
CHKSAME  CLC   0(5,R2),SAME       SAME ENTERED                  OZ09686 36042000
         BNE   TMTITLE            MUST BE TITLE                 OZ09686 36044000
         LA    R2,4(R2)            STEP AROUND 'SAME'          @OZ19024 36045000
CONT     LA    R3,74              LOOP MAX OF 74                OZ09686 36046000
BLNKLOOP CLI   0(R2),X'40'        LOOK FOR NON BLANK            OZ09686 36048000
         BNE   TMTITLE            NON BLANK MEANS TITLE HERE    OZ09686 36050000
         LA    R2,1(R2)           LOOK AT NEXT FIELD            OZ09686 36052000
         BCT   R3,BLNKLOOP        CHECK NEXT POSITION           OZ09686 36054000
         CLC   WTORMSG(5),SAME     IS REPLY 'SAME'               X01980 36060002
         BE    TRDRSW              YES--LEAVE THE SAME TITLE            36090002
         CLC   WTORMSG(3),ENDVERB1 WAS REPLY 'END'                      36120002
         BNE   TMTITLE            NOT END SO MUST BE TITLE      OZ09686 36125000
         SR    R15,R15                                          OZ09686 36130000
         C     R15,ERRADDR        WAS ERRADDR SET YET           OZ09686 36135000
         BE    CALLSCAN           NO - GO THROUGH NORMAL        OZ09686 36140000
*                                 INITIALIZATION FIRST          OZ09686 36145000
         L     R15,AEND            GET ADDRESS OF END ROUTINE           36150002
         BR    R15                 BRANCH TO END ROUTINE        OZ09686 36180000
***  MUST BE TITLE  ***                                          S21014 36210002
TMTITLE  EQU   *                  BRANCH HERE TO PROCESS TITLE  OZ09686 36220000
         MVC   TITLEMSG(64),WTORMSG  MOVE TITLE                  S21014 36240002
*                                  FUNC. COMPLETE FALL THROUGH   S21014 36270002
*                                  TO GET NEXT CONTROL STATEMENT S21014 36300002
         EJECT                                                          36330002
*********************************************************************** 36360002
*                                                                     * 36390002
**                  ***  GET CONTROL STATEMENT  ***                  ** 36420002
*                                                                     * 36450002
*                                                                     * 36480002
*   THIS ROUTINE WILL EITHER ISSUE A WTOR SO THAT THE OPERATOR MAY    * 36510002
*   ENTER CONTROL STATEMENTS OR BRANCH TO READ CONTROL CARDS FROM     * 36540002
*   THE SYSIN DATA SET.  ONCE A CONTROL STATEMENT IS OBTAINED CSECT   * 36570002
*   AMDPRMSC - MAIN SCAN - IS CALLED TO PROCESS THE STATEMENT.   X01980 36600002
*                                                                     * 36630002
*********************************************************************** 36660002
         SPACE                                                          36690002
TRDRSW   TM    SWA,RDRSW           TEST SOURCE OF CONTROL CARDS         36720002
         BO    RDCARD              ON - READ FROM SYSIN                 36750002
*                                  OFF - ASK OPERATOR                   36780002
WRTMSG1  MVI   WTORMSG,X'40'                                            36810002
         MVC   WTORMSG+1(79),WTORMSG CLEAR BUFFER                       36840002
         LA    R2,WTORMSG          GET ADDR'S OF WTOR AREA              36900002
         LA    R3,WTORECB          AND WTOR ECB                         36930002
         TM    SWD,FLSHMODE        IS FLUSHMODE SWITCH SET       Y02006 36940002
         BO    NEWDMSG             YES - ISSUE NEWDUMP MESSAGE   Y02006 36950002
         TM    SWE,RESPC           RESPECIFY FOR EDIT            X01014 36960002
         BO    RESPMSG             YES - ISSUE RESPECIFY MESSAGE X01014 36990002
         TM    SWD,CONTSW          TEST FOR READING CONTINUATION X01980 37020002
         BO    CONTMSG             IF SO, BRANCH TO ISSUE        S21014 37050002
*                                  MESSAGE AMD199D RATHER THAN   X01980 37080002
*                                  AMD155D                       X01980 37110002
         WTOR  'AMD155D REPLY WITH GO, DESIRED FUNCTION, OR END',      X37140002
               (R2),71,(R3),ROUTCDE=(1),DESC=2                   Y02006 37170002
         B     WTORWAIT            BRANCH TO WAIT FOR REPLY      S21014 37200002
***  REQUEST NEWDUMP OR END  ***                                 Y02006 37210002
NEWDMSG  WTOR  'AMD283D REPLY WITH NEWDUMP OR END',                    X37220002
               (R2),71,(R3),ROUTCDE=(1),DESC=2                   Y02006 37222002
         B     WTORWAIT            BRANCH TO WAIT FOR REPLY      Y02006 37224002
***  REQUEST RESPECIFICATION  ***                                X01014 37230002
RESPMSG  WTOR  'AMD210D RESPECIFY EDIT KEYWORDS OR REPLY ''RUNEDIT''', X37260002
               (R2),71,(R3),ROUTCDE=(1),DESC=2                   Y02006 37290002
         B     WTORWAIT            BRANCH TO WAIT FOR REPLY      X01014 37320002
***  REQUEST CONTINUATION  ***                                   S21014 37350002
CONTMSG  WTOR  'AMD199D  CONTINUE DEFINITION',                         X37380002
               (R2),71,(R3),ROUTCDE=1,DESC=2                     Y02006 37410002
WTORWAIT WAIT  ECB=WTORECB                                              37440002
         MVI   WTORECB,0           CLEAR COMPLETION CODE                37470002
CALLSCAN TR    WTORMSG(80),CAPTABL CONVERT SMALL LETTERS TO CAPS S21014 37500002
         BRPRTMSG WTORMSG,80       PRINT REPLY ON SYSPRINT       S21014 37530002
         SPACE                                                          37560002
         L     R15,ASCAN           GET ADDRESS OF SCAN CSECT     S21014 37590002
         BALR  RETREG,R15          LINK TO SCAN                         37620002
         B     *+4(R15)            BRANCH ON RETURN CODE FROM SCAN      37650002
         B     WRTMSG              BRANCH TO TEST FOR NEW TITLE         37680002
         B     TRDRSW              JUST GET NEW CONTROL CARD            37710002
         EJECT                                                          37740002
*********************************************************************** 37770002
*                                                                     * 37800002
*   READ CONTROL CARDS FROM SYSIN                                     * 37830002
*                                                                     * 37860002
*********************************************************************** 37890002
         SPACE                                                          37920002
RDCARD   GET   RDRDCB,WTORMSG      READ CONTROL CARD INTO WTOR BUFFER   37950002
         B     CALLSCAN            CONTINUE                             37980002
         SPACE 2                                                        38010002
RDRERR   LA    R0,8                LOAD CODE FOR SYSIN DD NAME          38040002
         LA    R1,12               LOAD CODE FOR I/O ERROR MSG          38070002
         L     R15,AEREXIT         EXIT TO WRITE MSG  AND               38100002
         BR    R15                 TERMINATE PROGRAM                    38130002
         SPACE                                                          38160002
RDREOF   BRPRTMSG  RDEOFMSG,57     PRINT END OF FILE MESSAGE            38190002
         NI    SWA,XFF-RDRSW       RESET RDR SWITCH                     38220002
         B     WRTMSG1             GO COMMUNICATE WITH OPERATOR         38250002
         EJECT                                                          38280002
*********************************************************************** 38940002
*                                                                     * 38970002
*   CONSTANTS FOR INIT                                                * 39000002
*                                                                     * 39030002
*********************************************************************** 39060002
         SPACE                                                          39090002
BUFPACK  PACK  WORK1(8),0(0,R8)                                         39120002
COMPARE1 CLC   0(0,R4),0(R3)                                            39150002
WTORECB  DC    F'0'                ECB FOR WTOR'S                Y02006 39160002
         SPACE                                                          39180002
SAVEPTR  DC    A(R13SAVE)          ADDR OF R13 SAVE AREA        SA54065 39190002
COMMADDR DC    V(AMDPRCOM)         ADDRESS OF COMMON CSECT       X01980 39210002
ASCAN    DC    A(AMDPRMSC)         ADDRESS OF SCAN CSECT         X01980 39240002
AUTONGO1 DC    X'80'               INDICATE AUTO ONGO                   39270002
         DC    AL3(AUTOPER)        ADDR OF AUTO OPERANDS                39300002
CTLSAVE  DC    18F'0'              SAVE AREA FOR AMDPRCTL        X01980 39330002
ENDVERB1 DC    C'END'                                                   39360002
SAME     DC    CL5'SAME'                                                39450002
LNCNTP   DC    C'LINECNT='                                       S21014 39480002
EDITPARM DC    C'ER='              EDIT ERROR PARM               S21014 39510002
CTLSW    DC    X'00'                                                    39540002
INVPARM  DC    C'AMD187I INVALID EXEC CARD PARAMETER'            X01980 39570002
RDEOFMSG DC    C'AMD170I END OF FILE ON SYSIN - CONTROL PASSED TO OPERAX39600002
               TOR'                                              X01980 39630002
STORMSG  DC    V(AMDPRP01)         ERROR MESSAGE ADDRESS         Y02006 39640002
REQUEST  DS    0CL8                AREA FOR GETMAIN              Y02006 39650002
MIN      DC    F'65536'                                          Y02006 39652002
MAX      DC    XL4'00FFFFFF'                                     Y02006 39654002
GETSTG   DS    0CL8                AREA FOR GETMAIN/FREEMAIN     Y02006 39656002
         DC    F'0'                                              Y02006 39658002
AVAILSTG DC    F'0'                                              Y02006 39658402
         EJECT                                                          39660002
RDRDCB   DCB   DDNAME=SYSIN,MACRF=(GM),DSORG=PS,                       X39690002
               EODAD=RDREOF,SYNAD=RDRERR,LRECL=80                Y01980 39720002
         EJECT                                                          39750002
*********************************************************************** 39780002
*                                                                     * 39810002
*  CONTROL STATEMENT SCAN ROUTINE                                     * 39840002
*                                                                     * 39870002
*********************************************************************** 39900002
         SPACE                                                          39930002
BLANK    EQU   X'40'                                             Y02006 39940002
AMDPRMSC CSECT                                                   X01980 39960002
         USING *,R15                                             Y02006 39970002
         MODID                                                   Y02006 39980002
         DROP  R15                                               Y02006 39982002
         STM   R14,R12,12(R13)     SAVE INIT'S REGS                     39990002
         BALR  BASE1,0             BASE SCAN ROUTINE                    40020002
         USING *,BASE1                                                  40050002
MSCBASE  LA    R2,MSCSAVE                                               40080002
         ST    R2,8(R13)                                                40110002
         ST    R13,MSCSAVE+4                                            40140002
         LR    R13,R2                                                   40170002
         SPACE                                                          40200002
         USING COMMON,COMBASE      BASE COMMON CSECT                    40230002
         USING SYNEPS,R15                                               40260002
         USING MSCSAVE,R13         BASE DATA AREA                X01980 40270002
         SPACE                                                          40290002
         LA    R2,ERRMSG           GET ADDRESS OF MAJOR ERROR ROUTINE   40320002
         ST    R2,ERRADDR          STORE IT IN COMMON                   40350002
         LA    R15,WRTSYNA         ADDR OF SYNTAX ERROR MSG ADDR Y02006 40360002
         ST    R15,SYNMSGA         STORE IT                      Y02006 40370002
         L     R15,ASYNTAX         GET ADDR OF SYNTAX MSG ROUT   Y02006 40372002
         NI    SWA,RDRSW+SETCVTSW  RESET ALL BUT RDRSW AND SET   Y02006 40380002
*                                  CVT ADDR SWITCHES IN SWA      Y02006 40410002
VERBSCN5 CLI   WTORMSG+71,BLANK    IS COLUMN 72 BLANK            Y02006 40420002
         BE    VERBSCN6            YES - GO SCAN BUFFER          Y02006 40430002
         MVI   WTORMSG+71,BLANK    BLANK COLUMN 72               Y02006 40432002
         BAL   RETREG,SYNTAXE      OUTPUT ERROR MESSAGE          Y02006 40434002
VERBSCN6 TRT   WTORMSG(72),NONBLNK LOOK FOR FIRST NON-BLANK CHAR Y02006 40440002
         BC    8,MAP4              BUFFER BLANK                         40470002
VERBSCN3 NI    SWB,XFF-(IOERR+FMTERR)  RESET ERROR INDICATORS           40500002
         NI    BUFSW,XFF-PREFM     RESET PRE-FORMATTED SW        X01980 40530002
         ST    R1,VERBGN           SAVE ADDR OF BEGINNING OF VERB       40560002
CK4PRST  LA    R2,STOPCMP          GET ADDRESS OF STOP ROUTINE   Y02006 40590002
         ST    R2,STOPEXIT         STORE IN COMMON CSECT                40620002
         LA    R15,WRTSYNA         ADDR OF SYNTAX ERROR MSG ADDRS       40650002
         ST    R15,SYNMSGA         STORE IT                             40680002
         L     R15,ASYNTAX         GET ADDR OF SYNTAX MSG ROUTINE       40710002
         LA    R14,MAP4            POINT RETURN TO TEST RDRSW           40740002
*                                  DON'T NEED TITLE AFTER SYNTAX ER     40770002
         XC    KYWDBGN(4),KYWDBGN  ZERO KEYWORD POINTER          Y02006 40772002
         XC    KYWDEND(4),KYWDEND  ZERO KEYWORD END POINTER      Y02006 40774002
         TM    SWD,CONTSW          CONTINUATION STMT EXPECTED    Y02006 40780002
         BO    EDITCONT            YES - GO SCAN IT              Y02006 40790002
         SR    R2,R2               CLEAR DELIMITER REGISTER             40800002
         TRT   0(72,R1),BLNK       LOOK FOR FIRST DELIMITER      Y02006 40830002
         B     *(2)                IF DELIMITER WAS A COMMA REG2 WILL   40890002
*                                  EQ 4, IF IT WAS AN = REG2 WILL EQ 8, 40920002
*                                  IF IT WAS A BLANK REG2 WILL EQ 12    40950002
         B     VERBSCN4            COMMA--OK                            40980002
         B     VERBSCN4            EQUAL SIGN--ONLY 'CVT=' & 'SEGTAB='  41010002
         B     VERBSCN4            BLANK--OK                            41040002
         B     SYNTAXB             LEFT PAREN--INVALID           Y02006 41070002
         B     SYNTAXB             RIGHT PAREN--INVALID          Y02006 41100002
VERBSCN4 ST    R2,DELIMCD          SAVE DELIMITER CODE                  41130002
         ST    R1,VERBEND          SAVE VERB END ADDR                   41160002
         S     R1,VERBGN           GET LENGTH                           41190002
         BNP   SYNTAX              LENGTH EQ TO OR LT ZERO       Y02006 41220002
         CH    R1,EIGHT            IS VERB GREATER THAN 8 CHAR   Y02006 41230002
         BH    VB2LNG              YES - ERROR                   Y02006 41240002
         L     R4,VERBGN                                                41250002
         SH    R1,ONEA             SET FOR EXEC. INSTRUCTION     X01980 41280002
         BZ    CVTTEST             IS LENGTH OF VERB EQUAL 1     X01980 41310002
*                                  YES, IT IS NOT 'END' VERB     X01980 41340002
         CLC   0(3,R4),ENDVERB     WAS VERB 'END'                Y02006 41390002
         BNE   CVTTEST             BRANCH IF INVALID VERB        X01980 41430002
         CLC   DELIMCD+2(2),TWELVE WAS DELIMITER A BLANK         Y02006 41440002
         BNE   SYNTAXB             NO - GO ISSUE ERROR MESSAGE   Y02006 41450002
         L     R15,AEND            GET ADDRES OF END ROUTINE     X01980 41460002
         BALR  RETREG,R15          YES - ALL DONE - BALR ONLY    X01980 41490002
*                                  TO LOAD REG 14 FOR DEBUGGING  X01980 41520002
*                                  NO RETURN EXPECTED            X01980 41550002
VB2LNG   LA    R14,MAP2            ERROR RETURN ADDRESS          Y02006 41560002
         B     SYNTAXA             GO ISSUE ERROR MESSAGE        Y02006 41570002
CVTTEST  OI    SWD,NOLOADSW        END NOT ONLY STATEMENT        X01980 41580002
         LA    R3,CVTPARM                                               41610002
         LTR   R1,R1               LENGTH=1                      Y02006 41620002
         BE    CVTCOMP             YES,OK TO COMPARE             Y02006 41630002
         CH    R1,TWO              LENGTH = 3                    Y02006 41632002
         BNE   SEGCOMP             NO - GO CHECK FOR SEGTAB      Y02006 41634002
CVTCOMP  EX    R1,COMPARE          WAS PARM 'CVT'                Y02006 41640002
         BE    CVTSET              YES--SET ADDR OF CVT TO BE USED      41670002
SEGCOMP  LA    R3,SGTBPARM                                       Y02006 41680002
         LTR   R1,R1               LENGTH = 1                    Y02006 41682002
         BE    SEGCOMP1            YES, OK TO COMPARE            Y02006 41684002
         CH    R1,FIVE             LENGTH = 6                    Y02006 41686002
         BNE   CHKDEL              NO, CHECK DELIMITER           Y02006 41688002
SEGCOMP1 EX    R1,COMPARE          WAS PARM 'SEGTAB'?            Y02006 41690002
         BE    SEGTBSET            YES- SET @ SEG TAB TO BE USED X01980 41692002
CHKDEL   CH    R2,EIGHT            WAS DELIMITER AN EQ SIGN      Y02006 41700002
         BE    SYNTAXB             YES--DELIMITER ERROR          Y02006 41730002
         C     R1,SIX              WAS LENGTH = SEVEN            Y02006 41740002
         BNE   CKOTHR              NO - NOT SUMMARY OR CPUDATA   Y02006 41750002
         CLC   0(7,R4),SUMVERB     WAS VERB 'SUMMARY'            Y02006 41752002
         BE    SUMMARY             YES - GO PRINT SUMMARY INFO   Y02006 41754002
         CLC   0(7,R4),CPUDVERB    WAS VERB 'CPUDATA'            Y02006 41756002
         BE    CPUDATA             YES - GO PRINT CPUDATA INFO   Y02006 41758002
         CLC   0(7,R4),DISPVERB    WAS VERB 'DISPLAY'          @Y30MIBS 41758600
         BE    DISPLAY             YES, GO TO DISPLAY RTN      @Y30MIBS 41759200
CKOTHR   LA    R3,MAPPARM          ADDR OF LPAMAP                       41760002
         LTR   R1,R1               LENGTH = 1                    Y02006 41770002
         BE    LCOMP               YES, OK TO COMPARE            Y02006 41780002
         CH    R1,FIVE             LENGTH = 6                    Y02006 41782002
         BNE   CHKTITLE            NO,NOT LPAMAP OR FORMAT       Y02006 41784002
LCOMP    EX    R1,COMPARE          IS IT EQUAL                   Y02006 41790002
         BE    MAP                 YES--DO LINK PACK AREA MAP           41820002
         LA    R3,FMTPARM                                               41940002
         EX    R1,COMPARE          WAS VERB 'FORMAT'                    41970002
         BE    PRNTFMT             YES--GO FORMAT ALL REGION'S CONTROL  42000002
*                                  BLOCKS                               42030002
CHKTITLE LA    R3,TITLE                                          Y02006 42060002
         LTR   R1,R1               LENGTH = 1                    Y02006 42070002
         BE    TITLECMP            YES, OK TO COMPARE            Y02006 42080002
         CH    R1,FOUR             LENGTH = 5                    Y02006 42082002
         BNE   GOCOMP              NO, NOT TITLE OR PRINT        Y02006 42084002
TITLECMP EX    R1,COMPARE          WAS VERB 'TITLE'              Y02006 42090002
         BE    TITLEVRB            YES--MOVE TITLE TO TITLEMSG          42120002
         LA    R3,PRNTVERB                                              42150002
         EX    R1,COMPARE          WAS VERB 'PRINT'                     42180002
         BE    PRINT               YES                                  42210002
         LA    R3,DISPVERB                                     @Y30MIBS 42217000
         EX    R1,COMPARE          WAS VERB 'DISPLAY'          @Y30MIBS 42224000
         BE    DISPLAY             YES, GO TO DISPLAY RTN      @Y30MIBS 42231000
GOCOMP   LA    R3,GOVERB                                         Y02006 42240002
         EX    R1,COMPARE          WAS VERB 'GO'                        42270002
         BE    GO                  YES                                  42300002
         LA    R3,ONGOVRB                                               42330002
         LTR   R1,R1               LENGTH = 1                    Y02006 42340002
         BE    ONGOCOMP            YES, OK TO COMPARE            Y02006 42350002
         CH    R1,THREE            LENGTH = 4                    Y02006 42352002
         BNE   NDCOMP              NO, NOT ONGO VERB             Y02006 42354002
ONGOCOMP EX    R1,COMPARE          WAS VERB 'ONGO'               Y02006 42360002
         BE    ONGO                YES--SAVE OPERAND                    42390002
NDCOMP   LA    R3,NEWTVERB         BEFORE NEWDUMP SO 'N' TAKES   Y02006 42420002
*                                  AS ABRV. FOR NEWTAPE                 42450002
         LTR   R1,R1               LENGTH = 1                    Y02006 42460002
         BE    NCMP                YES, OKAY TO COMPARE          Y02006 42470002
         C     R1,SIX              LENGTH = 7                    Y02006 42472002
         BNE   CHKND               NO,NOT NEWDUMP OR NEWTAPE     Y02006 42474002
NCMP     EX    R1,COMPARE          WAS VERB 'NEWTAPE'            Y02006 42480002
         BE    NEWTDUMP            YES                                  42510002
         LA    R3,NEWVERB                                               42540002
         EX    R1,COMPARE          WAS VERB 'NEWDUMP'                   42570002
         BE    NEWDUMP             YES                                  42600002
CHKND    LA    R3,NEWVERBA                                       Y02006 42630002
         EX    R1,COMPARE          WAS VERB 'ND' - ABRV. FOR NEWDUMP    42660002
         BE    NEWDUMP             YES                                  42690002
         LA    R3,EDITVERB         POINT TO 'EDIT' VERB          S21014 42720002
         LTR   R1,R1               LENGTH = 1                    Y02006 42730002
         BE    EDITCOMP            YES , OK TO COMPARE           Y02006 42740002
         CH    R1,THREE            LENGTH = 4                    Y02006 42742002
         BNE   USRVERB             NO - NOT EDIT                 Y02006 42744002
EDITCOMP EX    R1,COMPARE          WAS VERB 'EDIT'               Y02006 42750002
         BE    EDIT                YES                           S21014 42780002
*                                  NO MATCH--FALL THRU TO USER   Y02006 42810002
*                                  INTERFACE MODULE              Y02006 42840002
         SPACE 1                                                 Y02006 42850002
USRVERB  MVI   EXITFLAG,ZVERB      SET UP FOR CALL FROM CTL      Y02006 42852002
         L     R15,AUSREXIT        LOAD ADDRESS OF USER          Y02006 42860002
*                                  INTERFACE MODULE              Y02006 42862002
         BALR  R14,R15             BRANCH TO IT                  Y02006 42864002
         B     MAP2                GO TEST FOR ADD. SCAN         Y02006 42866002
         EJECT                                                          42870002
*********************************************************************** 42920002
*   HANDLE EDIT CONTINUATION STATEMENTS                               * 42970002
*********************************************************************** 43020002
EDITCONT NI    SWE,XFF-RESPC       RESET RESPECIFY SWITCH        Y02006 43770002
         NI    SWD,XFF-CONTSW      ON MEANS CONT. RECEIVED       S21014 43800002
         B     EDITSCN             GO TO EDIT SCAN               S21014 43830002
         SPACE 2                                                        43860002
*********************************************************************** 44520002
*                                                                     * 44550002
*   THE FOLLOWING ROUTINES LINK TO RESPECTIVE AMDPRDMP EXECUTORS.     * 44580002
*   BEFORE AN EXECUTOR CAN BE INVOKED, THE PATH WHICH TERMINATES WITH * 44610002
*   THAT EXECUTOR IS LOADED.  NODES ON THE EXECUTORS PATH ARE THE     * 44640002
*   SERVICE ROUTINES WHICH IT REQUIRES.                               * 44670002
*                                                                     * 44700002
*********************************************************************** 44730002
         SPACE                                                          44760002
***  LINK TO LPA MAP ROUTINE TO PRINT MAP OF LINK PACK AREA  ***        44790002
MAP      TM    SWD,FLSHMODE        IN FLUSH MODE                 Y02006 44840002
         BO    MAP2                YES, DON'T LOAD PATH          Y02006 44842002
         LA    PREG,LPAPATH        POINT TO LPA EXECUTOR'S PATH         44850002
*                                  DESCRIPTOR                           44880002
         L     R15,ALOADER         GET ADDRESS OF LOAD ROUTINE          44910002
         BALR  RETREG,R15          LINK TO LOADER                       44940002
         LR    R15,PREG            LOAD ADDRESS OF LPA MAP EXECUTOR     44970002
*                                  RETURNED BY LOADER                   45000002
         BALR  RETREG,R15          LINK TO IT                           45030002
MAP2     CH    R2,FOUR             WAS DELIMITER CODE 4 (COMMA)         45060002
         BE    MAP3                GO INCREMENT TO NEXT VERB            45090002
MAP1     SR    R15,R15             TEST FOR NEW TITLE                   45120002
MAP5     L     R13,4(R13)          POINT TO INIT'S SAVE AREA            45180002
         L     R14,12(R13)         RESTORE INIT'S REGS                  45210002
         LM    R0,R12,20(R13)                                           45240002
         BR    RETREG              RETURN FOR CONTROL STATEMENT         45270002
         SPACE                                                          45300002
MAP4     LA    R15,4               DON'T NEED NEW TITLE                 45330002
         B     MAP5                CONTINUE PROCESSING                  45360002
MAP3     L     R1,VERBEND          LOAD DELIMITER ADDRESS               45390002
         AH    R1,ONEA             STEP TO NEXT CHARACTER               45420002
         B     VERBSCN3            SCAN FOR NEXT VERB                   45450002
         SPACE                                                          45480002
***  LINK TO FORMAT EXECUTOR  ***                                       45840002
PRNTFMT  TM    SWD,FLSHMODE        IN FLUSH MODE                 Y02006 45890002
         BO    MAP2                YES, DON'T LOAD PATH          Y02006 45892002
         LA    PREG,FMTPATH        POINT FORMAT'S PATH DESCRIPTOR       45930002
         L     R15,ALOADER         GET ADDRESS OF LOAD ROUTINE          45960002
         BALR  RETREG,R15          LINK TO LOADER                       45990002
         LR    R15,PREG            GET ADDRESS OF FORMAT EXECUTOR       46020002
         BALR  RETREG,R15          LINK TO IT                           46050002
         B     MAP2                GO TEST FOR ADDITIONAL SCANNING      46080002
         SPACE                                                          46110002
***  PROCESS SUMMARY VERB  ***                                   Y02006 46160002
SUMMARY  TM    SWD,FLSHMODE        IN FLUSH MODE                 Y02006 46170002
         BO    MAP2                YES, DON'T LOAD PATH          Y02006 46180002
         LA    PREG,SUMPATH        POINT TO SUMMARY'S PATH       Y02006 46210002
*                                  DESCRIPTOR                    Y02006 46260002
         L     R15,ALOADER         GET ADDRESS OF LOAD ROUTINE   Y02006 46310002
         BALR  RETREG,R15          LINK TO LOADER                Y02006 46360002
         LR    R15,PREG            GET ADDRESS OF AMDPRSUM RETURNED     46410002
*                                  BY LOADER                     Y02006 46460002
         BALR  RETREG,R15          LINK TO IT                    Y02006 46510002
         B     MAP2                GO TEST FOR ADD. SCANNING     Y02006 46560002
         SPACE 2                                               @Y30MIBS 46564000
***  PROCESS DISPLAY VERB  ***                                 @Y30MIBS 46568000
DISPLAY  TM    SWD,FLSHMODE        IN FLUSH MODE               @Y30MIBS 46572000
         BO    MAP2                YES, DON'T LOAD PATH        @Y30MIBS 46576000
         LA    PREG,DISPATH        POINT TO DISPLAY'S PATH     @Y30MIBS 46580000
         L     R15,ALOADER         GET ADDR OF LOAD RTN        @Y30MIBS 46584000
         BALR  RETREG,R15          LINK TO LOADER              @Y30MIBS 46588000
         LR    R15,PREG            GET ADDR OF AMDPRFDS        @Y30MIBS 46592000
         BALR  RETREG,R15          LINK TO IT                  @Y30MIBS 46596000
         B     MAP2                GO TEST FOR ADD. SCANNING   @Y30MIBS 46600000
         SPACE 2                                                 Y02006 46610002
*** PROCESS CPUDATA VERB  ***                                    Y02006 46660002
CPUDATA  TM    SWD,FLSHMODE        IN FLUSH MODE                 Y02006 46670002
         BO    MAP2                YES, DON'T LOAD PATH          Y02006 46680002
         LA    PREG,CPUDPATH       POINT TO CPUDATA'S PATH       Y02006 46710002
*                                  DESCRIPTOR                    Y02006 46760002
         L     R15,ALOADER         GET ADDRESS OF LOAD ROUTINE   Y02006 46810002
         BALR  RETREG,R15          LINK TO LOADER                Y02006 46860002
         LR    R15,PREG            GET ADDRESS OF CPUDATA EXECUTOR      46870002
*                                  RETURNED BY LOADER            Y02006 46880002
         BALR  RETREG,R15          LINK TO IT                    Y02006 46882002
         B     MAP2                GO TEST FOR ADD. SCANNING     Y02006 46884002
         SPACE 2                                                 Y02006 46886002
***  EDIT - PROCESS GTF TRACE DATA  ***                          S21014 46890002
EDIT     TM    SWD,FLSHMODE        IN FLUSH MODE               @ZA02798 46910000
         BO    MAP2                YES,DON'T LOAD PATH         @ZA02798 46930000
         STC   R2,EDDELIM          SAVE DELIMETER FOLLOWING EDIT        46950000
*                                  VERB AS INDICATOR OF WHERE    S21014 46980002
*                                  SCAN IS TO PICK UP AFTER      S21014 47010002
*                                  EDIT PROCESSING - SAME CARD   S21014 47040002
*                                  OR GET NEXT CARD              S21014 47070002
         OI    SWC,EDITSW          INDICATE EDIT IN PROCESS      S21014 47100002
         LA    PREG,EDIT1          POINT TO PATH DESCRIPTOR FOR  S21014 47130002
*                                  SCAN PHASE OF EDIT            S21014 47160002
         L     R15,ALOADER         GET ADDRESS OF PATH LOAD RTN  S21014 47190002
         BALR  RETREG,R15          LINK TO LOADER                S21014 47220002
         ST    PREG,AEDITSCN       SAVE EP ADDRESS OF AMDPRSCN   X01980 47250002
*                                  RETURNED BY LOADER            S21014 47280002
EDITSCN  L     R15,AEDITSCN        POINT TO SCN                  S21014 47310002
         BALR  RETREG,R15          LINK TO EDIT SCAN ROUTINE -   S21014 47340002
*                                  AMDPRSCN                      X01980 47370002
         TM    SWD,CONTSW          TEST FOR EDIT SCAN REQUESTING S21014 47400002
*                                  CONTINUATION                  S21014 47430002
         BO    MAP4                BRANCH TO GET STMT. IF SO     S21014 47460002
         SR    R2,R2               CLEAR DELIM REG BEFORE IC     S21014 47490002
         IC    R2,EDDELIM          LOAD DELIMITER CODE SO ACTION S21014 47520002
*                                  CAN BE TAKEN AFTER EITHER     S21014 47550002
*                                  SCAN ERROR OR EDIT COMPLETE   S21014 47580002
         B     EDITCODE(R15)       BRANCH ON SCN'S RETURN CODE   S21014 47610002
EDITCODE B     LODEXPHZ            0 - GO LOAD EDIT EXECUTION    S21014 47640002
*                                      PHASE                     S21014 47670002
         NI    SWC,XFF-EDITSW      EDIT NO LONGER IN CONTROL     S21014 47700002
         B     MAP2                BRANCH TO NEXT VERB STMT      S21014 47730002
***  LOAD EDIT EXECUTION PHASE  ***                              S21014 47760002
LODEXPHZ LA    PREG,EDIT2          POINT TO PATH DESCRIPTOR FOR  S21014 47790002
*                                  EDIT EXECUTION PHASE          S21014 47820002
         L     R15,ALOADER         GET ADDR PATH LOAD ROUTINE    S21014 47850002
         BALR  RETREG,R15          LINK TO LOADER                S21014 47880002
         LR    R15,PREG            POINT TO EDIT FORMAT CONTROL  S21014 47910002
*                                  ROUTINE - AMDPRFRM            X01980 47940002
         BALR  RETREG,R15          LINK TO FRM                   S21014 47970002
         NI    SWC,XFF-EDITSW      EDIT NO LONGER IN CONTROL     S21014 48000002
         B     MAP2                BRANCH TO GET NEXT VERB       S21014 48030002
         SPACE                                                          48060002
*********************************************************************** 48090002
*                                                                     * 48120002
*  THE PRINT CONTROL STATEMENT MUST BE SCANNED BEYOND THE VERB LEVEL  * 48150002
*  TO SEPARATE ABSOLUTE STORAGE REQUESTS FROM PRINT REQUESTS WHICH    * 48180002
*  NEED THE AMDPRFMT SERVICE ROUTINE                             X01980 48210002
*                                                                     * 48240002
*********************************************************************** 48270002
         SPACE                                                          48300002
PRINT    CH    R2,TWELVE           TEST FOR DELIMITER OF BLANK   Y02006 48360002
         BNE   SYNTAXB             NOT BLANK--ERROR                     48390002
         LA    R4,WTORMSG+71       COMPUTE NUMBER                Y02006 48420002
         S     R4,VERBEND          OF BYTES REMAINING                   48450002
*                                  IN BUFFER                            48480002
         BC    12,SYNTAX           BR IF ZERO OR NEGATIVE               48510002
         BCTR  R4,0                DECREMENT 1 FOR EXECUTE              48540002
         L     R1,VERBEND                                               48570002
         SR    R2,R2               CLEAR DELIMITER CODE REG             48600002
         EX    R4,NBLNKTRT         LOOK FOR KEY WORD                    48630002
         BC    8,SYNTAXD           NO OPERAND                           48660002
         ST    R1,KYWDBGN          SAVE BEGINNING ADDR                  48690002
PRINT1   LA    RETREG,MAP4                                              48720002
         L     R15,ASYNTAX                                              48750002
         TRT   0(72,R1),BLNK       LOOK FOR NEXT DELIMITER       Y02006 48780002
         LA    R3,PRTSYNA          ADDR OF SYNTAX ERROR MSG ADDRS       48810002
         ST    R3,SYNMSGA          STORE IT                             48840002
         ST    R1,KYWDEND          SAVE ENDING ADDR                     48900002
         ST    R2,DELIMCD          SAVE DELIMITER CODE                  48930002
         CH    R2,TWELVE           IS DELIM VALID                X01980 48960002
         BH    SYNTAXB             BR IF NOT                            48990002
         L     R4,KYWDBGN                                               49020002
         SR    R1,R4               LENGTH OF KEYWORD                    49050002
         BC    12,SYNTAX           BR IF LE ZERO                        49080002
         LA    R14,MORETEST        ERROR RETURN ADDRESS          Y02006 49090002
         CH    R1,EIGHT            KEYWORD LONGER THAN 8 CHAR    Y02006 49100002
         BH    SYNTAXA             YES - GO ISSUE MESSAGE        Y02006 49102002
         LA    R14,MAP4            RESET ERROR RETURN ADDRESS    Y02006 49104002
         BCTR  R1,0                DECR BY 1 FOR EXECUTE                49110002
         LA    R3,STOROP                                                49140002
         LTR   R1,R1               LENGTH = 1                    Y02006 49150002
         BE    PRNTCOMP            YES, OK TO COMPARE            Y02006 49160002
         C     R1,SIX              LENGTH = 7                    Y02006 49162002
         BNE   CHKREAL             NO - NOT CURRENT,JOBNAME,STORAGE     49164002
*                                  OR NUCLEUS                    Y02006 49166002
PRNTCOMP EX    R1,COMPARE          KEYWORD EQUAL STORAGE         Y02006 49170002
         BE    STORAGE             ABSOLUTE STORAGE REQUEST             49200002
         LA    R3,NUCOP                                                 49230002
         EX    R1,COMPARE          KEYWORD EQUAL NUCLEUS                49260002
         BE    NUCLEUS             YES--PRINT NUCLEUS AND SQS           49290002
         LA    R3,JOBOP                                                 49410002
         EX    R1,COMPARE          KEYWORD EQUAL JOBNAME                49440002
         BE    JOBNAME             PRINT TASKS ASSOCIATED WITH JOB      49470002
         LA    R3,CUROP                                                 49590002
         EX    R1,COMPARE          KEYWORD EQ 'CURRENT'                 49620002
         BE    CURNT               YES--PRINT CURRENT TASK              49650002
CHKREAL  LA    R3,REALOP                                         Y02006 49680002
         LTR   R1,R1               LENGTH = 1                    Y02006 49690002
         BE    REALCOMP            YES , OK TO COMPARE           Y02006 49700002
         CH    R1,THREE            LENGTH = 4                    Y02006 49702002
         BNE   CHKCSA              NO - NO REAL                  Y02006 49704002
REALCOMP EX    R1,COMPARE          KEYWORD EQ 'REAL'             Y02006 49710002
         BE    REAL                YES--PRINT REAL STORAGE       X01980 49740002
CHKCSA   LA    R14,MORETEST        ERROR RETURN ADDRESS          Y02006 49742002
         CH    R1,TWO              WAS LENGTH = THREE            Y02006 49750002
         BNE   SYNTAXC             NO - NOT CSA OR SQA           Y02006 49760002
         LA    R14,MAP4            RESTORE ERROR RETURN ADDR     Y02006 49770002
         LA    R3,CSAOP                                          Y02006 49790002
         EX    R1,COMPARE          KEYWORD EQUAL CSA             Y02006 49840002
         BE    NUCLEUS             YES -PRINT COMMON SYSTEM AREA Y02006 49850002
         LA    R3,SQAOP                                          Y02006 49852002
         EX    R1,COMPARE          KEYWORD EQUAL SQA             Y02006 49854002
         BE    NUCLEUS             YES - PRINT SQA               Y02006 49856002
         LA    R14,MORETEST        ERROR RETURN ADDRESS          Y02006 49858002
         B     SYNTAXC             KEYWORD INVALID                      49860002
         SPACE                                                          49890002
***  REAL STORAGE REQUEST - LINK TO PMS EXECUTOR  ***            X01980 49920002
REAL     OI    PRSW,PRNTRL         INDICATE PRINT REAL REQUEST   X01980 49950002
         B     REALSTOR            SET PATH DESCRIPTOR           X01980 49980002
***  ABSOLUTE STORAGE REQUEST - LINK TO PMS EXECUTOR  ***               50010002
STORAGE  NI    PRSW,XFF-PRNTRL     INDICATE ABSOLUTE STORAGE     X01980 50040002
*                                  REQUEST                       X01980 50070002
REALSTOR MVC   PRTPATH+5(3),PMS    SET NAME OF ABSOLUTE STORAGE  X01980 50100002
*                                  EXECUTOR IN PATH DESCRIPTOR   X01980 50130002
         LA    PREG,PRTPATH        POINT TO PATH DESCRITOR              50160002
         L     R15,ALOADER         GET ADDRESS OF LOAD ROUTINE          50190002
         BALR  RETREG,R15          LINK TO IT                           50220002
         LR    R15,PREG            LOAD ADDRESS ABSOLUTE STORAGE        50250002
*                                  EXECUTOR - RETURNED BY LOADER        50280002
         BALR  RETREG,R15          LINK TO THE EXECUTOR                 50310002
         B     MORETEST            GO TEST FOR MORE PRINT PARMS         50400002
         SPACE                                                          50430002
***  SET UP TO PRINT NUCLEUS AND SQA - NUC EXECUTOR  ***                50850002
NUCLEUS  TM    SWD,FLSHMODE        IN FLUSH MODE                 Y02006 50860002
         BO    MORETEST            YES, DON'T LOAD PATH          Y02006 50870002
         MVC   PRTPATH+5(3),NUC    SET NAME OF NUC PRINT EXEC    Y02006 50880002
         BAL   R9,DELTEST          CHECK FOR VALID DELIMITER     X01980 50970002
NUCPATH  LA    PREG,PRTPATH        POINT TO PATH DESCRIPTOR      X01980 51000002
         L     R15,ALOADER         GET ADDRESS OF LOAD ROUTINE          51030002
         BALR  RETREG,R15          LINK TO LOADER                       51060002
         LR    R15,PREG            GET ADDRESS OF NUC EXECUTOR          51090002
         BALR  RETREG,R15          LINK TO IT                           51120002
         B     MORETEST            GO TEST FOR MORE PRINT PARMS         51210002
         EJECT                                                          51540002
*********************************************************************** 51570002
*                                                                     * 51600002
*  THE FOLLOWING PRINT OPERATIONS REQUIRE THE FORMAT SERVICE ROUTINE  * 51630002
*                                                                     * 51660002
*********************************************************************** 51690002
         SPACE                                                          51720002
***  PRINT STORAGE BY SPECIFIC JOBNAME  ***                             51750002
JOBNAME  MVC   FPRTPATH+17(3),PJB  SET NAME OF JOBNAME EXECUTOR  Y02006 51760002
*                                  IN PATH DESCRIPTOR            Y02006 51770002
         LA    PREG,FPRTPATH       POINT TO PATH DESCRIPTOR      Y02006 51780002
         L     R15,ALOADER         LOAD ADDRESS OF LOAD ROUTINE         51810002
         BALR  RETREG,R15          LINK TO LOADER                       51840002
         LR    R15,PREG            GET ADDRESS OF JOBNAME EXECUTOR      51870002
*                                  RETURNED BY LOADER                   51900002
         BALR  RETREG,R15          LINK TO IT                           51930002
         B     MORETEST            GO TEST FOR MORE PRINT KEYWORDS      51960002
         SPACE                                                          51990002
***  LINK TO PRINT CURRENT EXECUTOR  ***                                52380002
CURNT    TM    SWD,FLSHMODE        IN FLUSH MODE                 Y02006 52390002
         BO    MORETEST            YES, DON'T LOAD PATH          Y02006 52400002
         MVC   FPRTPATH+17(3),CUR  SET NAME OF CURRENT EXECUTOR  Y02006 52410002
*                                  IN PATH DESCRIPTOR                   52440002
         LA    PREG,FPRTPATH       POINT TO PATH DESCRIPTOR             52470002
         BAL   R9,DELTEST          CHECK FOR VALID DELIMITER     X01980 52500002
         L     R15,ALOADER         LOAD ADDRESS LOAD ROUTINE            52530002
         BALR  RETREG,R15          LINK TO LOADER                       52560002
         LR    R15,PREG            GET ADDRESS OF CURRENT EXECUTOR      52590002
         BALR  RETREG,R15          LINK TO IT                           52620002
*                                  FALL THROUGH TO MORETEST TO CHECK    52650002
*                                  FOR ADDITIONAL PRINT KEYWORDS        52680002
         SPACE                                                          52710002
MORETEST LA    R14,MAP4            RELOAD RETURN REGISTER        A44079 52740002
         L     R15,ASYNTAX         RELOAD EP ADDR OF AMDPRSYN    A44079 52770002
         CLI   DELIMCD+3,X'04'     TEST FOR DELIMITER OF COMMA    M3515 52800002
         BNE   MAP1                NO - READ NEXT CARD            M3515 52830002
*                                  OTHERWISE - CONTINUE SCAN OF   M3515 52860002
*                                  THIS CONTROL STMT.             M3515 52890002
         L     R1,KYWDEND          DELIMITER ADDR                       52920002
         AH    R1,ONEA             INCR BY ONE                          52950002
         ST    R1,KYWDBGN          SAVE ADDR OF BEGINNING OF NEXT PARM  52980002
         B     PRINT1              CONTINUE SCANNING BUFFER             53010002
         EJECT                                                          53040002
*********************************************************************** 53070002
*                                                                     * 53100002
*        THE FOLLOWING VERIFIES THAT ONLY A BLANK OR COMMA DELIMITER  * 53130002
*        FOLLOWS PRINT CURRENT, NUCLEUS, CSA, OR SQA REQUESTS         * 53160002
*                                                                     * 53190002
*********************************************************************** 53220002
         SPACE                                                          53250002
DELTEST  CLI   DELIMCD+3,X'04'     DELIMITER A COMMA             X01980 53280002
         BCR   8,R9                YES - RETURN                  X01980 53310002
         CLI   DELIMCD+3,X'0C'     DELIMITER A BLANK             X01980 53340002
         BCR   8,R9                YES - RETURN                  X09180 53370002
         L     R15,ASYNTAX         ADDRESS OF SYNTAX WRITER      X01980 53400002
         B     SYNTAXB             INVALID DELIMITER             X01980 53430002
*********************************************************************** 53460002
*                                                                     * 53490002
**                    ***  ONGO VERB ROUTINE  ***                    ** 53520002
*                                                                     * 53550002
*                                                                     * 53580002
*   THIS ROUTINE SETS UP THE FUNCTIONS TO BE DONE FOR A CONTROL       * 53610002
*   STATEMENT OF 'GO'.  THE 'ONGO' VERB SHOULD BE FOLLOWED BY AT      * 53640002
*   LEAST ONE BLANK FOLLOWED BY THE DESIRED FUNCTIONS.  IF THERE IS   * 53670002
*   NOTHING FOLLOWING 'ONGO' THE ONGO FUNCTION WILL BE RESET AND THE  * 53700002
*   STANDARD GO DEFAULTS WILL BE DONE.                                * 53730002
*                                                                     * 53760002
*********************************************************************** 53790002
         SPACE                                                          53820002
ONGO     CH    R2,TWELVE           WAS DELIMITER BLANK           Y02006 53880002
         BNE   SYNTAXB             NO--ERROR...DELIMITER INVALID        53910002
         LA    R2,1                LOAD INCR VALUE                      53940002
         L     R3,VERBEND          LOAD ADDR DELIMITER FOR COMPARAND    53970002
         LCR   R2,R2               COMPLIMENT FOR A NEG INCR            54000002
         LA    R1,WTORMSG+70       LOAD START ADDR FOR BACK SCAN Y02006 54030002
ONGOLP1  CLI   0(R1),C' '          LOOK FOR FIRST NON BLANK CHAR IN     54060002
*                                  BACK SCAN                            54090002
         BNE   ONGO1               BR IF NON BLANK FOUND                54120002
         BXH   R1,R2,ONGOLP1       LOOP--SCANNING BACKWARDS FOR FIRST   54150002
*                                  NON-BLANK CHAR                       54180002
         B     ONGORST             ALL BLANK--RESET ONGO FUNCTION       54210002
         SPACE                                                          54240002
ONGO1    S     R1,VERBEND          LENGTH OF ONGO OPERAND               54270002
         LA    R1,16(R1)           ADD 16 FOR TOTAL LN REQUIRED TO      54300002
*                                  FORM WTO LIST                        54330002
         LR    R3,R1               SAVE IN R3                           54360002
         L     R2,ONGOPTR          LOAD ADDR OF PREV ONGO OPERAND       54390002
         LTR   R2,R2               WAS THERE A PREV ONE                 54420002
         BNP   ONGO2               NO--BR AROUND                        54450002
         BAL   R9,OPRFREE          YES--FREE SPACE OCCUPIED BY OLD OPER 54480002
ONGO2    LR    R0,R3               LOAD LENGTH REQ FOR OPER TO R0 FOR   54510002
*                                  GETMAIN                              54540002
         GETMAIN R,LV=(0)          GET CORE FOR SAVING OPERAND IN       54570002
         ST    R1,ONGOPTR          SAVE ADDR OF GOTTEN CORE             54600002
         SH    R3,FOUR             STORE LN MINUS ROUTCDE AND DESC      54630002
         STH   R3,0(R1)            STORE LN OF OPERAND IN GOTTEN CORE   54660002
         XC    2(2,R1),2(R1)       ZERO 2ND HALFWORD OF GOTTEN LIST     54690002
         OI    2(R1),X'80'         INDICATE MCS LIST                    54720002
         MVI   4(R1),C' '          BLANK OUT MESSAGE ID                 54750002
         MVC   5(7,R1),4(R1)                                            54780002
         LA    R7,12(R1)           ADDR OF WHERE TO PUT OPERAND         54810002
         L     R2,VERBEND                                               54840002
         AH    R2,ONEA             ADDR OF BEG OF OPER                  54870002
         SH    R3,TWELVE           DECR LN 5 FOR EX                     54900002
         BCTR  R3,0                                                     54930002
         EX    R3,JOBMOVE          MOVE OPERAND TO SAVE BUFFER          54960002
         LA    R7,1(R3,R7)         ADDR OF ROUTCDE AND DESC             54990002
         XC    0(4,R7),0(R7)                                            55020002
         OI    0(R7),X'02'         DESC=7                               55050002
         OI    2(R7),X'40'         ROUTCDE=(2)                          55080002
         B     MAP4                CONTINUE                             55110002
         SPACE                                                          55140002
ONGORST  L     R2,ONGOPTR          LOAD ADDR OF ONGO OPERAND            55170002
         LTR   R2,R2               IS IT ZERO OR NEG (AUTO ONGO OPER)   55200002
         BNP   MAP4                 YES--NOTHING TO DO...SO CONTINUE    55230002
         BAL   R9,OPRFREE          GO FREE THE CORE                     55260002
         MVC   ONGOPTR,AUTONGO     SET AUTO ONGO OPERAND BACK UP        55290002
         B     MAP4                CONTINUE                             55320002
         SPACE 2                                                        55350002
OPRFREE  LH    R0,0(R2)            LOAD LN OF OPERAND                   55380002
         LA    R0,4(R0)            INCR. LENGTH TO ACCOUNT FOR          55410002
*                                  ROUTCDE AND DESC                     55440002
         LR    R1,R2               ADDR OF AREA TO BE FREED             55470002
         FREEMAIN R,LV=(0),A=(1)   FREE IT                              55500002
         XC    ONGOPTR,ONGOPTR     ZERO POINTER                         55530002
         BR    R9                  RETURN TO CALLER                     55560002
         EJECT                                                          55590002
*********************************************************************** 55620002
*                                                                     * 55650002
**                     ***  GO VERB ROUTINE  ***                     ** 55680002
*                                                                     * 55710002
*                                                                     * 55740002
*   THIS ROUTINE MOVES THE SAVED ONGO OPERAND TO THE WTORMSG BUFFER   * 55770002
*   AND RETURNS TO VERBSCN5 TO EXECUTE IT AS A CONTROL STATEMENT.  IF * 55800002
*   THE GOSW IS ON UPON ENTRY THE ONGO OPERAND HAD A GO PARAMETER IN  * 55830002
*   IT AND THE ROUTINE WILL INDICATE A SYNTAX ERROR.                  * 55860002
*                                                                     * 55890002
*********************************************************************** 55920002
         SPACE                                                          55950002
GO       CH    R2,TWELVE           WAS DELIMITER A BLANK         Y02006 56010002
         BNE   SYNTAXB             NO--ERROR..DELIMITER INVALID         56040002
         TM    SWA,GOSW            IS GOSW ALREADY ON                   56070002
         BO    GOONGOS             YES--GO SPECIFIED IN ONGO OPERAND    56100002
*                                  ERROR...ERROR                        56130002
         OI    SWA,GOSW            SET GO SWITCH                        56160002
         L     R1,ONGOPTR          LOAD ONGO OPERAND PTR                56190002
GOONGO   MVI   WTORMSG,C' '        BLANK WTOR                           56220002
         MVC   WTORMSG+1(79),WTORMSG BUFFER                             56250002
         LH    R3,0(R1)            LOAD LN OF OPERAND                   56280002
         SH    R3,C13              DECR 13 FOR EX                XM5890 56310002
         LA    R2,12(R1)           ADDR OF OPERAND TO R2         XM5890 56340002
         LA    R7,WTORMSG          ADDR OF WHERE IT GOES                56370002
         EX    R3,JOBMOVE          MOVE ONGO OPERAND TO WTOR BUFFER     56400002
         BRPRTMSG GOONGOWT+8,36    PRINT MESSAGE OF GO FUNCTIONS        56430002
         LA    R2,9(R3)            LOAD LN OF OPERAND -12        XM5890 56460002
         L     R1,ONGOPTR          LOAD ONGO OPERAND POINTER            56490002
         LA    R1,4(R1)            LOAD ADDR OF OPERAND                 56520002
         BRPRTMSG  (R1),(R2)       PRINT ONGO OPERANDS                  56550002
         TM    SWA,RDRSW                                                56580002
         BO    VERBSCN5            YES--DON'T WTO THE OPERAND           56610002
*                                                                 M3375 56640002
GOONGOWT WTO   'AMD163I GO FUNCTIONS TO BE PERFORMED',ROUTCDE=(2),     X56670002
               DESC=7                                            X01980 56700002
         L     R1,ONGOPTR          LOAD ADDR OF ONGO OPERAND            56730002
         WTO   MF=(E,(1))          WTO THE OPERAND                      56760002
         B     VERBSCN5            PROCEED                              56790002
         SPACE 2                                                        56820002
GOONGOS  LA    R1,GOSYNA           LOAD ADDR OF GO SYNTAX ERROR PTRS    56850002
         ST    R1,SYNMSGA          ST IN SYNTAX ERR MSG PTRS PTR        56880002
         B     SYNTAXA             GO TELL'EM ABOUT IT                  56910002
         EJECT                                                          56940002
*********************************************************************** 56970002
*                                                                     * 57062102
*   SET THE CVT ADDRESS TO THAT SPECIFIED BY OPERATOR                 * 57071402
*                                                                     * 57080702
*********************************************************************** 57090002
         SPACE                                                          57120002
CVTSET   CH    R2,EIGHT            IS DELIMITER AN EQ SIGN       Y02006 57180002
         BNE   SYNTAXB             NO--DELIMITER ERROR                  57210002
         LA    R3,CVTSYNA          SET SYNTAX                           57240002
         ST    R3,SYNMSGA          ERROR MSG ADDR                       57270002
         L     R3,VERBEND          POINT TO END OF CVT VERB             57300002
         AH    R3,ONEA             INCREMENT PAST DELIMITER             57330002
         ST    R3,KYWDEND          POINT TO END OF VALUE                57360002
         LR    R1,R3               REG 1 TO ADDR BEGINNING OF VALUE     57390002
         SR    R2,R2               CLEAR DELIMITER REG BEFORE TRANSLATE 57420002
         TRT   0(9,R3),BLNK        SCAN OPERAND                         57450002
         ST    R1,VERBEND          STORE ADDR END OF CVT-VAL     A43177 57480002
         CH    R2,FOUR             IS DELIM A COMMA - OK         A43177 57510002
         BE    CVTSET0             BRANCH TO PROCESS VALUE       A43177 57540002
         CH    R2,TWELVE           IS DELIM A BLANK              A43177 57570002
         BNE   SYNTAXB             INVALID DELIMITER - GO ISSUE  A43177 57600002
*                                  ERROR MESSAGE                 A43177 57630002
CVTSET0  ST    R2,DELIMCD          SAVE DELIMITER CODE FOR       A43177 57660002
*                                  TESTING AT LABEL MAP2         A43177 57690002
         LA    R14,MAP2            ERROR RETURN ADDRESS          Y02006 57700002
         SR    R1,R3               CALC LENGTH OF VALUE          A43177 57720002
         BZ    SYNTAXA             ZERO--NO ADDR                        57750002
         C     R1,SIX              COMPARE LN TO SIX                    57780002
         BH    SYNTAXA             GT 6--TOO BIG                        57810002
         CH    R1,ONEA             IS LENGTH OF ADDR 1                  57840002
         BH    CVTSET1             NO--CAN'T BE A 'P'                   57870002
CVTSETA  CLI   0(R3),C'P'          IS ADDR GIVEN 'P'                    57900002
         BNE   CVTSET1             NO--MUST BE AN ADDR                  57930002
         L     R1,CVTPTR           YES--USE CVT ADDR OF PRESENT SYSTEM  57960002
         B     CVTSET2             BR AROUND                            57990002
CVTSET1  LR    R2,R1               SAVE LENGTH IN R2             A35933 58020002
         LA    R14,CVTERRTN        ERROR RETURN ADDRESS          Y02006 58030002
CHECKCVT TM    0(R3),X'F0'         TEST FOR NUMERIC ZONE         A35933 58050002
         BO    CVTOK               STEP TO NEXT IF SO            A35933 58080002
         CLI   0(R3),C'F'          TEST FOR LEST THAN 'F'        A35933 58110002
         BH    SYNTAXA             ERROR IF NOT                  A35933 58140002
         CLI   0(R3),C'A'          TEST FOR GREATER THAN 'A'     A35933 58170002
         BL    SYNTAXA             ERROR IF NOT                  A35399 58200002
CVTOK    LA    R3,1(R3)            INCREMENT VALUE POINTER       A35933 58230002
         BCT   R1,CHECKCVT         LOOP ON LENGTH                A35933 58260002
         L     R1,KYWDEND          RESTORE VALUE POINTER         A35933 58290002
         LR    R3,R2               LENGTH TO R3                  A35933 58320002
         BCTR  R3,0                DECR FOR EXECUTE                     58350002
         EX    R3,STRGTR           TRANSLATE TO UNPACKED HEX            58380002
         LA    R2,X'70'            LENGTH OF TARGET FOR PACK INST       58410002
         OR    R2,R3               LENGTH OF SOURCE IN R3, OR TO GET    58440002
*                                  BOTH LENGTHS IN ONE BYTE             58470002
         EX    R2,STRGPACK         PACK TO HEX IN WORK1                 58500002
         MVO   WORK1+1(4),WORK1+4(4)  GET RID OF SIGN                   58530002
         L     R1,WORK1            LOAD HEX ADDRESS INTO R1             58560002
CVTSET2  ST    R1,CVTADDR          STORE GIVEN CVT ADDR                 58590002
         OI    SWA,SETCVTSW        INDICATE CVT ADDR SET BY CONTROL     58620002
CVTSET3  NI    SWC,XFF-MSTRSW      RESET MASTER SWITCH AND       Y02006 58680002
         TM    SWF,QSADMP          AMDSADMP INPUT                Y02006 58730002
         BZ    CVTERRTN            NO - BRANCH                   Y02006 58740002
         XC    QASID(2),QASID      ZERO QASID FIELD IN COMMON    Y02006 58750002
CVTERRTN L     R2,DELIMCD          LOAD DELIMITER CODE           Y02006 58770002
         B     MAP2                CONTINUE  - GO TEST DELIM     A43177 58800002
         EJECT                                                          58810002
*********************************************************************** 58820002
*                                                                     * 58822002
*   SET THE SEGTAB ADDRESS TO THAT SPECIFIED BY OPERATOR              * 58824002
*                                                                     * 58826002
*********************************************************************** 58828002
         SPACE                                                          58828402
SEGTBSET CH    R2,EIGHT            IS DELIMITER AN EQ SIGN       Y02006 58829202
         BNE   SYNTAXB             NO--DELIMITER ERROR           X01980 58829602
         LA    R3,SEGSYNA          SET SYNTAX                    X01980 58829702
         ST    R3,SYNMSGA          ERROR MSG ADDR                X01980 58829802
         L     R3,VERBEND          POINT TO END OF CVT VERB      X01980 58829902
         AH    R3,ONEA             INCREMENT PAST DELIMITER      X01980 58839902
         ST    R3,KYWDEND          POINT TO END OF VALUE         X01980 58849902
         LR    R1,R3               REG 1 TO @ BEGINNING OF VALUE X01980 58853202
         SR    R2,R2               CLEAR DELIM REG BEFOR XLATE   X01980 58855202
         TRT   0(9,R3),BLNK        SCAN OPERAND                  X01980 58855602
         ST    R1,VERBEND          STORE ADDR END OF CVT-VAL     X01980 58856002
         CH    R2,FOUR             IS DELIM A COMMA - OK         X01980 58856402
         BE    SEGSET0             BRANCH TO PROCESS VALUE       X01980 58856502
         CH    R2,TWELVE           IS DELIM A BLANK              X01980 58856602
         BNE   SYNTAXB             INVALID DELIMITER - GO ISSUE  X01980 58864902
*                                  ERROR MESSAGE                 X01980 58866902
SEGSET0  ST    R2,DELIMCD          SAVE DELIMITER CODE FOR       X01980 58868902
*                                  TESTING AT LABEL MAP2         X01980 58870902
         LA    R14,MAP2            ERROR RETURN ADDRESS          Y02006 58871302
         SR    R1,R3               CALC LENGTH OF VALUE          X01980 58872902
         BZ    SYNTAXA             ZERO--NO ADDR                 X01980 58873302
         C     R1,SIX              COMPARE LN TO SIX             X01980 58882602
         BH    SYNTAXA             GT 6--TOO BIG                 X01980 58892002
SEGSET1  LR    R2,R1               SAVE LENGTH IN R2             X01980 58901602
         LA    R14,SEGERRTN        ERROR RETURN ADDRESS          Y02006 58903602
CHECKSEG TM    0(R3),X'F0'         TEST FOR NUMERIC ZONE         X01980 58911102
         BO    SEGOK               STEP TO NEXT IF SO            X01980 58911502
         CLI   0(R3),C'F'          TEST FOR LESS THAN 'F'        X01980 58914302
         BH    SYNTAXA             ERROR IF NOT                  X01980 58916302
         CLI   0(R3),C'A'          TEST FOR GREATER THAN 'A'     X01980 58918302
         BL    SYNTAXA             ERROR IF NOT                  X01980 58918702
SEGOK    LA    R3,1(R3)            INCREMENT VALUE POINTER       X01980 58919102
         BCT   R1,CHECKSEG         LOOP ON LENGTH                X01980 58919502
         L     R1,KYWDEND          RESTORE VALUE POINTER         X01980 58919902
         LR    R3,R2               LENGTH TO R3                  X01980 58928402
         BCTR  R3,0                DECR FOR EXECUTE              X01980 58930402
         EX    R3,STRGTR           TRANSLATE TO UNPACKED HEX     X01980 58932402
         LA    R2,X'70'            LENGTH OF TARGET FOR PACK INS X01980 58934402
         OR    R2,R3               LENGTH SRC IN R3, OR TO GET   X01980 58936402
*                                  BOTH LENGTHS IN ONE BYTE      X01980 58936802
         EX    R2,STRGPACK         PACK TO HEX IN WORK1          X01980 58937202
         MVO   WORK1+1(4),WORK1+4(4)  GET RID OF SIGN            X01980 58937302
         L     R1,WORK1            LOAD HEX ADDRESS INTO R1      X01980 58937402
SEGSET2  ST    R1,SEGTABOR         STORE GIVEN SEGTAB ADDR       X01980 58938402
         MVI   SEGTABOR,X'FF'      FLAG BYTE                     X01980 58938802
         OI    PRSW,QSEGTBSW       INDICATE @SEGTAB SET BY CNTRL X01980 58939602
SEGSET3  NI    SWC,XFF-MSTRSW      RESET MASTER SWITCH AND       Y02006 58940102
         TM    SWF,QSADMP          AMDSADMP INPUT                Y02006 58950102
         BZ    SEGERRTN            NO - BRANCH                   Y02006 58960102
         XC    QASID(2),QASID      ZERO QASID FIELD IN COMMON    Y02006 58962102
SEGERRTN L     R2,DELIMCD          LOAD DELIMITER CODE           Y02006 58963602
         B     MAP2                CONTINUE  - GO TEST DELIM     X01980 58969402
         EJECT                                                          58975202
*********************************************************************** 58981002
*                                                                     * 58986802
*   ENTER INFORMATION TO BE PRINTED AS PART OF TITLE                  * 58992602
*                                                                     * 58998402
*********************************************************************** 59004202
         SPACE                                                          59010002
TITLEVRB CH    R2,TWELVE           WAS DELIMITER A BLANK         Y02006 59070002
         BNE   SYNTAXB             NO--ERROR                     Y02006 59100002
         L     R1,VERBEND          ADDR OF BLANK AFTER TITLE VERB       59130002
         AH    R1,ONEA             ADDR OF TITLE TO BE PRINTED          59160002
         LA    R3,WTORMSG+71                                     Y02006 59190002
         SR    R3,R1               LENGTH OF TITLE IN R3                59220002
         BNP   SYNTAX              LENGTH 0 OR NEG--ERROR               59250002
         LA    R2,64               LOAD MAXIMUM TITLE LENGTH     Y01980 59280002
         CR    R3,R2               COMPARE TO LENGTH OF TITLE     M1141 59310002
         BL    TITLMOVE            BRANCH TO MOVE TITLE -         M1141 59340002
*                                  LENGTH OK                      M1141 59370002
         LR    R3,R2               TOO LONG - USE MAX             M1141 59400002
TITLMOVE MVI   TITLEMSG,X'40'      BLANK TITLE AREA               M1141 59430002
         MVC   TITLEMSG+1(63),TITLEMSG                                  59460002
         BCTR  R3,0                DECR FOR EXECUTE                     59490002
         EX    R3,TITLCARD         MOVE TITLE FROM CONTROL STMT.        59520002
         B     MAP4                GO GET NEXT CONTROL STMT.            59550002
         EJECT                                                          59580002
*********************************************************************** 59610002
*                                                                     * 59640002
*                          NEWDUMP PROCESSOR                          * 59670002
*                                                                     * 59700002
*********************************************************************** 59730002
         SPACE                                                          59760002
NEWDPSCN EQU   64                                                       59790002
NEWDUMP  LA    R14,MAP4            POINT RETURN FROM AMDPRSYN    Y02006 59820002
*                                  TO MAP4                       Y02006 59830002
         OI    SWC,SETFLSH         INDICATE TO SET FLUSHMODE IF  Y02006 59840002
*                                  ERROR OCCURS                  Y02006 59842002
         MVC   INDD(8),TAPEDD      START WITH DEFALT VALUES             59850002
         MVC   FILESEQ(2),ONEA     FILE 1                               59880002
         CH    R2,FOUR             TEST FOR DELIMITER OF COMMA          59940002
         BE    NEWDPGO1            COMMA - GO SCAN FOR NEXT VERB        59970002
         CH    R2,TWELVE           NOT COMMA, THEN MUST BE BLANK        60000002
         BNE   SYNTAXB             OTHERWISE, SYNTAX ERROR              60030002
         LA    R4,NEWSYNA          POINT TO SYNTAX ERROR MESSAGE ADDR'S 60060002
         ST    R4,SYNMSGA          STORE IN COMMON                      60090002
         LA    R4,WTORMSG+71       COMPUTE NUMBER                Y02006 60120002
         S     R4,VERBEND          OF BYTES REMAINING                   60150002
*                                  IN BUFFER                            60180002
         BZ    NEWDPGO2            LAST ON CARD, USE DEFAULT BY BRANCH  60210002
*                                  BACK TO GET CONTROL CARD             60240002
         BM    SYNTAX              NEGATIVE MEANS PROBLEM               60270002
         BCTR  R4,0                DECREMENT 1 FOR EXECUTE              60300002
         L     R1,VERBEND          GET SCAN START ADDRESS               60330002
         SR    R2,R2               CLEAR DELIMITER REG                  60360002
         EX    R4,NBLNKTRT         LOOK FOR KEYWORDS                    60390002
*                                  USE DEFAULTS IN CASE OF NO OPERANDS  60420002
         BC    8,NEWDPGO2          BRANCH TO READ NEXT CARD             60450002
         ST    R1,KYWDBGN          SAVE BEGINNING ADDRESS OF KEYWORDS   60480002
NEWDUMP1 SR    R2,R2               CLEAR DELIMITER REGISTER             60510002
         TRT   0(72,R1),BLNK       SCAN FOR NEXT DELIMITER       Y02006 60540002
         BZ    SYNTAXA             KEYWORD TOO LONG                     60570002
         ST    R1,KYWDEND          SAVE PTR TO DELIMITER                60600002
         ST    R2,DELIMCD          SAVE DELIMITER CODE                  60630002
         CH    R2,EIGHT            VERIFY EQUAL SIGN                    60660002
         BNE   SYNTAXB             SYNTAX ERROR IF NOT                  60690002
         L     R4,KYWDBGN          POINT TO KEYWORD FOR COMPARES        60720002
         SR    R1,R4               COMPUTE LENGTH OF KEYWORD            60750002
         BNP   SYNTAX              NOT POSITIVE IS SYNTAX ERROR         60780002
         CH    R1,EIGHT            KEYWORD LONGER THAN 8 CHAR    Y02006 60800002
         BH    SYNTAXA             GO ISSUE ERROR MESSAGE        Y02006 60802002
         BCTR  R1,0                DECREMENT 1 FOR EXECUTE              60810002
         LA    R3,NEWFILOP                                              60840002
         LTR   R1,R1               LENGTH = 1                    Y02006 60850002
         BE    FILECOMP            YES, OK TO COMPARE            Y02006 60860002
         C     R1,SIX              LENGTH = 7                    Y02006 60862002
         BNE   CHKDD               NO - NOT FILESEQ              Y02006 60864002
FILECOMP EX    R1,COMPARE          IS KEYWORD 'FILESEQ'          Y02006 60870002
         BE    NEWFILE             YES                                  60900002
CHKDD    LA    R3,NEWDDOP                                        Y02006 60930002
         CH    R1,ONEA             LENGTH = 2                    Y02006 60940002
         BE    DDCOMP              YES , OK TO COMPARE           Y02006 60950002
         CH    R1,FIVE             LENGTH = 6                    Y02006 60952002
         BNE   SYNTAXC             NO - NOT DDNAME               Y02006 60954002
DDCOMP   EX    R1,COMPARE          IS KEYWORD 'DDNAME'           Y02006 60960002
         BE    NEWDD               YES                                  60990002
         B     SYNTAXC             INVALID KEYWORD                      61020002
         SPACE                                                          61050002
NEWTDUMP LA    R14,MAP4            POINT RETURN FROM AMDPRSYN    Y02006 61080002
*                                  TO MAP4                       Y02006 61090002
         OI    SWC,SETFLSH         INDICATE TO SET FLUSHMODE IF  Y02006 61100002
*                                  ERROR OCCURS                  Y02006 61102002
         MVC   INDD(8),TAPEDD      OLD 'NEWTAPE' GETS DEFAULT VALUES    61110002
         MVC   FILESEQ(2),ONEA     FILE 1                               61140002
         CH    R2,FOUR             TEST FOR COMMA                       61200002
         BE    NEWDPGO1            IF SO GO SCAN FOR NEXT VERB          61230002
         CH    R2,TWELVE           IF NOT COMMA, MUST BE BLANK          61260002
         BNE   SYNTAXB             OTHERWISE, INVALID DELIMITER         61290002
         B     NEWDPGO2            OK, GO GET NEXT CONTROL STMT.        61320002
         SPACE 2                                                        61350002
***  DDNAME SPECIFIED  ***                                              61380002
NEWDD    BAL   R3,NEWISOLT         GO ISOLATE VALUE OF KEYWORD PARM     61410002
*                                  R1 - LENGTH, R2 - PTR TO VALUE       61440002
         MVC   INDD(8),BLANKS      CLEAR DDNAME SLOT                    61470002
         BCTR  R1,0                DECREMENT BY 1 FOR EXECUTE OF MVC    61500002
         LA    R7,INDD             POINT CLC TO TARGET AREA             61530002
         EX    R1,JOBMOVE          MOVE DDNAME TO COMMON                61560002
         B     NEWMORE             GO FIND NEXT KEYWORD                 61590002
         SPACE                                                          61620002
***  FILE SEQUENCE NUMBER SPECIFIED  ***                                61650002
NEWFILE  BAL   R3,NEWISOLT         ISOLATE KEYWORD VALUE                61680002
*                                  R1 - LENGTH, R2 - PTR TO VALUE       61710002
         BAL   R3,NEWCONV          GO CONVERT TO BINARY VALUE           61740002
         STH   R2,FILESEQ          STORE NUMBER IN COMMON               61770002
         B     NEWMORE             GO SEE ABOUT NEXT KEYWORD            61800002
         SPACE                                                          62040002
***  TEST FOR MORE KEYWORDS ON NEWDUMP CARD  ***                        62070002
NEWMORE  L     R2,DELIMCD          FETCH DELIMITER CODE                 62100002
         CH    R2,TWELVE           TEST FOR BLANK - ALL DONE WITH       62130002
*                                  NEWDUMP                              62160002
         BE    NEWDPGO2            GO GET NEXT CONTROL STMT             62190002
*                                  NOT BLANK, MUST BE COMMA OR NEWISOLT 62220002
*                                  WOULD HAVE CAUGHT IT - CONTINUE      62250002
         L     R1,KYWDEND          POINT TO BEGINNING OF NEXT KEYWORD   62280002
         AH    R1,ONEA             BY INCREMENTING PAST DELIMITER       62310002
         ST    R1,KYWDBGN          STORE IN KEYWORD BEGIN POINTER       62340002
         B     NEWDUMP1            RESTART SCAN                         62370002
         SPACE                                                          62400002
***  ISOLATE KEYWORD VALUE  ***                                         62430002
NEWISOLT L     R4,KYWDEND          POINT TO BEGINNING OF VALUE BY       62460002
         AH    R4,ONEA             INCR. PAST DELIMITER                 62490002
         SR    R2,R2               CLEAR DELIMITER REG                  62520002
         TRT   0(72,R4),BLNK       SCAN FOR COMMA OR BLANK AT    Y02006 62550002
*                                  END OF KEYWORD VALUE                 62580002
         BZ    SYNTAXD             TOO LONG                             62610002
         ST    R1,KYWDEND          SAVE ENDING ADDRESS                  62640002
         ST    R2,DELIMCD          SAVE DELIMITER CODE                  62670002
         CH    R2,FOUR             TEST FOR COMMA                       62700002
         BE    NEWDUMP3            COMMA IS OK                          62730002
         CH    R2,TWELVE           TEST FOR BLANK                       62760002
         BNE   SYNTAXB             SYNTAX ERROR                         62790002
NEWDUMP3 SR    R1,R4               COMPUTE LENGTH OF VALUE              62820002
         BZ    NEWMORE             NO VALUE - USE DEFAULT        X01980 62850002
         CH    R1,EIGHT            LENGTH GREATER THAN 8         Y02006 62860002
         BH    SYNTAXD             YES - ISSUE MESSAGE           Y02006 62870002
         LR    R2,R4               POINT TO BEGINNING OF VALUE          62880002
         BR    R3                  RETURN                               62910002
         SPACE                                                          62940002
***  CONVERT DECIMAL NUMBER TO BINARY  ***                              62970002
NEWCONV  LR    R4,R2               SAVE SOURCE POINTER                  63000002
         LR    R8,R1               SAVE LENGHT                          63030002
NEWCONV1 TM    0(R4),X'F0'         TEST FOR ZONES OF 'F'         A48717 63060002
         BNO   SYNTAXD             INVALID VALUE IF NOT                 63090002
         LA    R4,1(R4)            INCREMENT TO NEXT DIGIT              63120002
         BCT   R8,NEWCONV1         LOOP ON VALUE LENGTH          A48717 63150002
         LR    R8,R2               POINT TO SOURCE FOR PACK             63180002
         BCTR  R1,0                DECREMENT 1 FOR EXECUTE              63210002
         EX    R1,NEWPACK          PACK TO WORK1                        63240002
         CVB   R2,WORK1            CONVERT TO FIXED-POINT BINARY        63270002
         CH    R2,ONEA             VERIFY THAT NUMBER IS NOT ZERO       63300002
         BL    SYNTAXD             BRANCH TO ISSUE MESSAGE IF SO        63330002
         BR    R3                  RETURN                               63360002
         SPACE                                                          63390002
*** CARRY OUT NEWDUMP PROCEDURES  ***                                   63420002
NEWDPGO1 OI    MSCSW,NEWDPSCN      DELIMITER WAS COMMA                  63450002
         B     NEWDPGO             CONTINUE PROCESSING                  63480002
NEWDPGO2 NI    MSCSW,XFF-NEWDPSCN  DELIMITER WAS BLANK                  63510002
NEWDPGO  EQU   *                                                 Y02006 63540002
NEWTSTMS DEVTYPE  INDD,DEVAREA     OBTAIN DEVICE TYPE OF NEW INDD       63660002
         LTR   R15,R15             NO DD CARD -                         63690002
         BZ    DDPRES              DD CARD PRESENT GO SEE WHAT DEVICE   63720002
         LA    R4,ANODD            POINT TO NO DD MESSAGE AD            63750002
         ST    R4,SYNMSGA          STORE IN COMMON CSECT                63780002
         TM    MSCSW,NEWDPSCN      TEST FOR ENDING ACTION        Y01980 63830002
         LA    R14,MAP2            TO CONTINUE SCAN OF THIS CARD Y01980 63840002
         BO    ITSMAP2             YES                           Y01980 63850002
         LA    R14,MAP4            TO READ ANOTHER CARD          Y01980 63860002
ITSMAP2  L     R15,ASYNTAX         GET @ OF SYNTAX WRITER        Y01980 63862002
         B     SYNTAXA             BRANCH TO WRITE MESSAGE              63870002
DDPRES   CLI   DEVAREA+2,X'80'     TEST FOR TAPE                        63900002
         BE    CLOSESEQ            BRANCH IF TAPE                Y02006 63930002
***  NEW DD CARD POINTS TO D/A DATA SET  ***                            64480002
DAINPUT  L     R15,ASYNTAX         GET ADDRESS OF SYNTAX WRITER         64490002
         CLC   FILESEQ(2),ONEA     TEST FOR FILESEQ NUMBER SPECIFIED    64492002
*                                  FOR A D/A INPUT DEVICE               64494002
         BNE   SYNTAXE             GIVE ERROR MESSAGE IF NOT 1          64496002
CLOSESEQ LA    R3,AINDCB           LOAD @ OF DCB ADDRESSES       Y01980 64517902
SEQLOOP1 L     R4,0(R3)            LOAD DCB @                    Y01980 64518302
         LA    R4,0(R4)            CLEAR POSSIBLE HI-ORDER BYTE  Y01980 64518702
         LTR   R4,R4               HAS @ DCB BEEN STORED?        Y01980 64519102
         BZ    SEQLOOP2            NO- CONTINUE                  Y01980 64519502
         TM    DCBOFLGS(R4),DCBOPEN IS THIS DCB OPEN?            Y01980 64519602
         BZ    SEQLOOP2            NO- DO NOT CLOSE              Y01980 64519702
         CLOSE ((R4))              CLOSE THIS DCB                Y01980 64519802
SEQLOOP2 TM    0(R3),X'80'         LAST ENTRY IN DCB LIST?       Y01980 64526502
         BO    NEWRESET            YES                           Y02006 64528502
         LA    R3,4(R3)            STEP TO NEXT DCB @            Y01980 64530502
         B     SEQLOOP1            CONTINUE                      Y01980 64532502
         SPACE                                                          65730002
***  RESET SWITCHES AND DUMP INFO IN COMMON CSECT  ***                  65760002
NEWRESET NI    SWC,XFF-MSTRSW      INDICATE GET-MASTER ROUTINE IS       65790002
*                                  REQUIRED                             65820002
         OI    SWC,POSITSW         INPUT POSITIONING REQUIRED    Y02006 65830002
         OI    SWE,BUILDMAP        DUMP DS MUST BE SCANNED       Y02006 65840002
*                                  AND MAPPED                    Y02006 65842002
         NI    SWD,XFF-FLSHMODE    RESET FLUSH MODE FOR RETRY           65850002
         NI    SWA,XFF-SETCVTSW    RESET CVT BY OPERATOR SWITCH         65880002
         XC    CVTADDR,CVTADDR     RESET CVT POINTER                    66090002
         NI    PRSW,XFF-QSEGTBSW   RESET SEGTAB SW               X01980 66092002
         MVI   SWF,X'00'           RESET SWF                     Y01980 66100002
         XC    SEGTABOR,SEGTABOR   ZERO SEGTAB ADDRESS           Y02006 66100402
         MVI   TITLEMSG,BLANK      BLANK OUT TITLE IN HEADER   @OZ24196 66100500
         MVC   TITLEMSG+1(63),TITLEMSG                         @OZ24196 66100600
         MVC   TITLEMOD+7(8),BLANKS  BLANK MODULE NAME FIELD     Y02006 66100802
         MVC   TITLEDTE+5(8),BLANKS  BLANK DATE FIELD            Y02006 66101202
         MVC   TITLETME+5(8),BLANKS  BLANK TIME                  Y02006 66101602
         XC    SACSWCAW(12),SACSWCAW  ZERO SADMP HDR FIELDS      Y02006 66101702
         XC    HDRREGS(168),HDRREGS  ZERO DSS/SVC HDR FIELDS     Y02006 66101802
         MVI   HDRTITLE,BLANK      BLANK HDR TITLE               Y02006 66101902
         MVC   HDRTITLE+1(99),HDRTITLE                           Y02006 66104902
         XC    AUSRTCBA(4),AUSRTCBA  ZERO USER TCB ADDRESS       Y02006 66106902
         XC    AUSRASID(2),AUSRASID  ZERO USER ASID FIELD        Y02006 66107302
         XC    QASID(2),QASID      RESET ASID                    Y02006 66108002
         XC    IPLCPU,IPLCPU       RESET IPL CPU ADDRESS         Y02006 66111002
         NI    SWC,XFF-SETFLSH     RESET SET FLUSHMODE INDICATOR Y02006 66114002
         TM    MSCSW,NEWDPSCN      TEST FOR NEW DUMP ENDING ACTION      66130002
         BO    MAP2                CONTINUE SCAN OF THIS CARD           66140002
         B     MAP4                GO READ ANOTHER CARD                 66142002
         EJECT                                                          66150002
*********************************************************************** 66180002
*                                                                     * 66210002
**        ***  ERROR RETURN FROM READ  ROUTINES  ***                 ** 66240002
*                                                                     * 66270002
*********************************************************************** 66300002
         SPACE                                                          66330002
         DROP  R13                                                      66340002
         USING *,R15                                                    66360002
ERRMSG   LA    R13,MSCSAVE         POINT TO INIT'S SAVE AREA            66390002
         LM    R14,R12,12(R13)     RESTORE OUR REGS                     66420002
         USING MSCBASE,BASE1       SHIFT BACK TO REG 11 AS BASE         66450002
         DROP  R15                                                      66480002
         USING MSCSAVE,R13         RESTORE DATA AREA BASE        X01980 66490002
         SPACE                                                          66510002
NOT2     TM    BUFSW,PREFM         TEST FOR PRE-FORMATTED DUMP   X01980 66600002
         BZ    NOPREFMT            BRANCH IF NOT                   B-PT 66630002
         NI    BUFSW,XFF-PREFM     RESET INDICATOR                      66660002
*                                  WRITE PRE-FORMATTED DUMP MSG ON      66690002
         BRPRTMSG  PREFMSG+4,65    SYSPRINT                             66720002
         LA    R1,PREFMSG          POINT TO WTO LIST             A39011 66750002
TSTRDR   TM    SWA,RDRSW           TEST FOR SOURCE OF CONTROL    Y02006 66840002
*                                  CARDS                         A39011 66870002
         BO    ERRMSGC3            SW ON MEANS CARD READER, SO DON'T    66900002
*                                  WRITE TO CONSOLE                     66930002
         WTO   MF=(E,(1))          WRITE MESSAGE TO OPERATOR     A39011 66960002
         B     ERRMSGC3            EXIT TO GET NEXT CONTROL CARD        66990002
NOPREFMT TM    SWB,IOERR           IS I/O ERROR SW ON              B-PT 67020002
         BZ    NOPOSIT             BR IF NO                        B-PT 67050002
         MVC   ERRWTO+4(26),MSG2   MOVE ERROR MSG TO WTO           B-PT 67080002
         B     ERRMSGC             CONTINUE PROCESSING             B-PT 67110002
NOPOSIT  TM    SWC,POSITSW         TEST FOR POSIT IN PROGRESS      B-PT 67140002
         BZ    ERRFMT              BRANCH IF NOT                 Y02006 67170002
ORIGTAPE EQU   *                                                        67440002
         MVC   NODUMPMG+37(8),INDD MOVE OFFENDING DD NAME TO MSG A39011 67470002
         BRPRTMSG  NODUMPMG+4,41   WRITE MESSAGE ON SYSPRINT     A39011 67500002
         LA    R1,NODUMPMG         POINT TO WTO LIST             A39011 67530002
         TM    RETCODE,XFF         RETURN CODE SET              OZ12030 67536000
         BM    SKIPSET             YES - KEEP CURRENT CODE      OZ12030 67542000
         OI    RETCODE,X'04'       SET RETURN CODE 4            OZ12030 67548000
SKIPSET  EQU   *                                                OZ12030 67554000
         B     TSTRDR              BRANCH TO ISSUE WTO AND       A39011 67560002
*                                  EXIT FROM ERROR PROCEDURE     A39011 67590002
ERRFMT   TM    SWB,FMTERR          IS FORMAT ERROR SW ON                67950002
         BZ    ERRMSGC3            BR IF NO                             67980002
         MVC   ERRWTO+4(26),MSG1   MOVE ERROR MSG TO WTO                68010002
         SPACE                                                          68100002
ERRMSGC  DS    0H                                                       68130002
ERRMSGC2 BRPRTMSG ERRWTO+4,26      PRINT ERROR MSG ON SYSPRINT   Y02006 68490002
         TM    SWA,RDRSW           IS READER SW ON                      68520002
         BO    ERRMSGC3            DO NOT WRITE TO OPER IF IT IS        68550002
         WTO   MF=(E,ERRWTO)                                            68580002
ERRMSGC3 EQU   *                                                        68610002
         TM    SWB,ENDSW           TEST FOR PROCESSING END CARD   M1153 68670002
         BZ    ERRSELEC            BRANCH IF NOT TO TAKE ERROR    M1153 68700002
*                                  ACTION                         M1153 68730002
*                                  IN CASE OF END CARD TERMINATE  M1153 68760002
         L     R15,AEREXIT         POINT TO EXIT ROUTINE          M1153 68790002
         LA    R1,4                SET TERMINATION CODE           M1153 68820002
         BALR  RETREG,R15          BRANCH TO EXIT ROUTINE         M1153 68850002
ERRSELEC OI    SWC,SETFLSH         SET FLUSHMODE                  M1153 68900002
         XC    SYNMSGA(4),SYNMSGA  ZERO SYNMSGA                  Y02006 68902002
         L     R15,ASYNTAX         MESSAGE WRITER ADDRESS        Y02006 68904002
         USING SYNEPS,R15                                        Y02006 68904402
         BAL   RETREG,SYNTAX       ISSUE FLUSH MSG AND SET       Y02006 68906002
*                                  FLUSHMODE                     Y02006 68908002
         NI    BUFSW,XFF-PREFM     RESET PRE-FORMATTED SWITCH    Y02006 68908402
         NI    SWB,XFF-IOERR-FMTERR RESET I/O AND FORMAT ERROR SWITCHES 68910002
*                                                                Y02006 68920002
INITOK   L     R1,VERBGN           LOAD VERB ADDRESS            @YM3679 69070002
         CLC   0(2,R1),ECOMMA      CONTINUE TO SCAN CARD AT     @YM3679 69070202
         BE    MAP3                MAP3 OR MAP4 FOR OTHER VERBS @YM3679 69070402
         CLC   0(5,R1),EDITCOM     IF HIT ON EDIT VERB SIGNAL,  @YM3679 69070602
         BE    MAP3                AS FOLLOWS -                 @YM3679 69070802
         CLC   0(2,R1),EBLANK        E, OR EDIT, TO MAP3        @YM3679 69071002
         BE    MAP4                  E$ OR EDIT$ TO MAP4        @YM3679 69071202
         CLC   0(5,R1),EDITBLK     WHERE $=BLANK CHARACTER      @YM3679 69071402
         BE    MAP4                                             @YM3679 69071602
         L     R1,KYWDBGN          LOAD KEYWORD ADDRESS                 69071802
         LTR   R1,R1               IS ADDRESS ZERO               Y02006 69072002
         BNZ   PRINT1              NO - GO RESCAN KEYWORD        Y02006 69080002
         L     R1,VERBGN           LOAD VERB ADDRESS             Y02006 69110002
         B     CK4PRST             BRANCH BACK TO MAIN ROUTINE   Y02006 69120002
*                                  TO RESCAN CURRENT VERB        Y02006 69170002
ECOMMA   DC    C'E,'               LEGAL                        @YM3679 69178002
EDITCOM  DC    C'EDIT,'               VARATIONS                 @YM3679 69186002
EBLANK   DC    C'E '                         OF THE             @YM3679 69194002
EDITBLK  DC    C'EDIT '                          EDIT VERB      @YM3679 69202002
         SPACE 2                                                        69210002
ERRWTO   DC    AL2(30)             WTO LIST FORM                 X01980 69510002
         DC    X'8000'                                                  69540002
         DC    CL26' '                                                  69570002
         DC    X'0200'             DESC                                 69600002
         DC    X'4000'             ROUTCDE                              69630002
         EJECT                                                          69660002
*********************************************************************** 69690002
*                                                                     * 69720002
*  FINAL STOP EXIT ROUTINE                                            * 69750002
*                                                                     * 69780002
*********************************************************************** 69810002
         SPACE                                                          69840002
         DS    0H                                                       69870002
         DROP  R13                                                      69880002
         USING *,R15               BASE ON REG 15 UNTIL REGS CAN        69900002
*                                  BE RELOADED                          69930002
STOPCMP  LA    R13,MSCSAVE                                              69960002
         LM    R14,R12,12(R13)     RESTORE MSC'S REGS                   69990002
         USING MSCBASE,BASE1       SHIFT BACK TO REG 11 AS BASE         70020002
         DROP  R15                                                      70050002
         USING MSCSAVE,R13         RESTORE DATA AREA BASE        YM1454 70060002
         SPACE                                                          70080002
         SR    R2,R2               INDICATE REMOVAL OF ALL TCBS         70110002
         L     R15,ATCBREMV        POINT TO TCB REMOVE ROUTINE          70140002
         BALR  RETREG,R15          LINK TO IT                           70170002
         B     MAP2                CONTINUE SCAN                        70200002
         EJECT                                                          70230002
*  EXECUTABLE INSTRUCTIONS                                              70260002
         SPACE                                                          70290002
STRGTR   TR    0(0,R1),HEXTABL                                          70320002
STRGPACK PACK  WORK1(0),0(0,R1)                                         70350002
TITLCARD MVC   TITLEMSG(0),0(R1)                                        70380002
COMPARE  CLC   0(0,R4),0(R3)                                            70410002
JOBMOVE  MVC   0(0,R7),0(R2)                                            70440002
NBLNKTRT TRT   0(0,R1),NONBLNK                                          70470002
         SPACE                                                          70500002
NEWPACK  PACK  WORK1(8),0(0,R8)                                         70530002
         EJECT                                                          70560002
*********************************************************************** 70590002
*                                                                     * 70620002
*   CONSTANTS FOR SCAN                                                * 70650002
*                                                                     * 70680002
*********************************************************************** 70710002
         SPACE                                                          70740002
MSCSAVE  DC    18F'0'              SAVE AREA FOR INIT                   70770002
C13      DC    H'13'                                             XM5890 70780002
LPAPATH  DC    X'80',CL3'LPA'      PATH DESCRIPTOR FOR LPA MAP          70800002
FMTPATH  DC    X'00',CL3'FAR'      PATH DESC. FOR FORMATTING     Y02006 70860002
         DC    X'00',CL3'FSR'      SYSTEM CONTROL BLOCKS FOR ALL Y02006 70890002
         DC    X'80',CL3'FXT'      TASKS                                70920002
*                                  PATH DESCRIPTOR FOR PRINT STORAGE    71040002
PRTPATH  DC    X'00',CL3'DPS'      BY ABSOLUTE ADDRESS OR NUCLEUS & SQA 71070002
         DC    X'80',CL3' '        PATH END FILLED IN BY PRINT SCAN     71100002
PMS      DC    C'PMS'              ID FOR ABSOLUTE STORAGE EXECUTOR     71250002
NUC      DC    C'NUC'              ID FOR PRINT NUCLEUS AND SQA         71280002
*                                  EXECUTOR                             71310002
PJB      DC    C'PJB'              ID FOR PRINT JOBNAME REQUEST  Y02006 71320002
FPRTPATH DC    X'00',CL3'DPS'      PATH DESCRIPTOR FOR PRINT STORAGE    71370002
         DC    X'00',CL3'FAR'      BY JOBNAME OR CURRENT         Y02006 71400002
         DC    X'00',CL3'FSR'                                    Y02006 71430002
         DC    X'00',CL3'FUB'                                    Y02006 71440002
         DC    X'80',CL3' '        PATH END FILLED IN BY PRINT SCAN     71460002
EDIT1    DC    X'00',CL3'OOT'      PATH FOR EDIT SCAN PHASE      S21014 71640002
         DC    X'80',CL3'SCN'                                    S21014 71670002
EDIT2    DC    X'00',CL3'OOT'      PATH FOR EDIT EXECUTION       S21014 71700002
         DC    X'80',CL3'XED'                                    S21014 71730002
CUR      DC    C'PCR'                                                   71790002
SUMPATH  DC    X'80',CL3'SUM'      PATH DESCRIPTOR FOR SUMMARY   Y02006 71830002
DISPATH  DC    X'80',CL3'FDS'                                  @Y30MIBS 71835000
CPUDPATH DC    X'00',CL3'DPS'      PATH DESCRIPTOR FOR CPUDATA   Y02006 71840002
         DC    X'80',CL3'GCD'                                    Y02006 71842002
MSCSW    DS    C                   BIT 0 - NEWDDSW                      71850002
*                                      1 - NEWDPSCN                     71880002
*                                      2 - NEWDMPDD                     71910002
EDDELIM  DS    C                   SAVE AREA FOR DELIM CODE             71940002
*                                  AFTER EDIT VERB                      71970002
DEVAREA  DC    D'0'                                                     72000002
AUTONGO  DC    X'80'               FLAG TO INDICATE AUTO ONGO OPER      72030002
         DC    AL3(AUTOPER)        ADDR OF AUTO ONGO OPERAND            72060002
AEDITSCN DC    A(0)                ADDRESS OF EDIT SCAN MODULE   S21014 72090002
WRTSYNA  DC    V(WRTSYN1)                                               72120002
         DC    V(WRTSYN2)                                               72150002
         DC    V(WRTSYN3)                                               72180002
         DC    V(PRTSYN4)                                               72210002
         DC    V(C72MSG)                                         Y02006 72240002
PRTSYNA  DC    V(PRTSYN1)                                               72270002
         DC    V(PRTSYN2)                                               72300002
         DC    V(PRTSYN3)                                               72330002
NEWSYNA  DC    V(PRTSYN1)          ERROR MESSAGES USED BY NEWDUMP       72360002
         DC    V(PRTSYN2)                                               72390002
         DC    V(PRTSYN3)                                               72420002
         DC    V(NEWSYN1)                                               72450002
         DC    V(FILERMSG)                                              72480002
GOSYNA   DC    V(GOSYN1)                                                72510002
CVTSYNA  DC    V(CVTSYN1)                                               72540002
         DC    V(PRTSYN2)                                               72570002
SEGSYNA  DC    V(SEGSYN1)                                        X01980 72580002
         DC    V(PRTSYN2)                                        X01980 72590002
PREFMSGA DC    A(PREFMSG)                                               72600002
ANODD    DC    V(NODDMSG)                                               72660002
CUROP    DC    C'CURRENT'                                               72750002
ONGOVRB  DC    C'ONGO'                                                  72780002
CVTPARM  DC    C'CVT'                                                   72840002
SGTBPARM DC    C'SEGTAB'                                         X01980 72850002
TAPENM   DC    CL8'TAPE'                                                72960002
GOVERB   DC    C'GO'                                                    72990002
PRNTVERB DC    C'PRINT'                                                 73020002
ENDVERB  DC    C'END'                                                   73050002
STOROP   DC    C'STORAGE'                                               73080002
REALOP   DC    C'REAL'                                           X01980 73140002
JOBOP    DC    C'JOBNAME'                                               73170002
NUCOP    DC    C'NUCLEUS'                                               73230002
CSAOP    DC    C'CSA'                                            Y02006 73240002
SQAOP    DC    C'SQA'                                            Y02006 73250002
NEWTVERB DC    C'NEWTAPE'                                               73260002
NEWVERB  DC    C'NEWDUMP'                                               73290002
NEWVERBA DC    C'ND'               ABRV. FOR NEWDUMP                    73320002
MAPPARM  DC    C'LPAMAP'                                                73350002
FMTPARM  DC    C'FORMAT'                                                73380002
NEWDDOP  DC    C'DDNAME'                                                73470002
NEWFILOP DC    C'FILESEQ'                                               73500002
NEWDMPOP DC    C'DUMPSEQ'                                               73530002
EDITVERB DC    C'EDIT'             EDIT VERB                     S21014 73560002
SUMVERB  DC    C'SUMMARY'                                        Y02006 73570002
CPUDVERB DC    C'CPUDATA'                                        Y02006 73580002
DISPVERB DC    C'DISPLAY'                                      @Y30MIBS 73585000
TAPEDD   DC    CL8'TAPE'                                                73590002
         EJECT                                                          73890002
*********************************************************************** 73920002
*                                                                     * 73950002
*   ERROR MESSAGES                                                    * 73980002
*                                                                     * 74010002
*********************************************************************** 74040002
         SPACE                                                          74070002
*                                  AUTO ONGO OPERAND                    74100002
AUTOPER  WTO   '        EDIT,SUMMARY,PRINT CURRENT',MF=L,ROUTCDE=(2),  X74130002
               DESC=7                                            Y02006 74140002
PREFMSG  WTO   'AMD164I TAPE IS PRE-FORMATTED DUMP - REMAINING PARAMETEX74160002
               RS IGNORED',MF=L,ROUTCDE=(2),DESC=7               X01980 74190002
NODUMPMG WTO   'AMD168I DUMP DATA SET EMPTY - DD XXXXXXXX',      A39011*74220002
               MF=L,ROUTCDE=(2),DESC=7                           X01980 74250002
         SPACE                                                          74280002
         DROP  BASE1                                                    74310002
         DROP  R13                                               X01980 74320002
         EJECT                                                          74340002
AMDPREND CSECT                                                   X01980 74370002
         SPACE                                                          74400002
*********************************************************************** 74430002
*                                                                     * 74460002
**                        ****   E N D   ****                        ** 74490002
*                                                                     * 74520002
*********************************************************************** 74550002
         SPACE                                                          74580002
         USING *,R15                                             Y02006 74590002
         MODID                                                   Y02006 74600002
         DROP  R15                                               Y02006 74602002
         STM   R14,R12,12(R13)     SAVE CALLER'S REGS                   74610002
         BALR  BASE1,0             ESTABLISH REG 11 AS BASE             74640002
         USING *,BASE1                                                  74670002
         LA    R2,ENDSAVE          SAVE AREA CHAINING                   74700002
         ST    R13,ENDSAVE+4                                            74730002
         ST    R2,8(R13)                                                74760002
         LR    R13,R2              ENTRY COMPLETE                       74790002
         SPACE                                                          74820002
END      OI    SWB,ENDSW           SET END SWITCH                       74850002
         TM    SWD,NOLOADSW        LOAD MODE                     X01980 74880002
         BO    ENDSTAT0            GO PRINT STATISTICS           X01980 74910002
         SR    PREG,PREG           ZERO INIT REQUIREMENT         X01980 74970002
         BRREAD  INIT                                            Y02006 75000002
         B     EXITOUT             SKIP STATISTICS IN LOAD MODE  X01980 75030002
ENDSTAT0 BRPRTMSG ,0               SPACE                                75060002
         BRPRTMSG ,(R2)            TWO LINES                            75090002
         L     R3,RDENTRY          NO OF ENTRIES TO READ ROUTINE        75120002
         CVD   R3,WORK1            CONVERT TO DECIMAL                   75150002
         UNPK  ENDMSG1+36(10),WORK1 UNPACK TO MSG                       75180002
         OI    ENDMSG1+45,X'F0'    MAKE SIGN 'F'                        75210002
         BRPRTMSG ENDMSG1,46       PRINT MSG 1                          75240002
         L     R4,READTM           NO OF TIMES REQ ADDR WAS NOT IN      75270002
*                                  BUFFER ALREADY                       75300002
         CVD   R4,WORK1            CONVERT TO DECIMAL                   75330002
         UNPK  ENDMSG2+47(10),WORK1 UNPK TO MSG                         75360002
         OI    ENDMSG2+56,X'F0'    MAKE SIGN 'F'                        75390002
         BRPRTMSG ENDMSG2,57       PRINT MSG                            75420002
         LTR   R3,R3               TEST R3 FOR ZERO                     75450002
         BNZ   ENDSTAT1            BR IF NOT                            75480002
ENDSTAT3 SR    R5,R5               YES--CLEAR R5 FOR RATIO OF 0 TO 1    75510002
         B     ENDSTAT2            CONTINUE--WITHOUT DIVIDE             75540002
ENDSTAT4 LA    R5,1                LOAD FOR A RATIO OF 1 TO 1           75570002
         B     ENDSTAT2            CONTINUE--WITHOUT DIVIDE             75600002
ENDSTAT5 LA    R5,999              RATIO OF 999 TO 1                    75630002
         B     ENDSTAT2            CONTINUE--WITHOUT DIVIDE             75660002
ENDSTAT1 CR    R3,R4               COMPARE R3 TO R4                     75690002
         BL    ENDSTAT3            RATIO OF 0 TO 1 IF LOW               75720002
         BE    ENDSTAT4            RATIO OF 1 TO 1 IF EQUAL             75750002
         LTR   R4,R4               TEST FOR ZERO                        75780002
         BZ    ENDSTAT5            YES--AVOID DIVIDE                    75810002
         SR    R2,R2               SET UP FOR DIVIDE                    75840002
         DR    R2,R4               DIVIDE NO OF ENTRIES BY NO OF REQ    75870002
*                                  READS                                75900002
         LR    R5,R3               SAVE RESULT IN R5                    75930002
ENDSTAT2 EQU   *                                                        75960002
         L     R3,READNO           NO OF BLOCKS READ                    75990002
         CVD   R3,WORK1            CONVERT TO DECIMAL                   76020002
         UNPK  ENDMSG3+24(10),WORK1 UNPK INTO MSG                       76050002
         OI    ENDMSG3+33,X'F0'    MAKE SIGN 'F'                        76080002
         BRPRTMSG ENDMSG3,34       PRINT MSG                            76110002
         L     R3,RDERCNT          NO OF PERM I/O ERRS                  76140002
         CVD   R3,WORK1            CONVERT TO DECIMAL                   76170002
         UNPK  ENDMSG4+33(10),WORK1 UNPK INTO MSG                       76200002
         OI    ENDMSG4+42,X'F0'    MAKE SIGN 'F'                        76230002
         BRPRTMSG ENDMSG4,43       PRINT MSG                            76260002
         SR    R2,R2               CLEAR DIVIDE REGISTERS               76290002
         LR    R3,R2                                                    76320002
         L     R4,BUFREINT         GET COUNT OF BUFFER INITIALIZATIONS  76350002
         LTR   R4,R4               TEST FOR ZERO TO AVOID ZERO DIVIDE   76380002
         BZ    ENDSTAT6            BRANCH IF ZERO TO CONVERT            76410002
         L     R3,BUFSUM           LOAD TOTAL NUMBER OF BUFFERS         76440002
*                                  FOR THIS EXECUTION                   76470002
         DR    R2,R4               COMPUTE AVERAGE                      76500002
ENDSTAT6 CVD   R3,WORK1            CONVERT QUOTIENT TO DECIMAL          76530002
         UNPK  ENDMSG6+41(4),WORK1+5(3)                                 76560002
         OI    ENDMSG6+44,X'F0'                                         76590002
         LTR   R3,R2               TEST FOR ZERO REMAINDER              76620002
         BZ    ENDSTAT7            BRANCH IF SO TO AVOID ZERO DIVIDE    76650002
         MH    R2,HTEN             MULTIPLY BY 10 -                     76680002
         MH    R2,HTEN             10 AGAIN TO MAKE 100                 76710002
         LR    R3,R2               LOAD FOR DIVIDE                      76740002
         SR    R2,R2               CLEAR REMAINDER REG                  76770002
         DR    R2,R4               DIVIDE TO GET FRACTION DIGITS        76800002
ENDSTAT7 CVD   R3,WORK1            CONVERT FRACTION DIGITS              76830002
         UNPK  ENDMSG6+46(2),WORK1+6(2)                                 76860002
         OI    ENDMSG6+47,X'F0'                                         76890002
         BRPRTMSG  ENDMSG6,L'ENDMSG6                                    76920002
         BRPRTMSG ,0               SPACE A LINE                         76950002
         CVD   R5,WORK1            RATIO OF RDENTRY TO READTM           76980002
         UNPK  ENDMSG5+28(3),WORK1+6(2)                                 77010002
         OI    ENDMSG5+30,X'F0'                                         77040002
         BRPRTMSG ENDMSG5,36       PRINT MSG                            77070002
         L     R2,TRCCOUNT         LOAD TRACE RECORD COUNT       S21014 77100002
         CVD   R2,WORK1            CONVERT COUNT                 S21014 77130002
         UNPK  ENDMSG7+40(10),WORK1  UNPACK TO EBCDIC            S21014 77160002
         OI    ENDMSG7+49,X'F0'    CORRECT ZONE                  S21014 77190002
         BRPRTMSG  ,0              SPACE A LINE                  S21014 77220002
         BRPRTMSG  ENDMSG7,L'ENDMSG7  PRINT NUMBER OF TRACE      S21014 77250002
*                                  RECORDS PROCESSED             S21014 77280002
EXITOUT  LA    R1,4                LOAD TERMINATION CODE         S21014 77310002
         L     R15,AEREXIT         POINT TO TERMINATION ROUTINE         77340002
         BALR  RETREG,R15          LINK TO IT                           77370002
         EJECT                                                          77400002
*********************************************************************** 77430002
*                                                                     * 77460002
*  CONSTANTS FOR END ROUTINE                                          * 77490002
*                                                                     * 77520002
*********************************************************************** 77550002
         SPACE                                                          77580002
ENDSAVE  DC    18F'0'              SAVE AREA FOR STIC'S ROUTINE         77610002
ENDMSG1  DC    C'1   NO OF ENTRIES TO READ ROUTINE - 0000000000'        77640002
ENDMSG2  DC    C'2   NO OF TIMES REQ ADDR WAS NOT IN A BUFFER - 0000000X77670002
               000'                                                     77700002
ENDMSG3  DC    C'3   NO OF BLOCKS READ - 0000000000'                    77730002
ENDMSG4  DC    C'4   NO OF PERMANENT I/O ERRORS - 0000000000'           77760002
ENDMSG5  DC    C'RATIO OF ITEM 1 TO ITEM 2 -     TO 1'                  77790002
ENDMSG6  DC    C'5   AVERAGE NO OF BUFFERS PER FUNCTION - 0000.00'      77820002
ENDMSG7  DC    C'6   NUMBER OF TRACE RECORDS PROCESSED - 0000000000'    77850002
*                                                                S21014 77880002
         SPACE                                                          77910002
         DROP  BASE1                                                    77940002
         EJECT                                                          77970002
AMDPRXIT CSECT                                                   X01980 78000002
         SPACE                                                          78030002
*********************************************************************** 78060002
*                                                                     * 78090002
*                         ERROR EXIT ROUTINE                          * 78120002
*                                                                     * 78150002
*  THIS ROUTINE IS ENTERED WHEN ANY CONDITION IS ENCOUNTERED IN THE   * 78180002
*  ENVIRONMENT WHICH MAKES FURTHER PROCESSING IMPOSSIBLE.             * 78210002
*                                                                     * 78240002
*   REGISTER ONE ON ENTRY CONTAINS A CODE INDICATING THE              * 78270002
*  ACTION REQUIRED:                                                   * 78300002
*                    0 - AMD150I                                 X01980 78330002
*                    4 - TERMINATE WITHOUT MESSAGE                    * 78360002
*                    12- AMD153I                                 X01980 78390002
*                                                                     * 78420002
*    REGISTER ZERO CONTAINS A DDNAME CODE IF THE MESSAGE              * 78450002
*    REQUIRE A DDNAME INSERTED:                                  X01980 78480002
*                    0 - PRINTER                                      * 78510002
*                    4 - SYSUT1                                       * 78540002
*                    8 - SYSIN                                        * 78570002
*                   12 - VARIABLE INPUT DDNAME                        * 78600002
*                   16 - SYSUT2                                       * 78630002
*                                                                     * 78660002
*********************************************************************** 78690002
         SPACE                                                          78720002
EREXIT   STM   R14,R12,12(R13)     SAVE CALLER'S REGISTERS              78750002
         BALR  BASE1,0             ESTABLISH REG 11 AS BASE             78780002
         USING *,BASE1                                                  78810002
         LA    R2,XITSAVE          SAVE AREA CHAINING            X01980 78840002
         ST    R13,XITSAVE+4                                            78870002
         ST    R2,8(R13)                                                78900002
         LR    R13,R2              ENTRY COMPLETE                       78930002
         MODID                     IDENTIFY CSECT                Y02006 78950002
         SPACE                                                          78960002
         LR    R7,R0               SAVE DDNAME DISPLACEMENT             78990002
         ST    R1,RCSTORE          SAVE MESSAGE CODE            YA01752 79000002
         LA    R8,ERBRTAB          USING REGISTER ONE AND THE BRANCH    79020002
         B     0(R8,R1)            TABLE, GO PREPARE PROPER MESSAGE     79050002
         SPACE                                                          79080002
EROPN    LA    R1,EROPEN           ERROR DURING OPEN OF DCB.            79110002
         LA    R3,ERNMTAB          POINT TO DDNAME TABLE          M1143 79140002
         L     R2,0(R3,R7)         SELECT PROPER DDNAME           M1143 79170002
         MVC   17(7,R1),0(R2)      MOVE IT TO MESSAGE             M1143 79200002
         B     ERWTO               GO WTO                        X01980 79230002
         SPACE                                                          79260002
ERIO     LA    R1,ERINIO           I/O ERROR, USING REG 0 VALUE         79290002
*                                  TO DETERMINE DDNAME FOR MESSAGE      79320002
         LA    R3,12               SCREEN OUT CASE OF VARIABLE INPUT    79350002
*                                  DDNAME                               79380002
         CR    R3,R7               CODE 12 - INPUT DD            X01980 79410002
         BE    ERIOTAPE            IF SUCH, BRANCH TO MOVE DDNAME FROM  79440002
*                                  COMMON CSECT                         79470002
         LA    R3,ERNMTAB          DISPLACEMENT INTO  DDNAME TABLE,     79500002
         L     R2,0(R3,R7)         MOVE PROPER DD NAME INTO MSG         79530002
         MVC   35(7,R1),0(R2)                                           79560002
         B     ERWTO               WRITE ERROR MESSAGE                  79590002
         SPACE                                                          79620002
ERIOTAPE MVC   35(8,R1),INDD       MOVE NAME TO MESSAGE                 79650002
*                                  FALL THROUGH TO ISSUE MESSAGE X01980 79680002
***  WRITE ERROR MESSAGE TO PROGRAMMER'S OUTPUT  ***                    79710002
ERWTO    WTO   MF=(E,(1))                                               79740002
         SPACE                                                          79770002
TERM     LA    R3,DCBADDRS         LOAD ADDR OF DCB PTRS         X01980 79800002
ENDLOOP2 L     R2,0(R3)            LOAD DCB ADDR                        79830002
         LA    R2,0(R2)            CLEAR POSSIBLE HIGH ORDER BYTE       79860002
         LTR   R2,R2               HAS DCB ADDR BEEN STORED             79890002
         BZ    ENDLOOP1            NO - CONTINUE                        79920002
         TM    DCBOFLGS(R2),DCBOPEN IS THIS DCB OPEN                    79950002
         BZ    ENDLOOP3            NO--TEST FOR BUFFER POOL             79980002
         CLOSE ((R2))              CLOSE THIS DCB                       80010002
ENDLOOP3 TM    23(R2),X'01'        TEST FOR BUFCB                       80040002
         BO    ENDLOOP1            BYPASS FREEPOOL IF NO BUFCB          80070002
         FREEPOOL (R2)             FREE BUFFER POOL                     80100002
         SPACE                                                          80130002
ENDLOOP1 TM    0(R3),X'80'         LAST ENTRY IN DCB LIST               80160002
         BO    END1                YES, GO FREE BUFFERS                 80190002
         LA    R3,4(R3)            STEP TO NEXT DCB ADDR                80220002
         B     ENDLOOP2            LOOP THROUGH ENTIRE LIST             80250002
END1     XC    CURBUF,CURBUF       ZERO BUFFER POINTER           Y02006 80430002
END2     SR    R1,R1               CLEAR COUNT REG SO THAT       X01980 80460002
*                                  ADJUST WILL SURELY WORK       X01980 80490002
         BRREAD  ADJUST              CAUSE DUMP PROCESSING       Y02006 80520002
*                                    BUFFERS TO BE FREED IF THEY X01980 80550002
*                                    EXIST                       X01980 80580002
         L     R15,AUSRDEL         GET ADDR OF USER INTERFACE    Y02006 80630002
*                                  CLEAN-UP ROUTINE              Y02006 80680002
         BALR  RETREG,R15          LINK TO IT                    Y02006 80730002
END3     L     R1,ONGOPTR          LOAD ONGO OPERAND PTR                80880002
         LTR   R1,R1               IS IT ZERO                           80910002
         BNP   END7A               YES--NOTHING TO BE FREED             80940002
         LH    R0,0(R1)            LOAD LNGH OF ONGO OPERAND            80970002
         LA    R0,4(R0)            ACCOUNT FOR ROUTCDE AND DESC         81000002
         FREEMAIN R,LV=(0),A=(1)   FREE ONGO SAVE BUFFER                81030002
END7A    XC    ONGOPTR,ONGOPTR     ZERO POINTER                         81060002
END5     MVI   SWA,0               RESET SWA                            81090002
         MVI   SWB,0               RESET SWB                            81120002
         MVI   SWC,0               RESET SWC                            81150002
         MVI   SWD,0               RESET SWD                            81180002
         MVI   SWE,0               RESET SWE                            81210002
         MVI   PRSW,0              RESET PRSW                           81240002
         XC    PAGENUMB,PAGENUMB   ZERO PAGE NUMBER                     81360002
         LA    R3,LNCNT            RESTORE LINECNT TO DEFAULT VALUE     81390002
         STH   R3,LINENUMB         STORE LINECNT VAL                    81420002
         SH    R3,TWO                                                   81450002
         STH   R3,LINENUM          STORE LINECNT VAL-2                  81480002
ENDALL   L R13,R13SAVE             GET CALLER'S SAVE AREA PTR   SA54065 81590002
EXIT     L     R1,RCSTORE          RESTORE MESSAGE CODE         YA01752 81640002
         LA    R3,4                CODE FOR NO MESSAGE          YA01752 81690002
         CR    R1,R3               WAS A MESSAGE ISSUED         YA01752 81700002
         BE    EXITCODE            CHECK FOR RETURN CODE 4 EXIT OZ12030 81710000
         RETURN  (14,12),RC=8      SET RETURN CODE OF 8         YA01752 81712002
EXITCODE EQU   *                                                OZ12030 81713000
         MVC   EXCODE+3(1),RETCODE SET CODE IN INSTRUCTION      OZ12030 81714000
         LM    R14,R12,R12(R13)    RESTORE REGS                 OZ12030 81715000
EXCODE   LA    R15,0(0,0)          SET RETURN CODE              OZ12030 81716000
         BR    R14                 RETURN                       OZ12030 81717000
         EJECT                                                          81750002
*********************************************************************** 81780002
*                                                                     * 81810002
*  CONSTANTS FOR AMDPRXIT ROUTINE                                X01980 81840002
*                                                                     * 81870002
*********************************************************************** 81900002
         SPACE                                                          81930002
ERBRTAB  B     EROPN               BRANCH TABLE  WITH ENTRY FOR         81960002
         B     TERM                OPEN ERROR,                          81990002
         B     TERM                TERMINATION ERROR,                   82020002
         B     ERIO                AND I/O ERROR HANDLER                82050002
         SPACE                                                          82080002
ERNMTAB  DC    A(PRTDCB)                                                82110002
         DC    A(SYSDCB)                                                82140002
         DC    A(SYSIDCB)                                               82170002
         DC    A(TAPEDCB)                                               82200002
         DC    A(SYS2DCB)                                               82230002
         SPACE                                                          82260002
XITSAVE  DC    18F'0'                                                   82290002
RCSTORE  DC    F'0'                MESSAGE CODE SAVEAREA        YA01752 82300002
PRTDCB   DC    C'PRINTER'                                               82320002
SYSDCB   DC    C'SYSUT1 '                                               82350002
SYSIDCB  DC    C'SYSIN  '                                               82380002
TAPEDCB  DC    C'TAPE   '                                               82410002
SYS2DCB  DC    CL7'SYSUT2'                                              82440002
R13SAVE  DS    F                                                SA54065 82450002
PTCHAREA DC    85F'0'              PATCH AREA                    X01980 82470002
         EJECT                                                          82500002
*********************************************************************** 82530002
*                                                                     * 82560002
*  TERMINAL MESSAGES                                                  * 82590002
*                                                                     * 82620002
*********************************************************************** 82650002
         SPACE                                                          82680002
EROPEN   WTO   'AMD150I FILE         CANNOT BE OPENED',MF=L,     A38027X82710002
               ROUTCDE=11,DESC=6                                 X01980 82740002
ERINIO   WTO   'AMD153I PERMANENT I/O ERROR ON         - EXECUTION TERMX82770002
               INATED',MF=L,ROUTCDE=11,DESC=6                    X01980 82800002
         EJECT                                                          82830002
         USING SYNEPS,R15                                               82860002
         SYNEPS                                                         82890002
         SPACE 2                                                        82920002
         END   AMDPRCTL                                                 82950002
