         TITLE 'AMDPRFAR - MEMORY LEVEL FORMATTING ROUTINE             *00001000
                        '                                               00002000
AMDPRFAR CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'AMDPRFAR  76.310'                                 0001 00009000
SRBRTN   DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP00160-SRBRTN)                                     00013000
         ENTRY SRBRTN                                                   00014000
         DROP  @15                                                      00015000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00016000
         BALR  @11,0                                               0001 00017000
@PSTART  LA    @10,4095(,@11)                                      0001 00018000
         USING @PSTART,@11                                         0001 00019000
         USING @PSTART+4095,@10                                    0001 00020000
         ST    @13,@SA00001+4                                      0001 00021000
         LA    @14,@SA00001                                        0001 00022000
         ST    @14,8(,@13)                                         0001 00023000
         LR    @13,@14                                             0001 00024000
         AH    @15,4(,@15)                                         0001 00025000
         BR    @15                                                 0001 00026000
@EP00001 MVC   @PC00001(4),0(@01)                                  0001 00027000
*   FARSAVRG=R13;                   /* SAVE ADDR OF FAR SAVE AREA    */ 00028000
         ST    R13,FARSAVRG                                        0072 00029000
*   RESPECIFY                                                      0073 00030000
*     R13 UNRESTRICTED;                                            0073 00031000
*                                                                  0073 00032000
*   /*****************************************************************/ 00033000
*   /*                                                               */ 00034000
*   /* INITIALIZATION PASS                                           */ 00035000
*   /*                                                               */ 00036000
*   /*****************************************************************/ 00037000
*                                                                  0074 00038000
*   IF INITSW=0 THEN                /* IS ENTRY FOR INITIALIZATION   */ 00039000
         CLI   INITSW,0                                            0074 00040000
         BNE   @RF00074                                            0074 00041000
*     DO;                           /* YES                           */ 00042000
*       INITSW=1;                   /* INDICATE INITIALIZATION HAS 0076 00043000
*                                      BEEN DONE                     */ 00044000
         MVI   INITSW,X'01'                                        0076 00045000
*       AASCBFMT=ADDR(AMDPRFAR);    /* PUT ADDR OF FAR IN COMMON     */ 00046000
         L     @15,@CA00028                                        0077 00047000
         ST    @15,AASCBFMT(,COMBASE)                              0077 00048000
*       ASRBFMT=ADDR(SRBRTN);       /* PUT ADDR OF SRB IN COMMON     */ 00049000
         L     @15,@CA00652                                        0078 00050000
         ST    @15,ASRBFMT(,COMBASE)                               0078 00051000
*       GO TO FAREXIT;              /* RETURN TO CALLER              */ 00052000
         B     FAREXIT                                             0079 00053000
*     END;                                                         0080 00054000
*                                                                  0080 00055000
*   /*****************************************************************/ 00056000
*   /*                                                               */ 00057000
*   /* FINDING ASCB PASSED BY 'FSR'                                  */ 00058000
*   /*                                                               */ 00059000
*   /*****************************************************************/ 00060000
*                                                                  0081 00061000
*   IF ASCBADDR=0 THEN              /* WAS ADDR PASSED 0             */ 00062000
@RF00074 L     @15,@PC00001                                        0081 00063000
         ICM   @14,7,ASCBADDR(@15)                                 0081 00064000
         BZ    @RT00081                                            0081 00065000
*     GO TO FAREXIT;                /* YES - RETURN TO CALLER        */ 00066000
*   ASCBPTR=FSRASCB;                /* SET BASE FOR MAPPING MACRO    */ 00067000
         MVC   ASCBPTR(4),FSRASCB(@15)                             0083 00068000
*   FARERSAV=ERRADDR;               /* SAVE ERROR RTN ADDR IN COMMON */ 00069000
         MVC   FARERSAV(4),ERRADDR(COMBASE)                        0084 00070000
*   ERRADDR=ADDR(FARERRTN);         /* PUT ADDR OF FAR BRREAD ERROR     00071000
*                                      RTN IN COMMON                 */ 00072000
         LA    @15,FARERRTN                                        0085 00073000
         ST    @15,ERRADDR(,COMBASE)                               0085 00074000
*   FARASID=AUSRASID;               /* ASID FOR BRREADS              */ 00075000
         MVC   FARASID(2),AUSRASID(COMBASE)                        0086 00076000
*   BRNCHADR=ADDR(FARMSG1);         /* ERROR RETURN POINT FOR THIS 0087 00077000
*                                      BRREAD                        */ 00078000
         LA    @15,FARMSG1                                         0087 00079000
         ST    @15,BRNCHADR                                        0087 00080000
*   GEN;                                                           0088 00081000
*                                                          /*OZ09006    00082000
         BAL   R14,FARCKSU        SEE IF SU S ARE CONF.      OZ09006    00083000
*   RESPECIFY                                                      0089 00084000
*     PREG RESTRICTED;                                             0089 00085000
*   PREG=ASCBPTR;                   /* SET UP TO READ ASCB           */ 00086000
         L     PREG,ASCBPTR                                        0090 00087000
*   GEN REFS(BRRDDATA) FLOWS(FARERRTN)(BRREAD (PREG),DATA,ASID=0); 0091 00088000
*                                                                  0091 00089000
         BRREAD (PREG),DATA,ASID=0                                      00090000
*   /*****************************************************************/ 00091000
*   /*                                                               */ 00092000
*   /* SHOULD BRREAD FAIL AN ERROR MESSAGE IS PRINTED - PROCESSING   */ 00093000
*   /* CONTINUES AT ASXBFIND                                         */ 00094000
*   /*                                                               */ 00095000
*   /*****************************************************************/ 00096000
*                                                                  0092 00097000
*   IF VALIDCK^='ASCB' THEN         /* DOES ASCB VALIDITY CHECK      */ 00098000
         CLC   VALIDCK(4,PREG),@CC00655                            0092 00099000
         BE    @RF00092                                            0092 00100000
*     DO;                           /* NO                            */ 00101000
*       OUTPUT(2:1+LENGTH(MSG02))=MSG02;/* PRINT VALIDITY CHECK MSG  */ 00102000
         L     @15,CURBUF(,COMBASE)                                0094 00103000
         MVC   OUTPUT+1(26,@15),MSG02                              0094 00104000
*       GEN REFS(AWRITE)(BRWRITE 2);                               0095 00105000
         BRWRITE 2                                                      00106000
*     END;                                                         0096 00107000
*   RESPECIFY                                                      0097 00108000
*     PREG UNRESTRICTED;                                           0097 00109000
*                                                                  0097 00110000
@RF00092 DS    0H                                                  0098 00111000
*   /*****************************************************************/ 00112000
*   /*                                                               */ 00113000
*   /* FORMATTING ASCB - SHOULD ANY BRREAD FAIL AN ERROR MESSAGE IS  */ 00114000
*   /* PRINTED - PROCESSING CONTINUES AT ASXBFIND                    */ 00115000
*   /*                                                               */ 00116000
*   /*****************************************************************/ 00117000
*                                                                  0098 00118000
*   BRNCHADR=ADDR(FARMSG3);         /* ERROR RETURN POINT FOR BRREADS   00119000
*                                      BY GFR                        */ 00120000
         LA    @15,FARMSG3                                         0098 00121000
         ST    @15,BRNCHADR                                        0098 00122000
*   RESPECIFY                                                      0099 00123000
*    (R0,                                                          0099 00124000
*     R1) RESTRICTED;                                              0099 00125000
*   R0=0;                           /* 0 ASID FOR RDC                */ 00126000
         SLR   R0,R0                                               0100 00127000
*   DO I=1 TO DIM(CBFMTBL);         /* CALL THE FORMAT RTN TO FORMAT    00128000
*                                      THE ASCB ONE LINE AT A TIME   */ 00129000
         LA    I,1                                                 0101 00130000
@DL00101 DS    0H                                                  0102 00131000
*     R1=CBFMTBL(I);                /* ADDRESS OF EACH LINE TO BE  0102 00132000
*                                      FORMATTED                     */ 00133000
         LR    @03,I                                               0102 00134000
         SLA   @03,2                                               0102 00135000
         L     R1,CBFMTBL-4(@03)                                   0102 00136000
*     CALL AMDPRGFR;                                               0103 00137000
         L     @15,AFMTLINE(,COMBASE)                              0103 00138000
         BALR  @14,@15                                             0103 00139000
*     GEN(BRWRITE 1);               /* PRINT THE FORMATTED LINE      */ 00140000
         BRWRITE 1                                                      00141000
*   END;                                                           0105 00142000
         AH    I,@CH00077                                          0105 00143000
         CH    I,@CH00033                                          0105 00144000
         BNH   @DL00101                                            0105 00145000
*   GEN(BRWRITE 2);                 /* SKIP TWO LINES                */ 00146000
         BRWRITE 2                                                      00147000
*   RESPECIFY                                                      0107 00148000
*    (R0,                                                          0107 00149000
*     R1) UNRESTRICTED;                                            0107 00150000
*                                                                  0107 00151000
*   /*****************************************************************/ 00152000
*   /*                                                               */ 00153000
*   /* FINDING ASXB FOR THIS ASCB - SHOULD BRREAD FAIL OR ADDRESS IS */ 00154000
*   /* ZERO, AN ERROR MESSAGE IS PRINTED - PROCESSING CONTINUES AT   */ 00155000
*   /* SPLFIND                                                       */ 00156000
*   /*                                                               */ 00157000
*   /*****************************************************************/ 00158000
*                                                                  0108 00159000
*ASXBFIND:                                                         0108 00160000
*   BRNCHADR=ADDR(FARMSG4);         /* ERROR RETURN POINT FOR THIS 0108 00161000
*                                      BRREAD                        */ 00162000
ASXBFIND LA    @15,FARMSG4                                         0108 00163000
         ST    @15,BRNCHADR                                        0108 00164000
*   RESPECIFY                                                      0109 00165000
*     PREG RESTRICTED;                                             0109 00166000
*   PREG=ADDR(ASCBASXB);            /* SET UP TO READ PTR TO ASXB    */ 00167000
         L     PREG,ASCBPTR                                        0110 00168000
         LA    PREG,ASCBASXB(,PREG)                                0110 00169000
*   GEN(BRREAD (PREG));                                            0111 00170000
         BRREAD (PREG)                                                  00171000
*   IF FARASXB1^=0 THEN             /* IS ADDR ZERO                  */ 00172000
         ICM   @00,7,FARASXB1(PREG)                                0112 00173000
         BZ    @RF00112                                            0112 00174000
*     DO;                           /* NO                            */ 00175000
*       ASXBADDR=FARASXB;           /* ADDR OF ASXB IN DUMP          */ 00176000
         L     @00,FARASXB(,PREG)                                  0114 00177000
         ST    @00,ASXBADDR                                        0114 00178000
*       PREG=ASXBADDR;              /* SET UP TO READ ASXB           */ 00179000
         LR    PREG,@00                                            0115 00180000
*       GEN(BRREAD (PREG),DATA,ASID=FARASID);                      0116 00181000
         BRREAD (PREG),DATA,ASID=FARASID                                00182000
*       IF VALIDCK^='ASXB' THEN     /* DOES ASXB VALIDITY CHECK      */ 00183000
         CLC   VALIDCK(4,PREG),@CC00660                            0117 00184000
         BE    @RF00117                                            0117 00185000
*         DO;                       /* NO                            */ 00186000
*           OUTPUT(2:1+LENGTH(MSG5))=MSG5;/* PRINT VALIDITY CHECK MSG*/ 00187000
         L     @15,CURBUF(,COMBASE)                                0119 00188000
         MVC   OUTPUT+1(26,@15),MSG5                               0119 00189000
*           GEN(BRWRITE 2);                                        0120 00190000
         BRWRITE 2                                                      00191000
*         END;                                                     0121 00192000
*       RESPECIFY                                                  0122 00193000
*         PREG UNRESTRICTED;                                       0122 00194000
*                                                                  0122 00195000
@RF00117 DS    0H                                                  0123 00196000
*       /*************************************************************/ 00197000
*       /*                                                           */ 00198000
*       /* FORMATTING ASXB - SHOULD ANY BRREAD FAIL AN ERROR MESSAGE */ 00199000
*       /* IS PRINTED - PROCESSING CONTINUES AT SPLFIND              */ 00200000
*       /*                                                           */ 00201000
*       /*************************************************************/ 00202000
*                                                                  0123 00203000
*       BRNCHADR=ADDR(FARMSG6);     /* ERROR RETURN POINT FOR BRREADS   00204000
*                                      BY GFR                        */ 00205000
         LA    @15,FARMSG6                                         0123 00206000
         ST    @15,BRNCHADR                                        0123 00207000
*       RESPECIFY                                                  0124 00208000
*        (R0,                                                      0124 00209000
*         R1) RESTRICTED;                                          0124 00210000
*       R0=FARASID;                 /* ASID OF THIS MEMORY FOR RDC   */ 00211000
         SLR   R0,R0                                               0125 00212000
         ICM   R0,3,FARASID                                        0125 00213000
*       DO I=1 TO DIM(XBFMTBL);     /* CALL THE FORMAT RTN TO FORMAT    00214000
*                                      THE ASXB ONE LINE AT A TIME   */ 00215000
         LA    I,1                                                 0126 00216000
@DL00126 DS    0H                                                  0127 00217000
*         R1=XBFMTBL(I);            /* ADDRESS OF EACH LINE TO BE  0127 00218000
*                                      FORMATTED                     */ 00219000
         LR    @03,I                                               0127 00220000
         SLA   @03,2                                               0127 00221000
         L     R1,XBFMTBL-4(@03)                                   0127 00222000
*         CALL AMDPRGFR;                                           0128 00223000
         L     @15,AFMTLINE(,COMBASE)                              0128 00224000
         BALR  @14,@15                                             0128 00225000
*         GEN(BRWRITE 1);           /* PRINT THE FORMATTED LINE      */ 00226000
         BRWRITE 1                                                      00227000
*       END;                                                       0130 00228000
         AH    I,@CH00077                                          0130 00229000
         CH    I,@CH00313                                          0130 00230000
         BNH   @DL00126                                            0130 00231000
*       GEN(BRWRITE 2);             /* SKIP TWO LINES                */ 00232000
         BRWRITE 2                                                      00233000
*       RESPECIFY                                                  0132 00234000
*        (R0,                                                      0132 00235000
*         R1) UNRESTRICTED;                                        0132 00236000
*     END;                                                         0133 00237000
*   ELSE                                                           0134 00238000
*     DO;                           /* PTR TO ASXB ADDR IS ZERO -  0134 00239000
*                                      ALSO RETURN POINT FOR READ  0134 00240000
*                                      ERROR WHILE ACCESSING ASXB    */ 00241000
         B     @RC00112                                            0134 00242000
@RF00112 DS    0H                                                  0135 00243000
*FARMSG4:                                                          0135 00244000
*       OUTPUT(2:1+LENGTH(MSG4))=MSG4;/* PRINT ERROR FINDING ASXB MSG*/ 00245000
FARMSG4  L     @01,CURBUF(,COMBASE)                                0135 00246000
         MVC   OUTPUT+1(18,@01),MSG4                               0135 00247000
*       GEN(BRWRITE 2);                                            0136 00248000
         BRWRITE 2                                                      00249000
*     END;                                                         0137 00250000
*                                                                  0137 00251000
*   /*****************************************************************/ 00252000
*   /*                                                               */ 00253000
*   /* GET SPL ADDR FROM ASCB - IF NON-ZERO CALL 'SRB' RTN TO FORMAT */ 00254000
*   /* SRB QUEUES                                                    */ 00255000
*   /*                                                               */ 00256000
*   /*****************************************************************/ 00257000
*                                                                  0138 00258000
*SPLFIND:                                                          0138 00259000
*   BRNCHADR=ADDR(FARMSG7);         /* ADDR OF ERROR RTN FOR THIS  0138 00260000
*                                      BRREAD                        */ 00261000
@RC00112 DS    0H                                                  0138 00262000
SPLFIND  LA    @15,FARMSG7                                         0138 00263000
         ST    @15,BRNCHADR                                        0138 00264000
*   RESPECIFY                                                      0139 00265000
*     PREG RESTRICTED;                                             0139 00266000
*   PREG=ADDR(ASCBSPL);             /* SET UP TO READ PTR TO SPL     */ 00267000
         L     PREG,ASCBPTR                                        0140 00268000
         LA    PREG,ASCBSPL(,PREG)                                 0140 00269000
*   GEN(BRREAD (PREG),DATA,ASID=0);                                0141 00270000
         BRREAD (PREG),DATA,ASID=0                                      00271000
*   SPLADDR=FARSPL;                 /* PTR TO SPL                    */ 00272000
         MVC   SPLADDR(4),FARSPL(PREG)                             0142 00273000
*   RESPECIFY                                                      0143 00274000
*     PREG UNRESTRICTED;                                           0143 00275000
*   IF SPLPTR^=0 THEN               /* IS PTR ZERO                   */ 00276000
         ICM   @15,7,SPLPTR                                        0144 00277000
         BZ    @RF00144                                            0144 00278000
*     DO;                           /* NO                            */ 00279000
*       OUTPUT(2:1+LENGTH(LOCLTITL))=LOCLTITL;/* PRINT TITLE         */ 00280000
         L     @01,CURBUF(,COMBASE)                                0146 00281000
         MVC   OUTPUT+1(27,@01),LOCLTITL                           0146 00282000
*       GEN(BRWRITE 2);                                            0147 00283000
         BRWRITE 2                                                      00284000
*       SPLFLAG=SPLSW;              /* INDICATE SPL FOR SRB RTN      */ 00285000
         OI    SPLFLAG,B'10000000'                                 0148 00286000
*       FSPLTYPE=0;                 /* INDICATE LSPL FOR SRB RTN     */ 00287000
         MVI   FSPLTYPE,X'00'                                      0149 00288000
*       CALL AMDPRSRB(SPLADDR,FSPLTYPE);/* PARM IS ADDR OF SPL TO BE    00289000
*                                      PROCESSED,AND SPL TYPE (LSPL) */ 00290000
         LA    @01,@AL00150                                        0150 00291000
         BAL   @14,AMDPRSRB                                        0150 00292000
*     END;                                                         0151 00293000
*   ELSE                                                           0152 00294000
*     DO;                           /* SPL PTR WAS ZERO              */ 00295000
         B     @RC00144                                            0152 00296000
@RF00144 DS    0H                                                  0153 00297000
*FARMSG7:                                                          0153 00298000
*       OUTPUT(2:1+LENGTH(MSG7))=MSG7;/* PRINT ERROR FINDING SPL MSG */ 00299000
FARMSG7  L     @01,CURBUF(,COMBASE)                                0153 00300000
         MVC   OUTPUT+1(17,@01),MSG7                               0153 00301000
*       GEN(BRWRITE 2);                                            0154 00302000
         BRWRITE 2                                                      00303000
*     END;                                                         0155 00304000
*                                                                  0155 00305000
*   /*****************************************************************/ 00306000
*   /*                                                               */ 00307000
*   /* CHECK FOR USER REQUEST BY CALLING AMDPRUIM                    */ 00308000
*   /*                                                               */ 00309000
*   /*****************************************************************/ 00310000
*                                                                  0156 00311000
*   EXITFLAG=BASID;                 /* SET ASCB FLAG FOR AMDPRUIM    */ 00312000
@RC00144 MVI   EXITFLAG(COMBASE),X'40'                             0156 00313000
*   CALL AMDPRUIM;                                                 0157 00314000
*                                                                  0157 00315000
         L     @15,AUSREXIT(,COMBASE)                              0157 00316000
         BALR  @14,@15                                             0157 00317000
*   /*****************************************************************/ 00318000
*   /*                                                               */ 00319000
*   /* PREPARE TO RETURN TO CALLER                                   */ 00320000
*   /*                                                               */ 00321000
*   /*****************************************************************/ 00322000
*                                                                  0158 00323000
*   ERRADDR=FARERSAV;               /* RESTORE PREVIOUS ERROR RTN  0158 00324000
*                                      ADDR IN COMMON                */ 00325000
         MVC   ERRADDR(4,COMBASE),FARERSAV                         0158 00326000
*FAREXIT:                                                          0159 00327000
*   RETURN;                         /* RETURN TO CALLER              */ 00328000
*                                                                  0159 00329000
@EL00001 L     @13,4(,@13)                                         0159 00330000
@EF00001 DS    0H                                                  0159 00331000
@ER00001 LM    @14,@12,12(@13)                                     0159 00332000
         BR    @14                                                 0159 00333000
*   /*****************************************************************/ 00334000
*   /*                                                               */ 00335000
*   /* AMDPRSRB ENTRY POINT ADDR IN COMMON                           */ 00336000
*   /*                                                               */ 00337000
*   /*****************************************************************/ 00338000
*                                                                  0160 00339000
*SRBRTN:                                                           0160 00340000
*   ENTRY(PSPLADDR,PSPLTYPE);       /* ENTRY TO SRB FOR EXTERNAL   0160 00341000
*                                      CALLS                         */ 00342000
@EP00160 MVC   @PC00001+4(8),0(@01)                                0160 00343000
*   CALL AMDPRSRB(PSPLADDR,PSPLTYPE);                              0161 00344000
         L     @15,@PC00001+4                                      0161 00345000
         ST    @15,@AL00001                                        0161 00346000
         L     @15,@PC00001+8                                      0161 00347000
         ST    @15,@AL00001+4                                      0161 00348000
         LA    @01,@AL00001                                        0161 00349000
         BAL   @14,AMDPRSRB                                        0161 00350000
*   RETURN;                                                        0162 00351000
*                                                                  0162 00352000
         B     @EL00001                                            0162 00353000
*   /*****************************************************************/ 00354000
*   /*                                                               */ 00355000
*   /* BRREAD ERROR ROUTINE - REESTABLISH ADDRESSABILITY AND BRANCH  */ 00356000
*   /* TO ADDRESS PUT IN BRNCHADR PRIOR TO BRREAD                    */ 00357000
*   /*                                                               */ 00358000
*   /*****************************************************************/ 00359000
*                                                                  0163 00360000
*FARERRTN:                          /* SET UP ADDRESSABILITY FOR   0163 00361000
*                                      BRREAD ERROR RTN              */ 00362000
*   GEN;                                                           0163 00363000
FARERRTN DS    0H                                                  0163 00364000
         USING *,R15                                                    00365000
         L     R13,FARSAVRG                                             00366000
         LM    R14,R12,12(R13)                                          00367000
         DROP  R15                                                      00368000
*   GO TO BREADERR;                 /* BRANCH TO SPECIFIC FUNCTION   */ 00369000
*                                                                  0164 00370000
         L     @01,BRNCHADR                                        0164 00371000
         BR    @01                                                 0164 00372000
*   /*****************************************************************/ 00373000
*   /*                                                               */ 00374000
*   /* READ FAILED TRYING TO FIND THE ASCB - CONVERT THE ASCB ADDRESS*/ 00375000
*   /* TO PRINTABLE HEX FOR MESSAGE                                  */ 00376000
*   /*                                                               */ 00377000
*   /*****************************************************************/ 00378000
*                                                                  0165 00379000
*FARMSG1:                                                          0165 00380000
*   RESPECIFY                                                      0165 00381000
*    (R1,                                                          0165 00382000
*     R4) RESTRICTED;                                              0165 00383000
FARMSG1  DS    0H                                                  0166 00384000
*   R1=ADDR(ASCBPTR);               /* ADDR TO CONVERT               */ 00385000
         LA    R1,ASCBPTR                                          0166 00386000
*   R4=ADDR(ADDR1);                 /* ADDR OF OUTPUT LOCATION FOR 0167 00387000
*                                      CNVT RTN                      */ 00388000
         LA    R4,ADDR1                                            0167 00389000
*   CALL ADRCNVT;                   /* AADRCNVT RTN                  */ 00390000
         L     @15,AADRCNVT(,COMBASE)                              0168 00391000
         BALR  @14,@15                                             0168 00392000
*   RESPECIFY                                                      0169 00393000
*    (R1,                                                          0169 00394000
*     R4) UNRESTRICTED;                                            0169 00395000
*   OUTPUT(2:1+LENGTH(MSG01))=MSG01;/* PRINT ERROR FINDING ASCB MSG  */ 00396000
         L     @01,CURBUF(,COMBASE)                                0170 00397000
         MVC   OUTPUT+1(26,@01),MSG01                              0170 00398000
*   GEN(BRWRITE 2);                                                0171 00399000
         BRWRITE 2                                                      00400000
*   GO TO ASXBFIND;                 /* TRY TO GET ASXB               */ 00401000
*                                                                  0172 00402000
         B     ASXBFIND                                            0172 00403000
*   /*****************************************************************/ 00404000
*   /*                                                               */ 00405000
*   /* A READ BY AMDPRGFR FAILED WHILE FORMATTING THE ASCB           */ 00406000
*   /*                                                               */ 00407000
*   /*****************************************************************/ 00408000
*                                                                  0173 00409000
*FARMSG3:                                                          0173 00410000
*   GEN(BRWRITE 1);                 /* PRINT PARTIALLY FILLED BUFFER */ 00411000
FARMSG3  BRWRITE 1                                                      00412000
*   OUTPUT(2:1+LENGTH(MSG3))=MSG3;  /* PRINT ERROR FORMATTING ASCB 0174 00413000
*                                      MSG                           */ 00414000
         L     @01,CURBUF(,COMBASE)                                0174 00415000
         MVC   OUTPUT+1(27,@01),MSG3                               0174 00416000
*   GEN(BRWRITE 2);                                                0175 00417000
         BRWRITE 2                                                      00418000
*   GO TO ASXBFIND;                 /* TRY TO GET ASXB               */ 00419000
*                                                                  0176 00420000
         B     ASXBFIND                                            0176 00421000
*   /*****************************************************************/ 00422000
*   /*                                                               */ 00423000
*   /* A READ BY GFT FAILED WHILE FORMATTING THE ASXB                */ 00424000
*   /*                                                               */ 00425000
*   /*****************************************************************/ 00426000
*                                                                  0177 00427000
*FARMSG6:                                                          0177 00428000
*   GEN(BRWRITE 1);                 /* PRINT PARTIALLY FILLED BUFFER */ 00429000
FARMSG6  BRWRITE 1                                                      00430000
*   OUTPUT(2:1+LENGTH(MSG6))=MSG6;  /* PRINT ERROR FORMATTING ASXB 0178 00431000
*                                      MSG                           */ 00432000
         L     @01,CURBUF(,COMBASE)                                0178 00433000
         MVC   OUTPUT+1(27,@01),MSG6                               0178 00434000
*   GEN(BRWRITE 2);                                                0179 00435000
         BRWRITE 2                                                      00436000
*   GO TO SPLFIND;                  /* TRY TO GET SPL PTR            */ 00437000
         B     SPLFIND                                             0180 00438000
*   GEN REFS(Z9SUFLG,Z9SUBITS);                                    0181 00439000
*                                                          /*OZ09006    00440000
FARCKSU  EQU   *                  CHECK SU ROUTINE           OZ09006    00441000
         TM    Z9SUFLG(R12),X'01' SU S CONFIGURED            OZ09006    00442000
         BZ    FARSURET           NO - RETURN                OZ09006    00443000
*                                 YES - MAKE SU00 CHANGES    OZ09006    00444000
         MVI   PASXBL8+9,X'36'                               OZ09006    00445000
         MVC   PASXBL8+13(3),=X'304A50'                      OZ09006    00446000
         MVC   LASXBL8+13(12),=C'USERSECRSENV'               OZ09006    00447000
         TM    Z9SUBITS(R12),X'04' SU05 CONFIGURED           OZ09006    00448000
         BZ    FARNO57             NO - THEN SKIP 5 & 7 CHANGES OZ14112 00449000
*                                  YES - MAKE SU05 CHANGES   OZ09006    00450000
         MVC   LASCBL1+20(12),=C'CMSFRV12RV10'               OZ09006    00451000
         MVC   LASCBL2+5(4),=C'IOSP'                         OZ09006    00452000
         MVC   LASCBL7+13(8),=C'LOCKLSQH'                    OZ09006    00453000
         TM    Z9SUBITS(R12),X'01' SU7 APPLIED?                 OZ14112 00454000
         BZ    FARNO57             NO - SKIP SU7 CHANGES        OZ14112 00455000
         MVC   LASCBL1+24(8),=C'SVRBSYNC'                       OZ14112 00456000
         MVC   LASCBL5+9(4),=C'RV44'                            OZ14112 00457000
         MVC   LASCBL9+20(4),=C'SRQ '                           OZ14112 00458000
FARNO57  EQU   *                                                OZ14112 00459000
FARSURET BR    R14                                           OZ09006    00460000
*AMDPRSRB:                                                         0182 00461000
*   PROC(QUEADDR,SPLTYPE);                                         0182 00462000
*                                                                  0182 00463000
         B     @EL00001                                            0182 00464000
AMDPRSRB STM   @14,@12,@SA00002                                    0182 00465000
         MVC   @PC00002(8),0(@01)                                  0182 00466000
*/********************************************************************/ 00467000
*/*                                                                  */ 00468000
*/*                     D E C L A R E S                              */ 00469000
*/*                                                                  */ 00470000
*/********************************************************************/ 00471000
*                                                                  0183 00472000
*   DCL                                                            0183 00473000
*     SRBSAVRG FIXED(31) INIT(0);   /* ADDR OF SRB SAVE AREA - INIT     00474000
*                                      TO PREVENT ASSIGNMENT TO A REG*/ 00475000
*   DCL                                                            0184 00476000
*     SRBERSAV FIXED(31) INIT(0);   /* ERROR RTN ADDR REMOVED FROM 0184 00477000
*                                      COMMON - INIT TO PREVENT    0184 00478000
*                                      ASSIGNMENT TO A REG           */ 00479000
*   DCL                                                            0185 00480000
*     SRBRANCH PTR(31) INIT(0);     /* ADDR OF BRREAD ERROR RETURN 0185 00481000
*                                      POINTS - INIT TO PREVENT    0185 00482000
*                                      ASSIGNMENT TO A REG           */ 00483000
*   DCL                                                            0186 00484000
*     READERR LABEL BASED(SRBRANCH) VALRG(BADFSTCK,SRBMSG1A,SRBMSG1B,   00485000
*         SRBMSG4,SRBMSG8,SRBMSG10,SRBMSG11);/* USED FOR BRANCH TO 0186 00486000
*                                      ERROR RTNS                    */ 00487000
*   DCL                                                            0187 00488000
*     1 CURNTSRB PTR(31) BASED(PREG),/* USED TO ADDRESS SRB AFTER  0187 00489000
*                                      BRREAD                        */ 00490000
*      2 * PTR(8),                                                 0187 00491000
*      2 CRNTSRB1 PTR(24);          /* USED TO CHECK FOR ADDR OF 0   */ 00492000
*   DCL                                                            0188 00493000
*     1 SRBPTR PTR(31) GEND,        /* ADDR OF CURRENT SRB, USED IN     00494000
*                                      FMTPTRNS                      */ 00495000
*      2 * PTR(8),                                                 0188 00496000
*      2 DUMPSRBA PTR(24);          /* USED TO CHECK FOR ADDR OF 0   */ 00497000
*   DCL                                                            0189 00498000
*     SFWDPTR PTR(24);              /* ADDR OF NEXT SRB ON QUEUE     */ 00499000
*   DCL                                                            0190 00500000
*     LASTQPTR PTR(24);             /* ADDR OF LAST SRB IN SPL       */ 00501000
*   DCL                                                            0191 00502000
*     1 QUEADDR PTR(32),            /* ADDR OF SPL PASSED VIA CALL   */ 00503000
*      2 QFLAG BIT(1),              /* SPL TYPE (GSPL/LSPL)          */ 00504000
*      2 * BIT(7),                                                 0191 00505000
*      2 QUEPTR PTR(24);            /* USED TO CHECK FOR ADDR OF 0   */ 00506000
*   DCL                                                            0192 00507000
*     LSPLPTR PTR(31) DEF(QUEADDR); /* BASE FOR LSPL MACRO           */ 00508000
*   DCL                                                            0193 00509000
*     GSPLPTR PTR(31) DEF(QUEADDR); /* BASE FOR GSPL MACRO           */ 00510000
*   DCL                                                            0194 00511000
*     SRBFMTBL(3) FIXED(31) INIT(ADDR(PSRBL1),ADDR(PSRBL2),ADDR(PSRBL3) 00512000
*         );                                                       0194 00513000
*                                                                  0194 00514000
*   /*****************************************************************/ 00515000
*   /*                                                               */ 00516000
*   /* ADDR OF EACH LINE OF SRB FMTPTRNS                             */ 00517000
*   /*                                                               */ 00518000
*   /*****************************************************************/ 00519000
*                                                                  0195 00520000
*   DCL                                                            0195 00521000
*     MAXCTR FIXED(15);             /* LOOP CONTROL VALUE FOR      0195 00522000
*                                      PROCESSING SRB QUEUES         */ 00523000
*   DCL                                                            0196 00524000
*     MINLOOP FIXED(31) CONSTANT(5);/* USED TO PROCESS 5 SRBS      0196 00525000
*                                      BEGINNING WITH LAST SRB PTR IN   00526000
*                                      SPL                           */ 00527000
*   DCL                                                            0197 00528000
*     1 SRBSWS BIT(8),              /* INTERNAL SWITCHES             */ 00529000
*      2 NOFSTPTR BIT(1),           /* INDICATE ABSENCE OF FIRST SRB    00530000
*                                      PTR IN SPL                    */ 00531000
*      2 NOLSTPTR BIT(1),           /* INDICATE ABSENCE OF LAST SRB     00532000
*                                      PTR IN SPL                    */ 00533000
*      2 PASTLPSW BIT(1),           /* FOR PROCESSING SRBS BEGINNING    00534000
*                                      WITH LAST SRB PTR IN SPL      */ 00535000
*      2 ENDSWTCH BIT(1),           /* TO TERMINATE PROCESSING       */ 00536000
*      2 * BIT(4);                  /* RESERVED                      */ 00537000
*   DCL                                                            0198 00538000
*     SWOFF BIT(1) CONSTANT('0'B);  /* TO TURN OFF SWITCHES          */ 00539000
*   DCL                                                            0199 00540000
*     SPLTYPE PTR(8);               /* SWITCH TO DETERMINE SPL TYPE     00541000
*                                      (GSPL/LSPL)                   */ 00542000
*/********************************************************************/ 00543000
*/*                                                                  */ 00544000
*/*                 TITLES AND OUTPUT COMMENTS                       */ 00545000
*/*                                                                  */ 00546000
*/********************************************************************/ 00547000
*                                                                  0200 00548000
*   DCL                                                            0200 00549000
*     NONQTITL CHAR(20) INIT('NON-QUIESCABLE QUEUE');              0200 00550000
*   DCL                                                            0201 00551000
*     SYSTITLE CHAR(12) INIT('SYSTEM QUEUE');                      0201 00552000
*   DCL                                                            0202 00553000
*     SMSG1 CHAR(14) INIT('QUEUE IS EMPTY');                       0202 00554000
*   DCL                                                            0203 00555000
*     SMSG2 CHAR(68) INIT(                                         0203 00556000
*'LOOP CONTROL VALUE IS ZERO, PROCESSING TERMINATED FOR ALL SRB QUEUES' 00557000
*         );                                                       0203 00558000
*   DCL                                                            0204 00559000
*     SMSG3 CHAR(34) INIT('ERROR FINDING POINTER TO FIRST SRB');   0204 00560000
*   DCL                                                            0205 00561000
*     SMSG4 CHAR(72) INIT('ERROR FINDING POINTER TO FIRST SRB, PROCESSI 00562000
*G TERMINATED FOR THIS QUEUE');                                    0205 00563000
*   DCL                                                            0206 00564000
*     SMSG5 CHAR(33) INIT('ERROR FINDING POINTER TO LAST SRB');    0206 00565000
*   DCL                                                            0207 00566000
*     SMSG6 CHAR(27) INIT('POINTER TO LAST SRB IS ZERO');          0207 00567000
*   DCL                                                            0208 00568000
*     SMSG7 CHAR(61) INIT(                                         0208 00569000
*'FORWARD POINTER IS ZERO, PROCESSING TERMINATED FOR THIS QUEUE'); 0208 00570000
*   DCL                                                            0209 00571000
*     1 SMSG8 CHAR(25),                                            0209 00572000
*      2 * CHAR(18) INIT('ERROR FINDING SRB '),                    0209 00573000
*      2 SADDR8 CHAR(6),                                           0209 00574000
*      2 * CHAR(1);                 /* EXTRA BYTE FOR AADRCNVT TO  0209 00575000
*                                      UNPAK IN                      */ 00576000
*   DCL                                                            0210 00577000
*     SMSG9 CHAR(25) INIT('SRB FAILED VALIDITY CHECK');            0210 00578000
*   DCL                                                            0211 00579000
*     SMSG10 CHAR(26) INIT('ERROR WHILE FORMATTING SRB');          0211 00580000
*   DCL                                                            0212 00581000
*     SMSG11 CHAR(16) INIT('SRB CHAIN BROKEN');                    0212 00582000
*   DCL                                                            0213 00583000
*     SMSG12 CHAR(39) INIT('UNABLE TO FORMAT ANY SRBS ON THIS QUEUE');  00584000
*   DCL                                                            0214 00585000
*     SMSG13 CHAR(116) INIT('ERROR IN SRB CHAIN, LAST EXPECTED SRB HAS  00586000
*ON-ZERO FORWARD POINTER, WILL PROCESS FIVE MORE FOLLOWING FORWARD POIN 00587000
*ER');                                                             0214 00588000
*   DCL                                                            0215 00589000
*     SMSG14 CHAR(74) INIT('WILL PROCESS FIVE SRBS BEGINNING WITH SRB P 00590000
*INTED TO BY LAST QUEUE POINTER');                                 0215 00591000
*   DCL                                                            0216 00592000
*     SMSG15 CHAR(49) INIT(                                        0216 00593000
*         'LOOP IN SRB CHAIN, MORE THAN MAXIMUM NUMBER FOUND');    0216 00594000
*   DCL                                                            0217 00595000
*     SMSG16 CHAR(73) INIT('PROCESSING TERMINATED FOR THIS CHAIN, MORE  00596000
*HAN FIVE SRBS HAVE BEEN FOUND');                                  0217 00597000
*   DCL                                                            0218 00598000
*     SMSG17 CHAR(36) INIT('PROCESSING TERMINATED FOR THIS CHAIN');     00599000
*                                                                  0218 00600000
*   /*****************************************************************/ 00601000
*   /*                                                               */ 00602000
*   /* THE FOLLOWING DECLARES DESCRIBE THE LABELS ON THE FORMAT      */ 00603000
*   /* PATTERN LINES AND THE LABELS FOR EACH LINE OF THE SRB         */ 00604000
*   /*                                                               */ 00605000
*   /*****************************************************************/ 00606000
*                                                                  0219 00607000
*   DCL                                                            0219 00608000
*     PSRBL1 FIXED(31) GEND;                                       0219 00609000
*   DCL                                                            0220 00610000
*     PSRBL2 FIXED(31) GEND;                                       0220 00611000
*   DCL                                                            0221 00612000
*     PSRBL3 FIXED(31) GEND;                                       0221 00613000
*   DCL                                                            0222 00614000
*     1 SRBLBLS,                                                   0222 00615000
*      2 LSRBL1 CHAR(31) INIT('SRB+0  IDFLNKASCBCPAFFPASIDPTCB'),  0222 00616000
*      2 LSRBL2 CHAR(27) INIT('+14  EPRMTRPARMSAVEPKFPRIOR'),      0222 00617000
*      2 LSRBL3 CHAR(13) INIT('+26  RESVRESV');                    0222 00618000
*   GEN DATA;                                                      0223 00619000
*                                                                  0224 00620000
*   /*****************************************************************/ 00621000
*   /*                                                               */ 00622000
*   /* SAVE ADDR OF SRB SAVE AREA                                    */ 00623000
*   /*                                                               */ 00624000
*   /*****************************************************************/ 00625000
*                                                                  0224 00626000
*   RESPECIFY                                                      0224 00627000
*     R13 RESTRICTED;                                              0224 00628000
*   SRBSAVRG=R13;                                                  0225 00629000
         ST    R13,SRBSAVRG                                        0225 00630000
*   RESPECIFY                                                      0226 00631000
*     R13 UNRESTRICTED;                                            0226 00632000
*                                                                  0226 00633000
*   /*****************************************************************/ 00634000
*   /*                                                               */ 00635000
*   /* RESET SWITCHES FOR PROCESSING IF QUEUE POINTER IS NON-ZERO    */ 00636000
*   /*                                                               */ 00637000
*   /*****************************************************************/ 00638000
*                                                                  0227 00639000
*   IF QUEPTR=0 THEN                /* WAS ADDR OF SPL/SMQ PASSED 0  */ 00640000
         L     @15,@PC00002                                        0227 00641000
         ICM   @14,7,QUEPTR(@15)                                   0227 00642000
         BZ    @RT00227                                            0227 00643000
*SRBEXIT:                                                          0228 00644000
*     RETURN;                       /* YES - RETURN TO CALLER        */ 00645000
*   ELSE                                                           0229 00646000
*     DO;                                                          0229 00647000
*       MAXCTR=SRBMAX;              /* LOOP CONTROL VALUE FROM COMMON*/ 00648000
         LH    MAXCTR,SRBMAX(,COMBASE)                             0230 00649000
*       IF MAXCTR=0 THEN            /* IS VALUE ZERO                 */ 00650000
         LTR   MAXCTR,MAXCTR                                       0231 00651000
         BNZ   @RF00231                                            0231 00652000
*         DO;                       /* YES                           */ 00653000
*           OUTPUT(2:1+LENGTH(SMSG2))=SMSG2;/* PRINT LOOP CNTRL VALUE   00654000
*                                      ERROR MSG                     */ 00655000
         L     @01,CURBUF(,COMBASE)                                0233 00656000
         MVC   OUTPUT+1(68,@01),SMSG2                              0233 00657000
*           GEN(BRWRITE 2);                                        0234 00658000
         BRWRITE 2                                                      00659000
*           GO TO SRBEXIT;          /* RETURN TO CALLER              */ 00660000
         B     SRBEXIT                                             0235 00661000
*         END;                                                     0236 00662000
*       ELSE                                                       0237 00663000
*         DO;                       /* LOOP VALUE IS NOT ZERO        */ 00664000
@RF00231 DS    0H                                                  0238 00665000
*           SRBERSAV=ERRADDR;       /* SAVE ERROR RTN ADDR IN COMMON */ 00666000
         MVC   SRBERSAV(4),ERRADDR(COMBASE)                        0238 00667000
*           ERRADDR=ADDR(SRBERRTN); /* PUT ADDR OF SRB BRREAD ERROR     00668000
*                                      RTN IN COMMON                 */ 00669000
         LA    @02,SRBERRTN                                        0239 00670000
         ST    @02,ERRADDR(,COMBASE)                               0239 00671000
*         END;                                                     0240 00672000
*     END;                                                         0241 00673000
*                                                                  0241 00674000
*   /*****************************************************************/ 00675000
*   /*                                                               */ 00676000
*   /* RESET ALL INTERNAL SWITCHES AND VALUES TO 0                   */ 00677000
*   /*                                                               */ 00678000
*   /*****************************************************************/ 00679000
*                                                                  0242 00680000
*   SRBSWS='00'X;                                                  0242 00681000
         MVI   SRBSWS,X'00'                                        0242 00682000
*   SRBPTR=0;                                                      0243 00683000
         SLR   @04,@04                                             0243 00684000
         ST    @04,SRBPTR                                          0243 00685000
*   LASTQPTR=0;                                                    0244 00686000
*                                                                  0244 00687000
         SLR   LASTQPTR,LASTQPTR                                   0244 00688000
*   /*****************************************************************/ 00689000
*   /*                                                               */ 00690000
*   /* PROCESSING OF SMQS - ONLY A NEXT POINTER AVAILABLE            */ 00691000
*   /*                                                               */ 00692000
*   /*****************************************************************/ 00693000
*                                                                  0245 00694000
*   IF QFLAG=SWOFF THEN             /* IS THIS AN SMQ                */ 00695000
         L     @04,@PC00002                                        0245 00696000
         TM    QFLAG(@04),B'10000000'                              0245 00697000
         BNZ   @RF00245                                            0245 00698000
*     DO;                           /* YES                           */ 00699000
*       SRBRANCH=ADDR(SRBMSG4);     /* ERROR RETURN POINT FOR THIS 0247 00700000
*                                      BRREAD                        */ 00701000
         LA    @02,SRBMSG4                                         0247 00702000
         ST    @02,SRBRANCH                                        0247 00703000
*       ENDSWTCH=SWON;              /* INDICATE TO TERMINATE THIS  0248 00704000
*                                      QUEUE SHOULD ERROR OCCUR      */ 00705000
         OI    ENDSWTCH,B'00010000'                                0248 00706000
*       RESPECIFY                                                  0249 00707000
*         PREG RESTRICTED;                                         0249 00708000
*       PREG=QUEADDR;               /* SET UP TO READ FIRST SRB      */ 00709000
         L     PREG,QUEADDR(,@04)                                  0250 00710000
*       GEN FLOWS(SRBERRTN)(BRREAD (PREG),DATA,ASID=0);            0251 00711000
         BRREAD (PREG),DATA,ASID=0                                      00712000
*       IF CRNTSRB1^=0 THEN         /* IS PTR 0                      */ 00713000
         ICM   @04,7,CRNTSRB1(PREG)                                0252 00714000
         BZ    @RF00252                                            0252 00715000
*         DO;                       /* NO                            */ 00716000
*           SRBPTR=CURNTSRB;        /* SRB ADDR IN DUMP              */ 00717000
         MVC   SRBPTR(4),CURNTSRB(PREG)                            0254 00718000
*           RESPECIFY                                              0255 00719000
*             PREG UNRESTRICTED;                                   0255 00720000
*           NOLSTPTR=SWON;          /* INDICATE NO PTR TO LAST SRB 0256 00721000
*                                      EXISTS                        */ 00722000
         OI    NOLSTPTR,B'01000000'                                0256 00723000
*           GO TO DECREMNT;         /* PROCESS THIS SRB              */ 00724000
         B     DECREMNT                                            0257 00725000
*         END;                                                     0258 00726000
*       ELSE                                                       0259 00727000
*         GO TO QMPTYMSG;           /* PRINT QUEUE EMPTY MSG         */ 00728000
*     END;                                                         0260 00729000
*                                                                  0260 00730000
*   /*****************************************************************/ 00731000
*   /*                                                               */ 00732000
*   /* PROCESSING OF SPLS - NEXT AND LAST POINTERS AVAILABLE -       */ 00733000
*   /* NON-QUIESCABLE QUEUE IS HANDLED FIRST - TEST IS MADE TO       */ 00734000
*   /* DETERMINE TYPE OF SPL, SO THAT PROPER LABELS ARE USED TO      */ 00735000
*   /* ACCESS THE SRB POINTERS                                       */ 00736000
*   /*                                                               */ 00737000
*   /*****************************************************************/ 00738000
*                                                                  0261 00739000
*   OUTPUT(6:5+LENGTH(NONQTITL))=NONQTITL;/* PRINT TITLE             */ 00740000
@RF00245 L     @04,CURBUF(,COMBASE)                                0261 00741000
         MVC   OUTPUT+5(20,@04),NONQTITL                           0261 00742000
*   GEN(BRWRITE 2);                                                0262 00743000
         BRWRITE 2                                                      00744000
*   SRBRANCH=ADDR(SRBMSG1A);        /* ERROR RETURN POINT FOR THIS 0263 00745000
*                                      BRREAD                        */ 00746000
         LA    @04,SRBMSG1A                                        0263 00747000
         ST    @04,SRBRANCH                                        0263 00748000
*   RESPECIFY                                                      0264 00749000
*     PREG RESTRICTED;                                             0264 00750000
*   IF SPLTYPE=0 THEN               /* IS THIS AN LSPL               */ 00751000
         L     @04,@PC00002+4                                      0265 00752000
         CLI   SPLTYPE(@04),0                                      0265 00753000
         BNE   @RF00265                                            0265 00754000
*     DO;                           /* YES                           */ 00755000
*       PREG=ADDR(LSPLNQF);         /* SET UP TO READ ADDR OF FIRST     00756000
*                                      SRB ON NONQ QUEUE             */ 00757000
         L     @04,@PC00002                                        0267 00758000
         L     PREG,LSPLPTR(,@04)                                  0267 00759000
*       GEN(BRREAD (PREG));                                        0268 00760000
         BRREAD (PREG)                                                  00761000
*       SRBPTR=CURNTSRB;            /* ADDR OF FIRST SRB ON QUEUE    */ 00762000
         MVC   SRBPTR(4),CURNTSRB(PREG)                            0269 00763000
*       RESPECIFY                                                  0270 00764000
*         PREG UNRESTRICTED;                                       0270 00765000
*       IF DUMPSRBA=0 THEN          /* IS QUEUE EMPTY                */ 00766000
         ICM   @04,7,DUMPSRBA                                      0271 00767000
         BNZ   @RF00271                                            0271 00768000
*         DO;                       /* YES - PRINT MSG AND RETURN    */ 00769000
*QMPTYMSG:                                                         0273 00770000
*           OUTPUT(2:1+LENGTH(SMSG1))=SMSG1;/* PRINT QUEUE EMPTY MSG */ 00771000
QMPTYMSG L     @01,CURBUF(,COMBASE)                                0273 00772000
         MVC   OUTPUT+1(14,@01),SMSG1                              0273 00773000
*           GEN(BRWRITE 2);                                        0274 00774000
         BRWRITE 2                                                      00775000
*           IF ENDSWTCH=SWON THEN   /* IS THIS LAST QUEUE TO BE    0275 00776000
*                                      PROCESSED                     */ 00777000
         TM    ENDSWTCH,B'00010000'                                0275 00778000
         BNO   @RF00275                                            0275 00779000
*             DO;                   /* YES                           */ 00780000
*SRBDONE:                                                          0277 00781000
*               ERRADDR=SRBERSAV;   /* RESOTRE PREVIOUS ERROR RTN  0277 00782000
*                                      ADDR IN COMMON                */ 00783000
SRBDONE  MVC   ERRADDR(4,COMBASE),SRBERSAV                         0277 00784000
*               GO TO SRBEXIT;      /* RETURN TO CALLER              */ 00785000
         B     SRBEXIT                                             0278 00786000
*             END;                                                 0279 00787000
*           ELSE                                                   0280 00788000
*             GO TO FIRSTSYS;       /* PROCESS SYSTEM QUEUE OF SPL   */ 00789000
*         END;                                                     0281 00790000
*       ELSE                                                       0282 00791000
*         DO;                       /* QUEUE IS NOT EMPTY            */ 00792000
@RF00271 DS    0H                                                  0283 00793000
*LASTNONQ:                                                         0283 00794000
*           SRBRANCH=ADDR(BADFSTCK);/* ERROR RETURN POINT FOR THIS 0283 00795000
*                                      BRREAD                        */ 00796000
LASTNONQ LA    @04,BADFSTCK                                        0283 00797000
         ST    @04,SRBRANCH                                        0283 00798000
*           RESPECIFY                                              0284 00799000
*             PREG RESTRICTED;                                     0284 00800000
*           PREG=ADDR(LSPLNQL);     /* SET UP TO READ LAST QUEUE PTR    00801000
*                                      IN LSPL                       */ 00802000
         L     @04,@PC00002                                        0285 00803000
         L     PREG,LSPLPTR(,@04)                                  0285 00804000
         LA    PREG,LSPLNQL(,PREG)                                 0285 00805000
*         END;                                                     0286 00806000
*     END;                                                         0287 00807000
*   ELSE                                                           0288 00808000
*     DO;                           /* SPLTYPE INDICATES GSPL        */ 00809000
         B     @RC00265                                            0288 00810000
@RF00265 DS    0H                                                  0289 00811000
*       PREG=ADDR(GSPLNQF);         /* SET UP TO READ FIRST SRB ON 0289 00812000
*                                      NONQ QUEUE                    */ 00813000
         L     @04,@PC00002                                        0289 00814000
         L     PREG,GSPLPTR(,@04)                                  0289 00815000
*       GEN(BRREAD (PREG));                                        0290 00816000
         BRREAD (PREG)                                                  00817000
*       IF CRNTSRB1=0 THEN          /* IS QUEUE EMPTY                */ 00818000
         ICM   @04,7,CRNTSRB1(PREG)                                0291 00819000
         BZ    @RT00291                                            0291 00820000
*         GO TO QMPTYMSG;           /* YES - PRINT QUEUE EMPTY MSG   */ 00821000
*       ELSE                                                       0293 00822000
*         SRBPTR=CURNTSRB;          /* ADDR OF FIRST SRB ON QUEUE    */ 00823000
         MVC   SRBPTR(4),CURNTSRB(PREG)                            0293 00824000
*LSTNONQ1:                                                         0294 00825000
*       SRBRANCH=ADDR(BADFSTCK);    /* ERROR RETURN POINT FOR THIS 0294 00826000
*                                      BRREAD                        */ 00827000
LSTNONQ1 LA    @04,BADFSTCK                                        0294 00828000
         ST    @04,SRBRANCH                                        0294 00829000
*       PREG=ADDR(GSPLNQL);         /* SET UP TO READ LAST QUEUE PTR    00830000
*                                      IN GSPL                       */ 00831000
         L     @04,@PC00002                                        0295 00832000
         L     PREG,GSPLPTR(,@04)                                  0295 00833000
         LA    PREG,GSPLNQL(,PREG)                                 0295 00834000
*     END;                                                         0296 00835000
*   GEN(BRREAD (PREG));             /* READ LAST QUEUE PTR           */ 00836000
@RC00265 DS    0H                                                  0297 00837000
         BRREAD (PREG)                                                  00838000
*   IF CRNTSRB1^=0 THEN             /* IS PTR TO LAST SRB 0          */ 00839000
         ICM   @04,7,CRNTSRB1(PREG)                                0298 00840000
         BZ    @RF00298                                            0298 00841000
*     DO;                           /* NO                            */ 00842000
*       LASTQPTR=CURNTSRB;          /* PTR TO LAST SRB IN SPL        */ 00843000
         L     LASTQPTR,CURNTSRB(,PREG)                            0300 00844000
*       RESPECIFY                                                  0301 00845000
*         PREG UNRESTRICTED;                                       0301 00846000
*     END;                                                         0302 00847000
*   ELSE                                                           0303 00848000
*     DO;                           /* PRT TO LAST SRB IS 0          */ 00849000
         B     @RC00298                                            0303 00850000
@RF00298 DS    0H                                                  0304 00851000
*NOFSTCK1:                                                         0304 00852000
*       IF NOFSTPTR=SWON THEN       /* IS THERE A PTR TO FIRST SRB IN   00853000
*                                      SPL                           */ 00854000
NOFSTCK1 TM    NOFSTPTR,B'10000000'                                0304 00855000
         BNO   @RF00304                                            0304 00856000
*         DO;                       /* NO - PRINT MSG AND TERMINATE     00857000
*                                      PROCESSING THIS QUEUE         */ 00858000
*           OUTPUT(2:1+LENGTH(SMSG12))=SMSG12;/* PRINT 'UNABLE TO  0306 00859000
*                                      FORMAT MSG'                   */ 00860000
         L     @01,CURBUF(,COMBASE)                                0306 00861000
         MVC   OUTPUT+1(39,@01),SMSG12                             0306 00862000
*           GEN(BRWRITE 2);                                        0307 00863000
         BRWRITE 2                                                      00864000
*           GO TO ENDSWCK;          /* IS THERE ANOTHER QUEUE TO   0308 00865000
*                                      PROCESS                       */ 00866000
         B     ENDSWCK                                             0308 00867000
*         END;                                                     0309 00868000
*       ELSE                                                       0310 00869000
*         DO;                       /* YES - PRINT NO LAST PTR MSG   */ 00870000
@RF00304 DS    0H                                                  0311 00871000
*           NOLSTPTR=SWON;          /* INDICATE NO PTR TO LAST SRB IN   00872000
*                                      SPL                           */ 00873000
         OI    NOLSTPTR,B'01000000'                                0311 00874000
*           OUTPUT(2:1+LENGTH(SMSG6))=SMSG6;/* NO LAST PTR MSG       */ 00875000
         L     @04,CURBUF(,COMBASE)                                0312 00876000
         MVC   OUTPUT+1(27,@04),SMSG6                              0312 00877000
*           GEN(BRWRITE 2);                                        0313 00878000
         BRWRITE 2                                                      00879000
*           GO TO DECREMNT;         /* PROCESS THE FIRST SRB         */ 00880000
         B     DECREMNT                                            0314 00881000
*         END;                                                     0315 00882000
*     END;                                                         0316 00883000
*                                                                  0316 00884000
*   /*****************************************************************/ 00885000
*   /*                                                               */ 00886000
*   /* DETERMINE VALUE FOR LOOP CONTROL WHILE PROCESSING THIS QUEUE  */ 00887000
*   /*                                                               */ 00888000
*   /*****************************************************************/ 00889000
*                                                                  0317 00890000
*NOFSTCK2:                                                         0317 00891000
*   IF NOFSTPTR=SWON THEN           /* IS THERE A PTR TO FIRST SRB   */ 00892000
@RC00298 DS    0H                                                  0317 00893000
NOFSTCK2 TM    NOFSTPTR,B'10000000'                                0317 00894000
         BNO   @RF00317                                            0317 00895000
*     DO;                           /* NO                            */ 00896000
*       SRBPTR=LASTQPTR;            /* PROCESS ONLY 5 SRBS BEGINNING    00897000
*                                      WITH PTR IN SPL TO LAST SRB   */ 00898000
         ST    LASTQPTR,SRBPTR                                     0319 00899000
*       OUTPUT(2:1+LENGTH(SMSG14))=SMSG14;/* PRINT PROCESS 5 SRBS MSG*/ 00900000
         L     @04,CURBUF(,COMBASE)                                0320 00901000
         MVC   OUTPUT+1(74,@04),SMSG14                             0320 00902000
*       GEN(BRWRITE 2);                                            0321 00903000
         BRWRITE 2                                                      00904000
*       PASTLPSW=SWON;              /* INDICATE SPECIAL PROCESSING OF   00905000
*                                      5 SRBS                        */ 00906000
         OI    PASTLPSW,B'00100000'                                0322 00907000
*       MAXCTR=MINLOOP;             /* SET LOOP CONTROL VALUE TO 5   */ 00908000
         LA    MAXCTR,5                                            0323 00909000
*     END;                                                         0324 00910000
*                                                                  0324 00911000
*   /*****************************************************************/ 00912000
*   /*                                                               */ 00913000
*   /* DECREMNT LOOP VALUE AND ATTEMPT TO ACCESS THIS SRB            */ 00914000
*   /*                                                               */ 00915000
*   /*****************************************************************/ 00916000
*                                                                  0325 00917000
*DECREMNT:                                                         0325 00918000
*   MAXCTR=MAXCTR-1;                /* DECREMENT LOOP CONTROL VALUE  */ 00919000
@RF00317 DS    0H                                                  0325 00920000
DECREMNT BCTR  MAXCTR,0                                            0325 00921000
*   SRBRANCH=ADDR(SRBMSG8);         /* ERROR RETURN POINT FOR THIS 0326 00922000
*                                      BRREAD                        */ 00923000
         LA    @04,SRBMSG8                                         0326 00924000
         ST    @04,SRBRANCH                                        0326 00925000
*   RESPECIFY                                                      0327 00926000
*     PREG RESTRICTED;                                             0327 00927000
*   PREG=SRBPTR;                    /* SET UP TO READ SRB            */ 00928000
         L     PREG,SRBPTR                                         0328 00929000
*   GEN(BRREAD (PREG));                                            0329 00930000
         BRREAD (PREG)                                                  00931000
*   IF VALIDCK^='SRB' THEN          /* DOES SRB VALIDITY CHK @YM06904*/ 00932000
         CLC   VALIDCK(3,PREG),@CC00852                            0330 00933000
         BE    @RF00330                                            0330 00934000
*     DO;                           /* NO                            */ 00935000
*       OUTPUT(2:1+LENGTH(SMSG9))=SMSG9;/* PRINT VALIDITY CHECK MSG  */ 00936000
         L     @04,CURBUF(,COMBASE)                                0332 00937000
         MVC   OUTPUT+1(25,@04),SMSG9                              0332 00938000
*       GEN(BRWRITE 2);                                            0333 00939000
         BRWRITE 2                                                      00940000
*     END;                                                         0334 00941000
*   RESPECIFY                                                      0335 00942000
*     PREG UNRESTRICTED;                                           0335 00943000
*                                                                  0335 00944000
@RF00330 DS    0H                                                  0336 00945000
*   /*****************************************************************/ 00946000
*   /*                                                               */ 00947000
*   /* FORMATTING SRB                                                */ 00948000
*   /*                                                               */ 00949000
*   /*****************************************************************/ 00950000
*                                                                  0336 00951000
*   SRBRANCH=ADDR(SRBMSG10);        /* ERROR RETURN POINT FOR BRREADS   00952000
*                                      BY GFR                        */ 00953000
         LA    @04,SRBMSG10                                        0336 00954000
         ST    @04,SRBRANCH                                        0336 00955000
*   RESPECIFY                                                      0337 00956000
*    (R0,                                                          0337 00957000
*     R1) RESTRICTED;                                              0337 00958000
*   R0=0;                           /* 0 ASID FOR RDC                */ 00959000
         SLR   R0,R0                                               0338 00960000
*   DO I=1 TO DIM(SRBFMTBL);        /* CALL THE FORMAT RTN TO FORMAT    00961000
*                                      THE SRB ONE LINE AT A TIME    */ 00962000
         LA    I,1                                                 0339 00963000
@DL00339 DS    0H                                                  0340 00964000
*     R1=SRBFMTBL(I);               /* ADDRESS OF EACH LINE TO BE  0340 00965000
*                                      FORMATTED                     */ 00966000
         LR    @04,I                                               0340 00967000
         SLA   @04,2                                               0340 00968000
         L     R1,SRBFMTBL-4(@04)                                  0340 00969000
*     CALL AMDPRGFR;                                               0341 00970000
         L     @15,AFMTLINE(,COMBASE)                              0341 00971000
         BALR  @14,@15                                             0341 00972000
*     GEN(BRWRITE 1);               /* PRINT THE FORMATTED LINE      */ 00973000
         BRWRITE 1                                                      00974000
*   END;                                                           0343 00975000
         AH    I,@CH00077                                          0343 00976000
         CH    I,@CH00294                                          0343 00977000
         BNH   @DL00339                                            0343 00978000
*   GEN(BRWRITE 2);                 /* SKIP TWO LINES                */ 00979000
         BRWRITE 2                                                      00980000
*   RESPECIFY                                                      0345 00981000
*    (R0,                                                          0345 00982000
*     R1) UNRESTRICTED;                                            0345 00983000
*                                                                  0345 00984000
*   /*****************************************************************/ 00985000
*   /*                                                               */ 00986000
*   /* FOLLOWING LINK FIELD IN SRB TO GET THE NEXT ON THE QUEUE      */ 00987000
*   /*                                                               */ 00988000
*   /*****************************************************************/ 00989000
*                                                                  0346 00990000
*FWDPTR:                                                           0346 00991000
*   SRBRANCH=ADDR(SRBMSG11);        /* ERROR RETURN POINT FOR THIS 0346 00992000
*                                      BRREAD                        */ 00993000
FWDPTR   LA    @04,SRBMSG11                                        0346 00994000
         ST    @04,SRBRANCH                                        0346 00995000
*   RESPECIFY                                                      0347 00996000
*     PREG RESTRICTED;                                             0347 00997000
*   PREG=ADDR(SRBFLNK);             /* SET UP TO READ NEXT SRB ON THE   00998000
*                                      QUEUE                         */ 00999000
         L     PREG,SRBPTR                                         0348 01000000
         LA    PREG,SRBFLNK(,PREG)                                 0348 01001000
*   GEN(BRREAD (PREG));                                            0349 01002000
         BRREAD (PREG)                                                  01003000
*   SFWDPTR=CURNTSRB;               /* ADDR OF NEXT SRB ON QUEUE     */ 01004000
         L     SFWDPTR,CURNTSRB(,PREG)                             0350 01005000
*   RESPECIFY                                                      0351 01006000
*     PREG UNRESTRICTED;                                           0351 01007000
*                                                                  0351 01008000
*   /*****************************************************************/ 01009000
*   /*                                                               */ 01010000
*   /* PROCESSING SRBS BEGINNING WITH SRB POINTED TO BY LAST QUEUE   */ 01011000
*   /* POINTER IN SPL - SPECIAL PROCESSING MODE                      */ 01012000
*   /*                                                               */ 01013000
*   /*****************************************************************/ 01014000
*                                                                  0352 01015000
*   IF PASTLPSW=SWON THEN           /* IS THIS SPECIAL PROCESSING  0352 01016000
*                                      MODE                          */ 01017000
         TM    PASTLPSW,B'00100000'                                0352 01018000
         BNO   @RF00352                                            0352 01019000
*     DO;                           /* YES                           */ 01020000
*       IF SFWDPTR=0 THEN           /* IS LINK FIELD PTR 0           */ 01021000
         LTR   SFWDPTR,SFWDPTR                                     0354 01022000
         BZ    @RT00354                                            0354 01023000
*         GO TO ENDSWCK;            /* YES - WAS THIS THE LAST QUEUE */ 01024000
*       ELSE                                                       0356 01025000
*         DO;                       /* NO - LINK FIELD PTR WAS NOT 0 */ 01026000
*PTRSWAP2:                                                         0357 01027000
*           SRBPTR=SFWDPTR;         /* SET UP TO PROCESS NEXT SRB    */ 01028000
*                                                                  0357 01029000
PTRSWAP2 ST    SFWDPTR,SRBPTR                                      0357 01030000
*           /*********************************************************/ 01031000
*           /*                                                       */ 01032000
*           /* CHECK FOR LOOP IN THIS CHAIN                          */ 01033000
*           /*                                                       */ 01034000
*           /*********************************************************/ 01035000
*                                                                  0358 01036000
*MAXCTRCK:                                                         0358 01037000
*           IF MAXCTR<=0 THEN       /* IS THERE A LOOP IN CHAIN      */ 01038000
MAXCTRCK LTR   MAXCTR,MAXCTR                                       0358 01039000
         BP    @RF00358                                            0358 01040000
*             DO;                   /* YES                           */ 01041000
*               IF PASTLPSW=SWOFF THEN/* IS THIS SPECIAL PROCESSING     01042000
*                                      MODE                          */ 01043000
         TM    PASTLPSW,B'00100000'                                0360 01044000
         BNZ   @RF00360                                            0360 01045000
*                 DO;               /* NO                            */ 01046000
*                   OUTPUT(2:1+LENGTH(SMSG15))=SMSG15;/* PRINT LOOP     01047000
*                                      IN SRB CHAIN MSG              */ 01048000
         L     @04,CURBUF(,COMBASE)                                0362 01049000
         MVC   OUTPUT+1(49,@04),SMSG15                             0362 01050000
*                   GEN(BRWRITE 2);                                0363 01051000
         BRWRITE 2                                                      01052000
*                   IF NOLSTPTR=SWOFF THEN/* IS THIS QUEUE TO BE   0364 01053000
*                                      TERMINATED - NO LAST PTR TO 0364 01054000
*                                      FOLLOW                        */ 01055000
         TM    NOLSTPTR,B'01000000'                                0364 01056000
         BNZ   @RF00364                                            0364 01057000
*                     DO;           /* NO                            */ 01058000
*                       OUTPUT(2:1+LENGTH(SMSG14))=SMSG14;/* PRINT 0366 01059000
*                                      PROCESS 5 SRBS MSG            */ 01060000
         L     @04,CURBUF(,COMBASE)                                0366 01061000
         MVC   OUTPUT+1(74,@04),SMSG14                             0366 01062000
*                       GEN(BRWRITE 2);                            0367 01063000
         BRWRITE 2                                                      01064000
*                       GO TO PTRSWAP1;/* CONTINUE DOWN QUEUE        */ 01065000
         B     PTRSWAP1                                            0368 01066000
*                     END;                                         0369 01067000
*                   ELSE                                           0370 01068000
*                     DO;           /* YES - QUEUE IS TO BE        0370 01069000
*                                      TERMINATED                    */ 01070000
@RF00364 DS    0H                                                  0371 01071000
*                       OUTPUT(2:1+LENGTH(SMSG17))=SMSG17;/* PRINT 0371 01072000
*                                      PROCESSING TERMINATED MSG     */ 01073000
         L     @01,CURBUF(,COMBASE)                                0371 01074000
         MVC   OUTPUT+1(36,@01),SMSG17                             0371 01075000
*                       GEN(BRWRITE 2);                            0372 01076000
         BRWRITE 2                                                      01077000
*                     END;                                         0373 01078000
*                 END;                                             0374 01079000
*               ELSE                                               0375 01080000
*                 DO;               /* IT IS IN SPECIAL PROCESSING 0375 01081000
*                                      MODE                          */ 01082000
         B     @RC00360                                            0375 01083000
@RF00360 DS    0H                                                  0376 01084000
*                   OUTPUT(2:1+LENGTH(SMSG16))=SMSG16;/* PRINT MORE     01085000
*                                      THAN 5 SRBS FOUND MSG         */ 01086000
         L     @01,CURBUF(,COMBASE)                                0376 01087000
         MVC   OUTPUT+1(73,@01),SMSG16                             0376 01088000
*                   GEN(BRWRITE 2);                                0377 01089000
         BRWRITE 2                                                      01090000
*                 END;                                             0378 01091000
*ENDSWCK:                                                          0379 01092000
*               IF ENDSWTCH=SWON THEN/* IS PROCESSING COMPLETED      */ 01093000
@RC00360 DS    0H                                                  0379 01094000
ENDSWCK  TM    ENDSWTCH,B'00010000'                                0379 01095000
         BO    @RT00379                                            0379 01096000
*                 GO TO SRBDONE;    /* YES - PREPARE TO RETURN       */ 01097000
*               ELSE                                               0381 01098000
*                 GO TO FIRSTSYS;   /* NO - PROCESS SYSTEM QUEUE OF     01099000
*                                      SPL                           */ 01100000
         B     FIRSTSYS                                            0381 01101000
*             END;                                                 0382 01102000
*           ELSE                                                   0383 01103000
*             GO TO DECREMNT;       /* NO LOOP IN CHAIN - PROCESS  0383 01104000
*                                      THIS SRB                      */ 01105000
*         END;                                                     0384 01106000
*     END;                                                         0385 01107000
*                                                                  0385 01108000
*   /*****************************************************************/ 01109000
*   /*                                                               */ 01110000
*   /* CHECK FOR EXPECTED END OF AN SPL QUEUE - SMQ WILL ALWAYS FAIL */ 01111000
*   /* CHECK AS LASTQPTR WILL STILL BE ZERO                          */ 01112000
*   /*                                                               */ 01113000
*   /*****************************************************************/ 01114000
*                                                                  0386 01115000
*   IF SRBPTR=LASTQPTR THEN         /* IS THIS THE END OF QUEUE      */ 01116000
@RF00352 C     LASTQPTR,SRBPTR                                     0386 01117000
         BNE   @RF00386                                            0386 01118000
*     DO;                           /* YES                           */ 01119000
*       IF SFWDPTR=0 THEN           /* IS FORWARD PTR 0              */ 01120000
         LTR   SFWDPTR,SFWDPTR                                     0388 01121000
         BZ    @RT00388                                            0388 01122000
*         GO TO ENDSWCK;            /* YES - WAS THIS LAST QUEUE     */ 01123000
*                                                                  0389 01124000
*       /*************************************************************/ 01125000
*       /*                                                           */ 01126000
*       /* SET UP TO PROCESS 5 SRBS BEGINNING WITH LAST EXPECTED SRB */ 01127000
*       /* - SPECIAL PROCESSING MODE                                 */ 01128000
*       /*                                                           */ 01129000
*       /*************************************************************/ 01130000
*                                                                  0390 01131000
*       ELSE                                                       0390 01132000
*         DO;                       /* FORWARD POINTER WAS NOT ZERO  */ 01133000
*           SRBPTR=SFWDPTR;         /* SET UP TO PROCESS NEXT SRB    */ 01134000
         ST    SFWDPTR,SRBPTR                                      0391 01135000
*           OUTPUT(2:1+LENGTH(SMSG13))=SMSG13;/* PRINT NON-ZERO    0392 01136000
*                                      FORWARD PTR MSG               */ 01137000
         L     @04,CURBUF(,COMBASE)                                0392 01138000
         MVC   OUTPUT+1(116,@04),SMSG13                            0392 01139000
*           GEN(BRWRITE 2);                                        0393 01140000
         BRWRITE 2                                                      01141000
*         END;                                                     0394 01142000
*     END;                                                         0395 01143000
*   ELSE                                                           0396 01144000
*     DO;                           /* THIS IS NOT THE END OF THE  0396 01145000
*                                      QUEUE                         */ 01146000
         B     @RC00386                                            0396 01147000
@RF00386 DS    0H                                                  0397 01148000
*       IF SFWDPTR^=0 THEN          /* IS FORWARD PTR 0              */ 01149000
         LTR   SFWDPTR,SFWDPTR                                     0397 01150000
         BNZ   @RT00397                                            0397 01151000
*         GO TO PTRSWAP2;           /* NO - PROCESS NEXT SRB         */ 01152000
*       IF QFLAG=SWOFF THEN         /* IS THIS AN SMQ                */ 01153000
         L     @04,@PC00002                                        0399 01154000
         TM    QFLAG(@04),B'10000000'                              0399 01155000
         BZ    @RT00399                                            0399 01156000
*         GO TO SRBDONE;            /* YES - PREPARE TO RETURN       */ 01157000
*       OUTPUT(2:1+LENGTH(SMSG11))=SMSG11;/* PRINT SRB CHAIN BROKEN     01158000
*                                      MSG                           */ 01159000
         L     @04,CURBUF(,COMBASE)                                0401 01160000
         MVC   OUTPUT+1(16,@04),SMSG11                             0401 01161000
*       GEN(BRWRITE 2);                                            0402 01162000
*                                                                  0402 01163000
         BRWRITE 2                                                      01164000
*       /*************************************************************/ 01165000
*       /*                                                           */ 01166000
*       /* IF THIS IS AN SMQ - TERMINATE PROCESSING AS LINK FIELD    */ 01167000
*       /* CONTAINS ZEROS - IF THIS IS AN SPL DETERMINE IF THIS WAS  */ 01168000
*       /* THE LAST QUEUE TO BE PROCESSED                            */ 01169000
*       /*                                                           */ 01170000
*       /*************************************************************/ 01171000
*                                                                  0403 01172000
*       IF NOLSTPTR=SWON THEN       /* IS THIS QUEUE TO BE TERMINATED   01173000
*                                      - NO LAST PTR TO FOLLOW       */ 01174000
         TM    NOLSTPTR,B'01000000'                                0403 01175000
         BNO   @RF00403                                            0403 01176000
*         DO;                       /* YES                           */ 01177000
*           OUTPUT(2:1+LENGTH(SMSG7))=SMSG7;/* PRINT END OF QUEUE MSG*/ 01178000
         L     @01,CURBUF(,COMBASE)                                0405 01179000
         MVC   OUTPUT+1(61,@01),SMSG7                              0405 01180000
*           GEN(BRWRITE 2);                                        0406 01181000
         BRWRITE 2                                                      01182000
*           GO TO ENDSWCK;          /* WAS THIS THE LAST QUEUE       */ 01183000
         B     ENDSWCK                                             0407 01184000
*         END;                                                     0408 01185000
*       ELSE                                                       0409 01186000
*         DO;                       /* NO - THIS QUEUE DOES HAVE A 0409 01187000
*                                      LAST PTR                      */ 01188000
@RF00403 DS    0H                                                  0410 01189000
*           OUTPUT(2:1+LENGTH(SMSG14))=SMSG14;/* PRINT PROCESS 5 SRBS   01190000
*                                      MSG                           */ 01191000
         L     @04,CURBUF(,COMBASE)                                0410 01192000
         MVC   OUTPUT+1(74,@04),SMSG14                             0410 01193000
*           GEN(BRWRITE 2);                                        0411 01194000
         BRWRITE 2                                                      01195000
*         END;                                                     0412 01196000
*PTRSWAP1:                                                         0413 01197000
*       SRBPTR=LASTQPTR;            /* SET UP TO PROCESS 5 MORE      */ 01198000
PTRSWAP1 ST    LASTQPTR,SRBPTR                                     0413 01199000
*     END;                                                         0414 01200000
*                                                                  0414 01201000
*   /*****************************************************************/ 01202000
*   /*                                                               */ 01203000
*   /* REMAINDER OF SET UP FOR SPECIAL PROCESSING OF 5 SRBS          */ 01204000
*   /*                                                               */ 01205000
*   /*****************************************************************/ 01206000
*                                                                  0415 01207000
*   NOLSTPTR=SWON;                  /* INDICATE NO PTR TO LAST SRB IN   01208000
*                                      SPL                           */ 01209000
@RC00386 DS    0H                                                  0416 01210000
*   PASTLPSW=SWON;                  /* INDICATE SPECIAL PROCESSING OF   01211000
*                                      5 SRBS                        */ 01212000
         OI    NOLSTPTR,B'01100000'                                0416 01213000
*   MAXCTR=MINLOOP;                 /* SET LOOP CONTROL VALUE TO 5   */ 01214000
         LA    MAXCTR,5                                            0417 01215000
*   GO TO DECREMNT;                 /* PROCESS MAX OF FIVE MORE SRBS */ 01216000
*                                                                  0418 01217000
         B     DECREMNT                                            0418 01218000
*   /*****************************************************************/ 01219000
*   /*                                                               */ 01220000
*   /* PROCESSING OF SYSTEM QUEUE IN SPL                             */ 01221000
*   /*                                                               */ 01222000
*   /*****************************************************************/ 01223000
*                                                                  0419 01224000
*FIRSTSYS:                                                         0419 01225000
*   NOFSTPTR=SWOFF;                 /* RESET SWITCH                  */ 01226000
FIRSTSYS DS    0H                                                  0420 01227000
*   NOLSTPTR=SWOFF;                 /* RESET SWITCH                  */ 01228000
*   PASTLPSW=SWOFF;                 /* RESET SWITCH                  */ 01229000
*   ENDSWTCH=SWON;                  /* THIS IS THE LAST QUEUE IN SPL    01230000
*                                      TO BE PROCESSED               */ 01231000
         OI    ENDSWTCH,B'00010000'                                0422 01232000
         NI    NOFSTPTR,B'00011111'                                0422 01233000
*   LASTQPTR=0;                     /* RESET VALUE                   */ 01234000
         SLR   LASTQPTR,LASTQPTR                                   0423 01235000
*   MAXCTR=SRBMAX;                  /* LOOP CONTROL VALUE FROM COMMON*/ 01236000
         LH    MAXCTR,SRBMAX(,COMBASE)                             0424 01237000
*   OUTPUT(6:5+LENGTH(SYSTITLE))=SYSTITLE;/* PRINT TITLE             */ 01238000
         L     @04,CURBUF(,COMBASE)                                0425 01239000
         MVC   OUTPUT+5(12,@04),SYSTITLE                           0425 01240000
*   GEN(BRWRITE 2);                                                0426 01241000
         BRWRITE 2                                                      01242000
*   SRBRANCH=ADDR(SRBMSG1B);        /* ERROR RETURN POINT FOR THIS 0427 01243000
*                                      BRREAD                        */ 01244000
         LA    @04,SRBMSG1B                                        0427 01245000
         ST    @04,SRBRANCH                                        0427 01246000
*   RESPECIFY                                                      0428 01247000
*     PREG RESTRICTED;                                             0428 01248000
*   IF SPLTYPE=0 THEN               /* IS THIS AN LSPL               */ 01249000
         L     @04,@PC00002+4                                      0429 01250000
         CLI   SPLTYPE(@04),0                                      0429 01251000
         BNE   @RF00429                                            0429 01252000
*     DO;                           /* YES                           */ 01253000
*       PREG=ADDR(LSPLSYSF);        /* SET UP TO READ ADDR OF FIRST     01254000
*                                      SRB ON SYSTEM QUEUE           */ 01255000
         L     @04,@PC00002                                        0431 01256000
         L     PREG,LSPLPTR(,@04)                                  0431 01257000
         LA    PREG,LSPLSYSF(,PREG)                                0431 01258000
*       GEN(BRREAD (PREG));                                        0432 01259000
         BRREAD (PREG)                                                  01260000
*       IF CRNTSRB1=0 THEN          /* IS QUEUE EMPTY                */ 01261000
         ICM   @04,7,CRNTSRB1(PREG)                                0433 01262000
         BZ    @RT00433                                            0433 01263000
*         GO TO QMPTYMSG;           /* YES - PRINT QUEUE EMPTY MSG   */ 01264000
*       ELSE                                                       0435 01265000
*         SRBPTR=CURNTSRB;          /* ADDR OF FIRST SRB ON QUEUE    */ 01266000
         MVC   SRBPTR(4),CURNTSRB(PREG)                            0435 01267000
*LASTSYS:                                                          0436 01268000
*       SRBRANCH=ADDR(BADFSTCK);    /* ERROR RETURN POINT FOR THIS 0436 01269000
*                                      BRREAD                        */ 01270000
LASTSYS  LA    @04,BADFSTCK                                        0436 01271000
         ST    @04,SRBRANCH                                        0436 01272000
*       PREG=ADDR(LSPLSYSL);        /* SET UP TO READ ADDR OF LAST 0437 01273000
*                                      SRB ON SYSTEM QUEUE           */ 01274000
         L     @04,@PC00002                                        0437 01275000
         L     PREG,LSPLPTR(,@04)                                  0437 01276000
         LA    PREG,LSPLSYSL(,PREG)                                0437 01277000
*     END;                                                         0438 01278000
*   ELSE                                                           0439 01279000
*     DO;                           /* SPLTYPE INDICATES GSPL        */ 01280000
         B     @RC00429                                            0439 01281000
@RF00429 DS    0H                                                  0440 01282000
*       PREG=ADDR(GSPLSYSF);        /* SET UP TO READ ADDR OF FIRST     01283000
*                                      SRB ON SYSTEM QUEUE           */ 01284000
         L     @04,@PC00002                                        0440 01285000
         L     PREG,GSPLPTR(,@04)                                  0440 01286000
         LA    PREG,GSPLSYSF(,PREG)                                0440 01287000
*       GEN(BRREAD (PREG));                                        0441 01288000
         BRREAD (PREG)                                                  01289000
*       IF CRNTSRB1=0 THEN          /* IS QUEUE EMPTY                */ 01290000
         ICM   @04,7,CRNTSRB1(PREG)                                0442 01291000
         BZ    @RT00442                                            0442 01292000
*         GO TO QMPTYMSG;           /* YES - PRINT QUEUE EMPTY MSG   */ 01293000
*       ELSE                                                       0444 01294000
*         SRBPTR=CURNTSRB;          /* ADDR OF FIRST SRB ON QUEUE    */ 01295000
         MVC   SRBPTR(4),CURNTSRB(PREG)                            0444 01296000
*LSTSYS1:                                                          0445 01297000
*       SRBRANCH=ADDR(BADFSTCK);    /* ERROR RETURN POINT FOR THIS 0445 01298000
*                                      BRREAD                        */ 01299000
LSTSYS1  LA    @04,BADFSTCK                                        0445 01300000
         ST    @04,SRBRANCH                                        0445 01301000
*       PREG=ADDR(GSPLSYSL);        /* SET UP TO READ ADDR OF LAST 0446 01302000
*                                      SRB ON SYSTEM QUEUE IN GSPL   */ 01303000
         L     @04,@PC00002                                        0446 01304000
         L     PREG,GSPLPTR(,@04)                                  0446 01305000
         LA    PREG,GSPLSYSL(,PREG)                                0446 01306000
*     END;                                                         0447 01307000
*   GEN(BRREAD (PREG));             /* READ LAST QUEUE PTR           */ 01308000
@RC00429 DS    0H                                                  0448 01309000
         BRREAD (PREG)                                                  01310000
*   IF CRNTSRB1=0 THEN              /* IS PTR TO LAST SRB 0          */ 01311000
         ICM   @04,7,CRNTSRB1(PREG)                                0449 01312000
         BZ    @RT00449                                            0449 01313000
*     GO TO NOFSTCK1;               /* YES - SEE IF THERE IS A FIRST    01314000
*                                      PTR                           */ 01315000
*   ELSE                                                           0451 01316000
*     DO;                                                          0451 01317000
*       LASTQPTR=CURNTSRB;          /* ADDR OF LAST SRB FROM SPL     */ 01318000
         L     LASTQPTR,CURNTSRB(,PREG)                            0452 01319000
*       RESPECIFY                                                  0453 01320000
*         PREG UNRESTRICTED;                                       0453 01321000
*       GO TO NOFSTCK2;             /* IS THERE A FIRST SRB PTR IN 0454 01322000
*                                      SPL                           */ 01323000
         B     NOFSTCK2                                            0454 01324000
*     END;                                                         0455 01325000
*                                                                  0455 01326000
*   /*****************************************************************/ 01327000
*   /*                                                               */ 01328000
*   /* BRREAD ERROR ROUTINE - REESTABLISH ADDRESSABILITY AND BRANCH  */ 01329000
*   /* TO ADDRESS PUT IN SRBRANCH PRIOR TO BRREAD                    */ 01330000
*   /*                                                               */ 01331000
*   /*****************************************************************/ 01332000
*                                                                  0456 01333000
*SRBERRTN:                          /* SET UP ADDRESSABILITY FOR   0456 01334000
*                                      BRREAD ROUTINE                */ 01335000
*   GEN;                                                           0456 01336000
SRBERRTN DS    0H                                                  0456 01337000
         USING *,R15                                                    01338000
         L     R13,SRBSAVRG                                             01339000
         LM    R14,R12,12(R13)                                          01340000
         DROP  R15                                                      01341000
*   GO TO READERR;                  /* BRANCH TO SPECIFIC FUNCTION   */ 01342000
*                                                                  0457 01343000
         L     @04,SRBRANCH                                        0457 01344000
         BR    @04                                                 0457 01345000
*   /*****************************************************************/ 01346000
*   /*                                                               */ 01347000
*   /* READ FAILED TRYING TO FIND POINTER TO FIRST SRB IN NONQ QUEUE */ 01348000
*   /* OF SPL                                                        */ 01349000
*   /*                                                               */ 01350000
*   /*****************************************************************/ 01351000
*                                                                  0458 01352000
*SRBMSG1A:                                                         0458 01353000
*   OUTPUT(2:1+LENGTH(SMSG3))=SMSG3;/* PRINT ERROR FINDING FIRST SRB    01354000
*                                      PTR MSG                       */ 01355000
SRBMSG1A L     @04,CURBUF(,COMBASE)                                0458 01356000
         MVC   OUTPUT+1(34,@04),SMSG3                              0458 01357000
*   GEN(BRWRITE 2);                                                0459 01358000
         BRWRITE 2                                                      01359000
*   NOFSTPTR=SWON;                  /* INDICATE NO PTR TO FIRST SRB     01360000
*                                      IN SPL                        */ 01361000
         OI    NOFSTPTR,B'10000000'                                0460 01362000
*   IF SPLTYPE=0 THEN               /* LSPL IS BEING PROCESSED       */ 01363000
         L     @04,@PC00002+4                                      0461 01364000
         CLI   SPLTYPE(@04),0                                      0461 01365000
         BE    @RT00461                                            0461 01366000
*     GO TO LASTNONQ;               /* GET PTR TO LAST NONQ SRB FROM    01367000
*                                      LSPL                          */ 01368000
*   ELSE                                                           0463 01369000
*     GO TO LSTNONQ1;               /* GET PTR TO LAST NONQ SRB FROM    01370000
*                                      GSPL                          */ 01371000
*                                                                  0463 01372000
         B     LSTNONQ1                                            0463 01373000
*   /*****************************************************************/ 01374000
*   /*                                                               */ 01375000
*   /* READ FAILED TRYING TO FIND POINTER TO FIRST SRB IN SYSTEM     */ 01376000
*   /* QUEUE OF SPL                                                  */ 01377000
*   /*                                                               */ 01378000
*   /*****************************************************************/ 01379000
*                                                                  0464 01380000
*SRBMSG1B:                                                         0464 01381000
*   OUTPUT(2:1+LENGTH(SMSG3))=SMSG3;/* PRINT ERROR FINDING FIRST SRB    01382000
*                                      PTR MSG                       */ 01383000
SRBMSG1B L     @04,CURBUF(,COMBASE)                                0464 01384000
         MVC   OUTPUT+1(34,@04),SMSG3                              0464 01385000
*   GEN(BRWRITE 2);                                                0465 01386000
         BRWRITE 2                                                      01387000
*   NOFSTPTR=SWON;                  /* INDICATE NO PTR TO FIRST SRB     01388000
*                                      IN SPL                        */ 01389000
         OI    NOFSTPTR,B'10000000'                                0466 01390000
*   IF SPLTYPE=0 THEN               /* LSPL IS BEING PROCESSED       */ 01391000
         L     @04,@PC00002+4                                      0467 01392000
         CLI   SPLTYPE(@04),0                                      0467 01393000
         BE    @RT00467                                            0467 01394000
*     GO TO LASTSYS;                /* GET PTR TO LAST SYSTEM SRB  0468 01395000
*                                      FROM LSPL                     */ 01396000
*   ELSE                                                           0469 01397000
*     GO TO LSTSYS1;                /* GET PTR TO LAST SYSTEM SRB  0469 01398000
*                                      FROM GSPL                     */ 01399000
*                                                                  0469 01400000
         B     LSTSYS1                                             0469 01401000
*   /*****************************************************************/ 01402000
*   /*                                                               */ 01403000
*   /* READ FAILED TRYING TO FIND POINTER TO LAST SRB IN EITHER NONQ */ 01404000
*   /* OR SYSTEM QUEUE OF SPL                                        */ 01405000
*   /*                                                               */ 01406000
*   /*****************************************************************/ 01407000
*                                                                  0470 01408000
*BADFSTCK:                                                         0470 01409000
*   IF NOFSTPTR=SWON THEN           /* IS THERE A PTR TO FIRST SRB IN   01410000
*                                      SPL                           */ 01411000
BADFSTCK TM    NOFSTPTR,B'10000000'                                0470 01412000
         BNO   @RF00470                                            0470 01413000
*     DO;                           /* NO                            */ 01414000
*       OUTPUT(2:1+LENGTH(SMSG12))=SMSG12;/* PRINT UNABLE TO FORMAT     01415000
*                                      ANY SRBS MSG                  */ 01416000
         L     @01,CURBUF(,COMBASE)                                0472 01417000
         MVC   OUTPUT+1(39,@01),SMSG12                             0472 01418000
*       GEN(BRWRITE 2);                                            0473 01419000
         BRWRITE 2                                                      01420000
*       GO TO ENDSWCK;              /* WAS THIS THE LAST QUEUE       */ 01421000
         B     ENDSWCK                                             0474 01422000
*     END;                                                         0475 01423000
*   OUTPUT(2:1+LENGTH(SMSG5))=SMSG5;/* PRINT ERROR FINDING LAST SRB     01424000
*                                      PTR MSG                       */ 01425000
@RF00470 L     @04,CURBUF(,COMBASE)                                0476 01426000
         MVC   OUTPUT+1(33,@04),SMSG5                              0476 01427000
*   GEN(BRWRITE 2);                                                0477 01428000
         BRWRITE 2                                                      01429000
*   NOLSTPTR=SWON;                  /* INDICATE NO PTR TO LAST SRB IN   01430000
*                                      SPL                           */ 01431000
         OI    NOLSTPTR,B'01000000'                                0478 01432000
*   GO TO DECREMNT;                 /* PROCESS THIS SRB              */ 01433000
*                                                                  0479 01434000
         B     DECREMNT                                            0479 01435000
*   /*****************************************************************/ 01436000
*   /*                                                               */ 01437000
*   /* READ FAILED TRYING TO FIND POINTER TO FIRST SRB IN SMQ        */ 01438000
*   /*                                                               */ 01439000
*   /*****************************************************************/ 01440000
*                                                                  0480 01441000
*SRBMSG4:                                                          0480 01442000
*   OUTPUT(2:1+LENGTH(SMSG4))=SMSG4;/* PRINT ERROR FINDING FIRST SRB    01443000
*                                      PTR-PROCESSING TERMINATED MSG */ 01444000
SRBMSG4  L     @01,CURBUF(,COMBASE)                                0480 01445000
         MVC   OUTPUT+1(72,@01),SMSG4                              0480 01446000
*   GEN(BRWRITE 2);                                                0481 01447000
         BRWRITE 2                                                      01448000
*   GO TO SRBDONE;                  /* RETURN TO CALLER              */ 01449000
*                                                                  0482 01450000
         B     SRBDONE                                             0482 01451000
*   /*****************************************************************/ 01452000
*   /*                                                               */ 01453000
*   /* READ FAILED TRYING TO FIND ONE OF THE SRB'S ON A QUEUE -      */ 01454000
*   /* CONVERT THE SRB ADDRESS TO PRINTABLE HEX FOR MESSAGE          */ 01455000
*   /*                                                               */ 01456000
*   /*****************************************************************/ 01457000
*                                                                  0483 01458000
*SRBMSG8:                                                          0483 01459000
*   RESPECIFY                                                      0483 01460000
*    (R1,                                                          0483 01461000
*     R4) RESTRICTED;                                              0483 01462000
SRBMSG8  DS    0H                                                  0484 01463000
*   R1=ADDR(SRBPTR);                /* ADDR TO CONVERT               */ 01464000
         LA    R1,SRBPTR                                           0484 01465000
*   R4=ADDR(SADDR8);                /* ADDR OF OUTPUT LOCATION FOR 0485 01466000
*                                      CNVT RTN                      */ 01467000
         LA    R4,SADDR8                                           0485 01468000
*   CALL ADRCNVT;                   /* AADRCNVT RTN                  */ 01469000
         L     @15,AADRCNVT(,COMBASE)                              0486 01470000
         BALR  @14,@15                                             0486 01471000
*   RESPECIFY                                                      0487 01472000
*    (R1,                                                          0487 01473000
*     R4) UNRESTRICTED;                                            0487 01474000
*   OUTPUT(2:1+LENGTH(SMSG8))=SMSG8;/* PRINT ERROR FINDING SRB MSG   */ 01475000
         L     @04,CURBUF(,COMBASE)                                0488 01476000
         MVC   OUTPUT+1(25,@04),SMSG8                              0488 01477000
*   GEN(BRWRITE 2);                                                0489 01478000
         BRWRITE 2                                                      01479000
*   GO TO FWDPTR;                   /* GET PTR TO NEXT SRB ON QUEUE  */ 01480000
*                                                                  0490 01481000
         B     FWDPTR                                              0490 01482000
*   /*****************************************************************/ 01483000
*   /*                                                               */ 01484000
*   /* A READ BY AMDPRGFR FAILED WHILE FORMATTING AN SRB             */ 01485000
*   /*                                                               */ 01486000
*   /*****************************************************************/ 01487000
*                                                                  0491 01488000
*SRBMSG10:                                                         0491 01489000
*   GEN(BRWRITE 1);                 /* PRINT PARTIALLY FILLED BUFFER */ 01490000
SRBMSG10 BRWRITE 1                                                      01491000
*   OUTPUT(2:1+LENGTH(SMSG10))=SMSG10;/* PRINT ERROR FORMATTING SRB     01492000
*                                      MSG                           */ 01493000
         L     @04,CURBUF(,COMBASE)                                0492 01494000
         MVC   OUTPUT+1(26,@04),SMSG10                             0492 01495000
*   GEN(BRWRITE 2);                                                0493 01496000
         BRWRITE 2                                                      01497000
*   GO TO FWDPTR;                   /* GET PTR TO NEXT SRB ON QUEUE  */ 01498000
*                                                                  0494 01499000
         B     FWDPTR                                              0494 01500000
*   /*****************************************************************/ 01501000
*   /*                                                               */ 01502000
*   /* READ FAILED TRYING TO ACCESS THE LINK FIELD IN AN SRB         */ 01503000
*   /*                                                               */ 01504000
*   /*****************************************************************/ 01505000
*                                                                  0495 01506000
*SRBMSG11:                                                         0495 01507000
*   OUTPUT(2:1+LENGTH(SMSG11))=SMSG11;/* PRINT SRB CHAIN BROKEN MSG  */ 01508000
SRBMSG11 L     @04,CURBUF(,COMBASE)                                0495 01509000
         MVC   OUTPUT+1(16,@04),SMSG11                             0495 01510000
*   GEN(BRWRITE 2);                                                0496 01511000
         BRWRITE 2                                                      01512000
*   IF NOLSTPTR=SWON THEN           /* IS THIS QUEUE TO BE TERMINATED   01513000
*                                      - NO LAST PTR TO FOLLOW       */ 01514000
         TM    NOLSTPTR,B'01000000'                                0497 01515000
         BO    @RT00497                                            0497 01516000
*     GO TO ENDSWCK;                /* YES - WAS THIS THE LAST QUEUE */ 01517000
*   ELSE                                                           0499 01518000
*     DO;                           /* NO - THIS QUEUE DOES HAVE A 0499 01519000
*                                      LAST PTR                      */ 01520000
*       OUTPUT(2:1+LENGTH(SMSG14))=SMSG14;/* PRINT PROCESS 5 SRBS MSG*/ 01521000
         L     @04,CURBUF(,COMBASE)                                0500 01522000
         MVC   OUTPUT+1(74,@04),SMSG14                             0500 01523000
*       GEN(BRWRITE 2);                                            0501 01524000
         BRWRITE 2                                                      01525000
*       GO TO PTRSWAP1;             /* SET UP TO PROCESS 5 MORE SRBS */ 01526000
         B     PTRSWAP1                                            0502 01527000
*     END;                                                         0503 01528000
*   END AMDPRSRB;                                                  0504 01529000
@EL00002 DS    0H                                                  0504 01530000
@EF00002 DS    0H                                                  0504 01531000
@ER00002 LM    @14,@12,@SA00002                                    0504 01532000
         BR    @14                                                 0504 01533000
*   END AMDPRFAR                                                   0505 01534000
*                                                                  0505 01535000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01536000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 01537000
*/*%INCLUDE SYSLIB  (IHASPL  )                                       */ 01538000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 01539000
*/*%INCLUDE SYSLIB  (COMMON  )                                       */ 01540000
*                                                                  0505 01541000
*       ;                                                          0505 01542000
@DATA    DS    0H                                                       01543000
@CH00077 DC    H'1'                                                     01544000
@CH00294 DC    H'3'                                                     01545000
@CH00313 DC    H'9'                                                     01546000
@CH00033 DC    H'11'                                                    01547000
         DS    0F                                                       01548000
@AL00150 DC    A(SPLADDR)              LIST WITH   2 ARGUMENT(S)        01549000
         DC    A(FSPLTYPE)                                              01550000
         DS    0F                                                       01551000
@SA00001 DS    18F                                                      01552000
@PC00001 DS    3F                                                       01553000
@SA00002 DS    15F                                                      01554000
@PC00002 DS    2F                                                       01555000
@AL00001 DS    2A                                                       01556000
         DS    0F                                                       01557000
@CA00028 DC    A(AMDPRFAR)                                              01558000
@CA00652 DC    A(SRBRTN)                                                01559000
         DS    0D                                                       01560000
FARSAVRG DC    F'0'                                                     01561000
FARERSAV DC    F'0'                                                     01562000
BRNCHADR DC    A(0)                                                     01563000
SPLADDR  DS    AL4                                                      01564000
         ORG   SPLADDR                                                  01565000
SPLFLAG  DS    BL1                                                      01566000
@NM00057 EQU   SPLADDR+0                                                01567000
SPLPTR   DS    AL3                                                      01568000
         ORG   SPLADDR+4                                                01569000
SRBSAVRG DC    F'0'                                                     01570000
SRBERSAV DC    F'0'                                                     01571000
SRBRANCH DC    A(0)                                                     01572000
INITSW   DC    XL1'00'                                                  01573000
@CC00655 DC    C'ASCB'                                                  01574000
@CC00660 DC    C'ASXB'                                                  01575000
@CC00852 DC    C'SRB'                                                   01576000
FARASID  DS    BL2                                                      01577000
FSPLTYPE DS    BL1                                                      01578000
LOCLTITL DC    CL27'LOCAL SERVICE PRIORITY LIST'                        01579000
MSG01    DS    CL26                                                     01580000
         ORG   MSG01                                                    01581000
@NM00058 DC    CL19'ERROR FINDING ASCB '                                01582000
ADDR1    DS    CL6                                                      01583000
@NM00059 DS    CL1                                                      01584000
         ORG   MSG01+26                                                 01585000
MSG02    DC    CL26'ASCB FAILED VALIDITY CHECK'                         01586000
MSG3     DC    CL27'ERROR WHILE FORMATTING ASCB'                        01587000
MSG4     DC    CL18'ERROR FINDING ASXB'                                 01588000
MSG5     DC    CL26'ASXB FAILED VALIDITY CHECK'                         01589000
MSG6     DC    CL27'ERROR WHILE FORMATTING ASXB'                        01590000
MSG7     DC    CL17'ERROR FINDING SPL'                                  01591000
ASCBLBLS DS    CL293                                                    01592000
         ORG   ASCBLBLS                                                 01593000
LASCBL1  DC    CL32'ASCB+0  ASCBFWDPBWDPLOCKIOSPFSLQ'                   01594000
LASCBL2  DC    CL28'+18  LSLQSPLCPUSASIDSEQNIOSM'                       01595000
LASCBL3  DC    CL25'+2A  RV07DPSTORLDARSMCSCB'                          01596000
LASCBL4  DC    CL23'+3C  TSBEJSTEWSTJSTLECB'                            01597000
LASCBL5  DC    CL33'+58  UBETQSVCDUMPAFFNRCTFFLG1TMCH'                  01598000
LASCBL6  DC    CL32'+6C  ASXBSWCTDSP1FLG2SSRBSRBSVSC'                   01599000
LASCBL7  DC    CL29'+7A  NVSCTCBSCMSFCMSBQECBMECB'                      01600000
LASCBL8  DC    CL29'+90  OUCBOUXBFMCTRS01XMPQIQEA'                      01601000
LASCBL9  DC    CL28'+A4  RTWAMCCJBNIJBNSLGCBVGTT'                       01602000
LASCBL10 DC    CL25'+BC  PCTTRS12SMCTRS14SWTL'                          01603000
LASCBL11 DC    CL9'+C8  SRBT'                                           01604000
         ORG   ASCBLBLS+293                                             01605000
ASXBLBLS DS    CL195                                                    01606000
         ORG   ASXBLBLS                                                 01607000
LASXBL1  DC    CL32'ASXB+0  ASXBFTCBLTCBTCBSRS00MPST'                   01608000
LASXBL2  DC    CL20'+14  LWARV14RV15IHSA'                               01609000
LASXBL3  DC    CL9'+24  FLSA'                                           01610000
LASXBL4  DC    CL3'+48'                                                 01611000
LASXBL5  DC    CL28'+6C  FRWASPSARSMDRCTDDDROUSB'                       01612000
LASXBL6  DC    CL16'+84  TAXEPRGPSWD'                                   01613000
LASXBL7  DC    CL29'+A0  SIRBETSKFIQELIQEFRQELRQE'                      01614000
LASXBL8  DC    CL29'+B8  FSRBLSRBRV16RV17RV18RV19'                      01615000
LASXBL9  DC    CL29'+D0  RV20RV21RV22RV23RV24RV25'                      01616000
         ORG   ASXBLBLS+195                                             01617000
SRBSWS   DS    BL1                                                      01618000
         ORG   SRBSWS                                                   01619000
NOFSTPTR DS    BL1                                                      01620000
NOLSTPTR EQU   SRBSWS+0                                                 01621000
PASTLPSW EQU   SRBSWS+0                                                 01622000
ENDSWTCH EQU   SRBSWS+0                                                 01623000
@NM00063 EQU   SRBSWS+0                                                 01624000
         ORG   SRBSWS+1                                                 01625000
NONQTITL DC    CL20'NON-QUIESCABLE QUEUE'                               01626000
SYSTITLE DC    CL12'SYSTEM QUEUE'                                       01627000
SMSG1    DC    CL14'QUEUE IS EMPTY'                                     01628000
SMSG2    DC    CL68'LOOP CONTROL VALUE IS ZERO, PROCESSING TERMINATED FC01629000
               OR ALL SRB QUEUES'                                       01630000
SMSG3    DC    CL34'ERROR FINDING POINTER TO FIRST SRB'                 01631000
SMSG4    DC    CL72'ERROR FINDING POINTER TO FIRST SRB, PROCESSING TERMC01632000
               INATED FOR THIS QUEUE'                                   01633000
SMSG5    DC    CL33'ERROR FINDING POINTER TO LAST SRB'                  01634000
SMSG6    DC    CL27'POINTER TO LAST SRB IS ZERO'                        01635000
SMSG7    DC    CL61'FORWARD POINTER IS ZERO, PROCESSING TERMINATED FOR C01636000
               THIS QUEUE'                                              01637000
SMSG8    DS    CL25                                                     01638000
         ORG   SMSG8                                                    01639000
@NM00064 DC    CL18'ERROR FINDING SRB '                                 01640000
SADDR8   DS    CL6                                                      01641000
@NM00065 DS    CL1                                                      01642000
         ORG   SMSG8+25                                                 01643000
SMSG9    DC    CL25'SRB FAILED VALIDITY CHECK'                          01644000
SMSG10   DC    CL26'ERROR WHILE FORMATTING SRB'                         01645000
SMSG11   DC    CL16'SRB CHAIN BROKEN'                                   01646000
SMSG12   DC    CL39'UNABLE TO FORMAT ANY SRBS ON THIS QUEUE'            01647000
SMSG13   DC    CL116'ERROR IN SRB CHAIN, LAST EXPECTED SRB HAS NON-ZEROC01648000
                FORWARD POINTER, WILL PROCESS FIVE MORE FOLLOWING FORWAC01649000
               RD POINTER'                                              01650000
SMSG14   DC    CL74'WILL PROCESS FIVE SRBS BEGINNING WITH SRB POINTED TC01651000
               O BY LAST QUEUE POINTER'                                 01652000
SMSG15   DC    CL49'LOOP IN SRB CHAIN, MORE THAN MAXIMUM NUMBER FOUND'  01653000
SMSG16   DC    CL73'PROCESSING TERMINATED FOR THIS CHAIN, MORE THAN FIVC01654000
               E SRBS HAVE BEEN FOUND'                                  01655000
SMSG17   DC    CL36'PROCESSING TERMINATED FOR THIS CHAIN'               01656000
SRBLBLS  DS    CL71                                                     01657000
         ORG   SRBLBLS                                                  01658000
LSRBL1   DC    CL31'SRB+0  IDFLNKASCBCPAFFPASIDPTCB'                    01659000
LSRBL2   DC    CL27'+14  EPRMTRPARMSAVEPKFPRIOR'                        01660000
LSRBL3   DC    CL13'+26  RESVRESV'                                      01661000
         ORG   SRBLBLS+71                                               01662000
         DS    CL3                                                      01663000
CBFMTBL  DC    AL4(PASCBL1)                                             01664000
         DC    AL4(PASCBL2)                                             01665000
         DC    AL4(PASCBL3)                                             01666000
         DC    AL4(PASCBL4)                                             01667000
         DC    AL4(PASCBL5)                                             01668000
         DC    AL4(PASCBL6)                                             01669000
         DC    AL4(PASCBL7)                                             01670000
         DC    AL4(PASCBL8)                                             01671000
         DC    AL4(PASCBL9)                                             01672000
         DC    AL4(PASCBL10)                                            01673000
         DC    AL4(PASCBL11)                                            01674000
XBFMTBL  DC    AL4(PASXBL1)                                             01675000
         DC    AL4(PASXBL2)                                             01676000
         DC    AL4(PASXBL3)                                             01677000
         DC    AL4(PASXBL4)                                             01678000
         DC    AL4(PASXBL5)                                             01679000
         DC    AL4(PASXBL6)                                             01680000
         DC    AL4(PASXBL7)                                             01681000
         DC    AL4(PASXBL8)                                             01682000
         DC    AL4(PASXBL9)                                             01683000
FARPATCH DC    40F'0'                                                   01684000
SRBFMTBL DC    AL4(PSRBL1)                                              01685000
         DC    AL4(PSRBL2)                                              01686000
         DC    AL4(PSRBL3)                                              01687000
AMDPRFAR CSECT                                                          01688000
*                                                                       01689000
DTAE     EQU   32                  DATA EBCDIC BIT                      01690000
DTAC     EQU   16                  DATA IN CORE BIT                     01691000
DTAP     EQU   8                   DATA PTR BIT                         01692000
DTA      EQU   4                   DATA INCLUDED BIT                    01693000
LBLP     EQU   2                   LABEL PTR BIT                        01694000
LBL      EQU   1                   LABEL INCLUDED BIT                   01695000
AMDPRFAR CSECT                                                          01696000
*                                   /* COMMENT DELIMITERS PREVENT       01697000
*                                      MACRO PHASE MODIFICATION         01698000
*********************************************************************** 01699000
*                                                                     * 01700000
*   THE FOLLOWING ARE THE FORMAT PATTERNS FOR THE ASCB                * 01701000
*                                                                     * 01702000
*********************************************************************** 01703000
          SPACE                                                         01704000
PASCBL1  FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),4,3,0,6,ASCBLBLS,ASCBPTR+1    01705000
         FMTPTRN (LBL,DTA,DTAP),8,4,17,26,,(ASCBPTR,0)                  01706000
         FMTPTRN (LBL,DTA),4,4,37,42                                    01707000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01708000
         FMTPTRN (LBL,DTA),4,4,69,74                                    01709000
         FMTPTRN (LBL,DTA),4,4,85,90                                    01710000
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST                           01711000
PASCBL2  FMTPTRN (LBL,DTA),9,4,16,26                                    01712000
         FMTPTRN (LBL,DTA),3,4,37,42                                    01713000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01714000
         FMTPTRN (LBL,DTA),4,2,69,74                                    01715000
         FMTPTRN (LBL,DTA),4,2,85,90                                    01716000
         FMTPTRN (LBL,DTA),4,2,101,106,,,LAST                           01717000
PASCBL3  FMTPTRN (LBL,DTA),9,1,16,26                                    01718000
         FMTPTRN (LBL,DTA),2,1,37,42                                    01719000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01720000
         FMTPTRN (LBL,DTA),3,4,69,74                                    01721000
         FMTPTRN (LBL,DTA),3,4,85,90                                    01722000
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST                           01723000
PASCBL4  FMTPTRN (LBL,DTA),8,4,16,26                                    01724000
         FMTPTRN (LBL,DTA),4,8,37,42                                    01725000
         FMTPTRN (LBL,DTA),4,8,61,66                                    01726000
         FMTPTRN (LBL,DTA),4,4,85,90                                    01727000
         FMTPTRN (LBL,DTA),3,4,101,106,,,LAST                           01728000
PASCBL5  FMTPTRN (LBL,DTA),9,4,16,26                                    01729000
         FMTPTRN (LBL,DTA),4,4,37,42                                    01730000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01731000
         FMTPTRN (LBL,DTA),4,2,69,74                                    01732000
         FMTPTRN (LBL,DTA),4,1,81,86                                    01733000
         FMTPTRN (LBL,DTA),4,1,91,96                                    01734000
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST                           01735000
PASCBL6  FMTPTRN (LBL,DTA),9,4,16,26                                    01736000
         FMTPTRN (LBL,DTA),4,2,37,42                                    01737000
         FMTPTRN (LBL,DTA),4,1,53,58                                    01738000
         FMTPTRN (LBL,DTA),4,1,69,74                                    01739000
         FMTPTRN (LBL,DTA),4,2,81,86                                    01740000
         FMTPTRN (LBL,DTA),4,2,91,96                                    01741000
         FMTPTRN (LBL,DTA),3,2,101,106,,,LAST                           01742000
PASCBL7  FMTPTRN (LBL,DTA),9,2,16,26                                    01743000
         FMTPTRN (LBL,DTA),4,4,37,42                                    01744000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01745000
         FMTPTRN (LBL,DTA),4,4,69,74                                    01746000
         FMTPTRN (LBL,DTA),4,4,85,90                                    01747000
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST                           01748000
PASCBL8  FMTPTRN (LBL,DTA),9,4,16,26                                    01749000
         FMTPTRN (LBL,DTA),4,4,37,42                                    01750000
         FMTPTRN (LBL,DTA),4,2,53,58                                    01751000
         FMTPTRN (LBL,DTA),4,2,69,74                                    01752000
         FMTPTRN (LBL,DTA),4,4,85,90                                    01753000
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST                           01754000
PASCBL9  FMTPTRN (LBL,DTA),9,4,16,26                                    01755000
         FMTPTRN (LBL,DTA),3,4,37,42                                    01756000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01757000
         FMTPTRN (LBL,DTA),4,4,69,74                                    01758000
         FMTPTRN (LBL,DTA),4,4,85,90                                    01759000
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST                           01760000
PASCBL10 FMTPTRN (LBL,DTA),9,4,16,26                                    01761000
         FMTPTRN (LBL,DTA),4,2,37,42                                    01762000
         FMTPTRN (LBL,DTA),4,1,53,58                                    01763000
         FMTPTRN (LBL,DTA),4,1,69,74                                    01764000
         FMTPTRN (LBL,DTA),4,4,85,90,,,LAST                             01765000
PASCBL11 FMTPTRN (LBL,DTA),9,8,16,26,,,LAST                             01766000
AMDPRFAR CSECT                                                          01767000
*                                   /* COMMENT DELINITERS PREVENT       01768000
*                                      MACRO PHASE MODIFICATIONS        01769000
*********************************************************************** 01770000
*                                                                     * 01771000
*   THE FOLLOWING ARE THE FORMAT PATTERNS FOR THE ASXB                * 01772000
*                                                                     * 01773000
*********************************************************************** 01774000
          SPACE                                                         01775000
PASXBL1  FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),4,3,0,6,ASXBLBLS,ASXBADDR+1   01776000
         FMTPTRN (LBL,DTA,DTAP),8,4,17,26,(ASXBADDR,0)                  01777000
         FMTPTRN (LBL,DTA),4,4,37,42                                    01778000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01779000
         FMTPTRN (LBL,DTA),4,2,69,74                                    01780000
         FMTPTRN (LBL,DTA),4,2,85,90                                    01781000
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST                           01782000
PASXBL2  FMTPTRN (LBL,DTA),8,4,16,26                                    01783000
         FMTPTRN (LBL,DTA),4,4,37,42                                    01784000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01785000
         FMTPTRN (LBL,DTA),4,4,69,74,,,LAST                             01786000
PASXBL3  FMTPTRN (LBL,DTA),9,16,16,26                                   01787000
         FMTPTRN (DTA),,16,,62                                          01788000
         FMTPTRN (DTA),,4,,98,,,LAST                                    01789000
PASXBL4  FMTPTRN (LBL,DTA),3,16,16,26                                   01790000
         FMTPTRN (DTA),,16,,62                                          01791000
         FMTPTRN (DTA),,4,,98,,,LAST                                    01792000
PASXBL5  FMTPTRN (LBL,DTA),9,4,16,26                                    01793000
         FMTPTRN (LBL,DTA),4,4,37,42                                    01794000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01795000
         FMTPTRN (LBL,DTA),4,4,69,74                                    01796000
         FMTPTRN (LBL,DTA),3,4,85,90                                    01797000
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST                           01798000
PASXBL6  FMTPTRN (LBL,DTA),9,4,16,26                                    01799000
         FMTPTRN (LBL,DTA),3,16,37,42                                   01800000
         FMTPTRN (LBL,DTA),4,8,85,90,,,LAST                             01801000
PASXBL7  FMTPTRN (LBL,DTA),9,4,16,26                                    01802000
         FMTPTRN (LBL,DTA),4,4,37,42                                    01803000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01804000
         FMTPTRN (LBL,DTA),4,4,69,74                                    01805000
         FMTPTRN (LBL,DTA),4,4,85,90                                    01806000
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST                           01807000
PASXBL8  FMTPTRN (LBL,DTA),9,4,16,26                                    01808000
         FMTPTRN (LBL,DTA),4,4,37,42                                    01809000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01810000
         FMTPTRN (LBL,DTA),4,4,69,74                                    01811000
         FMTPTRN (LBL,DTA),4,4,85,90                                    01812000
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST                           01813000
PASXBL9  FMTPTRN (LBL,DTA),9,4,16,26                                    01814000
         FMTPTRN (LBL,DTA),4,4,37,42                                    01815000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01816000
         FMTPTRN (LBL,DTA),4,4,69,74                                    01817000
         FMTPTRN (LBL,DTA),4,4,85,90                                    01818000
         FMTPTRN (LBL,DTA),4,4,101,106,,,LAST                           01819000
AMDPRFAR CSECT                                                          01820000
*                                   /* COMMENT DELIMITERS PREVENT       01821000
*                                      MACRO PHASE MODIFICATIONS        01822000
*********************************************************************** 01823000
*                                                                     * 01824000
*   THE FOLLOWING ARE THE FORMAT PATTERNS FOR THE SRB                 * 01825000
*                                                                     * 01826000
*********************************************************************** 01827000
          SPACE                                                         01828000
PSRBL1   FMTPTRN (LBL,DTA,LBLP,DTAP,DTAC),3,3,0,6,SRBLBLS,SRBPTR+1      01829000
         FMTPTRN (LBL,DTA,DTAP),6,4,17,26,,(SRBPTR,0)                   01830000
         FMTPTRN (LBL,DTA),4,4,37,42                                    01831000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01832000
         FMTPTRN (LBL,DTA),5,2,69,75                                    01833000
         FMTPTRN (LBL,DTA),5,2,85,91                                    01834000
         FMTPTRN (LBL,DTA),4,4,101,107,,,LAST                           01835000
PSRBL2   FMTPTRN (LBL,DTA),7,4,16,26                                    01836000
         FMTPTRN (LBL,DTA),4,4,37,42                                    01837000
         FMTPTRN (LBL,DTA),4,4,53,58                                    01838000
         FMTPTRN (LBL,DTA),4,4,69,75                                    01839000
         FMTPTRN (LBL,DTA),3,1,85,91                                    01840000
         FMTPTRN (LBL,DTA),5,1,101,107,,,LAST                           01841000
PSRBL3   FMTPTRN (LBL,DTA),9,2,16,26                                    01842000
         FMTPTRN (LBL,DTA),4,4,37,42,,,LAST                             01843000
AMDPRFAR CSECT                                                          01844000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01845000
@01      EQU   01                                                       01846000
@02      EQU   02                                                       01847000
@03      EQU   03                                                       01848000
@04      EQU   04                                                       01849000
@05      EQU   05                                                       01850000
@06      EQU   06                                                       01851000
@07      EQU   07                                                       01852000
@08      EQU   08                                                       01853000
@09      EQU   09                                                       01854000
@10      EQU   10                                                       01855000
@11      EQU   11                                                       01856000
@12      EQU   12                                                       01857000
@13      EQU   13                                                       01858000
@14      EQU   14                                                       01859000
@15      EQU   15                                                       01860000
MAXCTR   EQU   @03                                                      01861000
LASTQPTR EQU   @05                                                      01862000
SFWDPTR  EQU   @02                                                      01863000
I        EQU   @02                                                      01864000
R0       EQU   @00                                                      01865000
R1       EQU   @01                                                      01866000
R4       EQU   @04                                                      01867000
R13      EQU   @13                                                      01868000
COMBASE  EQU   @12                                                      01869000
PREG     EQU   @01                                                      01870000
BASE1    EQU   @11                                                      01871000
BASE2    EQU   @10                                                      01872000
BASE3    EQU   @09                                                      01873000
BUFREG   EQU   @06                                                      01874000
CNTREG   EQU   @03                                                      01875000
LINEREG  EQU   @08                                                      01876000
R10      EQU   @10                                                      01877000
R11      EQU   @11                                                      01878000
R12      EQU   @12                                                      01879000
R14      EQU   @14                                                      01880000
R15      EQU   @15                                                      01881000
R2       EQU   @02                                                      01882000
R3       EQU   @03                                                      01883000
R5       EQU   @05                                                      01884000
R6       EQU   @06                                                      01885000
R7       EQU   @07                                                      01886000
R8       EQU   @08                                                      01887000
R9       EQU   @09                                                      01888000
STOPBASE EQU   @05                                                      01889000
ASCB     EQU   0                                                        01890000
ASCBSPL  EQU   ASCB+28                                                  01891000
ASCBFW1  EQU   ASCB+100                                                 01892000
ASCBRCTF EQU   ASCBFW1+2                                                01893000
ASCBFLG1 EQU   ASCBFW1+3                                                01894000
ASCBASXB EQU   ASCB+108                                                 01895000
ASCBDSP1 EQU   ASCB+114                                                 01896000
ASCBFLG2 EQU   ASCB+115                                                 01897000
SPLENTRY EQU   0                                                        01898000
GSPL     EQU   0                                                        01899000
GSPLNQ   EQU   GSPL                                                     01900000
GSPLNQF  EQU   GSPLNQ                                                   01901000
GSPLNQL  EQU   GSPLNQ+4                                                 01902000
GSPLSYS  EQU   GSPL+8                                                   01903000
GSPLSYSF EQU   GSPLSYS                                                  01904000
GSPLSYSL EQU   GSPLSYS+4                                                01905000
LSPL     EQU   0                                                        01906000
LSPLNQ   EQU   LSPL                                                     01907000
LSPLNQF  EQU   LSPLNQ                                                   01908000
LSPLNQL  EQU   LSPLNQ+4                                                 01909000
LSPLSYS  EQU   LSPL+8                                                   01910000
LSPLSYSF EQU   LSPLSYS                                                  01911000
LSPLSYSL EQU   LSPLSYS+4                                                01912000
SRBSECT  EQU   0                                                        01913000
SRB      EQU   SRBSECT                                                  01914000
SRBFLNK  EQU   SRB+4                                                    01915000
SRBFLC   EQU   SRB+12                                                   01916000
COMMON   EQU   0                                                        01917000
ERRADDR  EQU   COMMON                                                   01918000
CURBUF   EQU   COMMON+48                                                01919000
SWA      EQU   COMMON+122                                               01920000
SWB      EQU   COMMON+123                                               01921000
SWC      EQU   COMMON+124                                               01922000
SWD      EQU   COMMON+125                                               01923000
SWE      EQU   COMMON+126                                               01924000
SWF      EQU   COMMON+127                                               01925000
BUFSW    EQU   COMMON+128                                               01926000
PRSW     EQU   COMMON+129                                               01927000
TABLE    EQU   COMMON+659                                               01928000
HEXTABL  EQU   TABLE+63                                                 01929000
AWRITE   EQU   COMMON+1500                                              01930000
AFMTLINE EQU   COMMON+1512                                              01931000
AADRCNVT EQU   COMMON+1516                                              01932000
DCBADDRS EQU   COMMON+1608                                              01933000
@NM00043 EQU   DCBADDRS+16                                              01934000
@NM00044 EQU   @NM00043                                                 01935000
BRRDDATA EQU   COMMON+1984                                              01936000
AASCBFMT EQU   COMMON+1996                                              01937000
ASRBFMT  EQU   COMMON+2000                                              01938000
AUSREXIT EQU   COMMON+2008                                              01939000
AUSRASID EQU   COMMON+2020                                              01940000
EXITFLAG EQU   COMMON+2022                                              01941000
SRBMAX   EQU   COMMON+2036                                              01942000
I3800SW  EQU   COMMON+2076                                              01943000
TITLEKEY EQU   COMMON+2077                                              01944000
Z9SUBITS EQU   COMMON+2100                                              01945000
Z9SUFLG  EQU   COMMON+2115                                              01946000
AMDPRGFR EQU   0                                                        01947000
AMDPRUIM EQU   0                                                        01948000
ADRCNVT  EQU   0                                                        01949000
OUTPUT   EQU   0                                                        01950000
BREADERR EQU   0                                                        01951000
FARASXB  EQU   0                                                        01952000
FARASXB1 EQU   FARASXB+1                                                01953000
VALIDCK  EQU   0                                                        01954000
FARSPL   EQU   0                                                        01955000
READERR  EQU   0                                                        01956000
CURNTSRB EQU   0                                                        01957000
CRNTSRB1 EQU   CURNTSRB+1                                               01958000
DUMPSRBA EQU   SRBPTR+1                                                 01959000
FSRASCB  EQU   0                                                        01960000
ASCBADDR EQU   FSRASCB+1                                                01961000
PSPLADDR EQU   0                                                        01962000
PSPLTYPE EQU   0                                                        01963000
QUEADDR  EQU   0                                                        01964000
QFLAG    EQU   QUEADDR                                                  01965000
QUEPTR   EQU   QUEADDR+1                                                01966000
SPLTYPE  EQU   0                                                        01967000
GSPLPTR  EQU   QUEADDR                                                  01968000
LSPLPTR  EQU   QUEADDR                                                  01969000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01970000
@NM00062 EQU   QUEADDR                                                  01971000
@NM00055 EQU   FSRASCB                                                  01972000
@NM00061 EQU   SRBPTR                                                   01973000
@NM00060 EQU   CURNTSRB                                                 01974000
@NM00056 EQU   FARASXB                                                  01975000
Z9ERRID  EQU   COMMON+2116                                              01976000
Z9SVCBUF EQU   COMMON+2096                                              01977000
TITLESTK EQU   TITLEKEY+12                                              01978000
@NM00054 EQU   TITLEKEY                                                 01979000
I3800204 EQU   I3800SW                                                  01980000
I380080  EQU   I3800SW                                                  01981000
I3800ULN EQU   I3800SW                                                  01982000
I3800KEY EQU   I3800SW                                                  01983000
@NM00053 EQU   I3800SW                                                  01984000
@NM00052 EQU   I3800SW                                                  01985000
@NM00051 EQU   I3800SW                                                  01986000
@NM00050 EQU   I3800SW                                                  01987000
CSADDR   EQU   COMMON+2072                                              01988000
@NM00049 EQU   COMMON+2070                                              01989000
TOPICHDR EQU   COMMON+2060                                              01990000
DFLTCSA  EQU   COMMON+2056                                              01991000
LPAMAX   EQU   COMMON+2052                                              01992000
DNUCTOP  EQU   COMMON+2048                                              01993000
XLMAX    EQU   COMMON+2044                                              01994000
DQEMAX   EQU   COMMON+2042                                              01995000
ASCBMAX  EQU   COMMON+2040                                              01996000
TCBMAX   EQU   COMMON+2038                                              01997000
DDMAX    EQU   COMMON+2034                                              01998000
DEBMAX   EQU   COMMON+2032                                              01999000
JPQMAX   EQU   COMMON+2030                                              02000000
LLEMAX   EQU   COMMON+2028                                              02001000
PQEMAX   EQU   COMMON+2026                                              02002000
RBMAX    EQU   COMMON+2024                                              02003000
@NM00048 EQU   COMMON+2023                                              02004000
AUSRTCBA EQU   COMMON+2016                                              02005000
AUSRDEL  EQU   COMMON+2012                                              02006000
AUSRINIT EQU   COMMON+2004                                              02007000
BRRDADJ  EQU   COMMON+1992                                              02008000
BRRDINIT EQU   COMMON+1988                                              02009000
BUFERMAP EQU   COMMON+1980                                              02010000
ASCBMAP  EQU   COMMON+1976                                              02011000
CPUMAP   EQU   COMMON+1972                                              02012000
ASIDNDX  EQU   COMMON+1968                                              02013000
@NM00047 EQU   COMMON+1964                                              02014000
HDRTITLE EQU   COMMON+1864                                              02015000
HDRREGS  EQU   COMMON+1696                                              02016000
SACSWCAW EQU   COMMON+1684                                              02017000
ASVTADDR EQU   COMMON+1680                                              02018000
PREFXRGV EQU   COMMON+1676                                              02019000
PREFXRGR EQU   COMMON+1672                                              02020000
CURASCB  EQU   COMMON+1668                                              02021000
IPLCPU   EQU   COMMON+1666                                              02022000
QASID    EQU   COMMON+1664                                              02023000
QAPFT    EQU   COMMON+1660                                              02024000
@NM00046 EQU   COMMON+1656                                              02025000
REALMAX  EQU   COMMON+1652                                              02026000
SEGTABOR EQU   COMMON+1648                                              02027000
REALMAP  EQU   COMMON+1644                                              02028000
@NM00045 EQU   COMMON+1641                                              02029000
EDITER   EQU   COMMON+1640                                              02030000
AROOT    EQU   COMMON+1636                                              02031000
AEDITCB  EQU   COMMON+1632                                              02032000
TRCCOUNT EQU   COMMON+1628                                              02033000
ASYSUDCB EQU   @NM00043+1                                               02034000
ENDLIST  EQU   @NM00044                                                 02035000
AINDCB   EQU   DCBADDRS+12                                              02036000
ARDRDCB  EQU   DCBADDRS+8                                               02037000
APTRDCB  EQU   DCBADDRS+4                                               02038000
AOUTDCB  EQU   DCBADDRS                                                 02039000
ATCBSMRY EQU   COMMON+1604                                              02040000
ATCBSMFR EQU   COMMON+1600                                              02041000
ONGOPTR  EQU   COMMON+1596                                              02042000
AEND     EQU   COMMON+1592                                              02043000
AERRMSGA EQU   COMMON+1584                                              02044000
BUFREINT EQU   COMMON+1580                                              02045000
BUFSUM   EQU   COMMON+1576                                              02046000
APRTSTG  EQU   COMMON+1572                                              02047000
AFORMAT  EQU   COMMON+1568                                              02048000
ASTPROUT EQU   COMMON+1564                                              02049000
APCBENQ  EQU   COMMON+1560                                              02050000
ATCBRTRV EQU   COMMON+1556                                              02051000
ATCBREMV EQU   COMMON+1552                                              02052000
ATCBSAVE EQU   COMMON+1548                                              02053000
QATMERTN EQU   COMMON+1544                                              02054000
ALOADER  EQU   COMMON+1540                                              02055000
AEREXIT  EQU   COMMON+1536                                              02056000
SYNMSGA  EQU   COMMON+1532                                              02057000
STOPEXIT EQU   COMMON+1528                                              02058000
ARGNBND  EQU   COMMON+1524                                              02059000
AWRDCNVT EQU   COMMON+1520                                              02060000
ASYNTAX  EQU   COMMON+1508                                              02061000
APRTMSG  EQU   COMMON+1504                                              02062000
NONBLNK  EQU   COMMON+1244                                              02063000
BLNK     EQU   COMMON+988                                               02064000
@NM00042 EQU   COMMON+972                                               02065000
@NM00041 EQU   COMMON+915                                               02066000
EBCTABL  EQU   HEXTABL+10                                               02067000
@NM00040 EQU   HEXTABL                                                  02068000
@NM00039 EQU   TABLE                                                    02069000
CAPTABL  EQU   COMMON+403                                               02070000
TITLEPGE EQU   COMMON+394                                               02071000
@NM00038 EQU   COMMON+392                                               02072000
TITLETME EQU   COMMON+379                                               02073000
@NM00037 EQU   COMMON+377                                               02074000
TITLEDTE EQU   COMMON+364                                               02075000
@NM00036 EQU   COMMON+362                                               02076000
TITLEMOD EQU   COMMON+347                                               02077000
TITLEMSG EQU   COMMON+283                                               02078000
MSG2     EQU   COMMON+257                                               02079000
MSG1     EQU   COMMON+231                                               02080000
STOP     EQU   COMMON+227                                               02081000
TITLE    EQU   COMMON+222                                               02082000
BLANKS   EQU   COMMON+214                                               02083000
WTORMSG  EQU   COMMON+133                                               02084000
@NM00035 EQU   COMMON+130                                               02085000
@NM00034 EQU   PRSW                                                     02086000
@NM00033 EQU   PRSW                                                     02087000
PRNTREAL EQU   PRSW                                                     02088000
PRNTRL   EQU   PRSW                                                     02089000
TTLSW    EQU   PRSW                                                     02090000
@NM00032 EQU   PRSW                                                     02091000
QSEGTBSW EQU   PRSW                                                     02092000
@NM00031 EQU   PRSW                                                     02093000
@NM00030 EQU   BUFSW                                                    02094000
PREFM    EQU   BUFSW                                                    02095000
@NM00029 EQU   BUFSW                                                    02096000
@NM00028 EQU   BUFSW                                                    02097000
@NM00027 EQU   BUFSW                                                    02098000
@NM00026 EQU   BUFSW                                                    02099000
@NM00025 EQU   BUFSW                                                    02100000
@NM00024 EQU   BUFSW                                                    02101000
@NM00023 EQU   SWF                                                      02102000
QUT1LOD  EQU   SWF                                                      02103000
@NM00022 EQU   SWF                                                      02104000
PAGEOK   EQU   SWF                                                      02105000
DMPIC    EQU   SWF                                                      02106000
QSADMP   EQU   SWF                                                      02107000
NUCTFRMC EQU   SWF                                                      02108000
QPRDINIT EQU   SWF                                                      02109000
@NM00021 EQU   SWE                                                      02110000
@NM00020 EQU   SWE                                                      02111000
@NM00019 EQU   SWE                                                      02112000
BUILDMAP EQU   SWE                                                      02113000
TITLESW  EQU   SWE                                                      02114000
RESPC    EQU   SWE                                                      02115000
@NM00018 EQU   SWE                                                      02116000
STOPSW   EQU   SWE                                                      02117000
@NM00017 EQU   SWD                                                      02118000
GPRSFND  EQU   SWD                                                      02119000
CONTSW   EQU   SWD                                                      02120000
NOLOADSW EQU   SWD                                                      02121000
NOSTDMG  EQU   SWD                                                      02122000
@NM00016 EQU   SWD                                                      02123000
@NM00015 EQU   SWD                                                      02124000
FLSHMODE EQU   SWD                                                      02125000
@NM00014 EQU   SWC                                                      02126000
@NM00013 EQU   SWC                                                      02127000
SEGRD    EQU   SWC                                                      02128000
EDITSW   EQU   SWC                                                      02129000
TREADIN  EQU   SWC                                                      02130000
POSITSW  EQU   SWC                                                      02131000
SETFLSH  EQU   SWC                                                      02132000
MSTRSW   EQU   SWC                                                      02133000
@NM00012 EQU   SWB                                                      02134000
@NM00011 EQU   SWB                                                      02135000
QSYSUT2  EQU   SWB                                                      02136000
ENDSW    EQU   SWB                                                      02137000
@NM00010 EQU   SWB                                                      02138000
@NM00009 EQU   SWB                                                      02139000
FMTERR   EQU   SWB                                                      02140000
IOERR    EQU   SWB                                                      02141000
RDRSW    EQU   SWA                                                      02142000
SETCVTSW EQU   SWA                                                      02143000
@NM00008 EQU   SWA                                                      02144000
GOSW     EQU   SWA                                                      02145000
@NM00007 EQU   SWA                                                      02146000
@NM00006 EQU   SWA                                                      02147000
@NM00005 EQU   SWA                                                      02148000
@NM00004 EQU   SWA                                                      02149000
LINENUM  EQU   COMMON+120                                               02150000
LINENUMB EQU   COMMON+118                                               02151000
SIXTEEN  EQU   COMMON+116                                               02152000
TWELVE   EQU   COMMON+114                                               02153000
ELEVEN   EQU   COMMON+112                                               02154000
HTEN     EQU   COMMON+110                                               02155000
EIGHT    EQU   COMMON+108                                               02156000
SEVEN    EQU   COMMON+106                                               02157000
FIVE     EQU   COMMON+104                                               02158000
FOUR     EQU   COMMON+102                                               02159000
THREE    EQU   COMMON+100                                               02160000
TWO      EQU   COMMON+98                                                02161000
ONEA     EQU   COMMON+96                                                02162000
READTM   EQU   COMMON+92                                                02163000
RDERCNT  EQU   COMMON+88                                                02164000
READNO   EQU   COMMON+84                                                02165000
RDENTRY  EQU   COMMON+80                                                02166000
@NM00003 EQU   COMMON+79                                                02167000
RETCODE  EQU   COMMON+78                                                02168000
FILESEQ  EQU   COMMON+76                                                02169000
INDD     EQU   COMMON+68                                                02170000
STORSIZE EQU   COMMON+64                                                02171000
PCBPTR   EQU   COMMON+60                                                02172000
CVTADDR  EQU   COMMON+56                                                02173000
TCBLIST  EQU   COMMON+52                                                02174000
PAGENUMB EQU   COMMON+44                                                02175000
LINECNT  EQU   COMMON+40                                                02176000
SIX      EQU   COMMON+36                                                02177000
NUCTOP   EQU   COMMON+32                                                02178000
WORK1    EQU   COMMON+24                                                02179000
DELIMCD  EQU   COMMON+20                                                02180000
KYWDEND  EQU   COMMON+16                                                02181000
KYWDBGN  EQU   COMMON+12                                                02182000
VERBEND  EQU   COMMON+8                                                 02183000
VERBGN   EQU   COMMON+4                                                 02184000
@NM00002 EQU   SRB+40                                                   02185000
@NM00001 EQU   SRB+38                                                   02186000
SRBPRIOR EQU   SRB+37                                                   02187000
SRBPKF   EQU   SRB+36                                                   02188000
SRBSAVE  EQU   SRB+32                                                   02189000
SRBPARM  EQU   SRB+28                                                   02190000
SRBRMTR  EQU   SRB+24                                                   02191000
SRBEP    EQU   SRB+20                                                   02192000
SRBPTCB  EQU   SRBFLC+4                                                 02193000
SRBPASID EQU   SRBFLC+2                                                 02194000
SRBCPAFF EQU   SRBFLC                                                   02195000
SRBASCB  EQU   SRB+8                                                    02196000
SRBID    EQU   SRB                                                      02197000
LSPLEND  EQU   LSPL+16                                                  02198000
GSPLEND  EQU   GSPL+16                                                  02199000
SPLLSRB  EQU   SPLENTRY+4                                               02200000
SPLFSRB  EQU   SPLENTRY                                                 02201000
ASCBEND  EQU   ASCB+208                                                 02202000
ASCBSRBT EQU   ASCB+200                                                 02203000
ASCBSWTL EQU   ASCB+196                                                 02204000
ASCBRS14 EQU   ASCB+195                                                 02205000
ASCBSMCT EQU   ASCB+194                                                 02206000
ASCBRS12 EQU   ASCB+192                                                 02207000
ASCBPCTT EQU   ASCB+188                                                 02208000
ASCBVGTT EQU   ASCB+184                                                 02209000
ASCBLGCB EQU   ASCB+180                                                 02210000
ASCBJBNS EQU   ASCB+176                                                 02211000
ASCBJBNI EQU   ASCB+172                                                 02212000
ASCBMCC  EQU   ASCB+168                                                 02213000
ASCBRTWA EQU   ASCB+164                                                 02214000
ASCBIQEA EQU   ASCB+160                                                 02215000
ASCBXMPQ EQU   ASCB+156                                                 02216000
ASCBRS01 EQU   ASCB+154                                                 02217000
ASCBFMCT EQU   ASCB+152                                                 02218000
ASCBOUXB EQU   ASCB+148                                                 02219000
ASCBOUCB EQU   ASCB+144                                                 02220000
ASCBMECB EQU   ASCB+140                                                 02221000
ASCBQECB EQU   ASCB+136                                                 02222000
ASCBCMSB EQU   ASCB+132                                                 02223000
ASCBCMSF EQU   ASCB+128                                                 02224000
ASCBTCBS EQU   ASCB+124                                                 02225000
ASCBNVSC EQU   ASCB+122                                                 02226000
ASCBVSC  EQU   ASCB+120                                                 02227000
ASCBSRBS EQU   ASCB+118                                                 02228000
ASCBSSRB EQU   ASCB+116                                                 02229000
ASCBRV06 EQU   ASCBFLG2                                                 02230000
ASCBRV05 EQU   ASCBFLG2                                                 02231000
ASCBRV04 EQU   ASCBFLG2                                                 02232000
ASCBSNQS EQU   ASCBFLG2                                                 02233000
ASCBS2S  EQU   ASCBFLG2                                                 02234000
ASCBCEXT EQU   ASCBFLG2                                                 02235000
ASCBPXMT EQU   ASCBFLG2                                                 02236000
ASCBXMPT EQU   ASCBFLG2                                                 02237000
ASCBRF07 EQU   ASCBDSP1                                                 02238000
ASCBRF06 EQU   ASCBDSP1                                                 02239000
ASCBRF05 EQU   ASCBDSP1                                                 02240000
ASCBRF04 EQU   ASCBDSP1                                                 02241000
ASCBRF03 EQU   ASCBDSP1                                                 02242000
ASCBRF02 EQU   ASCBDSP1                                                 02243000
ASCBFAIL EQU   ASCBDSP1                                                 02244000
ASCBNOQ  EQU   ASCBDSP1                                                 02245000
ASCBSWCT EQU   ASCB+112                                                 02246000
ASCBTMCH EQU   ASCB+104                                                 02247000
ASCBNSWP EQU   ASCBFLG1                                                 02248000
ASCBTYP1 EQU   ASCBFLG1                                                 02249000
ASCBSTND EQU   ASCBFLG1                                                 02250000
ASCBABNT EQU   ASCBFLG1                                                 02251000
ASCBTERM EQU   ASCBFLG1                                                 02252000
ASCBS3S  EQU   ASCBFLG1                                                 02253000
ASCBCMSH EQU   ASCBFLG1                                                 02254000
ASCBTOFF EQU   ASCBFLG1                                                 02255000
ASCBRF01 EQU   ASCBRCTF                                                 02256000
ASCBTMLW EQU   ASCBRCTF                                                 02257000
ASCBOUT  EQU   ASCBRCTF                                                 02258000
ASCBWAIT EQU   ASCBRCTF                                                 02259000
ASCBRV08 EQU   ASCBRCTF                                                 02260000
ASCBFQU  EQU   ASCBRCTF                                                 02261000
ASCBFRS  EQU   ASCBRCTF                                                 02262000
ASCBTMNO EQU   ASCBRCTF                                                 02263000
ASCBAFFN EQU   ASCBFW1                                                  02264000
ASCBDUMP EQU   ASCB+96                                                  02265000
ASCBQSVC EQU   ASCB+92                                                  02266000
ASCBUBET EQU   ASCB+88                                                  02267000
ASCBECB  EQU   ASCB+84                                                  02268000
ASCBJSTL EQU   ASCB+80                                                  02269000
ASCBEWST EQU   ASCB+72                                                  02270000
ASCBEJST EQU   ASCB+64                                                  02271000
ASCBTSB  EQU   ASCB+60                                                  02272000
ASCBCSCB EQU   ASCB+56                                                  02273000
ASCBRSM  EQU   ASCB+52                                                  02274000
ASCBLDA  EQU   ASCB+48                                                  02275000
ASCBSTOR EQU   ASCB+44                                                  02276000
ASCBDP   EQU   ASCB+43                                                  02277000
ASCBRV07 EQU   ASCB+42                                                  02278000
ASCBIOSM EQU   ASCB+40                                                  02279000
ASCBSEQN EQU   ASCB+38                                                  02280000
ASCBASID EQU   ASCB+36                                                  02281000
ASCBCPUS EQU   ASCB+32                                                  02282000
ASCBLSLQ EQU   ASCB+24                                                  02283000
ASCBFSLQ EQU   ASCB+20                                                  02284000
ASCBIOSP EQU   ASCB+16                                                  02285000
ASCBLOCK EQU   ASCB+12                                                  02286000
ASCBBWDP EQU   ASCB+8                                                   02287000
ASCBFWDP EQU   ASCB+4                                                   02288000
ASCBASCB EQU   ASCB                                                     02289000
ASCBEGIN EQU   ASCB                                                     02290000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02291000
FAREXIT  EQU   @EL00001                                                 02292000
@RT00227 EQU   @EL00002                                                 02293000
SRBEXIT  EQU   @EL00002                                                 02294000
@RF00252 EQU   QMPTYMSG                                                 02295000
@RF00275 EQU   FIRSTSYS                                                 02296000
@RT00291 EQU   QMPTYMSG                                                 02297000
@RT00354 EQU   ENDSWCK                                                  02298000
@RT00379 EQU   SRBDONE                                                  02299000
@RF00379 EQU   FIRSTSYS                                                 02300000
@RF00358 EQU   DECREMNT                                                 02301000
@RT00388 EQU   ENDSWCK                                                  02302000
@RT00397 EQU   PTRSWAP2                                                 02303000
@RT00399 EQU   SRBDONE                                                  02304000
@RT00433 EQU   QMPTYMSG                                                 02305000
@RT00442 EQU   QMPTYMSG                                                 02306000
@RT00449 EQU   NOFSTCK1                                                 02307000
@RT00461 EQU   LASTNONQ                                                 02308000
@RF00461 EQU   LSTNONQ1                                                 02309000
@RT00467 EQU   LASTSYS                                                  02310000
@RF00467 EQU   LSTSYS1                                                  02311000
@RT00497 EQU   ENDSWCK                                                  02312000
@PB00002 EQU   @EL00001                                                 02313000
@RT00081 EQU   FAREXIT                                                  02314000
@ENDDATA EQU   *                                                        02315000
         END   AMDPRFAR,(C'PLS0723',0701,76310)                         02316000
