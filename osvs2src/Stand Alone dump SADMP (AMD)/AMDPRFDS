         TITLE 'AMDPRFDS -- FAST DUMP/SCAN MODULE                      *00001000
                        '                                               00002000
AMDPRFDS CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'AMDPRFDS  76.265'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  LA    @10,4095(,@11)                                      0001 00012000
         LA    @09,4095(,@10)                                      0001 00013000
         USING @PSTART,@11                                         0001 00014000
         USING @PSTART+4095,@10                                    0001 00015000
         USING @PSTART+8190,@09                                    0001 00016000
         ST    @13,@SA00001+4                                      0001 00017000
         LA    @14,@SA00001                                        0001 00018000
         ST    @14,8(,@13)                                         0001 00019000
         LR    @13,@14                                             0001 00020000
*                                                          /*@Y30DI3D*/ 00021000
   DCBD  DSORG=PS,DEVD=(DA)                                    @Y30DI3D 00022000
AMDPRFDS  CSECT                                                @Y30DI3D 00023000
   USING  IHADCB,R8                                            @Y30DI3D 00024000
*   IF RDRSW=ON THEN                /* IF OFF,BRANCH AROUND CODE   0038 00025000
*                                                            @Y30DI3D*/ 00026000
         TM    RDRSW(COMBASE),B'00000001'                          0038 00027000
         BNO   @RF00038                                            0038 00028000
*     DO;                           /*                       @Y30DI3D*/ 00029000
*       REG8=ARDRDCB;               /* GET ADDR OF SYSIN DCB FROM  0040 00030000
*                                      COMMON, MODIFY EODAD AND SYNAD   00031000
*                                      ROUTINES TO USE FDS BASE    0040 00032000
*                                      REGISTER                      */ 00033000
         L     REG8,ARDRDCB(,COMBASE)                              0040 00034000
*       SAVE1=DCBEODA;              /* SAVE ADDRESS OF CALLER'S    0041 00035000
*                                      RDRDCB EODAD ROUTINE          */ 00036000
         MVC   SAVE1(3),DCBEODA                                    0041 00037000
*       DCBEODA=ADDR(FDSEOF);       /* REPLACE WITH FDS'S EODAD    0042 00038000
*                                      ROUTINE               @Y30DI3D*/ 00039000
         LA    @05,FDSEOF                                          0042 00040000
         STCM  @05,7,DCBEODA                                       0042 00041000
*       SAVE2=DCBSYNA;              /* SAVE ADDRESS OF CALLER'S    0043 00042000
*                                      RDRDCB SYNAD ROUTINE          */ 00043000
         MVC   SAVE2(3),DCBSYNA                                    0043 00044000
*       DCBSYNA=ADDR(FDSYNAD);      /* REPLACE WITH FDS'S SYNAD    0044 00045000
*                                      ROUTINE                       */ 00046000
         LA    @05,FDSYNAD                                         0044 00047000
         STCM  @05,7,DCBSYNA                                       0044 00048000
*     END;                          /*                       @Y30DI3D*/ 00049000
*/********************************************************************/ 00050000
*/*                                                          @Y30DI3D*/ 00051000
*/*      INITIALIZATIONS                                     @Y30DI3D*/ 00052000
*/*                                                          @Y30DI3D*/ 00053000
*/********************************************************************/ 00054000
*                                                                  0046 00055000
*   SYNTAXCD=GOOD;                  /* NO SYNTAX ERRORS YET  @Y30DI3D*/ 00056000
@RF00038 MVI   SYNTAXCD,X'00'                                      0046 00057000
*   LASTASID=QASID;                 /* NEEDED FOR FIRST PASS @UZ08993*/ 00058000
         MVC   LASTASID(2),QASID(COMBASE)                          0047 00059000
*   THISASID=QASID;                 /* INIT FOR LIST         @UZ08993*/ 00060000
         MVC   THISASID(2),QASID(COMBASE)                          0048 00061000
*   FDSON=ON;                       /* INIT FOR READING ALL CONTROL     00062000
*                                      STATEMENTS                    */ 00063000
*   HCOPYON=OFF;                    /*                       @Y30DI3D*/ 00064000
         OI    FDSON,B'01000000'                                   0050 00065000
         NI    HCOPYON,B'01111111'                                 0050 00066000
*   OUTBUFAD=CURBUF;                /* INIT FOR BRWRITES     @Y30DI3D*/ 00067000
         L     @00,CURBUF(,COMBASE)                                0051 00068000
         ST    @00,OUTBUFAD                                        0051 00069000
*   PREVSET=NO;                     /* INIT FOR HCOPY COMMENTS     0052 00070000
*                                      STARTING WITH 'ON'            */ 00071000
         NI    PREVSET,B'11111101'                                 0052 00072000
*   CC=BLANK1;                      /* INIT CONTROL CHAR FOR BRWRITES   00073000
*                                                            @Y30DI3D*/ 00074000
         LR    @15,@00                                             0053 00075000
         MVI   CC(@15),C' '                                        0053 00076000
*   THISMSG=BLANK80;                /* INIT FOR REPLY MESSAGE      0054 00077000
*                                                            @Y30DI3D*/ 00078000
         MVC   THISMSG(80),BLANK80                                 0054 00079000
*   PREVADDR=ERRADDR;               /* SAVE PREVIOUS BRREAD ERROR  0055 00080000
*                                      ROUTINE               @Y30DI3D*/ 00081000
         L     PREVADDR,ERRADDR(,COMBASE)                          0055 00082000
*/*  MODIFY NONBLNK TO SCAN FOR DELIMETERS,SET ZERO CODE TO '0'      */ 00083000
*                                                                  0056 00084000
*   GEN REFS(NONBLNK);                                             0056 00085000
*                                                          /*@Y30DI3D*/ 00086000
         OC    NONBLNK(256,COMBASE),DLIMTBL                             00087000
         NI    NONBLNK+64(COMBASE),X'0'                                 00088000
*                                                                  0057 00089000
*/********************************************************************/ 00090000
*/*                                                          @Y30DI3D*/ 00091000
*/*   OPEN ROUTINE FOR TSO TERMINAL                          @Y30DI3D*/ 00092000
*/*                                                          @Y30DI3D*/ 00093000
*/********************************************************************/ 00094000
*                                                                  0057 00095000
*   GEN REFS(TSODCB) FLOWS(TSOERR)(OPEN (TSODCB,OUTPUT));/*  @Y30DI3D*/ 00096000
         OPEN (TSODCB,OUTPUT)                                           00097000
*   REG8=ADDR(TSODCB);              /* CHANGE BASE REG FOR DCBD    0058 00098000
*                                      REFERENCE                     */ 00099000
         LA    @15,TSODCB                                          0058 00100000
         LR    REG8,@15                                            0058 00101000
*   IF DCBOPEN=ON THEN              /* TERMINAL IS AVAILABLE @Y30DI3D*/ 00102000
         TM    DCBOPEN+48(@15),B'00010000'                         0059 00103000
         BNO   @RF00059                                            0059 00104000
*     TERMINAL=OPEN;                /*                       @Y30DI3D*/ 00105000
         OI    TERMINAL,B'10000000'                                0060 00106000
*   ELSE                                                           0061 00107000
*     TERMINAL=CLOSED;              /* TERMINAL NOT AVAILABLE      0061 00108000
*                                                            @Y30DI3D*/ 00109000
         B     @RC00059                                            0061 00110000
@RF00059 NI    TERMINAL,B'01111111'                                0061 00111000
*   GOTO FDSBGN;                    /*                       @Y30DI3D*/ 00112000
         B     FDSBGN                                              0062 00113000
*TSOERR:                                                           0063 00114000
*   MSGAREA=BLANK80;                /*                       @Y30DI3D*/ 00115000
TSOERR   L     @05,OUTBUFAD                                        0063 00116000
         MVC   MSGAREA(80,@05),BLANK80                             0063 00117000
*   MSGAREA(1:64)=IOMSG2;           /*                       @Y30DI3D*/ 00118000
         MVI   MSGAREA+60(@05),C' '                                0064 00119000
         MVC   MSGAREA+61(3,@05),MSGAREA+60(@05)                   0064 00120000
         MVC   MSGAREA(60,@05),IOMSG2                              0064 00121000
*   GEN REFS(AEREXIT,AWRITE) EXIT NOSEQFLOW;                       0065 00122000
*                                                          /*@Y30DI3D*/ 00123000
         BRWRITE 1         WRITE I/O ERROR MESSAGE                      00124000
         L     R13,4(R13)  RESTORE REGISTERS                            00125000
         LM    R14,R12,12(R13)                                          00126000
         LA    R1,4        LOAD CODE FOR NO I/O MESSAGE                 00127000
         L     R15,AEREXIT(,COMBASE)  PROVIDE EXIT TO TERMINATE PGM     00128000
         BR    R15         BRANCH TO ERROR EXIT ROUTINE                 00129000
*                                                                  0066 00130000
*/********************************************************************/ 00131000
*/*                                                          @Y30DI3D*/ 00132000
*/*   MAIN CALLING ROUTINE - ALL SUBVERB SUBROUTINES ARE CALLED      */ 00133000
*/*   FROM HERE AND FDS PASSES CONTROL BACK TO AMDPRCTL WHEN @Y30DI3D*/ 00134000
*/*   'RETURN' IS ENCOUNTERED                                @Y30DI3D*/ 00135000
*/*                                                          @Y30DI3D*/ 00136000
*/********************************************************************/ 00137000
*                                                                  0066 00138000
*FDSBGN:                                                           0066 00139000
*   IF TERMINAL=OPEN THEN           /* WRITE REPLY MESSAGE TO      0066 00140000
*                                      TERMINAL              @Y30DI3D*/ 00141000
FDSBGN   TM    TERMINAL,B'10000000'                                0066 00142000
         BNO   @RF00066                                            0066 00143000
*     DO;                           /*                       @Y30DI3D*/ 00144000
*       THISMSG(1:37)=RPLYMSG;      /* LOAD MESSAGE BUFFER   @Y30DI3D*/ 00145000
         MVC   THISMSG(37),RPLYMSG                                 0068 00146000
*       MSGADDR=ADDR(THISMSG);      /* LOAD ADDR OF MSG BUFFER     0069 00147000
*                                                            @Y30DI3D*/ 00148000
         LA    MSGADDR,THISMSG                                     0069 00149000
*       CALL WRITRTN;               /*                       @Y30DI3D*/ 00150000
         BAL   @14,WRITRTN                                         0070 00151000
*       MSGADDR=ADDR(BLANK80);      /* SKIP LINE AFTER MESSAGE     0071 00152000
*                                                            @Y30DI3D*/ 00153000
         LA    MSGADDR,BLANK80                                     0071 00154000
*       CALL WRITRTN;               /*                       @Y30DI3D*/ 00155000
         BAL   @14,WRITRTN                                         0072 00156000
*     END;                          /*                       @Y30DI3D*/ 00157000
*   DO WHILE FDSON=ON;              /* EXEC UNTIL DISPLAY END      0074 00158000
*                                                            @Y30DI3D*/ 00159000
@RF00066 B     @DE00074                                            0074 00160000
@DL00074 DS    0H                                                  0075 00161000
*     CALL READVERB;                /* READ NEXT DISPLAY STATEMENT 0075 00162000
*                                                            @Y30DI3D*/ 00163000
         BAL   @14,READVERB                                        0075 00164000
*     CALL VERBTEST;                /* RETURN AND SCAN VERB  @Y30DI3D*/ 00165000
         BAL   @14,VERBTEST                                        0076 00166000
*     IF SYNTAXCD=GOOD THEN         /* EXECUTE ROUTINE               */ 00167000
         CLI   SYNTAXCD,X'00'                                      0077 00168000
         BNE   @RF00077                                            0077 00169000
*       IF SUBVERB=HCOPY THEN       /* GO EXECUTE DISPLAY HARDCOPY   */ 00170000
         CLI   SUBVERB,X'01'                                       0078 00171000
         BNE   @RF00078                                            0078 00172000
*         CALL HCOPYRTN;            /*                       @Y30DI3D*/ 00173000
         BAL   @14,HCOPYRTN                                        0079 00174000
*       ELSE                                                       0080 00175000
*         IF SUBVERB=ENDSVERB THEN  /* SVERB=END---END AMDPRFDS      */ 00176000
         B     @RC00078                                            0080 00177000
@RF00078 CLI   SUBVERB,X'02'                                       0080 00178000
         BNE   @RF00080                                            0080 00179000
*           FDSON=OFF;              /*                       @Y30DI3D*/ 00180000
         NI    FDSON,B'10111111'                                   0081 00181000
*         ELSE                                                     0082 00182000
*           IF SUBVERB=LISTVERB THEN/* EXECUTE DISPLAY STORAGE       */ 00183000
         B     @RC00080                                            0082 00184000
@RF00080 CLI   SUBVERB,X'03'                                       0082 00185000
         BNE   @RF00082                                            0082 00186000
*             CALL STORTN;          /*                       @Y30DI3D*/ 00187000
         BAL   @14,STORTN                                          0083 00188000
*           ELSE                                                   0084 00189000
*             IF SUBVERB=EQUAT THEN /* EXECUTE EQUATE        @Y30DI3D*/ 00190000
         B     @RC00082                                            0084 00191000
@RF00082 CLI   SUBVERB,X'04'                                       0084 00192000
         BNE   @RF00084                                            0084 00193000
*               CALL EQUATRTN;      /*                       @Y30DI3D*/ 00194000
         BAL   @14,EQUATRTN                                        0085 00195000
*             ELSE                                                 0086 00196000
*               CALL COMMRTN;       /* EXECUTE COMMENT       @Y30DI3D*/ 00197000
         B     @RC00084                                            0086 00198000
@RF00084 BAL   @14,COMMRTN                                         0086 00199000
*     ELSE                                                         0087 00200000
*       ;                           /*                       @Y30DI3D*/ 00201000
@RF00077 DS    0H                                                  0088 00202000
*     IF SYNTAXCD^=GOOD THEN        /* ERROR DURING EXECUTION      0088 00203000
*                                                            @Y30DI3D*/ 00204000
@RC00077 CLI   SYNTAXCD,X'00'                                      0088 00205000
         BE    @RF00088                                            0088 00206000
*       CALL ERRORTN;               /* PRINT ERROR MESSAGE   @Y30DI3D*/ 00207000
         BAL   @14,ERRORTN                                         0089 00208000
*     ELSE                                                         0090 00209000
*       ;                           /*                       @Y30DI3D*/ 00210000
@RF00088 DS    0H                                                  0091 00211000
*   END;                            /*                       @Y30DI3D*/ 00212000
@DE00074 TM    FDSON,B'01000000'                                   0091 00213000
         BO    @DL00074                                            0091 00214000
*   IF RDRSW=ON THEN                /* IF OFF,BRANCH AROUND CODE   0092 00215000
*                                                            @Y30DI3D*/ 00216000
         TM    RDRSW(COMBASE),B'00000001'                          0092 00217000
         BNO   @RF00092                                            0092 00218000
*     DO;                           /*                       @Y30DI3D*/ 00219000
*       REG8=ARDRDCB;               /* CHANGE BASE REG FOR DCBD    0094 00220000
*                                      REFERENCE             @Y30DI3D*/ 00221000
         L     REG8,ARDRDCB(,COMBASE)                              0094 00222000
*       DCBEODA=SAVE1;              /* RESTORE CALLER'S EODAD ROUTINE   00223000
*                                                            @Y30DI3D*/ 00224000
         MVC   DCBEODA(3),SAVE1                                    0095 00225000
*       DCBSYNA=SAVE2;              /* RESTORE CALLER'S SYNAD ROUTINE   00226000
*                                                            @Y30DI3D*/ 00227000
         MVC   DCBSYNA(3),SAVE2                                    0096 00228000
*     END;                          /*                       @Y30DI3D*/ 00229000
*   ERRADDR=PREVADDR;               /* RESTORE PREVIOUS BRREAD ERROR    00230000
*                                      ROUTINE                       */ 00231000
@RF00092 ST    PREVADDR,ERRADDR(,COMBASE)                          0098 00232000
*/*  RESTORE NONBLNK                                         @Y30DI3D*/ 00233000
*                                                                  0099 00234000
*   GEN REFS(NONBLNK);                                             0099 00235000
*                                                          /*@Y30DI3D*/ 00236000
         OI    NONBLNK+64(COMBASE),X'0C'                                00237000
         XC    NONBLNK(193,COMBASE),DLIMTBL                             00238000
*   IF TERMINAL=OPEN THEN           /* CLOSE TERMINAL DCB    @Y30DI3D*/ 00239000
         TM    TERMINAL,B'10000000'                                0100 00240000
         BNO   @RF00100                                            0100 00241000
*     GEN REFS(TSODCB)(CLOSE (TSODCB));/*                    @Y30DI3D*/ 00242000
         CLOSE (TSODCB)                                                 00243000
*   RETURN;                         /* RETURN TO AMDPRCTL    @Y30DI3D*/ 00244000
@EL00001 L     @13,4(,@13)                                         0102 00245000
@EF00001 DS    0H                                                  0102 00246000
@ER00001 LM    @14,@12,12(@13)                                     0102 00247000
         BR    @14                                                 0102 00248000
*                                                                  0103 00249000
*/********************************************************************/ 00250000
*/*                                                          @Y30DI3D*/ 00251000
*/*   FIND SOURCE OF DISPLAY VERB THEN READ INTO BUFFER      @Y30DI3D*/ 00252000
*/*                                                          @Y30DI3D*/ 00253000
*/********************************************************************/ 00254000
*                                                                  0103 00255000
*READVERB:                                                         0103 00256000
*   PROCEDURE;                      /*                       @Y30DI3D*/ 00257000
         B     @EL00001                                            0103 00258000
READVERB STM   @14,@12,@SA00002                                    0103 00259000
*   RESPECIFY                                                      0104 00260000
*    (R2,                                                          0104 00261000
*     R3) RESTRICTED;               /*                       @Y30DI3D*/ 00262000
*   IF RDRSW=ON THEN                /* READ FROM SYSIN       @Y30DI3D*/ 00263000
         TM    RDRSW(COMBASE),B'00000001'                          0105 00264000
         BNO   @RF00105                                            0105 00265000
*     DO;                           /* READ STATEMENT INTO WTOR    0106 00266000
*                                      BUFFER                @Y30DI3D*/ 00267000
*       GEN FLOWS(FDSYNAD,FDSEOF) REFS(ARDRDCB);                   0107 00268000
*                                                          /*@Y30DI3D*/ 00269000
         L     R1,ARDRDCB(,COMBASE)        LOAD PARAMETER REG1 @Y30DI3D 00270000
         LA    R0,WTORMSG(,COMBASE)        LOAD PARAMETER REG0 @Y30DI3D 00271000
         L     R15,48(R0,R1)               LOAD GET ROUTINE ADDRESS     00272000
         BALR  R14,R15                     LINK TO GET ROUTINE @Y30DI3D 00273000
*       SAVEWTOR=ADDR(WTORMSG)+81;  /* SAVE ADDR OF END OF BUFFER    */ 00274000
         LA    @05,WTORMSG(,COMBASE)                               0108 00275000
         AH    @05,@CH00152                                        0108 00276000
         ST    @05,SAVEWTOR                                        0108 00277000
*     END;                          /*                       @Y30DI3D*/ 00278000
*   ELSE                            /* ASK OPERATOR FOR VERB @Y30DI3D*/ 00279000
*     DO;                           /*                       @Y30DI3D*/ 00280000
         B     @RC00105                                            0110 00281000
@RF00105 DS    0H                                                  0111 00282000
*       WTORMSG=BLANK4;             /* CLEAR BUFFER          @Y30DI3D*/ 00283000
         MVC   WTORMSG(81,COMBASE),BLANK4                          0111 00284000
*       R2=ADDR(WTORMSG);           /* GET ADDRESS OF WTORMSG      0112 00285000
*                                                            @Y30DI3D*/ 00286000
         LA    R2,WTORMSG(,COMBASE)                                0112 00287000
*       R3=ADDR(WTORECB1);          /* GET ADDRESS OF WTORECB1       */ 00288000
         LA    R3,WTORECB1                                         0113 00289000
*       GEN;                                                       0114 00290000
*                                                          /*@Y30DI3D*/ 00291000
             WTOR   'REPLY WITH DESIRED FUNCTION OR RETURN',   @Y30DI3DX00292000
               (R2),71,(R3),ROUTCDE=(1),DESC=2                 @Y30DI3D 00293000
             WAIT   ECB=WTORECB1                               @Y30DI3D 00294000
         MVI   WTORECB1,0        CLEAR COMPLETION CODE                  00295000
*       SAVEWTOR=ADDR(WTORMSG)+81;  /* SAVE ADDR OF END OF BUFFER    */ 00296000
         LA    @05,WTORMSG(,COMBASE)                               0115 00297000
         AH    @05,@CH00152                                        0115 00298000
         ST    @05,SAVEWTOR                                        0115 00299000
*     END;                          /*                       @Y30DI3D*/ 00300000
*   RESPECIFY                                                      0117 00301000
*    (R2,                                                          0117 00302000
*     R3) UNRESTRICTED;             /*                       @Y30DI3D*/ 00303000
*   GOTO ENDRDVB;                   /*                       @Y30DI3D*/ 00304000
         B     ENDRDVB                                             0118 00305000
*FDSEOF:                            /* FDS EODAD ROUTINE     @Y30DI3D*/ 00306000
*   MSGAREA=BLANK80;                /* CLEAR MESSAGE BUFFER  @Y30DI3D*/ 00307000
FDSEOF   L     @05,OUTBUFAD                                        0119 00308000
         MVC   MSGAREA(80,@05),BLANK80                             0119 00309000
*   MSGAREA(1:35)=EOFMSG;           /* INSERT EOF MESSAGE    @Y30DI3D*/ 00310000
         MVC   MSGAREA(35,@05),EOFMSG                              0120 00311000
*   MSGADDR=ADDR(MSGAREA);          /*                       @Y30DI3D*/ 00312000
         LA    MSGADDR,MSGAREA(,@05)                               0121 00313000
*   IF TERMINAL=OPEN THEN                                          0122 00314000
         TM    TERMINAL,B'10000000'                                0122 00315000
         BNO   @RF00122                                            0122 00316000
*     GEN REFS(TSODCB) FLOWS(TSOERR)(PUT TSODCB,(MSGADDR));/*      0123 00317000
*                                                            @Y30DI3D*/ 00318000
         PUT TSODCB,(MSGADDR)                                           00319000
*   ELSE                                                           0124 00320000
*     GEN REFS(AWRITE)(BRWRITE 1);  /* PRINT MESSAGE ON PRINTER      */ 00321000
         B     @RC00122                                            0124 00322000
@RF00122 DS    0H                                                  0124 00323000
         BRWRITE 1                                                      00324000
*   GEN REFS(AEREXIT) EXIT NOSEQFLOW;                              0125 00325000
@RC00122 DS    0H                                                  0125 00326000
*                                                          /*@Y30DI3D*/ 00327000
         L     R13,4(R13)        RESTORE REGISTERS                      00328000
         LM    R14,R12,12(R13)                                          00329000
         LA    R1,4              LOAD CODE FOR NO MESSAGE               00330000
         L     R15,AEREXIT(,COMBASE)  PROVIDE EXIT TO TERMINATE PGM     00331000
         BR    R15               BRANCH TO ERROR EXIT ROUTINE           00332000
*FDSYNAD:                           /* FDS SYSIN SYNAD ROUTINE     0126 00333000
*                                                            @Y30DI3D*/ 00334000
*   MSGAREA=BLANK80;                /* CLEAR MESSAGE BUFFER  @Y30DI3D*/ 00335000
FDSYNAD  L     @05,OUTBUFAD                                        0126 00336000
         MVC   MSGAREA(80,@05),BLANK80                             0126 00337000
*   MSGAREA(1:60)=IOMSG1;           /* INSERT I/O ERROR MESSAGE    0127 00338000
*                                                            @Y30DI3D*/ 00339000
         MVC   MSGAREA(60,@05),IOMSG1                              0127 00340000
*   MSGADDR=ADDR(MSGAREA);          /*                       @Y30DI3D*/ 00341000
         LA    MSGADDR,MSGAREA(,@05)                               0128 00342000
*   IF TERMINAL=OPEN THEN                                          0129 00343000
         TM    TERMINAL,B'10000000'                                0129 00344000
         BNO   @RF00129                                            0129 00345000
*     GEN REFS(TSODCB) FLOWS(TSOERR)(PUT TSODCB,(MSGADDR));/*      0130 00346000
*                                                            @Y30DI3D*/ 00347000
         PUT TSODCB,(MSGADDR)                                           00348000
*   ELSE                                                           0131 00349000
*     GEN REFS(AWRITE)(BRWRITE 1);  /*                       @Y30DI3D*/ 00350000
         B     @RC00129                                            0131 00351000
@RF00129 DS    0H                                                  0131 00352000
         BRWRITE 1                                                      00353000
*   GEN REFS(AEREXIT) EXIT NOSEQFLOW;                              0132 00354000
@RC00129 DS    0H                                                  0132 00355000
*                                                          /*@Y30DI3D*/ 00356000
         L     R13,4(R13)        RESTORE REGISTERS                      00357000
         LM    R14,R12,12(R13)                                          00358000
         LA    R1,4              LOAD CODE FOR NO MESSAGE               00359000
         L     R15,AEREXIT(,COMBASE)  PROVIDE EXIT TO TERMINATE PGM     00360000
         BR    R15               BRANCH TO ERROR EXIT ROUTINE           00361000
*ENDRDVB:                                                          0133 00362000
*   END READVERB;                   /*                       @Y30DI3D*/ 00363000
@EL00002 DS    0H                                                  0133 00364000
@EF00002 DS    0H                                                  0133 00365000
@ER00002 LM    @14,@12,@SA00002                                    0133 00366000
         BR    @14                                                 0133 00367000
*                                                                  0134 00368000
*/********************************************************************/ 00369000
*/*                                                          @Y30DI3D*/ 00370000
*/*    SCAN FOR CORRECT SYNTAX ON SUBVERBS                   @Y30DI3D*/ 00371000
*/*                                                          @Y30DI3D*/ 00372000
*/********************************************************************/ 00373000
*                                                                  0134 00374000
*VERBTEST:                                                         0134 00375000
*   PROCEDURE;                      /*                       @Y30DI3D*/ 00376000
VERBTEST STM   @14,@12,@SA00003                                    0134 00377000
*   SYNTAXCD=GOOD;                  /*                       @Y30DI3D*/ 00378000
         MVI   SYNTAXCD,X'00'                                      0135 00379000
*   R1=0;                           /*                       @Y30DI3D*/ 00380000
         SLR   R1,R1                                               0136 00381000
*   TRT(WTORMSG,NONBLNK);           /* SCAN BUFFER FOR 1ST NONBLNK 0137 00382000
*                                      CHARACTER                     */ 00383000
         TRT   WTORMSG(81,COMBASE),NONBLNK(COMBASE)                0137 00384000
*   BC(8,VERBEOF);                  /* BUFFER BLANK,PRINT MESSAGE  0138 00385000
*                                                            @Y30DI3D*/ 00386000
         BC    8,VERBEOF                                           0138 00387000
*   VERBGN=R1;                      /* ADDRESS OF 1ST NONBLANK     0139 00388000
*                                      CHARACTER                     */ 00389000
         ST    R1,VERBGN(,COMBASE)                                 0139 00390000
*   VERBEND=VERBGN-1;               /* INIT VERBEND FOR FIRST DELIM     00391000
*                                      SCAN                          */ 00392000
         L     @15,VERBGN(,COMBASE)                                0140 00393000
         BCTR  @15,0                                               0140 00394000
         ST    @15,VERBEND(,COMBASE)                               0140 00395000
*   CALL DLIMSCAN;                  /*                       @Y30DI3D*/ 00396000
         BAL   @14,DLIMSCAN                                        0141 00397000
*   IF DELIMCD=BLANK THEN           /* SCAN FOR VERB         @Y30DI3D*/ 00398000
         CLC   DELIMCD(4,COMBASE),@CF00242                         0142 00399000
         BNE   @RF00142                                            0142 00400000
*     IF OPSIZE=3&OPERAND(1:3)='RET'/* VERB=RETURN                   */ 00401000
*         |OPSIZE=6&OPERAND(1:6)='RETURN' THEN                     0143 00402000
         CH    OPSIZE,@CH00150                                     0143 00403000
         BNE   @GL00001                                            0143 00404000
         L     @15,VERBGN(,COMBASE)                                0143 00405000
         CLC   OPERAND(3,@15),@CC00661                             0143 00406000
         BE    @RT00143                                            0143 00407000
@GL00001 CH    OPSIZE,@CH00387                                     0143 00408000
         BNE   @RF00143                                            0143 00409000
         L     @15,VERBGN(,COMBASE)                                0143 00410000
         CLC   OPERAND(6,@15),@CC00662                             0143 00411000
         BNE   @RF00143                                            0143 00412000
@RT00143 DS    0H                                                  0144 00413000
*       SUBVERB=ENDSVERB;           /*                       @Y30DI3D*/ 00414000
         MVI   SUBVERB,X'02'                                       0144 00415000
*     ELSE                                                         0145 00416000
*       IF OPSIZE=2&OPERAND(1:2)='HC'|OPSIZE=8&OPERAND(1:8)='HARDCOPY'  00417000
*         THEN                                                     0145 00418000
         B     @RC00143                                            0145 00419000
@RF00143 CH    OPSIZE,@CH00165                                     0145 00420000
         BNE   @GL00004                                            0145 00421000
         L     @15,VERBGN(,COMBASE)                                0145 00422000
         CLC   OPERAND(2,@15),@CC00663                             0145 00423000
         BE    @RT00145                                            0145 00424000
@GL00004 CH    OPSIZE,@CH00044                                     0145 00425000
         BNE   @RF00145                                            0145 00426000
         L     @15,VERBGN(,COMBASE)                                0145 00427000
         CLC   OPERAND(8,@15),@CC00664                             0145 00428000
         BNE   @RF00145                                            0145 00429000
@RT00145 DS    0H                                                  0146 00430000
*         SUBVERB=HCOPY;            /* SUBVERB=HARDCOPY      @Y30DI3D*/ 00431000
         MVI   SUBVERB,X'01'                                       0146 00432000
*       ELSE                                                       0147 00433000
*         IF OPSIZE=1&OPERAND(1:1)='L'/* VERB=                       */ 00434000
*             |OPSIZE=4&OPERAND(1:4)='LIST' THEN/* LIST              */ 00435000
         B     @RC00145                                            0147 00436000
@RF00145 CH    OPSIZE,@CH00058                                     0147 00437000
         BNE   @GL00007                                            0147 00438000
         L     @15,VERBGN(,COMBASE)                                0147 00439000
         CLI   OPERAND(@15),C'L'                                   0147 00440000
         BE    @RT00147                                            0147 00441000
@GL00007 CH    OPSIZE,@CH00157                                     0147 00442000
         BNE   @RF00147                                            0147 00443000
         L     @15,VERBGN(,COMBASE)                                0147 00444000
         CLC   OPERAND(4,@15),@CC00666                             0147 00445000
         BNE   @RF00147                                            0147 00446000
@RT00147 DS    0H                                                  0148 00447000
*           SUBVERB=LISTVERB;       /*                       @Y30DI3D*/ 00448000
         MVI   SUBVERB,X'03'                                       0148 00449000
*         ELSE                                                     0149 00450000
*           IF OPSIZE=2&OPERAND(1:2)='EQ'/* VERB=                    */ 00451000
*               |OPSIZE=6&OPERAND(1:6)='EQUATE' THEN/* EQUATE        */ 00452000
         B     @RC00147                                            0149 00453000
@RF00147 CH    OPSIZE,@CH00165                                     0149 00454000
         BNE   @GL00010                                            0149 00455000
         L     @15,VERBGN(,COMBASE)                                0149 00456000
         CLC   OPERAND(2,@15),@CC00667                             0149 00457000
         BE    @RT00149                                            0149 00458000
@GL00010 CH    OPSIZE,@CH00387                                     0149 00459000
         BNE   @RF00149                                            0149 00460000
         L     @15,VERBGN(,COMBASE)                                0149 00461000
         CLC   OPERAND(6,@15),@CC00668                             0149 00462000
         BNE   @RF00149                                            0149 00463000
@RT00149 DS    0H                                                  0150 00464000
*             SUBVERB=EQUAT;        /*                       @Y30DI3D*/ 00465000
         MVI   SUBVERB,X'04'                                       0150 00466000
*           ELSE                                                   0151 00467000
*             IF OPSIZE=1&OPERAND(1)='C' THEN/* VERB=                */ 00468000
         B     @RC00149                                            0151 00469000
@RF00149 CH    OPSIZE,@CH00058                                     0151 00470000
         BNE   @RF00151                                            0151 00471000
         L     @15,VERBGN(,COMBASE)                                0151 00472000
         CLI   OPERAND(@15),C'C'                                   0151 00473000
         BNE   @RF00151                                            0151 00474000
*               SUBVERB=COMNT;      /* C                     @Y30DI3D*/ 00475000
         MVI   SUBVERB,X'05'                                       0152 00476000
*             ELSE                                                 0153 00477000
*               SYNTAXCD=INVSVRB;   /* INVALID VERB OR DELIMETER     */ 00478000
         B     @RC00151                                            0153 00479000
@RF00151 MVI   SYNTAXCD,X'01'                                      0153 00480000
*   ELSE                                                           0154 00481000
*     SYNTAXCD=INVDELIM;            /* INVALID DELIMETER FOLLOWING 0154 00482000
*                                      VERB                          */ 00483000
         B     @RC00142                                            0154 00484000
@RF00142 MVI   SYNTAXCD,X'02'                                      0154 00485000
*   GOTO ENDVRBT;                   /*                       @Y30DI3D*/ 00486000
         B     ENDVRBT                                             0155 00487000
*VERBEOF:                                                          0156 00488000
*   SYNTAXCD=NOPARMS;               /* INPUT ALL BLANKS      @Y30DI3D*/ 00489000
VERBEOF  MVI   SYNTAXCD,X'03'                                      0156 00490000
*ENDVRBT:                                                          0157 00491000
*   END VERBTEST;                   /*                       @Y30DI3D*/ 00492000
@EL00003 DS    0H                                                  0157 00493000
@EF00003 DS    0H                                                  0157 00494000
@ER00003 LM    @14,@12,@SA00003                                    0157 00495000
         BR    @14                                                 0157 00496000
*                                                                  0158 00497000
*/********************************************************************/ 00498000
*/*                                                          @Y30DI3D*/ 00499000
*/*   THIS ROUTINE SCANS THE 'HARDCOPY' SUBVERB              @Y30DI3D*/ 00500000
*/*   HARDCOPY ON - SETS SWITCH TO WRITE ALL DUMPS ON PRINTER        */ 00501000
*/*   HARDCOPY OFF - TURNS OFF SWITCH - NO PRINTER OUTPUT    @Y30DI3D*/ 00502000
*/*   HARDCOPY - WRITES PREVIOUS DUMP DISPLAYED ON PRINTER   @Y30DI3D*/ 00503000
*/*   HARDCOPY 'COMMENT' - WRITES USER'S COMMENT ON PRINTER  @Y30DI3D*/ 00504000
*/*                                                          @Y30DI3D*/ 00505000
*/********************************************************************/ 00506000
*                                                                  0158 00507000
*HCOPYRTN:                                                         0158 00508000
*   PROCEDURE;                      /*                       @Y30DI3D*/ 00509000
HCOPYRTN STM   @14,@12,@SA00004                                    0158 00510000
*   VERBGN=VERBEND+1;               /* POSITION AFTER LAST DELIMETER */ 00511000
         LA    @05,1                                               0159 00512000
         AL    @05,VERBEND(,COMBASE)                               0159 00513000
         ST    @05,VERBGN(,COMBASE)                                0159 00514000
*   WTORSIZE=SAVEWTOR-VERBGN;       /* REMAINING BUFFER AREA @Y30DI3D*/ 00515000
         LCR   @05,@05                                             0160 00516000
         AL    @05,SAVEWTOR                                        0160 00517000
         ST    @05,WTORSIZE                                        0160 00518000
*   TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR NEXT NON BLANK      */ 00519000
         L     @03,VERBGN(,COMBASE)                                0161 00520000
         L     @05,WTORSIZE                                        0161 00521000
         BCTR  @05,0                                               0161 00522000
         EX    @05,@SB00761                                        0161 00523000
*   BC(8,HCOPYNUL);                 /* NO ADDITIONAL PARM-PRINT DUMP */ 00524000
         BC    8,HCOPYNUL                                          0162 00525000
*   VERBGN=R1;                      /*                       @Y30DI3D*/ 00526000
         ST    R1,VERBGN(,COMBASE)                                 0163 00527000
*   SAVEBGN=VERBGN;                 /* SAVE FOR HC COMMENT   @Y30DI3D*/ 00528000
         L     @15,VERBGN(,COMBASE)                                0164 00529000
         ST    @15,SAVEBGN                                         0164 00530000
*   VERBEND=R1-1;                   /* INIT VERBEND FOR DLIMSCAN   0165 00531000
*                                                            @Y30DI3D*/ 00532000
         LR    @00,R1                                              0165 00533000
         BCTR  @00,0                                               0165 00534000
         ST    @00,VERBEND(,COMBASE)                               0165 00535000
*   CALL DLIMSCAN;                  /*                       @Y30DI3D*/ 00536000
         BAL   @14,DLIMSCAN                                        0166 00537000
*   IF HCOPYON=ON THEN              /* SET SWITCH FOR COMMENT BEG  0167 00538000
*                                      WITH 'ON'                     */ 00539000
         TM    HCOPYON,B'10000000'                                 0167 00540000
         BNO   @RF00167                                            0167 00541000
*     PREVSET=YES;                  /*                       @Y30DI3D*/ 00542000
         OI    PREVSET,B'00000010'                                 0168 00543000
*   ELSE                            /* FOR COMMENT BEG WITH 'OFF'  0169 00544000
*                                                            @Y30DI3D*/ 00545000
*     PREVSET=NO;                   /*                       @Y30DI3D*/ 00546000
         B     @RC00167                                            0169 00547000
@RF00167 NI    PREVSET,B'11111101'                                 0169 00548000
*   IF DELIMCD=BLANK THEN                                          0170 00549000
@RC00167 CLC   DELIMCD(4,COMBASE),@CF00242                         0170 00550000
         BNE   @RF00170                                            0170 00551000
*     IF OPSIZE=2&OPERAND(1:2)='ON' THEN                           0171 00552000
         CH    OPSIZE,@CH00165                                     0171 00553000
         BNE   @RF00171                                            0171 00554000
         L     @15,VERBGN(,COMBASE)                                0171 00555000
         CLC   OPERAND(2,@15),@CC00677                             0171 00556000
         BNE   @RF00171                                            0171 00557000
*       HCOPYON=ON;                 /* OUTPUT TO PRINTER     @Y30DI3D*/ 00558000
         OI    HCOPYON,B'10000000'                                 0172 00559000
*     ELSE                                                         0173 00560000
*       IF OPSIZE=3&OPERAND(1:3)='OFF' THEN                        0173 00561000
         B     @RC00171                                            0173 00562000
@RF00171 CH    OPSIZE,@CH00150                                     0173 00563000
         BNE   @RF00173                                            0173 00564000
         L     @15,VERBGN(,COMBASE)                                0173 00565000
         CLC   OPERAND(3,@15),@CC00678                             0173 00566000
         BNE   @RF00173                                            0173 00567000
*         HCOPYON=OFF;              /* NO OUTPUT TO PRINTER  @Y30DI3D*/ 00568000
         NI    HCOPYON,B'01111111'                                 0174 00569000
*   VERBGN=VERBEND+1;               /* POSITION AFTER LAST DELIMETER */ 00570000
@RF00173 DS    0H                                                  0175 00571000
@RC00171 DS    0H                                                  0175 00572000
@RF00170 LA    @05,1                                               0175 00573000
         AL    @05,VERBEND(,COMBASE)                               0175 00574000
         ST    @05,VERBGN(,COMBASE)                                0175 00575000
*   WTORSIZE=SAVEWTOR-VERBGN;       /* REMAINING BUFFER AREA @Y30DI3D*/ 00576000
         LCR   @05,@05                                             0176 00577000
         AL    @05,SAVEWTOR                                        0176 00578000
         ST    @05,WTORSIZE                                        0176 00579000
*   TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR ADDITIONAL CHARS    */ 00580000
         L     @03,VERBGN(,COMBASE)                                0177 00581000
         L     @05,WTORSIZE                                        0177 00582000
         BCTR  @05,0                                               0177 00583000
         EX    @05,@SB00761                                        0177 00584000
*   BC(8,ENDHC);                    /* NO MORE PARMS-THIS IS NOT A 0178 00585000
*                                      COMMENT                       */ 00586000
         BC    8,ENDHC                                             0178 00587000
*   IF PREVSET=YES THEN                                            0179 00588000
         TM    PREVSET,B'00000010'                                 0179 00589000
         BNO   @RF00179                                            0179 00590000
*     HCOPYON=ON;                   /* RESET FOR 1ST WORD 'OFF'    0180 00591000
*                                                            @Y30DI3D*/ 00592000
         OI    HCOPYON,B'10000000'                                 0180 00593000
*   ELSE                                                           0181 00594000
*     HCOPYON=OFF;                  /* RESET FOR 1ST WORD 'ON'     0181 00595000
*                                                            @Y30DI3D*/ 00596000
         B     @RC00179                                            0181 00597000
@RF00179 NI    HCOPYON,B'01111111'                                 0181 00598000
*   VERBGN=SAVEBGN;                 /* RESTORE ORIGINAL VERBGN     0182 00599000
*                                                            @Y30DI3D*/ 00600000
@RC00179 L     @00,SAVEBGN                                         0182 00601000
         ST    @00,VERBGN(,COMBASE)                                0182 00602000
*   COMSIZE=SAVEWTOR-VERBGN;        /* SIZE OF COMMENT       @Y30DI3D*/ 00603000
         L     COMSIZE,SAVEWTOR                                    0183 00604000
         SLR   COMSIZE,@00                                         0183 00605000
*   COMMAREA=BLANK80;               /* CLEAR OUTPUT BUFFER   @Y30DI3D*/ 00606000
         L     @15,OUTBUFAD                                        0184 00607000
         MVC   COMMAREA(80,@15),BLANK80                            0184 00608000
*   COMMAREA(1:COMSIZE)=OPERAND(1:COMSIZE);/* COMMENT TO OUTPUT BUF  */ 00609000
         LR    @14,COMSIZE                                         0185 00610000
         BCTR  @14,0                                               0185 00611000
         LR    @07,@00                                             0185 00612000
         EX    @14,@SM00764                                        0185 00613000
*   GEN REFS(AWRITE)(BRWRITE 1);    /* WRITE COMMENT TO PRINTER      */ 00614000
         BRWRITE 1                                                      00615000
*HCOPYNUL:                          /* WRITE DUMP TO PRINTER @Y30DI3D*/ 00616000
*   IF LINE>0 THEN                  /* DUMP HAS BEEN MADE    @Y30DI3D*/ 00617000
HCOPYNUL ICM   @05,15,LINE                                         0187 00618000
         BNP   @RF00187                                            0187 00619000
*     DO RITE=1 TO LINE;            /*                       @Y30DI3D*/ 00620000
         LA    RITE,1                                              0188 00621000
         B     @DE00188                                            0188 00622000
@DL00188 DS    0H                                                  0189 00623000
*       DATAREA=HCOPYBUF(RITE);     /* PUT DUMP LINE IN OUTPUT BUFFER*/ 00624000
         L     @15,OUTBUFAD                                        0189 00625000
         LR    @14,RITE                                            0189 00626000
         MH    @14,@CH00382                                        0189 00627000
         LA    @07,HCOPYBUF-80(@14)                                0189 00628000
         MVC   DATAREA(80,@15),0(@07)                              0189 00629000
*       GEN REFS(AWRITE)(BRWRITE 1);/*                       @Y30DI3D*/ 00630000
         BRWRITE 1                                                      00631000
*     END;                          /*                       @Y30DI3D*/ 00632000
         AH    RITE,@CH00058                                       0191 00633000
@DE00188 C     RITE,LINE                                           0191 00634000
         BNH   @DL00188                                            0191 00635000
*   COMMAREA=BLANK80;               /*                       @Y30DI3D*/ 00636000
@RF00187 L     @05,OUTBUFAD                                        0192 00637000
         MVC   COMMAREA(80,@05),BLANK80                            0192 00638000
*   GEN REFS(AWRITE)(BRWRITE 1);    /* SKIP LINE             @Y30DI3D*/ 00639000
         BRWRITE 1                                                      00640000
*ENDHC:                                                            0194 00641000
*   END HCOPYRTN;                   /*                       @Y30DI3D*/ 00642000
@EL00004 DS    0H                                                  0194 00643000
@EF00004 DS    0H                                                  0194 00644000
@ER00004 LM    @14,@12,@SA00004                                    0194 00645000
         BR    @14                                                 0194 00646000
*                                                                  0195 00647000
*/********************************************************************/ 00648000
*/*                                                          @Y30DI3D*/ 00649000
*/* THIS ROUTINE SCANS AND EXECUTES THE 'LIST' SUBVERB       @Y30DI3D*/ 00650000
*/*                                                          @Y30DI3D*/ 00651000
*/********************************************************************/ 00652000
*                                                                  0195 00653000
*STORTN:                                                           0195 00654000
*   PROCEDURE;                      /*                       @Y30DI3D*/ 00655000
STORTN   STM   @14,@12,@SA00005                                    0195 00656000
*   OPSCAN=ON;                      /*                       @Y30DI3D*/ 00657000
*   SIGNSW=OFF;                     /*                       @Y30DI3D*/ 00658000
         OI    OPSCAN,B'00010000'                                  0197 00659000
         NI    SIGNSW,B'11110111'                                  0197 00660000
*   NONAME=NO;                      /*                       @Y30DI3D*/ 00661000
         NI    NONAME,B'11011111'                                  0198 00662000
*   LEN1=0;                         /* INIT FOR NO DEFAULT LENGTH  0199 00663000
*                                                            @Y30DI3D*/ 00664000
         SLR   @05,@05                                             0199 00665000
         ST    @05,LEN1                                            0199 00666000
*   ASIDSW=OFF;                     /* NO DEFAULT LENGTH     @Y30DI3D*/ 00667000
         NI    ASIDSW,B'11011111'                                  0200 00668000
*   THISNAME=BLANK8;                /* CLEAR NAME BUFFER     @Y30DI3D*/ 00669000
         MVC   THISNAME(8),BLANK8                                  0201 00670000
*   VERBGN=VERBEND+1;               /* POSITION AFTER LAST DELIMETER */ 00671000
         LA    @05,1                                               0202 00672000
         AL    @05,VERBEND(,COMBASE)                               0202 00673000
         ST    @05,VERBGN(,COMBASE)                                0202 00674000
*   WTORSIZE=SAVEWTOR-VERBGN;       /* REMAINING BUFFER AREA @Y30DI3D*/ 00675000
         LCR   @05,@05                                             0203 00676000
         AL    @05,SAVEWTOR                                        0203 00677000
         ST    @05,WTORSIZE                                        0203 00678000
*   TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR NEXT NON BLANK      */ 00679000
         L     @03,VERBGN(,COMBASE)                                0204 00680000
         L     @05,WTORSIZE                                        0204 00681000
         BCTR  @05,0                                               0204 00682000
         EX    @05,@SB00761                                        0204 00683000
*   BC(8,LISTEOF);                  /* NO PARMS AFTER 'LIST' @Y30DI3D*/ 00684000
         BC    8,LISTEOF                                           0205 00685000
*   VERBEND=R1-1;                   /* INIT VERBEND FOR DLIMSCAN   0206 00686000
*                                                            @Y30DI3D*/ 00687000
         LR    @00,R1                                              0206 00688000
         BCTR  @00,0                                               0206 00689000
         ST    @00,VERBEND(,COMBASE)                               0206 00690000
*   CALL DLIMSCAN;                  /* GET ADDRESS           @Y30DI3D*/ 00691000
         BAL   @14,DLIMSCAN                                        0207 00692000
*   IF DELIMCD=PERIOD THEN          /* DIRECT ADDRESSING USED      0208 00693000
*                                                            @Y30DI3D*/ 00694000
         CLC   DELIMCD(4,COMBASE),@CF00414                         0208 00695000
         BNE   @RF00208                                            0208 00696000
*     DO;                           /*                       @Y30DI3D*/ 00697000
*       NONAME=YES;                 /* DO NOT SCAN NAME TABLE      0210 00698000
*                                                            @Y30DI3D*/ 00699000
         OI    NONAME,B'00100000'                                  0210 00700000
*       IF OPSIZE>0&OPSIZE<7 THEN                                  0211 00701000
         LTR   OPSIZE,OPSIZE                                       0211 00702000
         BNP   @RF00211                                            0211 00703000
         CH    OPSIZE,@CH00686                                     0211 00704000
         BNL   @RF00211                                            0211 00705000
*         DO;                       /*                       @Y30DI3D*/ 00706000
*           CALL DIGITSCN;          /* CHECK FOR DIRECT ADDRESSING 0213 00707000
*                                                            @Y30DI3D*/ 00708000
         BAL   @14,DIGITSCN                                        0213 00709000
*           IF SYNTAXCD=GOOD THEN                                  0214 00710000
         CLI   SYNTAXCD,X'00'                                      0214 00711000
         BNE   @RF00214                                            0214 00712000
*             DO;                   /*                       @Y30DI3D*/ 00713000
*               LOADDR=GOODNUM;     /* DIRECT ADDRESSING USED      0216 00714000
*                                                            @Y30DI3D*/ 00715000
         MVC   LOADDR(4),GOODNUM                                   0216 00716000
*               CALL DLIMSCAN;      /* SCAN FOR PLUS,MINUS,OR BLANK  */ 00717000
         BAL   @14,DLIMSCAN                                        0217 00718000
*             END;                  /*                       @Y30DI3D*/ 00719000
*           ELSE                                                   0219 00720000
*             ;                     /*                       @Y30DI3D*/ 00721000
@RF00214 DS    0H                                                  0220 00722000
*         END;                      /*                       @Y30DI3D*/ 00723000
*       ELSE                                                       0221 00724000
*         SYNTAXCD=INVADDR;         /* INVALID LENGTH ON ADDRESS     */ 00725000
         B     @RC00211                                            0221 00726000
@RF00211 MVI   SYNTAXCD,X'05'                                      0221 00727000
*     END;                          /*                       @Y30DI3D*/ 00728000
@RC00211 DS    0H                                                  0223 00729000
*   IF SYNTAXCD=GOOD THEN                                          0223 00730000
@RF00208 CLI   SYNTAXCD,X'00'                                      0223 00731000
         BNE   @RF00223                                            0223 00732000
*     IF DELIMCD=BLANK THEN         /* NO OFFSET             @Y30DI3D*/ 00733000
         CLC   DELIMCD(4,COMBASE),@CF00242                         0224 00734000
         BNE   @RF00224                                            0224 00735000
*       IF OPSIZE>0&OPSIZE<9&NONAME=NO THEN/* RELATIVE ADDRESS       */ 00736000
         LTR   OPSIZE,OPSIZE                                       0225 00737000
         BNP   @RF00225                                            0225 00738000
         CH    OPSIZE,@CH00172                                     0225 00739000
         BNL   @RF00225                                            0225 00740000
         TM    NONAME,B'00100000'                                  0225 00741000
         BNZ   @RF00225                                            0225 00742000
*         DO;                       /*                       @Y30DI3D*/ 00743000
*           CALL NAMESCAN;          /* SCAN NAME TABLE FOR MATCH   0227 00744000
*                                                            @Y30DI3D*/ 00745000
         BAL   @14,NAMESCAN                                        0227 00746000
*           IF SYNTAXCD=GOOD THEN                                  0228 00747000
         CLI   SYNTAXCD,X'00'                                      0228 00748000
         BNE   @RF00228                                            0228 00749000
*             LOADDR=GOODNUM;       /* STARTING ADDRESS      @Y30DI3D*/ 00750000
         MVC   LOADDR(4),GOODNUM                                   0229 00751000
*           ELSE                                                   0230 00752000
*             ;                     /*                       @Y30DI3D*/ 00753000
@RF00228 DS    0H                                                  0231 00754000
*         END;                      /*                       @Y30DI3D*/ 00755000
*       ELSE                                                       0232 00756000
*         IF OPSIZE=0&NONAME=YES THEN                              0232 00757000
         B     @RC00225                                            0232 00758000
@RF00225 LTR   OPSIZE,OPSIZE                                       0232 00759000
         BNZ   @RF00232                                            0232 00760000
         TM    NONAME,B'00100000'                                  0232 00761000
         BO    @RT00232                                            0232 00762000
*           ;                       /* DIRECT ADDRESS        @Y30DI3D*/ 00763000
*         ELSE                                                     0234 00764000
*           SYNTAXCD=INVPARM;       /* INVALID PARAMETER     @Y30DI3D*/ 00765000
@RF00232 MVI   SYNTAXCD,X'08'                                      0234 00766000
*     ELSE                                                         0235 00767000
*       IF DELIMCD=PLUS|DELIMCD=MINUS THEN/* OFFSET USED     @Y30DI3D*/ 00768000
         B     @RC00224                                            0235 00769000
@RF00224 L     @15,DELIMCD(,COMBASE)                               0235 00770000
         CH    @15,@CH00224                                        0235 00771000
         BE    @RT00235                                            0235 00772000
         CH    @15,@CH00412                                        0235 00773000
         BNE   @RF00235                                            0235 00774000
@RT00235 DS    0H                                                  0236 00775000
*         DO;                       /*                       @Y30DI3D*/ 00776000
*           SIGN=DELIMCD;           /* SAVE SIGN FOR OFFSET  @Y30DI3D*/ 00777000
         MVC   SIGN(4),DELIMCD(COMBASE)                            0237 00778000
*           SIGNSW=ON;              /* SET TO SCAN FOR OFFSET      0238 00779000
*                                                            @Y30DI3D*/ 00780000
         OI    SIGNSW,B'00001000'                                  0238 00781000
*           IF OPSIZE>0&OPSIZE<9&NONAME=NO THEN/* RELATIVE ADDR      */ 00782000
         LTR   OPSIZE,OPSIZE                                       0239 00783000
         BNP   @RF00239                                            0239 00784000
         CH    OPSIZE,@CH00172                                     0239 00785000
         BNL   @RF00239                                            0239 00786000
         TM    NONAME,B'00100000'                                  0239 00787000
         BNZ   @RF00239                                            0239 00788000
*             DO;                   /*                       @Y30DI3D*/ 00789000
*               CALL NAMESCAN;      /* SCAN NAME TABLE       @Y30DI3D*/ 00790000
         BAL   @14,NAMESCAN                                        0241 00791000
*               IF SYNTAXCD=GOOD THEN                              0242 00792000
         CLI   SYNTAXCD,X'00'                                      0242 00793000
         BNE   @RF00242                                            0242 00794000
*                 LOADDR=GOODNUM;   /*                       @Y30DI3D*/ 00795000
         MVC   LOADDR(4),GOODNUM                                   0243 00796000
*               ELSE                                               0244 00797000
*                 ;                 /*                       @Y30DI3D*/ 00798000
@RF00242 DS    0H                                                  0245 00799000
*             END;                  /*                       @Y30DI3D*/ 00800000
*           ELSE                                                   0246 00801000
*             IF OPSIZE=0&NONAME=YES THEN                          0246 00802000
         B     @RC00239                                            0246 00803000
@RF00239 LTR   OPSIZE,OPSIZE                                       0246 00804000
         BNZ   @RF00246                                            0246 00805000
         TM    NONAME,B'00100000'                                  0246 00806000
         BO    @RT00246                                            0246 00807000
*               ;                   /* DIRECT ADDRESS        @Y30DI3D*/ 00808000
*             ELSE                                                 0248 00809000
*               SYNTAXCD=INVPARM;   /* INVALID OPERAND AFTER ADDRESS */ 00810000
@RF00246 MVI   SYNTAXCD,X'08'                                      0248 00811000
*         END;                      /*                       @Y30DI3D*/ 00812000
*       ELSE                                                       0250 00813000
*         SYNTAXCD=INVDELIM;        /* INVALID DELIMETER AFTER     0250 00814000
*                                      ADDRESS                       */ 00815000
         B     @RC00235                                            0250 00816000
@RF00235 MVI   SYNTAXCD,X'02'                                      0250 00817000
*   IF SIGNSW=OFF&SYNTAXCD=GOOD THEN/* NO OFFSET,GET NEXT OPERAND    */ 00818000
@RC00235 DS    0H                                                  0251 00819000
@RC00224 DS    0H                                                  0251 00820000
@RF00223 TM    SIGNSW,B'00001000'                                  0251 00821000
         BNZ   @RF00251                                            0251 00822000
         CLI   SYNTAXCD,X'00'                                      0251 00823000
         BNE   @RF00251                                            0251 00824000
*     DO;                           /*                       @Y30DI3D*/ 00825000
*       VERBGN=VERBEND+1;           /* POSITION AFTER LAST DELIMETER */ 00826000
         LA    @00,1                                               0253 00827000
         AL    @00,VERBEND(,COMBASE)                               0253 00828000
         ST    @00,VERBGN(,COMBASE)                                0253 00829000
*       WTORSIZE=SAVEWTOR-VERBGN;   /* REMAINING BUFFER AREA @Y30DI3D*/ 00830000
         LCR   @00,@00                                             0254 00831000
         AL    @00,SAVEWTOR                                        0254 00832000
         ST    @00,WTORSIZE                                        0254 00833000
*       TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR NEXT NON BLANK  */ 00834000
         L     @03,VERBGN(,COMBASE)                                0255 00835000
         L     @15,WTORSIZE                                        0255 00836000
         BCTR  @15,0                                               0255 00837000
         EX    @15,@SB00761                                        0255 00838000
*       BC(6,LENRTN);               /* SCAN FOR LENGTH       @Y30DI3D*/ 00839000
         BC    6,LENRTN                                            0256 00840000
*       LEN1=4;                     /* USE DEFAULT LENGTH    @Y30DI3D*/ 00841000
         MVC   LEN1(4),@CF00157                                    0257 00842000
*       THISASID=LASTASID;          /* USE DEFAULT ASID      @Y30DI3D*/ 00843000
         MVC   THISASID(2),LASTASID                                0258 00844000
*       OPSCAN=OFF;                 /* END OF SCAN           @Y30DI3D*/ 00845000
         NI    OPSCAN,B'11101111'                                  0259 00846000
*     END;                          /*                       @Y30DI3D*/ 00847000
*                                                                  0261 00848000
*/********************************************************************/ 00849000
*/*                                                          @Y30DI3D*/ 00850000
*/* GET OFFSET, IF ANY AND ADD TO OR SUBTRACT FROM ADDRESS   @Y30DI3D*/ 00851000
*/*                                                          @Y30DI3D*/ 00852000
*/********************************************************************/ 00853000
*                                                                  0261 00854000
*   IF OPSCAN=ON&SYNTAXCD=GOOD&SIGNSW=ON THEN/* OFFSET USED          */ 00855000
@RF00251 TM    OPSCAN,B'00010000'                                  0261 00856000
         BNO   @RF00261                                            0261 00857000
         CLI   SYNTAXCD,X'00'                                      0261 00858000
         BNE   @RF00261                                            0261 00859000
         TM    SIGNSW,B'00001000'                                  0261 00860000
         BNO   @RF00261                                            0261 00861000
*     DO;                           /*                       @Y30DI3D*/ 00862000
*       CALL DLIMSCAN;              /*                       @Y30DI3D*/ 00863000
         BAL   @14,DLIMSCAN                                        0263 00864000
*       IF DELIMCD=BLANK THEN       /* CORRECT DELIM AFTER OFFSET    */ 00865000
         CLC   DELIMCD(4,COMBASE),@CF00242                         0264 00866000
         BNE   @RF00264                                            0264 00867000
*         IF OPSIZE=0 THEN                                         0265 00868000
         LTR   OPSIZE,OPSIZE                                       0265 00869000
         BNZ   @RF00265                                            0265 00870000
*           SYNTAXCD=NOPARMS;       /*                       @Y30DI3D*/ 00871000
         MVI   SYNTAXCD,X'03'                                      0266 00872000
*         ELSE                                                     0267 00873000
*           IF OPSIZE>6 THEN                                       0267 00874000
         B     @RC00265                                            0267 00875000
@RF00265 CH    OPSIZE,@CH00387                                     0267 00876000
         BNH   @RF00267                                            0267 00877000
*             SYNTAXCD=INVOFST;     /*                       @Y30DI3D*/ 00878000
         MVI   SYNTAXCD,X'07'                                      0268 00879000
*           ELSE                                                   0269 00880000
*             DO;                   /*                       @Y30DI3D*/ 00881000
         B     @RC00267                                            0269 00882000
@RF00267 DS    0H                                                  0270 00883000
*               CALL DIGITSCN;      /* CHECK FOR VALID OFFSET        */ 00884000
         BAL   @14,DIGITSCN                                        0270 00885000
*               IF SYNTAXCD=GOOD THEN/* CALCULATE ADDRESS            */ 00886000
         CLI   SYNTAXCD,X'00'                                      0271 00887000
         BNE   @RF00271                                            0271 00888000
*                 DO;               /* CONVERT ADDR TO BINARY        */ 00889000
*                   IF SIGN=PLUS THEN/* ADD OFFSET TO ADDRESS        */ 00890000
         CLC   SIGN(4),@CF00224                                    0273 00891000
         BNE   @RF00273                                            0273 00892000
*                     LOADDR=LOADDR+GOODNUM;/*               @Y30DI3D*/ 00893000
         L     @00,LOADDR                                          0274 00894000
         AL    @00,GOODNUM                                         0274 00895000
         ST    @00,LOADDR                                          0274 00896000
*                   ELSE            /* SUBTRACT OFFSET FROM ADDR     */ 00897000
*                     LOADDR=LOADDR-GOODNUM;/*               @Y30DI3D*/ 00898000
         B     @RC00273                                            0275 00899000
@RF00273 L     @00,LOADDR                                          0275 00900000
         SL    @00,GOODNUM                                         0275 00901000
         ST    @00,LOADDR                                          0275 00902000
*                   IF LOADDR>ADDRMAX THEN/* ADDRESS+OFFSET>FFFFFF 0276 00903000
*                                                            @Y30DI3D*/ 00904000
@RC00273 CLC   LOADDR(4),@CF00432                                  0276 00905000
         BNH   @RF00276                                            0276 00906000
*                     SYNTAXCD=INVADDR;/* INVALID ADDRESS    @Y30DI3D*/ 00907000
         MVI   SYNTAXCD,X'05'                                      0277 00908000
*                   VERBGN=VERBEND+1;/* POSITION AFTER LAST DELIM    */ 00909000
@RF00276 LA    @00,1                                               0278 00910000
         AL    @00,VERBEND(,COMBASE)                               0278 00911000
         ST    @00,VERBGN(,COMBASE)                                0278 00912000
*                   WTORSIZE=SAVEWTOR-VERBGN;/* REMAINING BUFFER AREA*/ 00913000
         LCR   @00,@00                                             0279 00914000
         AL    @00,SAVEWTOR                                        0279 00915000
         ST    @00,WTORSIZE                                        0279 00916000
*                   TRT(OPERAND(1:WTORSIZE),NONBLNK);/*      @Y30DI3D*/ 00917000
         L     @03,VERBGN(,COMBASE)                                0280 00918000
         L     @15,WTORSIZE                                        0280 00919000
         BCTR  @15,0                                               0280 00920000
         EX    @15,@SB00761                                        0280 00921000
*                   BC(6,LENRTN);   /* GO TO LENGTH ROUTINE IF NOT 0281 00922000
*                                      BLNKS                         */ 00923000
         BC    6,LENRTN                                            0281 00924000
*                   LEN1=4;         /* USE DEFAULT LENGTH            */ 00925000
         MVC   LEN1(4),@CF00157                                    0282 00926000
*                   THISASID=LASTASID;/* USE DEFAULT ASID    @Y30DI3D*/ 00927000
         MVC   THISASID(2),LASTASID                                0283 00928000
*                   OPSCAN=OFF;     /* END OF SCAN           @Y30DI3D*/ 00929000
         NI    OPSCAN,B'11101111'                                  0284 00930000
*                 END;              /*                       @Y30DI3D*/ 00931000
*             END;                  /*                       @Y30DI3D*/ 00932000
*       ELSE                                                       0287 00933000
*         SYNTAXCD=INVDELIM;        /* NO BLANK AFTER OFFSET @Y30DI3D*/ 00934000
         B     @RC00264                                            0287 00935000
@RF00264 MVI   SYNTAXCD,X'02'                                      0287 00936000
*     END;                          /*                       @Y30DI3D*/ 00937000
@RC00264 DS    0H                                                  0289 00938000
*                                                                  0289 00939000
*/********************************************************************/ 00940000
*/*                                                          @Y30DI3D*/ 00941000
*/* GET LENGTH, IF SPECIFIED, AND CALCULATE HIGH ADDRESS     @Y30DI3D*/ 00942000
*/*                                                          @Y30DI3D*/ 00943000
*/********************************************************************/ 00944000
*                                                                  0289 00945000
*LENRTN:                                                           0289 00946000
*   VERBEND=R1-1;                   /* INIT VERBEND FOR DLIMSCAN   0289 00947000
*                                                            @Y30DI3D*/ 00948000
@RF00261 DS    0H                                                  0289 00949000
LENRTN   LR    @00,R1                                              0289 00950000
         BCTR  @00,0                                               0289 00951000
         ST    @00,VERBEND(,COMBASE)                               0289 00952000
*   IF OPSCAN=ON&SYNTAXCD=GOOD THEN                                0290 00953000
         TM    OPSCAN,B'00010000'                                  0290 00954000
         BNO   @RF00290                                            0290 00955000
         CLI   SYNTAXCD,X'00'                                      0290 00956000
         BNE   @RF00290                                            0290 00957000
*     DO;                           /*                       @Y30DI3D*/ 00958000
*       CALL DLIMSCAN;              /*                       @Y30DI3D*/ 00959000
         BAL   @14,DLIMSCAN                                        0292 00960000
*       IF DELIMCD=LPAREN THEN      /* CHECK FOR LENGTH OR ASID    0293 00961000
*                                                            @Y30DI3D*/ 00962000
         CLC   DELIMCD(4,COMBASE),@CF00185                         0293 00963000
         BNE   @RF00293                                            0293 00964000
*         IF OPSIZE=1&OPERAND(1)='L' THEN                          0294 00965000
         CH    OPSIZE,@CH00058                                     0294 00966000
         BNE   @RF00294                                            0294 00967000
         L     @15,VERBGN(,COMBASE)                                0294 00968000
         CLI   OPERAND(@15),C'L'                                   0294 00969000
         BNE   @RF00294                                            0294 00970000
*           DO;                     /*                       @Y30DI3D*/ 00971000
*             CALL DLIMSCAN;        /* SCAN FOR RIGHT PAREN  @Y30DI3D*/ 00972000
         BAL   @14,DLIMSCAN                                        0296 00973000
*             IF DELIMCD=RPAREN&OPSIZE>0&OPSIZE<4 THEN             0297 00974000
         CLC   DELIMCD(4,COMBASE),@CF00215                         0297 00975000
         BNE   @RF00297                                            0297 00976000
         LTR   OPSIZE,OPSIZE                                       0297 00977000
         BNP   @RF00297                                            0297 00978000
         CH    OPSIZE,@CH00157                                     0297 00979000
         BNL   @RF00297                                            0297 00980000
*               DO L=1 TO OPSIZE WHILE SYNTAXCD=GOOD;/*      @Y30DI3D*/ 00981000
         LA    @00,1                                               0298 00982000
         B     @DE00298                                            0298 00983000
@DL00298 CLI   SYNTAXCD,X'00'                                      0298 00984000
         BNE   @DC00298                                            0298 00985000
*                 IF OPERAND(L)>='0'&OPERAND(L)<='9' THEN          0299 00986000
         L     @15,VERBGN(,COMBASE)                                0299 00987000
         LR    @14,@00                                             0299 00988000
         ALR   @14,@15                                             0299 00989000
         BCTR  @14,0                                               0299 00990000
         CLI   OPERAND(@14),C'0'                                   0299 00991000
         BL    @RF00299                                            0299 00992000
         ALR   @15,@00                                             0299 00993000
         BCTR  @15,0                                               0299 00994000
         CLI   OPERAND(@15),C'9'                                   0299 00995000
         BNH   @RT00299                                            0299 00996000
*                   ;               /*                       @Y30DI3D*/ 00997000
*                 ELSE                                             0301 00998000
*                   SYNTAXCD=LNOTDEC;/* LENGTH NOT DECIMAL           */ 00999000
@RF00299 MVI   SYNTAXCD,X'0C'                                      0301 01000000
*               END;                /*                       @Y30DI3D*/ 01001000
@RT00299 LA    @00,1                                               0302 01002000
         AL    @00,L                                               0302 01003000
@DE00298 ST    @00,L                                               0302 01004000
         CR    @00,OPSIZE                                          0302 01005000
         BNH   @DL00298                                            0302 01006000
@DC00298 DS    0H                                                  0303 01007000
*             ELSE                                                 0303 01008000
*               SYNTAXCD=INVLEN;    /*                       @Y30DI3D*/ 01009000
         B     @RC00297                                            0303 01010000
@RF00297 MVI   SYNTAXCD,X'0B'                                      0303 01011000
*             IF SYNTAXCD=GOOD THEN /* GET HIGH ADDR OF STORAGE REQ  */ 01012000
@RC00297 CLI   SYNTAXCD,X'00'                                      0304 01013000
         BNE   @RF00304                                            0304 01014000
*               DO;                 /* CONVERT TO HEX        @Y30DI3D*/ 01015000
*                 TR(OPERAND(1:OPSIZE),HEXTABL);/*           @Y30DI3D*/ 01016000
         L     @15,VERBGN(,COMBASE)                                0306 01017000
         LR    @14,OPSIZE                                          0306 01018000
         BCTR  @14,0                                               0306 01019000
         EX    @14,@SB00770                                        0306 01020000
*                 CHARWORK=BLANK6;  /*                       @Y30DI3D*/ 01021000
         MVC   CHARWORK(6),@CC00388                                0307 01022000
*                 CHARWORK((7-OPSIZE):6)=OPERAND(1:OPSIZE);/*      0308 01023000
*                                                            @Y30DI3D*/ 01024000
         LA    @14,7                                               0308 01025000
         SLR   @14,OPSIZE                                          0308 01026000
         LA    @07,CHARWORK-1(@14)                                 0308 01027000
         LCR   @14,@14                                             0308 01028000
         AH    @14,@CH00387                                        0308 01029000
         EX    @14,@SM00772                                        0308 01030000
*                 PACK(LEN2,CHARWORK);/*                     @Y30DI3D*/ 01031000
         PACK  LEN2(4),CHARWORK(6)                                 0309 01032000
*                 CVB(HEXCONV,LEN2);/*                       @Y30DI3D*/ 01033000
         XC    @TS00001(8),@TS00001                                0310 01034000
         MVC   @TS00001+4(4),LEN2                                  0310 01035000
         CVB   @00,@TS00001                                        0310 01036000
         ST    @00,HEXCONV                                         0310 01037000
*                 IF HEXCONV=0|HEXCONV>LENMAX THEN                 0311 01038000
         LTR   @00,@00                                             0311 01039000
         BZ    @RT00311                                            0311 01040000
         CH    @00,@CH00174                                        0311 01041000
         BNH   @RF00311                                            0311 01042000
@RT00311 DS    0H                                                  0312 01043000
*                   SYNTAXCD=INVLEN;/* INVALID LENGTH        @Y30DI3D*/ 01044000
         MVI   SYNTAXCD,X'0B'                                      0312 01045000
*                 ELSE                                             0313 01046000
*                   DO;             /*                       @Y30DI3D*/ 01047000
         B     @RC00311                                            0313 01048000
@RF00311 DS    0H                                                  0314 01049000
*                     HIADDR=LOADDR+HEXCONV;/*               @Y30DI3D*/ 01050000
         L     @00,LOADDR                                          0314 01051000
         AL    @00,HEXCONV                                         0314 01052000
         ST    @00,HIADDR                                          0314 01053000
*                     IF HIADDR>ADDRMAX THEN/* DEFAULT TO 'FFFFFF'   */ 01054000
         L     @15,@CF00432                                        0315 01055000
         CR    @00,@15                                             0315 01056000
         BNH   @RF00315                                            0315 01057000
*                       HIADDR=ADDRMAX;/*                    @Y30DI3D*/ 01058000
         ST    @15,HIADDR                                          0316 01059000
*                     ELSE                                         0317 01060000
*                       ;           /*                       @Y30DI3D*/ 01061000
@RF00315 DS    0H                                                  0318 01062000
*                   END;            /*                       @Y30DI3D*/ 01063000
*               END;                /*                       @Y30DI3D*/ 01064000
*             ELSE                                                 0320 01065000
*               ;                   /*                       @Y30DI3D*/ 01066000
@RF00304 DS    0H                                                  0321 01067000
*           END;                    /*                       @Y30DI3D*/ 01068000
*         ELSE                                                     0322 01069000
*           IF OPSIZE=4&OPERAND(1:4)='ASID' THEN                   0322 01070000
         B     @RC00294                                            0322 01071000
@RF00294 LA    @15,4                                               0322 01072000
         CR    OPSIZE,@15                                          0322 01073000
         BNE   @RF00322                                            0322 01074000
         L     @14,VERBGN(,COMBASE)                                0322 01075000
         CLC   OPERAND(4,@14),@CC00696                             0322 01076000
         BNE   @RF00322                                            0322 01077000
*             DO;                   /*                       @Y30DI3D*/ 01078000
*               ASIDSW=ON;          /*                       @Y30DI3D*/ 01079000
         OI    ASIDSW,B'00100000'                                  0324 01080000
*               LEN1=4;             /* USE DEFAULT LENGTH    @Y30DI3D*/ 01081000
         ST    @15,LEN1                                            0325 01082000
*             END;                  /*                       @Y30DI3D*/ 01083000
*           ELSE                                                   0327 01084000
*             SYNTAXCD=INVPARM;     /* INVALID OPERAND       @Y30DI3D*/ 01085000
         B     @RC00322                                            0327 01086000
@RF00322 MVI   SYNTAXCD,X'08'                                      0327 01087000
*       ELSE                                                       0328 01088000
*         SYNTAXCD=INVDELIM;        /* INVALID DELIMETER     @Y30DI3D*/ 01089000
         B     @RC00293                                            0328 01090000
@RF00293 MVI   SYNTAXCD,X'02'                                      0328 01091000
*     END;                          /*                       @Y30DI3D*/ 01092000
@RC00293 DS    0H                                                  0330 01093000
*/********************************************************************/ 01094000
*/*                                                          @Y30DI3D*/ 01095000
*/*  NO LENGTH SPECIFIED,GET HIADDR USING DEFAULT LENGTH     @Y30DI3D*/ 01096000
*/*                                                          @Y30DI3D*/ 01097000
*/********************************************************************/ 01098000
*                                                                  0330 01099000
*   IF SYNTAXCD=GOOD THEN                                          0330 01100000
@RF00290 CLI   SYNTAXCD,X'00'                                      0330 01101000
         BNE   @RF00330                                            0330 01102000
*     DO;                           /*                       @Y30DI3D*/ 01103000
*       IF OPSCAN=OFF|LEN1=4 THEN                                  0332 01104000
         TM    OPSCAN,B'00010000'                                  0332 01105000
         BZ    @RT00332                                            0332 01106000
         CLC   LEN1(4),@CF00157                                    0332 01107000
         BNE   @RF00332                                            0332 01108000
@RT00332 DS    0H                                                  0333 01109000
*         DO;                       /*                       @Y30DI3D*/ 01110000
*           HIADDR=LOADDR+LEN1;     /*                       @Y30DI3D*/ 01111000
         L     @00,LOADDR                                          0334 01112000
         AL    @00,LEN1                                            0334 01113000
         ST    @00,HIADDR                                          0334 01114000
*           IF HIADDR>ADDRMAX THEN  /* DEFAULT TO 'FFFFFF'   @Y30DI3D*/ 01115000
         L     @15,@CF00432                                        0335 01116000
         CR    @00,@15                                             0335 01117000
         BNH   @RF00335                                            0335 01118000
*             HIADDR=ADDRMAX;       /*                       @Y30DI3D*/ 01119000
         ST    @15,HIADDR                                          0336 01120000
*         END;                      /*                       @Y30DI3D*/ 01121000
@RF00335 DS    0H                                                  0338 01122000
*       IF OPSCAN=ON&ASIDSW=OFF THEN/* SCAN FOR ASID         @Y30DI3D*/ 01123000
@RF00332 TM    OPSCAN,B'00010000'                                  0338 01124000
         BNO   @RF00338                                            0338 01125000
         TM    ASIDSW,B'00100000'                                  0338 01126000
         BNZ   @RF00338                                            0338 01127000
*         DO;                       /*                       @Y30DI3D*/ 01128000
*           VERBGN=VERBEND+1;       /*                       @Y30DI3D*/ 01129000
         LA    @00,1                                               0340 01130000
         AL    @00,VERBEND(,COMBASE)                               0340 01131000
         ST    @00,VERBGN(,COMBASE)                                0340 01132000
*           WTORSIZE=SAVEWTOR-VERBGN;/* REMAINING BUFFER AREA      0341 01133000
*                                                            @Y30DI3D*/ 01134000
         LCR   @00,@00                                             0341 01135000
         AL    @00,SAVEWTOR                                        0341 01136000
         ST    @00,WTORSIZE                                        0341 01137000
*           TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR NEXT NON  0342 01138000
*                                      BLANK                         */ 01139000
         L     @03,VERBGN(,COMBASE)                                0342 01140000
         L     @15,WTORSIZE                                        0342 01141000
         BCTR  @15,0                                               0342 01142000
         EX    @15,@SB00761                                        0342 01143000
*           BC(6,ASIDRTN);          /* GO TO ASID ROUTINE    @Y30DI3D*/ 01144000
         BC    6,ASIDRTN                                           0343 01145000
*           THISASID=LASTASID;      /* USE DEFAULT ASID      @Y30DI3D*/ 01146000
         MVC   THISASID(2),LASTASID                                0344 01147000
*           OPSCAN=OFF;             /* END OF SCAN           @Y30DI3D*/ 01148000
         NI    OPSCAN,B'11101111'                                  0345 01149000
*         END;                      /*                       @Y30DI3D*/ 01150000
*     END;                          /*                       @Y30DI3D*/ 01151000
@RF00338 DS    0H                                                  0348 01152000
*                                                                  0348 01153000
*/********************************************************************/ 01154000
*/*                                                          @Y30DI3D*/ 01155000
*/* GET ASID, IF SPECIFIED. ASID 0 AND FFFF ARE INVALID      @Y30DI3D*/ 01156000
*/*                                                          @Y30DI3D*/ 01157000
*/********************************************************************/ 01158000
*                                                                  0348 01159000
*ASIDRTN:                           /*                       @Y30DI3D   01160000
*                                                            @Y30DI3D*/ 01161000
*   IF OPSCAN=ON&SYNTAXCD=GOOD THEN                                0348 01162000
@RF00330 DS    0H                                                  0348 01163000
ASIDRTN  TM    OPSCAN,B'00010000'                                  0348 01164000
         BNO   @RF00348                                            0348 01165000
         CLI   SYNTAXCD,X'00'                                      0348 01166000
         BNE   @RF00348                                            0348 01167000
*     DO;                           /*                       @Y30DI3D*/ 01168000
*       IF ASIDSW=OFF THEN          /* SCAN FOR ASID         @Y30DI3D*/ 01169000
         TM    ASIDSW,B'00100000'                                  0350 01170000
         BNZ   @RF00350                                            0350 01171000
*         DO;                       /*                       @Y30DI3D*/ 01172000
*           VERBEND=R1-1;           /* INIT VERBEND FOR DLIMSCAN   0352 01173000
*                                                            @Y30DI3D*/ 01174000
         LR    @00,R1                                              0352 01175000
         BCTR  @00,0                                               0352 01176000
         ST    @00,VERBEND(,COMBASE)                               0352 01177000
*           CALL DLIMSCAN;          /*                       @Y30DI3D*/ 01178000
         BAL   @14,DLIMSCAN                                        0353 01179000
*         END;                      /*                       @Y30DI3D*/ 01180000
*       ELSE                                                       0355 01181000
*         ;                         /* ASID ALREADY FOUND    @Y30DI3D*/ 01182000
@RF00350 DS    0H                                                  0356 01183000
*       IF DELIMCD=LPAREN&OPSIZE=4&OPERAND(1:4)='ASID' THEN        0356 01184000
         CLC   DELIMCD(4,COMBASE),@CF00185                         0356 01185000
         BNE   @RF00356                                            0356 01186000
         CH    OPSIZE,@CH00157                                     0356 01187000
         BNE   @RF00356                                            0356 01188000
         L     @15,VERBGN(,COMBASE)                                0356 01189000
         CLC   OPERAND(4,@15),@CC00696                             0356 01190000
         BNE   @RF00356                                            0356 01191000
*         DO;                       /*                       @Y30DI3D*/ 01192000
*           CALL DLIMSCAN;          /*                       @Y30DI3D*/ 01193000
         BAL   @14,DLIMSCAN                                        0358 01194000
*           IF DELIMCD=RPAREN&OPSIZE>0&OPSIZE<5 THEN               0359 01195000
         CLC   DELIMCD(4,COMBASE),@CF00215                         0359 01196000
         BNE   @RF00359                                            0359 01197000
         LTR   OPSIZE,OPSIZE                                       0359 01198000
         BNP   @RF00359                                            0359 01199000
         CH    OPSIZE,@CH00155                                     0359 01200000
         BNL   @RF00359                                            0359 01201000
*             DO;                   /*                       @Y30DI3D*/ 01202000
*               CALL DIGITSCN;      /* CHECK FOR VALID ASID  @Y30DI3D*/ 01203000
         BAL   @14,DIGITSCN                                        0361 01204000
*               IF SYNTAXCD=GOOD THEN                              0362 01205000
         CLI   SYNTAXCD,X'00'                                      0362 01206000
         BNE   @RF00362                                            0362 01207000
*                 DO;               /*                       @Y30DI3D*/ 01208000
*                   THISASID=GOODNUM;/*                      @Y30DI3D*/ 01209000
         L     @05,GOODNUM                                         0364 01210000
         STH   @05,THISASID                                        0364 01211000
*                   LASTASID=THISASID;/* INIT FOR NEXT LIST  @Y30DI3D*/ 01212000
         MVC   LASTASID(2),THISASID                                0365 01213000
*                   IF THISASID=0|THISASID=ASIDFFFF THEN           0366 01214000
         LTR   @05,@05                                             0366 01215000
         BZ    @RT00366                                            0366 01216000
         CLC   THISASID(2),@CB00436                                0366 01217000
         BNE   @RF00366                                            0366 01218000
@RT00366 DS    0H                                                  0367 01219000
*                     SYNTAXCD=INVASID;/*                    @Y30DI3D*/ 01220000
         MVI   SYNTAXCD,X'09'                                      0367 01221000
*                   ELSE                                           0368 01222000
*                     ;             /*                       @Y30DI3D*/ 01223000
@RF00366 DS    0H                                                  0369 01224000
*                 END;              /*                       @Y30DI3D*/ 01225000
*               ELSE                                               0370 01226000
*                 ;                 /*                       @Y30DI3D*/ 01227000
@RF00362 DS    0H                                                  0371 01228000
*             END;                  /*                       @Y30DI3D*/ 01229000
*           ELSE                                                   0372 01230000
*             SYNTAXCD=INVDELIM;    /*                       @Y30DI3D*/ 01231000
         B     @RC00359                                            0372 01232000
@RF00359 MVI   SYNTAXCD,X'02'                                      0372 01233000
*         END;                      /*                       @Y30DI3D*/ 01234000
*       ELSE                                                       0374 01235000
*         SYNTAXCD=INVDELIM;        /*                       @Y30DI3D*/ 01236000
         B     @RC00356                                            0374 01237000
@RF00356 MVI   SYNTAXCD,X'02'                                      0374 01238000
*     END;                          /*                       @Y30DI3D*/ 01239000
@RC00356 DS    0H                                                  0376 01240000
*                                                                  0376 01241000
*/********************************************************************/ 01242000
*/*                                                          @Y30DI3D*/ 01243000
*/*   THIS ROUTINE OBTAINS THE DATA REQUESTED FROM THE DUMP AND      */ 01244000
*/*   FORMATS THE PRINTED DUMP OUTPUT                        @Y30DI3D*/ 01245000
*/*                                                          @Y30DI3D*/ 01246000
*/********************************************************************/ 01247000
*                                                                  0376 01248000
*   IF SYNTAXCD=GOOD THEN                                          0376 01249000
@RF00348 CLI   SYNTAXCD,X'00'                                      0376 01250000
         BNE   @RF00376                                            0376 01251000
*     DO;                           /*                       @Y30DI3D*/ 01252000
*       LINE=0;                     /* INIT FOR HARDCOPY SAVE TABLE     01253000
*                                                            @Y30DI3D*/ 01254000
         SLR   @15,@15                                             0378 01255000
         ST    @15,LINE                                            0378 01256000
*       NOMORE=NO;                  /* INIT FOR LOOP CONTROL @Y30DI3D*/ 01257000
*       FRSTFAIL=NO;                /* FIRST BRREAD SUCCESSFUL     0380 01258000
*                                                            @Y30DI3D*/ 01259000
         NI    NOMORE,B'11100111'                                  0380 01260000
*       READEND=0;                  /* END OF UNSUCCESSFUL READS   0381 01261000
*                                                            @Y30DI3D*/ 01262000
         ST    @15,READEND                                         0381 01263000
*       CONTREAD=YES;               /* INIT FOR BRREAD LOOP  @Y30DI3D*/ 01264000
         OI    CONTREAD,B'00000100'                                0382 01265000
*       PREVREAD=GOOD;              /* INIT FOR BRREAD LOOP  @Y30DI3D*/ 01266000
         MVI   PREVREAD,X'00'                                      0383 01267000
*       READCTR=0;                  /* VALUE PRIOR TO FIRST BRREAD 0384 01268000
*                                                            @Y30DI3D*/ 01269000
         MVI   READCTR,X'00'                                       0384 01270000
*       PRINTOUT=YES;               /* ALL BRREADS NOT BAD, PRINT  0385 01271000
*                                      SOME DUMP                     */ 01272000
*       MSGSW=OFF;                  /* INIT FOR NO ERROR MSG IN DUMP    01273000
*                                                            @Y30DI3D*/ 01274000
         OI    PRINTOUT,B'00000001'                                0386 01275000
         NI    MSGSW,B'11111011'                                   0386 01276000
*       BUFFAREA=BLANK256;          /* CLEAR BUFFER AREA     @Y30DI3D*/ 01277000
         MVC   BUFFAREA(256),BLANK256                              0387 01278000
*       RESPECIFY                                                  0388 01279000
*         R13 RESTRICTED;           /*                       @Y30DI3D*/ 01280000
*       FDSSAVEA=R13;               /* SAVE AREA FOR ASYNC ROUTINES     01281000
*                                                            @Y30DI3D*/ 01282000
         ST    R13,FDSSAVEA                                        0389 01283000
*       RESPECIFY                                                  0390 01284000
*         R13 UNRESTRICTED;         /*                       @Y30DI3D*/ 01285000
*       ERRADDR=ADDR(FDSREAD);      /* ADDR OF FDS BRREAD ERROR    0391 01286000
*                                      ROUTINE                       */ 01287000
         LA    @00,FDSREAD                                         0391 01288000
         ST    @00,ERRADDR(,COMBASE)                               0391 01289000
*       THISLINE=LOADDR;            /* INIT FOR PRINTOUT LOOP CONTROL*/ 01290000
         L     @00,LOADDR                                          0392 01291000
         ST    @00,THISLINE                                        0392 01292000
*       BLOCKEND=HIADDR;            /* INIT FOR BRREAD LOOP  @Y30DI3D*/ 01293000
         MVC   BLOCKEND(4),HIADDR                                  0393 01294000
*       RESPECIFY                                                  0394 01295000
*         READADDR RESTRICTED;      /*                       @Y30DI3D*/ 01296000
*       READADDR=THISLINE&READMASK; /* ROUND TO 4-BYTE BOUNDARY      */ 01297000
         N     @00,READMASK                                        0395 01298000
         LR    READADDR,@00                                        0395 01299000
*       SAVEADDR=READADDR;          /* SAVE FIRST BRREAD ADDR FOR  0396 01300000
*                                      ERROR MSG                     */ 01301000
         ST    READADDR,SAVEADDR                                   0396 01302000
*       RESPECIFY                                                  0397 01303000
*        (R1,                                                      0397 01304000
*         R6) RESTRICTED;           /*                       @Y30DI3D*/ 01305000
*       R6=THISASID;                /* GET CURRENT ASID FOR BRREAD 0398 01306000
*                                                            @Y30DI3D*/ 01307000
         SLR   R6,R6                                               0398 01308000
         ICM   R6,3,THISASID                                       0398 01309000
*       BUFFPTR=ADDR(BUFFAREA);     /* INIT BUFFER POINTER   @Y30DI3D*/ 01310000
         LA    BUFFPTR,BUFFAREA                                    0399 01311000
*                                                                  0400 01312000
*       /*************************************************************/ 01313000
*       /*                                                           */ 01314000
*       /* READ 4 BYTES AT A TIME                            @Y30DI3D*/ 01315000
*       /*                                                           */ 01316000
*       /*************************************************************/ 01317000
*                                                                  0400 01318000
*       DO READADDR=READADDR TO BLOCKEND-1 BY 4 WHILE CONTREAD=YES;     01319000
         B     @DE00400                                            0400 01320000
@DL00400 TM    CONTREAD,B'00000100'                                0400 01321000
         BNO   @DC00400                                            0400 01322000
*         GEN REFS(READADDR,BRRDDATA) FLOWS(FDSREAD)               0401 01323000
*             (BRREAD (READADDR),DATA,ASID=(6));/*           @Y30DI3D*/ 01324000
         BRREAD (READADDR),DATA,ASID=(6)                                01325000
*         BUFFADDR=R1;              /* ADDRESS RETURNED BY BRREAD  0402 01326000
*                                                            @Y30DI3D*/ 01327000
         ST    R1,BUFFADDR                                         0402 01328000
*         IF PREVREAD=NOTGOOD THEN                                 0403 01329000
         CLI   PREVREAD,X'01'                                      0403 01330000
         BNE   @RF00403                                            0403 01331000
*           DO;                     /*                       @Y30DI3D*/ 01332000
*             READEND=READADDR-1;   /* END OF BAD READ BLOCK         */ 01333000
         LR    @07,READADDR                                        0405 01334000
         BCTR  @07,0                                               0405 01335000
         ST    @07,READEND                                         0405 01336000
*             THISLINE=READADDR;    /* RE-INIT FOR 1ST GOOD BRREAD   */ 01337000
         ST    READADDR,THISLINE                                   0406 01338000
*             PREVREAD=GOOD;        /* RE-INIT FOR OTHER BRREADS     */ 01339000
         MVI   PREVREAD,X'00'                                      0407 01340000
*           END;                    /*                       @Y30DI3D*/ 01341000
*         MVC(BUFFER2,BUFFER1);     /* PUT STORAGE INTO BUFFAREA     */ 01342000
@RF00403 L     @07,BUFFADDR                                        0409 01343000
         MVC   BUFFER2(4,BUFFPTR),BUFFER1(@07)                     0409 01344000
*         BUFFPTR=BUFFPTR+4;        /* NEXT POSITION IN BUFFAREA     */ 01345000
         AL    BUFFPTR,@CF00157                                    0410 01346000
*         READCTR=1;                /* FIRST BRREAD WAS EXECUTED     */ 01347000
         MVI   READCTR,X'01'                                       0411 01348000
*BRREND:                                                           0412 01349000
*       END;                        /* END OF BRREAD LOOP    @Y30DI3D*/ 01350000
BRREND   AL    READADDR,@CF00157                                   0412 01351000
@DE00400 L     @07,BLOCKEND                                        0412 01352000
         BCTR  @07,0                                               0412 01353000
         CR    READADDR,@07                                        0412 01354000
         BNH   @DL00400                                            0412 01355000
@DC00400 DS    0H                                                  0413 01356000
*       IF FRSTFAIL=YES&READEND=0 THEN/* ALL BRREADS FAILED          */ 01357000
         TM    FRSTFAIL,B'00001000'                                0413 01358000
         BNO   @RF00413                                            0413 01359000
         ICM   @07,15,READEND                                      0413 01360000
         BNZ   @RF00413                                            0413 01361000
*         PRINTOUT=NO;              /* NO DUMP IN OUTPUT     @Y30DI3D*/ 01362000
         NI    PRINTOUT,B'11111110'                                0414 01363000
*       IF PRINTOUT=YES THEN        /* FORMAT AND PRINT OUTPUT       */ 01364000
@RF00413 TM    PRINTOUT,B'00000001'                                0415 01365000
         BNO   @RF00415                                            0415 01366000
*         DO;                       /*                       @Y30DI3D*/ 01367000
*           IF CONTREAD=YES THEN    /* LAST BRREAD WAS GOOD  @Y30DI3D*/ 01368000
         TM    CONTREAD,B'00000100'                                0417 01369000
         BNO   @RF00417                                            0417 01370000
*             BUFFEND=HIADDR;       /*                       @Y30DI3D*/ 01371000
         MVC   BUFFEND(4),HIADDR                                   0418 01372000
*           ELSE                                                   0419 01373000
*             BUFFEND=FAILADDR;     /* LAST BRREAD WAS BAD   @Y30DI3D   01374000
*                                                            @Y30DI3D*/ 01375000
         B     @RC00417                                            0419 01376000
@RF00417 MVC   BUFFEND(4),FAILADDR                                 0419 01377000
*           THISOFST=THISLINE-SAVEADDR;/* OFFSET INTO BUFFER OF    0420 01378000
*                                      OUTPUT STARTING ADDRESS       */ 01379000
@RC00417 L     @07,THISLINE                                        0420 01380000
         LR    @03,@07                                             0420 01381000
         SL    @03,SAVEADDR                                        0420 01382000
         ST    @03,THISOFST                                        0420 01383000
*           INLINE=ADDR(BUFFAREA);  /*                       @Y30DI3D*/ 01384000
         LA    INLINE,BUFFAREA                                     0421 01385000
*           LOBYTE=THISLINE;        /* INIT FOR LOOP CONTROL         */ 01386000
         ST    @07,LOBYTE                                          0422 01387000
*           HIBYTE=BUFFEND;         /* INIT FOR LOOP CONTROL         */ 01388000
         MVC   HIBYTE(4),BUFFEND                                   0423 01389000
*           DATAPTR=ADDR(INDATA);   /* ADDRESS OF DATA LINE  @Y30DI3D*/ 01390000
         ALR   @03,INLINE                                          0424 01391000
         ST    @03,DATAPTR                                         0424 01392000
*           DO THISLINE=THISLINE TO BUFFEND-1 BY LINELGT;/*  @Y30DI3D*/ 01393000
         B     @DE00425                                            0425 01394000
@DL00425 DS    0H                                                  0426 01395000
*             DATAREA=BLANK80;      /* CLEAR OUTPUT BUFFER   @Y30DI3D*/ 01396000
         L     @07,OUTBUFAD                                        0426 01397000
         MVC   DATAREA(80,@07),BLANK80                             0426 01398000
*             UNPK(DATAREA(1:7),ADDR1(2:5));/* CONVERT TO HEX        */ 01399000
         UNPK  DATAREA(7,@07),ADDR1+1(4)                           0427 01400000
*             DATAREA(7)=BLANK1;    /* PUT 1 BLANK AFTER ADDRESS     */ 01401000
         MVI   DATAREA+6(@07),C' '                                 0428 01402000
*             TR(ADDRESS,EBCTABL);  /* TRANSLATE ADDRESS     @Y30DI3D*/ 01403000
         TR    ADDRESS(6,@07),EBCTABL(COMBASE)                     0429 01404000
*             FIELDPTR=ADDR(FIELD1);/* BUFFER LOCATION       @Y30DI3D*/ 01405000
         LA    FIELDPTR,FIELD1(,@07)                               0430 01406000
*             DO HALF=1 TO 2 WHILE NOMORE=NO;/*              @Y30DI3D*/ 01407000
         LA    @07,1                                               0431 01408000
         ST    @07,HALF                                            0431 01409000
@DL00431 TM    NOMORE,B'00010000'                                  0431 01410000
         BNZ   @DC00431                                            0431 01411000
*               DO WORD=1 TO 4 WHILE LOBYTE<HIBYTE;/*        @Y30DI3D*/ 01412000
         LA    @07,1                                               0432 01413000
         ST    @07,WORD                                            0432 01414000
@DL00432 L     @07,LOBYTE                                          0432 01415000
         L     @03,HIBYTE                                          0432 01416000
         CR    @07,@03                                             0432 01417000
         BNL   @DC00432                                            0432 01418000
*                 UNPK(FLDWORK,DATAWORK);/* ONE WORD OF STORAGE      */ 01419000
         L     @15,DATAPTR                                         0433 01420000
         UNPK  FLDWORK(9,FIELDPTR),DATAWORK(5,@15)                 0433 01421000
*                 FLDWORK(9)=BLANK1;/* BLANK BETWEEN WORDS           */ 01422000
         MVI   FLDWORK+8(FIELDPTR),C' '                            0434 01423000
*                 TR(FLDWORK(1:8),EBCTABL);/* TRANSLATE STORAGE      */ 01424000
         TR    FLDWORK(8,FIELDPTR),EBCTABL(COMBASE)                0435 01425000
*                 LOBYTE=LOBYTE+4;  /* INCR LOBYTE FOR NEXT WORD     */ 01426000
         LA    @15,4                                               0436 01427000
         ALR   @07,@15                                             0436 01428000
         ST    @07,LOBYTE                                          0436 01429000
*                 IF LOBYTE^<HIBYTE THEN                           0437 01430000
         CR    @07,@03                                             0437 01431000
         BL    @RF00437                                            0437 01432000
*                   IF LOBYTE>HIBYTE THEN/* CLEAR REST OF WORD       */ 01433000
         CR    @07,@03                                             0438 01434000
         BNH   @RF00438                                            0438 01435000
*                     DO;           /*                       @Y30DI3D*/ 01436000
*                       BLANKPTR=LOBYTE-4;/*                 @Y30DI3D*/ 01437000
         SLR   @07,@15                                             0440 01438000
         ST    @07,BLANKPTR                                        0440 01439000
*                       BYTEOFST=2*(HIBYTE-BLANKPTR);/*      @Y30DI3D*/ 01440000
         SLR   @03,@07                                             0441 01441000
         ALR   @03,@03                                             0441 01442000
         ST    @03,BYTEOFST                                        0441 01443000
*                       FLDWORK((BYTEOFST+1):8)=BLANK8((BYTEOFST+1):8); 01444000
         ALR   @03,FIELDPTR                                        0442 01445000
         L     @07,BYTEOFST                                        0442 01446000
         LA    @15,7                                               0442 01447000
         SLR   @15,@07                                             0442 01448000
         LA    @14,BLANK8(@07)                                     0442 01449000
         EX    @15,@SM00776                                        0442 01450000
*                       NOMORE=YES; /* END OF DUMP           @Y30DI3D*/ 01451000
         OI    NOMORE,B'00010000'                                  0443 01452000
*                     END;          /*                       @Y30DI3D*/ 01453000
*                   ELSE            /* NO BYTES TO CLEAR     @Y30DI3D*/ 01454000
*                     NOMORE=YES;   /* END OF DUMP           @Y30DI3D*/ 01455000
         B     @RC00438                                            0445 01456000
@RF00438 OI    NOMORE,B'00010000'                                  0445 01457000
*                 ELSE                                             0446 01458000
*                   ;               /*                       @Y30DI3D*/ 01459000
@RF00437 DS    0H                                                  0447 01460000
*                 FIELDPTR=FIELDPTR+LENGTH(FLDWORK);/*       @Y30DI3D*/ 01461000
@RC00437 AH    FIELDPTR,@CH00172                                   0447 01462000
*                 DATAPTR=DATAPTR+4;/* NEXT WORD OF STORAGE          */ 01463000
         LA    @07,4                                               0448 01464000
         AL    @07,DATAPTR                                         0448 01465000
         ST    @07,DATAPTR                                         0448 01466000
*               END;                /*                       @Y30DI3D*/ 01467000
         LA    @07,1                                               0449 01468000
         AL    @07,WORD                                            0449 01469000
         ST    @07,WORD                                            0449 01470000
         CH    @07,@CH00157                                        0449 01471000
         BNH   @DL00432                                            0449 01472000
@DC00432 DS    0H                                                  0450 01473000
*               FIELDPTR=ADDR(FIELD2);/*                     @Y30DI3D*/ 01474000
         L     FIELDPTR,OUTBUFAD                                   0450 01475000
         LA    FIELDPTR,FIELD2(,FIELDPTR)                          0450 01476000
*             END;                  /*                       @Y30DI3D*/ 01477000
         LA    @07,1                                               0451 01478000
         AL    @07,HALF                                            0451 01479000
         ST    @07,HALF                                            0451 01480000
         CH    @07,@CH00165                                        0451 01481000
         BNH   @DL00431                                            0451 01482000
@DC00431 DS    0H                                                  0452 01483000
*             LINE=LINE+1;          /*                       @Y30DI3D*/ 01484000
         LA    @07,1                                               0452 01485000
         AL    @07,LINE                                            0452 01486000
         ST    @07,LINE                                            0452 01487000
*             HCOPYBUF(LINE)=DATAREA;/* SAVE FOR HARDCOPY            */ 01488000
         MH    @07,@CH00382                                        0453 01489000
         LA    @05,HCOPYBUF-80(@07)                                0453 01490000
         L     @07,OUTBUFAD                                        0453 01491000
         MVC   0(80,@05),DATAREA(@07)                              0453 01492000
*             DMPMSG03=DATAREA;     /* FOR CONSOLE OUTPUT    @Y30DI3D*/ 01493000
         MVC   DMPMSG03(80),DATAREA(@07)                           0454 01494000
*             MSGADDR=ADDR(DATAREA);/* FOR TERMINAL OUTPUT   @Y30DI3D*/ 01495000
         LA    MSGADDR,DATAREA(,@07)                               0455 01496000
*             CALL WRITRTN;         /* WRITE DUMP TO APPROPRIATE   0456 01497000
*                                      OUTPUT DEVICE                 */ 01498000
         BAL   @14,WRITRTN                                         0456 01499000
*             IF HCOPYON=ON THEN    /* WRITE LINE TO PRINTER         */ 01500000
         TM    HCOPYON,B'10000000'                                 0457 01501000
         BNO   @RF00457                                            0457 01502000
*               GEN REFS(AWRITE)(BRWRITE 1);/*               @Y30DI3D*/ 01503000
         BRWRITE 1                                                      01504000
*           END;                    /*                       @Y30DI3D*/ 01505000
@RF00457 LA    @07,32                                              0459 01506000
         AL    @07,THISLINE                                        0459 01507000
         ST    @07,THISLINE                                        0459 01508000
@DE00425 L     @05,BUFFEND                                         0459 01509000
         BCTR  @05,0                                               0459 01510000
         CR    @07,@05                                             0459 01511000
         BNH   @DL00425                                            0459 01512000
*         END;                      /*                       @Y30DI3D*/ 01513000
*       IF MSGSW=ON THEN            /* PRINT ERROR MESSAGE IN DUMP 0461 01514000
*                                                            @Y30DI3D*/ 01515000
@RF00415 TM    MSGSW,B'00000100'                                   0461 01516000
         BNO   @RF00461                                            0461 01517000
*         CALL BRMSGRTN;            /* PRINT BRREAD ERROR MESSAGE  0462 01518000
*                                                            @Y30DI3D*/ 01519000
         BAL   @14,BRMSGRTN                                        0462 01520000
*       RESPECIFY                                                  0463 01521000
*         READADDR UNRESTRICTED;    /*                       @Y30DI3D*/ 01522000
@RF00461 DS    0H                                                  0464 01523000
*     END;                          /*                       @Y30DI3D*/ 01524000
*   DMPMSG03=BLANK80;               /* SKIP LINE ON CONSOLE  @Y30DI3D*/ 01525000
@RF00376 MVC   DMPMSG03(80),BLANK80                                0465 01526000
*   MSGADDR=ADDR(BLANK80);          /* SKIP LINE ON TERMINAL @Y30DI3D*/ 01527000
         LA    MSGADDR,BLANK80                                     0466 01528000
*   CALL WRITRTN;                   /*                       @Y30DI3D*/ 01529000
         BAL   @14,WRITRTN                                         0467 01530000
*   IF HCOPYON=ON THEN                                             0468 01531000
         TM    HCOPYON,B'10000000'                                 0468 01532000
         BNO   @RF00468                                            0468 01533000
*     DO;                           /*                       @Y30DI3D*/ 01534000
*       DATAREA=BLANK80;            /*                       @Y30DI3D*/ 01535000
         L     @07,OUTBUFAD                                        0470 01536000
         MVC   DATAREA(80,@07),BLANK80                             0470 01537000
*       GEN REFS(AWRITE)(BRWRITE 1);/* SKIP LINE             @Y30DI3D*/ 01538000
         BRWRITE 1                                                      01539000
*     END;                          /*                       @Y30DI3D*/ 01540000
*   GOTO ENDSTOR;                   /*                       @Y30DI3D*/ 01541000
         B     ENDSTOR                                             0473 01542000
*FDSREAD:                           /* BRREAD ERROR ROUTINE  @Y30DI3D*/ 01543000
*   GEN REFS(FDSSAVEA,@PSTART);                                    0474 01544000
FDSREAD  DS    0H                                                  0474 01545000
*                                                          /*@Y30DI3D*/ 01546000
         DROP  R10                                             @Y30DI3D 01547000
         USING *,R15         SET UP ADDRESSABILITY             @Y30DI3D 01548000
         L     R13,FDSSAVEA                                    @Y30DI3D 01549000
         LM    R14,R12,12(R13)                                 @Y30DI3D 01550000
         DROP  R15                                             @Y30DI3D 01551000
         USING @PSTART+4095,R10                                @Y30DI3D 01552000
*   MSGSW=ON;                       /* TURN ON SWITCH TO WRITE     0475 01553000
*                                      MESSAGE               @Y30DI3D*/ 01554000
         OI    MSGSW,B'00000100'                                   0475 01555000
*   PREVREAD=NOTGOOD;               /*                       @Y30DI3D*/ 01556000
         MVI   PREVREAD,X'01'                                      0476 01557000
*   IF READCTR=0 THEN               /* FIRST BRREAD FAILED   @Y30DI3D*/ 01558000
         CLI   READCTR,0                                           0477 01559000
         BNE   @RF00477                                            0477 01560000
*     FRSTFAIL=YES;                 /*                       @Y30DI3D*/ 01561000
         OI    FRSTFAIL,B'00001000'                                0478 01562000
*   ELSE                            /* ALL REMAINING BRREADS WILL BE    01563000
*                                      BAD                           */ 01564000
*     DO;                           /*                       @Y30DI3D*/ 01565000
         B     @RC00477                                            0479 01566000
@RF00477 DS    0H                                                  0480 01567000
*       CONTREAD=NO;                /* DROP OUT OF BRREAD LOOP     0480 01568000
*                                                            @Y30DI3D*/ 01569000
         NI    CONTREAD,B'11111011'                                0480 01570000
*       RESPECIFY                                                  0481 01571000
*         READADDR RESTRICTED;      /*                       @Y30DI3D*/ 01572000
*       FAILADDR=READADDR;          /* FIRST FAILING ADDRESS @Y30DI3D*/ 01573000
         ST    READADDR,FAILADDR                                   0482 01574000
*       RESPECIFY                                                  0483 01575000
*         READADDR UNRESTRICTED;    /*                       @Y30DI3D*/ 01576000
*     END;                          /*                       @Y30DI3D*/ 01577000
*   BUFFPTR=BUFFPTR+4;              /*                       @Y30DI3D*/ 01578000
@RC00477 AL    BUFFPTR,@CF00157                                    0485 01579000
*   GOTO BRREND;                    /*                       @Y30DI3D*/ 01580000
         B     BRREND                                              0486 01581000
*LISTEOF:                                                          0487 01582000
*   SYNTAXCD=NOPARMS;               /* NO LIST OPERANDS      @Y30DI3D*/ 01583000
LISTEOF  MVI   SYNTAXCD,X'03'                                      0487 01584000
*ENDSTOR:                                                          0488 01585000
*   END STORTN;                     /*                       @Y30DI3D*/ 01586000
@EL00005 DS    0H                                                  0488 01587000
@EF00005 DS    0H                                                  0488 01588000
@ER00005 LM    @14,@12,@SA00005                                    0488 01589000
         BR    @14                                                 0488 01590000
*                                                                  0489 01591000
*/********************************************************************/ 01592000
*/*                                                          @Y30DI3D*/ 01593000
*/* THIS ROUTINE PRINTS THE BRREAD ERROR MESSAGE             @Y30DI3D*/ 01594000
*/*                                                          @Y30DI3D*/ 01595000
*/********************************************************************/ 01596000
*                                                                  0489 01597000
*BRMSGRTN:                                                         0489 01598000
*   PROCEDURE;                      /*                       @Y30DI3D*/ 01599000
BRMSGRTN STM   @14,@12,@SA00006                                    0489 01600000
*   MSGAREA=BLANK80;                /* CLEAR MESSAGE BUFFER  @Y30DI3D*/ 01601000
         L     @07,OUTBUFAD                                        0490 01602000
         MVC   MSGAREA(80,@07),BLANK80                             0490 01603000
*   IF CONTREAD=YES THEN                                           0491 01604000
         TM    CONTREAD,B'00000100'                                0491 01605000
         BNO   @RF00491                                            0491 01606000
*     MSGADDR1=LOADDR;              /* BAD ADDRESS WAS LOW ADDRESS 0492 01607000
*                                                            @Y30DI3D*/ 01608000
         MVC   MSGADDR1(4),LOADDR                                  0492 01609000
*   ELSE                                                           0493 01610000
*     MSGADDR1=FAILADDR;            /* BAD ADDRESS WAS AFTER LOW   0493 01611000
*                                      ADDRESS                       */ 01612000
         B     @RC00491                                            0493 01613000
@RF00491 MVC   MSGADDR1(4),FAILADDR                                0493 01614000
*   IF READEND=0 THEN                                              0494 01615000
@RC00491 ICM   @07,15,READEND                                      0494 01616000
         BNZ   @RF00494                                            0494 01617000
*     MSGADDR2=HIADDR;              /* BAD BRREADS AT END OF REQUEST */ 01618000
         MVC   MSGADDR2(4),HIADDR                                  0495 01619000
*   ELSE                                                           0496 01620000
*     MSGADDR2=READEND;             /* GOOD BRREAD AFTER FAILURES    */ 01621000
         B     @RC00494                                            0496 01622000
@RF00494 MVC   MSGADDR2(4),READEND                                 0496 01623000
*   UNPK(DATAREA(1:7),ADDR2(2:5));  /* FIRST FAILING ADDRESS         */ 01624000
@RC00494 L     @07,OUTBUFAD                                        0497 01625000
         UNPK  DATAREA(7,@07),ADDR2+1(4)                           0497 01626000
*   MSGAREA(7:14)=THRU;             /*                       @Y30DI3D*/ 01627000
         MVC   MSGAREA+6(8,@07),THRU                               0498 01628000
*   TR(ADDRESS,EBCTABL);            /*                       @Y30DI3D*/ 01629000
         TR    ADDRESS(6,@07),EBCTABL(COMBASE)                     0499 01630000
*   UNPK(MSGAREA(16:22),ADDR3(2:5));/* END OF BAD ADDR RANGE         */ 01631000
         UNPK  MSGAREA+15(7,@07),ADDR3+1(4)                        0500 01632000
*   MSGAREA(22:42)=REMNMSG;         /* REMAINDER OF MESSAGE          */ 01633000
         MVC   MSGAREA+21(21,@07),REMNMSG                          0501 01634000
*   TR(MSGAREA(16:21),EBCTABL);     /*                       @Y30DI3D*/ 01635000
         TR    MSGAREA+15(6,@07),EBCTABL(COMBASE)                  0502 01636000
*   LINE=LINE+1;                    /*                       @Y30DI3D*/ 01637000
         LA    @05,1                                               0503 01638000
         AL    @05,LINE                                            0503 01639000
         ST    @05,LINE                                            0503 01640000
*   HCOPYBUF(LINE)=MSGAREA;         /* SAVE FOR HARDCOPY             */ 01641000
         MH    @05,@CH00382                                        0504 01642000
         LA    @15,HCOPYBUF-80(@05)                                0504 01643000
         MVC   0(80,@15),MSGAREA(@07)                              0504 01644000
*   DMPMSG03=MSGAREA;               /* FOR CONSOLE OUTPUT            */ 01645000
         MVC   DMPMSG03(80),MSGAREA(@07)                           0505 01646000
*   MSGADDR=ADDR(MSGAREA);          /* FOR TERMINAL OUTPUT           */ 01647000
         LA    MSGADDR,MSGAREA(,@07)                               0506 01648000
*   CALL WRITRTN;                   /* WRITE MESSAGE TO APPROPRIATE     01649000
*                                      OUTPUT DEVICE                 */ 01650000
         BAL   @14,WRITRTN                                         0507 01651000
*   IF HCOPYON=ON THEN              /* WRITE MESSAGE TO PRINTER    0508 01652000
*                                                            @Y30DI3D*/ 01653000
         TM    HCOPYON,B'10000000'                                 0508 01654000
         BNO   @RF00508                                            0508 01655000
*     GEN REFS(AWRITE)(BRWRITE 1);  /*                       @Y30DI3D*/ 01656000
         BRWRITE 1                                                      01657000
*   END BRMSGRTN;                   /*                       @Y30DI3D*/ 01658000
@EL00006 DS    0H                                                  0510 01659000
@EF00006 DS    0H                                                  0510 01660000
@ER00006 LM    @14,@12,@SA00006                                    0510 01661000
         BR    @14                                                 0510 01662000
*                                                                  0511 01663000
*/********************************************************************/ 01664000
*/*                                                          @Y30DI3D*/ 01665000
*/* THIS ROUTINE EQUATES AN ADDRESS TO A NAME                @Y30DI3D*/ 01666000
*/*                                                          @Y30DI3D*/ 01667000
*/********************************************************************/ 01668000
*                                                                  0511 01669000
*EQUATRTN:                                                         0511 01670000
*   PROCEDURE;                      /*                       @Y30DI3D*/ 01671000
EQUATRTN STM   @14,@12,@SA00007                                    0511 01672000
*   RESPECIFY                                                      0512 01673000
*     R1 RESTRICTED;                /*                       @Y30DI3D*/ 01674000
*   IF I>256 THEN                   /* NO MORE EQUATES       @Y30DI3D*/ 01675000
         L     @07,I                                               0513 01676000
         CH    @07,@CH00174                                        0513 01677000
         BNH   @RF00513                                            0513 01678000
*     DO;                           /*                       @Y30DI3D*/ 01679000
*       MSGHOLD=BLANK80;            /* CLEAR MESSAGE BUFFER          */ 01680000
         MVC   MSGHOLD(80),BLANK80                                 0515 01681000
*       MSGHOLD(1:29)=NOMOREQ;      /*                       @Y30DI3D*/ 01682000
         MVC   MSGHOLD(29),NOMOREQ                                 0516 01683000
*       DMPMSG03=MSGHOLD;           /* FOR CONSOLE OUTPUT            */ 01684000
         MVC   DMPMSG03(80),MSGHOLD                                0517 01685000
*       MSGADDR=ADDR(MSGHOLD);      /* FOR TERMINAL OUTPUT           */ 01686000
         LA    MSGADDR,MSGHOLD                                     0518 01687000
*       CALL WRITRTN;               /*                       @Y30DI3D*/ 01688000
         BAL   @14,WRITRTN                                         0519 01689000
*       GOTO ENDEQUAT;              /*                       @Y30DI3D*/ 01690000
         B     ENDEQUAT                                            0520 01691000
*     END;                          /*                       @Y30DI3D*/ 01692000
*   THISNAME=BLANK8;                /* CLEAR TEMPORARY NAME BUFFER 0522 01693000
*                                                            @Y30DI3D*/ 01694000
@RF00513 MVC   THISNAME(8),BLANK8                                  0522 01695000
*   DUPLNAME=NO;                    /* INIT FOR DUPLICATE NAME SCAN  */ 01696000
         NI    DUPLNAME,B'11111110'                                0523 01697000
*   VERBGN=VERBEND+1;               /* POSITION AFTER VERB   @Y30DI3D*/ 01698000
         LA    @07,1                                               0524 01699000
         AL    @07,VERBEND(,COMBASE)                               0524 01700000
         ST    @07,VERBGN(,COMBASE)                                0524 01701000
*   WTORSIZE=SAVEWTOR-VERBGN;       /* REMAINING BUFFER AREA @Y30DI3D*/ 01702000
         LCR   @07,@07                                             0525 01703000
         AL    @07,SAVEWTOR                                        0525 01704000
         ST    @07,WTORSIZE                                        0525 01705000
*   TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR NEXT NON BLANK      */ 01706000
         L     @03,VERBGN(,COMBASE)                                0526 01707000
         L     @07,WTORSIZE                                        0526 01708000
         BCTR  @07,0                                               0526 01709000
         EX    @07,@SB00761                                        0526 01710000
*   BC(8,EQEOF);                    /* NO PARMS              @Y30DI3D*/ 01711000
         BC    8,EQEOF                                             0527 01712000
*   VERBEND=R1-1;                   /* INIT FOR DLIMSCAN     @Y30DI3D*/ 01713000
         LR    @07,R1                                              0528 01714000
         BCTR  @07,0                                               0528 01715000
         ST    @07,VERBEND(,COMBASE)                               0528 01716000
*   CALL DLIMSCAN;                  /*                       @Y30DI3D*/ 01717000
         BAL   @14,DLIMSCAN                                        0529 01718000
*   THISNAME=OPERAND(1:OPSIZE);     /* SAVE NAME             @Y30DI3D*/ 01719000
         MVI   THISNAME+1,C' '                                     0530 01720000
         MVC   THISNAME+2(6),THISNAME+1                            0530 01721000
         LR    @07,OPSIZE                                          0530 01722000
         BCTR  @07,0                                               0530 01723000
         L     @15,VERBGN(,COMBASE)                                0530 01724000
         EX    @07,@SM00780                                        0530 01725000
*   IF DELIMCD=BLANK THEN           /* SCAN FOR VALID NAME   @Y30DI3D*/ 01726000
         CLC   DELIMCD(4,COMBASE),@CF00242                         0531 01727000
         BNE   @RF00531                                            0531 01728000
*     IF I>1 THEN                   /* SCAN NAME TABLE FOR DUPLICATE    01729000
*                                      NAME                          */ 01730000
         LA    @07,1                                               0532 01731000
         C     @07,I                                               0532 01732000
         BNL   @RF00532                                            0532 01733000
*       DO E=1 TO(I-1) WHILE DUPLNAME=NO;/*                  @Y30DI3D*/ 01734000
         B     @DE00533                                            0533 01735000
@DL00533 TM    DUPLNAME,B'00000001'                                0533 01736000
         BNZ   @DC00533                                            0533 01737000
*         IF THISNAME=NAMES(E) THEN                                0534 01738000
         SLA   @07,3                                               0534 01739000
         LA    @15,NAMES-8(@07)                                    0534 01740000
         CLC   THISNAME(8),0(@15)                                  0534 01741000
         BNE   @RF00534                                            0534 01742000
*           DUPLNAME=YES;           /* MATCH FOUND           @Y30DI3D*/ 01743000
         OI    DUPLNAME,B'00000001'                                0535 01744000
*         ELSE                                                     0536 01745000
*           ;                       /*                       @Y30DI3D*/ 01746000
@RF00534 DS    0H                                                  0537 01747000
*       END;                        /*                       @Y30DI3D*/ 01748000
         LA    @07,1                                               0537 01749000
         AL    @07,E                                               0537 01750000
@DE00533 ST    @07,E                                               0537 01751000
         L     @00,I                                               0537 01752000
         BCTR  @00,0                                               0537 01753000
         CR    @07,@00                                             0537 01754000
         BNH   @DL00533                                            0537 01755000
@DC00533 DS    0H                                                  0538 01756000
*     ELSE                                                         0538 01757000
*       ;                           /*                       @Y30DI3D*/ 01758000
@RF00532 DS    0H                                                  0539 01759000
*   ELSE                                                           0539 01760000
*     SYNTAXCD=INVDELIM;            /* INVALID DELIMETER AFTER NAME  */ 01761000
         B     @RC00531                                            0539 01762000
@RF00531 MVI   SYNTAXCD,X'02'                                      0539 01763000
*   IF SYNTAXCD=GOOD&DUPLNAME=NO THEN/* UNUSED NAME                  */ 01764000
@RC00531 CLI   SYNTAXCD,X'00'                                      0540 01765000
         BNE   @RF00540                                            0540 01766000
         TM    DUPLNAME,B'00000001'                                0540 01767000
         BNZ   @RF00540                                            0540 01768000
*     IF OPSIZE>0&OPSIZE<9 THEN     /* SCAN FOR DIGITS       @Y30DI3D*/ 01769000
         LTR   OPSIZE,OPSIZE                                       0541 01770000
         BNP   @RF00541                                            0541 01771000
         CH    OPSIZE,@CH00172                                     0541 01772000
         BNL   @RF00541                                            0541 01773000
*       DO N=1 TO OPSIZE WHILE SYNTAXCD=GOOD;/*              @Y30DI3D*/ 01774000
         LA    @07,1                                               0542 01775000
         B     @DE00542                                            0542 01776000
@DL00542 CLI   SYNTAXCD,X'00'                                      0542 01777000
         BNE   @DC00542                                            0542 01778000
*         IF OPERAND(N)>='A'&OPERAND(N)<='I'|OPERAND(N)>='J'&OPERAND(N) 01779000
*             <='R'|OPERAND(N)>='S'&OPERAND(N)<='Z'|OPERAND(N)>='0'&    01780000
*             OPERAND(N)<='9' THEN                                 0543 01781000
         L     @15,VERBGN(,COMBASE)                                0543 01782000
         ALR   @07,@15                                             0543 01783000
         BCTR  @07,0                                               0543 01784000
         CLI   OPERAND(@07),C'A'                                   0543 01785000
         BL    @GL00046                                            0543 01786000
         L     @07,N                                               0543 01787000
         ALR   @15,@07                                             0543 01788000
         BCTR  @15,0                                               0543 01789000
         CLI   OPERAND(@15),C'I'                                   0543 01790000
         BNH   @RT00543                                            0543 01791000
@GL00046 L     @07,N                                               0543 01792000
         L     @15,VERBGN(,COMBASE)                                0543 01793000
         ALR   @07,@15                                             0543 01794000
         BCTR  @07,0                                               0543 01795000
         CLI   OPERAND(@07),C'J'                                   0543 01796000
         BL    @GL00045                                            0543 01797000
         L     @07,N                                               0543 01798000
         ALR   @15,@07                                             0543 01799000
         BCTR  @15,0                                               0543 01800000
         CLI   OPERAND(@15),C'R'                                   0543 01801000
         BNH   @RT00543                                            0543 01802000
@GL00045 L     @07,N                                               0543 01803000
         L     @15,VERBGN(,COMBASE)                                0543 01804000
         ALR   @07,@15                                             0543 01805000
         BCTR  @07,0                                               0543 01806000
         CLI   OPERAND(@07),C'S'                                   0543 01807000
         BL    @GL00044                                            0543 01808000
         L     @07,N                                               0543 01809000
         ALR   @15,@07                                             0543 01810000
         BCTR  @15,0                                               0543 01811000
         CLI   OPERAND(@15),C'Z'                                   0543 01812000
         BNH   @RT00543                                            0543 01813000
@GL00044 L     @07,N                                               0543 01814000
         L     @15,VERBGN(,COMBASE)                                0543 01815000
         ALR   @07,@15                                             0543 01816000
         BCTR  @07,0                                               0543 01817000
         CLI   OPERAND(@07),C'0'                                   0543 01818000
         BL    @RF00543                                            0543 01819000
         L     @07,N                                               0543 01820000
         ALR   @15,@07                                             0543 01821000
         BCTR  @15,0                                               0543 01822000
         CLI   OPERAND(@15),C'9'                                   0543 01823000
         BNH   @RT00543                                            0543 01824000
*           ;                       /*                       @Y30DI3D*/ 01825000
*         ELSE                                                     0545 01826000
*           SYNTAXCD=INVNAME;       /* NAME NOT ALPHAMERIC   @Y30DI3D*/ 01827000
@RF00543 MVI   SYNTAXCD,X'04'                                      0545 01828000
*       END;                        /*                       @Y30DI3D*/ 01829000
@RT00543 LA    @07,1                                               0546 01830000
         AL    @07,N                                               0546 01831000
@DE00542 ST    @07,N                                               0546 01832000
         CR    @07,OPSIZE                                          0546 01833000
         BNH   @DL00542                                            0546 01834000
@DC00542 DS    0H                                                  0547 01835000
*     ELSE                          /* INVALID LENGTH ON NAME      0547 01836000
*                                                            @Y30DI3D*/ 01837000
*       SYNTAXCD=INVNAME;           /*                       @Y30DI3D*/ 01838000
         B     @RC00541                                            0547 01839000
@RF00541 MVI   SYNTAXCD,X'04'                                      0547 01840000
*   IF SYNTAXCD=GOOD THEN           /* SCAN FOR ADDRESS      @Y30DI3D*/ 01841000
@RC00541 DS    0H                                                  0548 01842000
@RF00540 CLI   SYNTAXCD,X'00'                                      0548 01843000
         BNE   @RF00548                                            0548 01844000
*     DO;                           /*                       @Y30DI3D*/ 01845000
*       VERBGN=VERBEND+1;           /* POSITION AFTER NAME   @Y30DI3D*/ 01846000
         LA    @07,1                                               0550 01847000
         AL    @07,VERBEND(,COMBASE)                               0550 01848000
         ST    @07,VERBGN(,COMBASE)                                0550 01849000
*       WTORSIZE=SAVEWTOR-VERBGN;   /* REMAINING BUFFER AREA @Y30DI3D*/ 01850000
         LCR   @07,@07                                             0551 01851000
         AL    @07,SAVEWTOR                                        0551 01852000
         ST    @07,WTORSIZE                                        0551 01853000
*       TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SCAN FOR NEXT NONBLANK   */ 01854000
         L     @03,VERBGN(,COMBASE)                                0552 01855000
         L     @07,WTORSIZE                                        0552 01856000
         BCTR  @07,0                                               0552 01857000
         EX    @07,@SB00761                                        0552 01858000
*       BC(8,EQEOF);                /* NO ADDITIONAL PARMS   @Y30DI3D*/ 01859000
         BC    8,EQEOF                                             0553 01860000
*       VERBEND=R1-1;               /* INIT FOR DLIMSCAN     @Y30DI3D*/ 01861000
         LR    @07,R1                                              0554 01862000
         BCTR  @07,0                                               0554 01863000
         ST    @07,VERBEND(,COMBASE)                               0554 01864000
*       CALL DLIMSCAN;              /*                       @Y30DI3D*/ 01865000
         BAL   @14,DLIMSCAN                                        0555 01866000
*       IF DELIMCD=BLANK THEN                                      0556 01867000
         CLC   DELIMCD(4,COMBASE),@CF00242                         0556 01868000
         BNE   @RF00556                                            0556 01869000
*         IF OPSIZE>0&OPSIZE<9 THEN /* LENGTH IS OK          @Y30DI3D*/ 01870000
         LTR   OPSIZE,OPSIZE                                       0557 01871000
         BNP   @RF00557                                            0557 01872000
         CH    OPSIZE,@CH00172                                     0557 01873000
         BNL   @RF00557                                            0557 01874000
*           DO;                     /*                       @Y30DI3D*/ 01875000
*             CALL DIGITSCN;        /* SCAN FOR VALID ADDRESS      0559 01876000
*                                                            @Y30DI3D*/ 01877000
         BAL   @14,DIGITSCN                                        0559 01878000
*             IF SYNTAXCD=GOOD THEN /* ADDRESS IS OK         @Y30DI3D*/ 01879000
         CLI   SYNTAXCD,X'00'                                      0560 01880000
         BNE   @RF00560                                            0560 01881000
*               IF DUPLNAME=YES THEN/* UPDATE NAME AND ADDR TABLES   */ 01882000
         TM    DUPLNAME,B'00000001'                                0561 01883000
         BNO   @RF00561                                            0561 01884000
*                 DO;               /*                       @Y30DI3D*/ 01885000
*                   CALL EQMSGRTN;  /* ISSUE MESSAGE         @Y30DI3D*/ 01886000
         BAL   @14,EQMSGRTN                                        0563 01887000
*                   ADDRSTOR(E-1)=NUM3;/* CHANGE ADDRESS     @Y30DI3D*/ 01888000
         L     @07,E                                               0564 01889000
         MH    @07,@CH00155                                        0564 01890000
         LA    @05,ADDRSTOR-10(@07)                                0564 01891000
         MVC   0(5,@05),NUM3                                       0564 01892000
*                 END;              /*                       @Y30DI3D*/ 01893000
*               ELSE                                               0566 01894000
*                 DO;               /*                       @Y30DI3D*/ 01895000
         B     @RC00561                                            0566 01896000
@RF00561 DS    0H                                                  0567 01897000
*                   NAMES(I)=THISNAME;/* SAVE NEW NAME       @Y30DI3D*/ 01898000
         L     @07,I                                               0567 01899000
         LR    @05,@07                                             0567 01900000
         SLA   @05,3                                               0567 01901000
         LA    @15,NAMES-8(@05)                                    0567 01902000
         MVC   0(8,@15),THISNAME                                   0567 01903000
*                   ADDRSTOR(I)=NUM3;/* SAVE ADDRESS         @Y30DI3D*/ 01904000
         LR    @05,@07                                             0568 01905000
         MH    @05,@CH00155                                        0568 01906000
         LA    @15,ADDRSTOR-5(@05)                                 0568 01907000
         MVC   0(5,@15),NUM3                                       0568 01908000
*                   I=I+1;          /* INCR I FOR NEXT EQUATE        */ 01909000
         AH    @07,@CH00058                                        0569 01910000
         ST    @07,I                                               0569 01911000
*                 END;              /*                       @Y30DI3D*/ 01912000
*             ELSE                                                 0571 01913000
*               ;                   /*                       @Y30DI3D*/ 01914000
@RF00560 DS    0H                                                  0572 01915000
*           END;                    /*                       @Y30DI3D*/ 01916000
*         ELSE                                                     0573 01917000
*           SYNTAXCD=INVADDR;       /* INVALID ADDR AFTER NAME       */ 01918000
         B     @RC00557                                            0573 01919000
@RF00557 MVI   SYNTAXCD,X'05'                                      0573 01920000
*       ELSE                                                       0574 01921000
*         SYNTAXCD=INVDELIM;        /* INVALID DELIM AFTER ADDR      */ 01922000
         B     @RC00556                                            0574 01923000
@RF00556 MVI   SYNTAXCD,X'02'                                      0574 01924000
*     END;                          /*                       @Y30DI3D*/ 01925000
*   GOTO ENDEQUAT;                  /*                       @Y30DI3D*/ 01926000
         B     ENDEQUAT                                            0576 01927000
*EQEOF:                                                            0577 01928000
*   SYNTAXCD=NOPARMS;               /* MISSING PARMS ON EQUATE VERB     01929000
*                                                            @Y30DI3D*/ 01930000
EQEOF    MVI   SYNTAXCD,X'03'                                      0577 01931000
*ENDEQUAT:                                                         0578 01932000
*   RESPECIFY                                                      0578 01933000
*     R1 UNRESTRICTED;              /*                       @Y30DI3D*/ 01934000
*   END EQUATRTN;                   /*                       @Y30DI3D*/ 01935000
@EL00007 DS    0H                                                  0579 01936000
@EF00007 DS    0H                                                  0579 01937000
@ER00007 LM    @14,@12,@SA00007                                    0579 01938000
         BR    @14                                                 0579 01939000
*                                                                  0580 01940000
*/********************************************************************/ 01941000
*/*                                                          @Y30DI3D*/ 01942000
*/*    THIS ROUTINE WRITES THE MESSAGE FOR DUPLICATE EQUATES @Y30DI3D*/ 01943000
*/*                                                          @Y30DI3D*/ 01944000
*/********************************************************************/ 01945000
*                                                                  0580 01946000
*EQMSGRTN:                                                         0580 01947000
*   PROCEDURE;                      /*                       @Y30DI3D*/ 01948000
EQMSGRTN STM   @14,@12,@SA00008                                    0580 01949000
*   THISMSG=BLANK80;                /*                       @Y30DI3D*/ 01950000
         MVC   THISMSG(80),BLANK80                                 0581 01951000
*   ADDR4=NUM3;                     /* INIT FOR NEW ADDRESS  @Y30DI3D*/ 01952000
         MVC   ADDR4(5),NUM3                                       0582 01953000
*   ADDR5=ADDRSTOR(E-1);            /* GET OLD ADDRESS       @Y30DI3D*/ 01954000
         L     @07,E                                               0583 01955000
         LR    @05,@07                                             0583 01956000
         MH    @05,@CH00155                                        0583 01957000
         LA    @01,ADDRSTOR-10(@05)                                0583 01958000
         MVC   ADDR5(5),0(@01)                                     0583 01959000
*   UNPK(EQMSG(1:7),ADDR4(2:5));    /* TRANSLATE TO PRINTABLE HEX    */ 01960000
         UNPK  EQMSG(7),ADDR4+1(4)                                 0584 01961000
*   TR(ADDRESS1,EBCTABL);           /*                       @Y30DI3D*/ 01962000
         TR    ADDRESS1(6),EBCTABL(COMBASE)                        0585 01963000
*   EQMSG(7)=BLANK1;                /*                       @Y30DI3D*/ 01964000
         MVI   EQMSG+6,C' '                                        0586 01965000
*   UNPK(EQMSG(17:23),ADDR5(2:5));  /*                       @Y30DI3D*/ 01966000
         UNPK  EQMSG+16(7),ADDR5+1(4)                              0587 01967000
*   TR(ADDRESS2,EBCTABL);           /*                       @Y30DI3D*/ 01968000
         TR    ADDRESS2(6),EBCTABL(COMBASE)                        0588 01969000
*   EQMSG(23)=BLANK1;               /*                       @Y30DI3D*/ 01970000
         MVI   EQMSG+22,C' '                                       0589 01971000
*   NAMEHOLD=NAMES(E-1);            /* PUT DUPLICATE NAME IN MESSAGE */ 01972000
         SLA   @07,3                                               0590 01973000
         LA    @05,NAMES-16(@07)                                   0590 01974000
         MVC   NAMEHOLD(8),0(@05)                                  0590 01975000
*   THISMSG(1:48)=EQMSG;            /*                       @Y30DI3D*/ 01976000
         MVC   THISMSG(48),EQMSG                                   0591 01977000
*   DMPMSG03=THISMSG;               /* FOR CONSOLE OUTPUT    @Y30DI3D*/ 01978000
         MVC   DMPMSG03(80),THISMSG                                0592 01979000
*   MSGADDR=ADDR(THISMSG);          /* FOR TERMINAL OUTPUT   @Y30DI3D*/ 01980000
         LA    MSGADDR,THISMSG                                     0593 01981000
*   CALL WRITRTN;                   /* WRITE MESSAGE TO APPROPRIATE     01982000
*                                      DEVICE                        */ 01983000
         BAL   @14,WRITRTN                                         0594 01984000
*   DMPMSG03=BLANK80;               /* SKIP LINE ON CONSOLE  @Y30DI3D*/ 01985000
         MVC   DMPMSG03(80),BLANK80                                0595 01986000
*   MSGADDR=ADDR(BLANK80);          /* SKIP LINE ON TERMINAL @Y30DI3D*/ 01987000
         LA    MSGADDR,BLANK80                                     0596 01988000
*   CALL WRITRTN;                   /*                       @Y30DI3D*/ 01989000
         BAL   @14,WRITRTN                                         0597 01990000
*   END EQMSGRTN;                   /*                       @Y30DI3D*/ 01991000
@EL00008 DS    0H                                                  0598 01992000
@EF00008 DS    0H                                                  0598 01993000
@ER00008 LM    @14,@12,@SA00008                                    0598 01994000
         BR    @14                                                 0598 01995000
*                                                                  0599 01996000
*/********************************************************************/ 01997000
*/*                                                          @Y30DI3D*/ 01998000
*/*  THIS ROUTINE ALLOWS A COMMENT OF UP TO 78 CHARACTERS LONG       */ 01999000
*/*  TO BE WRITTEN TO THE PRINTER                            @Y30DI3D*/ 02000000
*/*                                                          @Y30DI3D*/ 02001000
*/********************************************************************/ 02002000
*                                                                  0599 02003000
*COMMRTN:                                                          0599 02004000
*   PROCEDURE;                      /*                       @Y30DI3D*/ 02005000
COMMRTN  STM   @14,@12,@SA00009                                    0599 02006000
*   RESPECIFY                                                      0600 02007000
*     R1 RESTRICTED;                /*                       @Y30DI3D*/ 02008000
*   VERBGN=VERBEND+1;               /* POSITION AFTER LAST DELIMETER */ 02009000
         LA    @07,1                                               0601 02010000
         AL    @07,VERBEND(,COMBASE)                               0601 02011000
         ST    @07,VERBGN(,COMBASE)                                0601 02012000
*   WTORSIZE=SAVEWTOR-VERBGN;       /* REMAINING BUFFER AREA @Y30DI3D*/ 02013000
         LCR   @07,@07                                             0602 02014000
         AL    @07,SAVEWTOR                                        0602 02015000
         ST    @07,WTORSIZE                                        0602 02016000
*   TRT(OPERAND(1:WTORSIZE),NONBLNK);/* SEARCH FOR START OF COMMENT  */ 02017000
         L     @03,VERBGN(,COMBASE)                                0603 02018000
         L     @07,WTORSIZE                                        0603 02019000
         BCTR  @07,0                                               0603 02020000
         EX    @07,@SB00761                                        0603 02021000
*   VERBGN=R1;                      /* ADDRESS OF BEGINNING OF     0604 02022000
*                                      COMMENT                       */ 02023000
         ST    R1,VERBGN(,COMBASE)                                 0604 02024000
*   COMMAREA=BLANK80;               /* CLEAR OUTPUT BUFFER   @Y30DI3D*/ 02025000
         L     @07,OUTBUFAD                                        0605 02026000
         MVC   COMMAREA(80,@07),BLANK80                            0605 02027000
*   COMMAREA(1:WTORSIZE)=OPERAND(1:WTORSIZE);/*              @Y30DI3D*/ 02028000
         L     @05,WTORSIZE                                        0606 02029000
         BCTR  @05,0                                               0606 02030000
         L     @15,VERBGN(,COMBASE)                                0606 02031000
         EX    @05,@SM00783                                        0606 02032000
*   GEN REFS(AWRITE)(BRWRITE 1);    /* WRITE COMMENT TO PRINTER      */ 02033000
         BRWRITE 1                                                      02034000
*   COMMAREA=BLANK80;               /*                       @Y30DI3D*/ 02035000
         L     @07,OUTBUFAD                                        0608 02036000
         MVC   COMMAREA(80,@07),BLANK80                            0608 02037000
*   GEN REFS(AWRITE)(BRWRITE 1);    /* SKIP LINE             @Y30DI3D*/ 02038000
         BRWRITE 1                                                      02039000
*   RESPECIFY                                                      0610 02040000
*     R1 UNRESTRICTED;              /*                       @Y30DI3D*/ 02041000
*   END COMMRTN;                    /*                       @Y30DI3D*/ 02042000
@EL00009 DS    0H                                                  0611 02043000
@EF00009 DS    0H                                                  0611 02044000
@ER00009 LM    @14,@12,@SA00009                                    0611 02045000
         BR    @14                                                 0611 02046000
*                                                                  0612 02047000
*/********************************************************************/ 02048000
*/*                                                          @Y30DI3D*/ 02049000
*/*  THIS ROUTINE WRITES AN ERROR MESSAGE TO THE OUTPUT DEVICE       */ 02050000
*/*                                                          @Y30DI3D*/ 02051000
*/********************************************************************/ 02052000
*                                                                  0612 02053000
*ERRORTN:                                                          0612 02054000
*   PROCEDURE;                      /*                       @Y30DI3D*/ 02055000
ERRORTN  STM   @14,@12,@SA00010                                    0612 02056000
*   THISMSG=BLANK80;                /* CLEAR MESSAGE BUFFER  @Y30DI3D*/ 02057000
         MVC   THISMSG(80),BLANK80                                 0613 02058000
*   IF SYNTAXCD=INVDELIM THEN                                      0614 02059000
         CLI   SYNTAXCD,X'02'                                      0614 02060000
         BNE   @RF00614                                            0614 02061000
*     THISMSG(1:17)=BADDLM;         /*                       @Y30DI3D*/ 02062000
         MVC   THISMSG(17),BADDLM                                  0615 02063000
*   ELSE                                                           0616 02064000
*     IF SYNTAXCD=INVSVRB THEN                                     0616 02065000
         B     @RC00614                                            0616 02066000
@RF00614 CLI   SYNTAXCD,X'01'                                      0616 02067000
         BNE   @RF00616                                            0616 02068000
*       THISMSG(1:15)=BADSVB;       /*                       @Y30DI3D*/ 02069000
         MVC   THISMSG(15),BADSVB                                  0617 02070000
*     ELSE                                                         0618 02071000
*       IF SYNTAXCD=INVOFST THEN                                   0618 02072000
         B     @RC00616                                            0618 02073000
@RF00616 CLI   SYNTAXCD,X'07'                                      0618 02074000
         BNE   @RF00618                                            0618 02075000
*         THISMSG(1:20)=BADOFT;     /*                       @Y30DI3D*/ 02076000
         MVC   THISMSG(20),BADOFT                                  0619 02077000
*       ELSE                                                       0620 02078000
*         IF SYNTAXCD=LNOTDEC THEN                                 0620 02079000
         B     @RC00618                                            0620 02080000
@RF00618 CLI   SYNTAXCD,X'0C'                                      0620 02081000
         BNE   @RF00620                                            0620 02082000
*           THISMSG(1:18)=NOTDEC;   /*                       @Y30DI3D*/ 02083000
         MVC   THISMSG(18),NOTDEC                                  0621 02084000
*         ELSE                                                     0622 02085000
*           IF SYNTAXCD=INVLEN THEN                                0622 02086000
         B     @RC00620                                            0622 02087000
@RF00620 CLI   SYNTAXCD,X'0B'                                      0622 02088000
         BNE   @RF00622                                            0622 02089000
*             THISMSG(1:14)=BADLEN; /*                       @Y30DI3D*/ 02090000
         MVC   THISMSG(14),BADLEN                                  0623 02091000
*           ELSE                                                   0624 02092000
*             IF SYNTAXCD=INVASID THEN                             0624 02093000
         B     @RC00622                                            0624 02094000
@RF00622 CLI   SYNTAXCD,X'09'                                      0624 02095000
         BNE   @RF00624                                            0624 02096000
*               THISMSG(1:19)=BADASD;/*                      @Y30DI3D*/ 02097000
         MVC   THISMSG(19),BADASD                                  0625 02098000
*             ELSE                                                 0626 02099000
*               IF SYNTAXCD=INVADDR THEN                           0626 02100000
         B     @RC00624                                            0626 02101000
@RF00624 CLI   SYNTAXCD,X'05'                                      0626 02102000
         BNE   @RF00626                                            0626 02103000
*                 THISMSG(1:52)=BADADR;/*                    @Y30DI3D*/ 02104000
         MVC   THISMSG(52),BADADR                                  0627 02105000
*               ELSE                                               0628 02106000
*                 IF SYNTAXCD=INVNAME THEN                         0628 02107000
         B     @RC00626                                            0628 02108000
@RF00626 CLI   SYNTAXCD,X'04'                                      0628 02109000
         BNE   @RF00628                                            0628 02110000
*                   THISMSG(1:54)=BADNME;/*                  @Y30DI3D*/ 02111000
         MVC   THISMSG(54),BADNME                                  0629 02112000
*                 ELSE                                             0630 02113000
*                   IF SYNTAXCD=INVDIGIT THEN                      0630 02114000
         B     @RC00628                                            0630 02115000
@RF00628 CLI   SYNTAXCD,X'06'                                      0630 02116000
         BNE   @RF00630                                            0630 02117000
*                     THISMSG(1:40)=BADDGT;/*                @Y30DI3D*/ 02118000
         MVC   THISMSG(40),BADDGT                                  0631 02119000
*                   ELSE                                           0632 02120000
*                     IF SYNTAXCD=NOTINTBL THEN                    0632 02121000
         B     @RC00630                                            0632 02122000
@RF00630 CLI   SYNTAXCD,X'0A'                                      0632 02123000
         BNE   @RF00632                                            0632 02124000
*                       THISMSG(1:23)=NINTBL;/*              @Y30DI3D*/ 02125000
         MVC   THISMSG(23),NINTBL                                  0633 02126000
*                     ELSE                                         0634 02127000
*                       IF SYNTAXCD=NOPARMS THEN                   0634 02128000
         B     @RC00632                                            0634 02129000
@RF00632 CLI   SYNTAXCD,X'03'                                      0634 02130000
         BNE   @RF00634                                            0634 02131000
*                         THISMSG(1:20)=NOPARM;/*            @Y30DI3D*/ 02132000
         MVC   THISMSG(20),NOPARM                                  0635 02133000
*                       ELSE                                       0636 02134000
*                         THISMSG(1:17)=BADPRM;/*            @Y30DI3D*/ 02135000
         B     @RC00634                                            0636 02136000
@RF00634 MVC   THISMSG(17),BADPRM                                  0636 02137000
*   DMPMSG03=THISMSG;               /* INIT FOR CONSOLE      @Y30DI3D*/ 02138000
@RC00634 DS    0H                                                  0637 02139000
@RC00632 DS    0H                                                  0637 02140000
@RC00630 DS    0H                                                  0637 02141000
@RC00628 DS    0H                                                  0637 02142000
@RC00626 DS    0H                                                  0637 02143000
@RC00624 DS    0H                                                  0637 02144000
@RC00622 DS    0H                                                  0637 02145000
@RC00620 DS    0H                                                  0637 02146000
@RC00618 DS    0H                                                  0637 02147000
@RC00616 DS    0H                                                  0637 02148000
@RC00614 MVC   DMPMSG03(80),THISMSG                                0637 02149000
*   MSGADDR=ADDR(THISMSG);          /* INIT FOR TERMINAL OUTPUT    0638 02150000
*                                                            @Y30DI3D*/ 02151000
         LA    MSGADDR,THISMSG                                     0638 02152000
*   CALL WRITRTN;                   /* WRITE MESSAGE TO OUTPUT DEVICE*/ 02153000
         BAL   @14,WRITRTN                                         0639 02154000
*   DMPMSG03=BLANK80;               /* SKIP LINE ON CONSOLE  @Y30DI3D*/ 02155000
         MVC   DMPMSG03(80),BLANK80                                0640 02156000
*   MSGADDR=ADDR(BLANK80);          /* SKIP LINE ON TERMINAL @Y30DI3D*/ 02157000
         LA    MSGADDR,BLANK80                                     0641 02158000
*   CALL WRITRTN;                   /*                       @Y30DI3D*/ 02159000
         BAL   @14,WRITRTN                                         0642 02160000
*   END ERRORTN;                    /*                       @Y30DI3D*/ 02161000
@EL00010 DS    0H                                                  0643 02162000
@EF00010 DS    0H                                                  0643 02163000
@ER00010 LM    @14,@12,@SA00010                                    0643 02164000
         BR    @14                                                 0643 02165000
*                                                                  0644 02166000
*/********************************************************************/ 02167000
*/*                                                          @Y30DI3D*/ 02168000
*/* THIS ROUTINE WRITES OUTPUT TO THE TERMINAL OR CONSOLE.   @Y30DI3D*/ 02169000
*/* IF NEITHER IS AVAILABLE AND ERROR MESSAGE IS WRITTEN TO SYSPRINT */ 02170000
*/*                                                          @Y30DI3D*/ 02171000
*/********************************************************************/ 02172000
*                                                                  0644 02173000
*WRITRTN:                                                          0644 02174000
*   PROCEDURE;                      /*                       @Y30DI3D*/ 02175000
WRITRTN  STM   @14,@12,@SA00011                                    0644 02176000
*   RESPECIFY                                                      0645 02177000
*     R1 RESTRICTED;                /*                       @Y30DI3D*/ 02178000
*   IF TERMINAL=OPEN THEN                                          0646 02179000
         TM    TERMINAL,B'10000000'                                0646 02180000
         BNO   @RF00646                                            0646 02181000
*     GEN REFS(TSODCB) FLOWS(TSOERR)(PUT TSODCB,(MSGADDR));        0647 02182000
         PUT TSODCB,(MSGADDR)                                           02183000
*   ELSE                                                           0648 02184000
*     IF RDRSW=OFF THEN                                            0648 02185000
         B     @RC00646                                            0648 02186000
@RF00646 TM    RDRSW(COMBASE),B'00000001'                          0648 02187000
         BNZ   @RF00648                                            0648 02188000
*       DO;                         /*                       @Y30DI3D*/ 02189000
*         MSGADDR=ADDR(DMPMSG);     /*                       @Y30DI3D*/ 02190000
         LA    MSGADDR,DMPMSG                                      0650 02191000
*         R1=MSGADDR;               /*                       @Y30DI3D*/ 02192000
         LR    R1,MSGADDR                                          0651 02193000
*         GEN(WTO MF=(E,(R1)));     /* PRINT TO CONSOLE      @Y30DI3D*/ 02194000
         WTO MF=(E,(R1))                                                02195000
*       END;                        /*                       @Y30DI3D*/ 02196000
*     ELSE                          /* NO OUTPUT DEVICE AVAILABLE  0654 02197000
*                                                            @Y30DI3D*/ 02198000
*       GEN REFS(APRTMSG)(BRPRTMSG NODEV,30);/*              @Y30DI3D*/ 02199000
         B     @RC00648                                            0654 02200000
@RF00648 DS    0H                                                  0654 02201000
         BRPRTMSG NODEV,30                                              02202000
*   RESPECIFY                                                      0655 02203000
*     R1 UNRESTRICTED;              /*                       @Y30DI3D*/ 02204000
*   END WRITRTN;                    /*                       @Y30DI3D*/ 02205000
@EL00011 DS    0H                                                  0656 02206000
@EF00011 DS    0H                                                  0656 02207000
@ER00011 LM    @14,@12,@SA00011                                    0656 02208000
         BR    @14                                                 0656 02209000
*                                                                  0657 02210000
*/********************************************************************/ 02211000
*/*                                                          @Y30DI3D*/ 02212000
*/*   ROUTINE TO SCAN FOR THE NEXT DELIMETER AND RETURN THE SIZE     */ 02213000
*/*   AND ADDRESS OF THE OPERAND                             @Y30DI3D*/ 02214000
*/*                                                          @Y30DI3D*/ 02215000
*/********************************************************************/ 02216000
*                                                                  0657 02217000
*DLIMSCAN:                                                         0657 02218000
*   PROCEDURE;                      /*                       @Y30DI3D*/ 02219000
DLIMSCAN STM   @14,@04,12(@13)                                     0657 02220000
         STM   @06,@12,44(@13)                                     0657 02221000
*   RESPECIFY                                                      0658 02222000
*    (R2,                                                          0658 02223000
*     R1) RESTRICTED;               /*                       @Y30DI3D*/ 02224000
*   VERBGN=VERBEND+1;               /* START WITH CHAR AFTER LAST  0659 02225000
*                                      DELIM                         */ 02226000
         LA    @07,1                                               0659 02227000
         AL    @07,VERBEND(,COMBASE)                               0659 02228000
         ST    @07,VERBGN(,COMBASE)                                0659 02229000
*   R1=0;                           /*                       @Y30DI3D*/ 02230000
         SLR   R1,R1                                               0660 02231000
*   R2=0;                           /*                       @Y30DI3D*/ 02232000
         SLR   R2,R2                                               0661 02233000
*   TRT(OPERAND,DLIMTBL);           /* SCAN FOR DELIMETER    @Y30DI3D*/ 02234000
         L     @03,VERBGN(,COMBASE)                                0662 02235000
         TRT   OPERAND(78,@03),DLIMTBL                             0662 02236000
*   VERBEND=R1;                     /* ADDR OF DELIMETER     @Y30DI3D*/ 02237000
         ST    R1,VERBEND(,COMBASE)                                0663 02238000
*   DELIMCD=R2;                     /* DELIMETER CODE NUMBER @Y30DI3D*/ 02239000
         ST    R2,DELIMCD(,COMBASE)                                0664 02240000
*   OPSIZE=VERBEND-VERBGN;          /* SIZE OF OPERAND       @Y30DI3D*/ 02241000
         L     @07,VERBEND(,COMBASE)                               0665 02242000
         SL    @07,VERBGN(,COMBASE)                                0665 02243000
         LR    OPSIZE,@07                                          0665 02244000
*   RESPECIFY                                                      0666 02245000
*    (R2,                                                          0666 02246000
*     R1) UNRESTRICTED;             /*                       @Y30DI3D*/ 02247000
*   END DLIMSCAN;                   /*                       @Y30DI3D*/ 02248000
@EL00012 DS    0H                                                  0667 02249000
@EF00012 DS    0H                                                  0667 02250000
@ER00012 LM    @14,@04,12(@13)                                     0667 02251000
         LM    @06,@12,44(@13)                                     0667 02252000
         BR    @14                                                 0667 02253000
*                                                                  0668 02254000
*/********************************************************************/ 02255000
*/*                                                          @Y30DI3D*/ 02256000
*/*   THIS ROUTINE CHECKS TO SEE IF AN ADDRESS OR AN ASID IS A VALID */ 02257000
*/*   NUMBER                                                 @Y30DI3D*/ 02258000
*/*                                                          @Y30DI3D*/ 02259000
*/********************************************************************/ 02260000
*                                                                  0668 02261000
*DIGITSCN:                                                         0668 02262000
*   PROCEDURE;                      /*                       @Y30DI3D*/ 02263000
DIGITSCN STM   @14,@12,12(@13)                                     0668 02264000
*   DO N=1 TO OPSIZE WHILE SYNTAXCD=GOOD;/* CHECK EACH DIGIT         */ 02265000
         LA    @07,1                                               0669 02266000
         B     @DE00669                                            0669 02267000
@DL00669 CLI   SYNTAXCD,X'00'                                      0669 02268000
         BNE   @DC00669                                            0669 02269000
*     IF OPERAND(N)>='0'&OPERAND(N)<='9'|OPERAND(N)>='A'&OPERAND(N)<='F 02270000
*       THEN                                                       0670 02271000
         L     @15,VERBGN(,COMBASE)                                0670 02272000
         ALR   @07,@15                                             0670 02273000
         BCTR  @07,0                                               0670 02274000
         CLI   OPERAND(@07),C'0'                                   0670 02275000
         BL    @GL00052                                            0670 02276000
         L     @07,N                                               0670 02277000
         ALR   @15,@07                                             0670 02278000
         BCTR  @15,0                                               0670 02279000
         CLI   OPERAND(@15),C'9'                                   0670 02280000
         BNH   @RT00670                                            0670 02281000
@GL00052 L     @07,N                                               0670 02282000
         L     @15,VERBGN(,COMBASE)                                0670 02283000
         ALR   @07,@15                                             0670 02284000
         BCTR  @07,0                                               0670 02285000
         CLI   OPERAND(@07),C'A'                                   0670 02286000
         BL    @RF00670                                            0670 02287000
         L     @07,N                                               0670 02288000
         ALR   @15,@07                                             0670 02289000
         BCTR  @15,0                                               0670 02290000
         CLI   OPERAND(@15),C'F'                                   0670 02291000
         BNH   @RT00670                                            0670 02292000
*       ;                           /* GOOD DIGIT                    */ 02293000
*     ELSE                          /* INPUT NOT NUMERIC             */ 02294000
*       SYNTAXCD=INVDIGIT;          /*                       @Y30DI3D*/ 02295000
@RF00670 MVI   SYNTAXCD,X'06'                                      0672 02296000
*   END;                            /*                       @Y30DI3D*/ 02297000
@RT00670 LA    @07,1                                               0673 02298000
         AL    @07,N                                               0673 02299000
@DE00669 ST    @07,N                                               0673 02300000
         CR    @07,OPSIZE                                          0673 02301000
         BNH   @DL00669                                            0673 02302000
@DC00669 DS    0H                                                  0674 02303000
*   IF SYNTAXCD=GOOD THEN           /* CONVERT TO BINARY             */ 02304000
         CLI   SYNTAXCD,X'00'                                      0674 02305000
         BNE   @RF00674                                            0674 02306000
*     DO;                           /*                       @Y30DI3D*/ 02307000
*       TR(OPERAND(1:OPSIZE),HEXTABL);/*                     @Y30DI3D*/ 02308000
         L     @07,VERBGN(,COMBASE)                                0676 02309000
         LR    @15,OPSIZE                                          0676 02310000
         BCTR  @15,0                                               0676 02311000
         EX    @15,@SB00785                                        0676 02312000
*       CHARWORK=BLANK6;            /*                       @Y30DI3D*/ 02313000
         MVC   CHARWORK(6),@CC00388                                0677 02314000
*       CHARWORK((7-OPSIZE):6)=OPERAND(1:OPSIZE);/*          @Y30DI3D*/ 02315000
         LA    @15,7                                               0678 02316000
         SLR   @15,OPSIZE                                          0678 02317000
         LA    @14,CHARWORK-1(@15)                                 0678 02318000
         LCR   @15,@15                                             0678 02319000
         AH    @15,@CH00387                                        0678 02320000
         EX    @15,@SM00787                                        0678 02321000
*       PACK(NUM2,CHARWORK);        /*                       @Y30DI3D*/ 02322000
         PACK  NUM2(4),CHARWORK(6)                                 0679 02323000
*       MVO(NUM3,NUM2);             /*                       @Y30DI3D*/ 02324000
         MVO   NUM3(5),NUM2(4)                                     0680 02325000
*     END;                          /*                       @Y30DI3D*/ 02326000
*   END DIGITSCN;                   /*                       @Y30DI3D*/ 02327000
@EL00013 DS    0H                                                  0682 02328000
@EF00013 DS    0H                                                  0682 02329000
@ER00013 LM    @14,@12,12(@13)                                     0682 02330000
         BR    @14                                                 0682 02331000
*                                                                  0683 02332000
*/********************************************************************/ 02333000
*/*                                                          @Y30DI3D*/ 02334000
*/*   THIS ROUTINE SCANS THE NAME TABLE MADE IN EQUATRTN WHEN        */ 02335000
*/* RELATIVE ADDRESSING IS USED IN THE 'LIST' SUBVERB        @Y30DI3D*/ 02336000
*/*                                                          @Y30DI3D*/ 02337000
*/********************************************************************/ 02338000
*                                                                  0683 02339000
*NAMESCAN:                                                         0683 02340000
*   PROCEDURE;                      /*                       @Y30DI3D*/ 02341000
NAMESCAN STM   @14,@12,12(@13)                                     0683 02342000
*   SEARCHON=YES;                   /*                       @Y30DI3D*/ 02343000
         OI    SEARCHON,B'01000000'                                0684 02344000
*   THISNAME=OPERAND(1:OPSIZE);     /* GET NAME              @Y30DI3D*/ 02345000
         MVI   THISNAME+1,C' '                                     0685 02346000
         MVC   THISNAME+2(6),THISNAME+1                            0685 02347000
         LR    @07,OPSIZE                                          0685 02348000
         BCTR  @07,0                                               0685 02349000
         L     @01,VERBGN(,COMBASE)                                0685 02350000
         EX    @07,@SM00790                                        0685 02351000
*   DO T=1 TO I WHILE SEARCHON=YES; /*                       @Y30DI3D*/ 02352000
         LA    @07,1                                               0686 02353000
         B     @DE00686                                            0686 02354000
@DL00686 TM    SEARCHON,B'01000000'                                0686 02355000
         BNO   @DC00686                                            0686 02356000
*     IF THISNAME=NAMES(T) THEN                                    0687 02357000
         SLA   @07,3                                               0687 02358000
         LA    @01,NAMES-8(@07)                                    0687 02359000
         CLC   THISNAME(8),0(@01)                                  0687 02360000
         BNE   @RF00687                                            0687 02361000
*       SEARCHON=NO;                /* NAME FOUND,DISCONTINUE SCAN 0688 02362000
*                                                            @Y30DI3D*/ 02363000
         NI    SEARCHON,B'10111111'                                0688 02364000
*     ELSE                                                         0689 02365000
*       ;                           /*                       @Y30DI3D*/ 02366000
@RF00687 DS    0H                                                  0690 02367000
*   END;                            /*                       @Y30DI3D*/ 02368000
         LA    @07,1                                               0690 02369000
         AL    @07,T                                               0690 02370000
@DE00686 ST    @07,T                                               0690 02371000
         C     @07,I                                               0690 02372000
         BNH   @DL00686                                            0690 02373000
@DC00686 DS    0H                                                  0691 02374000
*   IF SEARCHON=NO THEN                                            0691 02375000
         TM    SEARCHON,B'01000000'                                0691 02376000
         BNZ   @RF00691                                            0691 02377000
*     NUM3=ADDRSTOR(T-1);           /*                       @Y30DI3D*/ 02378000
         L     @07,T                                               0692 02379000
         MH    @07,@CH00155                                        0692 02380000
         LA    @01,ADDRSTOR-10(@07)                                0692 02381000
         MVC   NUM3(5),0(@01)                                      0692 02382000
*   ELSE                                                           0693 02383000
*     SYNTAXCD=NOTINTBL;            /*                       @Y30DI3D*/ 02384000
         B     @RC00691                                            0693 02385000
@RF00691 MVI   SYNTAXCD,X'0A'                                      0693 02386000
*   END NAMESCAN;                   /*                       @Y30DI3D*/ 02387000
@EL00014 DS    0H                                                  0694 02388000
@EF00014 DS    0H                                                  0694 02389000
@ER00014 LM    @14,@12,12(@13)                                     0694 02390000
         BR    @14                                                 0694 02391000
*   END AMDPRFDS                    /*                       @Y30DI3D*/ 02392000
*                                                                  0695 02393000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02394000
*/*%INCLUDE SYSLIB  (COMMON  )                                       */ 02395000
*                                                                  0695 02396000
*       ;                                                          0695 02397000
@DATA    DS    0H                                                       02398000
@CH00058 DC    H'1'                                                     02399000
@CH00165 DC    H'2'                                                     02400000
@CH00150 DC    H'3'                                                     02401000
@CH00155 DC    H'5'                                                     02402000
@CH00387 DC    H'6'                                                     02403000
@CH00686 DC    H'7'                                                     02404000
@CH00044 DC    H'8'                                                     02405000
@CH00172 DC    H'9'                                                     02406000
@CH00412 DC    H'28'                                                    02407000
@CH00382 DC    H'80'                                                    02408000
@CH00152 DC    H'81'                                                    02409000
@CH00174 DC    H'256'                                                   02410000
@SB00761 TRT   OPERAND(0,@03),NONBLNK(COMBASE)                          02411000
@SM00764 MVC   COMMAREA(0,@15),OPERAND(@07)                             02412000
@SB00770 TR    OPERAND(0,@15),HEXTABL(COMBASE)                          02413000
@SM00772 MVC   0(0,@07),OPERAND(@15)                                    02414000
@SM00776 MVC   FLDWORK(0,@03),0(@14)                                    02415000
@SM00780 MVC   THISNAME(0),OPERAND(@15)                                 02416000
@SM00783 MVC   COMMAREA(0,@07),OPERAND(@15)                             02417000
@SB00785 TR    OPERAND(0,@07),HEXTABL(COMBASE)                          02418000
@SM00787 MVC   0(0,@14),OPERAND(@07)                                    02419000
@SM00790 MVC   THISNAME(0),OPERAND(@01)                                 02420000
         DS    0F                                                       02421000
@SA00001 DS    18F                                                      02422000
@SA00011 DS    15F                                                      02423000
@SA00002 DS    15F                                                      02424000
@SA00003 DS    15F                                                      02425000
@SA00004 DS    15F                                                      02426000
@SA00005 DS    15F                                                      02427000
@SA00007 DS    15F                                                      02428000
@SA00009 DS    15F                                                      02429000
@SA00010 DS    15F                                                      02430000
@SA00006 DS    15F                                                      02431000
@SA00008 DS    15F                                                      02432000
         DS    0F                                                       02433000
@CF00157 DC    F'4'                                                     02434000
@CH00157 EQU   @CF00157+2                                               02435000
@CF00242 DC    F'12'                                                    02436000
@CF00185 DC    F'16'                                                    02437000
@CF00215 DC    F'20'                                                    02438000
@CF00224 DC    F'24'                                                    02439000
@CH00224 EQU   @CF00224+2                                               02440000
@CF00414 DC    F'32'                                                    02441000
@CF00432 DC    F'16777216'                                              02442000
         DS    0D                                                       02443000
I        DC    F'1'                                                     02444000
L        DS    F                                                        02445000
T        DS    F                                                        02446000
WORD     DS    F                                                        02447000
HALF     DS    F                                                        02448000
LINE     DC    F'0'                                                     02449000
E        DS    F                                                        02450000
N        DS    F                                                        02451000
SAVEWTOR DS    A                                                        02452000
WTORSIZE DS    A                                                        02453000
WTORECB1 DC    F'0'                                                     02454000
SIGN     DS    F                                                        02455000
GOODNUM  DS    AL4                                                      02456000
         ORG   GOODNUM                                                  02457000
NUM3     DS    CL5                                                      02458000
         ORG   GOODNUM+5                                                02459000
         DS    CL3                                                      02460000
HEXCONV  DS    A                                                        02461000
LEN1     DS    A                                                        02462000
LOADDR   DS    A                                                        02463000
HIADDR   DS    A                                                        02464000
OUTBUFAD DS    A                                                        02465000
SAVEBGN  DS    A                                                        02466000
MSGADDR1 DS    A                                                        02467000
MSGADDR2 DS    A                                                        02468000
BUFFADDR DS    A                                                        02469000
SAVEADDR DS    A                                                        02470000
DATAPTR  DS    A                                                        02471000
THISLINE DS    A                                                        02472000
LOBYTE   DS    A                                                        02473000
HIBYTE   DS    A                                                        02474000
FAILADDR DS    A                                                        02475000
READEND  DS    A                                                        02476000
BLANKPTR DS    A                                                        02477000
BLOCKEND DS    A                                                        02478000
FDSSAVEA DS    A                                                        02479000
BYTEOFST DS    F                                                        02480000
BUFFEND  DS    A                                                        02481000
THISOFST DS    A                                                        02482000
READMASK DC    XL4'FFFFFFFC'                                            02483000
READCTR  DS    FL1                                                      02484000
SAVE1    DS    AL3                                                      02485000
         DS    CL1                                                      02486000
SAVE2    DS    AL3                                                      02487000
         DS    0D                                                       02488000
@TS00001 DS    CL8                                                      02489000
@CC00664 DC    C'HARDCOPY'                                              02490000
@CC00388 DC    C'      '                                                02491000
@CC00662 DC    C'RETURN'                                                02492000
@CC00668 DC    C'EQUATE'                                                02493000
@CC00666 DC    C'LIST'                                                  02494000
@CC00696 DC    C'ASID'                                                  02495000
@CC00661 EQU   @CC00662                                                 02496000
@CC00678 DC    C'OFF'                                                   02497000
@CC00663 DC    C'HC'                                                    02498000
@CC00667 EQU   @CC00668                                                 02499000
@CC00677 DC    C'ON'                                                    02500000
@CB00436 DC    X'FFFF'                                                  02501000
SYNTAXCD DS    CL1                                                      02502000
PREVREAD DS    CL1                                                      02503000
SUBVERB  DS    CL1                                                      02504000
SWITCHES DS    CL1                                                      02505000
         ORG   SWITCHES                                                 02506000
HCOPYON  DS    BL1                                                      02507000
FDSON    EQU   SWITCHES+0                                               02508000
ASIDSW   EQU   SWITCHES+0                                               02509000
OPSCAN   EQU   SWITCHES+0                                               02510000
SIGNSW   EQU   SWITCHES+0                                               02511000
MSGSW    EQU   SWITCHES+0                                               02512000
PREVSET  EQU   SWITCHES+0                                               02513000
PRINTOUT EQU   SWITCHES+0                                               02514000
         ORG   SWITCHES+1                                               02515000
MORESWS  DS    CL1                                                      02516000
         ORG   MORESWS                                                  02517000
TERMINAL DS    BL1                                                      02518000
SEARCHON EQU   MORESWS+0                                                02519000
NONAME   EQU   MORESWS+0                                                02520000
NOMORE   EQU   MORESWS+0                                                02521000
FRSTFAIL EQU   MORESWS+0                                                02522000
CONTREAD EQU   MORESWS+0                                                02523000
DUMPMADE EQU   MORESWS+0                                                02524000
DUPLNAME EQU   MORESWS+0                                                02525000
         ORG   MORESWS+1                                                02526000
BLANK4   DS    CL81                                                     02527000
         ORG   BLANK4                                                   02528000
@NM00048 DC    81CL1' '                                                 02529000
         ORG   BLANK4+81                                                02530000
BLANK8   DC    CL8'        '                                            02531000
BLANK80  DS    CL80                                                     02532000
         ORG   BLANK80                                                  02533000
@NM00049 DC    80CL1' '                                                 02534000
         ORG   BLANK80+80                                               02535000
BLANK256 DS    CL256                                                    02536000
         ORG   BLANK256                                                 02537000
@NM00050 DC    256CL1' '                                                02538000
         ORG   BLANK256+256                                             02539000
THISNAME DS    CL8                                                      02540000
CHARWORK DS    CL6                                                      02541000
LEN2     DS    CL4                                                      02542000
NUM2     DS    CL4                                                      02543000
         DS    CL1                                                      02544000
THISASID DS    BL2                                                      02545000
LASTASID DS    BL2                                                      02546000
DLIMTBL  DS    CL256                                                    02547000
         ORG   DLIMTBL                                                  02548000
@NM00051 DC    64AL1(0)                                                 02549000
@NM00052 DC    AL1(12)                                                  02550000
@NM00053 DC    10AL1(0)                                                 02551000
@NM00054 DC    AL1(32)                                                  02552000
@NM00055 DC    AL1(0)                                                   02553000
@NM00056 DC    AL1(16)                                                  02554000
@NM00057 DC    AL1(24)                                                  02555000
@NM00058 DC    14AL1(0)                                                 02556000
@NM00059 DC    AL1(20)                                                  02557000
@NM00060 DC    2AL1(0)                                                  02558000
@NM00061 DC    AL1(28)                                                  02559000
@NM00062 DC    10AL1(0)                                                 02560000
@NM00063 DC    AL1(4)                                                   02561000
@NM00064 DC    18AL1(0)                                                 02562000
@NM00065 DC    AL1(8)                                                   02563000
@NM00066 DC    129AL1(0)                                                02564000
         ORG   DLIMTBL+256                                              02565000
IOMSG1   DC    CL60'PERMANENT I/O ERROR ON SYSIN - EXECUTION      TERMIC02566000
               NATED'                                                   02567000
IOMSG2   DC    CL60'PERMANENT I/O ERROR ON SYSTERM - EXECUTION     TERMC02568000
               INATED'                                                  02569000
THRU     DC    CL8' THROUGH'                                            02570000
REMNMSG  DC    CL21' COULD NOT BE PRINTED'                              02571000
EOFMSG   DC    CL35'EOF ON SYSIN - EXECUTION TERMINATED'                02572000
RPLYMSG  DC    CL37'REPLY WITH DESIRED FUNCTION OR RETURN'              02573000
NODEV    DC    CL32'NO DEVICE AVAILABLE FOR OUTPUT'                     02574000
NOMOREQ  DC    CL29'NUMBER OF EQUATES EXCEEDS 256'                      02575000
EQMSG    DS    CL48                                                     02576000
         ORG   EQMSG                                                    02577000
ADDRESS1 DS    CL6                                                      02578000
REPL     DC    CL10' REPLACES '                                         02579000
ADDRESS2 DS    CL6                                                      02580000
ATNAME   DC    CL18' AT SYMBOLIC NAME '                                 02581000
NAMEHOLD DS    CL8                                                      02582000
         ORG   EQMSG+48                                                 02583000
ADDR4    DS    CL5                                                      02584000
ADDR5    DS    CL5                                                      02585000
MSGHOLD  DS    CL80                                                     02586000
BUFFAREA DS    CL256                                                    02587000
BADSVB   DC    CL15'INVALID SUBVERB'                                    02588000
BADDLM   DC    CL17'INVALID DELIMETER'                                  02589000
BADOFT   DC    CL20'OFFSET OVER 6 DIGITS'                               02590000
NOTDEC   DC    CL18'LENGTH NOT DECIMAL'                                 02591000
BADASD   DC    CL19'INVALID ASID NUMBER'                                02592000
BADADR   DC    CL52'ADDRESS GREATER THAN 6 DIGITS OR LESS THAN 1 DIGIT' 02593000
BADNME   DC    CL54'SYMBOLIC NAME NOT ALPHAMERIC OR NOT 1 TO 8 DIGITS LC02594000
               ONG'                                                     02595000
BADDGT   DC    CL40'INVALID DIGIT IN ADDRESS,OFFSET, OR ASID'           02596000
NINTBL   DC    CL23'SYMBOLIC NAME NOT FOUND'                            02597000
NOPARM   DC    CL20'MISSING PARAMETER(S)'                               02598000
BADPRM   DC    CL17'INVALID PARAMETER'                                  02599000
BADLEN   DC    CL14'INVALID LENGTH'                                     02600000
THISMSG  DS    CL80                                                     02601000
         DS    CL3                                                      02602000
DMPMSG   DS    CL88                                                     02603000
         ORG   DMPMSG                                                   02604000
DMPMSG01 DC    H'84'                                                    02605000
DMPMSG02 DC    B'1000000000000000'                                      02606000
DMPMSG03 DS    CL80                                                     02607000
DMPMSG04 DC    B'0000001000000000'                                      02608000
DMPMSG05 DC    B'0100000000000000'                                      02609000
         ORG   DMPMSG+88                                                02610000
NAMES    DS    256CL8                                                   02611000
ADDRSTOR DS    256CL5                                                   02612000
HCOPYBUF DS    9CL80                                                    02613000
PATCH    DC    70F'0'                                                   02614000
AMDPRFDS CSECT                                                          02615000
*                                                                       02616000
DTAE     EQU   32                  DATA EBCDIC BIT                      02617000
DTAC     EQU   16                  DATA IN CORE BIT                     02618000
DTAP     EQU   8                   DATA PTR BIT                         02619000
DTA      EQU   4                   DATA INCLUDED BIT                    02620000
LBLP     EQU   2                   LABEL PTR BIT                        02621000
LBL      EQU   1                   LABEL INCLUDED BIT                   02622000
AMDPRFDS CSECT                                                          02623000
*                                                          /*@Y30DI3D*/ 02624000
TSODCB   DCB   DSORG=PS,DDNAME=SYSTERM,MACRF=PM,               @Y30DI3DX02625000
               RECFM=FB,LRECL=78,BLKSIZE=80,SYNAD=TSOERR  /* OZ13018 */ 02626000
AMDPRFDS CSECT                                                          02627000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02628000
@01      EQU   01                                                       02629000
@02      EQU   02                                                       02630000
@03      EQU   03                                                       02631000
@04      EQU   04                                                       02632000
@05      EQU   05                                                       02633000
@06      EQU   06                                                       02634000
@07      EQU   07                                                       02635000
@08      EQU   08                                                       02636000
@09      EQU   09                                                       02637000
@10      EQU   10                                                       02638000
@11      EQU   11                                                       02639000
@12      EQU   12                                                       02640000
@13      EQU   13                                                       02641000
@14      EQU   14                                                       02642000
@15      EQU   15                                                       02643000
INLINE   EQU   @05                                                      02644000
PREVADDR EQU   @05                                                      02645000
FIELDPTR EQU   @05                                                      02646000
BUFFPTR  EQU   @05                                                      02647000
COMSIZE  EQU   @05                                                      02648000
OPSIZE   EQU   @05                                                      02649000
RITE     EQU   @05                                                      02650000
BASE1    EQU   @11                                                      02651000
BASE2    EQU   @10                                                      02652000
BASE3    EQU   @09                                                      02653000
R1       EQU   @01                                                      02654000
R2       EQU   @02                                                      02655000
R3       EQU   @03                                                      02656000
R6       EQU   @06                                                      02657000
R13      EQU   @13                                                      02658000
COMBASE  EQU   @12                                                      02659000
REG8     EQU   @08                                                      02660000
MSGADDR  EQU   @04                                                      02661000
READADDR EQU   @02                                                      02662000
BUFREG   EQU   @06                                                      02663000
CNTREG   EQU   @03                                                      02664000
LINEREG  EQU   @08                                                      02665000
PREG     EQU   @01                                                      02666000
R0       EQU   @00                                                      02667000
R10      EQU   @10                                                      02668000
R11      EQU   @11                                                      02669000
R12      EQU   @12                                                      02670000
R14      EQU   @14                                                      02671000
R15      EQU   @15                                                      02672000
R4       EQU   @04                                                      02673000
R5       EQU   @05                                                      02674000
R7       EQU   @07                                                      02675000
R8       EQU   @08                                                      02676000
R9       EQU   @09                                                      02677000
STOPBASE EQU   @05                                                      02678000
COMMON   EQU   0                                                        02679000
ERRADDR  EQU   COMMON                                                   02680000
VERBGN   EQU   COMMON+4                                                 02681000
VERBEND  EQU   COMMON+8                                                 02682000
DELIMCD  EQU   COMMON+20                                                02683000
CURBUF   EQU   COMMON+48                                                02684000
SWA      EQU   COMMON+122                                               02685000
RDRSW    EQU   SWA                                                      02686000
SWB      EQU   COMMON+123                                               02687000
SWC      EQU   COMMON+124                                               02688000
SWD      EQU   COMMON+125                                               02689000
SWE      EQU   COMMON+126                                               02690000
SWF      EQU   COMMON+127                                               02691000
BUFSW    EQU   COMMON+128                                               02692000
PRSW     EQU   COMMON+129                                               02693000
WTORMSG  EQU   COMMON+133                                               02694000
TABLE    EQU   COMMON+659                                               02695000
HEXTABL  EQU   TABLE+63                                                 02696000
EBCTABL  EQU   HEXTABL+10                                               02697000
NONBLNK  EQU   COMMON+1244                                              02698000
AWRITE   EQU   COMMON+1500                                              02699000
APRTMSG  EQU   COMMON+1504                                              02700000
AEREXIT  EQU   COMMON+1536                                              02701000
DCBADDRS EQU   COMMON+1608                                              02702000
ARDRDCB  EQU   DCBADDRS+8                                               02703000
@NM00041 EQU   DCBADDRS+16                                              02704000
@NM00042 EQU   @NM00041                                                 02705000
QASID    EQU   COMMON+1664                                              02706000
BRRDDATA EQU   COMMON+1984                                              02707000
OPERAND  EQU   0                                                        02708000
OUTBUFR  EQU   0                                                        02709000
CC       EQU   OUTBUFR                                                  02710000
DATAREA  EQU   OUTBUFR+1                                                02711000
ADDRESS  EQU   DATAREA                                                  02712000
FIELD1   EQU   DATAREA+7                                                02713000
FIELD2   EQU   DATAREA+43                                               02714000
BUFFER1  EQU   0                                                        02715000
BUFFER2  EQU   0                                                        02716000
FLDWORK  EQU   0                                                        02717000
DATAWORK EQU   0                                                        02718000
INDATA   EQU   0                                                        02719000
DCBFLGS  EQU   0                                                        02720000
DCBOPEN  EQU   DCBFLGS                                                  02721000
COMMAREA EQU   DATAREA                                                  02722000
MSGAREA  EQU   DATAREA                                                  02723000
ADDR2    EQU   MSGADDR1                                                 02724000
ADDR3    EQU   MSGADDR2                                                 02725000
ADDR1    EQU   THISLINE                                                 02726000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02727000
@NM00071 EQU   DCBFLGS                                                  02728000
@NM00070 EQU   DCBFLGS                                                  02729000
@NM00069 EQU   DATAREA+78                                               02730000
@NM00068 EQU   DATAREA+42                                               02731000
@NM00067 EQU   DATAREA+6                                                02732000
CSADDR   EQU   COMMON+2072                                              02733000
@NM00047 EQU   COMMON+2070                                              02734000
TOPICHDR EQU   COMMON+2060                                              02735000
DFLTCSA  EQU   COMMON+2056                                              02736000
LPAMAX   EQU   COMMON+2052                                              02737000
DNUCTOP  EQU   COMMON+2048                                              02738000
XLMAX    EQU   COMMON+2044                                              02739000
DQEMAX   EQU   COMMON+2042                                              02740000
ASCBMAX  EQU   COMMON+2040                                              02741000
TCBMAX   EQU   COMMON+2038                                              02742000
SRBMAX   EQU   COMMON+2036                                              02743000
DDMAX    EQU   COMMON+2034                                              02744000
DEBMAX   EQU   COMMON+2032                                              02745000
JPQMAX   EQU   COMMON+2030                                              02746000
LLEMAX   EQU   COMMON+2028                                              02747000
PQEMAX   EQU   COMMON+2026                                              02748000
RBMAX    EQU   COMMON+2024                                              02749000
@NM00046 EQU   COMMON+2023                                              02750000
EXITFLAG EQU   COMMON+2022                                              02751000
AUSRASID EQU   COMMON+2020                                              02752000
AUSRTCBA EQU   COMMON+2016                                              02753000
AUSRDEL  EQU   COMMON+2012                                              02754000
AUSREXIT EQU   COMMON+2008                                              02755000
AUSRINIT EQU   COMMON+2004                                              02756000
ASRBFMT  EQU   COMMON+2000                                              02757000
AASCBFMT EQU   COMMON+1996                                              02758000
BRRDADJ  EQU   COMMON+1992                                              02759000
BRRDINIT EQU   COMMON+1988                                              02760000
BUFERMAP EQU   COMMON+1980                                              02761000
ASCBMAP  EQU   COMMON+1976                                              02762000
CPUMAP   EQU   COMMON+1972                                              02763000
ASIDNDX  EQU   COMMON+1968                                              02764000
@NM00045 EQU   COMMON+1964                                              02765000
HDRTITLE EQU   COMMON+1864                                              02766000
HDRREGS  EQU   COMMON+1696                                              02767000
SACSWCAW EQU   COMMON+1684                                              02768000
ASVTADDR EQU   COMMON+1680                                              02769000
PREFXRGV EQU   COMMON+1676                                              02770000
PREFXRGR EQU   COMMON+1672                                              02771000
CURASCB  EQU   COMMON+1668                                              02772000
IPLCPU   EQU   COMMON+1666                                              02773000
QAPFT    EQU   COMMON+1660                                              02774000
@NM00044 EQU   COMMON+1656                                              02775000
REALMAX  EQU   COMMON+1652                                              02776000
SEGTABOR EQU   COMMON+1648                                              02777000
REALMAP  EQU   COMMON+1644                                              02778000
@NM00043 EQU   COMMON+1641                                              02779000
EDITER   EQU   COMMON+1640                                              02780000
AROOT    EQU   COMMON+1636                                              02781000
AEDITCB  EQU   COMMON+1632                                              02782000
TRCCOUNT EQU   COMMON+1628                                              02783000
ASYSUDCB EQU   @NM00041+1                                               02784000
ENDLIST  EQU   @NM00042                                                 02785000
AINDCB   EQU   DCBADDRS+12                                              02786000
APTRDCB  EQU   DCBADDRS+4                                               02787000
AOUTDCB  EQU   DCBADDRS                                                 02788000
ATCBSMRY EQU   COMMON+1604                                              02789000
ATCBSMFR EQU   COMMON+1600                                              02790000
ONGOPTR  EQU   COMMON+1596                                              02791000
AEND     EQU   COMMON+1592                                              02792000
AERRMSGA EQU   COMMON+1584                                              02793000
BUFREINT EQU   COMMON+1580                                              02794000
BUFSUM   EQU   COMMON+1576                                              02795000
APRTSTG  EQU   COMMON+1572                                              02796000
AFORMAT  EQU   COMMON+1568                                              02797000
ASTPROUT EQU   COMMON+1564                                              02798000
APCBENQ  EQU   COMMON+1560                                              02799000
ATCBRTRV EQU   COMMON+1556                                              02800000
ATCBREMV EQU   COMMON+1552                                              02801000
ATCBSAVE EQU   COMMON+1548                                              02802000
QATMERTN EQU   COMMON+1544                                              02803000
ALOADER  EQU   COMMON+1540                                              02804000
SYNMSGA  EQU   COMMON+1532                                              02805000
STOPEXIT EQU   COMMON+1528                                              02806000
ARGNBND  EQU   COMMON+1524                                              02807000
AWRDCNVT EQU   COMMON+1520                                              02808000
AADRCNVT EQU   COMMON+1516                                              02809000
AFMTLINE EQU   COMMON+1512                                              02810000
ASYNTAX  EQU   COMMON+1508                                              02811000
BLNK     EQU   COMMON+988                                               02812000
@NM00040 EQU   COMMON+972                                               02813000
@NM00039 EQU   COMMON+915                                               02814000
@NM00038 EQU   HEXTABL                                                  02815000
@NM00037 EQU   TABLE                                                    02816000
CAPTABL  EQU   COMMON+403                                               02817000
TITLEPGE EQU   COMMON+394                                               02818000
@NM00036 EQU   COMMON+392                                               02819000
TITLETME EQU   COMMON+379                                               02820000
@NM00035 EQU   COMMON+377                                               02821000
TITLEDTE EQU   COMMON+364                                               02822000
@NM00034 EQU   COMMON+362                                               02823000
TITLEMOD EQU   COMMON+347                                               02824000
TITLEMSG EQU   COMMON+283                                               02825000
MSG2     EQU   COMMON+257                                               02826000
MSG1     EQU   COMMON+231                                               02827000
STOP     EQU   COMMON+227                                               02828000
TITLE    EQU   COMMON+222                                               02829000
BLANKS   EQU   COMMON+214                                               02830000
@NM00033 EQU   COMMON+130                                               02831000
@NM00032 EQU   PRSW                                                     02832000
@NM00031 EQU   PRSW                                                     02833000
PRNTREAL EQU   PRSW                                                     02834000
PRNTRL   EQU   PRSW                                                     02835000
TTLSW    EQU   PRSW                                                     02836000
@NM00030 EQU   PRSW                                                     02837000
QSEGTBSW EQU   PRSW                                                     02838000
@NM00029 EQU   PRSW                                                     02839000
@NM00028 EQU   BUFSW                                                    02840000
PREFM    EQU   BUFSW                                                    02841000
@NM00027 EQU   BUFSW                                                    02842000
@NM00026 EQU   BUFSW                                                    02843000
@NM00025 EQU   BUFSW                                                    02844000
@NM00024 EQU   BUFSW                                                    02845000
@NM00023 EQU   BUFSW                                                    02846000
@NM00022 EQU   BUFSW                                                    02847000
@NM00021 EQU   SWF                                                      02848000
QUT1LOD  EQU   SWF                                                      02849000
@NM00020 EQU   SWF                                                      02850000
PAGEOK   EQU   SWF                                                      02851000
DMPIC    EQU   SWF                                                      02852000
QSADMP   EQU   SWF                                                      02853000
NUCTFRMC EQU   SWF                                                      02854000
QPRDINIT EQU   SWF                                                      02855000
@NM00019 EQU   SWE                                                      02856000
@NM00018 EQU   SWE                                                      02857000
@NM00017 EQU   SWE                                                      02858000
BUILDMAP EQU   SWE                                                      02859000
TITLESW  EQU   SWE                                                      02860000
RESPC    EQU   SWE                                                      02861000
@NM00016 EQU   SWE                                                      02862000
STOPSW   EQU   SWE                                                      02863000
@NM00015 EQU   SWD                                                      02864000
GPRSFND  EQU   SWD                                                      02865000
CONTSW   EQU   SWD                                                      02866000
NOLOADSW EQU   SWD                                                      02867000
NOSTDMG  EQU   SWD                                                      02868000
@NM00014 EQU   SWD                                                      02869000
@NM00013 EQU   SWD                                                      02870000
FLSHMODE EQU   SWD                                                      02871000
@NM00012 EQU   SWC                                                      02872000
@NM00011 EQU   SWC                                                      02873000
SEGRD    EQU   SWC                                                      02874000
EDITSW   EQU   SWC                                                      02875000
TREADIN  EQU   SWC                                                      02876000
POSITSW  EQU   SWC                                                      02877000
SETFLSH  EQU   SWC                                                      02878000
MSTRSW   EQU   SWC                                                      02879000
@NM00010 EQU   SWB                                                      02880000
@NM00009 EQU   SWB                                                      02881000
QSYSUT2  EQU   SWB                                                      02882000
ENDSW    EQU   SWB                                                      02883000
@NM00008 EQU   SWB                                                      02884000
@NM00007 EQU   SWB                                                      02885000
FMTERR   EQU   SWB                                                      02886000
IOERR    EQU   SWB                                                      02887000
SETCVTSW EQU   SWA                                                      02888000
@NM00006 EQU   SWA                                                      02889000
GOSW     EQU   SWA                                                      02890000
@NM00005 EQU   SWA                                                      02891000
@NM00004 EQU   SWA                                                      02892000
@NM00003 EQU   SWA                                                      02893000
@NM00002 EQU   SWA                                                      02894000
LINENUM  EQU   COMMON+120                                               02895000
LINENUMB EQU   COMMON+118                                               02896000
SIXTEEN  EQU   COMMON+116                                               02897000
TWELVE   EQU   COMMON+114                                               02898000
ELEVEN   EQU   COMMON+112                                               02899000
HTEN     EQU   COMMON+110                                               02900000
EIGHT    EQU   COMMON+108                                               02901000
SEVEN    EQU   COMMON+106                                               02902000
FIVE     EQU   COMMON+104                                               02903000
FOUR     EQU   COMMON+102                                               02904000
THREE    EQU   COMMON+100                                               02905000
TWO      EQU   COMMON+98                                                02906000
ONEA     EQU   COMMON+96                                                02907000
READTM   EQU   COMMON+92                                                02908000
RDERCNT  EQU   COMMON+88                                                02909000
READNO   EQU   COMMON+84                                                02910000
RDENTRY  EQU   COMMON+80                                                02911000
@NM00001 EQU   COMMON+79                                                02912000
RETCODE  EQU   COMMON+78                                                02913000
FILESEQ  EQU   COMMON+76                                                02914000
INDD     EQU   COMMON+68                                                02915000
STORSIZE EQU   COMMON+64                                                02916000
PCBPTR   EQU   COMMON+60                                                02917000
CVTADDR  EQU   COMMON+56                                                02918000
TCBLIST  EQU   COMMON+52                                                02919000
PAGENUMB EQU   COMMON+44                                                02920000
LINECNT  EQU   COMMON+40                                                02921000
SIX      EQU   COMMON+36                                                02922000
NUCTOP   EQU   COMMON+32                                                02923000
WORK1    EQU   COMMON+24                                                02924000
KYWDEND  EQU   COMMON+16                                                02925000
KYWDBGN  EQU   COMMON+12                                                02926000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02927000
@RC00059 EQU   FDSBGN                                                   02928000
@RC00084 EQU   @RC00077                                                 02929000
@RC00082 EQU   @RC00077                                                 02930000
@RC00080 EQU   @RC00077                                                 02931000
@RC00078 EQU   @RC00077                                                 02932000
@RF00100 EQU   @EL00001                                                 02933000
ENDRDVB  EQU   @EL00002                                                 02934000
ENDVRBT  EQU   @EL00003                                                 02935000
ENDHC    EQU   @EL00004                                                 02936000
@RT00232 EQU   @RC00224                                                 02937000
@RC00225 EQU   @RC00224                                                 02938000
@RT00246 EQU   @RC00235                                                 02939000
@RC00239 EQU   @RC00235                                                 02940000
@RC00267 EQU   @RC00264                                                 02941000
@RC00265 EQU   @RC00264                                                 02942000
@RF00271 EQU   @RC00264                                                 02943000
@RC00322 EQU   @RC00293                                                 02944000
@RC00294 EQU   @RC00293                                                 02945000
@RC00359 EQU   @RC00356                                                 02946000
@RC00438 EQU   @RC00437                                                 02947000
ENDSTOR  EQU   @EL00005                                                 02948000
@RF00508 EQU   @EL00006                                                 02949000
ENDEQUAT EQU   @EL00007                                                 02950000
@RC00648 EQU   @EL00011                                                 02951000
@RC00646 EQU   @EL00011                                                 02952000
@RF00674 EQU   @EL00013                                                 02953000
@RC00691 EQU   @EL00014                                                 02954000
@RC00105 EQU   ENDRDVB                                                  02955000
@RC00142 EQU   ENDVRBT                                                  02956000
@RC00304 EQU   @RC00294                                                 02957000
@RF00468 EQU   ENDSTOR                                                  02958000
@RF00548 EQU   ENDEQUAT                                                 02959000
@RC00556 EQU   ENDEQUAT                                                 02960000
@RC00151 EQU   @RC00142                                                 02961000
@RC00149 EQU   @RC00142                                                 02962000
@RC00147 EQU   @RC00142                                                 02963000
@RC00145 EQU   @RC00142                                                 02964000
@RC00143 EQU   @RC00142                                                 02965000
@RC00311 EQU   @RC00304                                                 02966000
@RC00557 EQU   @RC00556                                                 02967000
@RC00560 EQU   @RC00557                                                 02968000
@RC00561 EQU   @RC00560                                                 02969000
@ENDDATA EQU   *                                                        02970000
         END   AMDPRFDS,(C'PLS1941',0701,76265)                         02971000
