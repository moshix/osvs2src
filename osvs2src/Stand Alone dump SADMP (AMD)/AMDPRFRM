         TITLE ' AMDPRFRM-CONTROL RTN                                  *00001000
                        '                                               00002000
AMDPRFRM CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'AMDPRFRM  76.211'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@11                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
         EQUATES                                                        00018000
         COMMON                    AMDPRCOM MAPPING MACRE               00019000
         USING COMMON,COMBASE      BASE COMMON CSECT                    00020000
         SYNEPS                    MAPPING MACRO FOR ENTRY POINTS OF    00021000
*                                  AMDPRSYN                             00022000
AMDPRFRM  CSECT                    RESTART AMDPRFRM                     00023000
*   AEDITCBR=AEDITCB;               /* POINT TO AMDPRTAB             */ 00024000
         L     AEDITCBR,AEDITCB                                    0081 00025000
*   FRM='1'B;                       /* INDICATE AMDPRFRM IN CONTROL  */ 00026000
         OI    FRM(AEDITCBR),B'00000010'                           0082 00027000
*   FRMSWITC='00'X;                 /* INIT ALL SWITCHES             */ 00028000
         MVI   FRMSWITC,X'00'                                      0083 00029000
*   AFRMAD=ADDR(FRMATAB);           /* STORE ADDRESS OF FRM ADDR   0084 00030000
*                                      TABLE IN AMDPRTAB           0084 00031000
*                                      (COMMUNICATIONS AREA FOR ALL     00032000
*                                      OF EDIT)                      */ 00033000
         LA    @14,FRMATAB                                         0084 00034000
         ST    @14,AFRMAD(,AEDITCBR)                               0084 00035000
*   AFMG=APRFMG;                    /* SET ADDRESS OF EDIT EXECUTION    00036000
*                                      MESSAGE CSECT IN AMDPRTAB     */ 00037000
         L     @14,APRFMG                                          0085 00038000
         ST    @14,AFMG(,AEDITCBR)                                 0085 00039000
*/*  OBTAIN CORE FOR PARM LIST WORK AREA                       Y02014*/ 00040000
*                                                                  0086 00041000
*   GEN(GETMAIN EC,LV=256,A=ADDRHOLD);                             0086 00042000
         GETMAIN EC,LV=256,A=ADDRHOLD                                   00043000
*   IF REG15^=0 THEN                /* SUCCESSFUL              Y02014*/ 00044000
         LTR   REG15,REG15                                         0087 00045000
         BZ    @RF00087                                            0087 00046000
*     DO;                                                          0088 00047000
*       GEN(USING SYNTAX,R15);      /* BASE EP OF MSG WTR      Y02014*/ 00048000
         USING SYNTAX,R15                                               00049000
*       SYNMSGA=ADDR(AMDPRE14);     /* PT TO AMD151I           Y02014*/ 00050000
         L     @14,AFMG(,AEDITCBR)                                 0090 00051000
         LA    @14,AMDPRE14(,@14)                                  0090 00052000
         ST    @14,SYNMSGA                                         0090 00053000
*       GEN(OI SWD,NOSTDMG);        /* INDICATE NO PRDMP MSG   Y02014*/ 00054000
         OI SWD,NOSTDMG                                                 00055000
*       REG15=ASYNTAX;              /* PT TO MSG WRITER        Y02014*/ 00056000
         L     REG15,ASYNTAX                                       0092 00057000
*       CALL SYNTAXA;               /* CALL MSG WRITER         Y02014*/ 00058000
         BAL   @14,SYNTAXA                                         0093 00059000
*       GOTO OUT;                   /* TERMINATE EDIT          Y02014*/ 00060000
         B     OUT                                                 0094 00061000
*     END;                                                         0095 00062000
*   REENTWKA=ADDRHOLD;              /* PLACE ADDR IN PRTAB     Y02014*/ 00063000
@RF00087 L     @14,ADDRHOLD                                        0096 00064000
         ST    @14,REENTWKA(,AEDITCBR)                             0096 00065000
*   GEN(LOAD EP=AMDPRFMT);          /* LOAD FORMATTING ROUTINE Y02014*/ 00066000
         LOAD EP=AMDPRFMT                                               00067000
*   PRFMTADD=REG0;                  /* SAVE ADDRESS IN PRTAB   Y02014*/ 00068000
         ST    REG0,PRFMTADD(,AEDITCBR)                            0098 00069000
*   STOPSAVE=STOPEXIT;              /* SAVE CALLER'S STOP ROUTINE  0099 00070000
*                                      ADDR                          */ 00071000
         L     @14,STOPEXIT                                        0099 00072000
         ST    @14,STOPSAVE                                        0099 00073000
*   STOPEXIT=ADDR(FRMSTOP);         /* ESTABLISH STOP EXIT FOR EDIT  */ 00074000
         LA    @14,FRMSTOP                                         0100 00075000
         ST    @14,STOPEXIT                                        0100 00076000
*   DRIVER='0000'X;                 /* CLEAR DRIVER STRING           */ 00077000
         MVC   DRIVER(2),@CB00374                                  0101 00078000
*   DRVGET='1'B;                    /* SET UP DRIVER FOR CALLGET     */ 00079000
         OI    DRVGET,B'00000001'                                  0102 00080000
*   DRVPOSIT='1'B;                  /* AND POSIT                     */ 00081000
         OI    DRVPOSIT,B'00100000'                                0103 00082000
*                                                                  0104 00083000
*/********************************************************************  00084000
*                                                                    */ 00085000
*/*                                                                  */ 00086000
*/*  SELECT-ROUTINE.  ROUTINE IS SELECTED IF CORRESPONDING DRIVER BIT*/ 00087000
*/*  IS ON.  DRIVER IS SCANNED HIGH-TO-LOW ORDER BITS, SO THIS IS    */ 00088000
*/*  THE PRIORITY IN WHICH ROUTINES ARE EXECUTED.                    */ 00089000
*/*                                                                  */ 00090000
*/********************************************************************  00091000
*                                                                    */ 00092000
*                                                                  0104 00093000
*   RFY                                                            0104 00094000
*    (REG4,                                                        0104 00095000
*     REG5,                                                        0104 00096000
*     REG6) RSTD;                   /* REGISTER USAGE IN SELECT-   0104 00097000
*                                      ROUTINE PROCESSING: REG 4 - 0104 00098000
*                                      MASK FOR SELECTION BIT ON IS     00099000
*                                      TO BE SELECTED IF CORRES-   0104 00100000
*                                      PONDING BIT IS ON IN DRIVER 0104 00101000
*                                      REG 5 - INDEX INTO SELECTION     00102000
*                                      BRANCH TABLE REG 6 - WORK REG    00103000
*                                      IN WHICH MASK IS AND-ED WITH     00104000
*                                      DRIVER                        */ 00105000
*   GEN;                                                           0105 00106000
STARTSEL  LA   R4,256            INIT MASK FOR HIGHEST PRIORITY         00107000
*                                  ROUTINE                              00108000
          SR   R5,R5               CLEAR BRANCH TABLE INDEX REG         00109000
SELECT    LH   R6,DRIVER           PICK UP DRIVER - SOME ROUTINE MAY    00110000
*                                  HAVE CHANGED DRIVER VALUE            00111000
          NR   R6,R4               AND WITH MASK TO MAKE ROUTINE        00112000
*                                  SELECTION                            00113000
*                                  IF RESULT IS ZERO, NO ROUTINE WAS    00114000
          BZ   NEXTRTN             SELECTED, SO BRANCH TO TRY NEXT      00115000
*                                  LOWER PRIORITY ROUTINE               00116000
          B    RTNTAB(R5)          BRANCH TABLE FOR ROUTINE SELECTION   00117000
*                                  INDEX VALUE (OPPOSITE PRIORITY)      00118000
RTNTAB    B    CALLGET             0 - LINK TO AMDPRGET                 00119000
          B    TERMEDIT            4 - GO EXIT                          00120000
          B    VALIDITY            8 - CHECK FOR GTF RECORD             00121000
          B    POSIT               12 - POSITION BY VALUE OF START=     00122000
*                                       PARAMETER '1'B EDIT CARD        00123000
          B    DUMP                16 - INIT FOR PROCESSING GTF BUFFERS 00124000
*                                       IN DUMP DATA SET                00125000
          B    EXTERNAL            20 - INIT FOR PROCESSING GTF         00126000
*                                       EXTERNAL TRACE                  00127000
          B    PRNTITLE            24 - GO TITLE EDIT OUTPUT            00128000
          B    CALLCON             28 - LINK TO AMDPRCON                00129000
          B    CALLFLT             32 - LINK TO AMDPRFLT                00130000
*                                  END OF BRANCH TABLE                  00131000
NEXTRTN   SRA  R4,1                SHIFT MASK TO BIT FOR NEXT LOWER     00132000
*                                  PRIORITY SUBROUTINE                  00133000
          BZ   STARTSEL            TEST CONDITION CODE FOR ZERO RESULT  00134000
*                                  WHICH INDICATES MASK EXHAUSTED AND   00135000
*                                  HENCE END OF CYCLE - BRANCH TO START 00136000
*                                  NEW CYCLE                            00137000
          LA   R5,4(R5)            INCREMENT ROUTINE SELECTION INDEX    00138000
          B    SELECT              IF MASK NOT ZERO, BRANCH TO TRY FOR  00139000
*                                  NEXT LOWER PRIORITY ROUTINE          00140000
*   RFY                                                            0106 00141000
*    (REG6) UNRSTD;                                                0106 00142000
*                                                                  0107 00143000
*/********************************************************************  00144000
*                                                                    */ 00145000
*/*                                                                  */ 00146000
*/*  EDIT STOP EXIT ROUTINE.  SHUT DOWN EDIT AFTER OPERATOR RESPONSE */ 00147000
*/*  TO MESSAGE AMD156I.                                             */ 00148000
*/*                                                                  */ 00149000
*/********************************************************************  00150000
*                                                                    */ 00151000
*                                                                  0107 00152000
*   GEN;                                                           0107 00153000
         USING *,R15                                                    00154000
FRMSTOP  LA    R13,@SA00001        POINT TO FRM SAVE AREA        Y02014 00155000
*                                  ***  SAVE AREA LABEL BSL DEPENDENT   00156000
         LM    R14,R12,12(R13)     RE-LOAD REGISTERS                    00157000
         DROP  R15                 GO BACK TO OLD BASE                  00158000
         USING SYNTAX,R15          BASE EP-S OF MESSAGE WRITER FOR      00159000
*                                  HERE FOLLOWING                       00160000
*   EDITSTOP='1'B;                  /* INDICATE EDIT STOP IN PROGRESS*/ 00161000
*   TERM='1'B;                      /* REQUEST EDIT TERMINATION      */ 00162000
         OI    EDITSTOP(AEDITCBR),B'01000010'                      0109 00163000
*   DRVGET='1'B;                    /* RESET DRIVER TO CALL GET AND  */ 00164000
         OI    DRVGET,B'00000001'                                  0110 00165000
*   DRVTERM='1'B;                   /* CALL FRM TERM ROUTINE         */ 00166000
         OI    DRVTERM,B'10000000'                                 0111 00167000
*   GEN(NI SWC,255-EDITSW);         /* EDIT NO LONGER IN CONTROL     */ 00168000
         NI SWC,255-EDITSW                                              00169000
*   GO TO STARTSEL;                 /* ENTER ROUTINE SELECTION AT TOP*/ 00170000
         B     STARTSEL                                            0113 00171000
*                                                                  0114 00172000
*/********************************************************************  00173000
*                                                                    */ 00174000
*/*                                                                  */ 00175000
*/*                          CALL AMDPRGET                           */ 00176000
*/*                                                                  */ 00177000
*/********************************************************************  00178000
*                                                                    */ 00179000
*                                                                  0114 00180000
*CALLGET:                                                          0114 00181000
*   CALL PRGET;                     /* CALL AMDPRGET                 */ 00182000
CALLGET  L     @15,AGET                                            0114 00183000
         BALR  @14,@15                                             0114 00184000
*   IF TERM='1'B THEN               /* IF TERMINATION HAS BEEN     0115 00185000
*                                      REQUESTED BY AMDPRGET,        */ 00186000
         TM    TERM(AEDITCBR),B'01000000'                          0115 00187000
         BNO   @RF00115                                            0115 00188000
*     DRVTERM='1'B;                 /* SET DRIVER BIT FOR AMDPRFRM 0116 00189000
*                                      TERM ROUTINE SO THAT EDIT   0116 00190000
*                                      PROCESSING STOPS              */ 00191000
         OI    DRVTERM,B'10000000'                                 0116 00192000
*   GO TO NEXTRTN;                  /* RETURN TO ROUTINE SELECTION   */ 00193000
         B     NEXTRTN                                             0117 00194000
*/********************************************************************  00195000
*                                                                    */ 00196000
*/*                                                                  */ 00197000
*/*  TERMINATE EDIT.  THIS ROUTINE IS ENTERED TO STOP EDIT PROCESSING*/ 00198000
*/*  AND RETURN TO AMDPRDMP.                                         */ 00199000
*/*                                                                  */ 00200000
*/********************************************************************  00201000
*                                                                    */ 00202000
*                                                                  0118 00203000
*TERMEDIT:                                                         0118 00204000
*   IF EDITSTOP='1'B THEN           /* TEST FOR STOP REQUESTED BY  0118 00205000
*                                      OPERATOR                      */ 00206000
TERMEDIT TM    EDITSTOP(AEDITCBR),B'00000010'                      0118 00207000
         BNO   @RF00118                                            0118 00208000
*     DO;                           /* IN THIS CASE, RESTORE CALLER-S   00209000
*                                      STOP ROUTINE ADDR AND BRANCH     00210000
*                                      TO IT                         */ 00211000
*       GEN(DELETE EP=AMDPRFMT);    /* DELETE FORMAT RTN       Y02014*/ 00212000
         DELETE EP=AMDPRFMT                                             00213000
*       REG15=STOPSAVE;             /* POINT TO CALLER-S ROUTINE     */ 00214000
         L     REG15,STOPSAVE                                      0121 00215000
*       STOPEXIT=REG15;             /* RESTORE THIS ADDRESS IN     0122 00216000
*                                      AMDPRCOM                      */ 00217000
         ST    REG15,STOPEXIT                                      0122 00218000
*       GEN(BR  R15);               /* BRANCH TO CALLER-S STOP     0123 00219000
*                                      ROUTINE                       */ 00220000
         BR  R15                                                        00221000
*     END;                                                         0124 00222000
*                                                                  0124 00223000
*   /*****************************************************************/ 00224000
*   /*                                                               */ 00225000
*   /* IF END-OF-FILE IS REACHED DURING POSITIONING, POSIT. HAS      */ 00226000
*   /* FAILED                                                        */ 00227000
*   /*                                                               */ 00228000
*   /*****************************************************************/ 00229000
*                                                                  0125 00230000
*   IF DRVPOSIT='1'B&EXTTRC='1'B&GETEOF='1'B&STARTIME^='            '   00231000
*     THEN                          /* VERIFY START SPECIFIED        */ 00232000
@RF00118 TM    DRVPOSIT,B'00100000'                                0125 00233000
         BNO   @RF00125                                            0125 00234000
         TM    EXTTRC(AEDITCBR),B'00000100'                        0125 00235000
         BNO   @RF00125                                            0125 00236000
         TM    GETEOF(AEDITCBR),B'10000000'                        0125 00237000
         BNO   @RF00125                                            0125 00238000
         CLC   STARTIME(12,AEDITCBR),@CC00379                      0125 00239000
         BE    @RF00125                                            0125 00240000
*NOTIMEMG:                                                         0126 00241000
*     DO;                           /* ISSUE MESSAGE AMD226I         */ 00242000
NOTIMEMG DS    0H                                                  0127 00243000
*       SYNMSGA=ADDR(AMDPRE02);     /* POINT TO ADDR OF MESSAGE    0127 00244000
*                                      AMD226I IN AMDPRFMG           */ 00245000
         L     @14,AFMG(,AEDITCBR)                                 0127 00246000
         LA    @14,AMDPRE02(,@14)                                  0127 00247000
         ST    @14,SYNMSGA                                         0127 00248000
*       GEN(OI  SWD,NOSTDMG);       /* INDICATE STANDARD MESSAGE   0128 00249000
*                                      AMD165I IS NOT REQUIRED       */ 00250000
         OI  SWD,NOSTDMG                                                00251000
*       REG15=ASYNTAX;              /* POINT TO MESSAGE WRITER       */ 00252000
         L     REG15,ASYNTAX                                       0129 00253000
*       CALL SYNTAXA;               /* CALL MESSAGE WRITER - AMDPRSYN*/ 00254000
         BAL   @14,SYNTAXA                                         0130 00255000
*     END NOTIMEMG;                                                0131 00256000
*   IF EXTITLE='1'B THEN            /* IF EXTERNAL TRACE WAS       0132 00257000
*                                      PROCESSED,                    */ 00258000
@RF00125 TM    EXTITLE,B'10000000'                                 0132 00259000
         BNO   @RF00132                                            0132 00260000
*     TITLEMOD=TITLSAVE;            /* AMDPRDMP-S PAGE TITLE MUST BE    00261000
*                                      RESTORED                      */ 00262000
         MVC   TITLEMOD(47),TITLSAVE                               0133 00263000
*   GEN(DELETE EP=AMDPRFMT);        /* DELETE FORMAT RTN             */ 00264000
@RF00132 DS    0H                                                  0134 00265000
         DELETE EP=AMDPRFMT                                             00266000
*OUT:                                                              0135 00267000
*   FRM='0'B;                       /* TURN OFF AMDPRFRM PATH FLAG   */ 00268000
OUT      NI    FRM(AEDITCBR),B'11111101'                           0135 00269000
*   STOPEXIT=STOPSAVE;              /* RESTORE CALLERS STOP A51748   */ 00270000
         L     @14,STOPSAVE                                        0136 00271000
         ST    @14,STOPEXIT                                        0136 00272000
*   RETURN;                         /* RETURN TO AMDPRCTL IN AMDPRDMP   00273000
*                                      EDIT DONE                     */ 00274000
@EL00001 L     @13,4(,@13)                                         0137 00275000
@EF00001 DS    0H                                                  0137 00276000
@ER00001 LM    @14,@12,12(@13)                                     0137 00277000
         BR    @14                                                 0137 00278000
*                                                                  0138 00279000
*/********************************************************************  00280000
*                                                                    */ 00281000
*/*                                                                  */ 00282000
*/*  VALIDITY.  VERIFY THAT TRACE RECORD READ IS FROM GTF AND ROUTE  */ 00283000
*/*  TO AMDPRFLT OR AMDPRCON                                         */ 00284000
*/*                                                                  */ 00285000
*/********************************************************************  00286000
*                                                                    */ 00287000
*/* TEST FOR NON-TRACE CONTROL RECORD                                */ 00288000
*                                                                  0138 00289000
*VALIDITY:                                                         0138 00290000
*   IF RECAID='00'X THEN                                           0138 00291000
*                                                                  0138 00292000
VALIDITY L     @14,CURREC(,AEDITCBR)                               0138 00293000
         CLI   RECAID(@14),X'00'                                   0138 00294000
         BNE   @RF00138                                            0138 00295000
*     /***************************************************************/ 00296000
*     /*                                                             */ 00297000
*     /* TIME-STAMP AND LOST-DATA RECORD PROCESSING                  */ 00298000
*     /*                                                             */ 00299000
*     /***************************************************************/ 00300000
*                                                                  0139 00301000
*NONTRC:                                                           0139 00302000
*     DO;                                                          0139 00303000
NONTRC   DS    0H                                                  0140 00304000
*       IF RECFID='01'X THEN        /* TIME-STAMP RECORD             */ 00305000
         L     @14,CURREC(,AEDITCBR)                               0140 00306000
         CLI   RECFID(@14),X'01'                                   0140 00307000
         BNE   @RF00140                                            0140 00308000
*TIMEREC:                                                          0141 00309000
*         DO;                                                      0141 00310000
*                                                                  0141 00311000
TIMEREC  DS    0H                                                  0142 00312000
*           /*********************************************************/ 00313000
*           /*                                                       */ 00314000
*           /* TEST STOP-TIME TO DETERMINE IF ALL RECORDS HAVE BEEN  */ 00315000
*           /* PROCESSED - FIRST MUST CHECK IF STOP-TIME HAS BEEN    */ 00316000
*           /* SPECIFIED. IF NOT STOP-TIME NOT SPECIFIED OR NOT      */ 00317000
*           /* PASSED, BRANCH TO CHANNEL RECORD TO AMDPRCON.         */ 00318000
*           /*                                                       */ 00319000
*           /*********************************************************/ 00320000
*                                                                  0142 00321000
*           IF STOPTIME='            ' THEN                        0142 00322000
         CLC   STOPTIME(12,AEDITCBR),@CC00379                      0142 00323000
         BE    @RT00142                                            0142 00324000
*             GO TO CONOUT;                                        0143 00325000
*           RFY                                                    0144 00326000
*            (WREG2) RSTD;                                         0144 00327000
*           ADCVTTZ=ADDR(RECVTTZ);  /* ADDR CVT TIME ZONE VALUE      */ 00328000
         L     @14,CURREC(,AEDITCBR)                               0145 00329000
         LA    @10,RECVTTZ(,@14)                                   0145 00330000
         ST    @10,ADCVTTZ                                         0145 00331000
*           ADTODCLK=ADDR(RECTOD);  /* ADDR TOD VALUE                */ 00332000
         LA    @14,RECTOD(,@14)                                    0146 00333000
         ST    @14,ADTODCLK                                        0146 00334000
*           ADTMEBUF=ADDR(TMEBUF);  /* ADDR OUTPUT AREA              */ 00335000
         LA    @14,TMEBUF                                          0147 00336000
         ST    @14,ADTMEBUF                                        0147 00337000
*           PARMREG=ADDR(TIMEPARM); /* ADDR PARM LIST IN R 1         */ 00338000
         LA    PARMREG,TIMEPARM                                    0148 00339000
*           WREG2=1;                /* CONVERT TO FULL TIME          */ 00340000
         LA    WREG2,1                                             0149 00341000
*           CALL TODCNVRT;          /* CALL TOD CONVERSION RTN       */ 00342000
*                                                                  0150 00343000
         L     @15,QATMERTN                                        0150 00344000
         BALR  @14,@15                                             0150 00345000
*           /*********************************************************/ 00346000
*           /*                                                       */ 00347000
*           /* MOVE INTO SAVE AREA TIME VALUE IN CURRENT REC         */ 00348000
*           /*                                                       */ 00349000
*           /*********************************************************/ 00350000
*                                                                  0151 00351000
*           DSAV=DAYYR;                                            0151 00352000
         MVC   DSAV(3),DAYYR                                       0151 00353000
*           TSAV(1:2)=TOD(1:2);                                    0152 00354000
         MVC   TSAV(2),TOD                                         0152 00355000
*           TSAV(3:4)=TOD(4:5);                                    0153 00356000
         MVC   TSAV+2(2),TOD+3                                     0153 00357000
*           TSAV(5:6)=TOD(7:8);                                    0154 00358000
*                                                                  0154 00359000
         MVC   TSAV+4(2),TOD+6                                     0154 00360000
*           /*********************************************************/ 00361000
*           /*                                                       */ 00362000
*           /* TEST FOR TIME OVER STOP VALUE                         */ 00363000
*           /*                                                       */ 00364000
*           /*********************************************************/ 00365000
*                                                                  0155 00366000
*           IF ESTOPTME<TIMSAVE THEN                               0155 00367000
         CLC   ESTOPTME(9,AEDITCBR),TIMSAVE                        0155 00368000
         BNL   @RF00155                                            0155 00369000
*TSTOP:                                                            0156 00370000
*             DO;                   /* STOP BECAUSE TIME LIMIT Y3316 */ 00371000
TSTOP    DS    0H                                                  0157 00372000
*               TERM='1'B;          /* SIGNAL AMDPRGET TO CLOSE DOWN */ 00373000
         OI    TERM(AEDITCBR),B'01000000'                          0157 00374000
*               GO TO NEXTRTN;      /* BRANCH BACK TO ROUTINE      0158 00375000
*                                      SELECT-N                      */ 00376000
         B     NEXTRTN                                             0158 00377000
*             END TSTOP;                                           0159 00378000
*           ELSE                                                   0160 00379000
*             GO TO CONOUT;         /* STOP-TIME HAS NOT PASSED -  0160 00380000
*                                      SEND RECORD TO CALLCON        */ 00381000
*         END TIMEREC;                                             0161 00382000
*       IF RECFID='02'X|            /* LOST-DATA RECORD        Y02014*/ 00383000
*           RECFID='03'X THEN       /* LOST-BLOCK RECORD       Y02014*/ 00384000
@RF00140 L     @14,CURREC(,AEDITCBR)                               0162 00385000
         CLI   RECFID(@14),X'02'                                   0162 00386000
         BE    @RT00162                                            0162 00387000
         CLI   RECFID(@14),X'03'                                   0162 00388000
         BNE   @RF00162                                            0162 00389000
@RT00162 DS    0H                                                  0163 00390000
*LOSTREC:                                                          0163 00391000
*         DO;                                                      0163 00392000
*                                                                  0163 00393000
LOSTREC  DS    0H                                                  0164 00394000
*           /*********************************************************/ 00395000
*           /*                                                       */ 00396000
*           /* BRANCH HERE TO CHANNEL RECORD TO NON-TRACE FORMAT     */ 00397000
*           /* ROUTINE - AMDPRCON                                    */ 00398000
*           /*                                                       */ 00399000
*           /*********************************************************/ 00400000
*                                                                  0164 00401000
*CONOUT:                                                           0164 00402000
*           DRVCON='1'B;            /* TURN ON CALLCON BIT IN DRIVER */ 00403000
CONOUT   OI    DRVCON,B'00000010'                                  0164 00404000
*           GO TO NEXTRTN;          /* BRANCH BACK TO ROUTINE      0165 00405000
*                                      SELECT-N                      */ 00406000
         B     NEXTRTN                                             0165 00407000
*         END LOSTREC;                                             0166 00408000
*                                                                  0166 00409000
*       /*************************************************************/ 00410000
*       /*                                                           */ 00411000
*       /* IGNORE RECORDS WHICH ARE NOT TIME-STAMP OR LOST-DATA      */ 00412000
*       /*                                                           */ 00413000
*       /*************************************************************/ 00414000
*                                                                  0167 00415000
*       GO TO NEXTRTN;                                             0167 00416000
         B     NEXTRTN                                             0167 00417000
*     END NONTRC;                                                  0168 00418000
*                                                                  0168 00419000
*   /*****************************************************************/ 00420000
*   /*                                                               */ 00421000
*   /* TEST FOR EVENT TRACE RECORD                                   */ 00422000
*   /*                                                               */ 00423000
*   /*****************************************************************/ 00424000
*                                                                  0169 00425000
*   IF RECAID='FF'X THEN            /* TRACE RECORD -                */ 00426000
@RF00138 L     @14,CURREC(,AEDITCBR)                               0169 00427000
         CLI   RECAID(@14),X'FF'                                   0169 00428000
         BNE   @RF00169                                            0169 00429000
*     DRVFLT='1'B;                  /* CHANNEL TO AMDPRFLT           */ 00430000
*                                                                  0170 00431000
         OI    DRVFLT,B'00000001'                                  0170 00432000
*   /*****************************************************************/ 00433000
*   /*                                                               */ 00434000
*   /* BRANCH BACK TO ROUTINE SELECTION                              */ 00435000
*   /*                                                               */ 00436000
*   /*****************************************************************/ 00437000
*                                                                  0171 00438000
*   GO TO NEXTRTN;                  /* NON-GTF RECORD ARE IGNORED  0171 00439000
*                                      BECAUSE NEITHER CALLCON NOR 0171 00440000
*                                      CALLFLT HAVE BEEN TURNED ON   */ 00441000
         B     NEXTRTN                                             0171 00442000
*                                                                  0172 00443000
*/********************************************************************  00444000
*                                                                    */ 00445000
*/*                                                                  */ 00446000
*/*  POSITION TO START TIME.  IF USER HAS NOT SPECIFIED START TIME,  */ 00447000
*/*  THEN POSITION TO FIRST TIME-STAMP RECORD                        */ 00448000
*/*                                                                  */ 00449000
*/********************************************************************  00450000
*                                                                    */ 00451000
*                                                                  0172 00452000
*POSIT:                                                            0172 00453000
*   IF EXTTRC='0'B THEN             /* DUMP DATA SET           Y02014*/ 00454000
POSIT    TM    EXTTRC(AEDITCBR),B'00000100'                        0172 00455000
         BNZ   @RF00172                                            0172 00456000
*     DO;                                                          0173 00457000
*       DRVDUMP='1'B;               /* RECORD TO DUMP RTN      Y02014*/ 00458000
         OI    DRVDUMP,B'00010000'                                 0174 00459000
*       GOTO SAVEOPTS;              /* GO SAVE GTF OPT WD      Y02014*/ 00460000
         B     SAVEOPTS                                            0175 00461000
*     END;                                                         0176 00462000
*   IF RECAID^='00'X|               /* IGNORE ALL BUT TIME STAMP REC */ 00463000
*       RECFID^='01'X THEN                                         0177 00464000
@RF00172 L     @14,CURREC(,AEDITCBR)                               0177 00465000
         CLI   RECAID(@14),X'00'                                   0177 00466000
         BNE   @RT00177                                            0177 00467000
         CLI   RECFID(@14),X'01'                                   0177 00468000
         BNE   @RT00177                                            0177 00469000
*     GO TO NEXTRTN;                /* GO BACK TO ROUTINE SELECTION     00470000
*                                      TO REPEAT GET-POSIT SEQUENCE  */ 00471000
*                                                                  0178 00472000
*   /*****************************************************************/ 00473000
*   /*                                                               */ 00474000
*   /* SCREEN OUT CASE WHERE STOP TIME ISN-T IN DATA SET. IF FIRST   */ 00475000
*   /* TIME THROUGH, ISSUE ERROR MESSAGE. ON SUBSEQUENT TIMES, FORCE */ 00476000
*   /* AN END OF FILE SITUATION AND ISSUE MSG AMD226I                */ 00477000
*   /*                                                               */ 00478000
*   /*****************************************************************/ 00479000
*                                                                  0179 00480000
*   RFY                                                            0179 00481000
*    (WREG2) RSTD;                                                 0179 00482000
*   TSFOUND='1'B;                   /* TIME STAMP FOUND        Y02014*/ 00483000
         OI    TSFOUND(AEDITCBR),B'00100000'                       0180 00484000
*   ADCVTTZ=ADDR(RECVTTZ);          /* ADDR CVT TIME ZONE VALUE      */ 00485000
         LA    @10,RECVTTZ(,@14)                                   0181 00486000
         ST    @10,ADCVTTZ                                         0181 00487000
*   ADTODCLK=ADDR(RECTOD);          /* ADDR TOD VALUE                */ 00488000
         LA    @14,RECTOD(,@14)                                    0182 00489000
         ST    @14,ADTODCLK                                        0182 00490000
*   ADTMEBUF=ADDR(TMEBUF);          /* ADDR OUTPUT AREA              */ 00491000
         LA    @14,TMEBUF                                          0183 00492000
         ST    @14,ADTMEBUF                                        0183 00493000
*   PARMREG=ADDR(TIMEPARM);         /* ADDR PARM LIST IN R 1         */ 00494000
         LA    PARMREG,TIMEPARM                                    0184 00495000
*   WREG2=1;                        /* CONVERT TO FULL TIME          */ 00496000
         LA    WREG2,1                                             0185 00497000
*   CALL TODCNVRT;                  /* CALL TOD CONVERSION RTN       */ 00498000
*                                                                  0186 00499000
         L     @15,QATMERTN                                        0186 00500000
         BALR  @14,@15                                             0186 00501000
*   /*****************************************************************/ 00502000
*   /*                                                               */ 00503000
*   /* MOVE INTO SAVE AREA TIME VALUE IN CURRENT REC                 */ 00504000
*   /*                                                               */ 00505000
*   /*****************************************************************/ 00506000
*                                                                  0187 00507000
*   DSAV=DAYYR;                                                    0187 00508000
         MVC   DSAV(3),DAYYR                                       0187 00509000
*   TSAV(1:2)=TOD(1:2);                                            0188 00510000
         MVC   TSAV(2),TOD                                         0188 00511000
*   TSAV(3:4)=TOD(4:5);                                            0189 00512000
         MVC   TSAV+2(2),TOD+3                                     0189 00513000
*   TSAV(5:6)=TOD(7:8);                                            0190 00514000
*                                                                  0190 00515000
         MVC   TSAV+4(2),TOD+6                                     0190 00516000
*/* FIRST TEST FOR TIME TOO EARLY                                    */ 00517000
*                                                                  0191 00518000
*   IF STOPTIME='            ' THEN                                0191 00519000
         CLC   STOPTIME(12,AEDITCBR),@CC00379                      0191 00520000
         BE    @RT00191                                            0191 00521000
*     GO TO STARTEST;               /* DON T POSITION BY STOP TIME   */ 00522000
*   IF ESTOPTME<TIMSAVE THEN        /* STOP TIME WITHIN D S ?        */ 00523000
         CLC   ESTOPTME(9,AEDITCBR),TIMSAVE                        0193 00524000
         BNL   @RF00193                                            0193 00525000
*NOSTOP:                                                           0194 00526000
*     DO;                                                          0194 00527000
NOSTOP   DS    0H                                                  0195 00528000
*       TERM='1'B;                  /* SIGNAL GET TO CLOSE DOWN      */ 00529000
         OI    TERM(AEDITCBR),B'01000000'                          0195 00530000
*       IF STPSW='0'B THEN                                         0196 00531000
         TM    STPSW,B'01000000'                                   0196 00532000
         BNZ   @RF00196                                            0196 00533000
*         DO;                       /* TEST IF 1ST TIME THROUGH M4465*/ 00534000
*           SYNMSGA=ADDR(AMDPRE02); /* POINT TO ADDR OF MESSAGE    0198 00535000
*                                      AMD226I IN AMDPRFMG           */ 00536000
         L     @14,AFMG(,AEDITCBR)                                 0198 00537000
         LA    @14,AMDPRE02(,@14)                                  0198 00538000
         ST    @14,SYNMSGA                                         0198 00539000
*           GEN(OI   SWD,NOSTDMG);  /* INDICATE STANDARD MESSAGE   0199 00540000
*                                      AMD165I IS NOT REQUIRED       */ 00541000
         OI   SWD,NOSTDMG                                               00542000
*           REG15=ASYNTAX;          /* POINT TO MESSAGE WRITER       */ 00543000
         L     REG15,ASYNTAX                                       0200 00544000
*           CALL SYNTAXB;           /* CALL MESSAGE WRITER - AMDPRSYN*/ 00545000
         BAL   @14,SYNTAXB                                         0201 00546000
*         END;                      /* M4465                         */ 00547000
*       ELSE                                                       0203 00548000
*         GETEOF='1'B;              /* DUMMY END OF FILE M4465       */ 00549000
         B     @RC00196                                            0203 00550000
@RF00196 OI    GETEOF(AEDITCBR),B'10000000'                        0203 00551000
*       GO TO NEXTRTN;              /* BRANCH BACK TO ROUTINE      0204 00552000
*                                      SELECTION - NEXT ROUTINE WILL    00553000
*                                      BE CALLGET AND THEN TERMEDIT  */ 00554000
         B     NEXTRTN                                             0204 00555000
*     END NOSTOP;                                                  0205 00556000
*   STPSW='1'B;                     /* SET NOT 1ST TIME SW M4465     */ 00557000
*                                                                  0206 00558000
@RF00193 OI    STPSW,B'01000000'                                   0206 00559000
*   /*****************************************************************/ 00560000
*   /*                                                               */ 00561000
*   /* HAS START TIME BEEN SPECIFIED                                 */ 00562000
*   /*                                                               */ 00563000
*   /*****************************************************************/ 00564000
*                                                                  0207 00565000
*STARTEST:                                                         0207 00566000
*   IF STARTIME='            ' THEN                                0207 00567000
STARTEST CLC   STARTIME(12,AEDITCBR),@CC00379                      0207 00568000
         BE    @RT00207                                            0207 00569000
*     GO TO SETEXT;                 /* IF NOT, POSITIONING IS OK     */ 00570000
*                                                                  0208 00571000
*   /*****************************************************************/ 00572000
*   /*                                                               */ 00573000
*   /* IF START-TIME HAS BEEN SPECIFIED, TEST FOR RECORD-TIME LESS   */ 00574000
*   /* THAN START-TIME - 1-ST TEST FOR DAY OF TIME STAMP RECORD NOT  */ 00575000
*   /* UP TO START VALUE                                             */ 00576000
*   /*                                                               */ 00577000
*   /*****************************************************************/ 00578000
*                                                                  0209 00579000
*   IF TIMSAVE<ESTARTME THEN        /* COMPARE REC TIME TO START TIME*/ 00580000
         CLC   TIMSAVE(9),ESTARTME(AEDITCBR)                       0209 00581000
         BL    @RT00209                                            0209 00582000
*     GO TO NEXTRTN;                /* IF SO, BRANCH TO ROUTINE    0210 00583000
*                                      SELECTION SO THAT GET-POSIT 0210 00584000
*                                      SEQUENCE IS REPEATED          */ 00585000
*/* BRANCH HERE TO CHANNEL RECORD TO EXTERNAL DATA SET SET-UP        */ 00586000
*                                                                  0211 00587000
*SETEXT:                                                           0211 00588000
*   DRVEXT='1'B;                    /* SET EXTERNAL IN DRIVER        */ 00589000
SETEXT   OI    DRVEXT,B'00001000'                                  0211 00590000
*/* SAVE GTF OPTIONS IN EFFECT                                       */ 00591000
*                                                                  0212 00592000
*SAVEOPTS:                                                         0212 00593000
*   OPTSAVE=RECGTFOP;                                              0212 00594000
SAVEOPTS L     @14,CURREC(,AEDITCBR)                               0212 00595000
         MVC   OPTSAVE(4),RECGTFOP(@14)                            0212 00596000
*   GTFWDPTR=ADDR(OPTSAVE);         /* POINT TAB TO OPTION WORD SAVE    00597000
*                                      AREA                    Y02014*/ 00598000
         LA    @10,OPTSAVE                                         0213 00599000
         ST    @10,GTFWDPTR(,AEDITCBR)                             0213 00600000
*   CVTTZONE=RECVTTZ;               /* SAVE TIME ZONE FIELD    Y02014*/ 00601000
         MVC   CVTTZONE(4,AEDITCBR),RECVTTZ(@14)                   0214 00602000
*   DRVTITLE='1'B;                  /* REQUEST TITLING OF FIRST PAGE */ 00603000
*   DRVCON='1'B;                    /* TURN ON CALLCON SO THAT     0216 00604000
*                                      CURRENT RECORD IS FORMATTED   */ 00605000
*   DRVVALID='1'B;                  /* VALIDITY TO GET CONTROL ON ALL   00606000
*                                      SUBSEQUENT RECORDS            */ 00607000
*   DRVPOSIT='0'B;                  /* TURN OFF BIT FOR THIS ROUTINE    00608000
*                                      - POSITIONING NOW COMPLETE    */ 00609000
         OI    DRVTITLE,B'01000110'                                0218 00610000
         NI    DRVPOSIT,B'11011111'                                0218 00611000
*   GO TO NEXTRTN;                  /* GO SELECT NEXT ROUTINE        */ 00612000
         B     NEXTRTN                                             0219 00613000
*                                                                  0220 00614000
*/********************************************************************  00615000
*                                                                    */ 00616000
*/*                                                                  */ 00617000
*/*  DUMP.  SET GENERAL FLAGS FOR AMDPRAPP.                          */ 00618000
*/*                                                                  */ 00619000
*/********************************************************************  00620000
*                                                                    */ 00621000
*                                                                  0220 00622000
*DUMP:                                                             0220 00623000
*   IF OPTSYSM='1'B THEN                                           0220 00624000
DUMP     L     @14,GTFWDPTR(,AEDITCBR)                             0220 00625000
         TM    OPTSYSM(@14),B'10000000'                            0220 00626000
         BNO   @RF00220                                            0220 00627000
*     DO;                           /* TRACE DATA SYSM FORMAT, Y02014*/ 00628000
*       SYSM='1'B;                  /* INDICATE SUCH IN PRTAB        */ 00629000
         OI    SYSM(AEDITCBR),B'00010000'                          0222 00630000
*       IF JOBNAMES(1)^='        ' THEN/* JOB SELECTION REQUESTED    */ 00631000
         CLC   JOBNAMES(8,AEDITCBR),@CC00413                       0223 00632000
         BNE   @RT00223                                            0223 00633000
*         GO TO ASKOP;              /* YES GO ASK OPERATOR     Y02014*/ 00634000
*     END;                          /*                         Y02014*/ 00635000
*   ELSE                                                           0226 00636000
*     SYS='1'B;                     /* OTHERWISE, INDICATE FULL    0226 00637000
*                                      SYSTEM FORMAT                 */ 00638000
         B     @RC00220                                            0226 00639000
@RF00220 OI    SYS(AEDITCBR),B'00100000'                           0226 00640000
*DUMPEXT:                           /* RETURN FROM ASKING OPERATOR 0227 00641000
*                                                              Y02014*/ 00642000
*   DRVDUMP='0'B;                   /* DUMP SET-UP COMPLETE          */ 00643000
@RC00220 DS    0H                                                  0227 00644000
DUMPEXT  NI    DRVDUMP,B'11101111'                                 0227 00645000
*   GO TO NEXTRTN;                  /* GO BACK TO SELECT NEXT ROUTINE*/ 00646000
         B     NEXTRTN                                             0228 00647000
*                                                                  0229 00648000
*/********************************************************************  00649000
*                                                                    */ 00650000
*/*                                                                  */ 00651000
*/*  EXTERNAL.  SET-UP TO PROCESS EXTERNAL TRACE DATA SET.           */ 00652000
*/*                                                                  */ 00653000
*/********************************************************************  00654000
*                                                                    */ 00655000
*                                                                  0229 00656000
*EXTERNAL:                                                         0229 00657000
*   IF OPTSYSM^='1'B THEN           /* FULL SYSTEM FORMAT-OK   Y02014*/ 00658000
*                                                                  0229 00659000
EXTERNAL L     @14,GTFWDPTR(,AEDITCBR)                             0229 00660000
         TM    OPTSYSM(@14),B'10000000'                            0229 00661000
         BO    @RF00229                                            0229 00662000
*     /***************************************************************/ 00663000
*     /*                                                             */ 00664000
*     /* (IF SYSM, CAN'T HAVE JOB SELECTIVITY)                       */ 00665000
*     /*                                                             */ 00666000
*     /***************************************************************/ 00667000
*                                                                  0230 00668000
*EXTOK:                                                            0230 00669000
*     DO;                                                          0230 00670000
EXTOK    DS    0H                                                  0231 00671000
*       TITLSAVE=TITLEMOD;          /* SAVE AMDPRDMP-S PAGE TITLE    */ 00672000
         MVC   TITLSAVE(47),TITLEMOD                               0231 00673000
*       EXTITLE='1'B;               /* INDICATE TITLE SAVED          */ 00674000
         OI    EXTITLE,B'10000000'                                 0232 00675000
*       EXTTITL(21:28)=DDNAME;      /* FIND IN DDNAME VALUE IN TITLE */ 00676000
         MVC   EXTTITL+20(8),DDNAME(AEDITCBR)                      0233 00677000
*       TITLEMOD=EXTTITL;           /* REPLACE AMDPRDMP-S TITLE WITH    00678000
*                                      EDIT-S                        */ 00679000
         MVC   TITLEMOD(47),EXTTITL                                0234 00680000
*       DRVEXT='0'B;                /* EXTERNAL SET-UP COMPLETE      */ 00681000
         NI    DRVEXT,B'11110111'                                  0235 00682000
*       GO TO NEXTRTN;              /* GO TO ROUTINE SELECTION       */ 00683000
         B     NEXTRTN                                             0236 00684000
*     END EXTOK;                                                   0237 00685000
*                                                                  0237 00686000
*   /*****************************************************************/ 00687000
*   /*                                                               */ 00688000
*   /* VERIFY JOB SELECTION IS NOT REQUESTED FOR SYSM TRACE    Y02014*/ 00689000
*   /*                                                               */ 00690000
*   /*****************************************************************/ 00691000
*                                                                  0238 00692000
*   IF JOBNAMES(1)='        ' THEN                                 0238 00693000
@RF00229 CLC   JOBNAMES(8,AEDITCBR),@CC00413                       0238 00694000
         BE    @RT00238                                            0238 00695000
*     GO TO EXTOK;                                                 0239 00696000
*                                                                  0239 00697000
*   /*****************************************************************/ 00698000
*   /*                                                               */ 00699000
*   /* IF JOB SELECTION IS REQUESTED, THEN EITHER: 1: TERM. EDIT IF  */ 00700000
*   /* COMMANDS ARE COMMING FROM SYSIN, OR 2) ASK OPERATOR FOR       */ 00701000
*   /* PERMISSION TO CONTINUE IF COMMANDS ARE COMMING FROM CONSOLE.  */ 00702000
*   /*                                                               */ 00703000
*   /*****************************************************************/ 00704000
*                                                                  0240 00705000
*   ELSE                                                           0240 00706000
*ASKOP:                                                            0240 00707000
*     DO;                                                          0240 00708000
ASKOP    DS    0H                                                  0241 00709000
*       SYNMSGA=ADDR(AMDPRE09);     /* POINT TO ADDR OF MESSAGE    0241 00710000
*                                      AMD217I                       */ 00711000
         L     @14,AFMG(,AEDITCBR)                                 0241 00712000
         LA    @14,AMDPRE09(,@14)                                  0241 00713000
         ST    @14,SYNMSGA                                         0241 00714000
*       GEN(OI  SWD,NOSTDMG);       /* INDICATE STANDARD MESSAGE   0242 00715000
*                                      AMD165I IS NOT REQUIRED       */ 00716000
         OI  SWD,NOSTDMG                                                00717000
*       REG15=ASYNTAX;              /* POINT TO MESSAGE WRITER       */ 00718000
         L     REG15,ASYNTAX                                       0243 00719000
*       CALL SYNTAXA;               /* CALL MESSAGE WRITE - AMDPRSYN */ 00720000
         BAL   @14,SYNTAXA                                         0244 00721000
*       GEN;                                                       0245 00722000
         TM    SWA,RDRSW           TEST SOURCE OF CONTROL STATEMENTS    00723000
         BO    SETTERM             RDR SWITCH '1'B MEANS CARDS IN SYSIN 00724000
*                                  DATA SET - SO BRANCH TO SET TERM     00725000
*                                  IN DRIVER                            00726000
*OPERR:                                                            0246 00727000
*       ECB=0;                      /* CLEAR ECB FOR WTOR            */ 00728000
OPERR    SLR   ECB,ECB                                             0246 00729000
*       RFY                                                        0247 00730000
*        (REG1) RSTD;                                              0247 00731000
*       REG1=AMDPRE10;              /* POINT TO WTOR LIST IN AMDPRFMG*/ 00732000
*                                                                  0248 00733000
         L     @14,AFMG(,AEDITCBR)                                 0248 00734000
         L     REG1,AMDPRE10(,@14)                                 0248 00735000
*       /*************************************************************/ 00736000
*       /*                                                           */ 00737000
*       /* WRITE MESSAGE AMD218D TO OPERATOR                         */ 00738000
*       /*                                                           */ 00739000
*       /*************************************************************/ 00740000
*                                                                  0249 00741000
*       GEN;                                                       0249 00742000
         WTOR  ,REPLY,1,ECB,MF=(E,(1))                                  00743000
         WAIT  ECB=ECB             WAIT FOR REPLY                       00744000
*       REPLY=REPLY|'40'X;          /* MAKE REPLY CAPS               */ 00745000
         OI    REPLY,X'40'                                         0250 00746000
*       REG1=AMDPRE10+12;           /* POINT TO MESSAGE TEXT TO WRITE   00747000
*                                      ON SYSPRINT                   */ 00748000
         L     @14,AFMG(,AEDITCBR)                                 0251 00749000
         LA    REG1,12                                             0251 00750000
         AL    REG1,AMDPRE10(,@14)                                 0251 00751000
*       GEN;                                                       0252 00752000
         BRPRTMSG  (R1),65      /* PRINT MESSAGE ON SYSPRINT            00753000
*                                  USE INDENTIFIER R1 TO INDICATE       00754000
*                                  THAT REG 1 IS ALREADY LOADED      */ 00755000
         BRPRTMSG  REPLY,1      /* PRINT REPLY ON SYSPRINT           */ 00756000
*       RFY                                                        0253 00757000
*        (REG1) UNRSTD;                                            0253 00758000
*       IF REPLY='C' THEN           /* TEST FOR GO-AHEAD             */ 00759000
*                                                                  0254 00760000
         CLI   REPLY,C'C'                                          0254 00761000
         BNE   @RF00254                                            0254 00762000
*         /***********************************************************/ 00763000
*         /*                                                         */ 00764000
*         /* OPERATOR SAYS OK                                        */ 00765000
*         /*                                                         */ 00766000
*         /***********************************************************/ 00767000
*                                                                  0255 00768000
*CONT:                                                             0255 00769000
*         DO;                                                      0255 00770000
CONT     DS    0H                                                  0256 00771000
*           DO I=5 TO 1 BY-1;       /* CLEAR JOB ARRAY         Y02014*/ 00772000
         LA    @14,5                                               0256 00773000
         ST    @14,I                                               0256 00774000
@DL00256 DS    0H                                                  0257 00775000
*             JOBNAMES(I)=' ';                                     0257 00776000
         LR    @10,@14                                             0257 00777000
         SLA   @10,3                                               0257 00778000
         ALR   @10,AEDITCBR                                        0257 00779000
         MVI   JOBNAMES-7(@10),C' '                                0257 00780000
         MVC   JOBNAMES-6(6,@10),JOBNAMES-7(@10)                   0257 00781000
         MVI   JOBNAMES-8(@10),C' '                                0257 00782000
*           END;                                                   0258 00783000
         BCTR  @14,0                                               0258 00784000
         ST    @14,I                                               0258 00785000
         LTR   @14,@14                                             0258 00786000
         BP    @DL00256                                            0258 00787000
*           IF EXTTRC='1'B THEN     /* EXTERNAL DATA SET       Y02014*/ 00788000
         TM    EXTTRC(AEDITCBR),B'00000100'                        0259 00789000
         BO    @RT00259                                            0259 00790000
*             GOTO EXTOK;           /* COMPLETE EXTERNAL SET UP    0260 00791000
*                                                              Y02014*/ 00792000
*           ELSE                                                   0261 00793000
*             GOTO DUMPEXT;         /* COMPLETE DUMP SET UP    Y02014*/ 00794000
         B     DUMPEXT                                             0261 00795000
*         END CONT;                                                0262 00796000
*       IF REPLY='S' THEN           /* TEST FOR 'S' - STOP REQUESTED */ 00797000
*                                                                  0263 00798000
@RF00254 CLI   REPLY,C'S'                                          0263 00799000
         BNE   @RF00263                                            0263 00800000
*         /***********************************************************/ 00801000
*         /*                                                         */ 00802000
*         /* OPERATOR SAYS DO NOT CONTINUE, SO SET UP FOR EDIT       */ 00803000
*         /* TERMINATION                                             */ 00804000
*         /*                                                         */ 00805000
*         /***********************************************************/ 00806000
*                                                                  0264 00807000
*SETTERM:                                                          0264 00808000
*         DO;                                                      0264 00809000
SETTERM  DS    0H                                                  0265 00810000
*           DRVTERM='1'B;           /* REQUEST TERM ROUTINE          */ 00811000
*           DRVTITLE='0'B;          /* DON-T TITLE AND               */ 00812000
*           DRVCON='0'B;            /* DON-T FORMAT CURRENT RECORD   */ 00813000
         OI    DRVTERM,B'10000000'                                 0267 00814000
         NI    DRVTITLE,B'11111001'                                0267 00815000
*           TERM='1'B;              /* INDICATE EDIT STOPPING        */ 00816000
         OI    TERM(AEDITCBR),B'01000000'                          0268 00817000
*           GO TO NEXTRTN;          /* GO BACK TO ROUTINE SELECTION,    00818000
*                                      GET-TERM WILL BE CALLED       */ 00819000
         B     NEXTRTN                                             0269 00820000
*         END SETTERM;                                             0270 00821000
*       ELSE                                                       0271 00822000
*         GO TO OPERR;              /* NOT 'C' OR 'S' MEAN ERROR IN     00823000
*                                      REPLY - REISSUE MSG AMD218D   */ 00824000
*     END ASKOP;                                                   0272 00825000
*                                                                  0273 00826000
*/********************************************************************  00827000
*                                                                    */ 00828000
*/*                                                                  */ 00829000
*/*  TITLE EDIT OUTPUT AND PRINT GTF OPTIONS                         */ 00830000
*/*                                                                  */ 00831000
*/********************************************************************  00832000
*                                                                    */ 00833000
*                                                                  0273 00834000
*PRNTITLE:                                                         0273 00835000
*   GEN(BRWRITE  1,IMM);            /* SKIP TO CLEAN PAGE, PREP M4381*/ 00836000
PRNTITLE BRWRITE  1,IMM                                                 00837000
*   GEN(BRWRITE  SKIP);             /* SKIP TO CLEAN PAGE            */ 00838000
         BRWRITE  SKIP                                                  00839000
*   OUTBUF(45:73)=MAINTITL;         /* MAIN TITLE TO OUTPUT AREA     */ 00840000
         L     @14,CURBUF                                          0275 00841000
         MVC   OUTBUF+44(29,@14),MAINTITL                          0275 00842000
*   GEN(BRWRITE 3);                 /* PRINT TITLE                   */ 00843000
         BRWRITE 3                                                      00844000
*   RFY                                                            0277 00845000
*    (REG2,                                                        0277 00846000
*     REG3) RSTD;                   /* REGISTER USAGE IN TITLE     0277 00847000
*                                      ROUTINE REG 2 - LENGTH OF DATA   00848000
*                                      BEING MOVED TO OUTPUT LINE REG   00849000
*                                      3 - DURING INIT, OFFSET INTO     00850000
*                                      LINE, AFTER INIT, ADDR OF   0277 00851000
*                                      VALUE OF CURRENT GTF OPTION   */ 00852000
*                                                                  0277 00853000
*   /*****************************************************************/ 00854000
*   /*                                                               */ 00855000
*   /* DATAPTR IS INDEX INTO STRING OF LABELS FOR GTF OPTIONS        */ 00856000
*   /*                                                               */ 00857000
*   /*****************************************************************/ 00858000
*                                                                  0278 00859000
*   DATAPTR=1;                      /* START WITH 1-ST BYTE OF OPTION   00860000
*                                      LIST                          */ 00861000
         LA    @14,1                                               0278 00862000
         ST    @14,DATAPTR                                         0278 00863000
*   DO I=1 TO 14;                   /* LOOP TO PRINT LINES IN GTF  0279 00864000
*                                      OPTION DISPLAY                */ 00865000
         ST    @14,I                                               0279 00866000
@DL00279 DS    0H                                                  0280 00867000
*     REG2=OPTSOFF(I);              /* GET LENGTH OF CURRENT OPTION  */ 00868000
         SLR   REG2,REG2                                           0280 00869000
         IC    REG2,OPTSOFF-1(@14)                                 0280 00870000
*     REG3=58-REG2;                 /* COMPUTE INDEX INTO OUTPUT BUF    00871000
*                                      WHERE OPTION SHOULD BE PLACED */ 00872000
*                                                                  0281 00873000
         LA    @10,58                                              0281 00874000
         LR    REG3,@10                                            0281 00875000
         SLR   REG3,REG2                                           0281 00876000
*     /***************************************************************/ 00877000
*     /*                                                             */ 00878000
*     /* MOVE CURRENT OPTION TO OUTPUT LINE                          */ 00879000
*     /*                                                             */ 00880000
*     /***************************************************************/ 00881000
*                                                                  0282 00882000
*     OUTBUF(REG3:58)=OPTS(DATAPTR:DATAPTR+REG2);                  0282 00883000
*                                                                  0282 00884000
         L     @08,CURBUF                                          0282 00885000
         LR    @07,@08                                             0282 00886000
         ALR   @07,REG3                                            0282 00887000
         SLR   @10,REG3                                            0282 00888000
         L     @06,DATAPTR                                         0282 00889000
         LA    @14,OPTS-1(@06)                                     0282 00890000
         EX    @10,@SM00508                                        0282 00891000
*     /***************************************************************/ 00892000
*     /*                                                             */ 00893000
*     /* UPDATE INDEX INTO VALUE STRING AND ACCOUNT FOR OPTSOFF      */ 00894000
*     /* MEMBER BEING 1-LESS                                         */ 00895000
*     /*                                                             */ 00896000
*     /***************************************************************/ 00897000
*                                                                  0283 00898000
*     DATAPTR=DATAPTR+REG2+1;                                      0283 00899000
         ALR   @06,REG2                                            0283 00900000
         AL    @06,@CF00069                                        0283 00901000
         ST    @06,DATAPTR                                         0283 00902000
*     OUTBUF(59)='=';               /* MOVE EQUAL SIGN TO OUTPUT LINE*/ 00903000
         MVI   OUTBUF+58(@08),C'='                                 0284 00904000
*     REG2=I*4;                     /* COMPUTE OFFSET INTO BRANCH TAB*/ 00905000
         L     @14,I                                               0285 00906000
         SLA   @14,2                                               0285 00907000
         LR    REG2,@14                                            0285 00908000
*     GEN;                                                         0286 00909000
*                                                                  0286 00910000
BRTAB    B     BRTAB(R2)           BRANCH TABLE TO SELECT TESTING       00911000
*                                  ROUTINE FOR EACH GTF OPTION          00912000
         B     FORMAT              SYS OR SYSM TRACE RECORD FORMATX     00913000
         B     SVCOP               SVC-S:  ALL, NONE OR SELECTIVE       00914000
         B     SIOOP               SIO-S:  ALL, NONE OR SELECTIVE       00915000
         B     PIOP                PGM INTERRUPTS:  ALL, NONE OR        00916000
*                                  SELECTIVE                            00917000
         B     IOOP                I/O INTERRUPTS:  ALL, NONE OR        00918000
*                                  SELECTIVE                            00919000
         B     EXTOP               TRACING EXTERNAL INTERRUPTS          00920000
         B     RROP                RR TRACING                    Y02014 00921000
         B     USROP               USER TRACES                          00922000
         B     GTF                 TRACING GTF INTERRUPTS               00923000
         B     DSPOP               TRACING DISPATCHES                   00924000
         B     PCI                 TRACING PCI INTERRUPTS               00925000
         B     RNIOOP              RNIO TRACING                  Y02014 00926000
         B     SRMOP               SRM TRACING                   Y02014 00927000
         B     USERTIME            USER TIME-STAMP IN EACH RECORD       00928000
*     /***************************************************************/ 00929000
*     /*                                                             */ 00930000
*     /* FORMAT OPTION                                               */ 00931000
*     /*                                                             */ 00932000
*     /***************************************************************/ 00933000
*                                                                  0287 00934000
*FORMAT:                                                           0287 00935000
*     IF OPTSYSM='1'B THEN          /* TEST FOR SYSM FORMAT    Y02014*/ 00936000
FORMAT   L     @14,GTFWDPTR(,AEDITCBR)                             0287 00937000
         TM    OPTSYSM(@14),B'10000000'                            0287 00938000
         BNO   @RF00287                                            0287 00939000
*       DO;                         /* IF SO,                        */ 00940000
*         REG2=3;                   /* SET LENGTH OF 'SYSM' - OPTION    00941000
*                                      VALUE                         */ 00942000
*                                                                  0289 00943000
         LA    REG2,3                                              0289 00944000
*         /***********************************************************/ 00945000
*         /*                                                         */ 00946000
*         /* POINT TO OPTION VALUE                                   */ 00947000
*         /*                                                         */ 00948000
*         /***********************************************************/ 00949000
*                                                                  0290 00950000
*         REG3=ADDR(SYSMLAB);                                      0290 00951000
*                                                                  0290 00952000
         LA    REG3,SYSMLAB                                        0290 00953000
*         /***********************************************************/ 00954000
*         /*                                                         */ 00955000
*         /* *** BSL DEPENDENT AND TRICKY *** UPDATE LOOP COUNTER TO */ 00956000
*         /* SKIP SVC, SIO, PI, I/O, RR AND EXT OPTIONS BECAUSE THESE*/ 00957000
*         /* ARE IMPLIED YES BY SYSM                                 */ 00958000
*         /*                                                         */ 00959000
*         /***********************************************************/ 00960000
*                                                                  0291 00961000
*         I=7;                      /*                         Y02014*/ 00962000
*                                                                  0291 00963000
         MVC   I(4),@CF00080                                       0291 00964000
*         /***********************************************************/ 00965000
*         /*                                                         */ 00966000
*         /* UPDATE DATA POINTER TO POSITION TO CORRECT LABEL        */ 00967000
*         /*                                                         */ 00968000
*         /***********************************************************/ 00969000
*                                                                  0292 00970000
*         DATAPTR=DATAPTR+15;       /*                         Y02014*/ 00971000
         LA    @14,15                                              0292 00972000
         AL    @14,DATAPTR                                         0292 00973000
         ST    @14,DATAPTR                                         0292 00974000
*         GO TO MOVEVAL;            /* GO MOVE OPTION VALUE TO OUTPUT*/ 00975000
         B     MOVEVAL                                             0293 00976000
*       END;                                                       0294 00977000
*     ELSE                                                         0295 00978000
*       DO;                         /* IF NOT SYSM, MUST BE FULL SYS    00979000
*                                      FORMAT                        */ 00980000
@RF00287 DS    0H                                                  0296 00981000
*         REG2=2;                   /* SET LENGTH OF OPTION VALUE    */ 00982000
         LA    REG2,2                                              0296 00983000
*         REG3=ADDR(SYSLAB);        /* POINT TO VALUE                */ 00984000
         LA    REG3,SYSLAB                                         0297 00985000
*         GO TO MOVEVAL;            /* GO MOVE VALUE TO OUTPUT LINE  */ 00986000
         B     MOVEVAL                                             0298 00987000
*       END;                                                       0299 00988000
*                                                                  0299 00989000
*     /***************************************************************/ 00990000
*     /*                                                             */ 00991000
*     /* SVC OPTION - FIRST TEST FOR SELECT SVC TRACING - SVC        */ 00992000
*     /* PROMPTING                                                   */ 00993000
*     /*                                                             */ 00994000
*     /***************************************************************/ 00995000
*                                                                  0300 00996000
*SVCOP:                                                            0300 00997000
*     IF OPTSVCP='1'B THEN                                         0300 00998000
SVCOP    L     @14,GTFWDPTR(,AEDITCBR)                             0300 00999000
         TM    OPTSVCP(@14),B'01000000'                            0300 01000000
         BO    @RT00300                                            0300 01001000
*       GO TO SELECTVE;             /*                         Y02014*/ 01002000
*                                                                  0301 01003000
*     /***************************************************************/ 01004000
*     /*                                                             */ 01005000
*     /* IF NOT SELECTIVE TRACING, CHECK FOR ALL BY TESTING SVC ALL  */ 01006000
*     /* BIT OR                                                      */ 01007000
*     /*                                                             */ 01008000
*     /***************************************************************/ 01009000
*                                                                  0302 01010000
*     IF OPTSVC='1'B|OPTSYS='1'B THEN/* ALL SVC OR SYS PMTING  Y02014*/ 01011000
         TM    OPTSVC(@14),B'10000000'                             0302 01012000
         BO    @RT00302                                            0302 01013000
         TM    OPTSYS(@14),B'00100000'                             0302 01014000
         BO    @RT00302                                            0302 01015000
*       GO TO ALL;                                                 0303 01016000
*     ELSE                                                         0304 01017000
*       GO TO NONE;                 /* LABEL SVC-S AS NONE           */ 01018000
*                                                                  0304 01019000
         B     NONE                                                0304 01020000
*     /***************************************************************/ 01021000
*     /*                                                             */ 01022000
*     /* SIO OPTION - FIRST TEST FOR TRACING BY SELECT DEVICE - SIO  */ 01023000
*     /* PROMPTING                                                   */ 01024000
*     /*                                                             */ 01025000
*     /***************************************************************/ 01026000
*                                                                  0305 01027000
*SIOOP:                                                            0305 01028000
*     IF OPTSIOP='1'B THEN                                         0305 01029000
SIOOP    L     @14,GTFWDPTR(,AEDITCBR)                             0305 01030000
         TM    OPTSIOP(@14),B'00010000'                            0305 01031000
         BO    @RT00305                                            0305 01032000
*       GO TO SELECTVE;             /*                         Y02014*/ 01033000
*                                                                  0306 01034000
*     /***************************************************************/ 01035000
*     /*                                                             */ 01036000
*     /* IF NOT SELECTIVE TRACING, CHECK FOR ALL BY TESTING SIO ALL  */ 01037000
*     /* BIT OR                                                      */ 01038000
*     /*                                                             */ 01039000
*     /***************************************************************/ 01040000
*                                                                  0307 01041000
*     IF OPTSIO='1'B|OPTSYS='1'B THEN/* ALL SIO OR SYS         Y02014*/ 01042000
         TM    OPTSIO(@14),B'00100000'                             0307 01043000
         BO    @RT00307                                            0307 01044000
         TM    OPTSYS(@14),B'00100000'                             0307 01045000
         BO    @RT00307                                            0307 01046000
*       GO TO ALL;                                                 0308 01047000
*     ELSE                                                         0309 01048000
*       GO TO NONE;                 /* LABEL SIO-S AS NONE           */ 01049000
*                                                                  0309 01050000
         B     NONE                                                0309 01051000
*     /***************************************************************/ 01052000
*     /*                                                             */ 01053000
*     /* PI OPTION - TEST FOR TRACING OF SELECT PGM INTERRUPTS - PI  */ 01054000
*     /* PROMPT                                                      */ 01055000
*     /*                                                             */ 01056000
*     /***************************************************************/ 01057000
*                                                                  0310 01058000
*PIOP:                                                             0310 01059000
*     IF OPTPIP='1'B THEN                                          0310 01060000
PIOP     L     @14,GTFWDPTR(,AEDITCBR)                             0310 01061000
         TM    OPTPIP(@14),B'00000100'                             0310 01062000
         BO    @RT00310                                            0310 01063000
*       GO TO SELECTVE;             /*                         Y02014*/ 01064000
*                                                                  0311 01065000
*     /***************************************************************/ 01066000
*     /*                                                             */ 01067000
*     /* IF NOT SELECTIVE TRACING, CHECK FOR ALL BY TESTING PI ALL   */ 01068000
*     /* BIT OR                                                      */ 01069000
*     /*                                                             */ 01070000
*     /***************************************************************/ 01071000
*                                                                  0312 01072000
*     IF OPTPI='1'B|OPTSYS='1'B THEN/* ALL PI OR SYS PROMPTING Y02014*/ 01073000
         TM    OPTPI(@14),B'00001000'                              0312 01074000
         BO    @RT00312                                            0312 01075000
         TM    OPTSYS(@14),B'00100000'                             0312 01076000
         BO    @RT00312                                            0312 01077000
*       GO TO ALL;                                                 0313 01078000
*     ELSE                                                         0314 01079000
*       GO TO NONE;                 /* LABEL PI-S AS NONE            */ 01080000
*                                                                  0314 01081000
         B     NONE                                                0314 01082000
*     /***************************************************************/ 01083000
*     /*                                                             */ 01084000
*     /* I/O OPTION - TEST FOR SELECTIVE IO BECAUSE OF IO=SIO        */ 01085000
*     /*                                                             */ 01086000
*     /***************************************************************/ 01087000
*                                                                  0315 01088000
*IOOP:                                                             0315 01089000
*     IF OPTIOSIO='1'B THEN         /*                         Y02014*/ 01090000
IOOP     L     @14,GTFWDPTR(,AEDITCBR)                             0315 01091000
         TM    OPTIOSIO(@14),B'00000001'                           0315 01092000
         BNO   @RF00315                                            0315 01093000
*MVSIO:                                                            0316 01094000
*       DO;                         /* PRINT 'SIO' VALUE OF IO OPTION*/ 01095000
MVSIO    DS    0H                                                  0317 01096000
*         REG2=2;                   /* SET LENGTH OF VALUE           */ 01097000
         LA    REG2,2                                              0317 01098000
*         REG3=ADDR(SIOLAB);        /* POINT TO VALUE                */ 01099000
         LA    REG3,SIOLAB                                         0318 01100000
*         GO TO MOVEVAL;            /* GO MOVE VALUE TO OUTPUT LINE  */ 01101000
         B     MOVEVAL                                             0319 01102000
*       END MVSIO;                                                 0320 01103000
*                                                                  0320 01104000
*     /***************************************************************/ 01105000
*     /*                                                             */ 01106000
*     /* TEST FOR TRACING OF I/O INTERRUPTS BY SELECT DEVICE - I/O   */ 01107000
*     /* PROMPTING                                                   */ 01108000
*     /*                                                             */ 01109000
*     /***************************************************************/ 01110000
*                                                                  0321 01111000
*     IF OPTIOP='1'B THEN           /*                         Y02014*/ 01112000
@RF00315 L     @14,GTFWDPTR(,AEDITCBR)                             0321 01113000
         TM    OPTIOP(@14),B'00000001'                             0321 01114000
         BNO   @RF00321                                            0321 01115000
*SELECTVE:                                                         0322 01116000
*       DO;                         /* PRINT 'SELECTIVE' OPTION VALUE*/ 01117000
SELECTVE DS    0H                                                  0323 01118000
*         REG2=8;                   /* SET LENGTH OF 'SELECTIVE'     */ 01119000
*                                                                  0323 01120000
         LA    REG2,8                                              0323 01121000
*         /***********************************************************/ 01122000
*         /*                                                         */ 01123000
*         /* POINT TO OPTION VALUE                                   */ 01124000
*         /*                                                         */ 01125000
*         /***********************************************************/ 01126000
*                                                                  0324 01127000
*         REG3=ADDR(SELECTLB);                                     0324 01128000
         LA    REG3,SELECTLB                                       0324 01129000
*         GO TO MOVEVAL;            /* GO MOVE VALUE TO OUTPUT LINE  */ 01130000
         B     MOVEVAL                                             0325 01131000
*       END SELECTVE;                                              0326 01132000
*                                                                  0326 01133000
*     /***************************************************************/ 01134000
*     /*                                                             */ 01135000
*     /* IF NOT SELECTIVE TRACING, CHECK FOR ALL BY TESTING I/O ALL  */ 01136000
*     /* BIT OR                                                      */ 01137000
*     /*                                                             */ 01138000
*     /***************************************************************/ 01139000
*                                                                  0327 01140000
*     IF OPTIO='1'B|OPTSYS='1'B THEN/* ALL IO OR SYS PROMPTING Y02014*/ 01141000
@RF00321 L     @14,GTFWDPTR(,AEDITCBR)                             0327 01142000
         TM    OPTIO(@14),B'00000010'                              0327 01143000
         BO    @RT00327                                            0327 01144000
         TM    OPTSYS(@14),B'00100000'                             0327 01145000
         BNO   @RF00327                                            0327 01146000
@RT00327 DS    0H                                                  0328 01147000
*ALL:                                                              0328 01148000
*       DO;                         /* PRINT 'ALL' VALUE OF OPTIONS  */ 01149000
ALL      DS    0H                                                  0329 01150000
*         REG2=2;                   /* SET LENGTH OF 'ALL'           */ 01151000
         LA    REG2,2                                              0329 01152000
*         REG3=ADDR(ALLAB);         /* POINT TO VALUE                */ 01153000
         LA    REG3,ALLAB                                          0330 01154000
*         GO TO MOVEVAL;            /* GO MOVE VALUE TO OUTPUT LINE  */ 01155000
         B     MOVEVAL                                             0331 01156000
*       END ALL;                                                   0332 01157000
*                                                                  0332 01158000
*     /***************************************************************/ 01159000
*     /*                                                             */ 01160000
*     /* LABEL I/O-S AS NONE                                         */ 01161000
*     /*                                                             */ 01162000
*     /***************************************************************/ 01163000
*                                                                  0333 01164000
*     ELSE                                                         0333 01165000
*NONE:                                                             0333 01166000
*       DO;                         /* PRINT 'NONE' OPTION           */ 01167000
@RF00327 DS    0H                                                  0333 01168000
NONE     DS    0H                                                  0334 01169000
*         REG2=3;                   /* SET LENGTH OF VALUE           */ 01170000
*                                                                  0334 01171000
         LA    REG2,3                                              0334 01172000
*         /***********************************************************/ 01173000
*         /*                                                         */ 01174000
*         /* POINT TO OPTION VALUE                                   */ 01175000
*         /*                                                         */ 01176000
*         /***********************************************************/ 01177000
*                                                                  0335 01178000
*         REG3=ADDR(NONELAB);                                      0335 01179000
         LA    REG3,NONELAB                                        0335 01180000
*         GO TO MOVEVAL;            /* GO MOVE VALUE TO OUTPUT LINE  */ 01181000
         B     MOVEVAL                                             0336 01182000
*       END NONE;                                                  0337 01183000
*                                                                  0337 01184000
*     /***************************************************************/ 01185000
*     /*                                                             */ 01186000
*     /* EXT OPTION - TEST FOR YES BY OR OF EXT, ALL SYS, AND SYSP   */ 01187000
*     /*                                                             */ 01188000
*     /***************************************************************/ 01189000
*                                                                  0338 01190000
*EXTOP:                                                            0338 01191000
*     IF OPTEXT='1'B|               /*                         Y02014*/ 01192000
*         OPTSYS='1'B|              /*                         Y02014*/ 01193000
*         OPTSYSP='1'B THEN                                        0338 01194000
EXTOP    L     @14,GTFWDPTR(,AEDITCBR)                             0338 01195000
         TM    OPTEXT(@14),B'10000000'                             0338 01196000
         BO    @RT00338                                            0338 01197000
         TM    OPTSYS(@14),B'01100000'                             0338 01198000
         BNZ   @RT00338                                            0338 01199000
*       GO TO YES;                  /*                         Y02014*/ 01200000
*     ELSE                                                         0340 01201000
*       GO TO NO;                                                  0340 01202000
*                                                                  0340 01203000
         B     NO                                                  0340 01204000
*     /***************************************************************/ 01205000
*     /*                                                             */ 01206000
*     /* RR OPTION BY OR OF RR ALL SYS AND SYSP                Y02014*/ 01207000
*     /*                                                             */ 01208000
*     /***************************************************************/ 01209000
*                                                                  0341 01210000
*RROP:                                                             0341 01211000
*     IF OPTRR='1'B|                /*                         Y02014*/ 01212000
*         OPTSYS='1'B|              /*                         Y02014*/ 01213000
*         OPTSYSP='1'B THEN                                        0341 01214000
RROP     L     @14,GTFWDPTR(,AEDITCBR)                             0341 01215000
         TM    OPTRR(@14),B'00010000'                              0341 01216000
         BO    @RT00341                                            0341 01217000
         TM    OPTSYS(@14),B'01100000'                             0341 01218000
         BNZ   @RT00341                                            0341 01219000
*       GOTO YES;                   /*                         Y02014*/ 01220000
*     ELSE                                                         0343 01221000
*       GOTO NO;                    /*                         Y02014*/ 01222000
*                                                                  0343 01223000
         B     NO                                                  0343 01224000
*     /***************************************************************/ 01225000
*     /*                                                             */ 01226000
*     /* RNIO OPTION INDICATED                                 Y02014*/ 01227000
*     /*                                                             */ 01228000
*     /***************************************************************/ 01229000
*                                                                  0344 01230000
*RNIOOP:                            /*                         Y02014*/ 01231000
*     IF OPTRNIO='1'B THEN                                         0344 01232000
RNIOOP   L     @14,GTFWDPTR(,AEDITCBR)                             0344 01233000
         TM    OPTRNIO(@14),B'01000000'                            0344 01234000
         BO    @RT00344                                            0344 01235000
*       GOTO YES;                   /* RNIO OPTION             Y02014*/ 01236000
*     ELSE                                                         0346 01237000
*       GOTO NO;                    /*                         Y02014*/ 01238000
*                                                                  0346 01239000
         B     NO                                                  0346 01240000
*     /***************************************************************/ 01241000
*     /*                                                             */ 01242000
*     /* SRM OPTION INDICATED                                  Y02014*/ 01243000
*     /*                                                             */ 01244000
*     /***************************************************************/ 01245000
*                                                                  0347 01246000
*SRMOP:                             /*                         Y02014*/ 01247000
*     IF OPTSRM='1'B THEN                                          0347 01248000
SRMOP    L     @14,GTFWDPTR(,AEDITCBR)                             0347 01249000
         TM    OPTSRM(@14),B'00100000'                             0347 01250000
         BO    @RT00347                                            0347 01251000
*       GO TO YES;                  /* SRM OPTION              Y02014*/ 01252000
*     ELSE                                                         0349 01253000
*       GO TO NO;                   /*                         Y02014*/ 01254000
*                                                                  0349 01255000
         B     NO                                                  0349 01256000
*     /***************************************************************/ 01257000
*     /*                                                             */ 01258000
*     /* USR OPTION INDICATED                                        */ 01259000
*     /*                                                             */ 01260000
*     /***************************************************************/ 01261000
*                                                                  0350 01262000
*USROP:                                                            0350 01263000
*     IF OPTUSR='1'B THEN                                          0350 01264000
USROP    L     @14,GTFWDPTR(,AEDITCBR)                             0350 01265000
         TM    OPTUSR(@14),B'00010000'                             0350 01266000
         BO    @RT00350                                            0350 01267000
*       GO TO YES;                  /*                         Y02014*/ 01268000
*     ELSE                                                         0352 01269000
*       GO TO NO;                                                  0352 01270000
*                                                                  0352 01271000
         B     NO                                                  0352 01272000
*     /***************************************************************/ 01273000
*     /*                                                             */ 01274000
*     /* GTF OPTION INDICATED                                        */ 01275000
*     /*                                                             */ 01276000
*     /***************************************************************/ 01277000
*                                                                  0353 01278000
*GTF:                                                              0353 01279000
*     IF OPTTRC='1'B THEN                                          0353 01280000
GTF      L     @14,GTFWDPTR(,AEDITCBR)                             0353 01281000
         TM    OPTTRC(@14),B'00001000'                             0353 01282000
         BO    @RT00353                                            0353 01283000
*       GO TO YES;                  /*                         Y02014*/ 01284000
*     ELSE                                                         0355 01285000
*       GO TO NO;                                                  0355 01286000
*                                                                  0355 01287000
         B     NO                                                  0355 01288000
*     /***************************************************************/ 01289000
*     /*                                                             */ 01290000
*     /* DSP OPTION INDICATED                                        */ 01291000
*     /*                                                             */ 01292000
*     /***************************************************************/ 01293000
*                                                                  0356 01294000
*DSPOP:                                                            0356 01295000
*     IF OPTDSP='1'B THEN                                          0356 01296000
DSPOP    L     @14,GTFWDPTR(,AEDITCBR)                             0356 01297000
         TM    OPTDSP(@14),B'00000100'                             0356 01298000
         BO    @RT00356                                            0356 01299000
*       GO TO YES;                  /*                         Y02014*/ 01300000
*     ELSE                                                         0358 01301000
*       GO TO NO;                                                  0358 01302000
*                                                                  0358 01303000
         B     NO                                                  0358 01304000
*     /***************************************************************/ 01305000
*     /*                                                             */ 01306000
*     /* PCI OPTION INDICATED                                        */ 01307000
*     /*                                                             */ 01308000
*     /***************************************************************/ 01309000
*                                                                  0359 01310000
*PCI:                                                              0359 01311000
*     IF OPTPCI='1'B THEN                                          0359 01312000
PCI      L     @14,GTFWDPTR(,AEDITCBR)                             0359 01313000
         TM    OPTPCI(@14),B'00000001'                             0359 01314000
         BO    @RT00359                                            0359 01315000
*       GO TO YES;                  /*                         Y02014*/ 01316000
*     ELSE                                                         0361 01317000
*       GO TO NO;                                                  0361 01318000
*                                                                  0361 01319000
         B     NO                                                  0361 01320000
*     /***************************************************************/ 01321000
*     /*                                                             */ 01322000
*     /* USERTIME OPTION INDICATED                                   */ 01323000
*     /*                                                             */ 01324000
*     /***************************************************************/ 01325000
*                                                                  0362 01326000
*USERTIME:                                                         0362 01327000
*     IF OPTTIME='1'B THEN          /*                         Y02014*/ 01328000
USERTIME L     @14,GTFWDPTR(,AEDITCBR)                             0362 01329000
         TM    OPTTIME(@14),B'00000001'                            0362 01330000
         BNO   @RF00362                                            0362 01331000
*YES:                                                              0363 01332000
*       DO;                         /* PRINT 'YES'                   */ 01333000
YES      DS    0H                                                  0364 01334000
*         REG2=2;                   /* SET LENGTH OF VALUE           */ 01335000
         LA    REG2,2                                              0364 01336000
*         REG3=ADDR(YESLAB);        /* POINT TO VALUE                */ 01337000
         LA    REG3,YESLAB                                         0365 01338000
*         GO TO MOVEVAL;            /* GO MOVE VALUE TO OUTPUT LINE  */ 01339000
         B     MOVEVAL                                             0366 01340000
*       END YES;                                                   0367 01341000
*     ELSE                                                         0368 01342000
*NO:                                                               0368 01343000
*       DO;                         /* PRINT 'NO'                    */ 01344000
@RF00362 DS    0H                                                  0368 01345000
NO       DS    0H                                                  0369 01346000
*         REG2=1;                   /* SET LENGTH OF VALUE           */ 01347000
         LA    REG2,1                                              0369 01348000
*         REG3=ADDR(NOLAB);         /* POINT TO VALUE                */ 01349000
*                                                                  0370 01350000
         LA    REG3,NOLAB                                          0370 01351000
*         /***********************************************************/ 01352000
*         /*                                                         */ 01353000
*         /* FALL THROUGH TO MOVE VALUE TO OUTPUT LINE               */ 01354000
*         /*                                                         */ 01355000
*         /***********************************************************/ 01356000
*                                                                  0371 01357000
*       END NO;                                                    0371 01358000
*                                                                  0371 01359000
*     /***************************************************************/ 01360000
*     /*                                                             */ 01361000
*     /* BRANCH HERE TO MOVE VALUE OF CURRENT GTF OPTION TO OUTPUT   */ 01362000
*     /* LINE AND THEN PRINT LINE - OPTVAL BASED ON REG 3 SET ABOVE  */ 01363000
*     /*                                                             */ 01364000
*     /***************************************************************/ 01365000
*                                                                  0372 01366000
*MOVEVAL:                                                          0372 01367000
*     OUTBUF(60:60+REG2)=OPTVAL;                                   0372 01368000
MOVEVAL  L     @14,CURBUF                                          0372 01369000
         EX    REG2,@SM00510                                       0372 01370000
*     GEN(BRWRITE  1);              /* PRINT CURRENT OPTION LINE     */ 01371000
         BRWRITE  1                                                     01372000
*ENDGTFOP:                                                         0374 01373000
*   END;                            /* END FOR PRINTING OF A SINGLE     01374000
*                                      LINE OF OPTION DISPLAY - LOOP    01375000
*                                      TO PRINT NEXT LINE            */ 01376000
ENDGTFOP LA    @14,1                                               0374 01377000
         AL    @14,I                                               0374 01378000
         ST    @14,I                                               0374 01379000
         C     @14,@CF00310                                        0374 01380000
         BNH   @DL00279                                            0374 01381000
*   RFY                                                            0375 01382000
*    (REG2,                                                        0375 01383000
*     REG3) UNRSTD;                 /*                         Y02014*/ 01384000
*   GEN(BRWRITE  SKIP);             /* GTF OPTIONS ON SEPARATE PAGE  */ 01385000
         BRWRITE  SKIP                                                  01386000
*   DRVTITLE='0'B;                  /* TURN OFF TITLE BIT IN DRIVER  */ 01387000
         NI    DRVTITLE,B'11111011'                                0377 01388000
*   GO TO NEXTRTN;                  /* GO BACK AND SELECT NEXT     0378 01389000
*                                      ROUTINE                       */ 01390000
         B     NEXTRTN                                             0378 01391000
*                                                                  0379 01392000
*/********************************************************************  01393000
*                                                                    */ 01394000
*/*                                                                  */ 01395000
*/*                            CALLCON                               */ 01396000
*/*                                                                  */ 01397000
*/********************************************************************  01398000
*                                                                    */ 01399000
*                                                                  0379 01400000
*CALLCON:                                                          0379 01401000
*   CALL PRCON;                     /* CALL AMDPRCON TO FORMAT TIME-    01402000
*                                      STAMP RECORD                  */ 01403000
CALLCON  L     @15,ACON                                            0379 01404000
         BALR  @14,@15                                             0379 01405000
*   DRVCON='0'B;                    /* TURN OFF CALLCON BIT IN DRIVER*/ 01406000
         NI    DRVCON,B'11111101'                                  0380 01407000
*   GO TO NEXTRTN;                  /* GO BACK TO ROUTINE SELECTION  */ 01408000
         B     NEXTRTN                                             0381 01409000
*/********************************************************************  01410000
*                                                                    */ 01411000
*/*                                                                  */ 01412000
*/*                            CALLFLT                               */ 01413000
*/*                                                                  */ 01414000
*/********************************************************************  01415000
*                                                                    */ 01416000
*                                                                  0382 01417000
*CALLFLT:                                                          0382 01418000
*   CALL PRFLT;                     /* CALL AMDPRFLT TO BEGIN      0382 01419000
*                                      PROCESSING OF GTF TRACE RECORD*/ 01420000
*                                                                  0382 01421000
CALLFLT  L     @15,AFLT                                            0382 01422000
         BALR  @14,@15                                             0382 01423000
*   /*****************************************************************/ 01424000
*   /*                                                               */ 01425000
*   /* TERM REQUESTED DURING TRACE RECORD PROCESSING                 */ 01426000
*   /*                                                               */ 01427000
*   /*****************************************************************/ 01428000
*                                                                  0383 01429000
*   IF TERM='1'B THEN                                              0383 01430000
         TM    TERM(AEDITCBR),B'01000000'                          0383 01431000
         BNO   @RF00383                                            0383 01432000
*     DRVTERM='1'B;                 /* IF SO, REQUEST TERM ROUTINE IN   01433000
*                                      AMDPRFRM                      */ 01434000
         OI    DRVTERM,B'10000000'                                 0384 01435000
*   DRVFLT='0'B;                    /* TURN OFF CALL FLT IN DRIVER   */ 01436000
@RF00383 NI    DRVFLT,B'11111110'                                  0385 01437000
*   GO TO NEXTRTN;                  /* GO BACK TO ROUTINE SELECTION  */ 01438000
         B     NEXTRTN                                             0386 01439000
*   END AMDPRFRM                                                   0387 01440000
*                                                                  0387 01441000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01442000
*/*%INCLUDE SYSLIB  (AMDPRTAB)                                       */ 01443000
*/*%INCLUDE SYSLIB  (AMDOPTWD)                                       */ 01444000
*/*%INCLUDE SYSLIB  (RECMAP  )                                       */ 01445000
*                                                                  0387 01446000
*       ;                                                          0387 01447000
@DATA    DS    0H                                                       01448000
@SM00508 MVC   OUTBUF-1(0,@07),0(@14)                                   01449000
@SM00510 MVC   OUTBUF+59(0,@14),OPTVAL(REG3)                            01450000
         DS    0F                                                       01451000
@SA00001 DS    18F                                                      01452000
         DS    0F                                                       01453000
@CF00069 DC    F'1'                                                     01454000
@CF00080 DC    F'7'                                                     01455000
@CF00310 DC    F'14'                                                    01456000
@CV00233 DC    V(AMDPRGET)                                              01457000
@CV00234 DC    V(AMDPRHEX)                                              01458000
@CV00235 DC    V(AMDPRCON)                                              01459000
@CV00236 DC    V(AMDPRFLT)                                              01460000
@CV00237 DC    V(AMDPRAPP)                                              01461000
@CV00238 DC    V(AMDPREXT)                                              01462000
@CV00239 DC    V(AMDPRFMG)                                              01463000
@CV00240 DC    V(AMDPRSPI)                                              01464000
@CV00241 DC    V(AMDPRTME)                                              01465000
         DS    0D                                                       01466000
I        DS    F                                                        01467000
STOPSAVE DS    A                                                        01468000
ADDRHOLD DS    A                                                        01469000
DATAPTR  DS    A                                                        01470000
@CC00379 DC    C'            '                                          01471000
@CC00413 EQU   @CC00379                                                 01472000
@CB00374 DC    X'0000'                                                  01473000
         DS    CL2                                                      01474000
FRMATAB  DS    CL40                                                     01475000
         ORG   FRMATAB                                                  01476000
AGET     DC    VL4(AMDPRGET)                                            01477000
AHEX     DC    VL4(AMDPRHEX)                                            01478000
ACON     DC    VL4(AMDPRCON)                                            01479000
AFLT     DC    VL4(AMDPRFLT)                                            01480000
AAPP     DC    VL4(AMDPRAPP)                                            01481000
AEXT     DC    VL4(AMDPREXT)                                            01482000
APRFMG   DC    VL4(AMDPRFMG)                                            01483000
ASPI     DC    VL4(AMDPRSPI)                                            01484000
ATME     DC    VL4(AMDPRTME)                                            01485000
FRMRES1  DC    A(0)                                                     01486000
         ORG   FRMATAB+40                                               01487000
DRIVER   DS    BL2                                                      01488000
         ORG   DRIVER                                                   01489000
DRVRSV   DS    BL1                                                      01490000
DRVGET   EQU   DRIVER+0                                                 01491000
DRVTERM  DS    BL1                                                      01492000
DRVVALID EQU   DRIVER+1                                                 01493000
DRVPOSIT EQU   DRIVER+1                                                 01494000
DRVDUMP  EQU   DRIVER+1                                                 01495000
DRVEXT   EQU   DRIVER+1                                                 01496000
DRVTITLE EQU   DRIVER+1                                                 01497000
DRVCON   EQU   DRIVER+1                                                 01498000
DRVFLT   EQU   DRIVER+1                                                 01499000
         ORG   DRIVER+2                                                 01500000
FRMPTCH  DC    CL200'FRMPTCH'                                           01501000
         DS    CL2                                                      01502000
OPTSAVE  DS    CL4                                                      01503000
MAINTITL DC    CL29'* * * *    E D I T    * * * *'                      01504000
OPTS     DC    CL85'GTF OPTIONS IN EFFECT-  FORMATSVCSIOPIIOEXTRRUSRGTFC01505000
               DSPPCIRNIOSRMUSERTIME'                                   01506000
SYSMLAB  DC    CL4'SYSM'                                                01507000
SYSLAB   DC    CL3'SYS'                                                 01508000
ALLAB    DC    CL3'ALL'                                                 01509000
SELECTLB DC    CL9'SELECTIVE'                                           01510000
SIOLAB   DC    CL3'SIO'                                                 01511000
NONELAB  DC    CL4'NONE'                                                01512000
YESLAB   DC    CL3'YES'                                                 01513000
NOLAB    DC    CL2'NO'                                                  01514000
TITLSAVE DS    CL47                                                     01515000
EXTTITL  DC    CL47'EXTERNAL TRACE - DD XXXXXXXX'                       01516000
REPLY    DS    CL1                                                      01517000
FRMSWITC DS    BL1                                                      01518000
         ORG   FRMSWITC                                                 01519000
EXTITLE  DS    BL1                                                      01520000
STPSW    EQU   FRMSWITC+0                                               01521000
SW127    EQU   FRMSWITC+0                                               01522000
         ORG   FRMSWITC+1                                               01523000
FRMSWT2  DC    X'00'                                                    01524000
         ORG   FRMSWT2                                                  01525000
FIRST    DS    BL1                                                      01526000
@NM00003 EQU   FRMSWT2+0                                                01527000
         ORG   FRMSWT2+1                                                01528000
         DS    CL2                                                      01529000
TIMEPARM DS    CL12                                                     01530000
         ORG   TIMEPARM                                                 01531000
ADCVTTZ  DS    AL4                                                      01532000
ADTODCLK DS    AL4                                                      01533000
ADTMEBUF DS    AL4                                                      01534000
         ORG   TIMEPARM+12                                              01535000
TMEBUF   DS    CL22                                                     01536000
         ORG   TMEBUF                                                   01537000
YEAR     DS    CL4                                                      01538000
DAYYR    DS    CL3                                                      01539000
TOD      DS    CL15                                                     01540000
         ORG   TMEBUF+22                                                01541000
TIMSAVE  DS    CL9                                                      01542000
         ORG   TIMSAVE                                                  01543000
DSAV     DS    CL3                                                      01544000
TSAV     DS    CL6                                                      01545000
         ORG   TIMSAVE+9                                                01546000
OPTSOFF  DC    AL1(29)                                                  01547000
         DC    AL1(2)                                                   01548000
         DC    AL1(2)                                                   01549000
         DC    AL1(1)                                                   01550000
         DC    AL1(1)                                                   01551000
         DC    AL1(2)                                                   01552000
         DC    AL1(1)                                                   01553000
         DC    AL1(2)                                                   01554000
         DC    AL1(2)                                                   01555000
         DC    AL1(2)                                                   01556000
         DC    AL1(2)                                                   01557000
         DC    AL1(3)                                                   01558000
         DC    AL1(2)                                                   01559000
         DC    AL1(7)                                                   01560000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01561000
@01      EQU   01                                                       01562000
@02      EQU   02                                                       01563000
@03      EQU   03                                                       01564000
@04      EQU   04                                                       01565000
@05      EQU   05                                                       01566000
@06      EQU   06                                                       01567000
@07      EQU   07                                                       01568000
@08      EQU   08                                                       01569000
@09      EQU   09                                                       01570000
@10      EQU   10                                                       01571000
@11      EQU   11                                                       01572000
@12      EQU   12                                                       01573000
@13      EQU   13                                                       01574000
@14      EQU   14                                                       01575000
@15      EQU   15                                                       01576000
ECB      EQU   @03                                                      01577000
REG0     EQU   @00                                                      01578000
REG1     EQU   @01                                                      01579000
REG2     EQU   @02                                                      01580000
REG3     EQU   @03                                                      01581000
REG4     EQU   @04                                                      01582000
REG5     EQU   @05                                                      01583000
REG6     EQU   @06                                                      01584000
REG12    EQU   @12                                                      01585000
REG15    EQU   @15                                                      01586000
AEDITCBR EQU   @09                                                      01587000
PARMREG  EQU   @01                                                      01588000
WREG2    EQU   @02                                                      01589000
         ENTRY FRMPTCH                                                  01590000
OUTBUF   EQU   1                                                        01591000
OPTVAL   EQU   0                                                        01592000
AMDPRTAB EQU   0                                                        01593000
AFMG     EQU   AMDPRTAB                                                 01594000
CURREC   EQU   AMDPRTAB+4                                               01595000
DEBGFLGS EQU   AMDPRTAB+8                                               01596000
PTHFLGS1 EQU   DEBGFLGS                                                 01597000
FRM      EQU   PTHFLGS1                                                 01598000
PTHFLGS2 EQU   DEBGFLGS+1                                               01599000
INRFCFGS EQU   DEBGFLGS+2                                               01600000
TERM     EQU   INRFCFGS                                                 01601000
EXTTRC   EQU   INRFCFGS                                                 01602000
EDITSTOP EQU   INRFCFGS                                                 01603000
IOFLGS   EQU   DEBGFLGS+3                                               01604000
GETEOF   EQU   IOFLGS                                                   01605000
GTFWDPTR EQU   AMDPRTAB+20                                              01606000
DDNAME   EQU   AMDPRTAB+32                                              01607000
STARTIME EQU   AMDPRTAB+40                                              01608000
STOPTIME EQU   AMDPRTAB+52                                              01609000
NAMES    EQU   AMDPRTAB+64                                              01610000
JOBNAMES EQU   NAMES                                                    01611000
ADS      EQU   AMDPRTAB+104                                             01612000
AADS     EQU   ADS                                                      01613000
SIF      EQU   AMDPRTAB+124                                             01614000
SIOFLGS  EQU   SIF                                                      01615000
DVADS1   EQU   AMDPRTAB+128                                             01616000
IO       EQU   AMDPRTAB+228                                             01617000
IOFLGS2  EQU   IO                                                       01618000
DVADS2   EQU   AMDPRTAB+232                                             01619000
VCF      EQU   AMDPRTAB+332                                             01620000
SVCFLGS  EQU   VCF                                                      01621000
USR      EQU   AMDPRTAB+368                                             01622000
USRFLGS  EQU   USR                                                      01623000
USRTAB   EQU   AMDPRTAB+372                                             01624000
PI       EQU   AMDPRTAB+452                                             01625000
PIFLGS   EQU   PI                                                       01626000
PGMNGEN  EQU   AMDPRTAB+456                                             01627000
GENFLAGS EQU   PGMNGEN+3                                                01628000
SYS      EQU   GENFLAGS                                                 01629000
SYSM     EQU   GENFLAGS                                                 01630000
GENFLGS1 EQU   AMDPRTAB+460                                             01631000
TSFOUND  EQU   GENFLGS1                                                 01632000
PRFMTADD EQU   AMDPRTAB+480                                             01633000
REENTWKA EQU   AMDPRTAB+484                                             01634000
AFRMAD   EQU   AMDPRTAB+488                                             01635000
ESTARTME EQU   AMDPRTAB+500                                             01636000
ESTOPTME EQU   AMDPRTAB+509                                             01637000
CVTTZONE EQU   AMDPRTAB+518                                             01638000
AMDOPTWD EQU   0                                                        01639000
OPTS1    EQU   AMDOPTWD                                                 01640000
OPTSYSM  EQU   OPTS1                                                    01641000
OPTSYSP  EQU   OPTS1                                                    01642000
OPTSYS   EQU   OPTS1                                                    01643000
OPTUSR   EQU   OPTS1                                                    01644000
OPTTRC   EQU   OPTS1                                                    01645000
OPTDSP   EQU   OPTS1                                                    01646000
OPTPCI   EQU   OPTS1                                                    01647000
OPTS2    EQU   AMDOPTWD+1                                               01648000
OPTSVC   EQU   OPTS2                                                    01649000
OPTSVCP  EQU   OPTS2                                                    01650000
OPTSIO   EQU   OPTS2                                                    01651000
OPTSIOP  EQU   OPTS2                                                    01652000
OPTPI    EQU   OPTS2                                                    01653000
OPTPIP   EQU   OPTS2                                                    01654000
OPTIO    EQU   OPTS2                                                    01655000
OPTIOP   EQU   OPTS2                                                    01656000
OPTS3    EQU   AMDOPTWD+2                                               01657000
OPTEXT   EQU   OPTS3                                                    01658000
OPTRNIO  EQU   OPTS3                                                    01659000
OPTSRM   EQU   OPTS3                                                    01660000
OPTRR    EQU   OPTS3                                                    01661000
OPTIOSIO EQU   OPTS3                                                    01662000
OPTS4    EQU   AMDOPTWD+3                                               01663000
OPTTIME  EQU   OPTS4                                                    01664000
PRGET    EQU   0                                                        01665000
PRCON    EQU   0                                                        01666000
PRFLT    EQU   0                                                        01667000
RECMAP   EQU   0                                                        01668000
RECAID   EQU   RECMAP+4                                                 01669000
RECFID   EQU   RECMAP+5                                                 01670000
RECTIME  EQU   RECMAP+6                                                 01671000
RECVTTZ  EQU   RECTIME                                                  01672000
RECTOD   EQU   RECTIME+4                                                01673000
RECGTFOP EQU   RECMAP+18                                                01674000
SVHKREC  EQU   0                                                        01675000
SVHKDATA EQU   SVHKREC+6                                                01676000
TODCNVRT EQU   0                                                        01677000
AMDPRE02 EQU   12                                                       01678000
AMDPRE09 EQU   20                                                       01679000
AMDPRE10 EQU   24                                                       01680000
AMDPRE14 EQU   28                                                       01681000
AMDPRE11 EQU   52                                                       01682000
PRAPP    EQU   0                                                        01683000
PREXT    EQU   0                                                        01684000
PRHEX    EQU   0                                                        01685000
PRSPI    EQU   0                                                        01686000
PRTME    EQU   0                                                        01687000
TIMEBUF  EQU   49                                                       01688000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01689000
SVHKTCB  EQU   SVHKDATA+4                                               01690000
SVHKASID EQU   SVHKDATA+2                                               01691000
SVHKEID  EQU   SVHKDATA                                                 01692000
SVHKAFID EQU   SVHKREC+4                                                01693000
@NM00002 EQU   SVHKREC+2                                                01694000
SVHKLEN  EQU   SVHKREC                                                  01695000
RECLSTEV EQU   RECGTFOP                                                 01696000
RECRES1  EQU   RECMAP+2                                                 01697000
RECLL    EQU   RECMAP                                                   01698000
OPTRES3  EQU   OPTS4                                                    01699000
OPTRES2  EQU   OPTS3                                                    01700000
OPTRES1  EQU   OPTS1                                                    01701000
RESERVED EQU   AMDPRTAB+522                                             01702000
ESPSEC   EQU   ESTOPTME+7                                               01703000
ESPMIN   EQU   ESTOPTME+5                                               01704000
ESPHR    EQU   ESTOPTME+3                                               01705000
ESPDAY   EQU   ESTOPTME                                                 01706000
ESSEC    EQU   ESTARTME+7                                               01707000
ESMIN    EQU   ESTARTME+5                                               01708000
ESHR     EQU   ESTARTME+3                                               01709000
ESDAY    EQU   ESTARTME                                                 01710000
ADTSBUF  EQU   AMDPRTAB+496                                             01711000
OFSTDATA EQU   AMDPRTAB+494                                             01712000
OFSTEID  EQU   AMDPRTAB+492                                             01713000
AEIOCT   EQU   AMDPRTAB+476                                             01714000
EXITADDR EQU   AMDPRTAB+472                                             01715000
EXITNM   EQU   AMDPRTAB+464                                             01716000
RECDLL   EQU   AMDPRTAB+461                                             01717000
@NM00001 EQU   GENFLGS1                                                 01718000
FIRSTHSW EQU   GENFLGS1                                                 01719000
EOFINPRO EQU   GENFLGS1                                                 01720000
TS       EQU   GENFLGS1                                                 01721000
EOF      EQU   GENFLAGS                                                 01722000
RR       EQU   GENFLAGS                                                 01723000
SRM      EQU   GENFLAGS                                                 01724000
RNIO     EQU   GENFLAGS                                                 01725000
DSP      EQU   GENFLAGS                                                 01726000
EXT      EQU   GENFLAGS                                                 01727000
PICODEA  EQU   PGMNGEN+2                                                01728000
PICODES  EQU   PGMNGEN                                                  01729000
Q        EQU   PI+1                                                     01730000
P01R     EQU   PIFLGS                                                   01731000
SELP     EQU   PIFLGS                                                   01732000
ALLP     EQU   PIFLGS                                                   01733000
USRNGTAB EQU   USRTAB                                                   01734000
O        EQU   USR+1                                                    01735000
N01R     EQU   USRFLGS                                                  01736000
SELU     EQU   USRFLGS                                                  01737000
ALLU     EQU   USRFLGS                                                  01738000
SVCNUMS  EQU   AMDPRTAB+336                                             01739000
M        EQU   VCF+1                                                    01740000
L        EQU   SVCFLGS                                                  01741000
SELV     EQU   SVCFLGS                                                  01742000
ALLV     EQU   SVCFLGS                                                  01743000
IODVADS  EQU   DVADS2                                                   01744000
K01RES   EQU   IO+1                                                     01745000
JJ       EQU   IOFLGS2                                                  01746000
SELI     EQU   IOFLGS2                                                  01747000
ALLI     EQU   IOFLGS2                                                  01748000
SIODVADS EQU   DVADS1                                                   01749000
II       EQU   SIF+1                                                    01750000
H        EQU   SIOFLGS                                                  01751000
NOEQU    EQU   SIOFLGS                                                  01752000
EQUIV    EQU   SIOFLGS                                                  01753000
SELS     EQU   SIOFLGS                                                  01754000
ALLS     EQU   SIOFLGS                                                  01755000
ASCBADDR EQU   AADS                                                     01756000
DAY2     EQU   STOPTIME+10                                              01757000
F        EQU   STOPTIME+8                                               01758000
TIME2    EQU   STOPTIME                                                 01759000
DAY      EQU   STARTIME+10                                              01760000
D        EQU   STARTIME+8                                               01761000
TIME     EQU   STARTIME                                                 01762000
USEREXIT EQU   AMDPRTAB+24                                              01763000
C        EQU   DEBGFLGS+4                                               01764000
B        EQU   IOFLGS                                                   01765000
DMDFMT   EQU   INRFCFGS                                                 01766000
RET      EQU   INRFCFGS                                                 01767000
FMT      EQU   INRFCFGS                                                 01768000
SPIE     EQU   INRFCFGS                                                 01769000
FLMODE   EQU   INRFCFGS                                                 01770000
REMAIN   EQU   PTHFLGS2                                                 01771000
APP      EQU   PTHFLGS2                                                 01772000
REXT     EQU   PTHFLGS1                                                 01773000
FLT      EQU   PTHFLGS1                                                 01774000
HEX      EQU   PTHFLGS1                                                 01775000
CON      EQU   PTHFLGS1                                                 01776000
GET      EQU   PTHFLGS1                                                 01777000
SCN      EQU   PTHFLGS1                                                 01778000
ROOT     EQU   PTHFLGS1                                                 01779000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01780000
@RF00115 EQU   NEXTRTN                                                  01781000
@RT00142 EQU   CONOUT                                                   01782000
@RF00155 EQU   CONOUT                                                   01783000
@RF00162 EQU   NEXTRTN                                                  01784000
@RF00169 EQU   NEXTRTN                                                  01785000
@RT00177 EQU   NEXTRTN                                                  01786000
@RT00191 EQU   STARTEST                                                 01787000
@RC00196 EQU   NEXTRTN                                                  01788000
@RT00207 EQU   SETEXT                                                   01789000
@RT00209 EQU   NEXTRTN                                                  01790000
@RT00223 EQU   ASKOP                                                    01791000
@RT00238 EQU   EXTOK                                                    01792000
@RT00259 EQU   EXTOK                                                    01793000
@RF00259 EQU   DUMPEXT                                                  01794000
@RF00263 EQU   OPERR                                                    01795000
@RT00300 EQU   SELECTVE                                                 01796000
@RT00302 EQU   ALL                                                      01797000
@RF00302 EQU   NONE                                                     01798000
@RT00305 EQU   SELECTVE                                                 01799000
@RT00307 EQU   ALL                                                      01800000
@RF00307 EQU   NONE                                                     01801000
@RT00310 EQU   SELECTVE                                                 01802000
@RT00312 EQU   ALL                                                      01803000
@RF00312 EQU   NONE                                                     01804000
@RT00338 EQU   YES                                                      01805000
@RF00338 EQU   NO                                                       01806000
@RT00341 EQU   YES                                                      01807000
@RF00341 EQU   NO                                                       01808000
@RT00344 EQU   YES                                                      01809000
@RF00344 EQU   NO                                                       01810000
@RT00347 EQU   YES                                                      01811000
@RF00347 EQU   NO                                                       01812000
@RT00350 EQU   YES                                                      01813000
@RF00350 EQU   NO                                                       01814000
@RT00353 EQU   YES                                                      01815000
@RF00353 EQU   NO                                                       01816000
@RT00356 EQU   YES                                                      01817000
@RF00356 EQU   NO                                                       01818000
@RT00359 EQU   YES                                                      01819000
@RF00359 EQU   NO                                                       01820000
@ENDDATA EQU   *                                                        01821000
         END   AMDPRFRM,(C'PLS2235',0701,76211)                         01822000
