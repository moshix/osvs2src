         TITLE 'AMDPRFUB - USER BOUNDARY FIND ROUTINE                  *00001000
                        '                                               00002000
AMDPRFUB CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                          01S0001 00008000
         DC    C'AMDPRFUB  74.330'                              01S0001 00009000
MAINENT  DS    0H                                               01S0001 00010000
         USING *,@15                                            01S0001 00011000
         B     @PROLOG                                          01S0001 00012000
         DC    AL2(@EP00030-MAINENT)                                    00013000
         ENTRY MAINENT                                                  00014000
         DROP  @15                                                      00015000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00016000
         BALR  @11,0                                            01S0001 00017000
@PSTART  DS    0H                                               01S0001 00018000
         USING @PSTART,@11                                      01S0001 00019000
         ST    @13,@SA00001+4                                   01S0001 00020000
         LA    @14,@SA00001                                     01S0001 00021000
         ST    @14,8(,@13)                                      01S0001 00022000
         LR    @13,@14                                          01S0001 00023000
         AH    @15,4(,@15)                                      01S0001 00024000
         BR    @15                                              01S0001 00025000
@EP00001 MVC   @PC00001(12),0(@01)                              01S0001 00026000
*/*------------------------------------------------------------------*/ 00027000
*/* THE FOLLOWING INSTRUCTIONS ONLY GET EXECUTED ONCE WHEN FUB IS    */ 00028000
*/* CALLED BY AMDPRSEG FOR INITIALIZATION                            */ 00029000
*/*------------------------------------------------------------------*/ 00030000
*  ARGNBND = ADDR(MAINENT);       /* SUPPLY ENTRY ADDR IN COMMON     */ 00031000
         L     @10,@CA00543                                     01S0028 00032000
         ST    @10,ARGNBND(,COMBASE)                            01S0028 00033000
*  RETURN;                                                      01S0029 00034000
@EL00001 L     @13,4(,@13)                                      01S0029 00035000
@EF00001 DS    0H                                               01S0029 00036000
@ER00001 LM    @14,@12,12(@13)                                  01S0029 00037000
         BR    @14                                              01S0029 00038000
*/*------------------------------------------------------------------*/ 00039000
*/* THE FOLLOWING IS THE MAIN LINE CODE WHICH DETERMINES USER        */ 00040000
*/* BOUNDARIES                                                       */ 00041000
*/*------------------------------------------------------------------*/ 00042000
*MAINENT: ENTRY (INPASCB,INPASID,PCBPL);                        01S0030 00043000
@EP00030 MVC   @PC00001(12),0(@01)                              01S0030 00044000
*/*------------------------------------------------------------------*/ 00045000
*/* INITIALIZE SWITCHES AND DATA AREAS                               */ 00046000
*/*------------------------------------------------------------------*/ 00047000
*DO;                                                            02S0031 00048000
*  RESPECIFY R1 RESTRICTED;       /* RESTRICT R1 THROUGHOUT          */ 00049000
*  READSAVE = ERRADDR;            /* PREVIOUS ERROR ROUTINE          */ 00050000
         L     READSAVE,ERRADDR(,COMBASE)                       02S0033 00051000
*  ERRADDR = ADDR(FUBERROR);      /* PUT FUB ERROR RTN ADDR IN COMMON * 00052000
         LA    @10,FUBERROR                                     02S0034 00053000
         ST    @10,ERRADDR(,COMBASE)                            02S0034 00054000
*  FBQEEND = NO;                  /* INITIALIZE SWITCH               */ 00055000
         NI    FBQEEND,B'01111111'                              02S0035 00056000
*  RESPECIFY R13 RESTRICTED;                                    02S0036 00057000
*  FUBSAVE = R13;                 /* PRESERVE SAVE AREA ADDRESS FOR     00058000
*                                    ERROR ROUTINE ENTRY CODE        */ 00059000
         ST    R13,FUBSAVE                                      02S0037 00060000
*  RESPECIFY R13 UNRESTRICTED;                                  02S0038 00061000
*  ASCBPTR = INPASCB;             /* ADDRESS OF ASCB PASSED AS INPUT */ 00062000
         L     @10,@PC00001                                     02S0039 00063000
         L     ASCBPTR,INPASCB(,@10)                            02S0039 00064000
*  FUBFAIL = ON;                  /* WILL BE TURNED OFF IF SUCCESSFUL*/ 00065000
         OI    FUBFAIL,B'01000000'                              02S0040 00066000
*END;                                                           02S0041 00067000
*  RESPECIFY R2ASID RESTRICTED;                                 01S0042 00068000
*  R2ASID = INPASID;              /* USE INPUT ASID FOR BRREADS      */ 00069000
         L     @10,@PC00001+4                                   01S0043 00070000
         SLR   R2ASID,R2ASID                                    01S0043 00071000
         ICM   R2ASID,3,INPASID(@10)                            01S0043 00072000
*  /*      READ FOR ASCBLDA FIELD                                    */ 00073000
*                                                               01S0044 00074000
*  DO;                                                          01S0044 00075000
*    PREG = ADDR(ASCBLDA);                                      01S0045 00076000
         LA    PREG,ASCBLDA(,ASCBPTR)                           01S0045 00077000
*    RETCODE = 0;                                               01S0046 00078000
         SLR   @10,@10                                          01S0046 00079000
         ST    @10,RETCODE                                      01S0046 00080000
*    GEN(BRREAD (PREG),DATA,ASID=(R2ASID))                      01S0047 00081000
*       REFS(BRRDDATA)                                          01S0047 00082000
*       SETS(PREG,RETCODE)                                      01S0047 00083000
*       FLOWS(FUBERROR);                                        01S0047 00084000
         BRREAD (PREG),DATA,ASID=(R2ASID)                               00085000
*  END;                                                         01S0048 00086000
*  IF RETCODE=0 &DATAP24^=0 THEN  /* ADDR OF LDA IS OK               */ 00087000
         SLR   @10,@10                                          01S0049 00088000
         C     @10,RETCODE                                      01S0049 00089000
         BNE   @RF00049                                         01S0049 00090000
         ICM   @07,7,DATAP24(R1)                                01S0049 00091000
         BZ    @RF00049                                         01S0049 00092000
*    DO;                                                        01S0050 00093000
*      LDAPTR = DATAWORD;                                       01S0051 00094000
         L     LDAPTR,DATAWORD(,R1)                             01S0051 00095000
*      /*     READ FOR ADDRESS OF ADDRESS SPACE PQE IN LDA           */ 00096000
*                                                               01S0052 00097000
*      DO;                                                      01S0052 00098000
*        PREG = ADDR(ASDPQE);                                   01S0053 00099000
         LA    PREG,ASDPQE(,LDAPTR)                             01S0053 00100000
*        RETCODE = 0;                                           01S0054 00101000
         ST    @10,RETCODE                                      01S0054 00102000
*        GEN(BRREAD (PREG))                                     01S0055 00103000
*           REFS(BRRDDATA)                                      01S0055 00104000
*           SETS(PREG,RETCODE)                                  01S0055 00105000
*           FLOWS(FUBERROR);                                    01S0055 00106000
         BRREAD (PREG)                                                  00107000
*      END;                                                     01S0056 00108000
*      IF RETCODE=0 & DATAP24^=0 THEN /* PQE POINTER OBTAINED        */ 00109000
         SLR   @10,@10                                          01S0057 00110000
         C     @10,RETCODE                                      01S0057 00111000
         BNE   @RF00057                                         01S0057 00112000
         ICM   @07,7,DATAP24(R1)                                01S0057 00113000
         BZ    @RF00057                                         01S0057 00114000
*        DO;                                                    01S0058 00115000
*          RESPECIFY R2ASID UNRESTRICTED;                       01S0059 00116000
*          PQESEPTR = DATAWORD;   /* ADDRESS OF ADDRESS SPACE PQE    */ 00117000
         L     PQESEPTR,DATAWORD(,R1)                           01S0060 00118000
*/*------------------------------------------------------------------*/ 00119000
*/* GET FBQE CHAIN AND REGION BOUNDARIES FROM ADDRESS SPACE PQE      */ 00120000
*/*------------------------------------------------------------------*/ 00121000
*DO;                                                            02S0061 00122000
*  FUBFAIL = ON;                                                02S0062 00123000
         OI    FUBFAIL,B'01000000'                              02S0062 00124000
*  /*      GET POINTER TO FIRST FBQE                                 */ 00125000
*                                                               02S0063 00126000
*   DO;                                                         02S0063 00127000
*     PREG = ADDR(PQEFFBQE);                                    02S0064 00128000
         LR    PREG,PQESEPTR                                    02S0064 00129000
*     RETCODE = 0;                                              02S0065 00130000
         ST    @10,RETCODE                                      02S0065 00131000
*     GEN(BRREAD (PREG))                                        02S0066 00132000
*        REFS(BRRDDATA)                                         02S0066 00133000
*        SETS(PREG,RETCODE)                                     02S0066 00134000
*        FLOWS(FUBERROR);                                       02S0066 00135000
         BRREAD (PREG)                                                  00136000
*   END;                                                        02S0067 00137000
*  IF RETCODE=0 & DATAP24^=0 THEN /* FBQE ADDRESS IS OK              */ 00138000
         SLR   @10,@10                                          02S0068 00139000
         C     @10,RETCODE                                      02S0068 00140000
         BNE   @RF00068                                         02S0068 00141000
         ICM   @07,7,DATAP24(R1)                                02S0068 00142000
         BZ    @RF00068                                         02S0068 00143000
*    DO;                                                        02S0069 00144000
*      FIRSTFBQ = DATAWORD;       /* ADDRESS OF FIRST FBQE           */ 00145000
         MVC   FIRSTFBQ(4),DATAWORD(R1)                         02S0070 00146000
*      /*      GET SIZE OF REGION                                    */ 00147000
*                                                               02S0071 00148000
*      DO;                                                      02S0071 00149000
*        PREG = ADDR(PQESIZE);                                  02S0072 00150000
         LA    PREG,PQESIZE(,PQESEPTR)                          02S0072 00151000
*        RETCODE = 0;                                           02S0073 00152000
         ST    @10,RETCODE                                      02S0073 00153000
*        GEN(BRREAD (PREG))                                     02S0074 00154000
*           REFS(BRRDDATA)                                      02S0074 00155000
*           SETS(PREG,RETCODE)                                  02S0074 00156000
*           FLOWS(FUBERROR);                                    02S0074 00157000
         BRREAD (PREG)                                                  00158000
*      END;                                                     02S0075 00159000
*      IF RETCODE=0 & DATAWORD<TOTSIZE & DATAWORD>0 THEN /* SIZE OK  */ 00160000
         SLR   @10,@10                                          02S0076 00161000
         C     @10,RETCODE                                      02S0076 00162000
         BNE   @RF00076                                         02S0076 00163000
         L     @07,DATAWORD(,R1)                                02S0076 00164000
         C     @07,TOTSIZE                                      02S0076 00165000
         BNL   @RF00076                                         02S0076 00166000
         CR    @07,@10                                          02S0076 00167000
         BNH   @RF00076                                         02S0076 00168000
*        DO;                                                    02S0077 00169000
*          REGNSIZE = DATAWORD;   /* REGION SIZE                     */ 00170000
         LR    REGNSIZE,@07                                     02S0078 00171000
*          /*      GET ADDRESS OF REGION                             */ 00172000
*                                                               02S0079 00173000
*          DO;                                                  02S0079 00174000
*            PREG = ADDR(PQEREGN);                              02S0080 00175000
         LA    PREG,PQEREGN(,PQESEPTR)                          02S0080 00176000
*            RETCODE = 0;                                       02S0081 00177000
         ST    @10,RETCODE                                      02S0081 00178000
*            GEN(BRREAD (PREG))                                 02S0082 00179000
*               REFS(BRRDDATA)                                  02S0082 00180000
*               SETS(PREG,RETCODE)                              02S0082 00181000
*               FLOWS(FUBERROR);                                02S0082 00182000
         BRREAD (PREG)                                                  00183000
*          END;                                                 02S0083 00184000
*          IF RETCODE=0 & DATAP24^=0 THEN /* REGION ADDR OK          */ 00185000
         ICM   @10,15,RETCODE                                   02S0084 00186000
         BNZ   @RF00084                                         02S0084 00187000
         ICM   @10,7,DATAP24(R1)                                02S0084 00188000
         BZ    @RF00084                                         02S0084 00189000
*            DO;                                                02S0085 00190000
*              REGNADDR = DATAWORD; /* REGION ADDRESS                */ 00191000
         L     @10,DATAWORD(,R1)                                02S0086 00192000
         ST    @10,REGNADDR                                     02S0086 00193000
*              FUBFAIL = OFF;     /* ASPQE COPY WAS SUCCESSFUL       */ 00194000
         NI    FUBFAIL,B'10111111'                              02S0087 00195000
*              REGNTOP = REGNADDR + REGNSIZE;                   02S0088 00196000
         ALR   @10,REGNSIZE                                     02S0088 00197000
         ST    @10,REGNTOP                                      02S0088 00198000
*            END;                                               02S0089 00199000
*        END;                                                   02S0090 00200000
@RF00084 DS    0H                                               02S0091 00201000
*    END;                                                       02S0091 00202000
@RF00076 DS    0H                                               02S0092 00203000
*    IF FUBFAIL=OFF THEN          /* PRIVATE AREA HAS BEEN DETERMINED*/ 00204000
@RF00068 TM    FUBFAIL,B'01000000'                              02S0092 00205000
         BNZ   @RF00092                                         02S0092 00206000
*/*------------------------------------------------------------------*/ 00207000
*/* ALL MEMORIES EXCEPT THE MASTER SCHEDULER MEMORY HAVE A 4K        */ 00208000
*/* SYSTEM REGION JUST BELOW THE NORMAL REGION -- THE MASTER         */ 00209000
*/* SCHEDULER HAS A BIGGER SYSTEM REGION. THE FOLLOWING CODE         */ 00210000
*/* ADDS THIS SYSTEM REGION TO THE ALREADY OBTAINED REGION ADDR.     */ 00211000
*/*------------------------------------------------------------------*/ 00212000
*DO;                                                            03S0093 00213000
*  /*     READ FOR THE POINTER TO THE SYSTEM REGION PQE              */ 00214000
*                                                               03S0094 00215000
*  DO;                                                          03S0094 00216000
*    PREG = ADDR(LDASRPQE);                                     03S0095 00217000
         LA    PREG,LDASRPQE(,LDAPTR)                           03S0095 00218000
*    RETCODE = 0;                                               03S0096 00219000
         SLR   @10,@10                                          03S0096 00220000
         ST    @10,RETCODE                                      03S0096 00221000
*    GEN(BRREAD (PREG))                                         03S0097 00222000
*       REFS(BRRDDATA)                                          03S0097 00223000
*       SETS(PREG,RETCODE)                                      03S0097 00224000
*       FLOWS(FUBERROR);                                        03S0097 00225000
         BRREAD (PREG)                                                  00226000
*  END;                                                         03S0098 00227000
*  IF RETCODE=0 & DATAP24^=0 THEN /* THERE IS A PQE PTR              */ 00228000
         SLR   @10,@10                                          03S0099 00229000
         C     @10,RETCODE                                      03S0099 00230000
         BNE   @RF00099                                         03S0099 00231000
         ICM   @07,7,DATAP24(R1)                                03S0099 00232000
         BZ    @RF00099                                         03S0099 00233000
*    DO;                                                        03S0100 00234000
*      PQESEPTR = DATAWORD;                                     03S0101 00235000
         L     PQESEPTR,DATAWORD(,R1)                           03S0101 00236000
*      /*     READ FOR THE SIZE OF THE SYSTEM REGION                 */ 00237000
*                                                               03S0102 00238000
*      DO;                                                      03S0102 00239000
*        PREG = ADDR(PQESIZE);                                  03S0103 00240000
         LA    PREG,PQESIZE(,PQESEPTR)                          03S0103 00241000
*        RETCODE = 0;                                           03S0104 00242000
         ST    @10,RETCODE                                      03S0104 00243000
*        GEN(BRREAD (PREG))                                     03S0105 00244000
*           REFS(BRRDDATA)                                      03S0105 00245000
*           SETS(PREG,RETCODE)                                  03S0105 00246000
*           FLOWS(FUBERROR);                                    03S0105 00247000
         BRREAD (PREG)                                                  00248000
*      END;                                                     03S0106 00249000
*      IF RETCODE=0 & DATAWORD^=0 THEN /* SIZE WAS READ              */ 00250000
         SLR   @10,@10                                          03S0107 00251000
         C     @10,RETCODE                                      03S0107 00252000
         BNE   @RF00107                                         03S0107 00253000
         L     @07,DATAWORD(,R1)                                03S0107 00254000
         CR    @07,@10                                          03S0107 00255000
         BE    @RF00107                                         03S0107 00256000
*        DO;                                                    03S0108 00257000
*          SYSSIZE = DATAWORD;                                  03S0109 00258000
         LR    SYSSIZE,@07                                      03S0109 00259000
*          /* READ FOR THE STARTING ADDR OF THE SYSTEM REGION        */ 00260000
*                                                               03S0110 00261000
*          DO;                                                  03S0110 00262000
*            PREG = ADDR(PQEREGN);                              03S0111 00263000
         LA    PREG,PQEREGN(,PQESEPTR)                          03S0111 00264000
*            RETCODE = 0;                                       03S0112 00265000
         ST    @10,RETCODE                                      03S0112 00266000
*            GEN(BRREAD (PREG))                                 03S0113 00267000
*               REFS(BRRDDATA)                                  03S0113 00268000
*               SETS(PREG,RETCODE)                              03S0113 00269000
*               FLOWS(FUBERROR);                                03S0113 00270000
         BRREAD (PREG)                                                  00271000
*          END;                                                 03S0114 00272000
*          IF RETCODE=0 & DATAP24^=0 THEN /* REGION ADDR IS GOOD     */ 00273000
         ICM   @10,15,RETCODE                                   03S0115 00274000
         BNZ   @RF00115                                         03S0115 00275000
         ICM   @10,7,DATAP24(R1)                                03S0115 00276000
         BZ    @RF00115                                         03S0115 00277000
*            DO;                                                03S0116 00278000
*              SYSREGN = DATAWORD;                              03S0117 00279000
         L     SYSREGN,DATAWORD(,R1)                            03S0117 00280000
*              IF SYSREGN+SYSSIZE=REGNADDR THEN /* DATA LOOKS GOOD   */ 00281000
         LR    @10,SYSREGN                                      03S0118 00282000
         ALR   @10,SYSSIZE                                      03S0118 00283000
         C     @10,REGNADDR                                     03S0118 00284000
         BNE   @RF00118                                         03S0118 00285000
*                REGNADDR = SYSREGN; /* LOWER THE STARTING ADDR      */ 00286000
         ST    SYSREGN,REGNADDR                                 03S0119 00287000
*            END;                                               03S0120 00288000
@RF00118 DS    0H                                               03S0121 00289000
*        END;                                                   03S0121 00290000
@RF00115 DS    0H                                               03S0122 00291000
*    END;                                                       03S0122 00292000
@RF00107 DS    0H                                               03S0123 00293000
*END;                                                           03S0123 00294000
@RF00099 DS    0H                                               03S0124 00295000
*END;                                                           02S0124 00296000
@RF00092 DS    0H                                               02S0125 00297000
*          IF FUBFAIL=OFF THEN    /* ASDPQE WAS PROCESSED OK         */ 00298000
         TM    FUBFAIL,B'01000000'                              01S0125 00299000
         BNZ   @RF00125                                         01S0125 00300000
*/*------------------------------------------------------------------*/ 00301000
*/* LOOP THRU FBQES ELIMINATING FREE BLOCKS FROM PCBS                */ 00302000
*/*------------------------------------------------------------------*/ 00303000
*DO;                                                            02S0126 00304000
*  FBQEFAIL = OFF;                /* INIT TO GOOD                    */ 00305000
         NI    FBQEFAIL,B'11011111'                             02S0127 00306000
*  FROMPTR = FIRSTFBQ;                                          02S0128 00307000
         L     FROMPTR,FIRSTFBQ                                 02S0128 00308000
*  CALL COPYFBQE;                                               02S0129 00309000
         BAL   @14,COPYFBQE                                     02S0129 00310000
*  IF FBQEFAIL=OFF THEN           /* COPY WAS SUCCESSFUL             */ 00311000
         TM    FBQEFAIL,B'00100000'                             02S0130 00312000
         BNZ   @RF00130                                         02S0130 00313000
*    DO;                                                        02S0131 00314000
*      IF FBQAREA=REGNADDR THEN   /* FIRST PART OF REGION IS FREE    */ 00315000
         LA    @10,FBQECOPY                                     02S0132 00316000
         L     @07,FBQAREA(,@10)                                02S0132 00317000
         C     @07,REGNADDR                                     02S0132 00318000
         BNE   @RF00132                                         02S0132 00319000
*        DO;                                                    02S0133 00320000
*          IF SIZE<TOTSIZE THEN   /* VALID SIZE VALUE                */ 00321000
         L     @05,SIZE(,@10)                                   02S0134 00322000
         C     @05,TOTSIZE                                      02S0134 00323000
         BNL   @RF00134                                         02S0134 00324000
*            DO;                                                02S0135 00325000
*              PCBPBGN = FBQAREA+SIZE; /* SKIP OVER FREE SPACE       */ 00326000
         L     @02,@PC00001+8                                   02S0136 00327000
         ALR   @07,@05                                          02S0136 00328000
         ST    @07,PCBPBGN(,@02)                                02S0136 00329000
*              FROMPTR = FWDPTR;                                02S0137 00330000
         L     FROMPTR,FWDPTR(,@10)                             02S0137 00331000
*              CALL COPYFBQE;     /* GET NEXT FBQE                   */ 00332000
         BAL   @14,COPYFBQE                                     02S0138 00333000
*            END;                                               02S0139 00334000
*          ELSE                                                 02S0140 00335000
*            FBQEFAIL = ON;       /* CANT USE FBQES                  */ 00336000
         B     @RC00134                                         02S0140 00337000
@RF00134 OI    FBQEFAIL,B'00100000'                             02S0140 00338000
*        END;                                                   02S0141 00339000
*      ELSE                       /* V=V REGION                      */ 00340000
*        PCBPBGN = REGNADDR;                                    02S0142 00341000
         B     @RC00132                                         02S0142 00342000
@RF00132 L     @10,@PC00001+8                                   02S0142 00343000
         MVC   PCBPBGN(4,@10),REGNADDR                          02S0142 00344000
*      DO I=1 TO FBQEMAX WHILE FBQEEND=NO & FBQEFAIL=OFF;       02S0143 00345000
@RC00132 LA    I,1                                              02S0143 00346000
@DL00143 TM    FBQEEND,B'10100000'                              02S0143 00347000
         BNZ   @DC00143                                         02S0143 00348000
*        PCBPEND = FBQAREA;                                     02S0144 00349000
         L     @10,@PC00001+8                                   02S0144 00350000
         LA    @07,FBQECOPY                                     02S0144 00351000
         L     @07,FBQAREA(,@07)                                02S0144 00352000
         ST    @07,PCBPEND(,@10)                                02S0144 00353000
*        R1 = ADDR(PCBPL);                                      02S0145 00354000
         LR    R1,@10                                           02S0145 00355000
*        PCBPFUNC = PCBPENQ;                                    02S0146 00356000
         NI    PCBPFUNC(@10),B'01111111'                        02S0146 00357000
*        IF PCBPBGN<PCBPEND THEN  /* RANGE IS VALID                  */ 00358000
         C     @07,PCBPBGN(,@10)                                02S0147 00359000
         BNH   @RF00147                                         02S0147 00360000
*          CALL PCBENQ;           /* ENQ A PCB                       */ 00361000
         L     @15,APCBENQ(,COMBASE)                            02S0148 00362000
         BALR  @14,@15                                          02S0148 00363000
*        ELSE                                                   02S0149 00364000
*          FBQEFAIL = ON;         /* TERMINATE FBQE LOOP             */ 00365000
         B     @RC00147                                         02S0149 00366000
@RF00147 OI    FBQEFAIL,B'00100000'                             02S0149 00367000
*        IF FBQEFAIL=OFF THEN     /* STILL OK                        */ 00368000
@RC00147 TM    FBQEFAIL,B'00100000'                             02S0150 00369000
         BNZ   @RF00150                                         02S0150 00370000
*          DO;                                                  02S0151 00371000
*            IF SIZE<TOTSIZE THEN /* VALID SIZE                      */ 00372000
         LA    @10,FBQECOPY                                     02S0152 00373000
         L     @07,SIZE(,@10)                                   02S0152 00374000
         C     @07,TOTSIZE                                      02S0152 00375000
         BNL   @RF00152                                         02S0152 00376000
*              DO;                                              02S0153 00377000
*                PCBPBGN = FBQAREA+SIZE;                        02S0154 00378000
         L     @15,@PC00001+8                                   02S0154 00379000
         AL    @07,FBQAREA(,@10)                                02S0154 00380000
         ST    @07,PCBPBGN(,@15)                                02S0154 00381000
*                IF FWDPTR=PQESEPTR THEN /* LOOP IS ALL DONE         */ 00382000
         C     PQESEPTR,FWDPTR(,@10)                            02S0155 00383000
         BNE   @RF00155                                         02S0155 00384000
*                  DO;                                          02S0156 00385000
*                    FBQEEND = YES; /* STOP LOOP                     */ 00386000
         OI    FBQEEND,B'10000000'                              02S0157 00387000
*                    PCBPEND = REGNTOP;                         02S0158 00388000
         L     @10,REGNTOP                                      02S0158 00389000
         ST    @10,PCBPEND(,@15)                                02S0158 00390000
*                    R1 = ADDR(PCBPL);                          02S0159 00391000
         LR    R1,@15                                           02S0159 00392000
*                    IF PCBPBGN<PCBPEND THEN /* VALID RANGE          */ 00393000
         CR    @07,@10                                          02S0160 00394000
         BNL   @RF00160                                         02S0160 00395000
*                      CALL PCBENQ; /* ENQ LAST PCB                  */ 00396000
         L     @15,APCBENQ(,COMBASE)                            02S0161 00397000
         BALR  @14,@15                                          02S0161 00398000
*                    ELSE                                       02S0162 00399000
*                      FBQEFAIL = ON; /* USE PQE DATA                */ 00400000
         B     @RC00160                                         02S0162 00401000
@RF00160 OI    FBQEFAIL,B'00100000'                             02S0162 00402000
*                  END;                                         02S0163 00403000
*                ELSE             /* MORE FBQES TO COME              */ 00404000
*                  DO;                                          02S0164 00405000
         B     @RC00155                                         02S0164 00406000
@RF00155 DS    0H                                               02S0165 00407000
*                    FROMPTR = FWDPTR;                          02S0165 00408000
         LA    @10,FBQECOPY                                     02S0165 00409000
         L     FROMPTR,FWDPTR(,@10)                             02S0165 00410000
*                    CALL COPYFBQE; /* GET NEXT FBQE                 */ 00411000
         BAL   @14,COPYFBQE                                     02S0166 00412000
*                  END;                                         02S0167 00413000
*              END;                                             02S0168 00414000
*            ELSE                 /* INVALID SIZE                    */ 00415000
*              FBQEFAIL = ON;     /* STOP FBQE LOOP - USE PQE DATA   */ 00416000
         B     @RC00152                                         02S0169 00417000
@RF00152 OI    FBQEFAIL,B'00100000'                             02S0169 00418000
*          END;                                                 02S0170 00419000
@RC00152 DS    0H                                               02S0171 00420000
*      END;                                                     02S0171 00421000
@RF00150 AH    I,@CH00047                                       02S0171 00422000
         CH    I,@CH00521                                       02S0171 00423000
         BNH   @DL00143                                         02S0171 00424000
@DC00143 DS    0H                                               02S0172 00425000
*    END;                                                       02S0172 00426000
*    IF FBQEFAIL=ON | FBQEEND=OFF THEN /* MUST USE PQE DATA          */ 00427000
@RF00130 TM    FBQEFAIL,B'00100000'                             02S0173 00428000
         BNZ   @RT00173                                         02S0173 00429000
         TM    FBQEEND,B'10000000'                              02S0173 00430000
         BO    @RF00173                                         02S0173 00431000
@RT00173 DS    0H                                               02S0174 00432000
*/*------------------------------------------------------------------*/ 00433000
*/* DEQUEUE ANY PCBS ENQUEUED THUS FAR AND ENQUEUE ONE PCB FOR THE   */ 00434000
*/* ENTIRE PRIVATE AREA AS DESCRIBED BY THE ASPQE                    */ 00435000
*/*------------------------------------------------------------------*/ 00436000
*DO;                                                            03S0174 00437000
*  DO WHILE PCBPTR^=0;            /* DEQUEUE ALL PCBS                */ 00438000
         B     @DE00175                                         03S0175 00439000
@DL00175 DS    0H                                               03S0176 00440000
*    PCBPFUNC = PCBPDEQ;                                        03S0176 00441000
         L     @10,@PC00001+8                                   03S0176 00442000
         OI    PCBPFUNC(@10),B'10000000'                        03S0176 00443000
*    R1 = ADDR(PCBPL);                                          03S0177 00444000
         LR    R1,@10                                           03S0177 00445000
*    CALL PCBENQ;                                               03S0178 00446000
         L     @15,APCBENQ(,COMBASE)                            03S0178 00447000
         BALR  @14,@15                                          03S0178 00448000
*  END;                                                         03S0179 00449000
@DE00175 ICM   @10,15,PCBPTR(COMBASE)                           03S0179 00450000
         BNZ   @DL00175                                         03S0179 00451000
*  PCBPFUNC = PCBPENQ;                                          03S0180 00452000
         L     @10,@PC00001+8                                   03S0180 00453000
         NI    PCBPFUNC(@10),B'01111111'                        03S0180 00454000
*  PCBPBGN = REGNADDR;                                          03S0181 00455000
         MVC   PCBPBGN(4,@10),REGNADDR                          03S0181 00456000
*  PCBPEND = REGNTOP;                                           03S0182 00457000
         MVC   PCBPEND(4,@10),REGNTOP                           03S0182 00458000
*  R1 = ADDR(PCBPL);                                            03S0183 00459000
         LR    R1,@10                                           03S0183 00460000
*  CALL PCBENQ;                   /* ENQ ONE PCB FOR ENTIRE REGION   */ 00461000
         L     @15,APCBENQ(,COMBASE)                            03S0184 00462000
         BALR  @14,@15                                          03S0184 00463000
*END;                                                           03S0185 00464000
*END;                                                           02S0186 00465000
@RF00173 DS    0H                                               02S0187 00466000
*        END;                                                   01S0187 00467000
@RF00125 DS    0H                                               01S0188 00468000
*    END;                                                       01S0188 00469000
@RF00057 DS    0H                                               01S0189 00470000
*  IF FUBFAIL=ON THEN             /* REGION BOUNDS ARE UNOBTAINABLE  */ 00471000
@RF00049 TM    FUBFAIL,B'01000000'                              01S0189 00472000
         BNO   @RF00189                                         01S0189 00473000
*    DO;                                                        01S0190 00474000
*      MESSAGE = UNABLMSG;                                      01S0191 00475000
         L     @10,CURBUF(,COMBASE)                             01S0191 00476000
         MVC   MESSAGE+1(64,@10),UNABLMSG                       01S0191 00477000
*      GEN REFS(AWRITE) (BRWRITE 2); /* ISSUE MESSAGE                */ 00478000
         BRWRITE 2                                                      00479000
*      PCBPBGN = NUCTOP;          /* USE DEFAULT FROM COMMON         */ 00480000
         L     @10,@PC00001+8                                   01S0193 00481000
         MVC   PCBPBGN(4,@10),NUCTOP(COMBASE)                   01S0193 00482000
*      PCBPEND = DFLTCSA;         /* USE DEFAULT FROM COMMON         */ 00483000
         MVC   PCBPEND(4,@10),DFLTCSA(COMBASE)                  01S0194 00484000
*      PCBPFUNC = PCBPENQ;                                      01S0195 00485000
         NI    PCBPFUNC(@10),B'01111111'                        01S0195 00486000
*      R1 = ADDR(PCBPL);                                        01S0196 00487000
         LR    R1,@10                                           01S0196 00488000
*      CALL PCBENQ;               /* ENQ A PCB                       */ 00489000
         L     @15,APCBENQ(,COMBASE)                            01S0197 00490000
         BALR  @14,@15                                          01S0197 00491000
*    END;                                                       01S0198 00492000
*  ERRADDR = READSAVE;            /* RESTORE PREVIOUS ERROR RTN      */ 00493000
@RF00189 ST    READSAVE,ERRADDR(,COMBASE)                       01S0199 00494000
*  RETURN;                                                      01S0200 00495000
         B     @EL00001                                         01S0200 00496000
*/*------------------------------------------------------------------*/ 00497000
*/* FUBERROR IS THE ROUTINE THAT GETS CONTROL IF A BRREAD FAILS      */ 00498000
*/* RETCODE IS SET TO INDICATE A READ FAILURE AND CONTROL IS         */ 00499000
*/* RETURN TO THE MAINLINE FOLLOWING THE READ                        */ 00500000
*/*------------------------------------------------------------------*/ 00501000
*FUBERROR:                                                      02S0201 00502000
*  RESPECIFY R14 RESTRICTED;                                    02S0201 00503000
FUBERROR DS    0H                                               02S0202 00504000
*  GENERATE REFS(FUBSAVE);                                      02S0202 00505000
              USING *,R15         SET UP ADDRESSABILITY                 00506000
              L     R13,FUBSAVE                                         00507000
              LM    R14,R12,12(R13)                                     00508000
              DROP  R15                                                 00509000
*  RETCODE = 4;                   /* INDICATE READ FAILURE           */ 00510000
         MVC   RETCODE(4),@CF00107                              02S0203 00511000
*  GO TO MAINLINE;                /* BRANCH TO APPROPRIATE ROUTINE   */ 00512000
         BR    R14                                              02S0204 00513000
*  RESPECIFY R14 UNRESTRICTED;                                  02S0205 00514000
*/*------------------------------------------------------------------*/ 00515000
*/* MAKE A COPY OF THE FBQE                                          */ 00516000
*/*------------------------------------------------------------------*/ 00517000
*COPYFBQE: PROCEDURE;                                           02S0206 00518000
COPYFBQE STM   @14,@12,@SA00002                                 02S0206 00519000
*  DO TOPTR = ADDR(FBQECOPY) TO ADDR(FBQECOPY)+LENGTH(FBQESECT)-1       00520000
*        BY WORDLGT;                                            02S0207 00521000
         LA    TOPTR,FBQECOPY                                   02S0207 00522000
         B     @DE00207                                         02S0207 00523000
@DL00207 DS    0H                                               02S0208 00524000
*    /*     GET ONE WORD OF DATA FORM DUMP                           */ 00525000
*                                                               02S0208 00526000
*    DO;                                                        02S0208 00527000
*      PREG = ADDR(COPYFROM);                                   02S0209 00528000
         LR    PREG,FROMPTR                                     02S0209 00529000
*      RETCODE = 0;                                             02S0210 00530000
         SLR   @10,@10                                          02S0210 00531000
         ST    @10,RETCODE                                      02S0210 00532000
*      GEN(BRREAD (PREG))                                       02S0211 00533000
*         REFS(BRRDDATA)                                        02S0211 00534000
*         SETS(PREG,RETCODE)                                    02S0211 00535000
*         FLOWS(FUBERROR);                                      02S0211 00536000
         BRREAD (PREG)                                                  00537000
*    END;                                                       02S0212 00538000
*    IF RETCODE=0 & DATAP24^=0 THEN /* DATA IS OK                    */ 00539000
         ICM   @10,15,RETCODE                                   02S0213 00540000
         BNZ   @RF00213                                         02S0213 00541000
         ICM   @10,7,DATAP24(R1)                                02S0213 00542000
         BZ    @RF00213                                         02S0213 00543000
*      DO;                                                      02S0214 00544000
*        COPYW = DATAWORD;                                      02S0215 00545000
         MVC   COPYW(4,TOPTR),DATAWORD(R1)                      02S0215 00546000
*        FROMPTR = FROMPTR + WORDLGT; /* INCREMENT TO GET NEXT WORD  */ 00547000
         AH    FROMPTR,@CH00107                                 02S0216 00548000
*      END;                                                     02S0217 00549000
*    ELSE                         /* DATA IS NOT IN THE DUMP         */ 00550000
*      FBQEFAIL = ON;             /* INDICATE FAILURE                */ 00551000
         B     @RC00213                                         02S0218 00552000
@RF00213 OI    FBQEFAIL,B'00100000'                             02S0218 00553000
*  END;                                                         02S0219 00554000
@RC00213 AH    TOPTR,@CH00107                                   02S0219 00555000
@DE00207 LA    @10,FBQECOPY                                     02S0219 00556000
         SH    @10,@CH00556                                     02S0219 00557000
         CR    TOPTR,@10                                        02S0219 00558000
         BNH   @DL00207                                         02S0219 00559000
*END COPYFBQE;                                                  02S0220 00560000
@EL00002 DS    0H                                               02S0220 00561000
@EF00002 DS    0H                                               02S0220 00562000
@ER00002 LM    @14,@12,@SA00002                                 02S0220 00563000
         BR    @14                                              02S0220 00564000
*END AMDPRFUB                                                   01S0221 00565000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00566000
*/*%INCLUDE SYSUT5  (PROLOGUE)                                        * 00567000
*/*%INCLUDE SYSUT5  (FUBFL1  )                                        * 00568000
*/*%INCLUDE SYSUT5  (DECLARES)                                        * 00569000
*/*%INCLUDE SYSLIB  (IHALDA  )                                        * 00570000
*/*%INCLUDE SYSLIB  (IHAPQE  )                                        * 00571000
*/*%INCLUDE SYSLIB  (IHAFBQE )                                        * 00572000
*/*%INCLUDE SYSLIB  (IHAASCB )                                        * 00573000
*/*%INCLUDE SYSLIB  (COMMON  )                                        * 00574000
*/*%INCLUDE SYSLIB  (AMDPCBPL)                                        * 00575000
*/*%INCLUDE SYSUT5  (INIT    )                                        * 00576000
*/*%INCLUDE SYSUT5  (COPYAPQE)                                        * 00577000
*/*%INCLUDE SYSUT5  (SYSRGN  )                                        * 00578000
*/*%INCLUDE SYSUT5  (FBQELOOP)                                        * 00579000
*/*%INCLUDE SYSUT5  (ENQALL  )                                        * 00580000
*/*%INCLUDE SYSUT5  (FUBERROR)                                        * 00581000
*/*%INCLUDE SYSUT5  (COPYFBQE)                                        * 00582000
*;                                                              01S0221 00583000
@DATA    DS    0H                                                       00584000
@CH00047 DC    H'1'                                                     00585000
@CH00521 DC    H'50'                                                    00586000
@CH00556 DC    H'-15'                                                   00587000
         DS    0F                                                       00588000
@SA00001 DS    18F                                                      00589000
@PC00001 DS    3F                                                       00590000
@SA00002 DS    15F                                                      00591000
         DS    0F                                                       00592000
@CF00107 DC    F'4'                                                     00593000
@CH00107 EQU   @CF00107+2                                               00594000
@CA00543 DC    A(MAINENT)                                               00595000
         DS    0D                                                       00596000
FBQESPTR DS    A                                                        00597000
FUBSAVE  DS    A                                                        00598000
FIRSTFBQ DS    A                                                        00599000
REGNADDR DS    A                                                        00600000
REGNTOP  DS    A                                                        00601000
RETCODE  DS    F                                                        00602000
TOTSIZE  DC    F'16777216'                                              00603000
FBQECOPY DS    CL16                                                     00604000
SWITCHES DS    CL1                                                      00605000
         ORG   SWITCHES                                                 00606000
FBQEEND  DS    BL1                                                      00607000
FUBFAIL  EQU   SWITCHES+0                                               00608000
FBQEFAIL EQU   SWITCHES+0                                               00609000
@NM00054 EQU   SWITCHES+0                                               00610000
         ORG   SWITCHES+1                                               00611000
UNABLMSG DC    CL64'UNABLE TO DETERMINE BOUNDS OF PRIVATE AREA - DEFAULC00612000
               T VALUES USED'                                           00613000
         DS    CL3                                                      00614000
PQECOPY  DS    CL32                                                     00615000
PATCH    DC    20F'0'                                                   00616000
AMDPRFUB CSECT                                                          00617000
DTAE     EQU   32                  DATA EBCDIC BIT                      00618000
DTAC     EQU   16                  DATA IN CORE BIT                     00619000
DTAP     EQU   8                   DATA PTR BIT                         00620000
DTA      EQU   4                   DATA INCLUDED BIT                    00621000
LBLP     EQU   2                   LABEL PTR BIT                        00622000
LBL      EQU   1                   LABEL INCLUDED BIT                   00623000
AMDPRFUB CSECT                                                          00624000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00625000
@01      EQU   01                                                       00626000
@02      EQU   02                                                       00627000
@03      EQU   03                                                       00628000
@04      EQU   04                                                       00629000
@05      EQU   05                                                       00630000
@06      EQU   06                                                       00631000
@07      EQU   07                                                       00632000
@08      EQU   08                                                       00633000
@09      EQU   09                                                       00634000
@10      EQU   10                                                       00635000
@11      EQU   11                                                       00636000
@12      EQU   12                                                       00637000
@13      EQU   13                                                       00638000
@14      EQU   14                                                       00639000
@15      EQU   15                                                       00640000
SYSSIZE  EQU   @05                                                      00641000
SYSREGN  EQU   @03                                                      00642000
REGNSIZE EQU   @05                                                      00643000
I        EQU   @05                                                      00644000
READSAVE EQU   @06                                                      00645000
FROMPTR  EQU   @03                                                      00646000
TOPTR    EQU   @04                                                      00647000
ASCBPTR  EQU   @03                                                      00648000
PQESEPTR EQU   @04                                                      00649000
LDAPTR   EQU   @03                                                      00650000
R1       EQU   @01                                                      00651000
R13      EQU   @13                                                      00652000
R14      EQU   @14                                                      00653000
COMBASE  EQU   @12                                                      00654000
PREG     EQU   @01                                                      00655000
R2ASID   EQU   @02                                                      00656000
BASE1    EQU   @11                                                      00657000
BASE2    EQU   @10                                                      00658000
BASE3    EQU   @09                                                      00659000
BUFREG   EQU   @06                                                      00660000
CNTREG   EQU   @03                                                      00661000
LINEREG  EQU   @08                                                      00662000
R0       EQU   @00                                                      00663000
R10      EQU   @10                                                      00664000
R11      EQU   @11                                                      00665000
R12      EQU   @12                                                      00666000
R15      EQU   @15                                                      00667000
R2       EQU   @02                                                      00668000
R3       EQU   @03                                                      00669000
R4       EQU   @04                                                      00670000
R5       EQU   @05                                                      00671000
R6       EQU   @06                                                      00672000
R7       EQU   @07                                                      00673000
R8       EQU   @08                                                      00674000
R9       EQU   @09                                                      00675000
STOPBASE EQU   @05                                                      00676000
LDA      EQU   0                                                        00677000
LVSMFLAG EQU   LDA                                                      00678000
ASDPQE   EQU   LDA+8                                                    00679000
LDASRPQE EQU   LDA+1476                                                 00680000
PQESECT  EQU   0                                                        00681000
PQEFFBQE EQU   PQESECT                                                  00682000
PQESIZE  EQU   PQESECT+20                                               00683000
PQEREGN  EQU   PQESECT+24                                               00684000
VMMFLGS  EQU   PQESECT+30                                               00685000
FBQESECT EQU   0                                                        00686000
FWDPTR   EQU   FBQESECT                                                 00687000
SIZE     EQU   FBQESECT+8                                               00688000
FBQAREA  EQU   FBQESECT+12                                              00689000
ASCB     EQU   0                                                        00690000
ASCBLDA  EQU   ASCB+48                                                  00691000
ASCBFW1  EQU   ASCB+100                                                 00692000
ASCBRCTF EQU   ASCBFW1+2                                                00693000
ASCBFLG1 EQU   ASCBFW1+3                                                00694000
ASCBDSP1 EQU   ASCB+114                                                 00695000
ASCBFLG2 EQU   ASCB+115                                                 00696000
COMMON   EQU   0                                                        00697000
ERRADDR  EQU   COMMON                                                   00698000
NUCTOP   EQU   COMMON+32                                                00699000
CURBUF   EQU   COMMON+48                                                00700000
PCBPTR   EQU   COMMON+60                                                00701000
SWA      EQU   COMMON+122                                               00702000
SWB      EQU   COMMON+123                                               00703000
SWC      EQU   COMMON+124                                               00704000
SWD      EQU   COMMON+125                                               00705000
SWE      EQU   COMMON+126                                               00706000
SWF      EQU   COMMON+127                                               00707000
BUFSW    EQU   COMMON+128                                               00708000
PRSW     EQU   COMMON+129                                               00709000
TABLE    EQU   COMMON+659                                               00710000
HEXTABL  EQU   TABLE+63                                                 00711000
AWRITE   EQU   COMMON+1500                                              00712000
ARGNBND  EQU   COMMON+1524                                              00713000
APCBENQ  EQU   COMMON+1560                                              00714000
DCBADDRS EQU   COMMON+1608                                              00715000
@NM00044 EQU   DCBADDRS+16                                              00716000
@NM00045 EQU   @NM00044                                                 00717000
BRRDDATA EQU   COMMON+1984                                              00718000
DFLTCSA  EQU   COMMON+2056                                              00719000
COPYW    EQU   0                                                        00720000
COPYFROM EQU   0                                                        00721000
MAINLINE EQU   0                                                        00722000
DATAWORD EQU   0                                                        00723000
DATAP24  EQU   DATAWORD+1                                               00724000
PCBENQ   EQU   0                                                        00725000
MESSAGE  EQU   0                                                        00726000
INPASCB  EQU   0                                                        00727000
INPASID  EQU   0                                                        00728000
PCBPL    EQU   0                                                        00729000
PCBPBGN  EQU   PCBPL                                                    00730000
PCBPEND  EQU   PCBPL+4                                                  00731000
PCBPFLG1 EQU   PCBPL+10                                                 00732000
PCBPFLG2 EQU   PCBPL+11                                                 00733000
PCBPFUNC EQU   PCBPFLG2                                                 00734000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00735000
@NM00052 EQU   PCBPFLG2                                                 00736000
@NM00051 EQU   PCBPFLG1                                                 00737000
PCBPTOPC EQU   PCBPFLG1                                                 00738000
PCBPLOWC EQU   PCBPFLG1                                                 00739000
PCBPREAL EQU   PCBPFLG1                                                 00740000
PCBPVIRT EQU   PCBPFLG1                                                 00741000
PCBPASID EQU   PCBPL+8                                                  00742000
@NM00053 EQU   DATAWORD                                                 00743000
CSADDR   EQU   COMMON+2072                                              00744000
@NM00050 EQU   COMMON+2070                                              00745000
TOPICHDR EQU   COMMON+2060                                              00746000
LPAMAX   EQU   COMMON+2052                                              00747000
DNUCTOP  EQU   COMMON+2048                                              00748000
XLMAX    EQU   COMMON+2044                                              00749000
DQEMAX   EQU   COMMON+2042                                              00750000
ASCBMAX  EQU   COMMON+2040                                              00751000
TCBMAX   EQU   COMMON+2038                                              00752000
SRBMAX   EQU   COMMON+2036                                              00753000
DDMAX    EQU   COMMON+2034                                              00754000
DEBMAX   EQU   COMMON+2032                                              00755000
JPQMAX   EQU   COMMON+2030                                              00756000
LLEMAX   EQU   COMMON+2028                                              00757000
PQEMAX   EQU   COMMON+2026                                              00758000
RBMAX    EQU   COMMON+2024                                              00759000
@NM00049 EQU   COMMON+2023                                              00760000
EXITFLAG EQU   COMMON+2022                                              00761000
AUSRASID EQU   COMMON+2020                                              00762000
AUSRTCBA EQU   COMMON+2016                                              00763000
AUSRDEL  EQU   COMMON+2012                                              00764000
AUSREXIT EQU   COMMON+2008                                              00765000
AUSRINIT EQU   COMMON+2004                                              00766000
ASRBFMT  EQU   COMMON+2000                                              00767000
AASCBFMT EQU   COMMON+1996                                              00768000
BRRDADJ  EQU   COMMON+1992                                              00769000
BRRDINIT EQU   COMMON+1988                                              00770000
BUFERMAP EQU   COMMON+1980                                              00771000
ASCBMAP  EQU   COMMON+1976                                              00772000
CPUMAP   EQU   COMMON+1972                                              00773000
ASIDNDX  EQU   COMMON+1968                                              00774000
@NM00048 EQU   COMMON+1964                                              00775000
HDRTITLE EQU   COMMON+1864                                              00776000
HDRREGS  EQU   COMMON+1696                                              00777000
SACSWCAW EQU   COMMON+1684                                              00778000
ASVTADDR EQU   COMMON+1680                                              00779000
PREFXRGV EQU   COMMON+1676                                              00780000
PREFXRGR EQU   COMMON+1672                                              00781000
CURASCB  EQU   COMMON+1668                                              00782000
IPLCPU   EQU   COMMON+1666                                              00783000
QASID    EQU   COMMON+1664                                              00784000
QAPFT    EQU   COMMON+1660                                              00785000
@NM00047 EQU   COMMON+1656                                              00786000
REALMAX  EQU   COMMON+1652                                              00787000
SEGTABOR EQU   COMMON+1648                                              00788000
REALMAP  EQU   COMMON+1644                                              00789000
@NM00046 EQU   COMMON+1641                                              00790000
EDITER   EQU   COMMON+1640                                              00791000
AROOT    EQU   COMMON+1636                                              00792000
AEDITCB  EQU   COMMON+1632                                              00793000
TRCCOUNT EQU   COMMON+1628                                              00794000
ASYSUDCB EQU   @NM00044+1                                               00795000
ENDLIST  EQU   @NM00045                                                 00796000
AINDCB   EQU   DCBADDRS+12                                              00797000
ARDRDCB  EQU   DCBADDRS+8                                               00798000
APTRDCB  EQU   DCBADDRS+4                                               00799000
AOUTDCB  EQU   DCBADDRS                                                 00800000
ATCBSMRY EQU   COMMON+1604                                              00801000
ATCBSMFR EQU   COMMON+1600                                              00802000
ONGOPTR  EQU   COMMON+1596                                              00803000
AEND     EQU   COMMON+1592                                              00804000
AERRMSGA EQU   COMMON+1584                                              00805000
BUFREINT EQU   COMMON+1580                                              00806000
BUFSUM   EQU   COMMON+1576                                              00807000
APRTSTG  EQU   COMMON+1572                                              00808000
AFORMAT  EQU   COMMON+1568                                              00809000
ASTPROUT EQU   COMMON+1564                                              00810000
ATCBRTRV EQU   COMMON+1556                                              00811000
ATCBREMV EQU   COMMON+1552                                              00812000
ATCBSAVE EQU   COMMON+1548                                              00813000
QATMERTN EQU   COMMON+1544                                              00814000
ALOADER  EQU   COMMON+1540                                              00815000
AEREXIT  EQU   COMMON+1536                                              00816000
SYNMSGA  EQU   COMMON+1532                                              00817000
STOPEXIT EQU   COMMON+1528                                              00818000
AWRDCNVT EQU   COMMON+1520                                              00819000
AADRCNVT EQU   COMMON+1516                                              00820000
AFMTLINE EQU   COMMON+1512                                              00821000
ASYNTAX  EQU   COMMON+1508                                              00822000
APRTMSG  EQU   COMMON+1504                                              00823000
NONBLNK  EQU   COMMON+1244                                              00824000
BLNK     EQU   COMMON+988                                               00825000
@NM00043 EQU   COMMON+972                                               00826000
@NM00042 EQU   COMMON+915                                               00827000
EBCTABL  EQU   HEXTABL+10                                               00828000
@NM00041 EQU   HEXTABL                                                  00829000
@NM00040 EQU   TABLE                                                    00830000
CAPTABL  EQU   COMMON+403                                               00831000
TITLEPGE EQU   COMMON+394                                               00832000
@NM00039 EQU   COMMON+392                                               00833000
TITLETME EQU   COMMON+379                                               00834000
@NM00038 EQU   COMMON+377                                               00835000
TITLEDTE EQU   COMMON+364                                               00836000
@NM00037 EQU   COMMON+362                                               00837000
TITLEMOD EQU   COMMON+347                                               00838000
TITLEMSG EQU   COMMON+283                                               00839000
MSG2     EQU   COMMON+257                                               00840000
MSG1     EQU   COMMON+231                                               00841000
STOP     EQU   COMMON+227                                               00842000
TITLE    EQU   COMMON+222                                               00843000
BLANKS   EQU   COMMON+214                                               00844000
WTORMSG  EQU   COMMON+133                                               00845000
@NM00036 EQU   COMMON+130                                               00846000
@NM00035 EQU   PRSW                                                     00847000
@NM00034 EQU   PRSW                                                     00848000
PRNTREAL EQU   PRSW                                                     00849000
PRNTRL   EQU   PRSW                                                     00850000
TTLSW    EQU   PRSW                                                     00851000
@NM00033 EQU   PRSW                                                     00852000
QSEGTBSW EQU   PRSW                                                     00853000
@NM00032 EQU   PRSW                                                     00854000
@NM00031 EQU   BUFSW                                                    00855000
PREFM    EQU   BUFSW                                                    00856000
@NM00030 EQU   BUFSW                                                    00857000
@NM00029 EQU   BUFSW                                                    00858000
@NM00028 EQU   BUFSW                                                    00859000
@NM00027 EQU   BUFSW                                                    00860000
@NM00026 EQU   BUFSW                                                    00861000
@NM00025 EQU   BUFSW                                                    00862000
@NM00024 EQU   SWF                                                      00863000
QUT1LOD  EQU   SWF                                                      00864000
@NM00023 EQU   SWF                                                      00865000
PAGEOK   EQU   SWF                                                      00866000
DMPIC    EQU   SWF                                                      00867000
QSADMP   EQU   SWF                                                      00868000
NUCTFRMC EQU   SWF                                                      00869000
QPRDINIT EQU   SWF                                                      00870000
@NM00022 EQU   SWE                                                      00871000
@NM00021 EQU   SWE                                                      00872000
@NM00020 EQU   SWE                                                      00873000
BUILDMAP EQU   SWE                                                      00874000
TITLESW  EQU   SWE                                                      00875000
RESPC    EQU   SWE                                                      00876000
@NM00019 EQU   SWE                                                      00877000
STOPSW   EQU   SWE                                                      00878000
@NM00018 EQU   SWD                                                      00879000
GPRSFND  EQU   SWD                                                      00880000
CONTSW   EQU   SWD                                                      00881000
NOLOADSW EQU   SWD                                                      00882000
NOSTDMG  EQU   SWD                                                      00883000
@NM00017 EQU   SWD                                                      00884000
@NM00016 EQU   SWD                                                      00885000
FLSHMODE EQU   SWD                                                      00886000
@NM00015 EQU   SWC                                                      00887000
@NM00014 EQU   SWC                                                      00888000
@NM00013 EQU   SWC                                                      00889000
EDITSW   EQU   SWC                                                      00890000
TREADIN  EQU   SWC                                                      00891000
POSITSW  EQU   SWC                                                      00892000
SETFLSH  EQU   SWC                                                      00893000
MSTRSW   EQU   SWC                                                      00894000
@NM00012 EQU   SWB                                                      00895000
@NM00011 EQU   SWB                                                      00896000
QSYSUT2  EQU   SWB                                                      00897000
ENDSW    EQU   SWB                                                      00898000
@NM00010 EQU   SWB                                                      00899000
@NM00009 EQU   SWB                                                      00900000
FMTERR   EQU   SWB                                                      00901000
IOERR    EQU   SWB                                                      00902000
RDRSW    EQU   SWA                                                      00903000
SETCVTSW EQU   SWA                                                      00904000
@NM00008 EQU   SWA                                                      00905000
GOSW     EQU   SWA                                                      00906000
@NM00007 EQU   SWA                                                      00907000
@NM00006 EQU   SWA                                                      00908000
@NM00005 EQU   SWA                                                      00909000
@NM00004 EQU   SWA                                                      00910000
LINENUM  EQU   COMMON+120                                               00911000
LINENUMB EQU   COMMON+118                                               00912000
SIXTEEN  EQU   COMMON+116                                               00913000
TWELVE   EQU   COMMON+114                                               00914000
ELEVEN   EQU   COMMON+112                                               00915000
HTEN     EQU   COMMON+110                                               00916000
EIGHT    EQU   COMMON+108                                               00917000
SEVEN    EQU   COMMON+106                                               00918000
FIVE     EQU   COMMON+104                                               00919000
FOUR     EQU   COMMON+102                                               00920000
THREE    EQU   COMMON+100                                               00921000
TWO      EQU   COMMON+98                                                00922000
ONEA     EQU   COMMON+96                                                00923000
READTM   EQU   COMMON+92                                                00924000
RDERCNT  EQU   COMMON+88                                                00925000
READNO   EQU   COMMON+84                                                00926000
RDENTRY  EQU   COMMON+80                                                00927000
@NM00003 EQU   COMMON+78                                                00928000
FILESEQ  EQU   COMMON+76                                                00929000
INDD     EQU   COMMON+68                                                00930000
STORSIZE EQU   COMMON+64                                                00931000
CVTADDR  EQU   COMMON+56                                                00932000
TCBLIST  EQU   COMMON+52                                                00933000
PAGENUMB EQU   COMMON+44                                                00934000
LINECNT  EQU   COMMON+40                                                00935000
SIX      EQU   COMMON+36                                                00936000
WORK1    EQU   COMMON+24                                                00937000
DELIMCD  EQU   COMMON+20                                                00938000
KYWDEND  EQU   COMMON+16                                                00939000
KYWDBGN  EQU   COMMON+12                                                00940000
VERBEND  EQU   COMMON+8                                                 00941000
VERBGN   EQU   COMMON+4                                                 00942000
ASCBEND  EQU   ASCB+208                                                 00943000
ASCBSRBT EQU   ASCB+200                                                 00944000
ASCBSWTL EQU   ASCB+196                                                 00945000
ASCBRS14 EQU   ASCB+195                                                 00946000
ASCBSMCT EQU   ASCB+194                                                 00947000
ASCBRS12 EQU   ASCB+192                                                 00948000
ASCBPCTT EQU   ASCB+188                                                 00949000
ASCBVGTT EQU   ASCB+184                                                 00950000
ASCBLGCB EQU   ASCB+180                                                 00951000
ASCBJBNS EQU   ASCB+176                                                 00952000
ASCBJBNI EQU   ASCB+172                                                 00953000
ASCBMCC  EQU   ASCB+168                                                 00954000
ASCBRTWA EQU   ASCB+164                                                 00955000
ASCBIQEA EQU   ASCB+160                                                 00956000
ASCBXMPQ EQU   ASCB+156                                                 00957000
ASCBRS01 EQU   ASCB+154                                                 00958000
ASCBFMCT EQU   ASCB+152                                                 00959000
ASCBOUXB EQU   ASCB+148                                                 00960000
ASCBOUCB EQU   ASCB+144                                                 00961000
ASCBMECB EQU   ASCB+140                                                 00962000
ASCBQECB EQU   ASCB+136                                                 00963000
ASCBCMSB EQU   ASCB+132                                                 00964000
ASCBCMSF EQU   ASCB+128                                                 00965000
ASCBTCBS EQU   ASCB+124                                                 00966000
ASCBNVSC EQU   ASCB+122                                                 00967000
ASCBVSC  EQU   ASCB+120                                                 00968000
ASCBSRBS EQU   ASCB+118                                                 00969000
ASCBSSRB EQU   ASCB+116                                                 00970000
ASCBRV06 EQU   ASCBFLG2                                                 00971000
ASCBRV05 EQU   ASCBFLG2                                                 00972000
ASCBRV04 EQU   ASCBFLG2                                                 00973000
ASCBSNQS EQU   ASCBFLG2                                                 00974000
ASCBS2S  EQU   ASCBFLG2                                                 00975000
ASCBCEXT EQU   ASCBFLG2                                                 00976000
ASCBPXMT EQU   ASCBFLG2                                                 00977000
ASCBXMPT EQU   ASCBFLG2                                                 00978000
ASCBRF07 EQU   ASCBDSP1                                                 00979000
ASCBRF06 EQU   ASCBDSP1                                                 00980000
ASCBRF05 EQU   ASCBDSP1                                                 00981000
ASCBRF04 EQU   ASCBDSP1                                                 00982000
ASCBRF03 EQU   ASCBDSP1                                                 00983000
ASCBRF02 EQU   ASCBDSP1                                                 00984000
ASCBFAIL EQU   ASCBDSP1                                                 00985000
ASCBNOQ  EQU   ASCBDSP1                                                 00986000
ASCBSWCT EQU   ASCB+112                                                 00987000
ASCBASXB EQU   ASCB+108                                                 00988000
ASCBTMCH EQU   ASCB+104                                                 00989000
ASCBNSWP EQU   ASCBFLG1                                                 00990000
ASCBTYP1 EQU   ASCBFLG1                                                 00991000
ASCBSTND EQU   ASCBFLG1                                                 00992000
ASCBABNT EQU   ASCBFLG1                                                 00993000
ASCBTERM EQU   ASCBFLG1                                                 00994000
ASCBS3S  EQU   ASCBFLG1                                                 00995000
ASCBCMSH EQU   ASCBFLG1                                                 00996000
ASCBTOFF EQU   ASCBFLG1                                                 00997000
ASCBRF01 EQU   ASCBRCTF                                                 00998000
ASCBTMLW EQU   ASCBRCTF                                                 00999000
ASCBOUT  EQU   ASCBRCTF                                                 01000000
ASCBWAIT EQU   ASCBRCTF                                                 01001000
ASCBRV08 EQU   ASCBRCTF                                                 01002000
ASCBFQU  EQU   ASCBRCTF                                                 01003000
ASCBFRS  EQU   ASCBRCTF                                                 01004000
ASCBTMNO EQU   ASCBRCTF                                                 01005000
ASCBAFFN EQU   ASCBFW1                                                  01006000
ASCBDUMP EQU   ASCB+96                                                  01007000
ASCBQSVC EQU   ASCB+92                                                  01008000
ASCBUBET EQU   ASCB+88                                                  01009000
ASCBECB  EQU   ASCB+84                                                  01010000
ASCBJSTL EQU   ASCB+80                                                  01011000
ASCBEWST EQU   ASCB+72                                                  01012000
ASCBEJST EQU   ASCB+64                                                  01013000
ASCBTSB  EQU   ASCB+60                                                  01014000
ASCBCSCB EQU   ASCB+56                                                  01015000
ASCBRSM  EQU   ASCB+52                                                  01016000
ASCBSTOR EQU   ASCB+44                                                  01017000
ASCBDP   EQU   ASCB+43                                                  01018000
ASCBRV07 EQU   ASCB+42                                                  01019000
ASCBIOSM EQU   ASCB+40                                                  01020000
ASCBSEQN EQU   ASCB+38                                                  01021000
ASCBASID EQU   ASCB+36                                                  01022000
ASCBCPUS EQU   ASCB+32                                                  01023000
ASCBSPL  EQU   ASCB+28                                                  01024000
ASCBLSLQ EQU   ASCB+24                                                  01025000
ASCBFSLQ EQU   ASCB+20                                                  01026000
ASCBIOSP EQU   ASCB+16                                                  01027000
ASCBLOCK EQU   ASCB+12                                                  01028000
ASCBBWDP EQU   ASCB+8                                                   01029000
ASCBFWDP EQU   ASCB+4                                                   01030000
ASCBASCB EQU   ASCB                                                     01031000
ASCBEGIN EQU   ASCB                                                     01032000
BCKPTR   EQU   FBQESECT+4                                               01033000
PQERSVD  EQU   PQESECT+31                                               01034000
VVVRFLG  EQU   VMMFLGS                                                  01035000
@NM00002 EQU   VMMFLGS                                                  01036000
PQEHRID  EQU   PQESECT+29                                               01037000
PQERFLGS EQU   PQESECT+28                                               01038000
PQETCB   EQU   PQESECT+16                                               01039000
PQEBPQE  EQU   PQESECT+12                                               01040000
PQEFPQE  EQU   PQESECT+8                                                01041000
PQEBFBQE EQU   PQESECT+4                                                01042000
LDAEND   EQU   LDA+1496                                                 01043000
LCLCELCT EQU   LDA+1492                                                 01044000
LCLCELL  EQU   LDA+1488                                                 01045000
LDALIMIT EQU   LDA+1484                                                 01046000
LDARSVPT EQU   LDA+1480                                                 01047000
CURRGNTP EQU   LDA+1472                                                 01048000
VVREGSZ  EQU   LDA+1468                                                 01049000
LSQAPTR  EQU   LDA+1464                                                 01050000
CFAPWKAR EQU   LDA+1164                                                 01051000
CSAVE    EQU   LDA+1100                                                 01052000
OBFRSAVE EQU   LDA+1036                                                 01053000
GFRESAVE EQU   LDA+972                                                  01054000
GMREPSAV EQU   LDA+908                                                  01055000
FBQSAVE  EQU   LDA+844                                                  01056000
G4KSAVE  EQU   LDA+780                                                  01057000
FSAVE    EQU   LDA+716                                                  01058000
BSAVE    EQU   LDA+652                                                  01059000
SAVEREG2 EQU   LDA+588                                                  01060000
BRANCHSV EQU   LDA+524                                                  01061000
GMFMWKAR EQU   LDA+24                                                   01062000
LDARES2  EQU   LDA+21                                                   01063000
LDACBSP  EQU   LDA+20                                                   01064000
LDARQSTA EQU   LDA+16                                                   01065000
LDATCB   EQU   LDA+12                                                   01066000
PASCBSV  EQU   LDA+4                                                    01067000
@NM00001 EQU   LVSMFLAG+1                                               01068000
LDABRSW  EQU   LVSMFLAG                                                 01069000
LDAFLAGS EQU   LVSMFLAG                                                 01070000
LDASTART EQU   LDA                                                      01071000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01072000
@RC00134 EQU   @RC00132                                                 01073000
@RC00155 EQU   @RC00152                                                 01074000
@RC00160 EQU   @RC00155                                                 01075000
@ENDDATA EQU   *                                                        01076000
         END   AMDPRFUB,(C'PLS1239',0603,74330)                         01077000
